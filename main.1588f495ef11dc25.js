(self.webpackChunkeveryboard=self.webpackChunkeveryboard||[]).push([[590],{5008:(Iu,E0,Is)=>{"use strict";function jo(r,t,e,n,i,o,s){try{var a=r[o](s),c=a.value}catch(l){return void e(l)}a.done?t(c):Promise.resolve(c).then(n,i)}function M(r){return function(){var t=this,e=arguments;return new Promise(function(n,i){var o=r.apply(t,e);function s(c){jo(o,n,i,s,a,"next",c)}function a(c){jo(o,n,i,s,a,"throw",c)}s(void 0)})}}let ar=null,Vl=1;const Eo=Symbol("SIGNAL");function on(r){const t=ar;return ar=r,t}function Ja(r){if((!_a(r)||r.dirty)&&(r.dirty||r.lastCleanEpoch!==Vl)){if(!r.producerMustRecompute(r)&&!Pn(r))return r.dirty=!1,void(r.lastCleanEpoch=Vl);r.producerRecomputeValue(r),r.dirty=!1,r.lastCleanEpoch=Vl}}function Pn(r){Rs(r);for(let t=0;t<r.producerNode.length;t++){const e=r.producerNode[t],n=r.producerLastReadVersion[t];if(n!==e.version||(Ja(e),n!==e.version))return!0}return!1}function J2(r,t){if(function th(r){r.liveConsumerNode??=[],r.liveConsumerIndexOfThis??=[]}(r),Rs(r),1===r.liveConsumerNode.length)for(let n=0;n<r.producerNode.length;n++)J2(r.producerNode[n],r.producerIndexOfThis[n]);const e=r.liveConsumerNode.length-1;if(r.liveConsumerNode[t]=r.liveConsumerNode[e],r.liveConsumerIndexOfThis[t]=r.liveConsumerIndexOfThis[e],r.liveConsumerNode.length--,r.liveConsumerIndexOfThis.length--,t<r.liveConsumerNode.length){const n=r.liveConsumerIndexOfThis[t],i=r.liveConsumerNode[t];Rs(i),i.producerIndexOfThis[n]=t}}function _a(r){return r.consumerIsAlwaysLive||(r?.liveConsumerNode?.length??0)>0}function Rs(r){r.producerNode??=[],r.producerIndexOfThis??=[],r.producerLastReadVersion??=[]}let rh=null;function Me(r){return"function"==typeof r}function De(r){const e=r(n=>{Error.call(n),n.stack=(new Error).stack});return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e}const gt=De(r=>function(e){r(this),this.message=e?`${e.length} errors occurred during unsubscription:\n${e.map((n,i)=>`${i+1}) ${n.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=e});function wt(r,t){if(r){const e=r.indexOf(t);0<=e&&r.splice(e,1)}}class cn{constructor(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let t;if(!this.closed){this.closed=!0;const{_parentage:e}=this;if(e)if(this._parentage=null,Array.isArray(e))for(const o of e)o.remove(this);else e.remove(this);const{initialTeardown:n}=this;if(Me(n))try{n()}catch(o){t=o instanceof gt?o.errors:[o]}const{_finalizers:i}=this;if(i){this._finalizers=null;for(const o of i)try{Li(o)}catch(s){t=t??[],s instanceof gt?t=[...t,...s.errors]:t.push(s)}}if(t)throw new gt(t)}}add(t){var e;if(t&&t!==this)if(this.closed)Li(t);else{if(t instanceof cn){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(e=this._finalizers)&&void 0!==e?e:[]).push(t)}}_hasParent(t){const{_parentage:e}=this;return e===t||Array.isArray(e)&&e.includes(t)}_addParent(t){const{_parentage:e}=this;this._parentage=Array.isArray(e)?(e.push(t),e):e?[e,t]:t}_removeParent(t){const{_parentage:e}=this;e===t?this._parentage=null:Array.isArray(e)&&wt(e,t)}remove(t){const{_finalizers:e}=this;e&&wt(e,t),t instanceof cn&&t._removeParent(this)}}cn.EMPTY=(()=>{const r=new cn;return r.closed=!0,r})();const O1=cn.EMPTY;function v1(r){return r instanceof cn||r&&"closed"in r&&Me(r.remove)&&Me(r.add)&&Me(r.unsubscribe)}function Li(r){Me(r)?r():r.unsubscribe()}const Po={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},ec={setTimeout(r,t,...e){const{delegate:n}=ec;return n?.setTimeout?n.setTimeout(r,t,...e):setTimeout(r,t,...e)},clearTimeout(r){const{delegate:t}=ec;return(t?.clearTimeout||clearTimeout)(r)},delegate:void 0};function Fl(r){ec.setTimeout(()=>{const{onUnhandledError:t}=Po;if(!t)throw r;t(r)})}function Ul(){}const Ko=f3("C",void 0,void 0);function f3(r,t,e){return{kind:r,value:t,error:e}}let d3=null;function b0(r){if(Po.useDeprecatedSynchronousErrorHandling){const t=!d3;if(t&&(d3={errorThrown:!1,error:null}),r(),t){const{errorThrown:e,error:n}=d3;if(d3=null,e)throw n}}else r()}class Yv extends cn{constructor(t){super(),this.isStopped=!1,t?(this.destination=t,v1(t)&&t.add(this)):this.destination=jse}static create(t,e,n){return new Xv(t,e,n)}next(t){this.isStopped?Qv(function ni(r){return f3("N",r,void 0)}(t),this):this._next(t)}error(t){this.isStopped?Qv(function w0(r){return f3("E",void 0,r)}(t),this):(this.isStopped=!0,this._error(t))}complete(){this.isStopped?Qv(Ko,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(t){this.destination.next(t)}_error(t){try{this.destination.error(t)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const $se=Function.prototype.bind;function Kv(r,t){return $se.call(r,t)}class Wse{constructor(t){this.partialObserver=t}next(t){const{partialObserver:e}=this;if(e.next)try{e.next(t)}catch(n){ih(n)}}error(t){const{partialObserver:e}=this;if(e.error)try{e.error(t)}catch(n){ih(n)}else ih(t)}complete(){const{partialObserver:t}=this;if(t.complete)try{t.complete()}catch(e){ih(e)}}}class Xv extends Yv{constructor(t,e,n){let i;if(super(),Me(t)||!t)i={next:t??void 0,error:e??void 0,complete:n??void 0};else{let o;this&&Po.useDeprecatedNextContext?(o=Object.create(t),o.unsubscribe=()=>this.unsubscribe(),i={next:t.next&&Kv(t.next,o),error:t.error&&Kv(t.error,o),complete:t.complete&&Kv(t.complete,o)}):i=t}this.destination=new Wse(i)}}function ih(r){Po.useDeprecatedSynchronousErrorHandling?function Zv(r){Po.useDeprecatedSynchronousErrorHandling&&d3&&(d3.errorThrown=!0,d3.error=r)}(r):Fl(r)}function Qv(r,t){const{onStoppedNotification:e}=Po;e&&ec.setTimeout(()=>e(r,t))}const jse={closed:!0,next:Ul,error:function qse(r){throw r},complete:Ul},Jv="function"==typeof Symbol&&Symbol.observable||"@@observable";function Gl(r){return r}function IR(r){return 0===r.length?Gl:1===r.length?r[0]:function(e){return r.reduce((n,i)=>i(n),e)}}let ri=(()=>{class r{constructor(e){e&&(this._subscribe=e)}lift(e){const n=new r;return n.source=this,n.operator=e,n}subscribe(e,n,i){const o=function Kse(r){return r&&r instanceof Yv||function Yse(r){return r&&Me(r.next)&&Me(r.error)&&Me(r.complete)}(r)&&v1(r)}(e)?e:new Xv(e,n,i);return b0(()=>{const{operator:s,source:a}=this;o.add(s?s.call(o,a):a?this._subscribe(o):this._trySubscribe(o))}),o}_trySubscribe(e){try{return this._subscribe(e)}catch(n){e.error(n)}}forEach(e,n){return new(n=kR(n))((i,o)=>{const s=new Xv({next:a=>{try{e(a)}catch(c){o(c),s.unsubscribe()}},error:o,complete:i});this.subscribe(s)})}_subscribe(e){var n;return null===(n=this.source)||void 0===n?void 0:n.subscribe(e)}[Jv](){return this}pipe(...e){return IR(e)(this)}toPromise(e){return new(e=kR(e))((n,i)=>{let o;this.subscribe(s=>o=s,s=>i(s),()=>n(o))})}}return r.create=t=>new r(t),r})();function kR(r){var t;return null!==(t=r??Po.Promise)&&void 0!==t?t:Promise}const Xse=De(r=>function(){r(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let xs=(()=>{class r extends ri{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(e){const n=new RR(this,this);return n.operator=e,n}_throwIfClosed(){if(this.closed)throw new Xse}next(e){b0(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const n of this.currentObservers)n.next(e)}})}error(e){b0(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=e;const{observers:n}=this;for(;n.length;)n.shift().error(e)}})}complete(){b0(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:e}=this;for(;e.length;)e.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0}_trySubscribe(e){return this._throwIfClosed(),super._trySubscribe(e)}_subscribe(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)}_innerSubscribe(e){const{hasError:n,isStopped:i,observers:o}=this;return n||i?O1:(this.currentObservers=null,o.push(e),new cn(()=>{this.currentObservers=null,wt(o,e)}))}_checkFinalizedStatuses(e){const{hasError:n,thrownError:i,isStopped:o}=this;n?e.error(i):o&&e.complete()}asObservable(){const e=new ri;return e.source=this,e}}return r.create=(t,e)=>new RR(t,e),r})();class RR extends xs{constructor(t,e){super(),this.destination=t,this.source=e}next(t){var e,n;null===(n=null===(e=this.destination)||void 0===e?void 0:e.next)||void 0===n||n.call(e,t)}error(t){var e,n;null===(n=null===(e=this.destination)||void 0===e?void 0:e.error)||void 0===n||n.call(e,t)}complete(){var t,e;null===(e=null===(t=this.destination)||void 0===t?void 0:t.complete)||void 0===e||e.call(t)}_subscribe(t){var e,n;return null!==(n=null===(e=this.source)||void 0===e?void 0:e.subscribe(t))&&void 0!==n?n:O1}}class Xo extends xs{constructor(t){super(),this._value=t}get value(){return this.getValue()}_subscribe(t){const e=super._subscribe(t);return!e.closed&&t.next(this._value),e}getValue(){const{hasError:t,thrownError:e,_value:n}=this;if(t)throw e;return this._throwIfClosed(),n}next(t){super.next(this._value=t)}}function xR(r){return Me(r?.lift)}function Ji(r){return t=>{if(xR(t))return t.lift(function(e){try{return r(e,this)}catch(n){this.error(n)}});throw new TypeError("Unable to lift unknown Observable type")}}function gi(r,t,e,n,i){return new Qse(r,t,e,n,i)}class Qse extends Yv{constructor(t,e,n,i,o,s){super(t),this.onFinalize=o,this.shouldUnsubscribe=s,this._next=e?function(a){try{e(a)}catch(c){t.error(c)}}:super._next,this._error=i?function(a){try{i(a)}catch(c){t.error(c)}finally{this.unsubscribe()}}:super._error,this._complete=n?function(){try{n()}catch(a){t.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:e}=this;super.unsubscribe(),!e&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}}}function jn(r,t){return Ji((e,n)=>{let i=0;e.subscribe(gi(n,o=>{n.next(r.call(t,o,i++))}))})}const LR="https://g.co/ng/security#xss";class de extends Error{constructor(t,e){super(function A0(r,t){return`NG0${Math.abs(r)}${t?": "+t:""}`}(t,e)),this.code=t}}function ey(r){return t=>{setTimeout(r,void 0,t)}}const i1=class Jse extends xs{constructor(t=!1){super(),this.__isAsync=t}emit(t){const e=on(null);try{super.next(t)}finally{on(e)}}subscribe(t,e,n){let i=t,o=e||(()=>null),s=n;if(t&&"object"==typeof t){const c=t;i=c.next?.bind(c),o=c.error?.bind(c),s=c.complete?.bind(c)}this.__isAsync&&(o=ey(o),i&&(i=ey(i)),s&&(s=ey(s)));const a=super.subscribe({next:i,error:o,complete:s});return t instanceof cn&&t.add(a),a}};var Sn=function(r){return r[r.Default=0]="Default",r[r.Host=1]="Host",r[r.Self=2]="Self",r[r.SkipSelf=4]="SkipSelf",r[r.Optional=8]="Optional",r}(Sn||{});function pi(r){if("string"==typeof r)return r;if(Array.isArray(r))return"["+r.map(pi).join(", ")+"]";if(null==r)return""+r;if(r.overriddenName)return`${r.overriddenName}`;if(r.name)return`${r.name}`;const t=r.toString();if(null==t)return""+t;const e=t.indexOf("\n");return-1===e?t:t.substring(0,e)}function ty(r,t){return null==r||""===r?null===t?"":t:null==t||""===t?r:r+" "+t}function p4(r,t,e){r!=t&&function Dt(r,t,e,n){throw new Error(`ASSERTION ERROR: ${r}`+(null==n?"":` [Expected=> ${e} ${n} ${t} <=Actual]`))}(e,r,t,"==")}var sh=function(r){return r[r.OnPush=0]="OnPush",r[r.Default=1]="Default",r}(sh||{}),Ca=function(r){return r[r.Emulated=0]="Emulated",r[r.None=2]="None",r[r.ShadowDom=3]="ShadowDom",r}(Ca||{});function h3(r){return{toString:r}.toString()}const o1=globalThis,tc={},Zn=[];function f1(r){for(let t in r)if(r[t]===f1)return t;throw Error("Could not find renamed property on target object.")}function rae(r,t){for(const e in t)t.hasOwnProperty(e)&&!r.hasOwnProperty(e)&&(r[e]=t[e])}const Du=f1({\u0275cmp:f1}),ny=f1({\u0275dir:f1}),ry=f1({\u0275pipe:f1}),VR=f1({\u0275mod:f1}),g3=f1({\u0275fac:f1}),Vu=f1({__NG_ELEMENT_ID__:f1}),HR=f1({__NG_ENV_ID__:f1});var Z1=function(r){return r[r.None=0]="None",r[r.SignalBased=1]="SignalBased",r[r.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",r}(Z1||{});function FR(r,t,e){let n=r.length;for(;;){const i=r.indexOf(t,e);if(-1===i)return i;if(0===i||r.charCodeAt(i-1)<=32){const o=t.length;if(i+o===n||r.charCodeAt(i+o)<=32)return i}e=i+1}}function iy(r,t,e){let n=0;for(;n<e.length;){const i=e[n];if("number"==typeof i){if(0!==i)break;n++;const o=e[n++],s=e[n++],a=e[n++];r.setAttribute(t,s,a,o)}else{const o=i,s=e[++n];GR(o)?r.setProperty(t,o,s):r.setAttribute(t,o,s),n++}}return n}function UR(r){return 3===r||4===r||6===r}function GR(r){return 64===r.charCodeAt(0)}function Hu(r,t){if(null!==t&&0!==t.length)if(null===r||0===r.length)r=t.slice();else{let e=-1;for(let n=0;n<t.length;n++){const i=t[n];"number"==typeof i?e=i:0===e||BR(r,e,i,null,-1===e||2===e?t[++n]:null)}}return r}function BR(r,t,e,n,i){let o=0,s=r.length;if(-1===t)s=-1;else for(;o<r.length;){const a=r[o++];if("number"==typeof a){if(a===t){s=-1;break}if(a>t){s=o-1;break}}}for(;o<r.length;){const a=r[o];if("number"==typeof a)break;if(a===e){if(null===n)return void(null!==i&&(r[o+1]=i));if(n===r[o+1])return void(r[o+2]=i)}o++,null!==n&&o++,null!==i&&o++}-1!==s&&(r.splice(s,0,t),o=s+1),r.splice(o++,0,e),null!==n&&r.splice(o++,0,n),null!==i&&r.splice(o++,0,i)}const $R="ng-template";function iae(r,t,e){let n=0,i=!0;for(;n<r.length;){let o=r[n++];if("string"==typeof o&&i){const s=r[n++];if(e&&"class"===o&&-1!==FR(s.toLowerCase(),t,0))return!0}else{if(1===o){for(;n<r.length&&"string"==typeof(o=r[n++]);)if(o.toLowerCase()===t)return!0;return!1}"number"==typeof o&&(i=!1)}}return!1}function WR(r){return 4===r.type&&r.value!==$R}function oae(r,t,e){return t===(4!==r.type||e?r.value:$R)}function sae(r,t,e){let n=4;const i=r.attrs||[],o=function lae(r){for(let t=0;t<r.length;t++)if(UR(r[t]))return t;return r.length}(i);let s=!1;for(let a=0;a<t.length;a++){const c=t[a];if("number"!=typeof c){if(!s)if(4&n){if(n=2|1&n,""!==c&&!oae(r,c,e)||""===c&&1===t.length){if(va(n))return!1;s=!0}}else{const l=8&n?c:t[++a];if(8&n&&null!==r.attrs){if(!iae(r.attrs,l,e)){if(va(n))return!1;s=!0}continue}const f=aae(8&n?"class":c,i,WR(r),e);if(-1===f){if(va(n))return!1;s=!0;continue}if(""!==l){let g;g=f>o?"":i[f+1].toLowerCase();const y=8&n?g:null;if(y&&-1!==FR(y,l,0)||2&n&&l!==g){if(va(n))return!1;s=!0}}}}else{if(!s&&!va(n)&&!va(c))return!1;if(s&&va(c))continue;s=!1,n=c|1&n}}return va(n)||s}function va(r){return 0==(1&r)}function aae(r,t,e,n){if(null===t)return-1;let i=0;if(n||!e){let o=!1;for(;i<t.length;){const s=t[i];if(s===r)return i;if(3===s||6===s)o=!0;else{if(1===s||2===s){let a=t[++i];for(;"string"==typeof a;)a=t[++i];continue}if(4===s)break;if(0===s){i+=4;continue}}i+=o?1:2}return-1}return function uae(r,t){let e=r.indexOf(4);if(e>-1)for(e++;e<r.length;){const n=r[e];if("number"==typeof n)return-1;if(n===t)return e;e++}return-1}(t,r)}function qR(r,t,e=!1){for(let n=0;n<t.length;n++)if(sae(r,t[n],e))return!0;return!1}function fae(r,t){e:for(let e=0;e<t.length;e++){const n=t[e];if(r.length===n.length){for(let i=0;i<r.length;i++)if(r[i]!==n[i])continue e;return!0}}return!1}function jR(r,t){return r?":not("+t.trim()+")":t}function dae(r){let t=r[0],e=1,n=2,i="",o=!1;for(;e<r.length;){let s=r[e];if("string"==typeof s)if(2&n){const a=r[++e];i+="["+s+(a.length>0?'="'+a+'"':"")+"]"}else 8&n?i+="."+s:4&n&&(i+=" "+s);else""!==i&&!va(s)&&(t+=jR(o,i),i=""),n=s,o=o||!va(n);e++}return""!==i&&(t+=jR(o,i)),t}function Ue(r){return h3(()=>{const t=YR(r),e={...t,decls:r.decls,vars:r.vars,template:r.template,consts:r.consts||null,ngContentSelectors:r.ngContentSelectors,onPush:r.changeDetection===sh.OnPush,directiveDefs:null,pipeDefs:null,dependencies:t.standalone&&r.dependencies||null,getStandaloneInjector:null,signals:r.signals??!1,data:r.data||{},encapsulation:r.encapsulation||Ca.Emulated,styles:r.styles||Zn,_:null,schemas:r.schemas||null,tView:null,id:""};KR(e);const n=r.dependencies;return e.directiveDefs=ah(n,!1),e.pipeDefs=ah(n,!0),e.id=function Cae(r){let t=0;const e=[r.selectors,r.ngContentSelectors,r.hostVars,r.hostAttrs,r.consts,r.vars,r.decls,r.encapsulation,r.standalone,r.signals,r.exportAs,JSON.stringify(r.inputs),JSON.stringify(r.outputs),Object.getOwnPropertyNames(r.type.prototype),!!r.contentQueries,!!r.viewQuery].join("|");for(const i of e)t=Math.imul(31,t)+i.charCodeAt(0)<<0;return t+=2147483648,"c"+t}(e),e})}function pae(r){return _n(r)||mi(r)}function mae(r){return null!==r}function Ls(r){return h3(()=>({type:r.type,bootstrap:r.bootstrap||Zn,declarations:r.declarations||Zn,imports:r.imports||Zn,exports:r.exports||Zn,transitiveCompileScopes:null,schemas:r.schemas||null,id:r.id||null}))}function ZR(r,t){if(null==r)return tc;const e={};for(const n in r)if(r.hasOwnProperty(n)){const i=r[n];let o,s,a=Z1.None;Array.isArray(i)?(a=i[0],o=i[1],s=i[2]??o):(o=i,s=i),t?(e[o]=a!==Z1.None?[n,a]:n,t[o]=s):e[o]=n}return e}function Vt(r){return h3(()=>{const t=YR(r);return KR(t),t})}function O2(r){return{type:r.type,name:r.name,factory:null,pure:!1!==r.pure,standalone:!0===r.standalone,onDestroy:r.type.prototype.ngOnDestroy||null}}function _n(r){return r[Du]||null}function mi(r){return r[ny]||null}function e2(r){return r[ry]||null}function T2(r,t){const e=r[VR]||null;if(!e&&!0===t)throw new Error(`Type ${pi(r)} does not have '\u0275mod' property.`);return e}function YR(r){const t={};return{type:r.type,providersResolver:null,factory:null,hostBindings:r.hostBindings||null,hostVars:r.hostVars||0,hostAttrs:r.hostAttrs||null,contentQueries:r.contentQueries||null,declaredInputs:t,inputTransforms:null,inputConfig:r.inputs||tc,exportAs:r.exportAs||null,standalone:!0===r.standalone,signals:!0===r.signals,selectors:r.selectors||Zn,viewQuery:r.viewQuery||null,features:r.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:ZR(r.inputs,t),outputs:ZR(r.outputs),debugInfo:null}}function KR(r){r.features?.forEach(t=>t(r))}function ah(r,t){if(!r)return null;const e=t?e2:pae;return()=>("function"==typeof r?r():r).map(n=>e(n)).filter(mae)}const lr=0,He=1,Ot=2,zr=3,ya=4,w2=5,Ma=6,N0=7,R1=8,t2=9,p3=10,Yt=11,Fu=12,XR=13,I0=14,_r=15,Uu=16,k0=17,m3=18,Gu=19,QR=20,_4=21,ch=22,Bl=23,Jt=25,oy=1,nc=7,R0=9,Dr=10;var sy=function(r){return r[r.None=0]="None",r[r.HasTransplantedViews=2]="HasTransplantedViews",r}(sy||{});function b2(r){return Array.isArray(r)&&"object"==typeof r[oy]}function A2(r){return Array.isArray(r)&&!0===r[oy]}function ay(r){return 0!=(4&r.flags)}function $l(r){return r.componentOffset>-1}function uh(r){return 1==(1&r.flags)}function Ea(r){return!!r.template}function cy(r){return 0!=(512&r[Ot])}const nx="svg";let ix=!1;function y1(r){for(;Array.isArray(r);)r=r[lr];return r}function $u(r,t){return y1(t[r])}function eo(r,t){return y1(t[r.index])}function Wu(r,t){return r.data[t]}function x0(r,t){return r[t]}function es(r,t){const e=t[r];return b2(e)?e:e[lr]}function dy(r){return 128==(128&r[Ot])}function rc(r,t){return null==t?null:r[t]}function ox(r){r[k0]=0}function Tae(r){1024&r[Ot]||(r[Ot]|=1024,dy(r)&&qu(r))}function hy(r){return!!(9216&r[Ot]||r[Bl]?.dirty)}function gy(r){hy(r)?qu(r):64&r[Ot]&&(function Eae(){return ix}()?(r[Ot]|=1024,qu(r)):r[p3].changeDetectionScheduler?.notify())}function qu(r){r[p3].changeDetectionScheduler?.notify();let t=Wl(r);for(;null!==t&&!(8192&t[Ot])&&(t[Ot]|=8192,dy(t));)t=Wl(t)}function fh(r,t){if(256==(256&r[Ot]))throw new de(911,!1);null===r[_4]&&(r[_4]=[]),r[_4].push(t)}function Wl(r){const t=r[zr];return A2(t)?t[zr]:t}const $t={lFrame:px(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function cx(){return $t.bindingsEnabled}function L0(){return null!==$t.skipHydrationRootTNode}function Ce(){return $t.lFrame.lView}function On(){return $t.lFrame.tView}function te(r){return $t.lFrame.contextLView=r,r[R1]}function ne(r){return $t.lFrame.contextLView=null,r}function d1(){let r=lx();for(;null!==r&&64===r.type;)r=r.parent;return r}function lx(){return $t.lFrame.currentTNode}function ju(){const r=$t.lFrame,t=r.currentTNode;return r.isParent?t:t.parent}function ic(r,t){const e=$t.lFrame;e.currentTNode=r,e.isParent=t}function my(){return $t.lFrame.isParent}function _y(){$t.lFrame.isParent=!1}function to(){const r=$t.lFrame;let t=r.bindingRootIndex;return-1===t&&(t=r.bindingRootIndex=r.tView.bindingStartIndex),t}function _3(){return $t.lFrame.bindingIndex}function Pa(){return $t.lFrame.bindingIndex++}function C3(r){const t=$t.lFrame,e=t.bindingIndex;return t.bindingIndex=t.bindingIndex+r,e}function dx(r){$t.lFrame.inI18n=r}function Dae(r,t){const e=$t.lFrame;e.bindingIndex=e.bindingRootIndex=r,Cy(t)}function Cy(r){$t.lFrame.currentDirectiveIndex=r}function yy(){return $t.lFrame.currentQueryIndex}function dh(r){$t.lFrame.currentQueryIndex=r}function Hae(r){const t=r[He];return 2===t.type?t.declTNode:1===t.type?r[w2]:null}function hx(r,t,e){if(e&Sn.SkipSelf){let i=t,o=r;for(;!(i=i.parent,null!==i||e&Sn.Host||(i=Hae(o),null===i||(o=o[I0],10&i.type))););if(null===i)return!1;t=i,r=o}const n=$t.lFrame=gx();return n.currentTNode=t,n.lView=r,!0}function My(r){const t=gx(),e=r[He];$t.lFrame=t,t.currentTNode=e.firstChild,t.lView=r,t.tView=e,t.contextLView=r,t.bindingIndex=e.bindingStartIndex,t.inI18n=!1}function gx(){const r=$t.lFrame,t=null===r?null:r.child;return null===t?px(r):t}function px(r){const t={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:r,child:null,inI18n:!1};return null!==r&&(r.child=t),t}function mx(){const r=$t.lFrame;return $t.lFrame=r.parent,r.currentTNode=null,r.lView=null,r}const _x=mx;function Ey(){const r=mx();r.isParent=!0,r.tView=null,r.selectedIndex=-1,r.contextLView=null,r.elementDepthCount=0,r.currentDirectiveIndex=-1,r.currentNamespace=null,r.bindingRootIndex=-1,r.bindingIndex=-1,r.currentQueryIndex=0}function N2(){return $t.lFrame.selectedIndex}function ql(r){$t.lFrame.selectedIndex=r}function x1(){const r=$t.lFrame;return Wu(r.tView,r.selectedIndex)}function I(){$t.lFrame.currentNamespace=nx}let vx=!0;function hh(){return vx}function C4(r){vx=r}function $ae(){return z0(d1(),Ce())}function z0(r,t){return new I2(eo(r,t))}let Ty,I2=(()=>{class r{constructor(e){this.nativeElement=e}static#e=this.__NG_ELEMENT_ID__=$ae}return r})();function yx(r){return r instanceof I2?r.nativeElement:r}function D0(r,t){r.forEach(e=>Array.isArray(e)?D0(e,t):t(e))}function Mx(r,t,e){t>=r.length?r.push(e):r.splice(t,0,e)}function gh(r,t){return t>=r.length-1?r.pop():r.splice(t,1)[0]}function ts(r,t,e){let n=V0(r,t);return n>=0?r[1|n]=e:(n=~n,function Ex(r,t,e,n){let i=r.length;if(i==t)r.push(e,n);else if(1===i)r.push(n,r[0]),r[0]=e;else{for(i--,r.push(r[i-1],r[i]);i>t;)r[i]=r[i-2],i--;r[t]=e,r[t+1]=n}}(r,n,t,e)),n}function Sy(r,t){const e=V0(r,t);if(e>=0)return r[1|e]}function V0(r,t){return function Px(r,t,e){let n=0,i=r.length>>e;for(;i!==n;){const o=n+(i-n>>1),s=r[o<<e];if(t===s)return o<<e;s>t?i=o:n=o+1}return~(i<<e)}(r,t,1)}function qae(){return this._results[Symbol.iterator]()}class Oy{static#e=Symbol.iterator;get changes(){return this._changes??=new i1}constructor(t=!1){this._emitDistinctChangesOnly=t,this.dirty=!0,this._onDirty=void 0,this._results=[],this._changesDetected=!1,this._changes=void 0,this.length=0,this.first=void 0,this.last=void 0;const e=Oy.prototype;e[Symbol.iterator]||(e[Symbol.iterator]=qae)}get(t){return this._results[t]}map(t){return this._results.map(t)}filter(t){return this._results.filter(t)}find(t){return this._results.find(t)}reduce(t,e){return this._results.reduce(t,e)}forEach(t){this._results.forEach(t)}some(t){return this._results.some(t)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(t,e){this.dirty=!1;const n=function So(r){return r.flat(Number.POSITIVE_INFINITY)}(t);(this._changesDetected=!function Wae(r,t,e){if(r.length!==t.length)return!1;for(let n=0;n<r.length;n++){let i=r[n],o=t[n];if(e&&(i=e(i),o=e(o)),o!==i)return!1}return!0}(this._results,n,e))&&(this._results=n,this.length=n.length,this.last=n[this.length-1],this.first=n[0])}notifyOnChanges(){void 0!==this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}onDirty(t){this._onDirty=t}setDirty(){this.dirty=!0,this._onDirty?.()}destroy(){void 0!==this._changes&&(this._changes.complete(),this._changes.unsubscribe())}}function mh(r){return 128==(128&r.flags)}function v4(){if(void 0!==Ty)return Ty;if(typeof document<"u")return document;throw new de(210,!1)}function xe(r){return{token:r.token,providedIn:r.providedIn||null,factory:r.factory,value:void 0}}function ns(r){return{providers:r.providers||[],imports:r.imports||[]}}function Ch(r){return Tx(r,yh)||Tx(r,wx)}function Tx(r,t){return r.hasOwnProperty(t)?r[t]:null}function vh(r){return r&&(r.hasOwnProperty(wy)||r.hasOwnProperty(Xae))?r[wy]:null}const yh=f1({\u0275prov:f1}),wy=f1({\u0275inj:f1}),wx=f1({ngInjectableDef:f1}),Xae=f1({ngInjectorDef:f1});class tt{constructor(t,e){this._desc=t,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof e?this.__NG_ELEMENT_ID__=e:void 0!==e&&(this.\u0275prov=xe({token:this,providedIn:e.providedIn||"root",factory:e.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}const Mh=new tt("",{providedIn:"root",factory:()=>Qae}),Qae="ng",bx=new tt(""),y4=new tt("",{providedIn:"platform",factory:()=>"unknown"}),Ax=new tt(""),Nx=new tt("",{providedIn:"root",factory:()=>v4().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null}),tce=f1({__forward_ref__:f1});function L1(r){return r.__forward_ref__=L1,r.toString=function(){return pi(this())},r}function Ft(r){return Eh(r)?r():r}function Eh(r){return"function"==typeof r&&r.hasOwnProperty(tce)&&r.__forward_ref__===L1}function ky(r){return r&&!!r.\u0275providers}function en(r){return"string"==typeof r?r:null==r?"":String(r)}function Ry(r,t){throw new de(-201,!1)}let xy;function kx(){return xy}function Oo(r){const t=xy;return xy=r,t}function Rx(r,t,e){const n=Ch(r);return n&&"root"==n.providedIn?void 0===n.value?n.value=n.factory():n.value:e&Sn.Optional?null:void 0!==t?t:void Ry()}const Yu={},Ly="__NG_DI_FLAG__",Ph="ngTempTokenPath",ace=/\n/gm,xx="__source";let H0;function M4(r){const t=H0;return H0=r,t}function uce(r,t=Sn.Default){if(void 0===H0)throw new de(-203,!1);return null===H0?Rx(r,void 0,t):H0.get(r,t&Sn.Optional?null:void 0,t)}function ze(r,t=Sn.Default){return(kx()||uce)(Ft(r),t)}function Ne(r,t=Sn.Default){return ze(r,Sh(t))}function Sh(r){return typeof r>"u"||"number"==typeof r?r:0|(r.optional&&8)|(r.host&&1)|(r.self&&2)|(r.skipSelf&&4)}function zy(r){const t=[];for(let e=0;e<r.length;e++){const n=Ft(r[e]);if(Array.isArray(n)){if(0===n.length)throw new de(900,!1);let i,o=Sn.Default;for(let s=0;s<n.length;s++){const a=n[s],c=fce(a);"number"==typeof c?-1===c?i=a.token:o|=c:i=a}t.push(ze(i,o))}else t.push(ze(n))}return t}function Ku(r,t){return r[Ly]=t,r.prototype[Ly]=t,r}function fce(r){return r[Ly]}let zx=()=>null;function $y(r,t,e=!1){return zx(r,t,e)}const $0="__parameters__";function q0(r,t,e){return h3(()=>{const n=function Zy(r){return function(...e){if(r){const n=r(...e);for(const i in n)this[i]=n[i]}}}(t);function i(...o){if(this instanceof i)return n.apply(this,o),this;const s=new i(...o);return a.annotation=s,a;function a(c,l,u){const f=c.hasOwnProperty($0)?c[$0]:Object.defineProperty(c,$0,{value:[]})[$0];for(;f.length<=u;)f.push(null);return(f[u]=f[u]||[]).push(s),c}}return e&&(i.prototype=Object.create(e.prototype)),i.prototype.ngMetadataName=r,i.annotationCls=i,i})}const Nh=Ku(q0("Optional"),8),Ih=Ku(q0("SkipSelf"),4);function jl(r,t){return r.hasOwnProperty(g3)?r[g3]:null}const Zl=new tt(""),Gx=new tt("",-1),Yy=new tt("");class kh{get(t,e=Yu){if(e===Yu){const n=new Error(`NullInjectorError: No provider for ${pi(t)}!`);throw n.name="NullInjectorError",n}return e}}function Oce(...r){return{\u0275providers:Ky(0,r),\u0275fromNgModule:!0}}function Ky(r,...t){const e=[],n=new Set;let i;const o=s=>{e.push(s)};return D0(t,s=>{const a=s;xh(a,o,[],n)&&(i||=[],i.push(a))}),void 0!==i&&Bx(i,o),e}function Bx(r,t){for(let e=0;e<r.length;e++){const{ngModule:n,providers:i}=r[e];Xy(i,o=>{t(o,n)})}}function xh(r,t,e,n){if(!(r=Ft(r)))return!1;let i=null,o=vh(r);const s=!o&&_n(r);if(o||s){if(s&&!s.standalone)return!1;i=r}else{const c=r.ngModule;if(o=vh(c),!o)return!1;i=c}const a=n.has(i);if(s){if(a)return!1;if(n.add(i),s.dependencies){const c="function"==typeof s.dependencies?s.dependencies():s.dependencies;for(const l of c)xh(l,t,e,n)}}else{if(!o)return!1;{if(null!=o.imports&&!a){let l;n.add(i);try{D0(o.imports,u=>{xh(u,t,e,n)&&(l||=[],l.push(u))})}finally{}void 0!==l&&Bx(l,t)}if(!a){const l=jl(i)||(()=>new i);t({provide:i,useFactory:l,deps:Zn},i),t({provide:Yy,useValue:i,multi:!0},i),t({provide:Zl,useValue:()=>ze(i),multi:!0},i)}const c=o.providers;if(null!=c&&!a){const l=r;Xy(c,u=>{t(u,l)})}}}return i!==r&&void 0!==r.providers}function Xy(r,t){for(let e of r)ky(e)&&(e=e.\u0275providers),Array.isArray(e)?Xy(e,t):t(e)}const Tce=f1({provide:String,useValue:f1});function Qy(r){return null!==r&&"object"==typeof r&&Tce in r}function Yl(r){return"function"==typeof r}const Jy=new tt(""),Lh={},bce={};let eM;function zh(){return void 0===eM&&(eM=new kh),eM}class To{}class j0 extends To{get destroyed(){return this._destroyed}constructor(t,e,n,i){super(),this.parent=e,this.source=n,this.scopes=i,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,nM(t,s=>this.processProvider(s)),this.records.set(Gx,Z0(void 0,this)),i.has("environment")&&this.records.set(To,Z0(void 0,this));const o=this.records.get(Jy);null!=o&&"string"==typeof o.value&&this.scopes.add(o.value),this.injectorDefTypes=new Set(this.get(Yy,Zn,Sn.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;const t=on(null);try{for(const n of this._ngOnDestroyHooks)n.ngOnDestroy();const e=this._onDestroyHooks;this._onDestroyHooks=[];for(const n of e)n()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),on(t)}}onDestroy(t){return this.assertNotDestroyed(),this._onDestroyHooks.push(t),()=>this.removeOnDestroy(t)}runInContext(t){this.assertNotDestroyed();const e=M4(this),n=Oo(void 0);try{return t()}finally{M4(e),Oo(n)}}get(t,e=Yu,n=Sn.Default){if(this.assertNotDestroyed(),t.hasOwnProperty(HR))return t[HR](this);n=Sh(n);const o=M4(this),s=Oo(void 0);try{if(!(n&Sn.SkipSelf)){let c=this.records.get(t);if(void 0===c){const l=function Rce(r){return"function"==typeof r||"object"==typeof r&&r instanceof tt}(t)&&Ch(t);c=l&&this.injectableDefInScope(l)?Z0(tM(t),Lh):null,this.records.set(t,c)}if(null!=c)return this.hydrate(t,c)}return(n&Sn.Self?zh():this.parent).get(t,e=n&Sn.Optional&&e===Yu?null:e)}catch(a){if("NullInjectorError"===a.name){if((a[Ph]=a[Ph]||[]).unshift(pi(t)),o)throw a;return function dce(r,t,e,n){const i=r[Ph];throw t[xx]&&i.unshift(t[xx]),r.message=function hce(r,t,e,n=null){r=r&&"\n"===r.charAt(0)&&"\u0275"==r.charAt(1)?r.slice(2):r;let i=pi(t);if(Array.isArray(t))i=t.map(pi).join(" -> ");else if("object"==typeof t){let o=[];for(let s in t)if(t.hasOwnProperty(s)){let a=t[s];o.push(s+":"+("string"==typeof a?JSON.stringify(a):pi(a)))}i=`{${o.join(", ")}}`}return`${e}${n?"("+n+")":""}[${i}]: ${r.replace(ace,"\n  ")}`}("\n"+r.message,i,e,n),r.ngTokenPath=i,r[Ph]=null,r}(a,t,"R3InjectorError",this.source)}throw a}finally{Oo(s),M4(o)}}resolveInjectorInitializers(){const t=on(null),e=M4(this),n=Oo(void 0);try{const o=this.get(Zl,Zn,Sn.Self);for(const s of o)s()}finally{M4(e),Oo(n),on(t)}}toString(){const t=[],e=this.records;for(const n of e.keys())t.push(pi(n));return`R3Injector[${t.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new de(205,!1)}processProvider(t){let e=Yl(t=Ft(t))?t:Ft(t&&t.provide);const n=function Nce(r){return Qy(r)?Z0(void 0,r.useValue):Z0(qx(r),Lh)}(t);if(!Yl(t)&&!0===t.multi){let i=this.records.get(e);i||(i=Z0(void 0,Lh,!0),i.factory=()=>zy(i.multi),this.records.set(e,i)),e=t,i.multi.push(t)}this.records.set(e,n)}hydrate(t,e){const n=on(null);try{return e.value===Lh&&(e.value=bce,e.value=e.factory()),"object"==typeof e.value&&e.value&&function kce(r){return null!==r&&"object"==typeof r&&"function"==typeof r.ngOnDestroy}(e.value)&&this._ngOnDestroyHooks.add(e.value),e.value}finally{on(n)}}injectableDefInScope(t){if(!t.providedIn)return!1;const e=Ft(t.providedIn);return"string"==typeof e?"any"===e||this.scopes.has(e):this.injectorDefTypes.has(e)}removeOnDestroy(t){const e=this._onDestroyHooks.indexOf(t);-1!==e&&this._onDestroyHooks.splice(e,1)}}function tM(r){const t=Ch(r),e=null!==t?t.factory:jl(r);if(null!==e)return e;if(r instanceof tt)throw new de(204,!1);if(r instanceof Function)return function Ace(r){if(r.length>0)throw new de(204,!1);const e=function Kae(r){return r&&(r[yh]||r[wx])||null}(r);return null!==e?()=>e.factory(r):()=>new r}(r);throw new de(204,!1)}function qx(r,t,e){let n;if(Yl(r)){const i=Ft(r);return jl(i)||tM(i)}if(Qy(r))n=()=>Ft(r.useValue);else if(function Wx(r){return!(!r||!r.useFactory)}(r))n=()=>r.useFactory(...zy(r.deps||[]));else if(function $x(r){return!(!r||!r.useExisting)}(r))n=()=>ze(Ft(r.useExisting));else{const i=Ft(r&&(r.useClass||r.provide));if(!function Ice(r){return!!r.deps}(r))return jl(i)||tM(i);n=()=>new i(...zy(r.deps))}return n}function Z0(r,t,e=!1){return{factory:r,value:t,multi:e?[]:void 0}}function nM(r,t){for(const e of r)Array.isArray(e)?nM(e,t):e&&ky(e)?nM(e.\u0275providers,t):t(e)}function E4(r,t){r instanceof j0&&r.assertNotDestroyed();const n=M4(r),i=Oo(void 0);try{return t()}finally{M4(n),Oo(i)}}class Bce{constructor(t,e,n){this.previousValue=t,this.currentValue=e,this.firstChange=n}isFirstChange(){return this.firstChange}}function Zx(r,t,e,n){null!==t?t.applyValueToInputSignal(t,n):r[e]=n}function n2(){return Yx}function Yx(r){return r.type.prototype.ngOnChanges&&(r.setInput=Wce),$ce}function $ce(){const r=Xx(this),t=r?.current;if(t){const e=r.previous;if(e===tc)r.previous=t;else for(let n in t)e[n]=t[n];r.current=null,this.ngOnChanges(t)}}function Wce(r,t,e,n,i){const o=this.declaredInputs[n],s=Xx(r)||function qce(r,t){return r[Kx]=t}(r,{previous:tc,current:null}),a=s.current||(s.current={}),c=s.previous,l=c[o];a[o]=new Bce(l&&l.currentValue,e,c===tc),Zx(r,t,i,e)}n2.ngInherit=!0;const Kx="__ngSimpleChanges__";function Xx(r){return r[Kx]||null}const oc=function(r,t,e){};function Hh(r,t){for(let e=t.directiveStart,n=t.directiveEnd;e<n;e++){const o=r.data[e].type.prototype,{ngAfterContentInit:s,ngAfterContentChecked:a,ngAfterViewInit:c,ngAfterViewChecked:l,ngOnDestroy:u}=o;s&&(r.contentHooks??=[]).push(-e,s),a&&((r.contentHooks??=[]).push(e,a),(r.contentCheckHooks??=[]).push(e,a)),c&&(r.viewHooks??=[]).push(-e,c),l&&((r.viewHooks??=[]).push(e,l),(r.viewCheckHooks??=[]).push(e,l)),null!=u&&(r.destroyHooks??=[]).push(e,u)}}function Fh(r,t,e){Qx(r,t,3,e)}function Uh(r,t,e,n){(3&r[Ot])===e&&Qx(r,t,e,n)}function oM(r,t){let e=r[Ot];(3&e)===t&&(e&=16383,e+=1,r[Ot]=e)}function Qx(r,t,e,n){const o=n??-1,s=t.length-1;let a=0;for(let c=void 0!==n?65535&r[k0]:0;c<s;c++)if("number"==typeof t[c+1]){if(a=t[c],null!=n&&a>=n)break}else t[c]<0&&(r[k0]+=65536),(a<o||-1==o)&&(Yce(r,e,t,c),r[k0]=(4294901760&r[k0])+c+2),c++}function Jx(r,t){oc(4,r,t);const e=on(null);try{t.call(r)}finally{on(e),oc(5,r,t)}}function Yce(r,t,e,n){const i=e[n]<0,o=e[n+1],a=r[i?-e[n]:e[n]];i?r[Ot]>>14<r[k0]>>16&&(3&r[Ot])===t&&(r[Ot]+=16384,Jx(a,o)):Jx(a,o)}const K0=-1;class t7{constructor(t,e,n){this.factory=t,this.resolving=!1,this.canSeeViewProviders=e,this.injectImpl=n}}function aM(r){return r!==K0}function n7(r){return 32767&r}function r7(r,t){let e=function e3e(r){return r>>16}(r),n=t;for(;e>0;)n=n[I0],e--;return n}let cM=!0;function Gh(r){const t=cM;return cM=r,t}const eL=255,tL=5;let t3e=0;const sc={};function Bh(r,t){const e=nL(r,t);if(-1!==e)return e;const n=t[He];n.firstCreatePass&&(r.injectorIndex=t.length,lM(n.data,r),lM(t,null),lM(n.blueprint,null));const i=$h(r,t),o=r.injectorIndex;if(aM(i)){const s=n7(i),a=r7(i,t),c=a[He].data;for(let l=0;l<8;l++)t[o+l]=a[s+l]|c[s+l]}return t[o+8]=i,o}function lM(r,t){r.push(0,0,0,0,0,0,0,0,t)}function nL(r,t){return-1===r.injectorIndex||r.parent&&r.parent.injectorIndex===r.injectorIndex||null===t[r.injectorIndex+8]?-1:r.injectorIndex}function $h(r,t){if(r.parent&&-1!==r.parent.injectorIndex)return r.parent.injectorIndex;let e=0,n=null,i=t;for(;null!==i;){if(n=lL(i),null===n)return K0;if(e++,i=i[I0],-1!==n.injectorIndex)return n.injectorIndex|e<<16}return K0}function uM(r,t,e){!function n3e(r,t,e){let n;"string"==typeof e?n=e.charCodeAt(0)||0:e.hasOwnProperty(Vu)&&(n=e[Vu]),null==n&&(n=e[Vu]=t3e++);const i=n&eL;t.data[r+(i>>tL)]|=1<<i}(r,t,e)}function rL(r,t,e){if(e&Sn.Optional||void 0!==r)return r;Ry()}function iL(r,t,e,n){if(e&Sn.Optional&&void 0===n&&(n=null),!(e&(Sn.Self|Sn.Host))){const i=r[t2],o=Oo(void 0);try{return i?i.get(t,n,e&Sn.Optional):Rx(t,n,e&Sn.Optional)}finally{Oo(o)}}return rL(n,0,e)}function oL(r,t,e,n=Sn.Default,i){if(null!==r){if(2048&t[Ot]&&!(n&Sn.Self)){const s=function a3e(r,t,e,n,i){let o=r,s=t;for(;null!==o&&null!==s&&2048&s[Ot]&&!(512&s[Ot]);){const a=sL(o,s,e,n|Sn.Self,sc);if(a!==sc)return a;let c=o.parent;if(!c){const l=s[QR];if(l){const u=l.get(e,sc,n);if(u!==sc)return u}c=lL(s),s=s[I0]}o=c}return i}(r,t,e,n,sc);if(s!==sc)return s}const o=sL(r,t,e,n,sc);if(o!==sc)return o}return iL(t,e,n,i)}function sL(r,t,e,n,i){const o=function o3e(r){if("string"==typeof r)return r.charCodeAt(0)||0;const t=r.hasOwnProperty(Vu)?r[Vu]:void 0;return"number"==typeof t?t>=0?t&eL:s3e:t}(e);if("function"==typeof o){if(!hx(t,r,n))return n&Sn.Host?rL(i,0,n):iL(t,e,n,i);try{let s;if(s=o(n),null!=s||n&Sn.Optional)return s;Ry()}finally{_x()}}else if("number"==typeof o){let s=null,a=nL(r,t),c=K0,l=n&Sn.Host?t[_r][w2]:null;for((-1===a||n&Sn.SkipSelf)&&(c=-1===a?$h(r,t):t[a+8],c!==K0&&cL(n,!1)?(s=t[He],a=n7(c),t=r7(c,t)):a=-1);-1!==a;){const u=t[He];if(aL(o,a,u.data)){const f=i3e(a,t,e,s,n,l);if(f!==sc)return f}c=t[a+8],c!==K0&&cL(n,t[He].data[a+8]===l)&&aL(o,a,t)?(s=u,a=n7(c),t=r7(c,t)):a=-1}}return i}function i3e(r,t,e,n,i,o){const s=t[He],a=s.data[r+8],u=Wh(a,s,e,null==n?$l(a)&&cM:n!=s&&0!=(3&a.type),i&Sn.Host&&o===a);return null!==u?Kl(t,s,u,a):sc}function Wh(r,t,e,n,i){const o=r.providerIndexes,s=t.data,a=1048575&o,c=r.directiveStart,u=o>>20,g=i?a+u:r.directiveEnd;for(let y=n?a:a+u;y<g;y++){const S=s[y];if(y<c&&e===S||y>=c&&S.type===e)return y}if(i){const y=s[c];if(y&&Ea(y)&&y.type===e)return c}return null}function Kl(r,t,e,n){let i=r[e];const o=t.data;if(function Kce(r){return r instanceof t7}(i)){const s=i;s.resolving&&function ice(r,t){throw t&&t.join(" > "),new de(-200,r)}(function e1(r){return"function"==typeof r?r.name||r.toString():"object"==typeof r&&null!=r&&"function"==typeof r.type?r.type.name||r.type.toString():en(r)}(o[e]));const a=Gh(s.canSeeViewProviders);s.resolving=!0;const l=s.injectImpl?Oo(s.injectImpl):null;hx(r,n,Sn.Default);try{i=r[e]=s.factory(void 0,o,r,n),t.firstCreatePass&&e>=n.directiveStart&&function Zce(r,t,e){const{ngOnChanges:n,ngOnInit:i,ngDoCheck:o}=t.type.prototype;if(n){const s=Yx(t);(e.preOrderHooks??=[]).push(r,s),(e.preOrderCheckHooks??=[]).push(r,s)}i&&(e.preOrderHooks??=[]).push(0-r,i),o&&((e.preOrderHooks??=[]).push(r,o),(e.preOrderCheckHooks??=[]).push(r,o))}(e,o[e],t)}finally{null!==l&&Oo(l),Gh(a),s.resolving=!1,_x()}}return i}function aL(r,t,e){return!!(e[t+(r>>tL)]&1<<r)}function cL(r,t){return!(r&Sn.Self||r&Sn.Host&&t)}class Ci{constructor(t,e){this._tNode=t,this._lView=e}get(t,e,n){return oL(this._tNode,this._lView,t,Sh(n),e)}}function s3e(){return new Ci(d1(),Ce())}function z1(r){return h3(()=>{const t=r.prototype.constructor,e=t[g3]||fM(t),n=Object.prototype;let i=Object.getPrototypeOf(r.prototype).constructor;for(;i&&i!==n;){const o=i[g3]||fM(i);if(o&&o!==e)return o;i=Object.getPrototypeOf(i)}return o=>new o})}function fM(r){return Eh(r)?()=>{const t=fM(Ft(r));return t&&t()}:jl(r)}function lL(r){const t=r[He],e=t.type;return 2===e?t.declTNode:1===e?r[w2]:null}function gL(r,t=null,e=null,n){const i=pL(r,t,e,n);return i.resolveInjectorInitializers(),i}function pL(r,t=null,e=null,n,i=new Set){const o=[e||Zn,Oce(r)];return n=n||("object"==typeof r?void 0:pi(r)),new j0(o,t||zh(),n||null,i)}let no=(()=>{class r{static#e=this.THROW_IF_NOT_FOUND=Yu;static#t=this.NULL=new kh;static create(e,n){if(Array.isArray(e))return gL({name:""},n,e,"");{const i=e.name??"";return gL({name:i},e.parent,e.providers,i)}}static#n=this.\u0275prov=xe({token:r,providedIn:"any",factory:()=>ze(Gx)});static#r=this.__NG_ELEMENT_ID__=-1}return r})();function hM(r){return r.ngOriginalError}class v3{constructor(){this._console=console}handleError(t){const e=this._findOriginalError(t);this._console.error("ERROR",t),e&&this._console.error("ORIGINAL ERROR",e)}_findOriginalError(t){let e=t&&hM(t);for(;e&&hM(e);)e=hM(e);return e||null}}const _L=new tt("",{providedIn:"root",factory:()=>Ne(v3).handleError.bind(void 0)}),vL=new tt("",{providedIn:"root",factory:()=>!1});let Yh,Kh;function J0(r){return function gM(){if(void 0===Yh&&(Yh=null,o1.trustedTypes))try{Yh=o1.trustedTypes.createPolicy("angular",{createHTML:r=>r,createScript:r=>r,createScriptURL:r=>r})}catch{}return Yh}()?.createHTML(r)||r}function pM(){if(void 0===Kh&&(Kh=null,o1.trustedTypes))try{Kh=o1.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:r=>r,createScript:r=>r,createScriptURL:r=>r})}catch{}return Kh}function yL(r){return pM()?.createHTML(r)||r}function EL(r){return pM()?.createScriptURL(r)||r}class Xl{constructor(t){this.changingThisBreaksApplicationSecurity=t}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${LR})`}}class _3e extends Xl{getTypeName(){return"HTML"}}class C3e extends Xl{getTypeName(){return"Style"}}class v3e extends Xl{getTypeName(){return"Script"}}class y3e extends Xl{getTypeName(){return"URL"}}class M3e extends Xl{getTypeName(){return"ResourceURL"}}function rs(r){return r instanceof Xl?r.changingThisBreaksApplicationSecurity:r}function ac(r,t){const e=function E3e(r){return r instanceof Xl&&r.getTypeName()||null}(r);if(null!=e&&e!==t){if("ResourceURL"===e&&"URL"===t)return!0;throw new Error(`Required a safe ${t}, got a ${e} (see ${LR})`)}return e===t}function PL(r){const t=new A3e(r);return function N3e(){try{return!!(new window.DOMParser).parseFromString(J0(""),"text/html")}catch{return!1}}()?new b3e(t):t}class b3e{constructor(t){this.inertDocumentHelper=t}getInertBodyElement(t){t="<body><remove></remove>"+t;try{const e=(new window.DOMParser).parseFromString(J0(t),"text/html").body;return null===e?this.inertDocumentHelper.getInertBodyElement(t):(e.removeChild(e.firstChild),e)}catch{return null}}}class A3e{constructor(t){this.defaultDoc=t,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert")}getInertBodyElement(t){const e=this.inertDocument.createElement("template");return e.innerHTML=J0(t),e}}const I3e=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function Xh(r){return(r=String(r)).match(I3e)?r:"unsafe:"+r}function y3(r){const t={};for(const e of r.split(","))t[e]=!0;return t}function i7(...r){const t={};for(const e of r)for(const n in e)e.hasOwnProperty(n)&&(t[n]=!0);return t}const SL=y3("area,br,col,hr,img,wbr"),OL=y3("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),TL=y3("rp,rt"),mM=i7(SL,i7(OL,y3("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),i7(TL,y3("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),i7(TL,OL)),_M=y3("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),wL=i7(_M,y3("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),y3("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),k3e=y3("script,style,template");class R3e{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(t){let e=t.firstChild,n=!0;for(;e;)if(e.nodeType===Node.ELEMENT_NODE?n=this.startElement(e):e.nodeType===Node.TEXT_NODE?this.chars(e.nodeValue):this.sanitizedSomething=!0,n&&e.firstChild)e=e.firstChild;else for(;e;){e.nodeType===Node.ELEMENT_NODE&&this.endElement(e);let i=this.checkClobberedElement(e,e.nextSibling);if(i){e=i;break}e=this.checkClobberedElement(e,e.parentNode)}return this.buf.join("")}startElement(t){const e=t.nodeName.toLowerCase();if(!mM.hasOwnProperty(e))return this.sanitizedSomething=!0,!k3e.hasOwnProperty(e);this.buf.push("<"),this.buf.push(e);const n=t.attributes;for(let i=0;i<n.length;i++){const o=n.item(i),s=o.name,a=s.toLowerCase();if(!wL.hasOwnProperty(a)){this.sanitizedSomething=!0;continue}let c=o.value;_M[a]&&(c=Xh(c)),this.buf.push(" ",s,'="',bL(c),'"')}return this.buf.push(">"),!0}endElement(t){const e=t.nodeName.toLowerCase();mM.hasOwnProperty(e)&&!SL.hasOwnProperty(e)&&(this.buf.push("</"),this.buf.push(e),this.buf.push(">"))}chars(t){this.buf.push(bL(t))}checkClobberedElement(t,e){if(e&&(t.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${t.outerHTML}`);return e}}const x3e=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,L3e=/([^\#-~ |!])/g;function bL(r){return r.replace(/&/g,"&amp;").replace(x3e,function(t){return"&#"+(1024*(t.charCodeAt(0)-55296)+(t.charCodeAt(1)-56320)+65536)+";"}).replace(L3e,function(t){return"&#"+t.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let Qh;function AL(r,t){let e=null;try{Qh=Qh||PL(r);let n=t?String(t):"";e=Qh.getInertBodyElement(n);let i=5,o=n;do{if(0===i)throw new Error("Failed to sanitize html because the input is unstable");i--,n=o,o=e.innerHTML,e=Qh.getInertBodyElement(n)}while(n!==o);return J0((new R3e).sanitizeChildren(CM(e)||e))}finally{if(e){const n=CM(e)||e;for(;n.firstChild;)n.removeChild(n.firstChild)}}}function CM(r){return"content"in r&&function z3e(r){return r.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===r.nodeName}(r)?r.content:null}var zs=function(r){return r[r.NONE=0]="NONE",r[r.HTML=1]="HTML",r[r.STYLE=2]="STYLE",r[r.SCRIPT=3]="SCRIPT",r[r.URL=4]="URL",r[r.RESOURCE_URL=5]="RESOURCE_URL",r}(zs||{});function o7(r){const t=s7();return t?yL(t.sanitize(zs.HTML,r)||""):ac(r,"HTML")?yL(rs(r)):AL(v4(),en(r))}function Jh(r){const t=s7();return t?t.sanitize(zs.URL,r)||"":ac(r,"URL")?rs(r):Xh(en(r))}function NL(r){const t=s7();if(t)return EL(t.sanitize(zs.RESOURCE_URL,r)||"");if(ac(r,"ResourceURL"))return EL(rs(r));throw new de(904,!1)}function s7(){const r=Ce();return r&&r[p3].sanitizer}const G3e=/^>|^->|<!--|-->|--!>|<!-$/g,B3e=/(<|>)/g,$3e="\u200b$1\u200b";const vM=new Map;let Y3e=0;const MM="__ngContext__";function k2(r,t){b2(t)?(r[MM]=t[Gu],function X3e(r){vM.set(r[Gu],r)}(t)):r[MM]=t}function is(r){return r instanceof Function?r():r}var S4=function(r){return r[r.Important=1]="Important",r[r.DashCase=2]="DashCase",r}(S4||{});let OM;function TM(r,t){return OM(r,t)}function t8(r,t,e,n,i){if(null!=n){let o,s=!1;A2(n)?o=n:b2(n)&&(s=!0,n=n[lr]);const a=y1(n);0===r&&null!==e?null==i?KL(t,e,a):Ql(t,e,a,i||null,!0):1===r&&null!==e?Ql(t,e,a,i||null,!0):2===r?ag(t,a,s):3===r&&t.destroyNode(a),null!=o&&function E4e(r,t,e,n,i){const o=e[nc];o!==y1(e)&&t8(t,r,n,o,i);for(let a=Dr;a<e.length;a++){const c=e[a];cg(c[He],c,r,t,n,o)}}(t,r,o,e,i)}}function ng(r,t){return r.createText(t)}function qL(r,t,e){r.setValue(t,e)}function wM(r,t){return r.createComment(function kL(r){return r.replace(G3e,t=>t.replace(B3e,$3e))}(t))}function rg(r,t,e){return r.createElement(t,e)}function jL(r,t){cg(r,t,t[Yt],2,null,null)}function ZL(r,t){const e=r[R0],n=e.indexOf(t);e.splice(n,1)}function c7(r,t){if(r.length<=Dr)return;const e=Dr+t,n=r[e];if(n){const i=n[Uu];null!==i&&i!==r&&ZL(i,n),t>0&&(r[e-1][ya]=n[ya]);const o=gh(r,Dr+t);!function d4e(r,t){jL(r,t),t[lr]=null,t[w2]=null}(n[He],n);const s=o[m3];null!==s&&s.detachView(o[He]),n[zr]=null,n[ya]=null,n[Ot]&=-129}return n}function ig(r,t){if(!(256&t[Ot])){const e=t[Yt];e.destroyNode&&cg(r,t,e,3,null,null),function g4e(r){let t=r[Fu];if(!t)return bM(r[He],r);for(;t;){let e=null;if(b2(t))e=t[Fu];else{const n=t[Dr];n&&(e=n)}if(!e){for(;t&&!t[ya]&&t!==r;)b2(t)&&bM(t[He],t),t=t[zr];null===t&&(t=r),b2(t)&&bM(t[He],t),e=t&&t[ya]}t=e}}(t)}}function bM(r,t){if(256&t[Ot])return;const e=on(null);try{t[Ot]&=-129,t[Ot]|=256,t[Bl]&&function cr(r){if(Rs(r),_a(r))for(let t=0;t<r.producerNode.length;t++)J2(r.producerNode[t],r.producerIndexOfThis[t]);r.producerNode.length=r.producerLastReadVersion.length=r.producerIndexOfThis.length=0,r.liveConsumerNode&&(r.liveConsumerNode.length=r.liveConsumerIndexOfThis.length=0)}(t[Bl]),function C4e(r,t){let e;if(null!=r&&null!=(e=r.destroyHooks))for(let n=0;n<e.length;n+=2){const i=t[e[n]];if(!(i instanceof t7)){const o=e[n+1];if(Array.isArray(o))for(let s=0;s<o.length;s+=2){const a=i[o[s]],c=o[s+1];oc(4,a,c);try{c.call(a)}finally{oc(5,a,c)}}else{oc(4,i,o);try{o.call(i)}finally{oc(5,i,o)}}}}}(r,t),function _4e(r,t){const e=r.cleanup,n=t[N0];if(null!==e)for(let o=0;o<e.length-1;o+=2)if("string"==typeof e[o]){const s=e[o+3];s>=0?n[s]():n[-s].unsubscribe(),o+=2}else e[o].call(n[e[o+1]]);null!==n&&(t[N0]=null);const i=t[_4];if(null!==i){t[_4]=null;for(let o=0;o<i.length;o++)(0,i[o])()}}(r,t),1===t[He].type&&t[Yt].destroy();const n=t[Uu];if(null!==n&&A2(t[zr])){n!==t[zr]&&ZL(n,t);const i=t[m3];null!==i&&i.detachView(r)}!function Q3e(r){vM.delete(r[Gu])}(t)}finally{on(e)}}function AM(r,t,e){return YL(r,t.parent,e)}function YL(r,t,e){let n=t;for(;null!==n&&40&n.type;)n=(t=n).parent;if(null===n)return e[lr];{const{componentOffset:i}=n;if(i>-1){const{encapsulation:o}=r.data[n.directiveStart+i];if(o===Ca.None||o===Ca.Emulated)return null}return eo(n,e)}}function Ql(r,t,e,n,i){r.insertBefore(t,e,n,i)}function KL(r,t,e){r.appendChild(t,e)}function XL(r,t,e,n,i){null!==n?Ql(r,t,e,n,i):KL(r,t,e)}function og(r,t){return r.parentNode(t)}function QL(r,t,e){return ez(r,t,e)}function JL(r,t,e){return 40&r.type?eo(r,e):null}let NM,ez=JL;function tz(r,t){ez=r,NM=t}function sg(r,t,e,n){const i=AM(r,n,t),o=t[Yt],a=QL(n.parent||t[w2],n,t);if(null!=i)if(Array.isArray(e))for(let c=0;c<e.length;c++)XL(o,i,e[c],a,!1);else XL(o,i,e,a,!1);void 0!==NM&&NM(o,n,t,e,i)}function l7(r,t){if(null!==t){const e=t.type;if(3&e)return eo(t,r);if(4&e)return IM(-1,r[t.index]);if(8&e){const n=t.child;if(null!==n)return l7(r,n);{const i=r[t.index];return A2(i)?IM(-1,i):y1(i)}}if(32&e)return TM(t,r)()||y1(r[t.index]);{const n=nz(r,t);return null!==n?Array.isArray(n)?n[0]:l7(Wl(r[_r]),n):l7(r,t.next)}}return null}function nz(r,t){return null!==t?r[_r][w2].projection[t.projection]:null}function IM(r,t){const e=Dr+r+1;if(e<t.length){const n=t[e],i=n[He].firstChild;if(null!==i)return l7(n,i)}return t[nc]}function ag(r,t,e){const n=og(r,t);n&&function v4e(r,t,e,n){r.removeChild(t,e,n)}(r,n,t,e)}function kM(r,t,e,n,i,o,s){for(;null!=e;){const a=n[e.index],c=e.type;if(s&&0===t&&(a&&k2(y1(a),n),e.flags|=2),32!=(32&e.flags))if(8&c)kM(r,t,e.child,n,i,o,!1),t8(t,r,i,a,o);else if(32&c){const l=TM(e,n);let u;for(;u=l();)t8(t,r,i,u,o);t8(t,r,i,a,o)}else 16&c?iz(r,t,n,e,i,o):t8(t,r,i,a,o);e=s?e.projectionNext:e.next}}function cg(r,t,e,n,i,o){kM(e,n,r.firstChild,t,i,o,!1)}function iz(r,t,e,n,i,o){const s=e[_r],c=s[w2].projection[n.projection];if(Array.isArray(c))for(let l=0;l<c.length;l++)t8(t,r,i,c[l],o);else{let l=c;const u=s[zr];mh(n)&&(l.flags|=128),kM(r,t,l,u,i,o,!0)}}function oz(r,t,e){""===e?r.removeAttribute(t,"class"):r.setAttribute(t,"class",e)}function sz(r,t,e){const{mergedAttrs:n,classes:i,styles:o}=e;null!==n&&iy(r,t,n),null!==i&&oz(r,t,i),null!==o&&function S4e(r,t,e){r.setAttribute(t,"style",e)}(r,t,o)}const nn={};function m(r=1){az(On(),Ce(),N2()+r,!1)}function az(r,t,e,n){if(!n)if(3==(3&t[Ot])){const o=r.preOrderCheckHooks;null!==o&&Fh(t,o,e)}else{const o=r.preOrderHooks;null!==o&&Uh(t,o,0,e)}ql(e)}function G(r,t=Sn.Default){const e=Ce();return null===e?ze(r,t):oL(d1(),e,Ft(r),t)}function lz(r,t,e,n,i,o){const s=on(null);try{let a=null;i&Z1.SignalBased&&(a=t[n][Eo]),null!==a&&void 0!==a.transformFn&&(o=a.transformFn(o)),i&Z1.HasDecoratorInputTransform&&(o=r.inputTransforms[n].call(t,o)),null!==r.setInput?r.setInput(t,a,o,e,n):Zx(t,a,n,o)}finally{on(s)}}function lg(r,t,e,n,i,o,s,a,c,l,u){const f=t.blueprint.slice();return f[lr]=i,f[Ot]=204|n,(null!==l||r&&2048&r[Ot])&&(f[Ot]|=2048),ox(f),f[zr]=f[I0]=r,f[R1]=e,f[p3]=s||r&&r[p3],f[Yt]=a||r&&r[Yt],f[t2]=c||r&&r[t2]||null,f[w2]=o,f[Gu]=function K3e(){return Y3e++}(),f[Ma]=u,f[QR]=l,f[_r]=2==t.type?r[_r]:f,f}function n8(r,t,e,n,i){let o=r.data[t];if(null===o)o=RM(r,t,e,n,i),function zae(){return $t.lFrame.inI18n}()&&(o.flags|=32);else if(64&o.type){o.type=e,o.value=n,o.attrs=i;const s=ju();o.injectorIndex=null===s?-1:s.injectorIndex}return ic(o,!0),o}function RM(r,t,e,n,i){const o=lx(),s=my(),c=r.data[t]=function k4e(r,t,e,n,i,o){let s=t?t.injectorIndex:-1,a=0;return L0()&&(a|=128),{type:e,index:n,insertBeforeIndex:null,injectorIndex:s,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:o,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:t,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,s?o:o&&o.parent,e,t,n,i);return null===r.firstChild&&(r.firstChild=c),null!==o&&(s?null==o.child&&null!==c.parent&&(o.child=c):null===o.next&&(o.next=c,c.prev=o)),c}function u7(r,t,e,n){if(0===e)return-1;const i=t.length;for(let o=0;o<e;o++)t.push(n),r.blueprint.push(n),r.data.push(null);return i}function uz(r,t,e,n,i){const o=N2(),s=2&n;try{ql(-1),s&&t.length>Jt&&az(r,t,Jt,!1),oc(s?2:0,i),e(n,i)}finally{ql(o),oc(s?3:1,i)}}function xM(r,t,e){if(ay(t)){const n=on(null);try{const o=t.directiveEnd;for(let s=t.directiveStart;s<o;s++){const a=r.data[s];a.contentQueries&&a.contentQueries(1,e[s],s)}}finally{on(n)}}}function LM(r,t,e){cx()&&(function H4e(r,t,e,n){const i=e.directiveStart,o=e.directiveEnd;$l(e)&&function q4e(r,t,e){const n=eo(t,r),i=fz(e);let s=16;e.signals?s=4096:e.onPush&&(s=64);const a=ug(r,lg(r,i,null,s,n,t,null,r[p3].rendererFactory.createRenderer(n,e),null,null,null));r[t.index]=a}(t,e,r.data[i+e.componentOffset]),r.firstCreatePass||Bh(e,t),k2(n,t);const s=e.initialInputs;for(let a=i;a<o;a++){const c=r.data[a],l=Kl(t,r,a,e);k2(l,t),null!==s&&j4e(0,a-i,l,c,0,s),Ea(c)&&(es(e.index,t)[R1]=Kl(t,r,a,e))}}(r,t,e,eo(e,t)),64==(64&e.flags)&&mz(r,t,e))}function zM(r,t,e=eo){const n=t.localNames;if(null!==n){let i=t.index+1;for(let o=0;o<n.length;o+=2){const s=n[o+1],a=-1===s?e(t,r):r[s];r[i++]=a}}}function fz(r){const t=r.tView;return null===t||t.incompleteFirstPass?r.tView=DM(1,null,r.template,r.decls,r.vars,r.directiveDefs,r.pipeDefs,r.viewQuery,r.schemas,r.consts,r.id):t}function DM(r,t,e,n,i,o,s,a,c,l,u){const f=Jt+n,g=f+i,y=function T4e(r,t){const e=[];for(let n=0;n<t;n++)e.push(n<r?null:nn);return e}(f,g),S="function"==typeof l?l():l;return y[He]={type:r,blueprint:y,template:e,queries:null,viewQuery:a,declTNode:t,data:y.slice().fill(null,f),bindingStartIndex:f,expandoStartIndex:g,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof o?o():o,pipeRegistry:"function"==typeof s?s():s,firstChild:null,schemas:c,consts:S,incompleteFirstPass:!1,ssrId:u}}let dz=()=>null;function hz(r,t,e,n,i){for(let o in t){if(!t.hasOwnProperty(o))continue;const s=t[o];if(void 0===s)continue;n??={};let a,c=Z1.None;Array.isArray(s)?(a=s[0],c=s[1]):a=s;let l=o;if(null!==i){if(!i.hasOwnProperty(o))continue;l=i[o]}0===r?gz(n,e,l,a,c):gz(n,e,l,a)}return n}function gz(r,t,e,n,i){let o;r.hasOwnProperty(e)?(o=r[e]).push(t,n):o=r[e]=[t,n],void 0!==i&&o.push(i)}function bo(r,t,e,n,i,o,s,a){const c=eo(t,e);let u,l=t.inputs;!a&&null!=l&&(u=l[n])?(GM(r,e,u,n,i),$l(t)&&function L4e(r,t){const e=es(t,r);16&e[Ot]||(e[Ot]|=64)}(e,t.index)):3&t.type&&(n=function x4e(r){return"class"===r?"className":"for"===r?"htmlFor":"formaction"===r?"formAction":"innerHtml"===r?"innerHTML":"readonly"===r?"readOnly":"tabindex"===r?"tabIndex":r}(n),i=null!=s?s(i,t.value||"",n):i,o.setProperty(c,n,i))}function VM(r,t,e,n){if(cx()){const i=null===n?null:{"":-1},o=function U4e(r,t){const e=r.directiveRegistry;let n=null,i=null;if(e)for(let o=0;o<e.length;o++){const s=e[o];if(qR(t,s.selectors,!1))if(n||(n=[]),Ea(s))if(null!==s.findHostDirectiveDefs){const a=[];i=i||new Map,s.findHostDirectiveDefs(s,a,i),n.unshift(...a,s),HM(r,t,a.length)}else n.unshift(s),HM(r,t,0);else i=i||new Map,s.findHostDirectiveDefs?.(s,n,i),n.push(s)}return null===n?null:[n,i]}(r,e);let s,a;null===o?s=a=null:[s,a]=o,null!==s&&pz(r,t,e,s,i,a),i&&function G4e(r,t,e){if(t){const n=r.localNames=[];for(let i=0;i<t.length;i+=2){const o=e[t[i+1]];if(null==o)throw new de(-301,!1);n.push(t[i],o)}}}(e,n,i)}e.mergedAttrs=Hu(e.mergedAttrs,e.attrs)}function pz(r,t,e,n,i,o){for(let l=0;l<n.length;l++)uM(Bh(e,t),r,n[l].type);!function $4e(r,t,e){r.flags|=1,r.directiveStart=t,r.directiveEnd=t+e,r.providerIndexes=t}(e,r.data.length,n.length);for(let l=0;l<n.length;l++){const u=n[l];u.providersResolver&&u.providersResolver(u)}let s=!1,a=!1,c=u7(r,t,n.length,null);for(let l=0;l<n.length;l++){const u=n[l];e.mergedAttrs=Hu(e.mergedAttrs,u.hostAttrs),W4e(r,e,t,c,u),B4e(c,u,i),null!==u.contentQueries&&(e.flags|=4),(null!==u.hostBindings||null!==u.hostAttrs||0!==u.hostVars)&&(e.flags|=64);const f=u.type.prototype;!s&&(f.ngOnChanges||f.ngOnInit||f.ngDoCheck)&&((r.preOrderHooks??=[]).push(e.index),s=!0),!a&&(f.ngOnChanges||f.ngDoCheck)&&((r.preOrderCheckHooks??=[]).push(e.index),a=!0),c++}!function R4e(r,t,e){const i=t.directiveEnd,o=r.data,s=t.attrs,a=[];let c=null,l=null;for(let u=t.directiveStart;u<i;u++){const f=o[u],g=e?e.get(f):null,S=g?g.outputs:null;c=hz(0,f.inputs,u,c,g?g.inputs:null),l=hz(1,f.outputs,u,l,S);const N=null===c||null===s||WR(t)?null:Z4e(c,u,s);a.push(N)}null!==c&&(c.hasOwnProperty("class")&&(t.flags|=8),c.hasOwnProperty("style")&&(t.flags|=16)),t.initialInputs=a,t.inputs=c,t.outputs=l}(r,e,o)}function mz(r,t,e){const n=e.directiveStart,i=e.directiveEnd,o=e.index,s=function Vae(){return $t.lFrame.currentDirectiveIndex}();try{ql(o);for(let a=n;a<i;a++){const c=r.data[a],l=t[a];Cy(a),(null!==c.hostBindings||0!==c.hostVars||null!==c.hostAttrs)&&F4e(c,l)}}finally{ql(-1),Cy(s)}}function F4e(r,t){null!==r.hostBindings&&r.hostBindings(1,t)}function HM(r,t,e){t.componentOffset=e,(r.components??=[]).push(t.index)}function B4e(r,t,e){if(e){if(t.exportAs)for(let n=0;n<t.exportAs.length;n++)e[t.exportAs[n]]=r;Ea(t)&&(e[""]=r)}}function W4e(r,t,e,n,i){r.data[n]=i;const o=i.factory||(i.factory=jl(i.type)),s=new t7(o,Ea(i),G);r.blueprint[n]=s,e[n]=s,function D4e(r,t,e,n,i){const o=i.hostBindings;if(o){let s=r.hostBindingOpCodes;null===s&&(s=r.hostBindingOpCodes=[]);const a=~t.index;(function V4e(r){let t=r.length;for(;t>0;){const e=r[--t];if("number"==typeof e&&e<0)return e}return 0})(s)!=a&&s.push(a),s.push(e,n,o)}}(r,t,n,u7(r,e,i.hostVars,nn),i)}function FM(r,t,e,n,i,o,s){if(null==o)r.removeAttribute(t,i,e);else{const a=null==s?en(o):s(o,n||"",i);r.setAttribute(t,i,a,e)}}function j4e(r,t,e,n,i,o){const s=o[t];if(null!==s)for(let a=0;a<s.length;)lz(n,e,s[a++],s[a++],s[a++],s[a++])}function Z4e(r,t,e){let n=null,i=0;for(;i<e.length;){const o=e[i];if(0!==o)if(5!==o){if("number"==typeof o)break;if(r.hasOwnProperty(o)){null===n&&(n=[]);const s=r[o];for(let a=0;a<s.length;a+=3)if(s[a]===t){n.push(o,s[a+1],s[a+2],e[i+1]);break}}i+=2}else i+=2;else i+=4}return n}function _z(r,t,e,n){return[r,!0,0,t,null,n,null,e,null,null]}function Cz(r,t){const e=r.contentQueries;if(null!==e){const n=on(null);try{for(let i=0;i<e.length;i+=2){const s=e[i+1];if(-1!==s){const a=r.data[s];dh(e[i]),a.contentQueries(2,t[s],s)}}}finally{on(n)}}}function ug(r,t){return r[Fu]?r[XR][ya]=t:r[Fu]=t,r[XR]=t,t}function UM(r,t,e){dh(0);const n=on(null);try{t(r,e)}finally{on(n)}}function vz(r){return r[N0]||(r[N0]=[])}function yz(r){return r.cleanup||(r.cleanup=[])}function fg(r,t){const e=r[t2],n=e?e.get(v3,null):null;n&&n.handleError(t)}function GM(r,t,e,n,i){for(let o=0;o<e.length;){const s=e[o++],a=e[o++],c=e[o++];lz(r.data[s],t[s],n,a,c,i)}}function M3(r,t,e){const n=$u(t,r);qL(r[Yt],n,e)}function Y4e(r,t){const e=es(t,r),n=e[He];!function K4e(r,t){for(let e=t.length;e<r.blueprint.length;e++)t.push(r.blueprint[e])}(n,e);const i=e[lr];null!==i&&null===e[Ma]&&(e[Ma]=$y(i,e[t2])),BM(n,e,e[R1])}function BM(r,t,e){My(t);try{const n=r.viewQuery;null!==n&&UM(1,n,e);const i=r.template;null!==i&&uz(r,t,i,1,e),r.firstCreatePass&&(r.firstCreatePass=!1),t[m3]?.finishViewCreation(r),r.staticContentQueries&&Cz(r,t),r.staticViewQueries&&UM(2,r.viewQuery,e);const o=r.components;null!==o&&function X4e(r,t){for(let e=0;e<t.length;e++)Y4e(r,t[e])}(t,o)}catch(n){throw r.firstCreatePass&&(r.incompleteFirstPass=!0,r.firstCreatePass=!1),n}finally{t[Ot]&=-5,Ey()}}function r8(r,t){return!t||null===t.firstChild||mh(r)}function d7(r,t,e,n=!0){const i=t[He];if(function p4e(r,t,e,n){const i=Dr+n,o=e.length;n>0&&(e[i-1][ya]=t),n<o-Dr?(t[ya]=e[i],Mx(e,Dr+n,t)):(e.push(t),t[ya]=null),t[zr]=e;const s=t[Uu];null!==s&&e!==s&&function m4e(r,t){const e=r[R0];t[_r]!==t[zr][zr][_r]&&(r[Ot]|=sy.HasTransplantedViews),null===e?r[R0]=[t]:e.push(t)}(s,t);const a=t[m3];null!==a&&a.insertView(r),gy(t),t[Ot]|=128}(i,t,r,e),n){const s=IM(e,r),a=t[Yt],c=og(a,r[nc]);null!==c&&function h4e(r,t,e,n,i,o){n[lr]=i,n[w2]=t,cg(r,n,e,1,i,o)}(i,r[w2],a,t,c,s)}const o=t[Ma];null!==o&&null!==o.firstChild&&(o.firstChild=null)}function h7(r,t,e,n,i=!1){for(;null!==e;){const o=t[e.index];null!==o&&n.push(y1(o)),A2(o)&&Pz(o,n);const s=e.type;if(8&s)h7(r,t,e.child,n);else if(32&s){const a=TM(e,t);let c;for(;c=a();)n.push(c)}else if(16&s){const a=nz(t,e);if(Array.isArray(a))n.push(...a);else{const c=Wl(t[_r]);h7(c[He],c,a,n,!0)}}e=i?e.projectionNext:e.next}return n}function Pz(r,t){for(let e=Dr;e<r.length;e++){const n=r[e],i=n[He].firstChild;null!==i&&h7(n[He],n,i,t)}r[nc]!==r[lr]&&t.push(r[nc])}let Sz=[];const tle={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{},consumerIsAlwaysLive:!0,consumerMarkedDirty:r=>{qu(r.lView)},consumerOnSignalRead(){this.lView[Bl]=this}};function Oz(r){return wz(r[Fu])}function Tz(r){return wz(r[ya])}function wz(r){for(;null!==r&&!A2(r);)r=r[ya];return r}function dg(r,t=!0,e=0){const n=r[p3],i=n.rendererFactory;i.begin?.();try{!function ile(r,t){WM(r,t);let e=0;for(;hy(r);){if(100===e)throw new de(103,!1);e++,WM(r,1)}}(r,e)}catch(s){throw t&&fg(r,s),s}finally{i.end?.(),n.inlineEffectRunner?.flush()}}function ole(r,t,e,n){const i=t[Ot];if(256==(256&i))return;t[p3].inlineEffectRunner?.flush(),My(t);let s=null,a=null;(function sle(r){return 2!==r.type})(r)&&(a=function Q4e(r){return r[Bl]??function J4e(r){const t=Sz.pop()??Object.create(tle);return t.lView=r,t}(r)}(t),s=function ct(r){return r&&(r.nextProducerIndex=0),on(r)}(a));try{ox(t),function fx(r){return $t.lFrame.bindingIndex=r}(r.bindingStartIndex),null!==e&&uz(r,t,e,2,n);const c=3==(3&i);if(c){const f=r.preOrderCheckHooks;null!==f&&Fh(t,f,null)}else{const f=r.preOrderHooks;null!==f&&Uh(t,f,0,null),oM(t,0)}if(function ale(r){for(let t=Oz(r);null!==t;t=Tz(t)){if(!(t[Ot]&sy.HasTransplantedViews))continue;const e=t[R0];for(let n=0;n<e.length;n++){Tae(e[n])}}}(t),Az(t,0),null!==r.contentQueries&&Cz(r,t),c){const f=r.contentCheckHooks;null!==f&&Fh(t,f)}else{const f=r.contentHooks;null!==f&&Uh(t,f,1),oM(t,1)}!function O4e(r,t){const e=r.hostBindingOpCodes;if(null!==e)try{for(let n=0;n<e.length;n++){const i=e[n];if(i<0)ql(~i);else{const o=i,s=e[++n],a=e[++n];Dae(s,o),a(2,t[o])}}}finally{ql(-1)}}(r,t);const l=r.components;null!==l&&Iz(t,l,0);const u=r.viewQuery;if(null!==u&&UM(2,u,n),c){const f=r.viewCheckHooks;null!==f&&Fh(t,f)}else{const f=r.viewHooks;null!==f&&Uh(t,f,2),oM(t,2)}if(!0===r.firstUpdatePass&&(r.firstUpdatePass=!1),t[ch]){for(const f of t[ch])f();t[ch]=null}t[Ot]&=-73}catch(c){throw qu(t),c}finally{null!==a&&(function Bt(r,t){if(on(t),r&&void 0!==r.producerNode&&void 0!==r.producerIndexOfThis&&void 0!==r.producerLastReadVersion){if(_a(r))for(let e=r.nextProducerIndex;e<r.producerNode.length;e++)J2(r.producerNode[e],r.producerIndexOfThis[e]);for(;r.producerNode.length>r.nextProducerIndex;)r.producerNode.pop(),r.producerLastReadVersion.pop(),r.producerIndexOfThis.pop()}}(a,s),function ele(r){r.lView[Bl]!==r&&(r.lView=null,Sz.push(r))}(a)),Ey()}}function Az(r,t){for(let e=Oz(r);null!==e;e=Tz(e))for(let n=Dr;n<e.length;n++)Nz(e[n],t)}function cle(r,t,e){Nz(es(t,r),e)}function Nz(r,t){dy(r)&&WM(r,t)}function WM(r,t){const n=r[He],i=r[Ot],o=r[Bl];let s=!!(0===t&&16&i);if(s||=!!(64&i&&0===t),s||=!!(1024&i),s||=!(!o?.dirty||!Pn(o)),o&&(o.dirty=!1),r[Ot]&=-9217,s)ole(n,r,n.template,r[R1]);else if(8192&i){Az(r,1);const a=n.components;null!==a&&Iz(r,a,1)}}function Iz(r,t,e){for(let n=0;n<t.length;n++)cle(r,t[n],e)}function g7(r){for(r[p3].changeDetectionScheduler?.notify();r;){r[Ot]|=64;const t=Wl(r);if(cy(r)&&!t)return r;r=t}return null}class p7{get rootNodes(){const t=this._lView,e=t[He];return h7(e,t,e.firstChild,[])}constructor(t,e,n=!0){this._lView=t,this._cdRefInjectingView=e,this.notifyErrorHandler=n,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[R1]}set context(t){this._lView[R1]=t}get destroyed(){return 256==(256&this._lView[Ot])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const t=this._lView[zr];if(A2(t)){const e=t[8],n=e?e.indexOf(this):-1;n>-1&&(c7(t,n),gh(e,n))}this._attachedToViewContainer=!1}ig(this._lView[He],this._lView)}onDestroy(t){fh(this._lView,t)}markForCheck(){g7(this._cdRefInjectingView||this._lView)}detach(){this._lView[Ot]&=-129}reattach(){gy(this._lView),this._lView[Ot]|=128}detectChanges(){this._lView[Ot]|=1024,dg(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new de(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,jL(this._lView[He],this._lView)}attachToAppRef(t){if(this._attachedToViewContainer)throw new de(902,!1);this._appRef=t,gy(this._lView)}}let E3=(()=>{class r{static#e=this.__NG_ELEMENT_ID__=fle}return r})();const lle=E3,ule=class extends lle{constructor(t,e,n){super(),this._declarationLView=t,this._declarationTContainer=e,this.elementRef=n}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(t,e){return this.createEmbeddedViewImpl(t,e)}createEmbeddedViewImpl(t,e,n){const i=function f7(r,t,e,n){const i=on(null);try{const o=t.tView,c=lg(r,o,e,4096&r[Ot]?4096:16,null,t,null,null,null,n?.injector??null,n?.dehydratedView??null);c[Uu]=r[t.index];const u=r[m3];return null!==u&&(c[m3]=u.createEmbeddedView(o)),BM(o,c,e),c}finally{on(i)}}(this._declarationLView,this._declarationTContainer,t,{injector:e,dehydratedView:n});return new p7(i)}};function fle(){return hg(d1(),Ce())}function hg(r,t){return 4&r.type?new ule(t,r,z0(r,t)):null}class XM{}class Rle{}class Vz{}class Lle{resolveComponentFactory(t){throw function xle(r){const t=Error(`No component factory found for ${pi(r)}.`);return t.ngComponent=r,t}(t)}}let Cg=(()=>{class r{static#e=this.NULL=new Lle}return r})();class QM{}let lc=(()=>{class r{constructor(){this.destroyNode=null}static#e=this.__NG_ELEMENT_ID__=()=>function zle(){const r=Ce(),e=es(d1().index,r);return(b2(e)?e:r)[Yt]}()}return r})(),Dle=(()=>{class r{static#e=this.\u0275prov=xe({token:r,providedIn:"root",factory:()=>null})}return r})();const JM={};let vg=(()=>{class r{static#e=this.__NG_ELEMENT_ID__=Hle;static#t=this.__NG_ENV_ID__=e=>e}return r})();class Vle extends vg{constructor(t){super(),this._lView=t}onDestroy(t){return fh(this._lView,t),()=>function py(r,t){if(null===r[_4])return;const e=r[_4].indexOf(t);-1!==e&&r[_4].splice(e,1)}(this._lView,t)}}function Hle(){return new Vle(Ce())}const Fz=new Set;function uc(r){Fz.has(r)||(Fz.add(r),performance?.mark?.("mark_feature_usage",{detail:{feature:r}}))}function Uz(...r){}class Xn{constructor({enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:e=!1,shouldCoalesceRunChangeDetection:n=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new i1(!1),this.onMicrotaskEmpty=new i1(!1),this.onStable=new i1(!1),this.onError=new i1(!1),typeof Zone>"u")throw new de(908,!1);Zone.assertZonePatched();const i=this;i._nesting=0,i._outer=i._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(i._inner=i._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(i._inner=i._inner.fork(Zone.longStackTraceZoneSpec)),i.shouldCoalesceEventChangeDetection=!n&&e,i.shouldCoalesceRunChangeDetection=n,i.lastRequestAnimationFrameId=-1,i.nativeRequestAnimationFrame=function Fle(){const r="function"==typeof o1.requestAnimationFrame;let t=o1[r?"requestAnimationFrame":"setTimeout"],e=o1[r?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&t&&e){const n=t[Zone.__symbol__("OriginalDelegate")];n&&(t=n);const i=e[Zone.__symbol__("OriginalDelegate")];i&&(e=i)}return{nativeRequestAnimationFrame:t,nativeCancelAnimationFrame:e}}().nativeRequestAnimationFrame,function Ble(r){const t=()=>{!function Gle(r){r.isCheckStableRunning||-1!==r.lastRequestAnimationFrameId||(r.lastRequestAnimationFrameId=r.nativeRequestAnimationFrame.call(o1,()=>{r.fakeTopEventTask||(r.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{r.lastRequestAnimationFrameId=-1,tE(r),r.isCheckStableRunning=!0,eE(r),r.isCheckStableRunning=!1},void 0,()=>{},()=>{})),r.fakeTopEventTask.invoke()}),tE(r))}(r)};r._inner=r._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(e,n,i,o,s,a)=>{if(function $le(r){return!(!Array.isArray(r)||1!==r.length)&&!0===r[0].data?.__ignore_ng_zone__}(a))return e.invokeTask(i,o,s,a);try{return Gz(r),e.invokeTask(i,o,s,a)}finally{(r.shouldCoalesceEventChangeDetection&&"eventTask"===o.type||r.shouldCoalesceRunChangeDetection)&&t(),Bz(r)}},onInvoke:(e,n,i,o,s,a,c)=>{try{return Gz(r),e.invoke(i,o,s,a,c)}finally{r.shouldCoalesceRunChangeDetection&&t(),Bz(r)}},onHasTask:(e,n,i,o)=>{e.hasTask(i,o),n===i&&("microTask"==o.change?(r._hasPendingMicrotasks=o.microTask,tE(r),eE(r)):"macroTask"==o.change&&(r.hasPendingMacrotasks=o.macroTask))},onHandleError:(e,n,i,o)=>(e.handleError(i,o),r.runOutsideAngular(()=>r.onError.emit(o)),!1)})}(i)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Xn.isInAngularZone())throw new de(909,!1)}static assertNotInAngularZone(){if(Xn.isInAngularZone())throw new de(909,!1)}run(t,e,n){return this._inner.run(t,e,n)}runTask(t,e,n,i){const o=this._inner,s=o.scheduleEventTask("NgZoneEvent: "+i,t,Ule,Uz,Uz);try{return o.runTask(s,e,n)}finally{o.cancelTask(s)}}runGuarded(t,e,n){return this._inner.runGuarded(t,e,n)}runOutsideAngular(t){return this._outer.run(t)}}const Ule={};function eE(r){if(0==r._nesting&&!r.hasPendingMicrotasks&&!r.isStable)try{r._nesting++,r.onMicrotaskEmpty.emit(null)}finally{if(r._nesting--,!r.hasPendingMicrotasks)try{r.runOutsideAngular(()=>r.onStable.emit(null))}finally{r.isStable=!0}}}function tE(r){r.hasPendingMicrotasks=!!(r._hasPendingMicrotasks||(r.shouldCoalesceEventChangeDetection||r.shouldCoalesceRunChangeDetection)&&-1!==r.lastRequestAnimationFrameId)}function Gz(r){r._nesting++,r.isStable&&(r.isStable=!1,r.onUnstable.emit(null))}function Bz(r){r._nesting--,eE(r)}class $z{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new i1,this.onMicrotaskEmpty=new i1,this.onStable=new i1,this.onError=new i1}run(t,e,n){return t.apply(e,n)}runGuarded(t,e,n){return t.apply(e,n)}runOutsideAngular(t){return t()}runTask(t,e,n,i){return t.apply(e,n)}}var Jl=function(r){return r[r.EarlyRead=0]="EarlyRead",r[r.Write=1]="Write",r[r.MixedReadWrite=2]="MixedReadWrite",r[r.Read=3]="Read",r}(Jl||{});const Wz={destroy(){}};function qz(r,t){!t&&function Dh(r){if(!kx()&&!function lce(){return H0}())throw new de(-203,!1)}();const e=t?.injector??Ne(no);if(!function P4(r){return"browser"===(r??Ne(no)).get(y4)}(e))return Wz;uc("NgAfterNextRender");const n=e.get(y7),i=n.handler??=new Zz,o=t?.phase??Jl.MixedReadWrite,s=()=>{i.unregister(c),a()},a=e.get(vg).onDestroy(s),c=new jz(e,o,()=>{s(),r()});return i.register(c),{destroy:s}}class jz{constructor(t,e,n){this.phase=e,this.callbackFn=n,this.zone=t.get(Xn),this.errorHandler=t.get(v3,null,{optional:!0})}invoke(){try{this.zone.runOutsideAngular(this.callbackFn)}catch(t){this.errorHandler?.handleError(t)}}}class Zz{constructor(){this.executingCallbacks=!1,this.buckets={[Jl.EarlyRead]:new Set,[Jl.Write]:new Set,[Jl.MixedReadWrite]:new Set,[Jl.Read]:new Set},this.deferredCallbacks=new Set}register(t){(this.executingCallbacks?this.deferredCallbacks:this.buckets[t.phase]).add(t)}unregister(t){this.buckets[t.phase].delete(t),this.deferredCallbacks.delete(t)}execute(){this.executingCallbacks=!0;for(const t of Object.values(this.buckets))for(const e of t)e.invoke();this.executingCallbacks=!1;for(const t of this.deferredCallbacks)this.buckets[t.phase].add(t);this.deferredCallbacks.clear()}destroy(){for(const t of Object.values(this.buckets))t.clear();this.deferredCallbacks.clear()}}let y7=(()=>{class r{constructor(){this.handler=null,this.internalCallbacks=[]}execute(){this.executeInternalCallbacks(),this.handler?.execute()}executeInternalCallbacks(){const e=[...this.internalCallbacks];this.internalCallbacks.length=0;for(const n of e)n()}ngOnDestroy(){this.handler?.destroy(),this.handler=null,this.internalCallbacks.length=0}static#e=this.\u0275prov=xe({token:r,providedIn:"root",factory:()=>new r})}return r})();function Mg(r,t,e){let n=e?r.styles:null,i=e?r.classes:null,o=0;if(null!==t)for(let s=0;s<t.length;s++){const a=t[s];"number"==typeof a?o=a:1==o?i=ty(i,a):2==o&&(n=ty(n,a+": "+t[++s]+";"))}e?r.styles=n:r.stylesWithoutHost=n,e?r.classes=i:r.classesWithoutHost=i}class Xz extends Cg{constructor(t){super(),this.ngModule=t}resolveComponentFactory(t){const e=_n(t);return new P7(e,this.ngModule)}}function Qz(r){const t=[];for(const e in r){if(!r.hasOwnProperty(e))continue;const n=r[e];void 0!==n&&t.push({propName:Array.isArray(n)?n[0]:n,templateName:e})}return t}class Kle{constructor(t,e){this.injector=t,this.parentInjector=e}get(t,e,n){n=Sh(n);const i=this.injector.get(t,JM,n);return i!==JM||e===JM?i:this.parentInjector.get(t,e,n)}}class P7 extends Vz{get inputs(){const t=this.componentDef,e=t.inputTransforms,n=Qz(t.inputs);if(null!==e)for(const i of n)e.hasOwnProperty(i.propName)&&(i.transform=e[i.propName]);return n}get outputs(){return Qz(this.componentDef.outputs)}constructor(t,e){super(),this.componentDef=t,this.ngModule=e,this.componentType=t.type,this.selector=function hae(r){return r.map(dae).join(",")}(t.selectors),this.ngContentSelectors=t.ngContentSelectors?t.ngContentSelectors:[],this.isBoundToModule=!!e}create(t,e,n,i){const o=on(null);try{let s=(i=i||this.ngModule)instanceof To?i:i?.injector;s&&null!==this.componentDef.getStandaloneInjector&&(s=this.componentDef.getStandaloneInjector(s)||s);const a=s?new Kle(t,s):t,c=a.get(QM,null);if(null===c)throw new de(407,!1);const l=a.get(Dle,null),g={rendererFactory:c,sanitizer:l,inlineEffectRunner:null,afterRenderEventManager:a.get(y7,null),changeDetectionScheduler:a.get(XM,null)},y=c.createRenderer(null,this.componentDef),S=this.componentDef.selectors[0][0]||"div",N=n?function w4e(r,t,e,n){const o=n.get(vL,!1)||e===Ca.ShadowDom,s=r.selectRootElement(t,o);return function b4e(r){dz(r)}(s),s}(y,n,this.componentDef.encapsulation,a):rg(y,S,function Yle(r){const t=r.toLowerCase();return"svg"===t?nx:"math"===t?"math":null}(S));let R=512;this.componentDef.signals?R|=4096:this.componentDef.onPush||(R|=16);let U=null;null!==N&&(U=$y(N,a,!0));const $=DM(0,null,null,1,0,null,null,null,null,null,null),re=lg(null,$,null,R,null,null,g,y,a,null,U);let _e,be;My(re);try{const Ve=this.componentDef;let dt,Xt=null;Ve.findHostDirectiveDefs?(dt=[],Xt=new Map,Ve.findHostDirectiveDefs(Ve,dt,Xt),dt.push(Ve)):dt=[Ve];const u1=function Qle(r,t){const e=r[He],n=Jt;return r[n]=t,n8(e,n,2,"#host",null)}(re,N),an=function Jle(r,t,e,n,i,o,s){const a=i[He];!function e6e(r,t,e,n){for(const i of r)t.mergedAttrs=Hu(t.mergedAttrs,i.hostAttrs);null!==t.mergedAttrs&&(Mg(t,t.mergedAttrs,!0),null!==e&&sz(n,e,t))}(n,r,t,s);let c=null;null!==t&&(c=$y(t,i[t2]));const l=o.rendererFactory.createRenderer(t,e);let u=16;e.signals?u=4096:e.onPush&&(u=64);const f=lg(i,fz(e),null,u,i[r.index],r,o,l,null,null,c);return a.firstCreatePass&&HM(a,r,n.length-1),ug(i,f),i[r.index]=f}(u1,N,Ve,dt,re,g,y);be=Wu($,Jt),N&&function n6e(r,t,e,n){if(n)iy(r,e,["ng-version","17.2.4"]);else{const{attrs:i,classes:o}=function gae(r){const t=[],e=[];let n=1,i=2;for(;n<r.length;){let o=r[n];if("string"==typeof o)2===i?""!==o&&t.push(o,r[++n]):8===i&&e.push(o);else{if(!va(i))break;i=o}n++}return{attrs:t,classes:e}}(t.selectors[0]);i&&iy(r,e,i),o&&o.length>0&&oz(r,e,o.join(" "))}}(y,Ve,N,n),void 0!==e&&function r6e(r,t,e){const n=r.projection=[];for(let i=0;i<t.length;i++){const o=e[i];n.push(null!=o?Array.from(o):null)}}(be,this.ngContentSelectors,e),_e=function t6e(r,t,e,n,i,o){const s=d1(),a=i[He],c=eo(s,i);pz(a,i,s,e,null,n);for(let u=0;u<e.length;u++)k2(Kl(i,a,s.directiveStart+u,s),i);mz(a,i,s),c&&k2(c,i);const l=Kl(i,a,s.directiveStart+s.componentOffset,s);if(r[R1]=i[R1]=l,null!==o)for(const u of o)u(l,t);return xM(a,s,i),l}(an,Ve,dt,Xt,re,[i6e]),BM($,re,null)}finally{Ey()}return new Xle(this.componentType,_e,z0(be,re),re,be)}finally{on(o)}}}class Xle extends Rle{constructor(t,e,n,i,o){super(),this.location=n,this._rootLView=i,this._tNode=o,this.previousInputValues=null,this.instance=e,this.hostView=this.changeDetectorRef=new p7(i,void 0,!1),this.componentType=t}setInput(t,e){const n=this._tNode.inputs;let i;if(null!==n&&(i=n[t])){if(this.previousInputValues??=new Map,this.previousInputValues.has(t)&&Object.is(this.previousInputValues.get(t),e))return;const o=this._rootLView;GM(o[He],o,i,t,e),this.previousInputValues.set(t,e),g7(es(this._tNode.index,o))}}get injector(){return new Ci(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(t){this.hostView.onDestroy(t)}}function i6e(){const r=d1();Hh(Ce()[He],r)}let os=(()=>{class r{static#e=this.__NG_ELEMENT_ID__=o6e}return r})();function o6e(){return tD(d1(),Ce())}const s6e=os,Jz=class extends s6e{constructor(t,e,n){super(),this._lContainer=t,this._hostTNode=e,this._hostLView=n}get element(){return z0(this._hostTNode,this._hostLView)}get injector(){return new Ci(this._hostTNode,this._hostLView)}get parentInjector(){const t=$h(this._hostTNode,this._hostLView);if(aM(t)){const e=r7(t,this._hostLView),n=n7(t);return new Ci(e[He].data[n+8],e)}return new Ci(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(t){const e=eD(this._lContainer);return null!==e&&e[t]||null}get length(){return this._lContainer.length-Dr}createEmbeddedView(t,e,n){let i,o;"number"==typeof n?i=n:null!=n&&(i=n.index,o=n.injector);const a=t.createEmbeddedViewImpl(e||{},o,null);return this.insertImpl(a,i,r8(this._hostTNode,null)),a}createComponent(t,e,n,i,o){const s=t&&!function e7(r){return"function"==typeof r}(t);let a;if(s)a=e;else{const S=e||{};a=S.index,n=S.injector,i=S.projectableNodes,o=S.environmentInjector||S.ngModuleRef}const c=s?t:new P7(_n(t)),l=n||this.parentInjector;if(!o&&null==c.ngModule){const N=(s?l:this.parentInjector).get(To,null);N&&(o=N)}_n(c.componentType??{});const y=c.create(l,i,null,o);return this.insertImpl(y.hostView,a,r8(this._hostTNode,null)),y}insert(t,e){return this.insertImpl(t,e,!0)}insertImpl(t,e,n){const i=t._lView;if(function Oae(r){return A2(r[zr])}(i)){const a=this.indexOf(t);if(-1!==a)this.detach(a);else{const c=i[zr],l=new Jz(c,c[w2],c[zr]);l.detach(l.indexOf(t))}}const o=this._adjustIndex(e),s=this._lContainer;return d7(s,i,o,n),t.attachToViewContainerRef(),Mx(oE(s),o,t),t}move(t,e){return this.insert(t,e)}indexOf(t){const e=eD(this._lContainer);return null!==e?e.indexOf(t):-1}remove(t){const e=this._adjustIndex(t,-1),n=c7(this._lContainer,e);n&&(gh(oE(this._lContainer),e),ig(n[He],n))}detach(t){const e=this._adjustIndex(t,-1),n=c7(this._lContainer,e);return n&&null!=gh(oE(this._lContainer),e)?new p7(n):null}_adjustIndex(t,e=0){return t??this.length+e}};function eD(r){return r[8]}function oE(r){return r[8]||(r[8]=[])}function tD(r,t){let e;const n=t[r.index];return A2(n)?e=n:(e=_z(n,t,null,r),t[r.index]=e,ug(t,e)),nD(e,t,r,n),new Jz(e,r,t)}let nD=function iD(r,t,e,n){if(r[nc])return;let i;i=8&e.type?y1(n):function a6e(r,t){const e=r[Yt],n=e.createComment(""),i=eo(t,r);return Ql(e,og(e,i),n,function y4e(r,t){return r.nextSibling(t)}(e,i),!1),n}(t,e),r[nc]=i},sE=()=>!1;class aE{constructor(t){this.queryList=t,this.matches=null}clone(){return new aE(this.queryList)}setDirty(){this.queryList.setDirty()}}class cE{constructor(t=[]){this.queries=t}createEmbeddedView(t){const e=t.queries;if(null!==e){const n=null!==t.contentQueries?t.contentQueries[0]:e.length,i=[];for(let o=0;o<n;o++){const s=e.getByIndex(o);i.push(this.queries[s.indexInDeclarationView].clone())}return new cE(i)}return null}insertView(t){this.dirtyQueriesWithMatches(t)}detachView(t){this.dirtyQueriesWithMatches(t)}finishViewCreation(t){this.dirtyQueriesWithMatches(t)}dirtyQueriesWithMatches(t){for(let e=0;e<this.queries.length;e++)null!==hE(t,e).matches&&this.queries[e].setDirty()}}class oD{constructor(t,e,n=null){this.flags=e,this.read=n,this.predicate="string"==typeof t?function p6e(r){return r.split(",").map(t=>t.trim())}(t):t}}class lE{constructor(t=[]){this.queries=t}elementStart(t,e){for(let n=0;n<this.queries.length;n++)this.queries[n].elementStart(t,e)}elementEnd(t){for(let e=0;e<this.queries.length;e++)this.queries[e].elementEnd(t)}embeddedTView(t){let e=null;for(let n=0;n<this.length;n++){const i=null!==e?e.length:0,o=this.getByIndex(n).embeddedTView(t,i);o&&(o.indexInDeclarationView=n,null!==e?e.push(o):e=[o])}return null!==e?new lE(e):null}template(t,e){for(let n=0;n<this.queries.length;n++)this.queries[n].template(t,e)}getByIndex(t){return this.queries[t]}get length(){return this.queries.length}track(t){this.queries.push(t)}}class uE{constructor(t,e=-1){this.metadata=t,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=e}elementStart(t,e){this.isApplyingToNode(e)&&this.matchTNode(t,e)}elementEnd(t){this._declarationNodeIndex===t.index&&(this._appliesToNextNode=!1)}template(t,e){this.elementStart(t,e)}embeddedTView(t,e){return this.isApplyingToNode(t)?(this.crossesNgTemplate=!0,this.addMatch(-t.index,e),new uE(this.metadata)):null}isApplyingToNode(t){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const e=this._declarationNodeIndex;let n=t.parent;for(;null!==n&&8&n.type&&n.index!==e;)n=n.parent;return e===(null!==n?n.index:-1)}return this._appliesToNextNode}matchTNode(t,e){const n=this.metadata.predicate;if(Array.isArray(n))for(let i=0;i<n.length;i++){const o=n[i];this.matchTNodeWithReadOption(t,e,f6e(e,o)),this.matchTNodeWithReadOption(t,e,Wh(e,t,o,!1,!1))}else n===E3?4&e.type&&this.matchTNodeWithReadOption(t,e,-1):this.matchTNodeWithReadOption(t,e,Wh(e,t,n,!1,!1))}matchTNodeWithReadOption(t,e,n){if(null!==n){const i=this.metadata.read;if(null!==i)if(i===I2||i===os||i===E3&&4&e.type)this.addMatch(e.index,-2);else{const o=Wh(e,t,i,!1,!1);null!==o&&this.addMatch(e.index,o)}else this.addMatch(e.index,n)}}addMatch(t,e){null===this.matches?this.matches=[t,e]:this.matches.push(t,e)}}function f6e(r,t){const e=r.localNames;if(null!==e)for(let n=0;n<e.length;n+=2)if(e[n]===t)return e[n+1];return null}function h6e(r,t,e,n){return-1===e?function d6e(r,t){return 11&r.type?z0(r,t):4&r.type?hg(r,t):null}(t,r):-2===e?function g6e(r,t,e){return e===I2?z0(t,r):e===E3?hg(t,r):e===os?tD(t,r):void 0}(r,t,n):Kl(r,r[He],e,t)}function sD(r,t,e,n){const i=t[m3].queries[n];if(null===i.matches){const o=r.data,s=e.matches,a=[];for(let c=0;null!==s&&c<s.length;c+=2){const l=s[c];a.push(l<0?null:h6e(t,o[l],s[c+1],e.metadata.read))}i.matches=a}return i.matches}function fE(r,t,e,n){const i=r.queries.getByIndex(e),o=i.matches;if(null!==o){const s=sD(r,t,i,e);for(let a=0;a<o.length;a+=2){const c=o[a];if(c>0)n.push(s[a/2]);else{const l=o[a+1],u=t[-c];for(let f=Dr;f<u.length;f++){const g=u[f];g[Uu]===g[zr]&&fE(g[He],g,l,n)}if(null!==u[R0]){const f=u[R0];for(let g=0;g<f.length;g++){const y=f[g];fE(y[He],y,l,n)}}}}}return n}function cD(r,t,e){const n=On();return n.firstCreatePass&&(function uD(r,t,e){null===r.queries&&(r.queries=new lE),r.queries.track(new uE(t,e))}(n,new oD(r,t,e),-1),2==(2&t)&&(n.staticViewQueries=!0)),function aD(r,t,e){const n=new Oy(4==(4&e));return function I4e(r,t,e,n){const i=vz(t);i.push(e),r.firstCreatePass&&yz(r).push(n,i.length-1)}(r,t,n,n.destroy),(t[m3]??=new cE).queries.push(new aE(n))-1}(n,Ce(),t)}function hE(r,t){return r.queries.getByIndex(t)}function fD(r,t){const e=r[He],n=hE(e,t);return n.crossesNgTemplate?fE(e,r,t,[]):sD(e,r,n,t)}function gD(r){return function dD(r){return"function"==typeof r&&void 0!==r[Eo]}(r)&&"function"==typeof r.set}function $e(r){let t=function OD(r){return Object.getPrototypeOf(r.prototype).constructor}(r.type),e=!0;const n=[r];for(;t;){let i;if(Ea(r))i=t.\u0275cmp||t.\u0275dir;else{if(t.\u0275cmp)throw new de(903,!1);i=t.\u0275dir}if(i){if(e){n.push(i);const s=r;s.inputs=Pg(r.inputs),s.inputTransforms=Pg(r.inputTransforms),s.declaredInputs=Pg(r.declaredInputs),s.outputs=Pg(r.outputs);const a=i.hostBindings;a&&I6e(r,a);const c=i.viewQuery,l=i.contentQueries;if(c&&A6e(r,c),l&&N6e(r,l),w6e(r,i),rae(r.outputs,i.outputs),Ea(i)&&i.data.animation){const u=r.data;u.animation=(u.animation||[]).concat(i.data.animation)}}const o=i.features;if(o)for(let s=0;s<o.length;s++){const a=o[s];a&&a.ngInherit&&a(r),a===$e&&(e=!1)}}t=Object.getPrototypeOf(t)}!function b6e(r){let t=0,e=null;for(let n=r.length-1;n>=0;n--){const i=r[n];i.hostVars=t+=i.hostVars,i.hostAttrs=Hu(i.hostAttrs,e=Hu(e,i.hostAttrs))}}(n)}function w6e(r,t){for(const e in t.inputs){if(!t.inputs.hasOwnProperty(e)||r.inputs.hasOwnProperty(e))continue;const n=t.inputs[e];if(void 0!==n&&(r.inputs[e]=n,r.declaredInputs[e]=t.declaredInputs[e],null!==t.inputTransforms)){const i=Array.isArray(n)?n[0]:n;if(!t.inputTransforms.hasOwnProperty(i))continue;r.inputTransforms??={},r.inputTransforms[i]=t.inputTransforms[i]}}}function Pg(r){return r===tc?{}:r===Zn?[]:r}function A6e(r,t){const e=r.viewQuery;r.viewQuery=e?(n,i)=>{t(n,i),e(n,i)}:t}function N6e(r,t){const e=r.contentQueries;r.contentQueries=e?(n,i,o)=>{t(n,i,o),e(n,i,o)}:t}function I6e(r,t){const e=r.hostBindings;r.hostBindings=e?(n,i)=>{t(n,i),e(n,i)}:t}function AD(r){const t=r.inputConfig,e={};for(const n in t)if(t.hasOwnProperty(n)){const i=t[n];Array.isArray(i)&&i[3]&&(e[n]=i[3])}r.inputTransforms=e}class e6{}class ND{}class pE extends e6{constructor(t,e,n){super(),this._parent=e,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new Xz(this);const i=T2(t);this._bootstrapComponents=is(i.bootstrap),this._r3Injector=pL(t,e,[{provide:e6,useValue:this},{provide:Cg,useValue:this.componentFactoryResolver},...n],pi(t),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(t)}get injector(){return this._r3Injector}destroy(){const t=this._r3Injector;!t.destroyed&&t.destroy(),this.destroyCbs.forEach(e=>e()),this.destroyCbs=null}onDestroy(t){this.destroyCbs.push(t)}}class mE extends ND{constructor(t){super(),this.moduleType=t}create(t){return new pE(this.moduleType,t,[])}}class ID extends e6{constructor(t){super(),this.componentFactoryResolver=new Xz(this),this.instance=null;const e=new j0([...t.providers,{provide:e6,useValue:this},{provide:Cg,useValue:this.componentFactoryResolver}],t.parent||zh(),t.debugName,new Set(["environment"]));this.injector=e,t.runEnvironmentInitializers&&e.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(t){this.injector.onDestroy(t)}}function Sg(r,t,e=null){return new ID({providers:r,parent:t,debugName:e,runEnvironmentInitializers:!0}).injector}let w4=(()=>{class r{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new Xo(!1)}get _hasPendingTasks(){return this.hasPendingTasks.value}add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);const e=this.taskId++;return this.pendingTasks.add(e),e}remove(e){this.pendingTasks.delete(e),0===this.pendingTasks.size&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275prov=xe({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();function Tg(r){return!!function _E(r){return null!==r&&("function"==typeof r||"object"==typeof r)}(r)&&(Array.isArray(r)||!(r instanceof Map)&&Symbol.iterator in r)}function fc(r,t,e){return r[t]=e}function Vr(r,t,e){return!Object.is(r[t],e)&&(r[t]=e,!0)}function t6(r,t,e,n){const i=Vr(r,t,e);return Vr(r,t+1,n)||i}function z(r,t,e,n,i,o,s,a){const c=Ce(),l=On(),u=r+Jt,f=l.firstCreatePass?function $6e(r,t,e,n,i,o,s,a,c){const l=t.consts,u=n8(t,r,4,s||null,rc(l,a));VM(t,e,u,rc(l,c)),Hh(t,u);const f=u.tView=DM(2,u,n,i,o,t.directiveRegistry,t.pipeRegistry,null,t.schemas,l,null);return null!==t.queries&&(t.queries.template(t,u),f.queries=t.queries.embeddedTView(u)),u}(u,l,c,t,e,n,i,o,s):l.data[u];ic(f,!1);const g=kD(l,c,f,r);hh()&&sg(l,c,g,f),k2(g,c);const y=_z(g,c,g,f);return c[u]=y,ug(c,y),function rD(r,t,e){return sE(r,t,e)}(y,f,c),uh(f)&&LM(l,c,f),null!=s&&zM(c,f,a),z}let kD=function RD(r,t,e,n){return C4(!0),t[Yt].createComment("")};function A(r,t,e,n){const i=Ce();return Vr(i,Pa(),t)&&(On(),function cc(r,t,e,n,i,o){const s=eo(r,t);FM(t[Yt],s,o,r.value,e,n,i)}(x1(),i,r,t,e,n)),A}function h8(r,t,e,n){return Vr(r,Pa(),e)?t+en(e)+n:nn}function g8(r,t,e,n,i,o){const a=t6(r,_3(),e,i);return C3(2),a?t+en(e)+n+en(i)+o:nn}function p8(r,t,e,n,i,o,s,a){const l=function wg(r,t,e,n,i){const o=t6(r,t,e,n);return Vr(r,t+2,i)||o}(r,_3(),e,i,s);return C3(3),l?t+en(e)+n+en(i)+o+en(s)+a:nn}function m8(r,t,e,n,i,o,s,a,c,l){const f=function Ds(r,t,e,n,i,o){const s=t6(r,t,e,n);return t6(r,t+2,i,o)||s}(r,_3(),e,i,s,c);return C3(4),f?t+en(e)+n+en(i)+o+en(s)+a+en(c)+l:nn}function Rg(r,t){return r<<17|t<<2}function A4(r){return r>>17&32767}function wE(r){return 2|r}function r6(r){return(131068&r)>>2}function bE(r,t){return-131069&r|t<<2}function AE(r){return 1|r}function uV(r,t,e,n){const i=r[e+1],o=null===t;let s=n?A4(i):r6(i),a=!1;for(;0!==s&&(!1===a||o);){const l=r[s+1];b0e(r[s],t)&&(a=!0,r[s+1]=n?AE(l):wE(l)),s=n?A4(l):r6(l)}a&&(r[e+1]=n?wE(i):AE(i))}function b0e(r,t){return null===r||null==t||(Array.isArray(r)?r[1]:r)===t||!(!Array.isArray(r)||"string"!=typeof t)&&V0(r,t)>=0}const vi={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function fV(r){return r.substring(vi.key,vi.keyEnd)}function A0e(r){return r.substring(vi.value,vi.valueEnd)}function hV(r,t){const e=vi.textEnd;let n=vi.key=M8(r,t,e);return e===n?-1:(n=vi.keyEnd=function R0e(r,t,e){let n;for(;t<e&&(45===(n=r.charCodeAt(t))||95===n||(-33&n)>=65&&(-33&n)<=90||n>=48&&n<=57);)t++;return t}(r,n,e),n=pV(r,n,e),n=vi.value=M8(r,n,e),n=vi.valueEnd=function x0e(r,t,e){let n=-1,i=-1,o=-1,s=t,a=s;for(;s<e;){const c=r.charCodeAt(s++);if(59===c)return a;34===c||39===c?a=s=mV(r,c,s,e):t===s-4&&85===o&&82===i&&76===n&&40===c?a=s=mV(r,41,s,e):c>32&&(a=s),o=i,i=n,n=-33&c}return a}(r,n,e),pV(r,n,e))}function M8(r,t,e){for(;t<e&&r.charCodeAt(t)<=32;)t++;return t}function pV(r,t,e,n){return(t=M8(r,t,e))<e&&t++,t}function mV(r,t,e,n){let i=-1,o=e;for(;o<n;){const s=r.charCodeAt(o++);if(s==t&&92!==i)return o;i=92==s&&92===i?0:s}throw new Error}function v(r,t,e){const n=Ce();return Vr(n,Pa(),t)&&bo(On(),x1(),n,r,t,n[Yt],e,!1),v}function NE(r,t,e,n,i){const s=i?"class":"style";GM(r,e,t.inputs[s],s,n)}function xg(r,t){return function Sa(r,t,e,n){const i=Ce(),o=On(),s=C3(2);o.firstUpdatePass&&vV(o,r,s,n),t!==nn&&Vr(i,s,t)&&MV(o,o.data[N2()],i,i[Yt],r,i[s+1]=function $0e(r,t){return null==r||""===r||("string"==typeof t?r+=t:"object"==typeof r&&(r=pi(rs(r)))),r}(t,e),n,s)}(r,t,null,!0),xg}function r2(r){!function Oa(r,t,e,n){const i=On(),o=C3(2);i.firstUpdatePass&&vV(i,null,o,n);const s=Ce();if(e!==nn&&Vr(s,o,e)){const a=i.data[N2()];if(PV(a,n)&&!CV(i,o)){let c=n?a.classesWithoutHost:a.stylesWithoutHost;null!==c&&(e=ty(c,e||"")),NE(i,a,s,e,n)}else!function B0e(r,t,e,n,i,o,s,a){i===nn&&(i=Zn);let c=0,l=0,u=0<i.length?i[0]:null,f=0<o.length?o[0]:null;for(;null!==u||null!==f;){const g=c<i.length?i[c+1]:void 0,y=l<o.length?o[l+1]:void 0;let N,S=null;u===f?(c+=2,l+=2,g!==y&&(S=f,N=y)):null===f||null!==u&&u<f?(c+=2,S=u):(l+=2,S=f,N=y),null!==S&&MV(r,t,e,n,S,N,s,a),u=c<i.length?i[c]:null,f=l<o.length?o[l]:null}}(i,a,s,s[Yt],s[o+1],s[o+1]=function U0e(r,t,e){if(null==e||""===e)return Zn;const n=[],i=rs(e);if(Array.isArray(i))for(let o=0;o<i.length;o++)r(n,i[o],!0);else if("object"==typeof i)for(const o in i)i.hasOwnProperty(o)&&r(n,o,i[o]);else"string"==typeof i&&t(n,i);return n}(r,t,e),n,o)}}(yV,L0e,r,!1)}function L0e(r,t){for(let e=function I0e(r){return function gV(r){vi.key=0,vi.keyEnd=0,vi.value=0,vi.valueEnd=0,vi.textEnd=r.length}(r),hV(r,M8(r,0,vi.textEnd))}(t);e>=0;e=hV(t,e))yV(r,fV(t),A0e(t))}function CV(r,t){return t>=r.expandoStartIndex}function vV(r,t,e,n){const i=r.data;if(null===i[e+1]){const o=i[N2()],s=CV(r,e);PV(o,n)&&null===t&&!s&&(t=!1),t=function D0e(r,t,e,n){const i=function vy(r){const t=$t.lFrame.currentDirectiveIndex;return-1===t?null:r[t]}(r);let o=n?t.residualClasses:t.residualStyles;if(null===i)0===(n?t.classBindings:t.styleBindings)&&(e=A7(e=IE(null,r,t,e,n),t.attrs,n),o=null);else{const s=t.directiveStylingLast;if(-1===s||r[s]!==i)if(e=IE(i,r,t,e,n),null===o){let c=function V0e(r,t,e){const n=e?t.classBindings:t.styleBindings;if(0!==r6(n))return r[A4(n)]}(r,t,n);void 0!==c&&Array.isArray(c)&&(c=IE(null,r,t,c[1],n),c=A7(c,t.attrs,n),function H0e(r,t,e,n){r[A4(e?t.classBindings:t.styleBindings)]=n}(r,t,n,c))}else o=function F0e(r,t,e){let n;const i=t.directiveEnd;for(let o=1+t.directiveStylingLast;o<i;o++)n=A7(n,r[o].hostAttrs,e);return A7(n,t.attrs,e)}(r,t,n)}return void 0!==o&&(n?t.residualClasses=o:t.residualStyles=o),e}(i,o,t,n),function T0e(r,t,e,n,i,o){let s=o?t.classBindings:t.styleBindings,a=A4(s),c=r6(s);r[n]=e;let u,l=!1;if(Array.isArray(e)?(u=e[1],(null===u||V0(e,u)>0)&&(l=!0)):u=e,i)if(0!==c){const g=A4(r[a+1]);r[n+1]=Rg(g,a),0!==g&&(r[g+1]=bE(r[g+1],n)),r[a+1]=function S0e(r,t){return 131071&r|t<<17}(r[a+1],n)}else r[n+1]=Rg(a,0),0!==a&&(r[a+1]=bE(r[a+1],n)),a=n;else r[n+1]=Rg(c,0),0===a?a=n:r[c+1]=bE(r[c+1],n),c=n;l&&(r[n+1]=wE(r[n+1])),uV(r,u,n,!0),uV(r,u,n,!1),function w0e(r,t,e,n,i){const o=i?r.residualClasses:r.residualStyles;null!=o&&"string"==typeof t&&V0(o,t)>=0&&(e[n+1]=AE(e[n+1]))}(t,u,r,n,o),s=Rg(a,c),o?t.classBindings=s:t.styleBindings=s}(i,o,t,e,s,n)}}function IE(r,t,e,n,i){let o=null;const s=e.directiveEnd;let a=e.directiveStylingLast;for(-1===a?a=e.directiveStart:a++;a<s&&(o=t[a],n=A7(n,o.hostAttrs,i),o!==r);)a++;return null!==r&&(e.directiveStylingLast=a),n}function A7(r,t,e){const n=e?1:2;let i=-1;if(null!==t)for(let o=0;o<t.length;o++){const s=t[o];"number"==typeof s?i=s:i===n&&(Array.isArray(r)||(r=void 0===r?[]:["",r]),ts(r,s,!!e||t[++o]))}return void 0===r?null:r}function yV(r,t,e){ts(r,t,rs(e))}function MV(r,t,e,n,i,o,s,a){if(!(3&t.type))return;const c=r.data,l=c[a+1],u=function O0e(r){return 1==(1&r)}(l)?EV(c,t,e,i,r6(l),s):void 0;Lg(u)||(Lg(o)||function P0e(r){return 2==(2&r)}(l)&&(o=EV(c,null,e,i,a,s)),function P4e(r,t,e,n,i){if(t)i?r.addClass(e,n):r.removeClass(e,n);else{let o=-1===n.indexOf("-")?void 0:S4.DashCase;null==i?r.removeStyle(e,n,o):("string"==typeof i&&i.endsWith("!important")&&(i=i.slice(0,-10),o|=S4.Important),r.setStyle(e,n,i,o))}}(n,s,$u(N2(),e),i,o))}function EV(r,t,e,n,i,o){const s=null===t;let a;for(;i>0;){const c=r[i],l=Array.isArray(c),u=l?c[1]:c,f=null===u;let g=e[i+1];g===nn&&(g=f?Zn:void 0);let y=f?Sy(g,n):u===n?g:void 0;if(l&&!Lg(y)&&(y=Sy(c,n)),Lg(y)&&(a=y,s))return a;const S=r[i+1];i=s?A4(S):r6(S)}if(null!==t){let c=o?t.residualClasses:t.residualStyles;null!=c&&(a=Sy(c,n))}return a}function Lg(r){return void 0!==r}function PV(r,t){return 0!=(r.flags&(t?8:16))}function E(r,t,e,n){const i=Ce(),o=On(),s=Jt+r,a=i[Yt],c=o.firstCreatePass?function h8e(r,t,e,n,i,o){const s=t.consts,c=n8(t,r,2,n,rc(s,i));return VM(t,e,c,rc(s,o)),null!==c.attrs&&Mg(c,c.attrs,!1),null!==c.mergedAttrs&&Mg(c,c.mergedAttrs,!0),null!==t.queries&&t.queries.elementStart(t,c),c}(s,o,i,t,e,n):o.data[s],l=wV(o,i,c,a,t,r);i[s]=l;const u=uh(c);return ic(c,!0),sz(a,l,c),32!=(32&c.flags)&&hh()&&sg(o,i,l,c),0===function wae(){return $t.lFrame.elementDepthCount}()&&k2(l,i),function bae(){$t.lFrame.elementDepthCount++}(),u&&(LM(o,i,c),xM(o,c,i)),null!==n&&zM(i,c),E}function P(){let r=d1();my()?_y():(r=r.parent,ic(r,!1));const t=r;(function Nae(r){return $t.skipHydrationRootTNode===r})(t)&&function xae(){$t.skipHydrationRootTNode=null}(),function Aae(){$t.lFrame.elementDepthCount--}();const e=On();return e.firstCreatePass&&(Hh(e,r),ay(r)&&e.queries.elementEnd(r)),null!=t.classesWithoutHost&&function Qce(r){return 0!=(8&r.flags)}(t)&&NE(e,t,Ce(),t.classesWithoutHost,!0),null!=t.stylesWithoutHost&&function Jce(r){return 0!=(16&r.flags)}(t)&&NE(e,t,Ce(),t.stylesWithoutHost,!1),P}function V(r,t,e,n){return E(r,t,e,n),P(),V}let wV=(r,t,e,n,i,o)=>(C4(!0),rg(n,i,function Cx(){return $t.lFrame.currentNamespace}()));function jt(r,t,e){const n=Ce(),i=On(),o=r+Jt,s=i.firstCreatePass?function m8e(r,t,e,n,i){const o=t.consts,s=rc(o,n),a=n8(t,r,8,"ng-container",s);return null!==s&&Mg(a,s,!0),VM(t,e,a,rc(o,i)),null!==t.queries&&t.queries.elementStart(t,a),a}(o,i,n,t,e):i.data[o];ic(s,!0);const a=AV(i,n,s,r);return n[o]=a,hh()&&sg(i,n,a,s),k2(a,n),uh(s)&&(LM(i,n,s),xM(i,s,n)),null!=e&&zM(n,s),jt}function Zt(){let r=d1();const t=On();return my()?_y():(r=r.parent,ic(r,!1)),t.firstCreatePass&&(Hh(t,r),ay(r)&&t.queries.elementEnd(r)),Zt}let AV=(r,t,e,n)=>(C4(!0),wM(t[Yt],""));function he(){return Ce()}function zE(r,t,e){const n=Ce();return Vr(n,Pa(),t)&&bo(On(),x1(),n,r,t,n[Yt],e,!0),zE}const i6=void 0;var y8e=["en",[["a","p"],["AM","PM"],i6],[["AM","PM"],i6,i6],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],i6,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],i6,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",i6,"{1} 'at' {0}",i6],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function v8e(r){const e=Math.floor(Math.abs(r)),n=r.toString().replace(/^[^.]*\.?/,"").length;return 1===e&&0===n?1:5}];let E8={};function ro(r){const t=function E8e(r){return r.toLowerCase().replace(/_/g,"-")}(r);let e=kV(t);if(e)return e;const n=t.split("-")[0];if(e=kV(n),e)return e;if("en"===n)return y8e;throw new de(701,!1)}function kV(r){return r in E8||(E8[r]=o1.ng&&o1.ng.common&&o1.ng.common.locales&&o1.ng.common.locales[r]),E8[r]}var D1=function(r){return r[r.LocaleId=0]="LocaleId",r[r.DayPeriodsFormat=1]="DayPeriodsFormat",r[r.DayPeriodsStandalone=2]="DayPeriodsStandalone",r[r.DaysFormat=3]="DaysFormat",r[r.DaysStandalone=4]="DaysStandalone",r[r.MonthsFormat=5]="MonthsFormat",r[r.MonthsStandalone=6]="MonthsStandalone",r[r.Eras=7]="Eras",r[r.FirstDayOfWeek=8]="FirstDayOfWeek",r[r.WeekendRange=9]="WeekendRange",r[r.DateFormat=10]="DateFormat",r[r.TimeFormat=11]="TimeFormat",r[r.DateTimeFormat=12]="DateTimeFormat",r[r.NumberSymbols=13]="NumberSymbols",r[r.NumberFormats=14]="NumberFormats",r[r.CurrencyCode=15]="CurrencyCode",r[r.CurrencySymbol=16]="CurrencySymbol",r[r.CurrencyName=17]="CurrencyName",r[r.Currencies=18]="Currencies",r[r.Directionality=19]="Directionality",r[r.PluralCase=20]="PluralCase",r[r.ExtraData=21]="ExtraData",r}(D1||{});const P8e=["zero","one","two","few","many"],P8="en-US",zg={marker:"element"},Dg={marker:"ICU"};var Ao=function(r){return r[r.SHIFT=2]="SHIFT",r[r.APPEND_EAGERLY=1]="APPEND_EAGERLY",r[r.COMMENT=2]="COMMENT",r}(Ao||{});let RV=P8;function LV(r,t,e){const n=t.insertBeforeIndex,i=Array.isArray(n)?n[0]:n;return null===i?JL(r,0,e):y1(e[i])}function zV(r,t,e,n,i){const o=t.insertBeforeIndex;if(Array.isArray(o)){let s=n,a=null;if(3&t.type||(a=s,s=i),null!==s&&-1===t.componentOffset)for(let c=1;c<o.length;c++)Ql(r,s,e[o[c]],a,!1)}}function DV(r,t){if(r.push(t),r.length>1)for(let e=r.length-2;e>=0;e--){const n=r[e];VV(n)||w8e(n,t)&&null===b8e(n)&&A8e(n,t.index)}}function VV(r){return!(64&r.type)}function w8e(r,t){return VV(t)||r.index>t.index}function b8e(r){const t=r.insertBeforeIndex;return Array.isArray(t)?t[0]:t}function A8e(r,t){const e=r.insertBeforeIndex;Array.isArray(e)?e[0]=t:(tz(LV,zV),r.insertBeforeIndex=t)}function N7(r,t){const e=r.data[t];return null===e||"string"==typeof e?null:e.hasOwnProperty("currentCaseLViewIndex")?e:e.value}function k8e(r,t,e){const n=RM(r,e,64,null,null);return DV(t,n),n}function Vg(r,t){const e=t[r.currentCaseLViewIndex];return null===e?e:e<0?~e:e}function HV(r){return r>>>17}function FV(r){return(131070&r)>>>1}let I7=0,k7=0;function GV(r,t,e,n){const i=e[Yt];let s,o=null;for(let a=0;a<t.length;a++){const c=t[a];if("string"==typeof c){const l=t[++a];null===e[l]&&(e[l]=ng(i,c))}else if("number"==typeof c)switch(1&c){case 0:const l=HV(c);let u,f;if(null===o&&(o=l,s=og(i,n)),l===o?(u=n,f=s):(u=null,f=y1(e[l])),null!==f){const N=FV(c);Ql(i,f,e[N],u,!1);const U=N7(r,N);if(null!==U&&"object"==typeof U){const $=Vg(U,e);null!==$&&GV(r,U.create[$],e,e[U.anchorIdx])}}break;case 1:const y=t[++a],S=t[++a];FM(i,$u(c>>>1,e),null,null,y,S,null)}else switch(c){case Dg:const l=t[++a],u=t[++a];null===e[u]&&k2(e[u]=wM(i,l),e);break;case zg:const f=t[++a],g=t[++a];null===e[g]&&k2(e[g]=rg(i,f,null),e)}}}function BV(r,t,e,n,i){for(let o=0;o<e.length;o++){const s=e[o],a=e[++o];if(s&i){let c="";for(let l=o+1;l<=o+a;l++){const u=e[l];if("string"==typeof u)c+=u;else if("number"==typeof u)if(u<0)c+=en(t[n-u]);else{const f=u>>>2;switch(3&u){case 1:const g=e[++l],y=e[++l],S=r.data[f];"string"==typeof S?FM(t[Yt],t[f],null,S,g,c,y):bo(r,S,t,g,c,t[Yt],y,!1);break;case 0:const N=t[f];null!==N&&qL(t[Yt],N,c);break;case 2:D8e(r,N7(r,f),t,c);break;case 3:$V(r,N7(r,f),n,t)}}}}else{const c=e[o+1];if(c>0&&3==(3&c)){const u=N7(r,c>>>2);t[u.currentCaseLViewIndex]<0&&$V(r,u,n,t)}}o+=a}}function $V(r,t,e,n){let i=n[t.currentCaseLViewIndex];if(null!==i){let o=I7;i<0&&(i=n[t.currentCaseLViewIndex]=~i,o=-1),BV(r,n,t.update[i],e,o)}}function D8e(r,t,e,n){const i=function V8e(r,t){let e=r.cases.indexOf(t);if(-1===e)switch(r.type){case 1:{const n=function S8e(r,t){const e=function IV(r){return ro(r)[D1.PluralCase]}(t)(parseInt(r,10)),n=P8e[e];return void 0!==n?n:"other"}(t,function T8e(){return RV}());e=r.cases.indexOf(n),-1===e&&"other"!==n&&(e=r.cases.indexOf("other"));break}case 0:e=r.cases.indexOf("other")}return-1===e?null:e}(t,n);if(Vg(t,e)!==i&&(WV(r,t,e),e[t.currentCaseLViewIndex]=null===i?null:~i,null!==i)){const s=e[t.anchorIdx];s&&GV(r,t.create[i],e,s)}}function WV(r,t,e){let n=Vg(t,e);if(null!==n){const i=t.remove[n];for(let o=0;o<i.length;o++){const s=i[o];if(s>0){const a=$u(s,e);null!==a&&ag(e[Yt],a)}else WV(r,N7(r,~s),e)}}}function H8e(){const r=[];let e,n,t=-1;function o(a,c){t=0;const l=Vg(a,c);n=null!==l?a.remove[l]:Zn}function s(){if(t<n.length){const a=n[t++];return a>0?e[a]:(r.push(t,n),o(e[He].data[~a],e),s())}return 0===r.length?null:(n=r.pop(),t=r.pop(),s())}return function i(a,c){for(e=c;r.length;)r.pop();return o(a.value,c),s}}const Hg=/\ufffd(\d+):?\d*\ufffd/gi,U8e=/\ufffd(\d+)\ufffd/,jV=/^\s*(\ufffd\d+:?\d*\ufffd)\s*,\s*(select|plural)\s*,/,R7="\ufffd",G8e=/\ufffd\/?\*(\d+:\d+)\ufffd/gi,B8e=/\ufffd(\/?[#*]\d+):?\d*\ufffd/gi,$8e=/\uE500/g;function ZV(r,t,e,n,i,o,s){const a=u7(r,n,1,null);let c=a<<Ao.SHIFT,l=ju();t===l&&(l=null),null===l&&(c|=Ao.APPEND_EAGERLY),s&&(c|=Ao.COMMENT,function f4e(r){void 0===OM&&(OM=r())}(H8e)),i.push(c,null===o?"":o);const u=RM(r,a,s?32:1,null===o?"":o,null);DV(e,u);const f=u.index;return ic(u,!1),null!==l&&t!==l&&function I8e(r,t){let e=r.insertBeforeIndex;null===e?(tz(LV,zV),e=r.insertBeforeIndex=[null,t]):(p4(Array.isArray(e),!0,"Expecting array here"),e.push(t))}(l,f),u}function j8e(r,t,e,n,i,o,s){const a=s.match(Hg),c=ZV(r,t,e,o,n,a?null:s,!1);a&&x7(i,s,c.index,null,0,null)}function x7(r,t,e,n,i,o){const s=r.length,a=s+1;r.push(null,null);const c=s+2,l=t.split(Hg);let u=0;for(let f=0;f<l.length;f++){const g=l[f];if(1&f){const y=i+parseInt(g,10);r.push(-1-y),u|=YV(y)}else""!==g&&r.push(g)}return r.push(e<<2|(n?1:0)),n&&r.push(n,o),r[s]=u,r[a]=r.length-c,u}function YV(r){return 1<<Math.min(r,31)}function KV(r){let t,o,e="",n=0,i=!1;for(;null!==(t=G8e.exec(r));)i?t[0]===`${R7}/*${o}${R7}`&&(n=t.index,i=!1):(e+=r.substring(n,t.index+t[0].length),o=t[1],i=!0);return e+=r.slice(n),e}function XV(r,t,e,n,i,o){let s=0;const a={type:i.type,currentCaseLViewIndex:u7(r,t,1,null),anchorIdx:o,cases:[],create:[],remove:[],update:[]};(function t5e(r,t,e){r.push(YV(t.mainBinding),2,-1-t.mainBinding,e<<2|2)})(e,i,o),function N8e(r,t,e){const n=r.data[t];null===n?r.data[t]=e:n.value=e}(r,o,a);const c=i.values;for(let l=0;l<c.length;l++){const u=c[l],f=[];for(let g=0;g<u.length;g++){const y=u[g];if("string"!=typeof y){const S=f.push(y)-1;u[g]=`\x3c!--\ufffd${S}\ufffd--\x3e`}}s=J8e(r,a,t,e,n,i.cases[l],u.join(""),f)|s}s&&function n5e(r,t,e){r.push(t,1,e<<2|3)}(e,s,o)}function Q8e(r){const t=[],e=[];let n=1,i=0;const o=DE(r=r.replace(jV,function(s,a,c){return n="select"===c?0:1,i=parseInt(a.slice(1),10),""}));for(let s=0;s<o.length;){let a=o[s++].trim();1===n&&(a=a.replace(/\s*(?:=)?(\w+)\s*/,"$1")),a.length&&t.push(a);const c=DE(o[s++]);t.length>e.length&&e.push(c)}return{type:n,mainBinding:i,cases:t,values:e}}function DE(r){if(!r)return[];let t=0;const e=[],n=[],i=/[{}]/g;let o;for(i.lastIndex=0;o=i.exec(r);){const a=o.index;if("}"==o[0]){if(e.pop(),0==e.length){const c=r.substring(t,a);jV.test(c)?n.push(Q8e(c)):n.push(c),t=a+1}}else{if(0==e.length){const c=r.substring(t,a);n.push(c),t=a+1}e.push("{")}}const s=r.substring(t);return n.push(s),n}function J8e(r,t,e,n,i,o,s,a){const c=[],l=[],u=[];t.cases.push(o),t.create.push(c),t.remove.push(l),t.update.push(u);const g=PL(v4()).getInertBodyElement(s),y=CM(g)||g;return y?QV(r,t,e,n,c,l,u,y,i,a,0):0}function QV(r,t,e,n,i,o,s,a,c,l,u){let f=0,g=a.firstChild;for(;g;){const y=u7(r,e,1,null);switch(g.nodeType){case Node.ELEMENT_NODE:const S=g,N=S.tagName.toLowerCase();if(mM.hasOwnProperty(N)){VE(i,zg,N,c,y),r.data[y]=N;const re=S.attributes;for(let _e=0;_e<re.length;_e++){const be=re.item(_e),Ve=be.name.toLowerCase();be.value.match(Hg)?wL.hasOwnProperty(Ve)&&x7(s,be.value,y,be.name,0,_M[Ve]?Xh:null):r5e(i,y,be)}f=QV(r,t,e,n,i,o,s,g,y,l,u+1)|f,JV(o,y,u)}break;case Node.TEXT_NODE:const R=g.textContent||"",U=R.match(Hg);VE(i,null,U?"":R,c,y),JV(o,y,u),U&&(f=x7(s,R,y,null,0,null)|f);break;case Node.COMMENT_NODE:const $=U8e.exec(g.textContent||"");if($){const _e=l[parseInt($[1],10)];VE(i,Dg,"",c,y),XV(r,e,n,c,_e,y),e5e(o,y,u)}}g=g.nextSibling}return f}function JV(r,t,e){0===e&&r.push(t)}function e5e(r,t,e){0===e&&(r.push(~t),r.push(t))}function VE(r,t,e,n,i){null!==t&&r.push(t),r.push(e,i,function R8e(r,t,e){return r|t<<17|e<<1}(0,n,i))}function r5e(r,t,e){r.push(t<<1|1,e.name,e.value)}function No(r,t,e=-1){const n=On(),i=Ce(),o=Jt+r,s=rc(n.consts,t),a=ju();n.firstCreatePass&&function q8e(r,t,e,n,i,o){const s=ju(),a=[],c=[],l=[[]];i=function X8e(r,t){if(function K8e(r){return-1===r}(t))return KV(r);{const e=r.indexOf(`:${t}${R7}`)+2+t.toString().length,n=r.search(new RegExp(`${R7}\\/\\*\\d+:${t}${R7}`));return KV(r.substring(e,n))}}(i,o);const u=function W8e(r){return r.replace($8e," ")}(i).split(B8e);for(let f=0;f<u.length;f++){let g=u[f];if(1&f){const y=47===g.charCodeAt(0),N=(g.charCodeAt(y?1:0),Jt+Number.parseInt(g.substring(y?2:1)));if(y)l.shift(),ic(ju(),!1);else{const R=k8e(r,l[0],N);l.unshift([]),ic(R,!0)}}else{const y=DE(g);for(let S=0;S<y.length;S++){let N=y[S];if(1&S){const R=N;if("object"!=typeof R)throw new Error(`Unable to parse ICU expression in "${i}" message.`);XV(r,e,c,t,R,ZV(r,s,l[0],e,a,"",!0).index)}else""!==N&&j8e(r,s,l[0],a,c,e,N)}}}r.data[n]={create:a,update:c}}(n,null===a?0:a.index,i,o,s,e),2===n.type?i[_r][Ot]|=32:i[Ot]|=32;const c=n.data[o],u=YL(n,a===i[w2]?null:a,i);(function z8e(r,t,e,n){const i=r[Yt];for(let o=0;o<t.length;o++){const s=t[o++],a=t[o],l=(s&Ao.APPEND_EAGERLY)===Ao.APPEND_EAGERLY,u=s>>>Ao.SHIFT;let f=r[u];null===f&&(f=r[u]=(s&Ao.COMMENT)===Ao.COMMENT?i.createComment(a):ng(i,a)),l&&null!==e&&Ql(i,e,f,n,!1)}})(i,c.create,u,a&&8&a.type?i[a.index]:null),dx(!0)}function Io(){dx(!1)}function se(r,t,e){No(r,t,e),Io()}function Bn(r){return function x8e(r){r&&(I7|=1<<Math.min(k7,31)),k7++}(Vr(Ce(),Pa(),r)),Bn}function Yn(r){!function L8e(r,t,e){if(k7>0){const n=r.data[e];BV(r,t,Array.isArray(n)?n:n.update,_3()-k7-1,I7)}I7=0,k7=0}(On(),Ce(),r+Jt)}function q(r,t,e,n){const i=Ce(),o=On(),s=d1();return HE(o,i,i[Yt],s,r,t,n),q}function HE(r,t,e,n,i,o,s){const a=uh(n),l=r.firstCreatePass&&yz(r),u=t[R1],f=vz(t);let g=!0;if(3&n.type||s){const N=eo(n,t),R=s?s(N):N,U=f.length,$=s?_e=>s(y1(_e[n.index])):n.index;let re=null;if(!s&&a&&(re=function g5e(r,t,e,n){const i=r.cleanup;if(null!=i)for(let o=0;o<i.length-1;o+=2){const s=i[o];if(s===e&&i[o+1]===n){const a=t[N0],c=i[o+2];return a.length>c?a[c]:null}"string"==typeof s&&(o+=2)}return null}(r,t,i,n.index)),null!==re)(re.__ngLastListenerFn__||re).__ngNextListenerFn__=o,re.__ngLastListenerFn__=o,g=!1;else{o=rH(n,t,u,o,!1);const _e=e.listen(R,i,o);f.push(o,_e),l&&l.push(i,$,U,U+1)}}else o=rH(n,t,u,o,!1);const y=n.outputs;let S;if(g&&null!==y&&(S=y[i])){const N=S.length;if(N)for(let R=0;R<N;R+=2){const be=t[S[R]][S[R+1]].subscribe(o),Ve=f.length;f.push(o,be),l&&l.push(i,n.index,Ve,"function"==typeof be?Ve+1:-(Ve+1))}}}function nH(r,t,e,n){const i=on(null);try{return oc(6,t,e),!1!==e(n)}catch(o){return fg(r,o),!1}finally{oc(7,t,e),on(i)}}function rH(r,t,e,n,i){return function o(s){if(s===Function)return n;g7(r.componentOffset>-1?es(r.index,t):t);let c=nH(t,e,n,s),l=o.__ngNextListenerFn__;for(;l;)c=nH(t,e,l,s)&&c,l=l.__ngNextListenerFn__;return i&&!1===c&&s.preventDefault(),c}}function p(r=1){return function Fae(r){return($t.lFrame.contextLView=function sx(r,t){for(;r>0;)t=t[I0],r--;return t}(r,$t.lFrame.contextLView))[R1]}(r)}function p5e(r,t){let e=null;const n=function cae(r){const t=r.attrs;if(null!=t){const e=t.indexOf(5);if(!(1&e))return t[e+1]}return null}(r);for(let i=0;i<t.length;i++){const o=t[i];if("*"!==o){if(null===n?qR(r,o,!0):fae(n,o))return i}else e=i}return e}function Fg(r,t,e){return Tn(r,"",t,"",e),Fg}function Tn(r,t,e,n,i){const o=Ce(),s=h8(o,t,e,n);return s!==nn&&bo(On(),x1(),o,r,s,o[Yt],i,!1),Tn}function ve(r,t,e,n,i,o,s){const a=Ce(),c=g8(a,t,e,n,i,o);return c!==nn&&bo(On(),x1(),a,r,c,a[Yt],s,!1),ve}function Ur(r,t,e,n,i,o,s,a,c){const l=Ce(),u=p8(l,t,e,n,i,o,s,a);return u!==nn&&bo(On(),x1(),l,r,u,l[Yt],c,!1),Ur}function Ug(r,t,e,n,i,o,s,a,c,l,u){const f=Ce(),g=m8(f,t,e,n,i,o,s,a,c,l);return g!==nn&&bo(On(),x1(),f,r,g,f[Yt],u,!1),Ug}function P3(r,t,e){cD(r,t,e)}function hc(r){const t=Ce(),e=On(),n=yy();dh(n+1);const i=hE(e,n);if(r.dirty&&function Sae(r){return 4==(4&r[Ot])}(t)===(2==(2&i.metadata.flags))){if(null===i.matches)r.reset([]);else{const o=fD(t,n);r.reset(o,yx),r.notifyOnChanges()}return!0}return!1}function gc(){return function dE(r,t){return r[m3].queries[t].queryList}(Ce(),yy())}function wn(r){return x0(function Lae(){return $t.lFrame.contextLView}(),Jt+r)}function ot(r,t=""){const e=Ce(),n=On(),i=r+Jt,o=n.firstCreatePass?n8(n,i,1,t,null):n.data[i],s=MH(n,e,o,t,r);e[i]=s,hh()&&sg(n,e,s,o),ic(o,!1)}let MH=(r,t,e,n,i)=>(C4(!0),ng(t[Yt],n));function Cn(r){return ii("",r,""),Cn}function ii(r,t,e){const n=Ce(),i=h8(n,r,t,e);return i!==nn&&M3(n,N2(),i),ii}function FE(r,t,e,n,i){const o=Ce(),s=g8(o,r,t,e,n,i);return s!==nn&&M3(o,N2(),s),FE}function UE(r,t,e,n,i,o,s){const a=Ce(),c=p8(a,r,t,e,n,i,o,s);return c!==nn&&M3(a,N2(),c),UE}function N4(r,t,e){gD(t)&&(t=t());const n=Ce();return Vr(n,Pa(),t)&&bo(On(),x1(),n,r,t,n[Yt],e,!1),N4}function o6(r,t){const e=gD(r);return e&&r.set(t),e}function I4(r,t){const e=Ce(),n=On(),i=d1();return HE(n,e,e[Yt],i,r,t),I4}function GE(r,t,e,n,i){if(r=Ft(r),Array.isArray(r))for(let o=0;o<r.length;o++)GE(r[o],t,e,n,i);else{const o=On(),s=Ce(),a=d1();let c=Yl(r)?r:Ft(r.provide);const l=qx(r),u=1048575&a.providerIndexes,f=a.directiveStart,g=a.providerIndexes>>20;if(Yl(r)||!r.multi){const y=new t7(l,i,G),S=$E(c,t,i?u:u+g,f);-1===S?(uM(Bh(a,s),o,c),BE(o,r,t.length),t.push(c),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),e.push(y),s.push(y)):(e[S]=y,s[S]=y)}else{const y=$E(c,t,u+g,f),S=$E(c,t,u,u+g),R=S>=0&&e[S];if(i&&!R||!i&&!(y>=0&&e[y])){uM(Bh(a,s),o,c);const U=function x5e(r,t,e,n,i){const o=new t7(r,e,G);return o.multi=[],o.index=t,o.componentProviders=0,bH(o,i,n&&!e),o}(i?R5e:k5e,e.length,i,n,l);!i&&R&&(e[S].providerFactory=U),BE(o,r,t.length,0),t.push(c),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),e.push(U),s.push(U)}else BE(o,r,y>-1?y:S,bH(e[i?S:y],l,!i&&n));!i&&n&&R&&e[S].componentProviders++}}}function BE(r,t,e,n){const i=Yl(t),o=function wce(r){return!!r.useClass}(t);if(i||o){const c=(o?Ft(t.useClass):t).prototype.ngOnDestroy;if(c){const l=r.destroyHooks||(r.destroyHooks=[]);if(!i&&t.multi){const u=l.indexOf(e);-1===u?l.push(e,[n,c]):l[u+1].push(n,c)}else l.push(e,c)}}}function bH(r,t,e){return e&&r.componentProviders++,r.multi.push(t)-1}function $E(r,t,e,n){for(let i=e;i<n;i++)if(t[i]===r)return i;return-1}function k5e(r,t,e,n){return WE(this.multi,[])}function R5e(r,t,e,n){const i=this.multi;let o;if(this.providerFactory){const s=this.providerFactory.componentProviders,a=Kl(e,e[He],this.providerFactory.index,n);o=a.slice(0,s),WE(i,o);for(let c=s;c<a.length;c++)o.push(a[c])}else o=[],WE(i,o);return o}function WE(r,t){for(let e=0;e<r.length;e++)t.push((0,r[e])());return t}function ur(r,t=[]){return e=>{e.providersResolver=(n,i)=>function I5e(r,t,e){const n=On();if(n.firstCreatePass){const i=Ea(r);GE(e,n.data,n.blueprint,i,!0),GE(t,n.data,n.blueprint,i,!1)}}(n,i?i(r):r,t)}}let L5e=(()=>{class r{constructor(e){this._injector=e,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(e){if(!e.standalone)return null;if(!this.cachedInjectors.has(e)){const n=Ky(0,e.type),i=n.length>0?Sg([n],this._injector,`Standalone[${e.type.name}]`):null;this.cachedInjectors.set(e,i)}return this.cachedInjectors.get(e)}ngOnDestroy(){try{for(const e of this.cachedInjectors.values())null!==e&&e.destroy()}finally{this.cachedInjectors.clear()}}static#e=this.\u0275prov=xe({token:r,providedIn:"environment",factory:()=>new r(ze(To))})}return r})();function Gg(r){uc("NgStandalone"),r.getStandaloneInjector=t=>t.get(L5e).getOrCreateStandaloneInjector(r)}function S3(r,t,e){const n=r.\u0275cmp;n.directiveDefs=ah(t,!1),n.pipeDefs=ah(e,!0)}function fr(r,t,e){const n=to()+r,i=Ce();return i[n]===nn?fc(i,n,e?t.call(e):t()):function O7(r,t){return r[t]}(i,n)}function Ta(r,t,e,n){return DH(Ce(),to(),r,t,e,n)}function L7(r,t){const e=r[t];return e===nn?void 0:e}function DH(r,t,e,n,i,o){const s=t+e;return Vr(r,s,i)?fc(r,s+1,o?n.call(o,i):n(i)):L7(r,s+1)}function wa(r,t){const e=On();let n;const i=r+Jt;e.firstCreatePass?(n=function Q5e(r,t){if(t)for(let e=t.length-1;e>=0;e--){const n=t[e];if(r===n.name)return n}}(t,e.pipeRegistry),e.data[i]=n,n.onDestroy&&(e.destroyHooks??=[]).push(i,n.onDestroy)):n=e.data[i];const o=n.factory||(n.factory=jl(n.type)),a=Oo(G);try{const c=Gh(!1),l=o();return Gh(c),function v5e(r,t,e,n){e>=r.data.length&&(r.data[e]=null,r.blueprint[e]=null),t[e]=n}(e,Ce(),i,l),l}finally{Oo(a)}}function pc(r,t,e){const n=r+Jt,i=Ce(),o=x0(i,n);return z7(i,n)?DH(i,to(),t,o.transform,e,o):o.transform(e)}function GH(r,t,e,n){const i=r+Jt,o=Ce(),s=x0(o,i);return z7(o,i)?function VH(r,t,e,n,i,o,s){const a=t+e;return t6(r,a,i,o)?fc(r,a+2,s?n.call(s,i,o):n(i,o)):L7(r,a+2)}(o,to(),t,s.transform,e,n,s):s.transform(e,n)}function z7(r,t){return r[He].data[t].pure}function In(r,t){return hg(r,t)}let iF=(()=>{class r{log(e){console.log(e)}warn(e){console.warn(e)}static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275prov=xe({token:r,factory:r.\u0275fac,providedIn:"platform"})}return r})();const lF=new tt(""),qg=new tt("");let eP,QE=(()=>{class r{constructor(e,n,i){this._ngZone=e,this.registry=n,this._pendingCount=0,this._isZoneStable=!0,this._callbacks=[],this.taskTrackingZone=null,eP||(function Zue(r){eP=r}(i),i.addToWindow(n)),this._watchAngularEvents(),e.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Xn.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;0!==this._callbacks.length;){let e=this._callbacks.pop();clearTimeout(e.timeoutId),e.doneCb()}});else{let e=this.getPendingTasks();this._callbacks=this._callbacks.filter(n=>!n.updateCb||!n.updateCb(e)||(clearTimeout(n.timeoutId),!1))}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(e=>({source:e.source,creationLocation:e.creationLocation,data:e.data})):[]}addCallback(e,n,i){let o=-1;n&&n>0&&(o=setTimeout(()=>{this._callbacks=this._callbacks.filter(s=>s.timeoutId!==o),e()},n)),this._callbacks.push({doneCb:e,timeoutId:o,updateCb:i})}whenStable(e,n,i){if(i&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(e,n,i),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(e){this.registry.registerApplication(e,this)}unregisterApplication(e){this.registry.unregisterApplication(e)}findProviders(e,n,i){return[]}static#e=this.\u0275fac=function(n){return new(n||r)(ze(Xn),ze(JE),ze(qg))};static#t=this.\u0275prov=xe({token:r,factory:r.\u0275fac})}return r})(),JE=(()=>{class r{constructor(){this._applications=new Map}registerApplication(e,n){this._applications.set(e,n)}unregisterApplication(e){this._applications.delete(e)}unregisterAllApplications(){this._applications.clear()}getTestability(e){return this._applications.get(e)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(e,n=!0){return eP?.findTestabilityInTree(this,e,n)??null}static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275prov=xe({token:r,factory:r.\u0275fac,providedIn:"platform"})}return r})();function F7(r){return!!r&&"function"==typeof r.then}function uF(r){return!!r&&"function"==typeof r.subscribe}const tP=new tt("");let nP=(()=>{class r{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((e,n)=>{this.resolve=e,this.reject=n}),this.appInits=Ne(tP,{optional:!0})??[]}runInitializers(){if(this.initialized)return;const e=[];for(const i of this.appInits){const o=i();if(F7(o))e.push(o);else if(uF(o)){const s=new Promise((a,c)=>{o.subscribe({complete:a,error:c})});e.push(s)}}const n=()=>{this.done=!0,this.resolve()};Promise.all(e).then(()=>{n()}).catch(i=>{this.reject(i)}),0===e.length&&n(),this.initialized=!0}static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275prov=xe({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();const rP=new tt("");function hF(r,t){return Array.isArray(t)?t.reduce(hF,r):{...r,...t}}let k4=(()=>{class r{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=Ne(_L),this.afterRenderEffectManager=Ne(y7),this.componentTypes=[],this.components=[],this.isStable=Ne(w4).hasPendingTasks.pipe(jn(e=>!e)),this._injector=Ne(To)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(e,n){const i=e instanceof Vz;if(!this._injector.get(nP).done)throw!i&&function m4(r){const t=_n(r)||mi(r)||e2(r);return null!==t&&t.standalone}(e),new de(405,!1);let s;s=i?e:this._injector.get(Cg).resolveComponentFactory(e),this.componentTypes.push(s.componentType);const a=function Yue(r){return r.isBoundToModule}(s)?void 0:this._injector.get(e6),l=s.create(no.NULL,[],n||s.selector,a),u=l.location.nativeElement,f=l.injector.get(lF,null);return f?.registerApplication(u),l.onDestroy(()=>{this.detachView(l.hostView),jg(this.components,l),f?.unregisterApplication(u)}),this._loadComponent(l),l}tick(){if(this._runningTick)throw new de(101,!1);const e=on(null);try{this._runningTick=!0,this.detectChangesInAttachedViews()}catch(n){this.internalErrorHandler(n)}finally{this._runningTick=!1,on(e)}}detectChangesInAttachedViews(){let e=0;const n=this.afterRenderEffectManager;for(;;){if(100===e)throw new de(103,!1);const i=0===e;for(let{_lView:o,notifyErrorHandler:s}of this._views)!i&&!iP(o)||this.detectChangesInView(o,s,i);if(e++,n.executeInternalCallbacks(),!this._views.some(({_lView:o})=>iP(o))&&(n.execute(),!this._views.some(({_lView:o})=>iP(o))))break}}detectChangesInView(e,n,i){let o;i?(o=0,e[Ot]|=1024):o=64&e[Ot]?0:1,dg(e,n,o)}attachView(e){const n=e;this._views.push(n),n.attachToAppRef(this)}detachView(e){const n=e;jg(this._views,n),n.detachFromAppRef()}_loadComponent(e){this.attachView(e.hostView),this.tick(),this.components.push(e);const n=this._injector.get(rP,[]);[...this._bootstrapListeners,...n].forEach(i=>i(e))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(e=>e()),this._views.slice().forEach(e=>e.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(e){return this._destroyListeners.push(e),()=>jg(this._destroyListeners,e)}destroy(){if(this._destroyed)throw new de(406,!1);const e=this._injector;e.destroy&&!e.destroyed&&e.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275prov=xe({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();function jg(r,t){const e=r.indexOf(t);e>-1&&r.splice(e,1)}function iP(r){return hy(r)}class Xue{constructor(t,e){this.ngModuleFactory=t,this.componentFactories=e}}let gF=(()=>{class r{compileModuleSync(e){return new mE(e)}compileModuleAsync(e){return Promise.resolve(this.compileModuleSync(e))}compileModuleAndAllComponentsSync(e){const n=this.compileModuleSync(e),o=is(T2(e).declarations).reduce((s,a)=>{const c=_n(a);return c&&s.push(new P7(c)),s},[]);return new Xue(n,o)}compileModuleAndAllComponentsAsync(e){return Promise.resolve(this.compileModuleAndAllComponentsSync(e))}clearCache(){}clearCacheFor(e){}getModuleId(e){}static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275prov=xe({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})(),e7e=(()=>{class r{constructor(){this.zone=Ne(Xn),this.applicationRef=Ne(k4)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275prov=xe({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();function t7e(){const r=Ne(Xn),t=Ne(v3);return e=>r.runOutsideAngular(()=>t.handleError(e))}let r7e=(()=>{class r{constructor(){this.subscription=new cn,this.initialized=!1,this.zone=Ne(Xn),this.pendingTasks=Ne(w4)}initialize(){if(this.initialized)return;this.initialized=!0;let e=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(e=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{Xn.assertNotInAngularZone(),queueMicrotask(()=>{null!==e&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(e),e=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{Xn.assertInAngularZone(),e??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275prov=xe({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();const mc=new tt("",{providedIn:"root",factory:()=>Ne(mc,Sn.Optional|Sn.SkipSelf)||function i7e(){return typeof $localize<"u"&&$localize.locale||P8}()}),oP=new tt("");let CF=(()=>{class r{constructor(e){this._injector=e,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(e,n){const i=function Wle(r="zone.js",t){return"noop"===r?new $z:"zone.js"===r?new Xn(t):r}(n?.ngZone,function _F(r){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:r?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:r?.runCoalescing??!1}}({eventCoalescing:n?.ngZoneEventCoalescing,runCoalescing:n?.ngZoneRunCoalescing}));return i.run(()=>{const o=function V6e(r,t,e){return new pE(r,t,e)}(e.moduleType,this.injector,function mF(r){return[{provide:Xn,useFactory:r},{provide:Zl,multi:!0,useFactory:()=>{const t=Ne(e7e,{optional:!0});return()=>t.initialize()}},{provide:Zl,multi:!0,useFactory:()=>{const t=Ne(r7e);return()=>{t.initialize()}}},{provide:_L,useFactory:t7e}]}(()=>i)),s=o.injector.get(v3,null);return i.runOutsideAngular(()=>{const a=i.onError.subscribe({next:c=>{s.handleError(c)}});o.onDestroy(()=>{jg(this._modules,o),a.unsubscribe()})}),function dF(r,t,e){try{const n=e();return F7(n)?n.catch(i=>{throw t.runOutsideAngular(()=>r.handleError(i)),i}):n}catch(n){throw t.runOutsideAngular(()=>r.handleError(n)),n}}(s,i,()=>{const a=o.injector.get(nP);return a.runInitializers(),a.donePromise.then(()=>(function xV(r){"string"==typeof r&&(RV=r.toLowerCase().replace(/_/g,"-"))}(o.injector.get(mc,P8)||P8),this._moduleDoBootstrap(o),o))})})}bootstrapModule(e,n=[]){const i=hF({},n);return function Jue(r,t,e){const n=new mE(e);return Promise.resolve(n)}(0,0,e).then(o=>this.bootstrapModuleFactory(o,i))}_moduleDoBootstrap(e){const n=e.injector.get(k4);if(e._bootstrapComponents.length>0)e._bootstrapComponents.forEach(i=>n.bootstrap(i));else{if(!e.instance.ngDoBootstrap)throw new de(-403,!1);e.instance.ngDoBootstrap(n)}this._modules.push(e)}onDestroy(e){this._destroyListeners.push(e)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new de(404,!1);this._modules.slice().forEach(n=>n.destroy()),this._destroyListeners.forEach(n=>n());const e=this._injector.get(oP,null);e&&(e.forEach(n=>n()),e.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}static#e=this.\u0275fac=function(n){return new(n||r)(ze(no))};static#t=this.\u0275prov=xe({token:r,factory:r.\u0275fac,providedIn:"platform"})}return r})(),R4=null;const vF=new tt("");function yF(r,t,e=[]){const n=`Platform: ${t}`,i=new tt(n);return(o=[])=>{let s=sP();if(!s||s.injector.get(vF,!1)){const a=[...e,...o,{provide:i,useValue:!0}];r?r(a):function a7e(r){if(R4&&!R4.get(vF,!1))throw new de(400,!1);(function fF(){!function Bv(r){rh=r}(()=>{throw new de(600,!1)})})(),R4=r;const t=r.get(CF);(function EF(r){r.get(bx,null)?.forEach(e=>e())})(r)}(function MF(r=[],t){return no.create({name:t,providers:[{provide:Jy,useValue:"platform"},{provide:oP,useValue:new Set([()=>R4=null])},...r]})}(a,n))}return function c7e(r){const t=sP();if(!t)throw new de(401,!1);return t}()}}function sP(){return R4?.get(CF)??null}let Vs=(()=>{class r{static#e=this.__NG_ELEMENT_ID__=u7e}return r})();function u7e(r){return function f7e(r,t,e){if($l(r)&&!e){const n=es(r.index,t);return new p7(n,n)}return 47&r.type?new p7(t[_r],t):null}(d1(),Ce(),16==(16&r))}class wF{constructor(){}supports(t){return Tg(t)}create(t){return new m7e(t)}}const p7e=(r,t)=>t;class m7e{constructor(t){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=t||p7e}forEachItem(t){let e;for(e=this._itHead;null!==e;e=e._next)t(e)}forEachOperation(t){let e=this._itHead,n=this._removalsHead,i=0,o=null;for(;e||n;){const s=!n||e&&e.currentIndex<AF(n,i,o)?e:n,a=AF(s,i,o),c=s.currentIndex;if(s===n)i--,n=n._nextRemoved;else if(e=e._next,null==s.previousIndex)i++;else{o||(o=[]);const l=a-i,u=c-i;if(l!=u){for(let g=0;g<l;g++){const y=g<o.length?o[g]:o[g]=0,S=y+g;u<=S&&S<l&&(o[g]=y+1)}o[s.previousIndex]=u-l}}a!==c&&t(s,a,c)}}forEachPreviousItem(t){let e;for(e=this._previousItHead;null!==e;e=e._nextPrevious)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}forEachMovedItem(t){let e;for(e=this._movesHead;null!==e;e=e._nextMoved)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}forEachIdentityChange(t){let e;for(e=this._identityChangesHead;null!==e;e=e._nextIdentityChange)t(e)}diff(t){if(null==t&&(t=[]),!Tg(t))throw new de(900,!1);return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let i,o,s,e=this._itHead,n=!1;if(Array.isArray(t)){this.length=t.length;for(let a=0;a<this.length;a++)o=t[a],s=this._trackByFn(a,o),null!==e&&Object.is(e.trackById,s)?(n&&(e=this._verifyReinsertion(e,o,s,a)),Object.is(e.item,o)||this._addIdentityChange(e,o)):(e=this._mismatch(e,o,s,a),n=!0),e=e._next}else i=0,function G6e(r,t){if(Array.isArray(r))for(let e=0;e<r.length;e++)t(r[e]);else{const e=r[Symbol.iterator]();let n;for(;!(n=e.next()).done;)t(n.value)}}(t,a=>{s=this._trackByFn(i,a),null!==e&&Object.is(e.trackById,s)?(n&&(e=this._verifyReinsertion(e,a,s,i)),Object.is(e.item,a)||this._addIdentityChange(e,a)):(e=this._mismatch(e,a,s,i),n=!0),e=e._next,i++}),this.length=i;return this._truncate(e),this.collection=t,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let t;for(t=this._previousItHead=this._itHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._additionsHead;null!==t;t=t._nextAdded)t.previousIndex=t.currentIndex;for(this._additionsHead=this._additionsTail=null,t=this._movesHead;null!==t;t=t._nextMoved)t.previousIndex=t.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(t,e,n,i){let o;return null===t?o=this._itTail:(o=t._prev,this._remove(t)),null!==(t=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null))?(Object.is(t.item,e)||this._addIdentityChange(t,e),this._reinsertAfter(t,o,i)):null!==(t=null===this._linkedRecords?null:this._linkedRecords.get(n,i))?(Object.is(t.item,e)||this._addIdentityChange(t,e),this._moveAfter(t,o,i)):t=this._addAfter(new _7e(e,n),o,i),t}_verifyReinsertion(t,e,n,i){let o=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null);return null!==o?t=this._reinsertAfter(o,t._prev,i):t.currentIndex!=i&&(t.currentIndex=i,this._addToMoves(t,i)),t}_truncate(t){for(;null!==t;){const e=t._next;this._addToRemovals(this._unlink(t)),t=e}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(t,e,n){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(t);const i=t._prevRemoved,o=t._nextRemoved;return null===i?this._removalsHead=o:i._nextRemoved=o,null===o?this._removalsTail=i:o._prevRemoved=i,this._insertAfter(t,e,n),this._addToMoves(t,n),t}_moveAfter(t,e,n){return this._unlink(t),this._insertAfter(t,e,n),this._addToMoves(t,n),t}_addAfter(t,e,n){return this._insertAfter(t,e,n),this._additionsTail=null===this._additionsTail?this._additionsHead=t:this._additionsTail._nextAdded=t,t}_insertAfter(t,e,n){const i=null===e?this._itHead:e._next;return t._next=i,t._prev=e,null===i?this._itTail=t:i._prev=t,null===e?this._itHead=t:e._next=t,null===this._linkedRecords&&(this._linkedRecords=new bF),this._linkedRecords.put(t),t.currentIndex=n,t}_remove(t){return this._addToRemovals(this._unlink(t))}_unlink(t){null!==this._linkedRecords&&this._linkedRecords.remove(t);const e=t._prev,n=t._next;return null===e?this._itHead=n:e._next=n,null===n?this._itTail=e:n._prev=e,t}_addToMoves(t,e){return t.previousIndex===e||(this._movesTail=null===this._movesTail?this._movesHead=t:this._movesTail._nextMoved=t),t}_addToRemovals(t){return null===this._unlinkedRecords&&(this._unlinkedRecords=new bF),this._unlinkedRecords.put(t),t.currentIndex=null,t._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=t,t._prevRemoved=null):(t._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=t),t}_addIdentityChange(t,e){return t.item=e,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=t:this._identityChangesTail._nextIdentityChange=t,t}}class _7e{constructor(t,e){this.item=t,this.trackById=e,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class C7e{constructor(){this._head=null,this._tail=null}add(t){null===this._head?(this._head=this._tail=t,t._nextDup=null,t._prevDup=null):(this._tail._nextDup=t,t._prevDup=this._tail,t._nextDup=null,this._tail=t)}get(t,e){let n;for(n=this._head;null!==n;n=n._nextDup)if((null===e||e<=n.currentIndex)&&Object.is(n.trackById,t))return n;return null}remove(t){const e=t._prevDup,n=t._nextDup;return null===e?this._head=n:e._nextDup=n,null===n?this._tail=e:n._prevDup=e,null===this._head}}class bF{constructor(){this.map=new Map}put(t){const e=t.trackById;let n=this.map.get(e);n||(n=new C7e,this.map.set(e,n)),n.add(t)}get(t,e){const i=this.map.get(t);return i?i.get(t,e):null}remove(t){const e=t.trackById;return this.map.get(e).remove(t)&&this.map.delete(e),t}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function AF(r,t,e){const n=r.previousIndex;if(null===n)return n;let i=0;return e&&n<e.length&&(i=e[n]),n+t+i}function IF(){return new fP([new wF])}let fP=(()=>{class r{static#e=this.\u0275prov=xe({token:r,providedIn:"root",factory:IF});constructor(e){this.factories=e}static create(e,n){if(null!=n){const i=n.factories.slice();e=e.concat(i)}return new r(e)}static extend(e){return{provide:r,useFactory:n=>r.create(e,n||IF()),deps:[[r,new Ih,new Nh]]}}find(e){const n=this.factories.find(i=>i.supports(e));if(null!=n)return n;throw new de(901,!1)}}return r})();const P7e=yF(null,"core",[]);let S7e=(()=>{class r{constructor(e){}static#e=this.\u0275fac=function(n){return new(n||r)(ze(k4))};static#t=this.\u0275mod=Ls({type:r});static#n=this.\u0275inj=ns({})}return r})();function w8(r){return"boolean"==typeof r?r:null!=r&&"false"!==r}let eU=null;function x4(){return eU}class sfe{}const R2=new tt("");let gP=(()=>{class r{historyGo(e){throw new Error("")}static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275prov=xe({token:r,factory:()=>Ne(cfe),providedIn:"platform"})}return r})();const afe=new tt("");let cfe=(()=>{class r extends gP{constructor(){super(),this._doc=Ne(R2),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return x4().getBaseHref(this._doc)}onPopState(e){const n=x4().getGlobalEventTarget(this._doc,"window");return n.addEventListener("popstate",e,!1),()=>n.removeEventListener("popstate",e)}onHashChange(e){const n=x4().getGlobalEventTarget(this._doc,"window");return n.addEventListener("hashchange",e,!1),()=>n.removeEventListener("hashchange",e)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(e){this._location.pathname=e}pushState(e,n,i){this._history.pushState(e,n,i)}replaceState(e,n,i){this._history.replaceState(e,n,i)}forward(){this._history.forward()}back(){this._history.back()}historyGo(e=0){this._history.go(e)}getState(){return this._history.state}static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275prov=xe({token:r,factory:()=>new r,providedIn:"platform"})}return r})();function pP(r,t){if(0==r.length)return t;if(0==t.length)return r;let e=0;return r.endsWith("/")&&e++,t.startsWith("/")&&e++,2==e?r+t.substring(1):1==e?r+t:r+"/"+t}function tU(r){const t=r.match(/#|\?|$/),e=t&&t.index||r.length;return r.slice(0,e-("/"===r[e-1]?1:0))+r.slice(e)}function O3(r){return r&&"?"!==r[0]?"?"+r:r}let a6=(()=>{class r{historyGo(e){throw new Error("")}static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275prov=xe({token:r,factory:()=>Ne(rU),providedIn:"root"})}return r})();const nU=new tt("");let rU=(()=>{class r extends a6{constructor(e,n){super(),this._platformLocation=e,this._removeListenerFns=[],this._baseHref=n??this._platformLocation.getBaseHrefFromDOM()??Ne(R2).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}prepareExternalUrl(e){return pP(this._baseHref,e)}path(e=!1){const n=this._platformLocation.pathname+O3(this._platformLocation.search),i=this._platformLocation.hash;return i&&e?`${n}${i}`:n}pushState(e,n,i,o){const s=this.prepareExternalUrl(i+O3(o));this._platformLocation.pushState(e,n,s)}replaceState(e,n,i,o){const s=this.prepareExternalUrl(i+O3(o));this._platformLocation.replaceState(e,n,s)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(e=0){this._platformLocation.historyGo?.(e)}static#e=this.\u0275fac=function(n){return new(n||r)(ze(gP),ze(nU,8))};static#t=this.\u0275prov=xe({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})(),lfe=(()=>{class r extends a6{constructor(e,n){super(),this._platformLocation=e,this._baseHref="",this._removeListenerFns=[],null!=n&&(this._baseHref=n)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}path(e=!1){const n=this._platformLocation.hash??"#";return n.length>0?n.substring(1):n}prepareExternalUrl(e){const n=pP(this._baseHref,e);return n.length>0?"#"+n:n}pushState(e,n,i,o){let s=this.prepareExternalUrl(i+O3(o));0==s.length&&(s=this._platformLocation.pathname),this._platformLocation.pushState(e,n,s)}replaceState(e,n,i,o){let s=this.prepareExternalUrl(i+O3(o));0==s.length&&(s=this._platformLocation.pathname),this._platformLocation.replaceState(e,n,s)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(e=0){this._platformLocation.historyGo?.(e)}static#e=this.\u0275fac=function(n){return new(n||r)(ze(gP),ze(nU,8))};static#t=this.\u0275prov=xe({token:r,factory:r.\u0275fac})}return r})(),B7=(()=>{class r{constructor(e){this._subject=new i1,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=e;const n=this._locationStrategy.getBaseHref();this._basePath=function dfe(r){if(new RegExp("^(https?:)?//").test(r)){const[,e]=r.split(/\/\/[^\/]+/);return e}return r}(tU(iU(n))),this._locationStrategy.onPopState(i=>{this._subject.emit({url:this.path(!0),pop:!0,state:i.state,type:i.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(e=!1){return this.normalize(this._locationStrategy.path(e))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(e,n=""){return this.path()==this.normalize(e+O3(n))}normalize(e){return r.stripTrailingSlash(function ffe(r,t){if(!r||!t.startsWith(r))return t;const e=t.substring(r.length);return""===e||["/",";","?","#"].includes(e[0])?e:t}(this._basePath,iU(e)))}prepareExternalUrl(e){return e&&"/"!==e[0]&&(e="/"+e),this._locationStrategy.prepareExternalUrl(e)}go(e,n="",i=null){this._locationStrategy.pushState(i,"",e,n),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+O3(n)),i)}replaceState(e,n="",i=null){this._locationStrategy.replaceState(i,"",e,n),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+O3(n)),i)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(e=0){this._locationStrategy.historyGo?.(e)}onUrlChange(e){return this._urlChangeListeners.push(e),this._urlChangeSubscription??=this.subscribe(n=>{this._notifyUrlChangeListeners(n.url,n.state)}),()=>{const n=this._urlChangeListeners.indexOf(e);this._urlChangeListeners.splice(n,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(e="",n){this._urlChangeListeners.forEach(i=>i(e,n))}subscribe(e,n,i){return this._subject.subscribe({next:e,error:n,complete:i})}static#e=this.normalizeQueryParams=O3;static#t=this.joinWithSlash=pP;static#n=this.stripTrailingSlash=tU;static#r=this.\u0275fac=function(n){return new(n||r)(ze(a6))};static#i=this.\u0275prov=xe({token:r,factory:()=>function ufe(){return new B7(ze(a6))}(),providedIn:"root"})}return r})();function iU(r){return r.replace(/\/index.html$/,"")}var rp=function(r){return r[r.Decimal=0]="Decimal",r[r.Percent=1]="Percent",r[r.Currency=2]="Currency",r[r.Scientific=3]="Scientific",r}(rp||{}),oo=function(r){return r[r.Format=0]="Format",r[r.Standalone=1]="Standalone",r}(oo||{}),T1=function(r){return r[r.Narrow=0]="Narrow",r[r.Abbreviated=1]="Abbreviated",r[r.Wide=2]="Wide",r[r.Short=3]="Short",r}(T1||{}),as=function(r){return r[r.Short=0]="Short",r[r.Medium=1]="Medium",r[r.Long=2]="Long",r[r.Full=3]="Full",r}(as||{}),Gr=function(r){return r[r.Decimal=0]="Decimal",r[r.Group=1]="Group",r[r.List=2]="List",r[r.PercentSign=3]="PercentSign",r[r.PlusSign=4]="PlusSign",r[r.MinusSign=5]="MinusSign",r[r.Exponential=6]="Exponential",r[r.SuperscriptingExponent=7]="SuperscriptingExponent",r[r.PerMille=8]="PerMille",r[r.Infinity=9]="Infinity",r[r.NaN=10]="NaN",r[r.TimeSeparator=11]="TimeSeparator",r[r.CurrencyDecimal=12]="CurrencyDecimal",r[r.CurrencyGroup=13]="CurrencyGroup",r}(Gr||{});function ip(r,t){return Fs(ro(r)[D1.DateFormat],t)}function op(r,t){return Fs(ro(r)[D1.TimeFormat],t)}function sp(r,t){return Fs(ro(r)[D1.DateTimeFormat],t)}function Hs(r,t){const e=ro(r),n=e[D1.NumberSymbols][t];if(typeof n>"u"){if(t===Gr.CurrencyDecimal)return e[D1.NumberSymbols][Gr.Decimal];if(t===Gr.CurrencyGroup)return e[D1.NumberSymbols][Gr.Group]}return n}function sU(r){if(!r[D1.ExtraData])throw new Error(`Missing extra locale data for the locale "${r[D1.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function Fs(r,t){for(let e=t;e>-1;e--)if(typeof r[e]<"u")return r[e];throw new Error("Locale data API: locale data undefined")}function _P(r){const[t,e]=r.split(":");return{hours:+t,minutes:+e}}const Tfe=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,ap={},wfe=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;var T3=function(r){return r[r.Short=0]="Short",r[r.ShortGMT=1]="ShortGMT",r[r.Long=2]="Long",r[r.Extended=3]="Extended",r}(T3||{}),t1=function(r){return r[r.FullYear=0]="FullYear",r[r.Month=1]="Month",r[r.Date=2]="Date",r[r.Hours=3]="Hours",r[r.Minutes=4]="Minutes",r[r.Seconds=5]="Seconds",r[r.FractionalSeconds=6]="FractionalSeconds",r[r.Day=7]="Day",r}(t1||{}),n1=function(r){return r[r.DayPeriods=0]="DayPeriods",r[r.Days=1]="Days",r[r.Months=2]="Months",r[r.Eras=3]="Eras",r}(n1||{});function aU(r,t,e,n){let i=function zfe(r){if(uU(r))return r;if("number"==typeof r&&!isNaN(r))return new Date(r);if("string"==typeof r){if(r=r.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(r)){const[i,o=1,s=1]=r.split("-").map(a=>+a);return cp(i,o-1,s)}const e=parseFloat(r);if(!isNaN(r-e))return new Date(e);let n;if(n=r.match(Tfe))return function Dfe(r){const t=new Date(0);let e=0,n=0;const i=r[8]?t.setUTCFullYear:t.setFullYear,o=r[8]?t.setUTCHours:t.setHours;r[9]&&(e=Number(r[9]+r[10]),n=Number(r[9]+r[11])),i.call(t,Number(r[1]),Number(r[2])-1,Number(r[3]));const s=Number(r[4]||0)-e,a=Number(r[5]||0)-n,c=Number(r[6]||0),l=Math.floor(1e3*parseFloat("0."+(r[7]||0)));return o.call(t,s,a,c,l),t}(n)}const t=new Date(r);if(!uU(t))throw new Error(`Unable to convert "${r}" into a date`);return t}(r);t=w3(e,t)||t;let a,s=[];for(;t;){if(a=wfe.exec(t),!a){s.push(t);break}{s=s.concat(a.slice(1));const u=s.pop();if(!u)break;t=u}}let c=i.getTimezoneOffset();n&&(c=lU(n,c),i=function Lfe(r,t,e){const n=e?-1:1,i=r.getTimezoneOffset();return function xfe(r,t){return(r=new Date(r.getTime())).setMinutes(r.getMinutes()+t),r}(r,n*(lU(t,i)-i))}(i,n,!0));let l="";return s.forEach(u=>{const f=function Rfe(r){if(vP[r])return vP[r];let t;switch(r){case"G":case"GG":case"GGG":t=V1(n1.Eras,T1.Abbreviated);break;case"GGGG":t=V1(n1.Eras,T1.Wide);break;case"GGGGG":t=V1(n1.Eras,T1.Narrow);break;case"y":t=oi(t1.FullYear,1,0,!1,!0);break;case"yy":t=oi(t1.FullYear,2,0,!0,!0);break;case"yyy":t=oi(t1.FullYear,3,0,!1,!0);break;case"yyyy":t=oi(t1.FullYear,4,0,!1,!0);break;case"Y":t=dp(1);break;case"YY":t=dp(2,!0);break;case"YYY":t=dp(3);break;case"YYYY":t=dp(4);break;case"M":case"L":t=oi(t1.Month,1,1);break;case"MM":case"LL":t=oi(t1.Month,2,1);break;case"MMM":t=V1(n1.Months,T1.Abbreviated);break;case"MMMM":t=V1(n1.Months,T1.Wide);break;case"MMMMM":t=V1(n1.Months,T1.Narrow);break;case"LLL":t=V1(n1.Months,T1.Abbreviated,oo.Standalone);break;case"LLLL":t=V1(n1.Months,T1.Wide,oo.Standalone);break;case"LLLLL":t=V1(n1.Months,T1.Narrow,oo.Standalone);break;case"w":t=CP(1);break;case"ww":t=CP(2);break;case"W":t=CP(1,!0);break;case"d":t=oi(t1.Date,1);break;case"dd":t=oi(t1.Date,2);break;case"c":case"cc":t=oi(t1.Day,1);break;case"ccc":t=V1(n1.Days,T1.Abbreviated,oo.Standalone);break;case"cccc":t=V1(n1.Days,T1.Wide,oo.Standalone);break;case"ccccc":t=V1(n1.Days,T1.Narrow,oo.Standalone);break;case"cccccc":t=V1(n1.Days,T1.Short,oo.Standalone);break;case"E":case"EE":case"EEE":t=V1(n1.Days,T1.Abbreviated);break;case"EEEE":t=V1(n1.Days,T1.Wide);break;case"EEEEE":t=V1(n1.Days,T1.Narrow);break;case"EEEEEE":t=V1(n1.Days,T1.Short);break;case"a":case"aa":case"aaa":t=V1(n1.DayPeriods,T1.Abbreviated);break;case"aaaa":t=V1(n1.DayPeriods,T1.Wide);break;case"aaaaa":t=V1(n1.DayPeriods,T1.Narrow);break;case"b":case"bb":case"bbb":t=V1(n1.DayPeriods,T1.Abbreviated,oo.Standalone,!0);break;case"bbbb":t=V1(n1.DayPeriods,T1.Wide,oo.Standalone,!0);break;case"bbbbb":t=V1(n1.DayPeriods,T1.Narrow,oo.Standalone,!0);break;case"B":case"BB":case"BBB":t=V1(n1.DayPeriods,T1.Abbreviated,oo.Format,!0);break;case"BBBB":t=V1(n1.DayPeriods,T1.Wide,oo.Format,!0);break;case"BBBBB":t=V1(n1.DayPeriods,T1.Narrow,oo.Format,!0);break;case"h":t=oi(t1.Hours,1,-12);break;case"hh":t=oi(t1.Hours,2,-12);break;case"H":t=oi(t1.Hours,1);break;case"HH":t=oi(t1.Hours,2);break;case"m":t=oi(t1.Minutes,1);break;case"mm":t=oi(t1.Minutes,2);break;case"s":t=oi(t1.Seconds,1);break;case"ss":t=oi(t1.Seconds,2);break;case"S":t=oi(t1.FractionalSeconds,1);break;case"SS":t=oi(t1.FractionalSeconds,2);break;case"SSS":t=oi(t1.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":t=up(T3.Short);break;case"ZZZZZ":t=up(T3.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":t=up(T3.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":t=up(T3.Long);break;default:return null}return vP[r]=t,t}(u);l+=f?f(i,e,c):"''"===u?"'":u.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),l}function cp(r,t,e){const n=new Date(0);return n.setFullYear(r,t,e),n.setHours(0,0,0),n}function w3(r,t){const e=function gfe(r){return ro(r)[D1.LocaleId]}(r);if(ap[e]??={},ap[e][t])return ap[e][t];let n="";switch(t){case"shortDate":n=ip(r,as.Short);break;case"mediumDate":n=ip(r,as.Medium);break;case"longDate":n=ip(r,as.Long);break;case"fullDate":n=ip(r,as.Full);break;case"shortTime":n=op(r,as.Short);break;case"mediumTime":n=op(r,as.Medium);break;case"longTime":n=op(r,as.Long);break;case"fullTime":n=op(r,as.Full);break;case"short":const i=w3(r,"shortTime"),o=w3(r,"shortDate");n=lp(sp(r,as.Short),[i,o]);break;case"medium":const s=w3(r,"mediumTime"),a=w3(r,"mediumDate");n=lp(sp(r,as.Medium),[s,a]);break;case"long":const c=w3(r,"longTime"),l=w3(r,"longDate");n=lp(sp(r,as.Long),[c,l]);break;case"full":const u=w3(r,"fullTime"),f=w3(r,"fullDate");n=lp(sp(r,as.Full),[u,f])}return n&&(ap[e][t]=n),n}function lp(r,t){return t&&(r=r.replace(/\{([^}]+)}/g,function(e,n){return null!=t&&n in t?t[n]:e})),r}function ba(r,t,e="-",n,i){let o="";(r<0||i&&r<=0)&&(i?r=1-r:(r=-r,o=e));let s=String(r);for(;s.length<t;)s="0"+s;return n&&(s=s.slice(s.length-t)),o+s}function oi(r,t,e=0,n=!1,i=!1){return function(o,s){let a=function Afe(r,t){switch(r){case t1.FullYear:return t.getFullYear();case t1.Month:return t.getMonth();case t1.Date:return t.getDate();case t1.Hours:return t.getHours();case t1.Minutes:return t.getMinutes();case t1.Seconds:return t.getSeconds();case t1.FractionalSeconds:return t.getMilliseconds();case t1.Day:return t.getDay();default:throw new Error(`Unknown DateType value "${r}".`)}}(r,o);if((e>0||a>-e)&&(a+=e),r===t1.Hours)0===a&&-12===e&&(a=12);else if(r===t1.FractionalSeconds)return function bfe(r,t){return ba(r,3).substring(0,t)}(a,t);const c=Hs(s,Gr.MinusSign);return ba(a,t,c,n,i)}}function V1(r,t,e=oo.Format,n=!1){return function(i,o){return function Nfe(r,t,e,n,i,o){switch(e){case n1.Months:return function _fe(r,t,e){const n=ro(r),o=Fs([n[D1.MonthsFormat],n[D1.MonthsStandalone]],t);return Fs(o,e)}(t,i,n)[r.getMonth()];case n1.Days:return function mfe(r,t,e){const n=ro(r),o=Fs([n[D1.DaysFormat],n[D1.DaysStandalone]],t);return Fs(o,e)}(t,i,n)[r.getDay()];case n1.DayPeriods:const s=r.getHours(),a=r.getMinutes();if(o){const l=function Mfe(r){const t=ro(r);return sU(t),(t[D1.ExtraData][2]||[]).map(n=>"string"==typeof n?_P(n):[_P(n[0]),_P(n[1])])}(t),u=function Efe(r,t,e){const n=ro(r);sU(n);const o=Fs([n[D1.ExtraData][0],n[D1.ExtraData][1]],t)||[];return Fs(o,e)||[]}(t,i,n),f=l.findIndex(g=>{if(Array.isArray(g)){const[y,S]=g,N=s>=y.hours&&a>=y.minutes,R=s<S.hours||s===S.hours&&a<S.minutes;if(y.hours<S.hours){if(N&&R)return!0}else if(N||R)return!0}else if(g.hours===s&&g.minutes===a)return!0;return!1});if(-1!==f)return u[f]}return function pfe(r,t,e){const n=ro(r),o=Fs([n[D1.DayPeriodsFormat],n[D1.DayPeriodsStandalone]],t);return Fs(o,e)}(t,i,n)[s<12?0:1];case n1.Eras:return function Cfe(r,t){return Fs(ro(r)[D1.Eras],t)}(t,n)[r.getFullYear()<=0?0:1];default:throw new Error(`unexpected translation type ${e}`)}}(i,o,r,t,e,n)}}function up(r){return function(t,e,n){const i=-1*n,o=Hs(e,Gr.MinusSign),s=i>0?Math.floor(i/60):Math.ceil(i/60);switch(r){case T3.Short:return(i>=0?"+":"")+ba(s,2,o)+ba(Math.abs(i%60),2,o);case T3.ShortGMT:return"GMT"+(i>=0?"+":"")+ba(s,1,o);case T3.Long:return"GMT"+(i>=0?"+":"")+ba(s,2,o)+":"+ba(Math.abs(i%60),2,o);case T3.Extended:return 0===n?"Z":(i>=0?"+":"")+ba(s,2,o)+":"+ba(Math.abs(i%60),2,o);default:throw new Error(`Unknown zone width "${r}"`)}}}const Ife=0,fp=4;function cU(r){const t=r.getDay(),e=0===t?-3:fp-t;return cp(r.getFullYear(),r.getMonth(),r.getDate()+e)}function CP(r,t=!1){return function(e,n){let i;if(t){const o=new Date(e.getFullYear(),e.getMonth(),1).getDay()-1,s=e.getDate();i=1+Math.floor((s+o)/7)}else{const o=cU(e),s=function kfe(r){const t=cp(r,Ife,1).getDay();return cp(r,0,1+(t<=fp?fp:fp+7)-t)}(o.getFullYear()),a=o.getTime()-s.getTime();i=1+Math.round(a/6048e5)}return ba(i,r,Hs(n,Gr.MinusSign))}}function dp(r,t=!1){return function(e,n){return ba(cU(e).getFullYear(),r,Hs(n,Gr.MinusSign),t)}}const vP={};function lU(r,t){r=r.replace(/:/g,"");const e=Date.parse("Jan 01, 1970 00:00:00 "+r)/6e4;return isNaN(e)?t:e}function uU(r){return r instanceof Date&&!isNaN(r.valueOf())}const Vfe=/^(\d+)?\.((\d+)(-(\d+))?)?$/;function PP(r){const t=parseInt(r);if(isNaN(t))throw new Error("Invalid integer literal when parsing "+r);return t}function gU(r,t){t=encodeURIComponent(t);for(const e of r.split(";")){const n=e.indexOf("="),[i,o]=-1==n?[e,""]:[e.slice(0,n),e.slice(n+1)];if(i.trim()===t)return decodeURIComponent(o)}return null}const OP=/\s+/,pU=[];let zt=(()=>{class r{constructor(e,n){this._ngEl=e,this._renderer=n,this.initialClasses=pU,this.stateMap=new Map}set klass(e){this.initialClasses=null!=e?e.trim().split(OP):pU}set ngClass(e){this.rawClass="string"==typeof e?e.trim().split(OP):e}ngDoCheck(){for(const n of this.initialClasses)this._updateState(n,!0);const e=this.rawClass;if(Array.isArray(e)||e instanceof Set)for(const n of e)this._updateState(n,!0);else if(null!=e)for(const n of Object.keys(e))this._updateState(n,!!e[n]);this._applyStateDiff()}_updateState(e,n){const i=this.stateMap.get(e);void 0!==i?(i.enabled!==n&&(i.changed=!0,i.enabled=n),i.touched=!0):this.stateMap.set(e,{enabled:n,changed:!0,touched:!0})}_applyStateDiff(){for(const e of this.stateMap){const n=e[0],i=e[1];i.changed?(this._toggleClass(n,i.enabled),i.changed=!1):i.touched||(i.enabled&&this._toggleClass(n,!1),this.stateMap.delete(n)),i.touched=!1}}_toggleClass(e,n){(e=e.trim()).length>0&&e.split(OP).forEach(i=>{n?this._renderer.addClass(this._ngEl.nativeElement,i):this._renderer.removeClass(this._ngEl.nativeElement,i)})}static#e=this.\u0275fac=function(n){return new(n||r)(G(I2),G(lc))};static#t=this.\u0275dir=Vt({type:r,selectors:[["","ngClass",""]],inputs:{klass:[Z1.None,"class","klass"],ngClass:"ngClass"},standalone:!0})}return r})();class Xfe{constructor(t,e,n,i){this.$implicit=t,this.ngForOf=e,this.index=n,this.count=i}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let Nt=(()=>{class r{set ngForOf(e){this._ngForOf=e,this._ngForOfDirty=!0}set ngForTrackBy(e){this._trackByFn=e}get ngForTrackBy(){return this._trackByFn}constructor(e,n,i){this._viewContainer=e,this._template=n,this._differs=i,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(e){e&&(this._template=e)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const e=this._ngForOf;!this._differ&&e&&(this._differ=this._differs.find(e).create(this.ngForTrackBy))}if(this._differ){const e=this._differ.diff(this._ngForOf);e&&this._applyChanges(e)}}_applyChanges(e){const n=this._viewContainer;e.forEachOperation((i,o,s)=>{if(null==i.previousIndex)n.createEmbeddedView(this._template,new Xfe(i.item,this._ngForOf,-1,-1),null===s?void 0:s);else if(null==s)n.remove(null===o?void 0:o);else if(null!==o){const a=n.get(o);n.move(a,s),_U(a,i)}});for(let i=0,o=n.length;i<o;i++){const a=n.get(i).context;a.index=i,a.count=o,a.ngForOf=this._ngForOf}e.forEachIdentityChange(i=>{_U(n.get(i.currentIndex),i)})}static ngTemplateContextGuard(e,n){return!0}static#e=this.\u0275fac=function(n){return new(n||r)(G(os),G(E3),G(fP))};static#t=this.\u0275dir=Vt({type:r,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0})}return r})();function _U(r,t){r.context.$implicit=t.item}let bt=(()=>{class r{constructor(e,n){this._viewContainer=e,this._context=new Qfe,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=n}set ngIf(e){this._context.$implicit=this._context.ngIf=e,this._updateView()}set ngIfThen(e){CU("ngIfThen",e),this._thenTemplateRef=e,this._thenViewRef=null,this._updateView()}set ngIfElse(e){CU("ngIfElse",e),this._elseTemplateRef=e,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(e,n){return!0}static#e=this.\u0275fac=function(n){return new(n||r)(G(os),G(E3))};static#t=this.\u0275dir=Vt({type:r,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0})}return r})();class Qfe{constructor(){this.$implicit=null,this.ngIf=null}}function CU(r,t){if(t&&!t.createEmbeddedView)throw new Error(`${r} must be a TemplateRef, but received '${pi(t)}'.`)}let MU=(()=>{class r{constructor(e){this._locale=e}transform(e,n,i){if(!function bP(r){return!(null==r||""===r||r!=r)}(e))return null;i||=this._locale;try{return function $fe(r,t,e){return function MP(r,t,e,n,i,o,s=!1){let a="",c=!1;if(isFinite(r)){let l=function qfe(r){let n,i,o,s,a,t=Math.abs(r)+"",e=0;for((i=t.indexOf("."))>-1&&(t=t.replace(".","")),(o=t.search(/e/i))>0?(i<0&&(i=o),i+=+t.slice(o+1),t=t.substring(0,o)):i<0&&(i=t.length),o=0;"0"===t.charAt(o);o++);if(o===(a=t.length))n=[0],i=1;else{for(a--;"0"===t.charAt(a);)a--;for(i-=o,n=[],s=0;o<=a;o++,s++)n[s]=Number(t.charAt(o))}return i>22&&(n=n.splice(0,21),e=i-1,i=1),{digits:n,exponent:e,integerLen:i}}(r);s&&(l=function Wfe(r){if(0===r.digits[0])return r;const t=r.digits.length-r.integerLen;return r.exponent?r.exponent+=2:(0===t?r.digits.push(0,0):1===t&&r.digits.push(0),r.integerLen+=2),r}(l));let u=t.minInt,f=t.minFrac,g=t.maxFrac;if(o){const $=o.match(Vfe);if(null===$)throw new Error(`${o} is not a valid digit info`);const re=$[1],_e=$[3],be=$[5];null!=re&&(u=PP(re)),null!=_e&&(f=PP(_e)),null!=be?g=PP(be):null!=_e&&f>g&&(g=f)}!function jfe(r,t,e){if(t>e)throw new Error(`The minimum number of digits after fraction (${t}) is higher than the maximum (${e}).`);let n=r.digits,i=n.length-r.integerLen;const o=Math.min(Math.max(t,i),e);let s=o+r.integerLen,a=n[s];if(s>0){n.splice(Math.max(r.integerLen,s));for(let f=s;f<n.length;f++)n[f]=0}else{i=Math.max(0,i),r.integerLen=1,n.length=Math.max(1,s=o+1),n[0]=0;for(let f=1;f<s;f++)n[f]=0}if(a>=5)if(s-1<0){for(let f=0;f>s;f--)n.unshift(0),r.integerLen++;n.unshift(1),r.integerLen++}else n[s-1]++;for(;i<Math.max(0,o);i++)n.push(0);let c=0!==o;const l=t+r.integerLen,u=n.reduceRight(function(f,g,y,S){return S[y]=(g+=f)<10?g:g-10,c&&(0===S[y]&&y>=l?S.pop():c=!1),g>=10?1:0},0);u&&(n.unshift(u),r.integerLen++)}(l,f,g);let y=l.digits,S=l.integerLen;const N=l.exponent;let R=[];for(c=y.every($=>!$);S<u;S++)y.unshift(0);for(;S<0;S++)y.unshift(0);S>0?R=y.splice(S,y.length):(R=y,y=[0]);const U=[];for(y.length>=t.lgSize&&U.unshift(y.splice(-t.lgSize,y.length).join(""));y.length>t.gSize;)U.unshift(y.splice(-t.gSize,y.length).join(""));y.length&&U.unshift(y.join("")),a=U.join(Hs(e,n)),R.length&&(a+=Hs(e,i)+R.join("")),N&&(a+=Hs(e,Gr.Exponential)+"+"+N)}else a=Hs(e,Gr.Infinity);return a=r<0&&!c?t.negPre+a+t.negSuf:t.posPre+a+t.posSuf,a}(r,function EP(r,t="-"){const e={minInt:1,minFrac:0,maxFrac:0,posPre:"",posSuf:"",negPre:"",negSuf:"",gSize:0,lgSize:0},n=r.split(";"),i=n[0],o=n[1],s=-1!==i.indexOf(".")?i.split("."):[i.substring(0,i.lastIndexOf("0")+1),i.substring(i.lastIndexOf("0")+1)],a=s[0],c=s[1]||"";e.posPre=a.substring(0,a.indexOf("#"));for(let u=0;u<c.length;u++){const f=c.charAt(u);"0"===f?e.minFrac=e.maxFrac=u+1:"#"===f?e.maxFrac=u+1:e.posSuf+=f}const l=a.split(",");if(e.gSize=l[1]?l[1].length:0,e.lgSize=l[2]||l[1]?(l[2]||l[1]).length:0,o){const u=i.length-e.posPre.length-e.posSuf.length,f=o.indexOf("#");e.negPre=o.substring(0,f).replace(/'/g,""),e.negSuf=o.slice(f+u).replace(/'/g,"")}else e.negPre=t+e.posPre,e.negSuf=e.posSuf;return e}(function mP(r,t){return ro(r)[D1.NumberFormats][t]}(t,rp.Decimal),Hs(t,Gr.MinusSign)),t,Gr.Group,Gr.Decimal,e)}(function AP(r){if("string"==typeof r&&!isNaN(Number(r)-parseFloat(r)))return Number(r);if("number"!=typeof r)throw new Error(`${r} is not a number`);return r}(e),i,n)}catch(o){throw function Aa(r,t){return new de(2100,!1)}()}}static#e=this.\u0275fac=function(n){return new(n||r)(G(mc,16))};static#t=this.\u0275pipe=O2({name:"number",type:r,pure:!0,standalone:!0})}return r})();let P9e=(()=>{class r{static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275mod=Ls({type:r});static#n=this.\u0275inj=ns({})}return r})();const EU="browser";function PU(r){return"server"===r}let b9e=(()=>{class r{static#e=this.\u0275prov=xe({token:r,providedIn:"root",factory:()=>function w9e(r){return r===EU}(Ne(y4))?new A9e(Ne(R2),window):new I9e})}return r})();class A9e{constructor(t,e){this.document=t,this.window=e,this.offset=()=>[0,0]}setOffset(t){this.offset=Array.isArray(t)?()=>t:t}getScrollPosition(){return[this.window.scrollX,this.window.scrollY]}scrollToPosition(t){this.window.scrollTo(t[0],t[1])}scrollToAnchor(t){const e=function N9e(r,t){const e=r.getElementById(t)||r.getElementsByName(t)[0];if(e)return e;if("function"==typeof r.createTreeWalker&&r.body&&"function"==typeof r.body.attachShadow){const n=r.createTreeWalker(r.body,NodeFilter.SHOW_ELEMENT);let i=n.currentNode;for(;i;){const o=i.shadowRoot;if(o){const s=o.getElementById(t)||o.querySelector(`[name="${t}"]`);if(s)return s}i=n.nextNode()}}return null}(this.document,t);e&&(this.scrollToElement(e),e.focus())}setHistoryScrollRestoration(t){this.window.history.scrollRestoration=t}scrollToElement(t){const e=t.getBoundingClientRect(),n=e.left+this.window.pageXOffset,i=e.top+this.window.pageYOffset,o=this.offset();this.window.scrollTo(n-o[0],i-o[1])}}class I9e{setOffset(t){}getScrollPosition(){return[0,0]}scrollToPosition(t){}scrollToAnchor(t){}setHistoryScrollRestoration(t){}}class SU{}class ode extends sfe{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class IP extends ode{static makeCurrent(){!function ofe(r){eU??=r}(new IP)}onAndCancel(t,e,n){return t.addEventListener(e,n),()=>{t.removeEventListener(e,n)}}dispatchEvent(t,e){t.dispatchEvent(e)}remove(t){t.parentNode&&t.parentNode.removeChild(t)}createElement(t,e){return(e=e||this.getDefaultDocument()).createElement(t)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(t){return t.nodeType===Node.ELEMENT_NODE}isShadowRoot(t){return t instanceof DocumentFragment}getGlobalEventTarget(t,e){return"window"===e?window:"document"===e?t:"body"===e?t.body:null}getBaseHref(t){const e=function sde(){return j7=j7||document.querySelector("base"),j7?j7.getAttribute("href"):null}();return null==e?null:function ade(r){return new URL(r,document.baseURI).pathname}(e)}resetBaseElement(){j7=null}getUserAgent(){return window.navigator.userAgent}getCookie(t){return gU(document.cookie,t)}}let j7=null,lde=(()=>{class r{build(){return new XMLHttpRequest}static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275prov=xe({token:r,factory:r.\u0275fac})}return r})();const kP=new tt("");let RU=(()=>{class r{constructor(e,n){this._zone=n,this._eventNameToPlugin=new Map,e.forEach(i=>{i.manager=this}),this._plugins=e.slice().reverse()}addEventListener(e,n,i){return this._findPluginFor(n).addEventListener(e,n,i)}getZone(){return this._zone}_findPluginFor(e){let n=this._eventNameToPlugin.get(e);if(n)return n;if(n=this._plugins.find(o=>o.supports(e)),!n)throw new de(5101,!1);return this._eventNameToPlugin.set(e,n),n}static#e=this.\u0275fac=function(n){return new(n||r)(ze(kP),ze(Xn))};static#t=this.\u0275prov=xe({token:r,factory:r.\u0275fac})}return r})();class xU{constructor(t){this._doc=t}}const RP="ng-app-id";let LU=(()=>{class r{constructor(e,n,i,o={}){this.doc=e,this.appId=n,this.nonce=i,this.platformId=o,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=PU(o),this.resetHostNodes()}addStyles(e){for(const n of e)1===this.changeUsageCount(n,1)&&this.onStyleAdded(n)}removeStyles(e){for(const n of e)this.changeUsageCount(n,-1)<=0&&this.onStyleRemoved(n)}ngOnDestroy(){const e=this.styleNodesInDOM;e&&(e.forEach(n=>n.remove()),e.clear());for(const n of this.getAllStyles())this.onStyleRemoved(n);this.resetHostNodes()}addHost(e){this.hostNodes.add(e);for(const n of this.getAllStyles())this.addStyleToHost(e,n)}removeHost(e){this.hostNodes.delete(e)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(e){for(const n of this.hostNodes)this.addStyleToHost(n,e)}onStyleRemoved(e){const n=this.styleRef;n.get(e)?.elements?.forEach(i=>i.remove()),n.delete(e)}collectServerRenderedStyles(){const e=this.doc.head?.querySelectorAll(`style[${RP}="${this.appId}"]`);if(e?.length){const n=new Map;return e.forEach(i=>{null!=i.textContent&&n.set(i.textContent,i)}),n}return null}changeUsageCount(e,n){const i=this.styleRef;if(i.has(e)){const o=i.get(e);return o.usage+=n,o.usage}return i.set(e,{usage:n,elements:[]}),n}getStyleElement(e,n){const i=this.styleNodesInDOM,o=i?.get(n);if(o?.parentNode===e)return i.delete(n),o.removeAttribute(RP),o;{const s=this.doc.createElement("style");return this.nonce&&s.setAttribute("nonce",this.nonce),s.textContent=n,this.platformIsServer&&s.setAttribute(RP,this.appId),e.appendChild(s),s}}addStyleToHost(e,n){const i=this.getStyleElement(e,n),o=this.styleRef,s=o.get(n)?.elements;s?s.push(i):o.set(n,{elements:[i],usage:1})}resetHostNodes(){const e=this.hostNodes;e.clear(),e.add(this.doc.head)}static#e=this.\u0275fac=function(n){return new(n||r)(ze(R2),ze(Mh),ze(Nx,8),ze(y4))};static#t=this.\u0275prov=xe({token:r,factory:r.\u0275fac})}return r})();const xP={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},LP=/%COMP%/g,hde=new tt("",{providedIn:"root",factory:()=>!0});function DU(r,t){return t.map(e=>e.replace(LP,r))}let zP=(()=>{class r{constructor(e,n,i,o,s,a,c,l=null){this.eventManager=e,this.sharedStylesHost=n,this.appId=i,this.removeStylesOnCompDestroy=o,this.doc=s,this.platformId=a,this.ngZone=c,this.nonce=l,this.rendererByCompId=new Map,this.platformIsServer=PU(a),this.defaultRenderer=new DP(e,s,c,this.platformIsServer)}createRenderer(e,n){if(!e||!n)return this.defaultRenderer;this.platformIsServer&&n.encapsulation===Ca.ShadowDom&&(n={...n,encapsulation:Ca.Emulated});const i=this.getOrCreateRenderer(e,n);return i instanceof HU?i.applyToHost(e):i instanceof VP&&i.applyStyles(),i}getOrCreateRenderer(e,n){const i=this.rendererByCompId;let o=i.get(n.id);if(!o){const s=this.doc,a=this.ngZone,c=this.eventManager,l=this.sharedStylesHost,u=this.removeStylesOnCompDestroy,f=this.platformIsServer;switch(n.encapsulation){case Ca.Emulated:o=new HU(c,l,n,this.appId,u,s,a,f);break;case Ca.ShadowDom:return new _de(c,l,e,n,s,a,this.nonce,f);default:o=new VP(c,l,n,u,s,a,f)}i.set(n.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}static#e=this.\u0275fac=function(n){return new(n||r)(ze(RU),ze(LU),ze(Mh),ze(hde),ze(R2),ze(y4),ze(Xn),ze(Nx))};static#t=this.\u0275prov=xe({token:r,factory:r.\u0275fac})}return r})();class DP{constructor(t,e,n,i){this.eventManager=t,this.doc=e,this.ngZone=n,this.platformIsServer=i,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(t,e){return e?this.doc.createElementNS(xP[e]||e,t):this.doc.createElement(t)}createComment(t){return this.doc.createComment(t)}createText(t){return this.doc.createTextNode(t)}appendChild(t,e){(VU(t)?t.content:t).appendChild(e)}insertBefore(t,e,n){t&&(VU(t)?t.content:t).insertBefore(e,n)}removeChild(t,e){t&&t.removeChild(e)}selectRootElement(t,e){let n="string"==typeof t?this.doc.querySelector(t):t;if(!n)throw new de(-5104,!1);return e||(n.textContent=""),n}parentNode(t){return t.parentNode}nextSibling(t){return t.nextSibling}setAttribute(t,e,n,i){if(i){e=i+":"+e;const o=xP[i];o?t.setAttributeNS(o,e,n):t.setAttribute(e,n)}else t.setAttribute(e,n)}removeAttribute(t,e,n){if(n){const i=xP[n];i?t.removeAttributeNS(i,e):t.removeAttribute(`${n}:${e}`)}else t.removeAttribute(e)}addClass(t,e){t.classList.add(e)}removeClass(t,e){t.classList.remove(e)}setStyle(t,e,n,i){i&(S4.DashCase|S4.Important)?t.style.setProperty(e,n,i&S4.Important?"important":""):t.style[e]=n}removeStyle(t,e,n){n&S4.DashCase?t.style.removeProperty(e):t.style[e]=""}setProperty(t,e,n){null!=t&&(t[e]=n)}setValue(t,e){t.nodeValue=e}listen(t,e,n){if("string"==typeof t&&!(t=x4().getGlobalEventTarget(this.doc,t)))throw new Error(`Unsupported event target ${t} for event ${e}`);return this.eventManager.addEventListener(t,e,this.decoratePreventDefault(n))}decoratePreventDefault(t){return e=>{if("__ngUnwrap__"===e)return t;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>t(e)):t(e))&&e.preventDefault()}}}function VU(r){return"TEMPLATE"===r.tagName&&void 0!==r.content}class _de extends DP{constructor(t,e,n,i,o,s,a,c){super(t,o,s,c),this.sharedStylesHost=e,this.hostEl=n,this.shadowRoot=n.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const l=DU(i.id,i.styles);for(const u of l){const f=document.createElement("style");a&&f.setAttribute("nonce",a),f.textContent=u,this.shadowRoot.appendChild(f)}}nodeOrShadowRoot(t){return t===this.hostEl?this.shadowRoot:t}appendChild(t,e){return super.appendChild(this.nodeOrShadowRoot(t),e)}insertBefore(t,e,n){return super.insertBefore(this.nodeOrShadowRoot(t),e,n)}removeChild(t,e){return super.removeChild(this.nodeOrShadowRoot(t),e)}parentNode(t){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(t)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class VP extends DP{constructor(t,e,n,i,o,s,a,c){super(t,o,s,a),this.sharedStylesHost=e,this.removeStylesOnCompDestroy=i,this.styles=c?DU(c,n.styles):n.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}}class HU extends VP{constructor(t,e,n,i,o,s,a,c){const l=i+"-"+n.id;super(t,e,n,o,s,a,c,l),this.contentAttr=function gde(r){return"_ngcontent-%COMP%".replace(LP,r)}(l),this.hostAttr=function pde(r){return"_nghost-%COMP%".replace(LP,r)}(l)}applyToHost(t){this.applyStyles(),this.setAttribute(t,this.hostAttr,"")}createElement(t,e){const n=super.createElement(t,e);return super.setAttribute(n,this.contentAttr,""),n}}let Cde=(()=>{class r extends xU{constructor(e){super(e)}supports(e){return!0}addEventListener(e,n,i){return e.addEventListener(n,i,!1),()=>this.removeEventListener(e,n,i)}removeEventListener(e,n,i){return e.removeEventListener(n,i)}static#e=this.\u0275fac=function(n){return new(n||r)(ze(R2))};static#t=this.\u0275prov=xe({token:r,factory:r.\u0275fac})}return r})();const FU=["alt","control","meta","shift"],vde={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},yde={alt:r=>r.altKey,control:r=>r.ctrlKey,meta:r=>r.metaKey,shift:r=>r.shiftKey};let Mde=(()=>{class r extends xU{constructor(e){super(e)}supports(e){return null!=r.parseEventName(e)}addEventListener(e,n,i){const o=r.parseEventName(n),s=r.eventCallback(o.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>x4().onAndCancel(e,o.domEventName,s))}static parseEventName(e){const n=e.toLowerCase().split("."),i=n.shift();if(0===n.length||"keydown"!==i&&"keyup"!==i)return null;const o=r._normalizeKey(n.pop());let s="",a=n.indexOf("code");if(a>-1&&(n.splice(a,1),s="code."),FU.forEach(l=>{const u=n.indexOf(l);u>-1&&(n.splice(u,1),s+=l+".")}),s+=o,0!=n.length||0===o.length)return null;const c={};return c.domEventName=i,c.fullKey=s,c}static matchEventFullKeyCode(e,n){let i=vde[e.key]||e.key,o="";return n.indexOf("code.")>-1&&(i=e.code,o="code."),!(null==i||!i)&&(i=i.toLowerCase()," "===i?i="space":"."===i&&(i="dot"),FU.forEach(s=>{s!==i&&(0,yde[s])(e)&&(o+=s+".")}),o+=i,o===n)}static eventCallback(e,n,i){return o=>{r.matchEventFullKeyCode(o,e)&&i.runGuarded(()=>n(o))}}static _normalizeKey(e){return"esc"===e?"escape":e}static#e=this.\u0275fac=function(n){return new(n||r)(ze(R2))};static#t=this.\u0275prov=xe({token:r,factory:r.\u0275fac})}return r})();const GU=[{provide:y4,useValue:EU},{provide:bx,useValue:function Ede(){IP.makeCurrent()},multi:!0},{provide:R2,useFactory:function Sde(){return function Zae(r){Ty=r}(document),document},deps:[]}],Ode=yF(P7e,"browser",GU),Tde=new tt(""),BU=[{provide:qg,useClass:class cde{addToWindow(t){o1.getAngularTestability=(n,i=!0)=>{const o=t.findTestabilityInTree(n,i);if(null==o)throw new de(5103,!1);return o},o1.getAllAngularTestabilities=()=>t.getAllTestabilities(),o1.getAllAngularRootElements=()=>t.getAllRootElements(),o1.frameworkStabilizers||(o1.frameworkStabilizers=[]),o1.frameworkStabilizers.push(n=>{const i=o1.getAllAngularTestabilities();let o=i.length;const s=function(){o--,0==o&&n()};i.forEach(a=>{a.whenStable(s)})})}findTestabilityInTree(t,e,n){return null==e?null:t.getTestability(e)??(n?x4().isShadowRoot(e)?this.findTestabilityInTree(t,e.host,!0):this.findTestabilityInTree(t,e.parentElement,!0):null)}},deps:[]},{provide:lF,useClass:QE,deps:[Xn,JE,qg]},{provide:QE,useClass:QE,deps:[Xn,JE,qg]}],$U=[{provide:Jy,useValue:"root"},{provide:v3,useFactory:function Pde(){return new v3},deps:[]},{provide:kP,useClass:Cde,multi:!0,deps:[R2,Xn,y4]},{provide:kP,useClass:Mde,multi:!0,deps:[R2]},zP,LU,RU,{provide:QM,useExisting:zP},{provide:SU,useClass:lde,deps:[]},[]];let WU=(()=>{class r{constructor(e){}static withServerTransition(e){return{ngModule:r,providers:[{provide:Mh,useValue:e.appId}]}}static#e=this.\u0275fac=function(n){return new(n||r)(ze(Tde,12))};static#t=this.\u0275mod=Ls({type:r});static#n=this.\u0275inj=ns({providers:[...$U,...BU],imports:[P9e,S7e]})}return r})(),wde=(()=>{class r{constructor(e){this._doc=e}getTitle(){return this._doc.title}setTitle(e){this._doc.title=e||""}static#e=this.\u0275fac=function(n){return new(n||r)(ze(R2))};static#t=this.\u0275prov=xe({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})(),ZU=(()=>{class r{static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275prov=xe({token:r,factory:function(n){let i=null;return i=n?new(n||r):ze(Ide),i},providedIn:"root"})}return r})(),Ide=(()=>{class r extends ZU{constructor(e){super(),this._doc=e}sanitize(e,n){if(null==n)return null;switch(e){case zs.NONE:return n;case zs.HTML:return ac(n,"HTML")?rs(n):AL(this._doc,String(n)).toString();case zs.STYLE:return ac(n,"Style")?rs(n):n;case zs.SCRIPT:if(ac(n,"Script"))return rs(n);throw new de(5200,!1);case zs.URL:return ac(n,"URL")?rs(n):Xh(String(n));case zs.RESOURCE_URL:if(ac(n,"ResourceURL"))return rs(n);throw new de(5201,!1);default:throw new de(5202,!1)}}bypassSecurityTrustHtml(e){return function P3e(r){return new _3e(r)}(e)}bypassSecurityTrustStyle(e){return function S3e(r){return new C3e(r)}(e)}bypassSecurityTrustScript(e){return function O3e(r){return new v3e(r)}(e)}bypassSecurityTrustUrl(e){return function T3e(r){return new y3e(r)}(e)}bypassSecurityTrustResourceUrl(e){return function w3e(r){return new M3e(r)}(e)}static#e=this.\u0275fac=function(n){return new(n||r)(ze(R2))};static#t=this.\u0275prov=xe({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();function mp(r,t){var e={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&t.indexOf(n)<0&&(e[n]=r[n]);if(null!=r&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(r);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(e[n[i]]=r[n[i]])}return e}function L4(r){return this instanceof L4?(this.v=r,this):new L4(r)}function JU(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,t=r[Symbol.asyncIterator];return t?t.call(r):(r=function GP(r){var t="function"==typeof Symbol&&Symbol.iterator,e=t&&r[t],n=0;if(e)return e.call(r);if(r&&"number"==typeof r.length)return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(r),e={},n("next"),n("throw"),n("return"),e[Symbol.asyncIterator]=function(){return this},e);function n(o){e[o]=r[o]&&function(s){return new Promise(function(a,c){!function i(o,s,a,c){Promise.resolve(c).then(function(l){o({value:l,done:a})},s)}(a,c,(s=r[o](s)).done,s.value)})}}}"function"==typeof SuppressedError&&SuppressedError;const eG=r=>r&&"number"==typeof r.length&&"function"!=typeof r;function tG(r){return Me(r?.then)}function nG(r){return Me(r[Jv])}function rG(r){return Symbol.asyncIterator&&Me(r?.[Symbol.asyncIterator])}function iG(r){return new TypeError(`You provided ${null!==r&&"object"==typeof r?"an invalid object":`'${r}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const oG=function Qde(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function sG(r){return Me(r?.[oG])}function aG(r){return function QU(r,t,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,n=e.apply(r,t||[]),o=[];return i={},s("next"),s("throw"),s("return"),i[Symbol.asyncIterator]=function(){return this},i;function s(g){n[g]&&(i[g]=function(y){return new Promise(function(S,N){o.push([g,y,S,N])>1||a(g,y)})})}function a(g,y){try{!function c(g){g.value instanceof L4?Promise.resolve(g.value.v).then(l,u):f(o[0][2],g)}(n[g](y))}catch(S){f(o[0][3],S)}}function l(g){a("next",g)}function u(g){a("throw",g)}function f(g,y){g(y),o.shift(),o.length&&a(o[0][0],o[0][1])}}(this,arguments,function*(){const e=r.getReader();try{for(;;){const{value:n,done:i}=yield L4(e.read());if(i)return yield L4(void 0);yield yield L4(n)}}finally{e.releaseLock()}})}function cG(r){return Me(r?.getReader)}function _c(r){if(r instanceof ri)return r;if(null!=r){if(nG(r))return function Jde(r){return new ri(t=>{const e=r[Jv]();if(Me(e.subscribe))return e.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(r);if(eG(r))return function ehe(r){return new ri(t=>{for(let e=0;e<r.length&&!t.closed;e++)t.next(r[e]);t.complete()})}(r);if(tG(r))return function the(r){return new ri(t=>{r.then(e=>{t.closed||(t.next(e),t.complete())},e=>t.error(e)).then(null,Fl)})}(r);if(rG(r))return lG(r);if(sG(r))return function nhe(r){return new ri(t=>{for(const e of r)if(t.next(e),t.closed)return;t.complete()})}(r);if(cG(r))return function rhe(r){return lG(aG(r))}(r)}throw iG(r)}function lG(r){return new ri(t=>{(function ihe(r,t){var e,n,i,o;return function KU(r,t,e,n){return new(e||(e=Promise))(function(o,s){function a(u){try{l(n.next(u))}catch(f){s(f)}}function c(u){try{l(n.throw(u))}catch(f){s(f)}}function l(u){u.done?o(u.value):function i(o){return o instanceof e?o:new e(function(s){s(o)})}(u.value).then(a,c)}l((n=n.apply(r,t||[])).next())})}(this,void 0,void 0,function*(){try{for(e=JU(r);!(n=yield e.next()).done;)if(t.next(n.value),t.closed)return}catch(s){i={error:s}}finally{try{n&&!n.done&&(o=e.return)&&(yield o.call(e))}finally{if(i)throw i.error}}t.complete()})})(r,t).catch(e=>t.error(e))})}function b3(r,t,e,n=0,i=!1){const o=t.schedule(function(){e(),i?r.add(this.schedule(null,n)):this.unsubscribe()},n);if(r.add(o),!i)return o}function uG(r,t=0){return Ji((e,n)=>{e.subscribe(gi(n,i=>b3(n,r,()=>n.next(i),t),()=>b3(n,r,()=>n.complete(),t),i=>b3(n,r,()=>n.error(i),t)))})}function fG(r,t=0){return Ji((e,n)=>{n.add(r.schedule(()=>e.subscribe(n),t))})}function dG(r,t){if(!r)throw new Error("Iterable cannot be null");return new ri(e=>{b3(e,t,()=>{const n=r[Symbol.asyncIterator]();b3(e,t,()=>{n.next().then(i=>{i.done?e.complete():e.next(i.value)})},0,!0)})})}function Mi(r,t){return t?function uhe(r,t){if(null!=r){if(nG(r))return function ohe(r,t){return _c(r).pipe(fG(t),uG(t))}(r,t);if(eG(r))return function ahe(r,t){return new ri(e=>{let n=0;return t.schedule(function(){n===r.length?e.complete():(e.next(r[n++]),e.closed||this.schedule())})})}(r,t);if(tG(r))return function she(r,t){return _c(r).pipe(fG(t),uG(t))}(r,t);if(rG(r))return dG(r,t);if(sG(r))return function che(r,t){return new ri(e=>{let n;return b3(e,t,()=>{n=r[oG](),b3(e,t,()=>{let i,o;try{({value:i,done:o}=n.next())}catch(s){return void e.error(s)}o?e.complete():e.next(i)},0,!0)}),()=>Me(n?.return)&&n.return()})}(r,t);if(cG(r))return function lhe(r,t){return dG(aG(r),t)}(r,t)}throw iG(r)}(r,t):_c(r)}const{isArray:fhe}=Array,{getPrototypeOf:dhe,prototype:hhe,keys:ghe}=Object;function hG(r){if(1===r.length){const t=r[0];if(fhe(t))return{args:t,keys:null};if(function phe(r){return r&&"object"==typeof r&&dhe(r)===hhe}(t)){const e=ghe(t);return{args:e.map(n=>t[n]),keys:e}}}return{args:r,keys:null}}function BP(r){return r[r.length-1]}function gG(r){return Me(BP(r))?r.pop():void 0}function _p(r){return function mhe(r){return r&&Me(r.schedule)}(BP(r))?r.pop():void 0}const{isArray:_he}=Array;function pG(r){return jn(t=>function Che(r,t){return _he(t)?r(...t):r(t)}(r,t))}function mG(r,t){return r.reduce((e,n,i)=>(e[n]=t[i],e),{})}let _G=(()=>{class r{constructor(e,n){this._renderer=e,this._elementRef=n,this.onChange=i=>{},this.onTouched=()=>{}}setProperty(e,n){this._renderer.setProperty(this._elementRef.nativeElement,e,n)}registerOnTouched(e){this.onTouched=e}registerOnChange(e){this.onChange=e}setDisabledState(e){this.setProperty("disabled",e)}static#e=this.\u0275fac=function(n){return new(n||r)(G(lc),G(I2))};static#t=this.\u0275dir=Vt({type:r})}return r})(),c6=(()=>{class r extends _G{static#e=this.\u0275fac=(()=>{let e;return function(i){return(e||(e=z1(r)))(i||r)}})();static#t=this.\u0275dir=Vt({type:r,features:[$e]})}return r})();const Cc=new tt(""),yhe={provide:Cc,useExisting:L1(()=>Cp),multi:!0};let Cp=(()=>{class r extends c6{writeValue(e){this.setProperty("checked",e)}static#e=this.\u0275fac=(()=>{let e;return function(i){return(e||(e=z1(r)))(i||r)}})();static#t=this.\u0275dir=Vt({type:r,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(n,i){1&n&&q("change",function(s){return i.onChange(s.target.checked)})("blur",function(){return i.onTouched()})},features:[ur([yhe]),$e]})}return r})();const Mhe={provide:Cc,useExisting:L1(()=>Na),multi:!0},Phe=new tt("");let Na=(()=>{class r extends _G{constructor(e,n,i){super(e,n),this._compositionMode=i,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function Ehe(){const r=x4()?x4().getUserAgent():"";return/android (\d+)/.test(r.toLowerCase())}())}writeValue(e){this.setProperty("value",e??"")}_handleInput(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}_compositionStart(){this._composing=!0}_compositionEnd(e){this._composing=!1,this._compositionMode&&this.onChange(e)}static#e=this.\u0275fac=function(n){return new(n||r)(G(lc),G(I2),G(Phe,8))};static#t=this.\u0275dir=Vt({type:r,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(n,i){1&n&&q("input",function(s){return i._handleInput(s.target.value)})("blur",function(){return i.onTouched()})("compositionstart",function(){return i._compositionStart()})("compositionend",function(s){return i._compositionEnd(s.target.value)})},features:[ur([Mhe]),$e]})}return r})();function z4(r){return null==r||("string"==typeof r||Array.isArray(r))&&0===r.length}function CG(r){return null!=r&&"number"==typeof r.length}const x2=new tt(""),D4=new tt(""),She=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class Y7{static min(t){return function vG(r){return t=>{if(z4(t.value)||z4(r))return null;const e=parseFloat(t.value);return!isNaN(e)&&e<r?{min:{min:r,actual:t.value}}:null}}(t)}static max(t){return function yG(r){return t=>{if(z4(t.value)||z4(r))return null;const e=parseFloat(t.value);return!isNaN(e)&&e>r?{max:{max:r,actual:t.value}}:null}}(t)}static required(t){return MG(t)}static requiredTrue(t){return EG(t)}static email(t){return function PG(r){return z4(r.value)||She.test(r.value)?null:{email:!0}}(t)}static minLength(t){return function SG(r){return t=>z4(t.value)||!CG(t.value)?null:t.value.length<r?{minlength:{requiredLength:r,actualLength:t.value.length}}:null}(t)}static maxLength(t){return OG(t)}static pattern(t){return function TG(r){if(!r)return vp;let t,e;return"string"==typeof r?(e="","^"!==r.charAt(0)&&(e+="^"),e+=r,"$"!==r.charAt(r.length-1)&&(e+="$"),t=new RegExp(e)):(e=r.toString(),t=r),n=>{if(z4(n.value))return null;const i=n.value;return t.test(i)?null:{pattern:{requiredPattern:e,actualValue:i}}}}(t)}static nullValidator(t){return null}static compose(t){return kG(t)}static composeAsync(t){return RG(t)}}function MG(r){return z4(r.value)?{required:!0}:null}function EG(r){return!0===r.value?null:{required:!0}}function OG(r){return t=>CG(t.value)&&t.value.length>r?{maxlength:{requiredLength:r,actualLength:t.value.length}}:null}function vp(r){return null}function wG(r){return null!=r}function bG(r){return F7(r)?Mi(r):r}function AG(r){let t={};return r.forEach(e=>{t=null!=e?{...t,...e}:t}),0===Object.keys(t).length?null:t}function NG(r,t){return t.map(e=>e(r))}function IG(r){return r.map(t=>function Ohe(r){return!r.validate}(t)?t:e=>t.validate(e))}function kG(r){if(!r)return null;const t=r.filter(wG);return 0==t.length?null:function(e){return AG(NG(e,t))}}function $P(r){return null!=r?kG(IG(r)):null}function RG(r){if(!r)return null;const t=r.filter(wG);return 0==t.length?null:function(e){return function vhe(...r){const t=gG(r),{args:e,keys:n}=hG(r),i=new ri(o=>{const{length:s}=e;if(!s)return void o.complete();const a=new Array(s);let c=s,l=s;for(let u=0;u<s;u++){let f=!1;_c(e[u]).subscribe(gi(o,g=>{f||(f=!0,l--),a[u]=g},()=>c--,void 0,()=>{(!c||!f)&&(l||o.next(n?mG(n,a):a),o.complete())}))}});return t?i.pipe(pG(t)):i}(NG(e,t).map(bG)).pipe(jn(AG))}}function WP(r){return null!=r?RG(IG(r)):null}function xG(r,t){return null===r?[t]:Array.isArray(r)?[...r,t]:[r,t]}function LG(r){return r._rawValidators}function zG(r){return r._rawAsyncValidators}function qP(r){return r?Array.isArray(r)?r:[r]:[]}function yp(r,t){return Array.isArray(r)?r.includes(t):r===t}function DG(r,t){const e=qP(t);return qP(r).forEach(i=>{yp(e,i)||e.push(i)}),e}function VG(r,t){return qP(t).filter(e=>!yp(r,e))}class HG{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(t){this._rawValidators=t||[],this._composedValidatorFn=$P(this._rawValidators)}_setAsyncValidators(t){this._rawAsyncValidators=t||[],this._composedAsyncValidatorFn=WP(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(t){this._onDestroyCallbacks.push(t)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(t=>t()),this._onDestroyCallbacks=[]}reset(t=void 0){this.control&&this.control.reset(t)}hasError(t,e){return!!this.control&&this.control.hasError(t,e)}getError(t,e){return this.control?this.control.getError(t,e):null}}class so extends HG{get formDirective(){return null}get path(){return null}}class V4 extends HG{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class FG{constructor(t){this._cd=t}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let vc=(()=>{class r extends FG{constructor(e){super(e)}static#e=this.\u0275fac=function(n){return new(n||r)(G(V4,2))};static#t=this.\u0275dir=Vt({type:r,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(n,i){2&n&&xg("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)},features:[$e]})}return r})(),H4=(()=>{class r extends FG{constructor(e){super(e)}static#e=this.\u0275fac=function(n){return new(n||r)(G(so,10))};static#t=this.\u0275dir=Vt({type:r,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(n,i){2&n&&xg("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)("ng-submitted",i.isSubmitted)},features:[$e]})}return r})();const K7="VALID",Ep="INVALID",A8="PENDING",X7="DISABLED";function YP(r){return(Pp(r)?r.validators:r)||null}function KP(r,t){return(Pp(t)?t.asyncValidators:r)||null}function Pp(r){return null!=r&&!Array.isArray(r)&&"object"==typeof r}function GG(r,t,e){const n=r.controls;if(!(t?Object.keys(n):n).length)throw new de(1e3,"");if(!n[e])throw new de(1001,"")}function BG(r,t,e){r._forEachChild((n,i)=>{if(void 0===e[i])throw new de(1002,"")})}class Sp{constructor(t,e){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(t),this._assignAsyncValidators(e)}get validator(){return this._composedValidatorFn}set validator(t){this._rawValidators=this._composedValidatorFn=t}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(t){this._rawAsyncValidators=this._composedAsyncValidatorFn=t}get parent(){return this._parent}get valid(){return this.status===K7}get invalid(){return this.status===Ep}get pending(){return this.status==A8}get disabled(){return this.status===X7}get enabled(){return this.status!==X7}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(t){this._assignValidators(t)}setAsyncValidators(t){this._assignAsyncValidators(t)}addValidators(t){this.setValidators(DG(t,this._rawValidators))}addAsyncValidators(t){this.setAsyncValidators(DG(t,this._rawAsyncValidators))}removeValidators(t){this.setValidators(VG(t,this._rawValidators))}removeAsyncValidators(t){this.setAsyncValidators(VG(t,this._rawAsyncValidators))}hasValidator(t){return yp(this._rawValidators,t)}hasAsyncValidator(t){return yp(this._rawAsyncValidators,t)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(t={}){this.touched=!0,this._parent&&!t.onlySelf&&this._parent.markAsTouched(t)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(t=>t.markAllAsTouched())}markAsUntouched(t={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(e=>{e.markAsUntouched({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}markAsDirty(t={}){this.pristine=!1,this._parent&&!t.onlySelf&&this._parent.markAsDirty(t)}markAsPristine(t={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(e=>{e.markAsPristine({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}markAsPending(t={}){this.status=A8,!1!==t.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!t.onlySelf&&this._parent.markAsPending(t)}disable(t={}){const e=this._parentMarkedDirty(t.onlySelf);this.status=X7,this.errors=null,this._forEachChild(n=>{n.disable({...t,onlySelf:!0})}),this._updateValue(),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...t,skipPristineCheck:e}),this._onDisabledChange.forEach(n=>n(!0))}enable(t={}){const e=this._parentMarkedDirty(t.onlySelf);this.status=K7,this._forEachChild(n=>{n.enable({...t,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent}),this._updateAncestors({...t,skipPristineCheck:e}),this._onDisabledChange.forEach(n=>n(!1))}_updateAncestors(t){this._parent&&!t.onlySelf&&(this._parent.updateValueAndValidity(t),t.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(t){this._parent=t}getRawValue(){return this.value}updateValueAndValidity(t={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===K7||this.status===A8)&&this._runAsyncValidator(t.emitEvent)),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!t.onlySelf&&this._parent.updateValueAndValidity(t)}_updateTreeValidity(t={emitEvent:!0}){this._forEachChild(e=>e._updateTreeValidity(t)),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?X7:K7}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(t){if(this.asyncValidator){this.status=A8,this._hasOwnPendingAsyncValidator=!0;const e=bG(this.asyncValidator(this));this._asyncValidationSubscription=e.subscribe(n=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(n,{emitEvent:t})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(t,e={}){this.errors=t,this._updateControlsErrors(!1!==e.emitEvent)}get(t){let e=t;return null==e||(Array.isArray(e)||(e=e.split(".")),0===e.length)?null:e.reduce((n,i)=>n&&n._find(i),this)}getError(t,e){const n=e?this.get(e):this;return n&&n.errors?n.errors[t]:null}hasError(t,e){return!!this.getError(t,e)}get root(){let t=this;for(;t._parent;)t=t._parent;return t}_updateControlsErrors(t){this.status=this._calculateStatus(),t&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(t)}_initObservables(){this.valueChanges=new i1,this.statusChanges=new i1}_calculateStatus(){return this._allControlsDisabled()?X7:this.errors?Ep:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(A8)?A8:this._anyControlsHaveStatus(Ep)?Ep:K7}_anyControlsHaveStatus(t){return this._anyControls(e=>e.status===t)}_anyControlsDirty(){return this._anyControls(t=>t.dirty)}_anyControlsTouched(){return this._anyControls(t=>t.touched)}_updatePristine(t={}){this.pristine=!this._anyControlsDirty(),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}_updateTouched(t={}){this.touched=this._anyControlsTouched(),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}_registerOnCollectionChange(t){this._onCollectionChange=t}_setUpdateStrategy(t){Pp(t)&&null!=t.updateOn&&(this._updateOn=t.updateOn)}_parentMarkedDirty(t){return!t&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(t){return null}_assignValidators(t){this._rawValidators=Array.isArray(t)?t.slice():t,this._composedValidatorFn=function Ahe(r){return Array.isArray(r)?$P(r):r||null}(this._rawValidators)}_assignAsyncValidators(t){this._rawAsyncValidators=Array.isArray(t)?t.slice():t,this._composedAsyncValidatorFn=function Nhe(r){return Array.isArray(r)?WP(r):r||null}(this._rawAsyncValidators)}}class yc extends Sp{constructor(t,e,n){super(YP(e),KP(n,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(t,e){return this.controls[t]?this.controls[t]:(this.controls[t]=e,e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange),e)}addControl(t,e,n={}){this.registerControl(t,e),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}removeControl(t,e={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}setControl(t,e,n={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],e&&this.registerControl(t,e),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}contains(t){return this.controls.hasOwnProperty(t)&&this.controls[t].enabled}setValue(t,e={}){BG(this,0,t),Object.keys(t).forEach(n=>{GG(this,!0,n),this.controls[n].setValue(t[n],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){null!=t&&(Object.keys(t).forEach(n=>{const i=this.controls[n];i&&i.patchValue(t[n],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(t={},e={}){this._forEachChild((n,i)=>{n.reset(t?t[i]:null,{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this._reduceChildren({},(t,e,n)=>(t[n]=e.getRawValue(),t))}_syncPendingControls(){let t=this._reduceChildren(!1,(e,n)=>!!n._syncPendingControls()||e);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_forEachChild(t){Object.keys(this.controls).forEach(e=>{const n=this.controls[e];n&&t(n,e)})}_setUpControls(){this._forEachChild(t=>{t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(t){for(const[e,n]of Object.entries(this.controls))if(this.contains(e)&&t(n))return!0;return!1}_reduceValue(){return this._reduceChildren({},(e,n,i)=>((n.enabled||this.disabled)&&(e[i]=n.value),e))}_reduceChildren(t,e){let n=t;return this._forEachChild((i,o)=>{n=e(n,i,o)}),n}_allControlsDisabled(){for(const t of Object.keys(this.controls))if(this.controls[t].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(t){return this.controls.hasOwnProperty(t)?this.controls[t]:null}}class $G extends yc{}const l6=new tt("CallSetDisabledState",{providedIn:"root",factory:()=>Q7}),Q7="always";function Op(r,t){return[...t.path,r]}function J7(r,t,e=Q7){XP(r,t),t.valueAccessor.writeValue(r.value),(r.disabled||"always"===e)&&t.valueAccessor.setDisabledState?.(r.disabled),function khe(r,t){t.valueAccessor.registerOnChange(e=>{r._pendingValue=e,r._pendingChange=!0,r._pendingDirty=!0,"change"===r.updateOn&&WG(r,t)})}(r,t),function xhe(r,t){const e=(n,i)=>{t.valueAccessor.writeValue(n),i&&t.viewToModelUpdate(n)};r.registerOnChange(e),t._registerOnDestroy(()=>{r._unregisterOnChange(e)})}(r,t),function Rhe(r,t){t.valueAccessor.registerOnTouched(()=>{r._pendingTouched=!0,"blur"===r.updateOn&&r._pendingChange&&WG(r,t),"submit"!==r.updateOn&&r.markAsTouched()})}(r,t),function Ihe(r,t){if(t.valueAccessor.setDisabledState){const e=n=>{t.valueAccessor.setDisabledState(n)};r.registerOnDisabledChange(e),t._registerOnDestroy(()=>{r._unregisterOnDisabledChange(e)})}}(r,t)}function Tp(r,t,e=!0){const n=()=>{};t.valueAccessor&&(t.valueAccessor.registerOnChange(n),t.valueAccessor.registerOnTouched(n)),bp(r,t),r&&(t._invokeOnDestroyCallbacks(),r._registerOnCollectionChange(()=>{}))}function wp(r,t){r.forEach(e=>{e.registerOnValidatorChange&&e.registerOnValidatorChange(t)})}function XP(r,t){const e=LG(r);null!==t.validator?r.setValidators(xG(e,t.validator)):"function"==typeof e&&r.setValidators([e]);const n=zG(r);null!==t.asyncValidator?r.setAsyncValidators(xG(n,t.asyncValidator)):"function"==typeof n&&r.setAsyncValidators([n]);const i=()=>r.updateValueAndValidity();wp(t._rawValidators,i),wp(t._rawAsyncValidators,i)}function bp(r,t){let e=!1;if(null!==r){if(null!==t.validator){const i=LG(r);if(Array.isArray(i)&&i.length>0){const o=i.filter(s=>s!==t.validator);o.length!==i.length&&(e=!0,r.setValidators(o))}}if(null!==t.asyncValidator){const i=zG(r);if(Array.isArray(i)&&i.length>0){const o=i.filter(s=>s!==t.asyncValidator);o.length!==i.length&&(e=!0,r.setAsyncValidators(o))}}}const n=()=>{};return wp(t._rawValidators,n),wp(t._rawAsyncValidators,n),e}function WG(r,t){r._pendingDirty&&r.markAsDirty(),r.setValue(r._pendingValue,{emitModelToViewChange:!1}),t.viewToModelUpdate(r._pendingValue),r._pendingChange=!1}function qG(r,t){XP(r,t)}function JP(r,t){if(!r.hasOwnProperty("model"))return!1;const e=r.model;return!!e.isFirstChange()||!Object.is(t,e.currentValue)}function jG(r,t){r._syncPendingControls(),t.forEach(e=>{const n=e.control;"submit"===n.updateOn&&n._pendingChange&&(e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1)})}function eS(r,t){if(!t)return null;let e,n,i;return Array.isArray(t),t.forEach(o=>{o.constructor===Na?e=o:function Dhe(r){return Object.getPrototypeOf(r.constructor)===c6}(o)?n=o:i=o}),i||n||e||null}const Hhe={provide:so,useExisting:L1(()=>tf)},ef=Promise.resolve();let tf=(()=>{class r extends so{constructor(e,n,i){super(),this.callSetDisabledState=i,this.submitted=!1,this._directives=new Set,this.ngSubmit=new i1,this.form=new yc({},$P(e),WP(n))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(e){ef.then(()=>{const n=this._findContainer(e.path);e.control=n.registerControl(e.name,e.control),J7(e.control,e,this.callSetDisabledState),e.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(e)})}getControl(e){return this.form.get(e.path)}removeControl(e){ef.then(()=>{const n=this._findContainer(e.path);n&&n.removeControl(e.name),this._directives.delete(e)})}addFormGroup(e){ef.then(()=>{const n=this._findContainer(e.path),i=new yc({});qG(i,e),n.registerControl(e.name,i),i.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(e){ef.then(()=>{const n=this._findContainer(e.path);n&&n.removeControl(e.name)})}getFormGroup(e){return this.form.get(e.path)}updateModel(e,n){ef.then(()=>{this.form.get(e.path).setValue(n)})}setValue(e){this.control.setValue(e)}onSubmit(e){return this.submitted=!0,jG(this.form,this._directives),this.ngSubmit.emit(e),"dialog"===e?.target?.method}onReset(){this.resetForm()}resetForm(e=void 0){this.form.reset(e),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(e){return e.pop(),e.length?this.form.get(e):this.form}static#e=this.\u0275fac=function(n){return new(n||r)(G(x2,10),G(D4,10),G(l6,8))};static#t=this.\u0275dir=Vt({type:r,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(n,i){1&n&&q("submit",function(s){return i.onSubmit(s)})("reset",function(){return i.onReset()})},inputs:{options:[Z1.None,"ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[ur([Hhe]),$e]})}return r})();function ZG(r,t){const e=r.indexOf(t);e>-1&&r.splice(e,1)}function YG(r){return"object"==typeof r&&null!==r&&2===Object.keys(r).length&&"value"in r&&"disabled"in r}const ko=class extends Sp{constructor(t=null,e,n){super(YP(e),KP(n,e)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(t),this._setUpdateStrategy(e),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),Pp(e)&&(e.nonNullable||e.initialValueIsDefault)&&(this.defaultValue=YG(t)?t.value:t)}setValue(t,e={}){this.value=this._pendingValue=t,this._onChange.length&&!1!==e.emitModelToViewChange&&this._onChange.forEach(n=>n(this.value,!1!==e.emitViewToModelChange)),this.updateValueAndValidity(e)}patchValue(t,e={}){this.setValue(t,e)}reset(t=this.defaultValue,e={}){this._applyFormState(t),this.markAsPristine(e),this.markAsUntouched(e),this.setValue(this.value,e),this._pendingChange=!1}_updateValue(){}_anyControls(t){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(t){this._onChange.push(t)}_unregisterOnChange(t){ZG(this._onChange,t)}registerOnDisabledChange(t){this._onDisabledChange.push(t)}_unregisterOnDisabledChange(t){ZG(this._onDisabledChange,t)}_forEachChild(t){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(t){YG(t)?(this.value=this._pendingValue=t.value,t.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=t}},Ghe={provide:V4,useExisting:L1(()=>nf)},QG=Promise.resolve();let nf=(()=>{class r extends V4{constructor(e,n,i,o,s,a){super(),this._changeDetectorRef=s,this.callSetDisabledState=a,this.control=new ko,this._registered=!1,this.name="",this.update=new i1,this._parent=e,this._setValidators(n),this._setAsyncValidators(i),this.valueAccessor=eS(0,o)}ngOnChanges(e){if(this._checkForErrors(),!this._registered||"name"in e){if(this._registered&&(this._checkName(),this.formDirective)){const n=e.name.previousValue;this.formDirective.removeControl({name:n,path:this._getPath(n)})}this._setUpControl()}"isDisabled"in e&&this._updateDisabled(e),JP(e,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){J7(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(e){QG.then(()=>{this.control.setValue(e,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(e){const n=e.isDisabled.currentValue,i=0!==n&&w8(n);QG.then(()=>{i&&!this.control.disabled?this.control.disable():!i&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(e){return this._parent?Op(e,this._parent):[e]}static#e=this.\u0275fac=function(n){return new(n||r)(G(so,9),G(x2,10),G(D4,10),G(Cc,10),G(Vs,8),G(l6,8))};static#t=this.\u0275dir=Vt({type:r,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[Z1.None,"disabled","isDisabled"],model:[Z1.None,"ngModel","model"],options:[Z1.None,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[ur([Ghe]),$e,n2]})}return r})(),F4=(()=>{class r{static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275dir=Vt({type:r,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]})}return r})();const Bhe={provide:Cc,useExisting:L1(()=>tS),multi:!0};let tS=(()=>{class r extends c6{writeValue(e){this.setProperty("value",e??"")}registerOnChange(e){this.onChange=n=>{e(""==n?null:parseFloat(n))}}static#e=this.\u0275fac=(()=>{let e;return function(i){return(e||(e=z1(r)))(i||r)}})();static#t=this.\u0275dir=Vt({type:r,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(n,i){1&n&&q("input",function(s){return i.onChange(s.target.value)})("blur",function(){return i.onTouched()})},features:[ur([Bhe]),$e]})}return r})();const qhe={provide:Cc,useExisting:L1(()=>Ap),multi:!0};let Ap=(()=>{class r extends c6{writeValue(e){this.setProperty("value",parseFloat(e))}registerOnChange(e){this.onChange=n=>{e(""==n?null:parseFloat(n))}}static#e=this.\u0275fac=(()=>{let e;return function(i){return(e||(e=z1(r)))(i||r)}})();static#t=this.\u0275dir=Vt({type:r,selectors:[["input","type","range","formControlName",""],["input","type","range","formControl",""],["input","type","range","ngModel",""]],hostBindings:function(n,i){1&n&&q("change",function(s){return i.onChange(s.target.value)})("input",function(s){return i.onChange(s.target.value)})("blur",function(){return i.onTouched()})},features:[ur([qhe]),$e]})}return r})();const nS=new tt(""),jhe={provide:V4,useExisting:L1(()=>rS)};let rS=(()=>{class r extends V4{set isDisabled(e){}static#e=this._ngModelWarningSentOnce=!1;constructor(e,n,i,o,s){super(),this._ngModelWarningConfig=o,this.callSetDisabledState=s,this.update=new i1,this._ngModelWarningSent=!1,this._setValidators(e),this._setAsyncValidators(n),this.valueAccessor=eS(0,i)}ngOnChanges(e){if(this._isControlChanged(e)){const n=e.form.previousValue;n&&Tp(n,this,!1),J7(this.form,this,this.callSetDisabledState),this.form.updateValueAndValidity({emitEvent:!1})}JP(e,this.viewModel)&&(this.form.setValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.form&&Tp(this.form,this,!1)}get path(){return[]}get control(){return this.form}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}_isControlChanged(e){return e.hasOwnProperty("form")}static#t=this.\u0275fac=function(n){return new(n||r)(G(x2,10),G(D4,10),G(Cc,10),G(nS,8),G(l6,8))};static#n=this.\u0275dir=Vt({type:r,selectors:[["","formControl",""]],inputs:{form:[Z1.None,"formControl","form"],isDisabled:[Z1.None,"disabled","isDisabled"],model:[Z1.None,"ngModel","model"]},outputs:{update:"ngModelChange"},exportAs:["ngForm"],features:[ur([jhe]),$e,n2]})}return r})();const Zhe={provide:so,useExisting:L1(()=>U4)};let U4=(()=>{class r extends so{constructor(e,n,i){super(),this.callSetDisabledState=i,this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new i1,this._setValidators(e),this._setAsyncValidators(n)}ngOnChanges(e){this._checkFormPresent(),e.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(bp(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(e){const n=this.form.get(e.path);return J7(n,e,this.callSetDisabledState),n.updateValueAndValidity({emitEvent:!1}),this.directives.push(e),n}getControl(e){return this.form.get(e.path)}removeControl(e){Tp(e.control||null,e,!1),function Vhe(r,t){const e=r.indexOf(t);e>-1&&r.splice(e,1)}(this.directives,e)}addFormGroup(e){this._setUpFormContainer(e)}removeFormGroup(e){this._cleanUpFormContainer(e)}getFormGroup(e){return this.form.get(e.path)}addFormArray(e){this._setUpFormContainer(e)}removeFormArray(e){this._cleanUpFormContainer(e)}getFormArray(e){return this.form.get(e.path)}updateModel(e,n){this.form.get(e.path).setValue(n)}onSubmit(e){return this.submitted=!0,jG(this.form,this.directives),this.ngSubmit.emit(e),"dialog"===e?.target?.method}onReset(){this.resetForm()}resetForm(e=void 0){this.form.reset(e),this.submitted=!1}_updateDomValue(){this.directives.forEach(e=>{const n=e.control,i=this.form.get(e.path);n!==i&&(Tp(n||null,e),(r=>r instanceof ko)(i)&&(J7(i,e,this.callSetDisabledState),e.control=i))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(e){const n=this.form.get(e.path);qG(n,e),n.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(e){if(this.form){const n=this.form.get(e.path);n&&function Lhe(r,t){return bp(r,t)}(n,e)&&n.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){XP(this.form,this),this._oldForm&&bp(this._oldForm,this)}_checkFormPresent(){}static#e=this.\u0275fac=function(n){return new(n||r)(G(x2,10),G(D4,10),G(l6,8))};static#t=this.\u0275dir=Vt({type:r,selectors:[["","formGroup",""]],hostBindings:function(n,i){1&n&&q("submit",function(s){return i.onSubmit(s)})("reset",function(){return i.onReset()})},inputs:{form:[Z1.None,"formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[ur([Zhe]),$e,n2]})}return r})();const Xhe={provide:V4,useExisting:L1(()=>u6)};let u6=(()=>{class r extends V4{set isDisabled(e){}static#e=this._ngModelWarningSentOnce=!1;constructor(e,n,i,o,s){super(),this._ngModelWarningConfig=s,this._added=!1,this.name=null,this.update=new i1,this._ngModelWarningSent=!1,this._parent=e,this._setValidators(n),this._setAsyncValidators(i),this.valueAccessor=eS(0,o)}ngOnChanges(e){this._added||this._setUpControl(),JP(e,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}get path(){return Op(null==this.name?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this._added=!0}static#t=this.\u0275fac=function(n){return new(n||r)(G(so,13),G(x2,10),G(D4,10),G(Cc,10),G(nS,8))};static#n=this.\u0275dir=Vt({type:r,selectors:[["","formControlName",""]],inputs:{name:[Z1.None,"formControlName","name"],isDisabled:[Z1.None,"disabled","isDisabled"],model:[Z1.None,"ngModel","model"]},outputs:{update:"ngModelChange"},features:[ur([Xhe]),$e,n2]})}return r})();const Qhe={provide:Cc,useExisting:L1(()=>Np),multi:!0};function tB(r,t){return null==r?`${t}`:(t&&"object"==typeof t&&(t="Object"),`${r}: ${t}`.slice(0,50))}let Np=(()=>{class r extends c6{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(e){this._compareWith=e}writeValue(e){this.value=e;const i=tB(this._getOptionId(e),e);this.setProperty("value",i)}registerOnChange(e){this.onChange=n=>{this.value=this._getOptionValue(n),e(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(e){for(const n of this._optionMap.keys())if(this._compareWith(this._optionMap.get(n),e))return n;return null}_getOptionValue(e){const n=function Jhe(r){return r.split(":")[0]}(e);return this._optionMap.has(n)?this._optionMap.get(n):e}static#e=this.\u0275fac=(()=>{let e;return function(i){return(e||(e=z1(r)))(i||r)}})();static#t=this.\u0275dir=Vt({type:r,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(n,i){1&n&&q("change",function(s){return i.onChange(s.target.value)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},features:[ur([Qhe]),$e]})}return r})(),N8=(()=>{class r{constructor(e,n,i){this._element=e,this._renderer=n,this._select=i,this._select&&(this.id=this._select._registerOption())}set ngValue(e){null!=this._select&&(this._select._optionMap.set(this.id,e),this._setElementValue(tB(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._setElementValue(e),this._select&&this._select.writeValue(this._select.value)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static#e=this.\u0275fac=function(n){return new(n||r)(G(I2),G(lc),G(Np,9))};static#t=this.\u0275dir=Vt({type:r,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}})}return r})();const ege={provide:Cc,useExisting:L1(()=>sS),multi:!0};function nB(r,t){return null==r?`${t}`:("string"==typeof t&&(t=`'${t}'`),t&&"object"==typeof t&&(t="Object"),`${r}: ${t}`.slice(0,50))}let sS=(()=>{class r extends c6{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(e){this._compareWith=e}writeValue(e){let n;if(this.value=e,Array.isArray(e)){const i=e.map(o=>this._getOptionId(o));n=(o,s)=>{o._setSelected(i.indexOf(s.toString())>-1)}}else n=(i,o)=>{i._setSelected(!1)};this._optionMap.forEach(n)}registerOnChange(e){this.onChange=n=>{const i=[],o=n.selectedOptions;if(void 0!==o){const s=o;for(let a=0;a<s.length;a++){const l=this._getOptionValue(s[a].value);i.push(l)}}else{const s=n.options;for(let a=0;a<s.length;a++){const c=s[a];if(c.selected){const l=this._getOptionValue(c.value);i.push(l)}}}this.value=i,e(i)}}_registerOption(e){const n=(this._idCounter++).toString();return this._optionMap.set(n,e),n}_getOptionId(e){for(const n of this._optionMap.keys())if(this._compareWith(this._optionMap.get(n)._value,e))return n;return null}_getOptionValue(e){const n=function tge(r){return r.split(":")[0]}(e);return this._optionMap.has(n)?this._optionMap.get(n)._value:e}static#e=this.\u0275fac=(()=>{let e;return function(i){return(e||(e=z1(r)))(i||r)}})();static#t=this.\u0275dir=Vt({type:r,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(n,i){1&n&&q("change",function(s){return i.onChange(s.target)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},features:[ur([ege]),$e]})}return r})(),I8=(()=>{class r{constructor(e,n,i){this._element=e,this._renderer=n,this._select=i,this._select&&(this.id=this._select._registerOption(this))}set ngValue(e){null!=this._select&&(this._value=e,this._setElementValue(nB(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._select?(this._value=e,this._setElementValue(nB(this.id,e)),this._select.writeValue(this._select.value)):this._setElementValue(e)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}_setSelected(e){this._renderer.setProperty(this._element.nativeElement,"selected",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static#e=this.\u0275fac=function(n){return new(n||r)(G(I2),G(lc),G(sS,9))};static#t=this.\u0275dir=Vt({type:r,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}})}return r})();let f6=(()=>{class r{constructor(){this._validator=vp}ngOnChanges(e){if(this.inputName in e){const n=this.normalizeInput(e[this.inputName].currentValue);this._enabled=this.enabled(n),this._validator=this._enabled?this.createValidator(n):vp,this._onChange&&this._onChange()}}validate(e){return this._validator(e)}registerOnValidatorChange(e){this._onChange=e}enabled(e){return null!=e}static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275dir=Vt({type:r,features:[n2]})}return r})();const ige={provide:x2,useExisting:L1(()=>G4),multi:!0},oge={provide:x2,useExisting:L1(()=>aS),multi:!0};let G4=(()=>{class r extends f6{constructor(){super(...arguments),this.inputName="required",this.normalizeInput=w8,this.createValidator=e=>MG}enabled(e){return e}static#e=this.\u0275fac=(()=>{let e;return function(i){return(e||(e=z1(r)))(i||r)}})();static#t=this.\u0275dir=Vt({type:r,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(n,i){2&n&&A("required",i._enabled?"":null)},inputs:{required:"required"},features:[ur([ige]),$e]})}return r})(),aS=(()=>{class r extends G4{constructor(){super(...arguments),this.createValidator=e=>EG}static#e=this.\u0275fac=(()=>{let e;return function(i){return(e||(e=z1(r)))(i||r)}})();static#t=this.\u0275dir=Vt({type:r,selectors:[["input","type","checkbox","required","","formControlName",""],["input","type","checkbox","required","","formControl",""],["input","type","checkbox","required","","ngModel",""]],hostVars:1,hostBindings:function(n,i){2&n&&A("required",i._enabled?"":null)},features:[ur([oge]),$e]})}return r})();const cge={provide:x2,useExisting:L1(()=>cS),multi:!0};let cS=(()=>{class r extends f6{constructor(){super(...arguments),this.inputName="maxlength",this.normalizeInput=e=>function rB(r){return"number"==typeof r?r:parseInt(r,10)}(e),this.createValidator=e=>OG(e)}static#e=this.\u0275fac=(()=>{let e;return function(i){return(e||(e=z1(r)))(i||r)}})();static#t=this.\u0275dir=Vt({type:r,selectors:[["","maxlength","","formControlName",""],["","maxlength","","formControl",""],["","maxlength","","ngModel",""]],hostVars:1,hostBindings:function(n,i){2&n&&A("maxlength",i._enabled?i.maxlength:null)},inputs:{maxlength:"maxlength"},features:[ur([cge]),$e]})}return r})(),uB=(()=>{class r{static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275mod=Ls({type:r});static#n=this.\u0275inj=ns({})}return r})();class fB extends Sp{constructor(t,e,n){super(YP(e),KP(n,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(t){return this.controls[this._adjustIndex(t)]}push(t,e={}){this.controls.push(t),this._registerControl(t),this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}insert(t,e,n={}){this.controls.splice(t,0,e),this._registerControl(e),this.updateValueAndValidity({emitEvent:n.emitEvent})}removeAt(t,e={}){let n=this._adjustIndex(t);n<0&&(n=0),this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),this.controls.splice(n,1),this.updateValueAndValidity({emitEvent:e.emitEvent})}setControl(t,e,n={}){let i=this._adjustIndex(t);i<0&&(i=0),this.controls[i]&&this.controls[i]._registerOnCollectionChange(()=>{}),this.controls.splice(i,1),e&&(this.controls.splice(i,0,e),this._registerControl(e)),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(t,e={}){BG(this,0,t),t.forEach((n,i)=>{GG(this,!1,i),this.at(i).setValue(n,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){null!=t&&(t.forEach((n,i)=>{this.at(i)&&this.at(i).patchValue(n,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(t=[],e={}){this._forEachChild((n,i)=>{n.reset(t[i],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this.controls.map(t=>t.getRawValue())}clear(t={}){this.controls.length<1||(this._forEachChild(e=>e._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:t.emitEvent}))}_adjustIndex(t){return t<0?t+this.length:t}_syncPendingControls(){let t=this.controls.reduce((e,n)=>!!n._syncPendingControls()||e,!1);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_forEachChild(t){this.controls.forEach((e,n)=>{t(e,n)})}_updateValue(){this.value=this.controls.filter(t=>t.enabled||this.disabled).map(t=>t.value)}_anyControls(t){return this.controls.some(e=>e.enabled&&t(e))}_setUpControls(){this._forEachChild(t=>this._registerControl(t))}_allControlsDisabled(){for(const t of this.controls)if(t.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(t){t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)}_find(t){return this.at(t)??null}}function dB(r){return!!r&&(void 0!==r.asyncValidators||void 0!==r.validators||void 0!==r.updateOn)}let uge=(()=>{class r{constructor(){this.useNonNullable=!1}get nonNullable(){const e=new r;return e.useNonNullable=!0,e}group(e,n=null){const i=this._reduceControls(e);let o={};return dB(n)?o=n:null!==n&&(o.validators=n.validator,o.asyncValidators=n.asyncValidator),new yc(i,o)}record(e,n=null){const i=this._reduceControls(e);return new $G(i,n)}control(e,n,i){let o={};return this.useNonNullable?(dB(n)?o=n:(o.validators=n,o.asyncValidators=i),new ko(e,{...o,nonNullable:!0})):new ko(e,n,i)}array(e,n,i){const o=e.map(s=>this._createControl(s));return new fB(o,n,i)}_reduceControls(e){const n={};return Object.keys(e).forEach(i=>{n[i]=this._createControl(e[i])}),n}_createControl(e){return e instanceof ko||e instanceof Sp?e:Array.isArray(e)?this.control(e[0],e.length>1?e[1]:null,e.length>2?e[2]:null):this.control(e)}static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275prov=xe({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})(),fge=(()=>{class r{static withConfig(e){return{ngModule:r,providers:[{provide:l6,useValue:e.callSetDisabledState??Q7}]}}static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275mod=Ls({type:r});static#n=this.\u0275inj=ns({imports:[uB]})}return r})(),dge=(()=>{class r{static withConfig(e){return{ngModule:r,providers:[{provide:nS,useValue:e.warnOnNgModelWithFormControl??"always"},{provide:l6,useValue:e.callSetDisabledState??Q7}]}}static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275mod=Ls({type:r});static#n=this.\u0275inj=ns({imports:[uB]})}return r})();function Wt(...r){return Mi(r,_p(r))}function L2(r,t,e=1/0){return Me(t)?L2((n,i)=>jn((o,s)=>t(n,o,i,s))(_c(r(n,i))),e):("number"==typeof t&&(e=t),Ji((n,i)=>function hge(r,t,e,n,i,o,s,a){const c=[];let l=0,u=0,f=!1;const g=()=>{f&&!c.length&&!l&&t.complete()},y=N=>l<n?S(N):c.push(N),S=N=>{o&&t.next(N),l++;let R=!1;_c(e(N,u++)).subscribe(gi(t,U=>{i?.(U),o?y(U):t.next(U)},()=>{R=!0},void 0,()=>{if(R)try{for(l--;c.length&&l<n;){const U=c.shift();s?b3(t,s,()=>S(U)):S(U)}g()}catch(U){t.error(U)}}))};return r.subscribe(gi(t,y,()=>{f=!0,g()})),()=>{a?.()}}(n,i,r,e)))}function k8(r,t){return Me(t)?L2(r,t,1):L2(r,1)}function A3(r,t){return Ji((e,n)=>{let i=0;e.subscribe(gi(n,o=>r.call(t,o,i++)&&n.next(o)))})}function rf(r){return Ji((t,e)=>{try{t.subscribe(e)}finally{e.add(r)}})}function Ia(r,t){return Ji((e,n)=>{let i=null,o=0,s=!1;const a=()=>s&&!i&&n.complete();e.subscribe(gi(n,c=>{i?.unsubscribe();let l=0;const u=o++;_c(r(c,u)).subscribe(i=gi(n,f=>n.next(t?t(c,f,u,l++):f),()=>{i=null,a()}))},()=>{s=!0,a()}))})}class Ip{}class kp{}class Us{constructor(t){this.normalizedNames=new Map,this.lazyUpdate=null,t?"string"==typeof t?this.lazyInit=()=>{this.headers=new Map,t.split("\n").forEach(e=>{const n=e.indexOf(":");if(n>0){const i=e.slice(0,n),o=i.toLowerCase(),s=e.slice(n+1).trim();this.maybeSetNormalizedName(i,o),this.headers.has(o)?this.headers.get(o).push(s):this.headers.set(o,[s])}})}:typeof Headers<"u"&&t instanceof Headers?(this.headers=new Map,t.forEach((e,n)=>{this.setHeaderEntries(n,e)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(t).forEach(([e,n])=>{this.setHeaderEntries(e,n)})}:this.headers=new Map}has(t){return this.init(),this.headers.has(t.toLowerCase())}get(t){this.init();const e=this.headers.get(t.toLowerCase());return e&&e.length>0?e[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(t){return this.init(),this.headers.get(t.toLowerCase())||null}append(t,e){return this.clone({name:t,value:e,op:"a"})}set(t,e){return this.clone({name:t,value:e,op:"s"})}delete(t,e){return this.clone({name:t,value:e,op:"d"})}maybeSetNormalizedName(t,e){this.normalizedNames.has(e)||this.normalizedNames.set(e,t)}init(){this.lazyInit&&(this.lazyInit instanceof Us?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(t=>this.applyUpdate(t)),this.lazyUpdate=null))}copyFrom(t){t.init(),Array.from(t.headers.keys()).forEach(e=>{this.headers.set(e,t.headers.get(e)),this.normalizedNames.set(e,t.normalizedNames.get(e))})}clone(t){const e=new Us;return e.lazyInit=this.lazyInit&&this.lazyInit instanceof Us?this.lazyInit:this,e.lazyUpdate=(this.lazyUpdate||[]).concat([t]),e}applyUpdate(t){const e=t.name.toLowerCase();switch(t.op){case"a":case"s":let n=t.value;if("string"==typeof n&&(n=[n]),0===n.length)return;this.maybeSetNormalizedName(t.name,e);const i=("a"===t.op?this.headers.get(e):void 0)||[];i.push(...n),this.headers.set(e,i);break;case"d":const o=t.value;if(o){let s=this.headers.get(e);if(!s)return;s=s.filter(a=>-1===o.indexOf(a)),0===s.length?(this.headers.delete(e),this.normalizedNames.delete(e)):this.headers.set(e,s)}else this.headers.delete(e),this.normalizedNames.delete(e)}}setHeaderEntries(t,e){const n=(Array.isArray(e)?e:[e]).map(o=>o.toString()),i=t.toLowerCase();this.headers.set(i,n),this.maybeSetNormalizedName(t,i)}forEach(t){this.init(),Array.from(this.normalizedNames.keys()).forEach(e=>t(this.normalizedNames.get(e),this.headers.get(e)))}}class gge{encodeKey(t){return hB(t)}encodeValue(t){return hB(t)}decodeKey(t){return decodeURIComponent(t)}decodeValue(t){return decodeURIComponent(t)}}const mge=/%(\d[a-f0-9])/gi,_ge={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function hB(r){return encodeURIComponent(r).replace(mge,(t,e)=>_ge[e]??t)}function Rp(r){return`${r}`}class B4{constructor(t={}){if(this.updates=null,this.cloneFrom=null,this.encoder=t.encoder||new gge,t.fromString){if(t.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function pge(r,t){const e=new Map;return r.length>0&&r.replace(/^\?/,"").split("&").forEach(i=>{const o=i.indexOf("="),[s,a]=-1==o?[t.decodeKey(i),""]:[t.decodeKey(i.slice(0,o)),t.decodeValue(i.slice(o+1))],c=e.get(s)||[];c.push(a),e.set(s,c)}),e}(t.fromString,this.encoder)}else t.fromObject?(this.map=new Map,Object.keys(t.fromObject).forEach(e=>{const n=t.fromObject[e],i=Array.isArray(n)?n.map(Rp):[Rp(n)];this.map.set(e,i)})):this.map=null}has(t){return this.init(),this.map.has(t)}get(t){this.init();const e=this.map.get(t);return e?e[0]:null}getAll(t){return this.init(),this.map.get(t)||null}keys(){return this.init(),Array.from(this.map.keys())}append(t,e){return this.clone({param:t,value:e,op:"a"})}appendAll(t){const e=[];return Object.keys(t).forEach(n=>{const i=t[n];Array.isArray(i)?i.forEach(o=>{e.push({param:n,value:o,op:"a"})}):e.push({param:n,value:i,op:"a"})}),this.clone(e)}set(t,e){return this.clone({param:t,value:e,op:"s"})}delete(t,e){return this.clone({param:t,value:e,op:"d"})}toString(){return this.init(),this.keys().map(t=>{const e=this.encoder.encodeKey(t);return this.map.get(t).map(n=>e+"="+this.encoder.encodeValue(n)).join("&")}).filter(t=>""!==t).join("&")}clone(t){const e=new B4({encoder:this.encoder});return e.cloneFrom=this.cloneFrom||this,e.updates=(this.updates||[]).concat(t),e}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(t=>this.map.set(t,this.cloneFrom.map.get(t))),this.updates.forEach(t=>{switch(t.op){case"a":case"s":const e=("a"===t.op?this.map.get(t.param):void 0)||[];e.push(Rp(t.value)),this.map.set(t.param,e);break;case"d":if(void 0===t.value){this.map.delete(t.param);break}{let n=this.map.get(t.param)||[];const i=n.indexOf(Rp(t.value));-1!==i&&n.splice(i,1),n.length>0?this.map.set(t.param,n):this.map.delete(t.param)}}}),this.cloneFrom=this.updates=null)}}class Cge{constructor(){this.map=new Map}set(t,e){return this.map.set(t,e),this}get(t){return this.map.has(t)||this.map.set(t,t.defaultValue()),this.map.get(t)}delete(t){return this.map.delete(t),this}has(t){return this.map.has(t)}keys(){return this.map.keys()}}function gB(r){return typeof ArrayBuffer<"u"&&r instanceof ArrayBuffer}function pB(r){return typeof Blob<"u"&&r instanceof Blob}function mB(r){return typeof FormData<"u"&&r instanceof FormData}class sf{constructor(t,e,n,i){let o;if(this.url=e,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=t.toUpperCase(),function vge(r){switch(r){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||i?(this.body=void 0!==n?n:null,o=i):o=n,o&&(this.reportProgress=!!o.reportProgress,this.withCredentials=!!o.withCredentials,o.responseType&&(this.responseType=o.responseType),o.headers&&(this.headers=o.headers),o.context&&(this.context=o.context),o.params&&(this.params=o.params),this.transferCache=o.transferCache),this.headers??=new Us,this.context??=new Cge,this.params){const s=this.params.toString();if(0===s.length)this.urlWithParams=e;else{const a=e.indexOf("?");this.urlWithParams=e+(-1===a?"?":a<e.length-1?"&":"")+s}}else this.params=new B4,this.urlWithParams=e}serializeBody(){return null===this.body?null:gB(this.body)||pB(this.body)||mB(this.body)||function yge(r){return typeof URLSearchParams<"u"&&r instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof B4?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||mB(this.body)?null:pB(this.body)?this.body.type||null:gB(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof B4?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(t={}){const e=t.method||this.method,n=t.url||this.url,i=t.responseType||this.responseType,o=void 0!==t.body?t.body:this.body,s=void 0!==t.withCredentials?t.withCredentials:this.withCredentials,a=void 0!==t.reportProgress?t.reportProgress:this.reportProgress;let c=t.headers||this.headers,l=t.params||this.params;const u=t.context??this.context;return void 0!==t.setHeaders&&(c=Object.keys(t.setHeaders).reduce((f,g)=>f.set(g,t.setHeaders[g]),c)),t.setParams&&(l=Object.keys(t.setParams).reduce((f,g)=>f.set(g,t.setParams[g]),l)),new sf(e,n,o,{params:l,headers:c,context:u,reportProgress:a,responseType:i,withCredentials:s})}}var $4=function(r){return r[r.Sent=0]="Sent",r[r.UploadProgress=1]="UploadProgress",r[r.ResponseHeader=2]="ResponseHeader",r[r.DownloadProgress=3]="DownloadProgress",r[r.Response=4]="Response",r[r.User=5]="User",r}($4||{});class lS{constructor(t,e=af.Ok,n="OK"){this.headers=t.headers||new Us,this.status=void 0!==t.status?t.status:e,this.statusText=t.statusText||n,this.url=t.url||null,this.ok=this.status>=200&&this.status<300}}class xp extends lS{constructor(t={}){super(t),this.type=$4.ResponseHeader}clone(t={}){return new xp({headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}class d6 extends lS{constructor(t={}){super(t),this.type=$4.Response,this.body=void 0!==t.body?t.body:null}clone(t={}){return new d6({body:void 0!==t.body?t.body:this.body,headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}class R8 extends lS{constructor(t){super(t,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${t.url||"(unknown url)"}`:`Http failure response for ${t.url||"(unknown url)"}: ${t.status} ${t.statusText}`,this.error=t.error||null}}var af=function(r){return r[r.Continue=100]="Continue",r[r.SwitchingProtocols=101]="SwitchingProtocols",r[r.Processing=102]="Processing",r[r.EarlyHints=103]="EarlyHints",r[r.Ok=200]="Ok",r[r.Created=201]="Created",r[r.Accepted=202]="Accepted",r[r.NonAuthoritativeInformation=203]="NonAuthoritativeInformation",r[r.NoContent=204]="NoContent",r[r.ResetContent=205]="ResetContent",r[r.PartialContent=206]="PartialContent",r[r.MultiStatus=207]="MultiStatus",r[r.AlreadyReported=208]="AlreadyReported",r[r.ImUsed=226]="ImUsed",r[r.MultipleChoices=300]="MultipleChoices",r[r.MovedPermanently=301]="MovedPermanently",r[r.Found=302]="Found",r[r.SeeOther=303]="SeeOther",r[r.NotModified=304]="NotModified",r[r.UseProxy=305]="UseProxy",r[r.Unused=306]="Unused",r[r.TemporaryRedirect=307]="TemporaryRedirect",r[r.PermanentRedirect=308]="PermanentRedirect",r[r.BadRequest=400]="BadRequest",r[r.Unauthorized=401]="Unauthorized",r[r.PaymentRequired=402]="PaymentRequired",r[r.Forbidden=403]="Forbidden",r[r.NotFound=404]="NotFound",r[r.MethodNotAllowed=405]="MethodNotAllowed",r[r.NotAcceptable=406]="NotAcceptable",r[r.ProxyAuthenticationRequired=407]="ProxyAuthenticationRequired",r[r.RequestTimeout=408]="RequestTimeout",r[r.Conflict=409]="Conflict",r[r.Gone=410]="Gone",r[r.LengthRequired=411]="LengthRequired",r[r.PreconditionFailed=412]="PreconditionFailed",r[r.PayloadTooLarge=413]="PayloadTooLarge",r[r.UriTooLong=414]="UriTooLong",r[r.UnsupportedMediaType=415]="UnsupportedMediaType",r[r.RangeNotSatisfiable=416]="RangeNotSatisfiable",r[r.ExpectationFailed=417]="ExpectationFailed",r[r.ImATeapot=418]="ImATeapot",r[r.MisdirectedRequest=421]="MisdirectedRequest",r[r.UnprocessableEntity=422]="UnprocessableEntity",r[r.Locked=423]="Locked",r[r.FailedDependency=424]="FailedDependency",r[r.TooEarly=425]="TooEarly",r[r.UpgradeRequired=426]="UpgradeRequired",r[r.PreconditionRequired=428]="PreconditionRequired",r[r.TooManyRequests=429]="TooManyRequests",r[r.RequestHeaderFieldsTooLarge=431]="RequestHeaderFieldsTooLarge",r[r.UnavailableForLegalReasons=451]="UnavailableForLegalReasons",r[r.InternalServerError=500]="InternalServerError",r[r.NotImplemented=501]="NotImplemented",r[r.BadGateway=502]="BadGateway",r[r.ServiceUnavailable=503]="ServiceUnavailable",r[r.GatewayTimeout=504]="GatewayTimeout",r[r.HttpVersionNotSupported=505]="HttpVersionNotSupported",r[r.VariantAlsoNegotiates=506]="VariantAlsoNegotiates",r[r.InsufficientStorage=507]="InsufficientStorage",r[r.LoopDetected=508]="LoopDetected",r[r.NotExtended=510]="NotExtended",r[r.NetworkAuthenticationRequired=511]="NetworkAuthenticationRequired",r}(af||{});function uS(r,t){return{body:t,headers:r.headers,context:r.context,observe:r.observe,params:r.params,reportProgress:r.reportProgress,responseType:r.responseType,withCredentials:r.withCredentials,transferCache:r.transferCache}}let Mge=(()=>{class r{constructor(e){this.handler=e}request(e,n,i={}){let o;if(e instanceof sf)o=e;else{let c,l;c=i.headers instanceof Us?i.headers:new Us(i.headers),i.params&&(l=i.params instanceof B4?i.params:new B4({fromObject:i.params})),o=new sf(e,n,void 0!==i.body?i.body:null,{headers:c,context:i.context,params:l,reportProgress:i.reportProgress,responseType:i.responseType||"json",withCredentials:i.withCredentials,transferCache:i.transferCache})}const s=Wt(o).pipe(k8(c=>this.handler.handle(c)));if(e instanceof sf||"events"===i.observe)return s;const a=s.pipe(A3(c=>c instanceof d6));switch(i.observe||"body"){case"body":switch(o.responseType){case"arraybuffer":return a.pipe(jn(c=>{if(null!==c.body&&!(c.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return c.body}));case"blob":return a.pipe(jn(c=>{if(null!==c.body&&!(c.body instanceof Blob))throw new Error("Response is not a Blob.");return c.body}));case"text":return a.pipe(jn(c=>{if(null!==c.body&&"string"!=typeof c.body)throw new Error("Response is not a string.");return c.body}));default:return a.pipe(jn(c=>c.body))}case"response":return a;default:throw new Error(`Unreachable: unhandled observe type ${i.observe}}`)}}delete(e,n={}){return this.request("DELETE",e,n)}get(e,n={}){return this.request("GET",e,n)}head(e,n={}){return this.request("HEAD",e,n)}jsonp(e,n){return this.request("JSONP",e,{params:(new B4).append(n,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(e,n={}){return this.request("OPTIONS",e,n)}patch(e,n,i={}){return this.request("PATCH",e,uS(i,n))}post(e,n,i={}){return this.request("POST",e,uS(i,n))}put(e,n,i={}){return this.request("PUT",e,uS(i,n))}static#e=this.\u0275fac=function(n){return new(n||r)(ze(Ip))};static#t=this.\u0275prov=xe({token:r,factory:r.\u0275fac})}return r})();function CB(r,t){return t(r)}function Tge(r,t){return(e,n)=>t.intercept(e,{handle:i=>r(i,n)})}const bge=new tt(""),cf=new tt(""),vB=new tt(""),yB=new tt("");function Age(){let r=null;return(t,e)=>{null===r&&(r=(Ne(bge,{optional:!0})??[]).reduceRight(Tge,CB));const n=Ne(w4),i=n.add();return r(t,e).pipe(rf(()=>n.remove(i)))}}let MB=(()=>{class r extends Ip{constructor(e,n){super(),this.backend=e,this.injector=n,this.chain=null,this.pendingTasks=Ne(w4);const i=Ne(yB,{optional:!0});this.backend=i??e}handle(e){if(null===this.chain){const i=Array.from(new Set([...this.injector.get(cf),...this.injector.get(vB,[])]));this.chain=i.reduceRight((o,s)=>function wge(r,t,e){return(n,i)=>E4(e,()=>t(n,o=>r(o,i)))}(o,s,this.injector),CB)}const n=this.pendingTasks.add();return this.chain(e,i=>this.backend.handle(i)).pipe(rf(()=>this.pendingTasks.remove(n)))}static#e=this.\u0275fac=function(n){return new(n||r)(ze(kp),ze(To))};static#t=this.\u0275prov=xe({token:r,factory:r.\u0275fac})}return r})();const xge=/^\)\]\}',?\n/;let PB=(()=>{class r{constructor(e){this.xhrFactory=e}handle(e){if("JSONP"===e.method)throw new de(-2800,!1);const n=this.xhrFactory;return(n.\u0275loadImpl?Mi(n.\u0275loadImpl()):Wt(null)).pipe(Ia(()=>new ri(o=>{const s=n.build();if(s.open(e.method,e.urlWithParams),e.withCredentials&&(s.withCredentials=!0),e.headers.forEach((N,R)=>s.setRequestHeader(N,R.join(","))),e.headers.has("Accept")||s.setRequestHeader("Accept","application/json, text/plain, */*"),!e.headers.has("Content-Type")){const N=e.detectContentTypeHeader();null!==N&&s.setRequestHeader("Content-Type",N)}if(e.responseType){const N=e.responseType.toLowerCase();s.responseType="json"!==N?N:"text"}const a=e.serializeBody();let c=null;const l=()=>{if(null!==c)return c;const N=s.statusText||"OK",R=new Us(s.getAllResponseHeaders()),U=function Lge(r){return"responseURL"in r&&r.responseURL?r.responseURL:/^X-Request-URL:/m.test(r.getAllResponseHeaders())?r.getResponseHeader("X-Request-URL"):null}(s)||e.url;return c=new xp({headers:R,status:s.status,statusText:N,url:U}),c},u=()=>{let{headers:N,status:R,statusText:U,url:$}=l(),re=null;R!==af.NoContent&&(re=typeof s.response>"u"?s.responseText:s.response),0===R&&(R=re?af.Ok:0);let _e=R>=200&&R<300;if("json"===e.responseType&&"string"==typeof re){const be=re;re=re.replace(xge,"");try{re=""!==re?JSON.parse(re):null}catch(Ve){re=be,_e&&(_e=!1,re={error:Ve,text:re})}}_e?(o.next(new d6({body:re,headers:N,status:R,statusText:U,url:$||void 0})),o.complete()):o.error(new R8({error:re,headers:N,status:R,statusText:U,url:$||void 0}))},f=N=>{const{url:R}=l(),U=new R8({error:N,status:s.status||0,statusText:s.statusText||"Unknown Error",url:R||void 0});o.error(U)};let g=!1;const y=N=>{g||(o.next(l()),g=!0);let R={type:$4.DownloadProgress,loaded:N.loaded};N.lengthComputable&&(R.total=N.total),"text"===e.responseType&&s.responseText&&(R.partialText=s.responseText),o.next(R)},S=N=>{let R={type:$4.UploadProgress,loaded:N.loaded};N.lengthComputable&&(R.total=N.total),o.next(R)};return s.addEventListener("load",u),s.addEventListener("error",f),s.addEventListener("timeout",f),s.addEventListener("abort",f),e.reportProgress&&(s.addEventListener("progress",y),null!==a&&s.upload&&s.upload.addEventListener("progress",S)),s.send(a),o.next({type:$4.Sent}),()=>{s.removeEventListener("error",f),s.removeEventListener("abort",f),s.removeEventListener("load",u),s.removeEventListener("timeout",f),e.reportProgress&&(s.removeEventListener("progress",y),null!==a&&s.upload&&s.upload.removeEventListener("progress",S)),s.readyState!==s.DONE&&s.abort()}})))}static#e=this.\u0275fac=function(n){return new(n||r)(ze(SU))};static#t=this.\u0275prov=xe({token:r,factory:r.\u0275fac})}return r})();const hS=new tt(""),SB=new tt("",{providedIn:"root",factory:()=>"XSRF-TOKEN"}),OB=new tt("",{providedIn:"root",factory:()=>"X-XSRF-TOKEN"});class TB{}let Vge=(()=>{class r{constructor(e,n,i){this.doc=e,this.platform=n,this.cookieName=i,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const e=this.doc.cookie||"";return e!==this.lastCookieString&&(this.parseCount++,this.lastToken=gU(e,this.cookieName),this.lastCookieString=e),this.lastToken}static#e=this.\u0275fac=function(n){return new(n||r)(ze(R2),ze(y4),ze(SB))};static#t=this.\u0275prov=xe({token:r,factory:r.\u0275fac})}return r})();function Hge(r,t){const e=r.url.toLowerCase();if(!Ne(hS)||"GET"===r.method||"HEAD"===r.method||e.startsWith("http://")||e.startsWith("https://"))return t(r);const n=Ne(TB).getToken(),i=Ne(OB);return null!=n&&!r.headers.has(i)&&(r=r.clone({headers:r.headers.set(i,n)})),t(r)}var W4=function(r){return r[r.Interceptors=0]="Interceptors",r[r.LegacyInterceptors=1]="LegacyInterceptors",r[r.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",r[r.NoXsrfProtection=3]="NoXsrfProtection",r[r.JsonpSupport=4]="JsonpSupport",r[r.RequestsMadeViaParent=5]="RequestsMadeViaParent",r[r.Fetch=6]="Fetch",r}(W4||{});function Fge(...r){const t=[Mge,PB,MB,{provide:Ip,useExisting:MB},{provide:kp,useExisting:PB},{provide:cf,useValue:Hge,multi:!0},{provide:hS,useValue:!0},{provide:TB,useClass:Vge}];for(const e of r)t.push(...e.\u0275providers);return function Rh(r){return{\u0275providers:r}}(t)}const wB=new tt("");function Uge(){return function h6(r,t){return{\u0275kind:r,\u0275providers:t}}(W4.LegacyInterceptors,[{provide:wB,useFactory:Age},{provide:cf,useExisting:wB,multi:!0}])}let Gge=(()=>{class r{static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275mod=Ls({type:r});static#n=this.\u0275inj=ns({providers:[Fge(Uge())]})}return r})();function gS(...r){const t=_p(r),e=gG(r),{args:n,keys:i}=hG(r);if(0===n.length)return Mi([],t);const o=new ri(function Yge(r,t,e=Gl){return n=>{xB(t,()=>{const{length:i}=r,o=new Array(i);let s=i,a=i;for(let c=0;c<i;c++)xB(t,()=>{const l=Mi(r[c],t);let u=!1;l.subscribe(gi(n,f=>{o[c]=f,u||(u=!0,a--),a||n.next(e(o.slice()))},()=>{--s||n.complete()}))},n)},n)}}(n,t,i?s=>mG(i,s):Gl));return e?o.pipe(pG(e)):o}function xB(r,t,e){r?b3(e,r,t):t()}const zp=De(r=>function(){r(this),this.name="EmptyError",this.message="no elements in sequence"});function lf(r=1/0){return L2(Gl,r)}function pS(...r){return function Kge(){return lf(1)}()(Mi(r,_p(r)))}function LB(r){return new ri(t=>{_c(r()).subscribe(t)})}function Dp(r,t){const e=Me(r)?r:()=>r,n=i=>i.error(e());return new ri(t?i=>t.schedule(n,0,i):n)}const N3=new ri(r=>r.complete());function mS(){return Ji((r,t)=>{let e=null;r._refCount++;const n=gi(t,void 0,void 0,void 0,()=>{if(!r||r._refCount<=0||0<--r._refCount)return void(e=null);const i=r._connection,o=e;e=null,i&&(!o||i===o)&&i.unsubscribe(),t.unsubscribe()});r.subscribe(n),n.closed||(e=r.connect())})}class zB extends ri{constructor(t,e){super(),this.source=t,this.subjectFactory=e,this._subject=null,this._refCount=0,this._connection=null,xR(t)&&(this.lift=t.lift)}_subscribe(t){return this.getSubject().subscribe(t)}getSubject(){const t=this._subject;return(!t||t.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:t}=this;this._subject=this._connection=null,t?.unsubscribe()}connect(){let t=this._connection;if(!t){t=this._connection=new cn;const e=this.getSubject();t.add(this.source.subscribe(gi(e,void 0,()=>{this._teardown(),e.complete()},n=>{this._teardown(),e.error(n)},()=>this._teardown()))),t.closed&&(this._connection=null,t=cn.EMPTY)}return t}refCount(){return mS()(this)}}function x8(r){return r<=0?()=>N3:Ji((t,e)=>{let n=0;t.subscribe(gi(e,i=>{++n<=r&&(e.next(i),r<=n&&e.complete())}))})}function Vp(r){return Ji((t,e)=>{let n=!1;t.subscribe(gi(e,i=>{n=!0,e.next(i)},()=>{n||e.next(r),e.complete()}))})}function DB(r=Jge){return Ji((t,e)=>{let n=!1;t.subscribe(gi(e,i=>{n=!0,e.next(i)},()=>n?e.complete():e.error(r())))})}function Jge(){return new zp}function g6(r,t){const e=arguments.length>=2;return n=>n.pipe(r?A3((i,o)=>r(i,o,n)):Gl,x8(1),e?Vp(t):DB(()=>new zp))}function z2(r,t,e){const n=Me(r)||t||e?{next:r,error:t,complete:e}:r;return n?Ji((i,o)=>{var s;null===(s=n.subscribe)||void 0===s||s.call(n);let a=!0;i.subscribe(gi(o,c=>{var l;null===(l=n.next)||void 0===l||l.call(n,c),o.next(c)},()=>{var c;a=!1,null===(c=n.complete)||void 0===c||c.call(n),o.complete()},c=>{var l;a=!1,null===(l=n.error)||void 0===l||l.call(n,c),o.error(c)},()=>{var c,l;a&&(null===(c=n.unsubscribe)||void 0===c||c.call(n)),null===(l=n.finalize)||void 0===l||l.call(n)}))}):Gl}function L8(r){return Ji((t,e)=>{let o,n=null,i=!1;n=t.subscribe(gi(e,void 0,void 0,s=>{o=_c(r(s,L8(r)(t))),n?(n.unsubscribe(),n=null,o.subscribe(e)):i=!0})),i&&(n.unsubscribe(),n=null,o.subscribe(e))})}function _S(r){return r<=0?()=>N3:Ji((t,e)=>{let n=[];t.subscribe(gi(e,i=>{n.push(i),r<n.length&&n.shift()},()=>{for(const i of n)e.next(i);e.complete()},void 0,()=>{n=null}))})}function z8(r){return Ji((t,e)=>{_c(r).subscribe(gi(e,()=>e.complete(),Ul)),!e.closed&&t.subscribe(e)})}const hn="primary",uf=Symbol("RouteTitle");class ipe{constructor(t){this.params=t||{}}has(t){return Object.prototype.hasOwnProperty.call(this.params,t)}get(t){if(this.has(t)){const e=this.params[t];return Array.isArray(e)?e[0]:e}return null}getAll(t){if(this.has(t)){const e=this.params[t];return Array.isArray(e)?e:[e]}return[]}get keys(){return Object.keys(this.params)}}function D8(r){return new ipe(r)}function ope(r,t,e){const n=e.path.split("/");if(n.length>r.length||"full"===e.pathMatch&&(t.hasChildren()||n.length<r.length))return null;const i={};for(let o=0;o<n.length;o++){const s=n[o],a=r[o];if(s.startsWith(":"))i[s.substring(1)]=a;else if(s!==a.path)return null}return{consumed:r.slice(0,n.length),posParams:i}}function Mc(r,t){const e=r?CS(r):void 0,n=t?CS(t):void 0;if(!e||!n||e.length!=n.length)return!1;let i;for(let o=0;o<e.length;o++)if(i=e[o],!VB(r[i],t[i]))return!1;return!0}function CS(r){return[...Object.keys(r),...Object.getOwnPropertySymbols(r)]}function VB(r,t){if(Array.isArray(r)&&Array.isArray(t)){if(r.length!==t.length)return!1;const e=[...r].sort(),n=[...t].sort();return e.every((i,o)=>n[o]===i)}return r===t}function HB(r){return r.length>0?r[r.length-1]:null}function q4(r){return function Zge(r){return!!r&&(r instanceof ri||Me(r.lift)&&Me(r.subscribe))}(r)?r:F7(r)?Mi(Promise.resolve(r)):Wt(r)}const ape={exact:function GB(r,t,e){if(!p6(r.segments,t.segments)||!Hp(r.segments,t.segments,e)||r.numberOfChildren!==t.numberOfChildren)return!1;for(const n in t.children)if(!r.children[n]||!GB(r.children[n],t.children[n],e))return!1;return!0},subset:BB},FB={exact:function cpe(r,t){return Mc(r,t)},subset:function lpe(r,t){return Object.keys(t).length<=Object.keys(r).length&&Object.keys(t).every(e=>VB(r[e],t[e]))},ignored:()=>!0};function UB(r,t,e){return ape[e.paths](r.root,t.root,e.matrixParams)&&FB[e.queryParams](r.queryParams,t.queryParams)&&!("exact"===e.fragment&&r.fragment!==t.fragment)}function BB(r,t,e){return $B(r,t,t.segments,e)}function $B(r,t,e,n){if(r.segments.length>e.length){const i=r.segments.slice(0,e.length);return!(!p6(i,e)||t.hasChildren()||!Hp(i,e,n))}if(r.segments.length===e.length){if(!p6(r.segments,e)||!Hp(r.segments,e,n))return!1;for(const i in t.children)if(!r.children[i]||!BB(r.children[i],t.children[i],n))return!1;return!0}{const i=e.slice(0,r.segments.length),o=e.slice(r.segments.length);return!!(p6(r.segments,i)&&Hp(r.segments,i,n)&&r.children[hn])&&$B(r.children[hn],t,o,n)}}function Hp(r,t,e){return t.every((n,i)=>FB[e](r[i].parameters,n.parameters))}class V8{constructor(t=new M1([],{}),e={},n=null){this.root=t,this.queryParams=e,this.fragment=n}get queryParamMap(){return this._queryParamMap??=D8(this.queryParams),this._queryParamMap}toString(){return dpe.serialize(this)}}class M1{constructor(t,e){this.segments=t,this.children=e,this.parent=null,Object.values(e).forEach(n=>n.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Fp(this)}}class ff{constructor(t,e){this.path=t,this.parameters=e}get parameterMap(){return this._parameterMap??=D8(this.parameters),this._parameterMap}toString(){return jB(this)}}function p6(r,t){return r.length===t.length&&r.every((e,n)=>e.path===t[n].path)}let H8=(()=>{class r{static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275prov=xe({token:r,factory:()=>new vS,providedIn:"root"})}return r})();class vS{parse(t){const e=new Ppe(t);return new V8(e.parseRootSegment(),e.parseQueryParams(),e.parseFragment())}serialize(t){const e=`/${df(t.root,!0)}`,n=function ppe(r){const t=Object.entries(r).map(([e,n])=>Array.isArray(n)?n.map(i=>`${Up(e)}=${Up(i)}`).join("&"):`${Up(e)}=${Up(n)}`).filter(e=>e);return t.length?`?${t.join("&")}`:""}(t.queryParams);return`${e}${n}${"string"==typeof t.fragment?`#${function hpe(r){return encodeURI(r)}(t.fragment)}`:""}`}}const dpe=new vS;function Fp(r){return r.segments.map(t=>jB(t)).join("/")}function df(r,t){if(!r.hasChildren())return Fp(r);if(t){const e=r.children[hn]?df(r.children[hn],!1):"",n=[];return Object.entries(r.children).forEach(([i,o])=>{i!==hn&&n.push(`${i}:${df(o,!1)}`)}),n.length>0?`${e}(${n.join("//")})`:e}{const e=function fpe(r,t){let e=[];return Object.entries(r.children).forEach(([n,i])=>{n===hn&&(e=e.concat(t(i,n)))}),Object.entries(r.children).forEach(([n,i])=>{n!==hn&&(e=e.concat(t(i,n)))}),e}(r,(n,i)=>i===hn?[df(r.children[hn],!1)]:[`${i}:${df(n,!1)}`]);return 1===Object.keys(r.children).length&&null!=r.children[hn]?`${Fp(r)}/${e[0]}`:`${Fp(r)}/(${e.join("//")})`}}function WB(r){return encodeURIComponent(r).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Up(r){return WB(r).replace(/%3B/gi,";")}function yS(r){return WB(r).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Gp(r){return decodeURIComponent(r)}function qB(r){return Gp(r.replace(/\+/g,"%20"))}function jB(r){return`${yS(r.path)}${function gpe(r){return Object.entries(r).map(([t,e])=>`;${yS(t)}=${yS(e)}`).join("")}(r.parameters)}`}const mpe=/^[^\/()?;#]+/;function MS(r){const t=r.match(mpe);return t?t[0]:""}const _pe=/^[^\/()?;=#]+/,vpe=/^[^=?&#]+/,Mpe=/^[^&#]+/;class Ppe{constructor(t){this.url=t,this.remaining=t}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new M1([],{}):new M1([],this.parseChildren())}parseQueryParams(){const t={};if(this.consumeOptional("?"))do{this.parseQueryParam(t)}while(this.consumeOptional("&"));return t}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const t=[];for(this.peekStartsWith("(")||t.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),t.push(this.parseSegment());let e={};this.peekStartsWith("/(")&&(this.capture("/"),e=this.parseParens(!0));let n={};return this.peekStartsWith("(")&&(n=this.parseParens(!1)),(t.length>0||Object.keys(e).length>0)&&(n[hn]=new M1(t,e)),n}parseSegment(){const t=MS(this.remaining);if(""===t&&this.peekStartsWith(";"))throw new de(4009,!1);return this.capture(t),new ff(Gp(t),this.parseMatrixParams())}parseMatrixParams(){const t={};for(;this.consumeOptional(";");)this.parseParam(t);return t}parseParam(t){const e=function Cpe(r){const t=r.match(_pe);return t?t[0]:""}(this.remaining);if(!e)return;this.capture(e);let n="";if(this.consumeOptional("=")){const i=MS(this.remaining);i&&(n=i,this.capture(n))}t[Gp(e)]=Gp(n)}parseQueryParam(t){const e=function ype(r){const t=r.match(vpe);return t?t[0]:""}(this.remaining);if(!e)return;this.capture(e);let n="";if(this.consumeOptional("=")){const s=function Epe(r){const t=r.match(Mpe);return t?t[0]:""}(this.remaining);s&&(n=s,this.capture(n))}const i=qB(e),o=qB(n);if(t.hasOwnProperty(i)){let s=t[i];Array.isArray(s)||(s=[s],t[i]=s),s.push(o)}else t[i]=o}parseParens(t){const e={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const n=MS(this.remaining),i=this.remaining[n.length];if("/"!==i&&")"!==i&&";"!==i)throw new de(4010,!1);let o;n.indexOf(":")>-1?(o=n.slice(0,n.indexOf(":")),this.capture(o),this.capture(":")):t&&(o=hn);const s=this.parseChildren();e[o]=1===Object.keys(s).length?s[hn]:new M1([],s),this.consumeOptional("//")}return e}peekStartsWith(t){return this.remaining.startsWith(t)}consumeOptional(t){return!!this.peekStartsWith(t)&&(this.remaining=this.remaining.substring(t.length),!0)}capture(t){if(!this.consumeOptional(t))throw new de(4011,!1)}}function ZB(r){return r.segments.length>0?new M1([],{[hn]:r}):r}function YB(r){const t={};for(const[n,i]of Object.entries(r.children)){const o=YB(i);if(n===hn&&0===o.segments.length&&o.hasChildren())for(const[s,a]of Object.entries(o.children))t[s]=a;else(o.segments.length>0||o.hasChildren())&&(t[n]=o)}return function Spe(r){if(1===r.numberOfChildren&&r.children[hn]){const t=r.children[hn];return new M1(r.segments.concat(t.segments),t.children)}return r}(new M1(r.segments,t))}function F8(r){return r instanceof V8}function KB(r){let t;const i=ZB(function e(o){const s={};for(const c of o.children){const l=e(c);s[c.outlet]=l}const a=new M1(o.url,s);return o===r&&(t=a),a}(r.root));return t??i}function XB(r,t,e,n){let i=r;for(;i.parent;)i=i.parent;if(0===t.length)return ES(i,i,i,e,n);const o=function Tpe(r){if("string"==typeof r[0]&&1===r.length&&"/"===r[0])return new JB(!0,0,r);let t=0,e=!1;const n=r.reduce((i,o,s)=>{if("object"==typeof o&&null!=o){if(o.outlets){const a={};return Object.entries(o.outlets).forEach(([c,l])=>{a[c]="string"==typeof l?l.split("/"):l}),[...i,{outlets:a}]}if(o.segmentPath)return[...i,o.segmentPath]}return"string"!=typeof o?[...i,o]:0===s?(o.split("/").forEach((a,c)=>{0==c&&"."===a||(0==c&&""===a?e=!0:".."===a?t++:""!=a&&i.push(a))}),i):[...i,o]},[]);return new JB(e,t,n)}(t);if(o.toRoot())return ES(i,i,new M1([],{}),e,n);const s=function wpe(r,t,e){if(r.isAbsolute)return new $p(t,!0,0);if(!e)return new $p(t,!1,NaN);if(null===e.parent)return new $p(e,!0,0);const n=Bp(r.commands[0])?0:1;return function bpe(r,t,e){let n=r,i=t,o=e;for(;o>i;){if(o-=i,n=n.parent,!n)throw new de(4005,!1);i=n.segments.length}return new $p(n,!1,i-o)}(e,e.segments.length-1+n,r.numberOfDoubleDots)}(o,i,r),a=s.processChildren?gf(s.segmentGroup,s.index,o.commands):e$(s.segmentGroup,s.index,o.commands);return ES(i,s.segmentGroup,a,e,n)}function Bp(r){return"object"==typeof r&&null!=r&&!r.outlets&&!r.segmentPath}function hf(r){return"object"==typeof r&&null!=r&&r.outlets}function ES(r,t,e,n,i){let s,o={};n&&Object.entries(n).forEach(([c,l])=>{o[c]=Array.isArray(l)?l.map(u=>`${u}`):`${l}`}),s=r===t?e:QB(r,t,e);const a=ZB(YB(s));return new V8(a,o,i)}function QB(r,t,e){const n={};return Object.entries(r.children).forEach(([i,o])=>{n[i]=o===t?e:QB(o,t,e)}),new M1(r.segments,n)}class JB{constructor(t,e,n){if(this.isAbsolute=t,this.numberOfDoubleDots=e,this.commands=n,t&&n.length>0&&Bp(n[0]))throw new de(4003,!1);const i=n.find(hf);if(i&&i!==HB(n))throw new de(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class $p{constructor(t,e,n){this.segmentGroup=t,this.processChildren=e,this.index=n}}function e$(r,t,e){if(r??=new M1([],{}),0===r.segments.length&&r.hasChildren())return gf(r,t,e);const n=function Npe(r,t,e){let n=0,i=t;const o={match:!1,pathIndex:0,commandIndex:0};for(;i<r.segments.length;){if(n>=e.length)return o;const s=r.segments[i],a=e[n];if(hf(a))break;const c=`${a}`,l=n<e.length-1?e[n+1]:null;if(i>0&&void 0===c)break;if(c&&l&&"object"==typeof l&&void 0===l.outlets){if(!n$(c,l,s))return o;n+=2}else{if(!n$(c,{},s))return o;n++}i++}return{match:!0,pathIndex:i,commandIndex:n}}(r,t,e),i=e.slice(n.commandIndex);if(n.match&&n.pathIndex<r.segments.length){const o=new M1(r.segments.slice(0,n.pathIndex),{});return o.children[hn]=new M1(r.segments.slice(n.pathIndex),r.children),gf(o,0,i)}return n.match&&0===i.length?new M1(r.segments,{}):n.match&&!r.hasChildren()?PS(r,t,e):n.match?gf(r,0,i):PS(r,t,e)}function gf(r,t,e){if(0===e.length)return new M1(r.segments,{});{const n=function Ape(r){return hf(r[0])?r[0].outlets:{[hn]:r}}(e),i={};if(Object.keys(n).some(o=>o!==hn)&&r.children[hn]&&1===r.numberOfChildren&&0===r.children[hn].segments.length){const o=gf(r.children[hn],t,e);return new M1(r.segments,o.children)}return Object.entries(n).forEach(([o,s])=>{"string"==typeof s&&(s=[s]),null!==s&&(i[o]=e$(r.children[o],t,s))}),Object.entries(r.children).forEach(([o,s])=>{void 0===n[o]&&(i[o]=s)}),new M1(r.segments,i)}}function PS(r,t,e){const n=r.segments.slice(0,t);let i=0;for(;i<e.length;){const o=e[i];if(hf(o)){const c=Ipe(o.outlets);return new M1(n,c)}if(0===i&&Bp(e[0])){n.push(new ff(r.segments[t].path,t$(e[0]))),i++;continue}const s=hf(o)?o.outlets[hn]:`${o}`,a=i<e.length-1?e[i+1]:null;s&&a&&Bp(a)?(n.push(new ff(s,t$(a))),i+=2):(n.push(new ff(s,{})),i++)}return new M1(n,{})}function Ipe(r){const t={};return Object.entries(r).forEach(([e,n])=>{"string"==typeof n&&(n=[n]),null!==n&&(t[e]=PS(new M1([],{}),0,n))}),t}function t$(r){const t={};return Object.entries(r).forEach(([e,n])=>t[e]=`${n}`),t}function n$(r,t,e){return r==e.path&&Mc(t,e.parameters)}const pf="imperative";var Gn=function(r){return r[r.NavigationStart=0]="NavigationStart",r[r.NavigationEnd=1]="NavigationEnd",r[r.NavigationCancel=2]="NavigationCancel",r[r.NavigationError=3]="NavigationError",r[r.RoutesRecognized=4]="RoutesRecognized",r[r.ResolveStart=5]="ResolveStart",r[r.ResolveEnd=6]="ResolveEnd",r[r.GuardsCheckStart=7]="GuardsCheckStart",r[r.GuardsCheckEnd=8]="GuardsCheckEnd",r[r.RouteConfigLoadStart=9]="RouteConfigLoadStart",r[r.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",r[r.ChildActivationStart=11]="ChildActivationStart",r[r.ChildActivationEnd=12]="ChildActivationEnd",r[r.ActivationStart=13]="ActivationStart",r[r.ActivationEnd=14]="ActivationEnd",r[r.Scroll=15]="Scroll",r[r.NavigationSkipped=16]="NavigationSkipped",r}(Gn||{});class Ec{constructor(t,e){this.id=t,this.url=e}}class Wp extends Ec{constructor(t,e,n="imperative",i=null){super(t,e),this.type=Gn.NavigationStart,this.navigationTrigger=n,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Pc extends Ec{constructor(t,e,n){super(t,e),this.urlAfterRedirects=n,this.type=Gn.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}var Gs=function(r){return r[r.Redirect=0]="Redirect",r[r.SupersededByNewNavigation=1]="SupersededByNewNavigation",r[r.NoDataFromResolver=2]="NoDataFromResolver",r[r.GuardRejected=3]="GuardRejected",r}(Gs||{}),qp=function(r){return r[r.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",r[r.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",r}(qp||{});class U8 extends Ec{constructor(t,e,n,i){super(t,e),this.reason=n,this.code=i,this.type=Gn.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class G8 extends Ec{constructor(t,e,n,i){super(t,e),this.reason=n,this.code=i,this.type=Gn.NavigationSkipped}}class jp extends Ec{constructor(t,e,n,i){super(t,e),this.error=n,this.target=i,this.type=Gn.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class r$ extends Ec{constructor(t,e,n,i){super(t,e),this.urlAfterRedirects=n,this.state=i,this.type=Gn.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class kpe extends Ec{constructor(t,e,n,i){super(t,e),this.urlAfterRedirects=n,this.state=i,this.type=Gn.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Rpe extends Ec{constructor(t,e,n,i,o){super(t,e),this.urlAfterRedirects=n,this.state=i,this.shouldActivate=o,this.type=Gn.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class xpe extends Ec{constructor(t,e,n,i){super(t,e),this.urlAfterRedirects=n,this.state=i,this.type=Gn.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Lpe extends Ec{constructor(t,e,n,i){super(t,e),this.urlAfterRedirects=n,this.state=i,this.type=Gn.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class zpe{constructor(t){this.route=t,this.type=Gn.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class Dpe{constructor(t){this.route=t,this.type=Gn.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class Vpe{constructor(t){this.snapshot=t,this.type=Gn.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Hpe{constructor(t){this.snapshot=t,this.type=Gn.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Fpe{constructor(t){this.snapshot=t,this.type=Gn.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Upe{constructor(t){this.snapshot=t,this.type=Gn.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class i${constructor(t,e,n){this.routerEvent=t,this.position=e,this.anchor=n,this.type=Gn.Scroll}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class SS{}class OS{constructor(t){this.url=t}}class Gpe{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new mf,this.attachRef=null}}let mf=(()=>{class r{constructor(){this.contexts=new Map}onChildOutletCreated(e,n){const i=this.getOrCreateContext(e);i.outlet=n,this.contexts.set(e,i)}onChildOutletDestroyed(e){const n=this.getContext(e);n&&(n.outlet=null,n.attachRef=null)}onOutletDeactivated(){const e=this.contexts;return this.contexts=new Map,e}onOutletReAttached(e){this.contexts=e}getOrCreateContext(e){let n=this.getContext(e);return n||(n=new Gpe,this.contexts.set(e,n)),n}getContext(e){return this.contexts.get(e)||null}static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275prov=xe({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();class o${constructor(t){this._root=t}get root(){return this._root.value}parent(t){const e=this.pathFromRoot(t);return e.length>1?e[e.length-2]:null}children(t){const e=TS(t,this._root);return e?e.children.map(n=>n.value):[]}firstChild(t){const e=TS(t,this._root);return e&&e.children.length>0?e.children[0].value:null}siblings(t){const e=wS(t,this._root);return e.length<2?[]:e[e.length-2].children.map(i=>i.value).filter(i=>i!==t)}pathFromRoot(t){return wS(t,this._root).map(e=>e.value)}}function TS(r,t){if(r===t.value)return t;for(const e of t.children){const n=TS(r,e);if(n)return n}return null}function wS(r,t){if(r===t.value)return[t];for(const e of t.children){const n=wS(r,e);if(n.length)return n.unshift(t),n}return[]}class ka{constructor(t,e){this.value=t,this.children=e}toString(){return`TreeNode(${this.value})`}}function B8(r){const t={};return r&&r.children.forEach(e=>t[e.value.outlet]=e),t}class s$ extends o${constructor(t,e){super(t),this.snapshot=e,NS(this,t)}toString(){return this.snapshot.toString()}}function a$(r){const t=function Bpe(r){const o=new AS([],{},{},"",{},hn,r,null,{});return new c$("",new ka(o,[]))}(r),e=new Xo([new ff("",{})]),n=new Xo({}),i=new Xo({}),o=new Xo({}),s=new Xo(""),a=new ao(e,n,o,s,i,hn,r,t.root);return a.snapshot=t.root,new s$(new ka(a,[]),t)}class ao{constructor(t,e,n,i,o,s,a,c){this.urlSubject=t,this.paramsSubject=e,this.queryParamsSubject=n,this.fragmentSubject=i,this.dataSubject=o,this.outlet=s,this.component=a,this._futureSnapshot=c,this.title=this.dataSubject?.pipe(jn(l=>l[uf]))??Wt(void 0),this.url=t,this.params=e,this.queryParams=n,this.fragment=i,this.data=o}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(jn(t=>D8(t))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(jn(t=>D8(t))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function bS(r,t,e="emptyOnly"){let n;const{routeConfig:i}=r;return n=null===t||"always"!==e&&""!==i?.path&&(t.component||t.routeConfig?.loadComponent)?{params:{...r.params},data:{...r.data},resolve:{...r.data,...r._resolvedData??{}}}:{params:{...t.params,...r.params},data:{...t.data,...r.data},resolve:{...r.data,...t.data,...i?.data,...r._resolvedData}},i&&u$(i)&&(n.resolve[uf]=i.title),n}class AS{get title(){return this.data?.[uf]}constructor(t,e,n,i,o,s,a,c,l){this.url=t,this.params=e,this.queryParams=n,this.fragment=i,this.data=o,this.outlet=s,this.component=a,this.routeConfig=c,this._resolve=l}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=D8(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=D8(this.queryParams),this._queryParamMap}toString(){return`Route(url:'${this.url.map(n=>n.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class c$ extends o${constructor(t,e){super(e),this.url=t,NS(this,e)}toString(){return l$(this._root)}}function NS(r,t){t.value._routerState=r,t.children.forEach(e=>NS(r,e))}function l$(r){const t=r.children.length>0?` { ${r.children.map(l$).join(", ")} } `:"";return`${r.value}${t}`}function IS(r){if(r.snapshot){const t=r.snapshot,e=r._futureSnapshot;r.snapshot=e,Mc(t.queryParams,e.queryParams)||r.queryParamsSubject.next(e.queryParams),t.fragment!==e.fragment&&r.fragmentSubject.next(e.fragment),Mc(t.params,e.params)||r.paramsSubject.next(e.params),function spe(r,t){if(r.length!==t.length)return!1;for(let e=0;e<r.length;++e)if(!Mc(r[e],t[e]))return!1;return!0}(t.url,e.url)||r.urlSubject.next(e.url),Mc(t.data,e.data)||r.dataSubject.next(e.data)}else r.snapshot=r._futureSnapshot,r.dataSubject.next(r._futureSnapshot.data)}function kS(r,t){const e=Mc(r.params,t.params)&&function upe(r,t){return p6(r,t)&&r.every((e,n)=>Mc(e.parameters,t[n].parameters))}(r.url,t.url);return e&&!(!r.parent!=!t.parent)&&(!r.parent||kS(r.parent,t.parent))}function u$(r){return"string"==typeof r.title||null===r.title}let RS=(()=>{class r{constructor(){this.activated=null,this._activatedRoute=null,this.name=hn,this.activateEvents=new i1,this.deactivateEvents=new i1,this.attachEvents=new i1,this.detachEvents=new i1,this.parentContexts=Ne(mf),this.location=Ne(os),this.changeDetector=Ne(Vs),this.environmentInjector=Ne(To),this.inputBinder=Ne(Zp,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(e){if(e.name){const{firstChange:n,previousValue:i}=e.name;if(n)return;this.isTrackedInParentContexts(i)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(i)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(e){return this.parentContexts.getContext(e)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const e=this.parentContexts.getContext(this.name);e?.route&&(e.attachRef?this.attach(e.attachRef,e.route):this.activateWith(e.route,e.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new de(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new de(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new de(4012,!1);this.location.detach();const e=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(e.instance),e}attach(e,n){this.activated=e,this._activatedRoute=n,this.location.insert(e.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(e.instance)}deactivate(){if(this.activated){const e=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(e)}}activateWith(e,n){if(this.isActivated)throw new de(4013,!1);this._activatedRoute=e;const i=this.location,s=e.snapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,c=new $pe(e,a,i.injector);this.activated=i.createComponent(s,{index:i.length,injector:c,environmentInjector:n??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275dir=Vt({type:r,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[n2]})}return r})();class $pe{constructor(t,e,n){this.route=t,this.childContexts=e,this.parent=n}get(t,e){return t===ao?this.route:t===mf?this.childContexts:this.parent.get(t,e)}}const Zp=new tt("");let f$=(()=>{class r{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(e){this.unsubscribeFromRouteData(e),this.subscribeToRouteData(e)}unsubscribeFromRouteData(e){this.outletDataSubscriptions.get(e)?.unsubscribe(),this.outletDataSubscriptions.delete(e)}subscribeToRouteData(e){const{activatedRoute:n}=e,i=gS([n.queryParams,n.params,n.data]).pipe(Ia(([o,s,a],c)=>(a={...o,...s,...a},0===c?Wt(a):Promise.resolve(a)))).subscribe(o=>{if(!e.isActivated||!e.activatedComponentRef||e.activatedRoute!==n||null===n.component)return void this.unsubscribeFromRouteData(e);const s=function ife(r){const t=_n(r);if(!t)return null;const e=new P7(t);return{get selector(){return e.selector},get type(){return e.componentType},get inputs(){return e.inputs},get outputs(){return e.outputs},get ngContentSelectors(){return e.ngContentSelectors},get isStandalone(){return t.standalone},get isSignal(){return t.signals}}}(n.component);if(s)for(const{templateName:a}of s.inputs)e.activatedComponentRef.setInput(a,o[a]);else this.unsubscribeFromRouteData(e)});this.outletDataSubscriptions.set(e,i)}static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275prov=xe({token:r,factory:r.\u0275fac})}return r})();function _f(r,t,e){if(e&&r.shouldReuseRoute(t.value,e.value.snapshot)){const n=e.value;n._futureSnapshot=t.value;const i=function qpe(r,t,e){return t.children.map(n=>{for(const i of e.children)if(r.shouldReuseRoute(n.value,i.value.snapshot))return _f(r,n,i);return _f(r,n)})}(r,t,e);return new ka(n,i)}{if(r.shouldAttach(t.value)){const o=r.retrieve(t.value);if(null!==o){const s=o.route;return s.value._futureSnapshot=t.value,s.children=t.children.map(a=>_f(r,a)),s}}const n=function jpe(r){return new ao(new Xo(r.url),new Xo(r.params),new Xo(r.queryParams),new Xo(r.fragment),new Xo(r.data),r.outlet,r.component,r)}(t.value),i=t.children.map(o=>_f(r,o));return new ka(n,i)}}const d$="ngNavigationCancelingError";function h$(r,t){const{redirectTo:e,navigationBehaviorOptions:n}=F8(t)?{redirectTo:t,navigationBehaviorOptions:void 0}:t,i=g$(!1,Gs.Redirect);return i.url=e,i.navigationBehaviorOptions=n,i}function g$(r,t){const e=new Error(`NavigationCancelingError: ${r||""}`);return e[d$]=!0,e.cancellationCode=t,e}function p$(r){return!!r&&r[d$]}let m$=(()=>{class r{static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275cmp=Ue({type:r,selectors:[["ng-component"]],standalone:!0,features:[Gg],decls:1,vars:0,template:function(n,i){1&n&&V(0,"router-outlet")},dependencies:[RS],encapsulation:2})}return r})();function xS(r){const t=r.children&&r.children.map(xS),e=t?{...r,children:t}:{...r};return!e.component&&!e.loadComponent&&(t||e.loadChildren)&&e.outlet&&e.outlet!==hn&&(e.component=m$),e}function Sc(r){return r.outlet||hn}function Cf(r){if(!r)return null;if(r.routeConfig?._injector)return r.routeConfig._injector;for(let t=r.parent;t;t=t.parent){const e=t.routeConfig;if(e?._loadedInjector)return e._loadedInjector;if(e?._injector)return e._injector}return null}class tme{constructor(t,e,n,i,o){this.routeReuseStrategy=t,this.futureState=e,this.currState=n,this.forwardEvent=i,this.inputBindingEnabled=o}activate(t){const e=this.futureState._root,n=this.currState?this.currState._root:null;this.deactivateChildRoutes(e,n,t),IS(this.futureState.root),this.activateChildRoutes(e,n,t)}deactivateChildRoutes(t,e,n){const i=B8(e);t.children.forEach(o=>{const s=o.value.outlet;this.deactivateRoutes(o,i[s],n),delete i[s]}),Object.values(i).forEach(o=>{this.deactivateRouteAndItsChildren(o,n)})}deactivateRoutes(t,e,n){const i=t.value,o=e?e.value:null;if(i===o)if(i.component){const s=n.getContext(i.outlet);s&&this.deactivateChildRoutes(t,e,s.children)}else this.deactivateChildRoutes(t,e,n);else o&&this.deactivateRouteAndItsChildren(e,n)}deactivateRouteAndItsChildren(t,e){t.value.component&&this.routeReuseStrategy.shouldDetach(t.value.snapshot)?this.detachAndStoreRouteSubtree(t,e):this.deactivateRouteAndOutlet(t,e)}detachAndStoreRouteSubtree(t,e){const n=e.getContext(t.value.outlet),i=n&&t.value.component?n.children:e,o=B8(t);for(const s of Object.values(o))this.deactivateRouteAndItsChildren(s,i);if(n&&n.outlet){const s=n.outlet.detach(),a=n.children.onOutletDeactivated();this.routeReuseStrategy.store(t.value.snapshot,{componentRef:s,route:t,contexts:a})}}deactivateRouteAndOutlet(t,e){const n=e.getContext(t.value.outlet),i=n&&t.value.component?n.children:e,o=B8(t);for(const s of Object.values(o))this.deactivateRouteAndItsChildren(s,i);n&&(n.outlet&&(n.outlet.deactivate(),n.children.onOutletDeactivated()),n.attachRef=null,n.route=null)}activateChildRoutes(t,e,n){const i=B8(e);t.children.forEach(o=>{this.activateRoutes(o,i[o.value.outlet],n),this.forwardEvent(new Upe(o.value.snapshot))}),t.children.length&&this.forwardEvent(new Hpe(t.value.snapshot))}activateRoutes(t,e,n){const i=t.value,o=e?e.value:null;if(IS(i),i===o)if(i.component){const s=n.getOrCreateContext(i.outlet);this.activateChildRoutes(t,e,s.children)}else this.activateChildRoutes(t,e,n);else if(i.component){const s=n.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){const a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),s.children.onOutletReAttached(a.contexts),s.attachRef=a.componentRef,s.route=a.route.value,s.outlet&&s.outlet.attach(a.componentRef,a.route.value),IS(a.route.value),this.activateChildRoutes(t,null,s.children)}else{const a=Cf(i.snapshot);s.attachRef=null,s.route=i,s.injector=a,s.outlet&&s.outlet.activateWith(i,s.injector),this.activateChildRoutes(t,null,s.children)}}else this.activateChildRoutes(t,null,n)}}class _${constructor(t){this.path=t,this.route=this.path[this.path.length-1]}}class Yp{constructor(t,e){this.component=t,this.route=e}}function nme(r,t,e){const n=r._root;return vf(n,t?t._root:null,e,[n.value])}function $8(r,t){const e=Symbol(),n=t.get(r,e);return n===e?"function"!=typeof r||function Yae(r){return null!==Ch(r)}(r)?t.get(r):r:n}function vf(r,t,e,n,i={canDeactivateChecks:[],canActivateChecks:[]}){const o=B8(t);return r.children.forEach(s=>{(function ime(r,t,e,n,i={canDeactivateChecks:[],canActivateChecks:[]}){const o=r.value,s=t?t.value:null,a=e?e.getContext(r.value.outlet):null;if(s&&o.routeConfig===s.routeConfig){const c=function ome(r,t,e){if("function"==typeof e)return e(r,t);switch(e){case"pathParamsChange":return!p6(r.url,t.url);case"pathParamsOrQueryParamsChange":return!p6(r.url,t.url)||!Mc(r.queryParams,t.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!kS(r,t)||!Mc(r.queryParams,t.queryParams);default:return!kS(r,t)}}(s,o,o.routeConfig.runGuardsAndResolvers);c?i.canActivateChecks.push(new _$(n)):(o.data=s.data,o._resolvedData=s._resolvedData),vf(r,t,o.component?a?a.children:null:e,n,i),c&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new Yp(a.outlet.component,s))}else s&&yf(t,a,i),i.canActivateChecks.push(new _$(n)),vf(r,null,o.component?a?a.children:null:e,n,i)})(s,o[s.value.outlet],e,n.concat([s.value]),i),delete o[s.value.outlet]}),Object.entries(o).forEach(([s,a])=>yf(a,e.getContext(s),i)),i}function yf(r,t,e){const n=B8(r),i=r.value;Object.entries(n).forEach(([o,s])=>{yf(s,i.component?t?t.children.getContext(o):null:t,e)}),e.canDeactivateChecks.push(new Yp(i.component&&t&&t.outlet&&t.outlet.isActivated?t.outlet.component:null,i))}function Mf(r){return"function"==typeof r}function C$(r){return r instanceof zp||"EmptyError"===r?.name}const Kp=Symbol("INITIAL_VALUE");function W8(){return Ia(r=>gS(r.map(t=>t.pipe(x8(1),function Qge(...r){const t=_p(r);return Ji((e,n)=>{(t?pS(r,e,t):pS(r,e)).subscribe(n)})}(Kp)))).pipe(jn(t=>{for(const e of t)if(!0!==e){if(e===Kp)return Kp;if(!1===e||e instanceof V8)return e}return!0}),A3(t=>t!==Kp),x8(1)))}function v$(r){return function Zse(...r){return IR(r)}(z2(t=>{if(F8(t))throw h$(0,t)}),jn(t=>!0===t))}class LS{constructor(t){this.segmentGroup=t||null}}class zS extends Error{constructor(t){super(),this.urlTree=t}}function q8(r){return Dp(new LS(r))}class Sme{constructor(t,e){this.urlSerializer=t,this.urlTree=e}lineralizeSegments(t,e){let n=[],i=e.root;for(;;){if(n=n.concat(i.segments),0===i.numberOfChildren)return Wt(n);if(i.numberOfChildren>1||!i.children[hn])return Dp(new de(4e3,!1));i=i.children[hn]}}applyRedirectCommands(t,e,n){const i=this.applyRedirectCreateUrlTree(e,this.urlSerializer.parse(e),t,n);if(e.startsWith("/"))throw new zS(i);return i}applyRedirectCreateUrlTree(t,e,n,i){const o=this.createSegmentGroup(t,e.root,n,i);return new V8(o,this.createQueryParams(e.queryParams,this.urlTree.queryParams),e.fragment)}createQueryParams(t,e){const n={};return Object.entries(t).forEach(([i,o])=>{if("string"==typeof o&&o.startsWith(":")){const a=o.substring(1);n[i]=e[a]}else n[i]=o}),n}createSegmentGroup(t,e,n,i){const o=this.createSegments(t,e.segments,n,i);let s={};return Object.entries(e.children).forEach(([a,c])=>{s[a]=this.createSegmentGroup(t,c,n,i)}),new M1(o,s)}createSegments(t,e,n,i){return e.map(o=>o.path.startsWith(":")?this.findPosParam(t,o,i):this.findOrReturn(o,n))}findPosParam(t,e,n){const i=n[e.path.substring(1)];if(!i)throw new de(4001,!1);return i}findOrReturn(t,e){let n=0;for(const i of e){if(i.path===t.path)return e.splice(n),i;n++}return t}}const DS={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function Ome(r,t,e,n,i){const o=VS(r,t,e);return o.matched?(n=function Ype(r,t){return r.providers&&!r._injector&&(r._injector=Sg(r.providers,t,`Route: ${r.path}`)),r._injector??t}(t,n),function Mme(r,t,e,n){const i=t.canMatch;return i&&0!==i.length?Wt(i.map(s=>{const a=$8(s,r);return q4(function fme(r){return r&&Mf(r.canMatch)}(a)?a.canMatch(t,e):E4(r,()=>a(t,e)))})).pipe(W8(),v$()):Wt(!0)}(n,t,e).pipe(jn(s=>!0===s?o:{...DS}))):Wt(o)}function VS(r,t,e){if("**"===t.path)return function Tme(r){return{matched:!0,parameters:r.length>0?HB(r).parameters:{},consumedSegments:r,remainingSegments:[],positionalParamSegments:{}}}(e);if(""===t.path)return"full"===t.pathMatch&&(r.hasChildren()||e.length>0)?{...DS}:{matched:!0,consumedSegments:[],remainingSegments:e,parameters:{},positionalParamSegments:{}};const i=(t.matcher||ope)(e,r,t);if(!i)return{...DS};const o={};Object.entries(i.posParams??{}).forEach(([a,c])=>{o[a]=c.path});const s=i.consumed.length>0?{...o,...i.consumed[i.consumed.length-1].parameters}:o;return{matched:!0,consumedSegments:i.consumed,remainingSegments:e.slice(i.consumed.length),parameters:s,positionalParamSegments:i.posParams??{}}}function y$(r,t,e,n){return e.length>0&&function Ame(r,t,e){return e.some(n=>Xp(r,t,n)&&Sc(n)!==hn)}(r,e,n)?{segmentGroup:new M1(t,bme(n,new M1(e,r.children))),slicedSegments:[]}:0===e.length&&function Nme(r,t,e){return e.some(n=>Xp(r,t,n))}(r,e,n)?{segmentGroup:new M1(r.segments,wme(r,e,n,r.children)),slicedSegments:e}:{segmentGroup:new M1(r.segments,r.children),slicedSegments:e}}function wme(r,t,e,n){const i={};for(const o of e)if(Xp(r,t,o)&&!n[Sc(o)]){const s=new M1([],{});i[Sc(o)]=s}return{...n,...i}}function bme(r,t){const e={};e[hn]=t;for(const n of r)if(""===n.path&&Sc(n)!==hn){const i=new M1([],{});e[Sc(n)]=i}return e}function Xp(r,t,e){return(!(r.hasChildren()||t.length>0)||"full"!==e.pathMatch)&&""===e.path}class Rme{}class zme{constructor(t,e,n,i,o,s,a){this.injector=t,this.configLoader=e,this.rootComponentType=n,this.config=i,this.urlTree=o,this.paramsInheritanceStrategy=s,this.urlSerializer=a,this.applyRedirects=new Sme(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(t){return new de(4002,`'${t.segmentGroup}'`)}recognize(){const t=y$(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(t).pipe(jn(e=>{const n=new AS([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},hn,this.rootComponentType,null,{}),i=new ka(n,e),o=new c$("",i),s=function Ope(r,t,e=null,n=null){return XB(KB(r),t,e,n)}(n,[],this.urlTree.queryParams,this.urlTree.fragment);return s.queryParams=this.urlTree.queryParams,o.url=this.urlSerializer.serialize(s),this.inheritParamsAndData(o._root,null),{state:o,tree:s}}))}match(t){return this.processSegmentGroup(this.injector,this.config,t,hn).pipe(L8(n=>{if(n instanceof zS)return this.urlTree=n.urlTree,this.match(n.urlTree.root);throw n instanceof LS?this.noMatchError(n):n}))}inheritParamsAndData(t,e){const n=t.value,i=bS(n,e,this.paramsInheritanceStrategy);n.params=Object.freeze(i.params),n.data=Object.freeze(i.data),t.children.forEach(o=>this.inheritParamsAndData(o,n))}processSegmentGroup(t,e,n,i){return 0===n.segments.length&&n.hasChildren()?this.processChildren(t,e,n):this.processSegment(t,e,n,n.segments,i,!0).pipe(jn(o=>o instanceof ka?[o]:[]))}processChildren(t,e,n){const i=[];for(const o of Object.keys(n.children))"primary"===o?i.unshift(o):i.push(o);return Mi(i).pipe(k8(o=>{const s=n.children[o],a=function Jpe(r,t){const e=r.filter(n=>Sc(n)===t);return e.push(...r.filter(n=>Sc(n)!==t)),e}(e,o);return this.processSegmentGroup(t,a,s,o)}),function tpe(r,t){return Ji(function epe(r,t,e,n,i){return(o,s)=>{let a=e,c=t,l=0;o.subscribe(gi(s,u=>{const f=l++;c=a?r(c,u,f):(a=!0,u),n&&s.next(c)},i&&(()=>{a&&s.next(c),s.complete()})))}}(r,t,arguments.length>=2,!0))}((o,s)=>(o.push(...s),o)),Vp(null),function npe(r,t){const e=arguments.length>=2;return n=>n.pipe(r?A3((i,o)=>r(i,o,n)):Gl,_S(1),e?Vp(t):DB(()=>new zp))}(),L2(o=>{if(null===o)return q8(n);const s=M$(o);return function Dme(r){r.sort((t,e)=>t.value.outlet===hn?-1:e.value.outlet===hn?1:t.value.outlet.localeCompare(e.value.outlet))}(s),Wt(s)}))}processSegment(t,e,n,i,o,s){return Mi(e).pipe(k8(a=>this.processSegmentAgainstRoute(a._injector??t,e,a,n,i,o,s).pipe(L8(c=>{if(c instanceof LS)return Wt(null);throw c}))),g6(a=>!!a),L8(a=>{if(C$(a))return function kme(r,t,e){return 0===t.length&&!r.children[e]}(n,i,o)?Wt(new Rme):q8(n);throw a}))}processSegmentAgainstRoute(t,e,n,i,o,s,a){return function Ime(r,t,e,n){return!!(Sc(r)===n||n!==hn&&Xp(t,e,r))&&VS(t,r,e).matched}(n,i,o,s)?void 0===n.redirectTo?this.matchSegmentAgainstRoute(t,i,n,o,s):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(t,i,e,n,o,s):q8(i):q8(i)}expandSegmentAgainstRouteUsingRedirect(t,e,n,i,o,s){const{matched:a,consumedSegments:c,positionalParamSegments:l,remainingSegments:u}=VS(e,i,o);if(!a)return q8(e);i.redirectTo.startsWith("/")&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>31&&(this.allowRedirects=!1));const f=this.applyRedirects.applyRedirectCommands(c,i.redirectTo,l);return this.applyRedirects.lineralizeSegments(i,f).pipe(L2(g=>this.processSegment(t,n,e,g.concat(u),s,!1)))}matchSegmentAgainstRoute(t,e,n,i,o){const s=Ome(e,n,i,t);return"**"===n.path&&(e.children={}),s.pipe(Ia(a=>a.matched?this.getChildConfig(t=n._injector??t,n,i).pipe(Ia(({routes:c})=>{const l=n._loadedInjector??t,{consumedSegments:u,remainingSegments:f,parameters:g}=a,y=new AS(u,g,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,function Hme(r){return r.data||{}}(n),Sc(n),n.component??n._loadedComponent??null,n,function Fme(r){return r.resolve||{}}(n)),{segmentGroup:S,slicedSegments:N}=y$(e,u,f,c);if(0===N.length&&S.hasChildren())return this.processChildren(l,c,S).pipe(jn(U=>null===U?null:new ka(y,U)));if(0===c.length&&0===N.length)return Wt(new ka(y,[]));const R=Sc(n)===o;return this.processSegment(l,c,S,N,R?hn:o,!0).pipe(jn(U=>new ka(y,U instanceof ka?[U]:[])))})):q8(e)))}getChildConfig(t,e,n){return e.children?Wt({routes:e.children,injector:t}):e.loadChildren?void 0!==e._loadedRoutes?Wt({routes:e._loadedRoutes,injector:e._loadedInjector}):function yme(r,t,e,n){const i=t.canLoad;return void 0===i||0===i.length?Wt(!0):Wt(i.map(s=>{const a=$8(s,r);return q4(function ame(r){return r&&Mf(r.canLoad)}(a)?a.canLoad(t,e):E4(r,()=>a(t,e)))})).pipe(W8(),v$())}(t,e,n).pipe(L2(i=>i?this.configLoader.loadChildren(t,e).pipe(z2(o=>{e._loadedRoutes=o.routes,e._loadedInjector=o.injector})):function Pme(r){return Dp(g$(!1,Gs.GuardRejected))}())):Wt({routes:[],injector:t})}}function Vme(r){const t=r.value.routeConfig;return t&&""===t.path}function M$(r){const t=[],e=new Set;for(const n of r){if(!Vme(n)){t.push(n);continue}const i=t.find(o=>n.value.routeConfig===o.value.routeConfig);void 0!==i?(i.children.push(...n.children),e.add(i)):t.push(n)}for(const n of e){const i=M$(n.children);t.push(new ka(n.value,i))}return t.filter(n=>!e.has(n))}function E$(r){const t=r.children.map(e=>E$(e)).flat();return[r,...t]}function HS(r){return Ia(t=>{const e=r(t);return e?Mi(e).pipe(jn(()=>t)):Wt(t)})}let P$=(()=>{class r{buildTitle(e){let n,i=e.root;for(;void 0!==i;)n=this.getResolvedTitleForRoute(i)??n,i=i.children.find(o=>o.outlet===hn);return n}getResolvedTitleForRoute(e){return e.data[uf]}static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275prov=xe({token:r,factory:()=>Ne(qme),providedIn:"root"})}return r})(),qme=(()=>{class r extends P${constructor(e){super(),this.title=e}updateTitle(e){const n=this.buildTitle(e);void 0!==n&&this.title.setTitle(n)}static#e=this.\u0275fac=function(n){return new(n||r)(ze(wde))};static#t=this.\u0275prov=xe({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();const j8=new tt("",{providedIn:"root",factory:()=>({})}),Z8=new tt("");let FS=(()=>{class r{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=Ne(gF)}loadComponent(e){if(this.componentLoaders.get(e))return this.componentLoaders.get(e);if(e._loadedComponent)return Wt(e._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(e);const n=q4(e.loadComponent()).pipe(jn(S$),z2(o=>{this.onLoadEndListener&&this.onLoadEndListener(e),e._loadedComponent=o}),rf(()=>{this.componentLoaders.delete(e)})),i=new zB(n,()=>new xs).pipe(mS());return this.componentLoaders.set(e,i),i}loadChildren(e,n){if(this.childrenLoaders.get(n))return this.childrenLoaders.get(n);if(n._loadedRoutes)return Wt({routes:n._loadedRoutes,injector:n._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(n);const o=function jme(r,t,e,n){return q4(r.loadChildren()).pipe(jn(S$),L2(i=>i instanceof ND||Array.isArray(i)?Wt(i):Mi(t.compileModuleAsync(i))),jn(i=>{n&&n(r);let o,s,a=!1;return Array.isArray(i)?(s=i,!0):(o=i.create(e).injector,s=o.get(Z8,[],{optional:!0,self:!0}).flat()),{routes:s.map(xS),injector:o}}))}(n,this.compiler,e,this.onLoadEndListener).pipe(rf(()=>{this.childrenLoaders.delete(n)})),s=new zB(o,()=>new xs).pipe(mS());return this.childrenLoaders.set(n,s),s}static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275prov=xe({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();function S$(r){return function Zme(r){return r&&"object"==typeof r&&"default"in r}(r)?r.default:r}let US=(()=>{class r{static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275prov=xe({token:r,factory:()=>Ne(Yme),providedIn:"root"})}return r})(),Yme=(()=>{class r{shouldProcessUrl(e){return!0}extract(e){return e}merge(e,n){return e}static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275prov=xe({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();const O$=new tt(""),T$=new tt("");function Kme(r,t,e){const n=r.get(T$),i=r.get(R2);return r.get(Xn).runOutsideAngular(()=>{if(!i.startViewTransition||n.skipNextTransition)return n.skipNextTransition=!1,Promise.resolve();let o;const s=new Promise(l=>{o=l}),a=i.startViewTransition(()=>(o(),function Xme(r){return new Promise(t=>{qz(t,{injector:r})})}(r))),{onViewTransitionCreated:c}=n;return c&&E4(r,()=>c({transition:a,from:t,to:e})),s})}let Qp=(()=>{class r{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new xs,this.transitionAbortSubject=new xs,this.configLoader=Ne(FS),this.environmentInjector=Ne(To),this.urlSerializer=Ne(H8),this.rootContexts=Ne(mf),this.location=Ne(B7),this.inputBindingEnabled=null!==Ne(Zp,{optional:!0}),this.titleStrategy=Ne(P$),this.options=Ne(j8,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=Ne(US),this.createViewTransition=Ne(O$,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>Wt(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=i=>this.events.next(new Dpe(i)),this.configLoader.onLoadStartListener=i=>this.events.next(new zpe(i))}complete(){this.transitions?.complete()}handleNavigationRequest(e){const n=++this.navigationId;this.transitions?.next({...this.transitions.value,...e,id:n})}setupNavigations(e,n,i){return this.transitions=new Xo({id:0,currentUrlTree:n,currentRawUrl:n,extractedUrl:this.urlHandlingStrategy.extract(n),urlAfterRedirects:this.urlHandlingStrategy.extract(n),rawUrl:n,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:pf,restoredState:null,currentSnapshot:i.snapshot,targetSnapshot:null,currentRouterState:i,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(A3(o=>0!==o.id),jn(o=>({...o,extractedUrl:this.urlHandlingStrategy.extract(o.rawUrl)})),Ia(o=>{this.currentTransition=o;let s=!1,a=!1;return Wt(o).pipe(z2(c=>{this.currentNavigation={id:c.id,initialUrl:c.rawUrl,extractedUrl:c.extractedUrl,trigger:c.source,extras:c.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),Ia(c=>{const l=!e.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl();if(!l&&"reload"!==(c.extras.onSameUrlNavigation??e.onSameUrlNavigation)){const f="";return this.events.next(new G8(c.id,this.urlSerializer.serialize(c.rawUrl),f,qp.IgnoredSameUrlNavigation)),c.resolve(null),N3}if(this.urlHandlingStrategy.shouldProcessUrl(c.rawUrl))return Wt(c).pipe(Ia(f=>{const g=this.transitions?.getValue();return this.events.next(new Wp(f.id,this.urlSerializer.serialize(f.extractedUrl),f.source,f.restoredState)),g!==this.transitions?.getValue()?N3:Promise.resolve(f)}),function Ume(r,t,e,n,i,o){return L2(s=>function xme(r,t,e,n,i,o,s="emptyOnly"){return new zme(r,t,e,n,i,s,o).recognize()}(r,t,e,n,s.extractedUrl,i,o).pipe(jn(({state:a,tree:c})=>({...s,targetSnapshot:a,urlAfterRedirects:c}))))}(this.environmentInjector,this.configLoader,this.rootComponentType,e.config,this.urlSerializer,this.paramsInheritanceStrategy),z2(f=>{o.targetSnapshot=f.targetSnapshot,o.urlAfterRedirects=f.urlAfterRedirects,this.currentNavigation={...this.currentNavigation,finalUrl:f.urlAfterRedirects};const g=new r$(f.id,this.urlSerializer.serialize(f.extractedUrl),this.urlSerializer.serialize(f.urlAfterRedirects),f.targetSnapshot);this.events.next(g)}));if(l&&this.urlHandlingStrategy.shouldProcessUrl(c.currentRawUrl)){const{id:f,extractedUrl:g,source:y,restoredState:S,extras:N}=c,R=new Wp(f,this.urlSerializer.serialize(g),y,S);this.events.next(R);const U=a$(this.rootComponentType).snapshot;return this.currentTransition=o={...c,targetSnapshot:U,urlAfterRedirects:g,extras:{...N,skipLocationChange:!1,replaceUrl:!1}},this.currentNavigation.finalUrl=g,Wt(o)}{const f="";return this.events.next(new G8(c.id,this.urlSerializer.serialize(c.extractedUrl),f,qp.IgnoredByUrlHandlingStrategy)),c.resolve(null),N3}}),z2(c=>{const l=new kpe(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(l)}),jn(c=>(this.currentTransition=o={...c,guards:nme(c.targetSnapshot,c.currentSnapshot,this.rootContexts)},o)),function dme(r,t){return L2(e=>{const{targetSnapshot:n,currentSnapshot:i,guards:{canActivateChecks:o,canDeactivateChecks:s}}=e;return 0===s.length&&0===o.length?Wt({...e,guardsResult:!0}):function hme(r,t,e,n){return Mi(r).pipe(L2(i=>function vme(r,t,e,n,i){const o=t&&t.routeConfig?t.routeConfig.canDeactivate:null;return o&&0!==o.length?Wt(o.map(a=>{const c=Cf(t)??i,l=$8(a,c);return q4(function ume(r){return r&&Mf(r.canDeactivate)}(l)?l.canDeactivate(r,t,e,n):E4(c,()=>l(r,t,e,n))).pipe(g6())})).pipe(W8()):Wt(!0)}(i.component,i.route,e,t,n)),g6(i=>!0!==i,!0))}(s,n,i,r).pipe(L2(a=>a&&function sme(r){return"boolean"==typeof r}(a)?function gme(r,t,e,n){return Mi(t).pipe(k8(i=>pS(function mme(r,t){return null!==r&&t&&t(new Vpe(r)),Wt(!0)}(i.route.parent,n),function pme(r,t){return null!==r&&t&&t(new Fpe(r)),Wt(!0)}(i.route,n),function Cme(r,t,e){const n=t[t.length-1],o=t.slice(0,t.length-1).reverse().map(s=>function rme(r){const t=r.routeConfig?r.routeConfig.canActivateChild:null;return t&&0!==t.length?{node:r,guards:t}:null}(s)).filter(s=>null!==s).map(s=>LB(()=>Wt(s.guards.map(c=>{const l=Cf(s.node)??e,u=$8(c,l);return q4(function lme(r){return r&&Mf(r.canActivateChild)}(u)?u.canActivateChild(n,r):E4(l,()=>u(n,r))).pipe(g6())})).pipe(W8())));return Wt(o).pipe(W8())}(r,i.path,e),function _me(r,t,e){const n=t.routeConfig?t.routeConfig.canActivate:null;if(!n||0===n.length)return Wt(!0);const i=n.map(o=>LB(()=>{const s=Cf(t)??e,a=$8(o,s);return q4(function cme(r){return r&&Mf(r.canActivate)}(a)?a.canActivate(t,r):E4(s,()=>a(t,r))).pipe(g6())}));return Wt(i).pipe(W8())}(r,i.route,e))),g6(i=>!0!==i,!0))}(n,o,r,t):Wt(a)),jn(a=>({...e,guardsResult:a})))})}(this.environmentInjector,c=>this.events.next(c)),z2(c=>{if(o.guardsResult=c.guardsResult,F8(c.guardsResult))throw h$(0,c.guardsResult);const l=new Rpe(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot,!!c.guardsResult);this.events.next(l)}),A3(c=>!!c.guardsResult||(this.cancelNavigationTransition(c,"",Gs.GuardRejected),!1)),HS(c=>{if(c.guards.canActivateChecks.length)return Wt(c).pipe(z2(l=>{const u=new xpe(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(u)}),Ia(l=>{let u=!1;return Wt(l).pipe(function Gme(r,t){return L2(e=>{const{targetSnapshot:n,guards:{canActivateChecks:i}}=e;if(!i.length)return Wt(e);const o=new Set(i.map(c=>c.route)),s=new Set;for(const c of o)if(!s.has(c))for(const l of E$(c))s.add(l);let a=0;return Mi(s).pipe(k8(c=>o.has(c)?function Bme(r,t,e,n){const i=r.routeConfig,o=r._resolve;return void 0!==i?.title&&!u$(i)&&(o[uf]=i.title),function $me(r,t,e,n){const i=CS(r);if(0===i.length)return Wt({});const o={};return Mi(i).pipe(L2(s=>function Wme(r,t,e,n){const i=Cf(t)??n,o=$8(r,i);return q4(o.resolve?o.resolve(t,e):E4(i,()=>o(t,e)))}(r[s],t,e,n).pipe(g6(),z2(a=>{o[s]=a}))),_S(1),function rpe(r){return jn(()=>r)}(o),L8(s=>C$(s)?N3:Dp(s)))}(o,r,t,n).pipe(jn(s=>(r._resolvedData=s,r.data=bS(r,r.parent,e).resolve,null)))}(c,n,r,t):(c.data=bS(c,c.parent,r).resolve,Wt(void 0))),z2(()=>a++),_S(1),L2(c=>a===s.size?Wt(e):N3))})}(this.paramsInheritanceStrategy,this.environmentInjector),z2({next:()=>u=!0,complete:()=>{u||this.cancelNavigationTransition(l,"",Gs.NoDataFromResolver)}}))}),z2(l=>{const u=new Lpe(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(u)}))}),HS(c=>{const l=u=>{const f=[];u.routeConfig?.loadComponent&&!u.routeConfig._loadedComponent&&f.push(this.configLoader.loadComponent(u.routeConfig).pipe(z2(g=>{u.component=g}),jn(()=>{})));for(const g of u.children)f.push(...l(g));return f};return gS(l(c.targetSnapshot.root)).pipe(Vp(null),x8(1))}),HS(()=>this.afterPreactivation()),Ia(()=>{const{currentSnapshot:c,targetSnapshot:l}=o,u=this.createViewTransition?.(this.environmentInjector,c.root,l.root);return u?Mi(u).pipe(jn(()=>o)):Wt(o)}),jn(c=>{const l=function Wpe(r,t,e){const n=_f(r,t._root,e?e._root:void 0);return new s$(n,t)}(e.routeReuseStrategy,c.targetSnapshot,c.currentRouterState);return this.currentTransition=o={...c,targetRouterState:l},this.currentNavigation.targetRouterState=l,o}),z2(()=>{this.events.next(new SS)}),((r,t,e,n)=>jn(i=>(new tme(t,i.targetRouterState,i.currentRouterState,e,n).activate(r),i)))(this.rootContexts,e.routeReuseStrategy,c=>this.events.next(c),this.inputBindingEnabled),x8(1),z2({next:c=>{s=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new Pc(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects))),this.titleStrategy?.updateTitle(c.targetRouterState.snapshot),c.resolve(!0)},complete:()=>{s=!0}}),z8(this.transitionAbortSubject.pipe(z2(c=>{throw c}))),rf(()=>{!s&&!a&&this.cancelNavigationTransition(o,"",Gs.SupersededByNewNavigation),this.currentTransition?.id===o.id&&(this.currentNavigation=null,this.currentTransition=null)}),L8(c=>{if(a=!0,p$(c))this.events.next(new U8(o.id,this.urlSerializer.serialize(o.extractedUrl),c.message,c.cancellationCode)),function Zpe(r){return p$(r)&&F8(r.url)}(c)?this.events.next(new OS(c.url)):o.resolve(!1);else{this.events.next(new jp(o.id,this.urlSerializer.serialize(o.extractedUrl),c,o.targetSnapshot??void 0));try{o.resolve(e.errorHandler(c))}catch(l){this.options.resolveNavigationPromiseOnError?o.resolve(!1):o.reject(l)}}return N3}))}))}cancelNavigationTransition(e,n,i){const o=new U8(e.id,this.urlSerializer.serialize(e.extractedUrl),n,i);this.events.next(o),e.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){return this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))).toString()!==this.currentTransition?.extractedUrl.toString()&&!this.currentTransition?.extras.skipLocationChange}static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275prov=xe({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();function Qme(r){return r!==pf}let Jme=(()=>{class r{static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275prov=xe({token:r,factory:()=>Ne(t_e),providedIn:"root"})}return r})();class e_e{shouldDetach(t){return!1}store(t,e){}shouldAttach(t){return!1}retrieve(t){return null}shouldReuseRoute(t,e){return t.routeConfig===e.routeConfig}}let t_e=(()=>{class r extends e_e{static#e=this.\u0275fac=(()=>{let e;return function(i){return(e||(e=z1(r)))(i||r)}})();static#t=this.\u0275prov=xe({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})(),w$=(()=>{class r{static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275prov=xe({token:r,factory:()=>Ne(n_e),providedIn:"root"})}return r})(),n_e=(()=>{class r extends w${constructor(){super(...arguments),this.location=Ne(B7),this.urlSerializer=Ne(H8),this.options=Ne(j8,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=Ne(US),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new V8,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=a$(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return"computed"!==this.canceledNavigationResolution?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(e){return this.location.subscribe(n=>{"popstate"===n.type&&e(n.url,n.state)})}handleRouterEvent(e,n){if(e instanceof Wp)this.stateMemento=this.createStateMemento();else if(e instanceof G8)this.rawUrlTree=n.initialUrl;else if(e instanceof r$){if("eager"===this.urlUpdateStrategy&&!n.extras.skipLocationChange){const i=this.urlHandlingStrategy.merge(n.finalUrl,n.initialUrl);this.setBrowserUrl(i,n)}}else e instanceof SS?(this.currentUrlTree=n.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(n.finalUrl,n.initialUrl),this.routerState=n.targetRouterState,"deferred"===this.urlUpdateStrategy&&(n.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,n))):e instanceof U8&&(e.code===Gs.GuardRejected||e.code===Gs.NoDataFromResolver)?this.restoreHistory(n):e instanceof jp?this.restoreHistory(n,!0):e instanceof Pc&&(this.lastSuccessfulId=e.id,this.currentPageId=this.browserPageId)}setBrowserUrl(e,n){const i=this.urlSerializer.serialize(e);if(this.location.isCurrentPathEqualTo(i)||n.extras.replaceUrl){const s={...n.extras.state,...this.generateNgRouterState(n.id,this.browserPageId)};this.location.replaceState(i,"",s)}else{const o={...n.extras.state,...this.generateNgRouterState(n.id,this.browserPageId+1)};this.location.go(i,"",o)}}restoreHistory(e,n=!1){if("computed"===this.canceledNavigationResolution){const o=this.currentPageId-this.browserPageId;0!==o?this.location.historyGo(o):this.currentUrlTree===e.finalUrl&&0===o&&(this.resetState(e),this.resetUrlToCurrentUrlTree())}else"replace"===this.canceledNavigationResolution&&(n&&this.resetState(e),this.resetUrlToCurrentUrlTree())}resetState(e){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,e.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(e,n){return"computed"===this.canceledNavigationResolution?{navigationId:e,\u0275routerPageId:n}:{navigationId:e}}static#e=this.\u0275fac=(()=>{let e;return function(i){return(e||(e=z1(r)))(i||r)}})();static#t=this.\u0275prov=xe({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();var Ef=function(r){return r[r.COMPLETE=0]="COMPLETE",r[r.FAILED=1]="FAILED",r[r.REDIRECTING=2]="REDIRECTING",r}(Ef||{});function b$(r,t){r.events.pipe(A3(e=>e instanceof Pc||e instanceof U8||e instanceof jp||e instanceof G8),jn(e=>e instanceof Pc||e instanceof G8?Ef.COMPLETE:e instanceof U8&&(e.code===Gs.Redirect||e.code===Gs.SupersededByNewNavigation)?Ef.REDIRECTING:Ef.FAILED),A3(e=>e!==Ef.REDIRECTING),x8(1)).subscribe(()=>{t()})}function r_e(r){throw r}const i_e={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},o_e={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let Qn=(()=>{class r{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.isNgZoneEnabled=!1,this.console=Ne(iF),this.stateManager=Ne(w$),this.options=Ne(j8,{optional:!0})||{},this.pendingTasks=Ne(w4),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=Ne(Qp),this.urlSerializer=Ne(H8),this.location=Ne(B7),this.urlHandlingStrategy=Ne(US),this._events=new xs,this.errorHandler=this.options.errorHandler||r_e,this.navigated=!1,this.routeReuseStrategy=Ne(Jme),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=Ne(Z8,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!Ne(Zp,{optional:!0}),this.eventsSubscription=new cn,this.isNgZoneEnabled=Ne(Xn)instanceof Xn&&Xn.isInAngularZone(),this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:e=>{this.console.warn(e)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){const e=this.navigationTransitions.events.subscribe(n=>{try{const i=this.navigationTransitions.currentTransition,o=this.navigationTransitions.currentNavigation;if(null!==i&&null!==o)if(this.stateManager.handleRouterEvent(n,o),n instanceof U8&&n.code!==Gs.Redirect&&n.code!==Gs.SupersededByNewNavigation)this.navigated=!0;else if(n instanceof Pc)this.navigated=!0;else if(n instanceof OS){const s=this.urlHandlingStrategy.merge(n.url,i.currentRawUrl),a={info:i.extras.info,skipLocationChange:i.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||Qme(i.source)};this.scheduleNavigation(s,pf,null,a,{resolve:i.resolve,reject:i.reject,promise:i.promise})}(function a_e(r){return!(r instanceof SS||r instanceof OS)})(n)&&this._events.next(n)}catch(i){this.navigationTransitions.transitionAbortSubject.next(i)}});this.eventsSubscription.add(e)}resetRootComponentType(e){this.routerState.root.component=e,this.navigationTransitions.rootComponentType=e}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),pf,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((e,n)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(e,"popstate",n)},0)})}navigateToSyncWithBrowser(e,n,i){const o={replaceUrl:!0},s=i?.navigationId?i:null;if(i){const c={...i};delete c.navigationId,delete c.\u0275routerPageId,0!==Object.keys(c).length&&(o.state=c)}const a=this.parseUrl(e);this.scheduleNavigation(a,n,s,o)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(e){this.config=e.map(xS),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(e,n={}){const{relativeTo:i,queryParams:o,fragment:s,queryParamsHandling:a,preserveFragment:c}=n,l=c?this.currentUrlTree.fragment:s;let f,u=null;switch(a){case"merge":u={...this.currentUrlTree.queryParams,...o};break;case"preserve":u=this.currentUrlTree.queryParams;break;default:u=o||null}null!==u&&(u=this.removeEmptyProps(u));try{f=KB(i?i.snapshot:this.routerState.snapshot.root)}catch{("string"!=typeof e[0]||!e[0].startsWith("/"))&&(e=[]),f=this.currentUrlTree.root}return XB(f,e,u,l??null)}navigateByUrl(e,n={skipLocationChange:!1}){const i=F8(e)?e:this.parseUrl(e),o=this.urlHandlingStrategy.merge(i,this.rawUrlTree);return this.scheduleNavigation(o,pf,null,n)}navigate(e,n={skipLocationChange:!1}){return function s_e(r){for(let t=0;t<r.length;t++)if(null==r[t])throw new de(4008,!1)}(e),this.navigateByUrl(this.createUrlTree(e,n),n)}serializeUrl(e){return this.urlSerializer.serialize(e)}parseUrl(e){try{return this.urlSerializer.parse(e)}catch{return this.urlSerializer.parse("/")}}isActive(e,n){let i;if(i=!0===n?{...i_e}:!1===n?{...o_e}:n,F8(e))return UB(this.currentUrlTree,e,i);const o=this.parseUrl(e);return UB(this.currentUrlTree,o,i)}removeEmptyProps(e){return Object.entries(e).reduce((n,[i,o])=>(null!=o&&(n[i]=o),n),{})}scheduleNavigation(e,n,i,o,s){if(this.disposed)return Promise.resolve(!1);let a,c,l;s?(a=s.resolve,c=s.reject,l=s.promise):l=new Promise((f,g)=>{a=f,c=g});const u=this.pendingTasks.add();return b$(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(u))}),this.navigationTransitions.handleNavigationRequest({source:n,restoredState:i,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:e,extras:o,resolve:a,reject:c,promise:l,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),l.catch(f=>Promise.reject(f))}static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275prov=xe({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})(),Oc=(()=>{class r{constructor(e,n,i,o,s,a){this.router=e,this.route=n,this.tabIndexAttribute=i,this.renderer=o,this.el=s,this.locationStrategy=a,this.href=null,this.commands=null,this.onChanges=new xs,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1;const c=s.nativeElement.tagName?.toLowerCase();this.isAnchorElement="a"===c||"area"===c,this.isAnchorElement?this.subscription=e.events.subscribe(l=>{l instanceof Pc&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(e){null!=this.tabIndexAttribute||this.isAnchorElement||this.applyAttributeValue("tabindex",e)}ngOnChanges(e){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(e){null!=e?(this.commands=Array.isArray(e)?e:[e],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(e,n,i,o,s){const a=this.urlTree;return!!(null===a||this.isAnchorElement&&(0!==e||n||i||o||s||"string"==typeof this.target&&"_self"!=this.target))||(this.router.navigateByUrl(a,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info}),!this.isAnchorElement)}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){const e=this.urlTree;this.href=null!==e&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(e)):null;const n=null===this.href?null:function IL(r,t,e){return function U3e(r,t){return"src"===t&&("embed"===r||"frame"===r||"iframe"===r||"media"===r||"script"===r)||"href"===t&&("base"===r||"link"===r)?NL:Jh}(t,e)(r)}(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",n)}applyAttributeValue(e,n){const i=this.renderer,o=this.el.nativeElement;null!==n?i.setAttribute(o,e,n):i.removeAttribute(o,e)}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}static#e=this.\u0275fac=function(n){return new(n||r)(G(Qn),G(ao),function qh(r){return function r3e(r,t){if("class"===t)return r.classes;if("style"===t)return r.styles;const e=r.attrs;if(e){const n=e.length;let i=0;for(;i<n;){const o=e[i];if(UR(o))break;if(0===o)i+=2;else if("number"==typeof o)for(i++;i<n&&"string"==typeof e[i];)i++;else{if(o===t)return e[i+1];i+=2}}}return null}(d1(),r)}("tabindex"),G(lc),G(I2),G(a6))};static#t=this.\u0275dir=Vt({type:r,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(n,i){1&n&&q("click",function(s){return i.onClick(s.button,s.ctrlKey,s.shiftKey,s.altKey,s.metaKey)}),2&n&&A("target",i.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[Z1.HasDecoratorInputTransform,"preserveFragment","preserveFragment",w8],skipLocationChange:[Z1.HasDecoratorInputTransform,"skipLocationChange","skipLocationChange",w8],replaceUrl:[Z1.HasDecoratorInputTransform,"replaceUrl","replaceUrl",w8],routerLink:"routerLink"},standalone:!0,features:[AD,n2]})}return r})();class A${}let u_e=(()=>{class r{constructor(e,n,i,o,s){this.router=e,this.injector=i,this.preloadingStrategy=o,this.loader=s}setUpPreloading(){this.subscription=this.router.events.pipe(A3(e=>e instanceof Pc),k8(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(e,n){const i=[];for(const o of n){o.providers&&!o._injector&&(o._injector=Sg(o.providers,e,`Route: ${o.path}`));const s=o._injector??e,a=o._loadedInjector??s;(o.loadChildren&&!o._loadedRoutes&&void 0===o.canLoad||o.loadComponent&&!o._loadedComponent)&&i.push(this.preloadConfig(s,o)),(o.children||o._loadedRoutes)&&i.push(this.processRoutes(a,o.children??o._loadedRoutes))}return Mi(i).pipe(lf())}preloadConfig(e,n){return this.preloadingStrategy.preload(n,()=>{let i;i=n.loadChildren&&void 0===n.canLoad?this.loader.loadChildren(e,n):Wt(null);const o=i.pipe(L2(s=>null===s?Wt(void 0):(n._loadedRoutes=s.routes,n._loadedInjector=s.injector,this.processRoutes(s.injector??e,s.routes))));return n.loadComponent&&!n._loadedComponent?Mi([o,this.loader.loadComponent(n)]).pipe(lf()):o})}static#e=this.\u0275fac=function(n){return new(n||r)(ze(Qn),ze(gF),ze(To),ze(A$),ze(FS))};static#t=this.\u0275prov=xe({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();const GS=new tt("");let N$=(()=>{class r{constructor(e,n,i,o,s={}){this.urlSerializer=e,this.transitions=n,this.viewportScroller=i,this.zone=o,this.options=s,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},s.scrollPositionRestoration||="disabled",s.anchorScrolling||="disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(e=>{e instanceof Wp?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=e.navigationTrigger,this.restoredId=e.restoredState?e.restoredState.navigationId:0):e instanceof Pc?(this.lastId=e.id,this.scheduleScrollEvent(e,this.urlSerializer.parse(e.urlAfterRedirects).fragment)):e instanceof G8&&e.code===qp.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(e,this.urlSerializer.parse(e.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(e=>{e instanceof i$&&(e.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(e.position):e.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(e.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(e,n){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new i$(e,"popstate"===this.lastSource?this.store[this.restoredId]:null,n))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}static#e=this.\u0275fac=function(n){!function cz(){throw new Error("invalid")}()};static#t=this.\u0275prov=xe({token:r,factory:r.\u0275fac})}return r})();function Tc(r,t){return{\u0275kind:r,\u0275providers:t}}function k$(){const r=Ne(no);return t=>{const e=r.get(k4);if(t!==e.components[0])return;const n=r.get(Qn),i=r.get(R$);1===r.get(BS)&&n.initialNavigation(),r.get(x$,null,Sn.Optional)?.setUpPreloading(),r.get(GS,null,Sn.Optional)?.init(),n.resetRootComponentType(e.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}const R$=new tt("",{factory:()=>new xs}),BS=new tt("",{providedIn:"root",factory:()=>1}),x$=new tt("");function g_e(r){return Tc(0,[{provide:x$,useExisting:u_e},{provide:A$,useExisting:r}])}function m_e(r){return Tc(9,[{provide:O$,useValue:Kme},{provide:T$,useValue:{skipNextTransition:!!r?.skipInitialTransition,...r}}])}const L$=new tt("ROUTER_FORROOT_GUARD"),__e=[B7,{provide:H8,useClass:vS},Qn,mf,{provide:ao,useFactory:function I$(r){return r.routerState.root},deps:[Qn]},FS,[]];let C_e=(()=>{class r{constructor(e){}static forRoot(e,n){return{ngModule:r,providers:[__e,[],{provide:Z8,multi:!0,useValue:e},{provide:L$,useFactory:E_e,deps:[[Qn,new Nh,new Ih]]},{provide:j8,useValue:n||{}},n?.useHash?{provide:a6,useClass:lfe}:{provide:a6,useClass:rU},{provide:GS,useFactory:()=>{const r=Ne(b9e),t=Ne(Xn),e=Ne(j8),n=Ne(Qp),i=Ne(H8);return e.scrollOffset&&r.setOffset(e.scrollOffset),new N$(i,n,r,t,e)}},n?.preloadingStrategy?g_e(n.preloadingStrategy).\u0275providers:[],n?.initialNavigation?P_e(n):[],n?.bindToComponentInputs?Tc(8,[f$,{provide:Zp,useExisting:f$}]).\u0275providers:[],n?.enableViewTransitions?m_e().\u0275providers:[],[{provide:z$,useFactory:k$},{provide:rP,multi:!0,useExisting:z$}]]}}static forChild(e){return{ngModule:r,providers:[{provide:Z8,multi:!0,useValue:e}]}}static#e=this.\u0275fac=function(n){return new(n||r)(ze(L$,8))};static#t=this.\u0275mod=Ls({type:r});static#n=this.\u0275inj=ns({})}return r})();function E_e(r){return"guarded"}function P_e(r){return["disabled"===r.initialNavigation?Tc(3,[{provide:tP,multi:!0,useFactory:()=>{const t=Ne(Qn);return()=>{t.setUpLocationChangeListener()}}},{provide:BS,useValue:2}]).\u0275providers:[],"enabledBlocking"===r.initialNavigation?Tc(2,[{provide:BS,useValue:0},{provide:tP,multi:!0,deps:[no],useFactory:t=>{const e=t.get(afe,Promise.resolve());return()=>e.then(()=>new Promise(n=>{const i=t.get(Qn),o=t.get(R$);b$(i,()=>{n(!0)}),t.get(Qp).afterPreactivation=()=>(n(!0),o.closed?Wt(void 0):o),i.initialNavigation()}))}}]).\u0275providers:[]]}const z$=new tt("");var qt=function(r){return r[r.State=0]="State",r[r.Transition=1]="Transition",r[r.Sequence=2]="Sequence",r[r.Group=3]="Group",r[r.Animate=4]="Animate",r[r.Keyframes=5]="Keyframes",r[r.Style=6]="Style",r[r.Trigger=7]="Trigger",r[r.Reference=8]="Reference",r[r.AnimateChild=9]="AnimateChild",r[r.AnimateRef=10]="AnimateRef",r[r.Query=11]="Query",r[r.Stagger=12]="Stagger",r}(qt||{});const I3="*";function D$(r){return{type:qt.Style,styles:r,offset:null}}class Pf{constructor(t=0,e=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=t+e}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}onStart(t){this._originalOnStartFns.push(t),this._onStartFns.push(t)}onDone(t){this._originalOnDoneFns.push(t),this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){queueMicrotask(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(t=>t()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(t){this._position=this.totalTime?t*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(n=>n()),e.length=0}}class V${constructor(t){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=t;let e=0,n=0,i=0;const o=this.players.length;0==o?queueMicrotask(()=>this._onFinish()):this.players.forEach(s=>{s.onDone(()=>{++e==o&&this._onFinish()}),s.onDestroy(()=>{++n==o&&this._onDestroy()}),s.onStart(()=>{++i==o&&this._onStart()})}),this.totalTime=this.players.reduce((s,a)=>Math.max(s,a.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this.players.forEach(t=>t.init())}onStart(t){this._onStartFns.push(t)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(t=>t()),this._onStartFns=[])}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(t=>t.play())}pause(){this.players.forEach(t=>t.pause())}restart(){this.players.forEach(t=>t.restart())}finish(){this._onFinish(),this.players.forEach(t=>t.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(t=>t.destroy()),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this.players.forEach(t=>t.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(t){const e=t*this.totalTime;this.players.forEach(n=>{const i=n.totalTime?Math.min(1,e/n.totalTime):1;n.setPosition(i)})}getPosition(){const t=this.players.reduce((e,n)=>null===e||n.totalTime>e.totalTime?n:e,null);return null!=t?t.getPosition():0}beforeDestroy(){this.players.forEach(t=>{t.beforeDestroy&&t.beforeDestroy()})}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(n=>n()),e.length=0}}function H$(r){return new de(3e3,!1)}function j4(r){switch(r.length){case 0:return new Pf;case 1:return r[0];default:return new V$(r)}}function F$(r,t,e=new Map,n=new Map){const i=[],o=[];let s=-1,a=null;if(t.forEach(c=>{const l=c.get("offset"),u=l==s,f=u&&a||new Map;c.forEach((g,y)=>{let S=y,N=g;if("offset"!==y)switch(S=r.normalizePropertyName(S,i),N){case"!":N=e.get(y);break;case I3:N=n.get(y);break;default:N=r.normalizeStyleValue(y,S,N,i)}f.set(S,N)}),u||o.push(f),a=f,s=l}),i.length)throw function Q_e(r){return new de(3502,!1)}();return o}function WS(r,t,e,n){switch(t){case"start":r.onStart(()=>n(e&&qS(e,"start",r)));break;case"done":r.onDone(()=>n(e&&qS(e,"done",r)));break;case"destroy":r.onDestroy(()=>n(e&&qS(e,"destroy",r)))}}function qS(r,t,e){const o=jS(r.element,r.triggerName,r.fromState,r.toState,t||r.phaseName,e.totalTime??r.totalTime,!!e.disabled),s=r._data;return null!=s&&(o._data=s),o}function jS(r,t,e,n,i="",o=0,s){return{element:r,triggerName:t,fromState:e,toState:n,phaseName:i,totalTime:o,disabled:!!s}}function cs(r,t,e){let n=r.get(t);return n||r.set(t,n=e),n}function U$(r){const t=r.indexOf(":");return[r.substring(1,t),r.slice(t+1)]}const uCe=typeof document>"u"?null:document.documentElement;function ZS(r){const t=r.parentNode||r.host||null;return t===uCe?null:t}let m6=null,G$=!1;function B$(r,t){for(;t;){if(t===r)return!0;t=ZS(t)}return!1}function $$(r,t,e){if(e)return Array.from(r.querySelectorAll(t));const n=r.querySelector(t);return n?[n]:[]}let YS=(()=>{class r{validateStyleProperty(e){return function dCe(r){m6||(m6=function hCe(){return typeof document<"u"?document.body:null}()||{},G$=!!m6.style&&"WebkitAppearance"in m6.style);let t=!0;return m6.style&&!function fCe(r){return"ebkit"==r.substring(1,6)}(r)&&(t=r in m6.style,!t&&G$&&(t="Webkit"+r.charAt(0).toUpperCase()+r.slice(1)in m6.style)),t}(e)}matchesElement(e,n){return!1}containsElement(e,n){return B$(e,n)}getParentElement(e){return ZS(e)}query(e,n,i){return $$(e,n,i)}computeStyle(e,n,i){return i||""}animate(e,n,i,o,s,a=[],c){return new Pf(i,o)}static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275prov=xe({token:r,factory:r.\u0275fac})}return r})();class KS{static#e=this.NOOP=new YS}class XS{}const pCe=1e3,QS="ng-enter",Jp="ng-leave",em="ng-trigger",tm=".ng-trigger",q$="ng-animating",JS=".ng-animating";function k3(r){if("number"==typeof r)return r;const t=r.match(/^(-?[\.\d]+)(m?s)/);return!t||t.length<2?0:eO(parseFloat(t[1]),t[2])}function eO(r,t){return"s"===t?r*pCe:r}function nm(r,t,e){return r.hasOwnProperty("duration")?r:function _Ce(r,t,e){let i,o=0,s="";if("string"==typeof r){const a=r.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===a)return t.push(H$()),{duration:0,delay:0,easing:""};i=eO(parseFloat(a[1]),a[2]);const c=a[3];null!=c&&(o=eO(parseFloat(c),a[4]));const l=a[5];l&&(s=l)}else i=r;if(!e){let a=!1,c=t.length;i<0&&(t.push(function N_e(){return new de(3100,!1)}()),a=!0),o<0&&(t.push(function I_e(){return new de(3101,!1)}()),a=!0),a&&t.splice(c,0,H$())}return{duration:i,delay:o,easing:s}}(r,t,e)}function wc(r,t,e){t.forEach((n,i)=>{const o=nO(i);e&&!e.has(i)&&e.set(i,r.style[o]),r.style[o]=n})}function _6(r,t){t.forEach((e,n)=>{const i=nO(n);r.style[i]=""})}function Sf(r){return Array.isArray(r)?1==r.length?r[0]:function O_e(r,t=null){return{type:qt.Sequence,steps:r,options:t}}(r):r}const tO=new RegExp("{{\\s*(.+?)\\s*}}","g");function Z$(r){let t=[];if("string"==typeof r){let e;for(;e=tO.exec(r);)t.push(e[1]);tO.lastIndex=0}return t}function Of(r,t,e){const n=`${r}`,i=n.replace(tO,(o,s)=>{let a=t[s];return null==a&&(e.push(function R_e(r){return new de(3003,!1)}()),a=""),a.toString()});return i==n?r:i}const yCe=/-+([a-z0-9])/g;function nO(r){return r.replace(yCe,(...t)=>t[1].toUpperCase())}function ls(r,t,e){switch(t.type){case qt.Trigger:return r.visitTrigger(t,e);case qt.State:return r.visitState(t,e);case qt.Transition:return r.visitTransition(t,e);case qt.Sequence:return r.visitSequence(t,e);case qt.Group:return r.visitGroup(t,e);case qt.Animate:return r.visitAnimate(t,e);case qt.Keyframes:return r.visitKeyframes(t,e);case qt.Style:return r.visitStyle(t,e);case qt.Reference:return r.visitReference(t,e);case qt.AnimateChild:return r.visitAnimateChild(t,e);case qt.AnimateRef:return r.visitAnimateRef(t,e);case qt.Query:return r.visitQuery(t,e);case qt.Stagger:return r.visitStagger(t,e);default:throw function x_e(r){return new de(3004,!1)}()}}function rO(r,t){return window.getComputedStyle(r)[t]}const PCe=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class Y$ extends XS{normalizePropertyName(t,e){return nO(t)}normalizeStyleValue(t,e,n,i){let o="";const s=n.toString().trim();if(PCe.has(e)&&0!==n&&"0"!==n)if("number"==typeof n)o="px";else{const a=n.match(/^[+-]?[\d\.]+([a-z]*)$/);a&&0==a[1].length&&i.push(function L_e(r,t){return new de(3005,!1)}())}return s+o}}const rm="*";const im=new Set(["true","1"]),om=new Set(["false","0"]);function K$(r,t){const e=im.has(r)||om.has(r),n=im.has(t)||om.has(t);return(i,o)=>{let s=r==rm||r==i,a=t==rm||t==o;return!s&&e&&"boolean"==typeof i&&(s=i?im.has(r):om.has(r)),!a&&n&&"boolean"==typeof o&&(a=o?im.has(t):om.has(t)),s&&a}}const wCe=new RegExp("s*:selfs*,?","g");function iO(r,t,e,n){return new bCe(r).build(t,e,n)}class bCe{constructor(t){this._driver=t}build(t,e,n){const i=new ICe(e);return this._resetContextStyleTimingState(i),ls(this,Sf(t),i)}_resetContextStyleTimingState(t){t.currentQuerySelector="",t.collectedStyles=new Map,t.collectedStyles.set("",new Map),t.currentTime=0}visitTrigger(t,e){let n=e.queryCount=0,i=e.depCount=0;const o=[],s=[];return"@"==t.name.charAt(0)&&e.errors.push(function z_e(){return new de(3006,!1)}()),t.definitions.forEach(a=>{if(this._resetContextStyleTimingState(e),a.type==qt.State){const c=a,l=c.name;l.toString().split(/\s*,\s*/).forEach(u=>{c.name=u,o.push(this.visitState(c,e))}),c.name=l}else if(a.type==qt.Transition){const c=this.visitTransition(a,e);n+=c.queryCount,i+=c.depCount,s.push(c)}else e.errors.push(function D_e(){return new de(3007,!1)}())}),{type:qt.Trigger,name:t.name,states:o,transitions:s,queryCount:n,depCount:i,options:null}}visitState(t,e){const n=this.visitStyle(t.styles,e),i=t.options&&t.options.params||null;if(n.containsDynamicStyles){const o=new Set,s=i||{};n.styles.forEach(a=>{a instanceof Map&&a.forEach(c=>{Z$(c).forEach(l=>{s.hasOwnProperty(l)||o.add(l)})})}),o.size&&e.errors.push(function V_e(r,t){return new de(3008,!1)}(0,o.values()))}return{type:qt.State,name:t.name,style:n,options:i?{params:i}:null}}visitTransition(t,e){e.queryCount=0,e.depCount=0;const n=ls(this,Sf(t.animation),e),i=function SCe(r,t){const e=[];return"string"==typeof r?r.split(/\s*,\s*/).forEach(n=>function OCe(r,t,e){if(":"==r[0]){const c=function TCe(r,t){switch(r){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(e,n)=>parseFloat(n)>parseFloat(e);case":decrement":return(e,n)=>parseFloat(n)<parseFloat(e);default:return t.push(function Z_e(r){return new de(3016,!1)}()),"* => *"}}(r,e);if("function"==typeof c)return void t.push(c);r=c}const n=r.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==n||n.length<4)return e.push(function j_e(r){return new de(3015,!1)}()),t;const i=n[1],o=n[2],s=n[3];t.push(K$(i,s)),"<"==o[0]&&(i!=rm||s!=rm)&&t.push(K$(s,i))}(n,e,t)):e.push(r),e}(t.expr,e.errors);return{type:qt.Transition,matchers:i,animation:n,queryCount:e.queryCount,depCount:e.depCount,options:C6(t.options)}}visitSequence(t,e){return{type:qt.Sequence,steps:t.steps.map(n=>ls(this,n,e)),options:C6(t.options)}}visitGroup(t,e){const n=e.currentTime;let i=0;const o=t.steps.map(s=>{e.currentTime=n;const a=ls(this,s,e);return i=Math.max(i,e.currentTime),a});return e.currentTime=i,{type:qt.Group,steps:o,options:C6(t.options)}}visitAnimate(t,e){const n=function RCe(r,t){if(r.hasOwnProperty("duration"))return r;if("number"==typeof r)return oO(nm(r,t).duration,0,"");const e=r;if(e.split(/\s+/).some(o=>"{"==o.charAt(0)&&"{"==o.charAt(1))){const o=oO(0,0,"");return o.dynamic=!0,o.strValue=e,o}const i=nm(e,t);return oO(i.duration,i.delay,i.easing)}(t.timings,e.errors);e.currentAnimateTimings=n;let i,o=t.styles?t.styles:D$({});if(o.type==qt.Keyframes)i=this.visitKeyframes(o,e);else{let s=t.styles,a=!1;if(!s){a=!0;const l={};n.easing&&(l.easing=n.easing),s=D$(l)}e.currentTime+=n.duration+n.delay;const c=this.visitStyle(s,e);c.isEmptyStep=a,i=c}return e.currentAnimateTimings=null,{type:qt.Animate,timings:n,style:i,options:null}}visitStyle(t,e){const n=this._makeStyleAst(t,e);return this._validateStyleAst(n,e),n}_makeStyleAst(t,e){const n=[],i=Array.isArray(t.styles)?t.styles:[t.styles];for(let a of i)"string"==typeof a?a===I3?n.push(a):e.errors.push(new de(3002,!1)):n.push(new Map(Object.entries(a)));let o=!1,s=null;return n.forEach(a=>{if(a instanceof Map&&(a.has("easing")&&(s=a.get("easing"),a.delete("easing")),!o))for(let c of a.values())if(c.toString().indexOf("{{")>=0){o=!0;break}}),{type:qt.Style,styles:n,easing:s,offset:t.offset,containsDynamicStyles:o,options:null}}_validateStyleAst(t,e){const n=e.currentAnimateTimings;let i=e.currentTime,o=e.currentTime;n&&o>0&&(o-=n.duration+n.delay),t.styles.forEach(s=>{"string"!=typeof s&&s.forEach((a,c)=>{const l=e.collectedStyles.get(e.currentQuerySelector),u=l.get(c);let f=!0;u&&(o!=i&&o>=u.startTime&&i<=u.endTime&&(e.errors.push(function F_e(r,t,e,n,i){return new de(3010,!1)}()),f=!1),o=u.startTime),f&&l.set(c,{startTime:o,endTime:i}),e.options&&function vCe(r,t,e){const n=t.params||{},i=Z$(r);i.length&&i.forEach(o=>{n.hasOwnProperty(o)||e.push(function k_e(r){return new de(3001,!1)}())})}(a,e.options,e.errors)})})}visitKeyframes(t,e){const n={type:qt.Keyframes,styles:[],options:null};if(!e.currentAnimateTimings)return e.errors.push(function U_e(){return new de(3011,!1)}()),n;let o=0;const s=[];let a=!1,c=!1,l=0;const u=t.steps.map(U=>{const $=this._makeStyleAst(U,e);let re=null!=$.offset?$.offset:function kCe(r){if("string"==typeof r)return null;let t=null;if(Array.isArray(r))r.forEach(e=>{if(e instanceof Map&&e.has("offset")){const n=e;t=parseFloat(n.get("offset")),n.delete("offset")}});else if(r instanceof Map&&r.has("offset")){const e=r;t=parseFloat(e.get("offset")),e.delete("offset")}return t}($.styles),_e=0;return null!=re&&(o++,_e=$.offset=re),c=c||_e<0||_e>1,a=a||_e<l,l=_e,s.push(_e),$});c&&e.errors.push(function G_e(){return new de(3012,!1)}()),a&&e.errors.push(function B_e(){return new de(3200,!1)}());const f=t.steps.length;let g=0;o>0&&o<f?e.errors.push(function $_e(){return new de(3202,!1)}()):0==o&&(g=1/(f-1));const y=f-1,S=e.currentTime,N=e.currentAnimateTimings,R=N.duration;return u.forEach((U,$)=>{const re=g>0?$==y?1:g*$:s[$],_e=re*R;e.currentTime=S+N.delay+_e,N.duration=_e,this._validateStyleAst(U,e),U.offset=re,n.styles.push(U)}),n}visitReference(t,e){return{type:qt.Reference,animation:ls(this,Sf(t.animation),e),options:C6(t.options)}}visitAnimateChild(t,e){return e.depCount++,{type:qt.AnimateChild,options:C6(t.options)}}visitAnimateRef(t,e){return{type:qt.AnimateRef,animation:this.visitReference(t.animation,e),options:C6(t.options)}}visitQuery(t,e){const n=e.currentQuerySelector,i=t.options||{};e.queryCount++,e.currentQuery=t;const[o,s]=function ACe(r){const t=!!r.split(/\s*,\s*/).find(e=>":self"==e);return t&&(r=r.replace(wCe,"")),r=r.replace(/@\*/g,tm).replace(/@\w+/g,e=>tm+"-"+e.slice(1)).replace(/:animating/g,JS),[r,t]}(t.selector);e.currentQuerySelector=n.length?n+" "+o:o,cs(e.collectedStyles,e.currentQuerySelector,new Map);const a=ls(this,Sf(t.animation),e);return e.currentQuery=null,e.currentQuerySelector=n,{type:qt.Query,selector:o,limit:i.limit||0,optional:!!i.optional,includeSelf:s,animation:a,originalSelector:t.selector,options:C6(t.options)}}visitStagger(t,e){e.currentQuery||e.errors.push(function W_e(){return new de(3013,!1)}());const n="full"===t.timings?{duration:0,delay:0,easing:"full"}:nm(t.timings,e.errors,!0);return{type:qt.Stagger,animation:ls(this,Sf(t.animation),e),timings:n,options:null}}}class ICe{constructor(t){this.errors=t,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function C6(r){return r?(r={...r}).params&&(r.params=function NCe(r){return r?{...r}:null}(r.params)):r={},r}function oO(r,t,e){return{duration:r,delay:t,easing:e}}function sO(r,t,e,n,i,o,s=null,a=!1){return{type:1,element:r,keyframes:t,preStyleProps:e,postStyleProps:n,duration:i,delay:o,totalTime:i+o,easing:s,subTimeline:a}}class sm{constructor(){this._map=new Map}get(t){return this._map.get(t)||[]}append(t,e){let n=this._map.get(t);n||this._map.set(t,n=[]),n.push(...e)}has(t){return this._map.has(t)}clear(){this._map.clear()}}const zCe=new RegExp(":enter","g"),VCe=new RegExp(":leave","g");function aO(r,t,e,n,i,o=new Map,s=new Map,a,c,l=[]){return(new HCe).buildKeyframes(r,t,e,n,i,o,s,a,c,l)}class HCe{buildKeyframes(t,e,n,i,o,s,a,c,l,u=[]){l=l||new sm;const f=new cO(t,e,l,i,o,u,[]);f.options=c;const g=c.delay?k3(c.delay):0;f.currentTimeline.delayNextStep(g),f.currentTimeline.setStyles([s],null,f.errors,c),ls(this,n,f);const y=f.timelines.filter(S=>S.containsAnimation());if(y.length&&a.size){let S;for(let N=y.length-1;N>=0;N--){const R=y[N];if(R.element===e){S=R;break}}S&&!S.allowOnlyTimelineStyles()&&S.setStyles([a],null,f.errors,c)}return y.length?y.map(S=>S.buildKeyframes()):[sO(e,[],[],[],0,g,"",!1)]}visitTrigger(t,e){}visitState(t,e){}visitTransition(t,e){}visitAnimateChild(t,e){const n=e.subInstructions.get(e.element);if(n){const i=e.createSubContext(t.options),o=e.currentTimeline.currentTime,s=this._visitSubInstructions(n,i,i.options);o!=s&&e.transformIntoNewTimeline(s)}e.previousNode=t}visitAnimateRef(t,e){const n=e.createSubContext(t.options);n.transformIntoNewTimeline(),this._applyAnimationRefDelays([t.options,t.animation.options],e,n),this.visitReference(t.animation,n),e.transformIntoNewTimeline(n.currentTimeline.currentTime),e.previousNode=t}_applyAnimationRefDelays(t,e,n){for(const i of t){const o=i?.delay;if(o){const s="number"==typeof o?o:k3(Of(o,i?.params??{},e.errors));n.delayNextStep(s)}}}_visitSubInstructions(t,e,n){let o=e.currentTimeline.currentTime;const s=null!=n.duration?k3(n.duration):null,a=null!=n.delay?k3(n.delay):null;return 0!==s&&t.forEach(c=>{const l=e.appendInstructionToTimeline(c,s,a);o=Math.max(o,l.duration+l.delay)}),o}visitReference(t,e){e.updateOptions(t.options,!0),ls(this,t.animation,e),e.previousNode=t}visitSequence(t,e){const n=e.subContextCount;let i=e;const o=t.options;if(o&&(o.params||o.delay)&&(i=e.createSubContext(o),i.transformIntoNewTimeline(),null!=o.delay)){i.previousNode.type==qt.Style&&(i.currentTimeline.snapshotCurrentStyles(),i.previousNode=am);const s=k3(o.delay);i.delayNextStep(s)}t.steps.length&&(t.steps.forEach(s=>ls(this,s,i)),i.currentTimeline.applyStylesToKeyframe(),i.subContextCount>n&&i.transformIntoNewTimeline()),e.previousNode=t}visitGroup(t,e){const n=[];let i=e.currentTimeline.currentTime;const o=t.options&&t.options.delay?k3(t.options.delay):0;t.steps.forEach(s=>{const a=e.createSubContext(t.options);o&&a.delayNextStep(o),ls(this,s,a),i=Math.max(i,a.currentTimeline.currentTime),n.push(a.currentTimeline)}),n.forEach(s=>e.currentTimeline.mergeTimelineCollectedStyles(s)),e.transformIntoNewTimeline(i),e.previousNode=t}_visitTiming(t,e){if(t.dynamic){const n=t.strValue;return nm(e.params?Of(n,e.params,e.errors):n,e.errors)}return{duration:t.duration,delay:t.delay,easing:t.easing}}visitAnimate(t,e){const n=e.currentAnimateTimings=this._visitTiming(t.timings,e),i=e.currentTimeline;n.delay&&(e.incrementTime(n.delay),i.snapshotCurrentStyles());const o=t.style;o.type==qt.Keyframes?this.visitKeyframes(o,e):(e.incrementTime(n.duration),this.visitStyle(o,e),i.applyStylesToKeyframe()),e.currentAnimateTimings=null,e.previousNode=t}visitStyle(t,e){const n=e.currentTimeline,i=e.currentAnimateTimings;!i&&n.hasCurrentStyleProperties()&&n.forwardFrame();const o=i&&i.easing||t.easing;t.isEmptyStep?n.applyEmptyStep(o):n.setStyles(t.styles,o,e.errors,e.options),e.previousNode=t}visitKeyframes(t,e){const n=e.currentAnimateTimings,i=e.currentTimeline.duration,o=n.duration,a=e.createSubContext().currentTimeline;a.easing=n.easing,t.styles.forEach(c=>{a.forwardTime((c.offset||0)*o),a.setStyles(c.styles,c.easing,e.errors,e.options),a.applyStylesToKeyframe()}),e.currentTimeline.mergeTimelineCollectedStyles(a),e.transformIntoNewTimeline(i+o),e.previousNode=t}visitQuery(t,e){const n=e.currentTimeline.currentTime,i=t.options||{},o=i.delay?k3(i.delay):0;o&&(e.previousNode.type===qt.Style||0==n&&e.currentTimeline.hasCurrentStyleProperties())&&(e.currentTimeline.snapshotCurrentStyles(),e.previousNode=am);let s=n;const a=e.invokeQuery(t.selector,t.originalSelector,t.limit,t.includeSelf,!!i.optional,e.errors);e.currentQueryTotal=a.length;let c=null;a.forEach((l,u)=>{e.currentQueryIndex=u;const f=e.createSubContext(t.options,l);o&&f.delayNextStep(o),l===e.element&&(c=f.currentTimeline),ls(this,t.animation,f),f.currentTimeline.applyStylesToKeyframe(),s=Math.max(s,f.currentTimeline.currentTime)}),e.currentQueryIndex=0,e.currentQueryTotal=0,e.transformIntoNewTimeline(s),c&&(e.currentTimeline.mergeTimelineCollectedStyles(c),e.currentTimeline.snapshotCurrentStyles()),e.previousNode=t}visitStagger(t,e){const n=e.parentContext,i=e.currentTimeline,o=t.timings,s=Math.abs(o.duration),a=s*(e.currentQueryTotal-1);let c=s*e.currentQueryIndex;switch(o.duration<0?"reverse":o.easing){case"reverse":c=a-c;break;case"full":c=n.currentStaggerTime}const u=e.currentTimeline;c&&u.delayNextStep(c);const f=u.currentTime;ls(this,t.animation,e),e.previousNode=t,n.currentStaggerTime=i.currentTime-f+(i.startTime-n.currentTimeline.startTime)}}const am={};class cO{constructor(t,e,n,i,o,s,a,c){this._driver=t,this.element=e,this.subInstructions=n,this._enterClassName=i,this._leaveClassName=o,this.errors=s,this.timelines=a,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=am,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=c||new cm(this._driver,e,0),a.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(t,e){if(!t)return;const n=t;let i=this.options;null!=n.duration&&(i.duration=k3(n.duration)),null!=n.delay&&(i.delay=k3(n.delay));const o=n.params;if(o){let s=i.params;s||(s=this.options.params={}),Object.keys(o).forEach(a=>{(!e||!s.hasOwnProperty(a))&&(s[a]=Of(o[a],s,this.errors))})}}_copyOptions(){const t={};if(this.options){const e=this.options.params;if(e){const n=t.params={};Object.keys(e).forEach(i=>{n[i]=e[i]})}}return t}createSubContext(t=null,e,n){const i=e||this.element,o=new cO(this._driver,i,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(i,n||0));return o.previousNode=this.previousNode,o.currentAnimateTimings=this.currentAnimateTimings,o.options=this._copyOptions(),o.updateOptions(t),o.currentQueryIndex=this.currentQueryIndex,o.currentQueryTotal=this.currentQueryTotal,o.parentContext=this,this.subContextCount++,o}transformIntoNewTimeline(t){return this.previousNode=am,this.currentTimeline=this.currentTimeline.fork(this.element,t),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(t,e,n){const i={duration:e??t.duration,delay:this.currentTimeline.currentTime+(n??0)+t.delay,easing:""},o=new FCe(this._driver,t.element,t.keyframes,t.preStyleProps,t.postStyleProps,i,t.stretchStartingKeyframe);return this.timelines.push(o),i}incrementTime(t){this.currentTimeline.forwardTime(this.currentTimeline.duration+t)}delayNextStep(t){t>0&&this.currentTimeline.delayNextStep(t)}invokeQuery(t,e,n,i,o,s){let a=[];if(i&&a.push(this.element),t.length>0){t=(t=t.replace(zCe,"."+this._enterClassName)).replace(VCe,"."+this._leaveClassName);let l=this._driver.query(this.element,t,1!=n);0!==n&&(l=n<0?l.slice(l.length+n,l.length):l.slice(0,n)),a.push(...l)}return!o&&0==a.length&&s.push(function q_e(r){return new de(3014,!1)}()),a}}class cm{constructor(t,e,n,i){this._driver=t,this.element=e,this.startTime=n,this._elementTimelineStylesLookup=i,this.duration=0,this.easing=null,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(e),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(e,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(t){const e=1===this._keyframes.size&&this._pendingStyles.size;this.duration||e?(this.forwardTime(this.currentTime+t),e&&this.snapshotCurrentStyles()):this.startTime+=t}fork(t,e){return this.applyStylesToKeyframe(),new cm(this._driver,t,e||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(t){this.applyStylesToKeyframe(),this.duration=t,this._loadKeyframe()}_updateStyle(t,e){this._localTimelineStyles.set(t,e),this._globalTimelineStyles.set(t,e),this._styleSummary.set(t,{time:this.currentTime,value:e})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(t){t&&this._previousKeyframe.set("easing",t);for(let[e,n]of this._globalTimelineStyles)this._backFill.set(e,n||I3),this._currentKeyframe.set(e,I3);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(t,e,n,i){e&&this._previousKeyframe.set("easing",e);const o=i&&i.params||{},s=function UCe(r,t){const e=new Map;let n;return r.forEach(i=>{if("*"===i){n??=t.keys();for(let o of n)e.set(o,I3)}else for(let[o,s]of i)e.set(o,s)}),e}(t,this._globalTimelineStyles);for(let[a,c]of s){const l=Of(c,o,n);this._pendingStyles.set(a,l),this._localTimelineStyles.has(a)||this._backFill.set(a,this._globalTimelineStyles.get(a)??I3),this._updateStyle(a,l)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((t,e)=>{this._currentKeyframe.set(e,t)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((t,e)=>{this._currentKeyframe.has(e)||this._currentKeyframe.set(e,t)}))}snapshotCurrentStyles(){for(let[t,e]of this._localTimelineStyles)this._pendingStyles.set(t,e),this._updateStyle(t,e)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const t=[];for(let e in this._currentKeyframe)t.push(e);return t}mergeTimelineCollectedStyles(t){t._styleSummary.forEach((e,n)=>{const i=this._styleSummary.get(n);(!i||e.time>i.time)&&this._updateStyle(n,e.value)})}buildKeyframes(){this.applyStylesToKeyframe();const t=new Set,e=new Set,n=1===this._keyframes.size&&0===this.duration;let i=[];this._keyframes.forEach((a,c)=>{const l=new Map([...this._backFill,...a]);l.forEach((u,f)=>{"!"===u?t.add(f):u===I3&&e.add(f)}),n||l.set("offset",c/this.duration),i.push(l)});const o=[...t.values()],s=[...e.values()];if(n){const a=i[0],c=new Map(a);a.set("offset",0),c.set("offset",1),i=[a,c]}return sO(this.element,i,o,s,this.duration,this.startTime,this.easing,!1)}}class FCe extends cm{constructor(t,e,n,i,o,s,a=!1){super(t,e,s.delay),this.keyframes=n,this.preStyleProps=i,this.postStyleProps=o,this._stretchStartingKeyframe=a,this.timings={duration:s.duration,delay:s.delay,easing:s.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let t=this.keyframes,{delay:e,duration:n,easing:i}=this.timings;if(this._stretchStartingKeyframe&&e){const o=[],s=n+e,a=e/s,c=new Map(t[0]);c.set("offset",0),o.push(c);const l=new Map(t[0]);l.set("offset",J$(a)),o.push(l);const u=t.length-1;for(let f=1;f<=u;f++){let g=new Map(t[f]);const y=g.get("offset");g.set("offset",J$((e+y*n)/s)),o.push(g)}n=s,e=0,i="",t=o}return sO(this.element,t,this.preStyleProps,this.postStyleProps,n,e,i,!0)}}function J$(r,t=3){const e=Math.pow(10,t-1);return Math.round(r*e)/e}function eW(r,t,e,n,i,o,s,a,c,l,u,f,g){return{type:0,element:r,triggerName:t,isRemovalTransition:i,fromState:e,fromStyles:o,toState:n,toStyles:s,timelines:a,queriedElements:c,preStyleProps:l,postStyleProps:u,totalTime:f,errors:g}}const lO={};class tW{constructor(t,e,n){this._triggerName=t,this.ast=e,this._stateStyles=n}match(t,e,n,i){return function GCe(r,t,e,n,i){return r.some(o=>o(t,e,n,i))}(this.ast.matchers,t,e,n,i)}buildStyles(t,e,n){let i=this._stateStyles.get("*");return void 0!==t&&(i=this._stateStyles.get(t?.toString())||i),i?i.buildStyles(e,n):new Map}build(t,e,n,i,o,s,a,c,l,u){const f=[],g=this.ast.options&&this.ast.options.params||lO,S=this.buildStyles(n,a&&a.params||lO,f),N=c&&c.params||lO,R=this.buildStyles(i,N,f),U=new Set,$=new Map,re=new Map,_e="void"===i,be={params:nW(N,g),delay:this.ast.options?.delay},Ve=u?[]:aO(t,e,this.ast.animation,o,s,S,R,be,l,f);let dt=0;return Ve.forEach(Xt=>{dt=Math.max(Xt.duration+Xt.delay,dt)}),f.length?eW(e,this._triggerName,n,i,_e,S,R,[],[],$,re,dt,f):(Ve.forEach(Xt=>{const u1=Xt.element,an=cs($,u1,new Set);Xt.preStyleProps.forEach(l3=>an.add(l3));const Qd=cs(re,u1,new Set);Xt.postStyleProps.forEach(l3=>Qd.add(l3)),u1!==e&&U.add(u1)}),eW(e,this._triggerName,n,i,_e,S,R,Ve,[...U.values()],$,re,dt))}}function nW(r,t){const e={...t};return Object.entries(r).forEach(([n,i])=>{null!=i&&(e[n]=i)}),e}class BCe{constructor(t,e,n){this.styles=t,this.defaultParams=e,this.normalizer=n}buildStyles(t,e){const n=new Map,i=nW(t,this.defaultParams);return this.styles.styles.forEach(o=>{"string"!=typeof o&&o.forEach((s,a)=>{s&&(s=Of(s,i,e));const c=this.normalizer.normalizePropertyName(a,e);s=this.normalizer.normalizeStyleValue(a,c,s,e),n.set(a,s)})}),n}}class WCe{constructor(t,e,n){this.name=t,this.ast=e,this._normalizer=n,this.transitionFactories=[],this.states=new Map,e.states.forEach(i=>{this.states.set(i.name,new BCe(i.style,i.options&&i.options.params||{},n))}),rW(this.states,"true","1"),rW(this.states,"false","0"),e.transitions.forEach(i=>{this.transitionFactories.push(new tW(t,i,this.states))}),this.fallbackTransition=function qCe(r,t,e){return new tW(r,{type:qt.Transition,animation:{type:qt.Sequence,steps:[],options:null},matchers:[(s,a)=>!0],options:null,queryCount:0,depCount:0},t)}(t,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(t,e,n,i){return this.transitionFactories.find(s=>s.match(t,e,n,i))||null}matchStyles(t,e,n){return this.fallbackTransition.buildStyles(t,e,n)}}function rW(r,t,e){r.has(t)?r.has(e)||r.set(e,r.get(t)):r.has(e)&&r.set(t,r.get(e))}const jCe=new sm;class ZCe{constructor(t,e,n){this.bodyNode=t,this._driver=e,this._normalizer=n,this._animations=new Map,this._playersById=new Map,this.players=[]}register(t,e){const n=[],o=iO(this._driver,e,n,[]);if(n.length)throw function J_e(r){return new de(3503,!1)}();this._animations.set(t,o)}_buildPlayer(t,e,n){const i=t.element,o=F$(this._normalizer,t.keyframes,e,n);return this._driver.animate(i,o,t.duration,t.delay,t.easing,[],!0)}create(t,e,n={}){const i=[],o=this._animations.get(t);let s;const a=new Map;if(o?(s=aO(this._driver,e,o,QS,Jp,new Map,new Map,n,jCe,i),s.forEach(u=>{const f=cs(a,u.element,new Map);u.postStyleProps.forEach(g=>f.set(g,null))})):(i.push(function eCe(){return new de(3300,!1)}()),s=[]),i.length)throw function tCe(r){return new de(3504,!1)}();a.forEach((u,f)=>{u.forEach((g,y)=>{u.set(y,this._driver.computeStyle(f,y,I3))})});const l=j4(s.map(u=>{const f=a.get(u.element);return this._buildPlayer(u,new Map,f)}));return this._playersById.set(t,l),l.onDestroy(()=>this.destroy(t)),this.players.push(l),l}destroy(t){const e=this._getPlayer(t);e.destroy(),this._playersById.delete(t);const n=this.players.indexOf(e);n>=0&&this.players.splice(n,1)}_getPlayer(t){const e=this._playersById.get(t);if(!e)throw function nCe(r){return new de(3301,!1)}();return e}listen(t,e,n,i){const o=jS(e,"","","");return WS(this._getPlayer(t),n,o,i),()=>{}}command(t,e,n,i){if("register"==n)return void this.register(t,i[0]);if("create"==n)return void this.create(t,e,i[0]||{});const o=this._getPlayer(t);switch(n){case"play":o.play();break;case"pause":o.pause();break;case"reset":o.reset();break;case"restart":o.restart();break;case"finish":o.finish();break;case"init":o.init();break;case"setPosition":o.setPosition(parseFloat(i[0]));break;case"destroy":this.destroy(t)}}}const iW="ng-animate-queued",uO="ng-animate-disabled",JCe=[],oW={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},eve={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},Ra="__ng_removed";class fO{get params(){return this.options.params}constructor(t,e=""){this.namespaceId=e;const n=t&&t.hasOwnProperty("value");if(this.value=function ive(r){return r??null}(n?t.value:t),n){const{value:o,...s}=t;this.options=s}else this.options={};this.options.params||(this.options.params={})}absorbOptions(t){const e=t.params;if(e){const n=this.options.params;Object.keys(e).forEach(i=>{null==n[i]&&(n[i]=e[i])})}}}const Tf="void",dO=new fO(Tf);class tve{constructor(t,e,n){this.id=t,this.hostElement=e,this._engine=n,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+t,Bs(e,this._hostClassName)}listen(t,e,n,i){if(!this._triggers.has(e))throw function rCe(r,t){return new de(3302,!1)}();if(null==n||0==n.length)throw function iCe(r){return new de(3303,!1)}();if(!function ove(r){return"start"==r||"done"==r}(n))throw function oCe(r,t){return new de(3400,!1)}();const o=cs(this._elementListeners,t,[]),s={name:e,phase:n,callback:i};o.push(s);const a=cs(this._engine.statesByElement,t,new Map);return a.has(e)||(Bs(t,em),Bs(t,em+"-"+e),a.set(e,dO)),()=>{this._engine.afterFlush(()=>{const c=o.indexOf(s);c>=0&&o.splice(c,1),this._triggers.has(e)||a.delete(e)})}}register(t,e){return!this._triggers.has(t)&&(this._triggers.set(t,e),!0)}_getTrigger(t){const e=this._triggers.get(t);if(!e)throw function sCe(r){return new de(3401,!1)}();return e}trigger(t,e,n,i=!0){const o=this._getTrigger(e),s=new hO(this.id,e,t);let a=this._engine.statesByElement.get(t);a||(Bs(t,em),Bs(t,em+"-"+e),this._engine.statesByElement.set(t,a=new Map));let c=a.get(e);const l=new fO(n,this.id);if(!(n&&n.hasOwnProperty("value"))&&c&&l.absorbOptions(c.options),a.set(e,l),c||(c=dO),l.value!==Tf&&c.value===l.value){if(!function cve(r,t){const e=Object.keys(r),n=Object.keys(t);if(e.length!=n.length)return!1;for(let i=0;i<e.length;i++){const o=e[i];if(!t.hasOwnProperty(o)||r[o]!==t[o])return!1}return!0}(c.params,l.params)){const N=[],R=o.matchStyles(c.value,c.params,N),U=o.matchStyles(l.value,l.params,N);N.length?this._engine.reportError(N):this._engine.afterFlush(()=>{_6(t,R),wc(t,U)})}return}const g=cs(this._engine.playersByElement,t,[]);g.forEach(N=>{N.namespaceId==this.id&&N.triggerName==e&&N.queued&&N.destroy()});let y=o.matchTransition(c.value,l.value,t,l.params),S=!1;if(!y){if(!i)return;y=o.fallbackTransition,S=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:e,transition:y,fromState:c,toState:l,player:s,isFallbackTransition:S}),S||(Bs(t,iW),s.onStart(()=>{Y8(t,iW)})),s.onDone(()=>{let N=this.players.indexOf(s);N>=0&&this.players.splice(N,1);const R=this._engine.playersByElement.get(t);if(R){let U=R.indexOf(s);U>=0&&R.splice(U,1)}}),this.players.push(s),g.push(s),s}deregister(t){this._triggers.delete(t),this._engine.statesByElement.forEach(e=>e.delete(t)),this._elementListeners.forEach((e,n)=>{this._elementListeners.set(n,e.filter(i=>i.name!=t))})}clearElementCache(t){this._engine.statesByElement.delete(t),this._elementListeners.delete(t);const e=this._engine.playersByElement.get(t);e&&(e.forEach(n=>n.destroy()),this._engine.playersByElement.delete(t))}_signalRemovalForInnerTriggers(t,e){const n=this._engine.driver.query(t,tm,!0);n.forEach(i=>{if(i[Ra])return;const o=this._engine.fetchNamespacesByElement(i);o.size?o.forEach(s=>s.triggerLeaveAnimation(i,e,!1,!0)):this.clearElementCache(i)}),this._engine.afterFlushAnimationsDone(()=>n.forEach(i=>this.clearElementCache(i)))}triggerLeaveAnimation(t,e,n,i){const o=this._engine.statesByElement.get(t),s=new Map;if(o){const a=[];if(o.forEach((c,l)=>{if(s.set(l,c.value),this._triggers.has(l)){const u=this.trigger(t,l,Tf,i);u&&a.push(u)}}),a.length)return this._engine.markElementAsRemoved(this.id,t,!0,e,s),n&&j4(a).onDone(()=>this._engine.processLeaveNode(t)),!0}return!1}prepareLeaveAnimationListeners(t){const e=this._elementListeners.get(t),n=this._engine.statesByElement.get(t);if(e&&n){const i=new Set;e.forEach(o=>{const s=o.name;if(i.has(s))return;i.add(s);const c=this._triggers.get(s).fallbackTransition,l=n.get(s)||dO,u=new fO(Tf),f=new hO(this.id,s,t);this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:s,transition:c,fromState:l,toState:u,player:f,isFallbackTransition:!0})})}}removeNode(t,e){const n=this._engine;if(t.childElementCount&&this._signalRemovalForInnerTriggers(t,e),this.triggerLeaveAnimation(t,e,!0))return;let i=!1;if(n.totalAnimations){const o=n.players.length?n.playersByQueriedElement.get(t):[];if(o&&o.length)i=!0;else{let s=t;for(;s=s.parentNode;)if(n.statesByElement.get(s)){i=!0;break}}}if(this.prepareLeaveAnimationListeners(t),i)n.markElementAsRemoved(this.id,t,!1,e);else{const o=t[Ra];(!o||o===oW)&&(n.afterFlush(()=>this.clearElementCache(t)),n.destroyInnerAnimations(t),n._onRemovalComplete(t,e))}}insertNode(t,e){Bs(t,this._hostClassName)}drainQueuedTransitions(t){const e=[];return this._queue.forEach(n=>{const i=n.player;if(i.destroyed)return;const o=n.element,s=this._elementListeners.get(o);s&&s.forEach(a=>{if(a.name==n.triggerName){const c=jS(o,n.triggerName,n.fromState.value,n.toState.value);c._data=t,WS(n.player,a.phase,c,a.callback)}}),i.markedForDestroy?this._engine.afterFlush(()=>{i.destroy()}):e.push(n)}),this._queue=[],e.sort((n,i)=>{const o=n.transition.ast.depCount,s=i.transition.ast.depCount;return 0==o||0==s?o-s:this._engine.driver.containsElement(n.element,i.element)?1:-1})}destroy(t){this.players.forEach(e=>e.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,t)}}class nve{_onRemovalComplete(t,e){this.onRemovalComplete(t,e)}constructor(t,e,n,i){this.bodyNode=t,this.driver=e,this._normalizer=n,this.scheduler=i,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(o,s)=>{}}get queuedPlayers(){const t=[];return this._namespaceList.forEach(e=>{e.players.forEach(n=>{n.queued&&t.push(n)})}),t}createNamespace(t,e){const n=new tve(t,e,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,e)?this._balanceNamespaceList(n,e):(this.newHostElements.set(e,n),this.collectEnterElement(e)),this._namespaceLookup[t]=n}_balanceNamespaceList(t,e){const n=this._namespaceList,i=this.namespacesByHostElement;if(n.length-1>=0){let s=!1,a=this.driver.getParentElement(e);for(;a;){const c=i.get(a);if(c){const l=n.indexOf(c);n.splice(l+1,0,t),s=!0;break}a=this.driver.getParentElement(a)}s||n.unshift(t)}else n.push(t);return i.set(e,t),t}register(t,e){let n=this._namespaceLookup[t];return n||(n=this.createNamespace(t,e)),n}registerTrigger(t,e,n){let i=this._namespaceLookup[t];i&&i.register(e,n)&&this.totalAnimations++}destroy(t,e){t&&(this.afterFlush(()=>{}),this.afterFlushAnimationsDone(()=>{const n=this._fetchNamespace(t);this.namespacesByHostElement.delete(n.hostElement);const i=this._namespaceList.indexOf(n);i>=0&&this._namespaceList.splice(i,1),n.destroy(e),delete this._namespaceLookup[t]}))}_fetchNamespace(t){return this._namespaceLookup[t]}fetchNamespacesByElement(t){const e=new Set,n=this.statesByElement.get(t);if(n)for(let i of n.values())if(i.namespaceId){const o=this._fetchNamespace(i.namespaceId);o&&e.add(o)}return e}trigger(t,e,n,i){if(lm(e)){const o=this._fetchNamespace(t);if(o)return o.trigger(e,n,i),!0}return!1}insertNode(t,e,n,i){if(!lm(e))return;const o=e[Ra];if(o&&o.setForRemoval){o.setForRemoval=!1,o.setForMove=!0;const s=this.collectedLeaveElements.indexOf(e);s>=0&&this.collectedLeaveElements.splice(s,1)}if(t){const s=this._fetchNamespace(t);s&&s.insertNode(e,n)}i&&this.collectEnterElement(e)}collectEnterElement(t){this.collectedEnterElements.push(t)}markElementAsDisabled(t,e){e?this.disabledNodes.has(t)||(this.disabledNodes.add(t),Bs(t,uO)):this.disabledNodes.has(t)&&(this.disabledNodes.delete(t),Y8(t,uO))}removeNode(t,e,n){if(lm(e)){this.scheduler?.notify();const i=t?this._fetchNamespace(t):null;i?i.removeNode(e,n):this.markElementAsRemoved(t,e,!1,n);const o=this.namespacesByHostElement.get(e);o&&o.id!==t&&o.removeNode(e,n)}else this._onRemovalComplete(e,n)}markElementAsRemoved(t,e,n,i,o){this.collectedLeaveElements.push(e),e[Ra]={namespaceId:t,setForRemoval:i,hasAnimation:n,removedBeforeQueried:!1,previousTriggersValues:o}}listen(t,e,n,i,o){return lm(e)?this._fetchNamespace(t).listen(e,n,i,o):()=>{}}_buildInstruction(t,e,n,i,o){return t.transition.build(this.driver,t.element,t.fromState.value,t.toState.value,n,i,t.fromState.options,t.toState.options,e,o)}destroyInnerAnimations(t){let e=this.driver.query(t,tm,!0);e.forEach(n=>this.destroyActiveAnimationsForElement(n)),0!=this.playersByQueriedElement.size&&(e=this.driver.query(t,JS,!0),e.forEach(n=>this.finishActiveQueriedAnimationOnElement(n)))}destroyActiveAnimationsForElement(t){const e=this.playersByElement.get(t);e&&e.forEach(n=>{n.queued?n.markedForDestroy=!0:n.destroy()})}finishActiveQueriedAnimationOnElement(t){const e=this.playersByQueriedElement.get(t);e&&e.forEach(n=>n.finish())}whenRenderingDone(){return new Promise(t=>{if(this.players.length)return j4(this.players).onDone(()=>t());t()})}processLeaveNode(t){const e=t[Ra];if(e&&e.setForRemoval){if(t[Ra]=oW,e.namespaceId){this.destroyInnerAnimations(t);const n=this._fetchNamespace(e.namespaceId);n&&n.clearElementCache(t)}this._onRemovalComplete(t,e.setForRemoval)}t.classList?.contains(uO)&&this.markElementAsDisabled(t,!1),this.driver.query(t,".ng-animate-disabled",!0).forEach(n=>{this.markElementAsDisabled(n,!1)})}flush(t=-1){let e=[];if(this.newHostElements.size&&(this.newHostElements.forEach((n,i)=>this._balanceNamespaceList(n,i)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let n=0;n<this.collectedEnterElements.length;n++)Bs(this.collectedEnterElements[n],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const n=[];try{e=this._flushAnimations(n,t)}finally{for(let i=0;i<n.length;i++)n[i]()}}else for(let n=0;n<this.collectedLeaveElements.length;n++)this.processLeaveNode(this.collectedLeaveElements[n]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(n=>n()),this._flushFns=[],this._whenQuietFns.length){const n=this._whenQuietFns;this._whenQuietFns=[],e.length?j4(e).onDone(()=>{n.forEach(i=>i())}):n.forEach(i=>i())}}reportError(t){throw function aCe(r){return new de(3402,!1)}()}_flushAnimations(t,e){const n=new sm,i=[],o=new Map,s=[],a=new Map,c=new Map,l=new Map,u=new Set;this.disabledNodes.forEach(ht=>{u.add(ht);const Tt=this.driver.query(ht,".ng-animate-queued",!0);for(let Lt=0;Lt<Tt.length;Lt++)u.add(Tt[Lt])});const f=this.bodyNode,g=Array.from(this.statesByElement.keys()),y=cW(g,this.collectedEnterElements),S=new Map;let N=0;y.forEach((ht,Tt)=>{const Lt=QS+N++;S.set(Tt,Lt),ht.forEach(Un=>Bs(Un,Lt))});const R=[],U=new Set,$=new Set;for(let ht=0;ht<this.collectedLeaveElements.length;ht++){const Tt=this.collectedLeaveElements[ht],Lt=Tt[Ra];Lt&&Lt.setForRemoval&&(R.push(Tt),U.add(Tt),Lt.hasAnimation?this.driver.query(Tt,".ng-star-inserted",!0).forEach(Un=>U.add(Un)):$.add(Tt))}const re=new Map,_e=cW(g,Array.from(U));_e.forEach((ht,Tt)=>{const Lt=Jp+N++;re.set(Tt,Lt),ht.forEach(Un=>Bs(Un,Lt))}),t.push(()=>{y.forEach((ht,Tt)=>{const Lt=S.get(Tt);ht.forEach(Un=>Y8(Un,Lt))}),_e.forEach((ht,Tt)=>{const Lt=re.get(Tt);ht.forEach(Un=>Y8(Un,Lt))}),R.forEach(ht=>{this.processLeaveNode(ht)})});const be=[],Ve=[];for(let ht=this._namespaceList.length-1;ht>=0;ht--)this._namespaceList[ht].drainQueuedTransitions(e).forEach(Lt=>{const Un=Lt.player,ti=Lt.element;if(be.push(Un),this.collectedEnterElements.length){const Q2=ti[Ra];if(Q2&&Q2.setForMove){if(Q2.previousTriggersValues&&Q2.previousTriggersValues.has(Lt.triggerName)){const M0=Q2.previousTriggersValues.get(Lt.triggerName),ma=this.statesByElement.get(Lt.element);if(ma&&ma.has(Lt.triggerName)){const Iv=ma.get(Lt.triggerName);Iv.value=M0,ma.set(Lt.triggerName,Iv)}}return void Un.destroy()}}const Qt=!f||!this.driver.containsElement(f,ti),Ns=re.get(ti),Dl=S.get(ti),Sr=this._buildInstruction(Lt,n,Dl,Ns,Qt);if(Sr.errors&&Sr.errors.length)return void Ve.push(Sr);if(Qt)return Un.onStart(()=>_6(ti,Sr.fromStyles)),Un.onDestroy(()=>wc(ti,Sr.toStyles)),void i.push(Un);if(Lt.isFallbackTransition)return Un.onStart(()=>_6(ti,Sr.fromStyles)),Un.onDestroy(()=>wc(ti,Sr.toStyles)),void i.push(Un);const Use=[];Sr.timelines.forEach(Q2=>{Q2.stretchStartingKeyframe=!0,this.disabledNodes.has(Q2.element)||Use.push(Q2)}),Sr.timelines=Use,n.append(ti,Sr.timelines),s.push({instruction:Sr,player:Un,element:ti}),Sr.queriedElements.forEach(Q2=>cs(a,Q2,[]).push(Un)),Sr.preStyleProps.forEach((Q2,M0)=>{if(Q2.size){let ma=c.get(M0);ma||c.set(M0,ma=new Set),Q2.forEach((Iv,mR)=>ma.add(mR))}}),Sr.postStyleProps.forEach((Q2,M0)=>{let ma=l.get(M0);ma||l.set(M0,ma=new Set),Q2.forEach((Iv,mR)=>ma.add(mR))})});if(Ve.length){const ht=[];Ve.forEach(Tt=>{ht.push(function cCe(r,t){return new de(3505,!1)}())}),be.forEach(Tt=>Tt.destroy()),this.reportError(ht)}const dt=new Map,Xt=new Map;s.forEach(ht=>{const Tt=ht.element;n.has(Tt)&&(Xt.set(Tt,Tt),this._beforeAnimationBuild(ht.player.namespaceId,ht.instruction,dt))}),i.forEach(ht=>{const Tt=ht.element;this._getPreviousPlayers(Tt,!1,ht.namespaceId,ht.triggerName,null).forEach(Un=>{cs(dt,Tt,[]).push(Un),Un.destroy()})});const u1=R.filter(ht=>uW(ht,c,l)),an=new Map;aW(an,this.driver,$,l,I3).forEach(ht=>{uW(ht,c,l)&&u1.push(ht)});const l3=new Map;y.forEach((ht,Tt)=>{aW(l3,this.driver,new Set(ht),c,"!")}),u1.forEach(ht=>{const Tt=an.get(ht),Lt=l3.get(ht);an.set(ht,new Map([...Tt?.entries()??[],...Lt?.entries()??[]]))});const Nu=[],Jd=[],eh={};s.forEach(ht=>{const{element:Tt,player:Lt,instruction:Un}=ht;if(n.has(Tt)){if(u.has(Tt))return Lt.onDestroy(()=>wc(Tt,Un.toStyles)),Lt.disabled=!0,Lt.overrideTotalTime(Un.totalTime),void i.push(Lt);let ti=eh;if(Xt.size>1){let Ns=Tt;const Dl=[];for(;Ns=Ns.parentNode;){const Sr=Xt.get(Ns);if(Sr){ti=Sr;break}Dl.push(Ns)}Dl.forEach(Sr=>Xt.set(Sr,ti))}const Qt=this._buildAnimation(Lt.namespaceId,Un,dt,o,l3,an);if(Lt.setRealPlayer(Qt),ti===eh)Nu.push(Lt);else{const Ns=this.playersByElement.get(ti);Ns&&Ns.length&&(Lt.parentPlayer=j4(Ns)),i.push(Lt)}}else _6(Tt,Un.fromStyles),Lt.onDestroy(()=>wc(Tt,Un.toStyles)),Jd.push(Lt),u.has(Tt)&&i.push(Lt)}),Jd.forEach(ht=>{const Tt=o.get(ht.element);if(Tt&&Tt.length){const Lt=j4(Tt);ht.setRealPlayer(Lt)}}),i.forEach(ht=>{ht.parentPlayer?ht.syncPlayerEvents(ht.parentPlayer):ht.destroy()});for(let ht=0;ht<R.length;ht++){const Tt=R[ht],Lt=Tt[Ra];if(Y8(Tt,Jp),Lt&&Lt.hasAnimation)continue;let Un=[];if(a.size){let Qt=a.get(Tt);Qt&&Qt.length&&Un.push(...Qt);let Ns=this.driver.query(Tt,JS,!0);for(let Dl=0;Dl<Ns.length;Dl++){let Sr=a.get(Ns[Dl]);Sr&&Sr.length&&Un.push(...Sr)}}const ti=Un.filter(Qt=>!Qt.destroyed);ti.length?sve(this,Tt,ti):this.processLeaveNode(Tt)}return R.length=0,Nu.forEach(ht=>{this.players.push(ht),ht.onDone(()=>{ht.destroy();const Tt=this.players.indexOf(ht);this.players.splice(Tt,1)}),ht.play()}),Nu}afterFlush(t){this._flushFns.push(t)}afterFlushAnimationsDone(t){this._whenQuietFns.push(t)}_getPreviousPlayers(t,e,n,i,o){let s=[];if(e){const a=this.playersByQueriedElement.get(t);a&&(s=a)}else{const a=this.playersByElement.get(t);if(a){const c=!o||o==Tf;a.forEach(l=>{l.queued||!c&&l.triggerName!=i||s.push(l)})}}return(n||i)&&(s=s.filter(a=>!(n&&n!=a.namespaceId||i&&i!=a.triggerName))),s}_beforeAnimationBuild(t,e,n){const o=e.element,s=e.isRemovalTransition?void 0:t,a=e.isRemovalTransition?void 0:e.triggerName;for(const c of e.timelines){const l=c.element,u=l!==o,f=cs(n,l,[]);this._getPreviousPlayers(l,u,s,a,e.toState).forEach(y=>{const S=y.getRealPlayer();S.beforeDestroy&&S.beforeDestroy(),y.destroy(),f.push(y)})}_6(o,e.fromStyles)}_buildAnimation(t,e,n,i,o,s){const a=e.triggerName,c=e.element,l=[],u=new Set,f=new Set,g=e.timelines.map(S=>{const N=S.element;u.add(N);const R=N[Ra];if(R&&R.removedBeforeQueried)return new Pf(S.duration,S.delay);const U=N!==c,$=function ave(r){const t=[];return lW(r,t),t}((n.get(N)||JCe).map(dt=>dt.getRealPlayer())).filter(dt=>!!dt.element&&dt.element===N),re=o.get(N),_e=s.get(N),be=F$(this._normalizer,S.keyframes,re,_e),Ve=this._buildPlayer(S,be,$);if(S.subTimeline&&i&&f.add(N),U){const dt=new hO(t,a,N);dt.setRealPlayer(Ve),l.push(dt)}return Ve});l.forEach(S=>{cs(this.playersByQueriedElement,S.element,[]).push(S),S.onDone(()=>function rve(r,t,e){let n=r.get(t);if(n){if(n.length){const i=n.indexOf(e);n.splice(i,1)}0==n.length&&r.delete(t)}return n}(this.playersByQueriedElement,S.element,S))}),u.forEach(S=>Bs(S,q$));const y=j4(g);return y.onDestroy(()=>{u.forEach(S=>Y8(S,q$)),wc(c,e.toStyles)}),f.forEach(S=>{cs(i,S,[]).push(y)}),y}_buildPlayer(t,e,n){return e.length>0?this.driver.animate(t.element,e,t.duration,t.delay,t.easing,n):new Pf(t.duration,t.delay)}}class hO{constructor(t,e,n){this.namespaceId=t,this.triggerName=e,this.element=n,this._player=new Pf,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.parentPlayer=null,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(t){this._containsRealPlayer||(this._player=t,this._queuedCallbacks.forEach((e,n)=>{e.forEach(i=>WS(t,n,void 0,i))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(t.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(t){this.totalTime=t}syncPlayerEvents(t){const e=this._player;e.triggerCallback&&t.onStart(()=>e.triggerCallback("start")),t.onDone(()=>this.finish()),t.onDestroy(()=>this.destroy())}_queueEvent(t,e){cs(this._queuedCallbacks,t,[]).push(e)}onDone(t){this.queued&&this._queueEvent("done",t),this._player.onDone(t)}onStart(t){this.queued&&this._queueEvent("start",t),this._player.onStart(t)}onDestroy(t){this.queued&&this._queueEvent("destroy",t),this._player.onDestroy(t)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(t){this.queued||this._player.setPosition(t)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(t){const e=this._player;e.triggerCallback&&e.triggerCallback(t)}}function lm(r){return r&&1===r.nodeType}function sW(r,t){const e=r.style.display;return r.style.display=t??"none",e}function aW(r,t,e,n,i){const o=[];e.forEach(c=>o.push(sW(c)));const s=[];n.forEach((c,l)=>{const u=new Map;c.forEach(f=>{const g=t.computeStyle(l,f,i);u.set(f,g),(!g||0==g.length)&&(l[Ra]=eve,s.push(l))}),r.set(l,u)});let a=0;return e.forEach(c=>sW(c,o[a++])),s}function cW(r,t){const e=new Map;if(r.forEach(a=>e.set(a,[])),0==t.length)return e;const i=new Set(t),o=new Map;function s(a){if(!a)return 1;let c=o.get(a);if(c)return c;const l=a.parentNode;return c=e.has(l)?l:i.has(l)?1:s(l),o.set(a,c),c}return t.forEach(a=>{const c=s(a);1!==c&&e.get(c).push(a)}),e}function Bs(r,t){r.classList?.add(t)}function Y8(r,t){r.classList?.remove(t)}function sve(r,t,e){j4(e).onDone(()=>r.processLeaveNode(t))}function lW(r,t){for(let e=0;e<r.length;e++){const n=r[e];n instanceof V$?lW(n.players,t):t.push(n)}}function uW(r,t,e){const n=e.get(r);if(!n)return!1;let i=t.get(r);return i?n.forEach(o=>i.add(o)):t.set(r,n),e.delete(r),!0}class wf{constructor(t,e,n,i){this._driver=e,this._normalizer=n,this._triggerCache={},this.onRemovalComplete=(o,s)=>{},this._transitionEngine=new nve(t.body,e,n,i),this._timelineEngine=new ZCe(t.body,e,n),this._transitionEngine.onRemovalComplete=(o,s)=>this.onRemovalComplete(o,s)}registerTrigger(t,e,n,i,o){const s=t+"-"+i;let a=this._triggerCache[s];if(!a){const c=[],u=iO(this._driver,o,c,[]);if(c.length)throw function X_e(r,t){return new de(3404,!1)}();a=function $Ce(r,t,e){return new WCe(r,t,e)}(i,u,this._normalizer),this._triggerCache[s]=a}this._transitionEngine.registerTrigger(e,i,a)}register(t,e){this._transitionEngine.register(t,e)}destroy(t,e){this._transitionEngine.destroy(t,e)}onInsert(t,e,n,i){this._transitionEngine.insertNode(t,e,n,i)}onRemove(t,e,n){this._transitionEngine.removeNode(t,e,n)}disableAnimations(t,e){this._transitionEngine.markElementAsDisabled(t,e)}process(t,e,n,i){if("@"==n.charAt(0)){const[o,s]=U$(n);this._timelineEngine.command(o,e,s,i)}else this._transitionEngine.trigger(t,e,n,i)}listen(t,e,n,i,o){if("@"==n.charAt(0)){const[s,a]=U$(n);return this._timelineEngine.listen(s,e,a,o)}return this._transitionEngine.listen(t,e,n,i,o)}flush(t=-1){this._transitionEngine.flush(t)}get players(){return[...this._transitionEngine.players,...this._timelineEngine.players]}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}afterFlushAnimationsDone(t){this._transitionEngine.afterFlushAnimationsDone(t)}}class bf{static#e=this.initialStylesByElement=new WeakMap;constructor(t,e,n){this._element=t,this._startStyles=e,this._endStyles=n,this._state=0;let i=bf.initialStylesByElement.get(t);i||bf.initialStylesByElement.set(t,i=new Map),this._initialStyles=i}start(){this._state<1&&(this._startStyles&&wc(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(wc(this._element,this._initialStyles),this._endStyles&&(wc(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(bf.initialStylesByElement.delete(this._element),this._startStyles&&(_6(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(_6(this._element,this._endStyles),this._endStyles=null),wc(this._element,this._initialStyles),this._state=3)}}function gO(r){let t=null;return r.forEach((e,n)=>{(function uve(r){return"display"===r||"position"===r})(n)&&(t=t||new Map,t.set(n,e))}),t}class fW{constructor(t,e,n,i){this.element=t,this.keyframes=e,this.options=n,this._specialStyles=i,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=n.duration,this._delay=n.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const t=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,t,this.options),this._finalKeyframe=t.length?t[t.length-1]:new Map;const e=()=>this._onFinish();this.domPlayer.addEventListener("finish",e),this.onDestroy(()=>{this.domPlayer.removeEventListener("finish",e)})}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(t){const e=[];return t.forEach(n=>{e.push(Object.fromEntries(n))}),e}_triggerWebAnimation(t,e,n){return t.animate(this._convertKeyframesToObject(e),n)}onStart(t){this._originalOnStartFns.push(t),this._onStartFns.push(t)}onDone(t){this._originalOnDoneFns.push(t),this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(t=>t()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}setPosition(t){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=t*this.time}getPosition(){return+(this.domPlayer.currentTime??0)/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const t=new Map;this.hasStarted()&&this._finalKeyframe.forEach((n,i)=>{"offset"!==i&&t.set(i,this._finished?n:rO(this.element,i))}),this.currentSnapshot=t}triggerCallback(t){const e="start"===t?this._onStartFns:this._onDoneFns;e.forEach(n=>n()),e.length=0}}class dW{validateStyleProperty(t){return!0}validateAnimatableStyleProperty(t){return!0}matchesElement(t,e){return!1}containsElement(t,e){return B$(t,e)}getParentElement(t){return ZS(t)}query(t,e,n){return $$(t,e,n)}computeStyle(t,e,n){return rO(t,e)}animate(t,e,n,i,o,s=[]){const c={duration:n,delay:i,fill:0==i?"both":"forwards"};o&&(c.easing=o);const l=new Map,u=s.filter(y=>y instanceof fW);(function MCe(r,t){return 0===r||0===t})(n,i)&&u.forEach(y=>{y.currentSnapshot.forEach((S,N)=>l.set(N,S))});let f=function CCe(r){return r.length?r[0]instanceof Map?r:r.map(t=>new Map(Object.entries(t))):[]}(e).map(y=>new Map(y));f=function ECe(r,t,e){if(e.size&&t.length){let n=t[0],i=[];if(e.forEach((o,s)=>{n.has(s)||i.push(s),n.set(s,o)}),i.length)for(let o=1;o<t.length;o++){let s=t[o];i.forEach(a=>s.set(a,rO(r,a)))}}return t}(t,f,l);const g=function lve(r,t){let e=null,n=null;return Array.isArray(t)&&t.length?(e=gO(t[0]),t.length>1&&(n=gO(t[t.length-1]))):t instanceof Map&&(e=gO(t)),e||n?new bf(r,e,n):null}(t,f);return new fW(t,f,c,g)}}const hW="@.disabled";class gW{constructor(t,e,n,i){this.namespaceId=t,this.delegate=e,this.engine=n,this._onDestroy=i,this.\u0275type=0}get data(){return this.delegate.data}destroyNode(t){this.delegate.destroyNode?.(t)}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.engine.afterFlushAnimationsDone(()=>{queueMicrotask(()=>{this.delegate.destroy()})}),this._onDestroy?.()}createElement(t,e){return this.delegate.createElement(t,e)}createComment(t){return this.delegate.createComment(t)}createText(t){return this.delegate.createText(t)}appendChild(t,e){this.delegate.appendChild(t,e),this.engine.onInsert(this.namespaceId,e,t,!1)}insertBefore(t,e,n,i=!0){this.delegate.insertBefore(t,e,n),this.engine.onInsert(this.namespaceId,e,t,i)}removeChild(t,e,n){this.engine.onRemove(this.namespaceId,e,this.delegate)}selectRootElement(t,e){return this.delegate.selectRootElement(t,e)}parentNode(t){return this.delegate.parentNode(t)}nextSibling(t){return this.delegate.nextSibling(t)}setAttribute(t,e,n,i){this.delegate.setAttribute(t,e,n,i)}removeAttribute(t,e,n){this.delegate.removeAttribute(t,e,n)}addClass(t,e){this.delegate.addClass(t,e)}removeClass(t,e){this.delegate.removeClass(t,e)}setStyle(t,e,n,i){this.delegate.setStyle(t,e,n,i)}removeStyle(t,e,n){this.delegate.removeStyle(t,e,n)}setProperty(t,e,n){"@"==e.charAt(0)&&e==hW?this.disableAnimations(t,!!n):this.delegate.setProperty(t,e,n)}setValue(t,e){this.delegate.setValue(t,e)}listen(t,e,n){return this.delegate.listen(t,e,n)}disableAnimations(t,e){this.engine.disableAnimations(t,e)}}class fve extends gW{constructor(t,e,n,i,o){super(e,n,i,o),this.factory=t,this.namespaceId=e}setProperty(t,e,n){"@"==e.charAt(0)?"."==e.charAt(1)&&e==hW?this.disableAnimations(t,n=void 0===n||!!n):this.engine.process(this.namespaceId,t,e.slice(1),n):this.delegate.setProperty(t,e,n)}listen(t,e,n){if("@"==e.charAt(0)){const i=function dve(r){switch(r){case"body":return document.body;case"document":return document;case"window":return window;default:return r}}(t);let o=e.slice(1),s="";return"@"!=o.charAt(0)&&([o,s]=function hve(r){const t=r.indexOf(".");return[r.substring(0,t),r.slice(t+1)]}(o)),this.engine.listen(this.namespaceId,i,o,s,a=>{this.factory.scheduleListenerCallback(a._data||-1,n,a)})}return this.delegate.listen(t,e,n)}}class gve{constructor(t,e,n){this.delegate=t,this.engine=e,this._zone=n,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,e.onRemovalComplete=(i,o)=>{const s=o?.parentNode(i);s&&o.removeChild(s,i)}}createRenderer(t,e){const i=this.delegate.createRenderer(t,e);if(!t||!e?.data?.animation){const l=this._rendererCache;let u=l.get(i);return u||(u=new gW("",i,this.engine,()=>l.delete(i)),l.set(i,u)),u}const o=e.id,s=e.id+"-"+this._currentId;this._currentId++,this.engine.register(s,t);const a=l=>{Array.isArray(l)?l.forEach(a):this.engine.registerTrigger(o,s,t,l.name,l)};return e.data.animation.forEach(a),new fve(this,s,i,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){queueMicrotask(()=>{this._microtaskId++})}scheduleListenerCallback(t,e,n){if(t>=0&&t<this._microtaskId)return void this._zone.run(()=>e(n));const i=this._animationCallbacksBuffer;0==i.length&&queueMicrotask(()=>{this._zone.run(()=>{i.forEach(o=>{const[s,a]=o;s(a)}),this._animationCallbacksBuffer=[]})}),i.push([e,n])}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}let pve=(()=>{class r extends wf{constructor(e,n,i){super(e,n,i,Ne(XM,{optional:!0}))}ngOnDestroy(){this.flush()}static#e=this.\u0275fac=function(n){return new(n||r)(ze(R2),ze(KS),ze(XS))};static#t=this.\u0275prov=xe({token:r,factory:r.\u0275fac})}return r})();const pW=[{provide:XS,useFactory:function mve(){return new Y$}},{provide:wf,useClass:pve},{provide:QM,useFactory:function _ve(r,t,e){return new gve(r,t,e)},deps:[zP,wf,Xn]}],pO=[{provide:KS,useFactory:()=>new dW},{provide:Ax,useValue:"BrowserAnimations"},...pW],mW=[{provide:KS,useClass:YS},{provide:Ax,useValue:"NoopAnimations"},...pW];let Cve=(()=>{class r{static withConfig(e){return{ngModule:r,providers:e.disableAnimations?mW:pO}}static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275mod=Ls({type:r});static#n=this.\u0275inj=ns({providers:pO,imports:[WU]})}return r})();const _W=function(r){const t=[];let e=0;for(let n=0;n<r.length;n++){let i=r.charCodeAt(n);i<128?t[e++]=i:i<2048?(t[e++]=i>>6|192,t[e++]=63&i|128):55296==(64512&i)&&n+1<r.length&&56320==(64512&r.charCodeAt(n+1))?(i=65536+((1023&i)<<10)+(1023&r.charCodeAt(++n)),t[e++]=i>>18|240,t[e++]=i>>12&63|128,t[e++]=i>>6&63|128,t[e++]=63&i|128):(t[e++]=i>>12|224,t[e++]=i>>6&63|128,t[e++]=63&i|128)}return t},CW={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(r,t){if(!Array.isArray(r))throw Error("encodeByteArray takes an array as a parameter");this.init_();const e=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<r.length;i+=3){const o=r[i],s=i+1<r.length,a=s?r[i+1]:0,c=i+2<r.length,l=c?r[i+2]:0;let g=(15&a)<<2|l>>6,y=63&l;c||(y=64,s||(g=64)),n.push(e[o>>2],e[(3&o)<<4|a>>4],e[g],e[y])}return n.join("")},encodeString(r,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(r):this.encodeByteArray(_W(r),t)},decodeString(r,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(r):function(r){const t=[];let e=0,n=0;for(;e<r.length;){const i=r[e++];if(i<128)t[n++]=String.fromCharCode(i);else if(i>191&&i<224){const o=r[e++];t[n++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){const c=((7&i)<<18|(63&r[e++])<<12|(63&r[e++])<<6|63&r[e++])-65536;t[n++]=String.fromCharCode(55296+(c>>10)),t[n++]=String.fromCharCode(56320+(1023&c))}else{const o=r[e++],s=r[e++];t[n++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&s)}}return t.join("")}(this.decodeStringToByteArray(r,t))},decodeStringToByteArray(r,t){this.init_();const e=t?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<r.length;){const o=e[r.charAt(i++)],a=i<r.length?e[r.charAt(i)]:0;++i;const l=i<r.length?e[r.charAt(i)]:64;++i;const f=i<r.length?e[r.charAt(i)]:64;if(++i,null==o||null==a||null==l||null==f)throw new Eve;n.push(o<<2|a>>4),64!==l&&(n.push(a<<4&240|l>>2),64!==f&&n.push(l<<6&192|f))}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let r=0;r<this.ENCODED_VALS.length;r++)this.byteToCharMap_[r]=this.ENCODED_VALS.charAt(r),this.charToByteMap_[this.byteToCharMap_[r]]=r,this.byteToCharMapWebSafe_[r]=this.ENCODED_VALS_WEBSAFE.charAt(r),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[r]]=r,r>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(r)]=r,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(r)]=r)}}};class Eve extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const fm=function(r){return function(r){const t=_W(r);return CW.encodeByteArray(t,!0)}(r).replace(/\./g,"")},dm=function(r){try{return CW.decodeString(r,!0)}catch(t){console.error("base64Decode failed: ",t)}return null},hm=()=>{try{return function Ove(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if(typeof process>"u"||typeof process.env>"u")return;const r=process.env.__FIREBASE_DEFAULTS__;return r?JSON.parse(r):void 0})()||(()=>{if(typeof document>"u")return;let r;try{r=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=r&&dm(r[1]);return t&&JSON.parse(t)})()}catch(r){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${r}`)}},yW=r=>{var t,e;return null===(e=null===(t=hm())||void 0===t?void 0:t.emulatorHosts)||void 0===e?void 0:e[r]},MW=()=>{var r;return null===(r=hm())||void 0===r?void 0:r.config},EW=r=>{var t;return null===(t=hm())||void 0===t?void 0:t[`_${r}`]};class PW{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}wrapCallback(t){return(e,n)=>{e?this.reject(e):this.resolve(n),"function"==typeof t&&(this.promise.catch(()=>{}),1===t.length?t(e):t(e,n))}}}function Or(){return typeof navigator<"u"&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function OW(){try{return"object"==typeof indexedDB}catch{return!1}}class bc extends Error{constructor(t,e,n){super(e),this.code=t,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,bc.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Af.prototype.create)}}class Af{constructor(t,e,n){this.service=t,this.serviceName=e,this.errors=n}create(t,...e){const n=e[0]||{},i=`${this.service}/${t}`,o=this.errors[t],s=o?function Vve(r,t){return r.replace(Hve,(e,n)=>{const i=t[n];return null!=i?String(i):`<${n}?>`})}(o,n):"Error";return new bc(i,`${this.serviceName}: ${s} (${i}).`,n)}}const Hve=/\{\$([^}]+)}/g;function K8(r,t){if(r===t)return!0;const e=Object.keys(r),n=Object.keys(t);for(const i of e){if(!n.includes(i))return!1;const o=r[i],s=t[i];if(wW(o)&&wW(s)){if(!K8(o,s))return!1}else if(o!==s)return!1}for(const i of n)if(!e.includes(i))return!1;return!0}function wW(r){return null!==r&&"object"==typeof r}function Nf(r){const t=[];for(const[e,n]of Object.entries(r))Array.isArray(n)?n.forEach(i=>{t.push(encodeURIComponent(e)+"="+encodeURIComponent(i))}):t.push(encodeURIComponent(e)+"="+encodeURIComponent(n));return t.length?"&"+t.join("&"):""}function If(r){const t={};return r.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[i,o]=n.split("=");t[decodeURIComponent(i)]=decodeURIComponent(o)}}),t}function kf(r){const t=r.indexOf("?");if(!t)return"";const e=r.indexOf("#",t);return r.substring(t,e>0?e:void 0)}class Gve{constructor(t,e){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then(()=>{t(this)}).catch(n=>{this.error(n)})}next(t){this.forEachObserver(e=>{e.next(t)})}error(t){this.forEachObserver(e=>{e.error(t)}),this.close(t)}complete(){this.forEachObserver(t=>{t.complete()}),this.close()}subscribe(t,e,n){let i;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");i=function Bve(r,t){if("object"!=typeof r||null===r)return!1;for(const e of t)if(e in r&&"function"==typeof r[e])return!0;return!1}(t,["next","error","complete"])?t:{next:t,error:e,complete:n},void 0===i.next&&(i.next=_O),void 0===i.error&&(i.error=_O),void 0===i.complete&&(i.complete=_O);const o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),o}unsubscribeOne(t){void 0===this.observers||void 0===this.observers[t]||(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(t){if(!this.finalized)for(let e=0;e<this.observers.length;e++)this.sendOne(e,t)}sendOne(t,e){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[t])try{e(this.observers[t])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(t){this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function _O(){}function Cr(r){return r&&r._delegate?r._delegate:r}class v6{constructor(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}const y6="[DEFAULT]";class Yve{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const n=new PW;if(this.instancesDeferred.set(e,n),this.isInitialized(e)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:e});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(e).promise}getImmediate(t){var e;const n=this.normalizeInstanceIdentifier(t?.identifier),i=null!==(e=t?.optional)&&void 0!==e&&e;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(i)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(o){if(i)return null;throw o}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,this.shouldAutoInitialize()){if(function Xve(r){return"EAGER"===r.instantiationMode}(t))try{this.getOrInitializeService({instanceIdentifier:y6})}catch{}for(const[e,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(e);try{const o=this.getOrInitializeService({instanceIdentifier:i});n.resolve(o)}catch{}}}}clearInstance(t=y6){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}delete(){var t=this;return M(function*(){const e=Array.from(t.instances.values());yield Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])})()}isComponentSet(){return null!=this.component}isInitialized(t=y6){return this.instances.has(t)}getOptions(t=y6){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,n=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:e});for(const[o,s]of this.instancesDeferred.entries())n===this.normalizeInstanceIdentifier(o)&&s.resolve(i);return i}onInit(t,e){var n;const i=this.normalizeInstanceIdentifier(e),o=null!==(n=this.onInitCallbacks.get(i))&&void 0!==n?n:new Set;o.add(t),this.onInitCallbacks.set(i,o);const s=this.instances.get(i);return s&&t(s,i),()=>{o.delete(t)}}invokeOnInitCallbacks(t,e){const n=this.onInitCallbacks.get(e);if(n)for(const i of n)try{i(t,e)}catch{}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let n=this.instances.get(t);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(r=t,r===y6?void 0:r),options:e}),this.instances.set(t,n),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(n,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,n)}catch{}var r;return n||null}normalizeInstanceIdentifier(t=y6){return this.component?this.component.multipleInstances?t:y6:t}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class Qve{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new Yve(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}const vO=[];var kn=function(r){return r[r.DEBUG=0]="DEBUG",r[r.VERBOSE=1]="VERBOSE",r[r.INFO=2]="INFO",r[r.WARN=3]="WARN",r[r.ERROR=4]="ERROR",r[r.SILENT=5]="SILENT",r}(kn||{});const bW={debug:kn.DEBUG,verbose:kn.VERBOSE,info:kn.INFO,warn:kn.WARN,error:kn.ERROR,silent:kn.SILENT},Jve=kn.INFO,eye={[kn.DEBUG]:"log",[kn.VERBOSE]:"log",[kn.INFO]:"info",[kn.WARN]:"warn",[kn.ERROR]:"error"},tye=(r,t,...e)=>{if(t<r.logLevel)return;const n=(new Date).toISOString(),i=eye[t];if(!i)throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`);console[i](`[${n}]  ${r.name}:`,...e)};class yO{constructor(t){this.name=t,this._logLevel=Jve,this._logHandler=tye,this._userLogHandler=null,vO.push(this)}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in kn))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel="string"==typeof t?bW[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,kn.DEBUG,...t),this._logHandler(this,kn.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,kn.VERBOSE,...t),this._logHandler(this,kn.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,kn.INFO,...t),this._logHandler(this,kn.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,kn.WARN,...t),this._logHandler(this,kn.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,kn.ERROR,...t),this._logHandler(this,kn.ERROR,...t)}}const nye=(r,t)=>t.some(e=>r instanceof e);let AW,NW;const IW=new WeakMap,MO=new WeakMap,kW=new WeakMap,EO=new WeakMap,PO=new WeakMap;let SO={get(r,t,e){if(r instanceof IDBTransaction){if("done"===t)return MO.get(r);if("objectStoreNames"===t)return r.objectStoreNames||kW.get(r);if("store"===t)return e.objectStoreNames[1]?void 0:e.objectStore(e.objectStoreNames[0])}return Z4(r[t])},set:(r,t,e)=>(r[t]=e,!0),has:(r,t)=>r instanceof IDBTransaction&&("done"===t||"store"===t)||t in r};function lye(r){return"function"==typeof r?function cye(r){return r!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function iye(){return NW||(NW=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(r)?function(...t){return r.apply(OO(this),t),Z4(IW.get(this))}:function(...t){return Z4(r.apply(OO(this),t))}:function(t,...e){const n=r.call(OO(this),t,...e);return kW.set(n,t.sort?t.sort():[t]),Z4(n)}}(r):(r instanceof IDBTransaction&&function sye(r){if(MO.has(r))return;const t=new Promise((e,n)=>{const i=()=>{r.removeEventListener("complete",o),r.removeEventListener("error",s),r.removeEventListener("abort",s)},o=()=>{e(),i()},s=()=>{n(r.error||new DOMException("AbortError","AbortError")),i()};r.addEventListener("complete",o),r.addEventListener("error",s),r.addEventListener("abort",s)});MO.set(r,t)}(r),nye(r,function rye(){return AW||(AW=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(r,SO):r)}function Z4(r){if(r instanceof IDBRequest)return function oye(r){const t=new Promise((e,n)=>{const i=()=>{r.removeEventListener("success",o),r.removeEventListener("error",s)},o=()=>{e(Z4(r.result)),i()},s=()=>{n(r.error),i()};r.addEventListener("success",o),r.addEventListener("error",s)});return t.then(e=>{e instanceof IDBCursor&&IW.set(e,r)}).catch(()=>{}),PO.set(t,r),t}(r);if(EO.has(r))return EO.get(r);const t=lye(r);return t!==r&&(EO.set(r,t),PO.set(t,r)),t}const OO=r=>PO.get(r),fye=["get","getKey","getAll","getAllKeys","count"],dye=["put","add","delete","clear"],TO=new Map;function RW(r,t){if(!(r instanceof IDBDatabase)||t in r||"string"!=typeof t)return;if(TO.get(t))return TO.get(t);const e=t.replace(/FromIndex$/,""),n=t!==e,i=dye.includes(e);if(!(e in(n?IDBIndex:IDBObjectStore).prototype)||!i&&!fye.includes(e))return;const o=function(){var s=M(function*(a,...c){const l=this.transaction(a,i?"readwrite":"readonly");let u=l.store;return n&&(u=u.index(c.shift())),(yield Promise.all([u[e](...c),i&&l.done]))[0]});return function(c){return s.apply(this,arguments)}}();return TO.set(t,o),o}!function aye(r){SO=r(SO)}(r=>({...r,get:(t,e,n)=>RW(t,e)||r.get(t,e,n),has:(t,e)=>!!RW(t,e)||r.has(t,e)}));class hye{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(function gye(r){const t=r.getComponent();return"VERSION"===t?.type}(e)){const n=e.getImmediate();return`${n.library}/${n.version}`}return null}).filter(e=>e).join(" ")}}const wO="@firebase/app",M6=new yO("@firebase/app"),pm="[DEFAULT]",Fye={[wO]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},E6=new Map,mm=new Map;function Uye(r,t){try{r.container.addComponent(t)}catch(e){M6.debug(`Component ${t.name} failed to register with FirebaseApp ${r.name}`,e)}}function X8(r){const t=r.name;if(mm.has(t))return M6.debug(`There were multiple attempts to register component ${t}.`),!1;mm.set(t,r);for(const e of E6.values())Uye(e,r);return!0}function _m(r,t){const e=r.container.getProvider("heartbeat").getImmediate({optional:!0});return e&&e.triggerHeartbeat(),r.container.getProvider(t)}const R3=new Af("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class Bye{constructor(t,e,n){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},e),this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new v6("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw R3.create("app-deleted",{appName:this._name})}}const Q8="10.8.1";function LW(r,t={}){let e=r;"object"!=typeof t&&(t={name:t});const n=Object.assign({name:pm,automaticDataCollectionEnabled:!1},t),i=n.name;if("string"!=typeof i||!i)throw R3.create("bad-app-name",{appName:String(i)});if(e||(e=MW()),!e)throw R3.create("no-options");const o=E6.get(i);if(o){if(K8(e,o.options)&&K8(n,o.config))return o;throw R3.create("duplicate-app",{appName:i})}const s=new Qve(i);for(const c of mm.values())s.addComponent(c);const a=new Bye(e,n,s);return E6.set(i,a),a}function zW(r=pm){const t=E6.get(r);if(!t&&r===pm&&MW())return LW();if(!t)throw R3.create("no-app",{appName:r});return t}function P6(r,t,e){var n;let i=null!==(n=Fye[r])&&void 0!==n?n:r;e&&(i+=`-${e}`);const o=i.match(/\s|\//),s=t.match(/\s|\//);if(o||s){const a=[`Unable to register library "${i}" with version "${t}":`];return o&&a.push(`library name "${i}" contains illegal characters (whitespace or "/")`),o&&s&&a.push("and"),s&&a.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void M6.warn(a.join(" "))}X8(new v6(`${i}-version`,()=>({library:i,version:t}),"VERSION"))}const $ye="firebase-heartbeat-database",Wye=1,Rf="firebase-heartbeat-store";let AO=null;function DW(){return AO||(AO=function uye(r,t,{blocked:e,upgrade:n,blocking:i,terminated:o}={}){const s=indexedDB.open(r,t),a=Z4(s);return n&&s.addEventListener("upgradeneeded",c=>{n(Z4(s.result),c.oldVersion,c.newVersion,Z4(s.transaction),c)}),e&&s.addEventListener("blocked",c=>e(c.oldVersion,c.newVersion,c)),a.then(c=>{o&&c.addEventListener("close",()=>o()),i&&c.addEventListener("versionchange",l=>i(l.oldVersion,l.newVersion,l))}).catch(()=>{}),a}($ye,Wye,{upgrade:(r,t)=>{if(0===t)try{r.createObjectStore(Rf)}catch(e){console.warn(e)}}}).catch(r=>{throw R3.create("idb-open",{originalErrorMessage:r.message})})),AO}function NO(){return(NO=M(function*(r){try{const e=(yield DW()).transaction(Rf),n=yield e.objectStore(Rf).get(HW(r));return yield e.done,n}catch(t){if(t instanceof bc)M6.warn(t.message);else{const e=R3.create("idb-get",{originalErrorMessage:t?.message});M6.warn(e.message)}}})).apply(this,arguments)}function VW(r,t){return IO.apply(this,arguments)}function IO(){return(IO=M(function*(r,t){try{const n=(yield DW()).transaction(Rf,"readwrite");yield n.objectStore(Rf).put(t,HW(r)),yield n.done}catch(e){if(e instanceof bc)M6.warn(e.message);else{const n=R3.create("idb-set",{originalErrorMessage:e?.message});M6.warn(n.message)}}})).apply(this,arguments)}function HW(r){return`${r.name}!${r.options.appId}`}class Yye{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new Xye(e),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}triggerHeartbeat(){var t=this;return M(function*(){var e,n;const o=t.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=FW();if((null!=(null===(e=t._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||(t._heartbeatsCache=yield t._heartbeatsCachePromise,null!=(null===(n=t._heartbeatsCache)||void 0===n?void 0:n.heartbeats)))&&t._heartbeatsCache.lastSentHeartbeatDate!==s&&!t._heartbeatsCache.heartbeats.some(a=>a.date===s))return t._heartbeatsCache.heartbeats.push({date:s,agent:o}),t._heartbeatsCache.heartbeats=t._heartbeatsCache.heartbeats.filter(a=>{const c=new Date(a.date).valueOf();return Date.now()-c<=2592e6}),t._storage.overwrite(t._heartbeatsCache)})()}getHeartbeatsHeader(){var t=this;return M(function*(){var e;if(null===t._heartbeatsCache&&(yield t._heartbeatsCachePromise),null==(null===(e=t._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||0===t._heartbeatsCache.heartbeats.length)return"";const n=FW(),{heartbeatsToSend:i,unsentEntries:o}=function Kye(r,t=1024){const e=[];let n=r.slice();for(const i of r){const o=e.find(s=>s.agent===i.agent);if(o){if(o.dates.push(i.date),UW(e)>t){o.dates.pop();break}}else if(e.push({agent:i.agent,dates:[i.date]}),UW(e)>t){e.pop();break}n=n.slice(1)}return{heartbeatsToSend:e,unsentEntries:n}}(t._heartbeatsCache.heartbeats),s=fm(JSON.stringify({version:2,heartbeats:i}));return t._heartbeatsCache.lastSentHeartbeatDate=n,o.length>0?(t._heartbeatsCache.heartbeats=o,yield t._storage.overwrite(t._heartbeatsCache)):(t._heartbeatsCache.heartbeats=[],t._storage.overwrite(t._heartbeatsCache)),s})()}}function FW(){return(new Date).toISOString().substring(0,10)}class Xye{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return M(function*(){return!!OW()&&function zve(){return new Promise((r,t)=>{try{let e=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),e||self.indexedDB.deleteDatabase(n),r(!0)},i.onupgradeneeded=()=>{e=!1},i.onerror=()=>{var o;t((null===(o=i.error)||void 0===o?void 0:o.message)||"")}}catch(e){t(e)}})}().then(()=>!0).catch(()=>!1)})()}read(){var t=this;return M(function*(){if(yield t._canUseIndexedDBPromise){const n=yield function qye(r){return NO.apply(this,arguments)}(t.app);return n?.heartbeats?n:{heartbeats:[]}}return{heartbeats:[]}})()}overwrite(t){var e=this;return M(function*(){var n;if(yield e._canUseIndexedDBPromise){const o=yield e.read();return VW(e.app,{lastSentHeartbeatDate:null!==(n=t.lastSentHeartbeatDate)&&void 0!==n?n:o.lastSentHeartbeatDate,heartbeats:t.heartbeats})}})()}add(t){var e=this;return M(function*(){var n;if(yield e._canUseIndexedDBPromise){const o=yield e.read();return VW(e.app,{lastSentHeartbeatDate:null!==(n=t.lastSentHeartbeatDate)&&void 0!==n?n:o.lastSentHeartbeatDate,heartbeats:[...o.heartbeats,...t.heartbeats]})}})()}}function UW(r){return fm(JSON.stringify({version:2,heartbeats:r})).length}!function Qye(r){X8(new v6("platform-logger",t=>new hye(t),"PRIVATE")),X8(new v6("heartbeat",t=>new Yye(t),"PRIVATE")),P6(wO,"0.9.28",r),P6(wO,"0.9.28","esm2017"),P6("fire-js","")}("");var et,Jye=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},xa={},kO=kO||{},tn=Jye||self;function Cm(r){var t=typeof r;return"array"==(t="object"!=t?t:r?Array.isArray(r)?"array":t:"null")||"object"==t&&"number"==typeof r.length}function xf(r){var t=typeof r;return"object"==t&&null!=r||"function"==t}var RO="closure_uid_"+(1e9*Math.random()>>>0),tMe=0;function nMe(r,t,e){return r.call.apply(r.bind,arguments)}function rMe(r,t,e){if(!r)throw Error();if(2<arguments.length){var n=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,n),r.apply(t,i)}}return function(){return r.apply(t,arguments)}}function D2(r,t,e){return(D2=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?nMe:rMe).apply(null,arguments)}function vm(r,t){var e=Array.prototype.slice.call(arguments,1);return function(){var n=e.slice();return n.push.apply(n,arguments),r.apply(this,n)}}function zi(r,t){function e(){}e.prototype=t.prototype,r.$=t.prototype,r.prototype=new e,r.prototype.constructor=r,r.ac=function(n,i,o){for(var s=Array(arguments.length-2),a=2;a<arguments.length;a++)s[a-2]=arguments[a];return t.prototype[i].apply(n,s)}}function Y4(){this.s=this.s,this.o=this.o}Y4.prototype.s=!1,Y4.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),0)&&function eMe(r){Object.prototype.hasOwnProperty.call(r,RO)&&r[RO]||(r[RO]=++tMe)}(this)},Y4.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const GW=Array.prototype.indexOf?function(r,t){return Array.prototype.indexOf.call(r,t,void 0)}:function(r,t){if("string"==typeof r)return"string"!=typeof t||1!=t.length?-1:r.indexOf(t,0);for(let e=0;e<r.length;e++)if(e in r&&r[e]===t)return e;return-1};function xO(r){const t=r.length;if(0<t){const e=Array(t);for(let n=0;n<t;n++)e[n]=r[n];return e}return[]}function BW(r,t){for(let e=1;e<arguments.length;e++){const n=arguments[e];if(Cm(n)){const i=r.length||0,o=n.length||0;r.length=i+o;for(let s=0;s<o;s++)r[i+s]=n[s]}else r.push(n)}}function V2(r,t){this.type=r,this.g=this.target=t,this.defaultPrevented=!1}V2.prototype.h=function(){this.defaultPrevented=!0};var oMe=function(){if(!tn.addEventListener||!Object.defineProperty)return!1;var r=!1,t=Object.defineProperty({},"passive",{get:function(){r=!0}});try{const e=()=>{};tn.addEventListener("test",e,t),tn.removeEventListener("test",e,t)}catch{}return r}();function Lf(r){return/^[\s\xa0]*$/.test(r)}function ym(){var r=tn.navigator;return r&&(r=r.userAgent)?r:""}function Ac(r){return-1!=ym().indexOf(r)}function LO(r){return LO[" "](r),r}LO[" "]=function(){};var DO,r,aMe=Ac("Opera"),J8=Ac("Trident")||Ac("MSIE"),$W=Ac("Edge"),zO=$W||J8,WW=Ac("Gecko")&&!(-1!=ym().toLowerCase().indexOf("webkit")&&!Ac("Edge"))&&!(Ac("Trident")||Ac("MSIE"))&&!Ac("Edge"),cMe=-1!=ym().toLowerCase().indexOf("webkit")&&!Ac("Edge");function qW(){var r=tn.document;return r?r.documentMode:void 0}e:{var VO="",HO=(r=ym(),WW?/rv:([^\);]+)(\)|;)/.exec(r):$W?/Edge\/([\d\.]+)/.exec(r):J8?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(r):cMe?/WebKit\/(\S+)/.exec(r):aMe?/(?:Version)[ \/]?(\S+)/.exec(r):void 0);if(HO&&(VO=HO?HO[1]:""),J8){var FO=qW();if(null!=FO&&FO>parseFloat(VO)){DO=String(FO);break e}}DO=VO}var lMe=tn.document&&J8&&(qW()||parseInt(DO,10))||void 0;function zf(r,t){if(V2.call(this,r?r.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,r){var e=this.type=r.type,n=r.changedTouches&&r.changedTouches.length?r.changedTouches[0]:null;if(this.target=r.target||r.srcElement,this.g=t,t=r.relatedTarget){if(WW){e:{try{LO(t.nodeName);var i=!0;break e}catch{}i=!1}i||(t=null)}}else"mouseover"==e?t=r.fromElement:"mouseout"==e&&(t=r.toElement);this.relatedTarget=t,n?(this.clientX=void 0!==n.clientX?n.clientX:n.pageX,this.clientY=void 0!==n.clientY?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0):(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0),this.button=r.button,this.key=r.key||"",this.ctrlKey=r.ctrlKey,this.altKey=r.altKey,this.shiftKey=r.shiftKey,this.metaKey=r.metaKey,this.pointerId=r.pointerId||0,this.pointerType="string"==typeof r.pointerType?r.pointerType:uMe[r.pointerType]||"",this.state=r.state,this.i=r,r.defaultPrevented&&zf.$.h.call(this)}}zi(zf,V2);var uMe={2:"touch",3:"pen",4:"mouse"};zf.prototype.h=function(){zf.$.h.call(this);var r=this.i;r.preventDefault?r.preventDefault():r.returnValue=!1};var Df="closure_listenable_"+(1e6*Math.random()|0),fMe=0;function dMe(r,t,e,n,i){this.listener=r,this.proxy=null,this.src=t,this.type=e,this.capture=!!n,this.la=i,this.key=++fMe,this.fa=this.ia=!1}function Mm(r){r.fa=!0,r.listener=null,r.proxy=null,r.src=null,r.la=null}function GO(r,t,e){for(const n in r)t.call(e,r[n],n,r)}function ZW(r){const t={};for(const e in r)t[e]=r[e];return t}const YW="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function KW(r,t){let e,n;for(let i=1;i<arguments.length;i++){for(e in n=arguments[i],n)r[e]=n[e];for(let o=0;o<YW.length;o++)e=YW[o],Object.prototype.hasOwnProperty.call(n,e)&&(r[e]=n[e])}}function Em(r){this.src=r,this.g={},this.h=0}function BO(r,t){var e=t.type;if(e in r.g){var o,n=r.g[e],i=GW(n,t);(o=0<=i)&&Array.prototype.splice.call(n,i,1),o&&(Mm(t),0==r.g[e].length&&(delete r.g[e],r.h--))}}function $O(r,t,e,n){for(var i=0;i<r.length;++i){var o=r[i];if(!o.fa&&o.listener==t&&o.capture==!!e&&o.la==n)return i}return-1}Em.prototype.add=function(r,t,e,n,i){var o=r.toString();(r=this.g[o])||(r=this.g[o]=[],this.h++);var s=$O(r,t,n,i);return-1<s?(t=r[s],e||(t.ia=!1)):((t=new dMe(t,this.src,o,!!n,i)).ia=e,r.push(t)),t};var WO="closure_lm_"+(1e6*Math.random()|0),qO={};function XW(r,t,e,n,i){if(n&&n.once)return JW(r,t,e,n,i);if(Array.isArray(t)){for(var o=0;o<t.length;o++)XW(r,t[o],e,n,i);return null}return e=KO(e),r&&r[Df]?r.O(t,e,xf(n)?!!n.capture:!!n,i):QW(r,t,e,!1,n,i)}function QW(r,t,e,n,i,o){if(!t)throw Error("Invalid event type");var s=xf(i)?!!i.capture:!!i,a=ZO(r);if(a||(r[WO]=a=new Em(r)),(e=a.add(t,e,n,s,o)).proxy)return e;if(n=function gMe(){const t=pMe;return function r(e){return t.call(r.src,r.listener,e)}}(),e.proxy=n,n.src=r,n.listener=e,r.addEventListener)oMe||(i=s),void 0===i&&(i=!1),r.addEventListener(t.toString(),n,i);else if(r.attachEvent)r.attachEvent(tq(t.toString()),n);else{if(!r.addListener||!r.removeListener)throw Error("addEventListener and attachEvent are unavailable.");r.addListener(n)}return e}function JW(r,t,e,n,i){if(Array.isArray(t)){for(var o=0;o<t.length;o++)JW(r,t[o],e,n,i);return null}return e=KO(e),r&&r[Df]?r.P(t,e,xf(n)?!!n.capture:!!n,i):QW(r,t,e,!0,n,i)}function eq(r,t,e,n,i){if(Array.isArray(t))for(var o=0;o<t.length;o++)eq(r,t[o],e,n,i);else n=xf(n)?!!n.capture:!!n,e=KO(e),r&&r[Df]?(r=r.i,(t=String(t).toString())in r.g&&-1<(e=$O(o=r.g[t],e,n,i))&&(Mm(o[e]),Array.prototype.splice.call(o,e,1),0==o.length&&(delete r.g[t],r.h--))):r&&(r=ZO(r))&&(t=r.g[t.toString()],r=-1,t&&(r=$O(t,e,n,i)),(e=-1<r?t[r]:null)&&jO(e))}function jO(r){if("number"!=typeof r&&r&&!r.fa){var t=r.src;if(t&&t[Df])BO(t.i,r);else{var e=r.type,n=r.proxy;t.removeEventListener?t.removeEventListener(e,n,r.capture):t.detachEvent?t.detachEvent(tq(e),n):t.addListener&&t.removeListener&&t.removeListener(n),(e=ZO(t))?(BO(e,r),0==e.h&&(e.src=null,t[WO]=null)):Mm(r)}}}function tq(r){return r in qO?qO[r]:qO[r]="on"+r}function pMe(r,t){if(r.fa)r=!0;else{t=new zf(t,this);var e=r.listener,n=r.la||r.src;r.ia&&jO(r),r=e.call(n,t)}return r}function ZO(r){return(r=r[WO])instanceof Em?r:null}var YO="__closure_events_fn_"+(1e9*Math.random()>>>0);function KO(r){return"function"==typeof r?r:(r[YO]||(r[YO]=function(t){return r.handleEvent(t)}),r[YO])}function Di(){Y4.call(this),this.i=new Em(this),this.S=this,this.J=null}function o2(r,t){var e,n=r.J;if(n)for(e=[];n;n=n.J)e.push(n);if(r=r.S,n=t.type||t,"string"==typeof t)t=new V2(t,r);else if(t instanceof V2)t.target=t.target||r;else{var i=t;KW(t=new V2(n,r),i)}if(i=!0,e)for(var o=e.length-1;0<=o;o--){var s=t.g=e[o];i=Pm(s,n,!0,t)&&i}if(i=Pm(s=t.g=r,n,!0,t)&&i,i=Pm(s,n,!1,t)&&i,e)for(o=0;o<e.length;o++)i=Pm(s=t.g=e[o],n,!1,t)&&i}function Pm(r,t,e,n){if(!(t=r.i.g[String(t)]))return!0;t=t.concat();for(var i=!0,o=0;o<t.length;++o){var s=t[o];if(s&&!s.fa&&s.capture==e){var a=s.listener,c=s.la||s.src;s.ia&&BO(r.i,s),i=!1!==a.call(c,n)&&i}}return i&&!n.defaultPrevented}zi(Di,Y4),Di.prototype[Df]=!0,Di.prototype.removeEventListener=function(r,t,e,n){eq(this,r,t,e,n)},Di.prototype.N=function(){if(Di.$.N.call(this),this.i){var t,r=this.i;for(t in r.g){for(var e=r.g[t],n=0;n<e.length;n++)Mm(e[n]);delete r.g[t],r.h--}}this.J=null},Di.prototype.O=function(r,t,e,n){return this.i.add(String(r),t,!1,e,n)},Di.prototype.P=function(r,t,e,n){return this.i.add(String(r),t,!0,e,n)};var XO=tn.JSON.stringify;function _Me(){var r=QO;let t=null;return r.g&&(t=r.g,r.g=r.g.next,r.g||(r.h=null),t.next=null),t}var nq=new class mMe{constructor(t,e){this.i=t,this.j=e,this.h=0,this.g=null}get(){let t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t}}(()=>new vMe,r=>r.reset());class vMe{constructor(){this.next=this.g=this.h=null}set(t,e){this.h=t,this.g=e,this.next=null}reset(){this.next=this.g=this.h=null}}function yMe(r){var t=1;r=r.split(":");const e=[];for(;0<t&&r.length;)e.push(r.shift()),t--;return r.length&&e.push(r.join(":")),e}function MMe(r){tn.setTimeout(()=>{throw r},0)}let Vf,Hf=!1,QO=new class CMe{constructor(){this.h=this.g=null}add(t,e){const n=nq.get();n.set(t,e),this.h?this.h.next=n:this.g=n,this.h=n}},rq=()=>{const r=tn.Promise.resolve(void 0);Vf=()=>{r.then(EMe)}};var EMe=()=>{for(var r;r=_Me();){try{r.h.call(r.g)}catch(e){MMe(e)}var t=nq;t.j(r),100>t.h&&(t.h++,r.next=t.g,t.g=r)}Hf=!1};function Sm(r,t){Di.call(this),this.h=r||1,this.g=t||tn,this.j=D2(this.qb,this),this.l=Date.now()}function JO(r){r.ga=!1,r.T&&(r.g.clearTimeout(r.T),r.T=null)}function eT(r,t,e){if("function"==typeof r)e&&(r=D2(r,e));else{if(!r||"function"!=typeof r.handleEvent)throw Error("Invalid listener argument");r=D2(r.handleEvent,r)}return 2147483647<Number(t)?-1:tn.setTimeout(r,t||0)}function iq(r){r.g=eT(()=>{r.g=null,r.i&&(r.i=!1,iq(r))},r.j);const t=r.h;r.h=null,r.m.apply(null,t)}zi(Sm,Di),(et=Sm.prototype).ga=!1,et.T=null,et.qb=function(){if(this.ga){var r=Date.now()-this.l;0<r&&r<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-r):(this.T&&(this.g.clearTimeout(this.T),this.T=null),o2(this,"tick"),this.ga&&(JO(this),this.start()))}},et.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())},et.N=function(){Sm.$.N.call(this),JO(this),delete this.g};class PMe extends Y4{constructor(t,e){super(),this.m=t,this.j=e,this.h=null,this.i=!1,this.g=null}l(t){this.h=arguments,this.g?this.i=!0:iq(this)}N(){super.N(),this.g&&(tn.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ff(r){Y4.call(this),this.h=r,this.g={}}zi(Ff,Y4);var oq=[];function sq(r,t,e,n){Array.isArray(e)||(e&&(oq[0]=e.toString()),e=oq);for(var i=0;i<e.length;i++){var o=XW(t,e[i],n||r.handleEvent,!1,r.h||r);if(!o)break;r.g[o.key]=o}}function aq(r){GO(r.g,function(t,e){this.g.hasOwnProperty(e)&&jO(t)},r),r.g={}}function Om(){this.g=!0}function e5(r,t,e,n){r.info(function(){return"XMLHTTP TEXT ("+t+"): "+function wMe(r,t){if(!r.g)return t;if(!t)return null;try{var e=JSON.parse(t);if(e)for(r=0;r<e.length;r++)if(Array.isArray(e[r])){var n=e[r];if(!(2>n.length)){var i=n[1];if(Array.isArray(i)&&!(1>i.length)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<i.length;s++)i[s]=""}}}return XO(e)}catch{return t}}(r,e)+(n?" "+n:"")})}Ff.prototype.N=function(){Ff.$.N.call(this),aq(this)},Ff.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Om.prototype.Ea=function(){this.g=!1},Om.prototype.info=function(){};var S6={},cq=null;function Tm(){return cq=cq||new Di}function lq(r){V2.call(this,S6.Ta,r)}function Uf(r){const t=Tm();o2(t,new lq(t))}function uq(r,t){V2.call(this,S6.STAT_EVENT,r),this.stat=t}function co(r){const t=Tm();o2(t,new uq(t,r))}function fq(r,t){V2.call(this,S6.Ua,r),this.size=t}function Gf(r,t){if("function"!=typeof r)throw Error("Fn must not be null and must be a function");return tn.setTimeout(function(){r()},t)}S6.Ta="serverreachability",zi(lq,V2),S6.STAT_EVENT="statevent",zi(uq,V2),S6.Ua="timingevent",zi(fq,V2);var wm={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},dq={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function tT(){}function gq(){}tT.prototype.h=null;var iT,Bf={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function nT(){V2.call(this,"d")}function rT(){V2.call(this,"c")}function bm(){}function $f(r,t,e,n){this.l=r,this.j=t,this.m=e,this.W=n||1,this.U=new Ff(this),this.P=bMe,this.V=new Sm(r=zO?125:void 0),this.I=null,this.i=!1,this.u=this.B=this.A=this.L=this.G=this.Y=this.C=null,this.F=[],this.g=null,this.o=0,this.s=this.v=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new pq}function pq(){this.i=null,this.g="",this.h=!1}zi(nT,V2),zi(rT,V2),zi(bm,tT),bm.prototype.g=function(){return new XMLHttpRequest},bm.prototype.i=function(){return{}},iT=new bm;var bMe=45e3,mq={},oT={};function sT(r,t,e){r.L=1,r.A=km(x3(t)),r.u=e,r.S=!0,_q(r,null)}function _q(r,t){r.G=Date.now(),Wf(r),r.B=x3(r.A);var e=r.B,n=r.W;Array.isArray(n)||(n=[String(n)]),wq(e.i,"t",n),r.o=0,e=r.l.J,r.h=new pq,r.g=Xq(r.l,e?t:null,!r.u),0<r.O&&(r.M=new PMe(D2(r.Pa,r,r.g),r.O)),sq(r.U,r.g,"readystatechange",r.nb),t=r.I?ZW(r.I):{},r.u?(r.v||(r.v="POST"),t["Content-Type"]="application/x-www-form-urlencoded",r.g.ha(r.B,r.v,r.u,t)):(r.v="GET",r.g.ha(r.B,r.v,null,t)),Uf(),function SMe(r,t,e,n,i,o){r.info(function(){if(r.g)if(o)for(var s="",a=o.split("&"),c=0;c<a.length;c++){var l=a[c].split("=");if(1<l.length){var u=l[0];l=l[1];var f=u.split("_");s=2<=f.length&&"type"==f[1]?s+(u+"=")+l+"&":s+(u+"=redacted&")}}else s=null;else s=o;return"XMLHTTP REQ ("+n+") [attempt "+i+"]: "+t+"\n"+e+"\n"+s})}(r.j,r.v,r.B,r.m,r.W,r.u)}function Cq(r){return!!r.g&&"GET"==r.v&&2!=r.L&&r.l.Ha}function vq(r,t,e){let i,n=!0;for(;!r.J&&r.o<e.length;){if(i=AMe(r,e),i==oT){4==t&&(r.s=4,co(14),n=!1),e5(r.j,r.m,null,"[Incomplete Response]");break}if(i==mq){r.s=4,co(15),e5(r.j,r.m,e,"[Invalid Chunk]"),n=!1;break}e5(r.j,r.m,i,null),aT(r,i)}Cq(r)&&0!=r.o&&(r.h.g=r.h.g.slice(r.o),r.o=0),4!=t||0!=e.length||r.h.h||(r.s=1,co(16),n=!1),r.i=r.i&&n,n?0<e.length&&!r.ba&&(r.ba=!0,(t=r.l).g==r&&t.ca&&!t.M&&(t.l.info("Great, no buffering proxy detected. Bytes received: "+e.length),gT(t),t.M=!0,co(11))):(e5(r.j,r.m,e,"[Invalid Chunked Response]"),O6(r),qf(r))}function AMe(r,t){var e=r.o,n=t.indexOf("\n",e);return-1==n?oT:(e=Number(t.substring(e,n)),isNaN(e)?mq:(n+=1)+e>t.length?oT:(t=t.slice(n,n+e),r.o=n+e,t))}function Wf(r){r.Y=Date.now()+r.P,yq(r,r.P)}function yq(r,t){if(null!=r.C)throw Error("WatchDog timer not null");r.C=Gf(D2(r.lb,r),t)}function Am(r){r.C&&(tn.clearTimeout(r.C),r.C=null)}function qf(r){0==r.l.H||r.J||jq(r.l,r)}function O6(r){Am(r);var t=r.M;t&&"function"==typeof t.sa&&t.sa(),r.M=null,JO(r.V),aq(r.U),r.g&&(t=r.g,r.g=null,t.abort(),t.sa())}function aT(r,t){try{var e=r.l;if(0!=e.H&&(e.g==r||cT(e.i,r)))if(!r.K&&cT(e.i,r)&&3==e.H){try{var n=e.Ja.g.parse(t)}catch{n=null}if(Array.isArray(n)&&3==n.length){var i=n;if(0==i[0]){e:if(!e.u){if(e.g){if(!(e.g.G+3e3<r.G))break e;Vm(e),zm(e)}hT(e),co(18)}}else e.Fa=i[1],0<e.Fa-e.V&&37500>i[2]&&e.G&&0==e.A&&!e.v&&(e.v=Gf(D2(e.ib,e),6e3));if(1>=Nq(e.i)&&e.oa){try{e.oa()}catch{}e.oa=void 0}}else w6(e,11)}else if((r.K||e.g==r)&&Vm(e),!Lf(t))for(i=e.Ja.g.parse(t),t=0;t<i.length;t++){let l=i[t];if(e.V=l[0],l=l[1],2==e.H)if("c"==l[0]){e.K=l[1],e.pa=l[2];const u=l[3];null!=u&&(e.ra=u,e.l.info("VER="+e.ra));const f=l[4];null!=f&&(e.Ga=f,e.l.info("SVER="+e.Ga));const g=l[5];null!=g&&"number"==typeof g&&0<g&&(e.L=n=1.5*g,e.l.info("backChannelRequestTimeoutMs_="+n)),n=e;const y=r.g;if(y){const S=y.g?y.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(S){var o=n.i;o.g||-1==S.indexOf("spdy")&&-1==S.indexOf("quic")&&-1==S.indexOf("h2")||(o.j=o.l,o.g=new Set,o.h&&(lT(o,o.h),o.h=null))}if(n.F){const N=y.g?y.g.getResponseHeader("X-HTTP-Session-Id"):null;N&&(n.Da=N,Y1(n.I,n.F,N))}}e.H=3,e.h&&e.h.Ba(),e.ca&&(e.S=Date.now()-r.G,e.l.info("Handshake RTT: "+e.S+"ms"));var s=r;if((n=e).wa=Kq(n,n.J?n.pa:null,n.Y),s.K){Iq(n.i,s);var a=s,c=n.L;c&&a.setTimeout(c),a.C&&(Am(a),Wf(a)),n.g=s}else Wq(n);0<e.j.length&&Dm(e)}else"stop"!=l[0]&&"close"!=l[0]||w6(e,7);else 3==e.H&&("stop"==l[0]||"close"==l[0]?"stop"==l[0]?w6(e,7):dT(e):"noop"!=l[0]&&e.h&&e.h.Aa(l),e.A=0)}Uf()}catch{}}function Mq(r,t){if(r.forEach&&"function"==typeof r.forEach)r.forEach(t,void 0);else if(Cm(r)||"string"==typeof r)Array.prototype.forEach.call(r,t,void 0);else for(var e=function IMe(r){if(r.ta&&"function"==typeof r.ta)return r.ta();if(!r.Z||"function"!=typeof r.Z){if(typeof Map<"u"&&r instanceof Map)return Array.from(r.keys());if(!(typeof Set<"u"&&r instanceof Set)){if(Cm(r)||"string"==typeof r){var t=[];r=r.length;for(var e=0;e<r;e++)t.push(e);return t}t=[],e=0;for(const n in r)t[e++]=n;return t}}}(r),n=function NMe(r){if(r.Z&&"function"==typeof r.Z)return r.Z();if(typeof Map<"u"&&r instanceof Map||typeof Set<"u"&&r instanceof Set)return Array.from(r.values());if("string"==typeof r)return r.split("");if(Cm(r)){for(var t=[],e=r.length,n=0;n<e;n++)t.push(r[n]);return t}for(n in t=[],e=0,r)t[e++]=r[n];return t}(r),i=n.length,o=0;o<i;o++)t.call(void 0,n[o],e&&e[o],r)}(et=$f.prototype).setTimeout=function(r){this.P=r},et.nb=function(r){r=r.target;const t=this.M;t&&3==Nc(r)?t.l():this.Pa(r)},et.Pa=function(r){try{if(r==this.g)e:{const u=Nc(this.g);var t=this.g.Ia();if(this.g.da(),!(3>u)&&(3!=u||zO||this.g&&(this.h.h||this.g.ja()||Hq(this.g)))){this.J||4!=u||7==t||Uf(),Am(this);var e=this.g.da();this.ca=e;t:if(Cq(this)){var n=Hq(this.g);r="";var i=n.length,o=4==Nc(this.g);if(!this.h.i){if(typeof TextDecoder>"u"){O6(this),qf(this);var s="";break t}this.h.i=new tn.TextDecoder}for(t=0;t<i;t++)this.h.h=!0,r+=this.h.i.decode(n[t],{stream:o&&t==i-1});n.length=0,this.h.g+=r,this.o=0,s=this.h.g}else s=this.g.ja();if(this.i=200==e,function OMe(r,t,e,n,i,o,s){r.info(function(){return"XMLHTTP RESP ("+n+") [ attempt "+i+"]: "+t+"\n"+e+"\n"+o+" "+s})}(this.j,this.v,this.B,this.m,this.W,u,e),this.i){if(this.aa&&!this.K){t:{if(this.g){var a,c=this.g;if((a=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Lf(a)){var l=a;break t}}l=null}if(!(e=l)){this.i=!1,this.s=3,co(12),O6(this),qf(this);break e}e5(this.j,this.m,e,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,aT(this,e)}this.S?(vq(this,u,s),zO&&this.i&&3==u&&(sq(this.U,this.V,"tick",this.mb),this.V.start())):(e5(this.j,this.m,s,null),aT(this,s)),4==u&&O6(this),this.i&&!this.J&&(4==u?jq(this.l,this):(this.i=!1,Wf(this)))}else(function YMe(r){const t={};r=(r.g&&2<=Nc(r)&&r.g.getAllResponseHeaders()||"").split("\r\n");for(let n=0;n<r.length;n++){if(Lf(r[n]))continue;var e=yMe(r[n]);const i=e[0];if("string"!=typeof(e=e[1]))continue;e=e.trim();const o=t[i]||[];t[i]=o,o.push(e)}!function hMe(r,t){for(const e in r)t.call(void 0,r[e],e,r)}(t,function(n){return n.join(", ")})})(this.g),400==e&&0<s.indexOf("Unknown SID")?(this.s=3,co(12)):(this.s=0,co(13)),O6(this),qf(this)}}}catch{}},et.mb=function(){if(this.g){var r=Nc(this.g),t=this.g.ja();this.o<t.length&&(Am(this),vq(this,r,t),this.i&&4!=r&&Wf(this))}},et.cancel=function(){this.J=!0,O6(this)},et.lb=function(){this.C=null;const r=Date.now();0<=r-this.Y?(function TMe(r,t){r.info(function(){return"TIMEOUT: "+t})}(this.j,this.B),2!=this.L&&(Uf(),co(17)),O6(this),this.s=2,qf(this)):yq(this,this.Y-r)};var Eq=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function T6(r){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,r instanceof T6){this.h=r.h,Nm(this,r.j),this.s=r.s,this.g=r.g,Im(this,r.m),this.l=r.l;var t=r.i,e=new Yf;e.i=t.i,t.g&&(e.g=new Map(t.g),e.h=t.h),Pq(this,e),this.o=r.o}else r&&(t=String(r).match(Eq))?(this.h=!1,Nm(this,t[1]||"",!0),this.s=jf(t[2]||""),this.g=jf(t[3]||"",!0),Im(this,t[4]),this.l=jf(t[5]||"",!0),Pq(this,t[6]||"",!0),this.o=jf(t[7]||"")):(this.h=!1,this.i=new Yf(null,this.h))}function x3(r){return new T6(r)}function Nm(r,t,e){r.j=e?jf(t,!0):t,r.j&&(r.j=r.j.replace(/:$/,""))}function Im(r,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);r.m=t}else r.m=null}function Pq(r,t,e){t instanceof Yf?(r.i=t,function VMe(r,t){t&&!r.j&&(K4(r),r.i=null,r.g.forEach(function(e,n){var i=n.toLowerCase();n!=i&&(Oq(this,n),wq(this,i,e))},r)),r.j=t}(r.i,r.h)):(e||(t=Zf(t,zMe)),r.i=new Yf(t,r.h))}function Y1(r,t,e){r.i.set(t,e)}function km(r){return Y1(r,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),r}function jf(r,t){return r?t?decodeURI(r.replace(/%25/g,"%2525")):decodeURIComponent(r):""}function Zf(r,t,e){return"string"==typeof r?(r=encodeURI(r).replace(t,RMe),e&&(r=r.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),r):null}function RMe(r){return"%"+((r=r.charCodeAt(0))>>4&15).toString(16)+(15&r).toString(16)}T6.prototype.toString=function(){var r=[],t=this.j;t&&r.push(Zf(t,Sq,!0),":");var e=this.g;return(e||"file"==t)&&(r.push("//"),(t=this.s)&&r.push(Zf(t,Sq,!0),"@"),r.push(encodeURIComponent(String(e)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(e=this.m)&&r.push(":",String(e))),(e=this.l)&&(this.g&&"/"!=e.charAt(0)&&r.push("/"),r.push(Zf(e,"/"==e.charAt(0)?LMe:xMe,!0))),(e=this.i.toString())&&r.push("?",e),(e=this.o)&&r.push("#",Zf(e,DMe)),r.join("")};var Sq=/[#\/\?@]/g,xMe=/[#\?:]/g,LMe=/[#\?]/g,zMe=/[#\?@]/g,DMe=/#/g;function Yf(r,t){this.h=this.g=null,this.i=r||null,this.j=!!t}function K4(r){r.g||(r.g=new Map,r.h=0,r.i&&function kMe(r,t){if(r){r=r.split("&");for(var e=0;e<r.length;e++){var n=r[e].indexOf("="),i=null;if(0<=n){var o=r[e].substring(0,n);i=r[e].substring(n+1)}else o=r[e];t(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(r.i,function(t,e){r.add(decodeURIComponent(t.replace(/\+/g," ")),e)}))}function Oq(r,t){K4(r),t=t5(r,t),r.g.has(t)&&(r.i=null,r.h-=r.g.get(t).length,r.g.delete(t))}function Tq(r,t){return K4(r),t=t5(r,t),r.g.has(t)}function wq(r,t,e){Oq(r,t),0<e.length&&(r.i=null,r.g.set(t5(r,t),xO(e)),r.h+=e.length)}function t5(r,t){return t=String(t),r.j&&(t=t.toLowerCase()),t}(et=Yf.prototype).add=function(r,t){K4(this),this.i=null,r=t5(this,r);var e=this.g.get(r);return e||this.g.set(r,e=[]),e.push(t),this.h+=1,this},et.forEach=function(r,t){K4(this),this.g.forEach(function(e,n){e.forEach(function(i){r.call(t,i,n,this)},this)},this)},et.ta=function(){K4(this);const r=Array.from(this.g.values()),t=Array.from(this.g.keys()),e=[];for(let n=0;n<t.length;n++){const i=r[n];for(let o=0;o<i.length;o++)e.push(t[n])}return e},et.Z=function(r){K4(this);let t=[];if("string"==typeof r)Tq(this,r)&&(t=t.concat(this.g.get(t5(this,r))));else{r=Array.from(this.g.values());for(let e=0;e<r.length;e++)t=t.concat(r[e])}return t},et.set=function(r,t){return K4(this),this.i=null,Tq(this,r=t5(this,r))&&(this.h-=this.g.get(r).length),this.g.set(r,[t]),this.h+=1,this},et.get=function(r,t){return r&&0<(r=this.Z(r)).length?String(r[0]):t},et.toString=function(){if(this.i)return this.i;if(!this.g)return"";const r=[],t=Array.from(this.g.keys());for(var e=0;e<t.length;e++){var n=t[e];const o=encodeURIComponent(String(n)),s=this.Z(n);for(n=0;n<s.length;n++){var i=o;""!==s[n]&&(i+="="+encodeURIComponent(String(s[n]))),r.push(i)}}return this.i=r.join("&")};var HMe=class{constructor(r,t){this.g=r,this.map=t}};function bq(r){this.l=r||FMe,r=tn.PerformanceNavigationTiming?0<(r=tn.performance.getEntriesByType("navigation")).length&&("hq"==r[0].nextHopProtocol||"h2"==r[0].nextHopProtocol):!!(tn.g&&tn.g.Ka&&tn.g.Ka()&&tn.g.Ka().dc),this.j=r?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var FMe=10;function Aq(r){return!!r.h||!!r.g&&r.g.size>=r.j}function Nq(r){return r.h?1:r.g?r.g.size:0}function cT(r,t){return r.h?r.h==t:!!r.g&&r.g.has(t)}function lT(r,t){r.g?r.g.add(t):r.h=t}function Iq(r,t){r.h&&r.h==t?r.h=null:r.g&&r.g.has(t)&&r.g.delete(t)}function kq(r){if(null!=r.h)return r.i.concat(r.h.F);if(null!=r.g&&0!==r.g.size){let t=r.i;for(const e of r.g.values())t=t.concat(e.F);return t}return xO(r.i)}bq.prototype.cancel=function(){if(this.i=kq(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const r of this.g.values())r.cancel();this.g.clear()}};var UMe=class{stringify(r){return tn.JSON.stringify(r,void 0)}parse(r){return tn.JSON.parse(r,void 0)}};function GMe(){this.g=new UMe}function BMe(r,t,e){const n=e||"";try{Mq(r,function(i,o){let s=i;xf(i)&&(s=XO(i)),t.push(n+o+"="+encodeURIComponent(s))})}catch(i){throw t.push(n+"type="+encodeURIComponent("_badmap")),i}}function Rm(r,t,e,n,i){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,i(n)}catch{}}function Kf(r){this.l=r.ec||null,this.j=r.ob||!1}function xm(r,t){Di.call(this),this.F=r,this.u=t,this.m=void 0,this.readyState=uT,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}zi(Kf,tT),Kf.prototype.g=function(){return new xm(this.l,this.j)},Kf.prototype.i=function(r){return function(){return r}}({}),zi(xm,Di);var uT=0;function Rq(r){r.j.read().then(r.Xa.bind(r)).catch(r.ka.bind(r))}function Xf(r){r.readyState=4,r.l=null,r.j=null,r.A=null,Qf(r)}function Qf(r){r.onreadystatechange&&r.onreadystatechange.call(r)}(et=xm.prototype).open=function(r,t){if(this.readyState!=uT)throw this.abort(),Error("Error reopening a connection");this.C=r,this.B=t,this.readyState=1,Qf(this)},et.send=function(r){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};r&&(t.body=r),(this.F||tn).fetch(new Request(this.B,t)).then(this.$a.bind(this),this.ka.bind(this))},et.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Xf(this)),this.readyState=uT},et.$a=function(r){if(this.g&&(this.l=r,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=r.headers,this.readyState=2,Qf(this)),this.g&&(this.readyState=3,Qf(this),this.g)))if("arraybuffer"===this.responseType)r.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof tn.ReadableStream<"u"&&"body"in r){if(this.j=r.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;Rq(this)}else r.text().then(this.Za.bind(this),this.ka.bind(this))},et.Xa=function(r){if(this.g){if(this.u&&r.value)this.response.push(r.value);else if(!this.u){var t=r.value?r.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!r.done}))&&(this.response=this.responseText+=t)}r.done?Xf(this):Qf(this),3==this.readyState&&Rq(this)}},et.Za=function(r){this.g&&(this.response=this.responseText=r,Xf(this))},et.Ya=function(r){this.g&&(this.response=r,Xf(this))},et.ka=function(){this.g&&Xf(this)},et.setRequestHeader=function(r,t){this.v.append(r,t)},et.getResponseHeader=function(r){return this.h&&this.h.get(r.toLowerCase())||""},et.getAllResponseHeaders=function(){if(!this.h)return"";const r=[],t=this.h.entries();for(var e=t.next();!e.done;)r.push((e=e.value)[0]+": "+e[1]),e=t.next();return r.join("\r\n")},Object.defineProperty(xm.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(r){this.m=r?"include":"same-origin"}});var WMe=tn.JSON.parse;function Tr(r){Di.call(this),this.headers=new Map,this.u=r||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=xq,this.L=this.M=!1}zi(Tr,Di);var xq="",qMe=/^https?$/i,jMe=["POST","PUT"];function Lq(r,t){r.h=!1,r.g&&(r.l=!0,r.g.abort(),r.l=!1),r.j=t,r.m=5,zq(r),Lm(r)}function zq(r){r.F||(r.F=!0,o2(r,"complete"),o2(r,"error"))}function Dq(r){if(r.h&&typeof kO<"u"&&(!r.C[1]||4!=Nc(r)||2!=r.da()))if(r.v&&4==Nc(r))eT(r.La,0,r);else if(o2(r,"readystatechange"),4==Nc(r)){r.h=!1;try{const s=r.da();e:switch(s){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var e;if(!(e=t)){var n;if(n=0===s){var i=String(r.I).match(Eq)[1]||null;!i&&tn.self&&tn.self.location&&(i=tn.self.location.protocol.slice(0,-1)),n=!qMe.test(i?i.toLowerCase():"")}e=n}if(e)o2(r,"complete"),o2(r,"success");else{r.m=6;try{var o=2<Nc(r)?r.g.statusText:""}catch{o=""}r.j=o+" ["+r.da()+"]",zq(r)}}finally{Lm(r)}}}function Lm(r,t){if(r.g){Vq(r);const e=r.g,n=r.C[0]?()=>{}:null;r.g=null,r.C=null,t||o2(r,"ready");try{e.onreadystatechange=n}catch{}}}function Vq(r){r.g&&r.L&&(r.g.ontimeout=null),r.A&&(tn.clearTimeout(r.A),r.A=null)}function Nc(r){return r.g?r.g.readyState:0}function Hq(r){try{if(!r.g)return null;if("response"in r.g)return r.g.response;switch(r.K){case xq:case"text":return r.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in r.g)return r.g.mozResponseArrayBuffer}return null}catch{return null}}function Fq(r){let t="";return GO(r,function(e,n){t+=n,t+=":",t+=e,t+="\r\n"}),t}function fT(r,t,e){e:{for(n in e){var n=!1;break e}n=!0}n||(e=Fq(e),"string"==typeof r?null!=e&&encodeURIComponent(String(e)):Y1(r,t,e))}function Jf(r,t,e){return e&&e.internalChannelParams&&e.internalChannelParams[r]||t}function Uq(r){this.Ga=0,this.j=[],this.l=new Om,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=Jf("failFast",!1,r),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=Jf("baseRetryDelayMs",5e3,r),this.hb=Jf("retryDelaySeedMs",1e4,r),this.eb=Jf("forwardChannelMaxRetries",2,r),this.xa=Jf("forwardChannelRequestTimeoutMs",2e4,r),this.va=r&&r.xmlHttpFactory||void 0,this.Ha=r&&r.useFetchStreams||!1,this.L=void 0,this.J=r&&r.supportsCrossDomainXhr||!1,this.K="",this.i=new bq(r&&r.concurrentRequestLimit),this.Ja=new GMe,this.P=r&&r.fastHandshake||!1,this.O=r&&r.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=r&&r.bc||!1,r&&r.Ea&&this.l.Ea(),r&&r.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&r&&r.detectBufferingProxy||!1,this.qa=void 0,r&&r.longPollingTimeout&&0<r.longPollingTimeout&&(this.qa=r.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}function dT(r){if(Gq(r),3==r.H){var t=r.W++,e=x3(r.I);if(Y1(e,"SID",r.K),Y1(e,"RID",t),Y1(e,"TYPE","terminate"),e9(r,e),(t=new $f(r,r.l,t)).L=2,t.A=km(x3(e)),e=!1,tn.navigator&&tn.navigator.sendBeacon)try{e=tn.navigator.sendBeacon(t.A.toString(),"")}catch{}!e&&tn.Image&&((new Image).src=t.A,e=!0),e||(t.g=Xq(t.l,null),t.g.ha(t.A)),t.G=Date.now(),Wf(t)}Yq(r)}function zm(r){r.g&&(gT(r),r.g.cancel(),r.g=null)}function Gq(r){zm(r),r.u&&(tn.clearTimeout(r.u),r.u=null),Vm(r),r.i.cancel(),r.m&&("number"==typeof r.m&&tn.clearTimeout(r.m),r.m=null)}function Dm(r){if(!Aq(r.i)&&!r.m){r.m=!0;var t=r.Na;Vf||rq(),Hf||(Vf(),Hf=!0),QO.add(t,r),r.C=0}}function Bq(r,t){var e;e=t?t.m:r.W++;const n=x3(r.I);Y1(n,"SID",r.K),Y1(n,"RID",e),Y1(n,"AID",r.V),e9(r,n),r.o&&r.s&&fT(n,r.o,r.s),e=new $f(r,r.l,e,r.C+1),null===r.o&&(e.I=r.s),t&&(r.j=t.F.concat(r.j)),t=$q(r,e,1e3),e.setTimeout(Math.round(.5*r.xa)+Math.round(.5*r.xa*Math.random())),lT(r.i,e),sT(e,n,t)}function e9(r,t){r.na&&GO(r.na,function(e,n){Y1(t,n,e)}),r.h&&Mq({},function(e,n){Y1(t,n,e)})}function $q(r,t,e){e=Math.min(r.j.length,e);var n=r.h?D2(r.h.Va,r.h,r):null;e:{var i=r.j;let o=-1;for(;;){const s=["count="+e];-1==o?0<e?(o=i[0].g,s.push("ofs="+o)):o=0:s.push("ofs="+o);let a=!0;for(let c=0;c<e;c++){let l=i[c].g;const u=i[c].map;if(l-=o,0>l)o=Math.max(0,i[c].g-100),a=!1;else try{BMe(u,s,"req"+l+"_")}catch{n&&n(u)}}if(a){n=s.join("&");break e}}}return r=r.j.splice(0,e),t.F=r,n}function Wq(r){if(!r.g&&!r.u){r.ba=1;var t=r.Ma;Vf||rq(),Hf||(Vf(),Hf=!0),QO.add(t,r),r.A=0}}function hT(r){return!(r.g||r.u||3<=r.A||(r.ba++,r.u=Gf(D2(r.Ma,r),Zq(r,r.A)),r.A++,0))}function gT(r){null!=r.B&&(tn.clearTimeout(r.B),r.B=null)}function qq(r){r.g=new $f(r,r.l,"rpc",r.ba),null===r.o&&(r.g.I=r.s),r.g.O=0;var t=x3(r.wa);Y1(t,"RID","rpc"),Y1(t,"SID",r.K),Y1(t,"AID",r.V),Y1(t,"CI",r.G?"0":"1"),!r.G&&r.qa&&Y1(t,"TO",r.qa),Y1(t,"TYPE","xmlhttp"),e9(r,t),r.o&&r.s&&fT(t,r.o,r.s),r.L&&r.g.setTimeout(r.L);var e=r.g;r=r.pa,e.L=1,e.A=km(x3(t)),e.u=null,e.S=!0,_q(e,r)}function Vm(r){null!=r.v&&(tn.clearTimeout(r.v),r.v=null)}function jq(r,t){var e=null;if(r.g==t){Vm(r),gT(r),r.g=null;var n=2}else{if(!cT(r.i,t))return;e=t.F,Iq(r.i,t),n=1}if(0!=r.H)if(t.i)if(1==n){e=t.u?t.u.length:0,t=Date.now()-t.G;var i=r.C;o2(n=Tm(),new fq(n,e)),Dm(r)}else Wq(r);else if(3==(i=t.s)||0==i&&0<t.ca||!(1==n&&function KMe(r,t){return!(Nq(r.i)>=r.i.j-(r.m?1:0)||(r.m?(r.j=t.F.concat(r.j),0):1==r.H||2==r.H||r.C>=(r.cb?0:r.eb)||(r.m=Gf(D2(r.Na,r,t),Zq(r,r.C)),r.C++,0)))}(r,t)||2==n&&hT(r)))switch(e&&0<e.length&&(t=r.i,t.i=t.i.concat(e)),i){case 1:w6(r,5);break;case 4:w6(r,10);break;case 3:w6(r,6);break;default:w6(r,2)}}function Zq(r,t){let e=r.ab+Math.floor(Math.random()*r.hb);return r.isActive()||(e*=2),e*t}function w6(r,t){if(r.l.info("Error code "+t),2==t){var e=null;r.h&&(e=null);var n=D2(r.pb,r);e||(e=new T6("//www.google.com/images/cleardot.gif"),tn.location&&"http"==tn.location.protocol||Nm(e,"https"),km(e)),function $Me(r,t){const e=new Om;if(tn.Image){const n=new Image;n.onload=vm(Rm,e,n,"TestLoadImage: loaded",!0,t),n.onerror=vm(Rm,e,n,"TestLoadImage: error",!1,t),n.onabort=vm(Rm,e,n,"TestLoadImage: abort",!1,t),n.ontimeout=vm(Rm,e,n,"TestLoadImage: timeout",!1,t),tn.setTimeout(function(){n.ontimeout&&n.ontimeout()},1e4),n.src=r}else t(!1)}(e.toString(),n)}else co(2);r.H=0,r.h&&r.h.za(t),Yq(r),Gq(r)}function Yq(r){if(r.H=0,r.ma=[],r.h){const t=kq(r.i);(0!=t.length||0!=r.j.length)&&(BW(r.ma,t),BW(r.ma,r.j),r.i.i.length=0,xO(r.j),r.j.length=0),r.h.ya()}}function Kq(r,t,e){var n=e instanceof T6?x3(e):new T6(e);if(""!=n.g)t&&(n.g=t+"."+n.g),Im(n,n.m);else{var i=tn.location;n=i.protocol,t=t?t+"."+i.hostname:i.hostname,i=+i.port;var o=new T6(null);n&&Nm(o,n),t&&(o.g=t),i&&Im(o,i),e&&(o.l=e),n=o}return t=r.Da,(e=r.F)&&t&&Y1(n,e,t),Y1(n,"VER",r.ra),e9(r,n),n}function Xq(r,t,e){if(t&&!r.J)throw Error("Can't create secondary domain capable XhrIo object.");return(t=new Tr(r.Ha&&!r.va?new Kf({ob:e}):r.va)).Oa(r.J),t}function Qq(){}function Hm(){if(J8&&!(10<=Number(lMe)))throw Error("Environmental error: no available transport.")}function us(r,t){Di.call(this),this.g=new Uq(t),this.l=r,this.h=t&&t.messageUrlParams||null,r=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(r?r["X-Client-Protocol"]="webchannel":r={"X-Client-Protocol":"webchannel"}),this.g.s=r,r=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(r?r["X-WebChannel-Content-Type"]=t.messageContentType:r={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.Ca&&(r?r["X-WebChannel-Client-Profile"]=t.Ca:r={"X-WebChannel-Client-Profile":t.Ca}),this.g.U=r,(r=t&&t.cc)&&!Lf(r)&&(this.g.o=r),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!Lf(t)&&(this.g.F=t,null!==(r=this.h)&&t in r&&t in(r=this.h)&&delete r[t]),this.j=new n5(this)}function Jq(r){nT.call(this),r.__headers__&&(this.headers=r.__headers__,this.statusCode=r.__status__,delete r.__headers__,delete r.__status__);var t=r.__sm__;if(t){e:{for(const e in t){r=e;break e}r=void 0}(this.i=r)&&(r=this.i,t=null!==t&&r in t?t[r]:void 0),this.data=t}else this.data=r}function ej(){rT.call(this),this.status=1}function n5(r){this.g=r}function La(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}function pT(r,t,e){e||(e=0);var n=Array(16);if("string"==typeof t)for(var i=0;16>i;++i)n[i]=t.charCodeAt(e++)|t.charCodeAt(e++)<<8|t.charCodeAt(e++)<<16|t.charCodeAt(e++)<<24;else for(i=0;16>i;++i)n[i]=t[e++]|t[e++]<<8|t[e++]<<16|t[e++]<<24;var o=r.g[3],s=(t=r.g[0])+(o^(e=r.g[1])&((i=r.g[2])^o))+n[0]+3614090360&4294967295;s=(e=(i=(o=(t=(e=(i=(o=(t=(e=(i=(o=(t=(e=(i=(o=(t=(e=(i=(o=(t=(e=(i=(o=(t=(e=(i=(o=(t=(e=(i=(o=(t=(e=(i=(o=(t=(e=(i=(o=(t=(e=(i=(o=(t=(e=(i=(o=(t=(e=(i=(o=(t=(e=(i=(o=(t=(e=(i=(o=(t=e+(s<<7&4294967295|s>>>25))+((s=o+(i^t&(e^i))+n[1]+3905402710&4294967295)<<12&4294967295|s>>>20))+((s=i+(e^o&(t^e))+n[2]+606105819&4294967295)<<17&4294967295|s>>>15))+((s=e+(t^i&(o^t))+n[3]+3250441966&4294967295)<<22&4294967295|s>>>10))+((s=t+(o^e&(i^o))+n[4]+4118548399&4294967295)<<7&4294967295|s>>>25))+((s=o+(i^t&(e^i))+n[5]+1200080426&4294967295)<<12&4294967295|s>>>20))+((s=i+(e^o&(t^e))+n[6]+2821735955&4294967295)<<17&4294967295|s>>>15))+((s=e+(t^i&(o^t))+n[7]+4249261313&4294967295)<<22&4294967295|s>>>10))+((s=t+(o^e&(i^o))+n[8]+1770035416&4294967295)<<7&4294967295|s>>>25))+((s=o+(i^t&(e^i))+n[9]+2336552879&4294967295)<<12&4294967295|s>>>20))+((s=i+(e^o&(t^e))+n[10]+4294925233&4294967295)<<17&4294967295|s>>>15))+((s=e+(t^i&(o^t))+n[11]+2304563134&4294967295)<<22&4294967295|s>>>10))+((s=t+(o^e&(i^o))+n[12]+1804603682&4294967295)<<7&4294967295|s>>>25))+((s=o+(i^t&(e^i))+n[13]+4254626195&4294967295)<<12&4294967295|s>>>20))+((s=i+(e^o&(t^e))+n[14]+2792965006&4294967295)<<17&4294967295|s>>>15))+((s=e+(t^i&(o^t))+n[15]+1236535329&4294967295)<<22&4294967295|s>>>10))+((s=t+(i^o&(e^i))+n[1]+4129170786&4294967295)<<5&4294967295|s>>>27))+((s=o+(e^i&(t^e))+n[6]+3225465664&4294967295)<<9&4294967295|s>>>23))+((s=i+(t^e&(o^t))+n[11]+643717713&4294967295)<<14&4294967295|s>>>18))+((s=e+(o^t&(i^o))+n[0]+3921069994&4294967295)<<20&4294967295|s>>>12))+((s=t+(i^o&(e^i))+n[5]+3593408605&4294967295)<<5&4294967295|s>>>27))+((s=o+(e^i&(t^e))+n[10]+38016083&4294967295)<<9&4294967295|s>>>23))+((s=i+(t^e&(o^t))+n[15]+3634488961&4294967295)<<14&4294967295|s>>>18))+((s=e+(o^t&(i^o))+n[4]+3889429448&4294967295)<<20&4294967295|s>>>12))+((s=t+(i^o&(e^i))+n[9]+568446438&4294967295)<<5&4294967295|s>>>27))+((s=o+(e^i&(t^e))+n[14]+3275163606&4294967295)<<9&4294967295|s>>>23))+((s=i+(t^e&(o^t))+n[3]+4107603335&4294967295)<<14&4294967295|s>>>18))+((s=e+(o^t&(i^o))+n[8]+1163531501&4294967295)<<20&4294967295|s>>>12))+((s=t+(i^o&(e^i))+n[13]+2850285829&4294967295)<<5&4294967295|s>>>27))+((s=o+(e^i&(t^e))+n[2]+4243563512&4294967295)<<9&4294967295|s>>>23))+((s=i+(t^e&(o^t))+n[7]+1735328473&4294967295)<<14&4294967295|s>>>18))+((s=e+(o^t&(i^o))+n[12]+2368359562&4294967295)<<20&4294967295|s>>>12))+((s=t+(e^i^o)+n[5]+4294588738&4294967295)<<4&4294967295|s>>>28))+((s=o+(t^e^i)+n[8]+2272392833&4294967295)<<11&4294967295|s>>>21))+((s=i+(o^t^e)+n[11]+1839030562&4294967295)<<16&4294967295|s>>>16))+((s=e+(i^o^t)+n[14]+4259657740&4294967295)<<23&4294967295|s>>>9))+((s=t+(e^i^o)+n[1]+2763975236&4294967295)<<4&4294967295|s>>>28))+((s=o+(t^e^i)+n[4]+1272893353&4294967295)<<11&4294967295|s>>>21))+((s=i+(o^t^e)+n[7]+4139469664&4294967295)<<16&4294967295|s>>>16))+((s=e+(i^o^t)+n[10]+3200236656&4294967295)<<23&4294967295|s>>>9))+((s=t+(e^i^o)+n[13]+681279174&4294967295)<<4&4294967295|s>>>28))+((s=o+(t^e^i)+n[0]+3936430074&4294967295)<<11&4294967295|s>>>21))+((s=i+(o^t^e)+n[3]+3572445317&4294967295)<<16&4294967295|s>>>16))+((s=e+(i^o^t)+n[6]+76029189&4294967295)<<23&4294967295|s>>>9))+((s=t+(e^i^o)+n[9]+3654602809&4294967295)<<4&4294967295|s>>>28))+((s=o+(t^e^i)+n[12]+3873151461&4294967295)<<11&4294967295|s>>>21))+((s=i+(o^t^e)+n[15]+530742520&4294967295)<<16&4294967295|s>>>16))+((s=e+(i^o^t)+n[2]+3299628645&4294967295)<<23&4294967295|s>>>9))+((s=t+(i^(e|~o))+n[0]+4096336452&4294967295)<<6&4294967295|s>>>26))+((s=o+(e^(t|~i))+n[7]+1126891415&4294967295)<<10&4294967295|s>>>22))+((s=i+(t^(o|~e))+n[14]+2878612391&4294967295)<<15&4294967295|s>>>17))+((s=e+(o^(i|~t))+n[5]+4237533241&4294967295)<<21&4294967295|s>>>11))+((s=t+(i^(e|~o))+n[12]+1700485571&4294967295)<<6&4294967295|s>>>26))+((s=o+(e^(t|~i))+n[3]+2399980690&4294967295)<<10&4294967295|s>>>22))+((s=i+(t^(o|~e))+n[10]+4293915773&4294967295)<<15&4294967295|s>>>17))+((s=e+(o^(i|~t))+n[1]+2240044497&4294967295)<<21&4294967295|s>>>11))+((s=t+(i^(e|~o))+n[8]+1873313359&4294967295)<<6&4294967295|s>>>26))+((s=o+(e^(t|~i))+n[15]+4264355552&4294967295)<<10&4294967295|s>>>22))+((s=i+(t^(o|~e))+n[6]+2734768916&4294967295)<<15&4294967295|s>>>17))+((s=e+(o^(i|~t))+n[13]+1309151649&4294967295)<<21&4294967295|s>>>11))+((o=(t=e+((s=t+(i^(e|~o))+n[4]+4149444226&4294967295)<<6&4294967295|s>>>26))+((s=o+(e^(t|~i))+n[11]+3174756917&4294967295)<<10&4294967295|s>>>22))^((i=o+((s=i+(t^(o|~e))+n[2]+718787259&4294967295)<<15&4294967295|s>>>17))|~t))+n[9]+3951481745&4294967295,r.g[0]=r.g[0]+t&4294967295,r.g[1]=r.g[1]+(i+(s<<21&4294967295|s>>>11))&4294967295,r.g[2]=r.g[2]+i&4294967295,r.g[3]=r.g[3]+o&4294967295}function h1(r,t){this.h=t;for(var e=[],n=!0,i=r.length-1;0<=i;i--){var o=0|r[i];n&&o==t||(e[i]=o,n=!1)}this.g=e}(et=Tr.prototype).Oa=function(r){this.M=r},et.ha=function(r,t,e,n){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+r);t=t?t.toUpperCase():"GET",this.I=r,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():iT.g(),this.C=function hq(r){return r.h||(r.h=r.i())}(this.u?this.u:iT),this.g.onreadystatechange=D2(this.La,this);try{this.G=!0,this.g.open(t,String(r),!0),this.G=!1}catch(o){return void Lq(this,o)}if(r=e||"",e=new Map(this.headers),n)if(Object.getPrototypeOf(n)===Object.prototype)for(var i in n)e.set(i,n[i]);else{if("function"!=typeof n.keys||"function"!=typeof n.get)throw Error("Unknown input type for opt_headers: "+String(n));for(const o of n.keys())e.set(o,n.get(o))}n=Array.from(e.keys()).find(o=>"content-type"==o.toLowerCase()),i=tn.FormData&&r instanceof tn.FormData,!(0<=GW(jMe,t))||n||i||e.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[o,s]of e)this.g.setRequestHeader(o,s);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{Vq(this),0<this.B&&((this.L=function ZMe(r){return J8&&"number"==typeof r.timeout&&void 0!==r.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=D2(this.ua,this)):this.A=eT(this.ua,this.B,this)),this.v=!0,this.g.send(r),this.v=!1}catch(o){Lq(this,o)}},et.ua=function(){typeof kO<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,o2(this,"timeout"),this.abort(8))},et.abort=function(r){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=r||7,o2(this,"complete"),o2(this,"abort"),Lm(this))},et.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Lm(this,!0)),Tr.$.N.call(this)},et.La=function(){this.s||(this.G||this.v||this.l?Dq(this):this.kb())},et.kb=function(){Dq(this)},et.isActive=function(){return!!this.g},et.da=function(){try{return 2<Nc(this)?this.g.status:-1}catch{return-1}},et.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}},et.Wa=function(r){if(this.g){var t=this.g.responseText;return r&&0==t.indexOf(r)&&(t=t.substring(r.length)),WMe(t)}},et.Ia=function(){return this.m},et.Sa=function(){return"string"==typeof this.j?this.j:String(this.j)},(et=Uq.prototype).ra=8,et.H=1,et.Na=function(r){if(this.m)if(this.m=null,1==this.H){if(!r){this.W=Math.floor(1e5*Math.random()),r=this.W++;const i=new $f(this,this.l,r);let o=this.s;if(this.U&&(o?(o=ZW(o),KW(o,this.U)):o=this.U),null!==this.o||this.O||(i.I=o,o=null),this.P)e:{for(var t=0,e=0;e<this.j.length;e++){var n=this.j[e];if(void 0===(n="__data__"in n.map&&"string"==typeof(n=n.map.__data__)?n.length:void 0))break;if(4096<(t+=n)){t=e;break e}if(4096===t||e===this.j.length-1){t=e+1;break e}}t=1e3}else t=1e3;t=$q(this,i,t),Y1(e=x3(this.I),"RID",r),Y1(e,"CVER",22),this.F&&Y1(e,"X-HTTP-Session-Id",this.F),e9(this,e),o&&(this.O?t="headers="+encodeURIComponent(String(Fq(o)))+"&"+t:this.o&&fT(e,this.o,o)),lT(this.i,i),this.bb&&Y1(e,"TYPE","init"),this.P?(Y1(e,"$req",t),Y1(e,"SID","null"),i.aa=!0,sT(i,e,null)):sT(i,e,t),this.H=2}}else 3==this.H&&(r?Bq(this,r):0==this.j.length||Aq(this.i)||Bq(this))},et.Ma=function(){if(this.u=null,qq(this),this.ca&&!(this.M||null==this.g||0>=this.S)){var r=2*this.S;this.l.info("BP detection timer enabled: "+r),this.B=Gf(D2(this.jb,this),r)}},et.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,co(10),zm(this),qq(this))},et.ib=function(){null!=this.v&&(this.v=null,zm(this),hT(this),co(19))},et.pb=function(r){r?(this.l.info("Successfully pinged google.com"),co(2)):(this.l.info("Failed to ping google.com"),co(1))},et.isActive=function(){return!!this.h&&this.h.isActive(this)},(et=Qq.prototype).Ba=function(){},et.Aa=function(){},et.za=function(){},et.ya=function(){},et.isActive=function(){return!0},et.Va=function(){},Hm.prototype.g=function(r,t){return new us(r,t)},zi(us,Di),us.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var r=this.g,t=this.l,e=this.h||void 0;co(0),r.Y=t,r.na=e||{},r.G=r.aa,r.I=Kq(r,null,r.Y),Dm(r)},us.prototype.close=function(){dT(this.g)},us.prototype.u=function(r){var t=this.g;if("string"==typeof r){var e={};e.__data__=r,r=e}else this.v&&((e={}).__data__=XO(r),r=e);t.j.push(new HMe(t.fb++,r)),3==t.H&&Dm(t)},us.prototype.N=function(){this.g.h=null,delete this.j,dT(this.g),delete this.g,us.$.N.call(this)},zi(Jq,nT),zi(ej,rT),zi(n5,Qq),n5.prototype.Ba=function(){o2(this.g,"a")},n5.prototype.Aa=function(r){o2(this.g,new Jq(r))},n5.prototype.za=function(r){o2(this.g,new ej)},n5.prototype.ya=function(){o2(this.g,"b")},zi(La,function XMe(){this.blockSize=-1}),La.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0},La.prototype.j=function(r,t){void 0===t&&(t=r.length);for(var e=t-this.blockSize,n=this.m,i=this.h,o=0;o<t;){if(0==i)for(;o<=e;)pT(this,r,o),o+=this.blockSize;if("string"==typeof r){for(;o<t;)if(n[i++]=r.charCodeAt(o++),i==this.blockSize){pT(this,n),i=0;break}}else for(;o<t;)if(n[i++]=r[o++],i==this.blockSize){pT(this,n),i=0;break}}this.h=i,this.i+=t},La.prototype.l=function(){var r=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);r[0]=128;for(var t=1;t<r.length-8;++t)r[t]=0;var e=8*this.i;for(t=r.length-8;t<r.length;++t)r[t]=255&e,e/=256;for(this.j(r),r=Array(16),t=e=0;4>t;++t)for(var n=0;32>n;n+=8)r[e++]=this.g[t]>>>n&255;return r};var QMe={};function mT(r){return-128<=r&&128>r?function sMe(r,t){var e=QMe;return Object.prototype.hasOwnProperty.call(e,r)?e[r]:e[r]=t(r)}(r,function(t){return new h1([0|t],0>t?-1:0)}):new h1([0|r],0>r?-1:0)}function Ic(r){if(isNaN(r)||!isFinite(r))return r5;if(0>r)return s2(Ic(-r));for(var t=[],e=1,n=0;r>=e;n++)t[n]=r/e|0,e*=_T;return new h1(t,0)}var _T=4294967296,r5=mT(0),CT=mT(1),nj=mT(16777216);function L3(r){if(0!=r.h)return!1;for(var t=0;t<r.g.length;t++)if(0!=r.g[t])return!1;return!0}function $s(r){return-1==r.h}function s2(r){for(var t=r.g.length,e=[],n=0;n<t;n++)e[n]=~r.g[n];return new h1(e,~r.h).add(CT)}function Fm(r,t){return r.add(s2(t))}function Um(r,t){for(;(65535&r[t])!=r[t];)r[t+1]+=r[t]>>>16,r[t]&=65535,t++}function t9(r,t){this.g=r,this.h=t}function Gm(r,t){if(L3(t))throw Error("division by zero");if(L3(r))return new t9(r5,r5);if($s(r))return t=Gm(s2(r),t),new t9(s2(t.g),s2(t.h));if($s(t))return t=Gm(r,s2(t)),new t9(s2(t.g),t.h);if(30<r.g.length){if($s(r)||$s(t))throw Error("slowDivide_ only works with positive integers.");for(var e=CT,n=t;0>=n.X(r);)e=rj(e),n=rj(n);var i=i5(e,1),o=i5(n,1);for(n=i5(n,2),e=i5(e,2);!L3(n);){var s=o.add(n);0>=s.X(r)&&(i=i.add(e),o=s),n=i5(n,1),e=i5(e,1)}return t=Fm(r,i.R(t)),new t9(i,t)}for(i=r5;0<=r.X(t);){for(e=Math.max(1,Math.floor(r.ea()/t.ea())),n=48>=(n=Math.ceil(Math.log(e)/Math.LN2))?1:Math.pow(2,n-48),s=(o=Ic(e)).R(t);$s(s)||0<s.X(r);)s=(o=Ic(e-=n)).R(t);L3(o)&&(o=CT),i=i.add(o),r=Fm(r,s)}return new t9(i,r)}function rj(r){for(var t=r.g.length+1,e=[],n=0;n<t;n++)e[n]=r.D(n)<<1|r.D(n-1)>>>31;return new h1(e,r.h)}function i5(r,t){var e=t>>5;t%=32;for(var n=r.g.length-e,i=[],o=0;o<n;o++)i[o]=0<t?r.D(o+e)>>>t|r.D(o+e+1)<<32-t:r.D(o+e);return new h1(i,r.h)}(et=h1.prototype).ea=function(){if($s(this))return-s2(this).ea();for(var r=0,t=1,e=0;e<this.g.length;e++){var n=this.D(e);r+=(0<=n?n:_T+n)*t,t*=_T}return r},et.toString=function(r){if(2>(r=r||10)||36<r)throw Error("radix out of range: "+r);if(L3(this))return"0";if($s(this))return"-"+s2(this).toString(r);for(var t=Ic(Math.pow(r,6)),e=this,n="";;){var i=Gm(e,t).g,o=((0<(e=Fm(e,i.R(t))).g.length?e.g[0]:e.h)>>>0).toString(r);if(L3(e=i))return o+n;for(;6>o.length;)o="0"+o;n=o+n}},et.D=function(r){return 0>r?0:r<this.g.length?this.g[r]:this.h},et.X=function(r){return $s(r=Fm(this,r))?-1:L3(r)?0:1},et.abs=function(){return $s(this)?s2(this):this},et.add=function(r){for(var t=Math.max(this.g.length,r.g.length),e=[],n=0,i=0;i<=t;i++){var o=n+(65535&this.D(i))+(65535&r.D(i)),s=(o>>>16)+(this.D(i)>>>16)+(r.D(i)>>>16);n=s>>>16,e[i]=(s&=65535)<<16|(o&=65535)}return new h1(e,-2147483648&e[e.length-1]?-1:0)},et.R=function(r){if(L3(this)||L3(r))return r5;if($s(this))return $s(r)?s2(this).R(s2(r)):s2(s2(this).R(r));if($s(r))return s2(this.R(s2(r)));if(0>this.X(nj)&&0>r.X(nj))return Ic(this.ea()*r.ea());for(var t=this.g.length+r.g.length,e=[],n=0;n<2*t;n++)e[n]=0;for(n=0;n<this.g.length;n++)for(var i=0;i<r.g.length;i++){var o=this.D(n)>>>16,s=65535&this.D(n),a=r.D(i)>>>16,c=65535&r.D(i);e[2*n+2*i]+=s*c,Um(e,2*n+2*i),e[2*n+2*i+1]+=o*c,Um(e,2*n+2*i+1),e[2*n+2*i+1]+=s*a,Um(e,2*n+2*i+1),e[2*n+2*i+2]+=o*a,Um(e,2*n+2*i+2)}for(n=0;n<t;n++)e[n]=e[2*n+1]<<16|e[2*n];for(n=t;n<2*t;n++)e[n]=0;return new h1(e,0)},et.gb=function(r){return Gm(this,r).h},et.and=function(r){for(var t=Math.max(this.g.length,r.g.length),e=[],n=0;n<t;n++)e[n]=this.D(n)&r.D(n);return new h1(e,this.h&r.h)},et.or=function(r){for(var t=Math.max(this.g.length,r.g.length),e=[],n=0;n<t;n++)e[n]=this.D(n)|r.D(n);return new h1(e,this.h|r.h)},et.xor=function(r){for(var t=Math.max(this.g.length,r.g.length),e=[],n=0;n<t;n++)e[n]=this.D(n)^r.D(n);return new h1(e,this.h^r.h)},Hm.prototype.createWebChannel=Hm.prototype.g,us.prototype.send=us.prototype.u,us.prototype.open=us.prototype.m,us.prototype.close=us.prototype.close,wm.NO_ERROR=0,wm.TIMEOUT=8,wm.HTTP_ERROR=6,dq.COMPLETE="complete",gq.EventType=Bf,Bf.OPEN="a",Bf.CLOSE="b",Bf.ERROR="c",Bf.MESSAGE="d",Di.prototype.listen=Di.prototype.O,Tr.prototype.listenOnce=Tr.prototype.P,Tr.prototype.getLastError=Tr.prototype.Sa,Tr.prototype.getLastErrorCode=Tr.prototype.Ia,Tr.prototype.getStatus=Tr.prototype.da,Tr.prototype.getResponseJson=Tr.prototype.Wa,Tr.prototype.getResponseText=Tr.prototype.ja,Tr.prototype.send=Tr.prototype.ha,Tr.prototype.setWithCredentials=Tr.prototype.Oa,La.prototype.digest=La.prototype.l,La.prototype.reset=La.prototype.reset,La.prototype.update=La.prototype.j,h1.prototype.add=h1.prototype.add,h1.prototype.multiply=h1.prototype.R,h1.prototype.modulo=h1.prototype.gb,h1.prototype.compare=h1.prototype.X,h1.prototype.toNumber=h1.prototype.ea,h1.prototype.toString=h1.prototype.toString,h1.prototype.getBits=h1.prototype.D,h1.fromNumber=Ic,h1.fromString=function tj(r,t){if(0==r.length)throw Error("number format error: empty string");if(2>(t=t||10)||36<t)throw Error("radix out of range: "+t);if("-"==r.charAt(0))return s2(tj(r.substring(1),t));if(0<=r.indexOf("-"))throw Error('number format error: interior "-" character');for(var e=Ic(Math.pow(t,8)),n=r5,i=0;i<r.length;i+=8){var o=Math.min(8,r.length-i),s=parseInt(r.substring(i,i+o),t);8>o?(o=Ic(Math.pow(t,o)),n=n.R(o).add(Ic(s))):n=(n=n.R(e)).add(Ic(s))}return n};var JMe=xa.createWebChannelTransport=function(){return new Hm},eEe=xa.getStatEventTarget=function(){return Tm()},vT=xa.ErrorCode=wm,tEe=xa.EventType=dq,nEe=xa.Event=S6,ij=xa.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},Bm=(xa.FetchXmlHttpFactory=Kf,xa.WebChannel=gq),rEe=xa.XhrIo=Tr,iEe=xa.Md5=La,o5=xa.Integer=h1;const oj="@firebase/firestore";class Vi{constructor(t){this.uid=t}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}Vi.UNAUTHENTICATED=new Vi(null),Vi.GOOGLE_CREDENTIALS=new Vi("google-credentials-uid"),Vi.FIRST_PARTY=new Vi("first-party-uid"),Vi.MOCK_USER=new Vi("mock-user");let s5="10.8.1";const X4=new yO("@firebase/firestore");function a5(){return X4.logLevel}function Se(r,...t){if(X4.logLevel<=kn.DEBUG){const e=t.map(yT);X4.debug(`Firestore (${s5}): ${r}`,...e)}}function Br(r,...t){if(X4.logLevel<=kn.ERROR){const e=t.map(yT);X4.error(`Firestore (${s5}): ${r}`,...e)}}function fs(r,...t){if(X4.logLevel<=kn.WARN){const e=t.map(yT);X4.warn(`Firestore (${s5}): ${r}`,...e)}}function yT(r){if("string"==typeof r)return r;try{return JSON.stringify(r)}catch{return r}}function lt(r="Unexpected state"){const t=`FIRESTORE (${s5}) INTERNAL ASSERTION FAILED: `+r;throw Br(t),new Error(t)}function pt(r,t){r||lt()}function qe(r,t){return r}const ue={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Oe extends bc{constructor(t,e){super(t,e),this.code=t,this.message=e,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Ei{constructor(){this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}}class sj{constructor(t,e){this.user=e,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class oEe{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable(()=>e(Vi.UNAUTHENTICATED))}shutdown(){}}class sEe{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,e){this.changeListener=e,t.enqueueRetryable(()=>e(this.token.user))}shutdown(){this.changeListener=null}}class aEe{constructor(t){this.t=t,this.currentUser=Vi.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,e){var n=this;let i=this.i;const o=l=>this.i!==i?(i=this.i,e(l)):Promise.resolve();let s=new Ei;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Ei,t.enqueueRetryable(()=>o(this.currentUser))};const a=()=>{const l=s;t.enqueueRetryable(M(function*(){yield l.promise,yield o(n.currentUser)}))},c=l=>{Se("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.auth.addAuthTokenListener(this.o),a()};this.t.onInit(l=>c(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?c(l):(Se("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Ei)}},0),a()}getToken(){const t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then(n=>this.i!==t?(Se("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(pt("string"==typeof n.accessToken),new sj(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const t=this.auth&&this.auth.getUid();return pt(null===t||"string"==typeof t),new Vi(t)}}class cEe{constructor(t,e,n){this.l=t,this.h=e,this.P=n,this.type="FirstParty",this.user=Vi.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const t=this.T();return t&&this.I.set("Authorization",t),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class lEe{constructor(t,e,n){this.l=t,this.h=e,this.P=n}getToken(){return Promise.resolve(new cEe(this.l,this.h,this.P))}start(t,e){t.enqueueRetryable(()=>e(Vi.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class aj{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class uEe{constructor(t){this.A=t,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(t,e){const n=o=>{null!=o.error&&Se("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const s=o.token!==this.R;return this.R=o.token,Se("FirebaseAppCheckTokenProvider",`Received ${s?"new":"existing"} token.`),s?e(o.token):Promise.resolve()};this.o=o=>{t.enqueueRetryable(()=>n(o))};const i=o=>{Se("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.appCheck.addTokenListener(this.o)};this.A.onInit(o=>i(o)),setTimeout(()=>{if(!this.appCheck){const o=this.A.getImmediate({optional:!0});o?i(o):Se("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then(e=>e?(pt("string"==typeof e.token),this.R=e.token,new aj(e.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function fEe(r){const t=typeof self<"u"&&(self.crypto||self.msCrypto),e=new Uint8Array(r);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(e);else for(let n=0;n<r;n++)e[n]=Math.floor(256*Math.random());return e}class cj{static newId(){const e=62*Math.floor(256/62);let n="";for(;n.length<20;){const i=fEe(40);for(let o=0;o<i.length;++o)n.length<20&&i[o]<e&&(n+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(i[o]%62))}return n}}function Kt(r,t){return r<t?-1:r>t?1:0}function c5(r,t,e){return r.length===t.length&&r.every((n,i)=>e(n,t[i]))}class vr{constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new Oe(ue.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new Oe(ue.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Oe(ue.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Oe(ue.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}static now(){return vr.fromMillis(Date.now())}static fromDate(t){return vr.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3),n=Math.floor(1e6*(t-1e3*e));return new vr(e,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(t){return this.seconds===t.seconds?Kt(this.nanoseconds,t.nanoseconds):Kt(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class vt{constructor(t){this.timestamp=t}static fromTimestamp(t){return new vt(t)}static min(){return new vt(new vr(0,0))}static max(){return new vt(new vr(253402300799,999999999))}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class n9{constructor(t,e,n){void 0===e?e=0:e>t.length&&lt(),void 0===n?n=t.length-e:n>t.length-e&&lt(),this.segments=t,this.offset=e,this.len=n}get length(){return this.len}isEqual(t){return 0===n9.comparator(this,t)}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof n9?t.forEach(n=>{e.push(n)}):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return this.construct(this.segments,this.offset+(t=void 0===t?1:t),this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return 0===this.length}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){const n=Math.min(t.length,e.length);for(let i=0;i<n;i++){const o=t.get(i),s=e.get(i);if(o<s)return-1;if(o>s)return 1}return t.length<e.length?-1:t.length>e.length?1:0}}class Rn extends n9{construct(t,e,n){return new Rn(t,e,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...t){const e=[];for(const n of t){if(n.indexOf("//")>=0)throw new Oe(ue.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);e.push(...n.split("/").filter(i=>i.length>0))}return new Rn(e)}static emptyPath(){return new Rn([])}}const dEe=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class dr extends n9{construct(t,e,n){return new dr(t,e,n)}static isValidIdentifier(t){return dEe.test(t)}canonicalString(){return this.toArray().map(t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),dr.isValidIdentifier(t)||(t="`"+t+"`"),t)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new dr(["__name__"])}static fromServerFormat(t){const e=[];let n="",i=0;const o=()=>{if(0===n.length)throw new Oe(ue.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(n),n=""};let s=!1;for(;i<t.length;){const a=t[i];if("\\"===a){if(i+1===t.length)throw new Oe(ue.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const c=t[i+1];if("\\"!==c&&"."!==c&&"`"!==c)throw new Oe(ue.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=c,i+=2}else"`"===a?(s=!s,i++):"."!==a||s?(n+=a,i++):(o(),i++)}if(o(),s)throw new Oe(ue.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new dr(e)}static emptyPath(){return new dr([])}}class Ze{constructor(t){this.path=t}static fromPath(t){return new Ze(Rn.fromString(t))}static fromName(t){return new Ze(Rn.fromString(t).popFirst(5))}static empty(){return new Ze(Rn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return null!==t&&0===Rn.comparator(this.path,t.path)}toString(){return this.path.toString()}static comparator(t,e){return Rn.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new Ze(new Rn(t.slice()))}}function fj(r){return new ds(r.readTime,r.key,-1)}class ds{constructor(t,e,n){this.readTime=t,this.documentKey=e,this.largestBatchId=n}static min(){return new ds(vt.min(),Ze.empty(),-1)}static max(){return new ds(vt.max(),Ze.empty(),-1)}}function ET(r,t){let e=r.readTime.compareTo(t.readTime);return 0!==e?e:(e=Ze.comparator(r.documentKey,t.documentKey),0!==e?e:Kt(r.largestBatchId,t.largestBatchId))}const dj="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class hj{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(t=>t())}}function Q4(r){return PT.apply(this,arguments)}function PT(){return PT=M(function*(r){if(r.code!==ue.FAILED_PRECONDITION||r.message!==dj)throw r;Se("LocalStore","Unexpectedly lost primary lease")}),PT.apply(this,arguments)}class oe{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)},e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)})}catch(t){return this.next(void 0,t)}next(t,e){return this.callbackAttached&&lt(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(e,this.error):this.wrapSuccess(t,this.result):new oe((n,i)=>{this.nextCallback=o=>{this.wrapSuccess(t,o).next(n,i)},this.catchCallback=o=>{this.wrapFailure(e,o).next(n,i)}})}toPromise(){return new Promise((t,e)=>{this.next(t,e)})}wrapUserFunction(t){try{const e=t();return e instanceof oe?e:oe.resolve(e)}catch(e){return oe.reject(e)}}wrapSuccess(t,e){return t?this.wrapUserFunction(()=>t(e)):oe.resolve(e)}wrapFailure(t,e){return t?this.wrapUserFunction(()=>t(e)):oe.reject(e)}static resolve(t){return new oe((e,n)=>{e(t)})}static reject(t){return new oe((e,n)=>{n(t)})}static waitFor(t){return new oe((e,n)=>{let i=0,o=0,s=!1;t.forEach(a=>{++i,a.next(()=>{++o,s&&o===i&&e()},c=>n(c))}),s=!0,o===i&&e()})}static or(t){let e=oe.resolve(!1);for(const n of t)e=e.next(i=>i?oe.resolve(i):n());return e}static forEach(t,e){const n=[];return t.forEach((i,o)=>{n.push(e.call(this,i,o))}),this.waitFor(n)}static mapArray(t,e){return new oe((n,i)=>{const o=t.length,s=new Array(o);let a=0;for(let c=0;c<o;c++){const l=c;e(t[l]).next(u=>{s[l]=u,++a,a===o&&n(s)},u=>i(u))}})}static doWhile(t,e){return new oe((n,i)=>{const o=()=>{!0===t()?e().next(()=>{o()},i):n()};o()})}}class $m{constructor(t,e){this.action=t,this.transaction=e,this.aborted=!1,this.V=new Ei,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{e.error?this.V.reject(new r9(t,e.error)):this.V.resolve()},this.transaction.onerror=n=>{const i=ST(n.target.error);this.V.reject(new r9(t,i))}}static open(t,e,n,i){try{return new $m(e,t.transaction(i,n))}catch(o){throw new r9(e,o)}}get m(){return this.V.promise}abort(t){t&&this.V.reject(t),this.aborted||(Se("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const t=this.transaction;this.aborted||"function"!=typeof t.commit||t.commit()}store(t){const e=this.transaction.objectStore(t);return new mEe(e)}}class Ws{constructor(t,e,n){this.name=t,this.version=e,this.p=n,12.2===Ws.S(Or())&&Br("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(t){return Se("SimpleDb","Removing database:",t),N6(window.indexedDB.deleteDatabase(t)).toPromise()}static D(){if(!OW())return!1;if(Ws.C())return!0;const t=Or(),e=Ws.S(t),n=0<e&&e<10,i=Ws.v(t),o=0<i&&i<4.5;return!(t.indexOf("MSIE ")>0||t.indexOf("Trident/")>0||t.indexOf("Edge/")>0||n||o)}static C(){var t;return typeof process<"u"&&"YES"===(null===(t=process.__PRIVATE_env)||void 0===t?void 0:t.F)}static M(t,e){return t.store(e)}static S(t){const e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)}static v(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}O(t){var e=this;return M(function*(){return e.db||(Se("SimpleDb","Opening database:",e.name),e.db=yield new Promise((n,i)=>{const o=indexedDB.open(e.name,e.version);o.onsuccess=s=>{n(s.target.result)},o.onblocked=()=>{i(new r9(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},o.onerror=s=>{const a=s.target.error;i("VersionError"===a.name?new Oe(ue.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):"InvalidStateError"===a.name?new Oe(ue.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+a):new r9(t,a))},o.onupgradeneeded=s=>{Se("SimpleDb",'Database "'+e.name+'" requires upgrade from version:',s.oldVersion),e.p.N(s.target.result,o.transaction,s.oldVersion,e.version).next(()=>{Se("SimpleDb","Database upgrade to version "+e.version+" complete")})}})),e.B&&(e.db.onversionchange=n=>e.B(n)),e.db})()}L(t){this.B=t,this.db&&(this.db.onversionchange=e=>t(e))}runTransaction(t,e,n,i){var o=this;return M(function*(){const s="readonly"===e;let a=0;for(;;){++a;try{o.db=yield o.O(t);const c=$m.open(o.db,t,s?"readonly":"readwrite",n),l=i(c).next(u=>(c.g(),u)).catch(u=>(c.abort(u),oe.reject(u))).toPromise();return l.catch(()=>{}),yield c.m,l}catch(c){const l=c,u="FirebaseError"!==l.name&&a<3;if(Se("SimpleDb","Transaction failed with error:",l.message,"Retrying:",u),o.close(),!u)return Promise.reject(l)}}})()}close(){this.db&&this.db.close(),this.db=void 0}}class pEe{constructor(t){this.k=t,this.q=!1,this.K=null}get isDone(){return this.q}get $(){return this.K}set cursor(t){this.k=t}done(){this.q=!0}U(t){this.K=t}delete(){return N6(this.k.delete())}}class r9 extends Oe{constructor(t,e){super(ue.UNAVAILABLE,`IndexedDB transaction '${t}' failed: ${e}`),this.name="IndexedDbTransactionError"}}function J4(r){return"IndexedDbTransactionError"===r.name}class mEe{constructor(t){this.store=t}put(t,e){let n;return void 0!==e?(Se("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(Se("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),N6(n)}add(t){return Se("SimpleDb","ADD",this.store.name,t,t),N6(this.store.add(t))}get(t){return N6(this.store.get(t)).next(e=>(void 0===e&&(e=null),Se("SimpleDb","GET",this.store.name,t,e),e))}delete(t){return Se("SimpleDb","DELETE",this.store.name,t),N6(this.store.delete(t))}count(){return Se("SimpleDb","COUNT",this.store.name),N6(this.store.count())}W(t,e){const n=this.options(t,e),i=n.index?this.store.index(n.index):this.store;if("function"==typeof i.getAll){const o=i.getAll(n.range);return new oe((s,a)=>{o.onerror=c=>{a(c.target.error)},o.onsuccess=c=>{s(c.target.result)}})}{const o=this.cursor(n),s=[];return this.G(o,(a,c)=>{s.push(c)}).next(()=>s)}}j(t,e){const n=this.store.getAll(t,null===e?void 0:e);return new oe((i,o)=>{n.onerror=s=>{o(s.target.error)},n.onsuccess=s=>{i(s.target.result)}})}H(t,e){Se("SimpleDb","DELETE ALL",this.store.name);const n=this.options(t,e);n.J=!1;const i=this.cursor(n);return this.G(i,(o,s,a)=>a.delete())}Y(t,e){let n;e?n=t:(n={},e=t);const i=this.cursor(n);return this.G(i,e)}Z(t){const e=this.cursor({});return new oe((n,i)=>{e.onerror=o=>{const s=ST(o.target.error);i(s)},e.onsuccess=o=>{const s=o.target.result;s?t(s.primaryKey,s.value).next(a=>{a?s.continue():n()}):n()}})}G(t,e){const n=[];return new oe((i,o)=>{t.onerror=s=>{o(s.target.error)},t.onsuccess=s=>{const a=s.target.result;if(!a)return void i();const c=new pEe(a),l=e(a.primaryKey,a.value,c);if(l instanceof oe){const u=l.catch(f=>(c.done(),oe.reject(f)));n.push(u)}c.isDone?i():null===c.$?a.continue():a.continue(c.$)}}).next(()=>oe.waitFor(n))}options(t,e){let n;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}}cursor(t){let e="next";if(t.reverse&&(e="prev"),t.index){const n=this.store.index(t.index);return t.J?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)}}function N6(r){return new oe((t,e)=>{r.onsuccess=n=>{t(n.target.result)},r.onerror=n=>{const i=ST(n.target.error);e(i)}})}let gj=!1;function ST(r){const t=Ws.S(Or());if(t>=12.2&&t<13){const e="An internal error was encountered in the Indexed Database server";if(r.message.indexOf(e)>=0){const n=new Oe("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${e}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return gj||(gj=!0,setTimeout(()=>{throw n},0)),n}}return r}let hs=(()=>{class r{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=i=>this.se(i),this.oe=i=>n.writeSequenceNumber(i))}se(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.oe&&this.oe(e),e}}return r._e=-1,r})();function i9(r){return null==r}function o9(r){return 0===r&&1/r==-1/0}function Ej(r){let t=0;for(const e in r)Object.prototype.hasOwnProperty.call(r,e)&&t++;return t}function el(r,t){for(const e in r)Object.prototype.hasOwnProperty.call(r,e)&&t(e,r[e])}function Pj(r){for(const t in r)if(Object.prototype.hasOwnProperty.call(r,t))return!1;return!0}class F1{constructor(t,e){this.comparator=t,this.root=e||a2.EMPTY}insert(t,e){return new F1(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,a2.BLACK,null,null))}remove(t){return new F1(this.comparator,this.root.remove(t,this.comparator).copy(null,null,a2.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){const n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null}indexOf(t){let e=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(t,n.key);if(0===i)return e+n.left.size;i<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal((e,n)=>(t(e,n),!1))}toString(){const t=[];return this.inorderTraversal((e,n)=>(t.push(`${e}:${n}`),!1)),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new qm(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new qm(this.root,t,this.comparator,!1)}getReverseIterator(){return new qm(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new qm(this.root,t,this.comparator,!0)}}class qm{constructor(t,e,n,i){this.isReverse=i,this.nodeStack=[];let o=1;for(;!t.isEmpty();)if(o=e?n(t.key,e):1,e&&i&&(o*=-1),o<0)t=this.isReverse?t.left:t.right;else{if(0===o){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class a2{constructor(t,e,n,i,o){this.key=t,this.value=e,this.color=n??a2.RED,this.left=i??a2.EMPTY,this.right=o??a2.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,n,i,o){return new a2(t??this.key,e??this.value,n??this.color,i??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,n){let i=this;const o=n(t,i.key);return i=o<0?i.copy(null,null,null,i.left.insert(t,e,n),null):0===o?i.copy(null,e,null,null,null):i.copy(null,null,null,null,i.right.insert(t,e,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return a2.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let n,i=this;if(e(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,e),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===e(t,i.key)){if(i.right.isEmpty())return a2.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,e))}return i.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,a2.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,a2.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw lt();const t=this.left.check();if(t!==this.right.check())throw lt();return t+(this.isRed()?0:1)}}a2.EMPTY=null,a2.RED=!0,a2.BLACK=!1,a2.EMPTY=new class{constructor(){this.size=0}get key(){throw lt()}get value(){throw lt()}get color(){throw lt()}get left(){throw lt()}get right(){throw lt()}copy(t,e,n,i,o){return this}insert(t,e,n){return new a2(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class E1{constructor(t){this.comparator=t,this.data=new F1(this.comparator)}has(t){return null!==this.data.get(t)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal((e,n)=>(t(e),!1))}forEachInRange(t,e){const n=this.data.getIteratorFrom(t[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,t[1])>=0)return;e(i.key)}}forEachWhile(t,e){let n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return}firstAfterOrEqual(t){const e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new Sj(this.data.getIterator())}getIteratorFrom(t){return new Sj(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach(n=>{e=e.add(n)}),e}isEqual(t){if(!(t instanceof E1)||this.size!==t.size)return!1;const e=this.data.getIterator(),n=t.data.getIterator();for(;e.hasNext();){const i=e.getNext().key,o=n.getNext().key;if(0!==this.comparator(i,o))return!1}return!0}toArray(){const t=[];return this.forEach(e=>{t.push(e)}),t}toString(){const t=[];return this.forEach(e=>t.push(e)),"SortedSet("+t.toString()+")"}copy(t){const e=new E1(this.comparator);return e.data=t,e}}class Sj{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Ro{constructor(t){this.fields=t,t.sort(dr.comparator)}static empty(){return new Ro([])}unionWith(t){let e=new E1(dr.comparator);for(const n of this.fields)e=e.add(n);for(const n of t)e=e.add(n);return new Ro(e.toArray())}covers(t){for(const e of this.fields)if(e.isPrefixOf(t))return!0;return!1}isEqual(t){return c5(this.fields,t.fields,(e,n)=>e.isEqual(n))}}class Oj extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Pi{constructor(t){this.binaryString=t}static fromBase64String(t){const e=function(i){try{return atob(i)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new Oj("Invalid base64 string: "+o):o}}(t);return new Pi(e)}static fromUint8Array(t){const e=function(i){let o="";for(let s=0;s<i.length;++s)o+=String.fromCharCode(i[s]);return o}(t);return new Pi(e)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){return function(e){const n=new Uint8Array(e.length);for(let i=0;i<e.length;i++)n[i]=e.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return Kt(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}Pi.EMPTY_BYTE_STRING=new Pi("");const DEe=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function tl(r){if(pt(!!r),"string"==typeof r){let t=0;const e=DEe.exec(r);if(pt(!!e),e[1]){let i=e[1];i=(i+"000000000").substr(0,9),t=Number(i)}const n=new Date(r);return{seconds:Math.floor(n.getTime()/1e3),nanos:t}}return{seconds:wr(r.seconds),nanos:wr(r.nanos)}}function wr(r){return"number"==typeof r?r:"string"==typeof r?Number(r):0}function z3(r){return"string"==typeof r?Pi.fromBase64String(r):Pi.fromUint8Array(r)}function jm(r){var t,e;return"server_timestamp"===(null===(e=((null===(t=r?.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===e?void 0:e.stringValue)}function Zm(r){const t=r.mapValue.fields.__previous_value__;return jm(t)?Zm(t):t}function s9(r){const t=tl(r.mapValue.fields.__local_write_time__.timestampValue);return new vr(t.seconds,t.nanos)}class VEe{constructor(t,e,n,i,o,s,a,c,l){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=i,this.ssl=o,this.forceLongPolling=s,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=l}}class I6{constructor(t,e){this.projectId=t,this.database=e||"(default)"}static empty(){return new I6("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(t){return t instanceof I6&&t.projectId===this.projectId&&t.database===this.database}}const nl={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function rl(r){return"nullValue"in r?0:"booleanValue"in r?1:"integerValue"in r||"doubleValue"in r?2:"timestampValue"in r?3:"stringValue"in r?5:"bytesValue"in r?6:"referenceValue"in r?7:"geoPointValue"in r?8:"arrayValue"in r?9:"mapValue"in r?jm(r)?4:Aj(r)?9007199254740991:10:lt()}function Rc(r,t){if(r===t)return!0;const e=rl(r);if(e!==rl(t))return!1;switch(e){case 0:case 9007199254740991:return!0;case 1:return r.booleanValue===t.booleanValue;case 4:return s9(r).isEqual(s9(t));case 3:return function(i,o){if("string"==typeof i.timestampValue&&"string"==typeof o.timestampValue&&i.timestampValue.length===o.timestampValue.length)return i.timestampValue===o.timestampValue;const s=tl(i.timestampValue),a=tl(o.timestampValue);return s.seconds===a.seconds&&s.nanos===a.nanos}(r,t);case 5:return r.stringValue===t.stringValue;case 6:return o=t,z3(r.bytesValue).isEqual(z3(o.bytesValue));case 7:return r.referenceValue===t.referenceValue;case 8:return function(i,o){return wr(i.geoPointValue.latitude)===wr(o.geoPointValue.latitude)&&wr(i.geoPointValue.longitude)===wr(o.geoPointValue.longitude)}(r,t);case 2:return function(i,o){if("integerValue"in i&&"integerValue"in o)return wr(i.integerValue)===wr(o.integerValue);if("doubleValue"in i&&"doubleValue"in o){const s=wr(i.doubleValue),a=wr(o.doubleValue);return s===a?o9(s)===o9(a):isNaN(s)&&isNaN(a)}return!1}(r,t);case 9:return c5(r.arrayValue.values||[],t.arrayValue.values||[],Rc);case 10:return function(i,o){const s=i.mapValue.fields||{},a=o.mapValue.fields||{};if(Ej(s)!==Ej(a))return!1;for(const c in s)if(s.hasOwnProperty(c)&&(void 0===a[c]||!Rc(s[c],a[c])))return!1;return!0}(r,t);default:return lt()}var o}function a9(r,t){return void 0!==(r.values||[]).find(e=>Rc(e,t))}function il(r,t){if(r===t)return 0;const e=rl(r),n=rl(t);if(e!==n)return Kt(e,n);switch(e){case 0:case 9007199254740991:return 0;case 1:return Kt(r.booleanValue,t.booleanValue);case 2:return function(o,s){const a=wr(o.integerValue||o.doubleValue),c=wr(s.integerValue||s.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1}(r,t);case 3:return Tj(r.timestampValue,t.timestampValue);case 4:return Tj(s9(r),s9(t));case 5:return Kt(r.stringValue,t.stringValue);case 6:return function(o,s){const a=z3(o),c=z3(s);return a.compareTo(c)}(r.bytesValue,t.bytesValue);case 7:return function(o,s){const a=o.split("/"),c=s.split("/");for(let l=0;l<a.length&&l<c.length;l++){const u=Kt(a[l],c[l]);if(0!==u)return u}return Kt(a.length,c.length)}(r.referenceValue,t.referenceValue);case 8:return function(o,s){const a=Kt(wr(o.latitude),wr(s.latitude));return 0!==a?a:Kt(wr(o.longitude),wr(s.longitude))}(r.geoPointValue,t.geoPointValue);case 9:return function(o,s){const a=o.values||[],c=s.values||[];for(let l=0;l<a.length&&l<c.length;++l){const u=il(a[l],c[l]);if(u)return u}return Kt(a.length,c.length)}(r.arrayValue,t.arrayValue);case 10:return function(o,s){if(o===nl.mapValue&&s===nl.mapValue)return 0;if(o===nl.mapValue)return 1;if(s===nl.mapValue)return-1;const a=o.fields||{},c=Object.keys(a),l=s.fields||{},u=Object.keys(l);c.sort(),u.sort();for(let f=0;f<c.length&&f<u.length;++f){const g=Kt(c[f],u[f]);if(0!==g)return g;const y=il(a[c[f]],l[u[f]]);if(0!==y)return y}return Kt(c.length,u.length)}(r.mapValue,t.mapValue);default:throw lt()}}function Tj(r,t){if("string"==typeof r&&"string"==typeof t&&r.length===t.length)return Kt(r,t);const e=tl(r),n=tl(t),i=Kt(e.seconds,n.seconds);return 0!==i?i:Kt(e.nanos,n.nanos)}function d5(r){return TT(r)}function TT(r){return"nullValue"in r?"null":"booleanValue"in r?""+r.booleanValue:"integerValue"in r?""+r.integerValue:"doubleValue"in r?""+r.doubleValue:"timestampValue"in r?function(e){const n=tl(e);return`time(${n.seconds},${n.nanos})`}(r.timestampValue):"stringValue"in r?r.stringValue:"bytesValue"in r?z3(r.bytesValue).toBase64():"referenceValue"in r?Ze.fromName(r.referenceValue).toString():"geoPointValue"in r?function(e){return`geo(${e.latitude},${e.longitude})`}(r.geoPointValue):"arrayValue"in r?function(e){let n="[",i=!0;for(const o of e.values||[])i?i=!1:n+=",",n+=TT(o);return n+"]"}(r.arrayValue):"mapValue"in r?function(e){const n=Object.keys(e.fields||{}).sort();let i="{",o=!0;for(const s of n)o?o=!1:i+=",",i+=`${s}:${TT(e.fields[s])}`;return i+"}"}(r.mapValue):lt()}function k6(r,t){return{referenceValue:`projects/${r.projectId}/databases/${r.database}/documents/${t.path.canonicalString()}`}}function wT(r){return!!r&&"integerValue"in r}function c9(r){return!!r&&"arrayValue"in r}function wj(r){return!!r&&"nullValue"in r}function bj(r){return!!r&&"doubleValue"in r&&isNaN(Number(r.doubleValue))}function Xm(r){return!!r&&"mapValue"in r}function l9(r){if(r.geoPointValue)return{geoPointValue:Object.assign({},r.geoPointValue)};if(r.timestampValue&&"object"==typeof r.timestampValue)return{timestampValue:Object.assign({},r.timestampValue)};if(r.mapValue){const t={mapValue:{fields:{}}};return el(r.mapValue.fields,(e,n)=>t.mapValue.fields[e]=l9(n)),t}if(r.arrayValue){const t={arrayValue:{values:[]}};for(let e=0;e<(r.arrayValue.values||[]).length;++e)t.arrayValue.values[e]=l9(r.arrayValue.values[e]);return t}return Object.assign({},r)}function Aj(r){return"__max__"===(((r.mapValue||{}).fields||{}).__type__||{}).stringValue}class c2{constructor(t){this.value=t}static empty(){return new c2({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let e=this.value;for(let n=0;n<t.length-1;++n)if(e=(e.mapValue.fields||{})[t.get(n)],!Xm(e))return null;return e=(e.mapValue.fields||{})[t.lastSegment()],e||null}}set(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=l9(e)}setAll(t){let e=dr.emptyPath(),n={},i=[];t.forEach((s,a)=>{if(!e.isImmediateParentOf(a)){const c=this.getFieldsMap(e);this.applyChanges(c,n,i),n={},i=[],e=a.popLast()}s?n[a.lastSegment()]=l9(s):i.push(a.lastSegment())});const o=this.getFieldsMap(e);this.applyChanges(o,n,i)}delete(t){const e=this.field(t.popLast());Xm(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}isEqual(t){return Rc(this.value,t.value)}getFieldsMap(t){let e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(let n=0;n<t.length;++n){let i=e.mapValue.fields[t.get(n)];Xm(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},e.mapValue.fields[t.get(n)]=i),e=i}return e.mapValue.fields}applyChanges(t,e,n){el(e,(i,o)=>t[i]=o);for(const i of n)delete t[i]}clone(){return new c2(l9(this.value))}}function kj(r){const t=[];return el(r.fields,(e,n)=>{const i=new dr([e]);if(Xm(n)){const o=kj(n.mapValue).fields;if(0===o.length)t.push(i);else for(const s of o)t.push(i.child(s))}else t.push(i)}),new Ro(t)}class K1{constructor(t,e,n,i,o,s,a){this.key=t,this.documentType=e,this.version=n,this.readTime=i,this.createTime=o,this.data=s,this.documentState=a}static newInvalidDocument(t){return new K1(t,0,vt.min(),vt.min(),vt.min(),c2.empty(),0)}static newFoundDocument(t,e,n,i){return new K1(t,1,e,vt.min(),n,i,0)}static newNoDocument(t,e){return new K1(t,2,e,vt.min(),vt.min(),c2.empty(),0)}static newUnknownDocument(t,e){return new K1(t,3,e,vt.min(),vt.min(),c2.empty(),2)}convertToFoundDocument(t,e){return!this.createTime.isEqual(vt.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=t),this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=c2.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=c2.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=vt.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(t){return t instanceof K1&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new K1(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class ol{constructor(t,e){this.position=t,this.inclusive=e}}function Rj(r,t,e){let n=0;for(let i=0;i<r.position.length;i++){const o=t[i],s=r.position[i];if(n=o.field.isKeyField()?Ze.comparator(Ze.fromName(s.referenceValue),e.key):il(s,e.data.field(o.field)),"desc"===o.dir&&(n*=-1),0!==n)break}return n}function xj(r,t){if(null===r)return null===t;if(null===t||r.inclusive!==t.inclusive||r.position.length!==t.position.length)return!1;for(let e=0;e<r.position.length;e++)if(!Rc(r.position[e],t.position[e]))return!1;return!0}class u9{constructor(t,e="asc"){this.field=t,this.dir=e}}function UEe(r,t){return r.dir===t.dir&&r.field.isEqual(t.field)}class Lj{}class xn extends Lj{constructor(t,e,n){super(),this.field=t,this.op=e,this.value=n}static create(t,e,n){return t.isKeyField()?"in"===e||"not-in"===e?this.createKeyFieldInFilter(t,e,n):new GEe(t,e,n):"array-contains"===e?new WEe(t,n):"in"===e?new Uj(t,n):"not-in"===e?new qEe(t,n):"array-contains-any"===e?new jEe(t,n):new xn(t,e,n)}static createKeyFieldInFilter(t,e,n){return"in"===e?new BEe(t,n):new $Ee(t,n)}matches(t){const e=t.data.field(this.field);return"!="===this.op?null!==e&&this.matchesComparison(il(e,this.value)):null!==e&&rl(this.value)===rl(e)&&this.matchesComparison(il(e,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return lt()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class g1 extends Lj{constructor(t,e){super(),this.filters=t,this.op=e,this.ue=null}static create(t,e){return new g1(t,e)}matches(t){return h5(this)?void 0===this.filters.find(e=>!e.matches(t)):void 0!==this.filters.find(e=>e.matches(t))}getFlattenedFilters(){return null!==this.ue||(this.ue=this.filters.reduce((t,e)=>t.concat(e.getFlattenedFilters()),[])),this.ue}getFilters(){return Object.assign([],this.filters)}}function h5(r){return"and"===r.op}function AT(r){return function zj(r){for(const t of r.filters)if(t instanceof g1)return!1;return!0}(r)&&h5(r)}function NT(r){if(r instanceof xn)return r.field.canonicalString()+r.op.toString()+d5(r.value);if(AT(r))return r.filters.map(t=>NT(t)).join(",");{const t=r.filters.map(e=>NT(e)).join(",");return`${r.op}(${t})`}}function Dj(r,t){return r instanceof xn?(n=r,(i=t)instanceof xn&&n.op===i.op&&n.field.isEqual(i.field)&&Rc(n.value,i.value)):r instanceof g1?function(n,i){return i instanceof g1&&n.op===i.op&&n.filters.length===i.filters.length&&n.filters.reduce((o,s,a)=>o&&Dj(s,i.filters[a]),!0)}(r,t):void lt();var n,i}function Hj(r){return r instanceof xn?`${(e=r).field.canonicalString()} ${e.op} ${d5(e.value)}`:r instanceof g1?function(e){return e.op.toString()+" {"+e.getFilters().map(Hj).join(" ,")+"}"}(r):"Filter";var e}class GEe extends xn{constructor(t,e,n){super(t,e,n),this.key=Ze.fromName(n.referenceValue)}matches(t){const e=Ze.comparator(t.key,this.key);return this.matchesComparison(e)}}class BEe extends xn{constructor(t,e){super(t,"in",e),this.keys=Fj(0,e)}matches(t){return this.keys.some(e=>e.isEqual(t.key))}}class $Ee extends xn{constructor(t,e){super(t,"not-in",e),this.keys=Fj(0,e)}matches(t){return!this.keys.some(e=>e.isEqual(t.key))}}function Fj(r,t){var e;return((null===(e=t.arrayValue)||void 0===e?void 0:e.values)||[]).map(n=>Ze.fromName(n.referenceValue))}class WEe extends xn{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.data.field(this.field);return c9(e)&&a9(e.arrayValue,this.value)}}class Uj extends xn{constructor(t,e){super(t,"in",e)}matches(t){const e=t.data.field(this.field);return null!==e&&a9(this.value.arrayValue,e)}}class qEe extends xn{constructor(t,e){super(t,"not-in",e)}matches(t){if(a9(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.data.field(this.field);return null!==e&&!a9(this.value.arrayValue,e)}}class jEe extends xn{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.data.field(this.field);return!(!c9(e)||!e.arrayValue.values)&&e.arrayValue.values.some(n=>a9(this.value.arrayValue,n))}}class ZEe{constructor(t,e=null,n=[],i=[],o=null,s=null,a=null){this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=i,this.limit=o,this.startAt=s,this.endAt=a,this.ce=null}}function IT(r,t=null,e=[],n=[],i=null,o=null,s=null){return new ZEe(r,t,e,n,i,o,s)}function R6(r){const t=qe(r);if(null===t.ce){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map(n=>NT(n)).join(","),e+="|ob:",e+=t.orderBy.map(n=>{return(o=n).field.canonicalString()+o.dir;var o}).join(","),i9(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(n=>d5(n)).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(n=>d5(n)).join(",")),t.ce=e}return t.ce}function f9(r,t){if(r.limit!==t.limit||r.orderBy.length!==t.orderBy.length)return!1;for(let e=0;e<r.orderBy.length;e++)if(!UEe(r.orderBy[e],t.orderBy[e]))return!1;if(r.filters.length!==t.filters.length)return!1;for(let e=0;e<r.filters.length;e++)if(!Dj(r.filters[e],t.filters[e]))return!1;return r.collectionGroup===t.collectionGroup&&!!r.path.isEqual(t.path)&&!!xj(r.startAt,t.startAt)&&xj(r.endAt,t.endAt)}function Qm(r){return Ze.isDocumentKey(r.path)&&null===r.collectionGroup&&0===r.filters.length}class D3{constructor(t,e=null,n=[],i=[],o=null,s="F",a=null,c=null){this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=i,this.limit=o,this.limitType=s,this.startAt=a,this.endAt=c,this.le=null,this.he=null,this.Pe=null}}function g5(r){return new D3(r)}function Wj(r){return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.explicitOrderBy.length||1===r.explicitOrderBy.length&&r.explicitOrderBy[0].field.isKeyField())}function kT(r){return null!==r.collectionGroup}function p5(r){const t=qe(r);if(null===t.le){t.le=[];const e=new Set;for(const o of t.explicitOrderBy)t.le.push(o),e.add(o.field.canonicalString());const n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";(function(s){let a=new E1(dr.comparator);return s.filters.forEach(c=>{c.getFlattenedFilters().forEach(l=>{l.isInequality()&&(a=a.add(l.field))})}),a})(t).forEach(o=>{e.has(o.canonicalString())||o.isKeyField()||t.le.push(new u9(o,n))}),e.has(dr.keyField().canonicalString())||t.le.push(new u9(dr.keyField(),n))}return t.le}function lo(r){const t=qe(r);return t.he||(t.he=function qj(r,t){if("F"===r.limitType)return IT(r.path,r.collectionGroup,t,r.filters,r.limit,r.startAt,r.endAt);{t=t.map(i=>new u9(i.field,"desc"===i.dir?"asc":"desc"));const e=r.endAt?new ol(r.endAt.position,r.endAt.inclusive):null,n=r.startAt?new ol(r.startAt.position,r.startAt.inclusive):null;return IT(r.path,r.collectionGroup,t,r.filters,r.limit,e,n)}}(t,p5(r))),t.he}function RT(r,t){const e=r.filters.concat([t]);return new D3(r.path,r.collectionGroup,r.explicitOrderBy.slice(),e,r.limit,r.limitType,r.startAt,r.endAt)}function e_(r,t,e){return new D3(r.path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),t,e,r.startAt,r.endAt)}function d9(r,t){return f9(lo(r),lo(t))&&r.limitType===t.limitType}function jj(r){return`${R6(lo(r))}|lt:${r.limitType}`}function m5(r){return`Query(target=${function(e){let n=e.path.canonicalString();return null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(n+=`, filters: [${e.filters.map(i=>Hj(i)).join(", ")}]`),i9(e.limit)||(n+=", limit: "+e.limit),e.orderBy.length>0&&(n+=`, orderBy: [${e.orderBy.map(i=>{return`${(s=i).field.canonicalString()} (${s.dir})`;var s}).join(", ")}]`),e.startAt&&(n+=", startAt: ",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(i=>d5(i)).join(",")),e.endAt&&(n+=", endAt: ",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(i=>d5(i)).join(",")),`Target(${n})`}(lo(r))}; limitType=${r.limitType})`}function h9(r,t){return t.isFoundDocument()&&function(n,i){const o=i.key.path;return null!==n.collectionGroup?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(o):Ze.isDocumentKey(n.path)?n.path.isEqual(o):n.path.isImmediateParentOf(o)}(r,t)&&function(n,i){for(const o of p5(n))if(!o.field.isKeyField()&&null===i.data.field(o.field))return!1;return!0}(r,t)&&function(n,i){for(const o of n.filters)if(!o.matches(i))return!1;return!0}(r,t)&&(i=t,!((n=r).startAt&&!function(s,a,c){const l=Rj(s,a,c);return s.inclusive?l<=0:l<0}(n.startAt,p5(n),i)||n.endAt&&!function(s,a,c){const l=Rj(s,a,c);return s.inclusive?l>=0:l>0}(n.endAt,p5(n),i)));var n,i}function Yj(r){return(t,e)=>{let n=!1;for(const i of p5(r)){const o=YEe(i,t,e);if(0!==o)return o;n=n||i.field.isKeyField()}return 0}}function YEe(r,t,e){const n=r.field.isKeyField()?Ze.comparator(t.key,e.key):function(o,s,a){const c=s.data.field(o),l=a.data.field(o);return null!==c&&null!==l?il(c,l):lt()}(r.field,t,e);switch(r.dir){case"asc":return n;case"desc":return-1*n;default:return lt()}}class V3{constructor(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={},this.innerSize=0}get(t){const e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(const[i,o]of n)if(this.equalsFn(i,t))return o}has(t){return void 0!==this.get(t)}set(t,e){const n=this.mapKeyFn(t),i=this.inner[n];if(void 0===i)return this.inner[n]=[[t,e]],void this.innerSize++;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],t))return void(i[o]=[t,e]);i.push([t,e]),this.innerSize++}delete(t){const e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],t))return 1===n.length?delete this.inner[e]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(t){el(this.inner,(e,n)=>{for(const[i,o]of n)t(i,o)})}isEmpty(){return Pj(this.inner)}size(){return this.innerSize}}const KEe=new F1(Ze.comparator);function xo(){return KEe}const Kj=new F1(Ze.comparator);function g9(...r){let t=Kj;for(const e of r)t=t.insert(e.key,e);return t}function Xj(r){let t=Kj;return r.forEach((e,n)=>t=t.insert(e,n.overlayedDocument)),t}function xc(){return p9()}function Qj(){return p9()}function p9(){return new V3(r=>r.toString(),(r,t)=>r.isEqual(t))}const XEe=new F1(Ze.comparator),QEe=new E1(Ze.comparator);function ln(...r){let t=QEe;for(const e of r)t=t.add(e);return t}const JEe=new E1(Kt);function Jj(r,t){if(r.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:o9(t)?"-0":t}}function eZ(r){return{integerValue:""+r}}function tZ(r,t){return function pj(r){return"number"==typeof r&&Number.isInteger(r)&&!o9(r)&&r<=Number.MAX_SAFE_INTEGER&&r>=Number.MIN_SAFE_INTEGER}(t)?eZ(t):Jj(r,t)}class t_{constructor(){this._=void 0}}function ePe(r,t,e){return r instanceof _5?function(i,o){const s={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return o&&jm(o)&&(o=Zm(o)),o&&(s.fields.__previous_value__=o),{mapValue:s}}(e,t):r instanceof x6?rZ(r,t):r instanceof L6?iZ(r,t):function(i,o){const s=nZ(i,o),a=oZ(s)+oZ(i.Ie);return wT(s)&&wT(i.Ie)?eZ(a):Jj(i.serializer,a)}(r,t)}function tPe(r,t,e){return r instanceof x6?rZ(r,t):r instanceof L6?iZ(r,t):e}function nZ(r,t){return r instanceof C5?wT(n=t)||(o=n)&&"doubleValue"in o?t:{integerValue:0}:null;var n,o}class _5 extends t_{}class x6 extends t_{constructor(t){super(),this.elements=t}}function rZ(r,t){const e=sZ(t);for(const n of r.elements)e.some(i=>Rc(i,n))||e.push(n);return{arrayValue:{values:e}}}class L6 extends t_{constructor(t){super(),this.elements=t}}function iZ(r,t){let e=sZ(t);for(const n of r.elements)e=e.filter(i=>!Rc(i,n));return{arrayValue:{values:e}}}class C5 extends t_{constructor(t,e){super(),this.serializer=t,this.Ie=e}}function oZ(r){return wr(r.integerValue||r.doubleValue)}function sZ(r){return c9(r)&&r.arrayValue.values?r.arrayValue.values.slice():[]}class m9{constructor(t,e){this.field=t,this.transform=e}}class rPe{constructor(t,e){this.version=t,this.transformResults=e}}class hr{constructor(t,e){this.updateTime=t,this.exists=e}static none(){return new hr}static exists(t){return new hr(void 0,t)}static updateTime(t){return new hr(t)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function n_(r,t){return void 0!==r.updateTime?t.isFoundDocument()&&t.version.isEqual(r.updateTime):void 0===r.exists||r.exists===t.isFoundDocument()}class r_{}function aZ(r,t){if(!r.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return r.isNoDocument()?new y5(r.key,hr.none()):new v5(r.key,r.data,hr.none());{const e=r.data,n=c2.empty();let i=new E1(dr.comparator);for(let o of t.fields)if(!i.has(o)){let s=e.field(o);null===s&&o.length>1&&(o=o.popLast(),s=e.field(o)),null===s?n.delete(o):n.set(o,s),i=i.add(o)}return new H3(r.key,n,new Ro(i.toArray()),hr.none())}}function iPe(r,t,e){r instanceof v5?function(i,o,s){const a=i.value.clone(),c=uZ(i.fieldTransforms,o,s.transformResults);a.setAll(c),o.convertToFoundDocument(s.version,a).setHasCommittedMutations()}(r,t,e):r instanceof H3?function(i,o,s){if(!n_(i.precondition,o))return void o.convertToUnknownDocument(s.version);const a=uZ(i.fieldTransforms,o,s.transformResults),c=o.data;c.setAll(lZ(i)),c.setAll(a),o.convertToFoundDocument(s.version,c).setHasCommittedMutations()}(r,t,e):t.convertToNoDocument(e.version).setHasCommittedMutations()}function _9(r,t,e,n){return r instanceof v5?function(o,s,a,c){if(!n_(o.precondition,s))return a;const l=o.value.clone(),u=fZ(o.fieldTransforms,c,s);return l.setAll(u),s.convertToFoundDocument(s.version,l).setHasLocalMutations(),null}(r,t,e,n):r instanceof H3?function(o,s,a,c){if(!n_(o.precondition,s))return a;const l=fZ(o.fieldTransforms,c,s),u=s.data;return u.setAll(lZ(o)),u.setAll(l),s.convertToFoundDocument(s.version,u).setHasLocalMutations(),null===a?null:a.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(f=>f.field))}(r,t,e,n):(a=e,n_(r.precondition,s=t)?(s.convertToNoDocument(s.version).setHasLocalMutations(),null):a);var s,a}function oPe(r,t){let e=null;for(const n of r.fieldTransforms){const i=t.data.field(n.field),o=nZ(n.transform,i||null);null!=o&&(null===e&&(e=c2.empty()),e.set(n.field,o))}return e||null}function cZ(r,t){return r.type===t.type&&!!r.key.isEqual(t.key)&&!!r.precondition.isEqual(t.precondition)&&(i=t.fieldTransforms,!!(void 0===(n=r.fieldTransforms)&&void 0===i||n&&i&&c5(n,i,(o,s)=>function nPe(r,t){return r.field.isEqual(t.field)&&(i=t.transform,(n=r.transform)instanceof x6&&i instanceof x6||n instanceof L6&&i instanceof L6?c5(n.elements,i.elements,Rc):n instanceof C5&&i instanceof C5?Rc(n.Ie,i.Ie):n instanceof _5&&i instanceof _5);var n,i}(o,s))))&&(0===r.type?r.value.isEqual(t.value):1!==r.type||r.data.isEqual(t.data)&&r.fieldMask.isEqual(t.fieldMask));var n,i}class v5 extends r_{constructor(t,e,n,i=[]){super(),this.key=t,this.value=e,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class H3 extends r_{constructor(t,e,n,i,o=[]){super(),this.key=t,this.data=e,this.fieldMask=n,this.precondition=i,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function lZ(r){const t=new Map;return r.fieldMask.fields.forEach(e=>{if(!e.isEmpty()){const n=r.data.field(e);t.set(e,n)}}),t}function uZ(r,t,e){const n=new Map;pt(r.length===e.length);for(let i=0;i<e.length;i++){const o=r[i],s=o.transform,a=t.data.field(o.field);n.set(o.field,tPe(s,a,e[i]))}return n}function fZ(r,t,e){const n=new Map;for(const i of r){const o=i.transform,s=e.data.field(i.field);n.set(i.field,ePe(o,s,t))}return n}class y5 extends r_{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class LT extends r_{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class zT{constructor(t,e,n,i){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(t,e){const n=e.mutationResults;for(let i=0;i<this.mutations.length;i++){const o=this.mutations[i];o.key.isEqual(t.key)&&iPe(o,t,n[i])}}applyToLocalView(t,e){for(const n of this.baseMutations)n.key.isEqual(t.key)&&(e=_9(n,t,e,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(t.key)&&(e=_9(n,t,e,this.localWriteTime));return e}applyToLocalDocumentSet(t,e){const n=Qj();return this.mutations.forEach(i=>{const o=t.get(i.key),s=o.overlayedDocument;let a=this.applyToLocalView(s,o.mutatedFields);a=e.has(i.key)?null:a;const c=aZ(s,a);null!==c&&n.set(i.key,c),s.isValidDocument()||s.convertToNoDocument(vt.min())}),n}keys(){return this.mutations.reduce((t,e)=>t.add(e.key),ln())}isEqual(t){return this.batchId===t.batchId&&c5(this.mutations,t.mutations,(e,n)=>cZ(e,n))&&c5(this.baseMutations,t.baseMutations,(e,n)=>cZ(e,n))}}class DT{constructor(t,e,n,i){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.docVersions=i}static from(t,e,n){pt(t.mutations.length===n.length);let i=function(){return XEe}();const o=t.mutations;for(let s=0;s<o.length;s++)i=i.insert(o[s].key,n[s].version);return new DT(t,e,n,i)}}class VT{constructor(t,e){this.largestBatchId=t,this.mutation=e}getKey(){return this.mutation.key}isEqual(t){return null!==t&&this.mutation===t.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class aPe{constructor(t,e){this.count=t,this.unchangedNames=e}}var si,$n;function hZ(r){if(void 0===r)return Br("GRPC error has no .code"),ue.UNKNOWN;switch(r){case si.OK:return ue.OK;case si.CANCELLED:return ue.CANCELLED;case si.UNKNOWN:return ue.UNKNOWN;case si.DEADLINE_EXCEEDED:return ue.DEADLINE_EXCEEDED;case si.RESOURCE_EXHAUSTED:return ue.RESOURCE_EXHAUSTED;case si.INTERNAL:return ue.INTERNAL;case si.UNAVAILABLE:return ue.UNAVAILABLE;case si.UNAUTHENTICATED:return ue.UNAUTHENTICATED;case si.INVALID_ARGUMENT:return ue.INVALID_ARGUMENT;case si.NOT_FOUND:return ue.NOT_FOUND;case si.ALREADY_EXISTS:return ue.ALREADY_EXISTS;case si.PERMISSION_DENIED:return ue.PERMISSION_DENIED;case si.FAILED_PRECONDITION:return ue.FAILED_PRECONDITION;case si.ABORTED:return ue.ABORTED;case si.OUT_OF_RANGE:return ue.OUT_OF_RANGE;case si.UNIMPLEMENTED:return ue.UNIMPLEMENTED;case si.DATA_LOSS:return ue.DATA_LOSS;default:return lt()}}($n=si||(si={}))[$n.OK=0]="OK",$n[$n.CANCELLED=1]="CANCELLED",$n[$n.UNKNOWN=2]="UNKNOWN",$n[$n.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",$n[$n.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",$n[$n.NOT_FOUND=5]="NOT_FOUND",$n[$n.ALREADY_EXISTS=6]="ALREADY_EXISTS",$n[$n.PERMISSION_DENIED=7]="PERMISSION_DENIED",$n[$n.UNAUTHENTICATED=16]="UNAUTHENTICATED",$n[$n.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",$n[$n.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",$n[$n.ABORTED=10]="ABORTED",$n[$n.OUT_OF_RANGE=11]="OUT_OF_RANGE",$n[$n.UNIMPLEMENTED=12]="UNIMPLEMENTED",$n[$n.INTERNAL=13]="INTERNAL",$n[$n.UNAVAILABLE=14]="UNAVAILABLE",$n[$n.DATA_LOSS=15]="DATA_LOSS";const cPe=new o5([4294967295,4294967295],0);function pZ(r){const t=function gZ(){return new TextEncoder}().encode(r),e=new iEe;return e.update(t),new Uint8Array(e.digest())}function mZ(r){const t=new DataView(r.buffer),e=t.getUint32(0,!0),n=t.getUint32(4,!0),i=t.getUint32(8,!0),o=t.getUint32(12,!0);return[new o5([e,n],0),new o5([i,o],0)]}class HT{constructor(t,e,n){if(this.bitmap=t,this.padding=e,this.hashCount=n,e<0||e>=8)throw new C9(`Invalid padding: ${e}`);if(n<0)throw new C9(`Invalid hash count: ${n}`);if(t.length>0&&0===this.hashCount)throw new C9(`Invalid hash count: ${n}`);if(0===t.length&&0!==e)throw new C9(`Invalid padding when bitmap length is 0: ${e}`);this.Te=8*t.length-e,this.Ee=o5.fromNumber(this.Te)}de(t,e,n){let i=t.add(e.multiply(o5.fromNumber(n)));return 1===i.compare(cPe)&&(i=new o5([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Ee).toNumber()}Ae(t){return 0!=(this.bitmap[Math.floor(t/8)]&1<<t%8)}mightContain(t){if(0===this.Te)return!1;const e=pZ(t),[n,i]=mZ(e);for(let o=0;o<this.hashCount;o++){const s=this.de(n,i,o);if(!this.Ae(s))return!1}return!0}static create(t,e,n){const i=t%8==0?0:8-t%8,o=new Uint8Array(Math.ceil(t/8)),s=new HT(o,i,e);return n.forEach(a=>s.insert(a)),s}insert(t){if(0===this.Te)return;const e=pZ(t),[n,i]=mZ(e);for(let o=0;o<this.hashCount;o++){const s=this.de(n,i,o);this.Re(s)}}Re(t){const e=Math.floor(t/8);this.bitmap[e]|=1<<t%8}}class C9 extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class v9{constructor(t,e,n,i,o){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(t,e,n){const i=new Map;return i.set(t,y9.createSynthesizedTargetChangeForCurrentChange(t,e,n)),new v9(vt.min(),i,new F1(Kt),xo(),ln())}}class y9{constructor(t,e,n,i,o){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(t,e,n){return new y9(n,e,ln(),ln(),ln())}}class o_{constructor(t,e,n,i){this.Ve=t,this.removedTargetIds=e,this.key=n,this.me=i}}class _Z{constructor(t,e){this.targetId=t,this.fe=e}}class CZ{constructor(t,e,n=Pi.EMPTY_BYTE_STRING,i=null){this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=i}}class vZ{constructor(){this.ge=0,this.pe=MZ(),this.ye=Pi.EMPTY_BYTE_STRING,this.we=!1,this.Se=!0}get current(){return this.we}get resumeToken(){return this.ye}get be(){return 0!==this.ge}get De(){return this.Se}Ce(t){t.approximateByteSize()>0&&(this.Se=!0,this.ye=t)}ve(){let t=ln(),e=ln(),n=ln();return this.pe.forEach((i,o)=>{switch(o){case 0:t=t.add(i);break;case 2:e=e.add(i);break;case 1:n=n.add(i);break;default:lt()}}),new y9(this.ye,this.we,t,e,n)}Fe(){this.Se=!1,this.pe=MZ()}Me(t,e){this.Se=!0,this.pe=this.pe.insert(t,e)}xe(t){this.Se=!0,this.pe=this.pe.remove(t)}Oe(){this.ge+=1}Ne(){this.ge-=1,pt(this.ge>=0)}Be(){this.Se=!0,this.we=!0}}class lPe{constructor(t){this.Le=t,this.ke=new Map,this.qe=xo(),this.Qe=yZ(),this.Ke=new F1(Kt)}$e(t){for(const e of t.Ve)t.me&&t.me.isFoundDocument()?this.Ue(e,t.me):this.We(e,t.key,t.me);for(const e of t.removedTargetIds)this.We(e,t.key,t.me)}Ge(t){this.forEachTarget(t,e=>{const n=this.ze(e);switch(t.state){case 0:this.je(e)&&n.Ce(t.resumeToken);break;case 1:n.Ne(),n.be||n.Fe(),n.Ce(t.resumeToken);break;case 2:n.Ne(),n.be||this.removeTarget(e);break;case 3:this.je(e)&&(n.Be(),n.Ce(t.resumeToken));break;case 4:this.je(e)&&(this.He(e),n.Ce(t.resumeToken));break;default:lt()}})}forEachTarget(t,e){t.targetIds.length>0?t.targetIds.forEach(e):this.ke.forEach((n,i)=>{this.je(i)&&e(i)})}Je(t){const e=t.targetId,n=t.fe.count,i=this.Ye(e);if(i){const o=i.target;if(Qm(o))if(0===n){const s=new Ze(o.path);this.We(e,s,K1.newNoDocument(s,vt.min()))}else pt(1===n);else{const s=this.Ze(e);if(s!==n){const a=this.Xe(t),c=a?this.et(a,t,s):1;0!==c&&(this.He(e),this.Ke=this.Ke.insert(e,2===c?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch"))}}}}Xe(t){const e=t.fe.unchangedNames;if(!e||!e.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:o=0}=e;let s,a;try{s=z3(n).toUint8Array()}catch(c){if(c instanceof Oj)return fs("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{a=new HT(s,i,o)}catch(c){return fs(c instanceof C9?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return 0===a.Te?null:a}et(t,e,n){return e.fe.count===n-this.rt(t,e.targetId)?0:2}rt(t,e){const n=this.Le.getRemoteKeysForTarget(e);let i=0;return n.forEach(o=>{const s=this.Le.nt(),a=`projects/${s.projectId}/databases/${s.database}/documents/${o.path.canonicalString()}`;t.mightContain(a)||(this.We(e,o,null),i++)}),i}it(t){const e=new Map;this.ke.forEach((o,s)=>{const a=this.Ye(s);if(a){if(o.current&&Qm(a.target)){const c=new Ze(a.target.path);null!==this.qe.get(c)||this.st(s,c)||this.We(s,c,K1.newNoDocument(c,t))}o.De&&(e.set(s,o.ve()),o.Fe())}});let n=ln();this.Qe.forEach((o,s)=>{let a=!0;s.forEachWhile(c=>{const l=this.Ye(c);return!l||"TargetPurposeLimboResolution"===l.purpose||(a=!1,!1)}),a&&(n=n.add(o))}),this.qe.forEach((o,s)=>s.setReadTime(t));const i=new v9(t,e,this.Ke,this.qe,n);return this.qe=xo(),this.Qe=yZ(),this.Ke=new F1(Kt),i}Ue(t,e){if(!this.je(t))return;const n=this.st(t,e.key)?2:0;this.ze(t).Me(e.key,n),this.qe=this.qe.insert(e.key,e),this.Qe=this.Qe.insert(e.key,this.ot(e.key).add(t))}We(t,e,n){if(!this.je(t))return;const i=this.ze(t);this.st(t,e)?i.Me(e,1):i.xe(e),this.Qe=this.Qe.insert(e,this.ot(e).delete(t)),n&&(this.qe=this.qe.insert(e,n))}removeTarget(t){this.ke.delete(t)}Ze(t){const e=this.ze(t).ve();return this.Le.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size}Oe(t){this.ze(t).Oe()}ze(t){let e=this.ke.get(t);return e||(e=new vZ,this.ke.set(t,e)),e}ot(t){let e=this.Qe.get(t);return e||(e=new E1(Kt),this.Qe=this.Qe.insert(t,e)),e}je(t){const e=null!==this.Ye(t);return e||Se("WatchChangeAggregator","Detected inactive target",t),e}Ye(t){const e=this.ke.get(t);return e&&e.be?null:this.Le._t(t)}He(t){this.ke.set(t,new vZ),this.Le.getRemoteKeysForTarget(t).forEach(e=>{this.We(t,e,null)})}st(t,e){return this.Le.getRemoteKeysForTarget(t).has(e)}}function yZ(){return new F1(Ze.comparator)}function MZ(){return new F1(Ze.comparator)}const uPe={asc:"ASCENDING",desc:"DESCENDING"},fPe={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},dPe={and:"AND",or:"OR"};class hPe{constructor(t,e){this.databaseId=t,this.useProto3Json=e}}function FT(r,t){return r.useProto3Json||i9(t)?t:{value:t}}function M5(r,t){return r.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function EZ(r,t){return r.useProto3Json?t.toBase64():t.toUint8Array()}function gPe(r,t){return M5(r,t.toTimestamp())}function $r(r){return pt(!!r),vt.fromTimestamp(function(e){const n=tl(e);return new vr(n.seconds,n.nanos)}(r))}function UT(r,t){return GT(r,t).canonicalString()}function GT(r,t){const e=(i=r,new Rn(["projects",i.projectId,"databases",i.database])).child("documents");var i;return void 0===t?e:e.child(t)}function PZ(r){const t=Rn.fromString(r);return pt(RZ(t)),t}function M9(r,t){return UT(r.databaseId,t.path)}function Lc(r,t){const e=PZ(t);if(e.get(1)!==r.databaseId.projectId)throw new Oe(ue.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+e.get(1)+" vs "+r.databaseId.projectId);if(e.get(3)!==r.databaseId.database)throw new Oe(ue.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+e.get(3)+" vs "+r.databaseId.database);return new Ze(TZ(e))}function SZ(r,t){return UT(r.databaseId,t)}function BT(r){return new Rn(["projects",r.databaseId.projectId,"databases",r.databaseId.database]).canonicalString()}function TZ(r){return pt(r.length>4&&"documents"===r.get(4)),r.popFirst(5)}function wZ(r,t,e){return{name:M9(r,t),fields:e.value.mapValue.fields}}function AZ(r,t){return{documents:[SZ(r,t.path)]}}function WT(r,t){const e={structuredQuery:{}},n=t.path;let i;null!==t.collectionGroup?(i=n,e.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(i=n.popLast(),e.structuredQuery.from=[{collectionId:n.lastSegment()}]),e.parent=SZ(r,i);const o=function(l){if(0!==l.length)return kZ(g1.create(l,"and"))}(t.filters);o&&(e.structuredQuery.where=o);const s=function(l){if(0!==l.length)return l.map(u=>{return{field:sl((g=u).field),direction:vPe(g.dir)};var g})}(t.orderBy);s&&(e.structuredQuery.orderBy=s);const a=FT(r,t.limit);return null!==a&&(e.structuredQuery.limit=a),t.startAt&&(e.structuredQuery.startAt={before:(l=t.startAt).inclusive,values:l.position}),t.endAt&&(e.structuredQuery.endAt=function(l){return{before:!l.inclusive,values:l.position}}(t.endAt)),{ut:e,parent:i};var l}function NZ(r){let t=function OZ(r){const t=PZ(r);return 4===t.length?Rn.emptyPath():TZ(t)}(r.parent);const e=r.structuredQuery,n=e.from?e.from.length:0;let i=null;if(n>0){pt(1===n);const u=e.from[0];u.allDescendants?i=u.collectionId:t=t.child(u.collectionId)}let o=[];e.where&&(o=function(f){const g=IZ(f);return g instanceof g1&&AT(g)?g.getFilters():[g]}(e.where));let s=[];e.orderBy&&(s=e.orderBy.map(g=>{return new u9(E5((S=g).field),function(R){switch(R){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(S.direction));var S}));let a=null;e.limit&&(a=function(f){let g;return g="object"==typeof f?f.value:f,i9(g)?null:g}(e.limit));let c=null;var f;e.startAt&&(c=new ol((f=e.startAt).values||[],!!f.before));let l=null;return e.endAt&&(l=function(f){return new ol(f.values||[],!f.before)}(e.endAt)),function $j(r,t,e,n,i,o,s,a){return new D3(r,t,e,n,i,o,s,a)}(t,i,s,o,a,"F",c,l)}function IZ(r){return void 0!==r.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const n=E5(e.unaryFilter.field);return xn.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=E5(e.unaryFilter.field);return xn.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const o=E5(e.unaryFilter.field);return xn.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=E5(e.unaryFilter.field);return xn.create(s,"!=",{nullValue:"NULL_VALUE"});default:return lt()}}(r):void 0!==r.fieldFilter?xn.create(E5((e=r).fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return lt()}}(e.fieldFilter.op),e.fieldFilter.value):void 0!==r.compositeFilter?function(e){return g1.create(e.compositeFilter.filters.map(n=>IZ(n)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return lt()}}(e.compositeFilter.op))}(r):lt();var e}function vPe(r){return uPe[r]}function yPe(r){return fPe[r]}function MPe(r){return dPe[r]}function sl(r){return{fieldPath:r.canonicalString()}}function E5(r){return dr.fromServerFormat(r.fieldPath)}function kZ(r){return r instanceof xn?function(e){if("=="===e.op){if(bj(e.value))return{unaryFilter:{field:sl(e.field),op:"IS_NAN"}};if(wj(e.value))return{unaryFilter:{field:sl(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(bj(e.value))return{unaryFilter:{field:sl(e.field),op:"IS_NOT_NAN"}};if(wj(e.value))return{unaryFilter:{field:sl(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:sl(e.field),op:yPe(e.op),value:e.value}}}(r):r instanceof g1?function(e){const n=e.getFilters().map(i=>kZ(i));return 1===n.length?n[0]:{compositeFilter:{op:MPe(e.op),filters:n}}}(r):lt()}function EPe(r){const t=[];return r.fields.forEach(e=>t.push(e.canonicalString())),{fieldPaths:t}}function RZ(r){return r.length>=4&&"projects"===r.get(0)&&"databases"===r.get(2)}class F3{constructor(t,e,n,i,o=vt.min(),s=vt.min(),a=Pi.EMPTY_BYTE_STRING,c=null){this.target=t,this.targetId=e,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(t){return new F3(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,e){return new F3(this.target,this.targetId,this.purpose,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new F3(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new F3(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}class xZ{constructor(t){this.ct=t}}function qT(r){const t=NZ({parent:r.parent,structuredQuery:r.structuredQuery});return"LAST"===r.limitType?e_(t,t.limit,"L"):t}class H6{constructor(){}Pt(t,e){this.It(t,e),e.Tt()}It(t,e){if("nullValue"in t)this.Et(e,5);else if("booleanValue"in t)this.Et(e,10),e.dt(t.booleanValue?1:0);else if("integerValue"in t)this.Et(e,15),e.dt(wr(t.integerValue));else if("doubleValue"in t){const n=wr(t.doubleValue);isNaN(n)?this.Et(e,13):(this.Et(e,15),o9(n)?e.dt(0):e.dt(n))}else if("timestampValue"in t){const n=t.timestampValue;this.Et(e,20),"string"==typeof n?e.At(n):(e.At(`${n.seconds||""}`),e.dt(n.nanos||0))}else if("stringValue"in t)this.Rt(t.stringValue,e),this.Vt(e);else if("bytesValue"in t)this.Et(e,30),e.ft(z3(t.bytesValue)),this.Vt(e);else if("referenceValue"in t)this.gt(t.referenceValue,e);else if("geoPointValue"in t){const n=t.geoPointValue;this.Et(e,45),e.dt(n.latitude||0),e.dt(n.longitude||0)}else"mapValue"in t?Aj(t)?this.Et(e,Number.MAX_SAFE_INTEGER):(this.yt(t.mapValue,e),this.Vt(e)):"arrayValue"in t?(this.wt(t.arrayValue,e),this.Vt(e)):lt()}Rt(t,e){this.Et(e,25),this.St(t,e)}St(t,e){e.At(t)}yt(t,e){const n=t.fields||{};this.Et(e,55);for(const i of Object.keys(n))this.Rt(i,e),this.It(n[i],e)}wt(t,e){const n=t.values||[];this.Et(e,50);for(const i of n)this.It(i,e)}gt(t,e){this.Et(e,37),Ze.fromName(t).path.forEach(n=>{this.Et(e,60),this.St(n,e)})}Et(t,e){t.dt(e)}Vt(t){t.dt(2)}}H6.bt=new H6;class NPe{constructor(){this._n=new QT}addToCollectionParentIndex(t,e){return this._n.add(e),oe.resolve()}getCollectionParents(t,e){return oe.resolve(this._n.getEntries(e))}addFieldIndex(t,e){return oe.resolve()}deleteFieldIndex(t,e){return oe.resolve()}deleteAllFieldIndexes(t){return oe.resolve()}createTargetIndexes(t,e){return oe.resolve()}getDocumentsMatchingTarget(t,e){return oe.resolve(null)}getIndexType(t,e){return oe.resolve(0)}getFieldIndexes(t,e){return oe.resolve([])}getNextCollectionGroupToUpdate(t){return oe.resolve(null)}getMinOffset(t,e){return oe.resolve(ds.min())}getMinOffsetFromCollectionGroup(t,e){return oe.resolve(ds.min())}updateCollectionGroup(t,e,n){return oe.resolve()}updateIndexEntries(t,e){return oe.resolve()}}class QT{constructor(){this.index={}}add(t){const e=t.lastSegment(),n=t.popLast(),i=this.index[e]||new E1(Rn.comparator),o=!i.has(n);return this.index[e]=i.add(n),o}has(t){const e=t.lastSegment(),n=t.popLast(),i=this.index[e];return i&&i.has(n)}getEntries(t){return(this.index[t]||new E1(Rn.comparator)).toArray()}}new Uint8Array(0);class F2{constructor(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}static withCacheSize(t){return new F2(t,F2.DEFAULT_COLLECTION_PERCENTILE,F2.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}F2.DEFAULT_COLLECTION_PERCENTILE=10,F2.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,F2.DEFAULT=new F2(41943040,F2.DEFAULT_COLLECTION_PERCENTILE,F2.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),F2.DISABLED=new F2(-1,0,0);class U6{constructor(t){this.On=t}next(){return this.On+=2,this.On}static Nn(){return new U6(0)}static Bn(){return new U6(-1)}}class rY{constructor(){this.changes=new V3(t=>t.toString(),(t,e)=>t.isEqual(e)),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,e){this.assertNotApplied(),this.changes.set(t,K1.newInvalidDocument(t).setReadTime(e))}getEntry(t,e){this.assertNotApplied();const n=this.changes.get(e);return void 0!==n?oe.resolve(n):this.getFromCache(t,e)}getEntries(t,e){return this.getAllFromCache(t,e)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}class VPe{constructor(t,e){this.overlayedDocument=t,this.mutatedFields=e}}class cY{constructor(t,e,n,i){this.remoteDocumentCache=t,this.mutationQueue=e,this.documentOverlayCache=n,this.indexManager=i}getDocument(t,e){let n=null;return this.documentOverlayCache.getOverlay(t,e).next(i=>(n=i,this.remoteDocumentCache.getEntry(t,e))).next(i=>(null!==n&&_9(n.mutation,i,Ro.empty(),vr.now()),i))}getDocuments(t,e){return this.remoteDocumentCache.getEntries(t,e).next(n=>this.getLocalViewOfDocuments(t,n,ln()).next(()=>n))}getLocalViewOfDocuments(t,e,n=ln()){const i=xc();return this.populateOverlays(t,i,e).next(()=>this.computeViews(t,e,i,n).next(o=>{let s=g9();return o.forEach((a,c)=>{s=s.insert(a,c.overlayedDocument)}),s}))}getOverlayedDocuments(t,e){const n=xc();return this.populateOverlays(t,n,e).next(()=>this.computeViews(t,e,n,ln()))}populateOverlays(t,e,n){const i=[];return n.forEach(o=>{e.has(o)||i.push(o)}),this.documentOverlayCache.getOverlays(t,i).next(o=>{o.forEach((s,a)=>{e.set(s,a)})})}computeViews(t,e,n,i){let o=xo();const s=p9(),a=p9();return e.forEach((c,l)=>{const u=n.get(l.key);i.has(l.key)&&(void 0===u||u.mutation instanceof H3)?o=o.insert(l.key,l):void 0!==u?(s.set(l.key,u.mutation.getFieldMask()),_9(u.mutation,l,u.mutation.getFieldMask(),vr.now())):s.set(l.key,Ro.empty())}),this.recalculateAndSaveOverlays(t,o).next(c=>(c.forEach((l,u)=>s.set(l,u)),e.forEach((l,u)=>{var f;return a.set(l,new VPe(u,null!==(f=s.get(l))&&void 0!==f?f:null))}),a))}recalculateAndSaveOverlays(t,e){const n=p9();let i=new F1((s,a)=>s-a),o=ln();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next(s=>{for(const a of s)a.keys().forEach(c=>{const l=e.get(c);if(null===l)return;let u=n.get(c)||Ro.empty();u=a.applyToLocalView(l,u),n.set(c,u);const f=(i.get(a.batchId)||ln()).add(c);i=i.insert(a.batchId,f)})}).next(()=>{const s=[],a=i.getReverseIterator();for(;a.hasNext();){const c=a.getNext(),l=c.key,u=c.value,f=Qj();u.forEach(g=>{if(!o.has(g)){const y=aZ(e.get(g),n.get(g));null!==y&&f.set(g,y),o=o.add(g)}}),s.push(this.documentOverlayCache.saveOverlays(t,l,f))}return oe.waitFor(s)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(t,e){return this.remoteDocumentCache.getEntries(t,e).next(n=>this.recalculateAndSaveOverlays(t,n))}getDocumentsMatchingQuery(t,e,n,i){return Ze.isDocumentKey((s=e).path)&&null===s.collectionGroup&&0===s.filters.length?this.getDocumentsMatchingDocumentQuery(t,e.path):kT(e)?this.getDocumentsMatchingCollectionGroupQuery(t,e,n,i):this.getDocumentsMatchingCollectionQuery(t,e,n,i);var s}getNextDocuments(t,e,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(t,e,n,i).next(o=>{const s=i-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,e,n.largestBatchId,i-o.size):oe.resolve(xc());let a=-1,c=o;return s.next(l=>oe.forEach(l,(u,f)=>(a<f.largestBatchId&&(a=f.largestBatchId),o.get(u)?oe.resolve():this.remoteDocumentCache.getEntry(t,u).next(g=>{c=c.insert(u,g)}))).next(()=>this.populateOverlays(t,l,o)).next(()=>this.computeViews(t,c,l,ln())).next(u=>({batchId:a,changes:Xj(u)})))})}getDocumentsMatchingDocumentQuery(t,e){return this.getDocument(t,new Ze(e)).next(n=>{let i=g9();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(t,e,n,i){const o=e.collectionGroup;let s=g9();return this.indexManager.getCollectionParents(t,o).next(a=>oe.forEach(a,c=>{const l=(f=e,g=c.child(o),new D3(g,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt));var f,g;return this.getDocumentsMatchingCollectionQuery(t,l,n,i).next(u=>{u.forEach((f,g)=>{s=s.insert(f,g)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(t,e,n,i){let o;return this.documentOverlayCache.getOverlaysForCollection(t,e.path,n.largestBatchId).next(s=>(o=s,this.remoteDocumentCache.getDocumentsMatchingQuery(t,e,n,o,i))).next(s=>{o.forEach((c,l)=>{const u=l.getKey();null===s.get(u)&&(s=s.insert(u,K1.newInvalidDocument(u)))});let a=g9();return s.forEach((c,l)=>{const u=o.get(c);void 0!==u&&_9(u.mutation,l,Ro.empty(),vr.now()),h9(e,l)&&(a=a.insert(c,l))}),a})}}class HPe{constructor(t){this.serializer=t,this.cr=new Map,this.lr=new Map}getBundleMetadata(t,e){return oe.resolve(this.cr.get(e))}saveBundleMetadata(t,e){return this.cr.set(e.id,{id:(i=e).id,version:i.version,createTime:$r(i.createTime)}),oe.resolve();var i}getNamedQuery(t,e){return oe.resolve(this.lr.get(e))}saveNamedQuery(t,e){return this.lr.set(e.name,{name:(i=e).name,query:qT(i.bundledQuery),readTime:$r(i.readTime)}),oe.resolve();var i}}class FPe{constructor(){this.overlays=new F1(Ze.comparator),this.hr=new Map}getOverlay(t,e){return oe.resolve(this.overlays.get(e))}getOverlays(t,e){const n=xc();return oe.forEach(e,i=>this.getOverlay(t,i).next(o=>{null!==o&&n.set(i,o)})).next(()=>n)}saveOverlays(t,e,n){return n.forEach((i,o)=>{this.ht(t,e,o)}),oe.resolve()}removeOverlaysForBatchId(t,e,n){const i=this.hr.get(n);return void 0!==i&&(i.forEach(o=>this.overlays=this.overlays.remove(o)),this.hr.delete(n)),oe.resolve()}getOverlaysForCollection(t,e,n){const i=xc(),o=e.length+1,s=new Ze(e.child("")),a=this.overlays.getIteratorFrom(s);for(;a.hasNext();){const c=a.getNext().value,l=c.getKey();if(!e.isPrefixOf(l.path))break;l.path.length===o&&c.largestBatchId>n&&i.set(c.getKey(),c)}return oe.resolve(i)}getOverlaysForCollectionGroup(t,e,n,i){let o=new F1((l,u)=>l-u);const s=this.overlays.getIterator();for(;s.hasNext();){const l=s.getNext().value;if(l.getKey().getCollectionGroup()===e&&l.largestBatchId>n){let u=o.get(l.largestBatchId);null===u&&(u=xc(),o=o.insert(l.largestBatchId,u)),u.set(l.getKey(),l)}}const a=xc(),c=o.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((l,u)=>a.set(l,u)),!(a.size()>=i)););return oe.resolve(a)}ht(t,e,n){const i=this.overlays.get(n.key);if(null!==i){const s=this.hr.get(i.largestBatchId).delete(n.key);this.hr.set(i.largestBatchId,s)}this.overlays=this.overlays.insert(n.key,new VT(e,n));let o=this.hr.get(e);void 0===o&&(o=ln(),this.hr.set(e,o)),this.hr.set(e,o.add(n.key))}}class JT{constructor(){this.Pr=new E1(Fi.Ir),this.Tr=new E1(Fi.Er)}isEmpty(){return this.Pr.isEmpty()}addReference(t,e){const n=new Fi(t,e);this.Pr=this.Pr.add(n),this.Tr=this.Tr.add(n)}dr(t,e){t.forEach(n=>this.addReference(n,e))}removeReference(t,e){this.Ar(new Fi(t,e))}Rr(t,e){t.forEach(n=>this.removeReference(n,e))}Vr(t){const e=new Ze(new Rn([])),n=new Fi(e,t),i=new Fi(e,t+1),o=[];return this.Tr.forEachInRange([n,i],s=>{this.Ar(s),o.push(s.key)}),o}mr(){this.Pr.forEach(t=>this.Ar(t))}Ar(t){this.Pr=this.Pr.delete(t),this.Tr=this.Tr.delete(t)}gr(t){const e=new Ze(new Rn([])),n=new Fi(e,t),i=new Fi(e,t+1);let o=ln();return this.Tr.forEachInRange([n,i],s=>{o=o.add(s.key)}),o}containsKey(t){const e=new Fi(t,0),n=this.Pr.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)}}class Fi{constructor(t,e){this.key=t,this.pr=e}static Ir(t,e){return Ze.comparator(t.key,e.key)||Kt(t.pr,e.pr)}static Er(t,e){return Kt(t.pr,e.pr)||Ze.comparator(t.key,e.key)}}class UPe{constructor(t,e){this.indexManager=t,this.referenceDelegate=e,this.mutationQueue=[],this.yr=1,this.wr=new E1(Fi.Ir)}checkEmpty(t){return oe.resolve(0===this.mutationQueue.length)}addMutationBatch(t,e,n,i){const o=this.yr;this.yr++;const s=new zT(o,e,n,i);this.mutationQueue.push(s);for(const a of i)this.wr=this.wr.add(new Fi(a.key,o)),this.indexManager.addToCollectionParentIndex(t,a.key.path.popLast());return oe.resolve(s)}lookupMutationBatch(t,e){return oe.resolve(this.Sr(e))}getNextMutationBatchAfterBatchId(t,e){const i=this.br(e+1),o=i<0?0:i;return oe.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return oe.resolve(0===this.mutationQueue.length?-1:this.yr-1)}getAllMutationBatches(t){return oe.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,e){const n=new Fi(e,0),i=new Fi(e,Number.POSITIVE_INFINITY),o=[];return this.wr.forEachInRange([n,i],s=>{const a=this.Sr(s.pr);o.push(a)}),oe.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(t,e){let n=new E1(Kt);return e.forEach(i=>{const o=new Fi(i,0),s=new Fi(i,Number.POSITIVE_INFINITY);this.wr.forEachInRange([o,s],a=>{n=n.add(a.pr)})}),oe.resolve(this.Dr(n))}getAllMutationBatchesAffectingQuery(t,e){const n=e.path,i=n.length+1;let o=n;Ze.isDocumentKey(o)||(o=o.child(""));const s=new Fi(new Ze(o),0);let a=new E1(Kt);return this.wr.forEachWhile(c=>{const l=c.key.path;return!!n.isPrefixOf(l)&&(l.length===i&&(a=a.add(c.pr)),!0)},s),oe.resolve(this.Dr(a))}Dr(t){const e=[];return t.forEach(n=>{const i=this.Sr(n);null!==i&&e.push(i)}),e}removeMutationBatch(t,e){pt(0===this.Cr(e.batchId,"removed")),this.mutationQueue.shift();let n=this.wr;return oe.forEach(e.mutations,i=>{const o=new Fi(i.key,e.batchId);return n=n.delete(o),this.referenceDelegate.markPotentiallyOrphaned(t,i.key)}).next(()=>{this.wr=n})}Mn(t){}containsKey(t,e){const n=new Fi(e,0),i=this.wr.firstAfterOrEqual(n);return oe.resolve(e.isEqual(i&&i.key))}performConsistencyCheck(t){return oe.resolve()}Cr(t,e){return this.br(t)}br(t){return 0===this.mutationQueue.length?0:t-this.mutationQueue[0].batchId}Sr(t){const e=this.br(t);return e<0||e>=this.mutationQueue.length?null:this.mutationQueue[e]}}class GPe{constructor(t){this.vr=t,this.docs=new F1(Ze.comparator),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,e){const n=e.key,i=this.docs.get(n),o=i?i.size:0,s=this.vr(e);return this.docs=this.docs.insert(n,{document:e.mutableCopy(),size:s}),this.size+=s-o,this.indexManager.addToCollectionParentIndex(t,n.path.popLast())}removeEntry(t){const e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}getEntry(t,e){const n=this.docs.get(e);return oe.resolve(n?n.document.mutableCopy():K1.newInvalidDocument(e))}getEntries(t,e){let n=xo();return e.forEach(i=>{const o=this.docs.get(i);n=n.insert(i,o?o.document.mutableCopy():K1.newInvalidDocument(i))}),oe.resolve(n)}getDocumentsMatchingQuery(t,e,n,i){let o=xo();const s=e.path,a=new Ze(s.child("")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){const{key:l,value:{document:u}}=c.getNext();if(!s.isPrefixOf(l.path))break;l.path.length>s.length+1||ET(fj(u),n)<=0||(i.has(u.key)||h9(e,u))&&(o=o.insert(u.key,u.mutableCopy()))}return oe.resolve(o)}getAllFromCollectionGroup(t,e,n,i){lt()}Fr(t,e){return oe.forEach(this.docs,n=>e(n))}newChangeBuffer(t){return new BPe(this)}getSize(t){return oe.resolve(this.size)}}class BPe extends rY{constructor(t){super(),this.ar=t}applyChanges(t){const e=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?e.push(this.ar.addEntry(t,i)):this.ar.removeEntry(n)}),oe.waitFor(e)}getFromCache(t,e){return this.ar.getEntry(t,e)}getAllFromCache(t,e){return this.ar.getEntries(t,e)}}class $Pe{constructor(t){this.persistence=t,this.Mr=new V3(e=>R6(e),f9),this.lastRemoteSnapshotVersion=vt.min(),this.highestTargetId=0,this.Or=0,this.Nr=new JT,this.targetCount=0,this.Br=U6.Nn()}forEachTarget(t,e){return this.Mr.forEach((n,i)=>e(i)),oe.resolve()}getLastRemoteSnapshotVersion(t){return oe.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return oe.resolve(this.Or)}allocateTargetId(t){return this.highestTargetId=this.Br.next(),oe.resolve(this.highestTargetId)}setTargetsMetadata(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Or&&(this.Or=e),oe.resolve()}qn(t){this.Mr.set(t.target,t);const e=t.targetId;e>this.highestTargetId&&(this.Br=new U6(e),this.highestTargetId=e),t.sequenceNumber>this.Or&&(this.Or=t.sequenceNumber)}addTargetData(t,e){return this.qn(e),this.targetCount+=1,oe.resolve()}updateTargetData(t,e){return this.qn(e),oe.resolve()}removeTargetData(t,e){return this.Mr.delete(e.target),this.Nr.Vr(e.targetId),this.targetCount-=1,oe.resolve()}removeTargets(t,e,n){let i=0;const o=[];return this.Mr.forEach((s,a)=>{a.sequenceNumber<=e&&null===n.get(a.targetId)&&(this.Mr.delete(s),o.push(this.removeMatchingKeysForTargetId(t,a.targetId)),i++)}),oe.waitFor(o).next(()=>i)}getTargetCount(t){return oe.resolve(this.targetCount)}getTargetData(t,e){const n=this.Mr.get(e)||null;return oe.resolve(n)}addMatchingKeys(t,e,n){return this.Nr.dr(e,n),oe.resolve()}removeMatchingKeys(t,e,n){this.Nr.Rr(e,n);const i=this.persistence.referenceDelegate,o=[];return i&&e.forEach(s=>{o.push(i.markPotentiallyOrphaned(t,s))}),oe.waitFor(o)}removeMatchingKeysForTargetId(t,e){return this.Nr.Vr(e),oe.resolve()}getMatchingKeysForTargetId(t,e){const n=this.Nr.gr(e);return oe.resolve(n)}containsKey(t,e){return oe.resolve(this.Nr.containsKey(e))}}class ew{constructor(t,e){this.Lr={},this.overlays={},this.kr=new hs(0),this.qr=!1,this.qr=!0,this.referenceDelegate=t(this),this.Qr=new $Pe(this),this.indexManager=new NPe,this.remoteDocumentCache=new GPe(n=>this.referenceDelegate.Kr(n)),this.serializer=new xZ(e),this.$r=new HPe(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.qr=!1,Promise.resolve()}get started(){return this.qr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let e=this.overlays[t.toKey()];return e||(e=new FPe,this.overlays[t.toKey()]=e),e}getMutationQueue(t,e){let n=this.Lr[t.toKey()];return n||(n=new UPe(e,this.referenceDelegate),this.Lr[t.toKey()]=n),n}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.$r}runTransaction(t,e,n){Se("MemoryPersistence","Starting transaction:",t);const i=new WPe(this.kr.next());return this.referenceDelegate.Ur(),n(i).next(o=>this.referenceDelegate.Wr(i).next(()=>o)).toPromise().then(o=>(i.raiseOnCommittedEvent(),o))}Gr(t,e){return oe.or(Object.values(this.Lr).map(n=>()=>n.containsKey(t,e)))}}class WPe extends hj{constructor(t){super(),this.currentSequenceNumber=t}}class h_{constructor(t){this.persistence=t,this.zr=new JT,this.jr=null}static Hr(t){return new h_(t)}get Jr(){if(this.jr)return this.jr;throw lt()}addReference(t,e,n){return this.zr.addReference(n,e),this.Jr.delete(n.toString()),oe.resolve()}removeReference(t,e,n){return this.zr.removeReference(n,e),this.Jr.add(n.toString()),oe.resolve()}markPotentiallyOrphaned(t,e){return this.Jr.add(e.toString()),oe.resolve()}removeTarget(t,e){this.zr.Vr(e.targetId).forEach(i=>this.Jr.add(i.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(t,e.targetId).next(i=>{i.forEach(o=>this.Jr.add(o.toString()))}).next(()=>n.removeTargetData(t,e))}Ur(){this.jr=new Set}Wr(t){const e=this.persistence.getRemoteDocumentCache().newChangeBuffer();return oe.forEach(this.Jr,n=>{const i=Ze.fromPath(n);return this.Yr(t,i).next(o=>{o||e.removeEntry(i,vt.min())})}).next(()=>(this.jr=null,e.apply(t)))}updateLimboDocument(t,e){return this.Yr(t,e).next(n=>{n?this.Jr.delete(e.toString()):this.Jr.add(e.toString())})}Kr(t){return 0}Yr(t,e){return oe.or([()=>oe.resolve(this.zr.containsKey(e)),()=>this.persistence.getTargetCache().containsKey(t,e),()=>this.persistence.Gr(t,e)])}}class iw{constructor(t,e,n,i){this.targetId=t,this.fromCache=e,this.qi=n,this.Qi=i}static Ki(t,e){let n=ln(),i=ln();for(const o of e.docChanges)switch(o.type){case 0:n=n.add(o.doc.key);break;case 1:i=i.add(o.doc.key)}return new iw(t,e.fromCache,n,i)}}class jPe{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}class uY{constructor(){this.$i=!1,this.Ui=!1,this.Wi=100,this.Gi=function SW(){return!function kve(){var r;const t=null===(r=hm())||void 0===r?void 0:r.forceEnvironment;if("node"===t)return!0;if("browser"===t)return!1;try{return"[object process]"===Object.prototype.toString.call(global.process)}catch{return!1}}()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}()?8:Ws.v(Or())>0?6:4}initialize(t,e){this.zi=t,this.indexManager=e,this.$i=!0}getDocumentsMatchingQuery(t,e,n,i){const o={result:null};return this.ji(t,e).next(s=>{o.result=s}).next(()=>{if(!o.result)return this.Hi(t,e,i,n).next(s=>{o.result=s})}).next(()=>{if(o.result)return;const s=new jPe;return this.Ji(t,e,s).next(a=>{if(o.result=a,this.Ui)return this.Yi(t,e,s,a.size)})}).next(()=>o.result)}Yi(t,e,n,i){return n.documentReadCount<this.Wi?(a5()<=kn.DEBUG&&Se("QueryEngine","SDK will not create cache indexes for query:",m5(e),"since it only creates cache indexes for collection contains","more than or equal to",this.Wi,"documents"),oe.resolve()):(a5()<=kn.DEBUG&&Se("QueryEngine","Query:",m5(e),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.Gi*i?(a5()<=kn.DEBUG&&Se("QueryEngine","The SDK decides to create cache indexes for query:",m5(e),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,lo(e))):oe.resolve())}ji(t,e){if(Wj(e))return oe.resolve(null);let n=lo(e);return this.indexManager.getIndexType(t,n).next(i=>0===i?null:(null!==e.limit&&1===i&&(e=e_(e,null,"F"),n=lo(e)),this.indexManager.getDocumentsMatchingTarget(t,n).next(o=>{const s=ln(...o);return this.zi.getDocuments(t,s).next(a=>this.indexManager.getMinOffset(t,n).next(c=>{const l=this.Zi(e,a);return this.Xi(e,l,s,c.readTime)?this.ji(t,e_(e,null,"F")):this.es(t,l,e,c)}))})))}Hi(t,e,n,i){return Wj(e)||i.isEqual(vt.min())?oe.resolve(null):this.zi.getDocuments(t,n).next(o=>{const s=this.Zi(e,o);return this.Xi(e,s,n,i)?oe.resolve(null):(a5()<=kn.DEBUG&&Se("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),m5(e)),this.es(t,s,e,function uj(r,t){const e=r.toTimestamp().seconds,n=r.toTimestamp().nanoseconds+1,i=vt.fromTimestamp(1e9===n?new vr(e+1,0):new vr(e,n));return new ds(i,Ze.empty(),t)}(i,-1)).next(a=>a))})}Zi(t,e){let n=new E1(Yj(t));return e.forEach((i,o)=>{h9(t,o)&&(n=n.add(o))}),n}Xi(t,e,n,i){if(null===t.limit)return!1;if(n.size!==e.size)return!0;const o="F"===t.limitType?e.last():e.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(i)>0)}Ji(t,e,n){return a5()<=kn.DEBUG&&Se("QueryEngine","Using full collection scan to execute query:",m5(e)),this.zi.getDocumentsMatchingQuery(t,e,ds.min(),n)}es(t,e,n,i){return this.zi.getDocumentsMatchingQuery(t,n,i).next(o=>(e.forEach(s=>{o=o.insert(s.key,s)}),o))}}class ZPe{constructor(t,e,n,i){this.persistence=t,this.ts=e,this.serializer=i,this.ns=new F1(Kt),this.rs=new V3(o=>R6(o),f9),this.ss=new Map,this.os=t.getRemoteDocumentCache(),this.Qr=t.getTargetCache(),this.$r=t.getBundleCache(),this._s(n)}_s(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new cY(this.os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.os.setIndexManager(this.indexManager),this.ts.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",e=>t.collect(e,this.ns))}}function dY(r,t){return ow.apply(this,arguments)}function ow(){return ow=M(function*(r,t){const e=qe(r);return yield e.persistence.runTransaction("Handle user change","readonly",n=>{let i;return e.mutationQueue.getAllMutationBatches(n).next(o=>(i=o,e._s(t),e.mutationQueue.getAllMutationBatches(n))).next(o=>{const s=[],a=[];let c=ln();for(const l of i){s.push(l.batchId);for(const u of l.mutations)c=c.add(u.key)}for(const l of o){a.push(l.batchId);for(const u of l.mutations)c=c.add(u.key)}return e.localDocuments.getDocuments(n,c).next(l=>({us:l,removedBatchIds:s,addedBatchIds:a}))})})}),ow.apply(this,arguments)}function hY(r){const t=qe(r);return t.persistence.runTransaction("Get last remote snapshot version","readonly",e=>t.Qr.getLastRemoteSnapshotVersion(e))}function XPe(r,t){const e=qe(r);return e.persistence.runTransaction("Get next mutation batch","readonly",n=>(void 0===t&&(t=-1),e.mutationQueue.getNextMutationBatchAfterBatchId(n,t)))}function b5(r,t,e){return sw.apply(this,arguments)}function sw(){return sw=M(function*(r,t,e){const n=qe(r),i=n.ns.get(t),o=e?"readwrite":"readwrite-primary";try{e||(yield n.persistence.runTransaction("Release target",o,s=>n.persistence.referenceDelegate.removeTarget(s,i)))}catch(s){if(!J4(s))throw s;Se("LocalStore",`Failed to update sequence numbers for target ${t}: ${s}`)}n.ns=n.ns.remove(t),n.rs.delete(i.target)}),sw.apply(this,arguments)}function m_(r,t,e){const n=qe(r);let i=vt.min(),o=ln();return n.persistence.runTransaction("Execute query","readwrite",s=>function(c,l,u){const f=qe(c),g=f.rs.get(u);return void 0!==g?oe.resolve(f.ns.get(g)):f.Qr.getTargetData(l,u)}(n,s,lo(t)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,n.Qr.getMatchingKeysForTargetId(s,a.targetId).next(c=>{o=c})}).next(()=>n.ts.getDocumentsMatchingQuery(s,t,e?i:vt.min(),e?o:ln())).next(a=>(function _Y(r,t,e){let n=r.ss.get(t)||vt.min();e.forEach((i,o)=>{o.readTime.compareTo(n)>0&&(n=o.readTime)}),r.ss.set(t,n)}(n,function Zj(r){return r.collectionGroup||(r.path.length%2==1?r.path.lastSegment():r.path.get(r.path.length-2))}(t),a),{documents:a,hs:o})))}class fw{constructor(){this.activeTargetIds=function xT(){return JEe}()}As(t){this.activeTargetIds=this.activeTargetIds.add(t)}Rs(t){this.activeTargetIds=this.activeTargetIds.delete(t)}ds(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class yY{constructor(){this.no=new fw,this.ro={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,e,n){}addLocalQueryTarget(t){return this.no.As(t),this.ro[t]||"not-current"}updateQueryState(t,e,n){this.ro[t]=e}removeLocalQueryTarget(t){this.no.Rs(t)}isLocalQueryTarget(t){return this.no.activeTargetIds.has(t)}clearQueryState(t){delete this.ro[t]}getAllActiveQueryTargets(){return this.no.activeTargetIds}isActiveQueryTarget(t){return this.no.activeTargetIds.has(t)}start(){return this.no=new fw,Promise.resolve()}handleUserChange(t,e,n){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}class eSe{io(t){}shutdown(){}}class MY{constructor(){this.so=()=>this.oo(),this._o=()=>this.ao(),this.uo=[],this.co()}io(t){this.uo.push(t)}shutdown(){window.removeEventListener("online",this.so),window.removeEventListener("offline",this._o)}co(){window.addEventListener("online",this.so),window.addEventListener("offline",this._o)}oo(){Se("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const t of this.uo)t(0)}ao(){Se("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const t of this.uo)t(1)}static D(){return typeof window<"u"&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let v_=null;function hw(){return null===v_?v_=268435456+Math.round(2147483648*Math.random()):v_++,"0x"+v_.toString(16)}const tSe={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class nSe{constructor(t){this.lo=t.lo,this.ho=t.ho}Po(t){this.Io=t}To(t){this.Eo=t}onMessage(t){this.Ao=t}close(){this.ho()}send(t){this.lo(t)}Ro(){this.Io()}Vo(t){this.Eo(t)}mo(t){this.Ao(t)}}const U2="WebChannelConnection";class rSe extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.fo=n+"://"+e.host,this.po=`projects/${i}/databases/${o}`,this.yo="(default)"===this.databaseId.database?`project_id=${i}`:`project_id=${i}&database_id=${o}`}get wo(){return!1}So(e,n,i,o,s){const a=hw(),c=this.bo(e,n.toUriEncodedString());Se("RestConnection",`Sending RPC '${e}' ${a}:`,c,i);const l={"google-cloud-resource-prefix":this.po,"x-goog-request-params":this.yo};return this.Do(l,o,s),this.Co(e,c,l,i).then(u=>(Se("RestConnection",`Received RPC '${e}' ${a}: `,u),u),u=>{throw fs("RestConnection",`RPC '${e}' ${a} failed with error: `,u,"url: ",c,"request:",i),u})}vo(e,n,i,o,s,a){return this.So(e,n,i,o,s)}Do(e,n,i){e["X-Goog-Api-Client"]="gl-js/ fire/"+s5,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((o,s)=>e[s]=o),i&&i.headers.forEach((o,s)=>e[s]=o)}bo(e,n){return`${this.fo}/v1/${n}:${tSe[e]}`}terminate(){}}{constructor(t){super(t),this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}Co(t,e,n,i){const o=hw();return new Promise((s,a)=>{const c=new rEe;c.setWithCredentials(!0),c.listenOnce(tEe.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case vT.NO_ERROR:const u=c.getResponseJson();Se(U2,`XHR for RPC '${t}' ${o} received:`,JSON.stringify(u)),s(u);break;case vT.TIMEOUT:Se(U2,`RPC '${t}' ${o} timed out`),a(new Oe(ue.DEADLINE_EXCEEDED,"Request time out"));break;case vT.HTTP_ERROR:const f=c.getStatus();if(Se(U2,`RPC '${t}' ${o} failed with status:`,f,"response text:",c.getResponseText()),f>0){let g=c.getResponseJson();Array.isArray(g)&&(g=g[0]);const y=g?.error;if(y&&y.status&&y.message){const S=function(R){const U=R.toLowerCase().replace(/_/g,"-");return Object.values(ue).indexOf(U)>=0?U:ue.UNKNOWN}(y.status);a(new Oe(S,y.message))}else a(new Oe(ue.UNKNOWN,"Server responded with status "+c.getStatus()))}else a(new Oe(ue.UNAVAILABLE,"Connection failed."));break;default:lt()}}finally{Se(U2,`RPC '${t}' ${o} completed.`)}});const l=JSON.stringify(i);Se(U2,`RPC '${t}' ${o} sending request:`,i),c.send(e,"POST",l,n,15)})}Fo(t,e,n){const i=hw(),o=[this.fo,"/","google.firestore.v1.Firestore","/",t,"/channel"],s=JMe(),a=eEe(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;void 0!==l&&(c.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Do(c.initMessageHeaders,e,n),c.encodeInitMessageHeaders=!0;const u=o.join("");Se(U2,`Creating RPC '${t}' stream ${i}: ${u}`,c);const f=s.createWebChannel(u,c);let g=!1,y=!1;const S=new nSe({lo:R=>{y?Se(U2,`Not sending because RPC '${t}' stream ${i} is closed:`,R):(g||(Se(U2,`Opening RPC '${t}' stream ${i} transport.`),f.open(),g=!0),Se(U2,`RPC '${t}' stream ${i} sending:`,R),f.send(R))},ho:()=>f.close()}),N=(R,U,$)=>{R.listen(U,re=>{try{$(re)}catch(_e){setTimeout(()=>{throw _e},0)}})};return N(f,Bm.EventType.OPEN,()=>{y||Se(U2,`RPC '${t}' stream ${i} transport opened.`)}),N(f,Bm.EventType.CLOSE,()=>{y||(y=!0,Se(U2,`RPC '${t}' stream ${i} transport closed`),S.Vo())}),N(f,Bm.EventType.ERROR,R=>{y||(y=!0,fs(U2,`RPC '${t}' stream ${i} transport errored:`,R),S.Vo(new Oe(ue.UNAVAILABLE,"The operation could not be completed")))}),N(f,Bm.EventType.MESSAGE,R=>{var U;if(!y){const $=R.data[0];pt(!!$);const _e=$.error||(null===(U=$[0])||void 0===U?void 0:U.error);if(_e){Se(U2,`RPC '${t}' stream ${i} received error:`,_e);const be=_e.status;let Ve=function(u1){const an=si[u1];if(void 0!==an)return hZ(an)}(be),dt=_e.message;void 0===Ve&&(Ve=ue.INTERNAL,dt="Unknown error status: "+be+" with message "+_e.message),y=!0,S.Vo(new Oe(Ve,dt)),f.close()}else Se(U2,`RPC '${t}' stream ${i} received:`,$),S.mo($)}}),N(a,nEe.STAT_EVENT,R=>{R.stat===ij.PROXY?Se(U2,`RPC '${t}' stream ${i} detected buffering proxy`):R.stat===ij.NOPROXY&&Se(U2,`RPC '${t}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{S.Ro()},0),S}}function y_(){return typeof document<"u"?document:null}function N9(r){return new hPe(r,!0)}class gw{constructor(t,e,n=1e3,i=1.5,o=6e4){this.oi=t,this.timerId=e,this.Mo=n,this.xo=i,this.Oo=o,this.No=0,this.Bo=null,this.Lo=Date.now(),this.reset()}reset(){this.No=0}ko(){this.No=this.Oo}qo(t){this.cancel();const e=Math.floor(this.No+this.Qo()),n=Math.max(0,Date.now()-this.Lo),i=Math.max(0,e-n);i>0&&Se("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.No} ms, delay with jitter: ${e} ms, last attempt: ${n} ms ago)`),this.Bo=this.oi.enqueueAfterDelay(this.timerId,i,()=>(this.Lo=Date.now(),t())),this.No*=this.xo,this.No<this.Mo&&(this.No=this.Mo),this.No>this.Oo&&(this.No=this.Oo)}Ko(){null!==this.Bo&&(this.Bo.skipDelay(),this.Bo=null)}cancel(){null!==this.Bo&&(this.Bo.cancel(),this.Bo=null)}Qo(){return(Math.random()-.5)*this.No}}class PY{constructor(t,e,n,i,o,s,a,c){this.oi=t,this.$o=n,this.Uo=i,this.connection=o,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.Wo=0,this.Go=null,this.zo=null,this.stream=null,this.jo=new gw(t,e)}Ho(){return 1===this.state||5===this.state||this.Jo()}Jo(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Yo()}stop(){var t=this;return M(function*(){t.Ho()&&(yield t.close(0))})()}Zo(){this.state=0,this.jo.reset()}Xo(){this.Jo()&&null===this.Go&&(this.Go=this.oi.enqueueAfterDelay(this.$o,6e4,()=>this.e_()))}t_(t){this.n_(),this.stream.send(t)}e_(){var t=this;return M(function*(){if(t.Jo())return t.close(0)})()}n_(){this.Go&&(this.Go.cancel(),this.Go=null)}r_(){this.zo&&(this.zo.cancel(),this.zo=null)}close(t,e){var n=this;return M(function*(){n.n_(),n.r_(),n.jo.cancel(),n.Wo++,4!==t?n.jo.reset():e&&e.code===ue.RESOURCE_EXHAUSTED?(Br(e.toString()),Br("Using maximum backoff delay to prevent overloading the backend."),n.jo.ko()):e&&e.code===ue.UNAUTHENTICATED&&3!==n.state&&(n.authCredentialsProvider.invalidateToken(),n.appCheckCredentialsProvider.invalidateToken()),null!==n.stream&&(n.i_(),n.stream.close(),n.stream=null),n.state=t,yield n.listener.To(e)})()}i_(){}auth(){this.state=1;const t=this.s_(this.Wo),e=this.Wo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.Wo===e&&this.o_(n,i)},n=>{t(()=>{const i=new Oe(ue.UNKNOWN,"Fetching auth token failed: "+n.message);return this.__(i)})})}o_(t,e){const n=this.s_(this.Wo);this.stream=this.a_(t,e),this.stream.Po(()=>{n(()=>(this.state=2,this.zo=this.oi.enqueueAfterDelay(this.Uo,1e4,()=>(this.Jo()&&(this.state=3),Promise.resolve())),this.listener.Po()))}),this.stream.To(i=>{n(()=>this.__(i))}),this.stream.onMessage(i=>{n(()=>this.onMessage(i))})}Yo(){var t=this;this.state=5,this.jo.qo(M(function*(){t.state=0,t.start()}))}__(t){return Se("PersistentStream",`close with error: ${t}`),this.stream=null,this.close(4,t)}s_(t){return e=>{this.oi.enqueueAndForget(()=>this.Wo===t?e():(Se("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class iSe extends PY{constructor(t,e,n,i,o,s){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",e,n,i,s),this.serializer=o}a_(t,e){return this.connection.Fo("Listen",t,e)}onMessage(t){this.jo.reset();const e=function mPe(r,t){let e;if("targetChange"in t){const n="NO_CHANGE"===(l=t.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===l?1:"REMOVE"===l?2:"CURRENT"===l?3:"RESET"===l?4:lt(),i=t.targetChange.targetIds||[],o=function(l,u){return l.useProto3Json?(pt(void 0===u||"string"==typeof u),Pi.fromBase64String(u||"")):(pt(void 0===u||u instanceof Uint8Array),Pi.fromUint8Array(u||new Uint8Array))}(r,t.targetChange.resumeToken),s=t.targetChange.cause,a=s&&function(l){const u=void 0===l.code?ue.UNKNOWN:hZ(l.code);return new Oe(u,l.message||"")}(s);e=new CZ(n,i,o,a||null)}else if("documentChange"in t){const n=t.documentChange,i=Lc(r,n.document.name),o=$r(n.document.updateTime),s=n.document.createTime?$r(n.document.createTime):vt.min(),a=new c2({mapValue:{fields:n.document.fields}}),c=K1.newFoundDocument(i,o,s,a);e=new o_(n.targetIds||[],n.removedTargetIds||[],c.key,c)}else if("documentDelete"in t){const n=t.documentDelete,i=Lc(r,n.document),o=n.readTime?$r(n.readTime):vt.min(),s=K1.newNoDocument(i,o);e=new o_([],n.removedTargetIds||[],s.key,s)}else if("documentRemove"in t){const n=t.documentRemove,i=Lc(r,n.document);e=new o_([],n.removedTargetIds||[],i,null)}else{if(!("filter"in t))return lt();{const n=t.filter,{count:i=0,unchangedNames:o}=n,s=new aPe(i,o);e=new _Z(n.targetId,s)}}var l;return e}(this.serializer,t),n=function(o){if(!("targetChange"in o))return vt.min();const s=o.targetChange;return s.targetIds&&s.targetIds.length?vt.min():s.readTime?$r(s.readTime):vt.min()}(t);return this.listener.u_(e,n)}c_(t){const e={};e.database=BT(this.serializer),e.addTarget=function(o,s){let a;const c=s.target;if(a=Qm(c)?{documents:AZ(o,c)}:{query:WT(o,c).ut},a.targetId=s.targetId,s.resumeToken.approximateByteSize()>0){a.resumeToken=EZ(o,s.resumeToken);const l=FT(o,s.expectedCount);null!==l&&(a.expectedCount=l)}else if(s.snapshotVersion.compareTo(vt.min())>0){a.readTime=M5(o,s.snapshotVersion.toTimestamp());const l=FT(o,s.expectedCount);null!==l&&(a.expectedCount=l)}return a}(this.serializer,t);const n=function CPe(r,t){const e=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return lt()}}(t.purpose);return null==e?null:{"goog-listen-tags":e}}(0,t);n&&(e.labels=n),this.t_(e)}l_(t){const e={};e.database=BT(this.serializer),e.removeTarget=t,this.t_(e)}}class oSe extends PY{constructor(t,e,n,i,o,s){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",e,n,i,s),this.serializer=o,this.h_=!1}get P_(){return this.h_}start(){this.h_=!1,this.lastStreamToken=void 0,super.start()}i_(){this.h_&&this.I_([])}a_(t,e){return this.connection.Fo("Write",t,e)}onMessage(t){if(pt(!!t.streamToken),this.lastStreamToken=t.streamToken,this.h_){this.jo.reset();const e=function _Pe(r,t){return r&&r.length>0?(pt(void 0!==t),r.map(e=>function(i,o){let s=$r(i.updateTime?i.updateTime:o);return s.isEqual(vt.min())&&(s=$r(o)),new rPe(s,i.transformResults||[])}(e,t))):[]}(t.writeResults,t.commitTime),n=$r(t.commitTime);return this.listener.T_(n,e)}return pt(!t.writeResults||0===t.writeResults.length),this.h_=!0,this.listener.E_()}d_(){const t={};t.database=BT(this.serializer),this.t_(t)}I_(t){const e={streamToken:this.lastStreamToken,writes:t.map(n=>function E9(r,t){let e;if(t instanceof v5)e={update:wZ(r,t.key,t.value)};else if(t instanceof y5)e={delete:M9(r,t.key)};else if(t instanceof H3)e={update:wZ(r,t.key,t.data),updateMask:EPe(t.fieldMask)};else{if(!(t instanceof LT))return lt();e={verify:M9(r,t.key)}}return t.fieldTransforms.length>0&&(e.updateTransforms=t.fieldTransforms.map(n=>function(o,s){const a=s.transform;if(a instanceof _5)return{fieldPath:s.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof x6)return{fieldPath:s.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof L6)return{fieldPath:s.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof C5)return{fieldPath:s.field.canonicalString(),increment:a.Ie};throw lt()}(0,n))),t.precondition.isNone||(e.currentDocument=void 0!==(o=t.precondition).updateTime?{updateTime:gPe(r,o.updateTime)}:void 0!==o.exists?{exists:o.exists}:lt()),e;var o}(this.serializer,n))};this.t_(e)}}class sSe extends class{}{constructor(t,e,n,i){super(),this.authCredentials=t,this.appCheckCredentials=e,this.connection=n,this.serializer=i,this.A_=!1}R_(){if(this.A_)throw new Oe(ue.FAILED_PRECONDITION,"The client has already been terminated.")}So(t,e,n,i){return this.R_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,s])=>this.connection.So(t,GT(e,n),i,o,s)).catch(o=>{throw"FirebaseError"===o.name?(o.code===ue.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Oe(ue.UNKNOWN,o.toString())})}vo(t,e,n,i,o){return this.R_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.vo(t,GT(e,n),i,s,a,o)).catch(s=>{throw"FirebaseError"===s.name?(s.code===ue.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Oe(ue.UNKNOWN,s.toString())})}terminate(){this.A_=!0,this.connection.terminate()}}class cSe{constructor(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.m_=0,this.f_=null,this.g_=!0}p_(){0===this.m_&&(this.y_("Unknown"),this.f_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.f_=null,this.w_("Backend didn't respond within 10 seconds."),this.y_("Offline"),Promise.resolve())))}S_(t){"Online"===this.state?this.y_("Unknown"):(this.m_++,this.m_>=1&&(this.b_(),this.w_(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.y_("Offline")))}set(t){this.b_(),this.m_=0,"Online"===t&&(this.g_=!1),this.y_(t)}y_(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}w_(t){const e=`Could not reach Cloud Firestore backend. ${t}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.g_?(Br(e),this.g_=!1):Se("OnlineStateTracker",e)}b_(){null!==this.f_&&(this.f_.cancel(),this.f_=null)}}class lSe{constructor(t,e,n,i,o){var s=this;this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.D_=[],this.C_=new Map,this.v_=new Set,this.F_=[],this.M_=o,this.M_.io(a=>{n.enqueueAndForget(M(function*(){var c;ul(s)&&(Se("RemoteStore","Restarting streams for network reachability change."),yield(c=M(function*(u){const f=qe(u);f.v_.add(4),yield A5(f),f.x_.set("Unknown"),f.v_.delete(4),yield I9(f)}),function l(u){return c.apply(this,arguments)})(s))}))}),this.x_=new cSe(n,i)}}function I9(r){return mw.apply(this,arguments)}function mw(){return mw=M(function*(r){if(ul(r))for(const t of r.F_)yield t(!0)}),mw.apply(this,arguments)}function A5(r){return _w.apply(this,arguments)}function _w(){return _w=M(function*(r){for(const t of r.F_)yield t(!1)}),_w.apply(this,arguments)}function M_(r,t){const e=qe(r);e.C_.has(t.targetId)||(e.C_.set(t.targetId,t),yw(e)?vw(e):I5(e).Jo()&&Cw(e,t))}function k9(r,t){const e=qe(r),n=I5(e);e.C_.delete(t),n.Jo()&&SY(e,t),0===e.C_.size&&(n.Jo()?n.Xo():ul(e)&&e.x_.set("Unknown"))}function Cw(r,t){if(r.O_.Oe(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(vt.min())>0){const e=r.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(e)}I5(r).c_(t)}function SY(r,t){r.O_.Oe(t),I5(r).l_(t)}function vw(r){r.O_=new lPe({getRemoteKeysForTarget:t=>r.remoteSyncer.getRemoteKeysForTarget(t),_t:t=>r.C_.get(t)||null,nt:()=>r.datastore.serializer.databaseId}),I5(r).start(),r.x_.p_()}function yw(r){return ul(r)&&!I5(r).Ho()&&r.C_.size>0}function ul(r){return 0===qe(r).v_.size}function OY(r){r.O_=void 0}function uSe(r){return Mw.apply(this,arguments)}function Mw(){return Mw=M(function*(r){r.C_.forEach((t,e)=>{Cw(r,t)})}),Mw.apply(this,arguments)}function fSe(r,t){return Ew.apply(this,arguments)}function Ew(){return Ew=M(function*(r,t){OY(r),yw(r)?(r.x_.S_(t),vw(r)):r.x_.set("Unknown")}),Ew.apply(this,arguments)}function dSe(r,t,e){return Pw.apply(this,arguments)}function Pw(){return Pw=M(function*(r,t,e){if(r.x_.set("Online"),t instanceof CZ&&2===t.state&&t.cause)try{yield(n=M(function*(o,s){const a=s.cause;for(const c of s.targetIds)o.C_.has(c)&&(yield o.remoteSyncer.rejectListen(c,a),o.C_.delete(c),o.O_.removeTarget(c))}),function i(o,s){return n.apply(this,arguments)})(r,t)}catch(n){Se("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),n),yield E_(r,n)}else if(t instanceof o_?r.O_.$e(t):t instanceof _Z?r.O_.Je(t):r.O_.Ge(t),!e.isEqual(vt.min()))try{const n=yield hY(r.localStore);e.compareTo(n)>=0&&(yield function(o,s){const a=o.O_.it(s);return a.targetChanges.forEach((c,l)=>{if(c.resumeToken.approximateByteSize()>0){const u=o.C_.get(l);u&&o.C_.set(l,u.withResumeToken(c.resumeToken,s))}}),a.targetMismatches.forEach((c,l)=>{const u=o.C_.get(c);if(!u)return;o.C_.set(c,u.withResumeToken(Pi.EMPTY_BYTE_STRING,u.snapshotVersion)),SY(o,c);const f=new F3(u.target,c,l,u.sequenceNumber);Cw(o,f)}),o.remoteSyncer.applyRemoteEvent(a)}(r,e))}catch(n){Se("RemoteStore","Failed to raise snapshot:",n),yield E_(r,n)}var n}),Pw.apply(this,arguments)}function E_(r,t,e){return Sw.apply(this,arguments)}function Sw(){return Sw=M(function*(r,t,e){if(!J4(t))throw t;r.v_.add(1),yield A5(r),r.x_.set("Offline"),e||(e=()=>hY(r.localStore)),r.asyncQueue.enqueueRetryable(M(function*(){Se("RemoteStore","Retrying IndexedDB access"),yield e(),r.v_.delete(1),yield I9(r)}))}),Sw.apply(this,arguments)}function TY(r,t){return t().catch(e=>E_(r,e,t))}function N5(r){return Ow.apply(this,arguments)}function Ow(){return Ow=M(function*(r){const t=qe(r),e=fl(t);let n=t.D_.length>0?t.D_[t.D_.length-1].batchId:-1;for(;hSe(t);)try{const i=yield XPe(t.localStore,n);if(null===i){0===t.D_.length&&e.Xo();break}n=i.batchId,gSe(t,i)}catch(i){yield E_(t,i)}wY(t)&&bY(t)}),Ow.apply(this,arguments)}function hSe(r){return ul(r)&&r.D_.length<10}function gSe(r,t){r.D_.push(t);const e=fl(r);e.Jo()&&e.P_&&e.I_(t.mutations)}function wY(r){return ul(r)&&!fl(r).Ho()&&r.D_.length>0}function bY(r){fl(r).start()}function pSe(r){return Tw.apply(this,arguments)}function Tw(){return Tw=M(function*(r){fl(r).d_()}),Tw.apply(this,arguments)}function mSe(r){return ww.apply(this,arguments)}function ww(){return ww=M(function*(r){const t=fl(r);for(const e of r.D_)t.I_(e.mutations)}),ww.apply(this,arguments)}function _Se(r,t,e){return bw.apply(this,arguments)}function bw(){return bw=M(function*(r,t,e){const n=r.D_.shift(),i=DT.from(n,t,e);yield TY(r,()=>r.remoteSyncer.applySuccessfulWrite(i)),yield N5(r)}),bw.apply(this,arguments)}function CSe(r,t){return Aw.apply(this,arguments)}function Aw(){return Aw=M(function*(r,t){var e;t&&fl(r).P_&&(yield(e=M(function*(i,o){if(function dZ(r){switch(r){default:return lt();case ue.CANCELLED:case ue.UNKNOWN:case ue.DEADLINE_EXCEEDED:case ue.RESOURCE_EXHAUSTED:case ue.INTERNAL:case ue.UNAVAILABLE:case ue.UNAUTHENTICATED:return!1;case ue.INVALID_ARGUMENT:case ue.NOT_FOUND:case ue.ALREADY_EXISTS:case ue.PERMISSION_DENIED:case ue.FAILED_PRECONDITION:case ue.ABORTED:case ue.OUT_OF_RANGE:case ue.UNIMPLEMENTED:case ue.DATA_LOSS:return!0}}(a=o.code)&&a!==ue.ABORTED){const s=i.D_.shift();fl(i).Zo(),yield TY(i,()=>i.remoteSyncer.rejectFailedWrite(s.batchId,o)),yield N5(i)}var a}),function n(i,o){return e.apply(this,arguments)})(r,t)),wY(r)&&bY(r)}),Aw.apply(this,arguments)}function AY(r,t){return Nw.apply(this,arguments)}function Nw(){return Nw=M(function*(r,t){const e=qe(r);e.asyncQueue.verifyOperationInProgress(),Se("RemoteStore","RemoteStore received new credentials");const n=ul(e);e.v_.add(3),yield A5(e),n&&e.x_.set("Unknown"),yield e.remoteSyncer.handleCredentialChange(t),e.v_.delete(3),yield I9(e)}),Nw.apply(this,arguments)}function kw(){return kw=M(function*(r,t){const e=qe(r);t?(e.v_.delete(2),yield I9(e)):t||(e.v_.add(2),yield A5(e),e.x_.set("Unknown"))}),kw.apply(this,arguments)}function I5(r){return r.N_||(r.N_=function(e,n,i){const o=qe(e);return o.R_(),new iSe(n,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(r.datastore,r.asyncQueue,{Po:uSe.bind(null,r),To:fSe.bind(null,r),u_:dSe.bind(null,r)}),r.F_.push(function(){var t=M(function*(e){e?(r.N_.Zo(),yw(r)?vw(r):r.x_.set("Unknown")):(yield r.N_.stop(),OY(r))});return function(e){return t.apply(this,arguments)}}())),r.N_}function fl(r){return r.B_||(r.B_=function(e,n,i){const o=qe(e);return o.R_(),new oSe(n,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(r.datastore,r.asyncQueue,{Po:pSe.bind(null,r),To:CSe.bind(null,r),E_:mSe.bind(null,r),T_:_Se.bind(null,r)}),r.F_.push(function(){var t=M(function*(e){e?(r.B_.Zo(),yield N5(r)):(yield r.B_.stop(),r.D_.length>0&&(Se("RemoteStore",`Stopping write stream with ${r.D_.length} pending writes`),r.D_=[]))});return function(e){return t.apply(this,arguments)}}())),r.B_}class Rw{constructor(t,e,n,i,o){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=i,this.removalCallback=o,this.deferred=new Ei,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(s=>{})}get promise(){return this.deferred.promise}static createAndSchedule(t,e,n,i,o){const s=Date.now()+n,a=new Rw(t,e,s,i,o);return a.start(n),a}start(t){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Oe(ue.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(t=>this.deferred.resolve(t))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function k5(r,t){if(Br("AsyncQueue",`${t}: ${r}`),J4(r))return new Oe(ue.UNAVAILABLE,`${t}: ${r}`);throw r}class R5{constructor(t){this.comparator=t?(e,n)=>t(e,n)||Ze.comparator(e.key,n.key):(e,n)=>Ze.comparator(e.key,n.key),this.keyedMap=g9(),this.sortedSet=new F1(this.comparator)}static emptySet(t){return new R5(t.comparator)}has(t){return null!=this.keyedMap.get(t)}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal((e,n)=>(t(e),!1))}add(t){const e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))}delete(t){const e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this}isEqual(t){if(!(t instanceof R5)||this.size!==t.size)return!1;const e=this.sortedSet.getIterator(),n=t.sortedSet.getIterator();for(;e.hasNext();){const i=e.getNext().key,o=n.getNext().key;if(!i.isEqual(o))return!1}return!0}toString(){const t=[];return this.forEach(e=>{t.push(e.toString())}),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"}copy(t,e){const n=new R5;return n.comparator=this.comparator,n.keyedMap=t,n.sortedSet=e,n}}class NY{constructor(){this.L_=new F1(Ze.comparator)}track(t){const e=t.doc.key,n=this.L_.get(e);n?0!==t.type&&3===n.type?this.L_=this.L_.insert(e,t):3===t.type&&1!==n.type?this.L_=this.L_.insert(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.L_=this.L_.insert(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.L_=this.L_.insert(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.L_=this.L_.remove(e):1===t.type&&2===n.type?this.L_=this.L_.insert(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.L_=this.L_.insert(e,{type:2,doc:t.doc}):lt():this.L_=this.L_.insert(e,t)}k_(){const t=[];return this.L_.inorderTraversal((e,n)=>{t.push(n)}),t}}class x5{constructor(t,e,n,i,o,s,a,c,l){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=o,this.fromCache=s,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=l}static fromInitialDocuments(t,e,n,i,o){const s=[];return e.forEach(a=>{s.push({type:0,doc:a})}),new x5(t,e,R5.emptySet(e),s,n,i,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&d9(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(let i=0;i<e.length;i++)if(e[i].type!==n[i].type||!e[i].doc.isEqual(n[i].doc))return!1;return!0}}class vSe{constructor(){this.q_=void 0,this.Q_=[]}}class ySe{constructor(){this.queries=new V3(t=>jj(t),d9),this.onlineState="Unknown",this.K_=new Set}}function xw(r,t){return Lw.apply(this,arguments)}function Lw(){return Lw=M(function*(r,t){const e=qe(r),n=t.query;let i=!1,o=e.queries.get(n);if(o||(i=!0,o=new vSe),i)try{o.q_=yield e.onListen(n)}catch(s){const a=k5(s,`Initialization of query '${m5(t.query)}' failed`);return void t.onError(a)}e.queries.set(n,o),o.Q_.push(t),t.U_(e.onlineState),o.q_&&t.W_(o.q_)&&Vw(e)}),Lw.apply(this,arguments)}function zw(r,t){return Dw.apply(this,arguments)}function Dw(){return Dw=M(function*(r,t){const e=qe(r),n=t.query;let i=!1;const o=e.queries.get(n);if(o){const s=o.Q_.indexOf(t);s>=0&&(o.Q_.splice(s,1),i=0===o.Q_.length)}if(i)return e.queries.delete(n),e.onUnlisten(n)}),Dw.apply(this,arguments)}function MSe(r,t){const e=qe(r);let n=!1;for(const i of t){const s=e.queries.get(i.query);if(s){for(const a of s.Q_)a.W_(i)&&(n=!0);s.q_=i}}n&&Vw(e)}function ESe(r,t,e){const n=qe(r),i=n.queries.get(t);if(i)for(const o of i.Q_)o.onError(e);n.queries.delete(t)}function Vw(r){r.K_.forEach(t=>{t.next()})}class Hw{constructor(t,e,n){this.query=t,this.G_=e,this.z_=!1,this.j_=null,this.onlineState="Unknown",this.options=n||{}}W_(t){if(!this.options.includeMetadataChanges){const n=[];for(const i of t.docChanges)3!==i.type&&n.push(i);t=new x5(t.query,t.docs,t.oldDocs,n,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let e=!1;return this.z_?this.H_(t)&&(this.G_.next(t),e=!0):this.J_(t,this.onlineState)&&(this.Y_(t),e=!0),this.j_=t,e}onError(t){this.G_.error(t)}U_(t){this.onlineState=t;let e=!1;return this.j_&&!this.z_&&this.J_(this.j_,t)&&(this.Y_(this.j_),e=!0),e}J_(t,e){return!t.fromCache||(!this.options.Z_||!("Offline"!==e))&&(!t.docs.isEmpty()||t.hasCachedResults||"Offline"===e)}H_(t){return t.docChanges.length>0||!!(t.syncStateChanged||this.j_&&this.j_.hasPendingWrites!==t.hasPendingWrites)&&!0===this.options.includeMetadataChanges}Y_(t){t=x5.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.z_=!0,this.G_.next(t)}}class RY{constructor(t){this.key=t}}class xY{constructor(t){this.key=t}}class LY{constructor(t,e){this.query=t,this.oa=e,this._a=null,this.hasCachedResults=!1,this.current=!1,this.aa=ln(),this.mutatedKeys=ln(),this.ua=Yj(t),this.ca=new R5(this.ua)}get la(){return this.oa}ha(t,e){const n=e?e.Pa:new NY,i=e?e.ca:this.ca;let o=e?e.mutatedKeys:this.mutatedKeys,s=i,a=!1;const c="F"===this.query.limitType&&i.size===this.query.limit?i.last():null,l="L"===this.query.limitType&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal((u,f)=>{const g=i.get(u),y=h9(this.query,f)?f:null,S=!!g&&this.mutatedKeys.has(g.key),N=!!y&&(y.hasLocalMutations||this.mutatedKeys.has(y.key)&&y.hasCommittedMutations);let R=!1;g&&y?g.data.isEqual(y.data)?S!==N&&(n.track({type:3,doc:y}),R=!0):this.Ia(g,y)||(n.track({type:2,doc:y}),R=!0,(c&&this.ua(y,c)>0||l&&this.ua(y,l)<0)&&(a=!0)):!g&&y?(n.track({type:0,doc:y}),R=!0):g&&!y&&(n.track({type:1,doc:g}),R=!0,(c||l)&&(a=!0)),R&&(y?(s=s.add(y),o=N?o.add(u):o.delete(u)):(s=s.delete(u),o=o.delete(u)))}),null!==this.query.limit)for(;s.size>this.query.limit;){const u="F"===this.query.limitType?s.last():s.first();s=s.delete(u.key),o=o.delete(u.key),n.track({type:1,doc:u})}return{ca:s,Pa:n,Xi:a,mutatedKeys:o}}Ia(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations}applyChanges(t,e,n,i){const o=this.ca;this.ca=t.ca,this.mutatedKeys=t.mutatedKeys;const s=t.Pa.k_();s.sort((u,f)=>function(y,S){const N=R=>{switch(R){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return lt()}};return N(y)-N(S)}(u.type,f.type)||this.ua(u.doc,f.doc)),this.Ta(n),i=null!=i&&i;const a=e&&!i?this.Ea():[],c=0===this.aa.size&&this.current&&!i?1:0,l=c!==this._a;return this._a=c,0!==s.length||l?{snapshot:new x5(this.query,t.ca,o,s,t.mutatedKeys,0===c,l,!1,!!n&&n.resumeToken.approximateByteSize()>0),da:a}:{da:a}}U_(t){return this.current&&"Offline"===t?(this.current=!1,this.applyChanges({ca:this.ca,Pa:new NY,mutatedKeys:this.mutatedKeys,Xi:!1},!1)):{da:[]}}Aa(t){return!this.oa.has(t)&&!!this.ca.has(t)&&!this.ca.get(t).hasLocalMutations}Ta(t){t&&(t.addedDocuments.forEach(e=>this.oa=this.oa.add(e)),t.modifiedDocuments.forEach(e=>{}),t.removedDocuments.forEach(e=>this.oa=this.oa.delete(e)),this.current=t.current)}Ea(){if(!this.current)return[];const t=this.aa;this.aa=ln(),this.ca.forEach(n=>{this.Aa(n.key)&&(this.aa=this.aa.add(n.key))});const e=[];return t.forEach(n=>{this.aa.has(n)||e.push(new xY(n))}),this.aa.forEach(n=>{t.has(n)||e.push(new RY(n))}),e}Ra(t){this.oa=t.hs,this.aa=ln();const e=this.ha(t.documents);return this.applyChanges(e,!0)}Va(){return x5.fromInitialDocuments(this.query,this.ca,this.mutatedKeys,0===this._a,this.hasCachedResults)}}class OSe{constructor(t,e,n){this.query=t,this.targetId=e,this.view=n}}class TSe{constructor(t){this.key=t,this.ma=!1}}class wSe{constructor(t,e,n,i,o,s){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=i,this.currentUser=o,this.maxConcurrentLimboResolutions=s,this.fa={},this.ga=new V3(a=>jj(a),d9),this.pa=new Map,this.ya=new Set,this.wa=new F1(Ze.comparator),this.Sa=new Map,this.ba=new JT,this.Da={},this.Ca=new Map,this.va=U6.Bn(),this.onlineState="Unknown",this.Fa=void 0}get isPrimaryClient(){return!0===this.Fa}}function bSe(r,t){return Fw.apply(this,arguments)}function Fw(){return Fw=M(function*(r,t){const e=function lb(r){const t=qe(r);return t.remoteStore.remoteSyncer.applyRemoteEvent=zY.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=DSe.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=ISe.bind(null,t),t.fa.u_=MSe.bind(null,t.eventManager),t.fa.xa=ESe.bind(null,t.eventManager),t}(r);let n,i;const o=e.ga.get(t);if(o)n=o.targetId,e.sharedClientState.addLocalQueryTarget(n),i=o.view.Va();else{const s=yield function w5(r,t){const e=qe(r);return e.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return e.Qr.getTargetData(n,t).next(o=>o?(i=o,oe.resolve(i)):e.Qr.allocateTargetId(n).next(s=>(i=new F3(t,s,"TargetPurposeListen",n.currentSequenceNumber),e.Qr.addTargetData(n,i).next(()=>i))))}).then(n=>{const i=e.ns.get(n.targetId);return(null===i||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(e.ns=e.ns.insert(n.targetId,n),e.rs.set(t,n.targetId)),n})}(e.localStore,lo(t)),a=e.sharedClientState.addLocalQueryTarget(s.targetId);n=s.targetId,i=yield function Uw(r,t,e,n,i){return Gw.apply(this,arguments)}(e,t,n,"current"===a,s.resumeToken),e.isPrimaryClient&&M_(e.remoteStore,s)}return i}),Fw.apply(this,arguments)}function Gw(){return Gw=M(function*(r,t,e,n,i){r.Ma=(f,g,y)=>{return(S=M(function*(R,U,$,re){let _e=U.view.ha($);_e.Xi&&(_e=yield m_(R.localStore,U.query,!1).then(({documents:Xt})=>U.view.ha(Xt,_e)));const be=re&&re.targetChanges.get(U.targetId),Ve=re&&null!=re.targetMismatches.get(U.targetId),dt=U.view.applyChanges(_e,R.isPrimaryClient,be,Ve);return Qw(R,U.targetId,dt.da),dt.snapshot}),function N(R,U,$,re){return S.apply(this,arguments)})(r,f,g,y);var S};const o=yield m_(r.localStore,t,!0),s=new LY(t,o.hs),a=s.ha(o.documents),c=y9.createSynthesizedTargetChangeForCurrentChange(e,n&&"Offline"!==r.onlineState,i),l=s.applyChanges(a,r.isPrimaryClient,c);Qw(r,e,l.da);const u=new OSe(t,e,s);return r.ga.set(t,u),r.pa.has(e)?r.pa.get(e).push(t):r.pa.set(e,[t]),l.snapshot}),Gw.apply(this,arguments)}function ASe(r,t){return Bw.apply(this,arguments)}function Bw(){return Bw=M(function*(r,t){const e=qe(r),n=e.ga.get(t),i=e.pa.get(n.targetId);if(i.length>1)return e.pa.set(n.targetId,i.filter(o=>!d9(o,t))),void e.ga.delete(t);e.isPrimaryClient?(e.sharedClientState.removeLocalQueryTarget(n.targetId),e.sharedClientState.isActiveQueryTarget(n.targetId)||(yield b5(e.localStore,n.targetId,!1).then(()=>{e.sharedClientState.clearQueryState(n.targetId),k9(e.remoteStore,n.targetId),L5(e,n.targetId)}).catch(Q4))):(L5(e,n.targetId),yield b5(e.localStore,n.targetId,!0))}),Bw.apply(this,arguments)}function $w(){return $w=M(function*(r,t,e){const n=function ub(r){const t=qe(r);return t.remoteStore.remoteSyncer.applySuccessfulWrite=kSe.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=RSe.bind(null,t),t}(r);try{const i=yield function(s,a){const c=qe(s),l=vr.now(),u=a.reduce((y,S)=>y.add(S.key),ln());let f,g;return c.persistence.runTransaction("Locally write mutations","readwrite",y=>{let S=xo(),N=ln();return c.os.getEntries(y,u).next(R=>{S=R,S.forEach((U,$)=>{$.isValidDocument()||(N=N.add(U))})}).next(()=>c.localDocuments.getOverlayedDocuments(y,S)).next(R=>{f=R;const U=[];for(const $ of a){const re=oPe($,f.get($.key).overlayedDocument);null!=re&&U.push(new H3($.key,re,kj(re.value.mapValue),hr.exists(!0)))}return c.mutationQueue.addMutationBatch(y,l,U,a)}).next(R=>{g=R;const U=R.applyToLocalDocumentSet(f,N);return c.documentOverlayCache.saveOverlays(y,R.batchId,U)})}).then(()=>({batchId:g.batchId,changes:Xj(f)}))}(n.localStore,t);n.sharedClientState.addPendingMutation(i.batchId),function(s,a,c){let l=s.Da[s.currentUser.toKey()];l||(l=new F1(Kt)),l=l.insert(a,c),s.Da[s.currentUser.toKey()]=l}(n,i.batchId,e),yield U3(n,i.changes),yield N5(n.remoteStore)}catch(i){const o=k5(i,"Failed to persist write");e.reject(o)}}),$w.apply(this,arguments)}function zY(r,t){return Ww.apply(this,arguments)}function Ww(){return Ww=M(function*(r,t){const e=qe(r);try{const n=yield function KPe(r,t){const e=qe(r),n=t.snapshotVersion;let i=e.ns;return e.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{const s=e.os.newChangeBuffer({trackRemovals:!0});i=e.ns;const a=[];t.targetChanges.forEach((u,f)=>{const g=i.get(f);if(!g)return;a.push(e.Qr.removeMatchingKeys(o,u.removedDocuments,f).next(()=>e.Qr.addMatchingKeys(o,u.addedDocuments,f)));let y=g.withSequenceNumber(o.currentSequenceNumber);var N,R,U;null!==t.targetMismatches.get(f)?y=y.withResumeToken(Pi.EMPTY_BYTE_STRING,vt.min()).withLastLimboFreeSnapshotVersion(vt.min()):u.resumeToken.approximateByteSize()>0&&(y=y.withResumeToken(u.resumeToken,n)),i=i.insert(f,y),R=y,U=u,(0===(N=g).resumeToken.approximateByteSize()||R.snapshotVersion.toMicroseconds()-N.snapshotVersion.toMicroseconds()>=3e8||U.addedDocuments.size+U.modifiedDocuments.size+U.removedDocuments.size>0)&&a.push(e.Qr.updateTargetData(o,y))});let c=xo(),l=ln();if(t.documentUpdates.forEach(u=>{t.resolvedLimboDocuments.has(u)&&a.push(e.persistence.referenceDelegate.updateLimboDocument(o,u))}),a.push(function gY(r,t,e){let n=ln(),i=ln();return e.forEach(o=>n=n.add(o)),t.getEntries(r,n).next(o=>{let s=xo();return e.forEach((a,c)=>{const l=o.get(a);c.isFoundDocument()!==l.isFoundDocument()&&(i=i.add(a)),c.isNoDocument()&&c.version.isEqual(vt.min())?(t.removeEntry(a,c.readTime),s=s.insert(a,c)):!l.isValidDocument()||c.version.compareTo(l.version)>0||0===c.version.compareTo(l.version)&&l.hasPendingWrites?(t.addEntry(c),s=s.insert(a,c)):Se("LocalStore","Ignoring outdated watch update for ",a,". Current version:",l.version," Watch version:",c.version)}),{cs:s,ls:i}})}(o,s,t.documentUpdates).next(u=>{c=u.cs,l=u.ls})),!n.isEqual(vt.min())){const u=e.Qr.getLastRemoteSnapshotVersion(o).next(f=>e.Qr.setTargetsMetadata(o,o.currentSequenceNumber,n));a.push(u)}return oe.waitFor(a).next(()=>s.apply(o)).next(()=>e.localDocuments.getLocalViewOfDocuments(o,c,l)).next(()=>c)}).then(o=>(e.ns=i,o))}(e.localStore,t);t.targetChanges.forEach((i,o)=>{const s=e.Sa.get(o);s&&(pt(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?s.ma=!0:i.modifiedDocuments.size>0?pt(s.ma):i.removedDocuments.size>0&&(pt(s.ma),s.ma=!1))}),yield U3(e,n,t)}catch(n){yield Q4(n)}}),Ww.apply(this,arguments)}function DY(r,t,e){const n=qe(r);if(n.isPrimaryClient&&0===e||!n.isPrimaryClient&&1===e){const i=[];n.ga.forEach((o,s)=>{const a=s.view.U_(t);a.snapshot&&i.push(a.snapshot)}),function(s,a){const c=qe(s);c.onlineState=a;let l=!1;c.queries.forEach((u,f)=>{for(const g of f.Q_)g.U_(a)&&(l=!0)}),l&&Vw(c)}(n.eventManager,t),i.length&&n.fa.u_(i),n.onlineState=t,n.isPrimaryClient&&n.sharedClientState.setOnlineState(t)}}function ISe(r,t,e){return qw.apply(this,arguments)}function qw(){return qw=M(function*(r,t,e){const n=qe(r);n.sharedClientState.updateQueryState(t,"rejected",e);const i=n.Sa.get(t),o=i&&i.key;if(o){let s=new F1(Ze.comparator);s=s.insert(o,K1.newNoDocument(o,vt.min()));const a=ln().add(o),c=new v9(vt.min(),new Map,new F1(Kt),s,a);yield zY(n,c),n.wa=n.wa.remove(o),n.Sa.delete(t),Jw(n)}else yield b5(n.localStore,t,!1).then(()=>L5(n,t,e)).catch(Q4)}),qw.apply(this,arguments)}function kSe(r,t){return jw.apply(this,arguments)}function jw(){return jw=M(function*(r,t){const e=qe(r),n=t.batch.batchId;try{const i=yield function YPe(r,t){const e=qe(r);return e.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const i=t.batch.keys(),o=e.os.newChangeBuffer({trackRemovals:!0});return function(a,c,l,u){const f=l.batch,g=f.keys();let y=oe.resolve();return g.forEach(S=>{y=y.next(()=>u.getEntry(c,S)).next(N=>{const R=l.docVersions.get(S);pt(null!==R),N.version.compareTo(R)<0&&(f.applyToRemoteDocument(N,l),N.isValidDocument()&&(N.setReadTime(l.commitVersion),u.addEntry(N)))})}),y.next(()=>a.mutationQueue.removeMutationBatch(c,f))}(e,n,t,o).next(()=>o.apply(n)).next(()=>e.mutationQueue.performConsistencyCheck(n)).next(()=>e.documentOverlayCache.removeOverlaysForBatchId(n,i,t.batch.batchId)).next(()=>e.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(a){let c=ln();for(let l=0;l<a.mutationResults.length;++l)a.mutationResults[l].transformResults.length>0&&(c=c.add(a.batch.mutations[l].key));return c}(t))).next(()=>e.localDocuments.getDocuments(n,i))})}(e.localStore,t);Xw(e,n,null),Kw(e,n),e.sharedClientState.updateMutationState(n,"acknowledged"),yield U3(e,i)}catch(i){yield Q4(i)}}),jw.apply(this,arguments)}function RSe(r,t,e){return Zw.apply(this,arguments)}function Zw(){return Zw=M(function*(r,t,e){const n=qe(r);try{const i=yield function(s,a){const c=qe(s);return c.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let u;return c.mutationQueue.lookupMutationBatch(l,a).next(f=>(pt(null!==f),u=f.keys(),c.mutationQueue.removeMutationBatch(l,f))).next(()=>c.mutationQueue.performConsistencyCheck(l)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(l,u,a)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,u)).next(()=>c.localDocuments.getDocuments(l,u))})}(n.localStore,t);Xw(n,t,e),Kw(n,t),n.sharedClientState.updateMutationState(t,"rejected",e),yield U3(n,i)}catch(i){yield Q4(i)}}),Zw.apply(this,arguments)}function Kw(r,t){(r.Ca.get(t)||[]).forEach(e=>{e.resolve()}),r.Ca.delete(t)}function Xw(r,t,e){const n=qe(r);let i=n.Da[n.currentUser.toKey()];if(i){const o=i.get(t);o&&(e?o.reject(e):o.resolve(),i=i.remove(t)),n.Da[n.currentUser.toKey()]=i}}function L5(r,t,e=null){r.sharedClientState.removeLocalQueryTarget(t);for(const n of r.pa.get(t))r.ga.delete(n),e&&r.fa.xa(n,e);r.pa.delete(t),r.isPrimaryClient&&r.ba.Vr(t).forEach(n=>{r.ba.containsKey(n)||VY(r,n)})}function VY(r,t){r.ya.delete(t.path.canonicalString());const e=r.wa.get(t);null!==e&&(k9(r.remoteStore,e),r.wa=r.wa.remove(t),r.Sa.delete(e),Jw(r))}function Qw(r,t,e){for(const n of e)n instanceof RY?(r.ba.addReference(n.key,t),LSe(r,n)):n instanceof xY?(Se("SyncEngine","Document no longer in limbo: "+n.key),r.ba.removeReference(n.key,t),r.ba.containsKey(n.key)||VY(r,n.key)):lt()}function LSe(r,t){const e=t.key,n=e.path.canonicalString();r.wa.get(e)||r.ya.has(n)||(Se("SyncEngine","New document in limbo: "+e),r.ya.add(n),Jw(r))}function Jw(r){for(;r.ya.size>0&&r.wa.size<r.maxConcurrentLimboResolutions;){const t=r.ya.values().next().value;r.ya.delete(t);const e=new Ze(Rn.fromString(t)),n=r.va.next();r.Sa.set(n,new TSe(e)),r.wa=r.wa.insert(e,n),M_(r.remoteStore,new F3(lo(g5(e.path)),n,"TargetPurposeLimboResolution",hs._e))}}function U3(r,t,e){return eb.apply(this,arguments)}function eb(){return eb=M(function*(r,t,e){const n=qe(r),i=[],o=[],s=[];var a;n.ga.isEmpty()||(n.ga.forEach((a,c)=>{s.push(n.Ma(c,t,e).then(l=>{if((l||e)&&n.isPrimaryClient&&n.sharedClientState.updateQueryState(c.targetId,l?.fromCache?"not-current":"current"),l){i.push(l);const u=iw.Ki(c.targetId,l);o.push(u)}}))}),yield Promise.all(s),n.fa.u_(i),yield(a=M(function*(l,u){const f=qe(l);try{yield f.persistence.runTransaction("notifyLocalViewChanges","readwrite",g=>oe.forEach(u,y=>oe.forEach(y.qi,S=>f.persistence.referenceDelegate.addReference(g,y.targetId,S)).next(()=>oe.forEach(y.Qi,S=>f.persistence.referenceDelegate.removeReference(g,y.targetId,S)))))}catch(g){if(!J4(g))throw g;Se("LocalStore","Failed to update sequence numbers: "+g)}for(const g of u){const y=g.targetId;if(!g.fromCache){const S=f.ns.get(y),R=S.withLastLimboFreeSnapshotVersion(S.snapshotVersion);f.ns=f.ns.insert(y,R)}}}),function c(l,u){return a.apply(this,arguments)})(n.localStore,o))}),eb.apply(this,arguments)}function zSe(r,t){return tb.apply(this,arguments)}function tb(){return tb=M(function*(r,t){const e=qe(r);if(!e.currentUser.isEqual(t)){Se("SyncEngine","User change. New user:",t.toKey());const n=yield dY(e.localStore,t);e.currentUser=t,(o=e).Ca.forEach(a=>{a.forEach(c=>{c.reject(new Oe(ue.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),o.Ca.clear(),e.sharedClientState.handleUserChange(t,n.removedBatchIds,n.addedBatchIds),yield U3(e,n.us)}var o}),tb.apply(this,arguments)}function DSe(r,t){const e=qe(r),n=e.Sa.get(t);if(n&&n.ma)return ln().add(n.key);{let i=ln();const o=e.pa.get(t);if(!o)return i;for(const s of o){const a=e.ga.get(s);i=i.unionWith(a.view.la)}return i}}class z5{constructor(){this.synchronizeTabs=!1}initialize(t){var e=this;return M(function*(){e.serializer=N9(t.databaseInfo.databaseId),e.sharedClientState=e.createSharedClientState(t),e.persistence=e.createPersistence(t),yield e.persistence.start(),e.localStore=e.createLocalStore(t),e.gcScheduler=e.createGarbageCollectionScheduler(t,e.localStore),e.indexBackfillerScheduler=e.createIndexBackfillerScheduler(t,e.localStore)})()}createGarbageCollectionScheduler(t,e){return null}createIndexBackfillerScheduler(t,e){return null}createLocalStore(t){return function fY(r,t,e,n){return new ZPe(r,t,e,n)}(this.persistence,new uY,t.initialUser,this.serializer)}createPersistence(t){return new ew(h_.Hr,this.serializer)}createSharedClientState(t){return new yY}terminate(){var t=this;return M(function*(){var e,n;null===(e=t.gcScheduler)||void 0===e||e.stop(),null===(n=t.indexBackfillerScheduler)||void 0===n||n.stop(),t.sharedClientState.shutdown(),yield t.persistence.shutdown()})()}}class D5{initialize(t,e){var n=this;return M(function*(){n.localStore||(n.localStore=t.localStore,n.sharedClientState=t.sharedClientState,n.datastore=n.createDatastore(e),n.remoteStore=n.createRemoteStore(e),n.eventManager=n.createEventManager(e),n.syncEngine=n.createSyncEngine(e,!t.synchronizeTabs),n.sharedClientState.onlineStateHandler=i=>DY(n.syncEngine,i,1),n.remoteStore.remoteSyncer.handleCredentialChange=zSe.bind(null,n.syncEngine),yield function Iw(r,t){return kw.apply(this,arguments)}(n.remoteStore,n.syncEngine.isPrimaryClient))})()}createEventManager(t){return new ySe}createDatastore(t){const e=N9(t.databaseInfo.databaseId),n=new rSe(t.databaseInfo);return new sSe(t.authCredentials,t.appCheckCredentials,n,e)}createRemoteStore(t){return n=this.localStore,i=this.datastore,o=t.asyncQueue,s=e=>DY(this.syncEngine,e,0),a=MY.D()?new MY:new eSe,new lSe(n,i,o,s,a);var n,i,o,s,a}createSyncEngine(t,e){return function(i,o,s,a,c,l,u){const f=new wSe(i,o,s,a,c,l);return u&&(f.Fa=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)}terminate(){var t=this;return M(function*(){var e,n;yield(n=M(function*(o){const s=qe(o);Se("RemoteStore","RemoteStore shutting down."),s.v_.add(5),yield A5(s),s.M_.shutdown(),s.x_.set("Unknown")}),function i(o){return n.apply(this,arguments)})(t.remoteStore),null===(e=t.datastore)||void 0===e||e.terminate()})()}}class P_{constructor(t){this.observer=t,this.muted=!1}next(t){this.observer.next&&this.Ba(this.observer.next,t)}error(t){this.observer.error?this.Ba(this.observer.error,t):Br("Uncaught Error in snapshot listener:",t.toString())}La(){this.muted=!0}Ba(t,e){this.muted||setTimeout(()=>{this.muted||t(e)},0)}}class KSe{constructor(t,e,n,i){var o=this;this.authCredentials=t,this.appCheckCredentials=e,this.asyncQueue=n,this.databaseInfo=i,this.user=Vi.UNAUTHENTICATED,this.clientId=cj.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,function(){var s=M(function*(a){Se("FirestoreClient","Received user=",a.uid),yield o.authCredentialListener(a),o.user=a});return function(a){return s.apply(this,arguments)}}()),this.appCheckCredentials.start(n,s=>(Se("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Oe(ue.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){var t=this;this.asyncQueue.enterRestrictedMode();const e=new Ei;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(M(function*(){try{t._onlineComponents&&(yield t._onlineComponents.terminate()),t._offlineComponents&&(yield t._offlineComponents.terminate()),t.authCredentials.shutdown(),t.appCheckCredentials.shutdown(),e.resolve()}catch(n){const i=k5(n,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}function S_(r,t){return db.apply(this,arguments)}function db(){return db=M(function*(r,t){r.asyncQueue.verifyOperationInProgress(),Se("FirestoreClient","Initializing OfflineComponentProvider");const e=r.configuration;yield t.initialize(e);let n=e.initialUser;r.setCredentialChangeListener(function(){var i=M(function*(o){n.isEqual(o)||(yield dY(t.localStore,o),n=o)});return function(o){return i.apply(this,arguments)}}()),t.persistence.setDatabaseDeletedListener(()=>r.terminate()),r._offlineComponents=t}),db.apply(this,arguments)}function hb(r,t){return gb.apply(this,arguments)}function gb(){return gb=M(function*(r,t){r.asyncQueue.verifyOperationInProgress();const e=yield function pb(r){return mb.apply(this,arguments)}(r);Se("FirestoreClient","Initializing OnlineComponentProvider"),yield t.initialize(e,r.configuration),r.setCredentialChangeListener(n=>AY(t.remoteStore,n)),r.setAppCheckTokenChangeListener((n,i)=>AY(t.remoteStore,i)),r._onlineComponents=t}),gb.apply(this,arguments)}function mb(){return mb=M(function*(r){if(!r._offlineComponents)if(r._uninitializedComponentsProvider){Se("FirestoreClient","Using user provided OfflineComponentProvider");try{yield S_(r,r._uninitializedComponentsProvider._offline)}catch(t){const e=t;if(!function BY(r){return"FirebaseError"===r.name?r.code===ue.FAILED_PRECONDITION||r.code===ue.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||22===r.code||20===r.code||11===r.code}(e))throw e;fs("Error using user provided cache. Falling back to memory cache: "+e),yield S_(r,new z5)}}else Se("FirestoreClient","Using default OfflineComponentProvider"),yield S_(r,new z5);return r._offlineComponents}),mb.apply(this,arguments)}function O_(r){return _b.apply(this,arguments)}function _b(){return _b=M(function*(r){return r._onlineComponents||(r._uninitializedComponentsProvider?(Se("FirestoreClient","Using user provided OnlineComponentProvider"),yield hb(r,r._uninitializedComponentsProvider._online)):(Se("FirestoreClient","Using default OnlineComponentProvider"),yield hb(r,new D5))),r._onlineComponents}),_b.apply(this,arguments)}function H5(r){return vb.apply(this,arguments)}function vb(){return vb=M(function*(r){const t=yield O_(r),e=t.eventManager;return e.onListen=bSe.bind(null,t.syncEngine),e.onUnlisten=ASe.bind(null,t.syncEngine),e}),vb.apply(this,arguments)}function YY(r){const t={};return void 0!==r.timeoutSeconds&&(t.timeoutSeconds=r.timeoutSeconds),t}const KY=new Map;function yb(r,t,e){if(!e)throw new Oe(ue.INVALID_ARGUMENT,`Function ${r}() cannot be called with an empty ${t}.`)}function XY(r){if(!Ze.isDocumentKey(r))throw new Oe(ue.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${r} has ${r.length}.`)}function QY(r){if(Ze.isDocumentKey(r))throw new Oe(ue.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${r} has ${r.length}.`)}function T_(r){if(void 0===r)return"undefined";if(null===r)return"null";if("string"==typeof r)return r.length>20&&(r=`${r.substring(0,20)}...`),JSON.stringify(r);if("number"==typeof r||"boolean"==typeof r)return""+r;if("object"==typeof r){if(r instanceof Array)return"an array";{const t=(n=r).constructor?n.constructor.name:null;return t?`a custom ${t} object`:"an object"}}var n;return"function"==typeof r?"a function":lt()}function Ln(r,t){if("_delegate"in r&&(r=r._delegate),!(r instanceof t)){if(t.name===r.constructor.name)throw new Oe(ue.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const e=T_(r);throw new Oe(ue.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${e}`)}}return r}class eK{constructor(t){var e,n;if(void 0===t.host){if(void 0!==t.ssl)throw new Oe(ue.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Oe(ue.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}(function aOe(r,t,e,n){if(!0===t&&!0===n)throw new Oe(ue.INVALID_ARGUMENT,`${r} and ${e} cannot be used together.`)})("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!(this.experimentalForceLongPolling||void 0!==t.experimentalAutoDetectLongPolling&&!t.experimentalAutoDetectLongPolling),this.experimentalLongPollingOptions=YY(null!==(n=t.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(o){if(void 0!==o.timeoutSeconds){if(isNaN(o.timeoutSeconds))throw new Oe(ue.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (must not be NaN)`);if(o.timeoutSeconds<5)throw new Oe(ue.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (minimum allowed value is 5)`);if(o.timeoutSeconds>30)throw new Oe(ue.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.experimentalLongPollingOptions.timeoutSeconds===t.experimentalLongPollingOptions.timeoutSeconds&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class R9{constructor(t,e,n,i){this._authCredentials=t,this._appCheckCredentials=e,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new eK({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new Oe(ue.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(t){if(this._settingsFrozen)throw new Oe(ue.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new eK(t),void 0!==t.credentials&&(this._authCredentials=function(n){if(!n)return new oEe;switch(n.type){case"firstParty":return new lEe(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Oe(ue.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const n=KY.get(e);n&&(Se("ComponentProvider","Removing Datastore"),KY.delete(e),n.terminate())}(this),Promise.resolve()}}function tK(r,t,e,n={}){var i;const o=(r=Ln(r,R9))._getSettings(),s=`${t}:${e}`;if("firestore.googleapis.com"!==o.host&&o.host!==s&&fs("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),r._setSettings(Object.assign(Object.assign({},o),{host:s,ssl:!1})),n.mockUserToken){let a,c;if("string"==typeof n.mockUserToken)a=n.mockUserToken,c=Vi.MOCK_USER;else{a=function Nve(r,t){if(r.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",i=r.iat||0,o=r.sub||r.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},r);return[fm(JSON.stringify({alg:"none",type:"JWT"})),fm(JSON.stringify(s)),""].join(".")}(n.mockUserToken,null===(i=r._app)||void 0===i?void 0:i.options.projectId);const l=n.mockUserToken.sub||n.mockUserToken.user_id;if(!l)throw new Oe(ue.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new Vi(l)}r._authCredentials=new sEe(new sj(a,c))}}class l2{constructor(t,e,n){this.converter=e,this._query=n,this.type="query",this.firestore=t}withConverter(t){return new l2(this.firestore,t,this._query)}}class Wr{constructor(t,e,n){this.converter=e,this._key=n,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new zc(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new Wr(this.firestore,t,this._key)}}class zc extends l2{constructor(t,e,n){super(t,e,g5(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new Wr(this.firestore,null,new Ze(t))}withConverter(t){return new zc(this.firestore,t,this._path)}}function F5(r,t,...e){if(r=Cr(r),1===arguments.length&&(t=cj.newId()),yb("doc","path",t),r instanceof R9){const n=Rn.fromString(t,...e);return XY(n),new Wr(r,null,new Ze(n))}{if(!(r instanceof Wr||r instanceof zc))throw new Oe(ue.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=r._path.child(Rn.fromString(t,...e));return XY(n),new Wr(r.firestore,r instanceof zc?r.converter:null,new Ze(n))}}class lOe{constructor(){this.Xa=Promise.resolve(),this.eu=[],this.tu=!1,this.nu=[],this.ru=null,this.iu=!1,this.su=!1,this.ou=[],this.jo=new gw(this,"async_queue_retry"),this._u=()=>{const e=y_();e&&Se("AsyncQueue","Visibility state changed to "+e.visibilityState),this.jo.Ko()};const t=y_();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this._u)}get isShuttingDown(){return this.tu}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.au(),this.uu(t)}enterRestrictedMode(t){if(!this.tu){this.tu=!0,this.su=t||!1;const e=y_();e&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this._u)}}enqueue(t){if(this.au(),this.tu)return new Promise(()=>{});const e=new Ei;return this.uu(()=>this.tu&&this.su?Promise.resolve():(t().then(e.resolve,e.reject),e.promise)).then(()=>e.promise)}enqueueRetryable(t){this.enqueueAndForget(()=>(this.eu.push(t),this.cu()))}cu(){var t=this;return M(function*(){if(0!==t.eu.length){try{yield t.eu[0](),t.eu.shift(),t.jo.reset()}catch(e){if(!J4(e))throw e;Se("AsyncQueue","Operation failed with retryable error: "+e)}t.eu.length>0&&t.jo.qo(()=>t.cu())}})()}uu(t){const e=this.Xa.then(()=>(this.iu=!0,t().catch(n=>{throw this.ru=n,this.iu=!1,Br("INTERNAL UNHANDLED ERROR: ",function(s){let a=s.message||"";return s.stack&&(a=s.stack.includes(s.message)?s.stack:s.message+"\n"+s.stack),a}(n)),n}).then(n=>(this.iu=!1,n))));return this.Xa=e,e}enqueueAfterDelay(t,e,n){this.au(),this.ou.indexOf(t)>-1&&(e=0);const i=Rw.createAndSchedule(this,t,e,n,o=>this.lu(o));return this.nu.push(i),i}au(){this.ru&&lt()}verifyOperationInProgress(){}hu(){var t=this;return M(function*(){let e;do{e=t.Xa,yield e}while(e!==t.Xa)})()}Pu(t){for(const e of this.nu)if(e.timerId===t)return!0;return!1}Iu(t){return this.hu().then(()=>{this.nu.sort((e,n)=>e.targetTimeMs-n.targetTimeMs);for(const e of this.nu)if(e.skipDelay(),"all"!==t&&e.timerId===t)break;return this.hu()})}Tu(t){this.ou.push(t)}lu(t){const e=this.nu.indexOf(t);this.nu.splice(e,1)}}function Mb(r){return function(e,n){if("object"!=typeof e||null===e)return!1;const i=e;for(const o of["next","error","complete"])if(o in i&&"function"==typeof i[o])return!0;return!1}(r)}class U1 extends R9{constructor(t,e,n,i){super(t,e,n,i),this.type="firestore",this._queue=new lOe,this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||iK(this),this._firestoreClient.terminate()}}function rK(r,t){const n="string"==typeof r?r:t||"(default)",i=_m("object"==typeof r?r:zW(),"firestore").getImmediate({identifier:n});if(!i._initialized){const o=(r=>{const t=yW("firestore");if(!t)return;const e=t.lastIndexOf(":");if(e<=0||e+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const n=parseInt(t.substring(e+1),10);return"["===t[0]?[t.substring(1,e-1),n]:[t.substring(0,e),n]})();o&&tK(i,...o)}return i}function qr(r){return r._firestoreClient||iK(r),r._firestoreClient.verifyNotTerminated(),r._firestoreClient}function iK(r){var t,e,n;const i=r._freezeSettings(),o=(c=(null===(t=r._app)||void 0===t?void 0:t.options.appId)||"",new VEe(r._databaseId,c,r._persistenceKey,(u=i).host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,YY(u.experimentalLongPollingOptions),u.useFetchStreams));var c,u;r._firestoreClient=new KSe(r._authCredentials,r._appCheckCredentials,r._queue,o),null!==(e=i.localCache)&&void 0!==e&&e._offlineComponentProvider&&null!==(n=i.localCache)&&void 0!==n&&n._onlineComponentProvider&&(r._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}class B6{constructor(t){this._byteString=t}static fromBase64String(t){try{return new B6(Pi.fromBase64String(t))}catch(e){throw new Oe(ue.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(t){return new B6(Pi.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}}class $6{constructor(...t){for(let e=0;e<t.length;++e)if(0===t[e].length)throw new Oe(ue.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new dr(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}class W6{constructor(t){this._methodName=t}}class Eb{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new Oe(ue.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new Oe(ue.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(t){return Kt(this._lat,t._lat)||Kt(this._long,t._long)}}const dOe=/^__.*__$/;class hOe{constructor(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}toMutation(t,e){return null!==this.fieldMask?new H3(t,this.data,this.fieldMask,e,this.fieldTransforms):new v5(t,this.data,e,this.fieldTransforms)}}class aK{constructor(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}toMutation(t,e){return new H3(t,this.data,this.fieldMask,e,this.fieldTransforms)}}function cK(r){switch(r){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw lt()}}class w_{constructor(t,e,n,i,o,s){this.settings=t,this.databaseId=e,this.serializer=n,this.ignoreUndefinedProperties=i,void 0===o&&this.Eu(),this.fieldTransforms=o||[],this.fieldMask=s||[]}get path(){return this.settings.path}get du(){return this.settings.du}Au(t){return new w_(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ru(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),i=this.Au({path:n,Vu:!1});return i.mu(t),i}fu(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),i=this.Au({path:n,Vu:!1});return i.Eu(),i}gu(t){return this.Au({path:void 0,Vu:!0})}pu(t){return N_(t,this.settings.methodName,this.settings.yu||!1,this.path,this.settings.wu)}contains(t){return void 0!==this.fieldMask.find(e=>t.isPrefixOf(e))||void 0!==this.fieldTransforms.find(e=>t.isPrefixOf(e.field))}Eu(){if(this.path)for(let t=0;t<this.path.length;t++)this.mu(this.path.get(t))}mu(t){if(0===t.length)throw this.pu("Document fields must not be empty");if(cK(this.du)&&dOe.test(t))throw this.pu('Document fields cannot begin and end with "__"')}}class gOe{constructor(t,e,n){this.databaseId=t,this.ignoreUndefinedProperties=e,this.serializer=n||N9(t)}Su(t,e,n,i=!1){return new w_({du:t,methodName:e,wu:n,path:dr.emptyPath(),Vu:!1,yu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function q6(r){const t=r._freezeSettings(),e=N9(r._databaseId);return new gOe(r._databaseId,!!t.ignoreUndefinedProperties,e)}function b_(r,t,e,n,i,o={}){const s=r.Su(o.merge||o.mergeFields?2:0,t,e,i);Ab("Data must be an object, but it was:",s,n);const a=fK(n,s);let c,l;if(o.merge)c=new Ro(s.fieldMask),l=s.fieldTransforms;else if(o.mergeFields){const u=[];for(const f of o.mergeFields){const g=z9(t,f,e);if(!s.contains(g))throw new Oe(ue.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);hK(u,g)||u.push(g)}c=new Ro(u),l=s.fieldTransforms.filter(f=>c.covers(f.field))}else c=null,l=s.fieldTransforms;return new hOe(new c2(a),c,l)}class L9 extends W6{_toFieldTransform(t){if(2!==t.du)throw t.pu(1===t.du?`${this._methodName}() can only appear at the top level of your update data`:`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return t.fieldMask.push(t.path),null}isEqual(t){return t instanceof L9}}class Pb extends W6{_toFieldTransform(t){return new m9(t.path,new _5)}isEqual(t){return t instanceof Pb}}function j6(r,t){if(dK(r=Cr(r)))return Ab("Unsupported field value:",t,r),fK(r,t);if(r instanceof W6)return function(n,i){if(!cK(i.du))throw i.pu(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.pu(`${n._methodName}() is not currently supported inside arrays`);const o=n._toFieldTransform(i);o&&i.fieldTransforms.push(o)}(r,t),null;if(void 0===r&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),r instanceof Array){if(t.settings.Vu&&4!==t.du)throw t.pu("Nested arrays are not supported");return function(n,i){const o=[];let s=0;for(const a of n){let c=j6(a,i.gu(s));null==c&&(c={nullValue:"NULL_VALUE"}),o.push(c),s++}return{arrayValue:{values:o}}}(r,t)}return function(n,i){if(null===(n=Cr(n)))return{nullValue:"NULL_VALUE"};if("number"==typeof n)return tZ(i.serializer,n);if("boolean"==typeof n)return{booleanValue:n};if("string"==typeof n)return{stringValue:n};if(n instanceof Date){const o=vr.fromDate(n);return{timestampValue:M5(i.serializer,o)}}if(n instanceof vr){const o=new vr(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:M5(i.serializer,o)}}if(n instanceof Eb)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof B6)return{bytesValue:EZ(i.serializer,n._byteString)};if(n instanceof Wr){const o=i.databaseId,s=n.firestore._databaseId;if(!s.isEqual(o))throw i.pu(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:UT(n.firestore._databaseId||i.databaseId,n._key.path)}}throw i.pu(`Unsupported field value: ${T_(n)}`)}(r,t)}function fK(r,t){const e={};return Pj(r)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):el(r,(n,i)=>{const o=j6(i,t.Ru(n));null!=o&&(e[n]=o)}),{mapValue:{fields:e}}}function dK(r){return!("object"!=typeof r||null===r||r instanceof Array||r instanceof Date||r instanceof vr||r instanceof Eb||r instanceof B6||r instanceof Wr||r instanceof W6)}function Ab(r,t,e){if(!dK(e)||"object"!=typeof(i=e)||null===i||Object.getPrototypeOf(i)!==Object.prototype&&null!==Object.getPrototypeOf(i)){const n=T_(e);throw t.pu("an object"===n?r+" a custom object":r+" "+n)}var i}function z9(r,t,e){if((t=Cr(t))instanceof $6)return t._internalPath;if("string"==typeof t)return A_(r,t);throw N_("Field path arguments must be of type string or ",r,!1,void 0,e)}const pOe=new RegExp("[~\\*/\\[\\]]");function A_(r,t,e){if(t.search(pOe)>=0)throw N_(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,r,!1,void 0,e);try{return new $6(...t.split("."))._internalPath}catch{throw N_(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,r,!1,void 0,e)}}function N_(r,t,e,n,i){const o=n&&!n.isEmpty(),s=void 0!==i;let a=`Function ${t}() called with invalid data`;e&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(o||s)&&(c+=" (found",o&&(c+=` in field ${n}`),s&&(c+=` in document ${i}`),c+=")"),new Oe(ue.INVALID_ARGUMENT,a+r+c)}function hK(r,t){return r.some(e=>e.isEqual(t))}class D9{constructor(t,e,n,i,o){this._firestore=t,this._userDataWriter=e,this._key=n,this._document=i,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new Wr(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const t=new mOe(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const e=this._document.data.field(I_("DocumentSnapshot.get",t));if(null!==e)return this._userDataWriter.convertValue(e)}}}class mOe extends D9{data(){return super.data()}}function I_(r,t){return"string"==typeof t?A_(r,t):t instanceof $6?t._internalPath:t._delegate._internalPath}function gK(r){if("L"===r.limitType&&0===r.explicitOrderBy.length)throw new Oe(ue.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Nb{}class V9 extends Nb{}function k_(r,t,...e){let n=[];t instanceof Nb&&n.push(t),n=n.concat(e),function(o){const s=o.filter(c=>c instanceof U5).length,a=o.filter(c=>c instanceof H9).length;if(s>1||s>0&&a>0)throw new Oe(ue.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const i of n)r=i._apply(r);return r}class H9 extends V9{constructor(t,e,n){super(),this._field=t,this._op=e,this._value=n,this.type="where"}static _create(t,e,n){return new H9(t,e,n)}_apply(t){const e=this._parse(t);return CK(t._query,e),new l2(t.firestore,t.converter,RT(t._query,e))}_parse(t){const e=q6(t.firestore);return function(o,s,a,c,l,u,f){let g;if(l.isKeyField()){if("array-contains"===u||"array-contains-any"===u)throw new Oe(ue.INVALID_ARGUMENT,`Invalid Query. You can't perform '${u}' queries on documentId().`);if("in"===u||"not-in"===u){_K(f,u);const y=[];for(const S of f)y.push(mK(c,o,S));g={arrayValue:{values:y}}}else g=mK(c,o,f)}else"in"!==u&&"not-in"!==u&&"array-contains-any"!==u||_K(f,u),g=function uK(r,t,e,n=!1){return j6(e,r.Su(n?4:3,t))}(a,"where",f,"in"===u||"not-in"===u);return xn.create(l,u,g)}(t._query,0,e,t.firestore._databaseId,this._field,this._op,this._value)}}function _Oe(r,t,e){const n=t,i=I_("where",r);return H9._create(i,n,e)}class U5 extends Nb{constructor(t,e){super(),this.type=t,this._queryConstraints=e}static _create(t,e){return new U5(t,e)}_parse(t){const e=this._queryConstraints.map(n=>n._parse(t)).filter(n=>n.getFilters().length>0);return 1===e.length?e[0]:g1.create(e,this._getOperator())}_apply(t){const e=this._parse(t);return 0===e.getFilters().length?t:(function(i,o){let s=i;const a=o.getFlattenedFilters();for(const c of a)CK(s,c),s=RT(s,c)}(t._query,e),new l2(t.firestore,t.converter,RT(t._query,e)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class Ib extends V9{constructor(t,e){super(),this._field=t,this._direction=e,this.type="orderBy"}static _create(t,e){return new Ib(t,e)}_apply(t){const e=function(i,o,s){if(null!==i.startAt)throw new Oe(ue.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==i.endAt)throw new Oe(ue.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new u9(o,s)}(t._query,this._field,this._direction);return new l2(t.firestore,t.converter,function(i,o){const s=i.explicitOrderBy.concat([o]);return new D3(i.path,i.collectionGroup,s,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(t._query,e))}}class R_ extends V9{constructor(t,e,n){super(),this.type=t,this._limit=e,this._limitType=n}static _create(t,e,n){return new R_(t,e,n)}_apply(t){return new l2(t.firestore,t.converter,e_(t._query,this._limit,this._limitType))}}function mK(r,t,e){if("string"==typeof(e=Cr(e))){if(""===e)throw new Oe(ue.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!kT(t)&&-1!==e.indexOf("/"))throw new Oe(ue.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${e}' contains a '/' character.`);const n=t.path.child(Rn.fromString(e));if(!Ze.isDocumentKey(n))throw new Oe(ue.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return k6(r,new Ze(n))}if(e instanceof Wr)return k6(r,e._key);throw new Oe(ue.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${T_(e)}.`)}function _K(r,t){if(!Array.isArray(r)||0===r.length)throw new Oe(ue.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function CK(r,t){const e=function(i,o){for(const s of i)for(const a of s.getFlattenedFilters())if(o.indexOf(a.op)>=0)return a.op;return null}(r.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==e)throw new Oe(ue.INVALID_ARGUMENT,e===t.op?`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`:`Invalid query. You cannot use '${t.op.toString()}' filters with '${e.toString()}' filters.`)}class yK{convertValue(t,e="none"){switch(rl(t)){case 0:return null;case 1:return t.booleanValue;case 2:return wr(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(z3(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 10:return this.convertObject(t.mapValue,e);default:throw lt()}}convertObject(t,e){return this.convertObjectMap(t.fields,e)}convertObjectMap(t,e="none"){const n={};return el(t,(i,o)=>{n[i]=this.convertValue(o,e)}),n}convertGeoPoint(t){return new Eb(wr(t.latitude),wr(t.longitude))}convertArray(t,e){return(t.values||[]).map(n=>this.convertValue(n,e))}convertServerTimestamp(t,e){switch(e){case"previous":const n=Zm(t);return null==n?null:this.convertValue(n,e);case"estimate":return this.convertTimestamp(s9(t));default:return null}}convertTimestamp(t){const e=tl(t);return new vr(e.seconds,e.nanos)}convertDocumentKey(t,e){const n=Rn.fromString(t);pt(RZ(n));const i=new I6(n.get(1),n.get(3)),o=new Ze(n.popFirst(5));return i.isEqual(e)||Br(`Document ${o} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${e.projectId}/${e.database}) instead.`),o}}function z_(r,t,e){let n;return n=r?e&&(e.merge||e.mergeFields)?r.toFirestore(t,e):r.toFirestore(t):t,n}class Z6{constructor(t,e){this.hasPendingWrites=t,this.fromCache=e}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class G5 extends D9{constructor(t,e,n,i,o,s){super(t,e,n,i,s),this._firestore=t,this._firestoreImpl=t,this.metadata=o}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const e=new D_(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,e={}){if(this._document){const n=this._document.data.field(I_("DocumentSnapshot.get",t));if(null!==n)return this._userDataWriter.convertValue(n,e.serverTimestamps)}}}class D_ extends G5{data(t={}){return super.data(t)}}class B5{constructor(t,e,n,i){this._firestore=t,this._userDataWriter=e,this._snapshot=i,this.metadata=new Z6(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const t=[];return this.forEach(e=>t.push(e)),t}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(t,e){this._snapshot.docs.forEach(n=>{t.call(e,new D_(this._firestore,this._userDataWriter,n.key,n,new Z6(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(t={}){const e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new Oe(ue.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(i,o){if(i._snapshot.oldDocs.isEmpty()){let s=0;return i._snapshot.docChanges.map(a=>({type:"added",doc:new D_(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Z6(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter),oldIndex:-1,newIndex:s++}))}{let s=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>o||3!==a.type).map(a=>{const c=new D_(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Z6(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);let l=-1,u=-1;return 0!==a.type&&(l=s.indexOf(a.doc.key),s=s.delete(a.doc.key)),1!==a.type&&(s=s.add(a.doc),u=s.indexOf(a.doc.key)),{type:EOe(a.type),doc:c,oldIndex:l,newIndex:u}})}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}}function EOe(r){switch(r){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return lt()}}class dl extends yK{constructor(t){super(),this.firestore=t}convertBytes(t){return new B6(t)}convertReference(t){const e=this.convertDocumentKey(t,this.firestore._databaseId);return new Wr(this.firestore,null,e)}}function MK(r,...t){var e,n,i;r=Cr(r);let o={includeMetadataChanges:!1},s=0;"object"!=typeof t[s]||Mb(t[s])||(o=t[s],s++);const a={includeMetadataChanges:o.includeMetadataChanges};if(Mb(t[s])){const f=t[s];t[s]=null===(e=f.next)||void 0===e?void 0:e.bind(f),t[s+1]=null===(n=f.error)||void 0===n?void 0:n.bind(f),t[s+2]=null===(i=f.complete)||void 0===i?void 0:i.bind(f)}let c,l,u;if(r instanceof Wr)l=Ln(r.firestore,U1),u=g5(r._key.path),c={next:f=>{t[s]&&t[s](kb(l,r,f))},error:t[s+1],complete:t[s+2]};else{const f=Ln(r,l2);l=Ln(f.firestore,U1),u=f._query;const g=new dl(l);c={next:y=>{t[s]&&t[s](new B5(l,g,f,y))},error:t[s+1],complete:t[s+2]},gK(r._query)}return function(g,y,S,N){const R=new P_(N),U=new Hw(y,R,S);return g.asyncQueue.enqueueAndForget(M(function*(){return xw(yield H5(g),U)})),()=>{R.La(),g.asyncQueue.enqueueAndForget(M(function*(){return zw(yield H5(g),U)}))}}(qr(l),u,a,c)}function F9(r,t){return function(n,i){const o=new Ei;return n.asyncQueue.enqueueAndForget(M(function*(){return function NSe(r,t,e){return $w.apply(this,arguments)}(yield function Cb(r){return O_(r).then(t=>t.syncEngine)}(n),i,o)})),o.promise}(qr(r),t)}function kb(r,t,e){const n=e.docs.get(t._key),i=new dl(r);return new G5(r,i,t._key,n,new Z6(e.hasPendingWrites,e.fromCache),t.converter)}function Dc(){return new Pb("serverTimestamp")}!function(t,e=!0){s5=Q8,X8(new v6("firestore",(n,{instanceIdentifier:i,options:o})=>{const s=n.getProvider("app").getImmediate(),a=new U1(new aEe(n.getProvider("auth-internal")),new uEe(n.getProvider("app-check-internal")),function(l,u){if(!Object.prototype.hasOwnProperty.apply(l.options,["projectId"]))throw new Oe(ue.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new I6(l.options.projectId,u)}(s,i),s);return o=Object.assign({useFetchStreams:e},o),a._setSettings(o),a},"PUBLIC").setMultipleInstances(!0)),P6(oj,"4.4.3",t),P6(oj,"4.4.3","esm2017")}();const UOe=function OK(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},TK=new Af("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),H_=new yO("@firebase/auth");function F_(r,...t){H_.logLevel<=kn.ERROR&&H_.error(`Auth (${Q8}): ${r}`,...t)}function Lo(r,...t){throw xb(r,...t)}function gs(r,...t){return xb(r,...t)}function wK(r,t,e){const n=Object.assign(Object.assign({},UOe()),{[t]:e});return new Af("auth","Firebase",n).create(t,{appName:r.name})}function xb(r,...t){if("string"!=typeof r){const e=t[0],n=[...t.slice(1)];return n[0]&&(n[0].appName=r.name),r._errorFactory.create(e,...n)}return TK.create(r,...t)}function Ge(r,t,...e){if(!r)throw xb(t,...e)}function Vc(r){const t="INTERNAL ASSERTION FAILED: "+r;throw F_(t),new Error(t)}function G3(r,t){r||Vc(t)}function U9(){var r;return typeof self<"u"&&(null===(r=self.location)||void 0===r?void 0:r.href)||""}function bK(){var r;return typeof self<"u"&&(null===(r=self.location)||void 0===r?void 0:r.protocol)||null}function BOe(){return!(typeof navigator<"u"&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(function Lb(){return"http:"===bK()||"https:"===bK()}()||function Rve(){const r="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof r&&void 0!==r.id}()||"connection"in navigator))||navigator.onLine}class G9{constructor(t,e){this.shortDelay=t,this.longDelay=e,G3(e>t,"Short delay should be less than long delay!"),this.isMobile=function Ive(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Or())}()||function xve(){return"object"==typeof navigator&&"ReactNative"===navigator.product}()}get(){return BOe()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function zb(r,t){G3(r.emulator,"Emulator should always be set here");const{url:e}=r.emulator;return t?`${e}${t.startsWith("/")?t.slice(1):t}`:e}class AK{static initialize(t,e,n){this.fetchImpl=t,e&&(this.headersImpl=e),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:typeof self<"u"&&"fetch"in self?self.fetch:typeof globalThis<"u"&&globalThis.fetch?globalThis.fetch:typeof fetch<"u"?fetch:void Vc("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:typeof self<"u"&&"Headers"in self?self.Headers:typeof globalThis<"u"&&globalThis.Headers?globalThis.Headers:typeof Headers<"u"?Headers:void Vc("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:typeof self<"u"&&"Response"in self?self.Response:typeof globalThis<"u"&&globalThis.Response?globalThis.Response:typeof Response<"u"?Response:void Vc("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const WOe={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},qOe=new G9(3e4,6e4);function X1(r,t){return r.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:r.tenantId}):t}function Q1(r,t,e,n){return Db.apply(this,arguments)}function Db(){return Db=M(function*(r,t,e,n,i={}){return NK(r,i,M(function*(){let o={},s={};n&&("GET"===t?s=n:o={body:JSON.stringify(n)});const a=Nf(Object.assign({key:r.config.apiKey},s)).slice(1),c=yield r._getAdditionalHeaders();return c["Content-Type"]="application/json",r.languageCode&&(c["X-Firebase-Locale"]=r.languageCode),AK.fetch()(IK(r,r.config.apiHost,e,a),Object.assign({method:t,headers:c,referrerPolicy:"no-referrer"},o))}))}),Db.apply(this,arguments)}function NK(r,t,e){return Vb.apply(this,arguments)}function Vb(){return Vb=M(function*(r,t,e){r._canInitEmulator=!1;const n=Object.assign(Object.assign({},WOe),t);try{const i=new ZOe(r),o=yield Promise.race([e(),i.promise]);i.clearNetworkTimeout();const s=yield o.json();if("needConfirmation"in s)throw B9(r,"account-exists-with-different-credential",s);if(o.ok&&!("errorMessage"in s))return s;{const a=o.ok?s.errorMessage:s.error.message,[c,l]=a.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===c)throw B9(r,"credential-already-in-use",s);if("EMAIL_EXISTS"===c)throw B9(r,"email-already-in-use",s);if("USER_DISABLED"===c)throw B9(r,"user-disabled",s);const u=n[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(l)throw wK(r,u,l);Lo(r,u)}}catch(i){if(i instanceof bc)throw i;Lo(r,"network-request-failed",{message:String(i)})}}),Vb.apply(this,arguments)}function B3(r,t,e,n){return Hb.apply(this,arguments)}function Hb(){return Hb=M(function*(r,t,e,n,i={}){const o=yield Q1(r,t,e,n,i);return"mfaPendingCredential"in o&&Lo(r,"multi-factor-auth-required",{_serverResponse:o}),o}),Hb.apply(this,arguments)}function IK(r,t,e,n){const i=`${t}${e}?${n}`;return r.config.emulator?zb(r.config,i):`${r.config.apiScheme}://${i}`}function jOe(r){switch(r){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class ZOe{constructor(t){this.auth=t,this.timer=null,this.promise=new Promise((e,n)=>{this.timer=setTimeout(()=>n(gs(this.auth,"network-request-failed")),qOe.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function B9(r,t,e){const n={appName:r.name};e.email&&(n.email=e.email),e.phoneNumber&&(n.phoneNumber=e.phoneNumber);const i=gs(r,t,n);return i.customData._tokenResponse=e,i}function RK(r){return void 0!==r&&void 0!==r.enterprise}class xK{constructor(t){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===t.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=t.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=t.recaptchaEnforcementState}getProviderEnforcementState(t){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const e of this.recaptchaEnforcementState)if(e.provider&&e.provider===t)return jOe(e.enforcementState);return null}isProviderEnabled(t){return"ENFORCE"===this.getProviderEnforcementState(t)||"AUDIT"===this.getProviderEnforcementState(t)}}function Ub(){return Ub=M(function*(r,t){return Q1(r,"GET","/v2/recaptchaConfig",X1(r,t))}),Ub.apply(this,arguments)}function Gb(){return Gb=M(function*(r,t){return Q1(r,"POST","/v1/accounts:delete",t)}),Gb.apply(this,arguments)}function $b(){return $b=M(function*(r,t){return Q1(r,"POST","/v1/accounts:lookup",t)}),$b.apply(this,arguments)}function $9(r){if(r)try{const t=new Date(Number(r));if(!isNaN(t.getTime()))return t.toUTCString()}catch{}}function Wb(){return Wb=M(function*(r,t=!1){const e=Cr(r),n=yield e.getIdToken(t),i=U_(n);Ge(i&&i.exp&&i.auth_time&&i.iat,e.auth,"internal-error");const o="object"==typeof i.firebase?i.firebase:void 0,s=o?.sign_in_provider;return{claims:i,token:n,authTime:$9(qb(i.auth_time)),issuedAtTime:$9(qb(i.iat)),expirationTime:$9(qb(i.exp)),signInProvider:s||null,signInSecondFactor:o?.sign_in_second_factor||null}}),Wb.apply(this,arguments)}function qb(r){return 1e3*Number(r)}function U_(r){const[t,e,n]=r.split(".");if(void 0===t||void 0===e||void 0===n)return F_("JWT malformed, contained fewer than 3 sections"),null;try{const i=dm(e);return i?JSON.parse(i):(F_("Failed to decode base64 JWT payload"),null)}catch(i){return F_("Caught error parsing JWT payload as JSON",i?.toString()),null}}function $3(r,t){return jb.apply(this,arguments)}function jb(){return jb=M(function*(r,t,e=!1){if(e)return t;try{return yield t}catch(n){throw n instanceof bc&&function tTe({code:r}){return"auth/user-disabled"===r||"auth/user-token-expired"===r}(n)&&r.auth.currentUser===r&&(yield r.auth.signOut()),n}}),jb.apply(this,arguments)}class nTe{constructor(t){this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(t){var e;if(t){const n=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),n}{this.errorBackoff=3e4;const i=(null!==(e=this.user.stsTokenManager.expirationTime)&&void 0!==e?e:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(t=!1){var e=this;if(!this.isRunning)return;const n=this.getInterval(t);this.timerId=setTimeout(M(function*(){yield e.iteration()}),n)}iteration(){var t=this;return M(function*(){try{yield t.user.getIdToken(!0)}catch(e){return void("auth/network-request-failed"===e?.code&&t.schedule(!0))}t.schedule()})()}}class zK{constructor(t,e){this.createdAt=t,this.lastLoginAt=e,this._initializeTime()}_initializeTime(){this.lastSignInTime=$9(this.lastLoginAt),this.creationTime=$9(this.createdAt)}_copy(t){this.createdAt=t.createdAt,this.lastLoginAt=t.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}function W9(r){return Zb.apply(this,arguments)}function Zb(){return Zb=M(function*(r){var t;const e=r.auth,n=yield r.getIdToken(),i=yield $3(r,function QOe(r,t){return $b.apply(this,arguments)}(e,{idToken:n}));Ge(i?.users.length,e,"internal-error");const o=i.users[0];r._notifyReloadListener(o);const s=null!==(t=o.providerUserInfo)&&void 0!==t&&t.length?function oTe(r){return r.map(t=>{var{providerId:e}=t,n=mp(t,["providerId"]);return{providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}(o.providerUserInfo):[],a=function iTe(r,t){return[...r.filter(n=>!t.some(i=>i.providerId===n.providerId)),...t]}(r.providerData,s),u=!!r.isAnonymous&&!(r.email&&o.passwordHash||a?.length),f={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:a,metadata:new zK(o.createdAt,o.lastLoginAt),isAnonymous:u};Object.assign(r,f)}),Zb.apply(this,arguments)}function Yb(){return Yb=M(function*(r){const t=Cr(r);yield W9(t),yield t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}),Yb.apply(this,arguments)}function Kb(){return Kb=M(function*(r,t){const e=yield NK(r,{},M(function*(){const n=Nf({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:i,apiKey:o}=r.config,s=IK(r,i,"/v1/token",`key=${o}`),a=yield r._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",AK.fetch()(s,{method:"POST",headers:a,body:n})}));return{accessToken:e.access_token,expiresIn:e.expires_in,refreshToken:e.refresh_token}}),Kb.apply(this,arguments)}function Xb(){return Xb=M(function*(r,t){return Q1(r,"POST","/v2/accounts:revokeToken",X1(r,t))}),Xb.apply(this,arguments)}class q9{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(t){Ge(t.idToken,"internal-error"),Ge(typeof t.idToken<"u","internal-error"),Ge(typeof t.refreshToken<"u","internal-error");const e="expiresIn"in t&&typeof t.expiresIn<"u"?Number(t.expiresIn):function eTe(r){const t=U_(r);return Ge(t,"internal-error"),Ge(typeof t.exp<"u","internal-error"),Ge(typeof t.iat<"u","internal-error"),Number(t.exp)-Number(t.iat)}(t.idToken);this.updateTokensAndExpiration(t.idToken,t.refreshToken,e)}getToken(t,e=!1){var n=this;return M(function*(){return Ge(!n.accessToken||n.refreshToken,t,"user-token-expired"),e||!n.accessToken||n.isExpired?n.refreshToken?(yield n.refresh(t,n.refreshToken),n.accessToken):null:n.accessToken})()}clearRefreshToken(){this.refreshToken=null}refresh(t,e){var n=this;return M(function*(){const{accessToken:i,refreshToken:o,expiresIn:s}=yield function sTe(r,t){return Kb.apply(this,arguments)}(t,e);n.updateTokensAndExpiration(i,o,Number(s))})()}updateTokensAndExpiration(t,e,n){this.refreshToken=e||null,this.accessToken=t||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(t,e){const{refreshToken:n,accessToken:i,expirationTime:o}=e,s=new q9;return n&&(Ge("string"==typeof n,"internal-error",{appName:t}),s.refreshToken=n),i&&(Ge("string"==typeof i,"internal-error",{appName:t}),s.accessToken=i),o&&(Ge("number"==typeof o,"internal-error",{appName:t}),s.expirationTime=o),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(t){this.accessToken=t.accessToken,this.refreshToken=t.refreshToken,this.expirationTime=t.expirationTime}_clone(){return Object.assign(new q9,this.toJSON())}_performRefresh(){return Vc("not implemented")}}function gl(r,t){Ge("string"==typeof r||typeof r>"u","internal-error",{appName:t})}class Y6{constructor(t){var{uid:e,auth:n,stsTokenManager:i}=t,o=mp(t,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new nTe(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new zK(o.createdAt||void 0,o.lastLoginAt||void 0)}getIdToken(t){var e=this;return M(function*(){const n=yield $3(e,e.stsTokenManager.getToken(e.auth,t));return Ge(n,e.auth,"internal-error"),e.accessToken!==n&&(e.accessToken=n,yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)),n})()}getIdTokenResult(t){return function JOe(r){return Wb.apply(this,arguments)}(this,t)}reload(){return function rTe(r){return Yb.apply(this,arguments)}(this)}_assign(t){this!==t&&(Ge(this.uid===t.uid,this.auth,"internal-error"),this.displayName=t.displayName,this.photoURL=t.photoURL,this.email=t.email,this.emailVerified=t.emailVerified,this.phoneNumber=t.phoneNumber,this.isAnonymous=t.isAnonymous,this.tenantId=t.tenantId,this.providerData=t.providerData.map(e=>Object.assign({},e)),this.metadata._copy(t.metadata),this.stsTokenManager._assign(t.stsTokenManager))}_clone(t){const e=new Y6(Object.assign(Object.assign({},this),{auth:t,stsTokenManager:this.stsTokenManager._clone()}));return e.metadata._copy(this.metadata),e}_onReload(t){Ge(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=t,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(t){this.reloadListener?this.reloadListener(t):this.reloadUserInfo=t}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(t,e=!1){var n=this;return M(function*(){let i=!1;t.idToken&&t.idToken!==n.stsTokenManager.accessToken&&(n.stsTokenManager.updateFromServerResponse(t),i=!0),e&&(yield W9(n)),yield n.auth._persistUserIfCurrent(n),i&&n.auth._notifyListenersIfCurrent(n)})()}delete(){var t=this;return M(function*(){const e=yield t.getIdToken();return yield $3(t,function KOe(r,t){return Gb.apply(this,arguments)}(t.auth,{idToken:e})),t.stsTokenManager.clearRefreshToken(),t.auth.signOut()})()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(t=>Object.assign({},t)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(t,e){var n,i,o,s,a,c,l,u;const f=null!==(n=e.displayName)&&void 0!==n?n:void 0,g=null!==(i=e.email)&&void 0!==i?i:void 0,y=null!==(o=e.phoneNumber)&&void 0!==o?o:void 0,S=null!==(s=e.photoURL)&&void 0!==s?s:void 0,N=null!==(a=e.tenantId)&&void 0!==a?a:void 0,R=null!==(c=e._redirectEventId)&&void 0!==c?c:void 0,U=null!==(l=e.createdAt)&&void 0!==l?l:void 0,$=null!==(u=e.lastLoginAt)&&void 0!==u?u:void 0,{uid:re,emailVerified:_e,isAnonymous:be,providerData:Ve,stsTokenManager:dt}=e;Ge(re&&dt,t,"internal-error");const Xt=q9.fromJSON(this.name,dt);Ge("string"==typeof re,t,"internal-error"),gl(f,t.name),gl(g,t.name),Ge("boolean"==typeof _e,t,"internal-error"),Ge("boolean"==typeof be,t,"internal-error"),gl(y,t.name),gl(S,t.name),gl(N,t.name),gl(R,t.name),gl(U,t.name),gl($,t.name);const u1=new Y6({uid:re,auth:t,email:g,emailVerified:_e,displayName:f,isAnonymous:be,photoURL:S,phoneNumber:y,tenantId:N,stsTokenManager:Xt,createdAt:U,lastLoginAt:$});return Ve&&Array.isArray(Ve)&&(u1.providerData=Ve.map(an=>Object.assign({},an))),R&&(u1._redirectEventId=R),u1}static _fromIdTokenResponse(t,e,n=!1){return M(function*(){const i=new q9;i.updateFromServerResponse(e);const o=new Y6({uid:e.localId,auth:t,stsTokenManager:i,isAnonymous:n});return yield W9(o),o})()}}const DK=new Map;function W3(r){G3(r instanceof Function,"Expected a class definition");let t=DK.get(r);return t?(G3(t instanceof r,"Instance stored in cache mismatched with class"),t):(t=new r,DK.set(r,t),t)}const VK=(()=>{class r{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return M(function*(){return!0})()}_set(e,n){var i=this;return M(function*(){i.storage[e]=n})()}_get(e){var n=this;return M(function*(){const i=n.storage[e];return void 0===i?null:i})()}_remove(e){var n=this;return M(function*(){delete n.storage[e]})()}_addListener(e,n){}_removeListener(e,n){}}return r.type="NONE",r})();function G_(r,t,e){return`firebase:${r}:${t}:${e}`}class W5{constructor(t,e,n){this.persistence=t,this.auth=e,this.userKey=n;const{config:i,name:o}=this.auth;this.fullUserKey=G_(this.userKey,i.apiKey,o),this.fullPersistenceKey=G_("persistence",i.apiKey,o),this.boundEventHandler=e._onStorageEvent.bind(e),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(t){return this.persistence._set(this.fullUserKey,t.toJSON())}getCurrentUser(){var t=this;return M(function*(){const e=yield t.persistence._get(t.fullUserKey);return e?Y6._fromJSON(t.auth,e):null})()}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(t){var e=this;return M(function*(){if(e.persistence===t)return;const n=yield e.getCurrentUser();return yield e.removeCurrentUser(),e.persistence=t,n?e.setCurrentUser(n):void 0})()}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(t,e,n="authUser"){return M(function*(){if(!e.length)return new W5(W3(VK),t,n);const i=(yield Promise.all(e.map(function(){var l=M(function*(u){if(yield u._isAvailable())return u});return function(u){return l.apply(this,arguments)}}()))).filter(l=>l);let o=i[0]||W3(VK);const s=G_(n,t.config.apiKey,t.name);let a=null;for(const l of e)try{const u=yield l._get(s);if(u){const f=Y6._fromJSON(t,u);l!==o&&(a=f),o=l;break}}catch{}const c=i.filter(l=>l._shouldAllowMigration);return o._shouldAllowMigration&&c.length?(o=c[0],a&&(yield o._set(s,a.toJSON())),yield Promise.all(e.map(function(){var l=M(function*(u){if(u!==o)try{yield u._remove(s)}catch{}});return function(u){return l.apply(this,arguments)}}())),new W5(o,t,n)):new W5(o,t,n)})()}}function HK(r){const t=r.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(GK(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(FK(t))return"Firefox";if(t.includes("silk/"))return"Silk";if($K(t))return"Blackberry";if(WK(t))return"Webos";if(Qb(t))return"Safari";if((t.includes("chrome/")||UK(t))&&!t.includes("edge/"))return"Chrome";if(BK(t))return"Android";{const n=r.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if(2===n?.length)return n[1]}return"Other"}function FK(r=Or()){return/firefox\//i.test(r)}function Qb(r=Or()){const t=r.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function UK(r=Or()){return/crios\//i.test(r)}function GK(r=Or()){return/iemobile/i.test(r)}function BK(r=Or()){return/android/i.test(r)}function $K(r=Or()){return/blackberry/i.test(r)}function WK(r=Or()){return/webos/i.test(r)}function B_(r=Or()){return/iphone|ipad|ipod/i.test(r)||/macintosh/i.test(r)&&/mobile/i.test(r)}function qK(r=Or()){return B_(r)||BK(r)||WK(r)||$K(r)||/windows phone/i.test(r)||GK(r)}function jK(r,t=[]){let e;switch(r){case"Browser":e=HK(Or());break;case"Worker":e=`${HK(Or())}-${r}`;break;default:e=r}const n=t.length?t.join(","):"FirebaseCore-web";return`${e}/JsCore/${Q8}/${n}`}class fTe{constructor(t){this.auth=t,this.queue=[]}pushCallback(t,e){const n=o=>new Promise((s,a)=>{try{s(t(o))}catch(c){a(c)}});n.onAbort=e,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}runMiddleware(t){var e=this;return M(function*(){if(e.auth.currentUser===t)return;const n=[];try{for(const i of e.queue)yield i(t),i.onAbort&&n.push(i.onAbort)}catch(i){n.reverse();for(const o of n)try{o()}catch{}throw e.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}})()}}function Jb(){return Jb=M(function*(r,t={}){return Q1(r,"GET","/v2/passwordPolicy",X1(r,t))}),Jb.apply(this,arguments)}class gTe{constructor(t){var e,n,i,o;const s=t.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(e=s.minPasswordLength)&&void 0!==e?e:6,s.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=s.maxPasswordLength),void 0!==s.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=s.containsLowercaseCharacter),void 0!==s.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=s.containsUppercaseCharacter),void 0!==s.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=s.containsNumericCharacter),void 0!==s.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=s.containsNonAlphanumericCharacter),this.enforcementState=t.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(i=null===(n=t.allowedNonAlphanumericCharacters)||void 0===n?void 0:n.join(""))&&void 0!==i?i:"",this.forceUpgradeOnSignin=null!==(o=t.forceUpgradeOnSignin)&&void 0!==o&&o,this.schemaVersion=t.schemaVersion}validatePassword(t){var e,n,i,o,s,a;const c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(t,c),this.validatePasswordCharacterOptions(t,c),c.isValid&&(c.isValid=null===(e=c.meetsMinPasswordLength)||void 0===e||e),c.isValid&&(c.isValid=null===(n=c.meetsMaxPasswordLength)||void 0===n||n),c.isValid&&(c.isValid=null===(i=c.containsLowercaseLetter)||void 0===i||i),c.isValid&&(c.isValid=null===(o=c.containsUppercaseLetter)||void 0===o||o),c.isValid&&(c.isValid=null===(s=c.containsNumericCharacter)||void 0===s||s),c.isValid&&(c.isValid=null===(a=c.containsNonAlphanumericCharacter)||void 0===a||a),c}validatePasswordLengthOptions(t,e){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(e.meetsMinPasswordLength=t.length>=n),i&&(e.meetsMaxPasswordLength=t.length<=i)}validatePasswordCharacterOptions(t,e){let n;this.updatePasswordCharacterOptionsStatuses(e,!1,!1,!1,!1);for(let i=0;i<t.length;i++)n=t.charAt(i),this.updatePasswordCharacterOptionsStatuses(e,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(t,e,n,i,o){this.customStrengthOptions.containsLowercaseLetter&&(t.containsLowercaseLetter||(t.containsLowercaseLetter=e)),this.customStrengthOptions.containsUppercaseLetter&&(t.containsUppercaseLetter||(t.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(t.containsNumericCharacter||(t.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(t.containsNonAlphanumericCharacter||(t.containsNonAlphanumericCharacter=o))}}class pTe{constructor(t,e,n,i){this.app=t,this.heartbeatServiceProvider=e,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new ZK(this),this.idTokenSubscription=new ZK(this),this.beforeStateQueue=new fTe(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=TK,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(t,e){var n=this;return e&&(this._popupRedirectResolver=W3(e)),this._initializationPromise=this.queue(M(function*(){var i,o;if(!n._deleted&&(n.persistenceManager=yield W5.create(n,t),!n._deleted)){if(null!==(i=n._popupRedirectResolver)&&void 0!==i&&i._shouldInitProactively)try{yield n._popupRedirectResolver._initialize(n)}catch{}yield n.initializeCurrentUser(e),n.lastNotifiedUid=(null===(o=n.currentUser)||void 0===o?void 0:o.uid)||null,!n._deleted&&(n._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){var t=this;return M(function*(){if(t._deleted)return;const e=yield t.assertedPersistence.getCurrentUser();if(t.currentUser||e){if(t.currentUser&&e&&t.currentUser.uid===e.uid)return t._currentUser._assign(e),void(yield t.currentUser.getIdToken());yield t._updateCurrentUser(e,!0)}})()}initializeCurrentUser(t){var e=this;return M(function*(){var n;const i=yield e.assertedPersistence.getCurrentUser();let o=i,s=!1;if(t&&e.config.authDomain){yield e.getOrInitRedirectPersistenceManager();const a=null===(n=e.redirectUser)||void 0===n?void 0:n._redirectEventId,c=o?._redirectEventId,l=yield e.tryRedirectSignIn(t);(!a||a===c)&&l?.user&&(o=l.user,s=!0)}if(!o)return e.directlySetCurrentUser(null);if(!o._redirectEventId){if(s)try{yield e.beforeStateQueue.runMiddleware(o)}catch(a){o=i,e._popupRedirectResolver._overrideRedirectResult(e,()=>Promise.reject(a))}return o?e.reloadAndSetCurrentUserOrClear(o):e.directlySetCurrentUser(null)}return Ge(e._popupRedirectResolver,e,"argument-error"),yield e.getOrInitRedirectPersistenceManager(),e.redirectUser&&e.redirectUser._redirectEventId===o._redirectEventId?e.directlySetCurrentUser(o):e.reloadAndSetCurrentUserOrClear(o)})()}tryRedirectSignIn(t){var e=this;return M(function*(){let n=null;try{n=yield e._popupRedirectResolver._completeRedirectFn(e,t,!0)}catch{yield e._setRedirectUser(null)}return n})()}reloadAndSetCurrentUserOrClear(t){var e=this;return M(function*(){try{yield W9(t)}catch(n){if("auth/network-request-failed"!==n?.code)return e.directlySetCurrentUser(null)}return e.directlySetCurrentUser(t)})()}useDeviceLanguage(){this.languageCode=function $Oe(){if(typeof navigator>"u")return null;const r=navigator;return r.languages&&r.languages[0]||r.language||null}()}_delete(){var t=this;return M(function*(){t._deleted=!0})()}updateCurrentUser(t){var e=this;return M(function*(){const n=t?Cr(t):null;return n&&Ge(n.auth.config.apiKey===e.config.apiKey,e,"invalid-user-token"),e._updateCurrentUser(n&&n._clone(e))})()}_updateCurrentUser(t,e=!1){var n=this;return M(function*(){if(!n._deleted)return t&&Ge(n.tenantId===t.tenantId,n,"tenant-id-mismatch"),e||(yield n.beforeStateQueue.runMiddleware(t)),n.queue(M(function*(){yield n.directlySetCurrentUser(t),n.notifyAuthListeners()}))})()}signOut(){var t=this;return M(function*(){return yield t.beforeStateQueue.runMiddleware(null),(t.redirectPersistenceManager||t._popupRedirectResolver)&&(yield t._setRedirectUser(null)),t._updateCurrentUser(null,!0)})()}setPersistence(t){var e=this;return this.queue(M(function*(){yield e.assertedPersistence.setPersistence(W3(t))}))}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(t){var e=this;return M(function*(){e._getPasswordPolicyInternal()||(yield e._updatePasswordPolicy());const n=e._getPasswordPolicyInternal();return n.schemaVersion!==e.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(e._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(t)})()}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){var t=this;return M(function*(){const e=yield function dTe(r){return Jb.apply(this,arguments)}(t),n=new gTe(e);null===t.tenantId?t._projectPasswordPolicy=n:t._tenantPasswordPolicies[t.tenantId]=n})()}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(t){this._errorFactory=new Af("auth","Firebase",t())}onAuthStateChanged(t,e,n){return this.registerStateListener(this.authStateSubscription,t,e,n)}beforeAuthStateChanged(t,e){return this.beforeStateQueue.pushCallback(t,e)}onIdTokenChanged(t,e,n){return this.registerStateListener(this.idTokenSubscription,t,e,n)}authStateReady(){return new Promise((t,e)=>{if(this.currentUser)t();else{const n=this.onAuthStateChanged(()=>{n(),t()},e)}})}revokeAccessToken(t){var e=this;return M(function*(){if(e.currentUser){const n=yield e.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:t,idToken:n};null!=e.tenantId&&(i.tenantId=e.tenantId),yield function aTe(r,t){return Xb.apply(this,arguments)}(e,i)}})()}toJSON(){var t;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(t=this._currentUser)||void 0===t?void 0:t.toJSON()}}_setRedirectUser(t,e){var n=this;return M(function*(){const i=yield n.getOrInitRedirectPersistenceManager(e);return null===t?i.removeCurrentUser():i.setCurrentUser(t)})()}getOrInitRedirectPersistenceManager(t){var e=this;return M(function*(){if(!e.redirectPersistenceManager){const n=t&&W3(t)||e._popupRedirectResolver;Ge(n,e,"argument-error"),e.redirectPersistenceManager=yield W5.create(e,[W3(n._redirectPersistence)],"redirectUser"),e.redirectUser=yield e.redirectPersistenceManager.getCurrentUser()}return e.redirectPersistenceManager})()}_redirectUserForId(t){var e=this;return M(function*(){var n,i;return e._isInitialized&&(yield e.queue(M(function*(){}))),(null===(n=e._currentUser)||void 0===n?void 0:n._redirectEventId)===t?e._currentUser:(null===(i=e.redirectUser)||void 0===i?void 0:i._redirectEventId)===t?e.redirectUser:null})()}_persistUserIfCurrent(t){var e=this;return M(function*(){if(t===e.currentUser)return e.queue(M(function*(){return e.directlySetCurrentUser(t)}))})()}_notifyListenersIfCurrent(t){t===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t,e;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(e=null===(t=this.currentUser)||void 0===t?void 0:t.uid)&&void 0!==e?e:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(t,e,n,i){if(this._deleted)return()=>{};const o="function"==typeof e?e:e.next.bind(e);let s=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ge(a,this,"internal-error"),a.then(()=>{s||o(this.currentUser)}),"function"==typeof e){const c=t.addObserver(e,n,i);return()=>{s=!0,c()}}{const c=t.addObserver(e);return()=>{s=!0,c()}}}directlySetCurrentUser(t){var e=this;return M(function*(){e.currentUser&&e.currentUser!==t&&e._currentUser._stopProactiveRefresh(),t&&e.isProactiveRefreshEnabled&&t._startProactiveRefresh(),e.currentUser=t,t?yield e.assertedPersistence.setCurrentUser(t):yield e.assertedPersistence.removeCurrentUser()})()}queue(t){return this.operations=this.operations.then(t,t),this.operations}get assertedPersistence(){return Ge(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(t){!t||this.frameworks.includes(t)||(this.frameworks.push(t),this.frameworks.sort(),this.clientVersion=jK(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){var t=this;return M(function*(){var e;const n={"X-Client-Version":t.clientVersion};t.app.options.appId&&(n["X-Firebase-gmpid"]=t.app.options.appId);const i=yield null===(e=t.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader();i&&(n["X-Firebase-Client"]=i);const o=yield t._getAppCheckToken();return o&&(n["X-Firebase-AppCheck"]=o),n})()}_getAppCheckToken(){var t=this;return M(function*(){var e;const n=yield null===(e=t.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getToken();return n?.error&&function GOe(r,...t){H_.logLevel<=kn.WARN&&H_.warn(`Auth (${Q8}): ${r}`,...t)}(`Error while retrieving App Check token: ${n.error}`),n?.token})()}}function jr(r){return Cr(r)}class ZK{constructor(t){this.auth=t,this.observer=null,this.addObserver=function Uve(r,t){const e=new Gve(r,t);return e.subscribe.bind(e)}(e=>this.observer=e)}get next(){return Ge(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let j9={loadJS:()=>M(function*(){throw new Error("Unable to load external scripts")})(),recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function eA(r){return j9.loadJS(r)}function YK(r){return`__${r}${Math.floor(1e6*Math.random())}`}class KK{constructor(t){this.type="recaptcha-enterprise",this.auth=jr(t)}verify(t="verify",e=!1){var n=this;return M(function*(){function o(){return o=M(function*(a){if(!e){if(null==a.tenantId&&null!=a._agentRecaptchaConfig)return a._agentRecaptchaConfig.siteKey;if(null!=a.tenantId&&void 0!==a._tenantRecaptchaConfigs[a.tenantId])return a._tenantRecaptchaConfigs[a.tenantId].siteKey}return new Promise(function(){var c=M(function*(l,u){(function LK(r,t){return Ub.apply(this,arguments)})(a,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(f=>{if(void 0!==f.recaptchaKey){const g=new xK(f);return null==a.tenantId?a._agentRecaptchaConfig=g:a._tenantRecaptchaConfigs[a.tenantId]=g,l(g.siteKey)}u(new Error("recaptcha Enterprise site key undefined"))}).catch(f=>{u(f)})});return function(l,u){return c.apply(this,arguments)}}())}),o.apply(this,arguments)}function s(a,c,l){const u=window.grecaptcha;RK(u)?u.enterprise.ready(()=>{u.enterprise.execute(a,{action:t}).then(f=>{c(f)}).catch(()=>{c("NO_RECAPTCHA")})}):l(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((a,c)=>{(function i(a){return o.apply(this,arguments)})(n.auth).then(l=>{if(!e&&RK(window.grecaptcha))s(l,a,c);else{if(typeof window>"u")return void c(new Error("RecaptchaVerifier is only supported in browser"));let u=function CTe(){return j9.recaptchaEnterpriseScript}();0!==u.length&&(u+=l),eA(u).then(()=>{s(l,a,c)}).catch(f=>{c(f)})}}).catch(l=>{c(l)})})})()}}function XK(r,t,e){return tA.apply(this,arguments)}function tA(){return tA=M(function*(r,t,e,n=!1){const i=new KK(r);let o;try{o=yield i.verify(e)}catch{o=yield i.verify(e,!0)}const s=Object.assign({},t);return Object.assign(s,n?{captchaResp:o}:{captchaResponse:o}),Object.assign(s,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(s,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),s}),tA.apply(this,arguments)}function Z9(r,t,e,n){return nA.apply(this,arguments)}function nA(){return nA=M(function*(r,t,e,n){var i;if(null!==(i=r._getRecaptchaConfig())&&void 0!==i&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=yield XK(r,t,e,"getOobCode"===e);return n(r,o)}return n(r,t).catch(function(){var o=M(function*(s){if("auth/missing-recaptcha-token"===s.code){console.log(`${e} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=yield XK(r,t,e,"getOobCode"===e);return n(r,a)}return Promise.reject(s)});return function(s){return o.apply(this,arguments)}}())}),nA.apply(this,arguments)}function QK(r,t,e){const n=jr(r);Ge(n._canInitEmulator,n,"emulator-config-failed"),Ge(/^https?:\/\//.test(t),n,"invalid-emulator-scheme");const i=!!e?.disableWarnings,o=JK(t),{host:s,port:a}=function OTe(r){const t=JK(r),e=/(\/\/)?([^?#/]+)/.exec(r.substr(t.length));if(!e)return{host:"",port:null};const n=e[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){const o=i[1];return{host:o,port:eX(n.substr(o.length+1))}}{const[o,s]=n.split(":");return{host:o,port:eX(s)}}}(t);n.config.emulator={url:`${o}//${s}${null===a?"":`:${a}`}/`},n.settings.appVerificationDisabledForTesting=!0,n.emulatorConfig=Object.freeze({host:s,port:a,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||function TTe(){function r(){const t=document.createElement("p"),e=t.style;t.innerText="Running in emulator mode. Do not use with production credentials.",e.position="fixed",e.width="100%",e.backgroundColor="#ffffff",e.border=".1em solid #000000",e.color="#b50000",e.bottom="0px",e.left="0px",e.margin="0px",e.zIndex="10000",e.textAlign="center",t.classList.add("firebase-emulator-warning"),document.body.appendChild(t)}typeof console<"u"&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",r):r())}()}function JK(r){const t=r.indexOf(":");return t<0?"":r.substr(0,t+1)}function eX(r){if(!r)return null;const t=Number(r);return isNaN(t)?null:t}class Y9{constructor(t,e){this.providerId=t,this.signInMethod=e}toJSON(){return Vc("not implemented")}_getIdTokenResponse(t){return Vc("not implemented")}_linkToIdToken(t,e){return Vc("not implemented")}_getReauthenticationResolver(t){return Vc("not implemented")}}function bTe(r,t){return sA.apply(this,arguments)}function sA(){return sA=M(function*(r,t){return Q1(r,"POST","/v1/accounts:signUp",t)}),sA.apply(this,arguments)}function NTe(r,t){return cA.apply(this,arguments)}function cA(){return cA=M(function*(r,t){return B3(r,"POST","/v1/accounts:signInWithPassword",X1(r,t))}),cA.apply(this,arguments)}function $_(r,t){return lA.apply(this,arguments)}function lA(){return lA=M(function*(r,t){return Q1(r,"POST","/v1/accounts:sendOobCode",X1(r,t))}),lA.apply(this,arguments)}function uA(){return uA=M(function*(r,t){return $_(r,t)}),uA.apply(this,arguments)}function kTe(r,t){return fA.apply(this,arguments)}function fA(){return fA=M(function*(r,t){return $_(r,t)}),fA.apply(this,arguments)}function gA(){return gA=M(function*(r,t){return B3(r,"POST","/v1/accounts:signInWithEmailLink",X1(r,t))}),gA.apply(this,arguments)}function pA(){return pA=M(function*(r,t){return B3(r,"POST","/v1/accounts:signInWithEmailLink",X1(r,t))}),pA.apply(this,arguments)}class K9 extends Y9{constructor(t,e,n,i=null){super("password",n),this._email=t,this._password=e,this._tenantId=i}static _fromEmailAndPassword(t,e){return new K9(t,e,"password")}static _fromEmailAndCode(t,e,n=null){return new K9(t,e,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(t){const e="string"==typeof t?JSON.parse(t):t;if(e?.email&&e?.password){if("password"===e.signInMethod)return this._fromEmailAndPassword(e.email,e.password);if("emailLink"===e.signInMethod)return this._fromEmailAndCode(e.email,e.password,e.tenantId)}return null}_getIdTokenResponse(t){var e=this;return M(function*(){switch(e.signInMethod){case"password":return Z9(t,{returnSecureToken:!0,email:e._email,password:e._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",NTe);case"emailLink":return function LTe(r,t){return gA.apply(this,arguments)}(t,{email:e._email,oobCode:e._password});default:Lo(t,"internal-error")}})()}_linkToIdToken(t,e){var n=this;return M(function*(){switch(n.signInMethod){case"password":return Z9(t,{idToken:e,returnSecureToken:!0,email:n._email,password:n._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",bTe);case"emailLink":return function zTe(r,t){return pA.apply(this,arguments)}(t,{idToken:e,email:n._email,oobCode:n._password});default:Lo(t,"internal-error")}})()}_getReauthenticationResolver(t){return this._getIdTokenResponse(t)}}function q3(r,t){return mA.apply(this,arguments)}function mA(){return mA=M(function*(r,t){return B3(r,"POST","/v1/accounts:signInWithIdp",X1(r,t))}),mA.apply(this,arguments)}class q5 extends Y9{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(t){const e=new q5(t.providerId,t.signInMethod);return t.idToken||t.accessToken?(t.idToken&&(e.idToken=t.idToken),t.accessToken&&(e.accessToken=t.accessToken),t.nonce&&!t.pendingToken&&(e.nonce=t.nonce),t.pendingToken&&(e.pendingToken=t.pendingToken)):t.oauthToken&&t.oauthTokenSecret?(e.accessToken=t.oauthToken,e.secret=t.oauthTokenSecret):Lo("argument-error"),e}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(t){const e="string"==typeof t?JSON.parse(t):t,{providerId:n,signInMethod:i}=e,o=mp(e,["providerId","signInMethod"]);if(!n||!i)return null;const s=new q5(n,i);return s.idToken=o.idToken||void 0,s.accessToken=o.accessToken||void 0,s.secret=o.secret,s.nonce=o.nonce,s.pendingToken=o.pendingToken||null,s}_getIdTokenResponse(t){return q3(t,this.buildRequest())}_linkToIdToken(t,e){const n=this.buildRequest();return n.idToken=e,q3(t,n)}_getReauthenticationResolver(t){const e=this.buildRequest();return e.autoCreate=!1,q3(t,e)}buildRequest(){const t={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)t.pendingToken=this.pendingToken;else{const e={};this.idToken&&(e.id_token=this.idToken),this.accessToken&&(e.access_token=this.accessToken),this.secret&&(e.oauth_token_secret=this.secret),e.providerId=this.providerId,this.nonce&&!this.pendingToken&&(e.nonce=this.nonce),t.postBody=Nf(e)}return t}}class Q9{constructor(t){var e,n,i,o,s,a;const c=If(kf(t)),l=null!==(e=c.apiKey)&&void 0!==e?e:null,u=null!==(n=c.oobCode)&&void 0!==n?n:null,f=function BTe(r){switch(r){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(i=c.mode)&&void 0!==i?i:null);Ge(l&&u&&f,"argument-error"),this.apiKey=l,this.operation=f,this.code=u,this.continueUrl=null!==(o=c.continueUrl)&&void 0!==o?o:null,this.languageCode=null!==(s=c.languageCode)&&void 0!==s?s:null,this.tenantId=null!==(a=c.tenantId)&&void 0!==a?a:null}static parseLink(t){const e=function $Te(r){const t=If(kf(r)).link,e=t?If(kf(t)).deep_link_id:null,n=If(kf(r)).deep_link_id;return(n?If(kf(n)).link:null)||n||e||t||r}(t);try{return new Q9(e)}catch{return null}}}let nX=(()=>{class r{constructor(){this.providerId=r.PROVIDER_ID}static credential(e,n){return K9._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const i=Q9.parseLink(n);return Ge(i,"argument-error"),K9._fromEmailAndCode(e,i.code,i.tenantId)}}return r.PROVIDER_ID="password",r.EMAIL_PASSWORD_SIGN_IN_METHOD="password",r.EMAIL_LINK_SIGN_IN_METHOD="emailLink",r})();class j3{constructor(t){this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(t){this.defaultLanguageCode=t}setCustomParameters(t){return this.customParameters=t,this}getCustomParameters(){return this.customParameters}}class rX extends j3{constructor(){super(...arguments),this.scopes=[]}addScope(t){return this.scopes.includes(t)||this.scopes.push(t),this}getScopes(){return[...this.scopes]}}let WTe=(()=>{class r extends rX{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return q5._fromParams({providerId:r.PROVIDER_ID,signInMethod:r.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return r.credentialFromTaggedObject(e)}static credentialFromError(e){return r.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:i}=e;if(!n&&!i)return null;try{return r.credential(n,i)}catch{return null}}}return r.GOOGLE_SIGN_IN_METHOD="google.com",r.PROVIDER_ID="google.com",r})();function iX(r,t){return EA.apply(this,arguments)}function EA(){return EA=M(function*(r,t){return B3(r,"POST","/v1/accounts:signUp",X1(r,t))}),EA.apply(this,arguments)}class qs{constructor(t){this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}static _fromIdTokenResponse(t,e,n,i=!1){return M(function*(){const o=yield Y6._fromIdTokenResponse(t,n,i),s=oX(n);return new qs({user:o,providerId:s,_tokenResponse:n,operationType:e})})()}static _forOperation(t,e,n){return M(function*(){yield t._updateTokensIfNecessary(n,!0);const i=oX(n);return new qs({user:t,providerId:i,_tokenResponse:n,operationType:e})})()}}function oX(r){return r.providerId?r.providerId:"phoneNumber"in r?"phone":null}class q_ extends bc{constructor(t,e,n,i){var o;super(e.code,e.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,q_.prototype),this.customData={appName:t.name,tenantId:null!==(o=t.tenantId)&&void 0!==o?o:void 0,_serverResponse:e.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(t,e,n,i){return new q_(t,e,n,i)}}function sX(r,t,e,n){return("reauthenticate"===t?e._getReauthenticationResolver(r):e._getIdTokenResponse(r)).catch(o=>{throw"auth/multi-factor-auth-required"===o.code?q_._fromErrorAndOperation(r,o,t,n):o})}function TA(){return TA=M(function*(r,t,e=!1){const n=yield $3(r,t._linkToIdToken(r.auth,yield r.getIdToken()),e);return qs._forOperation(r,"link",n)}),TA.apply(this,arguments)}function bA(){return bA=M(function*(r,t,e=!1){const{auth:n}=r,i="reauthenticate";try{const o=yield $3(r,sX(n,i,t,r),e);Ge(o.idToken,n,"internal-error");const s=U_(o.idToken);Ge(s,n,"internal-error");const{sub:a}=s;return Ge(r.uid===a,n,"user-mismatch"),qs._forOperation(r,i,o)}catch(o){throw"auth/user-not-found"===o?.code&&Lo(n,"user-mismatch"),o}}),bA.apply(this,arguments)}function lX(r,t){return AA.apply(this,arguments)}function AA(){return AA=M(function*(r,t,e=!1){const n="signIn",i=yield sX(r,n,t),o=yield qs._fromIdTokenResponse(r,n,i);return e||(yield r._updateCurrentUser(o.user)),o}),AA.apply(this,arguments)}function IA(){return IA=M(function*(r,t){return lX(jr(r),t)}),IA.apply(this,arguments)}function Z_(r,t,e){var n;Ge((null===(n=e.url)||void 0===n?void 0:n.length)>0,r,"invalid-continue-uri"),Ge(typeof e.dynamicLinkDomain>"u"||e.dynamicLinkDomain.length>0,r,"invalid-dynamic-link-domain"),t.continueUrl=e.url,t.dynamicLinkDomain=e.dynamicLinkDomain,t.canHandleCodeInApp=e.handleCodeInApp,e.iOS&&(Ge(e.iOS.bundleId.length>0,r,"missing-ios-bundle-id"),t.iOSBundleId=e.iOS.bundleId),e.android&&(Ge(e.android.packageName.length>0,r,"missing-android-pkg-name"),t.androidInstallApp=e.android.installApp,t.androidMinimumVersionCode=e.android.minimumVersion,t.androidPackageName=e.android.packageName)}function VA(r){return HA.apply(this,arguments)}function HA(){return HA=M(function*(r){const t=jr(r);t._getPasswordPolicyInternal()&&(yield t._updatePasswordPolicy())}),HA.apply(this,arguments)}function FA(){return FA=M(function*(r,t,e){const n=jr(r),i={requestType:"PASSWORD_RESET",email:t,clientType:"CLIENT_TYPE_WEB"};e&&Z_(n,i,e),yield Z9(n,i,"getOobCode",kTe)}),FA.apply(this,arguments)}function WA(){return WA=M(function*(r,t,e){const n=jr(r),s=yield Z9(n,{returnSecureToken:!0,email:t,password:e,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",iX).catch(c=>{throw"auth/password-does-not-meet-requirements"===c.code&&VA(r),c}),a=yield qs._fromIdTokenResponse(n,"signIn",s);return yield n._updateCurrentUser(a.user),a}),WA.apply(this,arguments)}function KA(){return KA=M(function*(r,t){const e=Cr(r),i={requestType:"VERIFY_EMAIL",idToken:yield r.getIdToken()};t&&Z_(e.auth,i,t);const{email:o}=yield function ITe(r,t){return uA.apply(this,arguments)}(e.auth,i);o!==r.email&&(yield r.reload())}),KA.apply(this,arguments)}function QA(){return QA=M(function*(r,t){return Q1(r,"POST","/v1/accounts:update",t)}),QA.apply(this,arguments)}function JA(){return JA=M(function*(r,{displayName:t,photoURL:e}){if(void 0===t&&void 0===e)return;const n=Cr(r),o={idToken:yield n.getIdToken(),displayName:t,photoUrl:e,returnSecureToken:!0},s=yield $3(n,function rwe(r,t){return QA.apply(this,arguments)}(n.auth,o));n.displayName=s.displayName||null,n.photoURL=s.photoUrl||null;const a=n.providerData.find(({providerId:c})=>"password"===c);a&&(a.displayName=n.displayName,a.photoURL=n.photoURL),yield n._updateTokensIfNecessary(s)}),JA.apply(this,arguments)}const Y_="__sak";class dX{constructor(t,e){this.storageRetriever=t,this.type=e}_isAvailable(){try{return this.storage?(this.storage.setItem(Y_,"1"),this.storage.removeItem(Y_),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(t,e){return this.storage.setItem(t,JSON.stringify(e)),Promise.resolve()}_get(t){const e=this.storage.getItem(t);return Promise.resolve(e?JSON.parse(e):null)}_remove(t){return this.storage.removeItem(t),Promise.resolve()}get storage(){return this.storageRetriever()}}const ywe=(()=>{class r extends dX{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function _we(){const r=Or();return Qb(r)||B_(r)}()&&function uTe(){try{return!(!window||window===window.top)}catch{return!1}}(),this.fallbackToPolling=qK(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const i=this.storage.getItem(n),o=this.localCache[n];i!==o&&e(n,o,i)}}onStorageEvent(e,n=!1){if(!e.key)return void this.forAllChangedKeys((a,c,l)=>{this.notifyListeners(a,l)});const i=e.key;if(n?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const a=this.storage.getItem(i);if(e.newValue!==a)null!==e.newValue?this.storage.setItem(i,e.newValue):this.storage.removeItem(i);else if(this.localCache[i]===e.newValue&&!n)return}const o=()=>{const a=this.storage.getItem(i);!n&&this.localCache[i]===a||this.notifyListeners(i,a)},s=this.storage.getItem(i);!function lTe(){return function Lve(){const r=Or();return r.indexOf("MSIE ")>=0||r.indexOf("Trident/")>=0}()&&10===document.documentMode}()||s===e.newValue||e.newValue===e.oldValue?o():setTimeout(o,10)}notifyListeners(e,n){this.localCache[e]=n;const i=this.listeners[e];if(i)for(const o of Array.from(i))o(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:i}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}_set(e,n){var i=()=>super._set,o=this;return M(function*(){yield i().call(o,e,n),o.localCache[e]=JSON.stringify(n)})()}_get(e){var n=()=>super._get,i=this;return M(function*(){const o=yield n().call(i,e);return i.localCache[e]=JSON.stringify(o),o})()}_remove(e){var n=()=>super._remove,i=this;return M(function*(){yield n().call(i,e),delete i.localCache[e]})()}}return r.type="LOCAL",r})(),hX=(()=>{class r extends dX{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}return r.type="SESSION",r})();let Ewe=(()=>{class r{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(o=>o.isListeningto(e));if(n)return n;const i=new r(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}handleEvent(e){var n=this;return M(function*(){const i=e,{eventId:o,eventType:s,data:a}=i.data,c=n.handlersMap[s];if(!c?.size)return;i.ports[0].postMessage({status:"ack",eventId:o,eventType:s});const l=Array.from(c).map(function(){var f=M(function*(g){return g(i.origin,a)});return function(g){return f.apply(this,arguments)}}()),u=yield function Mwe(r){return Promise.all(r.map(function(){var t=M(function*(e){try{return{fulfilled:!0,value:yield e}}catch(n){return{fulfilled:!1,reason:n}}});return function(e){return t.apply(this,arguments)}}()))}(l);i.ports[0].postMessage({status:"done",eventId:o,eventType:s,response:u})})()}_subscribe(e,n){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||0===this.handlersMap[e].size)&&delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}return r.receivers=[],r})();function K_(r="",t=10){let e="";for(let n=0;n<t;n++)e+=Math.floor(10*Math.random());return r+e}class Pwe{constructor(t){this.target=t,this.handlers=new Set}removeMessageHandler(t){t.messageChannel&&(t.messageChannel.port1.removeEventListener("message",t.onMessage),t.messageChannel.port1.close()),this.handlers.delete(t)}_send(t,e,n=50){var i=this;return M(function*(){const o=typeof MessageChannel<"u"?new MessageChannel:null;if(!o)throw new Error("connection_unavailable");let s,a;return new Promise((c,l)=>{const u=K_("",20);o.port1.start();const f=setTimeout(()=>{l(new Error("unsupported_event"))},n);a={messageChannel:o,onMessage(g){const y=g;if(y.data.eventId===u)switch(y.data.status){case"ack":clearTimeout(f),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),c(y.data.response);break;default:clearTimeout(f),clearTimeout(s),l(new Error("invalid_response"))}}},i.handlers.add(a),o.port1.addEventListener("message",a.onMessage),i.target.postMessage({eventType:t,eventId:u,data:e},[o.port2])}).finally(()=>{a&&i.removeMessageHandler(a)})})()}}function ai(){return window}function sN(){return typeof ai().WorkerGlobalScope<"u"&&"function"==typeof ai().importScripts}function aN(){return(aN=M(function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})).apply(this,arguments)}const gX="firebaseLocalStorageDb",X_="firebaseLocalStorage",pX="fbase_key";class td{constructor(t){this.request=t}toPromise(){return new Promise((t,e)=>{this.request.addEventListener("success",()=>{t(this.request.result)}),this.request.addEventListener("error",()=>{e(this.request.error)})})}}function Q_(r,t){return r.transaction([X_],t?"readwrite":"readonly").objectStore(X_)}function cN(){const r=indexedDB.open(gX,1);return new Promise((t,e)=>{r.addEventListener("error",()=>{e(r.error)}),r.addEventListener("upgradeneeded",()=>{const n=r.result;try{n.createObjectStore(X_,{keyPath:pX})}catch(i){e(i)}}),r.addEventListener("success",M(function*(){const n=r.result;n.objectStoreNames.contains(X_)?t(n):(n.close(),yield function Awe(){const r=indexedDB.deleteDatabase(gX);return new td(r).toPromise()}(),t(yield cN()))}))})}function mX(r,t,e){return lN.apply(this,arguments)}function lN(){return lN=M(function*(r,t,e){const n=Q_(r,!0).put({[pX]:t,value:e});return new td(n).toPromise()}),lN.apply(this,arguments)}function uN(){return uN=M(function*(r,t){const e=Q_(r,!1).get(t),n=yield new td(e).toPromise();return void 0===n?null:n.value}),uN.apply(this,arguments)}function _X(r,t){const e=Q_(r,!0).delete(t);return new td(e).toPromise()}const Rwe=(()=>{class r{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){var e=this;return M(function*(){return e.db||(e.db=yield cN()),e.db})()}_withRetries(e){var n=this;return M(function*(){let i=0;for(;;)try{const o=yield n._openDb();return yield e(o)}catch(o){if(i++>3)throw o;n.db&&(n.db.close(),n.db=void 0)}})()}initializeServiceWorkerMessaging(){var e=this;return M(function*(){return sN()?e.initializeReceiver():e.initializeSender()})()}initializeReceiver(){var e=this;return M(function*(){e.receiver=Ewe._getInstance(function wwe(){return sN()?self:null}()),e.receiver._subscribe("keyChanged",function(){var n=M(function*(i,o){return{keyProcessed:(yield e._poll()).includes(o.key)}});return function(i,o){return n.apply(this,arguments)}}()),e.receiver._subscribe("ping",function(){var n=M(function*(i,o){return["keyChanged"]});return function(i,o){return n.apply(this,arguments)}}())})()}initializeSender(){var e=this;return M(function*(){var n,i;if(e.activeServiceWorker=yield function Owe(){return aN.apply(this,arguments)}(),!e.activeServiceWorker)return;e.sender=new Pwe(e.activeServiceWorker);const o=yield e.sender._send("ping",{},800);o&&null!==(n=o[0])&&void 0!==n&&n.fulfilled&&null!==(i=o[0])&&void 0!==i&&i.value.includes("keyChanged")&&(e.serviceWorkerReceiverAvailable=!0)})()}notifyServiceWorker(e){var n=this;return M(function*(){if(n.sender&&n.activeServiceWorker&&function Twe(){var r;return(null===(r=navigator?.serviceWorker)||void 0===r?void 0:r.controller)||null}()===n.activeServiceWorker)try{yield n.sender._send("keyChanged",{key:e},n.serviceWorkerReceiverAvailable?800:50)}catch{}})()}_isAvailable(){return M(function*(){try{if(!indexedDB)return!1;const e=yield cN();return yield mX(e,Y_,"1"),yield _X(e,Y_),!0}catch{}return!1})()}_withPendingWrite(e){var n=this;return M(function*(){n.pendingWrites++;try{yield e()}finally{n.pendingWrites--}})()}_set(e,n){var i=this;return M(function*(){return i._withPendingWrite(M(function*(){return yield i._withRetries(o=>mX(o,e,n)),i.localCache[e]=n,i.notifyServiceWorker(e)}))})()}_get(e){var n=this;return M(function*(){const i=yield n._withRetries(o=>function Nwe(r,t){return uN.apply(this,arguments)}(o,e));return n.localCache[e]=i,i})()}_remove(e){var n=this;return M(function*(){return n._withPendingWrite(M(function*(){return yield n._withRetries(i=>_X(i,e)),delete n.localCache[e],n.notifyServiceWorker(e)}))})()}_poll(){var e=this;return M(function*(){const n=yield e._withRetries(s=>{const a=Q_(s,!1).getAll();return new td(a).toPromise()});if(!n)return[];if(0!==e.pendingWrites)return[];const i=[],o=new Set;if(0!==n.length)for(const{fbase_key:s,value:a}of n)o.add(s),JSON.stringify(e.localCache[s])!==JSON.stringify(a)&&(e.notifyListeners(s,a),i.push(s));for(const s of Object.keys(e.localCache))e.localCache[s]&&!o.has(s)&&(e.notifyListeners(s,null),i.push(s));return i})()}notifyListeners(e,n){this.localCache[e]=n;const i=this.listeners[e];if(i)for(const o of Array.from(i))o(n)}startPolling(){var e=this;this.stopPolling(),this.pollTimer=setInterval(M(function*(){return e._poll()}),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}return r.type="LOCAL",r})();function X6(r,t){return t?W3(t):(Ge(r._popupRedirectResolver,r,"argument-error"),r._popupRedirectResolver)}YK("rcb"),new G9(3e4,6e4);class vN extends Y9{constructor(t){super("custom","custom"),this.params=t}_getIdTokenResponse(t){return q3(t,this._buildIdpRequest())}_linkToIdToken(t,e){return q3(t,this._buildIdpRequest(e))}_getReauthenticationResolver(t){return q3(t,this._buildIdpRequest())}_buildIdpRequest(t){const e={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return t&&(e.idToken=t),e}}function Zwe(r){return lX(r.auth,new vN(r),r.bypassAuthState)}function Ywe(r){const{auth:t,user:e}=r;return Ge(e,t,"internal-error"),function cX(r,t){return bA.apply(this,arguments)}(e,new vN(r),r.bypassAuthState)}function Kwe(r){return yN.apply(this,arguments)}function yN(){return yN=M(function*(r){const{auth:t,user:e}=r;return Ge(e,t,"internal-error"),function OA(r,t){return TA.apply(this,arguments)}(e,new vN(r),r.bypassAuthState)}),yN.apply(this,arguments)}class vX{constructor(t,e,n,i,o=!1){this.auth=t,this.resolver=n,this.user=i,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(e)?e:[e]}execute(){var t=this;return new Promise(function(){var e=M(function*(n,i){t.pendingPromise={resolve:n,reject:i};try{t.eventManager=yield t.resolver._initialize(t.auth),yield t.onExecution(),t.eventManager.registerConsumer(t)}catch(o){t.reject(o)}});return function(n,i){return e.apply(this,arguments)}}())}onAuthEvent(t){var e=this;return M(function*(){const{urlResponse:n,sessionId:i,postBody:o,tenantId:s,error:a,type:c}=t;if(a)return void e.reject(a);const l={auth:e.auth,requestUri:n,sessionId:i,tenantId:s||void 0,postBody:o||void 0,user:e.user,bypassAuthState:e.bypassAuthState};try{e.resolve(yield e.getIdpTask(c)(l))}catch(u){e.reject(u)}})()}onError(t){this.reject(t)}getIdpTask(t){switch(t){case"signInViaPopup":case"signInViaRedirect":return Zwe;case"linkViaPopup":case"linkViaRedirect":return Kwe;case"reauthViaPopup":case"reauthViaRedirect":return Ywe;default:Lo(this.auth,"internal-error")}}resolve(t){G3(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(t),this.unregisterAndCleanUp()}reject(t){G3(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(t),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Xwe=new G9(2e3,1e4);function MN(){return MN=M(function*(r,t,e){const n=jr(r);!function $5(r,t,e){if(!(t instanceof e))throw e.name!==t.constructor.name&&Lo(r,"argument-error"),wK(r,"argument-error",`Type of ${t.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}(r,t,j3);const i=X6(n,e);return new SN(n,"signInViaPopup",t,i).executeNotNull()}),MN.apply(this,arguments)}let SN=(()=>{class r extends vX{constructor(e,n,i,o,s){super(e,n,o,s),this.provider=i,this.authWindow=null,this.pollId=null,r.currentPopupAction&&r.currentPopupAction.cancel(),r.currentPopupAction=this}executeNotNull(){var e=this;return M(function*(){const n=yield e.execute();return Ge(n,e.auth,"internal-error"),n})()}onExecution(){var e=this;return M(function*(){G3(1===e.filter.length,"Popup operations only handle one event");const n=K_();e.authWindow=yield e.resolver._openPopup(e.auth,e.provider,e.filter[0],n),e.authWindow.associatedEvent=n,e.resolver._originValidation(e.auth).catch(i=>{e.reject(i)}),e.resolver._isIframeWebStorageSupported(e.auth,i=>{i||e.reject(gs(e.auth,"web-storage-unsupported"))}),e.pollUserCancellation()})()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(gs(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,r.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,i;this.pollId=null!==(i=null===(n=this.authWindow)||void 0===n?void 0:n.window)&&void 0!==i&&i.closed?window.setTimeout(()=>{this.pollId=null,this.reject(gs(this.auth,"popup-closed-by-user"))},8e3):window.setTimeout(e,Xwe.get())};e()}}return r.currentPopupAction=null,r})();const Jwe="pendingRedirect",nd=new Map;class ebe extends vX{constructor(t,e,n=!1){super(t,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],e,void 0,n),this.eventId=null}execute(){var t=()=>super.execute,e=this;return M(function*(){let n=nd.get(e.auth._key());if(!n){try{const o=(yield function tbe(r,t){return ON.apply(this,arguments)}(e.resolver,e.auth))?yield t().call(e):null;n=()=>Promise.resolve(o)}catch(i){n=()=>Promise.reject(i)}nd.set(e.auth._key(),n)}return e.bypassAuthState||nd.set(e.auth._key(),()=>Promise.resolve(null)),n()})()}onAuthEvent(t){var e=()=>super.onAuthEvent,n=this;return M(function*(){if("signInViaRedirect"===t.type)return e().call(n,t);if("unknown"!==t.type){if(t.eventId){const i=yield n.auth._redirectUserForId(t.eventId);if(i)return n.user=i,e().call(n,t);n.resolve(null)}}else n.resolve(null)})()}onExecution(){return M(function*(){})()}cleanUp(){}}function ON(){return ON=M(function*(r,t){const e=function MX(r){return G_(Jwe,r.config.apiKey,r.name)}(t),n=function yX(r){return W3(r._redirectPersistence)}(r);if(!(yield n._isAvailable()))return!1;const i="true"===(yield n._get(e));return yield n._remove(e),i}),ON.apply(this,arguments)}function nbe(r,t){nd.set(r._key(),t)}function EX(r,t){return kN.apply(this,arguments)}function kN(){return kN=M(function*(r,t,e=!1){const n=jr(r),i=X6(n,t),s=yield new ebe(n,i,e).execute();return s&&!e&&(delete s.user._redirectEventId,yield n._persistUserIfCurrent(s.user),yield n._setRedirectUser(null,t)),s}),kN.apply(this,arguments)}class abe{constructor(t){this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(t){this.consumers.add(t),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,t)&&(this.sendToConsumer(this.queuedRedirectEvent,t),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(t){this.consumers.delete(t)}onEvent(t){if(this.hasEventBeenHandled(t))return!1;let e=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(t,n)&&(e=!0,this.sendToConsumer(t,n),this.saveEventToCache(t))}),this.hasHandledPotentialRedirect||!function cbe(r){switch(r.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return OX(r);default:return!1}}(t)||(this.hasHandledPotentialRedirect=!0,e||(this.queuedRedirectEvent=t,e=!0)),e}sendToConsumer(t,e){var n;if(t.error&&!OX(t)){const i=(null===(n=t.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";e.onError(gs(this.auth,i))}else e.onAuthEvent(t)}isEventForConsumer(t,e){const n=null===e.eventId||!!t.eventId&&t.eventId===e.eventId;return e.filter.includes(t.type)&&n}hasEventBeenHandled(t){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(SX(t))}saveEventToCache(t){this.cachedEventUids.add(SX(t)),this.lastProcessedEventTime=Date.now()}}function SX(r){return[r.type,r.eventId,r.sessionId,r.tenantId].filter(t=>t).join("-")}function OX({type:r,error:t}){return"unknown"===r&&"auth/no-auth-event"===t?.code}function xN(){return xN=M(function*(r,t={}){return Q1(r,"GET","/v1/projects",t)}),xN.apply(this,arguments)}const ube=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,fbe=/^https?/;function LN(){return LN=M(function*(r){if(r.config.emulator)return;const{authorizedDomains:t}=yield function lbe(r){return xN.apply(this,arguments)}(r);for(const e of t)try{if(hbe(e))return}catch{}Lo(r,"unauthorized-domain")}),LN.apply(this,arguments)}function hbe(r){const t=U9(),{protocol:e,hostname:n}=new URL(t);if(r.startsWith("chrome-extension://")){const s=new URL(r);return""===s.hostname&&""===n?"chrome-extension:"===e&&r.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===e&&s.hostname===n}if(!fbe.test(e))return!1;if(ube.test(r))return n===r;const i=r.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}const gbe=new G9(3e4,6e4);function TX(){const r=ai().___jsl;if(r?.H)for(const t of Object.keys(r.H))if(r.H[t].r=r.H[t].r||[],r.H[t].L=r.H[t].L||[],r.H[t].r=[...r.H[t].L],r.CP)for(let e=0;e<r.CP.length;e++)r.CP[e]=null}let eC=null;const _be=new G9(5e3,15e3),Cbe="__/auth/iframe",vbe="emulator/auth/iframe",ybe={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Mbe=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Ebe(r){const t=r.config;Ge(t.authDomain,r,"auth-domain-config-required");const e=t.emulator?zb(t,vbe):`https://${r.config.authDomain}/${Cbe}`,n={apiKey:t.apiKey,appName:r.name,v:Q8},i=Mbe.get(r.config.apiHost);i&&(n.eid=i);const o=r._getFrameworks();return o.length&&(n.fw=o.join(",")),`${e}?${Nf(n).slice(1)}`}function zN(){return zN=M(function*(r){const t=yield function mbe(r){return eC=eC||function pbe(r){return new Promise((t,e)=>{var n,i,o;function s(){TX(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{TX(),e(gs(r,"network-request-failed"))},timeout:gbe.get()})}if(null!==(i=null===(n=ai().gapi)||void 0===n?void 0:n.iframes)&&void 0!==i&&i.Iframe)t(gapi.iframes.getContext());else{if(null===(o=ai().gapi)||void 0===o||!o.load){const a=YK("iframefcb");return ai()[a]=()=>{gapi.load?s():e(gs(r,"network-request-failed"))},eA(`${function vTe(){return j9.gapiScript}()}?onload=${a}`).catch(c=>e(c))}s()}}).catch(t=>{throw eC=null,t})}(r),eC}(r),e=ai().gapi;return Ge(e,r,"internal-error"),t.open({where:document.body,url:Ebe(r),messageHandlersFilter:e.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:ybe,dontclear:!0},n=>new Promise(function(){var i=M(function*(o,s){yield n.restyle({setHideOnLeave:!1});const a=gs(r,"network-request-failed"),c=ai().setTimeout(()=>{s(a)},_be.get());function l(){ai().clearTimeout(c),o(n)}n.ping(l).then(l,()=>{s(a)})});return function(o,s){return i.apply(this,arguments)}}()))}),zN.apply(this,arguments)}const Sbe={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class wX{constructor(t){this.window=t,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}const Ibe="__/auth/handler",kbe="emulator/auth/handler",Rbe=encodeURIComponent("fac");function bX(r,t,e,n,i,o){return DN.apply(this,arguments)}function DN(){return DN=M(function*(r,t,e,n,i,o){Ge(r.config.authDomain,r,"auth-domain-config-required"),Ge(r.config.apiKey,r,"invalid-api-key");const s={apiKey:r.config.apiKey,appName:r.name,authType:e,redirectUrl:n,v:Q8,eventId:i};if(t instanceof j3){t.setDefaultLanguage(r.languageCode),s.providerId=t.providerId||"",function Fve(r){for(const t in r)if(Object.prototype.hasOwnProperty.call(r,t))return!1;return!0}(t.getCustomParameters())||(s.customParameters=JSON.stringify(t.getCustomParameters()));for(const[u,f]of Object.entries(o||{}))s[u]=f}if(t instanceof rX){const u=t.getScopes().filter(f=>""!==f);u.length>0&&(s.scopes=u.join(","))}r.tenantId&&(s.tid=r.tenantId);const a=s;for(const u of Object.keys(a))void 0===a[u]&&delete a[u];const c=yield r._getAppCheckToken(),l=c?`#${Rbe}=${encodeURIComponent(c)}`:"";return`${function xbe({config:r}){return r.emulator?zb(r,kbe):`https://${r.authDomain}/${Ibe}`}(r)}?${Nf(a).slice(1)}${l}`}),DN.apply(this,arguments)}const VN="webStorageSupport",zbe=class Lbe{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=hX,this._completeRedirectFn=EX,this._overrideRedirectResult=nbe}_openPopup(t,e,n,i){var o=this;return M(function*(){var s;G3(null===(s=o.eventManagers[t._key()])||void 0===s?void 0:s.manager,"_initialize() not called before _openPopup()");const a=yield bX(t,e,n,U9(),i);return function Abe(r,t,e,n=500,i=600){const o=Math.max((window.screen.availHeight-i)/2,0).toString(),s=Math.max((window.screen.availWidth-n)/2,0).toString();let a="";const c=Object.assign(Object.assign({},Sbe),{width:n.toString(),height:i.toString(),top:o,left:s}),l=Or().toLowerCase();e&&(a=UK(l)?"_blank":e),FK(l)&&(t=t||"http://localhost",c.scrollbars="yes");const u=Object.entries(c).reduce((g,[y,S])=>`${g}${y}=${S},`,"");if(function cTe(r=Or()){var t;return B_(r)&&!(null===(t=window.navigator)||void 0===t||!t.standalone)}(l)&&"_self"!==a)return function Nbe(r,t){const e=document.createElement("a");e.href=r,e.target=t;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),e.dispatchEvent(n)}(t||"",a),new wX(null);const f=window.open(t||"",a,u);Ge(f,r,"popup-blocked");try{f.focus()}catch{}return new wX(f)}(t,a,K_())})()}_openRedirect(t,e,n,i){var o=this;return M(function*(){return yield o._originValidation(t),function Swe(r){ai().location.href=r}(yield bX(t,e,n,U9(),i)),new Promise(()=>{})})()}_initialize(t){const e=t._key();if(this.eventManagers[e]){const{manager:i,promise:o}=this.eventManagers[e];return i?Promise.resolve(i):(G3(o,"If manager is not set, promise should be"),o)}const n=this.initAndGetManager(t);return this.eventManagers[e]={promise:n},n.catch(()=>{delete this.eventManagers[e]}),n}initAndGetManager(t){var e=this;return M(function*(){const n=yield function Pbe(r){return zN.apply(this,arguments)}(t),i=new abe(t);return n.register("authEvent",o=>(Ge(o?.authEvent,t,"invalid-auth-event"),{status:i.onEvent(o.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),e.eventManagers[t._key()]={manager:i},e.iframes[t._key()]=n,i})()}_isIframeWebStorageSupported(t,e){this.iframes[t._key()].send(VN,{type:VN},i=>{var o;const s=null===(o=i?.[0])||void 0===o?void 0:o[VN];void 0!==s&&e(!!s),Lo(t,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(t){const e=t._key();return this.originValidationPromises[e]||(this.originValidationPromises[e]=function dbe(r){return LN.apply(this,arguments)}(t)),this.originValidationPromises[e]}get _shouldInitProactively(){return qK()||Qb()||B_()}};var kX="@firebase/auth";class Dbe{constructor(t){this.auth=t,this.internalListeners=new Map}getUid(){var t;return this.assertAuthConfigured(),(null===(t=this.auth.currentUser)||void 0===t?void 0:t.uid)||null}getToken(t){var e=this;return M(function*(){return e.assertAuthConfigured(),yield e.auth._initializationPromise,e.auth.currentUser?{accessToken:yield e.auth.currentUser.getIdToken(t)}:null})()}addAuthTokenListener(t){if(this.assertAuthConfigured(),this.internalListeners.has(t))return;const e=this.auth.onIdTokenChanged(n=>{t(n?.stsTokenManager.accessToken||null)});this.internalListeners.set(t,e),this.updateProactiveRefresh()}removeAuthTokenListener(t){this.assertAuthConfigured();const e=this.internalListeners.get(t);e&&(this.internalListeners.delete(t),e(),this.updateProactiveRefresh())}assertAuthConfigured(){Ge(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const Ube=EW("authIdTokenMaxAge")||300;let xX=null;const Gbe=r=>function(){var t=M(function*(e){const n=e&&(yield e.getIdTokenResult()),i=n&&((new Date).getTime()-Date.parse(n.issuedAtTime))/1e3;if(i&&i>Ube)return;const o=n?.token;xX!==o&&(xX=o,yield fetch(r,{method:o?"POST":"DELETE",headers:o?{Authorization:`Bearer ${o}`}:{}}))});return function(e){return t.apply(this,arguments)}}();function LX(r=zW()){const t=_m(r,"auth");if(t.isInitialized())return t.getImmediate();const e=function PTe(r,t){const e=_m(r,"auth");if(e.isInitialized()){const i=e.getImmediate();if(K8(e.getOptions(),t??{}))return i;Lo(i,"already-initialized")}return e.initialize({options:t})}(r,{popupRedirectResolver:zbe,persistence:[Rwe,ywe,hX]}),n=EW("authTokenSyncURL");if(n){const o=Gbe(n);(function fwe(r,t,e){Cr(r).beforeAuthStateChanged(t,e)})(e,o,()=>o(e.currentUser)),function uwe(r,t,e,n){Cr(r).onIdTokenChanged(t,e,n)}(e,s=>o(s))}const i=yW("auth");return i&&QK(e,`http://${i}`),e}(function mTe(r){j9=r})({loadJS:r=>new Promise((t,e)=>{const n=document.createElement("script");n.setAttribute("src",r),n.onload=t,n.onerror=i=>{const o=gs("internal-error");o.customData=i,e(o)},n.type="text/javascript",n.charset="UTF-8",function Bbe(){var r,t;return null!==(t=null===(r=document.getElementsByTagName("head"))||void 0===r?void 0:r[0])&&void 0!==t?t:document}().appendChild(n)}),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="}),function Hbe(r){X8(new v6("auth",(t,{options:e})=>{const n=t.getProvider("app").getImmediate(),i=t.getProvider("heartbeat"),o=t.getProvider("app-check-internal"),{apiKey:s,authDomain:a}=n.options;Ge(s&&!s.includes(":"),"invalid-api-key",{appName:n.name});const c={apiKey:s,authDomain:a,clientPlatform:r,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:jK(r)},l=new pTe(n,i,o,c);return function STe(r,t){const e=t?.persistence||[],n=(Array.isArray(e)?e:[e]).map(W3);t?.errorMap&&r._updateErrorMap(t.errorMap),r._initializeWithPersistence(n,t?.popupRedirectResolver)}(l,e),l},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,e,n)=>{t.getProvider("auth-internal").initialize()})),X8(new v6("auth-internal",t=>{const e=jr(t.getProvider("auth").getImmediate());return new Dbe(e)},"PRIVATE").setInstantiationMode("EXPLICIT")),P6(kX,"1.6.1",function Vbe(r){switch(r){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(r)),P6(kX,"1.6.1","esm2017")}("Browser");const Zr=void 0,Wbe=["fr",[["AM","PM"],Zr,Zr],Zr,[["D","L","M","M","J","V","S"],["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"],["di","lu","ma","me","je","ve","sa"]],Zr,[["J","F","M","A","M","J","J","A","S","O","N","D"],["janv.","f\xe9vr.","mars","avr.","mai","juin","juil.","ao\xfbt","sept.","oct.","nov.","d\xe9c."],["janvier","f\xe9vrier","mars","avril","mai","juin","juillet","ao\xfbt","septembre","octobre","novembre","d\xe9cembre"]],Zr,[["av. J.-C.","ap. J.-C."],Zr,["avant J\xe9sus-Christ","apr\xe8s J\xe9sus-Christ"]],1,[6,0],["dd/MM/y","d MMM y","d MMMM y","EEEE d MMMM y"],["HH:mm","HH:mm:ss","HH:mm:ss z","HH:mm:ss zzzz"],["{1} {0}","{1}, {0}","{1} '\xe0' {0}",Zr],[",","\u202f",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0\xa0%","#,##0.00\xa0\xa4","#E0"],"EUR","\u20ac","euro",{ARS:["$AR","$"],AUD:["$AU","$"],BEF:["FB"],BMD:["$BM","$"],BND:["$BN","$"],BYN:[Zr,"\u0440."],BZD:["$BZ","$"],CAD:["$CA","$"],CLP:["$CL","$"],CNY:[Zr,"\xa5"],COP:["$CO","$"],CYP:["\xa3CY"],EGP:[Zr,"\xa3E"],FJD:["$FJ","$"],FKP:["\xa3FK","\xa3"],FRF:["F"],GBP:["\xa3GB","\xa3"],GIP:["\xa3GI","\xa3"],HKD:[Zr,"$"],IEP:["\xa3IE"],ILP:["\xa3IL"],ITL:["\u20a4IT"],JPY:[Zr,"\xa5"],KMF:[Zr,"FC"],LBP:["\xa3LB","\xa3L"],MTP:["\xa3MT"],MXN:["$MX","$"],NAD:["$NA","$"],NIO:[Zr,"$C"],NZD:["$NZ","$"],PHP:[Zr,"\u20b1"],RHD:["$RH"],RON:[Zr,"L"],RWF:[Zr,"FR"],SBD:["$SB","$"],SGD:["$SG","$"],SRD:["$SR","$"],TOP:[Zr,"$T"],TTD:["$TT","$"],TWD:[Zr,"NT$"],USD:["$US","$"],UYU:["$UY","$"],WST:["$WS"],XCD:[Zr,"$"],XPF:["FCFP"],ZMW:[Zr,"Kw"]},"ltr",function $be(r){const e=Math.floor(Math.abs(r)),n=r.toString().replace(/^[^.]*\.?/,"").length,i=parseInt(r.toString().replace(/^[^e]*(e([-+]?\d+))?/,"$2"))||0;return 0===e||1===e?1:0===i&&0!==e&&e%1e6==0&&0===n||!(i>=0&&i<=5)?4:5}];function zX(r,t){var e=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),e.push.apply(e,n)}return e}function ft(r){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?arguments[t]:{};t%2?zX(Object(e),!0).forEach(function(n){Si(r,n,e[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(e)):zX(Object(e)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(e,n))})}return r}function nC(r){return(nC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(r)}function DX(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function Si(r,t,e){return t in r?Object.defineProperty(r,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):r[t]=e,r}function FN(r,t){return function Kbe(r){if(Array.isArray(r))return r}(r)||function Qbe(r,t){var e=null==r?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(null!=e){var s,a,n=[],i=!0,o=!1;try{for(e=e.call(r);!(i=(s=e.next()).done)&&(n.push(s.value),!t||n.length!==t);i=!0);}catch(c){o=!0,a=c}finally{try{!i&&null!=e.return&&e.return()}finally{if(o)throw a}}return n}}(r,t)||VX(r,t)||function eAe(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function id(r){return function Ybe(r){if(Array.isArray(r))return UN(r)}(r)||function Xbe(r){if(typeof Symbol<"u"&&null!=r[Symbol.iterator]||null!=r["@@iterator"])return Array.from(r)}(r)||VX(r)||function Jbe(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function VX(r,t){if(r){if("string"==typeof r)return UN(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);if("Object"===e&&r.constructor&&(e=r.constructor.name),"Map"===e||"Set"===e)return Array.from(r);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return UN(r,t)}}function UN(r,t){(null==t||t>r.length)&&(t=r.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}var HX=function(){},GN={},FX={},UX=null,GX={mark:HX,measure:HX};try{typeof window<"u"&&(GN=window),typeof document<"u"&&(FX=document),typeof MutationObserver<"u"&&(UX=MutationObserver),typeof performance<"u"&&(GX=performance)}catch{}var oC,sC,aC,cC,lC,BX=(GN.navigator||{}).userAgent,$X=void 0===BX?"":BX,pl=GN,J1=FX,WX=UX,iC=GX,Z3=!!J1.documentElement&&!!J1.head&&"function"==typeof J1.addEventListener&&"function"==typeof J1.createElement,qX=~$X.indexOf("MSIE")||~$X.indexOf("Trident/"),Y3="___FONT_AWESOME___",jX="fa",ZX="svg-inline--fa",Q6="data-fa-i2svg",$N="data-fa-pseudo-element",nAe="data-fa-pseudo-element-pending",WN="data-prefix",qN="data-icon",YX="fontawesome-i2svg",rAe="async",iAe=["HTML","HEAD","STYLE","SCRIPT"],KX=function(){try{return!0}catch{return!1}}(),er="classic",br="sharp",jN=[er,br];function od(r){return new Proxy(r,{get:function(e,n){return n in e?e[n]:e[er]}})}var sd=od((Si(oC={},er,{fa:"solid",fas:"solid","fa-solid":"solid",far:"regular","fa-regular":"regular",fal:"light","fa-light":"light",fat:"thin","fa-thin":"thin",fad:"duotone","fa-duotone":"duotone",fab:"brands","fa-brands":"brands",fak:"kit",fakd:"kit","fa-kit":"kit","fa-kit-duotone":"kit"}),Si(oC,br,{fa:"solid",fass:"solid","fa-solid":"solid",fasr:"regular","fa-regular":"regular",fasl:"light","fa-light":"light",fast:"thin","fa-thin":"thin"}),oC)),ad=od((Si(sC={},er,{solid:"fas",regular:"far",light:"fal",thin:"fat",duotone:"fad",brands:"fab",kit:"fak"}),Si(sC,br,{solid:"fass",regular:"fasr",light:"fasl",thin:"fast"}),sC)),cd=od((Si(aC={},er,{fab:"fa-brands",fad:"fa-duotone",fak:"fa-kit",fal:"fa-light",far:"fa-regular",fas:"fa-solid",fat:"fa-thin"}),Si(aC,br,{fass:"fa-solid",fasr:"fa-regular",fasl:"fa-light",fast:"fa-thin"}),aC)),oAe=od((Si(cC={},er,{"fa-brands":"fab","fa-duotone":"fad","fa-kit":"fak","fa-light":"fal","fa-regular":"far","fa-solid":"fas","fa-thin":"fat"}),Si(cC,br,{"fa-solid":"fass","fa-regular":"fasr","fa-light":"fasl","fa-thin":"fast"}),cC)),sAe=/fa(s|r|l|t|d|b|k|ss|sr|sl|st)?[\-\ ]/,XX="fa-layers-text",aAe=/Font ?Awesome ?([56 ]*)(Solid|Regular|Light|Thin|Duotone|Brands|Free|Pro|Sharp|Kit)?.*/i,cAe=od((Si(lC={},er,{900:"fas",400:"far",normal:"far",300:"fal",100:"fat"}),Si(lC,br,{900:"fass",400:"fasr",300:"fasl",100:"fast"}),lC)),QX=[1,2,3,4,5,6,7,8,9,10],lAe=QX.concat([11,12,13,14,15,16,17,18,19,20]),uAe=["class","data-prefix","data-icon","data-fa-transform","data-fa-mask"],J6={GROUP:"duotone-group",SWAP_OPACITY:"swap-opacity",PRIMARY:"primary",SECONDARY:"secondary"},ld=new Set;Object.keys(ad[er]).map(ld.add.bind(ld)),Object.keys(ad[br]).map(ld.add.bind(ld));var fAe=[].concat(jN,id(ld),["2xs","xs","sm","lg","xl","2xl","beat","border","fade","beat-fade","bounce","flip-both","flip-horizontal","flip-vertical","flip","fw","inverse","layers-counter","layers-text","layers","li","pull-left","pull-right","pulse","rotate-180","rotate-270","rotate-90","rotate-by","shake","spin-pulse","spin-reverse","spin","stack-1x","stack-2x","stack","ul",J6.GROUP,J6.SWAP_OPACITY,J6.PRIMARY,J6.SECONDARY]).concat(QX.map(function(r){return"".concat(r,"x")})).concat(lAe.map(function(r){return"w-".concat(r)})),ud=pl.FontAwesomeConfig||{};J1&&"function"==typeof J1.querySelector&&[["data-family-prefix","familyPrefix"],["data-css-prefix","cssPrefix"],["data-family-default","familyDefault"],["data-style-default","styleDefault"],["data-replacement-class","replacementClass"],["data-auto-replace-svg","autoReplaceSvg"],["data-auto-add-css","autoAddCss"],["data-auto-a11y","autoA11y"],["data-search-pseudo-elements","searchPseudoElements"],["data-observe-mutations","observeMutations"],["data-mutate-approach","mutateApproach"],["data-keep-original-source","keepOriginalSource"],["data-measure-performance","measurePerformance"],["data-show-missing-icons","showMissingIcons"]].forEach(function(r){var t=FN(r,2),n=t[1],i=function hAe(r){return""===r||"false"!==r&&("true"===r||r)}(function dAe(r){var t=J1.querySelector("script["+r+"]");if(t)return t.getAttribute(r)}(t[0]));null!=i&&(ud[n]=i)});var JX={styleDefault:"solid",familyDefault:"classic",cssPrefix:jX,replacementClass:ZX,autoReplaceSvg:!0,autoAddCss:!0,autoA11y:!0,searchPseudoElements:!1,observeMutations:!0,mutateApproach:"async",keepOriginalSource:!0,measurePerformance:!1,showMissingIcons:!0};ud.familyPrefix&&(ud.cssPrefix=ud.familyPrefix);var Z5=ft(ft({},JX),ud);Z5.autoReplaceSvg||(Z5.observeMutations=!1);var _t={};Object.keys(JX).forEach(function(r){Object.defineProperty(_t,r,{enumerable:!0,set:function(e){Z5[r]=e,fd.forEach(function(n){return n(_t)})},get:function(){return Z5[r]}})}),Object.defineProperty(_t,"familyPrefix",{enumerable:!0,set:function(t){Z5.cssPrefix=t,fd.forEach(function(e){return e(_t)})},get:function(){return Z5.cssPrefix}}),pl.FontAwesomeConfig=_t;var fd=[],Hc={size:16,x:0,y:0,rotate:0,flipX:!1,flipY:!1},_Ae="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";function dd(){for(var r=12,t="";r-- >0;)t+=_Ae[62*Math.random()|0];return t}function Y5(r){for(var t=[],e=(r||[]).length>>>0;e--;)t[e]=r[e];return t}function ZN(r){return r.classList?Y5(r.classList):(r.getAttribute("class")||"").split(" ").filter(function(t){return t})}function eQ(r){return"".concat(r).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function uC(r){return Object.keys(r||{}).reduce(function(t,e){return t+"".concat(e,": ").concat(r[e].trim(),";")},"")}function YN(r){return r.size!==Hc.size||r.x!==Hc.x||r.y!==Hc.y||r.rotate!==Hc.rotate||r.flipX||r.flipY}var MAe=':root, :host {\n  --fa-font-solid: normal 900 1em/1 "Font Awesome 6 Solid";\n  --fa-font-regular: normal 400 1em/1 "Font Awesome 6 Regular";\n  --fa-font-light: normal 300 1em/1 "Font Awesome 6 Light";\n  --fa-font-thin: normal 100 1em/1 "Font Awesome 6 Thin";\n  --fa-font-duotone: normal 900 1em/1 "Font Awesome 6 Duotone";\n  --fa-font-sharp-solid: normal 900 1em/1 "Font Awesome 6 Sharp";\n  --fa-font-sharp-regular: normal 400 1em/1 "Font Awesome 6 Sharp";\n  --fa-font-sharp-light: normal 300 1em/1 "Font Awesome 6 Sharp";\n  --fa-font-sharp-thin: normal 100 1em/1 "Font Awesome 6 Sharp";\n  --fa-font-brands: normal 400 1em/1 "Font Awesome 6 Brands";\n}\n\nsvg:not(:root).svg-inline--fa, svg:not(:host).svg-inline--fa {\n  overflow: visible;\n  box-sizing: content-box;\n}\n\n.svg-inline--fa {\n  display: var(--fa-display, inline-block);\n  height: 1em;\n  overflow: visible;\n  vertical-align: -0.125em;\n}\n.svg-inline--fa.fa-2xs {\n  vertical-align: 0.1em;\n}\n.svg-inline--fa.fa-xs {\n  vertical-align: 0em;\n}\n.svg-inline--fa.fa-sm {\n  vertical-align: -0.0714285705em;\n}\n.svg-inline--fa.fa-lg {\n  vertical-align: -0.2em;\n}\n.svg-inline--fa.fa-xl {\n  vertical-align: -0.25em;\n}\n.svg-inline--fa.fa-2xl {\n  vertical-align: -0.3125em;\n}\n.svg-inline--fa.fa-pull-left {\n  margin-right: var(--fa-pull-margin, 0.3em);\n  width: auto;\n}\n.svg-inline--fa.fa-pull-right {\n  margin-left: var(--fa-pull-margin, 0.3em);\n  width: auto;\n}\n.svg-inline--fa.fa-li {\n  width: var(--fa-li-width, 2em);\n  top: 0.25em;\n}\n.svg-inline--fa.fa-fw {\n  width: var(--fa-fw-width, 1.25em);\n}\n\n.fa-layers svg.svg-inline--fa {\n  bottom: 0;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n}\n\n.fa-layers-counter, .fa-layers-text {\n  display: inline-block;\n  position: absolute;\n  text-align: center;\n}\n\n.fa-layers {\n  display: inline-block;\n  height: 1em;\n  position: relative;\n  text-align: center;\n  vertical-align: -0.125em;\n  width: 1em;\n}\n.fa-layers svg.svg-inline--fa {\n  -webkit-transform-origin: center center;\n          transform-origin: center center;\n}\n\n.fa-layers-text {\n  left: 50%;\n  top: 50%;\n  -webkit-transform: translate(-50%, -50%);\n          transform: translate(-50%, -50%);\n  -webkit-transform-origin: center center;\n          transform-origin: center center;\n}\n\n.fa-layers-counter {\n  background-color: var(--fa-counter-background-color, #ff253a);\n  border-radius: var(--fa-counter-border-radius, 1em);\n  box-sizing: border-box;\n  color: var(--fa-inverse, #fff);\n  line-height: var(--fa-counter-line-height, 1);\n  max-width: var(--fa-counter-max-width, 5em);\n  min-width: var(--fa-counter-min-width, 1.5em);\n  overflow: hidden;\n  padding: var(--fa-counter-padding, 0.25em 0.5em);\n  right: var(--fa-right, 0);\n  text-overflow: ellipsis;\n  top: var(--fa-top, 0);\n  -webkit-transform: scale(var(--fa-counter-scale, 0.25));\n          transform: scale(var(--fa-counter-scale, 0.25));\n  -webkit-transform-origin: top right;\n          transform-origin: top right;\n}\n\n.fa-layers-bottom-right {\n  bottom: var(--fa-bottom, 0);\n  right: var(--fa-right, 0);\n  top: auto;\n  -webkit-transform: scale(var(--fa-layers-scale, 0.25));\n          transform: scale(var(--fa-layers-scale, 0.25));\n  -webkit-transform-origin: bottom right;\n          transform-origin: bottom right;\n}\n\n.fa-layers-bottom-left {\n  bottom: var(--fa-bottom, 0);\n  left: var(--fa-left, 0);\n  right: auto;\n  top: auto;\n  -webkit-transform: scale(var(--fa-layers-scale, 0.25));\n          transform: scale(var(--fa-layers-scale, 0.25));\n  -webkit-transform-origin: bottom left;\n          transform-origin: bottom left;\n}\n\n.fa-layers-top-right {\n  top: var(--fa-top, 0);\n  right: var(--fa-right, 0);\n  -webkit-transform: scale(var(--fa-layers-scale, 0.25));\n          transform: scale(var(--fa-layers-scale, 0.25));\n  -webkit-transform-origin: top right;\n          transform-origin: top right;\n}\n\n.fa-layers-top-left {\n  left: var(--fa-left, 0);\n  right: auto;\n  top: var(--fa-top, 0);\n  -webkit-transform: scale(var(--fa-layers-scale, 0.25));\n          transform: scale(var(--fa-layers-scale, 0.25));\n  -webkit-transform-origin: top left;\n          transform-origin: top left;\n}\n\n.fa-1x {\n  font-size: 1em;\n}\n\n.fa-2x {\n  font-size: 2em;\n}\n\n.fa-3x {\n  font-size: 3em;\n}\n\n.fa-4x {\n  font-size: 4em;\n}\n\n.fa-5x {\n  font-size: 5em;\n}\n\n.fa-6x {\n  font-size: 6em;\n}\n\n.fa-7x {\n  font-size: 7em;\n}\n\n.fa-8x {\n  font-size: 8em;\n}\n\n.fa-9x {\n  font-size: 9em;\n}\n\n.fa-10x {\n  font-size: 10em;\n}\n\n.fa-2xs {\n  font-size: 0.625em;\n  line-height: 0.1em;\n  vertical-align: 0.225em;\n}\n\n.fa-xs {\n  font-size: 0.75em;\n  line-height: 0.0833333337em;\n  vertical-align: 0.125em;\n}\n\n.fa-sm {\n  font-size: 0.875em;\n  line-height: 0.0714285718em;\n  vertical-align: 0.0535714295em;\n}\n\n.fa-lg {\n  font-size: 1.25em;\n  line-height: 0.05em;\n  vertical-align: -0.075em;\n}\n\n.fa-xl {\n  font-size: 1.5em;\n  line-height: 0.0416666682em;\n  vertical-align: -0.125em;\n}\n\n.fa-2xl {\n  font-size: 2em;\n  line-height: 0.03125em;\n  vertical-align: -0.1875em;\n}\n\n.fa-fw {\n  text-align: center;\n  width: 1.25em;\n}\n\n.fa-ul {\n  list-style-type: none;\n  margin-left: var(--fa-li-margin, 2.5em);\n  padding-left: 0;\n}\n.fa-ul > li {\n  position: relative;\n}\n\n.fa-li {\n  left: calc(var(--fa-li-width, 2em) * -1);\n  position: absolute;\n  text-align: center;\n  width: var(--fa-li-width, 2em);\n  line-height: inherit;\n}\n\n.fa-border {\n  border-color: var(--fa-border-color, #eee);\n  border-radius: var(--fa-border-radius, 0.1em);\n  border-style: var(--fa-border-style, solid);\n  border-width: var(--fa-border-width, 0.08em);\n  padding: var(--fa-border-padding, 0.2em 0.25em 0.15em);\n}\n\n.fa-pull-left {\n  float: left;\n  margin-right: var(--fa-pull-margin, 0.3em);\n}\n\n.fa-pull-right {\n  float: right;\n  margin-left: var(--fa-pull-margin, 0.3em);\n}\n\n.fa-beat {\n  -webkit-animation-name: fa-beat;\n          animation-name: fa-beat;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, ease-in-out);\n          animation-timing-function: var(--fa-animation-timing, ease-in-out);\n}\n\n.fa-bounce {\n  -webkit-animation-name: fa-bounce;\n          animation-name: fa-bounce;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.28, 0.84, 0.42, 1));\n          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.28, 0.84, 0.42, 1));\n}\n\n.fa-fade {\n  -webkit-animation-name: fa-fade;\n          animation-name: fa-fade;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));\n          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));\n}\n\n.fa-beat-fade {\n  -webkit-animation-name: fa-beat-fade;\n          animation-name: fa-beat-fade;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));\n          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));\n}\n\n.fa-flip {\n  -webkit-animation-name: fa-flip;\n          animation-name: fa-flip;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, ease-in-out);\n          animation-timing-function: var(--fa-animation-timing, ease-in-out);\n}\n\n.fa-shake {\n  -webkit-animation-name: fa-shake;\n          animation-name: fa-shake;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, linear);\n          animation-timing-function: var(--fa-animation-timing, linear);\n}\n\n.fa-spin {\n  -webkit-animation-name: fa-spin;\n          animation-name: fa-spin;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 2s);\n          animation-duration: var(--fa-animation-duration, 2s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, linear);\n          animation-timing-function: var(--fa-animation-timing, linear);\n}\n\n.fa-spin-reverse {\n  --fa-animation-direction: reverse;\n}\n\n.fa-pulse,\n.fa-spin-pulse {\n  -webkit-animation-name: fa-spin;\n          animation-name: fa-spin;\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, steps(8));\n          animation-timing-function: var(--fa-animation-timing, steps(8));\n}\n\n@media (prefers-reduced-motion: reduce) {\n  .fa-beat,\n.fa-bounce,\n.fa-fade,\n.fa-beat-fade,\n.fa-flip,\n.fa-pulse,\n.fa-shake,\n.fa-spin,\n.fa-spin-pulse {\n    -webkit-animation-delay: -1ms;\n            animation-delay: -1ms;\n    -webkit-animation-duration: 1ms;\n            animation-duration: 1ms;\n    -webkit-animation-iteration-count: 1;\n            animation-iteration-count: 1;\n    -webkit-transition-delay: 0s;\n            transition-delay: 0s;\n    -webkit-transition-duration: 0s;\n            transition-duration: 0s;\n  }\n}\n@-webkit-keyframes fa-beat {\n  0%, 90% {\n    -webkit-transform: scale(1);\n            transform: scale(1);\n  }\n  45% {\n    -webkit-transform: scale(var(--fa-beat-scale, 1.25));\n            transform: scale(var(--fa-beat-scale, 1.25));\n  }\n}\n@keyframes fa-beat {\n  0%, 90% {\n    -webkit-transform: scale(1);\n            transform: scale(1);\n  }\n  45% {\n    -webkit-transform: scale(var(--fa-beat-scale, 1.25));\n            transform: scale(var(--fa-beat-scale, 1.25));\n  }\n}\n@-webkit-keyframes fa-bounce {\n  0% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n  10% {\n    -webkit-transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);\n            transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);\n  }\n  30% {\n    -webkit-transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));\n            transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));\n  }\n  50% {\n    -webkit-transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);\n            transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);\n  }\n  57% {\n    -webkit-transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));\n            transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));\n  }\n  64% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n  100% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n}\n@keyframes fa-bounce {\n  0% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n  10% {\n    -webkit-transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);\n            transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);\n  }\n  30% {\n    -webkit-transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));\n            transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));\n  }\n  50% {\n    -webkit-transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);\n            transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);\n  }\n  57% {\n    -webkit-transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));\n            transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));\n  }\n  64% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n  100% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n}\n@-webkit-keyframes fa-fade {\n  50% {\n    opacity: var(--fa-fade-opacity, 0.4);\n  }\n}\n@keyframes fa-fade {\n  50% {\n    opacity: var(--fa-fade-opacity, 0.4);\n  }\n}\n@-webkit-keyframes fa-beat-fade {\n  0%, 100% {\n    opacity: var(--fa-beat-fade-opacity, 0.4);\n    -webkit-transform: scale(1);\n            transform: scale(1);\n  }\n  50% {\n    opacity: 1;\n    -webkit-transform: scale(var(--fa-beat-fade-scale, 1.125));\n            transform: scale(var(--fa-beat-fade-scale, 1.125));\n  }\n}\n@keyframes fa-beat-fade {\n  0%, 100% {\n    opacity: var(--fa-beat-fade-opacity, 0.4);\n    -webkit-transform: scale(1);\n            transform: scale(1);\n  }\n  50% {\n    opacity: 1;\n    -webkit-transform: scale(var(--fa-beat-fade-scale, 1.125));\n            transform: scale(var(--fa-beat-fade-scale, 1.125));\n  }\n}\n@-webkit-keyframes fa-flip {\n  50% {\n    -webkit-transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));\n            transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));\n  }\n}\n@keyframes fa-flip {\n  50% {\n    -webkit-transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));\n            transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));\n  }\n}\n@-webkit-keyframes fa-shake {\n  0% {\n    -webkit-transform: rotate(-15deg);\n            transform: rotate(-15deg);\n  }\n  4% {\n    -webkit-transform: rotate(15deg);\n            transform: rotate(15deg);\n  }\n  8%, 24% {\n    -webkit-transform: rotate(-18deg);\n            transform: rotate(-18deg);\n  }\n  12%, 28% {\n    -webkit-transform: rotate(18deg);\n            transform: rotate(18deg);\n  }\n  16% {\n    -webkit-transform: rotate(-22deg);\n            transform: rotate(-22deg);\n  }\n  20% {\n    -webkit-transform: rotate(22deg);\n            transform: rotate(22deg);\n  }\n  32% {\n    -webkit-transform: rotate(-12deg);\n            transform: rotate(-12deg);\n  }\n  36% {\n    -webkit-transform: rotate(12deg);\n            transform: rotate(12deg);\n  }\n  40%, 100% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n}\n@keyframes fa-shake {\n  0% {\n    -webkit-transform: rotate(-15deg);\n            transform: rotate(-15deg);\n  }\n  4% {\n    -webkit-transform: rotate(15deg);\n            transform: rotate(15deg);\n  }\n  8%, 24% {\n    -webkit-transform: rotate(-18deg);\n            transform: rotate(-18deg);\n  }\n  12%, 28% {\n    -webkit-transform: rotate(18deg);\n            transform: rotate(18deg);\n  }\n  16% {\n    -webkit-transform: rotate(-22deg);\n            transform: rotate(-22deg);\n  }\n  20% {\n    -webkit-transform: rotate(22deg);\n            transform: rotate(22deg);\n  }\n  32% {\n    -webkit-transform: rotate(-12deg);\n            transform: rotate(-12deg);\n  }\n  36% {\n    -webkit-transform: rotate(12deg);\n            transform: rotate(12deg);\n  }\n  40%, 100% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n}\n@-webkit-keyframes fa-spin {\n  0% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n            transform: rotate(360deg);\n  }\n}\n@keyframes fa-spin {\n  0% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n            transform: rotate(360deg);\n  }\n}\n.fa-rotate-90 {\n  -webkit-transform: rotate(90deg);\n          transform: rotate(90deg);\n}\n\n.fa-rotate-180 {\n  -webkit-transform: rotate(180deg);\n          transform: rotate(180deg);\n}\n\n.fa-rotate-270 {\n  -webkit-transform: rotate(270deg);\n          transform: rotate(270deg);\n}\n\n.fa-flip-horizontal {\n  -webkit-transform: scale(-1, 1);\n          transform: scale(-1, 1);\n}\n\n.fa-flip-vertical {\n  -webkit-transform: scale(1, -1);\n          transform: scale(1, -1);\n}\n\n.fa-flip-both,\n.fa-flip-horizontal.fa-flip-vertical {\n  -webkit-transform: scale(-1, -1);\n          transform: scale(-1, -1);\n}\n\n.fa-rotate-by {\n  -webkit-transform: rotate(var(--fa-rotate-angle, none));\n          transform: rotate(var(--fa-rotate-angle, none));\n}\n\n.fa-stack {\n  display: inline-block;\n  vertical-align: middle;\n  height: 2em;\n  position: relative;\n  width: 2.5em;\n}\n\n.fa-stack-1x,\n.fa-stack-2x {\n  bottom: 0;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n  z-index: var(--fa-stack-z-index, auto);\n}\n\n.svg-inline--fa.fa-stack-1x {\n  height: 1em;\n  width: 1.25em;\n}\n.svg-inline--fa.fa-stack-2x {\n  height: 2em;\n  width: 2.5em;\n}\n\n.fa-inverse {\n  color: var(--fa-inverse, #fff);\n}\n\n.sr-only,\n.fa-sr-only {\n  position: absolute;\n  width: 1px;\n  height: 1px;\n  padding: 0;\n  margin: -1px;\n  overflow: hidden;\n  clip: rect(0, 0, 0, 0);\n  white-space: nowrap;\n  border-width: 0;\n}\n\n.sr-only-focusable:not(:focus),\n.fa-sr-only-focusable:not(:focus) {\n  position: absolute;\n  width: 1px;\n  height: 1px;\n  padding: 0;\n  margin: -1px;\n  overflow: hidden;\n  clip: rect(0, 0, 0, 0);\n  white-space: nowrap;\n  border-width: 0;\n}\n\n.svg-inline--fa .fa-primary {\n  fill: var(--fa-primary-color, currentColor);\n  opacity: var(--fa-primary-opacity, 1);\n}\n\n.svg-inline--fa .fa-secondary {\n  fill: var(--fa-secondary-color, currentColor);\n  opacity: var(--fa-secondary-opacity, 0.4);\n}\n\n.svg-inline--fa.fa-swap-opacity .fa-primary {\n  opacity: var(--fa-secondary-opacity, 0.4);\n}\n\n.svg-inline--fa.fa-swap-opacity .fa-secondary {\n  opacity: var(--fa-primary-opacity, 1);\n}\n\n.svg-inline--fa mask .fa-primary,\n.svg-inline--fa mask .fa-secondary {\n  fill: black;\n}\n\n.fad.fa-inverse,\n.fa-duotone.fa-inverse {\n  color: var(--fa-inverse, #fff);\n}';function tQ(){var r=jX,t=ZX,e=_t.cssPrefix,n=_t.replacementClass,i=MAe;if(e!==r||n!==t){var o=new RegExp("\\.".concat(r,"\\-"),"g"),s=new RegExp("\\--".concat(r,"\\-"),"g"),a=new RegExp("\\.".concat(t),"g");i=i.replace(o,".".concat(e,"-")).replace(s,"--".concat(e,"-")).replace(a,".".concat(n))}return i}var nQ=!1;function KN(){_t.autoAddCss&&!nQ&&(function mAe(r){if(r&&Z3){var t=J1.createElement("style");t.setAttribute("type","text/css"),t.innerHTML=r;for(var e=J1.head.childNodes,n=null,i=e.length-1;i>-1;i--){var o=e[i],s=(o.tagName||"").toUpperCase();["STYLE","LINK"].indexOf(s)>-1&&(n=o)}J1.head.insertBefore(t,n)}}(tQ()),nQ=!0)}var EAe={mixout:function(){return{dom:{css:tQ,insertCss:KN}}},hooks:function(){return{beforeDOMElementCreation:function(){KN()},beforeI2svg:function(){KN()}}}},K3=pl||{};K3[Y3]||(K3[Y3]={}),K3[Y3].styles||(K3[Y3].styles={}),K3[Y3].hooks||(K3[Y3].hooks={}),K3[Y3].shims||(K3[Y3].shims=[]);var za=K3[Y3],rQ=[],fC=!1;function hd(r){var t=r.tag,e=r.attributes,n=void 0===e?{}:e,i=r.children,o=void 0===i?[]:i;return"string"==typeof r?eQ(r):"<".concat(t," ").concat(function CAe(r){return Object.keys(r||{}).reduce(function(t,e){return t+"".concat(e,'="').concat(eQ(r[e]),'" ')},"").trim()}(n),">").concat(o.map(hd).join(""),"</").concat(t,">")}function iQ(r,t,e){if(r&&r[t]&&r[t][e])return{prefix:t,iconName:e,icon:r[t][e]}}Z3&&((fC=(J1.documentElement.doScroll?/^loaded|^c/:/^loaded|^i|^c/).test(J1.readyState))||J1.addEventListener("DOMContentLoaded",function r(){J1.removeEventListener("DOMContentLoaded",r),fC=1,rQ.map(function(t){return t()})}));var XN=function(t,e,n,i){var c,l,u,o=Object.keys(t),s=o.length,a=void 0!==i?function(t,e){return function(n,i,o,s){return t.call(e,n,i,o,s)}}(e,i):e;for(void 0===n?(c=1,u=t[o[0]]):(c=0,u=n);c<s;c++)u=a(u,t[l=o[c]],l,t);return u};function QN(r){var t=function TAe(r){for(var t=[],e=0,n=r.length;e<n;){var i=r.charCodeAt(e++);if(i>=55296&&i<=56319&&e<n){var o=r.charCodeAt(e++);56320==(64512&o)?t.push(((1023&i)<<10)+(1023&o)+65536):(t.push(i),e--)}else t.push(i)}return t}(r);return 1===t.length?t[0].toString(16):null}function oQ(r){return Object.keys(r).reduce(function(t,e){var n=r[e];return n.icon?t[n.iconName]=n.icon:t[e]=n,t},{})}function JN(r,t){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).skipHooks,i=void 0!==n&&n,o=oQ(t);"function"!=typeof za.hooks.addPack||i?za.styles[r]=ft(ft({},za.styles[r]||{}),o):za.hooks.addPack(r,oQ(t)),"fas"===r&&JN("fa",t)}var dC,hC,gC,K5=za.styles,bAe=za.shims,AAe=(Si(dC={},er,Object.values(cd[er])),Si(dC,br,Object.values(cd[br])),dC),eI=null,sQ={},aQ={},cQ={},lQ={},uQ={},NAe=(Si(hC={},er,Object.keys(sd[er])),Si(hC,br,Object.keys(sd[br])),hC);var fQ=function(){var t=function(o){return XN(K5,function(s,a,c){return s[c]=XN(a,o,{}),s},{})};sQ=t(function(i,o,s){return o[3]&&(i[o[3]]=s),o[2]&&o[2].filter(function(c){return"number"==typeof c}).forEach(function(c){i[c.toString(16)]=s}),i}),aQ=t(function(i,o,s){return i[s]=s,o[2]&&o[2].filter(function(c){return"string"==typeof c}).forEach(function(c){i[c]=s}),i}),uQ=t(function(i,o,s){var a=o[2];return i[s]=s,a.forEach(function(c){i[c]=s}),i});var e="far"in K5||_t.autoFetchSvg,n=XN(bAe,function(i,o){var s=o[0],a=o[1],c=o[2];return"far"===a&&!e&&(a="fas"),"string"==typeof s&&(i.names[s]={prefix:a,iconName:c}),"number"==typeof s&&(i.unicodes[s.toString(16)]={prefix:a,iconName:c}),i},{names:{},unicodes:{}});cQ=n.names,lQ=n.unicodes,eI=pC(_t.styleDefault,{family:_t.familyDefault})};function tI(r,t){return(sQ[r]||{})[t]}function e0(r,t){return(uQ[r]||{})[t]}function dQ(r){return cQ[r]||{prefix:null,iconName:null}}function _l(){return eI}(function pAe(r){fd.push(r)})(function(r){eI=pC(r.styleDefault,{family:_t.familyDefault})}),fQ();var nI=function(){return{prefix:null,iconName:null,rest:[]}};function pC(r){var e=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).family,n=void 0===e?er:e;return ad[n][r]||ad[n][sd[n][r]]||(r in za.styles?r:null)||null}var hQ=(Si(gC={},er,Object.keys(cd[er])),Si(gC,br,Object.keys(cd[br])),gC);function mC(r){var t,n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).skipLookups,i=void 0!==n&&n,o=(Si(t={},er,"".concat(_t.cssPrefix,"-").concat(er)),Si(t,br,"".concat(_t.cssPrefix,"-").concat(br)),t),s=null,a=er;(r.includes(o[er])||r.some(function(l){return hQ[er].includes(l)}))&&(a=er),(r.includes(o[br])||r.some(function(l){return hQ[br].includes(l)}))&&(a=br);var c=r.reduce(function(l,u){var f=function kAe(r,t){var e=t.split("-"),n=e[0],i=e.slice(1).join("-");return n!==r||""===i||function IAe(r){return~fAe.indexOf(r)}(i)?null:i}(_t.cssPrefix,u);if(K5[u]?(u=AAe[a].includes(u)?oAe[a][u]:u,s=u,l.prefix=u):NAe[a].indexOf(u)>-1?(s=u,l.prefix=pC(u,{family:a})):f?l.iconName=f:u!==_t.replacementClass&&u!==o[er]&&u!==o[br]&&l.rest.push(u),!i&&l.prefix&&l.iconName){var g="fa"===s?dQ(l.iconName):{},y=e0(l.prefix,l.iconName);g.prefix&&(s=null),l.iconName=g.iconName||y||l.iconName,l.prefix=g.prefix||l.prefix,"far"===l.prefix&&!K5.far&&K5.fas&&!_t.autoFetchSvg&&(l.prefix="fas")}return l},nI());return(r.includes("fa-brands")||r.includes("fab"))&&(c.prefix="fab"),(r.includes("fa-duotone")||r.includes("fad"))&&(c.prefix="fad"),!c.prefix&&a===br&&(K5.fass||_t.autoFetchSvg)&&(c.prefix="fass",c.iconName=e0(c.prefix,c.iconName)||c.iconName),("fa"===c.prefix||"fa"===s)&&(c.prefix=_l()||"fas"),c}var LAe=function(){function r(){(function qbe(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")})(this,r),this.definitions={}}return function jbe(r,t,e){t&&DX(r.prototype,t),e&&DX(r,e),Object.defineProperty(r,"prototype",{writable:!1})}(r,[{key:"add",value:function(){for(var e=this,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];var s=i.reduce(this._pullDefinitions,{});Object.keys(s).forEach(function(a){e.definitions[a]=ft(ft({},e.definitions[a]||{}),s[a]),JN(a,s[a]);var c=cd[er][a];c&&JN(c,s[a]),fQ()})}},{key:"reset",value:function(){this.definitions={}}},{key:"_pullDefinitions",value:function(e,n){var i=n.prefix&&n.iconName&&n.icon?{0:n}:n;return Object.keys(i).map(function(o){var s=i[o],a=s.prefix,c=s.iconName,l=s.icon,u=l[2];e[a]||(e[a]={}),u.length>0&&u.forEach(function(f){"string"==typeof f&&(e[a][f]=l)}),e[a][c]=l}),e}}]),r}(),gQ=[],X5={},Q5={},zAe=Object.keys(Q5);function rI(r,t){for(var e=arguments.length,n=new Array(e>2?e-2:0),i=2;i<e;i++)n[i-2]=arguments[i];return(X5[r]||[]).forEach(function(s){t=s.apply(null,[t].concat(n))}),t}function t0(r){for(var t=arguments.length,e=new Array(t>1?t-1:0),n=1;n<t;n++)e[n-1]=arguments[n];(X5[r]||[]).forEach(function(o){o.apply(null,e)})}function X3(){var r=arguments[0],t=Array.prototype.slice.call(arguments,1);return Q5[r]?Q5[r].apply(null,t):void 0}function iI(r){"fa"===r.prefix&&(r.prefix="fas");var t=r.iconName,e=r.prefix||_l();if(t)return t=e0(e,t)||t,iQ(pQ.definitions,e,t)||iQ(za.styles,e,t)}var pQ=new LAe,HAe={i2svg:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Z3?(t0("beforeI2svg",t),X3("pseudoElements2svg",t),X3("i2svg",t)):Promise.reject("Operation requires a DOM of some kind.")},watch:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.autoReplaceSvgRoot;!1===_t.autoReplaceSvg&&(_t.autoReplaceSvg=!0),_t.observeMutations=!0,function SAe(r){Z3&&(fC?setTimeout(r,0):rQ.push(r))}(function(){UAe({autoReplaceSvgRoot:e}),t0("watch",t)})}},ps={noAuto:function(){_t.autoReplaceSvg=!1,_t.observeMutations=!1,t0("noAuto")},config:_t,dom:HAe,parse:{icon:function(t){if(null===t)return null;if("object"===nC(t)&&t.prefix&&t.iconName)return{prefix:t.prefix,iconName:e0(t.prefix,t.iconName)||t.iconName};if(Array.isArray(t)&&2===t.length){var e=0===t[1].indexOf("fa-")?t[1].slice(3):t[1],n=pC(t[0]);return{prefix:n,iconName:e0(n,e)||e}}if("string"==typeof t&&(t.indexOf("".concat(_t.cssPrefix,"-"))>-1||t.match(sAe))){var i=mC(t.split(" "),{skipLookups:!0});return{prefix:i.prefix||_l(),iconName:e0(i.prefix,i.iconName)||i.iconName}}if("string"==typeof t){var o=_l();return{prefix:o,iconName:e0(o,t)||t}}}},library:pQ,findIconDefinition:iI,toHtml:hd},UAe=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).autoReplaceSvgRoot,n=void 0===e?J1:e;(Object.keys(za.styles).length>0||_t.autoFetchSvg)&&Z3&&_t.autoReplaceSvg&&ps.dom.i2svg({node:n})};function _C(r,t){return Object.defineProperty(r,"abstract",{get:t}),Object.defineProperty(r,"html",{get:function(){return r.abstract.map(function(n){return hd(n)})}}),Object.defineProperty(r,"node",{get:function(){if(Z3){var n=J1.createElement("div");return n.innerHTML=r.html,n.children}}}),r}function oI(r){var t=r.icons,e=t.main,n=t.mask,i=r.prefix,o=r.iconName,s=r.transform,a=r.symbol,c=r.title,l=r.maskId,u=r.titleId,f=r.extra,g=r.watchable,y=void 0!==g&&g,S=n.found?n:e,N=S.width,R=S.height,U="fak"===i,$=[_t.replacementClass,o?"".concat(_t.cssPrefix,"-").concat(o):""].filter(function(u1){return-1===f.classes.indexOf(u1)}).filter(function(u1){return""!==u1||!!u1}).concat(f.classes).join(" "),re={children:[],attributes:ft(ft({},f.attributes),{},{"data-prefix":i,"data-icon":o,class:$,role:f.attributes.role||"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 ".concat(N," ").concat(R)})},_e=U&&!~f.classes.indexOf("fa-fw")?{width:"".concat(N/R*16*.0625,"em")}:{};y&&(re.attributes[Q6]=""),c&&(re.children.push({tag:"title",attributes:{id:re.attributes["aria-labelledby"]||"title-".concat(u||dd())},children:[c]}),delete re.attributes.title);var be=ft(ft({},re),{},{prefix:i,iconName:o,main:e,mask:n,maskId:l,transform:s,symbol:a,styles:ft(ft({},_e),f.styles)}),Ve=n.found&&e.found?X3("generateAbstractMask",be)||{children:[],attributes:{}}:X3("generateAbstractIcon",be)||{children:[],attributes:{}},Xt=Ve.attributes;return be.children=Ve.children,be.attributes=Xt,a?function BAe(r){var e=r.iconName,n=r.children,i=r.attributes,o=r.symbol,s=!0===o?"".concat(r.prefix,"-").concat(_t.cssPrefix,"-").concat(e):o;return[{tag:"svg",attributes:{style:"display: none;"},children:[{tag:"symbol",attributes:ft(ft({},i),{},{id:s}),children:n}]}]}(be):function GAe(r){var t=r.children,e=r.main,n=r.mask,i=r.attributes,o=r.styles,s=r.transform;if(YN(s)&&e.found&&!n.found){var l={x:e.width/e.height/2,y:.5};i.style=uC(ft(ft({},o),{},{"transform-origin":"".concat(l.x+s.x/16,"em ").concat(l.y+s.y/16,"em")}))}return[{tag:"svg",attributes:i,children:t}]}(be)}function mQ(r){var t=r.content,e=r.width,n=r.height,i=r.transform,o=r.title,s=r.extra,a=r.watchable,c=void 0!==a&&a,l=ft(ft(ft({},s.attributes),o?{title:o}:{}),{},{class:s.classes.join(" ")});c&&(l[Q6]="");var u=ft({},s.styles);YN(i)&&(u.transform=function yAe(r){var t=r.transform,e=r.width,i=r.height,o=void 0===i?16:i,s=r.startCentered,a=void 0!==s&&s,c="";return c+=a&&qX?"translate(".concat(t.x/16-(void 0===e?16:e)/2,"em, ").concat(t.y/16-o/2,"em) "):a?"translate(calc(-50% + ".concat(t.x/16,"em), calc(-50% + ").concat(t.y/16,"em)) "):"translate(".concat(t.x/16,"em, ").concat(t.y/16,"em) "),(c+="scale(".concat(t.size/16*(t.flipX?-1:1),", ").concat(t.size/16*(t.flipY?-1:1),") "))+"rotate(".concat(t.rotate,"deg) ")}({transform:i,startCentered:!0,width:e,height:n}),u["-webkit-transform"]=u.transform);var f=uC(u);f.length>0&&(l.style=f);var g=[];return g.push({tag:"span",attributes:l,children:[t]}),o&&g.push({tag:"span",attributes:{class:"sr-only"},children:[o]}),g}var sI=za.styles;function aI(r){var t=r[0],e=r[1],o=FN(r.slice(4),1)[0];return{found:!0,width:t,height:e,icon:Array.isArray(o)?{tag:"g",attributes:{class:"".concat(_t.cssPrefix,"-").concat(J6.GROUP)},children:[{tag:"path",attributes:{class:"".concat(_t.cssPrefix,"-").concat(J6.SECONDARY),fill:"currentColor",d:o[0]}},{tag:"path",attributes:{class:"".concat(_t.cssPrefix,"-").concat(J6.PRIMARY),fill:"currentColor",d:o[1]}}]}:{tag:"path",attributes:{fill:"currentColor",d:o}}}}var WAe={found:!1,width:512,height:512};function cI(r,t){var e=t;return"fa"===t&&null!==_t.styleDefault&&(t=_l()),new Promise(function(n,i){if(X3("missingIconAbstract"),"fa"===e){var s=dQ(r)||{};r=s.iconName||r,t=s.prefix||t}if(r&&t&&sI[t]&&sI[t][r])return n(aI(sI[t][r]));(function qAe(r,t){!KX&&!_t.showMissingIcons&&r&&console.error('Icon with name "'.concat(r,'" and prefix "').concat(t,'" is missing.'))})(r,t),n(ft(ft({},WAe),{},{icon:_t.showMissingIcons&&r&&X3("missingIconAbstract")||{}}))})}var _Q=function(){},lI=_t.measurePerformance&&iC&&iC.mark&&iC.measure?iC:{mark:_Q,measure:_Q},gd='FA "6.5.1"',CQ=function(t){lI.mark("".concat(gd," ").concat(t," ends")),lI.measure("".concat(gd," ").concat(t),"".concat(gd," ").concat(t," begins"),"".concat(gd," ").concat(t," ends"))},uI={begin:function(t){return lI.mark("".concat(gd," ").concat(t," begins")),function(){return CQ(t)}},end:CQ},CC=function(){};function vQ(r){return"string"==typeof(r.getAttribute?r.getAttribute(Q6):null)}function XAe(r){return J1.createElementNS("http://www.w3.org/2000/svg",r)}function QAe(r){return J1.createElement(r)}function yQ(r){var e=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).ceFn,n=void 0===e?"svg"===r.tag?XAe:QAe:e;if("string"==typeof r)return J1.createTextNode(r);var i=n(r.tag);return Object.keys(r.attributes||[]).forEach(function(s){i.setAttribute(s,r.attributes[s])}),(r.children||[]).forEach(function(s){i.appendChild(yQ(s,{ceFn:n}))}),i}var vC={replace:function(t){var e=t[0];if(e.parentNode)if(t[1].forEach(function(i){e.parentNode.insertBefore(yQ(i),e)}),null===e.getAttribute(Q6)&&_t.keepOriginalSource){var n=J1.createComment(function JAe(r){var t=" ".concat(r.outerHTML," ");return"".concat(t,"Font Awesome fontawesome.com ")}(e));e.parentNode.replaceChild(n,e)}else e.remove()},nest:function(t){var e=t[0],n=t[1];if(~ZN(e).indexOf(_t.replacementClass))return vC.replace(t);var i=new RegExp("".concat(_t.cssPrefix,"-.*"));if(delete n[0].attributes.id,n[0].attributes.class){var o=n[0].attributes.class.split(" ").reduce(function(a,c){return c===_t.replacementClass||c.match(i)?a.toSvg.push(c):a.toNode.push(c),a},{toNode:[],toSvg:[]});n[0].attributes.class=o.toSvg.join(" "),0===o.toNode.length?e.removeAttribute("class"):e.setAttribute("class",o.toNode.join(" "))}var s=n.map(function(a){return hd(a)}).join("\n");e.setAttribute(Q6,""),e.innerHTML=s}};function MQ(r){r()}function EQ(r,t){var e="function"==typeof t?t:CC;if(0===r.length)e();else{var n=MQ;_t.mutateApproach===rAe&&(n=pl.requestAnimationFrame||MQ),n(function(){var i=function KAe(){return!0===_t.autoReplaceSvg?vC.replace:vC[_t.autoReplaceSvg]||vC.replace}(),o=uI.begin("mutate");r.map(i),o(),e()})}}var fI=!1;function PQ(){fI=!0}function dI(){fI=!1}var yC=null;function SQ(r){if(WX&&_t.observeMutations){var t=r.treeCallback,e=void 0===t?CC:t,n=r.nodeCallback,i=void 0===n?CC:n,o=r.pseudoElementsCallback,s=void 0===o?CC:o,a=r.observeMutationsRoot,c=void 0===a?J1:a;yC=new WX(function(l){if(!fI){var u=_l();Y5(l).forEach(function(f){if("childList"===f.type&&f.addedNodes.length>0&&!vQ(f.addedNodes[0])&&(_t.searchPseudoElements&&s(f.target),e(f.target)),"attributes"===f.type&&f.target.parentNode&&_t.searchPseudoElements&&s(f.target.parentNode),"attributes"===f.type&&vQ(f.target)&&~uAe.indexOf(f.attributeName))if("class"===f.attributeName&&function ZAe(r){var t=r.getAttribute?r.getAttribute(WN):null,e=r.getAttribute?r.getAttribute(qN):null;return t&&e}(f.target)){var g=mC(ZN(f.target)),S=g.iconName;f.target.setAttribute(WN,g.prefix||u),S&&f.target.setAttribute(qN,S)}else(function YAe(r){return r&&r.classList&&r.classList.contains&&r.classList.contains(_t.replacementClass)})(f.target)&&i(f.target)})}}),Z3&&yC.observe(c,{childList:!0,attributes:!0,characterData:!0,subtree:!0})}}function OQ(r){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{styleParser:!0},e=function nNe(r){var t=r.getAttribute("data-prefix"),e=r.getAttribute("data-icon"),n=void 0!==r.innerText?r.innerText.trim():"",i=mC(ZN(r));return i.prefix||(i.prefix=_l()),t&&e&&(i.prefix=t,i.iconName=e),i.iconName&&i.prefix||(i.prefix&&n.length>0&&(i.iconName=function RAe(r,t){return(aQ[r]||{})[t]}(i.prefix,r.innerText)||tI(i.prefix,QN(r.innerText))),!i.iconName&&_t.autoFetchSvg&&r.firstChild&&r.firstChild.nodeType===Node.TEXT_NODE&&(i.iconName=r.firstChild.data)),i}(r),n=e.iconName,i=e.prefix,o=e.rest,s=function rNe(r){var t=Y5(r.attributes).reduce(function(i,o){return"class"!==i.name&&"style"!==i.name&&(i[o.name]=o.value),i},{}),e=r.getAttribute("title"),n=r.getAttribute("data-fa-title-id");return _t.autoA11y&&(e?t["aria-labelledby"]="".concat(_t.replacementClass,"-title-").concat(n||dd()):(t["aria-hidden"]="true",t.focusable="false")),t}(r),a=rI("parseNodeAttributes",{},r),c=t.styleParser?function tNe(r){var t=r.getAttribute("style"),e=[];return t&&(e=t.split(";").reduce(function(n,i){var o=i.split(":"),s=o[0],a=o.slice(1);return s&&a.length>0&&(n[s]=a.join(":").trim()),n},{})),e}(r):[];return ft({iconName:n,title:r.getAttribute("title"),titleId:r.getAttribute("data-fa-title-id"),prefix:i,transform:Hc,mask:{iconName:null,prefix:null,rest:[]},maskId:null,symbol:!1,extra:{classes:o,styles:c,attributes:s}},a)}var oNe=za.styles;function TQ(r){var t="nest"===_t.autoReplaceSvg?OQ(r,{styleParser:!1}):OQ(r);return~t.extra.classes.indexOf(XX)?X3("generateLayersText",r,t):X3("generateSvgReplacementMutation",r,t)}var Cl=new Set;function wQ(r){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!Z3)return Promise.resolve();var e=J1.documentElement.classList,n=function(f){return e.add("".concat(YX,"-").concat(f))},i=function(f){return e.remove("".concat(YX,"-").concat(f))},o=_t.autoFetchSvg?Cl:jN.map(function(u){return"fa-".concat(u)}).concat(Object.keys(oNe));o.includes("fa")||o.push("fa");var s=[".".concat(XX,":not([").concat(Q6,"])")].concat(o.map(function(u){return".".concat(u,":not([").concat(Q6,"])")})).join(", ");if(0===s.length)return Promise.resolve();var a=[];try{a=Y5(r.querySelectorAll(s))}catch{}if(!(a.length>0))return Promise.resolve();n("pending"),i("complete");var c=uI.begin("onTree"),l=a.reduce(function(u,f){try{var g=TQ(f);g&&u.push(g)}catch(y){KX||"MissingIcon"===y.name&&console.error(y)}return u},[]);return new Promise(function(u,f){Promise.all(l).then(function(g){EQ(g,function(){n("active"),n("complete"),i("pending"),"function"==typeof t&&t(),c(),u()})}).catch(function(g){c(),f(g)})})}function sNe(r){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;TQ(r).then(function(e){e&&EQ([e],t)})}function aNe(r){return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(t||{}).icon?t:iI(t||{}),i=e.mask;return i&&(i=(i||{}).icon?i:iI(i||{})),r(n,ft(ft({},e),{},{mask:i}))}}jN.map(function(r){Cl.add("fa-".concat(r))}),Object.keys(sd[er]).map(Cl.add.bind(Cl)),Object.keys(sd[br]).map(Cl.add.bind(Cl)),Cl=id(Cl);var cNe=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.transform,i=void 0===n?Hc:n,o=e.symbol,s=void 0!==o&&o,a=e.mask,c=void 0===a?null:a,l=e.maskId,u=void 0===l?null:l,f=e.title,g=void 0===f?null:f,y=e.titleId,S=void 0===y?null:y,N=e.classes,R=void 0===N?[]:N,U=e.attributes,$=void 0===U?{}:U,re=e.styles,_e=void 0===re?{}:re;if(t){var be=t.prefix,Ve=t.iconName,dt=t.icon;return _C(ft({type:"icon"},t),function(){return t0("beforeDOMElementCreation",{iconDefinition:t,params:e}),_t.autoA11y&&(g?$["aria-labelledby"]="".concat(_t.replacementClass,"-title-").concat(S||dd()):($["aria-hidden"]="true",$.focusable="false")),oI({icons:{main:aI(dt),mask:c?aI(c.icon):{found:!1,width:null,height:null,icon:{}}},prefix:be,iconName:Ve,transform:ft(ft({},Hc),i),symbol:s,title:g,maskId:u,titleId:S,extra:{attributes:$,styles:_e,classes:R}})})}},lNe={mixout:function(){return{icon:aNe(cNe)}},hooks:function(){return{mutationObserverCallbacks:function(e){return e.treeCallback=wQ,e.nodeCallback=sNe,e}}},provides:function(t){t.i2svg=function(e){var n=e.node,o=e.callback;return wQ(void 0===n?J1:n,void 0===o?function(){}:o)},t.generateSvgReplacementMutation=function(e,n){var i=n.iconName,o=n.title,s=n.titleId,a=n.prefix,c=n.transform,l=n.symbol,u=n.mask,f=n.maskId,g=n.extra;return new Promise(function(y,S){Promise.all([cI(i,a),u.iconName?cI(u.iconName,u.prefix):Promise.resolve({found:!1,width:512,height:512,icon:{}})]).then(function(N){var R=FN(N,2);y([e,oI({icons:{main:R[0],mask:R[1]},prefix:a,iconName:i,transform:c,symbol:l,maskId:f,title:o,titleId:s,extra:g,watchable:!0})])}).catch(S)})},t.generateAbstractIcon=function(e){var l,n=e.children,i=e.attributes,o=e.main,s=e.transform,c=uC(e.styles);return c.length>0&&(i.style=c),YN(s)&&(l=X3("generateAbstractTransformGrouping",{main:o,transform:s,containerWidth:o.width,iconWidth:o.width})),n.push(l||o.icon),{children:n,attributes:i}}}},uNe={mixout:function(){return{layer:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.classes,o=void 0===i?[]:i;return _C({type:"layer"},function(){t0("beforeDOMElementCreation",{assembler:e,params:n});var s=[];return e(function(a){Array.isArray(a)?a.map(function(c){s=s.concat(c.abstract)}):s=s.concat(a.abstract)}),[{tag:"span",attributes:{class:["".concat(_t.cssPrefix,"-layers")].concat(id(o)).join(" ")},children:s}]})}}}},fNe={mixout:function(){return{counter:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.title,o=void 0===i?null:i,s=n.classes,a=void 0===s?[]:s,c=n.attributes,l=void 0===c?{}:c,u=n.styles,f=void 0===u?{}:u;return _C({type:"counter",content:e},function(){return t0("beforeDOMElementCreation",{content:e,params:n}),function $Ae(r){var t=r.content,e=r.title,n=r.extra,i=ft(ft(ft({},n.attributes),e?{title:e}:{}),{},{class:n.classes.join(" ")}),o=uC(n.styles);o.length>0&&(i.style=o);var s=[];return s.push({tag:"span",attributes:i,children:[t]}),e&&s.push({tag:"span",attributes:{class:"sr-only"},children:[e]}),s}({content:e.toString(),title:o,extra:{attributes:l,styles:f,classes:["".concat(_t.cssPrefix,"-layers-counter")].concat(id(a))}})})}}}},dNe={mixout:function(){return{text:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.transform,o=void 0===i?Hc:i,s=n.title,a=void 0===s?null:s,c=n.classes,l=void 0===c?[]:c,u=n.attributes,f=void 0===u?{}:u,g=n.styles,y=void 0===g?{}:g;return _C({type:"text",content:e},function(){return t0("beforeDOMElementCreation",{content:e,params:n}),mQ({content:e,transform:ft(ft({},Hc),o),title:a,extra:{attributes:f,styles:y,classes:["".concat(_t.cssPrefix,"-layers-text")].concat(id(l))}})})}}},provides:function(t){t.generateLayersText=function(e,n){var i=n.title,o=n.transform,s=n.extra,a=null,c=null;if(qX){var l=parseInt(getComputedStyle(e).fontSize,10),u=e.getBoundingClientRect();a=u.width/l,c=u.height/l}return _t.autoA11y&&!i&&(s.attributes["aria-hidden"]="true"),Promise.resolve([e,mQ({content:e.innerHTML,width:a,height:c,transform:o,title:i,extra:s,watchable:!0})])}}},hNe=new RegExp('"',"ug"),bQ=[1105920,1112319];function AQ(r,t){var e="".concat(nAe).concat(t.replace(":","-"));return new Promise(function(n,i){if(null!==r.getAttribute(e))return n();var s=Y5(r.children).filter(function(dt){return dt.getAttribute($N)===t})[0],a=pl.getComputedStyle(r,t),c=a.getPropertyValue("font-family").match(aAe),l=a.getPropertyValue("font-weight"),u=a.getPropertyValue("content");if(s&&!c)return r.removeChild(s),n();if(c&&"none"!==u&&""!==u){var f=a.getPropertyValue("content"),g=~["Sharp"].indexOf(c[2])?br:er,y=~["Solid","Regular","Light","Thin","Duotone","Brands","Kit"].indexOf(c[2])?ad[g][c[2].toLowerCase()]:cAe[g][l],S=function gNe(r){var t=r.replace(hNe,""),e=function wAe(r,t){var i,e=r.length,n=r.charCodeAt(t);return n>=55296&&n<=56319&&e>t+1&&(i=r.charCodeAt(t+1))>=56320&&i<=57343?1024*(n-55296)+i-56320+65536:n}(t,0),n=e>=bQ[0]&&e<=bQ[1],i=2===t.length&&t[0]===t[1];return{value:QN(i?t[0]:t),isSecondary:n||i}}(f),N=S.value,R=S.isSecondary,U=c[0].startsWith("FontAwesome"),$=tI(y,N),re=$;if(U){var _e=function xAe(r){var t=lQ[r],e=tI("fas",r);return t||(e?{prefix:"fas",iconName:e}:null)||{prefix:null,iconName:null}}(N);_e.iconName&&_e.prefix&&($=_e.iconName,y=_e.prefix)}if(!$||R||s&&s.getAttribute(WN)===y&&s.getAttribute(qN)===re)n();else{r.setAttribute(e,re),s&&r.removeChild(s);var be=function iNe(){return{iconName:null,title:null,titleId:null,prefix:null,transform:Hc,symbol:!1,mask:{iconName:null,prefix:null,rest:[]},maskId:null,extra:{classes:[],styles:{},attributes:{}}}}(),Ve=be.extra;Ve.attributes[$N]=t,cI($,y).then(function(dt){var Xt=oI(ft(ft({},be),{},{icons:{main:dt,mask:nI()},prefix:y,iconName:re,extra:Ve,watchable:!0})),u1=J1.createElementNS("http://www.w3.org/2000/svg","svg");"::before"===t?r.insertBefore(u1,r.firstChild):r.appendChild(u1),u1.outerHTML=Xt.map(function(an){return hd(an)}).join("\n"),r.removeAttribute(e),n()}).catch(i)}}else n()})}function pNe(r){return Promise.all([AQ(r,"::before"),AQ(r,"::after")])}function mNe(r){return!(r.parentNode===document.head||~iAe.indexOf(r.tagName.toUpperCase())||r.getAttribute($N)||r.parentNode&&"svg"===r.parentNode.tagName)}function NQ(r){if(Z3)return new Promise(function(t,e){var n=Y5(r.querySelectorAll("*")).filter(mNe).map(pNe),i=uI.begin("searchPseudoElements");PQ(),Promise.all(n).then(function(){i(),dI(),t()}).catch(function(){i(),dI(),e()})})}var IQ=!1,kQ=function(t){return t.toLowerCase().split(" ").reduce(function(n,i){var o=i.toLowerCase().split("-"),s=o[0],a=o.slice(1).join("-");if(s&&"h"===a)return n.flipX=!0,n;if(s&&"v"===a)return n.flipY=!0,n;if(a=parseFloat(a),isNaN(a))return n;switch(s){case"grow":n.size=n.size+a;break;case"shrink":n.size=n.size-a;break;case"left":n.x=n.x-a;break;case"right":n.x=n.x+a;break;case"up":n.y=n.y-a;break;case"down":n.y=n.y+a;break;case"rotate":n.rotate=n.rotate+a}return n},{size:16,x:0,y:0,flipX:!1,flipY:!1,rotate:0})},hI={x:0,y:0,width:"100%",height:"100%"};function RQ(r){return r.attributes&&(r.attributes.fill||!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&(r.attributes.fill="black"),r}function yNe(r){return"g"===r.tag?r.children:[r]}var MNe={hooks:function(){return{parseNodeAttributes:function(e,n){var i=n.getAttribute("data-fa-mask"),o=i?mC(i.split(" ").map(function(s){return s.trim()})):nI();return o.prefix||(o.prefix=_l()),e.mask=o,e.maskId=n.getAttribute("data-fa-mask-id"),e}}},provides:function(t){t.generateAbstractMask=function(e){var n=e.children,i=e.attributes,o=e.main,s=e.mask,a=e.maskId,u=o.icon,g=s.icon,y=function vAe(r){var t=r.transform,n=r.iconWidth,i={transform:"translate(".concat(r.containerWidth/2," 256)")},o="translate(".concat(32*t.x,", ").concat(32*t.y,") "),s="scale(".concat(t.size/16*(t.flipX?-1:1),", ").concat(t.size/16*(t.flipY?-1:1),") "),a="rotate(".concat(t.rotate," 0 0)");return{outer:i,inner:{transform:"".concat(o," ").concat(s," ").concat(a)},path:{transform:"translate(".concat(n/2*-1," -256)")}}}({transform:e.transform,containerWidth:s.width,iconWidth:o.width}),S={tag:"rect",attributes:ft(ft({},hI),{},{fill:"white"})},N=u.children?{children:u.children.map(RQ)}:{},R={tag:"g",attributes:ft({},y.inner),children:[RQ(ft({tag:u.tag,attributes:ft(ft({},u.attributes),y.path)},N))]},U={tag:"g",attributes:ft({},y.outer),children:[R]},$="mask-".concat(a||dd()),re="clip-".concat(a||dd()),_e={tag:"mask",attributes:ft(ft({},hI),{},{id:$,maskUnits:"userSpaceOnUse",maskContentUnits:"userSpaceOnUse"}),children:[S,U]},be={tag:"defs",children:[{tag:"clipPath",attributes:{id:re},children:yNe(g)},_e]};return n.push(be,{tag:"rect",attributes:ft({fill:"currentColor","clip-path":"url(#".concat(re,")"),mask:"url(#".concat($,")")},hI)}),{children:n,attributes:i}}}};!function DAe(r,t){var e=t.mixoutsTo;gQ=r,X5={},Object.keys(Q5).forEach(function(n){-1===zAe.indexOf(n)&&delete Q5[n]}),gQ.forEach(function(n){var i=n.mixout?n.mixout():{};if(Object.keys(i).forEach(function(s){"function"==typeof i[s]&&(e[s]=i[s]),"object"===nC(i[s])&&Object.keys(i[s]).forEach(function(a){e[s]||(e[s]={}),e[s][a]=i[s][a]})}),n.hooks){var o=n.hooks();Object.keys(o).forEach(function(s){X5[s]||(X5[s]=[]),X5[s].push(o[s])})}n.provides&&n.provides(Q5)})}([EAe,lNe,uNe,fNe,dNe,{hooks:function(){return{mutationObserverCallbacks:function(e){return e.pseudoElementsCallback=NQ,e}}},provides:function(t){t.pseudoElements2svg=function(e){var n=e.node;_t.searchPseudoElements&&NQ(void 0===n?J1:n)}}},{mixout:function(){return{dom:{unwatch:function(){PQ(),IQ=!0}}}},hooks:function(){return{bootstrap:function(){SQ(rI("mutationObserverCallbacks",{}))},noAuto:function(){!function eNe(){yC&&yC.disconnect()}()},watch:function(e){var n=e.observeMutationsRoot;IQ?dI():SQ(rI("mutationObserverCallbacks",{observeMutationsRoot:n}))}}}},{mixout:function(){return{parse:{transform:function(e){return kQ(e)}}}},hooks:function(){return{parseNodeAttributes:function(e,n){var i=n.getAttribute("data-fa-transform");return i&&(e.transform=kQ(i)),e}}},provides:function(t){t.generateAbstractTransformGrouping=function(e){var n=e.main,i=e.transform,s=e.iconWidth,a={transform:"translate(".concat(e.containerWidth/2," 256)")},c="translate(".concat(32*i.x,", ").concat(32*i.y,") "),l="scale(".concat(i.size/16*(i.flipX?-1:1),", ").concat(i.size/16*(i.flipY?-1:1),") "),u="rotate(".concat(i.rotate," 0 0)"),y={outer:a,inner:{transform:"".concat(c," ").concat(l," ").concat(u)},path:{transform:"translate(".concat(s/2*-1," -256)")}};return{tag:"g",attributes:ft({},y.outer),children:[{tag:"g",attributes:ft({},y.inner),children:[{tag:n.icon.tag,children:n.icon.children,attributes:ft(ft({},n.icon.attributes),y.path)}]}]}}}},MNe,{provides:function(t){var e=!1;pl.matchMedia&&(e=pl.matchMedia("(prefers-reduced-motion: reduce)").matches),t.missingIconAbstract=function(){var n=[],i={fill:"currentColor"},o={attributeType:"XML",repeatCount:"indefinite",dur:"2s"};n.push({tag:"path",attributes:ft(ft({},i),{},{d:"M156.5,447.7l-12.6,29.5c-18.7-9.5-35.9-21.2-51.5-34.9l22.7-22.7C127.6,430.5,141.5,440,156.5,447.7z M40.6,272H8.5 c1.4,21.2,5.4,41.7,11.7,61.1L50,321.2C45.1,305.5,41.8,289,40.6,272z M40.6,240c1.4-18.8,5.2-37,11.1-54.1l-29.5-12.6 C14.7,194.3,10,216.7,8.5,240H40.6z M64.3,156.5c7.8-14.9,17.2-28.8,28.1-41.5L69.7,92.3c-13.7,15.6-25.5,32.8-34.9,51.5 L64.3,156.5z M397,419.6c-13.9,12-29.4,22.3-46.1,30.4l11.9,29.8c20.7-9.9,39.8-22.6,56.9-37.6L397,419.6z M115,92.4 c13.9-12,29.4-22.3,46.1-30.4l-11.9-29.8c-20.7,9.9-39.8,22.6-56.8,37.6L115,92.4z M447.7,355.5c-7.8,14.9-17.2,28.8-28.1,41.5 l22.7,22.7c13.7-15.6,25.5-32.9,34.9-51.5L447.7,355.5z M471.4,272c-1.4,18.8-5.2,37-11.1,54.1l29.5,12.6 c7.5-21.1,12.2-43.5,13.6-66.8H471.4z M321.2,462c-15.7,5-32.2,8.2-49.2,9.4v32.1c21.2-1.4,41.7-5.4,61.1-11.7L321.2,462z M240,471.4c-18.8-1.4-37-5.2-54.1-11.1l-12.6,29.5c21.1,7.5,43.5,12.2,66.8,13.6V471.4z M462,190.8c5,15.7,8.2,32.2,9.4,49.2h32.1 c-1.4-21.2-5.4-41.7-11.7-61.1L462,190.8z M92.4,397c-12-13.9-22.3-29.4-30.4-46.1l-29.8,11.9c9.9,20.7,22.6,39.8,37.6,56.9 L92.4,397z M272,40.6c18.8,1.4,36.9,5.2,54.1,11.1l12.6-29.5C317.7,14.7,295.3,10,272,8.5V40.6z M190.8,50 c15.7-5,32.2-8.2,49.2-9.4V8.5c-21.2,1.4-41.7,5.4-61.1,11.7L190.8,50z M442.3,92.3L419.6,115c12,13.9,22.3,29.4,30.5,46.1 l29.8-11.9C470,128.5,457.3,109.4,442.3,92.3z M397,92.4l22.7-22.7c-15.6-13.7-32.8-25.5-51.5-34.9l-12.6,29.5 C370.4,72.1,384.4,81.5,397,92.4z"})});var s=ft(ft({},o),{},{attributeName:"opacity"}),a={tag:"circle",attributes:ft(ft({},i),{},{cx:"256",cy:"364",r:"28"}),children:[]};return e||a.children.push({tag:"animate",attributes:ft(ft({},o),{},{attributeName:"r",values:"28;14;28;28;14;28;"})},{tag:"animate",attributes:ft(ft({},s),{},{values:"1;0;1;1;0;1;"})}),n.push(a),n.push({tag:"path",attributes:ft(ft({},i),{},{opacity:"1",d:"M263.7,312h-16c-6.6,0-12-5.4-12-12c0-71,77.4-63.9,77.4-107.8c0-20-17.8-40.2-57.4-40.2c-29.1,0-44.3,9.6-59.2,28.7 c-3.9,5-11.1,6-16.2,2.4l-13.1-9.2c-5.6-3.9-6.9-11.8-2.6-17.2c21.2-27.2,46.4-44.7,91.2-44.7c52.3,0,97.4,29.8,97.4,80.2 c0,67.6-77.4,63.5-77.4,107.8C275.7,306.6,270.3,312,263.7,312z"}),children:e?[]:[{tag:"animate",attributes:ft(ft({},s),{},{values:"1;0;0;0;0;1;"})}]}),e||n.push({tag:"path",attributes:ft(ft({},i),{},{opacity:"0",d:"M232.5,134.5l7,168c0.3,6.4,5.6,11.5,12,11.5h9c6.4,0,11.7-5.1,12-11.5l7-168c0.3-6.8-5.2-12.5-12-12.5h-23 C237.7,122,232.2,127.7,232.5,134.5z"}),children:[{tag:"animate",attributes:ft(ft({},s),{},{values:"0;0;1;1;0;0;"})}]}),{tag:"g",attributes:{class:"missing"},children:n}}}},{hooks:function(){return{parseNodeAttributes:function(e,n){var i=n.getAttribute("data-fa-symbol");return e.symbol=null!==i&&(""===i||i),e}}}}],{mixoutsTo:ps});var ONe=ps.parse,TNe=ps.icon;const wNe=["*"],NNe=r=>{const t={[`fa-${r.animation}`]:null!=r.animation&&!r.animation.startsWith("spin"),"fa-spin":"spin"===r.animation||"spin-reverse"===r.animation,"fa-spin-pulse":"spin-pulse"===r.animation||"spin-pulse-reverse"===r.animation,"fa-spin-reverse":"spin-reverse"===r.animation||"spin-pulse-reverse"===r.animation,"fa-pulse":"spin-pulse"===r.animation||"spin-pulse-reverse"===r.animation,"fa-fw":r.fixedWidth,"fa-border":r.border,"fa-inverse":r.inverse,"fa-layers-counter":r.counter,"fa-flip-horizontal":"horizontal"===r.flip||"both"===r.flip,"fa-flip-vertical":"vertical"===r.flip||"both"===r.flip,[`fa-${r.size}`]:null!==r.size,[`fa-rotate-${r.rotate}`]:null!==r.rotate,[`fa-pull-${r.pull}`]:null!==r.pull,[`fa-stack-${r.stackItemSize}`]:null!=r.stackItemSize};return Object.keys(t).map(e=>t[e]?e:null).filter(e=>e)};let RNe=(()=>{class r{constructor(){this.defaultPrefix="fas",this.fallbackIcon=null}static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275prov=xe({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})(),xNe=(()=>{class r{constructor(){this.definitions={}}addIcons(...e){for(const n of e){n.prefix in this.definitions||(this.definitions[n.prefix]={}),this.definitions[n.prefix][n.iconName]=n;for(const i of n.icon[2])"string"==typeof i&&(this.definitions[n.prefix][i]=n)}}addIconPacks(...e){for(const n of e){const i=Object.keys(n).map(o=>n[o]);this.addIcons(...i)}}getIconDefinition(e,n){return e in this.definitions&&n in this.definitions[e]?this.definitions[e][n]:null}static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275prov=xe({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})(),LNe=(()=>{class r{constructor(){this.stackItemSize="1x"}ngOnChanges(e){if("size"in e)throw new Error('fa-icon is not allowed to customize size when used inside fa-stack. Set size on the enclosing fa-stack instead: <fa-stack size="4x">...</fa-stack>.')}static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275dir=Vt({type:r,selectors:[["fa-icon","stackItemSize",""],["fa-duotone-icon","stackItemSize",""]],inputs:{stackItemSize:"stackItemSize",size:"size"},standalone:!0,features:[n2]})}return r})(),zNe=(()=>{class r{constructor(e,n){this.renderer=e,this.elementRef=n}ngOnInit(){this.renderer.addClass(this.elementRef.nativeElement,"fa-stack")}ngOnChanges(e){"size"in e&&(null!=e.size.currentValue&&this.renderer.addClass(this.elementRef.nativeElement,`fa-${e.size.currentValue}`),null!=e.size.previousValue&&this.renderer.removeClass(this.elementRef.nativeElement,`fa-${e.size.previousValue}`))}static#e=this.\u0275fac=function(n){return new(n||r)(G(lc),G(I2))};static#t=this.\u0275cmp=Ue({type:r,selectors:[["fa-stack"]],inputs:{size:"size"},standalone:!0,features:[n2,Gg],ngContentSelectors:wNe,decls:1,vars:0,template:function(n,i){1&n&&(function iH(r){const t=Ce()[_r][w2];if(!t.projection){const n=t.projection=function ph(r,t){const e=[];for(let n=0;n<r;n++)e.push(t);return e}(r?r.length:1,null),i=n.slice();let o=t.child;for(;null!==o;){const s=r?p5e(o,r):0;null!==s&&(i[s]?i[s].projectionNext=o:n[s]=o,i[s]=o),o=o.next}}}(),function oH(r,t=0,e){const n=Ce(),i=On(),o=n8(i,Jt+r,16,null,e||null);null===o.projection&&(o.projection=t),_y(),(!n[Ma]||L0())&&32!=(32&o.flags)&&function M4e(r,t,e){iz(t[Yt],0,t,e,AM(r,e,t),QL(e.parent||t[w2],e,t))}(i,n,o)}(0))},encapsulation:2})}return r})(),n0=(()=>{class r{set spin(e){this.animation=e?"spin":void 0}set pulse(e){this.animation=e?"spin-pulse":void 0}constructor(e,n,i,o,s){this.sanitizer=e,this.config=n,this.iconLibrary=i,this.stackItem=o,this.classes=[],null!=s&&null==o&&console.error('FontAwesome: fa-icon and fa-duotone-icon elements must specify stackItemSize attribute when wrapped into fa-stack. Example: <fa-icon stackItemSize="2x"></fa-icon>.')}ngOnChanges(e){if(null!=this.icon||null!=this.config.fallbackIcon){if(e){const i=this.findIconDefinition(null!=this.icon?this.icon:this.config.fallbackIcon);if(null!=i){const o=this.buildParams();this.renderIcon(i,o)}}}else(()=>{throw new Error("Property `icon` is required for `fa-icon`/`fa-duotone-icon` components.")})()}render(){this.ngOnChanges({})}findIconDefinition(e){const n=((r,t)=>(r=>void 0!==r.prefix&&void 0!==r.iconName)(r)?r:"string"==typeof r?{prefix:t,iconName:r}:{prefix:r[0],iconName:r[1]})(e,this.config.defaultPrefix);return"icon"in n?n:this.iconLibrary.getIconDefinition(n.prefix,n.iconName)??((r=>{throw new Error(`Could not find icon with iconName=${r.iconName} and prefix=${r.prefix} in the icon library.`)})(n),null)}buildParams(){const e={flip:this.flip,animation:this.animation,border:this.border,inverse:this.inverse,size:this.size||null,pull:this.pull||null,rotate:this.rotate||null,fixedWidth:"boolean"==typeof this.fixedWidth?this.fixedWidth:this.config.fixedWidth,stackItemSize:null!=this.stackItem?this.stackItem.stackItemSize:null},n="string"==typeof this.transform?ONe.transform(this.transform):this.transform;return{title:this.title,transform:n,classes:[...NNe(e),...this.classes],mask:null!=this.mask?this.findIconDefinition(this.mask):null,styles:null!=this.styles?this.styles:{},symbol:this.symbol,attributes:{role:this.a11yRole}}}renderIcon(e,n){const i=TNe(e,n);this.renderedIconHTML=this.sanitizer.bypassSecurityTrustHtml(i.html.join("\n"))}static#e=this.\u0275fac=function(n){return new(n||r)(G(ZU),G(RNe),G(xNe),G(LNe,8),G(zNe,8))};static#t=this.\u0275cmp=Ue({type:r,selectors:[["fa-icon"]],hostAttrs:[1,"ng-fa-icon"],hostVars:2,hostBindings:function(n,i){2&n&&(zE("innerHTML",i.renderedIconHTML,o7),A("title",i.title))},inputs:{icon:"icon",title:"title",animation:"animation",spin:"spin",pulse:"pulse",mask:"mask",styles:"styles",flip:"flip",size:"size",pull:"pull",border:"border",inverse:"inverse",symbol:"symbol",rotate:"rotate",fixedWidth:"fixedWidth",classes:"classes",transform:"transform",a11yRole:"a11yRole"},standalone:!0,features:[n2,Gg],decls:0,vars:0,template:function(n,i){},encapsulation:2})}return r})(),DNe=(()=>{class r{static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275mod=Ls({type:r});static#n=this.\u0275inj=ns({})}return r})();function xQ(r,t){if(null!=r&&null!=t&&"object"==typeof r){if(null!=r.equals)return r.equals(t);{const e=r,n=t;for(const i of Object.keys(e)){if(!(i in n))return!1;if(!1===xQ(e[i],n[i]))return!1}return!0}}return r===t}function gI(r){return null==r||function VNe(r){return"object"==typeof r&&null!=r&&null!=r.equals}(r)||function $Ne(r){return"string"==typeof r||"number"==typeof r||"boolean"==typeof r||null===r}(r)||function HNe(r){if("object"==typeof r){for(const t in r)if(null!=r[t]&&!1===gI(r[t]))return!1;return null!=r&&r.constructor.prototype===Object.prototype}return!1}(r)}function zo(r,t){if(gI(r)&&gI(t))return xQ(r,t);throw new Error(`Comparing non comparable objects: ${r.constructor.name} and ${t.constructor.name}`)}class ke{static fromFunctions(t,e){return new class extends ke{encode(n){return t(n)}decode(n){return e(n)}}}static identity(){function t(e){return e}return ke.fromFunctions(t,t)}static constant(t,e){return new class extends ke{encode(n){return t}decode(n){return e}}}static tuple(t,e,n){return new class extends ke{encode(i){const o=e(i),s={};return Object.keys(o).forEach(a=>{s[a]=t[a].encode(o[a])}),s}decode(i){const o={};return Object.keys(t).reverse().forEach(s=>{o[s]=t[s].decode(i[s])}),n(Object.values(o))}}}static disjunction(t,e){return L.assert(t.length===e.length,"typePredicates and encoders should have same length"),new class extends ke{encode(n){let i=0;for(const o of t){if(!0===o(n))return{type:i,encoded:e[i].encode(n)};i++}}decode(n){const i=L.getNonNullable(n).type,o=L.getNonNullable(n).encoded;return e[i].decode(o)}}}static list(t){return new class extends ke{encode(e){return e.map(n=>{const i=t.encode(n);return L.assert(!1===Array.isArray(i),"This encoder should not encode as array"),i})}decode(e){return e.map(t.decode)}}}}class h{value;static of(t){return new h(t)}static ofNullable(t){return null==t?h.empty():h.of(t)}static empty(){return new h(null)}static getEncoder(t){return new class extends ke{encode(e){return e.isPresent()?t.encode(e.get()):null}decode(e){return null===e?h.empty():h.of(t.decode(e))}}}constructor(t){this.value=t}isPresent(){return null!=this.value}isAbsent(){return null==this.value}get(){if(this.isPresent())return this.value;throw new Error("Value is absent")}getOrElse(t){return this.isPresent()?this.value:t}equals(t){return this.isAbsent()?t.isAbsent():!t.isAbsent()&&zo(this.value,t.value)}equalsValue(t){return this.equals(h.of(t))}toString(){return this.isAbsent()?"MGPOptional.empty()":`MGPOptional.of(${this.value})`}map(t){return this.isPresent()?h.of(t(this.get())):h.empty()}}class X{static success(t){return new FNe(t)}static failure(t){return new UNe(t)}constructor(){}equals(t){return this.isFailure()?t.isFailure()&&this.getReason()===t.getReason():!t.isFailure()&&zo(this.get(),t.get())}}class FNe extends X{value;__nominal;constructor(t){super(),this.value=t}isSuccess(){return!0}isFailure(){return!1}get(){return this.value}getReason(){throw new Error("Cannot get failure reason from a success")}getReasonOr(t){return t}toOptional(){return h.of(this.value)}toString(){return`MGPFallible.success(${this.value})`}}class UNe extends X{reason;__nominal;constructor(t){super(),this.reason=t}isSuccess(){return!1}isFailure(){return!0}get(){throw new Error("Value is absent from failure, with the following reason: "+this.reason)}getReason(){return this.reason}getReasonOr(t){return this.getReason()}toOptional(){return h.empty()}toString(){return`MGPFallible.failure(${this.reason})`}toOtherFallible(){return X.failure(this.reason)}}var w;!function(r){r.SUCCESS=X.success(void 0),r.ofFallible=function t(n){return n.isSuccess()?r.SUCCESS:r.failure(n.getReason())},r.failure=function e(n){return X.failure(n)}}(w||(w={}));class r0{collectionName;collection;subDAOs={};constructor(t){this.collectionName=t;const n=rK();this.collection=function cOe(r,t,...e){if(r=Cr(r),yb("collection","path",t),r instanceof R9){const n=Rn.fromString(t,...e);return QY(n),new zc(r,null,n)}{if(!(r instanceof Wr||r instanceof zc))throw new Oe(ue.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=r._path.child(Rn.fromString(t,...e));return QY(n),new zc(r.firestore,null,n)}}(n,this.collectionName).withConverter({fromFirestore:i=>i.data(),toFirestore:i=>i})}create(t){var e=this;return M(function*(){return(yield function bOe(r,t){const e=Ln(r.firestore,U1),n=F5(r),i=z_(r.converter,t);return F9(e,[b_(q6(r.firestore),"addDoc",n._key,i,null!==r.converter,{}).toMutation(n._key,hr.exists(!1))]).then(()=>n)}(e.collection,t)).id})()}read(t){var e=this;return M(function*(){const n=yield function POe(r){r=Ln(r,Wr);const t=Ln(r.firestore,U1);return function jY(r,t,e={}){const n=new Ei;return r.asyncQueue.enqueueAndForget(M(function*(){return function(o,s,a,c,l){const u=new P_({next:g=>{s.enqueueAndForget(()=>zw(o,f));const y=g.docs.has(a);!y&&g.fromCache?l.reject(new Oe(ue.UNAVAILABLE,"Failed to get document because the client is offline.")):y&&g.fromCache&&c&&"server"===c.source?l.reject(new Oe(ue.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):l.resolve(g)},error:g=>l.reject(g)}),f=new Hw(g5(a.path),u,{includeMetadataChanges:!0,Z_:!0});return xw(o,f)}(yield H5(r),r.asyncQueue,t,e,n)})),n.promise}(qr(t),r._key).then(e=>kb(t,r,e))}(F5(e.collection,t));return n.exists()?h.of(L.getNonNullable(n.data())):h.empty()})()}exists(t){var e=this;return M(function*(){return(yield e.read(t)).isPresent()})()}update(t,e){var n=this;return M(function*(){return function TOe(r,t,e,...n){r=Ln(r,Wr);const i=Ln(r.firestore,U1),o=q6(i);let s;return s="string"==typeof(t=Cr(t))||t instanceof $6?function bb(r,t,e,n,i,o){const s=r.Su(1,t,e),a=[z9(t,n,e)],c=[i];if(o.length%2!=0)throw new Oe(ue.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<o.length;g+=2)a.push(z9(t,o[g])),c.push(o[g+1]);const l=[],u=c2.empty();for(let g=a.length-1;g>=0;--g)if(!hK(l,a[g])){const y=a[g];let S=c[g];S=Cr(S);const N=s.fu(y);if(S instanceof L9)l.push(y);else{const R=j6(S,N);null!=R&&(l.push(y),u.set(y,R))}}const f=new Ro(l);return new aK(u,f,s.fieldTransforms)}(o,"updateDoc",r._key,t,e,n):function wb(r,t,e,n){const i=r.Su(1,t,e);Ab("Data must be an object, but it was:",i,n);const o=[],s=c2.empty();el(n,(c,l)=>{const u=A_(t,c,e);l=Cr(l);const f=i.fu(u);if(l instanceof L9)o.push(u);else{const g=j6(l,f);null!=g&&(o.push(u),s.set(u,g))}});const a=new Ro(o);return new aK(s,a,i.fieldTransforms)}(o,"updateDoc",r._key,t),F9(i,[s.toMutation(r._key,hr.exists(!0))])}(F5(n.collection,t),e)})()}delete(t){return function wOe(r){return F9(Ln(r.firestore,U1),[new y5(r._key,hr.none())])}(F5(this.collection,t))}set(t,e){return function OOe(r,t,e){r=Ln(r,Wr);const n=Ln(r.firestore,U1),i=z_(r.converter,t,e);return F9(n,[b_(q6(n),"setDoc",r._key,i,null!==r.converter,e).toMutation(r._key,hr.none())])}(F5(this.collection,t),e)}subscribeToChanges(t,e){return new cn(MK(F5(this.collection,t),n=>{e(h.ofNullable(n.data()))}))}findWhere(t,e,n){var i=this;return M(function*(){const o=i.constructQuery(t,e,n);return(yield function SOe(r){r=Ln(r,l2);const t=Ln(r.firestore,U1),e=qr(t),n=new dl(t);return gK(r._query),function ZY(r,t,e={}){const n=new Ei;return r.asyncQueue.enqueueAndForget(M(function*(){return function(o,s,a,c,l){const u=new P_({next:g=>{s.enqueueAndForget(()=>zw(o,f)),g.fromCache&&"server"===c.source?l.reject(new Oe(ue.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):l.resolve(g)},error:g=>l.reject(g)}),f=new Hw(a,u,{includeMetadataChanges:!0,Z_:!0});return xw(o,f)}(yield H5(r),r.asyncQueue,t,e,n)})),n.promise}(e,r._query).then(i=>new B5(t,n,r,i))}(o)).docs.map(a=>({id:a.id,data:a.data()}))})()}observingWhere(t,e,n){const i=this.constructQuery(t,n);return new cn(MK(i,o=>{const s=[],a=[],c=[];o.docChanges().forEach(l=>{const u={id:l.doc.id,data:l.doc.data()};switch(l.type){case"added":s.push(u);break;case"modified":a.push(u);break;case"removed":c.push(u)}}),s.length>0&&(Ae.display("FirestoreDAO","subscription","firebase gave us "+s.length+" NEW "+this.collectionName),e.onDocumentCreated(s)),a.length>0&&(Ae.display("FirestoreDAO","subscription","firebase gave us "+a.length+" MODIFIED "+this.collectionName),e.onDocumentModified(a)),c.length>0&&(Ae.display("FirestoreDAO","subscription","firebase gave us "+c.length+" DELETED "+this.collectionName),e.onDocumentDeleted(c))}))}constructQuery(t,e,n){let i=k_(this.collection);null!=e&&(i=k_(i,function COe(r,t="asc"){const e=t,n=I_("orderBy",r);return Ib._create(n,e)}(e))),null!=n&&(i=k_(i,function vOe(r){return function JY(r,t){if(t<=0)throw new Oe(ue.INVALID_ARGUMENT,`Function ${r}() requires a positive number, but it was: ${t}.`)}("limit",r),R_._create("limit",r,"F")}(n)));for(const o of t)i=k_(i,_Oe(o[0],o[1],o[2]));return i}subCollectionDAO(t,e){const n=`${this.collection.path}/${t}/${e}`;if(n in this.subDAOs)return this.subDAOs[n];{const i=new class extends r0{constructor(){super(n)}};return this.subDAOs[n]=i,i}}}let GNe=(()=>{class r extends r0{constructor(){super("errors")}static \u0275fac=function(n){return new(n||r)};static \u0275prov=xe({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();var BNe=Is(1960);let Ut=(()=>{class r{infoMessage(e){this.message(e,"is-info")}gameMessage(e){this.message(e,"is-warning")}criticalMessage(e){this.message(e,"is-danger")}message(e,n){const i=this.getDurationInMs(e);this.toast(e,n,i)}toast(e,n,i){(0,BNe.toast)({message:e,duration:i,type:n,position:"top-center",closeOnClick:!0,dismissible:!0})}getDurationInMs(e){const o=60*e.split(" ").length*1e3/150;return Math.max(o,3e3)}static \u0275fac=function(n){return new(n||r)};static \u0275prov=xe({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();class u2{errorDAO;router;messageDisplayer;static singleton=h.empty();static logErrorAndFail(t,e,n){throw u2.logError(t,e,n),new Error(`${t}: ${e} (extra data: ${JSON.stringify(n)})`)}static logError(t,e,n){if(this.singleton.isAbsent())throw new Error(`${t}: ${e} (extra data: ${JSON.stringify(n)})`);return this.singleton.get().logError(t,e,n),w.failure(t+": "+e)}constructor(t,e,n){this.errorDAO=t,this.router=e,this.messageDisplayer=n,u2.singleton=h.of(this)}findErrors(t,e,n,i){return this.errorDAO.findWhere(void 0===i?[["component","==",t],["route","==",e],["message","==",n]]:[["component","==",t],["route","==",e],["message","==",n],["data","==",i]])}logError(t,e,n){var i=this;return M(function*(){i.messageDisplayer.criticalMessage($localize`An unexpected error was encountered. We have logged it and will try to fix its cause as soon as possible.`);const o=i.router.url,s=yield i.findErrors(t,o,e,n);if(0===s.length){const a={component:t,route:o,message:e,firstEncounter:Dc(),lastEncounter:Dc(),occurences:1};null!=n&&(a.data=n),yield i.errorDAO.create(a)}else{const a=s[0].id,c=s[0].data;yield i.errorDAO.update(a,{lastEncounter:Dc(),occurences:c.occurences+1})}})()}static \u0275fac=function(e){return new(e||u2)(ze(GNe),ze(Qn),ze(Ut))};static \u0275prov=xe({token:u2,factory:u2.\u0275fac,providedIn:"root"})}class Ae{static enableLog(t,e,n){const i=localStorage.getItem("verbosity");let o={};null!=i&&(o=JSON.parse(i)),void 0===n?o[e]=t:o[e+"."+n]=t;const s=Ae.getStringified(o);localStorage.setItem("verbosity",s)}static getStringified(t){try{return JSON.stringify(t)}catch{return"recursive and not stringifiable!"}}static isVerbose(t){const e=localStorage.getItem("verbosity");if(null==e)return[!1,!1];try{const n=JSON.parse(e);return null==n[t]?[!1,!1]:(L.assert(Array.isArray(n[t]),`malformed verbosity levels for ${t}: ${n[t]}`),n[t])}catch{throw new Error(`malformed verbosity object: ${e}`)}}static isMethodVerboseEntry(t,e){return Ae.isVerbose(t)[0]||Ae.isVerbose(t+"."+e)[0]}static isMethodVerboseExit(t,e){return Ae.isVerbose(t)[1]||Ae.isVerbose(t+"."+e)[1]}static display(t,e,n){Ae.isMethodVerboseEntry(t,e)&&console.log(`${t}.${e}: ${n}`)}static log(t){const e=t.name;for(const n of Object.getOwnPropertyNames(t.prototype)){const i=Object.getOwnPropertyDescriptor(t.prototype,n),o=L.getNonNullable(i);L.assert(o.value instanceof Function,"cannot add logging to properties that are not methods!");const a=o.value;o.value=function(...c){if(Ae.isMethodVerboseEntry(e,n)){const u=Array.from(c).map(Ae.getStringified).join(", ");console.log(`> ${e}.${n}(${u})`)}const l=a.apply(this,c);return Ae.isMethodVerboseExit(e,n)&&console.log(`< ${e}.${n} -> ${Ae.getStringified(l)}`),l},Object.defineProperty(t.prototype,n,o)}}}window.enableLog=Ae.enableLog;class L{static expectToBe(t,e,n){if(t!==e)throw void 0!==n?new Error(n):new Error(`A default switch case did not observe the correct value, expected ${e}, but got ${t} instead.`)}static expectToBeMultiple(t,e){let n=!1;for(const i of e)if(t===i){n=!0;break}if(!1===n)throw new Error(`A default switch case did not observe the correct value, expected a value among ${e}, but got ${t} instead.`)}static getNonNullable(t){if(null==t)throw new Error("Expected value not to be null or undefined, but it was.");return t}static assert(t,e){if(!1===t)throw u2.logError("Assertion failure",e),new Error(`Assertion failure: ${e}`)}static identity(t){return t}}let pI=class kv extends r0{constructor(){super("chats")}static \u0275fac=function(e){return new(e||kv)};static \u0275prov=xe({token:kv,factory:kv.\u0275fac,providedIn:"root"})};pI=function(r,t,e,n){var s,i=arguments.length,o=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,e):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,t,e,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(t,e,o):s(t,e))||o);return i>3&&o&&Object.defineProperty(t,e,o),o}([Ae.log],pI);let LQ=(()=>class r{static CANNOT_SEND_MESSAGE=()=>$localize`You're not allowed to send a message here.`;static FORBIDDEN_MESSAGE=()=>$localize`This message is forbidden.`})(),J5=class Rv{chatDAO;constructor(t){this.chatDAO=t}addMessage(t,e){var n=this;return M(function*(){return n.chatDAO.subCollectionDAO(t,"messages").create(e)})()}getLastMessages(t,e){var n=this;return M(function*(){return n.chatDAO.subCollectionDAO(t,"messages").findWhere([],"postedTime",e)})()}subscribeToMessages(t,e){return this.chatDAO.subCollectionDAO(t,"messages").observingWhere([],e,"postedTime")}deleteChat(t){var e=this;return M(function*(){return e.chatDAO.delete(t)})()}createNewChat(t){var e=this;return M(function*(){return e.chatDAO.set(t,{})})()}sendMessage(t,e,n,i){var o=this;return M(function*(){if(!1===o.userCanSendMessage(e.name,t))return w.failure(LQ.CANNOT_SEND_MESSAGE());if(o.isForbiddenMessage(n))return w.failure(LQ.FORBIDDEN_MESSAGE());const s={content:n,sender:e,postedTime:Dc(),currentTurn:i};return yield o.addMessage(t,s),w.SUCCESS})()}userCanSendMessage(t,e){return""!==t}isForbiddenMessage(t){return""===t}static \u0275fac=function(e){return new(e||Rv)(ze(pI))};static \u0275prov=xe({token:Rv,factory:Rv.\u0275fac,providedIn:"root"})};function pn(r,t,e){if(!1===r)throw void 0!==e&&console.log(e),u2.logError("Assertion failure",t),new Error(`Assertion failure: ${t}`)}J5=function(r,t,e,n){var s,i=arguments.length,o=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,e):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,t,e,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(t,e,o):s(t,e))||o);return i>3&&o&&Object.defineProperty(t,e,o),o}([Ae.log],J5);let pd=class xv extends r0{constructor(){super("users")}static \u0275fac=function(e){return new(e||xv)};static \u0275prov=xe({token:xv,factory:xv.\u0275fac,providedIn:"root"})};pd=function(r,t,e,n){var s,i=arguments.length,o=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,e):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,t,e,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(t,e,o):s(t,e))||o);return i>3&&o&&Object.defineProperty(t,e,o),o}([Ae.log],pd);let eu=(()=>{class r{userDAO;constructor(e){this.userDAO=e}usernameIsAvailable(e){var n=this;return M(function*(){return 0===(yield n.userDAO.findWhere([["username","==",e]])).length})()}setUsername(e,n){var i=this;return M(function*(){yield i.userDAO.update(e,{username:n})})()}markAsVerified(e){var n=this;return M(function*(){yield n.userDAO.update(e,{verified:!0})})()}observeUserOnServer(e,n){return this.userDAO.subscribeToChanges(e,i=>{i.isPresent()&&null===i.get().lastUpdateTime||n(i)})}getUserLastUpdateTime(e){var n=this;return M(function*(){const i=yield n.userDAO.read(e);if(i.isAbsent())return h.empty();{const o=i.get().lastUpdateTime;return pn(null!=o,"should not receive a lastUpdateTime equal to null"),h.of(o)}})()}updatePresenceToken(e){return this.userDAO.update(e,{lastUpdateTime:Dc()})}getServerTime(e){var n=this;return M(function*(){return new Promise(i=>{let o=!1;const a=n.userDAO.subscribeToChanges(e,c=>{null==c.get().lastUpdateTime?o=!0:o&&(a.unsubscribe(),i(c.get().lastUpdateTime))});n.updatePresenceToken(e)})})()}static \u0275fac=function(n){return new(n||r)(ze(pd))};static \u0275prov=xe({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();const zQ={now:()=>(zQ.delegate||Date).now(),delegate:void 0};class DQ extends xs{constructor(t=1/0,e=1/0,n=zQ){super(),this._bufferSize=t,this._windowTime=e,this._timestampProvider=n,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=e===1/0,this._bufferSize=Math.max(1,t),this._windowTime=Math.max(1,e)}next(t){const{isStopped:e,_buffer:n,_infiniteTimeWindow:i,_timestampProvider:o,_windowTime:s}=this;e||(n.push(t),!i&&n.push(o.now()+s)),this._trimBuffer(),super.next(t)}_subscribe(t){this._throwIfClosed(),this._trimBuffer();const e=this._innerSubscribe(t),{_infiniteTimeWindow:n,_buffer:i}=this,o=i.slice();for(let s=0;s<o.length&&!t.closed;s+=n?1:2)t.next(o[s]);return this._checkFinalizedStatuses(t),e}_trimBuffer(){const{_bufferSize:t,_timestampProvider:e,_buffer:n,_infiniteTimeWindow:i}=this,o=(i?1:2)*t;if(t<1/0&&o<n.length&&n.splice(0,n.length-o),!i){const s=e.now();let a=0;for(let c=1;c<n.length&&n[c]<=s;c+=2)a=c;a&&n.splice(0,a+1)}}}let md=(()=>class r{static YOU_ARE_ALREADY_PLAYING=()=>$localize`You are already playing in another game.`;static YOU_ARE_ALREADY_CREATING=()=>$localize`You are already the creator of another game.`;static YOU_ARE_ALREADY_CHOSEN_OPPONENT=()=>$localize`You are already the chosen opponent in another game.`;static YOU_ARE_ALREADY_CANDIDATE=()=>$localize`You are already candidate in another game.`;static YOU_ARE_ALREADY_OBSERVING=()=>$localize`You are already observing another game.`})();class vl{static createUserWithEmailAndPassword(t,e,n){return function JTe(r,t,e){return WA.apply(this,arguments)}(t,e,n)}static sendEmailVerification(t){return function nwe(r,t){return KA.apply(this,arguments)}(t)}static sendPasswordResetEmail(t,e){return function XTe(r,t,e){return FA.apply(this,arguments)}(t,e)}static signInWithEmailAndPassword(t,e,n){return M(function*(){return(yield function ewe(r,t,e){return function NA(r,t){return IA.apply(this,arguments)}(Cr(r),nX.credential(t,e)).catch(function(){var n=M(function*(i){throw"auth/password-does-not-meet-requirements"===i.code&&VA(r),i});return function(i){return n.apply(this,arguments)}}())}(t,e,n)).user})()}static signInWithPopup(t,e){return M(function*(){return(yield function Qwe(r,t,e){return MN.apply(this,arguments)}(t,e)).user})()}static updateProfile(t,e){return function iwe(r,t){return JA.apply(this,arguments)}(t,e)}}class o0{id;email;username;verified;static NOT_CONNECTED=new o0("",h.empty(),h.empty(),!1);constructor(t,e,n,i){this.id=t,this.email=e,this.username=n,this.verified=i}isConnected(){return this.email.isPresent()}toMinimalUser(){return{id:this.id,name:this.username.get()}}equals(t){return this.id===t.id&&this.email.equals(t.email)&&this.username.equals(t.username)&&this.verified===t.verified}}let gr=class Lv{userDAO;userService;authSubscription;user=h.empty();userRS;userObs;userSubscription=new cn;auth;constructor(t,e){var n=this;this.userDAO=t,this.userService=e,this.auth=LX(),this.userRS=new DQ(1),this.userObs=this.userRS.asObservable(),this.authSubscription=new cn(function dwe(r,t,e,n){return Cr(r).onAuthStateChanged(t,e,n)}(this.auth,function(){var i=M(function*(o){null==o?(Ae.display("ConnectedUserService","subscription","User is not connected"),n.userSubscription.unsubscribe(),n.userRS.next(o0.NOT_CONNECTED),n.user=h.empty()):(pn(n.user.isAbsent(),"ConnectedUserService received a double update for an user, this is unexpected"),n.userSubscription=n.userDAO.subscribeToChanges(o.uid,s=>{if(s.isPresent()){const a=s.get(),c=a.username;Ae.display("ConnectedUserService","subscription",`User ${c} is connected, and the verified status is ${n.emailVerified(o)}`);const l=!0===n.emailVerified(o)&&null!=c;if(!0===l&&!1===a.verified)return n.userService.markAsVerified(o.uid);const u=new o0(o.uid,h.ofNullable(o.email),h.ofNullable(c),l);!1===n.user.equalsValue(u)&&(n.user=h.of(u),n.userRS.next(u))}}))});return function(o){return i.apply(this,arguments)}}()))}emailVerified(t){return t.emailVerified}sendPasswordResetEmail(t){var e=this;return M(function*(){try{return yield vl.sendPasswordResetEmail(e.auth,t),w.SUCCESS}catch(n){return e.catchFirebaseError(n)}})()}doRegister(t,e,n){var i=this;return M(function*(){return(yield i.userService.usernameIsAvailable(t))?i.registerAfterUsernameCheck(t,e,n):X.failure($localize`This username is already in use.`)})()}registerAfterUsernameCheck(t,e,n){var i=this;return M(function*(){try{const o=yield vl.createUserWithEmailAndPassword(i.auth,e,n);yield vl.signInWithEmailAndPassword(i.auth,e,n);const s=L.getNonNullable(o.user);return yield i.createUser(s.uid,t),X.success(s)}catch(o){return i.catchFirebaseError(o)}})()}catchFirebaseError(t){if(t instanceof bc)return X.failure(this.mapFirebaseError(t));throw t}mapFirebaseError(t){switch(t.code){case"auth/email-already-in-use":return $localize`This email address is already in use.`;case"auth/invalid-email":return $localize`This email address is invalid.`;case"auth/user-not-found":case"auth/wrong-password":return $localize`You have entered invalid credentials.`;case"auth/invalid-credential":return $localize`The credential is invalid or has expired, please try again.`;case"auth/weak-password":return $localize`Your password is too weak, please use a stronger password.`;case"auth/too-many-requests":return $localize`There has been too many requests from your device. You are temporarily blocked due to unusual activity. Try again later.`;case"auth/popup-closed-by-user":return $localize`You closed the authentication popup without finalizing your log in.`;case"auth/popup-blocked":return $localize`The authentication popup was blocked. Try again after disabling popup blocking.`;default:return u2.logError("ConnectedUserService","Unsupported firebase error",{errorCode:t.code,errorMessage:t.message}),t.message}}sendEmailVerification(){var t=this;return M(function*(){const e=h.ofNullable(t.auth.currentUser);if(!e.isPresent())return u2.logError("ConnectedUserService","Unlogged users cannot request for email verification");if(t.emailVerified(e.get()))return u2.logError("ConnectedUserService","Verified users should not ask email verification after being verified");try{return yield vl.sendEmailVerification(e.get()),w.SUCCESS}catch(n){return t.catchFirebaseError(n)}})()}doEmailLogin(t,e){var n=this;return M(function*(){try{return yield vl.signInWithEmailAndPassword(n.auth,t,e),w.SUCCESS}catch(i){return n.catchFirebaseError(i)}})()}createUser(t,e){var n=this;return M(function*(){null==e?yield n.userDAO.set(t,{verified:!1,currentGame:null}):yield n.userDAO.set(t,{username:e,verified:!1,currentGame:null})})()}doGoogleLogin(){var t=this;return M(function*(){return w.ofFallible(yield t.registerOrLoginWithGoogle())})()}registerOrLoginWithGoogle(){var t=this;return M(function*(){try{const e=new WTe;e.addScope("profile"),e.addScope("email");const n=yield vl.signInWithPopup(t.auth,e);return!1===(yield t.userDAO.exists(n.uid))&&(yield t.createUser(n.uid)),X.success(n)}catch(e){return t.catchFirebaseError(e)}})()}disconnect(){var t=this;return M(function*(){return h.ofNullable(t.auth.currentUser).isPresent()?(yield t.auth.signOut(),w.SUCCESS):w.failure("Cannot disconnect a non-connected user")})()}subscribeToUser(t){return this.userObs.subscribe(t)}setUsername(t){var e=this;return M(function*(){if(""===t)return w.failure($localize`Your username may not be empty.`);try{if(!1===(yield e.userService.usernameIsAvailable(t)))return w.failure($localize`This username is already in use, please select a different one.`);const i=L.getNonNullable(e.auth.currentUser);return yield vl.updateProfile(i,{displayName:t}),yield e.userService.setUsername(i.uid,t),yield e.userService.markAsVerified(i.uid),yield e.reloadUser(),w.SUCCESS}catch(n){return e.catchFirebaseError(n)}})()}setPicture(t){var e=this;return M(function*(){try{const n=L.getNonNullable(e.auth.currentUser);return yield vl.updateProfile(n,{photoURL:t}),w.SUCCESS}catch(n){return e.catchFirebaseError(n)}})()}reloadUser(){var t=this;return M(function*(){const e=L.getNonNullable(t.auth.currentUser);yield e.getIdToken(!0),yield e.reload()})()}sendPresenceToken(){return pn(this.user.isPresent(),"Should not call sendPresenceToken when not connected"),this.userService.updatePresenceToken(this.user.get().id)}ngOnDestroy(){this.userSubscription.unsubscribe(),this.authSubscription.unsubscribe()}static \u0275fac=function(e){return new(e||Lv)(ze(pd),ze(eu))};static \u0275prov=xe({token:Lv,factory:Lv.\u0275fac,providedIn:"root"})};gr=function(r,t,e,n){var s,i=arguments.length,o=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,e):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,t,e,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(t,e,o):s(t,e))||o);return i>3&&o&&Object.defineProperty(t,e,o),o}([Ae.log],gr);class tr{value;static HARD_DRAW=new tr(0);static RESIGN=new tr(1);static VICTORY=new tr(3);static TIMEOUT=new tr(4);static UNACHIEVED=new tr(5);static AGREED_DRAW_BY_ZERO=new tr(6);static AGREED_DRAW_BY_ONE=new tr(7);constructor(t){this.value=t}}class MC{id;data;constructor(t,e){this.id=t,this.data=e}getTurn(){return this.data.turn}isHardDraw(){return this.data.result===tr.HARD_DRAW.value}isAgreedDraw(){return this.data.result===tr.AGREED_DRAW_BY_ZERO.value||this.data.result===tr.AGREED_DRAW_BY_ONE.value}getDrawAccepter(){return this.data.result===tr.AGREED_DRAW_BY_ZERO.value?this.data.playerZero:(pn(this.data.result===tr.AGREED_DRAW_BY_ONE.value,"should not access getDrawAccepter when no draw accepted!"),L.getNonNullable(this.data.playerOne))}isWin(){return this.data.result===tr.VICTORY.value}isTimeout(){return this.data.result===tr.TIMEOUT.value}isResign(){return this.data.result===tr.RESIGN.value}getWinner(){return h.ofNullable(this.data.winner)}getLoser(){return h.ofNullable(this.data.loser)}setWinnerAndLoser(t,e){return new MC(this.id,{...this.data,winner:t,loser:e})}}class f2{value;constructor(t){this.value=t}static CREATOR=new f2("CREATOR");static RANDOM=new f2("RANDOM");static CHOSEN_PLAYER=new f2("CHOSEN_PLAYER");static of(t){switch(t){case"CREATOR":return f2.CREATOR;case"RANDOM":return f2.RANDOM;default:return pn("CHOSEN_PLAYER"===t,"Invalid value for FirstPlayer: "+t+"."),f2.CHOSEN_PLAYER}}}class Ui{value;constructor(t){this.value=t}static STANDARD=new Ui("STANDARD");static BLITZ=new Ui("BLITZ");static CUSTOM=new Ui("CUSTOM");static NORMAL_MOVE_DURATION=120;static NORMAL_PART_DURATION=1800;static BLITZ_MOVE_DURATION=30;static BLITZ_PART_DURATION=900;static of(t){switch(t){case"STANDARD":return Ui.STANDARD;case"BLITZ":return Ui.BLITZ;case"CUSTOM":return Ui.CUSTOM;default:throw new Error("Invalid part type: "+t+".")}}}class d2{value;constructor(t){this.value=t}static PART_CREATED=new d2(0);static CONFIG_PROPOSED=new d2(2);static PART_STARTED=new d2(3);static PART_FINISHED=new d2(4)}class mI{static NONE=new mI;value=2;constructor(){}isPlayer(){return!1}toString(){return"PLAYER_NONE"}equals(t){return this===t}getValue(){return this.value}}class O{value;static encoder=ke.tuple([ke.identity()],t=>[t.getValue()],t=>O.of(t[0]));static ZERO=new O(0);static ONE=new O(1);static PLAYERS=[O.ZERO,O.ONE];static of(t){return 0===t?O.ZERO:(L.expectToBe(t,1),O.ONE)}static ofTurn(t){return t%2==0?O.ZERO:O.ONE}constructor(t){this.value=t}isPlayer(){return!0}toString(){return this===O.ZERO?"PLAYER_ZERO":(L.expectToBe(this,O.ONE,"Player should not be something else than Player.ZERO and Player.ONE"),"PLAYER_ONE")}equals(t){return this===t}getScoreModifier(){return 0===this.value?-1:1}getPreVictory(){return this.getVictoryValue()-this.getScoreModifier()}getVictoryValue(){return this===O.ZERO?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER}getOpponent(){return this===O.ZERO?O.ONE:(L.expectToBe(this,O.ONE),O.ZERO)}getValue(){return this.value}}var B;!function(r){r.ZERO=O.ZERO,r.ONE=O.ONE,r.NONE=mI.NONE,r.encoder=new class extends ke{encode(t){return t.getValue()}decode(t){return 2===t?r.NONE:(L.assert(0===t||1===t,"Invalid encoded player: "+t),O.of(t))}}}(B||(B={}));let _d=class zv extends r0{constructor(){super("parts")}static \u0275fac=function(e){return new(e||zv)};static \u0275prov=xe({token:zv,factory:zv.\u0275fac,providedIn:"root"})};_d=function(r,t,e,n){var s,i=arguments.length,o=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,e):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,t,e,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(t,e,o):s(t,e))||o);return i>3&&o&&Object.defineProperty(t,e,o),o}([Ae.log],_d);class EC{onDocumentCreated;onDocumentModified;onDocumentDeleted;constructor(t,e,n){this.onDocumentCreated=t,this.onDocumentModified=e,this.onDocumentDeleted=n}}let _I=(()=>{class r{partDAO;constructor(e){this.partDAO=e}eventsCollection(e){return this.partDAO.subCollectionDAO(e,"events")}addEvent(e,n){return this.eventsCollection(e).create(n)}addMove(e,n,i){return this.addEvent(e,{eventType:"Move",time:Dc(),user:n,move:i})}addRequest(e,n,i){return this.addEvent(e,{eventType:"Request",time:Dc(),user:n,requestType:i})}addReply(e,n,i,o,s=null){return this.addEvent(e,{eventType:"Reply",time:Dc(),user:n,reply:i,requestType:o,data:s})}addAction(e,n,i){return this.addEvent(e,{eventType:"Action",time:Dc(),user:n,action:i})}startGame(e,n){return this.addAction(e,n,"StartGame")}subscribeToEvents(e,n){const i=new EC(o=>{const s=o.map(a=>a.data).filter(a=>null!=a.time);s.length>0&&n(s)},o=>{n(o.map(s=>s.data))},()=>{});return this.eventsCollection(e).observingWhere([],i,"time")}static \u0275fac=function(n){return new(n||r)(ze(_d))};static \u0275prov=xe({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();class h2{__nominal}class un{x;static encoder=ke.tuple([ke.identity()],t=>[t.x],t=>un.of(t[0]));static ZERO=new un(0);static ONE=new un(1);static TWO=new un(2);static THREE=new un(3);static of(t){switch(t){case 0:return un.ZERO;case 1:return un.ONE;case 2:return un.TWO;default:return pn(3===t,"Invalid Apagos Coord "+t),un.THREE}}constructor(t){this.x=t}equals(t){return this.x===t.x}}let tu=(()=>class r{static PIECE_SHOULD_MOVE_DOWNWARD=()=>$localize`Pieces should only move downward!`;static CANNOT_LAND_ON_A_FULL_SQUARE=()=>$localize`That square is already full, you cannot put a piece in it!`;static NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE=()=>$localize`You have no pieces in that square, select one that contains at least one of your pieces!`;static NO_PIECE_REMAINING_TO_DROP=()=>$localize`There are no remaining pieces of that color to drop!`;static NO_POSSIBLE_TRANSFER_REMAINS=()=>$localize`There is no possible transfer from that square!`})();class nr extends h2{landing;piece;starting;static ALL_MOVES=[new nr(un.ZERO,h.of(O.ZERO),h.empty()),new nr(un.ONE,h.of(O.ZERO),h.empty()),new nr(un.TWO,h.of(O.ZERO),h.empty()),new nr(un.THREE,h.of(O.ZERO),h.empty()),new nr(un.ZERO,h.of(O.ONE),h.empty()),new nr(un.ONE,h.of(O.ONE),h.empty()),new nr(un.TWO,h.of(O.ONE),h.empty()),new nr(un.THREE,h.of(O.ONE),h.empty()),new nr(un.TWO,h.empty(),h.of(un.THREE)),new nr(un.ONE,h.empty(),h.of(un.THREE)),new nr(un.ZERO,h.empty(),h.of(un.THREE)),new nr(un.ONE,h.empty(),h.of(un.TWO)),new nr(un.ZERO,h.empty(),h.of(un.TWO)),new nr(un.ZERO,h.empty(),h.of(un.ONE))];static encoder=ke.tuple([un.encoder,h.getEncoder(O.encoder),h.getEncoder(un.encoder)],t=>[t.landing,t.piece,t.starting],t=>new nr(t[0],t[1],t[2]));static drop(t,e){return L.getNonNullable(nr.ALL_MOVES.find(i=>i.landing.equals(t)&&i.piece.equalsValue(e)&&i.starting.equals(h.empty())))}static transfer(t,e){if(t.x<=e.x)return X.failure(tu.PIECE_SHOULD_MOVE_DOWNWARD());const n=L.getNonNullable(nr.ALL_MOVES.find(i=>i.landing.equals(e)&&i.piece.equals(h.empty())&&i.starting.equals(h.of(t))));return X.success(n)}constructor(t,e,n){super(),this.landing=t,this.piece=e,this.starting=n}isDrop(){return this.piece.isPresent()}toString(){return this.isDrop()?"ApagosMove.drop("+this.piece.get().toString()+" on "+this.landing.x+")":"ApagosMove.slideDown("+this.starting.get().x+" > "+this.landing.x+")"}equals(t){return!1!==this.starting.equals(t.starting)&&!1!==this.landing.equals(t.landing)&&this.piece.equals(t.piece)}}class PC{turn;constructor(t){this.turn=t}getCurrentPlayer(){return O.ofTurn(this.turn)}getCurrentOpponent(){return this.turn%2==1?O.ZERO:O.ONE}}class VQ{static toComparableObjectSet(t){const e=[];return t.forEach(n=>{!1===e.some(i=>i.equals(n))&&e.push(n)}),e}static toComparableSet(t){const e=[];return t.forEach(n=>{!1===e.some(i=>zo(i,n))&&e.push(n)}),e}}class st{values;constructor(t){this.values=void 0===t?[]:VQ.toComparableSet(t)}equals(t){if(t.size()!==this.size())return!1;for(const e of this)if(!1===t.contains(e))return!1;return!0}toString(){let t="";for(const e of this)t+=null==e?"null, ":e.toString()+", ";return"["+t.slice(0,-2)+"]"}add(t){return!this.contains(t)&&(this.values.push(t),!0)}remove(t){for(let e=0;e<this.values.length;e++)if(zo(this.values[e],t))return this.values.splice(e,1),!0;return!1}addAll(t){for(const e of t)this.add(e)}union(t){const e=new st(this.toList());return e.addAll(t),e}contains(t){for(const e of this.values)if(zo(e,t))return!0;return!1}size(){return this.values.length}toList(){const t=[];for(const e of this)t.push(e);return t}getAnyElement(){return this.size()>0?h.of(this.values[0]):h.empty()}isEmpty(){return 0===this.values.length}hasElements(){return!1===this.isEmpty()}map(t){const e=[];for(const n of this.values)e.push(t(n));return new st(e)}flatMap(t){const e=new st;for(const n of this)e.addAll(t(n));return e}filter(t){const e=new st;for(const n of this)t(n)&&e.add(n);return e}findAnyCommonElement(t){for(const e of t)if(this.contains(e))return h.of(e);return h.empty()}intersection(t){const e=new st;for(const n of t)this.contains(n)&&e.add(n);return e}getMissingElementFrom(t){for(const e of t)if(!1===this.contains(e))return h.of(e);return h.empty()}[Symbol.iterator](){return this.values.values()}}class gn{map;isImmutable;static from(t){const e=Object.keys(t),n=new gn;for(const i of e)n.set(i,t[i]);return n}constructor(t=[],e=!1){this.map=t,this.isImmutable=e}makeImmutable(){this.isImmutable=!0}get(t){for(const e of this.map)if(zo(e.key,t))return h.of(e.value);return h.empty()}getAnyPair(){return this.size()>0?h.of(this.map[0]):h.empty()}forEach(t){for(const e of this.map)t(e)}putAll(t){this.assertImmutability("putAll");for(const e of t.map)this.put(e.key,e.value)}assertImmutability(t){L.assert(!1===this.isImmutable,"Cannot call "+t+" on immutable map!")}put(t,e){this.assertImmutability("put");for(const n of this.map)if(zo(n.key,t)){const i=n.value;return n.value=e,h.of(i)}return this.map.push({key:t,value:e}),h.empty()}containsKey(t){return this.map.some(e=>zo(e.key,t))}size(){return this.map.length}listKeys(){return this.map.map(t=>t.key)}listValues(){return this.map.map(t=>t.value)}getKeySet(){return new st(this.listKeys())}filter(t){const e=new gn;for(const n of this.map)t(n.key,n.value)&&e.set(n.key,n.value);return e}replace(t,e){if(this.assertImmutability("replace"),this.get(t).isAbsent())throw new Error("No Value to replace for key "+t.toString()+"!");return this.put(t,e),e}set(t,e){if(this.assertImmutability("set"),this.containsKey(t))throw new Error("Key "+t.toString()+" already exist in Map!");this.map.push({key:t,value:e})}delete(t){this.assertImmutability("delete");for(let e=0;e<this.map.length;e++)if(zo(this.map[e].key,t)){const i=this.map[e].value,o=this.map.slice(0,e),s=this.map.slice(e+1);return this.map=o.concat(s),i}throw new Error('No Value to delete for key "'+t.toString()+'"!')}getCopy(){const t=new this.constructor;for(const e of this.listKeys())t.set(e,this.get(e).get());return t}equals(t){const e=this.getKeySet(),n=t.getKeySet();if(!1===e.equals(n))return!1;for(const i of e){const o=this.get(i).get(),s=t.get(i);if(pn(s.isPresent(),"value is absent in a map even though its key is present!"),!1===zo(o,s.get()))return!1}return!0}}class nu extends gn{reverse(){const t=new nu;for(const e of this.listKeys()){const n=this.get(e).get();if(t.containsKey(n))t.get(n).get().add(e);else{const i=new st;i.add(e),t.set(n,i)}}return t}}class yt{static create(t,e){const n=[];for(let i=0;i<t;i++)n.push(e);return n}static copy(t){return t.map(e=>e)}static sortByDescending(t,e){t.sort((n,i)=>{const o=e(n),s=e(i);return o<s?1:o>s?-1:0})}static equals(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!1===zo(t[n],e[n]))return!1;return!0}static isPrefix(t,e){return!(t.length>e.length)&&yt.equals(t,e.slice(0,t.length))}static range(t){const e=[];for(let n=0;n<t;n++)e.push(n);return e}static smallerFirst(t,e){return t-e}static getRandomElement(t){return L.assert(t.length>0,"ArrayUtils.getRandomElement must be called on an array containing elements"),t[Math.floor(Math.random()*t.length)]}static maximumsBy(t,e){let n=[],i=-1/0;for(const o of t){const s=e(o);s>=i&&(s>i&&(n=[]),i=s,n.push(o))}return n}static count(t,e){let n=0;for(const i of t)zo(i,e)&&n++;return n}static isLessThan(t,e){L.assert(t.length>0&&e.length>0,"ArrayUtils.isLessThan/isGreaterThan should have two non-empty list as parameter");const n=Math.min(t.length,e.length);for(let i=0;i<n;i++)if(e[i]!==t[i])return t[i]<e[i];return!1}static isGreaterThan(t,e){return yt.isLessThan(e,t)}static min(t,e){return yt.isLessThan(t,e)?t:e}static max(t,e){return yt.isGreaterThan(t,e)?t:e}}class rt{static sum(t){let e=0;for(const n of t)for(const i of n)e+=i;return e}static add(t,e){const n=t[0].length,i=t.length;L.assert(i===e.length,"Table should have same height"),L.assert(n===e[0].length,"Table should have same width");const o=rt.create(n,i,0);for(let s=0;s<i;s++)for(let a=0;a<n;a++)o[s][a]=t[s][a]+e[s][a];return o}static create(t,e,n){const i=[];for(let o=0;o<e;o++)i.push(yt.create(t,n));return i}static map(t,e){return t.map(n=>n.map(e))}static copy(t){return rt.map(t,e=>e)}static compare(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!1===yt.equals(t[n],e[n]))return!1;return!0}}class HQ{content=new gn;get(t){const e=this.content.get(t.y);return e.isAbsent()?h.empty():e.get().get(t.x)}set(t,e){const n=this.content.get(t.y);let i;n.isPresent()?i=n.get():(i=new gn,this.content.set(t.y,i)),i.set(t.x,e)}[Symbol.iterator](){const t=[],e=this.content.getKeySet().toList();e.sort(yt.smallerFirst);for(const n of e){const i=this.content.get(n).get(),o=i.getKeySet().toList();o.sort(yt.smallerFirst);for(const s of o){const a=i.get(s).get();t.push({x:s,y:n,content:a})}}return t.values()}}class KNe{static create(t,e,n,i){const o=[];for(let s=0;s<t;s++)o.push(rt.create(e,n,i));return o}}class Cd{containing;static from(t,e,n){if(t+e>n)return X.failure("invalid starting space");const i=new gn([{key:O.ZERO,value:t},{key:O.ONE,value:e},{key:B.NONE,value:n}]);i.makeImmutable();const o=new Cd(i);return X.success(o)}constructor(t){this.containing=t}isFull(){const t=this.count(O.ZERO),e=this.count(O.ONE);return this.count(B.NONE)<=t+e}count(t){return this.containing.get(t).get()}addPiece(t){let e=this.count(O.ZERO),n=this.count(O.ONE);const i=this.count(B.NONE);return t===O.ZERO?e++:n++,Cd.from(e,n,i).get()}substractPiece(t){let e=this.count(O.ZERO),n=this.count(O.ONE);const i=this.count(B.NONE);return t===O.ZERO?e--:n--,Cd.from(e,n,i).get()}getDominatingPlayer(){const t=this.count(O.ZERO),e=this.count(O.ONE);return t>e?O.ZERO:e>t?O.ONE:B.NONE}equals(t){return this.containing.equals(t.containing)}}class G1 extends gn{static of(t,e){return new G1([{key:O.ZERO,value:t},{key:O.ONE,value:e}])}static ofSingle(t,e){return G1.of([t],[e])}add(t,e,n){const i=yt.copy(this.get(t).get());return i[e]+=n,this.put(t,i)}concat(t){const e=this.get(O.ZERO).get(),n=this.get(O.ONE).get(),i=t.get(O.ZERO).get(),o=t.get(O.ONE).get();return G1.of(e.concat(i),n.concat(o))}}class Q3{map;static ofValues(t,e){const n=new gn([{key:O.ZERO,value:t},{key:O.ONE,value:e}]);return new Q3(n)}constructor(t){this.map=t}makeImmutable(){return this.map.makeImmutable()}equals(t){return this.map.equals(t.map)}get(t){return this.map.get(t).get()}put(t,e){return this.map.put(t,e).get()}}class we extends Q3{static of(t,e){const n=new gn([{key:O.ZERO,value:t},{key:O.ONE,value:e}]);return new we(n)}add(t,e){const n=this.get(t);return this.map.put(t,n+e)}toTable(){return G1.ofSingle(this.get(O.ZERO),this.get(O.ONE))}getCopy(){return new we(this.map.getCopy())}}class J3 extends PC{board;remaining;static fromRepresentation(t,e,n,i){const o=[];for(let a=0;a<4;a++){const f=Cd.from(e[0][a],e[1][a],e[2][a]).get();o.push(f)}const s=we.of(n,i);return new J3(t,o,s)}constructor(t,e,n){super(t),this.board=e,this.remaining=n,this.remaining.makeImmutable()}getPieceAt(t){return this.board[t.x]}updateAt(t,e){const n=[];for(let o=0;o<4;o++)n.push(t.x===o?e:this.board[o]);const i=this.getRemainingCopy();return new J3(this.turn,n,i)}getRemainingCopy(){return this.remaining.getCopy()}getRemaining(t){return this.remaining.get(t)}equals(t){return this.turn===t.turn&&yt.equals(t.board,this.board)&&this.remaining.equals(t.remaining)}}class W{title;instruction;state;static fromMove(t,e,n,i,o,s){return new XNe(t,e,n,i,o,s)}static forClick(t,e,n,i,o,s){return new JNe(t,e,n,i,o,s)}static anyMove(t,e,n,i,o){return new QNe(t,e,n,i,o)}static fromPredicate(t,e,n,i,o,s){return new eIe(t,e,n,i,o,s)}static informational(t,e,n){return new tIe(t,e,n)}previousMove=h.empty();constructor(t,e,n){this.title=t,this.instruction=e,this.state=n}isMove(){return!1}isAnyMove(){return!1}isClick(){return!1}isPredicate(){return!1}isInformation(){return!1}hasSolution(){return!1}withPreviousMove(t){return this.previousMove=h.of(t),this}}class SC extends W{successMessage;constructor(t,e,n,i){super(t,e,n),this.successMessage=i}hasSolution(){return!0}getSuccessMessage(){return this.successMessage}}class XNe extends SC{acceptedMoves;failureMessage;constructor(t,e,n,i,o,s){super(t,e,n,o),this.acceptedMoves=i,this.failureMessage=s,pn(i.length>0,"TutorialStepMove: At least one accepted move should be provided, otherwise use TutorialStepInformational")}isMove(){return!0}getSolution(){return this.acceptedMoves[0]}getFailureMessage(){return this.failureMessage}}class QNe extends SC{solutionMove;constructor(t,e,n,i,o){super(t,e,n,o),this.solutionMove=i}getSolution(){return this.solutionMove}isAnyMove(){return!0}}class JNe extends SC{acceptedClicks;failureMessage;constructor(t,e,n,i,o,s){super(t,e,n,o),this.acceptedClicks=i,this.failureMessage=s}isClick(){return!0}getSolution(){return this.acceptedClicks[0]}getFailureMessage(){return this.failureMessage}}class eIe extends SC{solutionMove;predicate;constructor(t,e,n,i,o,s){super(t,e,n,s),this.solutionMove=i,this.predicate=o}getSolution(){return this.solutionMove}isPredicate(){return!0}}class tIe extends W{isInformation(){return!0}}class Wn{}class mn{metrics;static max(t,e){const n=yt.max(t.metrics,e.metrics);return mn.multiMetric(n)}static min(t,e){const n=yt.min(t.metrics,e.metrics);return mn.multiMetric(n)}static VICTORIES=[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER];static isVictory(t){return t===Number.MAX_SAFE_INTEGER||t===Number.MIN_SAFE_INTEGER}static isPreVictory(t){return t===Number.MAX_SAFE_INTEGER-1||t===Number.MIN_SAFE_INTEGER+1}static ofSingle(t,e){return mn.ofMultiple([t],[e])}static ofPlayerNumberMap(t){return mn.ofSingle(t.get(O.ZERO),t.get(O.ONE))}static ofMultiple(t,e){L.assert(t.length===e.length,"both player should have the same number of metric"),L.assert(t.length>=1,"scores list should be filled");const n=[];for(let i=0;i<t.length;i++){const o=t[i]*O.ZERO.getScoreModifier(),s=e[i]*O.ONE.getScoreModifier();n.push(o+s)}return new mn(n)}static of(t){return new mn([t])}static multiMetric(t){return new mn(t)}static isLessThan(t,e){return yt.isLessThan(t.metrics,e.metrics)}static isGreaterThan(t,e){return yt.isGreaterThan(t.metrics,e.metrics)}constructor(t){this.metrics=t}toMaximum(){const e=yt.create(this.metrics.length,Number.MAX_SAFE_INTEGER);return mn.multiMetric(e)}toMinimum(){const e=yt.create(this.metrics.length,Number.MIN_SAFE_INTEGER);return mn.multiMetric(e)}equals(t){return yt.equals(this.metrics,t.metrics)}}class ye{isEndGame;winner;static ZERO_WON=new ye(!0,O.ZERO);static ONE_WON=new ye(!0,O.ONE);static DRAW=new ye(!0,B.NONE);static ONGOING=new ye(!1,B.NONE);static getVictory(t){return t===O.ZERO?ye.ZERO_WON:ye.ONE_WON}static getDefeat(t){return t===O.ZERO?ye.ONE_WON:ye.ZERO_WON}constructor(t,e){this.isEndGame=t,this.winner=e}toBoardValue(){return this.winner.isPlayer()?mn.of(this.winner.getVictoryValue()):mn.of(0)}}var CI;let FQ=(()=>class r{static createdNodes=0})(),ms=class{static#e=CI=this;gameState;parent;previousMove;static ID=0;id;children=new gn;cache=new gn;constructor(t,e=h.empty(),n=h.empty()){this.gameState=t,this.parent=e,this.previousMove=n,this.id=CI.ID++,FQ.createdNodes++}getChild(t){return this.children.get(t)}hasChildren(){return this.getChildren().length>0}getChildren(){return this.children.listValues()}addChild(t){L.assert(t.previousMove.isPresent(),"GameNode: addChild expects a node with a previous move"),this.children.set(t.previousMove.get(),t)}printDot(t,e,n,i=0,o=0,s=h.empty()){0===i&&console.log("digraph G {");const a=t.getGameStatus(this,s);let c="white";if(a.isEndGame)switch(a.winner){case O.ZERO:c="#994d00";break;case O.ONE:c="#ffc34d";break;default:c="grey"}let l=`#${this.gameState.turn}: ${this.id}`;e&&(l+=` - ${e(this)}`),console.log(`    node_${o} [label="${l}", style=filled, fillcolor="${c}"];`);let u=o+1;if(void 0===n||i<n)for(const f of this.children.listValues())console.log(`    node_${o} -> node_${u} [label="${f.previousMove.get()}"];`),u=f.printDot(t,e,n,i+1,u);return 0===i&&console.log("}"),u}getCache(t){return this.cache.get(t)}setCache(t,e){this.cache.containsKey(t)?this.cache.replace(t,e):this.cache.set(t,e)}};ms=CI=function(r,t,e,n){var s,i=arguments.length,o=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,e):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,t,e,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(t,e,o):s(t,e))||o);return i>3&&o&&Object.defineProperty(t,e,o),o}([Ae.log],ms);class UQ{constructor(){}choose(t,e,n){Ae.display("Rules","choose",e.toString()+" was proposed");const i=this.isLegal(e,t.gameState,n);if(i.isFailure())return Ae.display("Rules","choose","Move is illegal: "+i.getReason()),X.failure(i.getReason());const o=t.getChild(e);if(o.isPresent())return L.assert(i.isSuccess(),"Rules.choose: Move is illegal: "+i.getReasonOr("")),Ae.display("Rules","choose","and this proposed move is found in the list, so it is legal"),X.success(o.get());const s=this.applyLegalMove(e,t.gameState,n,i.get()),a=new ms(s,h.of(t),h.of(e));return X.success(a)}getInitialNode(t){const e=this.getInitialState(t);return new ms(e)}getDefaultRulesConfig(){const t=this.getRulesConfigDescription();return t.isPresent()?h.of(t.get().getDefaultConfig().config):h.empty()}}class Da extends UQ{}class Ar extends UQ{getRulesConfigDescription(){return h.empty()}}class Va extends Ar{static PIECES_PER_PLAYER=10;static singleton=h.empty();static get(){return Va.singleton.isAbsent()&&(Va.singleton=h.of(new Va)),Va.singleton.get()}getInitialState(){return J3.fromRepresentation(0,[[0,0,0,0],[0,0,0,0],[7,5,3,1]],Va.PIECES_PER_PLAYER,Va.PIECES_PER_PLAYER)}applyLegalMove(t,e,n,i){return t.isDrop()?this.applyLegalDrop(t,e):this.applyLegalTransfer(t,e)}applyLegalDrop(t,e){const n=e.getRemainingCopy();n.add(t.piece.get(),-1);const i=new J3(e.turn+1,e.board,n),o=t.piece.get(),s=i.getPieceAt(t.landing).addPiece(o);if(t.landing===un.THREE)return i.updateAt(t.landing,s);{const a=un.of(t.landing.x+1),c=i.getPieceAt(a);return i.updateAt(t.landing,c).updateAt(a,s)}}applyLegalTransfer(t,e){const n=e.getCurrentPlayer(),i=t.starting.get(),o=e.getPieceAt(i).substractPiece(n),s=e.getPieceAt(t.landing).addPiece(n);let a=e.updateAt(i,o);return a=a.updateAt(t.landing,s),new J3(a.turn+1,a.board,a.remaining)}isLegal(t,e){return e.getPieceAt(t.landing).isFull()?w.failure(tu.CANNOT_LAND_ON_A_FULL_SQUARE()):t.isDrop()?this.isLegalDrop(t,e):this.isLegalSlideDown(t,e)}isLegalDrop(t,e){return e.getRemaining(t.piece.get())<=0?w.failure(tu.NO_PIECE_REMAINING_TO_DROP()):w.SUCCESS}isLegalSlideDown(t,e){const n=e.getCurrentPlayer();return 0===e.getPieceAt(t.starting.get()).count(n)?w.failure(tu.NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE()):w.SUCCESS}getGameStatus(t){const e=t.gameState;for(let i=0;i<4;i++)if(!1===e.getPieceAt(un.of(i)).isFull())return ye.ONGOING;const n=e.getPieceAt(un.THREE).getDominatingPlayer();return L.assert(n.isPlayer(),"winner can only be a player if the game is finished"),ye.getVictory(n)}}let pe=(()=>class r{static YOU_DID_NOT_CAPTURE_ANY_PIECE=()=>$localize`Failed, you did not capture any piece.`;static END_OF_THE_GAME=()=>$localize`End of the game`;static CONGRATULATIONS=()=>$localize`Congratulations!`;static CONGRATULATIONS_YOU_WON=()=>$localize`Congratulations, you won!`;static FAILED_TRY_AGAIN=()=>$localize`Failed, try again.`})();class rIe extends Wn{tutorial=[W.informational($localize`Initial board and object of the game`,$localize`At Apagos, there are 4 squares, each of them has a fixed number of holes for pieces. Each player starts with 10 pieces. Dark pieces belong to the first player, light pieces belong to the second one. The game ends when no one can play. The player owning the most pieces in the rightmost square wins!`,Va.get().getInitialState()),W.anyMove($localize`Drop`,$localize`There are two kinds of moves. One is the drop. To do one, you must click on a visible arrow, being of your color or the opponent's. If the chosen square is one of the 3 leftmost ones, it will exchange position with the square on its right.<br/><br/>You're playing Light. Drop a piece on one of those three squares.`,J3.fromRepresentation(1,[[0,0,0,1],[0,0,0,0],[7,5,3,1]],9,10),nr.drop(un.ZERO,O.ZERO),pe.CONGRATULATIONS()),W.fromPredicate($localize`Transfer`,$localize`The other kind of move is the transfer.<ol><li>Choose one of your pieces on the board by clicking on the square in which it is.</li><li>Choose its landing square by clicking on one of the arrow to finish the transfer.</li></ol>It can only be done with your pieces, from a higher square to a lower one.<br/><br/>You're playing Dark, do a transfer!`,J3.fromRepresentation(2,[[0,0,1,0],[0,1,0,0],[7,5,3,1]],9,9),nr.transfer(un.TWO,un.ZERO).get(),(t,e,n)=>t.isDrop()?w.failure($localize`This move is a drop, please do a transfer!`):w.SUCCESS,pe.CONGRATULATIONS()),W.fromPredicate($localize`Victory`,$localize`When you put a last piece into a square, the games end. In this configuration you can win.<br/><br/>You're playing Light, do the winning move!`,J3.fromRepresentation(3,[[1,0,3,4],[2,1,3,1],[3,1,7,5]],2,3),nr.drop(un.TWO,O.ONE),(t,e,n)=>t.isDrop()?t.piece.equalsValue(O.ONE)?w.SUCCESS:w.failure($localize`You actively made your opponent win!`):w.failure($localize`Wrong choice, your opponent will win in the next turn no matter which piece is dropped!`),pe.CONGRATULATIONS())]}class vI{static gcd(t,e){return 0===e?Math.abs(t):vI.gcd(e,t%e)}}class Gt{x;y;constructor(t,e){this.x=t,this.y=e}equals(t){return this.x===t.x&&this.y===t.y}isSingleOrthogonalStep(){const t=Math.abs(this.x)+Math.abs(this.y)===1;return this.isOrthogonal()&&t}isOrthogonal(){return 0===this.x||0===this.y}isDiagonal(){return 0!==this.x&&0!==this.y}isDiagonalOfLength(t){return Math.abs(this.x)===t&&Math.abs(this.y)===t}toMinimalVector(){const t=vI.gcd(this.x,this.y);return new Gt(this.x/t,this.y/t)}combine(t,e=1){return new Gt(this.x+e*t.x,this.y+e*t.y)}toString(){return"("+this.x+", "+this.y+")"}}class yI extends Gt{isDown(){return 1===this.y}isUp(){return-1===this.y}isLeft(){return-1===this.x}isRight(){return 1===this.x}toInt(){return 0===this.x&&-1===this.y?0:1===this.x&&0===this.y?1:0===this.x&&1===this.y?2:-1===this.x&&0===this.y?3:-1===this.x&&-1===this.y?4:1===this.x&&-1===this.y?5:-1===this.x&&1===this.y?6:7}toString(){return 0===this.x&&-1===this.y?"UP":1===this.x&&0===this.y?"RIGHT":0===this.x&&1===this.y?"DOWN":-1===this.x&&0===this.y?"LEFT":-1===this.x&&-1===this.y?"UP_LEFT":1===this.x&&-1===this.y?"UP_RIGHT":-1===this.x&&1===this.y?"DOWN_LEFT":"DOWN_RIGHT"}}class MI{from(t,e){for(const n of this.all)if(n.x===t&&n.y===e)return X.success(n);return X.failure("Invalid x and y in direction construction")}fromDelta(t,e){return 0===t&&0===e?X.failure("Empty delta for direction"):Math.abs(t)===Math.abs(e)||0===t||0===e?this.from(Math.sign(t),Math.sign(e)):X.failure(iIe.DIRECTION_MUST_BE_LINEAR())}fromMove(t,e){return this.fromDelta(e.x-t.x,e.y-t.y)}fromString(t){switch(t){case"UP":return this.from(0,-1);case"RIGHT":return this.from(1,0);case"DOWN":return this.from(0,1);case"LEFT":return this.from(-1,0);case"UP_LEFT":return this.from(-1,-1);case"UP_RIGHT":return this.from(1,-1);case"DOWN_LEFT":return this.from(-1,1);case"DOWN_RIGHT":return this.from(1,1);default:return X.failure(`Invalid direction string ${t}`)}}fromInt(t){switch(t){case 0:return this.from(0,-1);case 1:return this.from(1,0);case 2:return this.from(0,1);case 3:return this.from(-1,0);case 4:return this.from(-1,-1);case 5:return this.from(1,-1);case 6:return this.from(-1,1);case 7:return this.from(1,1);default:return X.failure(`Invalid int direction: ${t}`)}}}class me extends yI{static UP=new me(0,-1);static UP_RIGHT=new me(1,-1);static RIGHT=new me(1,0);static DOWN_RIGHT=new me(1,1);static DOWN=new me(0,1);static DOWN_LEFT=new me(-1,1);static LEFT=new me(-1,0);static UP_LEFT=new me(-1,-1);static factory=new class extends MI{all=[me.UP,me.UP_RIGHT,me.RIGHT,me.DOWN_RIGHT,me.DOWN,me.DOWN_LEFT,me.LEFT,me.UP_LEFT]};static DIRECTIONS=me.factory.all;static DIAGONALS=[me.UP_RIGHT,me.DOWN_RIGHT,me.DOWN_LEFT,me.UP_LEFT];static ORTHOGONALS=[me.UP,me.RIGHT,me.DOWN,me.LEFT];static encoder=ke.fromFunctions(t=>t.toString(),t=>(pn("string"==typeof t,"Invalid encoded direction"),me.factory.fromString(t).get()));constructor(t,e){super(t,e)}getOpposite(){return me.factory.from(-this.x,-this.y).get()}}class Ie extends yI{static UP=new Ie(0,-1);static RIGHT=new Ie(1,0);static DOWN=new Ie(0,1);static LEFT=new Ie(-1,0);static factory=new class extends MI{all=[Ie.UP,Ie.RIGHT,Ie.DOWN,Ie.LEFT];from(t,e){return 0===t&&-1===e?X.success(Ie.UP):1===t&&0===e?X.success(Ie.RIGHT):0===t&&1===e?X.success(Ie.DOWN):-1===t&&0===e?X.success(Ie.LEFT):X.failure("Invalid orthogonal from x and y")}};static ORTHOGONALS=Ie.factory.all;static encoder=ke.fromFunctions(t=>t.toString(),t=>(pn("string"==typeof t,"Invalid encoded orthogonal"),Ie.factory.fromString(t).get()));constructor(t,e){super(t,e)}getOpposite(){return Ie.factory.from(-this.x,-this.y).get()}rotateClockwise(){return Ie.factory.from(-this.y,this.x).get()}}let iIe=(()=>class r{static DIRECTION_MUST_BE_LINEAR=()=>$localize`You must move in a straight line! You can only move orthogonally or diagonally!`})();class uo{static OUT_OF_RANGE(t){return`The coordinate ${t.toString()} is not on the board`}}class _ extends Gt{static getEncoder(t){return ke.tuple([ke.identity(),ke.identity()],e=>[e.x,e.y],e=>t(e[0],e[1]))}static encoder=_.getEncoder((t,e)=>new _(t,e));constructor(t,e){super(t,e)}getNext(t,e){const n=this.combine(t,e);return new _(n.x,n.y)}getPrevious(t,e){return this.getNext(t,-(e=e??1))}getLeft(t){return new _(this.x+t.y,this.y+-t.x)}getRight(t){return new _(this.x+-t.y,this.y+t.x)}isInRange(t,e){return!(this.x<0||this.y<0||t<=this.x||e<=this.y)}isNotInRange(t,e){return this.x<0||this.y<0||t<=this.x||e<=this.y}getDirectionToward(t){return me.factory.fromMove(this,t)}getOrthogonalDistance(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}getDistance(t){if(!1===t.isAlignedWith(this))throw new Error("Cannot calculate distance with non aligned coords.");const e=Math.abs(t.x-this.x),n=Math.abs(t.y-this.y);return Math.max(e,n)}isHexagonallyAlignedWith(t){const e=this.x-t.x,n=this.y-t.y;return e!==n&&(e===-n||e*n==0)}isAlignedWith(t){const e=Math.abs(this.x-t.x),n=Math.abs(this.y-t.y);return e===n||e*n==0}isNeighborWith(t){return!!this.isAlignedWith(t)&&1===this.getDistance(t)}getVectorToward(t){return new Gt(t.x-this.x,t.y-this.y)}toVector(){return new Gt(this.x,this.y)}getCoordsToward(t){if(L.assert(t.isAlignedWith(this),"Should only call getCoordsTowards on aligned coords"),t.equals(this))return[];const e=this.getDirectionToward(t).get();let n=this.getNext(e,1);const i=[];for(;!1===n.equals(t);)i.push(n),n=n.getNext(e,1);return i}getAllCoordsToward(t){let e=[this];if(!1===this.equals(t)){const n=this.getCoordsToward(t);e=e.concat(n).concat(t)}return e}equals(t){return this===t||t.x===this.x&&t.y===this.y}compareTo(t){return t.y===this.y?t.x===this.x?0:this.x<t.x?-1:1:this.y<t.y?-1:1}toSVGPoint(){return this.x+","+this.y}scale(t,e){return new _(this.x*t,this.y*e)}}class GQ{getPlayerClass(t){switch(t){case O.ZERO:return"player0-fill";case O.ONE:return"player1-fill";default:return L.expectToBe(t,B.NONE),""}}}class vd extends GQ{SPACE_SIZE=100;STROKE_WIDTH=8;SMALL_STROKE_WIDTH=2;ArrayUtils=yt;getSVGTranslation(t,e){return"translate("+t+", "+e+")"}}class BQ extends GQ{activatedRoute;constructor(t){super(),this.activatedRoute=t}getGameName(){return L.getNonNullable(this.activatedRoute.snapshot.paramMap.get("compo"))}}let Fc=class _R extends vd{messageDisplayer;encoder;Player=O;rules;node;config=h.empty();availableAIs;canPass=!1;scores=h.empty();imagesLocation="assets/images/";hasAsymmetricBoard=!1;rotation="";tutorial;isPlayerTurn;chooseMove;canUserPlay;cancelMoveOnWrapper;pointOfView=O.ZERO;interactive=!1;animationOngoing=!1;constructor(t){super(),this.messageDisplayer=t}getPointOfView(){return this.pointOfView}setPointOfView(t){this.pointOfView=t,this.hasAsymmetricBoard&&(this.rotation="rotate("+180*t.getValue()+")")}setInteractive(t){this.interactive=t}isInteractive(){return this.interactive}cancelMove(t){var e=this;return M(function*(){return e.cancelMoveAttempt(),e.cancelMoveOnWrapper(t),e.node.previousMove.isPresent()&&(yield e.showLastMove(e.node.previousMove.get(),e.getConfig())),null==t?w.SUCCESS:(e.messageDisplayer.gameMessage(t),w.failure(t))})()}cancelMoveAttempt(){}pass(){var t=this;return M(function*(){return u2.logError("GameComponent","pass() called on a game that does not redefine it",{gameName:t.constructor.name})})()}getTurn(){return this.node.gameState.turn}getCurrentPlayer(){return this.node.gameState.getCurrentPlayer()}getCurrentOpponent(){return this.node.gameState.getCurrentOpponent()}getState(){return this.node.gameState}getPreviousState(){return this.node.parent.get().gameState}setRulesAndNode(t){const e=Ht.getByUrlName(t).get(),n=e.getRulesConfig();this.rules=e.rules,this.node=this.rules.getInitialNode(n),this.tutorial=e.tutorial.tutorial}getConfig(){return this.config}getTranslation(t){return this.getTranslationXY(t.x,t.y)}getTranslationXY(t,e){return`translate(${t*this.SPACE_SIZE} ${e*this.SPACE_SIZE})`}static \u0275fac=function(e){return new(e||_R)(G(Ut))};static \u0275cmp=Ue({type:_R,selectors:[["ng-component"]],features:[$e],decls:0,vars:0,template:function(e,n){},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})};Fc=function(r,t,e,n){var s,i=arguments.length,o=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,e):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,t,e,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(t,e,o):s(t,e))||o);return i>3&&o&&Object.defineProperty(t,e,o),o}([Ae.log],Fc);let ru=(()=>{class r extends Fc{hexaLayout;hexaBoard;getHexaPoints(){return this.hexaLayout.getHexaPoints()}getCenterAtXY(e,n){const i=new _(e,n);return this.getCenterAt(i)}getCenterAt(e){return this.hexaLayout.getCenterAt(e)}getHexaCenterTranslation(e){return this.getHexaCenterTranslationAtXY(e.x,e.y)}getHexaCenterTranslationAtXY(e,n){const i=this.getCenterAtXY(e,n);return`translate(${i.x}, ${i.y})`}static \u0275fac=(()=>{let e;return function(i){return(e||(e=z1(r)))(i||r)}})();static \u0275cmp=Ue({type:r,selectors:[["ng-component"]],features:[$e],decls:0,vars:0,template:function(n,i){},encapsulation:2})}return r})();class Pe{player;reachable;static ZERO=new Pe(O.ZERO,!0);static ONE=new Pe(O.ONE,!0);static EMPTY=new Pe(B.NONE,!0);static UNREACHABLE=new Pe(B.NONE,!1);static ofPlayer(t){return t===O.ZERO?Pe.ZERO:(L.expectToBe(t,O.ONE),Pe.ONE)}constructor(t,e){this.player=t,this.reachable=e}equals(t){return this.player.equals(t.player)&&this.reachable===t.reachable}is(t){return this.player===t}isPlayer(){return this===Pe.ZERO||this===Pe.ONE}isReachable(){return this.reachable}getPlayer(){return this.player}}class Te extends yI{static UP=new Te(0,-1);static LEFT=new Te(-1,0);static UP_RIGHT=new Te(1,-1);static DOWN_LEFT=new Te(-1,1);static RIGHT=new Te(1,0);static DOWN=new Te(0,1);static factory=new class extends MI{all=[Te.UP,Te.UP_RIGHT,Te.RIGHT,Te.DOWN,Te.DOWN_LEFT,Te.LEFT]};static encoder=ke.fromFunctions(t=>{switch(t){case Te.UP:return 0;case Te.UP_RIGHT:return 1;case Te.RIGHT:return 2;case Te.DOWN:return 3;case Te.DOWN_LEFT:return 4;default:return 5}},t=>(L.assert(0<=t&&t<=5,"Invalid encoded number for HexaDirection "+t),Te.factory.all[t]));static getAngle(t){switch(t){case Te.UP:return 0;case Te.UP_RIGHT:return 60;case Te.RIGHT:return 120;case Te.DOWN:return 180;case Te.DOWN_LEFT:return 240;default:return L.expectToBe(t,Te.LEFT),300}}constructor(t,e){super(t,e)}getOpposite(){return Te.factory.from(-this.x,-this.y).get()}}class $Q{startAngle;conversionMatrix;inverseConversionMatrix}class OC extends $Q{static INSTANCE=new OC;startAngle=.5;conversionMatrix=[Math.sqrt(3),Math.sqrt(3)/2,0,1.5];inverseConversionMatrix=[Math.sqrt(3)/3,-1/3,0,2/3];constructor(){super()}}class Yr extends $Q{static INSTANCE=new Yr;startAngle=0;conversionMatrix=[1.5,0,Math.sqrt(3)/2,Math.sqrt(3)];inverseConversionMatrix=[2/3,0,-1/3,Math.sqrt(3)/3];constructor(){super()}isOnBorder(t,e){return this.isOnTopRightBorder(t,e)||this.isOnRightBorder(t,e)||this.isOnBottomRightBorder(t,e)||this.isOnBottomLeftBorder(t,e)||this.isOnLeftBorder(t,e)||this.isOnTopLeftBorder(t,e)}isOnTopRightBorder(t,e){return 0===e.y}isOnRightBorder(t,e){return e.x===t.width-1}isOnLeftBorder(t,e){return 0===e.x}isOnBottomLeftBorder(t,e){return e.y===t.height-1}isOnTopLeftBorder(t,e){return null!=t.excludedSpaces[e.y]?e.x===t.excludedSpaces[e.y]:e.y===t.excludedSpaces.length&&0===e.x}isOnBottomRightBorder(t,e){return null!=t.excludedSpaces[t.height-1-e.y]?t.width-1-e.x===t.excludedSpaces[t.height-1-e.y]:t.height-1-e.y===t.excludedSpaces.length&&e.x===t.width-1}getAllBorders(t){const e=[];return t.forEachCoord((n,i)=>{this.isOnBorder(t,n)&&e.push(n)}),e}isTopCorner(t,e){return this.isOnTopLeftBorder(t,e)&&this.isOnTopRightBorder(t,e)}isTopLeftCorner(t,e){return this.isOnTopLeftBorder(t,e)&&this.isOnLeftBorder(t,e)}isTopRightCorner(t,e){return this.isOnTopRightBorder(t,e)&&this.isOnRightBorder(t,e)}isBottomCorner(t,e){return this.isOnBottomLeftBorder(t,e)&&this.isOnBottomRightBorder(t,e)}isBottomLeftCorner(t,e){return this.isOnBottomLeftBorder(t,e)&&this.isOnLeftBorder(t,e)}isBottomRightCorner(t,e){return this.isOnBottomRightBorder(t,e)&&this.isOnRightBorder(t,e)}}class iu{size;origin;orientation;constructor(t,e,n){this.size=t,this.origin=e,this.orientation=n}getCenterAt(t){const e=this.orientation.conversionMatrix;return new _(this.size*(e[0]*t.x+e[1]*t.y)+this.origin.x,this.size*(e[2]*t.x+e[3]*t.y)+this.origin.y)}getCornerOffset(t){const e=2*Math.PI*(this.orientation.startAngle+t)/6;return new _(this.size*Math.cos(e),this.size*Math.sin(e))}getHexaPointsList(){const t=[];for(let e=0;e<6;e+=1){const n=this.getCornerOffset(e);t.push(new _(n.x,n.y))}return t}getHexaPoints(){return this.getHexaPointsList().map(e=>e.toSVGPoint()).join(" ")}getIsoPoints(t,e){L.assert(this.orientation===Yr.INSTANCE,"HexaLayout.getIsoPoints can only be used with flat orientation");const n=this.getCenterAt(t),i=this.getCornerOffset(0),o=this.getCornerOffset(1),s=this.getCornerOffset(2),a=this.getCornerOffset(3);return[[new _(n.x+a.x,n.y+a.y),new _(n.x+a.x,n.y+a.y+e),new _(n.x+s.x,n.y+s.y+e),new _(n.x+s.x,n.y+s.y)],[new _(n.x+i.x,n.y+i.y),new _(n.x+i.x,n.y+i.y+e),new _(n.x+o.x,n.y+o.y+e),new _(n.x+s.x,n.y+s.y+e),new _(n.x+s.x,n.y+s.y),new _(n.x+o.x,n.y+o.y)],[new _(n.x+a.x,n.y+a.y),new _(n.x+a.x,n.y+a.y+e),new _(n.x+s.x,n.y+s.y+e),new _(n.x+o.x,n.y+o.y+e),new _(n.x+i.x,n.y+i.y+e),new _(n.x+i.x,n.y+i.y),new _(n.x+o.x,n.y+o.y),new _(n.x+s.x,n.y+s.y)]]}}let Ee=(()=>class r{static MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT=()=>$localize`You have selected a piece of the opponent. You must pick one of your pieces.`;static MUST_CHOOSE_OWN_PIECE_NOT_EMPTY=()=>$localize`You have selected an empty space, you must select one of your own pieces.`;static MUST_CLICK_ON_EMPTY_SPACE=()=>$localize`You must click on an empty space.`;static MUST_CLICK_ON_EMPTY_SQUARE=()=>$localize`You must click on an empty square.`;static SHOULD_LAND_ON_EMPTY_OR_OPPONENT_SPACE=()=>$localize`Your landing space should be empty or contain a piece of the opponent.`;static CANNOT_SELF_CAPTURE=()=>$localize`You cannot capture your own pieces.`;static CANNOT_PASS=()=>$localize`You cannot pass your turn.`;static MUST_LAND_ON_EMPTY_SPACE=()=>$localize`You must drop your piece on an empty space.`;static MUST_PASS=()=>$localize`You must pass your turn.`;static MOVE_CANNOT_BE_STATIC=()=>$localize`You must choose different starting and ending coordinates.`;static SOMETHING_IN_THE_WAY=()=>$localize`There is a piece between the piece you chose and its landing space.`;static MUST_MOVE_ON_NEIGHBOR=()=>$localize`You must move on a direct neighboring space.`})(),yl=(()=>class r{static CANNOT_MOVE_MORE_THAN_THREE_PIECES=()=>$localize`You cannot move more than 3 of your pieces!`;static NOT_ENOUGH_PIECE_TO_PUSH=()=>$localize`You don't have enough pieces to push that group!`;static CANNOT_PUSH_YOUR_OWN_PIECES=()=>$localize`You cannot push this piece because it is blocked by one of yours!`;static MUST_ONLY_TRANSLATE_YOUR_PIECES=()=>$localize`This line contains pieces of your opponent or empty spaces, which is forbidden.`;static TRANSLATION_IMPOSSIBLE=()=>$localize`This move is impossible, some landing spaces are occupied.`;static LINE_AND_COORD_NOT_ALIGNED=()=>$localize`This space is not aligned with the current line.`})();class B1 extends PC{board;constructor(t,e){super(e),this.board=t}getPieceAt(t){if(this.isOnBoard(t))return this.board[t.y][t.x];throw new Error("Accessing coord not on board "+t+".")}has(t,e){return this.isOnBoard(t)&&zo(this.getPieceAt(t),e)}setPieceAt(t,e,n){const i=this.getCopiedBoard();return i[t.y][t.x]=e,n(this,i)}tryToGetPieceAt(t){return this.isOnBoard(t)?h.of(this.board[t.y][t.x]):h.empty()}isOnBoard(t){return t.isInRange(this.board[0].length,this.board.length)}getPieceAtXY(t,e){return this.getPieceAt(new _(t,e))}getOptionalPieceAtXY(t,e){const n=new _(t,e);return this.isOnBoard(n)?h.of(this.getPieceAt(n)):h.empty()}forEachCoord(t){for(const{coord:e,content:n}of this.getCoordsAndContents())t(e,n)}getCoordsAndContents(){const t=[];for(let e=0;e<this.getHeight();e++)for(let n=0;n<this.board[e].length;n++){const i=new _(n,e);this.isOnBoard(i)&&t.push({coord:i,content:this.getPieceAt(i)})}return t}getCopiedBoard(){return rt.copy(this.board)}toMap(){const t=[];for(let e=0;e<this.getHeight();e++)for(let n=0;n<this.getWidth();n++){const i=new _(n,e);t.push({key:i,value:this.getPieceAt(i)})}return t}getWidth(){return this.board[0].length}getHeight(){return this.board.length}isHorizontalEdge(t){const e=this.getHeight()-1;return 0===t.y||t.y===e}isVerticalEdge(t){const e=this.getWidth()-1;return 0===t.x||t.x===e}isEdge(t){return this.isHorizontalEdge(t)||this.isVerticalEdge(t)}isCorner(t){return this.isHorizontalEdge(t)&&this.isVerticalEdge(t)}[Symbol.iterator](){const t=[];for(const e of this.board)t.push(...e);return t.values()}}class js extends Ar{static singleton=h.empty();static get(){return js.singleton.isAbsent()&&(js.singleton=h.of(new js)),js.singleton.get()}getInitialState(){const t=Pe.EMPTY,e=Pe.UNREACHABLE,n=Pe.ZERO,i=Pe.ONE;return new Zs([[e,e,e,e,i,i,i,i,i],[e,e,e,i,i,i,i,i,i],[e,e,t,t,i,i,i,t,t],[e,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,e],[t,t,n,n,n,t,t,e,e],[n,n,n,n,n,n,e,e,e],[n,n,n,n,n,e,e,e,e]],0)}static isLegalRealPush(t,e,n,i,o){let s=0;const a=Pe.ofPlayer(n.getCurrentOpponent()),c=Pe.ofPlayer(n.getCurrentPlayer());for(;s<i&&n.isOnBoard(t)&&n.getPieceAt(t)===a;)s++,t=t.getNext(e.dir);return i<=s?X.failure(yl.NOT_ENOUGH_PIECE_TO_PUSH()):Zs.isOnBoard(t)&&(n.getPieceAt(t)===Pe.EMPTY&&(o[t.y][t.x]=a),n.getPieceAt(t)===c)?X.failure(yl.CANNOT_PUSH_YOUR_OWN_PIECES()):X.success(o)}applyLegalMove(t,e,n,i){return new Zs(i,e.turn+1)}isLegal(t,e){const n=this.getFirstPieceValidity(t,e);return n.isFailure()?n.toOtherFallible():t.isSingleCoord()?this.isLegalPush(t,e):this.isLegalSideStep(t,e)}getFirstPieceValidity(t,e){const n=e.getPieceAt(t.coord);return!1===e.isPiece(t.coord)?w.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):n===Pe.ofPlayer(e.getCurrentOpponent())?w.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT()):w.SUCCESS}isLegalPush(t,e){let n=1,i=t.coord.getNext(t.dir);const o=Pe.ofPlayer(e.getCurrentPlayer()),s=Pe.EMPTY,a=e.getCopiedBoard();for(a[t.coord.y][t.coord.x]=s;n<=3&&e.isOnBoard(i)&&e.getPieceAt(i)===o;)n++,i=i.getNext(t.dir);return n>3?X.failure(yl.CANNOT_MOVE_MORE_THAN_THREE_PIECES()):!1===Zs.isOnBoard(i)||(a[i.y][i.x]=o,e.getPieceAt(i)===s)?X.success(a):js.isLegalRealPush(i,t,e,n,a)}isLegalSideStep(t,e){let n=t.lastPiece.get();const i=t.coord.getDirectionToward(n).get();n=n.getNext(i);let o=t.coord;const s=Pe.ofPlayer(e.getCurrentPlayer()),a=e.getCopiedBoard();for(;!1===o.equals(n)&&Zs.isOnBoard(o);){if(e.getPieceAt(o)!==s)return X.failure(yl.MUST_ONLY_TRANSLATE_YOUR_PIECES());const c=o.getNext(t.dir);if(a[o.y][o.x]=Pe.EMPTY,Zs.isOnBoard(c)){if(e.isPiece(c))return X.failure(yl.TRANSLATION_IMPOSSIBLE());e.getPieceAt(c)===Pe.EMPTY&&(a[c.y][c.x]=s)}o=o.getNext(i)}return X.success(a)}getGameStatus(t){const e=t.gameState.getScores();return 5<e.get(O.ZERO)?ye.ZERO_WON:5<e.get(O.ONE)?ye.ONE_WON:ye.ONGOING}}class Zs extends B1{static isOnBoard(t){return t.isInRange(9,9)&&js.get().getInitialState().getPieceAt(t)!==Pe.UNREACHABLE}isPiece(t){return this.getPieceAt(t).isPlayer()}getScores(){const t=we.of(14,14);for(const e of this.getCoordsAndContents()){const n=e.content;if(n.isPlayer()){const i=n.getPlayer();t.add(i.getOpponent(),-1)}}return t}}class Nr extends h2{static getFallibleEncoder(t){return ke.tuple([_.encoder],e=>[e.coord],e=>t(e[0]).get())}static getEncoder(t){return ke.tuple([_.encoder],e=>[e.coord],e=>t(e[0]))}coord;constructor(t,e){super(),this.coord=new _(t,e)}equals(t){return this===t||this.coord.equals(t.coord)}}class g2 extends Nr{dir;lastPiece;static encoder=ke.tuple([_.encoder,Te.encoder,h.getEncoder(_.encoder)],t=>[t.coord,t.dir,t.lastPiece],t=>new g2(t[0],t[1],t[2]));static ofSingleCoord(t,e){return L.assert(t.isInRange(9,9),uo.OUT_OF_RANGE(t)),new g2(t,e,h.empty())}static ofDoubleCoord(t,e,n){const i=[t,e];yt.sortByDescending(i,g2.sortCoord);const o=i[1].getDirectionToward(i[0]).get(),s=Te.factory.fromDelta(o.x,o.y);L.assert(s.isSuccess(),"Invalid direction");const a=s.get(),c=i[1].getDistance(i[0]);return L.assert(c<=2,"Distance between first coord and last coord is too big"),a.equals(n)?g2.ofSingleCoord(i[1],n):a.getOpposite().equals(n)?g2.ofSingleCoord(i[0],n):new g2(i[1],n,h.of(i[0]))}static sortCoord(t){return 9*t.y+t.x}constructor(t,e,n){super(t.x,t.y),this.dir=e,this.lastPiece=n}toString(){return this.isSingleCoord()?"AbaloneMove("+this.coord.x+", "+this.coord.y+", "+this.dir.toString()+")":"AbaloneMove("+this.coord.toString()+" > "+this.lastPiece.get().toString()+", "+this.dir.toString()+")"}isSingleCoord(){return this.lastPiece.isAbsent()}equals(t){return t.coord.equals(this.coord)&&t.dir.equals(this.dir)&&t.lastPiece.equals(this.lastPiece)}}class zn{name;moveGenerator;rules;explorationParameter=Math.sqrt(2);maxGameLength=8;availableOptions=[];constructor(t,e,n){this.name=t,this.moveGenerator=e,this.rules=n;for(let i=1;i<10;i++)this.availableOptions.push({name:i*i+" seconds",maxSeconds:i*i})}chooseNextMove(t,e,n){L.assert(!1===this.rules.getGameStatus(t,n).isEndGame,"cannot search from a finished game");const i=t.gameState.getCurrentPlayer(),o=Date.now(),s=Date.now()+1e3*e.maxSeconds;let a=0;for(;Date.now()<s;){const f=this.expand(this.select({node:t,path:[t]}),n),g=this.simulate(f.node,s,n);this.backpropagate(f.path,this.winScore(g,i)),a++}Ae.display("MCTS","chooseNextMove","root winRatio: "+this.winRatio(t)),Ae.display("MCTS","chooseNextMove","children winRatio: "+t.getChildren().map(f=>f.id+": "+this.winRatio(f)));const c=yt.maximumsBy(t.getChildren(),f=>this.winRatio(f)),l=yt.getRandomElement(c),u=(Date.now()-o)/1e3;return Ae.display("MCTS","chooseNextMove",`Computed ${a} in ${u} (rate: ${a/u} it/s)`),Ae.display("MCTS","chooseNextMove","Best child has a win ratio of: "+this.winRatio(l)),l.previousMove.get()}winScore(t,e){switch(t){case ye.DRAW:case ye.ONGOING:return.5;default:return t.winner===e?1:0}}ucb(t,e){const n=this.simulations(t);return 0===e||0===n?Number.MAX_SAFE_INTEGER:this.wins(t)/n+this.explorationParameter*Math.sqrt(Math.log(e)/n)}winRatio(t){const e=this.simulations(t);return 0===this.simulations(t)?1:this.wins(t)/e}wins(t){return this.getCounterFromCache(t,"wins")}simulations(t){return this.getCounterFromCache(t,"simulations")}getCounterFromCache(t,e){const n=t.getCache(e);return n.isPresent()?n.get():(t.setCache(e,0),0)}select(t){const e=t.node;if(Ae.display("MCTS","select","Exploring node: "+e.id),e.hasChildren()){const n=this.simulations(e);Ae.display("MCTS","select","UCB values: "+e.getChildren().map(s=>s.id+": "+this.ucb(e,n)));const i=yt.maximumsBy(e.getChildren(),s=>this.ucb(s,n)),o=yt.getRandomElement(i);return Ae.display("MCTS","select","selecting children "+o.id),this.select({node:o,path:t.path.concat([o])})}return Ae.display("MCTS","select","this is a leaf node, we select it"),t}expand(t,e){if(this.rules.getGameStatus(t.node,e).isEndGame)return t;const n=t.node,i=this.moveGenerator.getListMoves(n,e);L.assert(i.length>0,`${this.name}: move generator did not return any move on a non-finished game: ${this.moveGenerator.constructor.name}`);for(const s of i)n.addChild(this.play(n,s,e));const o=yt.getRandomElement(n.getChildren());return{node:o,path:t.path.concat([o])}}simulate(t,e,n){Ae.display("MCTS","simulate","simulate from node which has a last move of "+t.previousMove.get().toString());let i=t,o=0;for(;o<this.maxGameLength&&Date.now()<e;){const s=this.rules.getGameStatus(i,n);if(s.isEndGame)return Ae.display("MCTS","simulate",`end game in ${o} steps, winner is ${s.winner}`),s;o++,i=this.playRandomStep(i,n)}return ye.ONGOING}playRandomStep(t,e){const n=yt.getRandomElement(this.moveGenerator.getListMoves(t,e));return this.play(t,n,e)}play(t,e,n){const i=this.rules.isLegal(e,t.gameState,n);L.assert(i.isSuccess(),"heuristic returned illegal move");const o=this.rules.applyLegalMove(e,t.gameState,n,i.get());return new ms(o,h.of(t),h.of(e))}backpropagate(t,e){for(const n of t)this.addSimulationResult(n,e),Ae.display("MCTS","backpropagate","backpropagate to node which now has "+this.wins(n)/this.simulations(n))}addSimulationResult(t,e){const n=this.simulations(t)+1,i=this.wins(t)+e;t.setCache("wins",i),t.setCache("simulations",n)}getInfo(t){return`wins/simulations=${this.getCounterFromCache(t,"wins")}/${this.getCounterFromCache(t,"simulations")}`}}class Ha{}class rr extends Ha{getBoardValue(t,e){const n=this.getMetrics(t,e);return mn.ofMultiple(n.get(O.ZERO).get(),n.get(O.ONE).get())}}class EI extends rr{getMetrics(t,e){return G1.ofSingle(0,0)}}class fn{name;rules;heuristic;moveGenerator;random=!1;prune=!0;availableOptions=[];constructor(t,e,n,i){this.name=t,this.rules=e,this.heuristic=n,this.moveGenerator=i;for(let o=1;o<10;o++)this.availableOptions.push({name:`Level ${o}`,maxDepth:o})}toString(){return this.name}chooseNextMove(t,e,n){L.assert(!1===this.rules.getGameStatus(t,n).isEndGame,"Minimax has been asked to choose a move from a finished game");const i=this.getExpectedExtremum(t,n);let o=this.alphaBeta(t,e.maxDepth,i.toMinimum(),i.toMaximum(),n);for(;o.gameState.turn>t.gameState.turn+1;)o=o.parent.get();return o.previousMove.get()}alphaBeta(t,e,n,i,o){if(e<1)return t;if(this.rules.getGameStatus(t,o).isEndGame)return t;const s=this.getPossibleMoves(t,o);L.assert(s.size()>0,"Minimax "+this.name+" should give move, received none!");const a=this.getBestChildren(t,s,e,n,i,o),c=this.getBestChildAmong(a),l=this.getScore(c,o);return this.setScore(t,l),c}getPossibleMoves(t,e){const n=this.getMoves(t);if(n.isAbsent()){const i=this.moveGenerator.getListMoves(t,e);return this.setMoves(t,new st(i)),new st(i)}return n.get()}getBestChildren(t,e,n,i,o,s){let a=[];const c=t.gameState.getCurrentPlayer();let l=this.getExpectedExtremum(t,s);const u=c===O.ZERO?mn.isLessThan:mn.isGreaterThan;for(const f of e){const g=this.getOrCreateChild(t,f,s),y=this.alphaBeta(g,n-1,i,o,s),S=this.getScore(y,s);if(u(S,l)||0===a.length?(l=S,a=[y]):S.equals(l)&&a.push(y),this.prune&&u(l,c===O.ZERO?i:o))break;c===O.ZERO?o=mn.min(l,o):i=mn.max(l,i)}return a}getExpectedExtremum(t,e){const n=this.getScore(t,e);return t.gameState.getCurrentPlayer()===O.ZERO?n.toMaximum():n.toMinimum()}getBestChildAmong(t){return this.random?yt.getRandomElement(t):t[0]}getOrCreateChild(t,e,n){const i=t.getChild(e);if(i.isAbsent()){const o=this.rules.isLegal(e,t.gameState,n),s=e.toString();L.assert(o.isSuccess(),'The minimax "'+this.name+'" has proposed an illegal move ('+s+"), refusal reason: "+o.getReasonOr("")+" this should not happen.");const a=this.rules.applyLegalMove(e,t.gameState,n,o.get()),c=new ms(a,h.of(t),h.of(e));return t.addChild(c),this.setScore(c,this.computeBoardValue(c,n)),c}return i.get()}setScore(t,e){t.setCache(this.name+"-score",e)}getScore(t,e){const n=t.getCache(this.name+"-score");if(n.isPresent())return n.get();{const i=this.computeBoardValue(t,e);return this.setScore(t,i),i}}computeBoardValue(t,e){const n=this.rules.getGameStatus(t,e);return n.isEndGame?n.toBoardValue():this.heuristic.getBoardValue(t,e)}setMoves(t,e){t.setCache(this.name+"-moves",e)}getMoves(t){return t.getCache(this.name+"-moves")}getInfo(t,e){return"BoardValue="+this.heuristic.getBoardValue(t,e).metrics}}class sIe extends rr{getMetrics(t,e){return t.gameState.getScores().toTable()}}class Kn{}let aIe=(()=>class r{static aiTime=0})();class WQ extends Kn{getListMoves(t,e){const n=[],i=t.gameState,o=i.getCurrentPlayer();for(let s=0;s<9;s++)for(let a=0;a<9;a++){const c=new _(a,s);if(!1!==i.getPieceAt(c).is(o))for(const l of Te.factory.all){const u=g2.ofSingleCoord(c,l);if(this.isAcceptablePush(u,i)){n.push(u);for(const f of Te.factory.all)for(let g=1;g<=2&&!f.equals(l);g++){const y=c.getNext(f,g);if(!Zs.isOnBoard(y))break;{const S=g2.ofDoubleCoord(c,y,l);js.get().isLegal(S,i).isSuccess()&&n.push(S)}}}}}return new st(n).toList()}isAcceptablePush(t,e){const n=e.getScores(),i=js.get().isLegal(t,e);if(i.isSuccess()){const o=e.getCurrentOpponent(),a=new Zs(i.get(),e.turn+1).getScores();return!(n.get(o)<a.get(o))}return!1}}function cIe(r,t){if(1&r){const e=he();I(),E(0,"circle",6),q("click",function(){te(e);const i=p(2).index,o=p().index;return ne(p().onPieceClick(i,o))}),P()}if(2&r){const e=p(2).index,n=p().index,i=p();ve("id","piece_",e,"_",n,""),v("ngClass",i.getPieceClasses(e,n)),A("r",.5*i.SPACE_SIZE)}}function lIe(r,t){if(1&r){const e=he();I(),E(0,"g")(1,"polygon",4),q("click",function(){te(e);const i=p().index,o=p().index;return ne(p().onSpaceClick(i,o))}),P(),z(2,cIe,1,4,"circle",5),P()}if(2&r){const e=p(),n=e.index,i=e.$implicit,o=p().index,s=p();A("transform",s.getHexaCenterTranslationAtXY(n,o)),m(),ve("id","space_",n,"_",o,""),v("ngClass",s.getSquareClasses(n,o)),A("points",s.getHexaPoints()),m(),v("ngIf",s.isPiece(i))}}function uIe(r,t){if(1&r&&(I(),E(0,"g"),z(1,lIe,3,6,"g",3),P()),2&r){const e=t.$implicit,n=p(2);m(),v("ngIf",n.isBoard(e))}}function fIe(r,t){if(1&r&&(I(),E(0,"g"),z(1,uIe,2,1,"g",1),P()),2&r){const e=t.$implicit;m(),v("ngForOf",e)}}function dIe(r,t){if(1&r&&(I(),E(0,"g"),V(1,"polygon",7)(2,"circle",8),P()),2&r){const e=t.$implicit,n=p();A("transform",n.getHexaCenterTranslation(e.coord)),m(),ve("id","space_",e.coord.x,"_",e.coord.y,""),v("ngClass",n.getSquareClasses(e.coord.x,e.coord.y)),A("points",n.getHexaPoints()),m(),ve("id","piece_",e.coord.x,"_",e.coord.y,""),v("ngClass",e.pieceClasses),A("r",.5*n.SPACE_SIZE)}}function hIe(r,t){if(1&r){const e=he();I(),E(0,"g",9),V(1,"line",10),E(2,"polygon",11),q("click",function(){const o=te(e).$implicit;return ne(p().chooseDirection(o.dir))}),P()()}if(2&r){const e=t.$implicit;Ug("id","arrow_",e.start.x,"_",e.start.y,"_to_",e.landing.x,"_",e.landing.y,""),m(),Tn("id","line_",e.dir.toString(),""),A("x1",e.startCenter.x)("y1",e.startCenter.y)("x2",e.landingCenter.x)("y2",e.landingCenter.y),m(),Tn("id","direction_",e.dir.toString(),""),A("transform",e.transformation)}}class gIe{start;startCenter;landing;landingCenter;dir;transformation;constructor(t,e,n,i,o,s){this.start=t,this.startCenter=e,this.landing=n,this.landingCenter=i,this.dir=o,this.transformation=s}}let pIe=(()=>{class r extends ru{moveds=[];captureds=[];directions=[];selecteds=[];constructor(e){super(e),this.setRulesAndNode("Abalone"),this.availableAIs=[new fn($localize`Score`,this.rules,new sIe,new WQ),new zn($localize`MCTS`,new WQ,this.rules)],this.encoder=g2.encoder,this.scores=h.of(we.of(0,0)),this.SPACE_SIZE=30,this.hexaLayout=new iu(this.SPACE_SIZE,new _(-8*this.SPACE_SIZE,2*this.SPACE_SIZE),OC.INSTANCE)}updateBoard(e){var n=this;return M(function*(){n.hexaBoard=n.getState().getCopiedBoard(),n.scores=h.of(n.getState().getScores())})()}hideLastMove(){this.moveds=[],this.captureds=[]}cancelMoveAttempt(){this.directions=[],this.selecteds=[]}showLastMove(e){var n=this;return M(function*(){e.isSingleCoord()?n.showPushingMove(e):n.showSideStepMove(e)})()}showPushingMove(e){const n=this.getPreviousState();let i=e.coord;for(this.moveds=[i],i=i.getNext(e.dir);Zs.isOnBoard(i)&&n.isPiece(i);)this.moveds.push(i),i=i.getNext(e.dir);if(Zs.isOnBoard(i))this.moveds.push(i);else{const o=i.getPrevious(e.dir),s=n.getPieceAt(o);this.captureds=[{coord:i,pieceClasses:[this.getPlayerClass(s.getPlayer())]}]}}showSideStepMove(e){let n=e.lastPiece.get();const i=e.coord.getDirectionToward(n).get();n=n.getNext(i);let o=e.coord;for(;!1===o.equals(n);){this.moveds.push(o);const s=o.getNext(e.dir);if(Zs.isOnBoard(s))this.moveds.push(s);else{const a=this.getPreviousState().getCurrentPlayer();this.captureds.push({coord:s,pieceClasses:[this.getPlayerClass(a)]})}o=o.getNext(i)}}onPieceClick(e,n){var i=this;return M(function*(){const o=yield i.canUserPlay("#piece_"+e+"_"+n);if(o.isFailure())return i.cancelMove(o.getReason());const s=i.getState().getCurrentOpponent();return i.hexaBoard[n][e].is(s)?i.opponentClick(e,n):0===i.selecteds.length?i.firstClick(e,n):1===i.selecteds.length?i.secondClick(e,n):i.thirdClick(e,n)})()}opponentClick(e,n){var i=this;return M(function*(){return(yield i.tryChoosingDirection(e,n)).isSuccess()?w.SUCCESS:i.cancelMove(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT())})()}firstClick(e,n){var i=this;return M(function*(){return i.selecteds=[new _(e,n)],i.showPossibleDirections(),w.SUCCESS})()}showPossibleDirections(){this.directions=[],L.assert(this.selecteds.length>0,"do not call showPossibleDirections if there is no selected piece"),this.showDirection()}showDirection(){const e=this.getState();for(const n of Te.factory.all){const i=this.getArrowPath(n);let o;if(o=1===this.selecteds.length?g2.ofSingleCoord(i.start,n):g2.ofDoubleCoord(i.start,i.end,n),this.rules.isLegal(o,e).isSuccess()){const a=this.getCenterAt(i.pointed),c=a.x+" "+a.y,g="rotate("+(Te.getAngle(n)+150)+" "+c+") translate("+c+")",y=new gIe(i.start,this.getCenterAt(i.start),i.pointed,this.getCenterAt(i.pointed),n,g);this.directions.push(y)}}}getArrowPath(e){let n=this.selecteds[0],i=this.selecteds[this.selecteds.length-1];if(this.selecteds.length>1&&n.getDirectionToward(i).get().equals(e.getOpposite())){const o=n;n=i,i=o}return{start:n,end:i,pointed:this.getPointed(n,i,e)}}getPointed(e,n,i){if(1===this.selecteds.length||e.getDirectionToward(n).get().equals(i)){const s=this.getState(),a=s.getCurrentPlayer();let c=n;for(;s.isOnBoard(c)&&s.getPieceAt(c).is(a);)c=c.getNext(i,1);return c}return e.getNext(i,1)}isBoard(e){return e!==Pe.UNREACHABLE}isPiece(e){return e!==Pe.EMPTY}secondClick(e,n){var i=this;return M(function*(){const o=i.selecteds[0],s=new _(e,n);if(s.equals(o))return i.cancelMoveAttempt(),w.SUCCESS;if(!1===s.isHexagonallyAlignedWith(o))return i.cancelMoveAttempt(),i.firstClick(e,n);const a=s.getDistance(o);if(a>2)return i.cancelMove(yl.CANNOT_MOVE_MORE_THAN_THREE_PIECES());const c=o.getDirectionToward(s).get();i.selecteds=[o];for(let l=0;l<a;l++)i.selecteds.push(o.getNext(c,l+1));if(3===i.selecteds.length){const l=i.selecteds[1],u=i.getState().getCurrentPlayer();if(!1===i.hexaBoard[l.y][l.x].is(u))return i.cancelMoveAttempt(),i.firstClick(e,n)}return i.showPossibleDirections(),w.SUCCESS})()}thirdClick(e,n){var i=this;return M(function*(){const o=new _(e,n),s=i.selecteds[0];if(o.equals(s))return i.deselectExtremity(!0);const a=i.selecteds[i.selecteds.length-1];return o.equals(a)?i.deselectExtremity(!1):3===i.selecteds.length&&o.equals(i.selecteds[1])?(i.cancelMoveAttempt(),w.SUCCESS):i.tryExtension(o,s,a)})()}tryExtension(e,n,i){var o=this;return M(function*(){const s=me.factory.fromMove(n,e);if(s.isSuccess()){const c=me.factory.fromMove(i,e);if(s.equals(c)){const l=n.getDistance(e),u=i.getDistance(e);return 2===Math.max(l,u)?(o.selecteds.push(e),yt.sortByDescending(o.selecteds,g2.sortCoord),o.showPossibleDirections(),w.SUCCESS):o.cancelMove(yl.CANNOT_MOVE_MORE_THAN_THREE_PIECES())}}const a=yield o.cancelMove(yl.LINE_AND_COORD_NOT_ALIGNED());return yield o.firstClick(e.x,e.y),a})()}deselectExtremity(e){var n=this;return M(function*(){return n.selecteds=n.selecteds.slice(e?1:0,e?void 0:-1),n.showPossibleDirections(),w.SUCCESS})()}chooseDirection(e){var n=this;return M(function*(){const i=yield n.canUserPlay("#direction_"+e.toString());return i.isFailure()?n.cancelMove(i.getReason()):n._chooseDirection(e)})()}_chooseDirection(e){var n=this;return M(function*(){const i=n.selecteds[0];if(1===n.selecteds.length){const o=g2.ofSingleCoord(i,e);return n.chooseMove(o)}{const s=g2.ofDoubleCoord(i,n.selecteds[n.selecteds.length-1],e);return n.chooseMove(s)}})()}onSpaceClick(e,n){var i=this;return M(function*(){const o=yield i.canUserPlay("#space_"+e+"_"+n);return o.isFailure()?i.cancelMove(o.getReason()):i.tryChoosingDirection(e,n)})()}tryChoosingDirection(e,n){var i=this;return M(function*(){const o=new _(e,n);for(const s of i.directions)if(s.landing.equals(o))return i._chooseDirection(s.dir);return w.failure("not a direction")})()}getSquareClasses(e,n){const i=new _(e,n),o=[];return this.moveds.some(s=>s.equals(i))&&o.push("moved-fill"),o}getPieceClasses(e,n){const i=new _(e,n),o=this.hexaBoard[n][e].getPlayer(),s=[this.getPlayerClass(o)];return this.selecteds.some(a=>a.equals(i))&&s.push("selected-stroke"),s}static \u0275fac=function(n){return new(n||r)(G(Ut))};static \u0275cmp=Ue({type:r,selectors:[["app-abalone"]],features:[$e],decls:4,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-165 0 470 500","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id",4,"ngFor","ngForOf"],[4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass","click"],["cx","0","cy","0","class","base",3,"id","ngClass","click",4,"ngIf"],["cx","0","cy","0",1,"base",3,"id","ngClass","click"],["stroke-linecap","round",1,"base","captured-fill",3,"id","ngClass"],["cx","0","cy","0",1,"base","semi-transparent",3,"id","ngClass"],[3,"id"],[1,"arrow","click-delegator",3,"id"],["points","-10 -5, 10 -5, 0 15, -10 -5",1,"arrow",3,"id","click"]],template:function(n,i){1&n&&(I(),E(0,"svg",0),z(1,fIe,2,1,"g",1)(2,dIe,3,9,"g",1)(3,hIe,3,11,"g",2),P()),2&n&&(m(),v("ngForOf",i.hexaBoard),m(),v("ngForOf",i.captureds),m(),v("ngForOf",i.directions))},dependencies:[zt,Nt,bt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}return r})();class PI extends Kn{getListMoves(t,e){const n=t.gameState;return nr.ALL_MOVES.filter(function i(o){return Va.get().isLegal(o,n).isSuccess()})}}class mIe extends rr{getMetrics(t,e){const n=G1.of([0,0,0,0],[0,0,0,0]);for(let i=0;i<4;i++){const o=t.gameState.board[3-i].getDominatingPlayer();o.isPlayer()&&n.add(o,i,1)}return n}}class _Ie extends rr{getMetrics(t,e){const n=t.gameState.board[3].getDominatingPlayer(),i=G1.of([0],[0]);return n.isPlayer()&&i.add(n,0,1),i}}function CIe(r,t){if(1&r&&(I(),V(0,"circle",5)),2&r){const e=t.$implicit,n=p();A("cx",n.getRemainingPieceCx(e))("cy",n.PIECE_RADIUS)("r",n.PIECE_RADIUS-5)}}function vIe(r,t){if(1&r&&(I(),V(0,"circle",6)),2&r){const e=t.$implicit,n=p();A("cx",n.BOARD_WIDTH-n.getRemainingPieceCx(e))("cy",n.BOARD_HEIGHT-n.PIECE_RADIUS)("r",n.PIECE_RADIUS-5)}}function yIe(r,t){if(1&r){const e=he();I(),E(0,"polygon",9),q("click",function(){te(e);const i=p().index,o=p();return ne(o.onArrowClick(i,o.PlayerOrNone.ZERO))}),P()}if(2&r){const e=p().index,n=p();Tn("id","dropArrow_zero_",e,""),v("ngClass",n.getArrowClasses(e,n.PlayerOrNone.ZERO)),A("points",n.ARROW_COORD)("transform","translate("+n.SPACE_SIZE/2+" "+-n.SPACE_SIZE/2+")")}}function MIe(r,t){if(1&r){const e=he();I(),E(0,"polygon",9),q("click",function(){te(e);const i=p().index,o=p();return ne(o.onArrowClick(i,o.PlayerOrNone.ONE))}),P()}if(2&r){const e=p().index,n=p();Tn("id","dropArrow_one_",e,""),v("ngClass",n.getArrowClasses(e,n.PlayerOrNone.ONE)),A("points",n.ARROW_COORD)("transform","translate(0 "+-n.SPACE_SIZE/2+")")}}function EIe(r,t){if(1&r){const e=he();I(),jt(0),E(1,"circle",10),q("click",function(){te(e);const i=p().index;return ne(p().onSquareClick(i))}),P(),Zt()}if(2&r){const e=t.$implicit,n=p(),i=n.index,o=n.$implicit,s=p();m(),Ur("id","square_",i,"_piece_",e,"_out_of_",o.count(s.PlayerOrNone.NONE),""),v("ngClass",s.getPieceClasses(i,e,o)),A("cx",s.getCircleCenter(i,e,o).x)("cy",s.getCircleCenter(i,e,o).y)}}function PIe(r,t){if(1&r){const e=he();I(),E(0,"g"),z(1,yIe,1,4,"polygon",7)(2,MIe,1,4,"polygon",7),E(3,"rect",8),q("click",function(){const o=te(e).index;return ne(p().onSquareClick(o))}),P(),z(4,EIe,2,6,"ng-container",4),P()}if(2&r){const e=t.$implicit,n=t.index,i=p();A("transform",i.getBlockTransform(n)),m(),v("ngIf",i.canDisplayArrow(n,i.PlayerOrNone.ZERO)),m(),v("ngIf",i.canDisplayArrow(n,i.PlayerOrNone.ONE)),m(),Tn("id","square_",n,""),v("ngClass",i.getSquareClasses(n)),A("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),m(),v("ngForOf",i.ArrayUtils.range(e.count(i.PlayerOrNone.NONE)))}}let SIe=(()=>{class r extends Fc{PlayerOrNone=B;BOARD_WIDTH=4*this.SPACE_SIZE;BOARD_HEIGHT=4.5*this.SPACE_SIZE;board;remainingZero;remainingOne;ARROW_COORD=r.getArrowCoord();PIECES_PER_PLAYER=Va.PIECES_PER_PLAYER;PIECE_RADIUS;movedSquare;selectedPiece=h.empty();leftPiece=h.empty();droppedPiece=h.empty();displayableArrow=[];static getArrowCoord(){return"12.5,0 37.5,0 37.5,25 50,25 25,50 0,25 12.5,25"}constructor(e){super(e),this.setRulesAndNode("Apagos"),this.availableAIs=[new fn($localize`Rightmost Focus`,this.rules,new _Ie,new PI),new fn($localize`Full Board`,this.rules,new mIe,new PI),new zn($localize`MCTS`,new PI,this.rules)],this.encoder=nr.encoder,this.hasAsymmetricBoard=!0,this.PIECE_RADIUS=2*this.SPACE_SIZE/(this.PIECES_PER_PLAYER+.5)}cancelMoveAttempt(){this.selectedPiece=h.empty(),this.showPossibleDrops()}updateBoard(e){var n=this;return M(function*(){const i=n.getState();n.board=i.board,n.remainingZero=i.remaining.get(O.ZERO),n.remainingOne=i.remaining.get(O.ONE),n.hideLastMove(),n.showPossibleDrops()})()}hideLastMove(){this.movedSquare=[],this.droppedPiece=h.empty(),this.leftPiece=h.empty(),this.selectedPiece=h.empty()}showLastMove(e){var n=this;return M(function*(){e.isDrop()?n.showLastDrop(e):n.showLastTransfer(e)})()}showLastDrop(e){const n=e.piece.get();let i=e.landing.x;this.movedSquare=[i],3!==e.landing.x&&(i+=1,this.movedSquare.push(i));const s=this.getLowestPlayerPiece(this.board[i],n);this.droppedPiece=h.of({square:i,piece:s})}getLowestPlayerPiece(e,n){const i=e.count(n);return n===O.ZERO?i-1:e.count(B.NONE)-i}showLastTransfer(e){const n=this.getPreviousState(),i=n.getCurrentPlayer(),o=e.starting.get().x,a=this.getLowestPlayerPiece(n.board[o],i);this.leftPiece=h.of({square:o,piece:a});const c=e.landing.x,u=this.getLowestPlayerPiece(this.board[c],i);this.droppedPiece=h.of({square:c,piece:u})}showPossibleDrops(){this.displayableArrow=[];const e=this.getState();for(let n=0;n<4;n++)!1===e.board[n].isFull()&&(e.remaining.get(O.ZERO)>0&&this.displayableArrow.push({x:n,player:O.ZERO}),e.remaining.get(O.ONE)>0&&this.displayableArrow.push({x:n,player:O.ONE}))}getCircleCenter(e,n,i){const o=this.SPACE_SIZE/2,s=this.SPACE_SIZE/2;if(1===i.count(B.NONE))return new _(o,s);const a=i.count(B.NONE),c=2*n*Math.PI/a-Math.PI/2,l=.3*this.SPACE_SIZE,u=l*Math.cos(c),f=l*Math.sin(c);return new _(o+u,s+f)}canDisplayArrow(e,n){return this.displayableArrow.some(i=>i.x===e&&i.player.equals(n))}getArrowClasses(e,n){return[this.getPlayerClass(n)]}getBlockTransform(e){return"translate("+e*this.SPACE_SIZE+", "+((3-e)*this.SPACE_SIZE+.5*this.SPACE_SIZE)+")"}getSquareClasses(e){const n=["base"];return this.selectedPiece.isPresent()&&this.selectedPiece.get().square===e?n.push("selected-stroke"):this.movedSquare.includes(e)&&n.push("last-move-stroke"),n}onArrowClick(e,n){var i=this;return M(function*(){const o=n===O.ZERO?"zero":"one",s=yield i.canUserPlay("#dropArrow_"+o+"_"+e);if(s.isFailure())return i.cancelMove(s.getReason());const a=un.of(e);if(i.selectedPiece.isPresent()){const c=i.selectedPiece.get().square,l=nr.transfer(un.of(c),a).get();return i.chooseMove(l)}{const c=nr.drop(a,n);return i.chooseMove(c)}})()}getPieceClasses(e,n,i){const o={square:e,piece:n},s=[];let a=i.count(O.ZERO),c=i.count(O.ONE);if(this.selectedPiece.equalsValue(o))s.push("selected-stroke");else if(this.droppedPiece.equalsValue(o))s.push("last-move-stroke");else if(this.leftPiece.isPresent()&&this.leftPiece.get().square===e){if(this.leftPiece.get().piece===n)return s.push("captured-stroke"),s;this.getState().getCurrentOpponent()===O.ZERO?a++:c++}const l=i.count(B.NONE)-(c+a),u=this.getPieceColor(n,a,l);return""!==u&&s.push(u),s}getPieceColor(e,n,i){return e<n?"player0-fill":e<n+i?"":"player1-fill"}onSquareClick(e){var n=this;return M(function*(){const i=yield n.canUserPlay("#square_"+e);if(i.isFailure())return n.cancelMove(i.getReason());if(n.selectedPiece.isPresent()&&n.selectedPiece.get().square===e)return n.cancelMoveAttempt(),w.SUCCESS;const o=n.getState().getCurrentPlayer(),s=n.board[e];return s.count(o)<=0?n.cancelMove(tu.NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE()):(n.selectedPiece=h.of({square:e,piece:n.getLowestPlayerPiece(s,o)}),0===n.showAndGetPossibleTranfers().length?n.cancelMove(tu.NO_POSSIBLE_TRANSFER_REMAINS()):w.SUCCESS)})()}showAndGetPossibleTranfers(){this.displayableArrow=[];let e=this.selectedPiece.get().square-1;const n=this.getState().getCurrentPlayer();for(;0<=e;)!1===this.board[e].isFull()&&this.displayableArrow.push({x:e,player:n}),e--;return this.displayableArrow}getRemainingPieceCx(e){return(e+.5)*this.PIECE_RADIUS*1.5}static \u0275fac=function(n){return new(n||r)(G(Ut))};static \u0275cmp=Ue({type:r,selectors:[["app-apagos"]],features:[$e],decls:6,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["class","base mid-stroke player1-fill",4,"ngFor","ngForOf"],["class","base mid-stroke player0-fill",4,"ngFor","ngForOf"],["id","board"],[4,"ngFor","ngForOf"],[1,"base","mid-stroke","player1-fill"],[1,"base","mid-stroke","player0-fill"],["class","base mid-stroke",3,"id","ngClass","click",4,"ngIf"],["x","0","y","0",1,"base","mid-stroke",3,"id","ngClass","click"],[1,"base","mid-stroke",3,"id","ngClass","click"],["r","10",1,"base","mid-stroke",3,"id","ngClass","click"]],template:function(n,i){1&n&&(I(),E(0,"svg",0)(1,"g"),z(2,CIe,1,3,"circle",1)(3,vIe,1,3,"circle",2),P(),E(4,"g",3),z(5,PIe,5,8,"g",4),P()()),2&n&&(A("viewBox",-i.STROKE_WIDTH/2+" "+-i.STROKE_WIDTH/2+" "+(i.BOARD_WIDTH+i.STROKE_WIDTH)+" "+(i.BOARD_HEIGHT+i.STROKE_WIDTH)),m(),A("transform","rotate("+180*i.getPointOfView().getValue()+" "+i.BOARD_WIDTH/2+" "+i.BOARD_HEIGHT/2+")"),m(),v("ngForOf",i.ArrayUtils.range(i.remainingOne)),m(),v("ngForOf",i.ArrayUtils.range(i.remainingZero)),m(2),v("ngForOf",i.board))},dependencies:[zt,Nt,bt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}return r})();class $1 extends B1{scores;static of(t,e){return new $1(e,t.turn,t.getScoresCopy())}constructor(t,e,n){super(t,e),this.scores=n}setPieceAt(t,e){return super.setPieceAt(t,e,$1.of)}feedStore(t){const e=this.getScoresCopy();return e.add(t,1),new $1(this.getCopiedBoard(),this.turn,e)}feed(t){return this.addPieceAt(t,1)}addPieceAt(t,e){const n=this.getPieceAt(t);return this.setPieceAt(t,n+e)}getTotalRemainingSeeds(){return rt.sum(this.board)}getScoresCopy(){return this.scores.getCopy()}capture(t,e){const n=this.getPieceAt(e),i=this.getScoresCopy();return i.add(t,n),new $1(this.getCopiedBoard(),this.turn,i).setPieceAt(e,0)}equals(t){return!1!==rt.compare(this.board,t.board)&&!1!==this.scores.equals(t.scores)&&this.turn===t.turn}getCurrentPlayerY(){return this.getCurrentOpponent().getValue()}getOpponentY(){return this.getCurrentPlayer().getValue()}}class p1{x;static encoder=ke.tuple([ke.identity()],t=>[t.x],t=>p1.of(t[0]));static of(t){return L.assert(0<=t,"MancalaDistribution should be a positive integer!"),new p1(t)}constructor(t){this.x=t}equals(t){return t===this||t.x===this.x}}class w1 extends h2{distributions;static encoder=ke.tuple([ke.list(p1.encoder)],t=>[t.distributions],t=>w1.of(t[0][0],t[0].slice(1)));static of(t,e=[]){const n=[t];return n.push(...e),new w1(n)}constructor(t){super(),this.distributions=t,L.assert(t.length>0,"Move should have distribution ")}add(t){return w1.of(this.distributions[0],this.distributions.slice(1).concat(t))}toString(){return"MancalaMove(["+this.distributions.map(e=>e.x).join(", ")+"])"}equals(t){return yt.equals(this.distributions,t.distributions)}getFirstDistribution(){return this.distributions[0]}[Symbol.iterator](){return this.distributions.values()}}let yd=(()=>class r{static MUST_DISTRIBUTE_YOUR_OWN_HOUSES=()=>$localize`You must distribute one of your houses.`;static MUST_CHOOSE_NON_EMPTY_HOUSE=()=>$localize`You should choose a non-empty house to distribute.`;static SHOULD_DISTRIBUTE=()=>$localize`You should feed but you do not.`})();class Dn extends Da{capturableValues;static FEED_ORIGINAL_HOUSE=()=>$localize`Feed original house`;static MUST_FEED=()=>$localize`Must feed`;static PASS_BY_PLAYER_STORE=()=>$localize`Pass by player store`;static MULTIPLE_SOW=()=>$localize`Must continue distribution after last seed ends in store`;static CYCLICAL_LAP=()=>$localize`Continue distribution until capture or empty house`;static SEEDS_BY_HOUSE=()=>$localize`Seeds by house`;static FAKE_STORE_COORD=new nu([{key:O.ZERO,value:new _(-1,-1)},{key:O.ONE,value:new _(2,2)}]);static isStarving(t,e){let n=0;const i=t.getOpponent().getValue();for(;n<e[0].length;)if(e[i][n++]>0)return!1;return!0}static getEmptyDistributionResult(t){return{capturedSum:0,captureMap:rt.create(t.getWidth(),2,0),endsUpInStore:!1,filledCoords:[],passedByStoreNTimes:0,resultingState:t}}static getInitialState(t){const e=t.get(),n=rt.create(e.width,2,e.seedsByHouse);return new $1(n,0,we.of(0,0))}constructor(t){super(),this.capturableValues=t}isLegal(t,e,n){const i=n.get(),o=e.getCurrentPlayerY();let s=!0;for(const a of t){L.assert(s,"Cannot play after non kalah move");const c=this.isLegalDistribution(a,e,i);if(c.isFailure())return w.ofFallible(c);{const l=Dn.getEmptyDistributionResult(e);e=this.distributeHouse(a.x,o,l,i).resultingState,s=c.get()}}if(i.mustContinueDistributionAfterStore&&L.assert(!1===s,"Must continue playing after kalah move"),i.mustFeed){const a=e.getCurrentOpponent(),c=Dn.isStarving(a,e.board),l=this.canDistribute(e.getCurrentPlayer(),e,i);if(c&&l)return w.failure(yd.SHOULD_DISTRIBUTE())}return w.SUCCESS}getInitialState(t){const e=t.get(),n=rt.create(e.width,2,e.seedsByHouse);return new $1(n,0,we.of(0,0))}isLegalDistribution(t,e,n){const i=e.getCurrentPlayerY();if(0===e.getPieceAtXY(t.x,i))return X.failure(yd.MUST_CHOOSE_NON_EMPTY_HOUSE());const o=this.distributeMove(w1.of(t),e,n),s=Dn.isStarving(o.resultingState.getCurrentPlayer(),o.resultingState.board);return X.success(o.endsUpInStore&&!1===s)}distributeMove(t,e,n){const i=e.getCurrentPlayer(),o=e.getCurrentPlayerY(),s=[];let a={capturedSum:0,captureMap:rt.create(n.width,2,0),endsUpInStore:!1,passedByStoreNTimes:0,filledCoords:[],resultingState:e};for(const c of t){let l=new _(c.x,o),u=!0;for(;u;)a=this.distributeHouse(l.x,l.y,a,n),a.resultingState.getScoresCopy().add(i,a.passedByStoreNTimes),s.push(...a.filledCoords),a.passedByStoreNTimes+=a.passedByStoreNTimes,l=a.filledCoords[a.filledCoords.length-1],u=!(!n.continueLapUntilCaptureOrEmptyHouse||!1!==a.endsUpInStore)&&!1===this.isHouseCapturableOrEmpty(l,a.resultingState)}return{endsUpInStore:a.endsUpInStore,filledCoords:s,passedByStoreNTimes:a.passedByStoreNTimes,resultingState:a.resultingState,capturedSum:0,captureMap:a.captureMap}}isHouseCapturableOrEmpty(t,e){const n=e.getPieceAt(t);return 1===n||this.capturableValues.some(i=>i===n)}mustMonsoon(t,e){const n=t.getCopiedBoard(),i=t.getCurrentOpponent(),o=t.getCurrentPlayer();if(e.mustFeed){if(Dn.isStarving(o,n)&&!1===this.canDistribute(i,t,e))return[i]}else{if(Dn.isStarving(i,n))return[o];if(Dn.isStarving(o,n))return[i]}return[]}getGameStatus(t,e){const n=t.gameState,s=t.gameState.getWidth()*e.get().seedsByHouse;return n.scores.get(O.ZERO)>s?ye.ZERO_WON:n.scores.get(O.ONE)>s?ye.ONE_WON:n.scores.get(O.ZERO)===s&&n.scores.get(O.ONE)===s?ye.DRAW:ye.ONGOING}applyLegalMove(t,e,n,i){const o=this.distributeMove(t,e,n.get()),s=this.applyCapture(o,n.get());let a=s.resultingState;const c=this.mustMonsoon(a,n.get());return 1===c.length?a=this.monsoon(c[0],s).resultingState:2===c.length&&(a=this.sharedMonsoon(s).resultingState),new $1(a.board,a.turn+1,a.scores)}distributeHouse(t,e,n,i){let o=new _(t,e);const s=new _(t,e);let a=n.resultingState.getPieceAt(s),c=n.resultingState.setPieceAt(s,0);const l=c.getCurrentPlayer(),u=[];let f=0,g=!1,y=!1,S=0;for(;a>0;){g=y,y=!1;const N=this.getNextCoord(o,g,n.resultingState,i);if(y=N.isAbsent(),y)f++,c=c.feedStore(l),a--,u.push(Dn.FAKE_STORE_COORD.get(l).get());else if(o=N.get(),!1===s.equals(o)||i.feedOriginalHouse){const R=this.getDropResult(a,c,o);c=R.resultingState,n.captureMap=rt.add(n.captureMap,R.captureMap),S+=R.capturedSum,u.push(o),a--}}return{filledCoords:u,passedByStoreNTimes:f,endsUpInStore:y,resultingState:c,capturedSum:S,captureMap:n.captureMap}}getDropResult(t,e,n){return{capturedSum:0,captureMap:rt.create(e.getWidth(),2,0),resultingState:e.feed(n)}}getNextCoord(t,e,n,i){const o=n.getCurrentPlayer();return 0===t.y?t.x===n.getWidth()-1?i.passByPlayerStore&&o===O.ONE&&!1===e?h.empty():h.of(new _(t.x,1)):h.of(new _(t.x+1,0)):0===t.x?i.passByPlayerStore&&o===O.ZERO&&!1===e?h.empty():h.of(new _(0,0)):h.of(new _(t.x-1,1))}doesDistribute(t,e,n,i){const o=n.board;let s;return s=0===e?n.getWidth()-(t+1):t+1,s+(i.passByPlayerStore?1:0)<=o[e][t]}canDistribute(t,e,n){for(let i=0;i<e.getWidth();i++)if(this.doesDistribute(i,t.getOpponent().getValue(),e,n))return!0;return!1}monsoon(t,e){const n=e.resultingState,i=rt.create(n.getWidth(),2,0),o=n.getScoresCopy(),s=n.getTotalRemainingSeeds(),a=rt.add(e.captureMap,n.board);return o.add(t,s),{capturedSum:s,captureMap:a,resultingState:new $1(i,n.turn,o)}}sharedMonsoon(t){const e=t.resultingState,n=rt.create(e.getWidth(),2,0),i=e.getScoresCopy(),o=e.getTotalRemainingSeeds(),s=rt.add(t.captureMap,e.board);return i.add(O.ZERO,Math.floor(o/2)),i.add(O.ONE,Math.floor(o/2)),{capturedSum:o,captureMap:s,resultingState:new $1(n,e.turn,i)}}}class m1{static range(t,e){return n=>null==n?w.failure($localize`This value is mandatory`):n<t?w.failure($localize`${n} is too small, the minimum is ${t}`):e<n?w.failure($localize`${n} is too big, the maximum is ${e}`):w.SUCCESS}}let Gi=(()=>class r{static WIDTH=()=>$localize`Width`;static HEIGHT=()=>$localize`Height`})();class qQ{value;title;validator;constructor(t,e,n){this.value=t,this.title=e,this.validator=n}}class _1 extends qQ{constructor(t,e,n){super(t,e,n)}}class Jn extends qQ{constructor(t,e){super(t,e)}}class fo{defaultConfigDescription;nonDefaultStandardConfigs;defaultConfig;constructor(t,e=[]){this.defaultConfigDescription=t,this.nonDefaultStandardConfigs=e;const n={};for(const o of this.getFields())n[o]=t.config[o].value;this.defaultConfig={name:t.name,config:n};const i=new st(Object.keys(t.config));for(const o of e){const s=new st(Object.keys(o.config));L.assert(s.equals(i),`Field missing in ${o.name()} config!`)}}getStandardConfigs(){return[this.defaultConfig].concat(this.nonDefaultStandardConfigs)}getDefaultConfig(){return this.defaultConfig}getFields(){return Object.keys(this.defaultConfigDescription.config)}getNonDefaultStandardConfigs(){return this.nonDefaultStandardConfigs}getI18nName(t){return this.defaultConfigDescription.config[t].title()}getConfig(t){return this.getStandardConfigs().filter(n=>n.name()===t)[0].config}getValidator(t){return L.assert(t in this.defaultConfigDescription.config,t+" is not a validator!"),this.defaultConfigDescription.config[t].validator}}class OIe{static GOBAN=new fo({name:()=>$localize`Default`,config:{width:new _1(19,Gi.WIDTH,m1.range(1,99)),height:new _1(19,Gi.HEIGHT,m1.range(1,99))}})}class Ys extends Dn{static singleton=h.empty();static RULES_CONFIG_DESCRIPTION=new fo({name:()=>$localize`Awal`,config:{feedOriginalHouse:new Jn(!1,Dn.FEED_ORIGINAL_HOUSE),mustFeed:new Jn(!0,Dn.MUST_FEED),passByPlayerStore:new Jn(!1,Dn.PASS_BY_PLAYER_STORE),mustContinueDistributionAfterStore:new Jn(!1,Dn.MULTIPLE_SOW),continueLapUntilCaptureOrEmptyHouse:new Jn(!1,Dn.CYCLICAL_LAP),seedsByHouse:new _1(4,Dn.SEEDS_BY_HOUSE,m1.range(1,99)),width:new _1(6,Gi.WIDTH,m1.range(1,99))}});static get(){return Ys.singleton.isAbsent()&&(Ys.singleton=h.of(new Ys([2,3]))),Ys.singleton.get()}getRulesConfigDescription(){return h.of(Ys.RULES_CONFIG_DESCRIPTION)}applyCapture(t,e){const n=t.filledCoords,i=n[n.length-1];return this.captureIfLegal(i.x,i.y,t.resultingState,e)}capture(t,e,n,i){const o=n.getCurrentPlayerY();L.assert(e!==o,"AwaleRules.capture cannot capture the players house");let s=n,a=s.getOptionalPieceAtXY(t,e),c=0;const l=rt.create(i.width,2,0);if(a.get()<2||a.get()>3)return{capturedSum:0,captureMap:l,resultingState:n};let u=-1,f=-1;const g=n.getCurrentPlayer();g===O.ONE&&(u=1,f=n.getWidth());do{l[e][t]=a.get(),c+=a.get(),s=s.capture(g,new _(t,e)),a=s.getOptionalPieceAtXY(t+=u,e)}while(t!==f&&(a.equalsValue(2)||a.equalsValue(3)));return{capturedSum:c,captureMap:l,resultingState:s}}captureIfLegal(t,e,n,i){const o=n.getCurrentPlayer(),s={capturedSum:0,resultingState:n,captureMap:rt.create(n.getWidth(),2,0)};if(e===o.getValue()){const a=this.capture(t,e,n,i),c=Dn.isStarving(o.getOpponent(),a.resultingState.board);return a.capturedSum>0&&c?s:a}return s}}class SI extends Kn{rules;constructor(t){super(),this.rules=t}getListMoves(t,e){const n=[],i=t.gameState,o=i.getCurrentPlayerY();for(let s=0;s<i.getWidth();s++)if(i.getPieceAtXY(s,o)>0){const a=w1.of(p1.of(s));e.get().mustContinueDistributionAfterStore?n.push(...this.getPossibleMoveContinuations(i,s,o,a,e.get())):this.rules.isLegal(a,i,e).isSuccess()&&n.push(a)}return n}getPossibleMoveContinuations(t,e,n,i,o){const s=[],a=Dn.getEmptyDistributionResult(t),c=this.rules.distributeHouse(e,n,a,o),l=c.resultingState,f=!1===Dn.isStarving(l.getCurrentPlayer(),l.board);if(c.endsUpInStore&&f){for(let g=0;g<l.getWidth();g++)if(l.getPieceAtXY(g,n)>0){const y=i.add(p1.of(g));s.push(...this.getPossibleMoveContinuations(l,g,n,y,o))}return s}return[i]}}class TIe extends SI{constructor(){super(Ys.get())}}class Ks{left;up;width;height;static fromLimits(t,e,n,i){return new Ks(t,n,e-t,i-n)}static fromHexa(t,e,n){const i=t.flatMap(u=>e.getCenterAt(u)),o=Ks.getLimits(i);return new Ks(o.minX-n/2,o.minY-n/2,n+o.maxX-o.minX,n+o.maxY-o.minY)}static getLimits(t){let e=Number.MIN_SAFE_INTEGER,n=Number.MIN_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER,o=Number.MAX_SAFE_INTEGER;for(const s of t)i=Math.min(i,s.x),o=Math.min(o,s.y),e=Math.max(e,s.x),n=Math.max(n,s.y);return{minX:i,minY:o,maxX:e,maxY:n}}constructor(t,e,n,i){this.left=t,this.up=e,this.width=n,this.height=i}center(){return new _(this.left+this.width/2,this.up+this.height/2)}bottom(){return this.up+this.height}right(){return this.left+this.width}expandAbove(t){return this.expand(0,0,t,0)}expandBelow(t){return this.expand(0,0,0,t)}expandLeft(t){return this.expand(t,0,0,0)}expandRight(t){return this.expand(0,t,0,0)}expand(t,e,n,i){return new Ks(this.left-t,this.up-n,this.width+t+e,this.height+n+i)}containingAtLeast(t){const e=Math.min(this.left,t.left),n=Math.max(this.right(),t.right()),i=Math.min(this.up,t.up),o=Math.max(this.bottom(),t.bottom());return Ks.fromLimits(e,n,i,o)}toSVGString(){return`${this.left} ${this.up} ${this.width} ${this.height}`}}class wIe{static getArrowTransform(t,e,n){let i,o,s;switch(n){case Ie.UP:i=1,o=0,s=-90;break;case Ie.DOWN:i=1,o=2,s=90;break;case Ie.LEFT:i=0,o=1,s=180;break;default:L.expectToBe(n,Ie.RIGHT),i=2,o=1,s=0}return[`scale( ${t/300} ${e/300} )`,`translate(${100*i} ${100*o})`,"rotate("+s+" 50 50)"].join(" ")}}let p2=(()=>{class r extends Fc{board;getWidth(){return this.getState().getWidth()}getHeight(){return this.getState().getHeight()}getViewBox(){const e=this.getWidth()*this.SPACE_SIZE,n=this.getHeight()*this.SPACE_SIZE,i=.5*this.STROKE_WIDTH;return Ks.fromLimits(0,e,0,n).expand(i,i,i,i)}static \u0275fac=(()=>{let e;return function(i){return(e||(e=z1(r)))(i||r)}})();static \u0275cmp=Ue({type:r,selectors:[["ng-component"]],features:[$e],decls:0,vars:0,template:function(n,i){},encapsulation:2})}return r})();function jQ(r){return 1e3*r.seconds+r.nanoseconds/1e6}function ZQ(r,t){return jQ(t)-jQ(r)}class TC{static sleep(t){return M(function*(){return new Promise(e=>{window.setTimeout(e,t)})})()}}class bIe extends rr{getMetrics(t,e){return t.gameState.getScoresCopy().toTable()}}class AIe extends fn{constructor(t,e){super($localize`Score`,t,new bIe,e)}}let OI=(()=>{class r extends p2{cdr;static TIMEOUT_BETWEEN_SEEDS=100;static TIMEOUT_BETWEEN_LAPS=1e3;MGPOptional=h;lastDistributedHouses=[];currentMove=h.empty();captured=rt.create(6,2,0);droppedInStore=we.of(0,0);filledCoords=[];constructedState;opponentMoveIsBeingAnimated=!1;constructor(e,n){super(e),this.cdr=n,this.hasAsymmetricBoard=!0,this.scores=h.of(we.of(0,0))}getMancalaViewBox(){return-this.STROKE_WIDTH/2+" "+-this.STROKE_WIDTH/2+" "+(this.getViewBoxWidth()+this.STROKE_WIDTH)+" "+(2*this.SPACE_SIZE+50)}getViewBoxWidth(){return 60+(2+this.getState().getWidth())*this.SPACE_SIZE}showLastMove(e){var n=this;return M(function*(){n.droppedInStore=we.of(0,0);const i=n.getPreviousState(),o=n.getConfig().get(),s=n.rules.distributeMove(e,i,o);n.filledCoords=s.filledCoords;let a=n.rules.applyCapture(s,o);n.captured=a.captureMap;const c=i.getCurrentPlayerY();n.lastDistributedHouses=e.distributions.map(u=>new _(u.x,c)),n.rules.mustMonsoon(a.resultingState,o).length>0&&(a=n.rules.monsoon(O.ZERO,a),n.captured=a.captureMap),n.changeVisibleState(n.getState())})()}updateBoard(e){var n=this;return M(function*(){const i=n.getState();if(e){n.opponentMoveIsBeingAnimated=!0,n.animationOngoing=!0,L.assert(n.node.parent.isPresent(),"triggerAnimation in store should be false at first turn"),n.changeVisibleState(n.node.parent.get().gameState);let o=0;const s=n.node.previousMove.get();for(const a of s)yield n.showSimpleDistribution(a),o+1<s.distributions.length&&(yield TC.sleep(r.TIMEOUT_BETWEEN_LAPS)),o++;n.opponentMoveIsBeingAnimated=!1,n.animationOngoing=!1}n.scores=h.of(i.getScoresCopy()),n.changeVisibleState(i)})()}onClick(e,n){var i=this;return M(function*(){const o=yield i.canUserPlay("#click_"+e+"_"+n);if(o.isFailure())return i.cancelMove(o.getReason());if(!0===i.animationOngoing)return w.SUCCESS;{i.animationOngoing=!0;const s=yield i.onLegalClick(e,n);return i.animationOngoing=!1,s}})()}onLegalClick(e,n){var i=this;return M(function*(){return n===i.getState().getCurrentPlayer().getValue()?i.cancelMove(yd.MUST_DISTRIBUTE_YOUR_OWN_HOUSES()):(i.updateOrCreateCurrentMove(e),0===i.constructedState.getPieceAtXY(e,n)?i.cancelMove(yd.MUST_CHOOSE_NON_EMPTY_HOUSE()):i.continueMoveConstruction(e))})()}continueMoveConstruction(e){var n=this;return M(function*(){const i=yield n.showSimpleDistribution(p1.of(e)),o=n.getConfig().get();if(i.endsUpInStore&&o.mustContinueDistributionAfterStore){const s=n.constructedState.getCurrentPlayer();return Dn.isStarving(s,i.resultingState.board)?n.chooseMove(n.currentMove.get()):w.SUCCESS}return n.chooseMove(n.currentMove.get())})()}showSimpleDistribution(e){var n=this;return M(function*(){const i=n.constructedState,o=i.getCurrentPlayerY(),s=new _(e.x,o);n.lastDistributedHouses.push(s);const a=n.getConfig().get();yield n.showSeedBySeed(s,i,a);const c=Dn.getEmptyDistributionResult(i);return n.rules.distributeHouse(e.x,o,c,a)})()}showSeedBySeed(e,n,i){var o=this;return M(function*(){const s=e;let a=!0,c={currentDropIsStore:!1,houseToDistribute:e,resultingState:n,seedsInHand:0};for(;a;){for(c.seedsInHand=c.resultingState.getPieceAt(c.houseToDistribute),c.resultingState=c.resultingState.setPieceAt(c.houseToDistribute,0),o.changeVisibleState(c.resultingState),yield TC.sleep(r.TIMEOUT_BETWEEN_SEEDS);c.seedsInHand>0;)c=yield o.showSeedDrop(c,i,s);if(c.currentDropIsStore||!1===i.continueLapUntilCaptureOrEmptyHouse)a=!1;else{const l=c.resultingState.getPieceAt(c.houseToDistribute);a=1!==l&&4!==l,a&&(yield TC.sleep(r.TIMEOUT_BETWEEN_LAPS))}}})()}showSeedDrop(e,n,i){var o=this;return M(function*(){const s=e.resultingState.getCurrentPlayer(),a=o.rules.getNextCoord(e.houseToDistribute,e.currentDropIsStore,e.resultingState,n),c=a.isAbsent();let l=e.seedsInHand,u=e.resultingState,f=e.houseToDistribute;if(c)l--,o.filledCoords.push(Dn.FAKE_STORE_COORD.get(s).get()),o.droppedInStore.add(s,1),u=u.feedStore(s);else if(f=a.get(),!1===i.equals(f)||n.feedOriginalHouse){const g=o.rules.getDropResult(l,u,f);u=g.resultingState,o.captured=rt.add(o.captured,g.captureMap),o.filledCoords.push(f),l--}return o.changeVisibleState(u),l>0&&(yield TC.sleep(r.TIMEOUT_BETWEEN_SEEDS)),{houseToDistribute:f,currentDropIsStore:c,seedsInHand:l,resultingState:u}})()}hideLastMove(){let e;e=this.config.isPresent()?this.config.get().width:6,this.captured=rt.create(e,2,0),this.filledCoords=[],this.lastDistributedHouses=[],this.changeVisibleState(this.getState())}cancelMoveAttempt(){this.currentMove=h.empty(),this.droppedInStore=we.of(0,0),this.filledCoords=[],this.lastDistributedHouses=[],this.changeVisibleState(this.getState())}getSpaceClasses(e,n){const i=new _(e,n),o=this.getSpaceOwner(i),s=this.getPlayerClass(o);return this.getStoreOwner(i).isAbsent()&&this.captured[n][e]>0?["captured-fill","moved-stroke"]:this.lastDistributedHouses.some(a=>a.equals(i))?["last-move-stroke",s]:this.filledCoords.some(a=>a.equals(i))?["moved-stroke",s]:[s]}getStoreOwner(e){return Dn.FAKE_STORE_COORD.reverse().get(e)}getSpaceOwner(e){const n=this.getStoreOwner(e);return n.isPresent()?n.get().getAnyElement().get():O.of((e.y+1)%2)}getPieceCx(e){return 80+100*(e+1)}getPieceCy(e){return 60+120*e}getPieceTransform(e,n){return"translate("+this.getPieceCx(e)+", "+this.getPieceCy(n)+")"}getPieceRotation(){return"rotate("+180*this.getPointOfView().getValue()+")"}getHouseSecondaryContent(e,n){const i=this.getPreviousStableState().getPieceAtXY(e,n),s=this.constructedState.getPieceAtXY(e,n)-i;return this.captured[n][e]>0?h.of("-"+this.captured[n][e]):s>0?h.of("+"+s):s<0?h.of(""+s):h.empty()}getStoreContent(e){return this.scores.get().get(e)+this.droppedInStore.get(e)}getStoreSecondaryContent(e){const n=this.getPreviousStableState().scores.get(e),o=this.constructedState.scores.get(e)-n;return o>0?h.of("+"+o):h.empty()}getPreviousStableState(){return this.opponentMoveIsBeingAnimated?(L.assert(this.getTurn()>0,"Kalah: Should not animate move at turn 0"),this.node.parent.get().gameState):!0===this.constructedState.equals(this.getState())&&this.node.parent.isPresent()?this.node.parent.get().gameState:this.getState()}onStoreClick(e){var n=this;return M(function*(){const i=yield n.canUserPlay("#store_player_"+e.getValue());return i.isFailure()?n.cancelMove(i.getReason()):n.cancelMove(yd.MUST_DISTRIBUTE_YOUR_OWN_HOUSES())})()}changeVisibleState(e){this.constructedState=e,this.board=this.constructedState.board,this.cdr.detectChanges()}createAIs(e){return[new AIe(this.rules,e),new zn($localize`MCTS`,e,this.rules)]}updateOrCreateCurrentMove(e){if(this.currentMove.isAbsent())this.hideLastMove(),this.currentMove=h.of(this.generateMove(e));else{const n=this.addToMove(e);this.currentMove=h.of(n)}}generateMove(e){return w1.of(p1.of(e))}addToMove(e){return this.currentMove.get().add(p1.of(e))}}return r})();const NIe=["app-numbered-circle",""];function IIe(r,t){if(1&r&&(I(),E(0,"text",3),ot(1),P()),2&r){const e=p();ve("id","secondary_message_",e.x,"_",e.y,""),A("x",15)("y",31)("transform",e.rotation),m(),ii(" ",e.secondaryContent.get()," ")}}let TI=(()=>{class r{x;y;spaceClasses;content;secondaryContent;rotation;static \u0275fac=function(n){return new(n||r)};static \u0275cmp=Ue({type:r,selectors:[["","app-numbered-circle",""]],inputs:{x:"x",y:"y",spaceClasses:"spaceClasses",content:"content",secondaryContent:"secondaryContent",rotation:"rotation"},attrs:NIe,decls:4,vars:10,consts:[["r","45",1,"base",3,"id","ngClass"],[1,"text-big","text-center",3,"id"],["class","text-20 text-center",3,"id",4,"ngIf"],[1,"text-20","text-center",3,"id"]],template:function(n,i){1&n&&(I(),V(0,"circle",0),E(1,"text",1),ot(2),P(),z(3,IIe,2,6,"text",2)),2&n&&(ve("id","circle_",i.x,"_",i.y,""),v("ngClass",i.spaceClasses),m(),ve("id","number_",i.x,"_",i.y,""),A("x",0)("y",16)("transform",i.rotation),m(),ii(" ",i.content," "),m(),v("ngIf",i.secondaryContent.isPresent()))},dependencies:[zt,bt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}return r})();function kIe(r,t){if(1&r){const e=he();I(),E(0,"g")(1,"g",8),q("click",function(){const o=te(e).index,s=p().index;return ne(p().onClick(o,s))}),P()()}if(2&r){const e=t.$implicit,n=t.index,i=p().index,o=p();m(),ve("id","click_",n,"_",i,""),v("x",n)("y",i)("content",e)("spaceClasses",o.getSpaceClasses(n,i))("rotation",o.getPieceRotation())("secondaryContent",o.getHouseSecondaryContent(n,i)),A("transform",o.getPieceTransform(n,i))}}function RIe(r,t){if(1&r&&(I(),E(0,"g"),z(1,kIe,2,9,"g",2),P()),2&r){const e=t.$implicit;m(),v("ngForOf",e)}}let xIe=(()=>{class r extends OI{constructor(e,n){super(e,n),this.setRulesAndNode("Awale"),this.availableAIs=this.createAIs(new TIe),this.encoder=w1.encoder}static \u0275fac=function(n){return new(n||r)(G(Ut),G(Vs))};static \u0275cmp=Ue({type:r,selectors:[["app-awale-component"]],features:[$e],decls:8,vars:21,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["x","0","y","0","ry","115","rx","115","fill","blue",1,"base"],[4,"ngFor","ngForOf"],["x1","120","y1","120","y2","120",1,"base"],["x1","120","y1","0","x2","120","y2","240",1,"base"],["y1","0","y2","240",1,"base"],["id","store_player_0","app-numbered-circle","","transform","translate(60 120)",3,"x","y","content","spaceClasses","rotation","secondaryContent","click"],["id","store_player_1","app-numbered-circle","",3,"x","y","content","spaceClasses","rotation","secondaryContent","click"],["app-numbered-circle","",3,"id","x","y","content","spaceClasses","rotation","secondaryContent","click"]],template:function(n,i){1&n&&(I(),E(0,"svg",0),V(1,"rect",1),z(2,RIe,2,1,"g",2),V(3,"line",3)(4,"line",4)(5,"line",5),E(6,"g",6),q("click",function(){return i.onStoreClick(i.Player.ZERO)}),P(),E(7,"g",7),q("click",function(){return i.onStoreClick(i.Player.ONE)}),P()()),2&n&&(A("viewBox",i.getMancalaViewBox())("transform",i.rotation),m(),A("width",i.getViewBoxWidth())("height",240),m(),v("ngForOf",i.board),m(),A("x2",i.getViewBoxWidth()-120),m(2),A("x1",i.getViewBoxWidth()-120)("x2",i.getViewBoxWidth()-120),m(),v("x",-1)("y",-1)("content",i.getStoreContent(i.Player.ZERO))("spaceClasses",i.getSpaceClasses(-1,-1))("rotation",i.getPieceRotation())("secondaryContent",i.getStoreSecondaryContent(i.Player.ZERO)),m(),v("x",2)("y",2)("content",i.getStoreContent(i.Player.ONE))("spaceClasses",i.getSpaceClasses(2,2))("rotation",i.getPieceRotation())("secondaryContent",i.getStoreSecondaryContent(i.Player.ONE)),A("transform","translate("+(i.getViewBoxWidth()-60)+" 120)"))},dependencies:[Nt,TI],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}return r})(),_s=(()=>class r{static intro(e,n){return W.informational(e,$localize`${e} is a Mancala. Mancala is the name of a family of board games that dates back at least to the third century. Mancalas are games of distribution (sowing) and capture. Their goal is to capture the most seeds. The spaces in Mancalas are called the houses. The ones on the extreme left and right are called the stores, they contain the seeds that each player captured. As you are playing Dark, the 6 houses on the bottom are yours.`,n)}static sowing(e){const n=e.getPieceAtXY(5,1);return L.assert(4===n,"(5, 1) should contain 4 seed"),W.fromMove($localize`Sowing`,$localize`The main move in Mancala games is sowing, let's see how seeds are sown. As you are playing Dark, the 6 houses on the bottom are yours.<br/><br>Click on the rightmost bottom house to sow the seeds it contains: they will be sown clockwise, one seed per house.<br/><br/>Click on the rightmost house!`,e,[w1.of(p1.of(5))],$localize`Look at the 4 houses that follow clockwise the one you picked, they now contain one more seed. This is how seeds are sown: one by one from the house next to the one they come from, clockwise.`,$localize`Failed. Choose the rightmost house on the bottom.`)}static YOU_DID_NOT_CAPTURE_ANY_SEEDS=()=>$localize`Failed. You did not capture anything. Try again.`})();const wI=Ys.get().getDefaultRulesConfig();class LIe extends Wn{gameName=$localize`Awal`;tutorial=[_s.intro(this.gameName,Ys.get().getInitialState(wI)),W.informational($localize`Awal`,$localize`Bonus fact: Awal is the most common of all Mancalas.`,Ys.get().getInitialState(wI)),_s.sowing(Ys.get().getInitialState(wI)),W.anyMove($localize`Big sowing`,$localize`When there are enough seeds to make a full turn, something else happens.<br/><br/> You're playing Dark. Sow the house that contains 12 seeds.`,new $1([[0,0,0,0,0,0],[0,12,0,0,0,0]],0,we.of(0,0)),w1.of(p1.of(1)),$localize`See, the house that you sowed has not been refilled, and the sowing immediately continued to the next house (which therefore contains two seeds).`),W.fromMove($localize`Simple capture`,$localize`After sowing, if the last seed falls in an opponent's house and if there are now two or three seeds in this house, the player captures these two or three seeds.<br/><br/>You're playing Dark, do a capture!`,new $1([[0,1,0,0,1,0],[2,0,0,0,1,0]],0,we.of(0,0)),[w1.of(p1.of(0))],$localize`Well done! This was a simple capture, now let us see how to make multiple captures.`,_s.YOU_DID_NOT_CAPTURE_ANY_SEEDS()),W.fromMove($localize`Multiple captures`,$localize`By sowing from your leftmost house, you will end in the opponent's second leftmost house, which now contains 2 seeds, so this will be a capture. But now, the house right before it contains 3 seeds, which is also capturable, so, that house will get captured as well!<br/><br/>You're playing Dark, do a capture!`,new $1([[2,1,0,0,1,0],[2,0,0,0,1,0]],0,we.of(0,0)),[w1.of(p1.of(0))],$localize`Nice, you win 3 points from the first house, and 2 from the second!`,_s.YOU_DID_NOT_CAPTURE_ANY_SEEDS()),W.fromMove($localize`Interrupted capture`,$localize`By clicking on your leftmost house, you end up on the 3rd house, which is capturable.<br/><br/>You're playing Dark, do a capture!`,new $1([[1,0,1,0,0,1],[3,0,0,0,1,0]],0,we.of(0,0)),[w1.of(p1.of(0))],$localize`Notice that because the second house was not capturable, the capture was interrupted and you have not captured the first house.`,_s.YOU_DID_NOT_CAPTURE_ANY_SEEDS()),W.fromMove($localize`Capture on the other side only`,$localize`You're playing Dark. Try to capture the two leftmost houses of the opponent.`,new $1([[2,2,0,0,1,0],[1,3,0,0,0,0]],0,we.of(0,0)),[w1.of(p1.of(1))],$localize`Congratulations! Notice that the capture was interrupted when entering your territory: you cannot capture your own houses!`,$localize`You have only captured one house, try again!`),W.fromMove($localize`Do not starve`,$localize`You have a very nice capture that seems possible: it seems that you can capture all the opponent's seeds!<br/><br/>You're playing Dark. Try it.`,new $1([[1,1,1,1,1,0],[5,0,0,1,0,0]],0,we.of(0,0)),[w1.of(p1.of(0))],$localize`Sadly, you cannot capture here, otherwise the opponent could not play after you. When this happens, the move can be made, but no capture takes place!`,pe.FAILED_TRY_AGAIN()),W.anyMove($localize`Feeding is mandatory`,$localize`You cannot let another player starve, meaning that if your opponent has no seeds anymore and if you can give them at least one, you have to do it.<br/><br/>You're playing Dark. Give a seed to your opponent!`,new $1([[0,0,0,0,0,0],[0,1,2,4,4,5]],0,we.of(0,0)),w1.of(p1.of(3)),$localize`Congratulations! Note that you can choose to give your opponent the least number of seeds if it is better for you. It is often a good way to have easy captures!`),W.anyMove(pe.END_OF_THE_GAME(),$localize`A game is won as soon as one player has captured 25 seeds, as that player has more than half of all the seeds.<br/><br/>You're playing Dark, sow the leftmost house.`,new $1([[4,4,3,2,1,0],[1,0,0,0,0,0]],0,we.of(23,10)),w1.of(p1.of(0)),$localize`Also, as soon as on player cannot play, the other player captures all the seeds in its own side. Here, it was the first player's turn, and the second player has taken all the remaining seeds.`)]}const sn=Pe.EMPTY,ci=Pe.UNREACHABLE,Xs=Pe.ZERO,ou=Pe.ONE;class zIe extends Wn{tutorial=[W.informational($localize`Initial board and object of the game`,$localize`At Abalone, the goal of the game is to be the first player to push 6 opponent's pieces out of the board. Let us see how!`,js.get().getInitialState()),W.anyMove($localize`Moving a piece`,$localize`At each turn, move one, two, or three pieces either along their line, or on their side.
        For your moves you can therefore choose between up to 6 directions.
        The pieces you move must be aligned and consecutive, and the move should land on an empty space (except to push, we will see that later).
        To make a move, click on one of your pieces, then click on an arrow to choose the move direction.<br/><br/>
        You're playing Dark, make any move!`,js.get().getInitialState(),g2.ofSingleCoord(new _(2,6),Te.UP),pe.CONGRATULATIONS()),W.fromMove($localize`Pushing`,$localize`To push one opponent piece, you must move at least two of your pieces.
        To push two opponent pieces, you must move three of your pieces.
        If one of your pieces is in the way, it will be impossible to push.
        You cannot move more than three pieces.<br/><br/>
        Only one push towards the right is possible here, find it. (You're playing Dark).`,new Zs([[ci,ci,ci,ci,sn,Xs,Xs,ou,ou],[ci,ci,ci,sn,sn,sn,sn,sn,sn],[ci,ci,sn,Xs,Xs,Xs,ou,Xs,sn],[ci,sn,sn,sn,sn,sn,sn,sn,sn],[sn,sn,sn,sn,Xs,Xs,Xs,ou,ou],[sn,sn,sn,sn,sn,sn,sn,sn,ci],[sn,sn,sn,sn,Xs,ou,sn,ci,ci],[sn,sn,sn,Xs,sn,sn,ci,ci,ci],[sn,sn,Xs,sn,sn,ci,ci,ci,ci]],0),[g2.ofSingleCoord(new _(4,4),Te.RIGHT)],$localize`Congratulations! You know everything you need to start a game!`,pe.FAILED_TRY_AGAIN())]}class Fa extends Dn{static singleton=h.empty();static RULES_CONFIG_DESCRIPTION=new fo({name:()=>$localize`Ba-awa`,config:{feedOriginalHouse:new Jn(!0,Dn.FEED_ORIGINAL_HOUSE),mustFeed:new Jn(!1,Dn.MUST_FEED),passByPlayerStore:new Jn(!1,Dn.PASS_BY_PLAYER_STORE),mustContinueDistributionAfterStore:new Jn(!1,Dn.MULTIPLE_SOW),continueLapUntilCaptureOrEmptyHouse:new Jn(!0,Dn.CYCLICAL_LAP),seedsByHouse:new _1(4,Dn.SEEDS_BY_HOUSE,m1.range(1,99)),width:new _1(6,Gi.WIDTH,m1.range(1,99)),splitFinalSeedsEvenly:new Jn(!1,()=>$localize`Split final seeds evenly`)}},[{name:()=>$localize`Even Ba-awa`,config:{feedOriginalHouse:!0,mustFeed:!1,passByPlayerStore:!1,mustContinueDistributionAfterStore:!1,continueLapUntilCaptureOrEmptyHouse:!0,seedsByHouse:4,width:6,splitFinalSeedsEvenly:!0}}]);static get(){return Fa.singleton.isAbsent()&&(Fa.singleton=h.of(new Fa([4]))),Fa.singleton.get()}getRulesConfigDescription(){return h.of(Fa.RULES_CONFIG_DESCRIPTION)}applyCapture(t){const e=rt.copy(t.captureMap),n=t.filledCoords[t.filledCoords.length-1];if(!1===t.endsUpInStore&&4===t.resultingState.getPieceAt(n)){const o=t.resultingState.getCurrentPlayer();t.capturedSum+=4,e[n.y][n.x]+=4,t.resultingState=t.resultingState.capture(o,n)}return{capturedSum:t.capturedSum,captureMap:e,resultingState:t.resultingState}}getDropResult(t,e,n){let i=e.feed(n);const o=i.getPieceAt(n),s=rt.create(e.getWidth(),2,0);if(4===o&&t>1){s[n.y][n.x]=4;const a=O.of(n.y).getOpponent();return i=i.capture(a,n),{capturedSum:4,captureMap:s,resultingState:i}}return{capturedSum:0,captureMap:s,resultingState:i}}mustMonsoon(t,e){const n=super.mustMonsoon(t,e);return n.length>0?n:t.getTotalRemainingSeeds()<=8?e.splitFinalSeedsEvenly?[O.ZERO,O.ONE]:[O.ZERO]:[]}}class DIe extends SI{constructor(){super(Fa.get())}}function VIe(r,t){if(1&r){const e=he();I(),E(0,"g")(1,"g",8),q("click",function(){const o=te(e).index,s=p().index;return ne(p().onClick(o,s))}),P()()}if(2&r){const e=t.$implicit,n=t.index,i=p().index,o=p();m(),ve("id","click_",n,"_",i,""),v("x",n)("y",i)("content",e)("spaceClasses",o.getSpaceClasses(n,i))("rotation",o.getPieceRotation())("secondaryContent",o.getHouseSecondaryContent(n,i)),A("transform",o.getPieceTransform(n,i))}}function HIe(r,t){if(1&r&&(I(),E(0,"g"),z(1,VIe,2,9,"g",2),P()),2&r){const e=t.$implicit;m(),v("ngForOf",e)}}let FIe=(()=>{class r extends OI{constructor(e,n){super(e,n),this.setRulesAndNode("BaAwa"),this.availableAIs=this.createAIs(new DIe),this.encoder=w1.encoder}static \u0275fac=function(n){return new(n||r)(G(Ut),G(Vs))};static \u0275cmp=Ue({type:r,selectors:[["app-ba-awa-component"]],features:[$e],decls:8,vars:21,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["x","0","y","0","ry","115","rx","115","fill","blue",1,"base"],[4,"ngFor","ngForOf"],["x1","120","y1","120","y2","120",1,"base"],["x1","120","y1","0","x2","120","y2","240",1,"base"],["y1","0","y2","240",1,"base"],["id","store_player_0","app-numbered-circle","","transform","translate(60 120)",3,"x","y","content","spaceClasses","rotation","secondaryContent","click"],["id","store_player_1","app-numbered-circle","",3,"x","y","content","spaceClasses","rotation","secondaryContent","click"],["app-numbered-circle","",3,"id","x","y","content","spaceClasses","rotation","secondaryContent","click"]],template:function(n,i){1&n&&(I(),E(0,"svg",0),V(1,"rect",1),z(2,HIe,2,1,"g",2),V(3,"line",3)(4,"line",4)(5,"line",5),E(6,"g",6),q("click",function(){return i.onStoreClick(i.Player.ZERO)}),P(),E(7,"g",7),q("click",function(){return i.onStoreClick(i.Player.ONE)}),P()()),2&n&&(A("viewBox",i.getMancalaViewBox())("transform",i.rotation),m(),A("width",i.getViewBoxWidth())("height",240),m(),v("ngForOf",i.board),m(),A("x2",i.getViewBoxWidth()-120),m(2),A("x1",i.getViewBoxWidth()-120)("x2",i.getViewBoxWidth()-120),m(),v("x",-1)("y",-1)("content",i.getStoreContent(i.Player.ZERO))("spaceClasses",i.getSpaceClasses(-1,-1))("rotation",i.getPieceRotation())("secondaryContent",i.getStoreSecondaryContent(i.Player.ZERO)),m(),v("x",2)("y",2)("content",i.getStoreContent(i.Player.ONE))("spaceClasses",i.getSpaceClasses(2,2))("rotation",i.getPieceRotation())("secondaryContent",i.getStoreSecondaryContent(i.Player.ONE)),A("transform","translate("+(i.getViewBoxWidth()-60)+" 120)"))},dependencies:[Nt,TI],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}return r})();const YQ=Fa.get().getDefaultRulesConfig();class UIe extends Wn{gameName=$localize`Ba-awa`;tutorial=[_s.intro(this.gameName,Fa.get().getInitialState(YQ)),W.informational($localize`Ba-awa`,$localize`Bonus fact: Ba-awa, also called Adi, is played mainly in Ghana.`,Fa.get().getInitialState(YQ)),_s.sowing(new $1([[4,4,4,4,4,4],[4,0,4,4,4,4]],0,we.of(0,0))),W.fromMove($localize`Multiple laps sowing`,$localize`However, the distribution only stops when the last seed is dropped in a house that contains zero or three seeds (before drop).<br/><br/>You're playing Dark, do such a move!`,new $1([[0,2,4,0,0,0],[0,0,0,5,0,0]],0,we.of(0,0)),[w1.of(p1.of(3))],$localize`So, after landing in the house with 2 seeds (then 3), a second lap has been started.`,pe.FAILED_TRY_AGAIN()),W.fromMove($localize`Captures during distribution (1/2)`,$localize`If, during some distribution, you pass by one of your houses that contains 3 seeds, and drop a fourth seed, you capture the house immediately, then continue the distribution!<br/><br/>You're playing Dark, do such a move!`,new $1([[0,8,0,0,0,0],[0,0,3,2,0,0]],0,we.of(0,0)),[w1.of(p1.of(3))],$localize`Congratulations, you captured 4 seeds.`,_s.YOU_DID_NOT_CAPTURE_ANY_SEEDS()),W.fromMove($localize`Captures during distribution (2/2)`,$localize`If, during some distribution, you pass by one house of the opponent that contains 3 seeds, and drop a fourth seed, the opponent captures the house immediately, while you continue to distribute.<br/><br/>You're playing Dark, do such a move!`,new $1([[0,3,0,0,8,0],[3,0,1,0,0,0]],0,we.of(0,0)),[w1.of(p1.of(0))],$localize`There it is, the opponent captured 4 seeds.`,_s.YOU_DID_NOT_CAPTURE_ANY_SEEDS()),W.fromMove($localize`Captures`,$localize`Though, if your very last seed is dropped in a house of the opponent that contains 3 seeds (4 with your seed), you capture it immediately!<br/><br/>You're playing Dark, do such a move!`,new $1([[0,1,1,3,8,0],[2,7,2,0,0,0]],0,we.of(0,0)),[w1.of(p1.of(0))],$localize`Congratulations, you captured 4 seeds.`,_s.YOU_DID_NOT_CAPTURE_ANY_SEEDS()),W.fromMove(pe.END_OF_THE_GAME(),$localize`At the end of a turn, if the number of seeds reaches 8 or less, the first player (Dark) captures the remaining seeds.<br/><br/>You're playing Dark, end the game by capturing!`,new $1([[0,1,1,3,0,0],[1,0,2,0,0,4]],0,we.of(0,0)),[w1.of(p1.of(2))],$localize`There it is, you captured all remaining seeds.`,_s.YOU_DID_NOT_CAPTURE_ANY_SEEDS())]}class G2 extends h2{first;second;static getFallibleEncoder(t){return ke.tuple([_.encoder,_.encoder],e=>[e.first,e.second],e=>t(e[0],e[1]).get())}static getEncoder(t){return ke.tuple([_.encoder,_.encoder],e=>[e.first,e.second],e=>t(e[0],e[1]))}constructor(t,e){super(),this.first=t,this.second=e}getFirst(){return this.first}getSecond(){return this.second}getCoords(){return[this.first,this.second]}}class Do extends G2{constructor(t,e){if(super(t,e),t.equals(e))throw new Error(Ee.MOVE_CANNOT_BE_STATIC())}length(){return this.getStart().getDistance(this.getEnd())}getDirection(){return me.factory.fromMove(this.getStart(),this.getEnd())}getStart(){return this.getFirst()}getEnd(){return this.getSecond()}getMovedOverCoords(){return this.getStart().getAllCoordsToward(this.getEnd())}equals(t){return this===t||!1!==this.getStart().equals(t.getStart())&&this.getEnd().equals(t.getEnd())}toString(){return`${this.getStart().toString()} -> ${this.getEnd().toString()}`}}let wC=(()=>class r{static LANDING_ON_OCCUPIED_SQUARE=()=>$localize`You cannot land on an occupied square.`;static THRONE_IS_LEFT_FOR_GOOD=()=>$localize`Once you left the central throne, you cannot return to it.`;static SOLDIERS_CANNOT_SIT_ON_THRONE=()=>$localize`Soldiers cannot sit on the throne.`;static MOVE_MUST_BE_ORTHOGONAL=()=>$localize`Tafl moves must be orthogonal.`})();class su extends Do{static isValidDirection(t,e){const n=t.getDirectionToward(e);return n.isFailure()||n.get().isDiagonal()?w.failure(wC.MOVE_MUST_BE_ORTHOGONAL()):w.SUCCESS}constructor(t,e){super(t,e);const n=this.getMaximalDistance();L.assert(t.isInRange(n,n),"Starting coord of TaflMove must be on the board, not at "+t.toString()+"."),L.assert(e.isInRange(n,n),"Landing coord of TaflMove must be on the board, not at "+e.toString()+".")}toString(){return"TaflMove("+this.getStart()+"->"+this.getEnd()+")"}}class Cs extends su{static encoder=G2.getFallibleEncoder(Cs.from);static from(t,e){const n=su.isValidDirection(t,e);return n.isFailure()?n.toOtherFallible():X.success(new Cs(t,e))}getMaximalDistance(){return 7}}class b1{value;static NONE=new b1("NONE");static OPPONENT=new b1("OPPONENT");static PLAYER=new b1("PLAYER");constructor(t){this.value=t}}class It{owner;king;static UNOCCUPIED=new It(B.NONE,!1);static PLAYER_ONE_KING=new It(B.ONE,!0);static PLAYER_ONE_PAWN=new It(B.ONE,!1);static PLAYER_ZERO_KING=new It(B.ZERO,!0);static PLAYER_ZERO_PAWN=new It(B.ZERO,!1);constructor(t,e){this.owner=t,this.king=e}isKing(){return this.king}getOwner(){return this.owner}}let s0=class extends Kn{rules;constructor(t){super(),this.rules=t}getListMoves(t,e){const n=t.gameState,i=n.getCurrentPlayer(),o=this.rules.getPlayerListMoves(i,n,e.get());return this.orderMoves(n,o,e.get())}orderMoves(t,e,n){const i=this.rules.getKingCoord(t).get(),o=this.rules.getInvader(n);return t.getCurrentPlayer()===o?yt.sortByDescending(e,s=>-s.getEnd().getOrthogonalDistance(i)):yt.sortByDescending(e,s=>s.getStart().equals(i)?this.rules.isExternalThrone(t,s.getEnd())?2:1:0),e}};s0=function(r,t,e,n){var s,i=arguments.length,o=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,e):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,t,e,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(t,e,o):s(t,e))||o);return i>3&&o&&Object.defineProperty(t,e,o),o}([Ae.log],s0);class bC{directThreats;mover;constructor(t,e){this.directThreats=t,this.mover=e}equals(t){return t.directThreats.equals(this.directThreats)&&t.mover.equals(this.mover)}}class KQ extends bC{directThreat;constructor(t,e){super(new st([t]),e),this.directThreat=t}}class BIe extends st{valueMap;constructor(t){if(super(),this.valueMap=[],this.values=[],void 0!==t)for(const e of t)this.add(e)}add(t){const e=this.toFields(t);let n=this.valueMap;for(const o of e[0])void 0===n[o]&&(n[o]=[]),n=n[o];const i=e[1];return void 0===n[i]&&(n[i]=!0,this.values.push(t),!0)}contains(t){const e=this.toFields(t);let n=this.valueMap;for(const o of e[0]){if(void 0===n[o])return!1;n=n[o]}return void 0!==n[e[1]]}[Symbol.iterator](){return this.values.values()}}class ir extends BIe{toFields(t){return[[t.y],t.x]}}class XQ extends rr{rules;constructor(t){super(),this.rules=t}getMetrics(t,e){const n=t.gameState,i=e.get(),o=this.rules.getPlayerListPawns(O.ZERO,n).length,s=this.rules.getPlayerListPawns(O.ONE,n).length,a=this.rules.getInvader(i),c=[1,2][a.getValue()],l=[2,1][a.getValue()];return G1.ofSingle(o*c,s*l)}}class QQ extends XQ{getBoardValue(t,e){const n=this.rules.getGameStatus(t,e);if(n.isEndGame)return n.toBoardValue();const i=t.gameState,o=It.UNOCCUPIED,s=this.getPiecesMap(i),a=this.getThreatMap(t,s),c=this.filterThreatMap(a,i);let l=0,u=0,f=0;for(const g of O.PLAYERS)for(const y of s.get(g).get())if(c.get(y).isPresent())l+=g.getScoreModifier();else{u+=g.getScoreModifier();let S=0;for(const N of Ie.ORTHOGONALS){let R=y.getNext(N,1);for(;i.isOnBoard(R)&&i.getPieceAt(R)===o;)S++,R=R.getNext(N,1)}f+=S*g.getScoreModifier()}return mn.multiMetric([u,l,f])}getPiecesMap(t){const e=It.UNOCCUPIED,n=[],i=[];for(let s=0;s<t.getHeight();s++)for(let a=0;a<t.getWidth();a++){const c=new _(a,s);t.getPieceAt(c)!==e&&(t.getAbsoluteOwner(c)===O.ZERO?n.push(c):i.push(c))}return new gn([{key:O.ZERO,value:new ir(n)},{key:O.ONE,value:new ir(i)}])}getThreatMap(t,e){const n=new gn;for(const i of O.PLAYERS)for(const o of e.get(i).get()){const s=this.getThreats(o,t.gameState);this.isThreatReal(o,t.gameState,s)&&n.set(o,new st(s))}return n}getThreats(t,e){const n=e.getAbsoluteOwner(t);L.assert(n.isPlayer(),"TaflPieceAndInfluenceMinimax.getThreats should be called with an occupied coordinate");const i=n.getOpponent(),o=[];for(const s of Ie.ORTHOGONALS){const a=t.getPrevious(s,1);if(this.isAThreat(a,e,i)){const c=[];for(const l of Ie.ORTHOGONALS){if(l===s.getOpposite())continue;let u=t.getNext(s,1);for(;e.isOnBoard(u)&&e.getPieceAt(u)===It.UNOCCUPIED;)u=u.getNext(l);e.isOnBoard(u)&&e.getAbsoluteOwner(u)===i&&!1===t.getNext(s,1).equals(u)&&c.push(u)}o.push(new KQ(a,new ir(c)))}}return o}isAThreat(t,e,n){return!1!==e.isOnBoard(t)&&(e.getAbsoluteOwner(t)===n||!!this.rules.isThrone(e,t)&&(n===O.ONE||e.getPieceAt(t)===It.UNOCCUPIED))}isThreatReal(t,e,n){if(0===n.length)return!1;if(e.getPieceAt(t).isKing())return 3===n.length;for(const i of n)if(i.mover.size()>0)return!0;return!1}filterThreatMap(t,e){const n=new gn,i=t.listKeys(),o=i.filter(a=>e.getAbsoluteOwner(a)===e.getCurrentPlayer()),s=new ir(i.filter(a=>e.getAbsoluteOwner(a)===e.getCurrentOpponent()));for(const a of o){const c=t.get(a).get(),l=[];for(const u of c)if(!1===s.contains(u.directThreat)){const f=[];for(const g of u.mover)!1===s.contains(g)&&f.push(g);f.length>0&&l.push(new KQ(u.directThreat,new ir(f)))}l.length>0&&n.set(a,new st(l))}for(const a of s){const c=t.get(a).get();n.set(a,c)}return n}}class $Ie extends fn{constructor(t){super($localize`Pieces > Influence`,t,new QQ(t),new s0(t))}}class WIe extends fn{constructor(t){super($localize`Pieces`,t,new XQ(t),new s0(t))}}class JQ extends QQ{getBoardValue(t,e){const n=this.getControlScoreAndPieceScores(t,e);return mn.multiMetric([n.safeScore,n.threatenedScore,n.controlScore])}getControlScoreAndPieceScores(t,e){const n=t.gameState,i=this.getPiecesMap(n),o=this.getThreatMap(t,i),s=this.filterThreatMap(o,n),a={safeScore:0,threatenedScore:0,controlScore:0};for(const c of O.PLAYERS){const l=new ir;for(const u of i.get(c).get())if(s.get(u).isPresent())a.threatenedScore+=c.getScoreModifier();else{a.safeScore+=c.getScoreModifier();for(const f of Ie.ORTHOGONALS){let g=u.getNext(f,1);for(;n.isOnBoard(g)&&n.getPieceAt(g)===It.UNOCCUPIED;)l.add(g),g=g.getNext(f,1)}}for(const u of l){const f=this.getControlledPieceValue(u,n);a.controlScore+=c.getScoreModifier()*f}}return a}getControlledPieceValue(t,e){let n=1;return e.isHorizontalEdge(t)&&(n*=e.getWidth()),e.isVerticalEdge(t)&&(n*=e.getWidth()),n}}class qIe extends fn{constructor(t){super($localize`Pieces > Control`,t,new JQ(t),new s0(t))}}class jIe extends JQ{getBoardValue(t,e){const n=this.getControlScoreAndPieceScores(t,e),i=this.getStepForEscapeMetric(t.gameState);return mn.multiMetric([i,n.safeScore,n.threatenedScore,n.controlScore])}getStepForEscapeMetric(t){const e=t.getPieceAt(this.rules.getKingCoord(t).get()).getOwner(),n=this.getStepForEscape(t)*e.getScoreModifier();return-1===n?e.getOpponent().getPreVictory():-1*n}getStepForEscape(t){const e=this.rules.getKingCoord(t).get();return this._getStepForEscape(t,1,[e],[]).getOrElse(-1)}_getStepForEscape(t,e,n,i){const o=this.getNextGen(t,n,i);return 0===o.length?h.empty():o.some(s=>this.rules.isExternalThrone(t,s))?h.of(e):(e++,i.push(...o),this._getStepForEscape(t,e,o,i))}getNextGen(t,e,n){const i=[];for(const o of e)for(const s of Ie.ORTHOGONALS){let a=o.getNext(s,1);for(;t.isOnBoard(a)&&t.getPieceAt(a)===It.UNOCCUPIED;)n.every(c=>!1===c.equals(a))&&i.push(a),a=a.getNext(s,1)}return i}}class ZIe extends fn{constructor(t){super($localize`Escape > Pieces > Control`,t,new jIe(t),new s0(t))}}class bI extends p2{generateMove;viewInfo={pieceClasses:[]};EMPTY=It.UNOCCUPIED;capturedCoords=[];passedByCoords=[];chosen=h.empty();constructor(t,e){super(t),this.generateMove=e}updateBoard(t){var e=this;return M(function*(){e.board=e.getState().getCopiedBoard(),e.updateViewInfo()})()}showLastMove(t){var e=this;return M(function*(){const n=e.getPreviousState(),i=e.getState().getCurrentOpponent();for(const o of Ie.ORTHOGONALS){const s=t.getEnd().getNext(o,1);if(n.isOnBoard(s)){const c=n.getRelativeOwner(i,s)===b1.OPPONENT,u=e.getState().getPieceAt(s)===It.UNOCCUPIED;c&&u&&e.capturedCoords.push(s)}}e.passedByCoords=t.getMovedOverCoords()})()}hideLastMove(){this.capturedCoords=[],this.passedByCoords=[]}updateViewInfo(){const t=[];this.board=this.getState().getCopiedBoard();for(let e=0;e<this.getHeight();e++){const n=[];for(let i=0;i<this.getWidth();i++){let o=[];o=this.board[e][i].getOwner()===B.NONE?[""]:this.getPieceClasses(i,e),n.push(o)}t.push(n)}this.viewInfo={pieceClasses:t}}onClick(t,e){var n=this;return M(function*(){const i=yield n.canUserPlay("#click_"+t+"_"+e);if(i.isFailure())return n.cancelMove(i.getReason());const o=new _(t,e);return n.chosen.equalsValue(o)?(n.cancelMoveAttempt(),w.SUCCESS):n.chosen.isAbsent()||n.pieceBelongsToCurrentPlayer(o)?n.choosePiece(o):n.chooseDestination(t,e)})()}chooseDestination(t,e){var n=this;return M(function*(){const i=n.chosen.get(),o=new _(t,e),s=n.generateMove(i,o);return s.isSuccess()?yield n.chooseMove(s.get()):n.cancelMove(s.getReason())})()}choosePiece(t){var e=this;return M(function*(){return e.board[t.y][t.x]===It.UNOCCUPIED?e.cancelMove(Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):!1===e.pieceBelongsToCurrentPlayer(t)?e.cancelMove(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT()):(e.chosen=h.of(t),e.updateViewInfo(),w.SUCCESS)})()}pieceBelongsToCurrentPlayer(t){const e=this.getState(),n=e.getCurrentPlayer();return e.getRelativeOwner(n,t)===b1.PLAYER}cancelMoveAttempt(){this.chosen=h.empty(),this.updateViewInfo()}isThrone(t,e){const n=this.getState();return this.rules.isThrone(n,new _(t,e))}isCentralThrone(t,e){return this.getState().isCentralThrone(new _(t,e))}getPieceClasses(t,e){const n=[],i=new _(t,e),o=this.getState().getAbsoluteOwner(i);return n.push(this.getPlayerClass(o)),this.chosen.equalsValue(i)&&n.push("selected-stroke"),n}getRectClasses(t,e){const n=[],i=new _(t,e);return this.capturedCoords.some(o=>o.equals(i))?n.push("captured-fill"):this.passedByCoords.some(o=>o.equals(i))&&n.push("moved-fill"),n}getClickables(){const t=[];for(let e=0;e<this.getHeight();e++)for(let n=0;n<this.board[e].length;n++){const i=new _(n,e);this.isClickable(i)&&t.push(i)}return t}isClickable(t){return this.interactive&&this.pieceBelongsToCurrentPlayer(t)}isInvader(t,e){return this.board[e][t]===It.PLAYER_ZERO_PAWN}isKing(t,e){return this.board[e][t].isKing()}createAIs(){const t=new s0(this.rules);return[new WIe(this.rules),new $Ie(this.rules),new qIe(this.rules),new ZIe(this.rules),new zn($localize`MCTS`,t,this.rules)]}}function YIe(r,t){1&r&&(I(),V(0,"polygon",8))}function KIe(r,t){1&r&&(I(),V(0,"rect",9))}function XIe(r,t){if(1&r&&(I(),E(0,"g"),z(1,YIe,1,0,"polygon",6)(2,KIe,1,0,"ng-template",null,7,In),P()),2&r){const e=wn(3),n=p().index,i=p().index,o=p();m(),v("ngIf",o.isCentralThrone(n,i))("ngIfElse",e)}}function QIe(r,t){if(1&r&&(I(),E(0,"g"),V(1,"line",13)(2,"line",13)(3,"line",13)(4,"line",13)(5,"line",13),P()),2&r){const e=p(2).index,n=p().index,i=p();m(),v("ngClass",i.viewInfo.pieceClasses[n][e]),A("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),m(),v("ngClass",i.viewInfo.pieceClasses[n][e]),A("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.1*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),m(),v("ngClass",i.viewInfo.pieceClasses[n][e]),A("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.9*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),m(),v("ngClass",i.viewInfo.pieceClasses[n][e]),A("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.15*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE),m(),v("ngClass",i.viewInfo.pieceClasses[n][e]),A("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.85*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE)}}function JIe(r,t){if(1&r&&(I(),V(0,"polyline",16)),2&r){const e=p(3).index,n=p().index;v("ngClass",p().viewInfo.pieceClasses[n][e])}}function eke(r,t){if(1&r&&(I(),V(0,"line",13)(1,"line",13)(2,"line",13)(3,"line",13)),2&r){const e=p(3).index,n=p().index,i=p();v("ngClass",i.viewInfo.pieceClasses[n][e]),A("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),m(),v("ngClass",i.viewInfo.pieceClasses[n][e]),A("x1",.04*i.SPACE_SIZE)("y1",.5*i.SPACE_SIZE)("x2",.96*i.SPACE_SIZE)("y2",.5*i.SPACE_SIZE),m(),v("ngClass",i.viewInfo.pieceClasses[n][e]),A("x1",.2*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.8*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE),m(),v("ngClass",i.viewInfo.pieceClasses[n][e]),A("x1",.8*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.2*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE)}}function tke(r,t){if(1&r&&(I(),z(0,JIe,1,1,"polyline",14)(1,eke,4,20,"ng-template",null,15,In)),2&r){const e=wn(2),n=p(2).index,i=p().index;v("ngIf",p().isKing(n,i))("ngIfElse",e)}}function nke(r,t){if(1&r&&(I(),E(0,"g"),V(1,"circle",10),z(2,QIe,6,25,"g",11)(3,tke,3,2,"ng-template",null,12,In),P()),2&r){const e=wn(4),n=p().index,i=p().index,o=p();m(),ve("id","piece_",n,"_",i,""),v("ngClass",o.viewInfo.pieceClasses[i][n]),A("r",o.SPACE_SIZE/2-o.STROKE_WIDTH)("cx",.5*o.SPACE_SIZE)("cy",.5*o.SPACE_SIZE),m(),v("ngIf",o.isInvader(n,i))("ngIfElse",e)}}function rke(r,t){if(1&r){const e=he();I(),E(0,"g",3),q("click",function(){const o=te(e).index,s=p().index;return ne(p().onClick(o,s))}),V(1,"rect",4),z(2,XIe,4,2,"g",5)(3,nke,5,8,"g",5),P()}if(2&r){const e=t.index,n=p().index,i=p();ve("id","click_",e,"_",n,""),A("transform","translate("+i.SPACE_SIZE*e+", "+i.SPACE_SIZE*n+")"),m(),ve("id","space_",e,"_",n,""),v("ngClass",i.getRectClasses(e,n)),A("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),m(),v("ngIf",i.board[n][e]===i.EMPTY&&i.isThrone(e,n)),m(),v("ngIf",i.board[n][e]!==i.EMPTY)}}function ike(r,t){if(1&r&&(I(),E(0,"g"),z(1,rke,4,10,"g",2),P()),2&r){const e=t.$implicit;m(),v("ngForOf",e)}}function oke(r,t){if(1&r){const e=he();I(),E(0,"g")(1,"rect",17),q("click",function(){const o=te(e).$implicit;return ne(p().onClick(o.x,o.y))}),P()()}if(2&r){const e=t.$implicit,n=p();m(),ve("id","click_",e.x,"_",e.y,""),A("x",n.SPACE_SIZE*e.x)("y",n.SPACE_SIZE*e.y)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}let ske=(()=>{class r extends bI{constructor(e){super(e,Cs.from),this.setRulesAndNode("Brandhub"),this.availableAIs=this.createAIs(),this.encoder=Cs.encoder}static \u0275fac=function(n){return new(n||r)(G(Ut))};static \u0275cmp=Ue({type:r,selectors:[["app-brandhub"]],features:[$e],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["x","0","y","0",1,"base",3,"id","ngClass"],[4,"ngIf"],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60","class","base",4,"ngIf","ngIfElse"],["cornerThrone",""],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60",1,"base"],["x","15","y","15","width","70","height","70",1,"base"],[1,"base",3,"id","ngClass"],[4,"ngIf","ngIfElse"],["defender",""],[1,"base",3,"ngClass"],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85","class","base no-fill",3,"ngClass",4,"ngIf","ngIfElse"],["soldierDefender",""],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85",1,"base","no-fill",3,"ngClass"],[1,"no-fill","mid-stroke","clickable-stroke",3,"id","click"]],template:function(n,i){1&n&&(I(),E(0,"svg",0),z(1,ike,2,1,"g",1)(2,oke,2,6,"g",1),P()),2&n&&(A("viewBox",i.getViewBox().toSVGString()),m(),v("ngForOf",i.board),m(),v("ngForOf",i.getClickables()))},dependencies:[zt,Nt,bt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}return r})();class m2 extends B1{isCentralThrone(t){return t.equals(this.getCentralThrone())}getCentralThrone(){const t=(this.getSize()-1)/2;return new _(t,t)}getRelativeOwner(t,e){const n=this.getAbsoluteOwner(e);let i;return i=n===B.NONE?b1.NONE:t===n?b1.PLAYER:b1.OPPONENT,i}getAbsoluteOwner(t){return this.getPieceAt(t).getOwner()}getSize(){return this.getHeight()}}let Bi=(()=>class r extends Da{generateMove;static CASTLE_IS_LEFT_FOR_GOOD=()=>$localize`Central throne is left for good`;static EDGE_ARE_KING_S_ENNEMY=()=>$localize`Edges are king's ennemy`;static CENTRAL_THRONE_CAN_SURROUND_KING=()=>$localize`Central throne can surround king`;static KING_FAR_FROM_HOME_CAN_BE_SANDWICHED=()=>$localize`King far from home can be sandwiched`;static INVADER_STARTS=()=>$localize`Invader starts`;constructor(e){super(),this.generateMove=e}isLegal(e,n,i){const o=i.get(),s=n.getCurrentPlayer(),a=this.getMoveValidity(s,e,n,o);return a.isFailure()?w.failure(a.getReason()):w.SUCCESS}getMoveValidity(e,n,i,o){const s=i.getRelativeOwner(e,n.getStart());if(s===b1.NONE)return w.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(s===b1.OPPONENT)return w.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT());if(i.getRelativeOwner(e,n.getEnd())!==b1.NONE)return w.failure(wC.LANDING_ON_OCCUPIED_SQUARE());if(this.isThrone(i,n.getEnd())){if(!i.getPieceAt(n.getStart()).isKing())return w.failure(wC.SOLDIERS_CANNOT_SIT_ON_THRONE());if(i.isCentralThrone(n.getEnd())&&o.castleIsLeftForGood)return w.failure(wC.THRONE_IS_LEFT_FOR_GOOD())}const c=n.getStart().getDirectionToward(n.getEnd()).get(),l=n.getStart().getOrthogonalDistance(n.getEnd());let u=n.getStart().getNext(c);for(let f=1;f<l;f++){if(i.getPieceAt(u)!==It.UNOCCUPIED)return w.failure(Ee.SOMETHING_IN_THE_WAY());u=u.getNext(c)}return w.SUCCESS}isThrone(e,n){return!!this.isExternalThrone(e,n)||e.isCentralThrone(n)}isExternalThrone(e,n){return e.isCorner(n)}tryCapture(e,n,i,o,s){const a=n.getNext(i);return!1===o.isOnBoard(a)||o.getRelativeOwner(e,a)!==b1.OPPONENT?h.empty():o.getPieceAt(a).isKing()?this.captureKing(e,n,i,o,s):this.capturePawn(e,n,i,o)}captureKing(e,n,i,o,s){const a=n.getNext(i),{backCoord:c,back:l,backInRange:u,left:f,leftCoord:g,right:y,rightCoord:S}=this.getSurroundings(a,i,e,o);return!1===u?this.captureKingAgainstTheWall(f,y,a,s):l===b1.NONE&&this.isThrone(o,c)?this.captureKingAgainstThrone(o,c,a,f,y,s):l===b1.PLAYER?this.captureKingWithAtLeastASandwich(o,a,f,g,y,S,s):h.empty()}getSurroundings(e,n,i,o){const s=e.getNext(n),a=o.isOnBoard(s),c=a?o.getRelativeOwner(i,s):b1.NONE,l=e.getLeft(n),f=o.isOnBoard(l)?o.getRelativeOwner(i,l):b1.NONE,g=e.getRight(n);return{backCoord:s,back:c,backInRange:a,leftCoord:l,left:f,rightCoord:g,right:o.isOnBoard(g)?o.getRelativeOwner(i,g):b1.NONE}}captureKingAgainstTheWall(e,n,i,o){let s=e===b1.PLAYER?1:0;return s+=n===b1.PLAYER?1:0,2===s&&o.edgesAreKingsEnnemy?h.of(i):h.empty()}captureKingAgainstThrone(e,n,i,o,s,a){if(this.isExternalThrone(e,n)){if(a.kingFarFromHomeCanBeSandwiched)return h.of(i)}else if(a.centralThroneCanSurroundKing&&(o===b1.PLAYER||s===b1.PLAYER))return h.of(i);return h.empty()}capturePawn(e,n,i,o){const s=n.getNext(i),a=s.getNext(i);let c=b1.NONE;return o.isOnBoard(a)&&(c=o.getRelativeOwner(e,a)),c===b1.NONE?!1===this.isThrone(o,a)?(Ae.display("TaflRules","capturePawn","cannot capture a pawn without an ally; "+s+"threatened by "+e+"'s pawn in "+n+" coming from this direction ("+i.x+", "+i.y+")cannot capture a pawn without an ally behind"),h.empty()):(Ae.display("TaflRules","capturePawn","pawn captured by 1 opponent and 1 throne; "+s+"threatened by "+e+"'s pawn in "+n+" coming from this direction ("+i.x+", "+i.y+")"),h.of(s)):c===b1.PLAYER?(Ae.display("TaflRules","capturePawn","pawn captured by 2 opponents; "+s+"threatened by "+e+"'s pawn in "+n+" coming from this direction ("+i.x+", "+i.y+")"),h.of(s)):(Ae.display("TaflRules","capturePawn","no captures; "+s+"threatened by "+e+"'s pawn in "+n+" coming from this direction ("+i.x+", "+i.y+")"),h.empty())}captureKingWithAtLeastASandwich(e,n,i,o,s,a,c){if(!1===this.kingTouchCentralThrone(e,n)&&c.kingFarFromHomeCanBeSandwiched)return h.of(n);const l=c.centralThroneCanSurroundKing,u=this.isThrone(e,o),f=i===b1.PLAYER||u&&l,g=this.isThrone(e,a);return f&&(s===b1.PLAYER||g&&l)?h.of(n):h.empty()}kingTouchCentralThrone(e,n){const i=e.getCentralThrone();return n.getOrthogonalDistance(i)<=1}applyLegalMove(e,n,i,o){const s=n.turn,a=n.getCopiedBoard(),c=n.getCurrentPlayer(),l=e.getStart(),u=e.getEnd();a[u.y][u.x]=a[l.y][l.x],a[l.y][l.x]=It.UNOCCUPIED;for(const f of Ie.ORTHOGONALS){const g=this.tryCapture(c,e.getEnd(),f,n,i.get());g.isPresent()&&(a[g.get().y][g.get().x]=It.UNOCCUPIED)}return new m2(a,s+1)}getGameStatus(e,n){const i=e.gameState,o=n.get(),s=this.getWinner(i,o);return s.isPresent()?ye.getVictory(s.get()):ye.ONGOING}getWinner(e,n){const i=this.getKingCoord(e);if(i.isAbsent())return Ae.display("TaflRules","getWinner","The king is dead, victory to invader"),h.of(this.getInvader(n));const o=i.get();return this.isExternalThrone(e,o)?(Ae.display("TaflRules","getWinner","The king escape, victory to defender"),h.of(this.getDefender(n))):this.isPlayerImmobilized(O.ZERO,e,n)?(Ae.display("TaflRules","getWinner","Zero has no move, victory to one"),h.of(O.ONE)):this.isPlayerImmobilized(O.ONE,e,n)?(Ae.display("TaflRules","getWinner","One has no move, victory to zero"),h.of(O.ZERO)):(Ae.display("TaflRules","getWinner","no victory"),h.empty())}getKingCoord(e){const n=e.getSize();for(let i=0;i<n;i++)for(let o=0;o<n;o++)if(e.getPieceAtXY(o,i).isKing())return h.of(new _(o,i));return h.empty()}getInvader(e){return e.invaderStarts?O.ZERO:O.ONE}getDefender(e){return this.getInvader(e).getOpponent()}isPlayerImmobilized(e,n,i){return 0===this.getPlayerListMoves(e,n,i).length}getPlayerListMoves(e,n,i){const o=[],s=this.getPlayerListPawns(e,n);for(const a of s){const c=this.getPossibleDestinations(a,n,i);for(const l of c){const u=this.generateMove(a,l).get();o.push(u)}}return o}getPlayerListPawns(e,n){const i=n.getSize(),o=[];for(let s=0;s<i;s++)for(let a=0;a<i;a++){const c=new _(a,s);n.getAbsoluteOwner(c)===e&&o.push(c)}return o}getPossibleDestinations(e,n,i){const o=[];let s;for(const a of Ie.ORTHOGONALS){s=e.getNext(a,1);let c=!1;for(;n.isOnBoard(s)&&!1===c;)n.getAbsoluteOwner(s)===B.NONE?this.isExternalThrone(n,s)?n.getPieceAt(e).isKing()&&o.push(s):n.isCentralThrone(s)?n.getPieceAt(e).isKing()&&!1===i.castleIsLeftForGood&&o.push(s):o.push(s):c=!0,s=s.getNext(a,1)}return o}})();class Uc extends Bi{static singleton=h.empty();static RULES_CONFIG_DESCRIPTION=new fo({name:()=>$localize`Brandhub`,config:{castleIsLeftForGood:new Jn(!0,Bi.CASTLE_IS_LEFT_FOR_GOOD),edgesAreKingsEnnemy:new Jn(!1,Bi.EDGE_ARE_KING_S_ENNEMY),centralThroneCanSurroundKing:new Jn(!0,Bi.CENTRAL_THRONE_CAN_SURROUND_KING),kingFarFromHomeCanBeSandwiched:new Jn(!0,Bi.KING_FAR_FROM_HOME_CAN_BE_SANDWICHED),invaderStarts:new Jn(!0,Bi.INVADER_STARTS)}});static get(){return Uc.singleton.isAbsent()&&(Uc.singleton=h.of(new Uc)),Uc.singleton.get()}constructor(){super(Cs.from)}getInitialState(t){const e=It.UNOCCUPIED;let n=It.PLAYER_ZERO_PAWN,i=It.PLAYER_ONE_PAWN,o=It.PLAYER_ONE_KING;return!1===t.get().invaderStarts&&(n=It.PLAYER_ONE_PAWN,i=It.PLAYER_ZERO_PAWN,o=It.PLAYER_ZERO_KING),new m2([[e,e,e,n,e,e,e],[e,e,e,n,e,e,e],[e,e,e,i,e,e,e],[n,n,i,o,i,n,n],[e,e,e,i,e,e,e],[e,e,e,n,e,e,e],[e,e,e,n,e,e,e]],0)}getRulesConfigDescription(){return h.of(Uc.RULES_CONFIG_DESCRIPTION)}}const j=It.UNOCCUPIED,C1=It.PLAYER_ZERO_PAWN,Vo=It.PLAYER_ONE_PAWN,Md=It.PLAYER_ONE_KING,eJ=Uc.get().getDefaultRulesConfig();class ake extends Wn{tutorial=[W.informational($localize`Goal of the game`,$localize`Brandhub is the Irish version of the Tafl, Tafl being a family of viking strategy game. The goal of the game is different for each player. The attacker plays first. Their pieces (dark) are close to the edges. Their goal is to capture the king, which is in the center of the board. The defender plays second. Their pieces (light) are in the middle. Their goal is to move the king on one of the 4 thrones in the corners. Note that the square in which the king starts, in the center of the board, is also a throne.`,Uc.get().getInitialState(eJ)),W.anyMove($localize`Moving`,$localize`All pieces move the same way. Similarly to a rook in chess, a piece can move: <ol><li>By as many squares as you want.</li><li>Without going over another piece or stopping on another piece.</li><li>Horizontally or vertically.</li><li>Only the king can land on a corner throne.</li><li>Once the king left his central throne, no piece can land on it, but all can pass over it.</li></ol>To move a piece, click on it and then on its landing square.<br/><br/>You're playing Dark, do the first move.`,Uc.get().getInitialState(eJ),Cs.from(new _(3,1),new _(1,1)).get(),pe.CONGRATULATIONS()),W.fromMove($localize`Capturing a soldier (1/2)`,$localize`All pieces, attackers and defenders, except the king, are soldiers. To capture them, they have to be sandwiched between two of your pieces. By getting too close, an attacker's soldier is in danger.<br/><br/>You're playing Light. Capture the soldier.`,new m2([[j,j,j,C1,j,j,j],[j,j,j,C1,j,j,j],[C1,j,j,Vo,j,j,j],[j,j,Vo,Md,Vo,C1,C1],[j,j,C1,j,j,j,j],[j,j,j,Vo,j,C1,j],[j,j,j,C1,j,j,j]],1),[Cs.from(new _(3,5),new _(2,5)).get()],$localize`Congratulations, that will teach him a lesson!`,$localize`Failed, you missed an opportunity to capture a piece of the opponent.`),W.fromMove($localize`Capturing a soldier (2/2)`,$localize`A second way to capture a soldier is to sandwich it against an empty throne. The king has moved and endangered one of its soldiers.<br/><br/>You're playing Dark. Capture the soldier.`,new m2([[j,j,j,C1,j,j,j],[j,j,C1,j,j,j,j],[j,j,j,Vo,j,j,j],[C1,Vo,j,j,Vo,C1,C1],[j,Vo,j,j,j,j,j],[j,C1,j,Md,j,C1,j],[j,j,j,C1,j,j,j]],12),[Cs.from(new _(2,1),new _(3,1)).get(),Cs.from(new _(3,0),new _(3,1)).get()],$localize`Congratulations, one less defender. But keep an eye on the king, it is the most important.`,$localize`Failed, you did not do the expected move.`),W.fromMove($localize`Capturing the king on his throne`,$localize`To capture the king when he sits on his throne, the four squares neighbor to the king (horizontally and vertically) must be occupied by your soldiers.<br/><br/>You're playing Dark. Capture the king.`,new m2([[j,j,j,j,j,j,j],[j,j,j,Vo,j,j,j],[j,j,j,C1,j,j,j],[j,C1,j,Md,C1,j,j],[j,j,j,C1,j,j,j],[j,Vo,j,j,j,j,j],[j,j,j,j,j,j,j]],72),[Cs.from(new _(1,3),new _(2,3)).get()],pe.CONGRATULATIONS_YOU_WON(),$localize`Failed, you let the king run away.`),W.fromMove($localize`Capturing the king next to his throne`,$localize`Another way to capture the king is to use three soldier plus the central throne to surround the king on four sides.<br/><br/>You're playing Dark. Capture the king.`,new m2([[j,j,C1,j,j,j,j],[j,j,j,C1,j,j,j],[j,j,j,Md,C1,j,j],[j,C1,Vo,j,Vo,j,j],[j,j,j,C1,j,j,j],[j,j,j,j,j,j,j],[j,j,j,j,j,j,j]],72),[Cs.from(new _(2,0),new _(2,2)).get()],$localize`The king is dead, long live the king. Congratulations, you won.`,pe.FAILED_TRY_AGAIN()),W.fromMove($localize`Capturing the king far from his throne`,$localize`When the king is not on his central throne nor next to it, he can be captured like a soldier.<br/><br/>You're playing Dark. Capture the king.`,new m2([[j,j,j,j,j,j,j],[j,j,j,j,j,j,j],[j,C1,j,C1,j,j,j],[C1,j,j,j,Vo,j,j],[j,j,j,Vo,j,j,j],[j,j,j,j,j,j,j],[j,Md,j,C1,j,j,j]],72),[Cs.from(new _(3,6),new _(2,6)).get()],$localize`The king is dead, long live the king. Congratulations, you won.`,pe.FAILED_TRY_AGAIN())]}class Ed extends B1{}class Gc extends Nr{static of(t){return new Gc(t.x,t.y)}static encoder=Nr.getEncoder(Gc.of);constructor(t,e){super(t,e)}toString(){return"ConnectSixFirstMove("+this.coord.x+", "+this.coord.y+")"}}class e4 extends G2{static encoder=G2.getEncoder(e4.of);static of(t,e){return L.assert(!1===t.equals(e),"COORDS_SHOULD_BE_DIFFERENT"),new e4(t,e)}toString(){return"ConnectSixDrops("+this.getFirst().toString()+", "+this.getSecond().toString()+")"}equals(t){const e=this.getFirst(),n=t.getFirst(),i=this.getSecond(),o=t.getSecond();return!(!e.equals(n)||!i.equals(o))||!(!e.equals(o)||!i.equals(n))}}var AI;!function(r){r.isFirstMove=function t(n){return n instanceof Gc},r.isDrop=function e(n){return n instanceof e4},r.encoder=ke.disjunction([r.isFirstMove,r.isDrop],[Gc.encoder,e4.encoder])}(AI||(AI={}));class a0{getOwner;N;constructor(t,e){this.getOwner=t,this.N=e}getBoardValue(t){let e=0;for(const n of t.getCoordsAndContents()){const o=n.coord;if(this.getOwner(n.content,t).isPlayer()){const s=this.getSquareScore(t,o);if(mn.VICTORIES.some(a=>a===s))return mn.of(s);e+=s}}return mn.of(e)}getSquareScore(t,e){const n=t.getPieceAt(e),i=this.getOwner(n,t);L.assert(i.isPlayer(),"getSquareScore should not be called with PlayerOrNone.NONE piece");const o=new gn,s=new gn;for(const c of me.DIRECTIONS){const l=this.getNumberOfFreeSpacesAndAllies(t,e,c,i);o.set(c,l[0]),s.set(c,l[1])}return this.getScoreFromDirectionAlliesAndFreeSpaces(s,o)*i.getScoreModifier()}getScoreFromDirectionAlliesAndFreeSpaces(t,e){let n=0;for(const i of[me.UP,me.UP_RIGHT,me.RIGHT,me.DOWN_RIGHT]){const o=t.get(i).get(),s=t.get(i.getOpposite()).get();if(this.N<=o+s+1)return Number.MAX_SAFE_INTEGER;const u=e.get(i).get()+e.get(i.getOpposite()).get();this.N<=u+1&&(n+=2+u-this.N)}return n}getNumberOfFreeSpacesAndAllies(t,e,n,i){let o=0,s=0,a=!0,c=new _(e.x+n.x,e.y+n.y),l=1;const u=i.getOpponent();for(;t.isOnBoard(c)&&l<this.N;){const f=t.getPieceAt(c);if(this.getOwner(f,t)===u)return[o,s];this.getOwner(f,t)===i&&a?s++:a=!1,f!==u&&f!==i&&o++,c=c.getNext(n),l++}return[o,s]}getVictoriousCoord(t){const e=[];for(const n of t.getCoordsAndContents())if(this.getOwner(n.content,t).isPlayer()){const i=n.coord,o=this.getSquareScore(t,i);mn.isVictory(o)&&(o===O.ZERO.getVictoryValue()||o===O.ONE.getVictoryValue())&&e.push(i)}return e}}class ho extends Da{static singleton=h.empty();static RULES_CONFIG_DESCRIPTION=OIe.GOBAN;static get(){return ho.singleton.isAbsent()&&(ho.singleton=h.of(new ho)),ho.singleton.get()}static CONNECT_SIX_HELPER=new a0(L.identity,6);static getVictoriousCoords(t){return ho.CONNECT_SIX_HELPER.getVictoriousCoord(t)}getRulesConfigDescription(){return h.of(ho.RULES_CONFIG_DESCRIPTION)}getInitialState(t){const e=rt.create(t.get().width,t.get().height,B.NONE);return new Ed(e,0)}applyLegalMove(t,e,n,i){return t instanceof e4?this.applyLegalDrops(t,e):this.applyLegalFirstMove(t,e)}applyLegalDrops(t,e){const n=e.getCurrentPlayer(),i=t.getFirst(),o=t.getSecond(),s=e.getCopiedBoard();return s[i.y][i.x]=n,s[o.y][o.x]=n,new Ed(s,e.turn+1)}applyLegalFirstMove(t,e){const n=e.getCurrentPlayer(),i=e.getCopiedBoard();return i[t.coord.y][t.coord.x]=n,new Ed(i,e.turn+1)}isLegal(t,e){return t instanceof Gc?(L.assert(0===e.turn,"ConnectSixFirstMove should only be used at first move"),!1===e.isOnBoard(t.coord)?w.failure(uo.OUT_OF_RANGE(t.coord)):w.SUCCESS):(L.assert(e.turn>0,"ConnectSixDrops should only be used after first move"),!1===e.isOnBoard(t.getFirst())?w.failure(uo.OUT_OF_RANGE(t.getFirst())):!1===e.isOnBoard(t.getSecond())?w.failure(uo.OUT_OF_RANGE(t.getSecond())):this.isLegalDrops(t,e))}isLegalDrops(t,e){return e.getPieceAt(t.getFirst()).isPlayer()||e.getPieceAt(t.getSecond()).isPlayer()?w.failure(Ee.MUST_CLICK_ON_EMPTY_SQUARE()):w.SUCCESS}getGameStatus(t){const e=t.gameState;return ho.CONNECT_SIX_HELPER.getVictoriousCoord(e).length>0?ye.getVictory(e.getCurrentOpponent()):181===e.turn?ye.DRAW:ye.ONGOING}}class _2{static getHoshis(t,e){const n=[],i=_2.getHorizontalCenter(t),o=_2.getVerticalCenter(e),s=_2.getHorizontalLeft(t),a=_2.getVerticalUp(e),c=_2.getHorizontalRight(t),l=_2.getVerticalDown(e);return 12<e&&e%2==1&&n.push(new _(s,o),new _(c,o)),12<t&&t%2==1&&n.push(new _(i,a),new _(i,l)),t%2==1&&e%2==1&&n.push(new _(i,o)),n.push(new _(s,a),new _(s,l),new _(c,a),new _(c,l)),n}static getHorizontalLeft(t){return t<12?2:3}static getHorizontalCenter(t){return Math.floor(t/2)}static getHorizontalRight(t){return t-(_2.getHorizontalLeft(t)+1)}static getVerticalUp(t){return t<12?2:3}static getVerticalCenter(t){return Math.floor(t/2)}static getVerticalDown(t){return t-(_2.getVerticalUp(t)+1)}}let NI=(()=>{class r extends p2{hoshis=[];createHoshis(){const e=this.getHeight(),n=this.getWidth();this.hoshis=_2.getHoshis(n,e)}static \u0275fac=(()=>{let e;return function(i){return(e||(e=z1(r)))(i||r)}})();static \u0275cmp=Ue({type:r,selectors:[["ng-component"]],features:[$e],decls:0,vars:0,template:function(n,i){},encapsulation:2})}return r})();class tJ extends Kn{getListMoves(t,e){return 0===t.gameState.turn?this.getFirstMove(t.gameState):this.getListDrops(t)}getFirstMove(t){const e=t.getWidth(),n=t.getHeight(),i=Math.floor(e/2),o=Math.floor(n/2),s=new _(i,o);return[Gc.of(s)]}getListDrops(t){const e=this.getAvailableCoords(t.gameState),n=[];for(const i of e){const o=t.gameState.getCopiedBoard();o[i.y][i.x]=t.gameState.getCurrentPlayer();const s=new Ed(o,t.gameState.turn),a=this.getAvailableCoords(s);for(const c of a){const l=e4.of(i,c);n.push(l)}}return new st(n).toList()}getAvailableCoords(t){const e=this.getUsefulCoordsMap(t),n=[];for(const i of t.getCoordsAndContents()){const o=i.coord;!0===e[o.y][o.x]&&!1===i.content.isPlayer()&&n.push(o)}return n}getUsefulCoordsMap(t){const e=t.getWidth(),n=t.getHeight(),i=rt.create(e,n,!1);for(const o of t.getCoordsAndContents())o.content.isPlayer()&&this.addNeighboringCoord(i,o.coord);return i}addNeighboringCoord(t,e){const i=t[0].length,o=t.length,s=Math.max(0,e.x-1),a=Math.max(0,e.y-1),c=Math.min(i-1,e.x+1),l=Math.min(o-1,e.y+1);for(let u=a;u<=l;u++)for(let f=s;f<=c;f++)t[u][f]=!0}}class cke extends Ha{getBoardValue(t,e){const n=t.gameState;let i=0;for(const o of n.getCoordsAndContents())o.content.isPlayer()&&(i+=ho.CONNECT_SIX_HELPER.getSquareScore(n,o.coord));return mn.of(i)}}class lke extends fn{constructor(){super($localize`Alignment`,ho.get(),new cke,new tJ)}}function uke(r,t){if(1&r&&(I(),V(0,"circle",6)),2&r){const e=p().index,n=p().index,i=p();ve("id","piece_",e,"_",n,""),v("ngClass",i.getSpaceClass(e,n)),A("cx",.5*i.SPACE_SIZE+i.SPACE_SIZE*e)("cy",.5*i.SPACE_SIZE+i.SPACE_SIZE*n)("r",.44*i.SPACE_SIZE)}}function fke(r,t){if(1&r&&(I(),E(0,"g"),z(1,uke,1,6,"circle",5),P()),2&r){const e=t.$implicit;m(),v("ngIf",e.isPlayer())}}function dke(r,t){if(1&r&&(I(),E(0,"g"),z(1,fke,2,1,"g",3),P()),2&r){const e=t.$implicit;m(),v("ngForOf",e)}}function hke(r,t){if(1&r){const e=he();I(),E(0,"circle",7),q("click",function(){te(e);const i=p();return ne(i.onClick(i.droppedCoord.get()))}),P()}if(2&r){const e=p();v("ngClass",e.getSpaceClass(e.droppedCoord.get().x,e.droppedCoord.get().y)),A("cx",.5*e.SPACE_SIZE+e.SPACE_SIZE*e.droppedCoord.get().x)("cy",.5*e.SPACE_SIZE+e.SPACE_SIZE*e.droppedCoord.get().y)("r",.44*e.SPACE_SIZE)}}let nJ=(()=>{class r extends NI{droppedCoord=h.empty();lastMoved=[];victoryCoords=[];constructor(e){super(e),this.setRulesAndNode("ConnectSix"),this.availableAIs=[new lke,new zn($localize`MCTS`,new tJ,this.rules)],this.encoder=AI.encoder}updateBoard(e){var n=this;return M(function*(){const i=n.getState();n.board=i.getCopiedBoard(),n.victoryCoords=ho.getVictoriousCoords(i),n.createHoshis()})()}showLastMove(e){var n=this;return M(function*(){n.lastMoved=e instanceof Gc?[e.coord]:[e.getFirst(),e.getSecond()]})()}hideLastMove(){this.lastMoved=[]}onClick(e){var n=this;return M(function*(){const i=e.x,o=e.y,s=yield n.canUserPlay("#click_"+i+"_"+o);if(s.isFailure())return n.cancelMove(s.getReason());const a=new _(i,o);if(0===n.getState().turn){const c=Gc.of(a);return n.chooseMove(c)}if(n.getState().getPieceAt(a).isPlayer())return n.cancelMove(Ee.MUST_CLICK_ON_EMPTY_SQUARE());if(n.droppedCoord.isPresent()){if(n.droppedCoord.equalsValue(a))return n.droppedCoord=h.empty(),w.SUCCESS;{const c=e4.of(n.droppedCoord.get(),a);return n.chooseMove(c)}}return n.droppedCoord=h.of(a),w.SUCCESS})()}getSpaceClass(e,n){const i=new _(e,n),o=this.getState().getPieceAt(i),s=[];return this.droppedCoord.equalsValue(i)?(s.push(this.getPlayerClass(this.getState().getCurrentPlayer())),s.push("highlighted-stroke")):(s.push(this.getPlayerClass(o)),this.victoryCoords.some(a=>a.equals(i))&&s.push("victory-stroke"),this.lastMoved.some(a=>a.equals(i))&&s.push("last-move-stroke")),s}cancelMoveAttempt(){this.droppedCoord=h.empty()}static \u0275fac=function(n){return new(n||r)(G(Ut))};static \u0275cmp=Ue({type:r,selectors:[["app-connect-six"]],features:[$e],decls:5,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["app-blank-goban","",3,"width","height","clickCallBack"],["id","pieces"],[4,"ngFor","ngForOf"],["id","dropped","class","base moved-stroke",3,"ngClass","click",4,"ngIf"],["class","base",3,"id","ngClass",4,"ngIf"],[1,"base",3,"id","ngClass"],["id","dropped",1,"base","moved-stroke",3,"ngClass","click"]],template:function(n,i){1&n&&(I(),E(0,"svg",0)(1,"g",1),q("clickCallBack",function(s){return i.onClick(s)}),P(),E(2,"g",2),z(3,dke,2,1,"g",3),P(),z(4,hke,1,4,"circle",4),P()),2&n&&(A("viewBox",i.getViewBox().toSVGString()),m(),v("width",i.getState().getWidth())("height",i.getState().getHeight()),m(2),v("ngForOf",i.board),m(),v("ngIf",i.droppedCoord.isPresent()))},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}return r})();const x=B.NONE,C2=B.ZERO,$i=B.ONE,rJ=ho.get().getDefaultRulesConfig();class gke extends Wn{tutorial=[W.informational($localize`Initial board and object of the game`,$localize`Connect Six is played on a 19x19 board, on which stones are put on the intersections. The aim of the game is to align 6 of your pieces.`,ho.get().getInitialState(rJ)),W.anyMove($localize`First turn`,$localize`On the first turn, the first player plays only one piece.<br/><br/>You're playing Dark, place your first piece by clicking on an intersection.`,ho.get().getInitialState(rJ),Gc.of(new _(9,9)),pe.CONGRATULATIONS()),W.anyMove($localize`Next turns`,$localize`On all following turns, the players play two pieces.<br/><br/>You're playing Light, do the winning move.`,new Ed([[x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,$i,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,C2,x,$i,C2,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,C2,C2,x,x,$i,x,x,x,x,x,x],[x,x,x,x,x,x,x,$i,C2,C2,C2,C2,$i,x,x,x,x,x,x],[x,x,x,x,x,x,$i,C2,C2,C2,C2,$i,x,x,x,x,x,x,x],[x,x,x,x,x,x,$i,x,$i,C2,$i,$i,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,C2,$i,C2,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,$i,x,$i,x,C2,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,$i,$i,x,$i,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,$i,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,C2,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x]],20),e4.of(new _(4,11),new _(5,10)),pe.CONGRATULATIONS())]}let t4=(()=>class r{static SIMPLE_MOVE_SHOULD_BE_OF_ONE_STEP=()=>$localize`Your piece should land on a neighboring square.`;static CANNOT_DROP_AFTER_TURN_40=()=>$localize`You cannot drop a piece during the moving phase.`;static CANNOT_MOVE_BEFORE_TURN_40=()=>$localize`You cannot move a piece before both players have dropped all of their pieces.`;static MUST_JUMP_OVER_PIECES=()=>$localize`A jump must be made over a piece, not over an empty square.`;static MUST_DROP_IN_CENTRAL_ZONE=()=>$localize`A drop must occur in the central zone of the board.`;static INVALID_JUMP=()=>$localize`A jump must land two squares from its original position, and be done in a straight line in any direction.`;static SAME_LOCATION_VISITED_IN_JUMP=()=>$localize`You are visiting the same location twice in a move, you are not allowed to do so.`})();class Ml extends Nr{static encoder=Nr.getEncoder(Ml.of);static of(t){return new Ml(t)}constructor(t){super(t.x,t.y)}toString(){return`ConspirateursMoveDrop(${this.coord.toString()})`}equals(t){return!!Oi.isDrop(t)&&this.coord.equals(t.coord)}}class El extends Do{static encoder=G2.getFallibleEncoder(El.from);static from(t,e){return t.isAlignedWith(e)&&1===t.getDistance(e)?X.success(new El(t,e)):X.failure(t4.SIMPLE_MOVE_SHOULD_BE_OF_ONE_STEP())}constructor(t,e){super(t,e)}toString(){return`ConspirateursMoveSimple(${this.getStart().toString()} -> ${this.getEnd().toString()})`}equals(t){return!!Oi.isSimple(t)&&super.equals(t)}}class Ua extends h2{coords;static encoder=ke.tuple([ke.list(_.encoder)],t=>[yt.copy(t.coords)],t=>Ua.from(t[0]).get());static from(t){if(t.length<2)return X.failure("ConspirateursMoveJump requires at least one jump, so two coords");for(let n=1;n<t.length;n++)if(t[n-1].getDirectionToward(t[n]).isFailure()||2!==t[n-1].getDistance(t[n]))return X.failure(t4.INVALID_JUMP());return new ir(t).size()===t.length?X.success(new Ua(t)):X.failure(t4.SAME_LOCATION_VISITED_IN_JUMP())}constructor(t){super(),this.coords=t}addJump(t){const e=yt.copy(this.coords);return e.push(t),Ua.from(e)}getStartingCoord(){return this.coords[0]}getEndingCoord(){return this.coords[this.coords.length-1]}getLandingCoords(){return this.coords.slice(1)}getJumpedOverCoords(){const t=[];for(let e=1;e<this.coords.length;e++){const n=this.coords[e-1].getDirectionToward(this.coords[e]).get();t.push(this.coords[e-1].getNext(n,1))}return t}toString(){return`ConspirateursMoveJump(${this.coords.map(e=>e.toString()).reduce((e,n)=>e+" -> "+n)})`}equals(t){return!(Oi.isSimple(t)||Oi.isDrop(t)||t!==this&&(!1===this.getStartingCoord().equals(t.getStartingCoord())||!1===this.getEndingCoord().equals(t.getEndingCoord())))}}var Oi;!function(r){r.isDrop=function t(i){return i instanceof Ml},r.isSimple=function e(i){return i instanceof El},r.isJump=function n(i){return i instanceof Ua},r.encoder=ke.disjunction([r.isDrop,r.isSimple,r.isJump],[Ml.encoder,El.encoder,Ua.encoder])}(Oi||(Oi={}));class P1 extends B1{static WIDTH=17;static HEIGHT=17;static CENTRAL_ZONE_TOP_LEFT=new _(4,6);static CENTRAL_ZONE_BOTTOM_RIGHT=new _(12,10);static SHELTERS_INDICES=[0,1,3,5,7,8,9,11,13,15,16];static ALL_SHELTERS=new st(P1.SHELTERS_INDICES.flatMap(t=>[new _(t,0),new _(t,P1.HEIGHT-1),new _(0,t),new _(P1.WIDTH-1,t)])).toList();isShelter(t){return this.isVerticalEdge(t)?P1.SHELTERS_INDICES.some(e=>t.y===e):!!this.isHorizontalEdge(t)&&P1.SHELTERS_INDICES.some(e=>t.x===e)}isCentralZone(t){return P1.CENTRAL_ZONE_TOP_LEFT.x<=t.x&&t.x<=P1.CENTRAL_ZONE_BOTTOM_RIGHT.x&&P1.CENTRAL_ZONE_TOP_LEFT.y<=t.y&&t.y<=P1.CENTRAL_ZONE_BOTTOM_RIGHT.y}isDropPhase(){return this.turn<40}getSidePieces(){return this.turn%2==0?we.of(20-this.turn/2,20-this.turn/2):we.of(20-(this.turn-1)/2-1,20-(this.turn-1)/2)}}class Ho extends Ar{static singleton=h.empty();static get(){return Ho.singleton.isAbsent()&&(Ho.singleton=h.of(new Ho)),Ho.singleton.get()}getInitialState(){const t=rt.create(P1.WIDTH,P1.HEIGHT,B.NONE);return new P1(t,0)}applyLegalMove(t,e,n,i){const o=e.getCopiedBoard();if(Oi.isDrop(t))o[t.coord.y][t.coord.x]=e.getCurrentPlayer();else if(Oi.isSimple(t))o[t.getStart().y][t.getStart().x]=B.NONE,o[t.getEnd().y][t.getEnd().x]=e.getCurrentPlayer();else{const s=t.getStartingCoord(),a=t.getEndingCoord();o[s.y][s.x]=B.NONE,o[a.y][a.x]=e.getCurrentPlayer()}return new P1(o,e.turn+1)}isLegal(t,e){return Oi.isDrop(t)?this.dropLegality(t,e):Oi.isSimple(t)?this.simpleMoveLegality(t,e):this.jumpLegality(t,e)}dropLegality(t,e){return L.assert(e.isOnBoard(t.coord),"Move out of board"),40<=e.turn?w.failure(t4.CANNOT_DROP_AFTER_TURN_40()):e.getPieceAt(t.coord).isPlayer()?w.failure(Ee.MUST_LAND_ON_EMPTY_SPACE()):!1===e.isCentralZone(t.coord)?w.failure(t4.MUST_DROP_IN_CENTRAL_ZONE()):w.SUCCESS}simpleMoveLegality(t,e){const n=e.isOnBoard(t.getStart()),i=e.isOnBoard(t.getEnd());if(L.assert(n&&i,"Move out of board"),e.turn<40)return w.failure(t4.CANNOT_MOVE_BEFORE_TURN_40());const o=e.getPieceAt(t.getStart());return o===B.NONE?w.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):o===e.getCurrentOpponent()?w.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT()):e.getPieceAt(t.getEnd()).isPlayer()?w.failure(Ee.MUST_LAND_ON_EMPTY_SPACE()):w.SUCCESS}jumpLegality(t,e){for(const i of t.coords)if(!1===e.isOnBoard(i))return X.failure(uo.OUT_OF_RANGE(i));if(e.turn<40)return w.failure(t4.CANNOT_MOVE_BEFORE_TURN_40());const n=e.getPieceAt(t.getStartingCoord());if(n===B.NONE)return w.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(n===e.getCurrentOpponent())return w.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT());for(const i of t.getJumpedOverCoords())if(e.getPieceAt(i)===B.NONE)return w.failure(t4.MUST_JUMP_OVER_PIECES());for(const i of t.getLandingCoords())if(e.getPieceAt(i).isPlayer())return w.failure(Ee.MUST_LAND_ON_EMPTY_SPACE());return w.SUCCESS}jumpTargetsFrom(t,e){const n=[new _(e.x+2,e.y),new _(e.x-2,e.y),new _(e.x,e.y+2),new _(e.x,e.y-2),new _(e.x+2,e.y+2),new _(e.x+2,e.y-2),new _(e.x-2,e.y+2),new _(e.x-2,e.y-2)],i=[];for(const o of n)t.isOnBoard(o)&&Ua.from([e,o]).isSuccess()&&i.push(o);return i}nextJumps(t,e){const n=t.getEndingCoord(),i=[];for(const o of this.jumpTargetsFrom(e,n)){const s=t.addJump(o);s.isSuccess()&&this.jumpLegality(s.get(),e).isSuccess()&&i.push(s.get())}return i}jumpHasPossibleNextTargets(t,e){return this.nextJumps(t,e).length>0}getGameStatus(t){const e=t.gameState,n=we.of(0,0);for(const i of P1.ALL_SHELTERS){const o=e.getPieceAt(i);if(o.isPlayer()&&(n.add(o,1),20===n.get(o)))return ye.getVictory(o)}return ye.ONGOING}}const C=B.NONE,Ct=B.ZERO,mt=B.ONE;class pke extends Wn{tutorial=[W.informational($localize`Board and aim of the game`,$localize`Conspirateurs is played on a 17x17 board. The goal of the game is to place all of your pieces in shelters, which are the special squares on the edge of the board. Note the central zone in the middle of the board, where each player will put their pieces initially.`,Ho.get().getInitialState()),W.anyMove($localize`Initial phase`,$localize`In the initial phase of the game, each player drop their 20 pieces, one per turn consecutively, in the central zone of the board. This phase does not allow any other kind of move.<br/><br/>You're playing Dark, drop one of your piece in the central zone.`,Ho.get().getInitialState(),Ml.of(new _(7,7)),pe.CONGRATULATIONS()),W.fromPredicate($localize`Simple move`,$localize`Once all pieces have been placed, there are two kind of moves that can be performed. The first is a simple move in any direction, orthogonally or diagonally, of a single step.<br/><br/>You're playing Dark. Click on one of your piece and perform such a move.`,new P1([[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,Ct,Ct,mt,mt,Ct,Ct,mt,Ct,mt,C,C,C,C],[C,C,C,C,Ct,mt,Ct,mt,Ct,Ct,Ct,Ct,mt,C,C,C,C],[C,C,C,C,Ct,mt,C,C,C,C,C,mt,Ct,C,C,C,C],[C,C,C,C,mt,Ct,Ct,mt,mt,mt,Ct,Ct,Ct,C,C,C,C],[C,C,C,C,mt,Ct,mt,mt,mt,mt,mt,mt,Ct,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C]],40),El.from(new _(4,6),new _(3,5)).get(),(t,e,n)=>Oi.isSimple(t)?w.SUCCESS:w.failure($localize`You have made a jump, not a simple move. Try again!`),pe.CONGRATULATIONS()),W.fromPredicate($localize`Jumps`,$localize`The other type of move is a jump. A piece can jump over a neighboring piece in any direction, as long as it lands directly on the square after that piece, along the same direction.<br/><br/>You're playing Dark. Perform a jump by clicking on one of your piece that can perform a jump, and then on the target square. You may need to click a second time on the target square to confirm your jump, in case your piece is still highlighted (we will see shortly why this is useful).`,new P1([[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,Ct,Ct,mt,mt,Ct,Ct,mt,Ct,mt,C,C,C,C],[C,C,C,C,Ct,mt,Ct,mt,Ct,Ct,Ct,Ct,mt,C,C,C,C],[C,C,C,C,Ct,mt,C,C,C,C,C,mt,Ct,C,C,C,C],[C,C,C,C,mt,Ct,Ct,mt,mt,mt,Ct,Ct,Ct,C,C,C,C],[C,C,C,C,mt,Ct,mt,mt,mt,mt,mt,mt,Ct,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C]],40),Ua.from([new _(6,7),new _(6,5)]).get(),(t,e,n)=>Oi.isJump(t)?w.SUCCESS:w.failure($localize`You have not performed a jump. Try again!`),pe.CONGRATULATIONS()),W.fromMove($localize`Chaining jumps in a single move`,$localize`Jumps can be chained when possible. You can decide whether to continue a jump or to stop it at any time. To finish your jump, click a second time on your current location. Otherwise, simply keep clicking on your next location. Once no more destination is possible, your move will end without you needing to click the piece a second time.<br/><br/>You're playing Dark and you can perform a triple jump! Do it.`,new P1([[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,mt,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,mt,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,mt,C,C,C,C,C,C,C,C,C],[C,C,C,C,Ct,Ct,C,mt,Ct,Ct,mt,Ct,mt,C,C,C,C],[C,C,C,C,Ct,C,Ct,mt,Ct,Ct,Ct,Ct,mt,C,C,C,C],[C,C,C,C,Ct,mt,C,C,C,C,C,mt,Ct,C,C,C,C],[C,C,C,C,mt,Ct,Ct,mt,mt,mt,Ct,Ct,Ct,C,C,C,C],[C,C,C,C,mt,Ct,mt,mt,mt,mt,mt,mt,Ct,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C]],40),[Ua.from([new _(8,6),new _(6,4),new _(6,2),new _(6,0)]).get()],$localize`Congratulations! You now know everything to play the game. Remember: to win, you have to place all of your pieces in shelters before your opponent does.`,$localize`You have not performed a triple jump. Try again!`)]}let Pd=(()=>class r{static NO_MORE_PIECES_OF_THIS_TYPE=()=>$localize`You do not have any pieces of this type anymore.`;static SPACE_IS_FULL=()=>$localize`You cannot play here: this space is already full.`;static TARGET_STACK_TOO_HIGH=()=>$localize`You cannot add more pieces to the target stack, as it will contain more than 4 pieces.`;static MUST_SHIFT_TO_NEIGHBOR=()=>$localize`To perform a shift, you must move the pieces to a neighboring space.`;static MUST_SELECT_PIECE_FIRST=()=>$localize`You must first select either a piece from the side, or a stack of pieces to shift on the board.`})();class vn{owner;otherPieceType;static encoder=ke.tuple([B.encoder,ke.identity()],t=>[t.owner,t.otherPieceType],t=>vn.of(t[0],t[1]));static EMPTY=new vn(B.NONE,!1);static ZERO_FIRST=new vn(O.ZERO,!1);static ZERO_SECOND=new vn(O.ZERO,!0);static ONE_FIRST=new vn(O.ONE,!1);static ONE_SECOND=new vn(O.ONE,!0);static PLAYER_PIECES=[vn.ZERO_FIRST,vn.ZERO_SECOND,vn.ONE_FIRST,vn.ONE_SECOND];static of(t,e){return t===O.ZERO?e?vn.ZERO_SECOND:vn.ZERO_FIRST:t===O.ONE?e?vn.ONE_SECOND:vn.ONE_FIRST:vn.EMPTY}constructor(t,e){this.owner=t,this.otherPieceType=e}toString(){return`DiamPiece(${this.owner}, ${this.otherPieceType})`}equals(t){return this===t}}class iJ extends h2{isDrop(){return this instanceof Pl}isShift(){return this instanceof v2}}class Pl extends iJ{target;piece;static encoder=ke.tuple([ke.identity(),vn.encoder],t=>[t.target,t.piece],t=>new Pl(t[0],t[1]));constructor(t,e){if(super(),this.target=t,this.piece=e,e===vn.EMPTY)throw new Error("Cannot drop an empty piece")}getTarget(){return this.target}equals(t){return t instanceof Pl&&!(this.target!==t.target||this.piece!==t.piece)}toString(){return`DiamMoveDrop(${this.target}, ${this.piece})`}}class v2 extends iJ{start;moveDirection;static encoder=ke.tuple([_.encoder,ke.identity()],t=>[t.start,"clockwise"===t.moveDirection],t=>new v2(t[0],t[1]?"clockwise":"counterclockwise"));static ofRepresentation(t,e){return new v2(new _(t.x,3-t.y),e)}constructor(t,e){super(),this.start=t,this.moveDirection=e}getTarget(){return"clockwise"===this.moveDirection?(this.start.x+1)%8:(this.start.x+7)%8}equals(t){return t instanceof v2&&!(!1===this.start.equals(t.start)||this.moveDirection!==t.moveDirection)}toString(){return`DiamMoveShift(${this.start}, ${this.moveDirection})`}}const mke=ke.disjunction([r=>r.isDrop(),r=>r.isShift()],[Pl.encoder,v2.encoder]);let pr=(()=>{class r extends B1{remainingPieces;static WIDTH=8;static HEIGHT=4;static ofRepresentation(e,n){const i=e.reverse(),o=[4,4,4,4];for(let s=0;s<r.HEIGHT;s++)for(let a=0;a<r.WIDTH;a++)i[s][a]!==vn.EMPTY&&o[r.pieceIndex(i[s][a])]--;return pn(o.every(s=>0<=s),"Invalid DiamState representation uses too many pieces"),new r(i,o,n)}static pieceIndex(e){switch(e){case vn.ZERO_FIRST:return 0;case vn.ZERO_SECOND:return 1;case vn.ONE_FIRST:return 2;default:return L.expectToBe(e,vn.ONE_SECOND),3}}constructor(e,n,i){super(e,i),this.remainingPieces=n}getRemainingPiecesOf(e){return this.remainingPieces[r.pieceIndex(e)]}getStackHeight(e){let n=0;for(let i=0;i<r.HEIGHT&&this.getPieceAtXY(e,i)!==vn.EMPTY;i++)n++;return n}}return r})();class n4 extends Ar{static singleton=h.empty();static get(){return n4.singleton.isAbsent()&&(n4.singleton=h.of(new n4)),n4.singleton.get()}getInitialState(){const t=vn.EMPTY;return new pr([[t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t]],[4,4,4,4],0)}applyLegalMove(t,e,n,i){return t.isDrop()?this.applyLegalDrop(t,e):this.applyLegalShift(t,e)}applyLegalDrop(t,e){const n=rt.copy(e.board);n[e.getStackHeight(t.target)][t.target]=t.piece;const i=yt.copy(e.remainingPieces);return i[pr.pieceIndex(t.piece)]-=1,new pr(n,i,e.turn+1)}applyLegalShift(t,e){const n=rt.copy(e.board),i=t.getTarget();let o=e.getStackHeight(i),s=t.start.y;for(;s<pr.HEIGHT&&e.getPieceAtXY(t.start.x,s)!==vn.EMPTY;)n[o][i]=e.getPieceAtXY(t.start.x,s),n[s][t.start.x]=vn.EMPTY,o++,s++;return new pr(n,e.remainingPieces,e.turn+1)}isLegal(t,e){return t.isDrop()?this.isDropLegal(t,e):this.isShiftLegal(t,e)}isDropLegal(t,e){return L.assert(t.target<pr.WIDTH,"DiamMoveDrop out of board"),L.assert(t.piece.owner!==B.NONE,"DiamMoveDrop cannot contain an empty piece"),t.piece.owner===e.getCurrentOpponent()?w.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT()):0===e.getRemainingPiecesOf(t.piece)?w.failure(Pd.NO_MORE_PIECES_OF_THIS_TYPE()):this.dropHeightValidity(t,e)}dropHeightValidity(t,e){return e.getStackHeight(t.target)===pr.HEIGHT?w.failure(Pd.SPACE_IS_FULL()):w.SUCCESS}isShiftLegal(t,e){const n=e.getPieceAt(t.start);return n.owner===B.NONE?w.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):n.owner===e.getCurrentOpponent()?w.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT()):this.shiftHeightValidity(t,e)}shiftHeightValidity(t,e){const n=e.getStackHeight(t.start.x)-t.start.y;return e.getStackHeight(t.getTarget())+n>pr.HEIGHT?w.failure(Pd.TARGET_STACK_TOO_HIGH()):w.SUCCESS}getGameStatus(t){const e=this.findHighestAlignment(t.gameState);if(e.isPresent()){const n=t.gameState.getPieceAt(e.get());return L.assert(n.owner.isPlayer(),"highest alignment is owned by a player"),ye.getVictory(n.owner)}return ye.ONGOING}findHighestAlignment(t){for(let e=0;e<pr.WIDTH/2;e++)for(let n=pr.HEIGHT-1;n>0;n--){const i=t.getPieceAtXY(e,n),o=t.getPieceAtXY(e+pr.WIDTH/2,n);if(i!==vn.EMPTY&&i===o)return h.of(new _(e,n))}return h.empty()}pieceCanMove(t,e){return!!this.isShiftLegal(new v2(e,"clockwise"),t).isSuccess()||!!this.isShiftLegal(new v2(e,"counterclockwise"),t).isSuccess()}}const We=vn.EMPTY,au=vn.ZERO_FIRST,oJ=vn.ZERO_SECOND,AC=vn.ONE_FIRST,II=vn.ONE_SECOND;class _ke{tutorial=[W.informational($localize`Initial board and player pieces`,$localize`Diam's board is a circular board made of 8 spaces. Each player has 8 pieces: 4 of one color, and 4 of another color. Initially, the board is empty. All the remaining pieces are displayed next to the board: Dark's pieces are on the left, Light's pieces are on the right.`,n4.get().getInitialState()),W.fromMove($localize`Goal of the game`,$localize`At Diam, the goal is to align two of your pieces, having exactly the same color, on diametrically opposed spaces, on top of at least another piece. Note here that Dark does not win because the dark pieces are not on top of any other piece. You're playing Light. Here, you can win by dropping one of your pieces on the leftmost space. You can do it by clicking on the corresponding piece next to the board, and then on the space in which you want to drop your piece.<br/><br/>You're playing Light, win the game!`,pr.ofRepresentation([[We,We,We,We,We,We,We,We],[We,We,We,We,We,We,We,We],[We,We,We,We,AC,We,We,We],[au,We,We,We,au,We,We,We]],3),[new Pl(0,vn.ONE_FIRST)],pe.CONGRATULATIONS_YOU_WON(),$localize`Failed, you should drop your piece on the leftmost space, using the piece of the same color of the other piece you already have on the board.`),W.fromMove($localize`Types of move`,$localize`You can perform two types of move: either dropping one of your piece like you did in the previous step, or you can shift one of your pieces on the board to a neighboring space. You can pick any of your piece on the board, even if there are pieces on top of it. Only one condition applies: there can never be more than 4 pieces in a space. When you pick a piece with other pieces on top of it, all the other pieces move with yours.<br/><br/>You're playing Dark, try to move one of your piece that is already on the board.`,pr.ofRepresentation([[We,We,We,We,We,We,We,We],[We,We,We,We,II,We,We,We],[We,We,We,We,au,We,We,We],[AC,We,We,We,oJ,We,We,We]],4),[v2.ofRepresentation(new _(4,3),"counterclockwise"),v2.ofRepresentation(new _(4,3),"clockwise"),v2.ofRepresentation(new _(4,2),"counterclockwise"),v2.ofRepresentation(new _(4,2),"clockwise")],pe.CONGRATULATIONS(),$localize`Failed, try to move one of your piece that is already on the board.`),W.fromMove($localize`Special case`,$localize`It can happen that, in a single turn, both players reach an alignment. If it is the case, only the player with the highest alignment wins.<br/><br/>Here, playing Dark, you can win by performing such a move, do it!`,pr.ofRepresentation([[We,We,We,We,au,We,We,We],[We,We,We,We,II,We,We,au],[We,We,We,We,au,We,We,II],[We,AC,We,We,oJ,We,We,AC]],8),[v2.ofRepresentation(new _(4,2),"counterclockwise")],pe.CONGRATULATIONS(),$localize`Failed, try to shift a stack of pieces to the left.`)]}let sJ=(()=>{class r extends Fc{SPACE_SIZE=100;board;getTriangleCornerCoords(e,n){return(e+n)%2==0?this.getUpwardCoordinate():this.getDownwardCoordinate()}getTrianglePoints(e,n){const i=this.getTriangleCornerCoords(e,n);return this.mapCoordsToPoints(i)}getTriangleTranslationCoord(e,n){return new _(.5*e*this.SPACE_SIZE,n*this.SPACE_SIZE)}getTriangleTranslation(e,n){const i=this.getTriangleTranslationCoord(e,n);return"translate("+i.x+", "+i.y+")"}getDownwardCoordinate(){const n=this.SPACE_SIZE/2,i=this.SPACE_SIZE,s=this.SPACE_SIZE,a=new _(0,0);return[a,new _(n,s),new _(i,0),a]}getUpwardCoordinate(){const n=this.SPACE_SIZE/2,i=this.SPACE_SIZE,s=this.SPACE_SIZE,a=new _(0,s);return[a,new _(n,0),new _(i,s),a]}getPyramidPoints(e,n){return(e+n)%2==1?this.getDownwardPyramidPoints():this.getUpwardPyramidPoints()}getDownwardPyramidCoords(){const e=this.SPACE_SIZE,n=this.SPACE_SIZE/2,i=new _(0,0),o=new _(e,0),s=new _(n,e),a=new _(n,n);return[i,s,a,i,a,o,i,o,s,a,o]}getDownwardPyramidPoints(){const e=this.getDownwardPyramidCoords();return this.mapCoordsToPoints(e)}mapCoordsToPoints(e){return e.map(n=>n.toSVGPoint()).join(", ")}getUpwardPyramidCoords(){const e=this.SPACE_SIZE/2,n=this.SPACE_SIZE,i=new _(0,n),o=new _(n,n),s=new _(e,0),a=new _(e,e);return[i,s,a,i,a,o,i,o,s,a,o]}getUpwardPyramidPoints(){const e=this.getUpwardPyramidCoords();return this.mapCoordsToPoints(e)}static \u0275fac=(()=>{let e;return function(i){return(e||(e=z1(r)))(i||r)}})();static \u0275cmp=Ue({type:r,selectors:[["ng-component"]],features:[$e],decls:0,vars:0,template:function(n,i){},encapsulation:2})}return r})(),Sd=(()=>class r{static INVALID_DISTANCE=()=>$localize`Your piece must land on one of the closest six triangles with the same color as the triangle on which the piece is.`;static NOT_ENOUGH_TILES_TO_EXCHANGE=()=>$localize`You do not have enough tiles to exchange in order to capture this piece. Pick one of your piece and move it.`;static FIRST_CLICK_SHOULD_NOT_BE_NULL=()=>$localize`Your first click must be on the piece that you want to move, or on a piece of your opponent that you want to exchange against two tiles.`;static CANNOT_CAPTURE_FROM_EMPTY=()=>$localize`You cannot capture from an empty space.`})();class Qs{static getNeighbors(t){let e;const n=new _(t.x-1,t.y),i=new _(t.x+1,t.y);return e=(t.x+t.y)%2==1?[n,i,new _(t.x,t.y-1)]:[n,i,new _(t.x,t.y+1)],e}static getFakeNeighbors(t){return new _(t.x,(t.x+t.y)%2==1?t.y+1:t.y-1)}static getCommonNeighbor(t,e){const n=Qs.getNeighbors(t),i=Qs.getNeighbors(e);let o=0;for(;o<n.length;){const s=n[o];let a=0;for(;a<i.length;){if(s.equals(i[a]))return h.of(s);a++}o++}return h.empty()}static isSpaceDark(t){return(t.x+t.y)%2==0}}class c0 extends B1{static getEmptyNeighbors(t,e,n){const i=[];for(const o of Qs.getNeighbors(e))o.isInRange(t[0].length,t.length)&&t[o.y][o.x]===n&&i.push(o);return i}getEmptyNeighbors(t,e){return c0.getEmptyNeighbors(this.board,t,e)}}var Bc;let Ti=class extends c0{static#e=Bc=this;tiles;captures;static NEIGHBORS_TILES_DIRECTIONS=[new Gt(0,-2),new Gt(3,-1),new Gt(3,1),new Gt(0,2),new Gt(-3,1),new Gt(-3,-1)];static getTilesUpperLeftCoord(t){const e=t.x-t.x%3;let n=t.y;return n-=e%2==0?t.y%2:(t.y+1)%2,new _(e,n)}static isOnBoard(t){return t.isInRange(15,10)}static getPresentNeighborEntrances(t){return[new _(t.x+1,t.y-1),new _(t.x+3,t.y+0),new _(t.x+3,t.y+1),new _(t.x+1,t.y+2),new _(t.x-1,t.y+1),new _(t.x-1,t.y+0)].filter(Bc.isOnBoard)}constructor(t,e,n,i){super(t,e),this.tiles=n,this.captures=i,n.makeImmutable(),i.makeImmutable()}applyLegalMovement(t){const e=t.getStart(),n=t.getEnd(),i=this.getCopiedBoard();return i[n.y][n.x]=Pe.ofPlayer(this.getCurrentPlayer()),i[e.y][e.x]=Pe.EMPTY,new Bc(i,this.turn,this.tiles,this.captures)}doMovementCaptures(t){const e=this.getCapturedNeighbors(t.getEnd());let n=this;for(const i of e)n=n.capture(i);return n}getCapturedNeighbors(t){const e=this.getCurrentOpponent();return Qs.getNeighbors(t).filter(i=>!i.isNotInRange(15,10)&&!!this.getPieceAt(i).is(e)&&this.isSurrounded(i))}isSurrounded(t){return 0===this.getEmptyNeighbors(t,Pe.EMPTY).length}capture(t){const e=this.getCopiedBoard(),n=this.captures.getCopy();return e[t.y][t.x]=Pe.EMPTY,n.add(this.getCurrentPlayer(),1),new Bc(e,this.turn,this.tiles,n)}removeTilesIfNeeded(t,e){let n=this;const i=Bc.getTilesUpperLeftCoord(t);if(this.isTileEmpty(i)&&this.isDeconnectable(i)){n=this.deconnectTile(i,e);const o=Bc.getPresentNeighborEntrances(i);for(const s of o){const a=n.getPieceAt(s);a===Pe.EMPTY?n=n.removeTilesIfNeeded(s,e):a.is(this.getCurrentOpponent())&&n.isSurrounded(s)&&(n=n.capture(s))}}return n}isTileEmpty(t){L.assert(this.getPieceAt(t)!==Pe.UNREACHABLE,"Should not call isTileEmpty on removed tile");for(let e=0;e<2;e++)for(let n=0;n<3;n++){const i=t.getNext(new Gt(n,e),1);if(this.getPieceAt(i)!==Pe.EMPTY)return!1}return!0}isDeconnectable(t){const e=this.getPresentNeighborTilesRelativeIndices(t);if(e.length>3)return!1;let n=0;for(let i=1;i<e.length;i++)!1===this.areNeighbor(e[i-1],e[i])&&(n+=1);return!1===this.areNeighbor(e[0],e[e.length-1])&&(n+=1),n<=1}areNeighbor(t,e){return t+1===e||0===t&&5===e}getPresentNeighborTilesRelativeIndices(t){const e=[];let n=h.empty();for(let i=0;i<6;i++){const s=t.getNext(Bc.NEIGHBORS_TILES_DIRECTIONS[i],1);Bc.isOnBoard(s)&&this.getPieceAt(s)!==Pe.UNREACHABLE&&(n.isAbsent()&&(n=h.of(i)),e.push(i-n.get()))}return e}deconnectTile(t,e){const n=this.getCopiedBoard(),i=t.x,o=t.y;for(let a=0;a<2;a++)for(let c=0;c<3;c++)n[o+a][i+c]=Pe.UNREACHABLE;const s=this.tiles.getCopy();return e&&s.add(this.getCurrentPlayer(),1),new Bc(n,this.turn,s,this.captures)}getLegalLandings(t){const e=[];for(const n of wi.STEPS){const i=t.getNext(n.direction,1);this.isOnBoard(i)&&this.getPieceAt(i)===Pe.EMPTY&&e.push(i)}return e}getPiecesByFreedom(){const t=G1.of([0,0,0,0],[0,0,0,0]);for(let e=0;e<10;e++)for(let n=0;n<15;n++){const i=this.board[e][n];if(i.isPlayer()){const o=i.getPlayer(),s=this.getEmptyNeighbors(new _(n,e),Pe.EMPTY).length;t.add(o,s,1)}}return t}};Ti=Bc=function(r,t,e,n){var s,i=arguments.length,o=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,e):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,t,e,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(t,e,o):s(t,e))||o);return i>3&&o&&Object.defineProperty(t,e,o),o}([Ae.log],Ti);class wi{direction;str;static LEFT=new wi(new Gt(-2,0),"LEFT");static UP_LEFT=new wi(me.UP_LEFT,"UP_LEFT");static UP_RIGHT=new wi(me.UP_RIGHT,"UP_RIGHT");static RIGHT=new wi(new Gt(2,0),"RIGHT");static DOWN_LEFT=new wi(me.DOWN_LEFT,"DOWN_LEFT");static DOWN_RIGHT=new wi(me.DOWN_RIGHT,"DOWN_RIGHT");static STEPS=[wi.LEFT,wi.UP_LEFT,wi.UP_RIGHT,wi.RIGHT,wi.DOWN_LEFT,wi.DOWN_RIGHT];static ofCoords(t,e){const n=t.getVectorToward(e),i=wi.STEPS.findIndex(o=>o.direction.equals(n));return L.assert(-1!==i,Sd.INVALID_DISTANCE()),wi.STEPS[i]}constructor(t,e){this.direction=t,this.str=e}}class y2 extends Do{static encoder=Do.getEncoder(y2.of);static of(t,e){const n=wi.ofCoords(t,e);return y2.ofMovement(t,n)}static ofMovement(t,e){L.assert(Ti.isOnBoard(t),"Starting coord cannot be out of range (width: 15, height: 10).");const n=new _(t.x+e.direction.x,t.y+e.direction.y);return L.assert(Ti.isOnBoard(n),"Landing coord cannot be out of range (width: 15, height: 10)."),new y2(t,n)}constructor(t,e){super(t,e)}toString(){return"CoerceoRegularMove("+this.getStart().toString()+" > "+this.getEnd().toString()+")"}equals(t){return!Ol.isTileExchange(t)&&super.equals(t)}}class Sl extends Nr{static encoder=Nr.getEncoder(Sl.of);static of(t){return L.assert(Ti.isOnBoard(t),"Captured coord cannot be out of range (width: 15, height: 10)."),new Sl(t)}constructor(t){super(t.x,t.y)}toString(){return"CoerceoTileExchangeMove("+this.coord.x+", "+this.coord.y+")"}equals(t){return!!Ol.isTileExchange(t)&&t.coord.equals(this.coord)}}var Ol;!function(r){r.isNormalMove=function t(n){return n instanceof y2},r.isTileExchange=function e(n){return n instanceof Sl},r.encoder=ke.disjunction([r.isNormalMove,r.isTileExchange],[y2.encoder,Sl.encoder])}(Ol||(Ol={}));class vke extends rr{getMetrics(t,e){const n=t.gameState,i=n.getPiecesByFreedom(),o=this.getPiecesScore(i),s=2*n.captures.get(O.ZERO)+o[0],a=2*n.captures.get(O.ONE)+o[1];return G1.ofSingle(s,a)}getPiecesScore(t){return[this.getPlayerPiecesScore(t.get(O.ZERO).get()),this.getPlayerPiecesScore(t.get(O.ONE).get())]}getPlayerPiecesScore(t){return 3*t[0]+1*t[1]+3*t[2]+3*t[3]}}class kI extends Kn{getListMoves(t,e){let n=this.getListExchanges(t);return n=n.concat(this.getListMovement(t)),n}getListExchanges(t){const e=[],n=t.gameState,i=n.getCurrentPlayer(),o=Pe.ofPlayer(n.getCurrentOpponent());if(n.tiles.get(i)<2)return e;for(const s of n.getCoordsAndContents())if(s.content===o){const a=Sl.of(s.coord);e.push(a)}return e}getListMovement(t){const e=[],n=t.gameState,i=n.getCurrentPlayer();for(const o of n.getCoordsAndContents()){const s=o.coord;if(o.content.is(i)){const a=n.getLegalLandings(s);for(const c of a){const l=y2.of(s,c);e.push(l)}}}return e}}class yke extends rr{getMetrics(t,e){const n=t.gameState,i=this.getPiecesMap(n),o=this.getThreatMap(n,i),s=this.filterThreatMap(o,n),u=G1.of([0,0,0],[0,0,0]);for(const f of O.PLAYERS){for(const g of i.get(f).get())s.get(g).isPresent()?u.add(f,1,1):u.add(f,0,1);u.add(f,2,n.tiles.get(f))}return u}getPiecesMap(t){const e=new gn,n=[],i=[];for(const o of t.getCoordsAndContents()){const s=o.coord,a=t.getPieceAt(s);a===Pe.ZERO?n.push(s):a===Pe.ONE&&i.push(s)}return e.set(O.ZERO,new ir(n)),e.set(O.ONE,new ir(i)),e}getThreatMap(t,e){const n=new gn;for(const i of O.PLAYERS)for(const o of e.get(i).get()){const s=this.getThreat(o,t);s.isPresent()&&n.set(o,s.get())}return n}getThreat(t,e){const i=e.getPieceAt(t).getPlayer().getOpponent();let o=h.empty(),s=h.empty(),a=[];const c=Qs.getNeighbors(t).filter(Ti.isOnBoard);for(const l of c){const u=e.getPieceAt(l);if(u.is(i))a.push(l),this.tileCouldBeRemovedThisTurn(l,e,i)&&(s=h.of(l));else if(u===Pe.EMPTY){if(o.isPresent())return h.empty();o=h.of(l)}}if(o.isPresent()){const l=[];for(const u of wi.STEPS){const f=o.get().getNext(u.direction,1);Ti.isOnBoard(f)&&e.getPieceAt(f).is(i)&&!1===a.some(g=>g.equals(f))&&l.push(f)}if(l.length>0)return h.of(new bC(new ir(a),new ir(l)))}if(s.isPresent()){a=a.filter(u=>u.equals(s.get()));const l=new ir(a);return h.of(new bC(l,new ir([s.get()])))}return h.empty()}tileCouldBeRemovedThisTurn(t,e,n){const i=n.getOpponent();if(!1===e.isDeconnectable(t))return!1;let s=h.empty();const a=Ti.getTilesUpperLeftCoord(t);for(let c=0;c<2;c++)for(let l=0;l<3;l++){const u=a.getNext(new Gt(l,c),1);if(e.getPieceAt(u).is(n)){if(!this.pieceCouldLeaveTheTile(u,e))return!1;s=h.of(u)}else if(e.getPieceAt(u).is(i))return!1}return s.isPresent()}pieceCouldLeaveTheTile(t,e){const n=Ti.getTilesUpperLeftCoord(t);for(const i of wi.STEPS){const o=t.getNext(i.direction,1),s=Ti.getTilesUpperLeftCoord(o);if(!1===n.equals(s)&&Ti.isOnBoard(o)&&e.getPieceAt(o)===Pe.EMPTY)return!0}return!1}filterThreatMap(t,e){const n=new gn,i=t.listKeys(),o=i.filter(a=>e.getPieceAt(a).is(e.getCurrentPlayer())),s=new ir(i.filter(a=>e.getPieceAt(a).is(e.getCurrentOpponent())));for(const a of o){const c=t.get(a).get();let l=h.empty();for(const u of c.directThreats)if(!1===s.contains(u)){const f=[];for(const g of c.mover)!1===s.contains(g)&&f.push(g);f.length>0&&(l=h.of(new bC(c.directThreats,new ir(f))))}l.isPresent()&&n.set(a,l.get())}for(const a of s){const c=t.get(a).get();n.set(a,c)}return n}}class Mke extends kI{getListMoves(t,e){const n=super.getListMoves(t,e);return this.putCaptureFirst(t,n)}putCaptureFirst(t,e){return yt.sortByDescending(e,n=>this.moveCapturesList(t,n).length),e}moveCapturesList(t,e){return Ol.isTileExchange(e)?[e.coord]:t.gameState.applyLegalMovement(e).removeTilesIfNeeded(e.getStart(),!0).getCapturedNeighbors(e.getEnd())}}function Eke(r,t){if(1&r&&(I(),V(0,"polygon",7)),2&r){const e=p().index,n=p().index,i=p();ve("id","space_",e,"_",n,""),v("ngClass",i.getSpaceClass(e,n)),A("points",i.getTrianglePoints(e,n))("transform",i.getTriangleInHexTranslation(e,n))}}function Pke(r,t){if(1&r){const e=he();I(),E(0,"g",5),q("click",function(){const o=te(e).index,s=p().index;return ne(p().onClick(o,s))}),z(1,Eke,1,5,"polygon",6),P()}if(2&r){const e=t.index,n=p().index,i=p();ve("id","click_",e,"_",n,""),m(),v("ngIf",i.mustDraw(e,n))}}function Ske(r,t){if(1&r&&(I(),E(0,"g"),z(1,Pke,2,3,"g",4),P()),2&r){const e=t.$implicit;m(),v("ngForOf",e)}}function Oke(r,t){if(1&r&&(I(),V(0,"polygon",9)),2&r){const e=p().index,n=p().index,i=p();ve("id","pyramid_",e,"_",n,""),v("ngClass",i.getPyramidClass(e,n)),A("points",i.getPyramidPoints(e,n))("transform",i.getTriangleInHexTranslation(e,n))}}function Tke(r,t){if(1&r){const e=he();I(),E(0,"g",5),q("click",function(){const o=te(e).index,s=p().index;return ne(p().onClick(o,s))}),z(1,Oke,1,5,"polygon",8),P()}if(2&r){const e=t.index,n=p().index,i=p();ve("id","click_",e,"_",n,""),m(),v("ngIf",i.isPyramid(e,n))}}function wke(r,t){if(1&r&&(I(),E(0,"g"),z(1,Tke,2,3,"g",4),P()),2&r){const e=t.$implicit;m(),v("ngForOf",e)}}function bke(r,t){if(1&r){const e=he();I(),E(0,"rect",12),q("click",function(){const o=te(e).$implicit;return ne(p(2).onClick(o.x,o.y))}),P()}if(2&r){const e=t.$implicit,n=p(2);A("x",n.SPACE_SIZE/2-n.INDICATOR_SIZE/2)("y",n.getIndicatorY(e))("width",n.INDICATOR_SIZE)("height",n.INDICATOR_SIZE)("transform",n.getTriangleInHexTranslation(e.x,e.y))}}function Ake(r,t){if(1&r&&(I(),E(0,"g"),V(1,"polygon",10),z(2,bke,1,5,"rect",11),P()),2&r){const e=p();m(),ve("id","selected_",e.chosenCoord.get().x,"_",e.chosenCoord.get().y,""),A("points",e.getTrianglePoints(e.chosenCoord.get().x,e.chosenCoord.get().y))("transform",e.getTriangleInHexTranslation(e.chosenCoord.get().x,e.chosenCoord.get().y)),m(),v("ngForOf",e.possibleLandings)}}function Nke(r,t){if(1&r&&(I(),V(0,"polygon",14)),2&r){const e=p(2);ve("id","last_start_",e.lastStart.get().x,"_",e.lastStart.get().y,""),A("points",e.getTrianglePoints(e.lastStart.get().x,e.lastStart.get().y))("transform",e.getTriangleInHexTranslation(e.lastStart.get().x,e.lastStart.get().y))}}function Ike(r,t){if(1&r&&(I(),V(0,"polygon",14)),2&r){const e=p(2);ve("id","last_end_",e.lastEnd.get().x,"_",e.lastEnd.get().y,""),A("points",e.getTrianglePoints(e.lastEnd.get().x,e.lastEnd.get().y))("transform",e.getTriangleInHexTranslation(e.lastEnd.get().x,e.lastEnd.get().y))}}function kke(r,t){if(1&r&&(I(),z(0,Nke,1,4,"polygon",13)(1,Ike,1,4,"polygon",13)),2&r){const e=p();v("ngIf",e.lastStart.isPresent()),m(),v("ngIf",e.lastEnd.isPresent())}}const Rke=r=>["base",r];function xke(r,t){if(1&r&&(I(),E(0,"g",16),V(1,"polygon",17),E(2,"text",18),ot(3),P()()),2&r){const e=p().$implicit,n=p();v("id","tilesCount"+e.getValue()),A("transform",n.getTilesCountTranslation(e)),m(),v("ngClass",Ta(7,Rke,"player"+e.getValue()+"-fill")),A("points",n.getTilesCountCoordinate())("stroke",n.lastTurnWasTilesExchange(e)?"yellow":"black"),m(),A("font-size",n.SPACE_SIZE/2),m(),Cn(n.tiles.get(e))}}function Lke(r,t){if(1&r&&(I(),E(0,"g"),z(1,xke,4,9,"g",15),P()),2&r){const e=t.$implicit,n=p();m(),v("ngIf",n.mustShowTilesOf(e))}}let zke=(()=>{class r extends sJ{state;tiles=we.of(0,0);NONE=Pe.UNREACHABLE;INDICATOR_SIZE=10;chosenCoord=h.empty();lastStart=h.empty();lastEnd=h.empty();possibleLandings=[];constructor(e){super(e),this.setRulesAndNode("Coerceo"),this.availableAIs=[new fn($localize`Pieces > Threats > Tiles`,this.rules,new yke,new Mke),new fn($localize`Captures > Freedom`,this.rules,new vke,new kI),new zn($localize`MCTS`,new kI,this.rules)],this.encoder=Ol.encoder,this.scores=h.of(we.of(0,0))}updateBoard(e){var n=this;return M(function*(){n.chosenCoord=h.empty(),n.state=n.getState(),n.scores=h.of(n.state.captures),n.tiles=n.state.tiles,n.board=n.getState().board})()}showHighlight(){this.possibleLandings=this.state.getLegalLandings(this.chosenCoord.get())}cancelMoveAttempt(){this.chosenCoord=h.empty(),this.possibleLandings=[]}showLastMove(e){var n=this;return M(function*(){e instanceof y2&&(n.lastStart=h.of(e.getStart()),n.lastEnd=h.of(e.getEnd()))})()}hideLastMove(){this.lastStart=h.empty(),this.lastEnd=h.empty()}onClick(e,n){var i=this;return M(function*(){const o=yield i.canUserPlay("#click_"+e+"_"+n);if(o.isFailure())return i.cancelMove(o.getReason());const s=new _(e,n),a=i.state.getCurrentPlayer();return i.chosenCoord.equalsValue(s)?(i.cancelMoveAttempt(),w.SUCCESS):i.chosenCoord.isAbsent()||i.state.getPieceAt(s).is(a)?i.firstClick(s):i.secondClick(s)})()}firstClick(e){var n=this;return M(function*(){const i=n.state.getPieceAt(e);if(i.is(n.state.getCurrentOpponent())){const o=Sl.of(e);return n.chooseMove(o)}return i.is(n.state.getCurrentPlayer())?(n.chosenCoord=h.of(e),n.showHighlight(),w.SUCCESS):n.cancelMove(Sd.FIRST_CLICK_SHOULD_NOT_BE_NULL())})()}secondClick(e){var n=this;return M(function*(){if(n.possibleLandings.some(i=>i.equals(e))){const i=y2.of(n.chosenCoord.get(),e);return n.chooseMove(i)}return n.cancelMove(Sd.INVALID_DISTANCE())})()}isPyramid(e,n){return this.board[n][e].isPlayer()||this.wasOpponent(e,n)}wasOpponent(e,n){const i=this.node.parent;if(i.isPresent()){const o=i.get().gameState.getCurrentOpponent();return i.get().gameState.getPieceAtXY(e,n).is(o)}return!1}getPyramidClass(e,n){const i=this.board[n][e];return i.isPlayer()?this.getPlayerClass(i.getPlayer()):"captured-fill"}mustDraw(e,n){return this.board[n][e]!==Pe.UNREACHABLE||this.wasRemoved(e,n)}wasRemoved(e,n){const o=this.node.parent;if(this.board[n][e]===Pe.UNREACHABLE&&o.isPresent()){const s=o.get().gameState.getPieceAtXY(e,n);return s===Pe.EMPTY||s.is(o.get().gameState.getCurrentPlayer())}return!1}getSpaceClass(e,n){return this.wasRemoved(e,n)?"captured-alternate-fill":(e+n)%2==1?"background":"background2"}getTilesCountCoordinate(){return"-15, -40, 35, -40, 60, 10, 35, 60, -15, 60, -40, 10, -15, -40"}mustShowTilesOf(e){return this.tiles.get(e)>0||this.lastTurnWasTilesExchange(e)}lastTurnWasTilesExchange(e){return!this.node.parent.isAbsent()&&this.getPreviousState().tiles.get(e)>this.tiles.get(e)}getIndicatorY(e){const n=this.INDICATOR_SIZE/2,i=this.SPACE_SIZE/2;return(e.x+e.y)%2==0?n+i:n+i-30}getTriangleInHexTranslation(e,n){const i=this.getTriangleTranslationCoord(e,n),o=i.x+2*Math.floor(e/3)*this.STROKE_WIDTH;let s=i.y;return Math.floor(e/3)%2==0?s+=2*Math.floor(n/2)*this.STROKE_WIDTH:(s+=2*Math.abs(Math.floor((n-1)/2))*this.STROKE_WIDTH,s+=this.STROKE_WIDTH),"translate("+o+", "+s+")"}getTilesCountTranslation(e){let n,i;return e===O.ZERO?(n=-.05,i=-.1):(n=7.5,i=9.45),n*=this.SPACE_SIZE,i*=this.SPACE_SIZE,"translate("+n+", "+i+")"}getViewBox(){const s=this.STROKE_WIDTH/2;return new Ks(0,0,8.5*this.SPACE_SIZE+2*this.STROKE_WIDTH,10.5*this.SPACE_SIZE+2*this.STROKE_WIDTH).expand(s,s,s,s)}static \u0275fac=function(n){return new(n||r)(G(Ut))};static \u0275cmp=Ue({type:r,selectors:[["app-coerceo"]],features:[$e],decls:7,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf","ngIfElse"],["lastMove",""],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["class","base normal-stroke","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["stroke-linecap","round",1,"base","normal-stroke",3,"id","ngClass"],["class","base small-stroke","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["stroke-linecap","round",1,"base","small-stroke",3,"id","ngClass"],[1,"base","no-fill","normal-stroke","selected-stroke",3,"id"],["class","base-no-fill indicator clickable-fill",3,"click",4,"ngFor","ngForOf"],[1,"base-no-fill","indicator","clickable-fill",3,"click"],["class","base no-fill normal-stroke last-move-stroke",3,"id",4,"ngIf"],[1,"base","no-fill","normal-stroke","last-move-stroke",3,"id"],[3,"id",4,"ngIf"],[3,"id"],["stroke-linecap","round",3,"ngClass"],["id","playerZeroTilesCount","x","-5","y","5",1,"text-giant"]],template:function(n,i){if(1&n&&(I(),E(0,"svg",0),z(1,Ske,2,1,"g",1)(2,wke,2,1,"g",1)(3,Ake,3,5,"g",2)(4,kke,2,2,"ng-template",null,3,In)(6,Lke,2,1,"g",1),P()),2&n){const o=wn(5);A("viewBox",i.getViewBox().toSVGString()),m(),v("ngForOf",i.board),m(),v("ngForOf",i.board),m(),v("ngIf",i.chosenCoord.isPresent())("ngIfElse",o),m(3),v("ngForOf",i.Player.PLAYERS)}},dependencies:[zt,Nt,bt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}return r})();var cu;let Od=class extends Ar{static#e=cu=this;static singleton=h.empty();static get(){return cu.singleton.isAbsent()&&(cu.singleton=h.of(new cu)),cu.singleton.get()}getInitialState(){const t=Pe.EMPTY,e=Pe.UNREACHABLE,n=Pe.ZERO,i=Pe.ONE;return new Ti([[e,e,e,e,e,e,n,t,n,e,e,e,e,e,e],[e,e,e,t,t,n,t,t,t,n,t,t,e,e,e],[t,i,t,i,t,t,n,t,n,t,t,i,t,i,t],[i,t,t,t,i,t,t,t,t,t,i,t,t,t,i],[t,i,t,i,t,t,t,t,t,t,t,i,t,i,t],[t,n,t,n,t,t,t,t,t,t,t,n,t,n,t],[n,t,t,t,n,t,t,t,t,t,n,t,t,t,n],[t,n,t,n,t,t,i,t,i,t,t,n,t,n,t],[e,e,e,t,t,i,t,t,t,i,t,t,e,e,e],[e,e,e,e,e,e,i,t,i,e,e,e,e,e,e]],0,we.of(0,0),we.of(0,0))}applyLegalMove(t,e,n,i){return Ol.isTileExchange(t)?this.applyLegalTileExchange(t,e):this.applyLegalMovement(t,e)}applyLegalTileExchange(t,e){const n=e.getCopiedBoard(),i=t.coord;n[i.y][i.x]=Pe.EMPTY;const o=e.getCurrentPlayer(),s=e.captures.getCopy();s.add(o,1);const a=e.tiles.getCopy();a.add(o,-2);const l=new Ti(n,e.turn,a,s).removeTilesIfNeeded(i,!1);return new Ti(l.getCopiedBoard(),l.turn+1,l.tiles,l.captures)}applyLegalMovement(t,e){const o=e.applyLegalMovement(t).removeTilesIfNeeded(t.getStart(),!0).doMovementCaptures(t);return new Ti(o.board,e.turn+1,o.tiles,o.captures)}isLegal(t,e){return Ol.isTileExchange(t)?this.isLegalTileExchange(t,e):this.isLegalMovement(t,e)}isLegalTileExchange(t,e){if(e.tiles.get(e.getCurrentPlayer())<2)return w.failure(Sd.NOT_ENOUGH_TILES_TO_EXCHANGE());const n=e.getPieceAt(t.coord);return n===Pe.UNREACHABLE||n===Pe.EMPTY?w.failure(Sd.CANNOT_CAPTURE_FROM_EMPTY()):n.is(e.getCurrentPlayer())?w.failure(Ee.CANNOT_SELF_CAPTURE()):w.SUCCESS}isLegalMovement(t,e){L.assert(e.getPieceAt(t.getStart())!==Pe.UNREACHABLE,"Cannot start with a coord outside the board "+t.getStart().toString()+"."),L.assert(e.getPieceAt(t.getEnd())!==Pe.UNREACHABLE,"Cannot end with a coord outside the board "+t.getEnd().toString()+".");const n=e.getPieceAt(t.getStart());return n===Pe.EMPTY?w.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):n.is(e.getCurrentOpponent())?w.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT()):e.getPieceAt(t.getEnd()).is(e.getCurrentPlayer())?w.failure(Ee.MUST_LAND_ON_EMPTY_SPACE()):w.SUCCESS}getGameStatus(t){const e=t.gameState;return 18<=e.captures.get(O.ZERO)?ye.ZERO_WON:18<=e.captures.get(O.ONE)?ye.ONE_WON:ye.ONGOING}};Od=cu=function(r,t,e,n){var s,i=arguments.length,o=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,e):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,t,e,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(t,e,o):s(t,e))||o);return i>3&&o&&Object.defineProperty(t,e,o),o}([Ae.log],Od);const ee=Pe.EMPTY,k=Pe.UNREACHABLE,s1=Pe.ZERO,bn=Pe.ONE;class Vke extends Wn{tutorial=[W.informational($localize`Board and goal of the game`,$localize`Coerceo is played on a board like this, composed of hexagonal tiles, each comprising 6 triangles.
         The triangles are the spaces on which pieces move during the game.
         The tiles can be removed from the board (you will see how later).
         The dark pieces belong to the first player and can only move on the dark spaces,
         while the light pieces belong to the second player and can only move on the light spaces.
         The goal of the game is to capture all of the opponent's pieces.`,Od.get().getInitialState()),W.anyMove($localize`Move`,$localize`To move a piece, you need to:
        <ol>
          <li>Click on one of your pieces.</li>
          <li>Click on one of the triangular space highlighted in yellow.</li>
        </ol>
        You can pass through the opponent's pieces.<br/><br/>
        You're playing first, hence you're playing Dark.
        Perform any move.`,Od.get().getInitialState(),y2.of(new _(3,5),new _(5,5)),$localize`Congratulations! Let's see captures now.`),W.fromMove($localize`Captures`,$localize`Every piece has three neighboring triangular spaces (2 on the sides).
        When all neighboring spaces except one are occupied, and one opponent moves to that last free space, your piece is captured!
        However, it is possible to place a piece between 3 of the opponent's pieces (or 2 on the side) without being captured.<br/><br/>
        You're playing Light, make a capture.`,new Ti([[k,k,k,k,k,k,s1,ee,s1,k,k,k,k,k,k],[k,k,k,s1,ee,ee,ee,ee,ee,s1,ee,ee,k,k,k],[ee,bn,ee,bn,s1,bn,ee,ee,s1,ee,ee,bn,ee,bn,ee],[bn,ee,ee,ee,ee,ee,ee,ee,ee,ee,bn,ee,ee,ee,bn],[ee,bn,ee,bn,ee,ee,ee,ee,ee,ee,ee,bn,ee,bn,ee],[ee,s1,ee,s1,ee,ee,ee,ee,ee,ee,ee,s1,ee,s1,ee],[s1,ee,ee,ee,s1,ee,ee,ee,ee,ee,s1,ee,ee,ee,s1],[ee,s1,ee,s1,ee,ee,bn,ee,bn,ee,ee,s1,ee,s1,ee],[k,k,k,ee,ee,bn,ee,ee,ee,bn,ee,ee,k,k,k],[k,k,k,k,k,k,bn,ee,bn,k,k,k,k,k,k]],3,we.of(0,0),we.of(0,0)),[y2.of(new _(5,2),new _(4,1)),y2.of(new _(3,4),new _(4,3))],pe.CONGRATULATIONS(),$localize`Failed, you have not captured any piece.`),W.fromMove($localize`Gain a tile`,$localize`When a tile is empty, it can become removable from the board.
        For it to be removable, at least three of its sides must be free, and these should be neighboring sides.
        Note that if one empty tile, neighboring a tile that was just removed, also becomes removable, it will be removed too.
        For example, here, the topmost dark piece will not disconnect its tile when leaving it.
        But, by leaving the bottom left tile, two tiles will be removed.<br/><br/>
        You're playing Dark, perform a move that lets you gain two tiles.`,new Ti([[k,k,k,k,k,k,ee,ee,ee,k,k,k,k,k,k],[k,k,k,k,k,k,bn,ee,ee,k,k,k,k,k,k],[ee,ee,ee,k,k,k,ee,ee,ee,k,k,k,k,k,k],[ee,ee,bn,ee,ee,ee,ee,s1,ee,k,k,k,k,k,k],[ee,ee,ee,bn,ee,ee,ee,ee,ee,k,k,k,k,k,k],[ee,ee,ee,ee,ee,ee,ee,ee,ee,ee,ee,s1,k,k,k],[ee,ee,s1,ee,ee,bn,ee,ee,ee,ee,s1,ee,ee,ee,s1],[ee,ee,ee,ee,ee,ee,bn,ee,bn,ee,ee,s1,ee,s1,ee],[k,k,k,ee,ee,bn,ee,ee,ee,bn,ee,ee,k,k,k],[k,k,k,k,k,k,bn,ee,bn,k,k,k,k,k,k]],2,we.of(0,0),we.of(0,0)),[y2.of(new _(2,6),new _(4,6)),y2.of(new _(2,6),new _(3,5)),y2.of(new _(2,6),new _(3,7))],pe.CONGRATULATIONS(),$localize`Failed, you have not gained the two tiles that you could, try again!`),W.fromMove($localize`Exchanging a tile`,$localize`When you have a tile, you can see it on the left of the board.
        As soon as you have two, you can click on an opponent's piece to capture it immediately instead of moving one of your pieces.
        This will cost you two tiles.
        If any tiles are removed during that turn, nobody will get them.<br/><br/>
        You're playing Light, gain some time and capture the last piece to win directly!`,new Ti([[k,k,k,k,k,k,k,k,k,k,k,k,k,k,k],[k,k,k,k,k,k,k,k,k,k,k,k,k,k,k],[k,k,k,k,k,k,k,k,k,k,k,k,k,k,k],[k,k,k,k,k,k,k,k,k,k,k,k,k,k,k],[k,k,k,k,k,k,k,k,k,k,k,k,k,k,k],[k,k,k,ee,ee,s1,k,k,k,k,k,k,k,k,k],[k,k,k,ee,ee,ee,ee,ee,ee,k,k,k,k,k,k],[k,k,k,ee,ee,ee,bn,ee,bn,k,k,k,k,k,k],[k,k,k,ee,ee,bn,ee,ee,ee,k,k,k,k,k,k],[k,k,k,k,k,k,bn,ee,bn,k,k,k,k,k,k]],1,we.of(0,2),we.of(0,0)),[Sl.of(new _(5,5))],pe.CONGRATULATIONS(),$localize`It's nice to move a piece, but you could have had the opponent's piece immediately by clicking on it!`),W.fromMove($localize`Special capture`,$localize`When a tile is removed from the board during your turn, some of the opponent's pieces may have lost their last free neighboring space, they will therefore be captured!
        If this happens to one of your piece during your turn, it will however stay on the board.<br/><br/>
        A move that demonstrates both of these things can be done on this board by Light. Try it!`,new Ti([[k,k,k,k,k,k,k,k,k,k,k,k,k,k,k],[k,k,k,k,k,k,k,k,k,k,k,k,k,k,k],[k,k,k,k,k,k,k,k,k,k,k,k,k,k,k],[k,k,k,k,k,k,k,k,k,k,k,k,k,k,k],[k,k,k,k,k,k,ee,ee,s1,k,k,k,k,k,k],[k,k,k,ee,ee,s1,ee,ee,ee,k,k,k,k,k,k],[k,k,k,ee,s1,bn,ee,bn,ee,k,k,k,k,k,k],[k,k,k,ee,bn,s1,ee,ee,ee,k,k,k,k,k,k],[k,k,k,ee,ee,bn,k,k,k,k,k,k,k,k,k],[k,k,k,k,k,k,k,k,k,k,k,k,k,k,k]],1,we.of(0,0),we.of(0,0)),[y2.of(new _(7,6),new _(6,5)),y2.of(new _(7,6),new _(8,5))],$localize`Congratulations! See, your piece no longer had any empty neighboring space after you have gained the tile, but it stayed on the board as it was your turn.
        However, the opponent's piece has disappeared because the tile's capture has removed its last empty neighboring space.`,pe.FAILED_TRY_AGAIN())]}class aJ extends Kn{getListMoves(t,e){return t.gameState.turn<40?this.getListMovesDrop(t.gameState):this.getListMovesAfterDrop(t.gameState)}getListMovesDrop(t){const e=[],n=P1.CENTRAL_ZONE_TOP_LEFT,i=P1.CENTRAL_ZONE_BOTTOM_RIGHT;for(let o=n.y;o<=i.y;o++)for(let s=n.x;s<=i.x;s++)t.getPieceAtXY(s,o)===B.NONE&&e.push(Ml.of(new _(s,o)));return e}getListMovesAfterDrop(t){let e=[];const n=t.getCurrentPlayer();for(const i of t.getCoordsAndContents())i.content===n&&(e=e.concat(this.getListSimpleMoves(t,i.coord)),e=e.concat(this.getListJumps(t,i.coord)));return e}getListSimpleMoves(t,e){const n=[],i=[new _(e.x+1,e.y),new _(e.x-1,e.y),new _(e.x,e.y+1),new _(e.x,e.y-1),new _(e.x+1,e.y+1),new _(e.x+1,e.y-1),new _(e.x-1,e.y+1),new _(e.x-1,e.y-1)].filter(o=>t.isOnBoard(o));for(const o of i){const s=El.from(e,o);s.isSuccess()&&Ho.get().simpleMoveLegality(s.get(),t).isSuccess()&&n.push(s.get())}return n}getListJumps(t,e){const n=new st;for(const i of Ho.get().jumpTargetsFrom(t,e)){const o=Ua.from([e,i]).get();Ho.get().jumpLegality(o,t).isSuccess()&&(n.add(o),n.addAll(this.getListJumpStartingFrom(t,o)))}return n.toList()}getListJumpStartingFrom(t,e){const n=Ho.get().nextJumps(e,t),i=new st(n);for(const o of n)i.addAll(this.getListJumpStartingFrom(t,o));return i}}class Hke extends rr{getMetrics(t,e){const n=t.gameState,i=G1.of([0,0],[0,0]);for(const a of n.getCoordsAndContents()){const c=a.coord,l=a.content;if(l.isPlayer())if(n.isShelter(c))i.add(l,0,1);else{let u=n.getWidth()+n.getHeight();for(const f of P1.ALL_SHELTERS)if(n.getPieceAt(f)===B.NONE){const g=c.getOrthogonalDistance(f);u=Math.min(u,g)}i.add(l,1,-u)}}return i}}class Fke extends aJ{getListMoves(t,e){return this.sortByNumberOfJumps(super.getListMoves(t,e))}sortByNumberOfJumps(t){return t.sort((e,n)=>{const i=Oi.isDrop(e)?1:Oi.isSimple(e)?2:e.coords.length;return(Oi.isDrop(n)?1:Oi.isSimple(n)?2:n.coords.length)-i})}}class Uke extends fn{constructor(){super($localize`Jump`,Ho.get(),new Hke,new Fke)}}function Gke(r,t){if(1&r){const e=he();I(),E(0,"rect",9),q("click",function(){te(e);const i=p().$implicit;return ne(p(2).onClick(i.coord))}),P()}if(2&r){const e=p().$implicit,n=p(2);A("x",1.5*n.STROKE_WIDTH+n.SPACE_SIZE*e.coord.x+n.STROKE_WIDTH)("y",1.5*n.STROKE_WIDTH+n.SPACE_SIZE*e.coord.y+n.STROKE_WIDTH)("width",n.SPACE_SIZE-3*n.STROKE_WIDTH)("height",n.SPACE_SIZE-3*n.STROKE_WIDTH)}}function Bke(r,t){if(1&r){const e=he();I(),E(0,"circle",6),q("click",function(){te(e);const i=p().$implicit;return ne(p(2).onClick(i.coord))}),P()}if(2&r){const e=p(),n=e.index,i=e.$implicit,o=p().index,s=p();ve("id","piece_",n,"_",o,""),v("ngClass",i.pieceClasses),A("r",s.PIECE_RADIUS)("cx",s.SPACE_SIZE*n+s.STROKE_WIDTH+s.SPACE_SIZE/2)("cy",s.SPACE_SIZE*o+s.STROKE_WIDTH+s.SPACE_SIZE/2)}}function $ke(r,t){if(1&r){const e=he();I(),E(0,"g")(1,"rect",6),q("click",function(){const o=te(e).$implicit;return ne(p(2).onClick(o.coord))}),P(),z(2,Gke,1,4,"rect",7)(3,Bke,1,6,"circle",8),P()}if(2&r){const e=t.$implicit,n=t.index,i=p().index,o=p();m(),ve("id","click_",n,"_",i,""),v("ngClass",e.squareClasses),A("x",o.SPACE_SIZE*n+o.STROKE_WIDTH)("y",o.SPACE_SIZE*i+o.STROKE_WIDTH)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),m(),v("ngIf",e.isShelter),m(),v("ngIf",e.hasPieceToDraw)}}function Wke(r,t){if(1&r&&(I(),E(0,"g"),z(1,$ke,4,9,"g",1),P()),2&r){const e=t.$implicit;m(),v("ngForOf",e)}}function qke(r,t){if(1&r){const e=he();I(),E(0,"g")(1,"rect",10),q("click",function(){const o=te(e).$implicit;return ne(p().onClick(o))}),P()()}if(2&r){const e=t.$implicit,n=p();m(),v("ngClass",n.viewInfo.boardInfo[e.y][e.x].shelterClasses),A("x",n.SPACE_SIZE*e.x+2.5*n.STROKE_WIDTH)("y",n.SPACE_SIZE*e.y+2.5*n.STROKE_WIDTH)("width",n.SPACE_SIZE-3*n.STROKE_WIDTH)("height",n.SPACE_SIZE-3*n.STROKE_WIDTH)}}function jke(r,t){if(1&r&&(I(),V(0,"circle",11)),2&r){const e=t.$implicit,n=p();Tn("id","sidePiece_0_",e,""),A("cx",-n.PIECE_RADIUS)("cy",1670-e*n.PIECE_RADIUS)("r",n.PIECE_RADIUS-5)}}function Zke(r,t){if(1&r&&(I(),V(0,"circle",12)),2&r){const e=t.$implicit,n=p();Tn("id","sidePiece_1_",e,""),A("cx",1715+n.PIECE_RADIUS)("cy",1670-e*n.PIECE_RADIUS)("r",n.PIECE_RADIUS-5)}}function Yke(r,t){if(1&r&&(I(),V(0,"rect",13)),2&r){const e=p();A("x",e.SPACE_SIZE*e.CENTRAL_ZONE_START.x+e.STROKE_WIDTH)("y",e.SPACE_SIZE*e.CENTRAL_ZONE_START.y+e.STROKE_WIDTH)("width",e.CENTRAL_ZONE_SIZE.x*e.SPACE_SIZE)("height",e.CENTRAL_ZONE_SIZE.y*e.SPACE_SIZE)}}let Kke=(()=>{class r extends Fc{PIECE_RADIUS;ALL_SHELTERS=P1.ALL_SHELTERS;CENTRAL_ZONE_START=P1.CENTRAL_ZONE_TOP_LEFT;CENTRAL_ZONE_SIZE=new Gt(P1.CENTRAL_ZONE_BOTTOM_RIGHT.x-P1.CENTRAL_ZONE_TOP_LEFT.x+1,P1.CENTRAL_ZONE_BOTTOM_RIGHT.y-P1.CENTRAL_ZONE_TOP_LEFT.y+1);viewInfo={dropPhase:!0,boardInfo:[],victory:[],lastMoveArrow:"",sidePieces:we.of(20,20)};selected=h.empty();jumpInConstruction=h.empty();constructor(e){super(e),this.setRulesAndNode("Conspirateurs"),this.availableAIs=[new Uke,new zn($localize`MCTS`,new aJ,this.rules)],this.encoder=Oi.encoder,this.PIECE_RADIUS=this.SPACE_SIZE/2-this.STROKE_WIDTH}updateBoard(e){var n=this;return M(function*(){n.updateViewInfo()})()}updateViewInfo(){const e=this.getState();this.viewInfo.dropPhase=e.isDropPhase(),this.viewInfo.boardInfo=[],this.viewInfo.lastMoveArrow="";for(let n=0;n<e.getHeight();n++){this.viewInfo.boardInfo.push([]);for(let i=0;i<e.getWidth();i++){const o=new _(i,n),s=e.getPieceAt(o),a={coord:o,squareClasses:[],shelterClasses:["no-fill"],pieceClasses:[this.getPlayerClass(s)],hasPieceToDraw:s.isPlayer(),isShelter:!1,isOccupiedShelter:!1};this.viewInfo.boardInfo[n].push(a)}}this.viewInfo.sidePieces=e.getSidePieces(),this.updateSelected(),this.updateShelterHighlights()}updateSelected(){if(this.selected.isPresent())if(this.jumpInConstruction.isPresent()){const e=this.jumpInConstruction.get(),n=e.getStartingCoord(),i=e.getEndingCoord();this.viewInfo.boardInfo[n.y][n.x].hasPieceToDraw=!1,this.viewInfo.boardInfo[i.y][i.x].pieceClasses=[this.getPlayerClass(this.getCurrentPlayer()),"selected-stroke"],this.viewInfo.boardInfo[i.y][i.x].hasPieceToDraw=!0;for(const o of e.coords)this.viewInfo.boardInfo[o.y][o.x].squareClasses.push("moved-fill")}else{const e=this.selected.get();this.viewInfo.boardInfo[e.y][e.x].pieceClasses.push("selected-stroke")}}updateShelterHighlights(){const e=this.getState(),n=Ho.get().getGameStatus(this.node),i=!0===n.isEndGame;for(const o of P1.ALL_SHELTERS){const s=this.viewInfo.boardInfo[o.y][o.x],a=e.getPieceAt(o),c=!1===i&&a.isPlayer();(i&&a===n.winner||c)&&(s.shelterClasses.push("selectable-stroke"),s.pieceClasses.push("victory-stroke"),s.squareClasses.push("victory-fill"))}}showLastMove(e){var n=this;return M(function*(){if(Oi.isDrop(e))n.viewInfo.boardInfo[e.coord.y][e.coord.x].squareClasses.push("moved-fill");else if(Oi.isSimple(e))n.viewInfo.boardInfo[e.getStart().y][e.getStart().x].squareClasses.push("moved-fill"),n.viewInfo.boardInfo[e.getEnd().y][e.getEnd().x].squareClasses.push("moved-fill");else{n.viewInfo.lastMoveArrow="";for(const i of e.coords)n.viewInfo.boardInfo[i.y][i.x].squareClasses.push("moved-fill"),n.viewInfo.lastMoveArrow+=i.x*n.SPACE_SIZE+n.SPACE_SIZE/2+n.STROKE_WIDTH,n.viewInfo.lastMoveArrow+=" ",n.viewInfo.lastMoveArrow+=i.y*n.SPACE_SIZE+n.SPACE_SIZE/2+n.STROKE_WIDTH,n.viewInfo.lastMoveArrow+=" "}})()}hideLastMove(){}cancelMoveAttempt(){var e=this;return M(function*(){e.jumpInConstruction=h.empty(),e.selected=h.empty(),yield e.updateBoard(!1)})()}onClick(e){var n=this;return M(function*(){const i=yield n.canUserPlay("#click_"+e.x+"_"+e.y);if(i.isFailure())return n.cancelMove(i.getReason());const o=n.getState(),s=o.getPieceAt(e);if(o.getPieceAt(e)===n.getCurrentPlayer())return n.selected.equalsValue(e)?yield n.cancelMoveAttempt():(n.selected=h.of(e),n.jumpInConstruction=h.empty()),n.updateViewInfo(),w.SUCCESS;if(n.jumpInConstruction.isPresent())return n.constructJump(e);if(n.selected.isPresent())return n.selectNextCoord(e);if(o.isDropPhase()){const a=Ml.of(e);return n.chooseMove(a)}return n.cancelMove(s===B.NONE?Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY():Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT())})()}constructJump(e){var n=this;return M(function*(){const i=n.jumpInConstruction.get(),o=n.getState();if(e.equals(i.getEndingCoord()))return n.chooseMove(i);{const s=i.addJump(e);if(s.isFailure())return n.cancelMove(s.getReason());const a=n.rules.jumpLegality(s.get(),o);return a.isFailure()?n.cancelMove(a.getReason()):n.updateJump(s.get())}})()}updateJump(e){var n=this;return M(function*(){const i=n.getState();return n.rules.jumpHasPossibleNextTargets(e,i)?(n.jumpInConstruction=h.of(e),n.updateViewInfo(),w.SUCCESS):n.chooseMove(e)})()}selectNextCoord(e){var n=this;return M(function*(){const i=n.selected.get(),o=El.from(i,e);if(o.isSuccess())return n.chooseMove(o.get());{const s=Ua.from([i,e]);return s.isFailure()?n.cancelMove(s.getReason()):n.updateJump(s.get())}})()}static \u0275fac=function(n){return new(n||r)(G(Ut))};static \u0275cmp=Ue({type:r,selectors:[["app-conspirateurs"]],features:[$e],decls:7,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-100 0 1915 1715","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base mid-stroke player0-fill",3,"id",4,"ngFor","ngForOf"],["class","base mid-stroke player1-fill",3,"id",4,"ngFor","ngForOf"],["class","base no-fill selectable-stroke big-stroke",4,"ngIf"],["id","lastJump",1,"base","no-fill"],[1,"base",3,"id","ngClass","click"],["class","base no-fill mid-stroke",3,"click",4,"ngIf"],["class","base",3,"id","ngClass","click",4,"ngIf"],[1,"base","no-fill","mid-stroke",3,"click"],[1,"base","no-fill","mid-stroke",3,"ngClass","click"],[1,"base","mid-stroke","player0-fill",3,"id"],[1,"base","mid-stroke","player1-fill",3,"id"],[1,"base","no-fill","selectable-stroke","big-stroke"]],template:function(n,i){1&n&&(I(),E(0,"svg",0),z(1,Wke,2,1,"g",1)(2,qke,2,5,"g",1)(3,jke,1,4,"circle",2)(4,Zke,1,4,"circle",3)(5,Yke,1,4,"rect",4),V(6,"polyline",5),P()),2&n&&(m(),v("ngForOf",i.viewInfo.boardInfo),m(),v("ngForOf",i.ALL_SHELTERS),m(),v("ngForOf",i.ArrayUtils.range(i.viewInfo.sidePieces.get(i.Player.ZERO))),m(),v("ngForOf",i.ArrayUtils.range(i.viewInfo.sidePieces.get(i.Player.ONE))),m(),v("ngIf",i.viewInfo.dropPhase),m(),A("points",i.viewInfo.lastMoveArrow))},dependencies:[zt,Nt,bt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}return r})(),l0=(()=>class r{static CANNOT_MOVE_WITH_BALL=()=>$localize`You cannot move the piece holding the ball.`;static MUST_MOVE_BY_ONE_ORTHOGONAL_SPACE=()=>$localize`You must move by exactly one orthogonal space.`;static PASS_PATH_OBSTRUCTED=()=>$localize`The path of this pass is obstructed.`;static PASS_MUST_BE_IN_STRAIGHT_LINE=()=>$localize`A pass must be done in a straight line, orthogonally or diagonally.`;static CAN_ONLY_DO_ONE_PASS=()=>$localize`You can only perform one pass per turn.`;static CAN_ONLY_TRANSLATE_TWICE=()=>$localize`You can only perform two translations per turn, not three.`;static CANNOT_PASS_TO_OPPONENT=()=>$localize`You cannot pass the ball to the opponent. You must pick one of your pieces.`})();class Fo extends Do{static encoder=G2.getFallibleEncoder(Fo.from);static from(t,e){return me.factory.fromMove(t,e).isFailure()?X.failure(l0.PASS_MUST_BE_IN_STRAIGHT_LINE()):X.success(new Fo(t,e))}constructor(t,e){super(t,e)}equals(t){return t instanceof Fo&&super.equals(t)}}class B2 extends Do{static encoder=G2.getFallibleEncoder(B2.from);static from(t,e){return t.getVectorToward(e).isSingleOrthogonalStep()?X.success(new B2(t,e)):X.failure(l0.MUST_MOVE_BY_ONE_ORTHOGONAL_SPACE())}constructor(t,e){super(t,e)}equals(t){return t instanceof B2&&super.equals(t)}}function RI(r){return r instanceof B2}function Xke(r){return r instanceof Fo}class $2 extends h2{first;second;third;static subMoveEncoder=ke.disjunction([RI,Xke],[B2.encoder,Fo.encoder]);static subMoveOptionalEncoder=h.getEncoder($2.subMoveEncoder);static encoder=ke.tuple([$2.subMoveEncoder,$2.subMoveOptionalEncoder,$2.subMoveOptionalEncoder],t=>[t.first,t.second,t.third],t=>new $2(t[0],t[1],t[2]));static countPassesAndTranslations(t,e){t instanceof Fo?e.passes++:e.translations++}constructor(t,e,n){super(),this.first=t,this.second=e,this.third=n,n.isPresent()&&L.assert(e.isPresent(),"DiaballikMove should have two first actions to have a third one");const i={passes:0,translations:0};$2.countPassesAndTranslations(t,i),e.isPresent()&&$2.countPassesAndTranslations(e.get(),i),n.isPresent()&&$2.countPassesAndTranslations(n.get(),i),L.assert(i.passes<=1,"DiaballikMove should have at most one pass"),L.assert(i.translations<=2,"DiaballikMove should have at most two translations")}toString(){return`DiaballikMove(${this.first.toString()}, ${this.second.toString()}, ${this.third.toString()})`}equals(t){return!(!1===this.first.equals(t.first)||!1===this.second.equals(t.second)||!1===this.third.equals(t.third))}getSubMoves(){const t=[this.first];return this.second.isPresent()&&t.push(this.second.get()),this.third.isPresent()&&t.push(this.third.get()),t}}class Wi{owner;holdsBall;static NONE=new Wi(B.NONE,!1);static ZERO=new Wi(O.ZERO,!1);static ZERO_WITH_BALL=new Wi(O.ZERO,!0);static ONE=new Wi(O.ONE,!1);static ONE_WITH_BALL=new Wi(O.ONE,!0);constructor(t,e){this.owner=t,this.holdsBall=e}equals(t){return this===t}}class lu extends B1{equals(t){return rt.compare(this.board,t.board)}}class cJ{winner;constructor(t){this.winner=t}}class xI extends cJ{coord;constructor(t,e){super(t),this.coord=e}}class lJ extends cJ{allLoserPieces;opponentPiecesInContact;constructor(t,e,n){super(t.getOpponent()),this.allLoserPieces=e,this.opponentPiecesInContact=n}}class vs extends Ar{static singleton=h.empty();static get(){return vs.singleton.isAbsent()&&(vs.singleton=h.of(new vs)),vs.singleton.get()}getInitialState(){const t=Wi.ZERO,n=Wi.ONE,o=Wi.NONE;return new lu([[n,n,n,Wi.ONE_WITH_BALL,n,n,n],[o,o,o,o,o,o,o],[o,o,o,o,o,o,o],[o,o,o,o,o,o,o],[o,o,o,o,o,o,o],[o,o,o,o,o,o,o],[t,t,t,Wi.ZERO_WITH_BALL,t,t,t]],0)}isLegal(t,e){let n=e;for(const i of t.getSubMoves()){const o=i.getStart();if(!1===e.isOnBoard(o))return X.failure(uo.OUT_OF_RANGE(o));const s=i.getEnd();if(!1===e.isOnBoard(s))return X.failure(uo.OUT_OF_RANGE(s));const a=this.isLegalSubMove(n,i);if(a.isFailure())return a;n=a.get()}return X.success(n)}isLegalSubMove(t,e){return e instanceof B2?this.isLegalTranslation(t,e):this.isLegalPass(t,e)}isLegalTranslation(t,e){const n=e.getStart(),i=t.getPieceAt(n);if(i.owner===B.NONE)return X.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(i.owner===t.getCurrentOpponent())return X.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT());if(!0===i.holdsBall)return X.failure(l0.CANNOT_MOVE_WITH_BALL());const o=e.getEnd();if(t.getPieceAt(o).owner.isPlayer())return X.failure(Ee.MUST_LAND_ON_EMPTY_SPACE());const s=t.getCopiedBoard();s[n.y][n.x]=Wi.NONE,s[o.y][o.x]=i;const a=new lu(s,t.turn);return X.success(a)}isLegalPass(t,e){const n=e.getStart(),i=t.getPieceAt(n);if(i.owner===B.NONE)return X.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(i.owner===t.getCurrentOpponent())return X.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT());L.assert(i.holdsBall,"DiaballikRules: cannot pass without the ball");const o=e.getEnd(),s=t.getPieceAt(o);if(s.owner===B.NONE)return X.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(s.owner===t.getCurrentOpponent())return X.failure(l0.CANNOT_PASS_TO_OPPONENT());const a=me.factory.fromMove(n,o).get();for(let g=n.getNext(a);!1===g.equals(o);g=g.getNext(a))if(t.getPieceAt(g)!==Wi.NONE)return X.failure(l0.PASS_PATH_OBSTRUCTED());const l=t.getCopiedBoard(),u=l[n.y][n.x];return l[n.y][n.x]=l[o.y][o.x],l[o.y][o.x]=u,X.success(new lu(l,t.turn))}applyLegalMove(t,e,n,i){return new lu(i.board,e.turn+1)}getGameStatus(t){const n=this.getVictoryOrDefeatCoords(t.gameState);return n.isPresent()?ye.getVictory(n.get().winner):ye.ONGOING}getVictoryOrDefeatCoords(t){const e=this.getBallCoordInRow(t,0,O.ZERO);if(e.isPresent())return h.of(new xI(O.ZERO,e.get()));const n=this.getBallCoordInRow(t,t.getHeight()-1,O.ONE);return n.isPresent()?h.of(new xI(O.ONE,n.get())):this.getBlockerAndCoords(t)}getBallCoordInRow(t,e,n){for(let i=0;i<t.getHeight();i++){const o=t.getPieceAtXY(i,e);if(!0===o.holdsBall&&o.owner===n)return h.of(new _(i,e))}return h.empty()}getBlockerAndCoords(t){const e=Q3.ofValues(this.getBlockerCoords(t,O.ZERO),this.getBlockerCoords(t,O.ONE));return e.get(O.ZERO).isPresent()&&e.get(O.ONE).isPresent()?e.get(t.getCurrentPlayer()):e.get(O.ZERO).isPresent()?e.get(O.ZERO):e.get(O.ONE).isPresent()?e.get(O.ONE):h.empty()}getBlockerCoords(t,e){const n=new st,i=[];for(let o=0;o<t.getWidth();o++){const s=this.getConnectedPieceCoord(o,n,t,e);if(!s.isPresent())return h.empty();i.push(s.get())}return n.size()>=3?h.of(new lJ(e,i,n.toList())):h.empty()}getConnectedPieceCoord(t,e,n,i){for(let o=0;o<n.getHeight();o++){const s=new _(t,o);if(n.getPieceAt(s).owner===i)return this.isConnectedOnTheLeft(s,n,i)?(this.addConnectedOpponents(s,e,n,i),h.of(s)):h.empty()}return h.empty()}isConnectedOnTheLeft(t,e,n){if(0===t.x)return!0;for(const i of[me.LEFT,me.UP_LEFT,me.DOWN_LEFT]){const o=t.getNext(i);if(e.isOnBoard(o)&&e.getPieceAt(o).owner===n)return!0}return!1}addConnectedOpponents(t,e,n,i){for(const o of Ie.factory.all){const s=t.getNext(o);n.isOnBoard(s)&&n.getPieceAt(s).owner===i.getOpponent()&&e.add(s)}}}class Qke extends rr{getMetrics(t,e){const n=t.gameState,i=new G1;for(const o of n.getCoordsAndContents()){const s=o.content;s.holdsBall&&(s.owner===O.ZERO?i.set(O.ZERO,[n.getHeight()-1-o.coord.y]):i.set(O.ONE,[o.coord.y]))}return i}}class uJ extends fn{constructor(t,e){super(t,vs.get(),new Qke,e)}}class uu{subMoves;stateBefore;stateAfterSubMoves;hasPass;translations;static finalize(t){return t.finalize()}constructor(t,e,n){this.subMoves=t,this.stateBefore=e,this.stateAfterSubMoves=n,L.assert(this.subMoves.length<=3,"DiaballikMoveInConstruction can have at most 3 submoves");let i=!1,o=0;for(const s of t)s instanceof Fo?(L.assert(!1===i,"DiaballikMoveInConstruction can have at most one pass"),i=!0):(L.assert(o<2,"DiaballikMoveInConstruction can have at most two translations"),o++);this.hasPass=i,this.translations=o}equals(t){return yt.equals(this.subMoves,t.subMoves)}addIfLegal(t,e){const n=vs.get().isLegalSubMove(this.stateAfterSubMoves,t);if(n.isSuccess()){const i=this.subMoves.concat([t]);this.sortIfNeeded(i);const o=new uu(i,this.stateBefore,n.get());e.push(o)}}sortIfNeeded(t){const e=this.getFirstTranslationIndex(t);if(e.isAbsent())return;const n=e.get();if(n+1>=t.length||!1===RI(t[n+1]))return;const i=t[n],o=new st(i.getCoords()),s=t[n+1],a=new st(s.getCoords());o.intersection(a).size()>0||i.getStart().compareTo(s.getStart())>0&&(t[n]=s,t[n+1]=i)}getFirstTranslationIndex(t){for(let e=0;e<t.length;e++)if(RI(t[e]))return h.of(e);return h.empty()}getPassEnd(){for(const t of this.subMoves)if(t instanceof Fo)return h.of(t.getEnd());return h.empty()}passPathContains(t){for(const e of this.subMoves)if(e instanceof Fo)return e.getStart().getCoordsToward(e.getEnd()).some(i=>i.equals(t));return!1}getPreviousTranslation(){for(const t of this.subMoves)if(t instanceof B2)return h.of(t);return h.empty()}hasOppositeTranslation(t,e){if(this.translations>0){const n=this.getPreviousTranslation().get();return n.getStart().equals(e)&&n.getEnd().equals(t)}return!1}finalize(){L.assert(this.subMoves.length>0,"DiaballikMoveInConstruction can only be finalized if it contains something");const t=this.subMoves[0];let e=h.empty();this.subMoves.length>1&&(e=h.of(this.subMoves[1]));let n=h.empty();this.subMoves.length>2&&(n=h.of(this.subMoves[2]));const i=new $2(t,e,n);return L.assert(vs.get().isLegal(i,this.stateBefore).isSuccess(),"DiaballikMoveGenerator should only generate legal moves"),i}}class NC extends Kn{avoidDuplicates;constructor(t=!0){super(),this.avoidDuplicates=t}getListMoves(t,e){let i=[new uu([],t.gameState,t.gameState)];const o=new st;for(let s=0;s<3;s++){let a=[];for(const c of i){const l=this.addAllPossibleSubMoves(c);o.addAll(new st(l.map(uu.finalize))),a=a.concat(l)}i=a}return this.removeDuplicates(t.gameState,o,e)}removeDuplicates(t,e,n){if(!1===this.avoidDuplicates)return e.toList();const i=new st,o=[],s=vs.get();for(const a of e){const c=vs.get().isLegal(a,t),l=s.applyLegalMove(a,t,n,c.get());!1===i.contains(l)&&(o.push(a),i.add(l))}return o}addAllPossibleSubMoves(t){const e=t.stateAfterSubMoves,n=e.getCurrentPlayer(),i=[];for(const o of e.getCoordsAndContents()){const s=o.coord,a=o.content;if(a.owner===n)if(a.holdsBall&&!1===t.hasPass)for(const c of this.getPassEnds(e,o.coord)){const l=Fo.from(s,c).get();t.addIfLegal(l,i)}else if(t.translations<2)for(const l of this.getTranslationEnds(e,o.coord))if(!1===t.hasOppositeTranslation(o.coord,l)||!1===this.avoidDuplicates){let f=!0;if(t.hasPass){const g=t.getPassEnd().equalsValue(s),y=t.passPathContains(l);f=g||y}if(f||!1===this.avoidDuplicates){const g=B2.from(s,l).get();t.addIfLegal(g,i)}}}return i}getPassEnds(t,e){const n=t.getCurrentPlayer(),i=[];for(const o of me.factory.all){let s=e.getNext(o);for(;t.isOnBoard(s);){const a=t.getPieceAt(s);if(a.owner===n){i.push(s);break}if(a.owner!==B.NONE)break;s=s.getNext(o)}}return i}getTranslationEnds(t,e){const n=[];for(const i of Ie.factory.all){const o=e.getNext(i);t.isOnBoard(o)&&t.getPieceAt(o).owner===B.NONE&&n.push(o)}return n}}class fJ{x1;y1;x2;y2;constructor(t,e,n,i){this.x1=t,this.y1=e,this.x2=n,this.y2=i}}class LI extends NC{moveLength;constructor(t,e=!0){super(e),this.moveLength=t,L.assert(1<=t&&t<=3,"Diaballik moves should be of length [1,3]")}getListMoves(t,e){let i=[new uu([],t.gameState,t.gameState)];for(let o=0;o<this.moveLength;o++){let s=[];for(const a of i)s=s.concat(this.addAllPossibleSubMoves(a));i=s}return i.map(uu.finalize)}}function Jke(r,t){if(1&r&&(I(),V(0,"circle",10)),2&r){const e=p(),n=e.index,i=e.$implicit,o=p().index,s=p();ve("id","piece_",n,"_",o,""),v("ngClass",s.getPieceClasses(n,o,i)),A("r",42)("cx",s.SPACE_SIZE/2)("cy",s.SPACE_SIZE/2)}}function eRe(r,t){if(1&r&&(I(),V(0,"circle",10)),2&r){const e=p(),n=e.index,i=e.$implicit,o=p().index,s=p();ve("id","ball_",n,"_",o,""),v("ngClass",s.getBallClasses(n,o,i)),A("r",22)("cx",s.SPACE_SIZE/2)("cy",s.SPACE_SIZE/2)}}function tRe(r,t){if(1&r){const e=he();I(),E(0,"g",9),q("click",function(){const o=te(e).index,s=p().index;return ne(p().onClick(o,s))}),V(1,"rect",10),z(2,Jke,1,6,"circle",11)(3,eRe,1,6,"circle",11),P()}if(2&r){const e=t.$implicit,n=t.index,i=p().index,o=p();ve("id","click_",n,"_",i,""),A("transform",o.getTranslationXY(n,i)),m(),ve("id","space_",n,"_",i,""),v("ngClass",o.getSpaceClasses(n,i)),A("x",0)("y",0)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),m(),v("ngIf",e.owner.isPlayer()),m(),v("ngIf",e.holdsBall)}}function nRe(r,t){if(1&r&&(I(),E(0,"g"),z(1,tRe,4,12,"g",8),P()),2&r){const e=t.$implicit;m(),v("ngForOf",e)}}function rRe(r,t){if(1&r&&(I(),V(0,"line",12)),2&r){const e=t.$implicit;A("x1",e.x1)("y1",e.y1)("x2",e.x2)("y2",e.y2)}}function iRe(r,t){if(1&r){const e=he();I(),E(0,"rect",13),q("click",function(){const o=te(e).$implicit;return ne(p().onClick(o.x,o.y))}),P()}if(2&r){const e=t.$implicit,n=p();ve("id","indicator_",e.x,"_",e.y,""),A("transform",n.getTranslation(e))("x",n.SPACE_SIZE/2-n.INDICATOR_SIZE/2)("y",n.SPACE_SIZE/2-n.INDICATOR_SIZE/2)("width",n.INDICATOR_SIZE)("height",n.INDICATOR_SIZE)}}function oRe(r,t){if(1&r&&(I(),E(0,"g")(1,"g",14),V(2,"rect",15)(3,"circle",16)(4,"rect",15)(5,"line",17),E(6,"text",18),ot(7),P()(),E(8,"g",19),V(9,"rect",15)(10,"circle",16)(11,"circle",16)(12,"rect",15)(13,"circle",16)(14,"line",17),E(15,"text",20),ot(16),P()()()),2&r){const e=p();m(),A("transform",e.getTranslationXY(0,e.HEIGHT+.3)+" scale(0.5)"),m(),A("x",0)("y",0)("width",e.SPACE_SIZE)("height",e.SPACE_SIZE),m(),v("ngClass",e.getPlayerClass(e.getCurrentPlayer())),A("r",42)("cx",e.SPACE_SIZE/2)("cy",e.SPACE_SIZE/2),m(),A("x",e.SPACE_SIZE)("y",0)("width",e.SPACE_SIZE)("height",e.SPACE_SIZE),m(),A("x1",e.SPACE_SIZE/2)("y1",e.SPACE_SIZE/2)("x2",e.SPACE_SIZE+e.SPACE_SIZE/2)("y2",e.SPACE_SIZE/2),m(),A("x",2.3*e.SPACE_SIZE)("y",e.SPACE_SIZE/2)("font-size",e.SPACE_SIZE/2),m(),Cn(e.translationsMade),m(),A("transform",e.getTranslationXY(e.WIDTH-1,e.HEIGHT+.3)+" scale(0.5)"),m(),A("x",0)("y",0)("width",e.SPACE_SIZE)("height",e.SPACE_SIZE),m(),v("ngClass",e.getPlayerClass(e.getCurrentPlayer())),A("r",42)("cx",e.SPACE_SIZE/2)("cy",e.SPACE_SIZE/2),m(),v("ngClass",e.getPlayerClass(e.getCurrentPlayer())),A("r",22)("cx",e.SPACE_SIZE/2)("cy",e.SPACE_SIZE/2),m(),A("x",e.SPACE_SIZE)("y",0)("width",e.SPACE_SIZE)("height",e.SPACE_SIZE),m(),v("ngClass",e.getPlayerClass(e.getCurrentPlayer())),A("r",42)("cx",e.SPACE_SIZE+e.SPACE_SIZE/2)("cy",e.SPACE_SIZE/2),m(),A("x1",e.SPACE_SIZE/2)("y1",e.SPACE_SIZE/2)("x2",e.SPACE_SIZE+e.SPACE_SIZE/2)("y2",e.SPACE_SIZE/2),m(),A("x",-.6*e.SPACE_SIZE)("y",e.SPACE_SIZE/2)("font-size",e.SPACE_SIZE/2),m(),Cn(e.hasMadePass?1:0)}}function sRe(r,t){if(1&r){const e=he();I(),E(0,"g",21),q("click",function(){return te(e),ne(p().done())}),V(1,"circle",22)(2,"polygon",23),P()}if(2&r){const e=p();A("transform",e.getTranslationXY(e.WIDTH/2,e.HEIGHT+.5)),m(),A("cx",e.STROKE_WIDTH/2)("cy",e.STROKE_WIDTH/2)("r",e.SPACE_SIZE/2.5)}}let aRe=(()=>{class r extends p2{stateInConstruction;WIDTH;HEIGHT;INDICATOR_SIZE=20;victoryCoord=h.empty();loserCoords=[];blockedLines=[];indicators=[];currentSelection=h.empty();hasMadePass=!1;translationsMade=0;subMoves=[];highlightedBallCoords=[];highlightedPiecesCoords=[];moveGenerator=new NC(!1);constructor(e){super(e),this.setRulesAndNode("Diaballik"),this.hasAsymmetricBoard=!0,this.WIDTH=this.getState().getWidth(),this.HEIGHT=this.getState().getHeight(),this.encoder=$2.encoder,this.availableAIs=[new uJ($localize`AllMoves`,new NC(!0)),new zn($localize`MCTS`,this.moveGenerator,this.rules),new zn($localize`MCTS (3 only)`,new LI(3,!1),this.rules),new zn($localize`MCTS (without dups)`,new NC(!0),this.rules),new zn($localize`MCTS (3, no dups)`,new LI(3,!1),this.rules)];for(let n=1;n<=3;n++)this.availableAIs.push(new uJ($localize`Distance (${n})`,new LI(n)))}updateBoard(e){var n=this;return M(function*(){const i=n.node.gameState;n.board=i.board,n.stateInConstruction=i;const o=n.rules.getVictoryOrDefeatCoords(i);if(n.victoryCoord=h.empty(),n.loserCoords=[],n.blockedLines=[],o.isPresent()){const s=o.get();if(s instanceof xI)n.victoryCoord=h.of(s.coord);else if(s instanceof lJ){n.loserCoords=s.allLoserPieces;const a=s.winner===O.ZERO?0:n.SPACE_SIZE;for(const c of s.opponentPiecesInContact){const l=c.x*n.SPACE_SIZE,u=c.y*n.SPACE_SIZE+a,f=new fJ(l,u,l+n.SPACE_SIZE,u);n.blockedLines.push(f)}}}})()}showLastMove(e){var n=this;return M(function*(){for(const i of e.getSubMoves())n.showSubMove(i)})()}showSubMove(e){e instanceof B2?this.highlightedPiecesCoords.push(e.getStart(),e.getEnd()):(L.assert(e instanceof Fo,"DiaballikMove can only be a translation or a pass"),this.highlightedBallCoords.push(e.getStart(),e.getEnd()))}hideLastMove(){this.highlightedPiecesCoords=[],this.highlightedBallCoords=[]}cancelMoveAttempt(){this.stateInConstruction=this.getState(),this.currentSelection=h.empty(),this.hasMadePass=!1,this.translationsMade=0,this.subMoves=[],this.indicators=[],this.highlightedPiecesCoords=[],this.highlightedBallCoords=[]}getSpaceClasses(e,n){const i=new _(e,n),o=[];return this.highlightedPiecesCoords.some(s=>s.equals(i))&&o.push("moved-fill"),this.highlightedBallCoords.some(s=>s.equals(i))&&o.push("moved-fill"),o}getPieceClasses(e,n,i){const o=new _(e,n),s=[this.getPlayerClass(i.owner)];return this.highlightedPiecesCoords.some(a=>a.equals(o))&&s.push("last-move-stroke"),!1===i.holdsBall&&this.currentSelection.equalsValue(new _(e,n))&&s.push("selected-stroke"),this.victoryCoord.equalsValue(o)&&s.push("victory-stroke"),this.loserCoords.some(a=>a.equals(o))&&s.push("defeat-stroke"),s}getBallClasses(e,n,i){const o=new _(e,n),s=[this.getPlayerClass(i.owner)];return this.highlightedBallCoords.some(a=>a.equals(o))&&s.push("last-move-stroke"),this.currentSelection.equalsValue(new _(e,n))&&s.push("selected-stroke"),s}addSubMove(e,n){var i=this;return M(function*(){if(i.currentSelection=h.empty(),i.indicators=[],i.subMoves.push(e),i.stateInConstruction=n,3===i.subMoves.length){const o=new $2(i.subMoves[0],h.of(i.subMoves[1]),h.of(i.subMoves[2]));return i.chooseMove(o)}return i.showSubMove(e),w.SUCCESS})()}onClick(e,n){var i=this;return M(function*(){const o=yield i.canUserPlay("#click_"+e+"_"+n);if(o.isFailure())return i.cancelMove(o.getReason());const s=new _(e,n);return i.onLegalClick(s)})()}onLegalClick(e){const n=this.stateInConstruction.getPieceAt(e);if(0===this.subMoves.length&&this.hideLastMove(),this.currentSelection.isPresent()){const i=this.currentSelection.get();return i.equals(e)?(this.currentSelection=h.empty(),this.indicators=[],0===this.subMoves.length?this.cancelMove():w.SUCCESS):this.stateInConstruction.getPieceAt(i).holdsBall?this.performPass(i,e):this.performTranslation(i,e)}return n.owner===this.getCurrentPlayer()?this.hasMadePass&&n.holdsBall?this.cancelMove(l0.CAN_ONLY_DO_ONE_PASS()):2===this.translationsMade&&!1===n.holdsBall?this.cancelMove(l0.CAN_ONLY_TRANSLATE_TWICE()):(this.currentSelection=h.of(e),this.indicators=n.holdsBall?this.moveGenerator.getPassEnds(this.stateInConstruction,e):this.moveGenerator.getTranslationEnds(this.stateInConstruction,e),w.SUCCESS):this.cancelMove(n.owner===B.NONE?Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY():Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT())}performPass(e,n){const i=Fo.from(e,n);if(i.isSuccess()){const o=this.rules.isLegalPass(this.stateInConstruction,i.get());return o.isSuccess()?(this.hasMadePass=!0,this.addSubMove(i.get(),o.get())):this.cancelMove(o.getReason())}return this.cancelMove(i.getReason())}performTranslation(e,n){const i=B2.from(e,n);if(i.isSuccess()){const o=this.rules.isLegalTranslation(this.stateInConstruction,i.get());return o.isSuccess()?(this.translationsMade++,this.addSubMove(i.get(),o.get())):this.cancelMove(o.getReason())}return this.cancelMove(i.getReason())}showDoneButton(){return this.interactive&&this.subMoves.length>=1}done(){var e=this;return M(function*(){const n=yield e.canUserPlay("#done");if(n.isFailure())return e.cancelMove(n.getReason());let i=h.empty();e.subMoves.length>=2&&(i=h.of(e.subMoves[1]));const o=new $2(e.subMoves[0],i,h.empty());return e.chooseMove(o)})()}getBoardRotation(){return`rotate(${180*this.getPointOfView().getValue()} ${(this.getState().getWidth()*this.SPACE_SIZE+this.STROKE_WIDTH)/2} ${(this.getState().getHeight()*this.SPACE_SIZE+this.STROKE_WIDTH)/2})`}getViewBox(){return super.getViewBox().expand(0,0,this.SPACE_SIZE,this.SPACE_SIZE)}static \u0275fac=function(n){return new(n||r)(G(Ut))};static \u0275cmp=Ue({type:r,selectors:[["app-diaballik"]],features:[$e],decls:10,vars:7,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["id","arrowhead","markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto"],["points","0 0, 10 3.5, 0 7"],[4,"ngFor","ngForOf"],["class","defeat-stroke normal-stroke",4,"ngFor","ngForOf"],["class","indicator",3,"id","click",4,"ngFor","ngForOf"],[4,"ngIf"],["id","done",3,"click",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base",3,"id","ngClass"],["class","base",3,"id","ngClass",4,"ngIf"],[1,"defeat-stroke","normal-stroke"],[1,"indicator",3,"id","click"],["id","translationCountIndicator"],[1,"base"],[1,"base",3,"ngClass"],["marker-end","url(#arrowhead)",1,"arrow"],["id","translationCount",1,"base-no-stroke","text-giant"],["id","passCountIndicator"],["id","passCount",1,"base-no-stroke","text-giant"],["id","done",3,"click"],["fill","green",1,"base-no-fill","small-stroke"],["points","-32.5,-2.5 -32.5,12.5 -10,35 -2.5,35 35,-21.25 25,-21.275 -5,25 -32.5,-2.5","fill","black",1,"base-no-fill","small-stroke"]],template:function(n,i){1&n&&(I(),E(0,"svg",0)(1,"defs")(2,"marker",1),V(3,"polygon",2),P()(),E(4,"g"),z(5,nRe,2,1,"g",3)(6,rRe,1,4,"line",4)(7,iRe,1,7,"rect",5),P(),z(8,oRe,17,50,"g",6)(9,sRe,3,4,"g",7),P()),2&n&&(A("viewBox",i.getViewBox().toSVGString()),m(4),A("transform",i.getBoardRotation()),m(),v("ngForOf",i.stateInConstruction.board),m(),v("ngForOf",i.blockedLines),m(),v("ngForOf",i.indicators),m(),v("ngIf",i.isInteractive()),m(),v("ngIf",i.showDoneButton()))},dependencies:[zt,Nt,bt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}return r})();const Js=Wi.ZERO,dJ=Wi.ZERO_WITH_BALL,ea=Wi.ONE,hJ=Wi.ONE_WITH_BALL,at=Wi.NONE;class cRe extends Wn{tutorial=[W.informational($localize`Goal of the game`,$localize`The goal of Diaballik is to bring your ball, represented by the small circle, into the home line of the opponent (i.e, its starting position). The ball is currently being held by your center piece.`,vs.get().getInitialState()),W.fromMove($localize`Translations`,$localize`During a turn, you are allowed up to three actions, including at most two translations. A translation is an orthogonal step of any piece that does not hold the ball.<br/><br/>Move your leftmost piece by one step. Once you are done, click on the green button that will appear on the bottom right of the board to indicate that you are done with your turn.`,vs.get().getInitialState(),[new $2(B2.from(new _(0,6),new _(0,5)).get(),h.empty(),h.empty())],pe.CONGRATULATIONS(),pe.FAILED_TRY_AGAIN()),W.fromMove($localize`Pass`,$localize`Another action that you are allowed to do at most once per turn is a pass. You can pass the ball by clicking on the piece that holds the ball, then on another one of your piece that can receive it. A pass must be made in a straight line along an unobstructed path.<br/><br/>Here, playing Dark, you can make two moves and a pass to win the game, do it!`,new lu([[ea,ea,ea,hJ,at,ea,ea],[at,at,at,Js,at,at,at],[at,at,at,at,at,at,at],[at,at,at,at,at,at,at],[dJ,at,at,ea,at,at,at],[at,at,at,at,at,at,at],[at,Js,Js,at,Js,Js,Js]],0),[new $2(B2.from(new _(3,1),new _(4,1)).get(),h.of(B2.from(new _(4,1),new _(4,0)).get()),h.of(Fo.from(new _(0,4),new _(4,0)).get()))],pe.CONGRATULATIONS(),pe.FAILED_TRY_AGAIN()),W.fromMove($localize`Blocking the opponent`,$localize`There is a special anti-game rule. If a player forms a contiguous line, with one piece in each column, they block the opponent from reaching their home line. If the opponent is in contact with three pieces in this case, they win instantaneously.<br/><br/>Here, playing Light, your opponent is blocking you and you already have two pieces in contact with their line. If you can connect a third piece, you win. Do it!`,new lu([[ea,ea,ea,at,at,at,at],[ea,at,at,at,at,at,hJ],[at,at,at,at,at,at,at],[at,at,at,at,at,at,at],[Js,ea,at,at,at,at,at],[at,Js,at,ea,at,at,at],[at,at,Js,dJ,Js,Js,Js]],1),[new $2(B2.from(new _(0,1),new _(0,2)).get(),h.of(B2.from(new _(0,2),new _(0,3)).get()),h.empty())],pe.CONGRATULATIONS(),pe.FAILED_TRY_AGAIN())]}class gJ extends Kn{getListMoves(t,e){const n=t.gameState,i=this.getListDrops(n),o=this.getListShifts(n);return i.concat(o)}getListShifts(t){const e=[],n=this.getShiftSources(t);for(const i of n)for(const o of[new v2(i,"clockwise"),new v2(i,"counterclockwise")])n4.get().shiftHeightValidity(o,t).isSuccess()&&e.push(o);return e}getListDrops(t){const e=this.getRemainingPiecesForCurrentPlayer(t),n=[];for(let i=0;i<pr.WIDTH;i++)for(const o of e){const s=new Pl(i,o);n4.get().dropHeightValidity(s,t).isSuccess()&&n.push(s)}return n}getRemainingPiecesForCurrentPlayer(t){const e=[];for(const n of vn.PLAYER_PIECES)this.currentPlayerCanDropPiece(t,n)&&e.push(n);return e}currentPlayerCanDropPiece(t,e){return t.getCurrentPlayer()===e.owner&&t.getRemainingPiecesOf(e)>0}getShiftSources(t){const e=[],n=t.getCurrentPlayer();for(let i=0;i<pr.HEIGHT;i++)for(let o=0;o<pr.WIDTH;o++)t.getPieceAtXY(o,i).owner===n&&e.push(new _(o,i));return e}}function lRe(r,t){if(1&r){const e=he();I(),E(0,"g",6)(1,"path",7),q("click",function(){const o=te(e).$implicit;return ne(p().onSpaceClick(o))}),P(),E(2,"path",8),q("click",function(){const o=te(e).$implicit;return ne(p().onSpaceClick(o))}),P()()}if(2&r){const e=t.$implicit,n=p();Tn("id","board_space_",e,""),m(),Tn("id","click_",e,""),v("ngClass",n.viewInfo.boardInfo[e].spaceClasses),A("d",n.BOARD_PATHS[e]),m(),v("ngClass",n.viewInfo.boardInfo[e].spaceClasses),A("d",n.DECORATION_PATHS[e])}}function uRe(r,t){if(1&r){const e=he();I(),E(0,"g",10),q("click",function(){const o=te(e).$implicit,s=p().$implicit;return ne(p().onPieceInGameClick(s,o.y))}),V(1,"use",11)(2,"use",12),P()}if(2&r){const e=t.$implicit;ve("id","click_",p().$implicit,"_",e.y,""),v("ngClass",e.foregroundClasses),m(),v("ngClass",e.backgroundClasses),A("x",e.drawPosition.x)("y",e.drawPosition.y),m(),A("x",e.drawPosition.x)("y",e.drawPosition.y)}}function fRe(r,t){if(1&r&&(I(),E(0,"g"),z(1,uRe,3,8,"g",9),P()),2&r){const e=t.$implicit,n=p();m(),v("ngForOf",n.viewInfo.boardInfo[e].pieces)}}function dRe(r,t){if(1&r){const e=he();I(),E(0,"g",14),q("click",function(){const i=te(e),o=i.$implicit,s=i.index;return ne(p(2).onRemainingPieceClick(o.actualPiece,s))}),V(1,"use",11)(2,"use",12),P()}if(2&r){const e=t.$implicit,n=t.index;Ur("id","piece_",e.actualPiece.owner.toString(),"_",e.actualPiece.otherPieceType?1:0,"_",n,""),v("ngClass",e.foregroundClasses),m(),v("ngClass",e.backgroundClasses),A("x",e.drawPosition.x)("y",e.drawPosition.y),m(),A("x",e.drawPosition.x)("y",e.drawPosition.y)}}function hRe(r,t){if(1&r&&(I(),E(0,"g"),z(1,dRe,3,9,"g",13),P()),2&r){const e=t.$implicit,n=p();m(),v("ngForOf",n.viewInfo.remainingPieces.get(e).get())}}const gRe=()=>[0,1,2,3,4,5,6,7],pRe=()=>[2,1,3,0,4,7,5,6];class u0 extends Fc{static CENTER=[new _(40,160),new _(100,50),new _(255,2),new _(400,50),new _(460,160),new _(400,270),new _(255,320),new _(100,270)];static PIECE_HEIGHT=36;BOARD_PATHS=["M 2.8324855,277.57643 164.46619,228.81694 170.57257,148.42756 32.571357,104.19835 Z","M 170.57257,148.42237 246.4213,96.276913 195.13813,2.0233391 32.571357,104.19315 Z","m 195.14159,2.0268021 205.0898,0.010821 -52.1686,94.2453509 -101.64149,-0.0057 z","M 348.06279,96.281239 400.23529,2.0330788 564.39307,104.19207 424.66384,148.41891 Z","m 424.66384,148.42237 7.27882,80.37683 164.9712,48.72701 -32.52079,-173.33068 z","m 431.94266,228.80481 -75.73854,62.15055 79.06197,135.86929 161.64688,-149.29953 z","m 356.20412,290.9506 79.06197,135.86929 -268.2864,0.0433 74.14082,-135.90175 z","M 241.12051,290.96379 166.97969,426.86556 2.8324855,277.57708 164.46619,228.81759 Z"];DECORATION_PATHS=["m 170.57257,148.42302 v 40.08918 l -6.11049,80.38634 v -40.09025 z","m 170.57646,188.51696 v -40.08918 l 75.8509,-52.140047 v 40.086147 z","m 246.42323,96.285785 v 40.086155 l 101.63847,-0.003 0.001,-40.082256 z","m 424.66037,148.42345 v 40.08377 l -76.60213,-52.14178 10e-4,-40.082033 z","m 424.66037,148.42193 v 40.08377 l 7.27884,80.37445 v -40.08377 z","m 435.26609,466.90582 v -40.08615 l 161.64688,-149.2995 8.9e-4,40.08701 z","m 166.97969,426.86815 v 40.08638 l 268.28379,-0.0433 v -40.08031 z","m 2.8324855,277.57297 v 40.08636 L 166.97969,466.94782 v -40.08636 z"];selected=h.empty();viewInfo={boardInfo:[],remainingPieces:new gn([{key:O.ZERO,value:[]},{key:O.ONE,value:[]}])};constructor(t){super(t),this.setRulesAndNode("Diam"),this.availableAIs=[new fn($localize`Dummy`,this.rules,new EI,new gJ),new zn($localize`MCTS`,new gJ,this.rules)],this.encoder=mke}onSpaceClick(t){var e=this;return M(function*(){const n=yield e.canUserPlay("#click_"+t);return n.isFailure()?e.cancelMove(n.getReason()):e.onSpaceClickAfterCheck(t)})()}onSpaceClickAfterCheck(t){var e=this;return M(function*(){if(e.selected.isPresent()){const n=e.selected.get();let i;if("pieceFromReserve"===n.type)i=new Pl(t,n.piece);else if((n.position.x+1)%pr.WIDTH===t)i=new v2(n.position,"clockwise");else{if((n.position.x+(pr.WIDTH-1))%pr.WIDTH!==t)return e.cancelMove(Pd.MUST_SHIFT_TO_NEIGHBOR());i=new v2(n.position,"counterclockwise")}return e.chooseMove(i)}return e.cancelMove(Pd.MUST_SELECT_PIECE_FIRST())})()}onPieceInGameClick(t,e){var n=this;return M(function*(){const i=yield n.canUserPlay("#click_"+t+"_"+e);if(i.isFailure())return n.cancelMove(i.getReason());const o=new _(t,e);return n.getState().getPieceAt(o).owner===n.getCurrentPlayer()?(n.isSelected(null,o)?yield n.cancelMoveAttempt():n.selected=h.of({type:"pieceFromBoard",position:o}),n.updateViewInfo(),w.SUCCESS):n.selected.isPresent()?n.onSpaceClickAfterCheck(t):n.cancelMove(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT())})()}onRemainingPieceClick(t,e){var n=this;return M(function*(){const i=yield n.canUserPlay(n.getPieceId(t,e));return i.isFailure()?n.cancelMove(i.getReason()):t.owner===n.getCurrentOpponent()?n.cancelMove(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT()):(n.selected=n.isSelected(t)?h.empty():h.of({type:"pieceFromReserve",piece:t}),n.updateViewInfo(),w.SUCCESS)})()}getPieceId(t,e){return"#piece_"+t.owner.toString()+"_"+(t.otherPieceType?1:0)+"_"+e}isSelected(t,e){return!this.selected.isAbsent()&&(null==t&&"pieceFromBoard"===this.selected.get().type?this.selected.get().position.equals(e):this.selected.get().piece===t)}updateBoard(t){var e=this;return M(function*(){e.updateViewInfo()})()}getLastMovedFromDrop(t,e){const n=this.getDrawPositionRemainingPiece(t.piece,e.getRemainingPiecesOf(t.piece)-1),i=t.getTarget(),o=e.getStackHeight(t.getTarget()),s=this.getDrawPositionOnBoard(i,o),a=new _(i,o);return[{start:h.empty(),end:a,startDrawPosition:n,endDrawPosition:s}]}getLastMovedFromShift(t,e){const n=t.start.x,i=t.getTarget();let o=e.getStackHeight(i);const s=[];for(let a=t.start.y;a<pr.HEIGHT&&e.getPieceAtXY(n,a)!==vn.EMPTY;a++,o++)s.push({start:h.of(new _(n,a)),end:new _(i,o),startDrawPosition:this.getDrawPositionOnBoard(n,a),endDrawPosition:this.getDrawPositionOnBoard(i,o)});return s}updateViewInfo(){this.updateBoardInfo(),this.updateRemainingPiecesInfo()}updateBoardInfo(){for(let t=0;t<pr.WIDTH;t++)this.viewInfo.boardInfo[t]={x:t,spaceClasses:[],pieces:this.getPieces(t)}}showLastMove(t){var e=this;return M(function*(){e.showLastMoveOnSpaces(t),e.showLastMoveOnPieces(t)})()}hideLastMove(){}showLastMoveOnSpaces(t){for(let e=0;e<pr.WIDTH;e++){const n=[];if(t.isDrop())t.getTarget()===e&&n.push("moved-fill");else{const i=t;(i.getTarget()===e||i.start.x===e)&&n.push("moved-fill")}this.viewInfo.boardInfo[e].spaceClasses=n}}showLastMoveOnPieces(t){const e=this.getPreviousState();let n=[];n=t.isDrop()?this.getLastMovedFromDrop(t,e):this.getLastMovedFromShift(t,e);for(const i of n)this.viewInfo.boardInfo[i.end.x].pieces[i.end.y].foregroundClasses.push("last-move-stroke")}updateRemainingPiecesInfo(){const t=this.getCurrentPlayer();this.viewInfo.remainingPieces=new gn([{key:O.ZERO,value:[]},{key:O.ONE,value:[]}]);const e=this.isPlayerTurn();for(const n of vn.PLAYER_PIECES){const i=this.getState().getRemainingPiecesOf(n);for(let o=0;o<i;o++){const s=[];this.isTopPieceOfReserveAndSelected(o,i,n)&&s.push("selected-stroke"),e&&o===i-1&&n.owner===t&&s.push("clickable-stroke-hover");const a=this.viewInfo.remainingPieces.get(n.owner).get(),c=[];c.push(n.otherPieceType?"player"+n.owner.getValue()+"-alternate-fill":"player"+n.owner.getValue()+"-fill"),a.push({backgroundClasses:c,foregroundClasses:s,y:o,drawPosition:this.getDrawPositionRemainingPiece(n,o),actualPiece:n}),this.viewInfo.remainingPieces.put(n.owner,a)}}}isTopPieceOfReserveAndSelected(t,e,n){if(this.selected.isPresent()){const i=this.selected.get();return"pieceFromReserve"===i.type&&i.piece===n&&t===e-1}return!1}getDrawPositionRemainingPiece(t,e){let n,i;return n=t.owner===O.ZERO?-100:600,i=t.otherPieceType?100:450,new _(n,i).getNext(new Gt(0,-e*u0.PIECE_HEIGHT))}getPieces(t){const e=this.rules.findHighestAlignment(this.getState()),n=this.isPlayerTurn(),i=[];for(let o=0;o<pr.HEIGHT;o++){const s=this.getState().getPieceAtXY(t,o),a=new _(t,o);if(s!==vn.EMPTY){const c=[];this.pieceFromBoardIsSelected(t,o)&&c.push("selected-stroke"),this.isVictory(t,o,e)&&c.push("victory-stroke"),n&&this.rules.pieceCanMove(this.getState(),a)&&c.push("clickable-stroke-hover"),i.push({backgroundClasses:["player"+s.owner.getValue()+(s.otherPieceType?"-alternate-fill":"-fill")],foregroundClasses:c,y:o,drawPosition:this.getDrawPositionOnBoard(t,o),actualPiece:s})}}return i}pieceFromBoardIsSelected(t,e){if(this.selected.isPresent()){const n=this.selected.get();return"pieceFromBoard"===n.type&&n.position.x===t&&n.position.y===e}return!1}isVictory(t,e,n){if(n.isPresent()){const i=n.get();return i.x%4==t%4&&i.y===e}return!1}getDrawPositionOnBoard(t,e){return u0.CENTER[t].getNext(new Gt(0,-e*u0.PIECE_HEIGHT))}cancelMoveAttempt(){var t=this;return M(function*(){t.selected=h.empty(),yield t.updateBoard(!1)})()}static \u0275fac=function(e){return new(e||u0)(G(Ut))};static \u0275cmp=Ue({type:u0,selectors:[["app-diam"]],features:[$e],decls:8,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-110 -120 800 710","preserveAspectRatio","xMidYMid meet"],["id","piece"],["d","M 0 15 v 35 A 40 15, 0, 0, 0, 80 50 v -35 A 40 15, 0, 0, 0, 0 15 Z"],["cx","40","cy","15","rx","40","ry","15"],[3,"id",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],[3,"id"],[1,"base","mid-stroke",3,"id","ngClass","click"],[1,"base","mid-stroke","high-brightness",3,"ngClass","click"],["pointer-events","fill","class","base-no-fill no-fill mid-small-stroke",3,"id","ngClass","click",4,"ngFor","ngForOf"],["pointer-events","fill",1,"base-no-fill","no-fill","mid-small-stroke",3,"id","ngClass","click"],[0,"xlink","href","#piece",1,"base","mid-stroke",3,"ngClass"],[0,"xlink","href","#piece"],["class","base-no-fill no-fill mid-small-stroke",3,"id","ngClass","click",4,"ngFor","ngForOf"],[1,"base-no-fill","no-fill","mid-small-stroke",3,"id","ngClass","click"]],template:function(e,n){1&e&&(I(),E(0,"svg",0)(1,"defs")(2,"g",1),V(3,"path",2)(4,"ellipse",3),P()(),z(5,lRe,3,6,"g",4)(6,fRe,2,1,"g",5)(7,hRe,2,1,"g",5),P()),2&e&&(m(5),v("ngForOf",fr(3,gRe)),m(),v("ngForOf",fr(4,pRe)),m(),v("ngForOf",n.Player.PLAYERS))},dependencies:[zt,Nt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}class ys{offset;constant;static fromTwoCoords(t,e){const n=t.x,i=e.x,o=t.y,s=e.y,a=n+o,c=i+s;return n===i&&o!==s&&a!==c?h.of(ys.constantQ(n)):n!==i&&o===s&&a!==c?h.of(ys.constantR(o)):n!==i&&o!==s&&a===c?h.of(ys.constantS(a)):h.empty()}static constantQ(t){return new ys(t,"q")}static constantR(t){return new ys(t,"r")}static constantS(t){return new ys(t,"s")}static areOnSameLine(t){if(t.length<2)return!0;const e=ys.fromTwoCoords(t[0],t[1]);if(e.isAbsent())return!1;const n=e.get();for(const i of t.slice(2))if(!1===n.contains(i))return!1;return!0}constructor(t,e){this.offset=t,this.constant=e}toString(){return`Line(${this.constant}, ${this.offset})`}equals(t){return this===t||!(this.offset!==t.offset||this.constant!==t.constant)}contains(t){switch(this.constant){case"q":return t.x===this.offset;case"r":return t.y===this.offset;case"s":return t.x+t.y===this.offset}}getDirection(){switch(this.constant){case"q":return Te.DOWN;case"r":return Te.RIGHT;case"s":return Te.DOWN_LEFT}}}class zI extends B1{width;height;excludedSpaces;empty;constructor(t,e,n,i,o,s){super(e,t),this.width=n,this.height=i,this.excludedSpaces=o,this.empty=s,pn(this.excludedSpaces.length<this.height/2+1,"Invalid excluded spaces specification for HexagonalGameState.")}setAt(t,e){if(this.isOnBoard(t))return this.setAtUnsafe(t,e);throw new Error("Setting coord not on board: "+t+".")}equalsT(t,e){if(this===t)return!0;if(this.width!==t.width||this.height!==t.height||!1===e(this.empty,t.empty)||this.excludedSpaces.length!==t.excludedSpaces.length)return!1;for(let n=0;n<this.excludedSpaces.length;n++)if(this.excludedSpaces[n]!==t.excludedSpaces[n])return!1;for(const n of this.allCoords())if(!1===e(this.getPieceAt(n),t.getPieceAt(n)))return!1;return!0}allCoords(){const t=[];return this.forEachCoord(e=>{t.push(e)}),t}allLines(){const t=[];for(let e=0;e<this.width;e++)t.push(ys.constantQ(e));for(let e=0;e<this.height;e++)t.push(ys.constantR(e));for(let e=this.excludedSpaces.length;e<this.height+this.excludedSpaces.length;e++)t.push(ys.constantS(e));return t}getEntranceOnLine(t){let e,n;switch(t.constant){case"q":return n=null!=this.excludedSpaces[t.offset]?this.excludedSpaces[t.offset]:0,this.findEntranceFrom(t,new _(t.offset,n));case"r":return e=null!=this.excludedSpaces[t.offset]?this.excludedSpaces[t.offset]:0,this.findEntranceFrom(t,new _(e,t.offset));case"s":return this.findEntranceFrom(t,t.offset<this.width?new _(t.offset,0):new _(this.width-1,t.offset-this.width+1))}}findEntranceFrom(t,e){const n=t.getDirection();let i=e;for(let s=0;s<Math.max(this.width,this.height);s++){if(this.isOnBoard(i))return i;i=i.getNext(n)}const o=u2.logError("HexagonalGameState.findEntranceFrom","could not find a board entrance, board must be invalid",{start:e.toString(),line:t.toString()});throw new Error(o.getReason())}}class bi{static getNeighbors(t,e=1){const n=[];for(const i of Te.factory.all)n.push(t.getNext(i,e));return n}static areNeighbors(t,e){for(const n of Te.factory.all)if(t.getNext(n).equals(e))return!0;return!1}}class A1{owner;size;source;static encoder=ke.tuple([ke.identity(),O.encoder,ke.identity()],t=>[t.source,t.owner,t.size],t=>new A1(t[1],t[2],t[0]));static MAX_SIZE=49;static EMPTY=new A1(B.NONE,0,!1);static UNREACHABLE=new A1(B.NONE,-1,!1);static PLAYER_ZERO=new A1(O.ZERO,1,!1);static PLAYER_ONE=new A1(O.ONE,1,!1);static SOURCE=new A1(B.NONE,1,!0);static append(t,e){return new A1(t.owner,t.size+e.size,t.source||e.source)}constructor(t,e,n){this.owner=t,this.size=e,this.source=n}getOwner(){return this.owner}belongsTo(t){return this.owner===t}containsSource(){return this.source}isEmpty(){return 0===this.size}hasPieces(){return!1===this.isEmpty()}getSize(){return this.size}toString(){return"DvonnPieceStack("+this.owner.toString()+", "+this.size+", "+this.source+")"}equals(t){return this.owner===t.owner&&this.size===t.size&&this.source===t.source}}let ta=(()=>{class r extends zI{alreadyPassed;static WIDTH=11;static HEIGHT=5;static EXCLUDED_SPACES=[2,1];static balancedBoard(){const e=A1.UNREACHABLE,n=A1.PLAYER_ZERO,i=A1.PLAYER_ONE,o=A1.SOURCE;return[[e,e,n,i,i,i,n,n,i,o,i],[e,i,i,n,n,n,i,i,n,i,i],[i,i,i,i,n,o,i,n,n,n,n],[n,n,i,n,n,i,i,i,n,n,e],[n,o,n,i,i,n,n,n,i,e,e]]}static isOnBoard(e){return!e.isNotInRange(r.WIDTH,r.HEIGHT)&&r.balancedBoard()[e.y][e.x]!==A1.UNREACHABLE}constructor(e,n,i){super(n,e,r.WIDTH,r.HEIGHT,r.EXCLUDED_SPACES,A1.EMPTY),this.alreadyPassed=i}getAllPieces(){const e=[];for(let n=0;n<r.HEIGHT;n++)for(let i=0;i<r.WIDTH;i++){const o=new _(i,n);this.isOnBoard(o)&&this.getPieceAt(o).hasPieces()&&e.push(o)}return e}numberOfNeighbors(e){return bi.getNeighbors(e,1).filter(o=>this.isOnBoard(o)&&this.getPieceAt(o).hasPieces()).length}setAtUnsafe(e,n){const i=rt.copy(this.board);return i[e.y][e.x]=n,new r(i,this.turn,this.alreadyPassed)}isOnBoard(e){return!e.isNotInRange(this.width,this.height)&&this.board[e.y][e.x]!==A1.UNREACHABLE}}return r})(),f0=(()=>class r{static NOT_PLAYER_PIECE=()=>$localize`You must select a piece or a stack of your color.`;static EMPTY_STACK=()=>$localize`You must select a stack.`;static TOO_MANY_NEIGHBORS=()=>$localize`This stack cannot be moved because all 6 of its neighbors are occupied. You must select a stack with strictly less than 6 neighbors.`;static CANT_REACH_TARGET=()=>$localize`This stack cannot move because it could never land on another piece.`;static INVALID_MOVE_LENGTH=()=>$localize`A stack must always be moved by as many spaces as there are pieces in the stack.`;static EMPTY_TARGET_STACK=()=>$localize`The stack must land on an occupied space.`;static MUST_MOVE_IN_STRAIGHT_LINE=()=>$localize`A stack must move in a straight line.`})();class Ir extends Do{static PASS=new Ir(new _(-1,-1),new _(-2,-2));static encoder=G2.getFallibleEncoder(Ir.from);constructor(t,e){super(t,e)}static from(t,e){return-1===t.x&&-1===t.y&&-2===e.x&&-2===e.y?X.success(Ir.PASS):!1===ta.isOnBoard(t)?X.failure("Starting coord of DvonnMove must be on the board, not at "+t.toString()):!1===ta.isOnBoard(e)?X.failure("End coord of DvonnMove must be on the board, not at "+t.toString()):t.y===e.y||t.x===e.x||t.x+t.y===e.x+e.y?X.success(new Ir(t,e)):X.failure(f0.MUST_MOVE_IN_STRAIGHT_LINE())}toString(){return this===Ir.PASS?"DvonnMove.PASS":"DvonnMove("+this.getStart()+"->"+this.getEnd()+")"}length(){return this.getStart().y===this.getEnd().y?Math.abs(this.getStart().x-this.getEnd().x):(this.getStart(),this.getEnd(),Math.abs(this.getStart().y-this.getEnd().y))}}class Kr extends Ar{static singleton=h.empty();static get(){return Kr.singleton.isAbsent()&&(Kr.singleton=h.of(new Kr)),Kr.singleton.get()}getInitialState(){return new ta(ta.balancedBoard(),0,!1)}static getGameStatus(t){const e=t.gameState,n=Kr.getScores(e);if(0===Kr.getMovablePieces(e).length){const i=n.get(O.ZERO),o=n.get(O.ONE);return i>o?ye.ZERO_WON:i<o?ye.ONE_WON:ye.DRAW}return ye.ONGOING}static getMovablePieces(t){return Kr.getFreePieces(t).filter(e=>Kr.pieceHasTarget(t,e))}static getFreePieces(t){return t.getAllPieces().filter(e=>t.getPieceAt(e).belongsTo(t.getCurrentPlayer())&&t.numberOfNeighbors(e)<6)}static pieceHasTarget(t,e){const n=t.getPieceAt(e).getSize();return void 0!==bi.getNeighbors(e,n).find(o=>t.isOnBoard(o)&&t.getPieceAt(o).hasPieces())}static pieceTargets(t,e){const n=t.getPieceAt(e).getSize();return bi.getNeighbors(e,n).filter(o=>t.isOnBoard(o)&&t.getPieceAt(o).hasPieces())}static getScores(t){let e=0,n=0;return t.getAllPieces().map(i=>{const o=t.getPieceAt(i);o.belongsTo(O.ZERO)?e+=o.getSize():o.belongsTo(O.ONE)&&(n+=o.getSize())}),we.of(e,n)}isMovablePiece(t,e){L.assert(t.isOnBoard(e),"piece is not on the board");const n=t.getPieceAt(e);return n.getSize()<1?w.failure(f0.EMPTY_STACK()):!1===n.belongsTo(t.getCurrentPlayer())?w.failure(f0.NOT_PLAYER_PIECE()):6<=t.numberOfNeighbors(e)?w.failure(f0.TOO_MANY_NEIGHBORS()):!1===Kr.pieceHasTarget(t,e)?w.failure(f0.CANT_REACH_TARGET()):w.SUCCESS}canOnlyPass(t){return 0===Kr.getMovablePieces(t).length}sourceCoords(t){return t.getAllPieces().filter(e=>t.getPieceAt(e).containsSource())}markPiecesConnectedTo(t,e,n){bi.getNeighbors(e,1).forEach(i=>{t.isOnBoard(i)&&!1===n[i.y][i.x]&&t.getPieceAt(i).hasPieces()&&(n[i.y][i.x]=!0,this.markPiecesConnectedTo(t,i,n))})}removeDisconnectedPieces(t){const e=rt.create(ta.WIDTH,ta.HEIGHT,!1);this.sourceCoords(t).forEach(i=>{e[i.y][i.x]=!0,this.markPiecesConnectedTo(t,i,e)});let n=t;return n.getAllPieces().forEach(i=>{!1===e[i.y][i.x]&&(n=n.setAt(i,A1.EMPTY))}),n}applyLegalMove(t,e,n,i){if(t===Ir.PASS)return new ta(e.board,e.turn+1,!0);{const o=e.getPieceAt(t.getStart()),s=e.getPieceAt(t.getEnd()),a=e.setAt(t.getStart(),A1.EMPTY).setAt(t.getEnd(),A1.append(o,s));return this.removeDisconnectedPieces(new ta(a.board,e.turn+1,!1))}}isLegal(t,e,n){if(0===Kr.getMovablePieces(e).length)return t===Ir.PASS&&!1===e.alreadyPassed?w.SUCCESS:w.failure(Ee.MUST_PASS());if(t===Ir.PASS)return w.failure(Ee.CANNOT_PASS());const i=this.isMovablePiece(e,t.getStart());if(i.isFailure())return i;const o=e.getPieceAt(t.getStart());return t.length()!==o.getSize()?X.failure(f0.INVALID_MOVE_LENGTH()):e.getPieceAt(t.getEnd()).isEmpty()?X.failure(f0.EMPTY_TARGET_STACK()):X.success(void 0)}getGameStatus(t){return Kr.getGameStatus(t)}}const ie=A1.EMPTY,mr=A1.UNREACHABLE,Tl=A1.SOURCE,fu=A1.PLAYER_ZERO,du=A1.PLAYER_ONE,mRe=new A1(O.ZERO,2,!1),DI=new A1(O.ONE,2,!1),pJ=new A1(O.ZERO,4,!1),_Re=new A1(O.ONE,4,!1);class CRe extends Wn{tutorial=[W.anyMove($localize`Moving`,$localize`At Dvonn, each hexagonal space contains a stack of pieces.
        If no number is indicated on a stack, it means that it only contains one piece.
        The number written on a stack indicates the number of pieces within that stack, hence the number of points its owner gets.
        The owner of a stack is the one that has a piece at the top of the stack.
        Only the owner of a stack can move it.
        A stack cannot be moved if it is surrounded by 6 other stacks.
        A stack is moved by as many spaces as there are pieces within, in a straight line, and it should land on an occupied space.
        This line cannot move along the vertex of two neighboring spaces, as would a vertical move.
        Therefore, there are six possible directions.
        The player with dark pieces starts.<br/><br/>
        You're playing Dark, click on a stack and move it by one space.`,Kr.get().getInitialState(),Ir.from(new _(2,0),new _(3,0)).get(),pe.CONGRATULATIONS()),W.fromPredicate($localize`Disconnection`,$localize`Pieces with a lightning strike are called "sources".
        When a stack is not directly nor indirectly connected to a source, it is removed from the board.<br/><br/>
        You're playing Dark, try to disconnect the stack of 4 pieces from your opponent. There are two ways of doing that, one is better than the other: try to find that one!`,new ta([[mr,mr,du,Tl,ie,ie,ie,ie,ie,ie,ie],[mr,ie,fu,ie,ie,ie,ie,ie,ie,ie,ie],[ie,ie,_Re,ie,ie,ie,ie,du,Tl,ie,ie],[ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,mr],[ie,ie,ie,ie,ie,ie,ie,ie,ie,mr,mr]],0,!1),Ir.from(new _(2,1),new _(2,0)).get(),(t,e,n)=>t.getEnd().equals(new _(3,0))?w.failure($localize`You have successfully disconnected the stack of 4 pieces of your opponent, but on the next move your opponent will be able to move on your new stack, and to win the game! There exists a better outcome of this situation, try to find it.`):(pn(t.getEnd().equals(new _(2,0)),"player made an impossible move"),w.SUCCESS),$localize`Nice, you have disconnected 4 pieces of your opponent, and your new stack cannot be reached by your opponent!
        Your opponent therefore lost 5 points: 4 from the disconnected stack, and one from the stack on which you moved.
        Disconnected stacks will not be visible at the next turn.`),W.fromPredicate($localize`Moving on a source`,$localize`You are allowed to move your stacks on any other stack.
        This means that you can take control of a source by moving one of your stack on top of it.
        This way, you know that this stack may never be disconnected, as it contains a source.<br/><br/>
        You're playing Dark and you can take control of a source, do it!`,new ta([[mr,mr,Tl,du,ie,ie,ie,ie,ie,ie,ie],[mr,fu,fu,ie,ie,ie,ie,ie,ie,ie,ie],[ie,du,fu,du,ie,ie,fu,DI,Tl,ie,ie],[ie,ie,du,ie,ie,ie,ie,ie,ie,ie,mr],[ie,ie,ie,ie,ie,ie,ie,ie,ie,mr,mr]],0,!1),Ir.from(new _(2,1),new _(2,0)).get(),(t,e,n)=>t.getEnd().equals(new _(2,0))?w.SUCCESS:w.failure($localize`You have not taken possession of a source, try again.`),$localize`Congratulations! However, note that your opponent could later take possession of one of your stack that contains a source, so watch out when you take control of sources!`),W.informational($localize`Passing`,$localize`It can happen that you have no possible move to make.
        If this is the case, and if your opponent can still move, you must pass your turn.<br/><br/>
        This is a situation that occurs here for Dark.`,new ta([[mr,mr,Tl,ie,ie,ie,ie,ie,ie,ie,ie],[mr,ie,mRe,ie,ie,ie,ie,ie,ie,ie,ie],[ie,ie,DI,ie,ie,ie,ie,DI,Tl,pJ,ie],[ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,mr],[ie,ie,ie,ie,ie,ie,ie,ie,ie,mr,mr]],0,!1)),W.fromMove(pe.END_OF_THE_GAME(),$localize`When no more move is possible for both players, the game ends and the player with the most points wins.<br/><br/>You're playing Dark, make your last move.`,new ta([[mr,mr,Tl,ie,ie,ie,ie,ie,ie,ie,ie],[mr,ie,fu,ie,ie,ie,ie,ie,ie,ie,ie],[ie,ie,ie,ie,ie,ie,ie,ie,Tl,pJ,ie],[ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,mr],[ie,ie,ie,ie,ie,ie,ie,ie,ie,mr,mr]],0,!1),[Ir.from(new _(2,1),new _(2,0)).get()],$localize`Congratulations, you won 6 - 0!`,$localize`Bad idea, by moving on the source you would have won a point.`)]}class vRe extends rr{getMetrics(t,e){return Kr.getScores(t.gameState).toTable()}}class mJ extends Kn{getListMoves(t,e){const n=t.previousMove,i=t.gameState,o=[];return Kr.getMovablePieces(i).forEach(s=>Kr.pieceTargets(i,s).forEach(a=>{const c=Ir.from(s,a).get();o.push(c)})),0===o.length&&!1===n.equalsValue(Ir.PASS)&&o.push(Ir.PASS),o}}class _J extends mJ{getListMoves(t,e){const n=t.gameState,i=super.getListMoves(t,e),o=n.getCurrentOpponent();return yt.sortByDescending(i,s=>{pn(s!==Ir.PASS,"Cannot sort with DvonnMove.PASS");const a=n.getPieceAt(s.getEnd());return a.belongsTo(o)?a.getSize():0}),i}}class yRe extends rr{getMetrics(t,e){const n=t.gameState,i=Kr.getScores(n),o=new G1,s=n.getAllPieces(),a=s.length;for(const c of O.PLAYERS){const l=s.filter(f=>n.getPieceAt(f).belongsTo(c)).length,u=i.get(c);o.set(c,[u*l/a])}return o}}function MRe(r,t){if(1&r&&(I(),V(0,"circle",11)),2&r){const e=p().$implicit,n=p().$implicit,i=p();ve("id","piece_",n.x,"_",n.y,""),v("ngClass",i.getPieceClasses(e)),A("r",i.SPACE_SIZE)}}function ERe(r,t){1&r&&(I(),V(0,"polygon",12)),2&r&&A("transform",1===p().$implicit.getSize()?"translate(-18, -16) scale(0.10)":"translate(-3, -12) scale(0.07)")}function PRe(r,t){if(1&r){const e=he();I(),E(0,"text",13),q("click",function(){te(e);const i=p(2).$implicit;return ne(p().onClick(i.x,i.y))}),ot(1),P()}if(2&r){const e=p().$implicit;A("x",e.containsSource()?-7:0),m(),Cn(e.getSize())}}function SRe(r,t){if(1&r){const e=he();I(),E(0,"g",6),q("click",function(){te(e);const i=p().$implicit;return ne(p().onClick(i.x,i.y))}),V(1,"polygon",7),z(2,MRe,1,4,"circle",8)(3,ERe,1,1,"polygon",9)(4,PRe,2,2,"text",10),P()}if(2&r){const e=t.$implicit,n=p().$implicit,i=p();ve("id","click_",n.x,"_",n.y,""),A("transform",i.getHexaCenterTranslation(n)),m(),A("points",i.getHexaPoints()),m(),v("ngIf",e.getSize()>0),m(),v("ngIf",e.containsSource()),m(),v("ngIf",e.getSize()>1)}}const ORe=r=>[r];function TRe(r,t){if(1&r&&(I(),E(0,"g"),z(1,SRe,5,7,"g",5),P()),2&r){const e=t.$implicit,n=p();m(),v("ngForOf",Ta(1,ORe,n.state.getPieceAt(e)))}}function wRe(r,t){if(1&r&&(I(),E(0,"text",18),ot(1),P()),2&r){const e=p().$implicit,n=p();A("x",n.getCenterAt(e.coord).x)("y",n.getCenterAt(e.coord).y),m(),Cn(e.spaceContent.getSize())}}function bRe(r,t){if(1&r&&(I(),E(0,"g",14),V(1,"polygon",15)(2,"circle",16),z(3,wRe,2,3,"text",17),P()),2&r){const e=t.$implicit,n=p();ve("id","disconnected_",e.coord.x,"_",e.coord.y,""),m(),A("points",n.getHexaPoints())("transform",n.getHexaCenterTranslation(e.coord)),m(),ve("id","captured_",e.coord.x,"_",e.coord.y,""),v("ngClass",n.getPieceClasses(e.spaceContent)),A("cx",n.getCenterAt(e.coord).x)("cy",n.getCenterAt(e.coord).y)("r",n.SPACE_SIZE),m(),v("ngIf",e.spaceContent.getSize()>1)}}function ARe(r,t){if(1&r&&(I(),jt(0),V(1,"polygon",19)(2,"polygon",19),Zt()),2&r){const e=p();m(),A("points",e.getHexaPoints())("transform",e.getHexaCenterTranslation(e.lastMove.get().getStart())),m(),A("points",e.getHexaPoints())("transform",e.getHexaCenterTranslation(e.lastMove.get().getEnd()))}}function NRe(r,t){if(1&r&&(I(),V(0,"polygon",20)),2&r){const e=p();ve("id","chosen_",e.chosen.get().x,"_",e.chosen.get().y,""),A("transform",e.getHexaCenterTranslation(e.chosen.get()))("points",e.getHexaPoints())}}let IRe=(()=>{class r extends ru{lastMove=h.empty();chosen=h.empty();disconnecteds=[];state;constructor(e){super(e),this.setRulesAndNode("Dvonn"),this.availableAIs=[new fn($localize`Stacks`,this.rules,new yRe,new _J),new fn($localize`Score`,this.rules,new vRe,new _J),new zn($localize`MCTS`,new mJ,this.rules)],this.encoder=Ir.encoder,this.scores=h.of(Kr.getScores(this.getState())),this.SPACE_SIZE=30,this.hexaLayout=new iu(1.5*this.SPACE_SIZE,new _(-this.SPACE_SIZE,2*this.SPACE_SIZE),OC.INSTANCE),this.state=this.getState(),this.hexaBoard=this.getState().board}hideLastMove(){this.lastMove=h.empty()}updateBoard(e){var n=this;return M(function*(){n.state=n.getState(),n.disconnecteds=[],n.canPass=n.rules.canOnlyPass(n.state),n.scores=h.of(Kr.getScores(n.state))})()}showLastMove(e){var n=this;return M(function*(){n.lastMove=h.of(e);const i=n.getPreviousState(),o=n.getState();for(let s=0;s<o.getHeight();s++)for(let a=0;a<o.board[s].length;a++){const c=new _(a,s);if(!0===o.isOnBoard(c)&&!1===c.equals(n.lastMove.get().getStart())){const l=o.getPieceAt(c),u=i.getPieceAt(c);if(l.isEmpty()&&u.hasPieces()){const g={coord:new _(a,s),spaceContent:u};n.disconnecteds.push(g)}}}})()}cancelMoveAttempt(){this.chosen=h.empty()}pass(){var e=this;return M(function*(){return L.assert(e.canPass,"DvonnComponent: pass() can only be called if canPass is true"),yield e.chooseMove(Ir.PASS)})()}onClick(e,n){var i=this;return M(function*(){const o=yield i.canUserPlay("#click_"+e+"_"+n);return o.isFailure()?i.cancelMove(o.getReason()):i.chosen.isAbsent()?i.choosePiece(e,n):i.chosen.equalsValue(new _(e,n))?(i.cancelMoveAttempt(),w.SUCCESS):yield i.chooseDestination(e,n)})()}choosePiece(e,n){var i=this;return M(function*(){const o=new _(e,n),s=i.rules.isMovablePiece(i.getState(),o);return s.isSuccess()?(i.chosen=h.of(o),w.SUCCESS):i.cancelMove(s.getReason())})()}chooseDestination(e,n){var i=this;return M(function*(){const o=i.getState(),s=i.chosen.get(),a=new _(e,n),c=Ir.from(s,a);return c.isFailure()?i.rules.isMovablePiece(o,a).isSuccess()?i.choosePiece(e,n):i.cancelMove(c.getReason()):i.rules.isLegal(c.get(),o,i.config).isFailure()&&i.rules.isMovablePiece(o,a).isSuccess()?i.choosePiece(e,n):i.chooseMove(c.get())})()}getPieceClasses(e){if(e.containsSource()&&1===e.getSize())return["nonplayer-fill","dashed-stroke"];const n=this.getPlayerClass(e.getOwner());return e.containsSource()?[n,"nonplayer-stroke","dashed-stroke"]:[n]}static \u0275fac=function(n){return new(n||r)(G(Ut))};static \u0275cmp=Ue({type:r,selectors:[["app-dvonn"]],features:[$e],decls:5,vars:4,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","0 0 875 380","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id",4,"ngFor","ngForOf"],[4,"ngIf"],["class","base no-fill selected-stroke",3,"id",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base","mid-stroke"],["cx","0","cy","0","class","base mid-stroke",3,"id","ngClass",4,"ngIf"],["class","nonplayer-light-fill","points","157.055,0 90.798,196.319 164.417,196.319 88.344,400 289.571,159.509 218.405,159.509 311.656,0",4,"ngIf"],["y","0","class","text-center text-medium","dy","13",3,"click",4,"ngIf"],["cx","0","cy","0",1,"base","mid-stroke",3,"id","ngClass"],["points","157.055,0 90.798,196.319 164.417,196.319 88.344,400 289.571,159.509 218.405,159.509 311.656,0",1,"nonplayer-light-fill"],["y","0","dy","13",1,"text-center","text-medium",3,"click"],[3,"id"],[1,"base","mid-stroke","captured-fill"],[1,"base","mid-stroke","semi-transparent",3,"id","ngClass"],["class","text-center text-medium","dy","13",4,"ngIf"],["dy","13",1,"text-center","text-medium"],[1,"base","no-fill","last-move-stroke"],[1,"base","no-fill","selected-stroke",3,"id"]],template:function(n,i){1&n&&(I(),E(0,"svg",0),z(1,TRe,2,3,"g",1)(2,bRe,4,11,"g",2)(3,ARe,3,4,"ng-container",3)(4,NRe,1,4,"polygon",4),P()),2&n&&(m(),v("ngForOf",i.state.allCoords()),m(),v("ngForOf",i.disconnecteds),m(),v("ngIf",i.lastMove.isPresent()),m(),v("ngIf",i.chosen.isPresent()))},dependencies:[zt,Nt,bt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}return r})();var W1=function(r){return r[r.NONE=0]="NONE",r[r.SMALL=1]="SMALL",r[r.MEDIUM=2]="MEDIUM",r[r.BIG=3]="BIG",r}(W1||{});class Xe{value;static encoder=ke.tuple([ke.identity()],t=>[t.value],t=>Xe.of(t[0]));static SMALL_DARK=new Xe(0);static SMALL_LIGHT=new Xe(1);static MEDIUM_DARK=new Xe(2);static MEDIUM_LIGHT=new Xe(3);static BIG_DARK=new Xe(4);static BIG_LIGHT=new Xe(5);static NONE=new Xe(6);static of(t){switch(t){case 0:return this.SMALL_DARK;case 1:return this.SMALL_LIGHT;case 2:return this.MEDIUM_DARK;case 3:return this.MEDIUM_LIGHT;case 4:return this.BIG_DARK;case 5:return this.BIG_LIGHT;case 6:return this.NONE;default:throw new Error("Invalid value "+t+" for EncapsulePiece")}}static ofSizeAndPlayer(t,e){return e===O.ZERO&&t===W1.BIG?Xe.BIG_DARK:e===O.ZERO&&t===W1.MEDIUM?Xe.MEDIUM_DARK:e===O.ZERO&&t===W1.SMALL?Xe.SMALL_DARK:e===O.ONE&&t===W1.BIG?Xe.BIG_LIGHT:e===O.ONE&&t===W1.MEDIUM?Xe.MEDIUM_LIGHT:e===O.ONE&&t===W1.SMALL?Xe.SMALL_LIGHT:Xe.NONE}constructor(t){this.value=t}getPlayer(){switch(this){case Xe.SMALL_DARK:case Xe.MEDIUM_DARK:case Xe.BIG_DARK:return O.ZERO;case Xe.SMALL_LIGHT:case Xe.MEDIUM_LIGHT:case Xe.BIG_LIGHT:return O.ONE;default:return B.NONE}}getSize(){switch(this){case Xe.BIG_DARK:case Xe.BIG_LIGHT:return W1.BIG;case Xe.MEDIUM_DARK:case Xe.MEDIUM_LIGHT:return W1.MEDIUM;case Xe.SMALL_DARK:case Xe.SMALL_LIGHT:return W1.SMALL;default:return L.expectToBe(this,Xe.NONE),W1.NONE}}belongsTo(t){return this.getPlayer()===t}equals(t){return this===t}toString(){switch(this){case Xe.BIG_DARK:return"BIG_DARK";case Xe.BIG_LIGHT:return"BIG_LIGHT";case Xe.MEDIUM_DARK:return"MEDIUM_DARK";case Xe.MEDIUM_LIGHT:return"MEDIUM_LIGHT";case Xe.SMALL_DARK:return"SMALL_DARK";case Xe.SMALL_LIGHT:return"SMALL_LIGHT";default:return L.expectToBe(this,Xe.NONE),"EMPTY"}}}class qi extends h2{startingCoord;landingCoord;piece;static encoder=ke.tuple([h.getEncoder(_.encoder),_.encoder,h.getEncoder(Xe.encoder)],t=>[t.startingCoord,t.landingCoord,t.piece],t=>new qi(t[0],t[1],t[2]));constructor(t,e,n){super(),this.startingCoord=t,this.landingCoord=e,this.piece=n}static ofMove(t,e){return L.assert(!1===t.equals(e),"Starting coord and landing coord must be separate coords"),new qi(h.of(t),e,h.empty())}static ofDrop(t,e){return new qi(h.empty(),e,h.of(t))}isDropping(){return this.startingCoord.isAbsent()}equals(t){return this===t||!1!==t.landingCoord.equals(this.landingCoord)&&!1!==this.startingCoord.equals(t.startingCoord)&&this.piece.equals(t.piece)}toString(){return this.isDropping()?"EncapsuleMove("+this.piece.get().toString()+" -> "+this.landingCoord+")":"EncapsuleMove("+this.startingCoord.get()+"->"+this.landingCoord+")"}}let Td=(()=>class r{static PIECE_OUT_OF_STOCK=()=>$localize`You do not have pieces of this type anymore.`;static INVALID_PLACEMENT=()=>$localize`You must put your piece on an empty square or on a smaller piece.`;static NOT_DROPPABLE=()=>$localize`You must pick your piece among the remaining ones.`;static INVALID_PIECE_SELECTED=()=>$localize`You must pick one of your remaining pieces or one piece on the board that is the biggest of its square.`;static END_YOUR_MOVE=()=>$localize`You are performing a move, you must select a landing square.`})();class wd extends B1{remainingPieces;constructor(t,e,n){super(t,e),this.remainingPieces=n}getRemainingPieces(){return yt.copy(this.remainingPieces)}getRemainingPiecesOfPlayer(t){return this.getRemainingPieces().filter(e=>e.getPlayer()===t)}pieceBelongsToCurrentPlayer(t){return t.belongsTo(this.getCurrentPlayer())}isDroppable(t){return this.pieceBelongsToCurrentPlayer(t)&&this.isInRemainingPieces(t)}isInRemainingPieces(t){return this.remainingPieces.some(e=>e===t)}getPlayerRemainingPieces(){return this.remainingPieces.filter(t=>this.pieceBelongsToCurrentPlayer(t))}}class M2{small;medium;big;static EMPTY=new M2(B.NONE,B.NONE,B.NONE);constructor(t,e,n){this.small=t,this.medium=e,this.big=n}isEmpty(){return this.small===B.NONE&&this.medium===B.NONE&&this.big===B.NONE}toList(){const t=[];return this.small.isPlayer()&&t.push(Xe.ofSizeAndPlayer(W1.SMALL,this.small)),this.medium.isPlayer()&&t.push(Xe.ofSizeAndPlayer(W1.MEDIUM,this.medium)),this.big.isPlayer()&&t.push(Xe.ofSizeAndPlayer(W1.BIG,this.big)),t}toOrderedPieceNames(){const t=Xe.ofSizeAndPlayer(W1.SMALL,this.small),e=Xe.ofSizeAndPlayer(W1.MEDIUM,this.medium),n=Xe.ofSizeAndPlayer(W1.BIG,this.big);return[t.toString(),e.toString(),n.toString()]}getBiggest(){return this.big===O.ZERO?Xe.BIG_DARK:this.big===O.ONE?Xe.BIG_LIGHT:this.medium===O.ZERO?Xe.MEDIUM_DARK:this.medium===O.ONE?Xe.MEDIUM_LIGHT:this.small===O.ZERO?Xe.SMALL_DARK:this.small===O.ONE?Xe.SMALL_LIGHT:Xe.NONE}tryToSuperposePiece(t){const e=this.getBiggest().getSize();if(t===Xe.NONE)throw new Error("Cannot move EMPTY on a space");return t.getSize()>e?h.of(this.put(t)):h.empty()}removeBiggest(){const t=this.getBiggest();if(t===Xe.NONE)throw new Error("Cannot removed piece from empty space");let e;const n=t.getSize();switch(n){case W1.BIG:e=new M2(this.small,this.medium,B.NONE);break;case W1.MEDIUM:e=new M2(this.small,B.NONE,B.NONE);break;default:L.expectToBe(n,W1.SMALL),e=new M2(B.NONE,B.NONE,B.NONE)}return{removedSpace:e,removedPiece:t}}put(t){if(t===Xe.NONE)throw new Error("Cannot put NONE on space");const e=t.getPlayer(),n=t.getSize();switch(n){case W1.BIG:return new M2(this.small,this.medium,e);case W1.MEDIUM:return pn(this.big===B.NONE,"Cannot put a piece on top of a bigger one"),new M2(this.small,e,this.big);default:return L.expectToBe(n,W1.SMALL),pn(this.big===B.NONE,"Cannot put a piece on top of a bigger one"),pn(this.medium===B.NONE,"Cannot put a piece on top of a bigger one"),new M2(e,this.medium,this.big)}}belongsTo(t){return this.getBiggest().getPlayer()===t}toString(){const t=this.toOrderedPieceNames();return"("+t[0]+", "+t[1]+", "+t[2]+")"}}var Ga;let hu=class extends Ar{static#e=Ga=this;static singleton=h.empty();static get(){return Ga.singleton.isAbsent()&&(Ga.singleton=h.of(new Ga)),Ga.singleton.get()}getInitialState(){const t=new M2(B.NONE,B.NONE,B.NONE),e=rt.create(3,3,t);return new wd(e,0,[Xe.BIG_DARK,Xe.BIG_DARK,Xe.BIG_LIGHT,Xe.BIG_LIGHT,Xe.MEDIUM_DARK,Xe.MEDIUM_DARK,Xe.MEDIUM_LIGHT,Xe.MEDIUM_LIGHT,Xe.SMALL_DARK,Xe.SMALL_DARK,Xe.SMALL_LIGHT,Xe.SMALL_LIGHT])}static LINES=[[new _(0,0),new _(0,1),new _(0,2)],[new _(1,0),new _(1,1),new _(1,2)],[new _(2,0),new _(2,1),new _(2,2)],[new _(0,0),new _(1,0),new _(2,0)],[new _(0,1),new _(1,1),new _(2,1)],[new _(0,2),new _(1,2),new _(2,2)],[new _(0,0),new _(1,1),new _(2,2)],[new _(0,2),new _(1,1),new _(2,0)]];static isVictory(t){const e=t.getCopiedBoard();for(const n of Ga.LINES){const o=Ga.isVictoriousLine([e[n[0].y][n[0].x],e[n[1].y][n[1].x],e[n[2].y][n[2].x]]);if(o.isPresent())return o}return h.empty()}static isVictoriousLine(t){const n=t.map(i=>i.getBiggest()).map(i=>i.getPlayer());return n[0]===B.NONE?h.empty():n[0]===n[1]&&n[1]===n[2]?h.of(n[0]):h.empty()}static isLegal(t,e){let n;if(t.isDropping()){n=t.piece.get();const s=n.getPlayer();if(s===B.NONE)return X.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(s===e.getCurrentOpponent())return X.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT());if(!1===e.isInRemainingPieces(n))return X.failure(Td.PIECE_OUT_OF_STOCK())}else{const s=t.startingCoord.get();n=e.getPieceAt(s).getBiggest();const c=n.getPlayer();if(c===B.NONE)return X.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(c===e.getCurrentOpponent())return X.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT())}const o=e.getPieceAt(t.landingCoord).tryToSuperposePiece(n);return o.isPresent()?X.success(o.get()):X.failure(Td.INVALID_PLACEMENT())}isLegal(t,e){return Ga.isLegal(t,e)}applyLegalMove(t,e,n,i){const o=e.getCopiedBoard();let s=e.getRemainingPieces();const a=e.turn+1;let c;if(o[t.landingCoord.y][t.landingCoord.x]=i,t.isDropping()){c=t.piece.get();const u=s.indexOf(c);s=s.slice(0,u).concat(s.slice(u+1))}else{const u=t.startingCoord.get(),g=o[u.y][u.x].removeBiggest();o[u.y][u.x]=g.removedSpace,c=g.removedPiece}return new wd(o,a,s)}static getGameStatus(t){const n=Ga.isVictory(t.gameState);return n.isPresent()?ye.getVictory(n.get()):ye.ONGOING}getGameStatus(t){return Ga.getGameStatus(t)}};hu=Ga=function(r,t,e,n){var s,i=arguments.length,o=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,e):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,t,e,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(t,e,o):s(t,e))||o);return i>3&&o&&Object.defineProperty(t,e,o),o}([Ae.log],hu);class CJ extends Kn{getListMoves(t,e){const n=[],i=t.gameState,o=i.getCopiedBoard(),s=i.getCurrentPlayer(),a=VQ.toComparableObjectSet(i.getPlayerRemainingPieces());for(let c=0;c<3;c++)for(let l=0;l<3;l++){const u=new _(l,c);for(const f of a){const g=qi.ofDrop(f,u);hu.isLegal(g,i).isSuccess()&&n.push(g)}if(o[c][l].belongsTo(s))for(let f=0;f<3;f++)for(let g=0;g<3;g++){const y=new _(g,f);if(!1===y.equals(u)){const S=qi.ofMove(u,y);hu.isLegal(S,i).isSuccess()&&n.push(S)}}}return n}}function RRe(r,t){if(1&r){const e=he();I(),E(0,"g")(1,"circle",5),q("click",function(){const i=te(e),o=i.$implicit,s=i.index,a=p().$implicit;return ne(p().onPieceClick(a.getValue(),o,s))}),P()()}if(2&r){const e=t.$implicit,n=t.index,i=p().$implicit,o=p();m(),Ur("id","piece_",i.getValue(),"_",e.toString(),"_",n,""),v("ngClass",o.getSidePieceClasses(e,n)),A("transform","rotate("+180*(o.getPointOfView().getValue()+i.getValue())+" "+o.CENTER+" "+o.CENTER+")")("r",o.getPieceRadius(e))("cx",o.getRemainingPieceCenterCoord(i,n).x)("cy",o.getRemainingPieceCenterCoord(i,n).y)}}function xRe(r,t){if(1&r&&(I(),E(0,"g",null,4),z(2,RRe,2,8,"g",1),P()),2&r){const e=t.$implicit,n=p();m(2),v("ngForOf",n.getRemainingPieces(e))}}function LRe(r,t){if(1&r){const e=he();I(),E(0,"circle",8),q("click",function(){te(e);const i=p().index,o=p().index;return ne(p().onBoardClick(i,o))}),P()}if(2&r){const e=t.$implicit,n=p().index,i=p().index,o=p();v("ngClass",o.getPieceClasses(e)),A("r",o.getPieceRadius(e))("cx",o.getPieceCenter(n))("cy",o.getPieceCenter(i))}}function zRe(r,t){if(1&r){const e=he();I(),E(0,"g")(1,"rect",6),q("click",function(){const o=te(e).index,s=p().index;return ne(p().onBoardClick(o,s))}),P(),z(2,LRe,1,4,"circle",7),P()}if(2&r){const e=t.$implicit,n=t.index,i=p().index,o=p();m(),ve("id","click_",n,"_",i,""),v("ngClass",o.getRectClasses(n,i)),A("x",o.SPACE_SIZE*n+o.STROKE_WIDTH)("y",o.SPACE_SIZE*i+o.STROKE_WIDTH)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),m(),v("ngForOf",o.getListPieces(e))}}function DRe(r,t){if(1&r&&(I(),E(0,"g"),z(1,zRe,3,8,"g",1),P()),2&r){const e=t.$implicit;m(),v("ngForOf",e)}}function VRe(r,t){if(1&r){const e=he();I(),E(0,"rect",9),q("click",function(){te(e);const i=p();return ne(i.onBoardClick(i.chosenCoord.get().x,i.chosenCoord.get().y))}),P()}if(2&r){const e=p();ve("id","chosenCoord_",e.chosenCoord.get().x,"_",e.chosenCoord.get().y,""),A("x",e.SPACE_SIZE*e.chosenCoord.get().x+e.STROKE_WIDTH)("y",e.SPACE_SIZE*e.chosenCoord.get().y+e.STROKE_WIDTH)("width",e.SPACE_SIZE)("height",e.SPACE_SIZE)}}let HRe=(()=>{class r extends p2{CENTER=this.getPieceCenter(1);UPLEFT=-(this.SPACE_SIZE+.5*this.STROKE_WIDTH);WIDTH=5*this.SPACE_SIZE+3*this.STROKE_WIDTH;lastLandingCoord=h.empty();lastStartingCoord=h.empty();chosenCoord=h.empty();chosenPiece=h.empty();chosenPieceIndex;remainingPieceCenterCoords=new gn;constructor(e){super(e),this.setRulesAndNode("Encapsule"),this.availableAIs=[new fn($localize`Dummy`,this.rules,new EI,new CJ),new zn($localize`MCTS`,new CJ,this.rules)],this.encoder=qi.encoder}showLastMove(e){var n=this;return M(function*(){n.lastLandingCoord=h.of(e.landingCoord),n.lastStartingCoord=e.startingCoord})()}hideLastMove(){this.lastLandingCoord=h.empty(),this.lastStartingCoord=h.empty()}updateBoard(e){var n=this;return M(function*(){const i=n.getState();n.board=i.getCopiedBoard(),n.calculateLeftPieceCoords()})()}getListPieces(e){return e.toList()}getRemainingPieces(e){return this.getState().getRemainingPiecesOfPlayer(e)}onBoardClick(e,n){var i=this;return M(function*(){const o=yield i.canUserPlay("#click_"+e+"_"+n);if(o.isFailure())return i.cancelMove(o.getReason());const s=new _(e,n),a=i.getState();if(i.chosenCoord.isAbsent()){if(i.chosenCoord=h.of(s),i.chosenPiece.isPresent()){const c=qi.ofDrop(i.chosenPiece.get(),s);return i.chooseMove(c)}return!1===a.getPieceAt(s).belongsTo(a.getCurrentPlayer())?i.cancelMove(Td.INVALID_PIECE_SELECTED()):w.SUCCESS}if(i.chosenCoord.equalsValue(s))return i.cancelMoveAttempt(),w.SUCCESS;{const c=qi.ofMove(i.chosenCoord.get(),s);return i.chooseMove(c)}})()}cancelMoveAttempt(){this.chosenCoord=h.empty(),this.chosenPiece=h.empty(),this.chosenPieceIndex=h.empty()}onPieceClick(e,n,i){var o=this;return M(function*(){const s="#piece_"+e+"_"+n.toString()+"_"+i,a=yield o.canUserPlay(s);return a.isFailure()?o.cancelMove(a.getReason()):!1===o.getState().isDroppable(n)?o.cancelMove(Td.NOT_DROPPABLE()):o.chosenCoord.isAbsent()?(o.chosenPiece.equalsValue(n)&&o.chosenPieceIndex.equalsValue(i)?(o.chosenPiece=h.empty(),o.chosenPieceIndex=h.empty()):(o.chosenPiece=h.of(n),o.chosenPieceIndex=h.of(i)),w.SUCCESS):o.cancelMove(Td.END_YOUR_MOVE())})()}getRectClasses(e,n){return this.isSelected(e,n)?"moved-fill":""}isSelected(e,n){const i=new _(e,n);return!(!this.lastStartingCoord.equalsValue(i)&&!this.lastLandingCoord.equalsValue(i))}getPieceClasses(e){return[this.getPieceStrokeClass(e)]}getPieceCenter(e){return this.SPACE_SIZE*e+this.STROKE_WIDTH+this.SPACE_SIZE/2}getPieceStrokeClass(e){const n=e.getPlayer();return pn(n.isPlayer(),"EncapsuleComponent.getPieceStrokeClass should only be called with actual pieces!"),"player"+n.getValue()+"-stroke"}getPieceRadius(e){switch(e.getSize()){case W1.BIG:return this.SPACE_SIZE/2-1*this.STROKE_WIDTH;case W1.MEDIUM:return this.SPACE_SIZE/2-2*this.STROKE_WIDTH-3;default:return L.expectToBe(e.getSize(),W1.SMALL),this.SPACE_SIZE/2-3*this.STROKE_WIDTH-6}}getSidePieceClasses(e,n){const i=this.getPieceClasses(e);return this.isSelectedPiece(e)&&this.chosenPieceIndex.equalsValue(n)&&i.push("selected-stroke"),i}isSelectedPiece(e){return this.chosenPiece.equalsValue(e)}calculateLeftPieceCoords(){this.remainingPieceCenterCoords=new gn;for(const e of O.PLAYERS){const n=[],i=this.getRemainingPieces(e);for(let o=0;o<i.length;o++){let s,a=0,c=0;o<=2?(s=new _(2-o,3),c=this.STROKE_WIDTH):(s=new _(-1,5-o),a=-this.STROKE_WIDTH);const l=this.getPieceCenter(s.x),u=this.getPieceCenter(s.y);n.push(new _(l+a,u+c))}this.remainingPieceCenterCoords.set(e,n)}}getRemainingPieceCenterCoord(e,n){return this.remainingPieceCenterCoords.get(e).get()[n]}static \u0275fac=function(n){return new(n||r)(G(Ut))};static \u0275cmp=Ue({type:r,selectors:[["app-encapsule"]],features:[$e],decls:6,vars:4,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["boardDiv",""],["class","base no-fill selected-stroke","pointer-events","fill",3,"id","click",4,"ngIf"],["remainingPieces",""],["pointer-events","fill",1,"base","no-fill",3,"id","ngClass","click"],[1,"base",3,"id","ngClass","click"],["class","base no-fill",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"base","no-fill",3,"ngClass","click"],["pointer-events","fill",1,"base","no-fill","selected-stroke",3,"id","click"]],template:function(n,i){1&n&&(I(),E(0,"svg",0),z(1,xRe,3,1,"g",1),E(2,"g",null,2),z(4,DRe,2,1,"g",1)(5,VRe,1,6,"rect",3),P()()),2&n&&(A("viewBox",i.UPLEFT+" "+i.UPLEFT+" "+i.WIDTH+" "+i.WIDTH),m(),v("ngForOf",i.Player.PLAYERS),m(3),v("ngForOf",i.board),m(),v("ngIf",i.chosenCoord.isPresent()))},dependencies:[zt,Nt,bt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}return r})();const go=new M2(B.NONE,B.NONE,B.NONE),vJ=new M2(O.ZERO,B.NONE,B.NONE),FRe=new M2(B.NONE,O.ZERO,B.NONE),URe=new M2(B.NONE,B.NONE,O.ZERO),yJ=new M2(O.ONE,B.NONE,B.NONE),IC=new M2(B.NONE,B.NONE,O.ONE),GRe=new M2(O.ONE,O.ZERO,B.NONE),BRe=new M2(O.ZERO,O.ZERO,B.NONE);class $Re extends Wn{tutorial=[W.informational($localize`Goal of the game`,$localize`The goal of Encapsule is to align three of your pieces.
        Here, we have a victory of the dark player.`,new wd([[vJ,yJ,IC],[go,FRe,go],[go,go,URe]],0,[Xe.SMALL_DARK,Xe.MEDIUM_DARK,Xe.BIG_DARK,Xe.SMALL_LIGHT,Xe.MEDIUM_LIGHT,Xe.MEDIUM_LIGHT,Xe.BIG_LIGHT])),W.anyMove($localize`Putting a piece`,$localize`This is the initial board.<br/><br/>
        You're playing Dark. Pick one of your piece on the side of the board and put it on the board.`,hu.get().getInitialState(),qi.ofDrop(Xe.SMALL_DARK,new _(1,1)),pe.CONGRATULATIONS()),W.fromMove($localize`Moving`,$localize`Another possible action is to move one of your pieces that is already on the board.<br/><br/>
        You're playing Dark, click on your piece already on the board and then on any empty square of the board.`,new wd([[vJ,IC,go],[go,go,go],[go,go,go]],0,[]),[qi.ofMove(new _(0,0),new _(2,0)),qi.ofMove(new _(0,0),new _(0,1)),qi.ofMove(new _(0,0),new _(1,1)),qi.ofMove(new _(0,0),new _(2,1)),qi.ofMove(new _(0,0),new _(0,2)),qi.ofMove(new _(0,0),new _(1,2)),qi.ofMove(new _(0,0),new _(2,2))],pe.CONGRATULATIONS(),pe.FAILED_TRY_AGAIN()),W.fromPredicate($localize`Particularity`,$localize`At Encapsule, pieces encapsulate each other.
        It is therefore possible to have up to three pieces per square!
        However, only the biggest piece of each square counts:
        you cannot win with a piece that is "hidden" by a bigger piece.
        Similarly, you cannot move a piece if it is encapsulated by a bigger piece.
        Finally, you cannot encapsulate a piece with a smaller piece.
        Here, Dark can win now in various ways.<br/><br/>
        You're playing Dark, try to win by making a move, and not by putting a new piece on the board.`,new wd([[GRe,go,yJ],[BRe,IC,IC],[go,go,go]],0,[Xe.MEDIUM_DARK,Xe.BIG_DARK,Xe.MEDIUM_LIGHT,Xe.MEDIUM_LIGHT]),qi.ofMove(new _(0,1),new _(0,2)),(t,e,n)=>{if(t.landingCoord.equals(new _(0,2))){if(t.isDropping())return w.failure($localize`You won, but the exercise is to win while moving a piece!`);if(t.startingCoord.equalsValue(new _(0,1)))return w.SUCCESS}return w.failure(pe.FAILED_TRY_AGAIN())},pe.CONGRATULATIONS())]}class na extends Nr{movedPieces;stepSize;direction;static encoder=ke.tuple([_.encoder,ke.identity(),ke.identity(),me.encoder],t=>[t.coord,t.movedPieces,t.stepSize,t.direction],t=>new na(t[0].x,t[0].y,t[1],t[2],t[3]));constructor(t,e,n,i,o){super(t,e),this.movedPieces=n,this.stepSize=i,this.direction=o,L.assert(n>0,"Must select minimum one piece (got "+n+")."),L.assert(i>0,"Step size must be minimum one (got "+i+")."),L.assert(i<=n,"Cannot move a phalanx further than its size (got step size "+i+" for "+n+" pieces).")}toString(){return"EpaminondasMove("+this.coord.toString()+", m:"+this.movedPieces+", s:"+this.stepSize+", "+this.direction.toString()+")"}equals(t){return this===t||!1!==this.coord.equals(t.coord)&&this.movedPieces===t.movedPieces&&this.stepSize===t.stepSize&&this.direction.equals(t.direction)}}class bd extends B1{countRow(t,e){let n=0;for(let i=0;i<this.getWidth();i++)this.board[e][i]===t&&n++;return n}count(t){let e=0;for(const n of this.getCoordsAndContents())n.content===t&&e++;return e}doesOwnPiece(t){for(const e of this.getCoordsAndContents())if(e.content===t)return!0;return!1}}let ra=(()=>class r{static PHALANX_IS_LEAVING_BOARD=()=>$localize`The move distance of your phalanx puts it out of the board.`;static SOMETHING_IN_PHALANX_WAY=()=>$localize`There is something in the way of your phalanx.`;static PHALANX_SHOULD_BE_GREATER_TO_CAPTURE=()=>$localize`Your phalanx must be bigger than the one you are capturing.`;static SQUARE_NOT_ALIGNED_WITH_SELECTED=()=>$localize`This square is not aligned with the selected piece.`;static SINGLE_PIECE_MUST_MOVE_BY_ONE=()=>$localize`A single piece can only move by one square.`;static SINGLE_PIECE_CANNOT_CAPTURE=()=>$localize`A single piece cannot make a capture.`;static SQUARE_NOT_ALIGNED_WITH_PHALANX=()=>$localize`This square is not aligned with the direction of the phalanx.`;static PHALANX_CANNOT_CONTAIN_PIECES_OUTSIDE_BOARD=()=>$localize`A phalanx can't contain pieces outside of the board.`;static PHALANX_CANNOT_CONTAIN_EMPTY_SQUARE=()=>$localize`A phalanx cannot contain an empty square.`;static PHALANX_CANNOT_CONTAIN_OPPONENT_PIECE=()=>$localize`A phalanx cannot contain a piece of the opponent.`})();class Ai extends Da{static singleton=h.empty();static RULES_CONFIG_DESCRIPTION=new fo({name:()=>$localize`Epaminondas`,config:{width:new _1(14,Gi.WIDTH,m1.range(1,99)),emptyRows:new _1(8,()=>$localize`Number of empty rows`,m1.range(1,99)),rowsOfSoldiers:new _1(2,()=>$localize`Number of soldier rows`,m1.range(1,99))}});static get(){return Ai.singleton.isAbsent()&&(Ai.singleton=h.of(new Ai)),Ai.singleton.get()}static isLegal(t,e){const n=this.getPhalanxValidity(e,t);if(n.isFailure())return X.failure(n.getReason());const i=this.getLandingStatus(e,t);if(i.isFailure())return i;const o=rt.copy(i.get()),s=e.getCurrentOpponent(),a=Ai.getCaptureValidity(e,o,t,s);return a.isFailure()?a:X.success(a.get())}static getPhalanxValidity(t,e){let n=e.coord;if(!1===t.isOnBoard(n))return w.failure(uo.OUT_OF_RANGE(n));let i=0;const o=t.getCurrentOpponent();for(;i<e.movedPieces;){if(!1===t.isOnBoard(n))return w.failure(ra.PHALANX_CANNOT_CONTAIN_PIECES_OUTSIDE_BOARD());const s=t.getPieceAt(n);if(s===B.NONE)return w.failure(ra.PHALANX_CANNOT_CONTAIN_EMPTY_SQUARE());if(s===o)return w.failure(ra.PHALANX_CANNOT_CONTAIN_OPPONENT_PIECE());n=n.getNext(e.direction,1),i++}return w.SUCCESS}static getLandingStatus(t,e){const n=t.getCopiedBoard(),i=t.getCurrentPlayer();let o=e.coord,s=e.coord.getNext(e.direction,e.movedPieces),a=0;for(;a+1<e.stepSize;){if(n[o.y][o.x]=B.NONE,n[s.y][s.x]=i,!1===t.isOnBoard(s))return X.failure(ra.PHALANX_IS_LEAVING_BOARD());if(t.getPieceAt(s).isPlayer())return X.failure(ra.SOMETHING_IN_PHALANX_WAY());a++,s=s.getNext(e.direction,1),o=o.getNext(e.direction,1)}return!1===t.isOnBoard(s)?X.failure(ra.PHALANX_IS_LEAVING_BOARD()):t.getPieceAt(s)===i?X.failure(Ee.SHOULD_LAND_ON_EMPTY_OR_OPPONENT_SPACE()):(n[o.y][o.x]=B.NONE,n[s.y][s.x]=i,X.success(n))}static getCaptureValidity(t,e,n,i){let o=n.coord.getNext(n.direction,n.movedPieces+n.stepSize-1),s=0;for(;t.isOnBoard(o)&&t.getPieceAt(o)===i;){if(s>0&&(e[o.y][o.x]=B.NONE),s++,n.movedPieces<=s)return X.failure(ra.PHALANX_SHOULD_BE_GREATER_TO_CAPTURE());o=o.getNext(n.direction,1)}return X.success(e)}getInitialState(t){const e=t.get(),n=B.NONE,i=B.ZERO,s=rt.create(e.width,e.rowsOfSoldiers,B.ONE),a=rt.create(e.width,e.emptyRows,n),c=rt.create(e.width,e.rowsOfSoldiers,i),l=s.concat(a).concat(c);return new bd(l,0)}getRulesConfigDescription(){return h.of(Ai.RULES_CONFIG_DESCRIPTION)}isLegal(t,e){return Ai.isLegal(t,e)}applyLegalMove(t,e,n,i){return new bd(i,e.turn+1)}getGameStatus(t,e){const n=t.gameState,i=n.countRow(O.ZERO,0),o=n.getHeight(),s=n.countRow(O.ONE,o-1);if(n.turn%2==0){if(i>s)return ye.ZERO_WON}else if(s>i)return ye.ONE_WON;return!1===n.doesOwnPiece(O.ZERO)?ye.ONE_WON:!1===n.doesOwnPiece(O.ONE)?ye.ZERO_WON:ye.ONGOING}}class MJ extends Kn{getListMoves(t,e){const n=t.gameState.getCurrentPlayer(),i=t.gameState.getCurrentOpponent(),o=B.NONE;let s=[];const a=t.gameState;for(const c of a.getCoordsAndContents()){const l=c.coord;if(c.content===n){let u;for(const f of me.DIRECTIONS){let g=1,y=l.getNext(f,1);for(;a.isOnBoard(y)&&a.getPieceAt(y)===n;)g+=1,y=y.getNext(f,1);let S=1;for(;a.isOnBoard(y)&&S<=g&&a.getPieceAt(y)===o;)u=new na(l.x,l.y,g,S,f),s=this.addMove(s,u,a),S++,y=y.getNext(f,1);a.isOnBoard(y)&&S<=g&&a.getPieceAt(y)===i&&(u=new na(l.x,l.y,g,S,f),s=this.addMove(s,u,a))}}}return s}addMove(t,e,n){return Ai.isLegal(e,n).isSuccess()&&t.push(e),t}}class EJ extends Ha{}class WRe extends EJ{DOMINANCE_FACTOR=20;DEFENSE_FACTOR=5;TERRITORY_FACTOR=2;OFFENSE_FACTOR=10;CENTER_FACTOR=5;MOBILITY_FACTOR=.12;getBoardValue(t,e){const n=t.gameState,i=this.getDominance(n),o=this.getDefense(n),s=this.getTerritory(n),a=this.getCenter(n),c=this.getOffense(n),l=this.getMobility(n);return mn.of(i+o+s+a+c+l)}getDominance(t){let e=0;for(const n of t.getCoordsAndContents())n.content.isPlayer()&&(e+=n.content.getScoreModifier());return e*this.DOMINANCE_FACTOR}getDefense(t){let e=0;const n=t.getWidth(),i=t.getHeight();for(let o=0;o<n;o++)t.getPieceAtXY(o,i-1)===O.ZERO&&(e+=O.ZERO.getScoreModifier()),t.getPieceAtXY(o,0)===O.ONE&&(e+=O.ONE.getScoreModifier());return e*this.DEFENSE_FACTOR}getTerritory(t){let e=0;for(const n of t.getCoordsAndContents()){const i=n.content;if(i.isPlayer()){for(let o=-1;o<=1;o++)for(let s=-1;s<=1;s++){const a=n.coord.getNext(new _(o,s),1);if(t.isOnBoard(a)){const c=t.getPieceAt(a);(c===i||c===B.NONE)&&(e+=1*i.getScoreModifier())}}e-=i.getScoreModifier()}}return e*this.TERRITORY_FACTOR}getOffense(t){let e=0;const n=t.getWidth(),i=t.getHeight();for(let o=0;o<n;o++)t.getPieceAtXY(o,0)===O.ZERO&&(e+=O.ZERO.getScoreModifier()),t.getPieceAtXY(o,i-1)===O.ONE&&(e+=O.ONE.getScoreModifier());return e*this.OFFENSE_FACTOR}getCenter(t){let e=0;const i=(t.getWidth()-1)/2;for(const o of t.getCoordsAndContents()){const s=o.content;s.isPlayer()&&(e+=s.getScoreModifier()*Math.abs(o.coord.x-i))}return e*this.CENTER_FACTOR}getMobility(t){let e=0,n=0,i=0;for(const o of t.getCoordsAndContents()){const s=o.coord,a=o.content;if(a.isPlayer())for(const c of me.DIRECTIONS){let l=1,u=s.getNext(c,1);for(;t.isOnBoard(u)&&t.getPieceAt(u)===a;)l+=1,u=u.getNext(c,1);let f=1;for(;t.isOnBoard(u)&&f<=l&&t.getPieceAt(u)===B.NONE;)f++,u=u.getNext(c,1);e+=f*f*a.getScoreModifier(),a===O.ZERO?n=Math.max(n,f):a===O.ONE&&(i=Math.max(i,f))}}return(e+n*O.ZERO.getScoreModifier()+i*O.ONE.getScoreModifier())*this.MOBILITY_FACTOR}}class VI extends MJ{getListMoves(t,e){const n=super.getListMoves(t,e);return this.orderMovesByPhalanxSizeAndFilter(n,t.gameState)}orderMovesByPhalanxSizeAndFilter(t,e){return yt.sortByDescending(t,n=>n.movedPieces),t.length>40?t.filter(i=>!!this.moveIsCapture(i,e)||i.movedPieces*Math.random()>1):t}moveIsCapture(t,e){const n=t.coord.getNext(t.direction,t.movedPieces+t.stepSize-1);return e.board[n.y][n.x]===e.getCurrentOpponent()}}class qRe extends fn{constructor(){super($localize`Attack`,Ai.get(),new WRe,new VI)}}class jRe extends Ha{getBoardValue(t,e){return mn.of(this.getPieceCountThenSupportThenAdvancement(t.gameState))}getPieceCountThenSupportThenAdvancement(t){const e=t.getWidth(),n=t.getHeight(),o=28*e+1,a=444*o+1;let c=0;for(const l of t.getCoordsAndContents()){const u=l.coord,f=l.content;if(f.isPlayer()){let g,y;f===O.ZERO?(g=n-u.y,y=[me.UP_LEFT,me.UP,me.UP_RIGHT]):(g=u.y+1,y=[me.DOWN_LEFT,me.DOWN,me.DOWN_RIGHT]);const S=f.getScoreModifier();c+=g*S,c+=a*S;for(const N of y){let R=u.getNext(N,1);for(;t.isOnBoard(R)&&t.getPieceAt(R)===f;)c+=S*o,R=R.getNext(N,1)}}}return c}}class ZRe extends fn{constructor(){super($localize`Positional`,Ai.get(),new jRe,new VI)}}class YRe extends EJ{getBoardValue(t,e){const n=t.gameState.getWidth(),i=t.gameState.getHeight();let o=0,s=0,a=0,c=0;for(let l=0;l<i;l++){let u=0;const f=we.of(0,0);for(let g=0;g<n;g++){const y=new _(g,l),S=t.gameState.getPieceAt(y);if(S.isPlayer()){const N=S.getScoreModifier();o+=N,f.put(S,N),u+=N;for(const R of[me.UP_LEFT,me.UP,me.UP_RIGHT]){let U=y.getNext(R,1);for(;t.gameState.isOnBoard(U)&&t.gameState.getPieceAt(U)===S;)s+=N,U=U.getNext(R,1)}}}0!==u&&(a+=Math.abs(u)/u),c+=f.get(O.ZERO)+f.get(O.ONE)}return mn.multiMetric([o,a,s,c])}}class KRe extends fn{constructor(){super($localize`Piece > Row Domination > Alignement > Row Presence`,Ai.get(),new YRe,new VI)}}function XRe(r,t){if(1&r){const e=he();I(),E(0,"circle",4),q("click",function(){te(e);const i=p().index,o=p().index;return ne(p().onClick(i,o))}),P()}if(2&r){const e=p().index,n=p().index,i=p();v("ngClass",i.getPieceClasses(e,n)),A("cx",i.SPACE_SIZE/2)("cy",i.SPACE_SIZE/2)("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)}}function QRe(r,t){if(1&r){const e=he();I(),E(0,"g")(1,"rect",2),q("click",function(){const o=te(e).index,s=p().index;return ne(p().onClick(o,s))}),P(),z(2,XRe,1,4,"circle",3),P()}if(2&r){const e=t.index,n=p().index,i=p();A("transform",i.getTranslationXY(e,n)),m(),ve("id","click_",e,"_",n,""),v("ngClass",i.getRectClasses(e,n)),A("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),m(),v("ngIf",i.board[n][e]!==i.NONE)}}function JRe(r,t){if(1&r&&(I(),E(0,"g"),z(1,QRe,3,7,"g",1),P()),2&r){const e=t.$implicit;m(),v("ngForOf",e)}}function exe(r,t){if(1&r){const e=he();I(),E(0,"g")(1,"rect",5),q("click",function(){const o=te(e).$implicit;return ne(p().onClick(o.x,o.y))}),P()()}if(2&r){const e=t.$implicit,n=p();m(),A("x",n.SPACE_SIZE*e.x)("y",n.SPACE_SIZE*e.y)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}let txe=(()=>{class r extends p2{NONE=B.NONE;firstPiece=h.empty();validExtensions=[];phalanxValidLandings=[];lastPiece=h.empty();phalanxDirection=h.empty();phalanxMiddles=[];moveds=[];capturedCoords=[];constructor(e){super(e),this.setRulesAndNode("Epaminondas"),this.availableAIs=[new KRe,new ZRe,new qRe,new zn($localize`MCTS`,new MJ,this.rules)],this.encoder=na.encoder,this.hasAsymmetricBoard=!0}updateBoard(e){var n=this;return M(function*(){n.firstPiece=h.empty(),n.lastPiece=h.empty(),n.hideLastMove(),n.board=n.getState().getCopiedBoard(),n.scores=n.getScores()})()}getScores(){const e=this.getState(),n=we.of(e.count(O.ZERO),e.count(O.ONE));return h.of(n)}showLastMove(e){var n=this;return M(function*(){let i=e.coord;n.moveds=[i];for(let a=1;a<e.stepSize+e.movedPieces;a++)i=i.getNext(e.direction,1),n.moveds.push(i);const o=n.node.parent.get(),s=o.gameState.getCurrentOpponent();for(;o.gameState.isOnBoard(i)&&o.gameState.getPieceAt(i)===s;)n.capturedCoords.push(i),i=i.getNext(e.direction,1)})()}onClick(e,n){var i=this;return M(function*(){const o=yield i.canUserPlay("#click_"+e+"_"+n);return o.isFailure()?i.cancelMove(o.getReason()):i.firstPiece.isAbsent()?i.firstClick(e,n):i.lastPiece.isAbsent()?i.secondClick(e,n):i.thirdClick(e,n)})()}firstClick(e,n){var i=this;return M(function*(){const o=i.getState().getCurrentOpponent(),s=i.getState().getCurrentPlayer();switch(i.board[n][e]){case s:return i.firstPiece=h.of(new _(e,n)),i.validExtensions=i.getValidExtensions(s),i.phalanxValidLandings=i.getPhalanxValidLandings(),w.SUCCESS;case o:return i.cancelMove(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT());default:return L.expectToBe(i.board[n][e],B.NONE),i.cancelMove(Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY())}})()}hideLastMove(){this.capturedCoords=[],this.moveds=[]}getValidExtensions(e){return this.lastPiece.isPresent()?this.getPhalanxValidExtensions(e):this.getFirstPieceExtensions(e)}getFirstPieceExtensions(e){const n=[];for(const i of me.DIRECTIONS){let o=this.firstPiece.get().getNext(i,1);for(;this.getState().isOnBoard(o)&&this.board[o.y][o.x]===e;)n.push(o),o=o.getNext(i,1)}return n}getPhalanxValidExtensions(e){let n=me.factory.fromMove(this.firstPiece.get(),this.lastPiece.get()).get();const i=this.lastPiece.get().getNext(n,1),o=this.getExtensionsToward(i,n,e);n=n.getOpposite();const s=this.firstPiece.get().getNext(n,1),a=this.getExtensionsToward(s,n,e);return o.concat(a)}getExtensionsToward(e,n,i){const o=[];for(;this.getState().isOnBoard(e)&&this.board[e.y][e.x]===i;)o.push(e),e=e.getNext(n,1);return o}getPhalanxValidLandings(){if(this.lastPiece.isPresent()){const e=this.firstPiece.get(),n=this.lastPiece.get(),i=Math.abs(e.x-n.x),o=Math.abs(e.y-n.y),s=Math.max(i,o)+1;let a=me.factory.fromMove(e,n).get();const c=n.getNext(a,1),l=this.getLandingsToward(c,a,s);a=a.getOpposite();const u=e.getNext(a,1);return this.getLandingsToward(u,a,s).concat(l)}return this.getNeighboringEmptySpaces()}getNeighboringEmptySpaces(){const e=[];for(const n of me.DIRECTIONS){const i=this.firstPiece.get().getNext(n,1);this.getState().isOnBoard(i)&&this.board[i.y][i.x]===B.NONE&&e.push(i)}return e}getLandingsToward(e,n,i){const o=this.getState().getCurrentPlayer(),s=this.getState().getCurrentOpponent(),a=[];for(;this.getState().isOnBoard(e)&&a.length<i&&this.board[e.y][e.x]!==o;){if(this.board[e.y][e.x]===s)return this.getPhalanxLength(e,n,s)<i&&a.push(e),a;a.push(e),e=e.getNext(n,1)}return a}getPhalanxLength(e,n,i){let o=0;for(;this.getState().isOnBoard(e)&&this.board[e.y][e.x]===i;)o++,e=e.getNext(n,1);return o}cancelMoveAttempt(){this.firstPiece=h.empty(),this.validExtensions=[],this.phalanxValidLandings=[],this.lastPiece=h.empty(),this.phalanxMiddles=[],this.hideLastMove()}secondClick(e,n){var i=this;return M(function*(){const o=new _(e,n),s=i.firstPiece.get();if(o.equals(s))return i.cancelMoveAttempt(),w.SUCCESS;const a=i.getState().getCurrentOpponent(),c=i.getState().getCurrentPlayer();if(!1===o.isAlignedWith(s))return i.cancelMove(ra.SQUARE_NOT_ALIGNED_WITH_SELECTED());const l=o.getDistance(s),u=s.getDirectionToward(o).get();switch(i.board[n][e]){case B.NONE:return 1===l?i.chooseMove(new na(s.x,s.y,1,1,u)):i.cancelMove(ra.SINGLE_PIECE_MUST_MOVE_BY_ONE());case a:return i.cancelMove(ra.SINGLE_PIECE_CANNOT_CAPTURE());default:L.expectToBe(i.board[n][e],c);const f=new na(s.x,s.y,l,1,u),g=i.getState(),y=Ai.getPhalanxValidity(g,f);return y.isFailure()?i.cancelMove(y.getReason()):(i.lastPiece=h.of(o),i.validExtensions=i.getValidExtensions(c),i.phalanxValidLandings=i.getPhalanxValidLandings(),i.phalanxMiddles=s.getCoordsToward(o),i.phalanxDirection=h.of(u),w.SUCCESS)}})()}thirdClick(e,n){var i=this;return M(function*(){const o=i.getState().getCurrentPlayer(),s=new _(e,n);if(i.firstPiece.equalsValue(s))return i.moveFirstPiece(o);if(i.lastPiece.equalsValue(s))return i.moveLastPiece(o);const a=i.firstPiece.get(),c=i.lastPiece.get();if(!1===s.isAlignedWith(a))return i.cancelMove(ra.SQUARE_NOT_ALIGNED_WITH_PHALANX());let l=me.factory.fromMove(a,c).get();const u=me.factory.fromMove(a,s).get();if(l===u.getOpposite()&&(i.firstPiece=h.of(c),i.lastPiece=h.of(a),l=u),l!==u)return i.cancelMove(ra.SQUARE_NOT_ALIGNED_WITH_PHALANX());if(i.board[n][e]===o)return i.thirdClickOnPlayerPiece(s,l,o);{const f=i.firstPiece.get().getDistance(i.lastPiece.get())+1,g=i.lastPiece.get().getDistance(s),y=new na(i.firstPiece.get().x,i.firstPiece.get().y,f,g,l);return i.chooseMove(y)}})()}thirdClickOnPlayerPiece(e,n,i){var o=this;return M(function*(){o.lastPiece=h.of(e);const s=o.firstPiece.get().getDistance(e)+1,a=new na(o.firstPiece.get().x,o.firstPiece.get().y,s,1,n),c=Ai.getPhalanxValidity(o.node.gameState,a);return c.isFailure()?o.cancelMove(c.getReason()):(o.phalanxMiddles=o.firstPiece.get().getCoordsToward(o.lastPiece.get()),o.validExtensions=o.getValidExtensions(i),o.phalanxValidLandings=o.getPhalanxValidLandings(),w.SUCCESS)})()}moveFirstPiece(e){var n=this;return M(function*(){return n.firstPiece=h.of(n.firstPiece.get().getNext(n.phalanxDirection.get(),1)),n.firstPiece.equals(n.lastPiece)?yield n.moveOnlyPiece(e):(n.phalanxMiddles=n.phalanxMiddles.slice(1),n.validExtensions=n.getPhalanxValidExtensions(e)),n.phalanxValidLandings=n.getPhalanxValidLandings(),w.SUCCESS})()}moveLastPiece(e){var n=this;return M(function*(){return n.lastPiece=h.of(n.lastPiece.get().getPrevious(n.phalanxDirection.get(),1)),n.firstPiece.equals(n.lastPiece)?n.moveOnlyPiece(e):(n.phalanxMiddles=n.firstPiece.get().getCoordsToward(n.lastPiece.get()),n.validExtensions=n.getPhalanxValidExtensions(e),n.phalanxValidLandings=n.getPhalanxValidLandings(),w.SUCCESS)})()}moveOnlyPiece(e){var n=this;return M(function*(){return n.lastPiece=h.empty(),n.validExtensions=n.getFirstPieceExtensions(e),n.phalanxDirection=h.empty(),n.phalanxMiddles=[],n.phalanxValidLandings=n.getPhalanxValidLandings(),w.SUCCESS})()}getPieceClasses(e,n){const i=this.getPlayerClass(this.board[n][e]);return this.getPieceStrokeClasses(e,n).concat([i])}getPieceStrokeClasses(e,n){const i=new _(e,n);return this.firstPiece.isAbsent()?[]:this.firstPiece.equalsValue(i)||this.lastPiece.equalsValue(i)||this.phalanxMiddles.some(o=>o.equals(i))?["selected-stroke"]:[]}getRectClasses(e,n){const i=new _(e,n);return this.capturedCoords.some(o=>o.equals(i))?["captured-fill"]:this.moveds.some(o=>o.equals(i))?["moved-fill"]:[]}getHighlightedCoords(){return!1===this.interactive?[]:this.firstPiece.isPresent()?this.phalanxValidLandings.concat(this.validExtensions):this.getCurrentPlayerPieces()}getCurrentPlayerPieces(){const e=[],i=this.getState().getCurrentPlayer();for(let o=0;o<this.getHeight();o++)for(let s=0;s<this.getWidth();s++)this.board[o][s]===i&&e.push(new _(s,o));return e}static \u0275fac=function(n){return new(n||r)(G(Ut))};static \u0275cmp=Ue({type:r,selectors:[["app-epaminondas"]],features:[$e],decls:3,vars:4,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["x","0","y","0",1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass","click",4,"ngIf"],[1,"base",3,"ngClass","click"],[1,"no-fill","mid-stroke","clickable-stroke",3,"click"]],template:function(n,i){1&n&&(I(),E(0,"svg",0),z(1,JRe,2,1,"g",1)(2,exe,2,4,"g",1),P()),2&n&&(A("viewBox",i.getViewBox().toSVGString())("transform",i.rotation),m(),v("ngForOf",i.board),m(),v("ngForOf",i.getHighlightedCoords()))},dependencies:[zt,Nt,bt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}return r})();const T=B.NONE,or=B.ZERO,a1=B.ONE,HI=Ai.get().getDefaultRulesConfig();class nxe extends Wn{tutorial=[W.informational($localize`Initial board`,$localize`This is the initial board of Epaminondas.
        The top line is the starting line of Light.
        The bottom line is the starting line of Dark.`,Ai.get().getInitialState(HI)),W.informational($localize`Goal of the game (1/2)`,$localize`After multiple moves, if at the beginning of its turn, a player has more pieces on the opponent's starting line
        than the number of pieces the opponent has on the player's starting line, the player wins.
        Here, it's Dark's turn to play: Dark has therefore won.`,new bd([[T,T,T,T,T,or,T,T,a1,a1,a1,a1,a1,a1],[T,T,T,T,T,or,T,T,T,T,T,T,a1,a1],[T,T,T,T,T,T,T,T,T,T,T,T,T,T],[T,T,T,T,T,T,T,T,T,T,T,T,T,T],[T,T,T,T,T,T,T,T,T,T,T,T,T,T],[T,T,T,T,T,T,T,T,T,T,T,T,T,T],[T,T,T,T,T,T,T,T,T,T,T,T,T,T],[T,T,T,T,T,T,T,T,T,T,T,T,T,T],[T,T,T,T,T,T,T,a1,T,T,T,T,T,T],[T,T,T,T,T,T,T,T,T,T,T,T,T,T],[T,T,T,T,T,T,T,T,T,T,T,T,T,T],[T,T,T,T,T,T,T,or,or,or,or,T,T,T]],0)),W.informational($localize`Goal of the game (2/2)`,$localize`Here, it is Light's turn.
        Light wins because they have two pieces on Dark's starting line, and Dark only has one on Light's starting line.`,new bd([[T,T,T,T,T,or,T,T,T,T,a1,a1,a1,a1],[T,T,T,T,T,or,T,T,T,T,T,T,T,T],[T,T,T,T,T,T,T,T,T,T,T,T,T,T],[T,T,T,T,T,T,T,T,T,T,T,T,T,T],[T,T,T,T,T,T,T,T,T,T,T,T,T,T],[T,T,T,T,T,T,T,T,T,T,T,T,T,T],[T,T,T,T,T,T,T,T,T,T,T,T,T,T],[T,T,T,T,T,T,T,T,T,T,T,T,T,T],[T,T,T,T,T,T,T,a1,T,T,T,T,T,T],[T,T,T,T,T,T,T,T,T,T,T,T,T,T],[T,T,T,T,T,T,T,T,T,T,T,T,T,T],[T,T,a1,a1,T,T,T,or,or,T,or,or,or,or]],1)),W.fromPredicate($localize`Moving a piece`,$localize`Here is the starting board. Dark plays first.
        Let's start with moving a single piece:
        <ol>
            <li>Click on a piece.</li>
            <li>Click on a empty neighboring square.</li>
        </ol><br/>You're playing Dark, move a piece.`,Ai.get().getInitialState(HI),new na(0,10,1,1,me.UP),(t,e,n)=>1===t.movedPieces?w.SUCCESS:w.failure($localize`Congratulations, you are in advance. But this is not the exercise here, try again.`),$localize`This is how you move a single piece.`),W.fromPredicate($localize`Moving a phalanx`,$localize`Let us now see how to move multiple pieces along a line, which is called a phalanx:
        <ol>
            <li>Click on the first piece of the phalanx.</li>
            <li>Click on the last piece of the phalanx.</li>
            <li>Click on one of the squares highlighted in yellow; you can move your phalanx up to a distance equal to its length.</li>
        </ol><br/>
        You're playing Dark, Move a phalanx!`,Ai.get().getInitialState(HI),new na(0,11,2,1,me.UP),(t,e,n)=>t.movedPieces>1?w.SUCCESS:w.failure($localize`Failed! You moved only one piece.`),$localize`Congratulations! The moved pieces can be horizontally, vertically, or diagonally aligned. The move should be made along this axis, forward or backwards. There can be no opponent nor holes in the phalanx.`),W.fromMove($localize`Captures`,$localize`In order to capture pieces of the opponent:
        <ol>
            <li>It must be aligned with the phalanx you are moving.</li>
            <li>It must be strictly shorter than your phalanx.</li>
            <li>The first piece of your phalanx should land on the first piece of the opponent's phalanx that you want to capture.</li>
        </ol><br/>
        You're playing Dark, capture a phalanx.`,new bd([[T,T,T,T,T,T,T,T,a1,a1,a1,a1,a1,a1],[T,T,T,T,T,T,a1,T,T,T,T,T,T,T],[T,T,T,T,T,a1,T,T,T,T,T,T,T,T],[T,T,a1,T,a1,T,T,T,T,T,T,T,T,T],[T,T,a1,a1,T,T,T,T,T,T,T,T,T,T],[T,T,a1,T,T,T,T,T,T,T,T,T,T,T],[T,T,T,T,T,T,T,T,T,T,T,T,T,T],[T,T,or,T,T,T,T,T,T,T,T,T,T,T],[T,T,or,T,T,T,T,a1,T,T,T,T,T,T],[T,T,or,T,T,T,T,T,T,T,T,T,T,T],[T,T,or,T,T,T,T,T,T,T,T,T,T,T],[T,T,T,T,T,T,T,or,or,or,or,or,or,or]],0),[new na(2,10,4,2,me.UP)],$localize`Congratulations, you made it!
        Note that the diagonal phalanx was not aligned with your phalanx, hence even if it is longer, this does not prevent you from capturing some of its pieces on another alignment.`,$localize`Failed, you have not captured the phalanx.`)]}class ji{static encoder=ke.tuple([ke.list(_.encoder)],t=>[t.capturedSpaces],t=>new ji(t[0]));static listEncoder=ke.list(ji.encoder);capturedSpaces;constructor(t){L.assert(4<=t.length,"Cannot create a GipfCapture with less than 4 captured pieces"),L.assert(ys.areOnSameLine(t),"Cannot create a GipfCapture with pieces that are not on the same line"),this.capturedSpaces=yt.copy(t).sort((n,i)=>n.x===i.x?(L.assert(n.y!==i.y,"Cannot create a GipfCapture with duplicate coords"),n.y>i.y?1:-1):n.x>i.x?1:-1);let e=h.empty();for(const n of this.capturedSpaces)L.assert(e.isAbsent()||1===e.get().getDistance(n),"Cannot create a GipfCapture with non-consecutive coords"),e=h.of(n)}toString(){let t="";for(const e of this.capturedSpaces)""!==t&&(t+=","),t+=e.toString();return t}size(){return this.capturedSpaces.length}forEach(t){this.capturedSpaces.forEach(t)}contains(t){for(let e=0;e<this.capturedSpaces.length;e++)if(this.capturedSpaces[e].equals(t))return!0;return!1}intersectsWith(t){return this.capturedSpaces.some(e=>t.contains(e))}getLine(){return ys.fromTwoCoords(this.capturedSpaces[0],this.capturedSpaces[1]).get()}equals(t){if(this===t)return!0;if(this.capturedSpaces.length!==t.capturedSpaces.length)return!1;for(let e=0;e<this.capturedSpaces.length;e++)if(!1===this.capturedSpaces[e].equals(t.capturedSpaces[e]))return!1;return!0}}class kC{static getPossibleCaptureCombinationsFromPossibleCaptures(t){const e=kC.computeIntersections(t);let n=[[]];return t.forEach((i,o)=>{if(0===e[o].length)n.forEach(s=>{s.push(o)});else{const s=[],a=e[o].some(c=>c>o);for(const c of n)!0===c.some(u=>e[o].some(f=>u===f))?s.push(yt.copy(c)):a?(s.push(yt.copy(c)),c.push(o),s.push(yt.copy(c))):(c.push(o),s.push(yt.copy(c)));n=s}}),n.map(i=>i.map(o=>t[o]))}static computeIntersections(t){const e=[];return t.forEach((n,i)=>{e.push([]),t.forEach((o,s)=>{i!==s&&n.intersectsWith(o)&&e[i].push(s)})}),e}}class ia{coord;direction;static encoder=ke.tuple([_.encoder,h.getEncoder(Te.encoder)],t=>[t.coord,t.direction],t=>new ia(t[0],t[1]));constructor(t,e){this.coord=t,this.direction=e}toString(){return this.direction.isPresent()?this.coord.toString()+"@"+this.direction.get().toString():this.coord.toString()}equals(t){return!1!==this.coord.equals(t.coord)&&this.direction.equals(t.direction)}}class Ba extends h2{placement;initialCaptures;finalCaptures;static encoder=ke.tuple([ia.encoder,ji.listEncoder,ji.listEncoder],t=>[t.placement,t.initialCaptures,t.finalCaptures],t=>new Ba(t[0],t[1],t[2]));constructor(t,e,n){super(),this.placement=t,this.initialCaptures=e,this.finalCaptures=n}toString(){return"GipfMove(["+this.capturesToString(this.initialCaptures)+"], "+this.placement.toString()+", ["+this.capturesToString(this.finalCaptures)+"])"}capturesToString(t){let e="";for(const n of t)""!==e&&(e+=","),e+="["+n.toString()+"]";return e}equals(t){return this===t||!(!1===this.placement.equals(t.placement)||!1===yt.equals(this.initialCaptures,t.initialCaptures)||!1===yt.equals(this.finalCaptures,t.finalCaptures))}}class r4 extends zI{sidePieces;capturedPieces;constructor(t,e,n,i){super(e,t,7,7,[3,2,1],Pe.EMPTY),this.sidePieces=n,this.capturedPieces=i}equals(t){return this.turn===t.turn&&!1!==this.sidePieces.equals(t.sidePieces)&&!1!==this.capturedPieces.equals(t.capturedPieces)&&rt.compare(this.board,t.board)}getNumberOfPiecesToPlace(t){return this.sidePieces.get(t)}getNumberOfPiecesCaptured(t){return this.capturedPieces.get(t)}setAtUnsafe(t,e){const n=rt.copy(this.board);return n[t.y][t.x]=e,new r4(n,this.turn,this.sidePieces,this.capturedPieces)}isOnBoard(t){return!t.isNotInRange(this.width,this.height)&&this.board[t.y][t.x]!==Pe.UNREACHABLE}}let oa=(()=>class r{static CAPTURE_MUST_BE_ALIGNED=()=>$localize`You can only capture when 4 or more of your pieces are aligned, and it is not the case.`;static INVALID_CAPTURED_PIECES=()=>$localize`You must select a valid capture that contains 4 pieces or more.`;static MISSING_CAPTURES=()=>$localize`There are still possible captures to be done.`;static PLACEMENT_NOT_ON_BORDER=()=>$localize`Pieces must be inserted in spaces on the edge of the board.`;static INVALID_PLACEMENT_DIRECTION=()=>$localize`You must select a valid placement direction.`;static PLACEMENT_WITHOUT_DIRECTION=()=>$localize`You must select a placement with a direction alongside the insertion space.`;static PLACEMENT_ON_COMPLETE_LINE=()=>$localize`You cannot place a piece on a complete line.`;static AMBIGUOUS_CAPTURE_COORD=()=>$localize`This piece belongs to two captures. Please select another piece in the capture you'd like to make.`;static NO_DIRECTIONS_AVAILABLE=()=>$localize`You cannot insert a piece here, as all lines are full. Select another space.`})();class rn extends Ar{static singleton=h.empty();static get(){return rn.singleton.isAbsent()&&(rn.singleton=h.of(new rn)),rn.singleton.get()}getInitialState(){const t=Pe.EMPTY,e=Pe.UNREACHABLE,n=Pe.ZERO,i=Pe.ONE;return new r4([[e,e,e,i,t,t,n],[e,e,t,t,t,t,t],[e,t,t,t,t,t,t],[n,t,t,t,t,t,i],[t,t,t,t,t,t,e],[t,t,t,t,t,e,e],[i,t,t,n,e,e,e]],0,we.of(12,12),we.of(0,0))}applyLegalMove(t,e,n,i){return new r4(i.board,i.turn+1,i.sidePieces,i.capturedPieces)}static applyCaptures(t,e){let n=e;return t.forEach(i=>{n=rn.applyCapture(i,n)}),n}static applyCapture(t,e){const n=e.getCurrentPlayer();let i=e;const o=e.sidePieces.getCopy(),s=e.capturedPieces.getCopy();return t.forEach(a=>{const c=e.getPieceAt(a);i=i.setAt(a,Pe.EMPTY),c.is(n)?o.add(n,1):s.add(n,1)}),new r4(i.board,e.turn,o,s)}static getPlacements(t){const e=[];return Yr.INSTANCE.getAllBorders(t).forEach(n=>{t.getPieceAt(n)===Pe.EMPTY?e.push(new ia(n,h.empty())):rn.getAllDirectionsForEntrance(t,n).forEach(i=>{!1===rn.isLineComplete(t,n,i)&&e.push(new ia(n,h.of(i)))})}),e}static isLineComplete(t,e,n){return rn.nextGapInLine(t,e,n).isAbsent()}static nextGapInLine(t,e,n){for(let i=e;t.isOnBoard(i);i=i.getNext(n))if(t.getPieceAt(i)===Pe.EMPTY)return h.of(i);return h.empty()}static applyPlacement(t,e){const n=e.getCurrentPlayer();let i=e,o=Pe.ofPlayer(e.getCurrentPlayer());if(t.direction.isAbsent()){const a=t.coord;if(e.getPieceAt(a)!==Pe.EMPTY)throw new Error("Apply placement called without direction while the coord is occupied");i=i.setAt(a,o)}else for(let a=t.coord;i.isOnBoard(a)&&o!==Pe.EMPTY;a=a.getNext(t.direction.get())){const c=e.getPieceAt(a);i=i.setAt(a,o),o=c}const s=e.sidePieces.getCopy();return s.add(n,-1),new r4(i.board,e.turn,s,e.capturedPieces)}getPiecesMoved(t,e,n){const i=rn.applyCaptures(e,t);if(n.direction.isAbsent())return[n.coord];{const o=n.direction.get(),s=[];s.push(n.coord);let a=n.coord.getNext(o);for(;i.isOnBoard(a)&&i.getPieceAt(a)!==Pe.EMPTY;)s.push(a),a=a.getNext(o);return L.assert(i.isOnBoard(a)&&i.getPieceAt(a)===Pe.EMPTY,"getPiecesMoved called with an invalid placement performed on a full line"),s.push(a),s}}static getAllDirectionsForEntrance(t,e){if(Yr.INSTANCE.isTopLeftCorner(t,e))return[Te.RIGHT,Te.DOWN,Te.UP_RIGHT];if(Yr.INSTANCE.isTopCorner(t,e))return[Te.DOWN,Te.DOWN_LEFT,Te.RIGHT];if(Yr.INSTANCE.isTopRightCorner(t,e))return[Te.DOWN_LEFT,Te.DOWN,Te.LEFT];if(Yr.INSTANCE.isBottomLeftCorner(t,e))return[Te.UP_RIGHT,Te.UP,Te.RIGHT];if(Yr.INSTANCE.isBottomCorner(t,e))return[Te.UP,Te.LEFT,Te.UP_RIGHT];if(Yr.INSTANCE.isBottomRightCorner(t,e))return[Te.LEFT,Te.UP,Te.DOWN_LEFT];if(Yr.INSTANCE.isOnTopLeftBorder(t,e))return[Te.RIGHT,Te.DOWN];if(Yr.INSTANCE.isOnLeftBorder(t,e))return[Te.UP_RIGHT,Te.RIGHT];if(Yr.INSTANCE.isOnBottomLeftBorder(t,e))return[Te.UP,Te.UP_RIGHT];if(Yr.INSTANCE.isOnBottomRightBorder(t,e))return[Te.LEFT,Te.UP];if(Yr.INSTANCE.isOnRightBorder(t,e))return[Te.LEFT,Te.DOWN_LEFT];if(Yr.INSTANCE.isOnTopRightBorder(t,e))return[Te.DOWN_LEFT,Te.DOWN];throw new Error("not a border")}isLegal(t,e){const n=this.capturesValidity(e,t.initialCaptures);if(n.isFailure())return n.toOtherFallible();const i=rn.applyCaptures(t.initialCaptures,e),o=this.noMoreCapturesValidity(i);if(o.isFailure())return o.toOtherFallible();const s=this.placementValidity(i,t.placement);if(s.isFailure())return s.toOtherFallible();const a=rn.applyPlacement(t.placement,i),c=this.capturesValidity(a,t.finalCaptures);if(c.isFailure())return c.toOtherFallible();const l=rn.applyCaptures(t.finalCaptures,a),u=this.noMoreCapturesValidity(l);return u.isFailure()?u.toOtherFallible():X.success(l)}capturesValidity(t,e){let n=t;for(const i of e){const o=this.captureValidity(n,i);if(o.isFailure())return o;n=rn.applyCapture(i,n)}return w.SUCCESS}captureValidity(t,e){const n=t.getCurrentPlayer(),i=rn.getLinePortionWithFourPiecesOfPlayer(t,n,e.getLine());if(i.isAbsent())return w.failure(oa.CAPTURE_MUST_BE_ALIGNED());const o=i.get();return rn.getCapturable(t,o).equals(e)?w.SUCCESS:w.failure(oa.INVALID_CAPTURED_PIECES())}static getLinePortionsWithFourPiecesOfPlayer(t,e){const n=[];return t.allLines().forEach(i=>{const o=rn.getLinePortionWithFourPiecesOfPlayer(t,e,i);o.isPresent()&&n.push(o.get())}),n}static getLinePortionWithFourPiecesOfPlayer(t,e,n){let i=0;const o=t.getEntranceOnLine(n),s=n.getDirection();let a=o;for(let c=o;t.isOnBoard(c);c=c.getNext(s))if(t.getPieceAt(c).is(e)?(0===i&&(a=c),i+=1):i=0,4===i)return h.of({0:a,1:c,2:s});return h.empty()}noMoreCapturesValidity(t){const e=t.getCurrentPlayer();return 0===rn.getLinePortionsWithFourPiecesOfPlayer(t,e).length?w.SUCCESS:w.failure(oa.MISSING_CAPTURES())}placementValidity(t,e){const n=this.placementCoordValidity(t,e.coord);if(n.isFailure())return n;if(t.getPieceAt(e.coord)!==Pe.EMPTY){if(e.direction.isAbsent())return w.failure(oa.PLACEMENT_WITHOUT_DIRECTION());if(rn.isLineComplete(t,e.coord,e.direction.get()))return w.failure(oa.PLACEMENT_ON_COMPLETE_LINE());for(const i of rn.getAllDirectionsForEntrance(t,e.coord))if(i===e.direction.get())return w.SUCCESS;return w.failure(oa.INVALID_PLACEMENT_DIRECTION())}return w.SUCCESS}placementCoordValidity(t,e){return Yr.INSTANCE.isOnBorder(t,e)?w.SUCCESS:w.failure(oa.PLACEMENT_NOT_ON_BORDER())}static getCapturable(t,e){const n=[],i=e[0],o=e[1],s=e[2],a=s.getOpposite();let c=i.getNext(a);for(;t.isOnBoard(c)&&t.getPieceAt(c)!==Pe.EMPTY;)n.push(c),c=c.getNext(a);for(let l=i;!1===l.equals(o);l=l.getNext(s))n.push(l);for(let l=o;t.isOnBoard(l)&&t.getPieceAt(l)!==Pe.EMPTY;l=l.getNext(s))n.push(l);return new ji(n)}static getPossibleCaptures(t){const e=t.getCurrentPlayer(),n=[];return rn.getLinePortionsWithFourPiecesOfPlayer(t,e).forEach(i=>{n.push(rn.getCapturable(t,i))}),n}static getPlayerScore(t,e){const n=t.getNumberOfPiecesToPlace(e);if(0===n&&0===rn.getPossibleCaptures(t).length)return h.empty();const i=t.getNumberOfPiecesCaptured(e);return h.of(n+3*i)}static isGameOver(t){const e=rn.getPlayerScore(t,O.ZERO),n=rn.getPlayerScore(t,O.ONE);return e.isAbsent()||n.isAbsent()}getGameStatus(t){const e=t.gameState,n=rn.getPlayerScore(e,O.ZERO),i=rn.getPlayerScore(e,O.ONE);return n.isAbsent()?ye.ONE_WON:i.isAbsent()?ye.ZERO_WON:ye.ONGOING}}class PJ extends fJ{source;destination;constructor(t,e,n,i,o,s){super(n,i,o,s),this.source=t,this.destination=e}}class SJ extends Kn{getListMoves(t,e){const n=t.gameState,i=[];return rn.isGameOver(n)||this.getPossibleCaptureCombinations(n).forEach(o=>{const s=rn.applyCaptures(o,n);rn.getPlacements(s).forEach(a=>{const c=rn.applyPlacement(a,s);this.getPossibleCaptureCombinations(c).forEach(l=>{const u=new Ba(a,o,l);i.push(u)})})}),i}getPossibleCaptureCombinations(t){const e=rn.getPossibleCaptures(t);return kC.getPossibleCaptureCombinationsFromPossibleCaptures(e)}}class rxe extends rr{getMetrics(t,e){const n=t.gameState;return G1.ofSingle(rn.getPlayerScore(n,O.ZERO).get(),rn.getPlayerScore(n,O.ONE).get())}}function ixe(r,t){if(1&r&&(I(),V(0,"circle",13)),2&r){const e=p().$implicit,n=p();v("ngClass",n.getPieceClass(e)),A("r",n.SPACE_SIZE)}}function oxe(r,t){if(1&r){const e=he();I(),E(0,"g",10),q("click",function(){const o=te(e).$implicit;return ne(p().onClick(o))}),V(1,"polygon",11),z(2,ixe,1,2,"circle",12),P()}if(2&r){const e=t.$implicit,n=p();ve("id","click_",e.x,"_",e.y,""),A("transform",n.getHexaCenterTranslation(e)),m(),ve("id","space_",e.x,"_",e.y,""),v("ngClass",n.getSpaceClass(e)),A("points",n.getHexaPoints()),m(),v("ngIf",n.isPiece(e))}}function sxe(r,t){if(1&r){const e=he();I(),E(0,"polygon",16),q("click",function(){const o=te(e).$implicit;return ne(p(2).onClick(o))}),P()}if(2&r){const e=t.$implicit,n=p(2);A("points",n.getHexaPoints())("transform",n.getHexaCenterTranslation(e))}}function axe(r,t){if(1&r&&(I(),E(0,"g",14),z(1,sxe,1,2,"polygon",15),P()),2&r){const e=t.$implicit;m(),v("ngForOf",e.capturedSpaces)}}function cxe(r,t){if(1&r&&(I(),V(0,"line",17)),2&r){const e=t.$implicit;A("x1",e.x1)("y1",e.y1)("x2",e.x2)("y2",e.y2)}}function lxe(r,t){if(1&r&&(I(),E(0,"g"),V(1,"circle",18),P()),2&r){const e=t.$implicit,n=p().$implicit,i=p();m(),ve("id","piece_",n.getValue(),"_",e,""),v("ngClass",i.getPlayerClass(n)),A("cx",i.getRemainingPieceCx(n,e))("cy",i.getRemainingPieceCy(n))("r",.5*i.SPACE_SIZE)}}function uxe(r,t){if(1&r&&(I(),E(0,"g"),z(1,lxe,2,6,"g",8),P()),2&r){const e=t.$implicit,n=p();m(),v("ngForOf",n.getPlayerSidePieces(e))}}function fxe(r,t){if(1&r&&(I(),V(0,"line",19)),2&r){const e=p();A("x1",e.inserted.get().x1)("y1",e.inserted.get().y1)("x2",e.inserted.get().x2)("y2",e.inserted.get().y2)}}let dxe=(()=>{class r extends ru{static PHASE_INITIAL_CAPTURE=0;static PHASE_PLACEMENT_COORD=1;static PHASE_PLACEMENT_DIRECTION=2;static PHASE_FINAL_CAPTURE=3;inserted=h.empty();arrows=[];captured=[];moved=[];hexagonWidth=this.SPACE_SIZE;sharedHexagonX=Math.cos(30)*this.hexagonWidth*.5;boardWidth=this.hexagonWidth+6*(this.hexagonWidth-this.sharedHexagonX)+3*this.STROKE_WIDTH/2;boardHeight=7*this.hexagonWidth+4.5*this.STROKE_WIDTH;movePhase=r.PHASE_PLACEMENT_COORD;constructedState;possibleCaptures=[];initialCaptures=[];placement=h.empty();placementEntrance=h.empty();finalCaptures=[];constructor(e){super(e),this.setRulesAndNode("Gipf"),this.availableAIs=[new fn($localize`Score`,this.rules,new rxe,new SJ),new zn($localize`MCTS`,new SJ,this.rules)],this.encoder=Ba.encoder,this.hasAsymmetricBoard=!0,this.scores=h.of(we.of(0,0)),this.SPACE_SIZE=40,this.constructedState=this.getState(),this.hexaLayout=new iu(1.5*this.SPACE_SIZE,new _(this.hexagonWidth/2+3*this.STROKE_WIDTH/4,-this.hexagonWidth),Yr.INSTANCE)}updateBoard(e){var n=this;return M(function*(){n.constructedState=n.getState(),n.captured=[],n.moved=[],n.initialCaptures=[],n.finalCaptures=[],n.placementEntrance=h.empty(),n.placement=h.empty(),n.arrows=[],n.moveToInitialCaptureOrPlacementPhase()})()}showLastMove(e){var n=this;return M(function*(){const i=n.getPreviousState();if(e.initialCaptures.forEach(o=>n.markCapture(o)),e.finalCaptures.forEach(o=>n.markCapture(o)),n.moved=n.rules.getPiecesMoved(i,e.initialCaptures,e.placement),n.inserted=h.empty(),e.placement.direction.isPresent()){const o=e.placement;n.inserted=h.of(n.arrowTowards(o.coord,o.direction.get()))}})()}arrowTowards(e,n){const i=e.getNext(n.getOpposite()),o=this.getCenterAt(e),s=this.getCenterAt(i);return new PJ(i,e,s.x,s.y,o.x,o.y)}markCapture(e){e.forEach(n=>{this.captured.push(n)})}getAllCoords(){return this.constructedState.allCoords()}getPlayerSidePieces(e){const n=this.constructedState.getNumberOfPiecesToPlace(e),i=[];for(let o=0;o<n;o+=1)i.push(o);return i}isPiece(e){return this.getPiece(e)!==Pe.EMPTY}getPiece(e){return this.constructedState.getPieceAt(e)}onClick(e){var n=this;return M(function*(){const i=yield n.canUserPlay("#click_"+e.x+"_"+e.y);if(i.isFailure())return n.cancelMove(i.getReason());switch(n.movePhase){case r.PHASE_INITIAL_CAPTURE:case r.PHASE_FINAL_CAPTURE:return n.selectCapture(e);case r.PHASE_PLACEMENT_COORD:return n.selectPlacementCoord(e);default:return L.expectToBe(n.movePhase,r.PHASE_PLACEMENT_DIRECTION),n.selectPlacementDirectionOrPlacementCoord(e)}})()}selectCapture(e){var n=this;return M(function*(){const i=[];if(n.possibleCaptures.forEach(s=>{s.contains(e)&&i.push(s)}),i.length>1)return n.cancelMove(oa.AMBIGUOUS_CAPTURE_COORD());if(0===i.length)return n.cancelMove(oa.MISSING_CAPTURES());const o=i[0];return n.constructedState=rn.applyCapture(o,n.constructedState),n.markCapture(o),n.possibleCaptures=rn.getPossibleCaptures(n.constructedState),n.movePhase===r.PHASE_INITIAL_CAPTURE?(n.initialCaptures.push(o),0===n.possibleCaptures.length?n.moveToPlacementPhase():w.SUCCESS):(L.expectToBe(n.movePhase,r.PHASE_FINAL_CAPTURE),n.finalCaptures.push(o),0===n.possibleCaptures.length?n.tryMove(n.initialCaptures,n.placement.get(),n.finalCaptures):w.SUCCESS)})()}moveToPlacementPhase(){return this.movePhase=r.PHASE_PLACEMENT_COORD,w.SUCCESS}moveToInitialCaptureOrPlacementPhase(){return this.possibleCaptures=rn.getPossibleCaptures(this.constructedState),this.movePhase=0===this.possibleCaptures.length?r.PHASE_PLACEMENT_COORD:r.PHASE_INITIAL_CAPTURE,w.SUCCESS}moveToFinalCapturePhaseOrTryMove(){var e=this;return M(function*(){return e.possibleCaptures=rn.getPossibleCaptures(e.constructedState),0===e.possibleCaptures.length?e.tryMove(e.initialCaptures,e.placement.get(),e.finalCaptures):(e.movePhase=r.PHASE_FINAL_CAPTURE,w.SUCCESS)})()}computeArrows(e){this.arrows=[];for(const n of rn.getAllDirectionsForEntrance(this.constructedState,e))if(!1===rn.isLineComplete(this.constructedState,e,n)){const i=e.getNext(n),o=this.getCenterAt(e),s=this.getCenterAt(i);this.arrows.push(new PJ(e,i,o.x,o.y,s.x,s.y))}}selectPlacementCoord(e){var n=this;return M(function*(){const i=n.rules.placementCoordValidity(n.constructedState,e);return i.isFailure()?n.cancelMove(i.getReason()):n.placementEntrance.equalsValue(e)?(n.cancelMoveAttempt(),w.SUCCESS):(n.placementEntrance=h.of(e),n.constructedState.getPieceAt(e)===Pe.EMPTY?n.selectPlacementDirection(h.empty()):(n.movePhase=r.PHASE_PLACEMENT_DIRECTION,n.computeArrows(e),0===n.arrows.length&&(yield n.cancelMove(oa.NO_DIRECTIONS_AVAILABLE())),w.SUCCESS))})()}selectPlacementDirection(e){var n=this;return M(function*(){n.placement=h.of(new ia(n.placementEntrance.get(),e));const i=n.rules.placementValidity(n.constructedState,n.placement.get());return i.isFailure()?n.cancelMove(i.getReason()):(n.arrows=[],n.constructedState=rn.applyPlacement(n.placement.get(),n.constructedState),n.moveToFinalCapturePhaseOrTryMove())})()}selectPlacementDirectionOrPlacementCoord(e){var n=this;return M(function*(){const i=n.placementEntrance.get();if(!1===i.isAlignedWith(e)||1!==i.getDistance(e))return n.selectPlacementCoord(e);const o=Te.factory.fromMove(i,e);return n.selectPlacementDirection(o.toOptional())})()}tryMove(e,n,i){const o=new Ba(n,e,i);return this.chooseMove(o)}cancelMoveAttempt(){this.constructedState=this.getState(),this.captured=[],this.moved=[],this.initialCaptures=[],this.finalCaptures=[],this.placementEntrance=h.empty(),this.placement=h.empty(),this.arrows=[],this.moveToInitialCaptureOrPlacementPhase()}hideLastMove(){this.arrows=[],this.inserted=h.empty()}getSpaceClass(e){return this.captured.some(n=>n.equals(e))?"captured-fill":this.moved.some(n=>n.equals(e))?"moved-fill":""}getPieceClass(e){const n=this.getPiece(e);return this.getPlayerClass(n.getPlayer())}getRemainingPieceCy(e){return e===O.ONE?25:this.boardHeight-25}getRemainingPieceCx(e,n){const i=20+n*this.SPACE_SIZE*.5;return e===O.ONE?i:this.boardWidth-(15+i)}static \u0275fac=function(n){return new(n||r)(G(Ut))};static \u0275cmp=Ue({type:r,selectors:[["app-gipf"]],features:[$e],decls:11,vars:7,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["id","arrowhead","markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto"],["points","0 0, 10 3.5, 0 7"],["id","arrowhead-moved","markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto"],["points","0 0, 10 3.5, 0 7",1,"moved-fill","moved-stroke"],[3,"id","click",4,"ngFor","ngForOf"],["pointer-events","fill","class","capturable-stroke",4,"ngFor","ngForOf"],["class","arrow click-delegator","marker-end","url(#arrowhead)",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],["class","arrow moved-stroke click-delegator","marker-end","url(#arrowhead-moved)",4,"ngIf"],[3,"id","click"],["stroke-linecap","round",1,"base",3,"id","ngClass"],["cx","0","cy","0","class","base",3,"ngClass",4,"ngIf"],["cx","0","cy","0",1,"base",3,"ngClass"],["pointer-events","fill",1,"capturable-stroke"],["class","no-fill","stroke-linecap","round",3,"click",4,"ngFor","ngForOf"],["stroke-linecap","round",1,"no-fill",3,"click"],["marker-end","url(#arrowhead)",1,"arrow","click-delegator"],[1,"base","small-stroke",3,"id","ngClass"],["marker-end","url(#arrowhead-moved)",1,"arrow","moved-stroke","click-delegator"]],template:function(n,i){1&n&&(I(),E(0,"svg",0)(1,"defs")(2,"marker",1),V(3,"polygon",2),P(),E(4,"marker",3),V(5,"polygon",4),P()(),z(6,oxe,3,8,"g",5)(7,axe,2,1,"g",6)(8,cxe,1,4,"line",7)(9,uxe,2,1,"g",8)(10,fxe,1,4,"line",9),P()),2&n&&(A("viewBox",-i.STROKE_WIDTH+" 0 "+i.boardWidth+" "+i.boardHeight)("transform",i.rotation),m(6),v("ngForOf",i.getAllCoords()),m(),v("ngForOf",i.possibleCaptures),m(),v("ngForOf",i.arrows),m(),v("ngForOf",i.Player.PLAYERS),m(),v("ngIf",i.inserted.isPresent()))},dependencies:[zt,Nt,bt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}return r})();class Xr extends Nr{static PASS=new Xr(-1,0);static ACCEPT=new Xr(-2,0);static encoder=Nr.getEncoder(Xr.of);static of(t){return new Xr(t.x,t.y)}toString(){return this===Xr.PASS?"GoMove.PASS":this===Xr.ACCEPT?"GoMove.ACCEPT":"GoMove("+this.coord.x+", "+this.coord.y+")"}}class Ye{player;type;static DARK=new Ye(O.ZERO,"alive");static LIGHT=new Ye(O.ONE,"alive");static EMPTY=new Ye(B.NONE,"empty");static DEAD_DARK=new Ye(O.ZERO,"dead");static DEAD_LIGHT=new Ye(O.ONE,"dead");static DARK_TERRITORY=new Ye(O.ZERO,"territory");static LIGHT_TERRITORY=new Ye(O.ONE,"territory");constructor(t,e){this.player=t,this.type=e}equals(t){return t===this}toString(){switch(this){case Ye.DARK:return"GoPiece.DARK";case Ye.LIGHT:return"GoPiece.LIGHT";case Ye.EMPTY:return"GoPiece.EMPTY";case Ye.DEAD_DARK:return"GoPiece.DEAD_DARK";case Ye.DEAD_LIGHT:return"GoPiece.DEAD_LIGHT";case Ye.DARK_TERRITORY:return"GoPiece.DARK_TERRITORY";default:return L.assert(this===Ye.LIGHT_TERRITORY,"Unexisting GoPiece"),"GoPiece.LIGHT_TERRITORY"}}static pieceBelongTo(t,e){return e===t.player&&"territory"!==t.type}static ofPlayer(t){return t===O.ZERO?Ye.DARK:Ye.LIGHT}isOccupied(){return"alive"===this.type||"dead"===this.type}isEmpty(){return"territory"===this.type||"empty"===this.type}isDead(){return"dead"===this.type}isTerritory(){return"territory"===this.type}getOwner(){return this.player}nonTerritory(){return L.assert(this.isEmpty(),'Usually not false, if false, cover by test and return "this"'),Ye.EMPTY}}var yn=function(r){return r.PLAYING="PLAYING",r.PASSED="PASSED",r.COUNTING="COUNTING",r.ACCEPT="ACCEPT",r.FINISHED="FINISHED",r}(yn||{});class kr extends B1{koCoord;captured;phase;constructor(t,e,n,i,o){super(t,n),this.captured=e,this.koCoord=i,this.phase=o}getCapturedCopy(){return this.captured.getCopy()}static getStartingBoard(t){return rt.create(t.width,t.height,Ye.EMPTY)}copy(){return new kr(this.getCopiedBoard(),this.getCapturedCopy(),this.turn,this.koCoord,this.phase)}isDead(t){return this.getPieceAt(t).isDead()}isTerritory(t){return this.getPieceAt(t).isTerritory()}}let FI=class{getGroupDatas(t,e){const i=this.getNewInstance(e[t.y][t.x]);return this._getGroupDatas(t,e,i)}_getGroupDatas(t,e,n){const i=e[t.y][t.x];if(n.addPawn(t,i),i===n.color)for(const o of this.getDirections()){const s=t.getNext(o);s.isInRange(e[0].length,e.length)&&!1===n.contains(s)&&(n=this._getGroupDatas(s,e,n))}return n}};FI=function(r,t,e,n){var s,i=arguments.length,o=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,e):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,t,e,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(t,e,o):s(t,e))||o);return i>3&&o&&Object.defineProperty(t,e,o),o}([Ae.log],FI);class gu{color;constructor(t){this.color=t}selfContains(t){return this.getCoords().some(n=>n.equals(t))}static insertAsEntryPoint(t,e){return 0===t.length?[e]:e.compareTo(t[0])<0?[e].concat(t):t.concat([e])}}class pxe extends gu{emptyCoords;darkCoords;lightCoords;deadDarkCoords;deadLightCoords;constructor(t,e,n,i,o,s){super(t),this.emptyCoords=e,this.darkCoords=n,this.lightCoords=i,this.deadDarkCoords=o,this.deadLightCoords=s}getCoords(){return this.color===Ye.DARK?this.darkCoords:this.color===Ye.LIGHT?this.lightCoords:this.color===Ye.DEAD_DARK?this.deadDarkCoords:this.color===Ye.DEAD_LIGHT?this.deadLightCoords:this.emptyCoords}contains(t){return this.darkCoords.concat(this.lightCoords.concat(this.emptyCoords.concat(this.deadDarkCoords.concat(this.deadLightCoords)))).some(n=>n.equals(t))}addPawn(t,e){switch(pn(!1===this.contains(t),"This group already contains "+t.toString()),e){case Ye.DARK:this.darkCoords=gu.insertAsEntryPoint(this.darkCoords,t);break;case Ye.LIGHT:this.lightCoords=gu.insertAsEntryPoint(this.lightCoords,t);break;case Ye.DEAD_DARK:this.deadDarkCoords=gu.insertAsEntryPoint(this.deadDarkCoords,t);break;case Ye.DEAD_LIGHT:this.deadLightCoords=gu.insertAsEntryPoint(this.deadLightCoords,t);break;default:L.expectToBeMultiple(e,[Ye.EMPTY,Ye.DARK_TERRITORY,Ye.LIGHT_TERRITORY]),this.emptyCoords=gu.insertAsEntryPoint(this.emptyCoords,t)}}isMonoWrapped(){return(this.darkCoords.length+this.deadLightCoords.length===0?0:1)+(this.lightCoords.length+this.deadDarkCoords.length===0?0:1)==1}getWrapper(){const t=new gn;t.set(Ye.EMPTY,this.emptyCoords.length),t.set(Ye.DARK,this.darkCoords.length+this.deadLightCoords.length),t.set(Ye.LIGHT,this.lightCoords.length+this.deadDarkCoords.length),t.put(this.color.nonTerritory(),0);const e=t.filter((n,i)=>i>0);return L.assert(1===e.size(),"Can't call getWrapper on non-mono-wrapped group"),e.getAnyPair().get().key}getNeighborsEntryPoints(){const t=[];return this.color!==Ye.EMPTY&&this.emptyCoords.length>0&&t.push(this.emptyCoords[0]),this.color!==Ye.DARK&&this.darkCoords.length>0&&t.push(this.darkCoords[0]),this.color!==Ye.LIGHT&&this.lightCoords.length>0&&t.push(this.lightCoords[0]),this.color!==Ye.DEAD_DARK&&this.deadDarkCoords.length>0&&t.push(this.deadDarkCoords[0]),this.color!==Ye.DEAD_LIGHT&&this.deadLightCoords.length>0&&t.push(this.deadLightCoords[0]),t}}class Ad extends FI{getNewInstance(t){return new pxe(t,[],[],[],[],[])}getDirections(){return Ie.ORTHOGONALS}}let Nd=(()=>class r{static ILLEGAL_KO=()=>$localize`This move is a ko, you must play somewhere else before you can play in this intersection again.`;static CANNOT_PASS_AFTER_PASSED_PHASE=()=>$localize`We are in the counting phase, you must mark stones as dead or alive or accept the current board by passing your turn.`;static CANNOT_ACCEPT_BEFORE_COUNTING_PHASE=()=>$localize`You cannot accept before the counting phase.`;static OCCUPIED_INTERSECTION=()=>$localize`This intersection is already occupied.`;static CANNOT_COMMIT_SUICIDE=()=>$localize`You cannot commit suicide.`})();var Mn;let $a=class extends Da{static#e=Mn=this;static singleton=h.empty();static RULES_CONFIG_DESCRIPTION=new fo({name:()=>$localize`19 x 19`,config:{width:new _1(19,Gi.WIDTH,m1.range(1,99)),height:new _1(19,Gi.HEIGHT,m1.range(1,99)),handicap:new _1(0,()=>$localize`Handicap`,m1.range(0,9))}},[{name:()=>$localize`13 x 13`,config:{width:13,height:13,handicap:0}},{name:()=>$localize`9 x 9`,config:{width:9,height:9,handicap:0}}]);static get(){return Mn.singleton.isAbsent()&&(Mn.singleton=h.of(new Mn)),Mn.singleton.get()}getInitialState(t){const e=t.get(),n=kr.getStartingBoard(e);let i=0;const o=_2.getHorizontalLeft(e.width),s=_2.getHorizontalRight(e.width),a=_2.getVerticalUp(e.height),c=_2.getVerticalDown(e.height),l=_2.getHorizontalCenter(e.width),u=_2.getVerticalCenter(e.height),f=[new _(o,a),new _(s,c),new _(s,a),new _(o,c),new _(l,u),new _(l,a),new _(l,c),new _(o,u),new _(s,u)];1<=e.handicap&&(i=1);for(let g=0;g<e.handicap;g++){const y=f[g];n[y.y][y.x]=Ye.DARK}return new kr(n,we.of(0,0),i,h.empty(),yn.PLAYING)}static isLegal(t,e){if(Mn.isPass(t)){const n=e.phase===yn.PLAYING,i=e.phase===yn.PASSED;return Ae.display("GoRules","isLegal","at "+e.phase+(n||i?" forbid":" allowed")+" passing on "+e.getCopiedBoard()),n||i?X.success([]):X.failure(Nd.CANNOT_PASS_AFTER_PASSED_PHASE())}return Mn.isAccept(t)?e.phase===yn.COUNTING||e.phase===yn.ACCEPT?X.success([]):X.failure(Nd.CANNOT_ACCEPT_BEFORE_COUNTING_PHASE()):Mn.isOccupied(t.coord,e.getCopiedBoard())?(Ae.display("GoRules","isLegal","move is marking"),Mn.isLegalDeadMarking(t,e)?X.success([]):X.failure(Nd.OCCUPIED_INTERSECTION())):(Ae.display("GoRules","isLegal","move is normal stuff: "+t.toString()),Mn.isLegalNormalMove(t,e))}static getNewKo(t,e,n){if(1===n.length){const i=n[0],o=t.coord,s=e[o.y][o.x],c=(new Ad).getGroupDatas(o,e),l=c.emptyCoords,u=Ye.pieceBelongTo(s,O.ZERO)?c.darkCoords:c.lightCoords;if(1===l.length&&l[0].equals(i)&&1===u.length)return h.of(i)}return h.empty()}static markTerritoryAndCount(t){const e=t.getCopiedBoard(),n=Mn.getTerritoryLikeGroup(t),i=t.getCapturedCopy();for(const o of n){const s=o.getWrapper();if(s===Ye.LIGHT){i.add(O.ONE,o.emptyCoords.length);for(const a of o.getCoords())e[a.y][a.x]=Ye.LIGHT_TERRITORY}else{L.assert(s===Ye.DARK,"territory should be wrapped by dark or light, not by "+s.toString()),i.add(O.ZERO,o.emptyCoords.length);for(const a of o.getCoords())e[a.y][a.x]=Ye.DARK_TERRITORY}}return new kr(e,i,t.turn,t.koCoord,t.phase)}static removeAndSubstractTerritory(t){const e=t.getCopiedBoard(),n=t.getCapturedCopy();for(const i of t.getCoordsAndContents()){const o=i.coord;if(i.content.isTerritory()){e[o.y][o.x]=Ye.EMPTY;const s=i.content.getOwner();n.add(s,-1)}}return new kr(e,n,t.turn,t.koCoord,t.phase)}static getEmptyZones(t){return Mn.getGroupsDatasWhere(t.getCopiedBoard(),e=>e.isEmpty())}static getGroupsDatasWhere(t,e){const n=[];let i,o,s;const a=new Ad;for(let c=0;c<t.length;c++)for(let l=0;l<t[0].length;l++)i=new _(l,c),s=t[c][l],e(s)&&!1===n.some(u=>u.selfContains(i))&&(o=a.getGroupDatas(i,t),n.push(o));return n}static addDeadToScore(t){const e=t.getCapturedCopy();let o,n=e.get(O.ONE),i=e.get(O.ZERO);for(let s=0;s<t.getHeight();s++)for(let a=0;a<t.getWidth();a++)o=t.getPieceAtXY(a,s),o===Ye.DEAD_DARK?n++:o===Ye.DEAD_LIGHT&&i++;return[i,n]}static switchAliveness(t,e){const n=e.getCopiedBoard();L.assert(n[t.y][t.x].isOccupied(),"Can't switch emptyness aliveness");const s=(new Ad).getGroupDatas(t,n),a=e.getCapturedCopy();switch(s.color){case Ye.DEAD_DARK:a.add(O.ONE,-2*s.deadDarkCoords.length);for(const c of s.deadDarkCoords)n[c.y][c.x]=Ye.DARK;break;case Ye.DEAD_LIGHT:a.add(O.ZERO,-2*s.deadLightCoords.length);for(const c of s.deadLightCoords)n[c.y][c.x]=Ye.LIGHT;break;case Ye.LIGHT:a.add(O.ZERO,2*s.lightCoords.length);for(const c of s.lightCoords)n[c.y][c.x]=Ye.DEAD_LIGHT;break;default:L.expectToBe(s.color,Ye.DARK),a.add(O.ONE,2*s.darkCoords.length);for(const c of s.darkCoords)n[c.y][c.x]=Ye.DEAD_DARK}return new kr(n,a,e.turn,e.koCoord,e.phase)}static getGameStatus(t){const e=t.gameState;if(e.phase===yn.FINISHED){const n=e.captured.get(O.ZERO),i=e.captured.get(O.ONE);return i<n?ye.ZERO_WON:n<i?ye.ONE_WON:ye.DRAW}return ye.ONGOING}static isPass(t){return t.equals(Xr.PASS)}static isAccept(t){return t.equals(Xr.ACCEPT)}static isLegalDeadMarking(t,e){return Mn.isOccupied(t.coord,e.getCopiedBoard())&&(e.phase===yn.COUNTING||e.phase===yn.ACCEPT)}static isLegalNormalMove(t,e){const n=e.getCopiedBoard();if(Mn.isKo(t,e))return X.failure(Nd.ILLEGAL_KO());[yn.COUNTING,yn.ACCEPT].includes(e.phase)&&(e=Mn.resurrectStones(e));const i=Mn.getCaptureState(t,e);if(TJ.isCapturing(i))return X.success(i.capturedCoords);{n[t.coord.y][t.coord.x]=e.turn%2==0?Ye.DARK:Ye.LIGHT;const a=0===(new Ad).getGroupDatas(t.coord,n).emptyCoords.length;return n[t.coord.y][t.coord.x]=Ye.EMPTY,a?X.failure(Nd.CANNOT_COMMIT_SUICIDE()):X.success([])}}static isOccupied(t,e){return e[t.y][t.x].isOccupied()}static isKo(t,e){return!!e.koCoord.isPresent()&&t.coord.equals(e.koCoord.get())}static getCaptureState(t,e){const n=new TJ;let i;for(const o of Ie.ORTHOGONALS)i=Mn.getCapturedInDirection(t.coord,o,e),i.length>0&&n.capturedCoords.every(s=>!1===i[0].equals(s))&&(n.capturedCoords=n.capturedCoords.concat(i));return n}static getCapturedInDirection(t,e,n){const i=n.getCopiedBoard(),o=t.getNext(e);if(o.isInRange(n.getWidth(),n.getHeight())&&i[o.y][o.x]===(n.turn%2==0?Ye.LIGHT:Ye.DARK)){Ae.display("GoRules","getCapturedInDirection","a group could be captured");const c=(new Ad).getGroupDatas(o,i);if(Mn.isCapturableGroup(c,n.koCoord))return Ae.display("GoRules","getCapturedInDirection",{neightbooringGroupCoord:c.getCoords(),message:"is capturable"}),c.getCoords()}return[]}static isCapturableGroup(t,e){return!(!t.color.isOccupied()||1!==t.emptyCoords.length)&&!1===e.equalsValue(t.emptyCoords[0])}static getTerritoryLikeGroup(t){return Mn.getEmptyZones(t).filter(n=>n.isMonoWrapped())}static applyPass(t){const e=t.getCopiedBoard(),n=t.getCapturedCopy(),i=t.turn;let o,s;return t.phase===yn.PASSED?(o=yn.COUNTING,s=new kr(e,n,i+1,h.empty(),o),s=Mn.markTerritoryAndCount(s)):(L.assert(t.phase===yn.PLAYING,"Cannot pass in counting phase!"),o=yn.PASSED,s=new kr(e,n,i+1,h.empty(),o)),s}static applyLegalAccept(t){const e=t.getCopiedBoard();let n;return n=t.phase===yn.COUNTING?yn.ACCEPT:yn.FINISHED,new kr(e,t.getCapturedCopy(),t.turn+1,h.empty(),n)}static applyNormalLegalMove(t,e,n){let i;i=[yn.COUNTING,yn.ACCEPT].includes(e.phase)?Mn.resurrectStones(e):e.copy();const o=t.coord.x,s=t.coord.y,a=i.getCopiedBoard(),c=i.turn,l=i.getCurrentPlayer(),u=Ye.ofPlayer(l),f=c+1;a[s][o]=u;for(const S of n)a[S.y][S.x]=Ye.EMPTY;const g=Mn.getNewKo(t,a,n),y=i.getCapturedCopy();return y.add(l,n.length),new kr(a,y,f,g,yn.PLAYING)}static resurrectStones(t){for(let e=0;e<t.getHeight();e++)for(let n=0;n<t.getWidth();n++)t.getPieceAtXY(n,e).isDead()&&(t=Mn.switchAliveness(new _(n,e),t));return Mn.removeAndSubstractTerritory(t)}static applyDeadMarkingMove(t,e){const n=Mn.removeAndSubstractTerritory(e),i=Mn.switchAliveness(t.coord,n),o=new kr(i.getCopiedBoard(),i.getCapturedCopy(),i.turn+1,h.empty(),yn.COUNTING);return Mn.markTerritoryAndCount(o)}isLegal(t,e){return Mn.isLegal(t,e)}applyLegalMove(t,e,n,i){return Mn.isPass(t)?(Ae.display("GoRules","applyLegalMove","isPass"),Mn.applyPass(e)):Mn.isAccept(t)?(Ae.display("GoRules","applyLegalMove","isAccept"),Mn.applyLegalAccept(e)):Mn.isLegalDeadMarking(t,e)?(Ae.display("GoRules","applyLegalMove","isDeadMarking"),Mn.applyDeadMarkingMove(t,e)):(Ae.display("GoRules","applyLegalMove","else it is normal move"),Mn.applyNormalLegalMove(t,e,i))}getGameStatus(t){return Mn.getGameStatus(t)}getRulesConfigDescription(){return h.of(Mn.RULES_CONFIG_DESCRIPTION)}};$a=Mn=function(r,t,e,n){var s,i=arguments.length,o=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,e):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,t,e,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(t,e,o):s(t,e))||o);return i>3&&o&&Object.defineProperty(t,e,o),o}([Ae.log],$a);class TJ{capturedCoords=[];static isCapturing(t){return t.capturedCoords.length>0}}const Ke=Ye.LIGHT,Be=Ye.DARK,UI=Ye.DEAD_LIGHT,pu=Ye.LIGHT_TERRITORY,sa=Ye.DARK_TERRITORY,ae=Ye.EMPTY,_xe=$a.get().getDefaultRulesConfig();class Cxe extends Wn{tutorial=[W.informational($localize`Preliminary information`,$localize`The game of Go is played on a board called a Goban, and the stones are placed on the intersections.
        The traditional board is made of 19x19 intersections, but on this website we have the 13x13 board.
        (For shorter parts, 9x9 and 5x5 boards exist, but are not yet available here).
        For this tutorial, we will use a smaller board for pedagogical purposes.`,$a.get().getInitialState(_xe)),W.informational($localize`Goal of the game`,$localize`The goal of the game is to have the most points at the end of the game.
        We call "territories" the intersections that are empty and isolated from the rest of the Goban by the stones of a single player.
        Here, Dark has 9 territories on the left, and Light has 8 on the right.
        The top part belongs to no one.
        Each player's score at the end of the game is the sum of that player's territories and captures.`,new kr([[ae,Be,ae,ae,Ke,Ke],[ae,Be,ae,ae,Ke,ae],[ae,Be,Be,Ke,Ke,ae],[ae,ae,Be,Ke,ae,ae],[ae,ae,Be,Ke,ae,ae],[ae,ae,Be,Ke,ae,ae]],we.of(0,0),0,h.empty(),yn.PLAYING)),W.fromMove($localize`Simple capture`,$localize`An isolated stone, like the one in the middle here, has 4 neighboring intersections (not 8, because we do not count diagonals).
        It is said of a group which has exactly 2 free neighboring squares, that this group has two liberties.
        If Dark plays on the last liberty of the light stone, this stone is removed from the Goban (captured) and Dark earns one point.<br/><br/>
        You're playing Dark. The light piece on the board only has one liberty left, play there.`,new kr([[ae,ae,ae,ae,ae],[ae,ae,Be,ae,ae],[ae,Be,Ke,ae,ae],[ae,ae,Be,ae,ae],[ae,ae,ae,ae,ae]],we.of(0,0),0,h.empty(),yn.PLAYING),[new Xr(3,2)],$localize`Congratulations, you have earned one point.`,$localize`Failed, try again by playing on one of the intersections directly next to the light stone.`),W.fromMove($localize`Capturing multiple stones`,$localize`Stones that are connected horizontally or vertically must be captured at the same time, and are not capturable in isolation.<br/><br/>
        You're playing Dark. The light group here only has one liberty left, capture it.`,new kr([[ae,Be,ae,ae,ae],[Be,Ke,ae,ae,ae],[Be,Ke,Ke,Be,ae],[ae,Be,Be,ae,ae],[ae,ae,ae,ae,ae]],we.of(0,0),0,h.empty(),yn.PLAYING),[new Xr(2,1)],$localize`Congratulations, you have earned three points and formed a territory.`,$localize`Failed, you have not captured the group. Play on the last liberty of that group.`),W.informational($localize`Suicide`,$localize`In Go, suicide is forbidden.
        If putting a piece on an intersection removes the last liberty of your group and does not capture any stone, playing on that intersection would be a suicide and is therefore forbidden.
        Here, the top left intersection is a suicide for Light.
        On the bottom right, it would be a suicide for Dark, and on the bottom left it is not a suicide for any player.`,new kr([[ae,Be,ae,ae,ae],[Be,ae,ae,ae,ae],[Be,ae,ae,ae,Ke],[Ke,Be,ae,Ke,ae],[ae,Ke,ae,Ke,Be]],we.of(0,0),0,h.empty(),yn.PLAYING)),W.informational($localize`Life and death (death)`,$localize`From the capture rule follows the life and death notion:
        dead stones are stones that are definitely capturable (without losing anything else).
        Alive stones are stones that can never be captured.
        From the capture rule, Dark can play inside Light's territory and make a capture.
        In this case, we say that Light has only one eye (its last liberty) and that Light is dead (even if not yet captured).
        At the end of the game, the dead stones will count as captures, and the intersections they occupy as territories.`,new kr([[ae,ae,ae,ae,ae],[Be,Be,Be,ae,ae],[Ke,Ke,Be,ae,ae],[ae,Ke,Be,ae,ae],[Ke,Ke,Be,ae,ae]],we.of(0,0),0,h.empty(),yn.PLAYING)),W.informational($localize`Life and death (eyes)`,$localize`Here, Light cannot play on the top left, nor on the bottom left.
        Light will never be able to capture Dark.
        We say that Dark has two eyes (the eye on the top left, and the one on the bottom left) and that Dark is alive.`,new kr([[ae,Be,Ke,ae,ae],[Ke,Be,Ke,ae,ae],[Be,Be,Ke,ae,ae],[Ke,Be,Ke,ae,ae],[ae,Be,Ke,ae,ae]],we.of(0,0),0,h.empty(),yn.PLAYING)),W.informational($localize`Seki`,$localize`If Dark plays on the middle line, Light will play on the opposite intersection and capture Dark.
        Similarly, if Light plays on the middle line, Dark will capture Light.
        In other words, there is no point in playing on the middle line.
        In that case, we say that stones in the middle are alive by Seki, and that both intersections in the middle are neutral.`,new kr([[ae,Ke,Be,ae,Ke,Be,ae],[ae,Ke,Be,Be,Ke,Be,ae],[ae,Ke,Be,Be,Ke,Be,ae],[ae,Ke,Be,Be,Ke,Be,ae],[ae,Ke,Be,Ke,Ke,Be,ae],[ae,Ke,Be,Ke,Ke,Be,ae],[ae,Ke,Be,ae,Ke,Be,ae]],we.of(0,0),0,h.empty(),yn.PLAYING)),W.fromMove($localize`Ko`,$localize`A player, by putting a stone, cannot go back to an identical state of the Goban as before, in order to avoid an endless game.<br/><br/>
        You're playing Dark, capture the light stone.`,new kr([[ae,ae,ae,ae,ae,ae,ae],[ae,ae,ae,ae,ae,ae,ae],[ae,ae,ae,Be,Ke,ae,ae],[ae,ae,Be,Ke,ae,Ke,ae],[ae,ae,ae,Be,Ke,ae,ae],[ae,ae,ae,ae,ae,ae,ae],[ae,ae,ae,ae,ae,ae,ae]],we.of(0,0),0,h.empty(),yn.PLAYING),[new Xr(4,3)],$localize`Now, if Light tries to recapture the stone that Dark has just put on the Goban, this one would go back to its previous state, opening the door for an endless game.
        This intersection is therefore marked with a red square, to remind the players that this intersection is forbidden.
        This rule is called the Ko.
        The trick for Light is to try to create a big enough threat so that Dark must answer immediately, and does not have the time to protect its last stone, so that Light can capture it right after.`,pe.FAILED_TRY_AGAIN()),W.fromMove(pe.END_OF_THE_GAME(),$localize`When a player feels that there is no advantage to putting a new stone, that player can pass a turn.
        The game phase stops when both players pass consecutively, and we move on to the counting phase.
        The dead groups are then marked by clicking on them.
        Every intersection in a player's territory earns that player a point.
        The winner is the one with most points.<br/><br/>
        You're playing Dark. A last stone is dead, mark it.`,new kr([[Ke,Be,Be,Be,Be,Be,sa,sa,sa],[Ke,Ke,Ke,Ke,Be,Be,Be,sa,sa],[Ke,pu,Ke,Ke,Be,UI,UI,Be,sa],[Be,Ke,Ke,Ke,Ke,Be,sa,sa,sa],[ae,Ke,pu,Ke,Be,Be,UI,Be,sa],[Ke,pu,Ke,Ke,Be,Be,Be,Be,Be],[Ke,Ke,Be,Be,Be,Ke,Ke,Be,Ke],[Be,Be,Be,Ke,Ke,Ke,pu,Ke,Ke],[sa,sa,Be,Be,Be,Ke,Ke,pu,pu]],we.of(0,0),0,h.empty(),yn.COUNTING),[new Xr(0,3)],$localize`Congratulations, Dark has 15 territories and 3 light stones still present, called prisoners at the end of the game.
        The intersections where the prisoners are count as Dark's territory
        Light has 8 territories and 1 prisoner.
        The end result is therefore 18 - 9 for Dark.`,pe.FAILED_TRY_AGAIN())]}class vxe extends rr{getMetrics(t,e){const n=$a.markTerritoryAndCount(t.gameState),i=n.getCapturedCopy(),o=this.getDeadStones(n);return G1.ofSingle(i.get(O.ZERO)+2*o.get(O.ONE),i.get(O.ONE)+2*o.get(O.ZERO))}getDeadStones(t){const e=we.of(0,0);for(const n of t.getCoordsAndContents()){const i=n.content;"dead"===i.type&&e.add(i.player,1)}return e}}let RC=class extends Kn{getListMoves(t,e){const n=t.gameState,i=this.getPlayingMovesList(n);if(n.phase===yn.PLAYING||n.phase===yn.PASSED)return i.push(Xr.PASS),i;{const o=this.getCountingMovesList(n);return 0===o.length?[Xr.ACCEPT]:o}}getPlayingMovesList(t){const e=[];let n;for(const i of t.getCoordsAndContents()){const o=i.coord,s=i.content;n=new Xr(o.x,o.y),s===Ye.EMPTY&&$a.isLegal(n,t).isSuccess()&&e.push(n)}return e}getCountingMovesList(t){const e=[],n=this.getCorrectBoard(t).getCopiedBoard(),i=$a.getGroupsDatasWhere(n,o=>o!==Ye.EMPTY);for(const o of i){const s=o.getCoords()[0],a=n[s.y][s.x];if(t.getPieceAt(s)!==a){const l=new Xr(s.x,s.y);return e.push(l),e}}return e}getCorrectBoard(t){const n=this.mapBoard(t.getCopiedBoard(),s=>s===Ye.DARK?Ye.DEAD_DARK:s===Ye.LIGHT?Ye.DEAD_LIGHT:s.isTerritory()?Ye.EMPTY:s),i=new kr(n,t.getCapturedCopy(),t.turn,t.koCoord,t.phase),o=$a.getTerritoryLikeGroup(i);return this.setAliveUniqueWrapper(i,o)}mapBoard(t,e){const n=[];for(let i=0;i<t.length;i++){n[i]=[];for(let o=0;o<t[0].length;o++)n[i][o]=e(t[i][o])}return n}setAliveUniqueWrapper(t,e){let i,n=t.copy();for(const o of e){i=o.deadDarkCoords.concat(o.deadLightCoords);for(const s of i)n.isDead(s)&&(n=$a.switchAliveness(s,n))}return n}};function Exe(r,t){if(1&r&&(I(),V(0,"circle",11)),2&r){const e=p(2).$implicit,n=p();A("cx",.5*n.SPACE_SIZE+n.SPACE_SIZE*e.coord.x)("cy",.5*n.SPACE_SIZE+n.SPACE_SIZE*e.coord.y)("r",.44*n.SPACE_SIZE)}}function Pxe(r,t){if(1&r){const e=he();I(),E(0,"line",12),q("click",function(){te(e);const i=p(2).$implicit;return ne(p().onClick(i.coord))}),P()}if(2&r){const e=p(2).$implicit,n=p();A("x1",n.SPACE_SIZE*e.coord.x)("y1",n.SPACE_SIZE*e.coord.y)("x2",n.SPACE_SIZE+n.SPACE_SIZE*e.coord.x)("y2",n.SPACE_SIZE+n.SPACE_SIZE*e.coord.y)}}function Sxe(r,t){if(1&r){const e=he();I(),E(0,"g")(1,"circle",8),q("click",function(){te(e);const i=p().$implicit;return ne(p().onClick(i.coord))}),P(),z(2,Exe,1,3,"circle",9)(3,Pxe,1,4,"line",10),P()}if(2&r){const e=p().$implicit,n=p();m(),v("ngClass",n.getSpaceClass(e.coord)),A("cx",.5*n.SPACE_SIZE+n.SPACE_SIZE*e.coord.x)("cy",.5*n.SPACE_SIZE+n.SPACE_SIZE*e.coord.y)("r",.44*n.SPACE_SIZE),m(),v("ngIf",n.isLastSpace(e.coord)),m(),v("ngIf",n.isDead(e.coord))}}function Oxe(r,t){if(1&r){const e=he();I(),E(0,"circle",14),q("click",function(){te(e);const i=p(2).$implicit;return ne(p().onClick(i.coord))}),P()}if(2&r){const e=p(2).$implicit,n=p();A("cx",.5*n.SPACE_SIZE+n.SPACE_SIZE*e.coord.x)("cy",.5*n.SPACE_SIZE+n.SPACE_SIZE*e.coord.y)("r",.2*n.SPACE_SIZE)("class",e.content===n.GoPiece.LIGHT_TERRITORY?"player1-fill":"player0-fill")}}function Txe(r,t){if(1&r&&(I(),z(0,Oxe,1,4,"circle",13)),2&r){const e=p().$implicit;v("ngIf",p().isTerritory(e.coord))}}function wxe(r,t){if(1&r&&(I(),E(0,"g"),z(1,Sxe,4,6,"g",6)(2,Txe,1,1,"ng-template",null,7,In),P()),2&r){const e=t.$implicit,n=wn(3),i=p();m(),v("ngIf",i.spaceIsFull(e.coord))("ngIfElse",n)}}function bxe(r,t){if(1&r&&(I(),V(0,"rect",15)),2&r){const e=p();A("width",.5*e.SPACE_SIZE)("height",.5*e.SPACE_SIZE)("x",.25*e.SPACE_SIZE+e.SPACE_SIZE*e.ko.get().x)("y",.25*e.SPACE_SIZE+e.SPACE_SIZE*e.ko.get().y)}}function Axe(r,t){if(1&r){const e=he();I(),E(0,"circle",16),q("click",function(){const o=te(e).$implicit;return ne(p().onClick(o))}),P()}if(2&r){const e=t.$implicit,n=p();A("cx",.5*n.SPACE_SIZE+n.SPACE_SIZE*e.x)("cy",.5*n.SPACE_SIZE+n.SPACE_SIZE*e.y)("r",.14*n.SPACE_SIZE)}}RC=function(r,t,e,n){var s,i=arguments.length,o=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,e):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,t,e,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(t,e,o):s(t,e))||o);return i>3&&o&&Object.defineProperty(t,e,o),o}([Ae.log],RC);let xC=class CR extends NI{boardInfo;ko=h.empty();last=h.empty();captures=[];GoPiece=Ye;constructor(t){super(t),this.setRulesAndNode("Go"),this.availableAIs=[new fn($localize`Minimax`,$a.get(),new vxe,new RC),new zn($localize`MCTS`,new RC,this.rules)],this.encoder=Xr.encoder,this.canPass=!0,this.scores=h.of(we.of(0,0))}showLastMove(t){var e=this;return M(function*(){e.last=h.of(t.coord),e.showCaptures()})()}hideLastMove(){this.captures=[],this.last=h.empty()}onClick(t){var e=this;return M(function*(){const n=t.x,i=t.y,o=yield e.canUserPlay("#click_"+n+"_"+i);if(o.isFailure())return e.cancelMove(o.getReason());e.last=h.empty();const s=new Xr(n,i);return e.chooseMove(s)})()}updateBoard(t){var e=this;return M(function*(){const n=e.getState(),i=n.phase;e.board=n.getCopiedBoard(),e.scores=h.of(n.getCapturedCopy()),e.ko=n.koCoord,e.canPass=i!==yn.FINISHED,e.createHoshis()})()}showCaptures(){const t=this.getPreviousState();this.captures=[];for(let e=0;e<this.getHeight();e++)for(let n=0;n<this.getWidth();n++){const i=new _(n,e),o=t.getPieceAt(i).isOccupied(),s=this.board[e][n]===Ye.EMPTY,a=!1===this.ko.equalsValue(i);o&&s&&a&&this.captures.push(i)}}pass(){var t=this;return M(function*(){const e=t.getState().phase;return e===yn.PLAYING||e===yn.PASSED?t.onClick(Xr.PASS.coord):(L.assert(e===yn.COUNTING||e===yn.ACCEPT,"GoComponent: pass() must be called only in playing, passed, counting, or accept phases"),t.onClick(Xr.ACCEPT.coord))})()}getSpaceClass(t){const n=this.getState().getPieceAt(t);return this.getPlayerClass(n.getOwner())}spaceIsFull(t){return this.getState().getPieceAt(t)!==Ye.EMPTY&&!1===this.isTerritory(t)}isLastSpace(t){return this.last.equalsValue(t)}isDead(t){return this.getState().isDead(t)}isTerritory(t){return this.getState().isTerritory(t)}static \u0275fac=function(e){return new(e||CR)(G(Ut))};static \u0275cmp=Ue({type:CR,selectors:[["app-go"]],features:[$e],decls:6,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["app-blank-goban","",3,"width","height","clickCallBack"],["id","piece_ko_territory_markers_and_dead_stones"],[4,"ngFor","ngForOf"],["class","captured-stroke mid-stroke no-fill",4,"ngIf"],["class","captured-fill",3,"click",4,"ngFor","ngForOf"],[4,"ngIf","ngIfElse"],["empty",""],[1,"base",3,"ngClass","click"],["class","base no-fill last-move-stroke",4,"ngIf"],["class","base no-fill captured-stroke",3,"click",4,"ngIf"],[1,"base","no-fill","last-move-stroke"],[1,"base","no-fill","captured-stroke",3,"click"],[3,"click",4,"ngIf"],[3,"click"],[1,"captured-stroke","mid-stroke","no-fill"],[1,"captured-fill",3,"click"]],template:function(e,n){1&e&&(I(),E(0,"svg",0)(1,"g",1),q("clickCallBack",function(o){return n.onClick(o)}),P(),E(2,"g",2),z(3,wxe,4,2,"g",3),P(),z(4,bxe,1,4,"rect",4)(5,Axe,1,3,"circle",5),P()),2&e&&(A("viewBox",n.getViewBox().toSVGString()),m(),v("width",n.getState().getWidth())("height",n.getState().getHeight()),m(2),v("ngForOf",n.getState().getCoordsAndContents()),m(),v("ngIf",n.ko.isPresent()),m(),v("ngForOf",n.captures))},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})};xC=function(r,t,e,n){var s,i=arguments.length,o=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,e):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,t,e,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(t,e,o):s(t,e))||o);return i>3&&o&&Object.defineProperty(t,e,o),o}([Ae.log],xC);const Vn=Pe.UNREACHABLE,Je=Pe.EMPTY,sr=Pe.ZERO,$c=Pe.ONE;class Nxe extends Wn{tutorial=[W.informational($localize`Goal of the game`,$localize`The goal of Gipf is to capture the opponent's piece so that the opponent can no longer play.
        This is the initial board.
        Each player has 12 pieces on the side and 3 pieces on the board.
        When, at its turn, a player has no more pieces on the side, that player cannot play anymore and loses the game.
        The first player plays with the dark pieces, the second player plays with the light pieces.`,rn.get().getInitialState()),W.anyMove($localize`Pushing`,$localize`Pieces can only enter the board through the edges. To insert a new piece:
        <ol>
            <li>Click on a space on the edge of the board.</li>
            <li>If that space was already occupied, click on the arrow that indicates the direction in which you want to push the piece(s) already on the corresponding line.</li>
        </ol>
        You cannot push when a line is full.<br/><br/>
        You're playing Dark, insert a piece.`,rn.get().getInitialState(),new Ba(new ia(new _(3,0),h.of(Te.DOWN)),[],[]),pe.CONGRATULATIONS()),W.fromMove($localize`Captures (1/3)`,$localize`To capture, you must align 4 of your own pieces, which will be the first 4 captured pieces.
        There are multiple important aspects of a capture:
        <ol>
            <li>When 4 pieces are captured, all pieces that are directly aligned with these 4 pieces are also captured.</li>
            <li>As soon as there is an empty space on the line, the capture stops.</li>
            <li>Your own pieces that are captured go back to your stock.
                Your opponent's pieces however are really captured and do not go back to your opponent's stock.</li>
            <li>If you create a line of 4 of your opponent's pieces, it will be at the beginning of your opponent's turn that your opponent can capture them.
                This means that a turn happens in three phases:
                <ol type="A">
                    <li>Pick the capture(s) resulting from the last move of your opponent (by clicking on it).</li>
                    <li>Make your insertion.</li>
                    <li>Pick the capture(s) resulting from your move (by clicking on it).</li>
                </ol>
            </li>
        </ol><br/>
        You're playing Dark, you can make a capture, do it.`,new r4([[Vn,Vn,Vn,sr,$c,Je,Je],[Vn,Vn,Je,Je,Je,Je,Je],[Vn,Je,Je,Je,Je,Je,Je],[sr,sr,sr,Je,Je,Je,Je],[$c,Je,Je,Je,Je,Je,Vn],[Je,Je,Je,$c,Je,Vn,Vn],[Je,Je,Je,$c,Vn,Vn,Vn]],42,we.of(8,8),we.of(0,0)),[new Ba(new ia(new _(0,3),h.of(Te.RIGHT)),[],[new ji([new _(0,3),new _(1,3),new _(2,3),new _(3,3)])])],$localize`Congratulations, you have gotten 4 of your pieces back. This is not the most useful capture.
        Let's now see how captures can really be useful.`,pe.FAILED_TRY_AGAIN()),W.fromMove($localize`Captures (2/3)`,$localize`Here, there are three different ways for Dark to capture.
        <ol>
          <li>One way does not capture any of your opponent's pieces.</li>
          <li>Another way captures one of your opponent's pieces.</li>
          <li>The last way captures two of your opponent's pieces.</li>
        </ol>
        <br/>
        You're playing Dark, capture the most pieces from your opponent.`,new r4([[Vn,Vn,Vn,Je,Je,Je,Je],[Vn,Vn,Je,$c,Je,Je,Je],[Vn,Je,Je,sr,Je,Je,Je],[sr,sr,sr,$c,Je,Je,Je],[Je,Je,Je,sr,Je,Je,Vn],[Je,Je,Je,sr,Je,Vn,Vn],[Je,Je,Je,$c,Vn,Vn,Vn]],42,we.of(8,4),we.of(2,3)),[new Ba(new ia(new _(0,3),h.of(Te.RIGHT)),[],[new ji([new _(3,1),new _(3,2),new _(3,3),new _(3,4),new _(3,5),new _(3,6)])])],$localize`Congratulations, you have gotten back 4 of your pieces and captured 2 of the opponent's.
        The most you can get is 3 per capture.`,$localize`Failed, the best capture was taking 2 of your opponent's pieces`),W.fromMove($localize`Captures (3/3)`,$localize`Here, you must capture at the beginning of your turn.
        This is due to a move of your opponent at the previous turn
        (even though this is a fictitious board for pedagogical purpose).
        After your capture, by performing the right move you can even capture two more of your opponent's pieces!
        Keep it mind that the most useful in a capture is to take your opponent's pieces.<br/><br/>
        You're playing Dark, capture the most pieces from your opponent.`,new r4([[Vn,Vn,Vn,sr,Je,Je,sr],[Vn,Vn,Je,sr,Je,Je,sr],[Vn,sr,sr,Je,sr,$c,sr],[Je,Je,Je,sr,Je,Je,sr],[Je,Je,Je,sr,Je,Je,Vn],[sr,sr,sr,$c,$c,Vn,Vn],[Je,Je,Je,sr,Vn,Vn,Vn]],42,we.of(3,4),we.of(2,3)),[new Ba(new ia(new _(3,6),h.of(Te.UP)),[new ji([new _(6,0),new _(6,1),new _(6,2),new _(6,3)])],[new ji([new _(0,5),new _(1,5),new _(2,5),new _(3,5),new _(4,5)]),new ji([new _(1,2),new _(2,2),new _(3,2),new _(4,2),new _(5,2)])]),new Ba(new ia(new _(4,6),h.of(Te.UP)),[new ji([new _(6,0),new _(6,1),new _(6,2),new _(6,3)])],[new ji([new _(0,5),new _(1,5),new _(2,5),new _(3,5),new _(4,5)]),new ji([new _(3,0),new _(3,1),new _(3,2),new _(3,3),new _(3,4)])]),new Ba(new ia(new _(3,6),h.of(Te.UP)),[new ji([new _(6,0),new _(6,1),new _(6,2),new _(6,3)])],[new ji([new _(1,2),new _(2,2),new _(3,2),new _(4,2),new _(5,2)]),new ji([new _(0,5),new _(1,5),new _(2,5),new _(3,5),new _(4,5)])])],$localize`Congratulations, you have gotten 12 of your pieces back and captured 2 of your opponent's pieces.`,$localize`Failed, the best capture takes 2 of your opponent's pieces.`)]}let yr=(()=>class r{static CANNOT_DROP_PIECE_YOU_DONT_HAVE=()=>"You cannot drop a piece that you do not have in your reserve.";static QUEEN_BEE_CAN_ONLY_MOVE_TO_DIRECT_NEIGHBORS=()=>$localize`The queen bee can only move to one of its direct neighbors.`;static BEETLE_CAN_ONLY_MOVE_TO_DIRECT_NEIGHBORS=()=>$localize`The beetle can only move to one of its direct neighbors.`;static GRASSHOPPER_MUST_MOVE_IN_STRAIGHT_LINE=()=>$localize`The grasshopper must move in a straight line.`;static GRASSHOPPER_MUST_JUMP_OVER_PIECES=()=>$localize`The grasshopper must jump over other pieces, without any empty spaces.`;static SPIDER_MUST_MOVE_ON_NEIGHBORING_SPACES=()=>$localize`The spider must move on neighboring spaces.`;static SPIDER_CAN_ONLY_MOVE_WITH_DIRECT_CONTACT=()=>$localize`The spider can only move around pieces that are in direct contact with it.`;static SPIDER_CANNOT_BACKTRACK=()=>$localize`The spider cannot go twice through the same space in the same move.`;static QUEEN_BEE_MUST_BE_ON_BOARD_BEFORE_MOVE=()=>$localize`The queen bee must be placed on the board before moving a piece.`;static THIS_PIECE_CANNOT_CLIMB=()=>$localize`Only the beetle is allowed to climb over other pieces.`;static CANNOT_DISCONNECT_HIVE=()=>$localize`You are not allowed to split the hive.`;static MUST_BE_ABLE_TO_SLIDE=()=>$localize`This piece must be able to slide to its destination.`;static MUST_PLACE_QUEEN_BEE_LATEST_AT_FOURTH_TURN=()=>$localize`You must place your queen bee at this turn!`;static CANNOT_DROP_NEXT_TO_OPPONENT=()=>$localize`You cannot drop a piece next to one of your opponent's stack.`;static MUST_DROP_ON_EMPTY_SPACE=()=>$localize`You must always drop your piece on an empty space.`;static MUST_BE_CONNECTED_TO_HIVE=()=>$localize`The piece you are dropping must be connected to the hive.`})();const Ixe=ke.fromFunctions(r=>r,r=>r);class li{owner;kind;static encoder=ke.tuple([O.encoder,Ixe],t=>[t.owner,t.kind],t=>new li(t[0],t[1]));constructor(t,e){this.owner=t,this.kind=e}toString(){return`${this.kind}_${this.owner.toString()}`}equals(t){return this.owner===t.owner&&this.kind===t.kind}}class i4{pieces;static EMPTY=new i4([]);constructor(t){this.pieces=t}equals(t){return this.size()===t.size()&&yt.equals(this.pieces,t.pieces)}isEmpty(){return 0===this.pieces.length}hasPieces(){return!1===this.isEmpty()}add(t){return new i4([t,...this.pieces])}topPiece(){return L.assert(this.hasPieces(),"HivePieceStack: cannot get top piece of an empty stack"),this.pieces[0]}removeTopPiece(){const t=[...this.pieces];return t.shift(),new i4(t)}size(){return this.pieces.length}}class Wa extends Nr{piece;static encoder=ke.tuple([li.encoder,_.encoder],t=>[t.piece,t.coord],t=>new Wa(t[0],t[1].x,t[1].y));static of(t,e){return new Wa(t,e.x,e.y)}constructor(t,e,n){super(e,n),this.piece=t}toString(){return`HiveDrop(${this.piece.toString()}, ${this.coord.toString()})`}equals(t){return t instanceof Wa&&this.piece.equals(t.piece)&&this.coord.equals(t.coord)}}class po extends Do{static encoder=G2.getFallibleEncoder(po.from);static from(t,e){return t.equals(e)?X.failure(Ee.MOVE_CANNOT_BE_STATIC()):X.success(new po(t,e))}constructor(t,e){super(t,e)}toString(){return`HiveMoveCoordToCoord(${this.getStart().toString()} -> ${this.getEnd().toString()})`}equals(t){return!(t instanceof Wc)&&t instanceof po&&this.getStart().equals(t.getStart())&&this.getEnd().equals(t.getEnd())}}class Wc extends po{coords;static encoder=ke.tuple([_.encoder,_.encoder,_.encoder,_.encoder],t=>t.coords,t=>new Wc(t));static ofCoords(t){return new Wc(t)}constructor(t){super(t[0],t[3]),this.coords=t}toString(){return`HiveMoveSpider(${this.coords.map(e=>e.toString()).join(", ")})`}equals(t){return t instanceof Wc&&this.getStart().equals(t.getStart())&&this.getEnd().equals(t.getEnd())}}class mu extends h2{static encoder=ke.constant("HiveMovePass",new mu);toString(){return"HiveMovePass"}equals(t){return t instanceof mu}}function kxe(r){return r instanceof Wa}function Rxe(r){return r instanceof Wc}function xxe(r){return r instanceof po}function Lxe(r){return r instanceof mu}var Ni;!function(r){r.PASS=new mu,r.drop=function t(i,o){return Wa.of(i,o)},r.move=function e(i,o){return po.from(i,o)},r.spiderMove=function n(i){return Wc.ofCoords(i)},r.encoder=ke.disjunction([kxe,Rxe,xxe,Lxe],[Wa.encoder,Wc.encoder,po.encoder,mu.encoder])}(Ni||(Ni={}));class qa{static INSTANCES=h.empty();static of(t){return qa.INSTANCES.isAbsent()&&(qa.INSTANCES=h.of({QueenBee:GI.get(),Beetle:BI.get(),Grasshopper:$I.get(),Spider:LC.get(),SoldierAnt:WI.get()})),qa.INSTANCES.get()[t.kind]}checkEmptyDestination(t,e){return e.getAt(t.getEnd()).hasPieces()?w.failure(yr.THIS_PIECE_CANNOT_CLIMB()):w.SUCCESS}canSlideBetweenNeighbors(t,e,n){const i=new st(bi.getNeighbors(e)),o=new st(bi.getNeighbors(n)),s=i.intersection(o);for(const a of s)if(t.getAt(a).isEmpty())return!0;return!1}}class GI extends qa{static INSTANCE=h.empty();static get(){return this.INSTANCE.isAbsent()&&(this.INSTANCE=h.of(new GI)),this.INSTANCE.get()}moveValidity(t,e){return!1===bi.areNeighbors(t.getStart(),t.getEnd())?w.failure(yr.QUEEN_BEE_CAN_ONLY_MOVE_TO_DIRECT_NEIGHBORS()):!1===this.canSlideBetweenNeighbors(e,t.getStart(),t.getEnd())?w.failure(yr.MUST_BE_ABLE_TO_SLIDE()):this.checkEmptyDestination(t,e)}getPotentialMoves(t,e){const n=[];for(const i of bi.getNeighbors(t))e.getAt(i).isEmpty()&&n.push(po.from(t,i).get());return n}}class BI extends qa{static INSTANCE=h.empty();static get(){return this.INSTANCE.isAbsent()&&(this.INSTANCE=h.of(new BI)),this.INSTANCE.get()}moveValidity(t,e){return!1===bi.areNeighbors(t.getStart(),t.getEnd())?w.failure(yr.BEETLE_CAN_ONLY_MOVE_TO_DIRECT_NEIGHBORS()):w.SUCCESS}getPotentialMoves(t,e){const n=[];for(const i of bi.getNeighbors(t))n.push(po.from(t,i).get());return n}}class $I extends qa{static INSTANCE=h.empty();static get(){return this.INSTANCE.isAbsent()&&(this.INSTANCE=h.of(new $I)),this.INSTANCE.get()}moveValidity(t,e){if(Te.factory.fromMove(t.getStart(),t.getEnd()).isFailure())return w.failure(yr.GRASSHOPPER_MUST_MOVE_IN_STRAIGHT_LINE());const i=t.getStart().getCoordsToward(t.getEnd());if(0===i.length)return w.failure(yr.GRASSHOPPER_MUST_JUMP_OVER_PIECES());for(const o of i)if(e.getAt(o).isEmpty())return w.failure(yr.GRASSHOPPER_MUST_JUMP_OVER_PIECES());return this.checkEmptyDestination(t,e)}getPotentialMoves(t,e){const n=[];for(const i of Te.factory.all){const o=t.getNext(i);if(e.getAt(o).hasPieces()){let s=o;for(;e.getAt(s).hasPieces();)s=s.getNext(i);n.push(po.from(t,s).get())}}return n}}class LC extends qa{static INSTANCE=h.empty();static get(){return this.INSTANCE.isAbsent()&&(this.INSTANCE=h.of(new LC)),this.INSTANCE.get()}prefixLegality(t,e){const n=new st,i=e.update().setAt(t[0],i4.EMPTY).increaseTurnAndFinalizeUpdate();for(let o=1;o<t.length;o++){if(i.getAt(t[o]).hasPieces())return w.failure(yr.THIS_PIECE_CANNOT_CLIMB());if(!1===bi.areNeighbors(t[o-1],t[o]))return w.failure(yr.SPIDER_MUST_MOVE_ON_NEIGHBORING_SPACES());if(!1===i.haveCommonNeighbor(t[o],t[o-1]))return w.failure(yr.SPIDER_CAN_ONLY_MOVE_WITH_DIRECT_CONTACT());if(!1===this.canSlideBetweenNeighbors(i,t[o-1],t[o]))return w.failure(yr.MUST_BE_ABLE_TO_SLIDE());if(n.contains(t[o]))return w.failure(yr.SPIDER_CANNOT_BACKTRACK());n.add(t[o])}return w.SUCCESS}moveValidity(t,e){L.assert(t instanceof Wc,"HiveSpiderRules: move should be a spider move");const i=this.prefixLegality(t.coords,e);return i.isFailure()?i:this.checkEmptyDestination(t,e)}getPotentialMoves(t,e){const n=e.update().setAt(t,i4.EMPTY).increaseTurnAndFinalizeUpdate();let i=[[t]];for(let a=0;a<3;a++)i=i.flatMap(c=>this.nextMoveStep(n,c));return new st(i.map(function o(a){return Wc.ofCoords(a)})).toList()}nextMoveStep(t,e){const n=e[e.length-1];return new st(bi.getNeighbors(n)).filter(function i(s){return!t.getAt(s).hasPieces()&&void 0===e.find(a=>s.equals(a))&&t.haveCommonNeighbor(s,n)}).toList().map(s=>[...e,s])}}class WI extends qa{static INSTANCE=h.empty();static get(){return this.INSTANCE.isAbsent()&&(this.INSTANCE=h.of(new WI)),this.INSTANCE.get()}pathExists(t,e,n){const i=new st,o=[e];for(;o.length>0;){const s=o.pop();if(!i.contains(s)){if(i.add(s),s.equals(n))return!0;for(const a of bi.getNeighbors(s)){const c=t.getAt(a).isEmpty(),l=t.getOccupiedNeighbors(a).size()>0,u=this.canSlideBetweenNeighbors(t,s,a);c&&l&&u&&o.push(a)}}}return!1}moveValidity(t,e){return!1===this.pathExists(e,t.getStart(),t.getEnd())?w.failure(yr.MUST_BE_ABLE_TO_SLIDE()):this.checkEmptyDestination(t,e)}getPotentialMoves(t,e){const n=new st;for(const i of e.occupiedSpaces())if(!i.equals(t))for(const o of e.emptyNeighbors(i))n.add(po.from(t,o).get());return n.toList()}}class wJ extends PC{pieces;width;height;constructor(t,e){super(e),this.pieces=t;const n=this.computeScale();this.width=n.width,this.height=n.height,this.pieces.makeImmutable()}getPieces(){return this.pieces}getPieceCoords(){return this.pieces.listKeys()}computeScale(){let t=Number.MAX_SAFE_INTEGER,e=Number.MIN_SAFE_INTEGER,n=Number.MAX_SAFE_INTEGER,i=Number.MIN_SAFE_INTEGER;for(const o of this.pieces.listKeys())t=Math.min(o.x,t),e=Math.max(o.x,e),n=Math.min(o.y,n),i=Math.max(o.y,i);return{width:e+1-t,height:i+1-n}}isOnBoard(t){return this.pieces.containsKey(t)}getOccupiedNeighbors(t){return new st(bi.getNeighbors(t)).filter(n=>this.pieces.get(n).isPresent())}getGroups(){const t=new st,e=new st;return this.pieces.forEach(n=>{if(!1===t.contains(n.key)){const i=new st,o=new st([n.key]);for(;o.hasElements();){const s=o.getAnyElement().get();o.remove(s),t.add(s),i.add(s),o.addAll(this.getOccupiedNeighbors(s).filter(a=>!1===t.contains(a)))}e.add(i)}}),e}}class zC{pieces;static getInitial(){const t=new gn;for(const e of O.PLAYERS)t.set(new li(e,"QueenBee"),1),t.set(new li(e,"Beetle"),2),t.set(new li(e,"Spider"),2),t.set(new li(e,"Grasshopper"),3),t.set(new li(e,"SoldierAnt"),3);return t.makeImmutable(),new zC(t)}constructor(t){this.pieces=t}equals(t){return this.pieces.equals(t.pieces)}getQuantity(t){return this.pieces.get(t).get()}hasRemaining(t){return this.getQuantity(t)>0}getAny(t){for(const e of this.pieces.listKeys())if(e.owner===t&&this.hasRemaining(e))return h.of(e);return h.empty()}remove(t){const e=this.pieces.get(t).get();L.assert(e>0,"HiveRemainingPieces cannot remove a non-remainingPiece");const n=this.pieces.getCopy();return n.replace(t,e-1),new zC(n)}toListOfStacks(){const t=[];return this.pieces.forEach(e=>{const n=[];for(let i=0;i<e.value;i++)n.push(e.key);t.push(new i4(n))}),t}getPlayerPieces(t){const e=[];return this.pieces.forEach(n=>{n.key.owner===t&&n.value>0&&e.push(n.key)}),e}}class Id{pieces;remainingPieces;queenBees;turn;static of(t){return new Id(t.pieces,t.remainingPieces,t.queenBees,t.turn)}constructor(t,e,n,i){this.pieces=t,this.remainingPieces=e,this.queenBees=n,this.turn=i}setAt(t,e){const n=this.queenBees.getCopy();for(const o of O.PLAYERS)n.get(o).equalsValue(t)&&n.delete(o);for(const o of e.pieces)"QueenBee"===o.kind&&n.put(o.owner,t);const i=this.pieces.getCopy();return e.isEmpty()?i.delete(t):i.put(t,e),new Id(i,this.remainingPieces,n,this.turn)}removeRemainingPiece(t){return new Id(this.pieces,this.remainingPieces.remove(t),this.queenBees,this.turn)}increaseTurnAndFinalizeUpdate(){return new mo(this.pieces,this.remainingPieces,this.queenBees,this.turn+1)}}class mo extends wJ{remainingPieces;queenBees;static fromRepresentation(t,e,n=new Gt(0,0)){const i=new nu;let o=zC.getInitial();const s=new gn;for(let a=0;a<t.length;a++)for(let c=0;c<t[0].length;c++)if(t[a][c].length>0){const l=new _(c,a).getNext(n,1);i.set(l,new i4(t[a][c]));const u=h.ofNullable(t[a][c].find(f=>"QueenBee"===f.kind));u.isPresent()&&s.set(u.get().owner,l);for(const f of t[a][c])o=o.remove(f)}return new mo(i,o,s,e)}constructor(t,e,n,i){super(t,i),this.remainingPieces=e,this.queenBees=n,this.queenBees=n.getCopy();for(const o of n.listKeys()){const s=n.get(o).get();this.queenBees.replace(o,s)}this.queenBees.makeImmutable()}update(){return Id.of(this)}equals(t){return this.pieces.equals(t.pieces)&&this.remainingPieces.equals(t.remainingPieces)&&this.queenBees.equals(t.queenBees)&&this.turn===t.turn}getAt(t){return this.isOnBoard(t)?this.pieces.get(t).get():i4.EMPTY}queenBeeLocation(t){return this.queenBees.get(t)}hasQueenBeeOnBoard(t){return this.queenBeeLocation(t).isPresent()}numberOfNeighbors(t){let e=0;for(const n of bi.getNeighbors(t))this.getAt(n).hasPieces()&&(e+=1);return e}isDisconnected(){return this.getGroups().size()>1}occupiedSpaces(){return this.pieces.listKeys()}emptyNeighbors(t){const e=[];for(const n of bi.getNeighbors(t))this.getAt(n).isEmpty()&&e.push(n);return e}haveCommonNeighbor(t,e){const n=this.getOccupiedNeighbors(t),i=this.getOccupiedNeighbors(e);return n.findAnyCommonElement(i).isPresent()}}class Zi extends Ar{static singleton=h.empty();static get(){return Zi.singleton.isAbsent()&&(Zi.singleton=h.of(new Zi)),Zi.singleton.get()}getInitialState(){return mo.fromRepresentation([],0)}applyLegalMove(t,e,n,i){return t instanceof Wa?this.applyLegalDrop(t,e):t instanceof po?this.applyLegalMoveCoordToCoord(t,e):e.update().increaseTurnAndFinalizeUpdate()}applyLegalDrop(t,e){const n=e.getAt(t.coord);return e.update().setAt(t.coord,n.add(t.piece)).removeRemainingPiece(t.piece).increaseTurnAndFinalizeUpdate()}applyLegalMoveCoordToCoord(t,e){const n=e.getAt(t.getStart()),i=e.getAt(t.getEnd());return e.update().setAt(t.getStart(),n.removeTopPiece()).setAt(t.getEnd(),i.add(n.topPiece())).increaseTurnAndFinalizeUpdate()}isLegal(t,e){return t instanceof Wa?this.isLegalDrop(t,e):t instanceof po?this.isLegalMoveCoordToCoord(t,e):this.shouldPass(e)?w.SUCCESS:w.failure(Ee.CANNOT_PASS())}isLegalMoveCoordToCoord(t,e){if(!1===e.queenBeeLocation(e.getCurrentPlayer()).isPresent())return w.failure(yr.QUEEN_BEE_MUST_BE_ON_BOARD_BEFORE_MOVE());const n=e.getAt(t.getStart());if(n.isEmpty())return w.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());const i=n.topPiece();if(i.owner===e.getCurrentOpponent())return w.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT());const o=qa.of(i).moveValidity(t,e);if(o.isFailure())return o;const s=e.update().setAt(t.getStart(),n.removeTopPiece()).increaseTurnAndFinalizeUpdate();if(s.isDisconnected())return w.failure(yr.CANNOT_DISCONNECT_HIVE());const a=t.getEnd();return 0===s.numberOfNeighbors(a)?w.failure(yr.CANNOT_DISCONNECT_HIVE()):w.SUCCESS}mustPlaceQueenBee(t){return 6<=t.turn&&!1===t.hasQueenBeeOnBoard(t.getCurrentPlayer())}isLegalDrop(t,e){const n=e.getCurrentPlayer();if(t.piece.owner===n.getOpponent())return w.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT());if(!1===e.remainingPieces.hasRemaining(t.piece))return w.failure(yr.CANNOT_DROP_PIECE_YOU_DONT_HAVE());if("QueenBee"!==t.piece.kind&&this.mustPlaceQueenBee(e))return w.failure(yr.MUST_PLACE_QUEEN_BEE_LATEST_AT_FOURTH_TURN());const i=this.checkNeighborValidity(t,e);return i.isFailure()?i:e.getAt(t.coord).hasPieces()?w.failure(yr.MUST_DROP_ON_EMPTY_SPACE()):w.SUCCESS}checkNeighborValidity(t,e){const n=e.getCurrentPlayer();let i=!1;for(const o of bi.getNeighbors(t.coord)){const s=e.getAt(o);if(s.hasPieces()&&(i=!0,1!==e.turn&&s.topPiece().owner===n.getOpponent()))return w.failure(yr.CANNOT_DROP_NEXT_TO_OPPONENT())}return 0!==e.turn&&!1===i?w.failure(yr.MUST_BE_CONNECTED_TO_HIVE()):w.SUCCESS}getPossibleDropLocations(t){const e=t.getCurrentPlayer();if(0===t.turn)return new st([new _(0,0)]);if(1===t.turn)return new st(bi.getNeighbors(new _(0,0)));const n=t.remainingPieces.getAny(e);if(n.isAbsent())return new st;const i=n.get(),o=new st;for(const s of t.occupiedSpaces())if(t.getAt(s).topPiece().owner===e)for(const a of t.emptyNeighbors(s)){const c=Wa.of(i,a);this.isLegalDrop(c,t).isSuccess()&&o.add(a)}return o}getPossibleMovesFrom(t,e){const n=t.getCurrentPlayer(),i=new st,o=t.getAt(e).topPiece();if(o.owner===n)for(const s of qa.of(o).getPotentialMoves(e,t))this.isLegalMoveCoordToCoord(s,t).isSuccess()&&i.add(s);return i}getPossibleMovesOnBoard(t){const e=new st;for(const n of t.occupiedSpaces())e.addAll(this.getPossibleMovesFrom(t,n));return e}shouldPass(t){return 0===this.getPossibleDropLocations(t).size()&&0===this.getPossibleMovesOnBoard(t).size()}getGameStatus(t){const e=t.gameState,n=we.of(0,0);for(const s of O.PLAYERS){const a=e.queenBeeLocation(s);a.isPresent()&&n.put(s,e.numberOfNeighbors(a.get()))}const i=n.get(O.ZERO),o=n.get(O.ONE);return 6===i&&6===o?ye.DRAW:6===i?ye.getVictory(O.ONE):6===o?ye.getVictory(O.ZERO):ye.ONGOING}}class zxe extends rr{getMetrics(t,e){const n=this.queenBeeMobility(t.gameState,O.ZERO),i=this.queenBeeMobility(t.gameState,O.ONE);return G1.ofSingle(n,i)}queenBeeMobility(t,e){const n=t.queenBeeLocation(e);return n.isPresent()?Zi.get().getPossibleMovesFrom(t,n.get()).size():0}}class bJ extends Kn{getListMoves(t,e){const n=this.getListDrops(t.gameState),i=this.getListOfOnBoardMoves(t.gameState),o=n.concat(i);return 0===o.length?[Ni.PASS]:o}getListOfOnBoardMoves(t){return Zi.get().getPossibleMovesOnBoard(t).toList()}getListDrops(t){const e=[],n=t.getCurrentPlayer(),i=new li(n,"QueenBee");for(const o of Zi.get().getPossibleDropLocations(t))if(Zi.get().mustPlaceQueenBee(t))e.push(Ni.drop(i,o));else for(const s of t.remainingPieces.getPlayerPieces(t.getCurrentPlayer()))e.push(Ni.drop(s,o));return e}}function Dxe(r,t){if(1&r){const e=he();I(),E(0,"g")(1,"polygon",4),q("click",function(){const o=te(e).$implicit;return ne(p().selectSpace(o.x,o.y))}),P()()}if(2&r){const e=t.$implicit,n=p();m(),ve("id","space_",e.x,"_",e.y,""),v("ngClass",e.content.spaceClasses),A("points",n.getHexaPoints())("transform",n.getHexaCenterTranslationAtXY(e.x,e.y))}}function Vxe(r,t){if(1&r){const e=he();I(),E(0,"polygon",6),q("click",function(){te(e);const i=p().$implicit;return ne(p().selectSpace(i.x,i.y))}),P()}if(2&r){const e=p().$implicit,n=p();ve("id","stroke_",e.x,"_",e.y,""),v("ngClass",e.content.strokeClasses),A("points",n.getHexaPoints())("transform",n.getHexaCenterTranslationAtXY(e.x,e.y))}}function Hxe(r,t){if(1&r&&(I(),E(0,"g"),z(1,Vxe,1,5,"polygon",5),P()),2&r){const e=t.$implicit;m(),v("ngIf",e.content.strokeClasses.length>0)}}function Fxe(r,t){if(1&r){const e=he();I(),E(0,"polygon",8),q("click",function(){te(e);const i=p().$implicit;return ne(p().selectSpace(i.x,i.y))}),P()}if(2&r){const e=p().$implicit,n=p();ve("id","stroke_",e.x,"_",e.y,""),A("points",n.getHexaPoints())("transform",n.getHexaCenterTranslationAtXY(e.x,e.y))}}function Uxe(r,t){if(1&r&&(I(),E(0,"g"),z(1,Fxe,1,4,"polygon",7),P()),2&r){const e=t.$implicit;m(),v("ngIf",e.content.selected)}}function Gxe(r,t){if(1&r){const e=he();I(),E(0,"g")(1,"g",9),q("click",function(){const o=te(e).$implicit;return ne(p(2).selectStack(o.x,o.y))}),P()()}if(2&r){const e=t.$implicit,n=p().index,i=p();m(),ve("id","piece_",e.x,"_",e.y,""),v("piece",e.content.piece)("x",0)("y",0)("pieceHeight",i.PIECE_HEIGHT)("hexaLayout",i.hexaLayout)("layer",n),A("transform",i.getHexaCenterTranslationAtXY(e.x,e.y))}}function Bxe(r,t){if(1&r){const e=he();I(),E(0,"polygon",6),q("click",function(){te(e);const i=p().$implicit;return ne(p(2).selectStack(i.x,i.y))}),P()}if(2&r){const e=p().$implicit,n=p().index,i=p();ve("id","stroke_",e.x,"_",e.y,""),v("ngClass",e.content.strokeClasses),A("points",i.getHexaPoints())("transform","translate(0 "+-(n+1)*i.PIECE_HEIGHT+")")}}function $xe(r,t){if(1&r&&(I(),E(0,"g"),z(1,Bxe,1,5,"polygon",5),P()),2&r){const e=t.$implicit;A("transform",p(2).getHexaCenterTranslationAtXY(e.x,e.y)),m(),v("ngIf",e.content.strokeClasses.length>0)}}function Wxe(r,t){if(1&r&&(I(),E(0,"g"),z(1,Gxe,2,9,"g",1)(2,$xe,2,2,"g",1),P()),2&r){const e=t.$implicit;m(),v("ngForOf",e),m(),v("ngForOf",e)}}function qxe(r,t){if(1&r){const e=he();I(),E(0,"g")(1,"g",10),q("click",function(){const o=te(e).$implicit;return ne(p(2).selectRemaining(o))}),P()()}if(2&r){const e=t.$implicit,n=t.index,i=p(2);A("transform",i.getHexaCenterTranslationAtXY(0,0)),m(),Tn("id","remainingPiece_",e.toString(),""),v("piece",e)("pieceHeight",i.PIECE_HEIGHT)("x",0)("y",0)("layer",n)("hexaLayout",i.hexaLayout),A("transform",i.getRemainingPieceTransform(e))}}function jxe(r,t){if(1&r&&(I(),E(0,"g"),z(1,qxe,2,9,"g",1),P()),2&r){const e=t.$implicit;m(),v("ngForOf",e.pieces)}}function Zxe(r,t){if(1&r&&(I(),V(0,"polygon",11)),2&r){const e=p();A("points",e.getHexaPoints())("transform",e.getRemainingPieceHighlightTransform(e.selectedRemaining.get()))}}function Yxe(r,t){if(1&r&&(I(),V(0,"g",13)),2&r){const e=t.$implicit,n=t.index,i=p(2);Tn("id","inspectedStack_",n,""),v("piece",e)("pieceHeight",i.PIECE_HEIGHT)("x",0)("y",0)("hexaLayout",i.hexaLayout)("layer",6*n),A("transform",i.inspectedStackTransform)}}function Kxe(r,t){if(1&r&&(I(),E(0,"g"),z(1,Yxe,1,8,"g",12),P()),2&r){const e=p();m(),v("ngForOf",e.inspectedStack.get().pieces.slice().reverse())}}class AJ extends HQ{highlighted=[];initialize(t){this.set(t,{spaceClasses:[],strokeClasses:[],selected:!1})}highlightFill(t,e){this.highlighted.push(t),this.get(t).map(n=>n.spaceClasses.push(e))}highlightStroke(t,e){this.highlighted.push(t),this.get(t).map(n=>n.strokeClasses.push(e))}select(t){this.highlighted.push(t),this.get(t).map(e=>e.selected=!0)}clearHighlights(){for(const t of this.highlighted)this.get(t).map(e=>{e.strokeClasses=[],e.spaceClasses=[],e.selected=!1});this.highlighted=[]}}class Xxe extends HQ{highlighted=[];initialize(t,e){this.set(t,{piece:e,strokeClasses:[]})}highlight(t,e){this.highlighted.push(t),this.get(t).map(n=>n.strokeClasses.push(e))}clearHighlights(){for(const t of this.highlighted)this.get(t).map(e=>{e.strokeClasses=[]});this.highlighted=[]}}let NJ=(()=>{class r extends ru{ORIGIN=new _(0,0);remainingStacks=[];layers=[];ground=new AJ;inspectedStack=h.empty();inspectedStackCoord=h.empty();selectedRemaining=h.empty();selectedStart=h.empty();selectedSpiderCoords=[];PIECE_HEIGHT;boardViewBox;viewBox;inspectedStackTransform;constructor(e){super(e),this.setRulesAndNode("Hive"),this.availableAIs=[new fn($localize`Minimax`,Zi.get(),new zxe,new bJ),new zn($localize`MCTS`,new bJ,this.rules)],this.encoder=Ni.encoder,this.SPACE_SIZE=30,this.PIECE_HEIGHT=this.SPACE_SIZE/3,this.hexaLayout=new iu(1.5*this.SPACE_SIZE,new _(2*this.SPACE_SIZE,0),Yr.INSTANCE)}updateBoard(e){var n=this;return M(function*(){n.layers=[];for(const o of n.getState().occupiedSpaces()){const s=n.getState().getAt(o),a=o.x,c=o.y;for(let l=0;l<s.size();l++){l in n.layers||(n.layers[l]=new Xxe);const u=s.pieces[s.size()-1-l];n.layers[l].initialize(new _(a,c),u)}}n.ground=n.getGround(),n.computeViewBox(),n.remainingStacks=n.getState().remainingPieces.toListOfStacks(),n.canPass=Zi.get().shouldPass(n.getState());const i=Zi.get().getGameStatus(n.node);switch(i){case ye.ONGOING:break;case ye.DRAW:n.highlight(n.getState().queenBeeLocation(O.ZERO).get(),"victory-stroke"),n.highlight(n.getState().queenBeeLocation(O.ONE).get(),"victory-stroke");break;default:const s=i.winner.getOpponent();n.highlight(n.getState().queenBeeLocation(s).get(),"victory-stroke")}})()}highlight(e,n){const i=this.getState().getAt(e).size();i-1 in this.layers&&this.layers[i-1].highlight(e,n)}pass(){var e=this;return M(function*(){return L.assert(e.canPass,"HiveComponent: pass() can only be called if canPass is true"),yield e.chooseMove(Ni.PASS)})()}computeViewBox(){const e=this.getPieceCoords().union(this.getAllNeighbors()).toList();e.push(new _(0,0)),this.boardViewBox=Ks.fromHexa(e,this.hexaLayout,this.STROKE_WIDTH);const n=new Ks(this.getRemainingPieceTransformAsCoord(new li(O.ZERO,"QueenBee")).x,0,4*this.SPACE_SIZE*5,0),i=5.5*this.SPACE_SIZE;let o=0;this.getState().remainingPieces.getAny(O.ZERO).isPresent()&&(o=i);let s=0;this.getState().remainingPieces.getAny(O.ONE).isPresent()&&(s=i);const a=this.boardViewBox.containingAtLeast(n).expandAbove(o).expandBelow(s);if(this.inspectedStack.isPresent()){const c=new _(a.right()+this.SPACE_SIZE,a.center().y),l=this.inspectedStack.get().size();this.inspectedStackTransform=`translate(${c.x} ${c.y+3*(l-1)*this.PIECE_HEIGHT})`,this.viewBox=a.expand(0,5*this.SPACE_SIZE,0,0).toSVGString()}else this.viewBox=a.toSVGString()}getPieceCoords(){return this.getState().pieces.getKeySet()}getGround(){const e=new AJ;for(const n of this.getAllNeighbors())e.initialize(n);return e}getAllNeighbors(){const e=new st;for(const n of this.getPieceCoords())e.addAll(new st(this.getState().emptyNeighbors(n)));return e.isEmpty()&&e.add(new _(0,0)),e}clearHighlights(){for(const e of this.layers)e.clearHighlights();this.ground.clearHighlights()}cancelMoveAttempt(){this.clearHighlights(),this.selectedStart=h.empty(),this.selectedRemaining=h.empty(),this.selectedSpiderCoords=[],this.inspectedStack=h.empty(),this.computeViewBox()}showLastMove(e){var n=this;return M(function*(){for(const i of n.getLastMoveCoords(e))n.highlight(i,"last-move-stroke"),n.ground.highlightStroke(i,"last-move-stroke"),n.ground.highlightFill(i,"moved-fill")})()}hideLastMove(){}getLastMoveCoords(e){let n=[];return e instanceof Wa?n=[e.coord]:e instanceof po&&(n=[e.getStart(),e.getEnd()]),n}getRemainingPieceTransformAsCoord(e){const n=this.getRemainingPieceShift(e),i=this.boardViewBox.center().x+n*this.SPACE_SIZE*4;let o;return o=e.owner===this.getPointOfView()?this.boardViewBox.bottom()+4*this.SPACE_SIZE:this.boardViewBox.up-3*this.SPACE_SIZE,new _(i,o)}getRemainingPieceTransform(e){const n=this.getRemainingPieceTransformAsCoord(e);return`translate(${n.x} ${n.y})`}getRemainingPieceHighlightTransform(e){const n=this.getRemainingPieceTransformAsCoord(e),i=this.getState().remainingPieces.getQuantity(e);return`translate(${n.x} ${n.y-this.PIECE_HEIGHT*i})`}getRemainingPieceShift(e){switch(e.kind){case"QueenBee":return-2.5;case"Beetle":return-1.5;case"Grasshopper":return-.5;case"Spider":return.5;default:return L.expectToBe(e.kind,"SoldierAnt"),1.5}}selectRemaining(e){var n=this;return M(function*(){const i=yield n.canUserPlay(`#remainingPiece_${e.toString()}`);if(i.isFailure())return n.cancelMove(i.getReason());if(e.owner===n.getCurrentOpponent())return n.cancelMove(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT());if("QueenBee"!==e.kind&&Zi.get().mustPlaceQueenBee(n.getState()))return n.cancelMove(yr.MUST_PLACE_QUEEN_BEE_LATEST_AT_FOURTH_TURN());if(n.selectedRemaining.equalsValue(e))n.cancelMoveAttempt();else{n.cancelMoveAttempt(),n.selectedRemaining=h.of(e),n.clearHighlights();const o=Zi.get().getPossibleDropLocations(n.getState()).toList();for(const s of o)n.ground.highlightStroke(s,"clickable-stroke")}return w.SUCCESS})()}selectStack(e,n){var i=this;return M(function*(){return yield i.select(new _(e,n),"piece")})()}selectSpace(e,n){var i=this;return M(function*(){return yield i.select(new _(e,n),"space")})()}select(e,n){var i=this;return M(function*(){const o=yield i.canUserPlay(`#${n}_${e.x}_${e.y}`);if(o.isFailure())return i.cancelMove(o.getReason());const s=i.getState(),a=s.getAt(e);if(i.selectedRemaining.isPresent()){const c=Ni.drop(i.selectedRemaining.get(),e);return i.chooseMove(c)}if(i.selectedStart.isPresent()){const c=s.getAt(i.selectedStart.get()).topPiece();return i.selectedStart.equalsValue(e)?i.cancelMove():i.selectTarget(e,c)}return 0===a.size()?i.cancelMove():i.selectStart(e,a)})()}selectTarget(e,n){var i=this;return M(function*(){if("Spider"===n.kind)return i.selectNextSpiderSpace(e);{const o=Ni.move(i.selectedStart.get(),e);return pn(o.isSuccess(),"Hive: the only forbidden moves are static moves"),i.chooseMove(o.get())}})()}selectStart(e,n){var i=this;return M(function*(){const o=i.getState(),s=n.topPiece();return s.owner===o.getCurrentOpponent()?1===n.size()?i.cancelMove(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT()):i.inspectedStack.isPresent()?(i.cancelMoveAttempt(),i.clearHighlights(),w.SUCCESS):(i.highlight(e,"selected-stroke"),i.inspectedStack=h.of(n),i.inspectedStackCoord=h.of(e),i.computeViewBox(),w.SUCCESS):(i.cancelMoveAttempt(),i.clearHighlights(),"QueenBee"!==s.kind&&Zi.get().mustPlaceQueenBee(o)?i.cancelMove(yr.MUST_PLACE_QUEEN_BEE_LATEST_AT_FOURTH_TURN()):(i.selectedStart=h.of(e),i.highlight(e,"selected-stroke"),"Spider"===s.kind&&i.selectedSpiderCoords.push(i.selectedStart.get()),n.size()>1&&(i.inspectedStack=h.of(n),i.inspectedStackCoord=h.of(e),i.computeViewBox()),i.highlightNextPossibleCoords(e),w.SUCCESS))})()}highlightNextPossibleCoords(e){for(const n of this.getNextPossibleCoords(e))this.highlight(n,"clickable-stroke"),this.ground.highlightStroke(n,"clickable-stroke")}getNextPossibleCoords(e){const n=this.getState(),i=n.getAt(e).topPiece(),o=Zi.get().getPossibleMovesFrom(n,e);return"Spider"===i.kind?o.filter(a=>yt.isPrefix(this.selectedSpiderCoords,a.coords)).map(a=>a.coords[this.selectedSpiderCoords.length]).toList():o.map(s=>s.getEnd()).toList()}selectNextSpiderSpace(e){var n=this;return M(function*(){if(n.selectedSpiderCoords.push(e),4===n.selectedSpiderCoords.length){const o=Ni.spiderMove(n.selectedSpiderCoords);return n.chooseMove(o)}const i=LC.get().prefixLegality(n.selectedSpiderCoords,n.getState());if(i.isFailure())return n.cancelMove(i.getReason());n.clearHighlights(),n.highlight(n.selectedStart.get(),"selected-stroke");for(const o of n.selectedSpiderCoords)n.ground.select(o);return n.highlightNextPossibleCoords(n.selectedStart.get()),w.SUCCESS})()}static \u0275fac=function(n){return new(n||r)(G(Ut))};static \u0275cmp=Ue({type:r,selectors:[["app-hive"]],features:[$e],decls:9,vars:9,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["id","remaining_highlight","class","base no-fill small-stroke selected-stroke",4,"ngIf"],[4,"ngIf"],[1,"base","mid-stroke",3,"id","ngClass","click"],["class","base no-fill small-stroke",3,"id","ngClass","click",4,"ngIf"],[1,"base","no-fill","small-stroke",3,"id","ngClass","click"],["class","base no-fill small-stroke","ngClass","selected-stroke",3,"id","click",4,"ngIf"],["ngClass","selected-stroke",1,"base","no-fill","small-stroke",3,"id","click"],["app-hive-piece","",3,"id","piece","x","y","pieceHeight","hexaLayout","layer","click"],["app-hive-piece","",3,"id","piece","pieceHeight","x","y","layer","hexaLayout","click"],["id","remaining_highlight",1,"base","no-fill","small-stroke","selected-stroke"],["app-hive-piece","",3,"id","piece","pieceHeight","x","y","hexaLayout","layer",4,"ngFor","ngForOf"],["app-hive-piece","",3,"id","piece","pieceHeight","x","y","hexaLayout","layer"]],template:function(n,i){1&n&&(I(),E(0,"svg",0),z(1,Dxe,2,5,"g",1)(2,Hxe,2,1,"g",1)(3,Uxe,2,1,"g",1)(4,Wxe,3,2,"g",1)(5,jxe,2,1,"g",1),E(6,"g"),z(7,Zxe,1,2,"polygon",2),P(),z(8,Kxe,2,1,"g",3),P()),2&n&&(A("viewBox",i.viewBox),m(),v("ngForOf",i.ground),m(),v("ngForOf",i.ground),m(),v("ngForOf",i.ground),m(),v("ngForOf",i.layers),m(),v("ngForOf",i.remainingStacks),m(),A("transform",i.getHexaCenterTranslation(i.ORIGIN)),m(),v("ngIf",i.selectedRemaining.isPresent()),m(),v("ngIf",i.inspectedStack.isPresent()))},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}return r})();const qc=new li(O.ZERO,"QueenBee"),d0=new li(O.ZERO,"Beetle"),_u=new li(O.ZERO,"Grasshopper"),DC=new li(O.ZERO,"Spider"),VC=new li(O.ZERO,"SoldierAnt"),h0=new li(O.ONE,"QueenBee"),Ms=new li(O.ONE,"Beetle"),qI=new li(O.ONE,"Grasshopper"),jI=new li(O.ONE,"Spider"),kd=new li(O.ONE,"SoldierAnt");class Qxe extends Wn{tutorial=[W.informational($localize`Hive`,$localize`Hive is a game without a board, where pieces are placed on the side of each other, in a contiguous block called the hive. Each player has 11 pieces, representing various insects.`,mo.fromRepresentation([[[h0],[Ms],[jI],[_u]],[[_u],[],[VC],[]],[[VC],[],[],[]]],8)),W.informational($localize`Object of the game`,$localize`The object of the game at Hive is to surround the opponent's queen. Once the queen is surrounded by 6 pieces, no matter the owner of these pieces, the game ends. The player with a queen that is not surrounded wins. In case both queens are fully surrounded at the same turn, it is a draw. Here, Dark won.`,mo.fromRepresentation([[[],[Ms],[DC]],[[kd],[h0],[qc]],[[_u],[d0],[]]],7)),W.anyMove($localize`Placing the first and second piece`,$localize`There are two types of actions: drops and moves. Initially, the board is empty, so we will have to put (drop) pieces on the board. For the first piece dropped on the board, there is no placement restriction: you can choose any piece and put in on the board. The second piece, put by Light, will need to be put in a neighboring space of the first piece. To drop a piece on the board, select the piece of your choice in your remaining pieces (below the board), and then click on the space you want to drop it on.<br/><br/>You're playing Dark and starting the game, put any piece on the board.`,Zi.get().getInitialState(),Ni.drop(d0,new _(0,0)),pe.CONGRATULATIONS()),W.anyMove($localize`Placing pieces after the second turn`,$localize`After the second turn, you are still allowed to place pieces any time you want, as long as you respect two conditions: <ol><li>your piece must be connected to the hive, and</li><li>the space on which you drop your piece must not touch a stack of the opponent.</li></ol><br/><br/>You're playing Dark, drop a piece on the board.`,mo.fromRepresentation([[[Ms],[_u]]],2),Ni.drop(qc,new _(2,0)),pe.CONGRATULATIONS()),W.fromMove($localize`Moving pieces: the queen bee`,$localize`Once you have placed you queen bee on the board, you can move your pieces. You must place your queen bee on the board as your fourth piece at the latest. Each creature moves in a different way, and moves should respect two restrictions:<ol><li>the hive must always remain fully connected, and</li><li>pieces should be able to physically slide to their destination (except for the beetle and grasshopper as we will see later).</li></ol>The queen bee can move to any of its empty neighbors. To move a piece, click on it and then click on its destination. The possible destinations are highlighted.<br/><br/>You are playing Dark, move your queen bee.`,mo.fromRepresentation([[[],[DC],[qI],[h0],[Ms]],[[Ms],[qc],[d0],[],[]]],4),[Ni.move(new _(1,1),new _(0,2)).get(),Ni.move(new _(1,1),new _(1,2)).get()],pe.CONGRATULATIONS(),pe.FAILED_TRY_AGAIN()),W.fromMove($localize`Moving the beetle`,$localize`The beetle moves like the queen bee, but it is allowed to climb on top of other pieces! Therefore, it need not adhere to the sliding restriction. Note that you are not allowed to drop the beetle on top of another piece in the drop phase, this can only be achieved when moving a beetle already on the board. A piece with a beetle on top is not allowed to move. A stack is considered to be of the player who has the beetle of the top.<br/><br/>You're playing Dark, block your opponent's queen by moving on top of it!`,mo.fromRepresentation([[[qc],[h0],[d0]],[[Ms],[],[]]],6),[Ni.move(new _(2,0),new _(1,0)).get()],pe.CONGRATULATIONS(),pe.FAILED_TRY_AGAIN()),W.forClick($localize`Inspecting stacks`,$localize`When pieces are stacked together, you are allowed to inspect the stack to see which pieces are under the beetle. This works with opponent-controlled stacks too. To do so, you can simply click on any stack to see their composition.<br/><br/>You're playing Dark and your opponent has a beetle on top of one of your piece, click on it.`,mo.fromRepresentation([[[Ms,qc],[h0],[d0]]],2),["#piece_0_0"],pe.CONGRATULATIONS(),pe.FAILED_TRY_AGAIN()),W.fromMove($localize`Moving the grasshopper`,$localize`The grasshopper jumps over one or more pieces in a straight line, and stops at the first empty space encountered. It cannot jump over empty spaces, and can only move through jumps. Because it jumps, it does not adhere to the sliding restriction.<br/><br/>You're playing Dark. Jump over three pieces with your grasshopper!`,mo.fromRepresentation([[[_u],[qc],[Ms],[kd]],[[qI],[],[],[]]],6),[Ni.move(new _(0,0),new _(4,0)).get()],pe.CONGRATULATIONS(),pe.FAILED_TRY_AGAIN()),W.fromPredicate($localize`Moving the soldier ant`,$localize`The soldier ant is a powerful piece: it can move anywhere in the hive as long as it respects the sliding and the one hive restrictions!<br/><br/>You're playing Dark. Your queen bee is stuck, move your soldier ant to free up your queen!`,mo.fromRepresentation([[[],[VC],[h0]],[[],[qc],[Ms]],[[kd],[jI],[]]],6),Ni.move(new _(1,0),new _(3,1)).get(),(t,e,n)=>t.equals(Ni.move(new _(1,0),new _(0,1)).get())?w.failure($localize`You have not freed your queen, try again!`):w.SUCCESS,pe.CONGRATULATIONS()),W.anyMove($localize`Moving the spider`,$localize`Finally, the spider can move exactly 3 spaces at a time. It is not allowed to go twice through the same space in a move. As the spider crawls around other pieces, it can only move around pieces that are in direct contact with it. This means that the spider is not allowed to temporarily split the hive. For example, here, Dark's spider cannot go on the left as its first move. To do a spider move, select a spider and click on the three spaces that compose the move.<br/><br/>You're playing Dark, move your spider!`,mo.fromRepresentation([[[],[DC],[jI],[Ms]],[[],[],[],[d0]],[[Ms],[],[],[kd]],[[VC],[],[_u],[]],[[qc],[qI],[],[]]],6),Ni.spiderMove([new _(1,0),new _(1,1),new _(2,1),new _(2,2)]),pe.CONGRATULATIONS()),W.informational($localize`Restrictions`,$localize`Let us clarify the two restrictions during moves.<ol><li>All pieces of the hive should always be connected in a way that there is a single hive. It can be the case that your piece disconnects from the hive when you slide it, but after the move there should be only one hive.</li><li>Except grasshoppers and beetles, all moves should be done by sliding the piece without disturbing the rest of the hive.</li></ol>Observe here how the queen bee is stuck, as it is not possible to slide it without moving one of the other pieces. Moreover, moving it would split the hive in two.`,mo.fromRepresentation([[[],[DC],[]],[[],[qc],[Ms]],[[kd],[],[]]],6)),W.informational($localize`Passing your turn`,$localize`Finally, it is possible that you are not able to do any move: when it is the case, you must pass your turn. Here, Dark must pass: the queen bee cannot move without disconnecting the hive, the beetle is stuck beneath another beetle, and a dropped piece would be in contact with an opponent's piece.`,mo.fromRepresentation([[[Ms,d0],[qc],[h0]]],4))]}class Es extends su{static encoder=G2.getFallibleEncoder(Es.from);static from(t,e){const n=su.isValidDirection(t,e);return n.isFailure()?n.toOtherFallible():X.success(new Es(t,e))}getMaximalDistance(){return 11}}class jc extends Bi{static singleton=h.empty();static RULES_CONFIG_DESCRIPTION=new fo({name:()=>$localize`Hnefatafl`,config:{castleIsLeftForGood:new Jn(!1,Bi.CASTLE_IS_LEFT_FOR_GOOD),edgesAreKingsEnnemy:new Jn(!0,Bi.EDGE_ARE_KING_S_ENNEMY),centralThroneCanSurroundKing:new Jn(!1,Bi.CENTRAL_THRONE_CAN_SURROUND_KING),kingFarFromHomeCanBeSandwiched:new Jn(!1,Bi.KING_FAR_FROM_HOME_CAN_BE_SANDWICHED),invaderStarts:new Jn(!0,Bi.INVADER_STARTS)}});static get(){return jc.singleton.isAbsent()&&(jc.singleton=h.of(new jc)),jc.singleton.get()}constructor(){super(Es.from)}getInitialState(t){const e=It.UNOCCUPIED;let n=It.PLAYER_ZERO_PAWN,i=It.PLAYER_ONE_PAWN,o=It.PLAYER_ONE_KING;return!1===t.get().invaderStarts&&(n=It.PLAYER_ONE_PAWN,i=It.PLAYER_ZERO_PAWN,o=It.PLAYER_ZERO_KING),new m2([[e,e,e,n,n,n,n,n,e,e,e],[e,e,e,e,e,n,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e],[n,e,e,e,e,i,e,e,e,e,n],[n,e,e,e,i,i,i,e,e,e,n],[n,n,e,i,i,o,i,i,e,n,n],[n,e,e,e,i,i,i,e,e,e,n],[n,e,e,e,e,i,e,e,e,e,n],[e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,n,e,e,e,e,e],[e,e,e,n,n,n,n,n,e,e,e]],0)}getRulesConfigDescription(){return h.of(jc.RULES_CONFIG_DESCRIPTION)}}const b=It.UNOCCUPIED,kt=It.PLAYER_ZERO_PAWN,Mr=It.PLAYER_ONE_PAWN,HC=It.PLAYER_ONE_KING,IJ=jc.get().getDefaultRulesConfig();class Jxe extends Wn{tutorial=[W.informational($localize`Goal of the game`,$localize`Hnefatafl is a strategy game that was played by the vikings, it's part of a larger family of games called Tafl. The goal of the game is different for each player. The attacker plays first. Their pieces (dark) are close to the edges. Their goal is to capture the king, which is in the center of the board. The defender plays second. Their pieces (light) are in the middle. Their goal is to move the king on one of the 4 thrones in the corners. Note that the square in which the king starts, in the center of the board, is also a throne.`,jc.get().getInitialState(IJ)),W.anyMove($localize`Moving`,$localize`All pieces move the same way. Similarly to a rook in chess, a piece can move:<ol><li>By as many squares as you want.</li><li>Without going over another piece or stopping on another piece.</li><li>Horizontally or vertically.</li><li>Only the king can land on a throne.</li></ol>To move a piece, click on it and then on its landing square.<br/><br/>You're playing Dark, do the first move.`,jc.get().getInitialState(IJ),Es.from(new _(5,1),new _(1,1)).get(),pe.CONGRATULATIONS()),W.fromMove($localize`Capturing a soldier (1/2)`,$localize`All pieces, attackers and defenders, except the king, are soldiers. To capture them, they have to be sandwiched between two of your pieces. By getting too close, an attacker's soldier is in danger.<br/><br/>You're playing Light. Capture the soldier.`,new m2([[b,b,b,b,kt,kt,kt,kt,b,b,b],[b,b,b,b,b,kt,b,b,b,b,b],[b,b,b,b,b,b,b,b,b,b,b],[kt,b,b,b,b,Mr,b,b,b,b,kt],[kt,b,b,kt,Mr,Mr,Mr,b,b,b,kt],[kt,kt,b,Mr,Mr,HC,Mr,Mr,b,kt,kt],[kt,b,b,b,Mr,Mr,Mr,b,b,b,kt],[kt,b,b,b,b,Mr,b,b,b,b,kt],[b,b,b,b,b,b,b,b,b,b,b],[b,b,b,b,b,kt,b,b,b,b,b],[b,b,b,kt,kt,kt,kt,kt,b,b,b]],1),[Es.from(new _(5,3),new _(3,3)).get()],$localize`Congratulations, that will teach him a lesson!`,$localize`Failed, you missed an opportunity to capture a piece of the opponent.`).withPreviousMove(Es.from(new _(3,0),new _(3,4)).get()),W.fromMove($localize`Capturing a soldier (2/2)`,$localize`A second way to capture a soldier is to sandwich it against an empty throne. The king has moved and endangered one of its soldiers.<br/><br/>You're playing Dark. Capture the soldier.`,new m2([[b,b,b,kt,kt,kt,kt,kt,b,b,b],[b,Mr,b,b,b,kt,b,b,b,b,b],[b,b,b,b,b,b,b,b,b,b,b],[b,b,b,b,b,Mr,b,b,b,b,kt],[kt,b,b,b,b,Mr,Mr,b,b,b,kt],[kt,kt,HC,b,Mr,b,Mr,Mr,b,b,kt],[b,b,kt,b,b,Mr,Mr,b,b,b,kt],[kt,b,b,b,b,Mr,b,b,b,b,b],[b,b,b,b,b,b,b,b,b,b,b],[b,kt,b,b,b,b,b,b,b,b,b],[b,b,b,kt,kt,kt,kt,b,kt,b,b]],12),[Es.from(new _(3,0),new _(3,5)).get(),Es.from(new _(3,10),new _(3,5)).get()],$localize`Congratulations, one less defender. But keep an eye on the king, it is the most important.`,$localize`Failed, you did not do the expected move.`),W.fromMove($localize`Capturing the king (1/2)`,$localize`To capture the king, two soldiers are not enough. For the first solution, the four squares neighbor to the king (horizontally and vertically) must be occupied by your soldiers. This also works if the king is on the throne.<br/><br/>You're playing Dark, capture the king.`,new m2([[b,b,b,b,b,b,b,b,b,b,b],[b,b,b,b,b,b,b,b,b,b,b],[b,b,b,b,b,b,b,b,b,b,b],[b,kt,b,b,b,b,b,b,b,b,b],[kt,HC,b,kt,b,b,b,b,b,b,b],[b,kt,b,b,b,b,b,b,b,b,b],[b,b,b,b,b,b,b,b,b,b,b],[b,b,b,b,b,b,b,b,b,b,b],[b,b,b,b,b,b,b,b,b,b,b],[b,b,b,b,b,b,b,b,b,b,b],[b,b,b,b,b,b,b,b,b,b,b]],72),[Es.from(new _(3,4),new _(2,4)).get()],pe.CONGRATULATIONS_YOU_WON(),$localize`Failed, you let the king run away.`),W.fromMove($localize`Capturing the king (2/2)`,$localize`Another way to capture the king is to immobilize it against an edge of the board. Note that the king cannot be captured next to a throne.<br/><br/>You're playing Dark, capture the king.`,new m2([[b,b,kt,HC,kt,b,b,b,b,b,b],[b,b,b,b,b,b,Mr,b,b,b,b],[b,b,b,b,b,b,b,b,b,b,b],[b,b,b,kt,b,b,b,b,b,b,b],[b,b,b,b,b,b,b,b,b,b,b],[b,b,b,b,b,b,b,b,b,b,b],[b,b,b,b,b,b,b,b,b,b,b],[b,b,b,b,b,b,b,b,b,b,b],[b,b,b,b,b,b,b,b,b,b,b],[b,b,b,b,b,b,b,b,b,b,b],[b,b,b,b,b,b,b,b,b,b,b]],72),[Es.from(new _(3,3),new _(3,1)).get()],$localize`The king is dead, long live the king. Congratulations, you won.`,pe.FAILED_TRY_AGAIN())]}function eLe(r,t){1&r&&(I(),V(0,"polygon",8))}function tLe(r,t){1&r&&(I(),V(0,"rect",9))}function nLe(r,t){if(1&r&&(I(),E(0,"g"),z(1,eLe,1,0,"polygon",6)(2,tLe,1,0,"ng-template",null,7,In),P()),2&r){const e=wn(3),n=p().index,i=p().index,o=p();m(),v("ngIf",o.isCentralThrone(n,i))("ngIfElse",e)}}function rLe(r,t){if(1&r&&(I(),E(0,"g"),V(1,"line",13)(2,"line",13)(3,"line",13)(4,"line",13)(5,"line",13),P()),2&r){const e=p(2).index,n=p().index,i=p();m(),v("ngClass",i.viewInfo.pieceClasses[n][e]),A("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),m(),v("ngClass",i.viewInfo.pieceClasses[n][e]),A("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.1*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),m(),v("ngClass",i.viewInfo.pieceClasses[n][e]),A("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.9*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),m(),v("ngClass",i.viewInfo.pieceClasses[n][e]),A("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.15*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE),m(),v("ngClass",i.viewInfo.pieceClasses[n][e]),A("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.85*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE)}}function iLe(r,t){if(1&r&&(I(),V(0,"polyline",16)),2&r){const e=p(3).index,n=p().index;v("ngClass",p().viewInfo.pieceClasses[n][e])}}function oLe(r,t){if(1&r&&(I(),V(0,"line",13)(1,"line",13)(2,"line",13)(3,"line",13)),2&r){const e=p(3).index,n=p().index,i=p();v("ngClass",i.viewInfo.pieceClasses[n][e]),A("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),m(),v("ngClass",i.viewInfo.pieceClasses[n][e]),A("x1",.04*i.SPACE_SIZE)("y1",.5*i.SPACE_SIZE)("x2",.96*i.SPACE_SIZE)("y2",.5*i.SPACE_SIZE),m(),v("ngClass",i.viewInfo.pieceClasses[n][e]),A("x1",.2*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.8*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE),m(),v("ngClass",i.viewInfo.pieceClasses[n][e]),A("x1",.8*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.2*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE)}}function sLe(r,t){if(1&r&&(I(),z(0,iLe,1,1,"polyline",14)(1,oLe,4,20,"ng-template",null,15,In)),2&r){const e=wn(2),n=p(2).index,i=p().index;v("ngIf",p().isKing(n,i))("ngIfElse",e)}}function aLe(r,t){if(1&r&&(I(),E(0,"g"),V(1,"circle",10),z(2,rLe,6,25,"g",11)(3,sLe,3,2,"ng-template",null,12,In),P()),2&r){const e=wn(4),n=p().index,i=p().index,o=p();m(),ve("id","piece_",n,"_",i,""),v("ngClass",o.viewInfo.pieceClasses[i][n]),A("r",o.SPACE_SIZE/2-o.STROKE_WIDTH)("cx",.5*o.SPACE_SIZE)("cy",.5*o.SPACE_SIZE),m(),v("ngIf",o.isInvader(n,i))("ngIfElse",e)}}function cLe(r,t){if(1&r){const e=he();I(),E(0,"g",3),q("click",function(){const o=te(e).index,s=p().index;return ne(p().onClick(o,s))}),V(1,"rect",4),z(2,nLe,4,2,"g",5)(3,aLe,5,8,"g",5),P()}if(2&r){const e=t.index,n=p().index,i=p();ve("id","click_",e,"_",n,""),A("transform","translate("+i.SPACE_SIZE*e+", "+i.SPACE_SIZE*n+")"),m(),ve("id","space_",e,"_",n,""),v("ngClass",i.getRectClasses(e,n)),A("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),m(),v("ngIf",i.board[n][e]===i.EMPTY&&i.isThrone(e,n)),m(),v("ngIf",i.board[n][e]!==i.EMPTY)}}function lLe(r,t){if(1&r&&(I(),E(0,"g"),z(1,cLe,4,10,"g",2),P()),2&r){const e=t.$implicit;m(),v("ngForOf",e)}}function uLe(r,t){if(1&r){const e=he();I(),E(0,"g")(1,"rect",17),q("click",function(){const o=te(e).$implicit;return ne(p().onClick(o.x,o.y))}),P()()}if(2&r){const e=t.$implicit,n=p();m(),ve("id","click_",e.x,"_",e.y,""),A("x",n.SPACE_SIZE*e.x)("y",n.SPACE_SIZE*e.y)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}let fLe=(()=>{class r extends bI{constructor(e){super(e,Es.from),this.setRulesAndNode("Hnefatafl"),this.availableAIs=this.createAIs(),this.encoder=Es.encoder}static \u0275fac=function(n){return new(n||r)(G(Ut))};static \u0275cmp=Ue({type:r,selectors:[["app-hnefatafl"]],features:[$e],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["x","0","y","0",1,"base",3,"id","ngClass"],[4,"ngIf"],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60","class","base",4,"ngIf","ngIfElse"],["cornerThrone",""],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60",1,"base"],["x","15","y","15","width","70","height","70",1,"base"],[1,"base",3,"id","ngClass"],[4,"ngIf","ngIfElse"],["defender",""],[1,"base",3,"ngClass"],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85","class","base no-fill",3,"ngClass",4,"ngIf","ngIfElse"],["soldierDefender",""],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85",1,"base","no-fill",3,"ngClass"],[1,"no-fill","mid-stroke","clickable-stroke",3,"id","click"]],template:function(n,i){1&n&&(I(),E(0,"svg",0),z(1,lLe,2,1,"g",1)(2,uLe,2,6,"g",1),P()),2&n&&(A("viewBox",i.getViewBox().toSVGString()),m(),v("ngForOf",i.board),m(),v("ngForOf",i.getClickables()))},dependencies:[zt,Nt,bt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}return r})();class Uo extends Dn{static singleton=h.empty();static RULES_CONFIG_DESCRIPTION=new fo({name:()=>$localize`Kalah`,config:{feedOriginalHouse:new Jn(!0,Dn.FEED_ORIGINAL_HOUSE),mustFeed:new Jn(!1,Dn.MUST_FEED),passByPlayerStore:new Jn(!0,Dn.PASS_BY_PLAYER_STORE),mustContinueDistributionAfterStore:new Jn(!0,Dn.MULTIPLE_SOW),continueLapUntilCaptureOrEmptyHouse:new Jn(!1,Dn.CYCLICAL_LAP),seedsByHouse:new _1(4,Dn.SEEDS_BY_HOUSE,m1.range(1,99)),width:new _1(6,Gi.WIDTH,m1.range(1,99))}});static get(){return Uo.singleton.isAbsent()&&(Uo.singleton=h.of(new Uo([]))),Uo.singleton.get()}getRulesConfigDescription(){return h.of(Uo.RULES_CONFIG_DESCRIPTION)}applyCapture(t){const e=t.resultingState,n={capturedSum:0,captureMap:rt.create(6,2,0),resultingState:e};if(t.endsUpInStore)return n;{const i=t.filledCoords[t.filledCoords.length-1],o=t.resultingState.getCurrentPlayerY(),s=t.resultingState.getOpponentY(),a=t.resultingState.getPieceAt(i),c=t.resultingState.getPieceAtXY(i.x,s);if(i.y===o&&1===a&&c>0){const l=e.getCopiedBoard(),u=l[0][i.x]+l[1][i.x],f=rt.create(e.getWidth(),2,0);f[0][i.x]=l[0][i.x],f[1][i.x]=l[1][i.x];const g=e.getCurrentPlayer();let y=e.capture(g,i);const N=new _(i.x,(i.y+1)%2);return y=y.capture(g,N),{capturedSum:u,captureMap:f,resultingState:y}}return n}}}class dLe extends SI{constructor(){super(Uo.get())}}function hLe(r,t){if(1&r){const e=he();I(),E(0,"g")(1,"g",8),q("click",function(){const o=te(e).index,s=p().index;return ne(p().onClick(o,s))}),P()()}if(2&r){const e=t.$implicit,n=t.index,i=p().index,o=p();m(),ve("id","click_",n,"_",i,""),v("x",n)("y",i)("content",e)("spaceClasses",o.getSpaceClasses(n,i))("rotation",o.getPieceRotation())("secondaryContent",o.getHouseSecondaryContent(n,i)),A("transform",o.getPieceTransform(n,i))}}function gLe(r,t){if(1&r&&(I(),E(0,"g"),z(1,hLe,2,9,"g",2),P()),2&r){const e=t.$implicit;m(),v("ngForOf",e)}}let pLe=(()=>{class r extends OI{constructor(e,n){super(e,n),this.setRulesAndNode("Kalah"),this.availableAIs=this.createAIs(new dLe),this.encoder=w1.encoder}static \u0275fac=function(n){return new(n||r)(G(Ut),G(Vs))};static \u0275cmp=Ue({type:r,selectors:[["app-kalah-component"]],features:[$e],decls:8,vars:21,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["x","0","y","0","ry","115","rx","115","fill","blue",1,"base"],[4,"ngFor","ngForOf"],["x1","120","y1","120","y2","120",1,"base"],["x1","120","y1","0","x2","120","y2","240",1,"base"],["y1","0","y2","240",1,"base"],["id","store_player_0","app-numbered-circle","","transform","translate(60 120)",3,"x","y","content","spaceClasses","rotation","secondaryContent","click"],["id","store_player_1","app-numbered-circle","",3,"x","y","content","spaceClasses","rotation","secondaryContent","click"],["app-numbered-circle","",3,"id","x","y","content","spaceClasses","rotation","secondaryContent","click"]],template:function(n,i){1&n&&(I(),E(0,"svg",0),V(1,"rect",1),z(2,gLe,2,1,"g",2),V(3,"line",3)(4,"line",4)(5,"line",5),E(6,"g",6),q("click",function(){return i.onStoreClick(i.Player.ZERO)}),P(),E(7,"g",7),q("click",function(){return i.onStoreClick(i.Player.ONE)}),P()()),2&n&&(A("viewBox",i.getMancalaViewBox())("transform",i.rotation),m(),A("width",i.getViewBoxWidth())("height",240),m(),v("ngForOf",i.board),m(),A("x2",i.getViewBoxWidth()-120),m(2),A("x1",i.getViewBoxWidth()-120)("x2",i.getViewBoxWidth()-120),m(),v("x",-1)("y",-1)("content",i.getStoreContent(i.Player.ZERO))("spaceClasses",i.getSpaceClasses(-1,-1))("rotation",i.getPieceRotation())("secondaryContent",i.getStoreSecondaryContent(i.Player.ZERO)),m(),v("x",2)("y",2)("content",i.getStoreContent(i.Player.ONE))("spaceClasses",i.getSpaceClasses(2,2))("rotation",i.getPieceRotation())("secondaryContent",i.getStoreSecondaryContent(i.Player.ONE)),A("transform","translate("+(i.getViewBoxWidth()-60)+" 120)"))},dependencies:[Nt,TI],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"],changeDetection:0})}return r})();const Rd=Uo.get().getDefaultRulesConfig();class mLe extends Wn{gameName=$localize`Kalah`;tutorial=[_s.intro(this.gameName,Uo.get().getInitialState(Rd)),W.informational($localize`Kalah`,$localize`Bonus fact: Kalah has been created in the U.S.A in 1940 by William Julius Champion Jr.`,Uo.get().getInitialState(Rd)),_s.sowing(Uo.get().getInitialState(Rd)),W.forClick($localize`The Kalah (1/2)`,$localize`The houses on the extreme left and right, unaligned with the others, are the Kalah. Yours is on the left, the opponent's on the right. When sowing, before passing from your leftmost house to the leftmost house of the opponent, you must drop one seed in your Kalah, but you won't have to drop seed in your opponent's Kalah. When you make a capture, the captured seeds are put in your Kalah.<br/><br/>You're playing Dark. Make a move that passes through your Kalah then feeds opponent's houses.`,Uo.get().getInitialState(Rd),["#click_0_1","#click_1_1","#click_2_1"],$localize`As you see, three houses have been fed in addition to your Kalah.`,$localize`Failed. Choose the three leftmost house on the bottom.`),W.fromPredicate($localize`The Kalah (2/2)`,$localize`When ending in the Kalah, you must distribute again.<br/><br/>You're playing Dark, play the house that ends up in the Kalah then do a second distribution!`,Uo.get().getInitialState(Rd),w1.of(p1.of(3),[p1.of(1)]),(t,e,n)=>1===t.distributions.length?w.failure($localize`This move only distributed one house, do one distribution that ends in the Kalah, then do a second one!`):w.SUCCESS,pe.CONGRATULATIONS()),W.fromPredicate($localize`Captures`,$localize`When the last seed of a distribution ends up in one of your empty houses, if the opposite house is filled, then you capture both houses. On this board, such a move is possible.<br/><br/>You're playing Dark, do a capture!`,new $1([[0,4,4,4,4,4],[0,2,0,2,4,0]],4,we.of(0,0)),w1.of(p1.of(1),[p1.of(0),p1.of(3)]),(t,e,n)=>0===n.getPieceAtXY(1,0)?w.SUCCESS:w.failure($localize`You did not capture, try again!`),pe.CONGRATULATIONS()),W.fromMove(pe.END_OF_THE_GAME(),$localize`At any moment, when one player has more than 24 seeds in their Kalah, they win. That can happen before the board is empty, but, there is also a second way. When you don't have any seed in your houses, the game is over and your opponent takes all the remaining seeds from their houses. Here, your opponent just need one more point to win and will get it next turn if you allow it.<br/><br/>You're playing Dark, win!`,new $1([[0,0,0,0,2,0],[2,0,0,0,0,1]],0,we.of(19,24)),[w1.of(p1.of(5))],$localize`Since there is no longer seeds in the opponent houses, all your seeds have been captured by you. Congratulations, you won!`,$localize`Failed, you gave the opponent a seed! Try again.`)]}class Hn{value;name;rgb;static ANY=new Hn(0,"any","#000");static ORANGE=new Hn(1,"orange","#d67421");static BLUE=new Hn(2,"blue","#006bac");static PURPLE=new Hn(3,"purple","#6f3787");static PINK=new Hn(4,"pink","#d2719e");static YELLOW=new Hn(5,"yellow","#e2c200");static RED=new Hn(6,"red","#d23339");static GREEN=new Hn(7,"green","#009157");static BROWN=new Hn(8,"brown","#562500");static of(t){switch(t){case 0:return Hn.ANY;case 1:return Hn.ORANGE;case 2:return Hn.BLUE;case 3:return Hn.PURPLE;case 4:return Hn.PINK;case 5:return Hn.YELLOW;case 6:return Hn.RED;case 7:return Hn.GREEN;default:return L.expectToBe(t,8,"Invalid value "+t+" for KamisadoColor"),Hn.BROWN}}constructor(t,e,n){this.value=t,this.name=e,this.rgb=n}}class An{player;color;constructor(t,e){this.player=t,this.color=e}static EMPTY=new An(B.NONE,Hn.ANY);static of(t,e){return new An(t,Hn.of(e))}static createPlayerColors(t){return{ORANGE:new An(t,Hn.ORANGE),BLUE:new An(t,Hn.BLUE),PURPLE:new An(t,Hn.PURPLE),PINK:new An(t,Hn.PINK),YELLOW:new An(t,Hn.YELLOW),RED:new An(t,Hn.RED),GREEN:new An(t,Hn.GREEN),BROWN:new An(t,Hn.BROWN)}}static ZERO=An.createPlayerColors(O.ZERO);static ONE=An.createPlayerColors(O.ONE);equals(t){return t.player===this.player&&t.color===this.color}isEmpty(){return this.player.equals(B.NONE)}belongsTo(t){return this.player===t}}class Go{static INITIAL=Go.getInitialBoard();static SIZE=8;static COLORS=rt.map([[1,2,3,4,5,6,7,8],[6,1,4,7,2,5,8,3],[7,4,1,6,3,8,5,2],[4,3,2,1,8,7,6,5],[5,6,7,8,1,2,3,4],[2,5,8,3,6,1,4,7],[3,8,5,2,7,4,1,6],[8,7,6,5,4,3,2,1]],Hn.of);static getColorAt(t,e){return Go.COLORS[e][t]}static getInitialBoard(){const t=An.EMPTY;return[[1,2,3,4,5,6,7,8].map(e=>An.of(O.ONE,e)),[t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t],[8,7,6,5,4,3,2,1].map(e=>An.of(O.ZERO,e))]}static isEmptyAt(t,e){return t[e.y][e.x].equals(An.EMPTY)}static allPieceCoords(t){const e=[];for(let n=0;n<t.length;n++)for(let i=0;i<t[n].length;i++){const o=new _(i,n);!1===Go.isEmptyAt(t,o)&&e.push(o)}return e}}class o4 extends B1{colorToPlay;coordToPlay;alreadyPassed;static isOnBoard(t){return t.isInRange(Go.SIZE,Go.SIZE)}constructor(t,e,n,i,o){super(rt.copy(o),t),this.colorToPlay=e,this.coordToPlay=n,this.alreadyPassed=i}}class Cu extends h2{static PASS=new Cu;static encoder=ke.constant("PASS",Cu.PASS);constructor(){super()}length(){return 0}equals(t){return this===t}toString(){return"KamisadoMove(PASS)"}}class vu extends Do{static encoder=G2.getEncoder(vu.of);static of(t,e){return L.assert(o4.isOnBoard(t),"Starting coord of KamisadoMove must be on the board, not at "+t.toString()),L.assert(o4.isOnBoard(e),"End coord of KamisadoMove must be on the board, not at "+e.toString()),new vu(t,e)}constructor(t,e){super(t,e)}equals(t){return t===this||!!Ii.isPiece(t)&&!1!==t.getStart().equals(this.getStart())&&t.getEnd().equals(this.getEnd())}toString(){return"KamisadoMove("+this.getStart()+"->"+this.getEnd()+")"}}function _Le(r){return r instanceof Cu}var Ii;!function(r){r.PASS=Cu.PASS,r.of=function t(n,i){return vu.of(n,i)},r.isPiece=function e(n){return n instanceof vu},r.encoder=ke.disjunction([r.isPiece,_Le],[vu.encoder,Cu.encoder])}(Ii||(Ii={}));let xd=(()=>class r{static NOT_RIGHT_COLOR=()=>$localize`This piece is not of the color you have to play.`;static DIRECTION_NOT_ALLOWED=()=>$localize`You can only move forward, orthogonally or diagonally.`;static MOVE_BLOCKED=()=>$localize`This move is blocked by another piece.`;static PLAY_WITH_SELECTED_PIECE=()=>$localize`You must play with the selected piece.`})();class E2 extends Ar{static singleton=h.empty();static get(){return E2.singleton.isAbsent()&&(E2.singleton=h.of(new E2)),E2.singleton.get()}getInitialState(){return new o4(0,Hn.ANY,h.empty(),!1,Go.INITIAL)}static getColorMatchingPiece(t){return t.coordToPlay.isPresent()?[t.coordToPlay.get()]:[new _(0,7),new _(1,7),new _(2,7),new _(3,7),new _(4,7),new _(5,7),new _(6,7),new _(7,7)]}static getMovablePieces(t){return E2.getColorMatchingPiece(t).filter(e=>{for(const n of this.playerDirections(t.getCurrentPlayer())){const i=e.getNext(n);if(t.isOnBoard(i)&&Go.isEmptyAt(t.board,i))return!0}return!1})}static playerDirections(t){return t===O.ONE?[me.DOWN,me.DOWN_LEFT,me.DOWN_RIGHT]:[me.UP,me.UP_LEFT,me.UP_RIGHT]}static directionAllowedForPlayer(t,e){return e===O.ZERO?t.y<0:t.y>0}static mustPass(t){return 0===this.getMovablePieces(t).length}static getFurthestPiecePositions(t){let e=7,n=0;return Go.allPieceCoords(t.board).forEach(i=>{const o=t.getPieceAt(i);L.assert(o!==An.EMPTY,"allPieceCoords failed to filter KamisadoPiece.EMPTY"),o.player===O.ONE?n=Math.max(n,i.y):e=Math.min(e,i.y)}),we.of(e,n)}static isLegal(t,e){if(Ii.isPiece(t)){const n=t.getStart(),i=t.getEnd(),o=e.colorToPlay,s=e.getPieceAt(n);if(s.isEmpty())return w.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(s.belongsTo(e.getCurrentOpponent()))return w.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT());if(o!==Hn.ANY&&s.color!==o)return w.failure(xd.NOT_RIGHT_COLOR());if(!1===e.getPieceAt(i).isEmpty())return w.failure(Ee.MUST_CLICK_ON_EMPTY_SPACE());const c=me.factory.fromMove(n,i);if(c.isFailure())return w.failure(xd.DIRECTION_NOT_ALLOWED());const l=c.get();if(!1===E2.directionAllowedForPlayer(l,e.getCurrentPlayer()))return w.failure(xd.DIRECTION_NOT_ALLOWED());let u=n;for(;!1===u.equals(i);)if(u=u.getNext(l),!1===e.getPieceAt(u).isEmpty())return w.failure(xd.MOVE_BLOCKED());return w.SUCCESS}return this.isLegalPass(e)}static isLegalPass(t){return this.mustPass(t)&&!1===t.alreadyPassed?w.SUCCESS:w.failure(Ee.CANNOT_PASS())}nextCoordToPlay(t,e){return h.ofNullable(Go.allPieceCoords(t.board).find(n=>{const i=t.getPieceAt(n);return i.player===t.getCurrentOpponent()&&i.color===e}))}applyLegalMove(t,e,n,i){if(Ii.isPiece(t)){const o=t.getStart(),s=t.getEnd(),a=e.getCopiedBoard();a[s.y][s.x]=a[o.y][o.x],a[o.y][o.x]=An.EMPTY;const c=Go.getColorAt(s.x,s.y),l=this.nextCoordToPlay(e,c);return new o4(e.turn+1,c,l,!1,a)}{const o=this.nextCoordToPlay(e,e.colorToPlay);return new o4(e.turn+1,e.colorToPlay,o,!0,e.board)}}isLegal(t,e){return E2.isLegal(t,e)}getGameStatus(t){const e=t.gameState,n=e.getCurrentPlayer();if(E2.mustPass(e)&&e.alreadyPassed)return ye.getDefeat(n);const i=E2.getFurthestPiecePositions(e);return 7===i.get(O.ONE)?ye.ONE_WON:0===i.get(O.ZERO)?ye.ZERO_WON:ye.ONGOING}}class CLe extends rr{getMetrics(t,e){const i=E2.getFurthestPiecePositions(t.gameState);return G1.ofSingle(7-i.get(O.ZERO),i.get(O.ONE))}}class kJ extends Kn{getListMoves(t,e){const n=t.gameState,i=E2.getMovablePieces(n);if(0===i.length)return L.assert(!1===n.alreadyPassed,"getListMovesFromState should not be called once game is ended."),[Ii.PASS];{const o=this.getListMovesFromNonBlockedState(n,i);return yt.sortByDescending(o,s=>s.length()),o}}getListMovesFromNonBlockedState(t,e){const n=[],i=t.getCurrentPlayer();for(const o of e)for(const s of E2.playerDirections(i))for(let a=1;a<Go.SIZE;a++){const c=o.getNext(s,a);if(!t.isOnBoard(c)||!Go.isEmptyAt(t.board,c))break;{const l=Ii.of(o,c);n.push(l)}}return n}}function vLe(r,t){if(1&r&&(I(),V(0,"circle",8)),2&r){const e=p(),n=e.$implicit,i=e.index,o=p().index,s=p();v("ngClass",s.piecePlayerClass(n)),A("cx",s.SPACE_SIZE/2+i*s.SPACE_SIZE)("cy",s.SPACE_SIZE/2+o*s.SPACE_SIZE)("r",s.SPACE_SIZE/2-s.STROKE_WIDTH)}}function yLe(r,t){if(1&r&&(I(),V(0,"rect",9)),2&r){const e=p(),n=e.index,i=e.$implicit,o=p().index,s=p();A("x",s.SPACE_SIZE/2+n*s.SPACE_SIZE-s.SPACE_SIZE/8)("y",s.SPACE_SIZE/2+o*s.SPACE_SIZE-s.SPACE_SIZE/8)("rx",s.isPlayerZero(i)?s.SPACE_SIZE:0)("ry",s.isPlayerZero(i)?s.SPACE_SIZE:0)("width",s.SPACE_SIZE/4)("height",s.SPACE_SIZE/4)("fill",s.pieceColor(i))}}function MLe(r,t){if(1&r){const e=he();I(),E(0,"g")(1,"g",4),q("click",function(){const o=te(e).index,s=p().index;return ne(p().onClick(o,s))}),V(2,"rect",5),z(3,vLe,1,4,"circle",6)(4,yLe,1,7,"rect",7),P()()}if(2&r){const e=t.$implicit,n=t.index,i=p().index,o=p();m(),ve("id","click_",n,"_",i,""),m(),A("x",n*o.SPACE_SIZE)("y",i*o.SPACE_SIZE)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE)("fill",o.backgroundColor(n,i)),m(),v("ngIf",e!==o.UNOCCUPIED),m(),v("ngIf",e!==o.UNOCCUPIED)}}function ELe(r,t){if(1&r&&(I(),E(0,"g"),z(1,MLe,5,9,"g",1),P()),2&r){const e=t.$implicit;m(),v("ngForOf",e)}}function PLe(r,t){if(1&r&&(I(),E(0,"g"),V(1,"rect",10)(2,"rect",10),P()),2&r){const e=p();m(),ve("id","last_move_start_",e.lastPieceMove.get().getStart().x,"_",e.lastPieceMove.get().getStart().y,""),A("x",e.lastPieceMove.get().getStart().x*e.SPACE_SIZE)("y",e.lastPieceMove.get().getStart().y*e.SPACE_SIZE)("width",e.SPACE_SIZE)("height",e.SPACE_SIZE),m(),ve("id","last_move_start_",e.lastPieceMove.get().getEnd().x,"_",e.lastPieceMove.get().getEnd().y,""),A("x",e.lastPieceMove.get().getEnd().x*e.SPACE_SIZE)("y",e.lastPieceMove.get().getEnd().y*e.SPACE_SIZE)("width",e.SPACE_SIZE)("height",e.SPACE_SIZE)}}function SLe(r,t){if(1&r&&(I(),V(0,"circle",11)),2&r){const e=p();A("cx",e.SPACE_SIZE/2+e.chosen.get().x*e.SPACE_SIZE)("cy",e.SPACE_SIZE/2+e.chosen.get().y*e.SPACE_SIZE)("r",e.SPACE_SIZE/2-e.STROKE_WIDTH)}}let OLe=(()=>{class r extends p2{UNOCCUPIED=An.EMPTY;lastMove=h.empty();lastPieceMove=h.empty();chosen=h.empty();chosenAutomatically=!1;constructor(e){super(e),this.setRulesAndNode("Kamisado"),this.availableAIs=[new fn($localize`Minimax`,E2.get(),new CLe,new kJ),new zn($localize`MCTS`,new kJ,this.rules)],this.encoder=Ii.encoder,this.hasAsymmetricBoard=!0}backgroundColor(e,n){return Go.getColorAt(e,n).rgb}isPlayerZero(e){return e.player===O.ZERO}pieceColor(e){return e.color.rgb}piecePlayerClass(e){return this.getPlayerClass(e.player)}updateBoard(e){var n=this;return M(function*(){const i=n.getState();n.board=i.getCopiedBoard(),n.canPass=E2.mustPass(i);const o=n.rules.getGameStatus(n.node)!==ye.ONGOING;n.canPass||i.coordToPlay.isAbsent()||o?(n.chosenAutomatically=!1,n.chosen=h.empty()):(n.chosenAutomatically=!0,n.chosen=i.coordToPlay)})()}showLastMove(e){var n=this;return M(function*(){Ii.isPiece(e)&&(n.lastPieceMove=h.of(e))})()}hideLastMove(){this.lastPieceMove=h.empty()}pass(){var e=this;return M(function*(){return pn(e.canPass,"KamisadoComponent: pass() must be called only if canPass is true"),e.chooseMove(Ii.PASS)})()}onClick(e,n){var i=this;return M(function*(){const o=yield i.canUserPlay("#click_"+e+"_"+n);if(o.isFailure())return i.cancelMove(o.getReason());const s=new _(e,n);if(i.canPass)return i.cancelMove(Ee.MUST_PASS());if(i.chosen.isAbsent())return i.choosePiece(e,n);if(!1===i.chosenAutomatically&&i.chosen.equalsValue(s))return i.cancelMoveAttempt(),w.SUCCESS;{const a=i.getState().getPieceAtXY(e,n),c=i.getState().getCurrentPlayer();return a.belongsTo(c)?i.chosenAutomatically?i.cancelMove(xd.PLAY_WITH_SELECTED_PIECE()):(i.chosen=h.of(s),w.SUCCESS):yield i.chooseDestination(e,n)}})()}choosePiece(e,n){var i=this;return M(function*(){const o=i.getState().getPieceAtXY(e,n),s=i.getState().getCurrentOpponent();return o.belongsTo(s)?i.cancelMove(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT()):(i.chosen=h.of(new _(e,n)),w.SUCCESS)})()}chooseDestination(e,n){var i=this;return M(function*(){const o=i.chosen.get(),s=new _(e,n),a=Ii.of(o,s);return i.chooseMove(a)})()}cancelMoveAttempt(){!1===this.chosenAutomatically&&(this.chosen=h.empty())}static \u0275fac=function(n){return new(n||r)(G(Ut))};static \u0275cmp=Ue({type:r,selectors:[["app-kamisado"]],features:[$e],decls:4,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf"],["id","selectedPiece","class","base mid-stroke no-fill selected-stroke",4,"ngIf"],[3,"id","click"],["fill-opacity","0.7",1,"base-no-fill"],["class","base-no-fill",3,"ngClass",4,"ngIf"],["class","no-stroke",4,"ngIf"],[1,"base-no-fill",3,"ngClass"],[1,"no-stroke"],[1,"base","no-fill","mid-stroke","last-move-stroke",3,"id"],["id","selectedPiece",1,"base","mid-stroke","no-fill","selected-stroke"]],template:function(n,i){1&n&&(I(),E(0,"svg",0),z(1,ELe,2,1,"g",1)(2,PLe,3,12,"g",2)(3,SLe,1,3,"circle",3),P()),2&n&&(A("viewBox",i.getViewBox().toSVGString())("transform",i.rotation),m(),v("ngForOf",i.board),m(),v("ngIf",i.lastPieceMove.isPresent()),m(),v("ngIf",i.chosen.isPresent()))},dependencies:[zt,Nt,bt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}return r})();const Y=An.EMPTY,FC=An.ZERO.ORANGE,UC=An.ONE.ORANGE,GC=An.ZERO.BLUE,BC=An.ONE.BLUE,ZI=An.ZERO.PURPLE,Ld=An.ONE.PURPLE,$C=An.ZERO.PINK,WC=An.ONE.PINK,qC=An.ZERO.YELLOW,jC=An.ONE.YELLOW,ZC=An.ZERO.RED,YC=An.ONE.RED,KC=An.ZERO.GREEN,XC=An.ONE.GREEN,QC=An.ZERO.BROWN,JC=An.ONE.BROWN;class TLe extends Wn{tutorial=[W.informational($localize`Goal of the game`,$localize`At Kamisado, there are two ways to win the game:
        either by moving one of your pieces on the opponent's starting line,
        or by forcing the opponent to make a move that blocks the entire game.
        Here, Dark wins because its brown piece is on Light's starting line, on the top left.`,new o4(5,Hn.ORANGE,h.empty(),!1,[[QC,BC,Ld,WC,jC,YC,XC,JC],[Y,Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,UC,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y,Y],[Y,KC,ZC,qC,$C,ZI,GC,FC]])).withPreviousMove(Ii.of(new _(0,7),new _(0,0))),W.anyMove($localize`Initial board and initial move`,$localize`Here is the initial board.
        At Kamisado, pieces can only move forward, vertically or diagonally.
        You're playing first, with dark pieces, you can make your first move.<br/><br/>
        You're playing Dark, click on the piece of your choice and click on a landing square.`,E2.get().getInitialState(),Ii.of(new _(7,7),new _(3,3)),$localize`Perfect! Note that each of your piece has a different color.`),W.fromMove($localize`Moving`,$localize`Let us now consider the move of Light, after the blue piece has been moved by Dark.
        All moves after the initial move must be made from the piece that corresponds to the color
        of the square upon which the last move ended.
        Here, the last move ended on the pink square, hence the pink piece must move.
        It is already selected, you do not have to click on it.<br/><br/>
        You're playing Light, move your piece on a blue square.`,new o4(1,Hn.PINK,h.of(new _(3,0)),!1,[[UC,BC,Ld,WC,jC,YC,XC,JC],[Y,Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,GC,Y],[Y,Y,Y,Y,Y,Y,Y,Y],[QC,KC,ZC,qC,$C,ZI,Y,FC]]),[Ii.of(new _(3,0),new _(3,6)),Ii.of(new _(3,0),new _(4,1))],pe.CONGRATULATIONS(),$localize`You have not moved your pink piece on a blue square!`).withPreviousMove(Ii.of(new _(6,7),new _(6,5))),W.informational($localize`Stuck situation`,$localize`Dark moved to another pink square, hence you have to move your pink piece again.
        However, your pink piece is stuck! In this case, you must pass your turn.
        Dark will now have to play by moving its pink piece.`,new o4(1,Hn.PINK,h.of(new _(3,6)),!1,[[UC,BC,Ld,Y,jC,YC,XC,JC],[Y,Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y,GC],[Y,Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,WC,Y,Y,Y,Y],[QC,KC,ZC,qC,$C,ZI,Y,FC]])).withPreviousMove(Ii.of(new _(6,5),new _(7,4))),W.fromMove($localize`Victory by blocking`,$localize`At any time, if a player blocks the entire game, that player loses.
        In other words, if a player forces its opponent to move a piece that the opponent cannot move,
        and the player cannot move its own piece of the same color, then that player loses.
        Here, you're playing Dark and you can force your opponent to create such a situation, hence you can force your opponent to lose!<br/><br/>
        You're playing Dark, analyze the board and make the winning move.`,new o4(2,Hn.RED,h.of(new _(2,4)),!1,[[Y,BC,Ld,Y,Y,YC,Y,Y],[Y,Y,Y,jC,Y,Y,Y,Y],[Y,Y,Y,WC,Y,Ld,Y,Y],[Y,Y,Y,qC,Y,Y,Y,Y],[Y,Y,ZC,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,XC,Y],[UC,Y,Y,Y,Y,$C,Y,JC],[QC,KC,Y,Y,Y,Y,GC,FC]]),[Ii.of(new _(2,4),new _(0,2))],$localize`Perfect!
         Your opponent must move its green piece on the orange square, forcing you to play with your orange piece.
         Your orange piece will be stuck and you will have to pass your turn.
         Your opponent will have to pass its turn too because its orange piece is also stuck: the game is completely stuck.
         In this case, the last player to have moved a piece loses.
         Here, your opponent will have moved its green piece last, you therefore win!`,pe.FAILED_TRY_AGAIN()).withPreviousMove(Ii.of(new _(4,0),new _(3,1)))]}let RJ=(()=>{class r extends p2{getParallelogramCoords(e){const n=e.parallelogramHeight,i=n*e.horizontalWidthRatio,o=n*e.offsetRatio,s=i,c=i-o,l=n,u=-o,f=n;return[new _(0,0),new _(s,0),new _(c,l),new _(u,f)]}getCoordTranslation(e,n,i,o){const s=o.parallelogramHeight;return new _(e*(s*o.horizontalWidthRatio)+o.offsetRatio*s*(o.abstractBoardSize-n),n*s-o.pieceHeightRatio*s*i)}static \u0275fac=(()=>{let e;return function(i){return(e||(e=z1(r)))(i||r)}})();static \u0275cmp=Ue({type:r,selectors:[["ng-component"]],features:[$e],decls:0,vars:0,template:function(n,i){},encapsulation:2})}return r})(),s4=(()=>class r{static CANNOT_GO_BACKWARD=()=>$localize`You cannot go backward with normal pieces!`;static CANNOT_CAPTURE_EMPTY_SPACE=()=>$localize`You cannot capture an empty square, nor jump over it!`;static CANNOT_SKIP_CAPTURE=()=>$localize`You must capture when it is possible!`;static MUST_FINISH_CAPTURING=()=>$localize`You must finish this capture!`;static THIS_PIECE_CANNOT_MOVE=()=>$localize`This piece cannot move!`;static CAPTURE_STEPS_MUST_BE_DOUBLE_DIAGONAL=()=>$localize`A capture should be a double diagonal step. Look at the green indicators to help you!`;static MOVE_STEPS_MUST_BE_SINGLE_DIAGONAL=()=>$localize`You must move in a single diagonal step!`;static CANNOT_CAPTURE_TWICE_THE_SAME_COORD=()=>$localize`You cannot jump over the same square several times!`})();class P2{player;isOfficer;static ZERO=new P2(O.ZERO,!1);static ONE=new P2(O.ONE,!1);static ZERO_OFFICER=new P2(O.ZERO,!0);static ONE_OFFICER=new P2(O.ONE,!0);static getPlayerOfficer(t){return t===O.ZERO?P2.ZERO_OFFICER:P2.ONE_OFFICER}constructor(t,e){this.player=t,this.isOfficer=e}toString(){switch(this){case P2.ZERO:return"u";case P2.ONE:return"v";case P2.ZERO_OFFICER:return"O";default:return L.expectToBe(this,P2.ONE_OFFICER),"X"}}equals(t){return this===t}}class Bo{pieces;static EMPTY=new Bo([]);constructor(t){this.pieces=t}isEmpty(){return 0===this.pieces.length}isCommandedBy(t){return!this.isEmpty()&&this.getCommander().player===t}getCommander(){return this.pieces[0]}getPiecesUnderCommander(){return new Bo(this.pieces.slice(1))}capturePiece(t){return new Bo(this.pieces.concat(t))}addStackBelow(t){let e=this;for(const n of t.pieces)e=e.capturePiece(n);return e}getStackSize(){return this.pieces.length}promoteCommander(){let t=this.getCommander();if(t.isOfficer)return this;{t=P2.getPlayerOfficer(t.player);const e=this.getPiecesUnderCommander();return new Bo([t]).addStackBelow(e)}}get(t){return this.pieces[t]}toString(t){let e=t-this.getStackSize(),n="";for(;e>0;)n+="_",e--;for(const i of this.pieces)n+=i.toString();return n}}let Qr=(()=>{class r extends B1{static SIZE=7;static of(e,n){return new r(e,n)}static isNotOnBoard(e){return e.isNotInRange(r.SIZE,r.SIZE)}static isOnBoard(e){return e.isInRange(r.SIZE,r.SIZE)}getStacksOf(e){const n=[];for(let i=0;i<r.SIZE;i++)for(let o=0;o<r.SIZE;o++)this.getPieceAtXY(o,i).isCommandedBy(e)&&n.push(new _(o,i));return n}set(e,n){const i=this.getCopiedBoard();return i[e.y][e.x]=n,new r(i,this.turn)}remove(e){return this.set(e,Bo.EMPTY)}incrementTurn(){return new r(this.getCopiedBoard(),this.turn+1)}getFinishLineOf(e){return e===O.ZERO?0:r.SIZE-1}toString(){let e=1;for(let i=0;i<r.SIZE;i++)for(let o=0;o<r.SIZE;o++){const s=this.getPieceAtXY(o,i).getStackSize();e=Math.max(e,s)}const n=[];for(let i=0;i<r.SIZE;i++){const o=[];for(let s=0;s<r.SIZE;s++)o.push(this.getPieceAtXY(s,i).toString(e));n.push(o.join(" "))}return n.join("\n")}}return r})();class wLe extends st{equals(t){if(t.size()!==this.size())return!1;for(let e=0;e<this.size();e++)if(!1===zo(t.get(e),this.get(e)))return!1;return!0}get(t){return L.assert(t<this.values.length,"MGPUniqueList: index out of bounds: "+t),this.values[t]}getFromEnd(t){return L.assert(t<this.values.length,"MGPUniqueList: index (from end) out of bounds: "+t),this.get(this.values.length-1-t)}}class ui extends h2{isStep;static of(t,e){return new ui(t,e)}static fromCapture(t){const e=ui.getSteppedOverCoords(t);return e.isSuccess()?X.success(new ui(t,!1)):X.failure(e.getReason())}static getSteppedOverCoords(t){let e=h.empty();const n=new st;for(const i of t){if(Qr.isNotOnBoard(i))return X.failure(uo.OUT_OF_RANGE(i));if(e.isPresent()){const o=e.get();if(!1===o.getVectorToward(i).isDiagonalOfLength(2))return X.failure(s4.CAPTURE_STEPS_MUST_BE_DOUBLE_DIAGONAL());const a=o.getCoordsToward(i)[0];if(n.contains(a))return X.failure(s4.CANNOT_CAPTURE_TWICE_THE_SAME_COORD());n.add(a)}e=h.of(i)}return X.success(n)}static fromStep(t,e){return Qr.isNotOnBoard(t)?X.failure(uo.OUT_OF_RANGE(t)):Qr.isNotOnBoard(e)?X.failure(uo.OUT_OF_RANGE(e)):!1===t.getVectorToward(e).isDiagonalOfLength(1)?X.failure(s4.MOVE_STEPS_MUST_BE_SINGLE_DIAGONAL()):X.success(new ui([t,e],!0))}static encoder=ke.tuple([ke.list(_.encoder),ke.identity()],t=>[t.coords.toList(),t.isStep],t=>ui.of(t[0],t[1]));coords;constructor(t,e){super(),this.isStep=e,this.coords=new wLe(t)}toString(){return"LascaMove("+this.coords.toList().map(n=>n.toString()).join(", ")+")"}getRelation(t){const e=this.coords.size(),n=t.coords.size(),i=Math.min(e,n);for(let o=0;o<i;o++)if(!1===this.coords.toList()[o].equals(t.coords.toList()[o]))return"INEQUALITY";return e===n?"EQUALITY":"PREFIX"}equals(t){return"EQUALITY"===this.getRelation(t)}isPrefix(t){return"PREFIX"===this.getRelation(t)}getStartingCoord(){return this.coords.get(0)}getEndingCoord(){return this.coords.getFromEnd(0)}getCapturedCoords(){return ui.getSteppedOverCoords(this.coords.toList())}concatenate(t){const e=this.getEndingCoord(),n=t.coords.toList()[0];pn(e.equals(n),"should not concatenate non-touching move");const i=this.coords.toList(),o=yt.copy(i),s=t.coords.toList(),a=yt.copy(s).slice(1);return ui.fromCapture(o.concat(a)).get()}}class Ps extends Ar{static singleton=h.empty();static get(){return Ps.singleton.isAbsent()&&(Ps.singleton=h.of(new Ps)),Ps.singleton.get()}getInitialState(){const t=new Bo([P2.ZERO]),e=new Bo([P2.ONE]),n=Bo.EMPTY;return new Qr([[e,n,e,n,e,n,e],[n,e,n,e,n,e,n],[e,n,e,n,e,n,e],[n,n,n,n,n,n,n],[t,n,t,n,t,n,t],[n,t,n,t,n,t,n],[t,n,t,n,t,n,t]],0)}getCaptures(t){const e=t.getCurrentPlayer();return this.getCapturesOf(t,e)}getCapturesOf(t,e){const n=[],i=t.getStacksOf(e);for(const o of i)n.push(...this.getPieceCaptures(t,o));return n}getPieceCaptures(t,e){let n=[];const s=t.getPieceAt(e).getCommander().player.getOpponent(),a=this.getPieceDirections(t,e),c=t.getPieceAt(e);for(const l of a){const u=e.getNext(l,1);if(Qr.isOnBoard(u)&&t.getPieceAt(u).isCommandedBy(s)){const f=u.getNext(l,1);if(Qr.isOnBoard(f)&&t.getPieceAt(f).isEmpty()){const g=t.remove(e).remove(u).set(f,c),y=ui.fromCapture([e,f]).get(),S=this.getPieceCaptures(g,f);if(0===S.length)n=n.concat(y);else{const N=S.map(R=>y.concatenate(R));n=n.concat(N)}}}}return n}getPieceDirections(t,e){const o=t.getPieceAt(e).getCommander().player.getScoreModifier(),s=[me.factory.fromDelta(-1,o).get(),me.factory.fromDelta(1,o).get()];return t.getPieceAt(e).getCommander().isOfficer&&s.push(me.factory.fromDelta(-1,-o).get(),me.factory.fromDelta(1,-o).get()),s}getSteps(t){const e=t.getCurrentPlayer();return this.getStepsOf(t,e)}getStepsOf(t,e){const n=[],i=t.getStacksOf(e);for(const o of i)n.push(...this.getPieceSteps(t,o));return n}getPieceSteps(t,e){const n=[],i=this.getPieceDirections(t,e);for(const o of i){const s=e.getNext(o,1);if(Qr.isOnBoard(s)&&t.getPieceAt(s).isEmpty()){const a=ui.fromStep(e,s).get();n.push(a)}}return n}applyLegalMove(t,e,n,i){const o=t.getStartingCoord(),s=t.getEndingCoord();let a=e.getPieceAt(o),c=e.remove(o);if(!1===t.isStep)for(const l of t.getCapturedCoords().get()){const u=e.getPieceAt(l),f=u.getCommander();a=a.capturePiece(f);const g=u.getPiecesUnderCommander();c=c.set(l,g)}if(c=c.set(s,a),s.y===e.getFinishLineOf(e.getCurrentPlayer())){const l=a.promoteCommander();c=c.set(s,l)}return c.incrementTurn()}isLegal(t,e){const n=t.getStartingCoord();if(e.getPieceAt(n).isEmpty())return w.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());const i=e.getPieceAt(n),o=e.getCurrentOpponent();if(i.isCommandedBy(o))return w.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT());const s=t.coords.get(1);if(!1===i.getCommander().isOfficer&&n.getDirectionToward(s).get().y===o.getScoreModifier())return w.failure(s4.CANNOT_GO_BACKWARD());if(!1===e.getPieceAt(s).isEmpty())return w.failure(Ee.MUST_LAND_ON_EMPTY_SPACE());const a=this.getCaptures(e);return t.isStep?a.length>0?w.failure(s4.CANNOT_SKIP_CAPTURE()):w.SUCCESS:this.isLegalCapture(t,e,a)}isLegalCapture(t,e,n){const i=e.getCurrentPlayer(),o=t.getCapturedCoords().get();for(const s of o){const a=e.getPieceAt(s);if(a.isCommandedBy(i))return w.failure(Ee.CANNOT_SELF_CAPTURE());if(a.isEmpty())return w.failure(s4.CANNOT_CAPTURE_EMPTY_SPACE())}return n.some(s=>s.equals(t))?w.SUCCESS:w.failure(s4.MUST_FINISH_CAPTURING())}getGameStatus(t){const e=t.gameState;return this.getCaptures(e).length>0||this.getSteps(e).length>0?ye.ONGOING:ye.getVictory(e.getCurrentOpponent())}}class xJ extends rr{getMetrics(t,e){return this.getControlScore(t)}getControlScore(t){const e=t.gameState,n=G1.of([0],[0]);for(const i of O.PLAYERS)n.add(i,0,this.getNumberOfMobileCoords(e,i));return n}getNumberOfMobileCoords(t,e){const i=this.getCapturesAndSteps(t,e).map(s=>s.getStartingCoord());return new st(i).size()}getCapturesAndSteps(t,e){const n=Ps.get().getCapturesOf(t,e),i=Ps.get().getStepsOf(t,e);return n.concat(i)}}class bLe extends Kn{getListMoves(t,e){const n=Ps.get().getCaptures(t.gameState);return n.length>0?n:Ps.get().getSteps(t.gameState)}}class ALe extends xJ{getMetrics(t,e){const n=this.getControlScore(t),i=this.getDominatedPieceScore(t);return n.concat(i)}getDominatedPieceScore(t){const e=G1.of([0],[0]),n=t.gameState,i=n.getWidth(),o=n.getHeight();for(let s=0;s<o;s++)for(let a=0;a<i;a++){const c=n.getPieceAtXY(a,s);if(c.getStackSize()>0){const l=c.getStackSize();let u=0;const f=c.getCommander().player;for(;u<l&&c.get(u).player===f;)u++;e.add(f,0,u)}}return e}}function NLe(r,t){if(1&r&&(I(),V(0,"circle",15)),2&r){const e=p(),n=e.index,i=e.$implicit,o=p().$implicit,s=p(2);Ur("id","square_",o.x,"_",o.y,"_piece_",n,"_officer_symbol"),v("ngClass",i.classes),A("cx",.4*s.SPACE_SIZE)("cy",.575*s.SPACE_SIZE)("r",.045*s.SPACE_SIZE)}}function ILe(r,t){if(1&r&&(I(),E(0,"g",12),V(1,"use",13),z(2,NLe,1,7,"circle",14),P()),2&r){const e=t.$implicit,n=t.index,i=p().$implicit;A("transform",p(2).getPieceTranslation(n)),m(),Ur("id","square_",i.x,"_",i.y,"_piece_",n,""),v("ngClass",e.classes),m(),v("ngIf",e.isOfficer)}}function kLe(r,t){if(1&r){const e=he();I(),E(0,"g",8)(1,"g",9),q("click",function(){const o=te(e).$implicit;return ne(p(2).onClick(o.x,o.y))}),V(2,"polygon",10),z(3,ILe,3,6,"g",11),P()()}if(2&r){const e=t.$implicit,n=t.index,i=p().index,o=p();ve("id","square_at_",n,"_",i,""),m(),ve("id","coord_",e.x,"_",e.y,""),A("transform",o.getTranslationAtXYZ(n,i,0)),m(),ve("id","square_",e.x,"_",e.y,""),v("ngClass",e.squareClasses),A("points",o.getParallelogramPoints()),m(),v("ngForOf",e.pieceInfos)}}function RLe(r,t){if(1&r&&(I(),E(0,"g"),z(1,kLe,4,10,"g",7),P()),2&r){const e=t.$implicit;m(),v("ngForOf",e)}}let xLe=(()=>{class r extends RJ{THICKNESS=40;mode={horizontalWidthRatio:1.2,offsetRatio:.4,pieceHeightRatio:1,parallelogramHeight:100,abstractBoardSize:Qr.SIZE};LEFT=0;UP=-this.SPACE_SIZE;basicWidth=this.mode.abstractBoardSize*this.mode.parallelogramHeight;WIDTH=this.basicWidth*(this.mode.horizontalWidthRatio+this.mode.offsetRatio);HEIGHT=this.basicWidth+this.THICKNESS+this.STROKE_WIDTH-this.UP;CX=this.WIDTH/2;CY=(this.HEIGHT+this.UP)/2;adaptedBoard={isAlreadySwitched:!1,spaceInfo:[]};currentMoveClicks=[];capturedCoords=[];legalMoves=[];moveGenerator=new bLe;constructor(e){super(e),this.setRulesAndNode("Lasca"),this.availableAIs=[new fn($localize`Control`,this.rules,new xJ,this.moveGenerator),new fn($localize`Control and Domination`,this.rules,new ALe,this.moveGenerator),new zn($localize`MCTS`,this.moveGenerator,this.rules)],this.encoder=ui.encoder,this.hasAsymmetricBoard=!0}updateBoard(e){var n=this;return M(function*(){const i=n.getState();n.board=i.getCopiedBoard(),n.legalMoves=n.moveGenerator.getListMoves(n.node,n.config),n.createAdaptedBoardFrom(i),n.showPossibleMoves(),n.rotateAdaptedBoardIfNeeded()})()}createAdaptedBoardFrom(e){this.adaptedBoard={isAlreadySwitched:!1,spaceInfo:[]};for(let o=0;o<Qr.SIZE;o++){const s=[];for(let a=0;a<Qr.SIZE;a++){const c=this.getSpaceInfo(e,a,o);s.push(c)}this.adaptedBoard.spaceInfo.push(s)}const i=h.ofNullable(this.currentMoveClicks[this.currentMoveClicks.length-1]);if(i.isPresent()){const o=i.get();for(const s of this.getSpaceInfoAt(o).pieceInfos)s.classes.push("selected-stroke");this.showPossibleLandings(o,e)}for(const o of this.capturedCoords)this.getSpaceInfoAt(o).squareClasses.push("captured-fill");for(const o of this.currentMoveClicks)this.getSpaceInfoAt(o).squareClasses.push("moved-fill")}getSpaceInfo(e,n,i){const o=e.getPieceAtXY(n,i),s=[];for(let a=o.getStackSize()-1;0<=a;a--){const c=o.get(a);s.push({classes:[this.getPlayerClass(c.player)],isOfficer:c.isOfficer})}return{pieceInfos:s,x:n,y:i,squareClasses:[]}}showLastMove(e){var n=this;return M(function*(){n.showLastCapture(e),n.showSteppedOnCoord(e)})()}showLastCapture(e){if(!1===e.isStep){const n=e.getCapturedCoords();L.assert(n.isSuccess(),"Last move is a capture yet has illegal jumps !?");for(const i of n.get())this.getSpaceInfoAt(i).squareClasses.push("captured-fill")}}showSteppedOnCoord(e){for(const n of e.coords)this.getSpaceInfoAt(n).squareClasses.push("moved-fill")}showPossibleMoves(){if(this.interactive)for(const e of this.legalMoves){const n=e.getStartingCoord();this.getSpaceInfoAt(n).squareClasses.push("selectable-fill")}}getSpaceInfoAt(e){if(this.getPointOfView()===O.ONE&&this.adaptedBoard.isAlreadySwitched){const n=Qr.SIZE-1,i=new _(n-e.x,n-e.y);return this.adaptedBoard.spaceInfo[i.y][i.x]}return this.adaptedBoard.spaceInfo[e.y][e.x]}rotateAdaptedBoardIfNeeded(){if(this.getPointOfView()===O.ONE){const e=[];for(let n=0;n<Qr.SIZE;n++){e[Qr.SIZE-1-n]=[];for(let i=0;i<Qr.SIZE;i++)e[Qr.SIZE-1-n][Qr.SIZE-1-i]=this.getSpaceInfoAt(new _(i,n))}this.adaptedBoard={isAlreadySwitched:!0,spaceInfo:e}}}hideLastMove(){this.createAdaptedBoardFrom(this.getState()),this.rotateAdaptedBoardIfNeeded()}onClick(e,n){var i=this;return M(function*(){const o=yield i.canUserPlay("#coord_"+e+"_"+n);if(o.isFailure())return i.cancelMove(o.getReason());const s=new _(e,n),a=i.getState().getPieceAt(s),c=i.getState().getCurrentOpponent();return a.isCommandedBy(c)?i.cancelMove(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT()):0===i.currentMoveClicks.length?i.trySelectingPiece(s):i.moveClick(s)})()}cancelMoveAttempt(){this.currentMoveClicks=[],this.capturedCoords=[],this.createAdaptedBoardFrom(this.getState()),this.showPossibleMoves(),this.rotateAdaptedBoardIfNeeded()}moveClick(e){var n=this;return M(function*(){if(e.equals(n.currentMoveClicks[0]))return n.cancelMoveAttempt(),w.SUCCESS;const i=n.getState().getPieceAt(e),o=n.getState().getCurrentPlayer();if(i.isCommandedBy(o))return n.cancelMoveAttempt(),n.trySelectingPiece(e);if(1===n.currentMoveClicks.length&&n.currentMoveClicks[0].getVectorToward(e).isDiagonalOfLength(1)){const a=ui.fromStep(n.currentMoveClicks[0],e).get();return n.chooseMove(a)}return n.capture(e)})()}capture(e){var n=this;return M(function*(){const o=n.currentMoveClicks[n.currentMoveClicks.length-1],s=o.getVectorToward(e);if(s.isDiagonalOfLength(2)){const a=new _(o.x+s.x/2,o.y+s.y/2);n.capturedCoords.push(a),n.currentMoveClicks.push(e);const c=ui.fromCapture(n.currentMoveClicks).get();return n.legalMoves.some(l=>l.isPrefix(c))?n.applyPartialCapture():n.chooseMove(c)}return n.cancelMove(s4.CAPTURE_STEPS_MUST_BE_DOUBLE_DIAGONAL())})()}applyPartialCapture(){let e=this.getState().remove(this.currentMoveClicks[0]),n=this.getState().getPieceAt(this.currentMoveClicks[0]);for(const o of this.capturedCoords){const s=this.getState().getPieceAt(o),a=s.getCommander(),c=s.getPiecesUnderCommander();e=e.set(o,c),n=n.capturePiece(a)}return e=e.set(this.currentMoveClicks[this.currentMoveClicks.length-1],n),this.createAdaptedBoardFrom(e),this.rotateAdaptedBoardIfNeeded(),w.SUCCESS}trySelectingPiece(e){var n=this;return M(function*(){return n.getState().getPieceAt(e).isEmpty()?n.cancelMove(Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):n.selectPiece(e)})()}selectPiece(e){var n=this;return M(function*(){return n.capturedCoords=[],n.legalMoves.some(i=>i.getStartingCoord().equals(e))?(n.currentMoveClicks=[e],n.hideLastMove(),w.SUCCESS):n.cancelMove(s4.THIS_PIECE_CANNOT_MOVE())})()}showPossibleLandings(e,n){const i=this.rules.getPieceCaptures(n,e);if(0===i.length){const o=this.rules.getPieceSteps(n,e);for(const s of o)this.getSpaceInfoAt(s.getEndingCoord()).squareClasses.push("selectable-fill")}else{const o=i.map(s=>s.coords.get(1));for(const s of o)this.getSpaceInfoAt(s).squareClasses.push("capturable-fill")}}getTranslationAtXYZ(e,n,i){const o=this.getCoordTranslation(e,n,i,this.mode);return"translate("+o.x+" "+o.y+")"}getParallelogramPoints(){return this.getParallelogramCoordsForLasca().map(n=>n.x+", "+n.y).join(" ")}getParallelogramCoordsForLasca(){return this.getParallelogramCoords(this.mode)}getParallelogramCenter(){const e=this.getParallelogramCoordsForLasca();return this.getParallelogramCenterOf(e[0],e[1],e[2],e[3])}getParallelogramCenterOf(e,n,i,o){const s=Math.max(e.x,n.x,i.x,o.x),a=Math.max(e.y,n.y,i.y,o.y),c=Math.min(e.x,n.x,i.x,o.x),l=Math.min(e.y,n.y,i.y,o.y);return new _((s-c)/2,(a-l)/2)}getRightEdge(){const e=this.basicWidth*this.mode.horizontalWidthRatio,n=this.basicWidth*this.mode.offsetRatio;return[n+e,0,n+e,this.THICKNESS,e,this.basicWidth+this.THICKNESS,e,this.basicWidth].join(" ")}getPieceTranslation(e){return"translate(0 "+(this.getParallelogramCenter().y-32.5-e*(.15*this.SPACE_SIZE))+")"}static \u0275fac=function(n){return new(n||r)(G(Ut))};static \u0275cmp=Ue({type:r,selectors:[["app-lasca"]],features:[$e],decls:8,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["id","piece"],["d","M 0 25 v 15 a 40 25, 0, 0, 0, 80 0 v -15 a 40 25, 0, 0, 0, -80 0 Z"],["cx","40","cy","25","rx","40","ry","25"],[4,"ngFor","ngForOf"],["x","0",1,"base"],[1,"base"],[3,"id",4,"ngFor","ngForOf"],[3,"id"],[3,"id","click"],[1,"base",3,"id","ngClass"],["pointer-events","fill","class","base mid-small-stroke",4,"ngFor","ngForOf"],["pointer-events","fill",1,"base","mid-small-stroke"],[0,"xlink","href","#piece",1,"base","mid-stroke",3,"id","ngClass"],[3,"id","ngClass",4,"ngIf"],[3,"id","ngClass"]],template:function(n,i){1&n&&(I(),E(0,"svg",0)(1,"defs")(2,"g",1),V(3,"path",2)(4,"ellipse",3),P()(),z(5,RLe,2,1,"g",4),V(6,"rect",5)(7,"polygon",6),P()),2&n&&(A("viewBox",i.LEFT+" "+i.UP+" "+i.WIDTH+" "+i.HEIGHT),m(5),v("ngForOf",i.adaptedBoard.spaceInfo),m(),A("y",i.basicWidth)("width",i.basicWidth*i.mode.horizontalWidthRatio)("height",i.THICKNESS),m(),A("points",i.getRightEdge()))},dependencies:[zt,Nt,bt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}return r})();const LJ=P2.ZERO,YI=P2.ONE,Jr=new Bo([LJ]),q1=new Bo([YI]),LLe=new Bo([LJ,YI]),zLe=new Bo([P2.ZERO_OFFICER,YI]),Z=Bo.EMPTY;class DLe extends Wn{tutorial=[W.informational($localize`Lasca: origins`,$localize`Lasca is a game based on draughts created in 1911 by Emanuel Lasker, chess world champion. It's played on a 7x7 board, each player has 11 pieces.`,Ps.get().getInitialState()),W.informational($localize`Goal of the game`,$localize`The goal of Lasca is, like for draughts, to render the opponent unable to move, either by capturing all his pieces, either by blocking them.`,Ps.get().getInitialState()),W.anyMove($localize`Steps`,$localize`A simple step is made by one diagonal move forward, left or right. Click on the chosen piece, then on its landing square.<br/><br/>You are playing Dark, do the first move.`,Ps.get().getInitialState(),ui.fromStep(new _(4,4),new _(3,3)).get(),pe.CONGRATULATIONS()),W.anyMove($localize`Captures`,$localize`A capture happens when you jump diagonally over an opponent piece to land right behind it. You have to capture when you can. It is the case here, so click on the piece that must capture, and then on its landing square.<br/><br/>You're playing Dark, go ahead.`,Qr.of([[q1,Z,Z,Z,q1,Z,q1],[Z,Z,Z,q1,Z,q1,Z],[Z,Z,q1,Z,q1,Z,q1],[Z,q1,Z,Z,Z,Z,Z],[Jr,Z,Jr,Z,Jr,Z,Jr],[Z,Jr,Z,Jr,Z,Jr,Z],[Jr,Z,Jr,Z,Jr,Z,Jr]],2),ui.fromCapture([new _(2,4),new _(0,2)]).get(),$localize`Congratulations, notice that the captured piece was not removed from the board, but put below the capturing pieces.`),W.anyMove($localize`Multiple captures`,$localize`If, after the beginning of your capture, the piece that you just moved can capture another piece, it has to capture until it can no longer capture. To do so, you must then click again on the next landing square. Note that, you cannot jump twice over the same stack.<br/><br/>You are playing Dark, a double capture is possible, go ahead.`,Qr.of([[Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z],[q1,Z,Z,Z,q1,Z,q1],[Z,q1,Z,q1,Z,q1,Z],[Z,Z,q1,Z,q1,Z,q1],[Z,q1,Z,Z,Z,Z,Z],[Z,Z,Jr,Z,Jr,Z,Jr]],2),ui.fromCapture([new _(2,6),new _(0,4),new _(2,2)]).get(),pe.CONGRATULATIONS()),W.informational($localize`Minority capture is allowed`,$localize`If you have several capture choices, you are allowed to choose any of them. For example if one choice is to capture one piece, and the other choice is to capture two pieces, you can choose either.`,Qr.of([[Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,q1,Z],[Z,Z,Z,Z,Z,Z,Z],[Z,q1,Z,q1,Z,Z,Z],[Z,Z,Jr,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z]],2)),W.fromMove($localize`Promotion`,$localize`When a stack reaches the last line, its commander becomes an officer, and gains the ability to go backward, which is illegal for the other pieces! One of your piece could be promoted now.<br/><br/>You're playing Dark. Do it.`,Qr.of([[Z,Z,Z,Z,Z,Z,q1],[Z,Z,Z,LLe,Z,q1,Z],[Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z],[Z,Z,Jr,Z,Jr,Z,Jr]],2),[ui.fromStep(new _(3,1),new _(2,0)).get(),ui.fromStep(new _(3,1),new _(4,0)).get()],pe.CONGRATULATIONS(),$localize`You did not choose the correct stack, and got no promotion.`),W.fromMove($localize`Officer move`,$localize`Officers can move and capture backward as well as forward.<br/><br/>You're playing Dark, move your officier!`,Qr.of([[Z,Z,Z,Z,zLe,Z,q1],[Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,q1,Z,Z],[Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z],[Z,Z,Jr,Z,Jr,Z,Jr]],2),[ui.fromStep(new _(4,0),new _(3,1)).get(),ui.fromStep(new _(4,0),new _(5,1)).get()],pe.CONGRATULATIONS(),$localize`You did not move your officer.`)]}let W2=(()=>{class r extends B1{static SIZE=8;static isOnBoard(e){return e.isInRange(r.SIZE,r.SIZE)}}return r})();class _o extends Do{direction;static encoder=G2.getFallibleEncoder(_o.from);static from(t,e){const n=me.factory.fromMove(t,e);return n.isFailure()?X.failure(n.getReason()):t.isNotInRange(W2.SIZE,W2.SIZE)?X.failure("start coord is not in range"):e.isNotInRange(W2.SIZE,W2.SIZE)?X.failure("end coord is not in range"):X.success(new _o(t,e,n.get()))}constructor(t,e,n){super(t,e),this.direction=n,this.direction=me.factory.fromMove(t,e).get()}toString(){return"LinesOfActionMove("+this.getStart()+"->"+this.getEnd()+")"}}let KI=(()=>class r{static INVALID_MOVE_LENGTH=()=>$localize`Your move should have a length equal to the number of pieces that exist on the same line.`;static CANNOT_JUMP_OVER_OPPONENT=()=>$localize`You cannot jump over the opponent's pieces.`;static PIECE_CANNOT_MOVE=()=>$localize`This piece has no possible move, select another one.`})();class ki extends Ar{static singleton=h.empty();static get(){return ki.singleton.isAbsent()&&(ki.singleton=h.of(new ki)),ki.singleton.get()}getInitialState(){const t=B.NONE,e=B.ZERO,n=B.ONE;return new W2([[t,e,e,e,e,e,e,t],[n,t,t,t,t,t,t,n],[n,t,t,t,t,t,t,n],[n,t,t,t,t,t,t,n],[n,t,t,t,t,t,t,n],[n,t,t,t,t,t,t,n],[n,t,t,t,t,t,t,n],[t,e,e,e,e,e,e,t]],0)}static getNumberOfGroups(t){const e=rt.create(W2.SIZE,W2.SIZE,-1),n=we.of(0,0);let i=0;for(const o of t.getCoordsAndContents())-1===e[o.coord.y][o.coord.x]&&o.content.isPlayer()&&(i+=1,ki.markGroupStartingAt(t,e,o.coord,i),n.add(o.content,1));return n}static markGroupStartingAt(t,e,n,i){const o=[n],s=t.getPieceAt(n);for(;o.length>0;){const a=L.getNonNullable(o.pop());if(-1===e[a.y][a.x]){const c=t.getPieceAt(a);if(c===s){e[a.y][a.x]=i;for(const l of me.DIRECTIONS){const u=a.getNext(l);t.isOnBoard(u)&&o.push(u)}}else c===B.NONE&&(e[a.y][a.x]=0)}}}applyLegalMove(t,e,n,i){const o=e.getCopiedBoard();return o[t.getStart().y][t.getStart().x]=B.NONE,o[t.getEnd().y][t.getEnd().x]=e.getCurrentPlayer(),new W2(o,e.turn+1)}static isLegal(t,e){const n=e.getPieceAt(t.getStart());return n===B.NONE?w.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):n===e.getCurrentOpponent()?w.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT()):t.length()!==this.numberOfPiecesOnLine(e,t.getStart(),t.direction)?w.failure(KI.INVALID_MOVE_LENGTH()):t.getStart().getCoordsToward(t.getEnd()).some(i=>e.getPieceAt(i)===e.getCurrentOpponent())?w.failure(KI.CANNOT_JUMP_OVER_OPPONENT()):e.getPieceAt(t.getEnd())===e.getCurrentPlayer()?w.failure(Ee.SHOULD_LAND_ON_EMPTY_OR_OPPONENT_SPACE()):w.SUCCESS}isLegal(t,e){return ki.isLegal(t,e)}static numberOfPiecesOnLine(t,e,n){let i=0;for(const o of ki.getLineCoords(e,n))t.getPieceAt(o).isPlayer()&&(i+=1);return i}static getLineCoords(t,e){const n=ki.getEntranceAndForwardDirection(t,e);let i=n[0];const o=n[1],s=[];for(;W2.isOnBoard(i);)s.push(i),i=i.getNext(o);return s}static getEntranceAndForwardDirection(t,e){switch(e){case me.UP:case me.DOWN:return[new _(t.x,0),me.DOWN];case me.LEFT:case me.RIGHT:return[new _(0,t.y),me.RIGHT];case me.UP_RIGHT:case me.DOWN_LEFT:return[new _(Math.max(0,t.x+t.y-7),Math.min(7,t.x+t.y)),me.UP_RIGHT];default:return L.expectToBeMultiple(e,[me.UP_LEFT,me.DOWN_RIGHT]),[new _(t.x-Math.min(t.x,t.y),t.y-Math.min(t.x,t.y)),me.DOWN_RIGHT]}}static getVictory(t){const e=ki.getNumberOfGroups(t),n=e.get(O.ZERO),i=e.get(O.ONE);return 1===n&&1===i?h.of(B.NONE):1===n?h.of(O.ZERO):1===i?h.of(O.ONE):h.empty()}static possibleTargets(t,e){const n=[];for(const i of me.DIRECTIONS){const o=ki.numberOfPiecesOnLine(t,e,i),s=e.getNext(i,o);if(t.isOnBoard(s)){const a=_o.from(e,s).get();ki.isLegal(a,t).isSuccess()&&n.push(s)}}return n}getGameStatus(t){const n=ki.getNumberOfGroups(t.gameState),i=n.get(O.ZERO),o=n.get(O.ONE);return 1===i&&o>1?ye.ZERO_WON:i>1&&1===o?ye.ONE_WON:ye.ONGOING}}class VLe extends rr{getMetrics(t,e){const i=ki.getNumberOfGroups(t.gameState);return G1.ofSingle(100/i.get(O.ZERO),100/i.get(O.ONE))}}class zJ extends Kn{getListMoves(t,e){const n=t.gameState,i=[];if(ki.getVictory(n).isPresent())return i;for(let o=0;o<W2.SIZE;o++)for(let s=0;s<W2.SIZE;s++){const a=new _(s,o);if(n.getPieceAt(a).isPlayer())for(const l of ki.possibleTargets(n,a)){const u=_o.from(a,l).get();i.push(u)}}return i}}function HLe(r,t){if(1&r&&(I(),V(0,"circle",4)),2&r){const e=p().index,n=p().index,i=p();ve("id","piece_",e,"_",n,""),v("ngClass",i.getPieceClasses(e,n)),A("cx",i.SPACE_SIZE/2+e*i.SPACE_SIZE)("cy",i.SPACE_SIZE/2+n*i.SPACE_SIZE)("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)}}function FLe(r,t){if(1&r){const e=he();I(),E(0,"g")(1,"g",3),q("click",function(){const o=te(e).index,s=p().index;return ne(p().onClick(o,s))}),V(2,"rect",4),z(3,HLe,1,6,"circle",5),P()()}if(2&r){const e=t.$implicit,n=t.index,i=p().index,o=p();m(),ve("id","click_",n,"_",i,""),m(),ve("id","space_",n,"_",i,""),v("ngClass",o.getSquareClasses(n,i)),A("x",n*o.SPACE_SIZE)("y",i*o.SPACE_SIZE)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),m(),v("ngIf",e!==o.EMPTY)}}function ULe(r,t){if(1&r&&(I(),E(0,"g"),z(1,FLe,4,10,"g",1),P()),2&r){const e=t.$implicit;m(),v("ngForOf",e)}}function GLe(r,t){if(1&r){const e=he();I(),E(0,"rect",6),q("click",function(){const o=te(e).$implicit;return ne(p().onClick(o.x,o.y))}),P()}if(2&r){const e=t.$implicit,n=p();A("x",e.x*n.SPACE_SIZE+(n.SPACE_SIZE/2-n.INDICATOR_SIZE/2))("y",e.y*n.SPACE_SIZE+(n.SPACE_SIZE/2-n.INDICATOR_SIZE/2))("width",n.INDICATOR_SIZE)("height",n.INDICATOR_SIZE)}}let BLe=(()=>{class r extends p2{INDICATOR_SIZE=20;EMPTY=B.NONE;targets=[];state;selected=h.empty();lastMoved=[];captured=h.empty();constructor(e){super(e),this.setRulesAndNode("LinesOfAction"),this.availableAIs=[new fn($localize`Minimax`,this.rules,new VLe,new zJ),new zn($localize`MCTS`,new zJ,this.rules)],this.encoder=_o.encoder}onClick(e,n){var i=this;return M(function*(){const o=yield i.canUserPlay("#click_"+e+"_"+n);if(o.isFailure())return i.cancelMove(o.getReason());const s=new _(e,n);if(i.selected.equalsValue(s))return i.cancelMoveAttempt(),w.SUCCESS;const a=i.getState().getCurrentPlayer();return i.selected.isAbsent()||i.getState().getPieceAt(s)===a?i.select(s):i.concludeMove(s)})()}concludeMove(e){var n=this;return M(function*(){const i=_o.from(n.selected.get(),e);return i.isSuccess()?n.chooseMove(i.get()):n.cancelMove(i.getReason())})()}select(e){var n=this;return M(function*(){const i=n.getState().getPieceAt(e);return i===B.NONE?n.cancelMove(Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):i===n.getState().getCurrentOpponent()?n.cancelMove(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT()):(n.selected=h.of(e),n.targets=ki.possibleTargets(n.getState(),n.selected.get()),0===n.targets.length?n.cancelMove(KI.PIECE_CANNOT_MOVE()):w.SUCCESS)})()}updateBoard(e){var n=this;return M(function*(){n.cancelMoveAttempt(),n.board=n.getState().board})()}showLastMove(e){var n=this;return M(function*(){n.getPreviousState().getPieceAt(e.getEnd()).isPlayer()&&(n.captured=h.of(e.getEnd()));const i=e.getStart(),o=e.getEnd();n.lastMoved=[i,o]})()}hideLastMove(){this.captured=h.empty(),this.lastMoved=[]}cancelMoveAttempt(){this.selected=h.empty(),this.targets=[]}getSquareClasses(e,n){const i=new _(e,n);return this.captured.equalsValue(i)?["captured-fill"]:this.lastMoved.some(o=>o.equals(i))?["moved-fill"]:[]}getPieceClasses(e,n){const i=this.board[n][e],o=new _(e,n),s=[this.getPlayerClass(i)];return this.selected.isPresent()&&this.selected.get().equals(o)&&s.push("selected-stroke"),s}static \u0275fac=function(n){return new(n||r)(G(Ut))};static \u0275cmp=Ue({type:r,selectors:[["app-linesofaction"]],features:[$e],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","indicator",3,"click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base",3,"id","ngClass"],["class","base",3,"id","ngClass",4,"ngIf"],[1,"indicator",3,"click"]],template:function(n,i){1&n&&(I(),E(0,"svg",0),z(1,ULe,2,1,"g",1)(2,GLe,1,4,"rect",2),P()),2&n&&(A("viewBox",i.getViewBox().toSVGString()),m(),v("ngForOf",i.board),m(),v("ngForOf",i.targets))},dependencies:[zt,Nt,bt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}return r})();const F=B.NONE,N1=B.ZERO,S1=B.ONE;class $Le{tutorial=[W.informational($localize`Goal of the game`,$localize`At Lines of Actions, the goal is to group your pieces contiguously, orthogonally and/or diagonally.
        Here, Dark wins the game:
        Dark's pieces are forming a single group, while Light's pieces form three groups.`,new W2([[F,F,F,F,F,F,F,F],[S1,F,F,F,N1,F,F,S1],[F,F,N1,N1,S1,F,F,F],[F,F,F,N1,F,F,F,F],[F,F,F,F,F,F,F,F],[F,F,F,F,F,F,F,F],[F,F,F,F,F,F,F,F],[F,F,F,F,F,F,F,F]],0)),W.anyMove($localize`Initial board and initial move`,$localize`Here is the initial board.
         Moves can be made orthogonally or diagonally.
         The length of a move is equal to the number of pieces that are on the line of the move.
         Note that there is a helping indicator to let you know where a piece can land when you select it.<br/><br/>
         You're playing Dark, make the first move!`,ki.get().getInitialState(),_o.from(new _(1,7),new _(1,5)).get(),pe.CONGRATULATIONS()),W.fromMove($localize`Jumping`,$localize`During a move, it is possible to jump above your own pieces.
        But it is forbidden to jump over the opponent's pieces.<br/><br/>
        You're playing Dark, make a jump over one of your pieces on the following board.`,new W2([[F,F,F,F,F,F,F,F],[F,F,S1,N1,N1,F,F,F],[F,F,F,F,F,F,F,F],[F,F,F,F,F,F,F,F],[F,F,F,F,F,F,F,F],[F,F,F,F,F,F,F,F],[F,F,F,F,F,F,F,S1],[F,F,F,F,F,F,F,N1]],0),[_o.from(new _(3,1),new _(6,1)).get()],pe.CONGRATULATIONS(),$localize`Failed. You did not jump over one of your pieces.`),W.fromMove($localize`Moving`,$localize`Here is a different board. Pick the dark piece in the middle (line 4, column 4)
        and observe its possible moves.
        <ul>
            <li>Horizontally, this piece can move only of one square because it is the only piece on this line.</li>
            <li>Vertically, this piece can move of three squares because there are in total three pieces on that vertical line.
                But it can only go up, as below it the landing square is occupied by one of your pieces.</li>
            <li>Diagonally, only one move is possible: on the diagonal that contains three pieces,
                only in the direction where it does not jump over one of the opponent's pieces.
                On the other diagonal, there are too many pieces to end the move on the board.</li>
        </ul><br/>
        You're playing Dark, make one of these moves.`,new W2([[F,F,F,F,F,F,S1,F],[F,F,F,F,F,N1,F,F],[F,F,F,F,S1,F,F,F],[F,F,F,N1,F,F,F,F],[F,F,F,F,F,F,F,S1],[F,F,F,F,F,S1,F,S1],[F,F,F,N1,F,F,S1,S1],[F,F,F,N1,F,F,F,F]],0),[_o.from(new _(3,3),new _(3,0)).get(),_o.from(new _(3,3),new _(0,0)).get(),_o.from(new _(3,3),new _(2,3)).get(),_o.from(new _(3,3),new _(4,3)).get()],pe.CONGRATULATIONS(),$localize`Failed. This was not one of the expected moves.`),W.fromPredicate($localize`Captures`,$localize`If a move ends on an opponent's piece, it is captured and removed from the board.
        However, a move cannot end on one of the player's pieces.
        Watch out, having less pieces at Lines of Action makes a victory easier, as there are less pieces to regroup!
        If a player has only one piece, that player wins the game.<br/><br/>
        On the following board, try to capture one piece with Dark.`,new W2([[F,N1,F,N1,N1,N1,N1,F],[S1,F,F,F,F,F,F,S1],[F,F,N1,F,S1,F,F,F],[S1,F,F,F,F,F,F,S1],[S1,F,F,F,F,F,F,S1],[S1,F,F,F,F,F,F,S1],[S1,F,F,F,F,F,F,S1],[F,N1,N1,N1,N1,N1,N1,F]],0),_o.from(new _(2,2),new _(4,2)).get(),(t,e,n)=>e.getPieceAt(t.getEnd())===B.ONE?w.SUCCESS:w.failure(pe.FAILED_TRY_AGAIN()),pe.CONGRATULATIONS()),W.fromMove($localize`Tie`,$localize`In the special case where a move ends up connecting all pieces of both player, simultaneously,
        then the game ends up with a tie.<br/><br/>
        You're playing Dark, force the tie in one move.`,new W2([[F,F,F,F,F,F,F,F],[F,F,F,F,F,F,F,F],[N1,F,F,N1,S1,N1,F,F],[F,F,F,N1,F,F,F,S1],[F,F,F,F,F,F,F,S1],[F,F,F,F,F,F,F,S1],[F,F,F,F,F,F,F,S1],[F,F,F,F,F,F,F,F]],0),[_o.from(new _(0,2),new _(4,2)).get()],pe.CONGRATULATIONS(),pe.FAILED_TRY_AGAIN())]}class ja extends Nr{direction;orientation;captures;static encoder=new class extends ke{encode(t){return{coord:_.encoder.encode(t.coord),direction:t.direction,orientation:t.orientation,captures:t.captures}}decode(t){const e=t;return pn(null!=e.coord,"Invalid encoded LodestoneMove"),pn(null!=e.direction,"Invalid encoded LodestoneMove"),pn(null!=e.orientation,"Invalid encoded LodestoneMove"),pn(null!=e.captures,"Invalid encoded LodestoneMove"),new ja(_.encoder.decode(e.coord),e.direction,e.orientation,e.captures)}};constructor(t,e,n,i={top:0,bottom:0,left:0,right:0}){super(t.x,t.y),this.direction=e,this.orientation=n,this.captures=i}toString(){return`LodestoneMove(${this.coord.toString()}, ${this.direction}, ${this.orientation}, { top: ${this.captures.top}, bottom: ${this.captures.bottom}, left: ${this.captures.left}, right: ${this.captures.right} })`}equals(t){return this===t||!(!1===this.coord.equals(t.coord)||this.orientation!==t.orientation||this.direction!==t.direction||this.captures.top!==t.captures.top||this.captures.bottom!==t.captures.bottom||this.captures.left!==t.captures.left||this.captures.right!==t.captures.right)}}class Co{unreachable;static UNREACHABLE=new Co(!0);static EMPTY=new Co(!1);owner=B.NONE;constructor(t){this.unreachable=t}isLodestone(){return!1}isPlayerPiece(){return!1}isEmpty(){return!0}isUnreachable(){return this.unreachable}equals(t){return this===t}}class Zc{owner;static ZERO=new Zc(O.ZERO);static ONE=new Zc(O.ONE);static of(t){return t===O.ZERO?Zc.ZERO:Zc.ONE}constructor(t){this.owner=t}isLodestone(){return!1}isPlayerPiece(){return!0}isEmpty(){return!1}isUnreachable(){return!1}equals(t){return this===t}}class Er{owner;direction;orientation;static ZERO_PUSH_DIAGONAL=new Er(O.ZERO,"push","diagonal");static ZERO_PUSH_ORTHOGONAL=new Er(O.ZERO,"push","orthogonal");static ZERO_PULL_DIAGONAL=new Er(O.ZERO,"pull","diagonal");static ZERO_PULL_ORTHOGONAL=new Er(O.ZERO,"pull","orthogonal");static ONE_PUSH_DIAGONAL=new Er(O.ONE,"push","diagonal");static ONE_PUSH_ORTHOGONAL=new Er(O.ONE,"push","orthogonal");static ONE_PULL_DIAGONAL=new Er(O.ONE,"pull","diagonal");static ONE_PULL_ORTHOGONAL=new Er(O.ONE,"pull","orthogonal");static LODESTONES={0:{push:{diagonal:Er.ZERO_PUSH_DIAGONAL,orthogonal:Er.ZERO_PUSH_ORTHOGONAL},pull:{diagonal:Er.ZERO_PULL_DIAGONAL,orthogonal:Er.ZERO_PULL_ORTHOGONAL}},1:{push:{diagonal:Er.ONE_PUSH_DIAGONAL,orthogonal:Er.ONE_PUSH_ORTHOGONAL},pull:{diagonal:Er.ONE_PULL_DIAGONAL,orthogonal:Er.ONE_PULL_ORTHOGONAL}}};constructor(t,e,n){this.owner=t,this.direction=e,this.orientation=n}static of(t,e){return Er.LODESTONES[t.getValue()][e.direction][e.orientation]}isLodestone(){return!0}isPlayerPiece(){return!1}isEmpty(){return!1}isUnreachable(){return!1}equals(t){return this===t}}class vo{plates;static of(t){let e=[];for(const n of t){const i=new a4(n,[]);e=e.concat(i)}return new vo(e)}constructor(t){this.plates=t}getCrumbledPlates(){const t=[];for(const e of this.plates){if(0!==e.getRemainingSpaces())return t;t.push(e)}return t}getCurrentPlate(){for(const t of this.plates)if(t.getRemainingSpaces()>0)return h.of(t);return h.empty()}getFollowingPlates(){const t=[];let e=!1;for(const n of this.plates)e?t.push(n):n.getRemainingSpaces()>0&&(e=!0);return t}getCurrentPlateWidth(){const t=this.getCurrentPlate(),e=new a4(0,[]);return t.getOrElse(e).width}getGroupRemainingSpaces(){return this.plates.map(n=>n.getRemainingSpaces()).reduce((n,i)=>n+i)}addCaptured(t,e){if(0===e)return this;const n=this.getGroupRemainingSpaces();L.assert(e<=n,`should never put more pieces than the plate can support (${n} > ${e})`);const i=this.getCrumbledPlates(),o=this.getCurrentPlate().get(),s=this.getFollowingPlates(),a=yt.copy(o.getPiecesCopy()),c=Math.min(e,o.getRemainingSpaces());for(let f=0;f<c;f++)a.push(Zc.of(t)),e--;const l=new a4(o.width,a);return new vo(i.concat(l).concat(s)).addCaptured(t,e)}getFillablePlateIndex(){let t=0;for(const e of this.plates){if(e.getRemainingSpaces()>0)return t;t++}return-1}}let a4=(()=>class r{width;pieces;static POSITIONS=["top","bottom","left","right"];constructor(e,n){this.width=e,this.pieces=n}getPieceAt(e){return e<this.pieces.length?this.pieces[e]:Co.EMPTY}getRemainingSpaces(){return this.width-this.pieces.length}getPiecesCopy(){return yt.copy(this.pieces)}})();var ev;!function(r){r.getInitialLodestonePressurePlates=function t(e){const n={};for(const i of a4.POSITIONS)n[i]=vo.of(e);return n}}(ev||(ev={}));class I1 extends B1{lodestones;pressurePlates;static SIZE=8;static NUMBER_OF_PIECES=24;static INITIAL_PRESSURE_PLATES=ev.getInitialLodestonePressurePlates([5,3]);constructor(t,e,n,i){super(t,e),this.lodestones=n,this.pressurePlates=i}withBoard(t){return new I1(t,this.turn,this.lodestones,this.pressurePlates)}remainingSpaces(){const t=this.remainingSpacesDetails();return t.top+t.bottom+t.left+t.right}remainingSpacesDetails(){const t={top:0,bottom:0,left:0,right:0};for(const e of a4.POSITIONS){const n=this.pressurePlates[e];t[e]=-1===n.getFillablePlateIndex()?0:n.getGroupRemainingSpaces()}return t}numberOfPieces(){const t=we.of(0,0);for(let e=0;e<I1.SIZE;e++)for(let n=0;n<I1.SIZE;n++){const i=this.getPieceAtXY(n,e);i.isPlayerPiece()&&t.add(i.owner,1)}return t}getScores(){const t=this.numberOfPieces();return we.of(I1.NUMBER_OF_PIECES-t.get(O.ONE),I1.NUMBER_OF_PIECES-t.get(O.ZERO))}nextLodestoneDirection(){const t=this.getCurrentPlayer(),e=this.lodestones.get(t);if(!e.isPresent())return h.empty();{const n=this.getPieceAt(e.get());switch(pn(n.isLodestone(),"Piece must be lodestone (invariant from LodestoneState)"+e.get()),n.direction){case"push":return h.of("pull");case"pull":return h.of("push")}}}}let yu=(()=>class r{static MUST_FLIP_LODESTONE=()=>$localize`You must flip your lodestone before putting it back on the board.`;static MUST_PLACE_CAPTURES_ON_PRESSURE_PLATES=()=>$localize`As long as there are pressure plates, you must place all the pieces that you have captured on them.`;static TARGET_IS_CRUMBLED=()=>$localize`You must place your lodestone on a non-crumbled square!`;static TOO_MANY_CAPTURES_ON_SAME_PRESSURE_PLATE=()=>$localize`You placed too many captures on the same pressure plate, which has not enough space left.`;static MUST_PLACE_CAPTURES=()=>$localize`You must place your captures on the pressure plates, on the side of the board.`;static NO_CAPTURES_TO_PLACE_YET=()=>$localize`You cannot place any capture now, you must first place your lodestone on the board!`})();class fi extends Ar{static THREATENED_COORD_RANGE=gn.from({top:{start:t=>new _(0,t),direction:me.RIGHT},bottom:{start:t=>new _(0,I1.SIZE-(t+1)),direction:me.RIGHT},left:{start:t=>new _(t,0),direction:me.DOWN},right:{start:t=>new _(I1.SIZE-(t+1),0),direction:me.DOWN}});static singleton=h.empty();static get(){return fi.singleton.isAbsent()&&(fi.singleton=h.of(new fi)),fi.singleton.get()}getInitialState(){const t=Co.EMPTY,e=Zc.ZERO,n=Zc.ONE,i=[[t,t,e,n,e,n,t,t],[t,e,n,e,n,e,n,t],[e,n,e,n,e,n,e,n],[n,e,n,t,t,e,n,e],[e,n,e,t,t,n,e,n],[n,e,n,e,n,e,n,e],[t,n,e,n,e,n,e,t],[t,t,n,e,n,e,t,t]],o=ev.getInitialLodestonePressurePlates([5,3]);return new I1(i,0,new gn,o)}applyLegalMove(t,e,n,i){const o=e.getCurrentPlayer(),s=o.getOpponent(),a=rt.copy(i.board),c=e.lodestones.getCopy();c.put(o,t.coord);const l={...e.pressurePlates};return this.updatePressurePlates(a,l,c,s,t.captures),new I1(a,e.turn+1,c,l)}updatePressurePlates(t,e,n,i,o){for(const s of a4.POSITIONS)e[s]=this.updatePressurePlate(t,s,e[s],n,i,o[s])}updatePressurePlate(t,e,n,i,o,s){if(n.getCurrentPlate().isPresent()){const a=n.addCaptured(o,s),c=fi.THREATENED_COORD_RANGE.get(e).get(),l=a.getCrumbledPlates().length;for(let u=0;u<l;u++)this.removePressurePlate(t,c.start(u,a.plates[u].width),c.direction,i);return a}return n}removePressurePlate(t,e,n,i){for(let o=e;o.isInRange(I1.SIZE,I1.SIZE);o=o.getNext(n)){for(const s of O.PLAYERS)i.get(s).equalsValue(o)&&i.delete(s);t[o.y][o.x]=Co.UNREACHABLE}}isLegal(t,e){const n=this.isLegalWithoutCaptures(e,t.coord,t.direction);if(n.isFailure())return X.failure(n.getReason());const i=this.applyMoveWithoutPlacingCaptures(e,t.coord,t);if(t.captures.top+t.captures.bottom+t.captures.left+t.captures.right!==Math.min(i.captures.length,e.remainingSpaces()))return X.failure(yu.MUST_PLACE_CAPTURES_ON_PRESSURE_PLATES());for(const a of a4.POSITIONS)if(e.pressurePlates[a].getGroupRemainingSpaces()<t.captures[a])return X.failure(yu.TOO_MANY_CAPTURES_ON_SAME_PRESSURE_PLATE());return X.success(i)}applyMoveWithoutPlacingCaptures(t,e,n){let i;const o=rt.copy(t.board),s=t.lodestones.get(t.getCurrentPlayer());if(s.isPresent()){const a=s.get();o[a.y][a.x]=Co.EMPTY}return i="pull"===n.direction?this.applyPull(t,o,e,n.orientation):this.applyPush(t,o,e,n.orientation),i.board[e.y][e.x]=Er.of(t.getCurrentPlayer(),n),i.moved.push(e),i}applyPull(t,e,n,i){const o=t.getCurrentPlayer(),s=o.getOpponent(),a=[],c=[],l="diagonal"===i?me.DIAGONALS:me.ORTHOGONALS;for(const u of l)for(let f=n.getNext(u);t.isOnBoard(f);f=f.getNext(u)){const g=e[f.y][f.x],y=f.getNext(u);if(t.isOnBoard(y)){const S=e[y.y][y.x];S.isPlayerPiece()&&S.owner===o&&(g.isEmpty()?(c.push(f),e[f.y][f.x]=S,c.push(y),e[y.y][y.x]=Co.EMPTY):g.isPlayerPiece()&&g.owner===s&&(a.push(f),e[f.y][f.x]=S,c.push(y),e[y.y][y.x]=Co.EMPTY))}}return{board:e,captures:a,moved:c}}applyPush(t,e,n,i){const s=t.getCurrentPlayer().getOpponent(),a=[],c=[],l="diagonal"===i?me.DIAGONALS:me.ORTHOGONALS;for(const u of l)for(let g=n.getNext(u,I1.SIZE);!1===g.equals(n);g=g.getPrevious(u))if(t.isOnBoard(g)){const y=e[g.y][g.x];if(y.isPlayerPiece()&&y.owner===s){const S=g.getNext(u);if(t.isOnBoard(S)){const N=e[S.y][S.x];N.isUnreachable()?(a.push(g),e[g.y][g.x]=Co.EMPTY):N.isEmpty()&&(c.push(S),e[S.y][S.x]=y,c.push(g),e[g.y][g.x]=Co.EMPTY)}else a.push(g),e[g.y][g.x]=Co.EMPTY}}return{board:e,captures:a,moved:c}}isLegalWithoutCaptures(t,e,n){const i=this.isTargetLegal(t,e);if(i.isFailure())return i;const o=t.nextLodestoneDirection();return!1===(o.isAbsent()||o.equalsValue(n))?w.failure(yu.MUST_FLIP_LODESTONE()):w.SUCCESS}isTargetLegal(t,e){const n=t.getPieceAt(e);if(n.isUnreachable())return w.failure(yu.TARGET_IS_CRUMBLED());if(n.isPlayerPiece())return w.failure(Ee.MUST_CLICK_ON_EMPTY_SQUARE());const i=t.getCurrentPlayer();return n.isLodestone()&&n.owner!==i?w.failure(Ee.MUST_CLICK_ON_EMPTY_SQUARE()):w.SUCCESS}getGameStatus(t){const n=t.gameState.numberOfPieces(),i=n.get(O.ZERO),o=n.get(O.ONE);return 0===i&&0===o?ye.DRAW:0===i?ye.ONE_WON:0===o?ye.ZERO_WON:ye.ONGOING}}const Re=Co.UNREACHABLE,J=Co.EMPTY,Rr=Zc.ZERO,q2=Zc.ONE,zd=Er.ONE_PUSH_ORTHOGONAL,XI=I1.INITIAL_PRESSURE_PLATES;class WLe extends Wn{tutorial=[W.informational($localize`Board and aim of the game`,$localize`Lodestone is played on a 8x8 board, which contains so-called <i>pressure plates</i> along the board, that will contain captured pieces. The initial board is shown here. The aim of the game is to be the only player with pieces remaining on the board. To do so, you will have to either push your opponent's pieces off the board, or to crush them with your pieces. You will do it by using a lodestone.`,fi.get().getInitialState()),W.forClick($localize`Selecting a lodestone`,$localize`To perform a move, you have to place your lodestone on the board. Your lodestone has two sides: <ul><li>its <i>repelling</i> side with which it will repel the opponent's pieces (indicated by the outward triangles of your opponent's color on the lodestone), and</li><li>its <i>attracting</i> side with which it will attract your pieces (indicated by the inward triangles of your color on the lodestone).</li></ul>Your lodestone can be placed to move pieces orthogonally or diagonally. All available lodestone sides and orientation are shown below the board.<br/><br/>You're playing Dark. Select the lodestone that repels your opponent's pieces diagonally.`,fi.get().getInitialState(),["#lodestone_push_diagonal_PLAYER_ZERO"],pe.CONGRATULATIONS(),$localize`This is not the right lodestone, try again.`),W.informational($localize`The repelling lodestone`,$localize`Upon placing a lodestone on the board, it will move all pieces it acts upon (according to its direction and orientation) simultaneously. Let us first see how the repelling lodestone acts on the pieces. All the opponent's pieces aligned with the lodestone, as indicated by the triangles' orientations, will be pushed one square away from the lodestone. An opponent's piece will be blocked in case it encounters on its way either one of your piece, a lodestone, or another blocked piece. Finally, if an opponent's piece falls out of the board, it is captured.`,fi.get().getInitialState()),W.informational($localize`The attracting lodestone`,$localize`When the lodestone is on its attracting side it will pull your pieces one square towards it. In case one of your pieces encounters a lodestone on its way or another blocked piece, it is blocked. However, if it encounter an opponent's piece, it will capture it.`,fi.get().getInitialState()),W.informational($localize`Flipping the lodestone`,$localize`Note that, after every move, you must flip your lodestone: if it was on its repelling side, you must use it on its attracting side, and vice versa. Also, you are allowed to place your lodestone on the same location as it was on your previous turn.`,fi.get().getInitialState()),W.fromPredicate($localize`Captures`,$localize`To summarize, it is possible to capture the opponent's pieces in two ways:<ul><li>with a repelling lodestone, by pushing your opponent's pieces out of the board, or</li><li>with an attracting lodestone, by moving your pieces on your opponent's pieces.</li></ul>Once a lodestone is placed and the pieces have been moved and/or captured, in case any of the opponent's pieces have been captured, you have to place them on the <i>pressure plates</i> that lie around the board. To do so, click on an empty space of the pressure plate of your choice for each capture. You can cancel this by clicking again on a piece you just put on a pressure plate.<br/><br/>You're playing Dark. Try to perform a move that captures at least one of your opponent's piece, and place your capture(s) on pressure plates.`,fi.get().getInitialState(),new ja(new _(0,6),"pull","orthogonal",{top:2,bottom:1,left:1,right:1}),(t,e,n)=>32===n.remainingSpaces()?w.failure(pe.YOU_DID_NOT_CAPTURE_ANY_PIECE()):w.SUCCESS,pe.CONGRATULATIONS()),W.fromPredicate($localize`Crumbling a first pressure plate`,$localize`When a pressure plate is full, it will crumble and take a full row or column of the board with it! All pieces that are on the crumbled squares are considered lost, but will not have to be placed on pressure plates. You have here a board with a pressure plate that only requires one more piece to crumble.<br/><br/>You're playing Dark. Perform a move that captures at least one piece, and fill that pressure plate to make it crumble.`,new I1([[J,J,J,J,q2,J,J,J],[J,J,Rr,J,J,q2,J,J],[J,J,zd,J,J,J,J,Rr],[J,J,J,J,q2,J,J,Rr],[J,J,J,J,J,Rr,J,J],[J,J,J,J,J,J,J,J],[J,J,J,J,J,J,J,J],[J,J,J,J,J,J,J,J]],0,new gn([{key:O.ONE,value:new _(2,2)}]),{...XI,top:vo.of([5,3]).addCaptured(O.ONE,4)}),new ja(new _(6,2),"push","diagonal",{top:1,bottom:0,left:0,right:0}),(t,e,n)=>5===n.pressurePlates.top.getCurrentPlateWidth()?w.failure($localize`You must capture and place your capture on the top pressure plate to make it crumble!`):w.SUCCESS,pe.CONGRATULATIONS()),W.fromPredicate($localize`Crumbling a second pressure plate`,$localize`Once a pressure plate has crumbled, a shorter pressure plate takes it place. It is the case here, where only 3 spots are available on the top pressure plate.<br/><br/>You're playing Dark. Perform a move that captures enough pieces to fill the top pressure plate, and make it crumble.`,new I1([[Re,Re,Re,Re,Re,Re,Re,Re],[J,J,J,J,J,J,J,J],[J,J,J,J,J,J,J,Rr],[J,J,J,J,J,Rr,J,Rr],[J,zd,J,J,q2,J,J,J],[J,J,J,J,J,J,J,J],[J,J,J,J,q2,J,J,J],[J,J,J,J,J,J,J,J]],0,new gn([{key:O.ONE,value:new _(1,4)}]),{...XI,top:vo.of([5,3]).addCaptured(O.ONE,7)}),new ja(new _(3,5),"pull","diagonal",{top:1,bottom:0,left:0,right:0}),(t,e,n)=>n.pressurePlates.top.getCurrentPlate().isPresent()?w.failure($localize`You must capture and place your capture on the top pressure plate to make it crumble a second time!`):w.SUCCESS,pe.CONGRATULATIONS()),W.informational($localize`Minimal board`,$localize`After a pressure plate has crumbled for a second time, there is no more pressure plate available on that side. In case all pressure plates have crumbled, the board is reduced to a 4x4 board.`,new I1([[Re,Re,Re,Re,Re,Re,Re,Re],[Re,Re,Re,Re,Re,Re,Re,Re],[Re,Re,Rr,q2,J,J,Re,Re],[Re,Re,zd,q2,J,J,Re,Re],[Re,Re,J,Rr,Rr,J,Re,Re],[Re,Re,Rr,J,J,J,Re,Re],[Re,Re,Re,Re,Re,Re,Re,Re],[Re,Re,Re,Re,Re,Re,Re,Re]],0,new gn([{key:O.ONE,value:new _(2,3)}]),{top:vo.of([5,3]).addCaptured(O.ZERO,8),bottom:vo.of([5,3]).addCaptured(O.ZERO,8),left:vo.of([5,3]).addCaptured(O.ZERO,8),right:vo.of([5,3]).addCaptured(O.ZERO,8)})),W.fromMove($localize`Making the lodestone fall`,$localize`If, at any point during the game, your lodestone is situated on a square that crumbles with a pressure plate, you will be allowed to select any lodestone side on your next turn.<br/><br/>In this board, playing Dark, you can place your lodestone and make a pressure plate crumble so that your lodestone falls too, allowing to choose more freely its side on your next turn. Do it!`,new I1([[J,J,J,J,J,J,J,J],[J,J,J,J,J,q2,J,J],[J,J,J,zd,J,J,Rr,J],[J,J,Rr,Rr,q2,J,J,Rr],[J,J,J,J,J,Rr,J,J],[J,J,Rr,J,J,J,J,J],[J,J,q2,J,J,J,J,J],[J,J,J,J,J,J,J,J]],0,new gn([{key:O.ONE,value:new _(3,2)}]),{...XI,top:vo.of([5,3]).addCaptured(O.ZERO,4)}),[new ja(new _(4,0),"pull","diagonal",{top:1,bottom:0,left:0,right:0})],$localize`Congratulations! At your next turn, you will be allowed to place your lodestone on any side.`,pe.FAILED_TRY_AGAIN()),W.fromMove(pe.END_OF_THE_GAME(),$localize`In order to win, you must take out all of your opponent's pieces.<br/><br/>Here, you can win in a single move, do it!`,new I1([[Re,Re,Re,Re,Re,Re,Re,Re],[Re,Re,Re,Re,Re,Re,Re,Re],[Re,q2,Rr,q2,J,J,Re,Re],[Re,q2,zd,J,q2,J,Re,Re],[Re,J,J,Rr,Rr,J,Re,Re],[Re,q2,Rr,J,q2,J,Re,Re],[Re,J,J,J,Rr,J,Re,Re],[Re,Re,Re,Re,Re,Re,Re,Re]],0,new gn([{key:O.ONE,value:new _(2,3)}]),{top:vo.of([5,3]).addCaptured(O.ZERO,8),bottom:vo.of([5,3]).addCaptured(O.ZERO,7),left:vo.of([5,3]).addCaptured(O.ZERO,5),right:vo.of([5,3]).addCaptured(O.ZERO,8)}),[new ja(new _(4,2),"pull","orthogonal",{top:0,bottom:0,left:3,right:0})],pe.CONGRATULATIONS_YOU_WON(),$localize`This is not the winning move. Try again.`)]}class DJ extends Kn{getListMoves(t,e){const n=t.gameState;return this.flatMapEmptyCoords(n,i=>{const o=[];for(const s of this.nextDirection(n)){const a=["diagonal","orthogonal"];for(const c of a){const f=fi.get().applyMoveWithoutPlacingCaptures(n,i,{direction:s,orientation:c}).captures.length;for(const g of this.captureCombinations(n,f))o.push(new ja(i,s,c,g))}}return o})}captureCombinations(t,e){if(0===e)return new st([{top:0,bottom:0,left:0,right:0}]);{const n=new st,i=t.remainingSpacesDetails(),o=this.captureCombinations(t,e-1);for(const s of o)s.top+1<=i.top&&n.add({...s,top:s.top+1}),s.bottom+1<=i.bottom&&n.add({...s,bottom:s.bottom+1}),s.left+1<=i.left&&n.add({...s,left:s.left+1}),s.right+1<=i.right&&n.add({...s,right:s.right+1});return 0===n.size()?o:n}}flatMapEmptyCoords(t,e){let n=[];for(let i=0;i<I1.SIZE;i++)for(let o=0;o<I1.SIZE;o++){const s=new _(o,i),a=t.getPieceAt(s);(a.isEmpty()&&!1===a.isUnreachable()||a.isLodestone()&&a.owner===t.getCurrentPlayer())&&(n=n.concat(e(s)))}return n}nextDirection(t){const e=t.nextLodestoneDirection();return e.isPresent()?[e.get()]:["push","pull"]}}class qLe extends rr{getMetrics(t,e){return t.gameState.getScores().toTable()}}function jLe(r,t){if(1&r&&(I(),V(0,"rect",10)),2&r){const e=p().$implicit,n=p(2);v("ngClass",e.squareClasses),A("x",0)("y",0)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}function ZLe(r,t){if(1&r&&(I(),E(0,"g",11),V(1,"polygon",12)(2,"polygon",13),P()),2&r){const e=p().$implicit;m(),v("ngClass",e.squareClasses),m(),v("ngClass",e.squareClasses)}}function YLe(r,t){if(1&r&&(I(),V(0,"circle",14)),2&r){const e=p(),n=e.index,i=e.$implicit,o=p().index,s=p();ve("id","piece_",n,"_",o,""),v("ngClass",i.pieceClasses),A("r",s.PIECE_RADIUS)("cx",s.SPACE_SIZE/2)("cy",s.SPACE_SIZE/2)}}function KLe(r,t){if(1&r&&(I(),V(0,"g",15)),2&r){const e=p(),i=e.$implicit;ve("id","lodestone_",e.index,"_",p().index,""),v("lodestoneInfo",i.lodestone),A("class",i.isCrumbled?"semi-transparent":"")}}function XLe(r,t){if(1&r){const e=he();I(),E(0,"g")(1,"g",5),q("click",function(){const o=te(e).$implicit;return ne(p(2).selectCoord(o.coord))}),z(2,jLe,1,5,"rect",6)(3,ZLe,3,2,"g",7)(4,YLe,1,6,"circle",8)(5,KLe,1,4,"g",9),P()()}if(2&r){const e=t.$implicit,n=t.index,i=p().index,o=p();m(),ve("id","square_",n,"_",i,""),A("transform",o.getSVGTranslation(o.SPACE_SIZE*n,o.SPACE_SIZE*i)),m(),v("ngIf",!1===e.isCrumbled),m(),v("ngIf",e.isCrumbled),m(),v("ngIf",e.hasPieceToDraw&&void 0===e.lodestone),m(),v("ngIf",e.lodestone)}}function QLe(r,t){if(1&r&&(I(),E(0,"g"),z(1,XLe,6,7,"g",1),P()),2&r){const e=t.$implicit;m(),v("ngForOf",e)}}function JLe(r,t){if(1&r&&(I(),E(0,"g",16),V(1,"circle",17),P()),2&r){const e=t.$implicit,n=t.index,i=p();Tn("id","capture_",n,""),A("transform",i.getCaptureTransform(n)),m(),v("ngClass",e.pieceClasses),A("r",i.PIECE_RADIUS)}}function eze(r,t){if(1&r){const e=he();I(),E(0,"g",20),q("click",function(){const o=te(e).$implicit;return ne(p(2).selectLodestone(o))}),P()}if(2&r){const e=t.$implicit,n=t.index,i=p(2);Ur("id","lodestone_",e.direction,"_",e.orientation,"_",e.owner.toString(),""),v("lodestoneInfo",e),A("transform",i.getAvailableLodestoneTransform(n))}}function tze(r,t){if(1&r&&(I(),E(0,"g",18),z(1,eze,1,5,"g",19),P()),2&r){const e=p();m(),v("ngForOf",e.viewInfo.availableLodestones)}}function nze(r,t){if(1&r&&(I(),V(0,"circle",14)),2&r){const e=p(),n=e.index,i=e.$implicit,o=p().$implicit,s=p().$implicit,a=p();Ur("id","platePiece_",s.groupPosition,"_",o.plateIndex,"_",n,""),v("ngClass",i.pieceClasses),A("r",a.PIECE_RADIUS)("cx",a.SPACE_SIZE*i.coord.x+a.SPACE_SIZE/2)("cy",a.SPACE_SIZE*i.coord.y+a.SPACE_SIZE/2)}}function rze(r,t){if(1&r){const e=he();I(),E(0,"g")(1,"g",5),q("click",function(){const i=te(e),o=i.$implicit,s=i.index,a=p().$implicit,c=p().$implicit,l=p();return ne(o.temporary?l.onTemporaryPressurePlateClick(c.groupPosition,a.plateIndex,s):l.onPressurePlateClick(c.groupPosition,a.plateIndex,s))}),V(2,"rect",14),z(3,nze,1,7,"circle",8),P()()}if(2&r){const e=t.$implicit,n=t.index,i=p().$implicit,o=p().$implicit,s=p();m(),Ur("id","plate_",o.groupPosition,"_",i.plateIndex,"_",n,""),m(),Ur("id","plateSquare_",o.groupPosition,"_",i.plateIndex,"_",n,""),v("ngClass",e.squareClasses),A("x",s.SPACE_SIZE*e.coord.x)("y",s.SPACE_SIZE*e.coord.y)("width",s.SPACE_SIZE)("height",s.SPACE_SIZE)("rx",.2*s.SPACE_SIZE)("ry",.2*s.SPACE_SIZE),m(),v("ngIf",e.hasPiece)}}function ize(r,t){if(1&r&&(I(),E(0,"g",16),z(1,rze,4,14,"g",1),P()),2&r){const e=t.$implicit;ve("id","pressurePlate_",p().$implicit.groupPosition,"_",e.plateIndex,""),m(),v("ngForOf",e.coords)}}function oze(r,t){if(1&r&&(I(),E(0,"g",16),z(1,ize,2,3,"g",2),P()),2&r){const e=t.$implicit;Tn("id","pressurePlateGroup_",e.groupPosition,""),m(),v("ngForOf",e.plateInfos)}}function sze(r,t){if(1&r&&(I(),V(0,"rect",21)),2&r){const e=p();ve("id","selection_",e.viewInfo.selected.get().x,"_",e.viewInfo.selected.get().y,""),A("x",e.SPACE_SIZE*e.viewInfo.selected.get().x)("y",e.SPACE_SIZE*e.viewInfo.selected.get().y)("width",e.SPACE_SIZE)("height",e.SPACE_SIZE)}}class aa extends Fc{static PRESSURE_PLATE_EXTRA_SHIFT=.2;static PRESSURE_PLATES_POSITIONS=gn.from({top:{start:(t,e)=>new _((8-e)/2,-(t+1)*(1+aa.PRESSURE_PLATE_EXTRA_SHIFT)),direction:me.RIGHT},bottom:{start:(t,e)=>new _((8-e)/2,8+aa.PRESSURE_PLATE_EXTRA_SHIFT+t*(1+aa.PRESSURE_PLATE_EXTRA_SHIFT)),direction:me.RIGHT},left:{start:(t,e)=>new _(-(1+aa.PRESSURE_PLATE_EXTRA_SHIFT)*(1+t),(8-e)/2),direction:me.DOWN},right:{start:(t,e)=>new _(8+aa.PRESSURE_PLATE_EXTRA_SHIFT+t*(1+aa.PRESSURE_PLATE_EXTRA_SHIFT),(8-e)/2),direction:me.DOWN}});PIECE_RADIUS;viewInfo={availableLodestones:[],capturesToPlace:[],boardInfo:[],currentPlayerClass:"",opponentClass:"",pressurePlateGroupInfos:[],selected:h.empty()};viewBox;platesGroupSize;boardSize;displayedState;stateAfterPlacingLodestone=h.empty();lastInfos=h.empty();capturesToPlace=0;selectedCoord=h.empty();selectedLodestone=h.empty();captures={top:0,bottom:0,left:0,right:0};constructor(t){super(t),this.setRulesAndNode("Lodestone"),this.availableAIs=[new fn($localize`Score`,this.rules,new qLe,new DJ),new zn($localize`MCTS`,new DJ,this.rules)],this.encoder=ja.encoder,this.PIECE_RADIUS=.5*(this.SPACE_SIZE-2*this.STROKE_WIDTH),this.displayedState=this.getState(),this.scores=h.of(we.of(0,0))}getViewBox(){const n=this.boardSize+2*this.platesGroupSize;return new Ks(-this.platesGroupSize,-(this.platesGroupSize+this.SPACE_SIZE+this.STROKE_WIDTH),n,n+2*(this.SPACE_SIZE+this.STROKE_WIDTH))}selectCoord(t){var e=this;return M(function*(){const n=yield e.canUserPlay("#square_"+t.x+"_"+t.y);if(n.isFailure())return e.cancelMove(n.getReason());if(e.capturesToPlace>0)return e.cancelMove(yu.MUST_PLACE_CAPTURES());const i=fi.get().isTargetLegal(e.getState(),t);return i.isFailure()?e.cancelMove(i.getReason()):(e.hideLastMove(),e.selectedCoord.equalsValue(t)?e.cancelMove():(e.selectedCoord=h.of(t),e.selectedLodestone.isPresent()?e.putLodestone():(e.updateViewInfo(),w.SUCCESS)))})()}selectLodestone(t){var e=this;return M(function*(){const n=e.getCurrentPlayer().toString(),i="#lodestone_"+t.direction+"_"+t.orientation+"_"+n,o=yield e.canUserPlay(i);if(o.isFailure())return e.cancelMove(o.getReason());e.hideLastMove(),L.assert(0===e.capturesToPlace,"should not be able to click on a lodestone when captures need to be placed");const s=e.getCurrentPlayer(),a=Er.of(s,t);return e.selectedLodestone.equalsValue(a)?e.cancelMove():(e.selectedLodestone=h.of(a),e.selectedCoord.isPresent()?e.putLodestone():(e.updateViewInfo(),w.SUCCESS))})()}hideLastMove(){this.lastInfos=h.of({board:this.getState().getCopiedBoard(),captures:[],moved:[]}),this.updateViewInfo()}putLodestone(){var t=this;return M(function*(){L.assert(t.selectedCoord.isPresent(),"coord should have been selected"),L.assert(t.selectedLodestone.isPresent(),"lodestone should have been selected");const e=t.selectedCoord.get(),n=t.selectedLodestone.get(),i=t.getState(),o=fi.get().isLegalWithoutCaptures(i,e,n.direction);L.assert(o.isSuccess(),"Lodestone component should only allow creation of legal moves");const s=fi.get().applyMoveWithoutPlacingCaptures(i,e,n);return t.lastInfos=h.of(s),t.capturesToPlace=Math.min(s.captures.length,i.remainingSpaces()),0===t.capturesToPlace?t.applyMove():(t.displayedState=t.displayedState.withBoard(s.board),t.stateAfterPlacingLodestone=h.of(t.displayedState),t.updateViewInfo(),w.SUCCESS)})()}applyMove(){var t=this;return M(function*(){L.assert(t.selectedCoord.isPresent(),"coord should have been selected"),L.assert(t.selectedLodestone.isPresent(),"lodestone should have been selected");const e=t.selectedCoord.get(),n=t.selectedLodestone.get(),i=new ja(e,n.direction,n.orientation,t.captures);return t.chooseMove(i)})()}onPressurePlateClick(t,e,n){var i=this;return M(function*(){const o="#plate_"+t+"_"+e+"_"+n,s=yield i.canUserPlay(o);return s.isFailure()?i.cancelMove(s.getReason()):i.selectPressurePlate(t)})()}onTemporaryPressurePlateClick(t,e,n){var i=this;return M(function*(){const o="#plate_"+t+"_"+e+"_"+n,s=yield i.canUserPlay(o);return s.isFailure()?i.cancelMove(s.getReason()):i.deselectPressurePlate(t)})()}selectPressurePlate(t){var e=this;return M(function*(){if(0===e.capturesToPlace)return e.cancelMove(yu.NO_CAPTURES_TO_PLACE_YET());e.capturesToPlace--,e.captures[t]++;const n=e.stateAfterPlacingLodestone.get(),i=e.getCurrentOpponent(),o=rt.copy(n.board),s={...n.pressurePlates},a=n.lodestones.getCopy();return fi.get().updatePressurePlates(o,s,a,i,e.captures),e.displayedState=new I1(o,n.turn,a,s),0===e.capturesToPlace?e.applyMove():(e.updateViewInfo(),e.showPressurePlateDifferences(e.getState(),e.displayedState,!0),w.SUCCESS)})()}deselectPressurePlate(t){var e=this;return M(function*(){e.capturesToPlace++,e.captures[t]--;const n=e.stateAfterPlacingLodestone.get(),i=e.getCurrentOpponent(),o=rt.copy(n.board),s={...n.pressurePlates},a=n.lodestones.getCopy();return fi.get().updatePressurePlates(o,s,a,i,e.captures),e.displayedState=new I1(o,n.turn,a,s),e.updateViewInfo(),e.showPressurePlateDifferences(e.getState(),e.displayedState,!0),w.SUCCESS})()}updateBoard(t){var e=this;return M(function*(){e.cancelMoveAttempt(),e.scores=h.of(e.getState().getScores()),e.boardSize=e.getState().board.length*e.SPACE_SIZE;const n=e.getState().pressurePlates.top.plates.length;e.platesGroupSize=n*(1.2*e.SPACE_SIZE)})()}cancelMoveAttempt(){this.displayedState=this.getState(),this.stateAfterPlacingLodestone=h.empty(),this.lastInfos=h.empty();const t=this.displayedState.lodestones.get(this.getCurrentPlayer());if(t.isPresent()){const e=rt.copy(this.displayedState.board);e[t.get().y][t.get().x]=Co.EMPTY,this.displayedState=this.displayedState.withBoard(e)}this.selectedCoord=h.empty(),this.selectedLodestone=h.empty(),this.capturesToPlace=0,this.captures={top:0,bottom:0,left:0,right:0},this.updateViewInfo()}updateViewInfo(){const e=this.getState().getCurrentPlayer();this.viewInfo.currentPlayerClass=this.getPlayerClass(e),this.viewInfo.opponentClass=this.getPlayerClass(e.getOpponent()),this.showBoard(),this.showAvailableLodestones(),this.showCapturesToPlace(),this.showPressurePlates(),this.lastInfos.isPresent()&&this.showMovedAndCaptured(this.lastInfos.get())}showBoard(){this.viewInfo.boardInfo=[];for(let t=0;t<I1.SIZE;t++){this.viewInfo.boardInfo.push([]);for(let e=0;e<I1.SIZE;e++){const n=new _(e,t);this.viewInfo.boardInfo[t].push(this.getSquareInfo(n))}}this.viewInfo.selected=this.selectedCoord.isPresent()&&!1===this.isCrumbled(this.selectedCoord.get())?this.selectedCoord:h.empty()}getSquareInfo(t){const e=this.displayedState.getPieceAt(t),n=this.getLodestoneInfo(t),i={coord:t,squareClasses:[],isCrumbled:this.isCrumbled(t),hasPieceToDraw:void 0!==n,pieceClasses:[],lodestone:n};if(e.isPlayerPiece())i.hasPieceToDraw=!0,i.pieceClasses=[this.getPlayerClass(e.owner)];else if(i.isCrumbled)return this.getCrumbledSquareInfo(t,i);return i}getCrumbledSquareInfo(t,e){const n=this.getPreCaptureInfo();if(n.isAbsent())return e;const i=this.getPieceThatCrumbledLastEndOfTurn(t,n.get().preCaptureState,n.get().preCaptureMove);if(i.isPresent()){const o=i.get().owner;e.hasPieceToDraw=!0,e.pieceClasses=[this.getPlayerClass(o),"semi-transparent"]}return e}getPreCaptureInfo(){return this.selectedCoord.isPresent()&&this.selectedLodestone.isPresent()?h.of({preCaptureMove:new ja(this.selectedCoord.get(),this.selectedLodestone.get().direction,this.selectedLodestone.get().orientation),preCaptureState:this.getState()}):this.node.previousMove.isPresent()?h.of({preCaptureMove:this.node.previousMove.get(),preCaptureState:this.getPreviousState()}):h.empty()}getLodestoneInfo(t){if(this.displayedState.getPieceAt(t).isLodestone())return this.getLodestoneInfoAt(this.displayedState,t);if(this.isCrumbled(t)&&this.getPreCaptureInfo().isPresent()){if(this.selectedCoord.equalsValue(t)){const i=this.selectedLodestone.get();return this.getLodestoneInfoFromLodestone(i)}if(this.wasLastMoveLodestone(t))return this.getDroppedThenCrumbedLodestoneInfo(this.node.previousMove.get());if(this.isCrumbledLodestone(t))return this.getCrumbledLodestoneInfo(t)}}getDroppedThenCrumbedLodestoneInfo(t){const e={direction:t.direction,orientation:t.orientation},n=Er.of(this.getCurrentOpponent(),e);return this.getLodestoneInfoFromLodestone(n)}getCrumbledLodestoneInfo(t){const e=this.getPreviousState().getPieceAt(t);return L.assert(e.isLodestone(),"getCrumbledLodestoneInfo should only be called with coord that contain crumbled lodestone!"),this.getLodestoneInfoFromLodestone(e)}getLodestoneInfoFromLodestone(t){const e={direction:t.direction,movingClass:"",orientation:t.orientation,owner:t.owner,selectedClass:""};return e.movingClass=this.getPlayerClass("push"===t.direction?t.owner.getOpponent():t.owner),e}wasLastMoveLodestone(t){return!!this.node.parent.isPresent()&&this.node.previousMove.get().coord.equals(t)}isCrumbledLodestone(t){if(this.node.parent.isPresent()){if(this.selectedLodestone.isPresent())return!1;{const e=this.node.parent.get().gameState,n=e.getPieceAt(t);return n.isLodestone()&&n.owner===e.getCurrentOpponent()}}return!1}getLodestoneInfoAt(t,e){const n=t.getPieceAt(e);return L.assert(n.isLodestone(),"piece should be lodestone"),this.getLodestoneInfoFromLodestone(n)}getPieceThatCrumbledLastEndOfTurn(t,e,n){const s=this.rules.applyMoveWithoutPlacingCaptures(e,n.coord,{direction:n.direction,orientation:n.orientation}).board[t.y][t.x],a=!1===s.isEmpty(),c=!1===s.isUnreachable();return a&&c?h.of(s):h.empty()}isCrumbled(t){return this.displayedState.getPieceAt(t).isUnreachable()}showAvailableLodestones(){if(this.capturesToPlace>0)this.viewInfo.availableLodestones=[];else{const t=this.getState().getCurrentPlayer(),e=this.getState().nextLodestoneDirection();if(e.isPresent()){const n=e.get();this.viewInfo.availableLodestones=[this.nextLodestone(t,{direction:n,orientation:"orthogonal"}),this.nextLodestone(t,{direction:n,orientation:"diagonal"})]}else this.viewInfo.availableLodestones=[this.nextLodestone(t,{direction:"push",orientation:"orthogonal"}),this.nextLodestone(t,{direction:"push",orientation:"diagonal"}),this.nextLodestone(t,{direction:"pull",orientation:"orthogonal"}),this.nextLodestone(t,{direction:"pull",orientation:"diagonal"})]}}showCapturesToPlace(){const t=this.getCurrentOpponent();this.viewInfo.capturesToPlace=[];for(let e=0;e<this.capturesToPlace;e++)this.viewInfo.capturesToPlace.push({pieceClasses:[this.getPlayerClass(t)]})}nextLodestone(t,e){const n=Er.of(t,e),i=this.getLodestoneInfoFromLodestone(n);return this.selectedLodestone.equalsValue(n)&&(i.selectedClass="selected-stroke"),i}showPressurePlates(){this.viewInfo.pressurePlateGroupInfos=[];for(const t of a4.POSITIONS){const e=this.getPressurePlateGroupInfo(t);this.viewInfo.pressurePlateGroupInfos.push(e)}}getPressurePlateGroupInfo(t){const e={groupPosition:t,plateInfos:[]},n=this.displayedState.pressurePlates[t];let i=0;for(const o of n.plates){const s=this.getPressurePlateInfo(o,t,i);e.plateInfos.push(s),i++}return e}getPressurePlateInfo(t,e,n){const i={plateIndex:n,coords:[]},o=t.width;for(let s=0;s<o;s++){const a=this.getPressurePlateCoordInfo(t,e,n,s);i.coords.push(a)}return i}getPressurePlateCoordInfo(t,e,n,i){const o=t.getPieceAt(i);let s="";o.isPlayerPiece()&&(s=this.getPlayerClass(o.owner));const a=aa.PRESSURE_PLATES_POSITIONS.get(e).get();return{coord:a.start(n,t.width).getNext(a.direction,i),hasPiece:o.isPlayerPiece(),pieceClasses:[s],squareClasses:[],temporary:!1}}showLastMove(t){var e=this;return M(function*(){const n=e.getPreviousState();e.lastInfos=h.of(fi.get().applyMoveWithoutPlacingCaptures(n,t.coord,t)),e.updateViewInfo();const i=e.getState();e.showPressurePlateDifferences(n,i,!1)})()}showPressurePlateDifferences(t,e,n){for(const i of a4.POSITIONS){const o=t.pressurePlates[i].plates.length;for(let s=0;s<o;s++)this.showPressurePlateDifference(t.pressurePlates[i].plates[s],e.pressurePlates[i].plates[s],i,s,n)}}showPressurePlateDifference(t,e,n,i,o){const c=this.viewInfo.pressurePlateGroupInfos.filter(l=>l.groupPosition===n)[0].plateInfos[i];for(let l=0;l<t.width;l++){const u=t.getPieceAt(l),f=e.getPieceAt(l);!1===u.equals(f)&&(c.coords[l].squareClasses.push("moved-fill"),c.coords[l].temporary=o,o&&c.coords[l].pieceClasses.push("semi-transparent"))}}showMovedAndCaptured(t){for(const e of t.moved)this.viewInfo.boardInfo[e.y][e.x].squareClasses.push("moved-fill");for(const e of t.captures)this.viewInfo.boardInfo[e.y][e.x].squareClasses.push("captured-fill")}getCaptureTransform(t){return`translate(${(t+(I1.SIZE/2-this.viewInfo.capturesToPlace.length/2))*this.SPACE_SIZE+this.SPACE_SIZE/2}, ${-(this.platesGroupSize+.5*this.SPACE_SIZE+this.STROKE_WIDTH)})`}getAvailableLodestoneTransform(t){return`translate(${(t+(I1.SIZE/2-this.viewInfo.availableLodestones.length/2))*this.SPACE_SIZE}, ${this.boardSize+this.platesGroupSize+this.STROKE_WIDTH})`}static \u0275fac=function(e){return new(e||aa)(G(Ut))};static \u0275cmp=Ue({type:aa,selectors:[["app-lodestone"]],features:[$e],decls:6,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id",4,"ngFor","ngForOf"],["id","availableLodestones",4,"ngIf"],["class","base no-fill selected-stroke",3,"id",4,"ngIf"],[3,"id","click"],["class","base lodestone_square",3,"ngClass",4,"ngIf"],["class","lodestone_crumbled_square",4,"ngIf"],["class","base",3,"id","ngClass",4,"ngIf"],["app-lodestone-lodestone","",3,"id","lodestoneInfo",4,"ngIf"],[1,"base","lodestone_square",3,"ngClass"],[1,"lodestone_crumbled_square"],["points","0,0     42,0    17,25    67,75    42,100   0,100   0,0",1,"base",3,"ngClass"],["points","100,0   58,0    35,25    85,75    58,100 100,100 100,0",1,"base",3,"ngClass"],[1,"base",3,"id","ngClass"],["app-lodestone-lodestone","",3,"id","lodestoneInfo"],[3,"id"],["cx","0","cy","0",1,"base",3,"ngClass"],["id","availableLodestones"],["app-lodestone-lodestone","",3,"id","lodestoneInfo","click",4,"ngFor","ngForOf"],["app-lodestone-lodestone","",3,"id","lodestoneInfo","click"],[1,"base","no-fill","selected-stroke",3,"id"]],template:function(e,n){1&e&&(I(),E(0,"svg",0),z(1,QLe,2,1,"g",1)(2,JLe,2,4,"g",2)(3,tze,2,1,"g",3)(4,oze,2,2,"g",2)(5,sze,1,6,"rect",4),P()),2&e&&(A("viewBox",n.getViewBox().toSVGString()),m(),v("ngForOf",n.viewInfo.boardInfo),m(),v("ngForOf",n.viewInfo.capturesToPlace),m(),v("ngIf",n.isInteractive),m(),v("ngForOf",n.viewInfo.pressurePlateGroupInfos),m(),v("ngIf",n.viewInfo.selected.isPresent()))},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}class At{value;static EMPTY=new At(0);static PAWN=new At(1);static DRONE=new At(2);static QUEEN=new At(3);static tryMerge(t,e){pn(t!==At.EMPTY&&e!==At.EMPTY,"tryMerge cannot be called with empty pieces");const i=t.value+e.value;return 2===i||3===i?h.of(At.of(i)):h.empty()}static of(t){return t===At.DRONE.value?At.DRONE:(L.expectToBe(t,At.QUEEN.value),At.QUEEN)}constructor(t){this.value=t}getValue(){return this.value}equals(t){return this.getValue()===t.getValue()}}class g0{captures;static of(t){const e=new gn;for(const n of t)g0.addToMap(e,n);return new g0(e)}static addToMap(t,e){const n=t.get(e);n.isPresent()?t.replace(e,n.get()+1):t.set(e,1)}constructor(t){this.captures=t,t.makeImmutable()}toValue(){let t=0;return this.captures.forEach(e=>{t+=e.key.getValue()*e.value}),t}add(t){const e=this.captures.getCopy();return g0.addToMap(e,t),new g0(e)}}class j1 extends B1{lastMove;countDown;static WIDTH=4;static HEIGHT=8;static PLAYER_ZERO_TERRITORY=new st([4,5,6,7]);static PLAYER_ONE_TERRITORY=new st([0,1,2,3]);static isOnBoard(t){return t.isInRange(j1.WIDTH,j1.HEIGHT)}captured;constructor(t,e,n=h.empty(),i=h.empty(),o){super(t,e),this.lastMove=n,this.countDown=i,null==o&&(o=new gn([{key:O.ZERO,value:g0.of([])},{key:O.ONE,value:g0.of([])}])),o.makeImmutable(),this.captured=o}getPlayerTerritory(t){return t===O.ZERO?j1.PLAYER_ZERO_TERRITORY:j1.PLAYER_ONE_TERRITORY}isTherePieceOnPlayerSide(t){const e=this.getCurrentPlayer(),n=this.getPlayerTerritory(e);for(const i of n)for(let o=0;o<j1.WIDTH;o++)if(this.getPieceAtXY(o,i)===t)return!0;return!1}getScoreOf(t){return this.captured.get(t).get().toValue()}getEmptyTerritory(){return this.isTerritoryEmpty(O.ZERO)?h.of(O.ZERO):this.isTerritoryEmpty(O.ONE)?h.of(O.ONE):h.empty()}isTerritoryEmpty(t){const e=this.getPlayerTerritory(t);for(const n of e)for(let i=0;i<j1.WIDTH;i++)if(this.getPieceAtXY(i,n)!==At.EMPTY)return!1;return!0}isInOpponentTerritory(t){const e=this.getCurrentOpponent();return this.getPlayerTerritory(e).contains(t.y)}isInPlayerTerritory(t){const e=this.getCurrentPlayer();return this.getPlayerTerritory(e).contains(t.y)}getCapturesOf(t){const e=this.captured.get(t).get();return[e.captures.get(At.PAWN).getOrElse(0),e.captures.get(At.DRONE).getOrElse(0),e.captures.get(At.QUEEN).getOrElse(0)]}}let tv=(()=>class r{static START_COORD_OUT_OF_RANGE=()=>$localize`Start coord cannot be out of range`;static END_COORD_OUT_OF_RANGE=()=>$localize`End coord cannot be out of range`;static PAWN_MUST_MOVE_ONE_DIAGONAL_STEP=()=>$localize`Pawns must move one step diagonally.`;static DRONE_MUST_DO_TWO_ORTHOGONAL_STEPS=()=>$localize`Drones must move one or two steps in any direction.`})();class ei extends Do{calledTheClock;static encoder=ke.tuple([_.encoder,_.encoder,ke.identity()],t=>[t.getStart(),t.getEnd(),t.calledTheClock],t=>ei.from(t[0],t[1],t[2]).get());static from(t,e,n=!1){if(!1===j1.isOnBoard(t))return X.failure(tv.START_COORD_OUT_OF_RANGE());if(!1===j1.isOnBoard(e))return X.failure(tv.END_COORD_OUT_OF_RANGE());if(e.equals(t))return X.failure(Ee.MOVE_CANNOT_BE_STATIC());const i=me.factory.fromDelta(e.x-t.x,e.y-t.y);return i.isFailure()?X.failure(i.getReason()):X.success(new ei(t,e,n))}constructor(t,e,n){super(t,e),this.calledTheClock=n}toString(){const t=this.calledTheClock?", CALL_THE_CLOCK":"";return"MartianChessMove(("+this.getStart().x+", "+this.getStart().y+") -> ("+this.getEnd().x+", "+this.getEnd().y+")"+t+")"}equals(t){return!1!==super.equals(t)&&this.calledTheClock===t.calledTheClock}isValidForPawn(){return this.getStart().getVectorToward(this.getEnd()).isDiagonalOfLength(1)}isValidForDrone(){return this.getStart().getDistance(this.getEnd())<=2}isUndoneBy(t){if(t.isAbsent())return!1;const e=t.get();return e.getEnd().equals(this.getStart())&&e.getStart().equals(this.getEnd())}}let nv=(()=>class r{static MUST_CHOOSE_PIECE_FROM_YOUR_TERRITORY=()=>$localize`You must pick a piece from your side of the board in order to move it.`;static CANNOT_CAPTURE_YOUR_OWN_PIECE_NOR_PROMOTE_IT=()=>$localize`This is not a valid promotion nor a valid capture.`;static CANNOT_UNDO_LAST_MOVE=()=>$localize`You cannot perform a move that is the reverse of the previous one.`})();class Ss extends Ar{static STARTING_COUNT_DOWN=h.of(7);static singleton=h.empty();static get(){return Ss.singleton.isAbsent()&&(Ss.singleton=h.of(new Ss)),Ss.singleton.get()}getInitialState(){const t=At.EMPTY,e=At.PAWN,n=At.DRONE,i=At.QUEEN;return new j1([[i,i,n,t],[i,n,e,t],[n,e,e,t],[t,t,t,t],[t,t,t,t],[t,e,e,n],[t,e,n,i],[t,n,i,i]],0,h.empty())}applyLegalMove(t,e,n,i){const o=e.getCopiedBoard();o[t.getStart().y][t.getStart().x]=At.EMPTY;const s=i.finalPiece;o[t.getEnd().y][t.getEnd().x]=s;const a=i.score;let c=e.countDown;if(c.isPresent())if(this.isCapture(t,e))c=Ss.STARTING_COUNT_DOWN;else{const u=e.countDown.get();c=h.of(u-1)}return t.calledTheClock&&(c=Ss.STARTING_COUNT_DOWN),new j1(o,e.turn+1,h.of(t),c,a)}isLegal(t,e){this.assertNonDoubleClockCall(t,e);const n=this.isLegalMove(t,e);if(n.isFailure())return n.toOtherFallible();if(t.isUndoneBy(e.lastMove))return X.failure(nv.CANNOT_UNDO_LAST_MOVE());if(this.isFieldPromotion(t,e))return this.isLegalFieldPromotion(t,e);const i=e.getPieceAt(t.getStart()),o=e.captured.getCopy();if(this.isCapture(t,e)){const a=e.getCurrentPlayer();let c=o.get(a).get();const l=e.getPieceAt(t.getEnd());c=c.add(l),o.replace(a,c),o.makeImmutable()}return X.success({finalPiece:i,score:o})}assertNonDoubleClockCall(t,e){const n=e.countDown.isPresent();L.assert(!1===(n&&t.calledTheClock),"Should not call the clock twice")}isCapture(t,e){const n=e.isInOpponentTerritory(t.getEnd()),i=e.getPieceAt(t.getEnd())!==At.EMPTY;return n&&i}isFieldPromotion(t,e){const n=e.isInPlayerTerritory(t.getEnd()),i=e.getPieceAt(t.getEnd())!==At.EMPTY;return n&&i}isLegalFieldPromotion(t,e){const n=this.getPromotedPiece(t,e);if(n.isAbsent())return X.failure(nv.CANNOT_CAPTURE_YOUR_OWN_PIECE_NOR_PROMOTE_IT());const i=n.get();if(e.isTherePieceOnPlayerSide(i))return X.failure(nv.CANNOT_CAPTURE_YOUR_OWN_PIECE_NOR_PROMOTE_IT());{const o={finalPiece:i,score:e.captured.getCopy()};return X.success(o)}}isLegalMove(t,e){if(!1===e.isInPlayerTerritory(t.getStart()))return w.failure(nv.MUST_CHOOSE_PIECE_FROM_YOUR_TERRITORY());const i=e.getPieceAt(t.getStart());if(i===At.EMPTY)return w.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(i===At.PAWN)return t.isValidForPawn()?w.SUCCESS:w.failure(tv.PAWN_MUST_MOVE_ONE_DIAGONAL_STEP());if(i===At.DRONE&&!1===t.isValidForDrone())return w.failure(tv.DRONE_MUST_DO_TWO_ORTHOGONAL_STEPS());for(const o of t.getStart().getCoordsToward(t.getEnd()))if(e.getPieceAt(o)!==At.EMPTY)return w.failure(Ee.SOMETHING_IN_THE_WAY());return w.SUCCESS}getPromotedPiece(t,e){const n=e.getPieceAt(t.getStart()),i=e.getPieceAt(t.getEnd());return At.tryMerge(n,i)}getGameStatus(t){const e=t.gameState;if(e.countDown.equalsValue(0))return this.getGameStatusScoreVictoryOr(e,ye.DRAW);if(e.getEmptyTerritory().isPresent()){const i=e.getCurrentOpponent(),o=ye.getVictory(i);return this.getGameStatusScoreVictoryOr(e,o)}return ye.ONGOING}getGameStatusScoreVictoryOr(t,e){const n=t.getScoreOf(O.ZERO),i=t.getScoreOf(O.ONE);return n>i?ye.ZERO_WON:i>n?ye.ONE_WON:e}}const K=At.EMPTY,j2=At.PAWN,c4=At.DRONE,l4=At.QUEEN;class aze extends Wn{tutorial=[W.informational($localize`Goal of the game`,$localize`At Martian Chess, the goal is to have the most points at the end of the game. Each piece is assigned a value, you win this value when capturing the piece. The board is divided in two by a line called the canal. There is one side for each player. You do not own pieces, but you control the ones on your side of the canal. Pieces are colored to help you: they will change color when crossing the canal.`,Ss.get().getInitialState()),W.informational($localize`The pieces`,$localize`The pieces are dark on the side of the first player, the light ones on the side of the second one. There are 3 kind of pieces: <ul><li>The Queens: represented as circles with 3 dots.</li><li>The Drones: represented as circles with 2 dots.</li><li>The Pawns: represented as circles with one dot.</li></ul>`,Ss.get().getInitialState()),W.fromPredicate($localize`Moving pawns`,$localize`Pawns are worth one point. They can move one step diagonally.<br/><br/>You're playing Dark, move a pawn.`,Ss.get().getInitialState(),ei.from(new _(2,5),new _(1,4)).get(),(t,e,n)=>n.getPieceAt(t.getEnd())===At.PAWN?w.SUCCESS:w.failure($localize`This is not a pawn!`),pe.CONGRATULATIONS()),W.fromPredicate($localize`Moving drones`,$localize`Drones are worth two points. They can move one or two steps in any direction, in a straight line, without jumping over other pieces.<br/><br/>You're playing Dark, move a drone.`,Ss.get().getInitialState(),ei.from(new _(1,7),new _(0,7)).get(),(t,e,n)=>n.getPieceAt(t.getEnd())===At.DRONE?w.SUCCESS:w.failure($localize`This is not a drone!`),pe.CONGRATULATIONS()),W.fromPredicate($localize`Moving queens`,$localize`Queens are worth three points. They can move any number of steps in any direction, in a straight line, without jumping over other pieces.<br/><br/>You're playing Light, move a queen.`,new j1([[c4,j2,K,K],[l4,K,K,K],[K,K,K,K],[K,K,l4,K],[K,K,K,K],[K,K,K,K],[K,K,K,K],[l4,c4,j2,K]],1),ei.from(new _(2,3),new _(2,7)).get(),(t,e,n)=>n.getPieceAt(t.getEnd())===At.QUEEN?w.SUCCESS:w.failure($localize`This is not a queen!`),pe.CONGRATULATIONS()),W.fromMove($localize`Captures`,$localize`When a piece crosses the canal and lands on another piece, you capture it and gain the value of that captured piece. However, you lose control of your piece as it crosses the canal!<br/><br/>A capture is possible for Light, do it.`,new j1([[c4,j2,j2,K],[K,K,K,K],[l4,K,K,K],[K,K,K,K],[K,K,j2,K],[K,K,K,K],[K,K,K,K],[K,c4,j2,K]],1),[ei.from(new _(0,2),new _(2,4)).get()],$localize`Congratulations! By capturing that pawn, you won one point.`,pe.YOU_DID_NOT_CAPTURE_ANY_PIECE()),W.fromMove($localize`Field Promotion (1/2)`,$localize`It is sometimes possible to perform what is called a field promotion. If you are out of one type of piece, you can merge two pieces to add their value and get a new piece. For example, if you have no drones, you can merge two pawns into a drone. To merge two pawns, move one of your pawns on another.<br/><br/>Such a move is possible for Light. Do it.`,new j1([[K,K,K,l4],[K,j2,K,K],[K,K,j2,K],[K,K,K,K],[K,K,K,K],[K,K,K,l4],[K,K,c4,K],[K,j2,K,K]],1),[ei.from(new _(1,1),new _(2,2)).get(),ei.from(new _(2,2),new _(1,1)).get()],pe.CONGRATULATIONS(),$localize`This is not a field promotion!`),W.fromPredicate($localize`Field Promotion (2/2)`,$localize`The other kind of field promotion is to merge a drone and a pawn to obtain a queen.<br/><br/>Such a move is possible for Light. Do it.`,new j1([[j2,K,K,K],[K,K,K,K],[K,K,K,K],[K,K,K,K],[K,K,K,K],[K,K,K,K],[K,K,c4,K],[K,j2,K,K]],0),ei.from(new _(1,7),new _(2,6)).get(),(t,e,n)=>n.getPieceAt(t.getEnd())===At.QUEEN?w.SUCCESS:w.failure($localize`This is not a field promotion!`),pe.CONGRATULATIONS()),W.fromPredicate($localize`Call the clock`,$localize`When the game seems to be going nowhere, you can "call the clock" during your turn. To do so, click on the clock symbol on the right, then perform your move. Once the clock is called, seven more turn will be played.<br/><br/>You're playing Dark. Call the clock and perform a move.`,Ss.get().getInitialState(),ei.from(new _(1,5),new _(0,4),!0).get(),(t,e,n)=>t.calledTheClock?w.SUCCESS:w.failure($localize`You did not call the clock!`),pe.CONGRATULATIONS()),W.fromMove($localize`Restarting the clock`,$localize`If the clock has been called, whenever a capture is done the countdown restarts.<br/><br/>You're playing Dark, do a capture to restart the countdown.`,new j1([[K,K,K,K],[K,j2,K,K],[K,K,K,K],[K,K,K,K],[K,K,K,K],[K,K,K,j2],[K,K,c4,K],[K,l4,K,K]],16,h.empty(),h.of(1)),[ei.from(new _(1,7),new _(1,1)).get()],pe.CONGRATULATIONS(),$localize`This is not a capture, the game is now over, please retry!`),W.anyMove($localize`End game (by clock)`,$localize`When seven turns have passed after the clock has been called, the player with the most points win. If both player have the same number of points, it is a tie.<br/><br/>You're playing Light, do the last move.`,new j1([[K,K,K,l4],[K,j2,K,K],[K,K,K,K],[K,K,K,K],[K,K,K,K],[c4,K,K,K],[K,K,K,K],[K,c4,K,K]],15,h.empty(),h.of(1)),ei.from(new _(1,1),new _(2,2)).get(),pe.CONGRATULATIONS()),W.fromPredicate($localize`End by emptyness`,$localize`When a player's last piece is moved into the opponent territory, the game ends. If both players have the same number of points, the last player win!<br/><br/>Light player can win this way, do it!`,new j1([[K,K,K,l4],[K,j2,K,K],[K,K,K,K],[K,K,K,K],[K,K,j2,K],[K,K,K,K],[K,K,K,K],[K,K,K,K]],0),ei.from(new _(2,4),new _(1,3)).get(),(t,e,n)=>3===t.getEnd().y?w.SUCCESS:w.failure($localize`Your piece is still in you territory!`),pe.CONGRATULATIONS())]}class VJ extends Kn{getListMoves(t,e){const n=t.gameState,i=n.getCurrentPlayer(),o=n.getPlayerTerritory(i);let s=[];for(const a of o)for(let c=0;c<j1.WIDTH;c++)switch(n.getPieceAtXY(c,a)){case At.PAWN:s=s.concat(this.getMovesForPawnAt(n,c,a));break;case At.DRONE:s=s.concat(this.getMovesForDroneAt(n,c,a));break;case At.QUEEN:s=s.concat(this.getMovesForQueenAt(n,c,a))}return s}getMovesForPawnAt(t,e,n){const i=new _(e,n),o=[];for(const s of me.DIAGONALS){const a=i.getNext(s);j1.isOnBoard(a)&&o.push(a)}return this.addLegalMoves(t,i,o)}addLegalMoves(t,e,n){const i=[],o=t.getPieceAt(e),s=!1===t.isTherePieceOnPlayerSide(At.DRONE),a=!1===t.isTherePieceOnPlayerSide(At.QUEEN),c=t.lastMove;for(const l of n){const u=t.getPieceAt(l);if(u===At.EMPTY)this.add(i,ei.from(e,l).get(),c);else if(t.isInPlayerTerritory(l)){const f=At.tryMerge(u,o);if(f.isPresent()){const g=f.get(),y=ei.from(e,l).get();(g===At.DRONE&&s||g===At.QUEEN&&a)&&this.add(i,y,c)}}else this.add(i,ei.from(e,l).get(),c)}return i}add(t,e,n){!1===e.isUndoneBy(n)&&t.push(e)}getMovesForDroneAt(t,e,n){const i=new _(e,n),o=this.getLandingCoordsForLinearMove(i,t,2);return this.addLegalMoves(t,i,o)}getLandingCoordsForLinearMove(t,e,n){const i=[];for(const o of me.DIRECTIONS){let s=1,a=t.getNext(o,s),c=e.tryToGetPieceAt(a),l=c.equalsValue(At.EMPTY);for(;l;)i.push(a),s++,a=t.getNext(o,s),c=e.tryToGetPieceAt(a),l=c.equalsValue(At.EMPTY)&&s<n;c.isPresent()&&i.push(a)}return i}getMovesForQueenAt(t,e,n){const i=new _(e,n),o=this.getLandingCoordsForQueen(i,t);return this.addLegalMoves(t,i,o)}getLandingCoordsForQueen(t,e){return this.getLandingCoordsForLinearMove(t,e,j1.HEIGHT)}}class cze extends rr{getMetrics(t,e){const n=t.gameState.getScoreOf(O.ZERO),i=t.gameState.getScoreOf(O.ONE);return G1.ofSingle(n,i)}}function lze(r,t){if(1&r&&(I(),V(0,"g",19)),2&r){const e=p(2).index,n=p().index,i=p();r2(i.style),ve("mainShapeId","pawn_",e,"_",n,""),v("pieceClasses",i.getPieceClasses(e,n))}}function uze(r,t){if(1&r&&(I(),V(0,"g",20)),2&r){const e=p(2).index,n=p().index,i=p();r2(i.style),ve("mainShapeId","drone_",e,"_",n,""),v("pieceClasses",i.getPieceClasses(e,n))}}function fze(r,t){if(1&r&&(I(),V(0,"g",21)),2&r){const e=p(2).index,n=p().index,i=p();r2(i.style),ve("mainShapeId","queen_",e,"_",n,""),v("pieceClasses",i.getPieceClasses(e,n))}}function dze(r,t){if(1&r&&(I(),E(0,"g"),z(1,lze,1,5,"g",16)(2,uze,1,5,"g",17)(3,fze,1,5,"g",18),P()),2&r){const e=p(),n=e.index,i=e.$implicit,o=p().index,s=p();A("transform",s.getPieceLocation(n,o)),m(),v("ngIf",i===s.pieces.PAWN),m(),v("ngIf",i===s.pieces.DRONE),m(),v("ngIf",i===s.pieces.QUEEN)}}function hze(r,t){if(1&r){const e=he();I(),E(0,"g",14),q("click",function(){const o=te(e).index,s=p().index;return ne(p().onClick(o,s))}),V(1,"rect",15),z(2,dze,4,4,"g",13),P()}if(2&r){const e=t.$implicit,n=t.index,i=p().index,o=p();ve("id","click_",n,"_",i,""),A("transform",o.getPieceTranslation(i)),m(),ve("id","square_",n,"_",i,""),v("ngClass",o.getSquareClasses(n,i)),A("x",n*o.SPACE_SIZE)("y",i*o.SPACE_SIZE)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),m(),v("ngIf",e!==o.pieces.EMPTY)}}function gze(r,t){if(1&r){const e=he();I(),E(0,"g")(1,"rect",22),q("click",function(){const o=te(e).$implicit;return ne(p(3).onClick(o.x,o.y))}),P()()}if(2&r){const e=t.$implicit,n=p(3);m(),ve("id","indicator_",e.x,"_",e.y,""),A("transform",n.getPieceTranslation(e.y))("x",e.x*n.SPACE_SIZE+(n.SPACE_SIZE/2-n.INDICATOR_SIZE/2))("y",e.y*n.SPACE_SIZE+(n.SPACE_SIZE/2-n.INDICATOR_SIZE/2))("width",n.INDICATOR_SIZE)("height",n.INDICATOR_SIZE)}}function pze(r,t){if(1&r&&(I(),E(0,"g"),z(1,gze,2,7,"g",1),P()),2&r){const e=p(2);m(),v("ngForOf",e.selectedPieceInfo.get().legalLandings)}}function mze(r,t){if(1&r&&(I(),E(0,"g"),z(1,hze,3,11,"g",12)(2,pze,2,1,"g",13),P()),2&r){const e=t.$implicit,n=p();m(),v("ngForOf",e),m(),v("ngIf",n.selectedPieceInfo.isPresent())}}function _ze(r,t){if(1&r&&(I(),E(0,"text",23),ot(1),P()),2&r){const e=p();v("ngClass","player"+e.getCurrentPlayer().getValue())("ngClass",e.getClockCircleClasses()),A("x",.5*e.SPACE_SIZE)("y",.5*e.SPACE_SIZE),m(),Cn(e.countDown.get())}}function Cze(r,t){if(1&r&&(I(),V(0,"polyline",24)),2&r){const e=p();v("ngClass",e.getClockCircleClasses()),A("points",e.clockNeedlesPoints)}}const rv=r=>[r];function vze(r,t){if(1&r){const e=he();I(),jt(0),E(1,"g",27),q("click",function(){const o=te(e).index;return ne(p(2).chooseStyle(o))}),P(),Zt()}if(2&r){const e=t.$implicit,n=t.index,i=p(2);m(),r2(e.style),v("id",e.name)("pieceClasses",Ta(5,rv,"player"+i.getCurrentPlayer().getValue()+"-fill")),A("transform","translate(0, "+-(n+1)*i.SPACE_SIZE+")")}}function yze(r,t){if(1&r&&(I(),E(0,"g",25),V(1,"rect",26),z(2,vze,2,7,"ng-container",1),P()),2&r){const e=p();m(),A("x",0)("y",-e.listOfStyles.length*e.SPACE_SIZE)("width",1*e.SPACE_SIZE)("height",e.listOfStyles.length*e.SPACE_SIZE),m(),v("ngForOf",e.listOfStyles)}}function Mze(r,t){if(1&r&&(I(),E(0,"text",33),ot(1),P()),2&r){const e=p(2).$implicit,n=p().$implicit,i=p();v("ngClass",i.getPlayerClass(n)),A("x",i.SPACE_SIZE/2)("y",i.SPACE_SIZE/2),m(),Cn(e+" x ")}}function Eze(r,t){if(1&r&&(I(),V(0,"g",34)),2&r){const e=p(3).$implicit,n=p();r2(n.style),v("pieceClasses",Ta(3,rv,n.getPlayerClass(e)))}}function Pze(r,t){if(1&r&&(I(),V(0,"g",35)),2&r){const e=p(3).$implicit,n=p();r2(n.style),v("pieceClasses",Ta(3,rv,n.getPlayerClass(e)))}}function Sze(r,t){if(1&r&&(I(),V(0,"g",36)),2&r){const e=p(3).$implicit,n=p();r2(n.style),v("pieceClasses",Ta(3,rv,n.getPlayerClass(e)))}}function Oze(r,t){if(1&r&&(I(),E(0,"g"),z(1,Mze,2,4,"text",29),E(2,"g",28),z(3,Eze,1,5,"g",30)(4,Pze,1,5,"g",31)(5,Sze,1,5,"g",32),P()()),2&r){const e=p(),n=e.index,i=e.$implicit,o=p().$implicit,s=p();A("transform","translate(0, "+2*n*s.SPACE_SIZE+")"),m(),v("ngIf",i>1),m(),ve("id","piece_",n,"_player_",o.getValue(),""),A("transform","translate("+s.SPACE_SIZE+", 0)"),m(),v("ngIf",0===n),m(),v("ngIf",1===n),m(),v("ngIf",2===n)}}function Tze(r,t){if(1&r&&(I(),E(0,"g"),z(1,Oze,6,8,"g",13),P()),2&r){const e=t.$implicit;m(),v("ngIf",e>0)}}function wze(r,t){if(1&r&&(I(),E(0,"g")(1,"g",28),z(2,Tze,2,1,"g",1),P()()),2&r){const e=t.$implicit,n=p();m(),Tn("id","capture_of_player_",e.getValue(),""),A("transform",n.getCapturesTransformation(e)),m(),v("ngForOf",n.state.getCapturesOf(e))}}let yo=(()=>{class r extends p2{static SPACE_SIZE=100;static STROKE_WIDTH=8;INDICATOR_SIZE=20;HORIZONTAL_CENTER=.5*j1.WIDTH*r.SPACE_SIZE;UNSTROKED_HEIGHT=j1.HEIGHT*r.SPACE_SIZE;VERTICAL_CENTER=.5*this.UNSTROKED_HEIGHT+r.STROKE_WIDTH;LEFT=r.SPACE_SIZE/-4+r.STROKE_WIDTH/-2;UNSTROKED_WIDTH=j1.WIDTH*r.SPACE_SIZE;UP=-r.STROKE_WIDTH/2;WIDTH=this.UNSTROKED_WIDTH+2.5*r.SPACE_SIZE+r.STROKE_WIDTH;HEIGHT=this.UNSTROKED_HEIGHT+3*r.STROKE_WIDTH;MartianChessComponent=r;style={shape:"Circle",points:"Horizontal Points"};pieces=At;state;configViewTranslation;configCogTransformation;selectedPieceInfo=h.empty();lastMoved=[];captured=h.empty();promoted=h.empty();countDown=h.empty();callTheClock=!1;displayModePanel=!1;listOfStyles=[{name:"Star",style:{shape:"Star",points:"Dots"}},{name:"Polygon",style:{shape:"Polygon",points:"Concentric Circles"}},{name:"Simple",style:{shape:"Circle",points:"Horizontal Points"}},{name:"Circely",style:{shape:"Circle",points:"Concentric Circles"}}];clockNeedlesPoints;static getRegularPolygon(e,n=0){const i=r.getRegularPolygonCoords(e,n);return r.mapCoordsToString(i)}static getNPointedStar(e,n){const i=this.getNPointedStarCoords(e,n);return r.mapCoordsToString(i)}static getNPointedStarCoords(e,n){const i=[],o=.5*r.SPACE_SIZE,s=.5*r.SPACE_SIZE;e*=2;for(let a=0;a<e;a++){const l=(a*(360/e)+n)/180*Math.PI,u=a%2==0?r.SPACE_SIZE/2:r.SPACE_SIZE/6,f=o+.8*u*Math.cos(l),g=s+.8*u*Math.sin(l);i.push(new _(f,g))}return i}static getRegularPolygonCoords(e,n=0){const i=[],o=.5*r.SPACE_SIZE,s=.5*r.SPACE_SIZE;for(let a=0;a<e;a++){const l=(a*(360/e)-90)/180*Math.PI,u=.5*r.SPACE_SIZE,f=o+.8*u*Math.cos(l),g=s+.8*u*Math.sin(l)+n;i.push(new _(f,g))}return i}static mapCoordsToString(e){let n="";for(const i of e)n+=i.x+", "+i.y+" ";return n}static getRadius(e){return this.SPACE_SIZE*e/10}constructor(e){super(e),this.setRulesAndNode("MartianChess"),this.availableAIs=[new fn($localize`Score`,this.rules,new cze,new VJ),new zn($localize`MCTS`,new VJ,this.rules)],this.encoder=ei.encoder,this.hasAsymmetricBoard=!0,this.scores=h.of(we.of(0,0)),this.SPACE_SIZE=r.SPACE_SIZE,this.configCogTransformation=this.getConfigCogTransformation(),this.configViewTranslation=this.getConfigViewTranslation(),this.clockNeedlesPoints=this.getClockNeedlesPoints()}getConfigViewTranslation(){return"translate("+(5.25*this.SPACE_SIZE+0)+", "+(7*this.SPACE_SIZE+0+2*this.STROKE_WIDTH)+")"}getConfigCogTransformation(){const e=this.STROKE_WIDTH,i=(this.SPACE_SIZE-e)/40;return"translate("+1*e+", "+1*e+") scale("+i+" "+i+")"}getClockNeedlesPoints(){const e=.5*this.SPACE_SIZE;return e+" "+.1*this.SPACE_SIZE+", "+e+" "+e+", "+.75*this.SPACE_SIZE+" "+e}updateBoard(e){var n=this;return M(function*(){n.state=n.getState(),n.board=n.state.board;const i=n.state.getScoreOf(O.ZERO),o=n.state.getScoreOf(O.ONE);n.countDown=n.state.countDown,n.scores=h.of(we.of(i,o))})()}showLastMove(e){var n=this;return M(function*(){n.lastMoved=e.getCoords();const i=e.getEnd(),s=n.node.parent.get().gameState.getPieceAt(i)!==At.EMPTY,a=n.node.gameState.isInPlayerTerritory(i);s&&(a?n.captured=h.of(i):n.promoted=h.of(i))})()}hideLastMove(){this.lastMoved=[],this.captured=h.empty(),this.promoted=h.empty()}getPieceLocation(e,n){return"translate("+this.SPACE_SIZE*e+", "+this.SPACE_SIZE*n+")"}getPieceClasses(e,n){const i=new _(e,n),o=[];return o.push(n>3?"player0-fill":"player1-fill"),this.selectedPieceInfo.isPresent()&&this.selectedPieceInfo.get().selectedPiece.equals(i)&&o.push("selected-stroke"),this.promoted.equalsValue(i)&&o.push("last-move-stroke"),o}onClick(e,n){var i=this;return M(function*(){i.displayModePanel=!1;const o=yield i.canUserPlay("#click_"+e+"_"+n);if(o.isFailure())return i.cancelMove(o.getReason());const s=new _(e,n);return i.selectedPieceInfo.isPresent()?i.secondClick(s):i.firstClick(s)})()}firstClick(e){var n=this;return M(function*(){return n.isOneOfUsersPieces(e)?n.selectAsFirstPiece(e):(n.cancelMoveAttempt(),w.SUCCESS)})()}selectAsFirstPiece(e){var n=this;return M(function*(){const i=n.getLegalLandings(e);return n.selectedPieceInfo=h.of({selectedPiece:e,legalLandings:i}),w.SUCCESS})()}getLegalLandings(e){const n=this.state.getPieceAt(e);let i;return i=n===At.PAWN?me.DIAGONALS.map(o=>e.getNext(o)):this.getValidLinearLandingSquareUntil(e,n===At.DRONE?2:j1.HEIGHT),i.filter(o=>{const s=ei.from(e,o);return!!s.isSuccess()&&this.rules.isLegal(s.get(),this.getState()).isSuccess()})}getValidLinearLandingSquareUntil(e,n){return me.DIRECTIONS.flatMap(i=>{const o=[];let s=e.getNext(i),a=1;for(;j1.isOnBoard(s)&&a<=n&&(o.push(s),this.getState().getPieceAt(s)===At.EMPTY);)s=s.getNext(i),a++;return o})}secondClick(e){var n=this;return M(function*(){const i=n.selectedPieceInfo.get();if(i.selectedPiece.equals(e))return n.cancelMoveAttempt(),w.SUCCESS;if(i.legalLandings.some(o=>o.equals(e))){const o=ei.from(i.selectedPiece,e,n.callTheClock);return L.assert(o.isSuccess(),"MartianChessComponent or Rules did a mistake thinking this would have been a legal move!"),n.chooseMove(o.get())}if(n.isOneOfUsersPieces(e))return n.selectAsFirstPiece(e);{const o=ei.from(i.selectedPiece,e,n.callTheClock);return o.isSuccess()?n.chooseMove(o.get()):n.cancelMove(o.getReason())}})()}isOneOfUsersPieces(e){return this.state.getPieceAt(e)!==At.EMPTY&&this.state.isInPlayerTerritory(e)}cancelMoveAttempt(){this.selectedPieceInfo=h.empty(),this.callTheClock=!1}onClockClick(){var e=this;return M(function*(){const n=yield e.canUserPlay("#clockOrCountDownView");return n.isFailure()?e.cancelMove(n.getReason()):(e.getState().countDown.isAbsent()&&(e.callTheClock=!1===e.callTheClock),w.SUCCESS)})()}getClockCircleClasses(){const e=["base"];return this.callTheClock&&e.push("selected-stroke"),this.getCurrentPlayer()===O.ZERO?e.push("player0-stroke"):e.push("player1-stroke"),e}getSquareClasses(e,n){const i=new _(e,n),o=["base"];return this.captured.equalsValue(i)?o.push("captured-fill"):this.lastMoved.some(s=>s.equals(i))&&o.push("moved-fill"),o}onModeCogClick(){this.displayModePanel=!1===this.displayModePanel}chooseStyle(e){this.style=this.listOfStyles[e].style,this.displayModePanel=!1}getPieceTranslation(e){return"translate(0, "+(e<=3?0:2*this.STROKE_WIDTH)+")"}getBoardTransformation(){return"translate("+this.SPACE_SIZE+", 0) rotate("+180*this.getPointOfView().getValue()+" "+this.HORIZONTAL_CENTER+" "+this.VERTICAL_CENTER+")"}getCapturesTransformation(e){const i=-this.SPACE_SIZE/2;let o=this.SPACE_SIZE/2;return e===this.getPointOfView()&&(o+=10*this.SPACE_SIZE+4*this.STROKE_WIDTH),"scale(0.5, 0.5) translate("+i+", "+o+")"}static \u0275fac=function(n){return new(n||r)(G(Ut))};static \u0275cmp=Ue({type:r,selectors:[["app-martian-chess"]],features:[$e],decls:15,vars:19,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["id","clockOrCountDownView",3,"click"],["x","0","y","0",1,"transparent"],["id","clockOrCountDownCircle",3,"ngClass"],["id","countDownText","class","text-giant text-center",3,"ngClass",4,"ngIf"],["class","base","stroke-linecap","round",3,"ngClass",4,"ngIf"],["id","modeCogView"],["id","modeCog",3,"click"],["d","M35.497,15.111h-1.656c-0.282-0.924-0.653-1.807-1.102-2.646l1.176-1.175c1.364-1.366,1.366-3.582,0-4.949l-1.258-1.258 c-0.656-0.656-1.548-1.025-2.476-1.025l0,0c-0.93,0-1.818,0.369-2.477,1.025l-1.176,1.175c-0.838-0.446-1.721-0.817-2.645-1.102 V3.501c0-1.934-1.566-3.5-3.5-3.5h-1.778c-1.934,0-3.5,1.566-3.5,3.5v1.655c-0.923,0.282-1.807,0.653-2.645,1.102l-1.174-1.175 c-1.367-1.367-3.584-1.367-4.951,0L5.081,6.34c-1.367,1.366-1.367,3.583,0,4.949l1.174,1.175c-0.446,0.84-0.818,1.723-1.102,2.646 H3.5c-1.934,0-3.5,1.566-3.5,3.5v1.778c0,1.932,1.566,3.5,3.5,3.5h1.654c0.283,0.922,0.654,1.807,1.102,2.645l-1.175,1.176 c-1.366,1.365-1.366,3.582-0.001,4.949l1.258,1.258c0.656,0.654,1.547,1.023,2.475,1.023h0.001c0.929,0,1.818-0.369,2.475-1.023 l1.176-1.176c0.837,0.447,1.722,0.818,2.644,1.102v1.656c0,1.932,1.566,3.5,3.5,3.5h1.778c1.934,0,3.5-1.568,3.5-3.5v-1.656 c0.924-0.283,1.807-0.654,2.645-1.102l1.177,1.176c0.655,0.656,1.547,1.023,2.476,1.023c0.93,0,1.817-0.369,2.477-1.023 l1.256-1.258c1.366-1.367,1.365-3.582,0-4.949l-1.176-1.174c0.447-0.84,0.818-1.725,1.102-2.646h1.656c1.934,0,3.5-1.568,3.5-3.5 v-1.777C38.997,16.679,37.43,15.111,35.497,15.111z M19.499,27.499c-4.41,0-8-3.588-8-8c0-4.411,3.59-8,8-8c4.412,0,8,3.589,8,8 C27.499,23.911,23.911,27.499,19.499,27.499z",3,"ngClass"],["id","modePanel",4,"ngIf"],["id","captures"],[3,"id","click",4,"ngFor","ngForOf"],[4,"ngIf"],[3,"id","click"],[3,"id","ngClass"],["app-martian-chess-pawn","",3,"mainShapeId","pieceClasses","style",4,"ngIf"],["app-martian-chess-drone","",3,"pieceClasses","mainShapeId","style",4,"ngIf"],["app-martian-chess-queen","",3,"mainShapeId","pieceClasses","style",4,"ngIf"],["app-martian-chess-pawn","",3,"mainShapeId","pieceClasses"],["app-martian-chess-drone","",3,"pieceClasses","mainShapeId"],["app-martian-chess-queen","",3,"mainShapeId","pieceClasses"],[1,"indicator",3,"id","click"],["id","countDownText",1,"text-giant","text-center",3,"ngClass"],["stroke-linecap","round",1,"base",3,"ngClass"],["id","modePanel"],["stroke-width","8",1,"base"],["app-martian-chess-queen","",3,"id","pieceClasses","click"],[3,"id"],["class","text-giant text-center",3,"ngClass",4,"ngIf"],["app-martian-chess-pawn","",3,"pieceClasses","style",4,"ngIf"],["app-martian-chess-drone","",3,"pieceClasses","style",4,"ngIf"],["app-martian-chess-queen","",3,"pieceClasses","style",4,"ngIf"],[1,"text-giant","text-center",3,"ngClass"],["app-martian-chess-pawn","",3,"pieceClasses"],["app-martian-chess-drone","",3,"pieceClasses"],["app-martian-chess-queen","",3,"pieceClasses"]],template:function(n,i){1&n&&(I(),E(0,"svg",0)(1,"g"),z(2,mze,3,2,"g",1),P(),E(3,"g",2),q("click",function(){return i.onClockClick()}),V(4,"rect",3)(5,"circle",4),z(6,_ze,2,5,"text",5)(7,Cze,1,2,"polyline",6),P(),E(8,"g",7)(9,"g",8),q("click",function(){return i.onModeCogClick()}),V(10,"rect",3)(11,"path",9),P(),z(12,yze,3,5,"g",10),P(),E(13,"g",11),z(14,wze,3,3,"g",1),P()()),2&n&&(A("viewBox",i.LEFT+" "+i.UP+" "+i.WIDTH+" "+i.HEIGHT),m(),A("transform",i.getBoardTransformation()),m(),v("ngForOf",i.board),m(),A("transform","translate("+5.25*i.SPACE_SIZE+", 0)"),m(),A("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),m(),v("ngClass",i.getClockCircleClasses()),A("cx",.5*i.SPACE_SIZE)("cy",.5*i.SPACE_SIZE)("r",.4*i.SPACE_SIZE),m(),v("ngIf",i.countDown.isPresent()),m(),v("ngIf",i.countDown.isAbsent()),m(),A("transform",i.configViewTranslation),m(2),A("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),m(),v("ngClass",i.getPlayerClass(i.getCurrentPlayer())),A("transform",i.configCogTransformation),m(),v("ngIf",i.displayModePanel),m(2),v("ngForOf",i.Player.PLAYERS))},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}return r})();class iv extends B1{}let bze=(()=>class r{static COLUMN_IS_FULL=()=>$localize`Please put your piece in an incomplete column.`})();var wl;let Yc=class extends Da{static#e=wl=this;static singleton=h.empty();static RULES_CONFIG_DESCRIPTION=new fo({name:()=>$localize`Four in a Row`,config:{width:new _1(7,Gi.WIDTH,m1.range(1,99)),height:new _1(6,Gi.HEIGHT,m1.range(1,99))}});static get(){return wl.singleton.isAbsent()&&(wl.singleton=h.of(new wl)),wl.singleton.get()}P4_HELPER;constructor(){super(),this.P4_HELPER=new a0(L.identity,4)}getRulesConfigDescription(){return h.of(wl.RULES_CONFIG_DESCRIPTION)}getInitialState(t){const e=rt.create(t.get().width,t.get().height,B.NONE);return new iv(e,0)}applyLegalMove(t,e,n,i){const o=t.x,s=e.getCopiedBoard(),a=wl.get().getLowestUnoccupiedSpace(s,o),c=e.turn;return s[a][o]=e.getCurrentPlayer(),new iv(s,c+1)}isLegal(t,e){return e.getPieceAtXY(t.x,0).isPlayer()?w.failure(bze.COLUMN_IS_FULL()):w.SUCCESS}getGameStatus(t){const e=t.gameState;if(this.P4_HELPER.getVictoriousCoord(e).length>0)return ye.getVictory(e.getCurrentOpponent());const i=e.getWidth(),o=e.getHeight();return e.turn===i*o?ye.DRAW:ye.ONGOING}getVictoriousCoords(t){return this.P4_HELPER.getVictoriousCoord(t)}getLowestUnoccupiedSpace(t,e){let n=0;const i=t.length;for(;n<i&&t[n][e]===B.NONE;)n++;return n-1}};Yc=wl=function(r,t,e,n){var s,i=arguments.length,o=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,e):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,t,e,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(t,e,o):s(t,e))||o);return i>3&&o&&Object.defineProperty(t,e,o),o}([Ae.log],Yc);class Kc extends h2{x;static encoder=ke.tuple([ke.identity()],t=>[t.x],t=>Kc.of(t[0]));static of(t){return L.assert(0<=t,"P4Move should be a positive integer!"),new Kc(t)}constructor(t){super(),this.x=t}equals(t){return this.x===t.x}toString(){return"P4Move("+this.x+")"}}let ov=class extends Kn{getListMoves(t,e){const i=t.gameState.getWidth(),o=Math.floor((i-1)/2);return this.getUnorderedListMoves(t,e).sort((s,a)=>Math.abs(s.x-o)-Math.abs(a.x-o))}getUnorderedListMoves(t,e){const n=t.gameState,i=[];for(let o=0;o<n.getWidth();o++)if(n.getPieceAtXY(o,0)===B.NONE){const s=Kc.of(o);i.push(s)}return i}};ov=function(r,t,e,n){var s,i=arguments.length,o=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,e):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,t,e,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(t,e,o):s(t,e))||o);return i>3&&o&&Object.defineProperty(t,e,o),o}([Ae.log],ov);class Ize extends Ha{getBoardValue(t,e){const n=t.gameState;let i=0;for(let o=0;o<n.getWidth();o++)for(let s=n.getHeight()-1;-1!==s&&n.board[s][o].isPlayer();s--)i+=Yc.get().P4_HELPER.getSquareScore(n,new _(o,s));return mn.of(i)}}class kze extends ov{getListMoves(t,e){const n=(t.gameState.getWidth()-1)/2;return super.getListMoves(t,e).sort(function i(o,s){return Math.abs(o.x-n)-Math.abs(s.x-n)})}}class Rze extends fn{constructor(){super($localize`Minimax`,Yc.get(),new Ize,new kze)}}function xze(r,t){if(1&r&&(I(),V(0,"circle",8)),2&r){const e=p().index,n=p().index,i=p();v("ngClass",i.getSquareFillClass(e,n)),A("cx",i.SPACE_SIZE*e+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)}}function Lze(r,t){if(1&r){const e=he();I(),E(0,"g",5),q("click",function(){const o=te(e).index;return ne(p(2).onClick(o))}),V(1,"rect",6),z(2,xze,1,4,"circle",7),P()}if(2&r){const e=t.$implicit,n=t.index,i=p().index,o=p();Tn("id","click_",n,""),m(),A("x",o.SPACE_SIZE*n)("y",o.SPACE_SIZE*i)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),m(),v("ngIf",e!==o.EMPTY)}}function zze(r,t){if(1&r&&(I(),E(0,"g"),z(1,Lze,3,6,"g",4),P()),2&r){const e=t.$implicit;m(),v("ngForOf",e)}}function Dze(r,t){if(1&r&&(I(),V(0,"rect",9)),2&r){const e=p();A("x",e.SPACE_SIZE*e.last.get().x)("y",e.SPACE_SIZE*e.last.get().y)("width",e.SPACE_SIZE)("height",e.SPACE_SIZE)}}function Vze(r,t){if(1&r&&(I(),V(0,"rect",10)),2&r){const e=t.$implicit,n=p();ve("id","victory_coord_",e.x,"_",e.y,""),A("x",n.SPACE_SIZE*e.x)("y",n.SPACE_SIZE*e.y)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}let Hze=(()=>{class r extends p2{EMPTY=B.NONE;last;victoryCoords=[];constructor(e){super(e),this.setRulesAndNode("P4"),this.availableAIs=[new Rze,new zn($localize`MCTS`,new ov,this.rules)],this.encoder=Kc.encoder}onClick(e){var n=this;return M(function*(){const i=yield n.canUserPlay("#click_"+e);if(i.isFailure())return n.cancelMove(i.getReason());const o=Kc.of(e);return yield n.chooseMove(o)})()}updateBoard(e){var n=this;return M(function*(){const i=n.getState();n.victoryCoords=Yc.get().getVictoriousCoords(i),n.board=i.board})()}showLastMove(e,n){var i=this;return M(function*(){const o=i.getState(),s=Yc.get().getLowestUnoccupiedSpace(o.board,e.x)+1;i.last=h.of(new _(e.x,s))})()}hideLastMove(){this.last=h.empty()}getSquareFillClass(e,n){return[this.getPlayerClass(this.board[n][e])]}static \u0275fac=function(n){return new(n||r)(G(Ut))};static \u0275cmp=Ue({type:r,selectors:[["app-p4"]],features:[$e],decls:4,vars:4,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base no-fill last-move-stroke mid-stroke",4,"ngIf"],["class","base no-fill victory-stroke mid-stroke",3,"id",4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base"],["class","base","pointer-events","fill",3,"ngClass",4,"ngIf"],["pointer-events","fill",1,"base",3,"ngClass"],[1,"base","no-fill","last-move-stroke","mid-stroke"],[1,"base","no-fill","victory-stroke","mid-stroke",3,"id"]],template:function(n,i){1&n&&(I(),E(0,"svg",0),z(1,zze,2,1,"g",1)(2,Dze,1,4,"rect",2)(3,Vze,1,6,"rect",3),P()),2&n&&(A("viewBox",i.getViewBox().toSVGString()),m(),v("ngForOf",i.board),m(),v("ngIf",i.last.isPresent()),m(),v("ngForOf",i.victoryCoords))},dependencies:[zt,Nt,bt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}return r})();const ut=B.NONE,u4=B.ZERO,Mu=B.ONE,HJ=Yc.get().getDefaultRulesConfig();class Fze extends Wn{tutorial=[W.informational($localize`Goal of the game`,$localize`The board at Four in a Row is made of 7 columns and 6 rows, and it is initially empty.
        The first player plays Dark, the second plays Light.
        The goal is to be the first to align 4 of its pieces (horizontally, vertically, or diagonally).`,Yc.get().getInitialState(HJ)),W.anyMove($localize`Dropping a piece`,$localize`Click on any space in any column.`,Yc.get().getInitialState(HJ),Kc.of(3),$localize`As you can see, the piece falls at the bottom of the column.`),W.fromMove($localize`Victory`,$localize`You're playing Dark.
        Place your piece so that you create a horizontal alignment of 4 of your pieces.`,new iv([[ut,ut,ut,ut,ut,ut,ut],[ut,ut,ut,ut,ut,ut,ut],[ut,ut,ut,ut,ut,ut,ut],[ut,ut,ut,Mu,ut,ut,ut],[ut,ut,ut,Mu,ut,ut,ut],[ut,ut,u4,u4,u4,Mu,ut]],0),[Kc.of(1)],$localize`You won!`,$localize`Failed, you have not aligned 4 pieces and missed an opportunity to win.`),W.fromMove($localize`Other victory`,$localize`You can also align 4 pieces diagonally or vertically.`,new iv([[ut,ut,ut,ut,ut,ut,ut],[ut,ut,ut,ut,ut,ut,ut],[ut,ut,ut,ut,ut,ut,ut],[ut,ut,ut,u4,Mu,ut,ut],[ut,ut,u4,u4,Mu,ut,ut],[ut,u4,Mu,u4,u4,ut,ut]],0),[Kc.of(3),Kc.of(4)],$localize`You won!`,$localize`Failed, you have not aligned 4 pieces and missed an opportunity to win.`)]}class Pr extends B1{static SIZE=6;static ROTATION_MAP=[[new _(-1,-1),new _(1,-1)],[new _(0,-1),new _(1,0)],[new _(1,-1),new _(1,1)],[new _(1,0),new _(0,1)],[new _(1,1),new _(-1,1)],[new _(0,1),new _(-1,0)],[new _(-1,1),new _(-1,-1)],[new _(-1,0),new _(0,-1)]];static isOnBoard(t){return t.isInRange(Pr.SIZE,Pr.SIZE)}neutralBlocks;constructor(t,e){super(t,e),this.neutralBlocks=this.getBlocksNeutralities()}getBlocksNeutralities(){const t=[];for(let e=0;e<4;e++)this.getBlockNeutrality(e)&&t.push(e);return t}getBlockNeutrality(t){const e=Pr.getBlockCenter(t),n=this.getPieceAt(e.getNext(me.UP,1)),i=this.getPieceAt(e.getNext(me.UP_LEFT,1));return this.getPieceAt(e.getNext(me.RIGHT,1))===n&&this.getPieceAt(e.getNext(me.DOWN,1))===n&&this.getPieceAt(e.getNext(me.LEFT,1))===n&&this.getPieceAt(e.getNext(me.UP_RIGHT,1))===i&&this.getPieceAt(e.getNext(me.DOWN_RIGHT,1))===i&&this.getPieceAt(e.getNext(me.DOWN_LEFT,1))===i}static getBlockCenter(t){return new _(1+(t%2==0?0:3),1+(t<2?0:3))}applyLegalDrop(t){const e=this.getCopiedBoard();return e[t.coord.y][t.coord.x]=this.getCurrentPlayer(),new Pr(e,this.turn)}applyLegalMove(t){const e=this.applyLegalDrop(t),n=e.getCopiedBoard();if(t.blockTurned.isPresent()){const o=Pr.getBlockCenter(t.blockTurned.get()).toVector();if(t.turnedClockwise)for(const s of Pr.ROTATION_MAP){const a=s[0].getNext(o),c=s[1].getNext(o),l=e.getPieceAt(a);n[c.y][c.x]=l}else for(const s of Pr.ROTATION_MAP){const a=s[1].getNext(o),c=s[0].getNext(o),l=e.getPieceAt(a);n[c.y][c.x]=l}}return new Pr(n,this.turn+1)}blockIsNeutral(t){return this.neutralBlocks.includes(t)}}class di extends Nr{blockTurned;turnedClockwise;static encoder=ke.tuple([_.encoder,h.getEncoder(ke.identity()),ke.identity()],t=>[t.coord,t.blockTurned,t.turnedClockwise],t=>di.of(t[0],t[1],t[2]));static of(t,e,n){return new di(t.x,t.y,e,n)}static withRotation(t,e,n,i){return L.assert(0<=n&&n<=3,"This block does not exist: "+n),new di(t,e,h.of(n),i)}static rotationless(t,e){return new di(t,e,h.empty())}constructor(t,e,n,i=!1){super(t,e),this.blockTurned=n,this.turnedClockwise=i,L.assert(Pr.isOnBoard(this.coord),"The board is a "+Pr.SIZE+" space wide square, invalid coord: "+this.coord.toString())}toString(){return this.blockTurned.isPresent()?"PentagoMove("+this.coord.toString()+", "+this.blockTurned.get()+", "+(this.turnedClockwise?"CLOCKWISE":"ANTI-CLOCKWISE")+")":"PentagoMove"+this.coord.toString()}equals(t){return!1!==this.coord.equals(t.coord)&&!1!==this.blockTurned.equals(t.blockTurned)&&this.turnedClockwise===t.turnedClockwise}}class sv extends Kn{static FIRST_TURN_MOVES=[di.rotationless(0,0),di.rotationless(1,0),di.rotationless(2,0),di.rotationless(0,1),di.rotationless(1,1),di.rotationless(0,2)];getListMoves(t,e){const n=[],i=t.gameState.neutralBlocks;if(0===t.gameState.turn)return sv.FIRST_TURN_MOVES;const o=this.getLegalDrops(t.gameState);for(const s of o){const a=di.rotationless(s.x,s.y),c=t.gameState.applyLegalDrop(a),l=this.getLegalRotations(c,i);for(const f of l)n.push(di.withRotation(s.x,s.y,f[0],f[1]));0===c.neutralBlocks.length==0&&n.push(a)}return n}getLegalDrops(t){const e=[];for(let n=0;n<Pr.SIZE;n++)for(let i=0;i<Pr.SIZE;i++){const o=new _(i,n);t.getPieceAt(o)===B.NONE&&e.push(o)}return e}getLegalRotations(t,e){const n=0===t.neutralBlocks.length,i=[];for(let o=0;o<4;o++)!1===t.blockIsNeutral(o)&&(e.includes(o)?n&&i.push([o,!0]):i.push([o,!0],[o,!1]));return i}}function Uze(r,t){if(1&r){const e=he();I(),E(0,"circle",12),q("click",function(){const o=te(e).$implicit,s=p().$implicit,a=p().index,c=p().index;return ne(p().onClick(3*a+o,3*c+s))}),P()}if(2&r){const e=t.$implicit,n=p().$implicit,i=p(),o=i.index,s=i.$implicit,a=p(),c=a.index,l=a.$implicit,u=p();ve("id","click_",3*o+e,"_",3*c+n,""),v("ngClass",u.getSquareClasses(3*o+e,3*c+n)),A("cx",s+2*u.STROKE_WIDTH+(e+.5)*u.SPACE_SIZE)("cy",l+2*u.STROKE_WIDTH+(n+.5)*u.SPACE_SIZE)("r",(u.SPACE_SIZE-u.STROKE_WIDTH)/2)}}const FJ=()=>[0,1,2];function Gze(r,t){1&r&&(I(),jt(0),z(1,Uze,1,6,"circle",11),Zt()),2&r&&(m(),v("ngForOf",fr(1,FJ)))}function Bze(r,t){if(1&r&&(I(),jt(0),V(1,"rect",10),z(2,Gze,2,2,"ng-container",4),Zt()),2&r){const e=t.$implicit,n=t.index,i=p(),o=i.index,s=i.$implicit,a=p();m(),v("ngClass",a.getBlockClasses(n,o)),A("x",a.STROKE_WIDTH+e)("y",a.STROKE_WIDTH+s)("rx",3*a.STROKE_WIDTH)("ry",3*a.STROKE_WIDTH)("width",a.BLOCK_WIDTH)("height",a.BLOCK_WIDTH),m(),v("ngForOf",fr(8,FJ))}}const UJ=r=>[0,r];function $ze(r,t){if(1&r&&(I(),jt(0),z(1,Bze,3,9,"ng-container",4),Zt()),2&r){const e=p();m(),v("ngForOf",Ta(1,UJ,e.BLOCK_SEPARATION))}}function Wze(r,t){if(1&r&&(I(),V(0,"circle",13)),2&r){const e=p();ve("id","currentDrop_",e.currentDrop.get().x,"_",e.currentDrop.get().y,""),v("ngClass",e.getPlayerClass(e.getCurrentPlayer())),A("cx",e.getCenter(e.currentDrop.get().x))("cy",e.getCenter(e.currentDrop.get().y))("r",(e.SPACE_SIZE-e.STROKE_WIDTH)/2)}}function qze(r,t){if(1&r){const e=he();I(),E(0,"path",14),q("click",function(){const o=te(e).$implicit;return ne(p().rotate(o))}),P()}if(2&r){const e=t.$implicit,n=p();ve("id","rotate_",e.blockIndex,"_",e.clockwise?"clockwise":"counterclockwise",""),A("d",e.path)("stroke-width",2*n.STROKE_WIDTH)}}function jze(r,t){if(1&r&&(I(),V(0,"path",15)),2&r){const e=p();ve("id","last_rotation_",e.lastRotation.get().blockIndex,"_",e.lastRotation.get().clockwise?"clockwise":"counterclockwise",""),A("d",e.lastRotation.get().path)("stroke-width",2*e.STROKE_WIDTH)}}function Zze(r,t){if(1&r&&(I(),V(0,"circle",16)),2&r){const e=t.$implicit,n=p();ve("id","victoryCoord_",e.x,"_",e.y,""),v("ngClass",n.getSquareClasses(e.x,e.y)),A("cx",n.getCenter(e.x))("cy",n.getCenter(e.y))("r",(n.SPACE_SIZE-n.STROKE_WIDTH)/2)("stroke-width",n.STROKE_WIDTH)}}function Yze(r,t){if(1&r){const e=he();I(),E(0,"g",17),q("click",function(){return te(e),ne(p().skipRotation())}),V(1,"circle",18)(2,"line",19),P()}if(2&r){const e=p();m(),A("cx",e.BLOCK_SEPARATION)("cy",e.BLOCK_SEPARATION)("r",.75*e.SPACE_SIZE)("stroke-width",2*e.STROKE_WIDTH),m(),A("x1",e.BLOCK_SEPARATION-e.DIAGONAL_BAR_OFFSET)("y1",e.BLOCK_SEPARATION+e.DIAGONAL_BAR_OFFSET)("x2",e.BLOCK_SEPARATION+e.DIAGONAL_BAR_OFFSET)("y2",e.BLOCK_SEPARATION-e.DIAGONAL_BAR_OFFSET)("stroke-width",2*e.STROKE_WIDTH)}}let Kze=(()=>{class r extends p2{BLOCK_WIDTH;BLOCK_SEPARATION;DIAGONAL_BAR_OFFSET;arrows=[];victoryCoords=[];canSkipRotation;currentDrop=h.empty();movedBlock=h.empty();lastDrop=h.empty();lastRotation=h.empty();ARROWS;constructor(e){super(e),this.setRulesAndNode("Pentago"),this.availableAIs=[new fn($localize`Dummy`,this.rules,new EI,new sv),new zn($localize`MCTS`,new sv,this.rules)],this.encoder=di.encoder,this.BLOCK_WIDTH=3*this.SPACE_SIZE+2*this.STROKE_WIDTH,this.BLOCK_SEPARATION=this.BLOCK_WIDTH+2*this.STROKE_WIDTH,this.DIAGONAL_BAR_OFFSET=.75*Math.cos(Math.PI/4)*this.SPACE_SIZE,this.ARROWS=this.generateArrowsCoord()}updateBoard(e){var n=this;return M(function*(){n.board=n.getState().getCopiedBoard(),n.victoryCoords=n.rules.getVictoryCoords(n.getState()),n.lastDrop=h.empty(),n.lastRotation=h.empty()})()}showLastMove(e){var n=this;return M(function*(){n.cancelMoveAttempt(),n.movedBlock=e.blockTurned;const i=new _(e.coord.x%3-1,e.coord.y%3-1);if(e.blockTurned.isPresent()&&(n.showLastRotation(e),!1===i.equals(new _(0,0))&&n.coordBelongToBlock(e)))return n.showLastDrop(e,i);n.lastDrop=h.of(e.coord)})()}showLastRotation(e){if(e.blockTurned.isPresent()){const n=e.blockTurned.get(),i=this.ARROWS.filter(o=>o.blockIndex===n&&o.clockwise===e.turnedClockwise)[0];this.lastRotation=h.of(i)}}showLastDrop(e,n){let i;i=e.turnedClockwise?L.getNonNullable(Pr.ROTATION_MAP.find(l=>l[0].equals(n)))[1]:L.getNonNullable(Pr.ROTATION_MAP.find(l=>l[1].equals(n)))[0];const o=e.blockTurned.get(),c=new _(o%2==0?1:4,o<2?1:4);i=i.getNext(c,1),this.lastDrop=h.of(i)}coordBelongToBlock(e){return e.blockTurned.equalsValue(2*(e.coord.y<3?0:1)+(e.coord.x<3?0:1))}hideLastMove(){this.lastDrop=h.empty(),this.movedBlock=h.empty(),this.lastRotation=h.empty(),this.victoryCoords=[]}generateArrowsCoord(){const e=2*this.BLOCK_SEPARATION,i=this.SPACE_SIZE,o=e-i,s=2*i,a=.5*this.SPACE_SIZE;return[{path:"M "+a+" 0 q  "+i+" -"+i+"  "+s+"  0",blockIndex:0,clockwise:!0},{path:"M 0 "+a+" q -"+i+"  "+i+"  0  "+s,blockIndex:0,clockwise:!1},{path:"M "+e+" "+a+" q  "+i+"  "+i+"  0  "+s,blockIndex:1,clockwise:!0},{path:"M "+o+" 0 q -"+i+" -"+i+" -"+s+"  0",blockIndex:1,clockwise:!1},{path:"M 0 "+o+" q -"+i+" -"+i+"  0 -"+s,blockIndex:2,clockwise:!0},{path:"M "+a+" "+e+" q  "+i+"  "+i+"  "+s+"  0",blockIndex:2,clockwise:!1},{path:"M "+o+" "+e+" q -"+i+"  "+i+" -"+s+"  0",blockIndex:3,clockwise:!0},{path:"M "+e+" "+o+" q  "+i+" -"+i+"  0 -"+s,blockIndex:3,clockwise:!1}]}cancelMoveAttempt(){this.arrows=[],this.currentDrop=h.empty(),this.canSkipRotation=!1}onClick(e,n){var i=this;return M(function*(){const o=yield i.canUserPlay("#click_"+e+"_"+n);if(o.isFailure())return i.cancelMove(o.getReason());if(i.hideLastMove(),i.board[n][e].isPlayer())return i.cancelMove(Ee.MUST_LAND_ON_EMPTY_SPACE());const s=di.rotationless(e,n),c=i.getState().applyLegalDrop(s);if(4===c.neutralBlocks.length)return i.chooseMove(s);const l=i.rules.getGameStatus(i.node);return i.canSkipRotation=c.neutralBlocks.length>0&&!1===l.isEndGame,i.currentDrop=h.of(new _(e,n)),i.displayArrows(c.neutralBlocks),w.SUCCESS})()}getCenter(e){return(e<3?0:this.BLOCK_SEPARATION)+2*this.STROKE_WIDTH+(e%3+.5)*this.SPACE_SIZE}displayArrows(e){this.arrows=[];for(let n=0;n<4;n++)if(!1===e.includes(n)){const i=this.ARROWS.filter(o=>o.blockIndex===n);this.arrows=this.arrows.concat(i)}}getBlockClasses(e,n){return this.movedBlock.equalsValue(e+2*n)?["last-move-stroke"]:[]}getSquareClasses(e,n){const i=[],o=this.getPlayerClass(this.board[n][e]);return i.push(o),this.lastDrop.equalsValue(new _(e,n))&&i.push("last-move-stroke"),i}rotate(e){var n=this;return M(function*(){const i=e.clockwise?"clockwise":"counterclockwise",o=yield n.canUserPlay("#rotate_"+e.blockIndex+"_"+i);if(o.isFailure())return n.cancelMove(o.getReason());const s=n.currentDrop.get(),a=di.withRotation(s.x,s.y,e.blockIndex,e.clockwise);return n.chooseMove(a)})()}skipRotation(){var e=this;return M(function*(){const n=yield e.canUserPlay("#skipRotation");if(n.isFailure())return e.cancelMove(n.getReason());const i=e.currentDrop.get(),o=di.rotationless(i.x,i.y);return e.chooseMove(o)})()}static \u0275fac=function(n){return new(n||r)(G(Ut))};static \u0275cmp=Ue({type:r,selectors:[["app-pentago"]],features:[$e],decls:13,vars:8,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-60 -60 780 780"],["id","bluearrowhead","markerWidth","5","markerHeight","3.5","refX","2.5","refY","1.75","orient","auto","fill","blue"],["points","0 0, 5 1.75, 0 3.5"],["id","movedarrowhead","markerWidth","5","markerHeight","3.5","refX","2.5","refY","1.75","orient","auto",1,"last-move-fill"],[4,"ngFor","ngForOf"],["class","base","pointer-events","fill",3,"id","ngClass",4,"ngIf"],["class","no-fill","stroke","blue","marker-end","url(#bluearrowhead)",3,"id","click",4,"ngFor","ngForOf"],["class","no-fill last-move-stroke","marker-end","url(#movedarrowhead)",3,"id",4,"ngIf"],["class","base victory-stroke",3,"id","ngClass",4,"ngFor","ngForOf"],["id","skipRotation",3,"click",4,"ngIf"],[1,"base","no-fill",3,"ngClass"],["class","base","pointer-events","fill",3,"id","ngClass","click",4,"ngFor","ngForOf"],["pointer-events","fill",1,"base",3,"id","ngClass","click"],["pointer-events","fill",1,"base",3,"id","ngClass"],["stroke","blue","marker-end","url(#bluearrowhead)",1,"no-fill",3,"id","click"],["marker-end","url(#movedarrowhead)",1,"no-fill","last-move-stroke",3,"id"],[1,"base","victory-stroke",3,"id","ngClass"],["id","skipRotation",3,"click"],["stroke","red",1,"background"],["stroke","red"]],template:function(n,i){1&n&&(I(),E(0,"svg",0)(1,"defs")(2,"marker",1),V(3,"polygon",2),P()(),E(4,"defs")(5,"marker",3),V(6,"polygon",2),P()(),z(7,$ze,2,3,"ng-container",4)(8,Wze,1,6,"circle",5)(9,qze,1,4,"path",6)(10,jze,1,4,"path",7)(11,Zze,1,7,"circle",8)(12,Yze,3,9,"g",9),P()),2&n&&(m(7),v("ngForOf",Ta(6,UJ,i.BLOCK_SEPARATION)),m(),v("ngIf",i.currentDrop.isPresent()),m(),v("ngForOf",i.arrows),m(),v("ngIf",i.lastRotation.isPresent()),m(),v("ngForOf",i.victoryCoords),m(),v("ngIf",i.canSkipRotation))},dependencies:[zt,Nt,bt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}return r})(),GJ=(()=>class r{static CANNOT_ROTATE_NEUTRAL_BLOCK=()=>$localize`If the quadrant to turn is neutral, please just use move without rotation.`;static MUST_CHOOSE_BLOCK_TO_ROTATE=()=>$localize`No quadrant is neutral, you must pick a quadrant to rotate.`})();class bl extends Ar{static singleton=h.empty();static get(){return bl.singleton.isAbsent()&&(bl.singleton=h.of(new bl)),bl.singleton.get()}getInitialState(){const t=rt.create(Pr.SIZE,Pr.SIZE,B.NONE);return new Pr(t,0)}static VICTORY_SOURCE=[[new _(1,0),new Gt(1,1),!1],[new _(0,1),new Gt(1,1),!1],[new _(4,0),new Gt(-1,1),!1],[new _(5,1),new Gt(-1,1),!1],[new _(1,1),new Gt(1,1),!0],[new _(4,1),new Gt(-1,1),!0],[new _(0,1),new Gt(0,1),!0],[new _(1,1),new Gt(0,1),!0],[new _(2,1),new Gt(0,1),!0],[new _(3,1),new Gt(0,1),!0],[new _(4,1),new Gt(0,1),!0],[new _(5,1),new Gt(0,1),!0],[new _(1,0),new Gt(1,0),!0],[new _(1,1),new Gt(1,0),!0],[new _(1,2),new Gt(1,0),!0],[new _(1,3),new Gt(1,0),!0],[new _(1,4),new Gt(1,0),!0],[new _(1,5),new Gt(1,0),!0]];applyLegalMove(t,e,n,i){return e.applyLegalMove(t)}isLegal(t,e){if(e.getPieceAt(t.coord).isPlayer())return w.failure(Ee.MUST_LAND_ON_EMPTY_SPACE());const n=e.applyLegalDrop(t);if(0===n.neutralBlocks.length){if(t.blockTurned.isAbsent())return w.failure(GJ.MUST_CHOOSE_BLOCK_TO_ROTATE())}else if(t.blockTurned.isPresent()){const i=t.blockTurned.get();if(n.neutralBlocks.includes(i))return w.failure(GJ.CANNOT_ROTATE_NEUTRAL_BLOCK())}return w.SUCCESS}getVictoryCoords(t){let e=[];for(const n of bl.VICTORY_SOURCE){const i=t.getPieceAt(n[0]),o=[n[0]];if(i.isPlayer()){let s=n[0].getNext(n[1]),a=!0;for(let c=0;c<3&&a;c++)t.getPieceAt(s)!==i?a=!1:(o.push(s),s=s.getNext(n[1]));if(a&&(t.getPieceAt(s)===i&&(o.push(s),e=e.concat(o)),n[2])){const c=n[0].getPrevious(n[1],1);t.getPieceAt(c)===i&&(o.push(c),e=e.concat(o))}}}return e}getGameStatus(t){const e=t.gameState,n=this.getVictoryCoords(e),i=Q3.ofValues(!1,!1);for(let o=0;o<n.length;o+=5)i.put(e.getPieceAt(n[o]),!0);return!0===i.get(O.ZERO)?!0===i.get(O.ONE)?ye.DRAW:ye.ZERO_WON:!0===i.get(O.ONE)?ye.ONE_WON:e.turn===Pr.SIZE*Pr.SIZE?ye.DRAW:ye.ONGOING}}const Fe=B.NONE,Xc=B.ZERO,f4=B.ONE;class Xze{tutorial=[W.informational($localize`Initial board`,$localize`The initial Pentago board is made of 6x6 spaces, subdivided in 4 quadrants, which can each rotate.`,bl.get().getInitialState()),W.informational($localize`Goal of the game`,$localize`The goal at Pentago is to align 5 of your pieces. In the following board, Dark wins.`,new Pr([[Xc,Fe,Fe,Xc,f4,Fe],[Xc,f4,Fe,Fe,Fe,Fe],[Xc,Fe,f4,Fe,Fe,Fe],[Xc,Fe,Fe,Fe,Fe,f4],[Xc,Fe,Fe,Fe,f4,Fe],[Fe,Fe,Fe,Fe,Fe,Fe]],10)).withPreviousMove(di.withRotation(0,0,0,!1)),W.fromPredicate($localize`Simple move`,$localize`At their turn, players put a piece on the board and possibly rotate one quadrant. As long as there are neutral quadrants, i.e., quadrants that would not change after being rotated, a player may skip rotating a quadrant. To do this, you have to click on the crossed circle that appears at the center of the board when it is possible.<br/><br/>You're playing Dark, do a simple move.`,new Pr([[Fe,Fe,Fe,Fe,Fe,Fe],[Fe,Xc,Fe,Fe,f4,Fe],[Fe,Fe,Fe,Fe,Fe,Fe],[Fe,Fe,Fe,Fe,Fe,Fe],[Fe,f4,Fe,Fe,Xc,Fe],[Fe,Fe,Fe,Fe,Fe,Fe]],10),di.rotationless(2,2),(t,e,n)=>t.blockTurned.isPresent()?w.failure($localize`You have made a move with a rotation. This tutorial step is about moves without rotations!`):w.SUCCESS,pe.CONGRATULATIONS()),W.fromPredicate($localize`Move with rotation`,$localize`After putting a piece, arrows will appear on non-neutral quadrants.<br/><br/>
        You're playing Dark, place a piece on a quadrant and do a rotation!`,new Pr([[Fe,Fe,Fe,Fe,Fe,Fe],[Fe,Xc,Fe,Fe,f4,Fe],[Fe,Fe,Fe,Fe,Fe,Fe],[Fe,Fe,Fe,Fe,Fe,Fe],[Fe,f4,Fe,Fe,Xc,Fe],[Fe,Fe,Fe,Fe,Fe,Fe]],10),di.withRotation(0,0,0,!0),(t,e,n)=>t.blockTurned.isPresent()?w.SUCCESS:w.failure($localize`You made a move without rotation, try again!`),$localize`Congratulations! Note that if all quadrants are neutral after you have put your piece, there will be no rotation.`)]}class Dd extends B1{captures;constructor(t,e,n){super(t,n),this.captures=e}}class Os extends Da{static RULES_CONFIG_DESCRIPTION=new fo({name:()=>$localize`Default`,config:{width:new _1(19,Gi.WIDTH,m1.range(1,99)),height:new _1(19,Gi.HEIGHT,m1.range(1,99)),capturesNeededToWin:new _1(10,()=>$localize`Captured stones needed to win`,m1.range(1,123456)),nInARow:new _1(5,()=>$localize`Number of aligned pieces needed to win`,m1.range(3,99)),sizeOfSandwich:new _1(2,()=>$localize`Size of captures`,m1.range(1,99))}});static singleton=h.empty();static get(){return Os.singleton.isAbsent()&&(Os.singleton=h.of(new Os)),Os.singleton.get()}getInitialState(t){const e=t.get(),n=rt.create(e.width,e.height,B.NONE),i=Math.floor(e.width/2);return n[Math.floor(e.height/2)][i]=B.ONE,new Dd(n,we.of(0,0),0)}getRulesConfigDescription(){return h.of(Os.RULES_CONFIG_DESCRIPTION)}isLegal(t,e){return!1===e.isOnBoard(t.coord)?w.failure(uo.OUT_OF_RANGE(t.coord)):e.getPieceAt(t.coord).isPlayer()?w.failure(Ee.MUST_CLICK_ON_EMPTY_SQUARE()):w.SUCCESS}applyLegalMove(t,e,n,i){const o=e.getCurrentPlayer(),s=e.getCopiedBoard();s[t.coord.y][t.coord.x]=o;const a=this.getCaptures(t.coord,e,n.get(),o);for(const l of a)s[l.y][l.x]=B.NONE;const c=e.captures.getCopy();return c.add(o,a.length),new Dd(s,c,e.turn+1)}getCaptures(t,e,n,i){const o=i.getOpponent(),s=[],a=n.sizeOfSandwich;for(const c of me.factory.all){let l=1,u=t.getNext(c,l);const f=[u];for(;e.has(u,o)&&l<a;)l++,u=u.getNext(c,1),f.push(u);const g=t.getNext(c,a+1);e.has(u,o)&&l===a&&e.has(g,i)&&s.push(...f)}return s}getGameStatus(t,e){const n=t.gameState,i=n.getCurrentOpponent();return e.get().capturesNeededToWin<=n.captures.get(i)||this.getHelper(e).getVictoriousCoord(n).length>0?ye.getVictory(i):this.stillHaveEmptySquare(n)?ye.ONGOING:ye.DRAW}getHelper(t){if(t.isPresent())return new a0(L.identity,t.get().nInARow);{const e=Os.RULES_CONFIG_DESCRIPTION.getDefaultConfig().config;return new a0(L.identity,e.nInARow)}}stillHaveEmptySquare(t){const e=t.getWidth(),n=t.getHeight();for(let i=0;i<n;i++)for(let o=0;o<e;o++)if(t.board[i][o]===B.NONE)return!0;return!1}}class ca extends Nr{static encoder=Nr.getEncoder(ca.of);static of(t){return new ca(t.x,t.y)}constructor(t,e){super(t,e)}toString(){return`PenteMove(${this.coord.x}, ${this.coord.y})`}}class BJ extends Kn{getListMoves(t,e){const i=[];return t.gameState.forEachCoord((o,s)=>{!1===s.isPlayer()&&i.push(ca.of(o))}),i}}class Qze extends Ha{getBoardValue(t,e){return Os.get().getHelper(e).getBoardValue(t.gameState)}}function Jze(r,t){if(1&r&&(I(),V(0,"circle",6)),2&r){const e=p().$implicit,n=p();ve("id","piece_",e.coord.x,"_",e.coord.y,""),v("ngClass",n.getSpaceClass(e.coord)),A("cx",.5*n.SPACE_SIZE+n.SPACE_SIZE*e.coord.x)("cy",.5*n.SPACE_SIZE+n.SPACE_SIZE*e.coord.y)("r",.44*n.SPACE_SIZE)}}function eDe(r,t){if(1&r){const e=he();I(),E(0,"g",4),q("click",function(){const o=te(e).$implicit;return ne(p().onClick(o.coord))}),z(1,Jze,1,6,"circle",5),P()}if(2&r){const e=t.$implicit;ve("id","click_",e.coord.x,"_",e.coord.y,""),m(),v("ngIf",e.content.isPlayer())}}function tDe(r,t){if(1&r){const e=he();I(),E(0,"circle",7),q("click",function(){const o=te(e).$implicit;return ne(p().onClick(o))}),P()}if(2&r){const e=t.$implicit,n=p();ve("id","capture_",e.x,"_",e.y,""),A("cx",.5*n.SPACE_SIZE+n.SPACE_SIZE*e.x)("cy",.5*n.SPACE_SIZE+n.SPACE_SIZE*e.y)("r",.14*n.SPACE_SIZE)}}let $J=(()=>{class r extends NI{lastMoved=h.empty();victoryCoords=[];captured=[];constructor(e){super(e),this.setRulesAndNode("Pente"),this.availableAIs=[new fn($localize`Alignment`,this.rules,new Qze,new BJ),new zn($localize`MCTS`,new BJ,this.rules)],this.encoder=ca.encoder,this.scores=h.of(we.of(0,0))}updateBoard(e){var n=this;return M(function*(){const i=n.getState();n.board=i.board,n.scores=h.of(n.getState().captures);const o=n.getConfig();n.victoryCoords=n.rules.getHelper(o).getVictoriousCoord(i),n.createHoshis()})()}showLastMove(e){var n=this;return M(function*(){n.lastMoved=h.of(e.coord);const i=n.getCurrentOpponent();n.captured=Os.get().getCaptures(e.coord,n.getPreviousState(),n.getConfig().get(),i)})()}hideLastMove(){this.captured=[],this.lastMoved=h.empty()}onClick(e){var n=this;return M(function*(){const i=yield n.canUserPlay("#click_"+e.x+"_"+e.y);return i.isFailure()?n.cancelMove(i.getReason()):n.chooseMove(ca.of(e))})()}getSpaceClass(e){const n=this.getState().getPieceAt(e),i=[];return i.push(this.getPlayerClass(n)),this.victoryCoords.some(o=>o.equals(e))&&i.push("victory-stroke"),this.lastMoved.equalsValue(e)&&i.push("last-move-stroke"),i}static \u0275fac=function(n){return new(n||r)(G(Ut))};static \u0275cmp=Ue({type:r,selectors:[["app-new-game"]],features:[$e],decls:4,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["app-blank-goban","",3,"width","height","clickCallBack"],[3,"id","click",4,"ngFor","ngForOf"],["class","captured-fill",3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["class","base",3,"id","ngClass",4,"ngIf"],[1,"base",3,"id","ngClass"],[1,"captured-fill",3,"id","click"]],template:function(n,i){1&n&&(I(),E(0,"svg",0)(1,"g",1),q("clickCallBack",function(s){return i.onClick(s)}),P(),z(2,eDe,2,3,"g",2)(3,tDe,1,5,"circle",3),P()),2&n&&(A("viewBox",i.getViewBox().toSVGString()),m(),v("width",i.getState().getWidth())("height",i.getState().getHeight()),m(),v("ngForOf",i.getState().getCoordsAndContents()),m(),v("ngForOf",i.captured))},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}return r})();const d=B.NONE,Qc=B.ZERO,Za=B.ONE,WJ=Os.get().getDefaultRulesConfig();class nDe extends Wn{tutorial=[W.informational($localize`Initial board and object of the game`,$localize`Pente is played on a 19x19 board, on which the pieces are put on the intersections of the squares. The object of the game is to align 5 of your pieces, or to capture 10 pieces of your opponent. Initially, a piece of the second player is in the center location of the board.`,Os.get().getInitialState(WJ)),W.anyMove($localize`Dropping a piece`,$localize`At your turn, you must drop one piece on any empty space of the board. There is no other restriction.<br/><br/>You're playing Dark, put a piece on the board.`,Os.get().getInitialState(WJ),ca.of(new _(9,8)),pe.CONGRATULATIONS()),W.fromMove($localize`Captures`,$localize`You can capture exactly two pieces of your opponent by sandwiching them between two of your pieces.<br/><br/>You're playing Light and you can capture, do it!`,new Dd([[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,Qc,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,Za,Qc,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,Za,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d]],we.of(0,0),3),[ca.of(new _(9,6))],pe.CONGRATULATIONS(),pe.FAILED_TRY_AGAIN()),W.fromMove($localize`Placing in a sandwich position`,$localize`You can safely place a piece next to another of your piece in what would look like a sandwich from the opponent's pieces. This is a safe move.<br/><br/>You're playing Light and have the opportunity to do such a move here, do it!`,new Dd([[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,Za,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,Za,Qc,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,Za,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d]],we.of(0,0),4),[ca.of(new _(9,7))],pe.CONGRATULATIONS(),pe.FAILED_TRY_AGAIN()),W.fromMove($localize`Victory`,$localize`Remember, to win you can either align 5 or your pieces, or capture 10 pieces of your opponent. Here, as Light, you have already captured 8 pieces and you only need two more to win.<br/><br/>You're playing Light, you can win in two ways. Win!`,new Dd([[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,Za,d,d,Qc,Qc,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,Qc,d,Qc,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,Za,Qc,Qc,Qc,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,Za,Za,Za,Za,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d]],we.of(8,8),7),[ca.of(new _(9,6)),ca.of(new _(8,9)),ca.of(new _(13,9))],pe.CONGRATULATIONS(),pe.FAILED_TRY_AGAIN())]}class Vd extends _{z;static getCoord3DEncoder(t){return ke.tuple([ke.identity(),ke.identity(),ke.identity()],e=>[e.x,e.y,e.z],e=>t(e[0],e[1],e[2]))}static of(t,e,n){return new Vd(t,e,n)}constructor(t,e,n){super(t,e),this.z=n}toString(){return"Coord3D"+this.toShortString()}toShortString(){return"("+this.x+", "+this.y+", "+this.z+")"}equals(t){return this===t||t.x===this.x&&t.y===this.y&&t.z===this.z}isHigherThan(t){return this.z>t.z}}class En extends Vd{static coordEncoder=Vd.getCoord3DEncoder(En.of);static optionalEncoder=h.getEncoder(En.coordEncoder);static of(t,e,n){return new En(t,e,n)}constructor(t,e,n){super(t,e,n),L.assert(0<=t&&t<=3,`PylosCoord: Invalid X: ${t}.`),L.assert(0<=e&&e<=3,`PylosCoord: Invalid Y: ${e}.`),L.assert(0<=n&&n<=3,`PylosCoord: Invalid Z: ${n}.`);const i=4-n;L.assert(this.isInRange(i,i),this.toString()+" is not in range.")}toString(){return"PylosCoord"+this.toShortString()}getLowerPieces(){if(0===this.z)throw new Error("PylosCoord: floor pieces don't have lower pieces.");const t=this.z-1;return[new En(this.x,this.y,t),new En(this.x+1,this.y,t),new En(this.x,this.y+1,t),new En(this.x+1,this.y+1,t)]}getHigherCoords(){if(3===this.z)throw new Error("Top piece don't have lower pieces.");const t=this.z+1,e=new _(this.x-1,this.y-1),n=new _(this.x,this.y-1),i=new _(this.x-1,this.y),o=new _(this.x,this.y),s=4-t;return[e,n,i,o].filter(a=>a.isInRange(s,s)).map(a=>new En(a.x,a.y,t))}getNextValid(t){const e=new _(this.x,this.y).getNext(t),n=4-this.z;return e.isNotInRange(n,n)?h.empty():h.of(new En(e.x,e.y,this.z))}}let Al=(()=>class r{static MUST_MOVE_UPWARD=()=>$localize`You must move your pieces upward.`;static SHOULD_HAVE_SUPPORTING_PIECES=()=>$localize`Your piece must land on the board or on 4 other pieces.`;static CANNOT_MOVE_SUPPORTING_PIECE=()=>$localize`You cannot move a supporting piece.`;static CANNOT_CAPTURE=()=>$localize`You cannot capture.`;static INVALID_FIRST_CAPTURE=()=>$localize`Your first capture is invalid.`;static INVALID_SECOND_CAPTURE=()=>$localize`Your second capture is invalid.`})(),qJ=(()=>class r{static MUST_CAPTURE_MAXIMUM_TWO_PIECES=()=>$localize`You must capture one or two pieces, not more.`})();class xr extends h2{startingCoord;landingCoord;firstCapture;secondCapture;static encoder=ke.tuple([En.optionalEncoder,En.coordEncoder,En.optionalEncoder,En.optionalEncoder],t=>[t.startingCoord,t.landingCoord,t.firstCapture,t.secondCapture],t=>xr.of(t[0],t[1],t[2],t[3]));static ofClimb(t,e,n){const i=h.of(t),o=xr.checkCaptures(n),s=new xr(i,e,o.firstCapture,o.secondCapture);return L.assert(e.isHigherThan(t),Al.MUST_MOVE_UPWARD()),s}static checkCaptures(t){let e=h.empty(),n=h.empty();if(t.length>0&&(e=h.of(t[0]),t.length>1)){if(t[1].equals(t[0]))throw new Error("PylosMove: should not capture twice same piece.");if(n=h.of(t[1]),t[1].isHigherThan(t[0])&&(e=h.of(t[1]),n=h.of(t[0])),t.length>2)throw new Error(qJ.MUST_CAPTURE_MAXIMUM_TWO_PIECES())}return{firstCapture:e,secondCapture:n}}static ofDrop(t,e){const n=h.empty(),i=xr.checkCaptures(e);return new xr(n,t,i.firstCapture,i.secondCapture)}static changeCapture(t,e){const n=xr.checkCaptures(e);return new xr(t.startingCoord,t.landingCoord,n.firstCapture,n.secondCapture)}static of(t,e,n,i){return new xr(t,e,n,i)}constructor(t,e,n,i){super(),this.startingCoord=t,this.landingCoord=e,this.firstCapture=n,this.secondCapture=i}isClimb(){return this.startingCoord.isPresent()}toString(){const t=this.startingCoord.isAbsent()?"-":this.startingCoord.get().toShortString(),e=this.firstCapture.isAbsent()?"-":this.firstCapture.get().toShortString(),n=this.secondCapture.isAbsent()?"-":this.secondCapture.get().toShortString();return"PylosMove("+t+", "+this.landingCoord.toShortString()+", "+e+", "+n+")"}equals(t){return t===this||!(!1===this.startingCoord.equals(t.startingCoord)||!1===this.landingCoord.equals(t.landingCoord)||!1===this.firstCapture.equals(t.firstCapture)||!1===this.secondCapture.equals(t.secondCapture))}}class Nl extends PC{boards;static getLevelRange(t){switch(t){case 0:return[0,1,2,3];case 1:return[0,1,2];default:return L.expectToBe(t,2),[0,1]}}constructor(t,e){super(e),this.boards=t}getPieceAt(t){return this.boards[t.z][t.y][t.x]}applyLegalMove(t,e=!0){const n=[];let i;return n.push({coord:t.landingCoord,value:this.getCurrentPlayer()}),t.startingCoord.isPresent()&&n.push({coord:t.startingCoord.get(),value:B.NONE}),t.firstCapture.isPresent()&&n.push({coord:t.firstCapture.get(),value:B.NONE}),t.secondCapture.isPresent()&&n.push({coord:t.secondCapture.get(),value:B.NONE}),i=e?this.turn+1:this.turn,this.setBoardAtCoords(n,i)}setBoardAtCoords(t,e){const n=[rt.copy(this.boards[0]),rt.copy(this.boards[1]),rt.copy(this.boards[2]),rt.copy(this.boards[3])];for(const i of t){const o=i.coord;n[o.z][o.y][o.x]=i.value}return new Nl(n,e)}isLandable(t){if(this.getPieceAt(t).isPlayer())return!1;if(0===t.z)return!0;const e=t.getLowerPieces();for(const n of e)if(this.getPieceAt(n)===B.NONE)return!1;return!0}isSupporting(t){if(3===t.z)return!1;const e=t.getHigherCoords();for(const n of e)if(this.getPieceAt(n).isPlayer())return!0;return!1}getPiecesRepartition(){const t=we.of(0,0);for(let e=0;e<3;e++)for(let n=0;n<4-e;n++)for(let i=0;i<4-e;i++){const o=new En(i,n,e),s=this.getPieceAt(o);s.isPlayer()&&t.add(s,1)}return t}removePieceAt(t){return this.setBoardAtCoords([{coord:t,value:B.NONE}],this.turn)}dropCurrentPlayersPieceAt(t){const e={coord:t,value:this.getCurrentPlayer()};return this.setBoardAtCoords([e],this.turn)}getFreeToMoves(){const t=[],e=this.getCurrentPlayer();for(let n=0;n<=2;n++){const i=Nl.getLevelRange(n);for(const o of i)for(const s of i){const a=new En(s,o,n);this.getPieceAt(a).equals(e)&&!1===this.isSupporting(a)&&t.push(a)}}return t}}class Yi extends Ar{static singleton=h.empty();static get(){return Yi.singleton.isAbsent()&&(Yi.singleton=h.of(new Yi)),Yi.singleton.get()}getInitialState(){const t=rt.create(4,4,B.NONE),e=rt.create(3,3,B.NONE),n=rt.create(2,2,B.NONE);return new Nl([t,e,n,[[B.NONE]]],0)}static getStateInfo(t){const e=[],n=[];for(let i=0;i<3;i++)for(let o=0;o<4-i;o++)for(let s=0;s<4-i;s++){const a=new En(s,o,i);t.getPieceAt(a)===t.getCurrentPlayer()&&!1===t.isSupporting(a)&&e.push(a),t.isLandable(a)&&n.push(a)}return{freeToMove:e,landable:n}}static getClimbingMoves(t){const e=[];for(const n of t.freeToMove)for(const i of t.landable)if(i.isHigherThan(n)&&!1===i.getLowerPieces().some(o=>n.equals(o))){const o=xr.ofClimb(n,i,[]);e.push(o)}return e}static getDropMoves(t){const e=[];for(const n of t.landable){const i=xr.ofDrop(n,[]);e.push(i)}return e}static canCapture(t,e){const n=t.getCurrentPlayer();for(const i of[Ie.UP,Ie.DOWN]){const o=e.getNextValid(i);if(o.isPresent()&&t.getPieceAt(o.get())===n)for(const s of[Ie.LEFT,Ie.RIGHT]){const a=o.get().getNextValid(s);if(a.isPresent()&&t.getPieceAt(a.get())===n){const c=i.getOpposite(),l=a.get().getNextValid(c).get();if(t.getPieceAt(l)===n)return!0}}}return!1}static getPossibleCaptures(t){const e=new st,n=t.getFreeToMoves();for(const i of n){e.add(new st([i]));const s=t.removePieceAt(i).getFreeToMoves();for(const a of s){const c=new st([i,a]);e.add(c)}}return e}static isValidCapture(t,e,n){const i=t.getCurrentPlayer();return(!1!==n.equals(e.landingCoord)||t.getPieceAt(n)===i)&&0===n.getHigherCoords().filter(s=>t.getPieceAt(s).isPlayer()&&!1===s.equals(e.firstCapture.get())).length}static getGameStatus(t){const e=t.gameState.getPiecesRepartition();return 15===e.get(O.ZERO)?ye.ONE_WON:15===e.get(O.ONE)?ye.ZERO_WON:ye.ONGOING}applyLegalMove(t,e,n,i){return e.applyLegalMove(t)}isLegal(t,e){const n=this.isLegalStartingCoord(t,e);if(n.isFailure())return n.toOtherFallible();const i=n.get(),o=this.isLegalLandingCoord(t,i);if(o.isFailure())return o.toOtherFallible();const s=o.get(),a=this.isLegalCaptures(t,s);return a.isFailure()?a:w.SUCCESS}isLegalStartingCoord(t,e){const n=e.getCurrentOpponent();if(t.startingCoord.isPresent()){const i=t.startingCoord.get(),o=e.getPieceAt(i);if(o===n)return X.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT());if(o===B.NONE)return X.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(0===i.getHigherCoords().filter(a=>e.getPieceAt(a).isPlayer()).length){const a=e.removePieceAt(t.startingCoord.get());return X.success(a)}return X.failure(Al.CANNOT_MOVE_SUPPORTING_PIECE())}return X.success(e)}isLegalLandingCoord(t,e){return e.getPieceAt(t.landingCoord).isPlayer()?X.failure(Ee.MUST_LAND_ON_EMPTY_SPACE()):e.isLandable(t.landingCoord)?X.success(e.dropCurrentPlayersPieceAt(t.landingCoord)):X.failure(Al.SHOULD_HAVE_SUPPORTING_PIECES())}isLegalCaptures(t,e){if(t.firstCapture.isAbsent())return w.SUCCESS;if(!1===Yi.canCapture(e,t.landingCoord))return w.failure(Al.CANNOT_CAPTURE());if(Yi.isValidCapture(e,t,t.firstCapture.get())){const n=e.removePieceAt(t.firstCapture.get());return t.secondCapture.isAbsent()||Yi.isValidCapture(n,t,t.secondCapture.get())?w.SUCCESS:w.failure(Al.INVALID_SECOND_CAPTURE())}return w.failure(Al.INVALID_FIRST_CAPTURE())}getGameStatus(t){return Yi.getGameStatus(t)}}class jJ extends Kn{getListMoves(t,e){const n=t.gameState,i=[],o=Yi.getStateInfo(n),s=Yi.getClimbingMoves(o),a=Yi.getDropMoves(o),c=s.concat(a);for(const l of c){const u=n.applyLegalMove(l,!1);let f=new st;Yi.canCapture(u,l.landingCoord)?f=Yi.getPossibleCaptures(u):i.push(l);for(const g of f){const y=xr.changeCapture(l,g.toList());i.push(y)}}return i}}class rDe extends jJ{getListMoves(t,e){const n=super.getListMoves(t,e);return this.orderMoves(n)}orderMoves(t){return t.sort((e,n)=>{const i=12*this.countStoneUsed(e),o=12*this.countStoneUsed(n);return i+this.sumMoveEmplacementByValue(e)-(o+this.sumMoveEmplacementByValue(n))})}countStoneUsed(t){let e=t.isClimb()?0:1;return t.firstCapture.isPresent()&&(e-=1,t.secondCapture.isPresent()&&(e-=1)),e}sumMoveEmplacementByValue(t){let e=t.landingCoord.z;return t.startingCoord.isPresent()&&(e+=3-t.startingCoord.get().z),t.firstCapture.isPresent()&&(e+=3-t.firstCapture.get().z,t.secondCapture.isPresent()&&(e+=3-t.secondCapture.get().z)),e}}class iDe extends rr{getMetrics(t,e){return t.gameState.getPiecesRepartition().toTable()}}function oDe(r,t){if(1&r&&(I(),V(0,"circle",8)),2&r){const e=t.$implicit,n=p().$implicit,i=p();ve("id","piece_",n.getValue(),"_",e,""),v("ngClass",i.getPlayerClass(n)),A("cx",i.SPACE_SIZE/4+e/15*(i.boardWidth-i.SPACE_SIZE/4))("cy",i.getPiecesCyForPlayer(n))("r",i.SPACE_SIZE/4-i.STROKE_WIDTH)}}function sDe(r,t){if(1&r&&(I(),E(0,"g"),z(1,oDe,1,6,"circle",7),P()),2&r){const e=t.$implicit,n=p();m(),v("ngForOf",n.getPlayerSidePieces(e))}}function aDe(r,t){if(1&r){const e=he();I(),E(0,"circle",12),q("click",function(){te(e);const i=p(2).$implicit,o=p().$implicit,s=p().$implicit;return ne(p().onPieceClick(i,o,s))}),P()}if(2&r){const e=p(2).$implicit,n=p().$implicit,i=p().$implicit,o=p();Ur("id","piece_",e,"_",n,"_",i,""),v("ngClass",o.getPieceClasses(e,n,i)),A("r",o.getPieceRadius(i)-o.STROKE_WIDTH)("cx",o.getPieceCx(e,n,i))("cy",o.getPieceCy(e,n,i))}}function cDe(r,t){if(1&r){const e=he();I(),E(0,"rect",12),q("click",function(){te(e);const i=p(3).$implicit,o=p().$implicit,s=p().$implicit;return ne(p().onDrop(i,o,s))}),P()}if(2&r){const e=p(3).$implicit,n=p().$implicit,i=p().$implicit,o=p();Ur("id","drop_",e,"_",n,"_",i,""),v("ngClass",o.getSquareClasses(e,n,i)),A("width",2*o.getPieceRadius(i))("height",2*o.getPieceRadius(i))("x",o.getPieceCx(e,n,i)-o.getPieceRadius(i))("y",o.getPieceCy(e,n,i)-o.getPieceRadius(i))}}function lDe(r,t){if(1&r&&(I(),z(0,cDe,1,8,"rect",13)),2&r){const e=p(2).$implicit,n=p().$implicit,i=p().$implicit;v("ngIf",p().mustDisplayLandingCoord(e,n,i))}}function uDe(r,t){if(1&r&&(I(),jt(0),z(1,aDe,1,7,"circle",10)(2,lDe,1,1,"ng-template",null,11,In),Zt()),2&r){const e=wn(3),n=p().$implicit,i=p().$implicit,o=p().$implicit,s=p();m(),v("ngIf",s.isOccupied(n,i,o))("ngIfElse",e)}}function fDe(r,t){if(1&r&&(I(),E(0,"g"),z(1,uDe,4,2,"ng-container",9),P()),2&r){const e=t.$implicit,n=p().$implicit,i=p().$implicit,o=p();m(),v("ngIf",o.mustDraw(e,n,i))}}function dDe(r,t){if(1&r&&(I(),E(0,"g"),z(1,fDe,2,1,"g",1),P()),2&r){const e=p().$implicit,n=p();m(),v("ngForOf",n.getLevelRange(e))}}function hDe(r,t){if(1&r&&(I(),E(0,"g"),z(1,dDe,2,1,"g",1),P()),2&r){const e=t.$implicit,n=p();m(),v("ngForOf",n.getLevelRange(e))}}function gDe(r,t){if(1&r&&(I(),V(0,"rect",14)),2&r){const e=p();Ur("id","highCapture_",e.highCapture.get().x,"_",e.highCapture.get().y,"_",e.highCapture.get().z,""),A("width",2*e.getPieceRadius(e.highCapture.get().z))("height",2*e.getPieceRadius(e.highCapture.get().z))("x",e.getPieceCxByCoord(e.highCapture.get())-e.getPieceRadius(e.highCapture.get().z))("y",e.getPieceCyByCoord(e.highCapture.get())-e.getPieceRadius(e.highCapture.get().z))}}function pDe(r,t){if(1&r){const e=he();I(),E(0,"g",15),q("click",function(){return te(e),ne(p().validateCapture())}),V(1,"circle",16)(2,"polygon",17),P()}if(2&r){const e=p();A("transform","translate("+4*e.SPACE_SIZE+" "+4*e.SPACE_SIZE+")"),m(),v("ngClass",e.getCaptureValidationButtonClasses()),A("cx",e.STROKE_WIDTH/2)("cy",e.STROKE_WIDTH/2)("r",e.SPACE_SIZE/2)}}function mDe(r,t){if(1&r){const e=he();I(),E(0,"g",18),q("click",function(){const o=te(e).$implicit;return ne(p().onPieceClick(o.x,o.y,o.z))}),V(1,"line",19)(2,"line",19),P()}if(2&r){const e=t.$implicit,n=p();Ur("id","capturable_",e.x,"_",e.y,"_",e.z,""),A("transform","translate("+n.getPieceCxByCoord(e)+" "+n.getPieceCyByCoord(e)+")"),m(),A("x1",-.25*n.getPieceRadius(e.z))("y1",-.25*n.getPieceRadius(e.z))("x2",.25*n.getPieceRadius(e.z))("y2",.25*n.getPieceRadius(e.z)),m(),A("x1",.25*n.getPieceRadius(e.z))("y1",-.25*n.getPieceRadius(e.z))("x2",-.25*n.getPieceRadius(e.z))("y2",.25*n.getPieceRadius(e.z))}}const _De=()=>[0,1,2];let CDe=(()=>{class r extends Fc{boardWidth=4*this.SPACE_SIZE+this.STROKE_WIDTH;pieceRowHeight=this.SPACE_SIZE/2;boardHeight=this.boardWidth+2*this.pieceRowHeight;state;constructedState;lastLandingCoord=h.empty();lastStartingCoord=h.empty();lastFirstCapture=h.empty();lastSecondCapture=h.empty();highCapture=h.empty();capturables=[];chosenStartingCoord=h.empty();chosenLandingCoord=h.empty();chosenFirstCapture=h.empty();chosenSecondCapture=h.empty();captured=[];lastMoved=[];remainingPieces=we.of(15,15);constructor(e){super(e),this.setRulesAndNode("Pylos"),this.availableAIs=[new fn($localize`Minimax`,this.rules,new iDe,new rDe),new zn($localize`MCTS`,new jJ,this.rules)],this.encoder=xr.encoder,this.hasAsymmetricBoard=!0}getPiecesCyForPlayer(e){return e===O.ONE?this.pieceRowHeight/2:this.boardWidth+1.5*this.pieceRowHeight}getLevelRange(e){return Nl.getLevelRange(e)}mustDraw(e,n,i){const o=new En(e,n,i);return!!(this.constructedState.getPieceAt(o).isPlayer()||this.justClimbed(o)||this.isCaptured(o))||this.chosenLandingCoord.isAbsent()&&this.constructedState.isLandable(o)}isCaptured(e){return this.chosenFirstCapture.equalsValue(e)||this.chosenSecondCapture.equalsValue(e)}onPieceClick(e,n,i){var o=this;return M(function*(){const s=yield o.canUserPlay("#piece_"+e+"_"+n+"_"+i);if(s.isFailure())return o.cancelMove(s.getReason());const a=new En(e,n,i);return o.state.getPieceAt(a)===o.state.getCurrentOpponent()?o.cancelMove(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT()):o.chosenStartingCoord.equalsValue(a)?(o.cancelMoveAttempt(),w.SUCCESS):o.chosenLandingCoord.isPresent()?o.isSupporting(a,o.constructedState)?o.cancelMove(Al.CANNOT_MOVE_SUPPORTING_PIECE()):o.onCaptureClick(a):o.isSupporting(a,o.getState())?o.cancelMove(Al.CANNOT_MOVE_SUPPORTING_PIECE()):o.onClimbClick(a)})()}isSupporting(e,n){return n.isSupporting(e)}onClimbClick(e){var n=this;return M(function*(){return n.chosenStartingCoord=h.of(e),n.constructedState=n.constructedState.removePieceAt(e),w.SUCCESS})()}onCaptureClick(e){var n=this;return M(function*(){return n.chosenFirstCapture.equalsValue(e)?(n.chosenFirstCapture=h.empty(),n.constructedState=n.constructedState.dropCurrentPlayersPieceAt(e),n.updateCapturableList(),w.SUCCESS):n.chosenSecondCapture.equalsValue(e)?(n.chosenSecondCapture=h.empty(),n.constructedState=n.constructedState.dropCurrentPlayersPieceAt(e),n.updateCapturableList(),w.SUCCESS):n.chosenFirstCapture.isAbsent()?(n.chosenFirstCapture=h.of(e),n.constructedState=n.constructedState.removePieceAt(e),n.updateCapturableList(),w.SUCCESS):n.chosenSecondCapture.isAbsent()?(n.chosenSecondCapture=h.of(e),n.constructedState=n.constructedState.removePieceAt(e),n.updateCapturableList(),w.SUCCESS):n.cancelMove(qJ.MUST_CAPTURE_MAXIMUM_TWO_PIECES())})()}updateCapturableList(){this.capturables=this.constructedState.getFreeToMoves()}getCaptureValidationButtonClasses(){return this.chosenFirstCapture.isPresent()||this.chosenSecondCapture.isPresent()?"":"semi-transparent"}validateCapture(){var e=this;return M(function*(){const n=yield e.canUserPlay("#capture_validation");return n.isFailure()?e.cancelMove(n.getReason()):e.chosenFirstCapture.isAbsent()&&e.chosenSecondCapture.isAbsent()?w.SUCCESS:e.chosenFirstCapture.isPresent()&&e.chosenSecondCapture.isAbsent()?e.concludeMoveWithCapture([e.chosenFirstCapture.get()]):e.chosenFirstCapture.isAbsent()&&e.chosenSecondCapture.isPresent()?e.concludeMoveWithCapture([e.chosenSecondCapture.get()]):e.concludeMoveWithCapture([e.chosenFirstCapture.get(),e.chosenSecondCapture.get()])})()}concludeMoveWithCapture(e){var n=this;return M(function*(){if(n.chosenStartingCoord.isAbsent()){const i=xr.ofDrop(n.chosenLandingCoord.get(),e);return n.chooseMove(i)}{const i=xr.ofClimb(n.chosenStartingCoord.get(),n.chosenLandingCoord.get(),e);return n.chooseMove(i)}})()}cancelMoveAttempt(){this.constructedState=this.state,this.chosenStartingCoord=h.empty(),this.chosenLandingCoord=h.empty(),this.chosenFirstCapture=h.empty(),this.chosenSecondCapture=h.empty(),this.capturables=[]}onDrop(e,n,i){var o=this;return M(function*(){const s=yield o.canUserPlay("#drop_"+e+"_"+n+"_"+i);if(s.isFailure())return o.cancelMove(s.getReason());const a=new En(e,n,i);return Yi.canCapture(o.constructedState,a)?(o.chosenLandingCoord=h.of(a),o.constructedState=o.constructedState.dropCurrentPlayersPieceAt(a),o.updateCapturableList(),w.SUCCESS):(o.chosenLandingCoord=h.of(a),o.concludeMoveWithCapture([]))})()}getSquareClasses(e,n,i){const o=new En(e,n,i);return this.captured.some(s=>s.equalsValue(o))?["captured-fill"]:this.lastMoved.some(s=>s.equals(o))||this.justClimbed(o)?["moved-fill"]:[]}justClimbed(e){return this.chosenLandingCoord.isPresent()&&this.chosenStartingCoord.equalsValue(e)}getPieceRadius(e){return this.SPACE_SIZE*(.45+.025*e)}getPieceCx(e,n,i){return this.SPACE_SIZE/2+.5*i*this.SPACE_SIZE+e*this.SPACE_SIZE}getPieceCy(e,n,i){return this.SPACE_SIZE/2+.5*i*this.SPACE_SIZE+n*this.SPACE_SIZE}getPieceCxByCoord(e){return this.getPieceCx(e.x,e.y,e.z)}getPieceCyByCoord(e){return this.getPieceCy(e.x,e.y,e.z)}isOccupied(e,n,i){const o=new En(e,n,i);if(this.justClimbed(o))return!1;const s=this.getState().getPieceAt(o).isPlayer(),a=this.chosenLandingCoord.equalsValue(o);return s||a}getPieceClasses(e,n,i){const o=new En(e,n,i),s=[this.getPieceFillClass(o)];return(this.lastLandingCoord.equalsValue(o)||this.lastStartingCoord.equalsValue(o))&&s.push("last-move-stroke"),(this.chosenStartingCoord.equalsValue(o)||this.chosenLandingCoord.equalsValue(o))&&s.push("selected-stroke"),this.isCaptured(o)&&s.push("pre-captured-fill"),s}getPieceFillClass(e){return this.chosenLandingCoord.equalsValue(e)?this.getPlayerClass(this.state.getCurrentPlayer()):this.getPlayerClass(this.state.getPieceAt(e))}getPlayerSidePieces(e){const n=this.remainingPieces.get(e),i=[];for(let o=0;o<n;o++)i.push(o);return i}updateBoard(e){var n=this;return M(function*(){n.state=n.getState(),n.constructedState=n.state;const i=n.state.getPiecesRepartition();n.remainingPieces=we.of(15-i.get(O.ZERO),15-i.get(O.ONE)),n.highCapture=h.empty(),n.cancelMoveAttempt(),n.hideLastMove()})()}showLastMove(e){var n=this;return M(function*(){n.lastStartingCoord=e.startingCoord,n.lastLandingCoord=h.of(e.landingCoord),n.lastFirstCapture=e.firstCapture,n.lastSecondCapture=e.secondCapture,n.lastFirstCapture.isPresent()&&!1===n.mustDrawCoord(n.lastFirstCapture.get())&&(n.highCapture=n.lastFirstCapture),n.captured=[e.firstCapture,e.secondCapture],n.lastMoved=[e.landingCoord],e.startingCoord.isPresent()&&n.lastMoved.push(e.startingCoord.get())})()}hideLastMove(){this.lastStartingCoord=h.empty(),this.lastLandingCoord=h.empty(),this.lastFirstCapture=h.empty(),this.lastSecondCapture=h.empty(),this.highCapture=h.empty(),this.lastMoved=[],this.captured=[]}mustDrawCoord(e){return this.mustDraw(e.x,e.y,e.z)}mustDisplayLandingCoord(e,n,i){return!this.chosenStartingCoord.isPresent()||!!this.chosenStartingCoord.get().equals(new En(e,n,i))||this.chosenStartingCoord.get().z<i}static \u0275fac=function(n){return new(n||r)(G(Ut))};static \u0275cmp=Ue({type:r,selectors:[["app-pylos"]],features:[$e],decls:10,vars:11,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["boardInItself",""],["x","0","y","0",1,"base","small-stroke"],["class","base captured-fill small-stroke",3,"id",4,"ngIf"],["id","capture_validation",3,"click",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],["class","base small-stroke",3,"id","ngClass",4,"ngFor","ngForOf"],[1,"base","small-stroke",3,"id","ngClass"],[4,"ngIf"],["class","base small-stroke",3,"id","ngClass","click",4,"ngIf","ngIfElse"],["onlyRect",""],[1,"base","small-stroke",3,"id","ngClass","click"],["class","base small-stroke",3,"id","ngClass","click",4,"ngIf"],[1,"base","captured-fill","small-stroke",3,"id"],["id","capture_validation",3,"click"],["fill","red",1,"base-no-fill","small-stroke",3,"ngClass"],["points","-32.5,-2.5 -32.5,12.5 -10,35 -2.5,35 35,-21.25 25,-21.275 -5,25 -32.5,-2.5","fill","green",1,"base-no-fill","small-stroke"],[3,"id","click"],["stroke-width","8","stroke","red"]],template:function(n,i){1&n&&(I(),E(0,"svg",0)(1,"g"),z(2,sDe,2,1,"g",1),P(),E(3,"g",null,2),V(5,"rect",3),z(6,hDe,2,1,"g",1)(7,gDe,1,7,"rect",4)(8,pDe,3,5,"g",5)(9,mDe,3,12,"g",6),P()()),2&n&&(A("viewBox","0 0 "+i.boardWidth+" "+i.boardHeight),m(),A("transform","rotate("+180*i.getPointOfView().getValue()+" "+i.boardWidth/2+" "+i.boardHeight/2+")"),m(),v("ngForOf",i.Player.PLAYERS),m(),A("transform","translate("+i.STROKE_WIDTH/2+" "+(i.STROKE_WIDTH/2+i.pieceRowHeight)+")"),m(2),A("width",4*i.SPACE_SIZE)("height",4*i.SPACE_SIZE),m(),v("ngForOf",fr(10,_De)),m(),v("ngIf",i.highCapture.isPresent()),m(),v("ngIf",i.chosenLandingCoord.isPresent()),m(),v("ngForOf",i.capturables))},dependencies:[zt,Nt,bt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}return r})();const je=B.NONE,d4=B.ZERO,ZJ=B.ONE;class vDe extends Wn{tutorial=[W.informational($localize`Goal of the game`,$localize`At Pylos, the goal is to be the last to play.
        To do this, you have to save up your pieces.
        As soon as a player puts its last piece, that player loses the game immediately.
        Here is what the initial board looks like, it is a board of 4 x 4 squares.
        This board will become a pyramid, little by little.
        It will be filled by the pieces of your stock. Each player has 15 pieces.`,Yi.get().getInitialState()),W.anyMove($localize`Dropping a piece`,$localize`When it is your turn, you can always drop one of your piece on an empty square.
        The gray squares are where you can drop your pieces.<br/><br/>
        Click on one of the squares to drop a piece there.`,Yi.get().getInitialState(),xr.ofDrop(new En(1,1,0),[]),$localize`There you go, as simple as that.`),W.fromMove($localize`Climbing`,$localize`When 4 pieces form a square, it is possible to put a fifth piece on top.
        However, when that happens, you can save a piece by climbing instead of dropping a piece.
        To climb:
        <ol>
            <li>Click on one of your free pieces, which should be lower than the landing square.</li>
            <li>Click on an empty landing square, higher than your selected piece.</li>
        </ol><br/>
        You're playing Dark, go ahead and climb!`,new Nl([[[d4,ZJ,je,je],[ZJ,d4,je,je],[je,je,je,je],[je,je,je,d4]],[[je,je,je],[je,je,je],[je,je,je]],[[je,je],[je,je]],[[je]]],0),[xr.ofClimb(new En(3,3,0),new En(0,0,1),[])],$localize`Congratulations!<br/>
        Some important notes:
        <ol>
            <li>You cannot move a piece that is directly below another one.</li>
            <li>Of course, you cannot move the opponent's pieces.</li>
            <li>You can only climb when the landing square is higher than the starting square.</li>
        </ol>`,pe.FAILED_TRY_AGAIN()),W.fromMove($localize`Square (1/2)`,$localize`When the piece you just moved or dropped is the fourth one of a square of your color,
        you can choose anywhere on the board one or two of your pieces.
        These pieces will be removed from the board, allowing you to save up one or two pieces.
        A chosen piece must not be directly below another piece.
        A chosen piece can be the piece you just placed.<br/><br/>
        You're playing Dark. Form a square, click on one of the four pieces, then click on the V symbol on the bottom right to finalize your move.`,new Nl([[[d4,d4,je,je],[je,d4,je,je],[je,je,je,je],[je,je,je,je]],[[je,je,je],[je,je,je],[je,je,je]],[[je,je],[je,je]],[[je]]],0),[xr.ofDrop(new En(0,1,0),[new En(0,0,0)]),xr.ofDrop(new En(0,1,0),[new En(0,1,0)]),xr.ofDrop(new En(0,1,0),[new En(1,0,0)]),xr.ofDrop(new En(0,1,0),[new En(1,1,0)])],$localize`Congratulations, you have saved up one piece. Note, you can cancel your selection by clicking again on the piece.`,pe.FAILED_TRY_AGAIN()),W.fromPredicate($localize`Square (2/2)`,$localize`You're playing Dark.<br/><br/>
        Do like in the previous step, but this time click on two different pieces before validating.`,new Nl([[[d4,d4,je,je],[je,d4,je,je],[je,je,je,je],[je,je,je,je]],[[je,je,je],[je,je,je],[je,je,je]],[[je,je],[je,je]],[[je]]],0),xr.ofDrop(new En(0,1,0),[new En(0,0,0),new En(1,0,0)]),(t,e,n)=>t.secondCapture.isPresent()?w.SUCCESS:t.firstCapture.isPresent()?w.failure($localize`Failed, you only captured one piece.`):w.failure(pe.YOU_DID_NOT_CAPTURE_ANY_PIECE()),$localize`Congratulations, you have saved up two pieces.`)]}class it{value;static AAAA=new it(0);static AAAB=new it(1);static AABA=new it(2);static AABB=new it(3);static ABAA=new it(4);static ABAB=new it(5);static ABBA=new it(6);static ABBB=new it(7);static BAAA=new it(8);static BAAB=new it(9);static BABA=new it(10);static BABB=new it(11);static BBAA=new it(12);static BBAB=new it(13);static BBBA=new it(14);static BBBB=new it(15);static EMPTY=new it(16);static pieces=[it.AAAA,it.AAAB,it.AABA,it.AABB,it.ABAA,it.ABAB,it.ABBA,it.ABBB,it.BAAA,it.BAAB,it.BABA,it.BABB,it.BBAA,it.BBAB,it.BBBA,it.BBBB];static encoder=ke.fromFunctions(t=>t.value,it.ofInt);static ofInt(t){if(0<=t&&t<=15)return it.pieces[t];if(16===t)return it.EMPTY;throw new Error("Invalid piece ("+t+")")}constructor(t){this.value=t}equals(t){return this===t}toString(){return"QuartoPiece("+this.value+")"}isRectangle(){return this.value%4<2}}class Jc extends Nr{piece;static encoder=ke.tuple([_.encoder,it.encoder],t=>[t.coord,t.piece],t=>new Jc(t[0].x,t[0].y,t[1]));constructor(t,e,n){super(t,e),this.piece=n}toString(){return"QuartoMove("+this.coord.x+", "+this.coord.y+", "+this.piece.value+")"}equals(t){return this===t||!1!==t.coord.equals(this.coord)&&this.piece===t.piece}}class e3 extends B1{pieceInHand;constructor(t,e,n){super(t,e),this.pieceInHand=n}static isGivable(t,e,n){return t!==n&&!1===e3.isAlreadyOnBoard(t,e)}static isAlreadyOnBoard(t,e){for(let n=0;n<4;n++)for(let i=0;i<4;i++)if(e[n][i]===t)return!0;return!1}getRemainingPieces(){const t=it.pieces,e=[];for(const n of t)e3.isGivable(n,this.board,this.pieceInHand)&&e.push(n);return e}}var c1=function(r){return r.VICTORY="VICTORY",r.PRE_VICTORY="PRE_VICTORY",r.DEFAULT="DEFAULT",r}(c1||{});let QI=(()=>class r{static MUST_GIVE_A_PIECE=()=>$localize`You must give a piece.`;static PIECE_ALREADY_ON_BOARD=()=>$localize`That piece is already on the board.`;static CANNOT_GIVE_PIECE_IN_HAND=()=>$localize`You cannot give the piece that was in your hands.`})();class Hd{subCriterion=[h.empty(),h.empty(),h.empty(),h.empty()];constructor(t){this.subCriterion[0]=h.of(8==(8&t.value)),this.subCriterion[1]=h.of(4==(4&t.value)),this.subCriterion[2]=h.of(2==(2&t.value)),this.subCriterion[3]=h.of(1==(1&t.value))}mergeWith(t){let e=4;for(let n=0;n<4;n++)!1===this.subCriterion[n].equals(t.subCriterion[n])&&(this.subCriterion[n]=h.empty()),this.subCriterion[n].isAbsent()&&e--;return e>0}mergeWithQuartoPiece(t){const e=new Hd(t);return this.mergeWith(e)}areAllAbsent(){for(let t=0;t<4;t++)if(this.subCriterion[t].isPresent())return!1;return!0}match(t){for(let e=0;e<4;e++)if(this.subCriterion[e].equals(t.subCriterion[e]))return!0;return!1}matchPiece(t){return this.match(new Hd(t))}toString(){return"Criterion{"+this.subCriterion.map(t=>t.isPresent()?t.get()?"1":"0":"x").join(" ")+"}"}}class t3{initialCoord;direction;constructor(t,e){this.initialCoord=t,this.direction=e}allCoords(){const t=[];for(let e=0;e<4;e++)t.push(this.initialCoord.getNext(this.direction,e));return t}}class Ri extends Ar{static singleton=h.empty();static get(){return Ri.singleton.isAbsent()&&(Ri.singleton=h.of(new Ri)),Ri.singleton.get()}getInitialState(){const t=rt.create(4,4,it.EMPTY);return new e3(t,0,it.AAAA)}static lines=[new t3(new _(0,0),me.DOWN),new t3(new _(1,0),me.DOWN),new t3(new _(2,0),me.DOWN),new t3(new _(3,0),me.DOWN),new t3(new _(0,0),me.RIGHT),new t3(new _(0,1),me.RIGHT),new t3(new _(0,2),me.RIGHT),new t3(new _(0,3),me.RIGHT),new t3(new _(0,0),me.DOWN_RIGHT),new t3(new _(0,3),me.UP_RIGHT)];static isOccupied(t){return t!==it.EMPTY}static isLegal(t,e){const n=t.coord.x,i=t.coord.y,o=t.piece,s=e.getCopiedBoard(),a=e.pieceInHand;return Ri.isOccupied(s[i][n])?w.failure(Ee.MUST_LAND_ON_EMPTY_SPACE()):o===it.EMPTY?15===e.turn?w.SUCCESS:w.failure(QI.MUST_GIVE_A_PIECE()):e3.isAlreadyOnBoard(o,s)?w.failure(QI.PIECE_ALREADY_ON_BOARD()):a===o?w.failure(QI.CANNOT_GIVE_PIECE_IN_HAND()):w.SUCCESS}isLegal(t,e){return Ri.isLegal(t,e)}applyLegalMove(t,e,n,i){const o=e.getCopiedBoard();return o[t.coord.y][t.coord.x]=e.pieceInHand,new e3(o,e.turn+1,t.piece)}static updateBoardStatus(t,e,n){return n.score===c1.PRE_VICTORY?this.isThereAVictoriousLine(t,e)?{score:c1.VICTORY,sensitiveSquares:new ir}:n:this.searchForVictoryOrPreVictoryInLine(t,e,n)}static isThereAVictoriousLine(t,e){let n=t.initialCoord,i=e.getPieceAt(n);const o=new Hd(i);for(let s=0;s<3&&!1!==Ri.isOccupied(i)&&!o.areAllAbsent();s++)n=n.getNext(t.direction,1),i=e.getPieceAt(n),o.mergeWithQuartoPiece(i);return!(!Ri.isOccupied(i)||!1!==o.areAllAbsent())}static searchForVictoryOrPreVictoryInLine(t,e,n){const i=Ri.getLineInfos(t,e,n);if(i.boardStatus.isPresent())return i.boardStatus.get();const o=i.commonCriterion,s=i.sensitiveCoord;if(o.isPresent()&&!1===o.get().areAllAbsent()){if(s.isAbsent())return{score:c1.VICTORY,sensitiveSquares:new ir};{o.get().matchPiece(e.pieceInHand)&&(n.score=c1.PRE_VICTORY);const a=s.get();n.sensitiveSquares.add(a)}}return n}static getLineInfos(t,e,n){let i=h.empty(),o=h.empty(),s=t.initialCoord;for(let a=0;a<4;a++){const c=e.getPieceAt(s);if(c===it.EMPTY){if(!i.isAbsent())return{sensitiveCoord:h.of(s),commonCriterion:o,boardStatus:h.of(n)};i=h.of(s)}else o.isAbsent()?(o=h.of(new Hd(c)),Ae.display("QuartoRules","getLineInfos","set commonCrit to "+o.toString())):(o.get().mergeWithQuartoPiece(c),Ae.display("QuartoRules","getLineInfos","update commonCrit: "+o.toString()));s=s.getNext(t.direction,1)}return{commonCriterion:o,sensitiveCoord:i,boardStatus:h.empty()}}static scoreToGameStatus(t,e){const n=O.of(e%2);return t===c1.VICTORY?ye.getDefeat(n):16===e?ye.DRAW:ye.ONGOING}getGameStatus(t){const e=t.gameState;let n={score:c1.DEFAULT,sensitiveSquares:new ir};for(const i of Ri.lines)if(n=Ri.updateBoardStatus(i,e,n),n.score===c1.VICTORY)return Ri.scoreToGameStatus(n.score,e.turn);return Ri.scoreToGameStatus(n.score,e.turn)}getVictoriousCoords(t){for(const e of Ri.lines)if(Ri.isThereAVictoriousLine(e,t))return e.allCoords();return[]}}class yDe extends Ha{scoreToBoardValue(t,e){if(t===c1.DEFAULT)return mn.of(0);{L.assert(t===c1.PRE_VICTORY,"QuartoHeuristic score can only be pre-victory or default");const n=O.of(e%2);return mn.of(n.getPreVictory())}}getBoardValue(t,e){const n=t.gameState;let i={score:c1.DEFAULT,sensitiveSquares:new ir};for(const o of Ri.lines)i=Ri.updateBoardStatus(o,n,i);return this.scoreToBoardValue(i.score,n.turn)}}class YJ extends Kn{getListMoves(t,e){const n=[],i=t.gameState,o=i.getCopiedBoard(),s=i.getRemainingPieces(),a=i.pieceInHand;let c;for(let l=0;l<4;l++)for(let u=0;u<4;u++)if(o[l][u]===it.EMPTY){if(c=i.getCopiedBoard(),c[l][u]=a,15===i.turn){const f=new Jc(u,l,it.EMPTY);return n.push(f),n}for(const f of s){const g=new Jc(u,l,f);n.push(g)}}return n}}function MDe(r,t){if(1&r&&(I(),V(0,"rect",13)),2&r){const e=p(2),n=e.$implicit,i=e.index,o=p().index,s=p();v("ngClass",s.getPieceClasses(n.value)),A("x",s.SPACE_SIZE*i+(s.SPACE_SIZE/2-s.getPieceSize(n.value)))("y",s.SPACE_SIZE*o+(s.SPACE_SIZE/2-s.getPieceSize(n.value)))("width",2*s.getPieceSize(n.value))("height",2*s.getPieceSize(n.value))}}function EDe(r,t){if(1&r&&(I(),V(0,"circle",13)),2&r){const e=p(2),n=e.$implicit,i=e.index,o=p().index,s=p();v("ngClass",s.getPieceClasses(n.value)),A("cx",s.SPACE_SIZE*i+s.SPACE_SIZE/2)("cy",s.SPACE_SIZE*o+s.SPACE_SIZE/2)("r",s.getPieceSize(n.value))}}function PDe(r,t){if(1&r&&(I(),V(0,"circle")),2&r){const e=p(2).index,n=p().index,i=p();A("cx",i.SPACE_SIZE*e+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("r",10)}}function SDe(r,t){if(1&r&&(I(),E(0,"g"),z(1,MDe,1,5,"rect",11)(2,EDe,1,4,"ng-template",null,12,In)(4,PDe,1,3,"circle",10),P()),2&r){const e=wn(3),n=p().$implicit,i=p(2);m(),v("ngIf",n.isRectangle())("ngIfElse",e),m(3),v("ngIf",i.pieceHasDot(n.value))}}function ODe(r,t){if(1&r){const e=he();I(),E(0,"g")(1,"rect",9),q("click",function(){const o=te(e).index,s=p().index;return ne(p().chooseCoord(o,s))}),P(),z(2,SDe,5,3,"g",10),P()}if(2&r){const e=t.$implicit,n=t.index,i=p().index,o=p();m(),ve("id","chooseCoord_",n,"_",i,""),v("ngClass",o.getSquareClasses(n,i)),A("x",o.SPACE_SIZE*n)("y",o.SPACE_SIZE*i)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),m(),v("ngIf",e!==o.EMPTY)}}function TDe(r,t){if(1&r&&(I(),E(0,"g",null,8),z(2,ODe,3,8,"g",2),P()),2&r){const e=t.$implicit;m(2),v("ngForOf",e)}}function wDe(r,t){if(1&r&&(I(),V(0,"rect",18)),2&r){const e=p(2);v("ngClass",e.getPieceClasses(e.pieceInHand.value)),A("x",e.SPACE_SIZE/2-e.getPieceSize(e.pieceInHand.value))("y",e.SPACE_SIZE/2-e.getPieceSize(e.pieceInHand.value))("width",2*e.getPieceSize(e.pieceInHand.value))("height",2*e.getPieceSize(e.pieceInHand.value))}}function bDe(r,t){if(1&r&&(I(),V(0,"circle",13)),2&r){const e=p(2);v("ngClass",e.getPieceClasses(e.pieceInHand.value)),A("cx",e.SPACE_SIZE/2)("cy",e.SPACE_SIZE/2)("r",e.getPieceSize(e.pieceInHand.value))}}function ADe(r,t){if(1&r&&(I(),V(0,"circle")),2&r){const e=p(2);A("cx",e.SPACE_SIZE/2)("cy",e.SPACE_SIZE/2)("r",10)}}function NDe(r,t){if(1&r){const e=he();I(),E(0,"g",14,15),q("click",function(){return te(e),ne(p().deselectDroppedPiece())}),V(2,"rect",16),z(3,wDe,1,5,"rect",17)(4,bDe,1,4,"ng-template",null,12,In)(6,ADe,1,3,"circle",10),P()}if(2&r){const e=wn(5),n=p();ve("id","droppedPiece_",n.chosen.get().x,"_",n.chosen.get().y,""),A("transform","translate("+n.chosen.get().x*n.SPACE_SIZE+" "+n.chosen.get().y*n.SPACE_SIZE+")"),m(2),A("width",n.SPACE_SIZE)("height",n.SPACE_SIZE),m(),v("ngIf",n.pieceInHand.isRectangle())("ngIfElse",e),m(3),v("ngIf",n.pieceHasDot(n.pieceInHand.value))}}function IDe(r,t){if(1&r&&(I(),E(0,"g",null,19),V(2,"rect",20),P()),2&r){const e=t.$implicit,n=p();m(2),A("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)("transform","translate("+e.x*n.SPACE_SIZE+" "+e.y*n.SPACE_SIZE+")")}}function kDe(r,t){if(1&r&&(I(),V(0,"rect",13)),2&r){const e=p(2);v("ngClass",e.getPieceClasses(e.pieceInHand.value)),A("x",0)("y",.75*e.SPACE_SIZE)("transform","translate("+-e.getPieceSize(e.pieceInHand.value)+", "+-e.getPieceSize(e.pieceInHand.value)+")")("width",2*e.getPieceSize(e.pieceInHand.value))("height",2*e.getPieceSize(e.pieceInHand.value))}}function RDe(r,t){if(1&r&&(I(),V(0,"circle",23)),2&r){const e=p(2);v("ngClass",e.getPieceClasses(e.pieceInHand.value)),A("cy",.75*e.SPACE_SIZE)("r",e.getPieceSize(e.pieceInHand.value))}}function xDe(r,t){1&r&&(I(),V(0,"circle",24)),2&r&&A("cy",.75*p(2).SPACE_SIZE)("r",10)}function LDe(r,t){if(1&r&&(I(),E(0,"g",21),z(1,kDe,1,6,"rect",11)(2,RDe,1,3,"ng-template",null,12,In)(4,xDe,1,2,"circle",22),P()),2&r){const e=wn(3),n=p();m(),v("ngIf",n.pieceInHand.isRectangle())("ngIfElse",e),m(3),v("ngIf",n.pieceHasDot(n.pieceInHand.value))}}function zDe(r,t){if(1&r&&(I(),V(0,"rect",29)),2&r){const e=p(2).index,n=p().index,i=p();Tn("id","chosenPiece_",4*n+e,""),A("x",i.SPACE_SIZE*e)("y",i.SPACE_SIZE*n)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)}}function DDe(r,t){if(1&r&&(I(),V(0,"rect",13)),2&r){const e=p(2).index,n=p().index,i=p();v("ngClass",i.getPieceClasses(4*n+e)),A("x",i.SPACE_SIZE*e+i.SPACE_SIZE/2-i.getPieceSize(4*n+e))("y",i.SPACE_SIZE*n+i.SPACE_SIZE/2-i.getPieceSize(4*n+e))("width",2*i.getPieceSize(4*n+e))("height",2*i.getPieceSize(4*n+e))}}function VDe(r,t){if(1&r&&(I(),V(0,"circle",13)),2&r){const e=p(2).index,n=p().index,i=p();v("ngClass",i.getPieceClasses(4*n+e)),A("cx",i.SPACE_SIZE*e+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("r",i.getPieceSize(4*n+e))}}function HDe(r,t){if(1&r&&(I(),V(0,"circle")),2&r){const e=p(2).index,n=p().index,i=p();A("cx",i.SPACE_SIZE*e+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("r",10)}}function FDe(r,t){if(1&r){const e=he();I(),E(0,"g",14),q("click",function(){te(e);const i=p().index,o=p().index;return ne(p().choosePiece(4*o+i))}),z(1,zDe,1,5,"rect",28)(2,DDe,1,5,"rect",11)(3,VDe,1,4,"ng-template",null,12,In)(5,HDe,1,3,"circle",10),P()}if(2&r){const e=wn(4),n=p().index,i=p().index,o=p();Tn("id","choosePiece_",4*i+n,""),m(),v("ngIf",o.pieceToGive.equalsValue(o.QuartoPiece.ofInt(4*i+n))),m(),v("ngIf",(4*i+n)%4<2)("ngIfElse",e),m(3),v("ngIf",o.pieceHasDot(4*i+n))}}function UDe(r,t){if(1&r&&(I(),E(0,"g"),z(1,FDe,6,5,"g",3),P()),2&r){const e=t.index,n=p().index,i=p();m(),v("ngIf",i.isRemaining(4*n+e))}}function GDe(r,t){if(1&r&&(I(),E(0,"g",null,25),V(2,"rect",26,27),z(4,UDe,2,1,"g",2),P()),2&r){const e=t.$implicit,n=p();A("transform","translate(0 "+6.5*n.SPACE_SIZE+")"),m(2),A("x",-.125*n.SPACE_SIZE)("y",-.125*n.SPACE_SIZE)("width",4.25*n.SPACE_SIZE)("height",4.25*n.SPACE_SIZE),m(2),v("ngForOf",e)}}let BDe=(()=>{class r extends p2{EMPTY=it.EMPTY;QuartoPiece=it;chosen=h.empty();lastMove=h.empty();pieceInHand=it.EMPTY;pieceToGive=h.empty();victoriousCoords=[];constructor(e){super(e),this.setRulesAndNode("Quarto"),this.availableAIs=[new fn($localize`Minimax`,this.rules,new yDe,new YJ),new zn($localize`MCTS`,new YJ,this.rules)],this.encoder=Jc.encoder,this.pieceInHand=this.getState().pieceInHand}updateBoard(e){var n=this;return M(function*(){const i=n.getState();n.board=i.getCopiedBoard(),n.chosen=h.empty(),n.pieceInHand=i.pieceInHand,n.victoriousCoords=n.rules.getVictoriousCoords(i)})()}chooseCoord(e,n){var i=this;return M(function*(){const o=yield i.canUserPlay("#chooseCoord_"+e+"_"+n);if(o.isFailure())return i.cancelMove(o.getReason());if(i.hideLastMove(),i.board[n][e]===it.EMPTY){if(i.showPieceInHandOnBoard(e,n),15===i.getState().turn){const s=new Jc(e,n,it.EMPTY);return i.chooseMove(s)}if(i.pieceToGive.isAbsent())return w.SUCCESS;{const s=new Jc(e,n,i.pieceToGive.get());return i.chooseMove(s)}}return i.cancelMove(Ee.MUST_CLICK_ON_EMPTY_SPACE())})()}choosePiece(e){var n=this;return M(function*(){const i=yield n.canUserPlay("#choosePiece_"+e);if(i.isFailure())return n.cancelMove(i.getReason());if(n.hideLastMove(),n.pieceToGive.equalsValue(it.ofInt(e)))return n.cancelMoveAttempt(),w.SUCCESS;if(n.pieceToGive=h.of(it.ofInt(e)),n.chosen.isAbsent())return w.SUCCESS;{const o=n.chosen.get(),s=new Jc(o.x,o.y,n.pieceToGive.get());return n.chooseMove(s)}})()}showLastMove(e,n){var i=this;return M(function*(){i.lastMove=h.of(e.coord)})()}hideLastMove(){this.lastMove=h.empty()}cancelMoveAttempt(){this.hideLastMove(),this.pieceToGive=h.empty(),this.chosen=h.empty()}deselectDroppedPiece(){var e=this;return M(function*(){const n=e.chosen.getOrElse(new _(404,404)),i="#droppedPiece_"+n.x+"_"+n.y,o=yield e.canUserPlay(i);return o.isFailure()?e.cancelMove(o.getReason()):(e.cancelMoveAttempt(),w.SUCCESS)})()}showPieceInHandOnBoard(e,n){this.chosen=h.of(new _(e,n))}isRemaining(e){return e3.isGivable(it.ofInt(e),this.board,this.pieceInHand)}getSquareClasses(e,n){const i=new _(e,n);return this.lastMove.equalsValue(i)?["moved-fill"]:[]}getPieceClasses(e){const n=[];return n.push(e%2==0?"player0-fill":"player1-fill"),n}getPieceSize(e){return e<8?40:25}pieceHasDot(e){return e!==it.EMPTY.value&&e%8<4}static \u0275fac=function(n){return new(n||r)(G(Ut))};static \u0275cmp=Ue({type:r,selectors:[["app-quarto"]],features:[$e],decls:11,vars:10,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["transform","translate(5 5)"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngIf"],["pieceInHandDiv",""],["x","0","y","0",1,"base","no-fill"],["rectangleInWhichThePieceInHandIsWaiting",""],["id","pieceInHand",4,"ngIf"],["boardDiv",""],[1,"base",3,"id","ngClass","click"],[4,"ngIf"],["class","base",3,"ngClass",4,"ngIf","ngIfElse"],["circle",""],[1,"base",3,"ngClass"],[3,"id","click"],["droppedPiece",""],["id","selected","x","0","y","0",1,"base","selected-stroke","mid-stroke"],["x","0","y","0","class","base",3,"ngClass",4,"ngIf","ngIfElse"],["x","0","y","0",1,"base",3,"ngClass"],["victoriousCoordsDiv",""],["id","victory","x","0","y","0",1,"base","no-fill","victory-stroke"],["id","pieceInHand"],["cx","0",4,"ngIf"],["cx","0",1,"base",3,"ngClass"],["cx","0"],["remainingPiece",""],["stroke-dasharray","10, 10",1,"base","no-fill"],["rectangleInWhichTheRemainingPiecesAre",""],["class","base selected-stroke",3,"id",4,"ngIf"],[1,"base","selected-stroke",3,"id"]],template:function(n,i){1&n&&(I(),E(0,"svg",0)(1,"g",1),z(2,TDe,3,1,"g",2)(3,NDe,7,8,"g",3)(4,IDe,3,3,"g",2),E(5,"g",null,4),V(7,"rect",5,6),z(9,LDe,5,3,"g",7),P(),z(10,GDe,5,6,"g",2),P()()),2&n&&(A("viewBox","0 0 "+4.25*i.SPACE_SIZE+" "+10.75*i.SPACE_SIZE),m(2),v("ngForOf",i.board),m(),v("ngIf",i.chosen.isPresent()),m(),v("ngForOf",i.victoriousCoords),m(),A("transform","translate("+2*i.SPACE_SIZE+", "+4.5*i.SPACE_SIZE+")"),m(2),A("width",1.5*i.SPACE_SIZE)("height",1.5*i.SPACE_SIZE)("transform","translate("+-.75*i.SPACE_SIZE+", 0)"),m(2),v("ngIf",i.chosen.isAbsent()&&i.pieceInHand!==i.EMPTY),m(),v("ngForOf",i.board))},dependencies:[zt,Nt,bt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}return r})();const $De=it.AABA,WDe=it.AABB,KJ=it.ABAA,qDe=it.ABAB,jDe=it.ABBA,XJ=it.BAAA,ZDe=it.BAAB,YDe=it.BABB,QJ=it.BBAA,KDe=it.BBAB,JI=it.BBBA,XDe=it.BBBB,r1=it.EMPTY;class QDe extends Wn{tutorial=[W.informational($localize`Goal of the game`,$localize`Quarto is an alignment game.
        The goal is to align four pieces that have at least one common aspect:
        <ul>
          <li>their color (light or dark),</li>
          <li>their size (big or small),</li>
          <li>their pattern (empty or dotted),</li>
          <li>their shape (round or square).</li>
        </ul>
        Here, we have a board with a victory by an alignment of dark pieces.
        Note that the pieces are not owned by any player.`,new e3([[JI,QJ,KJ,$De],[r1,r1,r1,r1],[r1,r1,r1,r1],[r1,r1,r1,r1]],7,it.ABAB)),W.anyMove($localize`Placement`,$localize`Every placement occurs in two steps: placing the piece you have in hand (in the small square) on a square of the board,
        and picking a piece that the opponent will have to place, by clicking on one of the pieces inside the dotted square.
        If you prefer, the order of these two steps can be reversed.
        Keep in mind that the second click confirms the move.<br/><br/>
        Make a move.`,new e3([[JI,WDe,jDe,r1],[r1,r1,r1,r1],[r1,XJ,r1,r1],[r1,r1,r1,r1]],7,it.ABAA),new Jc(2,2,it.BAAB),$localize`Perfect!`),W.fromMove($localize`Situation`,$localize`We have here a tricky situation.<br/><br/>
        Analyze the board and play your move, carefully paying attention not to let the opponent win on the next move.`,new e3([[XDe,JI,KDe,r1],[KJ,YDe,QJ,r1],[qDe,XJ,ZDe,r1],[r1,r1,r1,r1]],7,it.AABA),[new Jc(3,3,it.AABB)],$localize`Well done!`,$localize`Failed! Your opponent can either align:<ul><li>the squares horizontally on the third line or vertically on the third column,</li><li>small pieces horizontally on the first line or vertically on the second or third column,</li><li>empty pieces horizontally on the first line or vertically on the first column,</li><li>clear pieces diagonally.</li></ul>`)]}class p0 extends Nr{direction;static encoder=ke.tuple([_.encoder,Ie.encoder],t=>[t.coord,t.direction],t=>new p0(t[0].x,t[0].y,t[1]));constructor(t,e,n){super(t,e),this.direction=n}toString(){return"QuixoMove("+this.coord.x+", "+this.coord.y+", "+this.direction.toString()+")"}equals(t){return t===this||!1!==t.coord.equals(this.coord)&&t.direction===this.direction}}class Eu extends B1{applyLegalMove(t){const e=this.getCopiedBoard(),n=this.turn+1;let i=t.coord,o=t.coord.getNext(t.direction);for(;this.isOnBoard(o);)e[i.y][i.x]=e[o.y][o.x],i=i.getNext(t.direction),o=o.getNext(t.direction);return e[i.y][i.x]=this.getCurrentPlayer(),new Eu(e,n)}}let JDe=(()=>class r{static NO_INSIDE_CLICK=()=>$localize`You must pick a space from the edge of the board.`})();class Il extends gn{add(t,e){const n=this.get(t).get();return this.put(t,n+e)}addOrSet(t,e){return this.containsKey(t)?this.add(t,e):(this.set(t,e),h.of(e))}}class Ki extends Da{static singleton=h.empty();static RULES_CONFIG_DESCRIPTION=new fo({name:()=>$localize`Quixo`,config:{width:new _1(5,Gi.WIDTH,m1.range(1,99)),height:new _1(5,Gi.HEIGHT,m1.range(1,99))}});static QUIXO_HELPER=new a0(L.identity,5);static getVerticalCoords(t){const e=t.gameState.getCurrentOpponent(),n=[],i=t.gameState;for(let o=0;o<i.getHeight();o++)i.getPieceAtXY(0,o)!==e&&n.push(new _(0,o)),i.getPieceAtXY(i.getWidth()-1,o)!==e&&n.push(new _(i.getWidth()-1,o));return n}static getHorizontalCenterCoords(t){const e=t.gameState.getCurrentOpponent(),n=[],i=t.gameState;for(let o=1;o<i.getWidth()-1;o++)i.getPieceAtXY(o,0)!==e&&n.push(new _(o,0)),i.getPieceAtXY(o,i.getHeight()-1)!==e&&n.push(new _(o,i.getHeight()-1));return n}static getLinesSums(t){const e=Q3.ofValues(new gn([{key:"columns",value:new Il},{key:"rows",value:new Il},{key:"ascendingDiagonal",value:new Il},{key:"descendingDiagonal",value:new Il}]),new gn([{key:"columns",value:new Il},{key:"rows",value:new Il},{key:"ascendingDiagonal",value:new Il},{key:"descendingDiagonal",value:new Il}]));for(const n of t.getCoordsAndContents()){const i=n.content,o=n.coord.x,s=n.coord.y;i.isPlayer()&&(e.get(i).get("columns").get().addOrSet(o,1),e.get(i).get("rows").get().addOrSet(s,1),e.get(i).get("ascendingDiagonal").get().addOrSet(o+s,1),e.get(i).get("descendingDiagonal").get().addOrSet(o-s,1))}return e}static getVictoriousCoords(t){return Ki.QUIXO_HELPER.getVictoriousCoord(t)}static getFullestLine(t){let e=t.get("columns").get().listValues();return e=e.concat(t.get("rows").get().listValues()),e=e.concat(t.get("ascendingDiagonal").get().listValues()),e=e.concat(t.get("descendingDiagonal").get().listValues()),Math.max(...e)}static get(){return Ki.singleton.isAbsent()&&(Ki.singleton=h.of(new Ki)),Ki.singleton.get()}getRulesConfigDescription(){return h.of(Ki.RULES_CONFIG_DESCRIPTION)}getInitialState(t){const e=rt.create(t.get().width,t.get().height,B.NONE);return new Eu(e,0)}getPossibleDirections(t,e){const n=[];return 0!==e.x&&n.push(Ie.LEFT),0!==e.y&&n.push(Ie.UP),e.x!==t.getWidth()-1&&n.push(Ie.RIGHT),e.y!==t.getHeight()-1&&n.push(Ie.DOWN),n}isValidCoord(t,e){return L.assert(t.isOnBoard(e),"Invalid coord for QuixoMove: "+e.toString()+" is outside the board."),0!==e.x&&e.x!==t.getWidth()-1&&0!==e.y&&e.y!==t.getHeight()-1?w.failure(JDe.NO_INSIDE_CLICK()):w.SUCCESS}assertDirectionValidity(t,e){const n=t.coord.x,i=t.coord.y,o=t.direction;L.assert(n!==e.getWidth()-1||o!==Ie.RIGHT,"Invalid direction: pawn on the right side can't be moved to the right."),L.assert(i!==e.getHeight()-1||o!==Ie.DOWN,"Invalid direction: pawn on the bottom side can't be moved down."),L.assert(0!==n||o!==Ie.LEFT,"Invalid direction: pawn on the left side can't be moved to the left."),L.assert(0!==i||o!==Ie.UP,"Invalid direction: pawn on the top side can't be moved up.")}applyLegalMove(t,e,n,i){return e.applyLegalMove(t)}isLegal(t,e){const n=this.isValidCoord(e,t.coord);return n.isFailure()?n:(this.assertDirectionValidity(t,e),e.getPieceAt(t.coord)===e.getCurrentOpponent()?w.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT()):w.SUCCESS)}getGameStatus(t){const e=t.gameState,i=Ki.QUIXO_HELPER.getVictoriousCoord(e).map(s=>e.getPieceAt(s)),o=new st(i);return 0===o.size()?ye.ONGOING:1===o.size()?ye.getVictory(o.getAnyElement().get()):ye.getVictory(e.getCurrentPlayer())}}class JJ extends Kn{getListMoves(t,e){const n=t.gameState,i=[],o=Ki.getVerticalCoords(t),a=Ki.getHorizontalCenterCoords(t).concat(o);for(const c of a){const l=Ki.get().getPossibleDirections(n,c);for(const u of l){const f=new p0(c.x,c.y,u);i.push(f)}}return i}}class eVe extends rr{getMetrics(t,e){const i=Ki.getLinesSums(t.gameState),o=Ki.getFullestLine(i.get(O.ZERO)),s=Ki.getFullestLine(i.get(O.ONE));return G1.ofSingle(o,s)}}function tVe(r,t){if(1&r){const e=he();I(),E(0,"g")(1,"circle",4),q("click",function(){const o=te(e).index,s=p().index;return ne(p().onBoardClick(o,s))}),P()()}if(2&r){const e=t.index,n=p().index,i=p();m(),ve("id","click_",e,"_",n,""),v("ngClass",i.getPieceClasses(e,n)),A("r",.45*i.SPACE_SIZE)("cx",(e+.5)*i.SPACE_SIZE)("cy",(n+.5)*i.SPACE_SIZE)}}function nVe(r,t){if(1&r&&(I(),E(0,"g"),z(1,tVe,2,6,"g",2),P()),2&r){const e=t.$implicit;m(),v("ngForOf",e)}}function rVe(r,t){if(1&r){const e=he();I(),E(0,"use",6),q("click",function(){const o=te(e).$implicit;return ne(p(2).chooseDirection(o))}),P()}if(2&r){const e=t.$implicit,n=p(2);Tn("id","chooseDirection_",e,""),A("transform",n.getArrowTransform(e))}}function iVe(r,t){if(1&r&&(I(),E(0,"g"),z(1,rVe,1,2,"use",5),P()),2&r){const e=p();m(),v("ngForOf",e.getPossiblesDirections())}}let oVe=(()=>{class r extends p2{QuixoState=Eu;state;lastMoveCoord=h.empty();chosenCoord=h.empty();chosenDirection;victoriousCoords=[];constructor(e){super(e),this.setRulesAndNode("Quixo"),this.availableAIs=[new fn($localize`Minimax`,this.rules,new eVe,new JJ),new zn($localize`MCTS`,new JJ,this.rules)],this.encoder=p0.encoder}showLastMove(e){var n=this;return M(function*(){n.lastMoveCoord=h.of(e.coord)})()}hideLastMove(){this.lastMoveCoord=h.empty()}updateBoard(e){var n=this;return M(function*(){n.state=n.getState(),n.board=n.state.board,n.victoriousCoords=Ki.getVictoriousCoords(n.state)})()}cancelMoveAttempt(){this.chosenCoord=h.empty()}getPieceClasses(e,n){const i=new _(e,n),s=[];return s.push(this.getPlayerClass(this.board[n][e])),this.chosenCoord.equalsValue(i)?s.push("selected-stroke"):this.lastMoveCoord.equalsValue(i)&&s.push("last-move-stroke"),this.victoriousCoords.some(a=>a.equals(i))&&s.push("victory-stroke"),s}onBoardClick(e,n){var i=this;return M(function*(){const o=yield i.canUserPlay("#click_"+e+"_"+n);if(o.isFailure())return i.cancelMove(o.getReason());const s=new _(e,n),a=i.getState(),c=i.rules.isValidCoord(a,s);return c.isFailure()?i.cancelMove(c.getReason()):i.board[n][e]===i.state.getCurrentOpponent()?i.cancelMove(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT()):(i.chosenCoord.equalsValue(s)?i.cancelMoveAttempt():i.chosenCoord=h.of(s),w.SUCCESS)})()}getPossiblesDirections(){const e=[],n=this.chosenCoord.get(),i=this.getState();return n.x<i.getWidth()-1&&e.push(Ie.RIGHT),0<n.x&&e.push(Ie.LEFT),n.y<i.getHeight()-1&&e.push(Ie.DOWN),0<n.y&&e.push(Ie.UP),e}chooseDirection(e){var n=this;return M(function*(){const i=yield n.canUserPlay("#chooseDirection_"+e.toString());return i.isFailure()?n.cancelMove(i.getReason()):(n.chosenDirection=e,yield n.tryMove())})()}tryMove(){var e=this;return M(function*(){const n=e.chosenCoord.get(),i=new p0(n.x,n.y,e.chosenDirection);return e.chooseMove(i)})()}getArrowTransform(e){const n=this.getState(),i=n.getWidth()*this.SPACE_SIZE,o=n.getHeight()*this.SPACE_SIZE;return wIe.getArrowTransform(i,o,e)}static \u0275fac=function(n){return new(n||r)(G(Ut))};static \u0275cmp=Ue({type:r,selectors:[["app-quixo"]],features:[$e],decls:5,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["id","triangle","points","0 0, 100 50, 0 100"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"base",3,"id","ngClass","click"],[0,"xlink","href","#triangle","class","semi-transparent",3,"id","click",4,"ngFor","ngForOf"],[0,"xlink","href","#triangle",1,"semi-transparent",3,"id","click"]],template:function(n,i){1&n&&(I(),E(0,"svg",0)(1,"defs"),V(2,"polygon",1),P(),z(3,nVe,2,1,"g",2)(4,iVe,2,1,"g",3),P()),2&n&&(A("viewBox",i.getViewBox().toSVGString()),m(3),v("ngForOf",i.board),m(),v("ngIf",i.chosenCoord.isPresent()))},dependencies:[zt,Nt,bt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}return r})();const k1=B.NONE,la=B.ZERO,Ya=B.ONE,sVe=Ki.get().getDefaultRulesConfig();class aVe extends Wn{tutorial=[W.informational($localize`Goal of the game.`,$localize`At Quixo, the goal is to align 5 of your pieces.
        The first player plays with dark pieces, the second with light pieces.
        The board is made of 25 spaces spread over a 5x5 square.
        Every piece has a neutral side, a light side, and a dark side.`,Ki.get().getInitialState(sVe)),W.fromMove($localize`What a move looks like (without animation)`,$localize`When it is your turn:
        <ol>
            <li>Click on one of your pieces or on a neutral one. You cannot choose a piece of the opponent.
                You can only choose a piece from the edge of the board.</li>
            <li>Pick a direction in which you want to send the piece (by clicking on the arrow).</li>
        </ol>
        You have to imagine that the piece you picked has been moved to the other side of the board, in the chosen direction.
        Once on the other side, all pieces will move by one space in the opposing direction.
        Afterwards, if the piece was neutral, it will become yours and takes your color.<br/><br/>
        For example, take the bottom right neutral piece, and move it to the left (you're playing Light).`,new Eu([[k1,k1,k1,k1,k1],[k1,k1,k1,k1,k1],[k1,k1,k1,k1,k1],[k1,k1,k1,k1,k1],[la,la,la,la,k1]],1),[new p0(4,4,Ie.LEFT)],$localize`See how the four dark pieces have been moved one space to the right.
        The neutral piece has been move 4 pieces to the left and has become light.`,pe.FAILED_TRY_AGAIN()),W.fromMove($localize`Victory`,$localize`You already know everything you need in order to play, but there is one last particularity.
        If you create a line of 5 of your pieces, you win.
        If you create a line of 5 of your opponent's pieces, you lose.
        If you create both, you lose too!<br/><br/>
        You can win with this board, try it.
        You're playing Light.`,new Eu([[k1,Ya,k1,Ya,Ya],[k1,la,la,k1,la],[Ya,Ya,Ya,la,Ya],[la,k1,la,Ya,Ya],[Ya,la,k1,Ya,la]],31),[new p0(3,0,Ie.DOWN)],pe.CONGRATULATIONS_YOU_WON(),pe.FAILED_TRY_AGAIN())]}class Mo extends Nr{static encoder=Nr.getEncoder(Mo.of);static PASS=new Mo(-1,-1);static of(t){return new Mo(t.x,t.y)}toString(){return"ReversiMove("+this.coord.x+", "+this.coord.y+")"}}class m0 extends B1{getNeighboringPawnLike(t,e){let n;const i=[];for(let o=-1;o<2;o++)for(let s=-1;s<2;s++)n=new _(e.x+s,e.y+o),this.isOnBoard(n)&&this.board[n.y][n.x]===t&&i.push(n);return i}countScore(){const t=we.of(0,0);for(const e of this.getCoordsAndContents()){const n=e.content;n.isPlayer()&&t.add(n,1)}return t}}let cVe=(()=>class r{static NO_ELEMENT_SWITCHED=()=>$localize`Your move should switch at least one piece.`})();var _0;class eee{move;switched;constructor(t,e){this.move=t,this.switched=e}}let C0=class extends Da{static#e=_0=this;static singleton=h.empty();static get(){return _0.singleton.isAbsent()&&(_0.singleton=h.of(new _0)),_0.singleton.get()}static RULES_CONFIG_DESCRIPTION=new fo({name:()=>$localize`Reversi`,config:{width:new _1(8,Gi.WIDTH,m1.range(3,99)),height:new _1(8,Gi.HEIGHT,m1.range(3,99))}});getRulesConfigDescription(){return h.of(_0.RULES_CONFIG_DESCRIPTION)}getInitialState(t){const e=t.get(),n=rt.create(e.width,e.height,B.NONE),i=new _(Math.floor(e.width/2),Math.floor(e.height/2));return n[i.y-1][i.x-1]=O.ZERO,n[i.y][i.x]=O.ZERO,n[i.y-1][i.x]=O.ONE,n[i.y][i.x-1]=O.ONE,new m0(n,0)}applyLegalMove(t,e,n,i){const o=e.turn,s=e.getCurrentPlayer(),a=e.getCopiedBoard();if(t.equals(Mo.PASS))return new m0(a,o+1);for(const l of i)a[l.y][l.x]=s;return a[t.coord.y][t.coord.x]=s,new m0(a,o+1)}getAllSwitcheds(t,e,n){const i=[],o=e.getOpponent();for(const s of me.DIRECTIONS){const a=t.coord.getNext(s);if(n.isOnBoard(a)&&n.getPieceAt(a)===o){const c=this.getSandwicheds(e,s,a,n);for(const l of c)i.push(l)}}return i}getSandwicheds(t,e,n,i){const o=[n];let s=n.getNext(e);for(;i.isOnBoard(s);){const a=i.getPieceAt(s);if(a===t)return o;if(a===B.NONE)return[];o.push(s),s=s.getNext(e)}return[]}isGameEnded(t,e){return this.playerCanOnlyPass(t,e)&&this.nextPlayerCantOnlyPass(t,e)}getGameStatus(t,e){const n=t.gameState;if(!1===this.isGameEnded(n,e))return ye.ONGOING;const o=n.countScore(),s=o.get(O.ONE)-o.get(O.ZERO);return s<0?ye.ZERO_WON:s>0?ye.ONE_WON:ye.DRAW}playerCanOnlyPass(t,e){const n=this.getListMoves(t,e);return 1===n.length&&n[0].move.equals(Mo.PASS)}nextPlayerCantOnlyPass(t,e){const n=t.getCopiedBoard(),o=new m0(n,t.turn+1);return this.playerCanOnlyPass(o,e)}getListMoves(t,e){const n=[];let i;const o=t.getCurrentPlayer(),s=t.getCurrentOpponent();for(const a of t.getCoordsAndContents()){const c=a.coord;if(t.getPieceAt(c)===B.NONE&&(i=t.getCopiedBoard(),t.getNeighboringPawnLike(s,c).length>0)){const u=new Mo(c.x,c.y),f=this.getAllSwitcheds(u,o,t);if(f.length>0){for(const g of f)L.assert(o!==t.getPieceAt(g),g+"was already switched!"),i[g.y][g.x]=o;i[c.y][c.x]=o,n.push(new eee(u,f.length))}}}return 0===n.length&&n.push(new eee(Mo.PASS,0)),n}isLegal(t,e,n){if(t.equals(Mo.PASS))return this.playerCanOnlyPass(e,n)?X.success([]):X.failure(Ee.CANNOT_PASS());if(e.getPieceAt(t.coord).isPlayer())return X.failure(Ee.MUST_CLICK_ON_EMPTY_SPACE());const i=this.getAllSwitcheds(t,e.getCurrentPlayer(),e);return 0===i.length?X.failure(cVe.NO_ELEMENT_SWITCHED()):X.success(i)}};C0=_0=function(r,t,e,n){var s,i=arguments.length,o=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,e):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,t,e,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(t,e,o):s(t,e))||o);return i>3&&o&&Object.defineProperty(t,e,o),o}([Ae.log],C0);class tee extends Kn{getListMoves(t,e){return C0.get().getListMoves(t.gameState,e).map(i=>i.move)}}class uVe extends rr{getMetrics(t,e){const n=t.gameState,i=G1.of([0],[0]);for(const o of n.getCoordsAndContents()){const s=o.coord,a=o.content,u=(n.isVerticalEdge(s)?4:1)*(n.isHorizontalEdge(s)?4:1);a.isPlayer()&&i.add(a,0,u)}return i}}class fVe extends fn{constructor(){super($localize`Minimax`,C0.get(),new uVe,new tee)}}function dVe(r,t){if(1&r&&(I(),V(0,"circle",4)),2&r){const e=p().index,n=p().index,i=p();v("ngClass",i.getPieceClass(e,n)),A("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)("cx",i.SPACE_SIZE*e+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*n+i.SPACE_SIZE/2)}}function hVe(r,t){if(1&r){const e=he();I(),E(0,"g")(1,"rect",2),q("click",function(){const o=te(e).index,s=p().index;return ne(p().onClick(o,s))}),P(),z(2,dVe,1,4,"circle",3),P()}if(2&r){const e=t.index,n=p().index,i=p();m(),ve("id","click_",e,"_",n,""),v("ngClass",i.getRectClasses(e,n)),A("x",i.SPACE_SIZE*e)("y",i.SPACE_SIZE*n)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),m(),v("ngIf",i.board[n][e]!==i.EMPTY)}}function gVe(r,t){if(1&r&&(I(),E(0,"g"),z(1,hVe,3,8,"g",1),P()),2&r){const e=t.$implicit;m(),v("ngForOf",e)}}let pVe=(()=>{class r extends p2{EMPTY=B.NONE;lastMove=h.empty();capturedCoords=[];constructor(e){super(e),this.setRulesAndNode("Reversi"),this.availableAIs=[new fVe,new zn($localize`MCTS`,new tee,this.rules)],this.encoder=Mo.encoder,this.scores=h.of(we.of(2,2))}onClick(e,n){var i=this;return M(function*(){const o=yield i.canUserPlay("#click_"+e+"_"+n);if(o.isFailure())return i.cancelMove(o.getReason());const s=new Mo(e,n);return yield i.chooseMove(s)})()}updateBoard(e){var n=this;return M(function*(){const i=n.getState();n.board=i.getCopiedBoard(),n.capturedCoords=[],n.scores=h.of(i.countScore()),n.canPass=n.rules.playerCanOnlyPass(i,n.config)})()}showLastMove(e){var n=this;return M(function*(){n.lastMove=h.of(e.coord);const i=n.getState().getCurrentPlayer(),o=n.getState().getCurrentOpponent();for(const s of me.DIRECTIONS){let a=e.coord.getNext(s,1);for(;n.getState().isOnBoard(a)&&n.getState().getPieceAt(a)===o&&n.getPreviousState().getPieceAt(a)===i;)n.capturedCoords.push(a),a=a.getNext(s,1)}})()}hideLastMove(){this.capturedCoords=[]}getRectClasses(e,n){const i=new _(e,n);return this.capturedCoords.some(o=>o.equals(i))?["captured-fill"]:this.lastMove.equalsValue(i)?["moved-fill"]:[]}getPieceClass(e,n){return this.getPlayerClass(this.board[n][e])}pass(){var e=this;return M(function*(){return L.assert(e.canPass,"ReversiComponent: pass() can only be called if canPass is true"),e.onClick(Mo.PASS.coord.x,Mo.PASS.coord.y)})()}static \u0275fac=function(n){return new(n||r)(G(Ut))};static \u0275cmp=Ue({type:r,selectors:[["app-reversi"]],features:[$e],decls:2,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass",4,"ngIf"],[1,"base",3,"ngClass"]],template:function(n,i){1&n&&(I(),E(0,"svg",0),z(1,gVe,2,1,"g",1),P()),2&n&&(A("viewBox",i.getViewBox().toSVGString()),m(),v("ngForOf",i.board))},dependencies:[zt,Nt,bt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}return r})();const Mt=B.NONE,Et=B.ZERO,Qe=B.ONE,mVe=C0.get().getDefaultRulesConfig();class _Ve extends Wn{tutorial=[W.informational($localize`Goal of the game`,$localize`At Reversi, the pieces are double sided: one dark side for the first player, one light side for the second player.
        When one piece is flipped, its owner changes.
        The player owning the most pieces at the end of the game wins.
        Here, Dark has 28 points and Light has 36, hence Light wins.`,new m0([[Et,Et,Et,Et,Et,Et,Et,Et],[Et,Qe,Qe,Qe,Qe,Qe,Qe,Et],[Et,Qe,Qe,Qe,Qe,Qe,Qe,Et],[Et,Qe,Qe,Qe,Qe,Qe,Qe,Et],[Et,Qe,Qe,Qe,Qe,Qe,Qe,Et],[Et,Qe,Qe,Qe,Qe,Qe,Qe,Et],[Et,Qe,Qe,Qe,Qe,Qe,Qe,Et],[Et,Et,Et,Et,Et,Et,Et,Et]],60)),W.anyMove($localize`Captures (1/2)`,$localize`At the beginning of the game, pieces are placed as shown here.
        For a move to be legal, it must sandwich at least one piece of the opponent between the piece you're putting and another of your pieces.<br/><br/>
        Do any move by clicking to put your piece
        Dark plays first.`,C0.get().getInitialState(mVe),new Mo(2,4),pe.CONGRATULATIONS()),W.fromMove($localize`Captures (2/2)`,$localize`A move can also capture a bigger line, and more than one line at a time<br/><br/>You're playing Light here. Play on the bottom left to see a capture.`,new m0([[Mt,Mt,Mt,Mt,Mt,Mt,Mt,Mt],[Mt,Mt,Mt,Mt,Mt,Mt,Mt,Mt],[Mt,Mt,Mt,Mt,Mt,Mt,Mt,Mt],[Mt,Mt,Mt,Mt,Qe,Mt,Mt,Mt],[Mt,Mt,Mt,Et,Mt,Mt,Mt,Mt],[Mt,Mt,Et,Mt,Mt,Mt,Mt,Mt],[Et,Et,Mt,Mt,Mt,Mt,Mt,Mt],[Mt,Et,Qe,Et,Qe,Et,Mt,Mt]],1),[new Mo(0,7)],pe.CONGRATULATIONS(),$localize`Lower and more to the left, please.`),W.informational($localize`Passing a turn`,$localize`If, during its turn, a player has no move that would allow that player to flip a piece, that player must pass
        Moreover, if the next player could not play neither, the game ends before the board is full, and points are counted in the usual way.`,new m0([[Qe,Et,Et,Et,Et,Et,Qe,Et],[Et,Qe,Qe,Qe,Qe,Qe,Qe,Et],[Et,Qe,Qe,Qe,Qe,Qe,Qe,Et],[Et,Qe,Qe,Qe,Qe,Qe,Qe,Et],[Et,Qe,Qe,Qe,Qe,Qe,Qe,Et],[Et,Qe,Qe,Qe,Qe,Qe,Qe,Et],[Qe,Qe,Qe,Qe,Qe,Qe,Mt,Mt],[Et,Et,Et,Et,Et,Et,Mt,Mt]],60))]}let kl=(()=>{class r extends c0{static HEIGHT=6;static WIDTH=11;static isOnBoard(e){return e.isInRange(r.WIDTH,r.HEIGHT)}}return r})(),Pu=(()=>class r{static CAN_ONLY_REBOUND_ON_BLACK=()=>$localize`You can only rebound on dark spaces.`;static CAN_ONLY_REBOUND_ON_EMPTY_SPACE=()=>$localize`You can only rebound on empty spaces.`;static MUST_CHOOSE_PYRAMID_FIRST=()=>$localize`You must pick one of your pyramids first.`;static MUST_CHOOSE_OWN_PYRAMID=()=>$localize`You must pick one of your pyramids.`;static THOSE_TWO_SPACES_ARE_NOT_NEIGHBORS=()=>$localize`Those two spaces are not neighbors.`;static THOSE_TWO_SPACES_HAVE_NO_COMMON_NEIGHBOR=()=>$localize`Those two spaces have no intermediary neighbor.`})();class n3 extends Do{static encoder=G2.getFallibleEncoder(n3.from);static checkDistanceAndLocation(t,e){const n=t.getOrthogonalDistance(e);if(0===n)return w.failure(Ee.MOVE_CANNOT_BE_STATIC());if(1===n){const i=Qs.getFakeNeighbors(t);if(e.equals(i))return w.failure(Pu.THOSE_TWO_SPACES_ARE_NOT_NEIGHBORS())}else{if(2!==n)return w.failure($localize`You can move one or two spaces, not ${n}.`);if(Qs.isSpaceDark(t))return w.failure(Pu.CAN_ONLY_REBOUND_ON_BLACK());if(t.x===e.x)return w.failure(Pu.THOSE_TWO_SPACES_HAVE_NO_COMMON_NEIGHBOR())}return w.SUCCESS}static from(t,e){L.assert(kl.isOnBoard(t),"Move must start inside the board not at "+t.toString()+"."),L.assert(kl.isOnBoard(e),"Move must end inside the board not at "+e.toString()+".");const n=n3.checkDistanceAndLocation(t,e);return n.isFailure()?n.toOtherFallible():X.success(new n3(t,e))}constructor(t,e){super(t,e)}isSimpleStep(){return Math.abs(this.getStart().x-this.getEnd().x)+Math.abs(this.getStart().y-this.getEnd().y)===1}toString(){return"SaharaMove("+this.getStart()+"->"+this.getEnd()+")"}}var r3;let h4=class extends Ar{static#e=r3=this;static singleton=h.empty();static get(){return r3.singleton.isAbsent()&&(r3.singleton=h.of(new r3)),r3.singleton.get()}getInitialState(){const t=Pe.UNREACHABLE,e=Pe.ZERO,n=Pe.ONE,i=Pe.EMPTY;return new kl([[t,t,e,n,i,i,i,e,n,t,t],[t,i,i,i,i,i,i,i,i,i,t],[n,i,i,i,i,i,i,i,i,i,e],[e,i,i,i,i,i,i,i,i,i,n],[t,i,i,i,i,i,i,i,i,i,t],[t,t,n,e,i,i,i,n,e,t,t]],0)}static getStartingCoords(t,e){const n=[];for(let i=0;i<kl.HEIGHT;i++)for(let o=0;o<kl.WIDTH;o++)t[i][o].is(e)&&n.push(new _(o,i));return n}static getBoardValuesFor(t,e){const n=r3.getStartingCoords(t,e),i=[];for(const o of n){const s=c0.getEmptyNeighbors(t,o,Pe.EMPTY).length;if(0===s)return[0,0,0,0,0,0];i.push(s)}return i.sort((o,s)=>o-s)}applyLegalMove(t,e,n,i){const o=e.getCopiedBoard();return o[t.getEnd().y][t.getEnd().x]=o[t.getStart().y][t.getStart().x],o[t.getStart().y][t.getStart().x]=Pe.EMPTY,new kl(o,e.turn+1)}isLegal(t,e){if(!1===e.getPieceAt(t.getStart()).is(e.getCurrentPlayer()))return w.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT());if(e.getPieceAt(t.getEnd())!==Pe.EMPTY)return w.failure(Ee.MUST_LAND_ON_EMPTY_SPACE());const o=Qs.getCommonNeighbor(t.getStart(),t.getEnd());return o.isPresent()?e.getPieceAt(o.get())===Pe.EMPTY?w.SUCCESS:w.failure(Pu.CAN_ONLY_REBOUND_ON_EMPTY_SPACE()):w.SUCCESS}getGameStatus(t){const e=t.gameState.getCopiedBoard(),n=r3.getBoardValuesFor(e,O.ZERO),i=r3.getBoardValuesFor(e,O.ONE);return r3.getGameStatusFromFreedoms(n,i)}getLandingCoords(t,e){const n=o=>kl.isOnBoard(o)&&t[o.y][o.x]===Pe.EMPTY,i=new st(Qs.getNeighbors(e).filter(n));if(!0===Qs.isSpaceDark(e))return i.toList();{const o=new st(i.toList());for(const s of i){const a=Qs.getNeighbors(s).filter(n);for(const c of a)o.add(c)}return o.toList()}}static getGameStatusFromFreedoms(t,e){return 0===t[0]?ye.ONE_WON:0===e[0]?ye.ZERO_WON:ye.ONGOING}};h4=r3=function(r,t,e,n){var s,i=arguments.length,o=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,e):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,t,e,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(t,e,o):s(t,e))||o);return i>3&&o&&Object.defineProperty(t,e,o),o}([Ae.log],h4);class vVe extends rr{getMetrics(t,e){const n=t.gameState.board,i=h4.getBoardValuesFor(n,O.ZERO),o=h4.getBoardValuesFor(n,O.ONE);return G1.of(i,o)}}class nee extends Kn{getListMoves(t,e){const n=[],i=t.gameState.getCopiedBoard(),o=t.gameState.getCurrentPlayer(),s=h4.getStartingCoords(i,o);for(const a of s){const c=c0.getEmptyNeighbors(i,a,Pe.EMPTY);for(const l of c){const u=n3.from(a,l).get();if(i[l.y][l.x]=i[a.y][a.x],i[a.y][a.x]=Pe.EMPTY,n.push(u),(l.y+l.x)%2==0){const g=c0.getEmptyNeighbors(i,l,Pe.EMPTY);for(const y of g)if(!1===y.equals(a)){const S=n3.from(a,y).get();i[y.y][y.x]=i[l.y][l.x],i[l.y][l.x]=Pe.EMPTY,n.push(S),i[l.y][l.x]=i[y.y][y.x],i[y.y][y.x]=Pe.EMPTY}}i[a.y][a.x]=i[l.y][l.x],i[l.y][l.x]=Pe.EMPTY}}return n}}function yVe(r,t){if(1&r&&(I(),E(0,"g"),V(1,"polygon",7),P()),2&r){const e=p(2).index,n=p().index,i=p();m(),ve("id","pyramid_",e,"_",n,""),v("ngClass",i.getPlayerClassFor(e,n)),A("points",i.getPyramidPoints(e,n))}}function MVe(r,t){if(1&r&&(I(),V(0,"polygon",10)),2&r){const e=p(3).index,n=p().index,i=p();ve("id","triangle_",e,"_",n,""),A("points",i.getTrianglePoints(e,n))}}function EVe(r,t){if(1&r&&(I(),V(0,"polygon",11)),2&r){const e=p(3).index,n=p().index,i=p();ve("id","triangle_",e,"_",n,""),A("points",i.getTrianglePoints(e,n))}}function PVe(r,t){if(1&r&&(I(),E(0,"g"),z(1,MVe,1,3,"polygon",8)(2,EVe,1,3,"polygon",9),P()),2&r){const e=p(2).index,n=p().index;m(),v("ngIf",(e+n)%2==1),m(),v("ngIf",(e+n)%2==0)}}function SVe(r,t){if(1&r&&(I(),E(0,"g"),z(1,yVe,2,4,"g",6)(2,PVe,3,2,"g",6),P()),2&r){const e=p().$implicit;m(),v("ngIf",e.isPlayer()),m(),v("ngIf",!1===e.isPlayer())}}function OVe(r,t){if(1&r){const e=he();I(),E(0,"g",5),q("click",function(){const o=te(e).index,s=p().index;return ne(p().onClick(o,s))}),z(1,SVe,3,2,"g",6),P()}if(2&r){const e=t.$implicit,n=t.index,i=p().index,o=p();ve("id","click_",n,"_",i,""),A("transform",o.getTriangleTranslation(n,i)),m(),v("ngIf",e.isReachable())}}function TVe(r,t){if(1&r&&(I(),E(0,"g"),z(1,OVe,2,4,"g",4),P()),2&r){const e=t.$implicit;m(),v("ngForOf",e)}}function wVe(r,t){if(1&r&&(I(),V(0,"polygon",14)),2&r){const e=t.$implicit,n=p(2);ve("id","possible_landing_",e.x,"_",e.y,""),A("points",n.getTrianglePoints(e.x,e.y))("transform",n.getTriangleTranslation(e.x,e.y))}}function bVe(r,t){if(1&r&&(I(),V(0,"polygon",14)),2&r){const e=p(2);ve("id","chosen_coord_",e.chosenCoord.get().x,"_",e.chosenCoord.get().y,""),A("points",e.getTrianglePoints(e.chosenCoord.get().x,e.chosenCoord.get().y))("transform",e.getTriangleTranslation(e.chosenCoord.get().x,e.chosenCoord.get().y))}}function AVe(r,t){if(1&r&&(I(),jt(0),z(1,wVe,1,4,"polygon",12)(2,bVe,1,4,"polygon",13),Zt()),2&r){const e=p();m(),v("ngForOf",e.possibleLandings),m(),v("ngIf",e.chosenCoord.isPresent())}}function NVe(r,t){if(1&r&&(I(),jt(0),V(1,"polygon",15)(2,"polygon",15),Zt()),2&r){const e=p(2);m(),A("points",e.getTrianglePoints(e.lastCoord.get().x,e.lastCoord.get().y))("transform",e.getTriangleTranslation(e.lastCoord.get().x,e.lastCoord.get().y)),m(),A("points",e.getTrianglePoints(e.lastMoved.get().x,e.lastMoved.get().y))("transform",e.getTriangleTranslation(e.lastMoved.get().x,e.lastMoved.get().y))}}function IVe(r,t){1&r&&(I(),z(0,NVe,3,4,"ng-container",6)),2&r&&v("ngIf",p().lastMoved.isPresent())}let kVe=(()=>{class r extends sJ{lastCoord=h.empty();lastMoved=h.empty();chosenCoord=h.empty();possibleLandings=[];constructor(e){super(e),this.setRulesAndNode("Sahara"),this.availableAIs=[new fn($localize`Minimax`,this.rules,new vVe,new nee),new zn($localize`MCTS`,new nee,this.rules)],this.encoder=n3.encoder}showLastMove(e){var n=this;return M(function*(){n.lastCoord=h.of(e.getStart()),n.lastMoved=h.of(e.getEnd())})()}hideLastMove(){this.lastCoord=h.empty(),this.lastMoved=h.empty()}cancelMoveAttempt(){this.possibleLandings=[],this.chosenCoord=h.empty()}onClick(e,n){var i=this;return M(function*(){const o=yield i.canUserPlay("#click_"+e+"_"+n);if(o.isFailure())return i.cancelMove(o.getReason());const s=i.getState().getCurrentPlayer(),a=Pe.ofPlayer(s);return i.chosenCoord.equalsValue(new _(e,n))?(i.cancelMoveAttempt(),w.SUCCESS):i.chosenCoord.isAbsent()||i.board[n][e]===a?i.choosePiece(e,n):i.chooseLandingCoord(e,n)})()}choosePiece(e,n){var i=this;return M(function*(){if(i.board[n][e]===Pe.EMPTY)return i.cancelMove(Pu.MUST_CHOOSE_PYRAMID_FIRST());if(i.board[n][e].is(O.ofTurn(i.getTurn()))){const o=new _(e,n);return i.selectPiece(o),w.SUCCESS}return i.cancelMove(Pu.MUST_CHOOSE_OWN_PYRAMID())})()}selectPiece(e){this.chosenCoord=h.of(e),this.possibleLandings=this.rules.getLandingCoords(this.board,e)}chooseLandingCoord(e,n){var i=this;return M(function*(){const o=new _(e,n),s=n3.from(i.chosenCoord.get(),o);return s.isFailure()?i.cancelMove(s.getReason()):yield i.chooseMove(s.get())})()}updateBoard(e){var n=this;return M(function*(){n.board=n.getState().board,console.table(rt.map(n.board,i=>i.isPlayer()))})()}getPlayerClassFor(e,n){return this.getPlayerClass(this.board[n][e].getPlayer())}static \u0275fac=function(n){return new(n||r)(G(Ut))};static \u0275cmp=Ue({type:r,selectors:[["app-sahara"]],features:[$e],decls:5,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-3 -3 606 606","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf","ngIfElse"],["lastMove",""],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[4,"ngIf"],[1,"base","mid-stroke",3,"id","ngClass"],["class","base mid-stroke",3,"id",4,"ngIf"],["class","base mid-stroke background2",3,"id",4,"ngIf"],[1,"base","mid-stroke",3,"id"],[1,"base","mid-stroke","background2",3,"id"],["class","base no-fill mid-stroke selected-stroke",3,"id",4,"ngFor","ngForOf"],["class","base no-fill mid-stroke selected-stroke",3,"id",4,"ngIf"],[1,"base","no-fill","mid-stroke","selected-stroke",3,"id"],[1,"base","no-fill","mid-stroke","moved-stroke"]],template:function(n,i){if(1&n&&(I(),E(0,"svg",0),z(1,TVe,2,1,"g",1)(2,AVe,3,2,"ng-container",2)(3,IVe,1,1,"ng-template",null,3,In),P()),2&n){const o=wn(4);m(),v("ngForOf",i.board),m(),v("ngIf",i.chosenCoord.isPresent())("ngIfElse",o)}},dependencies:[zt,Nt,bt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}return r})();const ua=Pe.UNREACHABLE,Su=Pe.ZERO,Ou=Pe.ONE,dn=Pe.EMPTY;class RVe extends Wn{tutorial=[W.informational($localize`Initial board`,$localize`Shr is played on a board where each space is a triangle.
        Each player has six pyramids.`,h4.get().getInitialState()),W.informational($localize`Goal of the game`,$localize`At Shr, the goal of the game is to immobilize one of the opponent's pyramids.
        To do so, you have to occupy all neighboring space of that pyramid.
        Here, Light has lost because its leftmost pyramid is immobilized.`,new kl([[ua,ua,dn,dn,Ou,dn,dn,Su,Ou,ua,ua],[ua,dn,dn,dn,dn,dn,dn,dn,dn,dn,ua],[Ou,Su,dn,dn,dn,dn,dn,dn,dn,dn,Su],[Su,dn,dn,dn,dn,dn,dn,dn,dn,dn,Ou],[ua,dn,dn,dn,dn,dn,dn,dn,dn,dn,ua],[ua,ua,Ou,Su,dn,dn,dn,Ou,Su,ua,ua]],3)),W.fromPredicate($localize`Simple step`,$localize`To immobilize your opponent, you have to move your pyramids.
        When a pyramid shares its vertices with light spaces, it can move on these spaces (we call this a simple step).
        To perform a move:
        <ol>
            <li>Click on one of your pyramids.</li>
            <li>Click on one of its two or three neighboring spaces in order to move your pyramid there.</li>
        </ol><br/>
        You're playing Dark, do any simple step.`,h4.get().getInitialState(),n3.from(new _(2,0),new _(2,1)).get(),(t,e,n)=>t.isSimpleStep()?w.SUCCESS:w.failure($localize`You have made a double step, which is good but it is the next exercise!`),pe.CONGRATULATIONS()),W.fromPredicate($localize`Double step`,$localize`When a pyramid shares its vertices with dark spaces, it can move one or two steps.
        To do so:
        <ol>
            <li>Click on the pyramid to move.</li>
            <li>Click on one of the 6 destinations that you can reach in two steps:
                 the 6 neighboring light spaces of the 3 dark spaces that are neighbors of your pyramid.
        </ol><br/>
        You're playing Dark, do a double step.`,h4.get().getInitialState(),n3.from(new _(7,0),new _(5,0)).get(),(t,e,n)=>t.isSimpleStep()?w.failure($localize`Failed! You have made a single step.`):w.SUCCESS,pe.CONGRATULATIONS())]}class Ts extends Nr{x;y;direction;landingOrientation;static encoder=ke.tuple([ke.identity(),ke.identity(),h.getEncoder(Ie.encoder),Ie.encoder],t=>[t.x,t.y,t.direction,t.landingOrientation],t=>Ts.of(t[0],t[1],t[2],t[3]));constructor(t,e,n,i){super(t,e),this.x=t,this.y=e,this.direction=n,this.landingOrientation=i}static of(t,e,n,i){return new Ts(t,e,n,i)}isRotation(){return this.direction.isAbsent()}equals(t){return this===t||!1!==this.coord.equals(t.coord)&&!1!==this.direction.equals(t.direction)&&this.landingOrientation===t.landingOrientation}toString(){const t=this.direction.isAbsent()?"-":this.direction.get().toString();return"SiamMove("+this.coord.x+", "+this.coord.y+", "+t+", "+this.landingOrientation+")"}}class Rl extends B1{countCurrentPlayerPawn(){const t=this.getCurrentPlayer();return this.countPlayersPawn().get(t)}countPlayersPawn(){const t=we.of(0,0);for(const e of this.getCoordsAndContents())e.content.getOwner().isPlayer()&&t.add(e.content.getOwner(),1);return t}}class nt{value;owner;direction;static EMPTY=new nt(0,B.NONE,h.empty());static LIGHT_UP=new nt(1,B.ONE,h.of(Ie.UP));static LIGHT_RIGHT=new nt(2,B.ONE,h.of(Ie.RIGHT));static LIGHT_DOWN=new nt(3,B.ONE,h.of(Ie.DOWN));static LIGHT_LEFT=new nt(4,B.ONE,h.of(Ie.LEFT));static DARK_UP=new nt(5,B.ZERO,h.of(Ie.UP));static DARK_RIGHT=new nt(6,B.ZERO,h.of(Ie.RIGHT));static DARK_DOWN=new nt(7,B.ZERO,h.of(Ie.DOWN));static DARK_LEFT=new nt(8,B.ZERO,h.of(Ie.LEFT));static MOUNTAIN=new nt(9,B.NONE,h.empty());static decode(t){switch(t){case 0:return nt.EMPTY;case 1:return nt.LIGHT_UP;case 2:return nt.LIGHT_RIGHT;case 3:return nt.LIGHT_DOWN;case 4:return nt.LIGHT_LEFT;case 5:return nt.DARK_UP;case 6:return nt.DARK_RIGHT;case 7:return nt.DARK_DOWN;case 8:return nt.DARK_LEFT;case 9:return nt.MOUNTAIN}}static of(t,e){return e===O.ZERO?t===Ie.UP?nt.DARK_UP:t===Ie.RIGHT?nt.DARK_RIGHT:t===Ie.DOWN?nt.DARK_DOWN:nt.DARK_LEFT:t===Ie.UP?nt.LIGHT_UP:t===Ie.RIGHT?nt.LIGHT_RIGHT:t===Ie.DOWN?nt.LIGHT_DOWN:nt.LIGHT_LEFT}constructor(t,e,n){this.value=t,this.owner=e,this.direction=n}belongsTo(t){return this.owner.equals(t)}isEmptyOrMountain(){return this.owner===B.NONE}isPiece(){return!1===this.isEmptyOrMountain()}getOwner(){return this.owner}getOptionalDirection(){return this.direction}getDirection(){return this.getOptionalDirection().get()}toString(){switch(this){case nt.EMPTY:return"EMPTY";case nt.LIGHT_UP:return"LIGHT_UP";case nt.LIGHT_RIGHT:return"LIGHT_RIGHT";case nt.LIGHT_DOWN:return"LIGHT_DOWN";case nt.LIGHT_LEFT:return"LIGHT_LEFT";case nt.DARK_UP:return"DARK_UP";case nt.DARK_RIGHT:return"DARK_RIGHT";case nt.DARK_DOWN:return"DARK_DOWN";case nt.DARK_LEFT:return"DARK_LEFT";default:return L.expectToBe(this,nt.MOUNTAIN),"MOUNTAIN"}}}let Tu=(()=>class r{static NO_REMAINING_PIECE_TO_INSERT=()=>$localize`You cannot insert a piece, all your pieces are already on the board.`;static NOT_ENOUGH_FORCE_TO_PUSH=()=>$localize`You do not have enough strength to push.`;static MUST_MOVE_OR_ROTATE=()=>$localize`You must move or rotate your piece.`;static ILLEGAL_PUSH=()=>$localize`Your push is invalid: it is either not straight, is not pushing anything, or is leaving the board.`;static MUST_SELECT_VALID_DESTINATION=()=>$localize`You must select a valid destination (highlighted on the board) for your piece`;static MUST_SELECT_ORIENTATION=()=>$localize`You should select the orientation of your piece by clicking on one of the arrows.`})();var v0;class ree{resultingBoard;moved;constructor(t,e){this.resultingBoard=t,this.moved=e}}let Z2=class extends Da{static#e=v0=this;static singleton=h.empty();static get(){return v0.singleton.isAbsent()&&(v0.singleton=h.of(new v0)),v0.singleton.get()}static RULES_CONFIG_DESCRIPTION=new fo({name:()=>$localize`Siam`,config:{width:new _1(5,Gi.WIDTH,m1.range(3,99)),height:new _1(5,Gi.HEIGHT,m1.range(3,99)),numberOfPiece:new _1(5,()=>$localize`Number of piece by player`,m1.range(1,99)),numberOfBonusMountain:new _1(2,()=>$localize`Number of bonus mountains`,m1.range(0,98))}});getRulesConfigDescription(){return h.of(v0.RULES_CONFIG_DESCRIPTION)}getInitialState(t){const e=t.get(),n=rt.create(e.width,e.height,nt.EMPTY),i=Math.floor(e.height/2),o=Math.floor(e.width/2);n[i][o]=nt.MOUNTAIN,e.numberOfBonusMountain=Math.min(e.numberOfBonusMountain,e.width-1);let s=0;for(;s<e.numberOfBonusMountain;){const a=Math.ceil((s+1)/2);n[i][o+a]=nt.MOUNTAIN,s++,s<e.numberOfBonusMountain&&(n[i][o-a]=nt.MOUNTAIN,s++)}return new Rl(n,0)}getMoveValidity(t,e){const n=!1===e.isOnBoard(t.coord);if(t.isRotation()){if(n)return X.failure($localize`Cannot rotate piece outside the board: ${t.toString()}`)}else if(!1===e.isOnBoard(t.coord.getNext(t.direction.get()))){if(n)return X.failure($localize`SiamMove should end or start on the board: ${t.toString()}`);if(t.direction.get()!==t.landingOrientation)return X.failure($localize`SiamMove should have moveDirection and landingOrientation matching when a piece goes out of the board: ${t.toString()}`)}return w.SUCCESS}isInsertion(t,e){return-1===t.coord.x||t.coord.x===e.getWidth()||-1===t.coord.y||t.coord.y===e.getHeight()}isLegal(t,e,n){const i=this.getMoveValidity(t,e);if(i.isFailure())return i.toOtherFallible();if(!1===this.isInsertion(t,e)){const o=e.getPieceAt(t.coord);if(o===nt.EMPTY)return X.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(o.belongsTo(e.getCurrentOpponent()))return X.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT())}if(t.isRotation())return this.isLegalRotation(t,e);{let o;if(this.isInsertion(t,e)){const s=this.isLegalInsertion(t.coord,e,n.get());if(s.legal.isFailure())return X.failure(s.legal.getReason());o=s.insertedPiece}else o=e.getPieceAt(t.coord);return this.isLegalForwarding(t,e,o)}}isLegalInsertion(t,e,n){const i=e.countCurrentPlayerPawn(),o=e.getCurrentPlayer(),s=i<n.numberOfPiece?w.SUCCESS:w.failure(Tu.NO_REMAINING_PIECE_TO_INSERT());return{insertedPiece:this.getInsertedPiece(t,o,e.getWidth()),legal:s}}getInsertedPiece(t,e,n){return nt.of(-1===t.x?Ie.RIGHT:-1===t.y?Ie.DOWN:t.x===n?Ie.LEFT:Ie.UP,e)}isLegalForwarding(t,e,n){L.assert(n!==nt.MOUNTAIN&&n!==nt.EMPTY,"forwarding must be done with player piece");const i=[];let o=nt.of(t.landingOrientation,e.getCurrentPlayer());const s=t.direction.get();let a=t.coord.getNext(s);if(e.isOnBoard(a)&&e.getPieceAt(a)!==nt.EMPTY&&!1===this.isStraight(n,t))return X.failure(Tu.ILLEGAL_PUSH());let c=h.of(s);const l=s.getOpposite();let u=0;const f=e.getCopiedBoard();e.isOnBoard(t.coord)&&(f[t.coord.y][t.coord.x]=nt.EMPTY,i.push(t.coord));let g=e.isOnBoard(a)&&o!==nt.EMPTY;for(;g;){c.equalsValue(s)?u++:c.equalsValue(l)&&u--;const y=f[a.y][a.x];y===nt.MOUNTAIN&&(u-=.9),f[a.y][a.x]=o,i.push(a),o=y,a=a.getNext(s),c=o.getOptionalDirection(),g=e.isOnBoard(a)&&o!==nt.EMPTY&&u>0}return!1===e.isOnBoard(a)&&(c.equalsValue(s)?u++:c.equalsValue(l)&&u--),u<=0?X.failure(Tu.NOT_ENOUGH_FORCE_TO_PUSH()):X.success(new ree(f,i))}isStraight(t,e){const n=t.getDirection();return e.direction.equalsValue(n)&&n===e.landingOrientation}isLegalRotation(t,e){const n=t.coord,i=e.getPieceAt(n),o=e.getCurrentPlayer();if(i.getDirection()===t.landingOrientation)return X.failure(Tu.MUST_MOVE_OR_ROTATE());const s=e.getCopiedBoard();return s[n.y][n.x]=nt.of(t.landingOrientation,o),X.success(new ree(s,[n]))}applyLegalMove(t,e,n,i){const o=rt.copy(i.resultingBoard);return new Rl(o,e.turn+1)}getScoreFromShortestDistances(t,e,n){t===Number.MAX_SAFE_INTEGER&&(t=6),e===Number.MAX_SAFE_INTEGER&&(e=6);const i=6-t,o=6-e;return i===o?n.getScoreModifier():i>o?-10*(i+1)+(o+1):10*(o+1)-(i+1)}getMountainsRowsAndColumns(t){const e=[],n=[];let i=0;for(const o of t.getCoordsAndContents())o.content===nt.MOUNTAIN&&(!1===e.includes(o.coord.y)&&e.push(o.coord.y),!1===n.includes(o.coord.x)&&n.push(o.coord.x),i++);return{rows:e,columns:n,nbMountain:i}}getWinner(t,e,n,i){return n===i.numberOfBonusMountain?this.getPusher(t,e.get()):B.NONE}getPusher(t,e){const n=e.coord;let i;i=t.isOnBoard(n)?t.getPieceAt(n.getNext(e.landingOrientation)):this.getInsertedPiece(n,t.getCurrentOpponent(),t.getWidth());const o=i.getDirection(),s=this.getPusherCoord(t,o,n),a=t.getPieceAt(s).getOwner();return Ae.display("SiamRules","getPusher",n.toString()+" belong to "+t.getCurrentOpponent().getValue()+", "+s.toString()+" belong to "+a.getValue()+", "+a.getValue()+" win"),a}getPusherCoord(t,e,n){let i=n.getNext(e),o=n;for(;t.isOnBoard(i);){n=i,i=i.getNext(e);const s=t.getPieceAt(n);s!==nt.MOUNTAIN&&s.getDirection()===e&&(o=n)}return o}getPushers(t,e,n,i){let o=[];const s=[];for(const a of e){let c=Ie.DOWN,l=new _(a,i.height-1);s.push({direction:c,fallingCoord:l}),c=Ie.UP,l=new _(a,0),s.push({direction:c,fallingCoord:l})}for(const a of n){let c=Ie.LEFT,l=new _(0,a);s.push({direction:c,fallingCoord:l}),c=Ie.RIGHT,l=new _(i.width-1,a),s.push({direction:c,fallingCoord:l})}for(const a of s)o=this.addPotentialDirectionPusher(t,a.fallingCoord,a.direction,o,i);return o}addPotentialDirectionPusher(t,e,n,i,o){const s=this.getLineClosestPusher(t,e,n,o);if(s.isAbsent())return i;const a=s.get();return i.push({coord:a.coord,distance:a.distance}),i}getInitialLineInfo(t,e,n){return{resistance:n.getOpposite(),previousPiece:t.getPieceAt(e),closestPusher:{coord:e,distance:1},almostPusher:h.empty(),pusherFound:!1,mountainEncountered:!1,missingForce:0}}getLineClosestPusher(t,e,n,i){let o=this.getInitialLineInfo(t,e,n);for(;t.isOnBoard(o.closestPusher.coord)&&!1===o.pusherFound;)o=this.updateLineInfo(t,o,n);if(!1===o.pusherFound&&o.almostPusher.isPresent())for(o.closestPusher.distance++,o.missingForce-=1;!1===o.closestPusher.coord.equals(o.almostPusher.get());)o.closestPusher.coord=o.closestPusher.coord.getNext(n),o.closestPusher.distance--;return!1===t.isOnBoard(o.closestPusher.coord)&&(o.missingForce-=1,t.countCurrentPlayerPawn()===i.numberOfPiece)||o.missingForce>0?h.empty():h.of(o.closestPusher)}updateLineInfo(t,e,n){const i=t.getPieceAt(e.closestPusher.coord);if(i.isEmptyOrMountain())i===nt.MOUNTAIN?(e.missingForce+=.9,e.mountainEncountered=!0):e.closestPusher.distance++;else{const o=i.getDirection();o===n?e.mountainEncountered&&(e.missingForce-=1,e.missingForce<=0&&(e.pusherFound=!0,e.closestPusher.coord=e.closestPusher.coord.getNext(n))):o===e.resistance?(e.missingForce+=1,!1===e.mountainEncountered&&e.closestPusher.distance++):e.mountainEncountered?(e.almostPusher=h.of(e.closestPusher.coord),e.previousPiece!==nt.EMPTY&&e.closestPusher.distance++):e.closestPusher.distance++}return e.previousPiece=i,e.closestPusher.coord=e.closestPusher.coord.getPrevious(n),e}getInsertions(t,e){let n=[];const i=e.width-1,o=e.height-1;for(let s=1;s<i;s++)n=n.concat(this.getInsertionsAt(t,s,0,e)),n=n.concat(this.getInsertionsAt(t,s,o,e));for(let s=1;s<o;s++)n=n.concat(this.getInsertionsAt(t,0,s,e)),n=n.concat(this.getInsertionsAt(t,i,s,e));return n=n.concat(this.getInsertionsAt(t,0,0,e)),n=n.concat(this.getInsertionsAt(t,0,o,e)),n=n.concat(this.getInsertionsAt(t,i,0,e)),n=n.concat(this.getInsertionsAt(t,i,o,e)),n}getInsertionsAt(t,e,n,i){const o=[];for(const s of Ie.ORTHOGONALS){const a=new _(e,n).getPrevious(s);if(!1===t.isOnBoard(a))for(const c of Ie.ORTHOGONALS){const l=Ts.of(a.x,a.y,h.of(s),c);L.assert(this.getMoveValidity(l,t).isSuccess(),"SiamRules.getInsertionsAt should only construct valid insertions"),this.isLegal(l,t,h.of(i)).isSuccess()&&o.push(l)}}return o}getMovesFrom(t,e,n,i){const o=new _(n,i);let s=this.getRotationMovesAt(o,e);for(const a of Ie.ORTHOGONALS){const c=o.getNext(a);s=s.concat(this.getForwardMovesBetween(t,o,c))}return s}getMovesBetween(t,e,n,i){return n.equals(i)?this.getRotationMovesAt(n,e):Ie.factory.fromMove(n,i).isSuccess()&&1===n.getDistance(i)?this.getForwardMovesBetween(t,n,i):[]}getRotationMovesAt(t,e){const n=[],i=e.getDirection();for(const o of Ie.ORTHOGONALS)if(o!==i){const s=Ts.of(t.x,t.y,h.empty(),o);n.push(s)}return n}getForwardMovesBetween(t,e,n){const i=[];let o;const s=Ie.factory.fromMove(e,n).get(),a=t.getPieceAt(e);o=t.isOnBoard(n)?Ie.ORTHOGONALS:[s];for(const c of o){const l=Ts.of(e.x,e.y,h.of(s),c);this.isLegalForwarding(l,t,a).isSuccess()&&i.push(l)}return i}getGameStatus(t,e){const n=this.getMountainsRowsAndColumns(t.gameState),i=this.getWinner(t.gameState,t.previousMove,n.nbMountain,e.get());return i.isPlayer()?ye.getVictory(i):ye.ONGOING}};Z2=v0=function(r,t,e,n){var s,i=arguments.length,o=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,e):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,t,e,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(t,e,o):s(t,e))||o);return i>3&&o&&Object.defineProperty(t,e,o),o}([Ae.log],Z2);class iee extends Kn{getListMoves(t,e){let n=[];const i=t.gameState.getCurrentPlayer();for(const o of t.gameState.getCoordsAndContents()){const s=o.content;s.belongsTo(i)&&(n=n.concat(Z2.get().getMovesFrom(t.gameState,s,o.coord.x,o.coord.y)))}if(t.gameState.countCurrentPlayerPawn()<e.get().numberOfPiece)for(const o of Z2.get().getInsertions(t.gameState,e.get()))if(o.direction.get().getOpposite()!==o.landingOrientation){if(t.gameState.isEdge(o.coord)&&o.direction.get()!==o.landingOrientation)continue;n.push(o)}return n}}class LVe extends Ha{getBoardValue(t,e){const n=this.getBoardValueInfo(t.gameState,e.get());return mn.of(n.boardValue)}getBoardValueInfo(t,e){const n=Z2.get().getMountainsRowsAndColumns(t),i=n.rows,o=n.columns,s=Z2.get().getPushers(t,o,i,e);let a=Number.MAX_SAFE_INTEGER,c=Number.MAX_SAFE_INTEGER;const l=t.getCurrentPlayer();for(const f of s)t.isOnBoard(f.coord)?t.getPieceAt(f.coord).belongsTo(O.ZERO)?a=Math.min(a,f.distance):c=Math.min(c,f.distance):l===O.ZERO?a=Math.min(a,f.distance):c=Math.min(c,f.distance);return{shortestZero:a,shortestOne:c,boardValue:Z2.get().getScoreFromShortestDistances(a,c,l)}}}class zVe extends fn{constructor(){super($localize`Minimax`,Z2.get(),new LVe,new iee)}}function VVe(r,t){if(1&r){const e=he();I(),E(0,"use",11),q("click",function(){te(e);const i=p().index,o=p().index;return ne(p().clickSquare(i,o))}),P()}if(2&r){const e=p(),n=e.index,i=e.$implicit,o=p().index,s=p();ve("id","piece_",n,"_",o,""),v("ngClass",s.getPieceClasses(n,o,i)),A("transform",s.getPiceRotation(n,o))}}function HVe(r,t){if(1&r){const e=he();I(),E(0,"use",12),q("click",function(){te(e);const i=p().index,o=p().index;return ne(p().clickSquare(i,o))}),P()}}function FVe(r,t){if(1&r){const e=he();I(),E(0,"g")(1,"rect",8),q("click",function(){const o=te(e).index,s=p().index;return ne(p().clickSquare(o,s))}),P(),z(2,VVe,1,4,"use",9)(3,HVe,1,0,"use",10),P()}if(2&r){const e=t.$implicit,n=t.index,i=p().index,o=p();A("transform","translate("+n*o.SPACE_SIZE+" "+i*o.SPACE_SIZE+")"),m(),ve("id","square_",n,"_",i,""),v("ngClass",o.getSquareClasses(n,i)),A("x",o.SPACE_SIZE*n*0)("y",o.SPACE_SIZE*i*0)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),m(),v("ngIf",e.isPiece()),m(),v("ngIf",o.isMountain(e))}}function UVe(r,t){if(1&r&&(I(),E(0,"g"),z(1,FVe,4,10,"g",4),P()),2&r){const e=t.$implicit;m(),v("ngForOf",e)}}function GVe(r,t){if(1&r){const e=he();I(),E(0,"rect",15),q("click",function(){te(e);const i=p().$implicit;return ne(p().clickSquare(i.x,i.y))}),P()}if(2&r){const e=p().$implicit,n=p();ve("id","square_",e.x,"_",e.y,""),v("ngClass",n.getSquareClasses(e.x,e.y)),A("x",n.SPACE_SIZE*e.x)("y",n.SPACE_SIZE*e.y)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}function BVe(r,t){if(1&r){const e=he();I(),E(0,"g"),z(1,GVe,1,7,"rect",13),E(2,"rect",14),q("click",function(){const o=te(e).$implicit;return ne(p().clickSquare(o.x,o.y))}),P()()}if(2&r){const e=t.$implicit,n=p();m(),v("ngIf",!1===n.getState().isOnBoard(e)),m(),A("x",n.SPACE_SIZE*e.x)("y",n.SPACE_SIZE*e.y)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}function $Ve(r,t){if(1&r){const e=he();I(),E(0,"rect",16),q("click",function(){te(e);const i=p();return ne(i.clickSquare(i.selectedLanding.get().x,i.selectedLanding.get().y))}),P()}if(2&r){const e=p();A("x",e.SPACE_SIZE*e.selectedLanding.get().x)("y",e.SPACE_SIZE*e.selectedLanding.get().y)("width",e.SPACE_SIZE)("height",e.SPACE_SIZE)}}function WVe(r,t){if(1&r){const e=he();I(),E(0,"rect",16),q("click",function(){te(e);const i=p();return ne(i.clickSquare(i.selectedPiece.get().x,i.selectedPiece.get().y))}),P()}if(2&r){const e=p();A("x",e.SPACE_SIZE*e.selectedPiece.get().x)("y",e.SPACE_SIZE*e.selectedPiece.get().y)("width",e.SPACE_SIZE)("height",e.SPACE_SIZE)}}function qVe(r,t){if(1&r&&(I(),V(0,"use",19)),2&r){const e=t.$implicit,n=p().$implicit,i=p();ve("id","remainingPieces_",n.getValue(),"_",e,""),v("ngClass",i.getRemainingPieceClasses(n,e)),A("transform",i.getRemainingPieceTransform(e,n))}}function jVe(r,t){if(1&r){const e=he();I(),E(0,"g",17),q("click",function(){const o=te(e).$implicit;return ne(p().selectPieceForInsertion(o))}),z(1,qVe,1,4,"use",18),P()}if(2&r){const e=t.$implicit,n=p();Tn("id","remainingPieces_",e.getValue(),""),m(),v("ngForOf",n.ArrayUtils.range(n.playerPieces(e)))}}function ZVe(r,t){if(1&r){const e=he();I(),E(0,"use",22),q("click",function(){te(e);const i=p().$implicit;return ne(p().clickSquare(i.source.get().coord.x,i.source.get().coord.y))}),P()}if(2&r){const e=p().$implicit,n=p();v("ngClass",n.getPieceClasses(e.source.get().coord.x,e.source.get().coord.y,e.source.get().piece)),A("transform",n.getPieceTransform(e.source.get().coord.x,e.source.get().coord.y))}}function YVe(r,t){if(1&r){const e=he();I(),E(0,"g")(1,"use",20),q("click",function(){const o=te(e).$implicit;return ne(p().clickArrow(o))}),P(),z(2,ZVe,1,2,"use",21),P()}if(2&r){const e=t.$implicit,n=p();m(),Ur("id","indicator_",e.target.x,"_",e.target.y,"_",e.direction.toString(),""),A("transform",n.getIndicatorTransform(e)),m(),v("ngIf",e.source.isPresent())}}let av=class vR extends p2{SiamState=Rl;lastMove=h.empty();movedPieces=[];selectedPiece=h.empty();selectedLanding=h.empty();orientations=[];clickableCoords=new st;indicatorArrows=[];insertingPiece=!1;constructor(t){super(t),this.setRulesAndNode("Siam"),this.availableAIs=[new zVe,new zn($localize`MCTS`,new iee,this.rules)],this.encoder=Ts.encoder}getViewBox(){return super.getViewBox().expand(0,0,this.SPACE_SIZE,this.SPACE_SIZE)}updateBoard(t){var e=this;return M(function*(){const n=e.getState();e.board=n.board})()}showLastMove(t){var e=this;return M(function*(){e.lastMove=h.of(t);const n=e.getPreviousState(),i=e.getConfig();e.movedPieces=e.rules.isLegal(e.lastMove.get(),n,i).get().moved})()}hideLastMove(){this.lastMove=h.empty(),this.movedPieces=[]}cancelMoveAttempt(){this.insertingPiece=!1,this.selectedPiece=h.empty(),this.selectedLanding=h.empty(),this.orientations=[],this.clickableCoords=new st,this.indicatorArrows=[]}selectPieceForInsertion(t){var e=this;return M(function*(){const n=yield e.canUserPlay("#remainingPieces_"+t.getValue());if(n.isFailure())return e.cancelMove(n.getReason());if(t===e.getCurrentOpponent())return e.cancelMove(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT());if(e.insertingPiece)return e.cancelMoveAttempt(),w.SUCCESS;e.cancelMoveAttempt();const i=e.getConfig().get();for(const o of Z2.get().getInsertions(e.getState(),i)){const s=o.coord.getNext(o.direction.get());if(e.board[s.y][s.x]!==nt.EMPTY){const a={source:h.empty(),target:s,direction:o.direction.get(),move:o};e.indicatorArrows.push(a)}e.clickableCoords.add(s)}return e.insertingPiece=!0,w.SUCCESS})()}selectOrientation(t){var e=this;return M(function*(){const n=yield e.canUserPlay("#orientation_"+t.landingOrientation.toString());return n.isFailure()?e.cancelMove(n.getReason()):e.chooseMove(t)})()}clickSquare(t,e,n=!0){var i=this;return M(function*(){if(n){const s=yield i.canUserPlay("#square_"+t+"_"+e);if(s.isFailure())return i.cancelMove(s.getReason())}const o=new _(t,e);if(i.insertingPiece)return i.insertPiece(o);if(i.selectedLanding.isPresent())return i.cancelMoveAttempt(),w.SUCCESS;if(i.selectedPiece.isPresent()){i.selectedLanding=h.of(o);const s=Z2.get().getMovesBetween(i.getState(),i.getState().getPieceAt(i.selectedPiece.get()),i.selectedPiece.get(),o);return 0===s.length?i.changeMoveDestinationClick(o):i.performMoveOrShowOrientationArrows(s)}{L.assert(i.getState().isOnBoard(o),"SiamComponent: user clicked outside of board when it should not be possible");const s=i.board[e][t];return s.getOwner()===B.NONE?i.cancelMove(Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):s.getOwner()!==i.getCurrentPlayer()?i.cancelMove(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT()):i.selectPiece(o,s)}})()}insertPiece(t){var e=this;return M(function*(){if(e.selectedLanding.isPresent())return yield e.cancelMove(Tu.MUST_SELECT_ORIENTATION()),w.SUCCESS;e.selectedLanding=h.of(t);const n=e.getConfig().get(),i=Z2.get().getInsertionsAt(e.getState(),t.x,t.y,n);return 0===i.length?e.changeMoveDestinationClick(t):e.performMoveOrShowOrientationArrows(i)})()}changeMoveDestinationClick(t){var e=this;return M(function*(){return e.cancelMoveAttempt(),e.getState().getPieceAt(t).getOwner()===e.getCurrentPlayer()?e.clickSquare(t.x,t.y,!1):e.cancelMove(Tu.MUST_SELECT_VALID_DESTINATION())})()}performMoveOrShowOrientationArrows(t){var e=this;return M(function*(){return L.assert(t.length>0,"SiamComponent.performMoveOrShowOrientationArrows expects at least one move"),1===t.length?e.chooseMove(t[0]):(e.clickableCoords=new st,e.indicatorArrows=[],e.orientations=t,w.SUCCESS)})()}selectPiece(t,e){this.cancelMoveAttempt();const n=this.getState();this.selectedPiece=h.of(t);const i=Z2.get().getMovesFrom(n,e,t.x,t.y);for(const o of i)if(o.direction.isPresent()){const s=o.coord.getNext(o.direction.get());if(this.clickableCoords.add(s),n.isOnBoard(s)&&n.getPieceAt(s)!==nt.EMPTY){const a={source:h.of({coord:t,piece:e}),target:s,direction:o.direction.get(),move:o};this.indicatorArrows.push(a)}}else this.clickableCoords.add(o.coord);return w.SUCCESS}clickArrow(t){var e=this;return M(function*(){const n=yield e.canUserPlay("#indicator_"+t.target.x+"_"+t.target.y+"_"+t.move.landingOrientation);return n.isFailure()?e.cancelMove(n.getReason()):e.chooseMove(t.move)})()}isMountain(t){return t===nt.MOUNTAIN}getArrowTransform(t,e,n){const i=n.toInt()-2,o=this.getRotation(i);return["translate("+t*this.SPACE_SIZE+", "+e*this.SPACE_SIZE+")",o].join(" ")}getRotation(t){return`rotate(${90*t} ${this.SPACE_SIZE/2} ${this.SPACE_SIZE/2})`}getPiceRotation(t,e){const i=this.board[e][t].getDirection().toInt()-2;return this.getRotation(i)}getPieceTransform(t,e){return this.getArrowTransform(t,e,this.board[e][t].getDirection())}getIndicatorTransform(t){const e=t.target.getPrevious(t.direction,.5);return this.getArrowTransform(e.x,e.y,t.direction)}getRemainingPieceTransform(t,e){const n=this.getConfig().get(),i=n.width/2,s=this.getState().countPlayersPawn().get(e),c=1+.5*(n.numberOfPiece-s-1);let l,u,f;return e===this.getPointOfView()?(l=i-c/2+.5*t,u=n.height,f=Ie.LEFT):(l=i+c/2-1-.5*t,u=-1,f=Ie.RIGHT),this.getArrowTransform(l,u,f)}getPieceClasses(t,e,n){const i=new _(t,e),o=[this.getPlayerClass(n.getOwner())];return this.selectedPiece.equalsValue(i)&&o.push("selected-stroke"),o}getSquareClasses(t,e){const n=new _(t,e);return this.movedPieces.some(i=>i.equals(n))?["moved-fill"]:[]}getRemainingPieceClasses(t,e){const n=[this.getPlayerClass(t)];return this.insertingPiece&&this.getCurrentPlayer()===t&&e===this.playerPieces(t)-1&&n.push("selected-stroke"),n}playerPieces(t){return this.getConfig().get().numberOfPiece-this.getState().countPlayersPawn().get(t)}static \u0275fac=function(e){return new(e||vR)(G(Ut))};static \u0275cmp=Ue({type:vR,selectors:[["app-siam"]],features:[$e],decls:12,vars:10,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["id","triangle","points","0 -6, 10 0, 0 6"],["id","mountain","points","5 95, 16 68, 24 76, 48 28, 64 60, 72 44, 95 95, 5 95"],["id","siamBoard"],[4,"ngFor","ngForOf"],["class","base no-fill small-stroke selected-stroke",3,"click",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],["app-siam-orientation-arrow","",3,"orientations","currentPlayer","config","moveEmitter"],[1,"base",3,"id","ngClass","click"],["class","base mid-stroke",0,"xlink","href","#arrow",3,"id","ngClass","click",4,"ngIf"],[0,"xlink","href","#mountain","class","nonplayer-fill",3,"click",4,"ngIf"],[0,"xlink","href","#arrow",1,"base","mid-stroke",3,"id","ngClass","click"],[0,"xlink","href","#mountain",1,"nonplayer-fill",3,"click"],["class","base semi-transparent",3,"id","ngClass","click",4,"ngIf"],[1,"base","no-fill","small-stroke","clickable-stroke",3,"click"],[1,"base","semi-transparent",3,"id","ngClass","click"],[1,"base","no-fill","small-stroke","selected-stroke",3,"click"],[3,"id","click"],["class","base mid-stroke",0,"xlink","href","#arrow",3,"id","ngClass",4,"ngFor","ngForOf"],[0,"xlink","href","#arrow",1,"base","mid-stroke",3,"id","ngClass"],[0,"xlink","href","#arrow",1,"base","mid-stroke","indicator-fill",3,"id","click"],["class","base mid-stroke",0,"xlink","href","#arrow",3,"ngClass","click",4,"ngIf"],[0,"xlink","href","#arrow",1,"base","mid-stroke",3,"ngClass","click"]],template:function(e,n){1&e&&(I(),E(0,"svg",0)(1,"defs"),V(2,"polygon",1)(3,"polygon",2),P(),E(4,"g",3),z(5,UVe,2,1,"g",4),P(),z(6,BVe,3,5,"g",4)(7,$Ve,1,4,"rect",5)(8,WVe,1,4,"rect",5)(9,jVe,2,2,"g",6)(10,YVe,3,5,"g",4),E(11,"g",7),q("moveEmitter",function(o){return n.selectOrientation(o)}),P()()),2&e&&(A("viewBox",n.getViewBox().toSVGString()),m(5),v("ngForOf",n.board),m(),v("ngForOf",n.clickableCoords),m(),v("ngIf",n.selectedLanding.isPresent()),m(),v("ngIf",n.selectedPiece.isPresent()),m(),v("ngForOf",n.Player.PLAYERS),m(),v("ngForOf",n.indicatorArrows),m(),v("orientations",n.orientations)("currentPlayer",n.getCurrentPlayer())("config",n.getConfig().get()))},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})};av=function(r,t,e,n){var s,i=arguments.length,o=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,e):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,t,e,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(t,e,o):s(t,e))||o);return i>3&&o&&Object.defineProperty(t,e,o),o}([Ae.log],av);const Le=nt.EMPTY,ws=nt.MOUNTAIN,KVe=nt.LIGHT_UP,ek=nt.LIGHT_LEFT,oee=nt.LIGHT_RIGHT,XVe=nt.LIGHT_DOWN,tk=nt.DARK_UP,see=nt.DARK_LEFT,wu=nt.DARK_RIGHT,QVe=nt.DARK_DOWN,aee=Z2.get().getDefaultRulesConfig();class JVe extends Wn{tutorial=[W.informational($localize`Goal of the game`,$localize`The goal at Siam is to be the first to push a mountain out of the board. The initial board contains three mountains, and no pieces are initially on the board. During its turn, a player can do one of the following actions:<ol><li>Put a new piece on the board.</li><li>Change the orientation of one of its piece</li><li>Move one of its piece and optionally reorient it.</li><li>Take one of its pieces out of the board.</li></ol>`,Z2.get().getInitialState(aee)),W.anyMove($localize`Inserting a piece`,$localize`Each player has 5 pieces in total. As long as you have remaining pieces next to the board, you can insert new pieces. To do so:<ol><li>Click on one of your pieces from your reserve, next to board.</li><li>Click on one of the highlighted squares to select a landing for your piece.</li><li>Select an orientation for your piece by clicking on one of the arrows that appear on top of the board.</li></ol><br/>You're playing Dark, insert a piece on the board.`,Z2.get().getInitialState(aee),Ts.of(2,-1,h.of(Ie.DOWN),Ie.DOWN),pe.CONGRATULATIONS()),W.fromMove($localize`Moving a piece`,$localize`We will distinguish here "moving" and "pushing". A move is made from a piece's square to an empty neighboring square, horizontally or vertically. You can also move a piece out of the board. To move a piece:<ol><li>Click on it.</li><li>Click on the square on which you want the piece to move. You can also click a second time on your piece to change its orientation without moving it.</li><li>Select the orientation of your piece by clicking one one of the arrows that appear on top of the board.</li></ol><br/>You're playing Dark. Try to move your piece that is already on the board one square upwards and to orient it to the left.`,new Rl([[Le,Le,Le,Le,Le],[Le,Le,Le,Le,Le],[Le,ws,ws,ws,Le],[Le,Le,Le,Le,Le],[Le,Le,tk,Le,Le]],0),[Ts.of(2,4,h.of(Ie.UP),Ie.LEFT)],$localize`Congratulations, you made a side-slip!`,pe.FAILED_TRY_AGAIN()),W.fromMove($localize`Moving a piece out of the board`,$localize`To move a piece out of the board, you do not have to pick an orientation after the move.<br/><br/> You're playing Dark, get that piece out of the board!`,new Rl([[Le,Le,Le,Le,Le],[Le,Le,Le,Le,Le],[Le,ws,ws,ws,Le],[Le,Le,Le,Le,Le],[Le,Le,tk,Le,Le]],0),[Ts.of(2,4,h.of(Ie.DOWN),Ie.DOWN)],$localize`Congratulations, even if in this context it was not a useful move.`,$localize`Failed, the piece is still on the board.`),W.fromMove($localize`Pushing (1/2)`,$localize`When the landing square of your move is occupied, we use the term "push". In order to push player pieces, the following conditions must hold:<ol><li>Your piece must already be oriented in the direction of the push.</li><li>Along the line that you are pushing, the number of pieces (yours or your opponent's) that are oriented in the same way as the push should be strictly greater than the number of pieces oriented in the opposite way.</li></ol>Look closely at the board. On the first row, you cannot push as there is exactly one piece in the opposite direction. On the second row, you can push because there are two pieces against one.<br/><br/>You're playing Dark. Vertically, you can push using your piece in the center, as there is no resistance on that axis. Do it.`,new Rl([[Le,wu,ek,Le,Le],[wu,oee,ek,Le,Le],[Le,Le,tk,Le,Le],[Le,Le,Le,Le,Le],[Le,Le,Le,Le,Le]],0),[Ts.of(2,2,h.of(Ie.UP),Ie.UP)],pe.CONGRATULATIONS(),pe.FAILED_TRY_AGAIN()),W.fromMove($localize`Pushing (2/2)`,$localize`To be able to push a mountain, you need at least one pusher per mountain. Each resistant (pieces in the opposite way) cancel the force of one pusher. In short, if there is no mountain, you need strictly more pushers than resistants. If there is a mountain, you need at least as much pushers than there are resistants and mountains. On the following board, as Dark, you can push the mountain on the first row. On the second and third row, because of the resisting forces, you cannot push. On the fourth row, you can push as there is one more pusher than resistant pieces.<br/><br/>You're playing Dark, push on the fourth row it.`,new Rl([[Le,Le,wu,ws,Le],[Le,Le,wu,ws,see],[Le,wu,ws,ws,Le],[Le,wu,oee,ek,ws],[Le,Le,Le,Le,Le]],0),[Ts.of(1,3,h.of(Ie.RIGHT),Ie.RIGHT)],$localize`Congratulations! Note that this move made you lose the game, you will see why in the next step.`,pe.FAILED_TRY_AGAIN()),W.fromMove($localize`Victory`,$localize`The game ends when a mountain is pushed out of the board. If you pushed it and nobody is in front of you, you're the winner. However, if you were pushing an opponent oriented in the same direction as you, your opponent will win because that piece is closer to the mountain. However, if that opponent is closer to the mountain but not oriented towards it, victory will be yours.<br/><br/>Here, playing Dark, you can push a mountain off the board and either win, or lose. Choose correctly!`,new Rl([[Le,Le,Le,Le,Le],[Le,Le,Le,Le,Le],[ws,KVe,see,Le,QVe],[Le,Le,Le,Le,XVe],[Le,Le,Le,Le,ws]],0),[Ts.of(2,2,h.of(Ie.LEFT),Ie.LEFT)],pe.CONGRATULATIONS_YOU_WON(),$localize`Failed, you lost.`)]}class Lr extends h2{start;landing;keep;static encoder=ke.tuple([h.getEncoder(_.encoder),_.encoder,h.getEncoder(_.encoder)],t=>[t.start,t.landing,t.keep],t=>Lr.of(t[0],t[1],t[2]));static of(t,e,n){return new Lr(t,e,n)}static ofDrop(t){return new Lr(h.empty(),t,h.empty())}static ofMovement(t,e){return new Lr(h.of(t),e,h.empty())}static ofCut(t,e,n){return new Lr(h.of(t),e,h.of(n))}constructor(t,e,n){super(),this.start=t,this.landing=e,this.keep=n,L.assert(!1===t.equalsValue(e),"Deplacement cannot be static!"),L.assert(t.isAbsent()||!1===t.equals(n),"Cannot keep starting coord, since it will always be empty after move!")}isDrop(){return this.start.isAbsent()}isCut(){return this.keep.isPresent()}toString(){return this.isDrop()?"SixMove("+this.landing.toString()+")":this.isCut()?"SixMove("+this.start.get().toString()+" > "+this.landing+", keep: "+this.keep.get().toString()+")":"SixMove("+this.start.get().toString()+" > "+this.landing+")"}equals(t){return!1!==this.landing.equals(t.landing)&&!1!==this.start.equals(t.start)&&this.keep.equals(t.keep)}}let Ka=(()=>class r{static NO_MOVEMENT_BEFORE_TURN_40=()=>$localize`You cannot move yet. Pick a space where you will put a new piece.`;static MUST_CUT=()=>$localize`Several groups are of the same size, you must pick the one to keep.`;static CANNOT_CHOOSE_TO_KEEP=()=>$localize`You cannot choose which part to keep when one is smaller than the other.`;static CAN_NO_LONGER_DROP=()=>$localize`You cannot put new pieces anymore. Pick a piece to move.`;static MUST_CAPTURE_BIGGEST_GROUPS=()=>$localize`You must choose one of the biggest groups to keep it.`;static CANNOT_KEEP_EMPTY_COORD=()=>$localize`You cannot pick an empty space. Pick one of the biggest groups.`;static MUST_DROP_NEXT_TO_OTHER_PIECE=()=>$localize`You must put this piece next to another piece.`})();class $o extends wJ{static ofRepresentation(t,e,n=new Gt(0,0)){const i=new nu;for(let o=0;o<t.length;o++)for(let s=0;s<t[0].length;s++)if(t[o][s]!==B.NONE){const a=new _(s,o).getNext(n);i.set(a,t[o][s])}return new $o(i,e)}movePiece(t){const e=this.pieces.getCopy();return e.delete(t.start.get()),e.set(t.landing,this.getCurrentPlayer()),new $o(e,this.turn)}toRepresentation(){const t=rt.create(this.width,this.height,B.NONE);for(const e of this.pieces.listKeys()){const n=this.getPieceAt(e);t[e.y][e.x]=n}return t}isIllegalLandingZone(t,e){return this.pieces.containsKey(t)?w.failure(Ee.MUST_LAND_ON_EMPTY_SPACE()):this.isCoordConnected(t,e)?w.SUCCESS:w.failure(Ka.MUST_DROP_NEXT_TO_OTHER_PIECE())}isCoordConnected(t,e){for(const n of bi.getNeighbors(t))if(this.pieces.containsKey(n)&&!1===e.equalsValue(n))return!0;return!1}getPieceAt(t){return this.isOnBoard(t)?this.pieces.get(t).get():B.NONE}applyLegalDrop(t){const e=this.pieces.getCopy();return e.put(t,this.getCurrentPlayer()),new $o(e,this.turn+1)}applyLegalDeplacement(t,e){const n=this.movePiece(t);if(e.size()>0){const i=new nu;for(const o of e)i.set(o,n.getPieceAt(o));return new $o(i,this.turn+1)}return new $o(n.pieces,this.turn+1)}countPieces(){const t=this.pieces.reverse(),e=t.get(O.ZERO).getOrElse(new ir),n=t.get(O.ONE).getOrElse(new ir);return we.of(e.size(),n.size())}switchPiece(t){const e=this.pieces.getCopy(),n=this.getPieceAt(t);if(n.isPlayer())return e.replace(t,n.getOpponent()),new $o(e,this.turn);u2.logErrorAndFail("SixState","Cannot switch piece if there is no piece!",{coord:t.toString()})}equals(t){return this.turn===t.turn&&this.pieces.equals(t.pieces)}}var xl;let i3=class extends Ar{static#e=xl=this;static singleton=h.empty();currentVictorySource;static get(){return xl.singleton.isAbsent()&&(xl.singleton=h.of(new xl)),xl.singleton.get()}getInitialState(){return $o.ofRepresentation([[O.ZERO],[O.ONE]],0)}applyLegalMove(t,e,n,i){return e.turn<40?e.applyLegalDrop(t.landing):e.applyLegalDeplacement(t,i)}isLegal(t,e){const n=e.isIllegalLandingZone(t.landing,t.start);return n.isFailure()?n.toOtherFallible():e.turn<40?this.isLegalDrop(t,e):xl.isLegalPhaseTwoMove(t,e)}static getLegalLandings(t){const e=new ir;for(const n of t.getPieceCoords())for(const i of Te.factory.all){const o=n.getNext(i,1);t.getPieceAt(o)===B.NONE&&e.add(o)}return e.toList()}isLegalDrop(t,e){return!1===t.isDrop()?X.failure(Ka.NO_MOVEMENT_BEFORE_TURN_40()):X.success(new st(e.getPieceCoords()))}static isLegalPhaseTwoMove(t,e){if(t.isDrop())return X.failure(Ka.CAN_NO_LONGER_DROP());const n=e.getPieceAt(t.start.get());if(n===B.NONE)return X.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(n===e.getCurrentOpponent())return X.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT());const i=e.movePiece(t),o=i.getGroups();if(xl.isSplit(o)){const s=this.getLargestGroups(o);return 1===s.size()?t.keep.isPresent()?X.failure(Ka.CANNOT_CHOOSE_TO_KEEP()):X.success(s.getAnyElement().get()):this.moveKeepBiggerGroup(t.keep,s,i)}return X.success(new ir)}static isSplit(t){return t.size()>1}static getLargestGroups(t){let e=0,n=new st;for(const i of t){const o=i.size();o>e?(e=o,n=new st([i])):o===e&&n.add(i)}return n}static moveKeepBiggerGroup(t,e,n){if(t.isAbsent())return X.failure(Ka.MUST_CUT());if(n.getPieces().get(t.get()).isAbsent())return X.failure(Ka.CANNOT_KEEP_EMPTY_COORD());const i=t.get();for(const o of e)if(o.contains(i))return X.success(o);return X.failure(Ka.MUST_CAPTURE_BIGGEST_GROUPS())}getGameStatus(t){const e=t.gameState,n=e.getCurrentOpponent();let i=[];if(t.previousMove.isPresent()&&(i=this.getShapeVictory(t.previousMove.get(),e)),6===i.length)return ye.getVictory(n);if(e.turn>39){const o=e.countPieces(),s=o.get(O.ZERO),a=o.get(O.ONE);return s<6&&a<6?s<a?ye.ONE_WON:a<s?ye.ZERO_WON:ye.DRAW:s<6?ye.getDefeat(O.ZERO):a<6?ye.getDefeat(O.ONE):ye.ONGOING}return ye.ONGOING}startSearchingVictorySources(){this.currentVictorySource={typeSource:"LINE",index:-1}}getShapeVictory(t,e){for(this.startSearchingVictorySources();this.hasNextVictorySource();){this.getNextVictorySource();const n=this.searchVictoryOnly(this.currentVictorySource,t,e);if(6===n.length)return n}return[]}hasNextVictorySource(){return"CIRCLE"!==this.currentVictorySource.typeSource||5!==this.currentVictorySource.index}getNextVictorySource(){if(5===this.currentVictorySource.index){let e;switch(this.currentVictorySource.typeSource){case"LINE":e="TRIANGLE_CORNER";break;case"TRIANGLE_CORNER":e="TRIANGLE_EDGE";break;default:e="CIRCLE"}this.currentVictorySource={typeSource:e,index:0}}else{let e=1;"LINE"===this.currentVictorySource.typeSource&&(e=2),this.currentVictorySource={typeSource:this.currentVictorySource.typeSource,index:this.currentVictorySource.index+e}}return this.currentVictorySource}searchVictoryOnly(t,e,n){const i=e.landing;switch(t.typeSource){case"LINE":return this.searchVictoryOnlyForLine(t.index,i,n);case"CIRCLE":return this.searchVictoryOnlyForCircle(t.index,i,n);case"TRIANGLE_CORNER":return this.searchVictoryOnlyForTriangleCorner(t.index,i,n);default:return this.searchVictoryOnlyForTriangleEdge(t.index,i,n)}}searchVictoryOnlyForCircle(t,e,n){const i=n.getCurrentOpponent(),s=[e];let a=e.getNext(Te.factory.all[t],1);for(;s.length<6;){if(n.getPieceAt(a)!==i)return[];const l=(t+s.length)%6;s.push(a),a=a.getNext(Te.factory.all[l],1)}return s}searchVictoryOnlyForLine(t,e,n){const i=n.getCurrentOpponent();let o=Te.factory.all[t],s=e.getNext(o,1);const a=[e];let c=!1;for(;a.length<6;){if(n.getPieceAt(s)===i)a.push(s);else{if(c)return[];c=!0,o=o.getOpposite(),s=s.getNext(o,a.length)}s=s.getNext(o,1)}return a}searchVictoryOnlyForTriangleCorner(t,e,n){const i=n.getCurrentOpponent();let o=Te.factory.all[t];const s=[e];let a=e.getNext(o,1);for(;s.length<6;){if(n.getPieceAt(a)!==i)return[];s.length%2==0&&(o=Te.factory.all[(t+s.length)%6]),s.push(a),a=a.getNext(o,1)}return s}searchVictoryOnlyForTriangleEdge(t,e,n){const i=n.getCurrentOpponent();let o=Te.factory.all[t];const s=[e];let a=e.getNext(o,1);for(;s.length<6;){if(n.getPieceAt(a)!==i)return[];s.push(a),s.length%2==0&&(o=Te.factory.all[(t+s.length)%6]),a=a.getNext(o,1)}return s}};i3=xl=function(r,t,e,n){var s,i=arguments.length,o=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,e):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,t,e,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(t,e,o):s(t,e))||o);return i>3&&o&&Object.defineProperty(t,e,o),o}([Ae.log],i3);class tHe extends Ha{calculateBoardValue(t,e){this.startSearchingVictorySources();const n={status:c1.DEFAULT,victory:h.empty(),preVictory:h.empty(),sum:0};for(;this.hasNextVictorySource();){const i=this.getNextVictorySource();let o;if(o=n.status===c1.PRE_VICTORY?this.searchVictoryOnly(i,t,e):this.getBoardInfo(i,t,e,n),o.status===c1.VICTORY)return o;n.status=o.status,n.sum=n.sum+o.sum,n.preVictory.isAbsent()&&(n.preVictory=o.preVictory)}return n}}class cee extends tHe{VERBOSE=!1;currentVictorySource;getBoardValue(t,e){const n=t.previousMove,i=t.gameState,o=i.getCurrentOpponent(),s=o.getVictoryValue();let a={status:c1.DEFAULT,victory:h.empty(),preVictory:h.empty(),sum:0};if(n.isPresent()&&(a=this.calculateBoardValue(n.get(),i)),a.status===c1.VICTORY)return mn.of(s);if(i.turn>39){const c=i.countPieces();return mn.ofPlayerNumberMap(c)}return mn.of(a.status===c1.PRE_VICTORY?o.getPreVictory():a.sum*o.getScoreModifier())}startSearchingVictorySources(){this.currentVictorySource={typeSource:"LINE",index:-1}}hasNextVictorySource(){return"CIRCLE"!==this.currentVictorySource.typeSource||5!==this.currentVictorySource.index}getNextVictorySource(){if(5===this.currentVictorySource.index){let e;switch(this.currentVictorySource.typeSource){case"LINE":e="TRIANGLE_CORNER";break;case"TRIANGLE_CORNER":e="TRIANGLE_EDGE";break;default:e="CIRCLE"}this.currentVictorySource={typeSource:e,index:0}}else{let e=1;"LINE"===this.currentVictorySource.typeSource&&(e=2),this.currentVictorySource={typeSource:this.currentVictorySource.typeSource,index:this.currentVictorySource.index+e}}return this.currentVictorySource}searchVictoryOnly(t,e,n){const i=e.landing;switch(t.typeSource){case"LINE":return this.searchVictoryOnlyForLine(t.index,i,n);case"CIRCLE":return this.searchVictoryOnlyForCircle(t.index,i,n);case"TRIANGLE_CORNER":return this.searchVictoryOnlyForTriangleCorner(t.index,i,n);default:return this.searchVictoryOnlyForTriangleEdge(t.index,i,n)}}searchVictoryOnlyForCircle(t,e,n){const i=n.getCurrentOpponent(),s=[e];let a=e.getNext(Te.factory.all[t],1);for(;s.length<6;){if(n.getPieceAt(a)!==i)return{status:c1.PRE_VICTORY,victory:h.empty(),preVictory:h.empty(),sum:0};const l=(t+s.length)%6;s.push(a),a=a.getNext(Te.factory.all[l],1)}return{status:c1.VICTORY,victory:h.of(s),preVictory:h.empty(),sum:0}}searchVictoryOnlyForLine(t,e,n){const i=n.getCurrentOpponent();let o=Te.factory.all[t],s=e.getNext(o,1);const a=[e];let c=!1;for(;a.length<6;){if(n.getPieceAt(s)===i)a.push(s);else{if(c)return{status:c1.PRE_VICTORY,victory:h.empty(),preVictory:h.empty(),sum:0};c=!0,o=o.getOpposite(),s=s.getNext(o,a.length-1)}s=s.getNext(o,1)}return{status:c1.VICTORY,victory:h.of(a),preVictory:h.empty(),sum:0}}searchVictoryOnlyForTriangleCorner(t,e,n){const i=n.getCurrentOpponent();let o=Te.factory.all[t];const s=[e];let a=e.getNext(o,1);for(;s.length<6;){if(n.getPieceAt(a)!==i)return{status:c1.PRE_VICTORY,victory:h.empty(),preVictory:h.empty(),sum:0};s.length%2==0&&(o=Te.factory.all[(t+s.length)%6]),s.push(a),a=a.getNext(o,1)}return{status:c1.VICTORY,victory:h.of(s),preVictory:h.empty(),sum:0}}searchVictoryOnlyForTriangleEdge(t,e,n){const i=n.getCurrentOpponent();let o=Te.factory.all[t];const s=[e];let a=e.getNext(o,1);for(;s.length<6;){if(n.getPieceAt(a)!==i)return{status:c1.PRE_VICTORY,victory:h.empty(),preVictory:h.empty(),sum:0};s.push(a),s.length%2==0&&(o=Te.factory.all[(t+s.length)%6]),a=a.getNext(o,1)}return{status:c1.VICTORY,victory:h.of(s),preVictory:h.empty(),sum:0}}getBoardInfo(t,e,n,i){const o=e.landing;switch(t.typeSource){case"CIRCLE":return this.getBoardInfoForCircle(t.index,o,n,i);case"LINE":return this.getBoardInfoForLine(t.index,o,n,i);case"TRIANGLE_CORNER":return this.getBoardInfoForTriangleCorner(t.index,o,n,i);default:return this.getBoardInfoForTriangleEdge(t.index,o,n,i)}}getBoardInfoForCircle(t,e,n,i){const o=n.getCurrentPlayer(),a=[e];let c=e.getNext(Te.factory.all[t],1),l=0,u=h.empty();for(;a.length<6;){const f=n.getPieceAt(c);if(f===o)return i;const g=(t+a.length)%6;a.push(c);const y=Te.factory.all[g];f===B.NONE?(l+=.16,u=h.of(c)):l++,c=c.getNext(y,1)}return this.getBoardInfoResult(l,u,a,i)}getBoardInfoResult(t,e,n,i){let o=i.preVictory;if(4.16===t){if(o.isPresent()&&!1===o.equals(e))return{status:c1.PRE_VICTORY,victory:h.empty(),preVictory:h.empty(),sum:0};o=e}else if(5===t)return{status:c1.VICTORY,victory:h.of(n),preVictory:h.empty(),sum:0};return{status:i.status,victory:h.empty(),preVictory:o,sum:i.sum+t}}getBoardInfoForLine(t,e,n,i){const o=Te.factory.all[t];let s=e.getPrevious(o,5),a=[],c=[],l=h.empty();for(let N=0;N<6;N++){const R=this.updateEncounterAndReturnLastEmpty(n,s,c);R.isPresent()&&(l=R),a.push(s),s=s.getNext(o,1)}let u=i.status,f=i.preVictory,g=0,y=0;for(;g<6;){const N=c.reduce((U,$)=>U+$);5.16===N&&u===c1.DEFAULT&&(f.isPresent()?(L.assert(!1===f.equals(l),"Impossible to have point aligned with different line to a same point"),u=c1.PRE_VICTORY):f=l),y=Math.max(y,N),a=a.slice(1,6),a.push(s),c=c.slice(1,6);const R=this.updateEncounterAndReturnLastEmpty(n,s,c);R.isPresent()&&(l=R),g++,s=s.getNext(o,1)}const S={status:u,victory:h.of(a),preVictory:f,sum:y};return this.getBoardInfoResult(y,l,a,S)}updateEncounterAndReturnLastEmpty(t,e,n){const i=t.getCurrentPlayer();switch(t.getPieceAt(e)){case i:return n.push(-7),h.empty();case B.NONE:return n.push(.16),h.of(e);default:return n.push(1),h.empty()}}getBoardInfoForTriangleCorner(t,e,n,i){const o=n.getCurrentPlayer();let s=Te.factory.all[t];const a=[e];let c=e.getNext(s,1),l=0,u=h.empty();for(;a.length<6;){const f=n.getPieceAt(c);if(f===o)return i;f===B.NONE?(l+=.16,u=h.of(c)):l++,a.length%2==0&&(s=Te.factory.all[(t+a.length)%6]),a.push(c),c=c.getNext(s,1)}return this.getBoardInfoResult(l,u,a,i)}getBoardInfoForTriangleEdge(t,e,n,i){const o=n.getCurrentPlayer();let s=Te.factory.all[t];const a=[e];let c=e.getNext(s,1),l=0,u=h.empty();for(;a.length<6;){const f=n.getPieceAt(c);if(f===o)return i;f===B.NONE?(l+=.16,u=h.of(c)):l++,a.push(c),a.length%2==0&&(s=Te.factory.all[(t+a.length)%6]),c=c.getNext(s,1)}return this.getBoardInfoResult(l,u,a,i)}}let cv=class extends Kn{getListMoves(t,e){const n=i3.getLegalLandings(t.gameState);return t.gameState.turn<40?this.getListDrops(n):this.getMovements(t.gameState,n)}getMovements(t,e){const n=t.getPieces().reverse(),i=t.getCurrentPlayer(),o=n.get(i).get();return this.getMovementsFrom(t,o,e)}getMovementsFrom(t,e,n){const i=[];for(const o of e)for(const s of n){const a=Lr.ofMovement(o,s);if(t.isCoordConnected(s,h.of(o))){const l=t.movePiece(a).getGroups();if(i3.isSplit(l)){const u=i3.getLargestGroups(l);if(1===u.size())i.push(Lr.ofMovement(o,s));else for(const f of u){const g=f.getAnyElement().get(),y=Lr.ofCut(o,s,g);i.push(y)}}else i.push(a)}}return i}getListDrops(t){const e=[];for(const n of t){const i=Lr.ofDrop(n);e.push(i)}return e}};cv=function(r,t,e,n){var s,i=arguments.length,o=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,e):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,t,e,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(t,e,o):s(t,e))||o);return i>3&&o&&Object.defineProperty(t,e,o),o}([Ae.log],cv);class rHe extends cv{heuristic=new cee;getMovements(t,e){const n=this.getSafelyMovablePieceOrFirstOne(t);return this.getMovementsFrom(t,n,e)}getSafelyMovablePieceOrFirstOne(t){const e=t.getPieces().reverse(),n=t.getCurrentPlayer(),i=e.get(n).get(),o=i.getAnyElement().get(),s=[];for(const a of i)!1===this.isPieceBlockingAVictory(t,a)&&s.push(a);return new ir(0===s.length?[o]:s)}isPieceBlockingAVictory(t,e){const n=t.switchPiece(e),i=Lr.ofDrop(e);for(this.heuristic.startSearchingVictorySources();this.heuristic.hasNextVictorySource();)if(this.heuristic.currentVictorySource=this.heuristic.getNextVictorySource(),this.heuristic.searchVictoryOnly(this.heuristic.currentVictorySource,i,n).status===c1.VICTORY)return!0;return!1}}function iHe(r,t){if(1&r){const e=he();I(),E(0,"polygon",10),q("click",function(){const o=te(e).$implicit;return ne(p().onPieceClick(o))}),P()}if(2&r){const e=t.$implicit,n=p();ve("id","piece_",e.x,"_",e.y,""),v("ngClass",n.getPieceClass(e)),A("points",n.getHexaPoints())("transform",n.getHexaCenterTranslationAtXY(e.x,e.y))}}function oHe(r,t){if(1&r){const e=he();I(),E(0,"polygon",11),q("click",function(){const o=te(e).$implicit;return ne(p().onNeighborClick(o))}),P()}if(2&r){const e=t.$implicit,n=p();ve("id","neighbor_",e.x,"_",e.y,""),A("points",n.getHexaPoints())("transform",n.getHexaCenterTranslationAtXY(e.x,e.y))}}function sHe(r,t){if(1&r){const e=he();I(),E(0,"polygon",10),q("click",function(){te(e);const i=p();return ne(i.onPieceClick(i.chosenLanding.get()))}),P()}if(2&r){const e=p();ve("id","chosenLanding_",e.chosenLanding.get().x,"_",e.chosenLanding.get().y,""),v("ngClass",e.getPlayerClass(e.state.getCurrentPlayer())),A("points",e.getHexaPoints())("transform",e.getHexaCenterTranslationAtXY(e.chosenLanding.get().x,e.chosenLanding.get().y))}}function aHe(r,t){if(1&r&&(I(),V(0,"polygon",12)),2&r){const e=t.$implicit,n=p();ve("id","disconnected_",e.x,"_",e.y,""),A("points",n.getHexaPoints())("transform",n.getHexaCenterTranslationAtXY(e.x,e.y))}}function cHe(r,t){if(1&r){const e=he();I(),E(0,"polygon",13),q("click",function(){te(e);const i=p();return ne(i.onNeighborClick(i.leftCoord.get()))}),P()}if(2&r){const e=p();ve("id","leftCoord_",e.leftCoord.get().x,"_",e.leftCoord.get().y,""),A("points",e.getHexaPoints())("transform",e.getHexaCenterTranslationAtXY(e.leftCoord.get().x,e.leftCoord.get().y))}}function lHe(r,t){if(1&r){const e=he();I(),E(0,"polygon",14),q("click",function(){te(e);const i=p();return ne(i.onPieceClick(i.lastDrop.get()))}),P()}if(2&r){const e=p();ve("id","lastDrop_",e.lastDrop.get().x,"_",e.lastDrop.get().y,""),A("points",e.getHexaPoints())("transform",e.getHexaCenterTranslationAtXY(e.lastDrop.get().x,e.lastDrop.get().y))}}function uHe(r,t){if(1&r){const e=he();I(),E(0,"polygon",15),q("click",function(){te(e);const i=p();return ne(i.onPieceClick(i.selectedPiece.get()))}),P()}if(2&r){const e=p();ve("id","selectedPiece_",e.selectedPiece.get().x,"_",e.selectedPiece.get().y,""),v("ngClass",e.getSelectedPieceClass()),A("points",e.getHexaPoints())("transform",e.getHexaCenterTranslationAtXY(e.selectedPiece.get().x,e.selectedPiece.get().y))}}function fHe(r,t){if(1&r&&(I(),V(0,"polygon",16)),2&r){const e=t.$implicit,n=p();ve("id","victoryCoord_",e.x,"_",e.y,""),A("points",n.getHexaPoints())("transform",n.getHexaCenterTranslationAtXY(e.x,e.y))}}function dHe(r,t){if(1&r){const e=he();I(),E(0,"polygon",19),q("click",function(){const o=te(e).$implicit;return ne(p(2).onPieceClick(o))}),P()}if(2&r){const e=t.$implicit,n=p(2);ve("id","cuttable_",e.x,"_",e.y,""),A("points",n.getHexaPoints())("transform",n.getHexaCenterTranslationAtXY(e.x,e.y))}}function hHe(r,t){if(1&r&&(I(),E(0,"g",17),z(1,dHe,1,4,"polygon",18),P()),2&r){const e=t.$implicit;m(),v("ngForOf",e)}}let gHe=(()=>{class r extends ru{state;pieces;disconnecteds=[];cuttableGroups=[];victoryCoords;neighbors;leftCoord=h.empty();lastDrop=h.empty();selectedPiece=h.empty();chosenLanding=h.empty();nextClickShouldSelectGroup=!1;constructor(e){super(e),this.setRulesAndNode("Six"),this.availableAIs=[new fn($localize`Minimax`,this.rules,new cee,new rHe),new zn($localize`MCTS`,new cv,this.rules)],this.encoder=Lr.encoder,this.SPACE_SIZE=30,this.hexaLayout=new iu(1.5*this.SPACE_SIZE,new _(2*this.SPACE_SIZE,0),Yr.INSTANCE)}cancelMoveAttempt(){var e=this;return M(function*(){e.selectedPiece=h.empty(),e.chosenLanding=h.empty(),e.cuttableGroups=[],e.nextClickShouldSelectGroup=!1,yield e.updateBoard(!1)})()}updateBoard(e){var n=this;return M(function*(){n.state=n.node.gameState,n.pieces=n.state.getPieceCoords(),n.neighbors=n.getEmptyNeighbors()})()}hideLastMove(){this.leftCoord=h.empty(),this.lastDrop=h.empty(),this.victoryCoords=[],this.disconnecteds=[]}getViewBox(){const e=this.pieces.concat(this.disconnecteds).concat(this.neighbors);return Ks.fromHexa(e,this.hexaLayout,this.STROKE_WIDTH).expandAbove(this.SPACE_SIZE+this.STROKE_WIDTH).expandBelow(this.SPACE_SIZE+this.STROKE_WIDTH).expandLeft(this.SPACE_SIZE+2*this.STROKE_WIDTH).expandRight(this.SPACE_SIZE+2*this.STROKE_WIDTH)}showLastMove(e){var n=this;return M(function*(){n.lastDrop=h.of(e.landing),n.leftCoord=!1===e.isDrop()?h.of(e.start.get()):h.empty();const i=n.getState();n.rules.getGameStatus(n.node).isEndGame&&(n.victoryCoords=n.rules.getShapeVictory(e,i)),n.disconnecteds=n.getDisconnected()})()}getDisconnected(){const e=this.getPreviousState().getPieceCoords(),n=this.getState().getPieceCoords(),i=[];for(const s of e)!1===this.node.previousMove.get().start.equalsValue(s)&&!1===n.some(c=>c.equals(s))&&i.push(s);const o=this.lastDrop.get();return!1===this.pieces.some(s=>s.equals(o))&&!1===n.some(s=>s.equals(o))&&i.push(o),i}getEmptyNeighbors(){let e=i3.getLegalLandings(this.state);if(this.chosenLanding.isPresent()){const n=this.chosenLanding.get();e=e.filter(i=>!1===i.equals(n))}return e}getPieceClass(e){const n=this.getState().getPieceAt(e);return this.getPlayerClass(n)}onPieceClick(e){var n=this;return M(function*(){const i=yield n.canUserPlay("#piece_"+e.x+"_"+e.y);if(i.isFailure())return n.cancelMove(i.getReason());if(n.state.turn<40)return n.cancelMove(Ka.NO_MOVEMENT_BEFORE_TURN_40());if(n.chosenLanding.isAbsent())return n.state.getPieceAt(e)===n.state.getCurrentOpponent()?n.cancelMove(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT()):(n.selectedPiece=n.selectedPiece.equalsValue(e)?h.empty():h.of(e),w.SUCCESS);{const o=Lr.ofCut(n.selectedPiece.get(),n.chosenLanding.get(),e);return n.chooseMove(o)}})()}onNeighborClick(e){var n=this;return M(function*(){const i=yield n.canUserPlay("#neighbor_"+e.x+"_"+e.y);if(i.isFailure())return n.cancelMove(i.getReason());if(n.nextClickShouldSelectGroup)return n.cancelMove(Ka.MUST_CUT());if(n.state.turn<40)return n.chooseMove(Lr.ofDrop(e));if(n.selectedPiece.isAbsent())return n.cancelMove(Ka.CAN_NO_LONGER_DROP());{const o=Lr.ofMovement(n.selectedPiece.get(),e),s=i3.isLegalPhaseTwoMove(o,n.state);return n.neededCutting(s)?(n.chosenLanding=h.of(e),n.moveVirtuallyPiece(),n.showCuttable(),n.nextClickShouldSelectGroup=!0,w.SUCCESS):n.chooseMove(o)}})()}neededCutting(e){return e.isFailure()&&e.getReason()===Ka.MUST_CUT()}moveVirtuallyPiece(){const e=this.selectedPiece.get();this.pieces=this.pieces.filter(n=>!1===n.equals(e)),this.neighbors=this.getEmptyNeighbors()}showCuttable(){const e=Lr.ofMovement(this.selectedPiece.get(),this.chosenLanding.get()),i=this.state.movePiece(e).getGroups(),o=i3.getLargestGroups(i);this.cuttableGroups=[];for(const s of o)this.cuttableGroups.push(s.toList())}getSelectedPieceClass(){return this.chosenLanding.isPresent()?"moved-fill":"selected-stroke"}static \u0275fac=function(n){return new(n||r)(G(Ut))};static \u0275cmp=Ue({type:r,selectors:[["app-six"]],features:[$e],decls:10,vars:10,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["class","base round",3,"id","ngClass","click",4,"ngFor","ngForOf"],["class","base round",3,"id","click",4,"ngFor","ngForOf"],["class","base round",3,"id","ngClass","click",4,"ngIf"],["class","base round captured-fill",3,"id",4,"ngFor","ngForOf"],["class","base round moved-fill mid-stroke",3,"id","click",4,"ngIf"],["class","base no-fill round last-move-stroke mid-stroke",3,"id","click",4,"ngIf"],["class","base no-fill round",3,"id","ngClass","click",4,"ngIf"],["class","base no-fill round victory-stroke mid-stroke",3,"id",4,"ngFor","ngForOf"],["pointer-events","fill","class","capturable-stroke",4,"ngFor","ngForOf"],[1,"base","round",3,"id","ngClass","click"],[1,"base","round",3,"id","click"],[1,"base","round","captured-fill",3,"id"],[1,"base","round","moved-fill","mid-stroke",3,"id","click"],[1,"base","no-fill","round","last-move-stroke","mid-stroke",3,"id","click"],[1,"base","no-fill","round",3,"id","ngClass","click"],[1,"base","no-fill","round","victory-stroke","mid-stroke",3,"id"],["pointer-events","fill",1,"capturable-stroke"],["class","no-fill","stroke-linecap","round",3,"id","click",4,"ngFor","ngForOf"],["stroke-linecap","round",1,"no-fill",3,"id","click"]],template:function(n,i){1&n&&(I(),E(0,"svg",0),z(1,iHe,1,5,"polygon",1)(2,oHe,1,4,"polygon",2)(3,sHe,1,5,"polygon",3)(4,aHe,1,4,"polygon",4)(5,cHe,1,4,"polygon",5)(6,lHe,1,4,"polygon",6)(7,uHe,1,5,"polygon",7)(8,fHe,1,4,"polygon",8)(9,hHe,2,1,"g",9),P()),2&n&&(A("viewBox",i.getViewBox().toSVGString()),m(),v("ngForOf",i.pieces),m(),v("ngForOf",i.neighbors),m(),v("ngIf",i.chosenLanding.isPresent()),m(),v("ngForOf",i.disconnecteds),m(),v("ngIf",i.leftCoord.isPresent()),m(),v("ngIf",i.lastDrop.isPresent()),m(),v("ngIf",i.selectedPiece.isPresent()),m(),v("ngForOf",i.victoryCoords),m(),v("ngForOf",i.cuttableGroups))},dependencies:[zt,Nt,bt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}return r})();const le=B.NONE,Pt=O.ZERO,Rt=O.ONE;let nk=(()=>class r{static MOVEMENT_NOT_DISCONNECTING=()=>$localize`This move does not disconnect your opponent's pieces. Try again with another piece.`;static MOVEMENT_SELF_DISCONNECTING=()=>$localize`You lost one of your pieces during this move. There is a way to disconnect an opponent's piece without losing any of yours, try again!`})();class pHe extends Wn{tutorial=[W.informational($localize`Six`,$localize`Six is a game without board, where pieces are placed on the side of each other, in a contiguous block.
        Each player has 21 pieces, with one for each player already on the board.
        The goal of the game is to form one of the three winning shapes with your pieces.`,i3.get().getInitialState()),W.fromMove($localize`Victory (line)`,$localize`On this board, by putting your piece at the right place, you can align six of your pieces and win the game<br/><br/>
        Find the victory. You're playing Dark.`,$o.ofRepresentation([[Pt,Rt,Rt,Rt,Rt,Pt],[le,Pt,Rt,le,Pt,le],[Rt,Rt,Pt,le,le,le],[le,le,Pt,le,le,le],[le,Pt,le,le,le,le],[Pt,le,le,le,le,le]],0),[Lr.ofDrop(new _(3,2))],pe.CONGRATULATIONS(),pe.FAILED_TRY_AGAIN()),W.fromMove($localize`Victory (circle)`,$localize`On this board, by putting your piece at the right place, you can form a circle with six of your pieces and win the game.<br/><br/>
        Find the victory. You're playing Dark.`,$o.ofRepresentation([[le,le,le,Rt,le,le],[le,le,Rt,Rt,Pt,Pt],[le,Rt,le,Pt,Rt,le],[Rt,Pt,Pt,Pt,Pt,Rt]],0),[Lr.ofDrop(new _(5,2))],$localize`Congratulations! Note that if a piece is inside the circle, it does not change anything.`,pe.FAILED_TRY_AGAIN()),W.fromMove($localize`Victory (triangle)`,$localize`On this board, by putting your piece at the right place, you can form a triangle with six of your pieces and win the game.<br/><br/>
        Find the victory. You're playing Dark.`,$o.ofRepresentation([[le,le,le,Rt,le,le],[le,Pt,Rt,Pt,Pt,Pt],[le,Pt,le,Pt,Pt,le],[Rt,Rt,Rt,le,Rt,le]],0),[Lr.ofDrop(new _(3,3))],pe.CONGRATULATIONS(),pe.FAILED_TRY_AGAIN()),W.fromPredicate($localize`Second phase`,$localize`After 40 turns, your pieces have all been placed and we move on to the second phase of the game.
        You now have to move your pieces, paying attention not to remove a piece that was preventing the opponent's victory.
        From now on, if after move, on or more pieces are disconnected from the largest group of pieces, these will be taken out of the game.<br/><br/>
        You're playing Dark. Make a move that disconnects one of your opponent's pieces.`,$o.ofRepresentation([[le,le,le,le,le,le,le,Rt,le],[le,le,le,le,le,le,Pt,le,le],[le,le,le,le,Pt,Pt,Pt,le,le],[le,le,le,le,Rt,Rt,le,Rt,Pt],[le,Pt,Rt,Rt,Pt,Pt,Rt,le,le],[Pt,Pt,Pt,Pt,Rt,Rt,Rt,Pt,le],[Rt,Rt,Pt,le,Rt,Rt,Pt,le,le],[le,Pt,le,Pt,Pt,le,le,le,le],[Rt,Rt,Rt,Rt,le,le,le,le,le],[le,Pt,le,Rt,le,le,le,le,le]],40),Lr.ofMovement(new _(6,1),new _(5,1)),(t,e,n)=>{const i=n.countPieces();return 19===i.get(O.ZERO)?18===i.get(O.ONE)?w.SUCCESS:w.failure(nk.MOVEMENT_NOT_DISCONNECTING()):w.failure(nk.MOVEMENT_SELF_DISCONNECTING())},$localize`Congratulations, your opponent now has one piece less and you're closer to victory!`),W.fromPredicate($localize`Victory by disconnection`,$localize`During the second phase of the game, on top of normal victories (line, circle, triangle), you can win by disconnection.
        If at any time, at least one player does not have enough pieces to win (less than 6), the game ends.
        The one with the most pieces wins. In case they both have the same number of pieces, it's a draw.<br/><br/>
        Here, you're playing Dark and you can win. Do it!`,$o.ofRepresentation([[le,le,le,le,le,Rt],[le,le,le,le,Pt,Rt],[le,le,le,Rt,Pt,Pt],[le,le,Pt,le,Rt,Pt],[Rt,Rt,le,le,le,Pt],[Pt,Rt,le,le,le,le],[Pt,le,le,le,le,le]],40),Lr.ofMovement(new _(2,3),new _(3,3)),(t,e,n)=>t.start.equalsValue(new _(2,3))?w.SUCCESS:w.failure(nk.MOVEMENT_NOT_DISCONNECTING()),pe.CONGRATULATIONS_YOU_WON()),W.fromPredicate($localize`Special disconnection`,$localize`During a disconnection, two or more groups could have the same size,
        in which case you will have to click on the group you wish to keep.<br/><br/>
        You're playing Dark, play such a move!`,$o.ofRepresentation([[le,le,le,le,le,Rt],[le,le,le,le,Pt,Rt],[le,le,le,Rt,Pt,Pt],[Pt,le,Pt,le,le,Rt],[Rt,Rt,le,le,le,le],[Pt,Pt,le,le,le,le],[Pt,le,le,le,le,le]],40),Lr.ofCut(new _(2,3),new _(2,5),new _(2,5)),(t,e,n)=>t.keep.isAbsent()?w.failure($localize`This move has not cut the board in two equal halves.`):n.getPieceAt(t.landing)===B.NONE?w.failure($localize`Failed. You did cut the board in two but you kept the half where you're in minority. Therefore, you lost! Try again.`):w.SUCCESS,pe.CONGRATULATIONS_YOU_WON())]}class fa extends su{static encoder=G2.getFallibleEncoder(fa.from);static from(t,e){const n=su.isValidDirection(t,e);return n.isFailure()?n.toOtherFallible():X.success(new fa(t,e))}getMaximalDistance(){return 9}}function mHe(r,t){1&r&&(I(),V(0,"polygon",8))}function _He(r,t){1&r&&(I(),V(0,"rect",9))}function CHe(r,t){if(1&r&&(I(),E(0,"g"),z(1,mHe,1,0,"polygon",6)(2,_He,1,0,"ng-template",null,7,In),P()),2&r){const e=wn(3),n=p().index,i=p().index,o=p();m(),v("ngIf",o.isCentralThrone(n,i))("ngIfElse",e)}}function vHe(r,t){if(1&r&&(I(),E(0,"g"),V(1,"line",13)(2,"line",13)(3,"line",13)(4,"line",13)(5,"line",13),P()),2&r){const e=p(2).index,n=p().index,i=p();m(),v("ngClass",i.viewInfo.pieceClasses[n][e]),A("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),m(),v("ngClass",i.viewInfo.pieceClasses[n][e]),A("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.1*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),m(),v("ngClass",i.viewInfo.pieceClasses[n][e]),A("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.9*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),m(),v("ngClass",i.viewInfo.pieceClasses[n][e]),A("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.15*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE),m(),v("ngClass",i.viewInfo.pieceClasses[n][e]),A("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.85*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE)}}function yHe(r,t){if(1&r&&(I(),V(0,"polyline",16)),2&r){const e=p(3).index,n=p().index;v("ngClass",p().viewInfo.pieceClasses[n][e])}}function MHe(r,t){if(1&r&&(I(),V(0,"line",13)(1,"line",13)(2,"line",13)(3,"line",13)),2&r){const e=p(3).index,n=p().index,i=p();v("ngClass",i.viewInfo.pieceClasses[n][e]),A("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),m(),v("ngClass",i.viewInfo.pieceClasses[n][e]),A("x1",.04*i.SPACE_SIZE)("y1",.5*i.SPACE_SIZE)("x2",.96*i.SPACE_SIZE)("y2",.5*i.SPACE_SIZE),m(),v("ngClass",i.viewInfo.pieceClasses[n][e]),A("x1",.2*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.8*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE),m(),v("ngClass",i.viewInfo.pieceClasses[n][e]),A("x1",.8*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.2*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE)}}function EHe(r,t){if(1&r&&(I(),z(0,yHe,1,1,"polyline",14)(1,MHe,4,20,"ng-template",null,15,In)),2&r){const e=wn(2),n=p(2).index,i=p().index;v("ngIf",p().isKing(n,i))("ngIfElse",e)}}function PHe(r,t){if(1&r&&(I(),E(0,"g"),V(1,"circle",10),z(2,vHe,6,25,"g",11)(3,EHe,3,2,"ng-template",null,12,In),P()),2&r){const e=wn(4),n=p().index,i=p().index,o=p();m(),ve("id","piece_",n,"_",i,""),v("ngClass",o.viewInfo.pieceClasses[i][n]),A("r",o.SPACE_SIZE/2-o.STROKE_WIDTH)("cx",.5*o.SPACE_SIZE)("cy",.5*o.SPACE_SIZE),m(),v("ngIf",o.isInvader(n,i))("ngIfElse",e)}}function SHe(r,t){if(1&r){const e=he();I(),E(0,"g",3),q("click",function(){const o=te(e).index,s=p().index;return ne(p().onClick(o,s))}),V(1,"rect",4),z(2,CHe,4,2,"g",5)(3,PHe,5,8,"g",5),P()}if(2&r){const e=t.index,n=p().index,i=p();ve("id","click_",e,"_",n,""),A("transform","translate("+i.SPACE_SIZE*e+", "+i.SPACE_SIZE*n+")"),m(),ve("id","space_",e,"_",n,""),v("ngClass",i.getRectClasses(e,n)),A("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),m(),v("ngIf",i.board[n][e]===i.EMPTY&&i.isThrone(e,n)),m(),v("ngIf",i.board[n][e]!==i.EMPTY)}}function OHe(r,t){if(1&r&&(I(),E(0,"g"),z(1,SHe,4,10,"g",2),P()),2&r){const e=t.$implicit;m(),v("ngForOf",e)}}function THe(r,t){if(1&r){const e=he();I(),E(0,"g")(1,"rect",17),q("click",function(){const o=te(e).$implicit;return ne(p().onClick(o.x,o.y))}),P()()}if(2&r){const e=t.$implicit,n=p();m(),ve("id","click_",e.x,"_",e.y,""),A("x",n.SPACE_SIZE*e.x)("y",n.SPACE_SIZE*e.y)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}let wHe=(()=>{class r extends bI{constructor(e){super(e,fa.from),this.setRulesAndNode("Tablut"),this.availableAIs=this.createAIs(),this.encoder=fa.encoder}static \u0275fac=function(n){return new(n||r)(G(Ut))};static \u0275cmp=Ue({type:r,selectors:[["app-tablut"]],features:[$e],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["x","0","y","0",1,"base",3,"id","ngClass"],[4,"ngIf"],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60","class","base",4,"ngIf","ngIfElse"],["cornerThrone",""],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60",1,"base"],["x","15","y","15","width","70","height","70",1,"base"],[1,"base",3,"id","ngClass"],[4,"ngIf","ngIfElse"],["defender",""],[1,"base",3,"ngClass"],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85","class","base no-fill",3,"ngClass",4,"ngIf","ngIfElse"],["soldierDefender",""],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85",1,"base","no-fill",3,"ngClass"],[1,"no-fill","mid-stroke","clickable-stroke",3,"id","click"]],template:function(n,i){1&n&&(I(),E(0,"svg",0),z(1,OHe,2,1,"g",1)(2,THe,2,6,"g",1),P()),2&n&&(A("viewBox",i.getViewBox().toSVGString()),m(),v("ngForOf",i.board),m(),v("ngForOf",i.getClickables()))},dependencies:[zt,Nt,bt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}return r})();class o3 extends Bi{static singleton=h.empty();static RULES_CONFIG_DESCRIPTION=new fo({name:()=>$localize`Tablut`,config:{castleIsLeftForGood:new Jn(!1,Bi.CASTLE_IS_LEFT_FOR_GOOD),edgesAreKingsEnnemy:new Jn(!0,Bi.EDGE_ARE_KING_S_ENNEMY),centralThroneCanSurroundKing:new Jn(!1,Bi.CENTRAL_THRONE_CAN_SURROUND_KING),kingFarFromHomeCanBeSandwiched:new Jn(!1,Bi.KING_FAR_FROM_HOME_CAN_BE_SANDWICHED),invaderStarts:new Jn(!0,Bi.INVADER_STARTS)}});static get(){return o3.singleton.isAbsent()&&(o3.singleton=h.of(new o3)),o3.singleton.get()}constructor(){super(fa.from)}getInitialState(t){const e=It.UNOCCUPIED;let n=It.PLAYER_ZERO_PAWN,i=It.PLAYER_ONE_PAWN,o=It.PLAYER_ONE_KING;return!1===t.get().invaderStarts&&(n=It.PLAYER_ONE_PAWN,i=It.PLAYER_ZERO_PAWN,o=It.PLAYER_ZERO_KING),new m2([[e,e,e,n,n,n,e,e,e],[e,e,e,e,n,e,e,e,e],[e,e,e,e,i,e,e,e,e],[n,e,e,e,i,e,e,e,n],[n,n,i,i,o,i,i,n,n],[n,e,e,e,i,e,e,e,n],[e,e,e,e,i,e,e,e,e],[e,e,e,e,n,e,e,e,e],[e,e,e,n,n,n,e,e,e]],0)}getRulesConfigDescription(){return h.of(o3.RULES_CONFIG_DESCRIPTION)}}const H=It.UNOCCUPIED,Fn=It.PLAYER_ZERO_PAWN,Y2=It.PLAYER_ONE_PAWN,lv=It.PLAYER_ONE_KING,lee=o3.get().getDefaultRulesConfig();class bHe extends Wn{tutorial=[W.informational($localize`Goal of the game`,$localize`Tablut is the lapland version of the Tafl, Tafl being a family of viking strategy game. The goal of the game is different for each player. The attacker plays first. Its pieces (dark) are close to the edges. Its goal is to capture the king, which is in the center of the board. The defender plays second. Its pieces (light) are in the middle. Its goal is to move the king on one of the 4 thrones in the corners. Note that the square in which the king starts, in the center of the board, is also a throne.`,o3.get().getInitialState(lee)),W.anyMove($localize`Moving`,$localize`All pieces move the same way. Similarly to a rook in chess, a piece can move:<ol><li>By as many squares as you want.</li><li>Without going over another piece or stopping on another piece.</li><li>Horizontally or vertically.</li><li>Only the king can land on a throne.</li></ol>To move a piece, click on it and then on its landing square.<br/><br/>You're playing Dark, do the first move.`,o3.get().getInitialState(lee),fa.from(new _(4,1),new _(1,1)).get(),pe.CONGRATULATIONS()),W.fromMove($localize`Capturing a soldier (1/2)`,$localize`All pieces, attackers and defenders, except the king, are soldiers. To capture them, they have to be sandwiched between two of your pieces. By getting too close, an attacker's soldier is in danger.<br/><br/>You're playing Light. Capture the soldier.`,new m2([[H,H,H,Fn,Fn,Fn,H,H,H],[H,H,H,H,Fn,H,H,H,H],[H,H,H,H,Y2,H,H,H,H],[H,H,H,Fn,Y2,H,H,H,Fn],[Fn,Fn,Y2,Y2,lv,Y2,Y2,Fn,Fn],[H,H,H,H,Y2,H,H,H,Fn],[H,H,H,H,Y2,H,H,H,H],[H,H,H,H,Fn,H,H,H,H],[H,H,H,Fn,Fn,Fn,H,H,H]],1),[fa.from(new _(2,4),new _(2,3)).get(),fa.from(new _(4,2),new _(3,2)).get()],$localize`Congratulations, that will teach him a lesson!`,$localize`Failed, you missed an opportunity to capture a piece of the opponent.`),W.fromMove($localize`Capturing a soldier (2/2)`,$localize`A second way to capture a soldier is to sandwich it against an empty throne. The king has moved and endangered one of its soldiers.<br/><br/>You're playing Dark. Capture the soldier.`,new m2([[H,H,H,Fn,Fn,Fn,H,H,H],[H,H,H,H,Fn,H,H,H,H],[H,H,H,H,Y2,H,H,H,H],[H,H,Y2,H,lv,H,Y2,H,Fn],[Fn,Fn,H,Y2,H,Y2,Y2,Fn,Fn],[H,H,H,H,Y2,H,H,H,Fn],[H,H,H,H,Y2,H,H,H,H],[H,H,H,H,Fn,H,H,H,H],[H,H,H,Fn,Fn,Fn,H,H,H]],12),[fa.from(new _(1,4),new _(2,4)).get()],$localize`Congratulations, one less defender. But keep an eye on the king, it is the most important.`,$localize`Failed, you did not do the expected move.`),W.fromMove($localize`Capturing the king (1/2)`,$localize`To capture the king, two soldiers are not enough. For the first solution, the four squares neighbor to the king (horizontally and vertically) must be occupied by your soldiers. This also works if the king is on the throne.<br/><br/>You're playing Dark, capture the king.`,new m2([[H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H],[H,Fn,H,H,H,H,H,H,H],[Fn,lv,H,Fn,H,H,H,H,H],[H,Fn,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H]],72),[fa.from(new _(3,4),new _(2,4)).get()],pe.CONGRATULATIONS_YOU_WON(),$localize`Failed, you let the king run away.`),W.fromMove($localize`Capturing the king (2/2)`,$localize`Another way to capture the king is to immobilize it against an edge of the board. Note that the king cannot be captured next to a throne.<br/><br/>You're playing Dark, capture the king.`,new m2([[H,H,Fn,lv,Fn,H,H,H,H],[H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H],[H,H,H,Fn,H,H,H,H,H],[H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H]],72),[fa.from(new _(3,3),new _(3,1)).get()],$localize`The king is dead, long live the king. Congratulations, you won.`,pe.FAILED_TRY_AGAIN())]}let bs=(()=>{class r extends B1{static WIDTH=5;static isOnBoard(e){return e.isInRange(r.WIDTH,r.WIDTH)}isInDropPhase(){return this.turn<8}}return r})();class da extends Nr{static encoder=Nr.getFallibleEncoder(da.from);static from(t){return bs.isOnBoard(t)?X.success(new da(t.x,t.y)):X.failure(uo.OUT_OF_RANGE(t))}toString(){return"TeekoMove"+this.coord.toString()}equals(t){return t instanceof da&&super.equals(t)}}class ha extends Do{static encoder=Do.getFallibleEncoder(ha.from);static from(t,e){return!1===bs.isOnBoard(t)?X.failure(uo.OUT_OF_RANGE(t)):!1===bs.isOnBoard(e)?X.failure(uo.OUT_OF_RANGE(e)):t.equals(e)?X.failure(Ee.MOVE_CANNOT_BE_STATIC()):X.success(new ha(t,e))}toString(){return"TeekoMove("+this.getStart().toString()+" -> "+this.getEnd().toString()+")"}equals(t){return t instanceof ha&&super.equals(t)}}var rk;!function(r){r.encoder=ke.disjunction([t=>t instanceof da,t=>t instanceof ha],[da.encoder,ha.encoder])}(rk||(rk={}));class ga extends Da{static singleton=h.empty();static get(){return ga.singleton.isAbsent()&&(ga.singleton=h.of(new ga)),ga.singleton.get()}static RULES_CONFIG_DESCRIPTION=new fo({name:()=>$localize`Standard Teeko`,config:{teleport:new Jn(!1,()=>$localize`Piece can teleport`)}},[{name:()=>$localize`Teleport Teeko`,config:{teleport:!0}}]);static TEEKO_HELPER=new a0(L.identity,4);getRulesConfigDescription(){return h.of(ga.RULES_CONFIG_DESCRIPTION)}getInitialState(){const t=rt.create(bs.WIDTH,bs.WIDTH,B.NONE);return new bs(t,0)}isLegal(t,e,n){return e.isInDropPhase()?(L.assert(t instanceof da,"Cannot translate in dropping phase !"),this.isLegalDrop(t,e)):(L.assert(t instanceof ha,"Cannot drop in translation phase !"),this.isLegalTranslation(t,e,n.get()))}isLegalDrop(t,e){return e.getPieceAt(t.coord).isPlayer()?w.failure(Ee.MUST_LAND_ON_EMPTY_SPACE()):w.SUCCESS}isLegalTranslation(t,e,n){const i=e.getPieceAt(t.getStart());return i===e.getCurrentOpponent()?w.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT()):i===B.NONE?w.failure(Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):e.getPieceAt(t.getEnd()).isPlayer()?w.failure(Ee.MUST_LAND_ON_EMPTY_SPACE()):!1===n.teleport&&!1===t.getStart().isNeighborWith(t.getEnd())?w.failure(Ee.MUST_MOVE_ON_NEIGHBOR()):w.SUCCESS}applyLegalMove(t,e,n,i){return t instanceof da?this.applyLegalDrop(t,e):this.applyLegalTranslation(t,e)}applyLegalDrop(t,e){const n=e.getCopiedBoard();return n[t.coord.y][t.coord.x]=e.getCurrentPlayer(),new bs(n,e.turn+1)}applyLegalTranslation(t,e){const n=e.getCopiedBoard();return n[t.getStart().y][t.getStart().x]=B.NONE,n[t.getEnd().y][t.getEnd().x]=e.getCurrentPlayer(),new bs(n,e.turn+1)}getGameStatus(t){const e=t.gameState;return this.getVictoryCoord(e).length>0?ye.getVictory(e.getCurrentOpponent()):ye.ONGOING}getLastCoord(t){return t instanceof da?t.coord:t.getEnd()}getSquareInfo(t){const e=[],n=we.of(0,0);for(let i=0;i<bs.WIDTH-1;i++)for(let o=0;o<bs.WIDTH-1;o++){const s=new _(i,o),a=new _(i+1,o),c=new _(i,o+1),l=new _(i+1,o+1),u=[t.getPieceAt(s),t.getPieceAt(a),t.getPieceAt(c),t.getPieceAt(l)],f=yt.count(u,B.NONE),g=yt.count(u,B.ZERO),y=yt.count(u,B.ONE);f<4&&(4===g||4===y?e.push(s,a,c,l):n.add(g>0?O.ZERO:O.ONE,1))}return{score:n.get(O.ONE)-n.get(O.ZERO),victoriousCoords:e}}getVictoryCoord(t){const e=ga.TEEKO_HELPER.getVictoriousCoord(t),n=this.getSquareInfo(t).victoriousCoords;return e.concat(n)}}class AHe extends Ha{getBoardValue(t,e){const n=ga.TEEKO_HELPER.getBoardValue(t.gameState).metrics[0],i=ga.get().getSquareInfo(t.gameState);return mn.of(i.score+n)}}class uee extends Kn{getListMoves(t,e){return t.gameState.isInDropPhase()?this.getListDrops(t.gameState):this.getListTranslations(t.gameState,e.get())}getListDrops(t){const e=[];for(const n of t.getCoordsAndContents()){const i=n.coord;if(!1===n.content.isPlayer()){const o=da.from(i).get();e.push(o)}}return e}getListTranslations(t,e){const n=[],i=t.getCurrentPlayer(),o=this.getCoordsContaining(t,i);for(const s of o)for(const a of this.getPossibleTargets(t,s,e)){const c=ha.from(s,a).get();n.push(c)}return n}getPossibleTargets(t,e,n){if(n.teleport)return this.getCoordsContaining(t,B.NONE);{const i=[];for(const o of me.factory.all){const s=e.getNext(o);bs.isOnBoard(s)&&t.getPieceAt(s)===B.NONE&&i.push(s)}return i}}getCoordsContaining(t,e){const n=[];for(const i of t.getCoordsAndContents())i.content===e&&n.push(i.coord);return n}}function NHe(r,t){if(1&r&&(I(),V(0,"circle",4)),2&r){const e=p().index,n=p().index,i=p();ve("id","piece_",e,"_",n,""),v("ngClass",i.getPieceClasses(e,n)),A("r",42)("cx",i.SPACE_SIZE*e+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*n+i.SPACE_SIZE/2)}}function IHe(r,t){if(1&r){const e=he();I(),E(0,"g",3),q("click",function(){const o=te(e).index,s=p().index;return ne(p().onClick(o,s))}),V(1,"rect",4),z(2,NHe,1,6,"circle",5),P()}if(2&r){const e=t.$implicit,n=t.index,i=p().index,o=p();ve("id","click_",n,"_",i,""),m(),ve("id","space_",n,"_",i,""),v("ngClass",o.getSpaceClasses(n,i)),A("x",o.SPACE_SIZE*n)("y",o.SPACE_SIZE*i)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),m(),v("ngIf",e.isPlayer())}}function kHe(r,t){if(1&r&&(I(),E(0,"g"),z(1,IHe,3,10,"g",2),P()),2&r){const e=t.$implicit;m(),v("ngForOf",e)}}let RHe=(()=>{class r extends p2{selected=h.empty();last=h.empty();moved=[];victory=[];constructor(e){super(e),this.setRulesAndNode("Teeko"),this.availableAIs=[new fn($localize`Minimax`,this.rules,new AHe,new uee),new zn($localize`MCTS`,new uee,this.rules)],this.encoder=rk.encoder}updateBoard(e){var n=this;return M(function*(){n.board=n.node.gameState.board})()}showLastMove(e){var n=this;return M(function*(){n.last=h.of(n.rules.getLastCoord(e)),n.moved=e instanceof ha?[e.getStart(),e.getEnd()]:[],n.victory=n.rules.getVictoryCoord(n.getState())})()}hideLastMove(){var e=this;return M(function*(){e.last=h.empty(),e.moved=[],e.victory=[]})()}cancelMoveAttempt(){this.selected=h.empty()}onClick(e,n){var i=this;return M(function*(){const o=yield i.canUserPlay("#click_"+e+"_"+n);if(o.isFailure())return i.cancelMove(o.getReason());const s=new _(e,n);if(i.getState().isInDropPhase()){const a=da.from(s).get();return i.chooseMove(a)}if(i.selected.isPresent()){if(i.selected.equalsValue(s))return i.selected=h.empty(),w.SUCCESS;{const a=ha.from(i.selected.get(),s).get();return i.chooseMove(a)}}{const a=i.getState().getCurrentPlayer(),c=i.getState().getPieceAt(s);return c===a?(i.selected=h.of(s),w.SUCCESS):i.cancelMove(c===B.NONE?Ee.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY():Ee.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT())}})()}getPieceClasses(e,n){const i=new _(e,n),s=[this.getPlayerClass(this.getState().getPieceAt(i))];return this.victory.some(a=>a.equals(i))?s.push("victory-stroke"):this.last.equalsValue(i)?s.push("last-move-stroke"):this.selected.equalsValue(i)&&s.push("selected-stroke"),s}getSpaceClasses(e,n){const i=new _(e,n);return this.moved.some(o=>o.equals(i))?["moved-fill"]:[]}static \u0275fac=function(n){return new(n||r)(G(Ut))};static \u0275cmp=Ue({type:r,selectors:[["app-teeko"]],features:[$e],decls:2,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base",3,"id","ngClass"],["class","base",3,"id","ngClass",4,"ngIf"]],template:function(n,i){1&n&&(I(),E(0,"svg",0),z(1,kHe,2,1,"g",1),P()),2&n&&(A("viewBox",i.getViewBox().toSVGString()),m(),v("ngForOf",i.board))},dependencies:[zt,Nt,bt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}return r})();const qn=B.NONE,Ll=B.ZERO,zl=B.ONE;class xHe extends Wn{tutorial=[W.informational($localize`Goal of the game`,$localize`The goal of the game is to align your 4 pieces, or to form a square with them.`,ga.get().getInitialState()),W.anyMove($localize`Dropping a piece`,$localize`During your first four turns, you must drop one piece on any empty space of the board. There is no other restriction.<br/><br/>You're playing Dark, put a piece on the board.`,ga.get().getInitialState(),da.from(new _(2,2)).get(),pe.CONGRATULATIONS()),W.anyMove($localize`Moving a piece`,$localize`Once all of your four pieces are placed on the board, you must now move one of your piece to an empty neighboring space, orthogonally or diagonally. The goal remains to be the first to create a line or a square.<br/><br/>You're playing Dark, move a piece.`,new bs([[Ll,zl,qn,qn,qn],[Ll,Ll,qn,qn,qn],[zl,zl,qn,qn,qn],[zl,Ll,qn,qn,qn],[qn,qn,qn,qn,qn]],8),ha.from(new _(1,3),new _(2,2)).get(),pe.CONGRATULATIONS()),W.fromMove($localize`Victory`,$localize`In this board, you can win by creating a square.<br/><br/>You are playing Dark, win.`,new bs([[zl,qn,qn,qn,qn],[zl,Ll,qn,Ll,qn],[qn,Ll,Ll,zl,qn],[qn,zl,qn,qn,qn],[qn,qn,qn,qn,qn]],8),[ha.from(new _(3,1),new _(2,1)).get()],$localize`Congratulations, you won! Remember that you can also win by creating a line.`,pe.FAILED_TRY_AGAIN())]}class S2{owner;tileId;constructor(t,e){this.owner=t,this.tileId=e}toString(){return`TrexoPiece(${this.owner.toString()}, ${this.tileId})`}}class hi{pieces;static EMPTY=hi.of([]);static of(t){let e=-1;for(const n of t)L.assert(e<n.tileId,"TrexoPieceStack: dropped turn should be ascending"),e=n.tileId;return new hi(t)}constructor(t){this.pieces=t}getHeight(){return this.pieces.length}getOwner(){const t=this.pieces.length;return 0===t?B.NONE:this.pieces[t-1].owner}getUpperTileId(){const t=this.pieces.length;return 0===t?-1:this.pieces[t-1].tileId}add(t){return hi.of(this.pieces.concat(t))}getPieceAt(t){return L.assert(t<this.pieces.length,"no element "+t+"in piece!"),this.pieces[t]}isGround(){return-1===this.getUpperTileId()}toString(){return"["+this.pieces.map(t=>"("+t.toString()+")").join(" ")+"]"}}let Xi=(()=>{class r extends B1{static SIZE=10;static isOnBoard(e){return e.isInRange(r.SIZE,r.SIZE)}static of(e,n){L.assert(e.length===r.SIZE,"Invalid board dimensions");for(const i of e)L.assert(i.length===r.SIZE,"Invalid board dimensions");return new r(e,n)}drop(e,n){const i=this.getCopiedBoard(),o=new S2(n,this.turn);return i[e.y][e.x]=i[e.y][e.x].add(o),new r(i,this.turn)}incrementTurn(){return new r(this.getCopiedBoard(),this.turn+1)}toString(){return this.board.map(e=>"["+e.map(n=>"TrexoPieceStack.of("+n.toString()+")").join(", ")+"]").join("\n,")}getPieceAtXYZ(e,n,i){return this.getPieceAtXY(e,n).getPieceAt(i)}}return r})(),uv=(()=>class r{static NON_NEIGHBORING_SPACES=()=>$localize`Those two spaces are not neighbors!`;static NO_WAY_TO_DROP_IT_HERE=()=>$localize`There is no way to put a piece there!`;static CANNOT_DROP_ON_ONLY_ONE_PIECE=()=>$localize`You cannot drop on only one piece!`;static CANNOT_DROP_PIECE_ON_UNEVEN_GROUNDS=()=>$localize`You cannot drop a piece on uneven grounds!`})();class As extends G2{static encoder=G2.getFallibleEncoder(As.from);static from(t,e){return L.assert(Xi.isOnBoard(t),`${t.toString()} is out of the TrexoBoard!`),L.assert(Xi.isOnBoard(e),`${e.toString()} is out of the TrexoBoard!`),1===t.getOrthogonalDistance(e)?X.success(new As(t,e)):X.failure(uv.NON_NEIGHBORING_SPACES())}constructor(t,e){super(t,e)}toString(){return this.getFirst().toString()+" && "+this.getSecond().toString()}equals(t){return this.getFirst().equals(t.getFirst())&&this.getSecond().equals(t.getSecond())}getZero(){return this.getFirst()}getOne(){return this.getSecond()}}class K2 extends Ar{static instance=h.empty();static get(){return K2.instance.isAbsent()&&(K2.instance=h.of(new K2)),K2.instance.get()}static getOwner(t){return t.getOwner()}static TREXO_HELPER=new a0(K2.getOwner,5);static getSquareScore(t,e){return K2.TREXO_HELPER.getSquareScore(t,e)}static getVictoriousCoords(t){const e=[],n=[],i=t.getCurrentOpponent();for(const o of t.toMap()){const s=o.key,a=t.getPieceAt(s).getOwner();if(a.isPlayer()){const c=K2.getSquareScore(t,s);mn.isVictory(c)&&(a===i?e.push(s):n.push(s))}}return n.length>0?n:e}getInitialState(){const t=rt.create(Xi.SIZE,Xi.SIZE,hi.EMPTY);return new Xi(t,0)}applyLegalMove(t,e,n,i){return e.drop(t.getZero(),O.ZERO).drop(t.getOne(),O.ONE).incrementTurn()}isLegal(t,e){return this.isUnevenGround(t,e)?w.failure(uv.CANNOT_DROP_PIECE_ON_UNEVEN_GROUNDS()):this.landsOnOnlyOnePiece(t,e)?w.failure(uv.CANNOT_DROP_ON_ONLY_ONE_PIECE()):w.SUCCESS}isUnevenGround(t,e){const n=e.getPieceAt(t.getZero()),i=e.getPieceAt(t.getOne());return n.getHeight()!==i.getHeight()}landsOnOnlyOnePiece(t,e){const n=e.getPieceAt(t.getZero()),i=e.getPieceAt(t.getOne());return(-1!==n.getUpperTileId()||-1!==i.getUpperTileId())&&n.getUpperTileId()===i.getUpperTileId()}getGameStatus(t){const e=t.gameState,n=e.getCurrentOpponent();let i=!1;for(const o of e.toMap()){const s=o.key,a=e.getPieceAt(s).getOwner();if(a.isPlayer()){const c=K2.getSquareScore(e,s);if(mn.isVictory(c)){if(a!==n)return ye.getDefeat(n);i=!0}}}return i?ye.getVictory(n):ye.ONGOING}getLegalMoves(t){const e=[];for(const n of t.toMap()){const i=n.key;if(i.x+1<Xi.SIZE){const o=new _(i.x+1,i.y);e.push(...this.getPossiblesMoves(t,i,o))}if(i.y+1<Xi.SIZE){const o=new _(i.x,i.y+1);e.push(...this.getPossiblesMoves(t,i,o))}}return e}getPossiblesMoves(t,e,n){const i=t.getPieceAt(e),o=t.getPieceAt(n);let s;s=!i.isGround()&&i.getUpperTileId()===o.getUpperTileId();const a=i.getHeight()!==o.getHeight();return s||a?[]:[As.from(e,n).get(),As.from(n,e).get()]}}class LHe extends Ha{getBoardValue(t,e){let n=0;const i=t.gameState;for(const o of i.toMap())i.getPieceAt(o.key).getOwner().isPlayer()&&(n+=K2.getSquareScore(i,o.key));return mn.of(n)}}class fee extends Kn{rules=K2.get();getListMoves(t,e){return this.rules.getLegalMoves(t.gameState)}}function zHe(r,t){if(1&r){const e=he();I(),E(0,"g")(1,"polygon",5),q("click",function(){const o=te(e).index,s=p().index;return ne(p().onClick(o,s))}),P()()}if(2&r){const e=t.index,n=p().index,i=p();m(),ve("id","space_",e,"_",n,""),v("ngClass",i.getSpaceClasses(e,n)),A("points",i.getParallelogramPoints())("transform",i.getTranslationAtXYZ(e,n,0))}}function DHe(r,t){if(1&r&&(I(),E(0,"g"),z(1,zHe,2,5,"g",1),P()),2&r){const e=t.$implicit;m(),v("ngForOf",e)}}function VHe(r,t){if(1&r){const e=he();I(),E(0,"g",8),q("click",function(){te(e);const i=p().index,o=p().index;return ne(p(2).onClick(i,o))}),P()}if(2&r){const e=p(),n=e.index,i=e.$implicit,o=p().index,s=p().index,a=p();Ur("id","half_tile_",n,"_",o,"_",s,""),v("mode",a.mode)("coord",a.Coord3D.of(n,o,s))("mustDisplayHeight","2D"===a.chosenMode)("move",i.move.get())("pieceClasses",a.getPieceClasses(n,o,s)),A("transform",a.getTranslationAtXYZ(n,o,s+1))}}const dee=r=>[r];function HHe(r,t){if(1&r){const e=he();I(),E(0,"g",9),q("click",function(){te(e);const i=p().index,o=p().index;return ne(p(2).onClick(i,o))}),P()}if(2&r){const e=p().index,n=p().index,i=p().index,o=p();Ur("id","dropped_piece_",e,"_",n,"_",i,""),v("mode",o.mode)("coord",o.Coord3D.of(e,n,i))("pieceClasses",Ta(7,dee,o.currentOpponentClass)),A("transform",o.getTranslationAtXYZ(e,n,i+1))}}function FHe(r,t){if(1&r&&(I(),E(0,"g"),z(1,VHe,1,9,"g",6)(2,HHe,1,9,"g",7),P()),2&r){const e=t.$implicit;m(),v("ngIf",e.move.isPresent()),m(),v("ngIf",e.isDroppedPiece)}}function UHe(r,t){if(1&r&&(I(),E(0,"g"),z(1,FHe,3,2,"g",1),P()),2&r){const e=t.$implicit;m(),v("ngForOf",e)}}function GHe(r,t){if(1&r&&(I(),E(0,"g"),z(1,UHe,2,1,"g",1),P()),2&r){const e=t.$implicit;m(),v("ngForOf",e)}}const BHe=()=>["player0-fill"];function $He(r,t){if(1&r){const e=he();I(),E(0,"g",10),q("click",function(){return te(e),ne(p().switchToMode("3D"))}),P()}if(2&r){const e=p();v("mode",e.TrexoComponent.modeMap["3D"])("coord",e.Coord3D.of(10.5,8.5,0))("pieceClasses",fr(4,BHe)),A("transform",e.get3DSwitcherTransform())}}function WHe(r,t){if(1&r){const e=he();I(),E(0,"g",11),q("click",function(){return te(e),ne(p().switchToMode("2D"))}),P()}if(2&r){const e=p();v("mode",e.TrexoComponent.modeMap["2D"])("coord",e.Coord3D.of(12,9,0))("pieceClasses",Ta(4,dee,e.currentPlayerClass)),A("transform",e.getTranslationAtXYZ(12,9,0))}}class l1 extends RJ{static STROKE_WIDTH;static INITIAL_PIECE_ON_BOARD={isDroppedPiece:!1,isPossibleClick:!1,move:h.empty()};static modeMap={"2D":{offsetRatio:0,horizontalWidthRatio:1,pieceHeightRatio:0,parallelogramHeight:100,abstractBoardSize:10},"3D":{offsetRatio:.4,horizontalWidthRatio:1.2,pieceHeightRatio:.2,parallelogramHeight:100,abstractBoardSize:10}};TrexoComponent=l1;left=-this.STROKE_WIDTH/2;Coord3D=Vd;up=0;width;height;mode;chosenMode="3D";victoryCoords=[];lastMoved=[];droppedPiece=h.empty();possibleNextClicks=[];possibleMoves=[];pieceOnBoard=[];currentOpponentClass="player1";currentPlayerClass="player0";constructor(t){super(t),this.setRulesAndNode("Trexo"),this.availableAIs=[new fn($localize`Alignment`,this.rules,new LHe,new fee),new zn($localize`MCTS`,new fee,this.rules)],this.encoder=As.encoder,l1.STROKE_WIDTH=this.STROKE_WIDTH,this.switchToMode("3D")}switchToMode(t){this.chosenMode=t,this.width=this.getViewBoxWidth(),this.up=this.getViewBoxUp(),this.height=this.getViewBoxHeight(),this.mode=l1.modeMap[t]}getViewBoxWidth(){const t=l1.modeMap["3D"],e=Xi.SIZE;return"2D"===this.chosenMode?(e+1)*this.SPACE_SIZE+2*this.STROKE_WIDTH:e*(this.SPACE_SIZE*(t.horizontalWidthRatio+t.offsetRatio))+this.STROKE_WIDTH}getViewBoxHeight(){const e=Xi.SIZE*this.SPACE_SIZE;return"2D"===this.chosenMode?e:this.STROKE_WIDTH+e+this.getHigherStackHeight()}getViewBoxUp(){if("2D"===this.chosenMode)return 0;{const t=this.getHigherStackHeight();return-(this.STROKE_WIDTH/2+t)}}getHigherStackHeight(){return(this.pieceOnBoard.length+1)*l1.modeMap[this.chosenMode].pieceHeightRatio*this.SPACE_SIZE}updateBoard(t){var e=this;return M(function*(){const n=e.getState();e.board=n.getCopiedBoard(),e.currentOpponentClass=e.getPlayerClass(n.getCurrentOpponent()),e.currentPlayerClass=e.getPlayerClass(n.getCurrentPlayer()),e.possibleMoves=e.rules.getLegalMoves(n),e.victoryCoords=K2.getVictoriousCoords(n),e.pieceOnBoard=e.get3DBoard(),e.height=e.getViewBoxHeight(),e.up=e.getViewBoxUp()})()}showLastMove(t,e){var n=this;return M(function*(){n.lastMoved=[t.getZero(),t.getOne()]})()}hideLastMove(){this.lastMoved=[]}get3DBoard(){const t=KNe.create(1,Xi.SIZE,Xi.SIZE,l1.INITIAL_PIECE_ON_BOARD);let e=1;for(let n=0;n<=e;n++)for(const i of this.getState().toMap()){const o=i.key,s=i.value.getHeight();if(e=Math.max(e,s),n<s){const a=this.extractMoveFromState(o.x,o.y,n);this.addMoveToArray(n,a,t)}}return t}extractMoveFromState(t,e,n){const i=this.getState().getPieceAtXYZ(t,e,n),o=new _(t,e);let s=new _(-2,-2);for(const a of me.ORTHOGONALS){const c=o.getNext(a);if(Xi.isOnBoard(c)){const l=this.getState().getPieceAt(c);l.getHeight()>n&&l.getPieceAt(n).tileId===i.tileId&&(s=c)}}return i.owner===O.ZERO?As.from(o,s).get():As.from(s,o).get()}addMoveToArray(t,e,n){for(;n.length<=t;)n.push(rt.create(Xi.SIZE,Xi.SIZE,l1.INITIAL_PIECE_ON_BOARD));n[t][e.getZero().y][e.getZero().x]={isDroppedPiece:!1,isPossibleClick:!1,move:h.of(e)},n[t][e.getOne().y][e.getOne().x]={isDroppedPiece:!1,isPossibleClick:!1,move:h.of(e)}}onClick(t,e){var n=this;return M(function*(){const i=yield n.canUserPlay("#space_"+t+"_"+e);if(i.isFailure())return n.cancelMove(i.getReason());const o=new _(t,e);if(n.droppedPiece.isPresent()){const s=n.droppedPiece.get();if(n.droppedPiece.equalsValue(o))return yield n.cancelMoveAttempt(),w.SUCCESS;if(n.possibleNextClicks.some(a=>a.equals(o))){const a=n.getState().getCurrentPlayer()===O.ZERO,u=As.from(a?o:s,a?s:o).get();return n.chooseMove(u)}n.deselectPiece()}return n.selectPiece(o)})()}deselectPiece(){const t=this.getState().getPieceAt(this.droppedPiece.get()).getHeight(),e=this.droppedPiece.get().y,n=this.droppedPiece.get().x;this.pieceOnBoard[t][e][n]=l1.INITIAL_PIECE_ON_BOARD;for(const i of this.possibleNextClicks)this.pieceOnBoard[t][i.y][i.x].isPossibleClick=!1}selectPiece(t){var e=this;return M(function*(){if(e.possibleMoves.some(n=>n.getZero().equals(t))){const n=e.getState().getPieceAt(t).getHeight();return e.pieceOnBoard.length<=n&&e.pieceOnBoard.push(rt.create(Xi.SIZE,Xi.SIZE,l1.INITIAL_PIECE_ON_BOARD)),e.showDroppedPieceAndIndicators(t,n),w.SUCCESS}return e.cancelMove(uv.NO_WAY_TO_DROP_IT_HERE())})()}showDroppedPieceAndIndicators(t,e){this.droppedPiece=h.of(t),this.possibleNextClicks=this.getPossibleNextClicks(t);for(const n of this.possibleNextClicks)this.pieceOnBoard[e][n.y][n.x]={isDroppedPiece:!1,isPossibleClick:!0,move:h.empty()};this.pieceOnBoard[e][t.y][t.x]={isDroppedPiece:!0,isPossibleClick:!1,move:h.empty()}}getPossibleNextClicks(t){return this.possibleMoves.filter(n=>n.getZero().equals(t)).map(n=>n.getOne())}cancelMoveAttempt(){var t=this;return M(function*(){t.droppedPiece=h.empty(),t.possibleNextClicks=[],yield t.updateBoard(!1)})()}getPieceClasses(t,e,n){const i=new _(t,e),o=this.getState().getPieceAtXYZ(t,e,n).owner;let s=[this.getPlayerClass(o)];return s=s.concat(this.getSpaceClasses(t,e)),this.victoryCoords.some(a=>a.equals(i))&&s.push("victory-stroke"),this.lastMoved.some(a=>a.equals(i))&&s.push("last-move-stroke"),s}getSpaceClasses(t,e){for(const n of this.pieceOnBoard)if(n[e][t].isPossibleClick)return["darker"];return[]}getTranslationAtXYZ(t,e,n){const o=this.getCoordTranslation(t,e,n,l1.modeMap[this.chosenMode]);return"translate("+o.x+" "+o.y+")"}getParallelogramPoints(){return this.getParallelogramCoordsForTrexo().map(e=>e.x+" "+e.y).join(" ")}getParallelogramCoordsForTrexo(){return this.getParallelogramCoords(l1.modeMap[this.chosenMode])}get3DSwitcherTransform(){const t=l1.modeMap["3D"],e=t.horizontalWidthRatio+t.offsetRatio;return"translate("+(10+t.offsetRatio)*t.parallelogramHeight+", "+(9+(1-1/e)/2)*t.parallelogramHeight+") scale("+1/e+")"}static \u0275fac=function(e){return new(e||l1)(G(Ut))};static \u0275cmp=Ue({type:l1,selectors:[["app-trexo"]],features:[$e],decls:8,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%"],[4,"ngFor","ngForOf"],["switchModeIndicator",""],["id","switchTo3D","mgp-trexo-half-piece","",3,"mode","coord","pieceClasses","click",4,"ngIf","ngIfElse"],["switchTo2D",""],[1,"base",3,"id","ngClass","click"],["mgp-trexo-half-piece","",3,"id","mode","coord","mustDisplayHeight","move","pieceClasses","click",4,"ngIf"],["mgp-trexo-half-piece","",3,"mode","id","coord","pieceClasses","click",4,"ngIf"],["mgp-trexo-half-piece","",3,"id","mode","coord","mustDisplayHeight","move","pieceClasses","click"],["mgp-trexo-half-piece","",3,"mode","id","coord","pieceClasses","click"],["id","switchTo3D","mgp-trexo-half-piece","",3,"mode","coord","pieceClasses","click"],["mgp-trexo-half-piece","","id","switchTo2D",3,"mode","coord","pieceClasses","click"]],template:function(e,n){if(1&e&&(I(),E(0,"svg",0),z(1,DHe,2,1,"g",1)(2,GHe,2,1,"g",1),E(3,"g",null,2),z(5,$He,1,5,"g",3)(6,WHe,1,6,"ng-template",null,4,In),P()()),2&e){const i=wn(7);A("viewBox",n.left+" "+n.up+" "+n.width+" "+n.height),m(),v("ngForOf",n.board),m(),v("ngForOf",n.pieceOnBoard),m(3),v("ngIf","2D"===n.chosenMode)("ngIfElse",i)}},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}const Q=hi.EMPTY,hee=hi.of([new S2(O.ONE,0)]),qHe=hi.of([new S2(O.ZERO,0)]),jHe=hi.of([new S2(O.ONE,1)]),gee=hi.of([new S2(O.ZERO,1)]),ZHe=hi.of([new S2(O.ZERO,2)]),YHe=hi.of([new S2(O.ONE,2)]),KHe=hi.of([new S2(O.ZERO,0),new S2(O.ZERO,3)]),XHe=hi.of([new S2(O.ONE,1),new S2(O.ONE,3)]),QHe=hi.of([new S2(O.ZERO,4)]),JHe=hi.of([new S2(O.ONE,4)]),eFe=hi.of([new S2(O.ZERO,5)]),tFe=hi.of([new S2(O.ONE,5)]),nFe=hi.of([new S2(O.ONE,6)]),rFe=hi.of([new S2(O.ZERO,6)]);class iFe extends Wn{tutorial=[W.informational($localize`Goal of the game`,$localize`At Trexo, the goal of the game is to align 5 pieces of your color in a vertical, horizontal or diagonal line. However, the players play with tiles that are constituted of two pieces, one from each player!`,K2.get().getInitialState()),W.anyMove($localize`Dropping a tile`,$localize`When you drop a tile, it needs to be on even ground, and it cannot be right on top of another tile. In others words, it needs to be either on the floor, or on two tiles at the same height. To drop a tile, just click on the square where you want to put the opponent side of the tile, then on the neighboring square where you want to put your piece.<br/><br/>You're playing Dark, put a tile on the board.`,K2.get().getInitialState(),As.from(new _(4,4),new _(3,4)).get(),pe.CONGRATULATIONS()),W.fromMove($localize`Dropping a piece over other pieces`,$localize`You can put a tile on other tiles. For that you must respect two rules:<br/><ul><li>The two pieces must be at the same height.</li><li>You cannot drop your piece on only one other piece.</li></ul><br/>You're playing Dark, do such a move!`,new Xi([[Q,Q,Q,hee,qHe,gee,jHe,Q,Q,Q],[Q,Q,Q,Q,Q,Q,Q,Q,Q,Q],[Q,Q,Q,Q,Q,Q,Q,Q,Q,Q],[Q,Q,Q,Q,Q,Q,Q,Q,Q,Q],[Q,Q,Q,Q,Q,Q,Q,Q,Q,Q],[Q,Q,Q,Q,Q,Q,Q,Q,Q,Q],[Q,Q,Q,Q,Q,Q,Q,Q,Q,Q],[Q,Q,Q,Q,Q,Q,Q,Q,Q,Q],[Q,Q,Q,Q,Q,Q,Q,Q,Q,Q],[Q,Q,Q,Q,Q,Q,Q,Q,Q,Q]],7),[As.from(new _(4,0),new _(5,0)).get(),As.from(new _(5,0),new _(4,0)).get()],pe.CONGRATULATIONS(),$localize`Failed, you put that piece on the floor level, please put it on top of two pieces.`),W.fromPredicate($localize`Victory`,$localize`To win at Trexo, you need to align 5 of your pieces. Only the piece on top counts, the hidden piece are no longer threats, and a victory can include pieces on differents heights. Since you have to put the piece of your opponent first, if you create a victory for them, you lose, even if you aligned 5 of your pieces too.<br/><br/>You're playing Light, win.`,new Xi([[Q,Q,Q,Q,Q,Q,Q,Q,Q,Q],[Q,Q,Q,eFe,Q,Q,Q,Q,Q,Q],[Q,Q,Q,tFe,Q,Q,Q,Q,Q,Q],[Q,Q,Q,Q,hee,Q,Q,QHe,JHe,Q],[Q,Q,Q,Q,KHe,XHe,gee,Q,Q,Q],[Q,Q,Q,Q,Q,ZHe,nFe,rFe,Q,Q],[Q,Q,Q,Q,Q,YHe,Q,Q,Q,Q],[Q,Q,Q,Q,Q,Q,Q,Q,Q,Q],[Q,Q,Q,Q,Q,Q,Q,Q,Q,Q],[Q,Q,Q,Q,Q,Q,Q,Q,Q,Q]],7),As.from(new _(2,0),new _(2,1)).get(),(t,e,n)=>K2.TREXO_HELPER.getSquareScore(n,t.getOne())===Number.MAX_SAFE_INTEGER?w.SUCCESS:w.failure(pe.FAILED_TRY_AGAIN()),pe.CONGRATULATIONS_YOU_WON())]}class Wo{static PLACEMENT_AFTER_INITIAL_PHASE=()=>$localize`You cannot put a new ring after the tenth turn.`;static NO_MARKERS_IN_INITIAL_PHASE=()=>$localize`You cannot put a marker in a ring before placing all of your rings.`;static MISSING_CAPTURES=oa.MISSING_CAPTURES;static MOVE_DIRECTION_INVALID=()=>$localize`The direction of your move is invalid: a move is made along a straight line.`;static CAN_ONLY_CAPTURE_YOUR_MARKERS=()=>$localize`You can only capture your own markers.`;static SHOULD_SELECT_PLAYER_RING=()=>$localize`You must pick one of your own rings to move.`;static SHOULD_END_MOVE_ON_EMPTY_SPACE=()=>$localize`Your ring must land on an empty space.`;static MOVE_SHOULD_NOT_PASS_ABOVE_RING=()=>$localize`A ring can only jump over markers or empty spaces, not over another ring.`;static MOVE_SHOULD_END_AT_FIRST_EMPTY_SPACE_AFTER_MARKERS=()=>$localize`Your ring must land on the first empty space after a group of markers.`;static AMBIGUOUS_CAPTURE_COORD=oa.AMBIGUOUS_CAPTURE_COORD;static CAPTURE_SHOULD_TAKE_RING=()=>$localize`When you capture markers, you must take one of your ring as well by clicking on it.`}class xt{player;isRing;static encoder=ke.tuple([B.encoder,ke.identity()],t=>[t.player,t.isRing],t=>xt.of(t[0],t[1]));static UNREACHABLE=new xt(B.NONE,!1);static EMPTY=new xt(B.NONE,!1);static MARKER_ZERO=new xt(O.ZERO,!1);static MARKER_ONE=new xt(O.ONE,!1);static MARKERS=Q3.ofValues(xt.MARKER_ZERO,xt.MARKER_ONE);static RING_ZERO=new xt(O.ZERO,!0);static RING_ONE=new xt(O.ONE,!0);static RINGS=Q3.ofValues(xt.RING_ZERO,xt.RING_ONE);static of(t,e){if(t===B.NONE)return xt.EMPTY;{const n=t;return e?xt.RINGS.get(n):xt.MARKERS.get(n)}}constructor(t,e){this.player=t,this.isRing=e}equals(t){return this===t}flip(){return pn(!1===this.isRing,"cannot flip a ring (it should never happen)"),pn(this.player.isPlayer(),"cannot flip a non-player piece"),xt.of(this.player.getOpponent(),this.isRing)}toString(){switch(this){case xt.UNREACHABLE:return"NONE";case xt.EMPTY:return"EMPTY";case xt.MARKER_ZERO:return"MARKER_ZERO";case xt.MARKER_ONE:return"MARKER_ONE";case xt.RING_ZERO:return"RING_ZERO";default:return L.expectToBe(this,xt.RING_ONE),"RING_ONE"}}}let Xa=(()=>{class r extends zI{sideRings;static SIZE=11;constructor(e,n,i){super(i,e,r.SIZE,r.SIZE,[6,4,3,2,1],xt.EMPTY),this.sideRings=n}isInitialPlacementPhase(){return this.turn<10}countScores(){return this.turn<10?we.of(0,0):this.sideRings}equals(e){return this===e||this.turn===e.turn&&!1!==this.sideRings.equals(e.sideRings)&&rt.compare(this.board,e.board)}getRingCoords(e){const n=[];return this.forEachCoord((i,o)=>{o.isRing&&o.player===e&&n.push(i)}),n}isOnBoard(e){return!e.isNotInRange(this.width,this.height)&&this.board[e.y][e.x]!==xt.UNREACHABLE}setAtUnsafe(e,n){const i=rt.copy(this.board);return i[e.y][e.x]=n,new r(i,this.sideRings,this.turn)}}return r})();class Qa extends ji{static encoder=ke.tuple([ke.list(_.encoder),h.getEncoder(_.encoder)],t=>[t.capturedSpaces,t.ringTaken],t=>new Qa(t[0],t[1]));static of(t,e,n){const i=[],o=Te.factory.fromMove(t,e).get();for(let s=t;!1===s.equals(e);s=s.getNext(o))i.push(s);return i.push(e),new Qa(i,n)}ringTaken;constructor(t,e=h.empty()){if(super(t),5!==t.length)throw new Error("YinshCapture must capture exactly 5 pieces");this.ringTaken=e}setRingTaken(t){return new Qa(this.capturedSpaces,h.of(t))}equals(t){return!(!1===super.equals(t)||!1===this.ringTaken.equals(t.ringTaken))}}class s3 extends h2{initialCaptures;start;end;finalCaptures;static encoder=ke.tuple([ke.list(Qa.encoder),_.encoder,h.getEncoder(_.encoder),ke.list(Qa.encoder)],t=>[t.initialCaptures,t.start,t.end,t.finalCaptures],t=>new s3(t[0],t[1],t[2],t[3]));constructor(t,e,n,i){super(),this.initialCaptures=t,this.start=e,this.end=n,this.finalCaptures=i}isInitialPlacement(){return this.end.isAbsent()}equals(t){return this===t||!(!1===this.start.equals(t.start)||!1===this.end.equals(t.end)||!1===yt.equals(this.initialCaptures,t.initialCaptures)||!1===yt.equals(this.finalCaptures,t.finalCaptures))}toString(){return"YinshMove(["+this.capturesToString(this.initialCaptures)+"], "+this.start.toString()+", "+this.end.toString()+", ["+this.capturesToString(this.finalCaptures)+"])"}capturesToString(t){let e="";for(const n of t)""!==e&&(e+=","),e+="["+n.toString()+"]";return e}}class oFe extends rr{getMetrics(t,e){return t.gameState.sideRings.toTable()}}class sFe{static getCombinations(t,e){return pn(e<=t.length,"cannot compute combinations for less elements than needed"),this.getSubsetsOfSize(t,e).map(n=>this.getPermutations(n)).reduce((n,i)=>n.concat(i))}static getPermutations(t){const e=t.length,n=[t.slice()],i=new Array(e).fill(0);let o=1;for(;o<e;)if(i[o]<o){const s=o%2&&i[o],a=t[o];t[o]=t[s],t[s]=a,++i[o],o=1,n.push(t.slice())}else i[o]=0,++o;return n}static getSubsetsOfSize(t,e){return function n(i,o){if(t.length<=o||i<1)return[[]];{const s=[];for(;o<=t.length-i;){const a=t[o];for(const c of n(i-1,o+1))c.push(a),s.push(c);++o}return s}}(e,0)}}class a3 extends Ar{static singleton=h.empty();static get(){return a3.singleton.isAbsent()&&(a3.singleton=h.of(new a3)),a3.singleton.get()}getInitialState(){const t=xt.EMPTY,e=xt.UNREACHABLE;return new Xa([[e,e,e,e,e,e,t,t,t,t,e],[e,e,e,e,t,t,t,t,t,t,t],[e,e,e,t,t,t,t,t,t,t,t],[e,e,t,t,t,t,t,t,t,t,t],[e,t,t,t,t,t,t,t,t,t,t],[e,t,t,t,t,t,t,t,t,t,e],[t,t,t,t,t,t,t,t,t,t,e],[t,t,t,t,t,t,t,t,t,e,e],[t,t,t,t,t,t,t,t,e,e,e],[t,t,t,t,t,t,t,e,e,e,e],[e,t,t,t,t,e,e,e,e,e,e]],we.of(5,5),0)}applyLegalMove(t,e,n,i){return new Xa(i.board,i.sideRings,i.turn+1)}applyCaptures(t,e){let n=e;return t.forEach(i=>{n=this.applyCapture(i,n)}),n}applyCapture(t,e){const n=this.applyCaptureWithoutTakingRing(e,t);return this.takeRing(new Xa(n,e.sideRings,e.turn),t.ringTaken.get())}takeRing(t,e){const n=t.getCurrentPlayer(),i=t.setAt(e,xt.EMPTY).board,o=t.sideRings.getCopy();return o.add(n,1),new Xa(i,o,t.turn)}applyCaptureWithoutTakingRing(t,e){return e.forEach(n=>{t=t.setAt(n,xt.EMPTY)}),t.board}ringSelectionValidity(t,e){const n=t.getCurrentPlayer();return t.getPieceAt(e)===xt.RINGS.get(n)?w.SUCCESS:w.failure(Wo.CAPTURE_SHOULD_TAKE_RING())}applyRingMoveAndFlip(t,e,n){const i=n.getCurrentPlayer();let o=n.setAt(t,xt.MARKERS.get(i));o=o.setAt(e,xt.RINGS.get(i));const s=Te.factory.fromMove(t,e).get();for(let a=t.getNext(s);!1===a.equals(e);a=a.getNext(s)){const c=o.getPieceAt(a);c!==xt.EMPTY&&(o=o.setAt(a,c.flip()))}return o}isLegal(t,e){if(t.isInitialPlacement())return this.initialPlacementValidity(e,t.start);if(e.isInitialPlacementPhase())return X.failure(Wo.NO_MARKERS_IN_INITIAL_PHASE());const n=this.capturesValidity(e,t.initialCaptures);if(n.isFailure())return n.toOtherFallible();const i=this.applyCaptures(t.initialCaptures,e),o=this.moveValidity(i,t.start,t.end.get());if(o.isFailure())return o.toOtherFallible();const s=this.applyRingMoveAndFlip(t.start,t.end.get(),i),a=this.capturesValidity(s,t.finalCaptures);if(a.isFailure())return a.toOtherFallible();const c=this.applyCaptures(t.finalCaptures,s),l=this.noMoreCapturesValidity(c);return l.isFailure()?l.toOtherFallible():X.success(c)}initialPlacementValidity(t,e){if(!1===t.isInitialPlacementPhase())return X.failure(Wo.PLACEMENT_AFTER_INITIAL_PHASE());if(t.getPieceAt(e)!==xt.EMPTY)return X.failure(Ee.MUST_CLICK_ON_EMPTY_SPACE());const n=t.getCurrentPlayer(),i=t.sideRings.getCopy();i.add(n,-1);const o=t.setAt(e,xt.of(n,!0)).board,s=new Xa(o,i,t.turn);return X.success(s)}moveStartValidity(t,e){const n=t.getCurrentPlayer();return t.getPieceAt(e)===xt.RINGS.get(n)?w.SUCCESS:w.failure(Wo.SHOULD_SELECT_PLAYER_RING())}moveValidity(t,e,n){const i=this.moveStartValidity(t,e);if(i.isFailure())return i;if(t.getPieceAt(n)!==xt.EMPTY)return w.failure(Wo.SHOULD_END_MOVE_ON_EMPTY_SPACE());const o=Te.factory.fromMove(e,n);if(o.isFailure())return w.failure(Wo.MOVE_DIRECTION_INVALID());const s=o.get();let a=!1;for(let c=e.getNext(s);!1===c.equals(n);c=c.getNext(s)){const l=t.getPieceAt(c);if(l===xt.EMPTY){if(a)return w.failure(Wo.MOVE_SHOULD_END_AT_FIRST_EMPTY_SPACE_AFTER_MARKERS())}else{if(l.isRing)return w.failure(Wo.MOVE_SHOULD_NOT_PASS_ABOVE_RING());a=!0}}return w.SUCCESS}capturesValidity(t,e){let n=t;for(const i of e){const o=this.captureValidity(n,i);if(o.isFailure())return o;n=this.applyCapture(i,n)}return w.SUCCESS}captureValidity(t,e){const n=t.getCurrentPlayer();for(const i of e.capturedSpaces)if(t.getPieceAt(i)!==xt.MARKERS.get(n))return w.failure(Wo.CAN_ONLY_CAPTURE_YOUR_MARKERS());return t.getPieceAt(e.ringTaken.get())!==xt.RINGS.get(n)?w.failure(Wo.CAPTURE_SHOULD_TAKE_RING()):w.SUCCESS}noMoreCapturesValidity(t){const e=t.getCurrentPlayer();return 0===this.getLinePortionsWithAtLeastFivePiecesOfPlayer(t,e).length?w.SUCCESS:w.failure(Wo.MISSING_CAPTURES())}getLinePortionsWithAtLeastFivePiecesOfPlayer(t,e){const n=[];return t.allLines().forEach(i=>{const o=this.getLinePortionWithAtLeastFivePiecesOfPlayer(t,e,i);o.isPresent()&&n.push(o.get())}),n}getLinePortionWithAtLeastFivePiecesOfPlayer(t,e,n){let i=0;const o=t.getEntranceOnLine(n),s=n.getDirection();let c,a=o;for(c=o;t.isOnBoard(c);c=c.getNext(s)){const l=t.getPieceAt(c);if(l.player===e&&!1===l.isRing)0===i&&(a=c),i+=1;else{if(5<=i)break;i=0}}return 5<=i?h.of({start:a,end:c,dir:s}):h.empty()}getPossibleCaptures(t){const e=t.getCurrentPlayer(),n=[];return this.getLinePortionsWithAtLeastFivePiecesOfPlayer(t,e).forEach(i=>{for(let o=i.start;5<=o.getDistance(i.end);o=o.getNext(i.dir))n.push(Qa.of(o,o.getNext(i.dir,4)))}),n}getRingTargets(t,e){const n=[];for(const i of Te.factory.all){let o=!1;for(let s=e.getNext(i);t.isOnBoard(s);s=s.getNext(i)){const a=t.getPieceAt(s);if(a===xt.EMPTY){if(n.push(s),o)break}else{if(a.isRing)break;o=!0}}}return n}getGameStatus(t){return t.gameState.isInitialPlacementPhase()?ye.ONGOING:3<=t.gameState.sideRings.get(O.ZERO)?ye.ZERO_WON:3<=t.gameState.sideRings.get(O.ONE)?ye.ONE_WON:ye.ONGOING}}class pee extends Kn{getListMoves(t,e){const n=[],i=t.gameState;if(i.isInitialPlacementPhase())for(const{coord:o,content:s}of i.getCoordsAndContents())s===xt.EMPTY&&n.push(new s3([],o,h.empty(),[]));else{const o=a3.get();this.getPossibleCaptureCombinations(i).forEach(s=>{const a=o.applyCaptures(s,i);this.getRingMoves(a).forEach(c=>{const l=o.applyRingMoveAndFlip(c.start,c.end,a);this.getPossibleCaptureCombinations(l).forEach(u=>{const f=new s3(s,c.start,h.of(c.end),u);n.push(f)})})})}return n}getPossibleCaptureCombinations(t){const n=a3.get().getPossibleCaptures(t),i=this.getRingCoords(t);return kC.getPossibleCaptureCombinationsFromPossibleCaptures(n).map(o=>sFe.getCombinations(i,o.length).map(s=>o.map((a,c)=>new Qa(a.capturedSpaces,h.of(s[c]))))).reduce((o,s)=>o.concat(s),[])}getRingMoves(t){const e=a3.get(),n=[];for(const i of this.getRingCoords(t))for(const o of e.getRingTargets(t,i))n.push({start:i,end:o});return n}getRingCoords(t){const e=t.getCurrentPlayer(),n=[];return t.forEachCoord((i,o)=>{o===xt.RINGS.get(e)&&n.push(i)}),n}}function aFe(r,t){if(1&r&&(I(),V(0,"circle",12)),2&r){const e=p(2).$implicit,n=p(2);A("cx",e.center.x)("cy",e.center.y)("r",n.viewInfo.ringOuterSize)}}function cFe(r,t){if(1&r&&(I(),V(0,"circle",13)),2&r){const e=p(2),n=e.index,i=e.$implicit,o=p().index,s=p();ve("id","ring_",n,"_",o,""),v("ngClass",i.ringClasses),A("cx",i.center.x)("cy",i.center.y)("r",s.viewInfo.ringMidSize)}}function lFe(r,t){if(1&r&&(I(),V(0,"circle",12)),2&r){const e=p(2).$implicit,n=p(2);A("cx",e.center.x)("cy",e.center.y)("r",n.viewInfo.ringInnerSize)}}function uFe(r,t){if(1&r&&(I(),V(0,"circle",14)),2&r){const e=p(2),n=e.index,i=e.$implicit,o=p().index,s=p();ve("id","marker_",n,"_",o,""),v("ngClass",i.markerClasses),A("cx",i.center.x)("cy",i.center.y)("r",s.viewInfo.markerSize)}}function fFe(r,t){if(1&r){const e=he();I(),E(0,"g",6),q("click",function(){te(e);const i=p().$implicit;return ne(p(2).onClick(i.coord))}),V(1,"polygon",7),E(2,"g",8),z(3,aFe,1,3,"circle",9)(4,cFe,1,6,"circle",10)(5,lFe,1,3,"circle",9)(6,uFe,1,6,"circle",11),P()()}if(2&r){const e=p(),n=e.index,i=e.$implicit,o=p().index,s=p();ve("id","click_",n,"_",o,""),m(),ve("id","space_",n,"_",o,""),v("ngClass",s.getSpaceClasses(n,o)),A("points",i.coordinates)("transform",s.getHexaCenterTranslationAtXY(n,o)),m(),ve("id","pieceGroup_",n,"_",o,""),v("ngClass",i.removedClass),m(),v("ngIf",i.isRing),m(),v("ngIf",i.isRing),m(),v("ngIf",i.isRing),m(),v("ngIf",i.isMarker)}}function dFe(r,t){if(1&r&&(I(),E(0,"g"),z(1,fFe,7,14,"g",5),P()),2&r){const e=t.$implicit;m(),v("ngIf",null!=e)}}function hFe(r,t){if(1&r&&(I(),E(0,"g"),z(1,dFe,2,1,"g",1),P()),2&r){const e=t.$implicit;m(),v("ngForOf",e)}}function gFe(r,t){if(1&r){const e=he();I(),E(0,"polygon",15),q("click",function(){const o=te(e).$implicit;return ne(p().onClick(o))}),P()}if(2&r){const e=t.$implicit,n=p();ve("id","selected_",e.x,"_",e.y,""),A("points",n.viewInfo.spaceInfo[e.y][e.x].coordinates)}}function pFe(r,t){if(1&r){const e=he();I(),E(0,"polygon",17),q("click",function(){const o=te(e).$implicit;return ne(p(2).onClick(o))}),P()}if(2&r){const e=t.$implicit,n=p(2);ve("id","selectable_",e.x,"_",e.y,""),A("points",n.viewInfo.spaceInfo[e.y][e.x].coordinates)}}function mFe(r,t){if(1&r&&(I(),E(0,"g"),z(1,pFe,1,3,"polygon",16),P()),2&r){const e=p();m(),v("ngForOf",e.viewInfo.selectableCoords)}}function _Fe(r,t){if(1&r){const e=he();I(),E(0,"rect",18),q("click",function(){const o=te(e).$implicit;return ne(p().onClick(o))}),P()}if(2&r){const e=t.$implicit,n=p();ve("id","indicator_",e.x,"_",e.y,""),A("x",n.viewInfo.spaceInfo[e.y][e.x].center.x-n.viewInfo.indicatorSize/2)("y",n.viewInfo.spaceInfo[e.y][e.x].center.y-n.viewInfo.indicatorSize/2)("width",n.viewInfo.indicatorSize)("height",n.viewInfo.indicatorSize)}}function CFe(r,t){if(1&r&&(I(),E(0,"g"),V(1,"circle",19)(2,"circle",12)(3,"circle",20),P()),2&r){const e=t.index,n=p().$implicit,i=p();m(),ve("id","player_",n.getValue(),"_sideRing_",e+1,""),A("cx",(n===i.Player.ZERO?15:1050)+1.2*(n===i.Player.ZERO?1:-1)*i.viewInfo.ringOuterSize*(e+1))("cy",n===i.Player.ZERO?300:1260)("r",i.viewInfo.ringOuterSize),m(),A("cx",(n===i.Player.ZERO?15:1050)+1.2*(n===i.Player.ZERO?1:-1)*i.viewInfo.ringOuterSize*(e+1))("cy",n===i.Player.ZERO?300:1260)("r",i.viewInfo.ringInnerSize),m(),v("ngClass",i.viewInfo.sideRingClass.get(n)),A("cx",(n===i.Player.ZERO?15:1050)+1.2*(n===i.Player.ZERO?1:-1)*i.viewInfo.ringOuterSize*(e+1))("cy",n===i.Player.ZERO?300:1260)("r",i.viewInfo.ringMidSize)}}const vFe=()=>[];function yFe(r,t){if(1&r&&(I(),E(0,"g"),z(1,CFe,4,12,"g",1),P()),2&r){const e=t.$implicit,n=p();A("transform","rotate("+180*(n.getPointOfView().getValue()+1)+" 532.5 780)"),m(),v("ngForOf",fr(2,vFe).constructor(n.viewInfo.sideRings.get(e)))}}class pa extends ru{static RING_OUTER_SIZE=40;static RING_MID_SIZE=34;static RING_INNER_SIZE=28;static MARKER_SIZE=pa.RING_INNER_SIZE;static INDICATOR_SIZE=10;constructedState;movePhase="MOVE_START";lastMoved=[];lastCaptured=[];moveStart=h.empty();moveEnd=h.empty();currentlyMoved=[];currentCapture=h.empty();initialCaptures=[];finalCaptures=[];possibleCaptures=[];viewInfo={spaceInfo:[],selectableCoords:[],selectedCoords:[],targets:[],markerSize:pa.MARKER_SIZE,ringOuterSize:pa.RING_OUTER_SIZE,ringMidSize:pa.RING_MID_SIZE,ringInnerSize:pa.RING_INNER_SIZE,indicatorSize:pa.INDICATOR_SIZE,sideRings:we.of(5,5),sideRingClass:Q3.ofValues("player0-stroke","player1-stroke")};constructor(t){super(t),this.setRulesAndNode("Yinsh"),this.availableAIs=[new fn($localize`Score`,this.rules,new oFe,new pee),new zn($localize`MCTS`,new pee,this.rules)],this.encoder=s3.encoder,this.scores=h.of(we.of(0,0)),this.hexaLayout=new iu(1.5*pa.RING_OUTER_SIZE,new _(2*pa.RING_OUTER_SIZE,0),Yr.INSTANCE),this.constructedState=this.getState(),this.constructedState.allCoords().forEach(e=>{null==this.viewInfo.spaceInfo[e.y]&&(this.viewInfo.spaceInfo[e.y]=[]),this.viewInfo.spaceInfo[e.y][e.x]={coord:e,coordinates:this.getHexaPoints(),center:this.getCenterAt(e),markerClasses:[],ringClasses:[],isMarker:!1,isRing:!1,removedClass:""}})}updateBoard(t){var e=this;return M(function*(){const n=e.getState();e.constructedState=n,e.scores=h.of(n.countScores()),e.moveToInitialCaptureOrMovePhase()})()}updateViewInfo(){switch(this.constructedState.allCoords().forEach(t=>{const e=this.constructedState.getPieceAt(t);this.viewInfo.spaceInfo[t.y][t.x].removedClass="",this.setRingInfo(t,e),this.setMarkerInfo(t,e)}),this.viewInfo.sideRings=this.constructedState.sideRings,this.showCurrentMoveCaptures(),this.viewInfo.targets=[],this.viewInfo.selectableCoords=[],this.movePhase){case"INITIAL_CAPTURE_SELECT_FIRST":case"INITIAL_CAPTURE_SELECT_LAST":case"FINAL_CAPTURE_SELECT_FIRST":case"FINAL_CAPTURE_SELECT_LAST":this.viewInfo.selectableCoords=[];for(const t of this.possibleCaptures)for(const e of t.capturedSpaces)this.viewInfo.selectableCoords.push(e);break;case"INITIAL_CAPTURE_SELECT_RING":case"FINAL_CAPTURE_SELECT_RING":this.viewInfo.selectableCoords=this.constructedState.getRingCoords(this.constructedState.getCurrentPlayer());break;case"MOVE_START":!1===this.getState().isInitialPlacementPhase()&&(this.viewInfo.selectableCoords=this.constructedState.getRingCoords(this.constructedState.getCurrentPlayer()));break;case"MOVE_END":this.viewInfo.targets=this.rules.getRingTargets(this.constructedState,this.moveStart.get())}}showCurrentMoveCaptures(){this.currentCapture.isPresent()&&this.markCurrentCapture(this.currentCapture.get());for(const t of this.initialCaptures)this.markCurrentCapture(t);for(const t of this.finalCaptures)this.markCurrentCapture(t)}getSpaceClasses(t,e){const n=new _(t,e);return this.currentlyMoved.concat(this.lastMoved).some(i=>i.equals(n))?["moved-fill"]:this.lastCaptured.some(i=>i.equals(n))?["captured-fill"]:[]}setRingInfo(t,e){e.isRing?(this.viewInfo.spaceInfo[t.y][t.x].isRing=!0,this.viewInfo.spaceInfo[t.y][t.x].ringClasses=["player"+e.player.getValue()+"-stroke"]):(this.viewInfo.spaceInfo[t.y][t.x].isRing=!1,this.viewInfo.spaceInfo[t.y][t.x].ringClasses=[])}setMarkerInfo(t,e){if(this.viewInfo.spaceInfo[t.y][t.x].isMarker=!1,this.viewInfo.spaceInfo[t.y][t.x].markerClasses=[],e!==xt.EMPTY&&(!1===e.isRing||this.moveStart.equalsValue(t))){const i=this.getPlayerClass(e.player);this.viewInfo.spaceInfo[t.y][t.x].isMarker=!0,this.viewInfo.spaceInfo[t.y][t.x].markerClasses=[i]}}cancelMoveAttempt(){this.constructedState=this.getState(),this.possibleCaptures=[],this.initialCaptures=[],this.finalCaptures=[],this.viewInfo.selectedCoords=[],this.currentCapture=h.empty(),this.moveStart=h.empty(),this.moveEnd=h.empty(),this.currentlyMoved=[],this.moveToInitialCaptureOrMovePhase()}showLastMove(t){var e=this;return M(function*(){if(t.isInitialPlacement())e.lastMoved=[t.start];else{e.lastMoved=e.coordsBetween(t.start,t.end.get());const n=e.currentCapture.isAbsent()&&0===e.initialCaptures.length&&e.moveStart.isAbsent();e.lastCaptured=[],t.initialCaptures.forEach(i=>e.showLastMoveCapture(i,n)),t.finalCaptures.forEach(i=>e.showLastMoveCapture(i,n))}})()}hideLastMove(){this.lastMoved=[],this.lastCaptured=[]}coordsBetween(t,e){return t.getAllCoordsToward(e)}showLastMoveCapture(t,e){for(const n of t.capturedSpaces)this.lastCaptured.push(n),e&&this.markRemovedMarker(n,this.getState().getCurrentOpponent());this.lastCaptured.push(t.ringTaken.get()),e&&this.markRemovedRing(t.ringTaken.get(),this.getState().getCurrentOpponent())}moveToInitialCaptureOrMovePhase(){return this.possibleCaptures=this.rules.getPossibleCaptures(this.constructedState),this.movePhase=0===this.possibleCaptures.length?"MOVE_START":"INITIAL_CAPTURE_SELECT_FIRST",this.updateViewInfo(),w.SUCCESS}onClick(t){var e=this;return M(function*(){const n=yield e.canUserPlay("#click_"+t.x+"_"+t.y);if(n.isFailure())return e.cancelMove(n.getReason());switch(e.movePhase){case"INITIAL_CAPTURE_SELECT_FIRST":case"FINAL_CAPTURE_SELECT_FIRST":return e.selectCaptureFirstCoord(t);case"INITIAL_CAPTURE_SELECT_LAST":case"FINAL_CAPTURE_SELECT_LAST":return e.selectCaptureLastCoord(t);case"INITIAL_CAPTURE_SELECT_RING":case"FINAL_CAPTURE_SELECT_RING":return e.selectRing(t);case"MOVE_START":return e.selectMoveStart(t);case"MOVE_END":return e.selectMoveEnd(t)}})()}selectCaptureFirstCoord(t){var e=this;return M(function*(){const n=[];if(e.possibleCaptures.forEach(i=>{i.contains(t)&&n.push(i)}),n.length>1)e.viewInfo.selectedCoords.push(t),e.moveToCaptureSelectLast(n);else{if(0===n.length)return e.cancelMove(Wo.MISSING_CAPTURES());e.selectCapture(n[0])}return w.SUCCESS})()}moveToCaptureSelectLast(t){this.viewInfo.selectableCoords=[],this.possibleCaptures=t;for(const e of t)for(const n of e.capturedSpaces)this.viewInfo.selectableCoords.push(n);"INITIAL_CAPTURE_SELECT_FIRST"===this.movePhase?this.movePhase="INITIAL_CAPTURE_SELECT_LAST":(L.expectToBe(this.movePhase,"FINAL_CAPTURE_SELECT_FIRST","moveToCaptureSelectLast did not expect to be called in movePhase"+this.movePhase),this.movePhase="FINAL_CAPTURE_SELECT_LAST")}selectCaptureLastCoord(t){var e=this;return M(function*(){const n=[];return e.possibleCaptures.forEach(i=>{i.contains(t)&&n.push(i)}),n.length>1?e.cancelMove(Wo.AMBIGUOUS_CAPTURE_COORD()):0===n.length?e.cancelMove(Wo.MISSING_CAPTURES()):e.selectCapture(n[0])})()}selectCapture(t){return this.currentCapture=h.of(t),this.constructedState=new Xa(this.rules.applyCaptureWithoutTakingRing(this.constructedState,t),this.constructedState.sideRings,this.constructedState.turn),"INITIAL_CAPTURE_SELECT_FIRST"===this.movePhase||"INITIAL_CAPTURE_SELECT_LAST"===this.movePhase?this.movePhase="INITIAL_CAPTURE_SELECT_RING":(pn("FINAL_CAPTURE_SELECT_FIRST"===this.movePhase||"FINAL_CAPTURE_SELECT_LAST"===this.movePhase,"selectCapture did not expect to be called in movePhase "+this.movePhase),this.movePhase="FINAL_CAPTURE_SELECT_RING"),this.updateViewInfo(),w.SUCCESS}markCurrentCapture(t){for(const e of t.capturedSpaces)this.viewInfo.selectedCoords.push(e),this.markRemovedMarker(e,this.getState().getCurrentPlayer());t.ringTaken.isPresent()&&(this.viewInfo.selectedCoords.push(t.ringTaken.get()),this.markRemovedRing(t.ringTaken.get(),this.getState().getCurrentPlayer()))}markRemovedMarker(t,e){this.viewInfo.spaceInfo[t.y][t.x].removedClass="semi-transparent",this.setMarkerInfo(t,xt.MARKERS.get(e))}markRemovedRing(t,e){this.viewInfo.spaceInfo[t.y][t.x].removedClass="semi-transparent",this.setRingInfo(t,xt.RINGS.get(e))}selectRing(t){var e=this;return M(function*(){const n=e.rules.ringSelectionValidity(e.constructedState,t);if(n.isFailure())return e.cancelMove(n.getReason());e.constructedState=e.rules.takeRing(e.constructedState,t);const i=e.currentCapture.get().setRingTaken(t);return"INITIAL_CAPTURE_SELECT_RING"===(e.currentCapture=h.empty(),e.possibleCaptures=e.rules.getPossibleCaptures(e.constructedState),e.movePhase)?(e.initialCaptures.push(i),0===e.possibleCaptures.length?e.moveToMovePhase():(e.movePhase="INITIAL_CAPTURE_SELECT_FIRST",e.updateViewInfo(),w.SUCCESS)):(L.expectToBe(e.movePhase,"FINAL_CAPTURE_SELECT_RING"),e.finalCaptures.push(i),0===e.possibleCaptures.length?e.tryMove():(e.movePhase="FINAL_CAPTURE_SELECT_FIRST",e.updateViewInfo(),w.SUCCESS))})()}moveToMovePhase(){return this.movePhase="MOVE_START",this.updateViewInfo(),w.SUCCESS}tryMove(){var t=this;return M(function*(){const e=new s3(t.initialCaptures,t.moveStart.get(),t.moveEnd,t.finalCaptures);return yield t.chooseMove(e)})()}selectMoveStart(t){var e=this;return M(function*(){if(e.constructedState.isInitialPlacementPhase()){const n=e.rules.initialPlacementValidity(e.constructedState,t);return n.isFailure()?e.cancelMove(n.getReason()):(e.moveStart=h.of(t),e.tryMove())}{const n=e.rules.moveStartValidity(e.constructedState,t);if(n.isFailure())return e.cancelMove(n.getReason());e.moveStart=h.of(t),e.movePhase="MOVE_END",e.updateViewInfo()}return w.SUCCESS})()}selectMoveEnd(t){var e=this;return M(function*(){if(e.moveStart.equalsValue(t))return e.cancelMoveAttempt(),w.SUCCESS;const n=xt.RINGS.get(e.getState().getCurrentPlayer());if(e.constructedState.getPieceAt(t)===n)return e.cancelMoveAttempt(),e.selectMoveStart(t);const i=e.rules.moveValidity(e.constructedState,e.moveStart.get(),t);return i.isFailure()?e.cancelMove(i.getReason()):(e.moveEnd=h.of(t),e.currentlyMoved=e.coordsBetween(e.moveStart.get(),t),e.constructedState=e.rules.applyRingMoveAndFlip(e.moveStart.get(),t,e.constructedState),e.updateViewInfo(),e.moveToFinalCapturePhaseOrTryMove())})()}moveToFinalCapturePhaseOrTryMove(){var t=this;return M(function*(){return t.possibleCaptures=t.rules.getPossibleCaptures(t.constructedState),0===t.possibleCaptures.length?t.tryMove():(t.movePhase="FINAL_CAPTURE_SELECT_FIRST",t.updateViewInfo(),w.SUCCESS)})()}static \u0275fac=function(e){return new(e||pa)(G(Ut))};static \u0275cmp=Ue({type:pa,selectors:[["app-yinsh"]],features:[$e],decls:6,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","0 250 1065 1060","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base no-fill selected-stroke","pointer-events","fill","stroke-linecap","round",3,"id","click",4,"ngFor","ngForOf"],[4,"ngIf"],["class","indicator",3,"id","click",4,"ngFor","ngForOf"],[3,"id","click",4,"ngIf"],[3,"id","click"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[3,"id","ngClass"],["class","base no-fill mid-stroke",4,"ngIf"],["class","base no-fill",3,"id","ngClass",4,"ngIf"],["class","base mid-stroke",3,"id","ngClass",4,"ngIf"],[1,"base","no-fill","mid-stroke"],[1,"base","no-fill",3,"id","ngClass"],[1,"base","mid-stroke",3,"id","ngClass"],["pointer-events","fill","stroke-linecap","round",1,"base","no-fill","selected-stroke",3,"id","click"],["class","base no-fill capturable-stroke","pointer-events","fill","stroke-linecap","round",3,"id","click",4,"ngFor","ngForOf"],["pointer-events","fill","stroke-linecap","round",1,"base","no-fill","capturable-stroke",3,"id","click"],[1,"indicator",3,"id","click"],[1,"base","no-fill","mid-stroke",3,"id"],[1,"base","no-fill",3,"ngClass"]],template:function(e,n){1&e&&(I(),E(0,"svg",0),z(1,hFe,2,1,"g",1)(2,gFe,1,3,"polygon",2)(3,mFe,2,1,"g",3)(4,_Fe,1,6,"rect",4)(5,yFe,2,3,"g",1),P()),2&e&&(m(),v("ngForOf",n.viewInfo.spaceInfo),m(),v("ngForOf",n.viewInfo.selectedCoords),m(),v("ngIf",n.isPlayerTurn()),m(),v("ngForOf",n.viewInfo.targets),m(),v("ngForOf",n.Player.PLAYERS))},dependencies:[zt,Nt,bt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}const D=xt.EMPTY,fe=xt.UNREACHABLE,Qi=xt.MARKER_ZERO,X2=xt.RING_ZERO,c3=xt.MARKER_ONE,xi=xt.RING_ONE;let mee=(()=>class r{static MUST_ALIGN_FIVE=()=>$localize`Failed! You need to align 5 markers of your color in order to get them, and to get a ring at the same time.`;static MUST_CAPTURE_TWO=()=>$localize`Failed! You can capture two rings in total, by capturing two times 5 of your markers. Try again.`})();class MFe extends Wn{tutorial=[W.informational($localize`Goal of the game`,$localize`The goal at Yinsh is to capture three rings in total.
        The rings taken are shown on the top left for the dark player,
        and on the bottom right for the light player. Here, Dark won the game.
        Note that on the board you have two types of pieces for each player:
        rings (empty circles) and markers (full circles).`,new Xa([[fe,fe,fe,fe,fe,fe,D,D,D,D,fe],[fe,fe,fe,fe,D,D,D,D,D,D,D],[fe,fe,fe,Qi,xi,D,D,D,D,D,D],[fe,fe,D,Qi,D,xi,D,c3,D,D,D],[fe,D,X2,c3,D,D,xi,Qi,D,D,D],[fe,D,D,Qi,c3,D,D,D,D,D,fe],[D,D,D,Qi,D,D,D,xi,D,D,fe],[D,D,D,c3,Qi,X2,D,D,D,fe,fe],[D,D,D,D,D,D,D,D,fe,fe,fe],[D,D,D,D,D,D,D,fe,fe,fe,fe],[fe,D,D,D,D,fe,fe,fe,fe,fe,fe]],we.of(3,1),20)),W.anyMove($localize`Initial board and placement phase`,$localize`The initial board is empty.
        At the beginning of the game, each player puts one of its ring on the board at their turn.
        This phase stops when all rings have been placed on the board.<br/><br/>
        You're playing Dark, put one of your ring on the board by clicking the space where you want to place it.`,new Xa(a3.get().getInitialState().board,we.of(5,5),0),new s3([],new _(5,5),h.empty(),[]),pe.CONGRATULATIONS()),W.anyMove($localize`Putting a marker`,$localize`Once the initial phase is done and all rings are on the board, you need to place markers on the board.
        To do so, put a marker in a ring by clicking on that ring.
        Then, the ring must be moved in a straight line, in any direction.
        A ring cannot pass through other rings during its move.
        If it goes over a group of markers, your move must stop at the first empty space after that group.
        All markers in the group are then flipped and their color change.<br/><br/>
        You're playing Dark, do a move.`,new Xa([[fe,fe,fe,fe,fe,fe,D,D,D,D,fe],[fe,fe,fe,fe,D,D,D,D,D,D,D],[fe,fe,fe,xi,D,D,D,D,D,D,D],[fe,fe,xi,D,D,xi,D,D,D,D,D],[fe,D,X2,c3,D,D,xi,D,D,D,D],[fe,D,D,c3,D,D,D,D,D,D,fe],[D,D,D,D,X2,D,D,xi,D,D,fe],[D,D,D,D,D,X2,D,D,D,fe,fe],[D,D,D,X2,D,D,D,fe,fe,fe,fe],[D,D,D,D,D,D,D,fe,fe,fe,fe],[fe,D,D,D,D,fe,fe,fe,fe,fe,fe]],we.of(0,0),20),new s3([],new _(2,4),h.of(new _(4,4)),[]),pe.CONGRATULATIONS()),W.fromPredicate($localize`Getting a ring by aligning 5 markers`,$localize`Finally, the last mechanic you need is to be able to get a ring from the board in order to gain points.
        To do so, you need to align 5 markers of your color.
        You can then get these markers by clicking on them, and then get one of your ring by clicking on it.
        You will then have one more point.
        You must capture when you can.<br/><br/>
        You're playing Dark, perform a capture!`,new Xa([[fe,fe,fe,fe,fe,fe,D,D,D,D,fe],[fe,fe,fe,fe,D,D,D,D,D,D,D],[fe,fe,fe,xi,D,D,D,D,D,D,D],[fe,fe,xi,D,D,xi,D,D,D,D,D],[fe,D,Qi,Qi,X2,c3,c3,D,D,D,D],[fe,D,D,xi,D,D,D,D,D,D,fe],[D,D,D,D,X2,D,D,xi,D,D,fe],[D,D,D,D,D,X2,D,D,D,fe,fe],[D,D,D,X2,D,D,D,X2,fe,fe,fe],[D,D,D,D,D,D,D,fe,fe,fe,fe],[fe,D,D,D,D,fe,fe,fe,fe,fe,fe]],we.of(0,0),20),new s3([],new _(4,4),h.of(new _(7,4)),[Qa.of(new _(2,4),new _(6,4),h.of(new _(7,4)))]),(t,e,n)=>1===n.sideRings.get(O.ZERO)?w.SUCCESS:w.failure(mee.MUST_ALIGN_FIVE()),pe.CONGRATULATIONS()),W.fromPredicate($localize`Compound captures`,$localize`During a turn, you could have to choose between multiple captures,
        or you could even capture multiple times!
        During the capture selection, if you see that the marker you clicked belongs to two captures, you have to click on a second marker to avoid any ambiguity.<br/><br/>
        Here, playing Dark, you can capture two rings, do it!`,new Xa([[fe,fe,fe,fe,fe,fe,D,D,D,D,fe],[fe,fe,fe,fe,X2,D,D,xi,xi,X2,D],[fe,fe,fe,X2,D,D,c3,xi,D,X2,D],[fe,fe,D,X2,D,D,D,D,D,xi,D],[fe,D,D,D,D,Qi,D,D,xi,D,D],[fe,D,D,D,Qi,Qi,D,c3,D,D,fe],[D,D,D,Qi,D,Qi,D,D,D,D,fe],[D,D,Qi,D,D,Qi,D,D,D,fe,fe],[D,Qi,D,D,D,Qi,D,D,fe,fe,fe],[D,D,D,D,D,Qi,D,fe,fe,fe,fe],[fe,D,D,D,D,fe,fe,fe,fe,fe,fe]],we.of(0,0),10),new s3([Qa.of(new _(5,4),new _(1,8),h.of(new _(3,2))),Qa.of(new _(5,9),new _(5,5),h.of(new _(3,3)))],new _(4,1),h.of(new _(4,2)),[]),(t,e,n)=>2===n.sideRings.get(O.ZERO)?w.SUCCESS:w.failure(mee.MUST_CAPTURE_TWO()),pe.CONGRATULATIONS())]}function EFe(r,t){if(1&r&&(E(0,"option",5),ot(1),P()),2&r){const e=t.$implicit;v("value",e.urlName),m(),Cn(e.name)}}let Nn=(()=>class r{static ABALONE=()=>$localize`Use simple mechanics to push 6 of the opponent's pieces out of the board!`;static APAGOS=()=>$localize`Very simple game, but, will you be able to win everytime?`;static AWALE=()=>$localize`The most widespread of the Mancalas.`;static BA_AWA=()=>$localize`The most widespread multiple-lap Mancala.`;static BRANDHUB=()=>$localize`The Irish version of the Tafl game family! Invaders must capture the king, defender must make him escape!`;static COERCEO=()=>$localize`Get rid of all of your opponent's pieces on a board that shrinks little by little!`;static CONNECT_SIX=()=>$localize`Put two pieces on the board at each turn, and be the first to align six pieces!`;static CONSPIRATEURS=()=>$localize`Hide all of your pieces before your opponent does, or risk to be discovered!`;static DIABALLIK=()=>$localize`Pass the ball up to the side of the opponent to win the game!`;static DIAM=()=>$localize`Drop your pieces and move them around to align two pieces of the same color across the board to win!`;static DVONN=()=>$localize`Stack your pieces and control as many stacks as you can to win!`;static ENCAPSULE=()=>$localize`An enhanced tic-tac-toe where piece can encapsule other and prevent them to win.`;static EPAMINONDAS=()=>$localize`An antiquity-war inspired game. Be the first to pierce your opponent's lines!`;static GIPF=()=>$localize`A hexagonal game of alignment. Insert your pieces on the board to capture your opponent's pieces!`;static GO=()=>$localize`The oldest strategy game still practiced widely. A territory control game.`;static HIVE=()=>$localize`You are in charge of a hive full of insects. Use the abilities of your insects to block the opponent's queen in order to win!`;static HNEFATAFL=()=>$localize`The Viking board game! Invaders must capture the king, defender must make him escape!`;static KALAH=()=>$localize`A modern version of the famous African strategy game!`;static KAMISADO=()=>$localize`Your goal is simple: reach the last line. But the piece you move depends on your opponent's last move!`;static LASCA=()=>$localize`Similar to checkers, capture opponent's pieces, free your own, and immobilize your opponent to win the game!`;static LINES_OF_ACTION=()=>$localize`Regroup your pieces to win. But your possible moves will often change!`;static LODESTONE=()=>$localize`Push and crush your opponent's pieces using magnetic forces!`;static MARTIAN_CHESS=()=>$localize`Win points by capturing pieces, but you only control pieces on your side of the board!`;static P4=()=>$localize`The classical 4 in a row game!`;static PENTAGO=()=>$localize`Drop a piece, then rotate a quadrant. The first player to align 5 pieces wins!`;static PENTE=()=>$localize`You can align 5 pieces to win, or you can capture 10 pieces of your opponent to win!`;static PYLOS=()=>$localize`Overlay your pieces and use two game mechanics to conserve your pieces. First player to run out of pieces loses!`;static QUARTO=()=>$localize`Create a winning alignment. The problem: you don't pick the piece that you're placing on the board!`;static QUIXO=()=>$localize`Align 5 of your pieces on a board where pieces slide!`;static REVERSI=()=>$localize`Sandwich your opponent's pieces to dominate the board!`;static SAHARA=()=>$localize`Immobilize one of your opponent's pyramids before your opponent does!`;static SIAM=()=>$localize`Be the first to push a mountain out of the board!`;static SIX=()=>$localize`Put your hexagonal pieces next to another one, and create one of the 3 victorious shapes to win!`;static TABLUT=()=>$localize`Lapland version of the Tafl game family! Invaders must capture the king, defender must make him escape!`;static TEEKO=()=>$localize`Align your 4 pieces or form a square with them to win!`;static TREXO=()=>$localize`Align 5 pieces of your color in a row, but beware, the pieces can be put on top of other pieces!`;static YINSH=()=>$localize`Align your pieces to score points, but beware, pieces can flip!`})();class Ht{name;urlName;component;tutorial;rules;creationDate;description;display;static ALL_GAMES(){return[new Ht($localize`Four in a Row`,"P4",Hze,new Fze,Yc.get(),new Date("2018-08-28"),Nn.P4()),new Ht($localize`Awal`,"Awale",xIe,new LIe,Ys.get(),new Date("2018-11-29"),Nn.AWALE()),new Ht($localize`Quarto`,"Quarto",BDe,new QDe,Ri.get(),new Date("2018-12-09"),Nn.QUARTO()),new Ht($localize`Tablut`,"Tablut",wHe,new bHe,o3.get(),new Date("2018-12-27"),Nn.TABLUT()),new Ht($localize`Reversi`,"Reversi",pVe,new _Ve,C0.get(),new Date("2019-01-16"),Nn.REVERSI()),new Ht($localize`Go`,"Go",xC,new Cxe,$a.get(),new Date("2019-12-21"),Nn.GO()),new Ht($localize`Encapsule`,"Encapsule",HRe,new $Re,hu.get(),new Date("2019-12-30"),Nn.ENCAPSULE()),new Ht($localize`Siam`,"Siam",av,new JVe,Z2.get(),new Date("2020-01-11"),Nn.SIAM()),new Ht($localize`Sahara`,"Sahara",kVe,new RVe,h4.get(),new Date("2020-02-29"),Nn.SAHARA()),new Ht($localize`Pylos`,"Pylos",CDe,new vDe,Yi.get(),new Date("2020-10-02"),Nn.PYLOS()),new Ht($localize`Kamisado`,"Kamisado",OLe,new TLe,E2.get(),new Date("2020-10-03"),Nn.KAMISADO()),new Ht($localize`Quixo`,"Quixo",oVe,new aVe,Ki.get(),new Date("2020-10-15"),Nn.QUIXO()),new Ht($localize`Dvonn`,"Dvonn",IRe,new CRe,Kr.get(),new Date("2020-10-21"),Nn.DVONN()),new Ht($localize`Epaminondas`,"Epaminondas",txe,new nxe,Ai.get(),new Date("2021-01-16"),Nn.EPAMINONDAS()),new Ht($localize`Gipf`,"Gipf",dxe,new Nxe,rn.get(),new Date("2021-02-22"),Nn.GIPF()),new Ht($localize`Coerceo`,"Coerceo",zke,new Vke,Od.get(),new Date("2021-03-21"),Nn.COERCEO()),new Ht($localize`Six`,"Six",gHe,new pHe,i3.get(),new Date("2021-04-08"),Nn.SIX()),new Ht($localize`Lines of Action`,"LinesOfAction",BLe,new $Le,ki.get(),new Date("2021-04-28"),Nn.LINES_OF_ACTION()),new Ht($localize`Pentago`,"Pentago",Kze,new Xze,bl.get(),new Date("2021-05-23"),Nn.PENTAGO()),new Ht($localize`Abalone`,"Abalone",pIe,new zIe,js.get(),new Date("2021-07-13"),Nn.ABALONE()),new Ht($localize`Yinsh`,"Yinsh",pa,new MFe,a3.get(),new Date("2021-07-31"),Nn.YINSH()),new Ht($localize`Apagos`,"Apagos",SIe,new rIe,Va.get(),new Date("2021-11-04"),Nn.APAGOS()),new Ht($localize`Diam`,"Diam",u0,new _ke,n4.get(),new Date("2021-11-30"),Nn.DIAM()),new Ht($localize`Brandhub`,"Brandhub",ske,new ake,Uc.get(),new Date("2021-12-07"),Nn.BRANDHUB()),new Ht($localize`Conspirateurs`,"Conspirateurs",Kke,new pke,Ho.get(),new Date("2021-12-30"),Nn.CONSPIRATEURS()),new Ht($localize`Lodestone`,"Lodestone",aa,new WLe,fi.get(),new Date("2022-06-24"),Nn.LODESTONE()),new Ht($localize`Martian Chess`,"MartianChess",yo,new aze,Ss.get(),new Date("2022-07-01"),Nn.MARTIAN_CHESS()),new Ht($localize`Hnefatafl`,"Hnefatafl",fLe,new Jxe,jc.get(),new Date("2022-09-21"),Nn.HNEFATAFL()),new Ht($localize`Hive`,"Hive",NJ,new Qxe,Zi.get(),new Date("2023-04-02"),Nn.HIVE()),new Ht($localize`Trexo`,"Trexo",l1,new iFe,K2.get(),new Date("2023-04-23"),Nn.TREXO()),new Ht($localize`Lasca`,"Lasca",xLe,new DLe,Ps.get(),new Date("2023-05-11"),Nn.LASCA()),new Ht($localize`Connect Six`,"ConnectSix",nJ,new gke,ho.get(),new Date("2023-05-13"),Nn.CONNECT_SIX()),new Ht($localize`Pente`,"Pente",$J,new nDe,Os.get(),new Date("2023-05-20"),Nn.PENTE()),new Ht($localize`Teeko`,"Teeko",RHe,new xHe,ga.get(),new Date("2023-07-30"),Nn.TEEKO()),new Ht($localize`Kalah`,"Kalah",pLe,new mLe,Uo.get(),new Date("2023-09-07"),Nn.KALAH()),new Ht($localize`Diaballik`,"Diaballik",aRe,new cRe,vs.get(),new Date("2023-11-18"),Nn.DIABALLIK()),new Ht($localize`Ba-awa`,"BaAwa",FIe,new UIe,Fa.get(),new Date("2024-01-28"),Nn.BA_AWA())].sort((t,e)=>t.name.localeCompare(e.name))}static getByUrlName(t){const e=Ht.ALL_GAMES().filter(n=>n.urlName===t);return L.assert(e.length<=1,"There should only be one game matching $urlName!"),0===e.length?h.empty():h.of(e[0])}constructor(t,e,n,i,o,s,a,c=!0){this.name=t,this.urlName=e,this.component=n,this.tutorial=i,this.rules=o,this.creationDate=s,this.description=a,this.display=c}getRulesConfigDescription(){return this.rules.getRulesConfigDescription()}getRulesConfig(){const t=this.getRulesConfigDescription();return t.isPresent()?h.of(t.get().getDefaultConfig().config):h.empty()}}let ik=(()=>{class r{games=Ht.ALL_GAMES();pickGame=new i1;onChange(e){this.pickGame.emit(e.target.value)}static \u0275fac=function(n){return new(n||r)};static \u0275cmp=Ue({type:r,selectors:[["app-pick-game"]],outputs:{pickGame:"pickGame"},decls:5,vars:1,consts:()=>{let e;return e=$localize`Pick a game`,[[1,"select","is-primary","is-fullwidth"],["id","gameType",3,"change"],["value","","selected",""],e,[3,"value",4,"ngFor","ngForOf"],[3,"value"]]},template:function(n,i){1&n&&(E(0,"div",0)(1,"select",1),q("change",function(s){return i.onChange(s)}),E(2,"option",2),se(3,3),P(),z(4,EFe,2,2,"option",4),P()()),2&n&&(m(4),v("ngForOf",i.games))},dependencies:[Nt,N8,I8],encapsulation:2})}return r})();class ok{static getGameDefaultConfig(t){const e=Ht.getByUrlName(t);return e.isPresent()?e.get().getRulesConfig():h.empty()}}let sk=class Dv extends r0{constructor(){super("config-room")}static \u0275fac=function(e){return new(e||Dv)};static \u0275prov=xe({token:Dv,factory:Dv.\u0275fac,providedIn:"root"})};var ak;sk=function(r,t,e,n){var s,i=arguments.length,o=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,e):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,t,e,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(t,e,o):s(t,e))||o);return i>3&&o&&Object.defineProperty(t,e,o),o}([Ae.log],sk);let Fd=class Vv{static#e=ak=this;configRoomDAO;connectedUserService;static GAME_DOES_NOT_EXIST=()=>$localize`Game does not exist`;constructor(t,e){this.configRoomDAO=t,this.connectedUserService=e}addCandidate(t,e){return this.configRoomDAO.subCollectionDAO(t,"candidates").set(e.id,e)}removeCandidate(t,e){return this.configRoomDAO.subCollectionDAO(t,"candidates").delete(e.id)}subscribeToChanges(t,e){return this.configRoomDAO.subscribeToChanges(t,e)}subscribeToCandidates(t,e){let n=[];const i=new EC(s=>{for(const a of s)n.push(a.data);e(n)},s=>{for(const a of s)n=n.map(c=>c.id===a.data.id?a.data:c);e(n)},s=>{for(const a of s)n=n.filter(c=>c.id!==a.data.id);e(n)});return this.configRoomDAO.subCollectionDAO(t,"candidates").observingWhere([],i)}createInitialConfigRoom(t,e){var n=this;return M(function*(){const i=n.connectedUserService.user.get().toMinimalUser(),o={chosenOpponent:null,firstPlayer:f2.RANDOM.value,partType:Ui.STANDARD.value,partStatus:d2.PART_CREATED.value,maximalMoveDuration:Ui.NORMAL_MOVE_DURATION,totalPartDuration:Ui.NORMAL_PART_DURATION,creator:i,rulesConfig:ok.getGameDefaultConfig(e).getOrElse({})};return n.configRoomDAO.set(t,o)})()}joinGame(t){var e=this;return M(function*(){const n=e.connectedUserService.user.get().toMinimalUser(),i=yield e.configRoomDAO.read(t);return i.isAbsent()?w.failure(ak.GAME_DOES_NOT_EXIST()):(i.get().creator.id!==n.id&&(yield e.addCandidate(t,n)),w.SUCCESS)})()}cancelJoining(t){var e=this;return M(function*(){const n=e.connectedUserService.user.get().toMinimalUser(),i=yield e.configRoomDAO.read(t);if(!i.isAbsent()){const o=i.get(),s=[e.removeCandidate(t,n)];o.chosenOpponent?.id===n.id&&s.push(e.configRoomDAO.update(t,{chosenOpponent:null,partStatus:d2.PART_CREATED.value})),yield Promise.all(s)}})()}deleteConfigRoom(t,e){var n=this;return M(function*(){yield Promise.all(e.map(i=>n.removeCandidate(t,i))),yield n.configRoomDAO.delete(t)})()}proposeConfig(t,e,n,i,o,s,a){var c=this;return M(function*(){return c.configRoomDAO.update(t,{partStatus:d2.CONFIG_PROPOSED.value,chosenOpponent:e,partType:n.value,maximalMoveDuration:i,totalPartDuration:s,firstPlayer:o.value,rulesConfig:a.getOrElse({})})})()}setChosenOpponent(t,e){return this.configRoomDAO.update(t,{chosenOpponent:e})}reviewConfig(t){var e=this;return M(function*(){return e.configRoomDAO.update(t,{partStatus:d2.PART_CREATED.value})})()}reviewConfigAndRemoveChosenOpponent(t){var e=this;return M(function*(){return e.configRoomDAO.update(t,{partStatus:d2.PART_CREATED.value,chosenOpponent:null})})()}acceptConfig(t){return this.configRoomDAO.update(t,{partStatus:d2.PART_STARTED.value})}createConfigRoom(t,e){var n=this;return M(function*(){return n.configRoomDAO.set(t,e)})()}readConfigRoomById(t){var e=this;return M(function*(){return(yield e.configRoomDAO.read(t)).get()})()}static \u0275fac=function(e){return new(e||Vv)(ze(sk),ze(gr))};static \u0275prov=xe({token:Vv,factory:Vv.\u0275fac,providedIn:"root"})};Fd=ak=function(r,t,e,n){var s,i=arguments.length,o=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,e):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,t,e,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(t,e,o):s(t,e))||o);return i>3&&o&&Object.defineProperty(t,e,o),o}([Ae.log],Fd);let bu=class Hv{partDAO;gameEventService;connectedUserService;configRoomService;chatService;constructor(t,e,n,i,o){this.partDAO=t,this.gameEventService=e,this.connectedUserService=n,this.configRoomService=i,this.chatService=o}update(t,e){var n=this;return M(function*(){return n.partDAO.update(t,e)})()}getPartValidity(t,e){var n=this;return M(function*(){const i=yield n.partDAO.read(t);return i.isAbsent()?w.failure("NONEXISTENT_PART"):i.get().typeGame===e?w.SUCCESS:w.failure("WRONG_GAME_TYPE")})()}getUser(){return this.connectedUserService.user.get().toMinimalUser()}createUnstartedPart(t){const e=this.getUser();return this.partDAO.create({typeGame:t,playerZero:e,turn:-1,result:tr.UNACHIEVED.value})}createChat(t){return this.chatService.createNewChat(t)}createPartConfigRoomAndChat(t){var e=this;return M(function*(){const n=yield e.createUnstartedPart(t);return yield e.configRoomService.createInitialConfigRoom(n,t),yield e.createChat(n),n})()}getStartingConfig(t){let n,i,e=f2.of(t.firstPlayer);return e===f2.RANDOM&&(e=Math.random()<.5?f2.CREATOR:f2.CHOSEN_PLAYER),e===f2.CREATOR?(n=t.creator,i=L.getNonNullable(t.chosenOpponent)):(n=L.getNonNullable(t.chosenOpponent),i=t.creator),{playerZero:n,playerOne:i,turn:0,beginning:Dc()}}deletePart(t){return this.partDAO.delete(t)}acceptConfig(t,e){var n=this;return M(function*(){yield n.configRoomService.acceptConfig(t);const i=n.getStartingConfig(e);yield n.partDAO.update(t,i),yield n.gameEventService.startGame(t,n.getUser())})()}getPart(t){return this.partDAO.read(t)}subscribeToChanges(t,e){return this.partDAO.subscribeToChanges(t,e)}resign(t,e,n){var i=this;return M(function*(){const o={winner:e,loser:n,result:tr.RESIGN.value};yield i.partDAO.update(t,o),yield i.gameEventService.addAction(t,i.getUser(),"EndGame")})()}notifyTimeout(t,e,n){var i=this;return M(function*(){const o={winner:e,loser:n,result:tr.TIMEOUT.value};yield i.partDAO.update(t,o),yield i.gameEventService.addAction(t,i.getUser(),"EndGame")})()}proposeDraw(t){var e=this;return M(function*(){yield e.gameEventService.addRequest(t,e.getUser(),"Draw")})()}acceptDraw(t,e){var n=this;return M(function*(){yield n.gameEventService.addReply(t,n.getUser(),"Accept","Draw");const o={result:(e===O.ZERO?tr.AGREED_DRAW_BY_ZERO:tr.AGREED_DRAW_BY_ONE).value};yield n.partDAO.update(t,o),yield n.gameEventService.addAction(t,n.getUser(),"EndGame")})()}refuseDraw(t){var e=this;return M(function*(){yield e.gameEventService.addReply(t,e.getUser(),"Reject","Draw")})()}proposeRematch(t){var e=this;return M(function*(){yield e.gameEventService.addRequest(t,e.getUser(),"Rematch")})()}rejectRematch(t){var e=this;return M(function*(){yield e.gameEventService.addReply(t,e.getUser(),"Reject","Rematch")})()}acceptRematch(t){var e=this;return M(function*(){const n=L.getNonNullable(t.data),i=yield e.configRoomService.readConfigRoomById(t.id);let o;const s=e.getUser();let a;n.playerZero.id===s.id?(a=L.getNonNullable(n.playerOne),o=f2.CHOSEN_PLAYER):(a=n.playerZero,o=f2.CREATOR);const c={...i,firstPlayer:o.value,creator:s,chosenOpponent:a,partStatus:d2.PART_STARTED.value},l=e.getStartingConfig(c),u={typeGame:n.typeGame,result:tr.UNACHIEVED.value,...l},f=yield e.partDAO.create(u);yield e.configRoomService.createConfigRoom(f,c),yield e.createChat(f),yield e.gameEventService.addReply(t.id,e.getUser(),"Accept","Rematch",f),yield e.gameEventService.startGame(f,e.getUser())})()}askTakeBack(t){var e=this;return M(function*(){yield e.gameEventService.addRequest(t,e.getUser(),"TakeBack")})()}acceptTakeBack(t,e,n){var i=this;return M(function*(){let o=e-1;O.ofTurn(o).equals(n)&&o--;const s={turn:o};return yield i.gameEventService.addReply(t,i.getUser(),"Accept","TakeBack"),yield i.partDAO.update(t,s)})()}refuseTakeBack(t){var e=this;return M(function*(){yield e.gameEventService.addReply(t,e.getUser(),"Reject","TakeBack")})()}addGlobalTime(t){var e=this;return M(function*(){yield e.gameEventService.addAction(t,e.getUser(),"AddGlobalTime")})()}addTurnTime(t){var e=this;return M(function*(){yield e.gameEventService.addAction(t,e.getUser(),"AddTurnTime")})()}preparePartUpdate(t,e){var n=this;return M(function*(){let s={turn:(yield n.partDAO.read(t)).get().turn+1};return s=n.updateScore(s,e),s})()}updatePartUponMove(t,e){var n=this;return M(function*(){const i=yield n.preparePartUpdate(t,e);yield n.update(t,i)})()}drawPart(t,e){var n=this;return M(function*(){let i=yield n.preparePartUpdate(t,e);i={...i,result:tr.HARD_DRAW.value},yield n.update(t,i),yield n.gameEventService.addAction(t,n.getUser(),"EndGame")})()}endPartWithVictory(t,e,n,i){var o=this;return M(function*(){let s=yield o.preparePartUpdate(t,i);s={...s,winner:e,loser:n,result:tr.VICTORY.value},yield o.update(t,s),yield o.gameEventService.addAction(t,o.getUser(),"EndGame")})()}updateScore(t,e){return e.isPresent()?{...t,scorePlayerZero:e.get().get(O.ZERO),scorePlayerOne:e.get().get(O.ONE)}:t}static \u0275fac=function(e){return new(e||Hv)(ze(_d),ze(_I),ze(gr),ze(Fd),ze(J5))};static \u0275prov=xe({token:Hv,factory:Hv.\u0275fac,providedIn:"root"})};bu=function(r,t,e,n){var s,i=arguments.length,o=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,e):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,t,e,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(t,e,o):s(t,e))||o);return i>3&&o&&Object.defineProperty(t,e,o),o}([Ae.log],bu);class Ud{static getNavigatorLanguage(){return navigator.language}static getLocale(){const n=(localStorage.getItem("locale")??Ud.getNavigatorLanguage()??"fr").slice(0,2).toLowerCase();return["en","fr"].some(i=>i===n)?n:"fr"}}let _ee=(()=>{class r{changeTheme(e){localStorage.setItem("theme",e)}getTheme(){return h.ofNullable(localStorage.getItem("theme"))}changeLanguage(e){localStorage.setItem("locale",e.toLowerCase())}getLanguage(){return Ud.getLocale()}static \u0275fac=function(n){return new(n||r)};static \u0275prov=xe({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})(),fv=(()=>{class r{document;userSettingsService;theme;availableThemes=["dark","light"];constructor(e,n){this.document=e,this.userSettingsService=n;const i=this.getStoredTheme();i.isPresent()?this.loadTheme(i.get()):window.matchMedia("(prefers-color-scheme: dark)").matches?this.loadTheme("dark"):window.matchMedia("(prefers-color-scheme: light)").matches?this.loadTheme("light"):this.loadTheme("dark")}getStoredTheme(){const e=this.userSettingsService.getTheme();if(e.isPresent()){const n=e.get();if(this.availableThemes.some(i=>i===n))return h.of(n)}return h.empty()}loadTheme(e){this.loadStyle(e+".css"),this.theme=e}loadStyle(e){const n=this.document.getElementsByTagName("head")[0],i=this.document.getElementById("theme");if(null!=i)i.href=e;else{const o=this.document.createElement("link");o.id="theme",o.rel="stylesheet",o.href=`${e}`,n.appendChild(o)}}getTheme(){return this.theme}static \u0275fac=function(n){return new(n||r)(ze(R2),ze(_ee))};static \u0275prov=xe({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();var Uee={prefix:"fab",iconName:"facebook",icon:[512,512,[62e3],"f09a","M512 256C512 114.6 397.4 0 256 0S0 114.6 0 256C0 376 82.7 476.8 194.2 504.5V334.2H141.4V256h52.8V222.3c0-87.1 39.4-127.5 125-127.5c16.2 0 44.2 3.2 55.7 6.4V172c-6-.6-16.5-1-29.6-1c-42 0-58.2 15.9-58.2 57.2V256h83.6l-14.4 78.2H287V510.1C413.8 494.8 512 386.9 512 256h0z"]},jee={prefix:"fab",iconName:"github",icon:[496,512,[],"f09b","M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"]},Zee={prefix:"fab",iconName:"twitter",icon:[512,512,[],"f099","M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"]},dk={prefix:"fas",iconName:"reply",icon:[512,512,[61714,"mail-reply"],"f3e5","M205 34.8c11.5 5.1 19 16.6 19 29.2v64H336c97.2 0 176 78.8 176 176c0 113.3-81.5 163.9-100.2 174.1c-2.5 1.4-5.3 1.9-8.1 1.9c-10.9 0-19.7-8.9-19.7-19.7c0-7.5 4.3-14.4 9.8-19.5c9.4-8.8 22.2-26.4 22.2-56.7c0-53-43-96-96-96H224v64c0 12.6-7.4 24.1-19 29.2s-25 3-34.4-5.4l-160-144C3.9 225.7 0 217.1 0 208s3.9-17.7 10.6-23.8l160-144c9.4-8.5 22.9-10.6 34.4-5.4z"]},tne={prefix:"fas",iconName:"flag",icon:[448,512,[127988,61725],"f024","M64 32C64 14.3 49.7 0 32 0S0 14.3 0 32V64 368 480c0 17.7 14.3 32 32 32s32-14.3 32-32V352l64.3-16.1c41.1-10.3 84.6-5.5 122.5 13.4c44.2 22.1 95.5 24.8 141.7 7.4l34.7-13c12.5-4.7 20.8-16.6 20.8-30V66.1c0-23-24.2-38-44.8-27.7l-9.6 4.8c-46.3 23.2-100.8 23.2-147.1 0c-35.1-17.6-75.4-22-113.5-12.5L64 48V32z"]},zne={prefix:"fas",iconName:"repeat",icon:[512,512,[128257],"f363","M0 224c0 17.7 14.3 32 32 32s32-14.3 32-32c0-53 43-96 96-96H320v32c0 12.9 7.8 24.6 19.8 29.6s25.7 2.2 34.9-6.9l64-64c12.5-12.5 12.5-32.8 0-45.3l-64-64c-9.2-9.2-22.9-11.9-34.9-6.9S320 19.1 320 32V64H160C71.6 64 0 135.6 0 224zm512 64c0-17.7-14.3-32-32-32s-32 14.3-32 32c0 53-43 96-96 96H192V352c0-12.9-7.8-24.6-19.8-29.6s-25.7-2.2-34.9 6.9l-64 64c-12.5 12.5-12.5 32.8 0 45.3l64 64c9.2 9.2 22.9 11.9 34.9 6.9s19.8-16.6 19.8-29.6V448H352c88.4 0 160-71.6 160-160z"]},wk={prefix:"fas",iconName:"eye",icon:[576,512,[128065],"f06e","M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM144 256a144 144 0 1 1 288 0 144 144 0 1 1 -288 0zm144-64c0 35.3-28.7 64-64 64c-7.1 0-13.9-1.2-20.3-3.3c-5.5-1.8-11.9 1.6-11.7 7.4c.3 6.9 1.3 13.8 3.2 20.7c13.7 51.2 66.4 81.6 117.6 67.9s81.6-66.4 67.9-117.6c-11.1-41.5-47.8-69.4-88.6-71.1c-5.8-.2-9.2 6.1-7.4 11.7c2.1 6.4 3.3 13.2 3.3 20.3z"]},Gie={prefix:"fas",iconName:"gear",icon:[512,512,[9881,"cog"],"f013","M495.9 166.6c3.2 8.7 .5 18.4-6.4 24.6l-43.3 39.4c1.1 8.3 1.7 16.8 1.7 25.4s-.6 17.1-1.7 25.4l43.3 39.4c6.9 6.2 9.6 15.9 6.4 24.6c-4.4 11.9-9.7 23.3-15.8 34.3l-4.7 8.1c-6.6 11-14 21.4-22.1 31.2c-5.9 7.2-15.7 9.6-24.5 6.8l-55.7-17.7c-13.4 10.3-28.2 18.9-44 25.4l-12.5 57.1c-2 9.1-9 16.3-18.2 17.8c-13.8 2.3-28 3.5-42.5 3.5s-28.7-1.2-42.5-3.5c-9.2-1.5-16.2-8.7-18.2-17.8l-12.5-57.1c-15.8-6.5-30.6-15.1-44-25.4L83.1 425.9c-8.8 2.8-18.6 .3-24.5-6.8c-8.1-9.8-15.5-20.2-22.1-31.2l-4.7-8.1c-6.1-11-11.4-22.4-15.8-34.3c-3.2-8.7-.5-18.4 6.4-24.6l43.3-39.4C64.6 273.1 64 264.6 64 256s.6-17.1 1.7-25.4L22.4 191.2c-6.9-6.2-9.6-15.9-6.4-24.6c4.4-11.9 9.7-23.3 15.8-34.3l4.7-8.1c6.6-11 14-21.4 22.1-31.2c5.9-7.2 15.7-9.6 24.5-6.8l55.7 17.7c13.4-10.3 28.2-18.9 44-25.4l12.5-57.1c2-9.1 9-16.3 18.2-17.8C227.3 1.2 241.5 0 256 0s28.7 1.2 42.5 3.5c9.2 1.5 16.2 8.7 18.2 17.8l12.5 57.1c15.8 6.5 30.6 15.1 44 25.4l55.7-17.7c8.8-2.8 18.6-.3 24.5 6.8c8.1 9.8 15.5 20.2 22.1 31.2l4.7 8.1c6.1 11 11.4 22.4 15.8 34.3zM256 336a80 80 0 1 0 0-160 80 80 0 1 0 0 160z"]},Lk={prefix:"fas",iconName:"backward-step",icon:[320,512,["step-backward"],"f048","M267.5 440.6c9.5 7.9 22.8 9.7 34.1 4.4s18.4-16.6 18.4-29V96c0-12.4-7.2-23.7-18.4-29s-24.5-3.6-34.1 4.4l-192 160L64 241V96c0-17.7-14.3-32-32-32S0 78.3 0 96V416c0 17.7 14.3 32 32 32s32-14.3 32-32V271l11.5 9.6 192 160z"]},Qie={prefix:"fas",iconName:"network-wired",icon:[640,512,[],"f6ff","M256 64H384v64H256V64zM240 0c-26.5 0-48 21.5-48 48v96c0 26.5 21.5 48 48 48h48v32H32c-17.7 0-32 14.3-32 32s14.3 32 32 32h96v32H80c-26.5 0-48 21.5-48 48v96c0 26.5 21.5 48 48 48H240c26.5 0 48-21.5 48-48V368c0-26.5-21.5-48-48-48H192V288H448v32H400c-26.5 0-48 21.5-48 48v96c0 26.5 21.5 48 48 48H560c26.5 0 48-21.5 48-48V368c0-26.5-21.5-48-48-48H512V288h96c17.7 0 32-14.3 32-32s-14.3-32-32-32H352V192h48c26.5 0 48-21.5 48-48V48c0-26.5-21.5-48-48-48H240zM96 448V384H224v64H96zm320-64H544v64H416V384z"]},Coe={prefix:"fas",iconName:"spinner",icon:[512,512,[],"f110","M304 48a48 48 0 1 0 -96 0 48 48 0 1 0 96 0zm0 416a48 48 0 1 0 -96 0 48 48 0 1 0 96 0zM48 304a48 48 0 1 0 0-96 48 48 0 1 0 0 96zm464-48a48 48 0 1 0 -96 0 48 48 0 1 0 96 0zM142.9 437A48 48 0 1 0 75 369.1 48 48 0 1 0 142.9 437zm0-294.2A48 48 0 1 0 75 75a48 48 0 1 0 67.9 67.9zM369.1 437A48 48 0 1 0 437 369.1 48 48 0 1 0 369.1 437z"]},Xk={prefix:"fas",iconName:"desktop",icon:[576,512,[128421,61704,"desktop-alt"],"f390","M64 0C28.7 0 0 28.7 0 64V352c0 35.3 28.7 64 64 64H240l-10.7 32H160c-17.7 0-32 14.3-32 32s14.3 32 32 32H416c17.7 0 32-14.3 32-32s-14.3-32-32-32H346.7L336 416H512c35.3 0 64-28.7 64-64V64c0-35.3-28.7-64-64-64H64zM512 64V288H64V64H512z"]},ese={prefix:"fas",iconName:"book-open",icon:[576,512,[128214,128366],"f518","M249.6 471.5c10.8 3.8 22.4-4.1 22.4-15.5V78.6c0-4.2-1.6-8.4-5-11C247.4 52 202.4 32 144 32C93.5 32 46.3 45.3 18.1 56.1C6.8 60.5 0 71.7 0 83.8V454.1c0 11.9 12.8 20.2 24.1 16.5C55.6 460.1 105.5 448 144 448c33.9 0 79 14 105.6 23.5zm76.8 0C353 462 398.1 448 432 448c38.5 0 88.4 12.1 119.9 22.6c11.3 3.8 24.1-4.6 24.1-16.5V83.8c0-12.1-6.8-23.3-18.1-27.6C529.7 45.3 482.5 32 432 32c-58.4 0-103.4 20-123 35.6c-3.3 2.6-5 6.8-5 11V456c0 11.4 11.7 19.3 22.4 15.5z"]};class qo{userDAO;userService;connectedUserService;static roleToMessage=new gn([{key:"Candidate",value:md.YOU_ARE_ALREADY_CANDIDATE},{key:"ChosenOpponent",value:md.YOU_ARE_ALREADY_CHOSEN_OPPONENT},{key:"Creator",value:md.YOU_ARE_ALREADY_CREATING},{key:"Player",value:md.YOU_ARE_ALREADY_PLAYING},{key:"Observer",value:md.YOU_ARE_ALREADY_OBSERVING}]);authSubscription;userSubscription=new cn;currentGame=h.empty();currentGameRS;currentGameObs;constructor(t,e,n){var i=this;this.userDAO=t,this.userService=e,this.connectedUserService=n,this.currentGameRS=new DQ(1),this.currentGameObs=this.currentGameRS.asObservable(),this.authSubscription=this.connectedUserService.subscribeToUser(function(){var o=M(function*(s){yield i.onUserUpdate(s)});return function(s){return o.apply(this,arguments)}}())}onUserUpdate(t){var e=this;return M(function*(){if(t===o0.NOT_CONNECTED)e.userSubscription.unsubscribe(),e.currentGame=h.empty(),e.currentGameRS.next(h.empty());else{e.userSubscription=e.userService.observeUserOnServer(t.id,i=>{pn(i.isPresent(),"Observing part service expected user to already have a document!");const o=i.get();e.onCurrentGameUpdate(o.currentGame)});const n=yield e.userDAO.read(t.id);e.currentGame=h.ofNullable(n.get().currentGame),e.currentGameRS.next(e.currentGame)}})()}onCurrentGameUpdate(t){const e=this.currentGame,n=null==t&&e.isAbsent(),i=null!=t&&e.equalsValue(t);!1===n&&!1===i&&(this.currentGame=h.ofNullable(t),this.currentGameRS.next(this.currentGame))}updateCurrentGame(t){if(pn(this.connectedUserService.user.isPresent(),"Should not call updateCurrentGame when not connected"),this.currentGame.isPresent()){const n={...this.currentGame.get(),...t};return this.userDAO.update(this.connectedUserService.user.get().id,{currentGame:n})}{const n=Object.keys({id:"id",role:"Candidate",typeGame:"P4"});for(const i of n)pn(null!=t[i],"field "+i+" should be set before updating currentGame");return this.userDAO.update(this.connectedUserService.user.get().id,{currentGame:t})}}removeCurrentGame(){return pn(this.connectedUserService.user.isPresent(),"Should not call removeCurrentGame when not connected"),this.userDAO.update(this.connectedUserService.user.get().id,{currentGame:null})}subscribeToCurrentGame(t){return this.currentGameObs.subscribe(t)}canUserCreate(){if(this.currentGame.isAbsent())return w.SUCCESS;{const t=qo.roleToMessage.get(this.currentGame.get().role).get()();return w.failure(t)}}canUserJoin(t,e){if(this.currentGame.isAbsent()||this.currentGame.get().id===t)return w.SUCCESS;if(e&&"Observer"===this.currentGame.get().role)return w.SUCCESS;{const n=qo.roleToMessage.get(this.currentGame.get().role).get()();return w.failure(n)}}getCurrentGame(){return new Promise(t=>{let e=new cn;e=this.currentGameObs.subscribe(n=>{t(n),e.unsubscribe()})})}ngOnDestroy(){this.userSubscription.unsubscribe(),this.authSubscription.unsubscribe()}static \u0275fac=function(e){return new(e||qo)(ze(pd),ze(eu),ze(gr))};static \u0275prov=xe({token:qo,factory:qo.\u0275fac,providedIn:"root"})}function Udt(r,t){if(1&r&&(jt(0),se(1,31),Zt()),2&r){const e=p(2);m(),Bn(e.currentGame.get().typeGame)(null==e.currentGame.get().opponent?null:e.currentGame.get().opponent.name),Yn(1)}}function Gdt(r,t){if(1&r&&(jt(0),se(1,33),Zt()),2&r){const e=p(3);m(),Bn(e.currentGame.get().typeGame)(null==e.currentGame.get().opponent?null:e.currentGame.get().opponent.name),Yn(1)}}function Bdt(r,t){if(1&r&&(jt(0),se(1,34),Zt()),2&r){const e=p(3);m(),Bn(e.currentGame.get().typeGame),Yn(1)}}function $dt(r,t){if(1&r&&z(0,Gdt,2,2,"ng-container",27)(1,Bdt,2,1,"ng-template",null,32,In),2&r){const e=wn(2);v("ngIf",p(2).currentGame.get().opponent)("ngIfElse",e)}}function Wdt(r,t){if(1&r){const e=he();E(0,"a",29),q("click",function(){return te(e),ne(p().navigateToPart())}),z(1,Udt,2,2,"ng-container",27)(2,$dt,3,2,"ng-template",null,30,In),P()}if(2&r){const e=wn(3),n=p();m(),v("ngIf","Observer"===n.currentGame.get().role||"Candidate"===n.currentGame.get().role)("ngIfElse",e)}}function qdt(r,t){if(1&r&&(jt(0),V(1,"fa-icon",35),Zt()),2&r){const e=p();m(),v("icon",e.faSpinner)}}function jdt(r,t){if(1&r){const e=he();jt(0),E(1,"div",10)(2,"a",37),ot(3),P(),E(4,"div",13)(5,"a",38),se(6,39),P(),E(7,"a",40),q("click",function(){return te(e),ne(p(2).logout())}),se(8,41),P()()(),Zt()}if(2&r){const e=p(2);m(3),Cn(e.username.get())}}const Zdt=()=>["/register"],Ydt=()=>["/login"];function Kdt(r,t){1&r&&(E(0,"div",42)(1,"a",43)(2,"strong"),se(3,44),P()(),E(4,"a",45),se(5,46),P()()),2&r&&(m(),v("routerLink",fr(2,Zdt)),m(3),v("routerLink",fr(3,Ydt)))}function Xdt(r,t){if(1&r&&z(0,jdt,9,1,"ng-container",27)(1,Kdt,6,4,"ng-template",null,36,In),2&r){const e=wn(2);v("ngIf",p().username.isPresent())("ngIfElse",e)}}const Ase=()=>["/"],Qdt=()=>["/play"],Jdt=()=>["/lobby"],eht=()=>["/local"],tht=()=>["/tutorial"],nht=()=>["/settings"];let rht=(()=>{class r{router;connectedUserService;currentGameService;userService;loading=!0;username=h.empty();faCog=Gie;faSpinner=Coe;userSubscription;currentGameSubscription;showMenu=!1;currentGame=h.empty();constructor(e,n,i,o){this.router=e,this.connectedUserService=n,this.currentGameService=i,this.userService=o}ngOnInit(){this.userSubscription=this.connectedUserService.subscribeToUser(e=>{this.loading=!1,this.username=e.username.isPresent()?e.username:e.email}),this.currentGameSubscription=this.currentGameService.subscribeToCurrentGame(e=>{this.currentGame=e})}logout(){var e=this;return M(function*(){yield e.connectedUserService.disconnect(),yield e.router.navigate(["/"])})()}navigateToPart(){var e=this;return M(function*(){return e.router.navigate(["/play",e.currentGame.get().typeGame,e.currentGame.get().id])})()}ngOnDestroy(){this.userSubscription.unsubscribe(),this.currentGameSubscription.unsubscribe()}static \u0275fac=function(n){return new(n||r)(G(Qn),G(gr),G(qo),G(eu))};static \u0275cmp=Ue({type:r,selectors:[["app-header"]],decls:36,vars:20,consts:()=>{let e,n,i,o,s,a,c,l,u,f,g,y,S,N,R;return e=$localize`Home`,n=$localize`Play online`,i=$localize`Create a game`,o=$localize`Join a game`,s=$localize`Play offline`,a=$localize`Create a game`,c=$localize`Learn the rules`,l=$localize`Settings`,u=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: by ${"\ufffd1\ufffd"}:INTERPOLATION_1:`,f=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: against ${"\ufffd1\ufffd"}:INTERPOLATION_1:`,g=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: (waiting for opponent)`,y=$localize`Account`,S=$localize`Log out`,N=$localize`Register`,R=$localize`Log in`,[["role","navigation","aria-label","main navigation",1,"navbar","is-primary"],[1,"navbar-brand"],[1,"navbar-item",3,"routerLink"],["id","logo","src","assets/images/logo.png","width","28","height","28"],["role","button","aria-label","menu","aria-expanded","false","data-target","menu",1,"navbar-burger",3,"ngClass","click"],["aria-hidden","true"],["id","menu",1,"navbar-menu",3,"ngClass","click"],[1,"navbar-start"],["id","home",1,"navbar-item",3,"routerLink"],e,[1,"navbar-item","has-dropdown","is-hoverable"],[1,"navbar-link"],n,[1,"navbar-dropdown"],i,o,["id","playOffline",1,"navbar-link"],s,["id","playLocally",1,"navbar-item",3,"routerLink"],a,["id","tutorial",1,"navbar-item",3,"routerLink"],c,[1,"navbar-end"],["id","currentGameLink","class","navbar-item",3,"click",4,"ngIf"],["data-tooltip",l,1,"navbar-item",3,"routerLink"],[3,"icon"],[1,"navbar-item"],[4,"ngIf","ngIfElse"],["showUsernameOrLogin",""],["id","currentGameLink",1,"navbar-item",3,"click"],["activeUser",""],u,["waitingForOpponent",""],f,g,[1,"navbar-item","fa-spin",3,"icon"],["connect",""],["id","connectedUserName",1,"navbar-link"],["id","account","routerLink","/account",1,"navbar-item"],y,["id","logout",1,"navbar-item",3,"click"],S,[1,"buttons"],["id","register",1,"button","is-primary",3,"routerLink"],N,["id","login",1,"button","is-light",3,"routerLink"],R]},template:function(n,i){if(1&n&&(E(0,"nav",0)(1,"div",1)(2,"a",2),V(3,"img",3),P(),E(4,"a",4),q("click",function(){return i.showMenu=!i.showMenu}),V(5,"span",5)(6,"span",5)(7,"span",5),P()(),E(8,"div",6),q("click",function(){return i.showMenu=!i.showMenu}),E(9,"div",7)(10,"a",8),se(11,9),P(),E(12,"div",10)(13,"a",11),se(14,12),P(),E(15,"div",13)(16,"a",2),se(17,14),P(),E(18,"a",2),se(19,15),P()()(),E(20,"div",10)(21,"a",16),se(22,17),P(),E(23,"div",13)(24,"a",18),se(25,19),P(),E(26,"a",20),se(27,21),P()()()(),E(28,"div",22),z(29,Wdt,4,2,"a",23),E(30,"a",24),V(31,"fa-icon",25),P(),E(32,"div",26),z(33,qdt,2,1,"ng-container",27)(34,Xdt,3,2,"ng-template",null,28,In),P()()()()),2&n){const o=wn(35);m(2),v("routerLink",fr(13,Ase)),m(2),v("ngClass",i.showMenu?"is-active":""),m(4),v("ngClass",i.showMenu?"is-active":""),m(2),v("routerLink",fr(14,Ase)),m(6),v("routerLink",fr(15,Qdt)),m(2),v("routerLink",fr(16,Jdt)),m(6),v("routerLink",fr(17,eht)),m(2),v("routerLink",fr(18,tht)),m(3),v("ngIf",i.currentGame.isPresent()),m(),v("routerLink",fr(19,nht)),m(),v("icon",i.faCog),m(2),v("ngIf",i.loading)("ngIfElse",o)}},dependencies:[zt,bt,Oc,n0],encapsulation:2})}return r})(),iht=(()=>{class r{_themeService;_errorLoggerService;faTwitter=Zee;faFacebook=Uee;faGithub=jee;constructor(e,n){this._themeService=e,this._errorLoggerService=n}static \u0275fac=function(n){return new(n||r)(G(fv),G(u2))};static \u0275cmp=Ue({type:r,selectors:[["app-root"]],decls:18,vars:3,consts:()=>{let e;return e=$localize`If you like ${"\ufffd#8\ufffd"}:START_TAG_STRONG:EveryBoard${"\ufffd/#8\ufffd"}:CLOSE_TAG_STRONG:, follow us!`,[[1,"container","mt-2"],[1,"footer"],[1,"content","has-text-centered"],e,["href","https://github.com/EveryBoard/EveryBoard"],[3,"icon"],["href","https://twitter.com/EveryBoardGames"],["href","https://facebook.com/EveryBoard"]]},template:function(n,i){1&n&&(V(0,"app-header"),E(1,"main",0),V(2,"router-outlet"),P(),E(3,"footer",1)(4,"div",2)(5,"p")(6,"span"),No(7,3),V(8,"strong"),Io(),P(),ot(9," \xa0 "),E(10,"a",4),V(11,"fa-icon",5),P(),ot(12,"\xa0 "),E(13,"a",6),V(14,"fa-icon",5),P(),ot(15,"\xa0 "),E(16,"a",7),V(17,"fa-icon",5),P()()()()),2&n&&(m(11),v("icon",i.faGithub),m(3),v("icon",i.faTwitter),m(3),v("icon",i.faFacebook))},dependencies:[RS,n0,rht],encapsulation:2})}return r})();function oht(r,t){if(1&r){const e=he();E(0,"div",26)(1,"div",27),q("click",function(){return te(e),ne(p().closeInfo())}),P(),E(2,"div",28)(3,"header",29)(4,"p",30),ot(5),P(),E(6,"button",31),q("click",function(){return te(e),ne(p().closeInfo())}),P()(),E(7,"section",32)(8,"div",6)(9,"div",33)(10,"p",34),V(11,"img",35),P()(),E(12,"div",7)(13,"div",13),ot(14),P()()(),E(15,"div",6)(16,"div",33)(17,"a",36),q("click",function(){te(e);const i=p();return ne(i.createGame(i.gameInfoDetails.get().urlName))}),V(18,"fa-icon",37),ot(19,"\xa0"),E(20,"span"),se(21,38),P()()(),E(22,"div",33)(23,"a",36),q("click",function(){te(e);const i=p();return ne(i.createLocalGame(i.gameInfoDetails.get().urlName))}),V(24,"fa-icon",37),ot(25,"\xa0"),E(26,"span"),se(27,39),P()()(),E(28,"div",33)(29,"a",36),q("click",function(){te(e);const i=p();return ne(i.createTutorial(i.gameInfoDetails.get().urlName))}),V(30,"fa-icon",37),ot(31,"\xa0"),E(32,"span"),se(33,40),P()()()()()()()}if(2&r){const e=p();m(5),Cn(e.gameInfoDetails.get().name),m(6),ve("src","assets/images/",e.theme,"/",e.gameInfoDetails.get().urlName,".png",Jh),m(3),ii(" ",e.gameInfoDetails.get().description," "),m(4),v("icon",e.iconOnlineGame),m(6),v("icon",e.iconLocalGame),m(6),v("icon",e.iconTutorial)}}function sht(r,t){if(1&r){const e=he();E(0,"div",8)(1,"div",9)(2,"p",10),ot(3),P()(),E(4,"div",42)(5,"figure",34)(6,"img",43),q("click",function(){const o=te(e).$implicit;return ne(p(2).openInfo(o))}),P(),E(7,"figcaption",44),q("click",function(){const o=te(e).$implicit;return ne(p(2).openInfo(o))}),E(8,"div",45),ot(9,"?"),P()(),E(10,"figcaption",46)(11,"a",47),q("click",function(){const o=te(e).$implicit;return ne(p(2).createGame(o.urlName))}),V(12,"fa-icon",37),P(),E(13,"a",48),q("click",function(){const o=te(e).$implicit;return ne(p(2).createLocalGame(o.urlName))}),V(14,"fa-icon",37),P(),E(15,"a",49),q("click",function(){const o=te(e).$implicit;return ne(p(2).createTutorial(o.urlName))}),V(16,"fa-icon",37),P()()()(),E(17,"div",50),ot(18),P()()}if(2&r){const e=t.$implicit,n=p(2);m(3),Cn(e.name),m(3),Tn("id","image_",e.urlName,""),ve("src","assets/images/",n.theme,"/",e.urlName,".png",Jh),m(5),Tn("id","playOnline_",e.urlName,""),m(),v("icon",n.iconOnlineGame),m(),Tn("id","playLocally_",e.urlName,""),m(),v("icon",n.iconLocalGame),m(),Tn("id","startTutorial_",e.urlName,""),m(),v("icon",n.iconTutorial),m(2),ii(" ",e.description," ")}}function aht(r,t){if(1&r&&(E(0,"div",7),z(1,sht,19,11,"div",41),P()),2&r){const e=t.$implicit;m(),v("ngForOf",e)}}let cht=(()=>{class r{router;messageDisplayer;currentGameService;numberOfColumns=5;games=[];theme;iconOnlineGame=Qie;iconLocalGame=Xk;iconTutorial=ese;gameInfoDetails=h.empty();constructor(e,n,i,o){this.router=e,this.messageDisplayer=n,this.currentGameService=i,this.theme=o.getTheme();const s=Ht.ALL_GAMES();let a=0;for(let c=0;c<s.length;c++)c<this.numberOfColumns&&this.games.push([]),this.games[a].push(s[c]),a=(a+1)%this.numberOfColumns}createGame(e){var n=this;return M(function*(){const i=n.currentGameService.canUserCreate();return i.isSuccess()?n.router.navigate(null==e?["/play"]:["/play",e]):(n.messageDisplayer.criticalMessage(i.getReason()),!1)})()}createLocalGame(e){var n=this;return M(function*(){return n.router.navigate(["/local",e])})()}createTutorial(e){return this.router.navigate(["/tutorial",e])}openInfo(e){this.gameInfoDetails=h.of(e)}closeInfo(){this.gameInfoDetails=h.empty()}static \u0275fac=function(n){return new(n||r)(G(Qn),G(Ut),G(qo),G(fv))};static \u0275cmp=Ue({type:r,selectors:[["app-welcome"]],decls:33,vars:2,consts:()=>{let e,n,i,o,s,a,c,l,u,f,g,y,S,N;return e=$localize`EveryBoard`,n=$localize`EveryBoard is a website to play and learn the rules of various abstract strategy games with perfect information.${"\ufffd#6\ufffd\ufffd/#6\ufffd"}:LINE_BREAK: Such games are games that do not include any randomness, agility, or hidden information. These games are played by two players, turn by turn.`,i=$localize`Play online`,o=$localize`Create an online game`,s=$localize`See the game list`,a=$localize`Play offline`,c=$localize`Play`,l=$localize`Learn`,u=$localize`Play online`,f=$localize`Play offline`,g=$localize`Learn the rules`,y=$localize`Play online`,S=$localize`Play offline`,N=$localize`Learn the rules`,[[1,"hero"],[1,"hero-body"],[1,"title"],e,[1,"subtitle"],n,[1,"columns"],[1,"column"],[1,"card"],[1,"card-header"],[1,"card-header-title"],i,[1,"card-content"],[1,"content"],["id","createOnlineGame",1,"button","is-medium","is-fullwidth","is-primary","mb-1",3,"click"],o,["id","seeGameList","routerLink","/lobby",1,"button","is-medium","is-fullwidth","is-primary"],s,a,[1,"content","has-text-centered"],["routerLink","/local",1,"button","is-medium","is-fullwidth","is-primary","mb-1"],c,["routerLink","/tutorial",1,"button","is-medium","is-fullwidth","is-primary"],l,["id","gameInfoModal","class","modal is-active",4,"ngIf"],["class","column",4,"ngFor","ngForOf"],["id","gameInfoModal",1,"modal","is-active"],["id","modalBackground",1,"modal-background",3,"click"],[1,"modal-card"],[1,"modal-card-head","is-primary"],[1,"modal-card-title"],["id","closeInfo","aria-label","close",1,"delete",3,"click"],[1,"modal-card-body"],[1,"column","is-one-third"],[1,"image"],[3,"src"],[1,"button","is-fullwidth",3,"click"],[3,"icon"],u,f,g,["class","card",4,"ngFor","ngForOf"],[1,"card-image","game-card"],[1,"is-clickable",3,"id","src","click"],[1,"has-text-centered","is-overlay","game-image-text","is-clickable",3,"click"],[1,"is-size-1","has-text-weight-bold"],[1,"has-text-centered","is-overlay","game-image-buttons"],["data-tooltip",y,1,"button",3,"id","click"],["data-tooltip",S,1,"button",3,"id","click"],["data-tooltip",N,1,"button",3,"id","click"],[1,"card-content","is-hidden"]]},template:function(n,i){1&n&&(E(0,"section",0)(1,"div",1)(2,"p",2),se(3,3),P(),E(4,"p",4),No(5,5),V(6,"br"),Io(),P()(),E(7,"div",6)(8,"div",7)(9,"div",8)(10,"header",9)(11,"p",10),se(12,11),P()(),E(13,"div",12)(14,"div",13)(15,"button",14),q("click",function(){return i.createGame()}),se(16,15),P(),E(17,"button",16),se(18,17),P()()()()(),E(19,"div",7)(20,"div",8)(21,"header",9)(22,"p",10),se(23,18),P()(),E(24,"div",12)(25,"div",19)(26,"button",20),se(27,21),P(),E(28,"button",22),se(29,23),P()()()()()(),z(30,oht,34,7,"div",24),E(31,"div",6),z(32,aht,2,1,"div",25),P()()),2&n&&(m(30),v("ngIf",i.gameInfoDetails.isPresent()),m(2),v("ngForOf",i.games))},dependencies:[Nt,bt,Oc,n0],encapsulation:2})}return r})();const lht=["board"];let jd=(()=>class r{static NOT_YOUR_TURN=()=>$localize`It is not your turn!`;static GAME_HAS_ENDED=()=>$localize`This game has ended.`;static NO_MATCHING_GAME(e){return $localize`This game (${e}) does not exist.`}})(),bv=(()=>{class r extends BQ{connectedUserService;router;messageDisplayer;boardRef=null;gameComponent;players=[h.empty(),h.empty()];role=B.NONE;endGame=!1;Player=O;constructor(e,n,i,o){super(e),this.connectedUserService=n,this.router=i,this.messageDisplayer=o}getMatchingComponent(e){return h.ofNullable(Ht.ALL_GAMES().find(i=>i.urlName===e)).map(i=>i.component)}createMatchingGameComponent(){var e=this;return M(function*(){const n=yield e.getMatchingComponentAndNavigateOutIfAbsent();if(n.isPresent()){const i=yield e.getConfig();return yield e.createGameComponent(n.get()),e.gameComponent.config=i,e.gameComponent.node=e.gameComponent.rules.getInitialNode(i),yield e.gameComponent.updateBoard(!1),!0}return!1})()}getMatchingComponentAndNavigateOutIfAbsent(){var e=this;return M(function*(){const n=e.getGameName(),i=e.getMatchingComponent(n);return i.isAbsent()?(yield e.router.navigate(["/notFound",jd.NO_MATCHING_GAME(n)],{skipLocationChange:!0}),h.empty()):i})()}createGameComponent(e){var n=this;return M(function*(){L.assert(null!=n.boardRef,"Board element should be present");const i=L.getNonNullable(n.boardRef).createComponent(e);n.gameComponent=i.instance,n.gameComponent.chooseMove=o=>n.receiveValidMove(o),n.gameComponent.canUserPlay=o=>n.canUserPlay(o),n.gameComponent.isPlayerTurn=()=>n.isPlayerTurn(),n.gameComponent.cancelMoveOnWrapper=o=>n.onCancelMove(o),yield n.setRole(n.role)})()}setRole(e){var n=this;return M(function*(){n.role=e,n.gameComponent.setPointOfView(e===B.NONE?O.ZERO:e),yield n.updateBoardAndShowLastMove(!1)})()}receiveValidMove(e){var n=this;return M(function*(){const i=yield n.getConfig(),o=n.gameComponent.rules.isLegal(e,n.gameComponent.node.gameState,i);return o.isFailure()?(yield n.gameComponent.cancelMove(o.getReason()),w.ofFallible(o)):(n.gameComponent.cancelMoveAttempt(),yield n.onLegalUserMove(e),w.SUCCESS)})()}getConfig(){var e=this;return M(function*(){const n=e.getGameName();return ok.getGameDefaultConfig(n)})()}canUserPlay(e){var n=this;return M(function*(){return!1===n.isPlayerTurn()?w.failure(jd.NOT_YOUR_TURN()):n.endGame?w.failure(jd.GAME_HAS_ENDED()):w.SUCCESS})()}isPlayerTurn(){if(this.role===B.NONE||null==this.gameComponent)return!1;const n=this.gameComponent.getTurn()%2,i=this.getPlayer();return!this.players[n].isPresent()||this.players[n].equalsValue(i)}getBoardHighlight(){return this.endGame?["endgame-bg"]:this.isPlayerTurn()?["player"+this.gameComponent.getTurn()%2+"-bg"]:[]}updateBoardAndShowLastMove(e){var n=this;return M(function*(){if(n.gameComponent.cancelMoveAttempt(),n.gameComponent.hideLastMove(),n.gameComponent.node.previousMove.isPresent()){yield n.gameComponent.updateBoard(e);const i=n.gameComponent.node.previousMove.get(),o=yield n.getConfig();yield n.gameComponent.showLastMove(i,o)}else yield n.gameComponent.updateBoard(!1)})()}getRulesConfigDescription(){const e=this.getGameName();return this.getRulesConfigDescriptionByName(e)}getRulesConfigDescriptionByName(e){const n=Ht.getByUrlName(e);return n.isAbsent()?h.empty():n.get().getRulesConfigDescription()}static \u0275fac=function(n){return new(n||r)(G(ao),G(gr),G(Qn),G(Ut))};static \u0275cmp=Ue({type:r,selectors:[["ng-component"]],viewQuery:function(n,i){if(1&n&&P3(lht,5,os),2&n){let o;hc(o=gc())&&(i.boardRef=o.first)}},features:[$e],decls:0,vars:0,template:function(n,i){},encapsulation:2})}return r})(),Nse=(()=>class r{static STEP_FINISHED=()=>$localize`Step finished!`;static INFORMATIONAL_STEP=()=>$localize`This step is not expecting any move from your part.`})();function fht(r,t){if(1&r&&(E(0,"div",21)(1,"div",22),se(2,23),P(),V(3,"div",24),P()),2&r){const e=p();m(3),v("innerHTML",e.currentReason.get(),o7)}}function dht(r,t){if(1&r){const e=he();E(0,"button",25),q("click",function(){return te(e),ne(p().retry())}),se(1,26),P()}}function hht(r,t){1&r&&(jt(0),se(1,31),Zt())}function ght(r,t){1&r&&(jt(0),se(1,32),Zt())}function pht(r,t){if(1&r&&z(0,ght,2,0,"ng-container",28),2&r){p();const e=wn(5),n=p();v("ngIf",n.stepFinished&&n.stepFinished[n.stepIndex])("ngIfElse",e)}}function mht(r,t){1&r&&(jt(0),se(1,33),Zt())}function _ht(r,t){if(1&r){const e=he();E(0,"button",27),q("click",function(){return te(e),ne(p().next())}),z(1,hht,2,0,"ng-container",28)(2,pht,1,2,"ng-template",null,29,In)(4,mht,2,0,"ng-template",null,30,In),P()}if(2&r){const e=wn(3),n=p();m(),v("ngIf",n.steps[n.stepIndex]&&n.steps[n.stepIndex].isInformation())("ngIfElse",e)}}function Cht(r,t){if(1&r){const e=he();E(0,"button",34),q("click",function(){return te(e),ne(p().start())}),se(1,35),P()}}function vht(r,t){if(1&r){const e=he();E(0,"button",36),q("click",function(){return te(e),ne(p().playLocally())}),se(1,37),P()}}function yht(r,t){if(1&r){const e=he();E(0,"button",38),q("click",function(){return te(e),ne(p().createGame())}),se(1,39),P()}}function Mht(r,t){if(1&r){const e=he();E(0,"button",40),q("click",function(){return te(e),ne(p().showSolution())}),se(1,41),P()}}function Eht(r,t){if(1&r&&(jt(0),E(1,"option",43),ot(2),P(),Zt()),2&r){const e=p(),n=e.index,i=e.$implicit;m(),Tn("id","step_",n,""),v("value",n),m(),Cn(i.title)}}function Pht(r,t){1&r&&(jt(0),ot(1,"v "),Zt())}function Sht(r,t){1&r&&ot(0,"x ")}function Oht(r,t){if(1&r&&(E(0,"option",44),z(1,Pht,2,0,"ng-container",28)(2,Sht,1,0,"ng-template",null,45,In),E(4,"span",46),ot(5),P()()),2&r){const e=wn(3),n=p(),i=n.index,o=n.$implicit,s=p();v("value",i),m(),v("ngIf",s.stepFinished[i])("ngIfElse",e),m(3),Tn("id","step_",i,""),m(),Cn(o.title)}}function Tht(r,t){if(1&r&&(jt(0),z(1,Eht,3,3,"ng-container",28)(2,Oht,6,5,"ng-template",null,42,In),Zt()),2&r){const e=t.index,n=wn(3),i=p();m(),v("ngIf",e===i.stepIndex)("ngIfElse",n)}}let Ise=(()=>class r{static COMPLETED_TUTORIAL_MESSAGE=()=>$localize`Congratulations, you completed the tutorial.`;static THIS_IS_A_DEMO=()=>$localize`You cannot click, this is a demo.`})(),iR=class yR extends bv{cdr;steps=[];successfulSteps=0;stepIndex=-1;currentMessage="";currentReason=h.empty();moveAttemptMade=!1;stepFinished=[];tutorialOver=!1;constructor(t,e,n,i,o){super(t,o,e,n),this.cdr=i}getNumberOfSteps(){return this.steps.length}getCurrentStepTitle(){return this.steps.length>0?this.steps[this.stepIndex].title:""}ngAfterViewInit(){var t=this;return M(function*(){(yield t.createMatchingGameComponent())&&(yield t.start())})()}start(){var t=this;return M(function*(){const e=t.gameComponent.tutorial;yield t.startTutorial(e)})()}startTutorial(t){var e=this;return M(function*(){e.steps=t,e.tutorialOver=!1,e.stepFinished=e.getCompletionArray(),e.successfulSteps=0,yield e.showStep(0)})()}getCompletionArray(){return this.steps.map(()=>!1)}changeStep(t){var e=this;return M(function*(){const n=t.target;yield e.showStep(Number.parseInt(n.value,10))})()}showStep(t){var e=this;return M(function*(){e.moveAttemptMade=!1,e.stepFinished[t]=!1,e.updateSuccessCount(),e.stepIndex=t;const n=e.steps[e.stepIndex];e.currentMessage=n.instruction,e.currentReason=h.empty(),e.gameComponent.node=new ms(n.state,void 0,n.previousMove),yield e.setRole(e.gameComponent.getCurrentPlayer()),e.gameComponent.setInteractive(!1===n.isInformation()),e.cdr.detectChanges()})()}onLegalUserMove(t){var e=this;return M(function*(){const n=e.steps[e.stepIndex],i=yield e.getConfig(),o=e.gameComponent.rules.choose(e.gameComponent.node,t,i);if(L.assert(o.isSuccess(),"It should be impossible to call onLegalUserMove with an illegal move, but got "+o.getReasonOr("")),e.gameComponent.node=o.get(),yield e.updateBoardAndShowLastMove(!1),e.moveAttemptMade=!0,n.isPredicate()){const s=e.gameComponent.getPreviousState(),a=e.gameComponent.getState(),c=L.getNonNullable(n.predicate)(t,s,a);c.isSuccess()?e.showStepSuccess(n.getSuccessMessage()):e.currentReason=h.of(c.getReason())}else if(n.isAnyMove())Ae.display("TutorialGameWrapperComponent","onLegalUserMove","awaited move!"),e.showStepSuccess(n.getSuccessMessage());else if(n.isMove()){const s=n;s.acceptedMoves.some(a=>a.equals(t))?(Ae.display("TutorialGameWrapperComponent","onLegalUserMove","awaited move!"),e.showStepSuccess(s.getSuccessMessage())):(Ae.display("TutorialGameWrapperComponent","onLegalUserMove","not the move that was awaited."),e.currentReason=h.of(s.getFailureMessage()))}else L.assert(n.isClick(),"Here, we should have a click");e.cdr.detectChanges()})()}retry(){var t=this;return M(function*(){t.moveAttemptMade=!1,yield t.showStep(t.stepIndex)})()}canUserPlay(t){var e=this;return M(function*(){if(e.currentReason=h.empty(),e.stepFinished[e.stepIndex]||e.moveAttemptMade)return w.failure(Nse.STEP_FINISHED());const n=e.steps[e.stepIndex];return n.isClick()?(yield e.updateBoardAndShowLastMove(!1),e.moveAttemptMade=!0,L.getNonNullable(n.acceptedClicks).some(i=>i===t)?e.showStepSuccess(n.getSuccessMessage()):e.currentMessage=n.getFailureMessage(),w.SUCCESS):n.isMove()||n.isPredicate()||n.isAnyMove()?w.SUCCESS:w.failure(Nse.INFORMATIONAL_STEP())})()}onCancelMove(t){var e=this;return M(function*(){void 0!==t&&(e.currentReason=h.of(t)),e.cdr.detectChanges()})()}showStepSuccess(t){this.currentMessage=t,this.stepFinished[this.stepIndex]=!0,this.updateSuccessCount()}updateSuccessCount(){let t=0;for(const e of this.stepFinished)e&&t++;this.successfulSteps=t}next(){var t=this;return M(function*(){if(t.steps[t.stepIndex].isInformation()&&(t.stepFinished[t.stepIndex]=!0,t.updateSuccessCount()),t.stepFinished.length===t.successfulSteps)t.currentMessage=Ise.COMPLETED_TUTORIAL_MESSAGE(),t.tutorialOver=!0;else{let e=(t.stepIndex+1)%t.steps.length;for(;!0===t.stepFinished[e];)e=(e+1)%t.steps.length;yield t.showStep(e)}})()}showSolution(){var t=this;return M(function*(){const e=t.steps[t.stepIndex];L.assert(e.hasSolution(),"step must have solution");const n=e,i=n.getSolution(),o=yield t.getConfig();i instanceof h2?(yield t.showStep(t.stepIndex),t.gameComponent.node=t.gameComponent.rules.choose(t.gameComponent.node,i,o).get(),yield t.updateBoardAndShowLastMove(!0)):(yield t.showStep(t.stepIndex),window.document.querySelector(i).dispatchEvent(new Event("click"))),t.currentMessage=n.getSuccessMessage(),t.moveAttemptMade=!0,t.cdr.detectChanges()})()}playLocally(){var t=this;return M(function*(){const e=t.getGameName();yield t.router.navigate(["/local",e])})()}createGame(){var t=this;return M(function*(){const e=t.getGameName();yield t.router.navigate(["/play",e])})()}getPlayer(){return"tutorial-player"}static \u0275fac=function(e){return new(e||yR)(G(ao),G(Qn),G(Ut),G(Vs),G(gr))};static \u0275cmp=Ue({type:yR,selectors:[["app-tutorial-game-wrapper"]],features:[$e],decls:23,vars:15,consts:()=>{let t,e,n,i,o,s,a,c,l;return t=$localize`Failure`,e=$localize`Try again`,n=$localize`Ok`,i=$localize`Continue`,o=$localize`Skip`,s=$localize`Try again`,a=$localize`Play locally`,c=$localize`Create an online game`,l=$localize`See solution`,[[1,"tile","is-ancestor"],[1,"tile","is-5","is-vertical","is-parent"],["id","infos",1,"tile","is-child","box"],[1,"progress","is-primary"],[1,"content","is-medium"],[1,"title"],["id","currentMessage",3,"innerHTML"],["class","message is-danger","role","alert",4,"ngIf"],[1,"block"],["id","retryButton","class","button mr-3",3,"click",4,"ngIf"],["id","nextButton","class","button is-primary mr-3 mb-1",3,"click",4,"ngIf"],["id","restartButton","class","button",3,"click",4,"ngIf"],["id","playLocallyButton","class","button",3,"click",4,"ngIf"],["id","playOnlineButton","class","button",3,"click",4,"ngIf"],["id","showSolutionButton","class","button",3,"click",4,"ngIf"],[1,"select"],["id","steps",3,"change"],[4,"ngFor","ngForOf"],[1,"tile","is-parent","is-7","is-vcentered",3,"ngClass"],["id","board",1,"tile","is-child","box"],["board",""],["role","alert",1,"message","is-danger"],[1,"message-header"],t,["id","currentReason",1,"message-body",3,"innerHTML"],["id","retryButton",1,"button","mr-3",3,"click"],e,["id","nextButton",1,"button","is-primary","mr-3","mb-1",3,"click"],[4,"ngIf","ngIfElse"],["notInfo",""],["notFinished",""],n,i,o,["id","restartButton",1,"button",3,"click"],s,["id","playLocallyButton",1,"button",3,"click"],a,["id","playOnlineButton",1,"button",3,"click"],c,["id","showSolutionButton",1,"button",3,"click"],l,["otherstep",""],["selected","",3,"id","value"],[3,"value"],["notdone",""],[3,"id"]]},template:function(e,n){1&e&&(E(0,"div",0)(1,"div",1)(2,"div",2),V(3,"progress",3),E(4,"div",4)(5,"p",5),ot(6),P(),V(7,"p",6),P(),z(8,fht,4,1,"div",7),E(9,"div",8),z(10,dht,2,0,"button",9)(11,_ht,6,2,"button",10)(12,Cht,2,0,"button",11)(13,vht,2,0,"button",12)(14,yht,2,0,"button",13)(15,Mht,2,0,"button",14),E(16,"div",15)(17,"select",16),q("change",function(o){return n.changeStep(o)}),z(18,Tht,4,2,"ng-container",17),P()()()()(),E(19,"div",18)(20,"div",19),V(21,"div",null,20),P()()()),2&e&&(m(3),A("value",n.successfulSteps)("max",n.getNumberOfSteps()),m(3),UE("",n.getCurrentStepTitle()," [",n.stepIndex+1,"/",n.getNumberOfSteps(),"]"),m(),v("innerHTML",n.currentMessage,o7),m(),v("ngIf",n.currentReason.isPresent()),m(2),v("ngIf",!1===n.tutorialOver&&(n.stepFinished&&!0===n.stepFinished[n.stepIndex]||n.moveAttemptMade)),m(),v("ngIf",!1===n.tutorialOver),m(),v("ngIf",n.tutorialOver),m(),v("ngIf",n.tutorialOver),m(),v("ngIf",n.tutorialOver),m(),v("ngIf",n.moveAttemptMade&&!1===n.stepFinished[n.stepIndex]),m(3),v("ngForOf",n.steps),m(),v("ngClass",n.getBoardHighlight()))},dependencies:[zt,Nt,bt,N8,I8],encapsulation:2,changeDetection:0})};iR=function(r,t,e,n){var s,i=arguments.length,o=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,e):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,t,e,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(t,e,o):s(t,e))||o);return i>3&&o&&Object.defineProperty(t,e,o),o}([Ae.log],iR);const wht=["board"];let kse=(()=>{class r extends bv{cdr;demoNodeInfo;boardRef=null;gameComponentIsSetup=!1;constructor(e,n,i,o,s){super(e,n,i,o),this.cdr=s}ngAfterViewInit(){var e=this;return M(function*(){window.setTimeout(M(function*(){yield e.createMatchingGameComponent(),e.gameComponent.node=e.demoNodeInfo.node,e.gameComponent.setInteractive(!0),yield e.setRole(e.gameComponent.getCurrentPlayer()),e.cdr.detectChanges(),e.demoNodeInfo.click.isPresent()&&(L.getNonNullable(document.querySelector(e.demoNodeInfo.click.get())).dispatchEvent(new Event("click")),e.cdr.detectChanges()),e.gameComponentIsSetup=!0,yield e.setRole(B.NONE)}),1)})()}ngOnChanges(e){var n=this;return M(function*(){null!=n.gameComponent&&(n.gameComponent.node=n.demoNodeInfo.node,yield n.gameComponent.updateBoard(!1),n.cdr.detectChanges())})()}getGameName(){return this.demoNodeInfo.name}onLegalUserMove(e,n){return M(function*(){L.assert(!1,"DemoCardWrapper should not call applyLegalMove, as it does no move")})()}getPlayer(){return"no-player"}onCancelMove(e){return M(function*(){})()}canUserPlay(e){var n=this;return M(function*(){return n.gameComponentIsSetup?w.failure(Ise.THIS_IS_A_DEMO()):w.SUCCESS})()}static \u0275fac=function(n){return new(n||r)(G(ao),G(gr),G(Qn),G(Ut),G(Vs))};static \u0275cmp=Ue({type:r,selectors:[["app-demo-card"]],viewQuery:function(n,i){if(1&n&&P3(wht,5,os),2&n){let o;hc(o=gc())&&(i.boardRef=o.first)}},inputs:{demoNodeInfo:"demoNodeInfo"},features:[$e,n2],decls:2,vars:0,consts:[["board",""]],template:function(n,i){1&n&&V(0,"div",null,0)},encapsulation:2})}return r})();function bht(r,t){if(1&r&&(E(0,"div",17)(1,"figure",18),V(2,"app-demo-card",19),P()()),2&r){const e=p().$implicit;m(2),v("demoNodeInfo",e)}}function Aht(r,t){if(1&r&&(E(0,"div",20)(1,"figure",21),V(2,"app-demo-card",19),P()()),2&r){const e=p().$implicit;m(2),v("demoNodeInfo",e)}}function Nht(r,t){if(1&r&&(E(0,"div",12)(1,"div",13)(2,"p",14),ot(3),P()(),z(4,bht,3,1,"div",15)(5,Aht,3,1,"ng-template",null,16,In),P()),2&r){const e=t.$implicit,n=wn(6),i=p(2);m(3),Cn(e.name),m(),v("ngIf",i.squared.value)("ngIfElse",n)}}function Iht(r,t){if(1&r&&(E(0,"div",10),z(1,Nht,7,3,"div",11),P()),2&r){const e=t.$implicit;m(),v("ngForOf",e)}}let kht=(()=>{class r{numberOfColumns=new ko(5);squared=new ko(!0);columns=[];constructor(){this.fillColumns(this.numberOfColumns.value),this.numberOfColumns.valueChanges.subscribe(e=>{this.fillColumns(e)})}fillColumns(e){const n=Ht.ALL_GAMES();let i=0,o=0;this.columns=[];for(const s of n){const a=[],c=s.rules,l=s.tutorial.tutorial,u=s.getRulesConfig();for(const f of l){const g=this.getNodeFromStep(f,c,u);a.push(g)}for(const f of a)o<e&&this.columns.push([]),this.columns[i].push({name:s.urlName,node:f.node,click:f.click}),o++,i=(i+1)%e}}getNodeFromStep(e,n,i){if(e.hasSolution()){const o=e.getSolution();if("string"==typeof o)return{node:new ms(e.state),click:h.of(o)};{const s=o,a=n.isLegal(s,e.state,i),c=n.applyLegalMove(s,e.state,i,a.get()),l=new ms(e.state);return{node:new ms(c,h.of(l),h.of(s)),click:h.empty()}}}return{node:new ms(e.state),click:h.empty()}}static \u0275fac=function(n){return new(n||r)};static \u0275cmp=Ue({type:r,selectors:[["app-demo-page"]],decls:17,vars:4,consts:()=>{let e,n;return e=$localize`Number of columns: `,n=$localize`Squared`,[[1,"field"],["for","numberOfColumns",1,"label"],e,[1,"control"],["step","1","min","1","max","10","name","maximalMoveDuration","type","range",1,"slider","is-circle","is-primary",3,"formControl"],[1,"checkbox"],["type","checkbox",3,"formControl"],n,[1,"columns"],["class","column",4,"ngFor","ngForOf"],[1,"column"],["class","card",4,"ngFor","ngForOf"],[1,"card"],[1,"card-header"],[1,"card-header-title"],["class","card-image game-card","style","height: 200px;",4,"ngIf","ngIfElse"],["nonSquared",""],[1,"card-image","game-card",2,"height","200px"],[1,"image",2,"height","100%"],[3,"demoNodeInfo"],[1,"card-image","game-card"],[1,"image"]]},template:function(n,i){1&n&&(E(0,"form")(1,"div",0)(2,"label",1),jt(3),se(4,2),Zt(),E(5,"output"),ot(6),P()(),E(7,"div",3),V(8,"input",4),P()(),E(9,"div",0)(10,"label",5),V(11,"input",6),ot(12," \xa0"),jt(13),se(14,7),Zt(),P()()(),E(15,"div",8),z(16,Iht,2,1,"div",9),P()),2&n&&(m(6),Cn(i.numberOfColumns.value),m(2),v("formControl",i.numberOfColumns),m(3),v("formControl",i.squared),m(5),v("ngForOf",i.columns))},dependencies:[Nt,bt,F4,Na,Ap,Cp,vc,H4,rS,tf,kse],encapsulation:2})}return r})(),oR=(()=>{class r{element;constructor(e){this.element=e}ngAfterViewInit(){this.element.nativeElement.focus()}static \u0275fac=function(n){return new(n||r)(G(I2))};static \u0275dir=Vt({type:r,selectors:[["","autofocus",""]]})}return r})(),Rse=(()=>{class r{shown=!1;input;constructor(e){this.input=e.nativeElement.parentNode.previousSibling,e.nativeElement.addEventListener("click",n=>{this.toggle()})}toggle(){this.shown=!1===this.shown,this.input.setAttribute("type",this.shown?"text":"password"),this.input.focus()}static \u0275fac=function(n){return new(n||r)(G(I2))};static \u0275dir=Vt({type:r,selectors:[["","toggleVisibility",""]]})}return r})();function Rht(r,t){if(1&r&&(E(0,"div",29)(1,"div",30),se(2,31),P(),E(3,"div",32),ot(4),P()()),2&r){const e=p();m(4),Cn(e.errorMessage)}}const xht=()=>["/register"],Lht=()=>["/reset-password"];let zht=(()=>{class r{router;connectedUserService;faEye=wk;errorMessage;loginForm=new yc({email:new ko,password:new ko});userSubscription;constructor(e,n){this.router=e,this.connectedUserService=n}ngOnInit(){var e=this;this.userSubscription=this.connectedUserService.subscribeToUser(function(){var n=M(function*(i){i!==o0.NOT_CONNECTED&&(yield e.redirect())});return function(i){return n.apply(this,arguments)}}())}loginWithEmail(e){var n=this;return M(function*(){const i=yield n.connectedUserService.doEmailLogin(e.email,e.password);i.isFailure()&&(n.errorMessage=i.getReason())})()}loginWithGoogle(){var e=this;return M(function*(){const n=yield e.connectedUserService.doGoogleLogin();n.isFailure()&&(e.errorMessage=n.getReason())})()}redirect(){var e=this;return M(function*(){return e.router.navigate(["/lobby"])})()}canLogin(){return!(""===(this.loginForm.value.email??"")||""===(this.loginForm.value.password??""))}ngOnDestroy(){this.userSubscription.unsubscribe()}static \u0275fac=function(n){return new(n||r)(G(Qn),G(gr))};static \u0275cmp=Ue({type:r,selectors:[["app-login"]],decls:49,vars:8,consts:()=>{let e,n,i,o,s,a,c,l,u,f,g,y;return e=$localize`Log in`,n=$localize`Email`,i=$localize`Email`,o=$localize`Password`,s=$localize`Password`,a=$localize`Log in`,c=$localize`Log in with Google`,l=$localize`No account?`,u=$localize`Register`,f=$localize`Forgot your password?`,g=$localize`Reset your password`,y=$localize`Connection error`,[[1,"box"],[1,"title"],e,[3,"formGroup"],[1,"field","is-horizontal"],[1,"field-label","is-normal"],["for","email",1,"label"],n,[1,"field-body"],[1,"field"],[1,"control"],["id","email","type","text","placeholder",i,"formControlName","email","name","email","type","email","autofocus","","required","",1,"input"],["for","password",1,"label"],o,[1,"control","has-icons-right","is-expanded"],["id","password","type","password","placeholder",s,"formControlName","password","name","password","required","",1,"input"],[1,"icon","is-small","is-right"],["toggleVisibility","",1,"clickable-icon",3,"icon"],["id","loginButton",1,"button","is-primary","is-fullwidth",3,"disabled","click"],a,["id","googleButton","type","submit",1,"button","is-fullwidth",3,"click"],c,["class","message is-danger","role","alert",4,"ngIf"],[1,"help","level-right"],l,[3,"routerLink"],u,f,g,["role","alert",1,"message","is-danger"],[1,"message-header"],y,["id","errorMessage",1,"message-body"]]},template:function(n,i){1&n&&(E(0,"div",0)(1,"p",1),se(2,2),P(),E(3,"form",3)(4,"div",4)(5,"div",5)(6,"label",6),se(7,7),P()(),E(8,"div",8)(9,"div",9)(10,"div",10),V(11,"input",11),P()()()(),E(12,"div",4)(13,"div",5)(14,"label",12),se(15,13),P()(),E(16,"div",8)(17,"div",9)(18,"div",14),V(19,"input",15),E(20,"span",16),V(21,"fa-icon",17),P()()()()(),E(22,"div",4),V(23,"div",5),E(24,"div",8)(25,"div",9)(26,"div",10)(27,"button",18),q("click",function(){return i.loginWithEmail(i.loginForm.value)}),se(28,19),P()()()()(),E(29,"div",4),V(30,"div",5),E(31,"div",8)(32,"div",9)(33,"div",10)(34,"button",20),q("click",function(){return i.loginWithGoogle()}),se(35,21),P()()()()(),z(36,Rht,5,1,"div",22),E(37,"p",23),jt(38),se(39,24),Zt(),ot(40,"\xa0 "),E(41,"a",25),se(42,26),P()(),E(43,"p",23),jt(44),se(45,27),Zt(),ot(46,"\xa0 "),E(47,"a",25),se(48,28),P()()()()),2&n&&(m(3),v("formGroup",i.loginForm),m(18),v("icon",i.faEye),m(6),v("disabled",!i.canLogin()),m(9),v("ngIf",i.errorMessage),m(5),v("routerLink",fr(6,xht)),m(6),v("routerLink",fr(7,Lht)))},dependencies:[bt,Oc,F4,Na,vc,H4,G4,U4,u6,n0,oR,Rse],encapsulation:2})}return r})(),Dht=(()=>{class r{partDAO;constructor(e){this.partDAO=e}subscribeToActiveParts(e){let n=[];const a=new EC(c=>{n=n.concat(...c),e(n)},c=>{const l=n;for(const u of c)l.forEach(f=>{f.id===u.id&&(f.data=u.data)});n=l,e(n)},c=>{const l=[];for(const u of n)c.every(f=>f.id!==u.id)&&l.push(u);n=l,e(n)});return this.partDAO.observingWhere([["result","==",tr.UNACHIEVED.value]],a)}static \u0275fac=function(n){return new(n||r)(ze(_d))};static \u0275prov=xe({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})(),Vht=(()=>{class r{transform(e){return aU(1e3*e.seconds,"HH:mm:ss","en-US")}static \u0275fac=function(n){return new(n||r)};static \u0275pipe=O2({name:"firestoreTime",type:r,pure:!0})}return r})();const Fht=["chatDiv"];function Uht(r,t){1&r&&(jt(0),se(1,5),Zt())}function Ght(r,t){1&r&&se(0,6),2&r&&(Bn(p().unreadMessagesText),Yn(0))}function Bht(r,t){if(1&r){const e=he();E(0,"button",11),q("click",function(){return te(e),ne(p(2).scrollToBottom())}),ot(1),P()}if(2&r){const e=p(2);m(),ii("",e.unreadMessagesText," \u2193")}}function $ht(r,t){if(1&r&&(E(0,"p"),ot(1),wa(2,"firestoreTime"),E(3,"b",12),ot(4),P(),E(5,"span",13),ot(6),P()()),2&r){const e=t.$implicit;m(),ii(" [",pc(2,3,e.postedTime),"] "),m(3),ii("",e.sender.name," : "),m(2),Cn(e.content)}}function Wht(r,t){if(1&r){const e=he();E(0,"div"),z(1,Bht,2,1,"button",7),E(2,"div",8,9),q("scroll",function(){return te(e),ne(p().updateCurrentScrollPosition())}),z(4,$ht,7,5,"p",10),P()()}if(2&r){const e=p();m(),v("ngIf",e.showUnreadMessagesButton),m(3),v("ngForOf",e.chat)}}const qht=()=>({standalone:!0});function jht(r,t){if(1&r){const e=he();E(0,"form",14),q("onSubmit",function(){return te(e),ne(p().sendMessage())}),E(1,"div",15)(2,"div",16)(3,"input",17,18),I4("ngModelChange",function(i){te(e);const o=p();return o6(o.userMessage,i)||(o.userMessage=i),ne(i)}),P(),E(5,"p",19),ot(6),P()(),E(7,"div",20)(8,"button",21),q("click",function(){return te(e),ne(p().sendMessage())}),V(9,"fa-icon",22),P()()(),E(10,"div",23)(11,"p")(12,"strong"),se(13,24),P()()()()}if(2&r){const e=wn(4),n=p();m(3),N4("ngModel",n.userMessage),v("ngModelOptions",fr(4,qht)),m(3),ii("",e.value.length,"/128"),m(3),v("icon",n.faReply)}}let Av=class MR{chatService;connectedUserService;chatId;turn;userMessage="";connected=!1;chat=[];readMessages=0;unreadMessagesText="";showUnreadMessagesButton=!1;visible=!0;faReply=dk;isNearBottom=!0;notYetScrolled=!0;chatSubscription;chatDiv;constructor(t,e){this.chatService=t,this.connectedUserService=e}ngOnInit(){pn(null!=this.chatId&&""!==this.chatId,"No chat to join mentionned"),this.loadChatContent()}ngAfterViewChecked(){this.scrollToBottomIfNeeded()}loadChatContent(){const t=n=>{this.updateMessages(n.flatMap(i=>null==i.data.postedTime?[]:[i.data]))},e=new EC(t,t,()=>{});this.chatSubscription=this.chatService.subscribeToMessages(this.chatId,e)}updateMessages(t){this.chat=this.chat.concat(t);const e=this.chat.length;!0===this.visible&&!0===this.isNearBottom?(this.readMessages=e,this.updateUnreadMessagesText(0),this.scrollToBottom()):this.updateUnreadMessagesText(e-this.readMessages)}updateUnreadMessagesText(t){this.showUnreadMessagesButton=!(!this.visible||!1!==this.isNearBottom),0===t?(this.unreadMessagesText=$localize`no new message`,this.showUnreadMessagesButton=!1):this.unreadMessagesText=1===t?$localize`1 new message`:$localize`${t} new messages`}scrollToBottomIfNeeded(){this.visible&&(this.isNearBottom||this.notYetScrolled)&&this.scrollToBottom()}updateCurrentScrollPosition(){this.isNearBottom=this.chatDiv.nativeElement.scrollTop+this.chatDiv.nativeElement.offsetHeight>this.chatDiv.nativeElement.scrollHeight-10}scrollToBottom(){null!=this.chatDiv&&(this.updateUnreadMessagesText(0),this.scrollTo(this.chatDiv.nativeElement.scrollHeight),this.notYetScrolled=!1)}scrollTo(t){this.chatDiv.nativeElement.scroll({top:t,left:0,behavior:"smooth"})}sendMessage(){var t=this;return M(function*(){const e=t.userMessage;t.userMessage="";const n=t.connectedUserService.user.get().toMinimalUser();yield t.chatService.sendMessage(t.chatId,n,e,t.turn)})()}ngOnDestroy(){this.chatSubscription.unsubscribe()}switchChatVisibility(){!0===this.visible?this.visible=!1:(this.visible=!0,this.updateUnreadMessagesText(0),this.scrollToBottom(),this.readMessages=this.chat.length)}static \u0275fac=function(e){return new(e||MR)(G(J5),G(gr))};static \u0275cmp=Ue({type:MR,selectors:[["app-chat"]],viewQuery:function(e,n){if(1&e&&P3(Fht,5),2&e){let i;hc(i=gc())&&(n.chatDiv=i.first)}},inputs:{chatId:"chatId",turn:"turn"},decls:7,vars:4,consts:()=>{let t,e,n,i;return t=$localize`Hide chat`,e=$localize`Show chat (${"\ufffd0\ufffd"}:INTERPOLATION:)`,n=$localize`Type your message here`,i=$localize`Be polite`,[["id","switchChatVisibilityButton",1,"button","is-primary","is-light","is-fullwidth",3,"click"],[4,"ngIf","ngIfElse"],["showChat",""],[4,"ngIf"],["id","chatForm",3,"onSubmit",4,"ngIf"],t,e,["id","scrollToBottomIndicator","class","notification button is-info is-light is-fullwidth",3,"click",4,"ngIf"],["id","chatDiv",1,"is-fullwidth","block",2,"overflow-y","scroll","max-height","50vh",3,"scroll"],["chatDiv",""],[4,"ngFor","ngForOf"],["id","scrollToBottomIndicator",1,"notification","button","is-info","is-light","is-fullwidth",3,"click"],[1,"chat-sender"],[1,"chat-message"],["id","chatForm",3,"onSubmit"],[1,"field","has-addons","is-fullwidth"],[1,"control","is-expanded"],["id","message","type","text","placeholder",n,"maxlength","128","value","",1,"input",3,"ngModel","ngModelOptions","ngModelChange"],["message",""],[1,"help"],[1,"control"],["type","submit","id","send",1,"button","is-primary",3,"click"],[1,"clickable-icon",3,"icon"],[1,"content","is-small"],i]},template:function(e,n){if(1&e&&(E(0,"div")(1,"button",0),q("click",function(){return n.switchChatVisibility()}),z(2,Uht,2,0,"ng-container",1)(3,Ght,1,1,"ng-template",null,2,In),P(),z(5,Wht,5,2,"div",3)(6,jht,14,5,"form",4),P()),2&e){const i=wn(4);m(2),v("ngIf",n.visible)("ngIfElse",i),m(3),v("ngIf",n.visible),m(),v("ngIf",n.visible)}},dependencies:[Nt,bt,F4,Na,vc,H4,cS,nf,tf,n0,Vht],encapsulation:2})};Av=function(r,t,e,n){var s,i=arguments.length,o=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,e):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,t,e,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(t,e,o):s(t,e))||o);return i>3&&o&&Object.defineProperty(t,e,o),o}([Ae.log],Av);let xse=(()=>{class r{router;currentGameService;messageDisplayer;selectedGame;constructor(e,n,i){this.router=e,this.currentGameService=n,this.messageDisplayer=i}pickGame(e){this.selectedGame=e}navigateToOnlineGameCreation(){var e=this;return M(function*(){const n=e.currentGameService.canUserCreate();n.isSuccess()?yield e.router.navigate(["/play",e.selectedGame]):e.messageDisplayer.criticalMessage(n.getReason())})()}static \u0275fac=function(n){return new(n||r)(G(Qn),G(qo),G(Ut))};static \u0275cmp=Ue({type:r,selectors:[["app-online-game-selection"]],decls:3,vars:1,consts:()=>{let e;return e=$localize`Create an online game`,[[3,"pickGame"],["id","launchGame",1,"button","is-primary","is-fullwidth",3,"disabled","click"],e]},template:function(n,i){1&n&&(E(0,"app-pick-game",0),q("pickGame",function(s){return i.pickGame(s)}),P(),E(1,"button",1),q("click",function(){return i.navigateToOnlineGameCreation()}),se(2,2),P()),2&n&&(m(),v("disabled",!i.selectedGame))},dependencies:[ik],encapsulation:2})}return r})();function Yht(r,t){if(1&r&&(jt(0),ot(1),Zt()),2&r){const e=p().$implicit;m(),Cn(e.data.playerOne.name)}}function Kht(r,t){1&r&&(jt(0),se(1,27),Zt())}function Xht(r,t){if(1&r){const e=he();E(0,"tr",22),q("click",function(){const o=te(e).$implicit;return ne(p(2).joinGame(o))}),E(1,"td",23),ot(2),P(),E(3,"td",23),ot(4),P(),E(5,"td",23),z(6,Yht,2,1,"ng-container",24)(7,Kht,2,0,"ng-template",null,25,In),P(),E(9,"td",26),ot(10),P()()}if(2&r){const e=t.$implicit,n=t.index,i=wn(8);Tn("id","part_",n,""),m(2),Cn(e.data.typeGame),m(2),Cn(e.data.playerZero.name),m(2),v("ngIf",e.data.playerOne)("ngIfElse",i),m(4),Cn(e.data.turn+1)}}function Qht(r,t){if(1&r&&(E(0,"div",13)(1,"div",14)(2,"table",15)(3,"thead")(4,"tr")(5,"th",16),se(6,17),P(),E(7,"th",16),se(8,18),P(),E(9,"th",16),se(10,19),P(),E(11,"th",16),se(12,20),P()()(),E(13,"tbody"),z(14,Xht,11,6,"tr",21),P()()()()),2&r){const e=p();m(14),v("ngForOf",e.activeParts)}}function Jht(r,t){1&r&&(E(0,"div",28),V(1,"app-online-game-selection",29),P())}function egt(r,t){1&r&&(E(0,"div",30)(1,"div",31)(2,"div",32),V(3,"app-chat",33),P()()()),2&r&&(m(3),v("turn",-1))}let sR=class ER{router;messageDisplayer;activePartsService;currentGameService;activeParts=[];activePartsSubscription;currentGameSubscription;currentTab="games";createTabClasses=[];constructor(t,e,n,i){this.router=t,this.messageDisplayer=e,this.activePartsService=n,this.currentGameService=i}ngOnInit(){this.activePartsSubscription=this.activePartsService.subscribeToActiveParts(t=>{this.activeParts=t}),this.currentGameSubscription=this.currentGameService.subscribeToCurrentGame(t=>{this.createTabClasses=[],t.isPresent()&&(this.createTabClasses=["disabled-tab"])})}ngOnDestroy(){this.activePartsSubscription.unsubscribe(),this.currentGameSubscription.unsubscribe()}joinGame(t){var e=this;return M(function*(){const n=t.id,i=t.data.typeGame,s=e.currentGameService.canUserJoin(n,null!=t.data.beginning);s.isSuccess()?yield e.router.navigate(["/play",i,n]):e.messageDisplayer.criticalMessage(s.getReason())})()}selectTab(t){if("create"===t){const e=this.currentGameService.canUserCreate();e.isSuccess()?this.currentTab=t:this.messageDisplayer.criticalMessage(e.getReason())}else this.currentTab=t}static \u0275fac=function(e){return new(e||ER)(G(Qn),G(Ut),G(Dht),G(qo))};static \u0275cmp=Ue({type:ER,selectors:[["app-lobby"]],decls:14,vars:4,consts:()=>{let t,e,n,i,o,s,a,c;return t=$localize`Games`,e=$localize`Create`,n=$localize`Chat`,i=$localize`Game`,o=$localize`First player`,s=$localize`Second player`,a=$localize`Turn`,c=$localize`Waiting for opponent`,[[1,"tabs","is-toggle","is-fullwidth"],["ngClass","if (currentTab === 'games') 'is-active'"],["id","tab-games",3,"click"],t,["ngClass","if (currentTab === 'create') 'is-active'"],["id","tab-create",3,"ngClass","click"],e,["ngClass","if (currentTab === 'chat') 'is-active'"],["id","tab-chat",3,"click"],n,["id","actualGames","class","box",4,"ngIf"],["id","gameCreator","class","box",4,"ngIf"],["id","chatTab","class","columns",4,"ngIf"],["id","actualGames",1,"box"],[1,"table-container"],[1,"table","is-fullwidth","is-hoverable","is-striped"],["scope","col",1,"th"],i,o,s,a,[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"td"],[4,"ngIf","ngIfElse"],["waitingForOpponent",""],[1,"td","turn"],c,["id","gameCreator",1,"box"],["id","online-game-selection"],["id","chatTab",1,"columns"],[1,"column","is-12"],["id","chat",1,"box"],["chatId","server",3,"turn"]]},template:function(e,n){1&e&&(E(0,"div",0)(1,"ul")(2,"li",1)(3,"a",2),q("click",function(){return n.selectTab("games")}),se(4,3),P()(),E(5,"li",4)(6,"a",5),q("click",function(){return n.selectTab("create")}),se(7,6),P()(),E(8,"li",7)(9,"a",8),q("click",function(){return n.selectTab("chat")}),se(10,9),P()()()(),z(11,Qht,15,1,"div",10)(12,Jht,2,0,"div",11)(13,egt,4,1,"div",12)),2&e&&(m(6),v("ngClass",n.createTabClasses),m(5),v("ngIf","games"===n.currentTab),m(),v("ngIf","create"===n.currentTab),m(),v("ngIf","chat"===n.currentTab))},dependencies:[zt,Nt,bt,Av,xse],encapsulation:2})};sR=function(r,t,e,n){var s,i=arguments.length,o=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,e):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,t,e,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(t,e,o):s(t,e))||o);return i>3&&o&&Object.defineProperty(t,e,o),o}([Ae.log],sR);let tgt=(()=>{class r{constructor(){}static \u0275fac=function(n){return new(n||r)};static \u0275cmp=Ue({type:r,selectors:[["app-account"]],decls:11,vars:0,consts:()=>{let e,n,i;return e=$localize`User settings`,n=$localize`If you forgot your password or want to change it, click on the following button:`,i=$localize`Reset password`,[[1,"hero-body"],[1,"title"],e,[1,"box"],[1,"block","level-left"],[1,"level-item"],n,["id","reset","routerLink","/reset-password",1,"button","is-primary","level-item","is-small"],i]},template:function(n,i){1&n&&(E(0,"div",0)(1,"p",1),se(2,2),P()(),E(3,"div",3)(4,"p",1),ot(5,"Resetting password"),P(),E(6,"div",4)(7,"p",5),se(8,6),P(),E(9,"button",7),se(10,8),P()()())},dependencies:[Oc],encapsulation:2})}return r})(),Lse=(()=>{class r{route;message;constructor(e){this.route=e,this.message=e.snapshot.paramMap.get("message")??$localize`This page does not exist.`}static \u0275fac=function(n){return new(n||r)(G(ao))};static \u0275cmp=Ue({type:r,selectors:[["app-not-found"]],decls:5,vars:1,consts:()=>{let e;return e=$localize`Not found`,[[1,"message","is-danger"],[1,"message-header"],e,[1,"message-body"]]},template:function(n,i){1&n&&(E(0,"div",0)(1,"div",1),se(2,2),P(),E(3,"div",3),ot(4),P()()),2&n&&(m(4),Cn(i.message))},encapsulation:2})}return r})();new Error("timeout while waiting for mutex to become available"),new Error("mutex already locked");const igt=new Error("request for lock canceled");class sgt{constructor(t,e=igt){this._value=t,this._cancelError=e,this._weightedQueues=[],this._weightedWaiters=[]}acquire(t=1){if(t<=0)throw new Error(`invalid weight ${t}: must be positive`);return new Promise((e,n)=>{this._weightedQueues[t-1]||(this._weightedQueues[t-1]=[]),this._weightedQueues[t-1].push({resolve:e,reject:n}),this._dispatch()})}runExclusive(t,e=1){return function(r,t,e,n){return new(e||(e=Promise))(function(o,s){function a(u){try{l(n.next(u))}catch(f){s(f)}}function c(u){try{l(n.throw(u))}catch(f){s(f)}}function l(u){u.done?o(u.value):function i(o){return o instanceof e?o:new e(function(s){s(o)})}(u.value).then(a,c)}l((n=n.apply(r,t||[])).next())})}(this,void 0,void 0,function*(){const[n,i]=yield this.acquire(e);try{return yield t(n)}finally{i()}})}waitForUnlock(t=1){if(t<=0)throw new Error(`invalid weight ${t}: must be positive`);return new Promise(e=>{this._weightedWaiters[t-1]||(this._weightedWaiters[t-1]=[]),this._weightedWaiters[t-1].push(e),this._dispatch()})}isLocked(){return this._value<=0}getValue(){return this._value}setValue(t){this._value=t,this._dispatch()}release(t=1){if(t<=0)throw new Error(`invalid weight ${t}: must be positive`);this._value+=t,this._dispatch()}cancel(){this._weightedQueues.forEach(t=>t.forEach(e=>e.reject(this._cancelError))),this._weightedQueues=[]}_dispatch(){var t;for(let e=this._value;e>0;e--){const n=null===(t=this._weightedQueues[e-1])||void 0===t?void 0:t.shift();if(!n)continue;const i=this._value,o=e;this._value-=e,e=this._value+1,n.resolve([i,this._newReleaser(o)])}this._drainUnlockWaiters()}_newReleaser(t){let e=!1;return()=>{e||(e=!0,this.release(t))}}_drainUnlockWaiters(){for(let t=this._value;t>0;t--)this._weightedWaiters[t-1]&&(this._weightedWaiters[t-1].forEach(e=>e()),this._weightedWaiters[t-1]=[])}}class cgt{constructor(t){this._semaphore=new sgt(1,t)}acquire(){return function(r,t,e,n){return new(e||(e=Promise))(function(o,s){function a(u){try{l(n.next(u))}catch(f){s(f)}}function c(u){try{l(n.throw(u))}catch(f){s(f)}}function l(u){u.done?o(u.value):function i(o){return o instanceof e?o:new e(function(s){s(o)})}(u.value).then(a,c)}l((n=n.apply(r,t||[])).next())})}(this,void 0,void 0,function*(){const[,t]=yield this._semaphore.acquire();return t})}runExclusive(t){return this._semaphore.runExclusive(()=>t())}isLocked(){return this._semaphore.isLocked()}waitForUnlock(){return this._semaphore.waitForUnlock()}release(){this._semaphore.isLocked()&&this._semaphore.release()}cancel(){return this._semaphore.cancel()}}let Dse=(()=>{class r{connectedUserService;static requestInfos={TakeBack:{requestType:"TakeBack",textForRequest:()=>$localize`Ask to take back one move`,textForReply:()=>$localize`Your opponent is asking for a take back.`,name:()=>$localize`take back`,icon:Lk},Draw:{requestType:"Draw",textForRequest:()=>$localize`Propose a draw`,textForReply:()=>$localize`Your opponent is proposing a draw.`,name:()=>$localize`draw`,icon:tne},Rematch:{requestType:"Rematch",textForRequest:()=>$localize`Propose a rematch`,textForReply:()=>$localize`Your opponent is proposing a rematch.`,name:()=>$localize`rematch`,icon:zne}};requestAwaitingReply=h.empty();lastDeniedRequest=h.empty();forbiddenRequests=new st;constructor(e){this.connectedUserService=e}onGameStart(){this.requestAwaitingReply=h.empty(),this.lastDeniedRequest=h.empty(),this.forbiddenRequests=new st}onReceivedMove(){this.forbiddenRequests=new st,this.lastDeniedRequest=h.empty()}onReceivedRequest(e){L.assert(this.requestAwaitingReply.isAbsent(),"Should not receive two requests in a row!"),this.requestAwaitingReply=h.of(e)}onReceivedReply(e){var n=this;return M(function*(){switch(n.requestAwaitingReply=h.empty(),e.reply){case"Accept":return!0;case"Reject":const i=n.connectedUserService.user.get().toMinimalUser();return e.user.id!==i.id&&(n.lastDeniedRequest=h.of(e.requestType),n.forbiddenRequests.add(e.requestType)),!1}})()}canMakeRequest(e){return!(this.requestAwaitingReply.isPresent()||this.forbiddenRequests.contains(e))}getUnrespondedRequestFrom(e){return this.requestAwaitingReply.isPresent()&&this.requestAwaitingReply.get().user.id===e.id?h.of(this.requestAwaitingReply.get().requestType):h.empty()}getCurrentRequest(){return this.requestAwaitingReply}deniedRequest(){return this.lastDeniedRequest}static \u0275fac=function(n){return new(n||r)(ze(gr))};static \u0275prov=xe({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})(),ugt=(()=>{class r{turnClocks;globalClocks;allClocks;configRoom=h.empty();players=[h.empty(),h.empty()];takenGlobalTime=we.of(0,0);extraGlobalTime=we.of(0,0);availableTurnTime=we.of(0,0);lastMoveStartTimestamp=h.empty();setClocks(e,n){this.turnClocks=e,this.globalClocks=n,this.allClocks=e.concat(n)}onGameStart(e,n){this.configRoom=h.of(e),this.players=n;for(const i of O.PLAYERS)this.takenGlobalTime.put(i,0),this.extraGlobalTime.put(i,0),this.availableTurnTime.put(i,this.getMoveDurationInMs()),this.globalClocks[i.getValue()].setDuration(this.getPartDurationInMs()),this.turnClocks[i.getValue()].setDuration(this.getMoveDurationInMs());for(const i of this.allClocks)i.start(),i.pause()}getPartDurationInMs(){return 1e3*this.configRoom.get().totalPartDuration}getMoveDurationInMs(){return 1e3*this.configRoom.get().maximalMoveDuration}onReceivedAction(e){switch(e.action){case"AddTurnTime":this.addTurnTime(this.playerOfMinimalUser(e.user));break;case"AddGlobalTime":this.addGlobalTime(this.playerOfMinimalUser(e.user));break;case"StartGame":this.lastMoveStartTimestamp=h.of(e.time);break;case"EndGame":this.onGameEnd()}}playerOfMinimalUser(e){return this.players[0].equalsValue(e)?O.ZERO:(L.assert(this.players[1].equalsValue(e),"MinimalUser should match player one"),O.ONE)}onReceivedMove(e){const n=this.playerOfMinimalUser(e.user),i=e.time,o=this.getMillisecondsElapsedSinceLastMoveStart(i);this.lastMoveStartTimestamp=h.of(i),this.takenGlobalTime.add(n,o),this.availableTurnTime.add(n,-o);const s=n.getOpponent();this.availableTurnTime.put(s,this.getMoveDurationInMs());const a=this.takenGlobalTime.get(s),c=this.getPartDurationInMs()-a;this.globalClocks[s.getValue()].changeDuration(c)}getMillisecondsElapsedSinceLastMoveStart(e){return ZQ(this.lastMoveStartTimestamp.get(),e)}onGameEnd(){for(const e of this.allClocks)e.isStarted()&&e.stop();this.updateClocks()}beforeEventsBatch(e){!1===e&&this.pauseAllClocks()}afterEventsBatch(e,n,i){if(this.updateClocks(),!1===e){const o=this.getMillisecondsElapsedSinceLastMoveStart(i);this.turnClocks[n.getValue()].subtract(o),this.globalClocks[n.getValue()].subtract(o),this.resumeClocks(n)}}resumeClocks(e){this.turnClocks[e.getValue()].resume(),this.globalClocks[e.getValue()].resume()}addTurnTime(e){this.availableTurnTime.add(e.getOpponent(),3e4)}addGlobalTime(e){this.extraGlobalTime.add(e.getOpponent(),3e5)}updateClocks(){for(const e of O.PLAYERS){this.turnClocks[e.getValue()].changeDuration(this.availableTurnTime.get(e));const n=this.takenGlobalTime.get(e),i=this.getPartDurationInMs()+this.extraGlobalTime.get(e)-n;this.globalClocks[e.getValue()].changeDuration(i)}}pauseAllClocks(){for(const e of this.allClocks)!1===e.isIdle()&&e.pause()}static \u0275fac=function(n){return new(n||r)};static \u0275prov=xe({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();function fgt(r,t){if(1&r&&(E(0,"option",12),ot(1),P()),2&r){const e=t.$implicit;v("value",e.name()),m(),ii(" ",e.name()," ")}}function dgt(r,t){if(1&r&&(E(0,"div",24)(1,"div",25),ot(2),P()()),2&r){const e=p(2).$implicit,n=p(2);m(),Tn("id","",e,"_number_config_error"),m(),Cn(n.getErrorMessage(e))}}function hgt(r,t){if(1&r&&(E(0,"div",17)(1,"div",18)(2,"div",19),V(3,"input",20),E(4,"span",21),V(5,"i",22),P()(),z(6,dgt,3,2,"div",23),P()()),2&r){const e=p().$implicit,n=p(2);m(3),Tn("id","",e,"_number_config_input"),Fg("placeholder",n.rulesConfigDescription.getI18nName(e)),v("formControlName",e),m(3),v("ngIf",!1===n.isValid(e))}}function ggt(r,t){if(1&r&&(E(0,"div",17)(1,"div",18)(2,"div",26),V(3,"input",27),P()()()),2&r){const e=p().$implicit,n=p(2);m(3),Tn("id","",e,"_boolean_config_input"),Fg("placeholder",n.rulesConfigDescription.getI18nName(e)),v("formControlName",e)}}function pgt(r,t){if(1&r&&(E(0,"div",13)(1,"div",14)(2,"label",15),ot(3),P()(),z(4,hgt,7,4,"div",16)(5,ggt,4,3,"div",16),P()),2&r){const e=t.$implicit,n=p(2);Tn("id","",e,"_config"),m(3),Cn(n.rulesConfigDescription.getI18nName(e)),m(),v("ngIf",n.isNumber(e)),m(),v("ngIf",n.isBoolean(e))}}function mgt(r,t){1&r&&V(0,"app-demo-card",28),2&r&&v("demoNodeInfo",p(2).getConfigDemo())}function _gt(r,t){if(1&r){const e=he();E(0,"div")(1,"p",1),se(2,2),P(),E(3,"div",3)(4,"select",4),q("change",function(i){return te(e),ne(p().onChange(i))}),E(5,"option",5),ot(6),P(),z(7,fgt,2,2,"option",6),E(8,"option",7),se(9,8),P()()(),E(10,"form",9)(11,"fieldset"),z(12,pgt,6,4,"div",10),P()(),z(13,mgt,1,1,"app-demo-card",11),P()}if(2&r){const e=p();m(2),Bn(e.gameName),Yn(2),m(2),v("disabled",!1===e.userIsCreator),m(),v("value",e.rulesConfigDescription.getDefaultConfig().name()),m(),ii(" ",e.rulesConfigDescription.getDefaultConfig().name()," "),m(),v("ngForOf",e.rulesConfigDescription.getNonDefaultStandardConfigs()),m(3),Tn("id","",e.getChosenConfigName(),"_values"),v("formGroup",e.rulesConfigForm),m(2),v("ngForOf",e.getFields()),m(),v("ngIf",void 0!==e.getConfigDemo())}}let Vse=(()=>{class r extends BQ{cdr;stateProvider;rulesConfigDescriptionOptional;rulesConfigDescription;rulesConfigToDisplay;userIsCreator;updateCallback=new i1;configDemo;rulesConfigForm=new yc({});gameName;chosenConfigName="";constructor(e,n){super(e),this.cdr=n}getChosenConfigName(){return this.chosenConfigName}ngOnInit(){if(this.assertParamsAreCoherent(),this.gameName=this.getGameName(),!this.isCustomisable())return this.updateCallback.emit(h.of({}));{const e=this.rulesConfigDescription.getDefaultConfig();if(this.setChosenConfig(e.name()),this.userIsCreator)this.setConfigDemo(e.config);else{const n=L.getNonNullable(this.rulesConfigToDisplay);this.setConfigDemo(n)}}}setConfigDemo(e){if(this.stateProvider.isPresent()){const n=this.stateProvider.get(),i=new ms(n(h.of(e)));this.configDemo={click:h.empty(),name:this.gameName,node:i},this.cdr.detectChanges()}}getConfigDemo(){return this.configDemo}generateForm(e,n){const i={};Object.keys(e).forEach(o=>{const s=this.getRulesConfigDescriptionValue(o,e[o]);i[o]=this.getFormControl(s,n)}),this.rulesConfigForm=new yc(i)}assertParamsAreCoherent(){!1===this.userIsCreator&&L.assert(null!=this.rulesConfigToDisplay,"Config should be provided to non-creator in RulesConfigurationComponent")}getRulesConfigDescriptionValue(e,n){return this.userIsCreator?n:L.getNonNullable(this.rulesConfigToDisplay)[e]}getFormControl(e,n){const i=new ko(e);return!1===n&&i.disable(),i.valueChanges.subscribe(()=>{this.onUpdate()}),i}onUpdate(){L.assert(this.userIsCreator,"Only creator should be able to modify rules config"),L.assert("Custom"===this.chosenConfigName,"Only Customifiable config should be modified!");const e={},n=this.rulesConfigDescription.getFields();for(const i of n){if(!this.isValid(i))return void this.updateCallback.emit(h.empty());e[i]=this.rulesConfigForm.controls[i].value}this.setConfigDemo(e),this.updateCallback.emit(h.of(e))}isNumber(e){return"number"==typeof this.rulesConfigDescription.getDefaultConfig().config[e]}isBoolean(e){return"boolean"==typeof this.rulesConfigDescription.getDefaultConfig().config[e]}isValid(e){const i=this.rulesConfigDescription.getDefaultConfig().config[e];if("number"==typeof i){const o=this.rulesConfigForm.controls[e].value;return this.rulesConfigDescription.getValidator(e)(o).isSuccess()}return L.expectToBe(typeof i,"boolean"),!0}getErrorMessage(e){const n=this.rulesConfigForm.controls[e].value;return this.rulesConfigDescription.getValidator(e)(n).getReason()}getFields(){return this.rulesConfigDescription.getFields()}onChange(e){this.setChosenConfig(e.target.value)}setChosenConfig(e){let n;this.chosenConfigName=e,"Custom"===this.chosenConfigName?(n=this.rulesConfigDescription.getDefaultConfig().config,this.generateForm(n,this.userIsCreator)):(n=this.rulesConfigDescription.getConfig(this.chosenConfigName),this.generateForm(n,!1),this.updateCallback.emit(h.of(n))),this.setConfigDemo(n)}isCustomisable(){return!this.rulesConfigDescriptionOptional.isAbsent()&&(L.assert(this.rulesConfigDescriptionOptional.get().getFields().length>0,"If rulesConfigDescriptionOptional is present it should have fields !"),this.rulesConfigDescription=this.rulesConfigDescriptionOptional.get(),!0)}static \u0275fac=function(n){return new(n||r)(G(ao),G(Vs))};static \u0275cmp=Ue({type:r,selectors:[["app-rules-configuration"]],inputs:{stateProvider:"stateProvider",rulesConfigDescriptionOptional:"rulesConfigDescriptionOptional",rulesConfigToDisplay:"rulesConfigToDisplay",userIsCreator:"userIsCreator"},outputs:{updateCallback:"updateCallback"},features:[$e],decls:1,vars:1,consts:()=>{let e,n;return e=$localize`Configuration of your ${"\ufffd0\ufffd"}:INTERPOLATION: game`,n=$localize`Custom`,[[4,"ngIf"],[1,"title"],e,[1,"select","is-primary","is-fullwidth"],["id","ruleSelect",3,"disabled","change"],["selected","",3,"value"],[3,"value",4,"ngFor","ngForOf"],["value","Custom"],n,[3,"formGroup","id"],["class","field is-horizontal",3,"id",4,"ngFor","ngForOf"],["id","demoCard",3,"demoNodeInfo",4,"ngIf"],[3,"value"],[1,"field","is-horizontal",3,"id"],[1,"field-label","is-normal"],[1,"label"],["class","field-body",4,"ngIf"],[1,"field-body"],[1,"field"],[1,"control","has-icons-right"],["type","number","required","",1,"input",3,"id","formControlName","placeholder"],[1,"icon","is-small","is-right"],[1,"fas","fa-exclamation-triangle"],["class","message is-danger","role","alert",4,"ngIf"],["role","alert",1,"message","is-danger"],[1,"message-header",3,"id"],[1,"control"],["type","checkbox","required","",1,"checkbox",3,"id","formControlName","placeholder"],["id","demoCard",3,"demoNodeInfo"]]},template:function(n,i){1&n&&z(0,_gt,14,9,"div",0),2&n&&v("ngIf",i.isCustomisable())},dependencies:[Nt,bt,F4,N8,I8,Na,tS,Cp,vc,H4,G4,aS,U4,u6,kse],encapsulation:2})}return r})(),Cgt=(()=>{class r{transform(e){const n=e%60,i=(e-n)%3600/60,o=(e-60*i-n)/3600,s=[];if(o>1?s.push($localize`${o} hours`):1===o&&s.push($localize`1 hour`),i>1?s.push($localize`${i} minutes`):1===i&&s.push($localize`1 minute`),n>1?s.push($localize`${n} seconds`):1===n&&s.push($localize`1 second`),0===s.length)return $localize`0 seconds`;if(1===s.length)return s[0];{const a=s.slice(0,-1).join(", "),c=s.slice(-1)[0];return $localize`${a} and ${c}`}}static \u0275fac=function(n){return new(n||r)};static \u0275pipe=O2({name:"humanDuration",type:r,pure:!0})}return r})();var Zd;const ygt=["rulesConfigurationComponent"];function Mgt(r,t){if(1&r&&(jt(0),ot(1),Zt()),2&r){const e=p(3);m(),Cn(e.viewInfo.chosenOpponent)}}function Egt(r,t){1&r&&se(0,45)}function Pgt(r,t){if(1&r&&(E(0,"div",46)(1,"div",8)(2,"label",47),jt(3),se(4,48),Zt(),E(5,"output"),ot(6),wa(7,"humanDuration"),P()(),E(8,"div",37),V(9,"input",49),P()(),E(10,"div",8)(11,"label",50),No(12,51),V(13,"output"),wa(14,"humanDuration"),Io(),P(),E(15,"div",37),V(16,"input",52),P()()()),2&r){const e=p(3);m(6),Cn(pc(7,2,e.viewInfo.maximalMoveDuration||0)),m(8),Bn(pc(14,4,e.viewInfo.totalPartDuration||0)),Yn(12)}}function Sgt(r,t){1&r&&(E(0,"div"),No(1,53),V(2,"br"),Io(),P())}function Ogt(r,t){1&r&&(E(0,"button",65),se(1,66),P())}function Tgt(r,t){if(1&r){const e=he();E(0,"tr",61),q("click",function(){const o=te(e).$implicit;return ne(p(4).selectOpponent(o))}),E(1,"td",62),ot(2),P(),E(3,"td",63),z(4,Ogt,2,0,"button",64),P()()}if(2&r){const e=t.$implicit,n=p(4);Tn("id","presenceOf_",e,""),v("ngClass",n.viewInfo.candidateClasses[e]),m(),v("id",n.viewInfo.chosenOpponent===e?"selected_"+e:"candidate_"+e),m(),Cn(e),m(2),v("ngIf",n.viewInfo.chosenOpponent!==e)}}function wgt(r,t){if(1&r&&(jt(0),se(1,54),Zt(),E(2,"div",55)(3,"table",56)(4,"thead")(5,"tr")(6,"th",57),se(7,58),P(),E(8,"th",57),se(9,59),P()()(),E(10,"tbody"),z(11,Tgt,5,5,"tr",60),P()()()),2&r){const e=p(3);m(11),v("ngForOf",e.viewInfo.candidates)}}function bgt(r,t){if(1&r){const e=he();E(0,"button",67),q("click",function(){return te(e),ne(p(3).changeConfig())}),se(1,68),P()}}function Agt(r,t){if(1&r){const e=he();E(0,"div")(1,"h1",4),se(2,5),P(),E(3,"form",6)(4,"fieldset",7)(5,"div",8)(6,"label",9),se(7,10),P(),E(8,"div",11)(9,"button",12),q("click",function(){return te(e),ne(p(2).selectFirstPlayer("RANDOM"))}),se(10,13),P(),E(11,"button",14),q("click",function(){return te(e),ne(p(2).selectFirstPlayer("CREATOR"))}),se(12,15),P(),E(13,"button",16),q("click",function(){return te(e),ne(p(2).selectFirstPlayer("CHOSEN_PLAYER"))}),z(14,Mgt,2,1,"ng-container",17)(15,Egt,1,0,"ng-template",null,18,In),P()()(),E(17,"div",8)(18,"label",9),se(19,19),P(),E(20,"div",11)(21,"div",20),q("click",function(){return te(e),ne(p(2).selectPartType("STANDARD"))}),E(22,"div",21)(23,"span"),se(24,22),P()(),E(25,"div",23)(26,"div",24)(27,"div",25)(28,"p"),jt(29),se(30,26),Zt(),E(31,"strong"),ot(32),wa(33,"humanDuration"),P(),V(34,"br"),jt(35),No(36,27),V(37,"strong"),wa(38,"humanDuration"),Io(),Zt(),P()()()()(),E(39,"div",28),q("click",function(){return te(e),ne(p(2).selectPartType("BLITZ"))}),E(40,"div",21)(41,"span"),se(42,29),P()(),E(43,"div",23)(44,"div",24)(45,"div",25)(46,"p"),jt(47),se(48,30),Zt(),E(49,"strong"),ot(50),wa(51,"humanDuration"),P(),V(52,"br"),jt(53),No(54,31),V(55,"strong"),wa(56,"humanDuration"),Io(),Zt(),P()()()()(),E(57,"button",32),q("click",function(){return te(e),ne(p(2).selectPartType("CUSTOM"))}),se(58,33),P()()(),z(59,Pgt,17,6,"div",34),E(60,"div",8)(61,"label",35),se(62,36),P(),E(63,"div",37),z(64,Sgt,3,0,"div",17)(65,wgt,12,1,"ng-template",null,38,In),P()(),E(67,"app-rules-configuration",39),q("updateCallback",function(i){return te(e),ne(p(2).saveRulesConfig(i))}),P()(),E(68,"div",8)(69,"div",11)(70,"button",40),q("click",function(){return te(e),ne(p(2).proposeConfig())}),se(71,41),P(),z(72,bgt,2,0,"button",42),E(73,"button",43),q("click",function(){return te(e),ne(p(2).cancelGameCreation())}),se(74,44),P()()()()()}if(2&r){const e=wn(16),n=wn(66),i=p(2);m(3),v("formGroup",i.configFormGroup),m(),v("disabled",!i.viewInfo.canEditConfig),m(5),v("ngClass",i.viewInfo.firstPlayerClasses.RANDOM),m(2),v("ngClass",i.viewInfo.firstPlayerClasses.CREATOR),m(2),v("ngClass",i.viewInfo.firstPlayerClasses.CHOSEN_PLAYER),m(),v("ngIf",i.viewInfo.chosenOpponent)("ngIfElse",e),m(7),v("ngClass",i.viewInfo.partTypeClasses.STANDARD),m(11),Cn(pc(33,22,i.partType.NORMAL_MOVE_DURATION)),m(6),Bn(pc(38,24,i.partType.NORMAL_PART_DURATION)),Yn(36),m(),v("ngClass",i.viewInfo.partTypeClasses.BLITZ),m(11),Cn(pc(51,26,i.partType.BLITZ_MOVE_DURATION)),m(6),Bn(pc(56,28,i.partType.BLITZ_PART_DURATION)),Yn(54),m(),v("ngClass",i.viewInfo.partTypeClasses.CUSTOM),m(2),v("ngIf",i.viewInfo.showCustomTime),m(5),v("ngIf",0===i.viewInfo.candidates.length)("ngIfElse",n),m(3),v("stateProvider",i.getStateProvider())("rulesConfigDescriptionOptional",i.rulesConfigDescription)("userIsCreator",!0),m(3),v("disabled",!(i.viewInfo.canProposeConfig&&i.rulesConfig.isPresent())),m(2),v("ngIf",i.viewInfo.canReviewConfig)}}function Ngt(r,t){if(1&r&&(E(0,"div",75)(1,"p"),No(2,76),V(3,"br"),Io(),P()()),2&r){const e=p(3);m(3),Bn(e.viewInfo.creator),Yn(2)}}function Igt(r,t){if(1&r&&(E(0,"span"),se(1,83),P()),2&r){const e=p(4);m(),Bn(e.viewInfo.creator),Yn(1)}}function kgt(r,t){1&r&&(E(0,"span"),se(1,84),P())}function Rgt(r,t){1&r&&(E(0,"span"),se(1,85),P())}function xgt(r,t){if(1&r){const e=he();E(0,"div",75)(1,"p"),se(2,77),P(),E(3,"ul")(4,"li"),z(5,Igt,2,1,"span",2)(6,kgt,2,0,"span",2)(7,Rgt,2,0,"span",2),P(),E(8,"li"),No(9,78),V(10,"strong"),wa(11,"humanDuration"),Io(),P(),E(12,"li"),No(13,79),V(14,"strong"),wa(15,"humanDuration"),Io(),P()(),V(16,"app-rules-configuration",80),E(17,"button",81),q("click",function(){return te(e),ne(p(3).acceptConfig())}),se(18,82),P()()}if(2&r){const e=p(3);m(2),Bn(e.viewInfo.creator)(e.viewInfo.partTypeName),Yn(2),m(3),v("ngIf","CREATOR"===e.viewInfo.firstPlayer),m(),v("ngIf","CHOSEN_PLAYER"===e.viewInfo.firstPlayer),m(),v("ngIf","RANDOM"===e.viewInfo.firstPlayer),m(4),Bn(pc(11,11,e.viewInfo.maximalMoveDuration||0)),Yn(9),m(4),Bn(pc(15,13,e.viewInfo.totalPartDuration||0)),Yn(13),m(),v("rulesConfigDescriptionOptional",e.rulesConfigDescription)("stateProvider",e.getStateProvider())("userIsCreator",!1)("rulesConfigToDisplay",null==e.currentConfigRoom?null:e.currentConfigRoom.rulesConfig)}}function Lgt(r,t){if(1&r&&(E(0,"div")(1,"div",69)(2,"div",70)(3,"p"),se(4,71),P()(),E(5,"div",72),z(6,Ngt,4,1,"div",73)(7,xgt,19,15,"ng-template",null,74,In),P()()()),2&r){const e=wn(8),n=p(2);m(6),v("ngIf",n.viewInfo.creatorIsModifyingConfig)("ngIfElse",e)}}function zgt(r,t){if(1&r&&(jt(0),se(1,88),Zt()),2&r){const e=p(3);m(),Bn(e.viewInfo.creator),Yn(1)}}function Dgt(r,t){if(1&r&&se(0,89),2&r){const e=p(3);Bn(e.viewInfo.creator)(e.viewInfo.chosenOpponent),Yn(0)}}function Vgt(r,t){if(1&r&&(E(0,"div",69)(1,"div",70)(2,"p"),se(3,86),P()(),E(4,"div",72)(5,"p"),z(6,zgt,2,1,"ng-container",17)(7,Dgt,1,2,"ng-template",null,87,In),P()()()),2&r){const e=wn(8),n=p(2);m(6),v("ngIf",n.viewInfo.creatorIsModifyingConfig)("ngIfElse",e)}}function Hgt(r,t){if(1&r&&(E(0,"div",1),z(1,Agt,75,30,"div",2)(2,Lgt,9,2,"div",2)(3,Vgt,9,2,"div",3),P()),2&r){const e=p();m(),v("ngIf",e.viewInfo.userIsCreator),m(),v("ngIf",e.viewInfo.userIsChosenOpponent),m(),v("ngIf",e.viewInfo.userIsObserver)}}let aR=class PR{static#e=Zd=this;router;activatedRoute;connectedUserService;currentGameService;gameService;configRoomService;chatService;userService;formBuilder;messageDisplayer;static TOKEN_INTERVAL=5e3;static TOKEN_TIMEOUT=1e4;partType=Ui;partId;rulesConfigDescription;gameStartNotification=new i1;rulesConfigurationComponent;gameStarted=!1;viewInfo={userIsCreator:!1,userIsChosenOpponent:!1,userIsObserver:!1,partType:"STANDARD",partTypeClasses:{STANDARD:["is-selected","is-primary"],BLITZ:[],CUSTOM:[]},firstPlayer:"RANDOM",firstPlayerClasses:{CREATOR:[],RANDOM:["is-selected","is-primary"],CHOSEN_PLAYER:[]},candidateClasses:{},candidates:[]};currentConfigRoom=null;candidates=[];ngUnsubscribe=new xs;allUserInterval=h.empty();ownTokenInterval=h.empty();lastToken;selfSubscription=new cn;configRoomSubscription=cn.EMPTY;candidatesSubscription=cn.EMPTY;configFormGroup;allDocDeleted=!1;rulesConfig=h.empty();constructor(t,e,n,i,o,s,a,c,l,u){this.router=t,this.activatedRoute=e,this.connectedUserService=n,this.currentGameService=i,this.gameService=o,this.configRoomService=s,this.chatService=a,this.userService=c,this.formBuilder=l,this.messageDisplayer=u}ngOnInit(){var t=this;return M(function*(){t.checkInputs(),t.createForms();const e=yield t.configRoomService.joinGame(t.partId);if(e.isFailure()){const n=e.getReason();t.messageDisplayer.criticalMessage(n)}else yield t.startSendingPresenceTokens(),t.subscribeToConfigRoomDoc(),t.subscribeToFormElements()})()}checkInputs(){const t=this.connectedUserService.user;L.assert(t.isPresent(),"PartCreationComponent should not be called without connected user"),L.assert(t.get()!==o0.NOT_CONNECTED,"PartCreationComponent should not be created with an empty userName"),L.assert(""!==this.partId,"PartCreationComponent should not be created with an empty partId")}createForms(){this.configFormGroup=this.formBuilder.group({firstPlayer:[f2.RANDOM.value,Y7.required],maximalMoveDuration:[Ui.NORMAL_MOVE_DURATION,Y7.required],partType:["STANDARD",Y7.required],totalPartDuration:[Ui.NORMAL_PART_DURATION,Y7.required],chosenOpponent:["",Y7.required]})}updateUserDocWithCurrentGame(t){const e=this.getUserRoleInPart(t),n={id:this.partId,opponent:this.getOpponent(t),typeGame:this.getGameUrlName(),role:e};return this.currentGameService.updateCurrentGame(n)}getUserRoleInPart(t){const e=this.connectedUserService.user.get().id;return e===t.creator.id?"Creator":e===t.chosenOpponent?.id?"ChosenOpponent":"Candidate"}getOpponent(t){let e=null;return e=this.connectedUserService.user.get().id===t.creator.id?t.chosenOpponent:t.creator,e}subscribeToConfigRoomDoc(){var t=this;const e=function(){var i=M(function*(o){yield t.onCandidatesUpdate(o)});return function(s){return i.apply(this,arguments)}}(),n=function(){var i=M(function*(o){yield t.onCurrentConfigRoomUpdate(o),o.isPresent()&&t.candidatesSubscription===cn.EMPTY&&(t.candidatesSubscription=t.configRoomService.subscribeToCandidates(t.partId,e))});return function(s){return i.apply(this,arguments)}}();this.configRoomSubscription=this.configRoomService.subscribeToChanges(this.partId,n)}getForm(t){return L.getNonNullable(this.configFormGroup.get(t))}subscribeToFormElements(){this.getForm("chosenOpponent").valueChanges.pipe(z8(this.ngUnsubscribe)).subscribe(t=>{void 0!==this.viewInfo.chosenOpponent&&(this.viewInfo.candidateClasses[this.viewInfo.chosenOpponent]=[]),this.viewInfo.candidateClasses[t]=["is-selected"],this.viewInfo.chosenOpponent=t;const e=L.getNonNullable(this.currentConfigRoom).partStatus;this.viewInfo.canProposeConfig=e!==d2.CONFIG_PROPOSED.value&&""!==t}),this.getForm("partType").valueChanges.pipe(z8(this.ngUnsubscribe)).subscribe(t=>{this.viewInfo.partTypeClasses[this.viewInfo.partType]=[],this.viewInfo.partTypeClasses[t]=["is-primary","is-selected"],this.viewInfo.partType=t,this.viewInfo.showCustomTime="CUSTOM"===t}),this.getForm("maximalMoveDuration").valueChanges.pipe(z8(this.ngUnsubscribe)).subscribe(t=>{this.viewInfo.maximalMoveDuration=t}),this.getForm("totalPartDuration").valueChanges.pipe(z8(this.ngUnsubscribe)).subscribe(t=>{this.viewInfo.totalPartDuration=t}),this.getForm("firstPlayer").valueChanges.pipe(z8(this.ngUnsubscribe)).subscribe(t=>{this.viewInfo.firstPlayerClasses[this.viewInfo.firstPlayer]=[],this.viewInfo.firstPlayerClasses[t]=["is-primary","is-selected"],this.viewInfo.firstPlayer=t})}updateViewInfo(t){const e=this.connectedUserService.user.get();switch(this.viewInfo.canReviewConfig=t.partStatus===d2.CONFIG_PROPOSED.value,this.viewInfo.canEditConfig=t.partStatus!==d2.CONFIG_PROPOSED.value,this.viewInfo.userIsCreator=this.userIsCreator(t),this.viewInfo.userIsChosenOpponent=e.id===t.chosenOpponent?.id,this.viewInfo.userIsObserver=!1===this.viewInfo.userIsChosenOpponent&&!1===this.viewInfo.userIsCreator,this.viewInfo.creatorIsModifyingConfig=t.partStatus!==d2.CONFIG_PROPOSED.value,this.viewInfo.showCustomTime="CUSTOM"===this.getForm("partType").value,this.viewInfo.creator=t.creator.name,this.viewInfo.candidates=this.candidates.map(n=>n.name),this.userIsCreator(t)?this.setDataForCreator(t):(this.viewInfo.maximalMoveDuration=t.maximalMoveDuration,this.viewInfo.totalPartDuration=t.totalPartDuration,this.viewInfo.partType=t.partType,this.viewInfo.chosenOpponent=t.chosenOpponent?.name,this.viewInfo.firstPlayer=t.firstPlayer),t.partType){case"CUSTOM":this.viewInfo.partTypeName=$localize`custom`;break;case"BLITZ":this.viewInfo.partTypeName=$localize`blitz`;break;case"STANDARD":this.viewInfo.partTypeName=$localize`standard`}}setDataForCreator(t){this.viewInfo.maximalMoveDuration=this.viewInfo.maximalMoveDuration??t.maximalMoveDuration,this.viewInfo.totalPartDuration=this.viewInfo.totalPartDuration??t.totalPartDuration;let e=this.viewInfo.chosenOpponent;null==e||""===e?e=t.chosenOpponent?.name??"":!1===this.candidates.some(i=>i.name===e)&&(e=""),this.getForm("chosenOpponent").setValue(e)}selectFirstPlayer(t){this.getForm("firstPlayer").setValue(t)}selectPartType(t){"STANDARD"===t?(this.getForm("maximalMoveDuration").setValue(Ui.NORMAL_MOVE_DURATION),this.getForm("totalPartDuration").setValue(Ui.NORMAL_PART_DURATION)):"BLITZ"===t&&(this.getForm("maximalMoveDuration").setValue(Ui.BLITZ_MOVE_DURATION),this.getForm("totalPartDuration").setValue(Ui.BLITZ_PART_DURATION)),this.getForm("partType").setValue(t)}selectOpponent(t){var e=this;return M(function*(){const n=e.getUserFromName(t);yield Promise.all([e.currentGameService.updateCurrentGame({opponent:n}),e.configRoomService.setChosenOpponent(e.partId,n)])})()}getUserFromName(t){const e=this.candidates.find(n=>n.name===t);return L.getNonNullable(e)}changeConfig(){var t=this;return M(function*(){return t.configRoomService.reviewConfig(t.partId)})()}proposeConfig(){var t=this;return M(function*(){const e=t.getForm("chosenOpponent").value,n=t.getForm("partType").value,i=t.getForm("maximalMoveDuration").value,o=t.getForm("firstPlayer").value,s=t.getForm("totalPartDuration").value,a=t.getUserFromName(e);return t.configRoomService.proposeConfig(t.partId,a,Ui.of(n),i,f2.of(o),s,t.rulesConfig)})()}cancelGameCreation(){var t=this;return M(function*(){t.allDocDeleted=!0,yield t.currentGameService.removeCurrentGame(),Ae.display("PartCreationComponent","cancelGameCreation","observed part removed"),yield t.chatService.deleteChat(t.partId),Ae.display("PartCreationComponent","cancelGameCreation","chat deleted"),yield t.gameService.deletePart(t.partId),Ae.display("PartCreationComponent","cancelGameCreation","chat and part deleted"),yield t.configRoomService.deleteConfigRoom(t.partId,t.candidates),Ae.display("PartCreationComponent","cancelGameCreation","chat, part, and configRoom deleted")})()}onCurrentConfigRoomUpdate(t){var e=this;return M(function*(){if(t.isAbsent())return Ae.display("PartCreationComponent","onCurrentConfigRoomUpdate","LAST UPDATE : the game is cancelled"),e.onGameCanceled();{const n=e.currentConfigRoom,i=t.get();if(e.currentConfigRoom=i,e.rulesConfig.isAbsent()&&(e.rulesConfig=h.of(i.rulesConfig)),e.chosenOpponentJustLeft(n,i)&&e.userIsCreator(i)){const o=L.getNonNullable(n?.chosenOpponent).name;e.messageDisplayer.infoMessage($localize`${o} left the game, please pick another opponent.`),yield e.currentGameService.updateCurrentGame({opponent:null})}(e.userJustChosenAsOpponent(n,i)||e.allUserInterval.isAbsent())&&(yield e.updateUserDocWithCurrentGame(i)),e.allUserInterval.isAbsent()&&(yield e.observeNeededPlayers(i)),e.updateViewInfo(i),e.isGameStarted(i)&&(Ae.display("PartCreationComponent","onCurrentConfigRoomUpdate","the game has started"),e.onGameStarted())}})()}onCandidatesUpdate(t){var e=this;return M(function*(){e.candidates=t,e.updateViewInfo(L.getNonNullable(e.currentConfigRoom))})()}userJustChosenAsOpponent(t,e){if(this.isGameStarted(e))return!1;{const n=this.connectedUserService.user.get().id;return t?.chosenOpponent?.id!==n&&e.chosenOpponent?.id===n}}chosenOpponentJustLeft(t,e){return null!=t&&(null!=t.chosenOpponent&&null==e.chosenOpponent)}onGameCanceled(){var t=this;return M(function*(){t.messageDisplayer.infoMessage($localize`The game has been canceled!`),yield t.router.navigate(["/lobby"])})()}isGameStarted(t){return L.assert(null!=t,"configRoom should not be null (isGameStarted)"),L.getNonNullable(t).partStatus===d2.PART_STARTED.value}onGameStarted(){const t=L.getNonNullable(this.currentConfigRoom);this.gameStartNotification.emit(t),this.gameStarted=!0}observeNeededPlayers(t){var e=this;return M(function*(){L.assert(e.allUserInterval.isAbsent(),"Cannot observe players multiple times"),e.allUserInterval=h.of(window.setInterval(M(function*(){const n=e.lastToken;e.userIsCreator(t)?yield e.checkCandidatesTokensFreshness(n):yield e.checkCreatorTokenFreshness(n)}),Zd.TOKEN_INTERVAL))})()}userIsCreator(t){return this.connectedUserService.user.get().id===t.creator.id}checkCreatorTokenFreshness(t){var e=this;return M(function*(){const n=L.getNonNullable(e.currentConfigRoom);(yield e.didUserTimeout(n.creator.id,t))&&(yield e.destroyDocIfPartDidNotStart())})()}destroyDocIfPartDidNotStart(){var t=this;return M(function*(){const e=t.isGameStarted(t.currentConfigRoom);L.assert(!1===e,"Should not try to cancelGameCreation when part started!"),L.assert(!1===t.allDocDeleted,"Should not delete doc twice"),yield t.cancelGameCreation()})()}checkCandidatesTokensFreshness(t){var e=this;return M(function*(){for(const n of e.candidates)(yield e.didUserTimeout(n.id,t))&&(yield e.removeCandidateFromLobby(n))})()}didUserTimeout(t,e){var n=this;return M(function*(){const i=yield n.userService.getUserLastUpdateTime(t);return i.isAbsent()?(u2.logError("PartCreationComponent","found no user while observing "+t+" !"),!0):ZQ(i.get(),e)>Zd.TOKEN_TIMEOUT})()}removeCandidateFromLobby(t){var e=this;return M(function*(){const n=L.getNonNullable(e.currentConfigRoom);return t.id===n.chosenOpponent?.id&&(yield e.configRoomService.reviewConfigAndRemoveChosenOpponent(e.partId)),e.configRoomService.removeCandidate(e.partId,t)})()}startSendingPresenceTokens(){var t=this;return M(function*(){yield t.connectedUserService.sendPresenceToken(),L.assert(t.ownTokenInterval.isAbsent(),"should not start sending presence tokens twice"),t.ownTokenInterval=h.of(window.setInterval(()=>{t.connectedUserService.sendPresenceToken()},Zd.TOKEN_INTERVAL));const e=t.connectedUserService.user.get().id;t.selfSubscription=t.userService.observeUserOnServer(e,n=>{L.assert(n.isPresent(),"connected user should exist"),t.lastToken=L.getNonNullable(n.get().lastUpdateTime)})})()}stopSendingPresenceTokensAndObservingUsersIfNeeded(){this.ownTokenInterval.isPresent()&&(window.clearInterval(this.ownTokenInterval.get()),this.ownTokenInterval=h.empty()),this.allUserInterval.isPresent()&&window.clearInterval(this.allUserInterval.get()),this.selfSubscription.unsubscribe()}acceptConfig(){return this.gameService.acceptConfig(this.partId,L.getNonNullable(this.currentConfigRoom))}saveRulesConfig(t){this.rulesConfig=t}getGameUrlName(){return L.getNonNullable(this.activatedRoute.snapshot.paramMap.get("compo"))}getStateProvider(){const t=this.getGameUrlName(),e=Ht.getByUrlName(t).get().rules;return h.of(i=>e.getInitialState(i))}ngOnDestroy(){var t=this;return M(function*(){if(t.ngUnsubscribe.next(),t.ngUnsubscribe.complete(),t.configRoomSubscription.unsubscribe(),t.candidatesSubscription.unsubscribe(),t.stopSendingPresenceTokensAndObservingUsersIfNeeded(),t.connectedUserService.user.isAbsent())return;const e=t.connectedUserService.user.get();!0!==t.gameStarted&&(null===t.currentConfigRoom?Ae.display("PartCreationComponent","ngOnDestroy","there is no part here"):!0===t.allDocDeleted?Ae.display("PartCreationComponent","ngOnDestroy","part has already been deleted"):e.id===t.currentConfigRoom.creator.id?(Ae.display("PartCreationComponent","ngOnDestroy","you(creator) about to cancel creation."),yield t.cancelGameCreation()):(Ae.display("PartCreationComponent","ngOnDestroy","you are about to cancel game joining"),yield t.currentGameService.removeCurrentGame(),yield t.configRoomService.cancelJoining(t.partId)))})()}static \u0275fac=function(e){return new(e||PR)(G(Qn),G(ao),G(gr),G(qo),G(bu),G(Fd),G(J5),G(eu),G(uge),G(Ut))};static \u0275cmp=Ue({type:PR,selectors:[["app-part-creation"]],viewQuery:function(e,n){if(1&e&&P3(ygt,5),2&e){let i;hc(i=gc())&&(n.rulesConfigurationComponent=i.first)}},inputs:{partId:"partId",rulesConfigDescription:"rulesConfigDescription"},outputs:{gameStartNotification:"gameStartNotification"},decls:1,vars:1,consts:()=>{let t,e,n,i,o,s,a,c,l,u,f,g,y,S,N,R,U,$,re,_e,be,Ve,dt,Xt,u1,an,Qd,l3,Nu,Jd,eh,ht,Tt,Lt,Un,ti;return t=$localize`Game creation`,e=$localize`First player`,n=$localize`Random`,i=$localize`You`,o=$localize`Game type`,s=$localize`Standard`,a=$localize`Maximal turn duration: `,c=$localize`Maximal game duration: ${"\ufffd#37\ufffd"}:START_TAG_STRONG:${"\ufffd0\ufffd"}:INTERPOLATION: per player${"\ufffd/#37\ufffd"}:CLOSE_TAG_STRONG:`,l=$localize`Blitz`,u=$localize`Maximal turn duration: `,f=$localize`Maximal game duration: ${"\ufffd#55\ufffd"}:START_TAG_STRONG:${"\ufffd0\ufffd"}:INTERPOLATION: per player${"\ufffd/#55\ufffd"}:CLOSE_TAG_STRONG:`,g=$localize`Custom`,y=$localize`Opponents`,S=$localize`Propose configuration`,N=$localize`Cancel game`,R=$localize`The opponent`,U=$localize`Maximal turn duration: `,$=$localize`Maximal game duration: ${"\ufffd#13\ufffd"}:START_TAG_OUTPUT:${"\ufffd0\ufffd"}:INTERPOLATION: per player${"\ufffd/#13\ufffd"}:CLOSE_TAG_OUTPUT:`,re=$localize`Potential opponents that join the game will appear here.${"\ufffd#2\ufffd\ufffd/#2\ufffd"}:LINE_BREAK:Wait for an opponent to join, so that you can pick one.`,_e=$localize`Click on the opponent against which you would like to play.`,be=$localize`Name`,Ve=$localize`Actions`,dt=$localize`Pick`,Xt=$localize`Change configuration`,u1=$localize`Configuration proposal`,an=$localize`You have been selected as the opponent.${"\ufffd#3\ufffd\ufffd/#3\ufffd"}:LINE_BREAK: ${"\ufffd0\ufffd"}:INTERPOLATION: is modifying the configuration.`,Qd=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: proposes to play a ${"\ufffd1\ufffd"}:INTERPOLATION_1: game`,l3=$localize`a turn lasts at most ${"\ufffd#10\ufffd"}:START_TAG_STRONG:${"\ufffd0\ufffd"}:INTERPOLATION: ${"\ufffd/#10\ufffd"}:CLOSE_TAG_STRONG:`,Nu=$localize`the game lasts at most ${"\ufffd#14\ufffd"}:START_TAG_STRONG:${"\ufffd0\ufffd"}:INTERPOLATION: per player${"\ufffd/#14\ufffd"}:CLOSE_TAG_STRONG:`,Jd=$localize`Accept and start`,eh=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: plays first`,ht=$localize`you play first`,Tt=$localize`the first player is selected randomly`,Lt=$localize`One moment...`,Un=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: is configuring the game.`,ti=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: has proposed a configuration to ${"\ufffd1\ufffd"}:INTERPOLATION_1:.`,[["class","box",4,"ngIf"],[1,"box"],[4,"ngIf"],["class","message is-primary",4,"ngIf"],[1,"title"],t,[3,"formGroup"],[3,"disabled"],[1,"field"],["for","firstPlayer",1,"label"],e,[1,"buttons","has-addons"],["id","firstPlayerRandom",1,"button",3,"ngClass","click"],n,["id","firstPlayerCreator",1,"button",3,"ngClass","click"],i,["id","firstPlayerOpponent",1,"button",3,"ngClass","click"],[4,"ngIf","ngIfElse"],["opponentWithoutName",""],o,["id","partTypeStandard",1,"button","dropdown","is-hoverable",3,"ngClass","click"],[1,"dropdown-trigger"],s,["role","menu",1,"dropdown-menu"],[1,"dropdown-content"],[1,"dropdown-item"],a,c,["id","partTypeBlitz",1,"button","dropdown","is-hoverable",3,"ngClass","click"],l,u,f,["id","partTypeCustom",1,"button",3,"ngClass","click"],g,["id","customTime",4,"ngIf"],[1,"label"],y,[1,"control"],["chooseOpponent",""],["id","rulesConfigurationComponent",3,"stateProvider","rulesConfigDescriptionOptional","userIsCreator","updateCallback"],["id","proposeConfig",1,"button","is-primary",3,"disabled","click"],S,["class","button","id","reviewConfig",3,"click",4,"ngIf"],["id","cancel",1,"button",3,"click"],N,R,["id","customTime"],["for","maximalMoveDuration",1,"label"],U,["step","10","min","10","max","300","name","maximalMoveDuration","formControlName","maximalMoveDuration","type","range",1,"slider","is-circle","is-primary"],["for","totalPartDuration",1,"label"],$,["step","10","min","10","max","3600","name","totalPartDuration","formControlName","totalPartDuration","type","range",1,"slider","is-circle","is-primary"],re,_e,["id","chooseOpponent",1,"table-container"],[1,"table","is-fullwidth","is-hoverable","is-striped"],["scope","col",1,"th"],be,Ve,[3,"id","ngClass","click",4,"ngFor","ngForOf"],[3,"id","ngClass","click"],[1,"td",3,"id"],[1,"td"],["class","button is-primary",4,"ngIf"],[1,"button","is-primary"],dt,["id","reviewConfig",1,"button",3,"click"],Xt,[1,"message","is-primary"],[1,"message-header"],u1,[1,"message-body"],["class","content",4,"ngIf","ngIfElse"],["configProposal",""],[1,"content"],an,Qd,l3,Nu,[3,"rulesConfigDescriptionOptional","stateProvider","userIsCreator","rulesConfigToDisplay"],["id","acceptConfig",1,"button","is-primary",3,"click"],Jd,eh,ht,Tt,Lt,["proposalSent",""],Un,ti]},template:function(e,n){1&e&&z(0,Hgt,4,3,"div",0),2&e&&v("ngIf",n.viewInfo)},dependencies:[zt,Nt,bt,F4,Na,Ap,vc,H4,U4,u6,Vse,Cgt],encapsulation:2})};var y0;function Ugt(r,t){if(1&r){const e=he();E(0,"button",3),q("click",function(){return te(e),ne(p().addTime())}),se(1,4),P()}if(2&r){const e=p();m(),Bn(e.timeToAdd),Yn(1)}}aR=Zd=function(r,t,e,n){var s,i=arguments.length,o=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,e):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,t,e,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(t,e,o):s(t,e))||o);return i>3&&o&&Object.defineProperty(t,e,o),o}([Ae.log],aR);let cR=class SR{static#e=y0=this;debugName;timeToAdd;dangerTimeLimit;active;canAddTime;remainingMs;displayedSec;displayedMinute;timeoutHandleGlobal=null;timeoutHandleSec=null;isPaused=!0;isSet=!1;started=!1;startTime;outOfTimeAction=new i1;addTimeToOpponent=new i1;static DANGER_TIME_EVEN="has-background-danger has-text-white";static DANGER_TIME_ODD="has-background-warning has-text-white";static PASSIVE_STYLE="has-text-passive is-italic";static SAFE_TIME="";cssClasses=y0.SAFE_TIME;setDuration(t){L.assert(!1===this.started,"Should not set a chrono that has already been started ("+this.debugName+")!"),this.isSet=!0,this.changeDuration(t)}changeDuration(t){L.assert(this.isPaused,"Should not change duration of a clock while it is running"),this.remainingMs=t,this.displayDuration()}subtract(t){this.changeDuration(this.remainingMs-t)}displayDuration(){this.displayedSec=this.remainingMs%6e4,this.displayedMinute=(this.remainingMs-this.displayedSec)/6e4,this.displayedSec=Math.floor(this.displayedSec/1e3)}start(){L.assert(this.isSet,"Should not start a chrono that has not been set!"),L.assert(!1===this.started,"Should not start chrono that has already been started ("+this.debugName+")"),this.started=!0,this.resume()}resume(){L.assert(this.isPaused&&this.started,"Should only resume chrono that are started and paused!"),this.startTime=Date.now();const t=this.remainingMs;this.isPaused=!1,this.timeoutHandleGlobal=window.setTimeout(()=>{this.onEndReached()},t),this.countSeconds()}onEndReached(){this.isPaused=!0,this.started=!1,this.clearTimeouts(),this.changeDuration(0),this.outOfTimeAction.emit()}countSeconds(){this.timeoutHandleSec=window.setTimeout(()=>{this.updateShownTime()},1e3)}isIdle(){return!1===this.started||this.isPaused}pause(){L.assert(this.started,"Should not pause not started chrono ("+this.debugName+")"),L.assert(!1===this.isPaused,"Should not pause already paused chrono ("+this.debugName+")"),this.clearTimeouts(),this.isPaused=!0,this.updateShownTime()}stop(){L.assert(this.started,"Should only stop chrono that are started!"),!1===this.isPaused&&this.pause(),this.started=!1,this.isSet=!1}isStarted(){return this.started}getTimeClass(){return!1===this.active?y0.PASSIVE_STYLE:this.remainingMs<this.dangerTimeLimit?this.remainingMs%2e3<1e3?y0.DANGER_TIME_ODD:y0.DANGER_TIME_EVEN:y0.SAFE_TIME}updateShownTime(){const t=Date.now();this.remainingMs-=t-this.startTime,this.displayDuration(),this.cssClasses=this.getTimeClass(),this.startTime=t,!1===this.isPaused&&this.countSeconds()}clearTimeouts(){null!=this.timeoutHandleSec&&(window.clearTimeout(this.timeoutHandleSec),this.timeoutHandleSec=null),null!=this.timeoutHandleGlobal&&(window.clearTimeout(this.timeoutHandleGlobal),this.timeoutHandleGlobal=null)}addTime(){this.addTimeToOpponent.emit()}ngOnDestroy(){this.clearTimeouts()}static \u0275fac=function(e){return new(e||SR)};static \u0275cmp=Ue({type:SR,selectors:[["app-count-down"]],inputs:{debugName:"debugName",timeToAdd:"timeToAdd",dangerTimeLimit:"dangerTimeLimit",active:"active",canAddTime:"canAddTime"},outputs:{outOfTimeAction:"outOfTimeAction",addTimeToOpponent:"addTimeToOpponent"},decls:5,vars:7,consts:()=>{let t;return t=$localize`Add ${"\ufffd0\ufffd"}:INTERPOLATION:`,[[3,"ngClass"],["id","remainingTime"],["id","addTimeButton","class","button is-small is-fullwidth",3,"click",4,"ngIf"],["id","addTimeButton",1,"button","is-small","is-fullwidth",3,"click"],t]},template:function(e,n){1&e&&(E(0,"div",0)(1,"p",1),ot(2),wa(3,"number"),P(),z(4,Ugt,2,1,"button",2),P()),2&e&&(v("ngClass",n.getTimeClass()),m(2),FE("",n.displayedMinute,":",GH(3,4,n.displayedSec,"2.0-0"),""),m(2),v("ngIf",n.canAddTime))},dependencies:[zt,bt,MU],encapsulation:2})};cR=y0=function(r,t,e,n){var s,i=arguments.length,o=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,e):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,t,e,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(t,e,o):s(t,e))||o);return i>3&&o&&Object.defineProperty(t,e,o),o}([Ae.log],cR);const Bgt=["chronoZeroGlobal"],$gt=["chronoOneGlobal"],Wgt=["chronoZeroTurn"],qgt=["chronoOneTurn"];function jgt(r,t){if(1&r){const e=he();E(0,"app-part-creation",5,6),q("gameStartNotification",function(i){return te(e),ne(p().startGame(i))}),P()}if(2&r){const e=p();v("partId",e.currentPartId)("rulesConfigDescription",e.getRulesConfigDescription())}}function Zgt(r,t){1&r&&(jt(0),E(1,"span",39),se(2,40),P(),Zt())}function Ygt(r,t){if(1&r&&(E(0,"span",41),se(1,42),P()),2&r){const e=p(4);m(),Bn(null==e.currentUser?null:e.currentUser.name),Yn(1)}}function Kgt(r,t){if(1&r&&(E(0,"p",36),z(1,Zgt,3,0,"ng-container",37)(2,Ygt,2,1,"ng-template",null,38,In),P()),2&r){const e=wn(3),n=p(3);m(),v("ngIf",(null==n.currentUser?null:n.currentUser.name)===n.getPlayer().name)("ngIfElse",e)}}function Xgt(r,t){if(1&r&&(E(0,"div",32)(1,"p",33),se(2,34),P(),z(3,Kgt,4,2,"p",35),P()),2&r){const e=p(2);m(2),Bn(e.currentPart.getTurn()+1),Yn(2),m(),v("ngIf",!1===e.endGame)}}function Qgt(r,t){if(1&r&&(E(0,"p",43),ot(1),P()),2&r){const e=p(2);v("ngClass",e.getPlayerNameClass(e.Player.ZERO)),m(),Cn(e.players[0].get().name)}}function Jgt(r,t){if(1&r&&(E(0,"p",44),se(1,45),P()),2&r){const e=p(2);m(),Bn(e.gameComponent.scores.get().get(e.Player.ZERO)),Yn(1)}}function ept(r,t){if(1&r&&(E(0,"p",46),ot(1),P()),2&r){const e=p(2);v("ngClass",e.getPlayerNameClass(e.Player.ONE)),m(),Cn(e.players[1].get().name)}}function tpt(r,t){if(1&r&&(E(0,"p",47),se(1,48),P()),2&r){const e=p(2);m(),Bn(e.gameComponent.scores.get().get(e.Player.ONE)),Yn(1)}}function npt(r,t){1&r&&(E(0,"div")(1,"p",50),se(2,51),P()())}function rpt(r,t){1&r&&(E(0,"p",55),se(1,56),P())}function ipt(r,t){1&r&&(E(0,"p",57),se(1,58),P())}function opt(r,t){1&r&&(E(0,"p",59),se(1,60),P())}function spt(r,t){if(1&r&&(E(0,"div"),z(1,rpt,2,0,"p",52)(2,ipt,2,0,"p",53)(3,opt,2,0,"p",54),P()),2&r){const e=p(3);m(),v("ngIf",e.currentPart.getDrawAccepter().name===e.getPlayer().name),m(),v("ngIf",e.currentPart.getDrawAccepter().name!==e.getPlayer().name&&e.isPlaying()),m(),v("ngIf",!1===e.isPlaying())}}function apt(r,t){1&r&&(E(0,"p",64),se(1,65),P())}function cpt(r,t){1&r&&(E(0,"p",66),se(1,67),P())}function lpt(r,t){if(1&r&&(E(0,"p",68),se(1,69),P()),2&r){const e=p(4);m(),Bn(e.currentPart.getWinner().get().name),Yn(1)}}function upt(r,t){if(1&r&&(E(0,"div"),z(1,apt,2,0,"p",61)(2,cpt,2,0,"p",62)(3,lpt,2,1,"p",63),P()),2&r){const e=p(3);m(),v("ngIf",e.currentPart.getWinner().get().name===e.getPlayer().name),m(),v("ngIf",e.currentPart.getWinner().get().name!==e.getPlayer().name&&e.isPlaying()),m(),v("ngIf",!1===e.isPlaying())}}function fpt(r,t){if(1&r&&(E(0,"p",64),se(1,70),P()),2&r){const e=p(4);m(),Bn(e.currentPart.getLoser().get().name),Yn(1)}}function dpt(r,t){1&r&&(E(0,"p",68),se(1,71),P())}function hpt(r,t){if(1&r&&(E(0,"p",68),se(1,72),P()),2&r){const e=p(4);m(),Bn(e.currentPart.getLoser().get().name),Yn(1)}}function gpt(r,t){if(1&r&&(E(0,"div"),z(1,fpt,2,1,"p",61)(2,dpt,2,0,"p",63)(3,hpt,2,1,"p",63),P()),2&r){const e=p(3);m(),v("ngIf",e.currentPart.getWinner().get().name===e.getPlayer().name),m(),v("ngIf",e.currentPart.getWinner().get().name!==e.getPlayer().name&&e.isPlaying()),m(),v("ngIf",!1===e.isPlaying())}}function ppt(r,t){1&r&&(E(0,"p",74),se(1,75),P())}function mpt(r,t){if(1&r&&(E(0,"p",74),se(1,76),P()),2&r){const e=p(4);m(),Bn(e.currentPart.getLoser().get().name),Yn(1)}}function _pt(r,t){if(1&r&&(E(0,"div"),z(1,ppt,2,0,"p",73)(2,mpt,2,1,"p",73),P()),2&r){const e=p(3);m(),v("ngIf",e.currentPart.getWinner().get().name!==e.getPlayer().name&&e.isPlaying()),m(),v("ngIf",!1===e.isPlaying()||e.currentPart.getWinner().get().name===e.getPlayer().name)}}function Cpt(r,t){if(1&r&&(E(0,"div",49),V(1,"hr"),z(2,npt,3,0,"div",27)(3,spt,4,3,"div",27)(4,upt,4,3,"div",27)(5,gpt,4,3,"div",27)(6,_pt,3,2,"div",27),P()),2&r){const e=p(2);m(2),v("ngIf",e.currentPart.isHardDraw()),m(),v("ngIf",e.currentPart.isAgreedDraw()),m(),v("ngIf",e.currentPart.isWin()),m(),v("ngIf",e.currentPart.isTimeout()),m(),v("ngIf",e.currentPart.isResign())}}function vpt(r,t){if(1&r){const e=he();jt(0),E(1,"button",85),q("click",function(){const o=te(e).$implicit;return ne(p(4).propose(o))}),ot(2),V(3,"fa-icon",86),P(),Zt()}if(2&r){const e=t.$implicit,n=p(4);m(),Tn("id","propose",e,""),v("disabled",!1===n.requestAvailable(e)),m(),ii("",n.requestInfos[e].textForRequest(),"\xa0\xa0"),m(),v("icon",n.requestInfos[e].icon)}}function ypt(r,t){if(1&r){const e=he();jt(0),E(1,"button",80),q("click",function(){return te(e),ne(p(3).resign())}),se(2,81),P(),E(3,"button",82),q("click",function(){return te(e),ne(p(3).gameComponent.pass())}),se(4,83),P(),z(5,vpt,4,4,"ng-container",84),Zt()}if(2&r){const e=p(3);m(),v("disabled",!1===e.canResign()),m(2),v("disabled",!1===e.canPass()),m(2),v("ngForOf",e.allRequests)}}function Mpt(r,t){if(1&r){const e=he();E(0,"div",87)(1,"p"),ot(2),V(3,"fa-icon",86),P(),E(4,"button",88),q("click",function(){return te(e),ne(p(3).accept())}),se(5,89),P(),E(6,"button",90),q("click",function(){return te(e),ne(p(3).reject())}),se(7,91),P()()}if(2&r){const e=p(3);m(2),ii(" ",e.requestInfos[e.getRequestAwaitingReplyFromUs().get()].textForReply(),"\xa0\xa0 "),m(),v("icon",e.requestInfos[e.getRequestAwaitingReplyFromUs().get()].icon)}}function Ept(r,t){if(1&r&&(E(0,"div",92)(1,"p")(2,"span"),No(3,93),V(4,"fa-icon",86),Io(),P()()()),2&r){const e=p(3);m(4),v("icon",e.requestInfos[e.deniedRequest().get()].icon),Bn(e.requestInfos[e.deniedRequest().get()].name()),Yn(3)}}function Ppt(r,t){if(1&r&&(E(0,"div",94)(1,"p")(2,"span"),No(3,95),V(4,"fa-icon",86),Io(),P()()()),2&r){const e=p(3);m(4),v("icon",e.requestInfos[e.getRequestAwaitingReplyFromOpponent().get()].icon),Bn(e.requestInfos[e.getRequestAwaitingReplyFromOpponent().get()].name()),Yn(3)}}function Spt(r,t){if(1&r&&(jt(0),z(1,ypt,6,3,"ng-container",37)(2,Mpt,8,2,"ng-template",null,77,In)(4,Ept,5,2,"div",78)(5,Ppt,5,2,"div",79),Zt()),2&r){const e=wn(3),n=p(2);m(),v("ngIf",!1===n.mustReply())("ngIfElse",e),m(3),v("ngIf",n.deniedRequest().isPresent()),m(),v("ngIf",n.getRequestAwaitingReplyFromOpponent().isPresent())}}function Opt(r,t){1&r&&(E(0,"button",96),se(1,97),P())}function Tpt(r,t){if(1&r){const e=he();E(0,"div",7)(1,"div",8)(2,"div",9),z(3,Xgt,4,2,"div",10),E(4,"div",11),z(5,Qgt,2,2,"p",12)(6,Jgt,2,1,"p",13),E(7,"app-count-down",14,15),q("outOfTimeAction",function(){te(e);const i=p();return ne(i.reachedOutOfTime(i.Player.ZERO))})("addTimeToOpponent",function(){return te(e),ne(p().addGlobalTime())}),P(),E(9,"app-count-down",16,17),q("outOfTimeAction",function(){te(e);const i=p();return ne(i.reachedOutOfTime(i.Player.ZERO))})("addTimeToOpponent",function(){return te(e),ne(p().addTurnTime())}),P()(),E(11,"p",18),se(12,19),P(),E(13,"div",11),z(14,ept,2,2,"p",20)(15,tpt,2,1,"p",21),E(16,"app-count-down",22,23),q("outOfTimeAction",function(){te(e);const i=p();return ne(i.reachedOutOfTime(i.Player.ONE))})("addTimeToOpponent",function(){return te(e),ne(p().addGlobalTime())}),P(),E(18,"app-count-down",24,25),q("outOfTimeAction",function(){te(e);const i=p();return ne(i.reachedOutOfTime(i.Player.ONE))})("addTimeToOpponent",function(){return te(e),ne(p().addTurnTime())}),P()(),V(20,"hr"),z(21,Cpt,7,5,"div",26)(22,Spt,6,4,"ng-container",27)(23,Opt,2,0,"button",28),P()(),E(24,"div",29)(25,"div",30),V(26,"div",null,31),P()()()}if(2&r){const e=p();m(3),v("ngIf",null!==e.currentPart),m(2),v("ngIf",e.players[0].isPresent()),m(),v("ngIf",null!==e.currentPart&&e.gameComponent&&e.gameComponent.scores.isPresent()),m(),v("dangerTimeLimit",6e4)("active",null!==e.currentPart&&e.currentPart.getTurn()%2==0)("canAddTime",e.role===e.Player.ONE&&!1===e.endGame)("timeToAdd",e.globalTimeMessage),m(2),v("dangerTimeLimit",15e3)("active",null!==e.currentPart&&e.currentPart.getTurn()%2==0)("canAddTime",e.role===e.Player.ONE&&!1===e.endGame)("timeToAdd",e.turnTimeMessage),m(5),v("ngIf",e.players[1].isPresent()),m(),v("ngIf",null!==e.currentPart&&e.gameComponent&&e.gameComponent.scores.isPresent()),m(),v("dangerTimeLimit",6e4)("active",null!==e.currentPart&&e.currentPart.getTurn()%2==1)("canAddTime",e.role===e.Player.ZERO&&!1===e.endGame)("timeToAdd",e.globalTimeMessage),m(2),v("dangerTimeLimit",15e3)("active",null!==e.currentPart&&e.currentPart.getTurn()%2==1)("canAddTime",e.role===e.Player.ZERO&&!1===e.endGame)("timeToAdd",e.turnTimeMessage),m(3),v("ngIf",e.endGame&&null!==e.currentPart),m(),v("ngIf",e.isPlaying()),m(),v("ngIf",e.endGame),m(),v("ngClass",e.getBoardHighlight())}}let lR=(()=>class r{static NO_MATCHING_PART=()=>$localize`The game you tried to join does not exist.`;static CANNOT_PLAY_AS_OBSERVER=()=>$localize`You are an observer in this game, you cannot play.`;static MUST_ANSWER_REQUEST=()=>$localize`You must answer your opponent's request.`})(),uR=class OR extends bv{currentGameService;userService;gameService;gameEventService;timeManager;requestManager;chronoZeroGlobal;chronoOneGlobal;chronoZeroTurn;chronoOneTurn;currentPart=null;currentPartId;gameStarted=!1;opponent=null;authUser;currentUser=null;configRoom;currentGame=h.empty();userLinkedToThisPart=!0;routerEventsSubscription;userSubscription;partSubscription=new cn;gameEventsSubscription=new cn;currentGameSubscription=new cn;OFFLINE_FONT_COLOR={color:"lightgrey"};globalTimeMessage=$localize`5 minutes`;turnTimeMessage=$localize`30 seconds`;requestInfos=Dse.requestInfos;allRequests=["TakeBack","Draw","Rematch"];constructor(t,e,n,i,o,s,a,c,l,u){super(t,e,n,i),this.currentGameService=o,this.userService=s,this.gameService=a,this.gameEventService=c,this.timeManager=l,this.requestManager=u}extractPartIdFromURL(){return L.getNonNullable(this.activatedRoute.snapshot.paramMap.get("id"))}isPlaying(){return this.role.isPlayer()}getPlayer(){return this.authUser.toMinimalUser()}redirectIfPartOrGameIsInvalid(){var t=this;return M(function*(){const e=t.getGameName();if(Ht.ALL_GAMES().some(i=>i.urlName===e)){if((yield t.gameService.getPartValidity(t.currentPartId,e)).isFailure()){t.routerEventsSubscription.unsubscribe();const o=lR.NO_MATCHING_PART();yield t.router.navigate(["/notFound",o],{skipLocationChange:!0})}}else{t.routerEventsSubscription.unsubscribe();const i=jd.NO_MATCHING_GAME(e);yield t.router.navigate(["/notFound",i],{skipLocationChange:!0})}})()}setCurrentPartIdOrRedirect(){return this.currentPartId=this.extractPartIdFromURL(),this.redirectIfPartOrGameIsInvalid()}ngOnInit(){var t=this;return M(function*(){t.routerEventsSubscription=t.router.events.subscribe(function(){var e=M(function*(n){n instanceof Pc&&(yield t.setCurrentPartIdOrRedirect())});return function(n){return e.apply(this,arguments)}}()),t.userSubscription=t.connectedUserService.subscribeToUser(e=>{t.authUser=e}),yield t.setCurrentPartIdOrRedirect(),t.currentGameSubscription=t.currentGameService.subscribeToCurrentGame(function(){var e=M(function*(n){yield t.onCurrentGameUpdate(n)});return function(n){return e.apply(this,arguments)}}())})()}onCurrentGameUpdate(t){var e=this;return M(function*(){if(t.isPresent()){const n=t.get();"Observer"===n.role||n.id===e.currentPartId?e.currentGame=t:(e.userLinkedToThisPart=!1,yield e.router.navigate(["/lobby"]))}else e.currentGame=h.empty()})()}startGame(t){var e=this;return M(function*(){L.assert(!1===e.gameStarted,"Should not start already started game"),e.configRoom=t,e.gameStarted=!0,window.setTimeout(M(function*(){const n=yield e.createMatchingGameComponent();e.timeManager.setClocks([e.chronoZeroTurn,e.chronoOneTurn],[e.chronoZeroGlobal,e.chronoOneGlobal]),L.assert(n,"Game should be created successfully, otherwise part-creation would have redirected"),L.assert(null!==e.gameComponent,"Game component should exist"),e.gameComponent.config=h.of(t.rulesConfig),yield e.startPart()}),2)})()}startPart(){var t=this;return M(function*(){const e=(yield t.gameService.getPart(t.currentPartId)).get();t.currentPart=new MC(t.currentPartId,e),t.partSubscription=t.gameService.subscribeToChanges(t.currentPartId,function(){var n=M(function*(i){L.assert(i.isPresent(),"OnlineGameWrapper observed a part being deleted, this should not happen"),t.currentPart=new MC(t.currentPartId,i.get())});return function(i){return n.apply(this,arguments)}}()),t.subscribeToEvents()})()}onGameStart(){var t=this;return M(function*(){yield t.initializePlayersDatas(t.currentPart);const e=t.gameComponent.getTurn();L.assert(0===e,"turn should always be 0 upon game start"),t.timeManager.onGameStart(t.configRoom,t.players),t.requestManager.onGameStart()})()}subscribeToEvents(){var t=this;const e=new cgt,n=function(){var i=M(function*(o){yield e.runExclusive(M(function*(){const s=o.filter(c=>"Move"===c.eventType).length;let a=0;t.beforeEventsBatch();for(const c of o)switch(c.eventType){case"Move":const l=a+1===s;yield t.onReceivedMove(c,l),a+=1;break;case"Request":t.requestManager.onReceivedRequest(c);break;case"Reply":(yield t.requestManager.onReceivedReply(c))&&(yield t.handleReply(c));break;default:L.expectToBe(c.eventType,"Action","Event should be an action"),t.timeManager.onReceivedAction(c),"EndGame"===c.action?yield t.onGameEnd():"StartGame"===c.action&&(yield t.onGameStart())}yield t.afterEventsBatch()}))});return function(s){return i.apply(this,arguments)}}();this.gameEventsSubscription=this.gameEventService.subscribeToEvents(this.currentPartId,n)}handleReply(t){var e=this;return M(function*(){switch(t.requestType){case"TakeBack":const n=e.timeManager.playerOfMinimalUser(t.user);yield e.takeBackToPreviousPlayerTurn(n.getOpponent());break;case"Rematch":yield e.router.navigate(["/nextGameLoading"]);const i=e.getGameName();yield e.router.navigate(["/play",i,t.data])}})()}onGameEnd(){var t=this;return M(function*(){yield t.currentGameService.removeCurrentGame(),t.gameComponent.setInteractive(!1),t.endGame=!0})()}onReceivedMove(t,e){var n=this;return M(function*(){const i=n.gameComponent.rules,o=n.gameComponent.getTurn(),s=n.gameComponent.encoder.decode(t.move),a=n.gameComponent.node.gameState,c=yield n.getConfig(),l=n.gameComponent.rules.isLegal(s,a,c),u="We received an incorrect db move: "+s.toString()+" at turn "+o+'because "'+l.getReasonOr("")+'"';L.assert(l.isSuccess(),u);const f=i.choose(n.gameComponent.node,s,c);if(L.assert(f.isSuccess(),"Chosen move should be legal after all checks, but it is not! Reason: "+f.getReasonOr("")),n.gameComponent.node=f.get(),n.role===B.NONE)yield n.updateBoardAndShowLastMove(e);else{const g=o%2!==n.role.getValue();yield n.updateBoardAndShowLastMove(g&&e)}n.setCurrentPlayerAccordingToCurrentTurn(),n.timeManager.onReceivedMove(t),n.requestManager.onReceivedMove()})()}setCurrentPlayerAccordingToCurrentTurn(){this.currentUser=this.players[this.gameComponent.getTurn()%2].get(),this.gameComponent.setInteractive(this.currentUser.name===this.getPlayer().name)}beforeEventsBatch(){this.timeManager.beforeEventsBatch(this.endGame)}afterEventsBatch(){var t=this;return M(function*(){const e=O.ofTurn(t.gameComponent.getTurn()),n=yield t.userService.getServerTime(t.connectedUserService.user.get().id);t.timeManager.afterEventsBatch(t.endGame,e,n)})()}takeBackToPreviousPlayerTurn(t){var e=this;return M(function*(){e.gameComponent.node=e.gameComponent.node.parent.get(),e.gameComponent.getCurrentPlayer()!==t&&(L.assert(e.gameComponent.getTurn()>0,"Should not allow player that never played to take back"),e.gameComponent.node=e.gameComponent.node.parent.get()),e.setCurrentPlayerAccordingToCurrentTurn();const n=0===e.gameComponent.getTurn();yield e.updateBoardAndShowLastMove(n)})()}canResign(){return L.assert(this.isPlaying(),"Non playing should not call canResign"),!0!==this.endGame&&null!=this.opponent}requestAvailable(t){switch(t){case"TakeBack":return this.canAskTakeBack();case"Draw":return this.canProposeDraw();default:return L.expectToBe(t,"Rematch"),this.endGame}}mustReply(){return this.getRequestAwaitingReplyFromUs().isPresent()}getRequestAwaitingReplyFromUs(){return L.assert(this.role.isPlayer(),"User should be playing"),this.requestManager.getUnrespondedRequestFrom(L.getNonNullable(this.opponent))}getRequestAwaitingReplyFromOpponent(){return L.assert(this.role.isPlayer(),"User should be playing"),this.requestManager.getUnrespondedRequestFrom(L.getNonNullable(this.currentUser))}deniedRequest(){return this.requestManager.deniedRequest()}canPass(){return L.assert(this.isPlaying(),"Non playing should not call canPass"),!this.endGame&&this.currentUser?.name===this.getPlayer().name&&this.gameComponent.canPass}canAskTakeBack(){return L.assert(this.isPlaying(),"Non playing should not call canAskTakeBack"),L.assert(null!=this.currentPart,"should not call canAskTakeBack when currentPart is not defined yet"),!(!0===this.endGame||L.getNonNullable(this.currentPart).data.turn<=this.role.getValue())&&this.requestManager.canMakeRequest("TakeBack")}canProposeDraw(){return L.assert(this.isPlaying(),"Non playing should not call canProposeDraw"),!this.endGame&&this.requestManager.canMakeRequest("Draw")}canUserPlay(t){var e=()=>super.canUserPlay,n=this;return M(function*(){if(n.role===B.NONE){const o=lR.CANNOT_PLAY_AS_OBSERVER();return w.failure(o)}const i=yield e().call(n,t);return i.isFailure()?i:n.mustReply()?w.failure(lR.MUST_ANSWER_REQUEST()):w.SUCCESS})()}initializePlayersDatas(t){var e=this;return M(function*(){e.players=[h.of(t.data.playerZero),h.ofNullable(t.data.playerOne)],L.assert(null!=t.data.playerOne,"should not initializePlayersDatas when players data is not received"),e.setCurrentPlayerAccordingToCurrentTurn(),yield e.setRealObserverRole()})()}setRealObserverRole(){var t=this;return M(function*(){t.players[0].equalsValue(t.getPlayer())?(yield t.setRole(O.ZERO),t.opponent=t.players[1].get()):t.players[1].equalsValue(t.getPlayer())?(yield t.setRole(O.ONE),t.opponent=t.players[0].get()):yield t.setRole(B.NONE),yield t.currentGameService.updateCurrentGame({...t.currentGame.get(),role:t.role===B.NONE?"Observer":"Player"})})()}onLegalUserMove(t){var e=this;return M(function*(){const n=e.gameComponent.node,i=e.gameComponent.rules,o=n.gameState,s=yield e.getConfig(),a=e.gameComponent.rules.isLegal(t,o,s);L.assert(a.isSuccess(),"onLegalUserMove called with an illegal move");const c=i.applyLegalMove(t,o,s,a.get()),l=new ms(c,h.of(n),h.of(t)),u=i.getGameStatus(l,s),f=e.gameComponent.encoder.encode(t),g=L.getNonNullable(e.currentUser);return yield e.gameEventService.addMove(e.currentPartId,g,f),e.updatePartWithStatusAndScores(u,e.gameComponent.scores)})()}updatePartWithStatusAndScores(t,e){var n=this;return M(function*(){return t.isEndGame?t===ye.DRAW?yield n.gameService.drawPart(n.currentPartId,e):(L.assert(t.winner.isPlayer(),"Non-draw end games should have a winner"),n.notifyVictory(t.winner,e)):n.gameService.updatePartUponMove(n.currentPartId,e)})()}notifyTimeoutVictory(t,e){var n=this;return M(function*(){yield n.gameService.notifyTimeout(n.currentPartId,t,e)})()}notifyVictory(t,e){var n=this;return M(function*(){const i=L.getNonNullable(n.currentPart),o=n.players[0].get(),s=n.players[1].get();n.currentPart=t===O.ONE?i.setWinnerAndLoser(s,o):i.setWinnerAndLoser(o,s),yield n.gameService.endPartWithVictory(n.currentPartId,n.currentPart.getWinner().get(),n.currentPart.getLoser().get(),e)})()}resign(){var t=this;return M(function*(){const e=t.getPlayer(),n=t.players[(t.role.getValue()+1)%2].get();yield t.gameService.resign(t.currentPartId,n,e)})()}reachedOutOfTime(t){var e=this;return M(function*(){if(!1===e.isPlaying())return;const n=L.getNonNullable(e.opponent);t===e.role?yield e.notifyTimeoutVictory(n,e.authUser.toMinimalUser()):yield e.notifyTimeoutVictory(e.authUser.toMinimalUser(),n)})()}propose(t){var e=this;return M(function*(){switch(L.assert(e.role.isPlayer(),"cannot propose request if not player"),t){case"Rematch":return e.gameService.proposeRematch(e.currentPartId);case"Draw":return e.gameService.proposeDraw(e.currentPartId);default:return L.expectToBe(t,"TakeBack"),e.gameService.askTakeBack(e.currentPartId)}})()}accept(){var t=this;return M(function*(){L.assert(t.role.isPlayer(),"cannot accept request if not player");const e=t.role,n=L.getNonNullable(t.currentPart),i=t.requestManager.getCurrentRequest().get().requestType;switch(i){case"Rematch":return t.gameService.acceptRematch(n);case"Draw":return t.gameService.acceptDraw(n.id,e);default:return L.expectToBe(i,"TakeBack"),t.gameService.acceptTakeBack(n.id,n.data.turn,e)}})()}reject(){var t=this;return M(function*(){L.assert(t.role.isPlayer(),"cannot reject request if not player");const e=t.requestManager.getCurrentRequest().get().requestType;switch(e){case"Rematch":return t.gameService.rejectRematch(t.currentPartId);case"Draw":return t.gameService.refuseDraw(t.currentPartId);default:return L.expectToBe(e,"TakeBack"),t.gameService.refuseTakeBack(t.currentPartId)}})()}getPlayerNameClass(t){return this.opponentIsOffline()?"has-text-grey-light":t===O.ZERO?"has-text-white":"has-text-black"}opponentIsOffline(){return!1}addGlobalTime(){return this.gameService.addGlobalTime(this.currentPartId)}addTurnTime(){return this.gameService.addTurnTime(this.currentPartId)}onCancelMove(t){var e=this;return M(function*(){if(e.gameComponent.node.previousMove.isPresent()){const n=e.gameComponent.node.previousMove.get(),i=yield e.getConfig();yield e.gameComponent.showLastMove(n,i)}})()}ngOnDestroy(){var t=this;return M(function*(){t.routerEventsSubscription.unsubscribe(),t.userSubscription.unsubscribe(),t.currentGameSubscription.unsubscribe(),!1===t.isPlaying()&&t.userLinkedToThisPart&&t.connectedUserService.user.isPresent()&&(yield t.currentGameService.removeCurrentGame()),!0===t.gameStarted&&(t.partSubscription.unsubscribe(),t.gameEventsSubscription.unsubscribe())})()}getConfig(){var t=this;return M(function*(){return h.of(t.configRoom.rulesConfig)})()}static \u0275fac=function(e){return new(e||OR)(G(ao),G(gr),G(Qn),G(Ut),G(qo),G(eu),G(bu),G(_I),G(ugt),G(Dse))};static \u0275cmp=Ue({type:OR,selectors:[["app-online-game-wrapper"]],viewQuery:function(e,n){if(1&e&&(P3(Bgt,5),P3($gt,5),P3(Wgt,5),P3(qgt,5)),2&e){let i;hc(i=gc())&&(n.chronoZeroGlobal=i.first),hc(i=gc())&&(n.chronoOneGlobal=i.first),hc(i=gc())&&(n.chronoZeroTurn=i.first),hc(i=gc())&&(n.chronoOneTurn=i.first)}},features:[$e],decls:5,vars:4,consts:()=>{let t,e,n,i,o,s,a,c,l,u,f,g,y,S,N,R,U,$,re,_e,be,Ve,dt,Xt,u1;return t=$localize`vs.`,e=$localize`Turn n${"\ufffd0\ufffd"}:INTERPOLATION:`,n=$localize`It is your turn.`,i=$localize`It is ${"\ufffd0\ufffd"}:INTERPOLATION:'s turn.`,o=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: points`,s=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: points`,a=$localize`Draw`,c=$localize`You agreed to draw.`,l=$localize`Your draw proposal has been accepted.`,u=$localize`Players agreed to draw.`,f=$localize`You won.`,g=$localize`You lost.`,y=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: won.`,S=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: has reached their time limit. You won.`,N=$localize`You reached your time limit.`,R=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: has reached their time limit.`,U=$localize`You resigned.`,$=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: has resigned.`,re=$localize`Resign`,_e=$localize`Pass a turn`,be=$localize`Accept`,Ve=$localize`Reject`,dt=$localize`Your ${"\ufffd0\ufffd"}:INTERPOLATION: request has been rejected.${"\ufffd#4\ufffd"}:START_TAG_FA_ICON:${"\ufffd/#4\ufffd"}:CLOSE_TAG_FA_ICON:`,Xt=$localize`Your request for a ${"\ufffd0\ufffd"}:INTERPOLATION: has been sent.${"\ufffd#4\ufffd"}:START_TAG_FA_ICON:${"\ufffd/#4\ufffd"}:CLOSE_TAG_FA_ICON:`,u1=$localize`Go back to the game list`,[["id","partCreation",3,"partId","rulesConfigDescription","gameStartNotification",4,"ngIf"],["id","game","class","tile is-ancestor",4,"ngIf"],[1,"block","mt-2"],["id","chat",1,"box"],[3,"chatId","turn"],["id","partCreation",3,"partId","rulesConfigDescription","gameStartNotification"],["partCreation",""],["id","game",1,"tile","is-ancestor"],[1,"tile","is-parent"],[1,"tile","is-child","box","has-text-centered"],["class","block","id","turnIndicator",4,"ngIf"],[1,"block"],["id","playerZeroIndicator","class","player0-bg",3,"ngClass",4,"ngIf"],["id","scoreZeroIndicator",4,"ngIf"],["debugName","ZERO Global",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoZeroGlobal",""],["debugName","ZERO Turn",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoZeroTurn",""],[1,"is-size-3"],t,["id","playerOneIndicator","class","player1-bg",3,"ngClass",4,"ngIf"],["id","scoreOneIndicator",4,"ngIf"],["debugName","ONE Global",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoOneGlobal",""],["debugName","ONE Turn",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoOneTurn",""],["class","block","id","winnerIndicator",4,"ngIf"],[4,"ngIf"],["class","button is-primary is-fullwidth mb-1","id","backToServerButton","routerLink","/lobby",4,"ngIf"],["id","board-tile",1,"tile","is-9","is-parent","rounded-div",3,"ngClass"],["id","board",1,"tile","is-child","box"],["board",""],["id","turnIndicator",1,"block"],[1,"subtitle"],e,["class","subtitle","id","currentPlayerIndicator",4,"ngIf"],["id","currentPlayerIndicator",1,"subtitle"],[4,"ngIf","ngIfElse"],["opponentsTurn",""],["id","playerTurn"],n,["id","opponentTurn"],i,["id","playerZeroIndicator",1,"player0-bg",3,"ngClass"],["id","scoreZeroIndicator"],o,["id","playerOneIndicator",1,"player1-bg",3,"ngClass"],["id","scoreOneIndicator"],s,["id","winnerIndicator",1,"block"],["id","hardDrawIndicator",1,"title"],a,["class","title","id","youAgreedToDrawIndicator",4,"ngIf"],["class","title","id","yourOpponentAgreedToDrawIndicator",4,"ngIf"],["class","title","id","playersAgreedToDraw",4,"ngIf"],["id","youAgreedToDrawIndicator",1,"title"],c,["id","yourOpponentAgreedToDrawIndicator",1,"title"],l,["id","playersAgreedToDraw",1,"title"],u,["class","title","id","youWonIndicator",4,"ngIf"],["class","title","id","youLostIndicator",4,"ngIf"],["class","title",4,"ngIf"],["id","youWonIndicator",1,"title"],f,["id","youLostIndicator",1,"title"],g,[1,"title"],y,S,N,R,["class","title","id","resignIndicator",4,"ngIf"],["id","resignIndicator",1,"title"],U,$,["replyButtons",""],["id","requestRejected","class","notification is-danger",4,"ngIf"],["id","getRequestAwaitingReply","class","notification",4,"ngIf"],["id","resign",1,"button","is-fullwidth","mb-1","is-danger",3,"disabled","click"],re,["id","pass",1,"button","is-fullwidth","mb-1","is-success",3,"disabled","click"],_e,[4,"ngFor","ngForOf"],[1,"button","is-fullwidth","mb-1",3,"id","disabled","click"],[3,"icon"],[1,"notification"],["id","accept",1,"button","is-fullwidth","mb-1","is-success",3,"click"],be,["id","reject",1,"button","is-fullwidth","mb-1","is-danger",3,"click"],Ve,["id","requestRejected",1,"notification","is-danger"],dt,["id","getRequestAwaitingReply",1,"notification"],Xt,["id","backToServerButton","routerLink","/lobby",1,"button","is-primary","is-fullwidth","mb-1"],u1]},template:function(e,n){1&e&&(z(0,jgt,2,2,"app-part-creation",0)(1,Tpt,28,25,"div",1),E(2,"div",2)(3,"div",3),V(4,"app-chat",4),P()()),2&e&&(v("ngIf",!1===n.gameStarted),m(),v("ngIf",n.gameStarted),m(3),v("chatId",n.currentPartId)("turn",null==n.currentPart?null:n.currentPart.getTurn()))},dependencies:[zt,Nt,bt,Oc,n0,Av,aR,cR],encapsulation:2})};var fR;function bpt(r,t){if(1&r&&(E(0,"option",28),ot(1),P()),2&r){const e=t.$implicit;v("value",e.name),m(),Cn(e.name)}}function Apt(r,t){if(1&r&&(E(0,"option",28),se(1,32),P()),2&r){const e=t.$implicit;v("value",e.name),m(),Bn(e.name),Yn(1)}}function Npt(r,t){if(1&r){const e=he();E(0,"select",29),I4("ngModelChange",function(i){te(e);const o=p(3);return o6(o.aiOptions[0],i)||(o.aiOptions[0]=i),ne(i)}),q("change",function(){te(e);const i=p(3);return ne(i.updatePlayer(i.Player.ZERO))}),E(1,"option",30),se(2,31),P(),z(3,Apt,2,2,"option",19),P()}if(2&r){const e=p(3);N4("ngModel",e.aiOptions[0]),m(3),v("ngForOf",e.availableAIOptions(0))}}function Ipt(r,t){if(1&r&&(E(0,"p",33),se(1,34),P()),2&r){const e=p(3);m(),Bn(e.gameComponent.scores.get().get(e.Player.ZERO)),Yn(1)}}function kpt(r,t){if(1&r&&(E(0,"option",28),ot(1),P()),2&r){const e=t.$implicit;v("value",e.name),m(),Cn(e.name)}}function Rpt(r,t){if(1&r&&(E(0,"option",28),se(1,37),P()),2&r){const e=t.$implicit;v("value",e.name),m(),Bn(e.name),Yn(1)}}function xpt(r,t){if(1&r){const e=he();E(0,"select",35),I4("ngModelChange",function(i){te(e);const o=p(3);return o6(o.aiOptions[1],i)||(o.aiOptions[1]=i),ne(i)}),q("change",function(){te(e);const i=p(3);return ne(i.updatePlayer(i.Player.ONE))}),E(1,"option",30),se(2,36),P(),z(3,Rpt,2,2,"option",19),P()}if(2&r){const e=p(3);N4("ngModel",e.aiOptions[1]),m(3),v("ngForOf",e.availableAIOptions(1))}}function Lpt(r,t){if(1&r&&(E(0,"p",38),se(1,39),P()),2&r){const e=p(3);m(),Bn(e.gameComponent.scores.get().get(e.Player.ONE)),Yn(1)}}function zpt(r,t){if(1&r&&(E(0,"h4",43),ot(1),P()),2&r){const e=p(4);m(),Cn(e.winnerMessage.get())}}function Dpt(r,t){1&r&&(E(0,"h4",44),se(1,45),P())}function Vpt(r,t){if(1&r&&(E(0,"div",40),z(1,zpt,2,1,"h4",41)(2,Dpt,2,0,"h4",42),P()),2&r){const e=p(3);m(),v("ngIf",e.winnerMessage.isPresent()),m(),v("ngIf",e.winnerMessage.isAbsent())}}function Hpt(r,t){if(1&r){const e=he();E(0,"div",9)(1,"div",10)(2,"p",11),se(3,12),P()(),E(4,"div",13)(5,"div",14)(6,"div",15)(7,"select",16),q("change",function(){te(e);const i=p(2);return ne(i.updatePlayer(i.Player.ZERO))}),I4("ngModelChange",function(i){te(e);const o=p(2);return o6(o.playerSelection[0],i)||(o.playerSelection[0]=i),ne(i)}),E(8,"option",17),se(9,18),P(),z(10,bpt,2,2,"option",19),P()(),E(11,"div",15),z(12,Npt,4,2,"select",20),P(),z(13,Ipt,2,1,"p",21),P(),E(14,"div",22)(15,"div",15)(16,"select",23),q("change",function(){te(e);const i=p(2);return ne(i.updatePlayer(i.Player.ONE))}),I4("ngModelChange",function(i){te(e);const o=p(2);return o6(o.playerSelection[1],i)||(o.playerSelection[1]=i),ne(i)}),E(17,"option",17),se(18,24),P(),z(19,kpt,2,2,"option",19),P()(),E(20,"div",15),z(21,xpt,4,2,"select",25),P(),z(22,Lpt,2,1,"p",26),P()(),z(23,Vpt,3,2,"div",27),P()}if(2&r){const e=p(2);m(3),Bn(e.gameComponent.getTurn()+1),Yn(3),m(4),N4("ngModel",e.playerSelection[0]),m(3),v("ngForOf",e.gameComponent.availableAIs),m(2),v("ngIf",!1===e.players[0].equalsValue("human")),m(),v("ngIf",e.gameComponent.scores.isPresent()),m(3),N4("ngModel",e.playerSelection[1]),m(3),v("ngForOf",e.gameComponent.availableAIs),m(2),v("ngIf",!1===e.players[1].equalsValue("human")),m(),v("ngIf",e.gameComponent.scores.isPresent()),m(),v("ngIf",e.endGame)}}function Fpt(r,t){if(1&r){const e=he();E(0,"button",52),q("click",function(){return te(e),ne(p(3).gameComponent.pass())}),se(1,53),P()}}function Upt(r,t){if(1&r){const e=he();E(0,"button",54),q("click",function(){return te(e),ne(p(3).takeBack())}),se(1,55),P()}}function Gpt(r,t){if(1&r&&(jt(0),ot(1),V(2,"br"),Zt()),2&r){const e=t.$implicit,n=p(4);m(),ii(" ",e.name+": "+e.getInfo(n.gameComponent.node,n.gameComponent.config)," ")}}function Bpt(r,t){if(1&r&&(E(0,"div",56),z(1,Gpt,3,1,"ng-container",57),ot(2),V(3,"br"),ot(4),V(5,"br"),P()),2&r){const e=p(3);m(),v("ngForOf",e.gameComponent.availableAIs),m(),ii(" Created ",e.getCreatedNodes()," nodes."),m(2),ii(" Minimax time: ",e.getMinimaxTime(),"ms.")}}function $pt(r,t){if(1&r){const e=he();E(0,"div",46),z(1,Fpt,2,0,"button",47)(2,Upt,2,0,"button",48),E(3,"button",49),q("click",function(){return te(e),ne(p(2).restartGame())}),se(4,50),P(),z(5,Bpt,6,3,"div",51),P()}if(2&r){const e=p(2);m(),v("ngIf",!1===e.endGame&&e.gameComponent.canPass),m(),v("ngIf",e.canTakeBack()),m(3),v("ngIf",e.gameComponent.node.previousMove.isPresent()&&e.displayAIInfo())}}function Wpt(r,t){if(1&r&&(E(0,"div")(1,"div",2)(2,"div",3),z(3,Hpt,24,10,"div",4)(4,$pt,6,3,"div",5),P(),E(5,"div",6)(6,"div",7),V(7,"div",null,8),P()()()()),2&r){const e=p();m(3),v("ngIf",e.gameComponent),m(),v("ngIf",e.gameComponent),m(),v("ngClass",e.getBoardHighlight())}}function qpt(r,t){if(1&r){const e=he();E(0,"div",58)(1,"app-rules-configuration",59),q("updateCallback",function(i){return te(e),ne(p().updateConfig(i))}),P(),E(2,"div",60)(3,"div",61)(4,"div",62)(5,"div",63)(6,"button",64),q("click",function(){return te(e),ne(p().markConfigAsFilled())}),se(7,65),P()()()()()()}if(2&r){const e=p();m(),v("stateProvider",e.getStateProvider())("rulesConfigDescriptionOptional",e.getRulesConfigDescription())("userIsCreator",!0),m(5),v("disabled",e.rulesConfig.isAbsent())}}uR=function(r,t,e,n){var s,i=arguments.length,o=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,e):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,t,e,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(t,e,o):s(t,e))||o);return i>3&&o&&Object.defineProperty(t,e,o),o}([Ae.log],uR);let dR=class TR extends bv{static#e=fR=this;cdr;static AI_TIMEOUT=1;aiOptions=["none","none"];playerSelection=["human","human"];winnerMessage=h.empty();displayAIMetrics=!1;configIsSet=!1;rulesConfig=h.empty();configBS=new Xo(h.empty());configObs=this.configBS.asObservable();constructor(t,e,n,i,o){super(t,e,n,i),this.cdr=o,this.players=[h.of(this.playerSelection[0]),h.of(this.playerSelection[1])],this.role=O.ZERO,this.setDefaultRulesConfig()}setDefaultRulesConfig(){const t=this.getGameName();this.rulesConfig=ok.getGameDefaultConfig(t)}getCreatedNodes(){return FQ.createdNodes}getMinimaxTime(){return aIe.aiTime}ngAfterViewInit(){var t=this;window.setTimeout(M(function*(){(yield t.createMatchingGameComponent())&&(yield t.restartGame(),t.cdr.detectChanges())}),1)}updatePlayer(t){var e=this;return M(function*(){e.players[t.getValue()]=h.of(e.playerSelection[t.getValue()]),"human"===e.playerSelection[1]&&"human"!==e.playerSelection[0]?(e.gameComponent.setInteractive(!1),yield e.setRole(O.ONE)):(e.gameComponent.setInteractive(!0),yield e.setRole(O.ZERO)),yield e.proposeAIToPlay()})()}onLegalUserMove(t){var e=this;return M(function*(){const n=yield e.getConfig();e.gameComponent.node=e.gameComponent.rules.choose(e.gameComponent.node,t,n).get(),yield e.proposeAIToPlay()})()}updateBoard(t){var e=this;return M(function*(){yield e.updateBoardAndShowLastMove(t);const n=yield e.getConfig(),i=e.gameComponent.rules.getGameStatus(e.gameComponent.node,n);if(!0===i.isEndGame&&(e.endGame=!0,i.winner.isPlayer())){const o=$localize`Player ${i.winner.getValue()+1}`,a=i.winner.getOpponent().getValue();e.winnerMessage=e.players[i.winner.getValue()].equalsValue("human")?e.players[a].equalsValue("human")?h.of($localize`${o} won`):h.of($localize`You won`):e.players[a].equalsValue("human")?h.of($localize`You lost`):h.of($localize`${e.players[i.winner.getValue()].get()} (Player ${i.winner.getValue()+1}) won`)}})()}proposeAIToPlay(){var t=this;return M(function*(){if(yield t.hasSelectedAI()){t.gameComponent.setInteractive(!1),yield t.updateBoard(!1);const e=t.getPlayingAI();e.isPresent()&&window.setTimeout(M(function*(){yield t.doAIMove(e.get().ai,e.get().options)}),fR.AI_TIMEOUT)}else t.gameComponent.setInteractive(!0),yield t.updateBoard(!1),t.cdr.detectChanges()})()}hasSelectedAI(){var t=this;return M(function*(){const e=yield t.getConfig();if(t.gameComponent.rules.getGameStatus(t.gameComponent.node,e).isEndGame)return!1;const n=t.gameComponent.getTurn()%2;return"human"!==t.playerSelection[n]})()}getPlayingAI(){const t=this.gameComponent.getTurn()%2,e=this.findAI(t);if(e.isPresent()){const n=e.get(),i=this.aiOptions[t];return h.ofNullable(n.availableOptions.find(s=>s.name===i)).map(s=>({ai:n,options:s}))}return h.empty()}findAI(t){return h.ofNullable(this.gameComponent.availableAIs.find(e=>this.players[t].equalsValue(e.name)))}getStateProvider(){const t=this.getGameName(),e=Ht.getByUrlName(t);return e.isPresent()?h.of(i=>e.get().rules.getInitialState(i)):h.empty()}doAIMove(t,e){var n=this;return M(function*(){const i=n.gameComponent.rules,o=yield n.getConfig(),s=i.getGameStatus(n.gameComponent.node,o);L.assert(s===ye.ONGOING,"AI should not try to play when game is over!");const a=t.chooseNextMove(n.gameComponent.node,e,o),c=i.choose(n.gameComponent.node,a,o);return c.isSuccess()?(n.gameComponent.node=c.get(),yield n.updateBoard(!0),n.cdr.detectChanges(),yield n.proposeAIToPlay(),w.SUCCESS):(n.messageDisplayer.criticalMessage($localize`The AI chose an illegal move! This is an unexpected situation that we logged, we will try to solve this as soon as possible. In the meantime, consider that you won!`),u2.logError("LocalGameWrapper","AI chose illegal move",{game:n.getGameName(),name:t.name,move:a.toString(),reason:c.getReason()}))})()}availableAIOptions(t){return this.findAI(t).get().availableOptions}canTakeBack(){return this.players[0].equalsValue("human")?this.gameComponent.getTurn()>0:!!this.players[1].equalsValue("human")&&this.gameComponent.getTurn()>1}takeBack(){var t=this;return M(function*(){t.gameComponent.node=t.gameComponent.node.parent.get(),t.isAITurn()&&(L.assert(t.gameComponent.node.parent.isPresent(),"Cannot take back in first turn when AI is Player.ZERO"),t.gameComponent.node=t.gameComponent.node.parent.get()),yield t.updateBoardAndShowLastMove(!1)})()}isAITurn(){return this.getPlayingAI().isPresent()}restartGame(){var t=this;return M(function*(){const e=yield t.getConfig();t.gameComponent.node=t.gameComponent.rules.getInitialNode(e),t.gameComponent.hideLastMove(),yield t.gameComponent.updateBoard(!1),t.endGame=!1,t.winnerMessage=h.empty(),yield t.proposeAIToPlay()})()}getPlayer(){return"human"}onCancelMove(t){var e=this;return M(function*(){if(e.gameComponent.node.previousMove.isPresent()){const n=e.gameComponent.node.previousMove.get(),i=yield e.getConfig();yield e.gameComponent.showLastMove(n,i)}})()}getConfig(){var t=this;return M(function*(){let e=h.empty();const i=yield new Promise(o=>{e=h.of(t.configObs.subscribe(s=>{s.isPresent()&&o(s.get())}))});return e.get().unsubscribe(),h.of(i)})()}updateConfig(t){this.rulesConfig=t,t.isPresent()&&0===Object.keys(t.get()).length&&this.markConfigAsFilled()}isConfigSet(){return this.configIsSet}markConfigAsFilled(){this.configIsSet=!0,this.cdr.detectChanges(),this.configBS.next(this.rulesConfig)}displayAIInfo(){return"true"===localStorage.getItem("displayAIInfo")}static \u0275fac=function(e){return new(e||TR)(G(ao),G(gr),G(Qn),G(Ut),G(Vs))};static \u0275cmp=Ue({type:TR,selectors:[["app-local-game-wrapper"]],features:[$e],decls:2,vars:2,consts:()=>{let t,e,n,i,o,s,a,c,l,u,f,g,y,S;return t=$localize`Turn n${"\ufffd0\ufffd"}:INTERPOLATION:`,e=$localize`Human`,n=$localize`Human`,i=$localize`Pick the options`,o=$localize`${"\ufffd0\ufffd"}:INTERPOLATION:`,s=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: points`,a=$localize`Pick the options`,c=$localize`${"\ufffd0\ufffd"}:INTERPOLATION:`,l=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: points`,u=$localize`Draw`,f=$localize`Start a new game`,g=$localize`Pass a turn`,y=$localize`Take back move`,S=$localize`Start with this config`,[[4,"ngIf"],["class","box",4,"ngIf"],[1,"tile","is-ancestor"],[1,"tile","is-3","is-vertical","is-parent"],["id","info","class","tile is-child box has-text-centered",4,"ngIf"],["class","tile is-child box is-vcentered",4,"ngIf"],[1,"tile","is-parent","is-9","is-vcentered",3,"ngClass"],["id","board",1,"tile","is-child","box"],["board",""],["id","info",1,"tile","is-child","box","has-text-centered"],["id","turnIndicator",1,"block"],[1,"subtitle"],t,["id","playerSelector",1,"columns"],[1,"column","is-6","is-vcentered"],[1,"select"],["id","playerZeroSelect",3,"ngModel","change","ngModelChange"],["selected","","value","human"],e,[3,"value",4,"ngFor","ngForOf"],["id","aiZeroLevelSelect",3,"ngModel","ngModelChange","change",4,"ngIf"],["id","scoreZero","class","block",4,"ngIf"],[1,"column","is-6"],["id","playerOneSelect",3,"ngModel","change","ngModelChange"],n,["id","aiOneLevelSelect",3,"ngModel","ngModelChange","change",4,"ngIf"],["id","scoreOne","class","block",4,"ngIf"],["id","gameResult","class","block",4,"ngIf"],[3,"value"],["id","aiZeroLevelSelect",3,"ngModel","ngModelChange","change"],["selected","","value","none"],i,o,["id","scoreZero",1,"block"],s,["id","aiOneLevelSelect",3,"ngModel","ngModelChange","change"],a,c,["id","scoreOne",1,"block"],l,["id","gameResult",1,"block"],["id","winner",4,"ngIf"],["id","draw",4,"ngIf"],["id","winner"],["id","draw"],u,[1,"tile","is-child","box","is-vcentered"],["id","passButton","class","button is-primary is-fullwidth mb-1",3,"click",4,"ngIf"],["id","takeBack","class","button is-fullwidth mb-1",3,"click",4,"ngIf"],["id","restartButton",1,"button","is-fullwidth",3,"click"],f,["id","AIInfo",4,"ngIf"],["id","passButton",1,"button","is-primary","is-fullwidth","mb-1",3,"click"],g,["id","takeBack",1,"button","is-fullwidth","mb-1",3,"click"],y,["id","AIInfo"],[4,"ngFor","ngForOf"],[1,"box"],["id","rulesConfigComponent",3,"stateProvider","rulesConfigDescriptionOptional","userIsCreator","updateCallback"],[1,"field","is-horizontal"],[1,"field-body"],[1,"field"],[1,"control"],["id","startGameWithConfig",1,"button","is-primary","is-fullwidth",3,"disabled","click"],S]},template:function(e,n){1&e&&z(0,Wpt,9,3,"div",0)(1,qpt,8,4,"div",1),2&e&&(v("ngIf",n.isConfigSet()),m(),v("ngIf",!1===n.isConfigSet()))},dependencies:[zt,Nt,bt,N8,I8,Np,vc,nf,Vse],encapsulation:2,changeDetection:0})};function jpt(r,t){if(1&r&&(E(0,"div",35)(1,"div",36),se(2,37),P(),E(3,"div",38),ot(4),P()()),2&r){const e=p();m(4),Cn(e.errorMessage)}}dR=fR=function(r,t,e,n){var s,i=arguments.length,o=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,e):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,t,e,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(t,e,o):s(t,e))||o);return i>3&&o&&Object.defineProperty(t,e,o),o}([Ae.log],dR);const Zpt=()=>["/login"];let Ypt=(()=>{class r{connectedUserService;router;faEye=wk;errorMessage;registrationForm=new yc({email:new ko,username:new ko,password:new ko});constructor(e,n){this.connectedUserService=e,this.router=n}registerWithEmail(){var e=this;return M(function*(){const n=e.registrationForm.value.username,i=e.registrationForm.value.email,o=e.registrationForm.value.password;if(null==n||null==i||null==o)e.errorMessage=$localize`There are missing fields in the registration form, please check that you filled in all fields.`;else{const s=yield e.connectedUserService.doRegister(n,i,o);if(s.isSuccess()){const a=yield e.connectedUserService.sendEmailVerification();a.isSuccess()?yield e.router.navigate(["/verify-account"]):e.errorMessage=a.getReason()}else e.errorMessage=s.getReason()}})()}registerWithGoogle(){var e=this;return M(function*(){const n=yield e.connectedUserService.doGoogleLogin();n.isSuccess()?yield e.router.navigate(["/verify-account"]):e.errorMessage=n.getReason()})()}getPasswordHelpClass(){const e=this.registrationForm.value.password;return null==e||""===e?"":e.length<6?"is-danger":"is-success"}canRegister(){const e=this.registrationForm.value.password??"";return!(""===(this.registrationForm.value.email??"")||""===(this.registrationForm.value.username??"")||""===e||e.length<6)}static \u0275fac=function(n){return new(n||r)(G(gr),G(Qn))};static \u0275cmp=Ue({type:r,selectors:[["app-register"]],decls:56,vars:7,consts:()=>{let e,n,i,o,s,a,c,l,u,f,g,y,S,N;return e=$localize`Registering`,n=$localize`Email`,i=$localize`Email`,o=$localize`A confirmation email will be sent to validate your account.`,s=$localize`Username`,a=$localize`Username`,c=$localize`Password`,l=$localize`Password`,u=$localize`The password should be at least 6 characters long`,f=$localize`Register`,g=$localize`Register with Google`,y=$localize`Have an account?`,S=$localize`Log in`,N=$localize`Registration error`,[[1,"box"],[1,"title"],e,[3,"formGroup"],[1,"field","is-horizontal"],[1,"field-label","is-normal"],["for","email",1,"label"],n,[1,"field-body"],[1,"field"],[1,"control"],["id","email","formControlName","email","name","email","placeholder",i,"type","email","autofocus","","required","",1,"input"],[1,"help"],o,["for","username",1,"label"],s,["id","username","formControlName","username","name","username","placeholder",a,"type","text","required","",1,"input"],["for","password",1,"label"],c,[1,"control","has-icons-right","is-expanded"],["id","password","formControlName","password","name","password","placeholder",l,"type","password","required","",1,"input"],[1,"icon","is-small","is-right"],["toggleVisibility","",1,"clickable-icon",3,"icon"],["id","passwordHelp",1,"help",3,"ngClass"],u,["id","registerButton",1,"button","is-primary","is-fullwidth",3,"disabled","click"],f,[1,"field-body","is-fullwidth"],["class","message is-danger is-fullwidth","role","alert",4,"ngIf"],["id","googleButton","type","submit",1,"button","is-fullwidth",3,"click"],g,[1,"help","level-right"],y,[3,"routerLink"],S,["role","alert",1,"message","is-danger","is-fullwidth"],[1,"message-header"],N,["id","errorMessage",1,"message-body"]]},template:function(n,i){1&n&&(E(0,"div",0)(1,"p",1),se(2,2),P(),E(3,"form",3)(4,"div",4)(5,"div",5)(6,"label",6),se(7,7),P()(),E(8,"div",8)(9,"div",9)(10,"div",10),V(11,"input",11),E(12,"p",12),se(13,13),P()()()()(),E(14,"div",4)(15,"div",5)(16,"label",14),se(17,15),P()(),E(18,"div",8)(19,"div",9)(20,"div",10),V(21,"input",16),P()()()(),E(22,"div",4)(23,"div",5)(24,"label",17),se(25,18),P()(),E(26,"div",8)(27,"div",9)(28,"div",19),V(29,"input",20),E(30,"span",21),V(31,"fa-icon",22),P(),E(32,"p",23),se(33,24),P()()()()(),E(34,"div",4),V(35,"div",5),E(36,"div",8)(37,"div",9)(38,"div",10)(39,"button",25),q("click",function(){return i.registerWithEmail()}),se(40,26),P()()()()(),E(41,"div",4),V(42,"div",5),E(43,"div",27),z(44,jpt,5,1,"div",28),P()(),E(45,"div",4),V(46,"div",5),E(47,"div",8)(48,"button",29),q("click",function(){return i.registerWithGoogle()}),se(49,30),P()()(),E(50,"p",31),jt(51),se(52,32),Zt(),ot(53,"\xa0 "),E(54,"a",33),se(55,34),P()()()()),2&n&&(m(3),v("formGroup",i.registrationForm),m(28),v("icon",i.faEye),m(),v("ngClass",i.getPasswordHelpClass()),m(7),v("disabled",!i.canRegister()),m(5),v("ngIf",i.errorMessage),m(10),v("routerLink",fr(6,Zpt)))},dependencies:[zt,bt,Oc,F4,Na,vc,H4,G4,U4,u6,n0,oR,Rse],encapsulation:2})}return r})(),Kpt=(()=>{class r{router;selectedGame;constructor(e){this.router=e}pickGame(e){this.selectedGame=e}playLocally(){var e=this;return M(function*(){yield e.router.navigate(["local/"+e.selectedGame])})()}static \u0275fac=function(n){return new(n||r)(G(Qn))};static \u0275cmp=Ue({type:r,selectors:[["app-local-game-creation"]],decls:3,vars:1,consts:()=>{let e;return e=$localize`Play offline`,[[3,"pickGame"],["id","launchGame",1,"button","is-primary","is-fullwidth",3,"disabled","click"],e]},template:function(n,i){1&n&&(E(0,"app-pick-game",0),q("pickGame",function(s){return i.pickGame(s)}),P(),E(1,"button",1),q("click",function(){return i.playLocally()}),se(2,2),P()),2&n&&(m(),v("disabled",!i.selectedGame))},dependencies:[ik],encapsulation:2})}return r})(),Xpt=(()=>{class r{router;selectedGame;constructor(e){this.router=e}pickGame(e){this.selectedGame=e}launchTutorial(){var e=this;return M(function*(){yield e.router.navigate(["/tutorial/",e.selectedGame])})()}static \u0275fac=function(n){return new(n||r)(G(Qn))};static \u0275cmp=Ue({type:r,selectors:[["app-tutorial-game-creation"]],decls:3,vars:1,consts:()=>{let e;return e=$localize`Learn the rules`,[[3,"pickGame"],["id","launchTutorial",1,"button","is-primary","is-fullwidth",3,"disabled","click"],e]},template:function(n,i){1&n&&(E(0,"app-pick-game",0),q("pickGame",function(s){return i.pickGame(s)}),P(),E(1,"button",1),q("click",function(){return i.launchTutorial()}),se(2,2),P()),2&n&&(m(),v("disabled",!i.selectedGame))},dependencies:[ik],encapsulation:2})}return r})(),Qpt=(()=>{class r{static \u0275fac=function(n){return new(n||r)};static \u0275cmp=Ue({type:r,selectors:[["app-next-game-loading"]],decls:2,vars:0,consts:()=>{let e;return e=$localize`The replay game is loading, please wait, it should not take long.`,[e]},template:function(n,i){1&n&&(E(0,"p"),se(1,0),P())},encapsulation:2})}return r})();function Jpt(r,t){1&r&&(E(0,"p",20),se(1,21),P())}function emt(r,t){if(1&r){const e=he();E(0,"div",7)(1,"p",8),se(2,9),P(),E(3,"div",10)(4,"p",11),se(5,12),P(),E(6,"button",13),q("click",function(){return te(e),ne(p().finalizeEmailVerification())}),se(7,14),P()(),E(8,"div",15)(9,"p",11),se(10,16),P(),E(11,"button",17),q("click",function(){return te(e),ne(p().sendEmailVerification())}),se(12,18),P()(),z(13,Jpt,2,0,"p",19),P()}if(2&r){const e=p();m(2),Bn(e.emailAddress),Yn(2),m(11),v("ngIf",e.success)}}function tmt(r,t){if(1&r){const e=he();E(0,"div",24)(1,"div",8),se(2,25),P(),E(3,"form",26)(4,"div",27)(5,"div",28),V(6,"input",29),P(),E(7,"div",28)(8,"button",30),q("click",function(){te(e);const i=p(2);return ne(i.pickUsername(i.usernameForm.value))}),se(9,31),P()()()()()}if(2&r){const e=p(2);m(3),v("formGroup",e.usernameForm)}}const nmt=()=>["/lobby"];function rmt(r,t){1&r&&(E(0,"div",32),No(1,33),V(2,"a",34),Io(),P()),2&r&&(m(2),v("routerLink",fr(1,nmt)))}function imt(r,t){if(1&r&&(jt(0),z(1,tmt,10,1,"div",22)(2,rmt,3,2,"div",23),Zt()),2&r){const e=p();m(),v("ngIf",!e.success),m(),v("ngIf",e.success)}}function omt(r,t){if(1&r&&(E(0,"div",35)(1,"div",36),ot(2),P()()),2&r){const e=p();m(2),Cn(e.errorMessage)}}let smt=(()=>{class r{connectedUserService;router;verificationType=null;success=!1;triedToFinalize=!1;errorMessage;emailAddress;userSubscription;usernameForm=new yc({username:new ko});constructor(e,n){this.connectedUserService=e,this.router=n}ngOnInit(){var e=this;return M(function*(){e.userSubscription=e.connectedUserService.subscribeToUser(function(){var n=M(function*(i){e.emailAddress=i.email.get(),i.username.isAbsent()?e.verificationType="enter-username":(e.verificationType="send-email",!0===e.triedToFinalize&&!1===i.verified&&(e.errorMessage=$localize`You have not verified your email! Click on the link in the verification email.`),!0===i.verified&&(yield e.router.navigate(["/lobby"])))});return function(i){return n.apply(this,arguments)}}())})()}pickUsername(e){var n=this;return M(function*(){const i=yield n.connectedUserService.setUsername(e.username);i.isSuccess()?n.success=!0:n.errorMessage=i.getReason()})()}sendEmailVerification(){var e=this;return M(function*(){const n=yield e.connectedUserService.sendEmailVerification();n.isSuccess()?e.success=!0:e.errorMessage=n.getReason()})()}finalizeEmailVerification(){var e=this;return M(function*(){e.triedToFinalize=!0,yield e.connectedUserService.reloadUser(),window.open(window.location.href,"_self")})()}ngOnDestroy(){null!=this.userSubscription&&null!=this.userSubscription.unsubscribe&&this.userSubscription.unsubscribe()}static \u0275fac=function(n){return new(n||r)(G(gr),G(Qn))};static \u0275cmp=Ue({type:r,selectors:[["app-verify-account"]],decls:7,vars:3,consts:()=>{let e,n,i,o,s,a,c,l,u,f,g;return e=$localize`Account verification`,n=$localize`In order to finalize your account, you must click on the link that you should have received on your email address (${"\ufffd0\ufffd"}:INTERPOLATION:). The email could be in your spam folder.`,i=$localize`Once you have verified your email, click on the following button:`,o=$localize`Finalize email verification`,s=$localize`If you have not received the verification email, click on the following button:`,a=$localize`Send verification email again`,c=$localize`The email has been sent`,l=$localize`In order to finalize your account, you must choose a username.`,u=$localize`Username`,f=$localize`Pick username`,g=$localize`Your account has now been finalized, you can go back to the ${"\ufffd#2\ufffd"}:START_LINK:list of games${"\ufffd/#2\ufffd"}:CLOSE_LINK:.`,[[1,"box"],[1,"message","is-info"],[1,"message-header"],e,["class","message-body","id","verificationEmail",4,"ngIf"],[4,"ngIf"],["class","message is-danger",4,"ngIf"],["id","verificationEmail",1,"message-body"],[1,"block"],n,[1,"block","level-left"],[1,"level-item"],i,["id","finalizeVerification",1,"button","is-primary","level-item","is-small",3,"click"],o,[1,"level-left"],s,["id","sendEmail",1,"button","is-warning","level-item","is-small",3,"click"],a,["id","success","class","help is-success",4,"ngIf"],["id","success",1,"help","is-success"],c,["id","askUsername","class","message-body",4,"ngIf"],["id","success","class","message-body",4,"ngIf"],["id","askUsername",1,"message-body"],l,[3,"formGroup"],[1,"field","has-addons"],[1,"control"],["id","username","type","text","placeholder",u,"name","username","required","","formControlName","username",1,"input"],["id","pickUsername",1,"button","is-info",3,"click"],f,["id","success",1,"message-body"],g,[3,"routerLink"],[1,"message","is-danger"],["id","errorMessage",1,"message-body"]]},template:function(n,i){1&n&&(E(0,"div",0)(1,"div",1)(2,"div",2),se(3,3),P(),z(4,emt,14,2,"div",4)(5,imt,3,2,"ng-container",5),P(),z(6,omt,3,1,"div",6),P()),2&n&&(m(4),v("ngIf","send-email"===i.verificationType),m(),v("ngIf","enter-username"===i.verificationType),m(),v("ngIf",i.errorMessage))},dependencies:[bt,Oc,F4,Na,vc,H4,G4,U4,u6],encapsulation:2})}return r})();function amt(r,t){1&r&&(E(0,"p",17),se(1,18),P())}function cmt(r,t){if(1&r&&(E(0,"div",19)(1,"div",20),se(2,21),P(),E(3,"div",22),ot(4),P()()),2&r){const e=p();m(4),Cn(e.errorMessage.get())}}const lmt=()=>({standalone:!0});let umt=(()=>{class r{connectedUserService;constructor(e){this.connectedUserService=e}success=!1;errorMessage=h.empty();email="";resetPassword(){var e=this;return M(function*(){pn(""!==e.email,"No email was entered, but it should not be possible to submit the form then!"),e.errorMessage=h.empty(),e.success=!1;const n=yield e.connectedUserService.sendPasswordResetEmail(e.email);n.isSuccess()?e.success=!0:e.errorMessage=h.of(n.getReason())})()}static \u0275fac=function(n){return new(n||r)(G(gr))};static \u0275cmp=Ue({type:r,selectors:[["app-reset-password"]],decls:17,vars:6,consts:()=>{let e,n,i,o,s,a,c;return e=$localize`Password reset`,n=$localize`Email`,i=$localize`Email`,o=$localize`An email will be sent with instruction to reset your password.`,s=$localize`Reset password`,a=$localize`The email has been sent, please follow the instructions from that email.`,c=$localize`Error`,[[1,"box"],[1,"title"],e,[1,"field","is-horizontal"],[1,"field-label","is-normal"],["for","email",1,"label"],n,[1,"field-body"],[1,"field"],[1,"control"],["id","email","name","email","placeholder",i,"type","email","autofocus","","required","",1,"input",3,"ngModel","ngModelOptions","ngModelChange"],[1,"help"],o,["id","successMessage","class","help is-success",4,"ngIf"],["id","resetPasswordButton",1,"button","is-primary","is-fullwidth","block",3,"disabled","click"],s,["class","message is-danger is-fullwidth","role","alert",4,"ngIf"],["id","successMessage",1,"help","is-success"],a,["role","alert",1,"message","is-danger","is-fullwidth"],[1,"message-header"],c,["id","errorMessage",1,"message-body"]]},template:function(n,i){1&n&&(E(0,"div",0)(1,"p",1),se(2,2),P(),E(3,"div",3)(4,"div",4)(5,"label",5),se(6,6),P()(),E(7,"div",7)(8,"div",8)(9,"div",9)(10,"input",10),I4("ngModelChange",function(s){return o6(i.email,s)||(i.email=s),s}),P(),E(11,"p",11),se(12,12),P(),z(13,amt,2,0,"p",13),P()()()(),E(14,"button",14),q("click",function(){return i.resetPassword()}),se(15,15),P(),z(16,cmt,5,1,"div",16),P()),2&n&&(m(10),N4("ngModel",i.email),v("ngModelOptions",fr(5,lmt)),m(3),v("ngIf",i.success),m(),v("disabled",""===i.email),m(2),v("ngIf",i.errorMessage.isPresent()))},dependencies:[bt,Na,vc,G4,nf,oR],encapsulation:2})}return r})();function fmt(r,t){if(1&r&&(E(0,"option",13),ot(1),P()),2&r){const e=t.$implicit,n=p();v("value",e.value)("selected",e.value===n.currentTheme),m(),ii(" ",e.name," ")}}function dmt(r,t){if(1&r&&(E(0,"option",13),ot(1),P()),2&r){const e=t.$implicit,n=p();v("value",e.value)("selected",e.value===n.currentLanguage),m(),ii(" ",e.name," ")}}let hmt=(()=>{class r{userSettingsService;availableLanguages=[{value:"fr",name:"Fran\xe7ais"},{value:"en",name:"English"}];availableThemes=[{value:"light",name:$localize`Light`},{value:"dark",name:$localize`Dark`}];currentTheme;currentLanguage;constructor(e,n){this.userSettingsService=e,this.currentTheme=n.getTheme(),this.currentLanguage=this.userSettingsService.getLanguage()}changeLanguage(e){this.userSettingsService.changeLanguage(e.target.value),this.reload()}changeTheme(e){this.userSettingsService.changeTheme(e.target.value),this.reload()}reload(){window.open(window.location.href,"_self")}static \u0275fac=function(n){return new(n||r)(G(_ee),G(fv))};static \u0275cmp=Ue({type:r,selectors:[["app-settings"]],decls:17,vars:2,consts:()=>{let e,n,i;return e=$localize`User settings`,n=$localize`Theme`,i=$localize`Language`,[[1,"box"],[1,"title"],e,[1,"field"],["for","theme",1,"label"],n,[1,"control"],[1,"select"],["id","theme",3,"change"],[3,"value","selected",4,"ngFor","ngForOf"],["for","language",1,"label"],i,["id","language",3,"change"],[3,"value","selected"]]},template:function(n,i){1&n&&(E(0,"div",0)(1,"p",1),se(2,2),P(),E(3,"div",3)(4,"label",4),se(5,5),P(),E(6,"div",6)(7,"div",7)(8,"select",8),q("change",function(s){return i.changeTheme(s)}),z(9,fmt,2,3,"option",9),P()()()(),E(10,"div",3)(11,"label",10),se(12,11),P(),E(13,"div",6)(14,"div",7)(15,"select",12),q("change",function(s){return i.changeLanguage(s)}),z(16,dmt,2,3,"option",9),P()()()()()),2&n&&(m(9),v("ngForOf",i.availableThemes),m(7),v("ngForOf",i.availableLanguages))},dependencies:[Nt,N8,I8],encapsulation:2})}return r})(),gmt=(()=>{class r{route;router;connectedUserService;currentGameService;messageDisplayer;gameService;constructor(e,n,i,o,s,a){this.route=e,this.router=n,this.connectedUserService=i,this.currentGameService=o,this.messageDisplayer=s,this.gameService=a}ngOnInit(){var e=this;return M(function*(){yield e.createGameAndRedirectOrShowError(e.extractGameFromURL())})()}extractGameFromURL(){return L.getNonNullable(this.route.snapshot.paramMap.get("compo"))}createGameAndRedirectOrShowError(e){var n=this;return M(function*(){if(pn(n.connectedUserService.user.get().isConnected(),"User must be connected and have a username to reach this page"),!1===n.gameExists(e))return yield n.router.navigate(["/notFound",jd.NO_MATCHING_GAME(e)],{skipLocationChange:!0}),!1;const o=n.currentGameService.canUserCreate();if(o.isSuccess()){const s=yield n.gameService.createPartConfigRoomAndChat(e);return yield n.router.navigate(["/play",e,s]),!0}return n.messageDisplayer.infoMessage(o.getReason()),yield n.router.navigate(["/lobby"]),!1})()}gameExists(e){return h.ofNullable(Ht.ALL_GAMES().find(i=>i.urlName===e)).isPresent()}static \u0275fac=function(n){return new(n||r)(G(ao),G(Qn),G(gr),G(qo),G(Ut),G(bu))};static \u0275cmp=Ue({type:r,selectors:[["app-online-game-creation"]],decls:2,vars:0,consts:()=>{let e;return e=$localize`Creating online game, please wait, it should not take long.`,[e]},template:function(n,i){1&n&&(E(0,"p"),se(1,0),P())},encapsulation:2})}return r})();const pmt=["app-hive-piece",""];function mmt(r,t){1&r&&(I(),V(0,"path",10))}function _mt(r,t){1&r&&(I(),V(0,"path",11))}function Cmt(r,t){1&r&&(I(),V(0,"path",12))}function vmt(r,t){1&r&&(I(),V(0,"path",13))}function ymt(r,t){1&r&&(I(),V(0,"path",14))}let Mmt=(()=>{class r extends vd{piece;x;y;hexaLayout;layer;pieceHeight;hexaPoints="";pieceClass="";isoPointsLight="";isoPointsDark="";isoPointsStroke="";layerTransform="";hexaCenter=new _(0,0);ngAfterContentChecked(){const e=new _(this.x,this.y);this.pieceClass=this.getPlayerClass(this.piece.owner),this.hexaPoints=this.hexaLayout.getHexaPoints(),this.hexaCenter=new _(0,0);const i=this.hexaLayout.getIsoPoints(e,this.pieceHeight).map(o=>o.map(s=>s.toSVGPoint()).join(" "));this.isoPointsLight=i[0],this.isoPointsDark=i[1],this.isoPointsStroke=i[2],this.layerTransform=`translate(0 -${(this.layer+1)*this.pieceHeight})`}static \u0275fac=(()=>{let e;return function(i){return(e||(e=z1(r)))(i||r)}})();static \u0275cmp=Ue({type:r,selectors:[["","app-hive-piece",""]],inputs:{piece:"piece",x:"x",y:"y",hexaLayout:"hexaLayout",layer:"layer",pieceHeight:"pieceHeight"},features:[$e],attrs:pmt,decls:12,vars:14,consts:[["transform","translate(-60 0)"],[1,"hive_isoPointsLight","base","no-stroke","lighter",3,"ngClass"],[1,"hive_isoPointsDark","base","no-stroke","darker",3,"ngClass"],[1,"hive_isoPointsStroke","base","no-fill","small-stroke"],[1,"hive_hexaPoints","base","small-stroke",3,"ngClass"],["d","M 15.3841 1.25408 C 22.8728 -1.82428 29.9895 -8.66692 29.9895 -11.9438 C 29.9895 -12.8799 29.4656 -13.6136 28.5873 -13.906 C 27.8046 -14.1664 24.6195 -14.3188 14.4763 -7.04548 C 14.3844 -7.97908 13.9844 -8.82172 13.3836 -9.47812 C 13.4167 -9.58096 13.4394 -9.6886 13.4394 -9.80284 C 13.4394 -13.1571 9.49688 -15.9237 3.91664 -16.864 C 3.97556 -18.4007 4.88768 -22.8456 12.8845 -26.8437 C 13.4073 -27.1052 13.6191 -27.7406 13.3578 -28.2634 C 13.0953 -28.7862 12.4609 -28.9971 11.938 -28.7367 C 3.34424 -24.4397 1.97336 -19.361 1.81856 -17.1244 C 1.12448 -17.1802 0.41168 -17.2094 -0.31564 -17.2094 C -1.40548 -17.2094 -2.46052 -17.1422 -3.47128 -17.0189 C -3.59032 -19.1981 -4.86616 -24.371 -13.5975 -28.7366 C -14.1203 -28.997 -14.7548 -28.7861 -15.0172 -28.2633 C -15.2787 -27.7404 -15.0668 -27.1049 -14.5439 -26.8436 C -6.16912 -22.6568 -5.56468 -17.9801 -5.57296 -16.6665 C -10.6046 -15.5753 -14.0706 -12.9474 -14.0706 -9.8026 C -14.0706 -9.68836 -14.048 -9.58072 -14.0146 -9.47788 C -14.6715 -8.76052 -15.0833 -7.81948 -15.121 -6.78208 C -25.5504 -14.3201 -28.8038 -14.17 -29.5978 -13.9058 C -30.4761 -13.6134 -31 -12.8799 -31 -11.9438 C -31 -8.63464 -23.7414 -1.68868 -16.1718 1.3442 C -23.7414 4.3772 -31 11.3233 -31 14.6323 C -31 15.5684 -30.4761 16.3021 -29.5968 16.5955 C -29.4222 16.6533 -29.1701 16.7371 -28.7516 16.7371 C -27.2727 16.7371 -23.7153 15.6854 -14.1678 8.74748 C -13.8431 9.143 -13.5125 9.47624 -13.0664 9.73316 C -12.821 16.1545 -7.58992 21.3656 -1.50604 21.892 L -1.50604 27.23 C -1.50604 27.8149 -1.03276 28.288 -0.448 28.288 C 0.13688 28.288 0.61004 27.8148 0.61004 27.23 L 0.61004 21.892 C 6.95852 21.3656 12.0572 16.1545 12.3026 9.73316 C 12.7614 9.46892 13.1995 9.12296 13.5294 8.71304 C 23.1112 15.6825 26.6942 16.738 28.1769 16.738 C 28.5964 16.738 28.8579 16.6533 29.0335 16.5944 C 29.9118 16.302 30.4398 15.5684 30.4398 14.6322 C 30.44 11.2893 23.0366 4.23644 15.3841 1.25408 Z M -28.8921 -11.9096 C -27.3192 -12.3306 -20.102 -7.90708 -13.9077 -3.24676 C -14.6109 -2.53432 -15.059 -1.57444 -15.1169 -0.51196 C -23.053 -3.54004 -29.0001 -10.3224 -28.8921 -11.9096 Z M -15.1288 6.06848 C -15.1288 6.31232 -15.1035 6.55004 -15.0636 6.78248 C -22.932 12.527 -27.6682 14.8687 -28.8932 14.593 C -28.9924 12.9306 -22.5395 5.64788 -14.1152 2.8394 C -14.0278 2.81048 -13.9496 2.76812 -13.8756 2.72 C -13.8144 2.78096 -13.7488 2.837 -13.6838 2.89412 C -14.5674 3.67016 -15.1288 4.80368 -15.1288 6.06848 Z M 27.8827 -11.9055 C 27.9772 -10.3347 22.2198 -3.74764 14.4784 -0.65668 C 14.3818 -1.74316 13.8714 -2.71012 13.1071 -3.40516 C 19.2103 -7.978 26.2028 -12.271 27.8827 -11.9055 Z M -0.31564 -15.0932 C 5.65928 -15.0932 10.0551 -12.9976 11.0895 -10.7981 C 10.8201 -10.8519 10.5422 -10.9012 10.257 -10.9012 L -10.8881 -10.9012 C -11.1731 -10.9012 -11.4513 -10.8519 -11.7207 -10.7981 C -10.6866 -12.9976 -6.29056 -15.0932 -0.31564 -15.0932 Z M -0.31564 19.7833 C -5.79256 19.7833 -10.3106 15.551 -10.8432 10.2606 L 10.2122 10.2606 C 9.67952 15.5509 5.16128 19.7833 -0.31564 19.7833 Z M 10.257 8.14436 L -10.8881 8.14436 C -12.0599 8.14436 -13.0126 7.1948 -13.0126 6.02816 C -13.0126 4.86152 -12.0599 3.91196 -10.8881 3.91196 L 10.257 3.91196 C 11.4286 3.91196 12.3813 4.86152 12.3813 6.02816 C 12.3813 7.1948 11.4286 8.14436 10.257 8.14436 Z M 10.257 1.79588 L -10.8881 1.79588 C -12.0599 1.79588 -13.0126 0.84632 -13.0126 -0.32032 C -13.0126 -1.48696 -12.0599 -2.43652 -10.8881 -2.43652 L 10.257 -2.43652 C 11.4286 -2.43652 12.3813 -1.48696 12.3813 -0.32032 C 12.3813 0.84632 11.4286 1.79588 10.257 1.79588 Z M 10.257 -4.5526 L -10.8881 -4.5526 C -12.0599 -4.5526 -13.0126 -5.50216 -13.0126 -6.6688 C -13.0126 -7.83544 -12.0599 -8.785 -10.8881 -8.785 L 10.257 -8.785 C 11.4286 -8.785 12.3813 -7.83544 12.3813 -6.6688 C 12.3813 -5.50216 11.4286 -4.5526 10.257 -4.5526 Z M 28.3363 14.5982 C 27.2038 14.8942 22.4127 12.5611 14.4402 6.73292 C 14.4745 6.51596 14.4975 6.29504 14.4975 6.06848 C 14.4975 4.8038 13.9364 3.67028 13.0527 2.89424 C 13.1287 2.82764 13.2044 2.7602 13.2751 2.68832 C 13.3609 2.75036 13.4539 2.80436 13.5592 2.8394 C 21.9908 5.651 28.4488 12.945 28.3363 14.5982 Z",4,"ngIf"],["d","M 27.079 1.30667 L 15.7412 -4.79822 L 15.7412 -7.89145 C 15.7412 -8.39311 15.335 -8.80033 14.8324 -8.80033 L 12.1056 -8.80033 L 12.1056 -9.70918 C 12.1056 -10.4088 12.0442 -11.0941 11.927 -11.7605 L 17.9173 -14.3278 C 18.2517 -14.4705 18.4681 -14.7995 18.4681 -15.1622 L 18.4681 -25.1602 L 23.9215 -25.1602 C 24.4242 -25.1602 24.8304 -25.5674 24.8304 -26.0691 C 24.8304 -26.5718 24.4242 -26.978 23.9215 -26.978 L 17.5592 -26.978 C 17.0566 -26.978 16.6503 -26.5718 16.6503 -26.0691 L 16.6503 -15.7621 L 11.4679 -13.5404 C 10.6322 -15.9716 9.02444 -18.0467 6.93872 -19.4717 C 7.86471 -20.1312 8.47025 -21.2128 8.47025 -22.4339 C 8.47025 -24.439 6.83966 -26.0695 4.83465 -26.0695 C 4.33202 -26.0695 3.92577 -25.6623 3.92577 -25.1607 C 3.92577 -24.659 4.33202 -24.2518 4.83465 -24.2518 C 5.83716 -24.2518 6.65252 -23.4366 6.65252 -22.4339 C 6.65252 -21.4314 5.83726 -20.6161 4.83465 -20.6161 L 4.83336 -20.616 C 3.43401 -21.2012 1.89916 -21.525 0.290076 -21.525 C -1.31901 -21.525 -2.85386 -21.2012 -4.25324 -20.616 L -4.2545 -20.6161 C -5.257 -20.6161 -6.07236 -21.4313 -6.07236 -22.4339 C -6.07236 -23.4365 -5.25711 -24.2518 -4.2545 -24.2518 C -3.75186 -24.2518 -3.34563 -24.659 -3.34563 -25.1607 C -3.34563 -25.6623 -3.75186 -26.0695 -4.2545 -26.0695 C -6.25961 -26.0695 -7.89009 -24.4389 -7.89009 -22.4339 C -7.89009 -21.2127 -7.28459 -20.1312 -6.35856 -19.4717 C -8.44428 -18.0467 -10.0521 -15.9716 -10.8877 -13.5404 L -16.0702 -15.7621 L -16.0702 -26.0691 C -16.0702 -26.5718 -16.4764 -26.978 -16.979 -26.978 L -23.3419 -26.978 C -23.8445 -26.978 -24.2508 -26.5718 -24.2508 -26.0691 C -24.2508 -25.5674 -23.8445 -25.1602 -23.3419 -25.1602 L -17.8884 -25.1602 L -17.8884 -15.1622 C -17.8884 -14.7995 -17.6721 -14.4705 -17.3377 -14.3278 L -11.3474 -11.7605 C -11.4646 -11.0941 -11.526 -10.4086 -11.526 -9.70917 L -11.526 -8.80033 L -14.2527 -8.80033 C -14.7554 -8.80033 -15.1616 -8.3931 -15.1616 -7.89145 L -15.1616 -4.79822 L -26.4994 1.30667 C -26.9411 1.54388 -27.1074 2.09561 -26.8693 2.53732 C -26.7047 2.84269 -26.3912 3.01546 -26.0677 3.01546 C -25.9223 3.01546 -25.775 2.98095 -25.6378 2.90639 L -15.1617 -2.73463 L -15.1617 5.31601 L -20.2889 9.58867 C -20.6025 9.85047 -20.7034 10.2904 -20.5334 10.663 L -16.1815 20.2374 L -19.5862 26.1962 C -19.8362 26.6316 -19.6845 27.1869 -19.2482 27.4359 C -19.1064 27.5177 -18.951 27.5559 -18.7983 27.5559 C -18.4819 27.5559 -18.1757 27.3913 -18.0085 27.0978 L -14.3729 20.7354 C -14.2283 20.4818 -14.2138 20.1747 -14.3347 19.9084 L -18.5921 10.5411 L -15.1618 7.68295 L -15.1618 8.46881 C -15.1618 16.989 -8.23053 23.9203 0.28965 23.9203 C 8.80982 23.9203 15.7411 16.989 15.7411 8.46881 L 15.7411 7.68295 L 19.1714 10.5411 L 14.9141 19.9084 C 14.7932 20.1747 14.8078 20.4819 14.9522 20.7354 L 18.5878 27.0978 C 18.755 27.3913 19.0614 27.5559 19.3776 27.5559 C 19.5303 27.5559 19.6857 27.5177 19.8275 27.4359 C 20.2638 27.1869 20.4155 26.6316 20.1656 26.1962 L 16.7608 20.2374 L 21.1127 10.663 C 21.2827 10.2903 21.1817 9.85037 20.8681 9.58867 L 15.741 5.31601 L 15.741 -2.73463 L 26.2171 2.90639 C 26.3544 2.98095 26.5016 3.01546 26.647 3.01546 C 26.9705 3.01546 27.2841 2.8428 27.4486 2.53732 C 27.687 2.09561 27.5207 1.54398 27.079 1.30667 Z M -9.70827 -9.70928 C -9.70827 -15.2218 -5.22281 -19.7073 0.289757 -19.7073 C 5.80234 -19.7073 10.2878 -15.2219 10.2878 -9.70928 L 10.2878 -8.80044 L -9.70827 -8.80044 Z M -10.6171 -6.98257 L 11.1966 -6.98257 L 13.9234 -6.98257 L 13.9234 -4.26531 C 13.9233 -4.25796 13.9233 -4.25065 13.9234 -4.24316 L 13.9234 -3.87835 L 0.289757 3.79022 L -13.3439 -3.87835 L -13.3439 -4.24316 C -13.3438 -4.25051 -13.3438 -4.25786 -13.3439 -4.26531 L -13.3439 -6.98257 Z M -13.3439 8.46892 L -13.3439 5.74091 L -13.3439 5.73461 L -13.3439 -1.79295 L -0.619115 5.36501 L -0.619115 22.0715 C -7.71446 21.6021 -13.3439 15.681 -13.3439 8.46892 Z M 1.19863 22.0715 L 1.19863 5.36501 L 13.9234 -1.79295 L 13.9234 5.73471 L 13.9234 5.7408 L 13.9234 8.46902 C 13.9234 15.681 8.29409 21.6021 1.19863 22.0715 Z",4,"ngIf"],["d","M 23.1993 15.5733 C 21.3366 14.109 18.3446 11.7414 17.7296 11.2169 C 12.9652 2.64827 6.39655 -0.814228 5.07856 -1.44294 C 5.33756 -1.88486 5.4918 -2.35409 5.4918 -2.83719 C 5.4918 -3.30048 5.3294 -3.93486 5.04265 -5.01624 C 4.8512 -5.73792 4.63024 -6.57068 4.49294 -7.31486 C 4.59374 -7.31187 4.69419 -7.30891 4.79464 -7.30891 C 8.94543 -7.30891 12.7535 -9.75455 12.9341 -9.87229 C 13.1714 -10.0271 13.3373 -10.2703 13.3943 -10.5478 C 13.451 -10.8255 13.3949 -11.1144 13.2379 -11.3502 L 11.5052 -13.9494 C 13.7039 -15.6498 16.0931 -16.5487 16.1187 -16.5583 C 16.6686 -16.7613 16.9498 -17.3717 16.7467 -17.9216 C 16.5433 -18.4713 15.9332 -18.7522 15.3835 -18.5494 C 15.2491 -18.4996 12.0538 -17.304 9.38881 -14.9538 C 8.99075 -14.6026 8.91323 -14.0109 9.20786 -13.5691 L 10.8409 -11.1198 C 9.64329 -10.4953 7.44869 -9.53254 5.16354 -9.43858 C 5.21814 -9.64602 5.24334 -9.83818 5.25069 -10.0066 C 5.28989 -10.9199 4.88588 -11.8072 4.04914 -12.6442 C 3.74954 -12.9441 3.51227 -13.3816 3.26136 -13.8449 C 2.98206 -14.3609 2.65176 -14.9693 2.15511 -15.4578 C 2.8653 -18.087 7.91209 -26.8789 12.9465 -30.2572 C 13.4331 -30.5838 13.5628 -31.2431 13.2359 -31.7297 C 12.909 -32.2165 12.2501 -32.3464 11.7633 -32.0197 C 6.51594 -28.4984 1.39127 -19.8963 0.213976 -16.338 C 0.113176 -16.3457 0.00992607 -16.351 -0.0975239 -16.351 C -0.204974 -16.351 -0.308574 -16.3457 -0.409374 -16.338 C -1.58669 -19.8963 -6.71146 -28.4984 -11.9586 -32.0197 C -12.4453 -32.3465 -13.1048 -32.2168 -13.4313 -31.7297 C -13.7575 -31.2431 -13.6283 -30.5836 -13.1415 -30.2572 C -8.10712 -26.8789 -3.0603 -18.087 -2.35008 -15.4578 C -2.8469 -14.9693 -3.17709 -14.3609 -3.45639 -13.8449 C -3.70734 -13.3816 -3.94429 -12.9441 -4.24417 -12.6442 C -5.08116 -11.8072 -5.48531 -10.9199 -5.44569 -10.0066 C -5.43869 -9.83861 -5.41034 -9.64675 -5.35889 -9.43985 C -7.63784 -9.53621 -9.83525 -10.4982 -11.0349 -11.1215 L -9.4031 -13.5691 C -9.1084 -14.0109 -9.18575 -14.6025 -9.58405 -14.9538 C -12.249 -17.304 -15.4439 -18.4998 -15.5787 -18.5494 C -16.1283 -18.7529 -16.7389 -18.4714 -16.9419 -17.9216 C -17.1453 -17.3717 -16.8639 -16.7614 -16.3139 -16.5583 C -16.2894 -16.5485 -13.9065 -15.6578 -11.7003 -13.9495 L -13.4331 -11.3502 C -13.5903 -11.1144 -13.6466 -10.8255 -13.5896 -10.5478 C -13.5325 -10.2702 -13.3666 -10.027 -13.1294 -9.87229 C -12.9485 -9.75455 -9.14095 -7.30891 -4.98985 -7.30891 C -4.8894 -7.30891 -4.7886 -7.31201 -4.68815 -7.31486 C -4.82535 -6.57068 -5.04669 -5.73792 -5.23789 -5.01624 C -5.52454 -3.93472 -5.68701 -3.30048 -5.68701 -2.8372 C -5.68701 -2.35409 -5.53301 -1.885 -5.27377 -1.44294 C -6.59176 -0.814515 -13.1606 2.64715 -17.9248 11.2169 C -18.5398 11.7414 -21.5318 14.109 -23.3946 15.5733 C -23.8553 15.9355 -23.9353 16.6027 -23.5731 17.0635 C -23.3638 17.3299 -23.0524 17.4689 -22.7381 17.4689 C -22.5085 17.4689 -22.2773 17.3949 -22.0829 17.2419 C -16.329 12.7187 -16.2836 12.636 -16.1484 12.3905 C -12.7212 6.15479 -8.19525 2.75469 -5.81882 1.2894 L -6.09532 2.62182 C -6.25842 3.40845 -6.37112 4.19975 -6.43447 4.99303 C -6.63957 5.8207 -7.95109 11.2654 -7.95109 15.2755 L -7.95109 28.8035 C -7.95109 30.0442 -6.94176 31.0534 -5.6958 31.0534 C -4.54097 31.0534 -3.57917 30.1874 -3.45818 29.0391 L -3.23488 26.9188 L -2.46904 31.3227 C -2.26779 32.4787 -1.27065 33.3177 -0.0974189 33.3177 C 1.07582 33.3177 2.07325 32.4787 2.27422 31.3229 L 3.04019 26.9189 L 3.26349 29.0391 C 3.38389 30.1876 4.34632 31.0536 5.50647 31.0536 C 6.74711 31.0536 7.75644 30.0442 7.75644 28.8036 L 7.75644 15.2757 C 7.75644 11.2658 6.4452 5.82155 6.23979 4.99331 C 6.17609 4.20003 6.06374 3.40873 5.90029 2.62196 L 5.62274 1.2836 C 7.99413 2.73998 12.5115 6.12819 15.9537 12.391 C 16.0888 12.6363 16.1339 12.719 21.888 17.2422 C 22.0826 17.395 22.3137 17.4692 22.5432 17.4692 C 22.8578 17.4692 23.1687 17.3302 23.3782 17.0637 C 23.7406 16.6029 23.6603 15.9355 23.1997 15.5733 Z M -0.0974189 -0.50221 C -1.23145 -0.50221 -3.5643 -2.07335 -3.5643 -2.83621 C -3.5608 -3.05937 -3.34415 -3.87585 -3.18616 -4.47201 C -2.94361 -5.38656 -2.65811 -6.46286 -2.51829 -7.43599 L 2.32336 -7.43599 C 2.46301 -6.46286 2.74857 -5.38656 2.99126 -4.47201 C 3.14946 -3.87585 3.36587 -3.0595 3.3694 -2.83706 C 3.36958 -2.07335 1.03665 -0.50221 -0.0973489 -0.50221 Z M -2.74316 -11.143 C -2.22485 -11.6614 -1.88748 -12.2843 -1.58991 -12.834 C -1.01925 -13.8877 -0.777679 -14.2284 -0.0976289 -14.2284 C 0.582456 -14.2284 0.824166 -13.8878 1.39474 -12.834 C 1.69259 -12.2843 2.02964 -11.6614 2.54799 -11.143 C 2.93554 -10.7554 3.14232 -10.3845 3.1299 -10.0984 C 3.1229 -9.90554 3.00985 -9.71847 2.8709 -9.55872 L -3.06667 -9.55872 C -3.20527 -9.71849 -3.31727 -9.90557 -3.32532 -10.0984 C -3.33582 -10.3844 -3.13072 -10.7553 -2.74341 -11.143 Z M -5.5692 28.8171 C -5.5762 28.882 -5.63045 28.931 -5.7015 28.931 C -5.7715 28.931 -5.8289 28.8738 -5.8289 28.8036 L -5.8289 15.2757 C -5.8289 14.5074 -5.7743 13.6716 -5.6868 12.8224 L -4.56484 19.2736 Z M 0.182861 30.9593 C 0.158361 31.0959 0.0411111 31.1951 -0.0974889 31.1951 C -0.236439 31.1951 -0.354039 31.0959 -0.377839 30.9592 L -4.12024 9.4401 C -4.36139 8.05221 -4.42929 6.65441 -4.32604 5.26327 C -4.32334 5.23737 -4.32254 5.21161 -4.32254 5.18602 C -4.26619 4.47255 -4.16574 3.76092 -4.01909 3.05339 L -3.46252 0.371859 C -2.71761 0.872219 -1.89235 1.25047 -1.1611 1.45324 L -1.1611 19.804 C -1.1611 20.3903 -0.685909 20.8653 -0.0997989 20.8653 C 0.486346 20.8653 0.961506 20.3903 0.961506 19.804 L 0.961506 1.4531 C 1.6928 1.25045 2.51806 0.872079 3.26293 0.371716 L 3.8195 3.05325 C 3.96615 3.76078 4.06695 4.47241 4.12295 5.18588 C 4.12407 5.21178 4.12617 5.2374 4.12645 5.26313 C 4.2297 6.65413 4.1618 8.05193 3.92065 9.43996 Z M 5.63355 28.8035 C 5.63355 28.8737 5.57615 28.9309 5.50055 28.9309 C 5.4351 28.9309 5.38085 28.8819 5.3742 28.8168 L 4.36967 19.2735 L 5.49166 12.8221 C 5.57951 13.6713 5.63376 14.5072 5.63376 15.2754 Z",4,"ngIf"],["d","M 26.2796 -9.91591 C 26.0694 -10.4424 25.4717 -10.6985 24.9452 -10.488 L 13.9952 -6.10798 C 13.8372 -6.04429 13.6972 -5.94331 13.588 -5.8123 L 8.42091 0.388326 L 4.52341 0.388326 L 8.59528 -4.49777 C 8.68702 -4.60766 8.75434 -4.73537 8.79361 -4.87289 L 13.1189 -20.0116 L 20.6616 -29.7097 C 21.0095 -30.1573 20.9295 -30.8021 20.4821 -31.1502 C 20.0347 -31.498 19.3896 -31.4175 19.0416 -30.9702 L 11.3767 -21.1152 C 11.2958 -21.0115 11.2364 -20.8935 11.1998 -20.7668 L 6.87935 -5.64532 L 3.30485 -1.35594 C 3.18605 -2.00651 2.8709 -2.58958 2.42256 -3.04056 L 3.25011 -4.69564 C 3.50388 -5.20275 3.29829 -5.81939 2.79124 -6.07303 C 2.28436 -6.3268 1.66762 -6.12088 1.41399 -5.6137 L 0.587006 -3.95974 C 0.441806 -3.97954 0.292976 -3.99472 0.142034 -3.99472 C -0.00910632 -3.99472 -0.157276 -3.98812 -0.302971 -3.95974 L -1.12991 -5.6137 C -1.38335 -6.12068 -2.00005 -6.32611 -2.50716 -6.07303 C -3.01427 -5.81926 -3.21983 -5.20292 -2.96599 -4.69564 L -2.13845 -3.04056 C -2.58676 -2.58938 -2.90151 -2.00667 -3.02074 -1.35594 L -6.5952 -5.64532 L -10.9158 -20.7666 C -10.9547 -20.8928 -11.0118 -21.0109 -11.0926 -21.1151 L -18.7576 -30.97 C -19.1055 -31.4177 -19.7506 -31.4983 -20.198 -31.15 C -20.6454 -30.802 -20.7262 -30.157 -20.3785 -29.7096 L -12.8358 -20.0115 L -8.51046 -4.87279 C -8.47152 -4.73518 -8.40354 -4.6078 -8.31213 -4.49768 L -4.24022 0.388425 L -8.13769 0.388425 L -13.3048 -5.81223 C -13.4137 -5.94324 -13.554 -6.04521 -13.7121 -6.10791 L -24.6622 -10.4879 C -25.1888 -10.6981 -25.7861 -10.4401 -25.9966 -9.91598 C -26.2072 -9.38953 -25.9488 -8.7922 -25.4248 -8.58156 L -14.7158 -4.29806 L -9.4072 2.07245 C -9.21217 2.30642 -8.92325 2.44211 -8.61853 2.44211 L -4.49492 2.44211 L -10.118 4.85187 C -10.2909 4.92612 -10.4398 5.04591 -10.5486 5.199 L -16.0236 12.8639 C -16.0985 12.9686 -16.153 13.0867 -16.1843 13.2114 L -17.2793 17.5914 C -17.4169 18.1415 -17.0823 18.6989 -16.5324 18.8364 C -16.4489 18.8562 -16.365 18.8714 -16.2825 18.8714 C -15.8228 18.8714 -15.4041 18.5596 -15.2875 18.0936 L -14.2397 13.9027 L -9.04496 6.63014 L -3.91861 4.43304 C -4.18822 4.70496 -4.4401 4.99859 -4.67127 5.31067 L -10.4723 11.6784 C -10.5927 11.811 -10.6762 11.9724 -10.7155 12.1472 L -12.9055 22.0021 C -12.9286 22.117 -12.9404 22.2354 -12.9253 22.3524 L -11.8303 31.1123 C -11.7653 31.6316 -11.3231 32.0116 -10.8129 32.0116 C -10.7697 32.0116 -10.7275 32.009 -10.6842 32.005 C -10.1217 31.9347 -9.72255 31.4215 -9.79287 30.8589 L -10.8659 22.2755 L -8.77373 12.8608 L -6.36268 10.2144 C -6.34288 13.6592 -3.66998 19.968 0.138371 19.968 C 3.94677 19.968 6.62264 13.6592 6.6395 10.2144 L 9.05055 12.8608 L 11.1426 22.2755 L 10.0697 30.8589 C 9.99943 31.4215 10.3981 31.9346 10.961 32.005 C 11.0042 32.0083 11.0468 32.0116 11.0897 32.0116 C 11.6 32.0116 12.0421 31.6318 12.1071 31.1123 L 13.2021 22.3524 C 13.2186 22.2352 13.2087 22.1171 13.1856 22.0021 L 10.9956 12.1472 C 10.9566 11.9726 10.8728 11.8106 10.7524 11.6784 L 4.95135 5.31067 C 4.72002 4.99849 4.46804 4.70499 4.19869 4.43304 L 9.32498 6.63014 L 14.5198 13.9027 L 15.5676 18.0936 C 15.6841 18.5601 16.1027 18.8714 16.5626 18.8714 C 16.6451 18.8714 16.729 18.8648 16.8124 18.8364 C 17.3625 18.6988 17.6969 18.1415 17.5594 17.5914 L 16.4644 13.2114 C 16.4294 13.0867 16.3789 12.9686 16.3037 12.8639 L 10.8287 5.199 C 10.7198 5.04621 10.5707 4.92609 10.3981 4.85187 L 4.77501 2.44211 L 8.89863 2.44211 C 9.20289 2.44211 9.49223 2.30681 9.68729 2.07245 L 14.9959 -4.29806 L 25.7048 -8.58156 C 26.2309 -8.7921 26.4871 -9.38969 26.2765 -9.91604 Z M 3.32851 6.55639 C 3.33511 6.56299 3.34831 6.57949 3.35491 6.59533 C 3.44038 6.71413 3.52189 6.83623 3.6001 6.9615 L -3.31728 6.9615 C -3.2394 6.83643 -3.15723 6.71433 -3.07209 6.59533 C -3.06549 6.58873 -3.05229 6.57223 -3.04569 6.55639 C -2.22788 5.4365 -1.08892 4.63183 0.141308 4.63183 C 1.37151 4.63183 2.51044 5.43634 3.32825 6.55639 Z M -4.30682 10.1751 C -4.30682 9.7961 -4.25897 9.40383 -4.16987 9.01166 L 4.45319 9.01166 C 4.54229 9.4036 4.59014 9.79583 4.59014 10.1751 C 4.59014 10.5284 4.5512 10.9222 4.47728 11.3385 L -4.19435 11.3385 C -4.26695 10.9222 -4.30655 10.5285 -4.30655 10.1751 Z M 1.30499 -0.774814 L 1.30499 2.50003 L 1.30499 2.50663 L 1.30499 2.71651 C 0.928325 2.62543 0.540278 2.57461 0.141572 2.57461 C -0.257068 2.57461 -0.645313 2.62543 -1.02187 2.71651 L -1.02187 2.50663 L -1.02187 2.50003 L -1.02187 -0.774814 C -1.02187 -1.4163 -0.499981 -1.93823 0.141572 -1.93823 C 0.783092 -1.93823 1.30499 -1.41623 1.30499 -0.774814 Z M 0.141572 17.9085 C -1.29768 17.9085 -2.79123 15.6796 -3.62943 13.3916 L 3.91268 13.3916 C 3.07435 15.6796 1.58077 17.9085 0.141572 17.9085 Z",4,"ngIf"],["d","M 21.8842 2.21077 L 18.0181 2.21077 L 13.0729 -0.756106 C 12.911 -0.853707 12.7271 -0.904573 12.5381 -0.904573 L 6.18206 -0.904573 C 6.26409 -1.2402 6.30742 -1.58751 6.30742 -1.94298 C 6.30742 -2.35345 6.24815 -2.75236 6.13972 -3.13557 L 10.6647 -4.04062 C 10.9348 -4.09355 11.1726 -4.25344 11.3252 -4.48199 L 15.2411 -10.3555 L 20.0108 -11.3098 C 20.2808 -11.3628 20.5186 -11.5227 20.6712 -11.7512 L 22.7482 -14.8665 C 23.067 -15.3442 22.9382 -15.9892 22.4605 -16.3069 C 21.9817 -16.6267 21.3378 -16.4959 21.0201 -16.0192 L 19.181 -13.2611 L 14.4113 -12.3067 C 14.1413 -12.2538 13.9035 -12.0939 13.7509 -11.8653 L 9.83492 -5.99184 L 5.07504 -5.03946 C 4.8146 -5.33056 4.51767 -5.59756 4.1913 -5.83727 C 6.07121 -6.88908 7.3457 -8.89921 7.3457 -11.2028 L 7.3457 -13.4521 C 7.3457 -13.6801 7.33217 -13.9049 7.30798 -14.1266 C 7.3256 -14.1905 7.33742 -14.257 7.34266 -14.3255 C 7.34788 -14.3889 7.864 -20.6352 11.4996 -20.6352 C 17.0843 -20.6352 17.7053 -29.5377 17.7282 -29.9168 C 17.7635 -30.489 17.3284 -30.9813 16.7572 -31.0175 C 16.1861 -31.057 15.6907 -30.6188 15.6554 -30.0456 C 15.6502 -29.9729 15.0967 -22.7121 11.4996 -22.7121 C 8.14265 -22.7121 6.5767 -19.8132 5.85813 -17.4544 C 5.37949 -18.0105 4.80424 -18.4808 4.15721 -18.8374 C 4.84539 -19.5678 5.26657 -20.5387 5.26462 -21.5875 C 5.28337 -21.8035 5.40896 -23.7278 4.30508 -24.9262 C 3.76306 -25.516 3.01841 -25.8275 2.15341 -25.8275 C 1.57915 -25.8275 1.11501 -25.3623 1.11501 -24.7892 C 1.11501 -24.216 1.57915 -23.7508 2.15341 -23.7508 C 2.51691 -23.7508 2.67681 -23.6282 2.77551 -23.5223 C 3.19194 -23.0727 3.21786 -22.0716 3.19194 -21.6739 C 3.19194 -20.5286 2.2605 -19.597 1.11501 -19.597 L -0.96193 -19.597 C -2.1073 -19.597 -3.03886 -20.5284 -3.043 -21.7601 C -3.07306 -22.135 -3.01185 -23.0986 -2.6245 -23.5203 C -2.52581 -23.6272 -2.3659 -23.7508 -2.00034 -23.7508 C -1.42607 -23.7508 -0.96193 -24.216 -0.96193 -24.7892 C -0.96193 -25.3623 -1.42607 -25.8275 -2.00034 -25.8275 C -2.86533 -25.8275 -3.60997 -25.516 -4.15199 -24.9262 C -5.25588 -23.7279 -5.13015 -21.8035 -5.11569 -21.6738 C -5.11569 -20.5799 -4.69026 -19.5842 -3.99683 -18.8416 C -4.6468 -18.4846 -5.22446 -18.0128 -5.70491 -17.4546 C -6.42352 -19.8137 -7.98933 -22.7127 -11.3464 -22.7127 C -14.9311 -22.7127 -15.4971 -29.9735 -15.5022 -30.0462 C -15.5386 -30.6193 -16.0442 -31.0587 -16.605 -31.0172 C -17.1761 -30.9808 -17.6102 -30.4887 -17.5749 -29.9164 C -17.552 -29.5374 -16.931 -20.6359 -11.3463 -20.6359 C -7.72626 -20.6359 -7.19456 -14.3876 -7.18935 -14.3253 C -7.18397 -14.257 -7.17219 -14.1909 -7.15466 -14.1274 C -7.17899 -13.9057 -7.19248 -13.6806 -7.19248 -13.4525 L -7.19248 -11.2032 C -7.19248 -8.8997 -5.91799 -6.88944 -4.03808 -5.83763 C -4.36448 -5.59792 -4.66142 -5.33105 -4.92182 -5.03983 L -9.68174 -5.99221 L -13.5977 -11.8657 C -13.7503 -12.0941 -13.9881 -12.254 -14.2581 -12.3071 L -19.0278 -13.2614 L -20.8669 -16.0196 C -21.1846 -16.4963 -21.8295 -16.6271 -22.3073 -16.3073 C -22.7849 -15.9895 -22.9138 -15.3447 -22.5949 -14.8669 L -20.518 -11.7516 C -20.3654 -11.5231 -20.1275 -11.3633 -19.8576 -11.3102 L -15.0879 -10.3559 L -11.172 -4.48236 C -11.0194 -4.25393 -10.7816 -4.09401 -10.5116 -4.04098 L -5.98653 -3.13594 C -6.09507 -2.75272 -6.1542 -2.35382 -6.1542 -1.94335 C -6.1542 -1.58776 -6.11087 -1.24057 -6.02887 -0.904939 L -12.3849 -0.904939 C -12.5739 -0.904939 -12.7576 -0.85407 -12.9197 -0.756472 L -17.8648 2.21041 L -21.7311 2.21041 C -22.3053 2.21041 -22.7695 2.67564 -22.7695 3.24881 C -22.7695 3.82199 -22.3053 4.28723 -21.7311 4.28723 L -17.5773 4.28723 C -17.3883 4.28723 -17.2045 4.23634 -17.0425 4.13876 L -12.0973 1.17188 L -5.11579 1.17188 C -5.04949 1.17188 -4.98475 1.16506 -4.92182 1.15314 C -4.41144 1.72375 -3.76306 2.20335 -3.01939 2.55979 C -3.67679 3.29481 -4.07738 4.26409 -4.07738 5.32574 L -4.07738 5.72187 L -13.8876 10.627 C -14.1752 10.7713 -14.3787 11.0381 -14.441 11.3529 L -17.495 26.6212 L -20.3882 29.5143 C -20.7943 29.9204 -20.7943 30.5767 -20.3882 30.9827 C -20.1857 31.1852 -19.9198 31.2869 -19.654 31.2869 C -19.3881 31.2869 -19.1223 31.1852 -18.9198 30.9827 L -15.8045 27.8673 C -15.6591 27.7219 -15.5614 27.5381 -15.5209 27.3366 L -12.5043 12.2584 L -4.07728 8.04487 L -4.07728 8.44097 C -4.07728 9.47136 -3.69953 10.4145 -3.07635 11.1411 C -6.09774 12.3855 -8.23116 15.3606 -8.23116 18.8254 L -8.23116 22.9792 C -8.23116 27.5598 -4.50417 31.2868 0.0764775 31.2868 C 4.65712 31.2868 8.38411 27.5598 8.38411 22.9792 L 8.38411 18.8254 C 8.38411 15.3604 6.25083 12.3854 3.2293 11.1411 C 3.85249 10.4145 4.23024 9.47136 4.23024 8.44097 L 4.23024 8.04487 L 12.6572 12.2584 L 15.6739 27.3366 C 15.7144 27.538 15.812 27.7219 15.9574 27.8673 L 19.0728 30.9827 C 19.2753 31.1852 19.5412 31.2869 19.807 31.2869 C 20.0728 31.2869 20.3386 31.1852 20.5411 30.9827 C 20.9471 30.5767 20.9471 29.9203 20.5411 29.5143 L 17.648 26.6212 L 14.5939 11.3529 C 14.5315 11.0381 14.328 10.7713 14.0404 10.627 L 4.23024 5.72187 L 4.23024 5.32574 C 4.23024 4.26409 3.82962 3.29481 3.17223 2.55979 C 3.91601 2.20335 4.56426 1.72388 5.07464 1.15314 C 5.13757 1.16506 5.20219 1.17188 5.26865 1.17188 L 12.2502 1.17188 L 17.1953 4.13876 C 17.3573 4.23634 17.5411 4.28723 17.7301 4.28723 L 21.8839 4.28723 C 22.4581 4.28723 22.9223 3.82199 22.9223 3.24881 C 22.9223 2.67564 22.4585 2.21077 21.8842 2.21077 Z M -1.04894 -7.13526 C -3.29089 -7.13526 -5.11556 -8.9598 -5.11556 -11.2028 L -5.11556 -13.4521 C -5.11556 -15.6952 -3.29101 -17.5197 -1.04894 -17.5197 L 1.20238 -17.5197 C 3.44434 -17.5197 5.26901 -15.6952 5.26901 -13.4521 L 5.26901 -11.2028 C 5.26901 -8.9598 3.44444 -7.13526 1.20238 -7.13526 Z M 6.30752 18.8259 L 6.30752 22.9796 C 6.30752 26.4159 3.51308 29.2103 0.0768428 29.2103 C -3.3594 29.2103 -6.15384 26.4159 -6.15384 22.9796 L -6.15384 18.8259 C -6.15384 15.3896 -3.3594 12.5952 0.0768428 12.5952 C 3.51308 12.5952 6.30752 15.3896 6.30752 18.8259 Z M 2.15366 5.3261 L 2.15366 6.39593 L 2.15366 6.39956 L 2.15366 8.44147 C 2.15366 9.58683 1.22222 10.5184 0.076721 10.5184 C -1.06878 10.5184 -2.00022 9.58696 -2.00022 8.44147 L -2.00022 6.39956 L -2.00022 6.39593 L -2.00022 5.3261 C -2.00022 4.18074 -1.06878 3.24918 0.076721 3.24918 C 1.22222 3.24918 2.15366 4.18074 2.15366 5.3261 Z M 0.0768428 1.17236 C -2.21403 1.17236 -4.07692 -0.225404 -4.07692 -1.94298 C -4.07692 -3.66056 -2.21391 -5.05834 0.0768428 -5.05834 C 2.36759 -5.05834 4.2306 -3.66056 4.2306 -1.94298 C 4.2306 -0.225404 2.36759 1.17236 0.0768428 1.17236 Z",4,"ngIf"],["d","M 15.3841 1.25408 C 22.8728 -1.82428 29.9895 -8.66692 29.9895 -11.9438 C 29.9895 -12.8799 29.4656 -13.6136 28.5873 -13.906 C 27.8046 -14.1664 24.6195 -14.3188 14.4763 -7.04548 C 14.3844 -7.97908 13.9844 -8.82172 13.3836 -9.47812 C 13.4167 -9.58096 13.4394 -9.6886 13.4394 -9.80284 C 13.4394 -13.1571 9.49688 -15.9237 3.91664 -16.864 C 3.97556 -18.4007 4.88768 -22.8456 12.8845 -26.8437 C 13.4073 -27.1052 13.6191 -27.7406 13.3578 -28.2634 C 13.0953 -28.7862 12.4609 -28.9971 11.938 -28.7367 C 3.34424 -24.4397 1.97336 -19.361 1.81856 -17.1244 C 1.12448 -17.1802 0.41168 -17.2094 -0.31564 -17.2094 C -1.40548 -17.2094 -2.46052 -17.1422 -3.47128 -17.0189 C -3.59032 -19.1981 -4.86616 -24.371 -13.5975 -28.7366 C -14.1203 -28.997 -14.7548 -28.7861 -15.0172 -28.2633 C -15.2787 -27.7404 -15.0668 -27.1049 -14.5439 -26.8436 C -6.16912 -22.6568 -5.56468 -17.9801 -5.57296 -16.6665 C -10.6046 -15.5753 -14.0706 -12.9474 -14.0706 -9.8026 C -14.0706 -9.68836 -14.048 -9.58072 -14.0146 -9.47788 C -14.6715 -8.76052 -15.0833 -7.81948 -15.121 -6.78208 C -25.5504 -14.3201 -28.8038 -14.17 -29.5978 -13.9058 C -30.4761 -13.6134 -31 -12.8799 -31 -11.9438 C -31 -8.63464 -23.7414 -1.68868 -16.1718 1.3442 C -23.7414 4.3772 -31 11.3233 -31 14.6323 C -31 15.5684 -30.4761 16.3021 -29.5968 16.5955 C -29.4222 16.6533 -29.1701 16.7371 -28.7516 16.7371 C -27.2727 16.7371 -23.7153 15.6854 -14.1678 8.74748 C -13.8431 9.143 -13.5125 9.47624 -13.0664 9.73316 C -12.821 16.1545 -7.58992 21.3656 -1.50604 21.892 L -1.50604 27.23 C -1.50604 27.8149 -1.03276 28.288 -0.448 28.288 C 0.13688 28.288 0.61004 27.8148 0.61004 27.23 L 0.61004 21.892 C 6.95852 21.3656 12.0572 16.1545 12.3026 9.73316 C 12.7614 9.46892 13.1995 9.12296 13.5294 8.71304 C 23.1112 15.6825 26.6942 16.738 28.1769 16.738 C 28.5964 16.738 28.8579 16.6533 29.0335 16.5944 C 29.9118 16.302 30.4398 15.5684 30.4398 14.6322 C 30.44 11.2893 23.0366 4.23644 15.3841 1.25408 Z M -28.8921 -11.9096 C -27.3192 -12.3306 -20.102 -7.90708 -13.9077 -3.24676 C -14.6109 -2.53432 -15.059 -1.57444 -15.1169 -0.51196 C -23.053 -3.54004 -29.0001 -10.3224 -28.8921 -11.9096 Z M -15.1288 6.06848 C -15.1288 6.31232 -15.1035 6.55004 -15.0636 6.78248 C -22.932 12.527 -27.6682 14.8687 -28.8932 14.593 C -28.9924 12.9306 -22.5395 5.64788 -14.1152 2.8394 C -14.0278 2.81048 -13.9496 2.76812 -13.8756 2.72 C -13.8144 2.78096 -13.7488 2.837 -13.6838 2.89412 C -14.5674 3.67016 -15.1288 4.80368 -15.1288 6.06848 Z M 27.8827 -11.9055 C 27.9772 -10.3347 22.2198 -3.74764 14.4784 -0.65668 C 14.3818 -1.74316 13.8714 -2.71012 13.1071 -3.40516 C 19.2103 -7.978 26.2028 -12.271 27.8827 -11.9055 Z M -0.31564 -15.0932 C 5.65928 -15.0932 10.0551 -12.9976 11.0895 -10.7981 C 10.8201 -10.8519 10.5422 -10.9012 10.257 -10.9012 L -10.8881 -10.9012 C -11.1731 -10.9012 -11.4513 -10.8519 -11.7207 -10.7981 C -10.6866 -12.9976 -6.29056 -15.0932 -0.31564 -15.0932 Z M -0.31564 19.7833 C -5.79256 19.7833 -10.3106 15.551 -10.8432 10.2606 L 10.2122 10.2606 C 9.67952 15.5509 5.16128 19.7833 -0.31564 19.7833 Z M 10.257 8.14436 L -10.8881 8.14436 C -12.0599 8.14436 -13.0126 7.1948 -13.0126 6.02816 C -13.0126 4.86152 -12.0599 3.91196 -10.8881 3.91196 L 10.257 3.91196 C 11.4286 3.91196 12.3813 4.86152 12.3813 6.02816 C 12.3813 7.1948 11.4286 8.14436 10.257 8.14436 Z M 10.257 1.79588 L -10.8881 1.79588 C -12.0599 1.79588 -13.0126 0.84632 -13.0126 -0.32032 C -13.0126 -1.48696 -12.0599 -2.43652 -10.8881 -2.43652 L 10.257 -2.43652 C 11.4286 -2.43652 12.3813 -1.48696 12.3813 -0.32032 C 12.3813 0.84632 11.4286 1.79588 10.257 1.79588 Z M 10.257 -4.5526 L -10.8881 -4.5526 C -12.0599 -4.5526 -13.0126 -5.50216 -13.0126 -6.6688 C -13.0126 -7.83544 -12.0599 -8.785 -10.8881 -8.785 L 10.257 -8.785 C 11.4286 -8.785 12.3813 -7.83544 12.3813 -6.6688 C 12.3813 -5.50216 11.4286 -4.5526 10.257 -4.5526 Z M 28.3363 14.5982 C 27.2038 14.8942 22.4127 12.5611 14.4402 6.73292 C 14.4745 6.51596 14.4975 6.29504 14.4975 6.06848 C 14.4975 4.8038 13.9364 3.67028 13.0527 2.89424 C 13.1287 2.82764 13.2044 2.7602 13.2751 2.68832 C 13.3609 2.75036 13.4539 2.80436 13.5592 2.8394 C 21.9908 5.651 28.4488 12.945 28.3363 14.5982 Z"],["d","M 27.079 1.30667 L 15.7412 -4.79822 L 15.7412 -7.89145 C 15.7412 -8.39311 15.335 -8.80033 14.8324 -8.80033 L 12.1056 -8.80033 L 12.1056 -9.70918 C 12.1056 -10.4088 12.0442 -11.0941 11.927 -11.7605 L 17.9173 -14.3278 C 18.2517 -14.4705 18.4681 -14.7995 18.4681 -15.1622 L 18.4681 -25.1602 L 23.9215 -25.1602 C 24.4242 -25.1602 24.8304 -25.5674 24.8304 -26.0691 C 24.8304 -26.5718 24.4242 -26.978 23.9215 -26.978 L 17.5592 -26.978 C 17.0566 -26.978 16.6503 -26.5718 16.6503 -26.0691 L 16.6503 -15.7621 L 11.4679 -13.5404 C 10.6322 -15.9716 9.02444 -18.0467 6.93872 -19.4717 C 7.86471 -20.1312 8.47025 -21.2128 8.47025 -22.4339 C 8.47025 -24.439 6.83966 -26.0695 4.83465 -26.0695 C 4.33202 -26.0695 3.92577 -25.6623 3.92577 -25.1607 C 3.92577 -24.659 4.33202 -24.2518 4.83465 -24.2518 C 5.83716 -24.2518 6.65252 -23.4366 6.65252 -22.4339 C 6.65252 -21.4314 5.83726 -20.6161 4.83465 -20.6161 L 4.83336 -20.616 C 3.43401 -21.2012 1.89916 -21.525 0.290076 -21.525 C -1.31901 -21.525 -2.85386 -21.2012 -4.25324 -20.616 L -4.2545 -20.6161 C -5.257 -20.6161 -6.07236 -21.4313 -6.07236 -22.4339 C -6.07236 -23.4365 -5.25711 -24.2518 -4.2545 -24.2518 C -3.75186 -24.2518 -3.34563 -24.659 -3.34563 -25.1607 C -3.34563 -25.6623 -3.75186 -26.0695 -4.2545 -26.0695 C -6.25961 -26.0695 -7.89009 -24.4389 -7.89009 -22.4339 C -7.89009 -21.2127 -7.28459 -20.1312 -6.35856 -19.4717 C -8.44428 -18.0467 -10.0521 -15.9716 -10.8877 -13.5404 L -16.0702 -15.7621 L -16.0702 -26.0691 C -16.0702 -26.5718 -16.4764 -26.978 -16.979 -26.978 L -23.3419 -26.978 C -23.8445 -26.978 -24.2508 -26.5718 -24.2508 -26.0691 C -24.2508 -25.5674 -23.8445 -25.1602 -23.3419 -25.1602 L -17.8884 -25.1602 L -17.8884 -15.1622 C -17.8884 -14.7995 -17.6721 -14.4705 -17.3377 -14.3278 L -11.3474 -11.7605 C -11.4646 -11.0941 -11.526 -10.4086 -11.526 -9.70917 L -11.526 -8.80033 L -14.2527 -8.80033 C -14.7554 -8.80033 -15.1616 -8.3931 -15.1616 -7.89145 L -15.1616 -4.79822 L -26.4994 1.30667 C -26.9411 1.54388 -27.1074 2.09561 -26.8693 2.53732 C -26.7047 2.84269 -26.3912 3.01546 -26.0677 3.01546 C -25.9223 3.01546 -25.775 2.98095 -25.6378 2.90639 L -15.1617 -2.73463 L -15.1617 5.31601 L -20.2889 9.58867 C -20.6025 9.85047 -20.7034 10.2904 -20.5334 10.663 L -16.1815 20.2374 L -19.5862 26.1962 C -19.8362 26.6316 -19.6845 27.1869 -19.2482 27.4359 C -19.1064 27.5177 -18.951 27.5559 -18.7983 27.5559 C -18.4819 27.5559 -18.1757 27.3913 -18.0085 27.0978 L -14.3729 20.7354 C -14.2283 20.4818 -14.2138 20.1747 -14.3347 19.9084 L -18.5921 10.5411 L -15.1618 7.68295 L -15.1618 8.46881 C -15.1618 16.989 -8.23053 23.9203 0.28965 23.9203 C 8.80982 23.9203 15.7411 16.989 15.7411 8.46881 L 15.7411 7.68295 L 19.1714 10.5411 L 14.9141 19.9084 C 14.7932 20.1747 14.8078 20.4819 14.9522 20.7354 L 18.5878 27.0978 C 18.755 27.3913 19.0614 27.5559 19.3776 27.5559 C 19.5303 27.5559 19.6857 27.5177 19.8275 27.4359 C 20.2638 27.1869 20.4155 26.6316 20.1656 26.1962 L 16.7608 20.2374 L 21.1127 10.663 C 21.2827 10.2903 21.1817 9.85037 20.8681 9.58867 L 15.741 5.31601 L 15.741 -2.73463 L 26.2171 2.90639 C 26.3544 2.98095 26.5016 3.01546 26.647 3.01546 C 26.9705 3.01546 27.2841 2.8428 27.4486 2.53732 C 27.687 2.09561 27.5207 1.54398 27.079 1.30667 Z M -9.70827 -9.70928 C -9.70827 -15.2218 -5.22281 -19.7073 0.289757 -19.7073 C 5.80234 -19.7073 10.2878 -15.2219 10.2878 -9.70928 L 10.2878 -8.80044 L -9.70827 -8.80044 Z M -10.6171 -6.98257 L 11.1966 -6.98257 L 13.9234 -6.98257 L 13.9234 -4.26531 C 13.9233 -4.25796 13.9233 -4.25065 13.9234 -4.24316 L 13.9234 -3.87835 L 0.289757 3.79022 L -13.3439 -3.87835 L -13.3439 -4.24316 C -13.3438 -4.25051 -13.3438 -4.25786 -13.3439 -4.26531 L -13.3439 -6.98257 Z M -13.3439 8.46892 L -13.3439 5.74091 L -13.3439 5.73461 L -13.3439 -1.79295 L -0.619115 5.36501 L -0.619115 22.0715 C -7.71446 21.6021 -13.3439 15.681 -13.3439 8.46892 Z M 1.19863 22.0715 L 1.19863 5.36501 L 13.9234 -1.79295 L 13.9234 5.73471 L 13.9234 5.7408 L 13.9234 8.46902 C 13.9234 15.681 8.29409 21.6021 1.19863 22.0715 Z"],["d","M 23.1993 15.5733 C 21.3366 14.109 18.3446 11.7414 17.7296 11.2169 C 12.9652 2.64827 6.39655 -0.814228 5.07856 -1.44294 C 5.33756 -1.88486 5.4918 -2.35409 5.4918 -2.83719 C 5.4918 -3.30048 5.3294 -3.93486 5.04265 -5.01624 C 4.8512 -5.73792 4.63024 -6.57068 4.49294 -7.31486 C 4.59374 -7.31187 4.69419 -7.30891 4.79464 -7.30891 C 8.94543 -7.30891 12.7535 -9.75455 12.9341 -9.87229 C 13.1714 -10.0271 13.3373 -10.2703 13.3943 -10.5478 C 13.451 -10.8255 13.3949 -11.1144 13.2379 -11.3502 L 11.5052 -13.9494 C 13.7039 -15.6498 16.0931 -16.5487 16.1187 -16.5583 C 16.6686 -16.7613 16.9498 -17.3717 16.7467 -17.9216 C 16.5433 -18.4713 15.9332 -18.7522 15.3835 -18.5494 C 15.2491 -18.4996 12.0538 -17.304 9.38881 -14.9538 C 8.99075 -14.6026 8.91323 -14.0109 9.20786 -13.5691 L 10.8409 -11.1198 C 9.64329 -10.4953 7.44869 -9.53254 5.16354 -9.43858 C 5.21814 -9.64602 5.24334 -9.83818 5.25069 -10.0066 C 5.28989 -10.9199 4.88588 -11.8072 4.04914 -12.6442 C 3.74954 -12.9441 3.51227 -13.3816 3.26136 -13.8449 C 2.98206 -14.3609 2.65176 -14.9693 2.15511 -15.4578 C 2.8653 -18.087 7.91209 -26.8789 12.9465 -30.2572 C 13.4331 -30.5838 13.5628 -31.2431 13.2359 -31.7297 C 12.909 -32.2165 12.2501 -32.3464 11.7633 -32.0197 C 6.51594 -28.4984 1.39127 -19.8963 0.213976 -16.338 C 0.113176 -16.3457 0.00992607 -16.351 -0.0975239 -16.351 C -0.204974 -16.351 -0.308574 -16.3457 -0.409374 -16.338 C -1.58669 -19.8963 -6.71146 -28.4984 -11.9586 -32.0197 C -12.4453 -32.3465 -13.1048 -32.2168 -13.4313 -31.7297 C -13.7575 -31.2431 -13.6283 -30.5836 -13.1415 -30.2572 C -8.10712 -26.8789 -3.0603 -18.087 -2.35008 -15.4578 C -2.8469 -14.9693 -3.17709 -14.3609 -3.45639 -13.8449 C -3.70734 -13.3816 -3.94429 -12.9441 -4.24417 -12.6442 C -5.08116 -11.8072 -5.48531 -10.9199 -5.44569 -10.0066 C -5.43869 -9.83861 -5.41034 -9.64675 -5.35889 -9.43985 C -7.63784 -9.53621 -9.83525 -10.4982 -11.0349 -11.1215 L -9.4031 -13.5691 C -9.1084 -14.0109 -9.18575 -14.6025 -9.58405 -14.9538 C -12.249 -17.304 -15.4439 -18.4998 -15.5787 -18.5494 C -16.1283 -18.7529 -16.7389 -18.4714 -16.9419 -17.9216 C -17.1453 -17.3717 -16.8639 -16.7614 -16.3139 -16.5583 C -16.2894 -16.5485 -13.9065 -15.6578 -11.7003 -13.9495 L -13.4331 -11.3502 C -13.5903 -11.1144 -13.6466 -10.8255 -13.5896 -10.5478 C -13.5325 -10.2702 -13.3666 -10.027 -13.1294 -9.87229 C -12.9485 -9.75455 -9.14095 -7.30891 -4.98985 -7.30891 C -4.8894 -7.30891 -4.7886 -7.31201 -4.68815 -7.31486 C -4.82535 -6.57068 -5.04669 -5.73792 -5.23789 -5.01624 C -5.52454 -3.93472 -5.68701 -3.30048 -5.68701 -2.8372 C -5.68701 -2.35409 -5.53301 -1.885 -5.27377 -1.44294 C -6.59176 -0.814515 -13.1606 2.64715 -17.9248 11.2169 C -18.5398 11.7414 -21.5318 14.109 -23.3946 15.5733 C -23.8553 15.9355 -23.9353 16.6027 -23.5731 17.0635 C -23.3638 17.3299 -23.0524 17.4689 -22.7381 17.4689 C -22.5085 17.4689 -22.2773 17.3949 -22.0829 17.2419 C -16.329 12.7187 -16.2836 12.636 -16.1484 12.3905 C -12.7212 6.15479 -8.19525 2.75469 -5.81882 1.2894 L -6.09532 2.62182 C -6.25842 3.40845 -6.37112 4.19975 -6.43447 4.99303 C -6.63957 5.8207 -7.95109 11.2654 -7.95109 15.2755 L -7.95109 28.8035 C -7.95109 30.0442 -6.94176 31.0534 -5.6958 31.0534 C -4.54097 31.0534 -3.57917 30.1874 -3.45818 29.0391 L -3.23488 26.9188 L -2.46904 31.3227 C -2.26779 32.4787 -1.27065 33.3177 -0.0974189 33.3177 C 1.07582 33.3177 2.07325 32.4787 2.27422 31.3229 L 3.04019 26.9189 L 3.26349 29.0391 C 3.38389 30.1876 4.34632 31.0536 5.50647 31.0536 C 6.74711 31.0536 7.75644 30.0442 7.75644 28.8036 L 7.75644 15.2757 C 7.75644 11.2658 6.4452 5.82155 6.23979 4.99331 C 6.17609 4.20003 6.06374 3.40873 5.90029 2.62196 L 5.62274 1.2836 C 7.99413 2.73998 12.5115 6.12819 15.9537 12.391 C 16.0888 12.6363 16.1339 12.719 21.888 17.2422 C 22.0826 17.395 22.3137 17.4692 22.5432 17.4692 C 22.8578 17.4692 23.1687 17.3302 23.3782 17.0637 C 23.7406 16.6029 23.6603 15.9355 23.1997 15.5733 Z M -0.0974189 -0.50221 C -1.23145 -0.50221 -3.5643 -2.07335 -3.5643 -2.83621 C -3.5608 -3.05937 -3.34415 -3.87585 -3.18616 -4.47201 C -2.94361 -5.38656 -2.65811 -6.46286 -2.51829 -7.43599 L 2.32336 -7.43599 C 2.46301 -6.46286 2.74857 -5.38656 2.99126 -4.47201 C 3.14946 -3.87585 3.36587 -3.0595 3.3694 -2.83706 C 3.36958 -2.07335 1.03665 -0.50221 -0.0973489 -0.50221 Z M -2.74316 -11.143 C -2.22485 -11.6614 -1.88748 -12.2843 -1.58991 -12.834 C -1.01925 -13.8877 -0.777679 -14.2284 -0.0976289 -14.2284 C 0.582456 -14.2284 0.824166 -13.8878 1.39474 -12.834 C 1.69259 -12.2843 2.02964 -11.6614 2.54799 -11.143 C 2.93554 -10.7554 3.14232 -10.3845 3.1299 -10.0984 C 3.1229 -9.90554 3.00985 -9.71847 2.8709 -9.55872 L -3.06667 -9.55872 C -3.20527 -9.71849 -3.31727 -9.90557 -3.32532 -10.0984 C -3.33582 -10.3844 -3.13072 -10.7553 -2.74341 -11.143 Z M -5.5692 28.8171 C -5.5762 28.882 -5.63045 28.931 -5.7015 28.931 C -5.7715 28.931 -5.8289 28.8738 -5.8289 28.8036 L -5.8289 15.2757 C -5.8289 14.5074 -5.7743 13.6716 -5.6868 12.8224 L -4.56484 19.2736 Z M 0.182861 30.9593 C 0.158361 31.0959 0.0411111 31.1951 -0.0974889 31.1951 C -0.236439 31.1951 -0.354039 31.0959 -0.377839 30.9592 L -4.12024 9.4401 C -4.36139 8.05221 -4.42929 6.65441 -4.32604 5.26327 C -4.32334 5.23737 -4.32254 5.21161 -4.32254 5.18602 C -4.26619 4.47255 -4.16574 3.76092 -4.01909 3.05339 L -3.46252 0.371859 C -2.71761 0.872219 -1.89235 1.25047 -1.1611 1.45324 L -1.1611 19.804 C -1.1611 20.3903 -0.685909 20.8653 -0.0997989 20.8653 C 0.486346 20.8653 0.961506 20.3903 0.961506 19.804 L 0.961506 1.4531 C 1.6928 1.25045 2.51806 0.872079 3.26293 0.371716 L 3.8195 3.05325 C 3.96615 3.76078 4.06695 4.47241 4.12295 5.18588 C 4.12407 5.21178 4.12617 5.2374 4.12645 5.26313 C 4.2297 6.65413 4.1618 8.05193 3.92065 9.43996 Z M 5.63355 28.8035 C 5.63355 28.8737 5.57615 28.9309 5.50055 28.9309 C 5.4351 28.9309 5.38085 28.8819 5.3742 28.8168 L 4.36967 19.2735 L 5.49166 12.8221 C 5.57951 13.6713 5.63376 14.5072 5.63376 15.2754 Z"],["d","M 26.2796 -9.91591 C 26.0694 -10.4424 25.4717 -10.6985 24.9452 -10.488 L 13.9952 -6.10798 C 13.8372 -6.04429 13.6972 -5.94331 13.588 -5.8123 L 8.42091 0.388326 L 4.52341 0.388326 L 8.59528 -4.49777 C 8.68702 -4.60766 8.75434 -4.73537 8.79361 -4.87289 L 13.1189 -20.0116 L 20.6616 -29.7097 C 21.0095 -30.1573 20.9295 -30.8021 20.4821 -31.1502 C 20.0347 -31.498 19.3896 -31.4175 19.0416 -30.9702 L 11.3767 -21.1152 C 11.2958 -21.0115 11.2364 -20.8935 11.1998 -20.7668 L 6.87935 -5.64532 L 3.30485 -1.35594 C 3.18605 -2.00651 2.8709 -2.58958 2.42256 -3.04056 L 3.25011 -4.69564 C 3.50388 -5.20275 3.29829 -5.81939 2.79124 -6.07303 C 2.28436 -6.3268 1.66762 -6.12088 1.41399 -5.6137 L 0.587006 -3.95974 C 0.441806 -3.97954 0.292976 -3.99472 0.142034 -3.99472 C -0.00910632 -3.99472 -0.157276 -3.98812 -0.302971 -3.95974 L -1.12991 -5.6137 C -1.38335 -6.12068 -2.00005 -6.32611 -2.50716 -6.07303 C -3.01427 -5.81926 -3.21983 -5.20292 -2.96599 -4.69564 L -2.13845 -3.04056 C -2.58676 -2.58938 -2.90151 -2.00667 -3.02074 -1.35594 L -6.5952 -5.64532 L -10.9158 -20.7666 C -10.9547 -20.8928 -11.0118 -21.0109 -11.0926 -21.1151 L -18.7576 -30.97 C -19.1055 -31.4177 -19.7506 -31.4983 -20.198 -31.15 C -20.6454 -30.802 -20.7262 -30.157 -20.3785 -29.7096 L -12.8358 -20.0115 L -8.51046 -4.87279 C -8.47152 -4.73518 -8.40354 -4.6078 -8.31213 -4.49768 L -4.24022 0.388425 L -8.13769 0.388425 L -13.3048 -5.81223 C -13.4137 -5.94324 -13.554 -6.04521 -13.7121 -6.10791 L -24.6622 -10.4879 C -25.1888 -10.6981 -25.7861 -10.4401 -25.9966 -9.91598 C -26.2072 -9.38953 -25.9488 -8.7922 -25.4248 -8.58156 L -14.7158 -4.29806 L -9.4072 2.07245 C -9.21217 2.30642 -8.92325 2.44211 -8.61853 2.44211 L -4.49492 2.44211 L -10.118 4.85187 C -10.2909 4.92612 -10.4398 5.04591 -10.5486 5.199 L -16.0236 12.8639 C -16.0985 12.9686 -16.153 13.0867 -16.1843 13.2114 L -17.2793 17.5914 C -17.4169 18.1415 -17.0823 18.6989 -16.5324 18.8364 C -16.4489 18.8562 -16.365 18.8714 -16.2825 18.8714 C -15.8228 18.8714 -15.4041 18.5596 -15.2875 18.0936 L -14.2397 13.9027 L -9.04496 6.63014 L -3.91861 4.43304 C -4.18822 4.70496 -4.4401 4.99859 -4.67127 5.31067 L -10.4723 11.6784 C -10.5927 11.811 -10.6762 11.9724 -10.7155 12.1472 L -12.9055 22.0021 C -12.9286 22.117 -12.9404 22.2354 -12.9253 22.3524 L -11.8303 31.1123 C -11.7653 31.6316 -11.3231 32.0116 -10.8129 32.0116 C -10.7697 32.0116 -10.7275 32.009 -10.6842 32.005 C -10.1217 31.9347 -9.72255 31.4215 -9.79287 30.8589 L -10.8659 22.2755 L -8.77373 12.8608 L -6.36268 10.2144 C -6.34288 13.6592 -3.66998 19.968 0.138371 19.968 C 3.94677 19.968 6.62264 13.6592 6.6395 10.2144 L 9.05055 12.8608 L 11.1426 22.2755 L 10.0697 30.8589 C 9.99943 31.4215 10.3981 31.9346 10.961 32.005 C 11.0042 32.0083 11.0468 32.0116 11.0897 32.0116 C 11.6 32.0116 12.0421 31.6318 12.1071 31.1123 L 13.2021 22.3524 C 13.2186 22.2352 13.2087 22.1171 13.1856 22.0021 L 10.9956 12.1472 C 10.9566 11.9726 10.8728 11.8106 10.7524 11.6784 L 4.95135 5.31067 C 4.72002 4.99849 4.46804 4.70499 4.19869 4.43304 L 9.32498 6.63014 L 14.5198 13.9027 L 15.5676 18.0936 C 15.6841 18.5601 16.1027 18.8714 16.5626 18.8714 C 16.6451 18.8714 16.729 18.8648 16.8124 18.8364 C 17.3625 18.6988 17.6969 18.1415 17.5594 17.5914 L 16.4644 13.2114 C 16.4294 13.0867 16.3789 12.9686 16.3037 12.8639 L 10.8287 5.199 C 10.7198 5.04621 10.5707 4.92609 10.3981 4.85187 L 4.77501 2.44211 L 8.89863 2.44211 C 9.20289 2.44211 9.49223 2.30681 9.68729 2.07245 L 14.9959 -4.29806 L 25.7048 -8.58156 C 26.2309 -8.7921 26.4871 -9.38969 26.2765 -9.91604 Z M 3.32851 6.55639 C 3.33511 6.56299 3.34831 6.57949 3.35491 6.59533 C 3.44038 6.71413 3.52189 6.83623 3.6001 6.9615 L -3.31728 6.9615 C -3.2394 6.83643 -3.15723 6.71433 -3.07209 6.59533 C -3.06549 6.58873 -3.05229 6.57223 -3.04569 6.55639 C -2.22788 5.4365 -1.08892 4.63183 0.141308 4.63183 C 1.37151 4.63183 2.51044 5.43634 3.32825 6.55639 Z M -4.30682 10.1751 C -4.30682 9.7961 -4.25897 9.40383 -4.16987 9.01166 L 4.45319 9.01166 C 4.54229 9.4036 4.59014 9.79583 4.59014 10.1751 C 4.59014 10.5284 4.5512 10.9222 4.47728 11.3385 L -4.19435 11.3385 C -4.26695 10.9222 -4.30655 10.5285 -4.30655 10.1751 Z M 1.30499 -0.774814 L 1.30499 2.50003 L 1.30499 2.50663 L 1.30499 2.71651 C 0.928325 2.62543 0.540278 2.57461 0.141572 2.57461 C -0.257068 2.57461 -0.645313 2.62543 -1.02187 2.71651 L -1.02187 2.50663 L -1.02187 2.50003 L -1.02187 -0.774814 C -1.02187 -1.4163 -0.499981 -1.93823 0.141572 -1.93823 C 0.783092 -1.93823 1.30499 -1.41623 1.30499 -0.774814 Z M 0.141572 17.9085 C -1.29768 17.9085 -2.79123 15.6796 -3.62943 13.3916 L 3.91268 13.3916 C 3.07435 15.6796 1.58077 17.9085 0.141572 17.9085 Z"],["d","M 21.8842 2.21077 L 18.0181 2.21077 L 13.0729 -0.756106 C 12.911 -0.853707 12.7271 -0.904573 12.5381 -0.904573 L 6.18206 -0.904573 C 6.26409 -1.2402 6.30742 -1.58751 6.30742 -1.94298 C 6.30742 -2.35345 6.24815 -2.75236 6.13972 -3.13557 L 10.6647 -4.04062 C 10.9348 -4.09355 11.1726 -4.25344 11.3252 -4.48199 L 15.2411 -10.3555 L 20.0108 -11.3098 C 20.2808 -11.3628 20.5186 -11.5227 20.6712 -11.7512 L 22.7482 -14.8665 C 23.067 -15.3442 22.9382 -15.9892 22.4605 -16.3069 C 21.9817 -16.6267 21.3378 -16.4959 21.0201 -16.0192 L 19.181 -13.2611 L 14.4113 -12.3067 C 14.1413 -12.2538 13.9035 -12.0939 13.7509 -11.8653 L 9.83492 -5.99184 L 5.07504 -5.03946 C 4.8146 -5.33056 4.51767 -5.59756 4.1913 -5.83727 C 6.07121 -6.88908 7.3457 -8.89921 7.3457 -11.2028 L 7.3457 -13.4521 C 7.3457 -13.6801 7.33217 -13.9049 7.30798 -14.1266 C 7.3256 -14.1905 7.33742 -14.257 7.34266 -14.3255 C 7.34788 -14.3889 7.864 -20.6352 11.4996 -20.6352 C 17.0843 -20.6352 17.7053 -29.5377 17.7282 -29.9168 C 17.7635 -30.489 17.3284 -30.9813 16.7572 -31.0175 C 16.1861 -31.057 15.6907 -30.6188 15.6554 -30.0456 C 15.6502 -29.9729 15.0967 -22.7121 11.4996 -22.7121 C 8.14265 -22.7121 6.5767 -19.8132 5.85813 -17.4544 C 5.37949 -18.0105 4.80424 -18.4808 4.15721 -18.8374 C 4.84539 -19.5678 5.26657 -20.5387 5.26462 -21.5875 C 5.28337 -21.8035 5.40896 -23.7278 4.30508 -24.9262 C 3.76306 -25.516 3.01841 -25.8275 2.15341 -25.8275 C 1.57915 -25.8275 1.11501 -25.3623 1.11501 -24.7892 C 1.11501 -24.216 1.57915 -23.7508 2.15341 -23.7508 C 2.51691 -23.7508 2.67681 -23.6282 2.77551 -23.5223 C 3.19194 -23.0727 3.21786 -22.0716 3.19194 -21.6739 C 3.19194 -20.5286 2.2605 -19.597 1.11501 -19.597 L -0.96193 -19.597 C -2.1073 -19.597 -3.03886 -20.5284 -3.043 -21.7601 C -3.07306 -22.135 -3.01185 -23.0986 -2.6245 -23.5203 C -2.52581 -23.6272 -2.3659 -23.7508 -2.00034 -23.7508 C -1.42607 -23.7508 -0.96193 -24.216 -0.96193 -24.7892 C -0.96193 -25.3623 -1.42607 -25.8275 -2.00034 -25.8275 C -2.86533 -25.8275 -3.60997 -25.516 -4.15199 -24.9262 C -5.25588 -23.7279 -5.13015 -21.8035 -5.11569 -21.6738 C -5.11569 -20.5799 -4.69026 -19.5842 -3.99683 -18.8416 C -4.6468 -18.4846 -5.22446 -18.0128 -5.70491 -17.4546 C -6.42352 -19.8137 -7.98933 -22.7127 -11.3464 -22.7127 C -14.9311 -22.7127 -15.4971 -29.9735 -15.5022 -30.0462 C -15.5386 -30.6193 -16.0442 -31.0587 -16.605 -31.0172 C -17.1761 -30.9808 -17.6102 -30.4887 -17.5749 -29.9164 C -17.552 -29.5374 -16.931 -20.6359 -11.3463 -20.6359 C -7.72626 -20.6359 -7.19456 -14.3876 -7.18935 -14.3253 C -7.18397 -14.257 -7.17219 -14.1909 -7.15466 -14.1274 C -7.17899 -13.9057 -7.19248 -13.6806 -7.19248 -13.4525 L -7.19248 -11.2032 C -7.19248 -8.8997 -5.91799 -6.88944 -4.03808 -5.83763 C -4.36448 -5.59792 -4.66142 -5.33105 -4.92182 -5.03983 L -9.68174 -5.99221 L -13.5977 -11.8657 C -13.7503 -12.0941 -13.9881 -12.254 -14.2581 -12.3071 L -19.0278 -13.2614 L -20.8669 -16.0196 C -21.1846 -16.4963 -21.8295 -16.6271 -22.3073 -16.3073 C -22.7849 -15.9895 -22.9138 -15.3447 -22.5949 -14.8669 L -20.518 -11.7516 C -20.3654 -11.5231 -20.1275 -11.3633 -19.8576 -11.3102 L -15.0879 -10.3559 L -11.172 -4.48236 C -11.0194 -4.25393 -10.7816 -4.09401 -10.5116 -4.04098 L -5.98653 -3.13594 C -6.09507 -2.75272 -6.1542 -2.35382 -6.1542 -1.94335 C -6.1542 -1.58776 -6.11087 -1.24057 -6.02887 -0.904939 L -12.3849 -0.904939 C -12.5739 -0.904939 -12.7576 -0.85407 -12.9197 -0.756472 L -17.8648 2.21041 L -21.7311 2.21041 C -22.3053 2.21041 -22.7695 2.67564 -22.7695 3.24881 C -22.7695 3.82199 -22.3053 4.28723 -21.7311 4.28723 L -17.5773 4.28723 C -17.3883 4.28723 -17.2045 4.23634 -17.0425 4.13876 L -12.0973 1.17188 L -5.11579 1.17188 C -5.04949 1.17188 -4.98475 1.16506 -4.92182 1.15314 C -4.41144 1.72375 -3.76306 2.20335 -3.01939 2.55979 C -3.67679 3.29481 -4.07738 4.26409 -4.07738 5.32574 L -4.07738 5.72187 L -13.8876 10.627 C -14.1752 10.7713 -14.3787 11.0381 -14.441 11.3529 L -17.495 26.6212 L -20.3882 29.5143 C -20.7943 29.9204 -20.7943 30.5767 -20.3882 30.9827 C -20.1857 31.1852 -19.9198 31.2869 -19.654 31.2869 C -19.3881 31.2869 -19.1223 31.1852 -18.9198 30.9827 L -15.8045 27.8673 C -15.6591 27.7219 -15.5614 27.5381 -15.5209 27.3366 L -12.5043 12.2584 L -4.07728 8.04487 L -4.07728 8.44097 C -4.07728 9.47136 -3.69953 10.4145 -3.07635 11.1411 C -6.09774 12.3855 -8.23116 15.3606 -8.23116 18.8254 L -8.23116 22.9792 C -8.23116 27.5598 -4.50417 31.2868 0.0764775 31.2868 C 4.65712 31.2868 8.38411 27.5598 8.38411 22.9792 L 8.38411 18.8254 C 8.38411 15.3604 6.25083 12.3854 3.2293 11.1411 C 3.85249 10.4145 4.23024 9.47136 4.23024 8.44097 L 4.23024 8.04487 L 12.6572 12.2584 L 15.6739 27.3366 C 15.7144 27.538 15.812 27.7219 15.9574 27.8673 L 19.0728 30.9827 C 19.2753 31.1852 19.5412 31.2869 19.807 31.2869 C 20.0728 31.2869 20.3386 31.1852 20.5411 30.9827 C 20.9471 30.5767 20.9471 29.9203 20.5411 29.5143 L 17.648 26.6212 L 14.5939 11.3529 C 14.5315 11.0381 14.328 10.7713 14.0404 10.627 L 4.23024 5.72187 L 4.23024 5.32574 C 4.23024 4.26409 3.82962 3.29481 3.17223 2.55979 C 3.91601 2.20335 4.56426 1.72388 5.07464 1.15314 C 5.13757 1.16506 5.20219 1.17188 5.26865 1.17188 L 12.2502 1.17188 L 17.1953 4.13876 C 17.3573 4.23634 17.5411 4.28723 17.7301 4.28723 L 21.8839 4.28723 C 22.4581 4.28723 22.9223 3.82199 22.9223 3.24881 C 22.9223 2.67564 22.4585 2.21077 21.8842 2.21077 Z M -1.04894 -7.13526 C -3.29089 -7.13526 -5.11556 -8.9598 -5.11556 -11.2028 L -5.11556 -13.4521 C -5.11556 -15.6952 -3.29101 -17.5197 -1.04894 -17.5197 L 1.20238 -17.5197 C 3.44434 -17.5197 5.26901 -15.6952 5.26901 -13.4521 L 5.26901 -11.2028 C 5.26901 -8.9598 3.44444 -7.13526 1.20238 -7.13526 Z M 6.30752 18.8259 L 6.30752 22.9796 C 6.30752 26.4159 3.51308 29.2103 0.0768428 29.2103 C -3.3594 29.2103 -6.15384 26.4159 -6.15384 22.9796 L -6.15384 18.8259 C -6.15384 15.3896 -3.3594 12.5952 0.0768428 12.5952 C 3.51308 12.5952 6.30752 15.3896 6.30752 18.8259 Z M 2.15366 5.3261 L 2.15366 6.39593 L 2.15366 6.39956 L 2.15366 8.44147 C 2.15366 9.58683 1.22222 10.5184 0.076721 10.5184 C -1.06878 10.5184 -2.00022 9.58696 -2.00022 8.44147 L -2.00022 6.39956 L -2.00022 6.39593 L -2.00022 5.3261 C -2.00022 4.18074 -1.06878 3.24918 0.076721 3.24918 C 1.22222 3.24918 2.15366 4.18074 2.15366 5.3261 Z M 0.0768428 1.17236 C -2.21403 1.17236 -4.07692 -0.225404 -4.07692 -1.94298 C -4.07692 -3.66056 -2.21391 -5.05834 0.0768428 -5.05834 C 2.36759 -5.05834 4.2306 -3.66056 4.2306 -1.94298 C 4.2306 -0.225404 2.36759 1.17236 0.0768428 1.17236 Z"]],template:function(n,i){1&n&&(I(),E(0,"g")(1,"g",0),V(2,"polygon",1)(3,"polygon",2)(4,"polygon",3),P(),V(5,"polygon",4),E(6,"g"),z(7,mmt,1,0,"path",5)(8,_mt,1,0,"path",6)(9,Cmt,1,0,"path",7)(10,vmt,1,0,"path",8)(11,ymt,1,0,"path",9),P()()),2&n&&(A("transform",i.layerTransform),m(2),v("ngClass",i.pieceClass),A("points",i.isoPointsLight),m(),v("ngClass",i.pieceClass),A("points",i.isoPointsDark),m(),A("points",i.isoPointsStroke),m(),v("ngClass",i.pieceClass),A("points",i.hexaPoints),m(),A("transform","translate("+i.hexaCenter.x+" "+i.hexaCenter.y+")"),m(),v("ngIf","QueenBee"===i.piece.kind),m(),v("ngIf","Beetle"===i.piece.kind),m(),v("ngIf","Grasshopper"===i.piece.kind),m(),v("ngIf","Spider"===i.piece.kind),m(),v("ngIf","SoldierAnt"===i.piece.kind))},dependencies:[zt,bt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}return r})();const Emt=["app-lodestone-lodestone",""];function Pmt(r,t){if(1&r&&(I(),V(0,"polygon",4)),2&r){const e=t.$implicit,n=p();Ug("id","lodestone_",n.lodestoneInfo.direction,"_",n.lodestoneInfo.orientation,"_",n.lodestoneInfo.owner.toString(),"_arrow_",e,""),v("ngClass",n.lodestoneInfo.movingClass),A("points","push"===n.lodestoneInfo.direction?n.TRIANGLE_OUT:n.TRIANGLE_IN)("transform",n.getArrowRotate(e))}}const Smt=()=>[0,1,2,3];let Omt=(()=>{class r extends vd{lodestoneInfo;PIECE_RADIUS;TRIANGLE_OUT;TRIANGLE_IN;constructor(){super(),this.PIECE_RADIUS=.5*(this.SPACE_SIZE-2*this.STROKE_WIDTH);const e=.8*this.PIECE_RADIUS,n=.3*this.PIECE_RADIUS,i=.2*this.PIECE_RADIUS;this.TRIANGLE_OUT=`${e},0 ${n},${i} ${n},-${i}`,this.TRIANGLE_IN=`${n},0 ${e},${n} ${e},-${n}`}getArrowRotate(e){let n=90*e;return"diagonal"===this.lodestoneInfo.orientation&&(n+=45),"rotate("+n+")"}static \u0275fac=function(n){return new(n||r)};static \u0275cmp=Ue({type:r,selectors:[["","app-lodestone-lodestone",""]],inputs:{lodestoneInfo:"lodestoneInfo"},features:[$e],attrs:Emt,decls:4,vars:10,consts:[[1,"lodestone_wrapper"],["cx","0","cy","0",1,"lodestone_main_circle","base","black-fill",3,"id","ngClass"],["cx","0","cy","0",1,"base","no-stroke",3,"ngClass"],["class","base no-stroke",3,"id","ngClass",4,"ngFor","ngForOf"],[1,"base","no-stroke",3,"id","ngClass"]],template:function(n,i){1&n&&(I(),E(0,"g",0),V(1,"circle",1)(2,"circle",2),z(3,Pmt,1,7,"polygon",3),P()),2&n&&(A("transform",i.getSVGTranslation(i.SPACE_SIZE/2,i.SPACE_SIZE/2)),m(),Ur("id","lodestone_",i.lodestoneInfo.direction,"_",i.lodestoneInfo.orientation,"_",i.lodestoneInfo.owner.toString(),""),v("ngClass",i.lodestoneInfo.selectedClass),A("r",i.PIECE_RADIUS),m(),v("ngClass",i.getPlayerClass(i.lodestoneInfo.owner)),A("r",i.PIECE_RADIUS/4),m(),v("ngForOf",fr(9,Smt)))},dependencies:[zt,Nt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}return r})();const Tmt=["app-martian-chess-queen",""];function wmt(r,t){if(1&r&&(I(),V(0,"polygon",4)),2&r){const e=p();v("id",e.mainShapeId)("ngClass",e.pieceClasses),A("points",e.MartianChessQueenComponent.HEPTAGON)}}function bmt(r,t){if(1&r&&(I(),V(0,"polygon",4)),2&r){const e=p();v("id",e.mainShapeId)("ngClass",e.pieceClasses),A("points",e.MartianChessQueenComponent.EIGHT_POINTED_STAR)}}function Amt(r,t){if(1&r&&(I(),V(0,"circle",5)),2&r){const e=p();v("id",e.mainShapeId)("ngClass",e.pieceClasses),A("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",.5*e.MartianChessComponent.SPACE_SIZE-e.MartianChessComponent.STROKE_WIDTH)}}function Nmt(r,t){if(1&r&&(jt(0),I(),V(1,"circle",6)(2,"circle",6)(3,"circle",6),Zt()),2&r){const e=p();m(),A("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",e.MartianChessComponent.getRadius(3)),m(),A("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",e.MartianChessComponent.getRadius(2)),m(),A("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",e.MartianChessComponent.getRadius(1))}}function Imt(r,t){if(1&r&&(I(),E(0,"g"),V(1,"circle",7)(2,"circle",7)(3,"circle",7),P()),2&r){const e=p();m(),A("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.45*e.MartianChessComponent.SPACE_SIZE)("r",.2/3*e.MartianChessComponent.SPACE_SIZE),m(),A("cx",.45*e.MartianChessComponent.SPACE_SIZE)("cy",.55*e.MartianChessComponent.SPACE_SIZE)("r",.2/3*e.MartianChessComponent.SPACE_SIZE),m(),A("cx",.55*e.MartianChessComponent.SPACE_SIZE)("cy",.55*e.MartianChessComponent.SPACE_SIZE)("r",.2/3*e.MartianChessComponent.SPACE_SIZE)}}function kmt(r,t){if(1&r&&(I(),E(0,"g",8),V(1,"circle",9)(2,"circle",9)(3,"circle",9),P()),2&r){const e=p();v("ngClass",e.pieceClasses),m(),A("cx",.5*e.MartianChessComponent.SPACE_SIZE-3*e.horizontalDotsRadius)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",1.5*e.horizontalDotsRadius),m(),A("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",1.5*e.horizontalDotsRadius),m(),A("cx",.5*e.MartianChessComponent.SPACE_SIZE+3*e.horizontalDotsRadius)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",1.5*e.horizontalDotsRadius)}}class Yd{mainShapeId;pieceClasses;style;static HEPTAGON=yo.getRegularPolygon(7);static EIGHT_POINTED_STAR=yo.getNPointedStar(8,0);MartianChessQueenComponent=Yd;MartianChessComponent=yo;horizontalDotsRadius=yo.SPACE_SIZE/15;static \u0275fac=function(e){return new(e||Yd)};static \u0275cmp=Ue({type:Yd,selectors:[["","app-martian-chess-queen",""]],inputs:{mainShapeId:"mainShapeId",pieceClasses:"pieceClasses",style:"style"},attrs:Tmt,decls:6,vars:6,consts:[["class","base","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["class","base",3,"id","ngClass",4,"ngIf"],[4,"ngIf"],[3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[1,"base",3,"id","ngClass"],[1,"base","no-fill","mid-stroke"],[1,"base","mid-stroke"],[3,"ngClass"],[1,"base-no-stroke"]],template:function(e,n){1&e&&z(0,wmt,1,3,"polygon",0)(1,bmt,1,3,"polygon",0)(2,Amt,1,5,"circle",1)(3,Nmt,4,9,"ng-container",2)(4,Imt,4,9,"g",2)(5,kmt,4,10,"g",3),2&e&&(v("ngIf","Polygon"===n.style.shape),m(),v("ngIf","Star"===n.style.shape),m(),v("ngIf","Circle"===n.style.shape),m(),v("ngIf","Concentric Circles"===n.style.points),m(),v("ngIf","Dots"===n.style.points),m(),v("ngIf","Horizontal Points"===n.style.points))},dependencies:[zt,bt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}const Rmt=["app-martian-chess-drone",""];function xmt(r,t){if(1&r&&(I(),V(0,"polygon",4)),2&r){const e=p();v("id",e.mainShapeId)("ngClass",e.pieceClasses),A("points",e.MartianChessDroneComponent.PENTAGON)}}function Lmt(r,t){if(1&r&&(I(),V(0,"polygon",4)),2&r){const e=p();v("id",e.mainShapeId)("ngClass",e.pieceClasses),A("points",e.MartianChessDroneComponent.FOUR_POINTED_STAR_VERTICAL)}}function zmt(r,t){if(1&r&&(I(),V(0,"circle",5)),2&r){const e=p();v("id",e.mainShapeId)("ngClass",e.pieceClasses),A("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",.5*e.MartianChessComponent.SPACE_SIZE-e.MartianChessComponent.STROKE_WIDTH)}}function Dmt(r,t){if(1&r&&(jt(0),I(),V(1,"circle",6)(2,"circle",6),Zt()),2&r){const e=p();m(),A("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",e.MartianChessComponent.getRadius(2)),m(),A("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",e.MartianChessComponent.getRadius(1))}}function Vmt(r,t){if(1&r&&(I(),E(0,"g",7),V(1,"circle",8)(2,"circle",8),P()),2&r){const e=p();v("ngClass",e.pieceClasses),m(),A("cx",.4*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",.2/3*e.MartianChessComponent.SPACE_SIZE),m(),A("cx",.6*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",.2/3*e.MartianChessComponent.SPACE_SIZE)}}function Hmt(r,t){if(1&r&&(I(),E(0,"g",7),V(1,"circle",9)(2,"circle",9),P()),2&r){const e=p();v("ngClass",e.pieceClasses),m(),A("cx",.5*e.MartianChessComponent.SPACE_SIZE-2*e.horizontalDotsRadius)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",1.5*e.horizontalDotsRadius),m(),A("cx",.5*e.MartianChessComponent.SPACE_SIZE+2*e.horizontalDotsRadius)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",1.5*e.horizontalDotsRadius)}}class Kd{mainShapeId;pieceClasses;style;MartianChessComponent=yo;MartianChessDroneComponent=Kd;static FOUR_POINTED_STAR_VERTICAL=yo.getNPointedStar(4,0);static PENTAGON=yo.getRegularPolygon(5);horizontalDotsRadius=yo.SPACE_SIZE/15;static \u0275fac=function(e){return new(e||Kd)};static \u0275cmp=Ue({type:Kd,selectors:[["","app-martian-chess-drone",""]],inputs:{mainShapeId:"mainShapeId",pieceClasses:"pieceClasses",style:"style"},attrs:Rmt,decls:6,vars:6,consts:[["class","base","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["class","base",3,"id","ngClass",4,"ngIf"],[4,"ngIf"],[3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[1,"base",3,"id","ngClass"],[1,"base","no-fill","mid-stroke"],[3,"ngClass"],[1,"base","mid-stroke"],[1,"base-no-stroke"]],template:function(e,n){1&e&&z(0,xmt,1,3,"polygon",0)(1,Lmt,1,3,"polygon",0)(2,zmt,1,5,"circle",1)(3,Dmt,3,6,"ng-container",2)(4,Vmt,3,7,"g",3)(5,Hmt,3,7,"g",3),2&e&&(v("ngIf","Polygon"===n.style.shape),m(),v("ngIf","Star"===n.style.shape),m(),v("ngIf","Circle"===n.style.shape),m(),v("ngIf","Concentric Circles"===n.style.points),m(),v("ngIf","Dots"===n.style.points),m(),v("ngIf","Horizontal Points"===n.style.points))},dependencies:[zt,bt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}const Fmt=["app-martian-chess-pawn",""];function Umt(r,t){if(1&r&&(I(),V(0,"polygon",5)),2&r){const e=p();v("id",e.mainShapeId)("ngClass",e.pieceClasses),A("points",e.MartianChessPawnComponent.TRIANGLE)}}function Gmt(r,t){if(1&r&&(I(),V(0,"polygon",5)),2&r){const e=p();v("id",e.mainShapeId)("ngClass",e.pieceClasses),A("points",e.MartianChessPawnComponent.FOUR_POINTED_STAR_DIAGONAL)}}function Bmt(r,t){if(1&r&&(I(),V(0,"circle",6)),2&r){const e=p();v("id",e.mainShapeId)("ngClass",e.pieceClasses),A("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",.5*e.MartianChessComponent.SPACE_SIZE-e.MartianChessComponent.STROKE_WIDTH)}}function $mt(r,t){if(1&r&&(I(),V(0,"circle",7)),2&r){const e=p();A("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE+e.getConcreteTriangleYOffset())("r",e.MartianChessComponent.getRadius(1))}}function Wmt(r,t){if(1&r&&(I(),V(0,"circle",8)),2&r){const e=p();A("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",.2/3*e.MartianChessComponent.SPACE_SIZE)}}function qmt(r,t){if(1&r&&(I(),E(0,"g",9),V(1,"circle",10),P()),2&r){const e=p();v("ngClass",e.pieceClasses),m(),A("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",1.5*e.horizontalDotsRadius)}}class g4{mainShapeId;pieceClasses;style;static FOUR_POINTED_STAR_DIAGONAL=yo.getNPointedStar(4,45);static TRIANGLE_Y_OFFSET=g4.yOffsetForVerticalCentering();static TRIANGLE=g4.getTriangle();MartianChessComponent=yo;MartianChessPawnComponent=g4;horizontalDotsRadius=yo.SPACE_SIZE/15;static getTriangle(){return yo.getRegularPolygon(3,g4.TRIANGLE_Y_OFFSET)}static yOffsetForVerticalCentering(){const e=yo.getRegularPolygonCoords(3).map(c=>c.y);return(e.reduce((c,l)=>Math.min(c,l))+(100-e.reduce((c,l)=>Math.max(c,l))))/4}getConcreteTriangleYOffset(){return"Polygon"===this.style.shape?g4.TRIANGLE_Y_OFFSET:0}static \u0275fac=function(e){return new(e||g4)};static \u0275cmp=Ue({type:g4,selectors:[["","app-martian-chess-pawn",""]],inputs:{mainShapeId:"mainShapeId",pieceClasses:"pieceClasses",style:"style"},attrs:Fmt,decls:6,vars:6,consts:[["class","base","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["class","base",3,"id","ngClass",4,"ngIf"],["class","base no-fill mid-stroke",4,"ngIf"],["class","base mid-stroke",4,"ngIf"],[3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[1,"base",3,"id","ngClass"],[1,"base","no-fill","mid-stroke"],[1,"base","mid-stroke"],[3,"ngClass"],[1,"base-no-stroke"]],template:function(e,n){1&e&&z(0,Umt,1,3,"polygon",0)(1,Gmt,1,3,"polygon",0)(2,Bmt,1,5,"circle",1)(3,$mt,1,3,"circle",2)(4,Wmt,1,3,"circle",3)(5,qmt,2,4,"g",4),2&e&&(v("ngIf","Polygon"===n.style.shape),m(),v("ngIf","Star"===n.style.shape),m(),v("ngIf","Circle"===n.style.shape),m(),v("ngIf","Concentric Circles"===n.style.points),m(),v("ngIf","Dots"===n.style.points),m(),v("ngIf","Horizontal Points"===n.style.points))},dependencies:[zt,bt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}const jmt=["app-siam-orientation-arrow",""];function Zmt(r,t){if(1&r){const e=he();I(),E(0,"use",2),q("click",function(){const o=te(e).$implicit;return ne(p().selectMove(o))}),P()}if(2&r){const e=t.$implicit,n=p();Tn("id","orientation_",e.landingOrientation,""),v("ngClass",n.getCurrentPlayerClass()),A("transform",n.getOrientationTransform(e.landingOrientation))}}let Ymt=(()=>{class r extends vd{orientations;currentPlayer;config;moveEmitter=new i1;getCurrentPlayerClass(){return this.getPlayerClass(this.currentPlayer)}getOrientationTransform(e){const n=this.config,i=Math.min(n.width,n.height)/5,s=this.SPACE_SIZE/40*i,a=.5*s;let c=new _(n.width/2,n.height/2);c=c.getNext(me.LEFT,a),c=c.getNext(me.UP,a),c=c.getNext(e,s-i),c=c.scale(this.SPACE_SIZE,this.SPACE_SIZE);const l=90*(e.toInt()-2);return[`translate(${c.x}, ${c.y})`,`scale(${s})`,`rotate(${l} ${this.SPACE_SIZE/2} ${this.SPACE_SIZE/2})`].join(" ")}selectMove(e){this.moveEmitter.emit(e)}static \u0275fac=(()=>{let e;return function(i){return(e||(e=z1(r)))(i||r)}})();static \u0275cmp=Ue({type:r,selectors:[["","app-siam-orientation-arrow",""]],inputs:{orientations:"orientations",currentPlayer:"currentPlayer",config:"config"},outputs:{moveEmitter:"moveEmitter"},features:[$e],attrs:jmt,decls:3,vars:1,consts:[["id","arrow","points","30 10, 30 50, 10 50, 50 90, 90 50, 70 50, 70 10"],["class","base mid-stroke semi-transparent",0,"xlink","href","#arrow",3,"id","ngClass","click",4,"ngFor","ngForOf"],[0,"xlink","href","#arrow",1,"base","mid-stroke","semi-transparent",3,"id","ngClass","click"]],template:function(n,i){1&n&&(I(),E(0,"defs"),V(1,"polygon",0),P(),z(2,Zmt,1,3,"use",1)),2&n&&(m(2),v("ngForOf",i.orientations))},dependencies:[zt,Nt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}return r})();const Kmt=["mgp-trexo-half-piece",""];function Xmt(r,t){if(1&r&&(I(),V(0,"text",8)),2&r){const e=p();Ur("id","height_",e.coord.x,"_",e.coord.y,"_",e.coord.z,""),v("innerHTML",e.coord.z,o7)}}function Qmt(r,t){if(1&r&&(I(),V(0,"polyline",9)),2&r){const e=p();v("ngClass",e.pieceClasses),A("points",e.getUpperHorizontalLine())}}function Jmt(r,t){if(1&r&&(I(),E(0,"g"),V(1,"polyline",10)(2,"polyline",11),P()),2&r){const e=p();m(),v("ngClass",e.pieceClasses),A("points",e.getMiddleHorizontalLine()),m(),v("ngClass",e.pieceClasses),A("points",e.getLowerHorizontalLine())}}function e_t(r,t){if(1&r&&(I(),V(0,"polyline",12)),2&r){const e=p();v("ngClass",e.pieceClasses),A("points",e.getLeftDiagonalLine())}}function t_t(r,t){if(1&r&&(I(),E(0,"g"),V(1,"polyline",13)(2,"polyline",14),P()),2&r){const e=p();m(),v("ngClass",e.pieceClasses),A("points",e.getMiddleDiagonalLine()),m(),v("ngClass",e.pieceClasses),A("points",e.getRighterDiagonalLine())}}function n_t(r,t){if(1&r&&(I(),V(0,"polyline",15)),2&r){const e=p();v("ngClass",e.pieceClasses),A("points",e.getLeftVerticalLine())}}function r_t(r,t){if(1&r&&(I(),V(0,"polyline",16)),2&r){const e=p();v("ngClass",e.pieceClasses),A("points",e.getMiddleVerticalLine())}}function i_t(r,t){if(1&r&&(I(),V(0,"polyline",17)),2&r){const e=p();v("ngClass",e.pieceClasses),A("points",e.getRighterVerticalLine())}}class Nv{coord;move;pieceClasses;mode;mustDisplayHeight;static STROKE_OFFSET=l1.STROKE_WIDTH/2;mustForceStrokeDisplay(){return void 0===this.move||this.pieceClasses.some(t=>"victory-stroke"===t)||this.pieceClasses.some(t=>"last-move-stroke"===t)}get3DIsoSquarePoints(){const t=this.getParallelogramPoints();return this.mapCoordToPoints([t[0],t[1],t[4],t[6],t[5],t[2],t[0]])}getParallelogramPoints(){const t=this.mode.parallelogramHeight*this.mode.horizontalWidthRatio,e=this.mode.parallelogramHeight,n=this.mode.offsetRatio*this.mode.parallelogramHeight,i=this.mode.parallelogramHeight*this.mode.pieceHeightRatio,o=t,a=t-n,c=e,l=-n,u=e;return[new _(0,0),new _(o,0),new _(l,u),new _(a,c),new _(o,0+i),new _(l,u+i),new _(a,c+i)]}mapCoordToPoints(t){return t.map(e=>e.x+" "+e.y).join(" ")}getUpperHorizontalLineCoords(){const t=this.getParallelogramPoints(),e=t[0],n=t[1],o=new Gt(-1*this.mode.offsetRatio*l1.STROKE_WIDTH,l1.STROKE_WIDTH),s=e.getNext(o),a=n.getNext(o);return[e,n,a,s]}getUpperHorizontalLine(){const t=this.getUpperHorizontalLineCoords();return this.mapCoordToPoints(t)}getMiddleHorizontalCoords(){const t=this.getParallelogramPoints(),e=t[2],n=t[3],o=new Gt(-1*this.mode.offsetRatio*l1.STROKE_WIDTH,l1.STROKE_WIDTH);return[e.getNext(o,-1),n.getNext(o,-1),n,e]}getMiddleHorizontalLine(){const t=this.getMiddleHorizontalCoords();return this.mapCoordToPoints(t)}getLowerHorizontalLine(){const t=this.getParallelogramPoints(),e=t[5],n=t[6],i=new Gt(0,l1.STROKE_WIDTH),o=e.getNext(i,-1),s=n.getNext(i,-1);return this.mapCoordToPoints([o,s,n,e])}getLeftDiagonalLine(){const t=this.getParallelogramPoints(),e=t[0],n=t[2],o=new Gt(l1.STROKE_WIDTH,0),s=e.getNext(o,1),a=n.getNext(o,1);return this.mapCoordToPoints([e,s,a,n])}getMiddleDiagonalLine(){const t=this.getParallelogramPoints(),e=t[1],n=t[3],o=new Gt(l1.STROKE_WIDTH,0),s=e.getNext(o,-1),a=n.getNext(o,-1);return this.mapCoordToPoints([s,e,n,a])}getRighterDiagonalLine(){const t=this.getParallelogramPoints(),e=t[4],n=t[6],o=new Gt(0,l1.STROKE_WIDTH),s=e.getNext(o,-1),a=n.getNext(o,-1);return this.mapCoordToPoints([s,e,n,a])}getLeftVerticalLine(){const t=this.getParallelogramPoints(),e=t[2],n=t[5],o=new Gt(l1.STROKE_WIDTH,0),s=e.getNext(o,1),a=n.getNext(o,1);return this.mapCoordToPoints([e,s,a,n])}getMiddleVerticalLine(){const t=this.getParallelogramPoints(),e=t[3],n=t[6],o=new Gt(l1.STROKE_WIDTH,0),s=e.getNext(o,-1),a=n.getNext(o,-1);return this.mapCoordToPoints([s,e,n,a])}getRighterVerticalLine(){const t=this.getParallelogramPoints(),e=t[1],n=t[4],s=new Gt(l1.STROKE_WIDTH,-l1.STROKE_WIDTH/this.mode.offsetRatio),a=e.getNext(s,-1),c=n.getNext(s,-1);return this.mapCoordToPoints([a,e,n,c])}getOtherCoord(){pn(null!=this.move,"Move should be set before calling getOtherCoord");const t=this.move;return t.getZero().equals(this.coord)?t.getOne():t.getZero()}isLeftHalf(){if(null==this.move)return!1;{const t=this.getOtherCoord();return this.coord.x===t.x-1}}isRightHalf(){if(null==this.move)return!1;{const t=this.getOtherCoord();return this.coord.x===t.x+1}}isTopHalf(){if(null==this.move)return!1;{const t=this.getOtherCoord();return this.coord.y===t.y-1}}isBottomHalf(){if(null==this.move)return!1;{const t=this.getOtherCoord();return this.coord.y===t.y+1}}static \u0275fac=function(e){return new(e||Nv)};static \u0275cmp=Ue({type:Nv,selectors:[["","mgp-trexo-half-piece",""]],inputs:{coord:"coord",move:"move",pieceClasses:"pieceClasses",mode:"mode",mustDisplayHeight:"mustDisplayHeight"},attrs:Kmt,decls:9,vars:13,consts:[[3,"id","ngClass"],["x","50","y","66","class","text-big text-center",3,"id","innerHTML",4,"ngIf"],["id","line_0_to_1","class","base manual-stroke",3,"ngClass",4,"ngIf"],[4,"ngIf"],["id","line_0_to_2","class","base manual-stroke",3,"ngClass",4,"ngIf"],["id","line_2_to_5","class","base manual-stroke",3,"ngClass",4,"ngIf"],["id","line_3_to_6","class","base manual-stroke",3,"ngClass",4,"ngIf"],["id","line_1_to_4","class","base manual-stroke",3,"ngClass",4,"ngIf"],["x","50","y","66",1,"text-big","text-center",3,"id","innerHTML"],["id","line_0_to_1",1,"base","manual-stroke",3,"ngClass"],["id","line_2_to_3",1,"base","manual-stroke",3,"ngClass"],["id","line_5_to_6",1,"base","manual-stroke",3,"ngClass"],["id","line_0_to_2",1,"base","manual-stroke",3,"ngClass"],["id","line_1_to_3",1,"base","manual-stroke",3,"ngClass"],["id","line_4_to_6",1,"base","manual-stroke",3,"ngClass"],["id","line_2_to_5",1,"base","manual-stroke",3,"ngClass"],["id","line_3_to_6",1,"base","manual-stroke",3,"ngClass"],["id","line_1_to_4",1,"base","manual-stroke",3,"ngClass"]],template:function(e,n){1&e&&(I(),V(0,"polyline",0),z(1,Xmt,1,4,"text",1)(2,Qmt,1,2,"polyline",2)(3,Jmt,3,4,"g",3)(4,e_t,1,2,"polyline",4)(5,t_t,3,4,"g",3)(6,n_t,1,2,"polyline",5)(7,r_t,1,2,"polyline",6)(8,i_t,1,2,"polyline",7)),2&e&&(Ur("id","tile_",n.coord.x,"_",n.coord.y,"_",n.coord.z,""),v("ngClass",n.pieceClasses),A("points",n.get3DIsoSquarePoints()),m(),v("ngIf",n.mustDisplayHeight),m(),v("ngIf",!1===n.isBottomHalf()||n.mustForceStrokeDisplay()),m(),v("ngIf",!1===n.isTopHalf()||n.mustForceStrokeDisplay()),m(),v("ngIf",!1===n.isRightHalf()||n.mustForceStrokeDisplay()),m(),v("ngIf",!1===n.isLeftHalf()||n.mustForceStrokeDisplay()),m(),v("ngIf",n.isBottomHalf()||n.isLeftHalf()||n.mustForceStrokeDisplay()),m(),v("ngIf",n.isBottomHalf()||n.isRightHalf()||n.mustForceStrokeDisplay()),m(),v("ngIf",n.isTopHalf()||n.isRightHalf()||n.mustForceStrokeDisplay()))},dependencies:[zt,bt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}const Xd_firebaseConfig={apiKey:"AIzaSyCgOzdBWz58aFnjCFGzH_KiLMtA8PXaQhc",authDomain:"everyboard-dev.firebaseapp.com",projectId:"everyboard-dev",storageBucket:"everyboard-dev.appspot.com",messagingSenderId:"579824736515"};let hR=(()=>{class r{connectedUserService;userSubscription;constructor(e){this.connectedUserService=e}canActivate(){var e=this;return M(function*(){const n=yield new Promise(i=>{e.userSubscription=e.connectedUserService.subscribeToUser(function(){var o=M(function*(s){return i(yield e.evaluateUserPermission(s))});return function(s){return o.apply(this,arguments)}}())});return e.userSubscription.unsubscribe(),n})()}static \u0275fac=function(n){return new(n||r)(ze(gr))};static \u0275prov=xe({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})(),Au=(()=>{class r extends hR{router;static evaluateUserPermission(e,n){return M(function*(){return!1===n.isConnected()?e.parseUrl("/login"):!1!==n.verified||e.parseUrl("/verify-account")})()}constructor(e,n){super(e),this.router=n}evaluateUserPermission(e){var n=this;return M(function*(){return r.evaluateUserPermission(n.router,e)})()}static \u0275fac=function(n){return new(n||r)(ze(gr),ze(Qn))};static \u0275prov=xe({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})(),gR=(()=>{class r{currentGameService;router;currentGameSubscription=h.empty();constructor(e,n){this.currentGameService=e,this.router=n}canActivate(e){var n=this;return M(function*(){const i=yield n.currentGameService.getCurrentGame();if(i.isAbsent())return!0;const o=i.get();return e.params.id===o.id||n.router.parseUrl("/play/"+o.typeGame+"/"+o.id)})()}static \u0275fac=function(n){return new(n||r)(ze(qo),ze(Qn))};static \u0275prov=xe({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})(),o_t=(()=>{class r extends hR{router;constructor(e,n){super(e),this.router=n}evaluateUserPermission(e){var n=this;return M(function*(){return!1===e.isConnected()?n.router.parseUrl("/login"):!e.verified||n.router.parseUrl("/")})()}static \u0275fac=function(n){return new(n||r)(ze(gr),ze(Qn))};static \u0275prov=xe({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})(),s_t=(()=>{class r extends hR{router;constructor(e,n){super(e),this.router=n}evaluateUserPermission(e){var n=this;return M(function*(){return!1===e.isConnected()||n.router.parseUrl("/")})()}static \u0275fac=function(n){return new(n||r)(ze(gr),ze(Qn))};static \u0275prov=xe({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();const a_t=["app-blank-goban",""];function c_t(r,t){if(1&r&&(I(),V(0,"circle",8)),2&r){const e=t.$implicit,n=p(3);ve("id","hoshi_",e.x,"_",e.y,""),A("cx",.5*n.SPACE_SIZE+n.SPACE_SIZE*e.x)("cy",.5*n.SPACE_SIZE+n.SPACE_SIZE*e.y)("r",.2*n.SPACE_SIZE)}}function l_t(r,t){if(1&r){const e=he();I(),E(0,"g",4),q("click",function(){const o=te(e).index,s=p().index;return ne(p().onClick(o,s))}),V(1,"rect",5)(2,"line",6)(3,"line",6)(4,"g")(5,"g"),z(6,c_t,1,5,"circle",7),V(7,"g"),P()}if(2&r){const e=t.index,n=p().index,i=p();ve("id","click_",e,"_",n,""),m(),A("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)("x",i.SPACE_SIZE*e)("y",i.SPACE_SIZE*n),m(),A("x1",i.SPACE_SIZE*e)("y1",.5*i.SPACE_SIZE+i.SPACE_SIZE*n)("x2",i.SPACE_SIZE+i.SPACE_SIZE*e)("y2",.5*i.SPACE_SIZE+i.SPACE_SIZE*n),m(),A("x1",.5*i.SPACE_SIZE+i.SPACE_SIZE*e)("y1",i.SPACE_SIZE*n)("x2",.5*i.SPACE_SIZE+i.SPACE_SIZE*e)("y2",i.SPACE_SIZE+i.SPACE_SIZE*n),m(3),v("ngForOf",i.hoshis)}}function u_t(r,t){if(1&r&&(I(),E(0,"g"),z(1,l_t,8,15,"g",3),P()),2&r){const e=p();m(),v("ngForOf",e.ArrayUtils.range(e.width))}}let pR=(()=>{class r extends vd{width;height;clickCallBack=new i1;hoshis=[];ngOnChanges(){return this.createHoshis()}onClick(e,n){return this.clickCallBack.emit(new _(e,n))}createHoshis(){this.hoshis=_2.getHoshis(this.width,this.height)}static \u0275fac=(()=>{let e;return function(i){return(e||(e=z1(r)))(i||r)}})();static \u0275cmp=Ue({type:r,selectors:[["","app-blank-goban",""]],inputs:{width:"width",height:"height"},outputs:{clickCallBack:"clickCallBack"},features:[$e,n2],attrs:a_t,decls:3,vars:3,consts:[["id","blank_board"],["x","0","y","0",1,"base","mid-small-stroke"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["fill-opacity","0",1,"base","no-stroke"],[1,"base"],["class","base-no-stroke click-delegator",3,"id",4,"ngFor","ngForOf"],[1,"base-no-stroke","click-delegator",3,"id"]],template:function(n,i){1&n&&(I(),E(0,"g",0),V(1,"rect",1),z(2,u_t,2,1,"g",2),P()),2&n&&(m(),A("width",i.width*i.SPACE_SIZE)("height",i.height*i.SPACE_SIZE),m(),v("ngForOf",i.ArrayUtils.range(i.height)))},dependencies:[Nt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}return r})();!function Yfe(r,t,e){(function M8e(r,t,e){"string"!=typeof t&&(e=t,t=r[D1.LocaleId]),t=t.toLowerCase().replace(/_/g,"-"),E8[t]=r,e&&(E8[t][D1.ExtraData]=e)})(r,t,e)}(Wbe);const f_t=[{path:"login",component:zht},{path:"lobby",component:sR,canActivate:[Au]},{path:"account",component:tgt,canActivate:[Au]},{path:"settings",component:hmt},{path:"register",component:Ypt,canActivate:[s_t]},{path:"reset-password",component:umt},{path:"notFound/:message",component:Lse},{path:"nextGameLoading",component:Qpt,canActivate:[Au]},{path:"verify-account",component:smt,canActivate:[o_t]},{path:"play",component:xse,canActivate:[Au,gR]},{path:"play/:compo",component:gmt,canActivate:[Au,gR]},{path:"play/:compo/:id",component:uR,canActivate:[Au,gR]},{path:"local",component:Kpt},{path:"local/:compo",component:dR},{path:"tutorial",component:Xpt},{path:"tutorial/:compo",component:iR},{path:"",component:cht},{path:"demo",component:kht},{path:"**",component:Lse}];let d_t=(()=>{class r{constructor(){LW(Xd_firebaseConfig);const e=rK();e.toJSON(),LX()}static \u0275fac=function(n){return new(n||r)};static \u0275mod=Ls({type:r,bootstrap:[iht]});static \u0275inj=ns({providers:[gr,bu,_I,Fd,eu,J5,fv,{provide:mc,useValue:Ud.getLocale()}],imports:[WU,Gge,C_e.forRoot(f_t,{useHash:!1}),dge,fge,Cve,DNe]})}return r})();S3(nJ,function(){return[zt,Nt,bt,pR]},[]),S3(xC,function(){return[zt,Nt,bt,pR]},[]),S3(NJ,function(){return[zt,Nt,bt,Mmt]},[]),S3(aa,function(){return[zt,Nt,bt,Omt]},[]),S3(yo,function(){return[zt,Nt,bt,Yd,Kd,g4]},[]),S3($J,function(){return[zt,Nt,bt,pR]},[]),S3(av,function(){return[zt,Nt,bt,Ymt]},[]),S3(l1,function(){return[zt,Nt,bt,Nv]},[]);var h_t=Is(5780);function Hse(){Ode().bootstrapModule(d_t).catch(r=>console.error(r))}const Fse=Ud.getLocale();"en"!==Fse?fetch("/assets/"+Fse+".json").then(r=>r.ok?r.json():{locale:"en",translations:{}}).then(r=>{(0,h_t.AB)(r.translations),$localize.locale=r.locale,Hse()}).catch(function(r){console.log(r)}):Hse()},1960:function(Iu,E0){!function(Is){"use strict";function jo(St,ct){var Bt=Object.keys(St);if(Object.getOwnPropertySymbols){var Pn=Object.getOwnPropertySymbols(St);ct&&(Pn=Pn.filter(function(cr){return Object.getOwnPropertyDescriptor(St,cr).enumerable})),Bt.push.apply(Bt,Pn)}return Bt}function M(St){for(var ct,Bt=1;Bt<arguments.length;Bt++)ct=null==arguments[Bt]?{}:arguments[Bt],Bt%2?jo(Object(ct),!0).forEach(function(Pn){Vl(St,Pn,ct[Pn])}):Object.getOwnPropertyDescriptors?Object.defineProperties(St,Object.getOwnPropertyDescriptors(ct)):jo(Object(ct)).forEach(function(Pn){Object.defineProperty(St,Pn,Object.getOwnPropertyDescriptor(ct,Pn))});return St}function P0(St,ct){if(!(St instanceof ct))throw new TypeError("Cannot call a class as a function")}function ar(St,ct){for(var Bt,Pn=0;Pn<ct.length;Pn++)(Bt=ct[Pn]).enumerable=Bt.enumerable||!1,Bt.configurable=!0,"value"in Bt&&(Bt.writable=!0),Object.defineProperty(St,Bt.key,Bt)}function Zo(St,ct,Bt){return ct&&ar(St.prototype,ct),Bt&&ar(St,Bt),St}function Vl(St,ct,Bt){return ct in St?Object.defineProperty(St,ct,{value:Bt,enumerable:!0,configurable:!0,writable:!0}):St[ct]=Bt,St}function Eo(){var St;return null!==(St=O0)&&void 0!==St?St:document}var S0={duration:2e3,position:"top-right",closeOnClick:!0,opacity:1,single:!1,offsetTop:0,offsetBottom:0,offsetLeft:0,offsetRight:0,extraClasses:""},ks=M({},S0),Yo={},O0=null,Ja=function(St,ct,Bt,Pn,cr){return"top-left"===St?"left:".concat(Pn,";top:").concat(ct,";text-align:left;align-items:flex-start;"):"top-right"===St?"right:".concat(cr,";top:").concat(ct,";text-align:right;align-items:flex-end;"):"top-center"===St?"top:".concat(ct,";left:0;right:0;text-align:center;align-items:center;"):"bottom-left"===St?"left:".concat(Pn,";bottom:").concat(Bt,";text-align:left;align-items:flex-start;"):"bottom-right"===St?"right:".concat(cr,";bottom:").concat(Bt,";text-align:right;align-items:flex-end;"):"bottom-center"===St?"bottom:".concat(Bt,";left:0;right:0;text-align:center;align-items:center;"):"center"===St?"top:0;left:0;right:0;bottom:0;flex-flow:column;justify-content:center;align-items:center;":void 0},T0=function(){function St(ct){var Bt=this;P0(this,St),this.element=Eo().createElement("div"),this.opacity=ct.opacity,this.type=ct.type,this.animate=ct.animate,this.dismissible=ct.dismissible,this.closeOnClick=ct.closeOnClick,this.message=ct.message,this.duration=ct.duration,this.pauseOnHover=ct.pauseOnHover,this.offsetTop=ct.offsetTop,this.offsetBottom=ct.offsetBottom,this.offsetLeft=ct.offsetLeft,this.offsetRight=ct.offsetRight,this.extraClasses=ct.extraClasses;var Pn="width:auto;pointer-events:auto;display:inline-flex;white-space:pre-wrap;opacity:".concat(this.opacity,";"),cr=["notification",this.extraClasses];if(this.type&&cr.push(this.type),this.animate&&this.animate.in){var u3="animate__".concat(this.animate.in),J2=this.animate.speed?"animate__".concat(this.animate.speed):"animate__faster";cr.push("animate__animated ".concat(u3," ").concat(J2)),this.onAnimationEnd(function(){return Bt.element.classList.remove(u3)})}if(this.element.className=cr.join(" "),this.dismissible){var _a=Eo().createElement("button");_a.className="delete",_a.addEventListener("click",function(){Bt.destroy()}),this.element.insertAdjacentElement("afterbegin",_a)}else Pn+="padding: 1.25rem 1.5rem";this.closeOnClick&&this.element.addEventListener("click",function(){Bt.destroy()}),this.element.setAttribute("style",Pn),"string"==typeof this.message?this.element.insertAdjacentHTML("beforeend",this.message):this.element.appendChild(this.message);var Rs=new Hl(function(){Bt.destroy()},this.duration);this.pauseOnHover&&(this.element.addEventListener("mouseover",function(){Rs.pause()}),this.element.addEventListener("mouseout",function(){Rs.resume()}))}return Zo(St,[{key:"destroy",value:function(){var ct=this;this.animate&&this.animate.out?(this.element.classList.add("animate__".concat(this.animate.out)),this.onAnimationEnd(function(){ct.removeParent(ct.element.parentNode),ct.element.remove()})):(this.removeParent(this.element.parentNode),this.element.remove())}},{key:"removeParent",value:function(ct){ct&&1>=ct.children.length&&(ct.remove(),delete Yo.position)}},{key:"onAnimationEnd",value:function(){var ct=0<arguments.length&&void 0!==arguments[0]?arguments[0]:function(){},Bt={animation:"animationend",OAnimation:"oAnimationEnd",MozAnimation:"mozAnimationEnd",WebkitAnimation:"webkitAnimationEnd"};for(var Pn in Bt)if(void 0!==this.element.style[Pn]){this.element.addEventListener(Bt[Pn],function(){return ct()});break}}}]),St}(),Hl=function(){function St(ct,Bt){P0(this,St),this.remaining=Bt,this.callback=ct,this.resume()}return Zo(St,[{key:"pause",value:function(){typeof document>"u"||(window.clearTimeout(this.timer),this.remaining-=new Date-this.start)}},{key:"resume",value:function(){typeof document>"u"||(this.start=new Date,window.clearTimeout(this.timer),this.timer=window.setTimeout(this.callback,this.remaining))}}]),St}();Is.resetDefaults=function(){ks=M({},S0)},Is.setDefaults=function(St){ks=M(M({},S0),St)},Is.setDoc=function ku(St){for(var ct in Yo)Yo[ct].remove();Yo={},O0=St},Is.toast=function Ru(St){if(!St.message)throw new Error("message is required");var ct=M(M({},ks),St),Bt=new T0(ct),Pn=function on(St,ct,Bt,Pn,cr,u3){if(Yo.position)return Yo.position;var J2=Eo().createElement("div");return J2.setAttribute("style","width:100%;z-index:99999;position:fixed;pointer-events:none;display:flex;flex-direction:column;padding:15px;"+Ja(ct,Bt,Pn,cr,u3)),St.appendChild(J2),Yo.position=J2,J2}(ct.appendTo||Eo().body,ct.position||ks.position,ct.offsetTop||ks.offsetTop,ct.offsetBottom||ks.offsetBottom,ct.offsetLeft||ks.offsetLeft,ct.offsetRight||ks.offsetRight);if(ct.single)for(var cr=Pn.lastElementChild;cr;)Pn.removeChild(cr),cr=Pn.lastElementChild;Pn.appendChild(Bt.element)},Object.defineProperty(Is,"__esModule",{value:!0})}(E0)},5780:(Iu,E0,Is)=>{"use strict";Is.d(E0,{AB:()=>qv,o$:()=>Lu});const jo=":",M="|",P0="@@",ar="\u241f";let Zo;function Hl(ce){Zo??=new TextEncoder;const ge=Zo.encode(ce),Me=new DataView(ge.buffer,ge.byteOffset,ge.byteLength);let De=ct(Me,ge.length,0),gt=ct(Me,ge.length,102072);return 0==De&&(0==gt||1==gt)&&(De^=319790063,gt^=-1801410264),BigInt.asUintN(32,BigInt(De))<<BigInt(32)|BigInt.asUintN(32,BigInt(gt))}function ct(ce,ge,Me){let De=2654435769,gt=2654435769,wt=0;const cn=ge-12;for(;wt<=cn;wt+=12){De+=ce.getUint32(wt,!0),gt+=ce.getUint32(wt+4,!0);const v1=Bt(De,gt,Me+=ce.getUint32(wt+8,!0));De=v1[0],gt=v1[1],Me=v1[2]}const O1=ge-wt;return Me+=ge,O1>=4?(De+=ce.getUint32(wt,!0),wt+=4,O1>=8?(gt+=ce.getUint32(wt,!0),wt+=4,O1>=9&&(Me+=ce.getUint8(wt++)<<8),O1>=10&&(Me+=ce.getUint8(wt++)<<16),11===O1&&(Me+=ce.getUint8(wt++)<<24)):(O1>=5&&(gt+=ce.getUint8(wt++)),O1>=6&&(gt+=ce.getUint8(wt++)<<8),7===O1&&(gt+=ce.getUint8(wt++)<<16))):(O1>=1&&(De+=ce.getUint8(wt++)),O1>=2&&(De+=ce.getUint8(wt++)<<8),3===O1&&(De+=ce.getUint8(wt++)<<16)),Bt(De,gt,Me)[2]}function Bt(ce,ge,Me){return ce-=ge,ce-=Me,ge-=Me,ge-=ce^=Me>>>13,Me-=ce,Me-=ge^=ce<<8,ce-=ge,ce-=Me^=ge>>>13,ge-=Me,ge-=ce^=Me>>>12,Me-=ce,Me-=ge^=ce<<16,ce-=ge,ce-=Me^=ge>>>5,ge-=Me,ge-=ce^=Me>>>3,Me-=ce,Me-=ge^=ce<<10,[ce,ge,Me^=ge>>>15]}function wR(ce,ge,Me,De,gt=[]){const wt={},cn={},O1={},v1=function bR(ce,ge){const{text:Me,block:De}=nh(ce,ge);if(void 0===De)return{text:Me};{const[gt,...wt]=De.split(ar),[cn,O1]=gt.split(P0,2);let[v1,Li]=cn.split(M,2);return void 0===Li&&(Li=v1,v1=void 0),""===Li&&(Li=void 0),{text:Me,meaning:v1,description:Li,customId:O1,legacyIds:wt}}}(ce[0],ce.raw[0]),Li=[v1.text],Po=[];let ec=v1.text;for(let Ko=1;Ko<ce.length;Ko++){const{messagePart:w0,placeholderName:ni=Fv(Ko),associatedMessageId:f3}=AR(ce[Ko],ce.raw[Ko]);ec+=`{$${ni}}${w0}`,void 0!==ge&&(wt[ni]=ge[Ko-1],cn[ni]=gt[Ko-1]),Po.push(ni),void 0!==f3&&(O1[ni]=f3),Li.push(w0)}const Fl=v1.customId||function St(ce,ge=""){let Me=Hl(ce);return ge&&(Me=BigInt.asUintN(64,Me<<BigInt(1))|Me>>BigInt(63)&BigInt(1),Me+=Hl(ge)),BigInt.asUintN(63,Me).toString()}(ec,v1.meaning||""),Ul=v1.legacyIds?v1.legacyIds.filter(Ko=>Ko!==Fl):[];return{id:Fl,legacyIds:Ul,substitutions:wt,substitutionLocations:cn,text:ec,customId:v1.customId,meaning:v1.meaning||"",description:v1.description||"",messageParts:Li,messagePartLocations:De,placeholderNames:Po,associatedMessageIds:O1,location:Me}}function AR(ce,ge){const{text:Me,block:De}=nh(ce,ge);if(void 0===De)return{messagePart:Me};{const[gt,wt]=De.split(P0);return{messagePart:Me,placeholderName:gt,associatedMessageId:wt}}}function nh(ce,ge){if(ge.charAt(0)!==jo)return{text:ce};{const Me=Uv(ce,ge);return{block:ce.substring(1,Me),text:ce.substring(Me+1)}}}function Fv(ce){return 1===ce?"PH":"PH_"+(ce-1)}function Uv(ce,ge){for(let Me=1,De=1;Me<ce.length;Me++,De++)if("\\"===ge[De])De++;else if(ce[Me]===jo)return Me;throw new Error(`Unterminated $localize metadata block in "${ge}".`)}class rh extends Error{constructor(ge){super(`No translation found for ${Wv(ge)}.`),this.parsedMessage=ge,this.type="MissingTranslationError"}}function $v(ce,ge){return Object.defineProperty(ce,"raw",{value:ge}),ce}function Wv(ce){const ge=ce.meaning&&` - "${ce.meaning}"`,Me=ce.legacyIds&&ce.legacyIds.length>0?` [${ce.legacyIds.map(De=>`"${De}"`).join(", ")}]`:"";return`"${ce.id}"${Me} ("${ce.text}"${ge})`}function qv(ce){$localize.translate||($localize.translate=jv),$localize.TRANSLATIONS||($localize.TRANSLATIONS={}),Object.keys(ce).forEach(ge=>{$localize.TRANSLATIONS[ge]=function xu(ce){const ge=ce.split(/{\$([^}]*)}/),Me=[ge[0]],De=[];for(let wt=1;wt<ge.length-1;wt+=2)De.push(ge[wt]),Me.push(`${ge[wt+1]}`);const gt=Me.map(wt=>wt.charAt(0)===jo?"\\"+wt:wt);return{text:ce,messageParts:$v(Me,gt),placeholderNames:De}}(ce[ge])})}function jv(ce,ge){try{return function Bv(ce,ge,Me){const De=wR(ge,Me);let gt=ce[De.id];if(void 0!==De.legacyIds)for(let wt=0;wt<De.legacyIds.length&&void 0===gt;wt++)gt=ce[De.legacyIds[wt]];if(void 0===gt)throw new rh(De);return[gt.messageParts,gt.placeholderNames.map(wt=>{if(De.substitutions.hasOwnProperty(wt))return De.substitutions[wt];throw new Error(`There is a placeholder name mismatch with the translation provided for the message ${Wv(De)}.\nThe translation contains a placeholder with name ${wt}, which does not exist in the message.`)})]}($localize.TRANSLATIONS,ce,ge)}catch(Me){return console.warn(Me.message),[ce,ge]}}const Lu=function(ce,...ge){if(Lu.translate){const De=Lu.translate(ce,ge);ce=De[0],ge=De[1]}let Me=zu(ce[0],ce.raw[0]);for(let De=1;De<ce.length;De++)Me+=ge[De-1]+zu(ce[De],ce.raw[De]);return Me},NR=":";function zu(ce,ge){return ge.charAt(0)===NR?ce.substring(Uv(ce,ge)+1):ce}}},Iu=>{Iu(Iu.s=5008)}]);