!function(){var e,t,n,r,i,a,o,s,u,c,l,h,f,d,v,p,g,y,m,k,_,w,C,b,E,S,P,O,T,I,x,A,R,N,M,D,L,F,B,V,U,z,H,G,q,$,W,j,Z,Y,K,J,Q,X,ee,te,ne,re,ie,ae,oe,se,ue,ce,le,he,fe,de,ve,pe,ge,ye,me,ke,_e,we,Ce,be,Ee,Se,Pe,Oe,Te,Ie,xe,Ae,Re,Ne,Me,De,Le,Fe,Be,Ve,Ue,ze,He,Ge,qe,$e,We,je,Ze,Ye,Ke,Je,Qe,Xe,et,tt,nt,rt,it,at,ot,st,ut,ct,lt,ht,ft,dt,vt,pt,gt,yt,mt,kt,_t,wt,Ct,bt,Et,St,Pt,Ot,Tt,It,xt,At,Rt,Nt,Mt,Dt,Lt,Ft,Bt,Vt,Ut,zt,Ht,Gt,qt,$t,Wt,jt,Zt,Yt,Kt,Jt,Qt,Xt,en,tn,nn,rn,an,on,sn,un,cn,ln,hn,fn,dn,vn,pn,gn,yn,mn,kn,_n,wn,Cn,bn,En,Sn,Pn,On,Tn,In,xn,An,Rn,Nn,Mn,Dn,Ln,Fn,Bn,Vn,Un,zn,Hn,Gn,qn,$n,Wn,jn,Zn,Yn,Kn,Jn,Qn,Xn,er,tr,nr,rr,ir,ar,or,sr,ur,cr,lr,hr,fr,dr,vr,pr,gr,yr,mr,kr,_r,wr,Cr,br,Er,Sr,Pr,Or,Tr,Ir,xr,Ar,Rr,Nr,Mr,Dr,Lr,Fr,Br,Vr,Ur,zr,Hr,Gr,qr,$r,Wr,jr,Zr,Yr,Kr,Jr,Qr,Xr,ei,ti,ni,ri,ii,ai,oi,si,ui,ci,li,hi,fi,di,vi,pi,gi,yi,mi,ki,_i,wi,Ci,bi,Ei,Si,Pi,Oi,Ti,Ii,xi,Ai,Ri,Ni,Mi,Di,Li,Fi,Bi,Vi,Ui,zi,Hi,Gi,qi,$i,Wi,ji,Zi,Yi,Ki,Ji,Qi,Xi,ea,ta,na,ra,ia,aa,oa,sa,ua,ca,la,ha,fa,da,va,pa,ga,ya,ma,ka,_a,wa,Ca,ba,Ea,Sa,Pa,Oa,Ta,Ia,xa,Aa,Ra,Na,Ma,Da,La,Fa,Ba,Va,Ua,za,Ha,Ga,qa,$a,Wa,ja,Za,Ya,Ka,Ja,Qa,Xa,eo,to,no,ro,io,ao,oo,so,uo,co,lo,ho,fo,vo,po,go,yo,mo,ko,_o,wo,Co,bo,Eo,So,Po,Oo,To,Io,xo,Ao,Ro,No,Mo,Do,Lo,Fo,Bo,Vo,Uo,zo,Ho,Go,qo,$o,Wo,jo,Zo,Yo,Ko,Jo,Qo,Xo,es,ts,ns,rs,is,as,os,ss,us,cs,ls,hs,fs,ds,vs,ps,gs,ys,ms,ks,_s,ws,Cs,bs,Es,Ss,Ps,Os,Ts,Is,xs,As,Rs,Ns,Ms,Ds,Ls,Fs,Bs,Vs,Us,zs,Hs,Gs,qs,$s,Ws,js,Zs,Ys,Ks,Js,Qs,Xs,eu,tu,nu,ru,iu,au,ou,su,uu,cu,lu,hu,fu,du,vu,pu,gu,yu,mu,ku,_u,wu,Cu,bu,Eu,Su,Pu,Ou,Tu,Iu,xu,Au,Ru,Nu,Mu,Du,Lu,Fu,Bu,Vu,Uu,zu,Hu,Gu,qu,$u,Wu,ju,Zu,Yu,Ku,Ju,Qu,Xu,ec,tc,nc,rc,ic,ac,oc,sc,uc,cc,lc,hc,fc,dc,vc,pc,gc,yc,mc,kc,_c,wc,Cc,bc,Ec,Sc,Pc,Oc,Tc,Ic,xc,Ac,Rc,Nc,Mc,Dc,Lc,Fc,Bc,Vc,Uc,zc,Hc,Gc,qc,$c,Wc,jc,Zc,Yc,Kc,Jc,Qc,Xc,el,tl,nl,rl,il,al,ol,sl,ul,cl,ll,hl,fl,dl,vl,pl,gl,yl,ml,kl,_l,wl,Cl,bl,El,Sl,Pl,Ol,Tl,Il,xl,Al,Rl,Nl,Ml,Dl,Ll,Fl,Bl,Vl,Ul,zl,Hl,Gl,ql,$l,Wl,jl,Zl,Yl,Kl,Jl,Ql,Xl,eh,th,nh,rh,ih,ah,oh,sh,uh,ch,lh,hh,fh,dh,vh,ph,gh,yh,mh,kh,_h,wh,Ch,bh,Eh,Sh,Ph,Oh,Th,Ih,xh,Ah,Rh,Nh,Mh,Dh,Lh,Fh,Bh,Vh,Uh,zh,Hh,Gh,qh,$h,Wh,jh,Zh,Yh,Kh,Jh,Qh,Xh,ef,tf,nf,rf,af,of,sf,uf,cf,lf,hf,ff,df,vf,pf,gf,yf,mf,kf,_f,wf,Cf,bf,Ef,Sf,Pf,Of,Tf,If,xf,Af,Rf,Nf,Mf,Df,Lf,Ff,Bf,Vf,Uf,zf,Hf,Gf,qf,$f,Wf,jf,Zf,Yf,Kf,Jf,Qf,Xf,ed,td,nd,rd,id,ad,od,sd,ud,cd,ld,hd,fd,dd,vd,pd,gd,yd,md,kd,_d,wd,Cd,bd,Ed,Sd,Pd,Od,Td,Id,xd,Ad,Rd,Nd,Md,Dd,Ld,Fd,Bd,Vd,Ud,zd,Hd,Gd,qd,$d,Wd,jd,Zd,Yd,Kd,Jd,Qd,Xd,ev,tv,nv,rv,iv,av,ov,sv,uv,cv,lv,hv,fv,dv,vv,pv,gv,yv,mv,kv,_v,wv,Cv,bv,Ev,Sv,Pv,Ov,Tv,Iv,xv;function Av(e){return Bv(e)||Jv(e)||Xv(e)||Fv()}function Rv(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function Nv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Mv(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Nv(Object(n),!0).forEach(function(t){Dv(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Nv(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Dv(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Lv(e,t){return Bv(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,i,a=[],o=!0,s=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(a.push(r.value),!t||a.length!==t);o=!0);}catch(u){s=!0,i=u}finally{try{o||null==n.return||n.return()}finally{if(s)throw i}}return a}(e,t)||Xv(e,t)||Fv()}function Fv(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Bv(e){if(Array.isArray(e))return e}function Vv(e){var t="function"==typeof Map?new Map:void 0;return(Vv=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return Uv(e,arguments,Yv(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),qv(r,e)})(e)}function Uv(e,t,n){return(Uv=Zv()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&qv(i,n.prototype),i}).apply(null,arguments)}function zv(){return(zv="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=Hv(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}}).apply(this,arguments)}function Hv(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Yv(e)););return e}function Gv(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&qv(e,t)}function qv(e,t){return(qv=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function $v(e){var t=Zv();return function(){var n,r=Yv(e);if(t){var i=Yv(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Wv(this,n)}}function Wv(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return jv(e)}function jv(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Zv(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function Yv(e){return(Yv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Kv(e){return function(e){if(Array.isArray(e))return ep(e)}(e)||Jv(e)||Xv(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Jv(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function Qv(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=Xv(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function Xv(e,t){if(e){if("string"==typeof e)return ep(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ep(e,t):void 0}}function ep(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function tp(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function np(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function rp(e,t,n){return t&&np(e.prototype,t),n&&np(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}(self.webpackChunkEveryBoard=self.webpackChunkEveryBoard||[]).push([[179],{8255:function(e){function t(e){return Promise.resolve().then(function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t})}t.keys=function(){return[]},t.resolve=t,t.id=8255,e.exports=t},9575:function(e,t,n){var r,i,a;!function(o){if("object"==typeof e.exports){var s=o(0,t);void 0!==s&&(e.exports=s)}else i=[n,t],void 0!==(a="function"==typeof(r=o)?r.apply(t,i):r)&&(e.exports=a)}(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=void 0;t.default=["fr",[["AM","PM"],n,n],n,[["D","L","M","M","J","V","S"],["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"],["di","lu","ma","me","je","ve","sa"]],n,[["J","F","M","A","M","J","J","A","S","O","N","D"],["janv.","f\xe9vr.","mars","avr.","mai","juin","juil.","ao\xfbt","sept.","oct.","nov.","d\xe9c."],["janvier","f\xe9vrier","mars","avril","mai","juin","juillet","ao\xfbt","septembre","octobre","novembre","d\xe9cembre"]],n,[["av. J.-C.","ap. J.-C."],n,["avant J\xe9sus-Christ","apr\xe8s J\xe9sus-Christ"]],1,[6,0],["dd/MM/y","d MMM y","d MMMM y","EEEE d MMMM y"],["HH:mm","HH:mm:ss","HH:mm:ss z","HH:mm:ss zzzz"],["{1} {0}","{1} '\xe0' {0}",n,n],[",","\u202f",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0\xa0%","#,##0.00\xa0\xa4","#E0"],"EUR","\u20ac","euro",{ARS:["$AR","$"],AUD:["$AU","$"],BEF:["FB"],BMD:["$BM","$"],BND:["$BN","$"],BZD:["$BZ","$"],CAD:["$CA","$"],CLP:["$CL","$"],CNY:[n,"\xa5"],COP:["$CO","$"],CYP:["\xa3CY"],EGP:[n,"\xa3E"],FJD:["$FJ","$"],FKP:["\xa3FK","\xa3"],FRF:["F"],GBP:["\xa3GB","\xa3"],GIP:["\xa3GI","\xa3"],HKD:[n,"$"],IEP:["\xa3IE"],ILP:["\xa3IL"],ITL:["\u20a4IT"],JPY:[n,"\xa5"],KMF:[n,"FC"],LBP:["\xa3LB","\xa3L"],MTP:["\xa3MT"],MXN:["$MX","$"],NAD:["$NA","$"],NIO:[n,"$C"],NZD:["$NZ","$"],RHD:["$RH"],RON:[n,"L"],RWF:[n,"FR"],SBD:["$SB","$"],SGD:["$SG","$"],SRD:["$SR","$"],TOP:[n,"$T"],TTD:["$TT","$"],TWD:[n,"NT$"],USD:["$US","$"],UYU:["$UY","$"],WST:["$WS"],XCD:[n,"$"],XPF:["FCFP"],ZMW:[n,"Kw"]},"ltr",function(e){var t=Math.floor(Math.abs(e));return 0===t||1===t?1:5}]})},5378:function(e,t){!function(e){"use strict";function t(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function n(e){for(var n,r=1;r<arguments.length;r++){var i;n=null!==(i=arguments[r])&&void 0!==i?i:{},r%2?t(Object(n),!0).forEach(function(t){o(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):t(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n,r=0;r<t.length;r++)(n=t[r]).enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(){var e;return null!==(e=h)&&void 0!==e?e:document}var u={duration:2e3,position:"top-right",closeOnClick:!0,opacity:1,single:!1,offsetTop:0,offsetBottom:0,offsetLeft:0,offsetRight:0,extraClasses:""},c=n({},u),l={},h=null,f=function(){function e(t){var n=this;r(this,e),this.element=s().createElement("div"),this.opacity=t.opacity,this.type=t.type,this.animate=t.animate,this.dismissible=t.dismissible,this.closeOnClick=t.closeOnClick,this.message=t.message,this.duration=t.duration,this.pauseOnHover=t.pauseOnHover,this.offsetTop=t.offsetTop,this.offsetBottom=t.offsetBottom,this.offsetLeft=t.offsetLeft,this.offsetRight=t.offsetRight,this.extraClasses=t.extraClasses;var i="width:auto;pointer-events:auto;display:inline-flex;white-space:pre-wrap;opacity:".concat(this.opacity,";"),a=["notification",this.extraClasses];if(this.type&&a.push(this.type),this.animate&&this.animate.in){var o="animate__".concat(this.animate.in),u=this.animate.speed?"animate__".concat(this.animate.speed):"animate__faster";a.push("animate__animated ".concat(o," ").concat(u)),this.onAnimationEnd(function(){return n.element.classList.remove(o)})}if(this.element.className=a.join(" "),this.dismissible){var c=s().createElement("button");c.className="delete",c.addEventListener("click",function(){n.destroy()}),this.element.insertAdjacentElement("afterbegin",c)}else i+="padding: 1.25rem 1.5rem";this.closeOnClick&&this.element.addEventListener("click",function(){n.destroy()}),this.element.setAttribute("style",i),"string"==typeof this.message?this.element.insertAdjacentHTML("beforeend",this.message):this.element.appendChild(this.message);var l=new d(function(){n.destroy()},this.duration);this.pauseOnHover&&(this.element.addEventListener("mouseover",function(){l.pause()}),this.element.addEventListener("mouseout",function(){l.resume()}))}return a(e,[{key:"destroy",value:function(){var e=this;this.animate&&this.animate.out?(this.element.classList.add("animate__".concat(this.animate.out)),this.onAnimationEnd(function(){e.removeParent(e.element.parentNode),e.element.remove(),delete l.position})):(this.removeParent(this.element.parentNode),this.element.remove(),delete l.position)}},{key:"removeParent",value:function(e){e&&1>=e.children.length&&e.remove()}},{key:"onAnimationEnd",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:function(){},t={animation:"animationend",OAnimation:"oAnimationEnd",MozAnimation:"mozAnimationEnd",WebkitAnimation:"webkitAnimationEnd"};for(var n in t)if(void 0!==this.element.style[n]){this.element.addEventListener(t[n],function(){return e()});break}}}]),e}(),d=function(){function e(t,n){r(this,e),this.remaining=n,this.callback=t,this.resume()}return a(e,[{key:"pause",value:function(){"undefined"==typeof document||(window.clearTimeout(this.timer),this.remaining-=new Date-this.start)}},{key:"resume",value:function(){"undefined"==typeof document||(this.start=new Date,window.clearTimeout(this.timer),this.timer=window.setTimeout(this.callback,this.remaining))}}]),e}();e.resetDefaults=function(){c=n({},u)},e.setDefaults=function(e){c=n(n({},u),e)},e.setDoc=function(e){for(var t in l)l[t].remove();l={},h=e},e.toast=function(e){if(!e.message)throw new Error("message is required");var t=n(n({},c),e),r=new f(t),i=function(e,t,n,r,i,a){if(l.position)return l.position;var o=s().createElement("div");return o.setAttribute("style","width:100%;z-index:99999;position:fixed;pointer-events:none;display:flex;flex-direction:column;padding:15px;"+function(e,t,n,r,i){return"top-left"===e?"left:".concat(r,";top:").concat(t,";text-align:left;align-items:flex-start;"):"top-right"===e?"right:".concat(i,";top:").concat(t,";text-align:right;align-items:flex-end;"):"top-center"===e?"top:".concat(t,";left:0;right:0;text-align:center;align-items:center;"):"bottom-left"===e?"left:".concat(r,";bottom:").concat(n,";text-align:left;align-items:flex-start;"):"bottom-right"===e?"right:".concat(i,";bottom:").concat(n,";text-align:right;align-items:flex-end;"):"bottom-center"===e?"bottom:".concat(n,";left:0;right:0;text-align:center;align-items:center;"):"center"===e?"top:0;left:0;right:0;bottom:0;flex-flow:column;justify-content:center;align-items:center;":void 0}(t,n,r,i,a)),e.appendChild(o),l.position=o,o}(t.appendTo||s().body,t.position||c.position,t.offsetTop||c.offsetTop,t.offsetBottom||c.offsetBottom,t.offsetLeft||c.offsetLeft,t.offsetRight||c.offsetRight);if(t.single)for(var a=i.lastElementChild;a;)i.removeChild(a),a=i.lastElementChild;i.appendChild(r.element)},Object.defineProperty(e,"__esModule",{value:!0})}(t)},6676:function(e,t){!function(e){"use strict";function t(e){return Array.prototype.slice.call(e)}function n(e){return new Promise(function(t,n){e.onsuccess=function(){t(e.result)},e.onerror=function(){n(e.error)}})}function r(e,t,r){var i,a=new Promise(function(a,o){n(i=e[t].apply(e,r)).then(a,o)});return a.request=i,a}function i(e,t,n){var i=r(e,t,n);return i.then(function(e){if(e)return new l(e,i.request)})}function a(e,t,n){n.forEach(function(n){Object.defineProperty(e.prototype,n,{get:function(){return this[t][n]},set:function(e){this[t][n]=e}})})}function o(e,t,n,i){i.forEach(function(i){i in n.prototype&&(e.prototype[i]=function(){return r(this[t],i,arguments)})})}function s(e,t,n,r){r.forEach(function(r){r in n.prototype&&(e.prototype[r]=function(){return this[t][r].apply(this[t],arguments)})})}function u(e,t,n,r){r.forEach(function(r){r in n.prototype&&(e.prototype[r]=function(){return i(this[t],r,arguments)})})}function c(e){this._index=e}function l(e,t){this._cursor=e,this._request=t}function h(e){this._store=e}function f(e){this._tx=e,this.complete=new Promise(function(t,n){e.oncomplete=function(){t()},e.onerror=function(){n(e.error)},e.onabort=function(){n(e.error)}})}function d(e,t,n){this._db=e,this.oldVersion=t,this.transaction=new f(n)}function v(e){this._db=e}a(c,"_index",["name","keyPath","multiEntry","unique"]),o(c,"_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]),u(c,"_index",IDBIndex,["openCursor","openKeyCursor"]),a(l,"_cursor",["direction","key","primaryKey","value"]),o(l,"_cursor",IDBCursor,["update","delete"]),["advance","continue","continuePrimaryKey"].forEach(function(e){e in IDBCursor.prototype&&(l.prototype[e]=function(){var t=this,r=arguments;return Promise.resolve().then(function(){return t._cursor[e].apply(t._cursor,r),n(t._request).then(function(e){if(e)return new l(e,t._request)})})})}),h.prototype.createIndex=function(){return new c(this._store.createIndex.apply(this._store,arguments))},h.prototype.index=function(){return new c(this._store.index.apply(this._store,arguments))},a(h,"_store",["name","keyPath","indexNames","autoIncrement"]),o(h,"_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getKey","getAllKeys","count"]),u(h,"_store",IDBObjectStore,["openCursor","openKeyCursor"]),s(h,"_store",IDBObjectStore,["deleteIndex"]),f.prototype.objectStore=function(){return new h(this._tx.objectStore.apply(this._tx,arguments))},a(f,"_tx",["objectStoreNames","mode"]),s(f,"_tx",IDBTransaction,["abort"]),d.prototype.createObjectStore=function(){return new h(this._db.createObjectStore.apply(this._db,arguments))},a(d,"_db",["name","version","objectStoreNames"]),s(d,"_db",IDBDatabase,["deleteObjectStore","close"]),v.prototype.transaction=function(){return new f(this._db.transaction.apply(this._db,arguments))},a(v,"_db",["name","version","objectStoreNames"]),s(v,"_db",IDBDatabase,["close"]),["openCursor","openKeyCursor"].forEach(function(e){[h,c].forEach(function(n){e in n.prototype&&(n.prototype[e.replace("open","iterate")]=function(){var n=t(arguments),r=n[n.length-1],i=this._store||this._index,a=i[e].apply(i,n.slice(0,-1));a.onsuccess=function(){r(a.result)}})})}),[c,h].forEach(function(e){e.prototype.getAll||(e.prototype.getAll=function(e,t){var n=this,r=[];return new Promise(function(i){n.iterateCursor(e,function(e){e?(r.push(e.value),void 0===t||r.length!=t?e.continue():i(r)):i(r)})})})}),e.openDb=function(e,t,n){var i=r(indexedDB,"open",[e,t]),a=i.request;return a&&(a.onupgradeneeded=function(e){n&&n(new d(a.result,e.oldVersion,a.transaction))}),i.then(function(e){return new v(e)})},e.deleteDb=function(e){return r(indexedDB,"deleteDatabase",[e])},Object.defineProperty(e,"__esModule",{value:!0})}(t)},9259:function(Nv,Fv,Bv){"use strict";var Hv,qv;function Zv(e){return"function"==typeof e}function Jv(e){var t=e(function(e){Error.call(e),e.stack=(new Error).stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var Xv=Jv(function(e){return function(t){e(this),this.message=t?"".concat(t.length," errors occurred during unsubscription:\n").concat(t.map(function(e,t){return"".concat(t+1,") ").concat(e.toString())}).join("\n  ")):"",this.name="UnsubscriptionError",this.errors=t}});function ep(e,t){if(e){var n=e.indexOf(t);0<=n&&e.splice(n,1)}}var np,ip=function(){function e(t){tp(this,e),this.initialTeardown=t,this.closed=!1,this._parentage=null,this._teardowns=null}return rp(e,[{key:"unsubscribe",value:function(){var e;if(!this.closed){this.closed=!0;var t=this._parentage;if(t)if(this._parentage=null,Array.isArray(t)){var n,r=Qv(t);try{for(r.s();!(n=r.n()).done;){var i;n.value.remove(this)}}catch(h){r.e(h)}finally{r.f()}}else t.remove(this);var a=this.initialTeardown;if(Zv(a))try{a()}catch(i){e=i instanceof Xv?i.errors:[i]}var o=this._teardowns;if(o){this._teardowns=null;var s,u=Qv(o);try{for(u.s();!(s=u.n()).done;){var c=s.value;try{sp(c)}catch(f){var l;e=null!==(l=e)&&void 0!==l?l:[],f instanceof Xv?e=[].concat(Kv(e),Kv(f.errors)):e.push(f)}}}catch(h){u.e(h)}finally{u.f()}}if(e)throw new Xv(e)}}},{key:"add",value:function(t){var n;if(t&&t!==this)if(this.closed)sp(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._teardowns=null!==(n=this._teardowns)&&void 0!==n?n:[]).push(t)}}},{key:"_hasParent",value:function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)}},{key:"_addParent",value:function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}},{key:"_removeParent",value:function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&ep(t,e)}},{key:"remove",value:function(t){var n=this._teardowns;n&&ep(n,t),t instanceof e&&t._removeParent(this)}}]),e}();ip.EMPTY=((np=new ip).closed=!0,np);var ap=ip.EMPTY;function op(e){return e instanceof ip||e&&"closed"in e&&Zv(e.remove)&&Zv(e.add)&&Zv(e.unsubscribe)}function sp(e){Zv(e)?e():e.unsubscribe()}var up=null,cp=null,lp=void 0,hp=!1,fp=!1,dp={setTimeout:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){var e=dp.delegate;return((null==e?void 0:e.setTimeout)||setTimeout).apply(void 0,arguments)}),clearTimeout:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){var t=dp.delegate;return((null==t?void 0:t.clearTimeout)||clearTimeout)(e)}),delegate:void 0};function vp(e){dp.setTimeout(function(){if(!up)throw e;up(e)})}function pp(){}var gp=yp("C",void 0,void 0);function yp(e,t,n){return{kind:e,value:t,error:n}}var mp=null;function kp(e){if(hp){var t=!mp;if(t&&(mp={errorThrown:!1,error:null}),e(),t){var n=mp,r=n.errorThrown,i=n.error;if(mp=null,r)throw i}}else e()}var _p=function(e){Gv(n,e);var t=$v(n);function n(e){var r;return tp(this,n),(r=t.call(this)).isStopped=!1,e?(r.destination=e,op(e)&&e.add(jv(r))):r.destination=Sp,r}return rp(n,[{key:"next",value:function(e){this.isStopped?Ep(yp("N",e,void 0),this):this._next(e)}},{key:"error",value:function(e){this.isStopped?Ep(yp("E",void 0,e),this):(this.isStopped=!0,this._error(e))}},{key:"complete",value:function(){this.isStopped?Ep(gp,this):(this.isStopped=!0,this._complete())}},{key:"unsubscribe",value:function(){this.closed||(this.isStopped=!0,zv(Yv(n.prototype),"unsubscribe",this).call(this),this.destination=null)}},{key:"_next",value:function(e){this.destination.next(e)}},{key:"_error",value:function(e){try{this.destination.error(e)}finally{this.unsubscribe()}}},{key:"_complete",value:function(){try{this.destination.complete()}finally{this.unsubscribe()}}}],[{key:"create",value:function(e,t,n){return new wp(e,t,n)}}]),n}(ip),wp=function(e){Gv(n,e);var t=$v(n);function n(e,r,i){var a,o,s;if(tp(this,n),o=t.call(this),Zv(e))s=e;else if(e){var u,c;s=(u=e).next,r=u.error,i=u.complete,jv(o)&&fp?(c=Object.create(e)).unsubscribe=function(){return o.unsubscribe()}:c=e,s=null==s?void 0:s.bind(c),r=null==r?void 0:r.bind(c),i=null==i?void 0:i.bind(c)}return o.destination={next:s?Cp(s):pp,error:Cp(null!==(a=r)&&void 0!==a?a:bp),complete:i?Cp(i):pp},Wv(o)}return rp(n)}(_p);function Cp(e,t){return function(){try{e.apply(void 0,arguments)}catch(t){hp?function(e){hp&&mp&&(mp.errorThrown=!0,mp.error=e)}(t):vp(t)}}}function bp(e){throw e}function Ep(e,t){var n=cp;n&&dp.setTimeout(function(){return n(e,t)})}var Sp={closed:!0,next:pp,error:bp,complete:pp},Pp="function"==typeof Symbol&&Symbol.observable||"@@observable";function Op(e){return e}var Tp=function(){var e=function(){function e(t){tp(this,e),t&&(this._subscribe=t)}return rp(e,[{key:"lift",value:function(t){var n=new e;return n.source=this,n.operator=t,n}},{key:"subscribe",value:function(e,t,n){var r=this,i=function(e){return e&&e instanceof _p||function(e){return e&&Zv(e.next)&&Zv(e.error)&&Zv(e.complete)}(e)&&op(e)}(e)?e:new wp(e,t,n);return kp(function(){var e=r.operator,t=r.source;i.add(e?e.call(i,t):t?r._subscribe(i):r._trySubscribe(i))}),i}},{key:"_trySubscribe",value:function(e){try{return this._subscribe(e)}catch(t){e.error(t)}}},{key:"forEach",value:function(e,t){var n=this;return new(t=Ip(t))(function(t,r){var i=new wp({next:function(t){try{e(t)}catch(n){r(n),i.unsubscribe()}},error:r,complete:t});n.subscribe(i)})}},{key:"_subscribe",value:function(e){var t;return null===(t=this.source)||void 0===t?void 0:t.subscribe(e)}},{key:Pp,value:function(){return this}},{key:"pipe",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return 0===e.length?Op:1===e.length?e[0]:function(t){return e.reduce(function(e,t){return t(e)},t)}}(t)(this)}},{key:"toPromise",value:function(e){var t=this;return new(e=Ip(e))(function(e,n){var r;t.subscribe(function(e){return r=e},function(e){return n(e)},function(){return e(r)})})}}]),e}();return e.create=function(t){return new e(t)},e}();function Ip(e){var t;return null!==(t=null!=e?e:lp)&&void 0!==t?t:Promise}var xp=Jv(function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),Ap=function(){var e=function(e){Gv(n,e);var t=$v(n);function n(){var e;return tp(this,n),(e=t.call(this)).closed=!1,e.observers=[],e.isStopped=!1,e.hasError=!1,e.thrownError=null,e}return rp(n,[{key:"lift",value:function(e){var t=new Rp(this,this);return t.operator=e,t}},{key:"_throwIfClosed",value:function(){if(this.closed)throw new xp}},{key:"next",value:function(e){var t=this;kp(function(){if(t._throwIfClosed(),!t.isStopped){var n,r=Qv(t.observers.slice());try{for(r.s();!(n=r.n()).done;){n.value.next(e)}}catch(i){r.e(i)}finally{r.f()}}})}},{key:"error",value:function(e){var t=this;kp(function(){if(t._throwIfClosed(),!t.isStopped){t.hasError=t.isStopped=!0,t.thrownError=e;for(var n=t.observers;n.length;)n.shift().error(e)}})}},{key:"complete",value:function(){var e=this;kp(function(){if(e._throwIfClosed(),!e.isStopped){e.isStopped=!0;for(var t=e.observers;t.length;)t.shift().complete()}})}},{key:"unsubscribe",value:function(){this.isStopped=this.closed=!0,this.observers=null}},{key:"observed",get:function(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0}},{key:"_trySubscribe",value:function(e){return this._throwIfClosed(),zv(Yv(n.prototype),"_trySubscribe",this).call(this,e)}},{key:"_subscribe",value:function(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)}},{key:"_innerSubscribe",value:function(e){var t=this.hasError,n=this.isStopped,r=this.observers;return t||n?ap:(r.push(e),new ip(function(){return ep(r,e)}))}},{key:"_checkFinalizedStatuses",value:function(e){var t=this.hasError,n=this.thrownError,r=this.isStopped;t?e.error(n):r&&e.complete()}},{key:"asObservable",value:function(){var e=new Tp;return e.source=this,e}}]),n}(Tp);return e.create=function(e,t){return new Rp(e,t)},e}(),Rp=function(e){Gv(n,e);var t=$v(n);function n(e,r){var i;return tp(this,n),(i=t.call(this)).destination=e,i.source=r,i}return rp(n,[{key:"next",value:function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===n||n.call(t,e)}},{key:"error",value:function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===n||n.call(t,e)}},{key:"complete",value:function(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)}},{key:"_subscribe",value:function(e){var t,n;return null!==(n=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==n?n:ap}}]),n}(Ap);function Np(e){return Zv(null==e?void 0:e.lift)}function Mp(e){return function(t){if(Np(t))return t.lift(function(t){try{return e(t,this)}catch(n){this.error(n)}});throw new TypeError("Unable to lift unknown Observable type")}}var Dp=function(e){Gv(n,e);var t=$v(n);function n(e,r,i,a,o){var s,u,c,l;return tp(this,n),(l=t.call(this,e)).onFinalize=o,l._next=r?function(t){try{r(t)}catch(n){e.error(n)}}:zv((s=jv(l),Yv(n.prototype)),"_next",s),l._error=a?function(t){try{a(t)}catch(n){e.error(n)}finally{this.unsubscribe()}}:zv((u=jv(l),Yv(n.prototype)),"_error",u),l._complete=i?function(){try{i()}catch(t){e.error(t)}finally{this.unsubscribe()}}:zv((c=jv(l),Yv(n.prototype)),"_complete",c),l}return rp(n,[{key:"unsubscribe",value:function(){var e,t=this.closed;zv(Yv(n.prototype),"unsubscribe",this).call(this),!t&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}}]),n}(_p);function Lp(e,t){return Mp(function(n,r){var i=0;n.subscribe(new Dp(r,function(n){r.next(e.call(t,n,i++))}))})}function Fp(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}function Bp(e){return this instanceof Bp?(this.v=e,this):new Bp(e)}function Vp(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(e,t||[]),a=[];return r={},o("next"),o("throw"),o("return"),r[Symbol.asyncIterator]=function(){return this},r;function o(e){i[e]&&(r[e]=function(t){return new Promise(function(n,r){a.push([e,t,n,r])>1||s(e,t)})})}function s(e,t){try{!function(e){e.value instanceof Bp?Promise.resolve(e.value.v).then(u,c):l(a[0][2],e)}(i[e](t))}catch(n){l(a[0][3],n)}}function u(e){s("next",e)}function c(e){s("throw",e)}function l(e,t){e(t),a.shift(),a.length&&s(a[0][0],a[0][1])}}function Up(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise(function(r,i){!function(e,t,n,r){Promise.resolve(r).then(function(t){e({value:t,done:n})},t)}(r,i,(t=e[n](t)).done,t.value)})}}}var zp=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e};function Hp(e){return Zv(null==e?void 0:e.then)}function Gp(e){return Zv(e[Pp])}function qp(e){return Symbol.asyncIterator&&Zv(null==e?void 0:e[Symbol.asyncIterator])}function $p(e){return new TypeError("You provided ".concat(null!==e&&"object"==typeof e?"an invalid object":"'".concat(e,"'")," where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable."))}var Wp="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator";function jp(e){return Zv(null==e?void 0:e[Wp])}function Zp(e){return Vp(this,arguments,regeneratorRuntime.mark(function t(){var n,r,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=e.getReader(),t.prev=1;case 2:return t.next=4,Bp(n.read());case 4:if(r=t.sent,i=r.value,!r.done){t.next=11;break}return t.next=10,Bp(void 0);case 10:return t.abrupt("return",t.sent);case 11:return t.next=13,Bp(i);case 13:return t.next=15,t.sent;case 15:t.next=2;break;case 17:return t.prev=17,n.releaseLock(),t.finish(17);case 20:case"end":return t.stop()}},t,null,[[1,,17,20]])}))}function Yp(e){return Zv(null==e?void 0:e.getReader)}function Kp(e){if(e instanceof Tp)return e;if(null!=e){if(Gp(e))return function(e){return new Tp(function(t){var n=e[Pp]();if(Zv(n.subscribe))return n.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(e);if(zp(e))return function(e){return new Tp(function(t){for(var n=0;n<e.length&&!t.closed;n++)t.next(e[n]);t.complete()})}(e);if(Hp(e))return function(e){return new Tp(function(t){e.then(function(e){t.closed||(t.next(e),t.complete())},function(e){return t.error(e)}).then(null,vp)})}(e);if(qp(e))return Jp(e);if(jp(e))return function(e){return new Tp(function(t){var n,r=Qv(e);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(t.next(i),t.closed)return}}catch(a){r.e(a)}finally{r.f()}t.complete()})}(e);if(Yp(e))return function(e){return Jp(Zp(e))}(e)}throw $p(e)}function Jp(e){return new Tp(function(t){(function(e,t){var n,r,i,a;return function(e,t,n,r){return new(n||(n=Promise))(function(t,i){function a(e){try{s(r.next(e))}catch(t){i(t)}}function o(e){try{s(r.throw(e))}catch(t){i(t)}}function s(e){e.done?t(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(a,o)}s((r=r.apply(e,[])).next())})}(this,0,void 0,regeneratorRuntime.mark(function o(){return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:o.prev=0,n=Up(e);case 2:return o.next=4,n.next();case 4:if((r=o.sent).done){o.next=9;break}if(t.next(r.value),!t.closed){o.next=7;break}return o.abrupt("return");case 7:o.next=2;break;case 9:o.next=14;break;case 11:o.prev=11,o.t0=o.catch(0),i={error:o.t0};case 14:if(o.prev=14,o.prev=15,o.t1=r&&!r.done&&(a=n.return),!o.t1){o.next=20;break}return o.next=20,a.call(n);case 20:if(o.prev=20,!i){o.next=23;break}throw i.error;case 23:return o.finish(20);case 24:return o.finish(14);case 25:t.complete();case 26:case"end":return o.stop()}},o,null,[[0,11,14,25],[15,,20,24]])}))})(e,t).catch(function(e){return t.error(e)})})}function Qp(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=t.schedule(function(){n(),i?e.add(this.schedule(null,r)):this.unsubscribe()},r);if(e.add(a),!i)return a}function Xp(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0;return Zv(t)?Xp(function(n,r){return Lp(function(e,i){return t(n,e,r,i)})(Kp(e(n,r)))},n):("number"==typeof t&&(n=t),Mp(function(t,r){return function(e,t,n,r,i,a,o,s){var u=[],c=0,l=0,h=!1,f=function(){h&&!u.length&&!c&&t.complete()},d=function e(i){c++;var a=!1;Kp(n(i,l++)).subscribe(new Dp(t,function(e){t.next(e)},function(){a=!0},void 0,function(){if(a)try{for(c--;u.length&&c<r;){var n=u.shift();e(n)}f()}catch(n){t.error(n)}}))};return e.subscribe(new Dp(t,function(e){return c<r?d(e):u.push(e)},function(){h=!0,f()})),function(){}}(t,r,e,n)}))}function eg(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1/0;return Xp(Op,e)}var tg=new Tp(function(e){return e.complete()});function ng(e){return e[e.length-1]}function rg(e){return Zv(ng(e))?e.pop():void 0}function ig(e){return function(e){return e&&Zv(e.schedule)}(ng(e))?e.pop():void 0}function ag(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Mp(function(n,r){n.subscribe(new Dp(r,function(n){return Qp(r,e,function(){return r.next(n)},t)},function(){return Qp(r,e,function(){return r.complete()},t)},function(n){return Qp(r,e,function(){return r.error(n)},t)}))})}function og(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Mp(function(n,r){r.add(e.schedule(function(){return n.subscribe(r)},t))})}function sg(e,t){if(!e)throw new Error("Iterable cannot be null");return new Tp(function(n){Qp(n,t,function(){var r=e[Symbol.asyncIterator]();Qp(n,t,function(){r.next().then(function(e){e.done?n.complete():n.next(e.value)})},0,!0)})})}function ug(e,t){return t?function(e,t){if(null!=e){if(Gp(e))return function(e,t){return Kp(e).pipe(og(t),ag(t))}(e,t);if(zp(e))return function(e,t){return new Tp(function(n){var r=0;return t.schedule(function(){r===e.length?n.complete():(n.next(e[r++]),n.closed||this.schedule())})})}(e,t);if(Hp(e))return function(e,t){return Kp(e).pipe(og(t),ag(t))}(e,t);if(qp(e))return sg(e,t);if(jp(e))return function(e,t){return new Tp(function(n){var r;return Qp(n,t,function(){r=e[Wp](),Qp(n,t,function(){var e,t;try{var i=r.next();e=i.value,t=i.done}catch(a){return void n.error(a)}t?n.complete():n.next(e)},0,!0)}),function(){return Zv(null==r?void 0:r.return)&&r.return()}})}(e,t);if(Yp(e))return function(e,t){return sg(Zp(e),t)}(e,t)}throw $p(e)}(e,t):Kp(e)}function cg(e){return e<=0?function(){return tg}:Mp(function(t,n){var r=0;t.subscribe(new Dp(n,function(t){++r<=e&&(n.next(t),e<=r&&n.complete())}))})}function lg(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return!0===t?(e(),null):!1===t?null:t.apply(void 0,r).pipe(cg(1)).subscribe(function(){return e()})}function hg(e){for(var t in e)if(e[t]===hg)return t;throw Error("Could not find renamed property on target object.")}function fg(e,t){for(var n in t)t.hasOwnProperty(n)&&!e.hasOwnProperty(n)&&(e[n]=t[n])}function dg(e){if("string"==typeof e)return e;if(Array.isArray(e))return"["+e.map(dg).join(", ")+"]";if(null==e)return""+e;if(e.overriddenName)return"".concat(e.overriddenName);if(e.name)return"".concat(e.name);var t=e.toString();if(null==t)return""+t;var n=t.indexOf("\n");return-1===n?t:t.substring(0,n)}function vg(e,t){return null==e||""===e?null===t?"":t:null==t||""===t?e:e+" "+t}var pg=hg({__forward_ref__:hg});function gg(e){return e.__forward_ref__=gg,e.toString=function(){return dg(this())},e}function yg(e){return mg(e)?e():e}function mg(e){return"function"==typeof e&&e.hasOwnProperty(pg)&&e.__forward_ref__===gg}var kg=function(e){Gv(n,e);var t=$v(n);function n(e,r){var i;return tp(this,n),(i=t.call(this,function(e,t){return"".concat(e?"NG0".concat(e,": "):"").concat(t)}(e,r))).code=e,i}return rp(n)}(Vv(Error));function _g(e){return"string"==typeof e?e:null==e?"":String(e)}function wg(e){return"function"==typeof e?e.name||e.toString():"object"==typeof e&&null!=e&&"function"==typeof e.type?e.type.name||e.type.toString():_g(e)}function Cg(e,t){var n=t?" in ".concat(t):"";throw new kg("201","No provider for ".concat(wg(e)," found").concat(n))}function bg(e,t,n,r){throw new Error("ASSERTION ERROR: ".concat(e)+(null==r?"":" [Expected=> ".concat(n," ").concat(r," ").concat(t," <=Actual]")))}function Eg(e){return{token:e.token,providedIn:e.providedIn||null,factory:e.factory,value:void 0}}function Sg(e){return{providers:e.providers||[],imports:e.imports||[]}}function Pg(e){return Og(e,xg)||Og(e,Rg)}function Og(e,t){return e.hasOwnProperty(t)?e[t]:null}function Tg(e){return e&&(e.hasOwnProperty(Ag)||e.hasOwnProperty(Ng))?e[Ag]:null}var Ig,xg=hg({"\u0275prov":hg}),Ag=hg({"\u0275inj":hg}),Rg=hg({ngInjectableDef:hg}),Ng=hg({ngInjectorDef:hg}),Mg=((Mg=Mg||{})[Mg.Default=0]="Default",Mg[Mg.Host=1]="Host",Mg[Mg.Self=2]="Self",Mg[Mg.SkipSelf=4]="SkipSelf",Mg[Mg.Optional=8]="Optional",Mg);function Dg(e){var t=Ig;return Ig=e,t}function Lg(e,t,n){var r=Pg(e);return r&&"root"==r.providedIn?void 0===r.value?r.value=r.factory():r.value:n&Mg.Optional?null:void 0!==t?t:void Cg(dg(e),"Injector")}function Fg(e){return{toString:e}.toString()}var Bg=((Bg=Bg||{})[Bg.OnPush=0]="OnPush",Bg[Bg.Default=1]="Default",Bg),Vg=((Vg=Vg||{})[Vg.Emulated=0]="Emulated",Vg[Vg.None=2]="None",Vg[Vg.ShadowDom=3]="ShadowDom",Vg),Ug="undefined"!=typeof globalThis&&globalThis,zg="undefined"!=typeof window&&window,Hg="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,Gg=Ug||"undefined"!=typeof global&&global||zg||Hg,qg={},$g=[],Wg=hg({"\u0275cmp":hg}),jg=hg({"\u0275dir":hg}),Zg=hg({"\u0275pipe":hg}),Yg=hg({"\u0275mod":hg}),Kg=hg({"\u0275loc":hg}),Jg=hg({"\u0275fac":hg}),Qg=hg({__NG_ELEMENT_ID__:hg}),Xg=0;function ey(e){return Fg(function(){var t={},n={type:e.type,providersResolver:null,decls:e.decls,vars:e.vars,factory:null,template:e.template||null,consts:e.consts||null,ngContentSelectors:e.ngContentSelectors,hostBindings:e.hostBindings||null,hostVars:e.hostVars||0,hostAttrs:e.hostAttrs||null,contentQueries:e.contentQueries||null,declaredInputs:t,inputs:null,outputs:null,exportAs:e.exportAs||null,onPush:e.changeDetection===Bg.OnPush,directiveDefs:null,pipeDefs:null,selectors:e.selectors||$g,viewQuery:e.viewQuery||null,features:e.features||null,data:e.data||{},encapsulation:e.encapsulation||Vg.Emulated,id:"c",styles:e.styles||$g,_:null,setInput:null,schemas:e.schemas||null,tView:null},r=e.directives,i=e.features,a=e.pipes;return n.id+=Xg++,n.inputs=ay(e.inputs,t),n.outputs=ay(e.outputs),i&&i.forEach(function(e){return e(n)}),n.directiveDefs=r?function(){return("function"==typeof r?r():r).map(ty)}:null,n.pipeDefs=a?function(){return("function"==typeof a?a():a).map(ny)}:null,n})}function ty(e){return uy(e)||function(e){return e[jg]||null}(e)}function ny(e){return function(e){return e[Zg]||null}(e)}var ry={};function iy(e){return Fg(function(){var t={type:e.type,bootstrap:e.bootstrap||$g,declarations:e.declarations||$g,imports:e.imports||$g,exports:e.exports||$g,transitiveCompileScopes:null,schemas:e.schemas||null,id:e.id||null};return null!=e.id&&(ry[e.id]=e.type),t})}function ay(e,t){if(null==e)return qg;var n={};for(var r in e)if(e.hasOwnProperty(r)){var i=e[r],a=i;Array.isArray(i)&&(a=i[1],i=i[0]),n[i]=r,t&&(t[i]=a)}return n}var oy=ey;function sy(e){return{type:e.type,name:e.name,factory:null,pure:!1!==e.pure,onDestroy:e.type.prototype.ngOnDestroy||null}}function uy(e){return e[Wg]||null}function cy(e,t){var n=e[Yg]||null;if(!n&&!0===t)throw new Error("Type ".concat(dg(e)," does not have '\u0275mod' property."));return n}function ly(e){return Array.isArray(e)&&"object"==typeof e[1]}function hy(e){return Array.isArray(e)&&!0===e[1]}function fy(e){return 0!=(8&e.flags)}function dy(e){return 2==(2&e.flags)}function vy(e){return 1==(1&e.flags)}function py(e){return null!==e.template}function gy(e){return 0!=(512&e[2])}function yy(e,t){return e.hasOwnProperty(Jg)?e[Jg]:null}var my=function(){function e(t,n,r){tp(this,e),this.previousValue=t,this.currentValue=n,this.firstChange=r}return rp(e,[{key:"isFirstChange",value:function(){return this.firstChange}}]),e}();function ky(){return _y}function _y(e){return e.type.prototype.ngOnChanges&&(e.setInput=Cy),wy}function wy(){var e=Ey(this),t=null==e?void 0:e.current;if(t){var n=e.previous;if(n===qg)e.previous=t;else for(var r in t)n[r]=t[r];e.current=null,this.ngOnChanges(t)}}function Cy(e,t,n,r){var i=Ey(e)||function(e,t){return e[by]=t}(e,{previous:qg,current:null}),a=i.current||(i.current={}),o=i.previous,s=this.declaredInputs[n],u=o[s];a[s]=new my(u&&u.currentValue,t,o===qg),e[r]=t}ky.ngInherit=!0;var by="__ngSimpleChanges__";function Ey(e){return e[by]||null}var Sy,Py="http://www.w3.org/2000/svg";function Oy(){return void 0!==Sy?Sy:"undefined"!=typeof document?document:void 0}function Ty(e){return!!e.listen}var Iy={createRenderer:function(e,t){return Oy()}};function xy(e){for(;Array.isArray(e);)e=e[0];return e}function Ay(e,t){return xy(t[e])}function Ry(e,t){return xy(t[e.index])}function Ny(e,t){return e.data[t]}function My(e,t){return e[t]}function Dy(e,t){var n=t[e];return ly(n)?n:n[0]}function Ly(e){return 4==(4&e[2])}function Fy(e){return 128==(128&e[2])}function By(e,t){return null==t?null:e[t]}function Vy(e){e[18]=0}function Uy(e,t){e[5]+=t;for(var n=e,r=e[3];null!==r&&(1===t&&1===n[5]||-1===t&&0===n[5]);)r[5]+=t,n=r,r=r[3]}var zy={lFrame:dm(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function Hy(){return zy.bindingsEnabled}function Gy(){return zy.lFrame.lView}function qy(){return zy.lFrame.tView}function $y(e){return zy.lFrame.contextLView=e,e[8]}function Wy(){for(var e=jy();null!==e&&64===e.type;)e=e.parent;return e}function jy(){return zy.lFrame.currentTNode}function Zy(){var e=zy.lFrame,t=e.currentTNode;return e.isParent?t:t.parent}function Yy(e,t){var n=zy.lFrame;n.currentTNode=e,n.isParent=t}function Ky(){return zy.lFrame.isParent}function Jy(){zy.lFrame.isParent=!1}function Qy(){return zy.isInCheckNoChangesMode}function Xy(e){zy.isInCheckNoChangesMode=e}function em(){var e=zy.lFrame,t=e.bindingRootIndex;return-1===t&&(t=e.bindingRootIndex=e.tView.bindingStartIndex),t}function tm(){return zy.lFrame.bindingIndex}function nm(){return zy.lFrame.bindingIndex++}function rm(e){var t=zy.lFrame,n=t.bindingIndex;return t.bindingIndex=t.bindingIndex+e,n}function im(e){zy.lFrame.inI18n=e}function am(e,t){var n=zy.lFrame;n.bindingIndex=n.bindingRootIndex=e,om(t)}function om(e){zy.lFrame.currentDirectiveIndex=e}function sm(){return zy.lFrame.currentQueryIndex}function um(e){zy.lFrame.currentQueryIndex=e}function cm(e){var t=e[1];return 2===t.type?t.declTNode:1===t.type?e[6]:null}function lm(e,t,n){if(n&Mg.SkipSelf){for(var r=t,i=e;!(null!==(r=r.parent)||n&Mg.Host||(r=cm(i),null===r||(i=i[15],10&r.type))););if(null===r)return!1;t=r,e=i}var a=zy.lFrame=fm();return a.currentTNode=t,a.lView=e,!0}function hm(e){var t=fm(),n=e[1];zy.lFrame=t,t.currentTNode=n.firstChild,t.lView=e,t.tView=n,t.contextLView=e,t.bindingIndex=n.bindingStartIndex,t.inI18n=!1}function fm(){var e=zy.lFrame,t=null===e?null:e.child;return null===t?dm(e):t}function dm(e){var t={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:e,child:null,inI18n:!1};return null!==e&&(e.child=t),t}function vm(){var e=zy.lFrame;return zy.lFrame=e.parent,e.currentTNode=null,e.lView=null,e}var pm=vm;function gm(){var e=vm();e.isParent=!0,e.tView=null,e.selectedIndex=-1,e.contextLView=null,e.elementDepthCount=0,e.currentDirectiveIndex=-1,e.currentNamespace=null,e.bindingRootIndex=-1,e.bindingIndex=-1,e.currentQueryIndex=0}function ym(){return zy.lFrame.selectedIndex}function mm(e){zy.lFrame.selectedIndex=e}function km(){var e=zy.lFrame;return Ny(e.tView,e.selectedIndex)}function _m(){zy.lFrame.currentNamespace=Py}function wm(e,t){for(var n=t.directiveStart,r=t.directiveEnd;n<r;n++){var i=e.data[n].type.prototype,a=i.ngAfterContentInit,o=i.ngAfterContentChecked,s=i.ngAfterViewInit,u=i.ngAfterViewChecked,c=i.ngOnDestroy;a&&(e.contentHooks||(e.contentHooks=[])).push(-n,a),o&&((e.contentHooks||(e.contentHooks=[])).push(n,o),(e.contentCheckHooks||(e.contentCheckHooks=[])).push(n,o)),s&&(e.viewHooks||(e.viewHooks=[])).push(-n,s),u&&((e.viewHooks||(e.viewHooks=[])).push(n,u),(e.viewCheckHooks||(e.viewCheckHooks=[])).push(n,u)),null!=c&&(e.destroyHooks||(e.destroyHooks=[])).push(n,c)}}function Cm(e,t,n){Sm(e,t,3,n)}function bm(e,t,n,r){(3&e[2])===n&&Sm(e,t,n,r)}function Em(e,t){var n=e[2];(3&n)===t&&(n&=2047,n+=1,e[2]=n)}function Sm(e,t,n,r){for(var i=null!=r?r:-1,a=t.length-1,o=0,s=void 0!==r?65535&e[18]:0;s<a;s++)if("number"==typeof t[s+1]){if(o=t[s],null!=r&&o>=r)break}else t[s]<0&&(e[18]+=65536),(o<i||-1==i)&&(Pm(e,n,t,s),e[18]=(4294901760&e[18])+s+2),s++}function Pm(e,t,n,r){var i=n[r]<0,a=n[r+1],o=e[i?-n[r]:n[r]];if(i){if(e[2]>>11<e[18]>>16&&(3&e[2])===t){e[2]+=2048;try{a.call(o)}finally{}}}else try{a.call(o)}finally{}}var Om=rp(function e(t,n,r){tp(this,e),this.factory=t,this.resolving=!1,this.canSeeViewProviders=n,this.injectImpl=r});function Tm(e,t,n){for(var r=Ty(e),i=0;i<n.length;){var a=n[i];if("number"==typeof a){if(0!==a)break;i++;var o=n[i++],s=n[i++],u=n[i++];r?e.setAttribute(t,s,u,o):t.setAttributeNS(o,s,u)}else{var c=a,l=n[++i];xm(c)?r&&e.setProperty(t,c,l):r?e.setAttribute(t,c,l):t.setAttribute(c,l),i++}}return i}function Im(e){return 3===e||4===e||6===e}function xm(e){return 64===e.charCodeAt(0)}function Am(e,t){if(null!==t&&0!==t.length)if(null===e||0===e.length)e=t.slice();else for(var n=-1,r=0;r<t.length;r++){var i=t[r];"number"==typeof i?n=i:0===n||Rm(e,n,i,null,-1===n||2===n?t[++r]:null)}return e}function Rm(e,t,n,r,i){var a=0,o=e.length;if(-1===t)o=-1;else for(;a<e.length;){var s=e[a++];if("number"==typeof s){if(s===t){o=-1;break}if(s>t){o=a-1;break}}}for(;a<e.length;){var u=e[a];if("number"==typeof u)break;if(u===n){if(null===r)return void(null!==i&&(e[a+1]=i));if(r===e[a+1])return void(e[a+2]=i)}a++,null!==r&&a++,null!==i&&a++}-1!==o&&(e.splice(o,0,t),a=o+1),e.splice(a++,0,n),null!==r&&e.splice(a++,0,r),null!==i&&e.splice(a++,0,i)}function Nm(e){return-1!==e}function Mm(e){return 32767&e}function Dm(e,t){for(var n=function(e){return e>>16}(e),r=t;n>0;)r=r[15],n--;return r}var Lm=!0;function Fm(e){var t=Lm;return Lm=e,t}var Bm=0;function Vm(e,t){var n=zm(e,t);if(-1!==n)return n;var r=t[1];r.firstCreatePass&&(e.injectorIndex=t.length,Um(r.data,e),Um(t,null),Um(r.blueprint,null));var i=Hm(e,t),a=e.injectorIndex;if(Nm(i))for(var o=Mm(i),s=Dm(i,t),u=s[1].data,c=0;c<8;c++)t[a+c]=s[o+c]|u[o+c];return t[a+8]=i,a}function Um(e,t){e.push(0,0,0,0,0,0,0,0,t)}function zm(e,t){return-1===e.injectorIndex||e.parent&&e.parent.injectorIndex===e.injectorIndex||null===t[e.injectorIndex+8]?-1:e.injectorIndex}function Hm(e,t){if(e.parent&&-1!==e.parent.injectorIndex)return e.parent.injectorIndex;for(var n=0,r=null,i=t;null!==i;){var a=i[1],o=a.type;if(null===(r=2===o?a.declTNode:1===o?i[6]:null))return-1;if(n++,i=i[15],-1!==r.injectorIndex)return r.injectorIndex|n<<16}return-1}function Gm(e,t,n){!function(e,t,n){var r;"string"==typeof n?r=n.charCodeAt(0)||0:n.hasOwnProperty(Qg)&&(r=n[Qg]),null==r&&(r=n[Qg]=Bm++);var i=255&r;t.data[e+(i>>5)]|=1<<i}(e,t,n)}function qm(e,t,n){if(n&Mg.Optional)return e;Cg(t,"NodeInjector")}function $m(e,t,n,r){if(n&Mg.Optional&&void 0===r&&(r=null),0==(n&(Mg.Self|Mg.Host))){var i=e[9],a=Dg(void 0);try{return i?i.get(t,r,n&Mg.Optional):Lg(t,r,n&Mg.Optional)}finally{Dg(a)}}return qm(r,t,n)}function Wm(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Mg.Default,i=arguments.length>4?arguments[4]:void 0;if(null!==e){var a=function(e){if("string"==typeof e)return e.charCodeAt(0)||0;var t=e.hasOwnProperty(Qg)?e[Qg]:void 0;return"number"==typeof t?t>=0?255&t:Zm:t}(n);if("function"==typeof a){if(!lm(t,e,r))return r&Mg.Host?qm(i,n,r):$m(t,n,r,i);try{var o=a(r);if(null!=o||r&Mg.Optional)return o;Cg(n)}finally{pm()}}else if("number"==typeof a){var s=null,u=zm(e,t),c=-1,l=r&Mg.Host?t[16][6]:null;for((-1===u||r&Mg.SkipSelf)&&(-1!==(c=-1===u?Hm(e,t):t[u+8])&&Xm(r,!1)?(s=t[1],u=Mm(c),t=Dm(c,t)):u=-1);-1!==u;){var h=t[1];if(Qm(a,u,h.data)){var f=Ym(u,t,n,s,r,l);if(f!==jm)return f}-1!==(c=t[u+8])&&Xm(r,t[1].data[u+8]===l)&&Qm(a,u,t)?(s=h,u=Mm(c),t=Dm(c,t)):u=-1}}}return $m(t,n,r,i)}var jm={};function Zm(){return new ek(Wy(),Gy())}function Ym(e,t,n,r,i,a){var o=t[1],s=o.data[e+8],u=Km(s,o,n,null==r?dy(s)&&Lm:r!=o&&0!=(3&s.type),i&Mg.Host&&a===s);return null!==u?Jm(t,o,u,s):jm}function Km(e,t,n,r,i){for(var a=e.providerIndexes,o=t.data,s=1048575&a,u=e.directiveStart,c=a>>20,l=i?s+c:e.directiveEnd,h=r?s:s+c;h<l;h++){var f=o[h];if(h<u&&n===f||h>=u&&f.type===n)return h}if(i){var d=o[u];if(d&&py(d)&&d.type===n)return u}return null}function Jm(e,t,n,r){var i=e[n],a=t.data;if(function(e){return e instanceof Om}(i)){var o=i;o.resolving&&function(e,t){throw new kg("200","Circular dependency in DI detected for ".concat(e))}(wg(a[n]));var s=Fm(o.canSeeViewProviders);o.resolving=!0;var u=o.injectImpl?Dg(o.injectImpl):null;lm(e,r,Mg.Default);try{i=e[n]=o.factory(void 0,a,e,r),t.firstCreatePass&&n>=r.directiveStart&&function(e,t,n){var r=t.type.prototype,i=r.ngOnChanges,a=r.ngOnInit,o=r.ngDoCheck;if(i){var s=_y(t);(n.preOrderHooks||(n.preOrderHooks=[])).push(e,s),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(e,s)}a&&(n.preOrderHooks||(n.preOrderHooks=[])).push(0-e,a),o&&((n.preOrderHooks||(n.preOrderHooks=[])).push(e,o),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(e,o))}(n,a[n],t)}finally{null!==u&&Dg(u),Fm(s),o.resolving=!1,pm()}}return i}function Qm(e,t,n){return!!(n[t+(e>>5)]&1<<e)}function Xm(e,t){return!(e&Mg.Self||e&Mg.Host&&t)}var ek=function(){function e(t,n){tp(this,e),this._tNode=t,this._lView=n}return rp(e,[{key:"get",value:function(e,t,n){return Wm(this._tNode,this._lView,e,n,t)}}]),e}();function tk(e){return Fg(function(){for(var t=e.prototype.constructor,n=t[Jg]||nk(t),r=Object.prototype,i=Object.getPrototypeOf(e.prototype).constructor;i&&i!==r;){var a=i[Jg]||nk(i);if(a&&a!==n)return a;i=Object.getPrototypeOf(i)}return function(e){return new e}})}function nk(e){return mg(e)?function(){var t=nk(yg(e));return t&&t()}:yy(e)}function rk(e){return function(e,t){if("class"===t)return e.classes;if("style"===t)return e.styles;var n=e.attrs;if(n)for(var r=n.length,i=0;i<r;){var a=n[i];if(Im(a))break;if(0===a)i+=2;else if("number"==typeof a)for(i++;i<r&&"string"==typeof n[i];)i++;else{if(a===t)return n[i+1];i+=2}}return null}(Wy(),e)}var ik="__parameters__";function ak(e,t,n){return Fg(function(){var r=function(e){return function(){if(e){var t=e.apply(void 0,arguments);for(var n in t)this[n]=t[n]}}}(t);function i(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(this instanceof i)return r.apply(this,t),this;var a=Uv(i,t);return o.annotation=a,o;function o(e,t,n){for(var r=e.hasOwnProperty(ik)?e[ik]:Object.defineProperty(e,ik,{value:[]})[ik];r.length<=n;)r.push(null);return(r[n]=r[n]||[]).push(a),e}}return n&&(i.prototype=Object.create(n.prototype)),i.prototype.ngMetadataName=e,i.annotationCls=i,i})}var ok=function(){function e(t,n){tp(this,e),this._desc=t,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof n?this.__NG_ELEMENT_ID__=n:void 0!==n&&(this.\u0275prov=Eg({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}return rp(e,[{key:"toString",value:function(){return"InjectionToken ".concat(this._desc)}}]),e}(),sk=new ok("AnalyzeForEntryComponents"),uk=Function;function ck(e,t){void 0===t&&(t=e);for(var n=0;n<e.length;n++){var r=e[n];Array.isArray(r)?(t===e&&(t=e.slice(0,n)),ck(r,t)):t!==e&&t.push(r)}return t}function lk(e,t){e.forEach(function(e){return Array.isArray(e)?lk(e,t):t(e)})}function hk(e,t,n){t>=e.length?e.push(n):e.splice(t,0,n)}function fk(e,t){return t>=e.length-1?e.pop():e.splice(t,1)[0]}function dk(e,t){for(var n=[],r=0;r<e;r++)n.push(t);return n}function vk(e,t,n){var r=gk(e,t);return r>=0?e[1|r]=n:function(e,t,n,r){var i=e.length;if(i==t)e.push(n,r);else if(1===i)e.push(r,e[0]),e[0]=n;else{for(i--,e.push(e[i-1],e[i]);i>t;)e[i]=e[i-2],i--;e[t]=n,e[t+1]=r}}(e,r=~r,t,n),r}function pk(e,t){var n=gk(e,t);if(n>=0)return e[1|n]}function gk(e,t){return function(e,t,n){for(var r=0,i=e.length>>1;i!==r;){var a=r+(i-r>>1),o=e[a<<1];if(t===o)return a<<1;o>t?i=a:r=a+1}return~(i<<1)}(e,t)}var yk,mk={},kk="__NG_DI_FLAG__",_k="ngTempTokenPath",wk=/\n/gm,Ck="__source",bk=hg({provide:String,useValue:hg});function Ek(e){var t=yk;return yk=e,t}function Sk(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Mg.Default;if(void 0===yk)throw new Error("inject() must be called from an injection context");return null===yk?Lg(e,void 0,t):yk.get(e,t&Mg.Optional?null:void 0,t)}function Pk(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Mg.Default;return(Ig||Sk)(yg(e),t)}function Ok(e){for(var t=[],n=0;n<e.length;n++){var r=yg(e[n]);if(Array.isArray(r)){if(0===r.length)throw new Error("Arguments array must have arguments.");for(var i=void 0,a=Mg.Default,o=0;o<r.length;o++){var s=r[o],u=Ik(s);"number"==typeof u?-1===u?i=s.token:a|=u:i=s}t.push(Pk(i,a))}else t.push(Pk(r))}return t}function Tk(e,t){return e[kk]=t,e.prototype[kk]=t,e}function Ik(e){return e[kk]}function xk(e,t,n,r){var i=e[_k];throw t[Ck]&&i.unshift(t[Ck]),e.message=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;e=e&&"\n"===e.charAt(0)&&"\u0275"==e.charAt(1)?e.substr(2):e;var i=dg(t);if(Array.isArray(t))i=t.map(dg).join(" -> ");else if("object"==typeof t){var a=[];for(var o in t)if(t.hasOwnProperty(o)){var s=t[o];a.push(o+":"+("string"==typeof s?JSON.stringify(s):dg(s)))}i="{".concat(a.join(", "),"}")}return"".concat(n).concat(r?"("+r+")":"","[").concat(i,"]: ").concat(e.replace(wk,"\n  "))}("\n"+e.message,i,n,r),e.ngTokenPath=i,e[_k]=null,e}var Ak,Rk,Nk=Tk(ak("Inject",function(e){return{token:e}}),-1),Mk=Tk(ak("Optional"),8),Dk=Tk(ak("SkipSelf"),4);function Lk(e){var t;return(null===(t=function(){if(void 0===Ak&&(Ak=null,Gg.trustedTypes))try{Ak=Gg.trustedTypes.createPolicy("angular",{createHTML:function(e){return e},createScript:function(e){return e},createScriptURL:function(e){return e}})}catch(e){}return Ak}())||void 0===t?void 0:t.createHTML(e))||e}function Fk(e){var t;return(null===(t=function(){if(void 0===Rk&&(Rk=null,Gg.trustedTypes))try{Rk=Gg.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:function(e){return e},createScript:function(e){return e},createScriptURL:function(e){return e}})}catch(e){}return Rk}())||void 0===t?void 0:t.createHTML(e))||e}var Bk=function(){function e(t){tp(this,e),this.changingThisBreaksApplicationSecurity=t}return rp(e,[{key:"toString",value:function(){return"SafeValue must use [property]=binding: ".concat(this.changingThisBreaksApplicationSecurity," (see https://g.co/ng/security#xss)")}}]),e}(),Vk=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"getTypeName",value:function(){return"HTML"}}]),n}(Bk),Uk=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"getTypeName",value:function(){return"Style"}}]),n}(Bk),zk=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"getTypeName",value:function(){return"Script"}}]),n}(Bk),Hk=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"getTypeName",value:function(){return"URL"}}]),n}(Bk),Gk=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"getTypeName",value:function(){return"ResourceURL"}}]),n}(Bk);function qk(e){return e instanceof Bk?e.changingThisBreaksApplicationSecurity:e}function $k(e,t){var n=Wk(e);if(null!=n&&n!==t){if("ResourceURL"===n&&"URL"===t)return!0;throw new Error("Required a safe ".concat(t,", got a ").concat(n," (see https://g.co/ng/security#xss)"))}return n===t}function Wk(e){return e instanceof Bk&&e.getTypeName()||null}function jk(e){var t=new Yk(e);return function(){try{return!!(new window.DOMParser).parseFromString(Lk(""),"text/html")}catch(e){return!1}}()?new Zk(t):t}var Zk=function(){function e(t){tp(this,e),this.inertDocumentHelper=t}return rp(e,[{key:"getInertBodyElement",value:function(e){e="<body><remove></remove>"+e;try{var t=(new window.DOMParser).parseFromString(Lk(e),"text/html").body;return null===t?this.inertDocumentHelper.getInertBodyElement(e):(t.removeChild(t.firstChild),t)}catch(n){return null}}}]),e}(),Yk=function(){function e(t){if(tp(this,e),this.defaultDoc=t,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),null==this.inertDocument.body){var n=this.inertDocument.createElement("html");this.inertDocument.appendChild(n);var r=this.inertDocument.createElement("body");n.appendChild(r)}}return rp(e,[{key:"getInertBodyElement",value:function(e){var t=this.inertDocument.createElement("template");if("content"in t)return t.innerHTML=Lk(e),t;var n=this.inertDocument.createElement("body");return n.innerHTML=Lk(e),this.defaultDoc.documentMode&&this.stripCustomNsAttrs(n),n}},{key:"stripCustomNsAttrs",value:function(e){for(var t=e.attributes,n=t.length-1;0<n;n--){var r=t.item(n).name;("xmlns:ns1"===r||0===r.indexOf("ns1:"))&&e.removeAttribute(r)}for(var i=e.firstChild;i;)i.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(i),i=i.nextSibling}}]),e}(),Kk=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,Jk=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;function Qk(e){return(e=String(e)).match(Kk)||e.match(Jk)?e:"unsafe:"+e}function Xk(e){return(e=String(e)).split(",").map(function(e){return Qk(e.trim())}).join(", ")}function e_(e){var t,n={},r=Qv(e.split(","));try{for(r.s();!(t=r.n()).done;){n[t.value]=!0}}catch(i){r.e(i)}finally{r.f()}return n}function t_(){for(var e={},t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0,a=n;i<a.length;i++){var o=a[i];for(var s in o)o.hasOwnProperty(s)&&(e[s]=!0)}return e}var n_,r_=e_("area,br,col,hr,img,wbr"),i_=e_("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),a_=e_("rp,rt"),o_=t_(r_,t_(i_,e_("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),t_(a_,e_("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),t_(a_,i_)),s_=e_("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),u_=e_("srcset"),c_=t_(s_,u_,e_("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),e_("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),l_=e_("script,style,template"),h_=function(){function e(){tp(this,e),this.sanitizedSomething=!1,this.buf=[]}return rp(e,[{key:"sanitizeChildren",value:function(e){for(var t=e.firstChild,n=!0;t;)if(t.nodeType===Node.ELEMENT_NODE?n=this.startElement(t):t.nodeType===Node.TEXT_NODE?this.chars(t.nodeValue):this.sanitizedSomething=!0,n&&t.firstChild)t=t.firstChild;else for(;t;){t.nodeType===Node.ELEMENT_NODE&&this.endElement(t);var r=this.checkClobberedElement(t,t.nextSibling);if(r){t=r;break}t=this.checkClobberedElement(t,t.parentNode)}return this.buf.join("")}},{key:"startElement",value:function(e){var t=e.nodeName.toLowerCase();if(!o_.hasOwnProperty(t))return this.sanitizedSomething=!0,!l_.hasOwnProperty(t);this.buf.push("<"),this.buf.push(t);for(var n=e.attributes,r=0;r<n.length;r++){var i=n.item(r),a=i.name,o=a.toLowerCase();if(c_.hasOwnProperty(o)){var s=i.value;s_[o]&&(s=Qk(s)),u_[o]&&(s=Xk(s)),this.buf.push(" ",a,'="',v_(s),'"')}else this.sanitizedSomething=!0}return this.buf.push(">"),!0}},{key:"endElement",value:function(e){var t=e.nodeName.toLowerCase();o_.hasOwnProperty(t)&&!r_.hasOwnProperty(t)&&(this.buf.push("</"),this.buf.push(t),this.buf.push(">"))}},{key:"chars",value:function(e){this.buf.push(v_(e))}},{key:"checkClobberedElement",value:function(e,t){if(t&&(e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error("Failed to sanitize html because the element is clobbered: ".concat(e.outerHTML));return t}}]),e}(),f_=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,d_=/([^\#-~ |!])/g;function v_(e){return e.replace(/&/g,"&amp;").replace(f_,function(e){return"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";"}).replace(d_,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function p_(e,t){var n=null;try{n_=n_||jk(e);var r=t?String(t):"";n=n_.getInertBodyElement(r);var i=5,a=r;do{if(0===i)throw new Error("Failed to sanitize html because the input is unstable");i--,r=a,a=n.innerHTML,n=n_.getInertBodyElement(r)}while(r!==a);return Lk((new h_).sanitizeChildren(g_(n)||n))}finally{if(n)for(var o=g_(n)||n;o.firstChild;)o.removeChild(o.firstChild)}}function g_(e){return"content"in e&&function(e){return e.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===e.nodeName}(e)?e.content:null}var y_=((y_=y_||{})[y_.NONE=0]="NONE",y_[y_.HTML=1]="HTML",y_[y_.STYLE=2]="STYLE",y_[y_.SCRIPT=3]="SCRIPT",y_[y_.URL=4]="URL",y_[y_.RESOURCE_URL=5]="RESOURCE_URL",y_);function m_(e){var t=__();return t?Fk(t.sanitize(y_.HTML,e)||""):$k(e,"HTML")?Fk(qk(e)):p_(Oy(),_g(e))}function k_(e){var t=__();return t?t.sanitize(y_.URL,e)||"":$k(e,"URL")?qk(e):Qk(_g(e))}function __(){var e=Gy();return e&&e[12]}var w_="__ngContext__";function C_(e,t){e[w_]=t}function b_(e){var t=function(e){return e[w_]||null}(e);return t?Array.isArray(t)?t:t.lView:null}function E_(e){return e.ngOriginalError}function S_(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];e.error.apply(e,n)}var P_=function(){function e(){tp(this,e),this._console=console}return rp(e,[{key:"handleError",value:function(e){var t,n=this._findOriginalError(e),r=this._findContext(e),i=(t=e)&&t.ngErrorLogger||S_;i(this._console,"ERROR",e),n&&i(this._console,"ORIGINAL ERROR",n),r&&i(this._console,"ERROR CONTEXT",r)}},{key:"_findContext",value:function(e){return e?function(e){return e.ngDebugContext}(e)||this._findContext(E_(e)):null}},{key:"_findOriginalError",value:function(e){for(var t=e&&E_(e);t&&E_(t);)t=E_(t);return t||null}}]),e}(),O_=/^>|^->|<!--|-->|--!>|<!-$/g,T_=/(<|>)/,I_=("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(Gg);function x_(e){return e instanceof Function?e():e}var A_,R_=((R_=R_||{})[R_.Important=1]="Important",R_[R_.DashCase=2]="DashCase",R_);function N_(e,t){return A_(e,t)}function M_(e){var t=e[3];return hy(t)?t[3]:t}function D_(e){return F_(e[13])}function L_(e){return F_(e[4])}function F_(e){for(;null!==e&&!hy(e);)e=e[4];return e}function B_(e,t,n,r,i){if(null!=r){var a,o=!1;hy(r)?a=r:ly(r)&&(o=!0,r=r[0]);var s=xy(r);0===e&&null!==n?null==i?K_(t,n,s):Y_(t,n,s,i||null,!0):1===e&&null!==n?Y_(t,n,s,i||null,!0):2===e?uw(t,s,o):3===e&&t.destroyNode(s),null!=a&&function(e,t,n,r,i){var a=n[7];a!==xy(n)&&B_(t,e,r,a,i);for(var o=10;o<n.length;o++){var s=n[o];lw(s[1],s,e,t,r,a)}}(t,e,a,n,i)}}function V_(e,t){return Ty(e)?e.createText(t):e.createTextNode(t)}function U_(e,t,n){Ty(e)?e.setValue(t,n):t.textContent=n}function z_(e,t){return e.createComment(function(e){return e.replace(O_,function(e){return e.replace(T_,"\u200b$1\u200b")})}(t))}function H_(e,t,n){return Ty(e)?e.createElement(t,n):null===n?e.createElement(t):e.createElementNS(n,t)}function G_(e,t){var n=e[9],r=n.indexOf(t),i=t[3];1024&t[2]&&(t[2]&=-1025,Uy(i,-1)),n.splice(r,1)}function q_(e,t){if(!(e.length<=10)){var n=10+t,r=e[n];if(r){var i=r[17];null!==i&&i!==e&&G_(i,r),t>0&&(e[n-1][4]=r[4]);var a=fk(e,10+t);!function(e,t){lw(e,t,t[11],2,null,null),t[0]=null,t[6]=null}(r[1],r);var o=a[19];null!==o&&o.detachView(a[1]),r[3]=null,r[4]=null,r[2]&=-129}return r}}function $_(e,t){if(!(256&t[2])){var n=t[11];Ty(n)&&n.destroyNode&&lw(e,t,n,3,null,null),function(e){var t=e[13];if(!t)return W_(e[1],e);for(;t;){var n=null;if(ly(t))n=t[13];else{var r=t[10];r&&(n=r)}if(!n){for(;t&&!t[4]&&t!==e;)ly(t)&&W_(t[1],t),t=t[3];null===t&&(t=e),ly(t)&&W_(t[1],t),n=t&&t[4]}t=n}}(t)}}function W_(e,t){if(!(256&t[2])){t[2]&=-129,t[2]|=256,function(e,t){var n;if(null!=e&&null!=(n=e.destroyHooks))for(var r=0;r<n.length;r+=2){var i=t[n[r]];if(!(i instanceof Om)){var a=n[r+1];if(Array.isArray(a))for(var o=0;o<a.length;o+=2){var s=i[a[o]],u=a[o+1];try{u.call(s)}finally{}}else try{a.call(i)}finally{}}}}(e,t),function(e,t){var n=e.cleanup,r=t[7],i=-1;if(null!==n)for(var a=0;a<n.length-1;a+=2)if("string"==typeof n[a]){var o=n[a+1],s="function"==typeof o?o(t):xy(t[o]),u=r[i=n[a+2]],c=n[a+3];"boolean"==typeof c?s.removeEventListener(n[a],u,c):c>=0?r[i=c]():r[i=-c].unsubscribe(),a+=2}else{var l=r[i=n[a+1]];n[a].call(l)}if(null!==r){for(var h=i+1;h<r.length;h++)r[h]();t[7]=null}}(e,t),1===t[1].type&&Ty(t[11])&&t[11].destroy();var n=t[17];if(null!==n&&hy(t[3])){n!==t[3]&&G_(n,t);var r=t[19];null!==r&&r.detachView(e)}}}function j_(e,t,n){return Z_(e,t.parent,n)}function Z_(e,t,n){for(var r=t;null!==r&&40&r.type;)r=(t=r).parent;if(null===r)return n[0];if(2&r.flags){var i=e.data[r.directiveStart].encapsulation;if(i===Vg.None||i===Vg.Emulated)return null}return Ry(r,n)}function Y_(e,t,n,r,i){Ty(e)?e.insertBefore(t,n,r,i):t.insertBefore(n,r,i)}function K_(e,t,n){Ty(e)?e.appendChild(t,n):t.appendChild(n)}function J_(e,t,n,r,i){null!==r?Y_(e,t,n,r,i):K_(e,t,n)}function Q_(e,t){return Ty(e)?e.parentNode(t):t.parentNode}function X_(e,t,n){return nw(e,t,n)}function ew(e,t,n){return 40&e.type?Ry(e,n):null}var tw,nw=ew;function rw(e,t){nw=e,tw=t}function iw(e,t,n,r){var i=j_(e,r,t),a=t[11],o=X_(r.parent||t[6],r,t);if(null!=i)if(Array.isArray(n))for(var s=0;s<n.length;s++)J_(a,i,n[s],o,!1);else J_(a,i,n,o,!1);void 0!==tw&&tw(a,r,t,n,i)}function aw(e,t){if(null!==t){var n=t.type;if(3&n)return Ry(t,e);if(4&n)return sw(-1,e[t.index]);if(8&n){var r=t.child;if(null!==r)return aw(e,r);var i=e[t.index];return hy(i)?sw(-1,i):xy(i)}if(32&n)return N_(t,e)()||xy(e[t.index]);var a=ow(e,t);return null!==a?Array.isArray(a)?a[0]:aw(M_(e[16]),a):aw(e,t.next)}return null}function ow(e,t){return null!==t?e[16][6].projection[t.projection]:null}function sw(e,t){var n=10+e+1;if(n<t.length){var r=t[n],i=r[1].firstChild;if(null!==i)return aw(r,i)}return t[7]}function uw(e,t,n){var r=Q_(e,t);r&&function(e,t,n,r){Ty(e)?e.removeChild(t,n,r):t.removeChild(n)}(e,r,t,n)}function cw(e,t,n,r,i,a,o){for(;null!=n;){var s=r[n.index],u=n.type;if(o&&0===t&&(s&&C_(xy(s),r),n.flags|=4),64!=(64&n.flags))if(8&u)cw(e,t,n.child,r,i,a,!1),B_(t,e,i,s,a);else if(32&u){for(var c=N_(n,r),l=void 0;l=c();)B_(t,e,i,l,a);B_(t,e,i,s,a)}else 16&u?hw(e,t,r,n,i,a):B_(t,e,i,s,a);n=o?n.projectionNext:n.next}}function lw(e,t,n,r,i,a){cw(n,r,e.firstChild,t,i,a,!1)}function hw(e,t,n,r,i,a){var o=n[16],s=o[6].projection[r.projection];if(Array.isArray(s))for(var u=0;u<s.length;u++)B_(t,e,i,s[u],a);else cw(e,t,s,o[3],i,a,!0)}function fw(e,t,n){Ty(e)?e.setAttribute(t,"style",n):t.style.cssText=n}function dw(e,t,n){Ty(e)?""===n?e.removeAttribute(t,"class"):e.setAttribute(t,"class",n):t.className=n}function vw(e,t,n){for(var r=e.length;;){var i=e.indexOf(t,n);if(-1===i)return i;if(0===i||e.charCodeAt(i-1)<=32){var a=t.length;if(i+a===r||e.charCodeAt(i+a)<=32)return i}n=i+1}}var pw="ng-template";function gw(e,t,n){for(var r=0;r<e.length;){var i=e[r++];if(n&&"class"===i){if(-1!==vw((i=e[r]).toLowerCase(),t,0))return!0}else if(1===i){for(;r<e.length&&"string"==typeof(i=e[r++]);)if(i.toLowerCase()===t)return!0;return!1}}return!1}function yw(e){return 4===e.type&&e.value!==pw}function mw(e,t,n){return t===(4!==e.type||n?e.value:pw)}function kw(e,t,n){for(var r=4,i=e.attrs||[],a=function(e){for(var t=0;t<e.length;t++)if(Im(e[t]))return t;return e.length}(i),o=!1,s=0;s<t.length;s++){var u=t[s];if("number"!=typeof u){if(!o)if(4&r){if(r=2|1&r,""!==u&&!mw(e,u,n)||""===u&&1===t.length){if(_w(r))return!1;o=!0}}else{var c=8&r?u:t[++s];if(8&r&&null!==e.attrs){if(!gw(e.attrs,c,n)){if(_w(r))return!1;o=!0}continue}var l=ww(8&r?"class":u,i,yw(e),n);if(-1===l){if(_w(r))return!1;o=!0;continue}if(""!==c){var h;h=l>a?"":i[l+1].toLowerCase();var f=8&r?h:null;if(f&&-1!==vw(f,c,0)||2&r&&c!==h){if(_w(r))return!1;o=!0}}}}else{if(!o&&!_w(r)&&!_w(u))return!1;if(o&&_w(u))continue;o=!1,r=u|1&r}}return _w(r)||o}function _w(e){return 0==(1&e)}function ww(e,t,n,r){if(null===t)return-1;var i=0;if(r||!n){for(var a=!1;i<t.length;){var o=t[i];if(o===e)return i;if(3===o||6===o)a=!0;else{if(1===o||2===o){for(var s=t[++i];"string"==typeof s;)s=t[++i];continue}if(4===o)break;if(0===o){i+=4;continue}}i+=a?1:2}return-1}return function(e,t){var n=e.indexOf(4);if(n>-1)for(n++;n<e.length;){var r=e[n];if("number"==typeof r)return-1;if(r===t)return n;n++}return-1}(t,e)}function Cw(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=0;r<t.length;r++)if(kw(e,t[r],n))return!0;return!1}function bw(e,t){return e?":not("+t.trim()+")":t}function Ew(e){for(var t=e[0],n=1,r=2,i="",a=!1;n<e.length;){var o=e[n];if("string"==typeof o)if(2&r){var s=e[++n];i+="["+o+(s.length>0?'="'+s+'"':"")+"]"}else 8&r?i+="."+o:4&r&&(i+=" "+o);else""!==i&&!_w(o)&&(t+=bw(a,i),i=""),r=o,a=a||!_w(r);n++}return""!==i&&(t+=bw(a,i)),t}var Sw={};function Pw(e){Ow(qy(),Gy(),ym()+e,Qy())}function Ow(e,t,n,r){if(!r)if(3==(3&t[2])){var i=e.preOrderCheckHooks;null!==i&&Cm(t,i,n)}else{var a=e.preOrderHooks;null!==a&&bm(t,a,0,n)}mm(n)}function Tw(e,t){return e<<17|t<<2}function Iw(e){return e>>17&32767}function xw(e){return 2|e}function Aw(e){return(131068&e)>>2}function Rw(e,t){return-131069&e|t<<2}function Nw(e){return 1|e}function Mw(e,t){var n=e.contentQueries;if(null!==n)for(var r=0;r<n.length;r+=2){var i=n[r],a=n[r+1];if(-1!==a){var o=e.data[a];um(i),o.contentQueries(2,t[a],a)}}}function Dw(e,t,n,r,i,a,o,s,u,c){var l=t.blueprint.slice();return l[0]=i,l[2]=140|r,Vy(l),l[3]=l[15]=e,l[8]=n,l[10]=o||e&&e[10],l[11]=s||e&&e[11],l[12]=u||e&&e[12]||null,l[9]=c||e&&e[9]||null,l[6]=a,l[16]=2==t.type?e[16]:l,l}function Lw(e,t,n,r,i){var a=e.data[t];if(null===a)a=Fw(e,t,n,r,i),zy.lFrame.inI18n&&(a.flags|=64);else if(64&a.type){a.type=n,a.value=r,a.attrs=i;var o=Zy();a.injectorIndex=null===o?-1:o.injectorIndex}return Yy(a,!0),a}function Fw(e,t,n,r,i){var a=jy(),o=Ky(),s=e.data[t]=function(e,t,n,r,i,a){return{type:n,index:r,insertBeforeIndex:null,injectorIndex:t?t.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:i,attrs:a,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:t,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?a:a&&a.parent,n,t,r,i);return null===e.firstChild&&(e.firstChild=s),null!==a&&(o?null==a.child&&null!==s.parent&&(a.child=s):null===a.next&&(a.next=s)),s}function Bw(e,t,n,r){if(0===n)return-1;for(var i=t.length,a=0;a<n;a++)t.push(r),e.blueprint.push(r),e.data.push(null);return i}function Vw(e,t,n){hm(t);try{var r=e.viewQuery;null!==r&&gC(1,r,n);var i=e.template;null!==i&&Hw(e,t,i,1,n),e.firstCreatePass&&(e.firstCreatePass=!1),e.staticContentQueries&&Mw(e,t),e.staticViewQueries&&gC(2,e.viewQuery,n);var a=e.components;null!==a&&function(e,t){for(var n=0;n<t.length;n++)hC(e,t[n])}(t,a)}catch(r){throw e.firstCreatePass&&(e.incompleteFirstPass=!0,e.firstCreatePass=!1),r}finally{t[2]&=-5,gm()}}function Uw(e,t,n,r){var i=t[2];if(256!=(256&i)){hm(t);var a=Qy();try{Vy(t),function(e){zy.lFrame.bindingIndex=e}(e.bindingStartIndex),null!==n&&Hw(e,t,n,2,r);var o=3==(3&i);if(!a)if(o){var s=e.preOrderCheckHooks;null!==s&&Cm(t,s,null)}else{var u=e.preOrderHooks;null!==u&&bm(t,u,0,null),Em(t,0)}if(function(e){for(var t=D_(e);null!==t;t=L_(t))if(t[2])for(var n=t[9],r=0;r<n.length;r++){var i=n[r],a=i[3];0==(1024&i[2])&&Uy(a,1),i[2]|=1024}}(t),function(e){for(var t=D_(e);null!==t;t=L_(t))for(var n=10;n<t.length;n++){var r=t[n],i=r[1];Fy(r)&&Uw(i,r,i.template,r[8])}}(t),null!==e.contentQueries&&Mw(e,t),!a)if(o){var c=e.contentCheckHooks;null!==c&&Cm(t,c)}else{var l=e.contentHooks;null!==l&&bm(t,l,1),Em(t,1)}!function(e,t){var n=e.hostBindingOpCodes;if(null!==n)try{for(var r=0;r<n.length;r++){var i=n[r];if(i<0)mm(~i);else{var a=i,o=n[++r],s=n[++r];am(o,a),s(2,t[a])}}}finally{mm(-1)}}(e,t);var h=e.components;null!==h&&function(e,t){for(var n=0;n<t.length;n++)cC(e,t[n])}(t,h);var f=e.viewQuery;if(null!==f&&gC(2,f,r),!a)if(o){var d=e.viewCheckHooks;null!==d&&Cm(t,d)}else{var v=e.viewHooks;null!==v&&bm(t,v,2),Em(t,2)}!0===e.firstUpdatePass&&(e.firstUpdatePass=!1),a||(t[2]&=-73),1024&t[2]&&(t[2]&=-1025,Uy(t[3],-1))}finally{gm()}}}function zw(e,t,n,r){var i=t[10],a=!Qy(),o=Ly(t);try{a&&!o&&i.begin&&i.begin(),o&&Vw(e,t,r),Uw(e,t,n,r)}finally{a&&!o&&i.end&&i.end()}}function Hw(e,t,n,r,i){var a=ym(),o=2&r;try{mm(-1),o&&t.length>20&&Ow(e,t,20,Qy()),n(r,i)}finally{mm(a)}}function Gw(e,t,n){if(fy(t))for(var r=t.directiveEnd,i=t.directiveStart;i<r;i++){var a=e.data[i];a.contentQueries&&a.contentQueries(1,n[i],i)}}function qw(e,t,n){!Hy()||(function(e,t,n,r){var i=n.directiveStart,a=n.directiveEnd;e.firstCreatePass||Vm(n,t),C_(r,t);for(var o=n.initialInputs,s=i;s<a;s++){var u=e.data[s],c=py(u);c&&iC(t,n,u);var l=Jm(t,e,s,n);C_(l,t),null!==o&&oC(0,s-i,l,u,0,o),c&&(Dy(n.index,t)[8]=l)}}(e,t,n,Ry(n,t)),128==(128&n.flags)&&function(e,t,n){var r=n.directiveStart,i=n.directiveEnd,a=n.index,o=zy.lFrame.currentDirectiveIndex;try{mm(a);for(var s=r;s<i;s++){var u=e.data[s],c=t[s];om(s),(null!==u.hostBindings||0!==u.hostVars||null!==u.hostAttrs)&&Xw(u,c)}}finally{mm(-1),om(o)}}(e,t,n))}function $w(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ry,r=t.localNames;if(null!==r)for(var i=t.index+1,a=0;a<r.length;a+=2){var o=r[a+1],s=-1===o?n(t,e):e[o];e[i++]=s}}function Ww(e){var t=e.tView;return null===t||t.incompleteFirstPass?e.tView=jw(1,null,e.template,e.decls,e.vars,e.directiveDefs,e.pipeDefs,e.viewQuery,e.schemas,e.consts):t}function jw(e,t,n,r,i,a,o,s,u,c){var l=20+r,h=l+i,f=function(e,t){for(var n=[],r=0;r<t;r++)n.push(r<e?null:Sw);return n}(l,h),d="function"==typeof c?c():c;return f[1]={type:e,blueprint:f,template:n,queries:null,viewQuery:s,declTNode:t,data:f.slice().fill(null,l),bindingStartIndex:l,expandoStartIndex:h,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof a?a():a,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:u,consts:d,incompleteFirstPass:!1}}function Zw(e,t,n,r){var i=mC(t);null===n?i.push(r):(i.push(n),e.firstCreatePass&&kC(e).push(r,i.length-1))}function Yw(e,t,n){for(var r in e)if(e.hasOwnProperty(r)){var i=e[r];(n=null===n?{}:n).hasOwnProperty(r)?n[r].push(t,i):n[r]=[t,i]}return n}function Kw(e,t,n,r,i,a,o,s){var u,c=Ry(t,n),l=t.inputs;!s&&null!=l&&(u=l[r])?(wC(e,n,u,r,i),dy(t)&&function(e,t){var n=Dy(t,e);16&n[2]||(n[2]|=64)}(n,t.index)):3&t.type&&(r=function(e){return"class"===e?"className":"for"===e?"htmlFor":"formaction"===e?"formAction":"innerHtml"===e?"innerHTML":"readonly"===e?"readOnly":"tabindex"===e?"tabIndex":e}(r),i=null!=o?o(i,t.value||"",r):i,Ty(a)?a.setProperty(c,r,i):xm(r)||(c.setProperty?c.setProperty(r,i):c[r]=i))}function Jw(e,t,n,r){var i=!1;if(Hy()){var a=function(e,t,n){var r=e.directiveRegistry,i=null;if(r)for(var a=0;a<r.length;a++){var o=r[a];Cw(n,o.selectors,!1)&&(i||(i=[]),Gm(Vm(n,t),e,o.type),py(o)?(eC(e,n),i.unshift(o)):i.push(o))}return i}(e,t,n),o=null===r?null:{"":-1};if(null!==a){i=!0,nC(n,e.data.length,a.length);for(var s=0;s<a.length;s++){var u=a[s];u.providersResolver&&u.providersResolver(u)}for(var c=!1,l=!1,h=Bw(e,t,a.length,null),f=0;f<a.length;f++){var d=a[f];n.mergedAttrs=Am(n.mergedAttrs,d.hostAttrs),rC(e,n,t,h,d),tC(h,d,o),null!==d.contentQueries&&(n.flags|=8),(null!==d.hostBindings||null!==d.hostAttrs||0!==d.hostVars)&&(n.flags|=128);var v=d.type.prototype;!c&&(v.ngOnChanges||v.ngOnInit||v.ngDoCheck)&&((e.preOrderHooks||(e.preOrderHooks=[])).push(n.index),c=!0),!l&&(v.ngOnChanges||v.ngDoCheck)&&((e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(n.index),l=!0),h++}!function(e,t){for(var n=t.directiveEnd,r=e.data,i=t.attrs,a=[],o=null,s=null,u=t.directiveStart;u<n;u++){var c=r[u],l=c.inputs,h=null===i||yw(t)?null:sC(l,i);a.push(h),o=Yw(l,u,o),s=Yw(c.outputs,u,s)}null!==o&&(o.hasOwnProperty("class")&&(t.flags|=16),o.hasOwnProperty("style")&&(t.flags|=32)),t.initialInputs=a,t.inputs=o,t.outputs=s}(e,n)}o&&function(e,t,n){if(t)for(var r=e.localNames=[],i=0;i<t.length;i+=2){var a=n[t[i+1]];if(null==a)throw new kg("301","Export of name '".concat(t[i+1],"' not found!"));r.push(t[i],a)}}(n,r,o)}return n.mergedAttrs=Am(n.mergedAttrs,n.attrs),i}function Qw(e,t,n,r,i,a){var o=a.hostBindings;if(o){var s=e.hostBindingOpCodes;null===s&&(s=e.hostBindingOpCodes=[]);var u=~t.index;(function(e){for(var t=e.length;t>0;){var n=e[--t];if("number"==typeof n&&n<0)return n}return 0})(s)!=u&&s.push(u),s.push(r,i,o)}}function Xw(e,t){null!==e.hostBindings&&e.hostBindings(1,t)}function eC(e,t){t.flags|=2,(e.components||(e.components=[])).push(t.index)}function tC(e,t,n){if(n){if(t.exportAs)for(var r=0;r<t.exportAs.length;r++)n[t.exportAs[r]]=e;py(t)&&(n[""]=e)}}function nC(e,t,n){e.flags|=1,e.directiveStart=t,e.directiveEnd=t+n,e.providerIndexes=t}function rC(e,t,n,r,i){e.data[r]=i;var a=i.factory||(i.factory=yy(i.type)),o=new Om(a,py(i),null);e.blueprint[r]=o,n[r]=o,Qw(e,t,0,r,Bw(e,n,i.hostVars,Sw),i)}function iC(e,t,n){var r=Ry(t,e),i=Ww(n),a=e[10],o=fC(e,Dw(e,i,null,n.onPush?64:16,r,t,a,a.createRenderer(r,n),null,null));e[t.index]=o}function aC(e,t,n,r,i,a,o){if(null==a)Ty(e)?e.removeAttribute(t,i,n):t.removeAttribute(i);else{var s=null==o?_g(a):o(a,r||"",i);Ty(e)?e.setAttribute(t,i,s,n):n?t.setAttributeNS(n,i,s):t.setAttribute(i,s)}}function oC(e,t,n,r,i,a){var o=a[t];if(null!==o)for(var s=r.setInput,u=0;u<o.length;){var c=o[u++],l=o[u++],h=o[u++];null!==s?r.setInput(n,h,c,l):n[l]=h}}function sC(e,t){for(var n=null,r=0;r<t.length;){var i=t[r];if(0!==i)if(5!==i){if("number"==typeof i)break;e.hasOwnProperty(i)&&(null===n&&(n=[]),n.push(i,e[i],t[r+1])),r+=2}else r+=2;else r+=4}return n}function uC(e,t,n,r){return new Array(e,!0,!1,t,null,0,r,n,null,null)}function cC(e,t){var n=Dy(t,e);if(Fy(n)){var r=n[1];80&n[2]?Uw(r,n,r.template,n[8]):n[5]>0&&lC(n)}}function lC(e){for(var t=D_(e);null!==t;t=L_(t))for(var n=10;n<t.length;n++){var r=t[n];if(1024&r[2]){var i=r[1];Uw(i,r,i.template,r[8])}else r[5]>0&&lC(r)}var a=e[1].components;if(null!==a)for(var o=0;o<a.length;o++){var s=Dy(a[o],e);Fy(s)&&s[5]>0&&lC(s)}}function hC(e,t){var n=Dy(t,e),r=n[1];(function(e,t){for(var n=t.length;n<e.blueprint.length;n++)t.push(e.blueprint[n])})(r,n),Vw(r,n,n[8])}function fC(e,t){return e[13]?e[14][4]=t:e[13]=t,e[14]=t,t}function dC(e){for(;e;){e[2]|=64;var t=M_(e);if(gy(e)&&!t)return e;e=t}return null}function vC(e,t,n){var r=t[10];r.begin&&r.begin();try{Uw(e,t,e.template,n)}catch(i){throw _C(t,i),i}finally{r.end&&r.end()}}function pC(e){!function(e){for(var t=0;t<e.components.length;t++){var n=e.components[t],r=b_(n),i=r[1];zw(i,r,i.template,n)}}(e[8])}function gC(e,t,n){um(0),t(e,n)}var yC=Promise.resolve(null);function mC(e){return e[7]||(e[7]=[])}function kC(e){return e.cleanup||(e.cleanup=[])}function _C(e,t){var n=e[9],r=n?n.get(P_,null):null;r&&r.handleError(t)}function wC(e,t,n,r,i){for(var a=0;a<n.length;){var o=n[a++],s=n[a++],u=t[o],c=e.data[o];null!==c.setInput?c.setInput(u,i,r,s):u[s]=i}}function CC(e,t,n){var r=Ay(t,e);U_(e[11],r,n)}function bC(e,t,n){var r=n?e.styles:null,i=n?e.classes:null,a=0;if(null!==t)for(var o=0;o<t.length;o++){var s=t[o];"number"==typeof s?a=s:1==a?i=vg(i,s):2==a&&(r=vg(r,s+": "+t[++o]+";"))}n?e.styles=r:e.stylesWithoutHost=r,n?e.classes=i:e.classesWithoutHost=i}var EC,SC=new ok("INJECTOR",-1),PC=function(){function e(){tp(this,e)}return rp(e,[{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:mk;if(t===mk){var n=new Error("NullInjectorError: No provider for ".concat(dg(e),"!"));throw n.name="NullInjectorError",n}return t}}]),e}(),OC=new ok("Set Injector scope."),TC={},IC={};function xC(){return void 0===EC&&(EC=new PC),EC}function AC(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3?arguments[3]:void 0;return new RC(e,n,t||xC(),r)}var RC=function(){function e(t,n,r){var i=this,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;tp(this,e),this.parent=r,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;var o=[];n&&lk(n,function(e){return i.processProvider(e,t,n)}),lk([t],function(e){return i.processInjectorType(e,[],o)}),this.records.set(SC,DC(void 0,this));var s=this.records.get(OC);this.scope=null!=s?s.value:null,this.source=a||("object"==typeof t?null:dg(t))}return rp(e,[{key:"destroyed",get:function(){return this._destroyed}},{key:"destroy",value:function(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(function(e){return e.ngOnDestroy()})}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:mk,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Mg.Default;this.assertNotDestroyed();var r,i=Ek(this),a=Dg(void 0);try{if(!(n&Mg.SkipSelf)){var o=this.records.get(e);if(void 0===o){var s=("function"==typeof(r=e)||"object"==typeof r&&r instanceof ok)&&Pg(e);o=s&&this.injectableDefInScope(s)?DC(NC(e),TC):null,this.records.set(e,o)}if(null!=o)return this.hydrate(e,o)}return(n&Mg.Self?xC():this.parent).get(e,t=n&Mg.Optional&&t===mk?null:t)}catch(u){if("NullInjectorError"===u.name){if((u[_k]=u[_k]||[]).unshift(dg(e)),i)throw u;return xk(u,e,"R3InjectorError",this.source)}throw u}finally{Dg(a),Ek(i)}}},{key:"_resolveInjectorDefTypes",value:function(){var e=this;this.injectorDefTypes.forEach(function(t){return e.get(t)})}},{key:"toString",value:function(){var e=[];return this.records.forEach(function(t,n){return e.push(dg(n))}),"R3Injector[".concat(e.join(", "),"]")}},{key:"assertNotDestroyed",value:function(){if(this._destroyed)throw new Error("Injector has already been destroyed.")}},{key:"processInjectorType",value:function(e,t,n){var r=this;if(!(e=yg(e)))return!1;var i=Tg(e),a=null==i&&e.ngModule||void 0,o=void 0===a?e:a,s=-1!==n.indexOf(o);if(void 0!==a&&(i=Tg(a)),null==i)return!1;if(null!=i.imports&&!s){var u;n.push(o);try{lk(i.imports,function(e){r.processInjectorType(e,t,n)&&(void 0===u&&(u=[]),u.push(e))})}finally{}if(void 0!==u)for(var c=function(e){var t=u[e],n=t.ngModule,i=t.providers;lk(i,function(e){return r.processProvider(e,n,i||$g)})},l=0;l<u.length;l++)c(l)}this.injectorDefTypes.add(o);var h=yy(o)||function(){return new o};this.records.set(o,DC(h,TC));var f=i.providers;if(null!=f&&!s){var d=e;lk(f,function(e){return r.processProvider(e,d,f)})}return void 0!==a&&void 0!==e.providers}},{key:"processProvider",value:function(e,t,n){var r=FC(e=yg(e))?e:yg(e&&e.provide),i=function(e,t,n){return LC(e)?DC(void 0,e.useValue):DC(MC(e),TC)}(e);if(FC(e)||!0!==e.multi)this.records.get(r);else{var a=this.records.get(r);a||((a=DC(void 0,TC,!0)).factory=function(){return Ok(a.multi)},this.records.set(r,a)),r=e,a.multi.push(e)}this.records.set(r,i)}},{key:"hydrate",value:function(e,t){return t.value===TC&&(t.value=IC,t.value=t.factory()),"object"==typeof t.value&&t.value&&null!==(n=t.value)&&"object"==typeof n&&"function"==typeof n.ngOnDestroy&&this.onDestroy.add(t.value),t.value;var n}},{key:"injectableDefInScope",value:function(e){if(!e.providedIn)return!1;var t=yg(e.providedIn);return"string"==typeof t?"any"===t||t===this.scope:this.injectorDefTypes.has(t)}}]),e}();function NC(e){var t=Pg(e),n=null!==t?t.factory:yy(e);if(null!==n)return n;if(e instanceof ok)throw new Error("Token ".concat(dg(e)," is missing a \u0275prov definition."));if(e instanceof Function)return function(e){var t=e.length;if(t>0){var n=dk(t,"?");throw new Error("Can't resolve all parameters for ".concat(dg(e),": (").concat(n.join(", "),")."))}var r=function(e){var t=e&&(e[xg]||e[Rg]);if(t){var n=function(e){if(e.hasOwnProperty("name"))return e.name;var t=(""+e).match(/^function\s*([^\s(]+)/);return null===t?"":t[1]}(e);return console.warn('DEPRECATED: DI is instantiating a token "'.concat(n,'" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "').concat(n,'" class.')),t}return null}(e);return null!==r?function(){return r.factory(e)}:function(){return new e}}(e);throw new Error("unreachable")}function MC(e,t,n){var r;if(FC(e)){var i=yg(e);return yy(i)||NC(i)}if(LC(e))r=function(){return yg(e.useValue)};else if(function(e){return!(!e||!e.useFactory)}(e))r=function(){return e.useFactory.apply(e,Kv(Ok(e.deps||[])))};else if(function(e){return!(!e||!e.useExisting)}(e))r=function(){return Pk(yg(e.useExisting))};else{var a=yg(e&&(e.useClass||e.provide));if(!function(e){return!!e.deps}(e))return yy(a)||NC(a);r=function(){return Uv(a,Kv(Ok(e.deps)))}}return r}function DC(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return{factory:e,value:t,multi:n?[]:void 0}}function LC(e){return null!==e&&"object"==typeof e&&bk in e}function FC(e){return"function"==typeof e}var BC=function(e,t,n){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3?arguments[3]:void 0,i=AC(e,t,n,r);return i._resolveInjectorDefTypes(),i}({name:n},t,e,n)},VC=function(){var e=function(){function e(){tp(this,e)}return rp(e,null,[{key:"create",value:function(e,t){return Array.isArray(e)?BC(e,t,""):BC(e.providers,e.parent,e.name||"")}}]),e}();return e.THROW_IF_NOT_FOUND=mk,e.NULL=new PC,e.\u0275prov=Eg({token:e,providedIn:"any",factory:function(){return Pk(SC)}}),e.__NG_ELEMENT_ID__=-1,e}();function UC(e,t){wm(b_(e)[1],Wy())}function zC(e){for(var t=function(e){return Object.getPrototypeOf(e.prototype).constructor}(e.type),n=!0,r=[e];t;){var i=void 0;if(py(e))i=t.\u0275cmp||t.\u0275dir;else{if(t.\u0275cmp)throw new Error("Directives cannot inherit Components");i=t.\u0275dir}if(i){if(n){r.push(i);var a=e;a.inputs=HC(e.inputs),a.declaredInputs=HC(e.declaredInputs),a.outputs=HC(e.outputs);var o=i.hostBindings;o&&$C(e,o);var s=i.viewQuery,u=i.contentQueries;if(s&&GC(e,s),u&&qC(e,u),fg(e.inputs,i.inputs),fg(e.declaredInputs,i.declaredInputs),fg(e.outputs,i.outputs),py(i)&&i.data.animation){var c=e.data;c.animation=(c.animation||[]).concat(i.data.animation)}}var l=i.features;if(l)for(var h=0;h<l.length;h++){var f=l[h];f&&f.ngInherit&&f(e),f===zC&&(n=!1)}}t=Object.getPrototypeOf(t)}!function(e){for(var t=0,n=null,r=e.length-1;r>=0;r--){var i=e[r];i.hostVars=t+=i.hostVars,i.hostAttrs=Am(i.hostAttrs,n=Am(n,i.hostAttrs))}}(r)}function HC(e){return e===qg?{}:e===$g?[]:e}function GC(e,t){var n=e.viewQuery;e.viewQuery=n?function(e,r){t(e,r),n(e,r)}:t}function qC(e,t){var n=e.contentQueries;e.contentQueries=n?function(e,r,i){t(e,r,i),n(e,r,i)}:t}function $C(e,t){var n=e.hostBindings;e.hostBindings=n?function(e,r){t(e,r),n(e,r)}:t}var WC=null;function jC(){if(!WC){var e=Gg.Symbol;if(e&&e.iterator)WC=e.iterator;else for(var t=Object.getOwnPropertyNames(Map.prototype),n=0;n<t.length;++n){var r=t[n];"entries"!==r&&"size"!==r&&Map.prototype[r]===Map.prototype.entries&&(WC=r)}}return WC}var ZC=function(){function e(t){tp(this,e),this.wrapped=t}return rp(e,null,[{key:"wrap",value:function(t){return new e(t)}},{key:"unwrap",value:function(t){return e.isWrapped(t)?t.wrapped:t}},{key:"isWrapped",value:function(t){return t instanceof e}}]),e}();function YC(e){return!!KC(e)&&(Array.isArray(e)||!(e instanceof Map)&&jC()in e)}function KC(e){return null!==e&&("function"==typeof e||"object"==typeof e)}function JC(e,t,n){return e[t]=n}function QC(e,t,n){return!Object.is(e[t],n)&&(e[t]=n,!0)}function XC(e,t,n,r){var i=QC(e,t,n);return QC(e,t+1,r)||i}function eb(e,t,n,r,i){var a=XC(e,t,n,r);return QC(e,t+2,i)||a}function tb(e,t,n,r){var i=Gy();return QC(i,nm(),t)&&(qy(),function(e,t,n,r,i,a){var o=Ry(e,t);aC(t[11],o,a,e.value,n,r,i)}(km(),i,e,t,n,r)),tb}function nb(e,t,n,r){return QC(e,nm(),n)?t+_g(n)+r:Sw}function rb(e,t,n,r,i,a){var o=XC(e,tm(),n,i);return rm(2),o?t+_g(n)+r+_g(i)+a:Sw}function ib(e,t,n,r,i,a,o,s){var u=eb(e,tm(),n,i,o);return rm(3),u?t+_g(n)+r+_g(i)+a+_g(o)+s:Sw}function ab(e,t,n,r,i,a,o,s){var u=Gy(),c=qy(),l=e+20,h=c.firstCreatePass?function(e,t,n,r,i,a,o,s,u){var c=t.consts,l=Lw(t,e,4,o||null,By(c,s));Jw(t,n,l,By(c,u)),wm(t,l);var h=l.tViews=jw(2,l,r,i,a,t.directiveRegistry,t.pipeRegistry,null,t.schemas,c);return null!==t.queries&&(t.queries.template(t,l),h.queries=t.queries.embeddedTView(l)),l}(l,c,u,t,n,r,i,a,o):c.data[l];Yy(h,!1);var f=u[11].createComment("");iw(c,u,f,h),C_(f,u),fC(u,u[l]=uC(f,u,f,h)),vy(h)&&qw(c,u,h),null!=o&&$w(u,h,s)}function ob(e){return My(zy.lFrame.contextLView,20+e)}function sb(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Mg.Default,n=Gy();return null===n?Pk(e,t):Wm(Wy(),n,yg(e),t)}function ub(e,t,n){var r=Gy();return QC(r,nm(),t)&&Kw(qy(),km(),r,e,t,r[11],n,!1),ub}function cb(e,t,n,r,i){var a=i?"class":"style";wC(e,n,t.inputs[a],a,r)}function lb(e,t,n,r){var i=Gy(),a=qy(),o=20+e,s=i[11],u=i[o]=H_(s,t,zy.lFrame.currentNamespace),c=a.firstCreatePass?function(e,t,n,r,i,a,o){var s=t.consts,u=Lw(t,e,2,i,By(s,a));return Jw(t,n,u,By(s,o)),null!==u.attrs&&bC(u,u.attrs,!1),null!==u.mergedAttrs&&bC(u,u.mergedAttrs,!0),null!==t.queries&&t.queries.elementStart(t,u),u}(o,a,i,0,t,n,r):a.data[o];Yy(c,!0);var l=c.mergedAttrs;null!==l&&Tm(s,u,l);var h=c.classes;null!==h&&dw(s,u,h);var f=c.styles;null!==f&&fw(s,u,f),64!=(64&c.flags)&&iw(a,i,u,c),0===zy.lFrame.elementDepthCount&&C_(u,i),zy.lFrame.elementDepthCount++,vy(c)&&(qw(a,i,c),Gw(a,c,i)),null!==r&&$w(i,c)}function hb(){var e=Wy();Ky()?Jy():Yy(e=e.parent,!1);var t=e;zy.lFrame.elementDepthCount--;var n=qy();n.firstCreatePass&&(wm(n,e),fy(e)&&n.queries.elementEnd(e)),null!=t.classesWithoutHost&&function(e){return 0!=(16&e.flags)}(t)&&cb(n,t,Gy(),t.classesWithoutHost,!0),null!=t.stylesWithoutHost&&function(e){return 0!=(32&e.flags)}(t)&&cb(n,t,Gy(),t.stylesWithoutHost,!1)}function fb(e,t,n,r){lb(e,t,n,r),hb()}function db(e,t,n){var r=Gy(),i=qy(),a=e+20,o=i.firstCreatePass?function(e,t,n,r,i){var a=t.consts,o=By(a,r),s=Lw(t,e,8,"ng-container",o);return null!==o&&bC(s,o,!0),Jw(t,n,s,By(a,i)),null!==t.queries&&t.queries.elementStart(t,s),s}(a,i,r,t,n):i.data[a];Yy(o,!0);var s=r[a]=r[11].createComment("");iw(i,r,s,o),C_(s,r),vy(o)&&(qw(i,r,o),Gw(i,o,r)),null!=n&&$w(r,o)}function vb(){var e=Wy(),t=qy();Ky()?Jy():Yy(e=e.parent,!1),t.firstCreatePass&&(wm(t,e),fy(e)&&t.queries.elementEnd(e))}function pb(){return Gy()}function gb(e){return!!e&&"function"==typeof e.then}var yb=function(e){return!!e&&"function"==typeof e.subscribe};function mb(e,t,n,r){var i=Gy(),a=qy(),o=Wy();return function(e,t,n,r,i,a,o,s){var u=vy(r),c=e.firstCreatePass&&kC(e),l=t[8],h=mC(t),f=!0;if(3&r.type||s){var d=Ry(r,t),v=s?s(d):d,p=h.length,g=s?function(e){return s(xy(e[r.index]))}:r.index;if(Ty(n)){var y=null;if(!s&&u&&(y=function(e,t,n,r){var i=e.cleanup;if(null!=i)for(var a=0;a<i.length-1;a+=2){var o=i[a];if(o===n&&i[a+1]===r){var s=t[7],u=i[a+2];return s.length>u?s[u]:null}"string"==typeof o&&(a+=2)}return null}(e,t,i,r.index)),null!==y)(y.__ngLastListenerFn__||y).__ngNextListenerFn__=a,y.__ngLastListenerFn__=a,f=!1;else{a=_b(r,t,l,a,!1);var m=n.listen(v,i,a);h.push(a,m),c&&c.push(i,g,p,p+1)}}else a=_b(r,t,l,a,!0),v.addEventListener(i,a,o),h.push(a),c&&c.push(i,g,p,o)}else a=_b(r,t,l,a,!1);var k,_=r.outputs;if(f&&null!==_&&(k=_[i])){var w=k.length;if(w)for(var C=0;C<w;C+=2){var b=t[k[C]][k[C+1]].subscribe(a),E=h.length;h.push(a,b),c&&c.push(i,r.index,E,-(E+1))}}}(a,i,i[11],o,e,t,!!n,r),mb}function kb(e,t,n,r){try{return!1!==n(r)}catch(i){return _C(e,i),!1}}function _b(e,t,n,r,i){return function n(a){if(a===Function)return r;var o=2&e.flags?Dy(e.index,t):t;0==(32&t[2])&&dC(o);for(var s=kb(t,0,r,a),u=n.__ngNextListenerFn__;u;)s=kb(t,0,u,a)&&s,u=u.__ngNextListenerFn__;return i&&!1===s&&(a.preventDefault(),a.returnValue=!1),s}}function wb(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return function(e){return(zy.lFrame.contextLView=function(e,t){for(;e>0;)t=t[15],e--;return t}(e,zy.lFrame.contextLView))[8]}(e)}function Cb(e,t,n,r,i){var a=Gy(),o=nb(a,t,n,r);return o!==Sw&&Kw(qy(),km(),a,e,o,a[11],i,!1),Cb}function bb(e,t,n,r,i,a,o){var s=Gy(),u=rb(s,t,n,r,i,a);return u!==Sw&&Kw(qy(),km(),s,e,u,s[11],o,!1),bb}function Eb(e,t,n,r,i,a,o,s,u){var c=Gy(),l=ib(c,t,n,r,i,a,o,s);return l!==Sw&&Kw(qy(),km(),c,e,l,c[11],u,!1),Eb}function Sb(e,t,n,r,i){for(var a=e[n+1],o=null===t,s=r?Iw(a):Aw(a),u=!1;0!==s&&(!1===u||o);){var c=e[s+1];Pb(e[s],t)&&(u=!0,e[s+1]=r?Nw(c):xw(c)),s=r?Iw(c):Aw(c)}u&&(e[n+1]=r?xw(a):Nw(a))}function Pb(e,t){return null===e||null==t||(Array.isArray(e)?e[1]:e)===t||!(!Array.isArray(e)||"string"!=typeof t)&&gk(e,t)>=0}function Ob(e,t){return function(e,t,n,r){var i=Gy(),a=qy(),o=rm(2);a.firstUpdatePass&&function(e,t,n,r){var i=e.data;if(null===i[n+1]){var a=i[ym()],o=function(e,t){return t>=e.expandoStartIndex}(e,n);(function(e,t){return 0!=(16&e.flags)})(a)&&null===t&&!o&&(t=!1),function(e,t,n,r,i,a){var o=t.classBindings,s=Iw(o),u=Aw(o);e[r]=n;var c,l=!1;if(Array.isArray(n)){var h=n;(null===(c=h[1])||gk(h,c)>0)&&(l=!0)}else c=n;if(i)if(0!==u){var f=Iw(e[s+1]);e[r+1]=Tw(f,s),0!==f&&(e[f+1]=Rw(e[f+1],r)),e[s+1]=function(e,t){return 131071&e|t<<17}(e[s+1],r)}else e[r+1]=Tw(s,0),0!==s&&(e[s+1]=Rw(e[s+1],r)),s=r;else e[r+1]=Tw(u,0),0===s?s=r:e[u+1]=Rw(e[u+1],r),u=r;l&&(e[r+1]=xw(e[r+1])),Sb(e,c,r,!0),Sb(e,c,r,!1),function(e,t,n,r,i){var a=e.residualClasses;null!=a&&"string"==typeof t&&gk(a,t)>=0&&(n[r+1]=Nw(n[r+1]))}(t,c,e,r),o=Tw(s,u),t.classBindings=o}(i,a,t=function(e,t,n,r){var i=function(e){var t=zy.lFrame.currentDirectiveIndex;return-1===t?null:e[t]}(e),a=t.residualClasses;if(null===i)0===t.classBindings&&(n=Ib(n=Tb(null,e,t,n,r),t.attrs,r),a=null);else{var o=t.directiveStylingLast;if(-1===o||e[o]!==i)if(n=Tb(i,e,t,n,r),null===a){var s=function(e,t,n){var r=t.classBindings;if(0!==Aw(r))return e[Iw(r)]}(e,t);void 0!==s&&Array.isArray(s)&&function(e,t,n,r){e[Iw(t.classBindings)]=r}(e,t,0,s=Ib(s=Tb(null,e,t,s[1],r),t.attrs,r))}else a=function(e,t,n){for(var r,i=t.directiveEnd,a=1+t.directiveStylingLast;a<i;a++)r=Ib(r,e[a].hostAttrs,true);return Ib(r,t.attrs,true)}(e,t)}return void 0!==a&&(t.residualClasses=a),n}(i,a,t,r),n,o)}}(a,e,o,true),t!==Sw&&QC(i,o,t)&&function(e,t,n,r,i,a,o,s){if(3&t.type){var u=e.data,c=u[s+1];Ab(function(e){return 1==(1&e)}(c)?xb(u,t,n,i,Aw(c),o):void 0)||(Ab(a)||function(e){return 2==(2&e)}(c)&&(a=xb(u,null,n,i,s,o)),function(e,t,n,r,i){var a=Ty(e);i?a?e.addClass(n,r):n.classList.add(r):a?e.removeClass(n,r):n.classList.remove(r)}(r,0,Ay(ym(),n),i,a))}}(a,a.data[ym()],i,i[11],e,i[o+1]=function(e,t){return null==e||"object"==typeof e&&(e=dg(qk(e))),e}(t),true,o)}(e,t),Ob}function Tb(e,t,n,r,i){var a=null,o=n.directiveEnd,s=n.directiveStylingLast;for(-1===s?s=n.directiveStart:s++;s<o&&(r=Ib(r,(a=t[s]).hostAttrs,i),a!==e);)s++;return null!==e&&(n.directiveStylingLast=s),r}function Ib(e,t,n){var r=n?1:2,i=-1;if(null!==t)for(var a=0;a<t.length;a++){var o=t[a];"number"==typeof o?i=o:i===r&&(Array.isArray(e)||(e=void 0===e?[]:["",e]),vk(e,o,!!n||t[++a]))}return void 0===e?null:e}function xb(e,t,n,r,i,a){for(var o,s=null===t;i>0;){var u=e[i],c=Array.isArray(u),l=c?u[1]:u,h=null===l,f=n[i+1];f===Sw&&(f=h?$g:void 0);var d=h?pk(f,r):l===r?f:void 0;if(c&&!Ab(d)&&(d=pk(u,r)),Ab(d)&&(o=d,s))return o;var v=e[i+1];i=s?Iw(v):Aw(v)}if(null!==t){var p=a?t.residualClasses:t.residualStyles;null!=p&&(o=pk(p,r))}return o}function Ab(e){return void 0!==e}function Rb(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=Gy(),r=qy(),i=e+20,a=r.firstCreatePass?Lw(r,i,1,t,null):r.data[i],o=n[i]=V_(n[11],t);iw(r,n,o,a),Yy(a,!1)}function Nb(e){return Mb("",e,""),Nb}function Mb(e,t,n){var r=Gy(),i=nb(r,e,t,n);return i!==Sw&&CC(r,ym(),i),Mb}function Db(e,t,n,r,i){var a=Gy(),o=rb(a,e,t,n,r,i);return o!==Sw&&CC(a,ym(),o),Db}function Lb(e,t,n,r,i,a,o){var s=Gy(),u=ib(s,e,t,n,r,i,a,o);return u!==Sw&&CC(s,ym(),u),Lb}function Fb(e,t,n){var r=Gy();return QC(r,nm(),t)&&Kw(qy(),km(),r,e,t,r[11],n,!0),Fb}var Bb=void 0,Vb=["en",[["a","p"],["AM","PM"],Bb],[["AM","PM"],Bb,Bb],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],Bb,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],Bb,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",Bb,"{1} 'at' {0}",Bb],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function(e){var t=Math.floor(Math.abs(e)),n=e.toString().replace(/^[^.]*\.?/,"").length;return 1===t&&0===n?1:5}],Ub={};function zb(e){var t=function(e){return e.toLowerCase().replace(/_/g,"-")}(e),n=Gb(t);if(n)return n;var r=t.split("-")[0];if(n=Gb(r))return n;if("en"===r)return Vb;throw new Error('Missing locale data for the locale "'.concat(e,'".'))}function Hb(e){return zb(e)[qb.PluralCase]}function Gb(e){return e in Ub||(Ub[e]=Gg.ng&&Gg.ng.common&&Gg.ng.common.locales&&Gg.ng.common.locales[e]),Ub[e]}var qb=((qb=qb||{})[qb.LocaleId=0]="LocaleId",qb[qb.DayPeriodsFormat=1]="DayPeriodsFormat",qb[qb.DayPeriodsStandalone=2]="DayPeriodsStandalone",qb[qb.DaysFormat=3]="DaysFormat",qb[qb.DaysStandalone=4]="DaysStandalone",qb[qb.MonthsFormat=5]="MonthsFormat",qb[qb.MonthsStandalone=6]="MonthsStandalone",qb[qb.Eras=7]="Eras",qb[qb.FirstDayOfWeek=8]="FirstDayOfWeek",qb[qb.WeekendRange=9]="WeekendRange",qb[qb.DateFormat=10]="DateFormat",qb[qb.TimeFormat=11]="TimeFormat",qb[qb.DateTimeFormat=12]="DateTimeFormat",qb[qb.NumberSymbols=13]="NumberSymbols",qb[qb.NumberFormats=14]="NumberFormats",qb[qb.CurrencyCode=15]="CurrencyCode",qb[qb.CurrencySymbol=16]="CurrencySymbol",qb[qb.CurrencyName=17]="CurrencyName",qb[qb.Currencies=18]="Currencies",qb[qb.Directionality=19]="Directionality",qb[qb.PluralCase=20]="PluralCase",qb[qb.ExtraData=21]="ExtraData",qb),$b=["zero","one","two","few","many"],Wb="en-US",jb={marker:"element"},Zb={marker:"ICU"},Yb=((Yb=Yb||{})[Yb.SHIFT=2]="SHIFT",Yb[Yb.APPEND_EAGERLY=1]="APPEND_EAGERLY",Yb[Yb.COMMENT=2]="COMMENT",Yb),Kb=Wb;function Jb(e){(function(e,t){null==e&&bg("Expected localeId to be defined",e,null,"!=")})(e),"string"==typeof e&&(Kb=e.toLowerCase().replace(/_/g,"-"))}function Qb(e,t,n){var r=t.insertBeforeIndex,i=Array.isArray(r)?r[0]:r;return null===i?ew(e,0,n):xy(n[i])}function Xb(e,t,n,r,i){var a=t.insertBeforeIndex;if(Array.isArray(a)){var o=r,s=null;if(3&t.type||(s=o,o=i),null!==o&&0==(2&t.flags))for(var u=1;u<a.length;u++)Y_(e,o,n[a[u]],s,!1)}}function eE(e,t){if(e.push(t),e.length>1)for(var n=e.length-2;n>=0;n--){var r=e[n];tE(r)||nE(r,t)&&null===rE(r)&&iE(r,t.index)}}function tE(e){return!(64&e.type)}function nE(e,t){return tE(t)||e.index>t.index}function rE(e){var t=e.insertBeforeIndex;return Array.isArray(t)?t[0]:t}function iE(e,t){var n=e.insertBeforeIndex;Array.isArray(n)?n[0]=t:(rw(Qb,Xb),e.insertBeforeIndex=t)}function aE(e,t){var n=e.data[t];return null===n||"string"==typeof n?null:n.hasOwnProperty("currentCaseLViewIndex")?n:n.value}function oE(e,t,n){var r=Fw(e,n,64,null,null);return eE(t,r),r}function sE(e,t){var n=t[e.currentCaseLViewIndex];return null===n?n:n<0?~n:n}function uE(e){return e>>>17}function cE(e){return(131070&e)>>>1}var lE=0,hE=0;function fE(e,t,n,r){for(var i,a=n[11],o=null,s=0;s<t.length;s++){var u=t[s];if("string"==typeof u){var c=t[++s];null===n[c]&&(n[c]=V_(a,u))}else if("number"==typeof u)switch(1&u){case 0:var l=uE(u),h=void 0,f=void 0;if(null===o&&(o=l,i=Q_(a,r)),l===o?(h=r,f=i):(h=null,f=xy(n[l])),null!==f){var d=cE(u);Y_(a,f,n[d],h,!1);var v=aE(e,d);if(null!==v&&"object"==typeof v){var p=sE(v,n);null!==p&&fE(e,v.create[p],n,n[v.anchorIdx])}}break;case 1:var g=t[++s],y=t[++s];aC(a,Ay(u>>>1,n),null,null,g,y,null);break;default:throw new Error('Unable to determine the type of mutate operation for "'.concat(u,'"'))}else switch(u){case Zb:var m=t[++s],k=t[++s];null===n[k]&&C_(n[k]=z_(a,m),n);break;case jb:var _=t[++s],w=t[++s];null===n[w]&&C_(n[w]=H_(a,_,null),n)}}}function dE(e,t,n,r,i){for(var a=0;a<n.length;a++){var o=n[a],s=n[++a];if(o&i)for(var u="",c=a+1;c<=a+s;c++){var l=n[c];if("string"==typeof l)u+=l;else if("number"==typeof l)if(l<0)u+=_g(t[r-l]);else{var h=l>>>2;switch(3&l){case 1:var f=n[++c],d=n[++c],v=e.data[h];"string"==typeof v?aC(t[11],t[h],null,v,f,u,d):Kw(e,v,t,f,u,t[11],d,!1);break;case 0:var p=t[h];null!==p&&U_(t[11],p,u);break;case 2:pE(e,aE(e,h),t,u);break;case 3:vE(e,aE(e,h),r,t)}}}else{var g=n[a+1];if(g>0&&3==(3&g)){var y=aE(e,g>>>2);t[y.currentCaseLViewIndex]<0&&vE(e,y,r,t)}}a+=s}}function vE(e,t,n,r){var i=r[t.currentCaseLViewIndex];if(null!==i){var a=lE;i<0&&(i=r[t.currentCaseLViewIndex]=~i,a=-1),dE(e,r,t.update[i],n,a)}}function pE(e,t,n,r){var i=function(e,t){var n=e.cases.indexOf(t);if(-1===n)switch(e.type){case 1:var r=function(e,t){var n=Hb(t)(parseInt(e,10)),r=$b[n];return void 0!==r?r:"other"}(t,Kb);-1===(n=e.cases.indexOf(r))&&"other"!==r&&(n=e.cases.indexOf("other"));break;case 0:n=e.cases.indexOf("other")}return-1===n?null:n}(t,r);if(sE(t,n)!==i&&(gE(e,t,n),n[t.currentCaseLViewIndex]=null===i?null:~i,null!==i)){var a=n[t.anchorIdx];a&&fE(e,t.create[i],n,a)}}function gE(e,t,n){var r=sE(t,n);if(null!==r)for(var i=t.remove[r],a=0;a<i.length;a++){var o=i[a];if(o>0){var s=Ay(o,n);null!==s&&uw(n[11],s)}else gE(e,aE(e,~o),n)}}function yE(){var e,t,n=[],r=-1;function i(e,n){r=0;var i=sE(e,n);t=null!==i?e.remove[i]:$g}function a(){if(r<t.length){var o=t[r++];return o>0?e[o]:(n.push(r,t),i(e[1].data[~o],e),a())}return 0===n.length?null:(t=n.pop(),r=n.pop(),a())}return function(t,r){for(e=r;n.length;)n.pop();return i(t.value,r),a}}var mE=/\ufffd(\d+):?\d*\ufffd/gi,kE=/\ufffd(\d+)\ufffd/,_E=/^\s*(\ufffd\d+:?\d*\ufffd)\s*,\s*(select|plural)\s*,/,wE=/\ufffd\/?\*(\d+:\d+)\ufffd/gi,CE=/\ufffd(\/?[#*]\d+):?\d*\ufffd/gi,bE=/\uE500/g;function EE(e,t,n,r,i,a,o){var s=Bw(e,r,1,null),u=s<<Yb.SHIFT,c=Zy();t===c&&(c=null),null===c&&(u|=Yb.APPEND_EAGERLY),o&&(u|=Yb.COMMENT,function(e){void 0===A_&&(A_=e())}(yE)),i.push(u,null===a?"":a);var l=Fw(e,s,o?32:1,null===a?"":a,null);eE(n,l);var h=l.index;return Yy(l,!1),null!==c&&t!==c&&function(e,t){var n=e.insertBeforeIndex;null===n?(rw(Qb,Xb),n=e.insertBeforeIndex=[null,t]):(function(e,t,n){true!=e&&bg("Expecting array here",e,true,"==")}(Array.isArray(n)),n.push(t))}(c,h),l}function SE(e,t,n,r,i,a,o){var s=o.match(mE),u=EE(e,t,n,a,r,s?null:o,!1);s&&PE(i,o,u.index,null,0,null)}function PE(e,t,n,r,i,a){var o=e.length,s=o+1;e.push(null,null);for(var u=o+2,c=t.split(mE),l=0,h=0;h<c.length;h++){var f=c[h];if(1&h){var d=i+parseInt(f,10);e.push(-1-d),l|=OE(d)}else""!==f&&e.push(f)}return e.push(n<<2|(r?1:0)),r&&e.push(r,a),e[o]=l,e[s]=e.length-u,l}function OE(e){return 1<<Math.min(e,31)}function TE(e){for(var t,n,r="",i=0,a=!1;null!==(t=wE.exec(e));)a?t[0]==="\ufffd/*".concat(n,"\ufffd")&&(i=t.index,a=!1):(r+=e.substring(i,t.index+t[0].length),n=t[1],a=!0);return r+=e.substr(i)}function IE(e,t,n,r,i,a){var o=0,s={type:i.type,currentCaseLViewIndex:Bw(e,t,1,null),anchorIdx:a,cases:[],create:[],remove:[],update:[]};(function(e,t,n){e.push(OE(t.mainBinding),2,-1-t.mainBinding,n<<2|2)})(n,i,a),function(e,t,n){var r=e.data[t];null===r?e.data[t]=n:r.value=n}(e,a,s);for(var u=i.values,c=0;c<u.length;c++){for(var l=u[c],h=[],f=0;f<l.length;f++){var d=l[f];if("string"!=typeof d){var v=h.push(d)-1;l[f]="\x3c!--\ufffd".concat(v,"\ufffd--\x3e")}}o=RE(e,s,t,n,r,i.cases[c],l.join(""),h)|o}o&&function(e,t,n){e.push(t,1,n<<2|3)}(n,o,a)}function xE(e){for(var t=[],n=[],r=1,i=0,a=AE(e=e.replace(_E,function(e,t,n){return r="select"===n?0:1,i=parseInt(t.substr(1),10),""})),o=0;o<a.length;){var s=a[o++].trim();1===r&&(s=s.replace(/\s*(?:=)?(\w+)\s*/,"$1")),s.length&&t.push(s);var u=AE(a[o++]);t.length>n.length&&n.push(u)}return{type:r,mainBinding:i,cases:t,values:n}}function AE(e){if(!e)return[];var t,n=0,r=[],i=[],a=/[{}]/g;for(a.lastIndex=0;t=a.exec(e);){var o=t.index;if("}"==t[0]){if(r.pop(),0==r.length){var s=e.substring(n,o);_E.test(s)?i.push(xE(s)):i.push(s),n=o+1}}else{if(0==r.length){var u=e.substring(n,o);i.push(u),n=o+1}r.push("{")}}var c=e.substring(n);return i.push(c),i}function RE(e,t,n,r,i,a,o,s){var u=[],c=[],l=[];t.cases.push(a),t.create.push(u),t.remove.push(c),t.update.push(l);var h=jk(Oy()).getInertBodyElement(o),f=g_(h)||h;return f?NE(e,t,n,r,u,c,l,f,i,s,0):0}function NE(e,t,n,r,i,a,o,s,u,c,l){for(var h=0,f=s.firstChild;f;){var d=Bw(e,n,1,null);switch(f.nodeType){case Node.ELEMENT_NODE:var v=f,p=v.tagName.toLowerCase();if(o_.hasOwnProperty(p)){LE(i,jb,p,u,d),e.data[d]=p;for(var g=v.attributes,y=0;y<g.length;y++){var m=g.item(y),k=m.name.toLowerCase();m.value.match(mE)?c_.hasOwnProperty(k)&&PE(o,m.value,d,m.name,0,s_[k]?Qk:u_[k]?Xk:null):FE(i,d,m)}h=NE(e,t,n,r,i,a,o,f,d,c,l+1)|h,ME(a,d,l)}break;case Node.TEXT_NODE:var _=f.textContent||"",w=_.match(mE);LE(i,null,w?"":_,u,d),ME(a,d,l),w&&(h=PE(o,_,d,null,0,null)|h);break;case Node.COMMENT_NODE:var C=kE.exec(f.textContent||"");if(C){var b=c[parseInt(C[1],10)];LE(i,Zb,"",u,d),IE(e,n,r,u,b,d),DE(a,d,l)}}f=f.nextSibling}return h}function ME(e,t,n){0===n&&e.push(t)}function DE(e,t,n){0===n&&(e.push(~t),e.push(t))}function LE(e,t,n,r,i){null!==t&&e.push(t),e.push(n,i,function(e,t,n){return 0|t<<17|n<<1}(0,r,i))}function FE(e,t,n){e.push(t<<1|1,n.name,n.value)}function BE(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,r=qy(),i=Gy(),a=20+e,o=By(r.consts,t),s=Zy();r.firstCreatePass&&function(e,t,n,r,i,a){for(var o=Zy(),s=[],u=[],c=[[]],l=function(e){return e.replace(bE," ")}(i=function(e,t){if(function(e){return-1===e}(t))return TE(e);var n=e.indexOf(":".concat(t,"\ufffd"))+2+t.toString().length,r=e.search(new RegExp("\ufffd\\/\\*\\d+:".concat(t,"\ufffd")));return TE(e.substring(n,r))}(i,a)).split(CE),h=0;h<l.length;h++){var f=l[h];if(0==(1&h))for(var d=AE(f),v=0;v<d.length;v++){var p=d[v];if(0==(1&v)){var g=p;""!==g&&SE(e,o,c[0],s,u,n,g)}else{var y=p;if("object"!=typeof y)throw new Error('Unable to parse ICU expression in "'.concat(i,'" message.'));IE(e,n,u,t,y,EE(e,o,c[0],n,s,"",!0).index)}}else{var m=47===f.charCodeAt(0),k=(f.charCodeAt(m?1:0),20+Number.parseInt(f.substring(m?2:1)));if(m)c.shift(),Yy(Zy(),!1);else{var _=oE(e,c[0],k);c.unshift([]),Yy(_,!0)}}}e.data[r]={create:s,update:u}}(r,null===s?0:s.index,i,a,o,n);var u=r.data[a],c=Z_(r,s===i[6]?null:s,i);(function(e,t,n,r){for(var i=e[11],a=0;a<t.length;a++){var o=t[a++],s=t[a],u=(o&Yb.COMMENT)===Yb.COMMENT,c=(o&Yb.APPEND_EAGERLY)===Yb.APPEND_EAGERLY,l=o>>>Yb.SHIFT,h=e[l];null===h&&(h=e[l]=u?i.createComment(s):V_(i,s)),c&&null!==n&&Y_(i,n,h,r,!1)}})(i,u.create,c,s&&8&s.type?i[s.index]:null),im(!0)}function VE(){im(!1)}function UE(e,t,n){BE(e,t,n),VE()}function zE(e){return function(e){e&&(lE|=1<<Math.min(hE,31)),hE++}(QC(Gy(),nm(),e)),zE}function HE(e){!function(e,t,n){if(hE>0){var r=e.data[n];dE(e,t,Array.isArray(r)?r:r.update,tm()-hE-1,lE)}lE=0,hE=0}(qy(),Gy(),e+20)}function GE(e,t,n,r,i){if(e=yg(e),Array.isArray(e))for(var a=0;a<e.length;a++)GE(e[a],t,n,r,i);else{var o=qy(),s=Gy(),u=FC(e)?e:yg(e.provide),c=MC(e),l=Wy(),h=1048575&l.providerIndexes,f=l.directiveStart,d=l.providerIndexes>>20;if(FC(e)||!e.multi){var v=new Om(c,i,sb),p=WE(u,t,i?h:h+d,f);-1===p?(Gm(Vm(l,s),o,u),qE(o,e,t.length),t.push(u),l.directiveStart++,l.directiveEnd++,i&&(l.providerIndexes+=1048576),n.push(v),s.push(v)):(n[p]=v,s[p]=v)}else{var g=WE(u,t,h+d,f),y=WE(u,t,h,h+d),m=g>=0&&n[g],k=y>=0&&n[y];if(i&&!k||!i&&!m){Gm(Vm(l,s),o,u);var _=function(e,t,n,r,i){var a=new Om(e,n,sb);return a.multi=[],a.index=t,a.componentProviders=0,$E(a,i,r&&!n),a}(i?ZE:jE,n.length,i,r,c);!i&&k&&(n[y].providerFactory=_),qE(o,e,t.length,0),t.push(u),l.directiveStart++,l.directiveEnd++,i&&(l.providerIndexes+=1048576),n.push(_),s.push(_)}else qE(o,e,g>-1?g:y,$E(n[i?y:g],c,!i&&r));!i&&r&&k&&n[y].componentProviders++}}}function qE(e,t,n,r){var i=FC(t);if(i||function(e){return!!e.useClass}(t)){var a=(t.useClass||t).prototype.ngOnDestroy;if(a){var o=e.destroyHooks||(e.destroyHooks=[]);if(!i&&t.multi){var s=o.indexOf(n);-1===s?o.push(n,[r,a]):o[s+1].push(r,a)}else o.push(n,a)}}}function $E(e,t,n){return n&&e.componentProviders++,e.multi.push(t)-1}function WE(e,t,n,r){for(var i=n;i<r;i++)if(t[i]===e)return i;return-1}function jE(e,t,n,r){return YE(this.multi,[])}function ZE(e,t,n,r){var i,a=this.multi;if(this.providerFactory){var o=this.providerFactory.componentProviders,s=Jm(n,n[1],this.providerFactory.index,r);YE(a,i=s.slice(0,o));for(var u=o;u<s.length;u++)i.push(s[u])}else YE(a,i=[]);return i}function YE(e,t){for(var n=0;n<e.length;n++)t.push((0,e[n])());return t}function KE(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return function(n){n.providersResolver=function(n,r){return function(e,t,n){var r=qy();if(r.firstCreatePass){var i=py(e);GE(n,r.data,r.blueprint,i,!0),GE(t,r.data,r.blueprint,i,!1)}}(n,r?r(e):e,t)}}}var JE=rp(function e(){tp(this,e)}),QE=function(){function e(){tp(this,e)}return rp(e,[{key:"resolveComponentFactory",value:function(e){throw function(e){var t=Error("No component factory found for ".concat(dg(e),". Did you add it to @NgModule.entryComponents?"));return t.ngComponent=e,t}(e)}}]),e}(),XE=function(){var e=rp(function e(){tp(this,e)});return e.NULL=new QE,e}();function eS(){}function tS(e,t){return new rS(Ry(e,t))}var nS=function(){return tS(Wy(),Gy())},rS=function(){var e=rp(function e(t){tp(this,e),this.nativeElement=t});return e.__NG_ELEMENT_ID__=nS,e}();function iS(e){return e instanceof rS?e.nativeElement:e}var aS=rp(function e(){tp(this,e)}),oS=function(){var e=rp(function e(){tp(this,e)});return e.__NG_ELEMENT_ID__=function(){return sS()},e}(),sS=function(){var e=Gy(),t=Dy(Wy().index,e);return function(e){return e[11]}(ly(t)?t:e)},uS=function(){var e=rp(function e(){tp(this,e)});return e.\u0275prov=Eg({token:e,providedIn:"root",factory:function(){return null}}),e}(),cS=rp(function e(t){tp(this,e),this.full=t,this.major=t.split(".")[0],this.minor=t.split(".")[1],this.patch=t.split(".").slice(2).join(".")}),lS=new cS("12.2.16"),hS=function(){function e(){tp(this,e)}return rp(e,[{key:"supports",value:function(e){return YC(e)}},{key:"create",value:function(e){return new dS(e)}}]),e}(),fS=function(e,t){return t},dS=function(){function e(t){tp(this,e),this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=t||fS}return rp(e,[{key:"forEachItem",value:function(e){var t;for(t=this._itHead;null!==t;t=t._next)e(t)}},{key:"forEachOperation",value:function(e){for(var t=this._itHead,n=this._removalsHead,r=0,i=null;t||n;){var a=!n||t&&t.currentIndex<yS(n,r,i)?t:n,o=yS(a,r,i),s=a.currentIndex;if(a===n)r--,n=n._nextRemoved;else if(t=t._next,null==a.previousIndex)r++;else{i||(i=[]);var u=o-r,c=s-r;if(u!=c){for(var l=0;l<u;l++){var h=l<i.length?i[l]:i[l]=0,f=h+l;c<=f&&f<u&&(i[l]=h+1)}i[a.previousIndex]=c-u}}o!==s&&e(a,o,s)}}},{key:"forEachPreviousItem",value:function(e){var t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)e(t)}},{key:"forEachAddedItem",value:function(e){var t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}},{key:"forEachMovedItem",value:function(e){var t;for(t=this._movesHead;null!==t;t=t._nextMoved)e(t)}},{key:"forEachRemovedItem",value:function(e){var t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}},{key:"forEachIdentityChange",value:function(e){var t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)e(t)}},{key:"diff",value:function(e){if(null==e&&(e=[]),!YC(e))throw new Error("Error trying to diff '".concat(dg(e),"'. Only arrays and iterables are allowed"));return this.check(e)?this:null}},{key:"onDestroy",value:function(){}},{key:"check",value:function(e){var t=this;this._reset();var n,r,i,a=this._itHead,o=!1;if(Array.isArray(e)){this.length=e.length;for(var s=0;s<this.length;s++)r=e[s],i=this._trackByFn(s,r),null!==a&&Object.is(a.trackById,i)?(o&&(a=this._verifyReinsertion(a,r,i,s)),Object.is(a.item,r)||this._addIdentityChange(a,r)):(a=this._mismatch(a,r,i,s),o=!0),a=a._next}else n=0,function(e,t){if(Array.isArray(e))for(var n=0;n<e.length;n++)t(e[n]);else for(var r,i=e[jC()]();!(r=i.next()).done;)t(r.value)}(e,function(e){i=t._trackByFn(n,e),null!==a&&Object.is(a.trackById,i)?(o&&(a=t._verifyReinsertion(a,e,i,n)),Object.is(a.item,e)||t._addIdentityChange(a,e)):(a=t._mismatch(a,e,i,n),o=!0),a=a._next,n++}),this.length=n;return this._truncate(a),this.collection=e,this.isDirty}},{key:"isDirty",get:function(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}},{key:"_reset",value:function(){if(this.isDirty){var e;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}},{key:"_mismatch",value:function(e,t,n,r){var i;return null===e?i=this._itTail:(i=e._prev,this._remove(e)),null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,i,r)):null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(n,r))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,i,r)):e=this._addAfter(new vS(t,n),i,r),e}},{key:"_verifyReinsertion",value:function(e,t,n,r){var i=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null);return null!==i?e=this._reinsertAfter(i,e._prev,r):e.currentIndex!=r&&(e.currentIndex=r,this._addToMoves(e,r)),e}},{key:"_truncate",value:function(e){for(;null!==e;){var t=e._next;this._addToRemovals(this._unlink(e)),e=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}},{key:"_reinsertAfter",value:function(e,t,n){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);var r=e._prevRemoved,i=e._nextRemoved;return null===r?this._removalsHead=i:r._nextRemoved=i,null===i?this._removalsTail=r:i._prevRemoved=r,this._insertAfter(e,t,n),this._addToMoves(e,n),e}},{key:"_moveAfter",value:function(e,t,n){return this._unlink(e),this._insertAfter(e,t,n),this._addToMoves(e,n),e}},{key:"_addAfter",value:function(e,t,n){return this._insertAfter(e,t,n),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}},{key:"_insertAfter",value:function(e,t,n){var r=null===t?this._itHead:t._next;return e._next=r,e._prev=t,null===r?this._itTail=e:r._prev=e,null===t?this._itHead=e:t._next=e,null===this._linkedRecords&&(this._linkedRecords=new gS),this._linkedRecords.put(e),e.currentIndex=n,e}},{key:"_remove",value:function(e){return this._addToRemovals(this._unlink(e))}},{key:"_unlink",value:function(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);var t=e._prev,n=e._next;return null===t?this._itHead=n:t._next=n,null===n?this._itTail=t:n._prev=t,e}},{key:"_addToMoves",value:function(e,t){return e.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}},{key:"_addToRemovals",value:function(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new gS),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}},{key:"_addIdentityChange",value:function(e,t){return e.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}]),e}(),vS=rp(function e(t,n){tp(this,e),this.item=t,this.trackById=n,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}),pS=function(){function e(){tp(this,e),this._head=null,this._tail=null}return rp(e,[{key:"add",value:function(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}},{key:"get",value:function(e,t){var n;for(n=this._head;null!==n;n=n._nextDup)if((null===t||t<=n.currentIndex)&&Object.is(n.trackById,e))return n;return null}},{key:"remove",value:function(e){var t=e._prevDup,n=e._nextDup;return null===t?this._head=n:t._nextDup=n,null===n?this._tail=t:n._prevDup=t,null===this._head}}]),e}(),gS=function(){function e(){tp(this,e),this.map=new Map}return rp(e,[{key:"put",value:function(e){var t=e.trackById,n=this.map.get(t);n||(n=new pS,this.map.set(t,n)),n.add(e)}},{key:"get",value:function(e,t){var n=this.map.get(e);return n?n.get(e,t):null}},{key:"remove",value:function(e){var t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}},{key:"isEmpty",get:function(){return 0===this.map.size}},{key:"clear",value:function(){this.map.clear()}}]),e}();function yS(e,t,n){var r=e.previousIndex;if(null===r)return r;var i=0;return n&&r<n.length&&(i=n[r]),r+t+i}var mS=function(){function e(){tp(this,e)}return rp(e,[{key:"supports",value:function(e){return e instanceof Map||KC(e)}},{key:"create",value:function(){return new kS}}]),e}(),kS=function(){function e(){tp(this,e),this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}return rp(e,[{key:"isDirty",get:function(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}},{key:"forEachItem",value:function(e){var t;for(t=this._mapHead;null!==t;t=t._next)e(t)}},{key:"forEachPreviousItem",value:function(e){var t;for(t=this._previousMapHead;null!==t;t=t._nextPrevious)e(t)}},{key:"forEachChangedItem",value:function(e){var t;for(t=this._changesHead;null!==t;t=t._nextChanged)e(t)}},{key:"forEachAddedItem",value:function(e){var t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}},{key:"forEachRemovedItem",value:function(e){var t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}},{key:"diff",value:function(e){if(e){if(!(e instanceof Map||KC(e)))throw new Error("Error trying to diff '".concat(dg(e),"'. Only maps and objects are allowed"))}else e=new Map;return this.check(e)?this:null}},{key:"onDestroy",value:function(){}},{key:"check",value:function(e){var t=this;this._reset();var n=this._mapHead;if(this._appendAfter=null,this._forEach(e,function(e,r){if(n&&n.key===r)t._maybeAddToChanges(n,e),t._appendAfter=n,n=n._next;else{var i=t._getOrCreateRecordForKey(r,e);n=t._insertBeforeOrAppend(n,i)}}),n){n._prev&&(n._prev._next=null),this._removalsHead=n;for(var r=n;null!==r;r=r._nextRemoved)r===this._mapHead&&(this._mapHead=null),this._records.delete(r.key),r._nextRemoved=r._next,r.previousValue=r.currentValue,r.currentValue=null,r._prev=null,r._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}},{key:"_insertBeforeOrAppend",value:function(e,t){if(e){var n=e._prev;return t._next=e,t._prev=n,e._prev=t,n&&(n._next=t),e===this._mapHead&&(this._mapHead=t),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}},{key:"_getOrCreateRecordForKey",value:function(e,t){if(this._records.has(e)){var n=this._records.get(e);this._maybeAddToChanges(n,t);var r=n._prev,i=n._next;return r&&(r._next=i),i&&(i._prev=r),n._next=null,n._prev=null,n}var a=new _S(e);return this._records.set(e,a),a.currentValue=t,this._addToAdditions(a),a}},{key:"_reset",value:function(){if(this.isDirty){var e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;null!==e;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;null!=e;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}},{key:"_maybeAddToChanges",value:function(e,t){Object.is(t,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=t,this._addToChanges(e))}},{key:"_addToAdditions",value:function(e){null===this._additionsHead?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}},{key:"_addToChanges",value:function(e){null===this._changesHead?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}},{key:"_forEach",value:function(e,t){e instanceof Map?e.forEach(t):Object.keys(e).forEach(function(n){return t(e[n],n)})}}]),e}(),_S=rp(function e(t){tp(this,e),this.key=t,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null});function wS(){return new CS([new hS])}var CS=function(){var e=function(){function e(t){tp(this,e),this.factories=t}return rp(e,[{key:"find",value:function(e){var t=this.factories.find(function(t){return t.supports(e)});if(null!=t)return t;throw new Error("Cannot find a differ supporting object '".concat(e,"' of type '").concat(function(e){return e.name||typeof e}(e),"'"))}}],[{key:"create",value:function(t,n){if(null!=n){var r=n.factories.slice();t=t.concat(r)}return new e(t)}},{key:"extend",value:function(t){return{provide:e,useFactory:function(n){return e.create(t,n||wS())},deps:[[e,new Dk,new Mk]]}}}]),e}();return e.\u0275prov=Eg({token:e,providedIn:"root",factory:wS}),e}();function bS(){return new ES([new mS])}var ES=function(){var e=function(){function e(t){tp(this,e),this.factories=t}return rp(e,[{key:"find",value:function(e){var t=this.factories.find(function(t){return t.supports(e)});if(t)return t;throw new Error("Cannot find a differ supporting object '".concat(e,"'"))}}],[{key:"create",value:function(t,n){if(n){var r=n.factories.slice();t=t.concat(r)}return new e(t)}},{key:"extend",value:function(t){return{provide:e,useFactory:function(n){return e.create(t,n||bS())},deps:[[e,new Dk,new Mk]]}}}]),e}();return e.\u0275prov=Eg({token:e,providedIn:"root",factory:bS}),e}();function SS(e,t,n,r){for(var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];null!==n;){var a=t[n.index];if(null!==a&&r.push(xy(a)),hy(a))for(var o=10;o<a.length;o++){var s=a[o],u=s[1].firstChild;null!==u&&SS(s[1],s,u,r)}var c=n.type;if(8&c)SS(e,t,n.child,r);else if(32&c)for(var l=N_(n,t),h=void 0;h=l();)r.push(h);else if(16&c){var f=ow(t,n);if(Array.isArray(f))r.push.apply(r,Kv(f));else{var d=M_(t[16]);SS(d[1],d,f,r,!0)}}n=i?n.projectionNext:n.next}return r}var PS=function(){function e(t,n){tp(this,e),this._lView=t,this._cdRefInjectingView=n,this._appRef=null,this._attachedToViewContainer=!1}return rp(e,[{key:"rootNodes",get:function(){var e=this._lView,t=e[1];return SS(t,e,t.firstChild,[])}},{key:"context",get:function(){return this._lView[8]},set:function(e){this._lView[8]=e}},{key:"destroyed",get:function(){return 256==(256&this._lView[2])}},{key:"destroy",value:function(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){var e=this._lView[3];if(hy(e)){var t=e[8],n=t?t.indexOf(this):-1;n>-1&&(q_(e,n),fk(t,n))}this._attachedToViewContainer=!1}$_(this._lView[1],this._lView)}},{key:"onDestroy",value:function(e){Zw(this._lView[1],this._lView,null,e)}},{key:"markForCheck",value:function(){dC(this._cdRefInjectingView||this._lView)}},{key:"detach",value:function(){this._lView[2]&=-129}},{key:"reattach",value:function(){this._lView[2]|=128}},{key:"detectChanges",value:function(){vC(this._lView[1],this._lView,this.context)}},{key:"checkNoChanges",value:function(){!function(e,t,n){Xy(!0);try{vC(e,t,n)}finally{Xy(!1)}}(this._lView[1],this._lView,this.context)}},{key:"attachToViewContainerRef",value:function(){if(this._appRef)throw new Error("This view is already attached directly to the ApplicationRef!");this._attachedToViewContainer=!0}},{key:"detachFromAppRef",value:function(){var e;this._appRef=null,lw(this._lView[1],e=this._lView,e[11],2,null,null)}},{key:"attachToAppRef",value:function(e){if(this._attachedToViewContainer)throw new Error("This view is already attached to a ViewContainer!");this._appRef=e}}]),e}(),OS=function(e){Gv(n,e);var t=$v(n);function n(e){var r;return tp(this,n),(r=t.call(this,e))._view=e,r}return rp(n,[{key:"detectChanges",value:function(){pC(this._view)}},{key:"checkNoChanges",value:function(){!function(e){Xy(!0);try{pC(e)}finally{Xy(!1)}}(this._view)}},{key:"context",get:function(){return null}}]),n}(PS),TS=function(e){return function(e,t,n){if(dy(e)&&!n){var r=Dy(e.index,t);return new PS(r,r)}return 47&e.type?new PS(t[16],t):null}(Wy(),Gy(),16==(16&e))},IS=function(){var e=rp(function e(){tp(this,e)});return e.__NG_ELEMENT_ID__=TS,e}(),xS=[new mS],AS=new CS([new hS]),RS=new ES(xS),NS=function(){return LS(Wy(),Gy())},MS=function(){var e=rp(function e(){tp(this,e)});return e.__NG_ELEMENT_ID__=NS,e}(),DS=function(e){Gv(n,e);var t=$v(n);function n(e,r,i){var a;return tp(this,n),(a=t.call(this))._declarationLView=e,a._declarationTContainer=r,a.elementRef=i,a}return rp(n,[{key:"createEmbeddedView",value:function(e){var t=this._declarationTContainer.tViews,n=Dw(this._declarationLView,t,e,16,null,t.declTNode,null,null,null,null);n[17]=this._declarationLView[this._declarationTContainer.index];var r=this._declarationLView[19];return null!==r&&(n[19]=r.createEmbeddedView(t)),Vw(t,n,e),new PS(n)}}]),n}(MS);function LS(e,t){return 4&e.type?new DS(t,e,tS(e,t)):null}var FS=rp(function e(){tp(this,e)}),BS=rp(function e(){tp(this,e)}),VS=function(){return qS(Wy(),Gy())},US=function(){var e=rp(function e(){tp(this,e)});return e.__NG_ELEMENT_ID__=VS,e}(),zS=function(e){Gv(n,e);var t=$v(n);function n(e,r,i){var a;return tp(this,n),(a=t.call(this))._lContainer=e,a._hostTNode=r,a._hostLView=i,a}return rp(n,[{key:"element",get:function(){return tS(this._hostTNode,this._hostLView)}},{key:"injector",get:function(){return new ek(this._hostTNode,this._hostLView)}},{key:"parentInjector",get:function(){var e=Hm(this._hostTNode,this._hostLView);if(Nm(e)){var t=Dm(e,this._hostLView),n=Mm(e);return new ek(t[1].data[n+8],t)}return new ek(null,this._hostLView)}},{key:"clear",value:function(){for(;this.length>0;)this.remove(this.length-1)}},{key:"get",value:function(e){var t=HS(this._lContainer);return null!==t&&t[e]||null}},{key:"length",get:function(){return this._lContainer.length-10}},{key:"createEmbeddedView",value:function(e,t,n){var r=e.createEmbeddedView(t||{});return this.insert(r,n),r}},{key:"createComponent",value:function(e,t,n,r,i){var a=n||this.parentInjector;if(!i&&null==e.ngModule&&a){var o=a.get(FS,null);o&&(i=o)}var s=e.create(a,r,void 0,i);return this.insert(s.hostView,t),s}},{key:"insert",value:function(e,t){var r=e._lView,i=r[1];if(hy(r[3])){var a=this.indexOf(e);if(-1!==a)this.detach(a);else{var o=r[3],s=new n(o,o[6],o[3]);s.detach(s.indexOf(e))}}var u=this._adjustIndex(t),c=this._lContainer;!function(e,t,n,r){var i=10+r,a=n.length;r>0&&(n[i-1][4]=t),r<a-10?(t[4]=n[i],hk(n,10+r,t)):(n.push(t),t[4]=null),t[3]=n;var o=t[17];null!==o&&n!==o&&function(e,t){var n=e[9];t[16]!==t[3][3][16]&&(e[2]=!0),null===n?e[9]=[t]:n.push(t)}(o,t);var s=t[19];null!==s&&s.insertView(e),t[2]|=128}(i,r,c,u);var l=sw(u,c),h=r[11],f=Q_(h,c[7]);return null!==f&&function(e,t,n,r,i,a){r[0]=i,r[6]=t,lw(e,r,n,1,i,a)}(i,c[6],h,r,f,l),e.attachToViewContainerRef(),hk(GS(c),u,e),e}},{key:"move",value:function(e,t){return this.insert(e,t)}},{key:"indexOf",value:function(e){var t=HS(this._lContainer);return null!==t?t.indexOf(e):-1}},{key:"remove",value:function(e){var t=this._adjustIndex(e,-1),n=q_(this._lContainer,t);n&&(fk(GS(this._lContainer),t),$_(n[1],n))}},{key:"detach",value:function(e){var t=this._adjustIndex(e,-1),n=q_(this._lContainer,t);return n&&null!=fk(GS(this._lContainer),t)?new PS(n):null}},{key:"_adjustIndex",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return null!=e?e:this.length+t}}]),n}(US);function HS(e){return e[8]}function GS(e){return e[8]||(e[8]=[])}function qS(e,t){var n,r=t[e.index];if(hy(r))n=r;else{var i;if(8&e.type)i=xy(r);else{var a=t[11];i=a.createComment("");var o=Ry(e,t);Y_(a,Q_(a,o),i,function(e,t){return Ty(e)?e.nextSibling(t):t.nextSibling}(a,o),!1)}t[e.index]=n=uC(r,t,i,e),fC(t,n)}return new zS(n,e,t)}var $S={},WS=function(e){Gv(n,e);var t=$v(n);function n(e){var r;return tp(this,n),(r=t.call(this)).ngModule=e,r}return rp(n,[{key:"resolveComponentFactory",value:function(e){var t=uy(e);return new YS(t,this.ngModule)}}]),n}(XE);function jS(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push({propName:e[n],templateName:n});return t}var ZS=new ok("SCHEDULER_TOKEN",{providedIn:"root",factory:function(){return I_}}),YS=function(e){Gv(n,e);var t=$v(n);function n(e,r){var i;return tp(this,n),(i=t.call(this)).componentDef=e,i.ngModule=r,i.componentType=e.type,i.selector=e.selectors.map(Ew).join(","),i.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],i.isBoundToModule=!!r,i}return rp(n,[{key:"inputs",get:function(){return jS(this.componentDef.inputs)}},{key:"outputs",get:function(){return jS(this.componentDef.outputs)}},{key:"create",value:function(e,t,n,r){var i,a,o=(r=r||this.ngModule)?function(e,t){return{get:function(n,r,i){var a=e.get(n,$S,i);return a!==$S||r===$S?a:t.get(n,r,i)}}}(e,r.injector):e,s=o.get(aS,Iy),u=o.get(uS,null),c=s.createRenderer(null,this.componentDef),l=this.componentDef.selectors[0][0]||"div",h=n?function(e,t,n){if(Ty(e))return e.selectRootElement(t,n===Vg.ShadowDom);var r="string"==typeof t?e.querySelector(t):t;return r.textContent="",r}(c,n,this.componentDef.encapsulation):H_(s.createRenderer(null,this.componentDef),l,function(e){var t=e.toLowerCase();return"svg"===t?Py:"math"===t?"http://www.w3.org/1998/MathML/":null}(l)),f=this.componentDef.onPush?576:528,d={components:[],scheduler:I_,clean:yC,playerHandler:null,flags:0},v=jw(0,null,null,1,0,null,null,null,null,null),p=Dw(null,v,d,f,null,null,s,c,u,o);hm(p);try{var g=function(e,t,n,r,i,a){var o=n[1];n[20]=e;var s=Lw(o,20,2,"#host",null),u=s.mergedAttrs=t.hostAttrs;null!==u&&(bC(s,u,!0),null!==e&&(Tm(i,e,u),null!==s.classes&&dw(i,e,s.classes),null!==s.styles&&fw(i,e,s.styles)));var c=r.createRenderer(e,t),l=Dw(n,Ww(t),null,t.onPush?64:16,n[20],s,r,c,null,null);return o.firstCreatePass&&(Gm(Vm(s,n),o,t.type),eC(o,s),nC(s,n.length,1)),fC(n,l),n[20]=l}(h,this.componentDef,p,s,c);if(h)if(n)Tm(c,h,["ng-version",lS.full]);else{var y=function(e){for(var t=[],n=[],r=1,i=2;r<e.length;){var a=e[r];if("string"==typeof a)2===i?""!==a&&t.push(a,e[++r]):8===i&&n.push(a);else{if(!_w(i))break;i=a}r++}return{attrs:t,classes:n}}(this.componentDef.selectors[0]),m=y.attrs,k=y.classes;m&&Tm(c,h,m),k&&k.length>0&&dw(c,h,k.join(" "))}if(a=Ny(v,20),void 0!==t)for(var _=a.projection=[],w=0;w<this.ngContentSelectors.length;w++){var C=t[w];_.push(null!=C?Array.from(C):null)}i=function(e,t,n,r,i){var a=n[1],o=function(e,t,n){var r=Wy();e.firstCreatePass&&(n.providersResolver&&n.providersResolver(n),rC(e,r,t,Bw(e,t,1,null),n));var i=Jm(t,e,r.directiveStart,r);C_(i,t);var a=Ry(r,t);return a&&C_(a,t),i}(a,n,t);if(r.components.push(o),e[8]=o,i&&i.forEach(function(e){return e(o,t)}),t.contentQueries){var s=Wy();t.contentQueries(1,o,s.directiveStart)}var u=Wy();return!a.firstCreatePass||null===t.hostBindings&&null===t.hostAttrs||(mm(u.index),Qw(n[1],u,0,u.directiveStart,u.directiveEnd,t),Xw(t,o)),o}(g,this.componentDef,p,d,[UC]),Vw(v,p,null)}finally{gm()}return new KS(this.componentType,i,tS(a,p),p,a)}}]),n}(JE),KS=function(e){Gv(n,e);var t=$v(n);function n(e,r,i,a,o){var s;return tp(this,n),(s=t.call(this)).location=i,s._rootLView=a,s._tNode=o,s.instance=r,s.hostView=s.changeDetectorRef=new OS(a),s.componentType=e,s}return rp(n,[{key:"injector",get:function(){return new ek(this._tNode,this._rootLView)}},{key:"destroy",value:function(){this.hostView.destroy()}},{key:"onDestroy",value:function(e){this.hostView.onDestroy(e)}}]),n}(function(){return rp(function e(){tp(this,e)})}()),JS=new Map,QS=function(e){Gv(n,e);var t=$v(n);function n(e,r){var i;tp(this,n),(i=t.call(this))._parent=r,i._bootstrapComponents=[],i.injector=jv(i),i.destroyCbs=[],i.componentFactoryResolver=new WS(jv(i));var a=cy(e),o=e[Kg]||null;return o&&Jb(o),i._bootstrapComponents=x_(a.bootstrap),i._r3Injector=AC(e,r,[{provide:FS,useValue:jv(i)},{provide:XE,useValue:i.componentFactoryResolver}],dg(e)),i._r3Injector._resolveInjectorDefTypes(),i.instance=i.get(e),i}return rp(n,[{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:VC.THROW_IF_NOT_FOUND,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Mg.Default;return e===VC||e===FS||e===SC?this:this._r3Injector.get(e,t,n)}},{key:"destroy",value:function(){var e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(function(e){return e()}),this.destroyCbs=null}},{key:"onDestroy",value:function(e){this.destroyCbs.push(e)}}]),n}(FS),XS=function(e){Gv(n,e);var t=$v(n);function n(e){var r;return tp(this,n),(r=t.call(this)).moduleType=e,null!==cy(e)&&function(e){var t=new Set;!function e(n){var r=cy(n,!0),i=r.id;null!==i&&(function(e,t,n){if(t&&t!==n)throw new Error("Duplicate module registered for ".concat(e," - ").concat(dg(t)," vs ").concat(dg(t.name)))}(i,JS.get(i),n),JS.set(i,n));var a,o=Qv(x_(r.imports));try{for(o.s();!(a=o.n()).done;){var s=a.value;t.has(s)||(t.add(s),e(s))}}catch(u){o.e(u)}finally{o.f()}}(e)}(e),r}return rp(n,[{key:"create",value:function(e){return new QS(this.moduleType,e)}}]),n}(BS);function eP(e,t,n){var r=em()+e,i=Gy();return i[r]===Sw?JC(i,r,n?t.call(n):t()):function(e,t){return e[t]}(i,r)}function tP(e,t,n,r){return iP(Gy(),em(),e,t,n,r)}function nP(e,t,n,r,i){return aP(Gy(),em(),e,t,n,r,i)}function rP(e,t){var n=e[t];return n===Sw?void 0:n}function iP(e,t,n,r,i,a){var o=t+n;return QC(e,o,i)?JC(e,o+1,a?r.call(a,i):r(i)):rP(e,o+1)}function aP(e,t,n,r,i,a,o){var s=t+n;return XC(e,s,i,a)?JC(e,s+2,o?r.call(o,i,a):r(i,a)):rP(e,s+2)}function oP(e,t){var n,r=qy(),i=e+20;r.firstCreatePass?(n=function(e,t){if(t)for(var n=t.length-1;n>=0;n--){var r=t[n];if(e===r.name)return r}throw new kg("302","The pipe '".concat(e,"' could not be found!"))}(t,r.pipeRegistry),r.data[i]=n,n.onDestroy&&(r.destroyHooks||(r.destroyHooks=[])).push(i,n.onDestroy)):n=r.data[i];var a=n.factory||(n.factory=yy(n.type)),o=Dg(sb);try{var s=Fm(!1),u=a();return Fm(s),function(e,t,n,r){n>=e.data.length&&(e.data[n]=null,e.blueprint[n]=null),t[n]=r}(r,Gy(),i,u),u}finally{Dg(o)}}function sP(e,t,n){var r=e+20,i=Gy(),a=My(i,r);return cP(i,uP(i,r)?iP(i,em(),t,a.transform,n,a):a.transform(n))}function uP(e,t){return e[1].data[t].pure}function cP(e,t){return ZC.isWrapped(t)&&(t=ZC.unwrap(t),e[tm()]=Sw),t}function lP(e){return function(t){setTimeout(e,void 0,t)}}var hP=function(e){Gv(n,e);var t=$v(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return tp(this,n),(e=t.call(this)).__isAsync=r,e}return rp(n,[{key:"emit",value:function(e){zv(Yv(n.prototype),"next",this).call(this,e)}},{key:"subscribe",value:function(e,t,r){var i,a,o,s=e,u=t||function(){return null},c=r;if(e&&"object"==typeof e){var l=e;s=null===(i=l.next)||void 0===i?void 0:i.bind(l),u=null===(a=l.error)||void 0===a?void 0:a.bind(l),c=null===(o=l.complete)||void 0===o?void 0:o.bind(l)}this.__isAsync&&(u=lP(u),s&&(s=lP(s)),c&&(c=lP(c)));var h=zv(Yv(n.prototype),"subscribe",this).call(this,{next:s,error:u,complete:c});return e instanceof ip&&e.add(h),h}}]),n}(Ap);function fP(){return this._results[jC()]()}var dP=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];tp(this,e),this._emitDistinctChangesOnly=t,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;var n=jC(),r=e.prototype;r[n]||(r[n]=fP)}return rp(e,[{key:"changes",get:function(){return this._changes||(this._changes=new hP)}},{key:"get",value:function(e){return this._results[e]}},{key:"map",value:function(e){return this._results.map(e)}},{key:"filter",value:function(e){return this._results.filter(e)}},{key:"find",value:function(e){return this._results.find(e)}},{key:"reduce",value:function(e,t){return this._results.reduce(e,t)}},{key:"forEach",value:function(e){this._results.forEach(e)}},{key:"some",value:function(e){return this._results.some(e)}},{key:"toArray",value:function(){return this._results.slice()}},{key:"toString",value:function(){return this._results.toString()}},{key:"reset",value:function(e,t){var n=this;n.dirty=!1;var r=ck(e);(this._changesDetected=!function(e,t,n){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++){var i=e[r],a=t[r];if(n&&(i=n(i),a=n(a)),a!==i)return!1}return!0}(n._results,r,t))&&(n._results=r,n.length=r.length,n.last=r[this.length-1],n.first=r[0])}},{key:"notifyOnChanges",value:function(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}},{key:"setDirty",value:function(){this.dirty=!0}},{key:"destroy",value:function(){this.changes.complete(),this.changes.unsubscribe()}}]),e}();Symbol;var vP=function(){function e(t){tp(this,e),this.queryList=t,this.matches=null}return rp(e,[{key:"clone",value:function(){return new e(this.queryList)}},{key:"setDirty",value:function(){this.queryList.setDirty()}}]),e}(),pP=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];tp(this,e),this.queries=t}return rp(e,[{key:"createEmbeddedView",value:function(t){var n=t.queries;if(null!==n){for(var r=null!==t.contentQueries?t.contentQueries[0]:n.length,i=[],a=0;a<r;a++){var o=n.getByIndex(a);i.push(this.queries[o.indexInDeclarationView].clone())}return new e(i)}return null}},{key:"insertView",value:function(e){this.dirtyQueriesWithMatches(e)}},{key:"detachView",value:function(e){this.dirtyQueriesWithMatches(e)}},{key:"dirtyQueriesWithMatches",value:function(e){for(var t=0;t<this.queries.length;t++)null!==PP(e,t).matches&&this.queries[t].setDirty()}}]),e}(),gP=rp(function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;tp(this,e),this.predicate=t,this.flags=n,this.read=r}),yP=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];tp(this,e),this.queries=t}return rp(e,[{key:"elementStart",value:function(e,t){for(var n=0;n<this.queries.length;n++)this.queries[n].elementStart(e,t)}},{key:"elementEnd",value:function(e){for(var t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}},{key:"embeddedTView",value:function(t){for(var n=null,r=0;r<this.length;r++){var i=null!==n?n.length:0,a=this.getByIndex(r).embeddedTView(t,i);a&&(a.indexInDeclarationView=r,null!==n?n.push(a):n=[a])}return null!==n?new e(n):null}},{key:"template",value:function(e,t){for(var n=0;n<this.queries.length;n++)this.queries[n].template(e,t)}},{key:"getByIndex",value:function(e){return this.queries[e]}},{key:"length",get:function(){return this.queries.length}},{key:"track",value:function(e){this.queries.push(e)}}]),e}(),mP=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;tp(this,e),this.metadata=t,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=n}return rp(e,[{key:"elementStart",value:function(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}},{key:"elementEnd",value:function(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}},{key:"template",value:function(e,t){this.elementStart(e,t)}},{key:"embeddedTView",value:function(t,n){return this.isApplyingToNode(t)?(this.crossesNgTemplate=!0,this.addMatch(-t.index,n),new e(this.metadata)):null}},{key:"isApplyingToNode",value:function(e){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){for(var t=this._declarationNodeIndex,n=e.parent;null!==n&&8&n.type&&n.index!==t;)n=n.parent;return t===(null!==n?n.index:-1)}return this._appliesToNextNode}},{key:"matchTNode",value:function(e,t){var n=this.metadata.predicate;if(Array.isArray(n))for(var r=0;r<n.length;r++){var i=n[r];this.matchTNodeWithReadOption(e,t,kP(t,i)),this.matchTNodeWithReadOption(e,t,Km(t,e,i,!1,!1))}else n===MS?4&t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,Km(t,e,n,!1,!1))}},{key:"matchTNodeWithReadOption",value:function(e,t,n){if(null!==n){var r=this.metadata.read;if(null!==r)if(r===rS||r===US||r===MS&&4&t.type)this.addMatch(t.index,-2);else{var i=Km(t,e,r,!1,!1);null!==i&&this.addMatch(t.index,i)}else this.addMatch(t.index,n)}}},{key:"addMatch",value:function(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}]),e}();function kP(e,t){var n=e.localNames;if(null!==n)for(var r=0;r<n.length;r+=2)if(n[r]===t)return n[r+1];return null}function _P(e,t,n,r){return-1===n?function(e,t){return 11&e.type?tS(e,t):4&e.type?LS(e,t):null}(t,e):-2===n?function(e,t,n){return n===rS?tS(t,e):n===MS?LS(t,e):n===US?qS(t,e):void 0}(e,t,r):Jm(e,e[1],n,t)}function wP(e,t,n,r){var i=t[19].queries[r];if(null===i.matches){for(var a=e.data,o=n.matches,s=[],u=0;u<o.length;u+=2){var c=o[u];s.push(c<0?null:_P(t,a[c],o[u+1],n.metadata.read))}i.matches=s}return i.matches}function CP(e,t,n,r){var i=e.queries.getByIndex(n),a=i.matches;if(null!==a)for(var o=wP(e,t,i,n),s=0;s<a.length;s+=2){var u=a[s];if(u>0)r.push(o[s/2]);else{for(var c=a[s+1],l=t[-u],h=10;h<l.length;h++){var f=l[h];f[17]===f[3]&&CP(f[1],f,c,r)}if(null!==l[9])for(var d=l[9],v=0;v<d.length;v++){var p=d[v];CP(p[1],p,c,r)}}}return r}function bP(e){var t=Gy(),n=qy(),r=sm();um(r+1);var i=PP(n,r);if(e.dirty&&Ly(t)===(2==(2&i.metadata.flags))){if(null===i.matches)e.reset([]);else{var a=i.crossesNgTemplate?CP(n,t,r,[]):wP(n,t,i,r);e.reset(a,iS),e.notifyOnChanges()}return!0}return!1}function EP(e,t,n){var r=qy();r.firstCreatePass&&(function(e,t,n){null===e.queries&&(e.queries=new yP),e.queries.track(new mP(t,-1))}(r,new gP(e,t,n)),2==(2&t)&&(r.staticViewQueries=!0)),function(e,t,n){var r=new dP(4==(4&n));Zw(e,t,r,r.destroy),null===t[19]&&(t[19]=new pP),t[19].queries.push(new vP(r))}(r,Gy(),t)}function SP(){return e=Gy(),t=sm(),e[19].queries[t].queryList;var e,t}function PP(e,t){return e.queries.getByIndex(t)}function OP(e,t){return LS(e,t)}var TP=new ok("Application Initializer"),IP=function(){var e=function(){function e(t){var n=this;tp(this,e),this.appInits=t,this.resolve=eS,this.reject=eS,this.initialized=!1,this.done=!1,this.donePromise=new Promise(function(e,t){n.resolve=e,n.reject=t})}return rp(e,[{key:"runInitializers",value:function(){var e=this;if(!this.initialized){var t=[],n=function(){e.done=!0,e.resolve()};if(this.appInits)for(var r=function(n){var r=e.appInits[n]();if(gb(r))t.push(r);else if(yb(r)){var i=new Promise(function(e,t){r.subscribe({complete:e,error:t})});t.push(i)}},i=0;i<this.appInits.length;i++)r(i);Promise.all(t).then(function(){n()}).catch(function(t){e.reject(t)}),0===t.length&&n(),this.initialized=!0}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Pk(TP,8))},e.\u0275prov=Eg({token:e,factory:e.\u0275fac}),e}(),xP=new ok("AppId"),AP={provide:xP,useFactory:function(){return"".concat(RP()).concat(RP()).concat(RP())},deps:[]};function RP(){return String.fromCharCode(97+Math.floor(25*Math.random()))}var NP=new ok("Platform Initializer"),MP=new ok("Platform ID"),DP=new ok("appBootstrapListener"),LP=function(){var e=function(){function e(){tp(this,e)}return rp(e,[{key:"log",value:function(e){console.log(e)}},{key:"warn",value:function(e){console.warn(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Eg({token:e,factory:e.\u0275fac}),e}(),FP=new ok("LocaleId"),BP=new ok("DefaultCurrencyCode"),VP=rp(function e(t,n){tp(this,e),this.ngModuleFactory=t,this.componentFactories=n}),UP=function(e){return new XS(e)},zP=UP,HP=function(e){return Promise.resolve(UP(e))},GP=function(e){var t=UP(e),n=x_(cy(e).declarations).reduce(function(e,t){var n=uy(t);return n&&e.push(new YS(n)),e},[]);return new VP(t,n)},qP=GP,$P=function(e){return Promise.resolve(GP(e))},WP=function(){var e=function(){function e(){tp(this,e),this.compileModuleSync=zP,this.compileModuleAsync=HP,this.compileModuleAndAllComponentsSync=qP,this.compileModuleAndAllComponentsAsync=$P}return rp(e,[{key:"clearCache",value:function(){}},{key:"clearCacheFor",value:function(e){}},{key:"getModuleId",value:function(e){}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Eg({token:e,factory:e.\u0275fac}),e}(),jP=Promise.resolve(0);function ZP(e){"undefined"==typeof Zone?jP.then(function(){e&&e.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",e)}var YP=function(){function e(t){var n=t.enableLongStackTrace,r=void 0!==n&&n,i=t.shouldCoalesceEventChangeDetection,a=void 0!==i&&i,o=t.shouldCoalesceRunChangeDetection,s=void 0!==o&&o;if(tp(this,e),this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new hP(!1),this.onMicrotaskEmpty=new hP(!1),this.onStable=new hP(!1),this.onError=new hP(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();var u=this;u._nesting=0,u._outer=u._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(u._inner=u._inner.fork(new Zone.TaskTrackingZoneSpec)),r&&Zone.longStackTraceZoneSpec&&(u._inner=u._inner.fork(Zone.longStackTraceZoneSpec)),u.shouldCoalesceEventChangeDetection=!s&&a,u.shouldCoalesceRunChangeDetection=s,u.lastRequestAnimationFrameId=-1,u.nativeRequestAnimationFrame=function(){var e=Gg.requestAnimationFrame,t=Gg.cancelAnimationFrame;if("undefined"!=typeof Zone&&e&&t){var n=e[Zone.__symbol__("OriginalDelegate")];n&&(e=n);var r=t[Zone.__symbol__("OriginalDelegate")];r&&(t=r)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,function(e){var t=function(){!function(e){e.isCheckStableRunning||-1!==e.lastRequestAnimationFrameId||(e.lastRequestAnimationFrameId=e.nativeRequestAnimationFrame.call(Gg,function(){e.fakeTopEventTask||(e.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",function(){e.lastRequestAnimationFrameId=-1,QP(e),e.isCheckStableRunning=!0,JP(e),e.isCheckStableRunning=!1},void 0,function(){},function(){})),e.fakeTopEventTask.invoke()}),QP(e))}(e)};e._inner=e._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:function(n,r,i,a,o,s){try{return XP(e),n.invokeTask(i,a,o,s)}finally{(e.shouldCoalesceEventChangeDetection&&"eventTask"===a.type||e.shouldCoalesceRunChangeDetection)&&t(),eO(e)}},onInvoke:function(n,r,i,a,o,s,u){try{return XP(e),n.invoke(i,a,o,s,u)}finally{e.shouldCoalesceRunChangeDetection&&t(),eO(e)}},onHasTask:function(t,n,r,i){t.hasTask(r,i),n===r&&("microTask"==i.change?(e._hasPendingMicrotasks=i.microTask,QP(e),JP(e)):"macroTask"==i.change&&(e.hasPendingMacrotasks=i.macroTask))},onHandleError:function(t,n,r,i){return t.handleError(r,i),e.runOutsideAngular(function(){return e.onError.emit(i)}),!1}})}(u)}return rp(e,[{key:"run",value:function(e,t,n){return this._inner.run(e,t,n)}},{key:"runTask",value:function(e,t,n,r){var i=this._inner,a=i.scheduleEventTask("NgZoneEvent: "+r,e,KP,eS,eS);try{return i.runTask(a,t,n)}finally{i.cancelTask(a)}}},{key:"runGuarded",value:function(e,t,n){return this._inner.runGuarded(e,t,n)}},{key:"runOutsideAngular",value:function(e){return this._outer.run(e)}}],[{key:"isInAngularZone",value:function(){return!0===Zone.current.get("isAngularZone")}},{key:"assertInAngularZone",value:function(){if(!e.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}},{key:"assertNotInAngularZone",value:function(){if(e.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}}]),e}(),KP={};function JP(e){if(0==e._nesting&&!e.hasPendingMicrotasks&&!e.isStable)try{e._nesting++,e.onMicrotaskEmpty.emit(null)}finally{if(e._nesting--,!e.hasPendingMicrotasks)try{e.runOutsideAngular(function(){return e.onStable.emit(null)})}finally{e.isStable=!0}}}function QP(e){e.hasPendingMicrotasks=!!(e._hasPendingMicrotasks||(e.shouldCoalesceEventChangeDetection||e.shouldCoalesceRunChangeDetection)&&-1!==e.lastRequestAnimationFrameId)}function XP(e){e._nesting++,e.isStable&&(e.isStable=!1,e.onUnstable.emit(null))}function eO(e){e._nesting--,JP(e)}var tO,nO=function(){function e(){tp(this,e),this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new hP,this.onMicrotaskEmpty=new hP,this.onStable=new hP,this.onError=new hP}return rp(e,[{key:"run",value:function(e,t,n){return e.apply(t,n)}},{key:"runGuarded",value:function(e,t,n){return e.apply(t,n)}},{key:"runOutsideAngular",value:function(e){return e()}},{key:"runTask",value:function(e,t,n,r){return e.apply(t,n)}}]),e}(),rO=function(){var e=function(){function e(t){var n=this;tp(this,e),this._ngZone=t,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),t.run(function(){n.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}return rp(e,[{key:"_watchAngularEvents",value:function(){var e=this;this._ngZone.onUnstable.subscribe({next:function(){e._didWork=!0,e._isZoneStable=!1}}),this._ngZone.runOutsideAngular(function(){e._ngZone.onStable.subscribe({next:function(){YP.assertNotInAngularZone(),ZP(function(){e._isZoneStable=!0,e._runCallbacksIfReady()})}})})}},{key:"increasePendingRequestCount",value:function(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}},{key:"decreasePendingRequestCount",value:function(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}},{key:"isStable",value:function(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}},{key:"_runCallbacksIfReady",value:function(){var e=this;if(this.isStable())ZP(function(){for(;0!==e._callbacks.length;){var t=e._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(e._didWork)}e._didWork=!1});else{var t=this.getPendingTasks();this._callbacks=this._callbacks.filter(function(e){return!e.updateCb||!e.updateCb(t)||(clearTimeout(e.timeoutId),!1)}),this._didWork=!0}}},{key:"getPendingTasks",value:function(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(function(e){return{source:e.source,creationLocation:e.creationLocation,data:e.data}}):[]}},{key:"addCallback",value:function(e,t,n){var r=this,i=-1;t&&t>0&&(i=setTimeout(function(){r._callbacks=r._callbacks.filter(function(e){return e.timeoutId!==i}),e(r._didWork,r.getPendingTasks())},t)),this._callbacks.push({doneCb:e,timeoutId:i,updateCb:n})}},{key:"whenStable",value:function(e,t,n){if(n&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(e,t,n),this._runCallbacksIfReady()}},{key:"getPendingRequestCount",value:function(){return this._pendingCount}},{key:"findProviders",value:function(e,t,n){return[]}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Pk(YP))},e.\u0275prov=Eg({token:e,factory:e.\u0275fac}),e}(),iO=function(){var e=function(){function e(){tp(this,e),this._applications=new Map,aO.addToWindow(this)}return rp(e,[{key:"registerApplication",value:function(e,t){this._applications.set(e,t)}},{key:"unregisterApplication",value:function(e){this._applications.delete(e)}},{key:"unregisterAllApplications",value:function(){this._applications.clear()}},{key:"getTestability",value:function(e){return this._applications.get(e)||null}},{key:"getAllTestabilities",value:function(){return Array.from(this._applications.values())}},{key:"getAllRootElements",value:function(){return Array.from(this._applications.keys())}},{key:"findTestabilityInTree",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return aO.findTestabilityInTree(this,e,t)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Eg({token:e,factory:e.\u0275fac}),e}(),aO=new(function(){function e(){tp(this,e)}return rp(e,[{key:"addToWindow",value:function(e){}},{key:"findTestabilityInTree",value:function(e,t,n){return null}}]),e}()),oO=!0,sO=!1,uO=new ok("AllowMultipleToken"),cO=rp(function e(t,n){tp(this,e),this.name=t,this.token=n});function lO(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r="Platform: ".concat(t),i=new ok(r);return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],a=hO();if(!a||a.injector.get(uO,!1))if(e)e(n.concat(t).concat({provide:i,useValue:!0}));else{var o=n.concat(t).concat({provide:i,useValue:!0},{provide:OC,useValue:"platform"});!function(e){if(tO&&!tO.destroyed&&!tO.injector.get(uO,!1))throw new Error("There can be only one platform. Destroy the previous one to create a new one.");tO=e.get(fO);var t=e.get(NP,null);t&&t.forEach(function(e){return e()})}(VC.create({providers:o,name:r}))}return function(e){var t=hO();if(!t)throw new Error("No platform exists!");if(!t.injector.get(e,null))throw new Error("A platform with a different configuration has been created. Please destroy it first.");return t}(i)}}function hO(){return tO&&!tO.destroyed?tO:null}var fO=function(){var e=function(){function e(t){tp(this,e),this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}return rp(e,[{key:"bootstrapModuleFactory",value:function(e,t){var n=this,r=function(e,t){return"noop"===e?new nO:("zone.js"===e?void 0:e)||new YP({enableLongStackTrace:(sO=!0,oO),shouldCoalesceEventChangeDetection:!!(null==t?void 0:t.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==t?void 0:t.ngZoneRunCoalescing)})}(t?t.ngZone:void 0,{ngZoneEventCoalescing:t&&t.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:t&&t.ngZoneRunCoalescing||!1}),i=[{provide:YP,useValue:r}];return r.run(function(){var a=VC.create({providers:i,parent:n.injector,name:e.moduleType.name}),o=e.create(a),s=o.injector.get(P_,null);if(!s)throw new Error("No ErrorHandler. Is platform module (BrowserModule) included?");return r.runOutsideAngular(function(){var e=r.onError.subscribe({next:function(e){s.handleError(e)}});o.onDestroy(function(){pO(n._modules,o),e.unsubscribe()})}),function(e,r,i){try{var a=((s=o.injector.get(IP)).runInitializers(),s.donePromise.then(function(){return Jb(o.injector.get(FP,Wb)||Wb),n._moduleDoBootstrap(o),o}));return gb(a)?a.catch(function(t){throw r.runOutsideAngular(function(){return e.handleError(t)}),t}):a}catch(t){throw r.runOutsideAngular(function(){return e.handleError(t)}),t}var s}(s,r)})}},{key:"bootstrapModule",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=dO({},n);return function(e,t,n){var r=new XS(n);return Promise.resolve(r)}(0,0,e).then(function(e){return t.bootstrapModuleFactory(e,r)})}},{key:"_moduleDoBootstrap",value:function(e){var t=e.injector.get(vO);if(e._bootstrapComponents.length>0)e._bootstrapComponents.forEach(function(e){return t.bootstrap(e)});else{if(!e.instance.ngDoBootstrap)throw new Error("The module ".concat(dg(e.instance.constructor),' was bootstrapped, but it does not declare "@NgModule.bootstrap" components nor a "ngDoBootstrap" method. Please define one of these.'));e.instance.ngDoBootstrap(t)}this._modules.push(e)}},{key:"onDestroy",value:function(e){this._destroyListeners.push(e)}},{key:"injector",get:function(){return this._injector}},{key:"destroy",value:function(){if(this._destroyed)throw new Error("The platform has already been destroyed!");this._modules.slice().forEach(function(e){return e.destroy()}),this._destroyListeners.forEach(function(e){return e()}),this._destroyed=!0}},{key:"destroyed",get:function(){return this._destroyed}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Pk(VC))},e.\u0275prov=Eg({token:e,factory:e.\u0275fac}),e}();function dO(e,t){return Array.isArray(t)?t.reduce(dO,e):Object.assign(Object.assign({},e),t)}var vO=function(){var e=function(){function e(t,n,r,i,a){var o=this;tp(this,e),this._zone=t,this._injector=n,this._exceptionHandler=r,this._componentFactoryResolver=i,this._initStatus=a,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:function(){o._zone.run(function(){o.tick()})}});var s=new Tp(function(e){o._stable=o._zone.isStable&&!o._zone.hasPendingMacrotasks&&!o._zone.hasPendingMicrotasks,o._zone.runOutsideAngular(function(){e.next(o._stable),e.complete()})}),u=new Tp(function(e){var t;o._zone.runOutsideAngular(function(){t=o._zone.onStable.subscribe(function(){YP.assertNotInAngularZone(),ZP(function(){!o._stable&&!o._zone.hasPendingMacrotasks&&!o._zone.hasPendingMicrotasks&&(o._stable=!0,e.next(!0))})})});var n=o._zone.onUnstable.subscribe(function(){YP.assertInAngularZone(),o._stable&&(o._stable=!1,o._zone.runOutsideAngular(function(){e.next(!1)}))});return function(){t.unsubscribe(),n.unsubscribe()}});this.isStable=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=ig(t),i=function(e,t){return"number"==typeof ng(e)?e.pop():1/0}(t),a=t;return a.length?1===a.length?Kp(a[0]):eg(i)(ug(a,r)):tg}(s,u.pipe(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.connector,n=void 0===t?function(){return new Ap}:t,r=e.resetOnError,i=void 0===r||r,a=e.resetOnComplete,o=void 0===a||a,s=e.resetOnRefCountZero,u=void 0===s||s;return function(e){var t=null,r=null,a=null,s=0,c=!1,l=!1,h=function(){null==r||r.unsubscribe(),r=null},f=function(){h(),t=a=null,c=l=!1},d=function(){var e=t;f(),null==e||e.unsubscribe()};return Mp(function(e,v){var p;s++,!l&&!c&&h();var g=a=null!==(p=a)&&void 0!==p?p:n();v.add(function(){0===--s&&!l&&!c&&(r=lg(d,u))}),g.subscribe(v),t||(t=new wp({next:function(e){return g.next(e)},error:function(e){l=!0,h(),r=lg(f,i,e),g.error(e)},complete:function(){c=!0,h(),r=lg(f,o),g.complete()}}),ug(e).subscribe(t))})(e)}}()))}return rp(e,[{key:"bootstrap",value:function(e,t){var n,r=this;if(!this._initStatus.done)throw new Error("Cannot bootstrap as there are still asynchronous initializers running. Bootstrap components in the `ngDoBootstrap` method of the root module.");n=e instanceof JE?e:this._componentFactoryResolver.resolveComponentFactory(e),this.componentTypes.push(n.componentType);var i=function(e){return e.isBoundToModule}(n)?void 0:this._injector.get(FS),a=n.create(VC.NULL,[],t||n.selector,i),o=a.location.nativeElement,s=a.injector.get(rO,null),u=s&&a.injector.get(iO);return s&&u&&u.registerApplication(o,s),a.onDestroy(function(){r.detachView(a.hostView),pO(r.components,a),u&&u.unregisterApplication(o)}),this._loadComponent(a),a}},{key:"tick",value:function(){var e=this;if(this._runningTick)throw new Error("ApplicationRef.tick is called recursively");try{this._runningTick=!0;var t,n=Qv(this._views);try{for(n.s();!(t=n.n()).done;){var r;t.value.detectChanges()}}catch(i){n.e(i)}finally{n.f()}}catch(r){this._zone.runOutsideAngular(function(){return e._exceptionHandler.handleError(r)})}finally{this._runningTick=!1}}},{key:"attachView",value:function(e){var t=e;this._views.push(t),t.attachToAppRef(this)}},{key:"detachView",value:function(e){var t=e;pO(this._views,t),t.detachFromAppRef()}},{key:"_loadComponent",value:function(e){this.attachView(e.hostView),this.tick(),this.components.push(e),this._injector.get(DP,[]).concat(this._bootstrapListeners).forEach(function(t){return t(e)})}},{key:"ngOnDestroy",value:function(){this._views.slice().forEach(function(e){return e.destroy()}),this._onMicrotaskEmptySubscription.unsubscribe()}},{key:"viewCount",get:function(){return this._views.length}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Pk(YP),Pk(VC),Pk(P_),Pk(XE),Pk(IP))},e.\u0275prov=Eg({token:e,factory:e.\u0275fac}),e}();function pO(e,t){var n=e.indexOf(t);n>-1&&e.splice(n,1)}var gO=rp(function e(){tp(this,e)}),yO=rp(function e(){tp(this,e)}),mO={factoryPathPrefix:"",factoryPathSuffix:".ngfactory"},kO=function(){var e=function(){function e(t,n){tp(this,e),this._compiler=t,this._config=n||mO}return rp(e,[{key:"load",value:function(e){return this.loadAndCompile(e)}},{key:"loadAndCompile",value:function(e){var t=this,n=Lv(e.split("#"),2),r=n[0],i=n[1];return void 0===i&&(i="default"),Bv(8255)(r).then(function(e){return e[i]}).then(function(e){return _O(e,r,i)}).then(function(e){return t._compiler.compileModuleAsync(e)})}},{key:"loadFactory",value:function(e){var t=Lv(e.split("#"),2),n=t[0],r=t[1],i="NgFactory";return void 0===r&&(r="default",i=""),Bv(8255)(this._config.factoryPathPrefix+n+this._config.factoryPathSuffix).then(function(e){return e[r+i]}).then(function(e){return _O(e,n,r)})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Pk(WP),Pk(yO,8))},e.\u0275prov=Eg({token:e,factory:e.\u0275fac}),e}();function _O(e,t,n){if(!e)throw new Error("Cannot find '".concat(n,"' in '").concat(t,"'"));return e}var wO=lO(null,"core",[{provide:MP,useValue:"unknown"},{provide:fO,deps:[VC]},{provide:iO,deps:[]},{provide:LP,deps:[]}]),CO=[{provide:vO,useClass:vO,deps:[YP,VC,P_,XE,IP]},{provide:ZS,deps:[YP],useFactory:function(e){var t=[];return e.onStable.subscribe(function(){for(;t.length;)t.pop()()}),function(e){t.push(e)}}},{provide:IP,useClass:IP,deps:[[new Mk,TP]]},{provide:WP,useClass:WP,deps:[]},AP,{provide:CS,useFactory:function(){return AS},deps:[]},{provide:ES,useFactory:function(){return RS},deps:[]},{provide:FP,useFactory:function(e){return Jb(e=e||"undefined"!=typeof $localize&&$localize.locale||Wb),e},deps:[[new Nk(FP),new Mk,new Dk]]},{provide:BP,useValue:"USD"}],bO=function(){var e=rp(function e(t){tp(this,e)});return e.\u0275fac=function(t){return new(t||e)(Pk(vO))},e.\u0275mod=iy({type:e}),e.\u0275inj=Sg({providers:CO}),e}(),EO=null;function SO(){return EO}var PO=new ok("DocumentToken"),OO=function(){var e=function(){function e(){tp(this,e)}return rp(e,[{key:"historyGo",value:function(e){throw new Error("Not implemented")}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Eg({factory:TO,token:e,providedIn:"platform"}),e}();function TO(){return Pk(xO)}var IO=new ok("Location Initialized"),xO=function(){var e=function(e){Gv(n,e);var t=$v(n);function n(e){var r;return tp(this,n),(r=t.call(this))._doc=e,r._init(),r}return rp(n,[{key:"_init",value:function(){this.location=window.location,this._history=window.history}},{key:"getBaseHrefFromDOM",value:function(){return SO().getBaseHref(this._doc)}},{key:"onPopState",value:function(e){var t=SO().getGlobalEventTarget(this._doc,"window");return t.addEventListener("popstate",e,!1),function(){return t.removeEventListener("popstate",e)}}},{key:"onHashChange",value:function(e){var t=SO().getGlobalEventTarget(this._doc,"window");return t.addEventListener("hashchange",e,!1),function(){return t.removeEventListener("hashchange",e)}}},{key:"href",get:function(){return this.location.href}},{key:"protocol",get:function(){return this.location.protocol}},{key:"hostname",get:function(){return this.location.hostname}},{key:"port",get:function(){return this.location.port}},{key:"pathname",get:function(){return this.location.pathname},set:function(e){this.location.pathname=e}},{key:"search",get:function(){return this.location.search}},{key:"hash",get:function(){return this.location.hash}},{key:"pushState",value:function(e,t,n){AO()?this._history.pushState(e,t,n):this.location.hash=n}},{key:"replaceState",value:function(e,t,n){AO()?this._history.replaceState(e,t,n):this.location.hash=n}},{key:"forward",value:function(){this._history.forward()}},{key:"back",value:function(){this._history.back()}},{key:"historyGo",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this._history.go(e)}},{key:"getState",value:function(){return this._history.state}}]),n}(OO);return e.\u0275fac=function(t){return new(t||e)(Pk(PO))},e.\u0275prov=Eg({factory:RO,token:e,providedIn:"platform"}),e}();function AO(){return!!window.history.pushState}function RO(){return new xO(Pk(PO))}function NO(e,t){if(0==e.length)return t;if(0==t.length)return e;var n=0;return e.endsWith("/")&&n++,t.startsWith("/")&&n++,2==n?e+t.substring(1):1==n?e+t:e+"/"+t}function MO(e){var t=e.match(/#|\?|$/),n=t&&t.index||e.length;return e.slice(0,n-("/"===e[n-1]?1:0))+e.slice(n)}function DO(e){return e&&"?"!==e[0]?"?"+e:e}var LO=function(){var e=function(){function e(){tp(this,e)}return rp(e,[{key:"historyGo",value:function(e){throw new Error("Not implemented")}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Eg({factory:FO,token:e,providedIn:"root"}),e}();function FO(e){var t=Pk(PO).location;return new VO(Pk(OO),t&&t.origin||"")}var BO=new ok("appBaseHref"),VO=function(){var e=function(e){Gv(n,e);var t=$v(n);function n(e,r){var i;if(tp(this,n),(i=t.call(this))._platformLocation=e,i._removeListenerFns=[],null==r&&(r=i._platformLocation.getBaseHrefFromDOM()),null==r)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");return i._baseHref=r,Wv(i)}return rp(n,[{key:"ngOnDestroy",value:function(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}},{key:"onPopState",value:function(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}},{key:"getBaseHref",value:function(){return this._baseHref}},{key:"prepareExternalUrl",value:function(e){return NO(this._baseHref,e)}},{key:"path",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this._platformLocation.pathname+DO(this._platformLocation.search),n=this._platformLocation.hash;return n&&e?"".concat(t).concat(n):t}},{key:"pushState",value:function(e,t,n,r){var i=this.prepareExternalUrl(n+DO(r));this._platformLocation.pushState(e,t,i)}},{key:"replaceState",value:function(e,t,n,r){var i=this.prepareExternalUrl(n+DO(r));this._platformLocation.replaceState(e,t,i)}},{key:"forward",value:function(){this._platformLocation.forward()}},{key:"back",value:function(){this._platformLocation.back()}},{key:"historyGo",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;null===(t=(e=this._platformLocation).historyGo)||void 0===t||t.call(e,n)}}]),n}(LO);return e.\u0275fac=function(t){return new(t||e)(Pk(OO),Pk(BO,8))},e.\u0275prov=Eg({token:e,factory:e.\u0275fac}),e}(),UO=function(){var e=function(e){Gv(n,e);var t=$v(n);function n(e,r){var i;return tp(this,n),(i=t.call(this))._platformLocation=e,i._baseHref="",i._removeListenerFns=[],null!=r&&(i._baseHref=r),i}return rp(n,[{key:"ngOnDestroy",value:function(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}},{key:"onPopState",value:function(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}},{key:"getBaseHref",value:function(){return this._baseHref}},{key:"path",value:function(){var e=this._platformLocation.hash;return null==e&&(e="#"),e.length>0?e.substring(1):e}},{key:"prepareExternalUrl",value:function(e){var t=NO(this._baseHref,e);return t.length>0?"#"+t:t}},{key:"pushState",value:function(e,t,n,r){var i=this.prepareExternalUrl(n+DO(r));0==i.length&&(i=this._platformLocation.pathname),this._platformLocation.pushState(e,t,i)}},{key:"replaceState",value:function(e,t,n,r){var i=this.prepareExternalUrl(n+DO(r));0==i.length&&(i=this._platformLocation.pathname),this._platformLocation.replaceState(e,t,i)}},{key:"forward",value:function(){this._platformLocation.forward()}},{key:"back",value:function(){this._platformLocation.back()}},{key:"historyGo",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;null===(t=(e=this._platformLocation).historyGo)||void 0===t||t.call(e,n)}}]),n}(LO);return e.\u0275fac=function(t){return new(t||e)(Pk(OO),Pk(BO,8))},e.\u0275prov=Eg({token:e,factory:e.\u0275fac}),e}(),zO=function(){var e=function(){function e(t,n){var r=this;tp(this,e),this._subject=new hP,this._urlChangeListeners=[],this._platformStrategy=t;var i=this._platformStrategy.getBaseHref();this._platformLocation=n,this._baseHref=MO(GO(i)),this._platformStrategy.onPopState(function(e){r._subject.emit({url:r.path(!0),pop:!0,state:e.state,type:e.type})})}return rp(e,[{key:"path",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.normalize(this._platformStrategy.path(e))}},{key:"getState",value:function(){return this._platformLocation.getState()}},{key:"isCurrentPathEqualTo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return this.path()==this.normalize(e+DO(t))}},{key:"normalize",value:function(t){return e.stripTrailingSlash(function(e,t){return e&&t.startsWith(e)?t.substring(e.length):t}(this._baseHref,GO(t)))}},{key:"prepareExternalUrl",value:function(e){return e&&"/"!==e[0]&&(e="/"+e),this._platformStrategy.prepareExternalUrl(e)}},{key:"go",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this._platformStrategy.pushState(n,"",e,t),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+DO(t)),n)}},{key:"replaceState",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this._platformStrategy.replaceState(n,"",e,t),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+DO(t)),n)}},{key:"forward",value:function(){this._platformStrategy.forward()}},{key:"back",value:function(){this._platformStrategy.back()}},{key:"historyGo",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;null===(t=(e=this._platformStrategy).historyGo)||void 0===t||t.call(e,n)}},{key:"onUrlChange",value:function(e){var t=this;this._urlChangeListeners.push(e),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(function(e){t._notifyUrlChangeListeners(e.url,e.state)}))}},{key:"_notifyUrlChangeListeners",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;this._urlChangeListeners.forEach(function(n){return n(e,t)})}},{key:"subscribe",value:function(e,t,n){return this._subject.subscribe({next:e,error:t,complete:n})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Pk(LO),Pk(OO))},e.normalizeQueryParams=DO,e.joinWithSlash=NO,e.stripTrailingSlash=MO,e.\u0275prov=Eg({factory:HO,token:e,providedIn:"root"}),e}();function HO(){return new zO(Pk(LO),Pk(OO))}function GO(e){return e.replace(/\/index.html$/,"")}var qO=((qO=qO||{})[qO.Decimal=0]="Decimal",qO[qO.Percent=1]="Percent",qO[qO.Currency=2]="Currency",qO[qO.Scientific=3]="Scientific",qO),$O=(($O=$O||{})[$O.Zero=0]="Zero",$O[$O.One=1]="One",$O[$O.Two=2]="Two",$O[$O.Few=3]="Few",$O[$O.Many=4]="Many",$O[$O.Other=5]="Other",$O),WO=((WO=WO||{})[WO.Format=0]="Format",WO[WO.Standalone=1]="Standalone",WO),jO=((jO=jO||{})[jO.Narrow=0]="Narrow",jO[jO.Abbreviated=1]="Abbreviated",jO[jO.Wide=2]="Wide",jO[jO.Short=3]="Short",jO),ZO=((ZO=ZO||{})[ZO.Short=0]="Short",ZO[ZO.Medium=1]="Medium",ZO[ZO.Long=2]="Long",ZO[ZO.Full=3]="Full",ZO),YO=((YO=YO||{})[YO.Decimal=0]="Decimal",YO[YO.Group=1]="Group",YO[YO.List=2]="List",YO[YO.PercentSign=3]="PercentSign",YO[YO.PlusSign=4]="PlusSign",YO[YO.MinusSign=5]="MinusSign",YO[YO.Exponential=6]="Exponential",YO[YO.SuperscriptingExponent=7]="SuperscriptingExponent",YO[YO.PerMille=8]="PerMille",YO[YO.Infinity=9]="Infinity",YO[YO.NaN=10]="NaN",YO[YO.TimeSeparator=11]="TimeSeparator",YO[YO.CurrencyDecimal=12]="CurrencyDecimal",YO[YO.CurrencyGroup=13]="CurrencyGroup",YO);function KO(e,t){return nT(zb(e)[qb.DateFormat],t)}function JO(e,t){return nT(zb(e)[qb.TimeFormat],t)}function QO(e,t){return nT(zb(e)[qb.DateTimeFormat],t)}function XO(e,t){var n=zb(e),r=n[qb.NumberSymbols][t];if(void 0===r){if(t===YO.CurrencyDecimal)return n[qb.NumberSymbols][YO.Decimal];if(t===YO.CurrencyGroup)return n[qb.NumberSymbols][YO.Group]}return r}var eT=Hb;function tT(e){if(!e[qb.ExtraData])throw new Error('Missing extra locale data for the locale "'.concat(e[qb.LocaleId],'". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.'))}function nT(e,t){for(var n=t;n>-1;n--)if(void 0!==e[n])return e[n];throw new Error("Locale data API: locale data undefined")}function rT(e){var t=Lv(e.split(":"),2);return{hours:+t[0],minutes:+t[1]}}var iT=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,aT={},oT=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/,sT=((sT=sT||{})[sT.Short=0]="Short",sT[sT.ShortGMT=1]="ShortGMT",sT[sT.Long=2]="Long",sT[sT.Extended=3]="Extended",sT),uT=((uT=uT||{})[uT.FullYear=0]="FullYear",uT[uT.Month=1]="Month",uT[uT.Date=2]="Date",uT[uT.Hours=3]="Hours",uT[uT.Minutes=4]="Minutes",uT[uT.Seconds=5]="Seconds",uT[uT.FractionalSeconds=6]="FractionalSeconds",uT[uT.Day=7]="Day",uT),cT=((cT=cT||{})[cT.DayPeriods=0]="DayPeriods",cT[cT.Days=1]="Days",cT[cT.Months=2]="Months",cT[cT.Eras=3]="Eras",cT);function lT(e,t,n,r){var i=function(e){if(bT(e))return e;if("number"==typeof e&&!isNaN(e))return new Date(e);if("string"==typeof e){if(e=e.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(e)){var t=Lv(e.split("-").map(function(e){return+e}),3),n=t[0],r=t[1],i=void 0===r?1:r,a=t[2];return hT(n,i-1,void 0===a?1:a)}var o,s=parseFloat(e);if(!isNaN(e-s))return new Date(s);if(o=e.match(iT))return function(e){var t=new Date(0),n=0,r=0,i=e[8]?t.setUTCFullYear:t.setFullYear,a=e[8]?t.setUTCHours:t.setHours;e[9]&&(n=Number(e[9]+e[10]),r=Number(e[9]+e[11])),i.call(t,Number(e[1]),Number(e[2])-1,Number(e[3]));var o=Number(e[4]||0)-n,s=Number(e[5]||0)-r,u=Number(e[6]||0),c=Math.floor(1e3*parseFloat("0."+(e[7]||0)));return a.call(t,o,s,u,c),t}(o)}var u=new Date(e);if(!bT(u))throw new Error('Unable to convert "'.concat(e,'" into a date'));return u}(e);t=fT(n,t)||t;for(var a,o=[];t;){if(!(a=oT.exec(t))){o.push(t);break}var s=(o=o.concat(a.slice(1))).pop();if(!s)break;t=s}var u=i.getTimezoneOffset();r&&(u=CT(r,u),i=function(e,t,n){var r=e.getTimezoneOffset();return function(e,t){return(e=new Date(e.getTime())).setMinutes(e.getMinutes()+t),e}(e,-1*(CT(t,r)-r))}(i,r));var c="";return o.forEach(function(e){var t=function(e){if(wT[e])return wT[e];var t;switch(e){case"G":case"GG":case"GGG":t=gT(cT.Eras,jO.Abbreviated);break;case"GGGG":t=gT(cT.Eras,jO.Wide);break;case"GGGGG":t=gT(cT.Eras,jO.Narrow);break;case"y":t=pT(uT.FullYear,1,0,!1,!0);break;case"yy":t=pT(uT.FullYear,2,0,!0,!0);break;case"yyy":t=pT(uT.FullYear,3,0,!1,!0);break;case"yyyy":t=pT(uT.FullYear,4,0,!1,!0);break;case"Y":t=_T(1);break;case"YY":t=_T(2,!0);break;case"YYY":t=_T(3);break;case"YYYY":t=_T(4);break;case"M":case"L":t=pT(uT.Month,1,1);break;case"MM":case"LL":t=pT(uT.Month,2,1);break;case"MMM":t=gT(cT.Months,jO.Abbreviated);break;case"MMMM":t=gT(cT.Months,jO.Wide);break;case"MMMMM":t=gT(cT.Months,jO.Narrow);break;case"LLL":t=gT(cT.Months,jO.Abbreviated,WO.Standalone);break;case"LLLL":t=gT(cT.Months,jO.Wide,WO.Standalone);break;case"LLLLL":t=gT(cT.Months,jO.Narrow,WO.Standalone);break;case"w":t=kT(1);break;case"ww":t=kT(2);break;case"W":t=kT(1,!0);break;case"d":t=pT(uT.Date,1);break;case"dd":t=pT(uT.Date,2);break;case"c":case"cc":t=pT(uT.Day,1);break;case"ccc":t=gT(cT.Days,jO.Abbreviated,WO.Standalone);break;case"cccc":t=gT(cT.Days,jO.Wide,WO.Standalone);break;case"ccccc":t=gT(cT.Days,jO.Narrow,WO.Standalone);break;case"cccccc":t=gT(cT.Days,jO.Short,WO.Standalone);break;case"E":case"EE":case"EEE":t=gT(cT.Days,jO.Abbreviated);break;case"EEEE":t=gT(cT.Days,jO.Wide);break;case"EEEEE":t=gT(cT.Days,jO.Narrow);break;case"EEEEEE":t=gT(cT.Days,jO.Short);break;case"a":case"aa":case"aaa":t=gT(cT.DayPeriods,jO.Abbreviated);break;case"aaaa":t=gT(cT.DayPeriods,jO.Wide);break;case"aaaaa":t=gT(cT.DayPeriods,jO.Narrow);break;case"b":case"bb":case"bbb":t=gT(cT.DayPeriods,jO.Abbreviated,WO.Standalone,!0);break;case"bbbb":t=gT(cT.DayPeriods,jO.Wide,WO.Standalone,!0);break;case"bbbbb":t=gT(cT.DayPeriods,jO.Narrow,WO.Standalone,!0);break;case"B":case"BB":case"BBB":t=gT(cT.DayPeriods,jO.Abbreviated,WO.Format,!0);break;case"BBBB":t=gT(cT.DayPeriods,jO.Wide,WO.Format,!0);break;case"BBBBB":t=gT(cT.DayPeriods,jO.Narrow,WO.Format,!0);break;case"h":t=pT(uT.Hours,1,-12);break;case"hh":t=pT(uT.Hours,2,-12);break;case"H":t=pT(uT.Hours,1);break;case"HH":t=pT(uT.Hours,2);break;case"m":t=pT(uT.Minutes,1);break;case"mm":t=pT(uT.Minutes,2);break;case"s":t=pT(uT.Seconds,1);break;case"ss":t=pT(uT.Seconds,2);break;case"S":t=pT(uT.FractionalSeconds,1);break;case"SS":t=pT(uT.FractionalSeconds,2);break;case"SSS":t=pT(uT.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":t=yT(sT.Short);break;case"ZZZZZ":t=yT(sT.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":t=yT(sT.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":t=yT(sT.Long);break;default:return null}return wT[e]=t,t}(e);c+=t?t(i,n,u):"''"===e?"'":e.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),c}function hT(e,t,n){var r=new Date(0);return r.setFullYear(e,t,n),r.setHours(0,0,0),r}function fT(e,t){var n=function(e){return zb(e)[qb.LocaleId]}(e);if(aT[n]=aT[n]||{},aT[n][t])return aT[n][t];var r="";switch(t){case"shortDate":r=KO(e,ZO.Short);break;case"mediumDate":r=KO(e,ZO.Medium);break;case"longDate":r=KO(e,ZO.Long);break;case"fullDate":r=KO(e,ZO.Full);break;case"shortTime":r=JO(e,ZO.Short);break;case"mediumTime":r=JO(e,ZO.Medium);break;case"longTime":r=JO(e,ZO.Long);break;case"fullTime":r=JO(e,ZO.Full);break;case"short":var i=fT(e,"shortTime"),a=fT(e,"shortDate");r=dT(QO(e,ZO.Short),[i,a]);break;case"medium":var o=fT(e,"mediumTime"),s=fT(e,"mediumDate");r=dT(QO(e,ZO.Medium),[o,s]);break;case"long":var u=fT(e,"longTime"),c=fT(e,"longDate");r=dT(QO(e,ZO.Long),[u,c]);break;case"full":var l=fT(e,"fullTime"),h=fT(e,"fullDate");r=dT(QO(e,ZO.Full),[l,h])}return r&&(aT[n][t]=r),r}function dT(e,t){return t&&(e=e.replace(/\{([^}]+)}/g,function(e,n){return null!=t&&n in t?t[n]:e})),e}function vT(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"-",r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0,a="";(e<0||i&&e<=0)&&(i?e=1-e:(e=-e,a=n));for(var o=String(e);o.length<t;)o="0"+o;return r&&(o=o.substr(o.length-t)),a+o}function pT(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return function(a,o){var s=function(e,t){switch(e){case uT.FullYear:return t.getFullYear();case uT.Month:return t.getMonth();case uT.Date:return t.getDate();case uT.Hours:return t.getHours();case uT.Minutes:return t.getMinutes();case uT.Seconds:return t.getSeconds();case uT.FractionalSeconds:return t.getMilliseconds();case uT.Day:return t.getDay();default:throw new Error('Unknown DateType value "'.concat(e,'".'))}}(e,a);if((n>0||s>-n)&&(s+=n),e===uT.Hours)0===s&&-12===n&&(s=12);else if(e===uT.FractionalSeconds)return function(e,t){return vT(e,3).substr(0,t)}(s,t);var u=XO(o,YO.MinusSign);return vT(s,t,u,r,i)}}function gT(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:WO.Format,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return function(i,a){return function(e,t,n,r,i,a){switch(n){case cT.Months:return function(e,t,n){var r=zb(e),i=nT([r[qb.MonthsFormat],r[qb.MonthsStandalone]],t);return nT(i,n)}(t,i,r)[e.getMonth()];case cT.Days:return function(e,t,n){var r=zb(e),i=nT([r[qb.DaysFormat],r[qb.DaysStandalone]],t);return nT(i,n)}(t,i,r)[e.getDay()];case cT.DayPeriods:var o=e.getHours(),s=e.getMinutes();if(a){var u=function(e){var t=zb(e);return tT(t),(t[qb.ExtraData][2]||[]).map(function(e){return"string"==typeof e?rT(e):[rT(e[0]),rT(e[1])]})}(t),c=function(e,t,n){var r=zb(e);tT(r);var i=nT([r[qb.ExtraData][0],r[qb.ExtraData][1]],t)||[];return nT(i,n)||[]}(t,i,r),l=u.findIndex(function(e){if(Array.isArray(e)){var t=Lv(e,2),n=t[0],r=t[1],i=o>=n.hours&&s>=n.minutes,a=o<r.hours||o===r.hours&&s<r.minutes;if(n.hours<r.hours){if(i&&a)return!0}else if(i||a)return!0}else if(e.hours===o&&e.minutes===s)return!0;return!1});if(-1!==l)return c[l]}return function(e,t,n){var r=zb(e),i=nT([r[qb.DayPeriodsFormat],r[qb.DayPeriodsStandalone]],t);return nT(i,n)}(t,i,r)[o<12?0:1];case cT.Eras:return function(e,t){return nT(zb(e)[qb.Eras],t)}(t,r)[e.getFullYear()<=0?0:1];default:throw new Error("unexpected translation type ".concat(n))}}(i,a,e,t,n,r)}}function yT(e){return function(t,n,r){var i=-1*r,a=XO(n,YO.MinusSign),o=i>0?Math.floor(i/60):Math.ceil(i/60);switch(e){case sT.Short:return(i>=0?"+":"")+vT(o,2,a)+vT(Math.abs(i%60),2,a);case sT.ShortGMT:return"GMT"+(i>=0?"+":"")+vT(o,1,a);case sT.Long:return"GMT"+(i>=0?"+":"")+vT(o,2,a)+":"+vT(Math.abs(i%60),2,a);case sT.Extended:return 0===r?"Z":(i>=0?"+":"")+vT(o,2,a)+":"+vT(Math.abs(i%60),2,a);default:throw new Error('Unknown zone width "'.concat(e,'"'))}}}function mT(e){return hT(e.getFullYear(),e.getMonth(),e.getDate()+(4-e.getDay()))}function kT(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(n,r){var i;if(t){var a=new Date(n.getFullYear(),n.getMonth(),1).getDay()-1,o=n.getDate();i=1+Math.floor((o+a)/7)}else{var s=mT(n),u=function(e){var t=hT(e,0,1).getDay();return hT(e,0,1+(t<=4?4:11)-t)}(s.getFullYear()),c=s.getTime()-u.getTime();i=1+Math.round(c/6048e5)}return vT(i,e,XO(r,YO.MinusSign))}}function _T(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(n,r){return vT(mT(n).getFullYear(),e,XO(r,YO.MinusSign),t)}}var wT={};function CT(e,t){e=e.replace(/:/g,"");var n=Date.parse("Jan 01, 1970 00:00:00 "+e)/6e4;return isNaN(n)?t:n}function bT(e){return e instanceof Date&&!isNaN(e.valueOf())}var ET=/^(\d+)?\.((\d+)(-(\d+))?)?$/;function ST(e){var t=parseInt(e);if(isNaN(t))throw new Error("Invalid integer literal when parsing "+e);return t}var PT=rp(function e(){tp(this,e)}),OT=function(){var e=function(e){Gv(n,e);var t=$v(n);function n(e){var r;return tp(this,n),(r=t.call(this)).locale=e,r}return rp(n,[{key:"getPluralCategory",value:function(e,t){switch(eT(t||this.locale)(e)){case $O.Zero:return"zero";case $O.One:return"one";case $O.Two:return"two";case $O.Few:return"few";case $O.Many:return"many";default:return"other"}}}]),n}(PT);return e.\u0275fac=function(t){return new(t||e)(Pk(FP))},e.\u0275prov=Eg({token:e,factory:e.\u0275fac}),e}();function TT(e,t){t=encodeURIComponent(t);var n,r=Qv(e.split(";"));try{for(r.s();!(n=r.n()).done;){var i=n.value,a=i.indexOf("="),o=Lv(-1==a?[i,""]:[i.slice(0,a),i.slice(a+1)],2),s=o[0],u=o[1];if(s.trim()===t)return decodeURIComponent(u)}}catch(c){r.e(c)}finally{r.f()}return null}var IT=function(){var e=function(){function e(t,n,r,i){tp(this,e),this._iterableDiffers=t,this._keyValueDiffers=n,this._ngEl=r,this._renderer=i,this._iterableDiffer=null,this._keyValueDiffer=null,this._initialClasses=[],this._rawClass=null}return rp(e,[{key:"klass",set:function(e){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof e?e.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}},{key:"ngClass",set:function(e){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof e?e.split(/\s+/):e,this._rawClass&&(YC(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}},{key:"ngDoCheck",value:function(){if(this._iterableDiffer){var e=this._iterableDiffer.diff(this._rawClass);e&&this._applyIterableChanges(e)}else if(this._keyValueDiffer){var t=this._keyValueDiffer.diff(this._rawClass);t&&this._applyKeyValueChanges(t)}}},{key:"_applyKeyValueChanges",value:function(e){var t=this;e.forEachAddedItem(function(e){return t._toggleClass(e.key,e.currentValue)}),e.forEachChangedItem(function(e){return t._toggleClass(e.key,e.currentValue)}),e.forEachRemovedItem(function(e){e.previousValue&&t._toggleClass(e.key,!1)})}},{key:"_applyIterableChanges",value:function(e){var t=this;e.forEachAddedItem(function(e){if("string"!=typeof e.item)throw new Error("NgClass can only toggle CSS classes expressed as strings, got ".concat(dg(e.item)));t._toggleClass(e.item,!0)}),e.forEachRemovedItem(function(e){return t._toggleClass(e.item,!1)})}},{key:"_applyClasses",value:function(e){var t=this;e&&(Array.isArray(e)||e instanceof Set?e.forEach(function(e){return t._toggleClass(e,!0)}):Object.keys(e).forEach(function(n){return t._toggleClass(n,!!e[n])}))}},{key:"_removeClasses",value:function(e){var t=this;e&&(Array.isArray(e)||e instanceof Set?e.forEach(function(e){return t._toggleClass(e,!1)}):Object.keys(e).forEach(function(e){return t._toggleClass(e,!1)}))}},{key:"_toggleClass",value:function(e,t){var n=this;(e=e.trim())&&e.split(/\s+/g).forEach(function(e){t?n._renderer.addClass(n._ngEl.nativeElement,e):n._renderer.removeClass(n._ngEl.nativeElement,e)})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(sb(CS),sb(ES),sb(rS),sb(oS))},e.\u0275dir=oy({type:e,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"}}),e}(),xT=function(){function e(t,n,r,i){tp(this,e),this.$implicit=t,this.ngForOf=n,this.index=r,this.count=i}return rp(e,[{key:"first",get:function(){return 0===this.index}},{key:"last",get:function(){return this.index===this.count-1}},{key:"even",get:function(){return this.index%2==0}},{key:"odd",get:function(){return!this.even}}]),e}(),AT=function(){var e=function(){function e(t,n,r){tp(this,e),this._viewContainer=t,this._template=n,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}return rp(e,[{key:"ngForOf",set:function(e){this._ngForOf=e,this._ngForOfDirty=!0}},{key:"ngForTrackBy",get:function(){return this._trackByFn},set:function(e){this._trackByFn=e}},{key:"ngForTemplate",set:function(e){e&&(this._template=e)}},{key:"ngDoCheck",value:function(){if(this._ngForOfDirty){this._ngForOfDirty=!1;var e=this._ngForOf;if(!this._differ&&e)try{this._differ=this._differs.find(e).create(this.ngForTrackBy)}catch(n){throw new Error("Cannot find a differ supporting object '".concat(e,"' of type '").concat(function(e){return e.name||typeof e}(e),"'. NgFor only supports binding to Iterables such as Arrays."))}}if(this._differ){var t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}},{key:"_applyChanges",value:function(e){var t=this,n=[];e.forEachOperation(function(e,r,i){if(null==e.previousIndex){var a=t._viewContainer.createEmbeddedView(t._template,new xT(null,t._ngForOf,-1,-1),null===i?void 0:i),o=new RT(e,a);n.push(o)}else if(null==i)t._viewContainer.remove(null===r?void 0:r);else if(null!==r){var s=t._viewContainer.get(r);t._viewContainer.move(s,i);var u=new RT(e,s);n.push(u)}});for(var r=0;r<n.length;r++)this._perViewChange(n[r].view,n[r].record);for(var i=0,a=this._viewContainer.length;i<a;i++){var o=this._viewContainer.get(i);o.context.index=i,o.context.count=a,o.context.ngForOf=this._ngForOf}e.forEachIdentityChange(function(e){t._viewContainer.get(e.currentIndex).context.$implicit=e.item})}},{key:"_perViewChange",value:function(e,t){e.context.$implicit=t.item}}],[{key:"ngTemplateContextGuard",value:function(e,t){return!0}}]),e}();return e.\u0275fac=function(t){return new(t||e)(sb(US),sb(MS),sb(CS))},e.\u0275dir=oy({type:e,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),e}(),RT=rp(function e(t,n){tp(this,e),this.record=t,this.view=n}),NT=function(){var e=function(){function e(t,n){tp(this,e),this._viewContainer=t,this._context=new MT,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=n}return rp(e,[{key:"ngIf",set:function(e){this._context.$implicit=this._context.ngIf=e,this._updateView()}},{key:"ngIfThen",set:function(e){DT("ngIfThen",e),this._thenTemplateRef=e,this._thenViewRef=null,this._updateView()}},{key:"ngIfElse",set:function(e){DT("ngIfElse",e),this._elseTemplateRef=e,this._elseViewRef=null,this._updateView()}},{key:"_updateView",value:function(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}}],[{key:"ngTemplateContextGuard",value:function(e,t){return!0}}]),e}();return e.\u0275fac=function(t){return new(t||e)(sb(US),sb(MS))},e.\u0275dir=oy({type:e,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),e}(),MT=rp(function e(){tp(this,e),this.$implicit=null,this.ngIf=null});function DT(e,t){if(t&&!t.createEmbeddedView)throw new Error("".concat(e," must be a TemplateRef, but received '").concat(dg(t),"'."))}function LT(e,t){return Error("InvalidPipeArgument: '".concat(t,"' for pipe '").concat(dg(e),"'"))}var FT=function(){var e=function(){function e(t){tp(this,e),this.locale=t}return rp(e,[{key:"transform",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"mediumDate",r=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;if(null==t||""===t||t!=t)return null;try{return lT(t,n,i||this.locale,r)}catch(a){throw LT(e,a.message)}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(sb(FP,16))},e.\u0275pipe=sy({name:"date",type:e,pure:!0}),e}(),BT=function(){var e=function(){function e(t){tp(this,e),this._locale=t}return rp(e,[{key:"transform",value:function(t,n,r){if(!function(e){return!(null==e||""===e||e!=e)}(t))return null;r=r||this._locale;try{return function(e,t,n){return function(e,t,n,r,i,a){var o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s="",u=!1;if(isFinite(e)){var c=function(e){var t,n,r,i,a,o=Math.abs(e)+"",s=0;for((n=o.indexOf("."))>-1&&(o=o.replace(".","")),(r=o.search(/e/i))>0?(n<0&&(n=r),n+=+o.slice(r+1),o=o.substring(0,r)):n<0&&(n=o.length),r=0;"0"===o.charAt(r);r++);if(r===(a=o.length))t=[0],n=1;else{for(a--;"0"===o.charAt(a);)a--;for(n-=r,t=[],i=0;r<=a;r++,i++)t[i]=Number(o.charAt(r))}return n>22&&(t=t.splice(0,21),s=n-1,n=1),{digits:t,exponent:s,integerLen:n}}(e);o&&(c=function(e){if(0===e.digits[0])return e;var t=e.digits.length-e.integerLen;return e.exponent?e.exponent+=2:(0===t?e.digits.push(0,0):1===t&&e.digits.push(0),e.integerLen+=2),e}(c));var l=t.minInt,h=t.minFrac,f=t.maxFrac;if(a){var d=a.match(ET);if(null===d)throw new Error("".concat(a," is not a valid digit info"));var v=d[1],p=d[3],g=d[5];null!=v&&(l=ST(v)),null!=p&&(h=ST(p)),null!=g?f=ST(g):null!=p&&h>f&&(f=h)}!function(e,t,n){if(t>n)throw new Error("The minimum number of digits after fraction (".concat(t,") is higher than the maximum (").concat(n,")."));var r=e.digits,i=r.length-e.integerLen,a=Math.min(Math.max(t,i),n),o=a+e.integerLen,s=r[o];if(o>0){r.splice(Math.max(e.integerLen,o));for(var u=o;u<r.length;u++)r[u]=0}else{i=Math.max(0,i),e.integerLen=1,r.length=Math.max(1,o=a+1),r[0]=0;for(var c=1;c<o;c++)r[c]=0}if(s>=5)if(o-1<0){for(var l=0;l>o;l--)r.unshift(0),e.integerLen++;r.unshift(1),e.integerLen++}else r[o-1]++;for(;i<Math.max(0,a);i++)r.push(0);var h=0!==a,f=t+e.integerLen,d=r.reduceRight(function(e,t,n,r){return r[n]=(t+=e)<10?t:t-10,h&&(0===r[n]&&n>=f?r.pop():h=!1),t>=10?1:0},0);d&&(r.unshift(d),e.integerLen++)}(c,h,f);var y=c.digits,m=c.integerLen,k=c.exponent,_=[];for(u=y.every(function(e){return!e});m<l;m++)y.unshift(0);for(;m<0;m++)y.unshift(0);m>0?_=y.splice(m,y.length):(_=y,y=[0]);var w=[];for(y.length>=t.lgSize&&w.unshift(y.splice(-t.lgSize,y.length).join(""));y.length>t.gSize;)w.unshift(y.splice(-t.gSize,y.length).join(""));y.length&&w.unshift(y.join("")),s=w.join(XO(n,r)),_.length&&(s+=XO(n,i)+_.join("")),k&&(s+=XO(n,YO.Exponential)+"+"+k)}else s=XO(n,YO.Infinity);return s=e<0&&!u?t.negPre+s+t.negSuf:t.posPre+s+t.posSuf}(e,function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"-",n={minInt:1,minFrac:0,maxFrac:0,posPre:"",posSuf:"",negPre:"",negSuf:"",gSize:0,lgSize:0},r=e.split(";"),i=r[0],a=r[1],o=-1!==i.indexOf(".")?i.split("."):[i.substring(0,i.lastIndexOf("0")+1),i.substring(i.lastIndexOf("0")+1)],s=o[0],u=o[1]||"";n.posPre=s.substr(0,s.indexOf("#"));for(var c=0;c<u.length;c++){var l=u.charAt(c);"0"===l?n.minFrac=n.maxFrac=c+1:"#"===l?n.maxFrac=c+1:n.posSuf+=l}var h=s.split(",");if(n.gSize=h[1]?h[1].length:0,n.lgSize=h[2]||h[1]?(h[2]||h[1]).length:0,a){var f=i.length-n.posPre.length-n.posSuf.length,d=a.indexOf("#");n.negPre=a.substr(0,d).replace(/'/g,""),n.negSuf=a.substr(d+f).replace(/'/g,"")}else n.negPre=t+n.posPre,n.negSuf=n.posSuf;return n}(function(e,t){return zb(e)[qb.NumberFormats][t]}(t,qO.Decimal),XO(t,YO.MinusSign)),t,YO.Group,YO.Decimal,n)}(function(e){if("string"==typeof e&&!isNaN(Number(e)-parseFloat(e)))return Number(e);if("number"!=typeof e)throw new Error("".concat(e," is not a number"));return e}(t),r,n)}catch(i){throw LT(e,i.message)}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(sb(FP,16))},e.\u0275pipe=sy({name:"number",type:e,pure:!0}),e}(),VT=function(){var e=rp(function e(){tp(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=iy({type:e}),e.\u0275inj=Sg({providers:[{provide:PT,useClass:OT}]}),e}(),UT=function(){var e=rp(function e(){tp(this,e)});return e.\u0275prov=Eg({token:e,providedIn:"root",factory:function(){return new zT(Pk(PO),window)}}),e}(),zT=function(){function e(t,n){tp(this,e),this.document=t,this.window=n,this.offset=function(){return[0,0]}}return rp(e,[{key:"setOffset",value:function(e){this.offset=Array.isArray(e)?function(){return e}:e}},{key:"getScrollPosition",value:function(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}},{key:"scrollToPosition",value:function(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}},{key:"scrollToAnchor",value:function(e){if(this.supportsScrolling()){var t=function(e,t){var n=e.getElementById(t)||e.getElementsByName(t)[0];if(n)return n;if("function"==typeof e.createTreeWalker&&e.body&&(e.body.createShadowRoot||e.body.attachShadow))for(var r=e.createTreeWalker(e.body,NodeFilter.SHOW_ELEMENT),i=r.currentNode;i;){var a=i.shadowRoot;if(a){var o=a.getElementById(t)||a.querySelector('[name="'.concat(t,'"]'));if(o)return o}i=r.nextNode()}return null}(this.document,e);t&&(this.scrollToElement(t),this.attemptFocus(t))}}},{key:"setHistoryScrollRestoration",value:function(e){if(this.supportScrollRestoration()){var t=this.window.history;t&&t.scrollRestoration&&(t.scrollRestoration=e)}}},{key:"scrollToElement",value:function(e){var t=e.getBoundingClientRect(),n=t.left+this.window.pageXOffset,r=t.top+this.window.pageYOffset,i=this.offset();this.window.scrollTo(n-i[0],r-i[1])}},{key:"attemptFocus",value:function(e){return e.focus(),this.document.activeElement===e}},{key:"supportScrollRestoration",value:function(){try{if(!this.supportsScrolling())return!1;var e=HT(this.window.history)||HT(Object.getPrototypeOf(this.window.history));return!(!e||!e.writable&&!e.set)}catch(t){return!1}}},{key:"supportsScrolling",value:function(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch(e){return!1}}}]),e}();function HT(e){return Object.getOwnPropertyDescriptor(e,"scrollRestoration")}var GT,qT=rp(function e(){tp(this,e)}),$T=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"onAndCancel",value:function(e,t,n){return e.addEventListener(t,n,!1),function(){e.removeEventListener(t,n,!1)}}},{key:"dispatchEvent",value:function(e,t){e.dispatchEvent(t)}},{key:"remove",value:function(e){e.parentNode&&e.parentNode.removeChild(e)}},{key:"createElement",value:function(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}},{key:"createHtmlDocument",value:function(){return document.implementation.createHTMLDocument("fakeTitle")}},{key:"getDefaultDocument",value:function(){return document}},{key:"isElementNode",value:function(e){return e.nodeType===Node.ELEMENT_NODE}},{key:"isShadowRoot",value:function(e){return e instanceof DocumentFragment}},{key:"getGlobalEventTarget",value:function(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}},{key:"getBaseHref",value:function(e){var t=(WT=WT||document.querySelector("base"))?WT.getAttribute("href"):null;return null==t?null:function(e){(GT=GT||document.createElement("a")).setAttribute("href",e);var t=GT.pathname;return"/"===t.charAt(0)?t:"/".concat(t)}(t)}},{key:"resetBaseElement",value:function(){WT=null}},{key:"getUserAgent",value:function(){return window.navigator.userAgent}},{key:"getCookie",value:function(e){return TT(document.cookie,e)}}],[{key:"makeCurrent",value:function(){var e;e=new n,EO||(EO=e)}}]),n}(function(e){Gv(n,e);var t=$v(n);function n(){var e;return tp(this,n),(e=t.apply(this,arguments)).supportsDOMEvents=!0,e}return rp(n)}(function(){return rp(function e(){tp(this,e)})}())),WT=null,jT=new ok("TRANSITION_ID"),ZT=[{provide:TP,useFactory:function(e,t,n){return function(){n.get(IP).donePromise.then(function(){for(var n=SO(),r=t.querySelectorAll('style[ng-transition="'.concat(e,'"]')),i=0;i<r.length;i++)n.remove(r[i])})}},deps:[jT,PO,VC],multi:!0}],YT=function(){function e(){tp(this,e)}return rp(e,[{key:"addToWindow",value:function(e){Gg.getAngularTestability=function(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=e.findTestabilityInTree(t,n);if(null==r)throw new Error("Could not find testability for element.");return r},Gg.getAllAngularTestabilities=function(){return e.getAllTestabilities()},Gg.getAllAngularRootElements=function(){return e.getAllRootElements()},Gg.frameworkStabilizers||(Gg.frameworkStabilizers=[]),Gg.frameworkStabilizers.push(function(e){var t=Gg.getAllAngularTestabilities(),n=t.length,r=!1,i=function(t){r=r||t,0==--n&&e(r)};t.forEach(function(e){e.whenStable(i)})})}},{key:"findTestabilityInTree",value:function(e,t,n){var r;return null==t?null:null!==(r=e.getTestability(t))&&void 0!==r?r:n?SO().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null}}],[{key:"init",value:function(){var t;t=new e,aO=t}}]),e}(),KT=function(){var e=function(){function e(){tp(this,e)}return rp(e,[{key:"build",value:function(){return new XMLHttpRequest}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Eg({token:e,factory:e.\u0275fac}),e}(),JT=new ok("EventManagerPlugins"),QT=function(){var e=function(){function e(t,n){var r=this;tp(this,e),this._zone=n,this._eventNameToPlugin=new Map,t.forEach(function(e){return e.manager=r}),this._plugins=t.slice().reverse()}return rp(e,[{key:"addEventListener",value:function(e,t,n){return this._findPluginFor(t).addEventListener(e,t,n)}},{key:"addGlobalEventListener",value:function(e,t,n){return this._findPluginFor(t).addGlobalEventListener(e,t,n)}},{key:"getZone",value:function(){return this._zone}},{key:"_findPluginFor",value:function(e){var t=this._eventNameToPlugin.get(e);if(t)return t;for(var n=this._plugins,r=0;r<n.length;r++){var i=n[r];if(i.supports(e))return this._eventNameToPlugin.set(e,i),i}throw new Error("No event manager plugin found for event ".concat(e))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Pk(JT),Pk(YP))},e.\u0275prov=Eg({token:e,factory:e.\u0275fac}),e}(),XT=function(){function e(t){tp(this,e),this._doc=t}return rp(e,[{key:"addGlobalEventListener",value:function(e,t,n){var r=SO().getGlobalEventTarget(this._doc,e);if(!r)throw new Error("Unsupported event target ".concat(r," for event ").concat(t));return this.addEventListener(r,t,n)}}]),e}(),eI=function(){var e=function(){function e(){tp(this,e),this._stylesSet=new Set}return rp(e,[{key:"addStyles",value:function(e){var t=this,n=new Set;e.forEach(function(e){t._stylesSet.has(e)||(t._stylesSet.add(e),n.add(e))}),this.onStylesAdded(n)}},{key:"onStylesAdded",value:function(e){}},{key:"getAllStyles",value:function(){return Array.from(this._stylesSet)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Eg({token:e,factory:e.\u0275fac}),e}(),tI=function(){var e=function(e){Gv(n,e);var t=$v(n);function n(e){var r;return tp(this,n),(r=t.call(this))._doc=e,r._hostNodes=new Map,r._hostNodes.set(e.head,[]),r}return rp(n,[{key:"_addStylesToHost",value:function(e,t,n){var r=this;e.forEach(function(e){var i=r._doc.createElement("style");i.textContent=e,n.push(t.appendChild(i))})}},{key:"addHost",value:function(e){var t=[];this._addStylesToHost(this._stylesSet,e,t),this._hostNodes.set(e,t)}},{key:"removeHost",value:function(e){var t=this._hostNodes.get(e);t&&t.forEach(nI),this._hostNodes.delete(e)}},{key:"onStylesAdded",value:function(e){var t=this;this._hostNodes.forEach(function(n,r){t._addStylesToHost(e,r,n)})}},{key:"ngOnDestroy",value:function(){this._hostNodes.forEach(function(e){return e.forEach(nI)})}}]),n}(eI);return e.\u0275fac=function(t){return new(t||e)(Pk(PO))},e.\u0275prov=Eg({token:e,factory:e.\u0275fac}),e}();function nI(e){SO().remove(e)}var rI={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},iI=/%COMP%/g;function aI(e,t,n){for(var r=0;r<t.length;r++){var i=t[r];Array.isArray(i)?aI(e,i,n):(i=i.replace(iI,e),n.push(i))}return n}function oI(e){return function(t){if("__ngUnwrap__"===t)return e;!1===e(t)&&(t.preventDefault(),t.returnValue=!1)}}var sI=function(){var e=function(){function e(t,n,r){tp(this,e),this.eventManager=t,this.sharedStylesHost=n,this.appId=r,this.rendererByCompId=new Map,this.defaultRenderer=new uI(t)}return rp(e,[{key:"createRenderer",value:function(e,t){if(!e||!t)return this.defaultRenderer;switch(t.encapsulation){case Vg.Emulated:var n=this.rendererByCompId.get(t.id);return n||(n=new cI(this.eventManager,this.sharedStylesHost,t,this.appId),this.rendererByCompId.set(t.id,n)),n.applyToHost(e),n;case 1:case Vg.ShadowDom:return new lI(this.eventManager,this.sharedStylesHost,e,t);default:if(!this.rendererByCompId.has(t.id)){var r=aI(t.id,t.styles,[]);this.sharedStylesHost.addStyles(r),this.rendererByCompId.set(t.id,this.defaultRenderer)}return this.defaultRenderer}}},{key:"begin",value:function(){}},{key:"end",value:function(){}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Pk(QT),Pk(tI),Pk(xP))},e.\u0275prov=Eg({token:e,factory:e.\u0275fac}),e}(),uI=function(){function e(t){tp(this,e),this.eventManager=t,this.data=Object.create(null)}return rp(e,[{key:"destroy",value:function(){}},{key:"createElement",value:function(e,t){return t?document.createElementNS(rI[t]||t,e):document.createElement(e)}},{key:"createComment",value:function(e){return document.createComment(e)}},{key:"createText",value:function(e){return document.createTextNode(e)}},{key:"appendChild",value:function(e,t){e.appendChild(t)}},{key:"insertBefore",value:function(e,t,n){e&&e.insertBefore(t,n)}},{key:"removeChild",value:function(e,t){e&&e.removeChild(t)}},{key:"selectRootElement",value:function(e,t){var n="string"==typeof e?document.querySelector(e):e;if(!n)throw new Error('The selector "'.concat(e,'" did not match any elements'));return t||(n.textContent=""),n}},{key:"parentNode",value:function(e){return e.parentNode}},{key:"nextSibling",value:function(e){return e.nextSibling}},{key:"setAttribute",value:function(e,t,n,r){if(r){t=r+":"+t;var i=rI[r];i?e.setAttributeNS(i,t,n):e.setAttribute(t,n)}else e.setAttribute(t,n)}},{key:"removeAttribute",value:function(e,t,n){if(n){var r=rI[n];r?e.removeAttributeNS(r,t):e.removeAttribute("".concat(n,":").concat(t))}else e.removeAttribute(t)}},{key:"addClass",value:function(e,t){e.classList.add(t)}},{key:"removeClass",value:function(e,t){e.classList.remove(t)}},{key:"setStyle",value:function(e,t,n,r){r&(R_.DashCase|R_.Important)?e.style.setProperty(t,n,r&R_.Important?"important":""):e.style[t]=n}},{key:"removeStyle",value:function(e,t,n){n&R_.DashCase?e.style.removeProperty(t):e.style[t]=""}},{key:"setProperty",value:function(e,t,n){e[t]=n}},{key:"setValue",value:function(e,t){e.nodeValue=t}},{key:"listen",value:function(e,t,n){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,oI(n)):this.eventManager.addEventListener(e,t,oI(n))}}]),e}(),cI=function(e){Gv(n,e);var t=$v(n);function n(e,r,i,a){var o;tp(this,n),(o=t.call(this,e)).component=i;var s=aI(a+"-"+i.id,i.styles,[]);return r.addStyles(s),o.contentAttr="_ngcontent-%COMP%".replace(iI,a+"-"+i.id),o.hostAttr=function(e){return"_nghost-%COMP%".replace(iI,e)}(a+"-"+i.id),o}return rp(n,[{key:"applyToHost",value:function(e){zv(Yv(n.prototype),"setAttribute",this).call(this,e,this.hostAttr,"")}},{key:"createElement",value:function(e,t){var r=zv(Yv(n.prototype),"createElement",this).call(this,e,t);return zv(Yv(n.prototype),"setAttribute",this).call(this,r,this.contentAttr,""),r}}]),n}(uI),lI=function(e){Gv(n,e);var t=$v(n);function n(e,r,i,a){var o;tp(this,n),(o=t.call(this,e)).sharedStylesHost=r,o.hostEl=i,o.shadowRoot=i.attachShadow({mode:"open"}),o.sharedStylesHost.addHost(o.shadowRoot);for(var s=aI(a.id,a.styles,[]),u=0;u<s.length;u++){var c=document.createElement("style");c.textContent=s[u],o.shadowRoot.appendChild(c)}return o}return rp(n,[{key:"nodeOrShadowRoot",value:function(e){return e===this.hostEl?this.shadowRoot:e}},{key:"destroy",value:function(){this.sharedStylesHost.removeHost(this.shadowRoot)}},{key:"appendChild",value:function(e,t){return zv(Yv(n.prototype),"appendChild",this).call(this,this.nodeOrShadowRoot(e),t)}},{key:"insertBefore",value:function(e,t,r){return zv(Yv(n.prototype),"insertBefore",this).call(this,this.nodeOrShadowRoot(e),t,r)}},{key:"removeChild",value:function(e,t){return zv(Yv(n.prototype),"removeChild",this).call(this,this.nodeOrShadowRoot(e),t)}},{key:"parentNode",value:function(e){return this.nodeOrShadowRoot(zv(Yv(n.prototype),"parentNode",this).call(this,this.nodeOrShadowRoot(e)))}}]),n}(uI),hI=function(){var e=function(e){Gv(n,e);var t=$v(n);function n(e){return tp(this,n),t.call(this,e)}return rp(n,[{key:"supports",value:function(e){return!0}},{key:"addEventListener",value:function(e,t,n){var r=this;return e.addEventListener(t,n,!1),function(){return r.removeEventListener(e,t,n)}}},{key:"removeEventListener",value:function(e,t,n){return e.removeEventListener(t,n)}}]),n}(XT);return e.\u0275fac=function(t){return new(t||e)(Pk(PO))},e.\u0275prov=Eg({token:e,factory:e.\u0275fac}),e}(),fI=["alt","control","meta","shift"],dI={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},vI={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},pI={alt:function(e){return e.altKey},control:function(e){return e.ctrlKey},meta:function(e){return e.metaKey},shift:function(e){return e.shiftKey}},gI=function(){var e=function(e){Gv(n,e);var t=$v(n);function n(e){return tp(this,n),t.call(this,e)}return rp(n,[{key:"supports",value:function(e){return null!=n.parseEventName(e)}},{key:"addEventListener",value:function(e,t,r){var i=n.parseEventName(t),a=n.eventCallback(i.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(function(){return SO().onAndCancel(e,i.domEventName,a)})}}],[{key:"parseEventName",value:function(e){var t=e.toLowerCase().split("."),r=t.shift();if(0===t.length||"keydown"!==r&&"keyup"!==r)return null;var i=n._normalizeKey(t.pop()),a="";if(fI.forEach(function(e){var n=t.indexOf(e);n>-1&&(t.splice(n,1),a+=e+".")}),a+=i,0!=t.length||0===i.length)return null;var o={};return o.domEventName=r,o.fullKey=a,o}},{key:"getEventFullKey",value:function(e){var t="",n=function(e){var t=e.key;if(null==t){if(null==(t=e.keyIdentifier))return"Unidentified";t.startsWith("U+")&&(t=String.fromCharCode(parseInt(t.substring(2),16)),3===e.location&&vI.hasOwnProperty(t)&&(t=vI[t]))}return dI[t]||t}(e);return" "===(n=n.toLowerCase())?n="space":"."===n&&(n="dot"),fI.forEach(function(r){r!=n&&pI[r](e)&&(t+=r+".")}),t+=n}},{key:"eventCallback",value:function(e,t,r){return function(i){n.getEventFullKey(i)===e&&r.runGuarded(function(){return t(i)})}}},{key:"_normalizeKey",value:function(e){switch(e){case"esc":return"escape";default:return e}}}]),n}(XT);return e.\u0275fac=function(t){return new(t||e)(Pk(PO))},e.\u0275prov=Eg({token:e,factory:e.\u0275fac}),e}(),yI=function(){var e=rp(function e(){tp(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Eg({factory:function(){return Pk(mI)},token:e,providedIn:"root"}),e}(),mI=function(){var e=function(e){Gv(n,e);var t=$v(n);function n(e){var r;return tp(this,n),(r=t.call(this))._doc=e,r}return rp(n,[{key:"sanitize",value:function(e,t){if(null==t)return null;switch(e){case y_.NONE:return t;case y_.HTML:return $k(t,"HTML")?qk(t):p_(this._doc,String(t)).toString();case y_.STYLE:return $k(t,"Style")?qk(t):t;case y_.SCRIPT:if($k(t,"Script"))return qk(t);throw new Error("unsafe value used in a script context");case y_.URL:return Wk(t),$k(t,"URL")?qk(t):Qk(String(t));case y_.RESOURCE_URL:if($k(t,"ResourceURL"))return qk(t);throw new Error("unsafe value used in a resource URL context (see https://g.co/ng/security#xss)");default:throw new Error("Unexpected SecurityContext ".concat(e," (see https://g.co/ng/security#xss)"))}}},{key:"bypassSecurityTrustHtml",value:function(e){return function(e){return new Vk(e)}(e)}},{key:"bypassSecurityTrustStyle",value:function(e){return function(e){return new Uk(e)}(e)}},{key:"bypassSecurityTrustScript",value:function(e){return function(e){return new zk(e)}(e)}},{key:"bypassSecurityTrustUrl",value:function(e){return function(e){return new Hk(e)}(e)}},{key:"bypassSecurityTrustResourceUrl",value:function(e){return function(e){return new Gk(e)}(e)}}]),n}(yI);return e.\u0275fac=function(t){return new(t||e)(Pk(PO))},e.\u0275prov=Eg({factory:function(){return function(e){return new mI(e.get(PO))}(Pk(SC))},token:e,providedIn:"root"}),e}(),kI=lO(wO,"browser",[{provide:MP,useValue:"browser"},{provide:NP,useValue:function(){$T.makeCurrent(),YT.init()},multi:!0},{provide:PO,useFactory:function(){return e=document,Sy=e,document;var e},deps:[]}]),_I=[[],{provide:OC,useValue:"root"},{provide:P_,useFactory:function(){return new P_},deps:[]},{provide:JT,useClass:hI,multi:!0,deps:[PO,YP,MP]},{provide:JT,useClass:gI,multi:!0,deps:[PO]},[],{provide:sI,useClass:sI,deps:[QT,tI,xP]},{provide:aS,useExisting:sI},{provide:eI,useExisting:tI},{provide:tI,useClass:tI,deps:[PO]},{provide:rO,useClass:rO,deps:[YP]},{provide:QT,useClass:QT,deps:[JT,YP]},{provide:qT,useClass:KT,deps:[]},[]],wI=function(){var e=function(){function e(t){if(tp(this,e),t)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}return rp(e,null,[{key:"withServerTransition",value:function(t){return{ngModule:e,providers:[{provide:xP,useValue:t.appId},{provide:jT,useExisting:xP},ZT]}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Pk(e,12))},e.\u0275mod=iy({type:e}),e.\u0275inj=Sg({providers:_I,imports:[VT,bO]}),e}();"undefined"!=typeof window&&window;var CI=Array.isArray,bI=Object.getPrototypeOf,EI=Object.prototype,SI=Object.keys;function PI(e){if(1===e.length){var t=e[0];if(CI(t))return{args:t,keys:null};if(function(e){return e&&"object"==typeof e&&bI(e)===EI}(t)){var n=SI(t);return{args:n.map(function(e){return t[e]}),keys:n}}}return{args:e,keys:null}}var OI=Array.isArray;function TI(e){return Lp(function(t){return function(e,t){return OI(t)?e.apply(void 0,Kv(t)):e(t)}(e,t)})}function II(e,t){return e.reduce(function(e,n,r){return e[n]=t[r],e},{})}var xI=function(){var e=function(){function e(t,n){tp(this,e),this._renderer=t,this._elementRef=n,this.onChange=function(e){},this.onTouched=function(){}}return rp(e,[{key:"setProperty",value:function(e,t){this._renderer.setProperty(this._elementRef.nativeElement,e,t)}},{key:"registerOnTouched",value:function(e){this.onTouched=e}},{key:"registerOnChange",value:function(e){this.onChange=e}},{key:"setDisabledState",value:function(e){this.setProperty("disabled",e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(sb(oS),sb(rS))},e.\u0275dir=oy({type:e}),e}(),AI=function(){var e,t=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n)}(xI);return t.\u0275fac=function(n){return(e||(e=tk(t)))(n||t)},t.\u0275dir=oy({type:t,features:[zC]}),t}(),RI=new ok("NgValueAccessor"),NI={provide:RI,useExisting:gg(function(){return DI}),multi:!0},MI=new ok("CompositionEventMode"),DI=function(){var e=function(e){Gv(n,e);var t=$v(n);function n(e,r,i){var a;return tp(this,n),(a=t.call(this,e,r))._compositionMode=i,a._composing=!1,null==a._compositionMode&&(a._compositionMode=!function(){var e=SO()?SO().getUserAgent():"";return/android (\d+)/.test(e.toLowerCase())}()),a}return rp(n,[{key:"writeValue",value:function(e){this.setProperty("value",null!=e?e:"")}},{key:"_handleInput",value:function(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}},{key:"_compositionStart",value:function(){this._composing=!0}},{key:"_compositionEnd",value:function(e){this._composing=!1,this._compositionMode&&this.onChange(e)}}]),n}(xI);return e.\u0275fac=function(t){return new(t||e)(sb(oS),sb(rS),sb(MI,8))},e.\u0275dir=oy({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(e,t){1&e&&mb("input",function(e){return t._handleInput(e.target.value)})("blur",function(){return t.onTouched()})("compositionstart",function(){return t._compositionStart()})("compositionend",function(e){return t._compositionEnd(e.target.value)})},features:[KE([NI]),zC]}),e}();function LI(e){return null==e||0===e.length}function FI(e){return null!=e&&"number"==typeof e.length}var BI=new ok("NgValidators"),VI=new ok("NgAsyncValidators"),UI=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,zI=function(){function e(){tp(this,e)}return rp(e,null,[{key:"min",value:function(e){return function(e){return function(t){if(LI(t.value)||LI(e))return null;var n=parseFloat(t.value);return!isNaN(n)&&n<e?{min:{min:e,actual:t.value}}:null}}(e)}},{key:"max",value:function(e){return function(e){return function(t){if(LI(t.value)||LI(e))return null;var n=parseFloat(t.value);return!isNaN(n)&&n>e?{max:{max:e,actual:t.value}}:null}}(e)}},{key:"required",value:function(e){return HI(e)}},{key:"requiredTrue",value:function(e){return function(e){return!0===e.value?null:{required:!0}}(e)}},{key:"email",value:function(e){return function(e){return LI(e.value)||UI.test(e.value)?null:{email:!0}}(e)}},{key:"minLength",value:function(e){return function(e){return function(t){return LI(t.value)||!FI(t.value)?null:t.value.length<e?{minlength:{requiredLength:e,actualLength:t.value.length}}:null}}(e)}},{key:"maxLength",value:function(e){return GI(e)}},{key:"pattern",value:function(e){return function(e){return e?("string"==typeof e?(n="","^"!==e.charAt(0)&&(n+="^"),n+=e,"$"!==e.charAt(e.length-1)&&(n+="$"),t=new RegExp(n)):(n=e.toString(),t=e),function(e){if(LI(e.value))return null;var r=e.value;return t.test(r)?null:{pattern:{requiredPattern:n,actualValue:r}}}):qI;var t,n}(e)}},{key:"nullValidator",value:function(e){return null}},{key:"compose",value:function(e){return KI(e)}},{key:"composeAsync",value:function(e){return QI(e)}}]),e}();function HI(e){return LI(e.value)?{required:!0}:null}function GI(e){return function(t){return FI(t.value)&&t.value.length>e?{maxlength:{requiredLength:e,actualLength:t.value.length}}:null}}function qI(e){return null}function $I(e){return null!=e}function WI(e){var t=gb(e)?ug(e):e;return yb(t),t}function jI(e){var t={};return e.forEach(function(e){t=null!=e?Object.assign(Object.assign({},t),e):t}),0===Object.keys(t).length?null:t}function ZI(e,t){return t.map(function(t){return t(e)})}function YI(e){return e.map(function(e){return function(e){return!e.validate}(e)?e:function(t){return e.validate(t)}})}function KI(e){if(!e)return null;var t=e.filter($I);return 0==t.length?null:function(e){return jI(ZI(e,t))}}function JI(e){return null!=e?KI(YI(e)):null}function QI(e){if(!e)return null;var t=e.filter($I);return 0==t.length?null:function(e){return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=rg(t),i=PI(t),a=i.args,o=i.keys,s=new Tp(function(e){var t=a.length;if(t)for(var n=new Array(t),r=t,i=t,s=function(t){var s=!1;Kp(a[t]).subscribe(new Dp(e,function(e){s||(s=!0,i--),n[t]=e},function(){return r--},void 0,function(){(!r||!s)&&(i||e.next(o?II(o,n):n),e.complete())}))},u=0;u<t;u++)s(u);else e.complete()});return r?s.pipe(TI(r)):s}(ZI(e,t).map(WI)).pipe(Lp(jI))}}function XI(e){return null!=e?QI(YI(e)):null}function ex(e,t){return null===e?[t]:Array.isArray(e)?[].concat(Kv(e),[t]):[e,t]}function tx(e){return e._rawValidators}function nx(e){return e._rawAsyncValidators}function rx(e){return e?Array.isArray(e)?e:[e]:[]}function ix(e,t){return Array.isArray(e)?e.includes(t):e===t}function ax(e,t){var n=rx(t);return rx(e).forEach(function(e){ix(n,e)||n.push(e)}),n}function ox(e,t){return rx(t).filter(function(t){return!ix(e,t)})}var sx=function(){var e=function(){function e(){tp(this,e),this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}return rp(e,[{key:"value",get:function(){return this.control?this.control.value:null}},{key:"valid",get:function(){return this.control?this.control.valid:null}},{key:"invalid",get:function(){return this.control?this.control.invalid:null}},{key:"pending",get:function(){return this.control?this.control.pending:null}},{key:"disabled",get:function(){return this.control?this.control.disabled:null}},{key:"enabled",get:function(){return this.control?this.control.enabled:null}},{key:"errors",get:function(){return this.control?this.control.errors:null}},{key:"pristine",get:function(){return this.control?this.control.pristine:null}},{key:"dirty",get:function(){return this.control?this.control.dirty:null}},{key:"touched",get:function(){return this.control?this.control.touched:null}},{key:"status",get:function(){return this.control?this.control.status:null}},{key:"untouched",get:function(){return this.control?this.control.untouched:null}},{key:"statusChanges",get:function(){return this.control?this.control.statusChanges:null}},{key:"valueChanges",get:function(){return this.control?this.control.valueChanges:null}},{key:"path",get:function(){return null}},{key:"_setValidators",value:function(e){this._rawValidators=e||[],this._composedValidatorFn=JI(this._rawValidators)}},{key:"_setAsyncValidators",value:function(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=XI(this._rawAsyncValidators)}},{key:"validator",get:function(){return this._composedValidatorFn||null}},{key:"asyncValidator",get:function(){return this._composedAsyncValidatorFn||null}},{key:"_registerOnDestroy",value:function(e){this._onDestroyCallbacks.push(e)}},{key:"_invokeOnDestroyCallbacks",value:function(){this._onDestroyCallbacks.forEach(function(e){return e()}),this._onDestroyCallbacks=[]}},{key:"reset",value:function(e){this.control&&this.control.reset(e)}},{key:"hasError",value:function(e,t){return!!this.control&&this.control.hasError(e,t)}},{key:"getError",value:function(e,t){return this.control?this.control.getError(e,t):null}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=oy({type:e}),e}(),ux=function(){var e,t=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"formDirective",get:function(){return null}},{key:"path",get:function(){return null}}]),n}(sx);return t.\u0275fac=function(n){return(e||(e=tk(t)))(n||t)},t.\u0275dir=oy({type:t,features:[zC]}),t}(),cx=function(e){Gv(n,e);var t=$v(n);function n(){var e;return tp(this,n),(e=t.apply(this,arguments))._parent=null,e.name=null,e.valueAccessor=null,e}return rp(n)}(sx),lx=function(){function e(t){tp(this,e),this._cd=t}return rp(e,[{key:"is",value:function(e){var t,n,r;return"submitted"===e?!!(null===(t=this._cd)||void 0===t?void 0:t.submitted):!!(null===(r=null===(n=this._cd)||void 0===n?void 0:n.control)||void 0===r?void 0:r[e])}}]),e}(),hx=function(){var e=function(e){Gv(n,e);var t=$v(n);function n(e){return tp(this,n),t.call(this,e)}return rp(n)}(lx);return e.\u0275fac=function(t){return new(t||e)(sb(cx,2))},e.\u0275dir=oy({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(e,t){2&e&&Ob("ng-untouched",t.is("untouched"))("ng-touched",t.is("touched"))("ng-pristine",t.is("pristine"))("ng-dirty",t.is("dirty"))("ng-valid",t.is("valid"))("ng-invalid",t.is("invalid"))("ng-pending",t.is("pending"))},features:[zC]}),e}(),fx=function(){var e=function(e){Gv(n,e);var t=$v(n);function n(e){return tp(this,n),t.call(this,e)}return rp(n)}(lx);return e.\u0275fac=function(t){return new(t||e)(sb(ux,10))},e.\u0275dir=oy({type:e,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(e,t){2&e&&Ob("ng-untouched",t.is("untouched"))("ng-touched",t.is("touched"))("ng-pristine",t.is("pristine"))("ng-dirty",t.is("dirty"))("ng-valid",t.is("valid"))("ng-invalid",t.is("invalid"))("ng-pending",t.is("pending"))("ng-submitted",t.is("submitted"))},features:[zC]}),e}();function dx(e,t){return[].concat(Kv(t.path),[e])}function vx(e,t){yx(e,t),t.valueAccessor.writeValue(e.value),function(e,t){t.valueAccessor.registerOnChange(function(n){e._pendingValue=n,e._pendingChange=!0,e._pendingDirty=!0,"change"===e.updateOn&&kx(e,t)})}(e,t),function(e,t){var n=function(e,n){t.valueAccessor.writeValue(e),n&&t.viewToModelUpdate(e)};e.registerOnChange(n),t._registerOnDestroy(function(){e._unregisterOnChange(n)})}(e,t),function(e,t){t.valueAccessor.registerOnTouched(function(){e._pendingTouched=!0,"blur"===e.updateOn&&e._pendingChange&&kx(e,t),"submit"!==e.updateOn&&e.markAsTouched()})}(e,t),function(e,t){if(t.valueAccessor.setDisabledState){var n=function(e){t.valueAccessor.setDisabledState(e)};e.registerOnDisabledChange(n),t._registerOnDestroy(function(){e._unregisterOnDisabledChange(n)})}}(e,t)}function px(e,t){var n=function(){};t.valueAccessor&&(t.valueAccessor.registerOnChange(n),t.valueAccessor.registerOnTouched(n)),mx(e,t),e&&(t._invokeOnDestroyCallbacks(),e._registerOnCollectionChange(function(){}))}function gx(e,t){e.forEach(function(e){e.registerOnValidatorChange&&e.registerOnValidatorChange(t)})}function yx(e,t){var n=tx(e);null!==t.validator?e.setValidators(ex(n,t.validator)):"function"==typeof n&&e.setValidators([n]);var r=nx(e);null!==t.asyncValidator?e.setAsyncValidators(ex(r,t.asyncValidator)):"function"==typeof r&&e.setAsyncValidators([r]);var i=function(){return e.updateValueAndValidity()};gx(t._rawValidators,i),gx(t._rawAsyncValidators,i)}function mx(e,t){var n=!1;if(null!==e){if(null!==t.validator){var r=tx(e);if(Array.isArray(r)&&r.length>0){var i=r.filter(function(e){return e!==t.validator});i.length!==r.length&&(n=!0,e.setValidators(i))}}if(null!==t.asyncValidator){var a=nx(e);if(Array.isArray(a)&&a.length>0){var o=a.filter(function(e){return e!==t.asyncValidator});o.length!==a.length&&(n=!0,e.setAsyncValidators(o))}}}var s=function(){};return gx(t._rawValidators,s),gx(t._rawAsyncValidators,s),n}function kx(e,t){e._pendingDirty&&e.markAsDirty(),e.setValue(e._pendingValue,{emitModelToViewChange:!1}),t.viewToModelUpdate(e._pendingValue),e._pendingChange=!1}function _x(e,t){yx(e,t)}function wx(e,t){if(!e.hasOwnProperty("model"))return!1;var n=e.model;return!!n.isFirstChange()||!Object.is(t,n.currentValue)}function Cx(e,t){e._syncPendingControls(),t.forEach(function(e){var t=e.control;"submit"===t.updateOn&&t._pendingChange&&(e.viewToModelUpdate(t._pendingValue),t._pendingChange=!1)})}function bx(e,t){return t?(Array.isArray(t),t.forEach(function(e){e.constructor===DI?n=e:function(e){return Object.getPrototypeOf(e.constructor)===AI}(e)?r=e:i=e}),i||r||n||null):null;var n,r,i}function Ex(e,t){var n=e.indexOf(t);n>-1&&e.splice(n,1)}var Sx="VALID",Px="INVALID",Ox="PENDING",Tx="DISABLED";function Ix(e){return(Nx(e)?e.validators:e)||null}function xx(e){return Array.isArray(e)?JI(e):e||null}function Ax(e,t){return(Nx(t)?t.asyncValidators:e)||null}function Rx(e){return Array.isArray(e)?XI(e):e||null}function Nx(e){return null!=e&&!Array.isArray(e)&&"object"==typeof e}var Mx=function(){function e(t,n){tp(this,e),this._hasOwnPendingAsyncValidator=!1,this._onCollectionChange=function(){},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._rawValidators=t,this._rawAsyncValidators=n,this._composedValidatorFn=xx(this._rawValidators),this._composedAsyncValidatorFn=Rx(this._rawAsyncValidators)}return rp(e,[{key:"validator",get:function(){return this._composedValidatorFn},set:function(e){this._rawValidators=this._composedValidatorFn=e}},{key:"asyncValidator",get:function(){return this._composedAsyncValidatorFn},set:function(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}},{key:"parent",get:function(){return this._parent}},{key:"valid",get:function(){return this.status===Sx}},{key:"invalid",get:function(){return this.status===Px}},{key:"pending",get:function(){return this.status==Ox}},{key:"disabled",get:function(){return this.status===Tx}},{key:"enabled",get:function(){return this.status!==Tx}},{key:"dirty",get:function(){return!this.pristine}},{key:"untouched",get:function(){return!this.touched}},{key:"updateOn",get:function(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}},{key:"setValidators",value:function(e){this._rawValidators=e,this._composedValidatorFn=xx(e)}},{key:"setAsyncValidators",value:function(e){this._rawAsyncValidators=e,this._composedAsyncValidatorFn=Rx(e)}},{key:"addValidators",value:function(e){this.setValidators(ax(e,this._rawValidators))}},{key:"addAsyncValidators",value:function(e){this.setAsyncValidators(ax(e,this._rawAsyncValidators))}},{key:"removeValidators",value:function(e){this.setValidators(ox(e,this._rawValidators))}},{key:"removeAsyncValidators",value:function(e){this.setAsyncValidators(ox(e,this._rawAsyncValidators))}},{key:"hasValidator",value:function(e){return ix(this._rawValidators,e)}},{key:"hasAsyncValidator",value:function(e){return ix(this._rawAsyncValidators,e)}},{key:"clearValidators",value:function(){this.validator=null}},{key:"clearAsyncValidators",value:function(){this.asyncValidator=null}},{key:"markAsTouched",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}},{key:"markAllAsTouched",value:function(){this.markAsTouched({onlySelf:!0}),this._forEachChild(function(e){return e.markAllAsTouched()})}},{key:"markAsUntouched",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.touched=!1,this._pendingTouched=!1,this._forEachChild(function(e){e.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}},{key:"markAsDirty",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}},{key:"markAsPristine",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.pristine=!0,this._pendingDirty=!1,this._forEachChild(function(e){e.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}},{key:"markAsPending",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.status=Ox,!1!==e.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}},{key:"disable",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this._parentMarkedDirty(e.onlySelf);this.status=Tx,this.errors=null,this._forEachChild(function(t){t.disable(Object.assign(Object.assign({},e),{onlySelf:!0}))}),this._updateValue(),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Object.assign(Object.assign({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(function(e){return e(!0)})}},{key:"enable",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this._parentMarkedDirty(e.onlySelf);this.status=Sx,this._forEachChild(function(t){t.enable(Object.assign(Object.assign({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(Object.assign(Object.assign({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(function(e){return e(!1)})}},{key:"_updateAncestors",value:function(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}},{key:"setParent",value:function(e){this._parent=e}},{key:"updateValueAndValidity",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Sx||this.status===Ox)&&this._runAsyncValidator(e.emitEvent)),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}},{key:"_updateTreeValidity",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{emitEvent:!0};this._forEachChild(function(t){return t._updateTreeValidity(e)}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}},{key:"_setInitialStatus",value:function(){this.status=this._allControlsDisabled()?Tx:Sx}},{key:"_runValidator",value:function(){return this.validator?this.validator(this):null}},{key:"_runAsyncValidator",value:function(e){var t=this;if(this.asyncValidator){this.status=Ox,this._hasOwnPendingAsyncValidator=!0;var n=WI(this.asyncValidator(this));this._asyncValidationSubscription=n.subscribe(function(n){t._hasOwnPendingAsyncValidator=!1,t.setErrors(n,{emitEvent:e})})}}},{key:"_cancelExistingSubscription",value:function(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}},{key:"setErrors",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.errors=e,this._updateControlsErrors(!1!==t.emitEvent)}},{key:"get",value:function(e){return function(e,t,n){if(null==t||(Array.isArray(t)||(t=t.split(".")),Array.isArray(t)&&0===t.length))return null;var r=e;return t.forEach(function(e){r=r instanceof Lx?r.controls.hasOwnProperty(e)?r.controls[e]:null:r instanceof Fx&&r.at(e)||null}),r}(this,e)}},{key:"getError",value:function(e,t){var n=t?this.get(t):this;return n&&n.errors?n.errors[e]:null}},{key:"hasError",value:function(e,t){return!!this.getError(e,t)}},{key:"root",get:function(){for(var e=this;e._parent;)e=e._parent;return e}},{key:"_updateControlsErrors",value:function(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}},{key:"_initObservables",value:function(){this.valueChanges=new hP,this.statusChanges=new hP}},{key:"_calculateStatus",value:function(){return this._allControlsDisabled()?Tx:this.errors?Px:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Ox)?Ox:this._anyControlsHaveStatus(Px)?Px:Sx}},{key:"_anyControlsHaveStatus",value:function(e){return this._anyControls(function(t){return t.status===e})}},{key:"_anyControlsDirty",value:function(){return this._anyControls(function(e){return e.dirty})}},{key:"_anyControlsTouched",value:function(){return this._anyControls(function(e){return e.touched})}},{key:"_updatePristine",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}},{key:"_updateTouched",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}},{key:"_isBoxedValue",value:function(e){return"object"==typeof e&&null!==e&&2===Object.keys(e).length&&"value"in e&&"disabled"in e}},{key:"_registerOnCollectionChange",value:function(e){this._onCollectionChange=e}},{key:"_setUpdateStrategy",value:function(e){Nx(e)&&null!=e.updateOn&&(this._updateOn=e.updateOn)}},{key:"_parentMarkedDirty",value:function(e){return!e&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}}]),e}(),Dx=function(e){Gv(n,e);var t=$v(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1?arguments[1]:void 0,a=arguments.length>2?arguments[2]:void 0;return tp(this,n),(e=t.call(this,Ix(i),Ax(a,i)))._onChange=[],e._applyFormState(r),e._setUpdateStrategy(i),e._initObservables(),e.updateValueAndValidity({onlySelf:!0,emitEvent:!!e.asyncValidator}),e}return rp(n,[{key:"setValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.value=this._pendingValue=e,this._onChange.length&&!1!==n.emitModelToViewChange&&this._onChange.forEach(function(e){return e(t.value,!1!==n.emitViewToModelChange)}),this.updateValueAndValidity(n)}},{key:"patchValue",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.setValue(e,t)}},{key:"reset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}},{key:"_updateValue",value:function(){}},{key:"_anyControls",value:function(e){return!1}},{key:"_allControlsDisabled",value:function(){return this.disabled}},{key:"registerOnChange",value:function(e){this._onChange.push(e)}},{key:"_unregisterOnChange",value:function(e){Ex(this._onChange,e)}},{key:"registerOnDisabledChange",value:function(e){this._onDisabledChange.push(e)}},{key:"_unregisterOnDisabledChange",value:function(e){Ex(this._onDisabledChange,e)}},{key:"_forEachChild",value:function(e){}},{key:"_syncPendingControls",value:function(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}},{key:"_applyFormState",value:function(e){this._isBoxedValue(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}}]),n}(Mx),Lx=function(e){Gv(n,e);var t=$v(n);function n(e,r,i){var a;return tp(this,n),(a=t.call(this,Ix(r),Ax(i,r))).controls=e,a._initObservables(),a._setUpdateStrategy(r),a._setUpControls(),a.updateValueAndValidity({onlySelf:!0,emitEvent:!!a.asyncValidator}),a}return rp(n,[{key:"registerControl",value:function(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}},{key:"addControl",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.registerControl(e,t),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}},{key:"removeControl",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.controls[e]&&this.controls[e]._registerOnCollectionChange(function(){}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}},{key:"setControl",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.controls[e]&&this.controls[e]._registerOnCollectionChange(function(){}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}},{key:"contains",value:function(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}},{key:"setValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._checkAllValuesPresent(e),Object.keys(e).forEach(function(r){t._throwIfControlMissing(r),t.controls[r].setValue(e[r],{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n)}},{key:"patchValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};null!=e&&(Object.keys(e).forEach(function(r){t.controls[r]&&t.controls[r].patchValue(e[r],{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n))}},{key:"reset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._forEachChild(function(n,r){n.reset(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}},{key:"getRawValue",value:function(){return this._reduceChildren({},function(e,t,n){return e[n]=t instanceof Dx?t.value:t.getRawValue(),e})}},{key:"_syncPendingControls",value:function(){var e=this._reduceChildren(!1,function(e,t){return!!t._syncPendingControls()||e});return e&&this.updateValueAndValidity({onlySelf:!0}),e}},{key:"_throwIfControlMissing",value:function(e){if(!Object.keys(this.controls).length)throw new Error("\n        There are no form controls registered with this group yet. If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.controls[e])throw new Error("Cannot find form control with name: ".concat(e,"."))}},{key:"_forEachChild",value:function(e){var t=this;Object.keys(this.controls).forEach(function(n){var r=t.controls[n];r&&e(r,n)})}},{key:"_setUpControls",value:function(){var e=this;this._forEachChild(function(t){t.setParent(e),t._registerOnCollectionChange(e._onCollectionChange)})}},{key:"_updateValue",value:function(){this.value=this._reduceValue()}},{key:"_anyControls",value:function(e){for(var t=0,n=Object.keys(this.controls);t<n.length;t++){var r=n[t],i=this.controls[r];if(this.contains(r)&&e(i))return!0}return!1}},{key:"_reduceValue",value:function(){var e=this;return this._reduceChildren({},function(t,n,r){return(n.enabled||e.disabled)&&(t[r]=n.value),t})}},{key:"_reduceChildren",value:function(e,t){var n=e;return this._forEachChild(function(e,r){n=t(n,e,r)}),n}},{key:"_allControlsDisabled",value:function(){for(var e=0,t=Object.keys(this.controls);e<t.length;e++){var n=t[e];if(this.controls[n].enabled)return!1}return Object.keys(this.controls).length>0||this.disabled}},{key:"_checkAllValuesPresent",value:function(e){this._forEachChild(function(t,n){if(void 0===e[n])throw new Error("Must supply a value for form control with name: '".concat(n,"'."))})}}]),n}(Mx),Fx=function(e){Gv(n,e);var t=$v(n);function n(e,r,i){var a;return tp(this,n),(a=t.call(this,Ix(r),Ax(i,r))).controls=e,a._initObservables(),a._setUpdateStrategy(r),a._setUpControls(),a.updateValueAndValidity({onlySelf:!0,emitEvent:!!a.asyncValidator}),a}return rp(n,[{key:"at",value:function(e){return this.controls[e]}},{key:"push",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.controls.push(e),this._registerControl(e),this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}},{key:"insert",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.controls.splice(e,0,t),this._registerControl(t),this.updateValueAndValidity({emitEvent:n.emitEvent})}},{key:"removeAt",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.controls[e]&&this.controls[e]._registerOnCollectionChange(function(){}),this.controls.splice(e,1),this.updateValueAndValidity({emitEvent:t.emitEvent})}},{key:"setControl",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.controls[e]&&this.controls[e]._registerOnCollectionChange(function(){}),this.controls.splice(e,1),t&&(this.controls.splice(e,0,t),this._registerControl(t)),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}},{key:"length",get:function(){return this.controls.length}},{key:"setValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._checkAllValuesPresent(e),e.forEach(function(e,r){t._throwIfControlMissing(r),t.at(r).setValue(e,{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n)}},{key:"patchValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};null!=e&&(e.forEach(function(e,r){t.at(r)&&t.at(r).patchValue(e,{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n))}},{key:"reset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._forEachChild(function(n,r){n.reset(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}},{key:"getRawValue",value:function(){return this.controls.map(function(e){return e instanceof Dx?e.value:e.getRawValue()})}},{key:"clear",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.controls.length<1||(this._forEachChild(function(e){return e._registerOnCollectionChange(function(){})}),this.controls.splice(0),this.updateValueAndValidity({emitEvent:e.emitEvent}))}},{key:"_syncPendingControls",value:function(){var e=this.controls.reduce(function(e,t){return!!t._syncPendingControls()||e},!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}},{key:"_throwIfControlMissing",value:function(e){if(!this.controls.length)throw new Error("\n        There are no form controls registered with this array yet. If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.at(e))throw new Error("Cannot find form control at index ".concat(e))}},{key:"_forEachChild",value:function(e){this.controls.forEach(function(t,n){e(t,n)})}},{key:"_updateValue",value:function(){var e=this;this.value=this.controls.filter(function(t){return t.enabled||e.disabled}).map(function(e){return e.value})}},{key:"_anyControls",value:function(e){return this.controls.some(function(t){return t.enabled&&e(t)})}},{key:"_setUpControls",value:function(){var e=this;this._forEachChild(function(t){return e._registerControl(t)})}},{key:"_checkAllValuesPresent",value:function(e){this._forEachChild(function(t,n){if(void 0===e[n])throw new Error("Must supply a value for form control at index: ".concat(n,"."))})}},{key:"_allControlsDisabled",value:function(){var e,t=Qv(this.controls);try{for(t.s();!(e=t.n()).done;){if(e.value.enabled)return!1}}catch(n){t.e(n)}finally{t.f()}return this.controls.length>0||this.disabled}},{key:"_registerControl",value:function(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}}]),n}(Mx),Bx={provide:ux,useExisting:gg(function(){return Ux})},Vx=Promise.resolve(null),Ux=function(){var e=function(e){Gv(n,e);var t=$v(n);function n(e,r){var i;return tp(this,n),(i=t.call(this)).submitted=!1,i._directives=[],i.ngSubmit=new hP,i.form=new Lx({},JI(e),XI(r)),i}return rp(n,[{key:"ngAfterViewInit",value:function(){this._setUpdateStrategy()}},{key:"formDirective",get:function(){return this}},{key:"control",get:function(){return this.form}},{key:"path",get:function(){return[]}},{key:"controls",get:function(){return this.form.controls}},{key:"addControl",value:function(e){var t=this;Vx.then(function(){var n=t._findContainer(e.path);e.control=n.registerControl(e.name,e.control),vx(e.control,e),e.control.updateValueAndValidity({emitEvent:!1}),t._directives.push(e)})}},{key:"getControl",value:function(e){return this.form.get(e.path)}},{key:"removeControl",value:function(e){var t=this;Vx.then(function(){var n=t._findContainer(e.path);n&&n.removeControl(e.name),Ex(t._directives,e)})}},{key:"addFormGroup",value:function(e){var t=this;Vx.then(function(){var n=t._findContainer(e.path),r=new Lx({});_x(r,e),n.registerControl(e.name,r),r.updateValueAndValidity({emitEvent:!1})})}},{key:"removeFormGroup",value:function(e){var t=this;Vx.then(function(){var n=t._findContainer(e.path);n&&n.removeControl(e.name)})}},{key:"getFormGroup",value:function(e){return this.form.get(e.path)}},{key:"updateModel",value:function(e,t){var n=this;Vx.then(function(){n.form.get(e.path).setValue(t)})}},{key:"setValue",value:function(e){this.control.setValue(e)}},{key:"onSubmit",value:function(e){return this.submitted=!0,Cx(this.form,this._directives),this.ngSubmit.emit(e),!1}},{key:"onReset",value:function(){this.resetForm()}},{key:"resetForm",value:function(e){this.form.reset(e),this.submitted=!1}},{key:"_setUpdateStrategy",value:function(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}},{key:"_findContainer",value:function(e){return e.pop(),e.length?this.form.get(e):this.form}}]),n}(ux);return e.\u0275fac=function(t){return new(t||e)(sb(BI,10),sb(VI,10))},e.\u0275dir=oy({type:e,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(e,t){1&e&&mb("submit",function(e){return t.onSubmit(e)})("reset",function(){return t.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[KE([Bx]),zC]}),e}(),zx={provide:cx,useExisting:gg(function(){return Gx})},Hx=Promise.resolve(null),Gx=function(){var e=function(e){Gv(n,e);var t=$v(n);function n(e,r,i,a){var o;return tp(this,n),(o=t.call(this)).control=new Dx,o._registered=!1,o.update=new hP,o._parent=e,o._setValidators(r),o._setAsyncValidators(i),o.valueAccessor=bx(0,a),o}return rp(n,[{key:"ngOnChanges",value:function(e){this._checkForErrors(),this._registered||this._setUpControl(),"isDisabled"in e&&this._updateDisabled(e),wx(e,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}},{key:"ngOnDestroy",value:function(){this.formDirective&&this.formDirective.removeControl(this)}},{key:"path",get:function(){return this._parent?dx(this.name,this._parent):[this.name]}},{key:"formDirective",get:function(){return this._parent?this._parent.formDirective:null}},{key:"viewToModelUpdate",value:function(e){this.viewModel=e,this.update.emit(e)}},{key:"_setUpControl",value:function(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}},{key:"_setUpdateStrategy",value:function(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}},{key:"_isStandalone",value:function(){return!this._parent||!(!this.options||!this.options.standalone)}},{key:"_setUpStandalone",value:function(){vx(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}},{key:"_checkForErrors",value:function(){this._isStandalone()||this._checkParentType(),this._checkName()}},{key:"_checkParentType",value:function(){}},{key:"_checkName",value:function(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}},{key:"_updateValue",value:function(e){var t=this;Hx.then(function(){t.control.setValue(e,{emitViewToModelChange:!1})})}},{key:"_updateDisabled",value:function(e){var t=this,n=e.isDisabled.currentValue,r=""===n||n&&"false"!==n;Hx.then(function(){r&&!t.control.disabled?t.control.disable():!r&&t.control.disabled&&t.control.enable()})}}]),n}(cx);return e.\u0275fac=function(t){return new(t||e)(sb(ux,9),sb(BI,10),sb(VI,10),sb(RI,10))},e.\u0275dir=oy({type:e,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[KE([zx]),zC,ky]}),e}(),qx=function(){var e=rp(function e(){tp(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=oy({type:e,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),e}(),$x=function(){var e=rp(function e(){tp(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=iy({type:e}),e.\u0275inj=Sg({}),e}(),Wx={provide:RI,useExisting:gg(function(){return jx}),multi:!0},jx=function(){var e,t=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"writeValue",value:function(e){this.setProperty("value",parseFloat(e))}},{key:"registerOnChange",value:function(e){this.onChange=function(t){e(""==t?null:parseFloat(t))}}}]),n}(AI);return t.\u0275fac=function(n){return(e||(e=tk(t)))(n||t)},t.\u0275dir=oy({type:t,selectors:[["input","type","range","formControlName",""],["input","type","range","formControl",""],["input","type","range","ngModel",""]],hostBindings:function(e,t){1&e&&mb("change",function(e){return t.onChange(e.target.value)})("input",function(e){return t.onChange(e.target.value)})("blur",function(){return t.onTouched()})},features:[KE([Wx]),zC]}),t}(),Zx=new ok("NgModelWithFormControlWarning"),Yx={provide:ux,useExisting:gg(function(){return Kx})},Kx=function(){var e=function(e){Gv(n,e);var t=$v(n);function n(e,r){var i;return tp(this,n),(i=t.call(this)).validators=e,i.asyncValidators=r,i.submitted=!1,i._onCollectionChange=function(){return i._updateDomValue()},i.directives=[],i.form=null,i.ngSubmit=new hP,i._setValidators(e),i._setAsyncValidators(r),i}return rp(n,[{key:"ngOnChanges",value:function(e){this._checkFormPresent(),e.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}},{key:"ngOnDestroy",value:function(){this.form&&(mx(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(function(){}))}},{key:"formDirective",get:function(){return this}},{key:"control",get:function(){return this.form}},{key:"path",get:function(){return[]}},{key:"addControl",value:function(e){var t=this.form.get(e.path);return vx(t,e),t.updateValueAndValidity({emitEvent:!1}),this.directives.push(e),t}},{key:"getControl",value:function(e){return this.form.get(e.path)}},{key:"removeControl",value:function(e){px(e.control||null,e,!1),Ex(this.directives,e)}},{key:"addFormGroup",value:function(e){this._setUpFormContainer(e)}},{key:"removeFormGroup",value:function(e){this._cleanUpFormContainer(e)}},{key:"getFormGroup",value:function(e){return this.form.get(e.path)}},{key:"addFormArray",value:function(e){this._setUpFormContainer(e)}},{key:"removeFormArray",value:function(e){this._cleanUpFormContainer(e)}},{key:"getFormArray",value:function(e){return this.form.get(e.path)}},{key:"updateModel",value:function(e,t){this.form.get(e.path).setValue(t)}},{key:"onSubmit",value:function(e){return this.submitted=!0,Cx(this.form,this.directives),this.ngSubmit.emit(e),!1}},{key:"onReset",value:function(){this.resetForm()}},{key:"resetForm",value:function(e){this.form.reset(e),this.submitted=!1}},{key:"_updateDomValue",value:function(){var e=this;this.directives.forEach(function(t){var n=t.control,r=e.form.get(t.path);n!==r&&(px(n||null,t),r instanceof Dx&&(vx(r,t),t.control=r))}),this.form._updateTreeValidity({emitEvent:!1})}},{key:"_setUpFormContainer",value:function(e){var t=this.form.get(e.path);_x(t,e),t.updateValueAndValidity({emitEvent:!1})}},{key:"_cleanUpFormContainer",value:function(e){if(this.form){var t=this.form.get(e.path);t&&function(e,t){return mx(e,t)}(t,e)&&t.updateValueAndValidity({emitEvent:!1})}}},{key:"_updateRegistrations",value:function(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(function(){})}},{key:"_updateValidators",value:function(){yx(this.form,this),this._oldForm&&mx(this._oldForm,this)}},{key:"_checkFormPresent",value:function(){}}]),n}(ux);return e.\u0275fac=function(t){return new(t||e)(sb(BI,10),sb(VI,10))},e.\u0275dir=oy({type:e,selectors:[["","formGroup",""]],hostBindings:function(e,t){1&e&&mb("submit",function(e){return t.onSubmit(e)})("reset",function(){return t.onReset()})},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[KE([Yx]),zC,ky]}),e}(),Jx={provide:cx,useExisting:gg(function(){return Qx})},Qx=function(){var e=function(e){Gv(n,e);var t=$v(n);function n(e,r,i,a,o){var s;return tp(this,n),(s=t.call(this))._ngModelWarningConfig=o,s._added=!1,s.update=new hP,s._ngModelWarningSent=!1,s._parent=e,s._setValidators(r),s._setAsyncValidators(i),s.valueAccessor=bx(0,a),s}return rp(n,[{key:"isDisabled",set:function(e){}},{key:"ngOnChanges",value:function(e){this._added||this._setUpControl(),wx(e,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}},{key:"ngOnDestroy",value:function(){this.formDirective&&this.formDirective.removeControl(this)}},{key:"viewToModelUpdate",value:function(e){this.viewModel=e,this.update.emit(e)}},{key:"path",get:function(){return dx(null==this.name?this.name:this.name.toString(),this._parent)}},{key:"formDirective",get:function(){return this._parent?this._parent.formDirective:null}},{key:"_checkParentType",value:function(){}},{key:"_setUpControl",value:function(){this._checkParentType(),this.control=this.formDirective.addControl(this),this.control.disabled&&this.valueAccessor.setDisabledState&&this.valueAccessor.setDisabledState(!0),this._added=!0}}]),n}(cx);return e.\u0275fac=function(t){return new(t||e)(sb(ux,13),sb(BI,10),sb(VI,10),sb(RI,10),sb(Zx,8))},e.\u0275dir=oy({type:e,selectors:[["","formControlName",""]],inputs:{isDisabled:["disabled","isDisabled"],name:["formControlName","name"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},features:[KE([Jx]),zC,ky]}),e._ngModelWarningSentOnce=!1,e}(),Xx={provide:RI,useExisting:gg(function(){return tA}),multi:!0};function eA(e,t){return null==e?"".concat(t):(t&&"object"==typeof t&&(t="Object"),"".concat(e,": ").concat(t).slice(0,50))}var tA=function(){var e,t=function(e){Gv(n,e);var t=$v(n);function n(){var e;return tp(this,n),(e=t.apply(this,arguments))._optionMap=new Map,e._idCounter=0,e._compareWith=Object.is,e}return rp(n,[{key:"compareWith",set:function(e){this._compareWith=e}},{key:"writeValue",value:function(e){this.value=e;var t=this._getOptionId(e);null==t&&this.setProperty("selectedIndex",-1);var n=eA(t,e);this.setProperty("value",n)}},{key:"registerOnChange",value:function(e){var t=this;this.onChange=function(n){t.value=t._getOptionValue(n),e(t.value)}}},{key:"_registerOption",value:function(){return(this._idCounter++).toString()}},{key:"_getOptionId",value:function(e){for(var t=0,n=Array.from(this._optionMap.keys());t<n.length;t++){var r=n[t];if(this._compareWith(this._optionMap.get(r),e))return r}return null}},{key:"_getOptionValue",value:function(e){var t=function(e){return e.split(":")[0]}(e);return this._optionMap.has(t)?this._optionMap.get(t):e}}]),n}(AI);return t.\u0275fac=function(n){return(e||(e=tk(t)))(n||t)},t.\u0275dir=oy({type:t,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(e,t){1&e&&mb("change",function(e){return t.onChange(e.target.value)})("blur",function(){return t.onTouched()})},inputs:{compareWith:"compareWith"},features:[KE([Xx]),zC]}),t}(),nA=function(){var e=function(){function e(t,n,r){tp(this,e),this._element=t,this._renderer=n,this._select=r,this._select&&(this.id=this._select._registerOption())}return rp(e,[{key:"ngValue",set:function(e){null!=this._select&&(this._select._optionMap.set(this.id,e),this._setElementValue(eA(this.id,e)),this._select.writeValue(this._select.value))}},{key:"value",set:function(e){this._setElementValue(e),this._select&&this._select.writeValue(this._select.value)}},{key:"_setElementValue",value:function(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}},{key:"ngOnDestroy",value:function(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(sb(rS),sb(oS),sb(tA,9))},e.\u0275dir=oy({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),e}(),rA={provide:RI,useExisting:gg(function(){return aA}),multi:!0};function iA(e,t){return null==e?"".concat(t):("string"==typeof t&&(t="'".concat(t,"'")),t&&"object"==typeof t&&(t="Object"),"".concat(e,": ").concat(t).slice(0,50))}var aA=function(){var e,t=function(e){Gv(n,e);var t=$v(n);function n(){var e;return tp(this,n),(e=t.apply(this,arguments))._optionMap=new Map,e._idCounter=0,e._compareWith=Object.is,e}return rp(n,[{key:"compareWith",set:function(e){this._compareWith=e}},{key:"writeValue",value:function(e){var t,n=this;if(this.value=e,Array.isArray(e)){var r=e.map(function(e){return n._getOptionId(e)});t=function(e,t){e._setSelected(r.indexOf(t.toString())>-1)}}else t=function(e,t){e._setSelected(!1)};this._optionMap.forEach(t)}},{key:"registerOnChange",value:function(e){var t=this;this.onChange=function(n){var r=[];if(void 0!==n.selectedOptions)for(var i=n.selectedOptions,a=0;a<i.length;a++){var o=i.item(a),s=t._getOptionValue(o.value);r.push(s)}else for(var u=n.options,c=0;c<u.length;c++){var l=u.item(c);if(l.selected){var h=t._getOptionValue(l.value);r.push(h)}}t.value=r,e(r)}}},{key:"_registerOption",value:function(e){var t=(this._idCounter++).toString();return this._optionMap.set(t,e),t}},{key:"_getOptionId",value:function(e){for(var t=0,n=Array.from(this._optionMap.keys());t<n.length;t++){var r=n[t];if(this._compareWith(this._optionMap.get(r)._value,e))return r}return null}},{key:"_getOptionValue",value:function(e){var t=function(e){return e.split(":")[0]}(e);return this._optionMap.has(t)?this._optionMap.get(t)._value:e}}]),n}(AI);return t.\u0275fac=function(n){return(e||(e=tk(t)))(n||t)},t.\u0275dir=oy({type:t,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(e,t){1&e&&mb("change",function(e){return t.onChange(e.target)})("blur",function(){return t.onTouched()})},inputs:{compareWith:"compareWith"},features:[KE([rA]),zC]}),t}(),oA=function(){var e=function(){function e(t,n,r){tp(this,e),this._element=t,this._renderer=n,this._select=r,this._select&&(this.id=this._select._registerOption(this))}return rp(e,[{key:"ngValue",set:function(e){null!=this._select&&(this._value=e,this._setElementValue(iA(this.id,e)),this._select.writeValue(this._select.value))}},{key:"value",set:function(e){this._select?(this._value=e,this._setElementValue(iA(this.id,e)),this._select.writeValue(this._select.value)):this._setElementValue(e)}},{key:"_setElementValue",value:function(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}},{key:"_setSelected",value:function(e){this._renderer.setProperty(this._element.nativeElement,"selected",e)}},{key:"ngOnDestroy",value:function(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(sb(rS),sb(oS),sb(aA,9))},e.\u0275dir=oy({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),e}(),sA={provide:BI,useExisting:gg(function(){return uA}),multi:!0},uA=function(){var e=function(){function e(){tp(this,e),this._required=!1}return rp(e,[{key:"required",get:function(){return this._required},set:function(e){this._required=null!=e&&!1!==e&&"false"!="".concat(e),this._onChange&&this._onChange()}},{key:"validate",value:function(e){return this.required?HI(e):null}},{key:"registerOnValidatorChange",value:function(e){this._onChange=e}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=oy({type:e,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(e,t){2&e&&tb("required",t.required?"":null)},inputs:{required:"required"},features:[KE([sA])]}),e}(),cA={provide:BI,useExisting:gg(function(){return lA}),multi:!0},lA=function(){var e=function(){function e(){tp(this,e),this._validator=qI}return rp(e,[{key:"ngOnChanges",value:function(e){"maxlength"in e&&(this._createValidator(),this._onChange&&this._onChange())}},{key:"validate",value:function(e){return this.enabled()?this._validator(e):null}},{key:"registerOnValidatorChange",value:function(e){this._onChange=e}},{key:"_createValidator",value:function(){this._validator=this.enabled()?GI(function(e){return"number"==typeof e?e:parseInt(e,10)}(this.maxlength)):qI}},{key:"enabled",value:function(){return null!=this.maxlength}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=oy({type:e,selectors:[["","maxlength","","formControlName",""],["","maxlength","","formControl",""],["","maxlength","","ngModel",""]],hostVars:1,hostBindings:function(e,t){2&e&&tb("maxlength",t.enabled()?t.maxlength:null)},inputs:{maxlength:"maxlength"},features:[KE([cA]),ky]}),e}(),hA=function(){var e=rp(function e(){tp(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=iy({type:e}),e.\u0275inj=Sg({imports:[[$x]]}),e}(),fA=function(){var e=rp(function e(){tp(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=iy({type:e}),e.\u0275inj=Sg({imports:[hA]}),e}(),dA=function(){var e=function(){function e(){tp(this,e)}return rp(e,null,[{key:"withConfig",value:function(t){return{ngModule:e,providers:[{provide:Zx,useValue:t.warnOnNgModelWithFormControl}]}}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=iy({type:e}),e.\u0275inj=Sg({imports:[hA]}),e}(),vA=function(){var e=function(){function e(){tp(this,e)}return rp(e,[{key:"group",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=this._reduceControls(e),i=null,a=null;return null!=n&&(function(e){return void 0!==e.asyncValidators||void 0!==e.validators||void 0!==e.updateOn}(n)?(i=null!=n.validators?n.validators:null,a=null!=n.asyncValidators?n.asyncValidators:null,t=null!=n.updateOn?n.updateOn:void 0):(i=null!=n.validator?n.validator:null,a=null!=n.asyncValidator?n.asyncValidator:null)),new Lx(r,{asyncValidators:a,updateOn:t,validators:i})}},{key:"control",value:function(e,t,n){return new Dx(e,t,n)}},{key:"array",value:function(e,t,n){var r=this,i=e.map(function(e){return r._createControl(e)});return new Fx(i,t,n)}},{key:"_reduceControls",value:function(e){var t=this,n={};return Object.keys(e).forEach(function(r){n[r]=t._createControl(e[r])}),n}},{key:"_createControl",value:function(e){return e instanceof Dx||e instanceof Lx||e instanceof Fx?e:Array.isArray(e)?this.control(e[0],e.length>1?e[1]:null,e.length>2?e[2]:null):this.control(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Eg({factory:function(){return new e},token:e,providedIn:dA}),e}();function pA(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return ug(t,ig(t))}function gA(e,t){return Zv(t)?Xp(e,t,1):Xp(e,1)}function yA(e,t){return Mp(function(n,r){var i=0;n.subscribe(new Dp(r,function(n){return e.call(t,n,i++)&&r.next(n)}))})}var mA=rp(function e(){tp(this,e)}),kA=rp(function e(){tp(this,e)}),_A=function(){function e(t){var n=this;tp(this,e),this.normalizedNames=new Map,this.lazyUpdate=null,t?this.lazyInit="string"==typeof t?function(){n.headers=new Map,t.split("\n").forEach(function(e){var t=e.indexOf(":");if(t>0){var r=e.slice(0,t),i=r.toLowerCase(),a=e.slice(t+1).trim();n.maybeSetNormalizedName(r,i),n.headers.has(i)?n.headers.get(i).push(a):n.headers.set(i,[a])}})}:function(){n.headers=new Map,Object.keys(t).forEach(function(e){var r=t[e],i=e.toLowerCase();"string"==typeof r&&(r=[r]),r.length>0&&(n.headers.set(i,r),n.maybeSetNormalizedName(e,i))})}:this.headers=new Map}return rp(e,[{key:"has",value:function(e){return this.init(),this.headers.has(e.toLowerCase())}},{key:"get",value:function(e){this.init();var t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}},{key:"keys",value:function(){return this.init(),Array.from(this.normalizedNames.values())}},{key:"getAll",value:function(e){return this.init(),this.headers.get(e.toLowerCase())||null}},{key:"append",value:function(e,t){return this.clone({name:e,value:t,op:"a"})}},{key:"set",value:function(e,t){return this.clone({name:e,value:t,op:"s"})}},{key:"delete",value:function(e,t){return this.clone({name:e,value:t,op:"d"})}},{key:"maybeSetNormalizedName",value:function(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}},{key:"init",value:function(){var t=this;this.lazyInit&&(this.lazyInit instanceof e?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(function(e){return t.applyUpdate(e)}),this.lazyUpdate=null))}},{key:"copyFrom",value:function(e){var t=this;e.init(),Array.from(e.headers.keys()).forEach(function(n){t.headers.set(n,e.headers.get(n)),t.normalizedNames.set(n,e.normalizedNames.get(n))})}},{key:"clone",value:function(t){var n=new e;return n.lazyInit=this.lazyInit&&this.lazyInit instanceof e?this.lazyInit:this,n.lazyUpdate=(this.lazyUpdate||[]).concat([t]),n}},{key:"applyUpdate",value:function(e){var t=e.name.toLowerCase();switch(e.op){case"a":case"s":var n=e.value;if("string"==typeof n&&(n=[n]),0===n.length)return;this.maybeSetNormalizedName(e.name,t);var r=("a"===e.op?this.headers.get(t):void 0)||[];r.push.apply(r,Kv(n)),this.headers.set(t,r);break;case"d":var i=e.value;if(i){var a=this.headers.get(t);if(!a)return;0===(a=a.filter(function(e){return-1===i.indexOf(e)})).length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,a)}else this.headers.delete(t),this.normalizedNames.delete(t)}}},{key:"forEach",value:function(e){var t=this;this.init(),Array.from(this.normalizedNames.keys()).forEach(function(n){return e(t.normalizedNames.get(n),t.headers.get(n))})}}]),e}(),wA=function(){function e(){tp(this,e)}return rp(e,[{key:"encodeKey",value:function(e){return EA(e)}},{key:"encodeValue",value:function(e){return EA(e)}},{key:"decodeKey",value:function(e){return decodeURIComponent(e)}},{key:"decodeValue",value:function(e){return decodeURIComponent(e)}}]),e}(),CA=/%(\d[a-f0-9])/gi,bA={40:"@","3A":":",24:"$","2C":",","3B":";","2B":"+","3D":"=","3F":"?","2F":"/"};function EA(e){return encodeURIComponent(e).replace(CA,function(e,t){var n;return null!==(n=bA[t])&&void 0!==n?n:e})}function SA(e){return"".concat(e)}var PA=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(tp(this,e),this.updates=null,this.cloneFrom=null,this.encoder=n.encoder||new wA,n.fromString){if(n.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function(e,t){var n=new Map;return e.length>0&&e.replace(/^\?/,"").split("&").forEach(function(e){var r=e.indexOf("="),i=Lv(-1==r?[t.decodeKey(e),""]:[t.decodeKey(e.slice(0,r)),t.decodeValue(e.slice(r+1))],2),a=i[0],o=i[1],s=n.get(a)||[];s.push(o),n.set(a,s)}),n}(n.fromString,this.encoder)}else n.fromObject?(this.map=new Map,Object.keys(n.fromObject).forEach(function(e){var r=n.fromObject[e];t.map.set(e,Array.isArray(r)?r:[r])})):this.map=null}return rp(e,[{key:"has",value:function(e){return this.init(),this.map.has(e)}},{key:"get",value:function(e){this.init();var t=this.map.get(e);return t?t[0]:null}},{key:"getAll",value:function(e){return this.init(),this.map.get(e)||null}},{key:"keys",value:function(){return this.init(),Array.from(this.map.keys())}},{key:"append",value:function(e,t){return this.clone({param:e,value:t,op:"a"})}},{key:"appendAll",value:function(e){var t=[];return Object.keys(e).forEach(function(n){var r=e[n];Array.isArray(r)?r.forEach(function(e){t.push({param:n,value:e,op:"a"})}):t.push({param:n,value:r,op:"a"})}),this.clone(t)}},{key:"set",value:function(e,t){return this.clone({param:e,value:t,op:"s"})}},{key:"delete",value:function(e,t){return this.clone({param:e,value:t,op:"d"})}},{key:"toString",value:function(){var e=this;return this.init(),this.keys().map(function(t){var n=e.encoder.encodeKey(t);return e.map.get(t).map(function(t){return n+"="+e.encoder.encodeValue(t)}).join("&")}).filter(function(e){return""!==e}).join("&")}},{key:"clone",value:function(t){var n=new e({encoder:this.encoder});return n.cloneFrom=this.cloneFrom||this,n.updates=(this.updates||[]).concat(t),n}},{key:"init",value:function(){var e=this;null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(function(t){return e.map.set(t,e.cloneFrom.map.get(t))}),this.updates.forEach(function(t){switch(t.op){case"a":case"s":var n=("a"===t.op?e.map.get(t.param):void 0)||[];n.push(SA(t.value)),e.map.set(t.param,n);break;case"d":if(void 0===t.value){e.map.delete(t.param);break}var r=e.map.get(t.param)||[],i=r.indexOf(SA(t.value));-1!==i&&r.splice(i,1),r.length>0?e.map.set(t.param,r):e.map.delete(t.param)}}),this.cloneFrom=this.updates=null)}}]),e}(),OA=function(){function e(){tp(this,e),this.map=new Map}return rp(e,[{key:"set",value:function(e,t){return this.map.set(e,t),this}},{key:"get",value:function(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}},{key:"delete",value:function(e){return this.map.delete(e),this}},{key:"keys",value:function(){return this.map.keys()}}]),e}();function TA(e){return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer}function IA(e){return"undefined"!=typeof Blob&&e instanceof Blob}function xA(e){return"undefined"!=typeof FormData&&e instanceof FormData}var AA=function(){function e(t,n,r,i){var a;if(tp(this,e),this.url=n,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=t.toUpperCase(),function(e){switch(e){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||i?(this.body=void 0!==r?r:null,a=i):a=r,a&&(this.reportProgress=!!a.reportProgress,this.withCredentials=!!a.withCredentials,a.responseType&&(this.responseType=a.responseType),a.headers&&(this.headers=a.headers),a.context&&(this.context=a.context),a.params&&(this.params=a.params)),this.headers||(this.headers=new _A),this.context||(this.context=new OA),this.params){var o=this.params.toString();if(0===o.length)this.urlWithParams=n;else{var s=n.indexOf("?");this.urlWithParams=n+(-1===s?"?":s<n.length-1?"&":"")+o}}else this.params=new PA,this.urlWithParams=n}return rp(e,[{key:"serializeBody",value:function(){return null===this.body?null:TA(this.body)||IA(this.body)||xA(this.body)||"undefined"!=typeof URLSearchParams&&this.body instanceof URLSearchParams||"string"==typeof this.body?this.body:this.body instanceof PA?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}},{key:"detectContentTypeHeader",value:function(){return null===this.body||xA(this.body)?null:IA(this.body)?this.body.type||null:TA(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof PA?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}},{key:"clone",value:function(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.method||this.method,i=n.url||this.url,a=n.responseType||this.responseType,o=void 0!==n.body?n.body:this.body,s=void 0!==n.withCredentials?n.withCredentials:this.withCredentials,u=void 0!==n.reportProgress?n.reportProgress:this.reportProgress,c=n.headers||this.headers,l=n.params||this.params,h=null!==(t=n.context)&&void 0!==t?t:this.context;return void 0!==n.setHeaders&&(c=Object.keys(n.setHeaders).reduce(function(e,t){return e.set(t,n.setHeaders[t])},c)),n.setParams&&(l=Object.keys(n.setParams).reduce(function(e,t){return e.set(t,n.setParams[t])},l)),new e(r,i,o,{params:l,headers:c,context:h,reportProgress:u,responseType:a,withCredentials:s})}}]),e}(),RA=((RA=RA||{})[RA.Sent=0]="Sent",RA[RA.UploadProgress=1]="UploadProgress",RA[RA.ResponseHeader=2]="ResponseHeader",RA[RA.DownloadProgress=3]="DownloadProgress",RA[RA.Response=4]="Response",RA[RA.User=5]="User",RA),NA=rp(function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"OK";tp(this,e),this.headers=t.headers||new _A,this.status=void 0!==t.status?t.status:n,this.statusText=t.statusText||r,this.url=t.url||null,this.ok=this.status>=200&&this.status<300}),MA=function(e){Gv(n,e);var t=$v(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return tp(this,n),(e=t.call(this,r)).type=RA.ResponseHeader,e}return rp(n,[{key:"clone",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new n({headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}]),n}(NA),DA=function(e){Gv(n,e);var t=$v(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return tp(this,n),(e=t.call(this,r)).type=RA.Response,e.body=void 0!==r.body?r.body:null,e}return rp(n,[{key:"clone",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new n({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}]),n}(NA),LA=function(e){Gv(n,e);var t=$v(n);function n(e){var r;return tp(this,n),(r=t.call(this,e,0,"Unknown Error")).name="HttpErrorResponse",r.ok=!1,r.message=r.status>=200&&r.status<300?"Http failure during parsing for ".concat(e.url||"(unknown url)"):"Http failure response for ".concat(e.url||"(unknown url)",": ").concat(e.status," ").concat(e.statusText),r.error=e.error||null,r}return rp(n)}(NA);function FA(e,t){return{body:t,headers:e.headers,context:e.context,observe:e.observe,params:e.params,reportProgress:e.reportProgress,responseType:e.responseType,withCredentials:e.withCredentials}}var BA=function(){var e=function(){function e(t){tp(this,e),this.handler=t}return rp(e,[{key:"request",value:function(e,t){var n,r,i,a=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};e instanceof AA?n=e:(r=o.headers instanceof _A?o.headers:new _A(o.headers),o.params&&(i=o.params instanceof PA?o.params:new PA({fromObject:o.params})),n=new AA(e,t,void 0!==o.body?o.body:null,{headers:r,context:o.context,params:i,reportProgress:o.reportProgress,responseType:o.responseType||"json",withCredentials:o.withCredentials}));var s=pA(n).pipe(gA(function(e){return a.handler.handle(e)}));if(e instanceof AA||"events"===o.observe)return s;var u=s.pipe(yA(function(e){return e instanceof DA}));switch(o.observe||"body"){case"body":switch(n.responseType){case"arraybuffer":return u.pipe(Lp(function(e){if(null!==e.body&&!(e.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return e.body}));case"blob":return u.pipe(Lp(function(e){if(null!==e.body&&!(e.body instanceof Blob))throw new Error("Response is not a Blob.");return e.body}));case"text":return u.pipe(Lp(function(e){if(null!==e.body&&"string"!=typeof e.body)throw new Error("Response is not a string.");return e.body}));case"json":default:return u.pipe(Lp(function(e){return e.body}))}case"response":return u;default:throw new Error("Unreachable: unhandled observe type ".concat(o.observe,"}"))}}},{key:"delete",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("DELETE",e,t)}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("GET",e,t)}},{key:"head",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("HEAD",e,t)}},{key:"jsonp",value:function(e,t){return this.request("JSONP",e,{params:(new PA).append(t,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}},{key:"options",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("OPTIONS",e,t)}},{key:"patch",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request("PATCH",e,FA(n,t))}},{key:"post",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request("POST",e,FA(n,t))}},{key:"put",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request("PUT",e,FA(n,t))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Pk(mA))},e.\u0275prov=Eg({token:e,factory:e.\u0275fac}),e}(),VA=function(){function e(t,n){tp(this,e),this.next=t,this.interceptor=n}return rp(e,[{key:"handle",value:function(e){return this.interceptor.intercept(e,this.next)}}]),e}(),UA=new ok("HTTP_INTERCEPTORS"),zA=function(){var e=function(){function e(){tp(this,e)}return rp(e,[{key:"intercept",value:function(e,t){return t.handle(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Eg({token:e,factory:e.\u0275fac}),e}(),HA=/^\)\]\}',?\n/,GA=function(){var e=function(){function e(t){tp(this,e),this.xhrFactory=t}return rp(e,[{key:"handle",value:function(e){var t=this;if("JSONP"===e.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new Tp(function(n){var r=t.xhrFactory.build();if(r.open(e.method,e.urlWithParams),e.withCredentials&&(r.withCredentials=!0),e.headers.forEach(function(e,t){return r.setRequestHeader(e,t.join(","))}),e.headers.has("Accept")||r.setRequestHeader("Accept","application/json, text/plain, */*"),!e.headers.has("Content-Type")){var i=e.detectContentTypeHeader();null!==i&&r.setRequestHeader("Content-Type",i)}if(e.responseType){var a=e.responseType.toLowerCase();r.responseType="json"!==a?a:"text"}var o=e.serializeBody(),s=null,u=function(){if(null!==s)return s;var t=1223===r.status?204:r.status,n=r.statusText||"OK",i=new _A(r.getAllResponseHeaders()),a=function(e){return"responseURL"in e&&e.responseURL?e.responseURL:/^X-Request-URL:/m.test(e.getAllResponseHeaders())?e.getResponseHeader("X-Request-URL"):null}(r)||e.url;return s=new MA({headers:i,status:t,statusText:n,url:a})},c=function(){var t=u(),i=t.headers,a=t.status,o=t.statusText,s=t.url,c=null;204!==a&&(c=void 0===r.response?r.responseText:r.response),0===a&&(a=c?200:0);var l=a>=200&&a<300;if("json"===e.responseType&&"string"==typeof c){var h=c;c=c.replace(HA,"");try{c=""!==c?JSON.parse(c):null}catch(f){c=h,l&&(l=!1,c={error:f,text:c})}}l?(n.next(new DA({body:c,headers:i,status:a,statusText:o,url:s||void 0})),n.complete()):n.error(new LA({error:c,headers:i,status:a,statusText:o,url:s||void 0}))},l=function(e){var t=u().url,i=new LA({error:e,status:r.status||0,statusText:r.statusText||"Unknown Error",url:t||void 0});n.error(i)},h=!1,f=function(t){h||(n.next(u()),h=!0);var i={type:RA.DownloadProgress,loaded:t.loaded};t.lengthComputable&&(i.total=t.total),"text"===e.responseType&&!!r.responseText&&(i.partialText=r.responseText),n.next(i)},d=function(e){var t={type:RA.UploadProgress,loaded:e.loaded};e.lengthComputable&&(t.total=e.total),n.next(t)};return r.addEventListener("load",c),r.addEventListener("error",l),r.addEventListener("timeout",l),r.addEventListener("abort",l),e.reportProgress&&(r.addEventListener("progress",f),null!==o&&r.upload&&r.upload.addEventListener("progress",d)),r.send(o),n.next({type:RA.Sent}),function(){r.removeEventListener("error",l),r.removeEventListener("abort",l),r.removeEventListener("load",c),r.removeEventListener("timeout",l),e.reportProgress&&(r.removeEventListener("progress",f),null!==o&&r.upload&&r.upload.removeEventListener("progress",d)),r.readyState!==r.DONE&&r.abort()}})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Pk(qT))},e.\u0275prov=Eg({token:e,factory:e.\u0275fac}),e}(),qA=new ok("XSRF_COOKIE_NAME"),$A=new ok("XSRF_HEADER_NAME"),WA=rp(function e(){tp(this,e)}),jA=function(){var e=function(){function e(t,n,r){tp(this,e),this.doc=t,this.platform=n,this.cookieName=r,this.lastCookieString="",this.lastToken=null,this.parseCount=0}return rp(e,[{key:"getToken",value:function(){if("server"===this.platform)return null;var e=this.doc.cookie||"";return e!==this.lastCookieString&&(this.parseCount++,this.lastToken=TT(e,this.cookieName),this.lastCookieString=e),this.lastToken}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Pk(PO),Pk(MP),Pk(qA))},e.\u0275prov=Eg({token:e,factory:e.\u0275fac}),e}(),ZA=function(){var e=function(){function e(t,n){tp(this,e),this.tokenService=t,this.headerName=n}return rp(e,[{key:"intercept",value:function(e,t){var n=e.url.toLowerCase();if("GET"===e.method||"HEAD"===e.method||n.startsWith("http://")||n.startsWith("https://"))return t.handle(e);var r=this.tokenService.getToken();return null!==r&&!e.headers.has(this.headerName)&&(e=e.clone({headers:e.headers.set(this.headerName,r)})),t.handle(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Pk(WA),Pk($A))},e.\u0275prov=Eg({token:e,factory:e.\u0275fac}),e}(),YA=function(){var e=function(){function e(t,n){tp(this,e),this.backend=t,this.injector=n,this.chain=null}return rp(e,[{key:"handle",value:function(e){if(null===this.chain){var t=this.injector.get(UA,[]);this.chain=t.reduceRight(function(e,t){return new VA(e,t)},this.backend)}return this.chain.handle(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Pk(kA),Pk(VC))},e.\u0275prov=Eg({token:e,factory:e.\u0275fac}),e}(),KA=function(){var e=function(){function e(){tp(this,e)}return rp(e,null,[{key:"disable",value:function(){return{ngModule:e,providers:[{provide:ZA,useClass:zA}]}}},{key:"withOptions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{ngModule:e,providers:[t.cookieName?{provide:qA,useValue:t.cookieName}:[],t.headerName?{provide:$A,useValue:t.headerName}:[]]}}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=iy({type:e}),e.\u0275inj=Sg({providers:[ZA,{provide:UA,useExisting:ZA,multi:!0},{provide:WA,useClass:jA},{provide:qA,useValue:"XSRF-TOKEN"},{provide:$A,useValue:"X-XSRF-TOKEN"}]}),e}(),JA=function(){var e=rp(function e(){tp(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=iy({type:e}),e.\u0275inj=Sg({providers:[BA,{provide:mA,useClass:YA},GA,{provide:kA,useExisting:GA}],imports:[[KA.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]]}),e}(),QA=function(e){Gv(n,e);var t=$v(n);function n(e){var r;return tp(this,n),(r=t.call(this))._value=e,r}return rp(n,[{key:"value",get:function(){return this.getValue()}},{key:"_subscribe",value:function(e){var t=zv(Yv(n.prototype),"_subscribe",this).call(this,e);return!t.closed&&e.next(this._value),t}},{key:"getValue",value:function(){var e=this.hasError,t=this.thrownError,n=this._value;if(e)throw t;return this._throwIfClosed(),n}},{key:"next",value:function(e){zv(Yv(n.prototype),"next",this).call(this,this._value=e)}}]),n}(Ap);function XA(e,t,n){e?Qp(n,e,t):t()}var eR=Jv(function(e){return function(){e(this),this.name="EmptyError",this.message="no elements in sequence"}});function tR(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return eg(1)(ug(t,ig(t)))}function nR(e){return new Tp(function(t){Kp(e()).subscribe(t)})}function rR(){return Mp(function(e,t){var n=null;e._refCount++;var r=new Dp(t,void 0,void 0,void 0,function(){if(!e||e._refCount<=0||0<--e._refCount)n=null;else{var r=e._connection,i=n;n=null,r&&(!i||r===i)&&r.unsubscribe(),t.unsubscribe()}});e.subscribe(r),r.closed||(n=e.connect())})}var iR=function(e){Gv(n,e);var t=$v(n);function n(e,r){var i;return tp(this,n),(i=t.call(this)).source=e,i.subjectFactory=r,i._subject=null,i._refCount=0,i._connection=null,Np(e)&&(i.lift=e.lift),i}return rp(n,[{key:"_subscribe",value:function(e){return this.getSubject().subscribe(e)}},{key:"getSubject",value:function(){var e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}},{key:"_teardown",value:function(){this._refCount=0;var e=this._connection;this._subject=this._connection=null,null==e||e.unsubscribe()}},{key:"connect",value:function(){var e=this,t=this._connection;if(!t){t=this._connection=new ip;var n=this.getSubject();t.add(this.source.subscribe(new Dp(n,void 0,function(){e._teardown(),n.complete()},function(t){e._teardown(),n.error(t)},function(){return e._teardown()}))),t.closed&&(this._connection=null,t=ip.EMPTY)}return t}},{key:"refCount",value:function(){return rR()(this)}}]),n}(Tp);function aR(e,t){return Mp(function(n,r){var i=null,a=0,o=!1,s=function(){return o&&!i&&r.complete()};n.subscribe(new Dp(r,function(n){null==i||i.unsubscribe();var o=0,u=a++;Kp(e(n,u)).subscribe(i=new Dp(r,function(e){return r.next(t?t(n,e,u,o++):e)},function(){i=null,s()}))},function(){o=!0,s()}))})}function oR(e,t,n,r,i){return function(a,o){var s=n,u=t,c=0;a.subscribe(new Dp(o,function(t){var n=c++;u=s?e(u,t,n):(s=!0,t),r&&o.next(u)},i&&function(){s&&o.next(u),o.complete()}))}}function sR(e,t){return Mp(oR(e,t,arguments.length>=2,!0))}function uR(e){return Mp(function(t,n){var r,i=null,a=!1;i=t.subscribe(new Dp(n,void 0,void 0,function(o){r=Kp(e(o,uR(e)(t))),i?(i.unsubscribe(),i=null,r.subscribe(n)):a=!0})),a&&(i.unsubscribe(),i=null,r.subscribe(n))})}function cR(e){return e<=0?function(){return tg}:Mp(function(t,n){var r=[];t.subscribe(new Dp(n,function(t){r.push(t),e<r.length&&r.shift()},function(){var e,t=Qv(r);try{for(t.s();!(e=t.n()).done;){var i=e.value;n.next(i)}}catch(a){t.e(a)}finally{t.f()}n.complete()},void 0,function(){r=null}))})}function lR(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:hR;return Mp(function(t,n){var r=!1;t.subscribe(new Dp(n,function(e){r=!0,n.next(e)},function(){return r?n.complete():n.error(e())}))})}function hR(){return new eR}function fR(e){return Mp(function(t,n){var r=!1;t.subscribe(new Dp(n,function(e){r=!0,n.next(e)},function(){r||n.next(e),n.complete()}))})}function dR(e,t){var n=arguments.length>=2;return function(r){return r.pipe(e?yA(function(t,n){return e(t,n,r)}):Op,cg(1),n?fR(t):lR(function(){return new eR}))}}function vR(e,t,n){var r=Zv(e)||t||n?{next:e,error:t,complete:n}:e;return r?Mp(function(e,t){var n;null===(n=r.subscribe)||void 0===n||n.call(r);var i=!0;e.subscribe(new Dp(t,function(e){var n;null===(n=r.next)||void 0===n||n.call(r,e),t.next(e)},function(){var e;i=!1,null===(e=r.complete)||void 0===e||e.call(r),t.complete()},function(e){var n;i=!1,null===(n=r.error)||void 0===n||n.call(r,e),t.error(e)},function(){var e,t;i&&(null===(e=r.unsubscribe)||void 0===e||e.call(r)),null===(t=r.finalize)||void 0===t||t.call(r)}))}):Op}var pR=rp(function e(t,n){tp(this,e),this.id=t,this.url=n}),gR=function(e){Gv(n,e);var t=$v(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"imperative",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return tp(this,n),(i=t.call(this,e,r)).navigationTrigger=a,i.restoredState=o,i}return rp(n,[{key:"toString",value:function(){return"NavigationStart(id: ".concat(this.id,", url: '").concat(this.url,"')")}}]),n}(pR),yR=function(e){Gv(n,e);var t=$v(n);function n(e,r,i){var a;return tp(this,n),(a=t.call(this,e,r)).urlAfterRedirects=i,a}return rp(n,[{key:"toString",value:function(){return"NavigationEnd(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"')")}}]),n}(pR),mR=function(e){Gv(n,e);var t=$v(n);function n(e,r,i){var a;return tp(this,n),(a=t.call(this,e,r)).reason=i,a}return rp(n,[{key:"toString",value:function(){return"NavigationCancel(id: ".concat(this.id,", url: '").concat(this.url,"')")}}]),n}(pR),kR=function(e){Gv(n,e);var t=$v(n);function n(e,r,i){var a;return tp(this,n),(a=t.call(this,e,r)).error=i,a}return rp(n,[{key:"toString",value:function(){return"NavigationError(id: ".concat(this.id,", url: '").concat(this.url,"', error: ").concat(this.error,")")}}]),n}(pR),_R=function(e){Gv(n,e);var t=$v(n);function n(e,r,i,a){var o;return tp(this,n),(o=t.call(this,e,r)).urlAfterRedirects=i,o.state=a,o}return rp(n,[{key:"toString",value:function(){return"RoutesRecognized(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),n}(pR),wR=function(e){Gv(n,e);var t=$v(n);function n(e,r,i,a){var o;return tp(this,n),(o=t.call(this,e,r)).urlAfterRedirects=i,o.state=a,o}return rp(n,[{key:"toString",value:function(){return"GuardsCheckStart(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),n}(pR),CR=function(e){Gv(n,e);var t=$v(n);function n(e,r,i,a,o){var s;return tp(this,n),(s=t.call(this,e,r)).urlAfterRedirects=i,s.state=a,s.shouldActivate=o,s}return rp(n,[{key:"toString",value:function(){return"GuardsCheckEnd(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,", shouldActivate: ").concat(this.shouldActivate,")")}}]),n}(pR),bR=function(e){Gv(n,e);var t=$v(n);function n(e,r,i,a){var o;return tp(this,n),(o=t.call(this,e,r)).urlAfterRedirects=i,o.state=a,o}return rp(n,[{key:"toString",value:function(){return"ResolveStart(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),n}(pR),ER=function(e){Gv(n,e);var t=$v(n);function n(e,r,i,a){var o;return tp(this,n),(o=t.call(this,e,r)).urlAfterRedirects=i,o.state=a,o}return rp(n,[{key:"toString",value:function(){return"ResolveEnd(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),n}(pR),SR=function(){function e(t){tp(this,e),this.route=t}return rp(e,[{key:"toString",value:function(){return"RouteConfigLoadStart(path: ".concat(this.route.path,")")}}]),e}(),PR=function(){function e(t){tp(this,e),this.route=t}return rp(e,[{key:"toString",value:function(){return"RouteConfigLoadEnd(path: ".concat(this.route.path,")")}}]),e}(),OR=function(){function e(t){tp(this,e),this.snapshot=t}return rp(e,[{key:"toString",value:function(){return"ChildActivationStart(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),e}(),TR=function(){function e(t){tp(this,e),this.snapshot=t}return rp(e,[{key:"toString",value:function(){return"ChildActivationEnd(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),e}(),IR=function(){function e(t){tp(this,e),this.snapshot=t}return rp(e,[{key:"toString",value:function(){return"ActivationStart(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),e}(),xR=function(){function e(t){tp(this,e),this.snapshot=t}return rp(e,[{key:"toString",value:function(){return"ActivationEnd(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),e}(),AR=function(){function e(t,n,r){tp(this,e),this.routerEvent=t,this.position=n,this.anchor=r}return rp(e,[{key:"toString",value:function(){return"Scroll(anchor: '".concat(this.anchor,"', position: '").concat(this.position?"".concat(this.position[0],", ").concat(this.position[1]):null,"')")}}]),e}(),RR="primary",NR=function(){function e(t){tp(this,e),this.params=t||{}}return rp(e,[{key:"has",value:function(e){return Object.prototype.hasOwnProperty.call(this.params,e)}},{key:"get",value:function(e){if(this.has(e)){var t=this.params[e];return Array.isArray(t)?t[0]:t}return null}},{key:"getAll",value:function(e){if(this.has(e)){var t=this.params[e];return Array.isArray(t)?t:[t]}return[]}},{key:"keys",get:function(){return Object.keys(this.params)}}]),e}();function MR(e){return new NR(e)}var DR="ngNavigationCancelingError";function LR(e){var t=Error("NavigationCancelingError: "+e);return t[DR]=!0,t}function FR(e,t,n){var r=n.path.split("/");if(r.length>e.length||"full"===n.pathMatch&&(t.hasChildren()||r.length<e.length))return null;for(var i={},a=0;a<r.length;a++){var o=r[a],s=e[a];if(o.startsWith(":"))i[o.substring(1)]=s;else if(o!==s.path)return null}return{consumed:e.slice(0,r.length),posParams:i}}function BR(e,t){var n,r=e?Object.keys(e):void 0,i=t?Object.keys(t):void 0;if(!r||!i||r.length!=i.length)return!1;for(var a=0;a<r.length;a++)if(!VR(e[n=r[a]],t[n]))return!1;return!0}function VR(e,t){if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;var n=Kv(e).sort(),r=Kv(t).sort();return n.every(function(e,t){return r[t]===e})}return e===t}function UR(e){return Array.prototype.concat.apply([],e)}function zR(e){return e.length>0?e[e.length-1]:null}function HR(e,t){for(var n in e)e.hasOwnProperty(n)&&t(e[n],n)}function GR(e){return yb(e)?e:gb(e)?ug(Promise.resolve(e)):pA(e)}var qR={exact:function e(t,n,r){if(!XR(t.segments,n.segments)||!YR(t.segments,n.segments,r)||t.numberOfChildren!==n.numberOfChildren)return!1;for(var i in n.children)if(!t.children[i]||!e(t.children[i],n.children[i],r))return!1;return!0},subset:jR},$R={exact:function(e,t){return BR(e,t)},subset:function(e,t){return Object.keys(t).length<=Object.keys(e).length&&Object.keys(t).every(function(n){return VR(e[n],t[n])})},ignored:function(){return!0}};function WR(e,t,n){return qR[n.paths](e.root,t.root,n.matrixParams)&&$R[n.queryParams](e.queryParams,t.queryParams)&&!("exact"===n.fragment&&e.fragment!==t.fragment)}function jR(e,t,n){return ZR(e,t,t.segments,n)}function ZR(e,t,n,r){if(e.segments.length>n.length){var i=e.segments.slice(0,n.length);return!(!XR(i,n)||t.hasChildren()||!YR(i,n,r))}if(e.segments.length===n.length){if(!XR(e.segments,n)||!YR(e.segments,n,r))return!1;for(var a in t.children)if(!e.children[a]||!jR(e.children[a],t.children[a],r))return!1;return!0}var o=n.slice(0,e.segments.length),s=n.slice(e.segments.length);return!!(XR(e.segments,o)&&YR(e.segments,o,r)&&e.children[RR])&&ZR(e.children[RR],t,s,r)}function YR(e,t,n){return t.every(function(t,r){return $R[n](e[r].parameters,t.parameters)})}var KR=function(){function e(t,n,r){tp(this,e),this.root=t,this.queryParams=n,this.fragment=r}return rp(e,[{key:"queryParamMap",get:function(){return this._queryParamMap||(this._queryParamMap=MR(this.queryParams)),this._queryParamMap}},{key:"toString",value:function(){return nN.serialize(this)}}]),e}(),JR=function(){function e(t,n){var r=this;tp(this,e),this.segments=t,this.children=n,this.parent=null,HR(n,function(e,t){return e.parent=r})}return rp(e,[{key:"hasChildren",value:function(){return this.numberOfChildren>0}},{key:"numberOfChildren",get:function(){return Object.keys(this.children).length}},{key:"toString",value:function(){return rN(this)}}]),e}(),QR=function(){function e(t,n){tp(this,e),this.path=t,this.parameters=n}return rp(e,[{key:"parameterMap",get:function(){return this._parameterMap||(this._parameterMap=MR(this.parameters)),this._parameterMap}},{key:"toString",value:function(){return lN(this)}}]),e}();function XR(e,t){return e.length===t.length&&e.every(function(e,n){return e.path===t[n].path})}var eN=rp(function e(){tp(this,e)}),tN=function(){function e(){tp(this,e)}return rp(e,[{key:"parse",value:function(e){var t=new pN(e);return new KR(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}},{key:"serialize",value:function(e){var t;return"".concat("/".concat(iN(e.root,!0)),function(e){var t=Object.keys(e).map(function(t){var n=e[t];return Array.isArray(n)?n.map(function(e){return"".concat(oN(t),"=").concat(oN(e))}).join("&"):"".concat(oN(t),"=").concat(oN(n))}).filter(function(e){return!!e});return t.length?"?".concat(t.join("&")):""}(e.queryParams)).concat("string"==typeof e.fragment?"#".concat((t=e.fragment,encodeURI(t))):"")}}]),e}(),nN=new tN;function rN(e){return e.segments.map(function(e){return lN(e)}).join("/")}function iN(e,t){if(!e.hasChildren())return rN(e);if(t){var n=e.children[RR]?iN(e.children[RR],!1):"",r=[];return HR(e.children,function(e,t){t!==RR&&r.push("".concat(t,":").concat(iN(e,!1)))}),r.length>0?"".concat(n,"(").concat(r.join("//"),")"):n}var i=function(e,t){var n=[];return HR(e.children,function(e,r){r===RR&&(n=n.concat(t(e,r)))}),HR(e.children,function(e,r){r!==RR&&(n=n.concat(t(e,r)))}),n}(e,function(t,n){return n===RR?[iN(e.children[RR],!1)]:["".concat(n,":").concat(iN(t,!1))]});return 1===Object.keys(e.children).length&&null!=e.children[RR]?"".concat(rN(e),"/").concat(i[0]):"".concat(rN(e),"/(").concat(i.join("//"),")")}function aN(e){return encodeURIComponent(e).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function oN(e){return aN(e).replace(/%3B/gi,";")}function sN(e){return aN(e).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function uN(e){return decodeURIComponent(e)}function cN(e){return uN(e.replace(/\+/g,"%20"))}function lN(e){return"".concat(sN(e.path)).concat(function(e){return Object.keys(e).map(function(t){return";".concat(sN(t),"=").concat(sN(e[t]))}).join("")}(e.parameters))}var hN=/^[^\/()?;=#]+/;function fN(e){var t=e.match(hN);return t?t[0]:""}var dN=/^[^=?&#]+/,vN=/^[^?&#]+/,pN=function(){function e(t){tp(this,e),this.url=t,this.remaining=t}return rp(e,[{key:"parseRootSegment",value:function(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new JR([],{}):new JR([],this.parseChildren())}},{key:"parseQueryParams",value:function(){var e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}},{key:"parseFragment",value:function(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}},{key:"parseChildren",value:function(){if(""===this.remaining)return{};this.consumeOptional("/");var e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());var t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));var n={};return this.peekStartsWith("(")&&(n=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(n[RR]=new JR(e,t)),n}},{key:"parseSegment",value:function(){var e=fN(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new Error("Empty path url segment cannot have parameters: '".concat(this.remaining,"'."));return this.capture(e),new QR(uN(e),this.parseMatrixParams())}},{key:"parseMatrixParams",value:function(){for(var e={};this.consumeOptional(";");)this.parseParam(e);return e}},{key:"parseParam",value:function(e){var t=fN(this.remaining);if(t){this.capture(t);var n="";if(this.consumeOptional("=")){var r=fN(this.remaining);r&&(n=r,this.capture(n))}e[uN(t)]=uN(n)}}},{key:"parseQueryParam",value:function(e){var t=function(e){var t=e.match(dN);return t?t[0]:""}(this.remaining);if(t){this.capture(t);var n="";if(this.consumeOptional("=")){var r=function(e){var t=e.match(vN);return t?t[0]:""}(this.remaining);r&&(n=r,this.capture(n))}var i=cN(t),a=cN(n);if(e.hasOwnProperty(i)){var o=e[i];Array.isArray(o)||(o=[o],e[i]=o),o.push(a)}else e[i]=a}}},{key:"parseParens",value:function(e){var t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){var n=fN(this.remaining),r=this.remaining[n.length];if("/"!==r&&")"!==r&&";"!==r)throw new Error("Cannot parse url '".concat(this.url,"'"));var i=void 0;n.indexOf(":")>-1?(i=n.substr(0,n.indexOf(":")),this.capture(i),this.capture(":")):e&&(i=RR);var a=this.parseChildren();t[i]=1===Object.keys(a).length?a[RR]:new JR([],a),this.consumeOptional("//")}return t}},{key:"peekStartsWith",value:function(e){return this.remaining.startsWith(e)}},{key:"consumeOptional",value:function(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}},{key:"capture",value:function(e){if(!this.consumeOptional(e))throw new Error('Expected "'.concat(e,'".'))}}]),e}(),gN=function(){function e(t){tp(this,e),this._root=t}return rp(e,[{key:"root",get:function(){return this._root.value}},{key:"parent",value:function(e){var t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}},{key:"children",value:function(e){var t=yN(e,this._root);return t?t.children.map(function(e){return e.value}):[]}},{key:"firstChild",value:function(e){var t=yN(e,this._root);return t&&t.children.length>0?t.children[0].value:null}},{key:"siblings",value:function(e){var t=mN(e,this._root);return t.length<2?[]:t[t.length-2].children.map(function(e){return e.value}).filter(function(t){return t!==e})}},{key:"pathFromRoot",value:function(e){return mN(e,this._root).map(function(e){return e.value})}}]),e}();function yN(e,t){if(e===t.value)return t;var n,r=Qv(t.children);try{for(r.s();!(n=r.n()).done;){var i=yN(e,n.value);if(i)return i}}catch(a){r.e(a)}finally{r.f()}return null}function mN(e,t){if(e===t.value)return[t];var n,r=Qv(t.children);try{for(r.s();!(n=r.n()).done;){var i=mN(e,n.value);if(i.length)return i.unshift(t),i}}catch(a){r.e(a)}finally{r.f()}return[]}var kN=function(){function e(t,n){tp(this,e),this.value=t,this.children=n}return rp(e,[{key:"toString",value:function(){return"TreeNode(".concat(this.value,")")}}]),e}();function _N(e){var t={};return e&&e.children.forEach(function(e){return t[e.value.outlet]=e}),t}var wN=function(e){Gv(n,e);var t=$v(n);function n(e,r){var i;return tp(this,n),(i=t.call(this,e)).snapshot=r,ON(jv(i),e),i}return rp(n,[{key:"toString",value:function(){return this.snapshot.toString()}}]),n}(gN);function CN(e,t){var n=function(e,t){var n=new SN([],{},{},"",{},RR,t,null,e.root,-1,{});return new PN("",new kN(n,[]))}(e,t),r=new QA([new QR("",{})]),i=new QA({}),a=new QA({}),o=new QA({}),s=new QA(""),u=new bN(r,i,o,s,a,RR,t,n.root);return u.snapshot=n.root,new wN(new kN(u,[]),n)}var bN=function(){function e(t,n,r,i,a,o,s,u){tp(this,e),this.url=t,this.params=n,this.queryParams=r,this.fragment=i,this.data=a,this.outlet=o,this.component=s,this._futureSnapshot=u}return rp(e,[{key:"routeConfig",get:function(){return this._futureSnapshot.routeConfig}},{key:"root",get:function(){return this._routerState.root}},{key:"parent",get:function(){return this._routerState.parent(this)}},{key:"firstChild",get:function(){return this._routerState.firstChild(this)}},{key:"children",get:function(){return this._routerState.children(this)}},{key:"pathFromRoot",get:function(){return this._routerState.pathFromRoot(this)}},{key:"paramMap",get:function(){return this._paramMap||(this._paramMap=this.params.pipe(Lp(function(e){return MR(e)}))),this._paramMap}},{key:"queryParamMap",get:function(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(Lp(function(e){return MR(e)}))),this._queryParamMap}},{key:"toString",value:function(){return this.snapshot?this.snapshot.toString():"Future(".concat(this._futureSnapshot,")")}}]),e}();function EN(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"emptyOnly",n=e.pathFromRoot,r=0;if("always"!==t)for(r=n.length-1;r>=1;){var i=n[r],a=n[r-1];if(i.routeConfig&&""===i.routeConfig.path)r--;else{if(a.component)break;r--}}return function(e){return e.reduce(function(e,t){return{params:Object.assign(Object.assign({},e.params),t.params),data:Object.assign(Object.assign({},e.data),t.data),resolve:Object.assign(Object.assign({},e.resolve),t._resolvedData)}},{params:{},data:{},resolve:{}})}(n.slice(r))}var SN=function(){function e(t,n,r,i,a,o,s,u,c,l,h){tp(this,e),this.url=t,this.params=n,this.queryParams=r,this.fragment=i,this.data=a,this.outlet=o,this.component=s,this.routeConfig=u,this._urlSegment=c,this._lastPathIndex=l,this._resolve=h}return rp(e,[{key:"root",get:function(){return this._routerState.root}},{key:"parent",get:function(){return this._routerState.parent(this)}},{key:"firstChild",get:function(){return this._routerState.firstChild(this)}},{key:"children",get:function(){return this._routerState.children(this)}},{key:"pathFromRoot",get:function(){return this._routerState.pathFromRoot(this)}},{key:"paramMap",get:function(){return this._paramMap||(this._paramMap=MR(this.params)),this._paramMap}},{key:"queryParamMap",get:function(){return this._queryParamMap||(this._queryParamMap=MR(this.queryParams)),this._queryParamMap}},{key:"toString",value:function(){return"Route(url:'".concat(this.url.map(function(e){return e.toString()}).join("/"),"', path:'").concat(this.routeConfig?this.routeConfig.path:"","')")}}]),e}(),PN=function(e){Gv(n,e);var t=$v(n);function n(e,r){var i;return tp(this,n),(i=t.call(this,r)).url=e,ON(jv(i),r),i}return rp(n,[{key:"toString",value:function(){return TN(this._root)}}]),n}(gN);function ON(e,t){t.value._routerState=e,t.children.forEach(function(t){return ON(e,t)})}function TN(e){var t=e.children.length>0?" { ".concat(e.children.map(TN).join(", ")," } "):"";return"".concat(e.value).concat(t)}function IN(e){if(e.snapshot){var t=e.snapshot,n=e._futureSnapshot;e.snapshot=n,BR(t.queryParams,n.queryParams)||e.queryParams.next(n.queryParams),t.fragment!==n.fragment&&e.fragment.next(n.fragment),BR(t.params,n.params)||e.params.next(n.params),function(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;++n)if(!BR(e[n],t[n]))return!1;return!0}(t.url,n.url)||e.url.next(n.url),BR(t.data,n.data)||e.data.next(n.data)}else e.snapshot=e._futureSnapshot,e.data.next(e._futureSnapshot.data)}function xN(e,t){return BR(e.params,t.params)&&function(e,t){return XR(e,t)&&e.every(function(e,n){return BR(e.parameters,t[n].parameters)})}(e.url,t.url)&&!(!e.parent!=!t.parent)&&(!e.parent||xN(e.parent,t.parent))}function AN(e,t,n){if(n&&e.shouldReuseRoute(t.value,n.value.snapshot)){var r=n.value;r._futureSnapshot=t.value;var i=function(e,t,n){return t.children.map(function(t){var r,i=Qv(n.children);try{for(i.s();!(r=i.n()).done;){var a=r.value;if(e.shouldReuseRoute(t.value,a.value.snapshot))return AN(e,t,a)}}catch(o){i.e(o)}finally{i.f()}return AN(e,t)})}(e,t,n);return new kN(r,i)}if(e.shouldAttach(t.value)){var a=e.retrieve(t.value);if(null!==a){var o=a.route;return RN(t,o),o}}var s=function(e){return new bN(new QA(e.url),new QA(e.params),new QA(e.queryParams),new QA(e.fragment),new QA(e.data),e.outlet,e.component,e)}(t.value),u=t.children.map(function(t){return AN(e,t)});return new kN(s,u)}function RN(e,t){if(e.value.routeConfig!==t.value.routeConfig)throw new Error("Cannot reattach ActivatedRouteSnapshot created from a different route");if(e.children.length!==t.children.length)throw new Error("Cannot reattach ActivatedRouteSnapshot with a different number of children");t.value._futureSnapshot=e.value;for(var n=0;n<e.children.length;++n)RN(e.children[n],t.children[n])}function NN(e){return"object"==typeof e&&null!=e&&!e.outlets&&!e.segmentPath}function MN(e){return"object"==typeof e&&null!=e&&e.outlets}function DN(e,t,n,r,i){var a={};return r&&HR(r,function(e,t){a[t]=Array.isArray(e)?e.map(function(e){return"".concat(e)}):"".concat(e)}),new KR(n.root===e?t:LN(n.root,e,t),a,i)}function LN(e,t,n){var r={};return HR(e.children,function(e,i){r[i]=e===t?n:LN(e,t,n)}),new JR(e.segments,r)}var FN=function(){function e(t,n,r){if(tp(this,e),this.isAbsolute=t,this.numberOfDoubleDots=n,this.commands=r,t&&r.length>0&&NN(r[0]))throw new Error("Root segment cannot have matrix parameters");var i=r.find(MN);if(i&&i!==zR(r))throw new Error("{outlets:{}} has to be the last command")}return rp(e,[{key:"toRoot",value:function(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}]),e}(),BN=rp(function e(t,n,r){tp(this,e),this.segmentGroup=t,this.processChildren=n,this.index=r});function VN(e,t,n){if(e||(e=new JR([],{})),0===e.segments.length&&e.hasChildren())return UN(e,t,n);var r=function(e,t,n){for(var r=0,i=t,a={match:!1,pathIndex:0,commandIndex:0};i<e.segments.length;){if(r>=n.length)return a;var o=e.segments[i],s=n[r];if(MN(s))break;var u="".concat(s),c=r<n.length-1?n[r+1]:null;if(i>0&&void 0===u)break;if(u&&c&&"object"==typeof c&&void 0===c.outlets){if(!qN(u,c,o))return a;r+=2}else{if(!qN(u,{},o))return a;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}(e,t,n),i=n.slice(r.commandIndex);if(r.match&&r.pathIndex<e.segments.length){var a=new JR(e.segments.slice(0,r.pathIndex),{});return a.children[RR]=new JR(e.segments.slice(r.pathIndex),e.children),UN(a,0,i)}return r.match&&0===i.length?new JR(e.segments,{}):r.match&&!e.hasChildren()?zN(e,t,n):r.match?UN(e,0,i):zN(e,t,n)}function UN(e,t,n){if(0===n.length)return new JR(e.segments,{});var r=function(e){return MN(e[0])?e[0].outlets:Dv({},RR,e)}(n),i={};return HR(r,function(n,r){"string"==typeof n&&(n=[n]),null!==n&&(i[r]=VN(e.children[r],t,n))}),HR(e.children,function(e,t){void 0===r[t]&&(i[t]=e)}),new JR(e.segments,i)}function zN(e,t,n){for(var r=e.segments.slice(0,t),i=0;i<n.length;){var a=n[i];if(MN(a)){var o=HN(a.outlets);return new JR(r,o)}if(0===i&&NN(n[0]))r.push(new QR(e.segments[t].path,GN(n[0]))),i++;else{var s=MN(a)?a.outlets[RR]:"".concat(a),u=i<n.length-1?n[i+1]:null;s&&u&&NN(u)?(r.push(new QR(s,GN(u))),i+=2):(r.push(new QR(s,{})),i++)}}return new JR(r,{})}function HN(e){var t={};return HR(e,function(e,n){"string"==typeof e&&(e=[e]),null!==e&&(t[n]=zN(new JR([],{}),0,e))}),t}function GN(e){var t={};return HR(e,function(e,n){return t[n]="".concat(e)}),t}function qN(e,t,n){return e==n.path&&BR(t,n.parameters)}var $N=function(){function e(t,n,r,i){tp(this,e),this.routeReuseStrategy=t,this.futureState=n,this.currState=r,this.forwardEvent=i}return rp(e,[{key:"activate",value:function(e){var t=this.futureState._root,n=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,n,e),IN(this.futureState.root),this.activateChildRoutes(t,n,e)}},{key:"deactivateChildRoutes",value:function(e,t,n){var r=this,i=_N(t);e.children.forEach(function(e){var t=e.value.outlet;r.deactivateRoutes(e,i[t],n),delete i[t]}),HR(i,function(e,t){r.deactivateRouteAndItsChildren(e,n)})}},{key:"deactivateRoutes",value:function(e,t,n){var r=e.value,i=t?t.value:null;if(r===i)if(r.component){var a=n.getContext(r.outlet);a&&this.deactivateChildRoutes(e,t,a.children)}else this.deactivateChildRoutes(e,t,n);else i&&this.deactivateRouteAndItsChildren(t,n)}},{key:"deactivateRouteAndItsChildren",value:function(e,t){this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}},{key:"detachAndStoreRouteSubtree",value:function(e,t){var n=t.getContext(e.value.outlet);if(n&&n.outlet){var r=n.outlet.detach(),i=n.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:r,route:e,contexts:i})}}},{key:"deactivateRouteAndOutlet",value:function(e,t){for(var n=t.getContext(e.value.outlet),r=n&&e.value.component?n.children:t,i=_N(e),a=0,o=Object.keys(i);a<o.length;a++){var s=o[a];this.deactivateRouteAndItsChildren(i[s],r)}n&&n.outlet&&(n.outlet.deactivate(),n.children.onOutletDeactivated(),n.attachRef=null,n.resolver=null,n.route=null)}},{key:"activateChildRoutes",value:function(e,t,n){var r=this,i=_N(t);e.children.forEach(function(e){r.activateRoutes(e,i[e.value.outlet],n),r.forwardEvent(new xR(e.value.snapshot))}),e.children.length&&this.forwardEvent(new TR(e.value.snapshot))}},{key:"activateRoutes",value:function(e,t,n){var r=e.value,i=t?t.value:null;if(IN(r),r===i)if(r.component){var a=n.getOrCreateContext(r.outlet);this.activateChildRoutes(e,t,a.children)}else this.activateChildRoutes(e,t,n);else if(r.component){var o=n.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){var s=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),o.children.onOutletReAttached(s.contexts),o.attachRef=s.componentRef,o.route=s.route.value,o.outlet&&o.outlet.attach(s.componentRef,s.route.value),WN(s.route)}else{var u=function(e){for(var t=e.parent;t;t=t.parent){var n=t.routeConfig;if(n&&n._loadedConfig)return n._loadedConfig;if(n&&n.component)return null}return null}(r.snapshot),c=u?u.module.componentFactoryResolver:null;o.attachRef=null,o.route=r,o.resolver=c,o.outlet&&o.outlet.activateWith(r,c),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,n)}}]),e}();function WN(e){IN(e.value),e.children.forEach(WN)}var jN=rp(function e(t,n){tp(this,e),this.routes=t,this.module=n});function ZN(e){return"function"==typeof e}function YN(e){return e instanceof KR}var KN=Symbol("INITIAL_VALUE");function JN(){return aR(function(e){return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=ig(t),i=rg(t),a=PI(t),o=a.args,s=a.keys;if(0===o.length)return ug([],r);var u=new Tp(function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Op;return function(r){XA(t,function(){for(var i=e.length,a=new Array(i),o=i,s=i,u=function(i){XA(t,function(){var u=ug(e[i],t),c=!1;u.subscribe(new Dp(r,function(e){a[i]=e,c||(c=!0,s--),s||r.next(n(a.slice()))},function(){--o||r.complete()}))},r)},c=0;c<i;c++)u(c)},r)}}(o,r,s?function(e){return II(s,e)}:Op));return i?u.pipe(TI(i)):u}(e.map(function(e){return e.pipe(cg(1),function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=ig(t);return Mp(function(e,n){(r?tR(t,e,r):tR(t,e)).subscribe(n)})}(KN))})).pipe(sR(function(e,t){var n=!1;return t.reduce(function(e,r,i){return e!==KN?e:(r===KN&&(n=!0),n||!1!==r&&i!==t.length-1&&!YN(r)?e:r)},e)},KN),yA(function(e){return e!==KN}),Lp(function(e){return YN(e)?e:!0===e}),cg(1))})}var QN=function(){var e=rp(function e(){tp(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=ey({type:e,selectors:[["ng-component"]],decls:1,vars:0,template:function(e,t){1&e&&fb(0,"router-outlet")},directives:function(){return[YM]},encapsulation:2}),e}();function XN(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=0;n<e.length;n++){var r=e[n];eM(r,tM(t,r))}}function eM(e,t){e.children&&XN(e.children,t)}function tM(e,t){return t?e||t.path?e&&!t.path?"".concat(e,"/"):!e&&t.path?t.path:"".concat(e,"/").concat(t.path):"":e}function nM(e){var t=e.children&&e.children.map(nM),n=t?Object.assign(Object.assign({},e),{children:t}):Object.assign({},e);return!n.component&&(t||n.loadChildren)&&n.outlet&&n.outlet!==RR&&(n.component=QN),n}function rM(e){return e.outlet||RR}function iM(e,t){var n=e.filter(function(e){return rM(e)===t});return n.push.apply(n,Kv(e.filter(function(e){return rM(e)!==t}))),n}var aM={matched:!1,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};function oM(e,t,n){var r;if(""===t.path)return"full"===t.pathMatch&&(e.hasChildren()||n.length>0)?Object.assign({},aM):{matched:!0,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};var i=(t.matcher||FR)(n,e,t);if(!i)return Object.assign({},aM);var a={};HR(i.posParams,function(e,t){a[t]=e.path});var o=i.consumed.length>0?Object.assign(Object.assign({},a),i.consumed[i.consumed.length-1].parameters):a;return{matched:!0,consumedSegments:i.consumed,lastChild:i.consumed.length,parameters:o,positionalParamSegments:null!==(r=i.posParams)&&void 0!==r?r:{}}}function sM(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"corrected";if(n.length>0&&function(e,t,n){return n.some(function(n){return uM(e,t,n)&&rM(n)!==RR})}(e,n,r)){var a=new JR(t,function(e,t,n,r){var i={};i[RR]=r,r._sourceSegment=e,r._segmentIndexShift=t.length;var a,o=Qv(n);try{for(o.s();!(a=o.n()).done;){var s=a.value;if(""===s.path&&rM(s)!==RR){var u=new JR([],{});u._sourceSegment=e,u._segmentIndexShift=t.length,i[rM(s)]=u}}}catch(c){o.e(c)}finally{o.f()}return i}(e,t,r,new JR(n,e.children)));return a._sourceSegment=e,a._segmentIndexShift=t.length,{segmentGroup:a,slicedSegments:[]}}if(0===n.length&&function(e,t,n){return n.some(function(n){return uM(e,t,n)})}(e,n,r)){var o=new JR(e.segments,function(e,t,n,r,i,a){var o,s={},u=Qv(r);try{for(u.s();!(o=u.n()).done;){var c=o.value;if(uM(e,n,c)&&!i[rM(c)]){var l=new JR([],{});l._sourceSegment=e,l._segmentIndexShift="legacy"===a?e.segments.length:t.length,s[rM(c)]=l}}}catch(h){u.e(h)}finally{u.f()}return Object.assign(Object.assign({},i),s)}(e,t,n,r,e.children,i));return o._sourceSegment=e,o._segmentIndexShift=t.length,{segmentGroup:o,slicedSegments:n}}var s=new JR(e.segments,e.children);return s._sourceSegment=e,s._segmentIndexShift=t.length,{segmentGroup:s,slicedSegments:n}}function uM(e,t,n){return(!(e.hasChildren()||t.length>0)||"full"!==n.pathMatch)&&""===n.path}function cM(e,t,n,r){return!!(rM(e)===r||r!==RR&&uM(t,n,e))&&("**"===e.path||oM(t,e,n).matched)}function lM(e,t,n){return 0===t.length&&!e.children[n]}var hM=rp(function e(t){tp(this,e),this.segmentGroup=t||null}),fM=rp(function e(t){tp(this,e),this.urlTree=t});function dM(e){return new Tp(function(t){return t.error(new hM(e))})}function vM(e){return new Tp(function(t){return t.error(new fM(e))})}function pM(e){return new Tp(function(t){return t.error(new Error("Only absolute redirects can have named outlets. redirectTo: '".concat(e,"'")))})}var gM=function(){function e(t,n,r,i,a){tp(this,e),this.configLoader=n,this.urlSerializer=r,this.urlTree=i,this.config=a,this.allowRedirects=!0,this.ngModule=t.get(FS)}return rp(e,[{key:"apply",value:function(){var e=this,t=sM(this.urlTree.root,[],[],this.config).segmentGroup,n=new JR(t.segments,t.children);return this.expandSegmentGroup(this.ngModule,this.config,n,RR).pipe(Lp(function(t){return e.createUrlTree(yM(t),e.urlTree.queryParams,e.urlTree.fragment)})).pipe(uR(function(t){if(t instanceof fM)return e.allowRedirects=!1,e.match(t.urlTree);throw t instanceof hM?e.noMatchError(t):t}))}},{key:"match",value:function(e){var t=this;return this.expandSegmentGroup(this.ngModule,this.config,e.root,RR).pipe(Lp(function(n){return t.createUrlTree(yM(n),e.queryParams,e.fragment)})).pipe(uR(function(e){throw e instanceof hM?t.noMatchError(e):e}))}},{key:"noMatchError",value:function(e){return new Error("Cannot match any routes. URL Segment: '".concat(e.segmentGroup,"'"))}},{key:"createUrlTree",value:function(e,t,n){var r=e.segments.length>0?new JR([],Dv({},RR,e)):e;return new KR(r,t,n)}},{key:"expandSegmentGroup",value:function(e,t,n,r){return 0===n.segments.length&&n.hasChildren()?this.expandChildren(e,t,n).pipe(Lp(function(e){return new JR([],e)})):this.expandSegment(e,n,t,n.segments,r,!0)}},{key:"expandChildren",value:function(e,t,n){for(var r=this,i=[],a=0,o=Object.keys(n.children);a<o.length;a++){var s=o[a];"primary"===s?i.unshift(s):i.push(s)}return ug(i).pipe(gA(function(i){var a=n.children[i],o=iM(t,i);return r.expandSegmentGroup(e,o,a,i).pipe(Lp(function(e){return{segment:e,outlet:i}}))}),sR(function(e,t){return e[t.outlet]=t.segment,e},{}),function(e,t){var n=arguments.length>=2;return function(r){return r.pipe(e?yA(function(t,n){return e(t,n,r)}):Op,cR(1),n?fR(t):lR(function(){return new eR}))}}())}},{key:"expandSegment",value:function(e,t,n,r,i,a){var o=this;return ug(n).pipe(gA(function(s){return o.expandSegmentAgainstRoute(e,t,n,s,r,i,a).pipe(uR(function(e){if(e instanceof hM)return pA(null);throw e}))}),dR(function(e){return!!e}),uR(function(e,n){if(e instanceof eR||"EmptyError"===e.name){if(lM(t,r,i))return pA(new JR([],{}));throw new hM(t)}throw e}))}},{key:"expandSegmentAgainstRoute",value:function(e,t,n,r,i,a,o){return cM(r,t,i,a)?void 0===r.redirectTo?this.matchSegmentAgainstRoute(e,t,r,i,a):o&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,t,n,r,i,a):dM(t):dM(t)}},{key:"expandSegmentAgainstRouteUsingRedirect",value:function(e,t,n,r,i,a){return"**"===r.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,n,r,a):this.expandRegularSegmentAgainstRouteUsingRedirect(e,t,n,r,i,a)}},{key:"expandWildCardWithParamsAgainstRouteUsingRedirect",value:function(e,t,n,r){var i=this,a=this.applyRedirectCommands([],n.redirectTo,{});return n.redirectTo.startsWith("/")?vM(a):this.lineralizeSegments(n,a).pipe(Xp(function(n){var a=new JR(n,{});return i.expandSegment(e,a,t,n,r,!1)}))}},{key:"expandRegularSegmentAgainstRouteUsingRedirect",value:function(e,t,n,r,i,a){var o=this,s=oM(t,r,i),u=s.matched,c=s.consumedSegments,l=s.lastChild,h=s.positionalParamSegments;if(!u)return dM(t);var f=this.applyRedirectCommands(c,r.redirectTo,h);return r.redirectTo.startsWith("/")?vM(f):this.lineralizeSegments(r,f).pipe(Xp(function(r){return o.expandSegment(e,t,n,r.concat(i.slice(l)),a,!1)}))}},{key:"matchSegmentAgainstRoute",value:function(e,t,n,r,i){var a=this;if("**"===n.path)return n.loadChildren?(n._loadedConfig?pA(n._loadedConfig):this.configLoader.load(e.injector,n)).pipe(Lp(function(e){return n._loadedConfig=e,new JR(r,{})})):pA(new JR(r,{}));var o=oM(t,n,r),s=o.matched,u=o.consumedSegments,c=o.lastChild;if(!s)return dM(t);var l=r.slice(c);return this.getChildConfig(e,n,r).pipe(Xp(function(e){var r=e.module,o=e.routes,s=sM(t,u,l,o),c=s.segmentGroup,h=s.slicedSegments,f=new JR(c.segments,c.children);if(0===h.length&&f.hasChildren())return a.expandChildren(r,o,f).pipe(Lp(function(e){return new JR(u,e)}));if(0===o.length&&0===h.length)return pA(new JR(u,{}));var d=rM(n)===i;return a.expandSegment(r,f,o,h,d?RR:i,!0).pipe(Lp(function(e){return new JR(u.concat(e.segments),e.children)}))}))}},{key:"getChildConfig",value:function(e,t,n){var r=this;return t.children?pA(new jN(t.children,e)):t.loadChildren?void 0!==t._loadedConfig?pA(t._loadedConfig):this.runCanLoadGuards(e.injector,t,n).pipe(Xp(function(n){return n?r.configLoader.load(e.injector,t).pipe(Lp(function(e){return t._loadedConfig=e,e})):(i=t,new Tp(function(e){return e.error(LR("Cannot load children because the guard of the route \"path: '".concat(i.path,"'\" returned false")))}));var i})):pA(new jN([],e))}},{key:"runCanLoadGuards",value:function(e,t,n){var r=this,i=t.canLoad;return i&&0!==i.length?pA(i.map(function(r){var i,a,o=e.get(r);if((a=o)&&ZN(a.canLoad))i=o.canLoad(t,n);else{if(!ZN(o))throw new Error("Invalid CanLoad guard");i=o(t,n)}return GR(i)})).pipe(JN(),vR(function(e){if(YN(e)){var t=LR('Redirecting to "'.concat(r.urlSerializer.serialize(e),'"'));throw t.url=e,t}}),Lp(function(e){return!0===e})):pA(!0)}},{key:"lineralizeSegments",value:function(e,t){for(var n=[],r=t.root;;){if(n=n.concat(r.segments),0===r.numberOfChildren)return pA(n);if(r.numberOfChildren>1||!r.children[RR])return pM(e.redirectTo);r=r.children[RR]}}},{key:"applyRedirectCommands",value:function(e,t,n){return this.applyRedirectCreatreUrlTree(t,this.urlSerializer.parse(t),e,n)}},{key:"applyRedirectCreatreUrlTree",value:function(e,t,n,r){var i=this.createSegmentGroup(e,t.root,n,r);return new KR(i,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}},{key:"createQueryParams",value:function(e,t){var n={};return HR(e,function(e,r){if("string"==typeof e&&e.startsWith(":")){var i=e.substring(1);n[r]=t[i]}else n[r]=e}),n}},{key:"createSegmentGroup",value:function(e,t,n,r){var i=this,a=this.createSegments(e,t.segments,n,r),o={};return HR(t.children,function(t,a){o[a]=i.createSegmentGroup(e,t,n,r)}),new JR(a,o)}},{key:"createSegments",value:function(e,t,n,r){var i=this;return t.map(function(t){return t.path.startsWith(":")?i.findPosParam(e,t,r):i.findOrReturn(t,n)})}},{key:"findPosParam",value:function(e,t,n){var r=n[t.path.substring(1)];if(!r)throw new Error("Cannot redirect to '".concat(e,"'. Cannot find '").concat(t.path,"'."));return r}},{key:"findOrReturn",value:function(e,t){var n,r=0,i=Qv(t);try{for(i.s();!(n=i.n()).done;){var a=n.value;if(a.path===e.path)return t.splice(r),a;r++}}catch(o){i.e(o)}finally{i.f()}return e}}]),e}();function yM(e){for(var t={},n=0,r=Object.keys(e.children);n<r.length;n++){var i=r[n],a=yM(e.children[i]);(a.segments.length>0||a.hasChildren())&&(t[i]=a)}return function(e){if(1===e.numberOfChildren&&e.children[RR]){var t=e.children[RR];return new JR(e.segments.concat(t.segments),t.children)}return e}(new JR(e.segments,t))}var mM=rp(function e(t){tp(this,e),this.path=t,this.route=this.path[this.path.length-1]}),kM=rp(function e(t,n){tp(this,e),this.component=t,this.route=n});function _M(e,t,n){var r=e._root;return CM(r,t?t._root:null,n,[r.value])}function wM(e,t,n){var r=function(e){if(!e)return null;for(var t=e.parent;t;t=t.parent){var n=t.routeConfig;if(n&&n._loadedConfig)return n._loadedConfig}return null}(t);return(r?r.module.injector:n).get(e)}function CM(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{canDeactivateChecks:[],canActivateChecks:[]},a=_N(t);return e.children.forEach(function(e){(function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{canDeactivateChecks:[],canActivateChecks:[]},a=e.value,o=t?t.value:null,s=n?n.getContext(e.value.outlet):null;if(o&&a.routeConfig===o.routeConfig){var u=function(e,t,n){if("function"==typeof n)return n(e,t);switch(n){case"pathParamsChange":return!XR(e.url,t.url);case"pathParamsOrQueryParamsChange":return!XR(e.url,t.url)||!BR(e.queryParams,t.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!xN(e,t)||!BR(e.queryParams,t.queryParams);case"paramsChange":default:return!xN(e,t)}}(o,a,a.routeConfig.runGuardsAndResolvers);u?i.canActivateChecks.push(new mM(r)):(a.data=o.data,a._resolvedData=o._resolvedData),CM(e,t,a.component?s?s.children:null:n,r,i),u&&s&&s.outlet&&s.outlet.isActivated&&i.canDeactivateChecks.push(new kM(s.outlet.component,o))}else o&&bM(t,s,i),i.canActivateChecks.push(new mM(r)),CM(e,null,a.component?s?s.children:null:n,r,i)})(e,a[e.value.outlet],n,r.concat([e.value]),i),delete a[e.value.outlet]}),HR(a,function(e,t){return bM(e,n.getContext(t),i)}),i}function bM(e,t,n){var r=_N(e),i=e.value;HR(r,function(e,r){bM(e,i.component?t?t.children.getContext(r):null:t,n)}),n.canDeactivateChecks.push(new kM(i.component&&t&&t.outlet&&t.outlet.isActivated?t.outlet.component:null,i))}var EM=rp(function e(){tp(this,e)});function SM(e){return new Tp(function(t){return t.error(e)})}var PM=function(){function e(t,n,r,i,a,o){tp(this,e),this.rootComponentType=t,this.config=n,this.urlTree=r,this.url=i,this.paramsInheritanceStrategy=a,this.relativeLinkResolution=o}return rp(e,[{key:"recognize",value:function(){var e=sM(this.urlTree.root,[],[],this.config.filter(function(e){return void 0===e.redirectTo}),this.relativeLinkResolution).segmentGroup,t=this.processSegmentGroup(this.config,e,RR);if(null===t)return null;var n=new SN([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},RR,this.rootComponentType,null,this.urlTree.root,-1,{}),r=new kN(n,t),i=new PN(this.url,r);return this.inheritParamsAndData(i._root),i}},{key:"inheritParamsAndData",value:function(e){var t=this,n=e.value,r=EN(n,this.paramsInheritanceStrategy);n.params=Object.freeze(r.params),n.data=Object.freeze(r.data),e.children.forEach(function(e){return t.inheritParamsAndData(e)})}},{key:"processSegmentGroup",value:function(e,t,n){return 0===t.segments.length&&t.hasChildren()?this.processChildren(e,t):this.processSegment(e,t,t.segments,n)}},{key:"processChildren",value:function(e,t){for(var n=[],r=0,i=Object.keys(t.children);r<i.length;r++){var a=i[r],o=t.children[a],s=iM(e,a),u=this.processSegmentGroup(s,o,a);if(null===u)return null;n.push.apply(n,Kv(u))}var c=OM(n);return c.sort(function(e,t){return e.value.outlet===RR?-1:t.value.outlet===RR?1:e.value.outlet.localeCompare(t.value.outlet)}),c}},{key:"processSegment",value:function(e,t,n,r){var i,a=Qv(e);try{for(a.s();!(i=a.n()).done;){var o=i.value,s=this.processSegmentAgainstRoute(o,t,n,r);if(null!==s)return s}}catch(u){a.e(u)}finally{a.f()}return lM(t,n,r)?[]:null}},{key:"processSegmentAgainstRoute",value:function(e,t,n,r){if(e.redirectTo||!cM(e,t,n,r))return null;var i,a=[],o=[];if("**"===e.path){var s=n.length>0?zR(n).parameters:{};i=new SN(n,s,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,xM(e),rM(e),e.component,e,TM(t),IM(t)+n.length,AM(e))}else{var u=oM(t,e,n);if(!u.matched)return null;a=u.consumedSegments,o=n.slice(u.lastChild),i=new SN(a,u.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,xM(e),rM(e),e.component,e,TM(t),IM(t)+a.length,AM(e))}var c,l=(c=e).children?c.children:c.loadChildren?c._loadedConfig.routes:[],h=sM(t,a,o,l.filter(function(e){return void 0===e.redirectTo}),this.relativeLinkResolution),f=h.segmentGroup,d=h.slicedSegments;if(0===d.length&&f.hasChildren()){var v=this.processChildren(l,f);return null===v?null:[new kN(i,v)]}if(0===l.length&&0===d.length)return[new kN(i,[])];var p=rM(e)===r,g=this.processSegment(l,f,d,p?RR:r);return null===g?null:[new kN(i,g)]}}]),e}();function OM(e){var t,n=[],r=new Set,i=Qv(e);try{var a=function(){var e,i=t.value;if(!function(e){var t=e.value.routeConfig;return t&&""===t.path&&void 0===t.redirectTo}(i))return n.push(i),"continue";var a=n.find(function(e){return i.value.routeConfig===e.value.routeConfig});void 0!==a?((e=a.children).push.apply(e,Kv(i.children)),r.add(a)):n.push(i)};for(i.s();!(t=i.n()).done;)a()}catch(l){i.e(l)}finally{i.f()}var o,s=Qv(r);try{for(s.s();!(o=s.n()).done;){var u=o.value,c=OM(u.children);n.push(new kN(u.value,c))}}catch(l){s.e(l)}finally{s.f()}return n.filter(function(e){return!r.has(e)})}function TM(e){for(var t=e;t._sourceSegment;)t=t._sourceSegment;return t}function IM(e){for(var t=e,n=t._segmentIndexShift?t._segmentIndexShift:0;t._sourceSegment;)n+=(t=t._sourceSegment)._segmentIndexShift?t._segmentIndexShift:0;return n-1}function xM(e){return e.data||{}}function AM(e){return e.resolve||{}}function RM(e){return aR(function(t){var n=e(t);return n?ug(n).pipe(Lp(function(){return t})):pA(t)})}var NM=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n)}(function(){function e(){tp(this,e)}return rp(e,[{key:"shouldDetach",value:function(e){return!1}},{key:"store",value:function(e,t){}},{key:"shouldAttach",value:function(e){return!1}},{key:"retrieve",value:function(e){return null}},{key:"shouldReuseRoute",value:function(e,t){return e.routeConfig===t.routeConfig}}]),e}()),MM=new ok("ROUTES"),DM=function(){function e(t,n,r,i){tp(this,e),this.loader=t,this.compiler=n,this.onLoadStartListener=r,this.onLoadEndListener=i}return rp(e,[{key:"load",value:function(e,t){var n=this;if(t._loader$)return t._loader$;this.onLoadStartListener&&this.onLoadStartListener(t);var r=this.loadModuleFactory(t.loadChildren).pipe(Lp(function(r){n.onLoadEndListener&&n.onLoadEndListener(t);var i=r.create(e);return new jN(UR(i.injector.get(MM,void 0,Mg.Self|Mg.Optional)).map(nM),i)}),uR(function(e){throw t._loader$=void 0,e}));return t._loader$=new iR(r,function(){return new Ap}).pipe(rR()),t._loader$}},{key:"loadModuleFactory",value:function(e){var t=this;return"string"==typeof e?ug(this.loader.load(e)):GR(e()).pipe(Xp(function(e){return e instanceof BS?pA(e):ug(t.compiler.compileModuleAsync(e))}))}}]),e}(),LM=rp(function e(){tp(this,e),this.outlet=null,this.route=null,this.resolver=null,this.children=new FM,this.attachRef=null}),FM=function(){function e(){tp(this,e),this.contexts=new Map}return rp(e,[{key:"onChildOutletCreated",value:function(e,t){var n=this.getOrCreateContext(e);n.outlet=t,this.contexts.set(e,n)}},{key:"onChildOutletDestroyed",value:function(e){var t=this.getContext(e);t&&(t.outlet=null,t.attachRef=null)}},{key:"onOutletDeactivated",value:function(){var e=this.contexts;return this.contexts=new Map,e}},{key:"onOutletReAttached",value:function(e){this.contexts=e}},{key:"getOrCreateContext",value:function(e){var t=this.getContext(e);return t||(t=new LM,this.contexts.set(e,t)),t}},{key:"getContext",value:function(e){return this.contexts.get(e)||null}}]),e}(),BM=function(){function e(){tp(this,e)}return rp(e,[{key:"shouldProcessUrl",value:function(e){return!0}},{key:"extract",value:function(e){return e}},{key:"merge",value:function(e,t){return e}}]),e}();function VM(e){throw e}function UM(e,t,n){return t.parse("/")}function zM(e,t){return pA(null)}var HM={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},GM={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},qM=function(){var e=function(){function e(t,n,r,i,a,o,s,u){var c=this;tp(this,e),this.rootComponentType=t,this.urlSerializer=n,this.rootContexts=r,this.location=i,this.config=u,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.lastLocationChangeInfo=null,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new Ap,this.errorHandler=VM,this.malformedUriErrorHandler=UM,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:zM,afterPreactivation:zM},this.urlHandlingStrategy=new BM,this.routeReuseStrategy=new NM,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.ngModule=a.get(FS),this.console=a.get(LP);var l=a.get(YP);this.isNgZoneEnabled=l instanceof YP&&YP.isInAngularZone(),this.resetConfig(u),this.currentUrlTree=new KR(new JR([],{}),{},null),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new DM(o,s,function(e){return c.triggerEvent(new SR(e))},function(e){return c.triggerEvent(new PR(e))}),this.routerState=CN(this.currentUrlTree,this.rootComponentType),this.transitions=new QA({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}return rp(e,[{key:"browserPageId",get:function(){var e;return null===(e=this.location.getState())||void 0===e?void 0:e.\u0275routerPageId}},{key:"setupNavigations",value:function(e){var t=this,n=this.events;return e.pipe(yA(function(e){return 0!==e.id}),Lp(function(e){return Object.assign(Object.assign({},e),{extractedUrl:t.urlHandlingStrategy.extract(e.rawUrl)})}),aR(function(e){var r=!1,i=!1;return pA(e).pipe(vR(function(e){t.currentNavigation={id:e.id,initialUrl:e.currentRawUrl,extractedUrl:e.extractedUrl,trigger:e.source,extras:e.extras,previousNavigation:t.lastSuccessfulNavigation?Object.assign(Object.assign({},t.lastSuccessfulNavigation),{previousNavigation:null}):null}}),aR(function(e){var r=t.browserUrlTree.toString(),a=!t.navigated||e.extractedUrl.toString()!==r||r!==t.currentUrlTree.toString();if(("reload"===t.onSameUrlNavigation||a)&&t.urlHandlingStrategy.shouldProcessUrl(e.rawUrl))return $M(e.source)&&(t.browserUrlTree=e.extractedUrl),pA(e).pipe(aR(function(e){var r=t.transitions.getValue();return n.next(new gR(e.id,t.serializeUrl(e.extractedUrl),e.source,e.restoredState)),r!==t.transitions.getValue()?tg:Promise.resolve(e)}),function(e,t,n,r){return aR(function(i){return function(e,t,n,r,i){return new gM(e,t,n,r,i).apply()}(e,t,n,i.extractedUrl,r).pipe(Lp(function(e){return Object.assign(Object.assign({},i),{urlAfterRedirects:e})}))})}(t.ngModule.injector,t.configLoader,t.urlSerializer,t.config),vR(function(e){t.currentNavigation=Object.assign(Object.assign({},t.currentNavigation),{finalUrl:e.urlAfterRedirects})}),function(e,n,r,a,o){return Xp(function(r){return function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"emptyOnly",o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"legacy";try{var s=new PM(e,t,n,r,a,o).recognize();return null===s?SM(new EM):pA(s)}catch(i){return SM(i)}}(e,n,r.urlAfterRedirects,(s=r.urlAfterRedirects,t.serializeUrl(s)),a,o).pipe(Lp(function(e){return Object.assign(Object.assign({},r),{targetSnapshot:e})}));var s})}(t.rootComponentType,t.config,0,t.paramsInheritanceStrategy,t.relativeLinkResolution),vR(function(e){"eager"===t.urlUpdateStrategy&&(e.extras.skipLocationChange||t.setBrowserUrl(e.urlAfterRedirects,e),t.browserUrlTree=e.urlAfterRedirects);var r=new _R(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);n.next(r)}));if(a&&t.rawUrlTree&&t.urlHandlingStrategy.shouldProcessUrl(t.rawUrlTree)){var o=e.id,s=e.extractedUrl,u=e.source,c=e.restoredState,l=e.extras,h=new gR(o,t.serializeUrl(s),u,c);n.next(h);var f=CN(s,t.rootComponentType).snapshot;return pA(Object.assign(Object.assign({},e),{targetSnapshot:f,urlAfterRedirects:s,extras:Object.assign(Object.assign({},l),{skipLocationChange:!1,replaceUrl:!1})}))}return t.rawUrlTree=e.rawUrl,t.browserUrlTree=e.urlAfterRedirects,e.resolve(null),tg}),RM(function(e){var n=e.targetSnapshot,r=e.id,i=e.extractedUrl,a=e.rawUrl,o=e.extras,s=o.skipLocationChange,u=o.replaceUrl;return t.hooks.beforePreactivation(n,{navigationId:r,appliedUrlTree:i,rawUrlTree:a,skipLocationChange:!!s,replaceUrl:!!u})}),vR(function(e){var n=new wR(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);t.triggerEvent(n)}),Lp(function(e){return Object.assign(Object.assign({},e),{guards:_M(e.targetSnapshot,e.currentSnapshot,t.rootContexts)})}),function(e,t){return Xp(function(n){var r=n.targetSnapshot,i=n.currentSnapshot,a=n.guards,o=a.canActivateChecks,s=a.canDeactivateChecks;return 0===s.length&&0===o.length?pA(Object.assign(Object.assign({},n),{guardsResult:!0})):function(e,t,n,r){return ug(e).pipe(Xp(function(e){return function(e,t,n,r,i){var a=t&&t.routeConfig?t.routeConfig.canDeactivate:null;return a&&0!==a.length?pA(a.map(function(a){var o,s=wM(a,t,i);if(function(e){return e&&ZN(e.canDeactivate)}(s))o=GR(s.canDeactivate(e,t,n,r));else{if(!ZN(s))throw new Error("Invalid CanDeactivate guard");o=GR(s(e,t,n,r))}return o.pipe(dR())})).pipe(JN()):pA(!0)}(e.component,e.route,n,t,r)}),dR(function(e){return!0!==e},!0))}(s,r,i,e).pipe(Xp(function(n){return n&&function(e){return"boolean"==typeof e}(n)?function(e,t,n,r){return ug(t).pipe(gA(function(t){return tR(function(e,t){return null!==e&&t&&t(new OR(e)),pA(!0)}(t.route.parent,r),function(e,t){return null!==e&&t&&t(new IR(e)),pA(!0)}(t.route,r),function(e,t,n){var r=t[t.length-1],i=t.slice(0,t.length-1).reverse().map(function(e){return function(e){var t=e.routeConfig?e.routeConfig.canActivateChild:null;return t&&0!==t.length?{node:e,guards:t}:null}(e)}).filter(function(e){return null!==e}).map(function(t){return nR(function(){return pA(t.guards.map(function(i){var a,o=wM(i,t.node,n);if(function(e){return e&&ZN(e.canActivateChild)}(o))a=GR(o.canActivateChild(r,e));else{if(!ZN(o))throw new Error("Invalid CanActivateChild guard");a=GR(o(r,e))}return a.pipe(dR())})).pipe(JN())})});return pA(i).pipe(JN())}(e,t.path,n),function(e,t,n){var r=t.routeConfig?t.routeConfig.canActivate:null;return r&&0!==r.length?pA(r.map(function(r){return nR(function(){var i,a=wM(r,t,n);if(function(e){return e&&ZN(e.canActivate)}(a))i=GR(a.canActivate(t,e));else{if(!ZN(a))throw new Error("Invalid CanActivate guard");i=GR(a(t,e))}return i.pipe(dR())})})).pipe(JN()):pA(!0)}(e,t.route,n))}),dR(function(e){return!0!==e},!0))}(r,o,e,t):pA(n)}),Lp(function(e){return Object.assign(Object.assign({},n),{guardsResult:e})}))})}(t.ngModule.injector,function(e){return t.triggerEvent(e)}),vR(function(e){if(YN(e.guardsResult)){var n=LR('Redirecting to "'.concat(t.serializeUrl(e.guardsResult),'"'));throw n.url=e.guardsResult,n}var r=new CR(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot,!!e.guardsResult);t.triggerEvent(r)}),yA(function(e){return!!e.guardsResult||(t.restoreHistory(e),t.cancelNavigationTransition(e,""),!1)}),RM(function(e){if(e.guards.canActivateChecks.length)return pA(e).pipe(vR(function(e){var n=new bR(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);t.triggerEvent(n)}),aR(function(e){var n=!1;return pA(e).pipe(function(e,t){return Xp(function(n){var r=n.targetSnapshot,i=n.guards.canActivateChecks;if(!i.length)return pA(n);var a=0;return ug(i).pipe(gA(function(n){return function(e,t,n,r){return function(e,t,n,r){var i=Object.keys(e);if(0===i.length)return pA({});var a={};return ug(i).pipe(Xp(function(i){return function(e,t,n,r){var i=wM(e,t,r);return GR(i.resolve?i.resolve(t,n):i(t,n))}(e[i],t,n,r).pipe(vR(function(e){a[i]=e}))}),cR(1),Xp(function(){return Object.keys(a).length===i.length?pA(a):tg}))}(e._resolve,e,t,r).pipe(Lp(function(t){return e._resolvedData=t,e.data=Object.assign(Object.assign({},e.data),EN(e,n).resolve),null}))}(n.route,r,e,t)}),vR(function(){return a++}),cR(1),Xp(function(e){return a===i.length?pA(n):tg}))})}(t.paramsInheritanceStrategy,t.ngModule.injector),vR({next:function(){return n=!0},complete:function(){n||(t.restoreHistory(e),t.cancelNavigationTransition(e,"At least one route resolver didn't emit any value."))}}))}),vR(function(e){var n=new ER(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);t.triggerEvent(n)}))}),RM(function(e){var n=e.targetSnapshot,r=e.id,i=e.extractedUrl,a=e.rawUrl,o=e.extras,s=o.skipLocationChange,u=o.replaceUrl;return t.hooks.afterPreactivation(n,{navigationId:r,appliedUrlTree:i,rawUrlTree:a,skipLocationChange:!!s,replaceUrl:!!u})}),Lp(function(e){var n=function(e,t,n){var r=AN(e,t._root,n?n._root:void 0);return new wN(r,t)}(t.routeReuseStrategy,e.targetSnapshot,e.currentRouterState);return Object.assign(Object.assign({},e),{targetRouterState:n})}),vR(function(e){t.currentUrlTree=e.urlAfterRedirects,t.rawUrlTree=t.urlHandlingStrategy.merge(e.urlAfterRedirects,e.rawUrl),t.routerState=e.targetRouterState,"deferred"===t.urlUpdateStrategy&&(e.extras.skipLocationChange||t.setBrowserUrl(t.rawUrlTree,e),t.browserUrlTree=e.urlAfterRedirects)}),function(e,t,n){return Lp(function(r){return new $N(t,r.targetRouterState,r.currentRouterState,n).activate(e),r})}(t.rootContexts,t.routeReuseStrategy,function(e){return t.triggerEvent(e)}),vR({next:function(){r=!0},complete:function(){r=!0}}),function(e){return Mp(function(t,n){try{t.subscribe(n)}finally{n.add(e)}})}(function(){var n;if(!r&&!i){var a="Navigation ID ".concat(e.id," is not equal to the current navigation id ").concat(t.navigationId);"replace"===t.canceledNavigationResolution?(t.restoreHistory(e),t.cancelNavigationTransition(e,a)):t.cancelNavigationTransition(e,a)}(null===(n=t.currentNavigation)||void 0===n?void 0:n.id)===e.id&&(t.currentNavigation=null)}),uR(function(r){if(i=!0,function(e){return e&&e[DR]}(r)){var a=YN(r.url);a||(t.navigated=!0,t.restoreHistory(e,!0));var o=new mR(e.id,t.serializeUrl(e.extractedUrl),r.message);n.next(o),a?setTimeout(function(){var n=t.urlHandlingStrategy.merge(r.url,t.rawUrlTree),i={skipLocationChange:e.extras.skipLocationChange,replaceUrl:"eager"===t.urlUpdateStrategy||$M(e.source)};t.scheduleNavigation(n,"imperative",null,i,{resolve:e.resolve,reject:e.reject,promise:e.promise})},0):e.resolve(!1)}else{t.restoreHistory(e,!0);var s=new kR(e.id,t.serializeUrl(e.extractedUrl),r);n.next(s);try{e.resolve(t.errorHandler(r))}catch(o){e.reject(o)}}return tg}))}))}},{key:"resetRootComponentType",value:function(e){this.rootComponentType=e,this.routerState.root.component=this.rootComponentType}},{key:"getTransition",value:function(){var e=this.transitions.value;return e.urlAfterRedirects=this.browserUrlTree,e}},{key:"setTransition",value:function(e){this.transitions.next(Object.assign(Object.assign({},this.getTransition()),e))}},{key:"initialNavigation",value:function(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}},{key:"setUpLocationChangeListener",value:function(){var e=this;this.locationSubscription||(this.locationSubscription=this.location.subscribe(function(t){var n=e.extractLocationChangeInfoFromEvent(t);e.shouldScheduleNavigation(e.lastLocationChangeInfo,n)&&setTimeout(function(){var t=n.source,r=n.state,i=n.urlTree,a={replaceUrl:!0};if(r){var o=Object.assign({},r);delete o.navigationId,delete o.\u0275routerPageId,0!==Object.keys(o).length&&(a.state=o)}e.scheduleNavigation(i,t,r,a)},0),e.lastLocationChangeInfo=n}))}},{key:"extractLocationChangeInfoFromEvent",value:function(e){var t;return{source:"popstate"===e.type?"popstate":"hashchange",urlTree:this.parseUrl(e.url),state:(null===(t=e.state)||void 0===t?void 0:t.navigationId)?e.state:null,transitionId:this.getTransition().id}}},{key:"shouldScheduleNavigation",value:function(e,t){if(!e)return!0;var n=t.urlTree.toString()===e.urlTree.toString();return t.transitionId!==e.transitionId||!n||!("hashchange"===t.source&&"popstate"===e.source||"popstate"===t.source&&"hashchange"===e.source)}},{key:"url",get:function(){return this.serializeUrl(this.currentUrlTree)}},{key:"getCurrentNavigation",value:function(){return this.currentNavigation}},{key:"triggerEvent",value:function(e){this.events.next(e)}},{key:"resetConfig",value:function(e){XN(e),this.config=e.map(nM),this.navigated=!1,this.lastSuccessfulId=-1}},{key:"ngOnDestroy",value:function(){this.dispose()}},{key:"dispose",value:function(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}},{key:"createUrlTree",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.relativeTo,r=t.queryParams,i=t.fragment,a=t.queryParamsHandling,o=t.preserveFragment,s=n||this.routerState.root,u=o?this.currentUrlTree.fragment:i,c=null;switch(a){case"merge":c=Object.assign(Object.assign({},this.currentUrlTree.queryParams),r);break;case"preserve":c=this.currentUrlTree.queryParams;break;default:c=r||null}return null!==c&&(c=this.removeEmptyProps(c)),function(e,t,n,r,i){if(0===n.length)return DN(t.root,t.root,t,r,i);var a=function(e){if("string"==typeof e[0]&&1===e.length&&"/"===e[0])return new FN(!0,0,e);var t=0,n=!1,r=e.reduce(function(e,r,i){if("object"==typeof r&&null!=r){if(r.outlets){var a={};return HR(r.outlets,function(e,t){a[t]="string"==typeof e?e.split("/"):e}),[].concat(Kv(e),[{outlets:a}])}if(r.segmentPath)return[].concat(Kv(e),[r.segmentPath])}return"string"!=typeof r?[].concat(Kv(e),[r]):0===i?(r.split("/").forEach(function(r,i){0==i&&"."===r||(0==i&&""===r?n=!0:".."===r?t++:""!=r&&e.push(r))}),e):[].concat(Kv(e),[r])},[]);return new FN(n,t,r)}(n);if(a.toRoot())return DN(t.root,new JR([],{}),t,r,i);var o=function(e,t,n){if(e.isAbsolute)return new BN(t.root,!0,0);if(-1===n.snapshot._lastPathIndex){var r=n.snapshot._urlSegment;return new BN(r,r===t.root,0)}var i=NN(e.commands[0])?0:1;return function(e,t,n){for(var r=e,i=t,a=n;a>i;){if(a-=i,!(r=r.parent))throw new Error("Invalid number of '../'");i=r.segments.length}return new BN(r,!1,i-a)}(n.snapshot._urlSegment,n.snapshot._lastPathIndex+i,e.numberOfDoubleDots)}(a,t,e),s=o.processChildren?UN(o.segmentGroup,o.index,a.commands):VN(o.segmentGroup,o.index,a.commands);return DN(o.segmentGroup,s,t,r,i)}(s,this.currentUrlTree,e,c,null!=u?u:null)}},{key:"navigateByUrl",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{skipLocationChange:!1},n=YN(e)?e:this.parseUrl(e),r=this.urlHandlingStrategy.merge(n,this.rawUrlTree);return this.scheduleNavigation(r,"imperative",null,t)}},{key:"navigate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{skipLocationChange:!1};return function(e){for(var t=0;t<e.length;t++){var n=e[t];if(null==n)throw new Error("The requested path contains ".concat(n," segment at index ").concat(t))}}(e),this.navigateByUrl(this.createUrlTree(e,t),t)}},{key:"serializeUrl",value:function(e){return this.urlSerializer.serialize(e)}},{key:"parseUrl",value:function(e){var t;try{t=this.urlSerializer.parse(e)}catch(n){t=this.malformedUriErrorHandler(n,this.urlSerializer,e)}return t}},{key:"isActive",value:function(e,t){var n;if(n=!0===t?Object.assign({},HM):!1===t?Object.assign({},GM):t,YN(e))return WR(this.currentUrlTree,e,n);var r=this.parseUrl(e);return WR(this.currentUrlTree,r,n)}},{key:"removeEmptyProps",value:function(e){return Object.keys(e).reduce(function(t,n){var r=e[n];return null!=r&&(t[n]=r),t},{})}},{key:"processNavigations",value:function(){var e=this;this.navigations.subscribe(function(t){e.navigated=!0,e.lastSuccessfulId=t.id,e.currentPageId=t.targetPageId,e.events.next(new yR(t.id,e.serializeUrl(t.extractedUrl),e.serializeUrl(e.currentUrlTree))),e.lastSuccessfulNavigation=e.currentNavigation,t.resolve(!0)},function(t){e.console.warn("Unhandled Navigation Error: ".concat(t))})}},{key:"scheduleNavigation",value:function(e,t,n,r,i){var a,o;if(this.disposed)return Promise.resolve(!1);var s,u,c,l=this.getTransition(),h=$M(t)&&l&&!$M(l.source),f=(this.lastSuccessfulId===l.id||this.currentNavigation?l.rawUrl:l.urlAfterRedirects).toString()===e.toString();if(h&&f)return Promise.resolve(!0);i?(s=i.resolve,u=i.reject,c=i.promise):c=new Promise(function(e,t){s=e,u=t});var d,v=++this.navigationId;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(n=this.location.getState()),d=n&&n.\u0275routerPageId?n.\u0275routerPageId:r.replaceUrl||r.skipLocationChange?null!==(a=this.browserPageId)&&void 0!==a?a:0:(null!==(o=this.browserPageId)&&void 0!==o?o:0)+1):d=0,this.setTransition({id:v,targetPageId:d,source:t,restoredState:n,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:e,extras:r,resolve:s,reject:u,promise:c,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),c.catch(function(e){return Promise.reject(e)})}},{key:"setBrowserUrl",value:function(e,t){var n=this.urlSerializer.serialize(e),r=Object.assign(Object.assign({},t.extras.state),this.generateNgRouterState(t.id,t.targetPageId));this.location.isCurrentPathEqualTo(n)||t.extras.replaceUrl?this.location.replaceState(n,"",r):this.location.go(n,"",r)}},{key:"restoreHistory",value:function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("computed"===this.canceledNavigationResolution){var i=this.currentPageId-e.targetPageId;"popstate"!==e.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==(null===(t=this.currentNavigation)||void 0===t?void 0:t.finalUrl)||0===i?this.currentUrlTree===(null===(n=this.currentNavigation)||void 0===n?void 0:n.finalUrl)&&0===i&&(this.resetState(e),this.browserUrlTree=e.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(i)}else"replace"===this.canceledNavigationResolution&&(r&&this.resetState(e),this.resetUrlToCurrentUrlTree())}},{key:"resetState",value:function(e){this.routerState=e.currentRouterState,this.currentUrlTree=e.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,e.rawUrl)}},{key:"resetUrlToCurrentUrlTree",value:function(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}},{key:"cancelNavigationTransition",value:function(e,t){var n=new mR(e.id,this.serializeUrl(e.extractedUrl),t);this.triggerEvent(n),e.resolve(!1)}},{key:"generateNgRouterState",value:function(e,t){return"computed"===this.canceledNavigationResolution?{navigationId:e,"\u0275routerPageId":t}:{navigationId:e}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Pk(uk),Pk(eN),Pk(FM),Pk(zO),Pk(VC),Pk(gO),Pk(WP),Pk(void 0))},e.\u0275prov=Eg({token:e,factory:e.\u0275fac}),e}();function $M(e){return"imperative"!==e}var WM=function(){var e=function(){function e(t,n,r,i,a){tp(this,e),this.router=t,this.route=n,this.commands=[],this.onChanges=new Ap,null==r&&i.setAttribute(a.nativeElement,"tabindex","0")}return rp(e,[{key:"ngOnChanges",value:function(e){this.onChanges.next(this)}},{key:"routerLink",set:function(e){this.commands=null!=e?Array.isArray(e)?e:[e]:[]}},{key:"onClick",value:function(){var e={skipLocationChange:ZM(this.skipLocationChange),replaceUrl:ZM(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,e),!0}},{key:"urlTree",get:function(){return this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:ZM(this.preserveFragment)})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(sb(qM),sb(bN),rk("tabindex"),sb(oS),sb(rS))},e.\u0275dir=oy({type:e,selectors:[["","routerLink","",5,"a",5,"area"]],hostBindings:function(e,t){1&e&&mb("click",function(){return t.onClick()})},inputs:{routerLink:"routerLink",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state",relativeTo:"relativeTo"},features:[ky]}),e}(),jM=function(){var e=function(){function e(t,n,r){var i=this;tp(this,e),this.router=t,this.route=n,this.locationStrategy=r,this.commands=[],this.onChanges=new Ap,this.subscription=t.events.subscribe(function(e){e instanceof yR&&i.updateTargetUrlAndHref()})}return rp(e,[{key:"routerLink",set:function(e){this.commands=null!=e?Array.isArray(e)?e:[e]:[]}},{key:"ngOnChanges",value:function(e){this.updateTargetUrlAndHref(),this.onChanges.next(this)}},{key:"ngOnDestroy",value:function(){this.subscription.unsubscribe()}},{key:"onClick",value:function(e,t,n,r,i){if(0!==e||t||n||r||i||"string"==typeof this.target&&"_self"!=this.target)return!0;var a={skipLocationChange:ZM(this.skipLocationChange),replaceUrl:ZM(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,a),!1}},{key:"updateTargetUrlAndHref",value:function(){this.href=this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.urlTree))}},{key:"urlTree",get:function(){return this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:ZM(this.preserveFragment)})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(sb(qM),sb(bN),sb(LO))},e.\u0275dir=oy({type:e,selectors:[["a","routerLink",""],["area","routerLink",""]],hostVars:2,hostBindings:function(e,t){1&e&&mb("click",function(e){return t.onClick(e.button,e.ctrlKey,e.shiftKey,e.altKey,e.metaKey)}),2&e&&(Fb("href",t.href,k_),tb("target",t.target))},inputs:{routerLink:"routerLink",target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state",relativeTo:"relativeTo"},features:[ky]}),e}();function ZM(e){return""===e||!!e}var YM=function(){var e=function(){function e(t,n,r,i,a){tp(this,e),this.parentContexts=t,this.location=n,this.resolver=r,this.changeDetector=a,this.activated=null,this._activatedRoute=null,this.activateEvents=new hP,this.deactivateEvents=new hP,this.name=i||RR,t.onChildOutletCreated(this.name,this)}return rp(e,[{key:"ngOnDestroy",value:function(){this.parentContexts.onChildOutletDestroyed(this.name)}},{key:"ngOnInit",value:function(){if(!this.activated){var e=this.parentContexts.getContext(this.name);e&&e.route&&(e.attachRef?this.attach(e.attachRef,e.route):this.activateWith(e.route,e.resolver||null))}}},{key:"isActivated",get:function(){return!!this.activated}},{key:"component",get:function(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}},{key:"activatedRoute",get:function(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}},{key:"activatedRouteData",get:function(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}},{key:"detach",value:function(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();var e=this.activated;return this.activated=null,this._activatedRoute=null,e}},{key:"attach",value:function(e,t){this.activated=e,this._activatedRoute=t,this.location.insert(e.hostView)}},{key:"deactivate",value:function(){if(this.activated){var e=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(e)}}},{key:"activateWith",value:function(e,t){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=e;var n=(t=t||this.resolver).resolveComponentFactory(e._futureSnapshot.routeConfig.component),r=this.parentContexts.getOrCreateContext(this.name).children,i=new KM(e,r,this.location.injector);this.activated=this.location.createComponent(n,this.location.length,i),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(sb(FM),sb(US),sb(XE),rk("name"),sb(IS))},e.\u0275dir=oy({type:e,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate"},exportAs:["outlet"]}),e}(),KM=function(){function e(t,n,r){tp(this,e),this.route=t,this.childContexts=n,this.parent=r}return rp(e,[{key:"get",value:function(e,t){return e===bN?this.route:e===FM?this.childContexts:this.parent.get(e,t)}}]),e}(),JM=rp(function e(){tp(this,e)}),QM=function(){function e(){tp(this,e)}return rp(e,[{key:"preload",value:function(e,t){return pA(null)}}]),e}(),XM=function(){var e=function(){function e(t,n,r,i,a){tp(this,e),this.router=t,this.injector=i,this.preloadingStrategy=a,this.loader=new DM(n,r,function(e){return t.triggerEvent(new SR(e))},function(e){return t.triggerEvent(new PR(e))})}return rp(e,[{key:"setUpPreloading",value:function(){var e=this;this.subscription=this.router.events.pipe(yA(function(e){return e instanceof yR}),gA(function(){return e.preload()})).subscribe(function(){})}},{key:"preload",value:function(){var e=this.injector.get(FS);return this.processRoutes(e,this.router.config)}},{key:"ngOnDestroy",value:function(){this.subscription&&this.subscription.unsubscribe()}},{key:"processRoutes",value:function(e,t){var n,r=[],i=Qv(t);try{for(i.s();!(n=i.n()).done;){var a=n.value;if(a.loadChildren&&!a.canLoad&&a._loadedConfig){var o=a._loadedConfig;r.push(this.processRoutes(o.module,o.routes))}else a.loadChildren&&!a.canLoad?r.push(this.preloadConfig(e,a)):a.children&&r.push(this.processRoutes(e,a.children))}}catch(s){i.e(s)}finally{i.f()}return ug(r).pipe(eg(),Lp(function(e){}))}},{key:"preloadConfig",value:function(e,t){var n=this;return this.preloadingStrategy.preload(t,function(){return(t._loadedConfig?pA(t._loadedConfig):n.loader.load(e.injector,t)).pipe(Xp(function(e){return t._loadedConfig=e,n.processRoutes(e.module,e.routes)}))})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Pk(qM),Pk(gO),Pk(WP),Pk(VC),Pk(JM))},e.\u0275prov=Eg({token:e,factory:e.\u0275fac}),e}(),eD=function(){var e=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};tp(this,e),this.router=t,this.viewportScroller=n,this.options=r,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},r.scrollPositionRestoration=r.scrollPositionRestoration||"disabled",r.anchorScrolling=r.anchorScrolling||"disabled"}return rp(e,[{key:"init",value:function(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}},{key:"createScrollEvents",value:function(){var e=this;return this.router.events.subscribe(function(t){t instanceof gR?(e.store[e.lastId]=e.viewportScroller.getScrollPosition(),e.lastSource=t.navigationTrigger,e.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof yR&&(e.lastId=t.id,e.scheduleScrollEvent(t,e.router.parseUrl(t.urlAfterRedirects).fragment))})}},{key:"consumeScrollEvents",value:function(){var e=this;return this.router.events.subscribe(function(t){t instanceof AR&&(t.position?"top"===e.options.scrollPositionRestoration?e.viewportScroller.scrollToPosition([0,0]):"enabled"===e.options.scrollPositionRestoration&&e.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===e.options.anchorScrolling?e.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==e.options.scrollPositionRestoration&&e.viewportScroller.scrollToPosition([0,0]))})}},{key:"scheduleScrollEvent",value:function(e,t){this.router.triggerEvent(new AR(e,"popstate"===this.lastSource?this.store[this.restoredId]:null,t))}},{key:"ngOnDestroy",value:function(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Pk(qM),Pk(UT),Pk(void 0))},e.\u0275prov=Eg({token:e,factory:e.\u0275fac}),e}(),tD=new ok("ROUTER_CONFIGURATION"),nD=new ok("ROUTER_FORROOT_GUARD"),rD=[zO,{provide:eN,useClass:tN},{provide:qM,useFactory:function(e,t,n,r,i,a,o){var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:{},u=arguments.length>8?arguments[8]:void 0,c=arguments.length>9?arguments[9]:void 0,l=new qM(null,e,t,n,r,i,a,UR(o));return u&&(l.urlHandlingStrategy=u),c&&(l.routeReuseStrategy=c),function(e,t){e.errorHandler&&(t.errorHandler=e.errorHandler),e.malformedUriErrorHandler&&(t.malformedUriErrorHandler=e.malformedUriErrorHandler),e.onSameUrlNavigation&&(t.onSameUrlNavigation=e.onSameUrlNavigation),e.paramsInheritanceStrategy&&(t.paramsInheritanceStrategy=e.paramsInheritanceStrategy),e.relativeLinkResolution&&(t.relativeLinkResolution=e.relativeLinkResolution),e.urlUpdateStrategy&&(t.urlUpdateStrategy=e.urlUpdateStrategy)}(s,l),s.enableTracing&&l.events.subscribe(function(e){var t,n;null===(t=console.group)||void 0===t||t.call(console,"Router Event: ".concat(e.constructor.name)),console.log(e.toString()),console.log(e),null===(n=console.groupEnd)||void 0===n||n.call(console)}),l},deps:[eN,FM,zO,VC,gO,WP,MM,tD,[function(){return rp(function e(){tp(this,e)})}(),new Mk],[function(){return rp(function e(){tp(this,e)})}(),new Mk]]},FM,{provide:bN,useFactory:function(e){return e.routerState.root},deps:[qM]},{provide:gO,useClass:kO},XM,QM,function(){function e(){tp(this,e)}return rp(e,[{key:"preload",value:function(e,t){return t().pipe(uR(function(){return pA(null)}))}}]),e}(),{provide:tD,useValue:{enableTracing:!1}}];function iD(){return new cO("Router",qM)}var aD=function(){var e=function(){function e(t,n){tp(this,e)}return rp(e,null,[{key:"forRoot",value:function(t,n){return{ngModule:e,providers:[rD,cD(t),{provide:nD,useFactory:uD,deps:[[qM,new Mk,new Dk]]},{provide:tD,useValue:n||{}},{provide:LO,useFactory:sD,deps:[OO,[new Nk(BO),new Mk],tD]},{provide:eD,useFactory:oD,deps:[qM,UT,tD]},{provide:JM,useExisting:n&&n.preloadingStrategy?n.preloadingStrategy:QM},{provide:cO,multi:!0,useFactory:iD},[lD,{provide:TP,multi:!0,useFactory:hD,deps:[lD]},{provide:dD,useFactory:fD,deps:[lD]},{provide:DP,multi:!0,useExisting:dD}]]}}},{key:"forChild",value:function(t){return{ngModule:e,providers:[cD(t)]}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Pk(nD,8),Pk(qM,8))},e.\u0275mod=iy({type:e}),e.\u0275inj=Sg({}),e}();function oD(e,t,n){return n.scrollOffset&&t.setOffset(n.scrollOffset),new eD(e,t,n)}function sD(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return n.useHash?new UO(e,t):new VO(e,t)}function uD(e){return"guarded"}function cD(e){return[{provide:sk,multi:!0,useValue:e},{provide:MM,multi:!0,useValue:e}]}var lD=function(){var e=function(){function e(t){tp(this,e),this.injector=t,this.initNavigation=!1,this.destroyed=!1,this.resultOfPreactivationDone=new Ap}return rp(e,[{key:"appInitializer",value:function(){var e=this;return this.injector.get(IO,Promise.resolve(null)).then(function(){if(e.destroyed)return Promise.resolve(!0);var t=null,n=new Promise(function(e){return t=e}),r=e.injector.get(qM),i=e.injector.get(tD);return"disabled"===i.initialNavigation?(r.setUpLocationChangeListener(),t(!0)):"enabled"===i.initialNavigation||"enabledBlocking"===i.initialNavigation?(r.hooks.afterPreactivation=function(){return e.initNavigation?pA(null):(e.initNavigation=!0,t(!0),e.resultOfPreactivationDone)},r.initialNavigation()):t(!0),n})}},{key:"bootstrapListener",value:function(e){var t=this.injector.get(tD),n=this.injector.get(XM),r=this.injector.get(eD),i=this.injector.get(qM),a=this.injector.get(vO);e===a.components[0]&&(("enabledNonBlocking"===t.initialNavigation||void 0===t.initialNavigation)&&i.initialNavigation(),n.setUpPreloading(),r.init(),i.resetRootComponentType(a.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}},{key:"ngOnDestroy",value:function(){this.destroyed=!0}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Pk(VC))},e.\u0275prov=Eg({token:e,factory:e.\u0275fac}),e}();function hD(e){return e.appInitializer.bind(e)}function fD(e){return e.bootstrapListener.bind(e)}var dD=new ok("Router Initializer"),vD=rp(function e(){tp(this,e)}),pD="*";function gD(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return{type:2,steps:e,options:t}}function yD(e){return{type:6,styles:e,offset:null}}function mD(e){Promise.resolve(null).then(e)}var kD=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;tp(this,e),this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=t+n}return rp(e,[{key:"_onFinish",value:function(){this._finished||(this._finished=!0,this._onDoneFns.forEach(function(e){return e()}),this._onDoneFns=[])}},{key:"onStart",value:function(e){this._onStartFns.push(e)}},{key:"onDone",value:function(e){this._onDoneFns.push(e)}},{key:"onDestroy",value:function(e){this._onDestroyFns.push(e)}},{key:"hasStarted",value:function(){return this._started}},{key:"init",value:function(){}},{key:"play",value:function(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}},{key:"triggerMicrotask",value:function(){var e=this;mD(function(){return e._onFinish()})}},{key:"_onStart",value:function(){this._onStartFns.forEach(function(e){return e()}),this._onStartFns=[]}},{key:"pause",value:function(){}},{key:"restart",value:function(){}},{key:"finish",value:function(){this._onFinish()}},{key:"destroy",value:function(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(function(e){return e()}),this._onDestroyFns=[])}},{key:"reset",value:function(){this._started=!1}},{key:"setPosition",value:function(e){this._position=this.totalTime?e*this.totalTime:1}},{key:"getPosition",value:function(){return this.totalTime?this._position/this.totalTime:1}},{key:"triggerCallback",value:function(e){var t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(function(e){return e()}),t.length=0}}]),e}(),_D=function(){function e(t){var n=this;tp(this,e),this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=t;var r=0,i=0,a=0,o=this.players.length;0==o?mD(function(){return n._onFinish()}):this.players.forEach(function(e){e.onDone(function(){++r==o&&n._onFinish()}),e.onDestroy(function(){++i==o&&n._onDestroy()}),e.onStart(function(){++a==o&&n._onStart()})}),this.totalTime=this.players.reduce(function(e,t){return Math.max(e,t.totalTime)},0)}return rp(e,[{key:"_onFinish",value:function(){this._finished||(this._finished=!0,this._onDoneFns.forEach(function(e){return e()}),this._onDoneFns=[])}},{key:"init",value:function(){this.players.forEach(function(e){return e.init()})}},{key:"onStart",value:function(e){this._onStartFns.push(e)}},{key:"_onStart",value:function(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(function(e){return e()}),this._onStartFns=[])}},{key:"onDone",value:function(e){this._onDoneFns.push(e)}},{key:"onDestroy",value:function(e){this._onDestroyFns.push(e)}},{key:"hasStarted",value:function(){return this._started}},{key:"play",value:function(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(function(e){return e.play()})}},{key:"pause",value:function(){this.players.forEach(function(e){return e.pause()})}},{key:"restart",value:function(){this.players.forEach(function(e){return e.restart()})}},{key:"finish",value:function(){this._onFinish(),this.players.forEach(function(e){return e.finish()})}},{key:"destroy",value:function(){this._onDestroy()}},{key:"_onDestroy",value:function(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(function(e){return e.destroy()}),this._onDestroyFns.forEach(function(e){return e()}),this._onDestroyFns=[])}},{key:"reset",value:function(){this.players.forEach(function(e){return e.reset()}),this._destroyed=!1,this._finished=!1,this._started=!1}},{key:"setPosition",value:function(e){var t=e*this.totalTime;this.players.forEach(function(e){var n=e.totalTime?Math.min(1,t/e.totalTime):1;e.setPosition(n)})}},{key:"getPosition",value:function(){var e=this.players.reduce(function(e,t){return null===e||t.totalTime>e.totalTime?t:e},null);return null!=e?e.getPosition():0}},{key:"beforeDestroy",value:function(){this.players.forEach(function(e){e.beforeDestroy&&e.beforeDestroy()})}},{key:"triggerCallback",value:function(e){var t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(function(e){return e()}),t.length=0}}]),e}();function wD(){return"undefined"!=typeof window&&void 0!==window.document}function CD(){return"undefined"!=typeof process&&"[object process]"==={}.toString.call(process)}function bD(e){switch(e.length){case 0:return new kD;case 1:return e[0];default:return new _D(e)}}function ED(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},o=[],s=[],u=-1,c=null;if(r.forEach(function(e){var n=e.offset,r=n==u,l=r&&c||{};Object.keys(e).forEach(function(n){var r=n,s=e[n];if("offset"!==n)switch(r=t.normalizePropertyName(r,o),s){case"!":s=i[n];break;case pD:s=a[n];break;default:s=t.normalizeStyleValue(n,r,s,o)}l[r]=s}),r||s.push(l),c=l,u=n}),o.length){var l="\n - ";throw new Error("Unable to animate due to the following errors:".concat(l).concat(o.join(l)))}return s}function SD(e,t,n,r){switch(t){case"start":e.onStart(function(){return r(n&&PD(n,"start",e))});break;case"done":e.onDone(function(){return r(n&&PD(n,"done",e))});break;case"destroy":e.onDestroy(function(){return r(n&&PD(n,"destroy",e))})}}function PD(e,t,n){var r,i=OD(e.element,e.triggerName,e.fromState,e.toState,t||e.phaseName,null!==(r=n.totalTime)&&void 0!==r?r:e.totalTime,!!n.disabled),a=e._data;return null!=a&&(i._data=a),i}function OD(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6?arguments[6]:void 0;return{element:e,triggerName:t,fromState:n,toState:r,phaseName:i,totalTime:a,disabled:!!o}}function TD(e,t,n){var r;return e instanceof Map?(r=e.get(t))||e.set(t,r=n):(r=e[t])||(r=e[t]=n),r}function ID(e){var t=e.indexOf(":");return[e.substring(1,t),e.substr(t+1)]}var xD=function(e,t){return!1},AD=function(e,t){return!1},RD=function(e,t,n){return[]},ND=CD();(ND||"undefined"!=typeof Element)&&(xD=wD()?function(e,t){for(;t&&t!==document.documentElement;){if(t===e)return!0;t=t.parentNode||t.host}return!1}:function(e,t){return e.contains(t)},AD=function(){if(ND||Element.prototype.matches)return function(e,t){return e.matches(t)};var e=Element.prototype,t=e.matchesSelector||e.mozMatchesSelector||e.msMatchesSelector||e.oMatchesSelector||e.webkitMatchesSelector;return t?function(e,n){return t.apply(e,[n])}:AD}(),RD=function(e,t,n){var r=[];if(n)for(var i=e.querySelectorAll(t),a=0;a<i.length;a++)r.push(i[a]);else{var o=e.querySelector(t);o&&r.push(o)}return r});var MD=null,DD=!1;function LD(e){MD||(MD=("undefined"!=typeof document?document.body:null)||{},DD=!!MD.style&&"WebkitAppearance"in MD.style);var t=!0;return MD.style&&!function(e){return"ebkit"==e.substring(1,6)}(e)&&(!(t=e in MD.style)&&DD&&(t="Webkit"+e.charAt(0).toUpperCase()+e.substr(1)in MD.style)),t}var FD=AD,BD=xD,VD=RD;function UD(e){var t={};return Object.keys(e).forEach(function(n){var r=n.replace(/([a-z])([A-Z])/g,"$1-$2");t[r]=e[n]}),t}var zD=function(){var e=function(){function e(){tp(this,e)}return rp(e,[{key:"validateStyleProperty",value:function(e){return LD(e)}},{key:"matchesElement",value:function(e,t){return FD(e,t)}},{key:"containsElement",value:function(e,t){return BD(e,t)}},{key:"query",value:function(e,t,n){return VD(e,t,n)}},{key:"computeStyle",value:function(e,t,n){return n||""}},{key:"animate",value:function(e,t,n,r,i){return new kD(n,r)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Eg({token:e,factory:e.\u0275fac}),e}(),HD=function(){var e=rp(function e(){tp(this,e)});return e.NOOP=new zD,e}(),GD="ng-enter",qD="ng-leave",$D="ng-trigger",WD=".ng-trigger",jD="ng-animating",ZD=".ng-animating";function YD(e){if("number"==typeof e)return e;var t=e.match(/^(-?[\.\d]+)(m?s)/);return!t||t.length<2?0:KD(parseFloat(t[1]),t[2])}function KD(e,t){switch(t){case"s":return 1e3*e;default:return e}}function JD(e,t,n){return e.hasOwnProperty("duration")?e:function(e,t,n){var r,i=0,a="";if("string"==typeof e){var o=e.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===o)return t.push('The provided timing value "'.concat(e,'" is invalid.')),{duration:0,delay:0,easing:""};r=KD(parseFloat(o[1]),o[2]);var s=o[3];null!=s&&(i=KD(parseFloat(s),o[4]));var u=o[5];u&&(a=u)}else r=e;if(!n){var c=!1,l=t.length;r<0&&(t.push("Duration values below 0 are not allowed for this animation step."),c=!0),i<0&&(t.push("Delay values below 0 are not allowed for this animation step."),c=!0),c&&t.splice(l,0,'The provided timing value "'.concat(e,'" is invalid.'))}return{duration:r,delay:i,easing:a}}(e,t,n)}function QD(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object.keys(e).forEach(function(n){t[n]=e[n]}),t}function XD(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(t)for(var r in e)n[r]=e[r];else QD(e,n);return n}function eL(e,t,n){return n?t+":"+n+";":""}function tL(e){for(var t="",n=0;n<e.style.length;n++){var r=e.style.item(n);t+=eL(0,r,e.style.getPropertyValue(r))}for(var i in e.style)e.style.hasOwnProperty(i)&&!i.startsWith("_")&&(t+=eL(0,hL(i),e.style[i]));e.setAttribute("style",t)}function nL(e,t,n){e.style&&(Object.keys(t).forEach(function(r){var i=lL(r);n&&!n.hasOwnProperty(r)&&(n[r]=e.style[i]),e.style[i]=t[r]}),CD()&&tL(e))}function rL(e,t){e.style&&(Object.keys(t).forEach(function(t){var n=lL(t);e.style[n]=""}),CD()&&tL(e))}function iL(e){return Array.isArray(e)?1==e.length?e[0]:gD(e):e}var aL=new RegExp("{{\\s*(.+?)\\s*}}","g");function oL(e){var t=[];if("string"==typeof e){for(var n;n=aL.exec(e);)t.push(n[1]);aL.lastIndex=0}return t}function sL(e,t,n){var r=e.toString(),i=r.replace(aL,function(e,r){var i=t[r];return t.hasOwnProperty(r)||(n.push("Please provide a value for the animation param ".concat(r)),i=""),i.toString()});return i==r?e:i}function uL(e){for(var t=[],n=e.next();!n.done;)t.push(n.value),n=e.next();return t}var cL=/-+([a-z0-9])/g;function lL(e){return e.replace(cL,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t[1].toUpperCase()})}function hL(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function fL(e,t){return 0===e||0===t}function dL(e,t,n){var r=Object.keys(n);if(r.length&&t.length){var i=t[0],a=[];if(r.forEach(function(e){i.hasOwnProperty(e)||a.push(e),i[e]=n[e]}),a.length)for(var o=function(){var n=t[s];a.forEach(function(t){n[t]=pL(e,t)})},s=1;s<t.length;s++)o()}return t}function vL(e,t,n){switch(t.type){case 7:return e.visitTrigger(t,n);case 0:return e.visitState(t,n);case 1:return e.visitTransition(t,n);case 2:return e.visitSequence(t,n);case 3:return e.visitGroup(t,n);case 4:return e.visitAnimate(t,n);case 5:return e.visitKeyframes(t,n);case 6:return e.visitStyle(t,n);case 8:return e.visitReference(t,n);case 9:return e.visitAnimateChild(t,n);case 10:return e.visitAnimateRef(t,n);case 11:return e.visitQuery(t,n);case 12:return e.visitStagger(t,n);default:throw new Error("Unable to resolve animation metadata node #".concat(t.type))}}function pL(e,t){return window.getComputedStyle(e)[t]}function gL(e,t){var n=[];return"string"==typeof e?e.split(/\s*,\s*/).forEach(function(e){return function(e,t,n){if(":"==e[0]){var r=function(e,t){switch(e){case":enter":return"void => *";case":leave":return"* => void";case":increment":return function(e,t){return parseFloat(t)>parseFloat(e)};case":decrement":return function(e,t){return parseFloat(t)<parseFloat(e)};default:return t.push('The transition alias value "'.concat(e,'" is not supported')),"* => *"}}(e,n);if("function"==typeof r)return void t.push(r);e=r}var i=e.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==i||i.length<4)return n.push('The provided transition expression "'.concat(e,'" is not supported')),t;var a=i[1],o=i[2],s=i[3];t.push(kL(a,s)),"<"==o[0]&&("*"!=a||"*"!=s)&&t.push(kL(s,a))}(e,n,t)}):n.push(e),n}var yL=new Set(["true","1"]),mL=new Set(["false","0"]);function kL(e,t){var n=yL.has(e)||mL.has(e),r=yL.has(t)||mL.has(t);return function(i,a){var o="*"==e||e==i,s="*"==t||t==a;return!o&&n&&"boolean"==typeof i&&(o=i?yL.has(e):mL.has(e)),!s&&r&&"boolean"==typeof a&&(s=a?yL.has(t):mL.has(t)),o&&s}}var _L=new RegExp("s*:selfs*,?","g");function wL(e,t,n){return new CL(e).build(t,n)}var CL=function(){function e(t){tp(this,e),this._driver=t}return rp(e,[{key:"build",value:function(e,t){var n=new bL(t);return this._resetContextStyleTimingState(n),vL(this,iL(e),n)}},{key:"_resetContextStyleTimingState",value:function(e){e.currentQuerySelector="",e.collectedStyles={},e.collectedStyles[""]={},e.currentTime=0}},{key:"visitTrigger",value:function(e,t){var n=this,r=t.queryCount=0,i=t.depCount=0,a=[],o=[];return"@"==e.name.charAt(0)&&t.errors.push("animation triggers cannot be prefixed with an `@` sign (e.g. trigger('@foo', [...]))"),e.definitions.forEach(function(e){if(n._resetContextStyleTimingState(t),0==e.type){var s=e,u=s.name;u.toString().split(/\s*,\s*/).forEach(function(e){s.name=e,a.push(n.visitState(s,t))}),s.name=u}else if(1==e.type){var c=n.visitTransition(e,t);r+=c.queryCount,i+=c.depCount,o.push(c)}else t.errors.push("only state() and transition() definitions can sit inside of a trigger()")}),{type:7,name:e.name,states:a,transitions:o,queryCount:r,depCount:i,options:null}}},{key:"visitState",value:function(e,t){var n=this.visitStyle(e.styles,t),r=e.options&&e.options.params||null;if(n.containsDynamicStyles){var i=new Set,a=r||{};if(n.styles.forEach(function(e){if(EL(e)){var t=e;Object.keys(t).forEach(function(e){oL(t[e]).forEach(function(e){a.hasOwnProperty(e)||i.add(e)})})}}),i.size){var o=uL(i.values());t.errors.push('state("'.concat(e.name,'", ...) must define default values for all the following style substitutions: ').concat(o.join(", ")))}}return{type:0,name:e.name,style:n,options:r?{params:r}:null}}},{key:"visitTransition",value:function(e,t){t.queryCount=0,t.depCount=0;var n=vL(this,iL(e.animation),t);return{type:1,matchers:gL(e.expr,t.errors),animation:n,queryCount:t.queryCount,depCount:t.depCount,options:SL(e.options)}}},{key:"visitSequence",value:function(e,t){var n=this;return{type:2,steps:e.steps.map(function(e){return vL(n,e,t)}),options:SL(e.options)}}},{key:"visitGroup",value:function(e,t){var n=this,r=t.currentTime,i=0,a=e.steps.map(function(e){t.currentTime=r;var a=vL(n,e,t);return i=Math.max(i,t.currentTime),a});return t.currentTime=i,{type:3,steps:a,options:SL(e.options)}}},{key:"visitAnimate",value:function(e,t){var n=function(e,t){var n=null;if(e.hasOwnProperty("duration"))n=e;else if("number"==typeof e)return PL(JD(e,t).duration,0,"");var r=e;if(r.split(/\s+/).some(function(e){return"{"==e.charAt(0)&&"{"==e.charAt(1)})){var i=PL(0,0,"");return i.dynamic=!0,i.strValue=r,i}return PL((n=n||JD(r,t)).duration,n.delay,n.easing)}(e.timings,t.errors);t.currentAnimateTimings=n;var r,i=e.styles?e.styles:yD({});if(5==i.type)r=this.visitKeyframes(i,t);else{var a=e.styles,o=!1;if(!a){o=!0;var s={};n.easing&&(s.easing=n.easing),a=yD(s)}t.currentTime+=n.duration+n.delay;var u=this.visitStyle(a,t);u.isEmptyStep=o,r=u}return t.currentAnimateTimings=null,{type:4,timings:n,style:r,options:null}}},{key:"visitStyle",value:function(e,t){var n=this._makeStyleAst(e,t);return this._validateStyleAst(n,t),n}},{key:"_makeStyleAst",value:function(e,t){var n=[];Array.isArray(e.styles)?e.styles.forEach(function(e){"string"==typeof e?e==pD?n.push(e):t.errors.push("The provided style string value ".concat(e," is not allowed.")):n.push(e)}):n.push(e.styles);var r=!1,i=null;return n.forEach(function(e){if(EL(e)){var t=e,n=t.easing;if(n&&(i=n,delete t.easing),!r)for(var a in t)if(t[a].toString().indexOf("{{")>=0){r=!0;break}}}),{type:6,styles:n,easing:i,offset:e.offset,containsDynamicStyles:r,options:null}}},{key:"_validateStyleAst",value:function(e,t){var n=this,r=t.currentAnimateTimings,i=t.currentTime,a=t.currentTime;r&&a>0&&(a-=r.duration+r.delay),e.styles.forEach(function(e){"string"!=typeof e&&Object.keys(e).forEach(function(r){if(n._driver.validateStyleProperty(r)){var o=t.collectedStyles[t.currentQuerySelector],s=o[r],u=!0;s&&(a!=i&&a>=s.startTime&&i<=s.endTime&&(t.errors.push('The CSS property "'.concat(r,'" that exists between the times of "').concat(s.startTime,'ms" and "').concat(s.endTime,'ms" is also being animated in a parallel animation between the times of "').concat(a,'ms" and "').concat(i,'ms"')),u=!1),a=s.startTime),u&&(o[r]={startTime:a,endTime:i}),t.options&&function(e,t,n){var r=t.params||{},i=oL(e);i.length&&i.forEach(function(e){r.hasOwnProperty(e)||n.push("Unable to resolve the local animation param ".concat(e," in the given list of values"))})}(e[r],t.options,t.errors)}else t.errors.push('The provided animation property "'.concat(r,'" is not a supported CSS property for animations'))})})}},{key:"visitKeyframes",value:function(e,t){var n=this,r={type:5,styles:[],options:null};if(!t.currentAnimateTimings)return t.errors.push("keyframes() must be placed inside of a call to animate()"),r;var i=0,a=[],o=!1,s=!1,u=0,c=e.steps.map(function(e){var r=n._makeStyleAst(e,t),c=null!=r.offset?r.offset:function(e){if("string"==typeof e)return null;var t=null;if(Array.isArray(e))e.forEach(function(e){if(EL(e)&&e.hasOwnProperty("offset")){var n=e;t=parseFloat(n.offset),delete n.offset}});else if(EL(e)&&e.hasOwnProperty("offset")){var n=e;t=parseFloat(n.offset),delete n.offset}return t}(r.styles),l=0;return null!=c&&(i++,l=r.offset=c),s=s||l<0||l>1,o=o||l<u,u=l,a.push(l),r});s&&t.errors.push("Please ensure that all keyframe offsets are between 0 and 1"),o&&t.errors.push("Please ensure that all keyframe offsets are in order");var l=e.steps.length,h=0;i>0&&i<l?t.errors.push("Not all style() steps within the declared keyframes() contain offsets"):0==i&&(h=1/(l-1));var f=l-1,d=t.currentTime,v=t.currentAnimateTimings,p=v.duration;return c.forEach(function(e,i){var o=h>0?i==f?1:h*i:a[i],s=o*p;t.currentTime=d+v.delay+s,v.duration=s,n._validateStyleAst(e,t),e.offset=o,r.styles.push(e)}),r}},{key:"visitReference",value:function(e,t){return{type:8,animation:vL(this,iL(e.animation),t),options:SL(e.options)}}},{key:"visitAnimateChild",value:function(e,t){return t.depCount++,{type:9,options:SL(e.options)}}},{key:"visitAnimateRef",value:function(e,t){return{type:10,animation:this.visitReference(e.animation,t),options:SL(e.options)}}},{key:"visitQuery",value:function(e,t){var n=t.currentQuerySelector,r=e.options||{};t.queryCount++,t.currentQuery=e;var i=Lv(function(e){var t=!!e.split(/\s*,\s*/).find(function(e){return":self"==e});return t&&(e=e.replace(_L,"")),[e=e.replace(/@\*/g,WD).replace(/@\w+/g,function(e){return WD+"-"+e.substr(1)}).replace(/:animating/g,ZD),t]}(e.selector),2),a=i[0],o=i[1];t.currentQuerySelector=n.length?n+" "+a:a,TD(t.collectedStyles,t.currentQuerySelector,{});var s=vL(this,iL(e.animation),t);return t.currentQuery=null,t.currentQuerySelector=n,{type:11,selector:a,limit:r.limit||0,optional:!!r.optional,includeSelf:o,animation:s,originalSelector:e.selector,options:SL(e.options)}}},{key:"visitStagger",value:function(e,t){t.currentQuery||t.errors.push("stagger() can only be used inside of query()");var n="full"===e.timings?{duration:0,delay:0,easing:"full"}:JD(e.timings,t.errors,!0);return{type:12,animation:vL(this,iL(e.animation),t),timings:n,options:null}}}]),e}(),bL=rp(function e(t){tp(this,e),this.errors=t,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles={},this.options=null});function EL(e){return!Array.isArray(e)&&"object"==typeof e}function SL(e){return e?(e=QD(e)).params&&(e.params=function(e){return e?QD(e):null}(e.params)):e={},e}function PL(e,t,n){return{duration:e,delay:t,easing:n}}function OL(e,t,n,r,i,a){var o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,s=arguments.length>7&&void 0!==arguments[7]&&arguments[7];return{type:1,element:e,keyframes:t,preStyleProps:n,postStyleProps:r,duration:i,delay:a,totalTime:i+a,easing:o,subTimeline:s}}var TL=function(){function e(){tp(this,e),this._map=new Map}return rp(e,[{key:"consume",value:function(e){var t=this._map.get(e);return t?this._map.delete(e):t=[],t}},{key:"append",value:function(e,t){var n,r=this._map.get(e);r||this._map.set(e,r=[]),(n=r).push.apply(n,Kv(t))}},{key:"has",value:function(e){return this._map.has(e)}},{key:"clear",value:function(){this._map.clear()}}]),e}(),IL=new RegExp(":enter","g"),xL=new RegExp(":leave","g");function AL(e,t,n,r,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{},s=arguments.length>7?arguments[7]:void 0,u=arguments.length>8?arguments[8]:void 0,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:[];return(new RL).buildKeyframes(e,t,n,r,i,a,o,s,u,c)}var RL=function(){function e(){tp(this,e)}return rp(e,[{key:"buildKeyframes",value:function(e,t,n,r,i,a,o,s,u){var c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:[];u=u||new TL;var l=new ML(e,t,u,r,i,c,[]);l.options=s,l.currentTimeline.setStyles([a],null,l.errors,s),vL(this,n,l);var h=l.timelines.filter(function(e){return e.containsAnimation()});if(h.length&&Object.keys(o).length){var f=h[h.length-1];f.allowOnlyTimelineStyles()||f.setStyles([o],null,l.errors,s)}return h.length?h.map(function(e){return e.buildKeyframes()}):[OL(t,[],[],[],0,0,"",!1)]}},{key:"visitTrigger",value:function(e,t){}},{key:"visitState",value:function(e,t){}},{key:"visitTransition",value:function(e,t){}},{key:"visitAnimateChild",value:function(e,t){var n=t.subInstructions.consume(t.element);if(n){var r=t.createSubContext(e.options),i=t.currentTimeline.currentTime,a=this._visitSubInstructions(n,r,r.options);i!=a&&t.transformIntoNewTimeline(a)}t.previousNode=e}},{key:"visitAnimateRef",value:function(e,t){var n=t.createSubContext(e.options);n.transformIntoNewTimeline(),this.visitReference(e.animation,n),t.transformIntoNewTimeline(n.currentTimeline.currentTime),t.previousNode=e}},{key:"_visitSubInstructions",value:function(e,t,n){var r=t.currentTimeline.currentTime,i=null!=n.duration?YD(n.duration):null,a=null!=n.delay?YD(n.delay):null;return 0!==i&&e.forEach(function(e){var n=t.appendInstructionToTimeline(e,i,a);r=Math.max(r,n.duration+n.delay)}),r}},{key:"visitReference",value:function(e,t){t.updateOptions(e.options,!0),vL(this,e.animation,t),t.previousNode=e}},{key:"visitSequence",value:function(e,t){var n=this,r=t.subContextCount,i=t,a=e.options;if(a&&(a.params||a.delay)&&((i=t.createSubContext(a)).transformIntoNewTimeline(),null!=a.delay)){6==i.previousNode.type&&(i.currentTimeline.snapshotCurrentStyles(),i.previousNode=NL);var o=YD(a.delay);i.delayNextStep(o)}e.steps.length&&(e.steps.forEach(function(e){return vL(n,e,i)}),i.currentTimeline.applyStylesToKeyframe(),i.subContextCount>r&&i.transformIntoNewTimeline()),t.previousNode=e}},{key:"visitGroup",value:function(e,t){var n=this,r=[],i=t.currentTimeline.currentTime,a=e.options&&e.options.delay?YD(e.options.delay):0;e.steps.forEach(function(o){var s=t.createSubContext(e.options);a&&s.delayNextStep(a),vL(n,o,s),i=Math.max(i,s.currentTimeline.currentTime),r.push(s.currentTimeline)}),r.forEach(function(e){return t.currentTimeline.mergeTimelineCollectedStyles(e)}),t.transformIntoNewTimeline(i),t.previousNode=e}},{key:"_visitTiming",value:function(e,t){if(e.dynamic){var n=e.strValue;return JD(t.params?sL(n,t.params,t.errors):n,t.errors)}return{duration:e.duration,delay:e.delay,easing:e.easing}}},{key:"visitAnimate",value:function(e,t){var n=t.currentAnimateTimings=this._visitTiming(e.timings,t),r=t.currentTimeline;n.delay&&(t.incrementTime(n.delay),r.snapshotCurrentStyles());var i=e.style;5==i.type?this.visitKeyframes(i,t):(t.incrementTime(n.duration),this.visitStyle(i,t),r.applyStylesToKeyframe()),t.currentAnimateTimings=null,t.previousNode=e}},{key:"visitStyle",value:function(e,t){var n=t.currentTimeline,r=t.currentAnimateTimings;!r&&n.getCurrentStyleProperties().length&&n.forwardFrame();var i=r&&r.easing||e.easing;e.isEmptyStep?n.applyEmptyStep(i):n.setStyles(e.styles,i,t.errors,t.options),t.previousNode=e}},{key:"visitKeyframes",value:function(e,t){var n=t.currentAnimateTimings,r=t.currentTimeline.duration,i=n.duration,a=t.createSubContext().currentTimeline;a.easing=n.easing,e.styles.forEach(function(e){a.forwardTime((e.offset||0)*i),a.setStyles(e.styles,e.easing,t.errors,t.options),a.applyStylesToKeyframe()}),t.currentTimeline.mergeTimelineCollectedStyles(a),t.transformIntoNewTimeline(r+i),t.previousNode=e}},{key:"visitQuery",value:function(e,t){var n=this,r=t.currentTimeline.currentTime,i=e.options||{},a=i.delay?YD(i.delay):0;a&&(6===t.previousNode.type||0==r&&t.currentTimeline.getCurrentStyleProperties().length)&&(t.currentTimeline.snapshotCurrentStyles(),t.previousNode=NL);var o=r,s=t.invokeQuery(e.selector,e.originalSelector,e.limit,e.includeSelf,!!i.optional,t.errors);t.currentQueryTotal=s.length;var u=null;s.forEach(function(r,i){t.currentQueryIndex=i;var s=t.createSubContext(e.options,r);a&&s.delayNextStep(a),r===t.element&&(u=s.currentTimeline),vL(n,e.animation,s),s.currentTimeline.applyStylesToKeyframe(),o=Math.max(o,s.currentTimeline.currentTime)}),t.currentQueryIndex=0,t.currentQueryTotal=0,t.transformIntoNewTimeline(o),u&&(t.currentTimeline.mergeTimelineCollectedStyles(u),t.currentTimeline.snapshotCurrentStyles()),t.previousNode=e}},{key:"visitStagger",value:function(e,t){var n=t.parentContext,r=t.currentTimeline,i=e.timings,a=Math.abs(i.duration),o=a*(t.currentQueryTotal-1),s=a*t.currentQueryIndex;switch(i.duration<0?"reverse":i.easing){case"reverse":s=o-s;break;case"full":s=n.currentStaggerTime}var u=t.currentTimeline;s&&u.delayNextStep(s);var c=u.currentTime;vL(this,e.animation,t),t.previousNode=e,n.currentStaggerTime=r.currentTime-c+(r.startTime-n.currentTimeline.startTime)}}]),e}(),NL={},ML=function(){function e(t,n,r,i,a,o,s,u){tp(this,e),this._driver=t,this.element=n,this.subInstructions=r,this._enterClassName=i,this._leaveClassName=a,this.errors=o,this.timelines=s,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=NL,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=u||new DL(this._driver,n,0),s.push(this.currentTimeline)}return rp(e,[{key:"params",get:function(){return this.options.params}},{key:"updateOptions",value:function(e,t){var n=this;if(e){var r=e,i=this.options;null!=r.duration&&(i.duration=YD(r.duration)),null!=r.delay&&(i.delay=YD(r.delay));var a=r.params;if(a){var o=i.params;o||(o=this.options.params={}),Object.keys(a).forEach(function(e){(!t||!o.hasOwnProperty(e))&&(o[e]=sL(a[e],o,n.errors))})}}}},{key:"_copyOptions",value:function(){var e={};if(this.options){var t=this.options.params;if(t){var n=e.params={};Object.keys(t).forEach(function(e){n[e]=t[e]})}}return e}},{key:"createSubContext",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0,i=n||this.element,a=new e(this._driver,i,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(i,r||0));return a.previousNode=this.previousNode,a.currentAnimateTimings=this.currentAnimateTimings,a.options=this._copyOptions(),a.updateOptions(t),a.currentQueryIndex=this.currentQueryIndex,a.currentQueryTotal=this.currentQueryTotal,a.parentContext=this,this.subContextCount++,a}},{key:"transformIntoNewTimeline",value:function(e){return this.previousNode=NL,this.currentTimeline=this.currentTimeline.fork(this.element,e),this.timelines.push(this.currentTimeline),this.currentTimeline}},{key:"appendInstructionToTimeline",value:function(e,t,n){var r={duration:null!=t?t:e.duration,delay:this.currentTimeline.currentTime+(null!=n?n:0)+e.delay,easing:""},i=new LL(this._driver,e.element,e.keyframes,e.preStyleProps,e.postStyleProps,r,e.stretchStartingKeyframe);return this.timelines.push(i),r}},{key:"incrementTime",value:function(e){this.currentTimeline.forwardTime(this.currentTimeline.duration+e)}},{key:"delayNextStep",value:function(e){e>0&&this.currentTimeline.delayNextStep(e)}},{key:"invokeQuery",value:function(e,t,n,r,i,a){var o=[];if(r&&o.push(this.element),e.length>0){e=(e=e.replace(IL,"."+this._enterClassName)).replace(xL,"."+this._leaveClassName);var s=this._driver.query(this.element,e,1!=n);0!==n&&(s=n<0?s.slice(s.length+n,s.length):s.slice(0,n)),o.push.apply(o,Kv(s))}return!i&&0==o.length&&a.push('`query("'.concat(t,'")` returned zero elements. (Use `query("').concat(t,'", { optional: true })` if you wish to allow this.)')),o}}]),e}(),DL=function(){function e(t,n,r,i){tp(this,e),this._driver=t,this.element=n,this.startTime=r,this._elementTimelineStylesLookup=i,this.duration=0,this._previousKeyframe={},this._currentKeyframe={},this._keyframes=new Map,this._styleSummary={},this._pendingStyles={},this._backFill={},this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._localTimelineStyles=Object.create(this._backFill,{}),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(n),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(n,this._localTimelineStyles)),this._loadKeyframe()}return rp(e,[{key:"containsAnimation",value:function(){switch(this._keyframes.size){case 0:return!1;case 1:return this.getCurrentStyleProperties().length>0;default:return!0}}},{key:"getCurrentStyleProperties",value:function(){return Object.keys(this._currentKeyframe)}},{key:"currentTime",get:function(){return this.startTime+this.duration}},{key:"delayNextStep",value:function(e){var t=1==this._keyframes.size&&Object.keys(this._pendingStyles).length;this.duration||t?(this.forwardTime(this.currentTime+e),t&&this.snapshotCurrentStyles()):this.startTime+=e}},{key:"fork",value:function(t,n){return this.applyStylesToKeyframe(),new e(this._driver,t,n||this.currentTime,this._elementTimelineStylesLookup)}},{key:"_loadKeyframe",value:function(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=Object.create(this._backFill,{}),this._keyframes.set(this.duration,this._currentKeyframe))}},{key:"forwardFrame",value:function(){this.duration+=1,this._loadKeyframe()}},{key:"forwardTime",value:function(e){this.applyStylesToKeyframe(),this.duration=e,this._loadKeyframe()}},{key:"_updateStyle",value:function(e,t){this._localTimelineStyles[e]=t,this._globalTimelineStyles[e]=t,this._styleSummary[e]={time:this.currentTime,value:t}}},{key:"allowOnlyTimelineStyles",value:function(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}},{key:"applyEmptyStep",value:function(e){var t=this;e&&(this._previousKeyframe.easing=e),Object.keys(this._globalTimelineStyles).forEach(function(e){t._backFill[e]=t._globalTimelineStyles[e]||pD,t._currentKeyframe[e]=pD}),this._currentEmptyStepKeyframe=this._currentKeyframe}},{key:"setStyles",value:function(e,t,n,r){var i=this;t&&(this._previousKeyframe.easing=t);var a=r&&r.params||{},o=function(e,t){var n,r={};return e.forEach(function(e){"*"===e?(n=n||Object.keys(t)).forEach(function(e){r[e]=pD}):XD(e,!1,r)}),r}(e,this._globalTimelineStyles);Object.keys(o).forEach(function(e){var t=sL(o[e],a,n);i._pendingStyles[e]=t,i._localTimelineStyles.hasOwnProperty(e)||(i._backFill[e]=i._globalTimelineStyles.hasOwnProperty(e)?i._globalTimelineStyles[e]:pD),i._updateStyle(e,t)})}},{key:"applyStylesToKeyframe",value:function(){var e=this,t=this._pendingStyles,n=Object.keys(t);0!=n.length&&(this._pendingStyles={},n.forEach(function(n){e._currentKeyframe[n]=t[n]}),Object.keys(this._localTimelineStyles).forEach(function(t){e._currentKeyframe.hasOwnProperty(t)||(e._currentKeyframe[t]=e._localTimelineStyles[t])}))}},{key:"snapshotCurrentStyles",value:function(){var e=this;Object.keys(this._localTimelineStyles).forEach(function(t){var n=e._localTimelineStyles[t];e._pendingStyles[t]=n,e._updateStyle(t,n)})}},{key:"getFinalKeyframe",value:function(){return this._keyframes.get(this.duration)}},{key:"properties",get:function(){var e=[];for(var t in this._currentKeyframe)e.push(t);return e}},{key:"mergeTimelineCollectedStyles",value:function(e){var t=this;Object.keys(e._styleSummary).forEach(function(n){var r=t._styleSummary[n],i=e._styleSummary[n];(!r||i.time>r.time)&&t._updateStyle(n,i.value)})}},{key:"buildKeyframes",value:function(){var e=this;this.applyStylesToKeyframe();var t=new Set,n=new Set,r=1===this._keyframes.size&&0===this.duration,i=[];this._keyframes.forEach(function(a,o){var s=XD(a,!0);Object.keys(s).forEach(function(e){var r=s[e];"!"==r?t.add(e):r==pD&&n.add(e)}),r||(s.offset=o/e.duration),i.push(s)});var a=t.size?uL(t.values()):[],o=n.size?uL(n.values()):[];if(r){var s=i[0],u=QD(s);s.offset=0,u.offset=1,i=[s,u]}return OL(this.element,i,a,o,this.duration,this.startTime,this.easing,!1)}}]),e}(),LL=function(e){Gv(n,e);var t=$v(n);function n(e,r,i,a,o,s){var u,c=arguments.length>6&&void 0!==arguments[6]&&arguments[6];return tp(this,n),(u=t.call(this,e,r,s.delay)).keyframes=i,u.preStyleProps=a,u.postStyleProps=o,u._stretchStartingKeyframe=c,u.timings={duration:s.duration,delay:s.delay,easing:s.easing},u}return rp(n,[{key:"containsAnimation",value:function(){return this.keyframes.length>1}},{key:"buildKeyframes",value:function(){var e=this.keyframes,t=this.timings,n=t.delay,r=t.duration,i=t.easing;if(this._stretchStartingKeyframe&&n){var a=[],o=r+n,s=n/o,u=XD(e[0],!1);u.offset=0,a.push(u);var c=XD(e[0],!1);c.offset=FL(s),a.push(c);for(var l=e.length-1,h=1;h<=l;h++){var f=XD(e[h],!1);f.offset=FL((n+f.offset*r)/o),a.push(f)}r=o,n=0,i="",e=a}return OL(this.element,e,this.preStyleProps,this.postStyleProps,r,n,i,!0)}}]),n}(DL);function FL(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,n=Math.pow(10,t-1);return Math.round(e*n)/n}var BL=rp(function e(){tp(this,e)}),VL=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"normalizePropertyName",value:function(e,t){return lL(e)}},{key:"normalizeStyleValue",value:function(e,t,n,r){var i="",a=n.toString().trim();if(UL[t]&&0!==n&&"0"!==n)if("number"==typeof n)i="px";else{var o=n.match(/^[+-]?[\d\.]+([a-z]*)$/);o&&0==o[1].length&&r.push("Please provide a CSS unit value for ".concat(e,":").concat(n))}return a+i}}]),n}(BL),UL=function(e){var t={};return e.forEach(function(e){return t[e]=!0}),t}("width,height,minWidth,minHeight,maxWidth,maxHeight,left,top,bottom,right,fontSize,outlineWidth,outlineOffset,paddingTop,paddingLeft,paddingBottom,paddingRight,marginTop,marginLeft,marginBottom,marginRight,borderRadius,borderWidth,borderTopWidth,borderLeftWidth,borderRightWidth,borderBottomWidth,textIndent,perspective".split(","));function zL(e,t,n,r,i,a,o,s,u,c,l,h,f){return{type:0,element:e,triggerName:t,isRemovalTransition:i,fromState:n,fromStyles:a,toState:r,toStyles:o,timelines:s,queriedElements:u,preStyleProps:c,postStyleProps:l,totalTime:h,errors:f}}var HL={},GL=function(){function e(t,n,r){tp(this,e),this._triggerName=t,this.ast=n,this._stateStyles=r}return rp(e,[{key:"match",value:function(e,t,n,r){return function(e,t,n,r,i){return e.some(function(e){return e(t,n,r,i)})}(this.ast.matchers,e,t,n,r)}},{key:"buildStyles",value:function(e,t,n){var r=this._stateStyles["*"],i=this._stateStyles[e],a=r?r.buildStyles(t,n):{};return i?i.buildStyles(t,n):a}},{key:"build",value:function(e,t,n,r,i,a,o,s,u,c){var l=[],h=this.ast.options&&this.ast.options.params||HL,f=this.buildStyles(n,o&&o.params||HL,l),d=s&&s.params||HL,v=this.buildStyles(r,d,l),p=new Set,g=new Map,y=new Map,m="void"===r,k={params:Object.assign(Object.assign({},h),d)},_=c?[]:AL(e,t,this.ast.animation,i,a,f,v,k,u,l),w=0;if(_.forEach(function(e){w=Math.max(e.duration+e.delay,w)}),l.length)return zL(t,this._triggerName,n,r,m,f,v,[],[],g,y,w,l);_.forEach(function(e){var n=e.element,r=TD(g,n,{});e.preStyleProps.forEach(function(e){return r[e]=!0});var i=TD(y,n,{});e.postStyleProps.forEach(function(e){return i[e]=!0}),n!==t&&p.add(n)});var C=uL(p.values());return zL(t,this._triggerName,n,r,m,f,v,_,C,g,y,w)}}]),e}(),qL=function(){function e(t,n,r){tp(this,e),this.styles=t,this.defaultParams=n,this.normalizer=r}return rp(e,[{key:"buildStyles",value:function(e,t){var n=this,r={},i=QD(this.defaultParams);return Object.keys(e).forEach(function(t){var n=e[t];null!=n&&(i[t]=n)}),this.styles.styles.forEach(function(e){if("string"!=typeof e){var a=e;Object.keys(a).forEach(function(e){var o=a[e];o.length>1&&(o=sL(o,i,t));var s=n.normalizer.normalizePropertyName(e,t);o=n.normalizer.normalizeStyleValue(e,s,o,t),r[s]=o})}}),r}}]),e}(),$L=function(){function e(t,n,r){var i=this;tp(this,e),this.name=t,this.ast=n,this._normalizer=r,this.transitionFactories=[],this.states={},n.states.forEach(function(e){i.states[e.name]=new qL(e.style,e.options&&e.options.params||{},r)}),WL(this.states,"true","1"),WL(this.states,"false","0"),n.transitions.forEach(function(e){i.transitionFactories.push(new GL(t,e,i.states))}),this.fallbackTransition=function(e,t,n){return new GL(e,{type:1,animation:{type:2,steps:[],options:null},matchers:[function(e,t){return!0}],options:null,queryCount:0,depCount:0},t)}(t,this.states)}return rp(e,[{key:"containsQueries",get:function(){return this.ast.queryCount>0}},{key:"matchTransition",value:function(e,t,n,r){return this.transitionFactories.find(function(i){return i.match(e,t,n,r)})||null}},{key:"matchStyles",value:function(e,t,n){return this.fallbackTransition.buildStyles(e,t,n)}}]),e}();function WL(e,t,n){e.hasOwnProperty(t)?e.hasOwnProperty(n)||(e[n]=e[t]):e.hasOwnProperty(n)&&(e[t]=e[n])}var jL=new TL,ZL=function(){function e(t,n,r){tp(this,e),this.bodyNode=t,this._driver=n,this._normalizer=r,this._animations={},this._playersById={},this.players=[]}return rp(e,[{key:"register",value:function(e,t){var n=[],r=wL(this._driver,t,n);if(n.length)throw new Error("Unable to build the animation due to the following errors: ".concat(n.join("\n")));this._animations[e]=r}},{key:"_buildPlayer",value:function(e,t,n){var r=e.element,i=ED(0,this._normalizer,0,e.keyframes,t,n);return this._driver.animate(r,i,e.duration,e.delay,e.easing,[],!0)}},{key:"create",value:function(e,t){var n,r=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=[],o=this._animations[e],s=new Map;if(o?(n=AL(this._driver,t,o,GD,qD,{},{},i,jL,a)).forEach(function(e){var t=TD(s,e.element,{});e.postStyleProps.forEach(function(e){return t[e]=null})}):(a.push("The requested animation doesn't exist or has already been destroyed"),n=[]),a.length)throw new Error("Unable to create the animation due to the following errors: ".concat(a.join("\n")));s.forEach(function(e,t){Object.keys(e).forEach(function(n){e[n]=r._driver.computeStyle(t,n,pD)})});var u=bD(n.map(function(e){var t=s.get(e.element);return r._buildPlayer(e,{},t)}));return this._playersById[e]=u,u.onDestroy(function(){return r.destroy(e)}),this.players.push(u),u}},{key:"destroy",value:function(e){var t=this._getPlayer(e);t.destroy(),delete this._playersById[e];var n=this.players.indexOf(t);n>=0&&this.players.splice(n,1)}},{key:"_getPlayer",value:function(e){var t=this._playersById[e];if(!t)throw new Error("Unable to find the timeline player referenced by ".concat(e));return t}},{key:"listen",value:function(e,t,n,r){var i=OD(t,"","","");return SD(this._getPlayer(e),n,i,r),function(){}}},{key:"command",value:function(e,t,n,r){if("register"!=n)if("create"!=n){var i=this._getPlayer(e);switch(n){case"play":i.play();break;case"pause":i.pause();break;case"reset":i.reset();break;case"restart":i.restart();break;case"finish":i.finish();break;case"init":i.init();break;case"setPosition":i.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(e)}}else this.create(e,t,r[0]||{});else this.register(e,r[0])}}]),e}(),YL="ng-animate-queued",KL="ng-animate-disabled",JL=".ng-animate-disabled",QL=[],XL={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},eF={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},tF="__ng_removed",nF=function(){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";tp(this,e),this.namespaceId=r;var i=t&&t.hasOwnProperty("value");if(this.value=null!==(n=i?t.value:t)&&void 0!==n?n:null,i){var a=QD(t);delete a.value,this.options=a}else this.options={};this.options.params||(this.options.params={})}return rp(e,[{key:"params",get:function(){return this.options.params}},{key:"absorbOptions",value:function(e){var t=e.params;if(t){var n=this.options.params;Object.keys(t).forEach(function(e){null==n[e]&&(n[e]=t[e])})}}}]),e}(),rF="void",iF=new nF(rF),aF=function(){function e(t,n,r){tp(this,e),this.id=t,this.hostElement=n,this._engine=r,this.players=[],this._triggers={},this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+t,dF(n,this._hostClassName)}return rp(e,[{key:"listen",value:function(e,t,n,r){var i,a=this;if(!this._triggers.hasOwnProperty(t))throw new Error('Unable to listen on the animation trigger event "'.concat(n,'" because the animation trigger "').concat(t,"\" doesn't exist!"));if(null==n||0==n.length)throw new Error('Unable to listen on the animation trigger "'.concat(t,'" because the provided event is undefined!'));if("start"!=(i=n)&&"done"!=i)throw new Error('The provided animation trigger event "'.concat(n,'" for the animation trigger "').concat(t,'" is not supported!'));var o=TD(this._elementListeners,e,[]),s={name:t,phase:n,callback:r};o.push(s);var u=TD(this._engine.statesByElement,e,{});return u.hasOwnProperty(t)||(dF(e,$D),dF(e,$D+"-"+t),u[t]=iF),function(){a._engine.afterFlush(function(){var e=o.indexOf(s);e>=0&&o.splice(e,1),a._triggers[t]||delete u[t]})}}},{key:"register",value:function(e,t){return!this._triggers[e]&&(this._triggers[e]=t,!0)}},{key:"_getTrigger",value:function(e){var t=this._triggers[e];if(!t)throw new Error('The provided animation trigger "'.concat(e,'" has not been registered!'));return t}},{key:"trigger",value:function(e,t,n){var r=this,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=this._getTrigger(t),o=new sF(this.id,t,e),s=this._engine.statesByElement.get(e);s||(dF(e,$D),dF(e,$D+"-"+t),this._engine.statesByElement.set(e,s={}));var u=s[t],c=new nF(n,this.id);if(!(n&&n.hasOwnProperty("value"))&&u&&c.absorbOptions(u.options),s[t]=c,u||(u=iF),c.value===rF||u.value!==c.value){var l=TD(this._engine.playersByElement,e,[]);l.forEach(function(e){e.namespaceId==r.id&&e.triggerName==t&&e.queued&&e.destroy()});var h=a.matchTransition(u.value,c.value,e,c.params),f=!1;if(!h){if(!i)return;h=a.fallbackTransition,f=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:t,transition:h,fromState:u,toState:c,player:o,isFallbackTransition:f}),f||(dF(e,YL),o.onStart(function(){vF(e,YL)})),o.onDone(function(){var t=r.players.indexOf(o);t>=0&&r.players.splice(t,1);var n=r._engine.playersByElement.get(e);if(n){var i=n.indexOf(o);i>=0&&n.splice(i,1)}}),this.players.push(o),l.push(o),o}if(!function(e,t){var n=Object.keys(e),r=Object.keys(t);if(n.length!=r.length)return!1;for(var i=0;i<n.length;i++){var a=n[i];if(!t.hasOwnProperty(a)||e[a]!==t[a])return!1}return!0}(u.params,c.params)){var d=[],v=a.matchStyles(u.value,u.params,d),p=a.matchStyles(c.value,c.params,d);d.length?this._engine.reportError(d):this._engine.afterFlush(function(){rL(e,v),nL(e,p)})}}},{key:"deregister",value:function(e){var t=this;delete this._triggers[e],this._engine.statesByElement.forEach(function(t,n){delete t[e]}),this._elementListeners.forEach(function(n,r){t._elementListeners.set(r,n.filter(function(t){return t.name!=e}))})}},{key:"clearElementCache",value:function(e){this._engine.statesByElement.delete(e),this._elementListeners.delete(e);var t=this._engine.playersByElement.get(e);t&&(t.forEach(function(e){return e.destroy()}),this._engine.playersByElement.delete(e))}},{key:"_signalRemovalForInnerTriggers",value:function(e,t){var n=this,r=this._engine.driver.query(e,WD,!0);r.forEach(function(e){if(!e[tF]){var r=n._engine.fetchNamespacesByElement(e);r.size?r.forEach(function(n){return n.triggerLeaveAnimation(e,t,!1,!0)}):n.clearElementCache(e)}}),this._engine.afterFlushAnimationsDone(function(){return r.forEach(function(e){return n.clearElementCache(e)})})}},{key:"triggerLeaveAnimation",value:function(e,t,n,r){var i=this,a=this._engine.statesByElement.get(e);if(a){var o=[];if(Object.keys(a).forEach(function(t){if(i._triggers[t]){var n=i.trigger(e,t,rF,r);n&&o.push(n)}}),o.length)return this._engine.markElementAsRemoved(this.id,e,!0,t),n&&bD(o).onDone(function(){return i._engine.processLeaveNode(e)}),!0}return!1}},{key:"prepareLeaveAnimationListeners",value:function(e){var t=this,n=this._elementListeners.get(e),r=this._engine.statesByElement.get(e);if(n&&r){var i=new Set;n.forEach(function(n){var a=n.name;if(!i.has(a)){i.add(a);var o=t._triggers[a].fallbackTransition,s=r[a]||iF,u=new nF(rF),c=new sF(t.id,a,e);t._engine.totalQueuedPlayers++,t._queue.push({element:e,triggerName:a,transition:o,fromState:s,toState:u,player:c,isFallbackTransition:!0})}})}}},{key:"removeNode",value:function(e,t){var n=this,r=this._engine;if(e.childElementCount&&this._signalRemovalForInnerTriggers(e,t),!this.triggerLeaveAnimation(e,t,!0)){var i=!1;if(r.totalAnimations){var a=r.players.length?r.playersByQueriedElement.get(e):[];if(a&&a.length)i=!0;else for(var o=e;o=o.parentNode;)if(r.statesByElement.get(o)){i=!0;break}}if(this.prepareLeaveAnimationListeners(e),i)r.markElementAsRemoved(this.id,e,!1,t);else{var s=e[tF];(!s||s===XL)&&(r.afterFlush(function(){return n.clearElementCache(e)}),r.destroyInnerAnimations(e),r._onRemovalComplete(e,t))}}}},{key:"insertNode",value:function(e,t){dF(e,this._hostClassName)}},{key:"drainQueuedTransitions",value:function(e){var t=this,n=[];return this._queue.forEach(function(r){var i=r.player;if(!i.destroyed){var a=r.element,o=t._elementListeners.get(a);o&&o.forEach(function(t){if(t.name==r.triggerName){var n=OD(a,r.triggerName,r.fromState.value,r.toState.value);n._data=e,SD(r.player,t.phase,n,t.callback)}}),i.markedForDestroy?t._engine.afterFlush(function(){i.destroy()}):n.push(r)}}),this._queue=[],n.sort(function(e,n){var r=e.transition.ast.depCount,i=n.transition.ast.depCount;return 0==r||0==i?r-i:t._engine.driver.containsElement(e.element,n.element)?1:-1})}},{key:"destroy",value:function(e){this.players.forEach(function(e){return e.destroy()}),this._signalRemovalForInnerTriggers(this.hostElement,e)}},{key:"elementContainsData",value:function(e){var t=!1;return this._elementListeners.has(e)&&(t=!0),t=!!this._queue.find(function(t){return t.element===e})||t}}]),e}(),oF=function(){function e(t,n,r){tp(this,e),this.bodyNode=t,this.driver=n,this._normalizer=r,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=function(e,t){}}return rp(e,[{key:"_onRemovalComplete",value:function(e,t){this.onRemovalComplete(e,t)}},{key:"queuedPlayers",get:function(){var e=[];return this._namespaceList.forEach(function(t){t.players.forEach(function(t){t.queued&&e.push(t)})}),e}},{key:"createNamespace",value:function(e,t){var n=new aF(e,t,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,t)?this._balanceNamespaceList(n,t):(this.newHostElements.set(t,n),this.collectEnterElement(t)),this._namespaceLookup[e]=n}},{key:"_balanceNamespaceList",value:function(e,t){var n=this._namespaceList.length-1;if(n>=0){for(var r=!1,i=n;i>=0;i--)if(this.driver.containsElement(this._namespaceList[i].hostElement,t)){this._namespaceList.splice(i+1,0,e),r=!0;break}r||this._namespaceList.splice(0,0,e)}else this._namespaceList.push(e);return this.namespacesByHostElement.set(t,e),e}},{key:"register",value:function(e,t){var n=this._namespaceLookup[e];return n||(n=this.createNamespace(e,t)),n}},{key:"registerTrigger",value:function(e,t,n){var r=this._namespaceLookup[e];r&&r.register(t,n)&&this.totalAnimations++}},{key:"destroy",value:function(e,t){var n=this;if(e){var r=this._fetchNamespace(e);this.afterFlush(function(){n.namespacesByHostElement.delete(r.hostElement),delete n._namespaceLookup[e];var t=n._namespaceList.indexOf(r);t>=0&&n._namespaceList.splice(t,1)}),this.afterFlushAnimationsDone(function(){return r.destroy(t)})}}},{key:"_fetchNamespace",value:function(e){return this._namespaceLookup[e]}},{key:"fetchNamespacesByElement",value:function(e){var t=new Set,n=this.statesByElement.get(e);if(n)for(var r=Object.keys(n),i=0;i<r.length;i++){var a=n[r[i]].namespaceId;if(a){var o=this._fetchNamespace(a);o&&t.add(o)}}return t}},{key:"trigger",value:function(e,t,n,r){if(uF(t)){var i=this._fetchNamespace(e);if(i)return i.trigger(t,n,r),!0}return!1}},{key:"insertNode",value:function(e,t,n,r){if(uF(t)){var i=t[tF];if(i&&i.setForRemoval){i.setForRemoval=!1,i.setForMove=!0;var a=this.collectedLeaveElements.indexOf(t);a>=0&&this.collectedLeaveElements.splice(a,1)}if(e){var o=this._fetchNamespace(e);o&&o.insertNode(t,n)}r&&this.collectEnterElement(t)}}},{key:"collectEnterElement",value:function(e){this.collectedEnterElements.push(e)}},{key:"markElementAsDisabled",value:function(e,t){t?this.disabledNodes.has(e)||(this.disabledNodes.add(e),dF(e,KL)):this.disabledNodes.has(e)&&(this.disabledNodes.delete(e),vF(e,KL))}},{key:"removeNode",value:function(e,t,n,r){if(uF(t)){var i=e?this._fetchNamespace(e):null;if(i?i.removeNode(t,r):this.markElementAsRemoved(e,t,!1,r),n){var a=this.namespacesByHostElement.get(t);a&&a.id!==e&&a.removeNode(t,r)}}else this._onRemovalComplete(t,r)}},{key:"markElementAsRemoved",value:function(e,t,n,r){this.collectedLeaveElements.push(t),t[tF]={namespaceId:e,setForRemoval:r,hasAnimation:n,removedBeforeQueried:!1}}},{key:"listen",value:function(e,t,n,r,i){return uF(t)?this._fetchNamespace(e).listen(t,n,r,i):function(){}}},{key:"_buildInstruction",value:function(e,t,n,r,i){return e.transition.build(this.driver,e.element,e.fromState.value,e.toState.value,n,r,e.fromState.options,e.toState.options,t,i)}},{key:"destroyInnerAnimations",value:function(e){var t=this,n=this.driver.query(e,WD,!0);n.forEach(function(e){return t.destroyActiveAnimationsForElement(e)}),0!=this.playersByQueriedElement.size&&(n=this.driver.query(e,ZD,!0)).forEach(function(e){return t.finishActiveQueriedAnimationOnElement(e)})}},{key:"destroyActiveAnimationsForElement",value:function(e){var t=this.playersByElement.get(e);t&&t.forEach(function(e){e.queued?e.markedForDestroy=!0:e.destroy()})}},{key:"finishActiveQueriedAnimationOnElement",value:function(e){var t=this.playersByQueriedElement.get(e);t&&t.forEach(function(e){return e.finish()})}},{key:"whenRenderingDone",value:function(){var e=this;return new Promise(function(t){if(e.players.length)return bD(e.players).onDone(function(){return t()});t()})}},{key:"processLeaveNode",value:function(e){var t=this,n=e[tF];if(n&&n.setForRemoval){if(e[tF]=XL,n.namespaceId){this.destroyInnerAnimations(e);var r=this._fetchNamespace(n.namespaceId);r&&r.clearElementCache(e)}this._onRemovalComplete(e,n.setForRemoval)}this.driver.matchesElement(e,JL)&&this.markElementAsDisabled(e,!1),this.driver.query(e,JL,!0).forEach(function(e){t.markElementAsDisabled(e,!1)})}},{key:"flush",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,n=[];if(this.newHostElements.size&&(this.newHostElements.forEach(function(t,n){return e._balanceNamespaceList(t,n)}),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(var r=0;r<this.collectedEnterElements.length;r++)dF(this.collectedEnterElements[r],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){var i=[];try{n=this._flushAnimations(i,t)}finally{for(var a=0;a<i.length;a++)i[a]()}}else for(var o=0;o<this.collectedLeaveElements.length;o++)this.processLeaveNode(this.collectedLeaveElements[o]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(function(e){return e()}),this._flushFns=[],this._whenQuietFns.length){var s=this._whenQuietFns;this._whenQuietFns=[],n.length?bD(n).onDone(function(){s.forEach(function(e){return e()})}):s.forEach(function(e){return e()})}}},{key:"reportError",value:function(e){throw new Error("Unable to process animations due to the following failed trigger transitions\n ".concat(e.join("\n")))}},{key:"_flushAnimations",value:function(e,t){var n=this,r=new TL,i=[],a=new Map,o=[],s=new Map,u=new Map,c=new Map,l=new Set;this.disabledNodes.forEach(function(e){l.add(e);for(var t=n.driver.query(e,".ng-animate-queued",!0),r=0;r<t.length;r++)l.add(t[r])});var h=this.bodyNode,f=Array.from(this.statesByElement.keys()),d=hF(f,this.collectedEnterElements),v=new Map,p=0;d.forEach(function(e,t){var n=GD+p++;v.set(t,n),e.forEach(function(e){return dF(e,n)})});for(var g=[],y=new Set,m=new Set,k=0;k<this.collectedLeaveElements.length;k++){var _=this.collectedLeaveElements[k],w=_[tF];w&&w.setForRemoval&&(g.push(_),y.add(_),w.hasAnimation?this.driver.query(_,".ng-star-inserted",!0).forEach(function(e){return y.add(e)}):m.add(_))}var C=new Map,b=hF(f,Array.from(y));b.forEach(function(e,t){var n=qD+p++;C.set(t,n),e.forEach(function(e){return dF(e,n)})}),e.push(function(){d.forEach(function(e,t){var n=v.get(t);e.forEach(function(e){return vF(e,n)})}),b.forEach(function(e,t){var n=C.get(t);e.forEach(function(e){return vF(e,n)})}),g.forEach(function(e){n.processLeaveNode(e)})});for(var E=[],S=[],P=this._namespaceList.length-1;P>=0;P--)this._namespaceList[P].drainQueuedTransitions(t).forEach(function(e){var t=e.player,a=e.element;if(E.push(t),n.collectedEnterElements.length){var l=a[tF];if(l&&l.setForMove)return void t.destroy()}var f=!h||!n.driver.containsElement(h,a),d=C.get(a),p=v.get(a),g=n._buildInstruction(e,r,p,d,f);if(g.errors&&g.errors.length)S.push(g);else{if(f)return t.onStart(function(){return rL(a,g.fromStyles)}),t.onDestroy(function(){return nL(a,g.toStyles)}),void i.push(t);if(e.isFallbackTransition)return t.onStart(function(){return rL(a,g.fromStyles)}),t.onDestroy(function(){return nL(a,g.toStyles)}),void i.push(t);g.timelines.forEach(function(e){return e.stretchStartingKeyframe=!0}),r.append(a,g.timelines),o.push({instruction:g,player:t,element:a}),g.queriedElements.forEach(function(e){return TD(s,e,[]).push(t)}),g.preStyleProps.forEach(function(e,t){var n=Object.keys(e);if(n.length){var r=u.get(t);r||u.set(t,r=new Set),n.forEach(function(e){return r.add(e)})}}),g.postStyleProps.forEach(function(e,t){var n=Object.keys(e),r=c.get(t);r||c.set(t,r=new Set),n.forEach(function(e){return r.add(e)})})}});if(S.length){var O=[];S.forEach(function(e){O.push("@".concat(e.triggerName," has failed due to:\n")),e.errors.forEach(function(e){return O.push("- ".concat(e,"\n"))})}),E.forEach(function(e){return e.destroy()}),this.reportError(O)}var T=new Map,I=new Map;o.forEach(function(e){var t=e.element;r.has(t)&&(I.set(t,t),n._beforeAnimationBuild(e.player.namespaceId,e.instruction,T))}),i.forEach(function(e){var t=e.element;n._getPreviousPlayers(t,!1,e.namespaceId,e.triggerName,null).forEach(function(e){TD(T,t,[]).push(e),e.destroy()})});var x=g.filter(function(e){return yF(e,u,c)}),A=new Map;lF(A,this.driver,m,c,pD).forEach(function(e){yF(e,u,c)&&x.push(e)});var R=new Map;d.forEach(function(e,t){lF(R,n.driver,new Set(e),u,"!")}),x.forEach(function(e){var t=A.get(e),n=R.get(e);A.set(e,Object.assign(Object.assign({},t),n))});var N=[],M=[],D={};o.forEach(function(e){var t=e.element,o=e.player,s=e.instruction;if(r.has(t)){if(l.has(t))return o.onDestroy(function(){return nL(t,s.toStyles)}),o.disabled=!0,o.overrideTotalTime(s.totalTime),void i.push(o);var u=D;if(I.size>1){for(var c=t,h=[];c=c.parentNode;){var f=I.get(c);if(f){u=f;break}h.push(c)}h.forEach(function(e){return I.set(e,u)})}var d=n._buildAnimation(o.namespaceId,s,T,a,R,A);if(o.setRealPlayer(d),u===D)N.push(o);else{var v=n.playersByElement.get(u);v&&v.length&&(o.parentPlayer=bD(v)),i.push(o)}}else rL(t,s.fromStyles),o.onDestroy(function(){return nL(t,s.toStyles)}),M.push(o),l.has(t)&&i.push(o)}),M.forEach(function(e){var t=a.get(e.element);if(t&&t.length){var n=bD(t);e.setRealPlayer(n)}}),i.forEach(function(e){e.parentPlayer?e.syncPlayerEvents(e.parentPlayer):e.destroy()});for(var L=0;L<g.length;L++){var F=g[L],B=F[tF];if(vF(F,qD),!B||!B.hasAnimation){var V=[];if(s.size){var U=s.get(F);U&&U.length&&V.push.apply(V,Kv(U));for(var z=this.driver.query(F,ZD,!0),H=0;H<z.length;H++){var G=s.get(z[H]);G&&G.length&&V.push.apply(V,Kv(G))}}var q=V.filter(function(e){return!e.destroyed});q.length?pF(this,F,q):this.processLeaveNode(F)}}return g.length=0,N.forEach(function(e){n.players.push(e),e.onDone(function(){e.destroy();var t=n.players.indexOf(e);n.players.splice(t,1)}),e.play()}),N}},{key:"elementContainsData",value:function(e,t){var n=!1,r=t[tF];return r&&r.setForRemoval&&(n=!0),this.playersByElement.has(t)&&(n=!0),this.playersByQueriedElement.has(t)&&(n=!0),this.statesByElement.has(t)&&(n=!0),this._fetchNamespace(e).elementContainsData(t)||n}},{key:"afterFlush",value:function(e){this._flushFns.push(e)}},{key:"afterFlushAnimationsDone",value:function(e){this._whenQuietFns.push(e)}},{key:"_getPreviousPlayers",value:function(e,t,n,r,i){var a=[];if(t){var o=this.playersByQueriedElement.get(e);o&&(a=o)}else{var s=this.playersByElement.get(e);if(s){var u=!i||i==rF;s.forEach(function(e){e.queued||!u&&e.triggerName!=r||a.push(e)})}}return(n||r)&&(a=a.filter(function(e){return!(n&&n!=e.namespaceId||r&&r!=e.triggerName)})),a}},{key:"_beforeAnimationBuild",value:function(e,t,n){var r,i=this,a=t.element,o=t.isRemovalTransition?void 0:e,s=t.isRemovalTransition?void 0:t.triggerName,u=Qv(t.timelines);try{var c=function(){var e=r.value.element,u=e!==a,c=TD(n,e,[]);i._getPreviousPlayers(e,u,o,s,t.toState).forEach(function(e){var t=e.getRealPlayer();t.beforeDestroy&&t.beforeDestroy(),e.destroy(),c.push(e)})};for(u.s();!(r=u.n()).done;)c()}catch(l){u.e(l)}finally{u.f()}rL(a,t.fromStyles)}},{key:"_buildAnimation",value:function(e,t,n,r,i,a){var o=this,s=t.triggerName,u=t.element,c=[],l=new Set,h=new Set,f=t.timelines.map(function(t){var f=t.element;l.add(f);var d=f[tF];if(d&&d.removedBeforeQueried)return new kD(t.duration,t.delay);var v=f!==u,p=function(e){var t=[];return gF(e,t),t}((n.get(f)||QL).map(function(e){return e.getRealPlayer()})).filter(function(e){return!!e.element&&e.element===f}),g=i.get(f),y=a.get(f),m=ED(0,o._normalizer,0,t.keyframes,g,y),k=o._buildPlayer(t,m,p);if(t.subTimeline&&r&&h.add(f),v){var _=new sF(e,s,f);_.setRealPlayer(k),c.push(_)}return k});c.forEach(function(e){TD(o.playersByQueriedElement,e.element,[]).push(e),e.onDone(function(){return function(e,t,n){var r;if(e instanceof Map){if(r=e.get(t)){if(r.length){var i=r.indexOf(n);r.splice(i,1)}0==r.length&&e.delete(t)}}else if(r=e[t]){if(r.length){var a=r.indexOf(n);r.splice(a,1)}0==r.length&&delete e[t]}return r}(o.playersByQueriedElement,e.element,e)})}),l.forEach(function(e){return dF(e,jD)});var d=bD(f);return d.onDestroy(function(){l.forEach(function(e){return vF(e,jD)}),nL(u,t.toStyles)}),h.forEach(function(e){TD(r,e,[]).push(d)}),d}},{key:"_buildPlayer",value:function(e,t,n){return t.length>0?this.driver.animate(e.element,t,e.duration,e.delay,e.easing,n):new kD(e.duration,e.delay)}}]),e}(),sF=function(){function e(t,n,r){tp(this,e),this.namespaceId=t,this.triggerName=n,this.element=r,this._player=new kD,this._containsRealPlayer=!1,this._queuedCallbacks={},this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}return rp(e,[{key:"setRealPlayer",value:function(e){var t=this;this._containsRealPlayer||(this._player=e,Object.keys(this._queuedCallbacks).forEach(function(n){t._queuedCallbacks[n].forEach(function(t){return SD(e,n,void 0,t)})}),this._queuedCallbacks={},this._containsRealPlayer=!0,this.overrideTotalTime(e.totalTime),this.queued=!1)}},{key:"getRealPlayer",value:function(){return this._player}},{key:"overrideTotalTime",value:function(e){this.totalTime=e}},{key:"syncPlayerEvents",value:function(e){var t=this,n=this._player;n.triggerCallback&&e.onStart(function(){return n.triggerCallback("start")}),e.onDone(function(){return t.finish()}),e.onDestroy(function(){return t.destroy()})}},{key:"_queueEvent",value:function(e,t){TD(this._queuedCallbacks,e,[]).push(t)}},{key:"onDone",value:function(e){this.queued&&this._queueEvent("done",e),this._player.onDone(e)}},{key:"onStart",value:function(e){this.queued&&this._queueEvent("start",e),this._player.onStart(e)}},{key:"onDestroy",value:function(e){this.queued&&this._queueEvent("destroy",e),this._player.onDestroy(e)}},{key:"init",value:function(){this._player.init()}},{key:"hasStarted",value:function(){return!this.queued&&this._player.hasStarted()}},{key:"play",value:function(){!this.queued&&this._player.play()}},{key:"pause",value:function(){!this.queued&&this._player.pause()}},{key:"restart",value:function(){!this.queued&&this._player.restart()}},{key:"finish",value:function(){this._player.finish()}},{key:"destroy",value:function(){this.destroyed=!0,this._player.destroy()}},{key:"reset",value:function(){!this.queued&&this._player.reset()}},{key:"setPosition",value:function(e){this.queued||this._player.setPosition(e)}},{key:"getPosition",value:function(){return this.queued?0:this._player.getPosition()}},{key:"triggerCallback",value:function(e){var t=this._player;t.triggerCallback&&t.triggerCallback(e)}}]),e}();function uF(e){return e&&1===e.nodeType}function cF(e,t){var n=e.style.display;return e.style.display=null!=t?t:"none",n}function lF(e,t,n,r,i){var a=[];n.forEach(function(e){return a.push(cF(e))});var o=[];r.forEach(function(n,r){var a={};n.forEach(function(e){var n=a[e]=t.computeStyle(r,e,i);(!n||0==n.length)&&(r[tF]=eF,o.push(r))}),e.set(r,a)});var s=0;return n.forEach(function(e){return cF(e,a[s++])}),o}function hF(e,t){var n=new Map;if(e.forEach(function(e){return n.set(e,[])}),0==t.length)return n;var r=new Set(t),i=new Map;function a(e){if(!e)return 1;var t=i.get(e);if(t)return t;var o=e.parentNode;return t=n.has(o)?o:r.has(o)?1:a(o),i.set(e,t),t}return t.forEach(function(e){var t=a(e);1!==t&&n.get(t).push(e)}),n}var fF="$$classes";function dF(e,t){if(e.classList)e.classList.add(t);else{var n=e[fF];n||(n=e[fF]={}),n[t]=!0}}function vF(e,t){if(e.classList)e.classList.remove(t);else{var n=e[fF];n&&delete n[t]}}function pF(e,t,n){bD(n).onDone(function(){return e.processLeaveNode(t)})}function gF(e,t){for(var n=0;n<e.length;n++){var r=e[n];r instanceof _D?gF(r.players,t):t.push(r)}}function yF(e,t,n){var r=n.get(e);if(!r)return!1;var i=t.get(e);return i?r.forEach(function(e){return i.add(e)}):t.set(e,r),n.delete(e),!0}var mF=function(){function e(t,n,r){var i=this;tp(this,e),this.bodyNode=t,this._driver=n,this._normalizer=r,this._triggerCache={},this.onRemovalComplete=function(e,t){},this._transitionEngine=new oF(t,n,r),this._timelineEngine=new ZL(t,n,r),this._transitionEngine.onRemovalComplete=function(e,t){return i.onRemovalComplete(e,t)}}return rp(e,[{key:"registerTrigger",value:function(e,t,n,r,i){var a=e+"-"+r,o=this._triggerCache[a];if(!o){var s=[],u=wL(this._driver,i,s);if(s.length)throw new Error('The animation trigger "'.concat(r,'" has failed to build due to the following errors:\n - ').concat(s.join("\n - ")));o=function(e,t,n){return new $L(e,t,n)}(r,u,this._normalizer),this._triggerCache[a]=o}this._transitionEngine.registerTrigger(t,r,o)}},{key:"register",value:function(e,t){this._transitionEngine.register(e,t)}},{key:"destroy",value:function(e,t){this._transitionEngine.destroy(e,t)}},{key:"onInsert",value:function(e,t,n,r){this._transitionEngine.insertNode(e,t,n,r)}},{key:"onRemove",value:function(e,t,n,r){this._transitionEngine.removeNode(e,t,r||!1,n)}},{key:"disableAnimations",value:function(e,t){this._transitionEngine.markElementAsDisabled(e,t)}},{key:"process",value:function(e,t,n,r){if("@"==n.charAt(0)){var i=Lv(ID(n),2),a=i[0],o=i[1];this._timelineEngine.command(a,t,o,r)}else this._transitionEngine.trigger(e,t,n,r)}},{key:"listen",value:function(e,t,n,r,i){if("@"==n.charAt(0)){var a=Lv(ID(n),2),o=a[0],s=a[1];return this._timelineEngine.listen(o,t,s,i)}return this._transitionEngine.listen(e,t,n,r,i)}},{key:"flush",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;this._transitionEngine.flush(e)}},{key:"players",get:function(){return this._transitionEngine.players.concat(this._timelineEngine.players)}},{key:"whenRenderingDone",value:function(){return this._transitionEngine.whenRenderingDone()}}]),e}();function kF(e,t){var n=null,r=null;return Array.isArray(t)&&t.length?(n=wF(t[0]),t.length>1&&(r=wF(t[t.length-1]))):t&&(n=wF(t)),n||r?new _F(e,n,r):null}var _F=function(){var e=function(){function e(t,n,r){tp(this,e),this._element=t,this._startStyles=n,this._endStyles=r,this._state=0;var i=e.initialStylesByElement.get(t);i||e.initialStylesByElement.set(t,i={}),this._initialStyles=i}return rp(e,[{key:"start",value:function(){this._state<1&&(this._startStyles&&nL(this._element,this._startStyles,this._initialStyles),this._state=1)}},{key:"finish",value:function(){this.start(),this._state<2&&(nL(this._element,this._initialStyles),this._endStyles&&(nL(this._element,this._endStyles),this._endStyles=null),this._state=1)}},{key:"destroy",value:function(){this.finish(),this._state<3&&(e.initialStylesByElement.delete(this._element),this._startStyles&&(rL(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(rL(this._element,this._endStyles),this._endStyles=null),nL(this._element,this._initialStyles),this._state=3)}}]),e}();return e.initialStylesByElement=new WeakMap,e}();function wF(e){for(var t=null,n=Object.keys(e),r=0;r<n.length;r++){var i=n[r];CF(i)&&((t=t||{})[i]=e[i])}return t}function CF(e){return"display"===e||"position"===e}var bF="animation",EF="animationend",SF=function(){function e(t,n,r,i,a,o,s){var u=this;tp(this,e),this._element=t,this._name=n,this._duration=r,this._delay=i,this._easing=a,this._fillMode=o,this._onDoneFn=s,this._finished=!1,this._destroyed=!1,this._startTime=0,this._position=0,this._eventFn=function(e){return u._handleCallback(e)}}return rp(e,[{key:"apply",value:function(){(function(e,t){var n=AF(e,"").trim();n.length&&(function(e,t){for(var n=0,r=0;r<e.length;r++)","===e.charAt(r)&&n++}(n),t="".concat(n,", ").concat(t)),xF(e,"",t)})(this._element,"".concat(this._duration,"ms ").concat(this._easing," ").concat(this._delay,"ms 1 normal ").concat(this._fillMode," ").concat(this._name)),IF(this._element,this._eventFn,!1),this._startTime=Date.now()}},{key:"pause",value:function(){PF(this._element,this._name,"paused")}},{key:"resume",value:function(){PF(this._element,this._name,"running")}},{key:"setPosition",value:function(e){var t=OF(this._element,this._name);this._position=e*this._duration,xF(this._element,"Delay","-".concat(this._position,"ms"),t)}},{key:"getPosition",value:function(){return this._position}},{key:"_handleCallback",value:function(e){var t=e._ngTestManualTimestamp||Date.now(),n=1e3*parseFloat(e.elapsedTime.toFixed(3));e.animationName==this._name&&Math.max(t-this._startTime,0)>=this._delay&&n>=this._duration&&this.finish()}},{key:"finish",value:function(){this._finished||(this._finished=!0,this._onDoneFn(),IF(this._element,this._eventFn,!0))}},{key:"destroy",value:function(){this._destroyed||(this._destroyed=!0,this.finish(),function(e,t){var n=AF(e,"").split(","),r=TF(n,t);r>=0&&(n.splice(r,1),xF(e,"",n.join(",")))}(this._element,this._name))}}]),e}();function PF(e,t,n){xF(e,"PlayState",n,OF(e,t))}function OF(e,t){var n=AF(e,"");return n.indexOf(",")>0?TF(n.split(","),t):TF([n],t)}function TF(e,t){for(var n=0;n<e.length;n++)if(e[n].indexOf(t)>=0)return n;return-1}function IF(e,t,n){n?e.removeEventListener(EF,t):e.addEventListener(EF,t)}function xF(e,t,n,r){var i=bF+t;if(null!=r){var a=e.style[i];if(a.length){var o=a.split(",");o[r]=n,n=o.join(",")}}e.style[i]=n}function AF(e,t){return e.style[bF+t]||""}var RF=function(){function e(t,n,r,i,a,o,s,u){tp(this,e),this.element=t,this.keyframes=n,this.animationName=r,this._duration=i,this._delay=a,this._finalStyles=s,this._specialStyles=u,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this.currentSnapshot={},this._state=0,this.easing=o||"linear",this.totalTime=i+a,this._buildStyler()}return rp(e,[{key:"onStart",value:function(e){this._onStartFns.push(e)}},{key:"onDone",value:function(e){this._onDoneFns.push(e)}},{key:"onDestroy",value:function(e){this._onDestroyFns.push(e)}},{key:"destroy",value:function(){this.init(),!(this._state>=4)&&(this._state=4,this._styler.destroy(),this._flushStartFns(),this._flushDoneFns(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(function(e){return e()}),this._onDestroyFns=[])}},{key:"_flushDoneFns",value:function(){this._onDoneFns.forEach(function(e){return e()}),this._onDoneFns=[]}},{key:"_flushStartFns",value:function(){this._onStartFns.forEach(function(e){return e()}),this._onStartFns=[]}},{key:"finish",value:function(){this.init(),!(this._state>=3)&&(this._state=3,this._styler.finish(),this._flushStartFns(),this._specialStyles&&this._specialStyles.finish(),this._flushDoneFns())}},{key:"setPosition",value:function(e){this._styler.setPosition(e)}},{key:"getPosition",value:function(){return this._styler.getPosition()}},{key:"hasStarted",value:function(){return this._state>=2}},{key:"init",value:function(){this._state>=1||(this._state=1,this._styler.apply(),this._delay&&this._styler.pause())}},{key:"play",value:function(){this.init(),this.hasStarted()||(this._flushStartFns(),this._state=2,this._specialStyles&&this._specialStyles.start()),this._styler.resume()}},{key:"pause",value:function(){this.init(),this._styler.pause()}},{key:"restart",value:function(){this.reset(),this.play()}},{key:"reset",value:function(){this._state=0,this._styler.destroy(),this._buildStyler(),this._styler.apply()}},{key:"_buildStyler",value:function(){var e=this;this._styler=new SF(this.element,this.animationName,this._duration,this._delay,this.easing,"forwards",function(){return e.finish()})}},{key:"triggerCallback",value:function(e){var t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(function(e){return e()}),t.length=0}},{key:"beforeDestroy",value:function(){var e=this;this.init();var t={};if(this.hasStarted()){var n=this._state>=3;Object.keys(this._finalStyles).forEach(function(r){"offset"!=r&&(t[r]=n?e._finalStyles[r]:pL(e.element,r))})}this.currentSnapshot=t}}]),e}(),NF=function(e){Gv(n,e);var t=$v(n);function n(e,r){var i;return tp(this,n),(i=t.call(this)).element=e,i._startingStyles={},i.__initialized=!1,i._styles=UD(r),i}return rp(n,[{key:"init",value:function(){var e=this;this.__initialized||!this._startingStyles||(this.__initialized=!0,Object.keys(this._styles).forEach(function(t){e._startingStyles[t]=e.element.style[t]}),zv(Yv(n.prototype),"init",this).call(this))}},{key:"play",value:function(){var e=this;!this._startingStyles||(this.init(),Object.keys(this._styles).forEach(function(t){return e.element.style.setProperty(t,e._styles[t])}),zv(Yv(n.prototype),"play",this).call(this))}},{key:"destroy",value:function(){var e=this;!this._startingStyles||(Object.keys(this._startingStyles).forEach(function(t){var n=e._startingStyles[t];n?e.element.style.setProperty(t,n):e.element.style.removeProperty(t)}),this._startingStyles=null,zv(Yv(n.prototype),"destroy",this).call(this))}}]),n}(kD),MF=function(){function e(){tp(this,e),this._count=0}return rp(e,[{key:"validateStyleProperty",value:function(e){return LD(e)}},{key:"matchesElement",value:function(e,t){return FD(e,t)}},{key:"containsElement",value:function(e,t){return BD(e,t)}},{key:"query",value:function(e,t,n){return VD(e,t,n)}},{key:"computeStyle",value:function(e,t,n){return window.getComputedStyle(e)[t]}},{key:"buildKeyframeElement",value:function(e,t,n){n=n.map(function(e){return UD(e)});var r="@keyframes ".concat(t," {\n"),i="";n.forEach(function(e){i=" ";var t=parseFloat(e.offset);r+="".concat(i).concat(100*t,"% {\n"),i+=" ",Object.keys(e).forEach(function(t){var n=e[t];switch(t){case"offset":return;case"easing":return void(n&&(r+="".concat(i,"animation-timing-function: ").concat(n,";\n")));default:return void(r+="".concat(i).concat(t,": ").concat(n,";\n"))}}),r+="".concat(i,"}\n")}),r+="}\n";var a=document.createElement("style");return a.textContent=r,a}},{key:"animate",value:function(e,t,n,r,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],o=a.filter(function(e){return e instanceof RF}),s={};fL(n,r)&&o.forEach(function(e){var t=e.currentSnapshot;Object.keys(t).forEach(function(e){return s[e]=t[e]})});var u=function(e){var t={};return e&&(Array.isArray(e)?e:[e]).forEach(function(e){Object.keys(e).forEach(function(n){"offset"==n||"easing"==n||(t[n]=e[n])})}),t}(t=dL(e,t,s));if(0==n)return new NF(e,u);var c="gen_css_kf_"+this._count++,l=this.buildKeyframeElement(e,c,t);(function(e){var t,n=null===(t=e.getRootNode)||void 0===t?void 0:t.call(e);return"undefined"!=typeof ShadowRoot&&n instanceof ShadowRoot?n:document.head})(e).appendChild(l);var h=kF(e,t),f=new RF(e,t,c,n,r,i,u,h);return f.onDestroy(function(){var e;(e=l).parentNode.removeChild(e)}),f}}]),e}(),DF=function(){function e(t,n,r,i){tp(this,e),this.element=t,this.keyframes=n,this.options=r,this._specialStyles=i,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this.time=0,this.parentPlayer=null,this.currentSnapshot={},this._duration=r.duration,this._delay=r.delay||0,this.time=this._duration+this._delay}return rp(e,[{key:"_onFinish",value:function(){this._finished||(this._finished=!0,this._onDoneFns.forEach(function(e){return e()}),this._onDoneFns=[])}},{key:"init",value:function(){this._buildPlayer(),this._preparePlayerBeforeStart()}},{key:"_buildPlayer",value:function(){var e=this;if(!this._initialized){this._initialized=!0;var t=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,t,this.options),this._finalKeyframe=t.length?t[t.length-1]:{},this.domPlayer.addEventListener("finish",function(){return e._onFinish()})}}},{key:"_preparePlayerBeforeStart",value:function(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}},{key:"_triggerWebAnimation",value:function(e,t,n){return e.animate(t,n)}},{key:"onStart",value:function(e){this._onStartFns.push(e)}},{key:"onDone",value:function(e){this._onDoneFns.push(e)}},{key:"onDestroy",value:function(e){this._onDestroyFns.push(e)}},{key:"play",value:function(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(function(e){return e()}),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}},{key:"pause",value:function(){this.init(),this.domPlayer.pause()}},{key:"finish",value:function(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}},{key:"reset",value:function(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1}},{key:"_resetDomPlayerState",value:function(){this.domPlayer&&this.domPlayer.cancel()}},{key:"restart",value:function(){this.reset(),this.play()}},{key:"hasStarted",value:function(){return this._started}},{key:"destroy",value:function(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(function(e){return e()}),this._onDestroyFns=[])}},{key:"setPosition",value:function(e){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=e*this.time}},{key:"getPosition",value:function(){return this.domPlayer.currentTime/this.time}},{key:"totalTime",get:function(){return this._delay+this._duration}},{key:"beforeDestroy",value:function(){var e=this,t={};this.hasStarted()&&Object.keys(this._finalKeyframe).forEach(function(n){"offset"!=n&&(t[n]=e._finished?e._finalKeyframe[n]:pL(e.element,n))}),this.currentSnapshot=t}},{key:"triggerCallback",value:function(e){var t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(function(e){return e()}),t.length=0}}]),e}(),LF=function(){function e(){tp(this,e),this._isNativeImpl=/\{\s*\[native\s+code\]\s*\}/.test(FF().toString()),this._cssKeyframesDriver=new MF}return rp(e,[{key:"validateStyleProperty",value:function(e){return LD(e)}},{key:"matchesElement",value:function(e,t){return FD(e,t)}},{key:"containsElement",value:function(e,t){return BD(e,t)}},{key:"query",value:function(e,t,n){return VD(e,t,n)}},{key:"computeStyle",value:function(e,t,n){return window.getComputedStyle(e)[t]}},{key:"overrideWebAnimationsSupport",value:function(e){this._isNativeImpl=e}},{key:"animate",value:function(e,t,n,r,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],o=arguments.length>6?arguments[6]:void 0;if(!o&&!this._isNativeImpl)return this._cssKeyframesDriver.animate(e,t,n,r,i,a);var s={duration:n,delay:r,fill:0==r?"both":"forwards"};i&&(s.easing=i);var u={},c=a.filter(function(e){return e instanceof DF});fL(n,r)&&c.forEach(function(e){var t=e.currentSnapshot;Object.keys(t).forEach(function(e){return u[e]=t[e]})});var l=kF(e,t=dL(e,t=t.map(function(e){return XD(e,!1)}),u));return new DF(e,t,s,l)}}]),e}();function FF(){return wD()&&Element.prototype.animate||{}}var BF=function(){var e=function(e){Gv(n,e);var t=$v(n);function n(e,r){var i;return tp(this,n),(i=t.call(this))._nextAnimationId=0,i._renderer=e.createRenderer(r.body,{id:"0",encapsulation:Vg.None,styles:[],data:{animation:[]}}),i}return rp(n,[{key:"build",value:function(e){var t=this._nextAnimationId.toString();this._nextAnimationId++;var n=Array.isArray(e)?gD(e):e;return zF(this._renderer,null,t,"register",[n]),new VF(t,this._renderer)}}]),n}(vD);return e.\u0275fac=function(t){return new(t||e)(Pk(aS),Pk(PO))},e.\u0275prov=Eg({token:e,factory:e.\u0275fac}),e}(),VF=function(e){Gv(n,e);var t=$v(n);function n(e,r){var i;return tp(this,n),(i=t.call(this))._id=e,i._renderer=r,i}return rp(n,[{key:"create",value:function(e,t){return new UF(this._id,e,t||{},this._renderer)}}]),n}(function(){return rp(function e(){tp(this,e)})}()),UF=function(){function e(t,n,r,i){tp(this,e),this.id=t,this.element=n,this._renderer=i,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",r)}return rp(e,[{key:"_listen",value:function(e,t){return this._renderer.listen(this.element,"@@".concat(this.id,":").concat(e),t)}},{key:"_command",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return zF(this._renderer,this.element,this.id,e,n)}},{key:"onDone",value:function(e){this._listen("done",e)}},{key:"onStart",value:function(e){this._listen("start",e)}},{key:"onDestroy",value:function(e){this._listen("destroy",e)}},{key:"init",value:function(){this._command("init")}},{key:"hasStarted",value:function(){return this._started}},{key:"play",value:function(){this._command("play"),this._started=!0}},{key:"pause",value:function(){this._command("pause")}},{key:"restart",value:function(){this._command("restart")}},{key:"finish",value:function(){this._command("finish")}},{key:"destroy",value:function(){this._command("destroy")}},{key:"reset",value:function(){this._command("reset"),this._started=!1}},{key:"setPosition",value:function(e){this._command("setPosition",e)}},{key:"getPosition",value:function(){var e,t;return null!==(t=null===(e=this._renderer.engine.players[+this.id])||void 0===e?void 0:e.getPosition())&&void 0!==t?t:0}}]),e}();function zF(e,t,n,r,i){return e.setProperty(t,"@@".concat(n,":").concat(r),i)}var HF="@.disabled",GF=function(){var e=function(){function e(t,n,r){tp(this,e),this.delegate=t,this.engine=n,this._zone=r,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),n.onRemovalComplete=function(e,t){t&&t.parentNode(e)&&t.removeChild(e.parentNode,e)}}return rp(e,[{key:"createRenderer",value:function(e,t){var n=this,r=this.delegate.createRenderer(e,t);if(!(e&&t&&t.data&&t.data.animation)){var i=this._rendererCache.get(r);return i||(i=new qF("",r,this.engine),this._rendererCache.set(r,i)),i}var a=t.id,o=t.id+"-"+this._currentId;this._currentId++,this.engine.register(o,e);return t.data.animation.forEach(function t(r){Array.isArray(r)?r.forEach(t):n.engine.registerTrigger(a,o,e,r.name,r)}),new $F(this,o,r,this.engine)}},{key:"begin",value:function(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}},{key:"_scheduleCountTask",value:function(){var e=this;this.promise.then(function(){e._microtaskId++})}},{key:"scheduleListenerCallback",value:function(e,t,n){var r=this;e>=0&&e<this._microtaskId?this._zone.run(function(){return t(n)}):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(function(){r._zone.run(function(){r._animationCallbacksBuffer.forEach(function(e){var t=Lv(e,2);(0,t[0])(t[1])}),r._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([t,n]))}},{key:"end",value:function(){var e=this;this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(function(){e._scheduleCountTask(),e.engine.flush(e._microtaskId)}),this.delegate.end&&this.delegate.end()}},{key:"whenRenderingDone",value:function(){return this.engine.whenRenderingDone()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Pk(aS),Pk(mF),Pk(YP))},e.\u0275prov=Eg({token:e,factory:e.\u0275fac}),e}(),qF=function(){function e(t,n,r){tp(this,e),this.namespaceId=t,this.delegate=n,this.engine=r,this.destroyNode=this.delegate.destroyNode?function(e){return n.destroyNode(e)}:null}return rp(e,[{key:"data",get:function(){return this.delegate.data}},{key:"destroy",value:function(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy()}},{key:"createElement",value:function(e,t){return this.delegate.createElement(e,t)}},{key:"createComment",value:function(e){return this.delegate.createComment(e)}},{key:"createText",value:function(e){return this.delegate.createText(e)}},{key:"appendChild",value:function(e,t){this.delegate.appendChild(e,t),this.engine.onInsert(this.namespaceId,t,e,!1)}},{key:"insertBefore",value:function(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];this.delegate.insertBefore(e,t,n),this.engine.onInsert(this.namespaceId,t,e,r)}},{key:"removeChild",value:function(e,t,n){this.engine.onRemove(this.namespaceId,t,this.delegate,n)}},{key:"selectRootElement",value:function(e,t){return this.delegate.selectRootElement(e,t)}},{key:"parentNode",value:function(e){return this.delegate.parentNode(e)}},{key:"nextSibling",value:function(e){return this.delegate.nextSibling(e)}},{key:"setAttribute",value:function(e,t,n,r){this.delegate.setAttribute(e,t,n,r)}},{key:"removeAttribute",value:function(e,t,n){this.delegate.removeAttribute(e,t,n)}},{key:"addClass",value:function(e,t){this.delegate.addClass(e,t)}},{key:"removeClass",value:function(e,t){this.delegate.removeClass(e,t)}},{key:"setStyle",value:function(e,t,n,r){this.delegate.setStyle(e,t,n,r)}},{key:"removeStyle",value:function(e,t,n){this.delegate.removeStyle(e,t,n)}},{key:"setProperty",value:function(e,t,n){"@"==t.charAt(0)&&t==HF?this.disableAnimations(e,!!n):this.delegate.setProperty(e,t,n)}},{key:"setValue",value:function(e,t){this.delegate.setValue(e,t)}},{key:"listen",value:function(e,t,n){return this.delegate.listen(e,t,n)}},{key:"disableAnimations",value:function(e,t){this.engine.disableAnimations(e,t)}}]),e}(),$F=function(e){Gv(n,e);var t=$v(n);function n(e,r,i,a){var o;return tp(this,n),(o=t.call(this,r,i,a)).factory=e,o.namespaceId=r,o}return rp(n,[{key:"setProperty",value:function(e,t,n){"@"==t.charAt(0)?"."==t.charAt(1)&&t==HF?this.disableAnimations(e,n=void 0===n||!!n):this.engine.process(this.namespaceId,e,t.substr(1),n):this.delegate.setProperty(e,t,n)}},{key:"listen",value:function(e,t,n){var r=this;if("@"==t.charAt(0)){var i,a=function(e){switch(e){case"body":return document.body;case"document":return document;case"window":return window;default:return e}}(e),o=t.substr(1),s="";return"@"!=o.charAt(0)&&(o=(i=Lv(function(e){var t=e.indexOf(".");return[e.substring(0,t),e.substr(t+1)]}(o),2))[0],s=i[1]),this.engine.listen(this.namespaceId,a,o,s,function(e){r.factory.scheduleListenerCallback(e._data||-1,n,e)})}return this.delegate.listen(e,t,n)}}]),n}(qF),WF=function(){var e=function(e){Gv(n,e);var t=$v(n);function n(e,r,i){return tp(this,n),t.call(this,e.body,r,i)}return rp(n,[{key:"ngOnDestroy",value:function(){this.flush()}}]),n}(mF);return e.\u0275fac=function(t){return new(t||e)(Pk(PO),Pk(HD),Pk(BL))},e.\u0275prov=Eg({token:e,factory:e.\u0275fac}),e}(),jF=new ok("AnimationModuleType"),ZF=[{provide:vD,useClass:BF},{provide:BL,useFactory:function(){return new VL}},{provide:mF,useClass:WF},{provide:aS,useFactory:function(e,t,n){return new GF(e,t,n)},deps:[sI,mF,YP]}],YF=[{provide:HD,useFactory:function(){return"function"==typeof FF()?new LF:new MF}},{provide:jF,useValue:"BrowserAnimations"}].concat(ZF),KF=[{provide:HD,useClass:zD},{provide:jF,useValue:"NoopAnimations"}].concat(ZF),JF=function(){var e=function(){function e(){tp(this,e)}return rp(e,null,[{key:"withConfig",value:function(t){return{ngModule:e,providers:t.disableAnimations?KF:YF}}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=iy({type:e}),e.\u0275inj=Sg({providers:YF,imports:[wI]}),e}(),QF=Bv(9575),XF=Bv.n(QF);function eB(e,t,n,r,i,a,o){try{var s=e[a](o),u=s.value}catch(c){return void n(c)}s.done?t(u):Promise.resolve(u).then(r,i)}function tB(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function o(e){eB(a,r,i,o,s,"next",e)}function s(e){eB(a,r,i,o,s,"throw",e)}o(void 0)})}}var nB=function(){function e(){tp(this,e)}return rp(e,null,[{key:"expectToBe",value:function(e,t,n){if(e!==t)throw void 0!==n?new Error(n):new Error("A default switch case did not observe the correct value, expected ".concat(t,", but got ").concat(e," instead."))}},{key:"expectToBeMultiple",value:function(e,t){var n,r=!1,i=Qv(t);try{for(i.s();!(n=i.n()).done;){if(e===n.value){r=!0;break}}}catch(a){i.e(a)}finally{i.f()}if(!1===r)throw new Error("A default switch case did not observe the correct value, expected a value among ".concat(t,", but got ").concat(e," instead."))}},{key:"getNonNullable",value:function(e){if(null==e)throw new Error("Expected value not to be null or undefined, but it was.");return e}}]),e}();function rB(e,t){e&&console.log(t)}function iB(e,t){if(null!=e&&null!=t&&"object"==typeof e){if(null!=e.equals)return e.equals(t);for(var n=e,r=t,i=0,a=Object.keys(n);i<a.length;i++){var o=a[i];if(!(o in r))return!1;if(!1===iB(n[o],r[o]))return!1}return!0}return e===t}function aB(e){return null==e||function(e){return"object"==typeof e&&null!=e&&null!=e.equals}(e)||function(e){return"string"==typeof e||"number"==typeof e||"boolean"==typeof e||null===e}(e)||function(e){if("object"==typeof e){for(var t in e)if(null!=e[t]&&!1===aB(e[t]))return!1;return null!=e&&e.constructor.prototype===Object.prototype}return!1}(e)}function oB(e,t){if(aB(e)&&aB(t))return iB(e,t);throw new Error("Comparing non comparable objects: ".concat(e.constructor.name," and ").concat(t.constructor.name))}var sB=function(){function e(t){tp(this,e),this.value=t}return rp(e,[{key:"isPresent",value:function(){return null!=this.value}},{key:"isAbsent",value:function(){return null==this.value}},{key:"get",value:function(){if(this.isPresent())return this.value;throw new Error("Value is absent")}},{key:"getOrElse",value:function(e){return this.isPresent()?this.value:e}},{key:"equals",value:function(e){return this.isAbsent()?e.isAbsent():!e.isAbsent()&&oB(this.value,e.value)}},{key:"equalsValue",value:function(t){return this.equals(e.of(t))}},{key:"toString",value:function(){return this.isAbsent()?"MGPOptional.empty()":"MGPOptional.of(".concat(this.value,")")}},{key:"map",value:function(t){return this.isPresent()?e.of(t(this.get())):e.empty()}}],[{key:"of",value:function(t){return new e(t)}},{key:"ofNullable",value:function(t){return null==t?e.empty():e.of(t)}},{key:"empty",value:function(){return new e(null)}}]),e}(),uB=function(e,t){if(!e)throw cB(t)},cB=function(e){return new Error("Firebase Database (${JSCORE_VERSION}) INTERNAL ASSERT FAILED: "+e)},lB=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296==(64512&i)&&r+1<e.length&&56320==(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},hB={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<e.length;i+=3){var a=e[i],o=i+1<e.length,s=o?e[i+1]:0,u=i+2<e.length,c=u?e[i+2]:0,l=(15&s)<<2|c>>6,h=63&c;u||(h=64,o||(l=64)),r.push(n[a>>2],n[(3&a)<<4|s>>4],n[l],n[h])}return r.join("")},encodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(lB(e),t)},decodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){for(var t=[],n=0,r=0;n<e.length;){var i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){var a=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&a)}else if(i>239&&i<365){var o=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(o>>10)),t[r++]=String.fromCharCode(56320+(1023&o))}else{var s=e[n++],u=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&u)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray:function(e,t){this.init_();for(var n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<e.length;){var a=n[e.charAt(i++)],o=i<e.length?n[e.charAt(i)]:0,s=++i<e.length?n[e.charAt(i)]:64,u=++i<e.length?n[e.charAt(i)]:64;if(++i,null==a||null==o||null==s||null==u)throw Error();r.push(a<<2|o>>4),64!==s&&(r.push(o<<4&240|s>>2),64!==u&&r.push(s<<6&192|u))}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}},fB=function(e){var t=lB(e);return hB.encodeByteArray(t,!0)},dB=function(e){return fB(e).replace(/\./g,"")},vB=function(e){try{return hB.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function pB(e){return gB(void 0,e)}function gB(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(var n in t)!t.hasOwnProperty(n)||!yB(n)||(e[n]=gB(e[n],t[n]));return e}function yB(e){return"__proto__"!==e}var mB=function(){function e(){var t=this;tp(this,e),this.reject=function(){},this.resolve=function(){},this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})}return rp(e,[{key:"wrapCallback",value:function(e){var t=this;return function(n,r){n?t.reject(n):t.resolve(r),"function"==typeof e&&(t.promise.catch(function(){}),1===e.length?e(n):e(n,r))}}}]),e}();function kB(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');var n=t||"demo-project",r=e.iat||0,i=e.sub||e.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");var a=Object.assign({iss:"https://securetoken.google.com/".concat(n),aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},e);return[dB(JSON.stringify({alg:"none",type:"JWT"})),dB(JSON.stringify(a)),""].join(".")}function _B(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function wB(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(_B())}function CB(){var e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id}function bB(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function EB(){var e=_B();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function SB(){return"object"==typeof indexedDB}function PB(){return new Promise(function(e,t){try{var n=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=function(){i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=function(){n=!1},i.onerror=function(){var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(n){t(n)}})}function OB(){return!("undefined"==typeof navigator||!navigator.cookieEnabled)}var TB=function(e){Gv(n,e);var t=$v(n);function n(e,r,i){var a;return tp(this,n),(a=t.call(this,r)).code=e,a.customData=i,a.name="FirebaseError",Object.setPrototypeOf(jv(a),n.prototype),Error.captureStackTrace&&Error.captureStackTrace(jv(a),IB.prototype.create),a}return rp(n)}(Vv(Error)),IB=function(){function e(t,n,r){tp(this,e),this.service=t,this.serviceName=n,this.errors=r}return rp(e,[{key:"create",value:function(e){var t=(arguments.length<=1?void 0:arguments[1])||{},n="".concat(this.service,"/").concat(e),r=this.errors[e],i=r?function(e,t){return e.replace(xB,function(e,n){var r=t[n];return null!=r?String(r):"<".concat(n,"?>")})}(r,t):"Error";return new TB(n,"".concat(this.serviceName,": ").concat(i," (").concat(n,")."),t)}}]),e}(),xB=/\{\$([^}]+)}/g;function AB(e){return JSON.parse(e)}function RB(e){return JSON.stringify(e)}var NB=function(e){var t={},n={},r={},i="";try{var a=e.split(".");t=AB(vB(a[0])||""),n=AB(vB(a[1])||""),i=a[2],r=n.d||{},delete n.d}catch(o){}return{header:t,claims:n,data:r,signature:i}};function MB(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function DB(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]}function LB(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function FB(e,t,n){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=t.call(n,e[i],i,e));return r}function BB(e,t){if(e===t)return!0;for(var n=Object.keys(e),r=Object.keys(t),i=0,a=n;i<a.length;i++){var o=a[i];if(!r.includes(o))return!1;var s=e[o],u=t[o];if(VB(s)&&VB(u)){if(!BB(s,u))return!1}else if(s!==u)return!1}for(var c=0,l=r;c<l.length;c++){var h=l[c];if(!n.includes(h))return!1}return!0}function VB(e){return null!==e&&"object"==typeof e}function UB(e){for(var t=[],n=function(){var e=Lv(i[r],2),n=e[0],a=e[1];Array.isArray(a)?a.forEach(function(e){t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))}):t.push(encodeURIComponent(n)+"="+encodeURIComponent(a))},r=0,i=Object.entries(e);r<i.length;r++)n();return t.length?"&"+t.join("&"):""}function zB(e){var t={};return e.replace(/^\?/,"").split("&").forEach(function(e){if(e){var n=Lv(e.split("="),2),r=n[0],i=n[1];t[decodeURIComponent(r)]=decodeURIComponent(i)}}),t}function HB(e){var t=e.indexOf("?");if(!t)return"";var n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}var GB=function(){function e(){tp(this,e),this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}return rp(e,[{key:"reset",value:function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}},{key:"compress_",value:function(e,t){t||(t=0);var n=this.W_;if("string"==typeof e)for(var r=0;r<16;r++)n[r]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(var i=0;i<16;i++)n[i]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(var a=16;a<80;a++){var o=n[a-3]^n[a-8]^n[a-14]^n[a-16];n[a]=4294967295&(o<<1|o>>>31)}for(var s,u,c=this.chain_[0],l=this.chain_[1],h=this.chain_[2],f=this.chain_[3],d=this.chain_[4],v=0;v<80;v++){v<40?v<20?(s=f^l&(h^f),u=1518500249):(s=l^h^f,u=1859775393):v<60?(s=l&h|f&(l|h),u=2400959708):(s=l^h^f,u=3395469782);var p=(c<<5|c>>>27)+s+d+u+n[v]&4294967295;d=f,f=h,h=4294967295&(l<<30|l>>>2),l=c,c=p}this.chain_[0]=this.chain_[0]+c&4294967295,this.chain_[1]=this.chain_[1]+l&4294967295,this.chain_[2]=this.chain_[2]+h&4294967295,this.chain_[3]=this.chain_[3]+f&4294967295,this.chain_[4]=this.chain_[4]+d&4294967295}},{key:"update",value:function(e,t){if(null!=e){void 0===t&&(t=e.length);for(var n=t-this.blockSize,r=0,i=this.buf_,a=this.inbuf_;r<t;){if(0===a)for(;r<=n;)this.compress_(e,r),r+=this.blockSize;if("string"==typeof e){for(;r<t;)if(i[a]=e.charCodeAt(r),++r,++a===this.blockSize){this.compress_(i),a=0;break}}else for(;r<t;)if(i[a]=e[r],++r,++a===this.blockSize){this.compress_(i),a=0;break}}this.inbuf_=a,this.total_+=t}}},{key:"digest",value:function(){var e=[],t=8*this.total_;this.update(this.pad_,this.inbuf_<56?56-this.inbuf_:this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&t,t/=256;this.compress_(this.buf_);for(var r=0,i=0;i<5;i++)for(var a=24;a>=0;a-=8)e[r]=this.chain_[i]>>a&255,++r;return e}}]),e}(),qB=function(){function e(t,n){var r=this;tp(this,e),this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(function(){t(r)}).catch(function(e){r.error(e)})}return rp(e,[{key:"next",value:function(e){this.forEachObserver(function(t){t.next(e)})}},{key:"error",value:function(e){this.forEachObserver(function(t){t.error(e)}),this.close(e)}},{key:"complete",value:function(){this.forEachObserver(function(e){e.complete()}),this.close()}},{key:"subscribe",value:function(e,t,n){var r,i=this;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");void 0===(r=function(e,t){if("object"!=typeof e||null===e)return!1;for(var n=0,r=["next","error","complete"];n<r.length;n++){var i=r[n];if(i in e&&"function"==typeof e[i])return!0}return!1}(e)?e:{next:e,error:t,complete:n}).next&&(r.next=$B),void 0===r.error&&(r.error=$B),void 0===r.complete&&(r.complete=$B);var a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(e){}}),this.observers.push(r),a}},{key:"unsubscribeOne",value:function(e){void 0===this.observers||void 0===this.observers[e]||(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}},{key:"forEachObserver",value:function(e){if(!this.finalized)for(var t=0;t<this.observers.length;t++)this.sendOne(t,e)}},{key:"sendOne",value:function(e,t){var n=this;this.task.then(function(){if(void 0!==n.observers&&void 0!==n.observers[e])try{t(n.observers[e])}catch(r){"undefined"!=typeof console&&console.error&&console.error(r)}})}},{key:"close",value:function(e){var t=this;this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(function(){t.observers=void 0,t.onNoObservers=void 0}))}}]),e}();function $B(){}function WB(e,t){return"".concat(e," failed: ").concat(t," argument ")}var jB=function(e){for(var t=0,n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t++:r<2048?t+=2:r>=55296&&r<=56319?(t+=4,n++):t+=3}return t};function ZB(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,r=t*Math.pow(n,e),i=Math.round(.5*r*(Math.random()-.5)*2);return Math.min(144e5,r+i)}function YB(e){return e&&e._delegate?e._delegate:e}var KB=function(){function e(t,n,r){tp(this,e),this.name=t,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}return rp(e,[{key:"setInstantiationMode",value:function(e){return this.instantiationMode=e,this}},{key:"setMultipleInstances",value:function(e){return this.multipleInstances=e,this}},{key:"setServiceProps",value:function(e){return this.serviceProps=e,this}},{key:"setInstanceCreatedCallback",value:function(e){return this.onInstanceCreated=e,this}}]),e}(),JB="[DEFAULT]",QB=function(){function e(t,n){tp(this,e),this.name=t,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}return rp(e,[{key:"get",value:function(e){var t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){var n=new mB;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{var r=this.getOrInitializeService({instanceIdentifier:t});r&&n.resolve(r)}catch(i){}}return this.instancesDeferred.get(t).promise}},{key:"getImmediate",value:function(e){var t,n=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier),r=null!==(t=null==e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service ".concat(this.name," is not available"))}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(r)return null;throw i}}},{key:"getComponent",value:function(){return this.component}},{key:"setComponent",value:function(e){if(e.name!==this.name)throw Error("Mismatching Component ".concat(e.name," for Provider ").concat(this.name,"."));if(this.component)throw Error("Component for ".concat(this.name," has already been provided"));if(this.component=e,this.shouldAutoInitialize()){if("EAGER"===e.instantiationMode)try{this.getOrInitializeService({instanceIdentifier:JB})}catch(u){}var t,n=Qv(this.instancesDeferred.entries());try{for(n.s();!(t=n.n()).done;){var r=Lv(t.value,2),i=r[0],a=r[1],o=this.normalizeInstanceIdentifier(i);try{var s=this.getOrInitializeService({instanceIdentifier:o});a.resolve(s)}catch(c){}}}catch(l){n.e(l)}finally{n.f()}}}},{key:"clearInstance",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:JB;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}},{key:"delete",value:function(){var e=this;return tB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=Array.from(e.instances.values()),t.next=3,Promise.all([].concat(Kv(n.filter(function(e){return"INTERNAL"in e}).map(function(e){return e.INTERNAL.delete()})),Kv(n.filter(function(e){return"_delete"in e}).map(function(e){return e._delete()}))));case 3:case"end":return t.stop()}},t)}))()}},{key:"isComponentSet",value:function(){return null!=this.component}},{key:"isInitialized",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:JB;return this.instances.has(e)}},{key:"getOptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:JB;return this.instancesOptions.get(e)||{}}},{key:"initialize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.options,n=void 0===t?{}:t,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error("".concat(this.name,"(").concat(r,") has already been initialized"));if(!this.isComponentSet())throw Error("Component ".concat(this.name," has not been registered yet"));var i,a=this.getOrInitializeService({instanceIdentifier:r,options:n}),o=Qv(this.instancesDeferred.entries());try{for(o.s();!(i=o.n()).done;){var s=Lv(i.value,2),u=s[0],c=s[1];r===this.normalizeInstanceIdentifier(u)&&c.resolve(a)}}catch(l){o.e(l)}finally{o.f()}return a}},{key:"onInit",value:function(e,t){var n,r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);var a=this.instances.get(r);return a&&e(a,r),function(){i.delete(e)}}},{key:"invokeOnInitCallbacks",value:function(e,t){var n=this.onInitCallbacks.get(t);if(n){var r,i=Qv(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;try{a(e,t)}catch(o){}}}catch(s){i.e(s)}finally{i.f()}}}},{key:"getOrInitializeService",value:function(e){var t,n=e.instanceIdentifier,r=e.options,i=void 0===r?{}:r,a=this.instances.get(n);if(!a&&this.component&&(a=this.component.instanceFactory(this.container,{instanceIdentifier:(t=n,t===JB?void 0:t),options:i}),this.instances.set(n,a),this.instancesOptions.set(n,i),this.invokeOnInitCallbacks(a,n),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,n,a)}catch(o){}return a||null}},{key:"normalizeInstanceIdentifier",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:JB;return this.component?this.component.multipleInstances?e:JB:e}},{key:"shouldAutoInitialize",value:function(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}]),e}(),XB=function(){function e(t){tp(this,e),this.name=t,this.providers=new Map}return rp(e,[{key:"addComponent",value:function(e){var t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component ".concat(e.name," has already been registered with ").concat(this.name));t.setComponent(e)}},{key:"addOrOverwriteComponent",value:function(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}},{key:"getProvider",value:function(e){if(this.providers.has(e))return this.providers.get(e);var t=new QB(e,this);return this.providers.set(e,t),t}},{key:"getProviders",value:function(){return Array.from(this.providers.values())}}]),e}(),eV=[],tV=function(){return(e=tV||(tV={}))[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT",tV;var e}(),nV={debug:tV.DEBUG,verbose:tV.VERBOSE,info:tV.INFO,warn:tV.WARN,error:tV.ERROR,silent:tV.SILENT},rV=tV.INFO,iV=(Dv(Hv={},tV.DEBUG,"log"),Dv(Hv,tV.VERBOSE,"log"),Dv(Hv,tV.INFO,"info"),Dv(Hv,tV.WARN,"warn"),Dv(Hv,tV.ERROR,"error"),Hv),aV=function(e,t){var n;if(!(t<e.logLevel)){var r=(new Date).toISOString(),i=iV[t];if(!i)throw new Error("Attempted to log a message with an invalid logType (value: ".concat(t,")"));for(var a=arguments.length,o=new Array(a>2?a-2:0),s=2;s<a;s++)o[s-2]=arguments[s];(n=console)[i].apply(n,["[".concat(r,"]  ").concat(e.name,":")].concat(o))}},oV=function(){function e(t){tp(this,e),this.name=t,this._logLevel=rV,this._logHandler=aV,this._userLogHandler=null,eV.push(this)}return rp(e,[{key:"logLevel",get:function(){return this._logLevel},set:function(e){if(!(e in tV))throw new TypeError('Invalid value "'.concat(e,'" assigned to `logLevel`'));this._logLevel=e}},{key:"setLogLevel",value:function(e){this._logLevel="string"==typeof e?nV[e]:e}},{key:"logHandler",get:function(){return this._logHandler},set:function(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}},{key:"userLogHandler",get:function(){return this._userLogHandler},set:function(e){this._userLogHandler=e}},{key:"debug",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,tV.DEBUG].concat(t)),this._logHandler.apply(this,[this,tV.DEBUG].concat(t))}},{key:"log",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,tV.VERBOSE].concat(t)),this._logHandler.apply(this,[this,tV.VERBOSE].concat(t))}},{key:"info",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,tV.INFO].concat(t)),this._logHandler.apply(this,[this,tV.INFO].concat(t))}},{key:"warn",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,tV.WARN].concat(t)),this._logHandler.apply(this,[this,tV.WARN].concat(t))}},{key:"error",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,tV.ERROR].concat(t)),this._logHandler.apply(this,[this,tV.ERROR].concat(t))}}]),e}(),sV=function(){function e(t){tp(this,e),this.container=t}return rp(e,[{key:"getPlatformInfoString",value:function(){return this.container.getProviders().map(function(e){if(function(e){var t=e.getComponent();return"VERSION"===(null==t?void 0:t.type)}(e)){var t=e.getImmediate();return"".concat(t.library,"/").concat(t.version)}return null}).filter(function(e){return e}).join(" ")}}]),e}(),uV="@firebase/app",cV=new oV("@firebase/app"),lV="[DEFAULT]",hV=(Dv(qv={},uV,"fire-core"),Dv(qv,"@firebase/app-compat","fire-core-compat"),Dv(qv,"@firebase/analytics","fire-analytics"),Dv(qv,"@firebase/analytics-compat","fire-analytics-compat"),Dv(qv,"@firebase/app-check","fire-app-check"),Dv(qv,"@firebase/app-check-compat","fire-app-check-compat"),Dv(qv,"@firebase/auth","fire-auth"),Dv(qv,"@firebase/auth-compat","fire-auth-compat"),Dv(qv,"@firebase/database","fire-rtdb"),Dv(qv,"@firebase/database-compat","fire-rtdb-compat"),Dv(qv,"@firebase/functions","fire-fn"),Dv(qv,"@firebase/functions-compat","fire-fn-compat"),Dv(qv,"@firebase/installations","fire-iid"),Dv(qv,"@firebase/installations-compat","fire-iid-compat"),Dv(qv,"@firebase/messaging","fire-fcm"),Dv(qv,"@firebase/messaging-compat","fire-fcm-compat"),Dv(qv,"@firebase/performance","fire-perf"),Dv(qv,"@firebase/performance-compat","fire-perf-compat"),Dv(qv,"@firebase/remote-config","fire-rc"),Dv(qv,"@firebase/remote-config-compat","fire-rc-compat"),Dv(qv,"@firebase/storage","fire-gcs"),Dv(qv,"@firebase/storage-compat","fire-gcs-compat"),Dv(qv,"@firebase/firestore","fire-fst"),Dv(qv,"@firebase/firestore-compat","fire-fst-compat"),Dv(qv,"fire-js","fire-js"),Dv(qv,"firebase","fire-js-all"),qv),fV=new Map,dV=new Map;function vV(e,t){try{e.container.addComponent(t)}catch(n){cV.debug("Component ".concat(t.name," failed to register with FirebaseApp ").concat(e.name),n)}}function pV(e){var t=e.name;if(dV.has(t))return cV.debug("There were multiple attempts to register component ".concat(t,".")),!1;dV.set(t,e);var n,r=Qv(fV.values());try{for(r.s();!(n=r.n()).done;){vV(n.value,e)}}catch(i){r.e(i)}finally{r.f()}return!0}function gV(e,t){return e.container.getProvider(t)}var yV=new IB("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function."}),mV=function(){function e(t,n,r){var i=this;tp(this,e),this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new KB("app",function(){return i},"PUBLIC"))}return rp(e,[{key:"automaticDataCollectionEnabled",get:function(){return this.checkDestroyed(),this._automaticDataCollectionEnabled},set:function(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}},{key:"name",get:function(){return this.checkDestroyed(),this._name}},{key:"options",get:function(){return this.checkDestroyed(),this._options}},{key:"config",get:function(){return this.checkDestroyed(),this._config}},{key:"container",get:function(){return this._container}},{key:"isDeleted",get:function(){return this._isDeleted},set:function(e){this._isDeleted=e}},{key:"checkDestroyed",value:function(){if(this.isDeleted)throw yV.create("app-deleted",{appName:this._name})}}]),e}(),kV="9.6.6";function _V(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:lV,t=fV.get(e);if(!t)throw yV.create("no-app",{appName:e});return t}function wV(){return Array.from(fV.values())}function CV(e,t,n){var r,i=null!==(r=hV[e])&&void 0!==r?r:e;n&&(i+="-".concat(n));var a=i.match(/\s|\//),o=t.match(/\s|\//);if(a||o){var s=['Unable to register library "'.concat(i,'" with version "').concat(t,'":')];return a&&s.push('library name "'.concat(i,'" contains illegal characters (whitespace or "/")')),a&&o&&s.push("and"),o&&s.push('version name "'.concat(t,'" contains illegal characters (whitespace or "/")')),void cV.warn(s.join(" "))}pV(new KB("".concat(i,"-version"),function(){return{library:i,version:t}},"VERSION"))}pV(new KB("platform-logger",function(e){return new sV(e)},"PRIVATE")),CV(uV,"0.7.16",""),CV(uV,"0.7.16","esm2017"),CV("fire-js",""),CV("firebase","9.6.6","app");var bV=Bv(6676),EV="@firebase/installations",SV="w:0.5.5",PV="FIS_v2",OV=new IB("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function TV(e){return e instanceof TB&&e.code.includes("request-failed")}function IV(e){var t=e.projectId;return"https://firebaseinstallations.googleapis.com/v1/projects/".concat(t,"/installations")}function xV(e){return{token:e.token,requestStatus:2,expiresIn:FV(e.expiresIn),creationTime:Date.now()}}function AV(e,t){return RV.apply(this,arguments)}function RV(){return(RV=tB(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.json();case 2:return r=e.sent.error,e.abrupt("return",OV.create("request-failed",{requestName:t,serverCode:r.code,serverMessage:r.message,serverStatus:r.status}));case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function NV(e){var t=e.apiKey;return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function MV(e,t){var n=t.refreshToken,r=NV(e);return r.append("Authorization",function(e){return"".concat(PV," ").concat(e)}(n)),r}function DV(e){return LV.apply(this,arguments)}function LV(){return(LV=tB(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t();case 2:return n=e.sent,e.abrupt("return",n.status>=500&&n.status<600?t():n);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function FV(e){return Number(e.replace("s","000"))}function BV(e,t){return VV.apply(this,arguments)}function VV(){return(VV=tB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.fid,i=IV(t),a={method:"POST",headers:NV(t),body:JSON.stringify({fid:r,authVersion:PV,appId:t.appId,sdkVersion:SV})},e.next=5,DV(function(){return fetch(i,a)});case 5:if(!(o=e.sent).ok){e.next=11;break}return e.next=9,o.json();case 9:return s=e.sent,e.abrupt("return",{fid:s.fid||r,registrationStatus:2,refreshToken:s.refreshToken,authToken:xV(s.authToken)});case 11:return e.next=13,AV("Create Installation",o);case 13:throw e.sent;case 14:case"end":return e.stop()}},e)}))).apply(this,arguments)}function UV(e){return new Promise(function(t){setTimeout(t,e)})}var zV=/^[cdef][\w-]{21}$/;function HV(){try{var e=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(e),e[0]=112+e[0]%16;var t=function(e){return function(e){return btoa(String.fromCharCode.apply(String,Kv(e))).replace(/\+/g,"-").replace(/\//g,"_")}(e).substr(0,22)}(e);return zV.test(t)?t:""}catch(n){return""}}function GV(e){return"".concat(e.appName,"!").concat(e.appId)}var qV=new Map;function $V(e,t){var n=GV(e);WV(n,t),function(e,t){var n=(!jV&&"BroadcastChannel"in self&&((jV=new BroadcastChannel("[Firebase] FID Change")).onmessage=function(e){WV(e.data.key,e.data.fid)}),jV);n&&n.postMessage({key:e,fid:t}),0===qV.size&&jV&&(jV.close(),jV=null)}(n,t)}function WV(e,t){var n=qV.get(e);if(n){var r,i=Qv(n);try{for(i.s();!(r=i.n()).done;){(0,r.value)(t)}}catch(a){i.e(a)}finally{i.f()}}}var jV=null,ZV="firebase-installations-store",YV=null;function KV(){return YV||(YV=(0,bV.openDb)("firebase-installations-database",1,function(e){switch(e.oldVersion){case 0:e.createObjectStore(ZV)}})),YV}function JV(e,t){return QV.apply(this,arguments)}function QV(){return(QV=tB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=GV(t),e.next=3,KV();case 3:return i=e.sent.transaction(ZV,"readwrite"),a=i.objectStore(ZV),e.next=7,a.get(r);case 7:return o=e.sent,e.next=10,a.put(n,r);case 10:return e.next=12,i.complete;case 12:return(!o||o.fid!==n.fid)&&$V(t,n.fid),e.abrupt("return",n);case 14:case"end":return e.stop()}},e)}))).apply(this,arguments)}function XV(e){return eU.apply(this,arguments)}function eU(){return(eU=tB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=GV(t),e.next=3,KV();case 3:return r=e.sent.transaction(ZV,"readwrite"),e.next=6,r.objectStore(ZV).delete(n);case 6:return e.next=8,r.complete;case 8:case"end":return e.stop()}},e)}))).apply(this,arguments)}function tU(e,t){return nU.apply(this,arguments)}function nU(){return(nU=tB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=GV(t),e.next=3,KV();case 3:return i=e.sent.transaction(ZV,"readwrite"),a=i.objectStore(ZV),e.next=7,a.get(r);case 7:if(o=e.sent,void 0!==(s=n(o))){e.next=14;break}return e.next=12,a.delete(r);case 12:e.next=16;break;case 14:return e.next=16,a.put(s,r);case 16:return e.next=18,i.complete;case 18:return s&&(!o||o.fid!==s.fid)&&$V(t,s.fid),e.abrupt("return",s);case 20:case"end":return e.stop()}},e)}))).apply(this,arguments)}function rU(e){return iU.apply(this,arguments)}function iU(){return(iU=tB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,tU(t,function(e){var r=aU(e),i=oU(t,r);return n=i.registrationPromise,i.installationEntry});case 2:if(""!==(r=e.sent).fid){e.next=10;break}return e.next=6,n;case 6:e.t1=e.sent,e.t0={installationEntry:e.t1},e.next=11;break;case 10:e.t0={installationEntry:r,registrationPromise:n};case 11:return e.abrupt("return",e.t0);case 12:case"end":return e.stop()}},e)}))).apply(this,arguments)}function aU(e){return hU(e||{fid:HV(),registrationStatus:0})}function oU(e,t){if(0===t.registrationStatus){if(!navigator.onLine)return{installationEntry:t,registrationPromise:Promise.reject(OV.create("app-offline"))};var n={fid:t.fid,registrationStatus:1,registrationTime:Date.now()};return{installationEntry:n,registrationPromise:function(e,t){return sU.apply(this,arguments)}(e,n)}}return 1===t.registrationStatus?{installationEntry:t,registrationPromise:uU(e)}:{installationEntry:t}}function sU(){return(sU=tB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.t0=JV,e.t1=t,e.next=5,BV(t,n);case 5:return e.t2=e.sent,e.abrupt("return",(0,e.t0)(e.t1,e.t2));case 9:if(e.prev=9,e.t3=e.catch(0),!TV(e.t3)||409!==e.t3.customData.serverCode){e.next=16;break}return e.next=14,XV(t);case 14:e.next=18;break;case 16:return e.next=18,JV(t,{fid:n.fid,registrationStatus:0});case 18:throw e.t3;case 19:case"end":return e.stop()}},e,null,[[0,9]])}))).apply(this,arguments)}function uU(e){return cU.apply(this,arguments)}function cU(){return(cU=tB(regeneratorRuntime.mark(function e(t){var n,r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,lU(t);case 2:n=e.sent;case 3:if(1!==n.registrationStatus){e.next=11;break}return e.next=6,UV(100);case 6:return e.next=8,lU(t);case 8:n=e.sent;case 9:e.next=3;break;case 11:if(0!==n.registrationStatus){e.next=18;break}return e.next=14,rU(t);case 14:return r=e.sent,i=r.installationEntry,a=r.registrationPromise,e.abrupt("return",a||i);case 18:return e.abrupt("return",n);case 19:case"end":return e.stop()}},e)}))).apply(this,arguments)}function lU(e){return tU(e,function(e){if(!e)throw OV.create("installation-not-found");return hU(e)})}function hU(e){return function(e){return 1===e.registrationStatus&&e.registrationTime+1e4<Date.now()}(e)?{fid:e.fid,registrationStatus:0}:e}function fU(e,t){return dU.apply(this,arguments)}function dU(){return(dU=tB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s,u,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.appConfig,i=t.platformLoggerProvider,a=vU(r,n),o=MV(r,n),(s=i.getImmediate({optional:!0}))&&o.append("x-firebase-client",s.getPlatformInfoString()),u={method:"POST",headers:o,body:JSON.stringify({installation:{sdkVersion:SV}})},e.next=6,DV(function(){return fetch(a,u)});case 6:if(!(c=e.sent).ok){e.next=13;break}return e.t0=xV,e.next=11,c.json();case 11:return e.t1=e.sent,e.abrupt("return",(0,e.t0)(e.t1));case 13:return e.next=15,AV("Generate Auth Token",c);case 15:throw e.sent;case 16:case"end":return e.stop()}},e)}))).apply(this,arguments)}function vU(e,t){var n=t.fid;return"".concat(IV(e),"/").concat(n,"/authTokens:generate")}function pU(e){return gU.apply(this,arguments)}function gU(){return(gU=tB(regeneratorRuntime.mark(function e(t){var n,r,i,a=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.length>1&&void 0!==a[1]&&a[1],e.next=3,tU(t.appConfig,function(e){if(!CU(e))throw OV.create("not-registered");var i=e.authToken;if(!n&&bU(i))return e;if(1===i.requestStatus)return r=yU(t,n),e;if(!navigator.onLine)throw OV.create("app-offline");var a=EU(e);return r=_U(t,a),a});case 3:if(i=e.sent,!r){e.next=10;break}return e.next=7,r;case 7:e.t0=e.sent,e.next=11;break;case 10:e.t0=i.authToken;case 11:return e.abrupt("return",e.t0);case 12:case"end":return e.stop()}},e)}))).apply(this,arguments)}function yU(e,t){return mU.apply(this,arguments)}function mU(){return(mU=tB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,kU(t.appConfig);case 2:r=e.sent;case 3:if(1!==r.authToken.requestStatus){e.next=11;break}return e.next=6,UV(100);case 6:return e.next=8,kU(t.appConfig);case 8:r=e.sent;case 9:e.next=3;break;case 11:return i=r.authToken,e.abrupt("return",0===i.requestStatus?pU(t,n):i);case 13:case"end":return e.stop()}},e)}))).apply(this,arguments)}function kU(e){return tU(e,function(e){if(!CU(e))throw OV.create("not-registered");return function(e){return 1===e.requestStatus&&e.requestTime+1e4<Date.now()}(e.authToken)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}function _U(e,t){return wU.apply(this,arguments)}function wU(){return(wU=tB(regeneratorRuntime.mark(function e(t,n){var r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fU(t,n);case 3:return r=e.sent,i=Object.assign(Object.assign({},n),{authToken:r}),e.next=7,JV(t.appConfig,i);case 7:return e.abrupt("return",r);case 10:if(e.prev=10,e.t0=e.catch(0),TV(e.t0)&&(401===e.t0.customData.serverCode||404===e.t0.customData.serverCode)){e.next=18;break}return a=Object.assign(Object.assign({},n),{authToken:{requestStatus:0}}),e.next=16,JV(t.appConfig,a);case 16:e.next=20;break;case 18:return e.next=20,XV(t.appConfig);case 20:throw e.t0;case 21:case"end":return e.stop()}},e,null,[[0,10]])}))).apply(this,arguments)}function CU(e){return void 0!==e&&2===e.registrationStatus}function bU(e){return 2===e.requestStatus&&!function(e){var t=Date.now();return t<e.creationTime||e.creationTime+e.expiresIn<t+36e5}(e)}function EU(e){var t={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},e),{authToken:t})}function SU(){return(SU=tB(regeneratorRuntime.mark(function e(t){var n,r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t,e.next=3,rU(n.appConfig);case 3:return r=e.sent,i=r.installationEntry,a=r.registrationPromise,e.abrupt("return",(a?a.catch(console.error):pU(n).catch(console.error),i.fid));case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}function PU(){return(PU=tB(regeneratorRuntime.mark(function e(t){var n,r,i=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>1&&void 0!==i[1]&&i[1],r=t,e.next=4,OU(r.appConfig);case 4:return e.next=6,pU(r,n);case 6:return e.abrupt("return",e.sent.token);case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}function OU(e){return TU.apply(this,arguments)}function TU(){return(TU=tB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,rU(t);case 2:if(n=e.sent,r=n.registrationPromise,e.t0=r,!e.t0){e.next=8;break}return e.next=8,r;case 8:case"end":return e.stop()}},e)}))).apply(this,arguments)}function IU(e){return OV.create("missing-app-config-values",{valueName:e})}var xU="installations";pV(new KB(xU,function(e){var t=e.getProvider("app").getImmediate();return{app:t,appConfig:function(e){if(!e||!e.options)throw IU("App Configuration");if(!e.name)throw IU("App Name");for(var t=0,n=["projectId","apiKey","appId"];t<n.length;t++){var r=n[t];if(!e.options[r])throw IU(r)}return{appName:e.name,projectId:e.options.projectId,apiKey:e.options.apiKey,appId:e.options.appId}}(t),platformLoggerProvider:gV(t,"platform-logger"),_delete:function(){return Promise.resolve()}}},"PUBLIC")),pV(new KB("installations-internal",function(e){var t=gV(e.getProvider("app").getImmediate(),xU).getImmediate();return{getId:function(){return function(e){return SU.apply(this,arguments)}(t)},getToken:function(e){return function(e){return PU.apply(this,arguments)}(t,e)}}},"PRIVATE")),CV(EV,"0.5.5"),CV(EV,"0.5.5","esm2017");var AU="@firebase/remote-config",RU=new IB("remoteconfig","Remote Config",{"registration-window":"Undefined window object. This SDK only supports usage in a browser environment.","registration-project-id":"Undefined project identifier. Check Firebase app initialization.","registration-api-key":"Undefined API key. Check Firebase app initialization.","registration-app-id":"Undefined app identifier. Check Firebase app initialization.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}.","fetch-client-network":"Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-timeout":'The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',"fetch-throttle":'The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',"fetch-client-parse":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","indexed-db-unavailable":"Indexed DB is not supported by current browser"}),NU=function(){function e(t,n,r,i){tp(this,e),this.client=t,this.storage=n,this.storageCache=r,this.logger=i}return rp(e,[{key:"isCachedDataFresh",value:function(e,t){if(!t)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;var n=Date.now()-t,r=n<=e;return this.logger.debug("Config fetch cache check. Cache age millis: ".concat(n,". Cache max age millis (minimumFetchIntervalMillis setting): ").concat(e,". Is cache hit: ").concat(r,".")),r}},{key:"fetch",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function n(){var r,i,a,o,s,u;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Promise.all([t.storage.getLastSuccessfulFetchTimestampMillis(),t.storage.getLastSuccessfulFetchResponse()]);case 2:if(r=n.sent,i=Lv(r,2),a=i[0],!(o=i[1])||!t.isCachedDataFresh(e.cacheMaxAgeMillis,a)){n.next=8;break}return n.abrupt("return",o);case 8:return e.eTag=o&&o.eTag,n.next=11,t.client.fetch(e);case 11:return s=n.sent,u=[t.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())],200===s.status&&u.push(t.storage.setLastSuccessfulFetchResponse(s)),n.next=16,Promise.all(u);case 16:return n.abrupt("return",s);case 17:case"end":return n.stop()}},n)}))()}}]),e}();function MU(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:navigator;return e.languages&&e.languages[0]||e.language}var DU=function(){function e(t,n,r,i,a,o){tp(this,e),this.firebaseInstallations=t,this.sdkVersion=n,this.namespace=r,this.projectId=i,this.apiKey=a,this.appId=o}return rp(e,[{key:"fetch",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){var t=this;return tB(regeneratorRuntime.mark(function n(){var r,i,a,o,s,u,c,l,h,f,d,v,p,g,y,m,k;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Promise.all([t.firebaseInstallations.getId(),t.firebaseInstallations.getToken()]);case 2:return r=n.sent,i=Lv(r,2),a=i[0],o=i[1],s="".concat(window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com","/v1/projects/").concat(t.projectId,"/namespaces/").concat(t.namespace,":fetch?key=").concat(t.apiKey),u={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":e.eTag||"*"},c={sdk_version:t.sdkVersion,app_instance_id:a,app_instance_id_token:o,app_id:t.appId,language_code:MU()},l={method:"POST",headers:u,body:JSON.stringify(c)},h=fetch(s,l),f=new Promise(function(t,n){e.signal.addEventListener(function(){var e=new Error("The operation was aborted.");e.name="AbortError",n(e)})}),n.prev=12,n.next=15,Promise.race([h,f]);case 15:return n.next=17,h;case 17:d=n.sent,n.next=24;break;case 20:throw n.prev=20,n.t0=n.catch(12),v="fetch-client-network","AbortError"===n.t0.name&&(v="fetch-timeout"),RU.create(v,{originalErrorMessage:n.t0.message});case 24:if(p=d.status,g=d.headers.get("ETag")||void 0,200!==d.status){n.next=37;break}return n.prev=27,n.next=30,d.json();case 30:k=n.sent,n.next=36;break;case 33:throw n.prev=33,n.t1=n.catch(27),RU.create("fetch-client-parse",{originalErrorMessage:n.t1.message});case 36:y=k.entries,m=k.state;case 37:if("INSTANCE_STATE_UNSPECIFIED"===m?p=500:"NO_CHANGE"===m?p=304:("NO_TEMPLATE"===m||"EMPTY_CONFIG"===m)&&(y={}),304===p||200===p){n.next=39;break}throw RU.create("fetch-status",{httpStatus:p});case 39:return n.abrupt("return",{status:p,eTag:g,config:y});case 40:case"end":return n.stop()}},n,null,[[12,20],[27,33]])}))()})}]),e}(),LU=function(){function e(t,n){tp(this,e),this.client=t,this.storage=n}return rp(e,[{key:"fetch",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.storage.getThrottleMetadata();case 2:if(n.t0=n.sent,n.t0){n.next=5;break}n.t0={backoffCount:0,throttleEndTimeMillis:Date.now()};case 5:return r=n.t0,n.abrupt("return",t.attemptFetch(e,r));case 7:case"end":return n.stop()}},n)}))()}},{key:"attemptFetch",value:function(e,t){var n=t.throttleEndTimeMillis,r=t.backoffCount,i=this;return tB(regeneratorRuntime.mark(function t(){var a,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,function(e,t){return new Promise(function(n,r){var i=Math.max(t-Date.now(),0),a=setTimeout(n,i);e.addEventListener(function(){clearTimeout(a),r(RU.create("fetch-throttle",{throttleEndTimeMillis:t}))})})}(e.signal,n);case 2:return t.prev=2,t.next=5,i.client.fetch(e);case 5:return a=t.sent,t.next=8,i.storage.deleteThrottleMetadata();case 8:return t.abrupt("return",a);case 11:if(t.prev=11,t.t0=t.catch(2),function(e){if(!(e instanceof TB&&e.customData))return!1;var t=Number(e.customData.httpStatus);return 429===t||500===t||503===t||504===t}(t.t0)){t.next=15;break}throw t.t0;case 15:return o={throttleEndTimeMillis:Date.now()+ZB(r),backoffCount:r+1},t.next=18,i.storage.setThrottleMetadata(o);case 18:return t.abrupt("return",i.attemptFetch(e,o));case 19:case"end":return t.stop()}},t,null,[[2,11]])}))()}}]),e}(),FU=function(){function e(t,n,r,i,a){tp(this,e),this.app=t,this._client=n,this._storageCache=r,this._storage=i,this._logger=a,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:6e4,minimumFetchIntervalMillis:432e5},this.defaultConfig={}}return rp(e,[{key:"fetchTimeMillis",get:function(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1}},{key:"lastFetchStatus",get:function(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"}}]),e}();function BU(e,t){var n=e.target.error||void 0;return RU.create(t,{originalErrorMessage:n&&n.message})}var VU="app_namespace_store",UU=function(){function e(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Promise(function(e,t){try{var r=indexedDB.open("firebase_remote_config",1);r.onerror=function(e){t(BU(e,"storage-open"))},r.onsuccess=function(t){e(t.target.result)},r.onupgradeneeded=function(e){var t=e.target.result;switch(e.oldVersion){case 0:t.createObjectStore(VU,{keyPath:"compositeKey"})}}}catch(n){t(RU.create("storage-open",{originalErrorMessage:n}))}});tp(this,e),this.appId=t,this.appName=n,this.namespace=r,this.openDbPromise=i}return rp(e,[{key:"getLastFetchStatus",value:function(){return this.get("last_fetch_status")}},{key:"setLastFetchStatus",value:function(e){return this.set("last_fetch_status",e)}},{key:"getLastSuccessfulFetchTimestampMillis",value:function(){return this.get("last_successful_fetch_timestamp_millis")}},{key:"setLastSuccessfulFetchTimestampMillis",value:function(e){return this.set("last_successful_fetch_timestamp_millis",e)}},{key:"getLastSuccessfulFetchResponse",value:function(){return this.get("last_successful_fetch_response")}},{key:"setLastSuccessfulFetchResponse",value:function(e){return this.set("last_successful_fetch_response",e)}},{key:"getActiveConfig",value:function(){return this.get("active_config")}},{key:"setActiveConfig",value:function(e){return this.set("active_config",e)}},{key:"getActiveConfigEtag",value:function(){return this.get("active_config_etag")}},{key:"setActiveConfigEtag",value:function(e){return this.set("active_config_etag",e)}},{key:"getThrottleMetadata",value:function(){return this.get("throttle_metadata")}},{key:"setThrottleMetadata",value:function(e){return this.set("throttle_metadata",e)}},{key:"deleteThrottleMetadata",value:function(){return this.delete("throttle_metadata")}},{key:"get",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.openDbPromise;case 2:return r=n.sent,n.abrupt("return",new Promise(function(n,i){var a=r.transaction([VU],"readonly").objectStore(VU),o=t.createCompositeKey(e);try{var s=a.get(o);s.onerror=function(e){i(BU(e,"storage-get"))},s.onsuccess=function(e){var t=e.target.result;n(t?t.value:void 0)}}catch(s){i(RU.create("storage-get",{originalErrorMessage:s&&s.message}))}}));case 4:case"end":return n.stop()}},n)}))()}},{key:"set",value:function(e,t){var n=this;return tB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.openDbPromise;case 2:return i=r.sent,r.abrupt("return",new Promise(function(r,a){var o=i.transaction([VU],"readwrite").objectStore(VU),s=n.createCompositeKey(e);try{var u=o.put({compositeKey:s,value:t});u.onerror=function(e){a(BU(e,"storage-set"))},u.onsuccess=function(){r()}}catch(u){a(RU.create("storage-set",{originalErrorMessage:u&&u.message}))}}));case 4:case"end":return r.stop()}},r)}))()}},{key:"delete",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.openDbPromise;case 2:return r=n.sent,n.abrupt("return",new Promise(function(n,i){var a=r.transaction([VU],"readwrite").objectStore(VU),o=t.createCompositeKey(e);try{var s=a.delete(o);s.onerror=function(e){i(BU(e,"storage-delete"))},s.onsuccess=function(){n()}}catch(s){i(RU.create("storage-delete",{originalErrorMessage:s&&s.message}))}}));case 4:case"end":return n.stop()}},n)}))()}},{key:"createCompositeKey",value:function(e){return[this.appId,this.appName,this.namespace,e].join()}}]),e}(),zU=function(){function e(t){tp(this,e),this.storage=t}return rp(e,[{key:"getLastFetchStatus",value:function(){return this.lastFetchStatus}},{key:"getLastSuccessfulFetchTimestampMillis",value:function(){return this.lastSuccessfulFetchTimestampMillis}},{key:"getActiveConfig",value:function(){return this.activeConfig}},{key:"loadFromStorage",value:function(){var e=this;return tB(regeneratorRuntime.mark(function t(){var n,r,i,a,o,s;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.storage.getLastFetchStatus(),r=e.storage.getLastSuccessfulFetchTimestampMillis(),i=e.storage.getActiveConfig(),t.next=5,n;case 5:return(a=t.sent)&&(e.lastFetchStatus=a),t.next=9,r;case 9:return(o=t.sent)&&(e.lastSuccessfulFetchTimestampMillis=o),t.next=13,i;case 13:(s=t.sent)&&(e.activeConfig=s);case 15:case"end":return t.stop()}},t)}))()}},{key:"setLastFetchStatus",value:function(e){return this.lastFetchStatus=e,this.storage.setLastFetchStatus(e)}},{key:"setLastSuccessfulFetchTimestampMillis",value:function(e){return this.lastSuccessfulFetchTimestampMillis=e,this.storage.setLastSuccessfulFetchTimestampMillis(e)}},{key:"setActiveConfig",value:function(e){return this.activeConfig=e,this.storage.setActiveConfig(e)}}]),e}();function HU(){return(HU=tB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(SB()){e.next=2;break}return e.abrupt("return",!1);case 2:return e.prev=2,e.next=5,PB();case 5:return e.abrupt("return",e.sent);case 8:return e.prev=8,e.t0=e.catch(2),e.abrupt("return",!1);case 11:case"end":return e.stop()}},e,null,[[2,8]])}))).apply(this,arguments)}pV(new KB("remote-config",function(e,t){var n=t.instanceIdentifier,r=e.getProvider("app").getImmediate(),i=e.getProvider("installations-internal").getImmediate();if("undefined"==typeof window)throw RU.create("registration-window");if(!SB())throw RU.create("indexed-db-unavailable");var a=r.options,o=a.projectId,s=a.apiKey,u=a.appId;if(!o)throw RU.create("registration-project-id");if(!s)throw RU.create("registration-api-key");if(!u)throw RU.create("registration-app-id");var c=new UU(u,r.name,n=n||"firebase"),l=new zU(c),h=new oV(AU);h.logLevel=tV.ERROR;var f=new DU(i,kV,n,o,s,u),d=new LU(f,c),v=new NU(d,c,l,h),p=new FU(r,v,l,c,h);return function(e){var t=YB(e);t._initializePromise||(t._initializePromise=t._storageCache.loadFromStorage().then(function(){t._isInitializationComplete=!0}))}(p),p},"PUBLIC").setMultipleInstances(!0)),CV(AU,"0.3.4"),CV(AU,"0.3.4","esm2017");var GU="/firebase-messaging-sw.js",qU="/firebase-cloud-messaging-push-scope",$U="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",WU="google.c.a.c_id",jU="google.c.a.c_l",ZU="google.c.a.ts",YU="google.c.a.e",KU=(function(e){e.PUSH_RECEIVED="push-received",e.NOTIFICATION_CLICKED="notification-clicked"}(KU||(KU={})),KU);function JU(e){var t=new Uint8Array(e);return btoa(String.fromCharCode.apply(String,Kv(t))).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function QU(e){for(var t=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),n=atob(t),r=new Uint8Array(n.length),i=0;i<n.length;++i)r[i]=n.charCodeAt(i);return r}var XU="fcm_token_details_db",ez="fcm_token_object_Store";function tz(e){return nz.apply(this,arguments)}function nz(){return(nz=tB(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0="databases"in indexedDB,!e.t0){e.next=5;break}return e.next=4,indexedDB.databases();case 4:e.t0=!e.sent.map(function(e){return e.name}).includes(XU);case 5:if(!e.t0){e.next=7;break}return e.abrupt("return",null);case 7:return n=null,e.next=10,(0,bV.openDb)(XU,5,function(){var e=tB(regeneratorRuntime.mark(function e(r){var i,a,o,s,u,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r.oldVersion<2)&&r.objectStoreNames.contains(ez)){e.next=2;break}return e.abrupt("return");case 2:return a=r.transaction.objectStore(ez),e.next=5,a.index("fcmSenderId").get(t);case 5:return o=e.sent,e.next=8,a.clear();case 8:if(!o){e.next=17;break}if(2!==r.oldVersion){e.next=16;break}if((s=o).auth&&s.p256dh&&s.endpoint){e.next=13;break}return e.abrupt("return");case 13:n={token:s.fcmToken,createTime:null!==(i=s.createTime)&&void 0!==i?i:Date.now(),subscriptionOptions:{auth:s.auth,p256dh:s.p256dh,endpoint:s.endpoint,swScope:s.swScope,vapidKey:"string"==typeof s.vapidKey?s.vapidKey:JU(s.vapidKey)}},e.next=17;break;case 16:3===r.oldVersion?n={token:(u=o).fcmToken,createTime:u.createTime,subscriptionOptions:{auth:JU(u.auth),p256dh:JU(u.p256dh),endpoint:u.endpoint,swScope:u.swScope,vapidKey:JU(u.vapidKey)}}:4===r.oldVersion&&(n={token:(c=o).fcmToken,createTime:c.createTime,subscriptionOptions:{auth:JU(c.auth),p256dh:JU(c.p256dh),endpoint:c.endpoint,swScope:c.swScope,vapidKey:JU(c.vapidKey)}});case 17:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());case 10:return e.sent.close(),e.next=13,(0,bV.deleteDb)(XU);case 13:return e.next=15,(0,bV.deleteDb)("fcm_vapid_details_db");case 15:return e.next=17,(0,bV.deleteDb)("undefined");case 17:return e.abrupt("return",rz(n)?n:null);case 18:case"end":return e.stop()}},e)}))).apply(this,arguments)}function rz(e){if(!e||!e.subscriptionOptions)return!1;var t=e.subscriptionOptions;return"number"==typeof e.createTime&&e.createTime>0&&"string"==typeof e.token&&e.token.length>0&&"string"==typeof t.auth&&t.auth.length>0&&"string"==typeof t.p256dh&&t.p256dh.length>0&&"string"==typeof t.endpoint&&t.endpoint.length>0&&"string"==typeof t.swScope&&t.swScope.length>0&&"string"==typeof t.vapidKey&&t.vapidKey.length>0}var iz="firebase-messaging-store",az=null;function oz(){return az||(az=(0,bV.openDb)("firebase-messaging-database",1,function(e){switch(e.oldVersion){case 0:e.createObjectStore(iz)}})),az}function sz(e){return uz.apply(this,arguments)}function uz(){return(uz=tB(regeneratorRuntime.mark(function e(t){var n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=dz(t),e.next=3,oz();case 3:return e.next=5,e.sent.transaction(iz).objectStore(iz).get(n);case 5:if(!(r=e.sent)){e.next=8;break}return e.abrupt("return",r);case 8:return e.next=10,tz(t.appConfig.senderId);case 10:if(!(i=e.sent)){e.next=15;break}return e.next=14,cz(t,i);case 14:return e.abrupt("return",i);case 15:case"end":return e.stop()}},e)}))).apply(this,arguments)}function cz(e,t){return lz.apply(this,arguments)}function lz(){return(lz=tB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=dz(t),e.next=3,oz();case 3:return i=e.sent.transaction(iz,"readwrite"),e.next=6,i.objectStore(iz).put(n,r);case 6:return e.next=8,i.complete;case 8:return e.abrupt("return",n);case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}function hz(e){return fz.apply(this,arguments)}function fz(){return(fz=tB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=dz(t),e.next=3,oz();case 3:return r=e.sent.transaction(iz,"readwrite"),e.next=6,r.objectStore(iz).delete(n);case 6:return e.next=8,r.complete;case 8:case"end":return e.stop()}},e)}))).apply(this,arguments)}function dz(e){return e.appConfig.appId}var vz=new IB("messaging","Messaging",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."});function pz(e,t){return gz.apply(this,arguments)}function gz(){return(gz=tB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Cz(t);case 2:return r=e.sent,i=Ez(n),a={method:"POST",headers:r,body:JSON.stringify(i)},e.prev=5,e.next=8,fetch(wz(t.appConfig),a);case 8:return e.next=10,e.sent.json();case 10:o=e.sent,e.next=16;break;case 13:throw e.prev=13,e.t0=e.catch(5),vz.create("token-subscribe-failed",{errorInfo:e.t0});case 16:if(!o.error){e.next=18;break}throw vz.create("token-subscribe-failed",{errorInfo:o.error.message});case 18:if(o.token){e.next=20;break}throw vz.create("token-subscribe-no-token");case 20:return e.abrupt("return",o.token);case 21:case"end":return e.stop()}},e,null,[[5,13]])}))).apply(this,arguments)}function yz(e,t){return mz.apply(this,arguments)}function mz(){return(mz=tB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Cz(t);case 2:return r=e.sent,i=Ez(n.subscriptionOptions),a={method:"PATCH",headers:r,body:JSON.stringify(i)},e.prev=5,e.next=8,fetch("".concat(wz(t.appConfig),"/").concat(n.token),a);case 8:return e.next=10,e.sent.json();case 10:o=e.sent,e.next=16;break;case 13:throw e.prev=13,e.t0=e.catch(5),vz.create("token-update-failed",{errorInfo:e.t0});case 16:if(!o.error){e.next=18;break}throw vz.create("token-update-failed",{errorInfo:o.error.message});case 18:if(o.token){e.next=20;break}throw vz.create("token-update-no-token");case 20:return e.abrupt("return",o.token);case 21:case"end":return e.stop()}},e,null,[[5,13]])}))).apply(this,arguments)}function kz(e,t){return _z.apply(this,arguments)}function _z(){return(_z=tB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Cz(t);case 2:return e.t0=e.sent,r={method:"DELETE",headers:e.t0},e.prev=4,e.next=7,fetch("".concat(wz(t.appConfig),"/").concat(n),r);case 7:return e.next=9,e.sent.json();case 9:if(!(i=e.sent).error){e.next=12;break}throw vz.create("token-unsubscribe-failed",{errorInfo:i.error.message});case 12:e.next=17;break;case 14:throw e.prev=14,e.t1=e.catch(4),vz.create("token-unsubscribe-failed",{errorInfo:e.t1});case 17:case"end":return e.stop()}},e,null,[[4,14]])}))).apply(this,arguments)}function wz(e){var t=e.projectId;return"https://fcmregistrations.googleapis.com/v1/projects/".concat(t,"/registrations")}function Cz(e){return bz.apply(this,arguments)}function bz(){return(bz=tB(regeneratorRuntime.mark(function e(t){var n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.appConfig,r=t.installations,e.next=3,r.getToken();case 3:return i=e.sent,e.abrupt("return",new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n.apiKey,"x-goog-firebase-installations-auth":"FIS ".concat(i)}));case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Ez(e){var t=e.p256dh,n=e.auth,r=e.endpoint,i=e.vapidKey,a={web:{endpoint:r,auth:n,p256dh:t}};return i!==$U&&(a.web.applicationPubKey=i),a}function Sz(e){return Pz.apply(this,arguments)}function Pz(){return(Pz=tB(regeneratorRuntime.mark(function e(t){var n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Nz(t.swRegistration,t.vapidKey);case 2:return n=e.sent,r={vapidKey:t.vapidKey,swScope:t.swRegistration.scope,endpoint:n.endpoint,auth:JU(n.getKey("auth")),p256dh:JU(n.getKey("p256dh"))},e.next=6,sz(t.firebaseDependencies);case 6:if(!(i=e.sent)){e.next=19;break}if(!Dz(i.subscriptionOptions,r)){e.next=10;break}return e.abrupt("return",Date.now()>=i.createTime+6048e5?Iz(t,{token:i.token,createTime:Date.now(),subscriptionOptions:r}):i.token);case 10:return e.prev=10,e.next=13,kz(t.firebaseDependencies,i.token);case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(10),console.warn(e.t0);case 18:case 19:return e.abrupt("return",Az(t.firebaseDependencies,r));case 20:case"end":return e.stop()}},e,null,[[10,15]])}))).apply(this,arguments)}function Oz(e){return Tz.apply(this,arguments)}function Tz(){return(Tz=tB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,sz(t.firebaseDependencies);case 2:if(n=e.sent,e.t0=n,!e.t0){e.next=9;break}return e.next=7,kz(t.firebaseDependencies,n.token);case 7:return e.next=9,hz(t.firebaseDependencies);case 9:return e.next=11,t.swRegistration.pushManager.getSubscription();case 11:return r=e.sent,e.abrupt("return",!r||r.unsubscribe());case 13:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Iz(e,t){return xz.apply(this,arguments)}function xz(){return(xz=tB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,yz(t.firebaseDependencies,n);case 3:return r=e.sent,i=Object.assign(Object.assign({},n),{token:r,createTime:Date.now()}),e.next=7,cz(t.firebaseDependencies,i);case 7:return e.abrupt("return",r);case 10:return e.prev=10,e.t0=e.catch(0),e.next=14,Oz(t);case 14:throw e.t0;case 15:case"end":return e.stop()}},e,null,[[0,10]])}))).apply(this,arguments)}function Az(e,t){return Rz.apply(this,arguments)}function Rz(){return(Rz=tB(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,pz(t,n);case 2:return e.t0=e.sent,e.t1=Date.now(),e.t2=n,r={token:e.t0,createTime:e.t1,subscriptionOptions:e.t2},e.next=8,cz(t,r);case 8:return e.abrupt("return",r.token);case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Nz(e,t){return Mz.apply(this,arguments)}function Mz(){return(Mz=tB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.pushManager.getSubscription();case 2:if(e.t0=e.sent,e.t0){e.next=5;break}e.t0=t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:QU(n)});case 5:return e.abrupt("return",e.t0);case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Dz(e,t){return t.vapidKey===e.vapidKey&&t.endpoint===e.endpoint&&t.auth===e.auth&&t.p256dh===e.p256dh}function Lz(e){var t={from:e.from,collapseKey:e.collapse_key,messageId:e.fcmMessageId};return function(e,t){if(t.notification){e.notification={};var n=t.notification.title;n&&(e.notification.title=n);var r=t.notification.body;r&&(e.notification.body=r);var i=t.notification.image;i&&(e.notification.image=i)}}(t,e),function(e,t){!t.data||(e.data=t.data)}(t,e),function(e,t){if(t.fcmOptions){e.fcmOptions={};var n=t.fcmOptions.link;n&&(e.fcmOptions.link=n);var r=t.fcmOptions.analytics_label;r&&(e.fcmOptions.analyticsLabel=r)}}(t,e),t}function Fz(e){return"object"==typeof e&&!!e&&WU in e}function Bz(e,t){for(var n=[],r=0;r<e.length;r++)n.push(e.charAt(r)),r<t.length&&n.push(t.charAt(r));return n.join("")}function Vz(e){return vz.create("missing-app-config-values",{valueName:e})}Bz("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),Bz("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");var Uz=function(){function e(t,n,r){tp(this,e),this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;var i=function(e){if(!e||!e.options)throw Vz("App Configuration Object");if(!e.name)throw Vz("App Name");for(var t=e.options,n=0,r=["projectId","apiKey","appId","messagingSenderId"];n<r.length;n++){var i=r[n];if(!t[i])throw Vz(i)}return{appName:e.name,projectId:t.projectId,apiKey:t.apiKey,appId:t.appId,senderId:t.messagingSenderId}}(t);this.firebaseDependencies={app:t,appConfig:i,installations:n,analyticsProvider:r}}return rp(e,[{key:"_delete",value:function(){return Promise.resolve()}}]),e}();function zz(e){return Hz.apply(this,arguments)}function Hz(){return(Hz=tB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.serviceWorker.register(GU,{scope:qU});case 3:t.swRegistration=e.sent,t.swRegistration.update().catch(function(){}),e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(0),vz.create("failed-service-worker-registration",{browserErrorMessage:e.t0.message});case 10:case"end":return e.stop()}},e,null,[[0,7]])}))).apply(this,arguments)}function Gz(e,t){return qz.apply(this,arguments)}function qz(){return(qz=tB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=!n&&!t.swRegistration,!e.t0){e.next=4;break}return e.next=4,zz(t);case 4:if(!n&&t.swRegistration){e.next=8;break}if(n instanceof ServiceWorkerRegistration){e.next=7;break}throw vz.create("invalid-sw-registration");case 7:t.swRegistration=n;case 8:case"end":return e.stop()}},e)}))).apply(this,arguments)}function $z(e,t){return Wz.apply(this,arguments)}function Wz(){return(Wz=tB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n?t.vapidKey=n:t.vapidKey||(t.vapidKey=$U);case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function jz(){return(jz=tB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(navigator){e.next=2;break}throw vz.create("only-available-in-window");case 2:if(e.t0="default"===Notification.permission,!e.t0){e.next=6;break}return e.next=6,Notification.requestPermission();case 6:if("granted"===Notification.permission){e.next=8;break}throw vz.create("permission-blocked");case 8:return e.next=10,$z(t,null==n?void 0:n.vapidKey);case 10:return e.next=12,Gz(t,null==n?void 0:n.serviceWorkerRegistration);case 12:return e.abrupt("return",Sz(t));case 13:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Zz(e,t,n){return Yz.apply(this,arguments)}function Yz(){return(Yz=tB(regeneratorRuntime.mark(function e(t,n,r){var i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=Kz(n),e.next=3,t.firebaseDependencies.analyticsProvider.get();case 3:e.sent.logEvent(i,{message_id:r[WU],message_name:r[jU],message_time:r[ZU],message_device_time:Math.floor(Date.now()/1e3)});case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Kz(e){switch(e){case KU.NOTIFICATION_CLICKED:return"notification_open";case KU.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}function Jz(){return(Jz=tB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((r=n.data).isFirebaseMessaging){e.next=3;break}return e.abrupt("return");case 3:if(t.onMessageHandler&&r.messageType===KU.PUSH_RECEIVED&&("function"==typeof t.onMessageHandler?t.onMessageHandler(Lz(r)):t.onMessageHandler.next(Lz(r))),i=r.data,e.t0=Fz(i)&&"1"===i[YU],!e.t0){e.next=9;break}return e.next=9,Zz(t,r.messageType,i);case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}var Qz="@firebase/messaging";function Xz(){return(Xz=tB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,PB();case 3:e.next=8;break;case 5:return e.prev=5,e.t0=e.catch(0),e.abrupt("return",!1);case 8:return e.abrupt("return","undefined"!=typeof window&&SB()&&OB()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey"));case 9:case"end":return e.stop()}},e,null,[[0,5]])}))).apply(this,arguments)}pV(new KB("messaging",function(e){var t=new Uz(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),e.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",function(e){return function(e,t){return Jz.apply(this,arguments)}(t,e)}),t},"PUBLIC")),pV(new KB("messaging-internal",function(e){var t=e.getProvider("messaging").getImmediate();return{getToken:function(e){return function(e,t){return jz.apply(this,arguments)}(t,e)}}},"PRIVATE")),CV(Qz,"0.9.8"),CV(Qz,"0.9.8","esm2017");var eH="analytics",tH="firebase_id",nH="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",rH="https://www.googletagmanager.com/gtag/js",iH=new oV("@firebase/analytics");function aH(e){return Promise.all(e.map(function(e){return e.catch(function(e){return e})}))}function oH(e,t){var n=document.createElement("script");n.src="".concat(rH,"?l=").concat(e,"&id=").concat(t),n.async=!0,document.head.appendChild(n)}function sH(e,t,n,r,i,a){return uH.apply(this,arguments)}function uH(){return(uH=tB(regeneratorRuntime.mark(function e(t,n,r,i,a,o){var s,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(s=i[a],e.prev=1,!s){e.next=7;break}return e.next=5,n[s];case 5:e.next=14;break;case 7:return e.next=9,aH(r);case 9:if(u=e.sent.find(function(e){return e.measurementId===a}),e.t0=u,!e.t0){e.next=14;break}return e.next=14,n[u.appId];case 14:e.next=19;break;case 16:e.prev=16,e.t1=e.catch(1),iH.error(e.t1);case 19:t("config",a,o);case 20:case"end":return e.stop()}},e,null,[[1,16]])}))).apply(this,arguments)}function cH(e,t,n,r,i){return lH.apply(this,arguments)}function lH(){return(lH=tB(regeneratorRuntime.mark(function e(t,n,r,i,a){var o,s,u,c,l,h;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,o=[],!a||!a.send_to){e.next=26;break}return s=a.send_to,Array.isArray(s)||(s=[s]),e.next=7,aH(r);case 7:u=e.sent,c=Qv(s),e.prev=9,h=function(){var e=l.value,t=u.find(function(t){return t.measurementId===e}),r=t&&n[t.appId];if(!r)return o=[],"break";o.push(r)},c.s();case 12:if((l=c.n()).done){e.next=18;break}if("break"!==h()){e.next=16;break}return e.abrupt("break",18);case 16:e.next=12;break;case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(9),c.e(e.t0);case 23:return e.prev=23,c.f(),e.finish(23);case 26:return 0===o.length&&(o=Object.values(n)),e.next=29,Promise.all(o);case 29:t("event",i,a||{}),e.next=35;break;case 32:e.prev=32,e.t1=e.catch(0),iH.error(e.t1);case 35:case"end":return e.stop()}},e,null,[[0,32],[9,20,23,26]])}))).apply(this,arguments)}function hH(){for(var e=window.document.getElementsByTagName("script"),t=0,n=Object.values(e);t<n.length;t++){var r=n[t];if(r.src&&r.src.includes(rH))return r}return null}var fH=new IB("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.'}),dH=new(function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;tp(this,e),this.throttleMetadata=t,this.intervalMillis=n}return rp(e,[{key:"getThrottleMetadata",value:function(e){return this.throttleMetadata[e]}},{key:"setThrottleMetadata",value:function(e,t){this.throttleMetadata[e]=t}},{key:"deleteThrottleMetadata",value:function(e){delete this.throttleMetadata[e]}}]),e}());function vH(e){return new Headers({Accept:"application/json","x-goog-api-key":e})}function pH(e){return gH.apply(this,arguments)}function gH(){return(gH=tB(regeneratorRuntime.mark(function e(t){var n,r,i,a,o,s,u,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.appId,i=t.apiKey,a={method:"GET",headers:vH(i)},o=nH.replace("{app-id}",r),e.next=6,fetch(o,a);case 6:if(200===(s=e.sent).status||304===s.status){e.next=19;break}return u="",e.prev=9,e.next=12,s.json();case 12:c=e.sent,(null===(n=c.error)||void 0===n?void 0:n.message)&&(u=c.error.message),e.next=18;break;case 16:e.prev=16,e.t0=e.catch(9);case 18:throw fH.create("config-fetch-failed",{httpStatus:s.status,responseMessage:u});case 19:return e.abrupt("return",s.json());case 20:case"end":return e.stop()}},e,null,[[9,16]])}))).apply(this,arguments)}function yH(e){return mH.apply(this,arguments)}function mH(){return(mH=tB(regeneratorRuntime.mark(function e(t){var n,r,i,a,o,s,u,c,l=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=l.length>1&&void 0!==l[1]?l[1]:dH,r=l.length>2?l[2]:void 0,i=t.options,a=i.appId,o=i.apiKey,s=i.measurementId,a){e.next=5;break}throw fH.create("no-app-id");case 5:if(o){e.next=9;break}if(!s){e.next=8;break}return e.abrupt("return",{measurementId:s,appId:a});case 8:throw fH.create("no-api-key");case 9:return u=n.getThrottleMetadata(a)||{backoffCount:0,throttleEndTimeMillis:Date.now()},c=new bH,e.abrupt("return",(setTimeout(tB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:c.abort();case 1:case"end":return e.stop()}},e)})),void 0!==r?r:6e4),kH({appId:a,apiKey:o,measurementId:s},u,c,n)));case 11:case"end":return e.stop()}},e)}))).apply(this,arguments)}function kH(e,t,n){return _H.apply(this,arguments)}function _H(){return(_H=tB(regeneratorRuntime.mark(function e(t,n,r){var i,a,o,s,u,c,l,h,f=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.throttleEndTimeMillis,a=n.backoffCount,o=f.length>3&&void 0!==f[3]?f[3]:dH,s=t.appId,u=t.measurementId,e.prev=3,e.next=6,wH(r,i);case 6:e.next=13;break;case 8:if(e.prev=8,e.t0=e.catch(3),!u){e.next=12;break}return e.abrupt("return",(iH.warn("Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ".concat(u,' provided in the "measurementId" field in the local Firebase config. [').concat(e.t0.message,"]")),{appId:s,measurementId:u}));case 12:throw e.t0;case 13:return e.prev=13,e.next=16,pH(t);case 16:return c=e.sent,e.abrupt("return",(o.deleteThrottleMetadata(s),c));case 20:if(e.prev=20,e.t1=e.catch(13),CH(e.t1)){e.next=26;break}if(o.deleteThrottleMetadata(s),!u){e.next=25;break}return e.abrupt("return",(iH.warn("Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ".concat(u,' provided in the "measurementId" field in the local Firebase config. [').concat(e.t1.message,"]")),{appId:s,measurementId:u}));case 25:throw e.t1;case 26:return l=503===Number(e.t1.customData.httpStatus)?ZB(a,o.intervalMillis,30):ZB(a,o.intervalMillis),h={throttleEndTimeMillis:Date.now()+l,backoffCount:a+1},e.abrupt("return",(o.setThrottleMetadata(s,h),iH.debug("Calling attemptFetch again in ".concat(l," millis")),kH(t,h,r,o)));case 28:case"end":return e.stop()}},e,null,[[3,8],[13,20]])}))).apply(this,arguments)}function wH(e,t){return new Promise(function(n,r){var i=Math.max(t-Date.now(),0),a=setTimeout(n,i);e.addEventListener(function(){clearTimeout(a),r(fH.create("fetch-throttle",{throttleEndTimeMillis:t}))})})}function CH(e){if(!(e instanceof TB&&e.customData))return!1;var t=Number(e.customData.httpStatus);return 429===t||500===t||503===t||504===t}var bH=function(){function e(){tp(this,e),this.listeners=[]}return rp(e,[{key:"addEventListener",value:function(e){this.listeners.push(e)}},{key:"abort",value:function(){this.listeners.forEach(function(e){return e()})}}]),e}();function EH(){return SH.apply(this,arguments)}function SH(){return(SH=tB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(SB()){e.next=2;break}return e.abrupt("return",(iH.warn(fH.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1));case 2:return e.prev=2,e.next=5,PB();case 5:e.next=10;break;case 7:return e.prev=7,e.t0=e.catch(2),e.abrupt("return",(iH.warn(fH.create("indexeddb-unavailable",{errorInfo:e.t0}).message),!1));case 10:return e.abrupt("return",!0);case 11:case"end":return e.stop()}},e,null,[[2,7]])}))).apply(this,arguments)}function PH(){return(PH=tB(regeneratorRuntime.mark(function e(t,n,r,i,a,o,s){var u,c,l,h,f,d,v,p;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(c=yH(t)).then(function(e){r[e.measurementId]=e.appId,t.options.measurementId&&e.measurementId!==t.options.measurementId&&iH.warn("The measurement ID in the local Firebase config (".concat(t.options.measurementId,") does not match the measurement ID fetched from the server (").concat(e.measurementId,"). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config."))}).catch(function(e){return iH.error(e)}),n.push(c),l=EH().then(function(e){if(e)return i.getId()}),e.next=5,Promise.all([c,l]);case 5:return h=e.sent,f=Lv(h,2),d=f[0],v=f[1],hH()||oH(o,d.measurementId),a("js",new Date),p=null!==(u=null==s?void 0:s.config)&&void 0!==u?u:{},e.abrupt("return",(p.origin="firebase",p.update=!0,null!=v&&(p[tH]=v),a("config",d.measurementId,p),d.measurementId));case 12:case"end":return e.stop()}},e)}))).apply(this,arguments)}var OH,TH,IH=function(){function e(t){tp(this,e),this.app=t}return rp(e,[{key:"_delete",value:function(){return delete xH[this.app.options.appId],Promise.resolve()}}]),e}(),xH={},AH=[],RH={},NH="dataLayer",MH=!1;function DH(){return(DH=tB(regeneratorRuntime.mark(function e(t,n,r,i,a){var o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!a||!a.global){e.next=4;break}t("event",r,i),e.next=8;break;case 4:return e.next=6,n;case 6:o=e.sent,t("event",r,Object.assign(Object.assign({},i),{send_to:o}));case 8:case"end":return e.stop()}},e)}))).apply(this,arguments)}function LH(){return(LH=tB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!CB()&&OB()&&SB()){e.next=2;break}return e.abrupt("return",!1);case 2:return e.prev=2,e.next=5,PB();case 5:return e.abrupt("return",e.sent);case 8:return e.prev=8,e.t0=e.catch(2),e.abrupt("return",!1);case 11:case"end":return e.stop()}},e,null,[[2,8]])}))).apply(this,arguments)}var FH="@firebase/analytics";pV(new KB(eH,function(e,t){var n=t.options;return function(e,t,n){!function(){var e=[];if(CB()&&e.push("This is a browser extension environment."),OB()||e.push("Cookies are not available."),e.length>0){var t=e.map(function(e,t){return"(".concat(t+1,") ").concat(e)}).join(" "),n=fH.create("invalid-analytics-context",{errorInfo:t});iH.warn(n.message)}}();var r=e.options.appId;if(!r)throw fH.create("no-app-id");if(!e.options.apiKey){if(!e.options.measurementId)throw fH.create("no-api-key");iH.warn('The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID '.concat(e.options.measurementId,' provided in the "measurementId" field in the local Firebase config.'))}if(null!=xH[r])throw fH.create("already-exists",{id:r});if(!MH){!function(e){var t=[];Array.isArray(window[e])?t=window[e]:window[e]=t}(NH);var i=function(e,t,n,r,i){var a=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];window[r].push(arguments)};return window[i]&&"function"==typeof window[i]&&(a=window[i]),window[i]=function(e,t,n,r){function i(){return(i=tB(regeneratorRuntime.mark(function i(a,o,s){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(i.prev=0,"event"!==a){i.next=6;break}return i.next=4,cH(e,t,n,o,s);case 4:i.next=12;break;case 6:if("config"!==a){i.next=11;break}return i.next=9,sH(e,t,n,r,o,s);case 9:i.next=12;break;case 11:e("set",o);case 12:i.next=17;break;case 14:i.prev=14,i.t0=i.catch(0),iH.error(i.t0);case 17:case"end":return i.stop()}},i,null,[[0,14]])}))).apply(this,arguments)}return function(e,t,n){return i.apply(this,arguments)}}(a,e,t,n),{gtagCore:a,wrappedGtag:window[i]}}(xH,AH,RH,NH,"gtag"),a=i.wrappedGtag,o=i.gtagCore;TH=a,OH=o,MH=!0}return xH[r]=function(e,t,n,r,i,a,o){return PH.apply(this,arguments)}(e,AH,RH,t,OH,NH,n),new IH(e)}(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),n)},"PUBLIC")),pV(new KB("analytics-internal",function(e){try{var t=e.getProvider(eH).getImmediate();return{logEvent:function(e,n,r){return function(e,t,n,r){e=YB(e),function(e,t,n,r,i){return DH.apply(this,arguments)}(TH,xH[e.app.options.appId],t,n,r).catch(function(e){return iH.error(e)})}(t,e,n,r)}}}catch(t){throw fH.create("interop-component-reg-failed",{reason:t})}},"PRIVATE")),CV(FH,"0.7.5"),CV(FH,"0.7.5","esm2017");var BH=function(e){Gv(n,e);var t=$v(n);function n(e,r){return tp(this,n),t.call(this)}return rp(n,[{key:"schedule",value:function(e){return this}}]),n}(ip),VH={setInterval:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){var e=VH.delegate;return((null==e?void 0:e.setInterval)||setInterval).apply(void 0,arguments)}),clearInterval:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){var t=VH.delegate;return((null==t?void 0:t.clearInterval)||clearInterval)(e)}),delegate:void 0},UH=function(e){Gv(n,e);var t=$v(n);function n(e,r){var i;return tp(this,n),(i=t.call(this,e,r)).scheduler=e,i.work=r,i.pending=!1,i}return rp(n,[{key:"schedule",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(this.closed)return this;this.state=e;var n=this.id,r=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(r,n,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(r,this.id,t),this}},{key:"requestAsyncId",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return VH.setInterval(e.flush.bind(e,this),n)}},{key:"recycleAsyncId",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(null!=n&&this.delay===n&&!1===this.pending)return t;VH.clearInterval(t)}},{key:"execute",value:function(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}},{key:"_execute",value:function(e,t){var n,r=!1;try{this.work(e)}catch(i){r=!0,n=i||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),n}},{key:"unsubscribe",value:function(){if(!this.closed){var e=this.id,t=this.scheduler,r=t.actions;this.work=this.state=this.scheduler=null,this.pending=!1,ep(r,this),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,zv(Yv(n.prototype),"unsubscribe",this).call(this)}}}]),n}(BH),zH={now:function(){return(zH.delegate||Date).now()},delegate:void 0},HH=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.now;tp(this,e),this.schedulerActionCtor=t,this.now=n}return rp(e,[{key:"schedule",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0;return new this.schedulerActionCtor(this,e).schedule(n,t)}}]),e}();HH.now=zH.now;var GH=function(e){Gv(n,e);var t=$v(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:HH.now;return tp(this,n),(r=t.call(this,e,i)).actions=[],r._active=!1,r._scheduled=void 0,r}return rp(n,[{key:"flush",value:function(e){var t=this.actions;if(this._active)t.push(e);else{var n;this._active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}}}]),n}(HH),qH=new(function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n)}(GH))(function(e){Gv(n,e);var t=$v(n);function n(e,r){var i;return tp(this,n),(i=t.call(this,e,r)).scheduler=e,i.work=r,i}return rp(n,[{key:"schedule",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t>0?zv(Yv(n.prototype),"schedule",this).call(this,e,t):(this.delay=t,this.state=e,this.scheduler.flush(this),this)}},{key:"execute",value:function(e,t){return t>0||this.closed?zv(Yv(n.prototype),"execute",this).call(this,e,t):this._execute(e,t)}},{key:"requestAsyncId",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return null!=r&&r>0||null==r&&this.delay>0?zv(Yv(n.prototype),"requestAsyncId",this).call(this,e,t,r):e.flush(this)}}]),n}(UH)),$H=new GH(UH),WH=new cS("7.2.0"),jH="__angularfire_symbol__analyticsIsSupported",ZH="__angularfire_symbol__remoteConfigIsSupported",YH="__angularfire_symbol__messagingIsSupported";function KH(e,t,n){if(t){if(1===t.length)return t[0];var r=t.filter(function(e){return e.app===n});if(1===r.length)return r[0]}return n.container.getProvider(e).getImmediate({optional:!0})}globalThis[jH]||(globalThis[jH]=function(){return LH.apply(this,arguments)}().then(function(e){return globalThis.__angularfire_symbol__analyticsIsSupportedValue=e})),globalThis[YH]||(globalThis[YH]=function(){return Xz.apply(this,arguments)}().then(function(e){return globalThis.__angularfire_symbol__messagingIsSupportedValue=e})),globalThis[ZH]||(globalThis[ZH]=function(){return HU.apply(this,arguments)}().then(function(e){return globalThis.__angularfire_symbol__remoteConfigIsSupportedValue=e}));var JH=function(e,t){var n=t?[t]:wV(),r=[];return n.forEach(function(t){t.container.getProvider(e).instances.forEach(function(e){r.includes(e)||r.push(e)})}),r};function QH(){}var XH=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:qH;tp(this,e),this.zone=t,this.delegate=n}return rp(e,[{key:"now",value:function(){return this.delegate.now()}},{key:"schedule",value:function(e,t,n){var r=this.zone;return this.delegate.schedule(function(t){var n=this;r.runGuarded(function(){e.apply(n,[t])})},t,n)}}]),e}(),eG=function(){function e(t){tp(this,e),this.zone=t,this.task=null}return rp(e,[{key:"call",value:function(e,t){var n=this.unscheduleTask.bind(this);return this.task=this.zone.run(function(){return Zone.current.scheduleMacroTask("firebaseZoneBlock",QH,{},QH,QH)}),t.pipe(vR({next:n,complete:n,error:n})).subscribe(e).add(n)}},{key:"unscheduleTask",value:function(){var e=this;setTimeout(function(){null!=e.task&&"scheduled"===e.task.state&&(e.task.invoke(),e.task=null)},10)}}]),e}(),tG=function(){var e=rp(function e(t){tp(this,e),this.ngZone=t,this.outsideAngular=t.runOutsideAngular(function(){return new XH(Zone.current)}),this.insideAngular=t.run(function(){return new XH(Zone.current,$H)}),globalThis.\u0275AngularFireScheduler||(globalThis.\u0275AngularFireScheduler=this)});return e.\u0275fac=function(t){return new(t||e)(Pk(YP))},e.\u0275prov=Eg({token:e,factory:e.\u0275fac,providedIn:"root"}),e}();function nG(){var e=globalThis.\u0275AngularFireScheduler;if(!e)throw new Error("Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using\nprovideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).");return e}function rG(e){return nG().ngZone.runOutsideAngular(function(){return e()})}function iG(e){return nG().ngZone.run(function(){return e()})}function aG(e){return nG(),function(e){return function(t){return(t=t.lift(new eG(e.ngZone))).pipe(og(e.outsideAngular),ag(e.insideAngular))}}(nG())(e)}var oG=function(e,t){var n=void 0;return function(){var r=arguments;return t&&setTimeout(function(){"scheduled"===t.state&&t.invoke()},10),iG(function(){return e.apply(n,r)})}},sG=function(e,t){return function(){for(var n,r=arguments,i=this,a=0;a<arguments.length;a++)"function"==typeof arguments[a]&&(t&&(n||(n=iG(function(){return Zone.current.scheduleMacroTask("firebaseZoneBlock",QH,{},QH,QH)}))),arguments[a]=oG(arguments[a],n));var o=rG(function(){return e.apply(i,r)});if(!t){if(o instanceof Tp){var s=nG();return o.pipe(og(s.outsideAngular),ag(s.insideAngular))}return iG(function(){return o})}return o instanceof Tp?o.pipe(aG):o instanceof Promise?iG(function(){return new Promise(function(e,t){return o.then(function(t){return iG(function(){return e(t)})},function(e){return iG(function(){return t(e)})})})}):"function"==typeof o&&n?function(){return setTimeout(function(){n&&"scheduled"===n.state&&n.invoke()},10),o.apply(this,arguments)}:iG(function(){return o})}},uG=rp(function e(t){return tp(this,e),t}),cG=rp(function e(){return tp(this,e),wV()}),lG=new ok("angularfire2._apps"),hG={provide:uG,useFactory:function(e){return e&&1===e.length?e[0]:new uG(_V())},deps:[[new Mk,lG]]},fG={provide:cG,deps:[[new Mk,lG]]};function dG(e){return function(t,n){var r=t.runOutsideAngular(function(){return e(n)});return new uG(r)}}var vG=function(){var e=rp(function e(t){tp(this,e),CV("angularfire",WH.full,"core"),CV("angularfire",WH.full,"app"),CV("angular",lS.full,t.toString())});return e.\u0275fac=function(t){return new(t||e)(Pk(MP))},e.\u0275mod=iy({type:e}),e.\u0275inj=Sg({providers:[hG,fG]}),e}(),pG=sG(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};"object"!=typeof t&&(t={name:t});var n=Object.assign({name:lV,automaticDataCollectionEnabled:!1},t),r=n.name;if("string"!=typeof r||!r)throw yV.create("bad-app-name",{appName:String(r)});var i=fV.get(r);if(i){if(BB(e,i.options)&&BB(n,i.config))return i;throw yV.create("duplicate-app",{appName:r})}var a,o=new XB(r),s=Qv(dV.values());try{for(s.s();!(a=s.n()).done;){var u=a.value;o.addComponent(u)}}catch(l){s.e(l)}finally{s.f()}var c=new mV(e,n,o);return fV.set(r,c),c},!0),gG=new Map,yG={activated:!1,tokenObservers:[]},mG={initialized:!1,enabled:!1};function kG(e){return gG.get(e)||yG}function _G(e,t){gG.set(e,t)}function wG(){return mG}var CG=function(){function e(t,n,r,i,a){if(tp(this,e),this.operation=t,this.retryPolicy=n,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=a,this.pending=null,this.nextErrorWaitInterval=i,i>a)throw new Error("Proactive refresh lower bound greater than upper bound!")}return rp(e,[{key:"start",value:function(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(function(){})}},{key:"stop",value:function(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}},{key:"isRunning",value:function(){return!!this.pending}},{key:"process",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t.stop(),n.prev=1,t.pending=new mB,n.next=5,function(e){return new Promise(function(t){setTimeout(t,e)})}(t.getNextRun(e));case 5:return t.pending.resolve(),n.next=8,t.pending.promise;case 8:return t.pending=new mB,n.next=11,t.operation();case 11:return t.pending.resolve(),n.next=14,t.pending.promise;case 14:t.process(!0).catch(function(){}),n.next=20;break;case 17:n.prev=17,n.t0=n.catch(1),t.retryPolicy(n.t0)?t.process(!1).catch(function(){}):t.stop();case 20:case"end":return n.stop()}},n,null,[[1,17]])}))()}},{key:"getNextRun",value:function(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();var t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}]),e}(),bG=new IB("appCheck","AppCheck",{"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"});function EG(e){if(!kG(e).activated)throw bG.create("use-before-activation",{appName:e.name})}function SG(e,t){return PG.apply(this,arguments)}function PG(){return(PG=tB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s,u,c,l,h,f;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.url,i=t.body,a={"Content-Type":"application/json"},(o=n.getImmediate({optional:!0}))&&(a["X-Firebase-Client"]=o.getPlatformInfoString()),s={method:"POST",body:JSON.stringify(i),headers:a},e.prev=4,e.next=7,fetch(r,s);case 7:u=e.sent,e.next=13;break;case 10:throw e.prev=10,e.t0=e.catch(4),bG.create("fetch-network-error",{originalErrorMessage:e.t0.message});case 13:if(200===u.status){e.next=15;break}throw bG.create("fetch-status-error",{httpStatus:u.status});case 15:return e.prev=15,e.next=18,u.json();case 18:c=e.sent,e.next=24;break;case 21:throw e.prev=21,e.t1=e.catch(15),bG.create("fetch-parse-error",{originalErrorMessage:e.t1.message});case 24:if((l=c.ttl.match(/^([\d.]+)(s)$/))&&l[2]&&!isNaN(Number(l[1]))){e.next=27;break}throw bG.create("fetch-parse-error",{originalErrorMessage:"ttl field (timeToLive) is not in standard Protobuf Duration format: ".concat(c.ttl)});case 27:return h=1e3*Number(l[1]),f=Date.now(),e.abrupt("return",{token:c.attestationToken,expireTimeMillis:f+h,issuedAtTimeMillis:f});case 29:case"end":return e.stop()}},e,null,[[4,10],[15,21]])}))).apply(this,arguments)}function OG(e,t){var n=e.options,r=n.projectId,i=n.appId,a=n.apiKey;return{url:"https://content-firebaseappcheck.googleapis.com/v1beta/projects/".concat(r,"/apps/").concat(i,":exchangeDebugToken?key=").concat(a),body:{debug_token:t}}}var TG="firebase-app-check-store",IG=null;function xG(){return IG||(IG=new Promise(function(e,t){try{var n=indexedDB.open("firebase-app-check-database",1);n.onsuccess=function(t){e(t.target.result)},n.onerror=function(e){var n;t(bG.create("storage-open",{originalErrorMessage:null===(n=e.target.error)||void 0===n?void 0:n.message}))},n.onupgradeneeded=function(e){var t=e.target.result;switch(e.oldVersion){case 0:t.createObjectStore(TG,{keyPath:"compositeKey"})}}}catch(n){t(bG.create("storage-open",{originalErrorMessage:n.message}))}}))}function AG(){return(AG=tB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,xG();case 2:return r=e.sent.transaction(TG,"readwrite"),i=r.objectStore(TG).put({compositeKey:t,value:n}),e.abrupt("return",new Promise(function(e,t){i.onsuccess=function(t){e()},r.onerror=function(e){var n;t(bG.create("storage-set",{originalErrorMessage:null===(n=e.target.error)||void 0===n?void 0:n.message}))}}));case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}var RG=new oV("@firebase/app-check");function NG(e,t){return SB()?function(e,t){return function(e,t){return AG.apply(this,arguments)}(function(e){return"".concat(e.options.appId,"-").concat(e.name)}(e),t)}(e,t).catch(function(e){RG.warn("Failed to write token to IndexedDB. Error: ".concat(e))}):Promise.resolve()}function MG(){return wG().enabled}function DG(){return LG.apply(this,arguments)}function LG(){return(LG=tB(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=wG()).enabled||!t.token){e.next=3;break}return e.abrupt("return",t.token.promise);case 3:throw Error("\n            Can't get debug token in production mode.\n        ");case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}var FG={error:"UNKNOWN_ERROR"};function BG(e){return hB.encodeString(JSON.stringify(e),!1)}function VG(e){return UG.apply(this,arguments)}function UG(){return(UG=tB(regeneratorRuntime.mark(function e(t){var n,r,i,a,o,s,u,c,l,h=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=h.length>1&&void 0!==h[1]&&h[1],EG(r=t.app),i=kG(r),o=i.token){e.next=10;break}return e.next=8,i.cachedTokenPromise;case 8:(s=e.sent)&&qG(s)&&(o=s);case 10:if(n||!o||!qG(o)){e.next=12;break}return e.abrupt("return",{token:o.token});case 12:if(c=!1,!MG()){e.next=33;break}if(e.t0=i.exchangeTokenPromise,e.t0){e.next=26;break}return e.t1=SG,e.t2=OG,e.t3=r,e.next=21,DG();case 21:e.t4=e.sent,e.t5=(0,e.t2)(e.t3,e.t4),e.t6=t.platformLoggerProvider,i.exchangeTokenPromise=(0,e.t1)(e.t5,e.t6).then(function(e){return i.exchangeTokenPromise=void 0,e}),c=!0;case 26:return e.next=28,i.exchangeTokenPromise;case 28:return l=e.sent,e.next=31,NG(r,l);case 31:return _G(r,Object.assign(Object.assign({},i),{token:l})),e.abrupt("return",{token:l.token});case 33:return e.prev=33,i.exchangeTokenPromise||(i.exchangeTokenPromise=i.provider.getToken().then(function(e){return i.exchangeTokenPromise=void 0,e}),c=!0),e.next=37,i.exchangeTokenPromise;case 37:o=e.sent,e.next=43;break;case 40:e.prev=40,e.t7=e.catch(33),"appCheck/throttled"===e.t7.code?RG.warn(e.t7.message):RG.error(e.t7),a=e.t7;case 43:if(!o){e.next=50;break}return u={token:o.token},_G(r,Object.assign(Object.assign({},i),{token:o})),e.next=48,NG(r,o);case 48:e.next=51;break;case 50:u=$G(a);case 51:return c&&GG(r,u),e.abrupt("return",u);case 53:case"end":return e.stop()}},e,null,[[33,40]])}))).apply(this,arguments)}function zG(e,t){var n=kG(e),r=n.tokenObservers.filter(function(e){return e.next!==t});0===r.length&&n.tokenRefresher&&n.tokenRefresher.isRunning()&&n.tokenRefresher.stop(),_G(e,Object.assign(Object.assign({},n),{tokenObservers:r}))}function HG(e){var t=e.app,n=kG(t),r=n.tokenRefresher;r||(r=function(e){var t=e.app;return new CG(tB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!kG(t).token){n.next=6;break}return n.next=3,VG(e,!0);case 3:n.t0=n.sent,n.next=9;break;case 6:return n.next=8,VG(e);case 8:n.t0=n.sent;case 9:if(!(r=n.t0).error){n.next=12;break}throw r.error;case 12:case"end":return n.stop()}},n)})),function(){return!0},function(){var e=kG(t);if(e.token){var n=e.token.issuedAtTimeMillis+.5*(e.token.expireTimeMillis-e.token.issuedAtTimeMillis)+3e5;return n=Math.min(n,e.token.expireTimeMillis-3e5),Math.max(0,n-Date.now())}return 0},3e4,96e4)}(e),_G(t,Object.assign(Object.assign({},n),{tokenRefresher:r}))),!r.isRunning()&&n.isTokenAutoRefreshEnabled&&r.start()}function GG(e,t){var n,r=Qv(kG(e).tokenObservers);try{for(r.s();!(n=r.n()).done;){var i=n.value;try{"EXTERNAL"===i.type&&null!=t.error?i.error(t.error):i.next(t)}catch(a){}}}catch(o){r.e(o)}finally{r.f()}}function qG(e){return e.expireTimeMillis-Date.now()>0}function $G(e){return{token:BG(FG),error:e}}var WG=function(){function e(t,n){tp(this,e),this.app=t,this.platformLoggerProvider=n}return rp(e,[{key:"_delete",value:function(){var e,t=Qv(kG(this.app).tokenObservers);try{for(t.s();!(e=t.n()).done;){var n=e.value;zG(this.app,n.next)}}catch(r){t.e(r)}finally{t.f()}return Promise.resolve()}}]),e}(),jG="app-check-internal";pV(new KB("app-check",function(e){return function(e,t){return new WG(e,t)}(e.getProvider("app").getImmediate(),e.getProvider("platform-logger"))},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(function(e,t,n){e.getProvider(jG).initialize()})),pV(new KB(jG,function(e){return function(e){return{getToken:function(t){return VG(e,t)},addTokenListener:function(t){return function(e,t,n,r){var i=e.app,a=kG(i),o={next:n,error:void 0,type:"INTERNAL"};if(_G(i,Object.assign(Object.assign({},a),{tokenObservers:[].concat(Kv(a.tokenObservers),[o])})),a.token&&qG(a.token)){var s=a.token;Promise.resolve().then(function(){n({token:s.token}),HG(e)}).catch(function(){})}a.cachedTokenPromise.then(function(){return HG(e)})}(e,0,t)},removeTokenListener:function(t){return zG(e.app,t)}}}(e.getProvider("app-check").getImmediate())},"PUBLIC").setInstantiationMode("EXPLICIT")),CV("@firebase/app-check","0.5.3");var ZG=rp(function e(){return tp(this,e),JH("app-check")});"undefined"!=typeof window&&window;var YG=new IB("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),KG=new oV("@firebase/auth");function JG(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];KG.logLevel<=tV.ERROR&&KG.error.apply(KG,["Auth (9.6.6): ".concat(e)].concat(n))}function QG(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw nq.apply(void 0,[e].concat(n))}function XG(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return nq.apply(void 0,[e].concat(n))}function eq(e,t,n){var r=Object.assign(Object.assign({},{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),Dv({},t,n));return new IB("auth","Firebase",r).create(t,{appName:e.name})}function tq(e,t,n){if(!(t instanceof n))throw n.name!==t.constructor.name&&QG(e,"argument-error"),eq(e,"argument-error","Type of ".concat(t.constructor.name," does not match expected instance.Did you pass a reference from a different Auth SDK?"))}function nq(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if("string"!=typeof e){var i,a=n[0],o=Kv(n.slice(1));return o[0]&&(o[0].appName=e.name),(i=e._errorFactory).create.apply(i,[a].concat(Kv(o)))}return YG.create.apply(YG,[e].concat(n))}function rq(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(!e)throw nq.apply(void 0,[t].concat(r))}function iq(e){var t="INTERNAL ASSERTION FAILED: "+e;throw JG(t),new Error(t)}function aq(e,t){e||iq(t)}var oq=new Map;function sq(e){aq(e instanceof Function,"Expected a class definition");var t=oq.get(e);return t?(aq(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,oq.set(e,t),t)}function uq(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function cq(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}var lq=function(){function e(t,n){tp(this,e),this.shortDelay=t,this.longDelay=n,aq(n>t,"Short delay should be less than long delay!"),this.isMobile=wB()||bB()}return rp(e,[{key:"get",value:function(){return"undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&("http:"===cq()||"https:"===cq()||CB()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}]),e}();function hq(e,t){aq(e.emulator,"Emulator should always be set here");var n=e.emulator.url;return t?"".concat(n).concat(t.startsWith("/")?t.slice(1):t):n}var fq=function(){function e(){tp(this,e)}return rp(e,null,[{key:"initialize",value:function(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}},{key:"fetch",value:function(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:void iq("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}},{key:"headers",value:function(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:void iq("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}},{key:"response",value:function(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:void iq("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}]),e}(),dq={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error"},vq=new lq(3e4,6e4);function pq(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}function gq(e,t,n,r){return yq.apply(this,arguments)}function yq(){return(yq=tB(regeneratorRuntime.mark(function e(t,n,r,i){var a,o=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=o.length>4&&void 0!==o[4]?o[4]:{},e.abrupt("return",mq(t,a,tB(regeneratorRuntime.mark(function e(){var a,o,s,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a={},o={},i&&("GET"===n?o=i:a={body:JSON.stringify(i)}),s=UB(Object.assign({key:t.config.apiKey},o)).slice(1),e.next=5,t._getAdditionalHeaders();case 5:return u=e.sent,e.abrupt("return",(u["Content-Type"]="application/json",t.languageCode&&(u["X-Firebase-Locale"]=t.languageCode),fq.fetch()(Cq(t,t.config.apiHost,r,s),Object.assign({method:n,headers:u,referrerPolicy:"no-referrer"},a))));case 7:case"end":return e.stop()}},e)}))));case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}function mq(e,t,n){return kq.apply(this,arguments)}function kq(){return(kq=tB(regeneratorRuntime.mark(function e(t,n,r){var i,a,o,s,u,c,l,h,f,d;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t._canInitEmulator=!1,i=Object.assign(Object.assign({},dq),n),e.prev=2,a=new bq(t),e.next=6,Promise.race([r(),a.promise]);case 6:return o=e.sent,a.clearNetworkTimeout(),e.next=10,o.json();case 10:if(!("needConfirmation"in(s=e.sent))){e.next=13;break}throw Eq(t,"account-exists-with-different-credential",s);case 13:if(!o.ok||"errorMessage"in s){e.next=15;break}return e.abrupt("return",s);case 15:if(u=o.ok?s.errorMessage:s.error.message,c=u.split(" : "),l=Lv(c,2),h=l[0],f=l[1],"FEDERATED_USER_ID_ALREADY_LINKED"!==h){e.next=18;break}throw Eq(t,"credential-already-in-use",s);case 18:if("EMAIL_EXISTS"!==h){e.next=20;break}throw Eq(t,"email-already-in-use",s);case 20:if(d=i[h]||h.toLowerCase().replace(/[_\s]+/g,"-"),!f){e.next=23;break}throw eq(t,d,f);case 23:QG(t,d),e.next=31;break;case 26:if(e.prev=26,e.t0=e.catch(2),!(e.t0 instanceof TB)){e.next=30;break}throw e.t0;case 30:QG(t,"network-request-failed");case 31:case"end":return e.stop()}},e,null,[[2,26]])}))).apply(this,arguments)}function _q(e,t,n,r){return wq.apply(this,arguments)}function wq(){return(wq=tB(regeneratorRuntime.mark(function e(t,n,r,i){var a,o,s=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=s.length>4&&void 0!==s[4]?s[4]:{},e.next=3,gq(t,n,r,i,a);case 3:return o=e.sent,e.abrupt("return",("mfaPendingCredential"in o&&QG(t,"multi-factor-auth-required",{_serverResponse:o}),o));case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Cq(e,t,n,r){var i="".concat(t).concat(n,"?").concat(r);return e.config.emulator?hq(e.config,i):"".concat(e.config.apiScheme,"://").concat(i)}var bq=function(){function e(t){var n=this;tp(this,e),this.auth=t,this.timer=null,this.promise=new Promise(function(e,t){n.timer=setTimeout(function(){return t(XG(n.auth,"network-request-failed"))},vq.get())})}return rp(e,[{key:"clearNetworkTimeout",value:function(){clearTimeout(this.timer)}}]),e}();function Eq(e,t,n){var r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);var i=XG(e,t,r);return i.customData._tokenResponse=n,i}function Sq(){return(Sq=tB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",gq(t,"POST","/v1/accounts:delete",n));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Pq(e,t){return Oq.apply(this,arguments)}function Oq(){return(Oq=tB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",gq(t,"POST","/v1/accounts:lookup",n));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Tq(e){if(e)try{var t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(n){}}function Iq(){return(Iq=tB(regeneratorRuntime.mark(function e(t){var n,r,i,a,o,s,u=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=u.length>1&&void 0!==u[1]&&u[1],r=YB(t),e.next=4,r.getIdToken(n);case 4:return i=e.sent,rq((a=Aq(i))&&a.exp&&a.auth_time&&a.iat,r.auth,"internal-error"),o="object"==typeof a.firebase?a.firebase:void 0,s=null==o?void 0:o.sign_in_provider,e.abrupt("return",{claims:a,token:i,authTime:Tq(xq(a.auth_time)),issuedAtTime:Tq(xq(a.iat)),expirationTime:Tq(xq(a.exp)),signInProvider:s||null,signInSecondFactor:(null==o?void 0:o.sign_in_second_factor)||null});case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}function xq(e){return 1e3*Number(e)}function Aq(e){var t=Lv(e.split("."),3),n=t[0],r=t[1],i=t[2];if(void 0===n||void 0===r||void 0===i)return JG("JWT malformed, contained fewer than 3 sections"),null;try{var a=vB(r);return a?JSON.parse(a):(JG("Failed to decode base64 JWT payload"),null)}catch(a){return JG("Caught error parsing JWT payload as JSON",a),null}}function Rq(e,t){return Nq.apply(this,arguments)}function Nq(){return(Nq=tB(regeneratorRuntime.mark(function e(t,n){var r=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r.length>2&&void 0!==r[2]&&r[2])){e.next=3;break}return e.abrupt("return",n);case 3:return e.prev=3,e.next=6,n;case 6:return e.abrupt("return",e.sent);case 9:if(e.prev=9,e.t0=e.catch(3),e.t1=e.t0 instanceof TB&&Mq(e.t0)&&t.auth.currentUser===t,!e.t1){e.next=15;break}return e.next=15,t.auth.signOut();case 15:throw e.t0;case 16:case"end":return e.stop()}},e,null,[[3,9]])}))).apply(this,arguments)}function Mq(e){var t=e.code;return"auth/user-disabled"===t||"auth/user-token-expired"===t}var Dq=function(){function e(t){tp(this,e),this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}return rp(e,[{key:"_start",value:function(){this.isRunning||(this.isRunning=!0,this.schedule())}},{key:"_stop",value:function(){!this.isRunning||(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}},{key:"getInterval",value:function(e){var t;if(e){var n=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),n}this.errorBackoff=3e4;var r=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,r)}},{key:"schedule",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this;if(this.isRunning){var n=this.getInterval(e);this.timerId=setTimeout(tB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.iteration();case 2:case"end":return e.stop()}},e)})),n)}}},{key:"iteration",value:function(){var e=this;return tB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.user.getIdToken(!0);case 3:t.next=8;break;case 5:return t.prev=5,t.t0=t.catch(0),t.abrupt("return",void("auth/network-request-failed"===t.t0.code&&e.schedule(!0)));case 8:e.schedule();case 9:case"end":return t.stop()}},t,null,[[0,5]])}))()}}]),e}(),Lq=function(){function e(t,n){tp(this,e),this.createdAt=t,this.lastLoginAt=n,this._initializeTime()}return rp(e,[{key:"_initializeTime",value:function(){this.lastSignInTime=Tq(this.lastLoginAt),this.creationTime=Tq(this.createdAt)}},{key:"_copy",value:function(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}},{key:"toJSON",value:function(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}]),e}();function Fq(e){return Bq.apply(this,arguments)}function Bq(){return(Bq=tB(regeneratorRuntime.mark(function e(t){var n,r,i,a,o,s,u,c,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.auth,e.next=3,t.getIdToken();case 3:return i=e.sent,e.next=6,Rq(t,Pq(r,{idToken:i}));case 6:rq(null==(a=e.sent)?void 0:a.users.length,r,"internal-error"),o=a.users[0],t._notifyReloadListener(o),s=(null===(n=o.providerUserInfo)||void 0===n?void 0:n.length)?zq(o.providerUserInfo):[],u=Uq(t.providerData,s),c=!!t.isAnonymous&&!(t.email&&o.passwordHash||(null==u?void 0:u.length)),l={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:u,metadata:new Lq(o.createdAt,o.lastLoginAt),isAnonymous:c},Object.assign(t,l);case 12:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Vq(){return(Vq=tB(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=YB(t),e.next=3,Fq(n);case 3:return e.next=5,n.auth._persistUserIfCurrent(n);case 5:n.auth._notifyListenersIfCurrent(n);case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Uq(e,t){return[].concat(Kv(e.filter(function(e){return!t.some(function(t){return t.providerId===e.providerId})})),Kv(t))}function zq(e){return e.map(function(e){var t=e.providerId,n=Fp(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}function Hq(){return(Hq=tB(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,mq(t,{},tB(regeneratorRuntime.mark(function e(){var r,i,a,o,s,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=UB({grant_type:"refresh_token",refresh_token:n}).slice(1),i=t.config,a=i.tokenApiHost,o=i.apiKey,s=Cq(t,a,"/v1/token","key=".concat(o)),e.next=7,t._getAdditionalHeaders();case 7:return u=e.sent,e.abrupt("return",(u["Content-Type"]="application/x-www-form-urlencoded",fq.fetch()(s,{method:"POST",headers:u,body:r})));case 9:case"end":return e.stop()}},e)})));case 2:return r=e.sent,e.abrupt("return",{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token});case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}var Gq=function(){function e(){tp(this,e),this.refreshToken=null,this.accessToken=null,this.expirationTime=null}return rp(e,[{key:"isExpired",get:function(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}},{key:"updateFromServerResponse",value:function(e){rq(e.idToken,"internal-error"),rq(void 0!==e.idToken,"internal-error"),rq(void 0!==e.refreshToken,"internal-error");var t="expiresIn"in e&&void 0!==e.expiresIn?Number(e.expiresIn):function(e){var t=Aq(e);return rq(t,"internal-error"),rq(void 0!==t.exp,"internal-error"),rq(void 0!==t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}},{key:"getToken",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this;return tB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(rq(!n.accessToken||n.refreshToken,e,"user-token-expired"),!t&&n.accessToken&&!n.isExpired){r.next=12;break}if(!n.refreshToken){r.next=8;break}return r.next=5,n.refresh(e,n.refreshToken);case 5:r.t1=n.accessToken,r.next=9;break;case 8:r.t1=null;case 9:r.t0=r.t1,r.next=13;break;case 12:r.t0=n.accessToken;case 13:return r.abrupt("return",r.t0);case 14:case"end":return r.stop()}},r)}))()}},{key:"clearRefreshToken",value:function(){this.refreshToken=null}},{key:"refresh",value:function(e,t){var n=this;return tB(regeneratorRuntime.mark(function r(){var i,a,o,s;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,function(e,t){return Hq.apply(this,arguments)}(e,t);case 2:i=r.sent,a=i.accessToken,o=i.refreshToken,s=i.expiresIn,n.updateTokensAndExpiration(a,o,Number(s));case 7:case"end":return r.stop()}},r)}))()}},{key:"updateTokensAndExpiration",value:function(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}},{key:"toJSON",value:function(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}},{key:"_assign",value:function(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}},{key:"_clone",value:function(){return Object.assign(new e,this.toJSON())}},{key:"_performRefresh",value:function(){return iq("not implemented")}}],[{key:"fromJSON",value:function(t,n){var r=n.refreshToken,i=n.accessToken,a=n.expirationTime,o=new e;return r&&(rq("string"==typeof r,"internal-error",{appName:t}),o.refreshToken=r),i&&(rq("string"==typeof i,"internal-error",{appName:t}),o.accessToken=i),a&&(rq("number"==typeof a,"internal-error",{appName:t}),o.expirationTime=a),o}}]),e}();function qq(e,t){rq("string"==typeof e||void 0===e,"internal-error",{appName:t})}var $q=function(){function e(t){tp(this,e);var n=t.uid,r=t.auth,i=t.stsTokenManager,a=Fp(t,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Dq(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?Kv(a.providerData):[],this.metadata=new Lq(a.createdAt||void 0,a.lastLoginAt||void 0)}return rp(e,[{key:"getIdToken",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Rq(t,t.stsTokenManager.getToken(t.auth,e));case 2:if(rq(r=n.sent,t.auth,"internal-error"),n.t0=t.accessToken!==r,!n.t0){n.next=10;break}return t.accessToken=r,n.next=9,t.auth._persistUserIfCurrent(t);case 9:t.auth._notifyListenersIfCurrent(t);case 10:return n.abrupt("return",r);case 11:case"end":return n.stop()}},n)}))()}},{key:"getIdTokenResult",value:function(e){return function(e){return Iq.apply(this,arguments)}(this,e)}},{key:"reload",value:function(){return function(e){return Vq.apply(this,arguments)}(this)}},{key:"_assign",value:function(e){this!==e&&(rq(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(function(e){return Object.assign({},e)}),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}},{key:"_clone",value:function(t){return new e(Object.assign(Object.assign({},this),{auth:t,stsTokenManager:this.stsTokenManager._clone()}))}},{key:"_onReload",value:function(e){rq(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}},{key:"_notifyReloadListener",value:function(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}},{key:"_startProactiveRefresh",value:function(){this.proactiveRefresh._start()}},{key:"_stopProactiveRefresh",value:function(){this.proactiveRefresh._stop()}},{key:"_updateTokensIfNecessary",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this;return tB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=!1,e.idToken&&e.idToken!==n.stsTokenManager.accessToken&&(n.stsTokenManager.updateFromServerResponse(e),i=!0),r.t0=t,!r.t0){r.next=6;break}return r.next=6,Fq(n);case 6:return r.next=8,n.auth._persistUserIfCurrent(n);case 8:i&&n.auth._notifyListenersIfCurrent(n);case 9:case"end":return r.stop()}},r)}))()}},{key:"delete",value:function(){var e=this;return tB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getIdToken();case 2:return n=t.sent,t.next=5,Rq(e,function(e,t){return Sq.apply(this,arguments)}(e.auth,{idToken:n}));case 5:return e.stsTokenManager.clearRefreshToken(),t.abrupt("return",e.auth.signOut());case 7:case"end":return t.stop()}},t)}))()}},{key:"toJSON",value:function(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(function(e){return Object.assign({},e)}),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}},{key:"refreshToken",get:function(){return this.stsTokenManager.refreshToken||""}}],[{key:"_fromJSON",value:function(t,n){var r,i,a,o,s,u,c,l,h=null!==(r=n.displayName)&&void 0!==r?r:void 0,f=null!==(i=n.email)&&void 0!==i?i:void 0,d=null!==(a=n.phoneNumber)&&void 0!==a?a:void 0,v=null!==(o=n.photoURL)&&void 0!==o?o:void 0,p=null!==(s=n.tenantId)&&void 0!==s?s:void 0,g=null!==(u=n._redirectEventId)&&void 0!==u?u:void 0,y=null!==(c=n.createdAt)&&void 0!==c?c:void 0,m=null!==(l=n.lastLoginAt)&&void 0!==l?l:void 0,k=n.uid,_=n.emailVerified,w=n.isAnonymous,C=n.providerData,b=n.stsTokenManager;rq(k&&b,t,"internal-error");var E=Gq.fromJSON(this.name,b);rq("string"==typeof k,t,"internal-error"),qq(h,t.name),qq(f,t.name),rq("boolean"==typeof _,t,"internal-error"),rq("boolean"==typeof w,t,"internal-error"),qq(d,t.name),qq(v,t.name),qq(p,t.name),qq(g,t.name),qq(y,t.name),qq(m,t.name);var S=new e({uid:k,auth:t,email:f,emailVerified:_,displayName:h,isAnonymous:w,photoURL:v,phoneNumber:d,tenantId:p,stsTokenManager:E,createdAt:y,lastLoginAt:m});return C&&Array.isArray(C)&&(S.providerData=C.map(function(e){return Object.assign({},e)})),g&&(S._redirectEventId=g),S}},{key:"_fromIdTokenResponse",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return tB(regeneratorRuntime.mark(function i(){var a,o;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return(a=new Gq).updateFromServerResponse(n),o=new e({uid:n.localId,auth:t,stsTokenManager:a,isAnonymous:r}),i.next=5,Fq(o);case 5:return i.abrupt("return",o);case 6:case"end":return i.stop()}},i)}))()}}]),e}(),Wq=function(){var e=function(){function e(){tp(this,e),this.type="NONE",this.storage={}}return rp(e,[{key:"_isAvailable",value:function(){return tB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!0);case 1:case"end":return e.stop()}},e)}))()}},{key:"_set",value:function(e,t){var n=this;return tB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:n.storage[e]=t;case 1:case"end":return r.stop()}},r)}))()}},{key:"_get",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.storage[e],n.abrupt("return",void 0===r?null:r);case 2:case"end":return n.stop()}},n)}))()}},{key:"_remove",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:delete t.storage[e];case 1:case"end":return n.stop()}},n)}))()}},{key:"_addListener",value:function(e,t){}},{key:"_removeListener",value:function(e,t){}}]),e}();return e.type="NONE",e}();function jq(e,t,n){return"firebase:".concat(e,":").concat(t,":").concat(n)}var Zq=function(){function e(t,n,r){tp(this,e),this.persistence=t,this.auth=n,this.userKey=r;var i=this.auth,a=i.config,o=i.name;this.fullUserKey=jq(this.userKey,a.apiKey,o),this.fullPersistenceKey=jq("persistence",a.apiKey,o),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}return rp(e,[{key:"setCurrentUser",value:function(e){return this.persistence._set(this.fullUserKey,e.toJSON())}},{key:"getCurrentUser",value:function(){var e=this;return tB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.persistence._get(e.fullUserKey);case 2:return n=t.sent,t.abrupt("return",n?$q._fromJSON(e.auth,n):null);case 4:case"end":return t.stop()}},t)}))()}},{key:"removeCurrentUser",value:function(){return this.persistence._remove(this.fullUserKey)}},{key:"savePersistenceForRedirect",value:function(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}},{key:"setPersistence",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(t.persistence!==e){n.next=2;break}return n.abrupt("return");case 2:return n.next=4,t.getCurrentUser();case 4:return r=n.sent,n.next=7,t.removeCurrentUser();case 7:return t.persistence=e,n.abrupt("return",r?t.setCurrentUser(r):void 0);case 9:case"end":return n.stop()}},n)}))()}},{key:"delete",value:function(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}}],[{key:"create",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"authUser";return tB(regeneratorRuntime.mark(function i(){var a,o,s,u,c,l,h,f,d,v;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(n.length){i.next=2;break}return i.abrupt("return",new e(sq(Wq),t,r));case 2:return i.next=4,Promise.all(n.map(function(){var e=tB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t._isAvailable();case 2:if(!e.sent){e.next=4;break}return e.abrupt("return",t);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()));case 4:a=i.sent.filter(function(e){return e}),o=a[0]||sq(Wq),s=jq(r,t.config.apiKey,t.name),u=null,c=Qv(n),i.prev=9,c.s();case 11:if((l=c.n()).done){i.next=27;break}return h=l.value,i.prev=13,i.next=16,h._get(s);case 16:if(!(f=i.sent)){i.next=21;break}return d=$q._fromJSON(t,f),h!==o&&(u=d),o=h,i.abrupt("break",27);case 21:i.next=25;break;case 23:i.prev=23,i.t0=i.catch(13);case 25:i.next=11;break;case 27:i.next=32;break;case 29:i.prev=29,i.t1=i.catch(9),c.e(i.t1);case 32:return i.prev=32,c.f(),i.finish(32);case 35:if(v=a.filter(function(e){return e._shouldAllowMigration}),!o._shouldAllowMigration||!v.length){i.next=47;break}if(o=v[0],i.t3=u,!i.t3){i.next=42;break}return i.next=42,o._set(s,u.toJSON());case 42:return i.next=44,Promise.all(n.map(function(){var e=tB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t===o){e.next=8;break}return e.prev=1,e.next=4,t._remove(s);case 4:e.next=8;break;case 6:e.prev=6,e.t0=e.catch(1);case 8:case"end":return e.stop()}},e,null,[[1,6]])}));return function(t){return e.apply(this,arguments)}}()));case 44:i.t2=new e(o,t,r),i.next=48;break;case 47:i.t2=new e(o,t,r);case 48:return i.abrupt("return",i.t2);case 49:case"end":return i.stop()}},i,null,[[9,29,32,35],[13,23]])}))()}}]),e}();function Yq(e){var t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(Xq(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(Kq(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(t$(t))return"Blackberry";if(n$(t))return"Webos";if(Jq(t))return"Safari";if((t.includes("chrome/")||Qq(t))&&!t.includes("edge/"))return"Chrome";if(e$(t))return"Android";var n=e.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);return 2===(null==n?void 0:n.length)?n[1]:"Other"}function Kq(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_B();return/firefox\//i.test(e)}function Jq(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_B(),t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function Qq(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_B();return/crios\//i.test(e)}function Xq(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_B();return/iemobile/i.test(e)}function e$(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_B();return/android/i.test(e)}function t$(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_B();return/blackberry/i.test(e)}function n$(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_B();return/webos/i.test(e)}function r$(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_B();return/iphone|ipad|ipod/i.test(e)}function i$(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_B();return r$(e)||e$(e)||n$(e)||t$(e)||/windows phone/i.test(e)||Xq(e)}function a$(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];switch(e){case"Browser":t=Yq(_B());break;case"Worker":t="".concat(Yq(_B()),"-").concat(e);break;default:t=e}return"".concat(t,"/JsCore/9.6.6/").concat(n.length?n.join(","):"FirebaseCore-web")}var o$=function(){function e(t,n){tp(this,e),this.app=t,this.config=n,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new u$(this),this.idTokenSubscription=new u$(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=YG,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=n.sdkClientVersion}return rp(e,[{key:"_initializeWithPersistence",value:function(e,t){var n=this;return t&&(this._popupRedirectResolver=sq(t)),this._initializationPromise=this.queue(tB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(r.t0=!n._deleted,!r.t0){r.next=6;break}return r.next=4,Zq.create(n,e);case 4:n.persistenceManager=r.sent,r.t0=!n._deleted;case 6:if(!r.t0){r.next=19;break}if(!(null===(i=n._popupRedirectResolver)||void 0===i?void 0:i._shouldInitProactively)){r.next=15;break}return r.prev=8,r.next=11,n._popupRedirectResolver._initialize(n);case 11:r.next=15;break;case 13:r.prev=13,r.t1=r.catch(8);case 15:return r.next=17,n.initializeCurrentUser(t);case 17:n.lastNotifiedUid=(null===(a=n.currentUser)||void 0===a?void 0:a.uid)||null,!n._deleted&&(n._isInitialized=!0);case 19:case"end":return r.stop()}},r,null,[[8,13]])}))),this._initializationPromise}},{key:"_onStorageEvent",value:function(){var e=this;return tB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e._deleted){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,e.assertedPersistence.getCurrentUser();case 4:if(n=t.sent,!e.currentUser&&!n){t.next=13;break}if(!e.currentUser||!n||e.currentUser.uid!==n.uid){t.next=11;break}return e._currentUser._assign(n),t.next=10,e.currentUser.getIdToken();case 10:return t.abrupt("return",void t.sent);case 11:return t.next=13,e._updateCurrentUser(n);case 13:case"end":return t.stop()}},t)}))()}},{key:"initializeCurrentUser",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function n(){var r,i,a,o,s;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.assertedPersistence.getCurrentUser();case 2:if(i=n.sent,!e||!t.config.authDomain){n.next=12;break}return n.next=6,t.getOrInitRedirectPersistenceManager();case 6:return a=null===(r=t.redirectUser)||void 0===r?void 0:r._redirectEventId,o=null==i?void 0:i._redirectEventId,n.next=10,t.tryRedirectSignIn(e);case 10:s=n.sent,(!a||a===o)&&(null==s?void 0:s.user)&&(i=s.user);case 12:if(!i){n.next=24;break}if(!i._redirectEventId){n.next=20;break}return rq(t._popupRedirectResolver,t,"argument-error"),n.next=17,t.getOrInitRedirectPersistenceManager();case 17:n.t1=t.redirectUser&&t.redirectUser._redirectEventId===i._redirectEventId?t.directlySetCurrentUser(i):t.reloadAndSetCurrentUserOrClear(i),n.next=21;break;case 20:n.t1=t.reloadAndSetCurrentUserOrClear(i);case 21:n.t0=n.t1,n.next=25;break;case 24:n.t0=t.directlySetCurrentUser(null);case 25:return n.abrupt("return",n.t0);case 26:case"end":return n.stop()}},n)}))()}},{key:"tryRedirectSignIn",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=null,n.prev=1,n.next=4,t._popupRedirectResolver._completeRedirectFn(t,e,!0);case 4:r=n.sent,n.next=11;break;case 7:return n.prev=7,n.t0=n.catch(1),n.next=11,t._setRedirectUser(null);case 11:return n.abrupt("return",r);case 12:case"end":return n.stop()}},n,null,[[1,7]])}))()}},{key:"reloadAndSetCurrentUserOrClear",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,Fq(e);case 3:n.next=9;break;case 5:if(n.prev=5,n.t0=n.catch(0),"auth/network-request-failed"===n.t0.code){n.next=9;break}return n.abrupt("return",t.directlySetCurrentUser(null));case 9:return n.abrupt("return",t.directlySetCurrentUser(e));case 10:case"end":return n.stop()}},n,null,[[0,5]])}))()}},{key:"useDeviceLanguage",value:function(){this.languageCode=function(){if("undefined"==typeof navigator)return null;var e=navigator;return e.languages&&e.languages[0]||e.language||null}()}},{key:"_delete",value:function(){var e=this;return tB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e._deleted=!0;case 1:case"end":return t.stop()}},t)}))()}},{key:"updateCurrentUser",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=e?YB(e):null,n.abrupt("return",(r&&rq(r.auth.config.apiKey===t.config.apiKey,t,"invalid-user-token"),t._updateCurrentUser(r&&r._clone(t))));case 2:case"end":return n.stop()}},n)}))()}},{key:"_updateCurrentUser",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(t._deleted){n.next=2;break}return n.abrupt("return",(e&&rq(t.tenantId===e.tenantId,t,"tenant-id-mismatch"),t.queue(tB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.directlySetCurrentUser(e);case 2:t.notifyAuthListeners();case 3:case"end":return n.stop()}},n)})))));case 2:case"end":return n.stop()}},n)}))()}},{key:"signOut",value:function(){var e=this;return tB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=e.redirectPersistenceManager||e._popupRedirectResolver,!t.t0){t.next=4;break}return t.next=4,e._setRedirectUser(null);case 4:return t.abrupt("return",e._updateCurrentUser(null));case 5:case"end":return t.stop()}},t)}))()}},{key:"setPersistence",value:function(e){var t=this;return this.queue(tB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.assertedPersistence.setPersistence(sq(e));case 2:case"end":return n.stop()}},n)})))}},{key:"_getPersistence",value:function(){return this.assertedPersistence.persistence.type}},{key:"_updateErrorMap",value:function(e){this._errorFactory=new IB("auth","Firebase",e())}},{key:"onAuthStateChanged",value:function(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}},{key:"onIdTokenChanged",value:function(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}},{key:"toJSON",value:function(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}},{key:"_setRedirectUser",value:function(e,t){var n=this;return tB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.getOrInitRedirectPersistenceManager(t);case 2:return i=r.sent,r.abrupt("return",null===e?i.removeCurrentUser():i.setCurrentUser(e));case 4:case"end":return r.stop()}},r)}))()}},{key:"getOrInitRedirectPersistenceManager",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(t.redirectPersistenceManager){n.next=9;break}return rq(r=e&&sq(e)||t._popupRedirectResolver,t,"argument-error"),n.next=5,Zq.create(t,[sq(r._redirectPersistence)],"redirectUser");case 5:return t.redirectPersistenceManager=n.sent,n.next=8,t.redirectPersistenceManager.getCurrentUser();case 8:t.redirectUser=n.sent;case 9:return n.abrupt("return",t.redirectPersistenceManager);case 10:case"end":return n.stop()}},n)}))()}},{key:"_redirectUserForId",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(n.t0=t._isInitialized,!n.t0){n.next=4;break}return n.next=4,t.queue(tB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e)})));case 4:return n.abrupt("return",(null===(r=t._currentUser)||void 0===r?void 0:r._redirectEventId)===e?t._currentUser:(null===(i=t.redirectUser)||void 0===i?void 0:i._redirectEventId)===e?t.redirectUser:null);case 5:case"end":return n.stop()}},n)}))()}},{key:"_persistUserIfCurrent",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(e!==t.currentUser){n.next=2;break}return n.abrupt("return",t.queue(tB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t.directlySetCurrentUser(e));case 1:case"end":return n.stop()}},n)}))));case 2:case"end":return n.stop()}},n)}))()}},{key:"_notifyListenersIfCurrent",value:function(e){e===this.currentUser&&this.notifyAuthListeners()}},{key:"_key",value:function(){return"".concat(this.config.authDomain,":").concat(this.config.apiKey,":").concat(this.name)}},{key:"_startProactiveRefresh",value:function(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}},{key:"_stopProactiveRefresh",value:function(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}},{key:"_currentUser",get:function(){return this.currentUser}},{key:"notifyAuthListeners",value:function(){var e,t;if(this._isInitialized){this.idTokenSubscription.next(this.currentUser);var n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}}},{key:"registerStateListener",value:function(e,t,n,r){var i=this;if(this._deleted)return function(){};var a="function"==typeof t?t:t.next.bind(t),o=this._isInitialized?Promise.resolve():this._initializationPromise;return rq(o,this,"internal-error"),o.then(function(){return a(i.currentUser)}),"function"==typeof t?e.addObserver(t,n,r):e.addObserver(t)}},{key:"directlySetCurrentUser",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(t.currentUser&&t.currentUser!==e&&(t._currentUser._stopProactiveRefresh(),e&&t.isProactiveRefreshEnabled&&e._startProactiveRefresh()),t.currentUser=e,!e){n.next=7;break}return n.next=5,t.assertedPersistence.setCurrentUser(e);case 5:n.next=9;break;case 7:return n.next=9,t.assertedPersistence.removeCurrentUser();case 9:case"end":return n.stop()}},n)}))()}},{key:"queue",value:function(e){return this.operations=this.operations.then(e,e),this.operations}},{key:"assertedPersistence",get:function(){return rq(this.persistenceManager,this,"internal-error"),this.persistenceManager}},{key:"_logFramework",value:function(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=a$(this.config.clientPlatform,this._getFrameworks()))}},{key:"_getFrameworks",value:function(){return this.frameworks}},{key:"_getAdditionalHeaders",value:function(){var e=this;return tB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n={"X-Client-Version":e.clientVersion},t.abrupt("return",(e.app.options.appId&&(n["X-Firebase-gmpid"]=e.app.options.appId),n));case 2:case"end":return t.stop()}},t)}))()}}]),e}();function s$(e){return YB(e)}var u$=function(){function e(t){var n,r=this;tp(this,e),this.auth=t,this.observer=null,this.addObserver=(n=new qB(function(e){return r.observer=e},void 0)).subscribe.bind(n)}return rp(e,[{key:"next",get:function(){return rq(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}]),e}();function c$(e){var t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function l$(e){if(!e)return null;var t=Number(e);return isNaN(t)?null:t}var h$=function(){function e(t,n){tp(this,e),this.providerId=t,this.signInMethod=n}return rp(e,[{key:"toJSON",value:function(){return iq("not implemented")}},{key:"_getIdTokenResponse",value:function(e){return iq("not implemented")}},{key:"_linkToIdToken",value:function(e,t){return iq("not implemented")}},{key:"_getReauthenticationResolver",value:function(e){return iq("not implemented")}}]),e}();function f$(){return(f$=tB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",gq(t,"POST","/v1/accounts:update",n));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function d$(){return(d$=tB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",_q(t,"POST","/v1/accounts:signInWithPassword",pq(t,n)));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function v$(e,t){return p$.apply(this,arguments)}function p$(){return(p$=tB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",gq(t,"POST","/v1/accounts:sendOobCode",pq(t,n)));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function g$(e,t){return y$.apply(this,arguments)}function y$(){return(y$=tB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",v$(t,n));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function m$(e,t){return k$.apply(this,arguments)}function k$(){return(k$=tB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",v$(t,n));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function _$(){return(_$=tB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",_q(t,"POST","/v1/accounts:signInWithEmailLink",pq(t,n)));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function w$(){return(w$=tB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",_q(t,"POST","/v1/accounts:signInWithEmailLink",pq(t,n)));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var C$=function(e){Gv(n,e);var t=$v(n);function n(e,r,i){var a,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return tp(this,n),(a=t.call(this,"password",i))._email=e,a._password=r,a._tenantId=o,a}return rp(n,[{key:"toJSON",value:function(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}},{key:"_getIdTokenResponse",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:n.t0=t.signInMethod,n.next="password"===n.t0?3:"emailLink"===n.t0?4:5;break;case 3:return n.abrupt("return",function(e,t){return d$.apply(this,arguments)}(e,{returnSecureToken:!0,email:t._email,password:t._password}));case 4:return n.abrupt("return",function(e,t){return _$.apply(this,arguments)}(e,{email:t._email,oobCode:t._password}));case 5:QG(e,"internal-error");case 6:case"end":return n.stop()}},n)}))()}},{key:"_linkToIdToken",value:function(e,t){var n=this;return tB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:r.t0=n.signInMethod,r.next="password"===r.t0?3:"emailLink"===r.t0?4:5;break;case 3:return r.abrupt("return",function(e,t){return f$.apply(this,arguments)}(e,{idToken:t,returnSecureToken:!0,email:n._email,password:n._password}));case 4:return r.abrupt("return",function(e,t){return w$.apply(this,arguments)}(e,{idToken:t,email:n._email,oobCode:n._password}));case 5:QG(e,"internal-error");case 6:case"end":return r.stop()}},r)}))()}},{key:"_getReauthenticationResolver",value:function(e){return this._getIdTokenResponse(e)}}],[{key:"_fromEmailAndPassword",value:function(e,t){return new n(e,t,"password")}},{key:"_fromEmailAndCode",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return new n(e,t,"emailLink",r)}},{key:"fromJSON",value:function(e){var t="string"==typeof e?JSON.parse(e):e;if((null==t?void 0:t.email)&&(null==t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}}]),n}(h$);function b$(e,t){return E$.apply(this,arguments)}function E$(){return(E$=tB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",_q(t,"POST","/v1/accounts:signInWithIdp",pq(t,n)));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var S$=function(e){Gv(n,e);var t=$v(n);function n(){var e;return tp(this,n),(e=t.apply(this,arguments)).pendingToken=null,e}return rp(n,[{key:"toJSON",value:function(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}},{key:"_getIdTokenResponse",value:function(e){return b$(e,this.buildRequest())}},{key:"_linkToIdToken",value:function(e,t){var n=this.buildRequest();return n.idToken=t,b$(e,n)}},{key:"_getReauthenticationResolver",value:function(e){var t=this.buildRequest();return t.autoCreate=!1,b$(e,t)}},{key:"buildRequest",value:function(){var e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{var t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=UB(t)}return e}}],[{key:"_fromParams",value:function(e){var t=new n(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):QG("argument-error"),t}},{key:"fromJSON",value:function(e){var t="string"==typeof e?JSON.parse(e):e,r=t.providerId,i=t.signInMethod,a=Fp(t,["providerId","signInMethod"]);if(!r||!i)return null;var o=new n(r,i);return o.idToken=a.idToken||void 0,o.accessToken=a.accessToken||void 0,o.secret=a.secret,o.nonce=a.nonce,o.pendingToken=a.pendingToken||null,o}}]),n}(h$),P$=function(){function e(t){var n,r,i,a,o,s;tp(this,e);var u=zB(HB(t)),c=null!==(n=u.apiKey)&&void 0!==n?n:null,l=null!==(r=u.oobCode)&&void 0!==r?r:null,h=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(i=u.mode)&&void 0!==i?i:null);rq(c&&l&&h,"argument-error"),this.apiKey=c,this.operation=h,this.code=l,this.continueUrl=null!==(a=u.continueUrl)&&void 0!==a?a:null,this.languageCode=null!==(o=u.languageCode)&&void 0!==o?o:null,this.tenantId=null!==(s=u.tenantId)&&void 0!==s?s:null}return rp(e,null,[{key:"parseLink",value:function(t){var n=function(e){var t=zB(HB(e)).link,n=t?zB(HB(t)).deep_link_id:null,r=zB(HB(e)).deep_link_id;return(r?zB(HB(r)).link:null)||r||n||t||e}(t);try{return new e(n)}catch(r){return null}}}]),e}(),O$=function(){var e=function(){function e(){tp(this,e),this.providerId=e.PROVIDER_ID}return rp(e,null,[{key:"credential",value:function(e,t){return C$._fromEmailAndPassword(e,t)}},{key:"credentialWithLink",value:function(e,t){var n=P$.parseLink(t);return rq(n,"argument-error"),C$._fromEmailAndCode(e,n.code,n.tenantId)}}]),e}();return e.PROVIDER_ID="password",e.EMAIL_PASSWORD_SIGN_IN_METHOD="password",e.EMAIL_LINK_SIGN_IN_METHOD="emailLink",e}(),T$=function(){function e(t){tp(this,e),this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}return rp(e,[{key:"setDefaultLanguage",value:function(e){this.defaultLanguageCode=e}},{key:"setCustomParameters",value:function(e){return this.customParameters=e,this}},{key:"getCustomParameters",value:function(){return this.customParameters}}]),e}(),I$=function(e){Gv(n,e);var t=$v(n);function n(){var e;return tp(this,n),(e=t.apply(this,arguments)).scopes=[],e}return rp(n,[{key:"addScope",value:function(e){return this.scopes.includes(e)||this.scopes.push(e),this}},{key:"getScopes",value:function(){return Kv(this.scopes)}}]),n}(T$),x$=function(){var e=function(e){Gv(n,e);var t=$v(n);function n(){var e;return tp(this,n),(e=t.call(this,"google.com")).addScope("profile"),e}return rp(n,null,[{key:"credential",value:function(e,t){return S$._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}},{key:"credentialFromResult",value:function(e){return n.credentialFromTaggedObject(e)}},{key:"credentialFromError",value:function(e){return n.credentialFromTaggedObject(e.customData||{})}},{key:"credentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t)return null;var r=t.oauthIdToken,i=t.oauthAccessToken;if(!r&&!i)return null;try{return n.credential(r,i)}catch(a){return null}}}]),n}(I$);return e.GOOGLE_SIGN_IN_METHOD="google.com",e.PROVIDER_ID="google.com",e}();function A$(e,t){return R$.apply(this,arguments)}function R$(){return(R$=tB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",_q(t,"POST","/v1/accounts:signUp",pq(t,n)));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var N$=function(){function e(t){tp(this,e),this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}return rp(e,null,[{key:"_fromIdTokenResponse",value:function(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return tB(regeneratorRuntime.mark(function a(){var o,s;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,$q._fromIdTokenResponse(t,r,i);case 2:return o=a.sent,s=M$(r),a.abrupt("return",new e({user:o,providerId:s,_tokenResponse:r,operationType:n}));case 5:case"end":return a.stop()}},a)}))()}},{key:"_forOperation",value:function(t,n,r){return tB(regeneratorRuntime.mark(function i(){var a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,t._updateTokensIfNecessary(r,!0);case 2:return a=M$(r),i.abrupt("return",new e({user:t,providerId:a,_tokenResponse:r,operationType:n}));case 4:case"end":return i.stop()}},i)}))()}}]),e}();function M$(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}var D$=function(e){Gv(n,e);var t=$v(n);function n(e,r,i,a){var o,s;return tp(this,n),(o=t.call(this,r.code,r.message)).operationType=i,o.user=a,Object.setPrototypeOf(jv(o),n.prototype),o.customData={appName:e.name,tenantId:null!==(s=e.tenantId)&&void 0!==s?s:void 0,_serverResponse:r.customData._serverResponse,operationType:i},o}return rp(n,null,[{key:"_fromErrorAndOperation",value:function(e,t,r,i){return new n(e,t,r,i)}}]),n}(TB);function L$(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch(function(n){throw"auth/multi-factor-auth-required"===n.code?D$._fromErrorAndOperation(e,n,t,r):n})}function F$(e,t){return B$.apply(this,arguments)}function B$(){return(B$=tB(regeneratorRuntime.mark(function e(t,n){var r,i,a=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.length>2&&void 0!==a[2]&&a[2],e.t0=Rq,e.t1=t,e.t2=n,e.t3=t.auth,e.next=7,t.getIdToken();case 7:return e.t4=e.sent,e.t5=e.t2._linkToIdToken.call(e.t2,e.t3,e.t4),e.t6=r,e.next=12,(0,e.t0)(e.t1,e.t5,e.t6);case 12:return i=e.sent,e.abrupt("return",N$._forOperation(t,"link",i));case 14:case"end":return e.stop()}},e)}))).apply(this,arguments)}function V$(){return(V$=tB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s,u,c=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=c.length>2&&void 0!==c[2]&&c[2],i=t.auth,a="reauthenticate",e.prev=2,e.next=5,Rq(t,L$(i,a,n,t),r);case 5:return rq((o=e.sent).idToken,i,"internal-error"),rq(s=Aq(o.idToken),i,"internal-error"),u=s.sub,e.abrupt("return",(rq(t.uid===u,i,"user-mismatch"),N$._forOperation(t,a,o)));case 13:throw e.prev=13,e.t0=e.catch(2),"auth/user-not-found"===(null==e.t0?void 0:e.t0.code)&&QG(i,"user-mismatch"),e.t0;case 16:case"end":return e.stop()}},e,null,[[2,13]])}))).apply(this,arguments)}function U$(e,t){return z$.apply(this,arguments)}function z$(){return(z$=tB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=s.length>2&&void 0!==s[2]&&s[2],i="signIn",e.next=4,L$(t,i,n);case 4:return a=e.sent,e.next=7,N$._fromIdTokenResponse(t,i,a);case 7:if(o=e.sent,e.t0=r,e.t0){e.next=12;break}return e.next=12,t._updateCurrentUser(o.user);case 12:return e.abrupt("return",o);case 13:case"end":return e.stop()}},e)}))).apply(this,arguments)}function H$(){return(H$=tB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",U$(s$(t),n));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function G$(e,t,n){var r;rq((null===(r=n.url)||void 0===r?void 0:r.length)>0,e,"invalid-continue-uri"),rq(void 0===n.dynamicLinkDomain||n.dynamicLinkDomain.length>0,e,"invalid-dynamic-link-domain"),t.continueUrl=n.url,t.dynamicLinkDomain=n.dynamicLinkDomain,t.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(rq(n.iOS.bundleId.length>0,e,"missing-ios-bundle-id"),t.iOSBundleId=n.iOS.bundleId),n.android&&(rq(n.android.packageName.length>0,e,"missing-android-pkg-name"),t.androidInstallApp=n.android.installApp,t.androidMinimumVersionCode=n.android.minimumVersion,t.androidPackageName=n.android.packageName)}function q$(){return(q$=tB(regeneratorRuntime.mark(function e(t,n,r){var i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=YB(t),a={requestType:"PASSWORD_RESET",email:n},r&&G$(i,a,r),e.next=4,m$(i,a);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function $$(){return($$=tB(regeneratorRuntime.mark(function e(t,n,r){var i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=s$(t),e.next=3,A$(i,{returnSecureToken:!0,email:n,password:r});case 3:return a=e.sent,e.next=6,N$._fromIdTokenResponse(i,"signIn",a);case 6:return o=e.sent,e.next=9,i._updateCurrentUser(o.user);case 9:return e.abrupt("return",o);case 10:case"end":return e.stop()}},e)}))).apply(this,arguments)}function W$(){return(W$=tB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=YB(t),e.next=3,t.getIdToken();case 3:return e.t0=e.sent,i={requestType:"VERIFY_EMAIL",idToken:e.t0},n&&G$(r.auth,i,n),e.next=8,g$(r.auth,i);case 8:if(a=e.sent,o=a.email,e.t1=o!==t.email,!e.t1){e.next=14;break}return e.next=14,t.reload();case 14:case"end":return e.stop()}},e)}))).apply(this,arguments)}function j$(e,t){return Z$.apply(this,arguments)}function Z$(){return(Z$=tB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",gq(t,"POST","/v1/accounts:update",n));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Y$(){return(Y$=tB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.displayName,i=n.photoURL,void 0!==r||void 0!==i){e.next=3;break}return e.abrupt("return");case 3:return a=YB(t),e.next=6,a.getIdToken();case 6:return e.t0=e.sent,e.t1=r,e.t2=i,e.t3=!0,o={idToken:e.t0,displayName:e.t1,photoUrl:e.t2,returnSecureToken:e.t3},e.next=13,Rq(a,j$(a.auth,o));case 13:return s=e.sent,a.displayName=s.displayName||null,a.photoURL=s.photoUrl||null,(u=a.providerData.find(function(e){return"password"===e.providerId}))&&(u.displayName=a.displayName,u.photoURL=a.photoURL),e.next=19,a._updateTokensIfNecessary(s);case 19:case"end":return e.stop()}},e)}))).apply(this,arguments)}new WeakMap;var K$="__sak",J$=function(){function e(t,n){tp(this,e),this.storageRetriever=t,this.type=n}return rp(e,[{key:"_isAvailable",value:function(){try{return this.storage?(this.storage.setItem(K$,"1"),this.storage.removeItem(K$),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}},{key:"_set",value:function(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}},{key:"_get",value:function(e){var t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}},{key:"_remove",value:function(e){return this.storage.removeItem(e),Promise.resolve()}},{key:"storage",get:function(){return this.storageRetriever()}}]),e}(),Q$=function(){var e=function(e){Gv(n,e);var t=$v(n);function n(){var e;return tp(this,n),(e=t.call(this,function(){return window.localStorage},"LOCAL")).boundEventHandler=function(t,n){return e.onStorageEvent(t,n)},e.listeners={},e.localCache={},e.pollTimer=null,e.safariLocalStorageNotSynced=function(){var e=_B();return Jq(e)||r$(e)}()&&function(){try{return!(!window||window===window.top)}catch(e){return!1}}(),e.fallbackToPolling=i$(),e._shouldAllowMigration=!0,e}return rp(n,[{key:"forAllChangedKeys",value:function(e){for(var t=0,n=Object.keys(this.listeners);t<n.length;t++){var r=n[t],i=this.storage.getItem(r),a=this.localCache[r];i!==a&&e(r,a,i)}}},{key:"onStorageEvent",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e.key){var r=e.key;if(n?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){var i=this.storage.getItem(r);if(e.newValue!==i)null!==e.newValue?this.storage.setItem(r,e.newValue):this.storage.removeItem(r);else if(this.localCache[r]===e.newValue&&!n)return}var a=function(){var e=t.storage.getItem(r);!n&&t.localCache[r]===e||t.notifyListeners(r,e)},o=this.storage.getItem(r);EB()&&10===document.documentMode&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,10):a()}else this.forAllChangedKeys(function(e,n,r){t.notifyListeners(e,r)})}},{key:"notifyListeners",value:function(e,t){this.localCache[e]=t;var n=this.listeners[e];if(n)for(var r=0,i=Array.from(n);r<i.length;r++){(0,i[r])(t&&JSON.parse(t))}}},{key:"startPolling",value:function(){var e=this;this.stopPolling(),this.pollTimer=setInterval(function(){e.forAllChangedKeys(function(t,n,r){e.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:n,newValue:r}),!0)})},1e3)}},{key:"stopPolling",value:function(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}},{key:"attachListener",value:function(){window.addEventListener("storage",this.boundEventHandler)}},{key:"detachListener",value:function(){window.removeEventListener("storage",this.boundEventHandler)}},{key:"_addListener",value:function(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}},{key:"_removeListener",value:function(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}},{key:"_set",value:function(e,t){var r=this,i=this;return tB(regeneratorRuntime.mark(function a(){return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,zv(Yv(n.prototype),"_set",r).call(i,e,t);case 2:i.localCache[e]=JSON.stringify(t);case 3:case"end":return a.stop()}},a)}))()}},{key:"_get",value:function(e){var t=this,r=this;return tB(regeneratorRuntime.mark(function i(){var a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,zv(Yv(n.prototype),"_get",t).call(r,e);case 2:return a=i.sent,i.abrupt("return",(r.localCache[e]=JSON.stringify(a),a));case 4:case"end":return i.stop()}},i)}))()}},{key:"_remove",value:function(e){var t=this,r=this;return tB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,zv(Yv(n.prototype),"_remove",t).call(r,e);case 2:delete r.localCache[e];case 3:case"end":return i.stop()}},i)}))()}}]),n}(J$);return e.type="LOCAL",e}(),X$=function(){var e=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.call(this,function(){return window.sessionStorage},"SESSION")}return rp(n,[{key:"_addListener",value:function(e,t){}},{key:"_removeListener",value:function(e,t){}}]),n}(J$);return e.type="SESSION",e}(),eW=function(){var e=function(){function e(t){tp(this,e),this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}return rp(e,[{key:"isListeningto",value:function(e){return this.eventTarget===e}},{key:"handleEvent",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function n(){var r,i,a,o,s,u,c,l;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(i=(r=e).data,a=i.eventId,o=i.eventType,s=i.data,null==(u=t.handlersMap[o])?void 0:u.size){n.next=3;break}return n.abrupt("return");case 3:return r.ports[0].postMessage({status:"ack",eventId:a,eventType:o}),c=Array.from(u).map(function(){var e=tB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t(r.origin,s));case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),n.next=7,function(e){return Promise.all(e.map((t=tB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.t0=!0,e.next=4,t;case 4:return e.t1=e.sent,e.abrupt("return",{fulfilled:e.t0,value:e.t1});case 8:return e.prev=8,e.t2=e.catch(0),e.abrupt("return",{fulfilled:!1,reason:e.t2});case 11:case"end":return e.stop()}},e,null,[[0,8]])})),function(e){return t.apply(this,arguments)})));var t}(c);case 7:l=n.sent,r.ports[0].postMessage({status:"done",eventId:a,eventType:o,response:l});case 9:case"end":return n.stop()}},n)}))()}},{key:"_subscribe",value:function(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}},{key:"_unsubscribe",value:function(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||0===this.handlersMap[e].size)&&delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}],[{key:"_getInstance",value:function(t){var n=this.receivers.find(function(e){return e.isListeningto(t)});if(n)return n;var r=new e(t);return this.receivers.push(r),r}}]),e}();return e.receivers=[],e}();function tW(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n="",r=0;r<t;r++)n+=Math.floor(10*Math.random());return e+n}var nW=function(){function e(t){tp(this,e),this.target=t,this.handlers=new Set}return rp(e,[{key:"removeMessageHandler",value:function(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}},{key:"_send",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50,r=this;return tB(regeneratorRuntime.mark(function i(){var a,o,s;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(a="undefined"!=typeof MessageChannel?new MessageChannel:null){i.next=3;break}throw new Error("connection_unavailable");case 3:return i.abrupt("return",new Promise(function(i,u){var c=tW("",20);a.port1.start();var l=setTimeout(function(){u(new Error("unsupported_event"))},n);s={messageChannel:a,onMessage:function(e){var t=e;if(t.data.eventId===c)switch(t.data.status){case"ack":clearTimeout(l),o=setTimeout(function(){u(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),i(t.data.response);break;default:clearTimeout(l),clearTimeout(o),u(new Error("invalid_response"))}}},r.handlers.add(s),a.port1.addEventListener("message",s.onMessage),r.target.postMessage({eventType:e,eventId:c,data:t},[a.port2])}).finally(function(){s&&r.removeMessageHandler(s)}));case 4:case"end":return i.stop()}},i)}))()}}]),e}();function rW(){return window}function iW(){return void 0!==rW().WorkerGlobalScope&&"function"==typeof rW().importScripts}function aW(){return(aW=tB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null==navigator?void 0:navigator.serviceWorker){e.next=2;break}return e.abrupt("return",null);case 2:return e.prev=2,e.next=5,navigator.serviceWorker.ready;case 5:return e.abrupt("return",e.sent.active);case 8:return e.prev=8,e.t0=e.catch(2),e.abrupt("return",null);case 11:case"end":return e.stop()}},e,null,[[2,8]])}))).apply(this,arguments)}var oW="firebaseLocalStorageDb",sW="firebaseLocalStorage",uW="fbase_key",cW=function(){function e(t){tp(this,e),this.request=t}return rp(e,[{key:"toPromise",value:function(){var e=this;return new Promise(function(t,n){e.request.addEventListener("success",function(){t(e.request.result)}),e.request.addEventListener("error",function(){n(e.request.error)})})}}]),e}();function lW(e,t){return e.transaction([sW],t?"readwrite":"readonly").objectStore(sW)}function hW(){var e=indexedDB.open(oW,1);return new Promise(function(t,n){e.addEventListener("error",function(){n(e.error)}),e.addEventListener("upgradeneeded",function(){var t=e.result;try{t.createObjectStore(sW,{keyPath:uW})}catch(r){n(r)}}),e.addEventListener("success",tB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=e.result).objectStoreNames.contains(sW)){n.next=5;break}t(r),n.next=13;break;case 5:return r.close(),n.next=8,function(){var e=indexedDB.deleteDatabase(oW);return new cW(e).toPromise()}();case 8:return n.t0=t,n.next=11,hW();case 11:n.t1=n.sent,(0,n.t0)(n.t1);case 13:case"end":return n.stop()}},n)})))})}function fW(e,t,n){return dW.apply(this,arguments)}function dW(){return(dW=tB(regeneratorRuntime.mark(function e(t,n,r){var i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=lW(t,!0).put((Dv(i={},uW,n),Dv(i,"value",r),i)),e.abrupt("return",new cW(a).toPromise());case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}function vW(){return(vW=tB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=lW(t,!1).get(n),e.next=3,new cW(r).toPromise();case 3:return i=e.sent,e.abrupt("return",void 0===i?null:i.value);case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}function pW(e,t){var n=lW(e,!0).delete(t);return new cW(n).toPromise()}var gW=function(){var e=function(){function e(){tp(this,e),this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(function(){},function(){})}return rp(e,[{key:"_openDb",value:function(){var e=this;return tB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=e.db,t.t0){t.next=5;break}return t.next=4,hW();case 4:e.db=t.sent;case 5:return t.abrupt("return",e.db);case 6:case"end":return t.stop()}},t)}))()}},{key:"_withRetries",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:r=0;case 1:return n.prev=1,n.next=4,t._openDb();case 4:return i=n.sent,n.next=7,e(i);case 7:return n.abrupt("return",n.sent);case 10:if(n.prev=10,n.t0=n.catch(1),!(r++>3)){n.next=14;break}throw n.t0;case 14:t.db&&(t.db.close(),t.db=void 0);case 15:n.next=1;break;case 17:case"end":return n.stop()}},n,null,[[1,10]])}))()}},{key:"initializeServiceWorkerMessaging",value:function(){var e=this;return tB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",iW()?e.initializeReceiver():e.initializeSender());case 1:case"end":return t.stop()}},t)}))()}},{key:"initializeReceiver",value:function(){var e=this;return tB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.receiver=eW._getInstance(iW()?self:null),e.receiver._subscribe("keyChanged",function(){var t=tB(regeneratorRuntime.mark(function t(n,r){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e._poll();case 2:return t.t0=t.sent.includes(r.key),t.abrupt("return",{keyProcessed:t.t0});case 4:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}()),e.receiver._subscribe("ping",function(){var e=tB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",["keyChanged"]);case 1:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}());case 1:case"end":return t.stop()}},t)}))()}},{key:"initializeSender",value:function(){var e=this;return tB(regeneratorRuntime.mark(function t(){var n,r,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,function(){return aW.apply(this,arguments)}();case 2:if(e.activeServiceWorker=t.sent,e.activeServiceWorker){t.next=5;break}return t.abrupt("return");case 5:return e.sender=new nW(e.activeServiceWorker),t.next=8,e.sender._send("ping",{},800);case 8:!(i=t.sent)||(null===(n=i[0])||void 0===n?void 0:n.fulfilled)&&(null===(r=i[0])||void 0===r?void 0:r.value.includes("keyChanged"))&&(e.serviceWorkerReceiverAvailable=!0);case 10:case"end":return t.stop()}},t)}))()}},{key:"notifyServiceWorker",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!t.sender||!t.activeServiceWorker||function(){var e;return(null===(e=null==navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null}()!==t.activeServiceWorker){n.next=8;break}return n.prev=1,n.next=4,t.sender._send("keyChanged",{key:e},t.serviceWorkerReceiverAvailable?800:50);case 4:n.next=8;break;case 6:n.prev=6,n.t0=n.catch(1);case 8:case"end":return n.stop()}},n,null,[[1,6]])}))()}},{key:"_isAvailable",value:function(){return tB(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,indexedDB){e.next=3;break}return e.abrupt("return",!1);case 3:return e.next=5,hW();case 5:return t=e.sent,e.next=8,fW(t,K$,"1");case 8:return e.next=10,pW(t,K$);case 10:return e.abrupt("return",!0);case 13:e.prev=13,e.t0=e.catch(0);case 15:return e.abrupt("return",!1);case 16:case"end":return e.stop()}},e,null,[[0,13]])}))()}},{key:"_withPendingWrite",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t.pendingWrites++,n.prev=1,n.next=4,e();case 4:return n.prev=4,t.pendingWrites--,n.finish(4);case 7:case"end":return n.stop()}},n,null,[[1,,4,7]])}))()}},{key:"_set",value:function(e,t){var n=this;return tB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",n._withPendingWrite(tB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n._withRetries(function(n){return fW(n,e,t)});case 2:return n.localCache[e]=t,r.abrupt("return",n.notifyServiceWorker(e));case 4:case"end":return r.stop()}},r)}))));case 1:case"end":return r.stop()}},r)}))()}},{key:"_get",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t._withRetries(function(t){return function(e,t){return vW.apply(this,arguments)}(t,e)});case 2:return r=n.sent,n.abrupt("return",(t.localCache[e]=r,r));case 4:case"end":return n.stop()}},n)}))()}},{key:"_remove",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t._withPendingWrite(tB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t._withRetries(function(t){return pW(t,e)});case 2:return delete t.localCache[e],n.abrupt("return",t.notifyServiceWorker(e));case 4:case"end":return n.stop()}},n)}))));case 1:case"end":return n.stop()}},n)}))()}},{key:"_poll",value:function(){var e=this;return tB(regeneratorRuntime.mark(function t(){var n,r,i,a,o,s,u,c,l,h,f;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e._withRetries(function(e){var t=lW(e,!1).getAll();return new cW(t).toPromise()});case 2:if(n=t.sent){t.next=5;break}return t.abrupt("return",[]);case 5:if(0===e.pendingWrites){t.next=7;break}return t.abrupt("return",[]);case 7:r=[],i=new Set,a=Qv(n);try{for(a.s();!(o=a.n()).done;)s=o.value,u=s.fbase_key,c=s.value,i.add(u),JSON.stringify(e.localCache[u])!==JSON.stringify(c)&&(e.notifyListeners(u,c),r.push(u))}catch(d){a.e(d)}finally{a.f()}for(l=0,h=Object.keys(e.localCache);l<h.length;l++)f=h[l],e.localCache[f]&&!i.has(f)&&(e.notifyListeners(f,null),r.push(f));return t.abrupt("return",r);case 12:case"end":return t.stop()}},t)}))()}},{key:"notifyListeners",value:function(e,t){this.localCache[e]=t;var n=this.listeners[e];if(n)for(var r=0,i=Array.from(n);r<i.length;r++){(0,i[r])(t)}}},{key:"startPolling",value:function(){var e=this;this.stopPolling(),this.pollTimer=setInterval(tB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e._poll());case 1:case"end":return t.stop()}},t)})),800)}},{key:"stopPolling",value:function(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}},{key:"_addListener",value:function(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}},{key:"_removeListener",value:function(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}]),e}();return e.type="LOCAL",e}();function yW(e){return"__".concat(e).concat(Math.floor(1e6*Math.random()))}function mW(e,t){return t?sq(t):(rq(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}yW("rcb"),new lq(3e4,6e4);var kW=function(e){Gv(n,e);var t=$v(n);function n(e){var r;return tp(this,n),(r=t.call(this,"custom","custom")).params=e,r}return rp(n,[{key:"_getIdTokenResponse",value:function(e){return b$(e,this._buildIdpRequest())}},{key:"_linkToIdToken",value:function(e,t){return b$(e,this._buildIdpRequest(t))}},{key:"_getReauthenticationResolver",value:function(e){return b$(e,this._buildIdpRequest())}},{key:"_buildIdpRequest",value:function(e){var t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}]),n}(h$);function _W(e){return U$(e.auth,new kW(e),e.bypassAuthState)}function wW(e){var t=e.auth,n=e.user;return rq(n,t,"internal-error"),function(e,t){return V$.apply(this,arguments)}(n,new kW(e),e.bypassAuthState)}function CW(e){return bW.apply(this,arguments)}function bW(){return(bW=tB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.auth,r=t.user,e.abrupt("return",(rq(r,n,"internal-error"),F$(r,new kW(t),t.bypassAuthState)));case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}var EW=function(){function e(t,n,r,i){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];tp(this,e),this.auth=t,this.resolver=r,this.user=i,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}return rp(e,[{key:"execute",value:function(){var e,t=this;return new Promise((e=tB(regeneratorRuntime.mark(function e(n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.pendingPromise={resolve:n,reject:r},e.prev=1,e.next=4,t.resolver._initialize(t.auth);case 4:return t.eventManager=e.sent,e.next=7,t.onExecution();case 7:t.eventManager.registerConsumer(t),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),t.reject(e.t0);case 13:case"end":return e.stop()}},e,null,[[1,10]])})),function(t,n){return e.apply(this,arguments)}))}},{key:"onAuthEvent",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function n(){var r,i,a,o,s,u,c;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r=e.urlResponse,i=e.sessionId,a=e.postBody,o=e.tenantId,s=e.error,u=e.type,!s){n.next=3;break}return n.abrupt("return",void t.reject(s));case 3:return c={auth:t.auth,requestUri:r,sessionId:i,tenantId:o||void 0,postBody:a||void 0,user:t.user,bypassAuthState:t.bypassAuthState},n.prev=4,n.t0=t,n.next=8,t.getIdpTask(u)(c);case 8:n.t1=n.sent,n.t0.resolve.call(n.t0,n.t1),n.next=15;break;case 12:n.prev=12,n.t2=n.catch(4),t.reject(n.t2);case 15:case"end":return n.stop()}},n,null,[[4,12]])}))()}},{key:"onError",value:function(e){this.reject(e)}},{key:"getIdpTask",value:function(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return _W;case"linkViaPopup":case"linkViaRedirect":return CW;case"reauthViaPopup":case"reauthViaRedirect":return wW;default:QG(this.auth,"internal-error")}}},{key:"resolve",value:function(e){aq(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}},{key:"reject",value:function(e){aq(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}},{key:"unregisterAndCleanUp",value:function(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}]),e}(),SW=new lq(2e3,1e4);function PW(){return(PW=tB(regeneratorRuntime.mark(function e(t,n,r){var i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=s$(t),tq(t,n,T$),a=mW(i,r),e.abrupt("return",new OW(i,"signInViaPopup",n,a).executeNotNull());case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}var OW=function(){var e=function(e){Gv(n,e);var t=$v(n);function n(e,r,i,a,o){var s;return tp(this,n),(s=t.call(this,e,r,a,o)).provider=i,s.authWindow=null,s.pollId=null,n.currentPopupAction&&n.currentPopupAction.cancel(),n.currentPopupAction=jv(s),s}return rp(n,[{key:"executeNotNull",value:function(){var e=this;return tB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.execute();case 2:return n=t.sent,t.abrupt("return",(rq(n,e.auth,"internal-error"),n));case 4:case"end":return t.stop()}},t)}))()}},{key:"onExecution",value:function(){var e=this;return tB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return aq(1===e.filter.length,"Popup operations only handle one event"),n=tW(),t.next=4,e.resolver._openPopup(e.auth,e.provider,e.filter[0],n);case 4:e.authWindow=t.sent,e.authWindow.associatedEvent=n,e.resolver._originValidation(e.auth).catch(function(t){e.reject(t)}),e.resolver._isIframeWebStorageSupported(e.auth,function(t){t||e.reject(XG(e.auth,"web-storage-unsupported"))}),e.pollUserCancellation();case 9:case"end":return t.stop()}},t)}))()}},{key:"eventId",get:function(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}},{key:"cancel",value:function(){this.reject(XG(this.auth,"cancelled-popup-request"))}},{key:"cleanUp",value:function(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,n.currentPopupAction=null}},{key:"pollUserCancellation",value:function(){var e=this;!function t(){var n,r;e.pollId=(null===(r=null===(n=e.authWindow)||void 0===n?void 0:n.window)||void 0===r?void 0:r.closed)?window.setTimeout(function(){e.pollId=null,e.reject(XG(e.auth,"popup-closed-by-user"))},2e3):window.setTimeout(t,SW.get())}()}}]),n}(EW);return e.currentPopupAction=null,e}(),TW=new Map,IW=function(e){Gv(n,e);var t=$v(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return tp(this,n),(i=t.call(this,e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,a)).eventId=null,i}return rp(n,[{key:"execute",value:function(){var e=this,t=this;return tB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=TW.get(t.auth._key())){r.next=20;break}return r.prev=2,r.next=5,function(e,t){return xW.apply(this,arguments)}(t.resolver,t.auth);case 5:if(!r.sent){r.next=11;break}return r.next=8,zv(Yv(n.prototype),"execute",e).call(t);case 8:r.t0=r.sent,r.next=12;break;case 11:r.t0=null;case 12:a=r.t0,i=function(){return Promise.resolve(a)},r.next=19;break;case 16:r.prev=16,r.t1=r.catch(2),i=function(){return Promise.reject(r.t1)};case 19:TW.set(t.auth._key(),i);case 20:return r.abrupt("return",(t.bypassAuthState||TW.set(t.auth._key(),function(){return Promise.resolve(null)}),i()));case 21:case"end":return r.stop()}},r,null,[[2,16]])}))()}},{key:"onAuthEvent",value:function(e){var t=this,r=function(){return zv(Yv(n.prototype),"onAuthEvent",t)},i=this;return tB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if("signInViaRedirect"!==e.type){t.next=2;break}return t.abrupt("return",r().call(i,e));case 2:if("unknown"===e.type){t.next=12;break}if(!e.eventId){t.next=10;break}return t.next=6,i.auth._redirectUserForId(e.eventId);case 6:if(!(n=t.sent)){t.next=9;break}return t.abrupt("return",(i.user=n,r().call(i,e)));case 9:i.resolve(null);case 10:t.next=13;break;case 12:i.resolve(null);case 13:case"end":return t.stop()}},t)}))()}},{key:"onExecution",value:function(){return tB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e)}))()}},{key:"cleanUp",value:function(){}}]),n}(EW);function xW(){return(xW=tB(regeneratorRuntime.mark(function e(t,n){var r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=RW(n),i=AW(t),e.next=3,i._isAvailable();case 3:if(e.sent){e.next=5;break}return e.abrupt("return",!1);case 5:return e.next=7,i._get(r);case 7:return e.t0=e.sent,a="true"===e.t0,e.next=11,i._remove(r);case 11:return e.abrupt("return",a);case 12:case"end":return e.stop()}},e)}))).apply(this,arguments)}function AW(e){return sq(e._redirectPersistence)}function RW(e){return jq("pendingRedirect",e.config.apiKey,e.name)}function NW(e,t){return MW.apply(this,arguments)}function MW(){return(MW=tB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=s.length>2&&void 0!==s[2]&&s[2],i=s$(t),a=mW(i,n),e.next=5,new IW(i,a,r).execute();case 5:if(o=e.sent,e.t0=o&&!r,!e.t0){e.next=13;break}return delete o.user._redirectEventId,e.next=11,i._persistUserIfCurrent(o.user);case 11:return e.next=13,i._setRedirectUser(null,n);case 13:return e.abrupt("return",o);case 14:case"end":return e.stop()}},e)}))).apply(this,arguments)}var DW=function(){function e(t){tp(this,e),this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}return rp(e,[{key:"registerConsumer",value:function(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}},{key:"unregisterConsumer",value:function(e){this.consumers.delete(e)}},{key:"onEvent",value:function(e){var t=this;if(this.hasEventBeenHandled(e))return!1;var n=!1;return this.consumers.forEach(function(r){t.isEventForConsumer(e,r)&&(n=!0,t.sendToConsumer(e,r),t.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return FW(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}},{key:"sendToConsumer",value:function(e,t){var n;if(e.error&&!FW(e)){var r=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(XG(this.auth,r))}else t.onAuthEvent(e)}},{key:"isEventForConsumer",value:function(e,t){var n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}},{key:"hasEventBeenHandled",value:function(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(LW(e))}},{key:"saveEventToCache",value:function(e){this.cachedEventUids.add(LW(e)),this.lastProcessedEventTime=Date.now()}}]),e}();function LW(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(function(e){return e}).join("-")}function FW(e){var t=e.type,n=e.error;return"unknown"===t&&"auth/no-auth-event"===(null==n?void 0:n.code)}function BW(e){return VW.apply(this,arguments)}function VW(){return(VW=tB(regeneratorRuntime.mark(function e(t){var n,r=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:{},e.abrupt("return",gq(t,"GET","/v1/projects",n));case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}var UW=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,zW=/^https?/;function HW(){return(HW=tB(regeneratorRuntime.mark(function e(t){var n,r,i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.config.emulator){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,BW(t);case 4:n=e.sent,r=n.authorizedDomains,i=Qv(r),e.prev=7,i.s();case 9:if((a=i.n()).done){e.next=20;break}if(o=a.value,e.prev=11,!GW(o)){e.next=14;break}return e.abrupt("return");case 14:e.next=18;break;case 16:e.prev=16,e.t0=e.catch(11);case 18:e.next=9;break;case 20:e.next=25;break;case 22:e.prev=22,e.t1=e.catch(7),i.e(e.t1);case 25:return e.prev=25,i.f(),e.finish(25);case 28:QG(t,"unauthorized-domain");case 29:case"end":return e.stop()}},e,null,[[7,22,25,28],[11,16]])}))).apply(this,arguments)}function GW(e){var t=uq(),n=new URL(t),r=n.protocol,i=n.hostname;if(e.startsWith("chrome-extension://")){var a=new URL(e);return""===a.hostname&&""===i?"chrome-extension:"===r&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===r&&a.hostname===i}if(!zW.test(r))return!1;if(UW.test(e))return i===e;var o=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+o+"|"+o+")$","i").test(i)}var qW=new lq(3e4,6e4);function $W(){var e=rW().___jsl;if(null==e?void 0:e.H)for(var t=0,n=Object.keys(e.H);t<n.length;t++){var r=n[t];if(e.H[r].r=e.H[r].r||[],e.H[r].L=e.H[r].L||[],e.H[r].r=Kv(e.H[r].L),e.CP)for(var i=0;i<e.CP.length;i++)e.CP[i]=null}}var WW=null;function jW(e){return WW=WW||function(e){return new Promise(function(t,n){var r,i,a;function o(){$W(),gapi.load("gapi.iframes",{callback:function(){t(gapi.iframes.getContext())},ontimeout:function(){$W(),n(XG(e,"network-request-failed"))},timeout:qW.get()})}if(null===(i=null===(r=rW().gapi)||void 0===r?void 0:r.iframes)||void 0===i?void 0:i.Iframe)t(gapi.iframes.getContext());else{if(!(null===(a=rW().gapi)||void 0===a?void 0:a.load)){var s=yW("iframefcb");return rW()[s]=function(){gapi.load?o():n(XG(e,"network-request-failed"))},function(e){return new Promise(function(t,n){var r=document.createElement("script");r.setAttribute("src",e),r.onload=t,r.onerror=function(e){var t=XG("internal-error");t.customData=e,n(t)},r.type="text/javascript",r.charset="UTF-8",function(){var e,t;return null!==(t=null===(e=document.getElementsByTagName("head"))||void 0===e?void 0:e[0])&&void 0!==t?t:document}().appendChild(r)})}("https://apis.google.com/js/api.js?onload=".concat(s)).catch(function(e){return n(e)})}o()}}).catch(function(e){throw WW=null,e})}(e)}var ZW=new lq(5e3,15e3),YW={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},KW=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function JW(e){var t=e.config;rq(t.authDomain,e,"auth-domain-config-required");var n=t.emulator?hq(t,"emulator/auth/iframe"):"https://".concat(e.config.authDomain,"/__/auth/iframe"),r={apiKey:t.apiKey,appName:e.name,v:kV},i=KW.get(e.config.apiHost);i&&(r.eid=i);var a=e._getFrameworks();return a.length&&(r.fw=a.join(",")),"".concat(n,"?").concat(UB(r).slice(1))}function QW(){return(QW=tB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,jW(t);case 2:return n=e.sent,r=rW().gapi,e.abrupt("return",(rq(r,t,"internal-error"),n.open({where:document.body,url:JW(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:YW,dontclear:!0},function(e){return new Promise((n=tB(regeneratorRuntime.mark(function n(r,i){var a,o,s;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return s=function(){rW().clearTimeout(o),r(e)},n.next=3,e.restyle({setHideOnLeave:!1});case 3:a=XG(t,"network-request-failed"),o=rW().setTimeout(function(){i(a)},ZW.get()),e.ping(s).then(s,function(){i(a)});case 5:case"end":return n.stop()}},n)})),function(e,t){return n.apply(this,arguments)}));var n})));case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}var XW={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},ej=function(){function e(t){tp(this,e),this.window=t,this.associatedEvent=null}return rp(e,[{key:"close",value:function(){if(this.window)try{this.window.close()}catch(e){}}}]),e}();function tj(e,t,n,r,i,a){rq(e.config.authDomain,e,"auth-domain-config-required"),rq(e.config.apiKey,e,"invalid-api-key");var o={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:r,v:kV,eventId:i};if(t instanceof T$){t.setDefaultLanguage(e.languageCode),o.providerId=t.providerId||"",LB(t.getCustomParameters())||(o.customParameters=JSON.stringify(t.getCustomParameters()));for(var s=0,u=Object.entries(a||{});s<u.length;s++){var c=Lv(u[s],2),l=c[0],h=c[1];o[l]=h}}if(t instanceof I$){var f=t.getScopes().filter(function(e){return""!==e});f.length>0&&(o.scopes=f.join(","))}e.tenantId&&(o.tid=e.tenantId);for(var d=o,v=0,p=Object.keys(d);v<p.length;v++){var g=p[v];void 0===d[g]&&delete d[g]}return"".concat(function(e){var t=e.config;return t.emulator?hq(t,"emulator/auth/handler"):"https://".concat(t.authDomain,"/__/auth/handler")}(e),"?").concat(UB(d).slice(1))}var nj="webStorageSupport",rj=function(){function e(){tp(this,e),this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=X$,this._completeRedirectFn=NW}return rp(e,[{key:"_openPopup",value:function(e,t,n,r){var i=this;return tB(regeneratorRuntime.mark(function a(){var o,s;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return aq(null===(o=i.eventManagers[e._key()])||void 0===o?void 0:o.manager,"_initialize() not called before _openPopup()"),s=tj(e,t,n,uq(),r),a.abrupt("return",function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:600,a=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString(),s="",u=Object.assign(Object.assign({},XW),{width:r.toString(),height:i.toString(),top:a,left:o}),c=_B().toLowerCase();n&&(s=Qq(c)?"_blank":n),Kq(c)&&(t=t||"http://localhost",u.scrollbars="yes");var l=Object.entries(u).reduce(function(e,t){var n=Lv(t,2),r=n[0],i=n[1];return"".concat(e).concat(r,"=").concat(i,",")},"");if(function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_B();return r$(t)&&!!(null===(e=window.navigator)||void 0===e?void 0:e.standalone)}(c)&&"_self"!==s)return function(e,t){var n=document.createElement("a");n.href=e,n.target=t;var r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(t||"",s),new ej(null);var h=window.open(t||"",s,l);rq(h,e,"popup-blocked");try{h.focus()}catch(f){}return new ej(h)}(e,s,tW()));case 3:case"end":return a.stop()}},a)}))()}},{key:"_openRedirect",value:function(e,t,n,r){var i=this;return tB(regeneratorRuntime.mark(function a(){return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,i._originValidation(e);case 2:return function(e){rW().location.href=e}(tj(e,t,n,uq(),r)),a.abrupt("return",new Promise(function(){}));case 4:case"end":return a.stop()}},a)}))()}},{key:"_initialize",value:function(e){var t=this,n=e._key();if(this.eventManagers[n]){var r=this.eventManagers[n],i=r.manager,a=r.promise;return i?Promise.resolve(i):(aq(a,"If manager is not set, promise should be"),a)}var o=this.initAndGetManager(e);return this.eventManagers[n]={promise:o},o.catch(function(){delete t.eventManagers[n]}),o}},{key:"initAndGetManager",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,function(e){return QW.apply(this,arguments)}(e);case 2:return r=n.sent,i=new DW(e),n.abrupt("return",(r.register("authEvent",function(t){return rq(null==t?void 0:t.authEvent,e,"invalid-auth-event"),{status:i.onEvent(t.authEvent)?"ACK":"ERROR"}},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),t.eventManagers[e._key()]={manager:i},t.iframes[e._key()]=r,i));case 5:case"end":return n.stop()}},n)}))()}},{key:"_isIframeWebStorageSupported",value:function(e,t){this.iframes[e._key()].send(nj,{type:nj},function(n){var r,i=null===(r=null==n?void 0:n[0])||void 0===r?void 0:r[nj];void 0!==i&&t(!!i),QG(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}},{key:"_originValidation",value:function(e){var t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=function(e){return HW.apply(this,arguments)}(e)),this.originValidationPromises[t]}},{key:"_shouldInitProactively",get:function(){return i$()||Jq()||r$()}}]),e}(),ij="@firebase/auth",aj=function(){function e(t){tp(this,e),this.auth=t,this.internalListeners=new Map}return rp(e,[{key:"getUid",value:function(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}},{key:"getToken",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t.assertAuthConfigured(),n.next=3,t.auth._initializationPromise;case 3:if(!t.auth.currentUser){n.next=10;break}return n.next=6,t.auth.currentUser.getIdToken(e);case 6:n.t1=n.sent,n.t0={accessToken:n.t1},n.next=11;break;case 10:n.t0=null;case 11:return n.abrupt("return",n.t0);case 12:case"end":return n.stop()}},n)}))()}},{key:"addAuthTokenListener",value:function(e){if(this.assertAuthConfigured(),!this.internalListeners.has(e)){var t=this.auth.onIdTokenChanged(function(t){var n;e((null===(n=t)||void 0===n?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}}},{key:"removeAuthTokenListener",value:function(e){this.assertAuthConfigured();var t=this.internalListeners.get(e);!t||(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}},{key:"assertAuthConfigured",value:function(){rq(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}},{key:"updateProactiveRefresh",value:function(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}]),e}();!function(e){pV(new KB("auth",function(t,n){var r=n.options,i=t.getProvider("app").getImmediate(),a=i.options,o=a.apiKey,s=a.authDomain;return function(t){rq(o&&!o.includes(":"),"invalid-api-key",{appName:t.name}),rq(!(null==s?void 0:s.includes(":")),"argument-error",{appName:t.name});var n={apiKey:o,authDomain:s,clientPlatform:e,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:a$(e)},i=new o$(t,n);return function(e,t){var n=(null==t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(sq);(null==t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null==t?void 0:t.popupRedirectResolver)}(i,r),i}(i)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(function(e,t,n){e.getProvider("auth-internal").initialize()})),pV(new KB("auth-internal",function(e){var t=s$(e.getProvider("auth").getImmediate());return new aj(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),CV(ij,"0.19.8",void 0),CV(ij,"0.19.8","esm2017")}("Browser");var oj=rp(function e(t){return tp(this,e),t}),sj=rp(function e(){return tp(this,e),JH("auth")}),uj=new ok("angularfire2.auth-instances");function cj(e){return function(t,n){var r=t.runOutsideAngular(function(){return e(n)});return new oj(r)}}var lj,hj={provide:sj,deps:[[new Mk,uj]]},fj={provide:oj,useFactory:function(e,t){var n=KH("auth",e,t);return n&&new oj(n)},deps:[[new Mk,uj],uG]},dj=function(){var e=rp(function e(){tp(this,e),CV("angularfire",WH.full,"auth")});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=iy({type:e}),e.\u0275inj=Sg({providers:[fj,hj]}),e}(),vj=sG(function(e,t,n){var r=s$(e);rq(r._canInitEmulator,r,"emulator-config-failed"),rq(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");var i=!!(null==n?void 0:n.disableWarnings),a=c$(t),o=function(e){var t=c$(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};var r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){var a=i[1];return{host:a,port:l$(r.substr(a.length+1))}}var o=Lv(r.split(":"),2);return{host:o[0],port:l$(o[1])}}(t),s=o.host,u=o.port;r.config.emulator={url:"".concat(a,"//").concat(s).concat(null===u?"":":".concat(u),"/")},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:s,port:u,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||function(){function e(){var e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()},!0),pj=sG(function(e,t,n){return $$.apply(this,arguments)},!0),gj=sG(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_V(),t=gV(e,"auth");return t.isInitialized()?t.getImmediate():function(e,t){var n=gV(e,"auth");if(n.isInitialized()){var r=n.getImmediate();if(BB(n.getOptions(),null!=t?t:{}))return r;QG(r,"already-initialized")}return n.initialize({options:t})}(e,{popupRedirectResolver:rj,persistence:[gW,Q$,X$]})},!0),yj=sG(function(e,t,n,r){return YB(e).onAuthStateChanged(t,n,r)},!0),mj=sG(function(e,t){return W$.apply(this,arguments)},!0),kj=sG(function(e,t,n){return q$.apply(this,arguments)},!0),_j=sG(function(e,t,n){return function(e,t){return H$.apply(this,arguments)}(YB(e),O$.credential(t,n))},!0),wj=sG(function(e,t,n){return PW.apply(this,arguments)},!0),Cj=sG(function(e,t){return Y$.apply(this,arguments)},!0),bj="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},Ej={},Sj=Sj||{},Pj=bj||self;function Oj(){}function Tj(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function Ij(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}var xj="closure_uid_"+(1e9*Math.random()>>>0),Aj=0;function Rj(e,t,n){return e.call.apply(e.bind,arguments)}function Nj(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function Mj(e,t,n){return(Mj=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Rj:Nj).apply(null,arguments)}function Dj(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function Lj(e,t){function n(){}n.prototype=t.prototype,e.Z=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Vb=function(e,n,r){for(var i=Array(arguments.length-2),a=2;a<arguments.length;a++)i[a-2]=arguments[a];return t.prototype[n].apply(e,i)}}function Fj(){this.s=this.s,this.o=this.o}var Bj={};Fj.prototype.s=!1,Fj.prototype.na=function(){if(!this.s&&(this.s=!0,this.M(),0)){var e=function(e){return Object.prototype.hasOwnProperty.call(e,xj)&&e[xj]||(e[xj]=++Aj)}(this);delete Bj[e]}},Fj.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var Vj=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if("string"==typeof e)return"string"!=typeof t||1!=t.length?-1:e.indexOf(t,0);for(var n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1},Uj=Array.prototype.forEach?function(e,t,n){Array.prototype.forEach.call(e,t,n)}:function(e,t,n){for(var r=e.length,i="string"==typeof e?e.split(""):e,a=0;a<r;a++)a in i&&t.call(n,i[a],a,e)};function zj(e){return Array.prototype.concat.apply([],arguments)}function Hj(e){var t=e.length;if(0<t){for(var n=Array(t),r=0;r<t;r++)n[r]=e[r];return n}return[]}function Gj(e){return/^[\s\xa0]*$/.test(e)}var qj,$j=String.prototype.trim?function(e){return e.trim()}:function(e){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(e)[1]};function Wj(e,t){return-1!=e.indexOf(t)}function jj(e,t){return e<t?-1:e>t?1:0}e:{var Zj=Pj.navigator;if(Zj){var Yj=Zj.userAgent;if(Yj){qj=Yj;break e}}qj=""}function Kj(e,t,n){for(var r in e)t.call(n,e[r],r,e)}function Jj(e){var t={};for(var n in e)t[n]=e[n];return t}var Qj="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Xj(e,t){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])e[n]=r[n];for(var a=0;a<Qj.length;a++)n=Qj[a],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function eZ(e){return eZ[" "](e),e}eZ[" "]=Oj;var tZ,nZ=Wj(qj,"Opera"),rZ=Wj(qj,"Trident")||Wj(qj,"MSIE"),iZ=Wj(qj,"Edge"),aZ=iZ||rZ,oZ=Wj(qj,"Gecko")&&!(Wj(qj.toLowerCase(),"webkit")&&!Wj(qj,"Edge"))&&!(Wj(qj,"Trident")||Wj(qj,"MSIE"))&&!Wj(qj,"Edge"),sZ=Wj(qj.toLowerCase(),"webkit")&&!Wj(qj,"Edge");function uZ(){var e=Pj.document;return e?e.documentMode:void 0}e:{var cZ="",lZ=function(){var e=qj;return oZ?/rv:([^\);]+)(\)|;)/.exec(e):iZ?/Edge\/([\d\.]+)/.exec(e):rZ?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(e):sZ?/WebKit\/(\S+)/.exec(e):nZ?/(?:Version)[ \/]?(\S+)/.exec(e):void 0}();if(lZ&&(cZ=lZ?lZ[1]:""),rZ){var hZ=uZ();if(null!=hZ&&hZ>parseFloat(cZ)){tZ=String(hZ);break e}}tZ=cZ}var fZ={};var dZ=Pj.document&&rZ&&(uZ()||parseInt(tZ,10))||void 0,vZ=function(){if(!Pj.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{Pj.addEventListener("test",Oj,t),Pj.removeEventListener("test",Oj,t)}catch(n){}return e}();function pZ(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}function gZ(e,t){if(pZ.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(oZ){e:{try{eZ(t.nodeName);var i=!0;break e}catch(a){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"==typeof e.pointerType?e.pointerType:yZ[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&gZ.Z.h.call(this)}}pZ.prototype.h=function(){this.defaultPrevented=!0},Lj(gZ,pZ);var yZ={2:"touch",3:"pen",4:"mouse"};gZ.prototype.h=function(){gZ.Z.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var mZ="closure_listenable_"+(1e6*Math.random()|0),kZ=0;function _Z(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ia=i,this.key=++kZ,this.ca=this.fa=!1}function wZ(e){e.ca=!0,e.listener=null,e.proxy=null,e.src=null,e.ia=null}function CZ(e){this.src=e,this.g={},this.h=0}function bZ(e,t){var n=t.type;if(n in e.g){var r,i=e.g[n],a=Vj(i,t);(r=0<=a)&&Array.prototype.splice.call(i,a,1),r&&(wZ(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function EZ(e,t,n,r){for(var i=0;i<e.length;++i){var a=e[i];if(!a.ca&&a.listener==t&&a.capture==!!n&&a.ia==r)return i}return-1}CZ.prototype.add=function(e,t,n,r,i){var a=e.toString();(e=this.g[a])||(e=this.g[a]=[],this.h++);var o=EZ(e,t,r,i);return-1<o?(t=e[o],n||(t.fa=!1)):((t=new _Z(t,this.src,a,!!r,i)).fa=n,e.push(t)),t};var SZ="closure_lm_"+(1e6*Math.random()|0),PZ={};function OZ(e,t,n,r,i){if(r&&r.once)return IZ(e,t,n,r,i);if(Array.isArray(t)){for(var a=0;a<t.length;a++)OZ(e,t[a],n,r,i);return null}return n=LZ(n),e&&e[mZ]?e.N(t,n,Ij(r)?!!r.capture:!!r,i):TZ(e,t,n,!1,r,i)}function TZ(e,t,n,r,i,a){if(!t)throw Error("Invalid event type");var o=Ij(i)?!!i.capture:!!i,s=MZ(e);if(s||(e[SZ]=s=new CZ(e)),(n=s.add(t,n,r,o,a)).proxy)return n;if(r=function(){var e=NZ;return function t(n){return e.call(t.src,t.listener,n)}}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)vZ||(i=o),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(RZ(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function IZ(e,t,n,r,i){if(Array.isArray(t)){for(var a=0;a<t.length;a++)IZ(e,t[a],n,r,i);return null}return n=LZ(n),e&&e[mZ]?e.O(t,n,Ij(r)?!!r.capture:!!r,i):TZ(e,t,n,!0,r,i)}function xZ(e,t,n,r,i){if(Array.isArray(t))for(var a=0;a<t.length;a++)xZ(e,t[a],n,r,i);else r=Ij(r)?!!r.capture:!!r,n=LZ(n),e&&e[mZ]?(e=e.i,(t=String(t).toString())in e.g&&-1<(n=EZ(a=e.g[t],n,r,i))&&(wZ(a[n]),Array.prototype.splice.call(a,n,1),0==a.length&&(delete e.g[t],e.h--))):e&&(e=MZ(e))&&(t=e.g[t.toString()],e=-1,t&&(e=EZ(t,n,r,i)),(n=-1<e?t[e]:null)&&AZ(n))}function AZ(e){if("number"!=typeof e&&e&&!e.ca){var t=e.src;if(t&&t[mZ])bZ(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(RZ(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=MZ(t))?(bZ(n,e),0==n.h&&(n.src=null,t[SZ]=null)):wZ(e)}}}function RZ(e){return e in PZ?PZ[e]:PZ[e]="on"+e}function NZ(e,t){if(e.ca)e=!0;else{t=new gZ(t,this);var n=e.listener,r=e.ia||e.src;e.fa&&AZ(e),e=n.call(r,t)}return e}function MZ(e){return(e=e[SZ])instanceof CZ?e:null}var DZ="__closure_events_fn_"+(1e9*Math.random()>>>0);function LZ(e){return"function"==typeof e?e:(e[DZ]||(e[DZ]=function(t){return e.handleEvent(t)}),e[DZ])}function FZ(){Fj.call(this),this.i=new CZ(this),this.P=this,this.I=null}function BZ(e,t){var n,r=e.I;if(r)for(n=[];r;r=r.I)n.push(r);if(e=e.P,r=t.type||t,"string"==typeof t)t=new pZ(t,e);else if(t instanceof pZ)t.target=t.target||e;else{var i=t;Xj(t=new pZ(r,e),i)}if(i=!0,n)for(var a=n.length-1;0<=a;a--){var o=t.g=n[a];i=VZ(o,r,!0,t)&&i}if(i=VZ(o=t.g=e,r,!0,t)&&i,i=VZ(o,r,!1,t)&&i,n)for(a=0;a<n.length;a++)i=VZ(o=t.g=n[a],r,!1,t)&&i}function VZ(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var i=!0,a=0;a<t.length;++a){var o=t[a];if(o&&!o.ca&&o.capture==n){var s=o.listener,u=o.ia||o.src;o.fa&&bZ(e.i,o),i=!1!==s.call(u,r)&&i}}return i&&!r.defaultPrevented}Lj(FZ,Fj),FZ.prototype[mZ]=!0,FZ.prototype.removeEventListener=function(e,t,n,r){xZ(this,e,t,n,r)},FZ.prototype.M=function(){if(FZ.Z.M.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)wZ(n[r]);delete t.g[e],t.h--}}this.I=null},FZ.prototype.N=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},FZ.prototype.O=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};var UZ=Pj.JSON.stringify;function zZ(){var e=ZZ,t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var HZ,GZ=new(function(){function e(t,n){tp(this,e),this.i=t,this.j=n,this.h=0,this.g=null}return rp(e,[{key:"get",value:function(){var e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}]),e}())(function(){return new qZ},function(e){return e.reset()}),qZ=function(){function e(){tp(this,e),this.next=this.g=this.h=null}return rp(e,[{key:"set",value:function(e,t){this.h=e,this.g=t,this.next=null}},{key:"reset",value:function(){this.next=this.g=this.h=null}}]),e}();function $Z(e){Pj.setTimeout(function(){throw e},0)}function WZ(e,t){HZ||function(){var e=Pj.Promise.resolve(void 0);HZ=function(){e.then(YZ)}}(),jZ||(HZ(),jZ=!0),ZZ.add(e,t)}var jZ=!1,ZZ=new(function(){function e(){tp(this,e),this.h=this.g=null}return rp(e,[{key:"add",value:function(e,t){var n=GZ.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}}]),e}());function YZ(){for(var e;e=zZ();){try{e.h.call(e.g)}catch(n){$Z(n)}var t=GZ;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}jZ=!1}function KZ(e,t){FZ.call(this),this.h=e||1,this.g=t||Pj,this.j=Mj(this.kb,this),this.l=Date.now()}function JZ(e){e.da=!1,e.S&&(e.g.clearTimeout(e.S),e.S=null)}function QZ(e,t,n){if("function"==typeof e)n&&(e=Mj(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=Mj(e.handleEvent,e)}return 2147483647<Number(t)?-1:Pj.setTimeout(e,t||0)}function XZ(e){e.g=QZ(function(){e.g=null,e.i&&(e.i=!1,XZ(e))},e.j);var t=e.h;e.h=null,e.m.apply(null,t)}Lj(KZ,FZ),(lj=KZ.prototype).da=!1,lj.S=null,lj.kb=function(){if(this.da){var e=Date.now()-this.l;0<e&&e<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-e):(this.S&&(this.g.clearTimeout(this.S),this.S=null),BZ(this,"tick"),this.da&&(JZ(this),this.start()))}},lj.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())},lj.M=function(){KZ.Z.M.call(this),JZ(this),delete this.g};var eY=function(e){Gv(n,e);var t=$v(n);function n(e,r){var i;return tp(this,n),(i=t.call(this)).m=e,i.j=r,i.h=null,i.i=!1,i.g=null,i}return rp(n,[{key:"l",value:function(e){this.h=arguments,this.g?this.i=!0:XZ(this)}},{key:"M",value:function(){zv(Yv(n.prototype),"M",this).call(this),this.g&&(Pj.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}]),n}(Fj);function tY(e){Fj.call(this),this.h=e,this.g={}}Lj(tY,Fj);var nY=[];function rY(e,t,n,r){Array.isArray(n)||(n&&(nY[0]=n.toString()),n=nY);for(var i=0;i<n.length;i++){var a=OZ(t,n[i],r||e.handleEvent,!1,e.h||e);if(!a)break;e.g[a.key]=a}}function iY(e){Kj(e.g,function(e,t){this.g.hasOwnProperty(t)&&AZ(e)},e),e.g={}}function aY(){this.g=!0}function oY(e,t,n,r){e.info(function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var a=i[0];if("noop"!=a&&"stop"!=a&&"close"!=a)for(var o=1;o<i.length;o++)i[o]=""}}}return UZ(n)}catch(s){return t}}(e,n)+(r?" "+r:"")})}tY.prototype.M=function(){tY.Z.M.call(this),iY(this)},tY.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},aY.prototype.Aa=function(){this.g=!1},aY.prototype.info=function(){};var sY={},uY=null;function cY(){return uY=uY||new FZ}function lY(e){pZ.call(this,sY.Ma,e)}function hY(e){var t=cY();BZ(t,new lY(t,e))}function fY(e,t){pZ.call(this,sY.STAT_EVENT,e),this.stat=t}function dY(e){var t=cY();BZ(t,new fY(t,e))}function vY(e,t){pZ.call(this,sY.Na,e),this.size=t}function pY(e,t){if("function"!=typeof e)throw Error("Fn must not be null and must be a function");return Pj.setTimeout(function(){e()},t)}sY.Ma="serverreachability",Lj(lY,pZ),sY.STAT_EVENT="statevent",Lj(fY,pZ),sY.Na="timingevent",Lj(vY,pZ);var gY={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},yY={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function mY(){}function kY(){}mY.prototype.h=null;var _Y,wY={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function CY(){pZ.call(this,"d")}function bY(){pZ.call(this,"c")}function EY(){}function SY(e,t,n,r){this.l=e,this.j=t,this.m=n,this.X=r||1,this.V=new tY(this),this.P=OY,this.W=new KZ(e=aZ?125:void 0),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new PY}function PY(){this.i=null,this.g="",this.h=!1}Lj(CY,pZ),Lj(bY,pZ),Lj(EY,mY),EY.prototype.g=function(){return new XMLHttpRequest},EY.prototype.i=function(){return{}},_Y=new EY;var OY=45e3,TY={},IY={};function xY(e,t,n){e.K=1,e.v=XY(jY(t)),e.s=n,e.U=!0,AY(e,null)}function AY(e,t){e.F=Date.now(),DY(e),e.A=jY(e.v);var n=e.A,r=e.X;Array.isArray(r)||(r=[String(r)]),fK(n.h,"t",r),e.C=0,n=e.l.H,e.h=new PY,e.g=fJ(e.l,n?t:null,!e.s),0<e.O&&(e.L=new eY(Mj(e.Ia,e,e.g),e.O)),rY(e.V,e.g,"readystatechange",e.gb),t=e.H?Jj(e.H):{},e.s?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.A,e.u,e.s,t)):(e.u="GET",e.g.ea(e.A,e.u,null,t)),hY(1),function(e,t,n,r,i,a){e.info(function(){if(e.g)if(a)for(var o="",s=a.split("&"),u=0;u<s.length;u++){var c=s[u].split("=");if(1<c.length){var l=c[0];c=c[1];var h=l.split("_");o=2<=h.length&&"type"==h[1]?o+(l+"=")+c+"&":o+(l+"=redacted&")}}else o=null;else o=a;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+"\n"+n+"\n"+o})}(e.j,e.u,e.A,e.m,e.X,e.s)}function RY(e){return!!e.g&&"GET"==e.u&&2!=e.K&&e.l.Ba}function NY(e,t,n){for(var r,i=!0;!e.I&&e.C<n.length;){if((r=MY(e,n))==IY){4==t&&(e.o=4,dY(14),i=!1),oY(e.j,e.m,null,"[Incomplete Response]");break}if(r==TY){e.o=4,dY(15),oY(e.j,e.m,n,"[Invalid Chunk]"),i=!1;break}oY(e.j,e.m,r,null),UY(e,r)}RY(e)&&r!=IY&&r!=TY&&(e.h.g="",e.C=0),4!=t||0!=n.length||e.h.h||(e.o=1,dY(16),i=!1),e.i=e.i&&i,i?0<n.length&&!e.aa&&(e.aa=!0,(t=e.l).g==e&&t.$&&!t.L&&(t.h.info("Great, no buffering proxy detected. Bytes received: "+n.length),iJ(t),t.L=!0,dY(11))):(oY(e.j,e.m,n,"[Invalid Chunked Response]"),VY(e),BY(e))}function MY(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?IY:(n=Number(t.substring(n,r)),isNaN(n)?TY:(r+=1)+n>t.length?IY:(t=t.substr(r,n),e.C=r+n,t))}function DY(e){e.Y=Date.now()+e.P,LY(e,e.P)}function LY(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=pY(Mj(e.eb,e),t)}function FY(e){e.B&&(Pj.clearTimeout(e.B),e.B=null)}function BY(e){0==e.l.G||e.I||sJ(e.l,e)}function VY(e){FY(e);var t=e.L;t&&"function"==typeof t.na&&t.na(),e.L=null,JZ(e.W),iY(e.V),e.g&&(t=e.g,e.g=null,t.abort(),t.na())}function UY(e,t){try{var n=e.l;if(0!=n.G&&(n.g==e||mK(n.i,e)))if(n.I=e.N,!e.J&&mK(n.i,e)&&3==n.G){try{var r=n.Ca.g.parse(t)}catch(g){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0])e:if(n.u)n.ta=i[1],0<n.ta-n.U&&37500>i[2]&&n.N&&0==n.A&&!n.v&&(n.v=pY(Mj(n.ab,n),6e3));else{if(n.g){if(!(n.g.F+3e3<e.F))break e;oJ(n),YK(n)}rJ(n),dY(18)}if(1>=yK(n.i)&&n.ka){try{n.ka()}catch(y){}n.ka=void 0}}else cJ(n,11)}else if((e.J||n.g==e)&&oJ(n),!Gj(t))for(i=n.Ca.g.parse(t),t=0;t<i.length;t++){var a=i[t];if(n.U=a[0],a=a[1],2==n.G)if("c"==a[0]){n.J=a[1],n.la=a[2];var o=a[3];null!=o&&(n.ma=o,n.h.info("VER="+n.ma));var s=a[4];null!=s&&(n.za=s,n.h.info("SVER="+n.za));var u=a[5];null!=u&&"number"==typeof u&&0<u&&(n.K=r=1.5*u,n.h.info("backChannelRequestTimeoutMs_="+r)),r=n;var c=e.g;if(c){var l=c.g?c.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(l){var h=r.i;!h.g&&(Wj(l,"spdy")||Wj(l,"quic")||Wj(l,"h2"))&&(h.j=h.l,h.g=new Set,h.h&&(kK(h,h.h),h.h=null))}if(r.D){var f=c.g?c.g.getResponseHeader("X-HTTP-Session-Id"):null;f&&(r.sa=f,QY(r.F,r.D,f))}}n.G=3,n.j&&n.j.xa(),n.$&&(n.O=Date.now()-e.F,n.h.info("Handshake RTT: "+n.O+"ms"));var d=e;if((r=n).oa=hJ(r,r.H?r.la:null,r.W),d.J){_K(r.i,d);var v=d,p=r.K;p&&v.setTimeout(p),v.B&&(FY(v),DY(v)),r.g=d}else nJ(r);0<n.l.length&&QK(n)}else"stop"!=a[0]&&"close"!=a[0]||cJ(n,7);else 3==n.G&&("stop"==a[0]||"close"==a[0]?"stop"==a[0]?cJ(n,7):ZK(n):"noop"!=a[0]&&n.j&&n.j.wa(a),n.A=0)}hY(4)}catch(m){}}function zY(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(Tj(e)||"string"==typeof e)Uj(e,t,void 0);else{if(e.T&&"function"==typeof e.T)var n=e.T();else if(e.R&&"function"==typeof e.R)n=void 0;else if(Tj(e)||"string"==typeof e){n=[];for(var r=e.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,e)n[r++]=i;i=(r=function(e){if(e.R&&"function"==typeof e.R)return e.R();if("string"==typeof e)return e.split("");if(Tj(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e)).length;for(var a=0;a<i;a++)t.call(void 0,r[a],n&&n[a],e)}}function HY(e,t){this.h={},this.g=[],this.i=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(e)if(e instanceof HY)for(n=e.T(),r=0;r<n.length;r++)this.set(n[r],e.get(n[r]));else for(r in e)this.set(r,e[r])}function GY(e){if(e.i!=e.g.length){for(var t=0,n=0;t<e.g.length;){var r=e.g[t];qY(e.h,r)&&(e.g[n++]=r),t++}e.g.length=n}if(e.i!=e.g.length){var i={};for(n=t=0;t<e.g.length;)qY(i,r=e.g[t])||(e.g[n++]=r,i[r]=1),t++;e.g.length=n}}function qY(e,t){return Object.prototype.hasOwnProperty.call(e,t)}(lj=SY.prototype).setTimeout=function(e){this.P=e},lj.gb=function(e){e=e.target;var t=this.L;t&&3==GK(e)?t.l():this.Ia(e)},lj.Ia=function(e){try{if(e==this.g)e:{var t=GK(this.g),n=this.g.Da(),r=this.g.ba();if(!(3>t)&&(3!=t||aZ||this.g&&(this.h.h||this.g.ga()||qK(this.g)))){this.I||4!=t||7==n||hY(8==n||0>=r?3:2),FY(this);var i=this.g.ba();this.N=i;t:if(RY(this)){var a=qK(this.g);e="";var o=a.length,s=4==GK(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){VY(this),BY(this);var u="";break t}this.h.i=new Pj.TextDecoder}for(n=0;n<o;n++)this.h.h=!0,e+=this.h.i.decode(a[n],{stream:s&&n==o-1});a.splice(0,o),this.h.g+=e,this.C=0,u=this.h.g}else u=this.g.ga();if(this.i=200==i,function(e,t,n,r,i,a,o){e.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+"\n"+n+"\n"+a+" "+o})}(this.j,this.u,this.A,this.m,this.X,t,i),this.i){if(this.$&&!this.J){t:{if(this.g){var c,l=this.g;if((c=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Gj(c)){var h=c;break t}}h=null}if(!(i=h)){this.i=!1,this.o=3,dY(12),VY(this),BY(this);break e}oY(this.j,this.m,i,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,UY(this,i)}this.U?(NY(this,t,u),aZ&&this.i&&3==t&&(rY(this.V,this.W,"tick",this.fb),this.W.start())):(oY(this.j,this.m,u,null),UY(this,u)),4==t&&VY(this),this.i&&!this.I&&(4==t?sJ(this.l,this):(this.i=!1,DY(this)))}else 400==i&&0<u.indexOf("Unknown SID")?(this.o=3,dY(12)):(this.o=0,dY(13)),VY(this),BY(this)}}}catch(f){}},lj.fb=function(){if(this.g){var e=GK(this.g),t=this.g.ga();this.C<t.length&&(FY(this),NY(this,e,t),this.i&&4!=e&&DY(this))}},lj.cancel=function(){this.I=!0,VY(this)},lj.eb=function(){this.B=null;var e=Date.now();0<=e-this.Y?(function(e,t){e.info(function(){return"TIMEOUT: "+t})}(this.j,this.A),2!=this.K&&(hY(3),dY(17)),VY(this),this.o=2,BY(this)):LY(this,this.Y-e)},(lj=HY.prototype).R=function(){GY(this);for(var e=[],t=0;t<this.g.length;t++)e.push(this.h[this.g[t]]);return e},lj.T=function(){return GY(this),this.g.concat()},lj.get=function(e,t){return qY(this.h,e)?this.h[e]:t},lj.set=function(e,t){qY(this.h,e)||(this.i++,this.g.push(e)),this.h[e]=t},lj.forEach=function(e,t){for(var n=this.T(),r=0;r<n.length;r++){var i=n[r],a=this.get(i);e.call(t,a,i,this)}};var $Y=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function WY(e,t){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,e instanceof WY){this.g=void 0!==t?t:e.g,ZY(this,e.j),this.s=e.s,YY(this,e.i),KY(this,e.m),this.l=e.l,t=e.h;var n=new uK;n.i=t.i,t.g&&(n.g=new HY(t.g),n.h=t.h),JY(this,n),this.o=e.o}else e&&(n=String(e).match($Y))?(this.g=!!t,ZY(this,n[1]||"",!0),this.s=eK(n[2]||""),YY(this,n[3]||"",!0),KY(this,n[4]),this.l=eK(n[5]||"",!0),JY(this,n[6]||"",!0),this.o=eK(n[7]||"")):(this.g=!!t,this.h=new uK(null,this.g))}function jY(e){return new WY(e)}function ZY(e,t,n){e.j=n?eK(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function YY(e,t,n){e.i=n?eK(t,!0):t}function KY(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.m=t}else e.m=null}function JY(e,t,n){t instanceof uK?(e.h=t,function(e,t){t&&!e.j&&(cK(e),e.i=null,e.g.forEach(function(e,t){var n=t.toLowerCase();t!=n&&(lK(this,t),fK(this,n,e))},e)),e.j=t}(e.h,e.g)):(n||(t=tK(t,oK)),e.h=new uK(t,e.g))}function QY(e,t,n){e.h.set(t,n)}function XY(e){return QY(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function eK(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function tK(e,t,n){return"string"==typeof e?(e=encodeURI(e).replace(t,nK),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function nK(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}WY.prototype.toString=function(){var e=[],t=this.j;t&&e.push(tK(t,rK,!0),":");var n=this.i;return(n||"file"==t)&&(e.push("//"),(t=this.s)&&e.push(tK(t,rK,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&e.push(":",String(n))),(n=this.l)&&(this.i&&"/"!=n.charAt(0)&&e.push("/"),e.push(tK(n,"/"==n.charAt(0)?aK:iK,!0))),(n=this.h.toString())&&e.push("?",n),(n=this.o)&&e.push("#",tK(n,sK)),e.join("")};var rK=/[#\/\?@]/g,iK=/[#\?:]/g,aK=/[#\?]/g,oK=/[#\?@]/g,sK=/#/g;function uK(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function cK(e){e.g||(e.g=new HY,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var a=e[n].substring(0,r);i=e[n].substring(r+1)}else a=e[n];t(a,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.i,function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)}))}function lK(e,t){cK(e),t=dK(e,t),qY(e.g.h,t)&&(e.i=null,e.h-=e.g.get(t).length,qY((e=e.g).h,t)&&(delete e.h[t],e.i--,e.g.length>2*e.i&&GY(e)))}function hK(e,t){return cK(e),t=dK(e,t),qY(e.g.h,t)}function fK(e,t,n){lK(e,t),0<n.length&&(e.i=null,e.g.set(dK(e,t),Hj(n)),e.h+=n.length)}function dK(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function vK(e){this.l=e||pK,e=Pj.PerformanceNavigationTiming?0<(e=Pj.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):!!(Pj.g&&Pj.g.Ea&&Pj.g.Ea()&&Pj.g.Ea().Zb),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(lj=uK.prototype).add=function(e,t){cK(this),this.i=null,e=dK(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},lj.forEach=function(e,t){cK(this),this.g.forEach(function(n,r){Uj(n,function(n){e.call(t,n,r,this)},this)},this)},lj.T=function(){cK(this);for(var e=this.g.R(),t=this.g.T(),n=[],r=0;r<t.length;r++)for(var i=e[r],a=0;a<i.length;a++)n.push(t[r]);return n},lj.R=function(e){cK(this);var t=[];if("string"==typeof e)hK(this,e)&&(t=zj(t,this.g.get(dK(this,e))));else{e=this.g.R();for(var n=0;n<e.length;n++)t=zj(t,e[n])}return t},lj.set=function(e,t){return cK(this),this.i=null,hK(this,e=dK(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},lj.get=function(e,t){return e&&0<(e=this.R(e)).length?String(e[0]):t},lj.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var e=[],t=this.g.T(),n=0;n<t.length;n++){var r=t[n],i=encodeURIComponent(String(r));r=this.R(r);for(var a=0;a<r.length;a++){var o=i;""!==r[a]&&(o+="="+encodeURIComponent(String(r[a]))),e.push(o)}}return this.i=e.join("&")};var pK=10;function gK(e){return!!e.h||!!e.g&&e.g.size>=e.j}function yK(e){return e.h?1:e.g?e.g.size:0}function mK(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function kK(e,t){e.g?e.g.add(t):e.h=t}function _K(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function wK(e){if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){var t,n=e.i,r=Qv(e.g.values());try{for(r.s();!(t=r.n()).done;){var i=t.value;n=n.concat(i.D)}}catch(a){r.e(a)}finally{r.f()}return n}return Hj(e.i)}function CK(){}function bK(){this.g=new CK}function EK(e,t,n){var r=n||"";try{zY(e,function(e,n){var i=e;Ij(e)&&(i=UZ(e)),t.push(r+n+"="+encodeURIComponent(i))})}catch(i){throw t.push(r+"type="+encodeURIComponent("_badmap")),i}}function SK(e,t,n,r,i){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,i(r)}catch(a){}}function PK(e){this.l=e.$b||null,this.j=e.ib||!1}function OK(e,t){FZ.call(this),this.D=e,this.u=t,this.m=void 0,this.readyState=TK,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}vK.prototype.cancel=function(){if(this.i=wK(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){var e,t=Qv(this.g.values());try{for(t.s();!(e=t.n()).done;){e.value.cancel()}}catch(n){t.e(n)}finally{t.f()}this.g.clear()}},CK.prototype.stringify=function(e){return Pj.JSON.stringify(e,void 0)},CK.prototype.parse=function(e){return Pj.JSON.parse(e,void 0)},Lj(PK,mY),PK.prototype.g=function(){return new OK(this.l,this.j)},PK.prototype.i=function(e){return function(){return e}}({}),Lj(OK,FZ);var TK=0;function IK(e){e.j.read().then(e.Sa.bind(e)).catch(e.ha.bind(e))}function xK(e){e.readyState=4,e.l=null,e.j=null,e.A=null,AK(e)}function AK(e){e.onreadystatechange&&e.onreadystatechange.call(e)}(lj=OK.prototype).open=function(e,t){if(this.readyState!=TK)throw this.abort(),Error("Error reopening a connection");this.C=e,this.B=t,this.readyState=1,AK(this)},lj.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;var t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||Pj).fetch(new Request(this.B,t)).then(this.Va.bind(this),this.ha.bind(this))},lj.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,xK(this)),this.readyState=TK},lj.Va=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,AK(this)),this.g&&(this.readyState=3,AK(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(void 0!==Pj.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;IK(this)}else e.text().then(this.Ua.bind(this),this.ha.bind(this))},lj.Sa=function(e){if(this.g){if(this.u&&e.value)this.response.push(e.value);else if(!this.u){var t=e.value?e.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?xK(this):AK(this),3==this.readyState&&IK(this)}},lj.Ua=function(e){this.g&&(this.response=this.responseText=e,xK(this))},lj.Ta=function(e){this.g&&(this.response=e,xK(this))},lj.ha=function(){this.g&&xK(this)},lj.setRequestHeader=function(e,t){this.v.append(e,t)},lj.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},lj.getAllResponseHeaders=function(){if(!this.h)return"";for(var e=[],t=this.h.entries(),n=t.next();!n.done;)e.push((n=n.value)[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(OK.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}});var RK=Pj.JSON.parse;function NK(e){FZ.call(this),this.headers=new HY,this.u=e||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=MK,this.K=this.L=!1}Lj(NK,FZ);var MK="",DK=/^https?$/i,LK=["POST","PUT"];function FK(e){return"content-type"==e.toLowerCase()}function BK(e,t){e.h=!1,e.g&&(e.l=!0,e.g.abort(),e.l=!1),e.j=t,e.m=5,VK(e),zK(e)}function VK(e){e.D||(e.D=!0,BZ(e,"complete"),BZ(e,"error"))}function UK(e){if(e.h&&void 0!==Sj&&(!e.C[1]||4!=GK(e)||2!=e.ba()))if(e.v&&4==GK(e))QZ(e.Fa,0,e);else if(BZ(e,"readystatechange"),4==GK(e)){e.h=!1;try{var t,n=e.ba();e:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break e;default:r=!1}if(!(t=r)){var i;if(i=0===n){var a=String(e.H).match($Y)[1]||null;if(!a&&Pj.self&&Pj.self.location){var o=Pj.self.location.protocol;a=o.substr(0,o.length-1)}i=!DK.test(a?a.toLowerCase():"")}t=i}if(t)BZ(e,"complete"),BZ(e,"success");else{e.m=6;try{var s=2<GK(e)?e.g.statusText:""}catch(u){s=""}e.j=s+" ["+e.ba()+"]",VK(e)}}finally{zK(e)}}}function zK(e,t){if(e.g){HK(e);var n=e.g,r=e.C[0]?Oj:null;e.g=null,e.C=null,t||BZ(e,"ready");try{n.onreadystatechange=r}catch(i){}}}function HK(e){e.g&&e.K&&(e.g.ontimeout=null),e.A&&(Pj.clearTimeout(e.A),e.A=null)}function GK(e){return e.g?e.g.readyState:0}function qK(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.J){case MK:case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(t){return null}}function $K(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=function(e){var t="";return Kj(e,function(e,n){t+=n,t+=":",t+=e,t+="\r\n"}),t}(n),"string"==typeof e?null!=n&&encodeURIComponent(String(n)):QY(e,t,n))}function WK(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function jK(e){this.za=0,this.l=[],this.h=new aY,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=WK("failFast",!1,e),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=WK("baseRetryDelayMs",5e3,e),this.$a=WK("retryDelaySeedMs",1e4,e),this.Ya=WK("forwardChannelMaxRetries",2,e),this.ra=WK("forwardChannelRequestTimeoutMs",2e4,e),this.qa=e&&e.xmlHttpFactory||void 0,this.Ba=e&&e.Yb||!1,this.K=void 0,this.H=e&&e.supportsCrossDomainXhr||!1,this.J="",this.i=new vK(e&&e.concurrentRequestLimit),this.Ca=new bK,this.ja=e&&e.fastHandshake||!1,this.Ra=e&&e.Wb||!1,e&&e.Aa&&this.h.Aa(),e&&e.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&e&&e.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!e||!1!==e.Xb}function ZK(e){if(KK(e),3==e.G){var t=e.V++,n=jY(e.F);QY(n,"SID",e.J),QY(n,"RID",t),QY(n,"TYPE","terminate"),eJ(e,n),(t=new SY(e,e.h,t,void 0)).K=2,t.v=XY(jY(n)),n=!1,Pj.navigator&&Pj.navigator.sendBeacon&&(n=Pj.navigator.sendBeacon(t.v.toString(),"")),!n&&Pj.Image&&((new Image).src=t.v,n=!0),n||(t.g=fJ(t.l,null),t.g.ea(t.v)),t.F=Date.now(),DY(t)}lJ(e)}function YK(e){e.g&&(iJ(e),e.g.cancel(),e.g=null)}function KK(e){YK(e),e.u&&(Pj.clearTimeout(e.u),e.u=null),oJ(e),e.i.cancel(),e.m&&("number"==typeof e.m&&Pj.clearTimeout(e.m),e.m=null)}function JK(e,t){e.l.push(new(function(){return rp(function e(t,n){tp(this,e),this.h=t,this.g=n})}())(e.Za++,t)),3==e.G&&QK(e)}function QK(e){gK(e.i)||e.m||(e.m=!0,WZ(e.Ha,e),e.C=0)}function XK(e,t){var n;n=t?t.m:e.V++;var r=jY(e.F);QY(r,"SID",e.J),QY(r,"RID",n),QY(r,"AID",e.U),eJ(e,r),e.o&&e.s&&$K(r,e.o,e.s),n=new SY(e,e.h,n,e.C+1),null===e.o&&(n.H=e.s),t&&(e.l=t.D.concat(e.l)),t=tJ(e,n,1e3),n.setTimeout(Math.round(.5*e.ra)+Math.round(.5*e.ra*Math.random())),kK(e.i,n),xY(n,r,t)}function eJ(e,t){e.j&&zY({},function(e,n){QY(t,n,e)})}function tJ(e,t,n){n=Math.min(e.l.length,n);var r=e.j?Mj(e.j.Oa,e.j,e):null;e:for(var i=e.l,a=-1;;){var o=["count="+n];-1==a?0<n?(a=i[0].h,o.push("ofs="+a)):a=0:o.push("ofs="+a);for(var s=!0,u=0;u<n;u++){var c=i[u].h,l=i[u].g;if(0>(c-=a))a=Math.max(0,i[u].h-100),s=!1;else try{EK(l,o,"req"+c+"_")}catch(h){r&&r(l)}}if(s){r=o.join("&");break e}}return e=e.l.splice(0,n),t.D=e,r}function nJ(e){e.g||e.u||(e.Y=1,WZ(e.Ga,e),e.A=0)}function rJ(e){return!(e.g||e.u||3<=e.A||(e.Y++,e.u=pY(Mj(e.Ga,e),uJ(e,e.A)),e.A++,0))}function iJ(e){null!=e.B&&(Pj.clearTimeout(e.B),e.B=null)}function aJ(e){e.g=new SY(e,e.h,"rpc",e.Y),null===e.o&&(e.g.H=e.s),e.g.O=0;var t=jY(e.oa);QY(t,"RID","rpc"),QY(t,"SID",e.J),QY(t,"CI",e.N?"0":"1"),QY(t,"AID",e.U),eJ(e,t),QY(t,"TYPE","xmlhttp"),e.o&&e.s&&$K(t,e.o,e.s),e.K&&e.g.setTimeout(e.K);var n=e.g;e=e.la,n.K=1,n.v=XY(jY(t)),n.s=null,n.U=!0,AY(n,e)}function oJ(e){null!=e.v&&(Pj.clearTimeout(e.v),e.v=null)}function sJ(e,t){var n=null;if(e.g==t){oJ(e),iJ(e),e.g=null;var r=2}else{if(!mK(e.i,t))return;n=t.D,_K(e.i,t),r=1}if(e.I=t.N,0!=e.G)if(t.i)if(1==r){n=t.s?t.s.length:0,t=Date.now()-t.F;var i=e.C;BZ(r=cY(),new vY(r,n,t,i)),QK(e)}else nJ(e);else if(3==(i=t.o)||0==i&&0<e.I||!(1==r&&function(e,t){return!(yK(e.i)>=e.i.j-(e.m?1:0)||(e.m?(e.l=t.D.concat(e.l),0):1==e.G||2==e.G||e.C>=(e.Xa?0:e.Ya)||(e.m=pY(Mj(e.Ha,e,t),uJ(e,e.C)),e.C++,0)))}(e,t)||2==r&&rJ(e)))switch(n&&0<n.length&&(t=e.i,t.i=t.i.concat(n)),i){case 1:cJ(e,5);break;case 4:cJ(e,10);break;case 3:cJ(e,6);break;default:cJ(e,2)}}function uJ(e,t){var n=e.Pa+Math.floor(Math.random()*e.$a);return e.j||(n*=2),n*t}function cJ(e,t){if(e.h.info("Error code "+t),2==t){var n=null;e.j&&(n=null);var r=Mj(e.jb,e);n||(n=new WY("//www.google.com/images/cleardot.gif"),Pj.location&&"http"==Pj.location.protocol||ZY(n,"https"),XY(n)),function(e,t){var n=new aY;if(Pj.Image){var r=new Image;r.onload=Dj(SK,n,r,"TestLoadImage: loaded",!0,t),r.onerror=Dj(SK,n,r,"TestLoadImage: error",!1,t),r.onabort=Dj(SK,n,r,"TestLoadImage: abort",!1,t),r.ontimeout=Dj(SK,n,r,"TestLoadImage: timeout",!1,t),Pj.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=e}else t(!1)}(n.toString(),r)}else dY(2);e.G=0,e.j&&e.j.va(t),lJ(e),KK(e)}function lJ(e){e.G=0,e.I=-1,e.j&&((0!=wK(e.i).length||0!=e.l.length)&&(e.i.i.length=0,Hj(e.l),e.l.length=0),e.j.ua())}function hJ(e,t,n){var r=function(e){return e instanceof WY?jY(e):new WY(e,void 0)}(n);if(""!=r.i)t&&YY(r,t+"."+r.i),KY(r,r.m);else{var i=Pj.location;r=function(e,t,n,r){var i=new WY(null,void 0);return e&&ZY(i,e),t&&YY(i,t),n&&KY(i,n),r&&(i.l=r),i}(i.protocol,t?t+"."+i.hostname:i.hostname,+i.port,n)}return e.aa&&Kj(e.aa,function(e,t){QY(r,t,e)}),n=e.sa,(t=e.D)&&n&&QY(r,t,n),QY(r,"VER",e.ma),eJ(e,r),r}function fJ(e,t,n){if(t&&!e.H)throw Error("Can't create secondary domain capable XhrIo object.");return(t=new NK(n&&e.Ba&&!e.qa?new PK({ib:!0}):e.qa)).L=e.H,t}function dJ(){}function vJ(){if(rZ&&!(10<=Number(dZ)))throw Error("Environmental error: no available transport.")}function pJ(e,t){FZ.call(this),this.g=new jK(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.s=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.ya&&(e?e["X-WebChannel-Client-Profile"]=t.ya:e={"X-WebChannel-Client-Profile":t.ya}),this.g.P=e,(e=t&&t.httpHeadersOverwriteParam)&&!Gj(e)&&(this.g.o=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!Gj(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&t in(e=this.h)&&delete e[t]),this.j=new mJ(this)}function gJ(e){CY.call(this);var t=e.__sm__;if(t){e:{for(var n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function yJ(){bY.call(this),this.status=1}function mJ(e){this.g=e}(lj=NK.prototype).ea=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+e);t=t?t.toUpperCase():"GET",this.H=e,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():_Y.g(),this.C=function(e){return e.h||(e.h=e.i())}(this.u?this.u:_Y),this.g.onreadystatechange=Mj(this.Fa,this);try{this.F=!0,this.g.open(t,String(e),!0),this.F=!1}catch(a){return void BK(this,a)}e=n||"";var i=new HY(this.headers);r&&zY(r,function(e,t){i.set(t,e)}),r=function(e){e:{for(var t=FK,n=e.length,r="string"==typeof e?e.split(""):e,i=0;i<n;i++)if(i in r&&t.call(void 0,r[i],i,e)){t=i;break e}t=-1}return 0>t?null:"string"==typeof e?e.charAt(t):e[t]}(i.T()),n=Pj.FormData&&e instanceof Pj.FormData,!(0<=Vj(LK,t))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach(function(e,t){this.g.setRequestHeader(t,e)},this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{HK(this),0<this.B&&((this.K=function(e){return rZ&&function(){return e=fZ,Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=function(){for(var e=0,t=$j(String(tZ)).split("."),n=$j("9").split("."),r=Math.max(t.length,n.length),i=0;0==e&&i<r;i++){var a=t[i]||"",o=n[i]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],0==a[0].length&&0==o[0].length)break;e=jj(0==a[1].length?0:parseInt(a[1],10),0==o[1].length?0:parseInt(o[1],10))||jj(0==a[2].length,0==o[2].length)||jj(a[2],o[2]),a=a[3],o=o[3]}while(0==e)}return 0<=e}();var e}()&&"number"==typeof e.timeout&&void 0!==e.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Mj(this.pa,this)):this.A=QZ(this.pa,this.B,this)),this.v=!0,this.g.send(e),this.v=!1}catch(a){BK(this,a)}},lj.pa=function(){void 0!==Sj&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,BZ(this,"timeout"),this.abort(8))},lj.abort=function(e){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=e||7,BZ(this,"complete"),BZ(this,"abort"),zK(this))},lj.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),zK(this,!0)),NK.Z.M.call(this)},lj.Fa=function(){this.s||(this.F||this.v||this.l?UK(this):this.cb())},lj.cb=function(){UK(this)},lj.ba=function(){try{return 2<GK(this)?this.g.status:-1}catch(e){return-1}},lj.ga=function(){try{return this.g?this.g.responseText:""}catch(e){return""}},lj.Qa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),RK(t)}},lj.Da=function(){return this.m},lj.La=function(){return"string"==typeof this.j?this.j:String(this.j)},(lj=jK.prototype).ma=8,lj.G=1,lj.hb=function(e){try{this.h.info("Origin Trials invoked: "+e)}catch(t){}},lj.Ha=function(e){if(this.m)if(this.m=null,1==this.G){if(!e){this.V=Math.floor(1e5*Math.random()),e=this.V++;var t=new SY(this,this.h,e,void 0),n=this.s;if(this.P&&(n?Xj(n=Jj(n),this.P):n=this.P),null===this.o&&(t.H=n),this.ja)e:{for(var r=0,i=0;i<this.l.length;i++){var a=this.l[i];if(void 0===(a="__data__"in a.g&&"string"==typeof(a=a.g.__data__)?a.length:void 0))break;if(4096<(r+=a)){r=i;break e}if(4096===r||i===this.l.length-1){r=i+1;break e}}r=1e3}else r=1e3;r=tJ(this,t,r),QY(i=jY(this.F),"RID",e),QY(i,"CVER",22),this.D&&QY(i,"X-HTTP-Session-Id",this.D),eJ(this,i),this.o&&n&&$K(i,this.o,n),kK(this.i,t),this.Ra&&QY(i,"TYPE","init"),this.ja?(QY(i,"$req",r),QY(i,"SID","null"),t.$=!0,xY(t,i,null)):xY(t,i,r),this.G=2}}else 3==this.G&&(e?XK(this,e):0==this.l.length||gK(this.i)||XK(this))},lj.Ga=function(){if(this.u=null,aJ(this),this.$&&!(this.L||null==this.g||0>=this.O)){var e=2*this.O;this.h.info("BP detection timer enabled: "+e),this.B=pY(Mj(this.bb,this),e)}},lj.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,dY(10),YK(this),aJ(this))},lj.ab=function(){null!=this.v&&(this.v=null,YK(this),rJ(this),dY(19))},lj.jb=function(e){e?(this.h.info("Successfully pinged google.com"),dY(2)):(this.h.info("Failed to ping google.com"),dY(1))},(lj=dJ.prototype).xa=function(){},lj.wa=function(){},lj.va=function(){},lj.ua=function(){},lj.Oa=function(){},vJ.prototype.g=function(e,t){return new pJ(e,t)},Lj(pJ,FZ),pJ.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var e=this.g,t=this.l,n=this.h||void 0;e.Wa&&(e.h.info("Origin Trials enabled."),WZ(Mj(e.hb,e,t))),dY(0),e.W=t,e.aa=n||{},e.N=e.X,e.F=hJ(e,null,e.W),QK(e)},pJ.prototype.close=function(){ZK(this.g)},pJ.prototype.u=function(e){if("string"==typeof e){var t={};t.__data__=e,JK(this.g,t)}else this.v?((t={}).__data__=UZ(e),JK(this.g,t)):JK(this.g,e)},pJ.prototype.M=function(){this.g.j=null,delete this.j,ZK(this.g),delete this.g,pJ.Z.M.call(this)},Lj(gJ,CY),Lj(yJ,bY),Lj(mJ,dJ),mJ.prototype.xa=function(){BZ(this.g,"a")},mJ.prototype.wa=function(e){BZ(this.g,new gJ(e))},mJ.prototype.va=function(e){BZ(this.g,new yJ(e))},mJ.prototype.ua=function(){BZ(this.g,"b")},vJ.prototype.createWebChannel=vJ.prototype.g,pJ.prototype.send=pJ.prototype.u,pJ.prototype.open=pJ.prototype.m,pJ.prototype.close=pJ.prototype.close,gY.NO_ERROR=0,gY.TIMEOUT=8,gY.HTTP_ERROR=6,yY.COMPLETE="complete",kY.EventType=wY,wY.OPEN="a",wY.CLOSE="b",wY.ERROR="c",wY.MESSAGE="d",FZ.prototype.listen=FZ.prototype.N,NK.prototype.listenOnce=NK.prototype.O,NK.prototype.getLastError=NK.prototype.La,NK.prototype.getLastErrorCode=NK.prototype.Da,NK.prototype.getStatus=NK.prototype.ba,NK.prototype.getResponseJson=NK.prototype.Qa,NK.prototype.getResponseText=NK.prototype.ga,NK.prototype.send=NK.prototype.ea;var kJ=Ej.createWebChannelTransport=function(){return new vJ},_J=Ej.getStatEventTarget=function(){return cY()},wJ=Ej.ErrorCode=gY,CJ=Ej.EventType=yY,bJ=Ej.Event=sY,EJ=Ej.Stat={rb:0,ub:1,vb:2,Ob:3,Tb:4,Qb:5,Rb:6,Pb:7,Nb:8,Sb:9,PROXY:10,NOPROXY:11,Lb:12,Hb:13,Ib:14,Gb:15,Jb:16,Kb:17,nb:18,mb:19,ob:20},SJ=Ej.FetchXmlHttpFactory=PK,PJ=Ej.WebChannel=kY,OJ=Ej.XhrIo=NK,TJ="@firebase/firestore",IJ=function(){function e(t){tp(this,e),this.uid=t}return rp(e,[{key:"isAuthenticated",value:function(){return null!=this.uid}},{key:"toKey",value:function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}},{key:"isEqual",value:function(e){return e.uid===this.uid}}]),e}();IJ.UNAUTHENTICATED=new IJ(null),IJ.GOOGLE_CREDENTIALS=new IJ("google-credentials-uid"),IJ.FIRST_PARTY=new IJ("first-party-uid"),IJ.MOCK_USER=new IJ("mock-user");var xJ="9.6.5",AJ=new oV("@firebase/firestore");function RJ(){return AJ.logLevel}function NJ(e){if(AJ.logLevel<=tV.DEBUG){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=n.map(LJ);AJ.debug.apply(AJ,["Firestore (".concat(xJ,"): ").concat(e)].concat(Kv(i)))}}function MJ(e){if(AJ.logLevel<=tV.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=n.map(LJ);AJ.error.apply(AJ,["Firestore (".concat(xJ,"): ").concat(e)].concat(Kv(i)))}}function DJ(e){if(AJ.logLevel<=tV.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=n.map(LJ);AJ.warn.apply(AJ,["Firestore (".concat(xJ,"): ").concat(e)].concat(Kv(i)))}}function LJ(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function FJ(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected state",t="FIRESTORE (".concat(xJ,") INTERNAL ASSERTION FAILED: ")+e;throw MJ(t),new Error(t)}function BJ(e,t){e||FJ()}function VJ(e,t){return e}var UJ={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},zJ=function(e){Gv(n,e);var t=$v(n);function n(e,r){var i;return tp(this,n),(i=t.call(this,e,r)).code=e,i.message=r,i.toString=function(){return"".concat(i.name,": [code=").concat(i.code,"]: ").concat(i.message)},i}return rp(n)}(TB),HJ=rp(function e(){var t=this;tp(this,e),this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})}),GJ=rp(function e(t,n){tp(this,e),this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization","Bearer ".concat(t))}),qJ=function(){function e(){tp(this,e)}return rp(e,[{key:"getToken",value:function(){return Promise.resolve(null)}},{key:"invalidateToken",value:function(){}},{key:"start",value:function(e,t){e.enqueueRetryable(function(){return t(IJ.UNAUTHENTICATED)})}},{key:"shutdown",value:function(){}}]),e}(),$J=function(){function e(t){tp(this,e),this.token=t,this.changeListener=null}return rp(e,[{key:"getToken",value:function(){return Promise.resolve(this.token)}},{key:"invalidateToken",value:function(){}},{key:"start",value:function(e,t){var n=this;this.changeListener=t,e.enqueueRetryable(function(){return t(n.token.user)})}},{key:"shutdown",value:function(){this.changeListener=null}}]),e}(),WJ=function(){function e(t){tp(this,e),this.t=t,this.currentUser=IJ.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}return rp(e,[{key:"start",value:function(e,t){var n=this,r=this,i=this.i,a=function(e){return n.i!==i?(i=n.i,t(e)):Promise.resolve()},o=new HJ;this.o=function(){n.i++,n.currentUser=n.u(),o.resolve(),o=new HJ,e.enqueueRetryable(function(){return a(n.currentUser)})};var s=function(){var t=o;e.enqueueRetryable(tB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.promise;case 2:return e.next=4,a(r.currentUser);case 4:case"end":return e.stop()}},e)})))},u=function(e){NJ("FirebaseAuthCredentialsProvider","Auth detected"),n.auth=e,n.auth.addAuthTokenListener(n.o),s()};this.t.onInit(function(e){return u(e)}),setTimeout(function(){if(!n.auth){var e=n.t.getImmediate({optional:!0});e?u(e):(NJ("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new HJ)}},0),s()}},{key:"getToken",value:function(){var e=this,t=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(function(n){return e.i!==t?(NJ("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),e.getToken()):n?(BJ("string"==typeof n.accessToken),new GJ(n.accessToken,e.currentUser)):null}):Promise.resolve(null)}},{key:"invalidateToken",value:function(){this.forceRefresh=!0}},{key:"shutdown",value:function(){this.auth&&this.auth.removeAuthTokenListener(this.o)}},{key:"u",value:function(){var e=this.auth&&this.auth.getUid();return BJ(null===e||"string"==typeof e),new IJ(e)}}]),e}(),jJ=rp(function e(t,n,r){tp(this,e),this.type="FirstParty",this.user=IJ.FIRST_PARTY,this.headers=new Map,this.headers.set("X-Goog-AuthUser",n);var i=t.auth.getAuthHeaderValueForFirstParty([]);i&&this.headers.set("Authorization",i),r&&this.headers.set("X-Goog-Iam-Authorization-Token",r)}),ZJ=function(){function e(t,n,r){tp(this,e),this.h=t,this.l=n,this.m=r}return rp(e,[{key:"getToken",value:function(){return Promise.resolve(new jJ(this.h,this.l,this.m))}},{key:"start",value:function(e,t){e.enqueueRetryable(function(){return t(IJ.FIRST_PARTY)})}},{key:"shutdown",value:function(){}},{key:"invalidateToken",value:function(){}}]),e}(),YJ=rp(function e(t){tp(this,e),this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}),KJ=function(){function e(t){tp(this,e),this.g=t,this.forceRefresh=!1,this.appCheck=null}return rp(e,[{key:"start",value:function(e,t){var n=this;this.o=function(n){e.enqueueRetryable(function(){return null!=(e=n).error&&NJ("FirebaseAppCheckTokenProvider","Error getting App Check token; using placeholder token instead. Error: ".concat(e.error.message)),t(e.token);var e})};var r=function(e){NJ("FirebaseAppCheckTokenProvider","AppCheck detected"),n.appCheck=e,n.appCheck.addTokenListener(n.o)};this.g.onInit(function(e){return r(e)}),setTimeout(function(){if(!n.appCheck){var e=n.g.getImmediate({optional:!0});e?r(e):NJ("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}},{key:"getToken",value:function(){var e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(function(e){return e?(BJ("string"==typeof e.token),new YJ(e.token)):null}):Promise.resolve(null)}},{key:"invalidateToken",value:function(){this.forceRefresh=!0}},{key:"shutdown",value:function(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}]),e}(),JJ=function(){function e(t,n){var r=this;tp(this,e),this.previousValue=t,n&&(n.sequenceNumberHandler=function(e){return r.p(e)},this.T=function(e){return n.writeSequenceNumber(e)})}return rp(e,[{key:"p",value:function(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}},{key:"next",value:function(){var e=++this.previousValue;return this.T&&this.T(e),e}}]),e}();function QJ(e){var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(var r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}JJ.I=-1;var XJ=function(){function e(){tp(this,e)}return rp(e,null,[{key:"A",value:function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,n="";n.length<20;)for(var r=QJ(40),i=0;i<r.length;++i)n.length<20&&r[i]<t&&(n+=e.charAt(r[i]%e.length));return n}}]),e}();function eQ(e,t){return e<t?-1:e>t?1:0}function tQ(e,t,n){return e.length===t.length&&e.every(function(e,r){return n(e,t[r])})}var nQ=function(){function e(t,n){if(tp(this,e),this.seconds=t,this.nanoseconds=n,n<0)throw new zJ(UJ.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new zJ(UJ.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(t<-62135596800)throw new zJ(UJ.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new zJ(UJ.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return rp(e,[{key:"toDate",value:function(){return new Date(this.toMillis())}},{key:"toMillis",value:function(){return 1e3*this.seconds+this.nanoseconds/1e6}},{key:"_compareTo",value:function(e){return this.seconds===e.seconds?eQ(this.nanoseconds,e.nanoseconds):eQ(this.seconds,e.seconds)}},{key:"isEqual",value:function(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}},{key:"toString",value:function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}},{key:"toJSON",value:function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}},{key:"valueOf",value:function(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}],[{key:"now",value:function(){return e.fromMillis(Date.now())}},{key:"fromDate",value:function(t){return e.fromMillis(t.getTime())}},{key:"fromMillis",value:function(t){var n=Math.floor(t/1e3);return new e(n,Math.floor(1e6*(t-1e3*n)))}}]),e}(),rQ=function(){function e(t){tp(this,e),this.timestamp=t}return rp(e,[{key:"compareTo",value:function(e){return this.timestamp._compareTo(e.timestamp)}},{key:"isEqual",value:function(e){return this.timestamp.isEqual(e.timestamp)}},{key:"toMicroseconds",value:function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}},{key:"toString",value:function(){return"SnapshotVersion("+this.timestamp.toString()+")"}},{key:"toTimestamp",value:function(){return this.timestamp}}],[{key:"fromTimestamp",value:function(t){return new e(t)}},{key:"min",value:function(){return new e(new nQ(0,0))}}]),e}();function iQ(e){var t=0;for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function aQ(e,t){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function oQ(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}var sQ=function(){function e(t,n,r){tp(this,e),void 0===n?n=0:n>t.length&&FJ(),void 0===r?r=t.length-n:r>t.length-n&&FJ(),this.segments=t,this.offset=n,this.len=r}return rp(e,[{key:"length",get:function(){return this.len}},{key:"isEqual",value:function(t){return 0===e.comparator(this,t)}},{key:"child",value:function(t){var n=this.segments.slice(this.offset,this.limit());return t instanceof e?t.forEach(function(e){n.push(e)}):n.push(t),this.construct(n)}},{key:"limit",value:function(){return this.offset+this.length}},{key:"popFirst",value:function(e){return this.construct(this.segments,this.offset+(e=void 0===e?1:e),this.length-e)}},{key:"popLast",value:function(){return this.construct(this.segments,this.offset,this.length-1)}},{key:"firstSegment",value:function(){return this.segments[this.offset]}},{key:"lastSegment",value:function(){return this.get(this.length-1)}},{key:"get",value:function(e){return this.segments[this.offset+e]}},{key:"isEmpty",value:function(){return 0===this.length}},{key:"isPrefixOf",value:function(e){if(e.length<this.length)return!1;for(var t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}},{key:"isImmediateParentOf",value:function(e){if(this.length+1!==e.length)return!1;for(var t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}},{key:"forEach",value:function(e){for(var t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}},{key:"toArray",value:function(){return this.segments.slice(this.offset,this.limit())}}],[{key:"comparator",value:function(e,t){for(var n=Math.min(e.length,t.length),r=0;r<n;r++){var i=e.get(r),a=t.get(r);if(i<a)return-1;if(i>a)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}]),e}(),uQ=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"construct",value:function(e,t,r){return new n(e,t,r)}},{key:"canonicalString",value:function(){return this.toArray().join("/")}},{key:"toString",value:function(){return this.canonicalString()}}],[{key:"fromString",value:function(){for(var e=[],t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];for(var a=0,o=r;a<o.length;a++){var s=o[a];if(s.indexOf("//")>=0)throw new zJ(UJ.INVALID_ARGUMENT,"Invalid segment (".concat(s,"). Paths must not contain // in them."));e.push.apply(e,Kv(s.split("/").filter(function(e){return e.length>0})))}return new n(e)}},{key:"emptyPath",value:function(){return new n([])}}]),n}(sQ),cQ=/^[_a-zA-Z][_a-zA-Z0-9]*$/,lQ=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"construct",value:function(e,t,r){return new n(e,t,r)}},{key:"canonicalString",value:function(){return this.toArray().map(function(e){return e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e}).join(".")}},{key:"toString",value:function(){return this.canonicalString()}},{key:"isKeyField",value:function(){return 1===this.length&&"__name__"===this.get(0)}}],[{key:"isValidIdentifier",value:function(e){return cQ.test(e)}},{key:"keyField",value:function(){return new n(["__name__"])}},{key:"fromServerFormat",value:function(e){for(var t=[],r="",i=0,a=function(){if(0===r.length)throw new zJ(UJ.INVALID_ARGUMENT,"Invalid field path (".concat(e,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"));t.push(r),r=""},o=!1;i<e.length;){var s=e[i];if("\\"===s){if(i+1===e.length)throw new zJ(UJ.INVALID_ARGUMENT,"Path has trailing escape character: "+e);var u=e[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new zJ(UJ.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,i+=2}else"`"===s?(o=!o,i++):"."!==s||o?(r+=s,i++):(a(),i++)}if(a(),o)throw new zJ(UJ.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}},{key:"emptyPath",value:function(){return new n([])}}]),n}(sQ),hQ=function(){function e(t){tp(this,e),this.fields=t,t.sort(lQ.comparator)}return rp(e,[{key:"covers",value:function(e){var t,n=Qv(this.fields);try{for(n.s();!(t=n.n()).done;){if(t.value.isPrefixOf(e))return!0}}catch(r){n.e(r)}finally{n.f()}return!1}},{key:"isEqual",value:function(e){return tQ(this.fields,e.fields,function(e,t){return e.isEqual(t)})}}]),e}(),fQ=function(e){function t(e){tp(this,t),this.binaryString=e}return rp(t,[{key:Symbol.iterator,value:function(){var e=this,t=0;return{next:function(){return t<e.binaryString.length?{value:e.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}}},{key:"toBase64",value:function(){return btoa(this.binaryString)}},{key:"toUint8Array",value:function(){return function(e){for(var t=new Uint8Array(e.length),n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}},{key:"approximateByteSize",value:function(){return 2*this.binaryString.length}},{key:"compareTo",value:function(e){return eQ(this.binaryString,e.binaryString)}},{key:"isEqual",value:function(e){return this.binaryString===e.binaryString}}],[{key:"fromBase64String",value:function(e){return new t(atob(e))}},{key:"fromUint8Array",value:function(e){return new t(function(e){for(var t="",n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e))}}]),t}();fQ.EMPTY_BYTE_STRING=new fQ("");var dQ=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function vQ(e){if(BJ(!!e),"string"==typeof e){var t=0,n=dQ.exec(e);if(BJ(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),t=Number(r)}var i=new Date(e);return{seconds:Math.floor(i.getTime()/1e3),nanos:t}}return{seconds:pQ(e.seconds),nanos:pQ(e.nanos)}}function pQ(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function gQ(e){return"string"==typeof e?fQ.fromBase64String(e):fQ.fromUint8Array(e)}function yQ(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function mQ(e){var t=e.mapValue.fields.__previous_value__;return yQ(t)?mQ(t):t}function kQ(e){var t=vQ(e.mapValue.fields.__local_write_time__.timestampValue);return new nQ(t.seconds,t.nanos)}function _Q(e){return null==e}function wQ(e){return 0===e&&1/e==-1/0}var CQ=function(){function e(t){tp(this,e),this.path=t}return rp(e,[{key:"hasCollectionId",value:function(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}},{key:"isEqual",value:function(e){return null!==e&&0===uQ.comparator(this.path,e.path)}},{key:"toString",value:function(){return this.path.toString()}}],[{key:"fromPath",value:function(t){return new e(uQ.fromString(t))}},{key:"fromName",value:function(t){return new e(uQ.fromString(t).popFirst(5))}},{key:"comparator",value:function(e,t){return uQ.comparator(e.path,t.path)}},{key:"isDocumentKey",value:function(e){return e.length%2==0}},{key:"fromSegments",value:function(t){return new e(new uQ(t.slice()))}}]),e}();function bQ(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?yQ(e)?4:10:FJ()}function EQ(e,t){if(e===t)return!0;var n,r=bQ(e);if(r!==bQ(t))return!1;switch(r){case 0:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return kQ(e).isEqual(kQ(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;var n=vQ(e.timestampValue),r=vQ(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return n=t,gQ(e.bytesValue).isEqual(gQ(n.bytesValue));case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return pQ(e.geoPointValue.latitude)===pQ(t.geoPointValue.latitude)&&pQ(e.geoPointValue.longitude)===pQ(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return pQ(e.integerValue)===pQ(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){var n=pQ(e.doubleValue),r=pQ(t.doubleValue);return n===r?wQ(n)===wQ(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return tQ(e.arrayValue.values||[],t.arrayValue.values||[],EQ);case 10:return function(e,t){var n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(iQ(n)!==iQ(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!EQ(n[i],r[i])))return!1;return!0}(e,t);default:return FJ()}}function SQ(e,t){return void 0!==(e.values||[]).find(function(e){return EQ(e,t)})}function PQ(e,t){if(e===t)return 0;var n,r,i,a,o=bQ(e),s=bQ(t);if(o!==s)return eQ(o,s);switch(o){case 0:return 0;case 1:return eQ(e.booleanValue,t.booleanValue);case 2:return r=t,i=pQ((n=e).integerValue||n.doubleValue),a=pQ(r.integerValue||r.doubleValue),i<a?-1:i>a?1:i===a?0:isNaN(i)?isNaN(a)?0:-1:1;case 3:return OQ(e.timestampValue,t.timestampValue);case 4:return OQ(kQ(e),kQ(t));case 5:return eQ(e.stringValue,t.stringValue);case 6:return function(e,t){var n=gQ(e),r=gQ(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){for(var n=e.split("/"),r=t.split("/"),i=0;i<n.length&&i<r.length;i++){var a=eQ(n[i],r[i]);if(0!==a)return a}return eQ(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){var n=eQ(pQ(e.latitude),pQ(t.latitude));return 0!==n?n:eQ(pQ(e.longitude),pQ(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(e,t){for(var n=e.values||[],r=t.values||[],i=0;i<n.length&&i<r.length;++i){var a=PQ(n[i],r[i]);if(a)return a}return eQ(n.length,r.length)}(e.arrayValue,t.arrayValue);case 10:return function(e,t){var n=e.fields||{},r=Object.keys(n),i=t.fields||{},a=Object.keys(i);r.sort(),a.sort();for(var o=0;o<r.length&&o<a.length;++o){var s=eQ(r[o],a[o]);if(0!==s)return s;var u=PQ(n[r[o]],i[a[o]]);if(0!==u)return u}return eQ(r.length,a.length)}(e.mapValue,t.mapValue);default:throw FJ()}}function OQ(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return eQ(e,t);var n=vQ(e),r=vQ(t),i=eQ(n.seconds,r.seconds);return 0!==i?i:eQ(n.nanos,r.nanos)}function TQ(e){return IQ(e)}function IQ(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?(t=e.timestampValue,n=vQ(t),"time(".concat(n.seconds,",").concat(n.nanos,")")):"stringValue"in e?e.stringValue:"bytesValue"in e?gQ(e.bytesValue).toBase64():"referenceValue"in e?CQ.fromName(e.referenceValue).toString():"geoPointValue"in e?"geo(".concat((r=e.geoPointValue).latitude,",").concat(r.longitude,")"):"arrayValue"in e?function(e){var t,n="[",r=!0,i=Qv(e.values||[]);try{for(i.s();!(t=i.n()).done;){var a=t.value;r?r=!1:n+=",",n+=IQ(a)}}catch(o){i.e(o)}finally{i.f()}return n+"]"}(e.arrayValue):"mapValue"in e?function(e){var t,n="{",r=!0,i=Qv(Object.keys(e.fields||{}).sort());try{for(i.s();!(t=i.n()).done;){var a=t.value;r?r=!1:n+=",",n+="".concat(a,":").concat(IQ(e.fields[a]))}}catch(o){i.e(o)}finally{i.f()}return n+"}"}(e.mapValue):FJ();var t,n,r}function xQ(e,t){return{referenceValue:"projects/".concat(e.projectId,"/databases/").concat(e.database,"/documents/").concat(t.path.canonicalString())}}function AQ(e){return!!e&&"integerValue"in e}function RQ(e){return!!e&&"arrayValue"in e}function NQ(e){return!!e&&"nullValue"in e}function MQ(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function DQ(e){return!!e&&"mapValue"in e}function LQ(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){var t={mapValue:{fields:{}}};return aQ(e.mapValue.fields,function(e,n){return t.mapValue.fields[e]=LQ(n)}),t}if(e.arrayValue){for(var n={arrayValue:{values:[]}},r=0;r<(e.arrayValue.values||[]).length;++r)n.arrayValue.values[r]=LQ(e.arrayValue.values[r]);return n}return Object.assign({},e)}var FQ=function(){function e(t){tp(this,e),this.value=t}return rp(e,[{key:"field",value:function(e){if(e.isEmpty())return this.value;for(var t=this.value,n=0;n<e.length-1;++n)if(!DQ(t=(t.mapValue.fields||{})[e.get(n)]))return null;return(t=(t.mapValue.fields||{})[e.lastSegment()])||null}},{key:"set",value:function(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=LQ(t)}},{key:"setAll",value:function(e){var t=this,n=lQ.emptyPath(),r={},i=[];e.forEach(function(e,a){if(!n.isImmediateParentOf(a)){var o=t.getFieldsMap(n);t.applyChanges(o,r,i),r={},i=[],n=a.popLast()}e?r[a.lastSegment()]=LQ(e):i.push(a.lastSegment())});var a=this.getFieldsMap(n);this.applyChanges(a,r,i)}},{key:"delete",value:function(e){var t=this.field(e.popLast());DQ(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}},{key:"isEqual",value:function(e){return EQ(this.value,e.value)}},{key:"getFieldsMap",value:function(e){var t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(var n=0;n<e.length;++n){var r=t.mapValue.fields[e.get(n)];DQ(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}},{key:"applyChanges",value:function(e,t,n){aQ(t,function(t,n){return e[t]=n});var r,i=Qv(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;delete e[a]}}catch(o){i.e(o)}finally{i.f()}}},{key:"clone",value:function(){return new e(LQ(this.value))}}],[{key:"empty",value:function(){return new e({mapValue:{}})}}]),e}();function BQ(e){var t=[];return aQ(e.fields,function(e,n){var r=new lQ([e]);if(DQ(n)){var i=BQ(n.mapValue).fields;if(0===i.length)t.push(r);else{var a,o=Qv(i);try{for(o.s();!(a=o.n()).done;){var s=a.value;t.push(r.child(s))}}catch(u){o.e(u)}finally{o.f()}}}else t.push(r)}),new hQ(t)}var VQ=function(){function e(t,n,r,i,a){tp(this,e),this.key=t,this.documentType=n,this.version=r,this.data=i,this.documentState=a}return rp(e,[{key:"convertToFoundDocument",value:function(e,t){return this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}},{key:"convertToNoDocument",value:function(e){return this.version=e,this.documentType=2,this.data=FQ.empty(),this.documentState=0,this}},{key:"convertToUnknownDocument",value:function(e){return this.version=e,this.documentType=3,this.data=FQ.empty(),this.documentState=2,this}},{key:"setHasCommittedMutations",value:function(){return this.documentState=2,this}},{key:"setHasLocalMutations",value:function(){return this.documentState=1,this}},{key:"hasLocalMutations",get:function(){return 1===this.documentState}},{key:"hasCommittedMutations",get:function(){return 2===this.documentState}},{key:"hasPendingWrites",get:function(){return this.hasLocalMutations||this.hasCommittedMutations}},{key:"isValidDocument",value:function(){return 0!==this.documentType}},{key:"isFoundDocument",value:function(){return 1===this.documentType}},{key:"isNoDocument",value:function(){return 2===this.documentType}},{key:"isUnknownDocument",value:function(){return 3===this.documentType}},{key:"isEqual",value:function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}},{key:"mutableCopy",value:function(){return new e(this.key,this.documentType,this.version,this.data.clone(),this.documentState)}},{key:"toString",value:function(){return"Document(".concat(this.key,", ").concat(this.version,", ").concat(JSON.stringify(this.data.value),", {documentType: ").concat(this.documentType,"}), {documentState: ").concat(this.documentState,"})")}}],[{key:"newInvalidDocument",value:function(t){return new e(t,0,rQ.min(),FQ.empty(),0)}},{key:"newFoundDocument",value:function(t,n,r){return new e(t,1,n,r,0)}},{key:"newNoDocument",value:function(t,n){return new e(t,2,n,FQ.empty(),0)}},{key:"newUnknownDocument",value:function(t,n){return new e(t,3,n,FQ.empty(),2)}}]),e}(),UQ=rp(function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;tp(this,e),this.path=t,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=a,this.startAt=o,this.endAt=s,this.R=null});function zQ(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;return new UQ(e,t,n,r,i,a,o)}function HQ(e){var t=VJ(e);if(null===t.R){var n=t.path.canonicalString();null!==t.collectionGroup&&(n+="|cg:"+t.collectionGroup),n+="|f:",n+=t.filters.map(function(e){return function(e){return e.field.canonicalString()+e.op.toString()+TQ(e.value)}(e)}).join(","),n+="|ob:",n+=t.orderBy.map(function(e){return(t=e).field.canonicalString()+t.dir;var t}).join(","),_Q(t.limit)||(n+="|l:",n+=t.limit),t.startAt&&(n+="|lb:",n+=tX(t.startAt)),t.endAt&&(n+="|ub:",n+=tX(t.endAt)),t.R=n}return t.R}function GQ(e,t){if(e.limit!==t.limit||e.orderBy.length!==t.orderBy.length)return!1;for(var n=0;n<e.orderBy.length;n++)if(!rX(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(var r=0;r<e.filters.length;r++)if((i=e.filters[r]).op!==(a=t.filters[r]).op||!i.field.isEqual(a.field)||!EQ(i.value,a.value))return!1;var i,a;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!aX(e.startAt,t.startAt)&&aX(e.endAt,t.endAt)}function qQ(e){return CQ.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}var $Q=function(e){Gv(n,e);var t=$v(n);function n(e,r,i){var a;return tp(this,n),(a=t.call(this)).field=e,a.op=r,a.value=i,a}return rp(n,[{key:"matches",value:function(e){var t=e.data.field(this.field);return"!="===this.op?null!==t&&this.v(PQ(t,this.value)):null!==t&&bQ(this.value)===bQ(t)&&this.v(PQ(t,this.value))}},{key:"v",value:function(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return FJ()}}},{key:"V",value:function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}],[{key:"create",value:function(e,t,r){return e.isKeyField()?"in"===t||"not-in"===t?this.P(e,t,r):new WQ(e,t,r):"array-contains"===t?new KQ(e,r):"in"===t?new JQ(e,r):"not-in"===t?new QQ(e,r):"array-contains-any"===t?new XQ(e,r):new n(e,t,r)}},{key:"P",value:function(e,t,n){return"in"===t?new jQ(e,n):new ZQ(e,n)}}]),n}(function(){return rp(function e(){tp(this,e)})}()),WQ=function(e){Gv(n,e);var t=$v(n);function n(e,r,i){var a;return tp(this,n),(a=t.call(this,e,r,i)).key=CQ.fromName(i.referenceValue),a}return rp(n,[{key:"matches",value:function(e){var t=CQ.comparator(e.key,this.key);return this.v(t)}}]),n}($Q),jQ=function(e){Gv(n,e);var t=$v(n);function n(e,r){var i;return tp(this,n),(i=t.call(this,e,"in",r)).keys=YQ(0,r),i}return rp(n,[{key:"matches",value:function(e){return this.keys.some(function(t){return t.isEqual(e.key)})}}]),n}($Q),ZQ=function(e){Gv(n,e);var t=$v(n);function n(e,r){var i;return tp(this,n),(i=t.call(this,e,"not-in",r)).keys=YQ(0,r),i}return rp(n,[{key:"matches",value:function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})}}]),n}($Q);function YQ(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map(function(e){return CQ.fromName(e.referenceValue)})}var KQ=function(e){Gv(n,e);var t=$v(n);function n(e,r){return tp(this,n),t.call(this,e,"array-contains",r)}return rp(n,[{key:"matches",value:function(e){var t=e.data.field(this.field);return RQ(t)&&SQ(t.arrayValue,this.value)}}]),n}($Q),JQ=function(e){Gv(n,e);var t=$v(n);function n(e,r){return tp(this,n),t.call(this,e,"in",r)}return rp(n,[{key:"matches",value:function(e){var t=e.data.field(this.field);return null!==t&&SQ(this.value.arrayValue,t)}}]),n}($Q),QQ=function(e){Gv(n,e);var t=$v(n);function n(e,r){return tp(this,n),t.call(this,e,"not-in",r)}return rp(n,[{key:"matches",value:function(e){if(SQ(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var t=e.data.field(this.field);return null!==t&&!SQ(this.value.arrayValue,t)}}]),n}($Q),XQ=function(e){Gv(n,e);var t=$v(n);function n(e,r){return tp(this,n),t.call(this,e,"array-contains-any",r)}return rp(n,[{key:"matches",value:function(e){var t=this,n=e.data.field(this.field);return!(!RQ(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(e){return SQ(t.value.arrayValue,e)})}}]),n}($Q),eX=rp(function e(t,n){tp(this,e),this.position=t,this.before=n});function tX(e){return"".concat(e.before?"b":"a",":").concat(e.position.map(function(e){return TQ(e)}).join(","))}var nX=rp(function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";tp(this,e),this.field=t,this.dir=n});function rX(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}function iX(e,t,n){for(var r=0,i=0;i<e.position.length;i++){var a=t[i],o=e.position[i];if(r=a.field.isKeyField()?CQ.comparator(CQ.fromName(o.referenceValue),n.key):PQ(o,n.data.field(a.field)),"desc"===a.dir&&(r*=-1),0!==r)break}return e.before?r<=0:r<0}function aX(e,t){if(null===e)return null===t;if(null===t||e.before!==t.before||e.position.length!==t.position.length)return!1;for(var n=0;n<e.position.length;n++)if(!EQ(e.position[n],t.position[n]))return!1;return!0}var oX=rp(function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;tp(this,e),this.path=t,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=a,this.limitType=o,this.startAt=s,this.endAt=u,this.S=null,this.D=null});function sX(e){return new oX(e)}function uX(e){return!_Q(e.limit)&&"F"===e.limitType}function cX(e){return!_Q(e.limit)&&"L"===e.limitType}function lX(e){return e.explicitOrderBy.length>0?e.explicitOrderBy[0].field:null}function hX(e){var t,n=Qv(e.filters);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.V())return r.field}}catch(i){n.e(i)}finally{n.f()}return null}function fX(e){return null!==e.collectionGroup}function dX(e){var t=VJ(e);if(null===t.S){t.S=[];var n=hX(t),r=lX(t);if(null!==n&&null===r)n.isKeyField()||t.S.push(new nX(n)),t.S.push(new nX(lQ.keyField(),"asc"));else{var i,a=!1,o=Qv(t.explicitOrderBy);try{for(o.s();!(i=o.n()).done;){var s=i.value;t.S.push(s),s.field.isKeyField()&&(a=!0)}}catch(c){o.e(c)}finally{o.f()}if(!a){var u=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";t.S.push(new nX(lQ.keyField(),u))}}}return t.S}function vX(e){var t=VJ(e);if(!t.D)if("F"===t.limitType)t.D=zQ(t.path,t.collectionGroup,dX(t),t.filters,t.limit,t.startAt,t.endAt);else{var n,r=[],i=Qv(dX(t));try{for(i.s();!(n=i.n()).done;){var a=n.value;r.push(new nX(a.field,"desc"===a.dir?"asc":"desc"))}}catch(u){i.e(u)}finally{i.f()}var o=t.endAt?new eX(t.endAt.position,!t.endAt.before):null,s=t.startAt?new eX(t.startAt.position,!t.startAt.before):null;t.D=zQ(t.path,t.collectionGroup,r,t.filters,t.limit,o,s)}return t.D}function pX(e,t,n){return new oX(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function gX(e,t){return GQ(vX(e),vX(t))&&e.limitType===t.limitType}function yX(e){return"".concat(HQ(vX(e)),"|lt:").concat(e.limitType)}function mX(e){return"Query(target=".concat(function(e){var t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=", filters: [".concat(e.filters.map(function(e){return"".concat((t=e).field.canonicalString()," ").concat(t.op," ").concat(TQ(t.value));var t}).join(", "),"]")),_Q(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=", orderBy: [".concat(e.orderBy.map(function(e){return"".concat((t=e).field.canonicalString()," (").concat(t.dir,")");var t}).join(", "),"]")),e.startAt&&(t+=", startAt: "+tX(e.startAt)),e.endAt&&(t+=", endAt: "+tX(e.endAt)),"Target(".concat(t,")")}(vX(e)),"; limitType=").concat(e.limitType,")")}function kX(e,t){return t.isFoundDocument()&&function(e,t){var n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):CQ.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){var n,r=Qv(e.explicitOrderBy);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(!i.field.isKeyField()&&null===t.data.field(i.field))return!1}}catch(a){r.e(a)}finally{r.f()}return!0}(e,t)&&function(e,t){var n,r=Qv(e.filters);try{for(r.s();!(n=r.n()).done;){if(!n.value.matches(t))return!1}}catch(i){r.e(i)}finally{r.f()}return!0}(e,t)&&(r=t,!((n=e).startAt&&!iX(n.startAt,dX(n),r)||n.endAt&&iX(n.endAt,dX(n),r)));var n,r}function _X(e){return function(t,n){var r,i=!1,a=Qv(dX(e));try{for(a.s();!(r=a.n()).done;){var o=r.value,s=wX(o,t,n);if(0!==s)return s;i=i||o.field.isKeyField()}}catch(u){a.e(u)}finally{a.f()}return 0}}function wX(e,t,n){var r,i,a,o,s=e.field.isKeyField()?CQ.comparator(t.key,n.key):(r=e.field,i=n,a=t.data.field(r),o=i.data.field(r),null!==a&&null!==o?PQ(a,o):FJ());switch(e.dir){case"asc":return s;case"desc":return-1*s;default:return FJ()}}function CX(e,t){if(e.C){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:wQ(t)?"-0":t}}function bX(e){return{integerValue:""+e}}var EX=rp(function e(){tp(this,e),this._=void 0});function SX(e,t,n){return e instanceof TX?(i=t,a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:(r=n).seconds,nanos:r.nanoseconds}}}},i&&(a.fields.__previous_value__=i),{mapValue:a}):e instanceof IX?xX(e,t):e instanceof AX?RX(e,t):function(e,t){var n=OX(e,t),r=MX(n)+MX(e.N);return AQ(n)&&AQ(e.N)?bX(r):CX(e.k,r)}(e,t);var r,i,a}function PX(e,t,n){return e instanceof IX?xX(e,t):e instanceof AX?RX(e,t):n}function OX(e,t){return e instanceof NX?AQ(r=t)||(n=r)&&"doubleValue"in n?t:{integerValue:0}:null;var n,r}var TX=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n)}(EX),IX=function(e){Gv(n,e);var t=$v(n);function n(e){var r;return tp(this,n),(r=t.call(this)).elements=e,r}return rp(n)}(EX);function xX(e,t){var n,r=DX(t),i=Qv(e.elements);try{var a=function(){var e=n.value;r.some(function(t){return EQ(t,e)})||r.push(e)};for(i.s();!(n=i.n()).done;)a()}catch(o){i.e(o)}finally{i.f()}return{arrayValue:{values:r}}}var AX=function(e){Gv(n,e);var t=$v(n);function n(e){var r;return tp(this,n),(r=t.call(this)).elements=e,r}return rp(n)}(EX);function RX(e,t){var n,r=DX(t),i=Qv(e.elements);try{var a=function(){var e=n.value;r=r.filter(function(t){return!EQ(t,e)})};for(i.s();!(n=i.n()).done;)a()}catch(o){i.e(o)}finally{i.f()}return{arrayValue:{values:r}}}var NX=function(e){Gv(n,e);var t=$v(n);function n(e,r){var i;return tp(this,n),(i=t.call(this)).k=e,i.N=r,i}return rp(n)}(EX);function MX(e){return pQ(e.integerValue||e.doubleValue)}function DX(e){return RQ(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}var LX=rp(function e(t,n){tp(this,e),this.field=t,this.transform=n}),FX=rp(function e(t,n){tp(this,e),this.version=t,this.transformResults=n}),BX=function(){function e(t,n){tp(this,e),this.updateTime=t,this.exists=n}return rp(e,[{key:"isNone",get:function(){return void 0===this.updateTime&&void 0===this.exists}},{key:"isEqual",value:function(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}],[{key:"none",value:function(){return new e}},{key:"exists",value:function(t){return new e(void 0,t)}},{key:"updateTime",value:function(t){return new e(t)}}]),e}();function VX(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}var UX=rp(function e(){tp(this,e)});function zX(e,t,n){var r,i,a,o,s;e instanceof WX?(i=t,a=n,o=(r=e).value.clone(),s=YX(r.fieldTransforms,i,a.transformResults),o.setAll(s),i.convertToFoundDocument(a.version,o).setHasCommittedMutations()):e instanceof jX?function(e,t,n){if(VX(e.precondition,t)){var r=YX(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(ZX(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}else t.convertToUnknownDocument(n.version)}(e,t,n):t.convertToNoDocument(n.version).setHasCommittedMutations()}function HX(e,t,n){var r;e instanceof WX?function(e,t,n){if(VX(e.precondition,t)){var r=e.value.clone(),i=KX(e.fieldTransforms,n,t);r.setAll(i),t.convertToFoundDocument($X(t),r).setHasLocalMutations()}}(e,t,n):e instanceof jX?function(e,t,n){if(VX(e.precondition,t)){var r=KX(e.fieldTransforms,n,t),i=t.data;i.setAll(ZX(e)),i.setAll(r),t.convertToFoundDocument($X(t),i).setHasLocalMutations()}}(e,t,n):VX(e.precondition,r=t)&&r.convertToNoDocument(rQ.min())}function GX(e,t){var n,r=null,i=Qv(e.fieldTransforms);try{for(i.s();!(n=i.n()).done;){var a=n.value,o=t.data.field(a.field),s=OX(a.transform,o||null);null!=s&&(null==r&&(r=FQ.empty()),r.set(a.field,s))}}catch(u){i.e(u)}finally{i.f()}return r||null}function qX(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&(r=t.fieldTransforms,!!(void 0===(n=e.fieldTransforms)&&void 0===r||n&&r&&tQ(n,r,function(e,t){return function(e,t){return e.field.isEqual(t.field)&&(r=t.transform,(n=e.transform)instanceof IX&&r instanceof IX||n instanceof AX&&r instanceof AX?tQ(n.elements,r.elements,EQ):n instanceof NX&&r instanceof NX?EQ(n.N,r.N):n instanceof TX&&r instanceof TX);var n,r}(e,t)})))&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask));var n,r}function $X(e){return e.isFoundDocument()?e.version:rQ.min()}var WX=function(e){Gv(n,e);var t=$v(n);function n(e,r,i){var a,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];return tp(this,n),(a=t.call(this)).key=e,a.value=r,a.precondition=i,a.fieldTransforms=o,a.type=0,a}return rp(n)}(UX),jX=function(e){Gv(n,e);var t=$v(n);function n(e,r,i,a){var o,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];return tp(this,n),(o=t.call(this)).key=e,o.data=r,o.fieldMask=i,o.precondition=a,o.fieldTransforms=s,o.type=1,o}return rp(n)}(UX);function ZX(e){var t=new Map;return e.fieldMask.fields.forEach(function(n){if(!n.isEmpty()){var r=e.data.field(n);t.set(n,r)}}),t}function YX(e,t,n){var r=new Map;BJ(e.length===n.length);for(var i=0;i<n.length;i++){var a=e[i],o=a.transform,s=t.data.field(a.field);r.set(a.field,PX(o,s,n[i]))}return r}function KX(e,t,n){var r,i=new Map,a=Qv(e);try{for(a.s();!(r=a.n()).done;){var o=r.value,s=o.transform,u=n.data.field(o.field);i.set(o.field,SX(s,u,t))}}catch(c){a.e(c)}finally{a.f()}return i}var JX,QX,XX=function(e){Gv(n,e);var t=$v(n);function n(e,r){var i;return tp(this,n),(i=t.call(this)).key=e,i.precondition=r,i.type=2,i.fieldTransforms=[],i}return rp(n)}(UX),e1=function(e){Gv(n,e);var t=$v(n);function n(e,r){var i;return tp(this,n),(i=t.call(this)).key=e,i.precondition=r,i.type=3,i.fieldTransforms=[],i}return rp(n)}(UX),t1=rp(function e(t){tp(this,e),this.count=t});function n1(e){switch(e){default:return FJ();case UJ.CANCELLED:case UJ.UNKNOWN:case UJ.DEADLINE_EXCEEDED:case UJ.RESOURCE_EXHAUSTED:case UJ.INTERNAL:case UJ.UNAVAILABLE:case UJ.UNAUTHENTICATED:return!1;case UJ.INVALID_ARGUMENT:case UJ.NOT_FOUND:case UJ.ALREADY_EXISTS:case UJ.PERMISSION_DENIED:case UJ.FAILED_PRECONDITION:case UJ.ABORTED:case UJ.OUT_OF_RANGE:case UJ.UNIMPLEMENTED:case UJ.DATA_LOSS:return!0}}function r1(e){if(void 0===e)return MJ("GRPC error has no .code"),UJ.UNKNOWN;switch(e){case JX.OK:return UJ.OK;case JX.CANCELLED:return UJ.CANCELLED;case JX.UNKNOWN:return UJ.UNKNOWN;case JX.DEADLINE_EXCEEDED:return UJ.DEADLINE_EXCEEDED;case JX.RESOURCE_EXHAUSTED:return UJ.RESOURCE_EXHAUSTED;case JX.INTERNAL:return UJ.INTERNAL;case JX.UNAVAILABLE:return UJ.UNAVAILABLE;case JX.UNAUTHENTICATED:return UJ.UNAUTHENTICATED;case JX.INVALID_ARGUMENT:return UJ.INVALID_ARGUMENT;case JX.NOT_FOUND:return UJ.NOT_FOUND;case JX.ALREADY_EXISTS:return UJ.ALREADY_EXISTS;case JX.PERMISSION_DENIED:return UJ.PERMISSION_DENIED;case JX.FAILED_PRECONDITION:return UJ.FAILED_PRECONDITION;case JX.ABORTED:return UJ.ABORTED;case JX.OUT_OF_RANGE:return UJ.OUT_OF_RANGE;case JX.UNIMPLEMENTED:return UJ.UNIMPLEMENTED;case JX.DATA_LOSS:return UJ.DATA_LOSS;default:return FJ()}}(QX=JX||(JX={}))[QX.OK=0]="OK",QX[QX.CANCELLED=1]="CANCELLED",QX[QX.UNKNOWN=2]="UNKNOWN",QX[QX.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",QX[QX.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",QX[QX.NOT_FOUND=5]="NOT_FOUND",QX[QX.ALREADY_EXISTS=6]="ALREADY_EXISTS",QX[QX.PERMISSION_DENIED=7]="PERMISSION_DENIED",QX[QX.UNAUTHENTICATED=16]="UNAUTHENTICATED",QX[QX.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",QX[QX.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",QX[QX.ABORTED=10]="ABORTED",QX[QX.OUT_OF_RANGE=11]="OUT_OF_RANGE",QX[QX.UNIMPLEMENTED=12]="UNIMPLEMENTED",QX[QX.INTERNAL=13]="INTERNAL",QX[QX.UNAVAILABLE=14]="UNAVAILABLE",QX[QX.DATA_LOSS=15]="DATA_LOSS";var i1=function(){function e(t,n){tp(this,e),this.comparator=t,this.root=n||o1.EMPTY}return rp(e,[{key:"insert",value:function(t,n){return new e(this.comparator,this.root.insert(t,n,this.comparator).copy(null,null,o1.BLACK,null,null))}},{key:"remove",value:function(t){return new e(this.comparator,this.root.remove(t,this.comparator).copy(null,null,o1.BLACK,null,null))}},{key:"get",value:function(e){for(var t=this.root;!t.isEmpty();){var n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}},{key:"indexOf",value:function(e){for(var t=0,n=this.root;!n.isEmpty();){var r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}},{key:"isEmpty",value:function(){return this.root.isEmpty()}},{key:"size",get:function(){return this.root.size}},{key:"minKey",value:function(){return this.root.minKey()}},{key:"maxKey",value:function(){return this.root.maxKey()}},{key:"inorderTraversal",value:function(e){return this.root.inorderTraversal(e)}},{key:"forEach",value:function(e){this.inorderTraversal(function(t,n){return e(t,n),!1})}},{key:"toString",value:function(){var e=[];return this.inorderTraversal(function(t,n){return e.push("".concat(t,":").concat(n)),!1}),"{".concat(e.join(", "),"}")}},{key:"reverseTraversal",value:function(e){return this.root.reverseTraversal(e)}},{key:"getIterator",value:function(){return new a1(this.root,null,this.comparator,!1)}},{key:"getIteratorFrom",value:function(e){return new a1(this.root,e,this.comparator,!1)}},{key:"getReverseIterator",value:function(){return new a1(this.root,null,this.comparator,!0)}},{key:"getReverseIteratorFrom",value:function(e){return new a1(this.root,e,this.comparator,!0)}}]),e}(),a1=function(){function e(t,n,r,i){tp(this,e),this.isReverse=i,this.nodeStack=[];for(var a=1;!t.isEmpty();)if(a=n?r(t.key,n):1,i&&(a*=-1),a<0)t=this.isReverse?t.left:t.right;else{if(0===a){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}return rp(e,[{key:"getNext",value:function(){var e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}},{key:"hasNext",value:function(){return this.nodeStack.length>0}},{key:"peek",value:function(){if(0===this.nodeStack.length)return null;var e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}]),e}(),o1=function(){function e(t,n,r,i,a){tp(this,e),this.key=t,this.value=n,this.color=null!=r?r:e.RED,this.left=null!=i?i:e.EMPTY,this.right=null!=a?a:e.EMPTY,this.size=this.left.size+1+this.right.size}return rp(e,[{key:"copy",value:function(t,n,r,i,a){return new e(null!=t?t:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=a?a:this.right)}},{key:"isEmpty",value:function(){return!1}},{key:"inorderTraversal",value:function(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}},{key:"reverseTraversal",value:function(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}},{key:"min",value:function(){return this.left.isEmpty()?this:this.left.min()}},{key:"minKey",value:function(){return this.min().key}},{key:"maxKey",value:function(){return this.right.isEmpty()?this.key:this.right.maxKey()}},{key:"insert",value:function(e,t,n){var r=this,i=n(e,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n))).fixUp()}},{key:"removeMin",value:function(){if(this.left.isEmpty())return e.EMPTY;var t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),(t=t.copy(null,null,null,t.left.removeMin(),null)).fixUp()}},{key:"remove",value:function(t,n){var r,i=this;if(n(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(t,i.key)){if(i.right.isEmpty())return e.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,n))}return i.fixUp()}},{key:"isRed",value:function(){return this.color}},{key:"fixUp",value:function(){var e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}},{key:"moveRedLeft",value:function(){var e=this.colorFlip();return e.right.left.isRed()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight())).rotateLeft()).colorFlip()),e}},{key:"moveRedRight",value:function(){var e=this.colorFlip();return e.left.left.isRed()&&(e=(e=e.rotateRight()).colorFlip()),e}},{key:"rotateLeft",value:function(){var t=this.copy(null,null,e.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}},{key:"rotateRight",value:function(){var t=this.copy(null,null,e.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}},{key:"colorFlip",value:function(){var e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}},{key:"checkMaxDepth",value:function(){var e=this.check();return Math.pow(2,e)<=this.size+1}},{key:"check",value:function(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw FJ();var e=this.left.check();if(e!==this.right.check())throw FJ();return e+(this.isRed()?0:1)}}]),e}();o1.EMPTY=null,o1.RED=!0,o1.BLACK=!1,o1.EMPTY=new(function(){function e(){tp(this,e),this.size=0}return rp(e,[{key:"key",get:function(){throw FJ()}},{key:"value",get:function(){throw FJ()}},{key:"color",get:function(){throw FJ()}},{key:"left",get:function(){throw FJ()}},{key:"right",get:function(){throw FJ()}},{key:"copy",value:function(e,t,n,r,i){return this}},{key:"insert",value:function(e,t,n){return new o1(e,t)}},{key:"remove",value:function(e,t){return this}},{key:"isEmpty",value:function(){return!0}},{key:"inorderTraversal",value:function(e){return!1}},{key:"reverseTraversal",value:function(e){return!1}},{key:"minKey",value:function(){return null}},{key:"maxKey",value:function(){return null}},{key:"isRed",value:function(){return!1}},{key:"checkMaxDepth",value:function(){return!0}},{key:"check",value:function(){return 0}}]),e}());var s1=function(){function e(t){tp(this,e),this.comparator=t,this.data=new i1(this.comparator)}return rp(e,[{key:"has",value:function(e){return null!==this.data.get(e)}},{key:"first",value:function(){return this.data.minKey()}},{key:"last",value:function(){return this.data.maxKey()}},{key:"size",get:function(){return this.data.size}},{key:"indexOf",value:function(e){return this.data.indexOf(e)}},{key:"forEach",value:function(e){this.data.inorderTraversal(function(t,n){return e(t),!1})}},{key:"forEachInRange",value:function(e,t){for(var n=this.data.getIteratorFrom(e[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}},{key:"forEachWhile",value:function(e,t){var n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}},{key:"firstAfterOrEqual",value:function(e){var t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}},{key:"getIterator",value:function(){return new u1(this.data.getIterator())}},{key:"getIteratorFrom",value:function(e){return new u1(this.data.getIteratorFrom(e))}},{key:"add",value:function(e){return this.copy(this.data.remove(e).insert(e,!0))}},{key:"delete",value:function(e){return this.has(e)?this.copy(this.data.remove(e)):this}},{key:"isEmpty",value:function(){return this.data.isEmpty()}},{key:"unionWith",value:function(e){var t=this;return t.size<e.size&&(t=e,e=this),e.forEach(function(e){t=t.add(e)}),t}},{key:"isEqual",value:function(t){if(!(t instanceof e)||this.size!==t.size)return!1;for(var n=this.data.getIterator(),r=t.data.getIterator();n.hasNext();){var i=n.getNext().key,a=r.getNext().key;if(0!==this.comparator(i,a))return!1}return!0}},{key:"toArray",value:function(){var e=[];return this.forEach(function(t){e.push(t)}),e}},{key:"toString",value:function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"}},{key:"copy",value:function(t){var n=new e(this.comparator);return n.data=t,n}}]),e}(),u1=function(){function e(t){tp(this,e),this.iter=t}return rp(e,[{key:"getNext",value:function(){return this.iter.getNext().key}},{key:"hasNext",value:function(){return this.iter.hasNext()}}]),e}(),c1=new i1(CQ.comparator);function l1(){return c1}var h1=new i1(CQ.comparator);function f1(){return h1}var d1=new i1(CQ.comparator),v1=new s1(CQ.comparator);function p1(){for(var e=v1,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0,a=n;i<a.length;i++){var o=a[i];e=e.add(o)}return e}var g1=new s1(eQ);function y1(){return g1}var m1=function(){function e(t,n,r,i,a){tp(this,e),this.snapshotVersion=t,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=a}return rp(e,null,[{key:"createSynthesizedRemoteEventForCurrentChange",value:function(t,n){var r=new Map;return r.set(t,k1.createSynthesizedTargetChangeForCurrentChange(t,n)),new e(rQ.min(),r,y1(),l1(),p1())}}]),e}(),k1=function(){function e(t,n,r,i,a){tp(this,e),this.resumeToken=t,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=a}return rp(e,null,[{key:"createSynthesizedTargetChangeForCurrentChange",value:function(t,n){return new e(fQ.EMPTY_BYTE_STRING,n,p1(),p1(),p1())}}]),e}(),_1=rp(function e(t,n,r,i){tp(this,e),this.$=t,this.removedTargetIds=n,this.key=r,this.O=i}),w1=rp(function e(t,n){tp(this,e),this.targetId=t,this.M=n}),C1=rp(function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:fQ.EMPTY_BYTE_STRING,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;tp(this,e),this.state=t,this.targetIds=n,this.resumeToken=r,this.cause=i}),b1=function(){function e(){tp(this,e),this.F=0,this.L=P1(),this.B=fQ.EMPTY_BYTE_STRING,this.U=!1,this.q=!0}return rp(e,[{key:"current",get:function(){return this.U}},{key:"resumeToken",get:function(){return this.B}},{key:"K",get:function(){return 0!==this.F}},{key:"j",get:function(){return this.q}},{key:"W",value:function(e){e.approximateByteSize()>0&&(this.q=!0,this.B=e)}},{key:"G",value:function(){var e=p1(),t=p1(),n=p1();return this.L.forEach(function(r,i){switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:FJ()}}),new k1(this.B,this.U,e,t,n)}},{key:"H",value:function(){this.q=!1,this.L=P1()}},{key:"J",value:function(e,t){this.q=!0,this.L=this.L.insert(e,t)}},{key:"Y",value:function(e){this.q=!0,this.L=this.L.remove(e)}},{key:"X",value:function(){this.F+=1}},{key:"Z",value:function(){this.F-=1}},{key:"tt",value:function(){this.q=!0,this.U=!0}}]),e}(),E1=function(){function e(t){tp(this,e),this.et=t,this.nt=new Map,this.st=l1(),this.it=S1(),this.rt=new s1(eQ)}return rp(e,[{key:"ot",value:function(e){var t,n=Qv(e.$);try{for(n.s();!(t=n.n()).done;){var r=t.value;e.O&&e.O.isFoundDocument()?this.ct(r,e.O):this.at(r,e.key,e.O)}}catch(s){n.e(s)}finally{n.f()}var i,a=Qv(e.removedTargetIds);try{for(a.s();!(i=a.n()).done;){var o=i.value;this.at(o,e.key,e.O)}}catch(s){a.e(s)}finally{a.f()}}},{key:"ut",value:function(e){var t=this;this.forEachTarget(e,function(n){var r=t.ht(n);switch(e.state){case 0:t.lt(n)&&r.W(e.resumeToken);break;case 1:r.Z(),r.K||r.H(),r.W(e.resumeToken);break;case 2:r.Z(),r.K||t.removeTarget(n);break;case 3:t.lt(n)&&(r.tt(),r.W(e.resumeToken));break;case 4:t.lt(n)&&(t.ft(n),r.W(e.resumeToken));break;default:FJ()}})}},{key:"forEachTarget",value:function(e,t){var n=this;e.targetIds.length>0?e.targetIds.forEach(t):this.nt.forEach(function(e,r){n.lt(r)&&t(r)})}},{key:"dt",value:function(e){var t=e.targetId,n=e.M.count,r=this.wt(t);if(r){var i=r.target;if(qQ(i))if(0===n){var a=new CQ(i.path);this.at(t,a,VQ.newNoDocument(a,rQ.min()))}else BJ(1===n);else this._t(t)!==n&&(this.ft(t),this.rt=this.rt.add(t))}}},{key:"gt",value:function(e){var t=this,n=new Map;this.nt.forEach(function(r,i){var a=t.wt(i);if(a){if(r.current&&qQ(a.target)){var o=new CQ(a.target.path);null!==t.st.get(o)||t.yt(i,o)||t.at(i,o,VQ.newNoDocument(o,e))}r.j&&(n.set(i,r.G()),r.H())}});var r=p1();this.it.forEach(function(e,n){var i=!0;n.forEachWhile(function(e){var n=t.wt(e);return!n||2===n.purpose||(i=!1,!1)}),i&&(r=r.add(e))});var i=new m1(e,n,this.rt,this.st,r);return this.st=l1(),this.it=S1(),this.rt=new s1(eQ),i}},{key:"ct",value:function(e,t){if(this.lt(e)){var n=this.yt(e,t.key)?2:0;this.ht(e).J(t.key,n),this.st=this.st.insert(t.key,t),this.it=this.it.insert(t.key,this.Tt(t.key).add(e))}}},{key:"at",value:function(e,t,n){if(this.lt(e)){var r=this.ht(e);this.yt(e,t)?r.J(t,1):r.Y(t),this.it=this.it.insert(t,this.Tt(t).delete(e)),n&&(this.st=this.st.insert(t,n))}}},{key:"removeTarget",value:function(e){this.nt.delete(e)}},{key:"_t",value:function(e){var t=this.ht(e).G();return this.et.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}},{key:"X",value:function(e){this.ht(e).X()}},{key:"ht",value:function(e){var t=this.nt.get(e);return t||(t=new b1,this.nt.set(e,t)),t}},{key:"Tt",value:function(e){var t=this.it.get(e);return t||(t=new s1(eQ),this.it=this.it.insert(e,t)),t}},{key:"lt",value:function(e){var t=null!==this.wt(e);return t||NJ("WatchChangeAggregator","Detected inactive target",e),t}},{key:"wt",value:function(e){var t=this.nt.get(e);return t&&t.K?null:this.et.Et(e)}},{key:"ft",value:function(e){var t=this;this.nt.set(e,new b1),this.et.getRemoteKeysForTarget(e).forEach(function(n){t.at(e,n,null)})}},{key:"yt",value:function(e,t){return this.et.getRemoteKeysForTarget(e).has(t)}}]),e}();function S1(){return new i1(CQ.comparator)}function P1(){return new i1(CQ.comparator)}var O1={asc:"ASCENDING",desc:"DESCENDING"},T1={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},I1=rp(function e(t,n){tp(this,e),this.databaseId=t,this.C=n});function x1(e,t){return e.C?"".concat(new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z",""),".").concat(("000000000"+t.nanoseconds).slice(-9),"Z"):{seconds:""+t.seconds,nanos:t.nanoseconds}}function A1(e,t){return e.C?t.toBase64():t.toUint8Array()}function R1(e,t){return x1(e,t.toTimestamp())}function N1(e){return BJ(!!e),rQ.fromTimestamp((t=vQ(e),new nQ(t.seconds,t.nanos)));var t}function M1(e,t){return(n=e,new uQ(["projects",n.projectId,"databases",n.database])).child("documents").child(t).canonicalString();var n}function D1(e){var t=uQ.fromString(e);return BJ(t0(t)),t}function L1(e,t){return M1(e.databaseId,t.path)}function F1(e,t){var n=D1(t);if(n.get(1)!==e.databaseId.projectId)throw new zJ(UJ.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new zJ(UJ.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new CQ(U1(n))}function B1(e,t){return M1(e.databaseId,t)}function V1(e){return new uQ(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function U1(e){return BJ(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function z1(e,t,n){return{name:L1(e,t),fields:n.value.mapValue.fields}}function H1(e,t){return{documents:[B1(e,t.path)]}}function G1(e,t){var n={structuredQuery:{}},r=t.path;null!==t.collectionGroup?(n.parent=B1(e,r),n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(n.parent=B1(e,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);var i=function(e){if(0!==e.length){var t=e.map(function(e){return function(e){if("=="===e.op){if(MQ(e.value))return{unaryFilter:{field:K1(e.field),op:"IS_NAN"}};if(NQ(e.value))return{unaryFilter:{field:K1(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(MQ(e.value))return{unaryFilter:{field:K1(e.field),op:"IS_NOT_NAN"}};if(NQ(e.value))return{unaryFilter:{field:K1(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:K1(e.field),op:Y1(e.op),value:e.value}}}(e)});return 1===t.length?t[0]:{compositeFilter:{op:"AND",filters:t}}}}(t.filters);i&&(n.structuredQuery.where=i);var a=function(e){if(0!==e.length)return e.map(function(e){return{field:K1((t=e).field),direction:Z1(t.dir)};var t})}(t.orderBy);a&&(n.structuredQuery.orderBy=a);var o,s=(o=t.limit,e.C||_Q(o)?o:{value:o});return null!==s&&(n.structuredQuery.limit=s),t.startAt&&(n.structuredQuery.startAt=W1(t.startAt)),t.endAt&&(n.structuredQuery.endAt=W1(t.endAt)),n}function q1(e){var t=function(e){var t=D1(e);return 4===t.length?uQ.emptyPath():U1(t)}(e.parent),n=e.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){BJ(1===r);var a=n.from[0];a.allDescendants?i=a.collectionId:t=t.child(a.collectionId)}var o=[];n.where&&(o=$1(n.where));var s=[];n.orderBy&&(s=n.orderBy.map(function(e){return new nX(J1((t=e).field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction));var t}));var u=null;n.limit&&(u=function(e){var t;return _Q(t="object"==typeof e?e.value:e)?null:t}(n.limit));var c=null;n.startAt&&(c=j1(n.startAt));var l=null;return n.endAt&&(l=j1(n.endAt)),function(e,t,n,r,i,a,o,s){return new oX(e,t,n,r,i,"F",o,s)}(t,i,s,o,u,0,c,l)}function $1(e){return e?void 0!==e.unaryFilter?[X1(e)]:void 0!==e.fieldFilter?[Q1(e)]:void 0!==e.compositeFilter?e.compositeFilter.filters.map(function(e){return $1(e)}).reduce(function(e,t){return e.concat(t)}):FJ():[]}function W1(e){return{before:e.before,values:e.position}}function j1(e){return new eX(e.values||[],!!e.before)}function Z1(e){return O1[e]}function Y1(e){return T1[e]}function K1(e){return{fieldPath:e.canonicalString()}}function J1(e){return lQ.fromServerFormat(e.fieldPath)}function Q1(e){return $Q.create(J1(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return FJ()}}(e.fieldFilter.op),e.fieldFilter.value)}function X1(e){switch(e.unaryFilter.op){case"IS_NAN":var t=J1(e.unaryFilter.field);return $Q.create(t,"==",{doubleValue:NaN});case"IS_NULL":var n=J1(e.unaryFilter.field);return $Q.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=J1(e.unaryFilter.field);return $Q.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=J1(e.unaryFilter.field);return $Q.create(i,"!=",{nullValue:"NULL_VALUE"});default:return FJ()}}function e0(e){var t=[];return e.fields.forEach(function(e){return t.push(e.canonicalString())}),{fieldPaths:t}}function t0(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}function n0(e){for(var t="",n=0;n<e.length;n++)t.length>0&&(t=i0(t)),t=r0(e.get(n),t);return i0(t)}function r0(e,t){for(var n=t,r=e.length,i=0;i<r;i++){var a=e.charAt(i);switch(a){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=a}}return n}function i0(e){return e+"\x01\x01"}var a0=rp(function e(t,n,r){tp(this,e),this.ownerId=t,this.allowTabSynchronization=n,this.leaseTimestampMs=r});a0.store="owner",a0.key="owner";var o0=rp(function e(t,n,r){tp(this,e),this.userId=t,this.lastAcknowledgedBatchId=n,this.lastStreamToken=r});o0.store="mutationQueues",o0.keyPath="userId";var s0=rp(function e(t,n,r,i,a){tp(this,e),this.userId=t,this.batchId=n,this.localWriteTimeMs=r,this.baseMutations=i,this.mutations=a});s0.store="mutations",s0.keyPath="batchId",s0.userMutationsIndex="userMutationsIndex",s0.userMutationsKeyPath=["userId","batchId"];var u0=function(){function e(){tp(this,e)}return rp(e,null,[{key:"prefixForUser",value:function(e){return[e]}},{key:"prefixForPath",value:function(e,t){return[e,n0(t)]}},{key:"key",value:function(e,t,n){return[e,n0(t),n]}}]),e}();u0.store="documentMutations",u0.PLACEHOLDER=new u0;var c0=rp(function e(t,n,r,i,a,o){tp(this,e),this.unknownDocument=t,this.noDocument=n,this.document=r,this.hasCommittedMutations=i,this.readTime=a,this.parentPath=o});c0.store="remoteDocuments",c0.readTimeIndex="readTimeIndex",c0.readTimeIndexPath="readTime",c0.collectionReadTimeIndex="collectionReadTimeIndex",c0.collectionReadTimeIndexPath=["parentPath","readTime"];var l0=rp(function e(t){tp(this,e),this.byteSize=t});l0.store="remoteDocumentGlobal",l0.key="remoteDocumentGlobalKey";var h0=rp(function e(t,n,r,i,a,o,s){tp(this,e),this.targetId=t,this.canonicalId=n,this.readTime=r,this.resumeToken=i,this.lastListenSequenceNumber=a,this.lastLimboFreeSnapshotVersion=o,this.query=s});h0.store="targets",h0.keyPath="targetId",h0.queryTargetsIndexName="queryTargetsIndex",h0.queryTargetsKeyPath=["canonicalId","targetId"];var f0=rp(function e(t,n,r){tp(this,e),this.targetId=t,this.path=n,this.sequenceNumber=r});f0.store="targetDocuments",f0.keyPath=["targetId","path"],f0.documentTargetsIndex="documentTargetsIndex",f0.documentTargetsKeyPath=["path","targetId"];var d0=rp(function e(t,n,r,i){tp(this,e),this.highestTargetId=t,this.highestListenSequenceNumber=n,this.lastRemoteSnapshotVersion=r,this.targetCount=i});d0.key="targetGlobalKey",d0.store="targetGlobal";var v0=rp(function e(t,n){tp(this,e),this.collectionId=t,this.parent=n});v0.store="collectionParents",v0.keyPath=["collectionId","parent"];var p0=rp(function e(t,n,r,i){tp(this,e),this.clientId=t,this.updateTimeMs=n,this.networkEnabled=r,this.inForeground=i});p0.store="clientMetadata",p0.keyPath="clientId";var g0=rp(function e(t,n,r){tp(this,e),this.bundleId=t,this.createTime=n,this.version=r});g0.store="bundles",g0.keyPath="bundleId";var y0=rp(function e(t,n,r){tp(this,e),this.name=t,this.readTime=n,this.bundledQuery=r});y0.store="namedQueries",y0.keyPath="name";var m0="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",k0=function(){function e(t){var n=this;tp(this,e),this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(function(e){n.isDone=!0,n.result=e,n.nextCallback&&n.nextCallback(e)},function(e){n.isDone=!0,n.error=e,n.catchCallback&&n.catchCallback(e)})}return rp(e,[{key:"catch",value:function(e){return this.next(void 0,e)}},{key:"next",value:function(t,n){var r=this;return this.callbackAttached&&FJ(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(t,this.result):new e(function(e,i){r.nextCallback=function(n){r.wrapSuccess(t,n).next(e,i)},r.catchCallback=function(t){r.wrapFailure(n,t).next(e,i)}})}},{key:"toPromise",value:function(){var e=this;return new Promise(function(t,n){e.next(t,n)})}},{key:"wrapUserFunction",value:function(t){try{var n=t();return n instanceof e?n:e.resolve(n)}catch(n){return e.reject(n)}}},{key:"wrapSuccess",value:function(t,n){return t?this.wrapUserFunction(function(){return t(n)}):e.resolve(n)}},{key:"wrapFailure",value:function(t,n){return t?this.wrapUserFunction(function(){return t(n)}):e.reject(n)}}],[{key:"resolve",value:function(t){return new e(function(e,n){e(t)})}},{key:"reject",value:function(t){return new e(function(e,n){n(t)})}},{key:"waitFor",value:function(t){return new e(function(e,n){var r=0,i=0,a=!1;t.forEach(function(t){++r,t.next(function(){++i,a&&i===r&&e()},function(e){return n(e)})}),a=!0,i===r&&e()})}},{key:"or",value:function(t){var n,r=e.resolve(!1),i=Qv(t);try{var a=function(){var t=n.value;r=r.next(function(n){return n?e.resolve(n):t()})};for(i.s();!(n=i.n()).done;)a()}catch(o){i.e(o)}finally{i.f()}return r}},{key:"forEach",value:function(e,t){var n=this,r=[];return e.forEach(function(e,i){r.push(t.call(n,e,i))}),this.waitFor(r)}}]),e}();function _0(e){return"IndexedDbTransactionError"===e.name}var w0=function(){function e(t,n,r,i){tp(this,e),this.batchId=t,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}return rp(e,[{key:"applyToRemoteDocument",value:function(e,t){for(var n=t.mutationResults,r=0;r<this.mutations.length;r++){var i=this.mutations[r];i.key.isEqual(e.key)&&zX(i,e,n[r])}}},{key:"applyToLocalView",value:function(e){var t,n=Qv(this.baseMutations);try{for(n.s();!(t=n.n()).done;){var r=t.value;r.key.isEqual(e.key)&&HX(r,e,this.localWriteTime)}}catch(s){n.e(s)}finally{n.f()}var i,a=Qv(this.mutations);try{for(a.s();!(i=a.n()).done;){var o=i.value;o.key.isEqual(e.key)&&HX(o,e,this.localWriteTime)}}catch(s){a.e(s)}finally{a.f()}}},{key:"applyToLocalDocumentSet",value:function(e){var t=this;this.mutations.forEach(function(n){var r=e.get(n.key),i=r;t.applyToLocalView(i),r.isValidDocument()||i.convertToNoDocument(rQ.min())})}},{key:"keys",value:function(){return this.mutations.reduce(function(e,t){return e.add(t.key)},p1())}},{key:"isEqual",value:function(e){return this.batchId===e.batchId&&tQ(this.mutations,e.mutations,function(e,t){return qX(e,t)})&&tQ(this.baseMutations,e.baseMutations,function(e,t){return qX(e,t)})}}]),e}(),C0=function(){function e(t,n,r,i){tp(this,e),this.batch=t,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}return rp(e,null,[{key:"from",value:function(t,n,r){BJ(t.mutations.length===r.length);for(var i=d1,a=t.mutations,o=0;o<a.length;o++)i=i.insert(a[o].key,r[o].version);return new e(t,n,r,i)}}]),e}(),b0=function(){function e(t,n,r,i){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:rQ.min(),o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:rQ.min(),s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:fQ.EMPTY_BYTE_STRING;tp(this,e),this.target=t,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}return rp(e,[{key:"withSequenceNumber",value:function(t){return new e(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}},{key:"withResumeToken",value:function(t,n){return new e(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,t)}},{key:"withLastLimboFreeSnapshotVersion",value:function(t){return new e(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken)}}]),e}(),E0=rp(function e(t){tp(this,e),this.Gt=t});function S0(e){var t=q1({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?pX(t,t.limit,"L"):t}var P0=function(){function e(){tp(this,e),this.zt=new O0}return rp(e,[{key:"addToCollectionParentIndex",value:function(e,t){return this.zt.add(t),k0.resolve()}},{key:"getCollectionParents",value:function(e,t){return k0.resolve(this.zt.getEntries(t))}}]),e}(),O0=function(){function e(){tp(this,e),this.index={}}return rp(e,[{key:"add",value:function(e){var t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new s1(uQ.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}},{key:"has",value:function(e){var t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}},{key:"getEntries",value:function(e){return(this.index[e]||new s1(uQ.comparator)).toArray()}}]),e}(),T0=function(){function e(t,n,r){tp(this,e),this.cacheSizeCollectionThreshold=t,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}return rp(e,null,[{key:"withCacheSize",value:function(t){return new e(t,e.DEFAULT_COLLECTION_PERCENTILE,e.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}]),e}();T0.DEFAULT_COLLECTION_PERCENTILE=10,T0.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,T0.DEFAULT=new T0(41943040,T0.DEFAULT_COLLECTION_PERCENTILE,T0.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),T0.DISABLED=new T0(-1,0,0);var I0=function(){function e(t){tp(this,e),this.se=t}return rp(e,[{key:"next",value:function(){return this.se+=2,this.se}}],[{key:"ie",value:function(){return new e(0)}},{key:"re",value:function(){return new e(-1)}}]),e}();function x0(e){return A0.apply(this,arguments)}function A0(){return(A0=tB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.code===UJ.FAILED_PRECONDITION&&t.message===m0){e.next=2;break}throw t;case 2:NJ("LocalStore","Unexpectedly lost primary lease");case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}var R0=function(){function e(t,n){tp(this,e),this.mapKeyFn=t,this.equalsFn=n,this.inner={}}return rp(e,[{key:"get",value:function(e){var t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n){var r,i=Qv(n);try{for(i.s();!(r=i.n()).done;){var a=Lv(r.value,2),o=a[0],s=a[1];if(this.equalsFn(o,e))return s}}catch(u){i.e(u)}finally{i.f()}}}},{key:"has",value:function(e){return void 0!==this.get(e)}},{key:"set",value:function(e,t){var n=this.mapKeyFn(e),r=this.inner[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t])}else this.inner[n]=[[e,t]]}},{key:"delete",value:function(e){var t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),!0;return!1}},{key:"forEach",value:function(e){aQ(this.inner,function(t,n){var r,i=Qv(n);try{for(i.s();!(r=i.n()).done;){var a=Lv(r.value,2),o=a[0],s=a[1];e(o,s)}}catch(u){i.e(u)}finally{i.f()}})}},{key:"isEmpty",value:function(){return oQ(this.inner)}}]),e}(),N0=function(){function e(t,n,r){tp(this,e),this.Je=t,this.An=n,this.Jt=r}return rp(e,[{key:"Rn",value:function(e,t){var n=this;return this.An.getAllMutationBatchesAffectingDocumentKey(e,t).next(function(r){return n.bn(e,t,r)})}},{key:"bn",value:function(e,t,n){return this.Je.getEntry(e,t).next(function(e){var t,r=Qv(n);try{for(r.s();!(t=r.n()).done;){t.value.applyToLocalView(e)}}catch(i){r.e(i)}finally{r.f()}return e})}},{key:"Pn",value:function(e,t){e.forEach(function(e,n){var r,i=Qv(t);try{for(i.s();!(r=i.n()).done;){r.value.applyToLocalView(n)}}catch(a){i.e(a)}finally{i.f()}})}},{key:"vn",value:function(e,t){var n=this;return this.Je.getEntries(e,t).next(function(t){return n.Vn(e,t).next(function(){return t})})}},{key:"Vn",value:function(e,t){var n=this;return this.An.getAllMutationBatchesAffectingDocumentKeys(e,t).next(function(e){return n.Pn(t,e)})}},{key:"getDocumentsMatchingQuery",value:function(e,t,n){return CQ.isDocumentKey((r=t).path)&&null===r.collectionGroup&&0===r.filters.length?this.Sn(e,t.path):fX(t)?this.Dn(e,t,n):this.Cn(e,t,n);var r}},{key:"Sn",value:function(e,t){return this.Rn(e,new CQ(t)).next(function(e){var t=f1();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t})}},{key:"Dn",value:function(e,t,n){var r=this,i=t.collectionGroup,a=f1();return this.Jt.getCollectionParents(e,i).next(function(o){return k0.forEach(o,function(o){var s,u,c=(s=t,u=o.child(i),new oX(u,null,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt));return r.Cn(e,c,n).next(function(e){e.forEach(function(e,t){a=a.insert(e,t)})})}).next(function(){return a})})}},{key:"Cn",value:function(e,t,n){var r,i,a=this;return this.Je.getDocumentsMatchingQuery(e,t,n).next(function(n){return r=n,a.An.getAllMutationBatchesAffectingQuery(e,t)}).next(function(t){return i=t,a.Nn(e,i,r).next(function(e){r=e;var t,n=Qv(i);try{for(n.s();!(t=n.n()).done;){var a,o=t.value,s=Qv(o.mutations);try{for(s.s();!(a=s.n()).done;){var u=a.value,c=u.key,l=r.get(c);null==l&&(l=VQ.newInvalidDocument(c),r=r.insert(c,l)),HX(u,l,o.localWriteTime),l.isFoundDocument()||(r=r.remove(c))}}catch(h){s.e(h)}finally{s.f()}}}catch(h){n.e(h)}finally{n.f()}})}).next(function(){return r.forEach(function(e,n){kX(t,n)||(r=r.remove(e))}),r})}},{key:"Nn",value:function(e,t,n){var r,i=p1(),a=Qv(t);try{for(a.s();!(r=a.n()).done;){var o,s=Qv(r.value.mutations);try{for(s.s();!(o=s.n()).done;){var u=o.value;u instanceof jX&&null===n.get(u.key)&&(i=i.add(u.key))}}catch(l){s.e(l)}finally{s.f()}}}catch(l){a.e(l)}finally{a.f()}var c=n;return this.Je.getEntries(e,i).next(function(e){return e.forEach(function(e,t){t.isFoundDocument()&&(c=c.insert(e,t))}),c})}}]),e}(),M0=function(){function e(t,n,r,i){tp(this,e),this.targetId=t,this.fromCache=n,this.kn=r,this.xn=i}return rp(e,null,[{key:"$n",value:function(t,n){var r,i=p1(),a=p1(),o=Qv(n.docChanges);try{for(o.s();!(r=o.n()).done;){var s=r.value;switch(s.type){case 0:i=i.add(s.doc.key);break;case 1:a=a.add(s.doc.key)}}}catch(u){o.e(u)}finally{o.f()}return new e(t,n.fromCache,i,a)}}]),e}(),D0=function(){function e(){tp(this,e)}return rp(e,[{key:"On",value:function(e){this.Mn=e}},{key:"getDocumentsMatchingQuery",value:function(e,t,n,r){var i,a=this;return 0===(i=t).filters.length&&null===i.limit&&null==i.startAt&&null==i.endAt&&(0===i.explicitOrderBy.length||1===i.explicitOrderBy.length&&i.explicitOrderBy[0].field.isKeyField())||n.isEqual(rQ.min())?this.Fn(e,t):this.Mn.vn(e,r).next(function(i){var o=a.Ln(t,i);return(uX(t)||cX(t))&&a.Bn(t.limitType,o,r,n)?a.Fn(e,t):(RJ()<=tV.DEBUG&&NJ("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),mX(t)),a.Mn.getDocumentsMatchingQuery(e,t,n).next(function(e){return o.forEach(function(t){e=e.insert(t.key,t)}),e}))})}},{key:"Ln",value:function(e,t){var n=new s1(_X(e));return t.forEach(function(t,r){kX(e,r)&&(n=n.add(r))}),n}},{key:"Bn",value:function(e,t,n,r){if(n.size!==t.size)return!0;var i="F"===e?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}},{key:"Fn",value:function(e,t){return RJ()<=tV.DEBUG&&NJ("QueryEngine","Using full collection scan to execute query:",mX(t)),this.Mn.getDocumentsMatchingQuery(e,t,rQ.min())}}]),e}(),L0=function(){function e(t,n,r,i){tp(this,e),this.persistence=t,this.Un=n,this.k=i,this.qn=new i1(eQ),this.Kn=new R0(function(e){return HQ(e)},GQ),this.jn=rQ.min(),this.An=t.getMutationQueue(r),this.Qn=t.getRemoteDocumentCache(),this.He=t.getTargetCache(),this.Wn=new N0(this.Qn,this.An,this.persistence.getIndexManager()),this.Ye=t.getBundleCache(),this.Un.On(this.Wn)}return rp(e,[{key:"collectGarbage",value:function(e){var t=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(n){return e.collect(n,t.qn)})}}]),e}();function F0(e,t){return B0.apply(this,arguments)}function B0(){return(B0=tB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=VJ(t),i=r.An,a=r.Wn,e.next=4,r.persistence.runTransaction("Handle user change","readonly",function(e){var t;return r.An.getAllMutationBatches(e).next(function(o){return t=o,i=r.persistence.getMutationQueue(n),a=new N0(r.Qn,i,r.persistence.getIndexManager()),i.getAllMutationBatches(e)}).next(function(n){var r,i=[],o=[],s=p1(),u=Qv(t);try{for(u.s();!(r=u.n()).done;){var c=r.value;i.push(c.batchId);var l,h=Qv(c.mutations);try{for(h.s();!(l=h.n()).done;){var f=l.value;s=s.add(f.key)}}catch(k){h.e(k)}finally{h.f()}}}catch(k){u.e(k)}finally{u.f()}var d,v=Qv(n);try{for(v.s();!(d=v.n()).done;){var p=d.value;o.push(p.batchId);var g,y=Qv(p.mutations);try{for(y.s();!(g=y.n()).done;){var m=g.value;s=s.add(m.key)}}catch(k){y.e(k)}finally{y.f()}}}catch(k){v.e(k)}finally{v.f()}return a.vn(e,s).next(function(e){return{Gn:e,removedBatchIds:i,addedBatchIds:o}})})});case 4:return o=e.sent,e.abrupt("return",(r.An=i,r.Wn=a,r.Un.On(r.Wn),o));case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}function V0(e,t){var n=VJ(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(e){var r,i,a,o,s,u,c,l=t.batch.keys(),h=n.Qn.newChangeBuffer({trackRemovals:!0});return(r=n,i=e,a=t,o=h,s=a.batch,u=s.keys(),c=k0.resolve(),u.forEach(function(e){c=c.next(function(){return o.getEntry(i,e)}).next(function(t){var n=a.docVersions.get(e);BJ(null!==n),t.version.compareTo(n)<0&&(s.applyToRemoteDocument(t,a),t.isValidDocument()&&o.addEntry(t,a.commitVersion))})}),c.next(function(){return r.An.removeMutationBatch(i,s)})).next(function(){return h.apply(e)}).next(function(){return n.An.performConsistencyCheck(e)}).next(function(){return n.Wn.vn(e,l)})})}function U0(e){var t=VJ(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",function(e){return t.He.getLastRemoteSnapshotVersion(e)})}function z0(e,t){var n=VJ(e),r=t.snapshotVersion,i=n.qn;return n.persistence.runTransaction("Apply remote event","readwrite-primary",function(e){var a=n.Qn.newChangeBuffer({trackRemovals:!0});i=n.qn;var o=[];t.targetChanges.forEach(function(a,s){var u=i.get(s);if(u){o.push(n.He.removeMatchingKeys(e,a.removedDocuments,s).next(function(){return n.He.addMatchingKeys(e,a.addedDocuments,s)}));var c,l,h,f=u.withSequenceNumber(e.currentSequenceNumber);t.targetMismatches.has(s)?f=f.withResumeToken(fQ.EMPTY_BYTE_STRING,rQ.min()).withLastLimboFreeSnapshotVersion(rQ.min()):a.resumeToken.approximateByteSize()>0&&(f=f.withResumeToken(a.resumeToken,r)),i=i.insert(s,f),l=f,h=a,(0===(c=u).resumeToken.approximateByteSize()||l.snapshotVersion.toMicroseconds()-c.snapshotVersion.toMicroseconds()>=3e8||h.addedDocuments.size+h.modifiedDocuments.size+h.removedDocuments.size>0)&&o.push(n.He.updateTargetData(e,f))}});var s=l1();if(t.documentUpdates.forEach(function(r,i){t.resolvedLimboDocuments.has(r)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))}),o.push(function(e,t,n,r,i){var a=p1();return n.forEach(function(e){return a=a.add(e)}),t.getEntries(e,a).next(function(e){var i=l1();return n.forEach(function(n,a){var o=e.get(n),s=r;a.isNoDocument()&&a.version.isEqual(rQ.min())?(t.removeEntry(n,s),i=i.insert(n,a)):!o.isValidDocument()||a.version.compareTo(o.version)>0||0===a.version.compareTo(o.version)&&o.hasPendingWrites?(t.addEntry(a,s),i=i.insert(n,a)):NJ("LocalStore","Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",a.version)}),i})}(e,a,t.documentUpdates,r).next(function(e){s=e})),!r.isEqual(rQ.min())){var u=n.He.getLastRemoteSnapshotVersion(e).next(function(t){return n.He.setTargetsMetadata(e,e.currentSequenceNumber,r)});o.push(u)}return k0.waitFor(o).next(function(){return a.apply(e)}).next(function(){return n.Wn.Vn(e,s)}).next(function(){return s})}).then(function(e){return n.qn=i,e})}function H0(e,t){var n=VJ(e);return n.persistence.runTransaction("Get next mutation batch","readonly",function(e){return void 0===t&&(t=-1),n.An.getNextMutationBatchAfterBatchId(e,t)})}function G0(e,t){var n=VJ(e);return n.persistence.runTransaction("Allocate target","readwrite",function(e){var r;return n.He.getTargetData(e,t).next(function(i){return i?(r=i,k0.resolve(r)):n.He.allocateTargetId(e).next(function(i){return r=new b0(t,i,0,e.currentSequenceNumber),n.He.addTargetData(e,r).next(function(){return r})})})}).then(function(e){var r=n.qn.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.qn=n.qn.insert(e.targetId,e),n.Kn.set(t,e.targetId)),e})}function q0(e,t,n){return $0.apply(this,arguments)}function $0(){return($0=tB(regeneratorRuntime.mark(function e(t,n,r){var i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=VJ(t),a=i.qn.get(n),o=r?"readwrite":"readwrite-primary",e.prev=1,e.t0=r,e.t0){e.next=6;break}return e.next=6,i.persistence.runTransaction("Release target",o,function(e){return i.persistence.referenceDelegate.removeTarget(e,a)});case 6:e.next=13;break;case 8:if(e.prev=8,e.t1=e.catch(1),_0(e.t1)){e.next=12;break}throw e.t1;case 12:NJ("LocalStore","Failed to update sequence numbers for target ".concat(n,": ").concat(e.t1));case 13:i.qn=i.qn.remove(n),i.Kn.delete(a.target);case 14:case"end":return e.stop()}},e,null,[[1,8]])}))).apply(this,arguments)}function W0(e,t,n){var r=VJ(e),i=rQ.min(),a=p1();return r.persistence.runTransaction("Execute query","readonly",function(e){return(o=r,s=e,u=vX(t),c=VJ(o),l=c.Kn.get(u),void 0!==l?k0.resolve(c.qn.get(l)):c.He.getTargetData(s,u)).next(function(t){if(t)return i=t.lastLimboFreeSnapshotVersion,r.He.getMatchingKeysForTargetId(e,t.targetId).next(function(e){a=e})}).next(function(){return r.Un.getDocumentsMatchingQuery(e,t,n?i:rQ.min(),n?a:p1())}).next(function(e){return{documents:e,zn:a}});var o,s,u,c,l})}var j0=function(){function e(t){tp(this,e),this.k=t,this.Xn=new Map,this.Zn=new Map}return rp(e,[{key:"getBundleMetadata",value:function(e,t){return k0.resolve(this.Xn.get(t))}},{key:"saveBundleMetadata",value:function(e,t){var n;return this.Xn.set(t.id,{id:(n=t).id,version:n.version,createTime:N1(n.createTime)}),k0.resolve()}},{key:"getNamedQuery",value:function(e,t){return k0.resolve(this.Zn.get(t))}},{key:"saveNamedQuery",value:function(e,t){return this.Zn.set(t.name,{name:(n=t).name,query:S0(n.bundledQuery),readTime:N1(n.readTime)}),k0.resolve();var n}}]),e}(),Z0=function(){function e(){tp(this,e),this.ts=new s1(Y0.es),this.ns=new s1(Y0.ss)}return rp(e,[{key:"isEmpty",value:function(){return this.ts.isEmpty()}},{key:"addReference",value:function(e,t){var n=new Y0(e,t);this.ts=this.ts.add(n),this.ns=this.ns.add(n)}},{key:"rs",value:function(e,t){var n=this;e.forEach(function(e){return n.addReference(e,t)})}},{key:"removeReference",value:function(e,t){this.os(new Y0(e,t))}},{key:"cs",value:function(e,t){var n=this;e.forEach(function(e){return n.removeReference(e,t)})}},{key:"us",value:function(e){var t=this,n=new CQ(new uQ([])),r=new Y0(n,e),i=new Y0(n,e+1),a=[];return this.ns.forEachInRange([r,i],function(e){t.os(e),a.push(e.key)}),a}},{key:"hs",value:function(){var e=this;this.ts.forEach(function(t){return e.os(t)})}},{key:"os",value:function(e){this.ts=this.ts.delete(e),this.ns=this.ns.delete(e)}},{key:"ls",value:function(e){var t=new CQ(new uQ([])),n=new Y0(t,e),r=new Y0(t,e+1),i=p1();return this.ns.forEachInRange([n,r],function(e){i=i.add(e.key)}),i}},{key:"containsKey",value:function(e){var t=new Y0(e,0),n=this.ts.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}]),e}(),Y0=function(){function e(t,n){tp(this,e),this.key=t,this.fs=n}return rp(e,null,[{key:"es",value:function(e,t){return CQ.comparator(e.key,t.key)||eQ(e.fs,t.fs)}},{key:"ss",value:function(e,t){return eQ(e.fs,t.fs)||CQ.comparator(e.key,t.key)}}]),e}(),K0=function(){function e(t,n){tp(this,e),this.Jt=t,this.referenceDelegate=n,this.An=[],this.ds=1,this.ws=new s1(Y0.es)}return rp(e,[{key:"checkEmpty",value:function(e){return k0.resolve(0===this.An.length)}},{key:"addMutationBatch",value:function(e,t,n,r){var i=this.ds;this.ds++;var a=new w0(i,t,n,r);this.An.push(a);var o,s=Qv(r);try{for(s.s();!(o=s.n()).done;){var u=o.value;this.ws=this.ws.add(new Y0(u.key,i)),this.Jt.addToCollectionParentIndex(e,u.key.path.popLast())}}catch(c){s.e(c)}finally{s.f()}return k0.resolve(a)}},{key:"lookupMutationBatch",value:function(e,t){return k0.resolve(this._s(t))}},{key:"getNextMutationBatchAfterBatchId",value:function(e,t){var n=this.gs(t+1),r=n<0?0:n;return k0.resolve(this.An.length>r?this.An[r]:null)}},{key:"getHighestUnacknowledgedBatchId",value:function(){return k0.resolve(0===this.An.length?-1:this.ds-1)}},{key:"getAllMutationBatches",value:function(e){return k0.resolve(this.An.slice())}},{key:"getAllMutationBatchesAffectingDocumentKey",value:function(e,t){var n=this,r=new Y0(t,0),i=new Y0(t,Number.POSITIVE_INFINITY),a=[];return this.ws.forEachInRange([r,i],function(e){var t=n._s(e.fs);a.push(t)}),k0.resolve(a)}},{key:"getAllMutationBatchesAffectingDocumentKeys",value:function(e,t){var n=this,r=new s1(eQ);return t.forEach(function(e){var t=new Y0(e,0),i=new Y0(e,Number.POSITIVE_INFINITY);n.ws.forEachInRange([t,i],function(e){r=r.add(e.fs)})}),k0.resolve(this.ys(r))}},{key:"getAllMutationBatchesAffectingQuery",value:function(e,t){var n=t.path,r=n.length+1,i=n;CQ.isDocumentKey(i)||(i=i.child(""));var a=new Y0(new CQ(i),0),o=new s1(eQ);return this.ws.forEachWhile(function(e){var t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(o=o.add(e.fs)),!0)},a),k0.resolve(this.ys(o))}},{key:"ys",value:function(e){var t=this,n=[];return e.forEach(function(e){var r=t._s(e);null!==r&&n.push(r)}),n}},{key:"removeMutationBatch",value:function(e,t){var n=this;BJ(0===this.ps(t.batchId,"removed")),this.An.shift();var r=this.ws;return k0.forEach(t.mutations,function(i){var a=new Y0(i.key,t.batchId);return r=r.delete(a),n.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(function(){n.ws=r})}},{key:"ee",value:function(e){}},{key:"containsKey",value:function(e,t){var n=new Y0(t,0),r=this.ws.firstAfterOrEqual(n);return k0.resolve(t.isEqual(r&&r.key))}},{key:"performConsistencyCheck",value:function(e){return k0.resolve()}},{key:"ps",value:function(e,t){return this.gs(e)}},{key:"gs",value:function(e){return 0===this.An.length?0:e-this.An[0].batchId}},{key:"_s",value:function(e){var t=this.gs(e);return t<0||t>=this.An.length?null:this.An[t]}}]),e}(),J0=function(){function e(t,n){tp(this,e),this.Jt=t,this.Ts=n,this.docs=new i1(CQ.comparator),this.size=0}return rp(e,[{key:"addEntry",value:function(e,t,n){var r=t.key,i=this.docs.get(r),a=i?i.size:0,o=this.Ts(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o,readTime:n}),this.size+=o-a,this.Jt.addToCollectionParentIndex(e,r.path.popLast())}},{key:"removeEntry",value:function(e){var t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}},{key:"getEntry",value:function(e,t){var n=this.docs.get(t);return k0.resolve(n?n.document.mutableCopy():VQ.newInvalidDocument(t))}},{key:"getEntries",value:function(e,t){var n=this,r=l1();return t.forEach(function(e){var t=n.docs.get(e);r=r.insert(e,t?t.document.mutableCopy():VQ.newInvalidDocument(e))}),k0.resolve(r)}},{key:"getDocumentsMatchingQuery",value:function(e,t,n){for(var r=l1(),i=new CQ(t.path.child("")),a=this.docs.getIteratorFrom(i);a.hasNext();){var o=a.getNext(),s=o.key,u=o.value,c=u.document,l=u.readTime;if(!t.path.isPrefixOf(s.path))break;l.compareTo(n)<=0||kX(t,c)&&(r=r.insert(c.key,c.mutableCopy()))}return k0.resolve(r)}},{key:"Es",value:function(e,t){return k0.forEach(this.docs,function(e){return t(e)})}},{key:"newChangeBuffer",value:function(e){return new Q0(this)}},{key:"getSize",value:function(e){return k0.resolve(this.size)}}]),e}(),Q0=function(e){Gv(n,e);var t=$v(n);function n(e){var r;return tp(this,n),(r=t.call(this)).De=e,r}return rp(n,[{key:"applyChanges",value:function(e){var t=this,n=[];return this.changes.forEach(function(r,i){i.document.isValidDocument()?n.push(t.De.addEntry(e,i.document,t.getReadTime(r))):t.De.removeEntry(r)}),k0.waitFor(n)}},{key:"getFromCache",value:function(e,t){return this.De.getEntry(e,t)}},{key:"getAllFromCache",value:function(e,t){return this.De.getEntries(e,t)}}]),n}(function(){function e(){tp(this,e),this.changes=new R0(function(e){return e.toString()},function(e,t){return e.isEqual(t)}),this.changesApplied=!1}return rp(e,[{key:"getReadTime",value:function(e){var t=this.changes.get(e);return t?t.readTime:rQ.min()}},{key:"addEntry",value:function(e,t){this.assertNotApplied(),this.changes.set(e.key,{document:e,readTime:t})}},{key:"removeEntry",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.assertNotApplied(),this.changes.set(e,{document:VQ.newInvalidDocument(e),readTime:t})}},{key:"getEntry",value:function(e,t){this.assertNotApplied();var n=this.changes.get(t);return void 0!==n?k0.resolve(n.document):this.getFromCache(e,t)}},{key:"getEntries",value:function(e,t){return this.getAllFromCache(e,t)}},{key:"apply",value:function(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}},{key:"assertNotApplied",value:function(){}}]),e}()),X0=function(){function e(t){tp(this,e),this.persistence=t,this.Is=new R0(function(e){return HQ(e)},GQ),this.lastRemoteSnapshotVersion=rQ.min(),this.highestTargetId=0,this.As=0,this.Rs=new Z0,this.targetCount=0,this.bs=I0.ie()}return rp(e,[{key:"forEachTarget",value:function(e,t){return this.Is.forEach(function(e,n){return t(n)}),k0.resolve()}},{key:"getLastRemoteSnapshotVersion",value:function(e){return k0.resolve(this.lastRemoteSnapshotVersion)}},{key:"getHighestSequenceNumber",value:function(e){return k0.resolve(this.As)}},{key:"allocateTargetId",value:function(e){return this.highestTargetId=this.bs.next(),k0.resolve(this.highestTargetId)}},{key:"setTargetsMetadata",value:function(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.As&&(this.As=t),k0.resolve()}},{key:"ae",value:function(e){this.Is.set(e.target,e);var t=e.targetId;t>this.highestTargetId&&(this.bs=new I0(t),this.highestTargetId=t),e.sequenceNumber>this.As&&(this.As=e.sequenceNumber)}},{key:"addTargetData",value:function(e,t){return this.ae(t),this.targetCount+=1,k0.resolve()}},{key:"updateTargetData",value:function(e,t){return this.ae(t),k0.resolve()}},{key:"removeTargetData",value:function(e,t){return this.Is.delete(t.target),this.Rs.us(t.targetId),this.targetCount-=1,k0.resolve()}},{key:"removeTargets",value:function(e,t,n){var r=this,i=0,a=[];return this.Is.forEach(function(o,s){s.sequenceNumber<=t&&null===n.get(s.targetId)&&(r.Is.delete(o),a.push(r.removeMatchingKeysForTargetId(e,s.targetId)),i++)}),k0.waitFor(a).next(function(){return i})}},{key:"getTargetCount",value:function(e){return k0.resolve(this.targetCount)}},{key:"getTargetData",value:function(e,t){var n=this.Is.get(t)||null;return k0.resolve(n)}},{key:"addMatchingKeys",value:function(e,t,n){return this.Rs.rs(t,n),k0.resolve()}},{key:"removeMatchingKeys",value:function(e,t,n){this.Rs.cs(t,n);var r=this.persistence.referenceDelegate,i=[];return r&&t.forEach(function(t){i.push(r.markPotentiallyOrphaned(e,t))}),k0.waitFor(i)}},{key:"removeMatchingKeysForTargetId",value:function(e,t){return this.Rs.us(t),k0.resolve()}},{key:"getMatchingKeysForTargetId",value:function(e,t){var n=this.Rs.ls(t);return k0.resolve(n)}},{key:"containsKey",value:function(e,t){return k0.resolve(this.Rs.containsKey(t))}}]),e}(),e2=function(){function e(t,n){var r=this;tp(this,e),this.Ps={},this.Be=new JJ(0),this.Ue=!1,this.Ue=!0,this.referenceDelegate=t(this),this.He=new X0(this),this.Jt=new P0,this.Je=new J0(this.Jt,function(e){return r.referenceDelegate.vs(e)}),this.k=new E0(n),this.Ye=new j0(this.k)}return rp(e,[{key:"start",value:function(){return Promise.resolve()}},{key:"shutdown",value:function(){return this.Ue=!1,Promise.resolve()}},{key:"started",get:function(){return this.Ue}},{key:"setDatabaseDeletedListener",value:function(){}},{key:"setNetworkEnabled",value:function(){}},{key:"getIndexManager",value:function(){return this.Jt}},{key:"getMutationQueue",value:function(e){var t=this.Ps[e.toKey()];return t||(t=new K0(this.Jt,this.referenceDelegate),this.Ps[e.toKey()]=t),t}},{key:"getTargetCache",value:function(){return this.He}},{key:"getRemoteDocumentCache",value:function(){return this.Je}},{key:"getBundleCache",value:function(){return this.Ye}},{key:"runTransaction",value:function(e,t,n){var r=this;NJ("MemoryPersistence","Starting transaction:",e);var i=new t2(this.Be.next());return this.referenceDelegate.Vs(),n(i).next(function(e){return r.referenceDelegate.Ss(i).next(function(){return e})}).toPromise().then(function(e){return i.raiseOnCommittedEvent(),e})}},{key:"Ds",value:function(e,t){return k0.or(Object.values(this.Ps).map(function(n){return function(){return n.containsKey(e,t)}}))}}]),e}(),t2=function(e){Gv(n,e);var t=$v(n);function n(e){var r;return tp(this,n),(r=t.call(this)).currentSequenceNumber=e,r}return rp(n)}(function(){function e(){tp(this,e),this.onCommittedListeners=[]}return rp(e,[{key:"addOnCommittedListener",value:function(e){this.onCommittedListeners.push(e)}},{key:"raiseOnCommittedEvent",value:function(){this.onCommittedListeners.forEach(function(e){return e()})}}]),e}()),n2=function(){function e(t){tp(this,e),this.persistence=t,this.Cs=new Z0,this.Ns=null}return rp(e,[{key:"xs",get:function(){if(this.Ns)return this.Ns;throw FJ()}},{key:"addReference",value:function(e,t,n){return this.Cs.addReference(n,t),this.xs.delete(n.toString()),k0.resolve()}},{key:"removeReference",value:function(e,t,n){return this.Cs.removeReference(n,t),this.xs.add(n.toString()),k0.resolve()}},{key:"markPotentiallyOrphaned",value:function(e,t){return this.xs.add(t.toString()),k0.resolve()}},{key:"removeTarget",value:function(e,t){var n=this;this.Cs.us(t.targetId).forEach(function(e){return n.xs.add(e.toString())});var r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(function(e){e.forEach(function(e){return n.xs.add(e.toString())})}).next(function(){return r.removeTargetData(e,t)})}},{key:"Vs",value:function(){this.Ns=new Set}},{key:"Ss",value:function(e){var t=this,n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return k0.forEach(this.xs,function(r){var i=CQ.fromPath(r);return t.$s(e,i).next(function(e){e||n.removeEntry(i)})}).next(function(){return t.Ns=null,n.apply(e)})}},{key:"updateLimboDocument",value:function(e,t){var n=this;return this.$s(e,t).next(function(e){e?n.xs.delete(t.toString()):n.xs.add(t.toString())})}},{key:"vs",value:function(e){return 0}},{key:"$s",value:function(e,t){var n=this;return k0.or([function(){return k0.resolve(n.Cs.containsKey(t))},function(){return n.persistence.getTargetCache().containsKey(e,t)},function(){return n.persistence.Ds(e,t)}])}}],[{key:"ks",value:function(t){return new e(t)}}]),e}(),r2=function(){function e(){tp(this,e),this.activeTargetIds=y1()}return rp(e,[{key:"Fs",value:function(e){this.activeTargetIds=this.activeTargetIds.add(e)}},{key:"Ls",value:function(e){this.activeTargetIds=this.activeTargetIds.delete(e)}},{key:"Ms",value:function(){var e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}]),e}(),i2=function(){function e(){tp(this,e),this.pi=new r2,this.Ti={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}return rp(e,[{key:"addPendingMutation",value:function(e){}},{key:"updateMutationState",value:function(e,t,n){}},{key:"addLocalQueryTarget",value:function(e){return this.pi.Fs(e),this.Ti[e]||"not-current"}},{key:"updateQueryState",value:function(e,t,n){this.Ti[e]=t}},{key:"removeLocalQueryTarget",value:function(e){this.pi.Ls(e)}},{key:"isLocalQueryTarget",value:function(e){return this.pi.activeTargetIds.has(e)}},{key:"clearQueryState",value:function(e){delete this.Ti[e]}},{key:"getAllActiveQueryTargets",value:function(){return this.pi.activeTargetIds}},{key:"isActiveQueryTarget",value:function(e){return this.pi.activeTargetIds.has(e)}},{key:"start",value:function(){return this.pi=new r2,Promise.resolve()}},{key:"handleUserChange",value:function(e,t,n){}},{key:"setOnlineState",value:function(e){}},{key:"shutdown",value:function(){}},{key:"writeSequenceNumber",value:function(e){}},{key:"notifyBundleLoaded",value:function(){}}]),e}(),a2=function(){function e(){tp(this,e)}return rp(e,[{key:"Ei",value:function(e){}},{key:"shutdown",value:function(){}}]),e}(),o2=function(){function e(){var t=this;tp(this,e),this.Ii=function(){return t.Ai()},this.Ri=function(){return t.bi()},this.Pi=[],this.vi()}return rp(e,[{key:"Ei",value:function(e){this.Pi.push(e)}},{key:"shutdown",value:function(){window.removeEventListener("online",this.Ii),window.removeEventListener("offline",this.Ri)}},{key:"vi",value:function(){window.addEventListener("online",this.Ii),window.addEventListener("offline",this.Ri)}},{key:"Ai",value:function(){NJ("ConnectivityMonitor","Network connectivity changed: AVAILABLE");var e,t=Qv(this.Pi);try{for(t.s();!(e=t.n()).done;){(0,e.value)(0)}}catch(n){t.e(n)}finally{t.f()}}},{key:"bi",value:function(){NJ("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");var e,t=Qv(this.Pi);try{for(t.s();!(e=t.n()).done;){(0,e.value)(1)}}catch(n){t.e(n)}finally{t.f()}}}],[{key:"Pt",value:function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}]),e}(),s2={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},u2=function(){function e(t){tp(this,e),this.Vi=t.Vi,this.Si=t.Si}return rp(e,[{key:"Di",value:function(e){this.Ci=e}},{key:"Ni",value:function(e){this.ki=e}},{key:"onMessage",value:function(e){this.xi=e}},{key:"close",value:function(){this.Si()}},{key:"send",value:function(e){this.Vi(e)}},{key:"$i",value:function(){this.Ci()}},{key:"Oi",value:function(e){this.ki(e)}},{key:"Mi",value:function(e){this.xi(e)}}]),e}(),c2=function(e){Gv(n,e);var t=$v(n);function n(e){var r;return tp(this,n),(r=t.call(this,e)).forceLongPolling=e.forceLongPolling,r.autoDetectLongPolling=e.autoDetectLongPolling,r.useFetchStreams=e.useFetchStreams,r}return rp(n,[{key:"Ki",value:function(e,t,n,r){return new Promise(function(i,a){var o=new OJ;o.listenOnce(CJ.COMPLETE,function(){try{switch(o.getLastErrorCode()){case wJ.NO_ERROR:var t=o.getResponseJson();NJ("Connection","XHR received:",JSON.stringify(t)),i(t);break;case wJ.TIMEOUT:NJ("Connection",'RPC "'+e+'" timed out'),a(new zJ(UJ.DEADLINE_EXCEEDED,"Request time out"));break;case wJ.HTTP_ERROR:var n=o.getStatus();if(NJ("Connection",'RPC "'+e+'" failed with status:',n,"response text:",o.getResponseText()),n>0){var r=o.getResponseJson().error;if(r&&r.status&&r.message){var s=(u=r.status,c=u.toLowerCase().replace(/_/g,"-"),Object.values(UJ).indexOf(c)>=0?c:UJ.UNKNOWN);a(new zJ(s,r.message))}else a(new zJ(UJ.UNKNOWN,"Server responded with status "+o.getStatus()))}else a(new zJ(UJ.UNAVAILABLE,"Connection failed."));break;default:FJ()}}finally{NJ("Connection",'RPC "'+e+'" completed.')}var u,c});var s=JSON.stringify(r);o.send(t,"POST",s,n,15)})}},{key:"Qi",value:function(e,t,n){var r=[this.Fi,"/","google.firestore.v1.Firestore","/",e,"/channel"],i=kJ(),a=_J(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/".concat(this.databaseId.projectId,"/databases/").concat(this.databaseId.database)},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(o.xmlHttpFactory=new SJ({})),this.qi(o.initMessageHeaders,t,n),wB()||bB()||_B().indexOf("Electron/")>=0||EB()||_B().indexOf("MSAppHost/")>=0||CB()||(o.httpHeadersOverwriteParam="$httpHeaders");var s=r.join("");NJ("Connection","Creating WebChannel: "+s,o);var u=i.createWebChannel(s,o),c=!1,l=!1,h=new u2({Vi:function(e){l?NJ("Connection","Not sending because WebChannel is closed:",e):(c||(NJ("Connection","Opening WebChannel transport."),u.open(),c=!0),NJ("Connection","WebChannel sending:",e),u.send(e))},Si:function(){return u.close()}}),f=function(e,t,n){e.listen(t,function(e){try{n(e)}catch(t){setTimeout(function(){throw t},0)}})};return f(u,PJ.EventType.OPEN,function(){l||NJ("Connection","WebChannel transport opened.")}),f(u,PJ.EventType.CLOSE,function(){l||(l=!0,NJ("Connection","WebChannel transport closed"),h.Oi())}),f(u,PJ.EventType.ERROR,function(e){l||(l=!0,DJ("Connection","WebChannel transport errored:",e),h.Oi(new zJ(UJ.UNAVAILABLE,"The operation could not be completed")))}),f(u,PJ.EventType.MESSAGE,function(e){var t;if(!l){var n=e.data[0];BJ(!!n);var r=n,i=r.error||(null===(t=r[0])||void 0===t?void 0:t.error);if(i){NJ("Connection","WebChannel received error:",i);var a=i.status,o=function(e){var t=JX[e];if(void 0!==t)return r1(t)}(a),s=i.message;void 0===o&&(o=UJ.INTERNAL,s="Unknown error status: "+a+" with message "+i.message),l=!0,h.Oi(new zJ(o,s)),u.close()}else NJ("Connection","WebChannel received:",n),h.Mi(n)}}),f(a,bJ.STAT_EVENT,function(e){e.stat===EJ.PROXY?NJ("Connection","Detected buffering proxy"):e.stat===EJ.NOPROXY&&NJ("Connection","Detected no buffering proxy")}),setTimeout(function(){h.$i()},0),h}}]),n}(function(){function e(t){tp(this,e),this.databaseInfo=t,this.databaseId=t.databaseId,this.Fi=(t.ssl?"https":"http")+"://"+t.host,this.Li="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}return rp(e,[{key:"Bi",value:function(e,t,n,r,i){var a=this.Ui(e,t);NJ("RestConnection","Sending: ",a,n);var o={};return this.qi(o,r,i),this.Ki(e,a,o,n).then(function(e){return NJ("RestConnection","Received: ",e),e},function(t){throw DJ("RestConnection","".concat(e," failed with error: "),t,"url: ",a,"request:",n),t})}},{key:"ji",value:function(e,t,n,r,i){return this.Bi(e,t,n,r,i)}},{key:"qi",value:function(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+xJ,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(function(t,n){return e[n]=t}),n&&n.headers.forEach(function(t,n){return e[n]=t})}},{key:"Ui",value:function(e,t){return"".concat(this.Fi,"/v1/").concat(t,":").concat(s2[e])}}]),e}());function l2(){return"undefined"!=typeof document?document:null}function h2(e){return new I1(e,!0)}var f2=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;tp(this,e),this.Me=t,this.timerId=n,this.Wi=r,this.Gi=i,this.zi=a,this.Hi=0,this.Ji=null,this.Yi=Date.now(),this.reset()}return rp(e,[{key:"reset",value:function(){this.Hi=0}},{key:"Xi",value:function(){this.Hi=this.zi}},{key:"Zi",value:function(e){var t=this;this.cancel();var n=Math.floor(this.Hi+this.tr()),r=Math.max(0,Date.now()-this.Yi),i=Math.max(0,n-r);i>0&&NJ("ExponentialBackoff","Backing off for ".concat(i," ms (base delay: ").concat(this.Hi," ms, delay with jitter: ").concat(n," ms, last attempt: ").concat(r," ms ago)")),this.Ji=this.Me.enqueueAfterDelay(this.timerId,i,function(){return t.Yi=Date.now(),e()}),this.Hi*=this.Gi,this.Hi<this.Wi&&(this.Hi=this.Wi),this.Hi>this.zi&&(this.Hi=this.zi)}},{key:"er",value:function(){null!==this.Ji&&(this.Ji.skipDelay(),this.Ji=null)}},{key:"cancel",value:function(){null!==this.Ji&&(this.Ji.cancel(),this.Ji=null)}},{key:"tr",value:function(){return(Math.random()-.5)*this.Hi}}]),e}(),d2=function(){function e(t,n,r,i,a,o,s,u){tp(this,e),this.Me=t,this.nr=r,this.sr=i,this.ir=a,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=s,this.listener=u,this.state=0,this.rr=0,this.cr=null,this.ar=null,this.stream=null,this.ur=new f2(t,n)}return rp(e,[{key:"hr",value:function(){return 1===this.state||5===this.state||this.lr()}},{key:"lr",value:function(){return 2===this.state||3===this.state}},{key:"start",value:function(){4!==this.state?this.auth():this.dr()}},{key:"stop",value:function(){var e=this;return tB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=e.hr(),!t.t0){t.next=4;break}return t.next=4,e.close(0);case 4:case"end":return t.stop()}},t)}))()}},{key:"wr",value:function(){this.state=0,this.ur.reset()}},{key:"_r",value:function(){var e=this;this.lr()&&null===this.cr&&(this.cr=this.Me.enqueueAfterDelay(this.nr,6e4,function(){return e.mr()}))}},{key:"gr",value:function(e){this.yr(),this.stream.send(e)}},{key:"mr",value:function(){var e=this;return tB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.lr()){t.next=2;break}return t.abrupt("return",e.close(0));case 2:case"end":return t.stop()}},t)}))()}},{key:"yr",value:function(){this.cr&&(this.cr.cancel(),this.cr=null)}},{key:"pr",value:function(){this.ar&&(this.ar.cancel(),this.ar=null)}},{key:"close",value:function(e,t){var n=this;return tB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return n.yr(),n.pr(),n.ur.cancel(),n.rr++,4!==e?n.ur.reset():t&&t.code===UJ.RESOURCE_EXHAUSTED?(MJ(t.toString()),MJ("Using maximum backoff delay to prevent overloading the backend."),n.ur.Xi()):t&&t.code===UJ.UNAUTHENTICATED&&3!==n.state&&(n.authCredentialsProvider.invalidateToken(),n.appCheckCredentialsProvider.invalidateToken()),null!==n.stream&&(n.Tr(),n.stream.close(),n.stream=null),n.state=e,r.next=9,n.listener.Ni(t);case 9:case"end":return r.stop()}},r)}))()}},{key:"Tr",value:function(){}},{key:"auth",value:function(){var e=this;this.state=1;var t=this.Er(this.rr),n=this.rr;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(function(t){var r=Lv(t,2),i=r[0],a=r[1];e.rr===n&&e.Ir(i,a)},function(n){t(function(){var t=new zJ(UJ.UNKNOWN,"Fetching auth token failed: "+n.message);return e.Ar(t)})})}},{key:"Ir",value:function(e,t){var n=this,r=this.Er(this.rr);this.stream=this.Rr(e,t),this.stream.Di(function(){r(function(){return n.state=2,n.ar=n.Me.enqueueAfterDelay(n.sr,1e4,function(){return n.lr()&&(n.state=3),Promise.resolve()}),n.listener.Di()})}),this.stream.Ni(function(e){r(function(){return n.Ar(e)})}),this.stream.onMessage(function(e){r(function(){return n.onMessage(e)})})}},{key:"dr",value:function(){var e=this;this.state=5,this.ur.Zi(tB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.state=0,e.start();case 1:case"end":return t.stop()}},t)})))}},{key:"Ar",value:function(e){return NJ("PersistentStream","close with error: ".concat(e)),this.stream=null,this.close(4,e)}},{key:"Er",value:function(e){var t=this;return function(n){t.Me.enqueueAndForget(function(){return t.rr===e?n():(NJ("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}}}]),e}(),v2=function(e){Gv(n,e);var t=$v(n);function n(e,r,i,a,o,s){var u;return tp(this,n),(u=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,i,a,s)).k=o,u}return rp(n,[{key:"Rr",value:function(e,t){return this.ir.Qi("Listen",e,t)}},{key:"onMessage",value:function(e){this.ur.reset();var t=function(e,t){var n,r;if("targetChange"in t){var i="NO_CHANGE"===(r=t.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===r?1:"REMOVE"===r?2:"CURRENT"===r?3:"RESET"===r?4:FJ(),a=t.targetChange.targetIds||[],o=function(e,t){return e.C?(BJ(void 0===t||"string"==typeof t),fQ.fromBase64String(t||"")):(BJ(void 0===t||t instanceof Uint8Array),fQ.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),s=t.targetChange.cause,u=s&&function(e){var t=void 0===e.code?UJ.UNKNOWN:r1(e.code);return new zJ(t,e.message||"")}(s);n=new C1(i,a,o,u||null)}else if("documentChange"in t){var c=t.documentChange,l=F1(e,c.document.name),h=N1(c.document.updateTime),f=new FQ({mapValue:{fields:c.document.fields}}),d=VQ.newFoundDocument(l,h,f);n=new _1(c.targetIds||[],c.removedTargetIds||[],d.key,d)}else if("documentDelete"in t){var v=t.documentDelete,p=F1(e,v.document),g=v.readTime?N1(v.readTime):rQ.min(),y=VQ.newNoDocument(p,g);n=new _1([],v.removedTargetIds||[],y.key,y)}else if("documentRemove"in t){var m=t.documentRemove,k=F1(e,m.document);n=new _1([],m.removedTargetIds||[],k,null)}else{if(!("filter"in t))return FJ();var _=t.filter,w=new t1(_.count||0);n=new w1(_.targetId,w)}return n}(this.k,e),n=function(e){if(!("targetChange"in e))return rQ.min();var t=e.targetChange;return t.targetIds&&t.targetIds.length?rQ.min():t.readTime?N1(t.readTime):rQ.min()}(e);return this.listener.br(t,n)}},{key:"Pr",value:function(e){var t,n,r,i,a={};a.database=V1(this.k),a.addTarget=(t=this.k,i=(n=e).target,(r=qQ(i)?{documents:H1(t,i)}:{query:G1(t,i)}).targetId=n.targetId,n.resumeToken.approximateByteSize()>0?r.resumeToken=A1(t,n.resumeToken):n.snapshotVersion.compareTo(rQ.min())>0&&(r.readTime=x1(t,n.snapshotVersion.toTimestamp())),r);var o=function(e,t){var n=function(e,t){switch(t){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return FJ()}}(0,t.purpose);return null==n?null:{"goog-listen-tags":n}}(0,e);o&&(a.labels=o),this.gr(a)}},{key:"vr",value:function(e){var t={};t.database=V1(this.k),t.removeTarget=e,this.gr(t)}}]),n}(d2),p2=function(e){Gv(n,e);var t=$v(n);function n(e,r,i,a,o,s){var u;return tp(this,n),(u=t.call(this,e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,i,a,s)).k=o,u.Vr=!1,u}return rp(n,[{key:"Sr",get:function(){return this.Vr}},{key:"start",value:function(){this.Vr=!1,this.lastStreamToken=void 0,zv(Yv(n.prototype),"start",this).call(this)}},{key:"Tr",value:function(){this.Vr&&this.Dr([])}},{key:"Rr",value:function(e,t){return this.ir.Qi("Write",e,t)}},{key:"onMessage",value:function(e){if(BJ(!!e.streamToken),this.lastStreamToken=e.streamToken,this.Vr){this.ur.reset();var t=function(e,t){return e&&e.length>0?(BJ(void 0!==t),e.map(function(e){return function(e,t){var n=N1(e.updateTime?e.updateTime:t);return n.isEqual(rQ.min())&&(n=N1(t)),new FX(n,e.transformResults||[])}(e,t)})):[]}(e.writeResults,e.commitTime),n=N1(e.commitTime);return this.listener.Cr(n,t)}return BJ(!e.writeResults||0===e.writeResults.length),this.Vr=!0,this.listener.Nr()}},{key:"kr",value:function(){var e={};e.database=V1(this.k),this.gr(e)}},{key:"Dr",value:function(e){var t=this,n={streamToken:this.lastStreamToken,writes:e.map(function(e){return function(e,t){var n,r;if(t instanceof WX)n={update:z1(e,t.key,t.value)};else if(t instanceof XX)n={delete:L1(e,t.key)};else if(t instanceof jX)n={update:z1(e,t.key,t.data),updateMask:e0(t.fieldMask)};else{if(!(t instanceof e1))return FJ();n={verify:L1(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map(function(e){return function(e,t){var n=t.transform;if(n instanceof TX)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof IX)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof AX)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof NX)return{fieldPath:t.field.canonicalString(),increment:n.N};throw FJ()}(0,e)})),t.precondition.isNone||(n.currentDocument=void 0!==(r=t.precondition).updateTime?{updateTime:R1(e,r.updateTime)}:void 0!==r.exists?{exists:r.exists}:FJ()),n}(t.k,e)})};this.gr(n)}}]),n}(d2),g2=function(e){Gv(n,e);var t=$v(n);function n(e,r,i,a){var o;return tp(this,n),(o=t.call(this)).authCredentials=e,o.appCheckCredentials=r,o.ir=i,o.k=a,o.$r=!1,o}return rp(n,[{key:"Or",value:function(){if(this.$r)throw new zJ(UJ.FAILED_PRECONDITION,"The client has already been terminated.")}},{key:"Bi",value:function(e,t,n){var r=this;return this.Or(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(function(i){var a=Lv(i,2),o=a[0],s=a[1];return r.ir.Bi(e,t,n,o,s)}).catch(function(e){throw"FirebaseError"===e.name?(e.code===UJ.UNAUTHENTICATED&&(r.authCredentials.invalidateToken(),r.appCheckCredentials.invalidateToken()),e):new zJ(UJ.UNKNOWN,e.toString())})}},{key:"ji",value:function(e,t,n){var r=this;return this.Or(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(function(i){var a=Lv(i,2),o=a[0],s=a[1];return r.ir.ji(e,t,n,o,s)}).catch(function(e){throw"FirebaseError"===e.name?(e.code===UJ.UNAUTHENTICATED&&(r.authCredentials.invalidateToken(),r.appCheckCredentials.invalidateToken()),e):new zJ(UJ.UNKNOWN,e.toString())})}},{key:"terminate",value:function(){this.$r=!0}}]),n}(function(){return rp(function e(){tp(this,e)})}()),y2=function(){function e(t,n){tp(this,e),this.asyncQueue=t,this.onlineStateHandler=n,this.state="Unknown",this.Mr=0,this.Fr=null,this.Lr=!0}return rp(e,[{key:"Br",value:function(){var e=this;0===this.Mr&&(this.Ur("Unknown"),this.Fr=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,function(){return e.Fr=null,e.qr("Backend didn't respond within 10 seconds."),e.Ur("Offline"),Promise.resolve()}))}},{key:"Kr",value:function(e){"Online"===this.state?this.Ur("Unknown"):(this.Mr++,this.Mr>=1&&(this.jr(),this.qr("Connection failed 1 times. Most recent error: ".concat(e.toString())),this.Ur("Offline")))}},{key:"set",value:function(e){this.jr(),this.Mr=0,"Online"===e&&(this.Lr=!1),this.Ur(e)}},{key:"Ur",value:function(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}},{key:"qr",value:function(e){var t="Could not reach Cloud Firestore backend. ".concat(e,"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.");this.Lr?(MJ(t),this.Lr=!1):NJ("OnlineStateTracker",t)}},{key:"jr",value:function(){null!==this.Fr&&(this.Fr.cancel(),this.Fr=null)}}]),e}(),m2=rp(function e(t,n,r,i,a){tp(this,e);var o=this;this.localStore=t,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Qr=[],this.Wr=new Map,this.Gr=new Set,this.zr=[],this.Hr=a,this.Hr.Ei(function(e){r.enqueueAndForget(tB(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=I2(o),!e.t0){e.next=5;break}return NJ("RemoteStore","Restarting streams for network reachability change."),e.next=5,(t=tB(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(n=VJ(t)).Gr.add(4),e.next=4,w2(n);case 4:return n.Jr.set("Unknown"),n.Gr.delete(4),e.next=8,k2(n);case 8:case"end":return e.stop()}},e)})),function(e){return t.apply(this,arguments)})(o);case 5:case"end":return e.stop()}},e)})))}),this.Jr=new y2(r,i)});function k2(e){return _2.apply(this,arguments)}function _2(){return(_2=tB(regeneratorRuntime.mark(function e(t){var n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!I2(t)){e.next=18;break}n=Qv(t.zr),e.prev=2,n.s();case 4:if((r=n.n()).done){e.next=10;break}return i=r.value,e.next=8,i(!0);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),n.e(e.t0);case 15:return e.prev=15,n.f(),e.finish(15);case 18:case"end":return e.stop()}},e,null,[[2,12,15,18]])}))).apply(this,arguments)}function w2(e){return C2.apply(this,arguments)}function C2(){return(C2=tB(regeneratorRuntime.mark(function e(t){var n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=Qv(t.zr),e.prev=1,n.s();case 3:if((r=n.n()).done){e.next=9;break}return i=r.value,e.next=7,i(!1);case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),n.e(e.t0);case 14:return e.prev=14,n.f(),e.finish(14);case 17:case"end":return e.stop()}},e,null,[[1,11,14,17]])}))).apply(this,arguments)}function b2(e,t){var n=VJ(e);n.Wr.has(t.targetId)||(n.Wr.set(t.targetId,t),T2(n)?O2(n):r3(n).lr()&&S2(n,t))}function E2(e,t){var n=VJ(e),r=r3(n);n.Wr.delete(t),r.lr()&&P2(n,t),0===n.Wr.size&&(r.lr()?r._r():I2(n)&&n.Jr.set("Unknown"))}function S2(e,t){e.Yr.X(t.targetId),r3(e).Pr(t)}function P2(e,t){e.Yr.X(t),r3(e).vr(t)}function O2(e){e.Yr=new E1({getRemoteKeysForTarget:function(t){return e.remoteSyncer.getRemoteKeysForTarget(t)},Et:function(t){return e.Wr.get(t)||null}}),r3(e).start(),e.Jr.Br()}function T2(e){return I2(e)&&!r3(e).hr()&&e.Wr.size>0}function I2(e){return 0===VJ(e).Gr.size}function x2(e){e.Yr=void 0}function A2(e){return R2.apply(this,arguments)}function R2(){return(R2=tB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.Wr.forEach(function(e,n){S2(t,e)});case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function N2(e,t){return M2.apply(this,arguments)}function M2(){return(M2=tB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:x2(t),T2(t)?(t.Jr.Kr(n),O2(t)):t.Jr.set("Unknown");case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function D2(e,t,n){return L2.apply(this,arguments)}function L2(){return(L2=tB(regeneratorRuntime.mark(function e(t,n,r){var i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.Jr.set("Online"),!(n instanceof C1&&2===n.state&&n.cause)){e.next=13;break}return e.prev=1,e.next=4,(a=tB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=n.cause,i=Qv(n.targetIds),e.prev=2,i.s();case 4:if((a=i.n()).done){e.next=14;break}if(o=a.value,e.t0=t.Wr.has(o),!e.t0){e.next=12;break}return e.next=10,t.remoteSyncer.rejectListen(o,r);case 10:t.Wr.delete(o),t.Yr.removeTarget(o);case 12:e.next=4;break;case 14:e.next=19;break;case 16:e.prev=16,e.t1=e.catch(2),i.e(e.t1);case 19:return e.prev=19,i.f(),e.finish(19);case 22:case"end":return e.stop()}},e,null,[[2,16,19,22]])})),function(e,t){return a.apply(this,arguments)})(t,n);case 4:e.next=11;break;case 6:return e.prev=6,e.t0=e.catch(1),NJ("RemoteStore","Failed to remove targets %s: %s ",n.targetIds.join(","),e.t0),e.next=11,F2(t,e.t0);case 11:e.next=29;break;case 13:if(n instanceof _1?t.Yr.ot(n):n instanceof w1?t.Yr.dt(n):t.Yr.ut(n),r.isEqual(rQ.min())){e.next=29;break}return e.prev=14,e.next=17,U0(t.localStore);case 17:if(i=e.sent,e.t1=r.compareTo(i)>=0,!e.t1){e.next=22;break}return e.next=22,function(e,t){var n=e.Yr.gt(t);return n.targetChanges.forEach(function(n,r){if(n.resumeToken.approximateByteSize()>0){var i=e.Wr.get(r);i&&e.Wr.set(r,i.withResumeToken(n.resumeToken,t))}}),n.targetMismatches.forEach(function(t){var n=e.Wr.get(t);if(n){e.Wr.set(t,n.withResumeToken(fQ.EMPTY_BYTE_STRING,n.snapshotVersion)),P2(e,t);var r=new b0(n.target,t,1,n.sequenceNumber);S2(e,r)}}),e.remoteSyncer.applyRemoteEvent(n)}(t,r);case 22:e.next=29;break;case 24:return e.prev=24,e.t2=e.catch(14),NJ("RemoteStore","Failed to raise snapshot:",e.t2),e.next=29,F2(t,e.t2);case 29:case"end":return e.stop()}},e,null,[[1,6],[14,24]])}))).apply(this,arguments)}function F2(e,t,n){return B2.apply(this,arguments)}function B2(){return(B2=tB(regeneratorRuntime.mark(function e(t,n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(_0(n)){e.next=2;break}throw n;case 2:return t.Gr.add(1),e.next=5,w2(t);case 5:t.Jr.set("Offline"),r||(r=function(){return U0(t.localStore)}),t.asyncQueue.enqueueRetryable(tB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return NJ("RemoteStore","Retrying IndexedDB access"),e.next=3,r();case 3:return t.Gr.delete(1),e.next=6,k2(t);case 6:case"end":return e.stop()}},e)})));case 8:case"end":return e.stop()}},e)}))).apply(this,arguments)}function V2(e,t){return t().catch(function(n){return F2(e,n,t)})}function U2(e){return z2.apply(this,arguments)}function z2(){return(z2=tB(regeneratorRuntime.mark(function e(t){var n,r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=VJ(t),r=i3(n),i=n.Qr.length>0?n.Qr[n.Qr.length-1].batchId:-1;case 2:if(!H2(n)){e.next=19;break}return e.prev=3,e.next=6,H0(n.localStore,i);case 6:if(null!==(a=e.sent)){e.next=10;break}return 0===n.Qr.length&&r._r(),e.abrupt("break",19);case 10:i=a.batchId,G2(n,a),e.next=17;break;case 13:return e.prev=13,e.t0=e.catch(3),e.next=17,F2(n,e.t0);case 17:e.next=2;break;case 19:q2(n)&&$2(n);case 20:case"end":return e.stop()}},e,null,[[3,13]])}))).apply(this,arguments)}function H2(e){return I2(e)&&e.Qr.length<10}function G2(e,t){e.Qr.push(t);var n=i3(e);n.lr()&&n.Sr&&n.Dr(t.mutations)}function q2(e){return I2(e)&&!i3(e).hr()&&e.Qr.length>0}function $2(e){i3(e).start()}function W2(e){return j2.apply(this,arguments)}function j2(){return(j2=tB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:i3(t).kr();case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Z2(e){return Y2.apply(this,arguments)}function Y2(){return(Y2=tB(regeneratorRuntime.mark(function e(t){var n,r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=i3(t),r=Qv(t.Qr);try{for(r.s();!(i=r.n()).done;)a=i.value,n.Dr(a.mutations)}catch(o){r.e(o)}finally{r.f()}case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}function K2(e,t,n){return J2.apply(this,arguments)}function J2(){return(J2=tB(regeneratorRuntime.mark(function e(t,n,r){var i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.Qr.shift(),a=C0.from(i,n,r),e.next=3,V2(t,function(){return t.remoteSyncer.applySuccessfulWrite(a)});case 3:return e.next=5,U2(t);case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Q2(e,t){return X2.apply(this,arguments)}function X2(){return(X2=tB(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=n&&i3(t).Sr,!e.t0){e.next=4;break}return e.next=4,(r=tB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!n1(i=n.code)||i===UJ.ABORTED){e.next=7;break}return r=t.Qr.shift(),i3(t).wr(),e.next=5,V2(t,function(){return t.remoteSyncer.rejectFailedWrite(r.batchId,n)});case 5:return e.next=7,U2(t);case 7:case"end":return e.stop()}},e)})),function(e,t){return r.apply(this,arguments)})(t,n);case 4:q2(t)&&$2(t);case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}function e3(e,t){return t3.apply(this,arguments)}function t3(){return(t3=tB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(r=VJ(t)).asyncQueue.verifyOperationInProgress(),NJ("RemoteStore","RemoteStore received new credentials"),i=I2(r),r.Gr.add(3),e.next=6,w2(r);case 6:return i&&r.Jr.set("Unknown"),e.next=9,r.remoteSyncer.handleCredentialChange(n);case 9:return r.Gr.delete(3),e.next=12,k2(r);case 12:case"end":return e.stop()}},e)}))).apply(this,arguments)}function n3(){return(n3=tB(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=VJ(t),!n){e.next=7;break}return r.Gr.delete(2),e.next=5,k2(r);case 5:e.next=13;break;case 7:if(e.t0=n,e.t0){e.next=13;break}return r.Gr.add(2),e.next=12,w2(r);case 12:r.Jr.set("Unknown");case 13:case"end":return e.stop()}},e)}))).apply(this,arguments)}function r3(e){return e.Xr||(e.Xr=(t=e.datastore,n=e.asyncQueue,r={Di:A2.bind(null,e),Ni:N2.bind(null,e),br:D2.bind(null,e)},(i=VJ(t)).Or(),new v2(n,i.ir,i.authCredentials,i.appCheckCredentials,i.k,r)),e.zr.push(function(){var t=tB(regeneratorRuntime.mark(function t(n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=4;break}e.Xr.wr(),T2(e)?O2(e):e.Jr.set("Unknown"),t.next=7;break;case 4:return t.next=6,e.Xr.stop();case 6:x2(e);case 7:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}())),e.Xr;var t,n,r,i}function i3(e){return e.Zr||(e.Zr=(t=e.datastore,n=e.asyncQueue,r={Di:W2.bind(null,e),Ni:Q2.bind(null,e),Nr:Z2.bind(null,e),Cr:K2.bind(null,e)},(i=VJ(t)).Or(),new p2(n,i.ir,i.authCredentials,i.appCheckCredentials,i.k,r)),e.zr.push(function(){var t=tB(regeneratorRuntime.mark(function t(n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=6;break}return e.Zr.wr(),t.next=4,U2(e);case 4:t.next=9;break;case 6:return t.next=8,e.Zr.stop();case 8:e.Qr.length>0&&(NJ("RemoteStore","Stopping write stream with ".concat(e.Qr.length," pending writes")),e.Qr=[]);case 9:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}())),e.Zr;var t,n,r,i}var a3=function(){function e(t,n,r,i,a){tp(this,e),this.asyncQueue=t,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=a,this.deferred=new HJ,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(function(e){})}return rp(e,[{key:"start",value:function(e){var t=this;this.timerHandle=setTimeout(function(){return t.handleDelayElapsed()},e)}},{key:"skipDelay",value:function(){return this.handleDelayElapsed()}},{key:"cancel",value:function(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new zJ(UJ.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}},{key:"handleDelayElapsed",value:function(){var e=this;this.asyncQueue.enqueueAndForget(function(){return null!==e.timerHandle?(e.clearTimeout(),e.op().then(function(t){return e.deferred.resolve(t)})):Promise.resolve()})}},{key:"clearTimeout",value:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)})}],[{key:"createAndSchedule",value:function(t,n,r,i,a){var o=new e(t,n,Date.now()+r,i,a);return o.start(r),o}}]),e}();function o3(e,t){if(MJ("AsyncQueue","".concat(t,": ").concat(e)),_0(e))return new zJ(UJ.UNAVAILABLE,"".concat(t,": ").concat(e));throw e}var s3=function(){function e(t){tp(this,e),this.comparator=t?function(e,n){return t(e,n)||CQ.comparator(e.key,n.key)}:function(e,t){return CQ.comparator(e.key,t.key)},this.keyedMap=f1(),this.sortedSet=new i1(this.comparator)}return rp(e,[{key:"has",value:function(e){return null!=this.keyedMap.get(e)}},{key:"get",value:function(e){return this.keyedMap.get(e)}},{key:"first",value:function(){return this.sortedSet.minKey()}},{key:"last",value:function(){return this.sortedSet.maxKey()}},{key:"isEmpty",value:function(){return this.sortedSet.isEmpty()}},{key:"indexOf",value:function(e){var t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}},{key:"size",get:function(){return this.sortedSet.size}},{key:"forEach",value:function(e){this.sortedSet.inorderTraversal(function(t,n){return e(t),!1})}},{key:"add",value:function(e){var t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}},{key:"delete",value:function(e){var t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}},{key:"isEqual",value:function(t){if(!(t instanceof e)||this.size!==t.size)return!1;for(var n=this.sortedSet.getIterator(),r=t.sortedSet.getIterator();n.hasNext();){var i=n.getNext().key,a=r.getNext().key;if(!i.isEqual(a))return!1}return!0}},{key:"toString",value:function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}},{key:"copy",value:function(t,n){var r=new e;return r.comparator=this.comparator,r.keyedMap=t,r.sortedSet=n,r}}],[{key:"emptySet",value:function(t){return new e(t.comparator)}}]),e}(),u3=function(){function e(){tp(this,e),this.eo=new i1(CQ.comparator)}return rp(e,[{key:"track",value:function(e){var t=e.doc.key,n=this.eo.get(t);n?0!==e.type&&3===n.type?this.eo=this.eo.insert(t,e):3===e.type&&1!==n.type?this.eo=this.eo.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.eo=this.eo.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.eo=this.eo.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.eo=this.eo.remove(t):1===e.type&&2===n.type?this.eo=this.eo.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.eo=this.eo.insert(t,{type:2,doc:e.doc}):FJ():this.eo=this.eo.insert(t,e)}},{key:"no",value:function(){var e=[];return this.eo.inorderTraversal(function(t,n){e.push(n)}),e}}]),e}(),c3=function(){function e(t,n,r,i,a,o,s,u){tp(this,e),this.query=t,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=a,this.fromCache=o,this.syncStateChanged=s,this.excludesMetadataChanges=u}return rp(e,[{key:"hasPendingWrites",get:function(){return!this.mutatedKeys.isEmpty()}},{key:"isEqual",value:function(e){if(!(this.fromCache===e.fromCache&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&gX(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;var t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(var r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}],[{key:"fromInitialDocuments",value:function(t,n,r,i){var a=[];return n.forEach(function(e){a.push({type:0,doc:e})}),new e(t,n,s3.emptySet(n),a,r,i,!0,!1)}}]),e}(),l3=rp(function e(){tp(this,e),this.so=void 0,this.listeners=[]}),h3=rp(function e(){tp(this,e),this.queries=new R0(function(e){return yX(e)},gX),this.onlineState="Unknown",this.io=new Set});function f3(e,t){return d3.apply(this,arguments)}function d3(){return(d3=tB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=VJ(t),i=n.query,a=!1,(o=r.queries.get(i))||(a=!0,o=new l3),!a){e.next=13;break}return e.prev=3,e.next=6,r.onListen(i);case 6:o.so=e.sent,e.next=13;break;case 9:return e.prev=9,e.t0=e.catch(3),s=o3(e.t0,"Initialization of query '".concat(mX(n.query),"' failed")),e.abrupt("return",void n.onError(s));case 13:r.queries.set(i,o),o.listeners.push(n),n.ro(r.onlineState),o.so&&n.oo(o.so)&&m3(r);case 14:case"end":return e.stop()}},e,null,[[3,9]])}))).apply(this,arguments)}function v3(e,t){return p3.apply(this,arguments)}function p3(){return(p3=tB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=VJ(t),i=n.query,a=!1,(o=r.queries.get(i))&&(s=o.listeners.indexOf(n))>=0&&(o.listeners.splice(s,1),a=0===o.listeners.length),!a){e.next=6;break}return e.abrupt("return",(r.queries.delete(i),r.onUnlisten(i)));case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}function g3(e,t){var n,r=VJ(e),i=!1,a=Qv(t);try{for(a.s();!(n=a.n()).done;){var o=n.value,s=r.queries.get(o.query);if(s){var u,c=Qv(s.listeners);try{for(c.s();!(u=c.n()).done;){u.value.oo(o)&&(i=!0)}}catch(l){c.e(l)}finally{c.f()}s.so=o}}}catch(l){a.e(l)}finally{a.f()}i&&m3(r)}function y3(e,t,n){var r=VJ(e),i=r.queries.get(t);if(i){var a,o=Qv(i.listeners);try{for(o.s();!(a=o.n()).done;){a.value.onError(n)}}catch(s){o.e(s)}finally{o.f()}}r.queries.delete(t)}function m3(e){e.io.forEach(function(e){e.next()})}var k3=function(){function e(t,n,r){tp(this,e),this.query=t,this.co=n,this.ao=!1,this.uo=null,this.onlineState="Unknown",this.options=r||{}}return rp(e,[{key:"oo",value:function(e){if(!this.options.includeMetadataChanges){var t,n=[],r=Qv(e.docChanges);try{for(r.s();!(t=r.n()).done;){var i=t.value;3!==i.type&&n.push(i)}}catch(o){r.e(o)}finally{r.f()}e=new c3(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0)}var a=!1;return this.ao?this.ho(e)&&(this.co.next(e),a=!0):this.lo(e,this.onlineState)&&(this.fo(e),a=!0),this.uo=e,a}},{key:"onError",value:function(e){this.co.error(e)}},{key:"ro",value:function(e){this.onlineState=e;var t=!1;return this.uo&&!this.ao&&this.lo(this.uo,e)&&(this.fo(this.uo),t=!0),t}},{key:"lo",value:function(e,t){return!e.fromCache||!(this.options.wo&&"Offline"!==t||e.docs.isEmpty()&&"Offline"!==t)}},{key:"ho",value:function(e){return e.docChanges.length>0||!!(e.syncStateChanged||this.uo&&this.uo.hasPendingWrites!==e.hasPendingWrites)&&!0===this.options.includeMetadataChanges}},{key:"fo",value:function(e){e=c3.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache),this.ao=!0,this.co.next(e)}}]),e}(),_3=rp(function e(t){tp(this,e),this.key=t}),w3=rp(function e(t){tp(this,e),this.key=t}),C3=function(){function e(t,n){tp(this,e),this.query=t,this.To=n,this.Eo=null,this.current=!1,this.Io=p1(),this.mutatedKeys=p1(),this.Ao=_X(t),this.Ro=new s3(this.Ao)}return rp(e,[{key:"bo",get:function(){return this.To}},{key:"Po",value:function(e,t){var n=this,r=t?t.vo:new u3,i=t?t.Ro:this.Ro,a=t?t.mutatedKeys:this.mutatedKeys,o=i,s=!1,u=uX(this.query)&&i.size===this.query.limit?i.last():null,c=cX(this.query)&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal(function(e,t){var l=i.get(e),h=kX(n.query,t)?t:null,f=!!l&&n.mutatedKeys.has(l.key),d=!!h&&(h.hasLocalMutations||n.mutatedKeys.has(h.key)&&h.hasCommittedMutations),v=!1;l&&h?l.data.isEqual(h.data)?f!==d&&(r.track({type:3,doc:h}),v=!0):n.Vo(l,h)||(r.track({type:2,doc:h}),v=!0,(u&&n.Ao(h,u)>0||c&&n.Ao(h,c)<0)&&(s=!0)):!l&&h?(r.track({type:0,doc:h}),v=!0):l&&!h&&(r.track({type:1,doc:l}),v=!0,(u||c)&&(s=!0)),v&&(h?(o=o.add(h),a=d?a.add(e):a.delete(e)):(o=o.delete(e),a=a.delete(e)))}),uX(this.query)||cX(this.query))for(;o.size>this.query.limit;){var l=uX(this.query)?o.last():o.first();o=o.delete(l.key),a=a.delete(l.key),r.track({type:1,doc:l})}return{Ro:o,vo:r,Bn:s,mutatedKeys:a}}},{key:"Vo",value:function(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}},{key:"applyChanges",value:function(e,t,n){var r=this,i=this.Ro;this.Ro=e.Ro,this.mutatedKeys=e.mutatedKeys;var a=e.vo.no();a.sort(function(e,t){return n=e.type,i=t.type,(a=function(e){switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return FJ()}})(n)-a(i)||r.Ao(e.doc,t.doc);var n,i,a}),this.So(n);var o=t?this.Do():[],s=0===this.Io.size&&this.current?1:0,u=s!==this.Eo;return this.Eo=s,0!==a.length||u?{snapshot:new c3(this.query,e.Ro,i,a,e.mutatedKeys,0===s,u,!1),Co:o}:{Co:o}}},{key:"ro",value:function(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Ro:this.Ro,vo:new u3,mutatedKeys:this.mutatedKeys,Bn:!1},!1)):{Co:[]}}},{key:"No",value:function(e){return!this.To.has(e)&&!!this.Ro.has(e)&&!this.Ro.get(e).hasLocalMutations}},{key:"So",value:function(e){var t=this;e&&(e.addedDocuments.forEach(function(e){return t.To=t.To.add(e)}),e.modifiedDocuments.forEach(function(e){}),e.removedDocuments.forEach(function(e){return t.To=t.To.delete(e)}),this.current=e.current)}},{key:"Do",value:function(){var e=this;if(!this.current)return[];var t=this.Io;this.Io=p1(),this.Ro.forEach(function(t){e.No(t.key)&&(e.Io=e.Io.add(t.key))});var n=[];return t.forEach(function(t){e.Io.has(t)||n.push(new w3(t))}),this.Io.forEach(function(e){t.has(e)||n.push(new _3(e))}),n}},{key:"ko",value:function(e){this.To=e.zn,this.Io=p1();var t=this.Po(e.documents);return this.applyChanges(t,!0)}},{key:"xo",value:function(){return c3.fromInitialDocuments(this.query,this.Ro,this.mutatedKeys,0===this.Eo)}}]),e}(),b3=rp(function e(t,n,r){tp(this,e),this.query=t,this.targetId=n,this.view=r}),E3=rp(function e(t){tp(this,e),this.key=t,this.$o=!1}),S3=function(){function e(t,n,r,i,a,o){tp(this,e),this.localStore=t,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=a,this.maxConcurrentLimboResolutions=o,this.Oo={},this.Mo=new R0(function(e){return yX(e)},gX),this.Fo=new Map,this.Lo=new Set,this.Bo=new i1(CQ.comparator),this.Uo=new Map,this.qo=new Z0,this.Ko={},this.jo=new Map,this.Qo=I0.re(),this.onlineState="Unknown",this.Wo=void 0}return rp(e,[{key:"isPrimaryClient",get:function(){return!0===this.Wo}}]),e}();function P3(e,t){return O3.apply(this,arguments)}function O3(){return(O3=tB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=e4(t),!(o=r.Mo.get(n))){e.next=6;break}i=o.targetId,r.sharedClientState.addLocalQueryTarget(i),a=o.view.xo(),e.next=15;break;case 6:return e.next=8,G0(r.localStore,vX(n));case 8:return s=e.sent,u=r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.targetId,e.next=13,T3(r,n,i,"current"===u);case 13:a=e.sent,r.isPrimaryClient&&b2(r.remoteStore,s);case 15:return e.abrupt("return",a);case 16:case"end":return e.stop()}},e)}))).apply(this,arguments)}function T3(e,t,n,r){return I3.apply(this,arguments)}function I3(){return(I3=tB(regeneratorRuntime.mark(function e(t,n,r,i){var a,o,s,u,c,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.Go=function(e,n,r){return(i=tB(regeneratorRuntime.mark(function e(t,n,r,i){var a,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.view.Po(r),e.t0=a.Bn,!e.t0){e.next=6;break}return e.next=5,W0(t.localStore,n.query,!1).then(function(e){var t=e.documents;return n.view.Po(t,a)});case 5:a=e.sent;case 6:return o=i&&i.targetChanges.get(n.targetId),s=n.view.applyChanges(a,t.isPrimaryClient,o),e.abrupt("return",(W3(t,n.targetId,s.Co),s.snapshot));case 8:case"end":return e.stop()}},e)})),function(e,t,n,r){return i.apply(this,arguments)})(t,e,n,r);var i},e.next=3,W0(t.localStore,n,!0);case 3:return a=e.sent,o=new C3(n,a.zn),s=o.Po(a.documents),u=k1.createSynthesizedTargetChangeForCurrentChange(r,i&&"Offline"!==t.onlineState),c=o.applyChanges(s,t.isPrimaryClient,u),W3(t,r,c.Co),l=new b3(n,r,o),e.abrupt("return",(t.Mo.set(n,l),t.Fo.has(r)?t.Fo.get(r).push(n):t.Fo.set(r,[n]),c.snapshot));case 11:case"end":return e.stop()}},e)}))).apply(this,arguments)}function x3(e,t){return A3.apply(this,arguments)}function A3(){return(A3=tB(regeneratorRuntime.mark(function e(t,n){var r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=VJ(t),i=r.Mo.get(n),!((a=r.Fo.get(i.targetId)).length>1)){e.next=3;break}return e.abrupt("return",(r.Fo.set(i.targetId,a.filter(function(e){return!gX(e,n)})),void r.Mo.delete(n)));case 3:if(!r.isPrimaryClient){e.next=11;break}if(r.sharedClientState.removeLocalQueryTarget(i.targetId),e.t0=r.sharedClientState.isActiveQueryTarget(i.targetId),e.t0){e.next=9;break}return e.next=9,q0(r.localStore,i.targetId,!1).then(function(){r.sharedClientState.clearQueryState(i.targetId),E2(r.remoteStore,i.targetId),q3(r,i.targetId)}).catch(x0);case 9:e.next=14;break;case 11:return q3(r,i.targetId),e.next=14,q0(r.localStore,i.targetId,!0);case 14:case"end":return e.stop()}},e)}))).apply(this,arguments)}function R3(){return(R3=tB(regeneratorRuntime.mark(function e(t,n,r){var i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=t4(t),e.prev=1,e.next=4,function(e,t){var n,r=VJ(e),i=nQ.now(),a=t.reduce(function(e,t){return e.add(t.key)},p1());return r.persistence.runTransaction("Locally write mutations","readwrite",function(e){return r.Wn.vn(e,a).next(function(a){n=a;var o,s=[],u=Qv(t);try{for(u.s();!(o=u.n()).done;){var c=o.value,l=GX(c,n.get(c.key));null!=l&&s.push(new jX(c.key,l,BQ(l.value.mapValue),BX.exists(!0)))}}catch(h){u.e(h)}finally{u.f()}return r.An.addMutationBatch(e,i,s,t)})}).then(function(e){return e.applyToLocalDocumentSet(n),{batchId:e.batchId,changes:n}})}(i.localStore,n);case 4:return a=e.sent,i.sharedClientState.addPendingMutation(a.batchId),s=i,u=a.batchId,c=r,l=void 0,(l=s.Ko[s.currentUser.toKey()])||(l=new i1(eQ)),l=l.insert(u,c),s.Ko[s.currentUser.toKey()]=l,e.next=9,Y3(i,a.changes);case 9:return e.next=11,U2(i.remoteStore);case 11:e.next=17;break;case 13:e.prev=13,e.t0=e.catch(1),o=o3(e.t0,"Failed to persist write"),r.reject(o);case 17:case"end":return e.stop()}var s,u,c,l},e,null,[[1,13]])}))).apply(this,arguments)}function N3(e,t){return M3.apply(this,arguments)}function M3(){return(M3=tB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=VJ(t),e.prev=1,e.next=4,z0(r.localStore,n);case 4:return i=e.sent,n.targetChanges.forEach(function(e,t){var n=r.Uo.get(t);n&&(BJ(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?n.$o=!0:e.modifiedDocuments.size>0?BJ(n.$o):e.removedDocuments.size>0&&(BJ(n.$o),n.$o=!1))}),e.next=8,Y3(r,i,n);case 8:e.next=14;break;case 10:return e.prev=10,e.t0=e.catch(1),e.next=14,x0(e.t0);case 14:case"end":return e.stop()}},e,null,[[1,10]])}))).apply(this,arguments)}function D3(e,t,n){var r=VJ(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){var i=[];r.Mo.forEach(function(e,n){var r=n.view.ro(t);r.snapshot&&i.push(r.snapshot)}),function(e,t){var n=VJ(e);n.onlineState=t;var r=!1;n.queries.forEach(function(e,n){var i,a=Qv(n.listeners);try{for(a.s();!(i=a.n()).done;){i.value.ro(t)&&(r=!0)}}catch(o){a.e(o)}finally{a.f()}}),r&&m3(n)}(r.eventManager,t),i.length&&r.Oo.br(i),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}function L3(e,t,n){return F3.apply(this,arguments)}function F3(){return(F3=tB(regeneratorRuntime.mark(function e(t,n,r){var i,a,o,s,u,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((i=VJ(t)).sharedClientState.updateQueryState(n,"rejected",r),a=i.Uo.get(n),!(o=a&&a.key)){e.next=14;break}return s=(s=new i1(CQ.comparator)).insert(o,VQ.newNoDocument(o,rQ.min())),u=p1().add(o),c=new m1(rQ.min(),new Map,new s1(eQ),s,u),e.next=9,N3(i,c);case 9:i.Bo=i.Bo.remove(o),i.Uo.delete(n),Z3(i),e.next=16;break;case 14:return e.next=16,q0(i.localStore,n,!1).then(function(){return q3(i,n,r)}).catch(x0);case 16:case"end":return e.stop()}},e)}))).apply(this,arguments)}function B3(e,t){return V3.apply(this,arguments)}function V3(){return(V3=tB(regeneratorRuntime.mark(function e(t,n){var r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=VJ(t),i=n.batch.batchId,e.prev=1,e.next=4,V0(r.localStore,n);case 4:return a=e.sent,G3(r,i,null),H3(r,i),r.sharedClientState.updateMutationState(i,"acknowledged"),e.next=10,Y3(r,a);case 10:e.next=16;break;case 12:return e.prev=12,e.t0=e.catch(1),e.next=16,x0(e.t0);case 16:case"end":return e.stop()}},e,null,[[1,12]])}))).apply(this,arguments)}function U3(e,t,n){return z3.apply(this,arguments)}function z3(){return(z3=tB(regeneratorRuntime.mark(function e(t,n,r){var i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=VJ(t),e.prev=1,e.next=4,function(e,t){var n=VJ(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",function(e){var r;return n.An.lookupMutationBatch(e,t).next(function(t){return BJ(null!==t),r=t.keys(),n.An.removeMutationBatch(e,t)}).next(function(){return n.An.performConsistencyCheck(e)}).next(function(){return n.Wn.vn(e,r)})})}(i.localStore,n);case 4:return a=e.sent,G3(i,n,r),H3(i,n),i.sharedClientState.updateMutationState(n,"rejected",r),e.next=10,Y3(i,a);case 10:e.next=16;break;case 12:return e.prev=12,e.t0=e.catch(1),e.next=16,x0(e.t0);case 16:case"end":return e.stop()}},e,null,[[1,12]])}))).apply(this,arguments)}function H3(e,t){(e.jo.get(t)||[]).forEach(function(e){e.resolve()}),e.jo.delete(t)}function G3(e,t,n){var r=VJ(e),i=r.Ko[r.currentUser.toKey()];if(i){var a=i.get(t);a&&(n?a.reject(n):a.resolve(),i=i.remove(t)),r.Ko[r.currentUser.toKey()]=i}}function q3(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.sharedClientState.removeLocalQueryTarget(t);var r,i=Qv(e.Fo.get(t));try{for(i.s();!(r=i.n()).done;){var a=r.value;e.Mo.delete(a),n&&e.Oo.zo(a,n)}}catch(o){i.e(o)}finally{i.f()}e.Fo.delete(t),e.isPrimaryClient&&e.qo.us(t).forEach(function(t){e.qo.containsKey(t)||$3(e,t)})}function $3(e,t){e.Lo.delete(t.path.canonicalString());var n=e.Bo.get(t);null!==n&&(E2(e.remoteStore,n),e.Bo=e.Bo.remove(t),e.Uo.delete(n),Z3(e))}function W3(e,t,n){var r,i=Qv(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;a instanceof _3?(e.qo.addReference(a.key,t),j3(e,a)):a instanceof w3?(NJ("SyncEngine","Document no longer in limbo: "+a.key),e.qo.removeReference(a.key,t),e.qo.containsKey(a.key)||$3(e,a.key)):FJ()}}catch(o){i.e(o)}finally{i.f()}}function j3(e,t){var n=t.key,r=n.path.canonicalString();e.Bo.get(n)||e.Lo.has(r)||(NJ("SyncEngine","New document in limbo: "+n),e.Lo.add(r),Z3(e))}function Z3(e){for(;e.Lo.size>0&&e.Bo.size<e.maxConcurrentLimboResolutions;){var t=e.Lo.values().next().value;e.Lo.delete(t);var n=new CQ(uQ.fromString(t)),r=e.Qo.next();e.Uo.set(r,new E3(n)),e.Bo=e.Bo.insert(n,r),b2(e.remoteStore,new b0(vX(sX(n.path)),r,2,JJ.I))}}function Y3(e,t,n){return K3.apply(this,arguments)}function K3(){return(K3=tB(regeneratorRuntime.mark(function e(t,n,r){var i,a,o,s,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=VJ(t),a=[],o=[],s=[],e.t0=i.Mo.isEmpty(),e.t0){e.next=9;break}return i.Mo.forEach(function(e,t){s.push(i.Go(t,n,r).then(function(e){if(e){i.isPrimaryClient&&i.sharedClientState.updateQueryState(t.targetId,e.fromCache?"not-current":"current"),a.push(e);var n=M0.$n(t.targetId,e);o.push(n)}}))}),e.next=6,Promise.all(s);case 6:return i.Oo.br(a),e.next=9,(u=tB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s,u,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=VJ(t),e.prev=1,e.next=4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(e){return k0.forEach(n,function(t){return k0.forEach(t.kn,function(n){return r.persistence.referenceDelegate.addReference(e,t.targetId,n)}).next(function(){return k0.forEach(t.xn,function(n){return r.persistence.referenceDelegate.removeReference(e,t.targetId,n)})})})});case 4:e.next=11;break;case 6:if(e.prev=6,e.t0=e.catch(1),_0(e.t0)){e.next=10;break}throw e.t0;case 10:NJ("LocalStore","Failed to update sequence numbers: "+e.t0);case 11:i=Qv(n);try{for(i.s();!(a=i.n()).done;)o=a.value,s=o.targetId,o.fromCache||(u=r.qn.get(s),c=u.withLastLimboFreeSnapshotVersion(u.snapshotVersion),r.qn=r.qn.insert(s,c))}catch(l){i.e(l)}finally{i.f()}case 13:case"end":return e.stop()}},e,null,[[1,6]])})),function(e,t){return u.apply(this,arguments)})(i.localStore,o);case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}function J3(e,t){return Q3.apply(this,arguments)}function Q3(){return(Q3=tB(regeneratorRuntime.mark(function e(t,n){var r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((r=VJ(t)).currentUser.isEqual(n)){e.next=12;break}return NJ("SyncEngine","User change. New user:",n.toKey()),e.next=5,F0(r.localStore,n);case 5:return i=e.sent,r.currentUser=n,(a=r).jo.forEach(function(e){e.forEach(function(e){e.reject(new zJ(UJ.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),a.jo.clear(),r.sharedClientState.handleUserChange(n,i.removedBatchIds,i.addedBatchIds),e.next=12,Y3(r,i.Gn);case 12:case"end":return e.stop()}},e)}))).apply(this,arguments)}function X3(e,t){var n=VJ(e),r=n.Uo.get(t);if(r&&r.$o)return p1().add(r.key);var i=p1(),a=n.Fo.get(t);if(!a)return i;var o,s=Qv(a);try{for(s.s();!(o=s.n()).done;){var u=o.value,c=n.Mo.get(u);i=i.unionWith(c.view.bo)}}catch(l){s.e(l)}finally{s.f()}return i}function e4(e){var t=VJ(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=N3.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=X3.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=L3.bind(null,t),t.Oo.br=g3.bind(null,t.eventManager),t.Oo.zo=y3.bind(null,t.eventManager),t}function t4(e){var t=VJ(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=B3.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=U3.bind(null,t),t}var n4=function(){function e(){tp(this,e),this.synchronizeTabs=!1}return rp(e,[{key:"initialize",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t.k=h2(e.databaseInfo.databaseId),t.sharedClientState=t.Jo(e),t.persistence=t.Yo(e),n.next=5,t.persistence.start();case 5:t.gcScheduler=t.Xo(e),t.localStore=t.Zo(e);case 7:case"end":return n.stop()}},n)}))()}},{key:"Xo",value:function(e){return null}},{key:"Zo",value:function(e){return function(e,t,n,r){return new L0(e,t,n,r)}(this.persistence,new D0,e.initialUser,this.k)}},{key:"Yo",value:function(e){return new e2(n2.ks,this.k)}},{key:"Jo",value:function(e){return new i2}},{key:"terminate",value:function(){var e=this;return tB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.gcScheduler&&e.gcScheduler.stop(),t.next=3,e.sharedClientState.shutdown();case 3:return t.next=5,e.persistence.shutdown();case 5:case"end":return t.stop()}},t)}))()}}]),e}(),r4=function(){function e(){tp(this,e)}return rp(e,[{key:"initialize",value:function(e,t){var n=this;return tB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(r.t0=n.localStore,r.t0){r.next=12;break}return n.localStore=e.localStore,n.sharedClientState=e.sharedClientState,n.datastore=n.createDatastore(t),n.remoteStore=n.createRemoteStore(t),n.eventManager=n.createEventManager(t),n.syncEngine=n.createSyncEngine(t,!e.synchronizeTabs),n.sharedClientState.onlineStateHandler=function(e){return D3(n.syncEngine,e,1)},n.remoteStore.remoteSyncer.handleCredentialChange=J3.bind(null,n.syncEngine),r.next=12,function(e,t){return n3.apply(this,arguments)}(n.remoteStore,n.syncEngine.isPrimaryClient);case 12:case"end":return r.stop()}},r)}))()}},{key:"createEventManager",value:function(e){return new h3}},{key:"createDatastore",value:function(e){var t=h2(e.databaseInfo.databaseId),n=new c2(e.databaseInfo);return new g2(e.authCredentials,e.appCheckCredentials,n,t)}},{key:"createRemoteStore",value:function(e){var t,n,r,i,a,o=this;return t=this.localStore,n=this.datastore,r=e.asyncQueue,i=function(e){return D3(o.syncEngine,e,0)},a=o2.Pt()?new o2:new a2,new m2(t,n,r,i,a)}},{key:"createSyncEngine",value:function(e,t){return n=this.localStore,r=this.remoteStore,i=this.eventManager,a=this.sharedClientState,o=e.initialUser,s=e.maxConcurrentLimboResolutions,u=t,c=new S3(n,r,i,a,o,s),u&&(c.Wo=!0),c;var n,r,i,a,o,s,u,c}},{key:"terminate",value:function(){return(e=tB(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=VJ(t),NJ("RemoteStore","RemoteStore shutting down."),n.Gr.add(5),e.next=5,w2(n);case 5:n.Hr.shutdown(),n.Jr.set("Unknown");case 7:case"end":return e.stop()}},e)})),function(t){return e.apply(this,arguments)})(this.remoteStore);var e}}]),e}(),i4=function(){function e(t){tp(this,e),this.observer=t,this.muted=!1}return rp(e,[{key:"next",value:function(e){this.observer.next&&this.ec(this.observer.next,e)}},{key:"error",value:function(e){this.observer.error?this.ec(this.observer.error,e):console.error("Uncaught Error in snapshot listener:",e)}},{key:"nc",value:function(){this.muted=!0}},{key:"ec",value:function(e,t){var n=this;this.muted||setTimeout(function(){n.muted||e(t)},0)}}]),e}(),a4=function(){function e(t,n,r,i){var a=this;tp(this,e);var o,s=this;this.authCredentials=t,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=IJ.UNAUTHENTICATED,this.clientId=XJ.A(),this.authCredentialListener=function(){return Promise.resolve()},this.appCheckCredentialListener=function(){return Promise.resolve()},this.authCredentials.start(r,(o=tB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return NJ("FirestoreClient","Received user=",t.uid),e.next=3,s.authCredentialListener(t);case 3:s.user=t;case 4:case"end":return e.stop()}},e)})),function(e){return o.apply(this,arguments)})),this.appCheckCredentials.start(r,function(e){return NJ("FirestoreClient","Received new app check token=",e),a.appCheckCredentialListener(e,a.user)})}return rp(e,[{key:"getConfiguration",value:function(){var e=this;return tB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",{asyncQueue:e.asyncQueue,databaseInfo:e.databaseInfo,clientId:e.clientId,authCredentials:e.authCredentials,appCheckCredentials:e.appCheckCredentials,initialUser:e.user,maxConcurrentLimboResolutions:100});case 1:case"end":return t.stop()}},t)}))()}},{key:"setCredentialChangeListener",value:function(e){this.authCredentialListener=e}},{key:"setAppCheckTokenChangeListener",value:function(e){this.appCheckCredentialListener=e}},{key:"verifyNotTerminated",value:function(){if(this.asyncQueue.isShuttingDown)throw new zJ(UJ.FAILED_PRECONDITION,"The client has already been terminated.")}},{key:"terminate",value:function(){var e=this;this.asyncQueue.enterRestrictedMode();var t=new HJ;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(tB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,n.t0=e.onlineComponents,!n.t0){n.next=5;break}return n.next=5,e.onlineComponents.terminate();case 5:if(n.t1=e.offlineComponents,!n.t1){n.next=9;break}return n.next=9,e.offlineComponents.terminate();case 9:e.authCredentials.shutdown(),e.appCheckCredentials.shutdown(),t.resolve(),n.next=18;break;case 14:n.prev=14,n.t2=n.catch(0),r=o3(n.t2,"Failed to shutdown persistence"),t.reject(r);case 18:case"end":return n.stop()}},n,null,[[0,14]])}))),t.promise}}]),e}();function o4(e,t){return s4.apply(this,arguments)}function s4(){return(s4=tB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.asyncQueue.verifyOperationInProgress(),NJ("FirestoreClient","Initializing OfflineComponentProvider"),e.next=3,t.getConfiguration();case 3:return r=e.sent,e.next=6,n.initialize(r);case 6:i=r.initialUser,t.setCredentialChangeListener(function(){var e=tB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=i.isEqual(t),e.t0){e.next=5;break}return e.next=4,F0(n.localStore,t);case 4:i=t;case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),n.persistence.setDatabaseDeletedListener(function(){return t.terminate()}),t.offlineComponents=n;case 8:case"end":return e.stop()}},e)}))).apply(this,arguments)}function u4(e,t){return c4.apply(this,arguments)}function c4(){return(c4=tB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.asyncQueue.verifyOperationInProgress(),e.next=3,l4(t);case 3:return r=e.sent,NJ("FirestoreClient","Initializing OnlineComponentProvider"),e.next=7,t.getConfiguration();case 7:return i=e.sent,e.next=10,n.initialize(r,i);case 10:t.setCredentialChangeListener(function(e){return e3(n.remoteStore,e)}),t.setAppCheckTokenChangeListener(function(e,t){return e3(n.remoteStore,t)}),t.onlineComponents=n;case 13:case"end":return e.stop()}},e)}))).apply(this,arguments)}function l4(e){return h4.apply(this,arguments)}function h4(){return(h4=tB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t.offlineComponents,e.t0){e.next=5;break}return NJ("FirestoreClient","Using default OfflineComponentProvider"),e.next=5,o4(t,new n4);case 5:return e.abrupt("return",t.offlineComponents);case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}function f4(e){return d4.apply(this,arguments)}function d4(){return(d4=tB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t.onlineComponents,e.t0){e.next=5;break}return NJ("FirestoreClient","Using default OnlineComponentProvider"),e.next=5,u4(t,new r4);case 5:return e.abrupt("return",t.onlineComponents);case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}function v4(e){return p4.apply(this,arguments)}function p4(){return(p4=tB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f4(t);case 2:return n=e.sent,r=n.eventManager,e.abrupt("return",(r.onListen=P3.bind(null,n.syncEngine),r.onUnlisten=x3.bind(null,n.syncEngine),r));case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}var g4=rp(function e(t,n,r,i,a,o,s,u){tp(this,e),this.databaseId=t,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=a,this.forceLongPolling=o,this.autoDetectLongPolling=s,this.useFetchStreams=u}),y4=function(){function e(t,n){tp(this,e),this.projectId=t,this.database=n||"(default)"}return rp(e,[{key:"isDefaultDatabase",get:function(){return"(default)"===this.database}},{key:"isEqual",value:function(t){return t instanceof e&&t.projectId===this.projectId&&t.database===this.database}}]),e}(),m4=new Map;function k4(e,t,n){if(!n)throw new zJ(UJ.INVALID_ARGUMENT,"Function ".concat(e,"() cannot be called with an empty ").concat(t,"."))}function _4(e){if(!CQ.isDocumentKey(e))throw new zJ(UJ.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but ".concat(e," has ").concat(e.length,"."))}function w4(e){if(CQ.isDocumentKey(e))throw new zJ(UJ.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but ".concat(e," has ").concat(e.length,"."))}function C4(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e="".concat(e.substring(0,20),"...")),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";var t=(n=e).constructor?n.constructor.name:null;return t?"a custom ".concat(t," object"):"an object"}var n;return"function"==typeof e?"a function":FJ()}function b4(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new zJ(UJ.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=C4(e);throw new zJ(UJ.INVALID_ARGUMENT,"Expected type '".concat(t.name,"', but it was: ").concat(n))}return e}var E4=function(){function e(t){var n;if(tp(this,e),void 0===t.host){if(void 0!==t.ssl)throw new zJ(UJ.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(n=t.ssl)||void 0===n||n;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new zJ(UJ.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.useFetchStreams=!!t.useFetchStreams,function(e,t,n,r){if(!0===t&&!0===r)throw new zJ(UJ.INVALID_ARGUMENT,"experimentalForceLongPolling and experimentalAutoDetectLongPolling cannot be used together.")}(0,t.experimentalForceLongPolling,0,t.experimentalAutoDetectLongPolling)}return rp(e,[{key:"isEqual",value:function(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}]),e}(),S4=function(){function e(t,n,r){tp(this,e),this._authCredentials=n,this._appCheckCredentials=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new E4({}),this._settingsFrozen=!1,t instanceof y4?this._databaseId=t:(this._app=t,this._databaseId=function(e){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new zJ(UJ.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new y4(e.options.projectId)}(t))}return rp(e,[{key:"app",get:function(){if(!this._app)throw new zJ(UJ.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}},{key:"_initialized",get:function(){return this._settingsFrozen}},{key:"_terminated",get:function(){return void 0!==this._terminateTask}},{key:"_setSettings",value:function(e){if(this._settingsFrozen)throw new zJ(UJ.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new E4(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new qJ;switch(e.type){case"gapi":var t=e.client;return BJ(!("object"!=typeof t||null===t||!t.auth||!t.auth.getAuthHeaderValueForFirstParty)),new ZJ(t,e.sessionIndex||"0",e.iamToken||null);case"provider":return e.client;default:throw new zJ(UJ.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}},{key:"_getSettings",value:function(){return this._settings}},{key:"_freezeSettings",value:function(){return this._settingsFrozen=!0,this._settings}},{key:"_delete",value:function(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}},{key:"toJSON",value:function(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}},{key:"_terminate",value:function(){return e=this,(t=m4.get(e))&&(NJ("ComponentProvider","Removing Datastore"),m4.delete(e),t.terminate()),Promise.resolve();var e,t}}]),e}();var P4=function(){function e(t,n,r){tp(this,e),this.converter=n,this._key=r,this.type="document",this.firestore=t}return rp(e,[{key:"_path",get:function(){return this._key.path}},{key:"id",get:function(){return this._key.path.lastSegment()}},{key:"path",get:function(){return this._key.path.canonicalString()}},{key:"parent",get:function(){return new T4(this.firestore,this.converter,this._key.path.popLast())}},{key:"withConverter",value:function(t){return new e(this.firestore,t,this._key)}}]),e}(),O4=function(){function e(t,n,r){tp(this,e),this.converter=n,this._query=r,this.type="query",this.firestore=t}return rp(e,[{key:"withConverter",value:function(t){return new e(this.firestore,t,this._query)}}]),e}(),T4=function(e){Gv(n,e);var t=$v(n);function n(e,r,i){var a;return tp(this,n),(a=t.call(this,e,r,sX(i)))._path=i,a.type="collection",a}return rp(n,[{key:"id",get:function(){return this._query.path.lastSegment()}},{key:"path",get:function(){return this._query.path.canonicalString()}},{key:"parent",get:function(){var e=this._path.popLast();return e.isEmpty()?null:new P4(this.firestore,null,new CQ(e))}},{key:"withConverter",value:function(e){return new n(this.firestore,e,this._path)}}]),n}(O4);function I4(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=YB(e),1===arguments.length&&(t=XJ.A()),k4("doc","path",t),e instanceof S4){var a=uQ.fromString.apply(uQ,[t].concat(r));return _4(a),new P4(e,null,new CQ(a))}if(!(e instanceof P4||e instanceof T4))throw new zJ(UJ.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");var o=e._path.child(uQ.fromString.apply(uQ,[t].concat(r)));return _4(o),new P4(e.firestore,e instanceof T4?e.converter:null,new CQ(o))}var x4=function(){function e(){var t=this;tp(this,e),this.mc=Promise.resolve(),this.gc=[],this.yc=!1,this.Tc=[],this.Ec=null,this.Ic=!1,this.Ac=!1,this.Rc=[],this.ur=new f2(this,"async_queue_retry"),this.bc=function(){var e=l2();e&&NJ("AsyncQueue","Visibility state changed to "+e.visibilityState),t.ur.er()};var n=l2();n&&"function"==typeof n.addEventListener&&n.addEventListener("visibilitychange",this.bc)}return rp(e,[{key:"isShuttingDown",get:function(){return this.yc}},{key:"enqueueAndForget",value:function(e){this.enqueue(e)}},{key:"enqueueAndForgetEvenWhileRestricted",value:function(e){this.Pc(),this.vc(e)}},{key:"enterRestrictedMode",value:function(e){if(!this.yc){this.yc=!0,this.Ac=e||!1;var t=l2();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.bc)}}},{key:"enqueue",value:function(e){var t=this;if(this.Pc(),this.yc)return new Promise(function(){});var n=new HJ;return this.vc(function(){return t.yc&&t.Ac?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)}).then(function(){return n.promise})}},{key:"enqueueRetryable",value:function(e){var t=this;this.enqueueAndForget(function(){return t.gc.push(e),t.Vc()})}},{key:"Vc",value:function(){var e=this;return tB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(0===e.gc.length){t.next=14;break}return t.prev=1,t.next=4,e.gc[0]();case 4:e.gc.shift(),e.ur.reset(),t.next=13;break;case 8:if(t.prev=8,t.t0=t.catch(1),_0(t.t0)){t.next=12;break}throw t.t0;case 12:NJ("AsyncQueue","Operation failed with retryable error: "+t.t0);case 13:e.gc.length>0&&e.ur.Zi(function(){return e.Vc()});case 14:case"end":return t.stop()}},t,null,[[1,8]])}))()}},{key:"vc",value:function(e){var t=this,n=this.mc.then(function(){return t.Ic=!0,e().catch(function(e){throw t.Ec=e,t.Ic=!1,MJ("INTERNAL UNHANDLED ERROR: ",(r=(n=e).message||"",n.stack&&(r=n.stack.includes(n.message)?n.stack:n.message+"\n"+n.stack),r)),e;var n,r}).then(function(e){return t.Ic=!1,e})});return this.mc=n,n}},{key:"enqueueAfterDelay",value:function(e,t,n){var r=this;this.Pc(),this.Rc.indexOf(e)>-1&&(t=0);var i=a3.createAndSchedule(this,e,t,n,function(e){return r.Sc(e)});return this.Tc.push(i),i}},{key:"Pc",value:function(){this.Ec&&FJ()}},{key:"verifyOperationInProgress",value:function(){}},{key:"Dc",value:function(){var e=this;return tB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.mc,t.next=3,n;case 3:if(n!==e.mc){t.next=0;break}case 4:case"end":return t.stop()}},t)}))()}},{key:"Cc",value:function(e){var t,n=Qv(this.Tc);try{for(n.s();!(t=n.n()).done;){if(t.value.timerId===e)return!0}}catch(r){n.e(r)}finally{n.f()}return!1}},{key:"Nc",value:function(e){var t=this;return this.Dc().then(function(){t.Tc.sort(function(e,t){return e.targetTimeMs-t.targetTimeMs});var n,r=Qv(t.Tc);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(i.skipDelay(),"all"!==e&&i.timerId===e)break}}catch(a){r.e(a)}finally{r.f()}return t.Dc()})}},{key:"kc",value:function(e){this.Rc.push(e)}},{key:"Sc",value:function(e){var t=this.Tc.indexOf(e);this.Tc.splice(t,1)}}]),e}();function A4(e){return function(e,t){if("object"!=typeof e||null===e)return!1;for(var n=e,r=0,i=["next","error","complete"];r<i.length;r++){var a=i[r];if(a in n&&"function"==typeof n[a])return!0}return!1}(e)}var R4=function(e){Gv(n,e);var t=$v(n);function n(e,r,i){var a;return tp(this,n),(a=t.call(this,e,r,i)).type="firestore",a._queue=new x4,a._persistenceKey="name"in e?e.name:"[DEFAULT]",a}return rp(n,[{key:"_terminate",value:function(){return this._firestoreClient||M4(this),this._firestoreClient.terminate()}}]),n}(S4);function N4(e){return e._firestoreClient||M4(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function M4(e){var t,n,r,i=e._freezeSettings(),a=(n=(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",new g4(e._databaseId,n,e._persistenceKey,(r=i).host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,r.useFetchStreams));e._firestoreClient=new a4(e._authCredentials,e._appCheckCredentials,e._queue,a)}var D4=function(){function e(){tp(this,e);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0;i<n.length;++i)if(0===n[i].length)throw new zJ(UJ.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new lQ(n)}return rp(e,[{key:"isEqual",value:function(e){return this._internalPath.isEqual(e._internalPath)}}]),e}(),L4=function(){function e(t){tp(this,e),this._byteString=t}return rp(e,[{key:"toBase64",value:function(){return this._byteString.toBase64()}},{key:"toUint8Array",value:function(){return this._byteString.toUint8Array()}},{key:"toString",value:function(){return"Bytes(base64: "+this.toBase64()+")"}},{key:"isEqual",value:function(e){return this._byteString.isEqual(e._byteString)}}],[{key:"fromBase64String",value:function(t){try{return new e(fQ.fromBase64String(t))}catch(n){throw new zJ(UJ.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}},{key:"fromUint8Array",value:function(t){return new e(fQ.fromUint8Array(t))}}]),e}(),F4=rp(function e(t){tp(this,e),this._methodName=t}),B4=function(){function e(t,n){if(tp(this,e),!isFinite(t)||t<-90||t>90)throw new zJ(UJ.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(n)||n<-180||n>180)throw new zJ(UJ.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=t,this._long=n}return rp(e,[{key:"latitude",get:function(){return this._lat}},{key:"longitude",get:function(){return this._long}},{key:"isEqual",value:function(e){return this._lat===e._lat&&this._long===e._long}},{key:"toJSON",value:function(){return{latitude:this._lat,longitude:this._long}}},{key:"_compareTo",value:function(e){return eQ(this._lat,e._lat)||eQ(this._long,e._long)}}]),e}(),V4=/^__.*__$/,U4=function(){function e(t,n,r){tp(this,e),this.data=t,this.fieldMask=n,this.fieldTransforms=r}return rp(e,[{key:"toMutation",value:function(e,t){return null!==this.fieldMask?new jX(e,this.data,this.fieldMask,t,this.fieldTransforms):new WX(e,this.data,t,this.fieldTransforms)}}]),e}(),z4=function(){function e(t,n,r){tp(this,e),this.data=t,this.fieldMask=n,this.fieldTransforms=r}return rp(e,[{key:"toMutation",value:function(e,t){return new jX(e,this.data,this.fieldMask,t,this.fieldTransforms)}}]),e}();function H4(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw FJ()}}var G4=function(){function e(t,n,r,i,a,o){tp(this,e),this.settings=t,this.databaseId=n,this.k=r,this.ignoreUndefinedProperties=i,void 0===a&&this.xc(),this.fieldTransforms=a||[],this.fieldMask=o||[]}return rp(e,[{key:"path",get:function(){return this.settings.path}},{key:"$c",get:function(){return this.settings.$c}},{key:"Oc",value:function(t){return new e(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.k,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}},{key:"Mc",value:function(e){var t,n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Oc({path:n,Fc:!1});return r.Lc(e),r}},{key:"Bc",value:function(e){var t,n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Oc({path:n,Fc:!1});return r.xc(),r}},{key:"Uc",value:function(e){return this.Oc({path:void 0,Fc:!0})}},{key:"qc",value:function(e){return n5(e,this.settings.methodName,this.settings.Kc||!1,this.path,this.settings.jc)}},{key:"contains",value:function(e){return void 0!==this.fieldMask.find(function(t){return e.isPrefixOf(t)})||void 0!==this.fieldTransforms.find(function(t){return e.isPrefixOf(t.field)})}},{key:"xc",value:function(){if(this.path)for(var e=0;e<this.path.length;e++)this.Lc(this.path.get(e))}},{key:"Lc",value:function(e){if(0===e.length)throw this.qc("Document fields must not be empty");if(H4(this.$c)&&V4.test(e))throw this.qc('Document fields cannot begin and end with "__"')}}]),e}(),q4=function(){function e(t,n,r){tp(this,e),this.databaseId=t,this.ignoreUndefinedProperties=n,this.k=r||h2(t)}return rp(e,[{key:"Qc",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new G4({$c:e,methodName:t,jc:n,path:lQ.emptyPath(),Fc:!1,Kc:r},this.databaseId,this.k,this.ignoreUndefinedProperties)}}]),e}();function $4(e){var t=e._freezeSettings(),n=h2(e._databaseId);return new q4(e._databaseId,!!t.ignoreUndefinedProperties,n)}function W4(e,t,n,r,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},o=e.Qc(a.merge||a.mergeFields?2:0,t,n,i);Q4("Data must be an object, but it was:",o,r);var s,u,c=K4(r,o);if(a.merge)s=new hQ(o.fieldMask),u=o.fieldTransforms;else if(a.mergeFields){var l,h=[],f=Qv(a.mergeFields);try{for(f.s();!(l=f.n()).done;){var d=l.value,v=X4(t,d,n);if(!o.contains(v))throw new zJ(UJ.INVALID_ARGUMENT,"Field '".concat(v,"' is specified in your field mask but missing from your input data."));r5(h,v)||h.push(v)}}catch(p){f.e(p)}finally{f.f()}s=new hQ(h),u=o.fieldTransforms.filter(function(e){return s.covers(e.field)})}else s=null,u=o.fieldTransforms;return new U4(new FQ(c),s,u)}var j4=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"_toFieldTransform",value:function(e){if(2!==e.$c)throw e.qc(1===e.$c?"".concat(this._methodName,"() can only appear at the top level of your update data"):"".concat(this._methodName,"() cannot be used with set() unless you pass {merge:true}"));return e.fieldMask.push(e.path),null}},{key:"isEqual",value:function(e){return e instanceof n}}]),n}(F4),Z4=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"_toFieldTransform",value:function(e){return new LX(e.path,new TX)}},{key:"isEqual",value:function(e){return e instanceof n}}]),n}(F4);function Y4(e,t){if(J4(e=YB(e)))return Q4("Unsupported field value:",t,e),K4(e,t);if(e instanceof F4)return function(e,t){if(!H4(t.$c))throw t.qc("".concat(e._methodName,"() can only be used with update() and set()"));if(!t.path)throw t.qc("".concat(e._methodName,"() is not currently supported inside arrays"));var n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.Fc&&4!==t.$c)throw t.qc("Nested arrays are not supported");return function(e,t){var n,r=[],i=0,a=Qv(e);try{for(a.s();!(n=a.n()).done;){var o=Y4(n.value,t.Uc(i));null==o&&(o={nullValue:"NULL_VALUE"}),r.push(o),i++}}catch(s){a.e(s)}finally{a.f()}return{arrayValue:{values:r}}}(e,t)}return function(e,t){if(null===(e=YB(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return function(e,t){return function(e){return"number"==typeof e&&Number.isInteger(e)&&!wQ(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}(t)?bX(t):CX(e,t)}(t.k,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){var n=nQ.fromDate(e);return{timestampValue:x1(t.k,n)}}if(e instanceof nQ){var r=new nQ(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:x1(t.k,r)}}if(e instanceof B4)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof L4)return{bytesValue:A1(t.k,e._byteString)};if(e instanceof P4){var i=t.databaseId,a=e.firestore._databaseId;if(!a.isEqual(i))throw t.qc("Document reference is for database ".concat(a.projectId,"/").concat(a.database," but should be for database ").concat(i.projectId,"/").concat(i.database));return{referenceValue:M1(e.firestore._databaseId||t.databaseId,e._key.path)}}throw t.qc("Unsupported field value: ".concat(C4(e)))}(e,t)}function K4(e,t){var n={};return oQ(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):aQ(e,function(e,r){var i=Y4(r,t.Mc(e));null!=i&&(n[e]=i)}),{mapValue:{fields:n}}}function J4(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof nQ||e instanceof B4||e instanceof L4||e instanceof P4||e instanceof F4)}function Q4(e,t,n){if(!J4(n)||"object"!=typeof(i=n)||null===i||Object.getPrototypeOf(i)!==Object.prototype&&null!==Object.getPrototypeOf(i)){var r=C4(n);throw t.qc("an object"===r?e+" a custom object":e+" "+r)}var i}function X4(e,t,n){if((t=YB(t))instanceof D4)return t._internalPath;if("string"==typeof t)return t5(e,t);throw n5("Field path arguments must be of type string or ",e,!1,void 0,n)}var e5=new RegExp("[~\\*/\\[\\]]");function t5(e,t,n){if(t.search(e5)>=0)throw n5("Invalid field path (".concat(t,"). Paths must not contain '~', '*', '/', '[', or ']'"),e,!1,void 0,n);try{return Uv(D4,Kv(t.split(".")))._internalPath}catch(r){throw n5("Invalid field path (".concat(t,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"),e,!1,void 0,n)}}function n5(e,t,n,r,i){var a=r&&!r.isEmpty(),o=void 0!==i,s="Function ".concat(t,"() called with invalid data");n&&(s+=" (via `toFirestore()`)"),s+=". ";var u="";return(a||o)&&(u+=" (found",a&&(u+=" in field ".concat(r)),o&&(u+=" in document ".concat(i)),u+=")"),new zJ(UJ.INVALID_ARGUMENT,s+e+u)}function r5(e,t){return e.some(function(e){return e.isEqual(t)})}var i5=function(){function e(t,n,r,i,a){tp(this,e),this._firestore=t,this._userDataWriter=n,this._key=r,this._document=i,this._converter=a}return rp(e,[{key:"id",get:function(){return this._key.path.lastSegment()}},{key:"ref",get:function(){return new P4(this._firestore,this._converter,this._key)}},{key:"exists",value:function(){return null!==this._document}},{key:"data",value:function(){if(this._document){if(this._converter){var e=new a5(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}},{key:"get",value:function(e){if(this._document){var t=this._document.data.field(o5("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}]),e}(),a5=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"data",value:function(){return zv(Yv(n.prototype),"data",this).call(this)}}]),n}(i5);function o5(e,t){return"string"==typeof t?t5(e,t):t instanceof D4?t._internalPath:t._delegate._internalPath}var s5=function(){function e(t,n){tp(this,e),this.hasPendingWrites=t,this.fromCache=n}return rp(e,[{key:"isEqual",value:function(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}]),e}(),u5=function(e){Gv(n,e);var t=$v(n);function n(e,r,i,a,o,s){var u;return tp(this,n),(u=t.call(this,e,r,i,a,s))._firestore=e,u._firestoreImpl=e,u.metadata=o,u}return rp(n,[{key:"exists",value:function(){return zv(Yv(n.prototype),"exists",this).call(this)}},{key:"data",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){var t=new c5(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){var n=this._document.data.field(o5("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}]),n}(i5),c5=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"data",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return zv(Yv(n.prototype),"data",this).call(this,e)}}]),n}(u5),l5=function(){function e(t,n,r,i){tp(this,e),this._firestore=t,this._userDataWriter=n,this._snapshot=i,this.metadata=new s5(i.hasPendingWrites,i.fromCache),this.query=r}return rp(e,[{key:"docs",get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e}},{key:"size",get:function(){return this._snapshot.docs.size}},{key:"empty",get:function(){return 0===this.size}},{key:"forEach",value:function(e,t){var n=this;this._snapshot.docs.forEach(function(r){e.call(t,new c5(n._firestore,n._userDataWriter,r.key,r,new s5(n._snapshot.mutatedKeys.has(r.key),n._snapshot.fromCache),n.query.converter))})}},{key:"docChanges",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new zJ(UJ.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){var n=0;return e._snapshot.docChanges.map(function(t){return{type:"added",doc:new c5(e._firestore,e._userDataWriter,t.doc.key,t.doc,new s5(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter),oldIndex:-1,newIndex:n++}})}var r=e._snapshot.oldDocs;return e._snapshot.docChanges.filter(function(e){return t||3!==e.type}).map(function(t){var n=new c5(e._firestore,e._userDataWriter,t.doc.key,t.doc,new s5(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter),i=-1,a=-1;return 0!==t.type&&(i=r.indexOf(t.doc.key),r=r.delete(t.doc.key)),1!==t.type&&(a=(r=r.add(t.doc)).indexOf(t.doc.key)),{type:h5(t.type),doc:n,oldIndex:i,newIndex:a}})}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}]),e}();function h5(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return FJ()}}function f5(e){if(cX(e)&&0===e.explicitOrderBy.length)throw new zJ(UJ.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var d5=rp(function e(){tp(this,e)});var v5=function(e){Gv(n,e);var t=$v(n);function n(e,r,i){var a;return tp(this,n),(a=t.call(this)).zc=e,a.Hc=r,a.Jc=i,a.type="where",a}return rp(n,[{key:"_apply",value:function(e){var t,n,r,i=$4(e.firestore),a=function(e,t,n,r,i,a,o){var s;if(i.isKeyField()){if("array-contains"===a||"array-contains-any"===a)throw new zJ(UJ.INVALID_ARGUMENT,"Invalid Query. You can't perform '".concat(a,"' queries on documentId()."));if("in"===a||"not-in"===a){m5(o,a);var u,c=[],l=Qv(o);try{for(l.s();!(u=l.n()).done;){var h=u.value;c.push(y5(r,e,h))}}catch(d){l.e(d)}finally{l.f()}s={arrayValue:{values:c}}}else s=y5(r,e,o)}else"in"!==a&&"not-in"!==a&&"array-contains-any"!==a||m5(o,a),s=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return Y4(n,e.Qc(r?4:3,t))}(n,"where",o,"in"===a||"not-in"===a);var f=$Q.create(i,a,s);return function(e,t){if(t.V()){var n=hX(e);if(null!==n&&!n.isEqual(t.field))throw new zJ(UJ.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '".concat(n.toString(),"' and '").concat(t.field.toString(),"'"));var r=lX(e);null!==r&&k5(0,t.field,r)}var i=function(e,t){var n,r=Qv(e.filters);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(t.indexOf(i.op)>=0)return i.op}}catch(d){r.e(d)}finally{r.f()}return null}(e,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==i)throw new zJ(UJ.INVALID_ARGUMENT,i===t.op?"Invalid query. You cannot use more than one '".concat(t.op.toString(),"' filter."):"Invalid query. You cannot use '".concat(t.op.toString(),"' filters with '").concat(i.toString(),"' filters."))}(e,f),f}(e._query,0,i,e.firestore._databaseId,this.zc,this.Hc,this.Jc);return new O4(e.firestore,e.converter,(t=e._query,n=a,r=t.filters.concat([n]),new oX(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)))}}]),n}(d5);var p5=function(e){Gv(n,e);var t=$v(n);function n(e,r){var i;return tp(this,n),(i=t.call(this)).zc=e,i.Yc=r,i.type="orderBy",i}return rp(n,[{key:"_apply",value:function(e){var t,n,r,i=function(e,t,n){if(null!==e.startAt)throw new zJ(UJ.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new zJ(UJ.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new nX(t,n);return function(e,t){if(null===lX(e)){var n=hX(e);null!==n&&k5(0,n,t.field)}}(e,r),r}(e._query,this.zc,this.Yc);return new O4(e.firestore,e.converter,(t=e._query,n=i,r=t.explicitOrderBy.concat([n]),new oX(t.path,t.collectionGroup,r,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)))}}]),n}(d5);var g5=function(e){Gv(n,e);var t=$v(n);function n(e,r,i){var a;return tp(this,n),(a=t.call(this)).type=e,a.Xc=r,a.Zc=i,a}return rp(n,[{key:"_apply",value:function(e){return new O4(e.firestore,e.converter,pX(e._query,this.Xc,this.Zc))}}]),n}(d5);function y5(e,t,n){if("string"==typeof(n=YB(n))){if(""===n)throw new zJ(UJ.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!fX(t)&&-1!==n.indexOf("/"))throw new zJ(UJ.INVALID_ARGUMENT,"Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '".concat(n,"' contains a '/' character."));var r=t.path.child(uQ.fromString(n));if(!CQ.isDocumentKey(r))throw new zJ(UJ.INVALID_ARGUMENT,"Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '".concat(r,"' is not because it has an odd number of segments (").concat(r.length,")."));return xQ(e,new CQ(r))}if(n instanceof P4)return xQ(e,n._key);throw new zJ(UJ.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ".concat(C4(n),"."))}function m5(e,t){if(!Array.isArray(e)||0===e.length)throw new zJ(UJ.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '".concat(t.toString(),"' filters."));if(e.length>10)throw new zJ(UJ.INVALID_ARGUMENT,"Invalid Query. '".concat(t.toString(),"' filters support a maximum of 10 elements in the value array."))}function k5(e,t,n){if(!n.isEqual(t))throw new zJ(UJ.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '".concat(t.toString(),"' and so you must also use '").concat(t.toString(),"' as your first argument to orderBy(), but your first orderBy() is on field '").concat(n.toString(),"' instead."))}function _5(e,t,n){return e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t}var w5=function(e){Gv(n,e);var t=$v(n);function n(e){var r;return tp(this,n),(r=t.call(this)).firestore=e,r}return rp(n,[{key:"convertBytes",value:function(e){return new L4(e)}},{key:"convertReference",value:function(e){var t=this.convertDocumentKey(e,this.firestore._databaseId);return new P4(this.firestore,null,t)}}]),n}(function(){function e(){tp(this,e)}return rp(e,[{key:"convertValue",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(bQ(e)){case 0:return null;case 1:return e.booleanValue;case 2:return pQ(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(gQ(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw FJ()}}},{key:"convertObject",value:function(e,t){var n=this,r={};return aQ(e.fields,function(e,i){r[e]=n.convertValue(i,t)}),r}},{key:"convertGeoPoint",value:function(e){return new B4(pQ(e.latitude),pQ(e.longitude))}},{key:"convertArray",value:function(e,t){var n=this;return(e.values||[]).map(function(e){return n.convertValue(e,t)})}},{key:"convertServerTimestamp",value:function(e,t){switch(t){case"previous":var n=mQ(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(kQ(e));default:return null}}},{key:"convertTimestamp",value:function(e){var t=vQ(e);return new nQ(t.seconds,t.nanos)}},{key:"convertDocumentKey",value:function(e,t){var n=uQ.fromString(e);BJ(t0(n));var r=new y4(n.get(1),n.get(3)),i=new CQ(n.popFirst(5));return r.isEqual(t)||MJ("Document ".concat(i," contains a document reference within a different database (").concat(r.projectId,"/").concat(r.database,") which is not supported. It will be treated as a reference in the current database (").concat(t.projectId,"/").concat(t.database,") instead.")),i}}]),e}());function C5(e,t){return n=N4(e),r=t,i=new HJ,n.asyncQueue.enqueueAndForget(tB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=function(e,t,n){return R3.apply(this,arguments)},e.next=3,function(e){return f4(e).then(function(e){return e.syncEngine})}(n);case 3:return e.t1=e.sent,e.t2=r,e.t3=i,e.abrupt("return",(0,e.t0)(e.t1,e.t2,e.t3));case 7:case"end":return e.stop()}},e)}))),i.promise;var n,r,i}function b5(e,t,n){var r=n.docs.get(t._key),i=new w5(e);return new u5(e,i,t._key,r,new s5(n.hasPendingWrites,n.fromCache),t.converter)}function E5(){return new Z4("serverTimestamp")}!function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];xJ="9.6.6",pV(new KB("firestore",function(e,n){var r=n.options,i=e.getProvider("app").getImmediate(),a=new R4(i,new WJ(e.getProvider("auth-internal")),new KJ(e.getProvider("app-check-internal")));return r=Object.assign({useFetchStreams:t},r),a._setSettings(r),a},"PUBLIC")),CV(TJ,"3.4.4",e),CV(TJ,"3.4.4","esm2017")}();var S5=rp(function e(t){return tp(this,e),t}),P5=new ok("angularfire2.firestore-instances");function O5(e){return function(t,n){var r=t.runOutsideAngular(function(){return e(n)});return new S5(r)}}var T5={provide:rp(function e(){return tp(this,e),JH("firestore")}),deps:[[new Mk,P5]]},I5={provide:S5,useFactory:function(e,t){var n=KH("firestore",e,t);return n&&new S5(n)},deps:[[new Mk,P5],uG]},x5=function(){var e=rp(function e(){tp(this,e),CV("angularfire",WH.full,"fst")});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=iy({type:e}),e.\u0275inj=Sg({providers:[I5,T5]}),e}(),A5=sG(function(e,t){var n=b4(e.firestore,R4),r=I4(e),i=_5(e.converter,t);return C5(n,[W4($4(e.firestore),"addDoc",r._key,i,null!==e.converter,{}).toMutation(r._key,BX.exists(!1))]).then(function(){return r})},!0),R5=sG(function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=YB(e),k4("collection","path",t),e instanceof S4){var a=uQ.fromString.apply(uQ,[t].concat(r));return w4(a),new T4(e,null,a)}if(!(e instanceof P4||e instanceof T4))throw new zJ(UJ.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");var o=e._path.child(uQ.fromString.apply(uQ,[t].concat(r)));return w4(o),new T4(e.firestore,null,o)},!0),N5=sG(function(e,t,n){var r,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=(e=b4(e,S4))._getSettings();if("firestore.googleapis.com"!==a.host&&a.host!==t&&DJ("Host has been set in both settings() and useEmulator(), emulator host will be used"),e._setSettings(Object.assign(Object.assign({},a),{host:"".concat(t,":").concat(n),ssl:!1})),i.mockUserToken){var o,s;if("string"==typeof i.mockUserToken)o=i.mockUserToken,s=IJ.MOCK_USER;else{o=kB(i.mockUserToken,null===(r=e._app)||void 0===r?void 0:r.options.projectId);var u=i.mockUserToken.sub||i.mockUserToken.user_id;if(!u)throw new zJ(UJ.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");s=new IJ(u)}e._authCredentials=new $J(new GJ(o,s))}},!0),M5=sG(function(e){return C5(b4(e.firestore,R4),[new XX(e._key,BX.none())])},!0),D5=sG(I4,!0),L5=sG(function(e){e=b4(e,P4);var t=b4(e.firestore,R4);return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=new HJ;return e.asyncQueue.enqueueAndForget(tB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.t0=function(e,t,n,r,i){var a=new i4({next:function(a){t.enqueueAndForget(function(){return v3(e,o)});var s=a.docs.has(n);!s&&a.fromCache?i.reject(new zJ(UJ.UNAVAILABLE,"Failed to get document because the client is offline.")):s&&a.fromCache&&r&&"server"===r.source?i.reject(new zJ(UJ.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(a)},error:function(e){return i.reject(e)}}),o=new k3(sX(n.path),a,{includeMetadataChanges:!0,wo:!0});return f3(e,o)},i.next=3,v4(e);case 3:return i.t1=i.sent,i.t2=e.asyncQueue,i.t3=t,i.t4=n,i.t5=r,i.abrupt("return",(0,i.t0)(i.t1,i.t2,i.t3,i.t4,i.t5));case 9:case"end":return i.stop()}},i)}))),r.promise}(N4(t),e._key).then(function(n){return b5(t,e,n)})},!0),F5=sG(function(e){e=b4(e,O4);var t=b4(e.firestore,R4),n=N4(t),r=new w5(t);return f5(e._query),function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=new HJ;return e.asyncQueue.enqueueAndForget(tB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.t0=function(e,t,n,r,i){var a=new i4({next:function(n){t.enqueueAndForget(function(){return v3(e,o)}),n.fromCache&&"server"===r.source?i.reject(new zJ(UJ.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(e){return i.reject(e)}}),o=new k3(n,a,{includeMetadataChanges:!0,wo:!0});return f3(e,o)},i.next=3,v4(e);case 3:return i.t1=i.sent,i.t2=e.asyncQueue,i.t3=t,i.t4=n,i.t5=r,i.abrupt("return",(0,i.t0)(i.t1,i.t2,i.t3,i.t4,i.t5));case 9:case"end":return i.stop()}},i)}))),r.promise}(n,e._query).then(function(n){return new l5(t,r,e,n)})},!0),B5=sG(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_V();return gV(e,"firestore").getImmediate()},!0),V5=sG(function(e){return function(e,t){if(t<=0)throw new zJ(UJ.INVALID_ARGUMENT,"Function ".concat("limit","() requires a positive number, but it was: ").concat(t,"."))}(0,e),new g5("limit",e,"F")},!0),U5=sG(function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i,a,o;e=YB(e);var s={includeMetadataChanges:!1},u=0;"object"!=typeof n[u]||A4(n[u])||(s=n[u],u++);var c,l,h,f={includeMetadataChanges:s.includeMetadataChanges};if(A4(n[u])){var d=n[u];n[u]=null===(i=d.next)||void 0===i?void 0:i.bind(d),n[u+1]=null===(a=d.error)||void 0===a?void 0:a.bind(d),n[u+2]=null===(o=d.complete)||void 0===o?void 0:o.bind(d)}if(e instanceof P4)l=b4(e.firestore,R4),h=sX(e._key.path),c={next:function(t){n[u]&&n[u](b5(l,e,t))},error:n[u+1],complete:n[u+2]};else{var v=b4(e,O4);l=b4(v.firestore,R4),h=v._query;var p=new w5(l);c={next:function(e){n[u]&&n[u](new l5(l,p,v,e))},error:n[u+1],complete:n[u+2]},f5(e._query)}return function(e,t,n,r){var i=new i4(r),a=new k3(t,i,n);return e.asyncQueue.enqueueAndForget(tB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=f3,t.next=3,v4(e);case 3:return t.t1=t.sent,t.t2=a,t.abrupt("return",(0,t.t0)(t.t1,t.t2));case 6:case"end":return t.stop()}},t)}))),function(){i.nc(),e.asyncQueue.enqueueAndForget(tB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=v3,t.next=3,v4(e);case 3:return t.t1=t.sent,t.t2=a,t.abrupt("return",(0,t.t0)(t.t1,t.t2));case 6:case"end":return t.stop()}},t)})))}}(N4(l),h,f,c)},!0),z5=sG(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc",n=t,r=o5("orderBy",e);return new p5(r,n)},!0),H5=sG(function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(var i=0,a=n;i<a.length;i++){var o=a[i];e=o._apply(e)}return e},!0),G5=sG(function(e,t,n){e=b4(e,P4);var r=b4(e.firestore,R4),i=_5(e.converter,t,n);return C5(r,[W4($4(r),"setDoc",e._key,i,null!==e.converter,n).toMutation(e._key,BX.none())])},!0),q5=sG(function(e,t,n){e=b4(e,P4);for(var r,i=b4(e.firestore,R4),a=$4(i),o=arguments.length,s=new Array(o>3?o-3:0),u=3;u<o;u++)s[u-3]=arguments[u];return r="string"==typeof(t=YB(t))||t instanceof D4?function(e,t,n,r,i,a){var o=e.Qc(1,t,n),s=[X4(t,r,n)],u=[i];if(a.length%2!=0)throw new zJ(UJ.INVALID_ARGUMENT,"Function ".concat(t,"() needs to be called with an even number of arguments that alternate between field names and values."));for(var c=0;c<a.length;c+=2)s.push(X4(t,a[c])),u.push(a[c+1]);for(var l=[],h=FQ.empty(),f=s.length-1;f>=0;--f)if(!r5(l,s[f])){var d=s[f],v=u[f];v=YB(v);var p=o.Bc(d);if(v instanceof j4)l.push(d);else{var g=Y4(v,p);null!=g&&(l.push(d),h.set(d,g))}}var y=new hQ(l);return new z4(h,y,o.fieldTransforms)}(a,"updateDoc",e._key,t,n,s):function(e,t,n,r){var i=e.Qc(1,t,n);Q4("Data must be an object, but it was:",i,r);var a=[],o=FQ.empty();aQ(r,function(e,r){var s=t5(t,e,n);r=YB(r);var u=i.Bc(s);if(r instanceof j4)a.push(s);else{var c=Y4(r,u);null!=c&&(a.push(s),o.set(s,c))}});var s=new hQ(a);return new z4(o,s,i.fieldTransforms)}(a,"updateDoc",e._key,t),C5(i,[r.toMutation(e._key,BX.exists(!0))])},!0),$5=sG(function(e,t,n){var r=t,i=o5("where",e);return new v5(i,r,n)},!0),W5=function(){var e=function(){function e(t,n){tp(this,e),this.collectionName=t,this.firestore=n,this.subDAOs={},this.collection=R5(n,this.collectionName).withConverter({fromFirestore:function(e){return e.data()},toFirestore:function(e){return e}})}return rp(e,[{key:"create",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,A5(t.collection,e);case 2:return n.abrupt("return",n.sent.id);case 3:case"end":return n.stop()}},n)}))()}},{key:"read",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,L5(D5(t.collection,e));case 2:return r=n.sent,n.abrupt("return",r.exists()?sB.of(nB.getNonNullable(r.data())):sB.empty());case 4:case"end":return n.stop()}},n)}))()}},{key:"exists",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.read(e);case 2:return n.abrupt("return",n.sent.isPresent());case 3:case"end":return n.stop()}},n)}))()}},{key:"update",value:function(e,t){var n=this;return tB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",q5(D5(n.collection,e),t));case 1:case"end":return r.stop()}},r)}))()}},{key:"delete",value:function(e){return M5(D5(this.collection,e))}},{key:"set",value:function(t,n){return rB(e.VERBOSE,{called:this.collectionName+".set",id:t,element:n}),G5(D5(this.collection,t),n)}},{key:"subscribeToChanges",value:function(e,t){return U5(D5(this.collection,e),function(e){t(sB.ofNullable(e.data()))})}},{key:"findWhere",value:function(e,t,n){var r=this;return tB(regeneratorRuntime.mark(function i(){var a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return a=r.constructQuery(e,t,n),i.next=3,F5(a);case 3:return i.abrupt("return",i.sent.docs.map(function(e){return{id:e.id,data:e.data()}}));case 4:case"end":return i.stop()}},i)}))()}},{key:"observingWhere",value:function(t,n,r){var i=this,a=this.constructQuery(t,r);return U5(a,function(t){var r=[],a=[],o=[];t.docChanges().forEach(function(e){var t={id:e.doc.id,data:e.doc.data()};switch(e.type){case"added":r.push(t);break;case"modified":a.push(t);break;case"removed":o.push(t)}}),r.length>0&&(rB(e.VERBOSE,"firebase gave us "+r.length+" NEW "+i.collectionName),n.onDocumentCreated(r)),a.length>0&&(rB(e.VERBOSE,"firebase gave us "+a.length+" MODIFIED "+i.collectionName),n.onDocumentModified(a)),o.length>0&&(rB(e.VERBOSE,"firebase gave us "+o.length+" DELETED "+i.collectionName),n.onDocumentDeleted(o))})}},{key:"constructQuery",value:function(e,t,n){var r=H5(this.collection);null!=t&&(r=H5(r,z5(t))),null!=n&&(r=H5(r,V5(n)));var i,a=Qv(e);try{for(a.s();!(i=a.n()).done;){var o=i.value;r=H5(r,$5(o[0],o[1],o[2]))}}catch(s){a.e(s)}finally{a.f()}return r}},{key:"subCollectionDAO",value:function(t,n){var r="".concat(this.collection.path,"/").concat(t,"/").concat(n);if(r in this.subDAOs)return this.subDAOs[r];var i=new(function(e){Gv(n,e);var t=$v(n);function n(e){return tp(this,n),t.call(this,r,e)}return rp(n)}(e))(this.firestore);return this.subDAOs[r]=i,i}}]),e}();return e.VERBOSE=!1,e}(),j5=function(){function e(){tp(this,e)}return rp(e,[{key:"equals",value:function(e){return this.isFailure()?e.isFailure()&&this.getReason()===e.getReason():!e.isFailure()&&oB(this.get(),e.get())}}],[{key:"success",value:function(e){return new Z5(e)}},{key:"failure",value:function(e){return new Y5(e)}}]),e}(),Z5=function(e){Gv(n,e);var t=$v(n);function n(e){var r;return tp(this,n),(r=t.call(this)).value=e,r}return rp(n,[{key:"isSuccess",value:function(){return!0}},{key:"isFailure",value:function(){return!1}},{key:"get",value:function(){return this.value}},{key:"getReason",value:function(){throw new Error("Cannot get failure reason from a success")}},{key:"getReasonOr",value:function(e){return e}},{key:"toOptional",value:function(){return sB.of(this.value)}},{key:"toString",value:function(){return"MGPFallible.success(".concat(this.value,")")}}]),n}(j5),Y5=function(e){Gv(n,e);var t=$v(n);function n(e){var r;return tp(this,n),(r=t.call(this)).reason=e,r}return rp(n,[{key:"isSuccess",value:function(){return!1}},{key:"isFailure",value:function(){return!0}},{key:"get",value:function(){throw new Error("Value is absent from failure, with the following reason: "+this.reason)}},{key:"getReason",value:function(){return this.reason}},{key:"getReasonOr",value:function(e){return this.getReason()}},{key:"toOptional",value:function(){return sB.empty()}},{key:"toString",value:function(){return"MGPFallible.failure(".concat(this.reason,")")}}]),n}(j5),K5=function(){function e(t){tp(this,e),this.reason=t}return rp(e,[{key:"isFailure",value:function(){return!1===this.isSuccess()}},{key:"isSuccess",value:function(){return null==this.reason}},{key:"getReason",value:function(){if(this.isSuccess())throw new Error("MGPValidation: Cannot extract failure reason from success.");return this.reason}},{key:"toFallible",value:function(e){return this.isSuccess()?j5.success(e):j5.failure(this.getReason())}},{key:"toFailedFallible",value:function(){if(this.isSuccess())throw new Error("MGPValidation: cannot convert into failed fallible.");return j5.failure(this.getReason())}}],[{key:"ofFallible",value:function(t){return t.isSuccess()?e.SUCCESS:e.failure(t.getReason())}},{key:"failure",value:function(t){return new e(t)}}]),e}();K5.SUCCESS=new K5(null);var J5=function(){var e=function(e){Gv(n,e);var t=$v(n);function n(e){return tp(this,n),t.call(this,"errors",e)}return rp(n,[{key:"findErrors",value:function(e,t,n,r){return this.findWhere(void 0===r?[["component","==",e],["route","==",t],["message","==",n]]:[["component","==",e],["route","==",t],["message","==",n],["data","==",r]])}}]),n}(W5);return e.\u0275fac=function(t){return new(t||e)(Pk(S5))},e.\u0275prov=Eg({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),Q5=function(){var e=function(){function e(t,n){tp(this,e),this.errorDAO=t,this.router=n,e.setSingletonInstance(this)}return rp(e,[{key:"logError",value:function(e,t,n){var r=this;return tB(regeneratorRuntime.mark(function i(){var a,o,s,u,c;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return a=r.router.url,i.next=3,r.errorDAO.findErrors(e,a,t,n);case 3:if(0!==(o=i.sent).length){i.next=11;break}return s={component:e,route:a,message:t,firstEncounter:E5(),lastEncounter:E5(),occurences:1},null!=n&&(s.data=n),i.next=9,r.errorDAO.create(s);case 9:i.next=14;break;case 11:return u=o[0].id,c=o[0].data,i.next=14,r.errorDAO.update(u,{lastEncounter:E5(),occurences:c.occurences+1});case 14:case"end":return i.stop()}},i)}))()}}],[{key:"setSingletonInstance",value:function(t){e.singleton=sB.of(t)}},{key:"logErrorAndFail",value:function(t,n,r){throw e.logError(t,n,r),new Error("".concat(t,": ").concat(n," (extra data: ").concat(JSON.stringify(r),")"))}},{key:"logError",value:function(e,t,n){if(this.singleton.isAbsent())throw new Error("".concat(e,": ").concat(t," (extra data: ").concat(JSON.stringify(n),")"));return this.singleton.get().logError(e,t,n),K5.failure(e+": "+t)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Pk(J5),Pk(qM))},e.\u0275prov=Eg({token:e,factory:e.\u0275fac,providedIn:"root"}),e}();function X5(e,t){if(!1===e)throw Q5.logError("Assertion failure",t),new Error("Assertion failure: ".concat(t))}var e6=rp(function e(t){tp(this,e),this.value=t});e6.HARD_DRAW=new e6(0),e6.RESIGN=new e6(1),e6.ESCAPE=new e6(2),e6.VICTORY=new e6(3),e6.TIMEOUT=new e6(4),e6.UNACHIEVED=new e6(5),e6.AGREED_DRAW_BY_ZERO=new e6(6),e6.AGREED_DRAW_BY_ONE=new e6(7);var t6=function(){function e(t,n){tp(this,e),this.id=t,this.data=n}return rp(e,[{key:"getTurn",value:function(){return this.data.turn}},{key:"isHardDraw",value:function(){return this.data.result===e6.HARD_DRAW.value}},{key:"isAgreedDraw",value:function(){return this.data.result===e6.AGREED_DRAW_BY_ZERO.value||this.data.result===e6.AGREED_DRAW_BY_ONE.value}},{key:"getDrawAccepter",value:function(){return this.data.result===e6.AGREED_DRAW_BY_ZERO.value?this.data.playerZero:(X5(this.data.result===e6.AGREED_DRAW_BY_ONE.value,"should not access getDrawAccepter when no draw accepted!"),nB.getNonNullable(this.data.playerOne))}},{key:"isWin",value:function(){return this.data.result===e6.VICTORY.value}},{key:"isTimeout",value:function(){return this.data.result===e6.TIMEOUT.value}},{key:"isResign",value:function(){return this.data.result===e6.RESIGN.value}},{key:"getWinner",value:function(){return sB.ofNullable(this.data.winner)}},{key:"getLoser",value:function(){return sB.ofNullable(this.data.loser)}},{key:"setWinnerAndLoser",value:function(t,n){return new e(this.id,Mv(Mv({},this.data),{},{winner:t,loser:n}))}}]),e}(),n6=function(){var e=function(e){Gv(n,e);var t=$v(n);function n(e){var r;return tp(this,n),r=t.call(this,"parties",e),rB(n.VERBOSE,"PartDAO.constructor"),r}return rp(n,[{key:"updateAndBumpIndex",value:function(e,t,n,r){var i=this;return tB(regeneratorRuntime.mark(function a(){return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(r=Mv(Mv({},r),{},{lastUpdate:{index:n+1,player:t.value}}),i.update(e,r)));case 1:case"end":return a.stop()}},a)}))()}},{key:"observeActiveParts",value:function(e){return this.observingWhere([["result","==",e6.UNACHIEVED.value]],e)}},{key:"userHasActivePart",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.findWhere([["playerZero","==",e],["result","==",e6.UNACHIEVED.value]]);case 2:return r=n.sent,n.next=5,t.findWhere([["playerOne","==",e],["result","==",e6.UNACHIEVED.value]]);case 5:return i=n.sent,n.abrupt("return",r.length>0||i.length>0);case 7:case"end":return n.stop()}},n)}))()}}]),n}(W5);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(Pk(S5))},e.\u0275prov=Eg({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),r6=function(){var e=function(e){Gv(n,e);var t=$v(n);function n(e){var r;return tp(this,n),r=t.call(this,"chats",e),rB(n.VERBOSE,"ChatDAO.constructor"),r}return rp(n,[{key:"addMessage",value:function(e,t){var n=this;return tB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",n.subCollectionDAO(e,"messages").create(t));case 1:case"end":return r.stop()}},r)}))()}},{key:"getLastMessages",value:function(e,t){var n=this;return tB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",n.subCollectionDAO(e,"messages").findWhere([],"postedTime",t));case 1:case"end":return r.stop()}},r)}))()}},{key:"subscribeToMessages",value:function(e,t){return this.subCollectionDAO(e,"messages").observingWhere([],t,"postedTime")}}]),n}(W5);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(Pk(S5))},e.\u0275prov=Eg({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),i6=function(){var n=rp(function e(){tp(this,e)});return n.CANNOT_SEND_MESSAGE=function(){return $localize(e||(e=Rv(["You're not allowed to send a message here."])))},n.FORBIDDEN_MESSAGE=function(){return $localize(t||(t=Rv(["This message is forbidden."])))},n}(),a6=function(){var e=function(){function e(t){tp(this,e),this.chatDAO=t,this.followedChatId=sB.empty(),rB(e.VERBOSE,"ChatService.constructor")}return rp(e,[{key:"startObserving",value:function(t,n){rB(e.VERBOSE,"ChatService.startObserving "+t),this.followedChatId.isAbsent()?(rB(e.VERBOSE,"[start watching chat "+t),this.followedChatId=sB.of(t),this.followedChatUnsubscribe=this.chatDAO.subscribeToMessages(t,n)):this.followedChatId.equalsValue(t)?Q5.logErrorAndFail("ChatService","Already observing same chat",{chatId:t}):Q5.logErrorAndFail("ChatService","Already observing another chat",{chatId:t,followedChatId:this.followedChatId.get()})}},{key:"stopObserving",value:function(){if(!this.isObserving())throw new Error("ChatService.stopObserving should not be called if not observing");rB(e.VERBOSE,"stopped watching chat "+this.followedChatId+"]"),this.followedChatId=sB.empty(),this.followedChatUnsubscribe()}},{key:"isObserving",value:function(){return this.followedChatId.isPresent()}},{key:"deleteChat",value:function(t){var n=this;return tB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(rB(e.VERBOSE,"ChatService.deleteChat "+t),n.chatDAO.delete(t)));case 1:case"end":return r.stop()}},r)}))()}},{key:"createNewChat",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t.chatDAO.set(e,{}));case 1:case"end":return n.stop()}},n)}))()}},{key:"sendMessage",value:function(e,t,n){var r=this;return tB(regeneratorRuntime.mark(function i(){var a,o;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(!r.followedChatId.isAbsent()){i.next=2;break}return i.abrupt("return",K5.failure("Cannot send message if not observing chat"));case 2:if(a=r.followedChatId.get(),!1!==r.userCanSendMessage(e.name,a)){i.next=5;break}return i.abrupt("return",K5.failure(i6.CANNOT_SEND_MESSAGE()));case 5:if(!r.isForbiddenMessage(t)){i.next=7;break}return i.abrupt("return",K5.failure(i6.FORBIDDEN_MESSAGE()));case 7:return o={content:t,sender:e,postedTime:E5(),currentTurn:n},i.next=10,r.chatDAO.addMessage(a,o);case 10:return i.abrupt("return",K5.SUCCESS);case 11:case"end":return i.stop()}},i)}))()}},{key:"userCanSendMessage",value:function(e,t){return""!==e}},{key:"isForbiddenMessage",value:function(e){return""===e}},{key:"ngOnDestroy",value:function(){this.isObserving()&&this.stopObserving()}}]),e}();return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(Pk(r6))},e.\u0275prov=Eg({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),o6=rp(function e(t,n,r){tp(this,e),this.onDocumentCreated=t,this.onDocumentModified=n,this.onDocumentDeleted=r}),s6=function(){var e=function(e){Gv(n,e);var t=$v(n);function n(e){var r;return tp(this,n),r=t.call(this,n.COLLECTION_NAME,e),rB(n.VERBOSE,"JoueursDAO.constructor"),r}return rp(n,[{key:"usernameIsAvailable",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.findWhere([["username","==",e]]);case 2:return n.t0=n.sent.length,n.abrupt("return",0===n.t0);case 4:case"end":return n.stop()}},n)}))()}},{key:"setUsername",value:function(e,t){var n=this;return tB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.update(e,{username:t});case 2:case"end":return r.stop()}},r)}))()}},{key:"markVerified",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.update(e,{verified:!0});case 2:case"end":return n.stop()}},n)}))()}},{key:"observeUserByUsername",value:function(e,t){return this.observingWhere([["username","==",e],["verified","==",!0]],t)}},{key:"observeActiveUsers",value:function(e){return this.observingWhere([["state","==","online"],["verified","==",!0]],e)}}]),n}(W5);return e.VERBOSE=!1,e.COLLECTION_NAME="joueurs",e.\u0275fac=function(t){return new(t||e)(Pk(S5))},e.\u0275prov=Eg({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),u6=function(){var e=function(){function e(t){tp(this,e),this.userDAO=t,this.activeUsersBS=new QA([]),this.activeUsersObs=this.activeUsersBS.asObservable()}return rp(e,[{key:"startObserving",value:function(){var t=this;rB(e.VERBOSE,"ActiveUsersService.startObservingActiveUsers");var n=new o6(function(n){var r;rB(e.VERBOSE,"our DAO gave us "+n.length+" new user(s)");var i=(r=t.activeUsersBS.value).concat.apply(r,Kv(n));t.activeUsersBS.next(t.sort(i))},function(n){var r=t.activeUsersBS.value;rB(e.VERBOSE,"our DAO updated "+n.length+" user(s)");var i,a=Qv(n);try{var o=function(){var e=i.value;r.forEach(function(t){t.id===e.id&&(t.data=e.data)}),r=t.sort(r)};for(a.s();!(i=a.n()).done;)o()}catch(s){a.e(s)}finally{a.f()}t.activeUsersBS.next(r)},function(e){var n=t.activeUsersBS.value.filter(function(t){return!e.some(function(e){return e.id===t.id})});t.activeUsersBS.next(t.sort(n))});this.unsubscribe=this.userDAO.observeActiveUsers(n)}},{key:"stopObserving",value:function(){this.unsubscribe(),this.activeUsersBS.next([])}},{key:"sort",value:function(e){return e.sort(function(e,t){return nB.getNonNullable(nB.getNonNullable(e.data).last_changed).seconds-nB.getNonNullable(nB.getNonNullable(t.data).last_changed).seconds})}}]),e}();return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(Pk(s6))},e.\u0275prov=Eg({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),c6=function(){var e=function(){function e(t,n){tp(this,e),this.activeUsersService=t,this.joueursDAO=n}return rp(e,[{key:"getActiveUsersObs",value:function(){return this.activeUsersService.startObserving(),this.activeUsersService.activeUsersObs}},{key:"unSubFromActiveUsersObs",value:function(){this.activeUsersService.stopObserving()}},{key:"observeUserByUsername",value:function(e,t){return this.joueursDAO.observeUserByUsername(e,t)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Pk(u6),Pk(s6))},e.\u0275prov=Eg({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),l6=function(e){Gv(n,e);var t=$v(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1/0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:zH;return tp(this,n),(e=t.call(this))._bufferSize=r,e._windowTime=i,e._timestampProvider=a,e._buffer=[],e._infiniteTimeWindow=!0,e._infiniteTimeWindow=i===1/0,e._bufferSize=Math.max(1,r),e._windowTime=Math.max(1,i),e}return rp(n,[{key:"next",value:function(e){var t=this.isStopped,r=this._buffer,i=this._infiniteTimeWindow,a=this._timestampProvider,o=this._windowTime;t||(r.push(e),!i&&r.push(a.now()+o)),this._trimBuffer(),zv(Yv(n.prototype),"next",this).call(this,e)}},{key:"_subscribe",value:function(e){this._throwIfClosed(),this._trimBuffer();for(var t=this._innerSubscribe(e),n=this._infiniteTimeWindow,r=this._buffer.slice(),i=0;i<r.length&&!e.closed;i+=n?1:2)e.next(r[i]);return this._checkFinalizedStatuses(e),t}},{key:"_trimBuffer",value:function(){var e=this._bufferSize,t=this._timestampProvider,n=this._buffer,r=this._infiniteTimeWindow,i=(r?1:2)*e;if(e<1/0&&i<n.length&&n.splice(0,n.length-i),!r){for(var a=t.now(),o=0,s=1;s<n.length&&n[s]<=a;s+=2)o=s;o&&n.splice(0,o+1)}}}]),n}(Ap),h6="@firebase/database",f6="",d6=function(){function e(t){tp(this,e),this.domStorage_=t,this.prefix_="firebase:"}return rp(e,[{key:"set",value:function(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),RB(t))}},{key:"get",value:function(e){var t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:AB(t)}},{key:"remove",value:function(e){this.domStorage_.removeItem(this.prefixedName_(e))}},{key:"prefixedName_",value:function(e){return this.prefix_+e}},{key:"toString",value:function(){return this.domStorage_.toString()}}]),e}(),v6=function(){function e(){tp(this,e),this.cache_={},this.isInMemoryStorage=!0}return rp(e,[{key:"set",value:function(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t}},{key:"get",value:function(e){return MB(this.cache_,e)?this.cache_[e]:null}},{key:"remove",value:function(e){delete this.cache_[e]}}]),e}(),p6=function(e){try{if("undefined"!=typeof window&&void 0!==window[e]){var t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new d6(t)}}catch(n){}return new v6},g6=p6("localStorage"),y6=p6("sessionStorage"),m6=new oV("@firebase/database"),k6=function(){var e=1;return function(){return e++}}(),_6=function(e){var t=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var i=e.charCodeAt(r);if(i>=55296&&i<=56319){var a=i-55296;r++,uB(r<e.length,"Surrogate pair missing trail surrogate."),i=65536+(a<<10)+(e.charCodeAt(r)-56320)}i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):i<65536?(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t}(e),n=new GB;n.update(t);var r=n.digest();return hB.encodeByteArray(r)},w6=function e(){for(var t="",n=0;n<arguments.length;n++){var r=n<0||arguments.length<=n?void 0:arguments[n];Array.isArray(r)||r&&"object"==typeof r&&"number"==typeof r.length?t+=e.apply(null,r):t+="object"==typeof r?RB(r):r,t+=" "}return t},C6=null,b6=!0,E6=function(){if(!0===b6&&(b6=!1,null===C6&&!0===y6.get("logging_enabled")&&(uB(!0,"Can't turn on custom loggers persistently."),m6.logLevel=tV.VERBOSE,C6=m6.log.bind(m6))),C6){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=w6.apply(null,t);C6(r)}},S6=function(e){return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];E6.apply(void 0,[e].concat(n))}},P6=function(){var e="FIREBASE INTERNAL ERROR: "+w6.apply(void 0,arguments);m6.error(e)},O6=function(){var e="FIREBASE FATAL ERROR: ".concat(w6.apply(void 0,arguments));throw m6.error(e),new Error(e)},T6=function(){var e="FIREBASE WARNING: "+w6.apply(void 0,arguments);m6.warn(e)},I6=function(e){return"number"==typeof e&&(e!=e||e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY)},x6="[MIN_NAME]",A6="[MAX_NAME]",R6=function(e,t){if(e===t)return 0;if(e===x6||t===A6)return-1;if(t===x6||e===A6)return 1;var n=U6(e),r=U6(t);return null!==n?null!==r?n-r==0?e.length-t.length:n-r:-1:null!==r?1:e<t?-1:1},N6=function(e,t){return e===t?0:e<t?-1:1},M6=function(e,t){if(t&&e in t)return t[e];throw new Error("Missing required key ("+e+") in object: "+RB(t))},D6=function e(t){if("object"!=typeof t||null===t)return RB(t);var n=[];for(var r in t)n.push(r);n.sort();for(var i="{",a=0;a<n.length;a++)0!==a&&(i+=","),i+=RB(n[a]),i+=":",i+=e(t[n[a]]);return i+="}"},L6=function(e,t){var n=e.length;if(n<=t)return[e];for(var r=[],i=0;i<n;i+=t)r.push(e.substring(i,i+t>n?n:i+t));return r};function F6(e,t){for(var n in e)e.hasOwnProperty(n)&&t(n,e[n])}var B6=function(e){uB(!I6(e),"Invalid JSON number");var t,n,r,i,a,o=1023;0===e?(n=0,r=0,t=1/e==-1/0?1:0):(t=e<0,(e=Math.abs(e))>=Math.pow(2,1-o)?(n=(i=Math.min(Math.floor(Math.log(e)/Math.LN2),o))+o,r=Math.round(e*Math.pow(2,52-i)-Math.pow(2,52))):(n=0,r=Math.round(e/Math.pow(2,-1074))));var s=[];for(a=52;a;a-=1)s.push(r%2?1:0),r=Math.floor(r/2);for(a=11;a;a-=1)s.push(n%2?1:0),n=Math.floor(n/2);s.push(t?1:0),s.reverse();var u=s.join(""),c="";for(a=0;a<64;a+=8){var l=parseInt(u.substr(a,8),2).toString(16);1===l.length&&(l="0"+l),c+=l}return c.toLowerCase()},V6=new RegExp("^-?(0*)\\d{1,10}$"),U6=function(e){if(V6.test(e)){var t=Number(e);if(t>=-2147483648&&t<=2147483647)return t}return null},z6=function(e){try{e()}catch(t){setTimeout(function(){throw T6("Exception was thrown by user callback.",t.stack||""),t},Math.floor(0))}},H6=function(e,t){var n=setTimeout(e,t);return"object"==typeof n&&n.unref&&n.unref(),n},G6=function(){function e(t,n){var r=this;tp(this,e),this.appName_=t,this.appCheckProvider=n,this.appCheck=null==n?void 0:n.getImmediate({optional:!0}),this.appCheck||null==n||n.get().then(function(e){return r.appCheck=e})}return rp(e,[{key:"getToken",value:function(e){var t=this;return this.appCheck?this.appCheck.getToken(e):new Promise(function(n,r){setTimeout(function(){t.appCheck?t.getToken(e).then(n,r):n(null)},0)})}},{key:"addTokenChangeListener",value:function(e){var t;null===(t=this.appCheckProvider)||void 0===t||t.get().then(function(t){return t.addTokenListener(e)})}},{key:"notifyForInvalidToken",value:function(){T6('Provided AppCheck credentials for the app named "'.concat(this.appName_,'" are invalid. This usually indicates your app was not initialized correctly.'))}}]),e}(),q6=function(){function e(t,n,r){var i=this;tp(this,e),this.appName_=t,this.firebaseOptions_=n,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(function(e){return i.auth_=e})}return rp(e,[{key:"getToken",value:function(e){var t=this;return this.auth_?this.auth_.getToken(e).catch(function(e){return e&&"auth/token-not-initialized"===e.code?(E6("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(e)}):new Promise(function(n,r){setTimeout(function(){t.auth_?t.getToken(e).then(n,r):n(null)},0)})}},{key:"addTokenChangeListener",value:function(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(function(t){return t.addAuthTokenListener(e)})}},{key:"removeTokenChangeListener",value:function(e){this.authProvider_.get().then(function(t){return t.removeAuthTokenListener(e)})}},{key:"notifyForInvalidToken",value:function(){var e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';e+="credential"in this.firebaseOptions_?'Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?'Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':'Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',T6(e)}}]),e}(),$6=function(){var e=function(){function e(t){tp(this,e),this.accessToken=t}return rp(e,[{key:"getToken",value:function(e){return Promise.resolve({accessToken:this.accessToken})}},{key:"addTokenChangeListener",value:function(e){e(this.accessToken)}},{key:"removeTokenChangeListener",value:function(e){}},{key:"notifyForInvalidToken",value:function(){}}]),e}();return e.OWNER="owner",e}(),W6=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,j6="long_polling",Z6=function(){function e(t,n,r,i){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",s=arguments.length>6&&void 0!==arguments[6]&&arguments[6];tp(this,e),this.secure=n,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=a,this.persistenceKey=o,this.includeNamespaceInQueryParams=s,this._host=t.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=g6.get("host:"+t)||this._host}return rp(e,[{key:"isCacheableHost",value:function(){return"s-"===this.internalHost.substr(0,2)}},{key:"isCustomHost",value:function(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}},{key:"host",get:function(){return this._host},set:function(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&g6.set("host:"+this._host,this.internalHost))}},{key:"toString",value:function(){var e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}},{key:"toURLString",value:function(){return"".concat(this.secure?"https://":"http://").concat(this.host,"/").concat(this.includeNamespaceInQueryParams?"?ns=".concat(this.namespace):"")}}]),e}();function Y6(e,t,n){var r;if(uB("string"==typeof t,"typeof type must == string"),uB("object"==typeof n,"typeof params must == object"),"websocket"===t)r=(e.secure?"wss://":"ws://")+e.internalHost+"/.ws?";else{if(t!==j6)throw new Error("Unknown connection type: "+t);r=(e.secure?"https://":"http://")+e.internalHost+"/.lp?"}(function(e){return e.host!==e.internalHost||e.isCustomHost()||e.includeNamespaceInQueryParams})(e)&&(n.ns=e.namespace);var i=[];return F6(n,function(e,t){i.push(e+"="+t)}),r+i.join("&")}var K6=function(){function e(){tp(this,e),this.counters_={}}return rp(e,[{key:"incrementCounter",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;MB(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}},{key:"get",value:function(){return pB(this.counters_)}}]),e}(),J6={},Q6={};function X6(e){var t=e.toString();return J6[t]||(J6[t]=new K6),J6[t]}var e8=function(){function e(t){tp(this,e),this.onMessage_=t,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}return rp(e,[{key:"closeAfter",value:function(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}},{key:"handleResponse",value:function(e,t){var n=this,r=function(){var e=n.pendingResponses[n.currentResponseNum];delete n.pendingResponses[n.currentResponseNum];for(var t=function(t){e[t]&&z6(function(){n.onMessage_(e[t])})},r=0;r<e.length;++r)t(r);if(n.currentResponseNum===n.closeAfterResponse)return n.onClose&&(n.onClose(),n.onClose=null),"break";n.currentResponseNum++};for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){if("break"===r())break}}}]),e}(),t8=function(){function e(t,n,r,i,a,o,s){var u=this;tp(this,e),this.connId=t,this.repoInfo=n,this.applicationId=r,this.appCheckToken=i,this.authToken=a,this.transportSessionId=o,this.lastSessionId=s,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=S6(t),this.stats_=X6(n),this.urlFn=function(e){return u.appCheckToken&&(e.ac=u.appCheckToken),Y6(n,j6,e)}}return rp(e,[{key:"open",value:function(e,t){var n=this;this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new e8(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(function(){n.log_("Timed out trying to connect."),n.onClosed_(),n.connectTimeoutTimer_=null},Math.floor(3e4)),function(e){if("complete"===document.readyState)e();else{var t=!1,n=function n(){document.body?t||(t=!0,e()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",function(){"complete"===document.readyState&&n()}),window.attachEvent("onload",n))}}(function(){if(!n.isClosed_){n.scriptTagHolder=new n8(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var i=t[0],a=t[1],o=t[2];t[3],t[4];if(n.incrementIncomingBytes_(t),n.scriptTagHolder)if(n.connectTimeoutTimer_&&(clearTimeout(n.connectTimeoutTimer_),n.connectTimeoutTimer_=null),n.everConnected_=!0,"start"===i)n.id=a,n.password=o;else{if("close"!==i)throw new Error("Unrecognized command received: "+i);a?(n.scriptTagHolder.sendNewPolls=!1,n.myPacketOrderer.closeAfter(a,function(){n.onClosed_()})):n.onClosed_()}},function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var i=t[0],a=t[1];n.incrementIncomingBytes_(t),n.myPacketOrderer.handleResponse(i,a)},function(){n.onClosed_()},n.urlFn);var e={start:"t"};e.ser=Math.floor(1e8*Math.random()),n.scriptTagHolder.uniqueCallbackIdentifier&&(e.cb=n.scriptTagHolder.uniqueCallbackIdentifier),e.v="5",n.transportSessionId&&(e.s=n.transportSessionId),n.lastSessionId&&(e.ls=n.lastSessionId),n.applicationId&&(e.p=n.applicationId),n.appCheckToken&&(e.ac=n.appCheckToken),"undefined"!=typeof location&&location.hostname&&W6.test(location.hostname)&&(e.r="f");var t=n.urlFn(e);n.log_("Connecting via long-poll to "+t),n.scriptTagHolder.addTag(t,function(){})}})}},{key:"start",value:function(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}},{key:"markConnectionHealthy",value:function(){}},{key:"shutdown_",value:function(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}},{key:"onClosed_",value:function(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}},{key:"close",value:function(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}},{key:"send",value:function(e){var t=RB(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);for(var n=fB(t),r=L6(n,1840),i=0;i<r.length;i++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[i]),this.curSegmentNum++}},{key:"addDisconnectPingFrame",value:function(e,t){this.myDisconnFrame=document.createElement("iframe");var n={dframe:"t"};n.id=e,n.pw=t,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}},{key:"incrementIncomingBytes_",value:function(e){var t=RB(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}],[{key:"forceAllow",value:function(){e.forceAllow_=!0}},{key:"forceDisallow",value:function(){e.forceDisallow_=!0}},{key:"isAvailable",value:function(){return!(!e.forceAllow_&&(e.forceDisallow_||"undefined"==typeof document||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI))}}]),e}(),n8=function(){function e(t,n,r,i){tp(this,e),this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,this.uniqueCallbackIdentifier=k6(),window["pLPCommand"+this.uniqueCallbackIdentifier]=t,window["pRTLPCB"+this.uniqueCallbackIdentifier]=n,this.myIFrame=e.createIFrame_();var a="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,"javascript:".length)&&(a='<script>document.domain="'+document.domain+'";<\/script>');var o="<html><body>"+a+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(s){E6("frame writing exception"),s.stack&&E6(s.stack),E6(s)}}return rp(e,[{key:"close",value:function(){var e=this;this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout(function(){null!==e.myIFrame&&(document.body.removeChild(e.myIFrame),e.myIFrame=null)},Math.floor(0)));var t=this.onDisconnect;t&&(this.onDisconnect=null,t())}},{key:"startLongPoll",value:function(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}},{key:"newRequest_",value:function(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;var e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;for(var t=this.urlFn(e),n="",r=0;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+30+n.length<=1870;){var i=this.pendingSegs.shift();n=n+"&seg"+r+"="+i.seg+"&ts"+r+"="+i.ts+"&d"+r+"="+i.d,r++}return t+=n,this.addLongPollTag_(t,this.currentSerial),!0}return!1}},{key:"enqueueSegment",value:function(e,t,n){this.pendingSegs.push({seg:e,ts:t,d:n}),this.alive&&this.newRequest_()}},{key:"addLongPollTag_",value:function(e,t){var n=this;this.outstandingRequests.add(t);var r=function(){n.outstandingRequests.delete(t),n.newRequest_()},i=setTimeout(r,Math.floor(25e3));this.addTag(e,function(){clearTimeout(i),r()})}},{key:"addTag",value:function(e,t){var n=this;setTimeout(function(){try{if(!n.sendNewPolls)return;var r=n.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){var e=r.readyState;(!e||"loaded"===e||"complete"===e)&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),t())},r.onerror=function(){E6("Long-poll script failed to load: "+e),n.sendNewPolls=!1,n.close()},n.myIFrame.doc.body.appendChild(r)}catch(i){}},Math.floor(1))}}],[{key:"createIFrame_",value:function(){var e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||E6("No IE domain setting required")}catch(n){var t=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+t+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}}]),e}(),r8=null;"undefined"!=typeof MozWebSocket?r8=MozWebSocket:"undefined"!=typeof WebSocket&&(r8=WebSocket);var i8=function(){var e=function(){function e(t,n,r,i,a,o,s){tp(this,e),this.connId=t,this.applicationId=r,this.appCheckToken=i,this.authToken=a,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=S6(this.connId),this.stats_=X6(n),this.connURL=e.connectionURL_(n,o,s,i),this.nodeAdmin=n.nodeAdmin}return rp(e,[{key:"open",value:function(e,t){var n=this;this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,g6.set("previous_websocket_failure",!0);try{this.mySock=new r8(this.connURL,[],{headers:{"X-Firebase-GMPID":this.applicationId||"","X-Firebase-AppCheck":this.appCheckToken||""}})}catch(i){this.log_("Error instantiating WebSocket.");var r=i.message||i.data;return r&&this.log_(r),void this.onClosed_()}this.mySock.onopen=function(){n.log_("Websocket connected."),n.everConnected_=!0},this.mySock.onclose=function(){n.log_("Websocket connection was disconnected."),n.mySock=null,n.onClosed_()},this.mySock.onmessage=function(e){n.handleIncomingFrame(e)},this.mySock.onerror=function(e){n.log_("WebSocket error.  Closing connection.");var t=e.message||e.data;t&&n.log_(t),n.onClosed_()}}},{key:"start",value:function(){}},{key:"markConnectionHealthy",value:function(){g6.remove("previous_websocket_failure")}},{key:"appendFrame_",value:function(e){if(this.frames.push(e),this.frames.length===this.totalFrames){var t=this.frames.join("");this.frames=null;var n=AB(t);this.onMessage(n)}}},{key:"handleNewFrameCount_",value:function(e){this.totalFrames=e,this.frames=[]}},{key:"extractFrameCount_",value:function(e){if(uB(null===this.frames,"We already have a frame buffer"),e.length<=6){var t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}},{key:"handleIncomingFrame",value:function(e){if(null!==this.mySock){var t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(t);else{var n=this.extractFrameCount_(t);null!==n&&this.appendFrame_(n)}}}},{key:"send",value:function(e){this.resetKeepAlive();var t=RB(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);var n=L6(t,16384);n.length>1&&this.sendString_(String(n.length));for(var r=0;r<n.length;r++)this.sendString_(n[r])}},{key:"shutdown_",value:function(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}},{key:"onClosed_",value:function(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}},{key:"close",value:function(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}},{key:"resetKeepAlive",value:function(){var e=this;clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(function(){e.mySock&&e.sendString_("0"),e.resetKeepAlive()},Math.floor(45e3))}},{key:"sendString_",value:function(e){try{this.mySock.send(e)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}],[{key:"connectionURL_",value:function(e,t,n,r){var i={v:"5"};return"undefined"!=typeof location&&location.hostname&&W6.test(location.hostname)&&(i.r="f"),t&&(i.s=t),n&&(i.ls=n),r&&(i.ac=r),Y6(e,"websocket",i)}},{key:"forceDisallow",value:function(){e.forceDisallow_=!0}},{key:"isAvailable",value:function(){var t=!1;if("undefined"!=typeof navigator&&navigator.userAgent){var n=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);n&&n.length>1&&parseFloat(n[1])<4.4&&(t=!0)}return!t&&null!==r8&&!e.forceDisallow_}},{key:"previouslyFailed",value:function(){return g6.isInMemoryStorage||!0===g6.get("previous_websocket_failure")}}]),e}();return e.responsesRequiredToBeHealthy=2,e.healthyTimeout=3e4,e}(),a8=function(){function e(t){tp(this,e),this.initTransports_(t)}return rp(e,[{key:"initTransports_",value:function(t){var n=i8&&i8.isAvailable(),r=n&&!i8.previouslyFailed();if(t.webSocketOnly&&(n||T6("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.transports_=[i8];else{var i,a=this.transports_=[],o=Qv(e.ALL_TRANSPORTS);try{for(o.s();!(i=o.n()).done;){var s=i.value;s&&s.isAvailable()&&a.push(s)}}catch(u){o.e(u)}finally{o.f()}}}},{key:"initialTransport",value:function(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}},{key:"upgradeTransport",value:function(){return this.transports_.length>1?this.transports_[1]:null}}],[{key:"ALL_TRANSPORTS",get:function(){return[t8,i8]}}]),e}(),o8=function(){function e(t,n,r,i,a,o,s,u,c,l){tp(this,e),this.id=t,this.repoInfo_=n,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=a,this.onMessage_=o,this.onReady_=s,this.onDisconnect_=u,this.onKill_=c,this.lastSessionId=l,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=S6("c:"+this.id+":"),this.transportManager_=new a8(n),this.log_("Connection created"),this.start_()}return rp(e,[{key:"start_",value:function(){var e=this,t=this.transportManager_.initialTransport();this.conn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(function(){e.conn_&&e.conn_.open(n,r)},Math.floor(0));var i=t.healthyTimeout||0;i>0&&(this.healthyTimeout_=H6(function(){e.healthyTimeout_=null,e.isHealthy_||(e.conn_&&e.conn_.bytesReceived>102400?(e.log_("Connection exceeded healthy timeout but has received "+e.conn_.bytesReceived+" bytes.  Marking connection healthy."),e.isHealthy_=!0,e.conn_.markConnectionHealthy()):e.conn_&&e.conn_.bytesSent>10240?e.log_("Connection exceeded healthy timeout but has sent "+e.conn_.bytesSent+" bytes.  Leaving connection alive."):(e.log_("Closing unhealthy connection after timeout."),e.close()))},Math.floor(i)))}},{key:"nextTransportId_",value:function(){return"c:"+this.id+":"+this.connectionCount++}},{key:"disconnReceiver_",value:function(e){var t=this;return function(n){e===t.conn_?t.onConnectionLost_(n):e===t.secondaryConn_?(t.log_("Secondary connection lost."),t.onSecondaryConnectionLost_()):t.log_("closing an old connection")}}},{key:"connReceiver_",value:function(e){var t=this;return function(n){2!==t.state_&&(e===t.rx_?t.onPrimaryMessageReceived_(n):e===t.secondaryConn_?t.onSecondaryMessageReceived_(n):t.log_("message on old connection"))}}},{key:"sendRequest",value:function(e){this.sendData_({t:"d",d:e})}},{key:"tryCleanupConnection",value:function(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}},{key:"onSecondaryControl_",value:function(e){if("t"in e){var t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}},{key:"onSecondaryMessageReceived_",value:function(e){var t=M6("t",e),n=M6("d",e);if("c"===t)this.onSecondaryControl_(n);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(n)}}},{key:"upgradeIfSecondaryHealthy_",value:function(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}},{key:"proceedWithUpgrade_",value:function(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}},{key:"onPrimaryMessageReceived_",value:function(e){var t=M6("t",e),n=M6("d",e);"c"===t?this.onControl_(n):"d"===t&&this.onDataMessage_(n)}},{key:"onDataMessage_",value:function(e){this.onPrimaryResponse_(),this.onMessage_(e)}},{key:"onPrimaryResponse_",value:function(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}},{key:"onControl_",value:function(e){var t=M6("t",e);if("d"in e){var n=e.d;if("h"===t)this.onHandshake_(n);else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(var r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(n):"r"===t?this.onReset_(n):"e"===t?P6("Server Error: "+n):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):P6("Unknown control packet command: "+t)}}},{key:"onHandshake_",value:function(e){var t=e.ts,n=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),"5"!==n&&T6("Protocol version mismatch detected"),this.tryStartUpgrade_())}},{key:"tryStartUpgrade_",value:function(){var e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}},{key:"startUpgrade_",value:function(e){var t=this;this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),H6(function(){t.secondaryConn_&&(t.log_("Timed out trying to upgrade."),t.secondaryConn_.close())},Math.floor(6e4))}},{key:"onReset_",value:function(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())}},{key:"onConnectionEstablished_",value:function(e,t){var n=this;this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):H6(function(){n.sendPingOnPrimaryIfNecessary_()},Math.floor(5e3))}},{key:"sendPingOnPrimaryIfNecessary_",value:function(){!this.isHealthy_&&1===this.state_&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}},{key:"onSecondaryConnectionLost_",value:function(){var e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}},{key:"onConnectionLost_",value:function(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(g6.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}},{key:"onConnectionShutdown_",value:function(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}},{key:"sendData_",value:function(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)}},{key:"close",value:function(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}},{key:"closeConnections_",value:function(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}]),e}(),s8=function(){function e(){tp(this,e)}return rp(e,[{key:"put",value:function(e,t,n,r){}},{key:"merge",value:function(e,t,n,r){}},{key:"refreshAuthToken",value:function(e){}},{key:"refreshAppCheckToken",value:function(e){}},{key:"onDisconnectPut",value:function(e,t,n){}},{key:"onDisconnectMerge",value:function(e,t,n){}},{key:"onDisconnectCancel",value:function(e,t){}},{key:"reportStats",value:function(e){}}]),e}(),u8=function(){function e(t){tp(this,e),this.allowedEvents_=t,this.listeners_={},uB(Array.isArray(t)&&t.length>0,"Requires a non-empty array")}return rp(e,[{key:"trigger",value:function(e){if(Array.isArray(this.listeners_[e])){for(var t=Kv(this.listeners_[e]),n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];for(var a=0;a<t.length;a++)t[a].callback.apply(t[a].context,r)}}},{key:"on",value:function(e,t,n){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:n});var r=this.getInitialEvent(e);r&&t.apply(n,r)}},{key:"off",value:function(e,t,n){this.validateEventType_(e);for(var r=this.listeners_[e]||[],i=0;i<r.length;i++)if(r[i].callback===t&&(!n||n===r[i].context))return void r.splice(i,1)}},{key:"validateEventType_",value:function(e){uB(this.allowedEvents_.find(function(t){return t===e}),"Unknown event: "+e)}}]),e}(),c8=function(e){Gv(n,e);var t=$v(n);function n(){var e;return tp(this,n),(e=t.call(this,["online"])).online_=!0,"undefined"!=typeof window&&void 0!==window.addEventListener&&!wB()&&(window.addEventListener("online",function(){e.online_||(e.online_=!0,e.trigger("online",!0))},!1),window.addEventListener("offline",function(){e.online_&&(e.online_=!1,e.trigger("online",!1))},!1)),e}return rp(n,[{key:"getInitialEvent",value:function(e){return uB("online"===e,"Unknown event type: "+e),[this.online_]}},{key:"currentlyOnline",value:function(){return this.online_}}],[{key:"getInstance",value:function(){return new n}}]),n}(u8),l8=function(){function e(t,n){if(tp(this,e),void 0===n){this.pieces_=t.split("/");for(var r=0,i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=t,this.pieceNum_=n}return rp(e,[{key:"toString",value:function(){for(var e="",t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"}}]),e}();function h8(){return new l8("")}function f8(e){return e.pieceNum_>=e.pieces_.length?null:e.pieces_[e.pieceNum_]}function d8(e){return e.pieces_.length-e.pieceNum_}function v8(e){var t=e.pieceNum_;return t<e.pieces_.length&&t++,new l8(e.pieces_,t)}function p8(e){return e.pieceNum_<e.pieces_.length?e.pieces_[e.pieces_.length-1]:null}function g8(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e.pieces_.slice(e.pieceNum_+t)}function y8(e){if(e.pieceNum_>=e.pieces_.length)return null;for(var t=[],n=e.pieceNum_;n<e.pieces_.length-1;n++)t.push(e.pieces_[n]);return new l8(t,0)}function m8(e,t){for(var n=[],r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);if(t instanceof l8)for(var i=t.pieceNum_;i<t.pieces_.length;i++)n.push(t.pieces_[i]);else for(var a=t.split("/"),o=0;o<a.length;o++)a[o].length>0&&n.push(a[o]);return new l8(n,0)}function k8(e){return e.pieceNum_>=e.pieces_.length}function _8(e,t){var n=f8(e),r=f8(t);if(null===n)return t;if(n===r)return _8(v8(e),v8(t));throw new Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+e+")")}function w8(e,t){for(var n=g8(e,0),r=g8(t,0),i=0;i<n.length&&i<r.length;i++){var a=R6(n[i],r[i]);if(0!==a)return a}return n.length===r.length?0:n.length<r.length?-1:1}function C8(e,t){if(d8(e)!==d8(t))return!1;for(var n=e.pieceNum_,r=t.pieceNum_;n<=e.pieces_.length;n++,r++)if(e.pieces_[n]!==t.pieces_[r])return!1;return!0}function b8(e,t){var n=e.pieceNum_,r=t.pieceNum_;if(d8(e)>d8(t))return!1;for(;n<e.pieces_.length;){if(e.pieces_[n]!==t.pieces_[r])return!1;++n,++r}return!0}var E8=rp(function e(t,n){tp(this,e),this.errorPrefix_=n,this.parts_=g8(t,0),this.byteLength_=Math.max(1,this.parts_.length);for(var r=0;r<this.parts_.length;r++)this.byteLength_+=jB(this.parts_[r]);S8(this)});function S8(e){if(e.byteLength_>768)throw new Error(e.errorPrefix_+"has a key path longer than 768 bytes ("+e.byteLength_+").");if(e.parts_.length>32)throw new Error(e.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+P8(e))}function P8(e){return 0===e.parts_.length?"":"in property '"+e.parts_.join(".")+"'"}var O8,T8,I8=function(e){Gv(n,e);var t=$v(n);function n(){var e,r,i;return tp(this,n),e=t.call(this,["visible"]),"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(i="visibilitychange",r="hidden"):void 0!==document.mozHidden?(i="mozvisibilitychange",r="mozHidden"):void 0!==document.msHidden?(i="msvisibilitychange",r="msHidden"):void 0!==document.webkitHidden&&(i="webkitvisibilitychange",r="webkitHidden")),e.visible_=!0,i&&document.addEventListener(i,function(){var t=!document[r];t!==e.visible_&&(e.visible_=t,e.trigger("visible",t))},!1),e}return rp(n,[{key:"getInitialEvent",value:function(e){return uB("visible"===e,"Unknown event type: "+e),[this.visible_]}}],[{key:"getInstance",value:function(){return new n}}]),n}(u8),x8=1e3,A8=function(){var e=function(e){Gv(n,e);var t=$v(n);function n(e,r,i,a,o,s,u,c){var l;if(tp(this,n),(l=t.call(this)).repoInfo_=e,l.applicationId_=r,l.onDataUpdate_=i,l.onConnectStatus_=a,l.onServerInfoUpdate_=o,l.authTokenProvider_=s,l.appCheckTokenProvider_=u,l.authOverride_=c,l.id=n.nextPersistentConnectionId_++,l.log_=S6("p:"+l.id+":"),l.interruptReasons_={},l.listens=new Map,l.outstandingPuts_=[],l.outstandingGets_=[],l.outstandingPutCount_=0,l.outstandingGetCount_=0,l.onDisconnectRequestQueue_=[],l.connected_=!1,l.reconnectDelay_=x8,l.maxReconnectDelay_=3e5,l.securityDebugCallback_=null,l.lastSessionId=null,l.establishConnectionTimer_=null,l.visible_=!1,l.requestCBHash_={},l.requestNumber_=0,l.realtime_=null,l.authToken_=null,l.appCheckToken_=null,l.forceTokenRefresh_=!1,l.invalidAuthTokenCount_=0,l.invalidAppCheckTokenCount_=0,l.firstConnection_=!0,l.lastConnectionAttemptTime_=null,l.lastConnectionEstablishedTime_=null,c)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");return I8.getInstance().on("visible",l.onVisible_,jv(l)),-1===e.host.indexOf("fblocal")&&c8.getInstance().on("online",l.onOnline_,jv(l)),Wv(l)}return rp(n,[{key:"sendRequest",value:function(e,t,n){var r=++this.requestNumber_,i={r:r,a:e,b:t};this.log_(RB(i)),uB(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),n&&(this.requestCBHash_[r]=n)}},{key:"get",value:function(e){var t=this;this.initConnection_();var n=new mB,r={p:e._path.toString(),q:e._queryObject},i={action:"g",request:r,onComplete:function(e){var i=e.d;"ok"===e.s?(t.onDataUpdate_(r.p,i,!1,null),n.resolve(i)):n.reject(i)}};this.outstandingGets_.push(i),this.outstandingGetCount_++;var a=this.outstandingGets_.length-1;return this.connected_||setTimeout(function(){var e=t.outstandingGets_[a];void 0===e||i!==e||(delete t.outstandingGets_[a],t.outstandingGetCount_--,0===t.outstandingGetCount_&&(t.outstandingGets_=[]),t.log_("get "+a+" timed out on connection"),n.reject(new Error("Client is offline.")))},3e3),this.connected_&&this.sendGet_(a),n.promise}},{key:"listen",value:function(e,t,n,r){this.initConnection_();var i=e._queryIdentifier,a=e._path.toString();this.log_("Listen called for "+a+" "+i),this.listens.has(a)||this.listens.set(a,new Map),uB(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),uB(!this.listens.get(a).has(i),"listen() called twice for same path/queryId.");var o={onComplete:r,hashFn:t,query:e,tag:n};this.listens.get(a).set(i,o),this.connected_&&this.sendListen_(o)}},{key:"sendGet_",value:function(e){var t=this,n=this.outstandingGets_[e];this.sendRequest("g",n.request,function(r){delete t.outstandingGets_[e],t.outstandingGetCount_--,0===t.outstandingGetCount_&&(t.outstandingGets_=[]),n.onComplete&&n.onComplete(r)})}},{key:"sendListen_",value:function(e){var t=this,r=e.query,i=r._path.toString(),a=r._queryIdentifier;this.log_("Listen on "+i+" for "+a);var o={p:i};e.tag&&(o.q=r._queryObject,o.t=e.tag),o.h=e.hashFn(),this.sendRequest("q",o,function(o){var s=o.d,u=o.s;n.warnOnListenWarnings_(s,r),(t.listens.get(i)&&t.listens.get(i).get(a))===e&&(t.log_("listen response",o),"ok"!==u&&t.removeListen_(i,a),e.onComplete&&e.onComplete(u,s))})}},{key:"refreshAuthToken",value:function(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},function(){}),this.reduceReconnectDelayIfAdminCredential_(e)}},{key:"reduceReconnectDelayIfAdminCredential_",value:function(e){(e&&40===e.length||function(e){var t=NB(e).claims;return"object"==typeof t&&!0===t.admin}(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}},{key:"refreshAppCheckToken",value:function(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},function(){})}},{key:"tryAuth",value:function(){var e=this;if(this.connected_&&this.authToken_){var t=this.authToken_,n=function(e){var t=NB(e).claims;return!!t&&"object"==typeof t&&t.hasOwnProperty("iat")}(t)?"auth":"gauth",r={cred:t};null===this.authOverride_?r.noauth=!0:"object"==typeof this.authOverride_&&(r.authvar=this.authOverride_),this.sendRequest(n,r,function(n){var r=n.s,i=n.d||"error";e.authToken_===t&&("ok"===r?e.invalidAuthTokenCount_=0:e.onAuthRevoked_(r,i))})}}},{key:"tryAppCheck",value:function(){var e=this;this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},function(t){var n=t.s,r=t.d||"error";"ok"===n?e.invalidAppCheckTokenCount_=0:e.onAppCheckRevoked_(n,r)})}},{key:"unlisten",value:function(e,t){var n=e._path.toString(),r=e._queryIdentifier;this.log_("Unlisten called for "+n+" "+r),uB(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(n,r)&&this.connected_&&this.sendUnlisten_(n,r,e._queryObject,t)}},{key:"sendUnlisten_",value:function(e,t,n,r){this.log_("Unlisten on "+e+" for "+t);var i={p:e};r&&(i.q=n,i.t=r),this.sendRequest("n",i)}},{key:"onDisconnectPut",value:function(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:n})}},{key:"onDisconnectMerge",value:function(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:n})}},{key:"onDisconnectCancel",value:function(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}},{key:"sendOnDisconnect_",value:function(e,t,n,r){var i={p:t,d:n};this.log_("onDisconnect "+e,i),this.sendRequest(e,i,function(e){r&&setTimeout(function(){r(e.s,e.d)},Math.floor(0))})}},{key:"put",value:function(e,t,n,r){this.putInternal("p",e,t,n,r)}},{key:"merge",value:function(e,t,n,r){this.putInternal("m",e,t,n,r)}},{key:"putInternal",value:function(e,t,n,r,i){this.initConnection_();var a={p:t,d:n};void 0!==i&&(a.h=i),this.outstandingPuts_.push({action:e,request:a,onComplete:r}),this.outstandingPutCount_++,this.connected_?this.sendPut_(this.outstandingPuts_.length-1):this.log_("Buffering put: "+t)}},{key:"sendPut_",value:function(e){var t=this,n=this.outstandingPuts_[e].action,r=this.outstandingPuts_[e].request,i=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(n,r,function(r){t.log_(n+" response",r),delete t.outstandingPuts_[e],t.outstandingPutCount_--,0===t.outstandingPutCount_&&(t.outstandingPuts_=[]),i&&i(r.s,r.d)})}},{key:"reportStats",value:function(e){var t=this;if(this.connected_){var n={c:e};this.log_("reportStats",n),this.sendRequest("s",n,function(e){"ok"!==e.s&&t.log_("reportStats","Error sending stats: "+e.d)})}}},{key:"onDataMessage_",value:function(e){if("r"in e){this.log_("from server: "+RB(e));var t=e.r,n=this.requestCBHash_[t];n&&(delete this.requestCBHash_[t],n(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}},{key:"onDataPush_",value:function(e,t){this.log_("handleServerMessage",e,t),"d"===e?this.onDataUpdate_(t.p,t.d,!1,t.t):"m"===e?this.onDataUpdate_(t.p,t.d,!0,t.t):"c"===e?this.onListenRevoked_(t.p,t.q):"ac"===e?this.onAuthRevoked_(t.s,t.d):"apc"===e?this.onAppCheckRevoked_(t.s,t.d):"sd"===e?this.onSecurityDebugPacket_(t):P6("Unrecognized action received from server: "+RB(e)+"\nAre you using the latest client?")}},{key:"onReady_",value:function(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}},{key:"scheduleConnect_",value:function(e){var t=this;uB(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(function(){t.establishConnectionTimer_=null,t.establishConnection_()},Math.floor(e))}},{key:"initConnection_",value:function(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}},{key:"onVisible_",value:function(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=x8,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}},{key:"onOnline_",value:function(e){e?(this.log_("Browser went online."),this.reconnectDelay_=x8,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}},{key:"onRealtimeDisconnect_",value:function(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&((new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=x8),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime());var e=(new Date).getTime()-this.lastConnectionAttemptTime_,t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}},{key:"establishConnection_",value:function(){var e=this;return tB(regeneratorRuntime.mark(function t(){var r,i,a,o,s,u,c,l,h,f,d,v,p;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.shouldReconnect_()){t.next=21;break}return e.log_("Making a connection attempt"),e.lastConnectionAttemptTime_=(new Date).getTime(),e.lastConnectionEstablishedTime_=null,r=e.onDataMessage_.bind(e),i=e.onReady_.bind(e),a=e.onRealtimeDisconnect_.bind(e),o=e.id+":"+n.nextConnectionId_++,s=e.lastSessionId,u=!1,c=null,l=function(){c?c.close():(u=!0,a())},e.realtime_={close:l,sendRequest:function(e){uB(c,"sendRequest call when we're not connected not allowed."),c.sendRequest(e)}},h=e.forceTokenRefresh_,e.forceTokenRefresh_=!1,t.prev=8,t.next=11,Promise.all([e.authTokenProvider_.getToken(h),e.appCheckTokenProvider_.getToken(h)]);case 11:f=t.sent,d=Lv(f,2),v=d[0],p=d[1],u?E6("getToken() completed but was canceled"):(E6("getToken() completed. Creating connection."),e.authToken_=v&&v.accessToken,e.appCheckToken_=p&&p.token,c=new o8(o,e.repoInfo_,e.applicationId_,e.appCheckToken_,e.authToken_,r,i,a,function(t){T6(t+" ("+e.repoInfo_.toString()+")"),e.interrupt("server_kill")},s)),t.next=21;break;case 18:t.prev=18,t.t0=t.catch(8),e.log_("Failed to get token: "+t.t0),u||(e.repoInfo_.nodeAdmin&&T6(t.t0),l());case 21:case"end":return t.stop()}},t,null,[[8,18]])}))()}},{key:"interrupt",value:function(e){E6("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}},{key:"resume",value:function(e){E6("Resuming connection for reason: "+e),delete this.interruptReasons_[e],LB(this.interruptReasons_)&&(this.reconnectDelay_=x8,this.realtime_||this.scheduleConnect_(0))}},{key:"handleTimestamp_",value:function(e){var t=e-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}},{key:"cancelSentTransactions_",value:function(){for(var e=0;e<this.outstandingPuts_.length;e++){var t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}},{key:"onListenRevoked_",value:function(e,t){var n;n=t?t.map(function(e){return D6(e)}).join("$"):"default";var r=this.removeListen_(e,n);r&&r.onComplete&&r.onComplete("permission_denied")}},{key:"removeListen_",value:function(e,t){var n,r=new l8(e).toString();if(this.listens.has(r)){var i=this.listens.get(r);n=i.get(t),i.delete(t),0===i.size&&this.listens.delete(r)}else n=void 0;return n}},{key:"onAuthRevoked_",value:function(e,t){E6("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),("invalid_token"===e||"permission_denied"===e)&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}},{key:"onAppCheckRevoked_",value:function(e,t){E6("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,("invalid_token"===e||"permission_denied"===e)&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}},{key:"onSecurityDebugPacket_",value:function(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace("\n","\nFIREBASE: "))}},{key:"restoreState_",value:function(){this.tryAuth(),this.tryAppCheck();var e,t=Qv(this.listens.values());try{for(t.s();!(e=t.n()).done;){var n,r=Qv(e.value.values());try{for(r.s();!(n=r.n()).done;){var i=n.value;this.sendListen_(i)}}catch(u){r.e(u)}finally{r.f()}}}catch(u){t.e(u)}finally{t.f()}for(var a=0;a<this.outstandingPuts_.length;a++)this.outstandingPuts_[a]&&this.sendPut_(a);for(;this.onDisconnectRequestQueue_.length;){var o=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(o.action,o.pathString,o.data,o.onComplete)}for(var s=0;s<this.outstandingGets_.length;s++)this.outstandingGets_[s]&&this.sendGet_(s)}},{key:"sendConnectStats_",value:function(){var e={};e["sdk.js."+f6.replace(/\./g,"-")]=1,wB()?e["framework.cordova"]=1:bB()&&(e["framework.reactnative"]=1),this.reportStats(e)}},{key:"shouldReconnect_",value:function(){var e=c8.getInstance().currentlyOnline();return LB(this.interruptReasons_)&&e}}],[{key:"warnOnListenWarnings_",value:function(e,t){if(e&&"object"==typeof e&&MB(e,"w")){var n=DB(e,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){var r='".indexOn": "'+t._queryParams.getIndex().toString()+'"',i=t._path.toString();T6("Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ".concat(r," at ").concat(i," to your security rules for better performance."))}}}}]),n}(s8);return e.nextPersistentConnectionId_=0,e.nextConnectionId_=0,e}(),R8=function(){function e(t,n){tp(this,e),this.name=t,this.node=n}return rp(e,null,[{key:"Wrap",value:function(t,n){return new e(t,n)}}]),e}(),N8=function(){function e(){tp(this,e)}return rp(e,[{key:"getCompare",value:function(){return this.compare.bind(this)}},{key:"indexedValueChanged",value:function(e,t){var n=new R8(x6,e),r=new R8(x6,t);return 0!==this.compare(n,r)}},{key:"minPost",value:function(){return R8.MIN}}]),e}(),M8=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"compare",value:function(e,t){return R6(e.name,t.name)}},{key:"isDefinedOn",value:function(e){throw cB("KeyIndex.isDefinedOn not expected to be called.")}},{key:"indexedValueChanged",value:function(e,t){return!1}},{key:"minPost",value:function(){return R8.MIN}},{key:"maxPost",value:function(){return new R8(A6,O8)}},{key:"makePost",value:function(e,t){return uB("string"==typeof e,"KeyIndex indexValue must always be a string."),new R8(e,O8)}},{key:"toString",value:function(){return".key"}}],[{key:"__EMPTY_NODE",get:function(){return O8},set:function(e){O8=e}}]),n}(N8),D8=new M8,L8=function(){function e(t,n,r,i){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;tp(this,e),this.isReverse_=i,this.resultGenerator_=a,this.nodeStack_=[];for(var o=1;!t.isEmpty();)if(t=t,o=n?r(t.key,n):1,i&&(o*=-1),o<0)t=this.isReverse_?t.left:t.right;else{if(0===o){this.nodeStack_.push(t);break}this.nodeStack_.push(t),t=this.isReverse_?t.right:t.left}}return rp(e,[{key:"getNext",value:function(){if(0===this.nodeStack_.length)return null;var e,t=this.nodeStack_.pop();if(e=this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return e}},{key:"hasNext",value:function(){return this.nodeStack_.length>0}},{key:"peek",value:function(){if(0===this.nodeStack_.length)return null;var e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}]),e}(),F8=function(){var e=function(){function e(t,n,r,i,a){tp(this,e),this.key=t,this.value=n,this.color=null!=r?r:e.RED,this.left=null!=i?i:B8.EMPTY_NODE,this.right=null!=a?a:B8.EMPTY_NODE}return rp(e,[{key:"copy",value:function(t,n,r,i,a){return new e(null!=t?t:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=a?a:this.right)}},{key:"count",value:function(){return this.left.count()+1+this.right.count()}},{key:"isEmpty",value:function(){return!1}},{key:"inorderTraversal",value:function(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}},{key:"reverseTraversal",value:function(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}},{key:"min_",value:function(){return this.left.isEmpty()?this:this.left.min_()}},{key:"minKey",value:function(){return this.min_().key}},{key:"maxKey",value:function(){return this.right.isEmpty()?this.key:this.right.maxKey()}},{key:"insert",value:function(e,t,n){var r=this,i=n(e,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n))).fixUp_()}},{key:"removeMin_",value:function(){if(this.left.isEmpty())return B8.EMPTY_NODE;var e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),(e=e.copy(null,null,null,e.left.removeMin_(),null)).fixUp_()}},{key:"remove",value:function(e,t){var n,r;if(t(e,(n=this).key)<0)!n.left.isEmpty()&&!n.left.isRed_()&&!n.left.left.isRed_()&&(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(e,t),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),!n.right.isEmpty()&&!n.right.isRed_()&&!n.right.left.isRed_()&&(n=n.moveRedRight_()),0===t(e,n.key)){if(n.right.isEmpty())return B8.EMPTY_NODE;r=n.right.min_(),n=n.copy(r.key,r.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(e,t))}return n.fixUp_()}},{key:"isRed_",value:function(){return this.color}},{key:"fixUp_",value:function(){var e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}},{key:"moveRedLeft_",value:function(){var e=this.colorFlip_();return e.right.left.isRed_()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight_())).rotateLeft_()).colorFlip_()),e}},{key:"moveRedRight_",value:function(){var e=this.colorFlip_();return e.left.left.isRed_()&&(e=(e=e.rotateRight_()).colorFlip_()),e}},{key:"rotateLeft_",value:function(){var t=this.copy(null,null,e.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}},{key:"rotateRight_",value:function(){var t=this.copy(null,null,e.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}},{key:"colorFlip_",value:function(){var e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}},{key:"checkMaxDepth_",value:function(){var e=this.check_();return Math.pow(2,e)<=this.count()+1}},{key:"check_",value:function(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");var e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}]),e}();return e.RED=!0,e.BLACK=!1,e}(),B8=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.EMPTY_NODE;tp(this,e),this.comparator_=t,this.root_=n}return rp(e,[{key:"insert",value:function(t,n){return new e(this.comparator_,this.root_.insert(t,n,this.comparator_).copy(null,null,F8.BLACK,null,null))}},{key:"remove",value:function(t){return new e(this.comparator_,this.root_.remove(t,this.comparator_).copy(null,null,F8.BLACK,null,null))}},{key:"get",value:function(e){for(var t,n=this.root_;!n.isEmpty();){if(0===(t=this.comparator_(e,n.key)))return n.value;t<0?n=n.left:t>0&&(n=n.right)}return null}},{key:"getPredecessorKey",value:function(e){for(var t,n=this.root_,r=null;!n.isEmpty();){if(0===(t=this.comparator_(e,n.key))){if(n.left.isEmpty())return r?r.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}t<0?n=n.left:t>0&&(r=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}},{key:"isEmpty",value:function(){return this.root_.isEmpty()}},{key:"count",value:function(){return this.root_.count()}},{key:"minKey",value:function(){return this.root_.minKey()}},{key:"maxKey",value:function(){return this.root_.maxKey()}},{key:"inorderTraversal",value:function(e){return this.root_.inorderTraversal(e)}},{key:"reverseTraversal",value:function(e){return this.root_.reverseTraversal(e)}},{key:"getIterator",value:function(e){return new L8(this.root_,null,this.comparator_,!1,e)}},{key:"getIteratorFrom",value:function(e,t){return new L8(this.root_,e,this.comparator_,!1,t)}},{key:"getReverseIteratorFrom",value:function(e,t){return new L8(this.root_,e,this.comparator_,!0,t)}},{key:"getReverseIterator",value:function(e){return new L8(this.root_,null,this.comparator_,!0,e)}}]),e}();function V8(e,t){return R6(e.name,t.name)}function U8(e,t){return R6(e,t)}B8.EMPTY_NODE=new(function(){function e(){tp(this,e)}return rp(e,[{key:"copy",value:function(e,t,n,r,i){return this}},{key:"insert",value:function(e,t,n){return new F8(e,t,null)}},{key:"remove",value:function(e,t){return this}},{key:"count",value:function(){return 0}},{key:"isEmpty",value:function(){return!0}},{key:"inorderTraversal",value:function(e){return!1}},{key:"reverseTraversal",value:function(e){return!1}},{key:"minKey",value:function(){return null}},{key:"maxKey",value:function(){return null}},{key:"check_",value:function(){return 0}},{key:"isRed_",value:function(){return!1}}]),e}());var z8,H8,G8,q8,$8,W8=function(e){return"number"==typeof e?"number:"+B6(e):"string:"+e},j8=function(e){if(e.isLeafNode()){var t=e.val();uB("string"==typeof t||"number"==typeof t||"object"==typeof t&&MB(t,".sv"),"Priority must be a string or number.")}else uB(e===T8||e.isEmpty(),"priority of unexpected type.");uB(e===T8||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")},Z8=function(){var e=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.__childrenNodeConstructor.EMPTY_NODE;tp(this,e),this.value_=t,this.priorityNode_=n,this.lazyHash_=null,uB(null!=this.value_,"LeafNode shouldn't be created with null/undefined value."),j8(this.priorityNode_)}return rp(e,[{key:"isLeafNode",value:function(){return!0}},{key:"getPriority",value:function(){return this.priorityNode_}},{key:"updatePriority",value:function(t){return new e(this.value_,t)}},{key:"getImmediateChild",value:function(t){return".priority"===t?this.priorityNode_:e.__childrenNodeConstructor.EMPTY_NODE}},{key:"getChild",value:function(t){return k8(t)?this:".priority"===f8(t)?this.priorityNode_:e.__childrenNodeConstructor.EMPTY_NODE}},{key:"hasChild",value:function(){return!1}},{key:"getPredecessorChildName",value:function(e,t){return null}},{key:"updateImmediateChild",value:function(t,n){return".priority"===t?this.updatePriority(n):n.isEmpty()&&".priority"!==t?this:e.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,n).updatePriority(this.priorityNode_)}},{key:"updateChild",value:function(t,n){var r=f8(t);return null===r?n:n.isEmpty()&&".priority"!==r?this:(uB(".priority"!==r||1===d8(t),".priority must be the last token in a path"),this.updateImmediateChild(r,e.__childrenNodeConstructor.EMPTY_NODE.updateChild(v8(t),n)))}},{key:"isEmpty",value:function(){return!1}},{key:"numChildren",value:function(){return 0}},{key:"forEachChild",value:function(e,t){return!1}},{key:"val",value:function(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}},{key:"hash",value:function(){if(null===this.lazyHash_){var e="";this.priorityNode_.isEmpty()||(e+="priority:"+W8(this.priorityNode_.val())+":");var t=typeof this.value_;e+=t+":",e+="number"===t?B6(this.value_):this.value_,this.lazyHash_=_6(e)}return this.lazyHash_}},{key:"getValue",value:function(){return this.value_}},{key:"compareTo",value:function(t){return t===e.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof e.__childrenNodeConstructor?-1:(uB(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}},{key:"compareToLeafNode_",value:function(t){var n=typeof t.value_,r=typeof this.value_,i=e.VALUE_TYPE_ORDER.indexOf(n),a=e.VALUE_TYPE_ORDER.indexOf(r);return uB(i>=0,"Unknown leaf type: "+n),uB(a>=0,"Unknown leaf type: "+r),i===a?"object"===r?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:a-i}},{key:"withIndex",value:function(){return this}},{key:"isIndexed",value:function(){return!0}},{key:"equals",value:function(e){if(e===this)return!0;if(e.isLeafNode()){var t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}return!1}}],[{key:"__childrenNodeConstructor",get:function(){return z8},set:function(e){z8=e}}]),e}();return e.VALUE_TYPE_ORDER=["object","boolean","number","string"],e}(),Y8=new(function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"compare",value:function(e,t){var n=e.node.getPriority(),r=t.node.getPriority(),i=n.compareTo(r);return 0===i?R6(e.name,t.name):i}},{key:"isDefinedOn",value:function(e){return!e.getPriority().isEmpty()}},{key:"indexedValueChanged",value:function(e,t){return!e.getPriority().equals(t.getPriority())}},{key:"minPost",value:function(){return R8.MIN}},{key:"maxPost",value:function(){return new R8(A6,new Z8("[PRIORITY-POST]",G8))}},{key:"makePost",value:function(e,t){var n=H8(e);return new R8(t,new Z8("[PRIORITY-POST]",n))}},{key:"toString",value:function(){return".priority"}}]),n}(N8)),K8=Math.log(2),J8=function(){function e(t){var n=this;tp(this,e),this.count=parseInt(Math.log(t+1)/K8,10),this.current_=this.count-1;var r=parseInt(Array(n.count+1).join("1"),2);this.bits_=t+1&r}return rp(e,[{key:"nextBitIsOne",value:function(){var e=!(this.bits_&1<<this.current_);return this.current_--,e}}]),e}(),Q8=function(e,t,n,r){e.sort(t);var i=function t(r,i){var a,o,s=i-r;if(0===s)return null;if(1===s)return a=e[r],o=n?n(a):a,new F8(o,a.node,F8.BLACK,null,null);var u=parseInt(s/2,10)+r,c=t(r,u),l=t(u+1,i);return a=e[u],o=n?n(a):a,new F8(o,a.node,F8.BLACK,c,l)},a=function(t){for(var r=null,a=null,o=e.length,s=function(t,r){var a=o-t,s=o;o-=t;var c=i(a+1,s),l=e[a],h=n?n(l):l;u(new F8(h,l.node,r,null,c))},u=function(e){r?(r.left=e,r=e):(a=e,r=e)},c=0;c<t.count;++c){var l=t.nextBitIsOne(),h=Math.pow(2,t.count-(c+1));l?s(h,F8.BLACK):(s(h,F8.BLACK),s(h,F8.RED))}return a}(new J8(e.length));return new B8(r||t,a)},X8={},e7=function(){function e(t,n){tp(this,e),this.indexes_=t,this.indexSet_=n}return rp(e,[{key:"get",value:function(e){var t=DB(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof B8?t:null}},{key:"hasIndex",value:function(e){return MB(this.indexSet_,e.toString())}},{key:"addIndex",value:function(t,n){uB(t!==D8,"KeyIndex always exists and isn't meant to be added to the IndexMap.");for(var r,i=[],a=!1,o=n.getIterator(R8.Wrap),s=o.getNext();s;)a=a||t.isDefinedOn(s.node),i.push(s),s=o.getNext();r=a?Q8(i,t.getCompare()):X8;var u=t.toString(),c=Object.assign({},this.indexSet_);c[u]=t;var l=Object.assign({},this.indexes_);return l[u]=r,new e(l,c)}},{key:"addToIndexes",value:function(t,n){var r=this;return new e(FB(this.indexes_,function(e,i){var a=DB(r.indexSet_,i);if(uB(a,"Missing index implementation for "+i),e===X8){if(a.isDefinedOn(t.node)){for(var o=[],s=n.getIterator(R8.Wrap),u=s.getNext();u;)u.name!==t.name&&o.push(u),u=s.getNext();return o.push(t),Q8(o,a.getCompare())}return X8}var c=n.get(t.name),l=e;return c&&(l=l.remove(new R8(t.name,c))),l.insert(t,t.node)}),this.indexSet_)}},{key:"removeFromIndexes",value:function(t,n){return new e(FB(this.indexes_,function(e){if(e===X8)return e;var r=n.get(t.name);return r?e.remove(new R8(t.name,r)):e}),this.indexSet_)}}],[{key:"Default",get:function(){return uB(X8&&Y8,"ChildrenNode.ts has not been loaded"),q8=q8||new e({".priority":X8},{".priority":Y8})}}]),e}(),t7=function(){var e=function(){function e(t,n,r){tp(this,e),this.children_=t,this.priorityNode_=n,this.indexMap_=r,this.lazyHash_=null,this.priorityNode_&&j8(this.priorityNode_),this.children_.isEmpty()&&uB(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}return rp(e,[{key:"isLeafNode",value:function(){return!1}},{key:"getPriority",value:function(){return this.priorityNode_||$8}},{key:"updatePriority",value:function(t){return this.children_.isEmpty()?this:new e(this.children_,t,this.indexMap_)}},{key:"getImmediateChild",value:function(e){if(".priority"===e)return this.getPriority();var t=this.children_.get(e);return null===t?$8:t}},{key:"getChild",value:function(e){var t=f8(e);return null===t?this:this.getImmediateChild(t).getChild(v8(e))}},{key:"hasChild",value:function(e){return null!==this.children_.get(e)}},{key:"updateImmediateChild",value:function(t,n){if(uB(n,"We should always be passing snapshot nodes"),".priority"===t)return this.updatePriority(n);var r,i,a=new R8(t,n);n.isEmpty()?(r=this.children_.remove(t),i=this.indexMap_.removeFromIndexes(a,this.children_)):(r=this.children_.insert(t,n),i=this.indexMap_.addToIndexes(a,this.children_));var o=r.isEmpty()?$8:this.priorityNode_;return new e(r,o,i)}},{key:"updateChild",value:function(e,t){var n=f8(e);if(null===n)return t;uB(".priority"!==f8(e)||1===d8(e),".priority must be the last token in a path");var r=this.getImmediateChild(n).updateChild(v8(e),t);return this.updateImmediateChild(n,r)}},{key:"isEmpty",value:function(){return this.children_.isEmpty()}},{key:"numChildren",value:function(){return this.children_.count()}},{key:"val",value:function(t){if(this.isEmpty())return null;var n={},r=0,i=0,a=!0;if(this.forEachChild(Y8,function(o,s){n[o]=s.val(t),r++,a&&e.INTEGER_REGEXP_.test(o)?i=Math.max(i,Number(o)):a=!1}),!t&&a&&i<2*r){var o=[];for(var s in n)o[s]=n[s];return o}return t&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n}},{key:"hash",value:function(){if(null===this.lazyHash_){var e="";this.getPriority().isEmpty()||(e+="priority:"+W8(this.getPriority().val())+":"),this.forEachChild(Y8,function(t,n){var r=n.hash();""!==r&&(e+=":"+t+":"+r)}),this.lazyHash_=""===e?"":_6(e)}return this.lazyHash_}},{key:"getPredecessorChildName",value:function(e,t,n){var r=this.resolveIndex_(n);if(r){var i=r.getPredecessorKey(new R8(e,t));return i?i.name:null}return this.children_.getPredecessorKey(e)}},{key:"getFirstChildName",value:function(e){var t=this.resolveIndex_(e);if(t){var n=t.minKey();return n&&n.name}return this.children_.minKey()}},{key:"getFirstChild",value:function(e){var t=this.getFirstChildName(e);return t?new R8(t,this.children_.get(t)):null}},{key:"getLastChildName",value:function(e){var t=this.resolveIndex_(e);if(t){var n=t.maxKey();return n&&n.name}return this.children_.maxKey()}},{key:"getLastChild",value:function(e){var t=this.getLastChildName(e);return t?new R8(t,this.children_.get(t)):null}},{key:"forEachChild",value:function(e,t){var n=this.resolveIndex_(e);return n?n.inorderTraversal(function(e){return t(e.name,e.node)}):this.children_.inorderTraversal(t)}},{key:"getIterator",value:function(e){return this.getIteratorFrom(e.minPost(),e)}},{key:"getIteratorFrom",value:function(e,t){var n=this.resolveIndex_(t);if(n)return n.getIteratorFrom(e,function(e){return e});for(var r=this.children_.getIteratorFrom(e.name,R8.Wrap),i=r.peek();null!=i&&t.compare(i,e)<0;)r.getNext(),i=r.peek();return r}},{key:"getReverseIterator",value:function(e){return this.getReverseIteratorFrom(e.maxPost(),e)}},{key:"getReverseIteratorFrom",value:function(e,t){var n=this.resolveIndex_(t);if(n)return n.getReverseIteratorFrom(e,function(e){return e});for(var r=this.children_.getReverseIteratorFrom(e.name,R8.Wrap),i=r.peek();null!=i&&t.compare(i,e)>0;)r.getNext(),i=r.peek();return r}},{key:"compareTo",value:function(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===n7?-1:0}},{key:"withIndex",value:function(t){if(t===D8||this.indexMap_.hasIndex(t))return this;var n=this.indexMap_.addIndex(t,this.children_);return new e(this.children_,this.priorityNode_,n)}},{key:"isIndexed",value:function(e){return e===D8||this.indexMap_.hasIndex(e)}},{key:"equals",value:function(e){if(e===this)return!0;if(e.isLeafNode())return!1;var t=e;if(this.getPriority().equals(t.getPriority())){if(this.children_.count()===t.children_.count()){for(var n=this.getIterator(Y8),r=t.getIterator(Y8),i=n.getNext(),a=r.getNext();i&&a;){if(i.name!==a.name||!i.node.equals(a.node))return!1;i=n.getNext(),a=r.getNext()}return null===i&&null===a}return!1}return!1}},{key:"resolveIndex_",value:function(e){return e===D8?null:this.indexMap_.get(e.toString())}}],[{key:"EMPTY_NODE",get:function(){return $8||($8=new e(new B8(U8),null,e7.Default))}}]),e}();return e.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,e}(),n7=new(function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.call(this,new B8(U8),t7.EMPTY_NODE,e7.Default)}return rp(n,[{key:"compareTo",value:function(e){return e===this?0:1}},{key:"equals",value:function(e){return e===this}},{key:"getPriority",value:function(){return this}},{key:"getImmediateChild",value:function(e){return t7.EMPTY_NODE}},{key:"isEmpty",value:function(){return!1}}]),n}(t7));function r7(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(null===e)return t7.EMPTY_NODE;if("object"==typeof e&&".priority"in e&&(t=e[".priority"]),uB(null===t||"string"==typeof t||"number"==typeof t||"object"==typeof t&&".sv"in t,"Invalid priority type found: "+typeof t),"object"==typeof e&&".value"in e&&null!==e[".value"]&&(e=e[".value"]),"object"!=typeof e||".sv"in e)return new Z8(e,r7(t));if(e instanceof Array){var n=t7.EMPTY_NODE;return F6(e,function(t,r){if(MB(e,t)&&"."!==t.substring(0,1)){var i=r7(r);(i.isLeafNode()||!i.isEmpty())&&(n=n.updateImmediateChild(t,i))}}),n.updatePriority(r7(t))}var r=[],i=!1;if(F6(e,function(e,t){if("."!==e.substring(0,1)){var n=r7(t);n.isEmpty()||(i=i||!n.getPriority().isEmpty(),r.push(new R8(e,n)))}}),0===r.length)return t7.EMPTY_NODE;var a=Q8(r,V8,function(e){return e.name},U8);if(i){var o=Q8(r,Y8.getCompare());return new t7(a,r7(t),new e7({".priority":o},{".priority":Y8}))}return new t7(a,r7(t),e7.Default)}Object.defineProperties(R8,{MIN:{value:new R8(x6,t7.EMPTY_NODE)},MAX:{value:new R8(A6,n7)}}),M8.__EMPTY_NODE=t7.EMPTY_NODE,Z8.__childrenNodeConstructor=t7,function(e){T8=e}(n7),function(e){G8=e}(n7),function(e){H8=e}(r7);var i7=function(e){Gv(n,e);var t=$v(n);function n(e){var r;return tp(this,n),(r=t.call(this)).indexPath_=e,uB(!k8(e)&&".priority"!==f8(e),"Can't create PathIndex with empty path or .priority key"),r}return rp(n,[{key:"extractChild",value:function(e){return e.getChild(this.indexPath_)}},{key:"isDefinedOn",value:function(e){return!e.getChild(this.indexPath_).isEmpty()}},{key:"compare",value:function(e,t){var n=this.extractChild(e.node),r=this.extractChild(t.node),i=n.compareTo(r);return 0===i?R6(e.name,t.name):i}},{key:"makePost",value:function(e,t){var n=r7(e),r=t7.EMPTY_NODE.updateChild(this.indexPath_,n);return new R8(t,r)}},{key:"maxPost",value:function(){var e=t7.EMPTY_NODE.updateChild(this.indexPath_,n7);return new R8(A6,e)}},{key:"toString",value:function(){return g8(this.indexPath_,0).join("/")}}]),n}(N8),a7=new(function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"compare",value:function(e,t){var n=e.node.compareTo(t.node);return 0===n?R6(e.name,t.name):n}},{key:"isDefinedOn",value:function(e){return!0}},{key:"indexedValueChanged",value:function(e,t){return!e.equals(t)}},{key:"minPost",value:function(){return R8.MIN}},{key:"maxPost",value:function(){return R8.MAX}},{key:"makePost",value:function(e,t){var n=r7(e);return new R8(t,n)}},{key:"toString",value:function(){return".value"}}]),n}(N8));function o7(e,t,n){return{type:"child_changed",snapshotNode:t,childName:e,oldSnap:n}}var s7=function(){function e(){tp(this,e),this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Y8}return rp(e,[{key:"hasStart",value:function(){return this.startSet_}},{key:"hasStartAfter",value:function(){return this.startAfterSet_}},{key:"hasEndBefore",value:function(){return this.endBeforeSet_}},{key:"isViewFromLeft",value:function(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}},{key:"getIndexStartValue",value:function(){return uB(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}},{key:"getIndexStartName",value:function(){return uB(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:x6}},{key:"hasEnd",value:function(){return this.endSet_}},{key:"getIndexEndValue",value:function(){return uB(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}},{key:"getIndexEndName",value:function(){return uB(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:A6}},{key:"hasLimit",value:function(){return this.limitSet_}},{key:"hasAnchoredLimit",value:function(){return this.limitSet_&&""!==this.viewFrom_}},{key:"getLimit",value:function(){return uB(this.limitSet_,"Only valid if limit has been set"),this.limit_}},{key:"getIndex",value:function(){return this.index_}},{key:"loadsAllData",value:function(){return!(this.startSet_||this.endSet_||this.limitSet_)}},{key:"isDefault",value:function(){return this.loadsAllData()&&this.index_===Y8}},{key:"copy",value:function(){var t=new e;return t.limitSet_=this.limitSet_,t.limit_=this.limit_,t.startSet_=this.startSet_,t.indexStartValue_=this.indexStartValue_,t.startNameSet_=this.startNameSet_,t.indexStartName_=this.indexStartName_,t.endSet_=this.endSet_,t.indexEndValue_=this.indexEndValue_,t.endNameSet_=this.endNameSet_,t.indexEndName_=this.indexEndName_,t.index_=this.index_,t.viewFrom_=this.viewFrom_,t}}]),e}();function u7(e){var t,n={};return e.isDefault()||(e.index_===Y8?t="$priority":e.index_===a7?t="$value":e.index_===D8?t="$key":(uB(e.index_ instanceof i7,"Unrecognized index type!"),t=e.index_.toString()),n.orderBy=RB(t),e.startSet_&&(n.startAt=RB(e.indexStartValue_),e.startNameSet_&&(n.startAt+=","+RB(e.indexStartName_))),e.endSet_&&(n.endAt=RB(e.indexEndValue_),e.endNameSet_&&(n.endAt+=","+RB(e.indexEndName_))),e.limitSet_&&(e.isViewFromLeft()?n.limitToFirst=e.limit_:n.limitToLast=e.limit_)),n}function c7(e){var t={};if(e.startSet_&&(t.sp=e.indexStartValue_,e.startNameSet_&&(t.sn=e.indexStartName_)),e.endSet_&&(t.ep=e.indexEndValue_,e.endNameSet_&&(t.en=e.indexEndName_)),e.limitSet_){t.l=e.limit_;var n=e.viewFrom_;""===n&&(n=e.isViewFromLeft()?"l":"r"),t.vf=n}return e.index_!==Y8&&(t.i=e.index_.toString()),t}var l7=function(e){Gv(n,e);var t=$v(n);function n(e,r,i,a){var o;return tp(this,n),(o=t.call(this)).repoInfo_=e,o.onDataUpdate_=r,o.authTokenProvider_=i,o.appCheckTokenProvider_=a,o.log_=S6("p:rest:"),o.listens_={},o}return rp(n,[{key:"reportStats",value:function(e){throw new Error("Method not implemented.")}},{key:"listen",value:function(e,t,r,i){var a=this,o=e._path.toString();this.log_("Listen called for "+o+" "+e._queryIdentifier);var s=n.getListenId_(e,r),u={};this.listens_[s]=u;var c=u7(e._queryParams);this.restRequest_(o+".json",c,function(e,t){var n=t;(404===e&&(n=null,e=null),null===e&&a.onDataUpdate_(o,n,!1,r),DB(a.listens_,s)===u)&&i(e?401===e?"permission_denied":"rest_error:"+e:"ok",null)})}},{key:"unlisten",value:function(e,t){var r=n.getListenId_(e,t);delete this.listens_[r]}},{key:"get",value:function(e){var t=this,n=u7(e._queryParams),r=e._path.toString(),i=new mB;return this.restRequest_(r+".json",n,function(e,n){var a=n;404===e&&(a=null,e=null),null===e?(t.onDataUpdate_(r,a,!1,null),i.resolve(a)):i.reject(new Error(a))}),i.promise}},{key:"refreshAuthToken",value:function(e){}},{key:"restRequest_",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0;return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(function(i){var a=Lv(i,2),o=a[0],s=a[1];o&&o.accessToken&&(n.auth=o.accessToken),s&&s.token&&(n.ac=s.token);var u=(t.repoInfo_.secure?"https://":"http://")+t.repoInfo_.host+e+"?ns="+t.repoInfo_.namespace+UB(n);t.log_("Sending REST request for "+u);var c=new XMLHttpRequest;c.onreadystatechange=function(){if(r&&4===c.readyState){t.log_("REST Response for "+u+" received. status:",c.status,"response:",c.responseText);var e=null;if(c.status>=200&&c.status<300){try{e=AB(c.responseText)}catch(n){T6("Failed to parse JSON response for "+u+": "+c.responseText)}r(null,e)}else 401!==c.status&&404!==c.status&&T6("Got unsuccessful REST response for "+u+" Status: "+c.status),r(c.status);r=null}},c.open("GET",u,!0),c.send()})}}],[{key:"getListenId_",value:function(e,t){return void 0!==t?"tag$"+t:(uB(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}}]),n}(s8),h7=function(){function e(){tp(this,e),this.rootNode_=t7.EMPTY_NODE}return rp(e,[{key:"getNode",value:function(e){return this.rootNode_.getChild(e)}},{key:"updateSnapshot",value:function(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}]),e}();function f7(){return{value:null,children:new Map}}function d7(e,t,n){if(k8(t))e.value=n,e.children.clear();else if(null!==e.value)e.value=e.value.updateChild(t,n);else{var r=f8(t);e.children.has(r)||e.children.set(r,f7()),d7(e.children.get(r),t=v8(t),n)}}function v7(e,t){if(k8(t))return e.value=null,e.children.clear(),!0;if(null!==e.value){if(e.value.isLeafNode())return!1;var n=e.value;return e.value=null,n.forEachChild(Y8,function(t,n){d7(e,new l8(t),n)}),v7(e,t)}if(e.children.size>0){var r=f8(t);return t=v8(t),e.children.has(r)&&v7(e.children.get(r),t)&&e.children.delete(r),0===e.children.size}return!0}function p7(e,t,n){null!==e.value?n(t,e.value):function(e,t){e.children.forEach(function(e,n){t(n,e)})}(e,function(e,r){p7(r,new l8(t.toString()+"/"+e),n)})}var g7=function(){function e(t){tp(this,e),this.collection_=t,this.last_=null}return rp(e,[{key:"get",value:function(){var e=this.collection_.get(),t=Object.assign({},e);return this.last_&&F6(this.last_,function(e,n){t[e]=t[e]-n}),this.last_=e,t}}]),e}(),y7=function(){function e(t,n){tp(this,e),this.server_=n,this.statsToReport_={},this.statsListener_=new g7(t);var r=1e4+2e4*Math.random();H6(this.reportStats_.bind(this),Math.floor(r))}return rp(e,[{key:"reportStats_",value:function(){var e=this,t=this.statsListener_.get(),n={},r=!1;F6(t,function(t,i){i>0&&MB(e.statsToReport_,t)&&(n[t]=i,r=!0)}),r&&this.server_.reportStats(n),H6(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}]),e}(),m7=(function(e){e[e.OVERWRITE=0]="OVERWRITE",e[e.MERGE=1]="MERGE",e[e.ACK_USER_WRITE=2]="ACK_USER_WRITE",e[e.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}(m7||(m7={})),m7);function k7(e){return{fromUser:!1,fromServer:!0,queryId:e,tagged:!0}}var _7,w7=function(){function e(t,n,r){tp(this,e),this.path=t,this.affectedTree=n,this.revert=r,this.type=m7.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}return rp(e,[{key:"operationForChild",value:function(t){if(k8(this.path)){if(null!=this.affectedTree.value)return uB(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;var n=this.affectedTree.subtree(new l8(t));return new e(h8(),n,this.revert)}return uB(f8(this.path)===t,"operationForChild called for unrelated child."),new e(v8(this.path),this.affectedTree,this.revert)}}]),e}(),C7=function(){function e(t,n,r){tp(this,e),this.source=t,this.path=n,this.snap=r,this.type=m7.OVERWRITE}return rp(e,[{key:"operationForChild",value:function(t){return k8(this.path)?new e(this.source,h8(),this.snap.getImmediateChild(t)):new e(this.source,v8(this.path),this.snap)}}]),e}(),b7=function(){function e(t,n,r){tp(this,e),this.source=t,this.path=n,this.children=r,this.type=m7.MERGE}return rp(e,[{key:"operationForChild",value:function(t){if(k8(this.path)){var n=this.children.subtree(new l8(t));return n.isEmpty()?null:n.value?new C7(this.source,h8(),n.value):new e(this.source,h8(),n)}return uB(f8(this.path)===t,"Can't get a merge for a child not on the path of the operation"),new e(this.source,v8(this.path),this.children)}},{key:"toString",value:function(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}]),e}(),E7=function(){function e(t,n,r){tp(this,e),this.node_=t,this.fullyInitialized_=n,this.filtered_=r}return rp(e,[{key:"isFullyInitialized",value:function(){return this.fullyInitialized_}},{key:"isFiltered",value:function(){return this.filtered_}},{key:"isCompleteForPath",value:function(e){if(k8(e))return this.isFullyInitialized()&&!this.filtered_;var t=f8(e);return this.isCompleteForChild(t)}},{key:"isCompleteForChild",value:function(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}},{key:"getNode",value:function(){return this.node_}}]),e}();function S7(e,t,n,r,i,a){var o=r.filter(function(e){return e.type===n});o.sort(function(t,n){return function(e,t,n){if(null==t.childName||null==n.childName)throw cB("Should only compare child_ events.");var r=new R8(t.childName,t.snapshotNode),i=new R8(n.childName,n.snapshotNode);return e.index_.compare(r,i)}(e,t,n)}),o.forEach(function(n){var r=function(e,t,n){return"value"===t.type||"child_removed"===t.type||(t.prevName=n.getPredecessorChildName(t.childName,t.snapshotNode,e.index_)),t}(e,n,a);i.forEach(function(i){i.respondsTo(n.type)&&t.push(i.createEvent(r,e.query_))})})}function P7(e,t){return{eventCache:e,serverCache:t}}function O7(e,t,n,r){return P7(new E7(t,n,r),e.serverCache)}function T7(e,t,n,r){return P7(e.eventCache,new E7(t,n,r))}function I7(e){return e.eventCache.isFullyInitialized()?e.eventCache.getNode():null}function x7(e){return e.serverCache.isFullyInitialized()?e.serverCache.getNode():null}var A7=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(_7||(_7=new B8(N6)),_7);tp(this,e),this.value=t,this.children=n}return rp(e,[{key:"isEmpty",value:function(){return null===this.value&&this.children.isEmpty()}},{key:"findRootMostMatchingPathAndValue",value:function(e,t){if(null!=this.value&&t(this.value))return{path:h8(),value:this.value};if(k8(e))return null;var n=f8(e),r=this.children.get(n);if(null!==r){var i=r.findRootMostMatchingPathAndValue(v8(e),t);return null!=i?{path:m8(new l8(n),i.path),value:i.value}:null}return null}},{key:"findRootMostValueAndPath",value:function(e){return this.findRootMostMatchingPathAndValue(e,function(){return!0})}},{key:"subtree",value:function(t){if(k8(t))return this;var n=f8(t),r=this.children.get(n);return null!==r?r.subtree(v8(t)):new e(null)}},{key:"set",value:function(t,n){if(k8(t))return new e(n,this.children);var r=f8(t),i=(this.children.get(r)||new e(null)).set(v8(t),n),a=this.children.insert(r,i);return new e(this.value,a)}},{key:"remove",value:function(t){if(k8(t))return this.children.isEmpty()?new e(null):new e(null,this.children);var n=f8(t),r=this.children.get(n);if(r){var i,a=r.remove(v8(t));return i=a.isEmpty()?this.children.remove(n):this.children.insert(n,a),null===this.value&&i.isEmpty()?new e(null):new e(this.value,i)}return this}},{key:"get",value:function(e){if(k8(e))return this.value;var t=f8(e),n=this.children.get(t);return n?n.get(v8(e)):null}},{key:"setTree",value:function(t,n){if(k8(t))return n;var r,i=f8(t),a=(this.children.get(i)||new e(null)).setTree(v8(t),n);return r=a.isEmpty()?this.children.remove(i):this.children.insert(i,a),new e(this.value,r)}},{key:"fold",value:function(e){return this.fold_(h8(),e)}},{key:"fold_",value:function(e,t){var n={};return this.children.inorderTraversal(function(r,i){n[r]=i.fold_(m8(e,r),t)}),t(e,this.value,n)}},{key:"findOnPath",value:function(e,t){return this.findOnPath_(e,h8(),t)}},{key:"findOnPath_",value:function(e,t,n){var r=!!this.value&&n(t,this.value);if(r)return r;if(k8(e))return null;var i=f8(e),a=this.children.get(i);return a?a.findOnPath_(v8(e),m8(t,i),n):null}},{key:"foreachOnPath",value:function(e,t){return this.foreachOnPath_(e,h8(),t)}},{key:"foreachOnPath_",value:function(t,n,r){if(k8(t))return this;this.value&&r(n,this.value);var i=f8(t),a=this.children.get(i);return a?a.foreachOnPath_(v8(t),m8(n,i),r):new e(null)}},{key:"foreach",value:function(e){this.foreach_(h8(),e)}},{key:"foreach_",value:function(e,t){this.children.inorderTraversal(function(n,r){r.foreach_(m8(e,n),t)}),this.value&&t(e,this.value)}},{key:"foreachChild",value:function(e){this.children.inorderTraversal(function(t,n){n.value&&e(t,n.value)})}}],[{key:"fromObject",value:function(t){var n=new e(null);return F6(t,function(e,t){n=n.set(new l8(e),t)}),n}}]),e}(),R7=function(){function e(t){tp(this,e),this.writeTree_=t}return rp(e,null,[{key:"empty",value:function(){return new e(new A7(null))}}]),e}();function N7(e,t,n){if(k8(t))return new R7(new A7(n));var r=e.writeTree_.findRootMostValueAndPath(t);if(null!=r){var i=r.path,a=r.value,o=_8(i,t);return a=a.updateChild(o,n),new R7(e.writeTree_.set(i,a))}var s=new A7(n),u=e.writeTree_.setTree(t,s);return new R7(u)}function M7(e,t,n){var r=e;return F6(n,function(e,n){r=N7(r,m8(t,e),n)}),r}function D7(e,t){if(k8(t))return R7.empty();var n=e.writeTree_.setTree(t,new A7(null));return new R7(n)}function L7(e,t){return null!=F7(e,t)}function F7(e,t){var n=e.writeTree_.findRootMostValueAndPath(t);return null!=n?e.writeTree_.get(n.path).getChild(_8(n.path,t)):null}function B7(e){var t=[],n=e.writeTree_.value;return null!=n?n.isLeafNode()||n.forEachChild(Y8,function(e,n){t.push(new R8(e,n))}):e.writeTree_.children.inorderTraversal(function(e,n){null!=n.value&&t.push(new R8(e,n.value))}),t}function V7(e,t){if(k8(t))return e;var n=F7(e,t);return new R7(null!=n?new A7(n):e.writeTree_.subtree(t))}function U7(e){return e.writeTree_.isEmpty()}function z7(e,t){return H7(h8(),e.writeTree_,t)}function H7(e,t,n){if(null!=t.value)return n.updateChild(e,t.value);var r=null;return t.children.inorderTraversal(function(t,i){".priority"===t?(uB(null!==i.value,"Priority writes must always be leaf nodes"),r=i.value):n=H7(m8(e,t),i,n)}),!n.getChild(e).isEmpty()&&null!==r&&(n=n.updateChild(m8(e,".priority"),r)),n}function G7(e,t){return e9(t,e)}function q7(e,t){if(e.snap)return b8(e.path,t);for(var n in e.children)if(e.children.hasOwnProperty(n)&&b8(m8(e.path,n),t))return!0;return!1}function $7(e){return e.visible}function W7(e,t,n){for(var r=R7.empty(),i=0;i<e.length;++i){var a=e[i];if(t(a)){var o=a.path,s=void 0;if(a.snap)b8(n,o)?r=N7(r,s=_8(n,o),a.snap):b8(o,n)&&(s=_8(o,n),r=N7(r,h8(),a.snap.getChild(s)));else{if(!a.children)throw cB("WriteRecord should have .snap or .children");if(b8(n,o))r=M7(r,s=_8(n,o),a.children);else if(b8(o,n))if(k8(s=_8(o,n)))r=M7(r,h8(),a.children);else{var u=DB(a.children,f8(s));if(u){var c=u.getChild(v8(s));r=N7(r,h8(),c)}}}}}return r}function j7(e,t,n,r,i){if(r||i){var a=V7(e.visibleWrites,t);return!i&&U7(a)?n:i||null!=n||L7(a,h8())?z7(W7(e.allWrites,function(e){return(e.visible||i)&&(!r||!~r.indexOf(e.writeId))&&(b8(e.path,t)||b8(t,e.path))},t),n||t7.EMPTY_NODE):null}var o=F7(e.visibleWrites,t);if(null!=o)return o;var s=V7(e.visibleWrites,t);return U7(s)?n:null!=n||L7(s,h8())?z7(s,n||t7.EMPTY_NODE):null}function Z7(e,t,n,r){return j7(e.writeTree,e.treePath,t,n,r)}function Y7(e,t){return function(e,t,n){var r=t7.EMPTY_NODE,i=F7(e.visibleWrites,t);if(i)return i.isLeafNode()||i.forEachChild(Y8,function(e,t){r=r.updateImmediateChild(e,t)}),r;if(n){var a=V7(e.visibleWrites,t);return n.forEachChild(Y8,function(e,t){var n=z7(V7(a,new l8(e)),t);r=r.updateImmediateChild(e,n)}),B7(a).forEach(function(e){r=r.updateImmediateChild(e.name,e.node)}),r}return B7(V7(e.visibleWrites,t)).forEach(function(e){r=r.updateImmediateChild(e.name,e.node)}),r}(e.writeTree,e.treePath,t)}function K7(e,t,n,r){return function(e,t,n,r,i){uB(r||i,"Either existingEventSnap or existingServerSnap must exist");var a=m8(t,n);if(L7(e.visibleWrites,a))return null;var o=V7(e.visibleWrites,a);return U7(o)?i.getChild(n):z7(o,i.getChild(n))}(e.writeTree,e.treePath,t,n,r)}function J7(e,t){return function(e,t){return F7(e.visibleWrites,t)}(e.writeTree,m8(e.treePath,t))}function Q7(e,t,n){return function(e,t,n,r){var i=m8(t,n),a=F7(e.visibleWrites,i);return null!=a?a:r.isCompleteForChild(n)?z7(V7(e.visibleWrites,i),r.getNode().getImmediateChild(n)):null}(e.writeTree,e.treePath,t,n)}function X7(e,t){return e9(m8(e.treePath,t),e.writeTree)}function e9(e,t){return{treePath:e,writeTree:t}}var t9,n9,r9=function(){function e(){tp(this,e),this.changeMap=new Map}return rp(e,[{key:"trackChildChange",value:function(e){var t=e.type,n=e.childName;uB("child_added"===t||"child_changed"===t||"child_removed"===t,"Only child changes supported for tracking"),uB(".priority"!==n,"Only non-priority child changes can be tracked.");var r=this.changeMap.get(n);if(r){var i=r.type;if("child_added"===t&&"child_removed"===i)this.changeMap.set(n,o7(n,e.snapshotNode,r.snapshotNode));else if("child_removed"===t&&"child_added"===i)this.changeMap.delete(n);else if("child_removed"===t&&"child_changed"===i)this.changeMap.set(n,function(e,t){return{type:"child_removed",snapshotNode:t,childName:e}}(n,r.oldSnap));else if("child_changed"===t&&"child_added"===i)this.changeMap.set(n,function(e,t){return{type:"child_added",snapshotNode:t,childName:e}}(n,e.snapshotNode));else{if("child_changed"!==t||"child_changed"!==i)throw cB("Illegal combination of changes: "+e+" occurred after "+r);this.changeMap.set(n,o7(n,e.snapshotNode,r.oldSnap))}}else this.changeMap.set(n,e)}},{key:"getChanges",value:function(){return Array.from(this.changeMap.values())}}]),e}(),i9=new(function(){function e(){tp(this,e)}return rp(e,[{key:"getCompleteChild",value:function(e){return null}},{key:"getChildAfterChild",value:function(e,t,n){return null}}]),e}()),a9=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;tp(this,e),this.writes_=t,this.viewCache_=n,this.optCompleteServerCache_=r}return rp(e,[{key:"getCompleteChild",value:function(e){var t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);var n=null!=this.optCompleteServerCache_?new E7(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return Q7(this.writes_,e,n)}},{key:"getChildAfterChild",value:function(e,t,n){var r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:x7(this.viewCache_),i=function(e,t,n,r,i,a){return function(e,t,n,r,i,a,o){var s,u=V7(e.visibleWrites,t),c=F7(u,h8());if(null!=c)s=c;else{if(null==n)return[];s=z7(u,n)}if((s=s.withIndex(o)).isEmpty()||s.isLeafNode())return[];for(var l=[],h=o.getCompare(),f=a?s.getReverseIteratorFrom(r,o):s.getIteratorFrom(r,o),d=f.getNext();d&&l.length<1;)0!==h(d,r)&&l.push(d),d=f.getNext();return l}(e.writeTree,e.treePath,t,n,0,i,a)}(this.writes_,r,t,0,n,e);return 0===i.length?null:i[0]}}]),e}();function o9(e,t,n,r,i,a){var o,s,u=t.eventCache;if(null!=J7(r,n))return t;if(k8(n))if(uB(t.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),t.serverCache.isFiltered()){var c=x7(t),l=Y7(r,c instanceof t7?c:t7.EMPTY_NODE);o=e.filter.updateFullNode(t.eventCache.getNode(),l,a)}else{var h=Z7(r,x7(t));o=e.filter.updateFullNode(t.eventCache.getNode(),h,a)}else{var f=f8(n);if(".priority"===f){uB(1===d8(n),"Can't have a priority with additional path components");var d=u.getNode(),v=K7(r,n,d,s=t.serverCache.getNode());o=null!=v?e.filter.updatePriority(d,v):u.getNode()}else{var p,g=v8(n);if(u.isCompleteForChild(f)){s=t.serverCache.getNode();var y=K7(r,n,u.getNode(),s);p=null!=y?u.getNode().getImmediateChild(f).updateChild(g,y):u.getNode().getImmediateChild(f)}else p=Q7(r,f,t.serverCache);o=null!=p?e.filter.updateChild(u.getNode(),f,p,g,i,a):u.getNode()}}return O7(t,o,u.isFullyInitialized()||k8(n),e.filter.filtersNodes())}function s9(e,t,n,r,i,a,o,s){var u,c=t.serverCache,l=o?e.filter:e.filter.getIndexedFilter();if(k8(n))u=l.updateFullNode(c.getNode(),r,null);else if(l.filtersNodes()&&!c.isFiltered()){var h=c.getNode().updateChild(n,r);u=l.updateFullNode(c.getNode(),h,null)}else{var f=f8(n);if(!c.isCompleteForPath(n)&&d8(n)>1)return t;var d=v8(n),v=c.getNode().getImmediateChild(f).updateChild(d,r);u=".priority"===f?l.updatePriority(c.getNode(),v):l.updateChild(c.getNode(),f,v,d,i9,null)}var p=T7(t,u,c.isFullyInitialized()||k8(n),l.filtersNodes());return o9(e,p,n,i,new a9(i,p,a),s)}function u9(e,t,n,r,i,a,o){var s,u,c=t.eventCache,l=new a9(i,t,a);if(k8(n))u=e.filter.updateFullNode(t.eventCache.getNode(),r,o),s=O7(t,u,!0,e.filter.filtersNodes());else{var h=f8(n);if(".priority"===h)u=e.filter.updatePriority(t.eventCache.getNode(),r),s=O7(t,u,c.isFullyInitialized(),c.isFiltered());else{var f,d=v8(n),v=c.getNode().getImmediateChild(h);if(k8(d))f=r;else{var p=l.getCompleteChild(h);f=null!=p?".priority"===p8(d)&&p.getChild(y8(d)).isEmpty()?p:p.updateChild(d,r):t7.EMPTY_NODE}s=v.equals(f)?t:O7(t,e.filter.updateChild(c.getNode(),h,f,d,l,o),c.isFullyInitialized(),e.filter.filtersNodes())}}return s}function c9(e,t){return e.eventCache.isCompleteForChild(t)}function l9(e,t,n){return n.foreach(function(e,n){t=t.updateChild(e,n)}),t}function h9(e,t,n,r,i,a,o,s){if(t.serverCache.getNode().isEmpty()&&!t.serverCache.isFullyInitialized())return t;var u,c=t;u=k8(n)?r:new A7(null).setTree(n,r);var l=t.serverCache.getNode();return u.children.inorderTraversal(function(n,r){if(l.hasChild(n)){var u=l9(0,t.serverCache.getNode().getImmediateChild(n),r);c=s9(e,c,new l8(n),u,i,a,o,s)}}),u.children.inorderTraversal(function(n,r){var u=!t.serverCache.isCompleteForChild(n)&&void 0===r.value;if(!l.hasChild(n)&&!u){var h=l9(0,t.serverCache.getNode().getImmediateChild(n),r);c=s9(e,c,new l8(n),h,i,a,o,s)}}),c}function f9(e,t){var n=x7(e.viewCache_);return n&&(e.query._queryParams.loadsAllData()||!k8(t)&&!n.getImmediateChild(f8(t)).isEmpty())?n.getChild(t):null}function d9(e,t,n,r){t.type===m7.MERGE&&null!==t.source.queryId&&(uB(x7(e.viewCache_),"We should always have a full cache before handling merges"),uB(I7(e.viewCache_),"Missing event cache, even though we have a server cache"));var i=e.viewCache_,a=function(e,t,n,r,i){var a,o,s=new r9;if(n.type===m7.OVERWRITE){var u=n;u.source.fromUser?a=u9(e,t,u.path,u.snap,r,i,s):(uB(u.source.fromServer,"Unknown source."),o=u.source.tagged||t.serverCache.isFiltered()&&!k8(u.path),a=s9(e,t,u.path,u.snap,r,i,o,s))}else if(n.type===m7.MERGE){var c=n;c.source.fromUser?a=function(e,t,n,r,i,a,o){var s=t;return r.foreach(function(r,u){var c=m8(n,r);c9(t,f8(c))&&(s=u9(e,s,c,u,i,a,o))}),r.foreach(function(r,u){var c=m8(n,r);c9(t,f8(c))||(s=u9(e,s,c,u,i,a,o))}),s}(e,t,c.path,c.children,r,i,s):(uB(c.source.fromServer,"Unknown source."),o=c.source.tagged||t.serverCache.isFiltered(),a=h9(e,t,c.path,c.children,r,i,o,s))}else if(n.type===m7.ACK_USER_WRITE){var l=n;a=l.revert?function(e,t,n,r,i,a){var o;if(null!=J7(r,n))return t;var s,u=new a9(r,t,i),c=t.eventCache.getNode();if(k8(n)||".priority"===f8(n)){var l;if(t.serverCache.isFullyInitialized())l=Z7(r,x7(t));else{var h=t.serverCache.getNode();uB(h instanceof t7,"serverChildren would be complete if leaf node"),l=Y7(r,h)}l=l,s=e.filter.updateFullNode(c,l,a)}else{var f=f8(n),d=Q7(r,f,t.serverCache);null==d&&t.serverCache.isCompleteForChild(f)&&(d=c.getImmediateChild(f)),(s=null!=d?e.filter.updateChild(c,f,d,v8(n),u,a):t.eventCache.getNode().hasChild(f)?e.filter.updateChild(c,f,t7.EMPTY_NODE,v8(n),u,a):c).isEmpty()&&t.serverCache.isFullyInitialized()&&((o=Z7(r,x7(t))).isLeafNode()&&(s=e.filter.updateFullNode(s,o,a)))}return o=t.serverCache.isFullyInitialized()||null!=J7(r,h8()),O7(t,s,o,e.filter.filtersNodes())}(e,t,l.path,r,i,s):function(e,t,n,r,i,a,o){if(null!=J7(i,n))return t;var s=t.serverCache.isFiltered(),u=t.serverCache;if(null!=r.value){if(k8(n)&&u.isFullyInitialized()||u.isCompleteForPath(n))return s9(e,t,n,u.getNode().getChild(n),i,a,s,o);if(k8(n)){var c=new A7(null);return u.getNode().forEachChild(D8,function(e,t){c=c.set(new l8(e),t)}),h9(e,t,n,c,i,a,s,o)}return t}var l=new A7(null);return r.foreach(function(e,t){var r=m8(n,e);u.isCompleteForPath(r)&&(l=l.set(e,u.getNode().getChild(r)))}),h9(e,t,n,l,i,a,s,o)}(e,t,l.path,l.affectedTree,r,i,s)}else{if(n.type!==m7.LISTEN_COMPLETE)throw cB("Unknown operation type: "+n.type);a=function(e,t,n,r,i){var a=t.serverCache;return o9(e,T7(t,a.getNode(),a.isFullyInitialized()||k8(n),a.isFiltered()),n,r,i9,i)}(e,t,n.path,r,s)}var h=s.getChanges();return function(e,t,n){var r=t.eventCache;if(r.isFullyInitialized()){var i=r.getNode().isLeafNode()||r.getNode().isEmpty(),a=I7(e);(n.length>0||!e.eventCache.isFullyInitialized()||i&&!r.getNode().equals(a)||!r.getNode().getPriority().equals(a.getPriority()))&&n.push(function(e){return{type:"value",snapshotNode:e}}(I7(t)))}}(t,a,h),{viewCache:a,changes:h}}(e.processor_,i,t,n,r);return function(e,t){uB(t.eventCache.getNode().isIndexed(e.filter.getIndex()),"Event snap not indexed"),uB(t.serverCache.getNode().isIndexed(e.filter.getIndex()),"Server snap not indexed")}(e.processor_,a.viewCache),uB(a.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),e.viewCache_=a.viewCache,function(e,t,n,r){return function(e,t,n,r){var i=[],a=[];return t.forEach(function(t){"child_changed"===t.type&&e.index_.indexedValueChanged(t.oldSnap,t.snapshotNode)&&a.push(function(e,t){return{type:"child_moved",snapshotNode:t,childName:e}}(t.childName,t.snapshotNode))}),S7(e,i,"child_removed",t,r,n),S7(e,i,"child_added",t,r,n),S7(e,i,"child_moved",a,r,n),S7(e,i,"child_changed",t,r,n),S7(e,i,"value",t,r,n),i}(e.eventGenerator_,t,n,e.eventRegistrations_)}(e,a.changes,a.viewCache.eventCache.getNode())}function v9(e,t,n,r){var i=t.source.queryId;if(null!==i){var a=e.views.get(i);return uB(null!=a,"SyncTree gave us an op for an invalid query."),d9(a,t,n,r)}var o,s=[],u=Qv(e.views.values());try{for(u.s();!(o=u.n()).done;){var c=o.value;s=s.concat(d9(c,t,n,r))}}catch(l){u.e(l)}finally{u.f()}return s}function p9(e,t){var n,r=null,i=Qv(e.views.values());try{for(i.s();!(n=i.n()).done;){var a=n.value;r=r||f9(a,t)}}catch(o){i.e(o)}finally{i.f()}return r}var g9=rp(function e(t){tp(this,e),this.listenProvider_=t,this.syncPointTree_=new A7(null),this.pendingWriteTree_={visibleWrites:R7.empty(),allWrites:[],lastWriteId:-1},this.tagToQueryMap=new Map,this.queryToTagMap=new Map});function y9(e,t,n,r,i){return function(e,t,n,r,i){uB(r>e.lastWriteId,"Stacking an older write on top of newer ones"),void 0===i&&(i=!0),e.allWrites.push({path:t,snap:n,writeId:r,visible:i}),i&&(e.visibleWrites=N7(e.visibleWrites,t,n)),e.lastWriteId=r}(e.pendingWriteTree_,t,n,r,i),i?w9(e,new C7({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},t,n)):[]}function m9(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=function(e,t){for(var n=0;n<e.allWrites.length;n++){var r=e.allWrites[n];if(r.writeId===t)return r}return null}(e.pendingWriteTree_,t);if(function(e,t){var n=e.allWrites.findIndex(function(e){return e.writeId===t});uB(n>=0,"removeWrite called with nonexistent writeId.");var r=e.allWrites[n];e.allWrites.splice(n,1);for(var i=r.visible,a=!1,o=e.allWrites.length-1;i&&o>=0;){var s=e.allWrites[o];s.visible&&(o>=n&&q7(s,r.path)?i=!1:b8(r.path,s.path)&&(a=!0)),o--}return!!i&&(a?(function(e){e.visibleWrites=W7(e.allWrites,$7,h8()),e.lastWriteId=e.allWrites.length>0?e.allWrites[e.allWrites.length-1].writeId:-1}(e),!0):(r.snap?e.visibleWrites=D7(e.visibleWrites,r.path):F6(r.children,function(t){e.visibleWrites=D7(e.visibleWrites,m8(r.path,t))}),!0))}(e.pendingWriteTree_,t)){var i=new A7(null);return null!=r.snap?i=i.set(h8(),!0):F6(r.children,function(e){i=i.set(new l8(e),!0)}),w9(e,new w7(r.path,i,n))}return[]}function k9(e,t,n){return w9(e,new C7({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,n))}function _9(e,t,n){var r=e.pendingWriteTree_,i=e.syncPointTree_.findOnPath(t,function(e,n){var r=p9(n,_8(e,t));if(r)return r});return j7(r,t,i,n,!0)}function w9(e,t){return C9(t,e.syncPointTree_,null,G7(e.pendingWriteTree_,h8()))}function C9(e,t,n,r){if(k8(e.path))return b9(e,t,n,r);var i=t.get(h8());null==n&&null!=i&&(n=p9(i,h8()));var a=[],o=f8(e.path),s=e.operationForChild(o),u=t.children.get(o);if(u&&s){var c=n?n.getImmediateChild(o):null,l=X7(r,o);a=a.concat(C9(s,u,c,l))}return i&&(a=a.concat(v9(i,e,r,n))),a}function b9(e,t,n,r){var i=t.get(h8());null==n&&null!=i&&(n=p9(i,h8()));var a=[];return t.children.inorderTraversal(function(t,i){var o=n?n.getImmediateChild(t):null,s=X7(r,t),u=e.operationForChild(t);u&&(a=a.concat(b9(u,i,o,s)))}),i&&(a=a.concat(v9(i,e,r,n))),a}function E9(e,t){return e.tagToQueryMap.get(t)}function S9(e){var t=e.indexOf("$");return uB(-1!==t&&t<e.length-1,"Bad queryKey."),{queryId:e.substr(t+1),path:new l8(e.substr(0,t))}}function P9(e,t,n){var r=e.syncPointTree_.get(t);return uB(r,"Missing sync point for query tag that we're tracking"),v9(r,n,G7(e.pendingWriteTree_,t),null)}var O9=function(){function e(t){tp(this,e),this.node_=t}return rp(e,[{key:"getImmediateChild",value:function(t){return new e(this.node_.getImmediateChild(t))}},{key:"node",value:function(){return this.node_}}]),e}(),T9=function(){function e(t,n){tp(this,e),this.syncTree_=t,this.path_=n}return rp(e,[{key:"getImmediateChild",value:function(t){var n=m8(this.path_,t);return new e(this.syncTree_,n)}},{key:"node",value:function(){return _9(this.syncTree_,this.path_)}}]),e}(),I9=function(e,t,n){return e&&"object"==typeof e?(uB(".sv"in e,"Unexpected leaf node or priority contents"),"string"==typeof e[".sv"]?x9(e[".sv"],t,n):"object"==typeof e[".sv"]?A9(e[".sv"],t):void uB(!1,"Unexpected server value: "+JSON.stringify(e,null,2))):e},x9=function(e,t,n){switch(e){case"timestamp":return n.timestamp;default:uB(!1,"Unexpected server value: "+e)}},A9=function(e,t,n){e.hasOwnProperty("increment")||uB(!1,"Unexpected server value: "+JSON.stringify(e,null,2));var r=e.increment;"number"!=typeof r&&uB(!1,"Unexpected increment value: "+r);var i=t.node();if(uB(null!=i,"Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;var a=i.getValue();return"number"!=typeof a?r:a+r},R9=function(e,t,n){return N9(e,new O9(t),n)};function N9(e,t,n){var r,i=e.getPriority().val(),a=I9(i,t.getImmediateChild(".priority"),n);if(e.isLeafNode()){var o=e,s=I9(o.getValue(),t,n);return s!==o.getValue()||a!==o.getPriority().val()?new Z8(s,r7(a)):e}var u=e;return r=u,a!==u.getPriority().val()&&(r=r.updatePriority(new Z8(a))),u.forEachChild(Y8,function(e,i){var a=N9(i,t.getImmediateChild(e),n);a!==i&&(r=r.updateImmediateChild(e,a))}),r}var M9=rp(function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{children:{},childCount:0};tp(this,e),this.name=t,this.parent=n,this.node=r});function D9(e,t){for(var n=t instanceof l8?t:new l8(t),r=e,i=f8(n);null!==i;){var a=DB(r.node.children,i)||{children:{},childCount:0};r=new M9(i,r,a),i=f8(n=v8(n))}return r}function L9(e){return e.node.value}function F9(e,t){e.node.value=t,H9(e)}function B9(e){return e.node.childCount>0}function V9(e,t){F6(e.node.children,function(n,r){t(new M9(n,e,r))})}function U9(e,t,n,r){n&&!r&&t(e),V9(e,function(e){U9(e,t,!0,r)}),n&&r&&t(e)}function z9(e){return new l8(null===e.parent?e.name:z9(e.parent)+"/"+e.name)}function H9(e){null!==e.parent&&function(e,t,n){var r=function(e){return void 0===L9(e)&&!B9(e)}(n),i=MB(e.node.children,t);r&&i?(delete e.node.children[t],e.node.childCount--,H9(e)):!r&&!i&&(e.node.children[t]=n.node,e.node.childCount++,H9(e))}(e.parent,e.name,e)}var G9=/[\[\].#$\/\u0000-\u001F\u007F]/,q9=/[\[\].#$\u0000-\u001F\u007F]/,$9=10485760,W9=function(e){return"string"==typeof e&&0!==e.length&&!G9.test(e)},j9=function(e){return"string"==typeof e&&0!==e.length&&!q9.test(e)},Z9=function(e){return null===e||"string"==typeof e||"number"==typeof e&&!I6(e)||e&&"object"==typeof e&&MB(e,".sv")},Y9=function(e,t,n,r){r&&void 0===t||K9(WB(e,"value"),t,n)},K9=function e(t,n,r){var i=r instanceof l8?new E8(r,t):r;if(void 0===n)throw new Error(t+"contains undefined "+P8(i));if("function"==typeof n)throw new Error(t+"contains a function "+P8(i)+" with contents = "+n.toString());if(I6(n))throw new Error(t+"contains "+n.toString()+" "+P8(i));if("string"==typeof n&&n.length>$9/3&&jB(n)>$9)throw new Error(t+"contains a string greater than "+$9+" utf8 bytes "+P8(i)+" ('"+n.substring(0,50)+"...')");if(n&&"object"==typeof n){var a=!1,o=!1;if(F6(n,function(n,r){if(".value"===n)a=!0;else if(".priority"!==n&&".sv"!==n&&(o=!0,!W9(n)))throw new Error(t+" contains an invalid key ("+n+") "+P8(i)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');(function(e,t){e.parts_.length>0&&(e.byteLength_+=1),e.parts_.push(t),e.byteLength_+=jB(t),S8(e)})(i,n),e(t,r,i),function(e){var t=e.parts_.pop();e.byteLength_-=jB(t),e.parts_.length>0&&(e.byteLength_-=1)}(i)}),a&&o)throw new Error(t+' contains ".value" child '+P8(i)+" in addition to actual children.")}},J9=function(e,t,n,r){if(!(r&&void 0===n||j9(n)))throw new Error(WB(e,t)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},Q9=function(e,t){if(".info"===f8(t))throw new Error(e+" failed = Can't modify data under /.info/")},X9=rp(function e(){tp(this,e),this.eventLists_=[],this.recursionDepth_=0});function eee(e,t){for(var n=null,r=0;r<t.length;r++){var i=t[r],a=i.getPath();null!==n&&!C8(a,n.path)&&(e.eventLists_.push(n),n=null),null===n&&(n={events:[],path:a}),n.events.push(i)}n&&e.eventLists_.push(n)}function tee(e,t,n){eee(e,n),function(e,t){e.recursionDepth_++;for(var n=!0,r=0;r<e.eventLists_.length;r++){var i=e.eventLists_[r];i&&(t(i.path)?(nee(e.eventLists_[r]),e.eventLists_[r]=null):n=!1)}n&&(e.eventLists_=[]),e.recursionDepth_--}(e,function(e){return b8(e,t)||b8(t,e)})}function nee(e){for(var t=0;t<e.events.length;t++){var n=e.events[t];if(null!==n){e.events[t]=null;var r=n.getEventRunner();C6&&E6("event: "+n.toString()),z6(r)}}}var ree=function(){function e(t,n,r,i){tp(this,e),this.repoInfo_=t,this.forceRestClient_=n,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new X9,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=f7(),this.transactionQueueTree_=new M9,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}return rp(e,[{key:"toString",value:function(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}]),e}();function iee(e){var t=e.infoData_.getNode(new l8(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t}function aee(e){return function(e){return(e=e||{}).timestamp=e.timestamp||(new Date).getTime(),e}({timestamp:iee(e)})}function oee(e,t,n,r,i){e.dataUpdateCount++;var a=new l8(t);n=e.interceptServerDataCallback_?e.interceptServerDataCallback_(t,n):n;var o=[];if(i)if(r){var s=FB(n,function(e){return r7(e)});o=function(e,t,n,r){var i=E9(e,r);if(i){var a=S9(i),o=a.path,s=a.queryId,u=_8(o,t),c=A7.fromObject(n);return P9(e,o,new b7(k7(s),u,c))}return[]}(e.serverSyncTree_,a,s,i)}else{var u=r7(n);o=function(e,t,n,r){var i=E9(e,r);if(null!=i){var a=S9(i),o=a.path,s=a.queryId,u=_8(o,t);return P9(e,o,new C7(k7(s),u,n))}return[]}(e.serverSyncTree_,a,u,i)}else if(r){var c=FB(n,function(e){return r7(e)});o=function(e,t,n){var r=A7.fromObject(n);return w9(e,new b7({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,r))}(e.serverSyncTree_,a,c)}else{var l=r7(n);o=k9(e.serverSyncTree_,a,l)}var h=a;o.length>0&&(h=gee(e,a)),tee(e.eventQueue_,h,o)}function see(e,t){uee(e,"connected",t),!1===t&&function(e){fee(e,"onDisconnectEvents");var t=aee(e),n=f7();p7(e.onDisconnect_,h8(),function(r,i){var a=function(e,t,n,r){return N9(t,new T9(n,e),r)}(r,i,e.serverSyncTree_,t);d7(n,r,a)});var r=[];p7(n,h8(),function(t,n){r=r.concat(k9(e.serverSyncTree_,t,n));var i=wee(e,t);gee(e,i)}),e.onDisconnect_=f7(),tee(e.eventQueue_,h8(),r)}(e)}function uee(e,t,n){var r=new l8("/.info/"+t),i=r7(n);e.infoData_.updateSnapshot(r,i);var a=k9(e.infoSyncTree_,r,i);tee(e.eventQueue_,r,a)}function cee(e){return e.nextWriteId_++}function lee(e,t,n){e.server_.onDisconnectCancel(t.toString(),function(r,i){"ok"===r&&v7(e.onDisconnect_,t),dee(0,n,r,i)})}function hee(e,t,n,r){var i=r7(n);e.server_.onDisconnectPut(t.toString(),i.val(!0),function(n,a){"ok"===n&&d7(e.onDisconnect_,t,i),dee(0,r,n,a)})}function fee(e){for(var t="",n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];e.persistentConnection_&&(t=e.persistentConnection_.id+":"),E6.apply(void 0,[t].concat(r))}function dee(e,t,n,r){t&&z6(function(){if("ok"===n)t(null);else{var e=(n||"error").toUpperCase(),i=e;r&&(i+=": "+r);var a=new Error(i);a.code=e,t(a)}})}function vee(e,t,n){return _9(e.serverSyncTree_,t,n)||t7.EMPTY_NODE}function pee(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.transactionQueueTree_;if(t||_ee(e,t),L9(t)){var n=mee(e,t);uB(n.length>0,"Sending zero length transaction queue"),n.every(function(e){return 0===e.status})&&function(e,t,n){for(var r=n.map(function(e){return e.currentWriteId}),i=vee(e,t,r),a=i,o=i.hash(),s=0;s<n.length;s++){var u=n[s];uB(0===u.status,"tryToSendTransactionQueue_: items in queue should all be run."),u.status=1,u.retryCount++;var c=_8(t,u.path);a=a.updateChild(c,u.currentOutputSnapshotRaw)}var l=a.val(!0),h=t;e.server_.put(h.toString(),l,function(r){fee(e,"transaction put response",{path:h.toString(),status:r});var i=[];if("ok"===r){for(var a=[],o=function(t){n[t].status=2,i=i.concat(m9(e.serverSyncTree_,n[t].currentWriteId)),n[t].onComplete&&a.push(function(){return n[t].onComplete(null,!0,n[t].currentOutputSnapshotResolved)}),n[t].unwatcher()},s=0;s<n.length;s++)o(s);_ee(e,D9(e.transactionQueueTree_,t)),pee(e,e.transactionQueueTree_),tee(e.eventQueue_,t,i);for(var u=0;u<a.length;u++)z6(a[u])}else{if("datastale"===r)for(var c=0;c<n.length;c++)n[c].status=3===n[c].status?4:0;else{T6("transaction at "+h.toString()+" failed: "+r);for(var l=0;l<n.length;l++)n[l].status=4,n[l].abortReason=r}gee(e,t)}},o)}(e,z9(t),n)}else B9(t)&&V9(t,function(t){pee(e,t)})}function gee(e,t){var n=yee(e,t),r=z9(n);return function(e,t,n){if(0!==t.length){for(var r=[],i=[],a=t.filter(function(e){return 0===e.status}).map(function(e){return e.currentWriteId}),o=function(o){var s=t[o],u=_8(n,s.path),c=void 0,l=!1;if(uB(null!==u,"rerunTransactionsUnderNode_: relativePath should not be null."),4===s.status)l=!0,c=s.abortReason,i=i.concat(m9(e.serverSyncTree_,s.currentWriteId,!0));else if(0===s.status)if(s.retryCount>=25)l=!0,c="maxretry",i=i.concat(m9(e.serverSyncTree_,s.currentWriteId,!0));else{var h=vee(e,s.path,a);s.currentInputSnapshot=h;var f=t[o].update(h.val());if(void 0!==f){K9("transaction failed: Data returned ",f,s.path);var d=r7(f);"object"==typeof f&&null!=f&&MB(f,".priority")||(d=d.updatePriority(h.getPriority()));var v=s.currentWriteId,p=aee(e),g=R9(d,h,p);s.currentOutputSnapshotRaw=d,s.currentOutputSnapshotResolved=g,s.currentWriteId=cee(e),a.splice(a.indexOf(v),1),i=(i=i.concat(y9(e.serverSyncTree_,s.path,g,s.currentWriteId,s.applyLocally))).concat(m9(e.serverSyncTree_,v,!0))}else l=!0,c="nodata",i=i.concat(m9(e.serverSyncTree_,s.currentWriteId,!0))}tee(e.eventQueue_,n,i),i=[],l&&(t[o].status=2,setTimeout(t[o].unwatcher,Math.floor(0)),t[o].onComplete&&r.push("nodata"===c?function(){return t[o].onComplete(null,!1,t[o].currentInputSnapshot)}:function(){return t[o].onComplete(new Error(c),!1,null)}))},s=0;s<t.length;s++)o(s);_ee(e,e.transactionQueueTree_);for(var u=0;u<r.length;u++)z6(r[u]);pee(e,e.transactionQueueTree_)}}(e,mee(e,n),r),r}function yee(e,t){var n,r=e.transactionQueueTree_;for(n=f8(t);null!==n&&void 0===L9(r);)r=D9(r,n),n=f8(t=v8(t));return r}function mee(e,t){var n=[];return kee(e,t,n),n.sort(function(e,t){return e.order-t.order}),n}function kee(e,t,n){var r=L9(t);if(r)for(var i=0;i<r.length;i++)n.push(r[i]);V9(t,function(t){kee(e,t,n)})}function _ee(e,t){var n=L9(t);if(n){for(var r=0,i=0;i<n.length;i++)2!==n[i].status&&(n[r]=n[i],r++);n.length=r,F9(t,n.length>0?n:void 0)}V9(t,function(t){_ee(e,t)})}function wee(e,t){var n=z9(yee(e,t)),r=D9(e.transactionQueueTree_,t);return function(e,t,n){for(var r=e.parent;null!==r;){if(t(r))return!0;r=r.parent}}(r,function(t){Cee(e,t)}),Cee(e,r),U9(r,function(t){Cee(e,t)}),n}function Cee(e,t){var n=L9(t);if(n){for(var r=[],i=[],a=-1,o=0;o<n.length;o++)3===n[o].status||(1===n[o].status?(uB(a===o-1,"All SENT items should be at beginning of queue."),a=o,n[o].status=3,n[o].abortReason="set"):(uB(0===n[o].status,"Unexpected transaction status in abort"),n[o].unwatcher(),i=i.concat(m9(e.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&r.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));-1===a?F9(t,void 0):n.length=a+1,tee(e.eventQueue_,z9(t),i);for(var s=0;s<r.length;s++)z6(r[s])}}var bee=function(e,t){var n=Eee(e),r=n.namespace;return"firebase.com"===n.domain&&O6(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||"undefined"===r)&&"localhost"!==n.domain&&O6("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&T6("Insecure Firebase access from a secure page. Please use https in calls to new Firebase()."),{repoInfo:new Z6(n.host,n.secure,r,t,"ws"===n.scheme||"wss"===n.scheme,"",r!==n.subdomain),path:new l8(n.pathString)}},Eee=function(e){var t="",n="",r="",i="",a="",o=!0,s="https",u=443;if("string"==typeof e){var c=e.indexOf("//");c>=0&&(s=e.substring(0,c-1),e=e.substring(c+2));var l=e.indexOf("/");-1===l&&(l=e.length);var h=e.indexOf("?");-1===h&&(h=e.length),t=e.substring(0,Math.min(l,h)),l<h&&(i=function(e){for(var t="",n=e.split("/"),r=0;r<n.length;r++)if(n[r].length>0){var i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch(a){}t+="/"+i}return t}(e.substring(l,h)));var f=function(e){var t={};"?"===e.charAt(0)&&(e=e.substring(1));var n,r=Qv(e.split("&"));try{for(r.s();!(n=r.n()).done;){var i=n.value;if(0!==i.length){var a=i.split("=");2===a.length?t[decodeURIComponent(a[0])]=decodeURIComponent(a[1]):T6("Invalid query segment '".concat(i,"' in query '").concat(e,"'"))}}}catch(o){r.e(o)}finally{r.f()}return t}(e.substring(Math.min(e.length,h)));(c=t.indexOf(":"))>=0?(o="https"===s||"wss"===s,u=parseInt(t.substring(c+1),10)):c=t.length;var d=t.slice(0,c);if("localhost"===d.toLowerCase())n="localhost";else if(d.split(".").length<=2)n=d;else{var v=t.indexOf(".");r=t.substring(0,v).toLowerCase(),n=t.substring(v+1),a=r}"ns"in f&&(a=f.ns)}return{host:t,port:u,domain:n,subdomain:r,secure:o,scheme:s,pathString:i,namespace:a}},See=function(){function e(t,n){tp(this,e),this._repo=t,this._path=n}return rp(e,[{key:"cancel",value:function(){var e=new mB;return lee(this._repo,this._path,e.wrapCallback(function(){})),e.promise}},{key:"remove",value:function(){Q9("OnDisconnect.remove",this._path);var e=new mB;return hee(this._repo,this._path,null,e.wrapCallback(function(){})),e.promise}},{key:"set",value:function(e){Q9("OnDisconnect.set",this._path),Y9("OnDisconnect.set",e,this._path,!1);var t=new mB;return hee(this._repo,this._path,e,t.wrapCallback(function(){})),t.promise}},{key:"setWithPriority",value:function(e,t){Q9("OnDisconnect.setWithPriority",this._path),Y9("OnDisconnect.setWithPriority",e,this._path,!1),function(e,t,n){if(I6(t))throw new Error(WB(e,"priority")+"is "+t.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!Z9(t))throw new Error(WB(e,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}("OnDisconnect.setWithPriority",t);var n=new mB;return function(e,t,n,r,i){var a=r7(n,r);e.server_.onDisconnectPut(t.toString(),a.val(!0),function(n,r){"ok"===n&&d7(e.onDisconnect_,t,a),dee(0,i,n,r)})}(this._repo,this._path,e,t,n.wrapCallback(function(){})),n.promise}},{key:"update",value:function(e){Q9("OnDisconnect.update",this._path),function(e,t,n,r){var i=WB("OnDisconnect.update","values");if(!t||"object"!=typeof t||Array.isArray(t))throw new Error(i+" must be an object containing the children to replace.");var a=[];F6(t,function(e,t){var r=new l8(e);if(K9(i,t,m8(n,r)),".priority"===p8(r)&&!Z9(t))throw new Error(i+"contains an invalid value for '"+r.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");a.push(r)}),function(e,t){var n,r;for(n=0;n<t.length;n++)for(var i=g8(r=t[n]),a=0;a<i.length;a++)if((".priority"!==i[a]||a!==i.length-1)&&!W9(i[a]))throw new Error(e+"contains an invalid key ("+i[a]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');t.sort(w8);var o=null;for(n=0;n<t.length;n++){if(r=t[n],null!==o&&b8(o,r))throw new Error(e+"contains a path "+o.toString()+" that is ancestor of another path "+r.toString());o=r}}(i,a)}(0,e,this._path);var t=new mB;return function(e,t,n,r){if(LB(n))return E6("onDisconnect().update() called with empty data.  Don't do anything."),void dee(0,r,"ok",void 0);e.server_.onDisconnectMerge(t.toString(),n,function(i,a){"ok"===i&&F6(n,function(n,r){var i=r7(r);d7(e.onDisconnect_,m8(t,n),i)}),dee(0,r,i,a)})}(this._repo,this._path,e,t.wrapCallback(function(){})),t.promise}}]),e}(),Pee=function(e){Gv(n,e);var t=$v(n);function n(e,r){return tp(this,n),t.call(this,e,r,new s7,!1)}return rp(n,[{key:"parent",get:function(){var e=y8(this._path);return null===e?null:new n(this._repo,e)}},{key:"root",get:function(){for(var e=this;null!==e.parent;)e=e.parent;return e}}]),n}(function(){function e(t,n,r,i){tp(this,e),this._repo=t,this._path=n,this._queryParams=r,this._orderByCalled=i}return rp(e,[{key:"key",get:function(){return k8(this._path)?null:p8(this._path)}},{key:"ref",get:function(){return new Pee(this._repo,this._path)}},{key:"_queryIdentifier",get:function(){var e=c7(this._queryParams),t=D6(e);return"{}"===t?"default":t}},{key:"_queryObject",get:function(){return c7(this._queryParams)}},{key:"isEqual",value:function(t){if(!((t=YB(t))instanceof e))return!1;var n=this._repo===t._repo,r=C8(this._path,t._path);return n&&r&&this._queryIdentifier===t._queryIdentifier}},{key:"toJSON",value:function(){return this.toString()}},{key:"toString",value:function(){return this._repo.toString()+function(e){for(var t="",n=e.pieceNum_;n<e.pieces_.length;n++)""!==e.pieces_[n]&&(t+="/"+encodeURIComponent(String(e.pieces_[n])));return t||"/"}(this._path)}}]),e}());(function(e){uB(!t9,"__referenceConstructor has already been defined"),t9=e})(Pee),function(e){uB(!n9,"__referenceConstructor has already been defined"),n9=e}(Pee);var Oee={};var Tee=function(){function e(t,n){tp(this,e),this._repoInternal=t,this.app=n,this.type="database",this._instanceStarted=!1}return rp(e,[{key:"_repo",get:function(){return this._instanceStarted||(function(e,t,n){if(e.stats_=X6(e.repoInfo_),e.forceRestClient_||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)e.server_=new l7(e.repoInfo_,function(t,n,r,i){oee(e,t,n,r,i)},e.authTokenProvider_,e.appCheckProvider_),setTimeout(function(){return see(e,!0)},0);else{if(null!=n){if("object"!=typeof n)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{RB(n)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}e.persistentConnection_=new A8(e.repoInfo_,t,function(t,n,r,i){oee(e,t,n,r,i)},function(t){see(e,t)},function(t){!function(e,t){F6(t,function(t,n){uee(e,t,n)})}(e,t)},e.authTokenProvider_,e.appCheckProvider_,n),e.server_=e.persistentConnection_}e.authTokenProvider_.addTokenChangeListener(function(t){e.server_.refreshAuthToken(t)}),e.appCheckProvider_.addTokenChangeListener(function(t){e.server_.refreshAppCheckToken(t.token)}),e.statsReporter_=function(e,t){var n=e.toString();return Q6[n]||(Q6[n]=t()),Q6[n]}(e.repoInfo_,function(){return new y7(e.stats_,e.server_)}),e.infoData_=new h7,e.infoSyncTree_=new g9({startListening:function(t,n,r,i){var a=[],o=e.infoData_.getNode(t._path);return o.isEmpty()||(a=k9(e.infoSyncTree_,t._path,o),setTimeout(function(){i("ok")},0)),a},stopListening:function(){}}),uee(e,"connected",!1),e.serverSyncTree_=new g9({startListening:function(t,n,r,i){return e.server_.listen(t,r,n,function(n,r){var a=i(n,r);tee(e.eventQueue_,t._path,a)}),[]},stopListening:function(t,n){e.server_.unlisten(t,n)}})}(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}},{key:"_root",get:function(){return this._rootInternal||(this._rootInternal=new Pee(this._repo,h8())),this._rootInternal}},{key:"_delete",value:function(){return null!==this._rootInternal&&(function(e,t){var n=Oee[t];(!n||n[e.key]!==e)&&O6("Database ".concat(t,"(").concat(e.repoInfo_,") has already been deleted.")),function(e){e.persistentConnection_&&e.persistentConnection_.interrupt("repo_interrupt")}(e),delete n[e.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}},{key:"_checkNotDeleted",value:function(e){null===this._rootInternal&&O6("Cannot call "+e+" on a deleted database.")}}]),e}();var Iee={".sv":"timestamp"};function xee(){return Iee}A8.prototype.simpleListen=function(e,t){this.sendRequest("q",{p:e},t)},A8.prototype.echo=function(e,t){this.sendRequest("echo",{d:e},t)},f6="9.6.6",pV(new KB("database",function(e,t){var n=t.instanceIdentifier;return function(e,t,n,r,i){var a=r||e.options.databaseURL;void 0===a&&(e.options.projectId||O6("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),E6("Using default host for project ",e.options.projectId),a="".concat(e.options.projectId,"-default-rtdb.firebaseio.com"));var o,s,u=bee(a,i),c=u.repoInfo;"undefined"!=typeof process&&(s=process.env.FIREBASE_DATABASE_EMULATOR_HOST),s?(o=!0,a="http://".concat(s,"?ns=").concat(c.namespace),c=(u=bee(a,i)).repoInfo):o=!u.repoInfo.secure;var l=i&&o?new $6($6.OWNER):new q6(e.name,e.options,t);(function(e,t){var n=t.path.toString();if("string"!=typeof t.repoInfo.host||0===t.repoInfo.host.length||!W9(t.repoInfo.namespace)&&"localhost"!==t.repoInfo.host.split(":")[0]||0!==n.length&&!function(e){return e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),j9(e)}(n))throw new Error(WB("Invalid Firebase Database URL","url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')})(0,u),k8(u.path)||O6("Database URL must point to the root of a Firebase Database (not including a child path).");var h=function(e,t,n,r){var i=Oee[t.name];i||(i={},Oee[t.name]=i);var a=i[e.toURLString()];return a&&O6("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),a=new ree(e,!1,n,r),i[e.toURLString()]=a,a}(c,e,l,new G6(e.name,n));return new Tee(h,e)}(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"),e.getProvider("app-check-internal"),n)},"PUBLIC").setMultipleInstances(!0)),CV(h6,"0.12.5",void 0),CV(h6,"0.12.5","esm2017");var Aee=rp(function e(t){return tp(this,e),t}),Ree=new ok("angularfire2.database-instances");function Nee(e){return function(t,n){var r=t.runOutsideAngular(function(){return e(n)});return new Aee(r)}}var Mee={provide:rp(function e(){return tp(this,e),JH("database")}),deps:[[new Mk,Ree]]},Dee={provide:Aee,useFactory:function(e,t){var n=KH("database",e,t);return n&&new Aee(n)},deps:[[new Mk,Ree],uG]},Lee=function(){var e=rp(function e(){tp(this,e),CV("angularfire",WH.full,"rtdb")});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=iy({type:e}),e.\u0275inj=Sg({providers:[Dee,Mee]}),e}(),Fee=sG(function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};(e=YB(e))._checkNotDeleted("useEmulator"),e._instanceStarted&&O6("Cannot call useEmulator() after instance has already been initialized.");var i,a=e._repoInternal;if(a.repoInfo_.nodeAdmin)r.mockUserToken&&O6('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),i=new $6($6.OWNER);else if(r.mockUserToken){var o="string"==typeof r.mockUserToken?r.mockUserToken:kB(r.mockUserToken,e.app.options.projectId);i=new $6(o)}!function(e,t,n,r){e.repoInfo_=new Z6("".concat(t,":").concat(n),!1,e.repoInfo_.namespace,e.repoInfo_.webSocketOnly,e.repoInfo_.nodeAdmin,e.repoInfo_.persistenceKey,e.repoInfo_.includeNamespaceInQueryParams),r&&(e.authTokenProvider_=r)}(a,t,n,i)},!0),Bee=sG(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_V(),t=arguments.length>1?arguments[1]:void 0;return gV(e,"database").getImmediate({identifier:t})},!0),Vee=sG(function(e){return e=YB(e),new See(e._repo,e._path)},!0),Uee=sG(function(e,t){return(e=YB(e))._checkNotDeleted("ref"),void 0!==t?function(e,t){return null===f8((e=YB(e))._path)?((n=t)&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),J9("child","path",n,!1)):J9("child","path",t,!1),new Pee(e._repo,m8(e._path,t));var n}(e._root,t):e._root},!0),zee=sG(function(e,t){e=YB(e),Q9("set",e._path),Y9("set",t,e._path,!1);var n=new mB;return function(e,t,n,r,i){fee(e,"set",{path:t.toString(),value:n,priority:null});var a=aee(e),o=r7(n,null),s=_9(e.serverSyncTree_,t),u=R9(o,s,a),c=cee(e),l=y9(e.serverSyncTree_,t,u,c,!0);eee(e.eventQueue_,l),e.server_.put(t.toString(),o.val(!0),function(n,r){var a="ok"===n;a||T6("set at "+t+" failed: "+n);var o=m9(e.serverSyncTree_,c,!a);tee(e.eventQueue_,t,o),dee(0,i,n,r)});var h=wee(e,t);gee(e,h),tee(e.eventQueue_,h,[])}(e._repo,e._path,t,0,n.wrapCallback(function(){})),n.promise},!0),Hee=function(){function e(t){tp(this,e),this.db=t}return rp(e,[{key:"setOffline",value:function(t){return zee(Uee(this.db,"/status/"+t),e.OFFLINE)}},{key:"launchAutomaticPresenceUpdate",value:function(t){var n=this;return tB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=Uee(n.db,"/status/"+t),r.next=3,zee(i,e.ONLINE);case 3:return r.next=5,Vee(i).set(e.OFFLINE);case 5:case"end":return r.stop()}},r)}))()}}]),e}();Hee.OFFLINE={state:"offline",last_changed:xee()},Hee.ONLINE={state:"online",last_changed:xee()},Hee.\u0275fac=function(e){return new(e||Hee)(Pk(Aee))},Hee.\u0275prov=Eg({token:Hee,factory:Hee.\u0275fac,providedIn:"root"});var Gee=function(){function e(){tp(this,e)}return rp(e,null,[{key:"createUserWithEmailAndPassword",value:function(e,t,n){return pj(e,t,n)}},{key:"sendEmailVerification",value:function(e){return mj(e)}},{key:"sendPasswordResetEmail",value:function(e,t){return kj(e,t)}},{key:"signInWithEmailAndPassword",value:function(e,t,n){return tB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,_j(e,t,n);case 2:return r.abrupt("return",r.sent.user);case 3:case"end":return r.stop()}},r)}))()}},{key:"signInWithPopup",value:function(e,t){return tB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,wj(e,t);case 2:return n.abrupt("return",n.sent.user);case 3:case"end":return n.stop()}},n)}))()}},{key:"updateProfile",value:function(e,t){return Cj(e,t)}}]),e}(),qee=function(){function e(t,n,r,i){tp(this,e),this.userId=t,this.email=n,this.username=r,this.verified=i}return rp(e,[{key:"isConnected",value:function(){return this.email.isPresent()}},{key:"toMinimalUser",value:function(){return{id:this.userId,name:this.username.get()}}}]),e}();qee.NOT_CONNECTED=new qee("",sB.empty(),sB.empty(),!1);var $ee=function(){var e=function(){function e(t,n,r){tp(this,e);var i,a=this;this.userDAO=t,this.auth=n,this.connectivityDAO=r,this.user=sB.empty(),this.uid=sB.empty(),this.userUnsubscribe=sB.empty(),rB(e.VERBOSE,"AuthenticationService constructor"),this.userRS=new l6(1),this.userObs=this.userRS.asObservable(),this.unsubscribeFromAuth=yj(this.auth,(i=tB(regeneratorRuntime.mark(function t(n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(null!=n){t.next=4;break}rB(e.VERBOSE,"User is not connected"),a.userUnsubscribe.isPresent()&&a.userUnsubscribe.get()(),a.userRS.next(qee.NOT_CONNECTED),a.user=sB.empty(),a.uid=sB.empty(),t.next=9;break;case 4:return X5(a.uid.isAbsent(),"AuthenticationService received a double update for an user, this is unexpected"),a.uid=sB.of(n.uid),t.next=8,a.connectivityDAO.launchAutomaticPresenceUpdate(n.uid);case 8:a.userUnsubscribe=sB.of(a.userDAO.subscribeToChanges(n.uid,function(t){if(t.isPresent()){var r=t.get().username;rB(e.VERBOSE,"User ".concat(r," is connected, and the verified status is ").concat(a.emailVerified(n)));var i=!0===a.emailVerified(n)&&null!=r;if(!0===i&&!1===t.get().verified)return a.userDAO.markVerified(n.uid);var o=new qee(n.uid,sB.ofNullable(n.email),sB.ofNullable(r),i);a.user=sB.of(o),a.userRS.next(o)}}));case 9:case"end":return t.stop()}},t)})),function(e){return i.apply(this,arguments)}))}return rp(e,[{key:"emailVerified",value:function(e){return e.emailVerified}},{key:"sendPasswordResetEmail",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,Gee.sendPasswordResetEmail(t.auth,e);case 3:return n.abrupt("return",K5.SUCCESS);case 6:return n.prev=6,n.t0=n.catch(0),n.abrupt("return",K5.failure(t.mapFirebaseError(n.t0)));case 9:case"end":return n.stop()}},n,null,[[0,6]])}))()}},{key:"doRegister",value:function(t,r,i){var a=this;return tB(regeneratorRuntime.mark(function o(){return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return rB(e.VERBOSE,"AuthenticationService.doRegister("+r+")"),o.next=3,a.userDAO.usernameIsAvailable(t);case 3:if(!o.sent){o.next=7;break}o.t0=a.registerAfterUsernameCheck(t,r,i),o.next=8;break;case 7:o.t0=j5.failure($localize(n||(n=Rv(["This username is already in use."]))));case 8:return o.abrupt("return",o.t0);case 9:case"end":return o.stop()}},o)}))()}},{key:"registerAfterUsernameCheck",value:function(e,t,n){var r=this;return tB(regeneratorRuntime.mark(function i(){var a,o;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,Gee.createUserWithEmailAndPassword(r.auth,t,n);case 3:return a=i.sent,o=nB.getNonNullable(a.user),i.next=7,r.createUser(o.uid,e);case 7:return i.abrupt("return",j5.success(o));case 10:return i.prev=10,i.t0=i.catch(0),i.abrupt("return",j5.failure(r.mapFirebaseError(i.t0)));case 13:case"end":return i.stop()}},i,null,[[0,10]])}))()}},{key:"mapFirebaseError",value:function(e){switch(e.code){case"auth/email-already-in-use":return $localize(r||(r=Rv(["This email address is already in use."])));case"auth/invalid-email":return $localize(i||(i=Rv(["This email address is invalid."])));case"auth/user-not-found":case"auth/wrong-password":return $localize(a||(a=Rv(["You have entered invalid credentials."])));case"auth/invalid-credential":return $localize(o||(o=Rv(["The credential is invalid or has expired, please try again."])));case"auth/weak-password":return $localize(s||(s=Rv(["Your password is too weak, please use a stronger password."])));case"auth/too-many-requests":return $localize(u||(u=Rv(["There has been too many requests from your device. You are temporarily blocked due to unusual activity. Try again later."])));case"auth/popup-closed-by-user":return $localize(c||(c=Rv(["You closed the authentication popup without finalizing your log in."])));default:return Q5.logError("AuthenticationService","Unsupported firebase error",{errorCode:e.code,errorMessage:e.message}),e.message}}},{key:"sendEmailVerification",value:function(){var t=this;return tB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(rB(e.VERBOSE,"AuthenticationService.sendEmailVerification()"),(r=sB.ofNullable(t.auth.currentUser)).isPresent()){n.next=4;break}return n.abrupt("return",Q5.logError("AuthenticationService","Unlogged users cannot request for email verification"));case 4:if(!t.emailVerified(r.get())){n.next=6;break}return n.abrupt("return",Q5.logError("AuthenticationService","Verified users should not ask email verification after being verified"));case 6:return n.prev=6,n.next=9,Gee.sendEmailVerification(r.get());case 9:return n.abrupt("return",K5.SUCCESS);case 12:return n.prev=12,n.t0=n.catch(6),n.abrupt("return",K5.failure(t.mapFirebaseError(n.t0)));case 15:case"end":return n.stop()}},n,null,[[6,12]])}))()}},{key:"doEmailLogin",value:function(t,n){var r=this;return tB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return rB(e.VERBOSE,"AuthenticationService.doEmailLogin("+t+")"),i.prev=1,i.next=4,Gee.signInWithEmailAndPassword(r.auth,t,n);case 4:return i.abrupt("return",K5.SUCCESS);case 7:return i.prev=7,i.t0=i.catch(1),i.abrupt("return",K5.failure(r.mapFirebaseError(i.t0)));case 10:case"end":return i.stop()}},i,null,[[1,7]])}))()}},{key:"createUser",value:function(e,t){var n=this;return tB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(null!=t){r.next=5;break}return r.next=3,n.userDAO.set(e,{verified:!1});case 3:r.next=7;break;case 5:return r.next=7,n.userDAO.set(e,{username:t,verified:!1});case 7:case"end":return r.stop()}},r)}))()}},{key:"doGoogleLogin",value:function(){var e=this;return tB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=K5,t.next=3,e.registerOrLoginWithGoogle();case 3:return t.t1=t.sent,t.abrupt("return",t.t0.ofFallible.call(t.t0,t.t1));case 5:case"end":return t.stop()}},t)}))()}},{key:"registerOrLoginWithGoogle",value:function(){var e=this;return tB(regeneratorRuntime.mark(function t(){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,(n=new x$).addScope("profile"),n.addScope("email"),t.next=5,Gee.signInWithPopup(e.auth,n);case 5:return r=t.sent,t.t0=!1,t.next=9,e.userDAO.exists(r.uid);case 9:if(t.t1=t.sent,t.t2=t.t0===t.t1,!t.t2){t.next=14;break}return t.next=14,e.createUser(r.uid);case 14:return t.abrupt("return",j5.success(r));case 17:return t.prev=17,t.t3=t.catch(0),t.abrupt("return",j5.failure(e.mapFirebaseError(t.t3)));case 20:case"end":return t.stop()}},t,null,[[0,17]])}))()}},{key:"disconnect",value:function(){var e=this;return tB(regeneratorRuntime.mark(function t(){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(n=sB.ofNullable(e.auth.currentUser)).isPresent()){t.next=8;break}return r=n.get().uid,t.next=5,e.connectivityDAO.setOffline(r);case 5:return t.next=7,e.auth.signOut();case 7:return t.abrupt("return",K5.SUCCESS);case 8:return t.abrupt("return",K5.failure("Cannot disconnect a non-connected user"));case 9:case"end":return t.stop()}},t)}))()}},{key:"getUserObs",value:function(){return this.userObs}},{key:"setUsername",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(""!==e){n.next=2;break}return n.abrupt("return",K5.failure($localize(l||(l=Rv(["Your username may not be empty."])))));case 2:return n.prev=2,n.t0=!1,n.next=6,t.userDAO.usernameIsAvailable(e);case 6:if(n.t1=n.sent,n.t0!==n.t1){n.next=9;break}return n.abrupt("return",K5.failure($localize(h||(h=Rv(["This username is already in use, please select a different one."])))));case 9:return r=nB.getNonNullable(t.auth.currentUser),n.next=12,Gee.updateProfile(r,{displayName:e});case 12:return n.next=14,t.userDAO.setUsername(r.uid,e);case 14:return n.next=16,t.userDAO.markVerified(r.uid);case 16:return n.next=18,t.reloadUser();case 18:return n.abrupt("return",K5.SUCCESS);case 21:return n.prev=21,n.t2=n.catch(2),n.abrupt("return",K5.failure(t.mapFirebaseError(n.t2)));case 24:case"end":return n.stop()}},n,null,[[2,21]])}))()}},{key:"setPicture",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,r=nB.getNonNullable(t.auth.currentUser),n.next=4,Gee.updateProfile(r,{photoURL:e});case 4:return n.abrupt("return",K5.SUCCESS);case 7:return n.prev=7,n.t0=n.catch(0),n.abrupt("return",K5.failure(t.mapFirebaseError(n.t0)));case 10:case"end":return n.stop()}},n,null,[[0,7]])}))()}},{key:"reloadUser",value:function(){var e=this;return tB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=nB.getNonNullable(e.auth.currentUser),t.next=3,n.getIdToken(!0);case 3:return t.next=5,n.reload();case 5:case"end":return t.stop()}},t)}))()}},{key:"ngOnDestroy",value:function(){this.userUnsubscribe.isPresent()&&this.userUnsubscribe.get()(),this.unsubscribeFromAuth()}}]),e}();return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(Pk(s6),Pk(oj),Pk(Hee))},e.\u0275prov=Eg({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),Wee=function(){function e(t){tp(this,e),this.value=t}return rp(e,null,[{key:"of",value:function(t){switch(t){case"CREATOR":return e.CREATOR;case"RANDOM":return e.RANDOM;default:return X5("CHOSEN_PLAYER"===t,"Invalid value for FirstPlayer: "+t+"."),e.CHOSEN_PLAYER}}}]),e}();Wee.CREATOR=new Wee("CREATOR"),Wee.RANDOM=new Wee("RANDOM"),Wee.CHOSEN_PLAYER=new Wee("CHOSEN_PLAYER");var jee=function(){function e(t){tp(this,e),this.value=t}return rp(e,null,[{key:"of",value:function(t){switch(t){case"STANDARD":return e.STANDARD;case"BLITZ":return e.BLITZ;case"CUSTOM":return e.CUSTOM;default:throw new Error("Invalid part type: "+t+".")}}}]),e}();jee.STANDARD=new jee("STANDARD"),jee.BLITZ=new jee("BLITZ"),jee.CUSTOM=new jee("CUSTOM"),jee.NORMAL_MOVE_DURATION=120,jee.NORMAL_PART_DURATION=1800,jee.BLITZ_MOVE_DURATION=30,jee.BLITZ_PART_DURATION=900;var Zee=rp(function e(t){tp(this,e),this.value=t});Zee.PART_CREATED=new Zee(0),Zee.CONFIG_PROPOSED=new Zee(2),Zee.PART_STARTED=new Zee(3),Zee.PART_FINISHED=new Zee(4);var Yee=rp(function e(){tp(this,e)}),Kee=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"encode",value:function(e){return this.encodeMove(e)}},{key:"decode",value:function(e){return X5(!1===Array.isArray(e),"MoveEncoder.decode called with an array"),this.decodeMove(e)}}],[{key:"disjunction3",value:function(e,t,r,i,a){return new(function(n){Gv(s,n);var o=$v(s);function s(){return tp(this,s),o.apply(this,arguments)}return rp(s,[{key:"encodeMove",value:function(n){return i(n)?{type:"T1",encoded:e.encode(n)}:a(n)?{type:"T2",encoded:t.encode(n)}:{type:"T3",encoded:r.encode(n)}}},{key:"decodeMove",value:function(n){var i=nB.getNonNullable(n).type,a=nB.getNonNullable(n).encoded;return"T1"===i?e.decode(a):"T2"===i?t.decode(a):r.decode(a)}}]),s}(n))}}]),n}(Yee),Jee=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"shift",value:function(){return this.maxValue()+1}},{key:"encodeMove",value:function(e){return this.encodeNumber(e)}},{key:"decodeMove",value:function(e){return X5("number"==typeof e,"Invalid encoded number"),this.decodeNumber(e)}}],[{key:"ofN",value:function(e,t,r){return new(function(n){Gv(a,n);var i=$v(a);function a(){return tp(this,a),i.apply(this,arguments)}return rp(a,[{key:"maxValue",value:function(){return e}},{key:"encodeNumber",value:function(e){return t(e)}},{key:"decodeNumber",value:function(e){return r(e)}}]),a}(n))}},{key:"tuple",value:function(e,t,r){return new(function(n){Gv(a,n);var i=$v(a);function a(){return tp(this,a),i.apply(this,arguments)}return rp(a,[{key:"maxValue",value:function(){var t=0;return Object.keys(e).forEach(function(n){t=t*e[n].shift()+e[n].maxValue()}),t}},{key:"encodeNumber",value:function(n){var r=t(n),i=0;return Object.keys(r).forEach(function(t){i=i*e[t].shift()+e[t].encode(r[t])}),i}},{key:"decodeNumber",value:function(t){var n={},i=t;return Object.keys(e).reverse().forEach(function(t){var r=i%e[t].shift();i=(i-r)/e[t].shift(),n[t]=e[t].decode(r)}),r(n)}}]),a}(n))}},{key:"disjunction",value:function(e,t,r){return new(function(n){Gv(a,n);var i=$v(a);function a(){return tp(this,a),i.apply(this,arguments)}return rp(a,[{key:"maxValue",value:function(){return Math.max(2*e.maxValue(),2*t.maxValue()+1)}},{key:"encodeNumber",value:function(n){return r(n)?2*e.encodeNumber(n):2*t.encodeNumber(n)+1}},{key:"decodeNumber",value:function(n){return n%2==0?e.decodeNumber(n/2):t.decodeNumber((n-1)/2)}}]),a}(n))}},{key:"numberEncoder",value:function(e){return new(function(t){Gv(r,t);var n=$v(r);function r(){return tp(this,r),n.apply(this,arguments)}return rp(r,[{key:"maxValue",value:function(){return e}},{key:"encodeNumber",value:function(t){if(t>e)throw new Error("Cannot encode number bigger than the max with numberEncoder");return t}},{key:"decodeNumber",value:function(t){if(t>e)throw new Error("Cannot decode number bigger than the max with numberEncoder");return t}}]),r}(n))}}]),n}(Kee);Jee.booleanEncoder=new(function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"maxValue",value:function(){return 1}},{key:"encodeNumber",value:function(e){return e?1:0}},{key:"decodeNumber",value:function(e){if(0===e)return!1;if(1===e)return!0;throw new Error("Invalid encoded boolean")}}]),n}(Jee));var Qee=function(){function e(){tp(this,e),this.value=2}return rp(e,[{key:"isPlayer",value:function(){return!1}},{key:"toString",value:function(){return"PlayerNone"}},{key:"equals",value:function(e){return this===e}}]),e}();Qee.NONE=new Qee;var Xee,ete=function(){function e(t){tp(this,e),this.value=t}return rp(e,[{key:"isPlayer",value:function(){return!0}},{key:"toString",value:function(){return"Player "+this.value}},{key:"equals",value:function(e){return this===e}},{key:"getScoreModifier",value:function(){return 0===this.value?-1:1}},{key:"getPreVictory",value:function(){return this.getVictoryValue()-this.getScoreModifier()}},{key:"getDefeatValue",value:function(){return this===e.ZERO?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER}},{key:"getVictoryValue",value:function(){return this===e.ZERO?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER}},{key:"getOpponent",value:function(){switch(this){case e.ZERO:return e.ONE;default:return nB.expectToBe(this,e.ONE),e.ZERO}}}],[{key:"of",value:function(t){switch(t){case 0:return e.ZERO;default:return nB.expectToBe(t,1),e.ONE}}},{key:"fromTurn",value:function(t){return t%2==0?e.ZERO:e.ONE}}]),e}();ete.numberEncoder=Jee.ofN(2,function(e){return e.value},function(e){return 2===e?Xee.NONE:ete.of(e)}),ete.ZERO=new ete(0),ete.ONE=new ete(1),function(e){e.ZERO=ete.ZERO,e.ONE=ete.ONE,e.NONE=Qee.NONE}(Xee||(Xee={}));var tte=function(){function e(){tp(this,e)}return rp(e,null,[{key:"rematchAccepted",value:function(e,t){return nte("RematchAccepted",{typeGame:e,partId:t})}},{key:"getPlayer",value:function(e){return ete.of(nB.getNonNullable(e.data).player)}},{key:"getTypeGame",value:function(e){return nB.getNonNullable(e.data).typeGame}},{key:"getPartId",value:function(e){return nB.getNonNullable(e.data).partId}}]),e}();function nte(e,t){return{code:e,data:t}}function rte(e){return function(t){return nte(e,{player:t.value})}}tte.drawProposed=rte("DrawProposed"),tte.drawAccepted=nte("DrawAccepted",{}),tte.drawRefused=rte("DrawRefused"),tte.takeBackAsked=rte("TakeBackAsked"),tte.takeBackRefused=rte("TakeBackRefused"),tte.takeBackAccepted=rte("TakeBackAccepted"),tte.rematchProposed=rte("RematchProposed"),tte.addTurnTime=rte("AddTurnTime"),tte.addGlobalTime=rte("AddGlobalTime");var ite=function(){function e(){tp(this,e)}return rp(e,null,[{key:"mapBiArray",value:function(e,t){for(var n=[],r=0;r<e.length;){n[r]=[];for(var i=0;i<e[r].length;)n[r][i]=t(e[r][i]),i++;r++}return n}},{key:"createTable",value:function(e,t,n){for(var r=[],i=t-1;i>=0;){r[i]=[];for(var a=e-1;a>=0;)r[i][a]=n,a--;i--}return r}},{key:"copyBiArray",value:function(t){for(var n=[],r=0;r<t.length;)n[r]=e.copyImmutableArray(t[r]),r++;return n}},{key:"copyImmutableArray",value:function(e){for(var t=[],n=0;n<e.length;)t[n]=e[n],n++;return t}},{key:"sortByDescending",value:function(e,t){e.sort(function(e,n){var r=t(e),i=t(n);return r<i?1:r>i?-1:0})}},{key:"compareArray",value:function(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(!1===oB(e[n],t[n]))return!1;return!0}},{key:"compareTable",value:function(t,n){if(t.length!==n.length)return!1;for(var r=0;r<t.length;r++)if(!1===e.compareArray(t[r],n[r]))return!1;return!0}}]),e}(),ate=function(){var e=function(e){Gv(n,e);var t=$v(n);function n(e){var r;return tp(this,n),r=t.call(this,"joiners",e),rB(n.VERBOSE,"JoinerDAO.constructor"),r}return rp(n)}(W5);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(Pk(S5))},e.\u0275prov=Eg({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),ote=function(){var e=function(){function e(t){tp(this,e),this.joinerDAO=t,this.joinerUnsubscribe=sB.empty(),rB(e.VERBOSE,"JoinerService.constructor")}return rp(e,[{key:"subscribeToChanges",value:function(e,t){this.observedJoinerId=e,this.joinerUnsubscribe=sB.of(this.joinerDAO.subscribeToChanges(e,t))}},{key:"unsubscribe",value:function(){X5(this.joinerUnsubscribe.isPresent(),"JoinerService cannot unsubscribe if no joiner is observed"),this.joinerUnsubscribe.get()(),this.joinerUnsubscribe=sB.empty()}},{key:"createInitialJoiner",value:function(t,n){var r=this;return tB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(rB(e.VERBOSE,"JoinerService.createInitialJoiner("+t.id+", "+n+")"),r.set(n,{candidates:[],chosenPlayer:null,firstPlayer:Wee.RANDOM.value,partType:jee.STANDARD.value,partStatus:Zee.PART_CREATED.value,maximalMoveDuration:jee.NORMAL_MOVE_DURATION,totalPartDuration:jee.NORMAL_PART_DURATION,creator:t})));case 1:case"end":return i.stop()}},i)}))()}},{key:"joinGame",value:function(t,n){var r=this;return tB(regeneratorRuntime.mark(function i(){var a,o;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return rB(e.VERBOSE,"JoinerService.joinGame("+t+", "+n+")"),i.next=3,r.joinerDAO.read(t);case 3:if(!(a=i.sent).isAbsent()){i.next=6;break}return i.abrupt("return",K5.failure("Game does not exist"));case 6:if(!(o=ite.copyImmutableArray(a.get().candidates)).includes(n)){i.next=11;break}i.t0=K5.failure("User already in the game"),i.next=17;break;case 11:if(i.t1=n===a.get().creator.name,i.t1){i.next=16;break}return o[o.length]=n,i.next=16,r.joinerDAO.update(t,{candidates:o});case 16:i.t0=K5.SUCCESS;case 17:return i.abrupt("return",i.t0);case 18:case"end":return i.stop()}},i)}))()}},{key:"cancelJoining",value:function(t){var n=this;return tB(regeneratorRuntime.mark(function r(){var i,a,o,s,u,c;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(rB(e.VERBOSE,"JoinerService.cancelJoining("+t+"); this.observedJoinerId = "+n.observedJoinerId),null!=n.observedJoinerId){r.next=2;break}throw new Error("cannot cancel joining when not observing a joiner");case 2:return r.next=4,n.joinerDAO.read(n.observedJoinerId);case 4:if((i=r.sent).isAbsent()){r.next=15;break}if(a=i.get(),o=ite.copyImmutableArray(a.candidates),s=o.indexOf(t),u=a.chosenPlayer,c=a.partStatus,o.splice(s,1),u!==t){r.next=12;break}u=null,c=Zee.PART_CREATED.value,r.next=14;break;case 12:if(-1!==s){r.next=14;break}throw new Error("someone that was not candidate nor chosenPlayer just left the chat: "+t);case 14:return r.abrupt("return",n.joinerDAO.update(n.observedJoinerId,{chosenPlayer:u,partStatus:c,candidates:o}));case 15:case"end":return r.stop()}},r)}))()}},{key:"updateCandidates",value:function(t){var n=this;return tB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(rB(e.VERBOSE,"JoinerService.reviewConfig"),X5(null!=n.observedJoinerId,"JoinerService is not observing a joiner"),n.joinerDAO.update(n.observedJoinerId,{candidates:t})));case 1:case"end":return r.stop()}},r)}))()}},{key:"deleteJoiner",value:function(){var t=this;return tB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(rB(e.VERBOSE,"JoinerService.deleteJoiner(); this.observedJoinerId = "+t.observedJoinerId),X5(null!=t.observedJoinerId,"JoinerService is not observing a joiner"),t.joinerDAO.delete(t.observedJoinerId)));case 1:case"end":return n.stop()}},n)}))()}},{key:"proposeConfig",value:function(t,n,r,i,a){var o=this;return tB(regeneratorRuntime.mark(function s(){return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(rB(e.VERBOSE,{joinerService_proposeConfig:{maximalMoveDuration:r,firstPlayer:i,totalPartDuration:a}}),rB(e.VERBOSE,"this.followedJoinerId: "+o.observedJoinerId),X5(null!=o.observedJoinerId,"JoinerService is not observing a joiner"),o.joinerDAO.update(o.observedJoinerId,{partStatus:Zee.CONFIG_PROPOSED.value,chosenPlayer:t,partType:n.value,maximalMoveDuration:r,totalPartDuration:a,firstPlayer:i.value})));case 1:case"end":return s.stop()}},s)}))()}},{key:"setChosenPlayer",value:function(t){return rB(e.VERBOSE,"JoinerService.setChosenPlayer(".concat(t,")")),X5(null!=this.observedJoinerId,"JoinerService is not observing a joiner"),this.joinerDAO.update(this.observedJoinerId,{chosenPlayer:t})}},{key:"reviewConfig",value:function(){var t=this;return tB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(rB(e.VERBOSE,"JoinerService.reviewConfig"),X5(null!=t.observedJoinerId,"JoinerService is not observing a joiner"),t.joinerDAO.update(t.observedJoinerId,{partStatus:Zee.PART_CREATED.value})));case 1:case"end":return n.stop()}},n)}))()}},{key:"reviewConfigRemoveChosenPlayerAndUpdateCandidates",value:function(t){var n=this;return tB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(rB(e.VERBOSE,"JoinerService.reviewConfig"),X5(null!=n.observedJoinerId,"JoinerService is not observing a joiner"),n.joinerDAO.update(n.observedJoinerId,{partStatus:Zee.PART_CREATED.value,chosenPlayer:null,candidates:t})));case 1:case"end":return r.stop()}},r)}))()}},{key:"acceptConfig",value:function(){return rB(e.VERBOSE,"JoinerService.acceptConfig"),X5(null!=this.observedJoinerId,"JoinerService is not observing a joiner"),this.joinerDAO.update(this.observedJoinerId,{partStatus:Zee.PART_STARTED.value})}},{key:"createJoiner",value:function(t){var n=this;return tB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(rB(e.VERBOSE,"JoinerService.create("+JSON.stringify(t)+")"),n.joinerDAO.create(t)));case 1:case"end":return r.stop()}},r)}))()}},{key:"readJoinerById",value:function(t){var n=this;return tB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return rB(e.VERBOSE,"JoinerService.readJoinerById("+t+")"),r.next=3,n.joinerDAO.read(t);case 3:return r.abrupt("return",r.sent.get());case 4:case"end":return r.stop()}},r)}))()}},{key:"set",value:function(t,n){var r=this;return tB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(rB(e.VERBOSE,"JoinerService.set("+t+", "+JSON.stringify(n)+")"),r.joinerDAO.set(t,n)));case 1:case"end":return i.stop()}},i)}))()}},{key:"updateJoinerById",value:function(t,n){var r=this;return tB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(rB(e.VERBOSE,{joinerService_updateJoinerById:{partId:t,update:n}}),r.joinerDAO.update(t,n)));case 1:case"end":return i.stop()}},i)}))()}}]),e}();return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(Pk(ate))},e.\u0275prov=Eg({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),ste=function(){var e=function(){function e(t,n,r){tp(this,e),this.partDAO=t,this.joinerService=n,this.chatService=r,this.followedPartId=sB.empty(),rB(e.VERBOSE,"GameService.constructor")}return rp(e,[{key:"getPartValidity",value:function(e,t){var n=this;return tB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.partDAO.read(e);case 2:return i=r.sent,r.abrupt("return",i.isAbsent()?K5.failure("NONEXISTENT_PART"):i.get().typeGame===t?K5.SUCCESS:K5.failure("WRONG_GAME_TYPE"));case 4:case"end":return r.stop()}},r)}))()}},{key:"createUnstartedPart",value:function(t,n){return rB(e.VERBOSE,"GameService.createPart("+t+", "+n+")"),this.partDAO.create({lastUpdate:{index:0,player:0},typeGame:n,playerZero:t,turn:-1,result:e6.UNACHIEVED.value,listMoves:[]})}},{key:"createChat",value:function(t){return rB(e.VERBOSE,"GameService.createChat("+t+")"),this.chatService.createNewChat(t)}},{key:"createPartJoinerAndChat",value:function(t,n){var r=this;return tB(regeneratorRuntime.mark(function i(){var a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return rB(e.VERBOSE,"GameService.createGame(".concat(t.id,", ").concat(n,")")),i.next=3,r.createUnstartedPart(t.name,n);case 3:return a=i.sent,i.next=6,r.joinerService.createInitialJoiner(t,a);case 6:return i.next=8,r.createChat(a);case 8:return i.abrupt("return",a);case 9:case"end":return i.stop()}},i)}))()}},{key:"startGameWithConfig",value:function(t,n,r,i){rB(e.VERBOSE,"GameService.startGameWithConfig("+t+", "+JSON.stringify(i));var a=this.getStartingConfig(i);return this.partDAO.updateAndBumpIndex(t,n,r,a)}},{key:"getStartingConfig",value:function(e){var t,n,r=Wee.of(e.firstPlayer);return r===Wee.RANDOM&&(r=Math.random()<.5?Wee.CREATOR:Wee.CHOSEN_PLAYER),r===Wee.CREATOR?(t=e.creator.name,n=nB.getNonNullable(e.chosenPlayer)):(t=nB.getNonNullable(e.chosenPlayer),n=e.creator.name),{playerZero:t,playerOne:n,turn:0,beginning:E5(),remainingMsForZero:1e3*e.totalPartDuration,remainingMsForOne:1e3*e.totalPartDuration}}},{key:"deletePart",value:function(t){var n=this;return tB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(rB(e.VERBOSE,"GameService.deletePart("+t+")"),n.partDAO.delete(t)));case 1:case"end":return r.stop()}},r)}))()}},{key:"acceptConfig",value:function(t,n){var r=this;return tB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return rB(e.VERBOSE,{gameService_acceptConfig:{partId:t,joiner:n}}),i.next=3,r.joinerService.acceptConfig();case 3:return i.abrupt("return",r.startGameWithConfig(t,ete.ONE,0,n));case 4:case"end":return i.stop()}},i)}))()}},{key:"startObserving",value:function(t,n){if(!this.followedPartId.isAbsent())throw new Error("GameService.startObserving should not be called while already observing a game");rB(e.VERBOSE,"[start watching part "+t),this.followedPartId=sB.of(t),this.followedPartUnsubscribe=this.partDAO.subscribeToChanges(t,n)}},{key:"resign",value:function(e,t,n,r,i){return this.partDAO.updateAndBumpIndex(e,n,t,{winner:r,loser:i,result:e6.RESIGN.value,request:null})}},{key:"notifyTimeout",value:function(e,t,n,r,i){return this.partDAO.updateAndBumpIndex(e,t,n,{winner:r,loser:i,result:e6.TIMEOUT.value,request:null})}},{key:"sendRequest",value:function(e,t,n,r){return this.partDAO.updateAndBumpIndex(e,t,n,{request:r})}},{key:"proposeDraw",value:function(e,t,n){return this.sendRequest(e,n,t,tte.drawProposed(n))}},{key:"acceptDraw",value:function(e,t,n){return this.partDAO.updateAndBumpIndex(e,n,t,{result:(n===ete.ZERO?e6.AGREED_DRAW_BY_ZERO:e6.AGREED_DRAW_BY_ONE).value,request:null})}},{key:"refuseDraw",value:function(e,t,n){return this.sendRequest(e,n,t,tte.drawRefused(n))}},{key:"proposeRematch",value:function(e,t,n){return this.sendRequest(e,n,t,tte.rematchProposed(n))}},{key:"acceptRematch",value:function(t,n,r){var i=this;return tB(regeneratorRuntime.mark(function a(){var o,s,u,c,l,h,f;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return rB(e.VERBOSE,{called:"GameService.acceptRematch(",partDocument:t}),o=nB.getNonNullable(t.data),a.next=4,i.joinerService.readJoinerById(t.id);case 4:return s=a.sent,u=o.playerZero===s.creator.name?Wee.CHOSEN_PLAYER:Wee.CREATOR,c=Mv(Mv({},s),{},{candidates:[],firstPlayer:u.value,partStatus:Zee.PART_STARTED.value}),a.next=9,i.joinerService.createJoiner(c);case 9:return l=a.sent,h=i.getStartingConfig(c),f=Mv({lastUpdate:{index:0,player:r.value},typeGame:o.typeGame,result:e6.UNACHIEVED.value,listMoves:[]},h),a.next=14,i.partDAO.set(l,f);case 14:return a.next=16,i.createChat(l);case 16:return a.abrupt("return",i.sendRequest(t.id,r,n,tte.rematchAccepted(o.typeGame,l)));case 17:case"end":return a.stop()}},a)}))()}},{key:"askTakeBack",value:function(e,t,n){return this.sendRequest(e,n,t,tte.takeBackAsked(n))}},{key:"acceptTakeBack",value:function(e,t,n,r){var i=this;return tB(regeneratorRuntime.mark(function a(){var o,s,u,c;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return X5(tte.getPlayer(nB.getNonNullable(t.data.request))!==n,"Illegal to accept your own request"),o=tte.takeBackAccepted(n),(s=t.data.listMoves.slice(0,t.data.listMoves.length-1)).length%2===n.value&&(s=s.slice(0,s.length-1)),u={request:o,listMoves:s,turn:s.length,lastUpdateTime:E5(),remainingMsForZero:nB.getNonNullable(t.data.remainingMsForZero)-r[0],remainingMsForOne:nB.getNonNullable(t.data.remainingMsForOne)-r[1]},c=t.data.lastUpdate.index,a.next=7,i.partDAO.updateAndBumpIndex(e,n,c,u);case 7:return a.abrupt("return",a.sent);case 8:case"end":return a.stop()}},a)}))()}},{key:"refuseTakeBack",value:function(e,t,n){var r=tte.takeBackRefused(n);return this.partDAO.updateAndBumpIndex(e,n,t,{request:r})}},{key:"addGlobalTime",value:function(e,t,n,r){var i=this;return tB(regeneratorRuntime.mark(function a(){var o;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return o={request:tte.addGlobalTime(r.getOpponent())},o=r===ete.ZERO?Mv(Mv({},o),{},{remainingMsForOne:nB.getNonNullable(n.remainingMsForOne)+3e5}):Mv(Mv({},o),{},{remainingMsForZero:nB.getNonNullable(n.remainingMsForZero)+3e5}),a.next=4,i.partDAO.updateAndBumpIndex(e,r,t,o);case 4:return a.abrupt("return",a.sent);case 5:case"end":return a.stop()}},a)}))()}},{key:"addTurnTime",value:function(e,t,n){var r=this;return tB(regeneratorRuntime.mark(function i(){var a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return a={request:tte.addTurnTime(e.getOpponent())},i.next=3,r.partDAO.updateAndBumpIndex(n,e,t,a);case 3:return i.abrupt("return",i.sent);case 4:case"end":return i.stop()}},i)}))()}},{key:"stopObserving",value:function(){rB(e.VERBOSE,"GameService.stopObserving();"),X5(this.followedPartId.isPresent(),"!!! GameService.stopObserving: we already stop watching doc"),rB(e.VERBOSE,"stopped watching joiner "+this.followedPartId+"]"),this.followedPartId=sB.empty(),this.followedPartUnsubscribe()}},{key:"updateDBBoard",value:function(t,n,r,i,a,o,s,u){var c=this;return tB(regeneratorRuntime.mark(function l(){var h,f,d,v,p;return regeneratorRuntime.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return rB(e.VERBOSE,{gameService_updateDBBoard:{partId:t,encodedMove:r,scores:a,msToSubstract:i,notifyDraw:o,winner:s,loser:u}}),l.next=3,c.partDAO.read(t);case 3:return h=l.sent.get(),f=h.lastUpdate.index,d=h.turn+1,(v=ite.copyImmutableArray(h.listMoves))[v.length]=r,p={listMoves:v,turn:d,request:null,lastUpdateTime:E5()},p=c.updateScore(p,a),p=c.substractMs(p,h,i),null!=s?p=Mv(Mv({},p),{},{winner:s,loser:u,result:e6.VICTORY.value}):!0===o&&(p=Mv(Mv({},p),{},{result:e6.HARD_DRAW.value})),l.next=14,c.partDAO.updateAndBumpIndex(t,n,f,p);case 14:return l.abrupt("return",l.sent);case 15:case"end":return l.stop()}},l)}))()}},{key:"updateScore",value:function(e,t){return void 0!==t?Mv(Mv({},e),{},{scorePlayerZero:t[0],scorePlayerOne:t[1]}):e}},{key:"substractMs",value:function(e,t,n){return n[0]>0?Mv(Mv({},e),{},{remainingMsForZero:nB.getNonNullable(t.remainingMsForZero)-n[0]}):n[1]>0?Mv(Mv({},e),{},{remainingMsForOne:nB.getNonNullable(t.remainingMsForOne)-n[1]}):e}}]),e}();return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(Pk(n6),Pk(ote),Pk(a6))},e.\u0275prov=Eg({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),ute=function(){function e(){tp(this,e)}return rp(e,null,[{key:"getNavigatorLanguage",value:function(){return navigator.language}},{key:"getLocale",value:function(){var t=(localStorage.getItem("locale")||e.getNavigatorLanguage()||"fr").slice(0,2).toLowerCase();return["en","fr"].some(function(e){return e===t})?t:"fr"}}]),e}(),cte=function(){var e=function(){function e(){tp(this,e)}return rp(e,[{key:"changeTheme",value:function(e){localStorage.setItem("theme",e)}},{key:"getTheme",value:function(){return sB.ofNullable(localStorage.getItem("theme"))}},{key:"changeLanguage",value:function(e){localStorage.setItem("locale",e.toLowerCase())}},{key:"getLanguage",value:function(){return ute.getLocale()}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Eg({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),lte=function(){var e=function(){function e(t,n){tp(this,e),this.document=t,this.userSettingsService=n,this.availableThemes=["dark","light"];var r=this.getStoredTheme();r.isPresent()?this.loadTheme(r.get()):window.matchMedia("(prefers-color-scheme: dark)").matches?this.loadTheme("dark"):window.matchMedia("(prefers-color-scheme: light)").matches?this.loadTheme("light"):this.loadTheme("dark")}return rp(e,[{key:"getStoredTheme",value:function(){var e=this.userSettingsService.getTheme();if(e.isPresent()){var t=e.get();if(this.availableThemes.some(function(e){return e===t}))return sB.of(t)}return sB.empty()}},{key:"loadTheme",value:function(e){this.loadStyle(e+".css"),this.theme=e}},{key:"loadStyle",value:function(e){var t=this.document.getElementsByTagName("head")[0],n=this.document.getElementById("theme");if(null!=n)n.href=e;else{var r=this.document.createElement("link");r.id="theme",r.rel="stylesheet",r.href="".concat(e),t.appendChild(r)}}},{key:"getTheme",value:function(){return this.theme}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Pk(PO),Pk(cte))},e.\u0275prov=Eg({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),hte={prefix:"fas",iconName:"book-open",icon:[576,512,[],"f518","M542.22 32.05c-54.8 3.11-163.72 14.43-230.96 55.59-4.64 2.84-7.27 7.89-7.27 13.17v363.87c0 11.55 12.63 18.85 23.28 13.49 69.18-34.82 169.23-44.32 218.7-46.92 16.89-.89 30.02-14.43 30.02-30.66V62.75c.01-17.71-15.35-31.74-33.77-30.7zM264.73 87.64C197.5 46.48 88.58 35.17 33.78 32.05 15.36 31.01 0 45.04 0 62.75V400.6c0 16.24 13.13 29.78 30.02 30.66 49.49 2.6 149.59 12.11 218.77 46.95 10.62 5.35 23.21-1.94 23.21-13.46V100.63c0-5.29-2.62-10.14-7.27-12.99z"]},fte={prefix:"fas",iconName:"cog",icon:[512,512,[],"f013","M487.4 315.7l-42.6-24.6c4.3-23.2 4.3-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-4.3 23.2-4.3 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z"]},dte={prefix:"fas",iconName:"desktop",icon:[576,512,[],"f108","M528 0H48C21.5 0 0 21.5 0 48v320c0 26.5 21.5 48 48 48h192l-16 48h-72c-13.3 0-24 10.7-24 24s10.7 24 24 24h272c13.3 0 24-10.7 24-24s-10.7-24-24-24h-72l-16-48h192c26.5 0 48-21.5 48-48V48c0-26.5-21.5-48-48-48zm-16 352H64V64h448v288z"]},vte={prefix:"fas",iconName:"eye",icon:[576,512,[],"f06e","M572.52 241.4C518.29 135.59 410.93 64 288 64S57.68 135.64 3.48 241.41a32.35 32.35 0 0 0 0 29.19C57.71 376.41 165.07 448 288 448s230.32-71.64 284.52-177.41a32.35 32.35 0 0 0 0-29.19zM288 400a144 144 0 1 1 144-144 143.93 143.93 0 0 1-144 144zm0-240a95.31 95.31 0 0 0-25.31 3.79 47.85 47.85 0 0 1-66.9 66.9A95.78 95.78 0 1 0 288 160z"]},pte={prefix:"fas",iconName:"network-wired",icon:[640,512,[],"f6ff","M640 264v-16c0-8.84-7.16-16-16-16H344v-40h72c17.67 0 32-14.33 32-32V32c0-17.67-14.33-32-32-32H224c-17.67 0-32 14.33-32 32v128c0 17.67 14.33 32 32 32h72v40H16c-8.84 0-16 7.16-16 16v16c0 8.84 7.16 16 16 16h104v40H64c-17.67 0-32 14.33-32 32v128c0 17.67 14.33 32 32 32h160c17.67 0 32-14.33 32-32V352c0-17.67-14.33-32-32-32h-56v-40h304v40h-56c-17.67 0-32 14.33-32 32v128c0 17.67 14.33 32 32 32h160c17.67 0 32-14.33 32-32V352c0-17.67-14.33-32-32-32h-56v-40h104c8.84 0 16-7.16 16-16zM256 128V64h128v64H256zm-64 320H96v-64h96v64zm352 0h-96v-64h96v64z"]},gte={prefix:"fas",iconName:"reply",icon:[512,512,[],"f3e5","M8.309 189.836L184.313 37.851C199.719 24.546 224 35.347 224 56.015v80.053c160.629 1.839 288 34.032 288 186.258 0 61.441-39.581 122.309-83.333 154.132-13.653 9.931-33.111-2.533-28.077-18.631 45.344-145.012-21.507-183.51-176.59-185.742V360c0 20.7-24.3 31.453-39.687 18.164l-176.004-152c-11.071-9.562-11.086-26.753 0-36.328z"]};function yte(e){return(yte="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function mte(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function kte(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){mte(e,t,n[t])})}return e}function _te(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(u){i=!0,a=u}finally{try{!r&&null!=s.return&&s.return()}finally{if(i)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var wte={},Cte={};try{"undefined"!=typeof window&&(wte=window),"undefined"!=typeof document&&(Cte=document),"undefined"!=typeof MutationObserver&&MutationObserver,"undefined"!=typeof performance&&performance}catch(bme){}var bte=(wte.navigator||{}).userAgent,Ete=void 0===bte?"":bte,Ste=wte,Pte=Cte,Ote=!!Pte.documentElement&&!!Pte.head&&"function"==typeof Pte.addEventListener&&"function"==typeof Pte.createElement,Tte=(~Ete.indexOf("MSIE")||Ete.indexOf("Trident/"),"___FONT_AWESOME___"),Ite="svg-inline--fa",xte=[1,2,3,4,5,6,7,8,9,10],Ate=xte.concat([11,12,13,14,15,16,17,18,19,20]),Rte={GROUP:"group",SWAP_OPACITY:"swap-opacity",PRIMARY:"primary",SECONDARY:"secondary"},Nte=(["xs","sm","lg","fw","ul","li","border","pull-left","pull-right","spin","pulse","rotate-90","rotate-180","rotate-270","flip-horizontal","flip-vertical","flip-both","stack","stack-1x","stack-2x","inverse","layers","layers-text","layers-counter",Rte.GROUP,Rte.SWAP_OPACITY,Rte.PRIMARY,Rte.SECONDARY].concat(xte.map(function(e){return"".concat(e,"x")})).concat(Ate.map(function(e){return"w-".concat(e)})),Ste.FontAwesomeConfig||{});Pte&&"function"==typeof Pte.querySelector&&[["data-family-prefix","familyPrefix"],["data-replacement-class","replacementClass"],["data-auto-replace-svg","autoReplaceSvg"],["data-auto-add-css","autoAddCss"],["data-auto-a11y","autoA11y"],["data-search-pseudo-elements","searchPseudoElements"],["data-observe-mutations","observeMutations"],["data-mutate-approach","mutateApproach"],["data-keep-original-source","keepOriginalSource"],["data-measure-performance","measurePerformance"],["data-show-missing-icons","showMissingIcons"]].forEach(function(e){var t=_te(e,2),n=t[1],r=function(e){return""===e||"false"!==e&&("true"===e||e)}(function(e){var t=Pte.querySelector("script["+e+"]");if(t)return t.getAttribute(e)}(t[0]));null!=r&&(Nte[n]=r)});var Mte=kte({},{familyPrefix:"fa",replacementClass:Ite,autoReplaceSvg:!0,autoAddCss:!0,autoA11y:!0,searchPseudoElements:!1,observeMutations:!0,mutateApproach:"async",keepOriginalSource:!0,measurePerformance:!1,showMissingIcons:!0},Nte);Mte.autoReplaceSvg||(Mte.observeMutations=!1);var Dte=kte({},Mte);Ste.FontAwesomeConfig=Dte;var Lte=Ste||{};Lte[Tte]||(Lte[Tte]={}),Lte[Tte].styles||(Lte[Tte].styles={}),Lte[Tte].hooks||(Lte[Tte].hooks={}),Lte[Tte].shims||(Lte[Tte].shims=[]);var Fte=Lte[Tte],Bte=[];Ote&&((Pte.documentElement.doScroll?/^loaded|^c/:/^loaded|^i|^c/).test(Pte.readyState)||Pte.addEventListener("DOMContentLoaded",function e(){Pte.removeEventListener("DOMContentLoaded",e),Bte.map(function(e){return e()})}));var Vte,Ute="pending",zte="fulfilled",Hte="rejected",Gte=function(){},qte="undefined"!=typeof global&&void 0!==global.process&&"function"==typeof global.process.emit,$te="undefined"==typeof setImmediate?setTimeout:setImmediate,Wte=[];function jte(){for(var e=0;e<Wte.length;e++)Wte[e][0](Wte[e][1]);Wte=[],Vte=!1}function Zte(e,t){Wte.push([e,t]),Vte||(Vte=!0,$te(jte,0))}function Yte(e){var t=e.owner,n=t._state,r=t._data,i=e[n],a=e.then;if("function"==typeof i){n=zte;try{r=i(r)}catch(o){Xte(a,o)}}Kte(a,r)||(n===zte&&Jte(a,r),n===Hte&&Xte(a,r))}function Kte(e,t){var n;try{if(e===t)throw new TypeError("A promises callback cannot return that same promise.");if(t&&("function"==typeof t||"object"===yte(t))){var r=t.then;if("function"==typeof r)return r.call(t,function(r){n||(n=!0,t===r?Qte(e,r):Jte(e,r))},function(t){n||(n=!0,Xte(e,t))}),!0}}catch(i){return n||Xte(e,i),!0}return!1}function Jte(e,t){(e===t||!Kte(e,t))&&Qte(e,t)}function Qte(e,t){e._state===Ute&&(e._state="settled",e._data=t,Zte(tne,e))}function Xte(e,t){e._state===Ute&&(e._state="settled",e._data=t,Zte(nne,e))}function ene(e){e._then=e._then.forEach(Yte)}function tne(e){e._state=zte,ene(e)}function nne(e){e._state=Hte,ene(e),!e._handled&&qte&&global.process.emit("unhandledRejection",e._data,e)}function rne(e){global.process.emit("rejectionHandled",e)}function ine(e){if("function"!=typeof e)throw new TypeError("Promise resolver "+e+" is not a function");if(!(this instanceof ine))throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this._then=[],function(e,t){function n(e){Xte(t,e)}try{e(function(e){Jte(t,e)},n)}catch(r){n(r)}}(e,this)}ine.prototype={constructor:ine,_state:Ute,_then:null,_data:void 0,_handled:!1,then:function(e,t){var n={owner:this,then:new this.constructor(Gte),fulfilled:e,rejected:t};return(t||e)&&!this._handled&&(this._handled=!0,this._state===Hte&&qte&&Zte(rne,this)),this._state===zte||this._state===Hte?Zte(Yte,n):this._then.push(n),n.then},catch:function(e){return this.then(null,e)}},ine.all=function(e){if(!Array.isArray(e))throw new TypeError("You must pass an array to Promise.all().");return new ine(function(t,n){var r=[],i=0;function a(e){return i++,function(n){r[e]=n,--i||t(r)}}for(var o,s=0;s<e.length;s++)(o=e[s])&&"function"==typeof o.then?o.then(a(s),n):r[s]=o;i||t(r)})},ine.race=function(e){if(!Array.isArray(e))throw new TypeError("You must pass an array to Promise.race().");return new ine(function(t,n){for(var r,i=0;i<e.length;i++)(r=e[i])&&"function"==typeof r.then?r.then(t,n):t(r)})},ine.resolve=function(e){return e&&"object"===yte(e)&&e.constructor===ine?e:new ine(function(t){t(e)})},ine.reject=function(e){return new ine(function(t,n){n(e)})};var ane={size:16,x:0,y:0,rotate:0,flipX:!1,flipY:!1};function one(){for(var e=12,t="";e-- >0;)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[62*Math.random()|0];return t}function sne(e){return"".concat(e).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function une(e){return Object.keys(e||{}).reduce(function(t,n){return t+"".concat(n,": ").concat(e[n],";")},"")}function cne(e){return e.size!==ane.size||e.x!==ane.x||e.y!==ane.y||e.rotate!==ane.rotate||e.flipX||e.flipY}function lne(e){var t=e.transform,n=e.iconWidth,r={transform:"translate(".concat(e.containerWidth/2," 256)")},i="translate(".concat(32*t.x,", ").concat(32*t.y,") "),a="scale(".concat(t.size/16*(t.flipX?-1:1),", ").concat(t.size/16*(t.flipY?-1:1),") "),o="rotate(".concat(t.rotate," 0 0)");return{outer:r,inner:{transform:"".concat(i," ").concat(a," ").concat(o)},path:{transform:"translate(".concat(n/2*-1," -256)")}}}var hne={x:0,y:0,width:"100%",height:"100%"};function fne(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return e.attributes&&(e.attributes.fill||t)&&(e.attributes.fill="black"),e}function dne(e){return"g"===e.tag?e.children:[e]}function vne(e){var t=e.icons,n=t.main,r=t.mask,i=e.prefix,a=e.iconName,o=e.transform,s=e.symbol,u=e.title,c=e.maskId,l=e.titleId,h=e.extra,f=e.watchable,d=void 0!==f&&f,v=r.found?r:n,p=v.width,g=v.height,y="fak"===i,m=y?"":"fa-w-".concat(Math.ceil(p/g*16)),k=[Dte.replacementClass,a?"".concat(Dte.familyPrefix,"-").concat(a):"",m].filter(function(e){return-1===h.classes.indexOf(e)}).filter(function(e){return""!==e||!!e}).concat(h.classes).join(" "),_={children:[],attributes:kte({},h.attributes,{"data-prefix":i,"data-icon":a,class:k,role:h.attributes.role||"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 ".concat(p," ").concat(g)})},w=y&&!~h.classes.indexOf("fa-fw")?{width:"".concat(p/g*16*.0625,"em")}:{};d&&(_.attributes["data-fa-i2svg"]=""),u&&_.children.push({tag:"title",attributes:{id:_.attributes["aria-labelledby"]||"title-".concat(l||one())},children:[u]});var C=kte({},_,{prefix:i,iconName:a,main:n,mask:r,maskId:c,transform:o,symbol:s,styles:kte({},w,h.styles)}),b=r.found&&n.found?function(e){var t=e.children,n=e.attributes,r=e.main,i=e.mask,a=e.maskId,o=r.icon,s=i.icon,u=lne({transform:e.transform,containerWidth:i.width,iconWidth:r.width}),c={tag:"rect",attributes:kte({},hne,{fill:"white"})},l=o.children?{children:o.children.map(fne)}:{},h={tag:"g",attributes:kte({},u.inner),children:[fne(kte({tag:o.tag,attributes:kte({},o.attributes,u.path)},l))]},f={tag:"g",attributes:kte({},u.outer),children:[h]},d="mask-".concat(a||one()),v="clip-".concat(a||one()),p={tag:"mask",attributes:kte({},hne,{id:d,maskUnits:"userSpaceOnUse",maskContentUnits:"userSpaceOnUse"}),children:[c,f]},g={tag:"defs",children:[{tag:"clipPath",attributes:{id:v},children:dne(s)},p]};return t.push(g,{tag:"rect",attributes:kte({fill:"currentColor","clip-path":"url(#".concat(v,")"),mask:"url(#".concat(d,")")},hne)}),{children:t,attributes:n}}(C):function(e){var t=e.children,n=e.attributes,r=e.main,i=e.transform,a=une(e.styles);if(a.length>0&&(n.style=a),cne(i)){var o=lne({transform:i,containerWidth:r.width,iconWidth:r.width});t.push({tag:"g",attributes:kte({},o.outer),children:[{tag:"g",attributes:kte({},o.inner),children:[{tag:r.icon.tag,children:r.icon.children,attributes:kte({},r.icon.attributes,o.path)}]}]})}else t.push(r.icon);return{children:t,attributes:n}}(C),E=b.attributes;return C.children=b.children,C.attributes=E,s?function(e){var t=e.iconName,n=e.children,r=e.symbol;return[{tag:"svg",attributes:{style:"display: none;"},children:[{tag:"symbol",attributes:kte({},e.attributes,{id:!0===r?"".concat(e.prefix,"-").concat(Dte.familyPrefix,"-").concat(t):r}),children:n}]}]}(C):function(e){var t=e.children,n=e.main,r=e.mask,i=e.attributes,a=e.styles,o=e.transform;if(cne(o)&&n.found&&!r.found){var s={x:n.width/n.height/2,y:.5};i.style=une(kte({},a,{"transform-origin":"".concat(s.x+o.x/16,"em ").concat(s.y+o.y/16,"em")}))}return[{tag:"svg",attributes:i,children:t}]}(C)}var pne=function(e,t,n,r){var i,a,o,s=Object.keys(e),u=s.length,c=void 0!==r?function(e,t){return function(n,r,i,a){return e.call(t,n,r,i,a)}}(t,r):t;for(void 0===n?(i=1,o=e[s[0]]):(i=0,o=n);i<u;i++)o=c(o,e[a=s[i]],a,e);return o};function gne(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.skipHooks,i=void 0!==r&&r,a=Object.keys(t).reduce(function(e,n){var r=t[n];return r.icon?e[r.iconName]=r.icon:e[n]=r,e},{});"function"!=typeof Fte.hooks.addPack||i?Fte.styles[e]=kte({},Fte.styles[e]||{},a):Fte.hooks.addPack(e,a),"fas"===e&&gne("fa",t)}var yne=Fte.styles,mne=Fte.shims,kne=function(){var e=function(e){return pne(yne,function(t,n,r){return t[r]=pne(n,e,{}),t},{})};e(function(e,t,n){return t[3]&&(e[t[3]]=n),e}),e(function(e,t,n){var r=t[2];return e[n]=n,r.forEach(function(t){e[t]=n}),e});var t="far"in yne;pne(mne,function(e,n){var r=n[1];return"far"===r&&!t&&(r="fas"),e[n[0]]={prefix:r,iconName:n[2]},e},{})};function _ne(e,t,n){if(e&&e[t]&&e[t][n])return{prefix:t,iconName:n,icon:e[t][n]}}function wne(e){var t=e.tag,n=e.attributes,r=void 0===n?{}:n,i=e.children,a=void 0===i?[]:i;return"string"==typeof e?sne(e):"<".concat(t," ").concat(function(e){return Object.keys(e||{}).reduce(function(t,n){return t+"".concat(n,'="').concat(sne(e[n]),'" ')},"").trim()}(r),">").concat(a.map(wne).join(""),"</").concat(t,">")}function Cne(e){this.name="MissingIcon",this.message=e||"Icon unavailable",this.stack=(new Error).stack}kne(),(Cne.prototype=Object.create(Error.prototype)).constructor=Cne;var bne={fill:"currentColor"},Ene={attributeType:"XML",repeatCount:"indefinite",dur:"2s"},Sne=(kte({},bne,{d:"M156.5,447.7l-12.6,29.5c-18.7-9.5-35.9-21.2-51.5-34.9l22.7-22.7C127.6,430.5,141.5,440,156.5,447.7z M40.6,272H8.5 c1.4,21.2,5.4,41.7,11.7,61.1L50,321.2C45.1,305.5,41.8,289,40.6,272z M40.6,240c1.4-18.8,5.2-37,11.1-54.1l-29.5-12.6 C14.7,194.3,10,216.7,8.5,240H40.6z M64.3,156.5c7.8-14.9,17.2-28.8,28.1-41.5L69.7,92.3c-13.7,15.6-25.5,32.8-34.9,51.5 L64.3,156.5z M397,419.6c-13.9,12-29.4,22.3-46.1,30.4l11.9,29.8c20.7-9.9,39.8-22.6,56.9-37.6L397,419.6z M115,92.4 c13.9-12,29.4-22.3,46.1-30.4l-11.9-29.8c-20.7,9.9-39.8,22.6-56.8,37.6L115,92.4z M447.7,355.5c-7.8,14.9-17.2,28.8-28.1,41.5 l22.7,22.7c13.7-15.6,25.5-32.9,34.9-51.5L447.7,355.5z M471.4,272c-1.4,18.8-5.2,37-11.1,54.1l29.5,12.6 c7.5-21.1,12.2-43.5,13.6-66.8H471.4z M321.2,462c-15.7,5-32.2,8.2-49.2,9.4v32.1c21.2-1.4,41.7-5.4,61.1-11.7L321.2,462z M240,471.4c-18.8-1.4-37-5.2-54.1-11.1l-12.6,29.5c21.1,7.5,43.5,12.2,66.8,13.6V471.4z M462,190.8c5,15.7,8.2,32.2,9.4,49.2h32.1 c-1.4-21.2-5.4-41.7-11.7-61.1L462,190.8z M92.4,397c-12-13.9-22.3-29.4-30.4-46.1l-29.8,11.9c9.9,20.7,22.6,39.8,37.6,56.9 L92.4,397z M272,40.6c18.8,1.4,36.9,5.2,54.1,11.1l12.6-29.5C317.7,14.7,295.3,10,272,8.5V40.6z M190.8,50 c15.7-5,32.2-8.2,49.2-9.4V8.5c-21.2,1.4-41.7,5.4-61.1,11.7L190.8,50z M442.3,92.3L419.6,115c12,13.9,22.3,29.4,30.5,46.1 l29.8-11.9C470,128.5,457.3,109.4,442.3,92.3z M397,92.4l22.7-22.7c-15.6-13.7-32.8-25.5-51.5-34.9l-12.6,29.5 C370.4,72.1,384.4,81.5,397,92.4z"}),kte({},Ene,{attributeName:"opacity"}));function Pne(e){var t=e[0],n=e[1],r=_te(e.slice(4),1)[0];return{found:!0,width:t,height:n,icon:Array.isArray(r)?{tag:"g",attributes:{class:"".concat(Dte.familyPrefix,"-").concat(Rte.GROUP)},children:[{tag:"path",attributes:{class:"".concat(Dte.familyPrefix,"-").concat(Rte.SECONDARY),fill:"currentColor",d:r[0]}},{tag:"path",attributes:{class:"".concat(Dte.familyPrefix,"-").concat(Rte.PRIMARY),fill:"currentColor",d:r[1]}}]}:{tag:"path",attributes:{fill:"currentColor",d:r}}}}function One(){Dte.autoAddCss&&!Ane&&(function(e){if(e&&Ote){var t=Pte.createElement("style");t.setAttribute("type","text/css"),t.innerHTML=e;for(var n=Pte.head.childNodes,r=null,i=n.length-1;i>-1;i--){var a=n[i],o=(a.tagName||"").toUpperCase();["STYLE","LINK"].indexOf(o)>-1&&(r=a)}Pte.head.insertBefore(t,r)}}(function(){var e="fa",t=Ite,n=Dte.familyPrefix,r=Dte.replacementClass,i='svg:not(:root).svg-inline--fa {\n  overflow: visible;\n}\n\n.svg-inline--fa {\n  display: inline-block;\n  font-size: inherit;\n  height: 1em;\n  overflow: visible;\n  vertical-align: -0.125em;\n}\n.svg-inline--fa.fa-lg {\n  vertical-align: -0.225em;\n}\n.svg-inline--fa.fa-w-1 {\n  width: 0.0625em;\n}\n.svg-inline--fa.fa-w-2 {\n  width: 0.125em;\n}\n.svg-inline--fa.fa-w-3 {\n  width: 0.1875em;\n}\n.svg-inline--fa.fa-w-4 {\n  width: 0.25em;\n}\n.svg-inline--fa.fa-w-5 {\n  width: 0.3125em;\n}\n.svg-inline--fa.fa-w-6 {\n  width: 0.375em;\n}\n.svg-inline--fa.fa-w-7 {\n  width: 0.4375em;\n}\n.svg-inline--fa.fa-w-8 {\n  width: 0.5em;\n}\n.svg-inline--fa.fa-w-9 {\n  width: 0.5625em;\n}\n.svg-inline--fa.fa-w-10 {\n  width: 0.625em;\n}\n.svg-inline--fa.fa-w-11 {\n  width: 0.6875em;\n}\n.svg-inline--fa.fa-w-12 {\n  width: 0.75em;\n}\n.svg-inline--fa.fa-w-13 {\n  width: 0.8125em;\n}\n.svg-inline--fa.fa-w-14 {\n  width: 0.875em;\n}\n.svg-inline--fa.fa-w-15 {\n  width: 0.9375em;\n}\n.svg-inline--fa.fa-w-16 {\n  width: 1em;\n}\n.svg-inline--fa.fa-w-17 {\n  width: 1.0625em;\n}\n.svg-inline--fa.fa-w-18 {\n  width: 1.125em;\n}\n.svg-inline--fa.fa-w-19 {\n  width: 1.1875em;\n}\n.svg-inline--fa.fa-w-20 {\n  width: 1.25em;\n}\n.svg-inline--fa.fa-pull-left {\n  margin-right: 0.3em;\n  width: auto;\n}\n.svg-inline--fa.fa-pull-right {\n  margin-left: 0.3em;\n  width: auto;\n}\n.svg-inline--fa.fa-border {\n  height: 1.5em;\n}\n.svg-inline--fa.fa-li {\n  width: 2em;\n}\n.svg-inline--fa.fa-fw {\n  width: 1.25em;\n}\n\n.fa-layers svg.svg-inline--fa {\n  bottom: 0;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n}\n\n.fa-layers {\n  display: inline-block;\n  height: 1em;\n  position: relative;\n  text-align: center;\n  vertical-align: -0.125em;\n  width: 1em;\n}\n.fa-layers svg.svg-inline--fa {\n  -webkit-transform-origin: center center;\n          transform-origin: center center;\n}\n\n.fa-layers-counter, .fa-layers-text {\n  display: inline-block;\n  position: absolute;\n  text-align: center;\n}\n\n.fa-layers-text {\n  left: 50%;\n  top: 50%;\n  -webkit-transform: translate(-50%, -50%);\n          transform: translate(-50%, -50%);\n  -webkit-transform-origin: center center;\n          transform-origin: center center;\n}\n\n.fa-layers-counter {\n  background-color: #ff253a;\n  border-radius: 1em;\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n  color: #fff;\n  height: 1.5em;\n  line-height: 1;\n  max-width: 5em;\n  min-width: 1.5em;\n  overflow: hidden;\n  padding: 0.25em;\n  right: 0;\n  text-overflow: ellipsis;\n  top: 0;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: top right;\n          transform-origin: top right;\n}\n\n.fa-layers-bottom-right {\n  bottom: 0;\n  right: 0;\n  top: auto;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: bottom right;\n          transform-origin: bottom right;\n}\n\n.fa-layers-bottom-left {\n  bottom: 0;\n  left: 0;\n  right: auto;\n  top: auto;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: bottom left;\n          transform-origin: bottom left;\n}\n\n.fa-layers-top-right {\n  right: 0;\n  top: 0;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: top right;\n          transform-origin: top right;\n}\n\n.fa-layers-top-left {\n  left: 0;\n  right: auto;\n  top: 0;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: top left;\n          transform-origin: top left;\n}\n\n.fa-lg {\n  font-size: 1.3333333333em;\n  line-height: 0.75em;\n  vertical-align: -0.0667em;\n}\n\n.fa-xs {\n  font-size: 0.75em;\n}\n\n.fa-sm {\n  font-size: 0.875em;\n}\n\n.fa-1x {\n  font-size: 1em;\n}\n\n.fa-2x {\n  font-size: 2em;\n}\n\n.fa-3x {\n  font-size: 3em;\n}\n\n.fa-4x {\n  font-size: 4em;\n}\n\n.fa-5x {\n  font-size: 5em;\n}\n\n.fa-6x {\n  font-size: 6em;\n}\n\n.fa-7x {\n  font-size: 7em;\n}\n\n.fa-8x {\n  font-size: 8em;\n}\n\n.fa-9x {\n  font-size: 9em;\n}\n\n.fa-10x {\n  font-size: 10em;\n}\n\n.fa-fw {\n  text-align: center;\n  width: 1.25em;\n}\n\n.fa-ul {\n  list-style-type: none;\n  margin-left: 2.5em;\n  padding-left: 0;\n}\n.fa-ul > li {\n  position: relative;\n}\n\n.fa-li {\n  left: -2em;\n  position: absolute;\n  text-align: center;\n  width: 2em;\n  line-height: inherit;\n}\n\n.fa-border {\n  border: solid 0.08em #eee;\n  border-radius: 0.1em;\n  padding: 0.2em 0.25em 0.15em;\n}\n\n.fa-pull-left {\n  float: left;\n}\n\n.fa-pull-right {\n  float: right;\n}\n\n.fa.fa-pull-left,\n.fas.fa-pull-left,\n.far.fa-pull-left,\n.fal.fa-pull-left,\n.fab.fa-pull-left {\n  margin-right: 0.3em;\n}\n.fa.fa-pull-right,\n.fas.fa-pull-right,\n.far.fa-pull-right,\n.fal.fa-pull-right,\n.fab.fa-pull-right {\n  margin-left: 0.3em;\n}\n\n.fa-spin {\n  -webkit-animation: fa-spin 2s infinite linear;\n          animation: fa-spin 2s infinite linear;\n}\n\n.fa-pulse {\n  -webkit-animation: fa-spin 1s infinite steps(8);\n          animation: fa-spin 1s infinite steps(8);\n}\n\n@-webkit-keyframes fa-spin {\n  0% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n            transform: rotate(360deg);\n  }\n}\n\n@keyframes fa-spin {\n  0% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n            transform: rotate(360deg);\n  }\n}\n.fa-rotate-90 {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=1)";\n  -webkit-transform: rotate(90deg);\n          transform: rotate(90deg);\n}\n\n.fa-rotate-180 {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=2)";\n  -webkit-transform: rotate(180deg);\n          transform: rotate(180deg);\n}\n\n.fa-rotate-270 {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=3)";\n  -webkit-transform: rotate(270deg);\n          transform: rotate(270deg);\n}\n\n.fa-flip-horizontal {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=0, mirror=1)";\n  -webkit-transform: scale(-1, 1);\n          transform: scale(-1, 1);\n}\n\n.fa-flip-vertical {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=2, mirror=1)";\n  -webkit-transform: scale(1, -1);\n          transform: scale(1, -1);\n}\n\n.fa-flip-both, .fa-flip-horizontal.fa-flip-vertical {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=2, mirror=1)";\n  -webkit-transform: scale(-1, -1);\n          transform: scale(-1, -1);\n}\n\n:root .fa-rotate-90,\n:root .fa-rotate-180,\n:root .fa-rotate-270,\n:root .fa-flip-horizontal,\n:root .fa-flip-vertical,\n:root .fa-flip-both {\n  -webkit-filter: none;\n          filter: none;\n}\n\n.fa-stack {\n  display: inline-block;\n  height: 2em;\n  position: relative;\n  width: 2.5em;\n}\n\n.fa-stack-1x,\n.fa-stack-2x {\n  bottom: 0;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n}\n\n.svg-inline--fa.fa-stack-1x {\n  height: 1em;\n  width: 1.25em;\n}\n.svg-inline--fa.fa-stack-2x {\n  height: 2em;\n  width: 2.5em;\n}\n\n.fa-inverse {\n  color: #fff;\n}\n\n.sr-only {\n  border: 0;\n  clip: rect(0, 0, 0, 0);\n  height: 1px;\n  margin: -1px;\n  overflow: hidden;\n  padding: 0;\n  position: absolute;\n  width: 1px;\n}\n\n.sr-only-focusable:active, .sr-only-focusable:focus {\n  clip: auto;\n  height: auto;\n  margin: 0;\n  overflow: visible;\n  position: static;\n  width: auto;\n}\n\n.svg-inline--fa .fa-primary {\n  fill: var(--fa-primary-color, currentColor);\n  opacity: 1;\n  opacity: var(--fa-primary-opacity, 1);\n}\n\n.svg-inline--fa .fa-secondary {\n  fill: var(--fa-secondary-color, currentColor);\n  opacity: 0.4;\n  opacity: var(--fa-secondary-opacity, 0.4);\n}\n\n.svg-inline--fa.fa-swap-opacity .fa-primary {\n  opacity: 0.4;\n  opacity: var(--fa-secondary-opacity, 0.4);\n}\n\n.svg-inline--fa.fa-swap-opacity .fa-secondary {\n  opacity: 1;\n  opacity: var(--fa-primary-opacity, 1);\n}\n\n.svg-inline--fa mask .fa-primary,\n.svg-inline--fa mask .fa-secondary {\n  fill: black;\n}\n\n.fad.fa-inverse {\n  color: #fff;\n}';if(n!==e||r!==t){var a=new RegExp("\\.".concat(e,"\\-"),"g"),o=new RegExp("\\--".concat(e,"\\-"),"g"),s=new RegExp("\\.".concat(t),"g");i=i.replace(a,".".concat(n,"-")).replace(o,"--".concat(n,"-")).replace(s,".".concat(r))}return i}()),Ane=!0)}function Tne(e,t){return Object.defineProperty(e,"abstract",{get:t}),Object.defineProperty(e,"html",{get:function(){return e.abstract.map(function(e){return wne(e)})}}),Object.defineProperty(e,"node",{get:function(){if(Ote){var t=Pte.createElement("div");return t.innerHTML=e.html,t.children}}}),e}function Ine(e){var t=e.prefix,n=void 0===t?"fa":t,r=e.iconName;if(r)return _ne(xne.definitions,n,r)||_ne(Fte.styles,n,r)}kte({},bne,{cx:"256",cy:"364",r:"28"}),kte({},Ene,{attributeName:"r",values:"28;14;28;28;14;28;"}),kte({},Sne,{values:"1;0;1;1;0;1;"}),kte({},bne,{opacity:"1",d:"M263.7,312h-16c-6.6,0-12-5.4-12-12c0-71,77.4-63.9,77.4-107.8c0-20-17.8-40.2-57.4-40.2c-29.1,0-44.3,9.6-59.2,28.7 c-3.9,5-11.1,6-16.2,2.4l-13.1-9.2c-5.6-3.9-6.9-11.8-2.6-17.2c21.2-27.2,46.4-44.7,91.2-44.7c52.3,0,97.4,29.8,97.4,80.2 c0,67.6-77.4,63.5-77.4,107.8C275.7,306.6,270.3,312,263.7,312z"}),kte({},Sne,{values:"1;0;0;0;0;1;"}),kte({},bne,{opacity:"0",d:"M232.5,134.5l7,168c0.3,6.4,5.6,11.5,12,11.5h9c6.4,0,11.7-5.1,12-11.5l7-168c0.3-6.8-5.2-12.5-12-12.5h-23 C237.7,122,232.2,127.7,232.5,134.5z"}),kte({},Sne,{values:"0;0;1;1;0;0;"});var xne=new(function(){function e(){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.definitions={}}return function(e,t,n){t&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(e.prototype,t)}(e,[{key:"add",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=n.reduce(this._pullDefinitions,{});Object.keys(i).forEach(function(t){e.definitions[t]=kte({},e.definitions[t]||{},i[t]),gne(t,i[t]),kne()})}},{key:"reset",value:function(){this.definitions={}}},{key:"_pullDefinitions",value:function(e,t){var n=t.prefix&&t.iconName&&t.icon?{0:t}:t;return Object.keys(n).map(function(t){var r=n[t],i=r.prefix,a=r.iconName,o=r.icon;e[i]||(e[i]={}),e[i][a]=o}),e}}]),e}()),Ane=!1,Rne=function(e){return function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=(t||{}).icon?t:Ine(t||{}),i=n.mask;return i&&(i=(i||{}).icon?i:Ine(i||{})),e(r,kte({},n,{mask:i}))}}(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.transform,r=void 0===n?ane:n,i=t.symbol,a=void 0!==i&&i,o=t.mask,s=void 0===o?null:o,u=t.maskId,c=void 0===u?null:u,l=t.title,h=void 0===l?null:l,f=t.titleId,d=void 0===f?null:f,v=t.classes,p=void 0===v?[]:v,g=t.attributes,y=void 0===g?{}:g,m=t.styles,k=void 0===m?{}:m;if(e){var _=e.prefix,w=e.iconName,C=e.icon;return Tne(kte({type:"icon"},e),function(){return One(),Dte.autoA11y&&(h?y["aria-labelledby"]="".concat(Dte.replacementClass,"-title-").concat(d||one()):(y["aria-hidden"]="true",y.focusable="false")),vne({icons:{main:Pne(C),mask:s?Pne(s.icon):{found:!1,width:null,height:null,icon:{}}},prefix:_,iconName:w,transform:kte({},ane,r),symbol:a,title:h,maskId:c,titleId:d,extra:{attributes:y,styles:k,classes:p}})})}}),Nne=["*"],Mne=function(e){var t,n=(Dv(t={"fa-spin":e.spin,"fa-pulse":e.pulse,"fa-fw":e.fixedWidth,"fa-border":e.border,"fa-inverse":e.inverse,"fa-layers-counter":e.counter,"fa-flip-horizontal":"horizontal"===e.flip||"both"===e.flip,"fa-flip-vertical":"vertical"===e.flip||"both"===e.flip},"fa-".concat(e.size),null!==e.size),Dv(t,"fa-rotate-".concat(e.rotate),null!==e.rotate),Dv(t,"fa-pull-".concat(e.pull),null!==e.pull),Dv(t,"fa-stack-".concat(e.stackItemSize),null!=e.stackItemSize),t);return Object.keys(n).map(function(e){return n[e]?e:null}).filter(function(e){return e})},Dne=function(){var e=rp(function e(){tp(this,e),this.defaultPrefix="fas",this.fallbackIcon=null});return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Eg({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),Lne=function(){var e=function(){function e(){tp(this,e),this.definitions={}}return rp(e,[{key:"addIcons",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var r=0,i=t;r<i.length;r++){var a=i[r];a.prefix in this.definitions||(this.definitions[a.prefix]={}),this.definitions[a.prefix][a.iconName]=a;var o,s=Qv(a.icon[2]);try{for(s.s();!(o=s.n()).done;){var u=o.value;"string"==typeof u&&(this.definitions[a.prefix][u]=a)}}catch(c){s.e(c)}finally{s.f()}}}},{key:"addIconPacks",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=function(){var t=o[a],n=Object.keys(t).map(function(e){return t[e]});e.addIcons.apply(e,Kv(n))},a=0,o=n;a<o.length;a++)i()}},{key:"getIconDefinition",value:function(e,t){return e in this.definitions&&t in this.definitions[e]?this.definitions[e][t]:null}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Eg({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),Fne=function(){var e=function(){function e(){tp(this,e),this.stackItemSize="1x"}return rp(e,[{key:"ngOnChanges",value:function(e){if("size"in e)throw new Error('fa-icon is not allowed to customize size when used inside fa-stack. Set size on the enclosing fa-stack instead: <fa-stack size="4x">...</fa-stack>.')}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=oy({type:e,selectors:[["fa-icon","stackItemSize",""],["fa-duotone-icon","stackItemSize",""]],inputs:{stackItemSize:"stackItemSize",size:"size"},features:[ky]}),e}(),Bne=function(){var e=function(){function e(t,n){tp(this,e),this.renderer=t,this.elementRef=n}return rp(e,[{key:"ngOnInit",value:function(){this.renderer.addClass(this.elementRef.nativeElement,"fa-stack")}},{key:"ngOnChanges",value:function(e){"size"in e&&(null!=e.size.currentValue&&this.renderer.addClass(this.elementRef.nativeElement,"fa-".concat(e.size.currentValue)),null!=e.size.previousValue&&this.renderer.removeClass(this.elementRef.nativeElement,"fa-".concat(e.size.previousValue)))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(sb(oS),sb(rS))},e.\u0275cmp=ey({type:e,selectors:[["fa-stack"]],inputs:{size:"size"},features:[ky],ngContentSelectors:Nne,decls:1,vars:0,template:function(e,t){1&e&&(function(e){var t=Gy()[16][6];if(!t.projection)for(var n=t.projection=dk(1,null),r=n.slice(),i=t.child;null!==i;){r[0]?r[0].projectionNext=i:n[0]=i,r[0]=i,i=i.next}}(),function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0,r=Gy(),i=qy(),a=Lw(i,20+e,16,null,n||null);null===a.projection&&(a.projection=t),Jy(),64!=(64&a.flags)&&function(e,t,n){hw(t[11],0,t,n,j_(e,n,t),X_(n.parent||t[6],n,t))}(i,r,a)}(0))},encapsulation:2}),e}(),Vne=function(){var e=function(){function e(t,n,r,i,a){tp(this,e),this.sanitizer=t,this.config=n,this.iconLibrary=r,this.stackItem=i,this.classes=[],null!=a&&null==i&&console.error('FontAwesome: fa-icon and fa-duotone-icon elements must specify stackItemSize attribute when wrapped into fa-stack. Example: <fa-icon stackItemSize="2x"></fa-icon>.')}return rp(e,[{key:"ngOnChanges",value:function(e){var t;if(null==this.icon&&null==this.config.fallbackIcon)return function(){throw new Error("Property `icon` is required for `fa-icon`/`fa-duotone-icon` components.")}();var n;if(n=null!==(t=this.icon)&&void 0!==t?t:this.config.fallbackIcon,e){var r=this.findIconDefinition(n);if(null!=r){var i=this.buildParams();this.renderIcon(r,i)}}}},{key:"render",value:function(){this.ngOnChanges({})}},{key:"findIconDefinition",value:function(e){var t,n,r,i,a=(n=e,r=this.config.defaultPrefix,void 0!==(i=n).prefix&&void 0!==i.iconName?n:Array.isArray(n)&&2===n.length?{prefix:n[0],iconName:n[1]}:"string"==typeof n?{prefix:r,iconName:n}:void 0);return"icon"in a?a:null!==(t=this.iconLibrary.getIconDefinition(a.prefix,a.iconName))&&void 0!==t?t:(function(e){throw new Error("Could not find icon with iconName=".concat(e.iconName," and prefix=").concat(e.prefix," in the icon library."))}(a),null)}},{key:"buildParams",value:function(){var e={flip:this.flip,spin:this.spin,pulse:this.pulse,border:this.border,inverse:this.inverse,size:this.size||null,pull:this.pull||null,rotate:this.rotate||null,fixedWidth:"boolean"==typeof this.fixedWidth?this.fixedWidth:this.config.fixedWidth,stackItemSize:null!=this.stackItem?this.stackItem.stackItemSize:null},t="string"==typeof this.transform?function(e){var t={size:16,x:0,y:0,flipX:!1,flipY:!1,rotate:0};return e?e.toLowerCase().split(" ").reduce(function(e,t){var n=t.toLowerCase().split("-"),r=n[0],i=n.slice(1).join("-");if(r&&"h"===i)return e.flipX=!0,e;if(r&&"v"===i)return e.flipY=!0,e;if(i=parseFloat(i),isNaN(i))return e;switch(r){case"grow":e.size=e.size+i;break;case"shrink":e.size=e.size-i;break;case"left":e.x=e.x-i;break;case"right":e.x=e.x+i;break;case"up":e.y=e.y-i;break;case"down":e.y=e.y+i;break;case"rotate":e.rotate=e.rotate+i}return e},t):t}(this.transform):this.transform;return{title:this.title,transform:t,classes:[].concat(Kv(Mne(e)),Kv(this.classes)),mask:null!=this.mask?this.findIconDefinition(this.mask):null,styles:null!=this.styles?this.styles:{},symbol:this.symbol,attributes:{role:this.a11yRole}}}},{key:"renderIcon",value:function(e,t){var n=Rne(e,t);this.renderedIconHTML=this.sanitizer.bypassSecurityTrustHtml(n.html.join("\n"))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(sb(yI),sb(Dne),sb(Lne),sb(Fne,8),sb(Bne,8))},e.\u0275cmp=ey({type:e,selectors:[["fa-icon"]],hostAttrs:[1,"ng-fa-icon"],hostVars:2,hostBindings:function(e,t){2&e&&(Fb("innerHTML",t.renderedIconHTML,m_),tb("title",t.title))},inputs:{icon:"icon",title:"title",spin:"spin",pulse:"pulse",mask:"mask",styles:"styles",flip:"flip",size:"size",pull:"pull",border:"border",inverse:"inverse",symbol:"symbol",rotate:"rotate",fixedWidth:"fixedWidth",classes:"classes",transform:"transform",a11yRole:"a11yRole"},features:[ky],decls:0,vars:0,template:function(e,t){},encapsulation:2}),e}(),Une=function(){var e=rp(function e(){tp(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=iy({type:e}),e.\u0275inj=Sg({}),e}();function zne(e,t){if(1&e){var n=pb();db(0),lb(1,"div",9),lb(2,"a",10),Rb(3),hb(),lb(4,"div",12),lb(5,"a",24),mb("click",function(){return $y(n),wb().logout()}),UE(6,25),hb(),hb(),hb(),vb()}if(2&e){var r=wb();Pw(3),Nb(r.username)}}var Hne=function(){return["/register"]},Gne=function(){return["/login"]};function qne(e,t){1&e&&(lb(0,"div",26),lb(1,"a",27),lb(2,"strong"),UE(3,28),hb(),hb(),lb(4,"a",29),UE(5,30),hb(),hb()),2&e&&(Pw(1),ub("routerLink",eP(2,Hne)),Pw(3),ub("routerLink",eP(3,Gne)))}var $ne=function(){return["/"]},Wne=function(){return["/play"]},jne=function(){return["/lobby"]},Zne=function(){return["/local"]},Yne=function(){return["/tutorial"]},Kne=function(){return["/settings"]},Jne=function(){var e=function(){function e(t,n){tp(this,e),this.router=t,this.authenticationService=n,this.username="connecting...",this.faCog=fte,this.showMenu=!1}return rp(e,[{key:"ngOnInit",value:function(){var e=this;this.userSub=this.authenticationService.getUserObs().subscribe(function(t){e.username=t.username.isPresent()?t.username.get():t.email.isPresent()?t.email.get():""})}},{key:"logout",value:function(){var e=this;return tB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.authenticationService.disconnect();case 2:return t.next=4,e.router.navigate(["/"]);case 4:case"end":return t.stop()}},t)}))()}},{key:"ngOnDestroy",value:function(){this.userSub.unsubscribe()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(sb(qM),sb($ee))},e.\u0275cmp=ey({type:e,selectors:[["app-header"]],decls:35,vars:19,consts:function(){return[["role","navigation","aria-label","main navigation",1,"navbar","is-primary"],[1,"navbar-brand"],[1,"navbar-item",3,"routerLink"],["src","assets/images/logo.png","width","28","height","28"],["role","button","aria-label","menu","aria-expanded","false","data-target","menu",1,"navbar-burger",3,"ngClass","click"],["aria-hidden","true"],["id","menu",1,"navbar-menu",3,"ngClass","click"],[1,"navbar-start"],$localize(f||(f=Rv(["Home"]))),[1,"navbar-item","has-dropdown","is-hoverable"],[1,"navbar-link"],$localize(d||(d=Rv(["Play online"]))),[1,"navbar-dropdown"],$localize(v||(v=Rv(["Create a game"]))),$localize(p||(p=Rv(["Join a game"]))),$localize(g||(g=Rv(["Play offline"]))),$localize(y||(y=Rv(["Create a game"]))),$localize(m||(m=Rv(["Learn the rules"]))),[1,"navbar-end"],["data-tooltip",$localize(k||(k=Rv(["Settings"]))),1,"navbar-item",3,"routerLink"],[3,"icon"],[1,"navbar-item"],[4,"ngIf","ngIfElse"],["connect",""],["id","logout",1,"navbar-item",3,"click"],$localize(_||(_=Rv(["Log out"]))),[1,"buttons"],[1,"button","is-primary",3,"routerLink"],$localize(w||(w=Rv(["Register"]))),[1,"button","is-light",3,"routerLink"],$localize(C||(C=Rv(["Log in"])))]},template:function(e,t){if(1&e&&(lb(0,"nav",0),lb(1,"div",1),lb(2,"a",2),fb(3,"img",3),hb(),lb(4,"a",4),mb("click",function(){return t.showMenu=!t.showMenu}),fb(5,"span",5),fb(6,"span",5),fb(7,"span",5),hb(),hb(),lb(8,"div",6),mb("click",function(){return t.showMenu=!t.showMenu}),lb(9,"div",7),lb(10,"a",2),UE(11,8),hb(),lb(12,"div",9),lb(13,"a",10),UE(14,11),hb(),lb(15,"div",12),lb(16,"a",2),UE(17,13),hb(),lb(18,"a",2),UE(19,14),hb(),hb(),hb(),lb(20,"div",9),lb(21,"a",10),UE(22,15),hb(),lb(23,"div",12),lb(24,"a",2),UE(25,16),hb(),lb(26,"a",2),UE(27,17),hb(),hb(),hb(),hb(),lb(28,"div",18),lb(29,"a",19),fb(30,"fa-icon",20),hb(),lb(31,"div",21),ab(32,zne,7,1,"ng-container",22),ab(33,qne,6,4,"ng-template",null,23,OP),hb(),hb(),hb(),hb()),2&e){var n=ob(34);Pw(2),ub("routerLink",eP(12,$ne)),Pw(2),ub("ngClass",t.showMenu?"is-active":""),Pw(4),ub("ngClass",t.showMenu?"is-active":""),Pw(2),ub("routerLink",eP(13,$ne)),Pw(6),ub("routerLink",eP(14,Wne)),Pw(2),ub("routerLink",eP(15,jne)),Pw(6),ub("routerLink",eP(16,Zne)),Pw(2),ub("routerLink",eP(17,Yne)),Pw(3),ub("routerLink",eP(18,Kne)),Pw(1),ub("icon",t.faCog),Pw(2),ub("ngIf",t.username)("ngIfElse",n)}},directives:[jM,IT,Vne,NT],encapsulation:2}),e}(),Qne=function(){var e=rp(function e(t,n){tp(this,e),this._themeService=t,this._errorLoggerService=n});return e.\u0275fac=function(t){return new(t||e)(sb(lte),sb(Q5))},e.\u0275cmp=ey({type:e,selectors:[["app-root"]],decls:3,vars:0,consts:[[1,"container","mt-2"]],template:function(e,t){1&e&&(fb(0,"app-header"),lb(1,"main",0),fb(2,"router-outlet"),hb())},directives:[Jne,YM],encapsulation:2}),e}(),Xne=function(){function e(t,n){tp(this,e),this.x=t,this.y=n}return rp(e,[{key:"equals",value:function(e){return this.x===e.x&&this.y===e.y}}]),e}(),ere=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"isDown",value:function(){return 1===this.y}},{key:"isUp",value:function(){return-1===this.y}},{key:"isLeft",value:function(){return-1===this.x}},{key:"isRight",value:function(){return 1===this.x}},{key:"toInt",value:function(){return 0===this.x&&-1===this.y?0:1===this.x&&0===this.y?1:0===this.x&&1===this.y?2:-1===this.x&&0===this.y?3:-1===this.x&&-1===this.y?4:1===this.x&&-1===this.y?5:-1===this.x&&1===this.y?6:7}},{key:"toString",value:function(){return 0===this.x&&-1===this.y?"UP":1===this.x&&0===this.y?"RIGHT":0===this.x&&1===this.y?"DOWN":-1===this.x&&0===this.y?"LEFT":-1===this.x&&-1===this.y?"UP_LEFT":1===this.x&&-1===this.y?"UP_RIGHT":-1===this.x&&1===this.y?"DOWN_LEFT":"DOWN_RIGHT"}}]),n}(Xne),tre=function(){function e(){tp(this,e)}return rp(e,[{key:"of",value:function(e,t){var n,r=Qv(this.all);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(i.x===e&&i.y===t)return j5.success(i)}}catch(a){r.e(a)}finally{r.f()}return j5.failure("Invalid x and y in direction construction")}},{key:"fromDelta",value:function(e,t){return 0===e&&0===t?j5.failure("Empty delta for direction"):Math.abs(e)===Math.abs(t)||0===e||0===t?this.of(Math.sign(e),Math.sign(t)):j5.failure("Invalid delta for direction: ".concat(e,", ").concat(t))}},{key:"fromMove",value:function(e,t){return this.fromDelta(t.x-e.x,t.y-e.y)}},{key:"fromString",value:function(e){switch(e){case"UP":return this.of(0,-1);case"RIGHT":return this.of(1,0);case"DOWN":return this.of(0,1);case"LEFT":return this.of(-1,0);case"UP_LEFT":return this.of(-1,-1);case"UP_RIGHT":return this.of(1,-1);case"DOWN_LEFT":return this.of(-1,1);case"DOWN_RIGHT":return this.of(1,1);default:return j5.failure("Invalid direction string ".concat(e))}}},{key:"fromInt",value:function(e){switch(e){case 0:return this.of(0,-1);case 1:return this.of(1,0);case 2:return this.of(0,1);case 3:return this.of(-1,0);case 4:return this.of(-1,-1);case 5:return this.of(1,-1);case 6:return this.of(-1,1);case 7:return this.of(1,1);default:return j5.failure("Invalid int direction: ".concat(e))}}}]),e}(),nre=function(e){Gv(n,e);var t=$v(n);function n(e,r){return tp(this,n),t.call(this,e,r)}return rp(n,[{key:"isDiagonal",value:function(){return 0!==this.x&&0!==this.y}},{key:"getOpposite",value:function(){return n.factory.of(-this.x,-this.y).get()}}]),n}(ere);nre.UP=new nre(0,-1),nre.UP_RIGHT=new nre(1,-1),nre.RIGHT=new nre(1,0),nre.DOWN_RIGHT=new nre(1,1),nre.DOWN=new nre(0,1),nre.DOWN_LEFT=new nre(-1,1),nre.LEFT=new nre(-1,0),nre.UP_LEFT=new nre(-1,-1),nre.factory=new(function(e){Gv(n,e);var t=$v(n);function n(){var e;return tp(this,n),(e=t.apply(this,arguments)).all=[nre.UP,nre.UP_RIGHT,nre.RIGHT,nre.DOWN_RIGHT,nre.DOWN,nre.DOWN_LEFT,nre.LEFT,nre.UP_LEFT],e}return rp(n)}(tre)),nre.DIRECTIONS=nre.factory.all,nre.encoder=new(function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"encode",value:function(e){return e.toString()}},{key:"decode",value:function(e){return X5("string"==typeof e,"Invalid encoded direction"),nre.factory.fromString(e).get()}}]),n}(Yee));var rre=function(e){Gv(n,e);var t=$v(n);function n(e,r){return tp(this,n),t.call(this,e,r)}return rp(n,[{key:"getOpposite",value:function(){return n.factory.of(-this.x,-this.y).get()}}]),n}(ere);rre.UP=new rre(0,-1),rre.RIGHT=new rre(1,0),rre.DOWN=new rre(0,1),rre.LEFT=new rre(-1,0),rre.factory=new(function(e){Gv(n,e);var t=$v(n);function n(){var e;return tp(this,n),(e=t.apply(this,arguments)).all=[rre.UP,rre.RIGHT,rre.DOWN,rre.LEFT],e}return rp(n,[{key:"of",value:function(e,t){return 0===e&&-1===t?j5.success(rre.UP):1===e&&0===t?j5.success(rre.RIGHT):0===e&&1===t?j5.success(rre.DOWN):-1===e&&0===t?j5.success(rre.LEFT):j5.failure("Invalid orthogonal from x and y")}}]),n}(tre)),rre.ORTHOGONALS=rre.factory.all,rre.encoder=new(function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"encode",value:function(e){return e.toString()}},{key:"decode",value:function(e){return X5("string"==typeof e,"Invalid encoded orthogonal"),rre.factory.fromString(e).get()}}]),n}(Yee));var ire=function(){function e(t,n){tp(this,e),this.x=t,this.y=n}return rp(e,[{key:"getNext",value:function(t,n){var r;return new e(this.x+(n=null!==(r=n)&&void 0!==r?r:1)*t.x,this.y+n*t.y)}},{key:"getPrevious",value:function(e,t){var n;return this.getNext(e,-(t=null!==(n=t)&&void 0!==n?n:1))}},{key:"getLeft",value:function(t){return new e(this.x+t.y,this.y+-t.x)}},{key:"getRight",value:function(t){return new e(this.x+-t.y,this.y+t.x)}},{key:"getOpposite",value:function(){return new e(-this.x,-this.y)}},{key:"isInRange",value:function(e,t){return!(this.x<0||this.y<0||this.x>=e||this.y>=t)}},{key:"isNotInRange",value:function(e,t){return this.x<0||this.y<0||this.x>=e||this.y>=t}},{key:"getDirectionToward",value:function(e){return nre.factory.fromMove(this,e)}},{key:"getOrthogonalDistance",value:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}},{key:"getDistance",value:function(e){if(!e.isAlignedWith(this))throw new Error("Cannot calculate distance with non aligned coords.");var t=Math.abs(e.x-this.x),n=Math.abs(e.y-this.y);return Math.max(t,n)}},{key:"isHexagonallyAlignedWith",value:function(e){var t=this.x-e.x,n=this.y-e.y;return t!==n&&(t===-n||t*n==0)}},{key:"isAlignedWith",value:function(e){var t=Math.abs(this.x-e.x),n=Math.abs(this.y-e.y);return t===n||t*n==0}},{key:"getVectorToward",value:function(t){return new e(t.x-this.x,t.y-this.y)}},{key:"getMinimalVectorToward",value:function(e){return this.getVectorToward(e).toVector()}},{key:"getCoordsToward",value:function(e){if(e.equals(this))return[];if(!e.isAlignedWith(this))return[];for(var t=this.getDirectionToward(e).get(),n=this.getNext(t,1),r=[];!1===n.equals(e);)r.push(n),n=n.getNext(t,1);return r}},{key:"toVector",value:function(){for(var t=Math.abs(this.x),n=Math.abs(this.y),r=Math.max(t,n),i=this.x,a=this.y,o=2;o<=r;)i%o==0&&a%o==0?(i/=o,a/=o):o++;return new e(i,a)}},{key:"isBetween",value:function(e,t){var n=e.getMinimalVectorToward(this),r=t.getMinimalVectorToward(this);return n.equals(r.getOpposite())}},{key:"equals",value:function(e){return this===e||e.x===this.x&&e.y===this.y}},{key:"compareTo",value:function(e){return e.y===this.y?e.x===this.x?0:this.x<e.x?-1:1:this.y<e.y?-1:1}},{key:"toString",value:function(){return"("+this.x+", "+this.y+")"}}],[{key:"numberEncoder",value:function(t,n){return Jee.tuple([Jee.numberEncoder(t),Jee.numberEncoder(n)],function(e){return[e.x,e.y]},function(t){return new e(t[0],t[1])})}}]),e}();ire.encoder=new(function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"encode",value:function(e){return{x:e.x,y:e.y}}},{key:"decode",value:function(e){var t=e;return X5(null!=t.x&&"number"==typeof t.x&&null!=t.y&&"number"==typeof t.y,"Invalid encoded coord"),new ire(t.x,t.y)}}]),n}(Yee));var are=Bv(5378),ore=function(){var e=function(){function e(){tp(this,e)}return rp(e,[{key:"infoMessage",value:function(e){this.message(e,"is-info")}},{key:"gameMessage",value:function(e){this.message(e,"is-warning")}},{key:"criticalMessage",value:function(e){this.message(e,"is-danger")}},{key:"message",value:function(e,t){(0,are.toast)({message:e,duration:3e3,position:"top-center",closeOnClick:!0,type:t,dismissible:!0})}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Eg({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),sre=function(){var e=function(){function e(t){tp(this,e),this.messageDisplayer=t,this.SPACE_SIZE=100,this.STROKE_WIDTH=8,this.SMALL_STROKE_WIDTH=2,this.scores=sB.empty(),this.imagesLocation="assets/images/"}return rp(e,[{key:"message",value:function(e){this.messageDisplayer.gameMessage(e)}},{key:"cancelMove",value:function(e){return this.cancelMoveAttempt(),this.cancelMoveOnWrapper(e),null==e?K5.SUCCESS:(this.messageDisplayer.gameMessage(e),K5.failure(e))}},{key:"cancelMoveAttempt",value:function(){}},{key:"getPlayerClass",value:function(e){switch(e){case ete.ZERO:return"player0";case ete.ONE:return"player1";default:return nB.expectToBe(e,Xee.NONE),""}}},{key:"pass",value:function(){var e=this;return tB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Q5.logError("GameComponent","pass() called on a game that does not redefine it",{gameName:e.constructor.name}));case 1:case"end":return t.stop()}},t)}))()}},{key:"getTurn",value:function(){return this.rules.node.gameState.turn}},{key:"getCurrentPlayer",value:function(){return this.rules.node.gameState.getCurrentPlayer()}},{key:"getState",value:function(){return this.rules.node.gameState}},{key:"getPreviousState",value:function(){return this.rules.node.mother.get().gameState}},{key:"range",value:function(e){for(var t=[],n=0;n<e;n++)t.push(n);return t}}]),e}();return e.\u0275fac=function(t){return new(t||e)(sb(ore))},e.\u0275cmp=ey({type:e,selectors:[["ng-component"]],decls:0,vars:0,template:function(e,t){},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),ure=function(){var e,t=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"getHexaCoordsBy",value:function(e,t){var n=new ire(e,t);return this.getHexaCoordsAt(n)}},{key:"getHexaCoordsAt",value:function(e){var t,n="",r=this.hexaLayout.getHexaCoordsAt(e),i=Qv(r);try{for(i.s();!(t=i.n()).done;){var a=t.value;n+=a.x+" "+a.y+" "}}catch(o){i.e(o)}finally{i.f()}return n+=r[0].x+" "+r[0].y}},{key:"getCenterBy",value:function(e,t){var n=new ire(e,t);return this.getCenterAt(n)}},{key:"getCenterAt",value:function(e){return this.hexaLayout.getCenterAt(e)}}]),n}(sre);return t.\u0275fac=function(n){return(e||(e=tk(t)))(n||t)},t.\u0275cmp=ey({type:t,selectors:[["ng-component"]],features:[zC],decls:0,vars:0,template:function(e,t){},encapsulation:2}),t}(),cre=function(){function e(t){tp(this,e),this.value=t}return rp(e,[{key:"equals",value:function(e){return this===e}},{key:"is",value:function(e){return this.value===e.value}},{key:"isPlayer",value:function(){return this===e.ZERO||this===e.ONE}}],[{key:"from",value:function(t){switch(t){case e.ZERO.value:return e.ZERO;case e.ONE.value:return e.ONE;case e.EMPTY.value:return e.EMPTY;case e.NONE.value:return e.NONE;default:throw new Error("FourStatePiece has no value matching "+t)}}},{key:"ofPlayer",value:function(t){switch(t){case ete.ZERO:return e.ZERO;default:return nB.expectToBe(t,ete.ONE),e.ONE}}}]),e}();cre.ZERO=new cre(ete.ZERO.value),cre.ONE=new cre(ete.ONE.value),cre.EMPTY=new cre(Xee.NONE.value),cre.NONE=new cre(3);var lre=function(e){Gv(n,e);var t=$v(n);function n(e,r){return tp(this,n),t.call(this,e,r)}return rp(n,[{key:"getOpposite",value:function(){return n.factory.of(-this.x,-this.y).get()}}],[{key:"getAngle",value:function(e){switch(e){case n.UP:return 0;case n.UP_RIGHT:return 60;case n.RIGHT:return 120;case n.DOWN:return 180;case n.DOWN_LEFT:return 240;default:return nB.expectToBe(e,n.LEFT),300}}}]),n}(ere);lre.UP=new lre(0,-1),lre.LEFT=new lre(-1,0),lre.UP_RIGHT=new lre(1,-1),lre.DOWN_LEFT=new lre(-1,1),lre.RIGHT=new lre(1,0),lre.DOWN=new lre(0,1),lre.factory=new(function(e){Gv(n,e);var t=$v(n);function n(){var e;return tp(this,n),(e=t.apply(this,arguments)).all=[lre.UP,lre.UP_RIGHT,lre.RIGHT,lre.DOWN,lre.DOWN_LEFT,lre.LEFT],e}return rp(n)}(tre)),lre.encoder=new(function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"maxValue",value:function(){return 5}},{key:"encodeNumber",value:function(e){switch(e){case lre.UP:return 0;case lre.UP_RIGHT:return 1;case lre.RIGHT:return 2;case lre.DOWN:return 3;case lre.DOWN_LEFT:return 4;default:return 5}}},{key:"decodeNumber",value:function(e){return X5(0<=e&&e<=5,"Invalid encoded number for HexaDirection "+e),lre.factory.all[e]}}]),n}(Jee));var hre=function(){function e(t,n,r){tp(this,e),this.size=t,this.origin=n,this.orientation=r}return rp(e,[{key:"getCenterAt",value:function(e){var t=this.orientation.conversionMatrix;return new ire(this.size*(t[0]*e.x+t[1]*e.y)+this.origin.x,this.size*(t[2]*e.x+t[3]*e.y)+this.origin.y)}},{key:"getCornerOffset",value:function(e){var t=2*Math.PI*(this.orientation.startAngle+e)/6;return new ire(this.size*Math.cos(t),this.size*Math.sin(t))}},{key:"getHexaCoordsAt",value:function(e){for(var t=this.getCenterAt(e),n=[],r=0;r<6;r+=1){var i=this.getCornerOffset(r);n.push(new ire(t.x+i.x,t.y+i.y))}return n}}]),e}(),fre=rp(function e(){tp(this,e)}),dre=function(e){Gv(n,e);var t=$v(n);function n(){var e;return tp(this,n),(e=t.call(this)).startAngle=.5,e.conversionMatrix=[Math.sqrt(3),Math.sqrt(3)/2,0,1.5],e.inverseConversionMatrix=[Math.sqrt(3)/3,-1/3,0,2/3],e}return rp(n)}(fre);dre.INSTANCE=new dre;var vre=function(e){Gv(n,e);var t=$v(n);function n(){var e;return tp(this,n),(e=t.call(this)).startAngle=0,e.conversionMatrix=[1.5,0,Math.sqrt(3)/2,Math.sqrt(3)],e.inverseConversionMatrix=[2/3,0,-1/3,Math.sqrt(3)/3],e}return rp(n,[{key:"isOnBorder",value:function(e,t){return this.isOnTopRightBorder(e,t)||this.isOnRightBorder(e,t)||this.isOnBottomRightBorder(e,t)||this.isOnBottomLeftBorder(e,t)||this.isOnLeftBorder(e,t)||this.isOnTopLeftBorder(e,t)}},{key:"isOnTopRightBorder",value:function(e,t){return 0===t.y}},{key:"isOnRightBorder",value:function(e,t){return t.x===e.width-1}},{key:"isOnLeftBorder",value:function(e,t){return 0===t.x}},{key:"isOnBottomLeftBorder",value:function(e,t){return t.y===e.height-1}},{key:"isOnTopLeftBorder",value:function(e,t){return null!=e.excludedCases[t.y]?t.x===e.excludedCases[t.y]:t.y===e.excludedCases.length&&0===t.x}},{key:"isOnBottomRightBorder",value:function(e,t){return null!=e.excludedCases[e.height-1-t.y]?e.width-1-t.x===e.excludedCases[e.height-1-t.y]:e.height-1-t.y===e.excludedCases.length&&t.x===e.width-1}},{key:"getAllBorders",value:function(e){var t=this,n=[];return e.forEachCoord(function(r,i){t.isOnBorder(e,r)&&n.push(r)}),n}},{key:"isTopCorner",value:function(e,t){return this.isOnTopLeftBorder(e,t)&&this.isOnTopRightBorder(e,t)}},{key:"isTopLeftCorner",value:function(e,t){return this.isOnTopLeftBorder(e,t)&&this.isOnLeftBorder(e,t)}},{key:"isTopRightCorner",value:function(e,t){return this.isOnTopRightBorder(e,t)&&this.isOnRightBorder(e,t)}},{key:"isBottomCorner",value:function(e,t){return this.isOnBottomLeftBorder(e,t)&&this.isOnBottomRightBorder(e,t)}},{key:"isBottomLeftCorner",value:function(e,t){return this.isOnBottomLeftBorder(e,t)&&this.isOnLeftBorder(e,t)}},{key:"isBottomRightCorner",value:function(e,t){return this.isOnBottomRightBorder(e,t)&&this.isOnRightBorder(e,t)}}]),n}(fre);vre.INSTANCE=new vre;var pre=function(){var e=rp(function e(){tp(this,e)});return e.CANNOT_CHOOSE_OPPONENT_PIECE=function(){return $localize(b||(b=Rv(["You cannot pick a piece of the opponent."])))},e.MUST_CLICK_ON_EMPTY_SPACE=function(){return $localize(E||(E=Rv(["You must click on an empty space."])))},e.CANNOT_SELF_CAPTURE=function(){return $localize(S||(S=Rv(["Your landing space should be empty or contain a piece of the opponent."])))},e.MUST_CHOOSE_PLAYER_PIECE=function(){return $localize(P||(P=Rv(["You must pick one of your pieces."])))},e.CANNOT_PASS=function(){return $localize(O||(O=Rv(["You cannot pass your turn."])))},e.MUST_LAND_ON_EMPTY_SPACE=function(){return $localize(T||(T=Rv(["You must drop your piece on an empty space."])))},e.MUST_PASS=function(){return $localize(I||(I=Rv(["You must pass your turn."])))},e.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY=function(){return $localize(x||(x=Rv(["You have selected an empty space, you must select one of your own pieces."])))},e.MOVE_CANNOT_BE_STATIC=function(){return $localize(A||(A=Rv(["You must choose different starting and ending coordinates."])))},e}(),gre=function(){function e(t,n){tp(this,e),this.ruler=t,this.name=n}return rp(e,[{key:"toString",value:function(){return this.name}}]),e}(),yre=function(){function e(t){tp(this,e),this.value=t}return rp(e,[{key:"toString",value:function(){return""+this.value}}],[{key:"fromWinner",value:function(t){return t.isPlayer()?new e(t.getVictoryValue()):new e(0)}}]),e}(),mre=function(){function e(){tp(this,e)}return rp(e,null,[{key:"toComparableObjectSet",value:function(e){var t=[];return e.forEach(function(e){t.some(function(t){return t.equals(e)})||t.push(e)}),t}},{key:"toComparableSet",value:function(e){var t=[];return e.forEach(function(e){t.some(function(t){return oB(t,e)})||t.push(e)}),t}}]),e}(),kre=function(e){function t(e){tp(this,t),this.values=void 0===e?[]:mre.toComparableSet(e)}return rp(t,[{key:"equals",value:function(e){if(e.size()!==this.size())return!1;var t,n=Qv(this);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(!1===e.contains(r))return!1}}catch(i){n.e(i)}finally{n.f()}return!0}},{key:"toString",value:function(){var e,t="",n=Qv(this);try{for(n.s();!(e=n.n()).done;){var r=e.value;t+=null==r?"null, ":r.toString()+", "}}catch(i){n.e(i)}finally{n.f()}return"["+t.slice(0,-2)+"]"}},{key:"add",value:function(e){return!this.contains(e)&&(this.values.push(e),!0)}},{key:"union",value:function(e){var t,n=Qv(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.add(r)}}catch(i){n.e(i)}finally{n.f()}}},{key:"contains",value:function(e){var t,n=Qv(this.values);try{for(n.s();!(t=n.n()).done;){if(oB(t.value,e))return!0}}catch(r){n.e(r)}finally{n.f()}return!1}},{key:"size",value:function(){return this.values.length}},{key:"toList",value:function(){var e,t=[],n=Qv(this);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.push(r)}}catch(i){n.e(i)}finally{n.f()}return t}},{key:"getAnyElement",value:function(){return this.size()>0?sB.of(this.values[0]):sB.empty()}},{key:Symbol.iterator,value:function(){return this.values.values()}}]),t}(),_re=function(){function e(t){tp(this,e),this.turn=t}return rp(e,[{key:"getCurrentPlayer",value:function(){return ete.fromTurn(this.turn)}},{key:"getCurrentOpponent",value:function(){return this.turn%2==1?ete.ZERO:ete.ONE}}]),e}(),wre=function(e){Gv(n,e);var t=$v(n);function n(e,r){var i;return tp(this,n),(i=t.call(this,r)).board=e,i}return rp(n,[{key:"getPieceAt",value:function(e){if(this.isOnBoard(e))return this.board[e.y][e.x];throw new Error("Accessing coord not on board "+e+".")}},{key:"isOnBoard",value:function(e){return e.isInRange(this.board[0].length,this.board.length)}},{key:"getPieceAtXY",value:function(e,t){return this.getPieceAt(new ire(e,t))}},{key:"forEachCoord",value:function(e){var t,n=Qv(this.getCoordsAndContents());try{for(n.s();!(t=n.n()).done;){var r=Lv(t.value,2);e(r[0],r[1])}}catch(i){n.e(i)}finally{n.f()}}},{key:"getCoordsAndContents",value:function(){for(var e=[],t=0;t<this.board.length;t++)for(var n=0;n<this.board[t].length;n++){var r=new ire(n,t);this.isOnBoard(r)&&e.push([r,this.getPieceAt(r)])}return e}},{key:"getCopiedBoard",value:function(){return ite.copyBiArray(this.board)}}]),n}(_re),Cre=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"isInBoard",value:function(e){return e.isInRange(9,9)&&this.getPieceAt(e)!==cre.NONE}},{key:"isPiece",value:function(e){return this.getPieceAt(e).isPlayer()}},{key:"getScores",value:function(){for(var e=[14,14],t=0;t<9;t++)for(var n=0;n<9;n++)this.getPieceAtXY(n,t)===cre.ZERO&&(e[1]=e[1]-1),this.getPieceAtXY(n,t)===cre.ONE&&(e[0]=e[0]-1);return e}}],[{key:"getInitialState",value:function(){var e=cre.EMPTY,t=cre.NONE,r=cre.ZERO,i=cre.ONE;return new n([[t,t,t,t,i,i,i,i,i],[t,t,t,i,i,i,i,i,i],[t,t,e,e,i,i,i,e,e],[t,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,t],[e,e,r,r,r,e,e,t,t],[r,r,r,r,r,r,t,t,t],[r,r,r,r,r,t,t,t,t]],0)}}]),n}(wre),bre=rp(function e(){tp(this,e)}),Ere=function(e){Gv(n,e);var t=$v(n);function n(e,r){var i;return tp(this,n),(i=t.call(this)).coord=new ire(e,r),i}return rp(n)}(bre),Sre=function(e){Gv(n,e);var t=$v(n);function n(e,r,i){var a;if(tp(this,n),(a=t.call(this,e.x,e.y)).dir=r,a.lastPiece=i,e.isNotInRange(9,9))throw new Error("Coord "+e.toString()+" out of range, invalid move!");return Wv(a)}return rp(n,[{key:"toString",value:function(){return this.isSingleCoord()?"AbaloneMove("+this.coord.x+", "+this.coord.y+", "+this.dir.toString()+")":"AbaloneMove("+this.coord.toString()+" > "+this.lastPiece.get().toString()+", "+this.dir.toString()+")"}},{key:"isSingleCoord",value:function(){return this.lastPiece.isAbsent()}},{key:"equals",value:function(e){return e.coord.equals(this.coord)&&e.dir.equals(this.dir)&&e.lastPiece.equals(this.lastPiece)}}],[{key:"fromSingleCoord",value:function(e,t){try{return j5.success(new n(e,t,sB.empty()))}catch(r){return j5.failure(r.message)}}},{key:"fromDoubleCoord",value:function(e,t,r){var i=[e,t];ite.sortByDescending(i,n.sortCoord);var a=i[1].getDirectionToward(i[0]).get(),o=lre.factory.fromDelta(a.x,a.y);if(o.isFailure())return j5.failure("Invalid direction");var s=o.get();return i[1].getDistance(i[0])>2?j5.failure("Distance between first coord and last coord is too great"):s.equals(r)?n.fromSingleCoord(i[1],r):s.getOpposite().equals(r)?n.fromSingleCoord(i[0],r):j5.success(new n(i[1],r,sB.of(i[0])))}},{key:"sortCoord",value:function(e){return 9*e.y+e.x}}]),n}(Ere);Sre.encoder=new(function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"maxValue",value:function(){return 104831}},{key:"encodeNumber",value:function(e){var t=9*e.coord.x*8+8*e.coord.y+e.dir.toInt();if(e.isSingleCoord())return t;var n=e.lastPiece.get();return 9*n.x*2*9*9*8+2*n.y*9*9*8+648+t}},{key:"decodeNumber",value:function(e){var t=e%8;e=(e-t)/8;var n=lre.factory.fromInt(t).get(),r=e%9,i=(e=(e-r)/9)%9;e=(e-i)/9;var a=new ire(i,r);if(0===e)return Sre.fromSingleCoord(a,n).get();var o=(e=(e-1)/2)%9,s=(e=(e-o)/9)%9;e=(e-s)/9;var u=new ire(s,o);return Sre.fromDoubleCoord(a,u,n).get()}}]),n}(Jee));var Pre=(function(e){e.VICTORY="VICTORY",e.PRE_VICTORY="PRE_VICTORY",e.DEFAULT="DEFAULT"}(Pre||(Pre={})),Pre),Ore=function(){function e(){tp(this,e),this.map=[],this.isImmutable=!1}return rp(e,[{key:"makeImmutable",value:function(){this.isImmutable=!0}},{key:"get",value:function(e){var t,n=Qv(this.map);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(oB(r.key,e))return sB.of(r.value)}}catch(i){n.e(i)}finally{n.f()}return sB.empty()}},{key:"forEach",value:function(e){for(var t=0;t<this.map.length;t++)e(this.getByIndex(t))}},{key:"getByIndex",value:function(e){return this.map[e]}},{key:"putAll",value:function(e){this.checkImmutability("putAll");var t,n=Qv(e.map);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.put(r.key,r.value)}}catch(i){n.e(i)}finally{n.f()}}},{key:"checkImmutability",value:function(e){if(this.isImmutable)throw new Error("Cannot call "+e+" on immutable map!")}},{key:"put",value:function(e,t){this.checkImmutability("put");var n,r=Qv(this.map);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(oB(i.key,e)){var a=i.value;return i.value=t,sB.of(a)}}}catch(o){r.e(o)}finally{r.f()}return this.map.push({key:e,value:t}),sB.empty()}},{key:"containsKey",value:function(e){return this.map.some(function(t){return oB(t.key,e)})}},{key:"size",value:function(){return this.map.length}},{key:"listKeys",value:function(){return this.map.map(function(e){return e.key})}},{key:"getKeySet",value:function(){return new kre(this.listKeys())}},{key:"filter",value:function(t){var n,r=new e,i=Qv(this.map);try{for(i.s();!(n=i.n()).done;){var a=n.value;t(a.key,a.value)&&r.set(a.key,a.value)}}catch(o){i.e(o)}finally{i.f()}return r}},{key:"replace",value:function(e,t){if(this.checkImmutability("replace"),this.get(e).isAbsent())throw new Error("No Value to replace for key "+e.toString()+"!");return this.put(e,t),t}},{key:"set",value:function(e,t){if(this.checkImmutability("set"),this.containsKey(e))throw new Error("Key "+e.toString()+" already exist in Map!");this.map.push({key:e,value:t})}},{key:"delete",value:function(e){this.checkImmutability("delete");for(var t=0;t<this.map.length;t++)if(oB(this.map[t].key,e)){var n=this.map[t].value,r=this.map.slice(0,t),i=this.map.slice(t+1);return this.map=r.concat(i),n}throw new Error('No Value to delete for key "'+e.toString()+'"!')}},{key:"getCopy",value:function(){var e,t=new this.constructor,n=Qv(this.listKeys());try{for(n.s();!(e=n.n()).done;){var r=e.value;t.set(r,this.get(r).get())}}catch(i){n.e(i)}finally{n.f()}return t}},{key:"equals",value:function(e){var t=this.getKeySet(),n=e.getKeySet();if(!1===t.equals(n))return!1;var r,i=Qv(t);try{for(i.s();!(r=i.n()).done;){var a=r.value,o=this.get(a).get(),s=e.get(a);if(X5(s.isPresent(),"value is absent in a map even though its key is present!"),!1===oB(o,s.get()))return!1}}catch(u){i.e(u)}finally{i.f()}return!0}}]),e}(),Tre=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"reverse",value:function(){var e,t=new n,r=Qv(this.listKeys());try{for(r.s();!(e=r.n()).done;){var i=e.value,a=this.get(i).get();if(t.containsKey(a))t.get(a).get().add(i);else{var o=new kre;o.add(i),t.set(a,o)}}}catch(s){r.e(s)}finally{r.f()}return t}}]),n}(Ore),Ire=function(){var e=rp(function e(){tp(this,e)});return e.createdNodes=0,e.minimaxTime=0,e}(),xre=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:sB.empty(),r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:sB.empty(),i=arguments.length>3?arguments[3]:void 0;if(tp(this,e),this.gameState=t,this.mother=n,this.move=r,this.minimaxCreator=i,this.childs=sB.empty(),this.hopedValue=new Ore,this.ownValue=new Ore,this.possibleMoves=new Ore,this.ownValue=new Ore,null!=i){var a=i.getBoardValue(this);this.ownValue.set(i.name,a),this.hopedValue.set(i.name,a.value)}Ire.createdNodes++,rB(e.VERBOSE||!1,"creating "+this.myToString())}return rp(e,[{key:"findBestMove",value:function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=(new Date).getTime(),a=this.alphaBeta(e,Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,t,n,r);a.gameState.turn>this.gameState.turn+1;)a=a.mother.get(),e--;return Ire.minimaxTime+=(new Date).getTime()-i,a.move.get()}},{key:"alphaBeta",value:function(t,n,r,i,a,o){if(t<1)return rB(e.VERBOSE||!1,"isLeaf-Calculation : "+this.myToString()+" at depth "+t),this;if(i.ruler.getGameStatus(this).isEndGame)return rB(e.VERBOSE||!1,"isLeaf-EndGame("+e.ruler.getGameStatus(this).winner.toString()+") : "+this.myToString()+" at depth "+t),this;var s=this.getPossibleMoves(i);X5(s.length>0,"Minimax "+i.name+" should give move, received none!"),this.childs.isAbsent()&&(this.childs=sB.of([]));var u,c,l=[],h=this.gameState.getCurrentPlayer(),f=h===ete.ZERO?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER,d=h===ete.ZERO?function(e,t){return e<t}:function(e,t){return e>t},v=Qv(s);try{for(v.s();!(u=v.n()).done;){var p=u.value,g=this.getOrCreateChild(p,i).alphaBeta(t-1,n,r,i,a,o),y=g.getHopedValue(i);if(d(y,f)||0===l.length?(f=y,l=[g]):y===f&&l.push(g),o&&d(f,h===ete.ZERO?n:r))break;h===ete.ZERO?r=Math.min(f,r):n=Math.max(f,n)}}catch(k){v.e(k)}finally{v.f()}var m=(c=a?l[Math.floor(Math.random()*l.length)]:l[0]).hopedValue.get(i.toString()).get();return this.hopedValue.put(i.toString(),m),c}},{key:"getPossibleMoves",value:function(e){var t=this.possibleMoves.get(e.name);if(t.isAbsent()){var n=e.getListMoves(this);return this.possibleMoves.set(e.name,new kre(n)),n}return t.get().toList()}},{key:"getOrCreateChild",value:function(t,n){var r=this.getSonByMove(t);if(r.isAbsent()){var i=n.ruler.isLegal(t,this.gameState);X5(i.isSuccess(),"The minimax has accepted an illegal move, this should not happen.");var a=n.ruler.applyLegalMove(t,this.gameState,i.get());r=sB.of(new e(a,sB.of(this),sB.of(t),n)),this.childs.get().push(r.get())}return r.get()}},{key:"getSonByMove",value:function(e){X5(this.childs.isPresent(),"Cannot get son of uncalculated node");var t,n=Qv(this.childs.get());try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.move.isPresent()&&r.move.equalsValue(e))return sB.of(r)}}catch(i){n.e(i)}finally{n.f()}return sB.empty()}},{key:"getInitialNode",value:function(){for(var e=this;e.mother.isPresent();)e=e.mother.get();return e}},{key:"getHopedValue",value:function(e){return this.hopedValue.get(e.name).get()}},{key:"getOwnValue",value:function(e){var t=this.ownValue.get(e.name);if(t.isAbsent()){var n=e.getBoardValue(this);return this.ownValue.set(e.name,n),n}return t.get()}},{key:"myToString",value:function(){var e="",t=this;if(t.mother.isAbsent())return"NodeInitial: "+t.gameState.turn;for(;t.mother.isPresent();)e=(t.move.isAbsent()?" ":" > "+t.move.get().toString()+"> ")+t.gameState.turn+" "+e,t=t.mother.get();return"Node: "+e}},{key:"hasMoves",value:function(){return this.childs.isPresent()}},{key:"countDescendants",value:function(){if(this.childs.isAbsent())return 0;var e,t=this.childs.get().length,n=Qv(this.childs.get());try{for(n.s();!(e=n.n()).done;){t+=e.value.countDescendants()}}catch(r){n.e(r)}finally{n.f()}return t}}],[{key:"getScoreStatus",value:function(t){var n=!1;return t===Number.MAX_SAFE_INTEGER||t===Number.MIN_SAFE_INTEGER?(rB(e.VERBOSE||n,"VICTORY"),Pre.VICTORY):t===Number.MIN_SAFE_INTEGER+1?(rB(e.VERBOSE||n,"PRE_VICTORY_MIN"),Pre.PRE_VICTORY):t===Number.MAX_SAFE_INTEGER-1?(rB(e.VERBOSE||n,"PRE_VICTORY_MAX"),Pre.PRE_VICTORY):(rB(e.VERBOSE||n,"DEFAULT"),Pre.DEFAULT)}}]),e}();xre.VERBOSE=!1,xre.minimaxes=new Ore;var Are=function(){function e(t,n){tp(this,e),this.isEndGame=t,this.winner=n}return rp(e,[{key:"toBoardValue",value:function(){return this.winner.isPlayer()?this.winner.getVictoryValue():0}}],[{key:"getVictory",value:function(t){return t===ete.ZERO?e.ZERO_WON:e.ONE_WON}},{key:"getDefeat",value:function(t){return t===ete.ZERO?e.ONE_WON:e.ZERO_WON}}]),e}();Are.ZERO_WON=new Are(!0,ete.ZERO),Are.ONE_WON=new Are(!0,ete.ONE),Are.DRAW=new Are(!0,Xee.NONE),Are.ONGOING=new Are(!1,Xee.NONE);var Rre=function(){function e(t){tp(this,e),this.stateType=t,this.setInitialBoard()}return rp(e,[{key:"choose",value:function(e){var t=!1;rB(t,"Rules.choose: "+e.toString()+" was proposed");var n=this.isLegal(e,this.node.gameState);if(this.node.hasMoves()){rB(t,"Rules.choose: current node has moves");var r=this.node.getSonByMove(e);if(r.isPresent())return X5(n.isSuccess(),"Rules.choose: Move is illegal: "+n.getReasonOr("")),rB(t,"Rules.choose: and this proposed move is found in the list, so it is legal"),this.node=r.get(),!0}if(rB(t,"Rules.choose: current node has no moves or is pruned, let's verify ourselves"),n.isFailure())return rB(t,"Rules.choose: Move is illegal: "+n.getReason()),!1;rB(t,"Rules.choose: Move is legal, let's apply it");var i=this.applyLegalMove(e,this.node.gameState,n.get()),a=new xre(i,sB.of(this.node),sB.of(e));return this.node=a,!0}},{key:"setInitialBoard",value:function(){if(null==this.node){var e=this.stateType.getInitialState();xre.ruler=this,this.node=new xre(e)}else this.node=this.node.getInitialNode()}},{key:"applyMoves",value:function(e,t,n){var r,i=0,a=Qv(e);try{for(a.s();!(r=a.n()).done;){var o=n(r.value),s=this.isLegal(o,t);X5(s.isSuccess(),"Can't create state from invalid moves ("+i+"): "+s.toString()+"."),t=this.applyLegalMove(o,t,s.get()),i++}}catch(u){a.e(u)}finally{a.f()}return t}}]),e}(),Nre=function(){var e=rp(function e(){tp(this,e)});return e.CANNOT_MOVE_MORE_THAN_THREE_PIECES=function(){return $localize(R||(R=Rv(["You cannot move more than 3 of your pieces!"])))},e.NOT_ENOUGH_PIECE_TO_PUSH=function(){return $localize(N||(N=Rv(["You don't have enough pieces to push that group!"])))},e.CANNOT_PUSH_YOUR_OWN_PIECES=function(){return $localize(M||(M=Rv(["You cannot push this piece because it is blocked by one of yours!"])))},e.MUST_ONLY_TRANSLATE_YOUR_PIECES=function(){return $localize(D||(D=Rv(["This line contains pieces of your opponent or empty spaces, which is forbidden."])))},e.TRANSLATION_IMPOSSIBLE=function(){return $localize(L||(L=Rv(["This move is impossible, some landing spaces are occupied."])))},e.LINE_AND_COORD_NOT_ALIGNED=function(){return $localize(F||(F=Rv(["This space is not aligned with the current line."])))},e}(),Mre=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"applyLegalMove",value:function(e,t,n){return new Cre(n,t.turn+1)}},{key:"isLegal",value:function(e,t){return n.isLegal(e,t)}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"isLegal",value:function(e,t){var r=this.getFirstPieceValidity(e,t);return r.isFailure()?r.toFailedFallible():e.isSingleCoord()?n.isLegalPush(e,t):n.isLegalSideStep(e,t)}},{key:"getFirstPieceValidity",value:function(e,t){var n=t.getPieceAt(e.coord);return!1===t.isPiece(e.coord)?K5.failure(pre.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):n===cre.ofPlayer(t.getCurrentOpponent())?K5.failure(pre.CANNOT_CHOOSE_OPPONENT_PIECE()):K5.SUCCESS}},{key:"isLegalPush",value:function(e,t){var r=1,i=e.coord.getNext(e.dir),a=cre.ofPlayer(t.getCurrentPlayer()),o=cre.EMPTY,s=t.getCopiedBoard();for(s[e.coord.y][e.coord.x]=o;r<=3&&t.isOnBoard(i)&&t.getPieceAt(i)===a;)r++,i=i.getNext(e.dir);return r>3?j5.failure(Nre.CANNOT_MOVE_MORE_THAN_THREE_PIECES()):!1===t.isInBoard(i)||(s[i.y][i.x]=a,t.getPieceAt(i)===o)?j5.success(s):n.isLegalRealPush(i,e,t,r,s)}},{key:"isLegalRealPush",value:function(e,t,n,r,i){for(var a=0,o=cre.ofPlayer(n.getCurrentOpponent()),s=cre.ofPlayer(n.getCurrentPlayer());a<r&&n.isOnBoard(e)&&n.getPieceAt(e)===o;)a++,e=e.getNext(t.dir);return a>=r?j5.failure(Nre.NOT_ENOUGH_PIECE_TO_PUSH()):e.isInRange(9,9)&&(n.getPieceAt(e)===cre.EMPTY&&(i[e.y][e.x]=o),n.getPieceAt(e)===s)?j5.failure(Nre.CANNOT_PUSH_YOUR_OWN_PIECES()):j5.success(i)}},{key:"isLegalSideStep",value:function(e,t){var n=e.lastPiece.get(),r=e.coord.getDirectionToward(n).get();n=n.getNext(r);for(var i=e.coord,a=cre.ofPlayer(t.getCurrentPlayer()),o=t.getCopiedBoard();!1===i.equals(n)&&i.isInRange(9,9);){if(t.getPieceAt(i)!==a)return j5.failure(Nre.MUST_ONLY_TRANSLATE_YOUR_PIECES());var s=i.getNext(e.dir);if(o[i.y][i.x]=cre.EMPTY,s.isInRange(9,9)){if(t.isPiece(s))return j5.failure(Nre.TRANSLATION_IMPOSSIBLE());t.getPieceAt(s)===cre.EMPTY&&(o[s.y][s.x]=a)}i=i.getNext(r)}return j5.success(o)}},{key:"getGameStatus",value:function(e){var t=e.gameState.getScores();return t[0]>5?Are.ZERO_WON:t[1]>5?Are.ONE_WON:Are.ONGOING}}]),n}(Rre),Dre=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"getListMoves",value:function(e){for(var t=[],n=e.gameState,r=n.getCurrentPlayer(),i=0;i<9;i++)for(var a=0;a<9;a++){var o=new ire(a,i);if(!1!==n.getPieceAt(o).is(r)){var s,u=Qv(lre.factory.all);try{for(u.s();!(s=u.n()).done;){var c=s.value,l=Sre.fromSingleCoord(o,c).get();if(this.isAcceptablePush(l,n)){t.push(l);var h,f=Qv(lre.factory.all);try{for(f.s();!(h=f.n()).done;)for(var d=h.value,v=1;v<=2&&!d.equals(c);v++){var p=o.getNext(d,v);if(!p.isInRange(9,9))break;var g=Sre.fromDoubleCoord(o,p,c).get();Mre.isLegal(g,n).isSuccess()&&t.push(g)}}catch(y){f.e(y)}finally{f.f()}}}}catch(y){u.e(y)}finally{u.f()}}}return new kre(t).toList()}},{key:"isAcceptablePush",value:function(e,t){var n=t.getScores(),r=Mre.isLegal(e,t);if(r.isSuccess()){var i=t.getCurrentOpponent().value;return!(new Cre(r.get(),t.turn+1).getScores()[i]>n[i])}return!1}},{key:"getBoardValue",value:function(e){var t=Mre.getGameStatus(e);if(t.isEndGame)return new yre(t.toBoardValue());var n=e.gameState.getScores();return new yre(n[1]-n[0])}}]),n}(gre),Lre=function(){function e(t,n,r){tp(this,e),this.title=t,this.instruction=n,this.state=r,this.previousMove=sB.empty()}return rp(e,[{key:"isMove",value:function(){return!1}},{key:"isAnyMove",value:function(){return!1}},{key:"isClick",value:function(){return!1}},{key:"isPredicate",value:function(){return!1}},{key:"isInformation",value:function(){return!1}},{key:"hasSolution",value:function(){return!1}},{key:"withPreviousMove",value:function(e){return this.previousMove=sB.of(e),this}}],[{key:"fromMove",value:function(e,t,n,r,i,a){return new Bre(e,t,n,r,i,a)}},{key:"forClick",value:function(e,t,n,r,i,a){return new Ure(e,t,n,r,i,a)}},{key:"anyMove",value:function(e,t,n,r,i){return new Vre(e,t,n,r,i)}},{key:"fromPredicate",value:function(e,t,n,r,i,a){return new zre(e,t,n,r,i,a)}},{key:"informational",value:function(e,t,n){return new Hre(e,t,n)}}]),e}(),Fre=function(e){Gv(n,e);var t=$v(n);function n(e,r,i,a,o){var s;return tp(this,n),(s=t.call(this,e,r,i)).solution=a,s.successMessage=o,s}return rp(n,[{key:"hasSolution",value:function(){return!0}},{key:"getSolution",value:function(){return this.solution}},{key:"getSuccessMessage",value:function(){return this.successMessage}}]),n}(Lre),Bre=function(e){Gv(n,e);var t=$v(n);function n(e,r,i,a,o,s){var u;return tp(this,n),(u=t.call(this,e,r,i,a[0],o)).acceptedMoves=a,u.failureMessage=s,X5(a.length>0,"TutorialStepMove: At least one accepted move should be provided, otherwise use TutorialStepInformational"),u}return rp(n,[{key:"isMove",value:function(){return!0}},{key:"getFailureMessage",value:function(){return this.failureMessage}}]),n}(Fre),Vre=function(e){Gv(n,e);var t=$v(n);function n(e,r,i,a,o){return tp(this,n),t.call(this,e,r,i,a,o)}return rp(n,[{key:"isAnyMove",value:function(){return!0}}]),n}(Fre),Ure=function(e){Gv(n,e);var t=$v(n);function n(e,r,i,a,o,s){var u;return tp(this,n),(u=t.call(this,e,r,i)).acceptedClicks=a,u.successMessage=o,u.failureMessage=s,u}return rp(n,[{key:"isClick",value:function(){return!0}},{key:"getSuccessMessage",value:function(){return this.successMessage}},{key:"getFailureMessage",value:function(){return this.failureMessage}}]),n}(Lre),zre=function(e){Gv(n,e);var t=$v(n);function n(e,r,i,a,o,s){var u;return tp(this,n),(u=t.call(this,e,r,i,a,s)).predicate=o,u}return rp(n,[{key:"isPredicate",value:function(){return!0}}]),n}(Fre),Hre=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"isInformation",value:function(){return!0}}]),n}(Lre),Gre=cre.EMPTY,qre=cre.NONE,$re=cre.ZERO,Wre=cre.ONE,jre=rp(function e(){tp(this,e),this.tutorial=[Lre.informational($localize(B||(B=Rv(["Initial board and goal of the game"]))),$localize(V||(V=Rv(["At Abalone, the goal of the game is to be the first player to push 6 opponent's pieces out of the board. Let us see how!"]))),Cre.getInitialState()),Lre.anyMove($localize(U||(U=Rv(["Moving a piece"]))),$localize(z||(z=Rv(["At each turn, move one, two, or three pieces either along their line, or on their side.\n        For your moves you can therefore choose between up to 6 directions.\n        The pieces you move must be aligned and consecutive, and the move should land on an empty space (except to push, we will see that later).\n        To make a move, click on one of your pieces, then click on an arrow to choose the move direction.<br/><br/>\n        You're playing Dark, make any move!"]))),Cre.getInitialState(),Sre.fromSingleCoord(new ire(2,6),lre.UP).get(),$localize(H||(H=Rv(["Congratulations!"])))),Lre.fromMove($localize(G||(G=Rv(["Pushing"]))),$localize(q||(q=Rv(["To push one opponent piece, you must move at least two of your pieces.\n        To push two opponent pieces, you must move three of your pieces.\n        If one of your pieces is in the way, it will be impossible to push.\n        You cannot move more than three pieces.<br/><br/>\n        Only one push towards the right is possible here, find it. (You're playing Dark)."]))),new Cre([[qre,qre,qre,qre,Gre,$re,$re,Wre,Wre],[qre,qre,qre,Gre,Gre,Gre,Gre,Gre,Gre],[qre,qre,Gre,$re,$re,$re,Wre,$re,Gre],[qre,Gre,Gre,Gre,Gre,Gre,Gre,Gre,Gre],[Gre,Gre,Gre,Gre,$re,$re,$re,Wre,Wre],[Gre,Gre,Gre,Gre,Gre,Gre,Gre,Gre,qre],[Gre,Gre,Gre,Gre,$re,Wre,Gre,qre,qre],[Gre,Gre,Gre,$re,Gre,Gre,qre,qre,qre],[Gre,Gre,$re,Gre,Gre,qre,qre,qre,qre]],0),[Sre.fromSingleCoord(new ire(4,4),lre.RIGHT).get()],$localize($||($=Rv(["Congratulations! You know everything you need to start a game!"]))),$localize(W||(W=Rv(["Failed!"]))))]});function Zre(e,t){if(1&e){var n=pb();_m(),lb(0,"circle",6),mb("click",function(){$y(n);var e=wb(2).index,t=wb().index;return wb().onPieceClick(e,t)}),hb()}if(2&e){var r=wb(2).index,i=wb().index,a=wb();bb("id","piece_",r,"_",i,""),ub("ngClass",a.getPieceClasses(r,i)),tb("cx",a.getCenterBy(r,i).x)("cy",a.getCenterBy(r,i).y)("r",.5*a.SPACE_SIZE)}}function Yre(e,t){if(1&e){var n=pb();_m(),lb(0,"g"),lb(1,"polyline",4),mb("click",function(){$y(n);var e=wb().index,t=wb().index;return wb().onCaseClick(e,t)}),hb(),ab(2,Zre,1,6,"circle",5),hb()}if(2&e){var r=wb(),i=r.index,a=r.$implicit,o=wb().index,s=wb();Pw(1),bb("id","case_",i,"_",o,""),ub("ngClass",s.getSquareClasses(i,o)),tb("points",s.getHexaCoordsBy(i,o)),Pw(1),ub("ngIf",s.isPiece(a))}}function Kre(e,t){if(1&e&&(_m(),lb(0,"g"),ab(1,Yre,3,5,"g",3),hb()),2&e){var n=t.$implicit,r=wb(2);Pw(1),ub("ngIf",r.isBoard(n))}}function Jre(e,t){if(1&e&&(_m(),lb(0,"g"),ab(1,Kre,2,1,"g",1),hb()),2&e){var n=t.$implicit;Pw(1),ub("ngForOf",n)}}function Qre(e,t){1&e&&(_m(),lb(0,"marker",7),fb(1,"polygon",8),hb()),2&e&&Cb("id","arrowhead_",t.$implicit.dir.toString(),"")}function Xre(e,t){if(1&e){var n=pb();_m(),lb(0,"g"),fb(1,"line",9),lb(2,"line",10),mb("click",function(){var e=$y(n).$implicit;return wb().chooseDirection(e.dir)}),hb(),lb(3,"polygon",11),mb("click",function(){var e=$y(n).$implicit;return wb().chooseDirection(e.dir)}),hb(),hb()}if(2&e){var r=t.$implicit;Pw(1),Cb("id","line_start_",r.dir.toString(),""),tb("x1",r.startCenter.x)("y1",r.startCenter.y)("x2",r.middle.x)("y2",r.middle.y),Pw(1),Cb("id","line_end_",r.dir.toString(),""),tb("x1",r.middle.x)("y1",r.middle.y)("x2",r.landingCenter.x)("y2",r.landingCenter.y),Pw(1),Cb("id","direction_",r.dir.toString(),""),tb("transform",r.transformation)}}var eie=rp(function e(t,n,r,i,a,o){tp(this,e),this.startCenter=t,this.middle=n,this.landingCenter=r,this.landing=i,this.dir=a,this.transformation=o}),tie=function(){var e=function(e){Gv(n,e);var t=$v(n);function n(e){var r;return tp(this,n),(r=t.call(this,e)).moveds=[],r.directions=[],r.selecteds=[],r.rules=new Mre(Cre),r.availableMinimaxes=[new Dre(r.rules,"Dummy")],r.encoder=Sre.encoder,r.tutorial=(new jre).tutorial,r.scores=sB.of([0,0]),r.SPACE_SIZE=30,r.hexaLayout=new hre(r.SPACE_SIZE,new ire(-8*r.SPACE_SIZE,2*r.SPACE_SIZE),dre.INSTANCE),r.updateBoard(),r}return rp(n,[{key:"updateBoard",value:function(){this.cancelMoveAttempt(),this.hidePreviousMove(),this.rules.node.move.isPresent()&&this.showPreviousMove(),this.hexaBoard=this.rules.node.gameState.getCopiedBoard(),this.scores=sB.of(this.rules.node.gameState.getScores())}},{key:"hidePreviousMove",value:function(){this.moveds=[]}},{key:"cancelMoveAttempt",value:function(){this.directions=[],this.selecteds=[]}},{key:"showPreviousMove",value:function(){var e=this.rules.node.move.get();e.isSingleCoord()?this.showPushingMove(e):this.showSideStepMove(e)}},{key:"showPushingMove",value:function(e){var t=this.rules.node.mother.get().gameState,n=e.coord;for(this.moveds=[n],n=n.getNext(e.dir);n.isInRange(9,9)&&t.isPiece(n);)this.moveds.push(n),n=n.getNext(e.dir);n.isInRange(9,9)&&this.moveds.push(n)}},{key:"showSideStepMove",value:function(e){var t=e.lastPiece.get(),n=e.coord.getDirectionToward(t).get();t=t.getNext(n);for(var r=e.coord;!1===r.equals(t);)this.moveds.push(r),this.moveds.push(r.getNext(e.dir)),r=r.getNext(n)}},{key:"onPieceClick",value:function(e,t){var n=this;return tB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#piece_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:return a=n.rules.node.gameState.getCurrentOpponent(),r.abrupt("return",n.hexaBoard[t][e].is(a)?n.opponentClick(e,t):0===n.selecteds.length?n.firstClick(e,t):1===n.selecteds.length?n.secondClick(e,t):n.thirdClick(e,t));case 5:case"end":return r.stop()}},r)}))()}},{key:"opponentClick",value:function(e,t){var n=this;return tB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.tryChoosingDirection(e,t);case 2:if(!r.sent.isSuccess()){r.next=6;break}r.t0=K5.SUCCESS,r.next=7;break;case 6:r.t0=n.cancelMove(pre.CANNOT_CHOOSE_OPPONENT_PIECE());case 7:return r.abrupt("return",r.t0);case 8:case"end":return r.stop()}},r)}))()}},{key:"firstClick",value:function(e,t){var n=this;return tB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(n.selecteds=[new ire(e,t)],n.showPossibleDirections(),K5.SUCCESS));case 1:case"end":return r.stop()}},r)}))()}},{key:"showPossibleDirections",value:function(){this.directions=[],this.showDirection(1===this.selecteds.length)}},{key:"showDirection",value:function(e){var t,n=this.rules.node.gameState,r=cre.ofPlayer(n.getCurrentPlayer()),i=this.selecteds[0],a=this.selecteds[this.selecteds.length-1],o=Qv(lre.factory.all);try{for(o.s();!(t=o.n()).done;){var s,u=t.value,c=i.getNext(u,1);if(n.isOnBoard(c)&&n.getPieceAt(c)===r){if(e)continue;if(c=a.getNext(u,1),n.isOnBoard(c)&&n.getPieceAt(c)===r)continue}if(s=e?Sre.fromSingleCoord(i,u).get():Sre.fromDoubleCoord(i,a,u).get(),this.rules.isLegal(s,n).isSuccess()){var l=this.getCenterAt(i),h=this.getCenterAt(c),f=this.getMiddleOfArrow(u,c,h),d=h.x+" "+h.y,v=lre.getAngle(u)+150,p=new eie(l,f,h,c,u,"rotate("+v+" "+d+") translate("+d+")");this.directions.push(p)}}}catch(g){o.e(g)}finally{o.f()}}},{key:"getMiddleOfArrow",value:function(e,t,n){var r=t.getPrevious(e),i=this.getCenterAt(r);return new ire(i.x+(n.x-i.x)/2,i.y+(n.y-i.y)/2)}},{key:"isBoard",value:function(e){return e!==cre.NONE}},{key:"isPiece",value:function(e){return e!==cre.EMPTY}},{key:"secondClick",value:function(e,t){var n=this;return tB(regeneratorRuntime.mark(function r(){var i,a,o,s,u,c,l;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=n.selecteds[0],!(a=new ire(e,t)).equals(i)){r.next=3;break}return r.abrupt("return",(n.cancelMoveAttempt(),K5.SUCCESS));case 3:if(!1!==a.isHexagonallyAlignedWith(i)){r.next=5;break}return r.abrupt("return",(n.cancelMoveAttempt(),n.firstClick(e,t)));case 5:if(!((o=a.getDistance(i))>2)){r.next=8;break}return r.abrupt("return",n.cancelMove(Nre.CANNOT_MOVE_MORE_THAN_THREE_PIECES()));case 8:for(s=i.getDirectionToward(a).get(),n.selecteds=[i],u=0;u<o;u++)n.selecteds.push(i.getNext(s,u+1));if(3!==n.selecteds.length){r.next=15;break}if(c=n.selecteds[1],l=n.rules.node.gameState.getCurrentPlayer(),!1!==n.hexaBoard[c.y][c.x].is(l)){r.next=15;break}return r.abrupt("return",(n.cancelMoveAttempt(),n.firstClick(e,t)));case 15:return r.abrupt("return",(n.showPossibleDirections(),K5.SUCCESS));case 16:case"end":return r.stop()}},r)}))()}},{key:"thirdClick",value:function(e,t){var n=this;return tB(regeneratorRuntime.mark(function r(){var i,a,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=new ire(e,t),a=n.selecteds[0],!i.equals(a)){r.next=3;break}return r.abrupt("return",n.deselectExtremity(!0));case 3:return o=n.selecteds[n.selecteds.length-1],r.abrupt("return",i.equals(o)?n.deselectExtremity(!1):3===n.selecteds.length&&i.equals(n.selecteds[1])?(n.cancelMoveAttempt(),K5.SUCCESS):n.tryExtension(i,a,o));case 5:case"end":return r.stop()}},r)}))()}},{key:"tryExtension",value:function(e,t,n){var r=this;return tB(regeneratorRuntime.mark(function i(){var a,o,s,u,c;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(!(a=nre.factory.fromMove(t,e)).isSuccess()){i.next=6;break}if(o=nre.factory.fromMove(n,e),!a.equals(o)){i.next=6;break}return s=t.getDistance(e),u=n.getDistance(e),i.abrupt("return",2===Math.max(s,u)?(r.selecteds.push(e),ite.sortByDescending(r.selecteds,Sre.sortCoord),r.showPossibleDirections(),K5.SUCCESS):r.cancelMove(Nre.CANNOT_MOVE_MORE_THAN_THREE_PIECES()));case 6:return c=r.cancelMove(Nre.LINE_AND_COORD_NOT_ALIGNED()),i.next=9,r.firstClick(e.x,e.y);case 9:return i.abrupt("return",c);case 10:case"end":return i.stop()}},i)}))()}},{key:"deselectExtremity",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(t.selecteds=t.selecteds.slice(e?1:0,e?void 0:-1),t.showPossibleDirections(),K5.SUCCESS));case 1:case"end":return n.stop()}},n)}))()}},{key:"chooseDirection",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.canUserPlay("#direction_"+e.toString()),n.abrupt("return",r.isFailure()?t.cancelMove(r.getReason()):t._chooseDirection(e));case 2:case"end":return n.stop()}},n)}))()}},{key:"_chooseDirection",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.rules.node.gameState,a=t.selecteds[0],n.abrupt("return",(i=1===t.selecteds.length?Sre.fromSingleCoord(a,e).get():Sre.fromDoubleCoord(a,t.selecteds[t.selecteds.length-1],e).get(),t.chooseMove(i,r,t.scores.get())));case 3:case"end":return n.stop()}},n)}))()}},{key:"onCaseClick",value:function(e,t){var n=this;return tB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=n.canUserPlay("#case_"+e+"_"+t),r.abrupt("return",i.isFailure()?n.cancelMove(i.getReason()):n.tryChoosingDirection(e,t));case 2:case"end":return r.stop()}},r)}))()}},{key:"tryChoosingDirection",value:function(e,t){var n=this;return tB(regeneratorRuntime.mark(function r(){var i,a,o,s;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:i=new ire(e,t),a=Qv(n.directions),r.prev=2,a.s();case 4:if((o=a.n()).done){r.next=10;break}if(!(s=o.value).landing.equals(i)){r.next=8;break}return r.abrupt("return",n._chooseDirection(s.dir));case 8:r.next=4;break;case 10:r.next=15;break;case 12:r.prev=12,r.t0=r.catch(2),a.e(r.t0);case 15:return r.prev=15,a.f(),r.finish(15);case 18:return r.abrupt("return",K5.failure("not a direction"));case 19:case"end":return r.stop()}},r,null,[[2,12,15,18]])}))()}},{key:"getSquareClasses",value:function(e,t){var n=new ire(e,t),r=[];return this.moveds.some(function(e){return e.equals(n)})&&r.push("moved"),r}},{key:"getPieceClasses",value:function(e,t){var n=new ire(e,t),r=ete.of(this.hexaBoard[t][e].value),i=[this.getPlayerClass(r)];return this.selecteds.some(function(e){return e.equals(n)})&&i.push("highlighted"),i}}]),n}(ure);return e.\u0275fac=function(t){return new(t||e)(sb(ore))},e.\u0275cmp=ey({type:e,selectors:[["app-abalone"]],features:[zC],decls:5,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-165 0 470 500","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto",3,"id",4,"ngFor","ngForOf"],[4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass","click"],["class","base",3,"id","ngClass","click",4,"ngIf"],[1,"base",3,"id","ngClass","click"],["markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto",3,"id"],["points","0 0, 10 3.5, 0 7"],[1,"arrow",3,"id"],[1,"arrow",3,"id","click"],["points","-10 -5, 10 -5, 0 15, -10 -5",1,"arrow",3,"id","click"]],template:function(e,t){1&e&&(_m(),lb(0,"svg",0),ab(1,Jre,2,1,"g",1),lb(2,"defs"),ab(3,Qre,2,1,"marker",2),hb(),ab(4,Xre,4,12,"g",1),hb()),2&e&&(Pw(1),ub("ngForOf",t.hexaBoard),Pw(2),ub("ngForOf",t.directions),Pw(1),ub("ngForOf",t.directions))},directives:[AT,NT,IT],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),nie=function(){function e(t){tp(this,e),this.x=t}return rp(e,[{key:"equals",value:function(e){return this.x===e.x}}],[{key:"from",value:function(t){switch(t){case 0:return e.ZERO;case 1:return e.ONE;case 2:return e.TWO;default:return X5(3===t,"Invalid Apagos Coord "+t),e.THREE}}}]),e}();nie.ZERO=new nie(0),nie.ONE=new nie(1),nie.TWO=new nie(2),nie.THREE=new nie(3);var rie=function(){var e=rp(function e(){tp(this,e)});return e.PIECE_SHOULD_MOVE_DOWNWARD=function(){return $localize(j||(j=Rv(["Pieces should only move downward!"])))},e.CANNOT_LAND_ON_A_FULL_SQUARE=function(){return $localize(Z||(Z=Rv(["That square is already full, you cannot put a piece in it!"])))},e.NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE=function(){return $localize(Y||(Y=Rv(["You have no pieces in that square, select one that contains at least one of your pieces!"])))},e.NO_PIECE_REMAINING_TO_DROP=function(){return $localize(K||(K=Rv(["There are no remaining pieces of that color to drop!"])))},e.NO_POSSIBLE_TRANSFER_REMAINS=function(){return $localize(J||(J=Rv(["There is no possible transfer from that square!"])))},e}(),iie=function(e){Gv(n,e);var t=$v(n);function n(e,r,i){var a;return tp(this,n),(a=t.call(this)).landing=e,a.piece=r,a.starting=i,a}return rp(n,[{key:"isDrop",value:function(){return this.piece.isPresent()}},{key:"toString",value:function(){return this.isDrop()?"ApagosMove.drop("+this.piece.get().toString()+" on "+this.landing.x+")":"ApagosMove.slideDown("+this.starting.get().x+" > "+this.landing.x+")"}},{key:"equals",value:function(e){return!1!==this.starting.equals(e.starting)&&!1!==this.landing.equals(e.landing)&&this.piece.equals(e.piece)}}],[{key:"drop",value:function(e,t){return nB.getNonNullable(n.ALL_MOVES.find(function(n){return n.landing.equals(e)&&n.piece.equalsValue(t)&&n.starting.equals(sB.empty())}))}},{key:"transfer",value:function(e,t){if(e.x<=t.x)return j5.failure(rie.PIECE_SHOULD_MOVE_DOWNWARD());var r=nB.getNonNullable(n.ALL_MOVES.find(function(n){return n.landing.equals(t)&&n.piece.equals(sB.empty())&&n.starting.equals(sB.of(e))}));return j5.success(r)}}]),n}(bre);iie.ALL_MOVES=[new iie(nie.ZERO,sB.of(ete.ZERO),sB.empty()),new iie(nie.ONE,sB.of(ete.ZERO),sB.empty()),new iie(nie.TWO,sB.of(ete.ZERO),sB.empty()),new iie(nie.THREE,sB.of(ete.ZERO),sB.empty()),new iie(nie.ZERO,sB.of(ete.ONE),sB.empty()),new iie(nie.ONE,sB.of(ete.ONE),sB.empty()),new iie(nie.TWO,sB.of(ete.ONE),sB.empty()),new iie(nie.THREE,sB.of(ete.ONE),sB.empty()),new iie(nie.TWO,sB.empty(),sB.of(nie.THREE)),new iie(nie.ONE,sB.empty(),sB.of(nie.THREE)),new iie(nie.ZERO,sB.empty(),sB.of(nie.THREE)),new iie(nie.ONE,sB.empty(),sB.of(nie.TWO)),new iie(nie.ZERO,sB.empty(),sB.of(nie.TWO)),new iie(nie.ZERO,sB.empty(),sB.of(nie.ONE))],iie.encoder=new(function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"maxValue",value:function(){return iie.ALL_MOVES.length}},{key:"encodeNumber",value:function(e){var t=iie.ALL_MOVES.findIndex(function(t){return t.equals(e)});return X5(t>=0,e.toString()+" is not part of possibles moves of Apagos!"),t}},{key:"decodeNumber",value:function(e){return X5(e<iie.ALL_MOVES.length,e+" is not a valid encoded number for ApagosMove decoder"),iie.ALL_MOVES[e]}}]),n}(Jee));var aie=function(){function e(t){tp(this,e),this.containing=t}return rp(e,[{key:"isFull",value:function(){return this.count(ete.ZERO)+this.count(ete.ONE)>=this.count(Xee.NONE)}},{key:"count",value:function(e){return this.containing.get(e).get()}},{key:"addPiece",value:function(t){var n=this.count(ete.ZERO),r=this.count(ete.ONE),i=this.count(Xee.NONE);return t===ete.ZERO?n++:r++,e.from(n,r,i).get()}},{key:"substractPiece",value:function(t){var n=this.count(ete.ZERO),r=this.count(ete.ONE),i=this.count(Xee.NONE);return t===ete.ZERO?n--:r--,e.from(n,r,i).get()}},{key:"getDominatingPlayer",value:function(){var e=this.count(ete.ZERO),t=this.count(ete.ONE);return e>t?ete.ZERO:t>e?ete.ONE:Xee.NONE}},{key:"equals",value:function(e){return this.containing.equals(e.containing)}}],[{key:"from",value:function(t,n,r){if(t+n>r)return j5.failure("invalid starting space");var i=new Ore;i.set(ete.ZERO,t),i.set(ete.ONE,n),i.set(Xee.NONE,r),i.makeImmutable();var a=new e(i);return j5.success(a)}}]),e}(),oie=function(){var e=function(e){Gv(n,e);var t=$v(n);function n(e,r,i){var a;return tp(this,n),(a=t.call(this,e)).board=r,a.remaining=i,a.remaining.makeImmutable(),a}return rp(n,[{key:"getPieceAt",value:function(e){return this.board[e.x]}},{key:"updateAt",value:function(e,t){for(var r=[],i=0;i<4;i++)r.push(e.x===i?t:this.board[i]);var a=this.getRemainingCopy();return new n(this.turn,r,a)}},{key:"getRemainingCopy",value:function(){return this.remaining.getCopy()}},{key:"getRemaining",value:function(e){return this.remaining.get(e).get()}},{key:"equals",value:function(e){return this.turn===e.turn&&ite.compareArray(e.board,this.board)&&this.remaining.equals(e.remaining)}}],[{key:"getInitialState",value:function(){return n.fromRepresentation(0,[[0,0,0,0],[0,0,0,0],[7,5,3,1]],this.PIECES_PER_PLAYER,this.PIECES_PER_PLAYER)}},{key:"fromRepresentation",value:function(e,t,r,i){for(var a=[],o=0;o<4;o++){var s=aie.from(t[0][o],t[1][o],t[2][o]).get();a.push(s)}var u=new Ore;return u.set(ete.ZERO,r),u.set(ete.ONE,i),new n(e,a,u)}}]),n}(_re);return e.PIECES_PER_PLAYER=10,e}(),sie=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"applyLegalMove",value:function(e,t,n){return e.isDrop()?this.applyLegalDrop(e,t):this.applyLegalTransfer(e,t)}},{key:"applyLegalDrop",value:function(e,t){var n=t.getRemainingCopy(),r=n.get(e.piece.get()).get();n.put(e.piece.get(),r-1);var i=new oie(t.turn+1,t.board,n),a=e.piece.get(),o=i.getPieceAt(e.landing).addPiece(a);if(e.landing===nie.THREE)return i.updateAt(e.landing,o);var s=nie.from(e.landing.x+1),u=i.getPieceAt(s);return i.updateAt(e.landing,u).updateAt(s,o)}},{key:"applyLegalTransfer",value:function(e,t){var n=t.getCurrentPlayer(),r=e.starting.get(),i=t.getPieceAt(r).substractPiece(n),a=t.getPieceAt(e.landing).addPiece(n),o=t.updateAt(r,i);return o=o.updateAt(e.landing,a),new oie(o.turn+1,o.board,o.remaining)}},{key:"isLegal",value:function(e,t){return t.getPieceAt(e.landing).isFull()?j5.failure(rie.CANNOT_LAND_ON_A_FULL_SQUARE()):e.isDrop()?this.isLegalDrop(e,t):this.isLegalSlideDown(e,t)}},{key:"isLegalDrop",value:function(e,t){return t.getRemaining(e.piece.get())<=0?j5.failure(rie.NO_PIECE_REMAINING_TO_DROP()):j5.success(void 0)}},{key:"isLegalSlideDown",value:function(e,t){var n=t.getCurrentPlayer();return 0===t.getPieceAt(e.starting.get()).count(n)?j5.failure(rie.NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE()):j5.success(void 0)}},{key:"getGameStatus",value:function(e){for(var t=e.gameState,n=0;n<4;n++)if(!1===t.getPieceAt(nie.from(n)).isFull())return Are.ONGOING;var r=t.getPieceAt(nie.THREE).getDominatingPlayer();return X5(r.isPlayer(),"winner can only be a player if the game is finished"),Are.getVictory(r)}}],[{key:"get",value:function(){return n.singleton.isAbsent()&&(n.singleton=sB.of(new n(oie))),this.singleton.get()}}]),n}(Rre);sie.singleton=sB.empty();var uie=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"getListMoves",value:function(e){var t=e.gameState;return iie.ALL_MOVES.filter(function(e){return sie.get().isLegal(e,t).isSuccess()})}},{key:"getBoardValue",value:function(e){var t=sie.get().getGameStatus(e);if(t.isEndGame)return yre.fromWinner(t.winner);var n=e.gameState.board[3].getDominatingPlayer();return n.isPlayer()?new yre(n.getScoreModifier()):new yre(0)}}]),n}(gre),cie=rp(function e(){tp(this,e),this.tutorial=[Lre.informational($localize(Q||(Q=Rv(["Initial board and goal of the game"]))),$localize(X||(X=Rv(["At Apagos, there are 4 squares, each of them has a fixed number of holes for pieces. Each player starts with 10 pieces. Dark pieces belong to the first player, light pieces belong to the second one. The game ends when no one can play. The player owning the most pieces in the rightmost square wins!"]))),oie.getInitialState()),Lre.anyMove($localize(ee||(ee=Rv(["Drop"]))),$localize(te||(te=Rv(["There are two kind of moves. One is the drop. To do one, you must click on a visible arrow, being of your color or the opponent's. If the chosen square is one of the 3 leftmost ones, it will exchange position with the square on its right. You play Light.<br/><br/>Drop a piece on one of those three squares."]))),oie.fromRepresentation(1,[[0,0,0,1],[0,0,0,0],[7,5,3,1]],9,10),iie.drop(nie.ZERO,ete.ZERO),$localize(ne||(ne=Rv(["Congratulations!"])))),Lre.fromPredicate($localize(re||(re=Rv(["Transfer"]))),$localize(ie||(ie=Rv(["The other kind of move is the transfer.<ol><li>Choose one of your pieces on the board by clicking on the square in which it is.</li><li>Choose its landing square by clicking on one of the arrow to finish the transfer.</li></ol>It can only be done with your pieces, from an higher square to a lower one.<br/><br/>You're playing Dark, do a transfer!"]))),oie.fromRepresentation(2,[[0,0,1,0],[0,1,0,0],[7,5,3,1]],9,9),iie.transfer(nie.TWO,nie.ZERO).get(),function(e,t){return e.isDrop()?K5.failure($localize(ae||(ae=Rv(["This move is a drop, please do a transfer!"])))):K5.SUCCESS},$localize(oe||(oe=Rv(["Congratulations!"])))),Lre.fromPredicate($localize(se||(se=Rv(["Victory"]))),$localize(ue||(ue=Rv(["When you put a last piece into a square, the games end. In this configuration you can win.<br/><br/>You're playing Light, do the winning move!"]))),oie.fromRepresentation(2,[[1,0,3,4],[2,1,3,1],[3,1,7,5]],2,3),iie.drop(nie.TWO,ete.ONE),function(e,t){return e.isDrop()?e.piece.equalsValue(ete.ONE)?K5.SUCCESS:K5.failure($localize(ce||(ce=Rv(["You actively made your opponent win!"])))):K5.failure($localize(le||(le=Rv(["Wrong choice, your opponent will win in the next turn no matter which piece is dropped!"]))))},$localize(he||(he=Rv(["Congratulations!"]))))]});function lie(e,t){if(1&e&&(_m(),fb(0,"circle",5)),2&e){var n=t.$implicit,r=wb();tb("cx",(n+1)*r.PIECE_RADIUS)("cy",r.PIECE_RADIUS)("r",r.PIECE_RADIUS-5)}}function hie(e,t){if(1&e){var n=pb();_m(),lb(0,"polygon",7),mb("click",function(){$y(n);var e=wb().index,t=wb();return t.onArrowClick(e,t.PlayerOrNone.ZERO)}),hb()}if(2&e){var r=wb().index,i=wb();Cb("id","dropArrow_zero_",r,""),ub("ngClass",i.getArrowClasses(r,i.PlayerOrNone.ZERO)),tb("points",i.ARROW_COORD)("transform",i.getArrowTransform(r,i.PlayerOrNone.ZERO))}}function fie(e,t){if(1&e){var n=pb();_m(),lb(0,"polygon",7),mb("click",function(){$y(n);var e=wb().index,t=wb();return t.onArrowClick(e,t.PlayerOrNone.ONE)}),hb()}if(2&e){var r=wb().index,i=wb();Cb("id","dropArrow_one_",r,""),ub("ngClass",i.getArrowClasses(r,i.PlayerOrNone.ONE)),tb("points",i.ARROW_COORD)("transform",i.getArrowTransform(r,i.PlayerOrNone.ONE))}}function die(e,t){if(1&e){var n=pb();_m(),db(0),lb(1,"circle",8),mb("click",function(){$y(n);var e=wb().index;return wb().onSquareClick(e)}),hb(),vb()}if(2&e){var r=t.$implicit,i=wb(),a=i.index,o=i.$implicit,s=wb();Pw(1),Eb("id","square_",a,"_piece_",r,"_out_of_",o.count(s.PlayerOrNone.NONE),""),ub("ngClass",s.getPieceClasses(a,r,o)),tb("cx",s.getCircleCenter(a,r,o).x)("cy",s.getCircleCenter(a,r,o).y)}}function vie(e,t){if(1&e){var n=pb();_m(),db(0),ab(1,hie,1,4,"polygon",6),ab(2,fie,1,4,"polygon",6),lb(3,"rect",7),mb("click",function(){var e=$y(n).index;return wb().onSquareClick(e)}),hb(),ab(4,die,2,6,"ng-container",3),vb()}if(2&e){var r=t.$implicit,i=t.index,a=wb();Pw(1),ub("ngIf",a.canDisplayArrow(i,a.PlayerOrNone.ZERO)),Pw(1),ub("ngIf",a.canDisplayArrow(i,a.PlayerOrNone.ONE)),Pw(1),Cb("id","square_",i,""),ub("ngClass",a.getSquareClasses(i)),tb("x",i*a.SPACE_SIZE)("y",(5-i)*a.SPACE_SIZE*.25)("width",a.SPACE_SIZE)("height",a.SPACE_SIZE),Pw(1),ub("ngForOf",a.range(r.count(a.PlayerOrNone.NONE)))}}function pie(e,t){if(1&e&&(_m(),fb(0,"circle",9)),2&e){var n=t.$implicit,r=wb();tb("cx",4*r.SPACE_SIZE-(n+1)*r.PIECE_RADIUS)("cy",2.25*r.SPACE_SIZE+3*r.PIECE_RADIUS)("r",r.PIECE_RADIUS-5)}}var gie=function(){var e=function(e){Gv(n,e);var t=$v(n);function n(e){var r;return tp(this,n),(r=t.call(this,e)).PlayerOrNone=Xee,r.ARROW_COORD=n.getArrowCoord(),r.PIECES_PER_PLAYER=oie.PIECES_PER_PLAYER,r.selectedPiece=sB.empty(),r.leftPiece=sB.empty(),r.droppedPiece=sB.empty(),r.displayableArrow=[],r.rules=new sie(oie),r.availableMinimaxes=[new uie(r.rules,"ApagosDummyMinimax")],r.encoder=iie.encoder,r.tutorial=(new cie).tutorial,r.PIECE_RADIUS=200/(r.PIECES_PER_PLAYER+1),r.updateBoard(),r}return rp(n,[{key:"cancelMoveAttempt",value:function(){this.selectedPiece=sB.empty(),this.showPossibleDrops()}},{key:"updateBoard",value:function(){var e=this.rules.node.gameState;this.board=e.board,this.remainingZero=e.remaining.get(ete.ZERO).get(),this.remainingOne=e.remaining.get(ete.ONE).get(),this.hideLastMove(),this.rules.node.move.isPresent()&&this.showLastMove(),this.showPossibleDrops()}},{key:"hideLastMove",value:function(){this.movedSquare=[],this.droppedPiece=sB.empty(),this.leftPiece=sB.empty(),this.selectedPiece=sB.empty()}},{key:"showLastMove",value:function(){var e=this.rules.node.move.get();e.isDrop()?this.showLastDrop(e):this.showLastTransfer(e)}},{key:"showLastDrop",value:function(e){var t=e.piece.get(),n=e.landing.x;this.movedSquare=[n],3!==e.landing.x&&(n+=1,this.movedSquare.push(n));var r=this.getLowestPlayerPiece(this.board[n],t);this.droppedPiece=sB.of({square:n,piece:r})}},{key:"getLowestPlayerPiece",value:function(e,t){var n=e.count(t);return t===ete.ZERO?n-1:e.count(Xee.NONE)-n}},{key:"showLastTransfer",value:function(e){var t=this.rules.node.mother.get().gameState,n=t.getCurrentPlayer(),r=e.starting.get().x,i=this.getLowestPlayerPiece(t.board[r],n);this.leftPiece=sB.of({square:r,piece:i});var a=e.landing.x,o=this.getLowestPlayerPiece(this.board[a],n);this.droppedPiece=sB.of({square:a,piece:o})}},{key:"showPossibleDrops",value:function(){this.displayableArrow=[];for(var e=this.rules.node.gameState,t=0;t<4;t++)!1===e.board[t].isFull()&&(e.remaining.get(ete.ZERO).get()>0&&this.displayableArrow.push({x:t,player:ete.ZERO}),e.remaining.get(ete.ONE).get()>0&&this.displayableArrow.push({x:t,player:ete.ONE}))}},{key:"getCircleCenter",value:function(e,t,n){var r=e*this.SPACE_SIZE+.5*this.SPACE_SIZE,i=(5-e)*this.SPACE_SIZE*.25+.5*this.SPACE_SIZE;if(1===n.count(Xee.NONE))return new ire(r,i);var a=n.count(Xee.NONE),o=2*t*Math.PI/a-Math.PI/2,s=.3*this.SPACE_SIZE,u=s*Math.cos(o),c=s*Math.sin(o);return new ire(r+u,i+c)}},{key:"canDisplayArrow",value:function(e,t){return this.displayableArrow.some(function(n){return n.x===e&&n.player.equals(t)})}},{key:"getArrowClasses",value:function(e,t){return[this.getPlayerClass(t)]}},{key:"getArrowTransform",value:function(e,t){var n=t===ete.ZERO?0:.5*this.SPACE_SIZE;return"translate("+(n+=e*this.SPACE_SIZE)+", "+(3-e)*this.SPACE_SIZE*.25+")"}},{key:"getSquareClasses",value:function(e){var t=["base"];return this.selectedPiece.isPresent()&&this.selectedPiece.get().square===e?t.push("selected"):this.movedSquare.includes(e)&&t.push("last-move"),t}},{key:"onArrowClick",value:function(e,t){var n=this;return tB(regeneratorRuntime.mark(function r(){var i,a,o,s;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#dropArrow_"+(t===ete.ZERO?"zero":"one")+"_"+e)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:return a=nie.from(e),n.selectedPiece.isPresent()?(s=n.selectedPiece.get().square,o=iie.transfer(nie.from(s),a).get()):o=iie.drop(a,t),r.abrupt("return",n.chooseMove(o,n.rules.node.gameState));case 6:case"end":return r.stop()}},r)}))()}},{key:"getPieceClasses",value:function(e,t,n){var r={square:e,piece:t},i=[],a=n.count(ete.ZERO),o=n.count(ete.ONE);if(this.selectedPiece.equalsValue(r))i.push("selected");else if(this.droppedPiece.equalsValue(r))i.push("last-move");else if(this.leftPiece.isPresent()&&this.leftPiece.get().square===e){if(this.leftPiece.get().piece===t)return i.push("captured-stroke"),i;this.rules.node.gameState.getCurrentOpponent()===ete.ZERO?a++:o++}var s=n.count(Xee.NONE)-(o+a),u=this.getPieceColor(t,a,s);return""!==u&&i.push(u),i}},{key:"getPieceColor",value:function(e,t,n){return e<t?"player0":e>=t+n?"player1":""}},{key:"onSquareClick",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#square_"+e)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:if(!t.selectedPiece.isPresent()||t.selectedPiece.get().square!==e){n.next=5;break}return n.abrupt("return",(t.cancelMoveAttempt(),K5.SUCCESS));case 5:return i=t.rules.node.gameState.getCurrentPlayer(),a=t.board[e],n.abrupt("return",a.count(i)<=0?t.cancelMove(rie.NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE()):(t.selectedPiece=sB.of({square:e,piece:t.getLowestPlayerPiece(a,i)}),0===t.showAndGetPossibleTranfers().length?t.cancelMove(rie.NO_POSSIBLE_TRANSFER_REMAINS()):K5.SUCCESS));case 7:case"end":return n.stop()}},n)}))()}},{key:"showAndGetPossibleTranfers",value:function(){this.displayableArrow=[];for(var e=this.selectedPiece.get().square-1,t=this.rules.node.gameState.getCurrentPlayer();0<=e;)!1===this.board[e].isFull()&&this.displayableArrow.push({x:e,player:t}),e--;return this.displayableArrow}}],[{key:"getArrowCoord",value:function(){return"12.5,0 37.5,0 37.5,25 50,25 25,50 0,25 12.5,25"}}]),n}(sre);return e.\u0275fac=function(t){return new(t||e)(sb(ore))},e.\u0275cmp=ey({type:e,selectors:[["app-apagos"]],features:[zC],decls:5,vars:4,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-8 -8 416 350","preserveAspectRatio","xMidYMid meet"],["class","base mid-stroke player0",4,"ngFor","ngForOf"],["id","board"],[4,"ngFor","ngForOf"],["class","base mid-stroke player1",4,"ngFor","ngForOf"],[1,"base","mid-stroke","player0"],["class","base mid-stroke",3,"id","ngClass","click",4,"ngIf"],[1,"base","mid-stroke",3,"id","ngClass","click"],["r","10",1,"base","mid-stroke",3,"id","ngClass","click"],[1,"base","mid-stroke","player1"]],template:function(e,t){1&e&&(_m(),lb(0,"svg",0),ab(1,lie,1,3,"circle",1),lb(2,"g",2),ab(3,vie,5,9,"ng-container",3),hb(),ab(4,pie,1,3,"circle",4),hb()),2&e&&(Pw(1),ub("ngForOf",t.range(t.remainingZero)),Pw(1),tb("transform","translate(0, "+2*t.PIECE_RADIUS+")"),Pw(1),ub("ngForOf",t.board),Pw(1),ub("ngForOf",t.range(t.remainingOne)))},directives:[AT,NT,IT],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),yie=function(){var e,t=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n)}(sre);return t.\u0275fac=function(n){return(e||(e=tk(t)))(n||t)},t.\u0275cmp=ey({type:t,selectors:[["ng-component"]],features:[zC],decls:0,vars:0,template:function(e,t){},encapsulation:2}),t}(),mie=function(e){Gv(n,e);var t=$v(n);function n(e,r,i){var a;return tp(this,n),(a=t.call(this,e,r)).captured=i,a}return rp(n,[{key:"getCapturedCopy",value:function(){return[this.captured[0],this.captured[1]]}}],[{key:"getInitialState",value:function(){return new n(ite.createTable(6,2,4),0,[0,0])}}]),n}(wre),kie=function(){var e=rp(function e(){tp(this,e)});return e.CANNOT_DISTRIBUTE_FROM_OPPONENT_HOME=function(){return $localize(fe||(fe=Rv(["You cannot distribute from the opponent's home."])))},e.MUST_CHOOSE_NONEMPTY_HOUSE=function(){return $localize(de||(de=Rv(["You should choose a non-empty house to distribute."])))},e.SHOULD_DISTRIBUTE=function(){return $localize(ve||(ve=Rv(["You should distribute but you do not."])))},e}(),_ie=function(){var e=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"applyLegalMove",value:function(e,t,r){rB(n.VERBOSE,{called:"AwaleRules.applyLegalMove",move:e,state:t});var i=e.x,a=t.getCurrentPlayer().value,o=t.getCurrentPlayer().getOpponent().value,s=t.getCopiedBoard(),u=n.distribute(i,a,s);if(u.y===a)return new mie(s,t.turn+1,t.captured);var c=[0,0],l=ite.copyBiArray(s);return c[a]=n.capture(u.x,o,a,s),c[a]>0&&n.isStarving(o,s)&&(s=l,c=[0,0]),n.isStarving(a,s)&&!1===n.canDistribute(o,s)&&(c[o]+=n.mansoon(o,s)),c[0]+=t.captured[0],c[1]+=t.captured[1],new mie(s,t.turn+1,c)}},{key:"isLegal",value:function(e,t){return n.isLegal(e,t)}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"mansoon",value:function(e,t){var n=0,r=0;do{n+=t[e][r],t[e][r]=0,r++}while(r<6);return n}},{key:"isLegal",value:function(e,t){var r=t.getCurrentPlayer().value,i=t.getCurrentPlayer().getOpponent().value,a=e.x;if(0===t.getPieceAtXY(a,r))return j5.failure(kie.MUST_CHOOSE_NONEMPTY_HOUSE());var o=n.isStarving(i,t.board),s=!1===n.doesDistribute(a,r,t.board);return o&&s?j5.failure(kie.SHOULD_DISTRIBUTE()):j5.success(void 0)}},{key:"doesDistribute",value:function(e,t,n){return 0===t?n[t][e]>5-e:n[t][e]>e}},{key:"canDistribute",value:function(e,t){for(var r=0;r<6;r++)if(n.doesDistribute(r++,e,t))return!0;return!1}},{key:"isStarving",value:function(e,t){var n=0;do{if(t[e][n++]>0)return!1}while(n<6);return!0}},{key:"distribute",value:function(e,t,n){var r=e,i=t,a=n[t][e];for(n[t][e]=0;a>0;)0===t?5===e?t=1:e++:0===e?t=0:e--,(e!==r||t!==i)&&(n[t][e]+=1,a--);return new ire(e,t)}},{key:"capture",value:function(e,t,n,r){X5(t!==n,"AwaleRules.capture called with wrong values of x and player");var i=r[t][e];if(i<2||i>3)return 0;var a=0,o=-1,s=-1;0===n&&(o=1,s=6);do{a+=i,r[t][e]=0,i=r[t][e+=o]}while(e!==s&&(2===i||3===i));return a}},{key:"getGameStatus",value:function(e){var t=e.gameState;return t.captured[0]>24?Are.ZERO_WON:t.captured[1]>24?Are.ONE_WON:24===t.captured[0]&&24===t.captured[1]?Are.DRAW:Are.ONGOING}}]),n}(Rre);return e.VERBOSE=!1,e}(),wie=function(e){Gv(n,e);var t=$v(n);function n(e){var r;return tp(this,n),(r=t.call(this)).x=e,r}return rp(n,[{key:"equals",value:function(e){return e===this||e.x===this.x}},{key:"toString",value:function(){return"AwaleMove("+this.x+")"}}],[{key:"from",value:function(e){switch(e){case 0:return n.ZERO;case 1:return n.ONE;case 2:return n.TWO;case 3:return n.THREE;case 4:return n.FOUR;default:return X5(5===e,"Invalid x for AwaleMove: "+e),n.FIVE}}}]),n}(bre);wie.ZERO=new wie(0),wie.ONE=new wie(1),wie.TWO=new wie(2),wie.THREE=new wie(3),wie.FOUR=new wie(4),wie.FIVE=new wie(5),wie.encoder=new(function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"maxValue",value:function(){return 5}},{key:"encodeNumber",value:function(e){return e.x}},{key:"decodeNumber",value:function(e){return wie.from(e)}}]),n}(Jee));var Cie=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"getListMoves",value:function(e){var t,n=[],r=e.gameState,i=r.turn%2,a=0;do{0!==r.getPieceAtXY(a,i)&&(t=wie.from(a),_ie.isLegal(t,r).isSuccess()&&(t=wie.from(a),n.push(t))),a++}while(a<6);return this.orderMoves(e,n)}},{key:"orderMoves",value:function(e,t){var n=e.gameState.getCurrentPlayer().value,r=e.gameState.getCurrentPlayer().getOpponent().value;return ite.sortByDescending(t,function(t){var i,a=e.gameState.getCopiedBoard(),o=a[n][t.x],s=_ie.distribute(t.x,n,a),u=0;return s.y===n?(i=0,o<=6&&(u=10)):i=_ie.capture(s.x,r,n,a),100*i+u-o}),t}},{key:"getBoardValue",value:function(e){var t=_ie.getGameStatus(e);if(t.isEndGame)return yre.fromWinner(t.winner);var n=e.gameState.getCapturedCopy();return new yre(n[1]-n[0])}}]),n}(gre),bie=rp(function e(){tp(this,e),this.tutorial=[Lre.anyMove($localize(pe||(pe=Rv(["Sowing"]))),$localize(ge||(ge=Rv(["Awal\xe9 is a game of distribution (sowing) and capture. Its goal is to capture the most seeds.\n         Let's see how seeds are sown.\n         As you're playing first, the 6 houses on the top are yours.<br/><br>\n         Click on any of them to sow the seeds it contains: they will be sown clockwise, one seed per house."]))),mie.getInitialState(),wie.ZERO,$localize(ye||(ye=Rv(["Look at the 4 houses that follow clockwise the one you picked, they now contain 5 seeds.\n        This is how seeds are sown:\n        one by one from the house next to the one they come from, clockwise."])))),Lre.anyMove($localize(me||(me=Rv(["Big sowing"]))),$localize(ke||(ke=Rv(["You are now the second player (on the bottom).\n        When there are enough seeds to make a full turn, something else happens.<br/><br/>\n        Sow the house that contains 12 seeds."]))),new mie([[0,0,0,0,0,0],[0,12,0,0,0,0]],1,[0,0]),wie.ONE,$localize(_e||(_e=Rv(["See, the house that you sowed has not been refilled, and the sowing immediately continued to the next house (which therefore contains two seeds)."])))),Lre.fromMove($localize(we||(we=Rv(["Simple capture"]))),$localize(Ce||(Ce=Rv(["After sowing, if the last seed falls in an opponent's house and if there is now two or three seeds in this house, the player captures these two or three seeds.\n         Then, the player looks at the preceding house:\n         if it is still in the opponent's side and contains two or three seeds, they are also captured.\n         This continues until we reach either the player's side or a house containing neither two nor three seeds.<br/><br/>\n         You are the second player, try to capture some pieces!"]))),new mie([[1,0,0,0,1,0],[1,0,0,0,1,0]],1,[0,0]),[wie.ZERO],$localize(be||(be=Rv(["Well done! This was a simple capture, now let us see how to make multiple captures."]))),$localize(Ee||(Ee=Rv(["Failed. Try again and sow from the leftmost house."])))),Lre.fromMove($localize(Se||(Se=Rv(["Multiple captures"]))),$localize(Pe||(Pe=Rv(["By sowing from your leftmost house, you will change the number of seeds in a house from 2 to 3, and from the preceding house from 1 to 2.\n        As these are consecutive houses, all seeds in them will be captured.<br/><br/>\n        Capture them."]))),new mie([[2,1,0,0,1,0],[2,0,0,0,1,0]],1,[0,0]),[wie.ZERO],$localize(Oe||(Oe=Rv(["Nice, you win 3 points from the first house, and 2 from the second!"]))),$localize(Te||(Te=Rv(["Failed. Try again."])))),Lre.fromMove($localize(Ie||(Ie=Rv(["Interrupted capture"]))),$localize(xe||(xe=Rv(["By clicking on your leftmost house, you end up on the 3rd house, which is capturable.<br/><br/>\n        Do it."]))),new mie([[1,0,1,0,0,1],[3,0,0,0,1,0]],1,[0,0]),[wie.ZERO],$localize(Ae||(Ae=Rv(["Notice that because the second house was not capturable, the captured was interrupted and you have not captured the first house."]))),$localize(Re||(Re=Rv(["Failed. Try again."])))),Lre.fromMove($localize(Ne||(Ne=Rv(["Capture on the other side only"]))),$localize(Me||(Me=Rv(["Try to capture the two leftmost houses of the opponent."]))),new mie([[2,2,0,0,1,0],[1,3,0,0,0,0]],1,[0,0]),[wie.ONE],$localize(De||(De=Rv(["Congratulations! Notice that the capture was interrupted when entering your territory: you cannot capture your own houses!"]))),$localize(Le||(Le=Rv(["You have only captured one house, try again!"])))),Lre.fromMove($localize(Fe||(Fe=Rv(["Do not starve"]))),$localize(Be||(Be=Rv(["You have a very nice capture that seems possible: it seems that you can capture all the opponent's seeds!<br/><br/>\n        Try it."]))),new mie([[1,1,1,1,1,0],[5,0,0,1,0,0]],1,[0,0]),[wie.ZERO],$localize(Ve||(Ve=Rv(["Sadly, you cannot capture here, otherwise the opponent could not play after you.\n        When this happens, the move can be made, but no capture takes place!"]))),$localize(Ue||(Ue=Rv(["Failed. Try again."])))),Lre.anyMove($localize(ze||(ze=Rv(["Feeding is mandatory"]))),$localize(He||(He=Rv(["You cannot let another player starve, meaning that if your opponent has no seeds anymore and if you can give them at least one, you have to do it.<br/><br/>\n        Go ahead!"]))),new mie([[0,0,0,0,0,0],[0,1,2,4,4,5]],1,[0,0]),wie.THREE,$localize(Ge||(Ge=Rv(["Congratulations! Note that you can choose to give your opponent the least number of seeds if it is better for you.\n        It is often a good way to have easy captures!"])))),Lre.anyMove($localize(qe||(qe=Rv(["End of the game"]))),$localize($e||($e=Rv(["A game is won as soon as one player has captured 25 seeds, as that player has more than half of all the seeds.<br/><br/>\n         Sow the house on the top right."]))),new mie([[0,0,0,0,0,1],[0,1,2,3,4,4]],0,[0,0]),wie.FIVE,$localize(We||(We=Rv(["Also, as soon as on player cannot play, the other player captures all the seeds in its own side.\n         Here, it was the first player's turn, and the second player has taken all the remaining seeds."]))))]});function Eie(e,t){if(1&e){var n=pb();_m(),lb(0,"g"),lb(1,"circle",4),mb("click",function(){var e=$y(n).index,t=wb().index;return wb().onClick(e,t)}),hb(),lb(2,"text",5),mb("click",function(){var e=$y(n).index,t=wb().index;return wb().onClick(e,t)}),Rb(3),hb(),hb()}if(2&e){var r=t.$implicit,i=t.index,a=wb().index,o=wb();Pw(1),bb("id","click_",i,"_",a,""),ub("ngClass",o.getSquareClasses(i,a)),tb("cx",50+100*i)("cy",50+120*a),Pw(1),tb("x",50+100*i)("y",66+120*a),Pw(1),Mb(" ",r," ")}}function Sie(e,t){if(1&e&&(_m(),lb(0,"g"),ab(1,Eie,4,8,"g",2),hb()),2&e){var n=t.$implicit;Pw(1),ub("ngForOf",n)}}var Pie=function(){var e=function(e){Gv(n,e);var t=$v(n);function n(e){var r;return tp(this,n),(r=t.call(this,e)).last=sB.empty(),r.captured=[],r.moved=[],r.scores=sB.of([0,0]),r.rules=new _ie(mie),r.availableMinimaxes=[new Cie(r.rules,"AwaleMinimax")],r.encoder=wie.encoder,r.tutorial=(new bie).tutorial,r.updateBoard(),r}return rp(n,[{key:"updateBoard",value:function(){var e=this.rules.node.gameState;this.scores=sB.of(e.getCapturedCopy()),this.hidePreviousMove();var t=this.rules.node.move;if(this.board=e.getCopiedBoard(),t.isPresent()){var n=e.getCurrentOpponent().value;this.last=sB.of(new ire(t.get().x,n)),this.showPreviousMove()}else this.last=sB.empty()}},{key:"hidePreviousMove",value:function(){this.captured=[],this.moved=[]}},{key:"showPreviousMove",value:function(){for(var e=this.rules.node.mother.get().gameState,t=0;t<=1;t++)for(var n=0;n<=5;n++){var r=new ire(n,t),i=this.board[t][n],a=e.getPieceAt(r);this.last.equalsValue(r)||(i<a?this.captured.push(r):i>a&&this.moved.push(r))}}},{key:"onClick",value:function(e,t){var n=this;return tB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:if(t===n.rules.node.gameState.getCurrentPlayer().value){r.next=5;break}return r.abrupt("return",n.cancelMove(kie.CANNOT_DISTRIBUTE_FROM_OPPONENT_HOME()));case 5:return n.last=sB.empty(),a=wie.from(e),r.abrupt("return",n.chooseMove(a,n.rules.node.gameState,n.scores.get()));case 8:case"end":return r.stop()}},r)}))()}},{key:"getSquareClasses",value:function(e,t){var n=new ire(e,t);return this.captured.some(function(e){return e.equals(n)})?["captured"]:this.last.equalsValue(n)?["moved","highlighted"]:this.moved.some(function(e){return e.equals(n)})?["moved"]:[]}}]),n}(yie);return e.\u0275fac=function(t){return new(t||e)(sb(ore))},e.\u0275cmp=ey({type:e,selectors:[["app-awale-component"]],features:[zC],decls:4,vars:1,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-45 -20 700 260","preserveAspectRatio","xMidYMid meet"],["x","-40","y","-15","ry","115","rx","115","width","680","height","250","fill","blue",1,"base"],[4,"ngFor","ngForOf"],["x1","-40","y1","110","x2","640","y2","110",1,"base"],["r","46",1,"base",3,"id","ngClass","click"],[1,"text-big","text-center",3,"click"]],template:function(e,t){1&e&&(_m(),lb(0,"svg",0),fb(1,"rect",1),ab(2,Sie,2,1,"g",2),fb(3,"line",3),hb()),2&e&&(Pw(2),ub("ngForOf",t.board))},directives:[AT,IT],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Oie=function(e){Gv(n,e);var t=$v(n);function n(e,r){var i;if(tp(this,n),i=t.call(this,e.x,e.y),e.equals(r))throw new Error(pre.MOVE_CANNOT_BE_STATIC());return i.end=r,Wv(i)}return rp(n,[{key:"length",value:function(){return this.coord.getDistance(this.end)}},{key:"getDirection",value:function(){return nre.factory.fromMove(this.coord,this.end)}}],[{key:"getEncoder",value:function(e,t,n){return new(function(r){Gv(a,r);var i=$v(a);function a(){var n;return tp(this,a),(n=i.apply(this,arguments)).shiftAX=t,n.shiftDY=n.shiftAX*e,n.shiftDX=n.shiftDY*t,n}return rp(a,[{key:"maxValue",value:function(){return(e-1)*this.shiftDX+(t-1)*this.shiftDY+(e-1)*this.shiftAX+(t-1)}},{key:"encodeNumber",value:function(e){return e.coord.x*this.shiftDX+e.coord.y*this.shiftDY+e.end.x*this.shiftAX+e.end.y}},{key:"decodeNumber",value:function(r){var i=r%t;r/=t;var a=new ire((r-=r%1)%e,i);r/=e;var o=(r-=r%1)%t;r/=t;var s=new ire((r-=r%1)%e,o);return n(s,a)}}]),a}(Jee))}}]),n}(Ere),Tie=function(){var e=rp(function e(){tp(this,e)});return e.LANDING_ON_OCCUPIED_CASE=function(){return $localize(je||(je=Rv(["You cannot land on an occupied square."])))},e.THRONE_IS_LEFT_FOR_GOOD=function(){return $localize(Ze||(Ze=Rv(["Once you left the central throne, you cannot return to it."])))},e.SOLDIERS_CANNOT_SIT_ON_THRONE=function(){return $localize(Ye||(Ye=Rv(["Soldiers cannot sit on the throne."])))},e.SOMETHING_IN_THE_WAY=function(){return $localize(Ke||(Ke=Rv(["Something is in the way."])))},e.MOVE_MUST_BE_ORTHOGONAL=function(){return $localize(Je||(Je=Rv(["Tafl moves must be orthogonal."])))},e}(),Iie=function(e){Gv(n,e);var t=$v(n);function n(e,r){var i;if(tp(this,n),i=t.call(this,e,r),e.isNotInRange(i.getMaximalDistance(),i.getMaximalDistance()))throw new Error("Starting coord of TaflMove must be on the board, not at "+e.toString()+".");if(r.isNotInRange(i.getMaximalDistance(),i.getMaximalDistance()))throw new Error("Landing coord of TaflMove must be on the board, not at "+r.toString()+".");var a=e.getDirectionToward(r);if(a.isFailure()||a.get().isDiagonal())throw new Error(Tie.MOVE_MUST_BE_ORTHOGONAL());return Wv(i)}return rp(n,[{key:"equals",value:function(e){return e===this||!1!==e.coord.equals(this.coord)&&e.end.equals(this.end)}},{key:"toString",value:function(){return"TaflMove("+this.coord+"->"+this.end+")"}}]),n}(Oie),xie=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"getMaximalDistance",value:function(){return 7}}],[{key:"of",value:function(e,t){return new n(e,t)}},{key:"from",value:function(e,t){try{var r=new n(e,t);return j5.success(r)}catch(r){return j5.failure(r.message)}}}]),n}(Iie);xie.encoder=Oie.getEncoder(7,7,xie.of);var Aie={CASTLE_IS_LEFT_FOR_GOOD:!0,BORDER_CAN_SURROUND_KING:!1,CENTRAL_THRONE_CAN_SURROUND_KING:!0,KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED:!0,WIDTH:7,INVADER:ete.ZERO},Rie=function(){function e(t,n){tp(this,e),this.owner=t,this.king=n}return rp(e,[{key:"isKing",value:function(){return this.king}},{key:"getOwner",value:function(){return this.owner}}]),e}();Rie.UNOCCUPIED=new Rie(Xee.NONE,!1),Rie.PLAYER_ONE_KING=new Rie(ete.ONE,!0),Rie.INVADERS=new Rie(ete.ZERO,!1),Rie.DEFENDERS=new Rie(ete.ONE,!1);var Nie=rp(function e(t){tp(this,e),this.value=t});Nie.NONE=new Nie("NONE"),Nie.OPPONENT=new Nie("OPPONENT"),Nie.PLAYER=new Nie("PLAYER");var Mie=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"isCentralThrone",value:function(e){return e.equals(this.getCentralThrone())}},{key:"getCentralThrone",value:function(){var e=(this.board.length-1)/2;return new ire(e,e)}},{key:"getRelativeOwner",value:function(e,t){var n=this.getAbsoluteOwner(t);return n===Xee.NONE?Nie.NONE:e===n?Nie.PLAYER:Nie.OPPONENT}},{key:"getAbsoluteOwner",value:function(e){return this.getPieceAt(e).getOwner()}}]),n}(wre),Die=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"from",value:function(e,t){return new n(e,t)}}],[{key:"getInitialState",value:function(){var e=Rie.UNOCCUPIED,t=Rie.INVADERS,r=Rie.DEFENDERS;return new n([[e,e,e,t,e,e,e],[e,e,e,t,e,e,e],[e,e,e,r,e,e,e],[t,t,r,Rie.PLAYER_ONE_KING,r,t,t],[e,e,e,r,e,e,e],[e,e,e,t,e,e,e],[e,e,e,t,e,e,e]],0)}}]),n}(Mie),Lie=function(){var e=function(e){Gv(n,e);var t=$v(n);function n(e,r,i){var a;return tp(this,n),(a=t.call(this,e)).config=r,a.generateMove=i,a}return rp(n,[{key:"isLegal",value:function(e,t){rB(n.VERBOSE,{tablutRules_isLegal:{move:e,state:t}});var r=t.getCurrentPlayer(),i=this.getMoveValidity(r,e,t);return i.isFailure()?j5.failure(i.getReason()):j5.success(void 0)}},{key:"getMoveValidity",value:function(e,t,n){var r=n.getRelativeOwner(e,t.coord);if(r===Nie.NONE)return K5.failure(pre.MUST_CHOOSE_PLAYER_PIECE());if(r===Nie.OPPONENT)return K5.failure(pre.CANNOT_CHOOSE_OPPONENT_PIECE());if(n.getRelativeOwner(e,t.end)!==Nie.NONE)return K5.failure(Tie.LANDING_ON_OCCUPIED_CASE());if(this.isThrone(n,t.end)){if(!n.getPieceAt(t.coord).isKing())return K5.failure(Tie.SOLDIERS_CANNOT_SIT_ON_THRONE());if(n.isCentralThrone(t.end)&&this.config.CASTLE_IS_LEFT_FOR_GOOD)return K5.failure(Tie.THRONE_IS_LEFT_FOR_GOOD())}for(var i=t.coord.getDirectionToward(t.end).get(),a=t.coord.getOrthogonalDistance(t.end),o=t.coord.getNext(i),s=1;s<a;s++){if(n.getPieceAt(o)!==Rie.UNOCCUPIED)return K5.failure(Tie.SOMETHING_IN_THE_WAY());o=o.getNext(i)}return K5.SUCCESS}},{key:"isThrone",value:function(e,t){return!!this.isExternalThrone(t)||e.isCentralThrone(t)}},{key:"isExternalThrone",value:function(e){var t=this.config.WIDTH-1;return!(0!==e.x&&e.x!==t||0!==e.y&&e.y!==t)}},{key:"tryCapture",value:function(e,t,n,r){var i=t.getNext(n);return i.isInRange(this.config.WIDTH,this.config.WIDTH)&&r.getRelativeOwner(e,i)===Nie.OPPONENT?r.getPieceAt(i).isKing()?this.captureKing(e,t,n,r):this.capturePawn(e,t,n,r):sB.empty()}},{key:"captureKing",value:function(e,t,n,r){var i=t.getNext(n),a=this.getSurroundings(i,n,e,r),o=a.backCoord,s=a.back,u=a.backInRange,c=a.left,l=a.leftCoord,h=a.right,f=a.rightCoord;return!1===u?this.captureKingAgainstTheWall(c,h,i):s===Nie.NONE&&this.isThrone(r,o)?this.captureKingAgainstThrone(o,i,c,h):s===Nie.PLAYER?this.captureKingWithAtLeastASandwich(r,i,c,l,h,f):sB.empty()}},{key:"getSurroundings",value:function(e,t,n,r){var i=e.getNext(t),a=i.isInRange(this.config.WIDTH,this.config.WIDTH),o=a?r.getRelativeOwner(n,i):Nie.NONE,s=e.getLeft(t),u=s.isInRange(this.config.WIDTH,this.config.WIDTH)?r.getRelativeOwner(n,s):Nie.NONE,c=e.getRight(t),l=c.isInRange(this.config.WIDTH,this.config.WIDTH)?r.getRelativeOwner(n,c):Nie.NONE;return{backCoord:i,back:o,backInRange:a,leftCoord:s,left:u,rightCoord:c,right:l}}},{key:"captureKingAgainstTheWall",value:function(e,t,r){var i=e===Nie.PLAYER?1:0;return 2===(i+=t===Nie.PLAYER?1:0)&&this.config.BORDER_CAN_SURROUND_KING?(rB(n.VERBOSE||!1,"king captured by 3 invaders against 1 border"),sB.of(r)):sB.empty()}},{key:"captureKingAgainstThrone",value:function(e,t,n,r){if(this.isExternalThrone(e)){if(this.config.KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED)return sB.of(t)}else{var i=r===Nie.PLAYER,a=n===Nie.PLAYER||i;if(this.config.CENTRAL_THRONE_CAN_SURROUND_KING&&a)return sB.of(t)}return sB.empty()}},{key:"capturePawn",value:function(e,t,r,i){var a=!1,o=t.getNext(r),s=o.getNext(r),u=Nie.NONE;return s.isInRange(this.config.WIDTH,this.config.WIDTH)&&(u=i.getRelativeOwner(e,s)),u===Nie.NONE?!1===this.isThrone(i,s)?(rB(n.VERBOSE||a,"cannot capture a pawn without an ally; "+o+"threatened by "+e+"'s pawn in  "+t+" coming from this direction ("+r.x+", "+r.y+")cannot capture a pawn without an ally behind"),sB.empty()):(rB(n.VERBOSE||a,"pawn captured by 1 opponent and 1 throne; "+o+"threatened by "+e+"'s pawn in  "+t+" coming from this direction ("+r.x+", "+r.y+")"),sB.of(o)):u===Nie.PLAYER?(rB(n.VERBOSE||a,"pawn captured by 2 opponents; "+o+"threatened by "+e+"'s pawn in  "+t+" coming from this direction ("+r.x+", "+r.y+")"),sB.of(o)):(rB(n.VERBOSE||a,"no captures; "+o+"threatened by "+e+"'s pawn in  "+t+" coming from this direction ("+r.x+", "+r.y+")"),sB.empty())}},{key:"captureKingWithAtLeastASandwich",value:function(e,t,r,i,a,o){if(!1===this.kingTouchCentralThrone(e,t)&&this.config.KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED)return sB.of(t);var s=this.config.CENTRAL_THRONE_CAN_SURROUND_KING,u=this.isThrone(e,i),c=r===Nie.PLAYER||u&&s,l=this.isThrone(e,o);return c&&(a===Nie.PLAYER||l&&s)?(rB(n.VERBOSE||!1,"king captured by 4 invaders"),sB.of(t)):sB.empty()}},{key:"kingTouchCentralThrone",value:function(e,t){var n=e.getCentralThrone();return t.getOrthogonalDistance(n)<=1}},{key:"applyLegalMove",value:function(e,t){rB(n.VERBOSE,{TablutRules_applyLegalMove:{move:e,state:t}});var r=t.turn,i=t.getCopiedBoard(),a=t.getCurrentPlayer(),o=e.coord,s=e.end;i[s.y][s.x]=i[o.y][o.x],i[o.y][o.x]=Rie.UNOCCUPIED;var u,c=Qv(rre.ORTHOGONALS);try{for(c.s();!(u=c.n()).done;){var l=u.value,h=this.tryCapture(a,e.end,l,t);h.isPresent()&&(i[h.get().y][h.get().x]=Rie.UNOCCUPIED)}}catch(f){c.e(f)}finally{c.f()}return t.from(i,r+1)}},{key:"getGameStatus",value:function(e){var t=this.getWinner(e.gameState);return t.isPresent()?Are.getVictory(t.get()):Are.ONGOING}},{key:"getWinner",value:function(e){var t=!1,n=this.getKingCoord(e);if(n.isAbsent())return rB(t,"The king is dead, victory to invader"),sB.of(this.getInvader());var r=n.get();return this.isExternalThrone(r)?(rB(t,"The king escape, victory to defender"),sB.of(this.getDefender())):this.isPlayerImmobilized(ete.ZERO,e)?(rB(t,"Zero has no move, victory to one"),sB.of(ete.ONE)):this.isPlayerImmobilized(ete.ONE,e)?(rB(t,"One has no move, victory to zero"),sB.of(ete.ZERO)):(rB(t,"no victory"),sB.empty())}},{key:"getKingCoord",value:function(e){rB(n.VERBOSE,{TablutRules_getKingCoord:{state:e,con:this.config}});for(var t=0;t<this.config.WIDTH;t++)for(var r=0;r<this.config.WIDTH;r++)if(e.getPieceAtXY(r,t).isKing())return sB.of(new ire(r,t));return sB.empty()}},{key:"getInvader",value:function(){return this.config.INVADER}},{key:"getDefender",value:function(){return this.config.INVADER.getOpponent()}},{key:"isPlayerImmobilized",value:function(e,t){return 0===this.getPlayerListMoves(e,t).length}},{key:"getPlayerListMoves",value:function(e,t){var r=[],i=this.getPlayerListPawns(e,t);rB(n.VERBOSE||!1,{TablutRules_getPlayerListMoves:{player:e,state:t}});var a,o=Qv(i);try{for(o.s();!(a=o.n()).done;){var s,u=a.value,c=Qv(this.getPossibleDestinations(u,t));try{for(c.s();!(s=c.n()).done;){var l=s.value,h=this.generateMove(u,l);r.push(h)}}catch(f){c.e(f)}finally{c.f()}}}catch(f){o.e(f)}finally{o.f()}return r}},{key:"getPlayerListPawns",value:function(e,t){for(var n=[],r=0;r<this.config.WIDTH;r++)for(var i=0;i<this.config.WIDTH;i++){var a=new ire(i,r);t.getAbsoluteOwner(a)===e&&n.push(a)}return n}},{key:"getPossibleDestinations",value:function(e,t){var n,r,i=[],a=Qv(rre.ORTHOGONALS);try{for(a.s();!(r=a.n()).done;){var o=r.value;n=e.getNext(o,1);for(var s=!1;n.isInRange(this.config.WIDTH,this.config.WIDTH)&&!1===s;)t.getAbsoluteOwner(n)===Xee.NONE?this.isExternalThrone(n)?t.getPieceAt(e).isKing()&&i.push(n):t.isCentralThrone(n)?t.getPieceAt(e).isKing()&&!1===this.config.CASTLE_IS_LEFT_FOR_GOOD&&i.push(n):i.push(n):s=!0,n=n.getNext(o,1)}}catch(u){a.e(u)}finally{a.f()}return i}}]),n}(Rre);return e.VERBOSE=!1,e}(),Fie=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.call(this,Die,Aie,xie.of)}return rp(n,null,[{key:"get",value:function(){return null==n.singleton&&(n.singleton=new n),xre.ruler=this.singleton,n.singleton}}]),n}(Lie),Bie=function(e){Gv(n,e);var t=$v(n);function n(e,r,i){var a;return tp(this,n),(a=t.call(this,e)).VERBOSE=r,a.generateMove=i,a.NONE=Rie.UNOCCUPIED,a.captureds=[],a.chosen=new ire(-1,-1),a.lastMove=sB.empty(),a}return rp(n,[{key:"getViewBox",value:function(){var e=-this.STROKE_WIDTH,t=this.rules.config.WIDTH*this.SPACE_SIZE+2*this.STROKE_WIDTH;return e+" "+e+" "+t+" "+t}},{key:"updateBoard",value:function(){rB(this.VERBOSE,"taflComponent.updateBoard"),this.lastMove=this.rules.node.move,this.board=this.rules.node.gameState.getCopiedBoard(),this.captureds=[],this.lastMove.isPresent()&&this.showPreviousMove()}},{key:"showPreviousMove",value:function(){var e,t=this.rules.node.mother.get().gameState,n=this.rules.node.gameState.getCurrentOpponent(),r=Qv(rre.ORTHOGONALS);try{for(r.s();!(e=r.n()).done;){var i=e.value,a=this.lastMove.get().end.getNext(i,1);if(a.isInRange(this.rules.config.WIDTH,this.rules.config.WIDTH)){var o=t.getRelativeOwner(n,a)===Nie.OPPONENT,s=this.rules.node.gameState.getPieceAt(a)===Rie.UNOCCUPIED;o&&s&&this.captureds.push(a)}}}catch(u){r.e(u)}finally{r.f()}}},{key:"onClick",value:function(e,t){var n=this;return tB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return rB(n.VERBOSE,"TaflComponent.onClick("+e+", "+t+")"),i=n.canUserPlay("#click_"+e+"_"+t),r.abrupt("return",i.isFailure()?n.cancelMove(i.getReason()):-1===n.chosen.x?n.choosePiece(e,t):n.chooseDestination(e,t));case 3:case"end":return r.stop()}},r)}))()}},{key:"chooseDestination",value:function(e,t){var n=this;return tB(regeneratorRuntime.mark(function r(){var i,a,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(rB(n.VERBOSE,"TaflComponent.chooseDestination"),i=n.chosen,a=new ire(e,t),!(o=n.generateMove(i,a)).isSuccess()){r.next=9;break}return n.cancelMove(),r.next=6,n.chooseMove(o.get(),n.rules.node.gameState);case 6:r.t0=r.sent,r.next=10;break;case 9:r.t0=n.cancelMove(o.getReason());case 10:return r.abrupt("return",r.t0);case 11:case"end":return r.stop()}},r)}))()}},{key:"choosePiece",value:function(e,t){return rB(this.VERBOSE,"TaflComponent.choosePiece"),this.board[t][e]===Rie.UNOCCUPIED?this.cancelMove(pre.MUST_CHOOSE_PLAYER_PIECE()):this.pieceBelongToCurrentPlayer(e,t)?(this.chosen=new ire(e,t),rB(this.VERBOSE,"selected piece = ("+e+", "+t+")"),K5.SUCCESS):this.cancelMove(pre.CANNOT_CHOOSE_OPPONENT_PIECE())}},{key:"pieceBelongToCurrentPlayer",value:function(e,t){var n=this.rules.node.gameState,r=n.getCurrentPlayer(),i=new ire(e,t);return n.getRelativeOwner(r,i)===Nie.PLAYER}},{key:"cancelMoveAttempt",value:function(){this.chosen=new ire(-1,-1)}},{key:"isThrone",value:function(e,t){return this.rules.isThrone(this.rules.node.gameState,new ire(e,t))}},{key:"isCentralThrone",value:function(e,t){return!1===this.rules.node.gameState.isCentralThrone(new ire(e,t))}},{key:"getPieceClasses",value:function(e,t){var n=[],r=new ire(e,t),i=this.rules.node.gameState.getAbsoluteOwner(r);return n.push(this.getPlayerClass(i)),this.chosen.equals(r)&&n.push("selected"),n}},{key:"getRectClasses",value:function(e,t){var n=[],r=new ire(e,t);if(this.captureds.some(function(e){return e.equals(r)}))n.push("captured");else if(this.lastMove.isPresent()){var i=this.lastMove.get().coord,a=this.lastMove.get().end;(r.equals(i)||r.equals(a))&&n.push("moved")}return n}},{key:"getClickables",value:function(){for(var e=[],t=0;t<this.board.length;t++)for(var n=0;n<this.board[t].length;n++)this.isClickable(n,t)&&e.push(new ire(n,t));return e}},{key:"isClickable",value:function(e,t){return this.pieceBelongToCurrentPlayer(e,t)}},{key:"isInvader",value:function(e,t){return this.board[t][e]===Rie.INVADERS}},{key:"isKing",value:function(e,t){return this.board[t][e].isKing()}},{key:"getKingPolyline",value:function(e,t){return 85+100*e+" "+(85+100*t)+" "+(30+100*e)+" "+(30+100*t)+" "+(50+100*e)+" "+(10+100*t)+" "+(70+100*e)+" "+(30+100*t)+" "+(15+100*e)+" "+(85+100*t)}}]),n}(yie),Vie=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"getListMoves",value:function(e){rB(!1,{TaflMinimax_getListMoves:{node:e}});var t=e.gameState,n=t.getCurrentPlayer(),r=this.ruler.getPlayerListMoves(n,t);return this.orderMoves(t,r)}},{key:"orderMoves",value:function(e,t){var n=this,r=this.ruler.getKingCoord(e).get();return e.getCurrentPlayer()===this.ruler.config.INVADER?ite.sortByDescending(t,function(e){return-e.end.getOrthogonalDistance(r)}):ite.sortByDescending(t,function(e){return e.coord.equals(r)?n.ruler.isExternalThrone(e.end)?2:1:0}),t}},{key:"getBoardValue",value:function(e){var t=e.gameState,n=this.ruler.getWinner(t);if(n.isPresent())return new yre(n.get().getVictoryValue());var r=this.ruler.getPlayerListPawns(ete.ZERO,t).length,i=this.ruler.getPlayerListPawns(ete.ONE,t).length,a=[1,2][this.ruler.config.INVADER.value];a*=ete.ZERO.getScoreModifier();var o=[2,1][this.ruler.config.INVADER.value];return o*=ete.ONE.getScoreModifier(),new yre(r*a+i*o)}}]),n}(gre),Uie=function(){function e(t,n){tp(this,e),this.directThreats=t,this.mover=n}return rp(e,[{key:"equals",value:function(e){return e.directThreats.equals(this.directThreats)&&e.mover.equals(this.mover)}}]),e}(),zie=function(e){Gv(n,e);var t=$v(n);function n(e,r){var i;return tp(this,n),(i=t.call(this,new kre([e]),r)).directThreat=e,i.mover=r,i}return rp(n)}(Uie),Hie=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"toFields",value:function(e){return[[e.y],e.x]}}]),n}(function(e,t){Gv(r,e);var n=$v(r);function r(e){var t;if(tp(this,r),(t=n.call(this)).map=[],t.values=[],void 0!==e){var i,a=Qv(e);try{for(a.s();!(i=a.n()).done;){var o=i.value;t.add(o)}}catch(s){a.e(s)}finally{a.f()}}return Wv(t)}return rp(r,[{key:"add",value:function(e){var t,n=this.toFields(e),r=this.map,i=Qv(n[0]);try{for(i.s();!(t=i.n()).done;){var a=t.value;void 0===r[a]&&(r[a]=[]),r=r[a]}}catch(s){i.e(s)}finally{i.f()}var o=n[1];return void 0===r[o]&&(r[o]=!0,this.values.push(e),!0)}},{key:"contains",value:function(e){var t,n=this.toFields(e),r=this.map,i=Qv(n[0]);try{for(i.s();!(t=i.n()).done;){var a=t.value;if(void 0===r[a])return!1;r=r[a]}}catch(o){i.e(o)}finally{i.f()}return void 0!==r[n[1]]}},{key:t,value:function(){return this.values.values()}}]),r}(kre,Symbol.iterator)),Gie=function(e){Gv(n,e);var t=$v(n);function n(e,r){var i;return tp(this,n),(i=t.call(this,e,r)).width=i.ruler.config.WIDTH,i.maxInfluence=16*(2*i.width-2),i.scoreByThreatenedPiece=16*i.maxInfluence+1,i.scoreBySafePiece=16*i.scoreByThreatenedPiece+1,i}return rp(n,[{key:"getBoardValue",value:function(e){var t=this.ruler.getGameStatus(e);if(t.isEndGame)return new yre(t.toBoardValue());for(var n=e.gameState,r=Rie.UNOCCUPIED,i=0,a=this.getPiecesMap(n),o=this.getThreatMap(n,a),s=this.filterThreatMap(o,n),u=0,c=[ete.ZERO,ete.ONE];u<c.length;u++){var l,h=c[u],f=Qv(a.get(h).get());try{for(f.s();!(l=f.n()).done;){var d=l.value;if(s.get(d).isPresent())i+=h.getScoreModifier()*this.scoreByThreatenedPiece;else{i+=h.getScoreModifier()*this.scoreBySafePiece;var v,p=0,g=Qv(rre.ORTHOGONALS);try{for(g.s();!(v=g.n()).done;)for(var y=v.value,m=d.getNext(y,1);m.isInRange(this.width,this.width)&&n.getPieceAt(m)===r;)p++,m=m.getNext(y,1)}catch(k){g.e(k)}finally{g.f()}i+=p*h.getScoreModifier()}}}catch(k){f.e(k)}finally{f.f()}}return new yre(i)}},{key:"getPiecesMap",value:function(e){for(var t=Rie.UNOCCUPIED,n=new Ore,r=[],i=[],a=0;a<this.width;a++)for(var o=0;o<this.width;o++){var s=new ire(o,a);e.getPieceAt(s)!==t&&(e.getAbsoluteOwner(s)===ete.ZERO?r.push(s):i.push(s))}return n.set(ete.ZERO,new Hie(r)),n.set(ete.ONE,new Hie(i)),n}},{key:"getThreatMap",value:function(e,t){for(var n=new Ore,r=0,i=[ete.ZERO,ete.ONE];r<i.length;r++){var a,o=i[r],s=Qv(t.get(o).get());try{for(s.s();!(a=s.n()).done;){var u=a.value,c=this.getThreats(u,e);this.isThreatReal(u,e,c)&&n.set(u,new kre(c))}}catch(l){s.e(l)}finally{s.f()}}return n}},{key:"getThreats",value:function(e,t){var n=t.getAbsoluteOwner(e);X5(n.isPlayer(),"TaflPieceAndInfluenceMinimax.getThreats should be called with an occupied coordinate");var r,i=n.getOpponent(),a=[],o=Qv(rre.ORTHOGONALS);try{for(o.s();!(r=o.n()).done;){var s=r.value,u=e.getPrevious(s,1);if(this.isAThreat(u,t,i)){var c,l=[],h=Qv(rre.ORTHOGONALS);try{for(h.s();!(c=h.n()).done;){var f=c.value;if(f!==s.getOpposite()){for(var d=e.getNext(s,1);d.isInRange(this.width,this.width)&&t.getPieceAt(d)===Rie.UNOCCUPIED;)d=d.getNext(f);d.isInRange(this.width,this.width)&&t.getAbsoluteOwner(d)===i&&!1===e.getNext(s,1).equals(d)&&l.push(d)}}}catch(v){h.e(v)}finally{h.f()}a.push(new zie(u,new Hie(l)))}}}catch(v){o.e(v)}finally{o.f()}return a}},{key:"isAThreat",value:function(e,t,n){return!(e.isNotInRange(this.width,this.width)||t.getAbsoluteOwner(e)!==n&&(!this.ruler.isThrone(t,e)||n!==ete.ONE&&t.getPieceAt(e)!==Rie.UNOCCUPIED))}},{key:"isThreatReal",value:function(e,t,n){if(0===n.length)return!1;if(t.getPieceAt(e).isKing())return 3===n.length;var r,i=Qv(n);try{for(i.s();!(r=i.n()).done;){if(r.value.mover.size()>0)return!0}}catch(a){i.e(a)}finally{i.f()}return!1}},{key:"filterThreatMap",value:function(e,t){var n,r=new Ore,i=e.listKeys(),a=i.filter(function(e){return t.getAbsoluteOwner(e)===t.getCurrentPlayer()}),o=new Hie(i.filter(function(e){return t.getAbsoluteOwner(e)===t.getCurrentOpponent()})),s=Qv(a);try{for(s.s();!(n=s.n()).done;){var u,c=n.value,l=e.get(c).get(),h=[],f=Qv(l);try{for(f.s();!(u=f.n()).done;){var d=u.value;if(!1===o.contains(d.directThreat)){var v,p=[],g=Qv(d.mover);try{for(g.s();!(v=g.n()).done;){var y=v.value;!1===o.contains(y)&&p.push(y)}}catch(C){g.e(C)}finally{g.f()}p.length>0&&h.push(new zie(d.directThreat,new Hie(p)))}}}catch(C){f.e(C)}finally{f.f()}h.length>0&&r.set(c,new kre(h))}}catch(C){s.e(C)}finally{s.f()}var m,k=Qv(o);try{for(k.s();!(m=k.n()).done;){var _=m.value,w=e.get(_).get();r.set(_,w)}}catch(C){k.e(C)}finally{k.f()}return r}}]),n}(Vie),qie=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"getBoardValue",value:function(e){var t=this.ruler.getGameStatus(e);if(t.isEndGame)return new yre(t.toBoardValue());for(var r=e.gameState,i=this.ruler.config.WIDTH,a=Rie.UNOCCUPIED,o=0,s=this.getPiecesMap(r),u=this.getThreatMap(r,s),c=this.filterThreatMap(u,r),l=0,h=[ete.ZERO,ete.ONE];l<h.length;l++){var f,d=h[l],v=new Hie,p=Qv(s.get(d).get());try{for(p.s();!(f=p.n()).done;){var g=f.value;if(c.get(g).isPresent())o+=d.getScoreModifier()*n.SCORE_BY_THREATENED_PIECE;else{o+=d.getScoreModifier()*n.SCORE_BY_SAFE_PIECE;var y,m=Qv(rre.ORTHOGONALS);try{for(m.s();!(y=m.n()).done;)for(var k=y.value,_=g.getNext(k,1);_.isInRange(i,i)&&r.getPieceAt(_)===a;)v.add(_),_=_.getNext(k,1)}catch(S){m.e(S)}finally{m.f()}}}}catch(S){p.e(S)}finally{p.f()}var w,C=Qv(v);try{for(C.s();!(w=C.n()).done;){var b=w.value,E=n.CONTROL_VALUE[b.y][b.x];o+=d.getScoreModifier()*E}}catch(S){C.e(S)}finally{C.f()}}return new yre(o)}}]),n}(Gie);qie.SCORE_BY_THREATENED_PIECE=530,qie.SCORE_BY_SAFE_PIECE=16*qie.SCORE_BY_THREATENED_PIECE+1,qie.CONTROL_VALUE=[[64,8,8,8,8,8,8,8,64],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[64,8,8,8,8,8,8,8,64]];var $ie=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"getBoardValue",value:function(e){var t=this.ruler.getGameStatus(e);if(t.isEndGame)return new yre(t.toBoardValue());for(var n=e.gameState,r=this.ruler.config.WIDTH,i=Rie.UNOCCUPIED,a=0,o=0,s=0,u=this.getPiecesMap(n),c=this.getThreatMap(n,u),l=this.filterThreatMap(c,n),h=0,f=[ete.ZERO,ete.ONE];h<f.length;h++){var d,v=f[h],p=new Hie,g=Qv(u.get(v).get());try{for(g.s();!(d=g.n()).done;){var y=d.value;if(l.get(y).isPresent())o+=v.getScoreModifier();else{a+=v.getScoreModifier();var m,k=Qv(rre.ORTHOGONALS);try{for(k.s();!(m=k.n()).done;)for(var _=m.value,w=y.getNext(_,1);w.isInRange(r,r)&&n.getPieceAt(w)===i;)p.add(w),w=w.getNext(_,1)}catch(O){k.e(O)}finally{k.f()}}}}catch(O){g.e(O)}finally{g.f()}var C,b=Qv(p);try{for(b.s();!(C=b.n()).done;){var E=C.value,S=qie.CONTROL_VALUE[E.y][E.x];s+=v.getScoreModifier()*S}}catch(O){b.e(O)}finally{b.f()}}var P=this.getStepForEscape(n);return new yre(531*P*17*17+531*a*17+531*o+s)}},{key:"getStepForEscape",value:function(e){var t=this.ruler.getKingCoord(e).get();return this._getStepForEscape(e,1,[t],[]).getOrElse(Number.MAX_SAFE_INTEGER)}},{key:"_getStepForEscape",value:function(e,t,n,r){var i=this,a=this.getNextGen(e,n,r);return 0===a.length?sB.empty():a.some(function(e){return i.ruler.isExternalThrone(e)})?sB.of(t):(t++,r.push.apply(r,Kv(a)),this._getStepForEscape(e,t,a,r))}},{key:"getNextGen",value:function(e,t,n){var r,i=this,a=[],o=Qv(t);try{for(o.s();!(r=o.n()).done;){var s,u=r.value,c=Qv(rre.ORTHOGONALS);try{var l=function(){for(var t=s.value,r=u.getNext(t,1);r.isInRange(i.ruler.config.WIDTH,i.ruler.config.WIDTH)&&e.getPieceAt(r)===Rie.UNOCCUPIED;)n.every(function(e){return!1===e.equals(r)})&&a.push(r),r=r.getNext(t,1)};for(c.s();!(s=c.n()).done;)l()}catch(h){c.e(h)}finally{c.f()}}}catch(h){o.e(h)}finally{o.f()}return a}}]),n}(qie);$ie.SCORE_BY_THREATENED_PIECE=530,$ie.SCORE_BY_SAFE_PIECE=16*qie.SCORE_BY_THREATENED_PIECE+1,$ie.CONTROL_VALUE=[[64,8,8,8,8,8,8,8,64],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[64,8,8,8,8,8,8,8,64]];var Wie=Rie.UNOCCUPIED,jie=Rie.INVADERS,Zie=Rie.DEFENDERS,Yie=Rie.PLAYER_ONE_KING,Kie=rp(function e(){tp(this,e),this.tutorial=[Lre.informational($localize(Qe||(Qe=Rv(["Goal of the game"]))),$localize(Xe||(Xe=Rv(["Brandhub is the Irish version of the family of viking strategy game called Tafl. The goal of the game is different for each player. The attacker plays first. Their pieces (dark) are close to the edges. Their goal is to capture the king, which is in the center of the board. The defender plays second. Their pieces (light) are in the middle. Their goal is to move the king on one of the 4 thrones in the corners. Note that the square in which the king starts, in the center of the board, is also a throne."]))),Die.getInitialState()),Lre.anyMove($localize(et||(et=Rv(["Moving"]))),$localize(tt||(tt=Rv(["All pieces move the same way. Similarly to a rook in chess, a piece can move: <ol><li>By as many squares as you want.</li><li>Without going over another piece or stopping on another piece.</li><li>Horizontally or vertically.</li><li>Only the king can land on a corner throne.</li><li>Once the king left his central throne, he can't go back on it, nor can the other pieces.</li></ol>To move a piece, click on it and then on its landing square.<br/><br/>You're playing Dark, do the first move."]))),Die.getInitialState(),xie.of(new ire(3,1),new ire(1,1)),$localize(nt||(nt=Rv(["Congratulations!"])))),Lre.fromMove($localize(rt||(rt=Rv(["Capturing a soldier (1/2)"]))),$localize(it||(it=Rv(["All pieces, attackers and defenders, except the king, are soldiers. To capture them, they have to be sandwiched between two of your pieces. By getting too close, an attacker's soldier is in danger.<br/><br/>Capture it."]))),new Die([[Wie,Wie,Wie,jie,Wie,Wie,Wie],[Wie,Wie,Wie,jie,Wie,Wie,Wie],[jie,Wie,Wie,Zie,Wie,Wie,Wie],[Wie,Wie,Zie,Yie,Zie,jie,jie],[Wie,Wie,jie,Wie,Wie,Wie,Wie],[Wie,Wie,Wie,Zie,Wie,jie,Wie],[Wie,Wie,Wie,jie,Wie,Wie,Wie]],1),[xie.of(new ire(3,5),new ire(2,5))],$localize(at||(at=Rv(["Congratulations, that will teach him a lesson!"]))),$localize(ot||(ot=Rv(["Failed, you missed an opportunity to capture a piece of the opponent."])))),Lre.fromMove($localize(st||(st=Rv(["Capturing a soldier (2/2)"]))),$localize(ut||(ut=Rv(["A second way to capture a soldier is to sandwich it against an empty throne. The king has moved and endangered one of its soldiers.<br/><br/>Capture it."]))),new Die([[Wie,Wie,Wie,jie,Wie,Wie,Wie],[Wie,Wie,jie,Wie,Wie,Wie,Wie],[Wie,Wie,Wie,Zie,Wie,Wie,Wie],[jie,Zie,Wie,Wie,Zie,jie,jie],[Wie,Zie,Wie,Wie,Wie,Wie,Wie],[Wie,jie,Wie,Yie,Wie,jie,Wie],[Wie,Wie,Wie,jie,Wie,Wie,Wie]],12),[xie.of(new ire(2,1),new ire(3,1)),xie.of(new ire(3,0),new ire(3,1))],$localize(ct||(ct=Rv(["Congratulations, one less defender. But keep an eye on the king, it is the most important."]))),$localize(lt||(lt=Rv(["Failed, you did not do the expected move."])))),Lre.fromMove($localize(ht||(ht=Rv(["Capturing the king on his throne"]))),$localize(ft||(ft=Rv(["To capture the king when he sits on his throne, the four squares neighbor to the king (horizontally and vertically) must be occupied by your soldiers.<br/><br/>Capture the king."]))),new Die([[Wie,Wie,Wie,Wie,Wie,Wie,Wie],[Wie,Wie,Wie,Zie,Wie,Wie,Wie],[Wie,Wie,Wie,jie,Wie,Wie,Wie],[Wie,jie,Wie,Yie,jie,Wie,Wie],[Wie,Wie,Wie,jie,Wie,Wie,Wie],[Wie,Zie,Wie,Wie,Wie,Wie,Wie],[Wie,Wie,Wie,Wie,Wie,Wie,Wie]],72),[xie.of(new ire(1,3),new ire(2,3))],$localize(dt||(dt=Rv(["Congratulations, you won!"]))),$localize(vt||(vt=Rv(["Failed, you let the king run away."])))),Lre.fromMove($localize(pt||(pt=Rv(["Capturing the king next to his throne"]))),$localize(gt||(gt=Rv(["Another way to capture the king is to use three soldier plus the central throne to surround the king on four sides.<br/><br/>Capture the king."]))),new Die([[Wie,Wie,jie,Wie,Wie,Wie,Wie],[Wie,Wie,Wie,jie,Wie,Wie,Wie],[Wie,Wie,Wie,Yie,jie,Wie,Wie],[Wie,jie,Zie,Wie,Zie,Wie,Wie],[Wie,Wie,Wie,jie,Wie,Wie,Wie],[Wie,Wie,Wie,Wie,Wie,Wie,Wie],[Wie,Wie,Wie,Wie,Wie,Wie,Wie]],72),[xie.of(new ire(2,0),new ire(2,2))],$localize(yt||(yt=Rv(["The king is dead, long live the king. Congratulations, you won."]))),$localize(mt||(mt=Rv(["Failed!"])))),Lre.fromMove($localize(kt||(kt=Rv(["Capturing the king far from his throne"]))),$localize(_t||(_t=Rv(["When the king is not on his central throne nor next to it, he can be captured like a soldier.<br/><br/>Capture the king."]))),new Die([[Wie,Wie,Wie,Wie,Wie,Wie,Wie],[Wie,Wie,Wie,Wie,Wie,Wie,Wie],[Wie,jie,Wie,jie,Wie,Wie,Wie],[jie,Wie,Wie,Wie,Zie,Wie,Wie],[Wie,Wie,Wie,Zie,Wie,Wie,Wie],[Wie,Wie,Wie,Wie,Wie,Wie,Wie],[Wie,Yie,Wie,jie,Wie,Wie,Wie]],72),[xie.of(new ire(3,6),new ire(2,6))],$localize(wt||(wt=Rv(["The king is dead, long live the king. Congratulations, you won."]))),$localize(Ct||(Ct=Rv(["Failed!"]))))]});function Jie(e,t){if(1&e){var n=pb();_m(),lb(0,"polyline",6),mb("click",function(){$y(n);var e=wb(2).index,t=wb().index;return wb().onClick(e,t)}),hb()}if(2&e){var r=wb(2).index,i=wb().index,a=wb();tb("transform","translate("+r*a.SPACE_SIZE+" "+i*a.SPACE_SIZE+")")}}function Qie(e,t){if(1&e){var n=pb();_m(),lb(0,"polyline",7),mb("click",function(){$y(n);var e=wb(2).index,t=wb().index;return wb().onClick(e,t)}),hb()}if(2&e){var r=wb(2).index,i=wb().index,a=wb();tb("transform","translate("+r*a.SPACE_SIZE+" "+i*a.SPACE_SIZE+")")}}function Xie(e,t){if(1&e&&(_m(),lb(0,"g"),ab(1,Jie,1,1,"polyline",4),ab(2,Qie,1,1,"ng-template",null,5,OP),hb()),2&e){var n=ob(3),r=wb().index,i=wb().index,a=wb();Pw(1),ub("ngIf",a.isCentralThrone(r,i))("ngIfElse",n)}}function eae(e,t){if(1&e){var n=pb();_m(),lb(0,"g"),lb(1,"line",11),mb("click",function(){$y(n);var e=wb(2).index,t=wb().index;return wb().onClick(e,t)}),hb(),lb(2,"line",11),mb("click",function(){$y(n);var e=wb(2).index,t=wb().index;return wb().onClick(e,t)}),hb(),lb(3,"line",11),mb("click",function(){$y(n);var e=wb(2).index,t=wb().index;return wb().onClick(e,t)}),hb(),lb(4,"line",11),mb("click",function(){$y(n);var e=wb(2).index,t=wb().index;return wb().onClick(e,t)}),hb(),lb(5,"line",11),mb("click",function(){$y(n);var e=wb(2).index,t=wb().index;return wb().onClick(e,t)}),hb(),hb()}if(2&e){var r=wb(2).index,i=wb().index,a=wb();Pw(1),tb("x1",a.SPACE_SIZE*r+.5*a.SPACE_SIZE)("y1",a.SPACE_SIZE*i+.04*a.SPACE_SIZE)("x2",a.SPACE_SIZE*r+.5*a.SPACE_SIZE)("y2",a.SPACE_SIZE*i+.96*a.SPACE_SIZE),Pw(1),tb("x1",a.SPACE_SIZE*r+.5*a.SPACE_SIZE)("y1",a.SPACE_SIZE*i+.2*a.SPACE_SIZE)("x2",a.SPACE_SIZE*r+.05*a.SPACE_SIZE)("y2",a.SPACE_SIZE*i+.65*a.SPACE_SIZE),Pw(1),tb("x1",a.SPACE_SIZE*r+.5*a.SPACE_SIZE)("y1",a.SPACE_SIZE*i+.2*a.SPACE_SIZE)("x2",a.SPACE_SIZE*r+.95*a.SPACE_SIZE)("y2",a.SPACE_SIZE*i+.65*a.SPACE_SIZE),Pw(1),tb("x1",a.SPACE_SIZE*r+.5*a.SPACE_SIZE)("y1",a.SPACE_SIZE*i+.4*a.SPACE_SIZE)("x2",a.SPACE_SIZE*r+.15*a.SPACE_SIZE)("y2",a.SPACE_SIZE*i+.75*a.SPACE_SIZE),Pw(1),tb("x1",a.SPACE_SIZE*r+.5*a.SPACE_SIZE)("y1",a.SPACE_SIZE*i+.4*a.SPACE_SIZE)("x2",a.SPACE_SIZE*r+.85*a.SPACE_SIZE)("y2",a.SPACE_SIZE*i+.75*a.SPACE_SIZE)}}function tae(e,t){if(1&e){var n=pb();_m(),lb(0,"g"),lb(1,"polyline",13),mb("click",function(){$y(n);var e=wb(3).index,t=wb().index;return wb().onClick(e,t)}),hb(),hb()}if(2&e){var r=wb(3).index,i=wb().index,a=wb();Pw(1),tb("points",a.getKingPolyline(r,i))}}function nae(e,t){if(1&e){var n=pb();_m(),lb(0,"line",11),mb("click",function(){$y(n);var e=wb(3).index,t=wb().index;return wb().onClick(e,t)}),hb(),lb(1,"line",11),mb("click",function(){$y(n);var e=wb(3).index,t=wb().index;return wb().onClick(e,t)}),hb(),lb(2,"line",11),mb("click",function(){$y(n);var e=wb(3).index,t=wb().index;return wb().onClick(e,t)}),hb(),lb(3,"line",11),mb("click",function(){$y(n);var e=wb(3).index,t=wb().index;return wb().onClick(e,t)}),hb()}if(2&e){var r=wb(3).index,i=wb().index,a=wb();tb("x1",a.SPACE_SIZE*r+.5*a.SPACE_SIZE)("y1",a.SPACE_SIZE*i+.04*a.SPACE_SIZE)("x2",a.SPACE_SIZE*r+.5*a.SPACE_SIZE)("y2",a.SPACE_SIZE*i+.96*a.SPACE_SIZE),Pw(1),tb("x1",a.SPACE_SIZE*r+.04*a.SPACE_SIZE)("y1",a.SPACE_SIZE*i+.5*a.SPACE_SIZE)("x2",a.SPACE_SIZE*r+.96*a.SPACE_SIZE)("y2",a.SPACE_SIZE*i+.5*a.SPACE_SIZE),Pw(1),tb("x1",a.SPACE_SIZE*r+.15*a.SPACE_SIZE)("y1",a.SPACE_SIZE*i+.15*a.SPACE_SIZE)("x2",a.SPACE_SIZE*r+.85*a.SPACE_SIZE)("y2",a.SPACE_SIZE*i+.85*a.SPACE_SIZE),Pw(1),tb("x1",a.SPACE_SIZE*r+.85*a.SPACE_SIZE)("y1",a.SPACE_SIZE*i+.15*a.SPACE_SIZE)("x2",a.SPACE_SIZE*r+.15*a.SPACE_SIZE)("y2",a.SPACE_SIZE*i+.85*a.SPACE_SIZE)}}function rae(e,t){if(1&e&&(_m(),ab(0,tae,2,1,"g",9),ab(1,nae,4,16,"ng-template",null,12,OP)),2&e){var n=ob(2),r=wb(2).index,i=wb().index;ub("ngIf",wb().isKing(r,i))("ngIfElse",n)}}function iae(e,t){if(1&e){var n=pb();_m(),lb(0,"g"),lb(1,"circle",8),mb("click",function(){$y(n);var e=wb().index,t=wb().index;return wb().onClick(e,t)}),hb(),ab(2,eae,6,20,"g",9),ab(3,rae,3,2,"ng-template",null,10,OP),hb()}if(2&e){var r=ob(4),i=wb().index,a=wb().index,o=wb();Pw(1),ub("ngClass",o.getPieceClasses(i,a)),tb("r",(o.SPACE_SIZE-o.STROKE_WIDTH)/2)("cx",o.SPACE_SIZE*i+.5*o.SPACE_SIZE)("cy",o.SPACE_SIZE*a+.5*o.SPACE_SIZE),Pw(1),ub("ngIf",o.isInvader(i,a))("ngIfElse",r)}}function aae(e,t){if(1&e){var n=pb();_m(),lb(0,"g"),lb(1,"rect",2),mb("click",function(){var e=$y(n).index,t=wb().index;return wb().onClick(e,t)}),hb(),ab(2,Xie,4,2,"g",3),ab(3,iae,5,6,"g",3),hb()}if(2&e){var r=t.index,i=wb().index,a=wb();Pw(1),bb("id","click_",r,"_",i,""),ub("ngClass",a.getRectClasses(r,i)),tb("x",a.SPACE_SIZE*r)("y",a.SPACE_SIZE*i)("width",a.SPACE_SIZE)("height",a.SPACE_SIZE),Pw(1),ub("ngIf",a.board[i][r]===a.NONE&&a.isThrone(r,i)),Pw(1),ub("ngIf",a.board[i][r]!==a.NONE)}}function oae(e,t){if(1&e&&(_m(),lb(0,"g"),ab(1,aae,4,9,"g",1),hb()),2&e){var n=t.$implicit;Pw(1),ub("ngForOf",n)}}function sae(e,t){if(1&e){var n=pb();_m(),lb(0,"g"),lb(1,"rect",14),mb("click",function(){var e=$y(n).$implicit;return wb().onClick(e.x,e.y)}),hb(),hb()}if(2&e){var r=t.$implicit,i=wb();Pw(1),bb("id","click_",r.x,"_",r.y,""),tb("x",i.SPACE_SIZE*r.x)("y",i.SPACE_SIZE*r.y)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)}}var uae=function(){var e=function(e){Gv(n,e);var t=$v(n);function n(e){var r;return tp(this,n),(r=t.call(this,e,!1,xie.from)).rules=Fie.get(),r.availableMinimaxes=[new Vie(r.rules,"DummyBot"),new Gie(r.rules,"Piece > Influence"),new qie(r.rules,"Piece > Control"),new $ie(r.rules,"Escape > Piece > Control")],r.encoder=xie.encoder,r.tutorial=(new Kie).tutorial,r}return rp(n,[{key:"ngOnInit",value:function(){this.updateBoard()}}]),n}(Bie);return e.\u0275fac=function(t){return new(t||e)(sb(ore))},e.\u0275cmp=ey({type:e,selectors:[["app-brandhub"]],features:[zC],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[1,"base",3,"id","ngClass","click"],[4,"ngIf"],["points","15 15, 85 15, 85 85, 15 85, 15 15, 85 15","class","base",3,"click",4,"ngIf","ngIfElse"],["cornerThrone",""],["points","15 15, 85 15, 85 85, 15 85, 15 15, 85 15",1,"base",3,"click"],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60, 10 20",1,"base",3,"click"],[1,"base",3,"ngClass","click"],[4,"ngIf","ngIfElse"],["defender",""],[1,"base",3,"click"],["soldierDefender",""],[1,"base","no-fill",3,"click"],[1,"no-fill","mid-stroke","clickable",3,"id","click"]],template:function(e,t){1&e&&(_m(),lb(0,"svg",0),ab(1,oae,2,1,"g",1),ab(2,sae,2,6,"g",1),hb()),2&e&&(tb("viewBox",t.getViewBox()),Pw(1),ub("ngForOf",t.board),Pw(1),ub("ngForOf",t.getClickables()))},directives:[AT,IT,NT],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),cae=function(){var e,t=function(e){Gv(n,e);var t=$v(n);function n(){var e;return tp(this,n),(e=t.apply(this,arguments)).SPACE_SIZE=50,e}return rp(n,[{key:"getTriangleCornerCoords",value:function(e,t){return(e+t)%2==1?this.getDownwardCoordinate(e,t):this.getUpwardCoordinate(e,t)}},{key:"getTriangleCoordinate",value:function(e,t){return this.getTriangleCornerCoords(e,t).map(function(e){return e.x+","+e.y}).reduce(function(e,t){return e+","+t})}},{key:"getDownwardCoordinate",value:function(e,t){var n=.5*this.SPACE_SIZE*(e+1),r=.5*this.SPACE_SIZE*(e+2),i=this.SPACE_SIZE*t,a=this.SPACE_SIZE*(t+1),o=new ire(.5*this.SPACE_SIZE*e,i);return[o,new ire(n,a),new ire(r,i),o]}},{key:"getUpwardCoordinate",value:function(e,t){var n=.5*this.SPACE_SIZE*(e+1),r=.5*this.SPACE_SIZE*(e+2),i=this.SPACE_SIZE*t,a=this.SPACE_SIZE*(t+1),o=new ire(.5*this.SPACE_SIZE*e,a);return[o,new ire(n,i),new ire(r,a),o]}},{key:"getPyramidCoordinate",value:function(e,t){return(e+t)%2==1?this.getDownwardPyramidCoordinate(e,t):this.getUpwardPyramidCoordinate(e,t)}},{key:"getDownwardPyramidCoordinate",value:function(e,t){var n=this.SPACE_SIZE*e/2,r=this.SPACE_SIZE*t,i=n+", "+r,a=n+this.SPACE_SIZE+", "+r,o=n+this.SPACE_SIZE/2+", "+(r+this.SPACE_SIZE),s=n+this.SPACE_SIZE/2+", "+(r+this.SPACE_SIZE/2);return i+","+o+","+s+","+i+","+s+","+a+","+i+","+a+","+o+","+s+","+a}},{key:"getUpwardPyramidCoordinate",value:function(e,t){var n=this.SPACE_SIZE*e/2,r=(t+1)*this.SPACE_SIZE,i=n+", "+r,a=n+this.SPACE_SIZE+", "+r,o=n+this.SPACE_SIZE/2+", "+(r-this.SPACE_SIZE),s=n+this.SPACE_SIZE/2+", "+(r-this.SPACE_SIZE/2);return i+","+o+","+s+","+i+","+s+","+a+","+i+","+a+","+o+","+s+","+a}}]),n}(sre);return t.\u0275fac=function(n){return(e||(e=tk(t)))(n||t)},t.\u0275cmp=ey({type:t,selectors:[["ng-component"]],features:[zC],decls:0,vars:0,template:function(e,t){},encapsulation:2}),t}(),lae=function(){var e=rp(function e(){tp(this,e)});return e.INVALID_DISTANCE=function(){return $localize(bt||(bt=Rv(["Your piece must land on one of the closest six triangles with the same color as the triangle on which the piece is."])))},e.NOT_ENOUGH_TILES_TO_EXCHANGE=function(){return $localize(Et||(Et=Rv(["You do not have enough tiles to exchange in order to capture this piece. Pick one of your piece and move it."])))},e.FIRST_CLICK_SHOULD_NOT_BE_NULL=function(){return $localize(St||(St=Rv(["Your first click must be on the piece that you want to move, or on a piece of your opponent that you want to exchange against two tiles."])))},e.CANNOT_CAPTURE_FROM_EMPTY=function(){return $localize(Pt||(Pt=Rv(["You cannot capture from an empty space."])))},e.CANNOT_CAPTURE_OWN_PIECES=function(){return $localize(Ot||(Ot=Rv(["You cannot capture your own pieces."])))},e}(),hae=function(){function e(t,n){tp(this,e),this.direction=t,this.str=n}return rp(e,[{key:"toInt",value:function(){var t=this;return e.STEPS.findIndex(function(e){return e.direction.equals(t.direction)})}},{key:"equals",value:function(e){return this===e}},{key:"toString",value:function(){return this.str}}],[{key:"fromCoords",value:function(t,n){var r=t.getVectorToward(n),i=e.STEPS.findIndex(function(e){return e.direction.equals(r)});if(-1===i)throw new Error(lae.INVALID_DISTANCE());return e.STEPS[i]}}]),e}();hae.LEFT=new hae(new Xne(-2,0),"LEFT"),hae.UP_LEFT=new hae(nre.UP_LEFT,"UP_LEFT"),hae.UP_RIGHT=new hae(nre.UP_RIGHT,"UP_RIGHT"),hae.RIGHT=new hae(new Xne(2,0),"RIGHT"),hae.DOWN_LEFT=new hae(nre.DOWN_LEFT,"DOWN_LEFT"),hae.DOWN_RIGHT=new hae(nre.DOWN_RIGHT,"DOWN_RIGHT"),hae.STEPS=[hae.LEFT,hae.UP_LEFT,hae.UP_RIGHT,hae.RIGHT,hae.DOWN_LEFT,hae.DOWN_RIGHT];var fae=function(e){Gv(n,e);var t=$v(n);function n(e,r,i,a){var o;return tp(this,n),(o=t.call(this)).start=e,o.step=r,o.landingCoord=i,o.capture=a,o}return rp(n,[{key:"isTileExchange",value:function(){return this.capture.isPresent()}},{key:"toString",value:function(){return this.isTileExchange()?"CoerceoMove("+this.capture.get().toString()+")":"CoerceoMove("+this.start.get().toString()+" > "+this.step.get().toString()+" > "+this.landingCoord.get().toString()+")"}},{key:"equals",value:function(e){return!(!this.capture.equals(e.capture)||!this.start.equals(e.start)||!this.step.equals(e.step))}}],[{key:"fromMovement",value:function(e,t){if(e.isNotInRange(15,10))throw new Error("Starting coord cannot be out of range (width: 15, height: 10).");var r=new ire(e.x+t.direction.x,e.y+t.direction.y);if(r.isNotInRange(15,10))throw new Error("Landing coord cannot be out of range (width: 15, height: 10).");return new n(sB.of(e),sB.of(t),sB.of(r),sB.empty())}},{key:"fromTilesExchange",value:function(e){if(e.isNotInRange(15,10))throw new Error("Captured coord cannot be out of range (width: 15, height: 10).");return new n(sB.empty(),sB.empty(),sB.empty(),sB.of(e))}},{key:"fromCoordToCoord",value:function(e,t){var r=hae.fromCoords(e,t);return n.fromMovement(e,r)}}]),n}(bre);fae.encoder=new(function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"maxValue",value:function(){return 1035}},{key:"encodeNumber",value:function(e){if(e.isTileExchange()){var t=e.capture.get().y;return 10*e.capture.get().x+t}var n=e.start.get().y,r=e.start.get().x;return 150*(e.step.get().toInt()+1)+10*r+n}},{key:"decodeNumber",value:function(e){if(e%1!=0)throw new Error("EncodedMove must be an integer.");var t=e%10,n=(e=(e-t)/10)%15;return 0==(e=(e-n)/15)?fae.fromTilesExchange(new ire(n,t)):fae.fromMovement(new ire(n,t),hae.STEPS[e-1])}}]),n}(Jee));var dae=function(){function e(){tp(this,e)}return rp(e,null,[{key:"getNeighbors",value:function(e){var t=new ire(e.x-1,e.y),n=new ire(e.x+1,e.y);return(e.x+e.y)%2==1?[t,n,new ire(e.x,e.y-1)]:[t,n,new ire(e.x,e.y+1)]}},{key:"getFakeNeighbors",value:function(e){return new ire(e.x,(e.x+e.y)%2==1?e.y+1:e.y-1)}},{key:"getCommonNeighbor",value:function(t,n){for(var r=e.getNeighbors(t),i=e.getNeighbors(n),a=0;a<r.length;){for(var o=r[a],s=0;s<i.length;){if(o.equals(i[s]))return sB.of(o);s++}a++}return sB.empty()}}]),e}(),vae=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"getEmptyNeighboors",value:function(e,t){return n.getEmptyNeighbors(this.board,e,t)}}],[{key:"getEmptyNeighbors",value:function(e,t,n){var r,i=[],a=Qv(dae.getNeighbors(t));try{for(a.s();!(r=a.n()).done;){var o=r.value;o.isInRange(e[0].length,e.length)&&e[o.y][o.x]===n&&i.push(o)}}catch(s){a.e(s)}finally{a.f()}return i}}]),n}(wre),pae=function(e){Gv(n,e);var t=$v(n);function n(e,r,i,a){var o;return tp(this,n),(o=t.call(this,e,r)).tiles=i,o.captures=a,o}return rp(n,[{key:"applyLegalMovement",value:function(e){rB(n.VERBOSE,{coerceoState_applyLegalMovement:{object:this,move:e}});var t=e.start.get(),r=e.landingCoord.get(),i=this.getCopiedBoard();return i[r.y][r.x]=cre.ofPlayer(this.getCurrentPlayer()),i[t.y][t.x]=cre.EMPTY,new n(i,this.turn,this.tiles,this.captures)}},{key:"doMovementCaptures",value:function(e){rB(n.VERBOSE,{coerceoState_doMovementCaptures:{object:this,move:e}});var t,r=this,i=Qv(this.getCapturedNeighbors(e.landingCoord.get()));try{for(i.s();!(t=i.n()).done;){var a=t.value;r=r.capture(a)}}catch(o){i.e(o)}finally{i.f()}return r}},{key:"getCapturedNeighbors",value:function(e){var t=this,n=this.getCurrentOpponent();return dae.getNeighbors(e).filter(function(e){return!e.isNotInRange(15,10)&&!!t.getPieceAt(e).is(n)&&t.isSurrounded(e)})}},{key:"isSurrounded",value:function(e){return 0===this.getEmptyNeighboors(e,cre.EMPTY).length}},{key:"capture",value:function(e){rB(n.VERBOSE,{coerceoState_captureIfNeeded:{object:this,coord:e}});var t=this.getCopiedBoard(),r=[this.captures[0],this.captures[1]];return rB(n.VERBOSE,e.toString()+" has been captured"),t[e.y][e.x]=cre.EMPTY,r[this.getCurrentPlayer().value]+=1,new n(t,this.turn,this.tiles,r)}},{key:"removeTilesIfNeeded",value:function(e,t){rB(n.VERBOSE,{coerceoState_removeTilesIfNeeded:{object:this,tile:e,countTiles:t}});var r=this,i=n.getTilesUpperLeftCoord(e);if(this.isTileEmpty(i)&&this.isDeconnectable(i)){r=this.deconnectTile(i,t);var a,o=Qv(n.getPresentNeighboorEntrances(i));try{for(o.s();!(a=o.n()).done;){var s=a.value,u=r.getPieceAt(s);u===cre.EMPTY?r=r.removeTilesIfNeeded(s,t):u.is(this.getCurrentOpponent())&&r.isSurrounded(s)&&(r=r.capture(s))}}catch(c){o.e(c)}finally{o.f()}}return r}},{key:"isTileEmpty",value:function(e){X5(this.getPieceAt(e)!==cre.NONE,"Should not call isTileEmpty on removed tile");for(var t=0;t<2;t++)for(var n=0;n<3;n++){var r=e.getNext(new Xne(n,t),1);if(this.getPieceAt(r)!==cre.EMPTY)return!1}return!0}},{key:"isDeconnectable",value:function(e){var t=this.getPresentNeighboorTilesRelativeIndexes(e);if(t.length>3)return!1;for(var n=0,r=1;r<t.length;r++)!1===this.areNeighboor(t[r-1],t[r])&&(n+=1);return!1===this.areNeighboor(t[0],t[t.length-1])&&(n+=1),n<=1}},{key:"areNeighboor",value:function(e,t){return e+1===t||0===e&&5===t}},{key:"getPresentNeighboorTilesRelativeIndexes",value:function(e){for(var t=[],r=sB.empty(),i=0;i<6;i++){var a=e.getNext(n.NEIGHBOORS_TILES_DIRECTIONS[i],1);a.isInRange(15,10)&&this.getPieceAt(a)!==cre.NONE&&(r.isAbsent()&&(r=sB.of(i)),t.push(i-r.get()))}return t}},{key:"deconnectTile",value:function(e,t){rB(n.VERBOSE,{coerceoState_deconnectTile:{object:this,tileUpperLeft:e,countTiles:t}});for(var r=this.getCopiedBoard(),i=e.x,a=e.y,o=0;o<2;o++)for(var s=0;s<3;s++)r[a+o][i+s]=cre.NONE;var u=[this.tiles[0],this.tiles[1]];return t&&(u[this.getCurrentPlayer().value]+=1),new n(r,this.turn,u,this.captures)}},{key:"getLegalLandings",value:function(e){var t,n=[],r=Qv(hae.STEPS);try{for(r.s();!(t=r.n()).done;){var i=t.value,a=e.getNext(i.direction,1);this.isOnBoard(a)&&this.getPieceAt(a)===cre.EMPTY&&n.push(a)}}catch(o){r.e(o)}finally{r.f()}return n}},{key:"getPiecesByFreedom",value:function(){for(var e=[[0,0,0,0],[0,0,0,0]],t=0;t<10;t++)for(var n=0;n<15;n++){var r=this.board[t][n];if(r.isPlayer()){var i=this.getEmptyNeighboors(new ire(n,t),cre.EMPTY).length;e[r.value][i]=e[r.value][i]+1}}return e}}],[{key:"getTilesUpperLeftCoord",value:function(e){var t=e.x-e.x%3,n=e.y;return n-=t%2==0?e.y%2:(e.y+1)%2,new ire(t,n)}},{key:"getPresentNeighboorEntrances",value:function(e){return[new ire(e.x+1,e.y-1),new ire(e.x+3,e.y+0),new ire(e.x+3,e.y+1),new ire(e.x+1,e.y+2),new ire(e.x-1,e.y+1),new ire(e.x-1,e.y+0)].filter(n.isInRange)}},{key:"getInitialState",value:function(){var e=cre.EMPTY,t=cre.NONE,r=cre.ZERO,i=cre.ONE;return new n([[t,t,t,t,t,t,r,e,r,t,t,t,t,t,t],[t,t,t,e,e,r,e,e,e,r,e,e,t,t,t],[e,i,e,i,e,e,r,e,r,e,e,i,e,i,e],[i,e,e,e,i,e,e,e,e,e,i,e,e,e,i],[e,i,e,i,e,e,e,e,e,e,e,i,e,i,e],[e,r,e,r,e,e,e,e,e,e,e,r,e,r,e],[r,e,e,e,r,e,e,e,e,e,r,e,e,e,r],[e,r,e,r,e,e,i,e,i,e,e,r,e,r,e],[t,t,t,e,e,i,e,e,e,i,e,e,t,t,t],[t,t,t,t,t,t,i,e,i,t,t,t,t,t,t]],0,[0,0],[0,0])}}]),n}(vae);pae.VERBOSE=!1,pae.NEIGHBOORS_TILES_DIRECTIONS=[new Xne(0,-2),new Xne(3,-1),new Xne(3,1),new Xne(0,2),new Xne(-3,1),new Xne(-3,-1)],pae.isInRange=function(e){return e.isInRange(15,10)};var gae=function(){var e=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"applyLegalMove",value:function(e,t,n){return e.isTileExchange()?this.applyLegalTileExchange(e,t):this.applyLegalMovement(e,t)}},{key:"applyLegalTileExchange",value:function(e,t){var r=t.getCopiedBoard(),i=e.capture.get();r[i.y][i.x]=cre.EMPTY;var a=[t.captures[0],t.captures[1]];a[t.getCurrentPlayer().value]+=1;var o=[t.tiles[0],t.tiles[1]];o[t.getCurrentPlayer().value]-=2;var s=new pae(r,t.turn,o,a),u=s.removeTilesIfNeeded(i,!1),c=new pae(u.getCopiedBoard(),u.turn+1,u.tiles,u.captures);return rB(n.VERBOSE,{coerceoRules_applyLegalTileExchange:{a_initialState:t,afterCapture:s,afterTileRemoval:u,resultingState:c}}),c}},{key:"applyLegalMovement",value:function(e,t){var r=t.applyLegalMovement(e),i=r.removeTilesIfNeeded(e.start.get(),!0),a=i.doMovementCaptures(e),o=new pae(a.board,t.turn+1,a.tiles,a.captures);return rB(n.VERBOSE,{ab_state:t,afterMovement:r,afterTilesRemoved:i,afterCaptures:a,resultingState:o}),o}},{key:"isLegal",value:function(e,t){return e.isTileExchange()?this.isLegalTileExchange(e,t):this.isLegalMovement(e,t)}},{key:"isLegalTileExchange",value:function(e,t){if(t.tiles[t.getCurrentPlayer().value]<2)return j5.failure(lae.NOT_ENOUGH_TILES_TO_EXCHANGE());var n=t.getPieceAt(e.capture.get());return n===cre.NONE||n===cre.EMPTY?j5.failure(lae.CANNOT_CAPTURE_FROM_EMPTY()):n.is(t.getCurrentPlayer())?j5.failure(lae.CANNOT_CAPTURE_OWN_PIECES()):j5.success(void 0)}},{key:"isLegalMovement",value:function(e,t){if(t.getPieceAt(e.start.get())===cre.NONE){var n="Cannot start with a coord outside the board "+e.start.get().toString()+".";return j5.failure(n)}if(t.getPieceAt(e.landingCoord.get())===cre.NONE){var r="Cannot end with a coord outside the board "+e.landingCoord.get().toString()+".";return j5.failure(r)}var i=t.getPieceAt(e.start.get());return i===cre.EMPTY?j5.failure(pre.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):i.is(t.getCurrentOpponent())?j5.failure(pre.CANNOT_CHOOSE_OPPONENT_PIECE()):t.getPieceAt(e.landingCoord.get()).is(t.getCurrentPlayer())?j5.failure(pre.MUST_LAND_ON_EMPTY_SPACE()):j5.success(void 0)}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"getGameStatus",value:function(e){var t=e.gameState;return t.captures[0]>=18?Are.ZERO_WON:t.captures[1]>=18?Are.ONE_WON:Are.ONGOING}}]),n}(Rre);return e.VERBOSE=!1,e}(),yae=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"getListMoves",value:function(e){var t=this.getListExchanges(e);return t=t.concat(this.getListMovement(e)),this.putCaptureFirst(e,t)}},{key:"getListExchanges",value:function(e){var t=[],n=e.gameState,r=n.getCurrentPlayer().value,i=cre.ofPlayer(n.getCurrentOpponent());if(n.tiles[r]<2)return t;for(var a=0;a<10;a++)for(var o=0;o<15;o++){var s=new ire(o,a);if(n.getPieceAt(s)===i){var u=fae.fromTilesExchange(s);t.push(u)}}return t}},{key:"getListMovement",value:function(e){for(var t=[],n=e.gameState,r=n.getCurrentPlayer(),i=0;i<10;i++)for(var a=0;a<15;a++){var o=new ire(a,i);if(n.getPieceAt(o).is(r)){var s,u=Qv(n.getLegalLandings(o));try{for(u.s();!(s=u.n()).done;){var c=s.value,l=fae.fromCoordToCoord(o,c);t.push(l)}}catch(h){u.e(h)}finally{u.f()}}}return t}},{key:"getBoardValue",value:function(e){var t=gae.getGameStatus(e);if(t.isEndGame)return yre.fromWinner(t.winner);var n=e.gameState,r=n.getPiecesByFreedom(),i=this.getPiecesScore(r);return new yre(2*n.captures[1]+i[1]-(2*n.captures[0]+i[0]))}},{key:"getPiecesScore",value:function(e){return[this.getPlayerPiecesScore(e[0]),this.getPlayerPiecesScore(e[1])]}},{key:"getPlayerPiecesScore",value:function(e){return 3*e[0]+1*e[1]+3*e[2]+3*e[3]}},{key:"putCaptureFirst",value:function(e,t){var n=this;return ite.sortByDescending(t,function(t){return n.moveCapturesList(e,t).length}),t}},{key:"moveCapturesList",value:function(e,t){return t.isTileExchange()?[t.capture.get()]:e.gameState.applyLegalMovement(t).removeTilesIfNeeded(t.start.get(),!0).getCapturedNeighbors(t.landingCoord.get())}}]),n}(gre),mae=function(){var e=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"getBoardValue",value:function(e){var t=gae.getGameStatus(e);if(t.isEndGame)return yre.fromWinner(t.winner);for(var r=e.gameState,i=this.getPiecesMap(r),a=this.getThreatMap(r,i),o=this.filterThreatMap(a,r),s=0,u=0,c=[ete.ZERO,ete.ONE];u<c.length;u++){var l,h=c[u],f=Qv(i.get(h).get());try{for(f.s();!(l=f.n()).done;){var d=l.value;o.get(d).isPresent()?s+=h.getScoreModifier()*n.SCORE_BY_THREATENED_PIECE:s+=h.getScoreModifier()*n.SCORE_BY_SAFE_PIECE}}catch(v){f.e(v)}finally{f.f()}}return s+=r.tiles[1]-r.tiles[0],new yre(s)}},{key:"getPiecesMap",value:function(e){for(var t=new Ore,n=[],r=[],i=0;i<10;i++)for(var a=0;a<15;a++){var o=new ire(a,i),s=e.getPieceAt(o);s===cre.ZERO?n.push(o):s===cre.ONE&&r.push(o)}return t.set(ete.ZERO,new Hie(n)),t.set(ete.ONE,new Hie(r)),t}},{key:"getThreatMap",value:function(e,t){for(var n=new Ore,r=0,i=[ete.ZERO,ete.ONE];r<i.length;r++){var a,o=i[r],s=Qv(t.get(o).get());try{for(s.s();!(a=s.n()).done;){var u=a.value,c=this.getThreat(u,e);c.isPresent()&&n.set(u,c.get())}}catch(l){s.e(l)}finally{s.f()}}return n}},{key:"getThreat",value:function(e,t){var n,r=ete.of(t.getPieceAt(e).value).getOpponent(),i=sB.empty(),a=[],o=Qv(dae.getNeighbors(e).filter(function(e){return e.isInRange(15,10)}));try{for(o.s();!(n=o.n()).done;){var s=n.value,u=t.getPieceAt(s);if(u.is(r))a.push(s);else if(u===cre.EMPTY){if(i.isPresent())return sB.empty();i=sB.of(s)}}}catch(d){o.e(d)}finally{o.f()}if(i.isPresent()){var c,l=[],h=Qv(hae.STEPS);try{var f=function(){var e=c.value,n=i.get().getNext(e.direction,1);n.isInRange(15,10)&&t.getPieceAt(n).is(r)&&a.every(function(e){return!1===e.equals(n)})&&l.push(n)};for(h.s();!(c=h.n()).done;)f()}catch(d){h.e(d)}finally{h.f()}if(l.length>0)return sB.of(new Uie(new Hie(a),new Hie(l)))}return sB.empty()}},{key:"filterThreatMap",value:function(e,t){var n,r=new Ore,i=e.listKeys(),a=i.filter(function(e){return t.getPieceAt(e).is(t.getCurrentPlayer())}),o=new Hie(i.filter(function(e){return t.getPieceAt(e).is(t.getCurrentOpponent())})),s=Qv(a);try{for(s.s();!(n=s.n()).done;){var u=n.value,c=e.get(u).get();X5(1===c.directThreats.size(),"oldThreat must contain exactly one direct threat");var l=c.directThreats.getAnyElement().get(),h=sB.empty();if(!1===o.contains(l)){var f,d=[],v=Qv(c.mover);try{for(v.s();!(f=v.n()).done;){var p=f.value;!1===o.contains(p)&&d.push(p)}}catch(_){v.e(_)}finally{v.f()}d.length>0&&(h=sB.of(new Uie(c.directThreats,new Hie(d))))}h.isPresent()&&r.set(u,h.get())}}catch(_){s.e(_)}finally{s.f()}var g,y=Qv(o);try{for(y.s();!(g=y.n()).done;){var m=g.value,k=e.get(m).get();r.set(m,k)}}catch(_){y.e(_)}finally{y.f()}return r}}]),n}(yae);return e.SCORE_BY_THREATENED_PIECE=1e3,e.SCORE_BY_SAFE_PIECE=1e6,e}(),kae=cre.EMPTY,_ae=cre.NONE,wae=cre.ZERO,Cae=cre.ONE,bae=rp(function e(){tp(this,e),this.tutorial=[Lre.informational($localize(Tt||(Tt=Rv(["Board and goal of the game"]))),$localize(It||(It=Rv(["Coerceo is played on a board like this, composed of hexagonal tiles, each comprising 6 triangles.\n         The triangles are the spaces on which pieces move during the game.\n         The tiles can be removed from the board (you will see how later).\n         The dark pieces belong to the first player and can only move on the dark spaces,\n         while the light pieces belong to the second player and can only move on the light spaces.\n         The goal of the game is to capture all of the opponent's pieces."]))),pae.getInitialState()),Lre.anyMove($localize(xt||(xt=Rv(["Move"]))),$localize(At||(At=Rv(["To move a piece, you need to:\n        <ol>\n          <li>Click on one of your pieces.</li>\n          <li>Click on one of the triangular space highlighted in yellow.</li>\n        </ol>\n        You can pass through the opponent's pieces.\n        You're playing first, hence you're playing Dark.<br/><br/>\n        Perform any move."]))),pae.getInitialState(),fae.fromCoordToCoord(new ire(3,5),new ire(5,5)),$localize(Rt||(Rt=Rv(["Congratulations! Let's see captures now."])))),Lre.fromMove($localize(Nt||(Nt=Rv(["Capture"]))),$localize(Mt||(Mt=Rv(["Every piece has three neighboring triangular spaces (2 on the sides).\n        When all neighboring spaces except one are occupied, and one opponent moves to that last free space, your piece is captured!\n        However, it is possible to place a piece between 3 of the opponent's pieces (or 2 on the side) without being captured.<br/><br/>\n        You're playing Light, make a capture."]))),new pae([[_ae,_ae,_ae,_ae,_ae,_ae,wae,kae,wae,_ae,_ae,_ae,_ae,_ae,_ae],[_ae,_ae,_ae,wae,kae,kae,kae,kae,kae,wae,kae,kae,_ae,_ae,_ae],[kae,Cae,kae,Cae,wae,Cae,kae,kae,wae,kae,kae,Cae,kae,Cae,kae],[Cae,kae,kae,kae,kae,kae,kae,kae,kae,kae,Cae,kae,kae,kae,Cae],[kae,Cae,kae,Cae,kae,kae,kae,kae,kae,kae,kae,Cae,kae,Cae,kae],[kae,wae,kae,wae,kae,kae,kae,kae,kae,kae,kae,wae,kae,wae,kae],[wae,kae,kae,kae,wae,kae,kae,kae,kae,kae,wae,kae,kae,kae,wae],[kae,wae,kae,wae,kae,kae,Cae,kae,Cae,kae,kae,wae,kae,wae,kae],[_ae,_ae,_ae,kae,kae,Cae,kae,kae,kae,Cae,kae,kae,_ae,_ae,_ae],[_ae,_ae,_ae,_ae,_ae,_ae,Cae,kae,Cae,_ae,_ae,_ae,_ae,_ae,_ae]],3,[0,0],[0,0]),[fae.fromCoordToCoord(new ire(5,2),new ire(4,1)),fae.fromCoordToCoord(new ire(3,4),new ire(4,3))],$localize(Dt||(Dt=Rv(["Congratulations!"]))),$localize(Lt||(Lt=Rv(["Failed, you have not captured any piece."])))),Lre.fromMove($localize(Ft||(Ft=Rv(["Gain a tile"]))),$localize(Bt||(Bt=Rv(["When a tile is empty, it can become removable from the board.\n        For it to be removable, at least three of its sides must be free, and these should be neighboring sides.\n        Note that if one empty tile, neighboring a tile that was just removed, also becomes removable, it will be removed too.\n        For example, here, the topmost dark piece will not disconnect its tile when leaving it.\n        But, by leaving the bottom left tile, two tiles will be removed.<br/><br/>\n        Perform a move that lets you gain two tiles."]))),new pae([[_ae,_ae,_ae,_ae,_ae,_ae,kae,kae,kae,_ae,_ae,_ae,_ae,_ae,_ae],[_ae,_ae,_ae,_ae,_ae,_ae,Cae,kae,kae,_ae,_ae,_ae,_ae,_ae,_ae],[kae,kae,kae,_ae,_ae,_ae,kae,kae,kae,_ae,_ae,_ae,_ae,_ae,_ae],[kae,kae,Cae,kae,kae,kae,kae,wae,kae,_ae,_ae,_ae,_ae,_ae,_ae],[kae,kae,kae,Cae,kae,kae,kae,kae,kae,_ae,_ae,_ae,_ae,_ae,_ae],[kae,kae,kae,kae,kae,kae,kae,kae,kae,kae,kae,wae,_ae,_ae,_ae],[kae,kae,wae,kae,kae,Cae,kae,kae,kae,kae,wae,kae,kae,kae,wae],[kae,kae,kae,kae,kae,kae,Cae,kae,Cae,kae,kae,wae,kae,wae,kae],[_ae,_ae,_ae,kae,kae,Cae,kae,kae,kae,Cae,kae,kae,_ae,_ae,_ae],[_ae,_ae,_ae,_ae,_ae,_ae,Cae,kae,Cae,_ae,_ae,_ae,_ae,_ae,_ae]],2,[0,0],[0,0]),[fae.fromCoordToCoord(new ire(2,6),new ire(4,6)),fae.fromCoordToCoord(new ire(2,6),new ire(3,5)),fae.fromCoordToCoord(new ire(2,6),new ire(3,7))],$localize(Vt||(Vt=Rv(["Congratulations!"]))),$localize(Ut||(Ut=Rv(["Failed, you have not gained the two tiles that you could, try again!"])))),Lre.fromMove($localize(zt||(zt=Rv(["Exchanging a tile"]))),$localize(Ht||(Ht=Rv(["When you have a tile, you can see it on the left of the board.\n        As soon as you have two, you can click on an opponent's piece to capture it immediately instead of moving one of your pieces.\n        This will cost you two tiles.\n        If any tiles are removed during that turn, nobody will get them.<br/><br/>\n        Gain some time and capture the last piece!"]))),new pae([[_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae],[_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae],[_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae],[_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae],[_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae],[_ae,_ae,_ae,kae,kae,wae,_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae],[_ae,_ae,_ae,kae,kae,kae,kae,kae,kae,_ae,_ae,_ae,_ae,_ae,_ae],[_ae,_ae,_ae,kae,kae,kae,Cae,kae,Cae,_ae,_ae,_ae,_ae,_ae,_ae],[_ae,_ae,_ae,kae,kae,Cae,kae,kae,kae,_ae,_ae,_ae,_ae,_ae,_ae],[_ae,_ae,_ae,_ae,_ae,_ae,Cae,kae,Cae,_ae,_ae,_ae,_ae,_ae,_ae]],1,[0,2],[0,0]),[fae.fromTilesExchange(new ire(5,5))],$localize(Gt||(Gt=Rv(["Congratulations!"]))),$localize(qt||(qt=Rv(["It's nice to move a piece, but you could have had the opponent's piece immediately by clicking on it!"])))),Lre.fromMove($localize($t||($t=Rv(["Special capture"]))),$localize(Wt||(Wt=Rv(["When a tile is removed from the board during your turn, some of the opponent's pieces may have lost their last free neighboring space, they will therefore be captured!\n        If this happens to one of your piece during your turn, it will however stay on the board.<br/><br/>\n        A move that demonstrate both of these things can be done on this board by Light. Try it!"]))),new pae([[_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae],[_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae],[_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae],[_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae],[_ae,_ae,_ae,_ae,_ae,_ae,kae,kae,wae,_ae,_ae,_ae,_ae,_ae,_ae],[_ae,_ae,_ae,kae,kae,wae,kae,kae,kae,_ae,_ae,_ae,_ae,_ae,_ae],[_ae,_ae,_ae,kae,wae,Cae,kae,Cae,kae,_ae,_ae,_ae,_ae,_ae,_ae],[_ae,_ae,_ae,kae,Cae,wae,kae,kae,kae,_ae,_ae,_ae,_ae,_ae,_ae],[_ae,_ae,_ae,kae,kae,Cae,_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae],[_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae,_ae]],1,[0,0],[0,0]),[fae.fromCoordToCoord(new ire(7,6),new ire(6,5)),fae.fromCoordToCoord(new ire(7,6),new ire(8,5))],$localize(jt||(jt=Rv(["Congratulations! See, your piece no longer had any empty neighboring space after you have gained the tile, but it stayed on the board as it was your turn.\n        However, the opponent's piece has disappeared because the tile's capture has removed its last empty neighboring space."]))),$localize(Zt||(Zt=Rv(["Failed!"]))))]});function Eae(e,t){if(1&e&&(_m(),fb(0,"polygon",13)),2&e){var n=wb().index,r=wb().index,i=wb();ub("ngClass",i.getPyramidClass(n,r)),tb("points",i.getPyramidCoordinate(n,r))}}function Sae(e,t){if(1&e&&(_m(),fb(0,"polygon",15)),2&e){var n=wb(2).index,r=wb().index,i=wb();ub("ngClass",i.getEmptyClass(n,r)),tb("points",i.getTriangleCoordinate(n,r))}}function Pae(e,t){if(1&e&&(_m(),ab(0,Sae,1,2,"polygon",14)),2&e){var n=wb().index,r=wb().index;ub("ngIf",wb().isEmptyCase(n,r))}}function Oae(e,t){if(1&e&&(_m(),fb(0,"polygon",16)),2&e){var n=wb().index,r=wb().index,i=wb();bb("id","dark_line_",n,"_",r,""),tb("points",i.getLineCoordinate(n,r))}}function Tae(e,t){if(1&e&&(_m(),fb(0,"polygon",17)),2&e){var n=wb().index,r=wb().index,i=wb();bb("id","dark_line_",n,"_",r,""),tb("points",i.getLineCoordinate(n,r))}}function Iae(e,t){if(1&e){var n=pb();_m(),lb(0,"g",8),mb("click",function(){var e=$y(n).index,t=wb().index;return wb().onClick(e,t)}),ab(1,Eae,1,2,"polygon",9),ab(2,Pae,1,1,"ng-template",null,10,OP),ab(4,Oae,1,3,"polygon",11),ab(5,Tae,1,3,"polygon",12),hb()}if(2&e){var r=t.$implicit,i=t.index,a=ob(3),o=wb().index,s=wb();bb("id","click_",i,"_",o,""),Pw(1),ub("ngIf",s.isPyramid(i,o))("ngIfElse",a),Pw(3),ub("ngIf",r!==s.NONE),Pw(1),ub("ngIf",r!==s.NONE)}}function xae(e,t){if(1&e&&(_m(),lb(0,"g"),ab(1,Iae,6,6,"g",7),hb()),2&e){var n=t.$implicit;Pw(1),ub("ngForOf",n)}}function Aae(e,t){if(1&e&&(_m(),fb(0,"polygon",18)),2&e){var n=t.$implicit;tb("points",wb().getTriangleCoordinate(n.x,n.y))}}function Rae(e,t){if(1&e&&(_m(),fb(0,"polygon",19)),2&e){var n=wb();tb("points",n.getTriangleCoordinate(n.lastStart.get().x,n.lastStart.get().y))}}function Nae(e,t){if(1&e&&(_m(),fb(0,"polygon",19)),2&e){var n=wb();tb("points",n.getTriangleCoordinate(n.lastEnd.get().x,n.lastEnd.get().y))}}function Mae(e,t){if(1&e&&(_m(),fb(0,"polygon",20)),2&e){var n=wb();tb("points",n.getTriangleCoordinate(n.chosenCoord.get().x,n.chosenCoord.get().y))}}function Dae(e,t){if(1&e&&(_m(),lb(0,"g",21),fb(1,"polygon",22),lb(2,"text",23),Rb(3),hb(),hb()),2&e){var n=wb();Pw(1),tb("points",n.getTilesCountCoordinate(0,0))("stroke",n.lastTurnWasTilesExchange(0)?"yellow":"black"),Pw(1),tb("x",n.SPACE_SIZE/2+0*n.SPACE_SIZE)("y",16+n.SPACE_SIZE/2+0*n.SPACE_SIZE)("font-size",n.SPACE_SIZE/2),Pw(1),Nb(n.tiles[0])}}function Lae(e,t){if(1&e&&(_m(),lb(0,"g",24),fb(1,"polygon",25),lb(2,"text",26),Rb(3),hb(),hb()),2&e){var n=wb();Pw(1),tb("points",n.getTilesCountCoordinate(0,9))("stroke",n.lastTurnWasTilesExchange(1)?"yellow":"black"),Pw(1),tb("x",n.SPACE_SIZE/2+0*n.SPACE_SIZE)("y",16+n.SPACE_SIZE/2+9*n.SPACE_SIZE)("font-size",n.SPACE_SIZE/2),Pw(1),Nb(n.tiles[1])}}var Fae=function(){var e=function(e){Gv(n,e);var t=$v(n);function n(e){var r;return tp(this,n),(r=t.call(this,e)).tiles=[0,0],r.NONE=cre.NONE,r.chosenCoord=sB.empty(),r.lastStart=sB.empty(),r.lastEnd=sB.empty(),r.highlights=[],r.scores=sB.of([0,0]),r.rules=new gae(pae),r.availableMinimaxes=[new yae(r.rules,"Normal"),new mae(r.rules,"Piece > Threat > Tiles")],r.encoder=fae.encoder,r.tutorial=(new bae).tutorial,r.SPACE_SIZE=70,r.updateBoard(),r}return rp(n,[{key:"updateBoard",value:function(){this.chosenCoord=sB.empty(),this.state=this.rules.node.gameState,this.scores=sB.of(this.state.captures),this.tiles=this.state.tiles;var e=this.rules.node.move;e.isPresent()?(this.lastStart=e.get().start,this.lastEnd=e.get().landingCoord):(this.lastStart=sB.empty(),this.lastEnd=sB.empty()),this.board=this.rules.node.gameState.board}},{key:"showHighlight",value:function(){this.highlights=this.state.getLegalLandings(this.chosenCoord.get())}},{key:"cancelMoveAttempt",value:function(){this.chosenCoord=sB.empty(),this.highlights=[]}},{key:"onClick",value:function(e,t){var n=this;return tB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:return a=new ire(e,t),r.abrupt("return",n.chosenCoord.isAbsent()?n.firstClick(a):n.secondClick(a));case 5:case"end":return r.stop()}},r)}))()}},{key:"firstClick",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.state.getPieceAt(e)).is(t.state.getCurrentOpponent())){n.next=4;break}return i=fae.fromTilesExchange(e),n.abrupt("return",t.chooseMove(i,t.state,t.state.captures));case 4:return n.abrupt("return",r.is(t.state.getCurrentPlayer())?(t.chosenCoord=sB.of(e),t.showHighlight(),K5.SUCCESS):t.cancelMove(lae.FIRST_CLICK_SHOULD_NOT_BE_NULL()));case 5:case"end":return n.stop()}},n)}))()}},{key:"secondClick",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!e.equals(t.chosenCoord.get())){n.next=2;break}return n.abrupt("return",(t.cancelMoveAttempt(),K5.SUCCESS));case 2:if(!t.highlights.some(function(t){return t.equals(e)})){n.next=5;break}return r=fae.fromCoordToCoord(t.chosenCoord.get(),e),n.abrupt("return",t.chooseMove(r,t.state,t.state.captures));case 5:return n.abrupt("return",t.cancelMove(lae.INVALID_DISTANCE()));case 6:case"end":return n.stop()}},n)}))()}},{key:"isPyramid",value:function(e,t){return this.board[t][e].isPlayer()||this.wasOpponent(e,t)}},{key:"wasOpponent",value:function(e,t){var n=this.rules.node.mother;return n.isPresent()&&n.get().gameState.getPieceAtXY(e,t).is(n.get().gameState.getCurrentOpponent())}},{key:"getPyramidClass",value:function(e,t){var n=this.board[t][e];return n===cre.ZERO?this.getPlayerClass(ete.ZERO):n===cre.ONE?this.getPlayerClass(ete.ONE):"captured"}},{key:"isEmptyCase",value:function(e,t){return this.board[t][e]===cre.EMPTY||this.wasRemoved(e,t)}},{key:"wasRemoved",value:function(e,t){var n=this.rules.node.mother;if(this.board[t][e]===cre.NONE&&n.isPresent()){var r=n.get().gameState.getPieceAtXY(e,t);return r===cre.EMPTY||r.is(n.get().gameState.getCurrentPlayer())}return!1}},{key:"getEmptyClass",value:function(e,t){return this.board[t][e]===cre.EMPTY?(e+t)%2==1?"background":"background2":"captured2"}},{key:"getTilesCountCoordinate",value:function(e,t){var n=100*e,r=100*t,i=n+25;return i+", "+r+", "+(n+75)+", "+r+", "+(n+100)+", "+(r+50)+", "+(n+75)+", "+(r+100)+", "+(n+25)+", "+(r+100)+", "+(n+0)+", "+(r+50)+", "+i+", "+r}},{key:"getLineCoordinate",value:function(e,t){var n=this.getTriangleCornerCoords(e,t);return e%3==0?n[0].x+","+n[0].y+","+n[1].x+","+n[1].y:e%3==1?n[0].x+","+n[0].y+","+n[2].x+","+n[2].y:n[1].x+","+n[1].y+","+n[2].x+","+n[2].y}},{key:"mustShowTilesOf",value:function(e){return this.tiles[e]>0||this.lastTurnWasTilesExchange(e)}},{key:"lastTurnWasTilesExchange",value:function(e){return!this.rules.node.mother.isAbsent()&&this.rules.node.mother.get().gameState.tiles[e]>this.tiles[e]}}]),n}(cae);return e.\u0275fac=function(t){return new(t||e)(sb(ore))},e.\u0275cmp=ey({type:e,selectors:[["app-coerceo"]],features:[zC],decls:8,vars:8,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base no-fill highlighted",4,"ngFor","ngForOf"],["class","base no-fill last-move",4,"ngIf"],["class","base no-fill selected",4,"ngIf"],["id","tilesCountZero",4,"ngIf"],["id","tilesCountOne",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["class","base mid-stroke","stroke-linecap","round",3,"ngClass",4,"ngIf","ngIfElse"],["emptyCase",""],["class","base",3,"id",4,"ngIf"],["class","white-stroke",3,"id",4,"ngIf"],["stroke-linecap","round",1,"base","mid-stroke",3,"ngClass"],["class","base small-stroke","stroke-linecap","round",3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base","small-stroke",3,"ngClass"],[1,"base",3,"id"],[1,"white-stroke",3,"id"],[1,"base","no-fill","highlighted"],[1,"base","no-fill","last-move"],[1,"base","no-fill","selected"],["id","tilesCountZero"],["stroke-linecap","round",1,"base","player0"],["id","playerZeroTilesCount","text-anchor","middle",1,"text"],["id","tilesCountOne"],["stroke-linecap","round",1,"base","player1"],["id","playerOneTilesCount","text-anchor","middle",1,"text"]],template:function(e,t){1&e&&(_m(),lb(0,"svg",0),ab(1,xae,2,1,"g",1),ab(2,Aae,1,1,"polygon",2),ab(3,Rae,1,1,"polygon",3),ab(4,Nae,1,1,"polygon",3),ab(5,Mae,1,1,"polygon",4),ab(6,Dae,4,6,"g",5),ab(7,Lae,4,6,"g",6),hb()),2&e&&(tb("viewBox","-5 -5 "+(10+8*t.SPACE_SIZE)+" "+(10+10*t.SPACE_SIZE)),Pw(1),ub("ngForOf",t.board),Pw(1),ub("ngForOf",t.highlights),Pw(1),ub("ngIf",t.lastStart.isPresent()),Pw(1),ub("ngIf",t.lastEnd.isPresent()),Pw(1),ub("ngIf",t.chosenCoord.isPresent()),Pw(1),ub("ngIf",t.mustShowTilesOf(0)),Pw(1),ub("ngIf",t.mustShowTilesOf(1)))},directives:[AT,NT,IT],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Bae=function(){var e=rp(function e(){tp(this,e)});return e.SIMPLE_MOVE_SHOULD_BE_OF_ONE_STEP=function(){return $localize(Yt||(Yt=Rv(["Your piece should land on a neighboring square."])))},e.CANNOT_DROP_AFTER_TURN_40=function(){return $localize(Kt||(Kt=Rv(["You cannot drop a piece during the moving phase."])))},e.CANNOT_MOVE_BEFORE_TURN_40=function(){return $localize(Jt||(Jt=Rv(["You cannot move a piece before both players have dropped all of their pieces."])))},e.MUST_JUMP_OVER_PIECES=function(){return $localize(Qt||(Qt=Rv(["A jump must be made over a piece, not over an empty square."])))},e.MUST_DROP_IN_CENTRAL_ZONE=function(){return $localize(Xt||(Xt=Rv(["A drop must occur in the central zone of the board."])))},e.INVALID_JUMP=function(){return $localize(en||(en=Rv(["A jump must land two squares from its original position, and be done in a straight line in any direction."])))},e.SAME_LOCATION_VISITED_IN_JUMP=function(){return $localize(tn||(tn=Rv(["You are visiting the same location twice in a move, you are not allowed to do so."])))},e}(),Vae=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"isShelter",value:function(e){return 0===e.x||e.x===n.WIDTH-1?n.SHELTERS_INDICES.some(function(t){return e.y===t}):(0===e.y||e.y===n.HEIGHT-1)&&n.SHELTERS_INDICES.some(function(t){return e.x===t})}},{key:"isCentralZone",value:function(e){return e.x>=n.CENTRAL_ZONE_TOP_LEFT.x&&e.x<=n.CENTRAL_ZONE_BOTTOM_RIGHT.x&&e.y>=n.CENTRAL_ZONE_TOP_LEFT.y&&e.y<=n.CENTRAL_ZONE_BOTTOM_RIGHT.y}},{key:"isDropPhase",value:function(){return this.turn<40}},{key:"getSidePieces",value:function(){return this.turn%2==0?[20-this.turn/2,20-this.turn/2]:[20-(this.turn-1)/2-1,20-(this.turn-1)/2]}}],[{key:"getInitialState",value:function(){return new n(ite.createTable(n.WIDTH,n.HEIGHT,Xee.NONE),0)}}]),n}(wre);Vae.WIDTH=17,Vae.HEIGHT=17,Vae.CENTRAL_ZONE_TOP_LEFT=new ire(4,6),Vae.CENTRAL_ZONE_BOTTOM_RIGHT=new ire(12,10),Vae.SHELTERS_INDICES=[0,1,3,5,7,8,9,11,13,15,16],Vae.ALL_SHELTERS=new kre(Vae.SHELTERS_INDICES.flatMap(function(e){return[new ire(e,0),new ire(e,Vae.HEIGHT-1),new ire(0,e),new ire(Vae.WIDTH-1,e)]})).toList();var Uae=function(e){Gv(n,e);var t=$v(n);function n(e){return tp(this,n),t.call(this,e.x,e.y)}return rp(n,[{key:"toString",value:function(){return"ConspirateursMoveDrop(".concat(this.coord.toString(),")")}},{key:"equals",value:function(e){return!!e.isDrop()&&this.coord.equals(e.coord)}},{key:"isDrop",value:function(){return!0}},{key:"isSimple",value:function(){return!1}},{key:"isJump",value:function(){return!1}}],[{key:"of",value:function(e){return e.isInRange(Vae.WIDTH,Vae.HEIGHT)?j5.success(new n(e)):j5.failure("Move out of board")}}]),n}(Ere);Uae.encoder=function(){function e(){tp(this,e)}return rp(e,null,[{key:"getEncoder",value:function(e,t,n){return new(function(r){Gv(a,r);var i=$v(a);function a(){var e;return tp(this,a),(e=i.apply(this,arguments)).shiftX=t,e}return rp(a,[{key:"maxValue",value:function(){return(e-1)*this.shiftX+(t-1)}},{key:"encodeNumber",value:function(e){return e.coord.x*this.shiftX+e.coord.y}},{key:"decodeNumber",value:function(r){var i=r%t;r/=t;var a=new ire((r-=r%1)%e,i);return n(a)}}]),a}(Jee))}}]),e}().getEncoder(Vae.WIDTH,Vae.HEIGHT,function(e){return Uae.of(e).get()});var zae=function(e){Gv(n,e);var t=$v(n);function n(e,r){return tp(this,n),t.call(this,e,r)}return rp(n,[{key:"toString",value:function(){return"ConspirateursMoveSimple(".concat(this.coord.toString()," -> ").concat(this.end.toString(),")")}},{key:"equals",value:function(e){return!(!e.isSimple()||e!==this&&(!1===e.coord.equals(this.coord)||!1===e.end.equals(this.end)))}},{key:"isDrop",value:function(){return!1}},{key:"isSimple",value:function(){return!0}},{key:"isJump",value:function(){return!1}}],[{key:"of",value:function(e,t){return e.isInRange(Vae.WIDTH,Vae.HEIGHT)&&t.isInRange(Vae.WIDTH,Vae.HEIGHT)?e.isAlignedWith(t)&&1===e.getDistance(t)?j5.success(new n(e,t)):j5.failure(Bae.SIMPLE_MOVE_SHOULD_BE_OF_ONE_STEP()):j5.failure("Move out of board")}}]),n}(Oie);zae.encoder=Oie.getEncoder(Vae.WIDTH,Vae.HEIGHT,function(e,t){return zae.of(e,t).get()});var Hae=function(e){Gv(n,e);var t=$v(n);function n(e){var r;return tp(this,n),(r=t.call(this)).coords=e,r}return rp(n,[{key:"addJump",value:function(e){var t=ite.copyImmutableArray(this.coords);return t.push(e),n.of(t)}},{key:"getStartingCoord",value:function(){return this.coords[0]}},{key:"getEndingCoord",value:function(){return this.coords[this.coords.length-1]}},{key:"getLandingCoords",value:function(){return this.coords.slice(1)}},{key:"getJumpedOverCoords",value:function(){for(var e=[],t=1;t<this.coords.length;t++){var n=this.coords[t-1].getDirectionToward(this.coords[t]).get();e.push(this.coords[t-1].getNext(n,1))}return e}},{key:"toString",value:function(){return"ConspirateursMoveJump(".concat(this.coords.map(function(e){return e.toString()}).reduce(function(e,t){return e+" -> "+t}),")")}},{key:"equals",value:function(e){return!(e.isSimple()||e.isDrop()||e!==this&&(!1===this.getStartingCoord().equals(e.getStartingCoord())||!1===this.getEndingCoord().equals(e.getEndingCoord())))}},{key:"isDrop",value:function(){return!1}},{key:"isSimple",value:function(){return!1}},{key:"isJump",value:function(){return!0}}],[{key:"of",value:function(e){if(e.length<2)return j5.failure("ConspirateursMoveJump requires at least one jump, so two coords");var t,r=Qv(e);try{for(r.s();!(t=r.n()).done;){if(t.value.isNotInRange(Vae.WIDTH,Vae.HEIGHT))return j5.failure("Move out of board")}}catch(a){r.e(a)}finally{r.f()}for(var i=1;i<e.length;i++)if(e[i-1].getDirectionToward(e[i]).isFailure()||2!==e[i-1].getDistance(e[i]))return j5.failure(Bae.INVALID_JUMP());return new Hie(e).size()===e.length?j5.success(new n(e)):j5.failure(Bae.SAME_LOCATION_VISITED_IN_JUMP())}}]),n}(bre);Hae.encoder=new(function(e){Gv(n,e);var t=$v(n);function n(){var e;return tp(this,n),(e=t.apply(this,arguments)).coordEncoder=ire.numberEncoder(Vae.WIDTH,Vae.HEIGHT),e}return rp(n,[{key:"encodeMove",value:function(e){return{coords:e.coords.map(this.coordEncoder.encodeNumber)}}},{key:"decodeMove",value:function(e){X5(null!=nB.getNonNullable(e).coords,"Encoded ConspirateursMoveJump should contain coords");var t=nB.getNonNullable(e).coords.map(this.coordEncoder.decodeNumber);return Hae.of(t).get()}}]),n}(Kee));var Gae=Kee.disjunction3(Uae.encoder,zae.encoder,Hae.encoder,function(e){return e.isDrop()},function(e){return e.isSimple()}),qae=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.call(this,Vae)}return rp(n,[{key:"applyLegalMove",value:function(e,t,n){var r=t.getCopiedBoard();if(e.isDrop())r[e.coord.y][e.coord.x]=t.getCurrentPlayer();else if(e.isSimple())r[e.coord.y][e.coord.x]=Xee.NONE,r[e.end.y][e.end.x]=t.getCurrentPlayer();else{var i=e.getStartingCoord(),a=e.getEndingCoord();r[i.y][i.x]=Xee.NONE,r[a.y][a.x]=t.getCurrentPlayer()}return new Vae(r,t.turn+1)}},{key:"isLegal",value:function(e,t){return e.isDrop()?this.dropLegality(e,t):e.isSimple()?this.simpleMoveLegality(e,t):this.jumpLegality(e,t)}},{key:"dropLegality",value:function(e,t){return t.turn>=40?j5.failure(Bae.CANNOT_DROP_AFTER_TURN_40()):t.getPieceAt(e.coord).isPlayer()?j5.failure(pre.MUST_LAND_ON_EMPTY_SPACE()):!1===t.isCentralZone(e.coord)?j5.failure(Bae.MUST_DROP_IN_CENTRAL_ZONE()):j5.success(void 0)}},{key:"simpleMoveLegality",value:function(e,t){return t.turn<40?j5.failure(Bae.CANNOT_MOVE_BEFORE_TURN_40()):t.getPieceAt(e.coord)!==t.getCurrentPlayer()?j5.failure(pre.MUST_CHOOSE_PLAYER_PIECE()):t.getPieceAt(e.end).isPlayer()?j5.failure(pre.MUST_LAND_ON_EMPTY_SPACE()):j5.success(void 0)}},{key:"jumpLegality",value:function(e,t){if(t.turn<40)return j5.failure(Bae.CANNOT_MOVE_BEFORE_TURN_40());if(t.getPieceAt(e.getStartingCoord())!==t.getCurrentPlayer())return j5.failure(pre.MUST_CHOOSE_PLAYER_PIECE());var n,r=Qv(e.getJumpedOverCoords());try{for(r.s();!(n=r.n()).done;){var i=n.value;if(t.getPieceAt(i)===Xee.NONE)return j5.failure(Bae.MUST_JUMP_OVER_PIECES())}}catch(u){r.e(u)}finally{r.f()}var a,o=Qv(e.getLandingCoords());try{for(o.s();!(a=o.n()).done;){var s=a.value;if(t.getPieceAt(s).isPlayer())return j5.failure(pre.MUST_LAND_ON_EMPTY_SPACE())}}catch(u){o.e(u)}finally{o.f()}return j5.success(void 0)}},{key:"jumpTargetsFrom",value:function(e){for(var t=[],n=0,r=[new ire(e.x+2,e.y),new ire(e.x-2,e.y),new ire(e.x,e.y+2),new ire(e.x,e.y-2),new ire(e.x+2,e.y+2),new ire(e.x+2,e.y-2),new ire(e.x-2,e.y+2),new ire(e.x-2,e.y-2)];n<r.length;n++){var i=r[n];Hae.of([e,i]).isSuccess()&&t.push(i)}return t}},{key:"nextJumps",value:function(e,t){var n,r=e.getEndingCoord(),i=[],a=Qv(this.jumpTargetsFrom(r));try{for(a.s();!(n=a.n()).done;){var o=n.value,s=e.addJump(o);s.isSuccess()&&this.jumpLegality(s.get(),t).isSuccess()&&i.push(s.get())}}catch(u){a.e(u)}finally{a.f()}return i}},{key:"jumpHasPossibleNextTargets",value:function(e,t){return this.nextJumps(e,t).length>0}},{key:"getGameStatus",value:function(e){var t,n=e.gameState,r=[0,0],i=Qv(Vae.ALL_SHELTERS);try{for(i.s();!(t=i.n()).done;){var a=t.value,o=n.getPieceAt(a);if(o.isPlayer()&&(r[o.value]+=1,20===r[o.value]))return Are.getVictory(o)}}catch(s){i.e(s)}finally{i.f()}return Are.ONGOING}}],[{key:"get",value:function(){return n.singleton.isAbsent()&&(n.singleton=sB.of(new n)),n.singleton.get()}}]),n}(Rre);qae.singleton=sB.empty();var $ae=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"getListMoves",value:function(e){return e.gameState.turn<40?this.getListMovesDrop(e.gameState):this.getListMovesAfterDrop(e.gameState)}},{key:"getListMovesDrop",value:function(e){for(var t=[],n=Vae.CENTRAL_ZONE_TOP_LEFT,r=Vae.CENTRAL_ZONE_BOTTOM_RIGHT,i=n.y;i<=r.y;i++)for(var a=n.x;a<=r.x;a++)e.getPieceAtXY(a,i)===Xee.NONE&&t.push(Uae.of(new ire(a,i)).get());return t}},{key:"getListMovesAfterDrop",value:function(e){for(var t=[],n=e.getCurrentPlayer(),r=0;r<Vae.HEIGHT;r++)for(var i=0;i<Vae.WIDTH;i++){var a=new ire(i,r);e.getPieceAt(a)===n&&(t=(t=t.concat(this.getListSimpleMoves(e,a))).concat(this.getListJumps(e,a)))}return t}},{key:"getListSimpleMoves",value:function(e,t){for(var n=[],r=0,i=[new ire(t.x+1,t.y),new ire(t.x-1,t.y),new ire(t.x,t.y+1),new ire(t.x,t.y-1),new ire(t.x+1,t.y+1),new ire(t.x+1,t.y-1),new ire(t.x-1,t.y+1),new ire(t.x-1,t.y-1)];r<i.length;r++){var a=i[r],o=zae.of(t,a);o.isSuccess()&&qae.get().simpleMoveLegality(o.get(),e).isSuccess()&&n.push(o.get())}return n}},{key:"getListJumps",value:function(e,t){var n,r=new kre,i=Qv(qae.get().jumpTargetsFrom(t));try{for(i.s();!(n=i.n()).done;){var a=n.value,o=Hae.of([t,a]).get();qae.get().jumpLegality(o,e).isSuccess()&&(r.add(o),r.union(this.getListJumpStartingFrom(e,o)))}}catch(s){i.e(s)}finally{i.f()}return r.toList()}},{key:"getListJumpStartingFrom",value:function(e,t){var n,r=qae.get().nextJumps(t,e),i=new kre(r),a=Qv(r);try{for(a.s();!(n=a.n()).done;){var o=n.value;i.union(this.getListJumpStartingFrom(e,o))}}catch(s){a.e(s)}finally{a.f()}return i}},{key:"getBoardValue",value:function(e){var t=e.gameState,n=0,r=new Ore;r.set(ete.ZERO,0),r.set(ete.ONE,0);for(var i=0;i<Vae.HEIGHT;i++)for(var a=0;a<Vae.WIDTH;a++){var o=new ire(a,i),s=t.getPieceAt(o);if(s.isPlayer())if(t.isShelter(o)){if(n+=20*s.getScoreModifier(),r.replace(s,r.get(s).get()+1),20===r.get(s).get())return new yre(s.getVictoryValue())}else{var u,c=100,l=Qv(Vae.ALL_SHELTERS);try{for(l.s();!(u=l.n()).done;){var h=u.value;if(t.getPieceAt(h)===Xee.NONE){var f=o.getOrthogonalDistance(h);c=Math.min(c,f)}}}catch(d){l.e(d)}finally{l.f()}n-=s.getScoreModifier()*c}}return new yre(n)}}]),n}(gre),Wae=Xee.NONE,jae=ete.ZERO,Zae=ete.ONE,Yae=rp(function e(){tp(this,e),this.tutorial=[Lre.informational($localize(nn||(nn=Rv(["Board and aim of the game"]))),$localize(rn||(rn=Rv(["Conspirateurs is played on a 17x17 board. The goal of the game is to place all of your pieces in shelters, which are the special squares on the edge of the board. Note the central zone in the middle of the board, where each player will put their pieces initially."]))),Vae.getInitialState()),Lre.anyMove($localize(an||(an=Rv(["Initial phase"]))),$localize(on||(on=Rv(["In the initial phase of the game, each player drop their 20 pieces, one per turn consecutively, in the central zone of the board. This phase does not allow any other kind of move.<br/><br/>Drop one of your piece in the central zone."]))),Vae.getInitialState(),Uae.of(new ire(7,7)).get(),$localize(sn||(sn=Rv(["Congratulations!"])))),Lre.fromPredicate($localize(un||(un=Rv(["Simple move"]))),$localize(cn||(cn=Rv(["Once all pieces have been placed, there are two kind of moves that can be performed. The first is a simple move in any direction, orthogonally or diagonally, of a single step.<br/><br/>You're playing Dark. Click on one of your piece and perform such a move."]))),new Vae([[Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae],[Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae],[Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae],[Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae],[Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae],[Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae],[Wae,Wae,Wae,Wae,jae,jae,Zae,Zae,jae,jae,Zae,jae,Zae,Wae,Wae,Wae,Wae],[Wae,Wae,Wae,Wae,jae,Zae,jae,Zae,jae,jae,jae,jae,Zae,Wae,Wae,Wae,Wae],[Wae,Wae,Wae,Wae,jae,Zae,Wae,Wae,Wae,Wae,Wae,Zae,jae,Wae,Wae,Wae,Wae],[Wae,Wae,Wae,Wae,Zae,jae,jae,Zae,Zae,Zae,jae,jae,jae,Wae,Wae,Wae,Wae],[Wae,Wae,Wae,Wae,Zae,jae,Zae,Zae,Zae,Zae,Zae,Zae,jae,Wae,Wae,Wae,Wae],[Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae],[Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae],[Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae],[Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae],[Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae],[Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae]],40),zae.of(new ire(4,6),new ire(3,5)).get(),function(e,t){return e.isSimple()?K5.SUCCESS:K5.failure($localize(ln||(ln=Rv(["You have made a jump, not a simple move. Try again!"]))))},$localize(hn||(hn=Rv(["Congratulations!"])))),Lre.fromPredicate($localize(fn||(fn=Rv(["Jumps"]))),$localize(dn||(dn=Rv(["The other type of move is a jump. A piece can jump over a neighboring piece in any direction, as long as it lands directly on the square after that piece, along the same direction.<br/><br/>You're playing Dark. Perform a jump by clicking on one of your piece that can perform a jump, and then on the target square. You may need to click a second time on the target square to confirm your jump, in case your piece is still highlighted (we will see shortly why this is useful)."]))),new Vae([[Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae],[Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae],[Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae],[Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae],[Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae],[Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae],[Wae,Wae,Wae,Wae,jae,jae,Zae,Zae,jae,jae,Zae,jae,Zae,Wae,Wae,Wae,Wae],[Wae,Wae,Wae,Wae,jae,Zae,jae,Zae,jae,jae,jae,jae,Zae,Wae,Wae,Wae,Wae],[Wae,Wae,Wae,Wae,jae,Zae,Wae,Wae,Wae,Wae,Wae,Zae,jae,Wae,Wae,Wae,Wae],[Wae,Wae,Wae,Wae,Zae,jae,jae,Zae,Zae,Zae,jae,jae,jae,Wae,Wae,Wae,Wae],[Wae,Wae,Wae,Wae,Zae,jae,Zae,Zae,Zae,Zae,Zae,Zae,jae,Wae,Wae,Wae,Wae],[Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae],[Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae],[Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae],[Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae],[Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae],[Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae]],40),Hae.of([new ire(6,7),new ire(6,5)]).get(),function(e,t){return e.isJump()?K5.SUCCESS:K5.failure($localize(vn||(vn=Rv(["You have not performed a jump. Try again!"]))))},$localize(pn||(pn=Rv(["Congratulations!"])))),Lre.fromMove($localize(gn||(gn=Rv(["Chaining jumps in a single move"]))),$localize(yn||(yn=Rv(["Jumps can be chained when possible. You can decide whether to continue a jump or to stop it at any time. To finish your jump, click a second time on your current location. Otherwise, simply keep clicking on your next location. Once no more destination is possible, your move will end without you needing to click the piece a second time.<br/><br/>You're playing Dark and you can perform a triple jump! Do it."]))),new Vae([[Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae],[Wae,Wae,Wae,Wae,Wae,Wae,Zae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae],[Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae],[Wae,Wae,Wae,Wae,Wae,Wae,Zae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae],[Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae],[Wae,Wae,Wae,Wae,Wae,Wae,Wae,Zae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae],[Wae,Wae,Wae,Wae,jae,jae,Wae,Zae,jae,jae,Zae,jae,Zae,Wae,Wae,Wae,Wae],[Wae,Wae,Wae,Wae,jae,Wae,jae,Zae,jae,jae,jae,jae,Zae,Wae,Wae,Wae,Wae],[Wae,Wae,Wae,Wae,jae,Zae,Wae,Wae,Wae,Wae,Wae,Zae,jae,Wae,Wae,Wae,Wae],[Wae,Wae,Wae,Wae,Zae,jae,jae,Zae,Zae,Zae,jae,jae,jae,Wae,Wae,Wae,Wae],[Wae,Wae,Wae,Wae,Zae,jae,Zae,Zae,Zae,Zae,Zae,Zae,jae,Wae,Wae,Wae,Wae],[Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae],[Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae],[Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae],[Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae],[Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae],[Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae,Wae]],40),[Hae.of([new ire(8,6),new ire(6,4),new ire(6,2),new ire(6,0)]).get()],$localize(mn||(mn=Rv(["Congratulations! You now know everything to play the game. Remember: to win, you have to place all of your pieces in shelters before your opponent does."]))),$localize(kn||(kn=Rv(["You have not performed a triple jump. Try again!"]))))]});function Kae(e,t){if(1&e){var n=pb();_m(),lb(0,"rect",9),mb("click",function(){$y(n);var e=wb().$implicit;return wb(2).onClick(e.coord)}),hb()}if(2&e){var r=wb().$implicit,i=wb(2);tb("x",1.5*i.STROKE_WIDTH+i.SPACE_SIZE*r.coord.x+i.STROKE_WIDTH)("y",1.5*i.STROKE_WIDTH+i.SPACE_SIZE*r.coord.y+i.STROKE_WIDTH)("width",i.SPACE_SIZE-3*i.STROKE_WIDTH)("height",i.SPACE_SIZE-3*i.STROKE_WIDTH)}}function Jae(e,t){if(1&e){var n=pb();_m(),lb(0,"circle",6),mb("click",function(){$y(n);var e=wb().$implicit;return wb(2).onClick(e.coord)}),hb()}if(2&e){var r=wb(),i=r.index,a=r.$implicit,o=wb().index,s=wb();bb("id","piece_",i,"_",o,""),ub("ngClass",a.pieceClasses),tb("r",s.PIECE_RADIUS)("cx",s.SPACE_SIZE*i+s.STROKE_WIDTH+s.SPACE_SIZE/2)("cy",s.SPACE_SIZE*o+s.STROKE_WIDTH+s.SPACE_SIZE/2)}}function Qae(e,t){if(1&e){var n=pb();_m(),lb(0,"g"),lb(1,"rect",6),mb("click",function(){var e=$y(n).$implicit;return wb(2).onClick(e.coord)}),hb(),ab(2,Kae,1,4,"rect",7),ab(3,Jae,1,6,"circle",8),hb()}if(2&e){var r=t.$implicit,i=t.index,a=wb().index,o=wb();Pw(1),bb("id","click_",i,"_",a,""),ub("ngClass",r.squareClasses),tb("x",o.SPACE_SIZE*i+o.STROKE_WIDTH)("y",o.SPACE_SIZE*a+o.STROKE_WIDTH)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),Pw(1),ub("ngIf",r.isShelter),Pw(1),ub("ngIf",r.hasPiece)}}function Xae(e,t){if(1&e&&(_m(),lb(0,"g"),ab(1,Qae,4,9,"g",1),hb()),2&e){var n=t.$implicit;Pw(1),ub("ngForOf",n)}}function eoe(e,t){if(1&e){var n=pb();_m(),lb(0,"g"),lb(1,"rect",10),mb("click",function(){var e=$y(n).$implicit;return wb().onClick(e)}),hb(),hb()}if(2&e){var r=t.$implicit,i=wb();Pw(1),ub("ngClass",i.viewInfo.boardInfo[r.y][r.x].shelterClasses),tb("x",i.SPACE_SIZE*r.x+i.STROKE_WIDTH)("y",i.SPACE_SIZE*r.y+i.STROKE_WIDTH)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)}}function toe(e,t){if(1&e&&(_m(),fb(0,"circle",11)),2&e){var n=t.$implicit,r=wb();Cb("id","sidePiece_0_",n,""),tb("cx",-r.PIECE_RADIUS)("cy",1670-n*r.PIECE_RADIUS)("r",r.PIECE_RADIUS-5)}}function noe(e,t){if(1&e&&(_m(),fb(0,"circle",12)),2&e){var n=t.$implicit,r=wb();Cb("id","sidePiece_1_",n,""),tb("cx",1715+r.PIECE_RADIUS)("cy",1670-n*r.PIECE_RADIUS)("r",r.PIECE_RADIUS-5)}}function roe(e,t){if(1&e&&(_m(),fb(0,"rect",13)),2&e){var n=wb();tb("x",n.SPACE_SIZE*n.CENTRAL_ZONE_START.x+n.STROKE_WIDTH)("y",n.SPACE_SIZE*n.CENTRAL_ZONE_START.y+n.STROKE_WIDTH)("width",n.CENTRAL_ZONE_SIZE.x*n.SPACE_SIZE)("height",n.CENTRAL_ZONE_SIZE.y*n.SPACE_SIZE)}}var ioe=function(){var e=function(e){Gv(n,e);var t=$v(n);function n(e){var r;return tp(this,n),(r=t.call(this,e)).ALL_SHELTERS=Vae.ALL_SHELTERS,r.CENTRAL_ZONE_START=Vae.CENTRAL_ZONE_TOP_LEFT,r.CENTRAL_ZONE_SIZE=new Xne(Vae.CENTRAL_ZONE_BOTTOM_RIGHT.x-Vae.CENTRAL_ZONE_TOP_LEFT.x+1,Vae.CENTRAL_ZONE_BOTTOM_RIGHT.y-Vae.CENTRAL_ZONE_TOP_LEFT.y+1),r.viewInfo={dropPhase:!0,boardInfo:[],victory:[],lastMoveArrow:"",sidePieces:[20,20]},r.selected=sB.empty(),r.jumpInConstruction=sB.empty(),r.PIECE_RADIUS=.5*(r.SPACE_SIZE-2*r.STROKE_WIDTH),r.rules=qae.get(),r.availableMinimaxes=[new $ae(r.rules,"ConspirateursMinimax")],r.encoder=Gae,r.tutorial=(new Yae).tutorial,r}return rp(n,[{key:"ngOnInit",value:function(){this.updateBoard()}},{key:"updateBoard",value:function(){this.updateViewInfo(),this.rules.node.move.isPresent()&&this.showLastMove()}},{key:"updateViewInfo",value:function(){var e=this.getState();this.viewInfo.dropPhase=e.isDropPhase(),this.viewInfo.boardInfo=[],this.viewInfo.lastMoveArrow="";for(var t=0;t<Vae.HEIGHT;t++){this.viewInfo.boardInfo.push([]);for(var n=0;n<Vae.WIDTH;n++){var r=new ire(n,t),i=e.getPieceAt(r),a={coord:r,squareClasses:[],shelterClasses:[],pieceClasses:[this.getPlayerClass(i)],hasPiece:i.isPlayer(),isShelter:!1,isOccupiedShelter:!1};this.viewInfo.boardInfo[t].push(a)}}this.viewInfo.sidePieces=e.getSidePieces(),this.updateOccupiedShelters(),this.updateSelected(),this.updateVictory()}},{key:"updateOccupiedShelters",value:function(){var e,t=Qv(Vae.ALL_SHELTERS);try{for(t.s();!(e=t.n()).done;){var n=e.value,r=this.viewInfo.boardInfo[n.y][n.x];r.isShelter=!0,r.hasPiece&&r.shelterClasses.push("highlighted")}}catch(i){t.e(i)}finally{t.f()}}},{key:"updateSelected",value:function(){if(this.selected.isPresent())if(this.jumpInConstruction.isPresent()){var e=this.jumpInConstruction.get(),t=e.getStartingCoord(),n=e.getEndingCoord();this.viewInfo.boardInfo[t.y][t.x].hasPiece=!1,this.viewInfo.boardInfo[n.y][n.x].pieceClasses=[this.getPlayerClass(this.getCurrentPlayer()),"selected"],this.viewInfo.boardInfo[n.y][n.x].hasPiece=!0;var r,i=Qv(e.coords);try{for(i.s();!(r=i.n()).done;){var a=r.value;this.viewInfo.boardInfo[a.y][a.x].squareClasses.push("moved")}}catch(s){i.e(s)}finally{i.f()}}else{var o=this.selected.get();this.viewInfo.boardInfo[o.y][o.x].pieceClasses.push("selected")}}},{key:"updateVictory",value:function(){var e=this.getState(),t=qae.get().getGameStatus(this.rules.node);if(!0===t.isEndGame){var n,r=Qv(Vae.ALL_SHELTERS);try{for(r.s();!(n=r.n()).done;){var i=n.value;e.getPieceAt(i)===t.winner&&this.viewInfo.boardInfo[i.y][i.x].squareClasses.push("victory")}}catch(a){r.e(a)}finally{r.f()}}}},{key:"showLastMove",value:function(){var e=this.rules.node.move.get();if(e.isDrop())this.viewInfo.boardInfo[e.coord.y][e.coord.x].squareClasses.push("moved");else if(e.isSimple())this.viewInfo.boardInfo[e.coord.y][e.coord.x].squareClasses.push("moved"),this.viewInfo.boardInfo[e.end.y][e.end.x].squareClasses.push("moved");else{this.viewInfo.lastMoveArrow="";var t,n=Qv(e.coords);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.viewInfo.boardInfo[r.y][r.x].squareClasses.push("moved"),this.viewInfo.lastMoveArrow+=r.x*this.SPACE_SIZE+this.SPACE_SIZE/2+this.STROKE_WIDTH,this.viewInfo.lastMoveArrow+=" ",this.viewInfo.lastMoveArrow+=r.y*this.SPACE_SIZE+this.SPACE_SIZE/2+this.STROKE_WIDTH,this.viewInfo.lastMoveArrow+=" "}}catch(i){n.e(i)}finally{n.f()}}}},{key:"cancelMoveAttempt",value:function(){this.jumpInConstruction=sB.empty(),this.selected=sB.empty(),this.updateBoard()}},{key:"onClick",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#click_"+e.x+"_"+e.y)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:if((i=t.getState()).getPieceAt(e)!==t.getCurrentPlayer()){n.next=6;break}return n.abrupt("return",(t.selected=sB.of(e),t.jumpInConstruction=sB.empty(),t.updateViewInfo(),K5.SUCCESS));case 6:if(!t.jumpInConstruction.isPresent()){n.next=8;break}return n.abrupt("return",t.constructJump(e));case 8:if(!t.selected.isPresent()){n.next=10;break}return n.abrupt("return",t.selectNextCoord(e));case 10:if(!i.isDropPhase()){n.next=13;break}return a=Uae.of(e),n.abrupt("return",(X5(a.isSuccess(),"ConspirateursMove should be valid by construction"),t.chooseMove(a.get(),i)));case 13:return n.abrupt("return",t.cancelMove(pre.MUST_CHOOSE_PLAYER_PIECE()));case 14:case"end":return n.stop()}},n)}))()}},{key:"constructJump",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function n(){var r,i,a,o;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r=t.jumpInConstruction.get(),i=t.getState(),!e.equals(r.getEndingCoord())){n.next=3;break}return n.abrupt("return",t.chooseMove(r,i));case 3:if(!(a=r.addJump(e)).isFailure()){n.next=6;break}return n.abrupt("return",t.cancelMove(a.getReason()));case 6:return o=t.rules.jumpLegality(a.get(),i),n.abrupt("return",o.isFailure()?t.cancelMove(o.getReason()):t.updateJump(a.get()));case 8:case"end":return n.stop()}},n)}))()}},{key:"updateJump",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.getState(),n.abrupt("return",t.rules.jumpHasPossibleNextTargets(e,r)?(t.jumpInConstruction=sB.of(e),t.updateViewInfo(),K5.SUCCESS):t.chooseMove(e,r));case 2:case"end":return n.stop()}},n)}))()}},{key:"selectNextCoord",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r=t.selected.get(),!(i=zae.of(r,e)).isSuccess()){n.next=3;break}return n.abrupt("return",t.chooseMove(i.get(),t.getState()));case 3:return a=Hae.of([r,e]),n.abrupt("return",a.isFailure()?t.cancelMove(a.getReason()):t.updateJump(a.get()));case 5:case"end":return n.stop()}},n)}))()}}]),n}(sre);return e.\u0275fac=function(t){return new(t||e)(sb(ore))},e.\u0275cmp=ey({type:e,selectors:[["app-conspirateurs"]],features:[zC],decls:7,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-100 0 1915 1715","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base mid-stroke player0",3,"id",4,"ngFor","ngForOf"],["class","base mid-stroke player1",3,"id",4,"ngFor","ngForOf"],["class","base no-fill highlighted mid-stroke",4,"ngIf"],["id","lastJump",1,"base","no-fill"],[1,"base",3,"id","ngClass","click"],["class","base no-fill mid-stroke",3,"click",4,"ngIf"],["class","base",3,"id","ngClass","click",4,"ngIf"],[1,"base","no-fill","mid-stroke",3,"click"],[1,"base","no-fill","mid-stroke",3,"ngClass","click"],[1,"base","mid-stroke","player0",3,"id"],[1,"base","mid-stroke","player1",3,"id"],[1,"base","no-fill","highlighted","mid-stroke"]],template:function(e,t){1&e&&(_m(),lb(0,"svg",0),ab(1,Xae,2,1,"g",1),ab(2,eoe,2,5,"g",1),ab(3,toe,1,4,"circle",2),ab(4,noe,1,4,"circle",3),ab(5,roe,1,4,"rect",4),fb(6,"polyline",5),hb()),2&e&&(Pw(1),ub("ngForOf",t.viewInfo.boardInfo),Pw(1),ub("ngForOf",t.ALL_SHELTERS),Pw(1),ub("ngForOf",t.range(t.viewInfo.sidePieces[0])),Pw(1),ub("ngForOf",t.range(t.viewInfo.sidePieces[1])),Pw(1),ub("ngIf",t.viewInfo.dropPhase),Pw(1),tb("points",t.viewInfo.lastMoveArrow))},directives:[AT,NT,IT],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),aoe=function(){function e(t,n){tp(this,e),this.owner=t,this.otherPieceType=n}return rp(e,[{key:"toString",value:function(){return"DiamPiece(".concat(this.owner,", ").concat(this.otherPieceType,")")}}],[{key:"of",value:function(t,n){return t===ete.ZERO?n?e.ZERO_SECOND:e.ZERO_FIRST:t===ete.ONE?n?e.ONE_SECOND:e.ONE_FIRST:e.EMPTY}}]),e}();aoe.encoder=Jee.tuple([ete.numberEncoder,Jee.booleanEncoder],function(e){return[e.owner,e.otherPieceType]},function(e){return aoe.of(e[0],e[1])}),aoe.EMPTY=new aoe(Xee.NONE,!1),aoe.ZERO_FIRST=new aoe(ete.ZERO,!1),aoe.ZERO_SECOND=new aoe(ete.ZERO,!0),aoe.ONE_FIRST=new aoe(ete.ONE,!1),aoe.ONE_SECOND=new aoe(ete.ONE,!0),aoe.PLAYER_PIECES=[aoe.ZERO_FIRST,aoe.ZERO_SECOND,aoe.ONE_FIRST,aoe.ONE_SECOND];var ooe=function(e){Gv(n,e);var t=$v(n);function n(e,r){var i;if(tp(this,n),(i=t.call(this)).target=e,i.piece=r,r===aoe.EMPTY)throw new Error("Cannot drop an empty piece");return Wv(i)}return rp(n,[{key:"isDrop",value:function(){return!0}},{key:"getTarget",value:function(){return this.target}},{key:"equals",value:function(e){return!(this.target!==e.target||this.piece!==e.piece)}},{key:"toString",value:function(){return"DiamMoveDrop(".concat(this.target,", ").concat(this.piece,")")}}]),n}(bre);ooe.encoder=Jee.tuple([Jee.numberEncoder(7),aoe.encoder],function(e){return[e.target,e.piece]},function(e){return new ooe(e[0],e[1])});var soe=function(e){Gv(n,e);var t=$v(n);function n(e,r){var i;return tp(this,n),(i=t.call(this)).start=e,i.moveDirection=r,i}return rp(n,[{key:"isDrop",value:function(){return!1}},{key:"getTarget",value:function(){return"clockwise"===this.moveDirection?(this.start.x+1)%8:(this.start.x+7)%8}},{key:"equals",value:function(e){return!(!1===this.start.equals(e.start)||this.moveDirection!==e.moveDirection)}},{key:"toString",value:function(){return"DiamMoveShift(".concat(this.start,", ").concat(this.moveDirection,")")}}],[{key:"fromRepresentation",value:function(e,t){return new n(new ire(e.x,3-e.y),t)}}]),n}(bre);soe.encoder=Jee.tuple([ire.numberEncoder(8,4),Jee.booleanEncoder],function(e){return[e.start,"clockwise"===e.moveDirection]},function(e){return new soe(e[0],e[1]?"clockwise":"counterclockwise")});var uoe=Jee.disjunction(ooe.encoder,soe.encoder,function(e){return e.isDrop()}),coe=function(){var e=rp(function e(){tp(this,e)});return e.NO_MORE_PIECES_OF_THIS_TYPE=function(){return $localize(_n||(_n=Rv(["You do not have any pieces of this type anymore."])))},e.SPACE_IS_FULL=function(){return $localize(wn||(wn=Rv(["You cannot play here: this space is already full."])))},e.TARGET_STACK_TOO_HIGH=function(){return $localize(Cn||(Cn=Rv(["You cannot add more pieces to the target stack, as it will contain more than 4 pieces."])))},e.MUST_SHIFT_TO_NEIGHBOR=function(){return $localize(bn||(bn=Rv(["To perform a shift, you must move the pieces to a neighboring space."])))},e.MUST_SELECT_PIECE_FIRST=function(){return $localize(En||(En=Rv(["You must first select either a piece from the side, or a stack of pieces to shift on the board."])))},e}(),loe=function(){var e=function(e){Gv(n,e);var t=$v(n);function n(e,r,i){var a;return tp(this,n),(a=t.call(this,e,i)).remainingPieces=r,a}return rp(n,[{key:"getRemainingPiecesOf",value:function(e){return this.remainingPieces[n.pieceIndex(e)]}},{key:"getStackHeight",value:function(e){for(var t=0,r=0;r<n.HEIGHT&&this.getPieceAtXY(e,r)!==aoe.EMPTY;r++)t++;return t}}],[{key:"getInitialState",value:function(){var e=aoe.EMPTY;return new n([[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e]],[4,4,4,4],0)}},{key:"fromRepresentation",value:function(e,t){for(var r=e.reverse(),i=[4,4,4,4],a=0;a<n.HEIGHT;a++)for(var o=0;o<n.WIDTH;o++){var s=r[a][o];r[a][o]!==aoe.EMPTY&&i[n.pieceIndex(s)]--}return X5(i.every(function(e){return e>=0}),"Invalid DiamState representation uses too many pieces"),new n(r,i,t)}},{key:"pieceIndex",value:function(e){switch(e){case aoe.ZERO_FIRST:return 0;case aoe.ZERO_SECOND:return 1;case aoe.ONE_FIRST:return 2;default:return nB.expectToBe(e,aoe.ONE_SECOND),3}}}]),n}(wre);return e.WIDTH=8,e.HEIGHT=4,e}(),hoe=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.call(this,loe)}return rp(n,[{key:"applyLegalMove",value:function(e,t,n){return e.isDrop()?this.applyLegalDrop(e,t):this.applyLegalShift(e,t)}},{key:"applyLegalDrop",value:function(e,t){var n=ite.copyBiArray(t.board);n[t.getStackHeight(e.target)][e.target]=e.piece;var r=ite.copyImmutableArray(t.remainingPieces);return r[loe.pieceIndex(e.piece)]-=1,new loe(n,r,t.turn+1)}},{key:"applyLegalShift",value:function(e,t){for(var n=ite.copyBiArray(t.board),r=e.getTarget(),i=t.getStackHeight(r),a=e.start.y;a<loe.HEIGHT&&t.getPieceAtXY(e.start.x,a)!==aoe.EMPTY;)n[i][r]=t.getPieceAtXY(e.start.x,a),n[a][e.start.x]=aoe.EMPTY,i++,a++;return new loe(n,t.remainingPieces,t.turn+1)}},{key:"isLegal",value:function(e,t){return e.isDrop()?this.isDropLegal(e,t):this.isShiftLegal(e,t)}},{key:"isDropLegal",value:function(e,t){return e.piece.owner!==t.getCurrentPlayer()?j5.failure(pre.MUST_CHOOSE_PLAYER_PIECE()):0===t.getRemainingPiecesOf(e.piece)?j5.failure(coe.NO_MORE_PIECES_OF_THIS_TYPE()):this.dropHeightValidity(e,t)}},{key:"dropHeightValidity",value:function(e,t){return t.getStackHeight(e.target)===loe.HEIGHT?j5.failure(coe.SPACE_IS_FULL()):j5.success(void 0)}},{key:"isShiftLegal",value:function(e,t){return t.getPieceAt(e.start).owner!==t.getCurrentPlayer()?j5.failure(pre.MUST_CHOOSE_PLAYER_PIECE()):this.shiftHeightValidity(e,t)}},{key:"shiftHeightValidity",value:function(e,t){var n=t.getStackHeight(e.start.x)-e.start.y;return t.getStackHeight(e.getTarget())+n>loe.HEIGHT?j5.failure(coe.TARGET_STACK_TOO_HIGH()):j5.success(void 0)}},{key:"getGameStatus",value:function(e){var t=this.findHighestAlignment(e.gameState);if(t.isPresent()){var n=e.gameState.getPieceAt(t.get());return X5(n.owner.isPlayer(),"highest alignment is owned by a player"),Are.getVictory(n.owner)}return Are.ONGOING}},{key:"findHighestAlignment",value:function(e){for(var t=0;t<loe.WIDTH/2;t++)for(var n=loe.HEIGHT-1;n>0;n--){var r=e.getPieceAtXY(t,n),i=e.getPieceAtXY(t+loe.WIDTH/2,n);if(r!==aoe.EMPTY&&r===i)return sB.of(new ire(t,n))}return sB.empty()}},{key:"pieceCanMove",value:function(e,t){return!!this.isShiftLegal(new soe(t,"clockwise"),e).isSuccess()||!!this.isShiftLegal(new soe(t,"counterclockwise"),e).isSuccess()}}],[{key:"get",value:function(){return n.singleton.isAbsent()&&(n.singleton=sB.of(new n)),n.singleton.get()}}]),n}(Rre);hoe.singleton=sB.empty();var foe=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"getListMoves",value:function(e){var t=e.gameState,n=this.getListDrops(t),r=this.getListShifts(t);return n.concat(r)}},{key:"getListShifts",value:function(e){var t,n=[],r=Qv(this.getShiftSources(e));try{for(r.s();!(t=r.n()).done;)for(var i=t.value,a=0,o=[new soe(i,"clockwise"),new soe(i,"counterclockwise")];a<o.length;a++){var s=o[a];hoe.get().shiftHeightValidity(s,e).isSuccess()&&n.push(s)}}catch(u){r.e(u)}finally{r.f()}return n}},{key:"getListDrops",value:function(e){for(var t=this.getRemainingPiecesForCurrentPlayer(e),n=[],r=0;r<loe.WIDTH;r++){var i,a=Qv(t);try{for(a.s();!(i=a.n()).done;){var o=i.value,s=new ooe(r,o);hoe.get().dropHeightValidity(s,e).isSuccess()&&n.push(s)}}catch(u){a.e(u)}finally{a.f()}}return n}},{key:"getRemainingPiecesForCurrentPlayer",value:function(e){var t,n=[],r=Qv(aoe.PLAYER_PIECES);try{for(r.s();!(t=r.n()).done;){var i=t.value;this.currentPlayerCanDropPiece(e,i)&&n.push(i)}}catch(a){r.e(a)}finally{r.f()}return n}},{key:"currentPlayerCanDropPiece",value:function(e,t){return e.getCurrentPlayer()===t.owner&&e.getRemainingPiecesOf(t)>0}},{key:"getShiftSources",value:function(e){for(var t=[],n=e.getCurrentPlayer(),r=0;r<loe.HEIGHT;r++)for(var i=0;i<loe.WIDTH;i++)e.getPieceAtXY(i,r).owner===n&&t.push(new ire(i,r));return t}},{key:"getBoardValue",value:function(e){var t=hoe.get().getGameStatus(e);return new yre(t.isEndGame?t.toBoardValue():0)}}]),n}(gre),doe=aoe.EMPTY,voe=aoe.ZERO_FIRST,poe=aoe.ZERO_SECOND,goe=aoe.ONE_FIRST,yoe=aoe.ONE_SECOND,moe=rp(function e(){tp(this,e),this.tutorial=[Lre.informational($localize(Sn||(Sn=Rv(["Initial board and player pieces"]))),$localize(Pn||(Pn=Rv(["Diam's board is a circular board made of 8 spaces. Each player has 8 pieces: 4 of one color, and 4 of another color. Initially, the board is empty. All the remaining pieces are displayed next to the board: Dark's pieces are on the left, Light's pieces are on the right."]))),loe.getInitialState()),Lre.fromMove($localize(On||(On=Rv(["Goal of the game"]))),$localize(Tn||(Tn=Rv(["At Diam, the goal is to align two of your pieces, having exactly the same color, on diametrically opposed spaces, on top of at least another piece. Note here that Dark does not win because the dark pieces are not on top of any other piece. You're playing Light. Here, you can win by dropping one of your pieces on the leftmost space. You can do it by clicking on the corresponding piece next to the board, and then on the space in which you want to drop your piece.<br/><br/>Do it!"]))),loe.fromRepresentation([[doe,doe,doe,doe,doe,doe,doe,doe],[doe,doe,doe,doe,doe,doe,doe,doe],[doe,doe,doe,doe,goe,doe,doe,doe],[voe,doe,doe,doe,voe,doe,doe,doe]],3),[new ooe(0,aoe.ONE_FIRST)],$localize(In||(In=Rv(["Congratulations, you won!"]))),$localize(xn||(xn=Rv(["Failed, you should drop your piece on the leftmost space, using the piece of the same color of the other piece you already have on the board."])))),Lre.fromMove($localize(An||(An=Rv(["Types of move"]))),$localize(Rn||(Rn=Rv(["You can perform two types of move: either dropping one of your piece like you did in the previous step, or you can shift one of your pieces on the board to a neighboring space. You can pick any of your piece on the board, even if there are pieces on top of it. Only one condition applies: there can never be more  than 4 pieces in a space. When you pick a piece with other pieces on top of it, all the other pieces move with yours.<br/><br/>You're playing Dark, try to move one of your piece that is already on the board."]))),loe.fromRepresentation([[doe,doe,doe,doe,doe,doe,doe,doe],[doe,doe,doe,doe,yoe,doe,doe,doe],[doe,doe,doe,doe,voe,doe,doe,doe],[goe,doe,doe,doe,poe,doe,doe,doe]],4),[soe.fromRepresentation(new ire(4,3),"counterclockwise"),soe.fromRepresentation(new ire(4,3),"clockwise"),soe.fromRepresentation(new ire(4,2),"counterclockwise"),soe.fromRepresentation(new ire(4,2),"clockwise")],$localize(Nn||(Nn=Rv(["Congratulations!"]))),$localize(Mn||(Mn=Rv(["Failed, try to move one of your piece that is already on the board."])))),Lre.fromMove($localize(Dn||(Dn=Rv(["Special case"]))),$localize(Ln||(Ln=Rv(["It can happen that, in a single turn, both players reach an alignment. If it is the case, only the player with the highest alignment wins.<br/><br/>Here, playing Dark, you can win by performing such a move, do it!"]))),loe.fromRepresentation([[doe,doe,doe,doe,voe,doe,doe,doe],[doe,doe,doe,doe,yoe,doe,doe,voe],[doe,doe,doe,doe,voe,doe,doe,yoe],[doe,goe,doe,doe,poe,doe,doe,goe]],8),[soe.fromRepresentation(new ire(4,2),"counterclockwise")],$localize(Fn||(Fn=Rv(["Congratulations!"]))),$localize(Bn||(Bn=Rv(["Failed, try to shift a stack of pieces to the left."]))))]});function koe(e,t){if(1&e){var n=pb();_m(),lb(0,"g"),lb(1,"path",6),mb("click",function(){var e=$y(n).$implicit;return wb().onSpaceClick(e)}),hb(),lb(2,"path",7),mb("click",function(){var e=$y(n).$implicit;return wb().onSpaceClick(e)}),hb(),hb()}if(2&e){var r=t.$implicit,i=wb();Pw(1),Cb("id","click_",r,""),ub("ngClass",i.viewInfo.boardInfo[r].spaceClasses),tb("d",i.BOARD_PATHS[r]),Pw(1),ub("ngClass",i.viewInfo.boardInfo[r].spaceClasses),tb("d",i.DECORATION_PATHS[r])}}function _oe(e,t){if(1&e){var n=pb();_m(),lb(0,"g",9),mb("click",function(){var e=$y(n).$implicit,t=wb().$implicit;return wb().onPieceInGameClick(t,e.y)}),fb(1,"use",10),fb(2,"use",11),hb()}if(2&e){var r=t.$implicit;bb("id","click_",wb().$implicit,"_",r.y,""),ub("ngClass",r.foregroundClasses),Pw(1),ub("ngClass",r.backgroundClasses),tb("x",r.drawPosition.x)("y",r.drawPosition.y),Pw(1),tb("x",r.drawPosition.x)("y",r.drawPosition.y)}}function woe(e,t){if(1&e&&(_m(),lb(0,"g"),ab(1,_oe,3,8,"g",8),hb()),2&e){var n=t.$implicit,r=wb();Pw(1),ub("ngForOf",r.viewInfo.boardInfo[n].pieces)}}function Coe(e,t){if(1&e){var n=pb();_m(),lb(0,"g",12),mb("click",function(){var e=$y(n).$implicit;return wb().onRemainingPieceClick(e.actualPiece)}),fb(1,"use",10),fb(2,"use",11),hb()}if(2&e){var r=t.$implicit;bb("id","piece_",r.actualPiece.owner.value,"_",r.actualPiece.otherPieceType?1:0,""),ub("ngClass",r.foregroundClasses),Pw(1),ub("ngClass",r.backgroundClasses),tb("x",r.drawPosition.x)("y",r.drawPosition.y),Pw(1),tb("x",r.drawPosition.x)("y",r.drawPosition.y)}}var boe=function(){return[0,1,2,3,4,5,6,7]},Eoe=function(){return[2,1,3,0,4,7,5,6]},Soe=function(e){Gv(n,e);var t=$v(n);function n(e){var r;return tp(this,n),(r=t.call(this,e)).BOARD_PATHS=["M 2.8324855,277.57643 164.46619,228.81694 170.57257,148.42756 32.571357,104.19835 Z","M 170.57257,148.42237 246.4213,96.276913 195.13813,2.0233391 32.571357,104.19315 Z","m 195.14159,2.0268021 205.0898,0.010821 -52.1686,94.2453509 -101.64149,-0.0057 z","M 348.06279,96.281239 400.23529,2.0330788 564.39307,104.19207 424.66384,148.41891 Z","m 424.66384,148.42237 7.27882,80.37683 164.9712,48.72701 -32.52079,-173.33068 z","m 431.94266,228.80481 -75.73854,62.15055 79.06197,135.86929 161.64688,-149.29953 z","m 356.20412,290.9506 79.06197,135.86929 -268.2864,0.0433 74.14082,-135.90175 z","M 241.12051,290.96379 166.97969,426.86556 2.8324855,277.57708 164.46619,228.81759 Z"],r.DECORATION_PATHS=["m 170.57257,148.42302 v 40.08918 l -6.11049,80.38634 v -40.09025 z","m 170.57646,188.51696 v -40.08918 l 75.8509,-52.140047 v 40.086147 z","m 246.42323,96.285785 v 40.086155 l 101.63847,-0.003 0.001,-40.082256 z","m 424.66037,148.42345 v 40.08377 l -76.60213,-52.14178 10e-4,-40.082033 z","m 424.66037,148.42193 v 40.08377 l 7.27884,80.37445 v -40.08377 z","m 435.26609,466.90582 v -40.08615 l 161.64688,-149.2995 8.9e-4,40.08701 z","m 166.97969,426.86815 v 40.08638 l 268.28379,-0.0433 v -40.08031 z","m 2.8324855,277.57297 v 40.08636 L 166.97969,466.94782 v -40.08636 z"],r.selected=sB.empty(),r.viewInfo={boardInfo:[],remainingPieces:[]},r.rules=hoe.get(),r.availableMinimaxes=[new foe(r.rules,"DiamDummyMinimax")],r.encoder=uoe,r.tutorial=(new moe).tutorial,r}return rp(n,[{key:"ngOnInit",value:function(){this.updateBoard()}},{key:"onSpaceClick",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.canUserPlay("#click_"+e),n.abrupt("return",r.isFailure()?t.cancelMove(r.getReason()):t.onSpaceClickAfterCheck(e));case 2:case"end":return n.stop()}},n)}))()}},{key:"onSpaceClickAfterCheck",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!t.selected.isPresent()){n.next=14;break}if("pieceFromReserve"!==(r=t.selected.get()).type){n.next=6;break}i=new ooe(e,r.piece),n.next=13;break;case 6:if((r.position.x+1)%loe.WIDTH!==e){n.next=10;break}i=new soe(r.position,"clockwise"),n.next=13;break;case 10:if((r.position.x+(loe.WIDTH-1))%loe.WIDTH===e){n.next=12;break}return n.abrupt("return",t.cancelMove(coe.MUST_SHIFT_TO_NEIGHBOR()));case 12:i=new soe(r.position,"counterclockwise");case 13:return n.abrupt("return",t.chooseMove(i,t.getState()));case 14:return n.abrupt("return",t.cancelMove(coe.MUST_SELECT_PIECE_FIRST()));case 15:case"end":return n.stop()}},n)}))()}},{key:"onPieceInGameClick",value:function(e,t){var n=this;return tB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=n.canUserPlay("#click_"+e+"_"+t),r.abrupt("return",i.isFailure()?n.cancelMove(i.getReason()):n.getState().getPieceAtXY(e,t).owner===n.getCurrentPlayer()?(n.selected=sB.of({type:"pieceFromBoard",position:new ire(e,t)}),n.updateViewInfo(),K5.SUCCESS):n.selected.isPresent()?n.onSpaceClickAfterCheck(e):n.cancelMove(pre.MUST_CHOOSE_PLAYER_PIECE()));case 2:case"end":return r.stop()}},r)}))()}},{key:"onRemainingPieceClick",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.canUserPlay(t.getPieceId(e)),n.abrupt("return",r.isFailure()?t.cancelMove(r.getReason()):e.owner===t.getCurrentPlayer()?(t.selected=sB.of({type:"pieceFromReserve",piece:e}),t.updateViewInfo(),K5.SUCCESS):t.cancelMove(pre.MUST_CHOOSE_PLAYER_PIECE()));case 2:case"end":return n.stop()}},n)}))()}},{key:"getPieceId",value:function(e){return"#piece_"+e.owner.value+"_"+(e.otherPieceType?1:0)}},{key:"updateBoard",value:function(){this.updateViewInfo(),this.rules.node.move.isPresent()&&this.showLastMove()}},{key:"getLastMovedFromDrop",value:function(e,t){var n=this.getDrawPositionRemainingPiece(e.piece,t.getRemainingPiecesOf(e.piece)-1),r=e.getTarget(),i=t.getStackHeight(e.getTarget()),a=this.getDrawPositionOnBoard(r,i),o=new ire(r,i);return[{start:sB.empty(),end:o,startDrawPosition:n,endDrawPosition:a}]}},{key:"getLastMovedFromShift",value:function(e,t){for(var n=e.start.x,r=e.getTarget(),i=t.getStackHeight(r),a=[],o=e.start.y;o<loe.HEIGHT&&t.getPieceAtXY(n,o)!==aoe.EMPTY;o++,i++)a.push({start:sB.of(new ire(n,o)),end:new ire(r,i),startDrawPosition:this.getDrawPositionOnBoard(n,o),endDrawPosition:this.getDrawPositionOnBoard(r,i)});return a}},{key:"updateViewInfo",value:function(){this.updateBoardInfo(),this.updateRemainingPiecesInfo()}},{key:"updateBoardInfo",value:function(){for(var e=0;e<loe.WIDTH;e++)this.viewInfo.boardInfo[e]={x:e,spaceClasses:[],pieces:this.getPieces(e)}}},{key:"showLastMove",value:function(){this.showLastMoveOnSpaces(),this.showLastMoveOnPieces()}},{key:"showLastMoveOnSpaces",value:function(){var e=this.rules.node.move;X5(e.isPresent(),"showLastMoveOnSpaces called without a last move");for(var t=e.get(),n=0;n<loe.WIDTH;n++){var r=[];t.isDrop()?t.getTarget()===n&&r.push("moved"):(t.getTarget()===n||t.start.x===n)&&r.push("moved"),this.viewInfo.boardInfo[n].spaceClasses=r}}},{key:"showLastMoveOnPieces",value:function(){var e=this.rules.node.move;X5(e.isPresent(),"showLastMoveOnPieces called without a last move");var t,n=e.get(),r=this.getPreviousState(),i=Qv(n.isDrop()?this.getLastMovedFromDrop(n,r):this.getLastMovedFromShift(n,r));try{for(i.s();!(t=i.n()).done;){var a=t.value;this.viewInfo.boardInfo[a.end.x].pieces[a.end.y].foregroundClasses.push("last-move")}}catch(o){i.e(o)}finally{i.f()}}},{key:"updateRemainingPiecesInfo",value:function(){var e=this.getCurrentPlayer();this.viewInfo.remainingPieces=[];var t,n=this.isPlayerTurn(),r=Qv(aoe.PLAYER_PIECES);try{for(r.s();!(t=r.n()).done;)for(var i=t.value,a=this.getState().getRemainingPiecesOf(i),o=0;o<a;o++){var s=[];this.isTopPieceOfReserveAndSelected(o,a,i)&&s.push("selected"),n&&o===a-1&&i.owner===e&&s.push("clickable-hover"),this.viewInfo.remainingPieces.push({backgroundClasses:["player"+i.owner.value+(i.otherPieceType?"-alternate":"")],foregroundClasses:s,y:o,drawPosition:this.getDrawPositionRemainingPiece(i,o),actualPiece:i})}}catch(u){r.e(u)}finally{r.f()}}},{key:"isTopPieceOfReserveAndSelected",value:function(e,t,n){if(this.selected.isPresent()){var r=this.selected.get();return"pieceFromReserve"===r.type&&r.piece===n&&e===t-1}return!1}},{key:"getDrawPositionRemainingPiece",value:function(e,t){var r,i;return r=e.owner===ete.ZERO?-100:600,i=e.otherPieceType?100:450,new ire(r,i).getNext(new Xne(0,-t*n.PIECE_HEIGHT))}},{key:"getPieces",value:function(e){for(var t=this.rules.findHighestAlignment(this.getState()),n=this.isPlayerTurn(),r=[],i=0;i<loe.HEIGHT;i++){var a=this.getState().getPieceAtXY(e,i),o=new ire(e,i);if(a!==aoe.EMPTY){var s=[];this.pieceFromBoardIsSelected(e,i)&&s.push("selected"),this.isVictory(e,i,t)&&s.push("victory-stroke"),n&&this.rules.pieceCanMove(this.getState(),o)&&s.push("clickable-hover"),r.push({backgroundClasses:["player"+a.owner.value+(a.otherPieceType?"-alternate":"")],foregroundClasses:s,y:i,drawPosition:this.getDrawPositionOnBoard(e,i),actualPiece:a})}}return r}},{key:"pieceFromBoardIsSelected",value:function(e,t){if(this.selected.isPresent()){var n=this.selected.get();return"pieceFromBoard"===n.type&&n.position.x===e&&n.position.y===t}return!1}},{key:"isVictory",value:function(e,t,n){if(n.isPresent()){var r=n.get();return r.x%4==e%4&&r.y===t}return!1}},{key:"getDrawPositionOnBoard",value:function(e,t){return n.CENTER[e].getNext(new Xne(0,-t*n.PIECE_HEIGHT))}},{key:"cancelMoveAttempt",value:function(){this.selected=sB.empty(),this.updateBoard()}}]),n}(sre);Soe.CENTER=[new ire(40,160),new ire(100,50),new ire(255,2),new ire(400,50),new ire(460,160),new ire(400,270),new ire(255,320),new ire(100,270)],Soe.PIECE_HEIGHT=36,Soe.\u0275fac=function(e){return new(e||Soe)(sb(ore))},Soe.\u0275cmp=ey({type:Soe,selectors:[["app-diam"]],features:[zC],decls:8,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-110 -120 800 710","preserveAspectRatio","xMidYMid meet"],["id","piece"],["d","M 1.4319358,16.913484 V 49.329973 H 1.482219 A 39.498175,14.141265 0 0 0 40.938372,63.011675 39.498175,14.141265 0 0 0 80.394523,49.329973 h 0.06885 V 16.913484 h -0.02864 A 39.769348,14.114049 0 0 1 40.941466,29.431707 39.769348,14.114049 0 0 1 1.4481812,16.913484 Z"],["cx","40.952408","cy","15.225397","rx","39.769348","ry","14.11405"],[4,"ngFor","ngForOf"],["class","base-no-fill no-fill mid-small-stroke",3,"id","ngClass","click",4,"ngFor","ngForOf"],[1,"base","mid-stroke",3,"id","ngClass","click"],[1,"base","mid-stroke","high-brightness",3,"ngClass","click"],["pointer-events","fill","class","base-no-fill no-fill mid-small-stroke",3,"id","ngClass","click",4,"ngFor","ngForOf"],["pointer-events","fill",1,"base-no-fill","no-fill","mid-small-stroke",3,"id","ngClass","click"],[0,"xlink","href","#piece",1,"base","mid-stroke",3,"ngClass"],[0,"xlink","href","#piece"],[1,"base-no-fill","no-fill","mid-small-stroke",3,"id","ngClass","click"]],template:function(e,t){1&e&&(_m(),lb(0,"svg",0),lb(1,"defs"),lb(2,"g",1),fb(3,"path",2),fb(4,"ellipse",3),hb(),hb(),ab(5,koe,3,5,"g",4),ab(6,woe,2,1,"g",4),ab(7,Coe,3,8,"g",5),hb()),2&e&&(Pw(5),ub("ngForOf",eP(3,boe)),Pw(1),ub("ngForOf",eP(4,Eoe)),Pw(1),ub("ngForOf",t.viewInfo.remainingPieces))},directives:[AT,IT],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});var Poe=function(){function e(t,n){tp(this,e),this.offset=t,this.constant=n}return rp(e,[{key:"toString",value:function(){return"Line(".concat(this.constant,", ").concat(this.offset,")")}},{key:"equals",value:function(e){return this===e||!(this.offset!==e.offset||this.constant!==e.constant)}},{key:"contains",value:function(e){switch(this.constant){case"q":return e.x===this.offset;case"r":return e.y===this.offset;case"s":return e.x+e.y===this.offset}}},{key:"getDirection",value:function(){switch(this.constant){case"q":return lre.DOWN;case"r":return lre.RIGHT;case"s":return lre.DOWN_LEFT}}}],[{key:"fromTwoCoords",value:function(t,n){var r=t.x,i=n.x,a=t.y,o=n.y,s=r+a,u=i+o;return r===i&&a!==o&&s!==u?sB.of(e.constantQ(r)):r!==i&&a===o&&s!==u?sB.of(e.constantR(a)):r!==i&&a!==o&&s===u?sB.of(e.constantS(s)):sB.empty()}},{key:"constantQ",value:function(t){return new e(t,"q")}},{key:"constantR",value:function(t){return new e(t,"r")}},{key:"constantS",value:function(t){return new e(t,"s")}},{key:"areOnSameLine",value:function(t){if(t.length<2)return!0;var n=e.fromTwoCoords(t[0],t[1]);if(n.isAbsent())return!1;var r,i=n.get(),a=Qv(t.slice(2));try{for(a.s();!(r=a.n()).done;){var o=r.value;if(!1===i.contains(o))return!1}}catch(s){a.e(s)}finally{a.f()}return!0}}]),e}(),Ooe=function(e){Gv(n,e);var t=$v(n);function n(e,r,i,a,o,s){var u;return tp(this,n),(u=t.call(this,r,e)).board=r,u.width=i,u.height=a,u.excludedCases=o,u.empty=s,X5(u.excludedCases.length<u.height/2+1,"Invalid excluded cases specification for HexagonalGameState."),u}return rp(n,[{key:"setAt",value:function(e,t){if(this.isOnBoard(e))return this.setAtUnsafe(e,t);throw new Error("Setting coord not on board: "+e+".")}},{key:"equalsT",value:function(e,t){if(this===e)return!0;if(this.width!==e.width||this.height!==e.height||!1===t(this.empty,e.empty)||this.excludedCases.length!==e.excludedCases.length)return!1;for(var n=0;n<this.excludedCases.length;n++)if(this.excludedCases[n]!==e.excludedCases[n])return!1;var r,i=Qv(this.allCoords());try{for(i.s();!(r=i.n()).done;){var a=r.value;if(!1===t(this.getPieceAt(a),e.getPieceAt(a)))return!1}}catch(o){i.e(o)}finally{i.f()}return!0}},{key:"allCoords",value:function(){var e=[];return this.forEachCoord(function(t){e.push(t)}),e}},{key:"allLines",value:function(){for(var e=[],t=0;t<this.width;t++)e.push(Poe.constantQ(t));for(var n=0;n<this.height;n++)e.push(Poe.constantR(n));for(var r=this.excludedCases.length;r<this.height+this.excludedCases.length;r++)e.push(Poe.constantS(r));return e}},{key:"getEntranceOnLine",value:function(e){var t,n;switch(e.constant){case"q":return n=null!=this.excludedCases[e.offset]?this.excludedCases[e.offset]:0,this.findEntranceFrom(e,new ire(e.offset,n));case"r":return t=null!=this.excludedCases[e.offset]?this.excludedCases[e.offset]:0,this.findEntranceFrom(e,new ire(t,e.offset));case"s":return this.findEntranceFrom(e,e.offset<this.width?new ire(e.offset,0):new ire(this.width-1,e.offset-this.width+1))}}},{key:"findEntranceFrom",value:function(e,t){for(var n=e.getDirection(),r=t,i=0;i<Math.max(this.width,this.height);i++){if(this.isOnBoard(r))return r;r=r.getNext(n)}var a=Q5.logError("HexagonalGameState.findEntranceFrom","could not find a board entrance, board must be invalid",{start:t.toString(),line:e.toString()});throw new Error(a.getReason())}}],[{key:"neighbors",value:function(e,t){return[new ire(e.x+t,e.y-t),new ire(e.x+t,e.y),new ire(e.x-t,e.y+t),new ire(e.x-t,e.y),new ire(e.x,e.y+t),new ire(e.x,e.y-t)]}}]),n}(wre),Toe=function(){function e(t,n,r){tp(this,e),this.owner=t,this.size=n,this.source=r}return rp(e,[{key:"getValue",value:function(){return e.encoder.encodeNumber(this)}},{key:"getOwner",value:function(){return this.owner}},{key:"belongsTo",value:function(e){return this.owner===e}},{key:"containsSource",value:function(){return this.source}},{key:"isEmpty",value:function(){return 0===this.size}},{key:"getSize",value:function(){return this.size}},{key:"toString",value:function(){return"DvonnPieceStack("+this.owner.toString()+", "+this.size+", "+this.source+")"}}],[{key:"append",value:function(t,n){return new e(t.owner,t.size+n.size,t.source||n.source)}}]),e}();Toe.sizeEncoder=Jee.numberEncoder(49),Toe.encoder=Jee.tuple([Jee.booleanEncoder,ete.numberEncoder,Toe.sizeEncoder],function(e){return[e.source,e.owner,e.size]},function(e){return new Toe(e[1],e[2],e[0])}),Toe.MAX_SIZE=49,Toe.EMPTY=new Toe(Xee.NONE,0,!1),Toe.NONE=new Toe(Xee.NONE,-1,!1),Toe.PLAYER_ZERO=new Toe(ete.ZERO,1,!1),Toe.PLAYER_ONE=new Toe(ete.ONE,1,!1),Toe.SOURCE=new Toe(Xee.NONE,1,!0);var Ioe=function(){var e=function(e){Gv(n,e);var t=$v(n);function n(e,r,i){var a;return tp(this,n),(a=t.call(this,r,e,n.WIDTH,n.HEIGHT,n.EXCLUDED_CASES,Toe.EMPTY)).alreadyPassed=i,a}return rp(n,[{key:"getAllPieces",value:function(){for(var e=[],t=0;t<n.HEIGHT;t++)for(var r=0;r<n.WIDTH;r++){var i=new ire(r,t);this.isOnBoard(i)&&!1===this.getPieceAt(i).isEmpty()&&e.push(i)}return e}},{key:"numberOfNeighbors",value:function(e){var t=this;return Ooe.neighbors(e,1).filter(function(e){return t.isOnBoard(e)&&!1===t.getPieceAt(e).isEmpty()}).length}},{key:"setAtUnsafe",value:function(e,t){var r=ite.copyBiArray(this.board);return r[e.y][e.x]=t,new n(r,this.turn,this.alreadyPassed)}},{key:"isOnBoard",value:function(e){return!e.isNotInRange(this.width,this.height)&&this.board[e.y][e.x]!==Toe.NONE}}],[{key:"balancedBoard",value:function(){var e=Toe.NONE,t=Toe.PLAYER_ZERO,n=Toe.PLAYER_ONE,r=Toe.SOURCE;return[[e,e,t,n,n,n,t,t,n,r,n],[e,n,n,t,t,t,n,n,t,n,n],[n,n,n,n,t,r,n,t,t,t,t],[t,t,n,t,t,n,n,n,t,t,e],[t,r,t,n,n,t,t,t,n,e,e]]}},{key:"isOnBoard",value:function(e){return!e.isNotInRange(n.WIDTH,n.HEIGHT)&&n.balancedBoard()[e.y][e.x]!==Toe.NONE}},{key:"getInitialState",value:function(){return new n(n.balancedBoard(),0,!1)}}]),n}(Ooe);return e.WIDTH=11,e.HEIGHT=5,e.EXCLUDED_CASES=[2,1],e}(),xoe=function(e){Gv(n,e);var t=$v(n);function n(e,r){return tp(this,n),t.call(this,e,r)}return rp(n,[{key:"toString",value:function(){return this===n.PASS?"DvonnMove.PASS":"DvonnMove("+this.coord+"->"+this.end+")"}},{key:"length",value:function(){return this.coord.y===this.end.y?Math.abs(this.coord.x-this.end.x):Math.abs(this.coord.y-this.end.y)}},{key:"equals",value:function(e){return e===this||!!e.coord.equals(this.coord)&&e.end.equals(this.end)}}],[{key:"of",value:function(e,t){if(-1===e.x&&-1===e.y&&-2===t.x&&-2===t.y)return n.PASS;if(!Ioe.isOnBoard(e))throw new Error("Starting coord of DvonnMove must be on the board, not at "+e.toString());if(!Ioe.isOnBoard(t))throw new Error("End coord of DvonnMove must be on the board, not at "+e.toString());if(e.y===t.y)return new n(e,t);if(e.x===t.x)return new n(e,t);if(e.x+e.y===t.x+t.y)return new n(e,t);throw new Error("Invalid move")}}]),n}(Oie);xoe.PASS=new xoe(new ire(-1,-1),new ire(-2,-2)),xoe.encoder=new(function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"maxValue",value:function(){return 42148}},{key:"encodeNumber",value:function(e){return 4096*e.coord.x+256*e.coord.y+16*e.end.x+e.end.y}},{key:"decodeNumber",value:function(e){if(e<0)return xoe.PASS;var t=e%16,n=(e=e/16|0)%16,r=(e=e/16|0)%16;return new xoe(new ire((e=e/16|0)%16,r),new ire(n,t))}}]),n}(Jee));var Aoe=function(){var e=rp(function e(){tp(this,e)});return e.NOT_PLAYER_PIECE=function(){return $localize(Vn||(Vn=Rv(["You must select a piece or a stack of your color."])))},e.EMPTY_STACK=function(){return $localize(Un||(Un=Rv(["You must select a stack."])))},e.TOO_MANY_NEIGHBORS=function(){return $localize(zn||(zn=Rv(["This stack cannot be moved because all 6 of its neighbors are occupied. You must select a stack with strictly less than 6 neighbors."])))},e.CANT_REACH_TARGET=function(){return $localize(Hn||(Hn=Rv(["This stack cannot move because it could never land on another piece."])))},e.INVALID_MOVE_LENGTH=function(){return $localize(Gn||(Gn=Rv(["A stack must always be moved by as many spaces as there are pieces in the stack."])))},e.EMPTY_TARGET_STACK=function(){return $localize(qn||(qn=Rv(["The stack must land on an occupied space."])))},e}(),Roe=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"isMovablePiece",value:function(e,t){X5(e.isOnBoard(t),"piece is not on the board");var r=e.getPieceAt(t);return r.getSize()<1?K5.failure(Aoe.EMPTY_STACK()):r.belongsTo(e.getCurrentPlayer())?e.numberOfNeighbors(t)>=6?K5.failure(Aoe.TOO_MANY_NEIGHBORS()):n.pieceHasTarget(e,t)?K5.SUCCESS:K5.failure(Aoe.CANT_REACH_TARGET()):K5.failure(Aoe.NOT_PLAYER_PIECE())}},{key:"canOnlyPass",value:function(e){return 0===n.getMovablePieces(e).length}},{key:"sourceCoords",value:function(e){return e.getAllPieces().filter(function(t){return e.getPieceAt(t).containsSource()})}},{key:"markPiecesConnectedTo",value:function(e,t,n){var r=this;Ooe.neighbors(t,1).forEach(function(t){e.isOnBoard(t)&&!n[t.y][t.x]&&!e.getPieceAt(t).isEmpty()&&(n[t.y][t.x]=!0,r.markPiecesConnectedTo(e,t,n))})}},{key:"removeDisconnectedPieces",value:function(e){var t=this,n=ite.createTable(Ioe.WIDTH,Ioe.HEIGHT,!1);this.sourceCoords(e).forEach(function(r){n[r.y][r.x]=!0,t.markPiecesConnectedTo(e,r,n)});var r=e;return r.getAllPieces().forEach(function(e){n[e.y][e.x]||(r=r.setAt(e,Toe.EMPTY))}),r}},{key:"applyLegalMove",value:function(e,t,n){if(e===xoe.PASS)return new Ioe(t.board,t.turn+1,!0);var r=t.getPieceAt(e.coord),i=t.getPieceAt(e.end),a=t.setAt(e.coord,Toe.EMPTY).setAt(e.end,Toe.append(r,i));return this.removeDisconnectedPieces(new Ioe(a.board,t.turn+1,!1))}},{key:"isLegal",value:function(e,t){if(0===n.getMovablePieces(t).length)return e!==xoe.PASS||t.alreadyPassed?j5.failure(pre.MUST_PASS()):j5.success(void 0);if(e===xoe.PASS)return j5.failure(pre.CANNOT_PASS());var r=this.isMovablePiece(t,e.coord);if(r.isFailure())return r.toFailedFallible();var i=t.getPieceAt(e.coord);return e.length()!==i.getSize()?j5.failure(Aoe.INVALID_MOVE_LENGTH()):t.getPieceAt(e.end).isEmpty()?j5.failure(Aoe.EMPTY_TARGET_STACK()):j5.success(void 0)}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"getGameStatus",value:function(e){var t=e.gameState,r=n.getScores(t);return 0===n.getMovablePieces(t).length?r[0]>r[1]?Are.ZERO_WON:r[0]<r[1]?Are.ONE_WON:Are.DRAW:Are.ONGOING}},{key:"getMovablePieces",value:function(e){return n.getFreePieces(e).filter(function(t){return n.pieceHasTarget(e,t)})}},{key:"getFreePieces",value:function(e){return e.getAllPieces().filter(function(t){return e.getPieceAt(t).belongsTo(e.getCurrentPlayer())&&e.numberOfNeighbors(t)<6})}},{key:"pieceHasTarget",value:function(e,t){var n=e.getPieceAt(t).getSize();return void 0!==Ooe.neighbors(t,n).find(function(t){return e.isOnBoard(t)&&!e.getPieceAt(t).isEmpty()})}},{key:"pieceTargets",value:function(e,t){var n=e.getPieceAt(t).getSize();return Ooe.neighbors(t,n).filter(function(t){return e.isOnBoard(t)&&!1===e.getPieceAt(t).isEmpty()})}},{key:"getScores",value:function(e){var t=0,n=0;return e.getAllPieces().map(function(r){var i=e.getPieceAt(r);i.belongsTo(ete.ZERO)?t+=i.getSize():i.belongsTo(ete.ONE)&&(n+=i.getSize())}),[t,n]}}]),n}(Rre),Noe=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"getListMoves",value:function(e){var t=e.move,n=e.gameState,r=[];return Roe.getMovablePieces(n).forEach(function(e){return Roe.pieceTargets(n,e).forEach(function(t){var n=xoe.of(e,t);r.push(n)})}),0===r.length&&!1===t.equalsValue(xoe.PASS)&&r.push(xoe.PASS),r}},{key:"getBoardValue",value:function(e){var t=e.gameState,n=Roe.getScores(t);return 0===Roe.getMovablePieces(t).length?new yre(n[0]>n[1]?Number.MIN_SAFE_INTEGER:n[0]<n[1]?Number.MAX_SAFE_INTEGER:0):new yre(n[0]-n[1])}}]),n}(gre),Moe=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"getListMoves",value:function(e){var t=e.gameState,r=zv(Yv(n.prototype),"getListMoves",this).call(this,e),i=t.getCurrentPlayer().getOpponent();return ite.sortByDescending(r,function(e){X5(e!==xoe.PASS,"Cannot sort with DvonnMove.PASS");var n=t.getPieceAt(e.end);return n.belongsTo(i)?n.getSize():0}),r}},{key:"getBoardValue",value:function(e){var t=Roe.getGameStatus(e);if(t.isEndGame)return new yre(t.toBoardValue());var n=e.gameState,r=Roe.getScores(n),i=n.getAllPieces(),a=i.length,o=i.filter(function(e){return n.getPieceAt(e).belongsTo(ete.ZERO)}).length,s=i.filter(function(e){return n.getPieceAt(e).belongsTo(ete.ONE)}).length;return new yre((s*r[1]-o*r[0])/a)}}]),n}(Noe),Doe=Toe.EMPTY,Loe=Toe.NONE,Foe=Toe.SOURCE,Boe=Toe.PLAYER_ZERO,Voe=Toe.PLAYER_ONE,Uoe=new Toe(ete.ZERO,2,!1),zoe=new Toe(ete.ONE,2,!1),Hoe=new Toe(ete.ZERO,4,!1),Goe=new Toe(ete.ONE,4,!1),qoe=rp(function e(){tp(this,e),this.tutorial=[Lre.anyMove($localize($n||($n=Rv(["Moving"]))),$localize(Wn||(Wn=Rv(["At Dvonn, each hexagonal space contains a stack of pieces.\n        If no number is indicated on a stack, it means that it only contains one piece.\n        The number written on a stack indicates the number of pieces within that stack, hence the number of points its owner gets.\n        The owner of a stack is the one that has a piece at the top of the stack.\n        Only the owner of a stack can move it.\n        A stack cannot be moved if it is surrounded by 6 other stacks.\n        A stack is moved by as many spaces as there are pieces within, in a straight line, and it should land on an occupied space.\n        This line cannot move along the vertex of two neighboring spaces, as would a vertical move.\n        Therefore, there are six possible directions.\n        The player with dark pieces starts.<br/><br/>\n        You're playing Dark, click on a stack and move it by one space."]))),Ioe.getInitialState(),xoe.of(new ire(2,0),new ire(3,0)),$localize(jn||(jn=Rv(["Congratulations!"])))),Lre.fromPredicate($localize(Zn||(Zn=Rv(["Disconnection"]))),$localize(Yn||(Yn=Rv(['Pieces with a lightning strike are called "sources".\n        When a stack is not directly nor indirectly connected to a source, it is removed from the board.<br/><br/>\n        You\'re playing Dark, try to disconnect the stack of 4 pieces from your opponent. There are two ways of doing that, one is better than the other: try to find that one!']))),new Ioe([[Loe,Loe,Voe,Foe,Doe,Doe,Doe,Doe,Doe,Doe,Doe],[Loe,Doe,Boe,Doe,Doe,Doe,Doe,Doe,Doe,Doe,Doe],[Doe,Doe,Goe,Doe,Doe,Doe,Doe,Voe,Foe,Doe,Doe],[Doe,Doe,Doe,Doe,Doe,Doe,Doe,Doe,Doe,Doe,Loe],[Doe,Doe,Doe,Doe,Doe,Doe,Doe,Doe,Doe,Loe,Loe]],0,!1),xoe.of(new ire(2,1),new ire(2,0)),function(e,t){return e.end.equals(new ire(3,0))?K5.failure($localize(Kn||(Kn=Rv(["You have successfully disconnected the stack of 4 pieces of your opponent, but on the next move your opponent will be able to move on your new stack, and to win the game! There exists a better outcome of this situation, try to find it."])))):(X5(e.end.equals(new ire(2,0)),"player made an impossible move"),K5.SUCCESS)},$localize(Jn||(Jn=Rv(["Nice, you have disconnected 4 pieces of your opponent, and your new stack cannot be reached by your opponent!\n        Your opponent therefore lost 5 points: 4 from the disconnected stack, and one from the stack on which you moved.\n        Disconnected stacks will not be visible at the next turn."])))),Lre.fromPredicate($localize(Qn||(Qn=Rv(["Moving on a source"]))),$localize(Xn||(Xn=Rv(["You are allowed to move your stacks on any other stack.\n        This means that you can take control of a source by moving one of your stack on top of it.\n        This way, you know that this stack may never be disconnected, as it contains a source.<br/><br/>\n        You're playing Dark and you can take control of a source, do it!"]))),new Ioe([[Loe,Loe,Foe,Voe,Doe,Doe,Doe,Doe,Doe,Doe,Doe],[Loe,Boe,Boe,Doe,Doe,Doe,Doe,Doe,Doe,Doe,Doe],[Doe,Voe,Boe,Voe,Doe,Doe,Boe,zoe,Foe,Doe,Doe],[Doe,Doe,Voe,Doe,Doe,Doe,Doe,Doe,Doe,Doe,Loe],[Doe,Doe,Doe,Doe,Doe,Doe,Doe,Doe,Doe,Loe,Loe]],0,!1),xoe.of(new ire(2,1),new ire(2,0)),function(e,t){return e.end.equals(new ire(2,0))?K5.SUCCESS:K5.failure($localize(er||(er=Rv(["You have not taken possession of a source, try again."]))))},$localize(tr||(tr=Rv(["Congratulations! However, note that your opponent could later take possession of one of your stack that contains a source, so watch out when you take control of sources!"])))),Lre.informational($localize(nr||(nr=Rv(["Passing"]))),$localize(rr||(rr=Rv(["It can happen that you have no possible move to make.\n        If this is the case, and if your opponent can still move, you must pass your turn.<br/><br/>\n        This is a situation that occurs here for Dark."]))),new Ioe([[Loe,Loe,Foe,Doe,Doe,Doe,Doe,Doe,Doe,Doe,Doe],[Loe,Doe,Uoe,Doe,Doe,Doe,Doe,Doe,Doe,Doe,Doe],[Doe,Doe,zoe,Doe,Doe,Doe,Doe,zoe,Foe,Hoe,Doe],[Doe,Doe,Doe,Doe,Doe,Doe,Doe,Doe,Doe,Doe,Loe],[Doe,Doe,Doe,Doe,Doe,Doe,Doe,Doe,Doe,Loe,Loe]],0,!1)),Lre.fromMove($localize(ir||(ir=Rv(["End of the game"]))),$localize(ar||(ar=Rv(["When no more move is possible for both players, the game ends and the player with the most points wins.<br/><br/>\n        Make your last move."]))),new Ioe([[Loe,Loe,Foe,Doe,Doe,Doe,Doe,Doe,Doe,Doe,Doe],[Loe,Doe,Boe,Doe,Doe,Doe,Doe,Doe,Doe,Doe,Doe],[Doe,Doe,Doe,Doe,Doe,Doe,Doe,Doe,Foe,Hoe,Doe],[Doe,Doe,Doe,Doe,Doe,Doe,Doe,Doe,Doe,Doe,Loe],[Doe,Doe,Doe,Doe,Doe,Doe,Doe,Doe,Doe,Loe,Loe]],0,!1),[xoe.of(new ire(2,1),new ire(2,0))],$localize(or||(or=Rv(["Congratulations, you won 6 - 0!"]))),$localize(sr||(sr=Rv(["Bad idea, by moving on the source you would have won a point."]))))]});function $oe(e,t){if(1&e&&(_m(),fb(0,"circle",10)),2&e){var n=wb().$implicit,r=wb().$implicit,i=wb();ub("ngClass",i.getPieceClasses(n)),tb("cx",i.getCenterAt(r).x)("cy",i.getCenterAt(r).y)("r",i.SPACE_SIZE)}}function Woe(e,t){if(1&e&&(_m(),fb(0,"polygon",11)),2&e){var n=wb().$implicit,r=wb().$implicit,i=wb();tb("transform",1===n.getSize()?"translate("+(i.getCenterAt(r).x-18)+" "+(i.getCenterAt(r).y-16)+") scale(0.10)":"translate("+(i.getCenterAt(r).x-3)+" "+(i.getCenterAt(r).y-12)+") scale(0.07)")}}function joe(e,t){if(1&e){var n=pb();_m(),lb(0,"text",12),mb("click",function(){$y(n);var e=wb(2).$implicit;return wb().onClick(e.x,e.y)}),Rb(1),hb()}if(2&e){var r=wb().$implicit,i=wb().$implicit,a=wb();tb("x",r.containsSource()?a.getCenterAt(i).x-7:a.getCenterAt(i).x)("y",a.getCenterAt(i).y),Pw(1),Nb(r.getSize())}}function Zoe(e,t){if(1&e){var n=pb();_m(),lb(0,"g",5),mb("click",function(){$y(n);var e=wb().$implicit;return wb().onClick(e.x,e.y)}),fb(1,"polyline",6),ab(2,$oe,1,4,"circle",7),ab(3,Woe,1,1,"polygon",8),ab(4,joe,2,3,"text",9),hb()}if(2&e){var r=t.$implicit,i=wb().$implicit,a=wb();bb("id","click_",i.x,"_",i.y,""),Pw(1),tb("points",a.getHexaCoordsAt(i)),Pw(1),ub("ngIf",r.getSize()>0),Pw(1),ub("ngIf",r.containsSource()),Pw(1),ub("ngIf",r.getSize()>1)}}var Yoe=function(e){return[e]};function Koe(e,t){if(1&e&&(_m(),lb(0,"g"),ab(1,Zoe,5,6,"g",4),hb()),2&e){var n=t.$implicit,r=wb();Pw(1),ub("ngForOf",tP(1,Yoe,r.state.getPieceAt(n)))}}function Joe(e,t){if(1&e&&(_m(),lb(0,"text",16),Rb(1),hb()),2&e){var n=wb().$implicit,r=wb();tb("x",r.getCenterAt(n.coord).x)("y",r.getCenterAt(n.coord).y),Pw(1),Nb(n.caseContent.getSize())}}function Qoe(e,t){if(1&e&&(_m(),lb(0,"g"),fb(1,"polyline",13),fb(2,"circle",14),ab(3,Joe,2,3,"text",15),hb()),2&e){var n=t.$implicit,r=wb();Pw(1),tb("points",r.getHexaCoordsAt(n.coord)),Pw(1),bb("id","captured_",n.coord.x,"_",n.coord.y,""),ub("ngClass",r.getPieceClasses(n.caseContent)),tb("cx",r.getCenterAt(n.coord).x)("cy",r.getCenterAt(n.coord).y)("r",r.SPACE_SIZE),Pw(1),ub("ngIf",n.caseContent.getSize()>1)}}function Xoe(e,t){if(1&e&&(_m(),db(0),fb(1,"polyline",17),fb(2,"polyline",17),vb()),2&e){var n=wb();Pw(1),tb("points",n.getHexaCoordsAt(n.lastMove.get().coord)),Pw(1),tb("points",n.getHexaCoordsAt(n.lastMove.get().end))}}function ese(e,t){if(1&e&&(_m(),fb(0,"polyline",18)),2&e){var n=wb();tb("points",n.getHexaCoordsAt(n.chosen.get()))}}var tse=function(){var e=function(e){Gv(n,e);var t=$v(n);function n(e){var r;return tp(this,n),(r=t.call(this,e)).lastMove=sB.empty(),r.chosen=sB.empty(),r.disconnecteds=[],r.rules=new Roe(Ioe),r.availableMinimaxes=[new Noe(r.rules,"DvonnMinimax"),new Moe(r.rules,"DvonnMinimaxMaximizeStacks")],r.encoder=xoe.encoder,r.tutorial=(new qoe).tutorial,r.SPACE_SIZE=30,r.canPass=!1,r.scores=sB.of(Roe.getScores(r.rules.node.gameState)),r.hexaLayout=new hre(1.5*r.SPACE_SIZE,new ire(-r.SPACE_SIZE,2*r.SPACE_SIZE),dre.INSTANCE),r.state=r.rules.node.gameState,r.hexaBoard=r.rules.node.gameState.board,r}return rp(n,[{key:"hideLastMove",value:function(){this.lastMove=sB.empty()}},{key:"updateBoard",value:function(){this.cancelMoveAttempt(),this.state=this.rules.node.gameState,this.lastMove=this.rules.node.move,this.disconnecteds=[],this.lastMove.isPresent()?this.calculateDisconnecteds():this.hideLastMove(),this.canPass=this.rules.canOnlyPass(this.state),this.scores=sB.of(Roe.getScores(this.state))}},{key:"calculateDisconnecteds",value:function(){for(var e=this.rules.node.mother.get().gameState,t=this.rules.node.gameState,n=0;n<t.board.length;n++)for(var r=0;r<t.board[n].length;r++){var i=new ire(r,n);if(!0===t.isOnBoard(i)&&!1===i.equals(this.lastMove.get().coord)){var a=t.getPieceAt(i),o=e.getPieceAt(i);if(a.isEmpty()&&!o.isEmpty()){var s={coord:new ire(r,n),caseContent:o};this.disconnecteds.push(s)}}}}},{key:"cancelMoveAttempt",value:function(){this.chosen=sB.empty()}},{key:"pass",value:function(){var e=this;return tB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return X5(e.canPass,"DvonnComponent: pass() can only be called if canPass is true"),t.next=3,e.chooseMove(xoe.PASS,e.rules.node.gameState);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}},t)}))()}},{key:"onClick",value:function(e,t){var n=this;return tB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=5;break}r.t0=n.cancelMove(i.getReason()),r.next=18;break;case 5:if(!n.chosen.isAbsent()){r.next=9;break}r.t1=n.choosePiece(e,t),r.next=17;break;case 9:if(!n.chosen.equalsValue(new ire(e,t))){r.next=13;break}r.t2=(n.cancelMoveAttempt(),K5.SUCCESS),r.next=16;break;case 13:return r.next=15,n.chooseDestination(e,t);case 15:r.t2=r.sent;case 16:r.t1=r.t2;case 17:r.t0=r.t1;case 18:return r.abrupt("return",r.t0);case 19:case"end":return r.stop()}},r)}))()}},{key:"choosePiece",value:function(e,t){var n=new ire(e,t),r=this.rules.isMovablePiece(this.rules.node.gameState,n);return r.isSuccess()?(this.chosen=sB.of(n),K5.SUCCESS):this.cancelMove(r.getReason())}},{key:"chooseDestination",value:function(e,t){var n=this;return tB(regeneratorRuntime.mark(function r(){var i,a,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=n.chosen.get(),a=new ire(e,t),o=xoe.of(i,a),r.abrupt("return",n.chooseMove(o,n.rules.node.gameState));case 2:case"end":return r.stop()}},r)}))()}},{key:"getPieceClasses",value:function(e){if(e.containsSource()&&1===e.getSize())return["other-piece","dashed-stroke"];var t=this.getPlayerClass(e.getOwner());return e.containsSource()?[t,"other-piece-stroke","dashed-stroke"]:[t]}}]),n}(ure);return e.\u0275fac=function(t){return new(t||e)(sb(ore))},e.\u0275cmp=ey({type:e,selectors:[["app-dvonn"]],features:[zC],decls:5,vars:4,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 0 875 380","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf"],["class","base no-fill selected",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base","mid-stroke"],["class","base mid-stroke",3,"ngClass",4,"ngIf"],["class","other-piece-light","points","157.055,0 90.798,196.319 164.417,196.319 88.344,400 289.571,159.509 218.405,159.509 311.656,0",4,"ngIf"],["class","text-center text-medium","dy","13",3,"click",4,"ngIf"],[1,"base","mid-stroke",3,"ngClass"],["points","157.055,0 90.798,196.319 164.417,196.319 88.344,400 289.571,159.509 218.405,159.509 311.656,0",1,"other-piece-light"],["dy","13",1,"text-center","text-medium",3,"click"],[1,"base","mid-stroke","captured"],[1,"base","mid-stroke","transparent",3,"id","ngClass"],["class","text-center text-big","dy","17",4,"ngIf"],["dy","17",1,"text-center","text-big"],[1,"base","no-fill","highlighted"],[1,"base","no-fill","selected"]],template:function(e,t){1&e&&(_m(),lb(0,"svg",0),ab(1,Koe,2,3,"g",1),ab(2,Qoe,4,8,"g",1),ab(3,Xoe,3,2,"ng-container",2),ab(4,ese,1,1,"polyline",3),hb()),2&e&&(Pw(1),ub("ngForOf",t.state.allCoords()),Pw(1),ub("ngForOf",t.disconnecteds),Pw(1),ub("ngIf",t.lastMove.isPresent()),Pw(1),ub("ngIf",t.chosen.isPresent()))},directives:[AT,NT,IT],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),nse=(function(e){e[e.NONE=0]="NONE",e[e.SMALL=1]="SMALL",e[e.MEDIUM=2]="MEDIUM",e[e.BIG=3]="BIG"}(nse||(nse={})),nse),rse=function(){function e(t){tp(this,e),this.value=t}return rp(e,[{key:"getPlayer",value:function(){switch(this){case e.SMALL_BLACK:case e.MEDIUM_BLACK:case e.BIG_BLACK:return ete.ZERO;case e.SMALL_WHITE:case e.MEDIUM_WHITE:case e.BIG_WHITE:return ete.ONE;default:return Xee.NONE}}},{key:"getSize",value:function(){switch(this){case e.BIG_BLACK:case e.BIG_WHITE:return nse.BIG;case e.MEDIUM_BLACK:case e.MEDIUM_WHITE:return nse.MEDIUM;case e.SMALL_BLACK:case e.SMALL_WHITE:return nse.SMALL;default:return nB.expectToBe(this,e.NONE),nse.NONE}}},{key:"belongsTo",value:function(e){return this.getPlayer()===e}},{key:"equals",value:function(e){return this===e}},{key:"toString",value:function(){switch(this){case e.BIG_BLACK:return"BIG_BLACK";case e.BIG_WHITE:return"BIG_WHITE";case e.MEDIUM_BLACK:return"MEDIUM_BLACK";case e.MEDIUM_WHITE:return"MEDIUM_WHITE";case e.SMALL_BLACK:return"SMALL_BLACK";case e.SMALL_WHITE:return"SMALL_WHITE";default:return nB.expectToBe(this,e.NONE),"NONE"}}}],[{key:"of",value:function(e){switch(e){case 0:return this.SMALL_BLACK;case 1:return this.SMALL_WHITE;case 2:return this.MEDIUM_BLACK;case 3:return this.MEDIUM_WHITE;case 4:return this.BIG_BLACK;case 5:return this.BIG_WHITE;case 6:return this.NONE;default:throw new Error("Invalid value "+e+" for EncapsulePiece")}}},{key:"ofSizeAndPlayer",value:function(t,n){return n===ete.ZERO&&t===nse.BIG?e.BIG_BLACK:n===ete.ZERO&&t===nse.MEDIUM?e.MEDIUM_BLACK:n===ete.ZERO&&t===nse.SMALL?e.SMALL_BLACK:n===ete.ONE&&t===nse.BIG?e.BIG_WHITE:n===ete.ONE&&t===nse.MEDIUM?e.MEDIUM_WHITE:n===ete.ONE&&t===nse.SMALL?e.SMALL_WHITE:e.NONE}}]),e}();rse.SMALL_BLACK=new rse(0),rse.SMALL_WHITE=new rse(1),rse.MEDIUM_BLACK=new rse(2),rse.MEDIUM_WHITE=new rse(3),rse.BIG_BLACK=new rse(4),rse.BIG_WHITE=new rse(5),rse.NONE=new rse(6);var ise=function(e){Gv(n,e);var t=$v(n);function n(e,r,i){var a;return tp(this,n),(a=t.call(this,e,r)).remainingPieces=i,a}return rp(n,[{key:"getRemainingPieces",value:function(){return ite.copyImmutableArray(this.remainingPieces)}},{key:"getRemainingPiecesOfPlayer",value:function(e){return this.getRemainingPieces().filter(function(t){return t.getPlayer()===e})}},{key:"pieceBelongsToCurrentPlayer",value:function(e){return e.belongsTo(this.getCurrentPlayer())}},{key:"isDroppable",value:function(e){return this.pieceBelongsToCurrentPlayer(e)&&this.isInRemainingPieces(e)}},{key:"isInRemainingPieces",value:function(e){return this.remainingPieces.some(function(t){return t===e})}},{key:"getPlayerRemainingPieces",value:function(){var e=this;return this.remainingPieces.filter(function(t){return e.pieceBelongsToCurrentPlayer(t)})}}],[{key:"getInitialState",value:function(){var e=new ase(Xee.NONE,Xee.NONE,Xee.NONE).encode(),t=ite.createTable(3,3,e);return new n(ite.mapBiArray(t,function(e){return ase.decode(e)}),0,[rse.BIG_BLACK,rse.BIG_BLACK,rse.BIG_WHITE,rse.BIG_WHITE,rse.MEDIUM_BLACK,rse.MEDIUM_BLACK,rse.MEDIUM_WHITE,rse.MEDIUM_WHITE,rse.SMALL_BLACK,rse.SMALL_BLACK,rse.SMALL_WHITE,rse.SMALL_WHITE])}}]),n}(wre),ase=function(){function e(t,n,r){tp(this,e),this.small=t,this.medium=n,this.big=r}return rp(e,[{key:"isEmpty",value:function(){return this.small===Xee.NONE&&this.medium===Xee.NONE&&this.big===Xee.NONE}},{key:"toList",value:function(){var e=[];return this.small.isPlayer()&&e.push(rse.ofSizeAndPlayer(nse.SMALL,this.small)),this.medium.isPlayer()&&e.push(rse.ofSizeAndPlayer(nse.MEDIUM,this.medium)),this.big.isPlayer()&&e.push(rse.ofSizeAndPlayer(nse.BIG,this.big)),e}},{key:"toOrderedPieceNames",value:function(){var e=rse.ofSizeAndPlayer(nse.SMALL,this.small),t=rse.ofSizeAndPlayer(nse.MEDIUM,this.medium),n=rse.ofSizeAndPlayer(nse.BIG,this.big);return[e.toString(),t.toString(),n.toString()]}},{key:"getBiggest",value:function(){return this.big===ete.ZERO?rse.BIG_BLACK:this.big===ete.ONE?rse.BIG_WHITE:this.medium===ete.ZERO?rse.MEDIUM_BLACK:this.medium===ete.ONE?rse.MEDIUM_WHITE:this.small===ete.ZERO?rse.SMALL_BLACK:this.small===ete.ONE?rse.SMALL_WHITE:rse.NONE}},{key:"tryToSuperposePiece",value:function(e){var t=this.getBiggest().getSize();if(e===rse.NONE)throw new Error("Cannot move NONE on a space");return e.getSize()>t?sB.of(this.put(e)):sB.empty()}},{key:"removeBiggest",value:function(){var t,n=this.getBiggest();if(n===rse.NONE)throw new Error("Cannot removed piece from empty space");var r=n.getSize();switch(r){case nse.BIG:t=new e(this.small,this.medium,Xee.NONE);break;case nse.MEDIUM:t=new e(this.small,Xee.NONE,Xee.NONE);break;default:nB.expectToBe(r,nse.SMALL),t=new e(Xee.NONE,Xee.NONE,Xee.NONE)}return{removedCase:t,removedPiece:n}}},{key:"put",value:function(t){if(t===rse.NONE)throw new Error("Cannot put NONE on space");var n=t.getPlayer(),r=t.getSize();switch(r){case nse.BIG:return new e(this.small,this.medium,n);case nse.MEDIUM:return X5(this.big===Xee.NONE,"Cannot put a piece on top of a bigger one"),new e(this.small,n,this.big);default:return nB.expectToBe(r,nse.SMALL),X5(this.big===Xee.NONE,"Cannot put a piece on top of a bigger one"),X5(this.medium===Xee.NONE,"Cannot put a piece on top of a bigger one"),new e(n,this.medium,this.big)}}},{key:"encode",value:function(){return this.small.value+3*this.medium.value+9*this.big.value}},{key:"belongsTo",value:function(e){return this.getBiggest().getPlayer()===e}},{key:"toString",value:function(){var e=this.toOrderedPieceNames();return"("+e[0]+", "+e[1]+", "+e[2]+")"}}],[{key:"decode",value:function(t){X5(t%1==0,"EncapsuleCase must be encoded as integer: "+t),X5(t>=0,"To small representation for EncapsuleCase: "+t),X5(t<=26,"To big representation for EncapsuleCase: "+t);var n=ete.numberEncoder.decodeNumber(t%3);t-=n.value;var r=ete.numberEncoder.decodeNumber((t/=3)%3);return t-=r.value,new e(n,r,ete.numberEncoder.decodeNumber(t/=3))}}]),e}();ase.EMPTY=new ase(Xee.NONE,Xee.NONE,Xee.NONE);var ose=function(){var e=rp(function e(){tp(this,e)});return e.PIECE_OUT_OF_STOCK=function(){return $localize(ur||(ur=Rv(["You do not have pieces of this type anymore."])))},e.INVALID_PLACEMENT=function(){return $localize(cr||(cr=Rv(["You must put your piece on an empty square or on a smaller piece."])))},e.NOT_DROPPABLE=function(){return $localize(lr||(lr=Rv(["You must pick your piece among the remaining ones."])))},e.INVALID_PIECE_SELECTED=function(){return $localize(hr||(hr=Rv(["You must pick one of your remaining pieces or one piece on the board that is the biggest of its square."])))},e.SAME_DEST_AS_ORIGIN=function(){return $localize(fr||(fr=Rv(["You must select a different landing square than the square where the move originates from."])))},e.END_YOUR_MOVE=function(){return $localize(dr||(dr=Rv(["You are performing a move, you must select a landing square."])))},e}(),sse=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"isLegal",value:function(e,t){return n.isLegal(e,t)}},{key:"applyLegalMove",value:function(e,t,n){var r,i=t.getCopiedBoard(),a=t.getRemainingPieces(),o=t.turn+1;if(i[e.landingCoord.y][e.landingCoord.x]=ase.decode(n.encode()),e.isDropping()){r=e.piece.get();var s=a.indexOf(r);a=a.slice(0,s).concat(a.slice(s+1))}else{var u=e.startingCoord.get(),c=i[u.y][u.x].encode(),l=ase.decode(c).removeBiggest();i[u.y][u.x]=ase.decode(l.removedCase.encode()),r=l.removedPiece}return new ise(i,o,a)}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"isVictory",value:function(e){var t,r=e.getCopiedBoard(),i=Qv(n.LINES);try{for(i.s();!(t=i.n()).done;){var a=t.value,o=n.isVictoriousLine([r[a[0].y][a[0].x],r[a[1].y][a[1].x],r[a[2].y][a[2].x]]);if(o.isPresent())return o}}catch(s){i.e(s)}finally{i.f()}return sB.empty()}},{key:"isVictoriousLine",value:function(e){var t=e.map(function(e){return e.getBiggest()}).map(function(e){return e.getPlayer()});return t[0]===Xee.NONE?sB.empty():t[0]===t[1]&&t[1]===t[2]?sB.of(t[0]):sB.empty()}},{key:"isLegal",value:function(e,t){var n;if(rB(!1,e.toString()),e.isDropping()){if(n=e.piece.get(),!1===t.pieceBelongsToCurrentPlayer(n))return j5.failure(pre.MUST_CHOOSE_PLAYER_PIECE());if(!1===t.isInRemainingPieces(n))return j5.failure(ose.PIECE_OUT_OF_STOCK())}else{var r=e.startingCoord.get();if(n=t.getPieceAt(r).getBiggest(),!1===t.pieceBelongsToCurrentPlayer(n))return j5.failure(pre.MUST_CHOOSE_PLAYER_PIECE())}var i=t.getPieceAt(e.landingCoord).tryToSuperposePiece(n);return i.isPresent()?j5.success(i.get()):j5.failure(ose.INVALID_PLACEMENT())}},{key:"getGameStatus",value:function(e){var t=n.isVictory(e.gameState);return t.isPresent()?Are.getVictory(t.get()):Are.ONGOING}}]),n}(Rre);sse.LINES=[[new ire(0,0),new ire(0,1),new ire(0,2)],[new ire(1,0),new ire(1,1),new ire(1,2)],[new ire(2,0),new ire(2,1),new ire(2,2)],[new ire(0,0),new ire(1,0),new ire(2,0)],[new ire(0,1),new ire(1,1),new ire(2,1)],[new ire(0,2),new ire(1,2),new ire(2,2)],[new ire(0,0),new ire(1,1),new ire(2,2)],[new ire(0,2),new ire(1,1),new ire(2,0)]];var use=function(e){Gv(n,e);var t=$v(n);function n(e,r,i){var a;return tp(this,n),(a=t.call(this)).startingCoord=e,a.landingCoord=r,a.piece=i,a}return rp(n,[{key:"isDropping",value:function(){return this.startingCoord.isAbsent()}},{key:"equals",value:function(e){return this===e||!1!==e.landingCoord.equals(this.landingCoord)&&!1!==this.startingCoord.equals(e.startingCoord)&&this.piece.equals(e.piece)}},{key:"toString",value:function(){return this.isDropping()?"EncapsuleMove("+this.piece.get().toString()+" -> "+this.landingCoord+")":"EncapsuleMove("+this.startingCoord.get()+"->"+this.landingCoord+")"}}],[{key:"fromMove",value:function(e,t){if(e.equals(t))throw new Error("Starting coord and landing coord must be separate coords");return new n(sB.of(e),t,sB.empty())}},{key:"fromDrop",value:function(e,t){return new n(sB.empty(),t,sB.of(e))}}]),n}(bre);use.encoder=new(function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"maxValue",value:function(){return 161}},{key:"encodeNumber",value:function(e){var t=e.landingCoord.x,n=e.landingCoord.y;if(e.isDropping()){return 18*e.piece.get().value+6*t+2*n+0}var r=e.startingCoord.get().y;return 54*e.startingCoord.get().x+18*r+6*t+2*n+1}},{key:"decodeNumber",value:function(e){var t=e%2;e-=t;var n=(e/=2)%3;e-=n;var r=(e/=3)%3;e-=r,e/=3;var i=new ire(r,n);if(0===t){var a=rse.of(e);return use.fromDrop(a,i)}var o=e%3;e-=o;var s=new ire((e/=3)%3,o);return use.fromMove(s,i)}}]),n}(Jee));var cse=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"getBoardValue",value:function(e){var t=sse.getGameStatus(e);return new yre(t.toBoardValue())}},{key:"getListMoves",value:function(e){for(var t=[],n=e.gameState,r=n.getCopiedBoard(),i=n.getCurrentPlayer(),a=mre.toComparableObjectSet(n.getPlayerRemainingPieces()),o=0;o<3;o++)for(var s=0;s<3;s++){var u,c=new ire(s,o),l=Qv(a);try{for(l.s();!(u=l.n()).done;){var h=u.value,f=use.fromDrop(h,c);sse.isLegal(f,n).isSuccess()&&t.push(f)}}catch(y){l.e(y)}finally{l.f()}if(r[o][s].belongsTo(i))for(var d=0;d<3;d++)for(var v=0;v<3;v++){var p=new ire(v,d);if(!p.equals(c)){var g=use.fromMove(c,p);sse.isLegal(g,n).isSuccess()&&t.push(g)}}}return t}}]),n}(gre),lse=new ase(Xee.NONE,Xee.NONE,Xee.NONE),hse=new ase(ete.ZERO,Xee.NONE,Xee.NONE),fse=new ase(Xee.NONE,ete.ZERO,Xee.NONE),dse=new ase(Xee.NONE,Xee.NONE,ete.ZERO),vse=new ase(ete.ONE,Xee.NONE,Xee.NONE),pse=new ase(Xee.NONE,Xee.NONE,ete.ONE),gse=new ase(ete.ONE,ete.ZERO,Xee.NONE),yse=new ase(ete.ZERO,ete.ZERO,Xee.NONE),mse=rp(function e(){tp(this,e),this.tutorial=[Lre.informational($localize(vr||(vr=Rv(["Goal of the game"]))),$localize(pr||(pr=Rv(["The goal of Encapsule is to align three of your pieces.\n        Here, we have a victory of the dark player."]))),new ise([[hse,vse,pse],[lse,fse,lse],[lse,lse,dse]],0,[rse.SMALL_BLACK,rse.MEDIUM_BLACK,rse.BIG_BLACK,rse.SMALL_WHITE,rse.MEDIUM_WHITE,rse.MEDIUM_WHITE,rse.BIG_WHITE])),Lre.anyMove($localize(gr||(gr=Rv(["Putting a piece"]))),$localize(yr||(yr=Rv(["This is the initial board. You're playing Dark.<br/><br/>\n        Pick one of your piece on the side of the board and put it on the board."]))),ise.getInitialState(),use.fromDrop(rse.SMALL_BLACK,new ire(1,1)),$localize(mr||(mr=Rv(["Congratulations!"])))),Lre.fromMove($localize(kr||(kr=Rv(["Moving"]))),$localize(_r||(_r=Rv(["Another possible action is to move one of your pieces that is already on the board.<br/><br/>\n        Click on your dark piece and then on any empty square of the board."]))),new ise([[hse,pse,lse],[lse,lse,lse],[lse,lse,lse]],0,[]),[use.fromMove(new ire(0,0),new ire(2,0)),use.fromMove(new ire(0,0),new ire(0,1)),use.fromMove(new ire(0,0),new ire(1,1)),use.fromMove(new ire(0,0),new ire(2,1)),use.fromMove(new ire(0,0),new ire(0,2)),use.fromMove(new ire(0,0),new ire(1,2)),use.fromMove(new ire(0,0),new ire(2,2))],$localize(wr||(wr=Rv(["Congratulations!"]))),$localize(Cr||(Cr=Rv(["Failed. Try again."])))),Lre.fromPredicate($localize(br||(br=Rv(["Particularity"]))),$localize(Er||(Er=Rv(['At Encapsule, pieces encapsulate each other.\n        It is therefore possible to have up to three pieces per square!\n        However, only the biggest piece of each square counts:\n        you cannot win with a piece that is "hidden" by a bigger piece.\n        Similarly, you cannot move a piece if it is encapsulated by a bigger piece.\n        Finally, you cannot encapsulate a piece with a smaller piece.\n        You\'re playing Dark and you can win now in various ways.<br/><br/>\n        Try to win by making a move, and not by putting a new piece on the board.']))),new ise([[gse,lse,vse],[yse,pse,pse],[lse,lse,lse]],0,[rse.MEDIUM_BLACK,rse.BIG_BLACK,rse.MEDIUM_WHITE,rse.MEDIUM_WHITE]),use.fromMove(new ire(0,1),new ire(0,2)),function(e,t){if(e.landingCoord.equals(new ire(0,2))){if(e.isDropping())return K5.failure($localize(Sr||(Sr=Rv(["You won, but the exercise is to win while moving a piece!"]))));if(e.startingCoord.equalsValue(new ire(0,1)))return K5.SUCCESS}return K5.failure($localize(Pr||(Pr=Rv(["Failed. Try again."]))))},$localize(Or||(Or=Rv(["Congratulations!"]))))]});function kse(e,t){if(1&e){var n=pb();_m(),lb(0,"g"),lb(1,"circle",5),mb("click",function(){var e=$y(n),t=e.$implicit,r=e.index;return wb().onPieceClick(0,t,r)}),hb(),hb()}if(2&e){var r=t.$implicit,i=t.index,a=wb();Pw(1),Cb("id","piece_0_",r.toString(),""),ub("ngClass",a.getSidePieceClasses(r,i)),tb("r",a.getPieceRadius(r))("cx",a.getPieceLeftX(0,i)+a.getPieceRadius(r))("cy",a.SPACE_SIZE/2)}}function _se(e,t){if(1&e){var n=pb();_m(),lb(0,"circle",8),mb("click",function(){$y(n);var e=wb().index,t=wb().index;return wb().onBoardClick(e,t)}),hb()}if(2&e){var r=t.$implicit,i=wb().index,a=wb().index,o=wb();ub("ngClass",o.getPieceClasses(r)),tb("r",o.getPieceRadius(r))("cx",o.SPACE_SIZE*i+o.STROKE_WIDTH+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*a+o.STROKE_WIDTH+o.SPACE_SIZE/2)}}function wse(e,t){if(1&e){var n=pb();_m(),lb(0,"g"),lb(1,"rect",6),mb("click",function(){var e=$y(n).index,t=wb().index;return wb().onBoardClick(e,t)}),hb(),ab(2,_se,1,4,"circle",7),hb()}if(2&e){var r=t.$implicit,i=t.index,a=wb().index,o=wb();Pw(1),bb("id","click_",i,"_",a,""),ub("ngClass",o.getRectClasses(i,a)),tb("x",o.SPACE_SIZE*i+o.STROKE_WIDTH)("y",o.SPACE_SIZE*a+o.STROKE_WIDTH)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),Pw(1),ub("ngForOf",o.getListPieces(r))}}function Cse(e,t){if(1&e&&(_m(),lb(0,"g"),ab(1,wse,3,8,"g",2),hb()),2&e){var n=t.$implicit;Pw(1),ub("ngForOf",n)}}function bse(e,t){if(1&e){var n=pb();_m(),lb(0,"g"),lb(1,"rect",9),mb("click",function(){var e=$y(n).$implicit;return wb().onBoardClick(e.x,e.y)}),hb(),hb()}if(2&e){var r=t.$implicit,i=wb();Pw(1),tb("x",i.SPACE_SIZE*r.x+i.STROKE_WIDTH)("y",i.SPACE_SIZE*r.y+i.STROKE_WIDTH)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)}}function Ese(e,t){if(1&e){var n=pb();_m(),lb(0,"g"),lb(1,"circle",5),mb("click",function(){var e=$y(n),t=e.$implicit,r=e.index;return wb().onPieceClick(1,t,r)}),hb(),hb()}if(2&e){var r=t.$implicit,i=t.index,a=wb();Pw(1),Cb("id","piece_1_",r.toString(),""),ub("ngClass",a.getSidePieceClasses(r,i)),tb("r",a.getPieceRadius(r))("cx",a.getPieceLeftX(1,i)+a.getPieceRadius(r))("cy",a.SPACE_SIZE/2)}}var Sse=function(){var e=function(e){Gv(n,e);var t=$v(n);function n(e){var r;return tp(this,n),(r=t.call(this,e)).INTER_PIECE_SPACE=20,r.lastLandingCoord=sB.empty(),r.lastStartingCoord=sB.empty(),r.chosenCoord=sB.empty(),r.chosenPiece=sB.empty(),r.remainingPieceLeftX=[],r.rules=new sse(ise),r.availableMinimaxes=[new cse(r.rules,"EncapsuleMinimax")],r.encoder=use.encoder,r.tutorial=(new mse).tutorial,r.updateBoard(),r}return rp(n,[{key:"updateBoard",value:function(){this.board=this.rules.node.gameState.getCopiedBoard();var e=this.rules.node.move;this.calculateLeftX(),e.isPresent()?(this.lastLandingCoord=sB.of(e.get().landingCoord),this.lastStartingCoord=e.get().startingCoord):(this.lastLandingCoord=sB.empty(),this.lastStartingCoord=sB.empty())}},{key:"getListPieces",value:function(e){return e.toList()}},{key:"getRemainingPieces",value:function(e){return this.rules.node.gameState.getRemainingPiecesOfPlayer(ete.of(e))}},{key:"onBoardClick",value:function(e,t){var n=this;return tB(regeneratorRuntime.mark(function r(){var i,a,o,s,u;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:if(a=new ire(e,t),o=n.rules.node.gameState,!n.chosenCoord.isAbsent()){r.next=9;break}if(n.chosenCoord=sB.of(a),!n.chosenPiece.isPresent()){r.next=8;break}return s=use.fromDrop(n.chosenPiece.get(),a),r.abrupt("return",n.chooseMove(s,n.rules.node.gameState));case 8:return r.abrupt("return",!1===o.getPieceAt(a).belongsTo(o.getCurrentPlayer())?n.cancelMove(ose.INVALID_PIECE_SELECTED()):K5.SUCCESS);case 9:if(!n.chosenCoord.equalsValue(a)){r.next=11;break}return r.abrupt("return",n.cancelMove(ose.SAME_DEST_AS_ORIGIN()));case 11:return u=use.fromMove(n.chosenCoord.get(),a),r.abrupt("return",n.chooseMove(u,n.rules.node.gameState));case 13:case"end":return r.stop()}},r)}))()}},{key:"cancelMoveAttempt",value:function(){this.chosenCoord=sB.empty(),this.chosenPiece=sB.empty(),this.chosenPieceIndex=-1}},{key:"onPieceClick",value:function(e,t,n){var r=this;return tB(regeneratorRuntime.mark(function i(){var a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return a=r.canUserPlay("#piece_"+e+"_"+t.toString()),i.abrupt("return",a.isFailure()?r.cancelMove(a.getReason()):!1===r.rules.node.gameState.isDroppable(t)?r.cancelMove(ose.NOT_DROPPABLE()):r.chosenCoord.isAbsent()?(r.chosenPiece=sB.of(t),r.chosenPieceIndex=n,K5.SUCCESS):r.cancelMove(ose.END_YOUR_MOVE()));case 2:case"end":return i.stop()}},i)}))()}},{key:"getRectClasses",value:function(e,t){return this.isSelected(e,t)?"moved":""}},{key:"isSelected",value:function(e,t){var n=new ire(e,t);return!(!this.lastStartingCoord.equalsValue(n)&&!this.lastLandingCoord.equalsValue(n))}},{key:"getPieceClasses",value:function(e){return[this.getPieceStrokeClass(e)]}},{key:"getPieceStrokeClass",value:function(e){var t=e.getPlayer();return X5(t.isPlayer(),"EncapsuleComponent.getPieceStrokeClass should only be called with actual pieces!"),"player"+t.value+"-stroke"}},{key:"getPieceRadius",value:function(e){switch(e.getSize()){case nse.BIG:return 40;case nse.MEDIUM:return 30;default:return nB.expectToBe(e.getSize(),nse.SMALL),20}}},{key:"getHighlightedCases",value:function(){var e=[];return this.chosenCoord.isPresent()&&e.push(this.chosenCoord.get()),e}},{key:"getSidePieceClasses",value:function(e,t){var n=this.getPieceClasses(e);return this.isSelectedPiece(e)&&this.chosenPieceIndex===t&&n.push("clickable "),n}},{key:"isSelectedPiece",value:function(e){return this.chosenPiece.equalsValue(e)}},{key:"calculateLeftX",value:function(){this.remainingPieceLeftX=[];for(var e=0;e<=1;e++){this.remainingPieceLeftX.push([]);for(var t=this.getRemainingPieces(e),n=0;n<t.length;n++)if(0===n)this.remainingPieceLeftX[e].push(0);else{var r=this.remainingPieceLeftX[e][n-1],i=2*this.getPieceRadius(t[n-1]);this.remainingPieceLeftX[e].push(r+i+this.INTER_PIECE_SPACE)}}}},{key:"getPieceLeftX",value:function(e,t){return this.remainingPieceLeftX[e][t]}}]),n}(yie);return e.\u0275fac=function(t){return new(t||e)(sb(ore))},e.\u0275cmp=ey({type:e,selectors:[["app-encapsule"]],features:[zC],decls:11,vars:7,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 0 520 520","preserveAspectRatio","xMidYMid meet"],["remainingCasePlayerZero",""],[4,"ngFor","ngForOf"],["boardDiv",""],["remainingCasePlayerOne",""],["pointer-events","fill",1,"base","no-fill",3,"id","ngClass","click"],[1,"base",3,"id","ngClass","click"],["class","base no-fill",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"base","no-fill",3,"ngClass","click"],["pointer-events","fill",1,"base","no-fill","highlighted",3,"click"]],template:function(e,t){1&e&&(_m(),lb(0,"svg",0),lb(1,"g",null,1),ab(3,kse,2,5,"g",2),hb(),lb(4,"g",null,3),ab(6,Cse,2,1,"g",2),ab(7,bse,2,4,"g",2),hb(),lb(8,"g",null,4),ab(10,Ese,2,5,"g",2),hb(),hb()),2&e&&(Pw(1),tb("transform","translate("+t.STROKE_WIDTH+", 0)"),Pw(2),ub("ngForOf",t.getRemainingPieces(0)),Pw(1),tb("transform","translate("+(260-1.5*t.SPACE_SIZE-t.STROKE_WIDTH)+", "+t.SPACE_SIZE+")"),Pw(2),ub("ngForOf",t.board),Pw(1),ub("ngForOf",t.getHighlightedCases()),Pw(1),tb("transform","translate("+t.STROKE_WIDTH+", "+(2*t.STROKE_WIDTH+4*t.SPACE_SIZE)+")"),Pw(2),ub("ngForOf",t.getRemainingPieces(1)))},directives:[AT,IT],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Pse=function(e){Gv(n,e);var t=$v(n);function n(e,r,i,a,o){var s;if(tp(this,n),(s=t.call(this,e,r)).movedPieces=i,s.stepSize=a,s.direction=o,s.coord.isNotInRange(14,12))throw new Error("Illegal coord outside of board "+s.coord.toString()+".");if(i<1)throw new Error("Must select minimum one piece (got "+i+").");if(a<1)throw new Error("Step size must be minimum one (got "+a+").");if(a>i)throw new Error("Cannot move a phalanx further than its size (got step size "+a+" for "+i+" pieces).");return Wv(s)}return rp(n,[{key:"toString",value:function(){return"EpaminondasMove("+this.coord.toString()+", m:"+this.movedPieces+", s:"+this.stepSize+", "+this.direction.toString()+")"}},{key:"equals",value:function(e){return this===e||!(!this.coord.equals(e.coord)||this.movedPieces!==e.movedPieces||this.stepSize!==e.stepSize)&&this.direction.equals(e.direction)}}]),n}(Ere);Pse.encoder=new(function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"maxValue",value:function(){return 122303}},{key:"encodeNumber",value:function(e){var t=e.direction.toInt();return 8*e.coord.x*7*13*12+8*e.coord.y*7*13+8*(e.movedPieces-1)*7+8*(e.stepSize-1)+t}},{key:"decodeNumber",value:function(e){if(e%1!=0)throw new Error("EncodedMove must be an integer.");var t=e%8;e-=t;var n=(e/=8)%7;e-=n;var r=(e/=7)%13;e-=r;var i=(e/=13)%12;e-=i;var a=e/=12,o=nre.factory.fromInt(t);return new Pse(a,i,r+1,n+1,o.get())}}]),n}(Jee));var Ose=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"count",value:function(e,t){for(var n=0,r=0;r<14;r++)this.board[t][r]===e&&n++;return n}},{key:"doesOwnPiece",value:function(e){for(var t=0;t<12;t++)for(var n=0;n<14;n++)if(this.board[t][n]===e)return!0;return!1}}],[{key:"getInitialState",value:function(){var e=Xee.NONE,t=ete.ONE,r=ete.ZERO;return new n([[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[r,r,r,r,r,r,r,r,r,r,r,r,r,r],[r,r,r,r,r,r,r,r,r,r,r,r,r,r]],0)}}]),n}(wre),Tse=function(){var e=rp(function e(){tp(this,e)});return e.PHALANX_IS_LEAVING_BOARD=function(){return $localize(Tr||(Tr=Rv(["The move distance of your phalanx puts it out of the board."])))},e.SOMETHING_IN_PHALANX_WAY=function(){return $localize(Ir||(Ir=Rv(["There is something in the way of your phalanx."])))},e.PHALANX_SHOULD_BE_GREATER_TO_CAPTURE=function(){return $localize(xr||(xr=Rv(["Your phalanx must be bigger than the one you are capturing."])))},e.CASE_NOT_ALIGNED_WITH_SELECTED=function(){return $localize(Ar||(Ar=Rv(["This square is not aligned with the selected piece."])))},e.SINGLE_PIECE_MUST_MOVE_BY_ONE=function(){return $localize(Rr||(Rr=Rv(["A single piece can only move by one square."])))},e.SINGLE_PIECE_CANNOT_CAPTURE=function(){return $localize(Nr||(Nr=Rv(["A single piece cannot make a capture."])))},e.CASE_NOT_ALIGNED_WITH_PHALANX=function(){return $localize(Mr||(Mr=Rv(["This square is not aligned with the direction of the phalanx."])))},e.PHALANX_CANNOT_CONTAIN_PIECES_OUTSIDE_BOARD=function(){return $localize(Dr||(Dr=Rv(["A phalanx can't contain pieces outside of the board."])))},e.PHALANX_CANNOT_CONTAIN_EMPTY_CASE=function(){return $localize(Lr||(Lr=Rv(["A phalanx cannot contain an empty square."])))},e.PHALANX_CANNOT_CONTAIN_OPPONENT_PIECE=function(){return $localize(Fr||(Fr=Rv(["A phalanx cannot contain a piece of the opponent."])))},e}(),Ise=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"isLegal",value:function(e,t){return n.isLegal(e,t)}},{key:"applyLegalMove",value:function(e,t,n){return new Ose(n,t.turn+1)}},{key:"getGameStatus",value:function(e){var t=e.gameState,n=t.count(ete.ZERO,0),r=t.count(ete.ONE,11);if(t.turn%2==0){if(n>r)return Are.ZERO_WON}else if(r>n)return Are.ONE_WON;return!1===t.doesOwnPiece(ete.ZERO)?Are.ONE_WON:!1===t.doesOwnPiece(ete.ONE)?Are.ZERO_WON:Are.ONGOING}}],[{key:"isLegal",value:function(e,t){var r=this.getPhalanxValidity(t,e);if(r.isFailure())return j5.failure(r.getReason());var i=this.getLandingStatus(t,e);if(i.isFailure())return i;var a=ite.copyBiArray(i.get()),o=t.getCurrentOpponent(),s=n.getCaptureValidity(t,a,e,o);return s.isFailure()?s:j5.success(s.get())}},{key:"getPhalanxValidity",value:function(e,t){for(var n=t.coord,r=0,i=e.getCurrentOpponent();r<t.movedPieces;){if(n.isNotInRange(14,12))return K5.failure(Tse.PHALANX_CANNOT_CONTAIN_PIECES_OUTSIDE_BOARD());var a=e.getPieceAt(n);if(a===Xee.NONE)return K5.failure(Tse.PHALANX_CANNOT_CONTAIN_EMPTY_CASE());if(a===i)return K5.failure(Tse.PHALANX_CANNOT_CONTAIN_OPPONENT_PIECE());n=n.getNext(t.direction,1),r++}return K5.SUCCESS}},{key:"getLandingStatus",value:function(e,t){for(var n=e.getCopiedBoard(),r=e.getCurrentPlayer(),i=t.coord,a=t.coord.getNext(t.direction,t.movedPieces),o=0;o+1<t.stepSize;){if(n[i.y][i.x]=Xee.NONE,n[a.y][a.x]=r,a.isNotInRange(14,12))return j5.failure(Tse.PHALANX_IS_LEAVING_BOARD());if(e.getPieceAt(a).isPlayer())return j5.failure(Tse.SOMETHING_IN_PHALANX_WAY());o++,a=a.getNext(t.direction,1),i=i.getNext(t.direction,1)}return a.isNotInRange(14,12)?j5.failure(Tse.PHALANX_IS_LEAVING_BOARD()):e.getPieceAt(a)===r?j5.failure(pre.CANNOT_SELF_CAPTURE()):(n[i.y][i.x]=Xee.NONE,n[a.y][a.x]=r,j5.success(n))}},{key:"getCaptureValidity",value:function(e,t,n,r){for(var i=n.coord.getNext(n.direction,n.movedPieces+n.stepSize-1),a=0;i.isInRange(14,12)&&e.getPieceAt(i)===r;){if(a>0&&(t[i.y][i.x]=Xee.NONE),++a>=n.movedPieces)return j5.failure(Tse.PHALANX_SHOULD_BE_GREATER_TO_CAPTURE());i=i.getNext(n.direction,1)}return j5.success(t)}}]),n}(Rre),xse=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"getListMoves",value:function(e){var t=n.getListMoves(e);return ite.sortByDescending(t,function(e){return e.stepSize}),t}},{key:"getBoardValue",value:function(e){var t=this.ruler.getGameStatus(e);return new yre(t.isEndGame?t.toBoardValue():this.getPieceCountPlusRowDomination(e.gameState))}},{key:"getPieceCountPlusRowDomination",value:function(e){for(var t=0,n=0;n<12;n++){for(var r=0,i=[0,0],a=0;a<14;a++){var o=new ire(a,n),s=e.getPieceAt(o);if(s.isPlayer()){var u=s.getScoreModifier();t+=2002*u,i[s.value]=u,r+=u;for(var c=0,l=[nre.UP_LEFT,nre.UP,nre.UP_RIGHT];c<l.length;c++)for(var h=l[c],f=o.getNext(h,1);f.isInRange(14,12)&&e.getPieceAt(f)===s;)t+=1*u,f=f.getNext(h,1)}}0!==r&&(t+=Math.abs(r)/r*2),t+=1*i.reduce(function(e,t){return e+t})}return t}}],[{key:"getListMoves",value:function(e){for(var t,n=e.gameState.getCurrentPlayer(),r=e.gameState.getCurrentOpponent(),i=Xee.NONE,a=[],o=e.gameState,s=0;s<12;s++)for(var u=0;u<14;u++){var c=new ire(u,s);if(o.getPieceAt(c)===n){var l,h=Qv(nre.DIRECTIONS);try{for(h.s();!(l=h.n()).done;){for(var f=l.value,d=1,v=c.getNext(f,1);v.isInRange(14,12)&&o.getPieceAt(v)===n;)d+=1,v=v.getNext(f,1);for(var p=1;v.isInRange(14,12)&&p<=d&&o.getPieceAt(v)===i;)t=new Pse(u,s,d,p,f),a=this.addMove(a,t,o),p++,v=v.getNext(f,1);v.isInRange(14,12)&&p<=d&&o.getPieceAt(v)===r&&(t=new Pse(u,s,d,p,f),a=this.addMove(a,t,o))}}catch(g){h.e(g)}finally{h.f()}}}return a}},{key:"addMove",value:function(e,t,n){return Ise.isLegal(t,n).isSuccess()&&e.push(t),e}}]),n}(gre),Ase=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"getListMoves",value:function(e){var t=xse.getListMoves(e);return this.orderMovesByPhalanxSizeAndFilter(t,e.gameState)}},{key:"orderMovesByPhalanxSizeAndFilter",value:function(e,t){var n=this;return ite.sortByDescending(e,function(e){return e.movedPieces}),e.length>40?e.filter(function(e){return!!n.moveIsCapture(e,t)||e.movedPieces*Math.random()>1}):e}},{key:"moveIsCapture",value:function(e,t){var n=e.coord.getNext(e.direction,e.movedPieces+e.stepSize-1);return t.board[n.y][n.x]===t.getCurrentOpponent()}},{key:"getBoardValue",value:function(e){var t=this.ruler.getGameStatus(e);return new yre(t.isEndGame?t.toBoardValue():this.getPieceCountThenSupportThenAdvancement(e.gameState))}},{key:"getPieceCountThenSupportThenAdvancement",value:function(e){for(var t=0,n=0;n<12;n++)for(var r=0;r<14;r++){var i=new ire(r,n),a=e.getPieceAt(i);if(a.isPlayer()){var o=void 0,s=void 0;a===ete.ZERO?(o=12-n,s=[nre.UP_LEFT,nre.UP,nre.UP_RIGHT]):(o=n+1,s=[nre.DOWN_LEFT,nre.DOWN,nre.DOWN_RIGHT]);var u=a.getScoreModifier();t+=o*u,t+=149629*u;var c,l=Qv(s);try{for(l.s();!(c=l.n()).done;)for(var h=c.value,f=i.getNext(h,1);f.isInRange(14,12)&&e.getPieceAt(f)===a;)t+=337*u,f=f.getNext(h,1)}catch(d){l.e(d)}finally{l.f()}}}return t}}]),n}(gre),Rse=function(e){Gv(n,e);var t=$v(n);function n(){var e;return tp(this,n),(e=t.apply(this,arguments)).DOMINANCE_FACTOR=20,e.DEFENSE_FACTOR=5,e.TERRITORY_FACTOR=2,e.OFFENSE_FACTOR=10,e.CENTER_FACTOR=5,e.MOBILITY_FACTOR=.12,e}return rp(n,[{key:"getDominance",value:function(e){for(var t=0,n=0;n<12;n++)for(var r=0;r<14;r++){var i=e.getPieceAt(new ire(r,n));i.isPlayer()&&(t+=i.getScoreModifier())}return t*this.DOMINANCE_FACTOR}},{key:"getDefense",value:function(e){for(var t=0,n=0;n<14;n++)e.getPieceAt(new ire(n,11))===ete.ZERO&&(t+=ete.ZERO.getScoreModifier()),e.getPieceAt(new ire(n,0))===ete.ONE&&(t+=ete.ONE.getScoreModifier());return t*this.DEFENSE_FACTOR}},{key:"getTerritory",value:function(e){for(var t=0,n=0;n<12;n++)for(var r=0;r<14;r++){var i=e.getPieceAt(new ire(r,n));if(i.isPlayer()){for(var a=-1;a<=1;a++)for(var o=-1;o<=1;o++){var s=new ire(r+a,n+o);if(s.isInRange(14,12)){var u=e.getPieceAt(s);(u===i||u===Xee.NONE)&&(t+=1*i.getScoreModifier())}}t-=i.getScoreModifier()}}return t*this.TERRITORY_FACTOR}},{key:"getOffense",value:function(e){for(var t=0,n=0;n<14;n++)e.getPieceAt(new ire(n,0))===ete.ZERO&&(t+=ete.ZERO.getScoreModifier()),e.getPieceAt(new ire(n,11))===ete.ONE&&(t+=ete.ONE.getScoreModifier());return t*this.OFFENSE_FACTOR}},{key:"getCenter",value:function(e){for(var t=0,n=0;n<12;n++)for(var r=0;r<14;r++){var i=e.getPieceAt(new ire(r,n));i.isPlayer()&&(t+=i.getScoreModifier()*Math.sqrt((r-6.5)*(r-6.5)))}return t*this.CENTER_FACTOR}},{key:"getMobility",value:function(e){for(var t=0,n=0,r=0,i=0;i<12;i++)for(var a=0;a<14;a++){var o=new ire(a,i),s=e.getPieceAt(o);if(s.isPlayer()){var u,c=Qv(nre.DIRECTIONS);try{for(c.s();!(u=c.n()).done;){for(var l=u.value,h=1,f=o.getNext(l,1);f.isInRange(14,12)&&e.getPieceAt(f)===s;)h+=1,f=f.getNext(l,1);for(var d=1;f.isInRange(14,12)&&d<=h&&e.getPieceAt(f)===Xee.NONE;)d++,f=f.getNext(l,1);t+=d*d*s.getScoreModifier(),s===ete.ZERO?n=Math.max(n,d):s===ete.ONE&&(r=Math.max(r,d))}}catch(v){c.e(v)}finally{c.f()}}}return(t+n*ete.ZERO.getScoreModifier()+r*ete.ONE.getScoreModifier())*this.MOBILITY_FACTOR}},{key:"getBoardValue",value:function(e){var t=e.gameState,n=this.ruler.getGameStatus(e);if(n.isEndGame)return new yre(n.toBoardValue());var r=this.getDominance(t),i=this.getDefense(t),a=this.getTerritory(t),o=this.getCenter(t),s=this.getOffense(t),u=this.getMobility(t);return new yre(r+i+a+o+s+u)}}]),n}(xse),Nse=Xee.NONE,Mse=ete.ZERO,Dse=ete.ONE,Lse=rp(function e(){tp(this,e),this.tutorial=[Lre.informational($localize(Br||(Br=Rv(["Initial board"]))),$localize(Vr||(Vr=Rv(["This is the initial board of Epaminondas.\n        The top line is the starting line of Light.\n        The bottom line is the starting line of Dark."]))),Ose.getInitialState()),Lre.informational($localize(Ur||(Ur=Rv(["Goal of the game (1/2)"]))),$localize(zr||(zr=Rv(["After multiple moves, if at the beginning of its turn, a player has more pieces on the opponent's starting line\n        than the number of pieces the opponent has on the player's starting line, the player wins.\n        Here, it's Dark's turn to play: Dark has therefore won."]))),new Ose([[Nse,Nse,Nse,Nse,Nse,Mse,Nse,Nse,Dse,Dse,Dse,Dse,Dse,Dse],[Nse,Nse,Nse,Nse,Nse,Mse,Nse,Nse,Nse,Nse,Nse,Nse,Dse,Dse],[Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse],[Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse],[Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse],[Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse],[Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse],[Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse],[Nse,Nse,Nse,Nse,Nse,Nse,Nse,Dse,Nse,Nse,Nse,Nse,Nse,Nse],[Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse],[Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse],[Nse,Nse,Nse,Nse,Nse,Nse,Nse,Mse,Mse,Mse,Mse,Nse,Nse,Nse]],0)),Lre.informational($localize(Hr||(Hr=Rv(["Goal of the game (2/2)"]))),$localize(Gr||(Gr=Rv(["Here, it is Light's turn.\n        Light wins because they have two pieces on Dark's starting line, and Dark only has one on Light's starting line."]))),new Ose([[Nse,Nse,Nse,Nse,Nse,Mse,Nse,Nse,Nse,Nse,Dse,Dse,Dse,Dse],[Nse,Nse,Nse,Nse,Nse,Mse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse],[Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse],[Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse],[Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse],[Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse],[Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse],[Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse],[Nse,Nse,Nse,Nse,Nse,Nse,Nse,Dse,Nse,Nse,Nse,Nse,Nse,Nse],[Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse],[Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse],[Nse,Nse,Dse,Dse,Nse,Nse,Nse,Mse,Mse,Nse,Mse,Mse,Mse,Mse]],1)),Lre.fromPredicate($localize(qr||(qr=Rv(["Moving a piece"]))),$localize($r||($r=Rv(["Here is the starting board. Dark plays first.\n        Let's start with moving a single piece:\n        <ol>\n            <li>Click on a piece.</li>\n            <li>Click on a empty neighboring square.</li>\n        </ol>"]))),Ose.getInitialState(),new Pse(0,10,1,1,nre.UP),function(e,t){return 1===e.movedPieces?K5.SUCCESS:K5.failure($localize(Wr||(Wr=Rv(["Congratulations, you are in advance. But this is not the exercise here, try again."]))))},$localize(jr||(jr=Rv(["This is how you move a single piece."])))),Lre.fromPredicate($localize(Zr||(Zr=Rv(["Moving a phalanx"]))),$localize(Yr||(Yr=Rv(["Let us now see how to move multiple pieces along a line, which is called a phalanx:\n        <ol>\n            <li>Click on the first piece of the phalanx.</li>\n            <li>Click on the last piece of the phalanx.</li>\n            <li>Click on one of the squares highlighted in yellow; you can move your phalanx up to a distance equal to its length.</li>\n        </ol><br/>\n        Move a phalanx!"]))),Ose.getInitialState(),new Pse(0,11,2,1,nre.UP),function(e,t){return e.movedPieces>1?K5.SUCCESS:K5.failure($localize(Kr||(Kr=Rv(["Failed! You moved only one piece."]))))},$localize(Jr||(Jr=Rv(["Congratulations!\n        The moved pieces can be horizontally, vertically, or diagonally aligned.\n        The move should be made along this axis, forward or backwards.\n        There can be no opponent nor holes in the phalanx."])))),Lre.fromMove($localize(Qr||(Qr=Rv(["Capture"]))),$localize(Xr||(Xr=Rv(["In order to capture pieces of the opponent:\n        <ol>\n            <li>It must be aligned with the phalanx you are moving.</li>\n            <li>It must be strictly shorter than your phalanx.</li>\n            <li>The first piece of your phalanx should land on the first piece of the opponent's phalanx that you want to capture.</li>\n        </ol><br/>\n        Capture a phalanx."]))),new Ose([[Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Dse,Dse,Dse,Dse,Dse,Dse],[Nse,Nse,Nse,Nse,Nse,Nse,Dse,Nse,Nse,Nse,Nse,Nse,Nse,Nse],[Nse,Nse,Nse,Nse,Nse,Dse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse],[Nse,Nse,Dse,Nse,Dse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse],[Nse,Nse,Dse,Dse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse],[Nse,Nse,Dse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse],[Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse],[Nse,Nse,Mse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse],[Nse,Nse,Mse,Nse,Nse,Nse,Nse,Dse,Nse,Nse,Nse,Nse,Nse,Nse],[Nse,Nse,Mse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse],[Nse,Nse,Mse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse,Nse],[Nse,Nse,Nse,Nse,Nse,Nse,Nse,Mse,Mse,Mse,Mse,Mse,Mse,Mse]],0),[new Pse(2,10,4,2,nre.UP)],$localize(ei||(ei=Rv(["Congratulations, you made it!\n        Note that the diagonal phalanx was not aligned with your phalanx, hence even if it is longer, this does not prevent you from capturing some of its pieces on another alignment."]))),$localize(ti||(ti=Rv(["Failed, you have not captured the phalanx."]))))]});function Fse(e,t){if(1&e){var n=pb();_m(),lb(0,"circle",4),mb("click",function(){$y(n);var e=wb().index,t=wb().index;return wb().onClick(e,t)}),hb()}if(2&e){var r=wb().index,i=wb().index,a=wb();ub("ngClass",a.getPieceClasses(r,i)),tb("r",.5*(a.SPACE_SIZE-2*a.STROKE_WIDTH))("cx",a.SPACE_SIZE*r+a.STROKE_WIDTH+a.SPACE_SIZE/2)("cy",a.SPACE_SIZE*i+a.STROKE_WIDTH+a.SPACE_SIZE/2)}}function Bse(e,t){if(1&e){var n=pb();_m(),lb(0,"g"),lb(1,"rect",2),mb("click",function(){var e=$y(n).index,t=wb().index;return wb().onClick(e,t)}),hb(),ab(2,Fse,1,4,"circle",3),hb()}if(2&e){var r=t.index,i=wb().index,a=wb();Pw(1),bb("id","click_",r,"_",i,""),ub("ngClass",a.getRectClasses(r,i)),tb("x",a.SPACE_SIZE*r+a.STROKE_WIDTH)("y",a.SPACE_SIZE*i+a.STROKE_WIDTH)("width",a.SPACE_SIZE)("height",a.SPACE_SIZE),Pw(1),ub("ngIf",a.board[i][r]!==a.NONE)}}function Vse(e,t){if(1&e&&(_m(),lb(0,"g"),ab(1,Bse,3,8,"g",1),hb()),2&e){var n=t.$implicit;Pw(1),ub("ngForOf",n)}}function Use(e,t){if(1&e){var n=pb();_m(),lb(0,"g"),lb(1,"rect",5),mb("click",function(){var e=$y(n).$implicit;return wb().onClick(e.x,e.y)}),hb(),hb()}if(2&e){var r=t.$implicit,i=wb();Pw(1),tb("x",i.SPACE_SIZE*r.x+i.STROKE_WIDTH)("y",i.SPACE_SIZE*r.y+i.STROKE_WIDTH)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)}}var zse=function(){var e=function(e){Gv(n,e);var t=$v(n);function n(e){var r;return tp(this,n),(r=t.call(this,e)).NONE=Xee.NONE,r.firstPiece=sB.empty(),r.validExtensions=[],r.phalanxValidLandings=[],r.lastPiece=sB.empty(),r.phalanxDirection=sB.empty(),r.phalanxMiddles=[],r.moveds=[],r.captureds=[],r.rules=new Ise(Ose),r.availableMinimaxes=[new xse(r.rules,"Normal"),new Ase(r.rules,"Positional"),new Rse(r.rules,"Attack")],r.encoder=Pse.encoder,r.tutorial=(new Lse).tutorial,r.updateBoard(),r}return rp(n,[{key:"updateBoard",value:function(){this.firstPiece=sB.empty(),this.lastPiece=sB.empty(),this.hidePreviousMove(),this.rules.node.move.isPresent()&&this.showPreviousMove(),this.board=this.rules.node.gameState.getCopiedBoard()}},{key:"showPreviousMove",value:function(){var e=this.rules.node.move.get(),t=e.coord;this.moveds=[t];for(var n=1;n<e.stepSize+e.movedPieces;n++)t=t.getNext(e.direction,1),this.moveds.push(t);for(var r=this.rules.node.mother.get(),i=r.gameState.getCurrentOpponent();t.isInRange(14,12)&&r.gameState.getPieceAt(t)===i;)this.captureds.push(t),t=t.getNext(e.direction,1)}},{key:"onClick",value:function(e,t){var n=this;return tB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=n.canUserPlay("#click_"+e+"_"+t),r.abrupt("return",i.isFailure()?n.cancelMove(i.getReason()):n.firstPiece.isAbsent()?n.firstClick(e,t):n.lastPiece.isAbsent()?n.secondClick(e,t):n.thirdClick(e,t));case 2:case"end":return r.stop()}},r)}))()}},{key:"firstClick",value:function(e,t){var n=this;return tB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:i=n.rules.node.gameState.getCurrentOpponent(),a=n.rules.node.gameState.getCurrentPlayer(),r.t0=n.board[t][e],r.next=r.t0===a?4:r.t0===i?5:6;break;case 4:return r.abrupt("return",(n.firstPiece=sB.of(new ire(e,t)),n.validExtensions=n.getValidExtensions(a),n.phalanxValidLandings=n.getPhalanxValidLandings(),K5.SUCCESS));case 5:return r.abrupt("return",n.cancelMove(pre.CANNOT_CHOOSE_OPPONENT_PIECE()));case 6:return r.abrupt("return",(nB.expectToBe(n.board[t][e],Xee.NONE),n.cancelMove(pre.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY())));case 7:case"end":return r.stop()}},r)}))()}},{key:"hidePreviousMove",value:function(){this.captureds=[],this.moveds=[]}},{key:"getValidExtensions",value:function(e){return this.lastPiece.isPresent()?this.getPhalanxValidExtensions(e):this.getFirstPieceExtensions(e)}},{key:"getFirstPieceExtensions",value:function(e){var t,n=[],r=Qv(nre.DIRECTIONS);try{for(r.s();!(t=r.n()).done;)for(var i=t.value,a=this.firstPiece.get().getNext(i,1);a.isInRange(14,12)&&this.board[a.y][a.x]===e;)n.push(a),a=a.getNext(i,1)}catch(o){r.e(o)}finally{r.f()}return n}},{key:"getPhalanxValidExtensions",value:function(e){var t=nre.factory.fromMove(this.firstPiece.get(),this.lastPiece.get()).get(),n=this.lastPiece.get().getNext(t,1),r=this.getExtensionsToward(n,t,e);t=t.getOpposite();var i=this.firstPiece.get().getNext(t,1),a=this.getExtensionsToward(i,t,e);return r.concat(a)}},{key:"getExtensionsToward",value:function(e,t,n){for(var r=[];e.isInRange(14,12)&&this.board[e.y][e.x]===n;)r.push(e),e=e.getNext(t,1);return r}},{key:"getPhalanxValidLandings",value:function(){if(this.lastPiece.isPresent()){var e=this.firstPiece.get(),t=this.lastPiece.get(),n=Math.abs(e.x-t.x),r=Math.abs(e.y-t.y),i=Math.max(n,r)+1,a=nre.factory.fromMove(e,t).get(),o=t.getNext(a,1),s=this.getLandingsToward(o,a,i);a=a.getOpposite();var u=e.getNext(a,1);return this.getLandingsToward(u,a,i).concat(s)}return this.getNeighbooringEmptyCases()}},{key:"getNeighbooringEmptyCases",value:function(){var e,t=[],n=Qv(nre.DIRECTIONS);try{for(n.s();!(e=n.n()).done;){var r=e.value,i=this.firstPiece.get().getNext(r,1);i.isInRange(14,12)&&this.board[i.y][i.x]===Xee.NONE&&t.push(i)}}catch(a){n.e(a)}finally{n.f()}return t}},{key:"getLandingsToward",value:function(e,t,n){for(var r=this.rules.node.gameState.getCurrentPlayer(),i=this.rules.node.gameState.getCurrentOpponent(),a=[];e.isInRange(14,12)&&a.length<n&&this.board[e.y][e.x]!==r;){if(this.board[e.y][e.x]===i)return this.getPhalanxLength(e,t,i)<n&&a.push(e),a;a.push(e),e=e.getNext(t,1)}return a}},{key:"getPhalanxLength",value:function(e,t,n){for(var r=0;e.isInRange(14,12)&&this.board[e.y][e.x]===n;)r++,e=e.getNext(t,1);return r}},{key:"cancelMoveAttempt",value:function(){this.firstPiece=sB.empty(),this.validExtensions=[],this.phalanxValidLandings=[],this.lastPiece=sB.empty(),this.phalanxMiddles=[],this.hidePreviousMove()}},{key:"secondClick",value:function(e,t){var n=this;return tB(regeneratorRuntime.mark(function r(){var i,a,o,s,u,c,l,h;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=new ire(e,t),a=n.firstPiece.get(),!i.equals(a)){r.next=3;break}return r.abrupt("return",(n.cancelMoveAttempt(),K5.SUCCESS));case 3:if(o=n.rules.node.gameState.getCurrentOpponent(),s=n.rules.node.gameState.getCurrentPlayer(),i.isAlignedWith(a)){r.next=6;break}return r.abrupt("return",n.cancelMove(Tse.CASE_NOT_ALIGNED_WITH_SELECTED()));case 6:u=i.getDistance(a),c=a.getDirectionToward(i).get(),r.t0=n.board[t][e],r.next=r.t0===Xee.NONE?10:r.t0===o?11:12;break;case 10:return r.abrupt("return",1===u?n.tryMove(new Pse(a.x,a.y,1,1,c)):n.cancelMove(Tse.SINGLE_PIECE_MUST_MOVE_BY_ONE()));case 11:return r.abrupt("return",n.cancelMove(Tse.SINGLE_PIECE_CANNOT_CAPTURE()));case 12:return nB.expectToBe(n.board[t][e],s),l=new Pse(a.x,a.y,u,1,c),h=Ise.getPhalanxValidity(n.rules.node.gameState,l),r.abrupt("return",h.isFailure()?n.cancelMove(h.getReason()):(n.lastPiece=sB.of(i),n.validExtensions=n.getValidExtensions(s),n.phalanxValidLandings=n.getPhalanxValidLandings(),n.phalanxMiddles=a.getCoordsToward(i),n.phalanxDirection=sB.of(c),K5.SUCCESS));case 15:case"end":return r.stop()}},r)}))()}},{key:"thirdClick",value:function(e,t){var n=this;return tB(regeneratorRuntime.mark(function r(){var i,a,o,s,u,c,l,h,f,d,v,p;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=n.rules.node.gameState.getCurrentPlayer(),a=new ire(e,t),!n.firstPiece.equalsValue(a)){r.next=3;break}return r.abrupt("return",n.moveFirstPiece(i));case 3:if(!n.lastPiece.equalsValue(a)){r.next=5;break}return r.abrupt("return",n.moveLastPiece(i));case 5:if(o=n.firstPiece.get(),s=n.lastPiece.get(),a.isAlignedWith(o)){r.next=8;break}return r.abrupt("return",n.cancelMove(Tse.CASE_NOT_ALIGNED_WITH_PHALANX()));case 8:if(u=nre.factory.fromMove(o,s).get(),c=nre.factory.fromMove(o,a).get(),u===c.getOpposite()&&(n.firstPiece=sB.of(s),n.lastPiece=sB.of(o),u=c),u===c){r.next=12;break}return r.abrupt("return",n.cancelMove(Tse.CASE_NOT_ALIGNED_WITH_PHALANX()));case 12:if(n.board[t][e]!==i){r.next=16;break}return n.lastPiece=sB.of(a),l=n.firstPiece.get().getDistance(a)+1,h=new Pse(n.firstPiece.get().x,n.firstPiece.get().y,l,1,u),f=Ise.getPhalanxValidity(n.rules.node.gameState,h),r.abrupt("return",f.isFailure()?n.cancelMove(f.getReason()):(n.phalanxMiddles=n.firstPiece.get().getCoordsToward(n.lastPiece.get()),n.validExtensions=n.getValidExtensions(i),n.phalanxValidLandings=n.getPhalanxValidLandings(),K5.SUCCESS));case 16:return d=n.firstPiece.get().getDistance(n.lastPiece.get())+1,v=n.lastPiece.get().getDistance(a),p=new Pse(n.firstPiece.get().x,n.firstPiece.get().y,d,v,u),r.abrupt("return",n.tryMove(p));case 18:case"end":return r.stop()}},r)}))()}},{key:"moveFirstPiece",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(t.firstPiece=sB.of(t.firstPiece.get().getNext(t.phalanxDirection.get(),1)),!t.firstPiece.equals(t.lastPiece)){n.next=6;break}return n.next=4,t.moveOnlyPiece(e);case 4:n.next=7;break;case 6:t.phalanxMiddles=t.phalanxMiddles.slice(1),t.validExtensions=t.getPhalanxValidExtensions(e);case 7:return t.phalanxValidLandings=t.getPhalanxValidLandings(),n.abrupt("return",K5.SUCCESS);case 9:case"end":return n.stop()}},n)}))()}},{key:"moveLastPiece",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(t.lastPiece=sB.of(t.lastPiece.get().getPrevious(t.phalanxDirection.get(),1)),t.firstPiece.equals(t.lastPiece)?t.moveOnlyPiece(e):(t.phalanxMiddles=t.firstPiece.get().getCoordsToward(t.lastPiece.get()),t.validExtensions=t.getPhalanxValidExtensions(e),t.phalanxValidLandings=t.getPhalanxValidLandings(),K5.SUCCESS)));case 1:case"end":return n.stop()}},n)}))()}},{key:"moveOnlyPiece",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(t.lastPiece=sB.empty(),t.validExtensions=t.getFirstPieceExtensions(e),t.phalanxDirection=sB.empty(),t.phalanxMiddles=[],t.phalanxValidLandings=t.getPhalanxValidLandings(),K5.SUCCESS));case 1:case"end":return n.stop()}},n)}))()}},{key:"tryMove",value:function(e){var t=this.rules.node.gameState;return this.cancelMove(),this.chooseMove(e,t)}},{key:"getPieceClasses",value:function(e,t){var n=this.getPlayerClass(this.board[t][e]);return this.getPieceStrokeClasses(e,t).concat([n])}},{key:"getPieceStrokeClasses",value:function(e,t){var n=new ire(e,t);return this.firstPiece.isAbsent()?[]:this.firstPiece.equalsValue(n)||this.lastPiece.equalsValue(n)||this.phalanxMiddles.some(function(e){return e.equals(n)})?["highlighted"]:[]}},{key:"getRectClasses",value:function(e,t){var n=new ire(e,t);return this.captureds.some(function(e){return e.equals(n)})?["captured"]:this.moveds.some(function(e){return e.equals(n)})?["moved"]:[]}},{key:"getHighlightedCoords",value:function(){return this.firstPiece.isPresent()?this.phalanxValidLandings.concat(this.validExtensions):this.getCurrentPlayerPieces()}},{key:"getCurrentPlayerPieces",value:function(){for(var e=[],t=this.rules.node.gameState.getCurrentPlayer(),n=0;n<this.board.length;n++)for(var r=0;r<this.board[n].length;r++)this.board[n][r]===t&&e.push(new ire(r,n));return e}}]),n}(yie);return e.\u0275fac=function(t){return new(t||e)(sb(ore))},e.\u0275cmp=ey({type:e,selectors:[["app-epaminondas"]],features:[zC],decls:3,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 0 1410 1210","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass","click",4,"ngIf"],[1,"base",3,"ngClass","click"],[1,"no-fill","mid-stroke","clickable",3,"click"]],template:function(e,t){1&e&&(_m(),lb(0,"svg",0),ab(1,Vse,2,1,"g",1),ab(2,Use,2,4,"g",1),hb()),2&e&&(Pw(1),ub("ngForOf",t.board),Pw(1),ub("ngForOf",t.getHighlightedCoords()))},directives:[AT,IT,NT],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}();function Hse(e){return new(function(t){Gv(r,t);var n=$v(r);function r(){return tp(this,r),n.apply(this,arguments)}return rp(r,[{key:"encode",value:function(t){return t.isPresent()?e.encode(t.get()):null}},{key:"decode",value:function(t){return null===t?sB.empty():sB.of(e.decode(t))}}]),r}(Yee))}var Gse=function(){function e(t){if(tp(this,e),t.length<4)throw new Error("Cannot create a GipfCapture with less than 4 captured pieces");if(!1===Poe.areOnSameLine(t))throw new Error("Cannot create a GipfCapture with pieces that are not on the same line");this.capturedSpaces=ite.copyImmutableArray(t).sort(function(e,t){if(e.x===t.x){if(e.y===t.y)throw new Error("Cannot create a GipfCapture with duplicate cases");return e.y>t.y?1:-1}return e.x>t.x?1:-1});var n,r=sB.empty(),i=Qv(this.capturedSpaces);try{for(i.s();!(n=i.n()).done;){var a=n.value;if(r.isPresent()&&1!==r.get().getDistance(a))throw new Error("Cannot create a GipfCapture with non-consecutive cases");r=sB.of(a)}}catch(o){i.e(o)}finally{i.f()}}return rp(e,[{key:"toString",value:function(){var e,t="",n=Qv(this.capturedSpaces);try{for(n.s();!(e=n.n()).done;){var r=e.value;""!==t&&(t+=","),t+=r.toString()}}catch(i){n.e(i)}finally{n.f()}return t}},{key:"size",value:function(){return this.capturedSpaces.length}},{key:"forEach",value:function(e){this.capturedSpaces.forEach(e)}},{key:"contains",value:function(e){for(var t=0;t<this.capturedSpaces.length;t++)if(this.capturedSpaces[t].equals(e))return!0;return!1}},{key:"intersectsWith",value:function(e){return this.capturedSpaces.some(function(t){return e.contains(t)})}},{key:"getLine",value:function(){return Poe.fromTwoCoords(this.capturedSpaces[0],this.capturedSpaces[1]).get()}},{key:"equals",value:function(e){if(this===e)return!0;if(this.capturedSpaces.length!==e.capturedSpaces.length)return!1;for(var t=0;t<this.capturedSpaces.length;t++)if(!this.capturedSpaces[t].equals(e.capturedSpaces[t]))return!1;return!0}}]),e}();Gse.encoder=new(function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"encode",value:function(e){return e.capturedSpaces.map(function(e){return ire.encoder.encode(e)})}},{key:"decode",value:function(e){return new Gse(e.map(function(e){return ire.encoder.decode(e)}))}}]),n}(Yee));var qse=function(){function e(t,n){tp(this,e),this.coord=t,this.direction=n}return rp(e,[{key:"toString",value:function(){return this.direction.isPresent()?this.coord.toString()+"@"+this.direction.get().toString():this.coord.toString()}},{key:"equals",value:function(e){return!!this.coord.equals(e.coord)&&this.direction.equals(e.direction)}}]),e}();qse.encoder=new(function(e){Gv(n,e);var t=$v(n);function n(){var e;return tp(this,n),(e=t.apply(this,arguments)).optionalDirectionEncoder=Hse(lre.encoder),e}return rp(n,[{key:"encode",value:function(e){return{coord:ire.encoder.encode(e.coord),direction:this.optionalDirectionEncoder.encode(e.direction)}}},{key:"decode",value:function(e){var t=e;return X5(null!=t.coord,"Invalid encoded GipfPlacement"),new qse(ire.encoder.decode(t.coord),this.optionalDirectionEncoder.decode(t.direction))}}]),n}(Yee));var $se=function(e){Gv(n,e);var t=$v(n);function n(e,r,i){var a;return tp(this,n),(a=t.call(this)).placement=e,a.initialCaptures=r,a.finalCaptures=i,a}return rp(n,[{key:"toString",value:function(){return"GipfMove(["+this.capturesToString(this.initialCaptures)+"], "+this.placement.toString()+", ["+this.capturesToString(this.finalCaptures)+"])"}},{key:"capturesToString",value:function(e){var t,n="",r=Qv(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;""!==n&&(n+=","),n+="["+i.toString()+"]"}}catch(a){r.e(a)}finally{r.f()}return n}},{key:"equals",value:function(e){return this===e||!(!1===this.placement.equals(e.placement)||!1===ite.compareArray(this.initialCaptures,e.initialCaptures)||!1===ite.compareArray(this.finalCaptures,e.finalCaptures))}},{key:"encode",value:function(){return n.encoder.encode(this)}},{key:"decode",value:function(e){return n.encoder.decode(e)}}]),n}(bre);$se.encoder=new(function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"encodeMove",value:function(e){var t={placement:qse.encoder.encode(e.placement)};return e.initialCaptures.map(function(e,n){t["initialCapture"+n]=Gse.encoder.encode(e)}),e.finalCaptures.map(function(e,n){t["finalCapture"+n]=Gse.encoder.encode(e)}),t}},{key:"decodeMove",value:function(e){var t=e;return X5(null!=t.placement,"Invalid encoded GipfMove"),new $se(qse.encoder.decode(t.placement),this.decodeArray(t,"initialCapture",Gse.encoder.decode),this.decodeArray(t,"finalCapture",Gse.encoder.decode))}},{key:"decodeArray",value:function(e,t,n){for(var r=[],i=0;null!=e[t+i];i++)r.push(n(e[t+i]));return r}}]),n}(Kee));var Wse=function(e){Gv(n,e);var t=$v(n);function n(e,r,i,a){var o;return tp(this,n),(o=t.call(this,r,e,7,7,[3,2,1],cre.EMPTY)).sidePieces=i,o.capturedPieces=a,o}return rp(n,[{key:"equals",value:function(e){return this.turn===e.turn&&this.sidePieces[0]===e.sidePieces[0]&&this.sidePieces[1]===e.sidePieces[1]&&this.capturedPieces[0]===e.capturedPieces[0]&&this.capturedPieces[1]===e.capturedPieces[1]&&ite.compareTable(this.board,e.board)}},{key:"getNumberOfPiecesToPlace",value:function(e){return this.sidePieces[e.value]}},{key:"getNumberOfPiecesCaptured",value:function(e){return this.capturedPieces[e.value]}},{key:"setAtUnsafe",value:function(e,t){var r=ite.copyBiArray(this.board);return r[e.y][e.x]=t,new n(r,this.turn,this.sidePieces,this.capturedPieces)}},{key:"isOnBoard",value:function(e){return!e.isNotInRange(this.width,this.height)&&this.board[e.y][e.x]!==cre.NONE}}],[{key:"getInitialState",value:function(){var e=cre.EMPTY,t=cre.NONE,r=cre.ZERO,i=cre.ONE;return new n([[t,t,t,i,e,e,r],[t,t,e,e,e,e,e],[t,e,e,e,e,e,e],[r,e,e,e,e,e,i],[e,e,e,e,e,e,t],[e,e,e,e,e,t,t],[i,e,e,r,t,t,t]],0,[12,12],[0,0])}}]),n}(Ooe),jse=function(){var e=rp(function e(){tp(this,e)});return e.CAPTURE_MUST_BE_ALIGNED=function(){return $localize(ni||(ni=Rv(["You can only capture when 4 or more of your pieces are aligned, and it is not the case."])))},e.INVALID_CAPTURED_PIECES=function(){return $localize(ri||(ri=Rv(["You must select a valid capture that contains 4 pieces or more."])))},e.MISSING_CAPTURES=function(){return $localize(ii||(ii=Rv(["There are still possible captures to be done."])))},e.PLACEMENT_NOT_ON_BORDER=function(){return $localize(ai||(ai=Rv(["Pieces must be inserted in spaces on the edge of the board."])))},e.INVALID_PLACEMENT_DIRECTION=function(){return $localize(oi||(oi=Rv(["You must select a valid placement direction."])))},e.PLACEMENT_WITHOUT_DIRECTION=function(){return $localize(si||(si=Rv(["You must select a placement with a direction alongside the insertion space."])))},e.PLACEMENT_ON_COMPLETE_LINE=function(){return $localize(ui||(ui=Rv(["You cannot place a piece on a complete line."])))},e.AMBIGUOUS_CAPTURE_COORD=function(){return $localize(ci||(ci=Rv(["This piece belongs to two captures. Please select another piece in the capture you'd like to make."])))},e.CLICK_FURTHER_THAN_ONE_COORD=function(){return $localize(li||(li=Rv(["You must click on an arrow to select your destination."])))},e.NO_DIRECTIONS_AVAILABLE=function(){return $localize(hi||(hi=Rv(["You cannot insert a piece here, as all lines are full. Select another space."])))},e}(),Zse=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"applyLegalMove",value:function(e,t,n){return new Wse(n.board,n.turn+1,n.sidePieces,n.capturedPieces)}},{key:"getPiecesMoved",value:function(e,t,r){var i=n.applyCaptures(e,t);if(r.direction.isAbsent())return[r.coord];var a=r.direction.get(),o=[];o.push(r.coord);for(var s=r.coord.getNext(a);i.isOnBoard(s)&&i.getPieceAt(s)!==cre.EMPTY;)o.push(s),s=s.getNext(a);return X5(i.isOnBoard(s)&&i.getPieceAt(s)===cre.EMPTY,"getPiecesMoved called with an invalid placement performed on a full line"),o.push(s),o}},{key:"isLegal",value:function(e,t){var r=this.capturesValidity(t,e.initialCaptures);if(r.isFailure())return r.toFailedFallible();var i=n.applyCaptures(t,e.initialCaptures),a=this.noMoreCapturesValidity(i);if(a.isFailure())return a.toFailedFallible();var o=this.placementValidity(i,e.placement);if(o.isFailure())return o.toFailedFallible();var s=n.applyPlacement(i,e.placement),u=this.capturesValidity(s,e.finalCaptures);if(u.isFailure())return u.toFailedFallible();var c=n.applyCaptures(s,e.finalCaptures),l=this.noMoreCapturesValidity(c);return l.isFailure()?l.toFailedFallible():j5.success(c)}},{key:"capturesValidity",value:function(e,t){var r,i=e,a=Qv(t);try{for(a.s();!(r=a.n()).done;){var o=r.value,s=this.captureValidity(i,o);if(s.isFailure())return s;i=n.applyCapture(i,o)}}catch(u){a.e(u)}finally{a.f()}return K5.SUCCESS}},{key:"captureValidity",value:function(e,t){var r=e.getCurrentPlayer(),i=n.getLinePortionWithFourPiecesOfPlayer(e,r,t.getLine());if(i.isAbsent())return K5.failure(jse.CAPTURE_MUST_BE_ALIGNED());var a=i.get();return n.getCapturable(e,a).equals(t)?K5.SUCCESS:K5.failure(jse.INVALID_CAPTURED_PIECES())}},{key:"noMoreCapturesValidity",value:function(e){var t=e.getCurrentPlayer();return 0===n.getLinePortionsWithFourPiecesOfPlayer(e,t).length?K5.SUCCESS:K5.failure(jse.MISSING_CAPTURES())}},{key:"placementValidity",value:function(e,t){var r=this.placementCoordValidity(e,t.coord);if(r.isFailure())return r;if(e.getPieceAt(t.coord)!==cre.EMPTY){if(t.direction.isAbsent())return K5.failure(jse.PLACEMENT_WITHOUT_DIRECTION());if(n.isLineComplete(e,t.coord,t.direction.get()))return K5.failure(jse.PLACEMENT_ON_COMPLETE_LINE());var i,a=Qv(n.getAllDirectionsForEntrance(e,t.coord));try{for(a.s();!(i=a.n()).done;){if(i.value===t.direction.get())return K5.SUCCESS}}catch(o){a.e(o)}finally{a.f()}return K5.failure(jse.INVALID_PLACEMENT_DIRECTION())}return K5.SUCCESS}},{key:"placementCoordValidity",value:function(e,t){return vre.INSTANCE.isOnBorder(e,t)?K5.SUCCESS:K5.failure(jse.PLACEMENT_NOT_ON_BORDER())}},{key:"getGameStatus",value:function(e){var t=e.gameState,r=n.getPlayerScore(t,ete.ZERO),i=n.getPlayerScore(t,ete.ONE);return r.isAbsent()?Are.ONE_WON:i.isAbsent()?Are.ZERO_WON:Are.ONGOING}}],[{key:"applyCaptures",value:function(e,t){var r=e;return t.forEach(function(e){r=n.applyCapture(r,e)}),r}},{key:"applyCapture",value:function(e,t){var n=e.getCurrentPlayer(),r=e,i=[e.sidePieces[0],e.sidePieces[1]],a=[e.capturedPieces[0],e.capturedPieces[1]];return t.forEach(function(t){var o=e.getPieceAt(t);r=r.setAt(t,cre.EMPTY),o.is(n)?i[n.value]+=1:a[n.value]+=1}),new Wse(r.board,e.turn,i,a)}},{key:"getPlacements",value:function(e){var t=[];return vre.INSTANCE.getAllBorders(e).forEach(function(r){e.getPieceAt(r)===cre.EMPTY?t.push(new qse(r,sB.empty())):n.getAllDirectionsForEntrance(e,r).forEach(function(i){!1===n.isLineComplete(e,r,i)&&t.push(new qse(r,sB.of(i)))})}),t}},{key:"isLineComplete",value:function(e,t,r){return n.nextGapInLine(e,t,r).isAbsent()}},{key:"nextGapInLine",value:function(e,t,n){for(var r=t;e.isOnBoard(r);r=r.getNext(n))if(e.getPieceAt(r)===cre.EMPTY)return sB.of(r);return sB.empty()}},{key:"applyPlacement",value:function(e,t){var n=e.getCurrentPlayer(),r=e,i=cre.ofPlayer(e.getCurrentPlayer());if(t.direction.isAbsent()){var a=t.coord;if(e.getPieceAt(a)!==cre.EMPTY)throw new Error("Apply placement called without direction while the coord is occupied");r=r.setAt(a,i)}else for(var o=t.coord;r.isOnBoard(o)&&i!==cre.EMPTY;o=o.getNext(t.direction.get())){var s=e.getPieceAt(o);r=r.setAt(o,i),i=s}var u=[e.sidePieces[0],e.sidePieces[1]];return u[n.value]-=1,new Wse(r.board,e.turn,u,e.capturedPieces)}},{key:"getAllDirectionsForEntrance",value:function(e,t){if(vre.INSTANCE.isTopLeftCorner(e,t))return[lre.RIGHT,lre.DOWN,lre.UP_RIGHT];if(vre.INSTANCE.isTopCorner(e,t))return[lre.DOWN,lre.DOWN_LEFT,lre.RIGHT];if(vre.INSTANCE.isTopRightCorner(e,t))return[lre.DOWN_LEFT,lre.DOWN,lre.LEFT];if(vre.INSTANCE.isBottomLeftCorner(e,t))return[lre.UP_RIGHT,lre.UP,lre.RIGHT];if(vre.INSTANCE.isBottomCorner(e,t))return[lre.UP,lre.LEFT,lre.UP_RIGHT];if(vre.INSTANCE.isBottomRightCorner(e,t))return[lre.LEFT,lre.UP,lre.DOWN_LEFT];if(vre.INSTANCE.isOnTopLeftBorder(e,t))return[lre.RIGHT,lre.DOWN];if(vre.INSTANCE.isOnLeftBorder(e,t))return[lre.UP_RIGHT,lre.RIGHT];if(vre.INSTANCE.isOnBottomLeftBorder(e,t))return[lre.UP,lre.UP_RIGHT];if(vre.INSTANCE.isOnBottomRightBorder(e,t))return[lre.LEFT,lre.UP];if(vre.INSTANCE.isOnRightBorder(e,t))return[lre.LEFT,lre.DOWN_LEFT];if(vre.INSTANCE.isOnTopRightBorder(e,t))return[lre.DOWN_LEFT,lre.DOWN];throw new Error("not a border")}},{key:"getLinePortionsWithFourPiecesOfPlayer",value:function(e,t){var r=[];return e.allLines().forEach(function(i){var a=n.getLinePortionWithFourPiecesOfPlayer(e,t,i);a.isPresent()&&r.push(a.get())}),r}},{key:"getLinePortionWithFourPiecesOfPlayer",value:function(e,t,n){for(var r=0,i=e.getEntranceOnLine(n),a=n.getDirection(),o=i,s=i;e.isOnBoard(s);s=s.getNext(a))if(e.getPieceAt(s).is(t)?(0===r&&(o=s),r+=1):r=0,4===r)return sB.of({0:o,1:s,2:a});return sB.empty()}},{key:"getCapturable",value:function(e,t){for(var n=[],r=t[0],i=t[1],a=t[2],o=a.getOpposite(),s=r.getNext(o);e.isOnBoard(s)&&e.getPieceAt(s)!==cre.EMPTY;)n.push(s),s=s.getNext(o);for(var u=r;!u.equals(i);u=u.getNext(a))n.push(u);for(var c=i;e.isOnBoard(c)&&e.getPieceAt(c)!==cre.EMPTY;c=c.getNext(a))n.push(c);return new Gse(n)}},{key:"getPossibleCaptures",value:function(e){var t=e.getCurrentPlayer(),r=[];return n.getLinePortionsWithFourPiecesOfPlayer(e,t).forEach(function(t){r.push(n.getCapturable(e,t))}),r}},{key:"getPlayerScore",value:function(e,t){var r=e.getNumberOfPiecesToPlace(t);if(0===r&&0===n.getPossibleCaptures(e).length)return sB.empty();var i=e.getNumberOfPiecesCaptured(t);return sB.of(r+3*i)}},{key:"isGameOver",value:function(e){var t=n.getPlayerScore(e,ete.ZERO),r=n.getPlayerScore(e,ete.ONE);return t.isAbsent()||r.isAbsent()}}]),n}(Rre),Yse=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"getBoardValue",value:function(e){var t=e.gameState,n=Zse.getPlayerScore(t,ete.ZERO),r=Zse.getPlayerScore(t,ete.ONE);return n.isAbsent()?new yre(ete.ONE.getVictoryValue()):r.isAbsent()?new yre(ete.ZERO.getVictoryValue()):new yre(n.get()-r.get())}},{key:"getListMoves",value:function(e){return this.getListMoveFromState(e.gameState)}},{key:"getListMoveFromState",value:function(e){var t=this,n=[];return Zse.isGameOver(e)||this.getPossibleCaptureCombinations(e).forEach(function(r){var i=Zse.applyCaptures(e,r);Zse.getPlacements(i).forEach(function(e){var a=Zse.applyPlacement(i,e);t.getPossibleCaptureCombinations(a).forEach(function(t){var i=new $se(e,r,t);n.push(i)})})}),n}},{key:"getPossibleCaptureCombinations",value:function(e){var t=Zse.getPossibleCaptures(e);return n.getPossibleCaptureCombinationsFromPossibleCaptures(t)}}],[{key:"getPossibleCaptureCombinationsFromPossibleCaptures",value:function(e){var t=n.computeIntersections(e),r=[[]];return e.forEach(function(e,n){if(0===t[n].length)r.forEach(function(e){e.push(n)});else{var i,a=[],o=t[n].some(function(e){return e>n}),s=Qv(r);try{for(s.s();!(i=s.n()).done;){var u=i.value;!0===u.some(function(e){return t[n].some(function(t){return e===t})})?a.push(ite.copyImmutableArray(u)):o?(a.push(ite.copyImmutableArray(u)),u.push(n),a.push(ite.copyImmutableArray(u))):(u.push(n),a.push(ite.copyImmutableArray(u)))}}catch(c){s.e(c)}finally{s.f()}r=a}}),r.map(function(t){return t.map(function(t){return e[t]})})}},{key:"computeIntersections",value:function(e){var t=[];return e.forEach(function(n,r){t.push([]),e.forEach(function(e,i){r!==i&&n.intersectsWith(e)&&t[r].push(i)})}),t}}]),n}(gre),Kse=rp(function e(t,n,r,i,a,o){tp(this,e),this.source=t,this.destination=n,this.x1=r,this.y1=i,this.x2=a,this.y2=o}),Jse=cre.NONE,Qse=cre.EMPTY,Xse=cre.ZERO,eue=cre.ONE,tue=rp(function e(){tp(this,e),this.tutorial=[Lre.informational($localize(fi||(fi=Rv(["Goal of the game"]))),$localize(di||(di=Rv(["The goal of Gipf is to capture the opponent's piece so that the opponent can no longer play.\n        This is the initial board.\n        Each player has 12 pieces on the side and 3 pieces on the board.\n        When, at its turn, a player has no more pieces on the side, that player cannot play anymore and loses the game.\n        The first player plays with the dark pieces, the second player plays with the light pieces."]))),Wse.getInitialState()),Lre.anyMove($localize(vi||(vi=Rv(["Pushing"]))),$localize(pi||(pi=Rv(["Pieces can only enter the board through the edges. To insert a new piece:\n        <ol>\n            <li>Click on a space on the edge of the board.</li>\n            <li>If that space was already occupied, click on the arrow that indicates the direction in which you want to push the piece(s) already on the corresponding line.</li>\n        </ol>\n        You cannot push when a line is full.<br/><br/>\n        You're playing Dark, insert a piece."]))),Wse.getInitialState(),new $se(new qse(new ire(3,0),sB.of(lre.DOWN)),[],[]),$localize(gi||(gi=Rv(["Congratulations!"])))),Lre.fromMove($localize(yi||(yi=Rv(["Capture (1/3)"]))),$localize(mi||(mi=Rv(["To capture, you must align 4 of your own pieces, which will be the first 4 captured pieces.\n        There are multiple important aspects of a capture:\n        <ol>\n            <li>When 4 pieces are captured, all pieces that are directly aligned with these 4 pieces are also captured.</li>\n            <li>As soon as there is an empty space on the line, the capture stops.</li>\n            <li>Your own pieces that are captured go back to your stock.\n                Your opponent's pieces however are really captured and do not go back to your opponent's stock.</li>\n            <li>If you create a line of 4 of your opponent's pieces, it will be at the beginning of your opponent's turn that your opponent can capture them.\n                This means that a turn happens in three phases:\n                <ol type=\"A\">\n                    <li>Pick the capture(s) resulting from the last move of your opponent (by clicking on it).</li>\n                    <li>Make your insertion.</li>\n                    <li>Pick the capture(s) resulting from your move (by clicking on it).</li>\n                </ol>\n            </li>\n        </ol><br/>\n        You're playing Dark, you can make a capture, do it."]))),new Wse([[Jse,Jse,Jse,Xse,eue,Qse,Qse],[Jse,Jse,Qse,Qse,Qse,Qse,Qse],[Jse,Qse,Qse,Qse,Qse,Qse,Qse],[Xse,Xse,Xse,Qse,Qse,Qse,Qse],[eue,Qse,Qse,Qse,Qse,Qse,Jse],[Qse,Qse,Qse,eue,Qse,Jse,Jse],[Qse,Qse,Qse,eue,Jse,Jse,Jse]],42,[8,8],[0,0]),[new $se(new qse(new ire(0,3),sB.of(lre.RIGHT)),[],[new Gse([new ire(0,3),new ire(1,3),new ire(2,3),new ire(3,3)])])],$localize(ki||(ki=Rv(["Congratulations, you have gotten 4 of your pieces back. This is not the most useful capture.\n        Let's now see how captures can really be useful."]))),$localize(_i||(_i=Rv(["Failed!"])))),Lre.fromMove($localize(wi||(wi=Rv(["Capture (2/3)"]))),$localize(Ci||(Ci=Rv(["Here, there are three different ways of capturing.\n        <ol>\n          <li>One way does not capture any of your opponent's pieces.</li>\n          <li>Another way captures one of your opponent's pieces.</li>\n          <li>The last way captures two of your opponent's pieces.</li>\n        </ol>\n        <br/><br/>\n        Pick the last one."]))),new Wse([[Jse,Jse,Jse,Qse,Qse,Qse,Qse],[Jse,Jse,Qse,eue,Qse,Qse,Qse],[Jse,Qse,Qse,Xse,Qse,Qse,Qse],[Xse,Xse,Xse,eue,Qse,Qse,Qse],[Qse,Qse,Qse,Xse,Qse,Qse,Jse],[Qse,Qse,Qse,Xse,Qse,Jse,Jse],[Qse,Qse,Qse,eue,Jse,Jse,Jse]],42,[8,4],[2,3]),[new $se(new qse(new ire(0,3),sB.of(lre.RIGHT)),[],[new Gse([new ire(3,1),new ire(3,2),new ire(3,3),new ire(3,4),new ire(3,5),new ire(3,6)])])],$localize(bi||(bi=Rv(["Congratulations, you have gotten back 4 of your pieces and captured 2 of the opponent's.\n        The most you can get is 3 per capture."]))),$localize(Ei||(Ei=Rv(["Failed, the best capture was taking 2 of your opponent's pieces"])))),Lre.fromMove($localize(Si||(Si=Rv(["Capture (3/3)"]))),$localize(Pi||(Pi=Rv(["Here, you must capture at the beginning of your turn.\n        This is due to a move of your opponent at the previous turn\n        (even though this is a fictitious board for pedagogical purpose).\n        After your capture, by performing the right move you can even capture two more of your opponent's pieces!\n        Keep it mind that the most useful in a capture is to take your opponent's pieces."]))),new Wse([[Jse,Jse,Jse,Xse,Qse,Qse,Xse],[Jse,Jse,Qse,Xse,Qse,Qse,Xse],[Jse,Xse,Xse,Qse,Xse,eue,Xse],[Qse,Qse,Qse,Xse,Qse,Qse,Xse],[Qse,Qse,Qse,Xse,Qse,Qse,Jse],[Xse,Xse,Xse,eue,eue,Jse,Jse],[Qse,Qse,Qse,Xse,Jse,Jse,Jse]],42,[8,4],[2,3]),[new $se(new qse(new ire(3,6),sB.of(lre.UP)),[new Gse([new ire(6,0),new ire(6,1),new ire(6,2),new ire(6,3)])],[new Gse([new ire(0,5),new ire(1,5),new ire(2,5),new ire(3,5),new ire(4,5)]),new Gse([new ire(1,2),new ire(2,2),new ire(3,2),new ire(4,2),new ire(5,2)])]),new $se(new qse(new ire(4,6),sB.of(lre.UP)),[new Gse([new ire(6,0),new ire(6,1),new ire(6,2),new ire(6,3)])],[new Gse([new ire(0,5),new ire(1,5),new ire(2,5),new ire(3,5),new ire(4,5)]),new Gse([new ire(3,0),new ire(3,1),new ire(3,2),new ire(3,3),new ire(3,4)])]),new $se(new qse(new ire(3,6),sB.of(lre.UP)),[new Gse([new ire(6,0),new ire(6,1),new ire(6,2),new ire(6,3)])],[new Gse([new ire(1,2),new ire(2,2),new ire(3,2),new ire(4,2),new ire(5,2)]),new Gse([new ire(0,5),new ire(1,5),new ire(2,5),new ire(3,5),new ire(4,5)])])],$localize(Oi||(Oi=Rv(["Congratulations, you have gotten 12 of your pieces back and captured 2 of your opponent's pieces."]))),$localize(Ti||(Ti=Rv(["Failed, the best capture takes 2 of your opponent's pieces."]))))]});function nue(e,t){if(1&e&&(_m(),fb(0,"circle",11)),2&e){var n=wb().$implicit,r=wb();ub("ngClass",r.getPieceClass(n)),tb("cx",r.getCenterAt(n).x)("cy",r.getCenterAt(n).y)("r",r.SPACE_SIZE)}}function rue(e,t){if(1&e){var n=pb();_m(),lb(0,"g"),lb(1,"g",8),mb("click",function(){var e=$y(n).$implicit;return wb().onClick(e)}),fb(2,"polyline",9),ab(3,nue,1,4,"circle",10),hb(),hb()}if(2&e){var r=t.$implicit,i=wb();Pw(1),bb("id","click_",r.x,"_",r.y,""),Pw(1),bb("id","case_",r.x,"_",r.y,""),ub("ngClass",i.getSpaceClass(r)),tb("points",i.getHexaCoordsAt(r)),Pw(1),ub("ngIf",i.isPiece(r))}}function iue(e,t){if(1&e){var n=pb();_m(),lb(0,"polyline",14),mb("click",function(){var e=$y(n).$implicit;return wb(2).onClick(e)}),hb()}if(2&e){var r=t.$implicit;tb("points",wb(2).getHexaCoordsAt(r))}}function aue(e,t){if(1&e&&(_m(),lb(0,"g",12),ab(1,iue,1,1,"polyline",13),hb()),2&e){var n=t.$implicit;Pw(1),ub("ngForOf",n.capturedSpaces)}}function oue(e,t){if(1&e){var n=pb();_m(),lb(0,"g"),lb(1,"line",15),mb("click",function(){var e=$y(n).$implicit;return wb().onClick(e.destination)}),hb(),hb()}if(2&e){var r=t.$implicit;Pw(1),tb("x1",r.x1)("y1",r.y1)("x2",r.x2)("y2",r.y2)}}function sue(e,t){if(1&e&&(_m(),lb(0,"g"),fb(1,"circle",16),hb()),2&e){var n=t.$implicit,r=wb().$implicit,i=wb();Pw(1),bb("id","piece_",r,"_",n,""),ub("ngClass",i.getSidePieceClass(r)),tb("cx",10+n*i.SPACE_SIZE*.5)("cy",10+(i.SPACE_SIZE+10)*r)("r",.5*i.SPACE_SIZE)}}function uue(e,t){if(1&e&&(_m(),lb(0,"g"),ab(1,sue,2,6,"g",5),hb()),2&e){var n=t.$implicit,r=wb();Pw(1),ub("ngForOf",r.getPlayerSidePieces(n))}}function cue(e,t){if(1&e&&(_m(),fb(0,"line",17)),2&e){var n=wb();tb("x1",n.inserted.get().x1)("y1",n.inserted.get().y1)("x2",n.inserted.get().x2)("y2",n.inserted.get().y2)}}var lue=function(){return[0,1]},hue=function(){var e=function(e){Gv(n,e);var t=$v(n);function n(e){var r;return tp(this,n),(r=t.call(this,e)).inserted=sB.empty(),r.arrows=[],r.captured=[],r.moved=[],r.movePhase=n.PHASE_PLACEMENT_COORD,r.possibleCaptures=[],r.initialCaptures=[],r.placement=sB.empty(),r.placementEntrance=sB.empty(),r.finalCaptures=[],r.scores=sB.of([0,0]),r.rules=new Zse(Wse),r.availableMinimaxes=[new Yse(r.rules,"GipfMinimax")],r.encoder=$se.encoder,r.tutorial=(new tue).tutorial,r.SPACE_SIZE=40,r.constructedState=r.rules.node.gameState,r.hexaLayout=new hre(1.5*r.SPACE_SIZE,new ire(2*r.SPACE_SIZE,0),vre.INSTANCE),r}return rp(n,[{key:"updateBoard",value:function(){this.showLastMove(),this.cancelMoveAttempt(),this.moveToInitialCaptureOrPlacementPhase()}},{key:"showLastMove",value:function(){this.inserted=sB.empty();var e=this.rules.node.move;if(e.isPresent()&&e.get().placement.direction.isPresent()){var t=e.get().placement;this.inserted=sB.of(this.arrowTowards(t.coord,t.direction.get()))}this.cancelMoveAttempt()}},{key:"arrowTowards",value:function(e,t){var n=e.getNext(t.getOpposite()),r=this.getCenterAt(e),i=this.getCenterAt(n);return new Kse(n,e,i.x,i.y,r.x,r.y)}},{key:"markCapture",value:function(e){var t=this;e.forEach(function(e){t.captured.push(e)})}},{key:"getAllCoords",value:function(){return this.constructedState.allCoords()}},{key:"getPlayerSidePieces",value:function(e){for(var t=this.constructedState.getNumberOfPiecesToPlace(ete.of(e)),n=[],r=0;r<t;r+=1)n.push(r);return n}},{key:"isPiece",value:function(e){return this.getPiece(e)!==cre.EMPTY}},{key:"getPiece",value:function(e){return this.constructedState.getPieceAt(e)}},{key:"onClick",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function r(){var i,a,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=t.canUserPlay("#click_"+e.x+"_"+e.y)).isFailure()){r.next=3;break}return r.abrupt("return",t.cancelMove(i.getReason()));case 3:r.t0=t.movePhase,r.next=r.t0===n.PHASE_INITIAL_CAPTURE||r.t0===n.PHASE_FINAL_CAPTURE?6:r.t0===n.PHASE_PLACEMENT_COORD?7:8;break;case 6:return r.abrupt("return",t.selectCapture(e));case 7:return r.abrupt("return",t.selectPlacementCoord(e));case 8:if(nB.expectToBe(t.movePhase,n.PHASE_PLACEMENT_DIRECTION),!1!==(a=t.placementEntrance.get()).isAlignedWith(e)){r.next=12;break}return r.abrupt("return",t.cancelMove(jse.INVALID_PLACEMENT_DIRECTION()));case 12:if(1===a.getDistance(e)){r.next=14;break}return r.abrupt("return",t.cancelMove(jse.CLICK_FURTHER_THAN_ONE_COORD()));case 14:return o=lre.factory.fromMove(a,e),r.abrupt("return",t.selectPlacementDirection(o.toOptional()));case 16:case"end":return r.stop()}},r)}))()}},{key:"selectCapture",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=[],t.possibleCaptures.forEach(function(t){t.contains(e)&&i.push(t)}),!(i.length>1)){r.next=3;break}return r.abrupt("return",t.cancelMove(jse.AMBIGUOUS_CAPTURE_COORD()));case 3:if(0!==i.length){r.next=5;break}return r.abrupt("return",t.cancelMove(jse.MISSING_CAPTURES()));case 5:a=i[0],r.t0=(t.constructedState=Zse.applyCapture(t.constructedState,a),t.markCapture(a),t.possibleCaptures=Zse.getPossibleCaptures(t.constructedState),t.movePhase),r.next=r.t0===n.PHASE_INITIAL_CAPTURE?9:10;break;case 9:return r.abrupt("return",(t.initialCaptures.push(a),0===t.possibleCaptures.length?t.moveToPlacementPhase():K5.SUCCESS));case 10:return r.abrupt("return",(nB.expectToBe(t.movePhase,n.PHASE_FINAL_CAPTURE),t.finalCaptures.push(a),0===t.possibleCaptures.length?t.tryMove(t.initialCaptures,t.placement.get(),t.finalCaptures):K5.SUCCESS));case 11:case"end":return r.stop()}},r)}))()}},{key:"moveToPlacementPhase",value:function(){return this.movePhase=n.PHASE_PLACEMENT_COORD,K5.SUCCESS}},{key:"moveToInitialCaptureOrPlacementPhase",value:function(){return this.possibleCaptures=Zse.getPossibleCaptures(this.constructedState),this.movePhase=0===this.possibleCaptures.length?n.PHASE_PLACEMENT_COORD:n.PHASE_INITIAL_CAPTURE,K5.SUCCESS}},{key:"moveToFinalCapturePhaseOrTryMove",value:function(){var e=this;return tB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(e.possibleCaptures=Zse.getPossibleCaptures(e.constructedState),0===e.possibleCaptures.length?e.tryMove(e.initialCaptures,e.placement.get(),e.finalCaptures):(e.movePhase=n.PHASE_FINAL_CAPTURE,K5.SUCCESS)));case 1:case"end":return t.stop()}},t)}))()}},{key:"computeArrows",value:function(e){this.arrows=[];var t,n=Qv(Zse.getAllDirectionsForEntrance(this.constructedState,e));try{for(n.s();!(t=n.n()).done;){var r=t.value;if(!1===Zse.isLineComplete(this.constructedState,e,r)){var i=e.getNext(r),a=this.getCenterAt(e),o=this.getCenterAt(i);this.arrows.push(new Kse(e,i,a.x,a.y,o.x,o.y))}}}catch(s){n.e(s)}finally{n.f()}}},{key:"selectPlacementCoord",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=t.rules.placementCoordValidity(t.constructedState,e),r.abrupt("return",i.isFailure()?t.cancelMove(i.getReason()):(t.placementEntrance=sB.of(e),t.constructedState.getPieceAt(e)===cre.EMPTY?t.selectPlacementDirection(sB.empty()):(t.movePhase=n.PHASE_PLACEMENT_DIRECTION,t.computeArrows(e),0===t.arrows.length&&t.cancelMove(jse.NO_DIRECTIONS_AVAILABLE()),K5.SUCCESS)));case 2:case"end":return r.stop()}},r)}))()}},{key:"selectPlacementDirection",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t.placement=sB.of(new qse(t.placementEntrance.get(),e)),r=t.rules.placementValidity(t.constructedState,t.placement.get()),n.abrupt("return",r.isFailure()?t.cancelMove(r.getReason()):(t.arrows=[],t.constructedState=Zse.applyPlacement(t.constructedState,t.placement.get()),t.moveToFinalCapturePhaseOrTryMove()));case 3:case"end":return n.stop()}},n)}))()}},{key:"tryMove",value:function(e,t,n){var r=this;return tB(regeneratorRuntime.mark(function i(){var a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return a=new $se(t,e,n),i.next=3,r.chooseMove(a,r.rules.node.gameState,r.scores.get());case 3:return i.abrupt("return",i.sent);case 4:case"end":return i.stop()}},i)}))()}},{key:"cancelMoveAttempt",value:function(){var e=this;this.constructedState=this.rules.node.gameState,this.captured=[],this.moved=[];var t=this.rules.node.move;if(t.isPresent()){var n=t.get(),r=this.rules.node.mother.get().gameState;n.initialCaptures.forEach(function(t){return e.markCapture(t)}),n.finalCaptures.forEach(function(t){return e.markCapture(t)}),this.moved=this.rules.getPiecesMoved(r,n.initialCaptures,n.placement)}this.initialCaptures=[],this.finalCaptures=[],this.placementEntrance=sB.empty(),this.placement=sB.empty(),this.arrows=[],this.moveToInitialCaptureOrPlacementPhase()}},{key:"getSpaceClass",value:function(e){return this.captured.some(function(t){return t.equals(e)})?"captured":this.moved.some(function(t){return t.equals(e)})?"moved":""}},{key:"getPieceClass",value:function(e){var t=this.getPiece(e);return this.getPlayerClass(ete.of(t.value))}},{key:"getSidePieceClass",value:function(e){return this.getPlayerClass(ete.of(e))}}]),n}(ure);return e.PHASE_INITIAL_CAPTURE=0,e.PHASE_PLACEMENT_COORD=1,e.PHASE_PLACEMENT_DIRECTION=2,e.PHASE_FINAL_CAPTURE=3,e.\u0275fac=function(t){return new(t||e)(sb(ore))},e.\u0275cmp=ey({type:e,selectors:[["app-gipf"]],features:[zC],decls:11,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 -12 708 854","preserveAspectRatio","xMidYMid meet"],["id","arrowhead","markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto"],["points","0 0, 10 3.5, 0 7"],["id","arrowhead-moved","markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto"],["points","0 0, 10 3.5, 0 7",1,"moved","moved-stroke"],[4,"ngFor","ngForOf"],["pointer-events","fill","class","capturable",4,"ngFor","ngForOf"],["class","arrow moved-stroke","marker-end","url(#arrowhead-moved)",4,"ngIf"],[3,"id","click"],["stroke-linecap","round",1,"base",3,"id","ngClass"],["class","base",3,"ngClass",4,"ngIf"],[1,"base",3,"ngClass"],["pointer-events","fill",1,"capturable"],["class","no-fill","stroke-linecap","round",3,"click",4,"ngFor","ngForOf"],["stroke-linecap","round",1,"no-fill",3,"click"],["marker-end","url(#arrowhead)",1,"arrow",3,"click"],[1,"base","small-stroke",3,"id","ngClass"],["marker-end","url(#arrowhead-moved)",1,"arrow","moved-stroke"]],template:function(e,t){1&e&&(_m(),lb(0,"svg",0),lb(1,"defs"),lb(2,"marker",1),fb(3,"polygon",2),hb(),lb(4,"marker",3),fb(5,"polygon",4),hb(),hb(),ab(6,rue,4,7,"g",5),ab(7,aue,2,1,"g",6),ab(8,oue,2,4,"g",5),ab(9,uue,2,1,"g",5),ab(10,cue,1,4,"line",7),hb()),2&e&&(Pw(6),ub("ngForOf",t.getAllCoords()),Pw(1),ub("ngForOf",t.possibleCaptures),Pw(1),ub("ngForOf",t.arrows),Pw(1),ub("ngForOf",eP(5,lue)),Pw(1),ub("ngIf",t.inserted.isPresent()))},directives:[AT,NT,IT],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),fue=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"equals",value:function(e){return this===e||this.coord.equals(e.coord)}},{key:"toString",value:function(){return this===n.PASS?"GoMove.PASS":this===n.ACCEPT?"GoMove.ACCEPT":"GoMove("+this.coord.x+", "+this.coord.y+")"}}]),n}(Ere);fue.PASS=new fue(-1,0),fue.ACCEPT=new fue(-2,0),fue.PASS_NUMBER=-1,fue.ACCEPT_NUMBER=-2,fue.encoder=new(function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"maxValue",value:function(){return 360}},{key:"encodeNumber",value:function(e){return 19*e.coord.y+e.coord.x}},{key:"decodeNumber",value:function(e){if(e===fue.PASS_NUMBER)return fue.PASS;var t=e%19;return new fue(t,(e-t)/19)}}]),n}(Jee));var due=function(){function e(t,n){tp(this,e),this.player=t,this.type=n}return rp(e,[{key:"equals",value:function(e){return e===this}},{key:"toString",value:function(){switch(this){case e.BLACK:return"GoPiece.BLACK";case e.WHITE:return"GoPiece.WHITE";case e.EMPTY:return"GoPiece.EMPTY";case e.DEAD_BLACK:return"GoPiece.DEAD_BLACK";case e.DEAD_WHITE:return"GoPiece.DEAD_WHITE";case e.BLACK_TERRITORY:return"GoPiece.BLACK_TERRITORY";default:return X5(this===e.WHITE_TERRITORY,"Unexisting GoPiece"),"GoPiece.WHITE_TERRITORY"}}},{key:"isOccupied",value:function(){return[e.BLACK,e.WHITE,e.DEAD_BLACK,e.DEAD_WHITE].includes(this)}},{key:"isEmpty",value:function(){return[e.BLACK_TERRITORY,e.WHITE_TERRITORY,e.EMPTY].includes(this)}},{key:"isDead",value:function(){return[e.DEAD_BLACK,e.DEAD_WHITE].includes(this)}},{key:"isTerritory",value:function(){return[e.BLACK_TERRITORY,e.WHITE_TERRITORY].includes(this)}},{key:"getOwner",value:function(){return this.player}},{key:"nonTerritory",value:function(){return X5(this.isEmpty(),'Usually not false, if false, cover by test and return "this"'),e.EMPTY}}],[{key:"pieceBelongTo",value:function(e,t){return t===e.player&&"territory"!==e.type}},{key:"ofPlayer",value:function(t){return t===ete.ZERO?e.BLACK:e.WHITE}}]),e}();due.BLACK=new due(ete.ZERO,"alive"),due.WHITE=new due(ete.ONE,"alive"),due.EMPTY=new due(Xee.NONE,"empty"),due.DEAD_BLACK=new due(ete.ZERO,"dead"),due.DEAD_WHITE=new due(ete.ONE,"dead"),due.BLACK_TERRITORY=new due(Xee.NONE,"territory"),due.WHITE_TERRITORY=new due(Xee.NONE,"territory");var vue=(function(e){e.PLAYING="PLAYING",e.PASSED="PASSED",e.COUNTING="COUNTING",e.ACCEPT="ACCEPT",e.FINISHED="FINISHED"}(vue||(vue={})),vue),pue=function(){var e=function(e){Gv(n,e);var t=$v(n);function n(e,r,i,a,o){var s;return tp(this,n),(s=t.call(this,e,i)).captured=r,s.koCoord=a,s.phase=o,s}return rp(n,[{key:"getCapturedCopy",value:function(){return[this.captured[0],this.captured[1]]}},{key:"copy",value:function(){return new n(this.getCopiedBoard(),this.getCapturedCopy(),this.turn,this.koCoord,this.phase)}},{key:"isDead",value:function(e){return this.getPieceAt(e).isDead()}},{key:"isTerritory",value:function(e){return this.getPieceAt(e).isTerritory()}}],[{key:"getInitialState",value:function(){var e=n.getStartingBoard();return new n(e,[0,0],0,sB.empty(),vue.PLAYING)}},{key:"getStartingBoard",value:function(){return ite.createTable(n.WIDTH,n.HEIGHT,due.EMPTY)}}]),n}(wre);return e.WIDTH=13,e.HEIGHT=13,e}(),gue=function(){var e=function(){function e(t){tp(this,e),this.color=t}return rp(e,[{key:"selfContains",value:function(e){return this.getCoords().some(function(t){return t.equals(e)})}}],[{key:"insertAsEntryPoint",value:function(e,t){return 0===e.length?[t]:t.compareTo(e[0])<0?[t].concat(e):e.concat([t])}}]),e}();return e.VERBOSE=!1,e}(),yue=function(e){Gv(n,e);var t=$v(n);function n(e,r,i,a,o,s){var u;return tp(this,n),(u=t.call(this,e)).emptyCoords=r,u.blackCoords=i,u.whiteCoords=a,u.deadBlackCoords=o,u.deadWhiteCoords=s,u}return rp(n,[{key:"getCoords",value:function(){return this.color===due.BLACK?this.blackCoords:this.color===due.WHITE?this.whiteCoords:this.color===due.DEAD_BLACK?this.deadBlackCoords:this.color===due.DEAD_WHITE?this.deadWhiteCoords:this.emptyCoords}},{key:"contains",value:function(e){return this.blackCoords.concat(this.whiteCoords.concat(this.emptyCoords.concat(this.deadBlackCoords.concat(this.deadWhiteCoords)))).some(function(t){return t.equals(e)})}},{key:"addPawn",value:function(e,t){if(this.contains(e))throw new Error("This group already contains "+e);switch(t){case due.BLACK:this.blackCoords=gue.insertAsEntryPoint(this.blackCoords,e);break;case due.WHITE:this.whiteCoords=gue.insertAsEntryPoint(this.whiteCoords,e);break;case due.DEAD_BLACK:this.deadBlackCoords=gue.insertAsEntryPoint(this.deadBlackCoords,e);break;case due.DEAD_WHITE:this.deadWhiteCoords=gue.insertAsEntryPoint(this.deadWhiteCoords,e);break;default:nB.expectToBeMultiple(t,[due.EMPTY,due.BLACK_TERRITORY,due.WHITE_TERRITORY]),this.emptyCoords=gue.insertAsEntryPoint(this.emptyCoords,e)}}},{key:"isMonoWrapped",value:function(){return(0===this.emptyCoords.length?1:2)*(this.blackCoords.length+this.deadWhiteCoords.length===0?1:2)*(this.whiteCoords.length+this.deadBlackCoords.length===0?1:2)==4}},{key:"getWrapper",value:function(){var e=new Ore;e.set(due.EMPTY,this.emptyCoords.length),e.set(due.BLACK,this.blackCoords.length+this.deadWhiteCoords.length),e.set(due.WHITE,this.whiteCoords.length+this.deadBlackCoords.length),e.put(this.color.nonTerritory(),0);var t=e.filter(function(e,t){return t>0});if(1===t.size())return t.getByIndex(0).key;throw new Error("Can't call getWrapper on non-mono-wrapped group")}},{key:"getNeighboorsEntryPoint",value:function(){var e=[];return this.color!==due.EMPTY&&this.emptyCoords.length>0&&e.push(this.emptyCoords[0]),this.color!==due.BLACK&&this.blackCoords.length>0&&e.push(this.blackCoords[0]),this.color!==due.WHITE&&this.whiteCoords.length>0&&e.push(this.whiteCoords[0]),this.color!==due.DEAD_BLACK&&this.deadBlackCoords.length>0&&e.push(this.deadBlackCoords[0]),this.color!==due.DEAD_WHITE&&this.deadWhiteCoords.length>0&&e.push(this.deadWhiteCoords[0]),e}}]),n}(gue),mue=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"getNewInstance",value:function(e){return new yue(e,[],[],[],[],[])}},{key:"getDirections",value:function(){return rre.ORTHOGONALS}}]),n}(function(){function e(){tp(this,e)}return rp(e,[{key:"getGroupDatas",value:function(e,t){rB(gue.VERBOSE,"GroupDatas.getGroupDatas("+e+", "+t+")");var n=this.getNewInstance(t[e.y][e.x]);return this._getGroupDatas(e,t,n)}},{key:"_getGroupDatas",value:function(e,t,n){rB(gue.VERBOSE,{GroupDatas_getGroupDatas:{groupDatas:n,coord:e}});var r=t[e.y][e.x];if(n.addPawn(e,r),r===n.color){var i,a=Qv(this.getDirections());try{for(a.s();!(i=a.n()).done;){var o=i.value,s=e.getNext(o);s.isInRange(t[0].length,t.length)&&(n.contains(s)||(n=this._getGroupDatas(s,t,n)))}}catch(u){a.e(u)}finally{a.f()}}return n}}]),e}()),kue=function(){var e=rp(function e(){tp(this,e)});return e.ILLEGAL_KO=function(){return $localize(Ii||(Ii=Rv(["This move is a ko, you must play somewhere else before you can play in this intersection again."])))},e.CANNOT_PASS_AFTER_PASSED_PHASE=function(){return $localize(xi||(xi=Rv(["We are in the counting phase, you must mark stones as dead or alive or accept the current board by passing your turn."])))},e.CANNOT_ACCEPT_BEFORE_COUNTING_PHASE=function(){return $localize(Ai||(Ai=Rv(["You cannot accept before the counting phase."])))},e.OCCUPIED_INTERSECTION=function(){return $localize(Ri||(Ri=Rv(["This intersection is already occupied."])))},e.CANNOT_COMMIT_SUICIDE=function(){return $localize(Ni||(Ni=Rv(["You cannot commit suicide."])))},e}(),_ue=function(){var e=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"isLegal",value:function(e,t){return n.isLegal(e,t)}},{key:"applyLegalMove",value:function(e,t,r){return rB(n.VERBOSE,{applyLegalMove:{legalMove:e,state:t,status:r}}),n.isPass(e)?(rB(n.VERBOSE,"GoRules.applyLegalMove: isPass"),n.applyPass(t)):n.isAccept(e)?(rB(n.VERBOSE,"GoRules.applyLegalMove: isAccept"),n.applyLegalAccept(t)):n.isLegalDeadMarking(e,t)?(rB(n.VERBOSE,"GoRules.applyLegalMove: isDeadMarking"),n.applyDeadMarkingMove(e,t)):(rB(n.VERBOSE,"GoRules.applyLegalMove: else it is normal move"),n.applyNormalLegalMove(t,e,r))}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"isLegal",value:function(e,t){var r=!1;if(rB(n.VERBOSE||r,{isLegal:{move:e,state:t}}),n.isPass(e)){var i=t.phase===vue.PLAYING,a=t.phase===vue.PASSED;return rB(n.VERBOSE||r,"GoRules.isLegal at "+t.phase+(i||a?" forbid":" allowed")+" passing on "+t.getCopiedBoard()),i||a?j5.success([]):j5.failure(kue.CANNOT_PASS_AFTER_PASSED_PHASE())}if(n.isAccept(e)){var o=t.phase===vue.ACCEPT;return t.phase===vue.COUNTING||o?j5.success([]):j5.failure(kue.CANNOT_ACCEPT_BEFORE_COUNTING_PHASE())}return n.isOccupied(e.coord,t.getCopiedBoard())?(rB(n.VERBOSE||r,"GoRules.isLegal: move is marking"),n.isLegalDeadMarking(e,t)?j5.success([]):j5.failure(kue.OCCUPIED_INTERSECTION())):(rB(n.VERBOSE||r,"GoRules.isLegal: move is normal stuff: "+e.toString()),n.isLegalNormalMove(e,t))}},{key:"getNewKo",value:function(e,t,n){if(1===n.length){var r=n[0],i=e.coord,a=t[i.y][i.x],o=(new mue).getGroupDatas(i,t),s=o.emptyCoords,u=due.pieceBelongTo(a,ete.ZERO)?o.blackCoords:o.whiteCoords;if(1===s.length&&s[0].equals(r)&&1===u.length)return sB.of(r)}return sB.empty()}},{key:"markTerritoryAndCount",value:function(e){rB(n.VERBOSE,{markTerritoryAndCount:{state:e}});var t,r=e.getCopiedBoard(),i=n.getTerritoryLikeGroup(e),a=e.getCapturedCopy(),o=Qv(i);try{for(o.s();!(t=o.n()).done;){var s=t.value,u=s.getWrapper();if(u===due.WHITE){a[1]+=s.emptyCoords.length;var c,l=Qv(s.getCoords());try{for(l.s();!(c=l.n()).done;){var h=c.value;r[h.y][h.x]=due.WHITE_TERRITORY}}catch(p){l.e(p)}finally{l.f()}}else{X5(u===due.BLACK,"territory should be wrapped by black or white, not by "+u.toString()),a[0]+=s.emptyCoords.length;var f,d=Qv(s.getCoords());try{for(d.s();!(f=d.n()).done;){var v=f.value;r[v.y][v.x]=due.BLACK_TERRITORY}}catch(p){d.e(p)}finally{d.f()}}}}catch(p){o.e(p)}finally{o.f()}return new pue(r,a,e.turn,e.koCoord,e.phase)}},{key:"removeAndSubstractTerritory",value:function(e){for(var t,n=e.getCopiedBoard(),r=e.getCapturedCopy(),i=0;i<e.board.length;i++)for(var a=0;a<e.board[0].length;a++)(t=n[i][a])===due.BLACK_TERRITORY?(n[i][a]=due.EMPTY,r[0]=r[0]-1):t===due.WHITE_TERRITORY&&(n[i][a]=due.EMPTY,r[1]=r[1]-1);return new pue(n,r,e.turn,e.koCoord,e.phase)}},{key:"getEmptyZones",value:function(e){return n.getGroupsDatasWhere(e.getCopiedBoard(),function(e){return e.isEmpty()})}},{key:"getGroupsDatasWhere",value:function(e,t){for(var n,r,i=[],a=new mue,o=0;o<e.length;o++)for(var s=0;s<e[0].length;s++)n=new ire(s,o),t(e[o][s])&&(i.some(function(e){return e.selfContains(n)})||(r=a.getGroupDatas(n,e),i.push(r)));return i}},{key:"addDeadToScore",value:function(e){for(var t,n=e.getCapturedCopy(),r=n[1],i=n[0],a=0;a<e.board.length;a++)for(var o=0;o<e.board[0].length;o++)(t=e.getPieceAtXY(o,a))===due.DEAD_BLACK?r++:t===due.DEAD_WHITE&&i++;return[i,r]}},{key:"switchAliveness",value:function(e,t){var n=t.getCopiedBoard();X5(!1===n[e.y][e.x].isEmpty(),"Can't switch emptyness aliveness");var r=(new mue).getGroupDatas(e,n),i=t.getCapturedCopy();switch(r.color){case due.DEAD_BLACK:i[1]-=2*r.deadBlackCoords.length;var a,o=Qv(r.deadBlackCoords);try{for(o.s();!(a=o.n()).done;){var s=a.value;n[s.y][s.x]=due.BLACK}}catch(y){o.e(y)}finally{o.f()}break;case due.DEAD_WHITE:i[0]-=2*r.deadWhiteCoords.length;var u,c=Qv(r.deadWhiteCoords);try{for(c.s();!(u=c.n()).done;){var l=u.value;n[l.y][l.x]=due.WHITE}}catch(y){c.e(y)}finally{c.f()}break;case due.WHITE:i[0]+=2*r.whiteCoords.length;var h,f=Qv(r.whiteCoords);try{for(f.s();!(h=f.n()).done;){var d=h.value;n[d.y][d.x]=due.DEAD_WHITE}}catch(y){f.e(y)}finally{f.f()}break;default:nB.expectToBe(r.color,due.BLACK),i[1]+=2*r.blackCoords.length;var v,p=Qv(r.blackCoords);try{for(p.s();!(v=p.n()).done;){var g=v.value;n[g.y][g.x]=due.DEAD_BLACK}}catch(y){p.e(y)}finally{p.f()}}return new pue(n,i,t.turn,t.koCoord,t.phase)}},{key:"getGameStatus",value:function(e){var t=e.gameState;return t.phase===vue.FINISHED?t.captured[0]>t.captured[1]?Are.ZERO_WON:t.captured[1]>t.captured[0]?Are.ONE_WON:Are.DRAW:Are.ONGOING}},{key:"isPass",value:function(e){return e.equals(fue.PASS)}},{key:"isAccept",value:function(e){return e.equals(fue.ACCEPT)}},{key:"isLegalDeadMarking",value:function(e,t){return n.isOccupied(e.coord,t.getCopiedBoard())&&(t.phase===vue.COUNTING||t.phase===vue.ACCEPT)}},{key:"isLegalNormalMove",value:function(e,t){var r=t.getCopiedBoard();if(n.isKo(e,t))return j5.failure(kue.ILLEGAL_KO());[vue.COUNTING,vue.ACCEPT].includes(t.phase)&&(t=n.resurrectStones(t));var i=n.getCaptureState(e,t);if(wue.isCapturing(i))return j5.success(i.capturedCoords);r[e.coord.y][e.coord.x]=t.turn%2==0?due.BLACK:due.WHITE;var a=0===(new mue).getGroupDatas(e.coord,r).emptyCoords.length;return r[e.coord.y][e.coord.x]=due.EMPTY,a?j5.failure(kue.CANNOT_COMMIT_SUICIDE()):j5.success([])}},{key:"isOccupied",value:function(e,t){return t[e.y][e.x].isOccupied()}},{key:"isKo",value:function(e,t){return!!t.koCoord.isPresent()&&e.coord.equals(t.koCoord.get())}},{key:"getCaptureState",value:function(e,t){rB(n.VERBOSE||!1,{getCaptureState:{move:e,state:t}});var r,i,a=new wue,o=Qv(rre.ORTHOGONALS);try{for(o.s();!(i=o.n()).done;){var s=i.value;(r=n.getCapturedInDirection(e.coord,s,t)).length>0&&a.capturedCoords.every(function(e){return!r[0].equals(e)})&&(a.capturedCoords=a.capturedCoords.concat(r))}}catch(u){o.e(u)}finally{o.f()}return a}},{key:"getCapturedInDirection",value:function(e,t,r){var i=r.getCopiedBoard(),a=e.getNext(t);if(a.isInRange(r.board[0].length,r.board.length)&&i[a.y][a.x]===(r.turn%2==0?due.WHITE:due.BLACK)){rB(n.VERBOSE||!1,"a group could be captured");var o=(new mue).getGroupDatas(a,i);if(n.isCapturableGroup(o,r.koCoord))return rB(n.VERBOSE||!1,{neightbooringGroupCoord:o.getCoords(),message:"is capturable"}),o.getCoords()}return[]}},{key:"isCapturableGroup",value:function(e,t){return!(!e.color.isOccupied()||1!==e.emptyCoords.length)&&!1===t.equalsValue(e.emptyCoords[0])}},{key:"getTerritoryLikeGroup",value:function(e){return n.getEmptyZones(e).filter(function(e){return e.isMonoWrapped()})}},{key:"applyPass",value:function(e){var t,r,i=e.getCopiedBoard(),a=e.getCapturedCopy(),o=e.turn;return e.phase===vue.PASSED?(t=vue.COUNTING,r=new pue(i,a,o+1,sB.empty(),t),r=n.markTerritoryAndCount(r)):(X5(e.phase===vue.PLAYING,"Cannot pass in counting phase!"),t=vue.PASSED,r=new pue(i,a,o+1,sB.empty(),t)),r}},{key:"applyLegalAccept",value:function(e){var t,n=e.getCopiedBoard();return t=e.phase===vue.COUNTING?vue.ACCEPT:vue.FINISHED,new pue(n,e.getCapturedCopy(),e.turn+1,sB.empty(),t)}},{key:"applyNormalLegalMove",value:function(e,t,r){var i;rB(n.VERBOSE,{applyNormalLegal:{currentState:e,legalMove:t,status:status}}),i=[vue.COUNTING,vue.ACCEPT].includes(e.phase)?n.resurrectStones(e):e.copy();var a=t.coord.x,o=t.coord.y,s=i.getCopiedBoard(),u=i.turn,c=due.ofPlayer(i.getCurrentPlayer()),l=u+1;s[o][a]=c;var h,f=Qv(r);try{for(f.s();!(h=f.n()).done;){var d=h.value;s[d.y][d.x]=due.EMPTY}}catch(g){f.e(g)}finally{f.f()}var v=n.getNewKo(t,s,r),p=i.getCapturedCopy();return p[c.player.value]+=r.length,new pue(s,p,l,v,vue.PLAYING)}},{key:"resurrectStones",value:function(e){for(var t=0;t<e.board.length;t++)for(var r=0;r<e.board[0].length;r++)e.getPieceAtXY(r,t).isDead()&&(e=n.switchAliveness(new ire(r,t),e));return n.removeAndSubstractTerritory(e)}},{key:"applyDeadMarkingMove",value:function(e,t){rB(n.VERBOSE,{applyDeadMarkingMove:{legalMove:e,state:t}});var r=n.removeAndSubstractTerritory(t),i=n.switchAliveness(e.coord,r),a=new pue(i.getCopiedBoard(),i.getCapturedCopy(),i.turn+1,sB.empty(),vue.COUNTING);return n.markTerritoryAndCount(a)}}]),n}(Rre);return e.VERBOSE=!1,e}(),wue=function(){function e(){tp(this,e),this.capturedCoords=[]}return rp(e,null,[{key:"isCapturing",value:function(e){return e.capturedCoords.length>0}}]),e}(),Cue=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"getListMoves",value:function(e){rB(_ue.VERBOSE||!1,"GoRules.getListMoves");var t=e.gameState,n=this.getPlayingMovesList(t);if(t.phase===vue.PLAYING||t.phase===vue.PASSED)return n.push(fue.PASS),n;rB(_ue.VERBOSE||!1,"GoRules.getListMoves in counting phase");var r=this.getCountingMovesList(t);return 0===r.length?[fue.ACCEPT]:r}},{key:"getPlayingMovesList",value:function(e){for(var t,n=[],r=0;r<e.board.length;r++)for(var i=0;i<e.board[0].length;i++)t=new fue(i,r),e.getPieceAt(t.coord)===due.EMPTY&&_ue.isLegal(t,e).isSuccess()&&n.push(t);return n}},{key:"getCountingMovesList",value:function(e){var t,n=[],r=this.getCorrectBoard(e).getCopiedBoard(),i=Qv(_ue.getGroupsDatasWhere(r,function(e){return e!==due.EMPTY}));try{for(i.s();!(t=i.n()).done;){var a=t.value.getCoords()[0],o=r[a.y][a.x];if(e.getPieceAt(a)!==o){var s=new fue(a.x,a.y);return n.push(s),n}}}catch(u){i.e(u)}finally{i.f()}return n}},{key:"getCorrectBoard",value:function(e){var t=this.mapBoard(e.getCopiedBoard(),function(e){return e===due.BLACK?due.DEAD_BLACK:e===due.WHITE?due.DEAD_WHITE:e.isTerritory()?due.EMPTY:e}),n=new pue(t,e.getCapturedCopy(),e.turn,e.koCoord,e.phase),r=_ue.getTerritoryLikeGroup(n);return this.setAliveUniqueWrapper(n,r)}},{key:"mapBoard",value:function(e,t){for(var n=0;n<e.length;n++)for(var r=0;r<e[0].length;r++)e[n][r]=t(e[n][r]);return e}},{key:"setAliveUniqueWrapper",value:function(e,t){var n,r=e.copy(),i=Qv(t);try{for(i.s();!(n=i.n()).done;){var a,o=n.value,s=Qv(o.deadBlackCoords.concat(o.deadWhiteCoords));try{for(s.s();!(a=s.n()).done;){var u=a.value;r.isDead(u)&&(r=_ue.switchAliveness(u,r))}}catch(c){s.e(c)}finally{s.f()}}}catch(c){i.e(c)}finally{i.f()}return r}},{key:"getBoardValue",value:function(e){var t=e.gameState,n=_ue.getGameStatus(e);if(n.isEndGame)return new yre(n.toBoardValue());rB(_ue.VERBOSE||!1,"GoRules.getBoardValue");var r=_ue.markTerritoryAndCount(t),i=r.getCapturedCopy(),a=this.getDeadStones(r);return new yre(i[1]+2*a[0]-(i[0]+2*a[1]))}},{key:"getDeadStones",value:function(e){for(var t=[0,0],n=0;n<e.board.length;n++)for(var r=0;r<e.board[0].length;r++){var i=e.getPieceAtXY(r,n);"dead"===i.type&&(t[i.player.value]=t[i.player.value]+1)}return t}}]),n}(gre),bue=due.WHITE,Eue=due.BLACK,Sue=due.DEAD_WHITE,Pue=due.WHITE_TERRITORY,Oue=due.BLACK_TERRITORY,Tue=due.EMPTY,Iue=rp(function e(){tp(this,e),this.tutorial=[Lre.informational($localize(Mi||(Mi=Rv(["Preliminary information"]))),$localize(Di||(Di=Rv(["The game of Go is played on a board called a Goban, and the stones are placed on the intersections.\n        The traditional board is made of 19x19 intersections, but on this website we have the 13x13 board.\n        (For shorter parts, 9x9 and 5x5 boards exist, but are not yet available here).\n        For this tutorial, we will use a smaller board for pedagogical purposes."]))),pue.getInitialState()),Lre.informational($localize(Li||(Li=Rv(["Goal of the game"]))),$localize(Fi||(Fi=Rv(["The goal of the game is to have the most points at the end of the game.\n        We call \"territories\" the intersections that are empty and isolated from the rest of the Goban by the stones of a single player.\n        Here, Dark has 9 territories on the left, and Light has 8 on the right.\n        The top part belongs to no one.\n        Each player's score at the end of the game is the sum of that player's territories and captures."]))),new pue([[Tue,Eue,Tue,Tue,bue,bue],[Tue,Eue,Tue,Tue,bue,Tue],[Tue,Eue,Eue,bue,bue,Tue],[Tue,Tue,Eue,bue,Tue,Tue],[Tue,Tue,Eue,bue,Tue,Tue],[Tue,Tue,Eue,bue,Tue,Tue]],[0,0],0,sB.empty(),vue.PLAYING)),Lre.fromMove($localize(Bi||(Bi=Rv(["Simple capture"]))),$localize(Vi||(Vi=Rv(["An isolated stone, like the one in the middle here, has 4 neighboring intersections (not 8, because we do not count diagonals).\n        It is said of a group which has exactly 2 free neighboring squares, that this group has two liberties.\n        If Dark plays on the last liberty of the light stone, this stone is removed from the Goban (captured) and Dark earns one point.<br/><br/>\n        The light piece only has one liberty left, play there."]))),new pue([[Tue,Tue,Tue,Tue,Tue],[Tue,Tue,Eue,Tue,Tue],[Tue,Eue,bue,Tue,Tue],[Tue,Tue,Eue,Tue,Tue],[Tue,Tue,Tue,Tue,Tue]],[0,0],0,sB.empty(),vue.PLAYING),[new fue(3,2)],$localize(Ui||(Ui=Rv(["Congratulations, you have earned one point."]))),$localize(zi||(zi=Rv(["Failed, try again by playing on one of the intersections directly next to the light stone."])))),Lre.fromMove($localize(Hi||(Hi=Rv(["Capturing multiple stones"]))),$localize(Gi||(Gi=Rv(["Stones that are connected horizontally or vertically must be captured at the same time, and are not capturable in isolation.<br/><br/>\n        The light group here only has one liberty left, capture it."]))),new pue([[Tue,Eue,Tue,Tue,Tue],[Eue,bue,Tue,Tue,Tue],[Eue,bue,bue,Eue,Tue],[Tue,Eue,Eue,Tue,Tue],[Tue,Tue,Tue,Tue,Tue]],[0,0],0,sB.empty(),vue.PLAYING),[new fue(2,1)],$localize(qi||(qi=Rv(["Congratulations, you have earned three points and formed a territory."]))),$localize($i||($i=Rv(["Failed, you have not captured the group. Play on the last liberty of that group."])))),Lre.informational($localize(Wi||(Wi=Rv(["Suicide"]))),$localize(ji||(ji=Rv(["In Go, suicide is forbidden.\n        If putting a piece on an intersection removes the last liberty of your group and does not capture any stone, playing on that intersection would be a suicide and is therefore forbidden.\n        Here, the top left intersection is a suicide for Light.\n        On the bottom right, it would be a suicide for Dark, and on the bottom left it is not a suicide for any player."]))),new pue([[Tue,Eue,Tue,Tue,Tue],[Eue,Tue,Tue,Tue,Tue],[Eue,Tue,Tue,Tue,bue],[bue,Eue,Tue,bue,Tue],[Tue,bue,Tue,bue,Eue]],[0,0],0,sB.empty(),vue.PLAYING)),Lre.informational($localize(Zi||(Zi=Rv(["Life and death (death)"]))),$localize(Yi||(Yi=Rv(["From the capture rule follows the life and death notion:\n        dead stones are stones that are definitely capturable (without losing anything else).\n        Alive stones are stones that can never be captured.\n        From the capture rule, Dark can play inside Light's territory and make a capture.\n        In this case, we say that Light has only one eye (its last liberty) and that Light is dead (even if not yet captured).\n        At the end of the game, the dead stones will count as captures, and the intersections they occupy as territories."]))),new pue([[Tue,Tue,Tue,Tue,Tue],[Eue,Eue,Eue,Tue,Tue],[bue,bue,Eue,Tue,Tue],[Tue,bue,Eue,Tue,Tue],[bue,bue,Eue,Tue,Tue]],[0,0],0,sB.empty(),vue.PLAYING)),Lre.informational($localize(Ki||(Ki=Rv(["Life and death (eyes)"]))),$localize(Ji||(Ji=Rv(["Here, Light cannot play on the top left, nor on the bottom left.\n        Light will never be able to capture Dark.\n        We say that Dark has two eyes (the eye on the top left, and the one on the bottom left) and that Dark is alive."]))),new pue([[Tue,Eue,bue,Tue,Tue],[bue,Eue,bue,Tue,Tue],[Eue,Eue,bue,Tue,Tue],[bue,Eue,bue,Tue,Tue],[Tue,Eue,bue,Tue,Tue]],[0,0],0,sB.empty(),vue.PLAYING)),Lre.informational($localize(Qi||(Qi=Rv(["Seki"]))),$localize(Xi||(Xi=Rv(["If Dark plays on the middle line, Light will play on the opposite intersection and capture Dark.\n        Similarly, if Light plays on the middle line, Dark will capture Light.\n        In other words, there is no point in playing on the middle line.\n        In that case, we say that stones in the middle are alive by Seki, and that both intersections in the middle are neutral."]))),new pue([[Tue,bue,Eue,Tue,bue,Eue,Tue],[Tue,bue,Eue,Eue,bue,Eue,Tue],[Tue,bue,Eue,Eue,bue,Eue,Tue],[Tue,bue,Eue,Eue,bue,Eue,Tue],[Tue,bue,Eue,bue,bue,Eue,Tue],[Tue,bue,Eue,bue,bue,Eue,Tue],[Tue,bue,Eue,Tue,bue,Eue,Tue]],[0,0],0,sB.empty(),vue.PLAYING)),Lre.fromMove($localize(ea||(ea=Rv(["Ko"]))),$localize(ta||(ta=Rv(["A player, by putting a stone, cannot go back to an identical state of the Goban as before, in order to avoid an endless game.<br/><br/>\n        Capture the light stone."]))),new pue([[Tue,Tue,Tue,Tue,Tue,Tue,Tue],[Tue,Tue,Tue,Tue,Tue,Tue,Tue],[Tue,Tue,Tue,Eue,bue,Tue,Tue],[Tue,Tue,Eue,bue,Tue,bue,Tue],[Tue,Tue,Tue,Eue,bue,Tue,Tue],[Tue,Tue,Tue,Tue,Tue,Tue,Tue],[Tue,Tue,Tue,Tue,Tue,Tue,Tue]],[0,0],0,sB.empty(),vue.PLAYING),[new fue(4,3)],$localize(na||(na=Rv(["Now, if Light tries to recapture the stone that Dark has just put on the Goban, this one would go back to its previous state, opening the door for an endless game.\n        This intersection is therefore marked with a red square, to remind the players that this intersection is forbidden.\n        This rule is called the Ko.\n        The trick for Light is to try to create a big enough threat so that Dark must answer immediately, and does not have the time to protect its last stone, so that Light can capture it right after."]))),$localize(ra||(ra=Rv(["Failed!"])))),Lre.fromMove($localize(ia||(ia=Rv(["End of the game"]))),$localize(aa||(aa=Rv(["When a player feels that there is no advantage to putting a new stone, that player can pass a turn.\n        The game phase stops when both players pass consecutively, and we move on to the counting phase.\n        The dead groups are then marked by clicking on them.\n        Every intersection in a player's territory earns that player a point.\n        The winner is the one with most points.<br/><br/>\n        A last stone is dead, mark it."]))),new pue([[bue,Eue,Eue,Eue,Eue,Eue,Oue,Oue,Oue],[bue,bue,bue,bue,Eue,Eue,Eue,Oue,Oue],[bue,Pue,bue,bue,Eue,Sue,Sue,Eue,Oue],[Eue,bue,bue,bue,bue,Eue,Oue,Oue,Oue],[Tue,bue,Pue,bue,Eue,Eue,Sue,Eue,Oue],[bue,Pue,bue,bue,Eue,Eue,Eue,Eue,Eue],[bue,bue,Eue,Eue,Eue,bue,bue,Eue,bue],[Eue,Eue,Eue,bue,bue,bue,Pue,bue,bue],[Oue,Oue,Eue,Eue,Eue,bue,bue,Pue,Pue]],[0,0],0,sB.empty(),vue.COUNTING),[new fue(0,3)],$localize(oa||(oa=Rv(["Congratulations, Dark has 15 territories and 3 light stones still present, called prisoners at the end of the game.\n        The intersections where the prisoners are count as Dark's territory\n        Light has 8 territories and 1 prisoner.\n        The end result is therefore 18 - 9 for Dark."]))),$localize(sa||(sa=Rv(["Failed, try again."]))))]});function xue(e,t){if(1&e&&(_m(),fb(0,"circle",10)),2&e){var n=wb(2).index,r=wb().index;tb("cx",25+50*n)("cy",25+50*r)("r",22)}}function Aue(e,t){if(1&e){var n=pb();_m(),lb(0,"line",11),mb("click",function(){$y(n);var e=wb(2).index,t=wb().index;return wb().onClick(e,t)}),hb()}if(2&e){var r=wb(2).index,i=wb().index;tb("x1",50*r)("y1",50*i)("x2",50+50*r)("y2",50+50*i)}}function Rue(e,t){if(1&e){var n=pb();_m(),lb(0,"g"),lb(1,"circle",7),mb("click",function(){$y(n);var e=wb().index,t=wb().index;return wb().onClick(e,t)}),hb(),ab(2,xue,1,3,"circle",8),ab(3,Aue,1,4,"line",9),hb()}if(2&e){var r=wb().index,i=wb().index,a=wb();Pw(1),ub("ngClass",a.getSpaceClass(r,i)),tb("cx",25+50*r)("cy",25+50*i)("r",22),Pw(1),ub("ngIf",a.isLastCase(r,i)),Pw(1),ub("ngIf",a.isDead(r,i))}}function Nue(e,t){if(1&e){var n=pb();_m(),lb(0,"circle",15),mb("click",function(){$y(n);var e=wb(2).index,t=wb().index;return wb().onClick(e,t)}),hb()}if(2&e){var r=wb(2),i=r.index,a=r.$implicit,o=wb().index,s=wb();tb("cx",25+50*i)("cy",25+50*o)("r",10)("class",a===s.GoPiece.WHITE_TERRITORY?"player1":"player0")}}function Mue(e,t){if(1&e){var n=pb();_m(),lb(0,"rect",12),mb("click",function(){$y(n);var e=wb().index,t=wb().index;return wb().onClick(e,t)}),hb(),lb(1,"line",13),mb("click",function(){$y(n);var e=wb().index,t=wb().index;return wb().onClick(e,t)}),hb(),lb(2,"line",13),mb("click",function(){$y(n);var e=wb().index,t=wb().index;return wb().onClick(e,t)}),hb(),ab(3,Nue,1,4,"circle",14)}if(2&e){var r=wb().index,i=wb().index,a=wb();bb("id","click_",r,"_",i,""),tb("x",50*r)("y",50*i),Pw(1),tb("x1",50*r)("y1",25+50*i)("x2",50+50*r)("y2",25+50*i),Pw(1),tb("x1",25+50*r)("y1",50*i)("x2",25+50*r)("y2",50+50*i),Pw(1),ub("ngIf",a.isTerritory(r,i))}}function Due(e,t){if(1&e&&(_m(),lb(0,"g"),ab(1,Rue,4,6,"g",5),ab(2,Mue,4,13,"ng-template",null,6,OP),hb()),2&e){var n=t.index,r=ob(3),i=wb().index,a=wb();Pw(1),ub("ngIf",a.caseIsFull(n,i))("ngIfElse",r)}}function Lue(e,t){if(1&e&&(_m(),lb(0,"g"),ab(1,Due,4,2,"g",2),hb()),2&e){var n=t.$implicit;Pw(1),ub("ngForOf",n)}}function Fue(e,t){if(1&e&&(_m(),fb(0,"rect",16)),2&e){var n=wb();tb("x",12.5+50*n.ko.get().x)("y",12.5+50*n.ko.get().y)}}function Bue(e,t){if(1&e){var n=pb();_m(),lb(0,"circle",17),mb("click",function(){var e=$y(n).$implicit;return wb().onClick(e.x,e.y)}),hb()}if(2&e){var r=t.$implicit;tb("cx",25+50*r.x)("cy",25+50*r.y)("r",7)}}var Vue=function(){var e=function(e){Gv(n,e);var t=$v(n);function n(e){var r;return tp(this,n),(r=t.call(this,e)).ko=sB.empty(),r.last=sB.empty(),r.captures=[],r.GoPiece=due,r.scores=sB.of([0,0]),r.rules=new _ue(pue),r.availableMinimaxes=[new Cue(r.rules,"GoMinimax")],r.encoder=fue.encoder,r.tutorial=(new Iue).tutorial,r.canPass=!0,r.updateBoard(),r}return rp(n,[{key:"onClick",value:function(e,t){var n=this;return tB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:return n.last=sB.empty(),a=new fue(e,t),r.abrupt("return",n.chooseMove(a,n.rules.node.gameState,n.scores.get()));case 6:case"end":return r.stop()}},r)}))()}},{key:"updateBoard",value:function(){rB(n.VERBOSE,"updateBoard");var e=this.rules.node.gameState,t=this.rules.node.move,r=e.phase;this.board=e.getCopiedBoard(),this.scores=sB.of(e.getCapturedCopy()),this.ko=e.koCoord,t.isPresent()?this.showCaptures():this.captures=[],this.last=t.map(function(e){return e.coord}),this.canPass=r!==vue.FINISHED}},{key:"showCaptures",value:function(){var e=this.rules.node.mother.get().gameState;this.captures=[];for(var t=0;t<this.board.length;t++)for(var n=0;n<this.board[0].length;n++){var r=new ire(n,t),i=!1===e.getPieceAt(r).isEmpty(),a=this.board[t][n]===due.EMPTY,o=!1===this.ko.equalsValue(r);i&&a&&o&&this.captures.push(r)}}},{key:"pass",value:function(){var e=this;return tB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.rules.node.gameState.phase,t.abrupt("return",n===vue.PLAYING||n===vue.PASSED?e.onClick(fue.PASS.coord.x,fue.PASS.coord.y):(X5(n===vue.COUNTING||n===vue.ACCEPT,"GoComponent: pass() must be called only in playing, passed, counting, or accept phases"),e.onClick(fue.ACCEPT.coord.x,fue.ACCEPT.coord.y)));case 2:case"end":return t.stop()}},t)}))()}},{key:"getSpaceClass",value:function(e,t){var n=this.rules.node.gameState.getPieceAtXY(e,t);return this.getPlayerClass(n.getOwner())}},{key:"caseIsFull",value:function(e,t){return this.rules.node.gameState.getPieceAtXY(e,t)!==due.EMPTY&&!this.isTerritory(e,t)}},{key:"isLastCase",value:function(e,t){if(this.last.isPresent()){var n=this.last.get();return e===n.x&&t===n.y}return!1}},{key:"isDead",value:function(e,t){return this.rules.node.gameState.isDead(new ire(e,t))}},{key:"isTerritory",value:function(e,t){return this.rules.node.gameState.isTerritory(new ire(e,t))}}]),n}(yie);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(sb(ore))},e.\u0275cmp=ey({type:e,selectors:[["app-go"]],features:[zC],decls:5,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],["x","0","y","0",1,"base","mid-small-stroke"],[4,"ngFor","ngForOf"],["width","25","height","25","class","captured-stroke mid-stroke no-fill",4,"ngIf"],["class","captured",3,"click",4,"ngFor","ngForOf"],[4,"ngIf","ngIfElse"],["empty",""],[1,"base","mid-stroke",3,"ngClass","click"],["class","base no-fill mid-stroke highlighted",4,"ngIf"],["class","base no-fill captured-stroke",3,"click",4,"ngIf"],[1,"base","no-fill","mid-stroke","highlighted"],[1,"base","no-fill","captured-stroke",3,"click"],["width","50","height","50","fill-opacity","0",1,"base","no-stroke",3,"id","click"],[1,"base","mid-stroke",3,"click"],[3,"click",4,"ngIf"],[3,"click"],["width","25","height","25",1,"captured-stroke","mid-stroke","no-fill"],[1,"captured",3,"click"]],template:function(e,t){1&e&&(_m(),lb(0,"svg",0),fb(1,"rect",1),ab(2,Lue,2,1,"g",2),ab(3,Fue,1,2,"rect",3),ab(4,Bue,1,3,"circle",4),hb()),2&e&&(tb("viewBox","0 -3 "+50*t.board.length+" "+(6+50*t.board.length)),Pw(1),tb("width",50*t.board.length)("height",50*t.board.length),Pw(1),ub("ngForOf",t.board),Pw(1),ub("ngIf",t.ko.isPresent()),Pw(1),ub("ngForOf",t.captures))},directives:[AT,NT,IT],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Uue=function(){function e(t,n,r){tp(this,e),this.value=t,this.name=n,this.rgb=r}return rp(e,null,[{key:"of",value:function(t){switch(t){case 0:return e.ANY;case 1:return e.ORANGE;case 2:return e.BLUE;case 3:return e.PURPLE;case 4:return e.PINK;case 5:return e.YELLOW;case 6:return e.RED;case 7:return e.GREEN;default:return nB.expectToBe(t,8,"Invalid value "+t+" for KamisadoColor"),e.BROWN}}}]),e}();Uue.ANY=new Uue(0,"any","#000"),Uue.ORANGE=new Uue(1,"orange","#d67421"),Uue.BLUE=new Uue(2,"blue","#006bac"),Uue.PURPLE=new Uue(3,"purple","#6f3787"),Uue.PINK=new Uue(4,"pink","#d2719e"),Uue.YELLOW=new Uue(5,"yellow","#e2c200"),Uue.RED=new Uue(6,"red","#d23339"),Uue.GREEN=new Uue(7,"green","#009157"),Uue.BROWN=new Uue(8,"brown","#562500");var zue=function(){function e(t,n){tp(this,e),this.player=t,this.color=n}return rp(e,[{key:"equals",value:function(e){return e.player===this.player&&e.color===this.color}},{key:"isEmpty",value:function(){return this.player.equals(Xee.NONE)}},{key:"belongsTo",value:function(e){return this.player===e}}],[{key:"of",value:function(t,n){return new e(t,Uue.of(n))}},{key:"createPlayerColors",value:function(t){return{ORANGE:new e(t,Uue.ORANGE),BLUE:new e(t,Uue.BLUE),PURPLE:new e(t,Uue.PURPLE),PINK:new e(t,Uue.PINK),YELLOW:new e(t,Uue.YELLOW),RED:new e(t,Uue.RED),GREEN:new e(t,Uue.GREEN),BROWN:new e(t,Uue.BROWN)}}}]),e}();zue.NONE=new zue(Xee.NONE,Uue.ANY),zue.ZERO=zue.createPlayerColors(ete.ZERO),zue.ONE=zue.createPlayerColors(ete.ONE);var Hue=function(){function e(){tp(this,e)}return rp(e,null,[{key:"getColorAt",value:function(t,n){return e.COLORS[n][t]}},{key:"getInitialBoard",value:function(){var e=zue.NONE;return[[1,2,3,4,5,6,7,8].map(function(e){return zue.of(ete.ONE,e)}),[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[8,7,6,5,4,3,2,1].map(function(e){return zue.of(ete.ZERO,e)})]}},{key:"isEmptyAt",value:function(e,t){return e[t.y][t.x].equals(zue.NONE)}},{key:"allPieceCoords",value:function(t){for(var n=[],r=0;r<t.length;r++)for(var i=0;i<t[r].length;i++){var a=new ire(i,r);e.isEmptyAt(t,a)||n.push(a)}return n}}]),e}();Hue.INITIAL=Hue.getInitialBoard(),Hue.SIZE=8,Hue.COLORS=ite.mapBiArray([[1,2,3,4,5,6,7,8],[6,1,4,7,2,5,8,3],[7,4,1,6,3,8,5,2],[4,3,2,1,8,7,6,5],[5,6,7,8,1,2,3,4],[2,5,8,3,6,1,4,7],[3,8,5,2,7,4,1,6],[8,7,6,5,4,3,2,1]],Uue.of);var Gue=function(e){Gv(n,e);var t=$v(n);function n(e,r){return tp(this,n),t.call(this,e,r)}return rp(n,[{key:"equals",value:function(e){return e===this||!!e.coord.equals(this.coord)&&e.end.equals(this.end)}},{key:"toString",value:function(){return this===n.PASS?"KamisadoMove(PASS)":"KamisadoMove("+this.coord+"->"+this.end+")"}}],[{key:"of",value:function(e,t){if(e.isNotInRange(Hue.SIZE,Hue.SIZE))throw new Error("Starting coord of KamisadoMove must be on the board, not at "+e.toString());if(t.isNotInRange(Hue.SIZE,Hue.SIZE))throw new Error("End coord of KamisadoMove must be on the board, not at "+t.toString());return new n(e,t)}}]),n}(Oie);Gue.PASS=new Gue(new ire(-2,-2),new ire(-3,-3)),Gue.encoder=new(function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"maxValue",value:function(){return 34952}},{key:"encodeNumber",value:function(e){return 4096*e.coord.x+256*e.coord.y+16*e.end.x+e.end.y}},{key:"decodeNumber",value:function(e){if(e<0)return Gue.PASS;var t=e%16,n=(e=e/16|0)%16,r=(e=e/16|0)%16;return new Gue(new ire((e=e/16|0)%16,r),new ire(n,t))}}]),n}(Jee));var que=function(e){Gv(n,e);var t=$v(n);function n(e,r,i,a,o){var s;return tp(this,n),(s=t.call(this,ite.copyBiArray(o),e)).colorToPlay=r,s.coordToPlay=i,s.alreadyPassed=a,s}return rp(n,null,[{key:"getInitialState",value:function(){return new n(0,Uue.ANY,sB.empty(),!1,Hue.INITIAL)}}]),n}(wre),$ue=function(){var e=rp(function e(){tp(this,e)});return e.NOT_RIGHT_COLOR=function(){return $localize(ua||(ua=Rv(["This piece is not of the color you have to play."])))},e.DIRECTION_NOT_ALLOWED=function(){return $localize(ca||(ca=Rv(["You can only move forward, orthogonally or diagonally."])))},e.MOVE_BLOCKED=function(){return $localize(la||(la=Rv(["This move is blocked by another piece."])))},e.PLAY_WITH_SELECTED_PIECE=function(){return $localize(ha||(ha=Rv(["You must play with the selected piece."])))},e}(),Wue=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"nextCoordToPlay",value:function(e,t){return sB.ofNullable(Hue.allPieceCoords(e.board).find(function(n){var r=e.getPieceAt(n);return r.player===e.getCurrentOpponent()&&r.color===t}))}},{key:"applyLegalMove",value:function(e,t,n){if(e===Gue.PASS){var r=this.nextCoordToPlay(t,t.colorToPlay);return new que(t.turn+1,t.colorToPlay,r,!0,t.board)}var i=e.coord,a=e.end,o=t.getCopiedBoard();o[a.y][a.x]=o[i.y][i.x],o[i.y][i.x]=zue.NONE;var s=Hue.getColorAt(a.x,a.y),u=this.nextCoordToPlay(t,s);return new que(t.turn+1,s,u,!1,o)}},{key:"isLegal",value:function(e,t){return n.isLegal(e,t)}},{key:"getGameStatus",value:function(e){var t=e.gameState,r=t.getCurrentPlayer();if(n.mustPass(t)&&t.alreadyPassed)return Are.getDefeat(r);var i=Lv(n.getFurthestPiecePositions(t),2),a=i[0];return 7===i[1]?Are.ONE_WON:0===a?Are.ZERO_WON:Are.ONGOING}}],[{key:"getColorMatchingPiece",value:function(e){return e.coordToPlay.isPresent()?[e.coordToPlay.get()]:[new ire(0,7),new ire(1,7),new ire(2,7),new ire(3,7),new ire(4,7),new ire(5,7),new ire(6,7),new ire(7,7)]}},{key:"getMovablePieces",value:function(e){var t=this;return n.getColorMatchingPiece(e).filter(function(n){var r,i=Qv(t.playerDirections(e.getCurrentPlayer()));try{for(i.s();!(r=i.n()).done;){var a=r.value,o=n.getNext(a);if(e.isOnBoard(o)&&Hue.isEmptyAt(e.board,o))return!0}}catch(s){i.e(s)}finally{i.f()}return!1})}},{key:"playerDirections",value:function(e){return e===ete.ONE?[nre.DOWN,nre.DOWN_LEFT,nre.DOWN_RIGHT]:[nre.UP,nre.UP_LEFT,nre.UP_RIGHT]}},{key:"directionAllowedForPlayer",value:function(e,t){return t===ete.ZERO?e.y<0:e.y>0}},{key:"getListMovesFromState",value:function(e){var t=n.getMovablePieces(e);return 0===t.length?(X5(!1===e.alreadyPassed,"getListMovesFromState should not be called once game is ended."),[Gue.PASS]):n.getListMovesFromNonBlockedState(e,t)}},{key:"getListMovesFromNonBlockedState",value:function(e,t){var r,i=[],a=e.getCurrentPlayer(),o=Qv(t);try{for(o.s();!(r=o.n()).done;){var s,u=r.value,c=Qv(n.playerDirections(a));try{for(c.s();!(s=c.n()).done;)for(var l=s.value,h=1;h<Hue.SIZE;h++){var f=u.getNext(l,h);if(!e.isOnBoard(f)||!Hue.isEmptyAt(e.board,f))break;var d=Gue.of(u,f);i.push(d)}}catch(v){c.e(v)}finally{c.f()}}}catch(v){o.e(v)}finally{o.f()}return i}},{key:"mustPass",value:function(e){return 0===this.getMovablePieces(e).length}},{key:"getFurthestPiecePositions",value:function(e){var t=7,n=0;return Hue.allPieceCoords(e.board).forEach(function(r){var i=e.getPieceAt(r);X5(i!==zue.NONE,"allPieceCoords failed to filter KamisadoPiece.NONE"),i.player===ete.ONE?n=Math.max(n,r.y):t=Math.min(t,r.y)}),[t,n]}},{key:"isLegal",value:function(e,t){var r=e.coord,i=e.end,a=t.colorToPlay;if(e===Gue.PASS)return this.isLegalPass(t);if(n.isVictory(t))return j5.failure("You should never see this message");var o=t.getPieceAt(r);if(!o.belongsTo(t.getCurrentPlayer()))return j5.failure(pre.MUST_CHOOSE_PLAYER_PIECE());if(a!==Uue.ANY&&o.color!==a)return j5.failure($ue.NOT_RIGHT_COLOR());if(!t.getPieceAt(i).isEmpty())return j5.failure(pre.MUST_CLICK_ON_EMPTY_SPACE());var s=nre.factory.fromMove(r,i);if(s.isFailure())return j5.failure($ue.DIRECTION_NOT_ALLOWED());var u=s.get();if(!n.directionAllowedForPlayer(u,t.getCurrentPlayer()))return j5.failure($ue.DIRECTION_NOT_ALLOWED());for(var c=r;!c.equals(i);)if(c=c.getNext(u),!t.getPieceAt(c).isEmpty())return j5.failure($ue.MOVE_BLOCKED());return j5.success(void 0)}},{key:"isLegalPass",value:function(e){return this.mustPass(e)&&!e.alreadyPassed?j5.success(void 0):j5.failure(pre.CANNOT_PASS())}},{key:"isVictory",value:function(e){var t=Lv(this.getFurthestPiecePositions(e),2),n=t[0],r=t[1];return 0===n||7===r}}]),n}(Rre),jue=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"getListMoves",value:function(e){var t=Wue.getListMovesFromState(e.gameState);return ite.sortByDescending(t,function(e){return e.length()}),t}},{key:"getBoardValue",value:function(e){var t=e.gameState,n=t.getCurrentPlayer();if(Wue.mustPass(t)&&t.alreadyPassed)return new yre(n.getDefeatValue());var r=Lv(Wue.getFurthestPiecePositions(t),2),i=r[0],a=r[1];return new yre(7===a?ete.ONE.getVictoryValue():0===i?ete.ZERO.getVictoryValue():a-(7-i))}}]),n}(gre),Zue=zue.NONE,Yue=zue.ZERO.ORANGE,Kue=zue.ONE.ORANGE,Jue=zue.ZERO.BLUE,Que=zue.ONE.BLUE,Xue=zue.ZERO.PURPLE,ece=zue.ONE.PURPLE,tce=zue.ZERO.PINK,nce=zue.ONE.PINK,rce=zue.ZERO.YELLOW,ice=zue.ONE.YELLOW,ace=zue.ZERO.RED,oce=zue.ONE.RED,sce=zue.ZERO.GREEN,uce=zue.ONE.GREEN,cce=zue.ZERO.BROWN,lce=zue.ONE.BROWN,hce=rp(function e(){tp(this,e),this.tutorial=[Lre.informational($localize(fa||(fa=Rv(["Goal of the game"]))),$localize(da||(da=Rv(["At Kamisado, there are two ways to win the game:\n        either by moving one of your pieces on the opponent's starting line,\n        or by forcing the opponent to make a move that blocks the entire game.\n        Here, Dark wins because its brown piece is on Light's starting line, on the top left."]))),new que(5,Uue.ORANGE,sB.empty(),!1,[[cce,Que,ece,nce,ice,oce,uce,lce],[Zue,Zue,Zue,Zue,Zue,Zue,Zue,Zue],[Zue,Zue,Zue,Zue,Zue,Zue,Zue,Zue],[Zue,Zue,Zue,Zue,Zue,Zue,Zue,Zue],[Zue,Zue,Zue,Kue,Zue,Zue,Zue,Zue],[Zue,Zue,Zue,Zue,Zue,Zue,Zue,Zue],[Zue,Zue,Zue,Zue,Zue,Zue,Zue,Zue],[Zue,sce,ace,rce,tce,Xue,Jue,Yue]])).withPreviousMove(Gue.of(new ire(0,7),new ire(0,0))),Lre.anyMove($localize(va||(va=Rv(["Initial board and initial move"]))),$localize(pa||(pa=Rv(["Here is the initial board.\n        At Kamisado, pieces can only move forward, vertically or diagonally.\n        You're playing first, with dark pieces, you can make your first move.<br/><br/>\n        Click on the piece of your choice and click on the landing square."]))),que.getInitialState(),Gue.of(new ire(7,7),new ire(3,3)),$localize(ga||(ga=Rv(["Perfect! Note that each of your piece has a different color."])))),Lre.fromMove($localize(ya||(ya=Rv(["Moving"]))),$localize(ma||(ma=Rv(["Let us now consider the move of Light, after the blue piece has been moved by Dark.\n        All moves after the initial move must be made from the piece that corresponds to the color\n        of the square upon which the last move ended.\n        Here, the last move ended on the pink square, hence the pink piece must move.\n        It is already selected, you do not have to click on it.<br/><br/>\n        Move it on a blue square."]))),new que(1,Uue.PINK,sB.of(new ire(3,0)),!1,[[Kue,Que,ece,nce,ice,oce,uce,lce],[Zue,Zue,Zue,Zue,Zue,Zue,Zue,Zue],[Zue,Zue,Zue,Zue,Zue,Zue,Zue,Zue],[Zue,Zue,Zue,Zue,Zue,Zue,Zue,Zue],[Zue,Zue,Zue,Zue,Zue,Zue,Zue,Zue],[Zue,Zue,Zue,Zue,Zue,Zue,Jue,Zue],[Zue,Zue,Zue,Zue,Zue,Zue,Zue,Zue],[cce,sce,ace,rce,tce,Xue,Zue,Yue]]),[Gue.of(new ire(3,0),new ire(3,6)),Gue.of(new ire(3,0),new ire(4,1))],$localize(ka||(ka=Rv(["Congratulations!"]))),$localize(_a||(_a=Rv(["You have not moved your pink piece on a blue square!"])))).withPreviousMove(Gue.of(new ire(6,7),new ire(6,5))),Lre.informational($localize(wa||(wa=Rv(["Stuck situation"]))),$localize(Ca||(Ca=Rv(["Dark moved to another pink square, hence you have to move your pink piece again.\n        However, your pink piece is stuck! In this case, you must pass your turn.\n        Dark will now have to play by moving its pink piece."]))),new que(1,Uue.PINK,sB.of(new ire(3,6)),!1,[[Kue,Que,ece,Zue,ice,oce,uce,lce],[Zue,Zue,Zue,Zue,Zue,Zue,Zue,Zue],[Zue,Zue,Zue,Zue,Zue,Zue,Zue,Zue],[Zue,Zue,Zue,Zue,Zue,Zue,Zue,Zue],[Zue,Zue,Zue,Zue,Zue,Zue,Zue,Jue],[Zue,Zue,Zue,Zue,Zue,Zue,Zue,Zue],[Zue,Zue,Zue,nce,Zue,Zue,Zue,Zue],[cce,sce,ace,rce,tce,Xue,Zue,Yue]])).withPreviousMove(Gue.of(new ire(6,5),new ire(7,4))),Lre.fromMove($localize(ba||(ba=Rv(["Victory by blocking"]))),$localize(Ea||(Ea=Rv(["At any time, if a player blocks the entire game, that player loses.\n        In other words, if a player forces its opponent to move a piece that the opponent cannot move,\n        and the player cannot move its own piece of the same color, then that player loses.\n        Here, you're playing Dark and you can force your opponent to create such a situation, hence you can force your opponent to lose!<br/><br/>\n        Try to make this move."]))),new que(2,Uue.RED,sB.of(new ire(2,4)),!1,[[Zue,Que,ece,Zue,Zue,oce,Zue,Zue],[Zue,Zue,Zue,ice,Zue,Zue,Zue,Zue],[Zue,Zue,Zue,nce,Zue,ece,Zue,Zue],[Zue,Zue,Zue,rce,Zue,Zue,Zue,Zue],[Zue,Zue,ace,Zue,Zue,Zue,Zue,Zue],[Zue,Zue,Zue,Zue,Zue,Zue,uce,Zue],[Kue,Zue,Zue,Zue,Zue,tce,Zue,lce],[cce,sce,Zue,Zue,Zue,Zue,Jue,Yue]]),[Gue.of(new ire(2,4),new ire(0,2))],$localize(Sa||(Sa=Rv(["Perfect!\n         Your opponent must move its green piece on the orange square, forcing you to play with your orange piece.\n         Your orange piece will be stuck and you will have to pass your turn.\n         Your opponent will have to pass its turn too because its orange piece is also stuck: the game is completely stuck.\n         In this case, the last player to have moved a piece loses.\n         Here, your opponent will have moved its green piece last, you therefore win!"]))),$localize(Pa||(Pa=Rv(["Failed!"])))).withPreviousMove(Gue.of(new ire(4,0),new ire(3,1)))]});function fce(e,t){if(1&e&&(_m(),fb(0,"circle",8)),2&e){var n=wb(),r=n.index,i=n.$implicit,a=wb().index,o=wb();tb("cx",o.SPACE_SIZE/2+r*o.SPACE_SIZE)("cy",o.SPACE_SIZE/2+a*o.SPACE_SIZE)("fill",o.pieceColor(i))("r",o.SPACE_SIZE/3)}}function dce(e,t){if(1&e&&(_m(),fb(0,"rect",9)),2&e){var n=wb(),r=n.$implicit,i=n.index,a=wb().index,o=wb();ub("ngClass",o.piecePlayerClass(r)),tb("x",o.SPACE_SIZE/2+i*o.SPACE_SIZE-o.SPACE_SIZE/8)("y",o.SPACE_SIZE/2+a*o.SPACE_SIZE-o.SPACE_SIZE/8)("rx",o.isPlayerZero(r)?o.SPACE_SIZE:0)("ry",o.isPlayerZero(r)?o.SPACE_SIZE:0)("width",o.SPACE_SIZE/4)("height",o.SPACE_SIZE/4)}}function vce(e,t){if(1&e){var n=pb();_m(),lb(0,"g"),lb(1,"g",4),mb("click",function(){var e=$y(n).index,t=wb().index;return wb().onClick(e,t)}),fb(2,"rect",5),ab(3,fce,1,4,"circle",6),ab(4,dce,1,7,"rect",7),hb(),hb()}if(2&e){var r=t.$implicit,i=t.index,a=wb().index,o=wb();Pw(1),bb("id","click_",i,"_",a,""),Pw(1),tb("x",i*o.SPACE_SIZE)("y",a*o.SPACE_SIZE)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE)("fill",o.backgroundColor(i,a)),Pw(1),ub("ngIf",r!==o.UNOCCUPIED),Pw(1),ub("ngIf",r!==o.UNOCCUPIED)}}function pce(e,t){if(1&e&&(_m(),lb(0,"g"),ab(1,vce,5,9,"g",1),hb()),2&e){var n=t.$implicit;Pw(1),ub("ngForOf",n)}}function gce(e,t){if(1&e&&(_m(),lb(0,"g"),fb(1,"rect",10),fb(2,"rect",10),hb()),2&e){var n=wb();Pw(1),tb("x",n.lastMove.get().coord.x*n.SPACE_SIZE)("y",n.lastMove.get().coord.y*n.SPACE_SIZE)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE),Pw(1),tb("x",n.lastMove.get().end.x*n.SPACE_SIZE)("y",n.lastMove.get().end.y*n.SPACE_SIZE)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}function yce(e,t){if(1&e&&(_m(),fb(0,"circle",11)),2&e){var n=wb();tb("cx",n.SPACE_SIZE/2+n.chosen.get().x*n.SPACE_SIZE)("cy",n.SPACE_SIZE/2+n.chosen.get().y*n.SPACE_SIZE)}}var mce=function(){var e=function(e){Gv(n,e);var t=$v(n);function n(e){var r;return tp(this,n),(r=t.call(this,e)).UNOCCUPIED=zue.NONE,r.lastMove=sB.empty(),r.chosen=sB.empty(),r.chosenAutomatically=!1,r.rules=new Wue(que),r.availableMinimaxes=[new jue(r.rules,"KamisadoMinimax")],r.encoder=Gue.encoder,r.tutorial=(new hce).tutorial,r.canPass=!1,r.updateBoard(),r}return rp(n,[{key:"backgroundColor",value:function(e,t){return Hue.getColorAt(e,t).rgb}},{key:"isPlayerZero",value:function(e){return e.player===ete.ZERO}},{key:"pieceColor",value:function(e){return e.color.rgb}},{key:"piecePlayerClass",value:function(e){return this.getPlayerClass(e.player)}},{key:"updateBoard",value:function(){var e=this.rules.node.gameState;this.board=e.getCopiedBoard(),this.lastMove=this.rules.node.move,this.canPass=Wue.mustPass(e),this.canPass||e.coordToPlay.isAbsent()?(this.chosenAutomatically=!1,this.chosen=sB.empty()):(this.chosenAutomatically=!0,this.chosen=e.coordToPlay)}},{key:"pass",value:function(){var e=this;return tB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(X5(e.canPass,"KamisadoComponent: pass() must be called only if canPass is true"),e.chooseMove(Gue.PASS,e.rules.node.gameState)));case 1:case"end":return t.stop()}},t)}))()}},{key:"onClick",value:function(e,t){var n=this;return tB(regeneratorRuntime.mark(function r(){var i,a,o,s;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:if(a=new ire(e,t),!n.canPass){r.next=6;break}return r.abrupt("return",n.cancelMove(pre.MUST_PASS()));case 6:if(!n.chosen.isAbsent()){r.next=8;break}return r.abrupt("return",n.choosePiece(e,t));case 8:if(!1!==n.chosenAutomatically||!n.chosen.equalsValue(a)){r.next=10;break}return r.abrupt("return",(n.cancelMoveAttempt(),K5.SUCCESS));case 10:if(o=n.rules.node.gameState.getPieceAtXY(e,t),s=n.rules.node.gameState.getCurrentPlayer(),!o.belongsTo(s)){r.next=15;break}r.t0=n.chosenAutomatically?n.cancelMove($ue.PLAY_WITH_SELECTED_PIECE()):(n.chosen=sB.of(a),K5.SUCCESS),r.next=18;break;case 15:return r.next=17,n.chooseDestination(e,t);case 17:r.t0=r.sent;case 18:return r.abrupt("return",r.t0);case 19:case"end":return r.stop()}},r)}))()}},{key:"choosePiece",value:function(e,t){var n=this.rules.node.gameState.getPieceAtXY(e,t),r=this.rules.node.gameState.getCurrentOpponent();return n.belongsTo(r)?this.cancelMove(pre.CANNOT_CHOOSE_OPPONENT_PIECE()):(this.chosen=sB.of(new ire(e,t)),K5.SUCCESS)}},{key:"chooseDestination",value:function(e,t){var n=this;return tB(regeneratorRuntime.mark(function r(){var i,a,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=n.chosen.get(),a=new ire(e,t),o=Gue.of(i,a),r.abrupt("return",n.chooseMove(o,n.rules.node.gameState));case 2:case"end":return r.stop()}},r)}))()}},{key:"cancelMoveAttempt",value:function(){this.chosenAutomatically||(this.chosen=sB.empty())}}]),n}(yie);return e.\u0275fac=function(t){return new(t||e)(sb(ore))},e.\u0275cmp=ey({type:e,selectors:[["app-kamisado"]],features:[zC],decls:4,vars:4,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf"],["r","30","class","base mid-stroke no-fill highlighted",4,"ngIf"],[3,"id","click"],["fill-opacity","0.7",1,"base-no-fill"],["class","base-no-fill",4,"ngIf"],["class","no-stroke",3,"ngClass",4,"ngIf"],[1,"base-no-fill"],[1,"no-stroke",3,"ngClass"],[1,"base","no-fill","mid-stroke","highlighted"],["r","30",1,"base","mid-stroke","no-fill","highlighted"]],template:function(e,t){1&e&&(_m(),lb(0,"svg",0),ab(1,pce,2,1,"g",1),ab(2,gce,3,8,"g",2),ab(3,yce,1,2,"circle",3),hb()),2&e&&(tb("viewBox","-4 -4 "+8*t.SPACE_SIZE+" "+(8+8*t.SPACE_SIZE)),Pw(1),ub("ngForOf",t.board),Pw(1),ub("ngIf",t.lastMove.isPresent()),Pw(1),ub("ngIf",t.chosen.isPresent()))},directives:[AT,NT,IT],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),kce=function(){var e=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,null,[{key:"getInitialState",value:function(){var e=Xee.NONE,t=ete.ZERO,r=ete.ONE;return new n([[e,t,t,t,t,t,t,e],[r,e,e,e,e,e,e,r],[r,e,e,e,e,e,e,r],[r,e,e,e,e,e,e,r],[r,e,e,e,e,e,e,r],[r,e,e,e,e,e,e,r],[r,e,e,e,e,e,e,r],[e,t,t,t,t,t,t,e]],0)}},{key:"isOnBoard",value:function(e){return e.isInRange(n.SIZE,n.SIZE)}}]),n}(wre);return e.SIZE=8,e}(),_ce=function(e){Gv(n,e);var t=$v(n);function n(e,r,i){var a;return tp(this,n),(a=t.call(this,e,r)).direction=i,a.direction=nre.factory.fromMove(e,r).get(),a}return rp(n,[{key:"equals",value:function(e){return e===this||!!e.coord.equals(this.coord)&&e.end.equals(this.end)}},{key:"toString",value:function(){return"LinesOfActionMove("+this.coord+"->"+this.end+")"}},{key:"encode",value:function(){return n.encoder.encode(this)}},{key:"decode",value:function(e){return n.encoder.decode(e)}}],[{key:"of",value:function(e,t){var r=nre.factory.fromMove(e,t);return r.isFailure()?j5.failure(r.getReason()):e.isNotInRange(kce.SIZE,kce.SIZE)?j5.failure("start coord is not in range"):t.isNotInRange(kce.SIZE,kce.SIZE)?j5.failure("end coord is not in range"):j5.success(new n(e,t,r.get()))}}]),n}(Oie);_ce.encoder=Oie.getEncoder(kce.SIZE,kce.SIZE,function(e,t){return _ce.of(e,t).get()});var wce=function(){var e=rp(function e(){tp(this,e)});return e.INVALID_MOVE_LENGTH=function(){return $localize(Oa||(Oa=Rv(["Your move should have a length equal to the number of pieces that exist on the same line."])))},e.CANNOT_JUMP_OVER_OPPONENT=function(){return $localize(Ta||(Ta=Rv(["You cannot jump over the opponent's pieces."])))},e.PIECE_CANNOT_MOVE=function(){return $localize(Ia||(Ia=Rv(["This piece has no possible move, select another one."])))},e.INVALID_DIRECTION=function(){return $localize(xa||(xa=Rv(["A move must be orthogonal or diagonal"])))},e}(),Cce=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"applyLegalMove",value:function(e,t,n){var r=t.getCopiedBoard();return r[e.coord.y][e.coord.x]=Xee.NONE,r[e.end.y][e.end.x]=t.getCurrentPlayer(),new kce(r,t.turn+1)}},{key:"isLegal",value:function(e,t){return n.isLegal(e,t)}},{key:"getGameStatus",value:function(e){var t=e.gameState,r=Lv(n.getNumberOfGroups(t),2),i=r[0],a=r[1];return 1===i&&a>1?Are.ZERO_WON:i>1&&1===a?Are.ONE_WON:Are.ONGOING}}],[{key:"getListMovesFromState",value:function(e){var t=[];if(n.getVictory(e).isPresent())return t;for(var r=0;r<kce.SIZE;r++)for(var i=0;i<kce.SIZE;i++){var a=new ire(i,r);if(e.getPieceAt(a).isPlayer()){var o,s=Qv(n.possibleTargets(e,a));try{for(s.s();!(o=s.n()).done;){var u=o.value,c=_ce.of(a,u).get();t.push(c)}}catch(l){s.e(l)}finally{s.f()}}}return t}},{key:"getNumberOfGroups",value:function(e){for(var t=ite.createTable(kce.SIZE,kce.SIZE,-1),r=[0,0],i=0,a=0;a<kce.SIZE;a++)for(var o=0;o<kce.SIZE;o++)if(-1===t[a][o]){var s=e.getPieceAt(new ire(o,a));s.isPlayer()&&(i+=1,n.markGroupStartingAt(e,t,new ire(o,a),i),r[s.value]+=1)}return r}},{key:"markGroupStartingAt",value:function(e,t,n,r){for(var i=[n],a=e.getPieceAt(n);i.length>0;){var o=nB.getNonNullable(i.pop());if(-1===t[o.y][o.x]){var s=e.getPieceAt(o);if(s===a){t[o.y][o.x]=r;var u,c=Qv(nre.DIRECTIONS);try{for(c.s();!(u=c.n()).done;){var l=u.value,h=o.getNext(l);e.isOnBoard(h)&&i.push(h)}}catch(f){c.e(f)}finally{c.f()}}else s===Xee.NONE&&(t[o.y][o.x]=0)}}}},{key:"isLegal",value:function(e,t){return t.getPieceAt(e.coord)!==t.getCurrentPlayer()?j5.failure(pre.MUST_CHOOSE_PLAYER_PIECE()):e.length()!==this.numberOfPiecesOnLine(t,e.coord,e.direction)?j5.failure(wce.INVALID_MOVE_LENGTH()):e.coord.getCoordsToward(e.end).some(function(e){return t.getPieceAt(e)===t.getCurrentOpponent()})?j5.failure(wce.CANNOT_JUMP_OVER_OPPONENT()):t.getPieceAt(e.end)===t.getCurrentPlayer()?j5.failure(pre.CANNOT_SELF_CAPTURE()):j5.success(void 0)}},{key:"numberOfPiecesOnLine",value:function(e,t,r){var i,a=0,o=Qv(n.getLineCoords(t,r));try{for(o.s();!(i=o.n()).done;){var s=i.value;e.getPieceAt(s).isPlayer()&&(a+=1)}}catch(u){o.e(u)}finally{o.f()}return a}},{key:"getLineCoords",value:function(e,t){for(var r=n.getEntranceAndForwardDirection(e,t),i=r[0],a=r[1],o=[];kce.isOnBoard(i);)o.push(i),i=i.getNext(a);return o}},{key:"getEntranceAndForwardDirection",value:function(e,t){switch(t){case nre.UP:case nre.DOWN:return[new ire(e.x,0),nre.DOWN];case nre.LEFT:case nre.RIGHT:return[new ire(0,e.y),nre.RIGHT];case nre.UP_RIGHT:case nre.DOWN_LEFT:return[new ire(Math.max(0,e.x+e.y-7),Math.min(7,e.x+e.y)),nre.UP_RIGHT];default:return nB.expectToBeMultiple(t,[nre.UP_LEFT,nre.DOWN_RIGHT]),[new ire(e.x-Math.min(e.x,e.y),e.y-Math.min(e.x,e.y)),nre.DOWN_RIGHT]}}},{key:"getVictory",value:function(e){var t=Lv(n.getNumberOfGroups(e),2),r=t[0],i=t[1];return 1===r&&1===i?sB.of(Xee.NONE):1===r?sB.of(ete.ZERO):1===i?sB.of(ete.ONE):sB.empty()}},{key:"possibleTargets",value:function(e,t){var r,i=[],a=Qv(nre.DIRECTIONS);try{for(a.s();!(r=a.n()).done;){var o=r.value,s=n.numberOfPiecesOnLine(e,t,o),u=t.getNext(o,s);if(e.isOnBoard(u)){var c=_ce.of(t,u).get();n.isLegal(c,e).isSuccess()&&i.push(u)}}}catch(l){a.e(l)}finally{a.f()}return i}}]),n}(Rre),bce=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"getListMoves",value:function(e){return Cce.getListMovesFromState(e.gameState)}},{key:"getBoardValue",value:function(e){var t=e.gameState,n=Lv(Cce.getNumberOfGroups(t),2),r=n[0],i=n[1];return new yre(1===r&&i>1?ete.ZERO.getVictoryValue():r>1&&1===i?ete.ONE.getVictoryValue():100/r*ete.ZERO.getScoreModifier()+100/i*ete.ONE.getScoreModifier())}}]),n}(gre),Ece=Xee.NONE,Sce=ete.ZERO,Pce=ete.ONE,Oce=rp(function e(){tp(this,e),this.tutorial=[Lre.informational($localize(Aa||(Aa=Rv(["Goal of the game"]))),$localize(Ra||(Ra=Rv(["At Lines of Actions, the goal is to group your pieces contiguously, orthogonally and/or diagonally.\n        Here, Dark wins the game:\n        Dark's pieces are forming a single group, while Light's pieces form three groups."]))),new kce([[Ece,Ece,Ece,Ece,Ece,Ece,Ece,Ece],[Pce,Ece,Ece,Ece,Sce,Ece,Ece,Pce],[Ece,Ece,Sce,Sce,Pce,Ece,Ece,Ece],[Ece,Ece,Ece,Sce,Ece,Ece,Ece,Ece],[Ece,Ece,Ece,Ece,Ece,Ece,Ece,Ece],[Ece,Ece,Ece,Ece,Ece,Ece,Ece,Ece],[Ece,Ece,Ece,Ece,Ece,Ece,Ece,Ece],[Ece,Ece,Ece,Ece,Ece,Ece,Ece,Ece]],0)),Lre.anyMove($localize(Na||(Na=Rv(["Initial board and initial move"]))),$localize(Ma||(Ma=Rv(["Here is the initial board.\n         Moves can be made orthogonally or diagonally.\n         The length of a move is equal to the number of pieces that are on the line of the move.\n         Note that there is a helping indicator to let you know where a piece can land when you select it.<br/><br/>\n         You're playing Dark, make the first move!"]))),kce.getInitialState(),_ce.of(new ire(1,7),new ire(1,5)).get(),$localize(Da||(Da=Rv(["Congratulations!"])))),Lre.fromMove($localize(La||(La=Rv(["Jumping"]))),$localize(Fa||(Fa=Rv(["During a move, it is possible to jump above your own pieces.\n        But it is forbidden to jump over the opponent's pieces.<br/><br/>\n        You're playing Dark, make a jump over one of your pieces on the following board."]))),new kce([[Ece,Ece,Ece,Ece,Ece,Ece,Ece,Ece],[Ece,Ece,Pce,Sce,Sce,Ece,Ece,Ece],[Ece,Ece,Ece,Ece,Ece,Ece,Ece,Ece],[Ece,Ece,Ece,Ece,Ece,Ece,Ece,Ece],[Ece,Ece,Ece,Ece,Ece,Ece,Ece,Ece],[Ece,Ece,Ece,Ece,Ece,Ece,Ece,Ece],[Ece,Ece,Ece,Ece,Ece,Ece,Ece,Pce],[Ece,Ece,Ece,Ece,Ece,Ece,Ece,Sce]],0),[_ce.of(new ire(3,1),new ire(6,1)).get()],$localize(Ba||(Ba=Rv(["Congratulations!"]))),$localize(Va||(Va=Rv(["Failed. You did not jump over one of your pieces."])))),Lre.fromMove($localize(Ua||(Ua=Rv(["Moving"]))),$localize(za||(za=Rv(["Here is a different board. Pick the dark piece in the middle (line 4, column 4)\n        and observe its possible moves.\n        Horizontally, this piece can move only of one square because it is the only piece on this line.\n        Vertically, this piece can move of three squares because there are in total three pieces on that vertical line.\n        But it can only go up, as below it the landing square is occupied by one of your pieces.\n        Diagonally, only one move is possible: on the diagonal that contains three pieces,\n        only in the direction where it does not jump over one of the opponent's pieces.\n        On the other diagonal, there are too many pieces to end the move on the board.<br/><br/>\n        Make one of these moves."]))),new kce([[Ece,Ece,Ece,Ece,Ece,Ece,Pce,Ece],[Ece,Ece,Ece,Ece,Ece,Sce,Ece,Ece],[Ece,Ece,Ece,Ece,Pce,Ece,Ece,Ece],[Ece,Ece,Ece,Sce,Ece,Ece,Ece,Ece],[Ece,Ece,Ece,Ece,Ece,Ece,Ece,Pce],[Ece,Ece,Ece,Ece,Ece,Pce,Ece,Pce],[Ece,Ece,Ece,Sce,Ece,Ece,Pce,Pce],[Ece,Ece,Ece,Sce,Ece,Ece,Ece,Ece]],0),[_ce.of(new ire(3,3),new ire(3,0)).get(),_ce.of(new ire(3,3),new ire(0,0)).get(),_ce.of(new ire(3,3),new ire(2,3)).get(),_ce.of(new ire(3,3),new ire(4,3)).get()],$localize(Ha||(Ha=Rv(["Congratulations!"]))),$localize(Ga||(Ga=Rv(["Failed. This was not one of the expected moves."])))),Lre.fromMove($localize(qa||(qa=Rv(["Capturing"]))),$localize($a||($a=Rv(["If a move ends on an opponent's pieces, this one is captured and removed from the board.\n        However, a move cannot end on one of the player's pieces.\n        Watch out, having less pieces at Lines of Action makes a victory easier, as there are less pieces to regroup!\n        If a player has only one piece, that player wins the game.<br/><br/>\n        On the following board, try to capture one piece with Dark."]))),new kce([[Ece,Sce,Ece,Sce,Sce,Sce,Sce,Ece],[Pce,Ece,Ece,Ece,Ece,Ece,Ece,Pce],[Ece,Ece,Sce,Ece,Pce,Ece,Ece,Ece],[Pce,Ece,Ece,Ece,Ece,Ece,Ece,Pce],[Pce,Ece,Ece,Ece,Ece,Ece,Ece,Pce],[Pce,Ece,Ece,Ece,Ece,Ece,Ece,Pce],[Pce,Ece,Ece,Ece,Ece,Ece,Ece,Pce],[Ece,Sce,Sce,Sce,Sce,Sce,Sce,Ece]],0),[_ce.of(new ire(2,2),new ire(4,2)).get()],$localize(Wa||(Wa=Rv(["Congratulations!"]))),$localize(ja||(ja=Rv(["Failed!"])))),Lre.fromMove($localize(Za||(Za=Rv(["Tie"]))),$localize(Ya||(Ya=Rv(["In the special case where a move ends up connecting all pieces of both player, simultaneously,\n        then the game ends up with a tie.<br/><br/>\n        You're playing Dark, force the tie in one move."]))),new kce([[Ece,Ece,Ece,Ece,Ece,Ece,Ece,Ece],[Ece,Ece,Ece,Ece,Ece,Ece,Ece,Ece],[Sce,Ece,Ece,Sce,Pce,Sce,Ece,Ece],[Ece,Ece,Ece,Sce,Ece,Ece,Ece,Pce],[Ece,Ece,Ece,Ece,Ece,Ece,Ece,Pce],[Ece,Ece,Ece,Ece,Ece,Ece,Ece,Pce],[Ece,Ece,Ece,Ece,Ece,Ece,Ece,Pce],[Ece,Ece,Ece,Ece,Ece,Ece,Ece,Ece]],0),[_ce.of(new ire(0,2),new ire(4,2)).get()],$localize(Ka||(Ka=Rv(["Congratulations!"]))),$localize(Ja||(Ja=Rv(["Failed!"]))))]});function Tce(e,t){if(1&e&&(_m(),fb(0,"circle",5)),2&e){var n=wb().index,r=wb().index,i=wb();ub("ngClass",i.getPieceClasses(n,r)),tb("cx",i.SPACE_SIZE/2+n*i.SPACE_SIZE)("cy",i.SPACE_SIZE/2+r*i.SPACE_SIZE)}}function Ice(e,t){if(1&e){var n=pb();_m(),lb(0,"g"),lb(1,"g",2),mb("click",function(){var e=$y(n).index,t=wb().index;return wb().onClick(e,t)}),fb(2,"rect",3),ab(3,Tce,1,3,"circle",4),hb(),hb()}if(2&e){var r=t.$implicit,i=t.index,a=wb().index,o=wb();Pw(1),bb("id","click_",i,"_",a,""),Pw(1),ub("ngClass",o.getSquareClasses(i,a)),tb("x",i*o.SPACE_SIZE)("y",a*o.SPACE_SIZE)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),Pw(1),ub("ngIf",r!==o.EMPTY)}}function xce(e,t){if(1&e&&(_m(),lb(0,"g"),ab(1,Ice,4,8,"g",1),hb()),2&e){var n=t.$implicit;Pw(1),ub("ngForOf",n)}}function Ace(e,t){if(1&e){var n=pb();_m(),lb(0,"g"),lb(1,"rect",6),mb("click",function(){var e=$y(n).$implicit;return wb().onClick(e.x,e.y)}),hb(),hb()}if(2&e){var r=t.$implicit,i=wb();Pw(1),tb("x",r.x*i.SPACE_SIZE+(i.SPACE_SIZE/2-i.INDICATOR_SIZE/2))("y",r.y*i.SPACE_SIZE+(i.SPACE_SIZE/2-i.INDICATOR_SIZE/2))("width",i.INDICATOR_SIZE)("height",i.INDICATOR_SIZE)}}var Rce=function(){var e=function(e){Gv(n,e);var t=$v(n);function n(e){var r;return tp(this,n),(r=t.call(this,e)).INDICATOR_SIZE=20,r.EMPTY=Xee.NONE,r.targets=[],r.selected=sB.empty(),r.lastMove=sB.empty(),r.captured=sB.empty(),r.rules=new Cce(kce),r.availableMinimaxes=[new bce(r.rules,"LinesOfActionMinimax")],r.encoder=_ce.encoder,r.tutorial=(new Oce).tutorial,r.updateBoard(),r}return rp(n,[{key:"onClick",value:function(e,t){var n=this;return tB(regeneratorRuntime.mark(function r(){var i,a,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:if(a=new ire(e,t),!n.selected.isPresent()){r.next=9;break}if(n.getState().getPieceAt(a)!==n.getState().getCurrentPlayer()){r.next=7;break}return r.abrupt("return",n.select(a));case 7:return o=_ce.of(n.selected.get(),new ire(e,t)),r.abrupt("return",o.isSuccess()?n.chooseMove(o.get(),n.rules.node.gameState):n.cancelMove(wce.INVALID_DIRECTION()));case 9:return r.abrupt("return",n.select(a));case 10:case"end":return r.stop()}},r)}))()}},{key:"select",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t.getState().getPieceAt(e)!==t.getState().getCurrentPlayer()?t.cancelMove(pre.MUST_CHOOSE_PLAYER_PIECE()):(t.selected=sB.of(e),t.targets=Cce.possibleTargets(t.rules.node.gameState,t.selected.get()),0===t.targets.length?t.cancelMove(wce.PIECE_CANNOT_MOVE()):K5.SUCCESS));case 1:case"end":return n.stop()}},n)}))()}},{key:"getState",value:function(){return this.rules.node.gameState}},{key:"getPreviousState",value:function(){return this.rules.node.mother.get().gameState}},{key:"updateBoard",value:function(){if(this.cancelMoveAttempt(),this.board=this.getState().board,this.lastMove=this.rules.node.move,this.lastMove.isPresent()){var e=this.lastMove.get();this.captured=this.getPreviousState().getPieceAt(e.end).isPlayer()?sB.of(e.end):sB.empty()}}},{key:"cancelMoveAttempt",value:function(){this.selected=sB.empty(),this.targets=[]}},{key:"getSquareClasses",value:function(e,t){var n=new ire(e,t);if(this.lastMove.isPresent()){var r=this.lastMove.get().coord,i=this.lastMove.get().end;if(this.captured.isPresent()&&n.equals(this.captured.get()))return["captured"];if(n.equals(r)||n.equals(i))return["moved"]}return[]}},{key:"getPieceClasses",value:function(e,t){var n=this.board[t][e],r=new ire(e,t),i=[this.getPlayerClass(n)];return this.selected.isPresent()&&this.selected.get().equals(r)&&i.push("selected"),i}}]),n}(yie);return e.\u0275fac=function(t){return new(t||e)(sb(ore))},e.\u0275cmp=ey({type:e,selectors:[["app-linesofaction"]],features:[zC],decls:3,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 -4 800 808","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click"],[1,"base",3,"ngClass"],["r","40","class","base",3,"ngClass",4,"ngIf"],["r","40",1,"base",3,"ngClass"],[1,"indicator",3,"click"]],template:function(e,t){1&e&&(_m(),lb(0,"svg",0),ab(1,xce,2,1,"g",1),ab(2,Ace,2,4,"g",1),hb()),2&e&&(Pw(1),ub("ngForOf",t.board),Pw(1),ub("ngForOf",t.targets))},directives:[AT,IT,NT],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Nce=Number.MAX_SAFE_INTEGER,Mce=Number.MIN_SAFE_INTEGER,Dce=function(e){Gv(n,e);var t=$v(n);function n(e,r){var i;return tp(this,n),(i=t.call(this,ite.copyBiArray(n.initialBoard),e)).turn=e,i.location=r,i}return rp(n,null,[{key:"getInitialState",value:function(){return new n(0,new ire(0,0))}}]),n}(wre);Dce.BOARD_0=[[6,4,3,1],[4,4,3,1],[3,3,2,0],[1,1,0,0]],Dce.BOARD_1=[[0,+Nce,-1,-1],[1,2,+Nce,-1],[+Mce,3,4,-1],[-1,+Mce,+Mce,-1]],Dce.BOARD_2=[[0,+Nce,-1,-1],[+Nce,-1,-1,-1],[-1,-1,-1,-1],[-1,-1,-1,-1]],Dce.BOARD_3=[[0,1,+Mce,-1],[1,+Mce,-1,-1],[+Mce,-1,-1,-1],[-1,-1,-1,-1]],Dce.BOARD_4=[[0,1,+Mce,-1],[1,+Mce,-1,-1],[+Mce,-1,-1,-1],[-1,-1,-1,1]],Dce.initialBoard=Dce.BOARD_0;var Lce=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"applyLegalMove",value:function(e,t,n){var r=new ire(t.location.x+(!0===e.right?1:0),t.location.y+(!1===e.right?1:0));return new Dce(t.turn+1,r)}},{key:"isLegal",value:function(e,t){var n=t.location,r=t.getCopiedBoard();return n.x+1===r[0].length&&!0===e.right||n.y+1===r.length&&!1===e.right?j5.failure("incorrect move"):j5.success(void 0)}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"getGameStatus",value:function(e){var t=e.gameState,n=t.getPieceAt(t.location);return n===ete.ZERO.getVictoryValue()?Are.ZERO_WON:n===ete.ONE.getVictoryValue()?Are.ONE_WON:t.location.equals(new ire(3,3))?0===n?Are.DRAW:n>0?Are.ONE_WON:Are.ZERO_WON:Are.ONGOING}}]),n}(Rre),Fce=function(e){Gv(n,e);var t=$v(n);function n(e){var r;return tp(this,n),(r=t.call(this)).right=e,r}return rp(n,[{key:"equals",value:function(e){return this===e||this.right===e.right}},{key:"toString",value:function(){return this.right?"Move RIGHT":"Move DOWN"}}]),n}(bre);Fce.RIGHT=new Fce(!0),Fce.DOWN=new Fce(!1),Fce.encoder=new(function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"maxValue",value:function(){return 1}},{key:"decodeNumber",value:function(e){return 0===e?Fce.RIGHT:Fce.DOWN}},{key:"encodeNumber",value:function(e){return e.right?0:1}}]),n}(Jee));var Bce=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"getBoardValue",value:function(e){var t=Lce.getGameStatus(e);if(t.isEndGame)return new yre(t.toBoardValue());var n=e.gameState;return new yre(n.getPieceAt(n.location))}},{key:"getListMoves",value:function(e){var t=[],n=e.gameState;return n.location.x<3&&t.push(Fce.RIGHT),n.location.y<3&&t.push(Fce.DOWN),t}}]),n}(gre);function Vce(e,t){1&e&&(db(0),Rb(1,"("),vb())}function Uce(e,t){1&e&&(db(0),Rb(1,")"),vb())}function zce(e,t){if(1&e&&(lb(0,"td"),ab(1,Vce,2,0,"ng-container",3),Rb(2),ab(3,Uce,2,0,"ng-container",3),hb()),2&e){var n=t.$implicit,r=t.index,i=wb().index,a=wb();Pw(1),ub("ngIf",a.coord.x===r&&a.coord.y===i),Pw(1),Mb(" ",n," "),Pw(1),ub("ngIf",a.coord.x===r&&a.coord.y===i)}}function Hce(e,t){if(1&e&&(lb(0,"tr"),ab(1,zce,4,3,"td",0),hb()),2&e){var n=t.$implicit;Pw(1),ub("ngForOf",n)}}var Gce=function(){var e=function(e){Gv(n,e);var t=$v(n);function n(e){var r;return tp(this,n),(r=t.call(this,e)).coord=new ire(-1,-1),r.rules=new Lce(Dce),r.availableMinimaxes=[new Bce(r.rules,"MinimaxTestingMinimax")],r.encoder=Fce.encoder,r}return rp(n,[{key:"chooseRight",value:function(){var e=this;return tB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.canUserPlay("#click_right"),t.abrupt("return",n.isFailure()?e.cancelMove(n.getReason()):e.chooseMove(Fce.RIGHT,e.rules.node.gameState));case 2:case"end":return t.stop()}},t)}))()}},{key:"chooseDown",value:function(){var e=this;return tB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.canUserPlay("#click_down"),t.abrupt("return",n.isFailure()?e.cancelMove(n.getReason()):e.chooseMove(Fce.DOWN,e.rules.node.gameState));case 2:case"end":return t.stop()}},t)}))()}},{key:"updateBoard",value:function(){var e=this.rules.node.gameState;this.board=e.getCopiedBoard(),this.coord=e.location}}]),n}(yie);return e.\u0275fac=function(t){return new(t||e)(sb(ore))},e.\u0275cmp=ey({type:e,selectors:[["app-minimax-testing"]],features:[zC],decls:8,vars:2,consts:[[4,"ngFor","ngForOf"],["id","click_right",3,"click"],["id","click_down",3,"click"],[4,"ngIf"]],template:function(e,t){1&e&&(lb(0,"table"),ab(1,Hce,2,1,"tr",0),lb(2,"div",1),mb("click",function(){return t.chooseRight()}),Rb(3," goRight "),hb(),lb(4,"div",2),mb("click",function(){return t.chooseDown()}),Rb(5," goDown "),hb(),lb(6,"div"),Rb(7),hb(),hb()),2&e&&(Pw(1),ub("ngForOf",t.board),Pw(6),Mb(" ",t.coord," "))},directives:[AT,NT],encapsulation:2}),e}(),qce=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,null,[{key:"getInitialState",value:function(){return new n(ite.createTable(7,6,Xee.NONE),0)}}]),n}(wre),$ce=function(e){Gv(n,e);var t=$v(n);function n(e){var r;return tp(this,n),(r=t.call(this)).x=e,r}return rp(n,[{key:"equals",value:function(e){return this===e}},{key:"toString",value:function(){return"P4Move("+this.x+")"}}],[{key:"of",value:function(e){switch(e){case 0:return n.ZERO;case 1:return n.ONE;case 2:return n.TWO;case 3:return n.THREE;case 4:return n.FOUR;case 5:return n.FIVE;case 6:return n.SIX;default:throw new Error("Invalid P4Move")}}}]),n}(bre);$ce.ZERO=new $ce(0),$ce.ONE=new $ce(1),$ce.TWO=new $ce(2),$ce.THREE=new $ce(3),$ce.FOUR=new $ce(4),$ce.FIVE=new $ce(5),$ce.SIX=new $ce(6),$ce.encoder=new(function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"maxValue",value:function(){return 6}},{key:"encodeNumber",value:function(e){return e.x}},{key:"decodeNumber",value:function(e){return $ce.of(e)}}]),n}(Jee));var Wce=function(){var e=rp(function e(){tp(this,e)});return e.COLUMN_IS_FULL=function(){return $localize(Qa||(Qa=Rv(["Please put your piece in an incomplete column."])))},e}(),jce=function(){var e=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"applyLegalMove",value:function(e,t,r){var i=e.x,a=t.getCopiedBoard(),o=n.getLowestUnoccupiedCase(a,i),s=t.turn;return a[o][i]=t.getCurrentPlayer(),new qce(a,s+1)}},{key:"isLegal",value:function(e,t){return rB(n.VERBOSE,{context:"P4Rules.isLegal",move:e.toString(),state:t}),t.getPieceAtXY(e.x,0).isPlayer()?j5.failure(Wce.COLUMN_IS_FULL()):j5.success(void 0)}},{key:"getGameStatus",value:function(e){for(var t=e.gameState,r=0;r<7;r++)for(var i=5;i>=0&&t.board[i][r].isPlayer();i--){var a=n.getSquareScore(t.board,new ire(r,i));if(xre.getScoreStatus(a)===Pre.VICTORY)return Are.getVictory(t.getCurrentOpponent())}return 42===t.turn?Are.DRAW:Are.ONGOING}}],[{key:"getVictoriousCoords",value:function(e){for(var t=[],r=0;r<7;r++)for(var i=5;-1!==i&&e.board[i][r].isPlayer();i--){var a=n.getSquareScore(e.board,new ire(r,i));(a===ete.ZERO.getVictoryValue()||a===ete.ONE.getVictoryValue())&&t.push(new ire(r,i))}return t}},{key:"getBoardValueFromScratch",value:function(e){rB(n.VERBOSE,{P4Rules_getBoardValueFromScratch:{state:e}});for(var t=0,r=0;r<7;r++)for(var i=5;-1!==i&&e.board[i][r].isPlayer();i--){var a=n.getSquareScore(e.board,new ire(r,i));if(xre.getScoreStatus(a)!==Pre.DEFAULT)return rB(n.VERBOSE,{preVictoryOrVictory:{state:e,tmpScore:a,coord:{x:r,y:i}}}),new yre(a);t+=a}return new yre(t)}},{key:"getLowestUnoccupiedCase",value:function(e,t){for(var n=0;n<6&&e[n][t]===Xee.NONE;)n++;return n-1}},{key:"getNumberOfFreeSpacesAndAllies",value:function(e,t,n,r,i){for(var a=0,o=0,s=!0,u=new ire(t.x+n.x,t.y+n.y);u.isInRange(7,6)&&3!==a;){var c=e[u.y][u.x];if(c===r)return[a,o];c===i&&s?o++:s=!1,c!==r&&c!==i&&a++,u=u.getNext(n)}return[a,o]}},{key:"getOpponent",value:function(e,t){var n=e[t.y][t.x];return X5(n.isPlayer(),"getOpponent should not be called with PlayerOrNone.NONE"),n===ete.ONE?ete.ZERO:ete.ONE}},{key:"getSquareScore",value:function(e,t){rB(n.VERBOSE,"getSquareScore(board, "+t.x+", "+t.y+") called"),rB(n.VERBOSE,e);var r,i=0,a=n.getOpponent(e,t),o=a.getOpponent(),s=new Ore,u=new Ore,c=Qv(nre.DIRECTIONS);try{for(c.s();!(r=c.n()).done;){var l=r.value,h=n.getNumberOfFreeSpacesAndAllies(e,t,l,a,o);s.set(l,h[0]),u.set(l,h[1])}}catch(y){c.e(y)}finally{c.f()}for(var f=0,d=[nre.UP,nre.UP_RIGHT,nre.RIGHT,nre.DOWN_RIGHT];f<d.length;f++){var v=d[f],p=u.get(v).get()+u.get(v.getOpposite()).get();if(p>2)return rB(n.VERBOSE,{text:"there is some kind of victory here ("+t.x+", "+t.y+")\nline allies : "+p+"\n",board:e}),o.getVictoryValue();var g=s.get(v).get()+s.get(v.getOpposite()).get();3===g?i+=2:g>3&&(i+=g-2)}return i*o.getScoreModifier()}},{key:"getListMoves",value:function(e){rB(n.VERBOSE,{context:"P4Rules.getListMoves",node:e});for(var t=e.gameState,r=[],i=0;i<7;i++)if(t.getPieceAtXY(i,0)===Xee.NONE){var a=$ce.of(i);r.push(a)}return r}},{key:"getBoardValue",value:function(e){return rB(n.VERBOSE,{text:"P4Rules.getBoardValue called",board:e.getCopiedBoard()}),n.getBoardValueFromScratch(e)}}]),n}(Rre);return e.VERBOSE=!1,e}(),Zce=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"getListMoves",value:function(e){return jce.getListMoves(e)}},{key:"getBoardValue",value:function(e){var t=e.gameState;return rB(jce.VERBOSE,{text:"P4Rules instance methods getBoardValue called",board:t.getCopiedBoard()}),jce.getBoardValue(t)}}]),n}(gre),Yce=ete.ZERO,Kce=ete.ONE,Jce=Xee.NONE,Qce=rp(function e(){tp(this,e),this.tutorial=[Lre.informational($localize(Xa||(Xa=Rv(["Goal of the game"]))),$localize(eo||(eo=Rv(["The board at Four in a Row is made of 7 columns and 6 rows, and it is initially empty.\n        The first player plays Dark, the second plays Light.\n        The goal is to be the first to align 4 of its pieces (horizontally, vertically, or diagonally)."]))),qce.getInitialState()),Lre.anyMove($localize(to||(to=Rv(["Dropping a piece"]))),$localize(no||(no=Rv(["Click on any space in any column."]))),qce.getInitialState(),$ce.THREE,$localize(ro||(ro=Rv(["As you can see, the piece falls at the bottom of the column."])))),Lre.fromMove($localize(io||(io=Rv(["Victory"]))),$localize(ao||(ao=Rv(["You're playing Dark.\n        Place your piece so that you create a horizontal alignment of 4 of your pieces."]))),new qce([[Jce,Jce,Jce,Jce,Jce,Jce,Jce],[Jce,Jce,Jce,Jce,Jce,Jce,Jce],[Jce,Jce,Jce,Jce,Jce,Jce,Jce],[Jce,Jce,Jce,Kce,Jce,Jce,Jce],[Jce,Jce,Jce,Kce,Jce,Jce,Jce],[Jce,Jce,Yce,Yce,Yce,Kce,Jce]],0),[$ce.of(1)],$localize(oo||(oo=Rv(["You won!"]))),$localize(so||(so=Rv(["Failed, you have not aligned 4 pieces and missed an opportunity to win."])))),Lre.fromMove($localize(uo||(uo=Rv(["Other victory"]))),$localize(co||(co=Rv(["You can also align 4 pieces diagonally or vertically."]))),new qce([[Jce,Jce,Jce,Jce,Jce,Jce,Jce],[Jce,Jce,Jce,Jce,Jce,Jce,Jce],[Jce,Jce,Jce,Jce,Jce,Jce,Jce],[Jce,Jce,Jce,Yce,Kce,Jce,Jce],[Jce,Jce,Yce,Yce,Kce,Jce,Jce],[Jce,Yce,Kce,Yce,Yce,Jce,Jce]],0),[$ce.of(3),$ce.of(4)],$localize(lo||(lo=Rv(["You won!"]))),$localize(ho||(ho=Rv(["Failed, you have not aligned 4 pieces and missed an opportunity to win."]))))]});function Xce(e,t){if(1&e&&(_m(),fb(0,"circle",6)),2&e){var n=wb().index,r=wb().index,i=wb();ub("ngClass",i.getSquareFillClass(n,r)),tb("cx",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*r+i.SPACE_SIZE/2)("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)}}function ele(e,t){if(1&e){var n=pb();_m(),lb(0,"g"),lb(1,"rect",4),mb("click",function(){var e=$y(n).index;return wb(2).onClick(e)}),hb(),ab(2,Xce,1,4,"circle",5),hb()}if(2&e){var r=t.$implicit,i=t.index,a=wb().index,o=wb();Pw(1),Cb("id","click_",i,""),tb("x",o.SPACE_SIZE*i)("y",o.SPACE_SIZE*a)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),Pw(1),ub("ngIf",r!=o.EMPTY_CASE)}}function tle(e,t){if(1&e&&(_m(),lb(0,"g"),ab(1,ele,3,6,"g",1),hb()),2&e){var n=t.$implicit;Pw(1),ub("ngForOf",n)}}function nle(e,t){if(1&e&&(_m(),fb(0,"rect",7)),2&e){var n=wb();tb("x",n.SPACE_SIZE*n.last.get().x)("y",n.SPACE_SIZE*n.last.get().y)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}function rle(e,t){if(1&e&&(_m(),fb(0,"rect",8)),2&e){var n=t.$implicit,r=wb();bb("id","victory_coord_",n.x,"_",n.y,""),tb("x",r.SPACE_SIZE*n.x)("y",r.SPACE_SIZE*n.y)("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)}}var ile=function(){var e=function(e){Gv(n,e);var t=$v(n);function n(e){var r;return tp(this,n),(r=t.call(this,e)).EMPTY_CASE=Xee.NONE,r.victoryCoords=[],r.rules=new jce(qce),r.availableMinimaxes=[new Zce(r.rules,"P4Minimax")],r.encoder=$ce.encoder,r.tutorial=(new Qce).tutorial,r.updateBoard(),r}return rp(n,[{key:"onClick",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#click_"+e)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:return i=$ce.of(e),n.next=6,t.chooseMove(i,t.rules.node.gameState);case 6:return n.abrupt("return",n.sent);case 7:case"end":return n.stop()}},n)}))()}},{key:"updateBoard",value:function(){var e=this.rules.node.gameState,t=this.rules.node.move;this.victoryCoords=jce.getVictoriousCoords(e),this.board=e.board,t.isPresent()?this.showLastMove():this.hideLastMove()}},{key:"showLastMove",value:function(){var e=this.rules.node.move,t=jce.getLowestUnoccupiedCase(this.rules.node.gameState.board,e.get().x)+1;this.last=sB.of(new ire(e.get().x,t))}},{key:"hideLastMove",value:function(){this.last=sB.empty()}},{key:"getSquareFillClass",value:function(e,t){return[this.getPlayerClass(this.board[t][e])]}}]),n}(yie);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(sb(ore))},e.\u0275cmp=ey({type:e,selectors:[["app-p4"]],features:[zC],decls:4,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-4 -4 708 608","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base no-fill last-move mid-stroke",4,"ngIf"],["class","base no-fill victory-stroke mid-stroke",3,"id",4,"ngFor","ngForOf"],[1,"base",3,"id","click"],["class","base","pointer-events","fill",3,"ngClass",4,"ngIf"],["pointer-events","fill",1,"base",3,"ngClass"],[1,"base","no-fill","last-move","mid-stroke"],[1,"base","no-fill","victory-stroke","mid-stroke",3,"id"]],template:function(e,t){1&e&&(_m(),lb(0,"svg",0),ab(1,tle,2,1,"g",1),ab(2,nle,1,4,"rect",2),ab(3,rle,1,6,"rect",3),hb()),2&e&&(Pw(1),ub("ngForOf",t.board),Pw(1),ub("ngIf",t.last.isPresent()),Pw(1),ub("ngForOf",t.victoryCoords))},directives:[AT,NT,IT],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),ale=function(e){Gv(n,e);var t=$v(n);function n(e,r,i){var a,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(tp(this,n),(a=t.call(this,e,r)).blockTurned=i,a.turnedClockwise=o,a.coord.isNotInRange(6,6))throw new Error("The board is a 6 cas wide square, invalid coord: "+a.coord.toString());return Wv(a)}return rp(n,[{key:"toString",value:function(){return this.blockTurned.isPresent()?"PentagoMove("+this.coord.toString()+", "+this.blockTurned.get()+", "+(this.turnedClockwise?"CLOCKWISE":"ANTI-CLOCKWISE")+")":"PentagoMove"+this.coord.toString()}},{key:"equals",value:function(e){return!1!==this.coord.equals(e.coord)&&!1!==this.blockTurned.equals(e.blockTurned)&&this.turnedClockwise===e.turnedClockwise}}],[{key:"withRotation",value:function(e,t,r,i){if(r<0||3<r)throw new Error("This block do not exist: "+r);return new n(e,t,sB.of(r),i)}},{key:"rotationless",value:function(e,t){return new n(e,t,sB.empty())}}]),n}(Ere);ale.encoder=new(function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"encodeMove",value:function(e){var t={coord:ire.encoder.encode(e.coord)};return e.blockTurned.isPresent()&&(t.blockTurned=e.blockTurned.get(),t.turnedClockwise=e.turnedClockwise),t}},{key:"decodeMove",value:function(e){var t=e,n=ire.encoder.decode(t.coord),r=sB.ofNullable(t.blockTurned);if(r.isPresent()){var i=t.turnedClockwise;return ale.withRotation(n.x,n.y,r.get(),i)}return ale.rotationless(n.x,n.y)}}]),n}(Kee));var ole=function(){var e=rp(function e(){tp(this,e)});return e.CANNOT_ROTATE_NEUTRAL_BLOCK=function(){return $localize(fo||(fo=Rv(["If the quadrant to turn is neutral, please just use move without rotation."])))},e.MUST_CHOOSE_BLOCK_TO_ROTATE=function(){return $localize(vo||(vo=Rv(["No quadrant is neutral, you must pick a quadrant to rotate."])))},e}(),sle=function(e){Gv(n,e);var t=$v(n);function n(e,r){var i;return tp(this,n),(i=t.call(this,e,r)).neutralBlocks=i.getBlocksNeutralities(),i}return rp(n,[{key:"getBlocksNeutralities",value:function(){for(var e=[],t=0;t<4;t++)this.getBlockNeutrality(t)&&e.push(t);return e}},{key:"getBlockNeutrality",value:function(e){var t=n.getBlockCenter(e),r=this.getPieceAt(t.getNext(nre.UP,1)),i=this.getPieceAt(t.getNext(nre.UP_LEFT,1));return this.getPieceAt(t.getNext(nre.RIGHT,1))===r&&this.getPieceAt(t.getNext(nre.DOWN,1))===r&&this.getPieceAt(t.getNext(nre.LEFT,1))===r&&this.getPieceAt(t.getNext(nre.UP_RIGHT,1))===i&&this.getPieceAt(t.getNext(nre.DOWN_RIGHT,1))===i&&this.getPieceAt(t.getNext(nre.DOWN_LEFT,1))===i}},{key:"applyLegalDrop",value:function(e){var t=this.getCopiedBoard();return t[e.coord.y][e.coord.x]=this.getCurrentPlayer(),new n(t,this.turn)}},{key:"applyLegalMove",value:function(e){var t=this.applyLegalDrop(e),r=t.getCopiedBoard();if(e.blockTurned.isPresent()){var i=n.getBlockCenter(e.blockTurned.get());if(e.turnedClockwise){var a,o=Qv(n.ROTATION_MAP);try{for(o.s();!(a=o.n()).done;){var s=a.value,u=s[0].getNext(i),c=s[1].getNext(i),l=t.getPieceAt(u);r[c.y][c.x]=l}}catch(y){o.e(y)}finally{o.f()}}else{var h,f=Qv(n.ROTATION_MAP);try{for(f.s();!(h=f.n()).done;){var d=h.value,v=d[1].getNext(i),p=d[0].getNext(i),g=t.getPieceAt(v);r[p.y][p.x]=g}}catch(y){f.e(y)}finally{f.f()}}}return new n(r,this.turn+1)}},{key:"blockIsNeutral",value:function(e){return this.neutralBlocks.includes(e)}}],[{key:"getInitialState",value:function(){return new n(ite.createTable(6,6,Xee.NONE),0)}},{key:"getBlockCenter",value:function(e){return new ire(1+(e%2==0?0:3),1+(e<2?0:3))}}]),n}(wre);sle.ROTATION_MAP=[[new ire(-1,-1),new ire(1,-1)],[new ire(0,-1),new ire(1,0)],[new ire(1,-1),new ire(1,1)],[new ire(1,0),new ire(0,1)],[new ire(1,1),new ire(-1,1)],[new ire(0,1),new ire(-1,0)],[new ire(-1,1),new ire(-1,-1)],[new ire(-1,0),new ire(0,-1)]];var ule=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"applyLegalMove",value:function(e,t,n){return t.applyLegalMove(e)}},{key:"isLegal",value:function(e,t){if(t.getPieceAt(e.coord).isPlayer())return j5.failure(pre.MUST_LAND_ON_EMPTY_SPACE());var n=t.applyLegalDrop(e);if(0===n.neutralBlocks.length){if(e.blockTurned.isAbsent())return j5.failure(ole.MUST_CHOOSE_BLOCK_TO_ROTATE())}else if(e.blockTurned.isPresent()){var r=e.blockTurned.get();if(n.neutralBlocks.includes(r))return j5.failure(ole.CANNOT_ROTATE_NEUTRAL_BLOCK())}return j5.success(void 0)}},{key:"getVictoryCoords",value:function(e){var t,r=[],i=Qv(n.VICTORY_SOURCE);try{for(i.s();!(t=i.n()).done;){var a=t.value,o=e.getPieceAt(a[0]),s=[a[0]];if(o.isPlayer()){for(var u=a[0].getNext(a[1]),c=!0,l=0;l<3&&c;l++)e.getPieceAt(u)!==o?c=!1:(s.push(u),u=u.getNext(a[1]));if(c&&(e.getPieceAt(u)===o&&(s.push(u),r=r.concat(s)),a[2])){var h=a[0].getPrevious(a[1],1);e.getPieceAt(h)===o&&(s.push(h),r=r.concat(s))}}}}catch(f){i.e(f)}finally{i.f()}return r}},{key:"getGameStatus",value:function(e){for(var t=e.gameState,n=this.getVictoryCoords(t),r=[!1,!1],i=0;i<n.length;i+=5)r[t.getPieceAt(n[i]).value]=!0;return!0===r[0]?!0===r[1]?Are.DRAW:Are.ZERO_WON:!0===r[1]?Are.ONE_WON:36===t.turn?Are.DRAW:Are.ONGOING}}],[{key:"get",value:function(){return n.singleton.isAbsent()&&(n.singleton=sB.of(new n(sle))),n.singleton.get()}}]),n}(Rre);ule.singleton=sB.empty(),ule.VICTORY_SOURCE=[[new ire(1,0),new Xne(1,1),!1],[new ire(0,1),new Xne(1,1),!1],[new ire(4,0),new Xne(-1,1),!1],[new ire(5,1),new Xne(-1,1),!1],[new ire(1,1),new Xne(1,1),!0],[new ire(4,1),new Xne(-1,1),!0],[new ire(0,1),new Xne(0,1),!0],[new ire(1,1),new Xne(0,1),!0],[new ire(2,1),new Xne(0,1),!0],[new ire(3,1),new Xne(0,1),!0],[new ire(4,1),new Xne(0,1),!0],[new ire(5,1),new Xne(0,1),!0],[new ire(1,0),new Xne(1,0),!0],[new ire(1,1),new Xne(1,0),!0],[new ire(1,2),new Xne(1,0),!0],[new ire(1,3),new Xne(1,0),!0],[new ire(1,4),new Xne(1,0),!0],[new ire(1,5),new Xne(1,0),!0]];var cle=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"getListMoves",value:function(e){var t=[],r=e.gameState.neutralBlocks;if(0===e.gameState.turn)return n.FIRST_TURN_MOVES;var i,a=Qv(this.getLegalDrops(e.gameState));try{for(a.s();!(i=a.n()).done;){var o,s=i.value,u=ale.rotationless(s.x,s.y),c=e.gameState.applyLegalDrop(u),l=Qv(this.getLegalRotations(c,r));try{for(l.s();!(o=l.n()).done;){var h=o.value;t.push(ale.withRotation(s.x,s.y,h[0],h[1]))}}catch(f){l.e(f)}finally{l.f()}0===c.neutralBlocks.length==0&&t.push(u)}}catch(f){a.e(f)}finally{a.f()}return t}},{key:"getLegalDrops",value:function(e){for(var t=[],n=0;n<6;n++)for(var r=0;r<6;r++){var i=new ire(r,n);e.getPieceAt(i)===Xee.NONE&&t.push(i)}return t}},{key:"getLegalRotations",value:function(e,t){for(var n=0===e.neutralBlocks.length,r=[],i=0;i<4;i++)!1===e.blockIsNeutral(i)&&(t.includes(i)?n&&r.push([i,!0]):r.push([i,!0],[i,!1]));return r}},{key:"getBoardValue",value:function(e){return new yre(ule.get().getGameStatus(e).toBoardValue())}}]),n}(gre);cle.FIRST_TURN_MOVES=[ale.rotationless(0,0),ale.rotationless(1,0),ale.rotationless(2,0),ale.rotationless(0,1),ale.rotationless(1,1),ale.rotationless(0,2)];var lle=Xee.NONE,hle=ete.ONE,fle=ete.ZERO,dle=rp(function e(){tp(this,e),this.tutorial=[Lre.informational($localize(po||(po=Rv(["Initial board"]))),$localize(go||(go=Rv(["The initial Pentago board is made of 6x6 spaces, subdivided in 4 quadrants, which can each rotate."]))),sle.getInitialState()),Lre.informational($localize(yo||(yo=Rv(["Goal of the game"]))),$localize(mo||(mo=Rv(["The goal at Pentago is to align 5 of your pieces. In the following board, Dark wins."]))),new sle([[fle,lle,lle,fle,hle,lle],[fle,hle,lle,lle,lle,lle],[fle,lle,hle,lle,lle,lle],[fle,lle,lle,lle,lle,hle],[fle,lle,lle,lle,hle,lle],[lle,lle,lle,lle,lle,lle]],10)).withPreviousMove(ale.withRotation(0,0,0,!1)),Lre.fromPredicate($localize(ko||(ko=Rv(["Simple move"]))),$localize(_o||(_o=Rv(["At their turn, players put a piece on the board and possibly rotate one quadrant.\n        As long as there are neutral quadrants, i.e., quadrants that would not change after being rotated, a player may skip rotating a quadrant.\n        To do this, you have to click on the crossed circle that appears at the center of the board when it is possible.<br/><br/>\n        Do it."]))),new sle([[lle,lle,lle,lle,lle,lle],[lle,fle,lle,lle,hle,lle],[lle,lle,lle,lle,lle,lle],[lle,lle,lle,lle,lle,lle],[lle,hle,lle,lle,fle,lle],[lle,lle,lle,lle,lle,lle]],10),ale.rotationless(2,2),function(e,t){return e.blockTurned.isPresent()?K5.failure($localize(wo||(wo=Rv(["You have made a move with a rotation. This tutorial step is about moves without rotations!"])))):K5.SUCCESS},$localize(Co||(Co=Rv(["Congratulations!"])))),Lre.fromPredicate($localize(bo||(bo=Rv(["Move with rotation"]))),$localize(Eo||(Eo=Rv(["After putting a piece, arrows will appear on non-neutral quadrants.<br/><br/>\n        Click on one of them and see the rotation!"]))),new sle([[lle,lle,lle,lle,lle,lle],[lle,fle,lle,lle,hle,lle],[lle,lle,lle,lle,lle,lle],[lle,lle,lle,lle,lle,lle],[lle,hle,lle,lle,fle,lle],[lle,lle,lle,lle,lle,lle]],10),ale.withRotation(0,0,0,!0),function(e,t){return e.blockTurned.isPresent()?K5.SUCCESS:K5.failure($localize(So||(So=Rv(["You made a move without rotation, try again!"]))))},$localize(Po||(Po=Rv(["Congratulations! Note that if all quadrants are neutral after you have put your piece, there will be no rotation."]))))]});function vle(e,t){if(1&e){var n=pb();_m(),db(0),lb(1,"circle",9),mb("click",function(){var e=$y(n).$implicit,t=wb().$implicit,r=wb().index,i=wb().index;return wb().onClick(3*r+e,3*i+t)}),hb(),vb()}if(2&e){var r=t.$implicit,i=wb().$implicit,a=wb(),o=a.index,s=a.$implicit,u=wb(),c=u.index,l=u.$implicit,h=wb();Pw(1),bb("id","click_",3*o+r,"_",3*c+i,""),ub("ngClass",h.getSquareClasses(3*o+r,3*c+i)),tb("cx",s+2*h.STROKE_WIDTH+(r+.5)*h.SPACE_SIZE)("cy",l+2*h.STROKE_WIDTH+(i+.5)*h.SPACE_SIZE)("r",(h.SPACE_SIZE-h.STROKE_WIDTH)/2)}}var ple=function(){return[0,1,2]};function gle(e,t){1&e&&(_m(),db(0),ab(1,vle,2,6,"ng-container",3),vb()),2&e&&(Pw(1),ub("ngForOf",eP(1,ple)))}function yle(e,t){if(1&e&&(_m(),db(0),fb(1,"rect",8),ab(2,gle,2,2,"ng-container",3),vb()),2&e){var n=t.$implicit,r=t.index,i=wb(),a=i.index,o=i.$implicit,s=wb();Pw(1),ub("ngClass",s.getBlockClasses(r,a)),tb("x",s.STROKE_WIDTH+n)("y",s.STROKE_WIDTH+o)("rx",3*s.STROKE_WIDTH)("ry",3*s.STROKE_WIDTH)("width",s.BLOCK_WIDTH)("height",s.BLOCK_WIDTH),Pw(1),ub("ngForOf",eP(8,ple))}}var mle=function(e){return[0,e]};function kle(e,t){if(1&e&&(_m(),db(0),ab(1,yle,3,9,"ng-container",3),vb()),2&e){var n=wb();Pw(1),ub("ngForOf",tP(1,mle,n.BLOCK_SEPARATION))}}function _le(e,t){if(1&e&&(_m(),fb(0,"circle",10)),2&e){var n=wb();bb("id","currentDrop_",n.currentDrop.get().x,"_",n.currentDrop.get().y,""),ub("ngClass",n.getPlayerClass(n.rules.node.gameState.getCurrentPlayer())),tb("cx",n.getCenter(n.currentDrop.get().x))("cy",n.getCenter(n.currentDrop.get().y))("r",(n.SPACE_SIZE-n.STROKE_WIDTH)/2)}}function wle(e,t){if(1&e){var n=pb();_m(),lb(0,"path",11),mb("click",function(){var e=$y(n).$implicit;return wb().rotate(e)}),hb()}if(2&e){var r=t.$implicit,i=wb();bb("id","rotate_",r[1],"_",r[2]?"clockwise":"counterclockwise",""),tb("d",r[0])("stroke-width",2*i.STROKE_WIDTH)}}function Cle(e,t){if(1&e&&(_m(),fb(0,"circle",12)),2&e){var n=t.$implicit,r=wb();bb("id","victoryCoord_",n.x,"_",n.y,""),ub("ngClass",r.getSquareClasses(n.x,n.y)),tb("cx",r.getCenter(n.x))("cy",r.getCenter(n.y))("r",(r.SPACE_SIZE-r.STROKE_WIDTH)/2)("stroke-width",r.STROKE_WIDTH)}}function ble(e,t){if(1&e){var n=pb();_m(),lb(0,"g",13),mb("click",function(){return $y(n),wb().skipRotation()}),fb(1,"circle",14),fb(2,"line",15),hb()}if(2&e){var r=wb();Pw(1),tb("cx",r.BLOCK_SEPARATION)("cy",r.BLOCK_SEPARATION)("r",.75*r.SPACE_SIZE)("stroke-width",2*r.STROKE_WIDTH),Pw(1),tb("x1",r.BLOCK_SEPARATION-r.DIAGONAL_BAR_OFFSET)("y1",r.BLOCK_SEPARATION+r.DIAGONAL_BAR_OFFSET)("x2",r.BLOCK_SEPARATION+r.DIAGONAL_BAR_OFFSET)("y2",r.BLOCK_SEPARATION-r.DIAGONAL_BAR_OFFSET)("stroke-width",2*r.STROKE_WIDTH)}}var Ele=function(){var e=function(e){Gv(n,e);var t=$v(n);function n(e){var r;return tp(this,n),(r=t.call(this,e)).arrows=[],r.victoryCoords=[],r.rules=new ule(sle),r.availableMinimaxes=[new cle(r.rules,"PentagoMinimax")],r.encoder=ale.encoder,r.tutorial=(new dle).tutorial,r.BLOCK_WIDTH=3*r.SPACE_SIZE+2*r.STROKE_WIDTH,r.BLOCK_SEPARATION=r.BLOCK_WIDTH+2*r.STROKE_WIDTH,r.DIAGONAL_BAR_OFFSET=.75*Math.cos(Math.PI/4)*r.SPACE_SIZE,r.ARROWS=r.generateArrowsCoord(),r.updateBoard(),r}return rp(n,[{key:"updateBoard",value:function(){this.board=this.rules.node.gameState.getCopiedBoard(),this.victoryCoords=this.rules.getVictoryCoords(this.rules.node.gameState),this.showLastMove()}},{key:"showLastMove",value:function(){var e=this.rules.node.move;if(this.cancelMoveAttempt(),e.isAbsent())this.hidePreviousMove();else{var t=e.get();this.movedBlock=t.blockTurned;var n=new ire(t.coord.x%3-1,t.coord.y%3-1);if(t.blockTurned.isPresent()&&!1===n.equals(new ire(0,0))&&this.coordBelongToBlock(t)){var r;r=t.turnedClockwise?nB.getNonNullable(sle.ROTATION_MAP.find(function(e){return e[0].equals(n)}))[1]:nB.getNonNullable(sle.ROTATION_MAP.find(function(e){return e[1].equals(n)}))[0];var i=t.blockTurned.get();r=r.getNext(new Xne(i%2==0?1:4,i<2?1:4),1),this.lastDrop=sB.of(r)}else this.lastDrop=sB.of(t.coord)}}},{key:"coordBelongToBlock",value:function(e){return e.blockTurned.equalsValue(2*(e.coord.y<3?0:1)+(e.coord.x<3?0:1))}},{key:"hidePreviousMove",value:function(){this.lastDrop=sB.empty(),this.movedBlock=sB.empty(),this.victoryCoords=[]}},{key:"generateArrowsCoord",value:function(){var e=2*this.BLOCK_SEPARATION,t=this.SPACE_SIZE,n=.5*this.SPACE_SIZE;return[["M "+n+" 0 q "+t+" -"+t+" "+2*t+" 0",0,!0],["M 0 "+n+" q -"+t+" "+t+" 0 "+2*t,0,!1],["M "+e+" "+n+" q "+t+" "+t+" 0 "+2*t,1,!0],["M "+(e-n)+" 0 q -"+t+" -"+t+" -"+2*t+" 0",1,!1],["M 0 "+(e-n)+" q -"+t+" -"+t+" 0 -"+2*t,2,!0],["M "+n+" "+e+" q "+t+" "+t+" "+2*t+" 0",2,!1],["M "+(e-n)+" "+e+" q -"+t+" "+t+" -"+2*t+" 0",3,!0],["M "+e+" "+(e-n)+"  q "+t+" -"+t+" 0 -"+2*t,3,!1]]}},{key:"cancelMoveAttempt",value:function(){this.arrows=[],this.currentDrop=sB.empty(),this.canSkipRotation=!1}},{key:"onClick",value:function(e,t){var n=this;return tB(regeneratorRuntime.mark(function r(){var i,a,o,s,u;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:if(!n.board[t][e].isPlayer()){r.next=5;break}return r.abrupt("return",n.cancelMove(pre.MUST_LAND_ON_EMPTY_SPACE()));case 5:if(a=ale.rotationless(e,t),o=n.rules.node.gameState,4!==(s=o.applyLegalDrop(a)).neutralBlocks.length){r.next=8;break}return r.abrupt("return",n.chooseMove(a,o));case 8:return u=n.rules.getGameStatus(n.rules.node),r.abrupt("return",(n.canSkipRotation=s.neutralBlocks.length>0&&!1===u.isEndGame,n.currentDrop=sB.of(new ire(e,t)),n.displayArrows(s.neutralBlocks),K5.SUCCESS));case 10:case"end":return r.stop()}},r)}))()}},{key:"getCenter",value:function(e){return(e<3?0:this.BLOCK_SEPARATION)+2*this.STROKE_WIDTH+(e%3+.5)*this.SPACE_SIZE}},{key:"displayArrows",value:function(e){var t=this;this.arrows=[];for(var n=function(n){if(!1===e.includes(n)){var r=t.ARROWS.filter(function(e){return e[1]===n});t.arrows=t.arrows.concat(r)}},r=0;r<4;r++)n(r)}},{key:"getBlockClasses",value:function(e,t){return this.movedBlock.equalsValue(e+2*t)?["moved"]:[]}},{key:"getSquareClasses",value:function(e,t){var n=[],r=this.getPlayerClass(this.board[t][e]);return n.push(r),this.lastDrop.equalsValue(new ire(e,t))&&n.push("last-move"),n}},{key:"rotate",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#rotate_"+e[1]+"_"+(e[2]?"clockwise":"counterclockwise"))).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:return i=t.currentDrop.get(),a=ale.withRotation(i.x,i.y,e[1],e[2]),n.abrupt("return",t.chooseMove(a,t.rules.node.gameState));case 5:case"end":return n.stop()}},n)}))()}},{key:"skipRotation",value:function(){var e=this;return tB(regeneratorRuntime.mark(function t(){var n,r,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(n=e.canUserPlay("#skipRotation")).isFailure()){t.next=3;break}return t.abrupt("return",e.cancelMove(n.getReason()));case 3:return r=e.currentDrop.get(),i=ale.rotationless(r.x,r.y),t.abrupt("return",e.chooseMove(i,e.rules.node.gameState));case 5:case"end":return t.stop()}},t)}))()}}]),n}(yie);return e.\u0275fac=function(t){return new(t||e)(sb(ore))},e.\u0275cmp=ey({type:e,selectors:[["app-pentago"]],features:[zC],decls:9,vars:7,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-60 -60 780 780"],["id","arrowhead","markerWidth","5","markerHeight","3.5","refX","2.5","refY","1.75","orient","auto","fill","blue"],["points","0 0, 5 1.75, 0 3.5"],[4,"ngFor","ngForOf"],["class","base","pointer-events","fill",3,"id","ngClass",4,"ngIf"],["class","no-fill","stroke","blue","marker-end","url(#arrowhead)",3,"id","click",4,"ngFor","ngForOf"],["class","base victory-stroke",3,"id","ngClass",4,"ngFor","ngForOf"],["id","skipRotation",3,"click",4,"ngIf"],[1,"base","no-fill",3,"ngClass"],["pointer-events","fill",1,"base",3,"id","ngClass","click"],["pointer-events","fill",1,"base",3,"id","ngClass"],["stroke","blue","marker-end","url(#arrowhead)",1,"no-fill",3,"id","click"],[1,"base","victory-stroke",3,"id","ngClass"],["id","skipRotation",3,"click"],["stroke","red",1,"background"],["stroke","red"]],template:function(e,t){1&e&&(_m(),lb(0,"svg",0),lb(1,"defs"),lb(2,"marker",1),fb(3,"polygon",2),hb(),hb(),ab(4,kle,2,3,"ng-container",3),ab(5,_le,1,6,"circle",4),ab(6,wle,1,4,"path",5),ab(7,Cle,1,7,"circle",6),ab(8,ble,3,9,"g",7),hb()),2&e&&(Pw(4),ub("ngForOf",tP(5,mle,t.BLOCK_SEPARATION)),Pw(1),ub("ngIf",t.currentDrop.isPresent()),Pw(1),ub("ngForOf",t.arrows),Pw(1),ub("ngForOf",t.victoryCoords),Pw(1),ub("ngIf",t.canSkipRotation))},directives:[AT,NT,IT],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Sle=function(e){Gv(n,e);var t=$v(n);function n(e,r,i){var a;if(tp(this,n),(a=t.call(this,e,r)).z=i,e<0||e>3)throw new Error("PylosCoord: Invalid X: ".concat(e,"."));if(r<0||r>3)throw new Error("PylosCoord: Invalid Y: ".concat(r,"."));if(i<0||i>3)throw new Error("PylosCoord: Invalid Z: ".concat(i,"."));var o=4-i;if(a.isNotInRange(o,o))throw new Error(a.toString()+" is not in range.");return Wv(a)}return rp(n,[{key:"toString",value:function(){return"PylosCoord"+this.toShortString()}},{key:"toShortString",value:function(){return"("+this.x+", "+this.y+", "+this.z+")"}},{key:"equals",value:function(e){return this===e||e.x===this.x&&e.y===this.y&&e.z===this.z}},{key:"isUpperThan",value:function(e){return this.z>e.z}},{key:"getLowerPieces",value:function(){if(0===this.z)throw new Error("PylosCoord: floor pieces don't have lower pieces.");var e=this.z-1;return[new n(this.x,this.y,e),new n(this.x+1,this.y,e),new n(this.x,this.y+1,e),new n(this.x+1,this.y+1,e)]}},{key:"getHigherPieces",value:function(){if(3===this.z)throw new Error("Top piece don't have lower pieces.");var e=this.z+1,t=new ire(this.x-1,this.y-1),r=new ire(this.x,this.y-1),i=new ire(this.x-1,this.y),a=new ire(this.x,this.y),o=4-e;return[t,r,i,a].filter(function(e){return e.isInRange(o,o)}).map(function(t){return new n(t.x,t.y,e)})}},{key:"getNextValid",value:function(e){var t=new ire(this.x,this.y).getNext(e),r=4-this.z;return t.isNotInRange(r,r)?sB.empty():sB.of(new n(t.x,t.y,this.z))}}],[{key:"encodeOptional",value:function(e){return e.isPresent()?n.encode(e.get())+1:0}},{key:"encode",value:function(e){return 16*e.x+4*e.y+e.z}},{key:"decodeToOptional",value:function(e){return 0===e?sB.empty():sB.of(n.decode(e-1))}},{key:"decode",value:function(e){var t=e%4;e-=t;var r=(e/=4)%4;return e-=r,new n(e/=4,r,t)}}]),n}(ire),Ple=function(e){Gv(n,e);var t=$v(n);function n(e,r,i,a){var o;return tp(this,n),(o=t.call(this)).startingCoord=e,o.landingCoord=r,o.firstCapture=i,o.secondCapture=a,o}return rp(n,[{key:"isClimb",value:function(){return this.startingCoord.isPresent()}},{key:"toString",value:function(){var e=this.startingCoord.isAbsent()?"-":this.startingCoord.get().toShortString(),t=this.firstCapture.isAbsent()?"-":this.firstCapture.get().toShortString(),n=this.secondCapture.isAbsent()?"-":this.secondCapture.get().toShortString();return"PylosMove("+e+", "+this.landingCoord.toShortString()+", "+t+", "+n+")"}},{key:"equals",value:function(e){return e===this||!!(this.startingCoord.equals(e.startingCoord)&&this.landingCoord.equals(e.landingCoord)&&this.firstCapture.equals(e.firstCapture)&&this.secondCapture.equals(e.secondCapture))}}],[{key:"fromClimb",value:function(e,t,r){var i=sB.of(e),a=n.checkCaptures(r),o=new n(i,t,a.firstCapture,a.secondCapture);if(!t.isUpperThan(e))throw new Error("PylosMove: When piece move it must move upward.");return o}},{key:"checkCaptures",value:function(e){var t=sB.empty(),n=sB.empty();if(e.length>0&&(t=sB.of(e[0]),e.length>1)){if(e[1].equals(e[0]))throw new Error("PylosMove: should not capture twice same piece.");if(n=sB.of(e[1]),e[1].isUpperThan(e[0])&&(t=sB.of(e[1]),n=sB.of(e[0])),e.length>2)throw new Error("PylosMove: can't capture that much piece.")}return{firstCapture:t,secondCapture:n}}},{key:"fromDrop",value:function(e,t){var r=sB.empty(),i=n.checkCaptures(t);return new n(r,e,i.firstCapture,i.secondCapture)}},{key:"changeCapture",value:function(e,t){var r=n.checkCaptures(t);return new n(e.startingCoord,e.landingCoord,r.firstCapture,r.secondCapture)}}]),n}(bre);Ple.encoder=new(function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"maxValue",value:function(){return 17575999}},{key:"encodeNumber",value:function(e){var t=Sle.encode(e.landingCoord),n=Sle.encodeOptional(e.startingCoord),r=Sle.encodeOptional(e.firstCapture);return 270400*Sle.encodeOptional(e.secondCapture)+4160*r+64*n+t}},{key:"decodeNumber",value:function(e){var t=Sle.decode(e%64);e-=e%64;var n=Sle.decodeToOptional((e/=64)%65);e-=e%65;var r=Sle.decodeToOptional((e/=65)%65);e-=e%65;var i=Sle.decodeToOptional(e/=65);return new Ple(n,t,r,i)}}]),n}(Jee));var Ole=function(e){Gv(n,e);var t=$v(n);function n(e,r){var i;return tp(this,n),(i=t.call(this,r)).boards=e,i}return rp(n,[{key:"getPieceAt",value:function(e){return this.boards[e.z][e.y][e.x]}},{key:"applyLegalMove",value:function(e){var t=[];return t.push({coord:e.landingCoord,value:this.getCurrentPlayer()}),e.startingCoord.isPresent()&&t.push({coord:e.startingCoord.get(),value:Xee.NONE}),e.firstCapture.isPresent()&&t.push({coord:e.firstCapture.get(),value:Xee.NONE}),e.secondCapture.isPresent()&&t.push({coord:e.secondCapture.get(),value:Xee.NONE}),this.setBoardAts(t,this.turn+1)}},{key:"setBoardAts",value:function(e,t){var r,i=[ite.copyBiArray(this.boards[0]),ite.copyBiArray(this.boards[1]),ite.copyBiArray(this.boards[2]),ite.copyBiArray(this.boards[3])],a=Qv(e);try{for(a.s();!(r=a.n()).done;){var o=r.value,s=o.coord;i[s.z][s.y][s.x]=o.value}}catch(u){a.e(u)}finally{a.f()}return new n(i,t)}},{key:"isLandable",value:function(e){if(this.getPieceAt(e).isPlayer())return!1;if(0===e.z)return!0;var t,n=Qv(e.getLowerPieces());try{for(n.s();!(t=n.n()).done;){var r=t.value;if(this.getPieceAt(r)===Xee.NONE)return!1}}catch(i){n.e(i)}finally{n.f()}return!0}},{key:"isSupporting",value:function(e){if(3===e.z)return!1;var t,n=Qv(e.getHigherPieces());try{for(n.s();!(t=n.n()).done;){var r=t.value;if(this.getPieceAt(r).isPlayer())return!0}}catch(i){n.e(i)}finally{n.f()}return!1}},{key:"getPiecesRepartition",value:function(){var e={};e[Xee.NONE.value]=0,e[ete.ZERO.value]=0,e[ete.ONE.value]=0;for(var t=0;t<3;t++)for(var n=0;n<4-t;n++)for(var r=0;r<4-t;r++){var i=new Sle(r,n,t),a=this.getPieceAt(i);e[a.value]=1+e[a.value]}return e}}],[{key:"getInitialState",value:function(){return new n([ite.createTable(4,4,Xee.NONE),ite.createTable(3,3,Xee.NONE),ite.createTable(2,2,Xee.NONE),[[Xee.NONE]]],0)}}]),n}(_re),Tle=function(){var e=rp(function e(){tp(this,e)});return e.MUST_MOVE_UPWARD=function(){return $localize(Oo||(Oo=Rv(["You must move your pieces upward."])))},e.SHOULD_HAVE_SUPPORTING_PIECES=function(){return $localize(To||(To=Rv(["Your piece must land on the board or on 4 other pieces."])))},e.CANNOT_LAND=function(){return $localize(Io||(Io=Rv(["You cannot land on this space."])))},e.CANNOT_CAPTURE=function(){return $localize(xo||(xo=Rv(["You cannot capture."])))},e.INVALID_FIRST_CAPTURE=function(){return $localize(Ao||(Ao=Rv(["Your first capture is invalid."])))},e.INVALID_SECOND_CAPTURE=function(){return $localize(Ro||(Ro=Rv(["Your second capture is invalid."])))},e}(),Ile=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"applyLegalMove",value:function(e,t,r){return n.applyLegalMove(e,t,r)}},{key:"isLegal",value:function(e,t){if(t.getPieceAt(e.landingCoord).isPlayer())return j5.failure(pre.MUST_LAND_ON_EMPTY_SPACE());var r=t.getCurrentOpponent();if(e.startingCoord.isPresent()){var i=e.startingCoord.get(),a=t.getPieceAt(i);if(a===r)return j5.failure(pre.CANNOT_CHOOSE_OPPONENT_PIECE());if(a===Xee.NONE)return j5.failure(pre.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(i.getHigherPieces().filter(function(n){return t.getPieceAt(n).isPlayer()||n.equals(e.landingCoord)}).length>0)return j5.failure(Tle.SHOULD_HAVE_SUPPORTING_PIECES())}if(!t.isLandable(e.landingCoord))return j5.failure(Tle.CANNOT_LAND());if(e.firstCapture.isPresent()){if(!1===n.canCapture(t,e.landingCoord))return j5.failure(Tle.CANNOT_CAPTURE());if(!n.isValidCapture(t,e,e.firstCapture.get()))return j5.failure(Tle.INVALID_FIRST_CAPTURE());if(e.secondCapture.isPresent()&&!n.isValidCapture(t,e,e.secondCapture.get()))return j5.failure(Tle.INVALID_SECOND_CAPTURE())}return j5.success(void 0)}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"getStateInfo",value:function(e){for(var t=[],n=[],r=0;r<3;r++)for(var i=0;i<4-r;i++)for(var a=0;a<4-r;a++){var o=new Sle(a,i,r);e.getPieceAt(o)===e.getCurrentPlayer()&&!1===e.isSupporting(o)&&t.push(o),e.isLandable(o)&&n.push(o)}return{freeToMove:t,landable:n}}},{key:"getClimbingMoves",value:function(e){var t,n=[],r=Qv(e.freeToMove);try{var i=function(){var r,i=t.value,a=Qv(e.landable);try{for(a.s();!(r=a.n()).done;){var o=r.value;if(o.isUpperThan(i)&&!1===o.getLowerPieces().some(function(e){return i.equals(e)})){var s=Ple.fromClimb(i,o,[]);n.push(s)}}}catch(u){a.e(u)}finally{a.f()}};for(r.s();!(t=r.n()).done;)i()}catch(a){r.e(a)}finally{r.f()}return n}},{key:"getDropMoves",value:function(e){var t,n=[],r=Qv(e.landable);try{for(r.s();!(t=r.n()).done;){var i=t.value,a=Ple.fromDrop(i,[]);n.push(a)}}catch(o){r.e(o)}finally{r.f()}return n}},{key:"canCapture",value:function(e,t){for(var n=e.getCurrentPlayer(),r=0,i=[rre.UP,rre.DOWN];r<i.length;r++){var a=i[r],o=t.getNextValid(a);if(o.isPresent()&&e.getPieceAt(o.get())===n)for(var s=0,u=[rre.LEFT,rre.RIGHT];s<u.length;s++){var c=u[s],l=o.get().getNextValid(c);if(l.isPresent()&&e.getPieceAt(l.get())===n){var h=a.getOpposite(),f=l.get().getNextValid(h).get();if(e.getPieceAt(f)===n)return!0}}}return!1}},{key:"getPossibleCaptures",value:function(e,t,n){for(var r=[],i=(e=e.filter(function(e){return!1===t.equalsValue(e)})).concat(n),a=0;a<i.length;a++){var o=i[a];r.push([o]);for(var s=a+1;s<i.length;s++)r.push([i[s],o])}return r}},{key:"applyLegalMove",value:function(e,t,n){return t.applyLegalMove(e)}},{key:"isValidCapture",value:function(e,t,n){var r=e.getCurrentPlayer();return!(!n.equals(t.landingCoord)&&e.getPieceAt(n)!==r||n.getHigherPieces().filter(function(n){return e.getPieceAt(n).isPlayer()&&!1===n.equals(t.firstCapture.get())}).length>0)}},{key:"getGameStatus",value:function(e){var t=e.gameState.getPiecesRepartition();return 15===t[ete.ZERO.value]?Are.ONE_WON:15===t[ete.ONE.value]?Are.ZERO_WON:Are.ONGOING}}]),n}(Rre),xle=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"getListMoves",value:function(e){return n.getListMoves(e)}},{key:"getBoardValue",value:function(e){var t=Ile.getGameStatus(e);if(t.isEndGame)return new yre(t.toBoardValue());var n=e.gameState.getPiecesRepartition();return new yre(n[ete.ZERO.value]-n[ete.ONE.value])}}],[{key:"getListMoves",value:function(e){var t,n=e.gameState,r=[],i=Ile.getStateInfo(n),a=Ile.getClimbingMoves(i),o=Ile.getDropMoves(i),s=Qv(a.concat(o));try{for(s.s();!(t=s.n()).done;){var u=t.value,c=[[]];Ile.canCapture(n,u.landingCoord)&&(c=Ile.getPossibleCaptures(i.freeToMove,u.startingCoord,u.landingCoord));var l,h=Qv(c);try{for(h.s();!(l=h.n()).done;){var f=l.value,d=Ple.changeCapture(u,f);r.push(d)}}catch(v){h.e(v)}finally{h.f()}}}catch(v){s.e(v)}finally{s.f()}return r}}]),n}(gre),Ale=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"getListMoves",value:function(e){var t=xle.getListMoves(e);return this.orderMoves(t)}},{key:"orderMoves",value:function(e){return e.sort(function(e,t){var r=12*n.countStoneUsed(e),i=12*n.countStoneUsed(t);return r+n.sumMoveEmplacementByValue(e)-(i+n.sumMoveEmplacementByValue(t))})}}],[{key:"countStoneUsed",value:function(e){var t=e.isClimb()?0:1;return e.firstCapture.isPresent()&&(t-=1,e.secondCapture.isPresent()&&(t-=1)),t}},{key:"sumMoveEmplacementByValue",value:function(e){var t=e.landingCoord.z;return e.startingCoord.isPresent()&&(t+=3-e.startingCoord.get().z),e.firstCapture.isPresent()&&(t+=3-e.firstCapture.get().z,e.secondCapture.isPresent()&&(t+=3-e.secondCapture.get().z)),t}}]),n}(xle),Rle=Xee.NONE,Nle=ete.ZERO,Mle=ete.ONE,Dle=rp(function e(){tp(this,e),this.tutorial=[Lre.informational($localize(No||(No=Rv(["Goal of the game"]))),$localize(Mo||(Mo=Rv(["At Pylos, the goal is to be the last to play.\n        To do this, you have to save up your pieces.\n        As soon as a player puts its last piece, that player loses the game immediately.\n        Here is what the initial board looks like, it is a board of 4 x 4 squares.\n        This board will become a pyramid, little by little.\n        It will be filled by the pieces of your stock. Each player has 15 pieces."]))),Ole.getInitialState()),Lre.anyMove($localize(Do||(Do=Rv(["Dropping a piece"]))),$localize(Lo||(Lo=Rv(["When it is your turn, you can always drop one of your piece on an empty square.\n        The gray squares are where you can drop your pieces.<br/><br/>\n        Click on one of the squares to drop a piece there."]))),Ole.getInitialState(),Ple.fromDrop(new Sle(1,1,0),[]),$localize(Fo||(Fo=Rv(["There you go, as simple as that."])))),Lre.fromMove($localize(Bo||(Bo=Rv(["Climbing"]))),$localize(Vo||(Vo=Rv(["When 4 pieces form a square, it is possible to put a fifth piece on top.\n        However, when that happens, you can save a piece by climbing instead of dropping a piece.\n        To climb:\n        <ol>\n            <li>Click on one of your free pieces, which should be lower than the landing square.</li>\n            <li>Click on an empty landing square, higher than your selected piece.</li>\n        </ol><br/>\n        Go ahead, climb!"]))),new Ole([[[Nle,Mle,Rle,Rle],[Mle,Nle,Rle,Rle],[Rle,Rle,Rle,Rle],[Rle,Rle,Rle,Nle]],[[Rle,Rle,Rle],[Rle,Rle,Rle],[Rle,Rle,Rle]],[[Rle,Rle],[Rle,Rle]],[[Rle]]],0),[Ple.fromClimb(new Sle(3,3,0),new Sle(0,0,1),[])],$localize(Uo||(Uo=Rv(["Congratulations!<br/>\n        Some important notes:\n        <ol>\n            <li>You cannot move a piece that is directly below another one.</li>\n            <li>Of course, you cannot move the opponent's pieces.</li>\n            <li>You can only climb when the landing square is higher than the starting square.</li>\n        </ol>"]))),$localize(zo||(zo=Rv(["Failed!"])))),Lre.fromMove($localize(Ho||(Ho=Rv(["Square (1/2)"]))),$localize(Go||(Go=Rv(["When the piece you just moved or dropped is the fourth one of a square of your color,\n        you can choose anywhere on the board one or two of your pieces.\n        These pieces will be removed from the board, allowing you to save up one or two pieces.\n        A chosen piece must not be directly below another piece.\n        A chosen piece can be the piece you just placed.\n        You're playing Dark.<br/><br/>\n        Form a square, then click twice on one of the four pieces to remove only that one."]))),new Ole([[[Nle,Nle,Rle,Rle],[Rle,Nle,Rle,Rle],[Rle,Rle,Rle,Rle],[Rle,Rle,Rle,Rle]],[[Rle,Rle,Rle],[Rle,Rle,Rle],[Rle,Rle,Rle]],[[Rle,Rle],[Rle,Rle]],[[Rle]]],0),[Ple.fromDrop(new Sle(0,1,0),[new Sle(0,0,0)]),Ple.fromDrop(new Sle(0,1,0),[new Sle(0,1,0)]),Ple.fromDrop(new Sle(0,1,0),[new Sle(1,0,0)]),Ple.fromDrop(new Sle(0,1,0),[new Sle(1,1,0)])],$localize(qo||(qo=Rv(["Congratulations, you have saved up one piece."]))),$localize($o||($o=Rv(["Failed!"])))),Lre.fromPredicate($localize(Wo||(Wo=Rv(["Square (2/2)"]))),$localize(jo||(jo=Rv(["You're playing Dark.<br/><br/>\n        Do like in the previous step, but this time click on two different pieces."]))),new Ole([[[Nle,Nle,Rle,Rle],[Rle,Nle,Rle,Rle],[Rle,Rle,Rle,Rle],[Rle,Rle,Rle,Rle]],[[Rle,Rle,Rle],[Rle,Rle,Rle],[Rle,Rle,Rle]],[[Rle,Rle],[Rle,Rle]],[[Rle]]],0),Ple.fromDrop(new Sle(0,1,0),[new Sle(0,0,0),new Sle(1,0,0)]),function(e,t){return e.secondCapture.isPresent()?K5.SUCCESS:e.firstCapture.isPresent()?K5.failure($localize(Zo||(Zo=Rv(["Failed, you only captured one piece."])))):K5.failure($localize(Yo||(Yo=Rv(["Failed, you did not capture any piece."]))))},$localize(Ko||(Ko=Rv(["Congratulations, you have saved up two pieces."]))))]});function Lle(e,t){if(1&e&&(_m(),lb(0,"g"),fb(1,"circle",4),hb()),2&e){var n=t.$implicit,r=wb().$implicit,i=wb();Pw(1),bb("id","piece_",r,"_",n,""),ub("ngClass",i.getPlayerPieceClass(r)),tb("cx",.5*i.SPACE_SIZE+(800-i.SPACE_SIZE)/14*n)("cy",860+(i.SPACE_SIZE+10)*r)("r",.5*i.SPACE_SIZE)}}function Fle(e,t){if(1&e&&(_m(),lb(0,"g"),ab(1,Lle,2,6,"g",1),hb()),2&e){var n=t.$implicit,r=wb();Pw(1),ub("ngForOf",r.getPlayerSidePieces(n))}}function Ble(e,t){if(1&e){var n=pb();_m(),lb(0,"circle",8),mb("click",function(){$y(n);var e=wb(2).$implicit,t=wb().$implicit,r=wb().$implicit;return wb().onPieceClick(e,t,r)}),hb()}if(2&e){var r=wb(2).$implicit,i=wb().$implicit,a=wb().$implicit,o=wb();Eb("id","piece_",r,"_",i,"_",a,""),ub("ngClass",o.getPieceClasses(r,i,a)),tb("r",o.getPieceRadius(a)-o.STROKE_WIDTH)("cx",o.getPieceCx(r,i,a))("cy",o.getPieceCy(r,i,a))}}function Vle(e,t){if(1&e){var n=pb();_m(),lb(0,"rect",8),mb("click",function(){$y(n);var e=wb(2).$implicit,t=wb().$implicit,r=wb().$implicit;return wb().onDrop(e,t,r)}),hb()}if(2&e){var r=wb(2).$implicit,i=wb().$implicit,a=wb().$implicit,o=wb();Eb("id","drop_",r,"_",i,"_",a,""),ub("ngClass",o.getSquareClasses(r,i,a)),tb("width",2*o.getPieceRadius(a))("height",2*o.getPieceRadius(a))("x",o.getPieceCx(r,i,a)-o.getPieceRadius(a))("y",o.getPieceCy(r,i,a)-o.getPieceRadius(a))}}function Ule(e,t){if(1&e&&(_m(),db(0),ab(1,Ble,1,7,"circle",6),ab(2,Vle,1,8,"ng-template",null,7,OP),vb()),2&e){var n=ob(3),r=wb().$implicit,i=wb().$implicit,a=wb().$implicit,o=wb();Pw(1),ub("ngIf",o.isOccupied(r,i,a))("ngIfElse",n)}}function zle(e,t){if(1&e&&(_m(),lb(0,"g"),ab(1,Ule,4,2,"ng-container",5),hb()),2&e){var n=t.$implicit,r=wb().$implicit,i=wb().$implicit,a=wb();Pw(1),ub("ngIf",a.isDrawable(n,r,i))}}function Hle(e,t){if(1&e&&(_m(),lb(0,"g"),ab(1,zle,2,1,"g",1),hb()),2&e){var n=wb().$implicit,r=wb();Pw(1),ub("ngForOf",r.getLevelRange(n))}}function Gle(e,t){if(1&e&&(_m(),lb(0,"g"),ab(1,Hle,2,1,"g",1),hb()),2&e){var n=t.$implicit,r=wb();Pw(1),ub("ngForOf",r.getLevelRange(n))}}function qle(e,t){if(1&e&&(_m(),fb(0,"rect",9)),2&e){var n=wb();Eb("id","highCapture_",n.highCapture.get().x,"_",n.highCapture.get().y,"_",n.highCapture.get().z,""),tb("width",2*n.getPieceRadius(n.highCapture.get().z))("height",2*n.getPieceRadius(n.highCapture.get().z))("x",n.getPieceCx(n.highCapture.get().x,n.highCapture.get().y,n.highCapture.get().z)-n.getPieceRadius(n.highCapture.get().z))("y",n.getPieceCy(n.highCapture.get().x,n.highCapture.get().y,n.highCapture.get().z)-n.getPieceRadius(n.highCapture.get().z))}}var $le=function(){return[0,1]},Wle=function(){return[0,1,2]},jle=function(){var e=function(e){Gv(n,e);var t=$v(n);function n(e){var r;return tp(this,n),(r=t.call(this,e)).lastLandingCoord=sB.empty(),r.lastStartingCoord=sB.empty(),r.lastFirstCapture=sB.empty(),r.lastSecondCapture=sB.empty(),r.highCapture=sB.empty(),r.chosenStartingCoord=sB.empty(),r.chosenLandingCoord=sB.empty(),r.chosenFirstCapture=sB.empty(),r.lastMove=sB.empty(),r.remainingPieces={0:15,1:15},r.rules=new Ile(Ole),r.availableMinimaxes=[new xle(r.rules,"PylosMinimax"),new Ale(r.rules,"PylosOrderedMinimax")],r.encoder=Ple.encoder,r.tutorial=(new Dle).tutorial,r.SPACE_SIZE=r.getPieceRadius(0),r.updateBoard(),r}return rp(n,[{key:"getLevelRange",value:function(e){switch(e){case 0:return[0,1,2,3];case 1:return[0,1,2];default:return nB.expectToBe(e,2),[0,1]}}},{key:"isDrawable",value:function(e,t,n){var r=new Sle(e,t,n);return this.state.getPieceAt(r)!==Xee.NONE||this.state.isLandable(r)}},{key:"onPieceClick",value:function(e,t,n){var r=this;return tB(regeneratorRuntime.mark(function i(){var a,o;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(!(a=r.canUserPlay("#piece_"+e+"_"+t+"_"+n)).isFailure()){i.next=3;break}return i.abrupt("return",r.cancelMove(a.getReason()));case 3:return o=new Sle(e,t,n),i.abrupt("return",r.state.getPieceAt(o)===r.state.getCurrentOpponent()?r.cancelMove(pre.CANNOT_CHOOSE_OPPONENT_PIECE()):r.chosenLandingCoord.isAbsent()?(r.chosenStartingCoord=sB.of(o),K5.SUCCESS):r.chosenFirstCapture.isAbsent()?(r.chosenFirstCapture=sB.of(o),K5.SUCCESS):r.chosenFirstCapture.equalsValue(o)?r.concludeMoveWithCapture([r.chosenFirstCapture.get()]):r.concludeMoveWithCapture([r.chosenFirstCapture.get(),o]));case 5:case"end":return i.stop()}},i)}))()}},{key:"concludeMoveWithCapture",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(r=t.chosenStartingCoord.isAbsent()?Ple.fromDrop(t.chosenLandingCoord.get(),e):Ple.fromClimb(t.chosenStartingCoord.get(),t.chosenLandingCoord.get(),e),t.tryMove(r,t.state)));case 1:case"end":return n.stop()}},n)}))()}},{key:"tryMove",value:function(e,t){var n=this;return tB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(n.cancelMove(),n.chooseMove(e,t)));case 1:case"end":return r.stop()}},r)}))()}},{key:"cancelMoveAttempt",value:function(){this.chosenStartingCoord=sB.empty(),this.chosenLandingCoord=sB.empty(),this.chosenFirstCapture=sB.empty()}},{key:"onDrop",value:function(e,t,n){var r=this;return tB(regeneratorRuntime.mark(function i(){var a,o;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(!(a=r.canUserPlay("#drop_"+e+"_"+t+"_"+n)).isFailure()){i.next=3;break}return i.abrupt("return",r.cancelMove(a.getReason()));case 3:return o=new Sle(e,t,n),i.abrupt("return",Ile.canCapture(r.state,o)?(r.chosenLandingCoord=sB.of(o),K5.SUCCESS):r.isCapturelessMoveFinished(o)?(r.chosenLandingCoord=sB.of(o),r.concludeMoveWithCapture([])):r.cancelMove(Tle.MUST_MOVE_UPWARD()));case 5:case"end":return i.stop()}},i)}))()}},{key:"isCapturelessMoveFinished",value:function(e){return!!this.chosenStartingCoord.isAbsent()||e.isUpperThan(this.chosenStartingCoord.get())}},{key:"getSquareClasses",value:function(e,t,n){var r=new Sle(e,t,n);if(this.lastMove.isPresent()){var i=this.lastMove.get();if(i.firstCapture.equalsValue(r)||i.secondCapture.equalsValue(r))return["captured"];if(r.equals(i.landingCoord)||i.startingCoord.equalsValue(r))return["moved"]}return[]}},{key:"getPieceRadius",value:function(e){return 90+5*e}},{key:"getPieceCx",value:function(e,t,n){return 100+100*n+200*e}},{key:"getPieceCy",value:function(e,t,n){return 100+100*n+200*t}},{key:"isOccupied",value:function(e,t,n){var r=new Sle(e,t,n),i=this.rules.node.gameState.getPieceAt(r).isPlayer(),a=this.chosenLandingCoord.equalsValue(r);return i||a}},{key:"getPieceClasses",value:function(e,t,n){var r=new Sle(e,t,n),i=[this.getPieceFillClass(r)];return(this.lastLandingCoord.equalsValue(r)||this.lastStartingCoord.equalsValue(r))&&i.push("highlighted"),(this.chosenStartingCoord.equalsValue(r)||this.chosenLandingCoord.equalsValue(r))&&i.push("selected"),this.chosenFirstCapture.equalsValue(r)&&i.push("pre-captured"),i}},{key:"getPieceFillClass",value:function(e){return this.chosenLandingCoord.equalsValue(e)?this.getPlayerClass(this.state.getCurrentPlayer()):this.getPlayerPieceClass(this.state.getPieceAt(e).value)}},{key:"getPlayerPieceClass",value:function(e){return this.getPlayerClass(ete.of(e))}},{key:"getPlayerSidePieces",value:function(e){for(var t=this.remainingPieces[e],n=[],r=0;r<t;r++)n.push(r);return n}},{key:"updateBoard",value:function(){this.state=this.rules.node.gameState,this.lastMove=this.rules.node.move;var e=this.state.getPiecesRepartition();this.remainingPieces={0:15-e[0],1:15-e[1]},this.highCapture=sB.empty(),this.lastMove.isPresent()?this.showLastMove():(this.lastLandingCoord=sB.empty(),this.lastStartingCoord=sB.empty(),this.lastFirstCapture=sB.empty(),this.lastSecondCapture=sB.empty(),this.chosenFirstCapture=sB.empty(),this.chosenStartingCoord=sB.empty(),this.chosenLandingCoord=sB.empty())}},{key:"showLastMove",value:function(){var e=this.lastMove.get();this.lastLandingCoord=sB.of(e.landingCoord),this.lastStartingCoord=e.startingCoord,this.lastFirstCapture=e.firstCapture,this.lastSecondCapture=e.secondCapture,this.lastFirstCapture.isPresent()&&!1===this.isDrawableCoord(this.lastFirstCapture.get())&&(this.highCapture=this.lastFirstCapture)}},{key:"isDrawableCoord",value:function(e){return this.isDrawable(e.x,e.y,e.z)}}]),n}(sre);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(sb(ore))},e.\u0275cmp=ey({type:e,selectors:[["app-pylos"]],features:[zC],decls:5,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 -4 800 1021","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["x","0","y","0","width","800","height","800",1,"base"],["class","base captured",3,"id",4,"ngIf"],[1,"base","small-stroke",3,"id","ngClass"],[4,"ngIf"],["class","base",3,"id","ngClass","click",4,"ngIf","ngIfElse"],["onlyRect",""],[1,"base",3,"id","ngClass","click"],[1,"base","captured",3,"id"]],template:function(e,t){1&e&&(_m(),lb(0,"svg",0),ab(1,Fle,2,1,"g",1),fb(2,"rect",2),ab(3,Gle,2,1,"g",1),ab(4,qle,1,7,"rect",3),hb()),2&e&&(Pw(1),ub("ngForOf",eP(3,$le)),Pw(2),ub("ngForOf",eP(4,Wle)),Pw(1),ub("ngIf",t.highCapture.isPresent()))},directives:[AT,NT,IT],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Zle=function(){function e(t){tp(this,e),this.value=t}return rp(e,[{key:"equals",value:function(e){return this===e}},{key:"toString",value:function(){return"QuartoPiece("+this.value+")"}},{key:"isRectangle",value:function(){return this.value%4<2}}],[{key:"fromInt",value:function(t){if(0<=t&&t<=15)return e.pieces[t];if(16===t)return e.NONE;throw new Error("Invalid piece ("+t+")")}}]),e}();Zle.AAAA=new Zle(0),Zle.AAAB=new Zle(1),Zle.AABA=new Zle(2),Zle.AABB=new Zle(3),Zle.ABAA=new Zle(4),Zle.ABAB=new Zle(5),Zle.ABBA=new Zle(6),Zle.ABBB=new Zle(7),Zle.BAAA=new Zle(8),Zle.BAAB=new Zle(9),Zle.BABA=new Zle(10),Zle.BABB=new Zle(11),Zle.BBAA=new Zle(12),Zle.BBAB=new Zle(13),Zle.BBBA=new Zle(14),Zle.BBBB=new Zle(15),Zle.NONE=new Zle(16),Zle.pieces=[Zle.AAAA,Zle.AAAB,Zle.AABA,Zle.AABB,Zle.ABAA,Zle.ABAB,Zle.ABBA,Zle.ABBB,Zle.BAAA,Zle.BAAB,Zle.BABA,Zle.BABB,Zle.BBAA,Zle.BBAB,Zle.BBBA,Zle.BBBB];var Yle=function(e){Gv(n,e);var t=$v(n);function n(e,r,i){var a;return tp(this,n),(a=t.call(this,e,r)).piece=i,a}return rp(n,[{key:"toString",value:function(){return"QuartoMove("+this.coord.x+", "+this.coord.y+", "+this.piece.value+")"}},{key:"equals",value:function(e){return this===e||!!e.coord.equals(this.coord)&&this.piece===e.piece}}]),n}(Ere);Yle.encoder=new(function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"maxValue",value:function(){return 496}},{key:"encodeNumber",value:function(e){return 128*e.coord.x+32*e.coord.y+e.piece.value}},{key:"decodeNumber",value:function(e){var t=e%32;e-=t;var n=(e/=32)%4;return e-=n,new Yle(e/=4,n,Zle.fromInt(t))}}]),n}(Jee));var Kle=function(e){Gv(n,e);var t=$v(n);function n(e,r,i){var a;return tp(this,n),(a=t.call(this,e,r)).pieceInHand=i,a}return rp(n,[{key:"getRemainingPieces",value:function(){var e,t=[],r=Qv(Zle.pieces);try{for(r.s();!(e=r.n()).done;){var i=e.value;n.isGivable(i,this.board,this.pieceInHand)&&t.push(i)}}catch(a){r.e(a)}finally{r.f()}return t}}],[{key:"getInitialState",value:function(){return new n(ite.createTable(4,4,Zle.NONE),0,Zle.AAAA)}},{key:"isGivable",value:function(e,t,r){return e!==r&&!1===n.isAlreadyOnBoard(e,t)}},{key:"isAlreadyOnBoard",value:function(e,t){for(var n=0;n<4;n++)for(var r=0;r<4;r++)if(t[n][r]===e)return!0;return!1}}]),n}(wre),Jle=function(){var e=rp(function e(){tp(this,e)});return e.MUST_GIVE_A_PIECE=function(){return $localize(Jo||(Jo=Rv(["You must give a piece."])))},e.PIECE_ALREADY_ON_BOARD=function(){return $localize(Qo||(Qo=Rv(["That piece is already on the board."])))},e.CANNOT_GIVE_PIECE_IN_HAND=function(){return $localize(Xo||(Xo=Rv(["You cannot give the piece that was in your hands."])))},e}(),Qle=function(){function e(t){tp(this,e),this.subCriterion=[sB.empty(),sB.empty(),sB.empty(),sB.empty()],this.subCriterion[0]=sB.of(8==(8&t.value)),this.subCriterion[1]=sB.of(4==(4&t.value)),this.subCriterion[2]=sB.of(2==(2&t.value)),this.subCriterion[3]=sB.of(1==(1&t.value))}return rp(e,[{key:"mergeWith",value:function(e){for(var t=4,n=0;n<4;n++)!1===this.subCriterion[n].equals(e.subCriterion[n])&&(this.subCriterion[n]=sB.empty()),this.subCriterion[n].isAbsent()&&t--;return t>0}},{key:"mergeWithQuartoPiece",value:function(t){var n=new e(t);return this.mergeWith(n)}},{key:"areAllAbsent",value:function(){for(var e=0;e<4;e++)if(this.subCriterion[e].isPresent())return!1;return!0}},{key:"match",value:function(e){for(var t=0;t<4;t++)if(this.subCriterion[t].equals(e.subCriterion[t]))return!0;return!1}},{key:"matchPiece",value:function(t){return this.match(new e(t))}},{key:"toString",value:function(){return"Criterion{"+this.subCriterion.map(function(e){return e.isPresent()?e.get()?"1":"0":"x"}).join(" ")+"}"}}]),e}(),Xle=function(){function e(t,n){tp(this,e),this.initialCoord=t,this.direction=n}return rp(e,[{key:"allCoords",value:function(){for(var e=[],t=0;t<4;t++)e.push(this.initialCoord.getNext(this.direction,t));return e}}]),e}(),ehe=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"isLegal",value:function(e,t){return n.isLegal(e,t).toFallible(void 0)}},{key:"applyLegalMove",value:function(e,t){var n=t.getCopiedBoard();return n[e.coord.y][e.coord.x]=t.pieceInHand,new Kle(n,t.turn+1,e.piece)}},{key:"getGameStatus",value:function(e){var t,r=e.gameState,i={score:Pre.DEFAULT,sensitiveSquares:new Hie},a=Qv(n.lines);try{for(a.s();!(t=a.n()).done;){var o=t.value;if((i=n.updateBoardStatus(o,r,i)).score===Pre.VICTORY)return n.scoreToGameStatus(i.score,r.turn)}}catch(s){a.e(s)}finally{a.f()}return n.scoreToGameStatus(i.score,r.turn)}},{key:"getVictoriousCoords",value:function(e){var t,r=Qv(n.lines);try{for(r.s();!(t=r.n()).done;){var i=t.value;if(n.isThereAVictoriousLine(i,e))return i.allCoords()}}catch(a){r.e(a)}finally{r.f()}return[]}}],[{key:"isOccupied",value:function(e){return e!==Zle.NONE}},{key:"isLegal",value:function(e,t){var r=e.coord.x,i=e.coord.y,a=e.piece,o=t.getCopiedBoard(),s=t.pieceInHand;return n.isOccupied(o[i][r])?K5.failure(pre.MUST_LAND_ON_EMPTY_SPACE()):a===Zle.NONE?15===t.turn?K5.SUCCESS:K5.failure(Jle.MUST_GIVE_A_PIECE()):Kle.isAlreadyOnBoard(a,o)?K5.failure(Jle.PIECE_ALREADY_ON_BOARD()):s===a?K5.failure(Jle.CANNOT_GIVE_PIECE_IN_HAND()):K5.SUCCESS}},{key:"updateBoardStatus",value:function(e,t,n){return n.score===Pre.PRE_VICTORY?this.isThereAVictoriousLine(e,t)?{score:Pre.VICTORY,sensitiveSquares:new Hie}:n:this.searchForVictoryOrPreVictoryInLine(e,t,n)}},{key:"isThereAVictoriousLine",value:function(e,t){for(var r=e.initialCoord,i=t.getPieceAt(r),a=new Qle(i),o=0;o<3&&!1!==n.isOccupied(i)&&!a.areAllAbsent();o++)r=r.getNext(e.direction,1),i=t.getPieceAt(r),a.mergeWithQuartoPiece(i);return!(!n.isOccupied(i)||a.areAllAbsent())}},{key:"searchForVictoryOrPreVictoryInLine",value:function(e,t,r){var i=n.getLineInfos(e,t,r);if(i.boardStatus.isPresent())return i.boardStatus.get();var a=i.commonCriterion,o=i.sensitiveCoord;if(a.isPresent()&&!1===a.get().areAllAbsent()){if(o.isAbsent())return{score:Pre.VICTORY,sensitiveSquares:new Hie};a.get().matchPiece(t.pieceInHand)&&(r.score=Pre.PRE_VICTORY);var s=o.get();r.sensitiveSquares.add(s)}return r}},{key:"getLineInfos",value:function(e,t,r){for(var i=sB.empty(),a=sB.empty(),o=e.initialCoord,s=0;s<4;s++){var u=t.getPieceAt(o);if(u===Zle.NONE){if(!i.isAbsent())return{sensitiveCoord:sB.of(o),commonCriterion:a,boardStatus:sB.of(r)};i=sB.of(o)}else a.isAbsent()?(a=sB.of(new Qle(u)),rB(n.VERBOSE,"set commonCrit to "+a.toString())):(a.get().mergeWithQuartoPiece(u),rB(n.VERBOSE,"update commonCrit: "+a.toString()));o=o.getNext(e.direction,1)}return{commonCriterion:a,sensitiveCoord:i,boardStatus:sB.empty()}}},{key:"scoreToGameStatus",value:function(e,t){var n=ete.of(t%2);return e===Pre.VICTORY?Are.getDefeat(n):16===t?Are.DRAW:Are.ONGOING}}]),n}(Rre);ehe.VERBOSE=!1,ehe.lines=[new Xle(new ire(0,0),nre.DOWN),new Xle(new ire(1,0),nre.DOWN),new Xle(new ire(2,0),nre.DOWN),new Xle(new ire(3,0),nre.DOWN),new Xle(new ire(0,0),nre.RIGHT),new Xle(new ire(0,1),nre.RIGHT),new Xle(new ire(0,2),nre.RIGHT),new Xle(new ire(0,3),nre.RIGHT),new Xle(new ire(0,0),nre.DOWN_RIGHT),new Xle(new ire(0,3),nre.UP_RIGHT)];var the=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"getListMoves",value:function(e){for(var t=[],n=e.gameState,r=n.getCopiedBoard(),i=n.getRemainingPieces(),a=n.pieceInHand,o=0;o<4;o++)for(var s=0;s<4;s++)if(r[o][s]===Zle.NONE){if(n.getCopiedBoard()[o][s]=a,15===n.turn){var u=new Yle(s,o,Zle.NONE);return t.push(u),t}var c,l=Qv(i);try{for(l.s();!(c=l.n()).done;){var h=c.value,f=new Yle(s,o,h);t.push(f)}}catch(d){l.e(d)}finally{l.f()}}return t}},{key:"getBoardValue",value:function(e){var t,r=e.gameState,i={score:Pre.DEFAULT,sensitiveSquares:new Hie},a=Qv(ehe.lines);try{for(a.s();!(t=a.n()).done;){var o=t.value;if((i=ehe.updateBoardStatus(o,r,i)).score===Pre.VICTORY)break}}catch(s){a.e(s)}finally{a.f()}return n.scoreToBoardValue(i.score,r.turn)}}],[{key:"scoreToBoardValue",value:function(e,t){if(e===Pre.DEFAULT)return new yre(0);var n=ete.of(t%2);return new yre(e===Pre.PRE_VICTORY?n.getPreVictory():n.getDefeatValue())}}]),n}(gre),nhe=Zle.AABA,rhe=Zle.AABB,ihe=Zle.ABAA,ahe=Zle.ABAB,ohe=Zle.ABBA,she=Zle.BAAA,uhe=Zle.BAAB,che=Zle.BABB,lhe=Zle.BBAA,hhe=Zle.BBAB,fhe=Zle.BBBA,dhe=Zle.BBBB,vhe=Zle.NONE,phe=rp(function e(){tp(this,e),this.tutorial=[Lre.informational($localize(es||(es=Rv(["Goal of the game"]))),$localize(ts||(ts=Rv(["Quarto is an alignment game.\n        The goal is to align four pieces that have at least one common aspect:\n        <ul>\n          <li>their color (light or dark),</li>\n          <li>their size (big or small),</li>\n          <li>their pattern (empty or dotted),</li>\n          <li>their shape (round or square).</li>\n        </ul>\n        Here, we have a board with a victory by an alignment of dark pieces."]))),new Kle([[fhe,lhe,ihe,nhe],[vhe,vhe,vhe,vhe],[vhe,vhe,vhe,vhe],[vhe,vhe,vhe,vhe]],7,Zle.ABAB)),Lre.anyMove($localize(ns||(ns=Rv(["Placement"]))),$localize(rs||(rs=Rv(["Every placement occurs in two steps: placing the piece you have in hand (in the small square) on a square of the board,\n        and picking a piece that the opponent will have to place, by clicking on one of the pieces inside the dotted square.\n        If you prefer, the order of these two steps can be reversed.\n        Keep in mind that the second click confirms the move.<br/><br/>\n        Make a move."]))),new Kle([[fhe,rhe,ohe,vhe],[vhe,vhe,vhe,vhe],[vhe,she,vhe,vhe],[vhe,vhe,vhe,vhe]],7,Zle.ABAA),new Yle(2,2,Zle.BAAB),$localize(is||(is=Rv(["Perfect!"])))),Lre.fromMove($localize(as||(as=Rv(["Situation"]))),$localize(os||(os=Rv(["We have here a tricky situation.<br/><br/>\n        Analyze the board and play your move, carefully paying attention not to let the opponent win on the next move."]))),new Kle([[dhe,fhe,hhe,vhe],[ihe,che,lhe,vhe],[ahe,she,uhe,vhe],[vhe,vhe,vhe,vhe]],7,Zle.AABA),[new Yle(3,3,Zle.AABB)],$localize(ss||(ss=Rv(["Well done!"]))),$localize(us||(us=Rv(["Failed!"]))))]});function ghe(e,t){if(1&e&&(_m(),fb(0,"rect",11)),2&e){var n=wb(2),r=n.$implicit,i=n.index,a=wb().index,o=wb();ub("ngClass",o.getPieceClasses(r.value)),tb("x",o.SPACE_SIZE*i+(o.SPACE_SIZE/2-o.getPieceSize(r.value)))("y",o.SPACE_SIZE*a+(o.SPACE_SIZE/2-o.getPieceSize(r.value)))("width",2*o.getPieceSize(r.value))("height",2*o.getPieceSize(r.value))}}function yhe(e,t){if(1&e&&(_m(),fb(0,"circle",11)),2&e){var n=wb(2),r=n.$implicit,i=n.index,a=wb().index,o=wb();ub("ngClass",o.getPieceClasses(r.value)),tb("cx",o.SPACE_SIZE*i+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*a+o.SPACE_SIZE/2)("r",o.getPieceSize(r.value))}}function mhe(e,t){if(1&e&&(_m(),fb(0,"circle")),2&e){var n=wb(2).index,r=wb().index,i=wb();tb("cx",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*r+i.SPACE_SIZE/2)("r",10)}}function khe(e,t){if(1&e&&(_m(),lb(0,"g"),ab(1,ghe,1,5,"rect",9),ab(2,yhe,1,4,"ng-template",null,10,OP),ab(4,mhe,1,3,"circle",3),hb()),2&e){var n=ob(3),r=wb().$implicit,i=wb(2);Pw(1),ub("ngIf",r.isRectangle())("ngIfElse",n),Pw(3),ub("ngIf",i.pieceHasDot(r.value))}}function _he(e,t){if(1&e){var n=pb();_m(),lb(0,"g"),lb(1,"rect",8),mb("click",function(){var e=$y(n).index,t=wb().index;return wb().chooseCoord(e,t)}),hb(),ab(2,khe,5,3,"g",3),hb()}if(2&e){var r=t.$implicit,i=t.index,a=wb().index,o=wb();Pw(1),bb("id","chooseCoord_",i,"_",a,""),ub("ngClass",o.getSquareClasses(i,a)),tb("x",o.SPACE_SIZE*i)("y",o.SPACE_SIZE*a)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),Pw(1),ub("ngIf",r!==o.EMPTY)}}function whe(e,t){if(1&e&&(_m(),lb(0,"g",null,7),ab(2,_he,3,8,"g",2),hb()),2&e){var n=t.$implicit;Pw(2),ub("ngForOf",n)}}function Che(e,t){if(1&e&&(_m(),fb(0,"rect",15)),2&e){var n=wb(2);ub("ngClass",n.getPieceClasses(n.pieceInHand.value)),tb("x",n.SPACE_SIZE/2-n.getPieceSize(n.pieceInHand.value))("y",n.SPACE_SIZE/2-n.getPieceSize(n.pieceInHand.value))("width",2*n.getPieceSize(n.pieceInHand.value))("height",2*n.getPieceSize(n.pieceInHand.value))}}function bhe(e,t){if(1&e&&(_m(),fb(0,"circle",11)),2&e){var n=wb(2);ub("ngClass",n.getPieceClasses(n.pieceInHand.value)),tb("cx",n.SPACE_SIZE/2)("cy",n.SPACE_SIZE/2)("r",n.getPieceSize(n.pieceInHand.value))}}function Ehe(e,t){if(1&e&&(_m(),fb(0,"circle")),2&e){var n=wb(2);tb("cx",n.SPACE_SIZE/2)("cy",n.SPACE_SIZE/2)("r",10)}}function She(e,t){if(1&e&&(_m(),lb(0,"g",null,12),fb(2,"rect",13),ab(3,Che,1,5,"rect",14),ab(4,bhe,1,4,"ng-template",null,10,OP),ab(6,Ehe,1,3,"circle",3),hb()),2&e){var n=ob(5),r=wb();tb("transform","translate("+r.chosen.get().x*r.SPACE_SIZE+" "+r.chosen.get().y*r.SPACE_SIZE+")"),Pw(2),tb("width",r.SPACE_SIZE)("height",r.SPACE_SIZE),Pw(1),ub("ngIf",r.pieceInHand.isRectangle())("ngIfElse",n),Pw(3),ub("ngIf",r.pieceHasDot(r.pieceInHand.value))}}function Phe(e,t){if(1&e&&(_m(),lb(0,"g",null,16),fb(2,"rect",17),hb()),2&e){var n=t.$implicit,r=wb();Pw(2),tb("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)("transform","translate("+n.x*r.SPACE_SIZE+" "+n.y*r.SPACE_SIZE+")")}}function Ohe(e,t){if(1&e&&(_m(),fb(0,"rect",11)),2&e){var n=wb(2);ub("ngClass",n.getPieceClasses(n.pieceInHand.value)),tb("x",0)("y",.75*n.SPACE_SIZE)("transform","translate("+-n.getPieceSize(n.pieceInHand.value)+", "+-n.getPieceSize(n.pieceInHand.value)+")")("width",2*n.getPieceSize(n.pieceInHand.value))("height",2*n.getPieceSize(n.pieceInHand.value))}}function The(e,t){if(1&e&&(_m(),fb(0,"circle",19)),2&e){var n=wb(2);ub("ngClass",n.getPieceClasses(n.pieceInHand.value)),tb("cy",.75*n.SPACE_SIZE)("r",n.getPieceSize(n.pieceInHand.value))}}function Ihe(e,t){1&e&&(_m(),fb(0,"circle",20)),2&e&&tb("cy",.75*wb(2).SPACE_SIZE)("r",10)}function xhe(e,t){if(1&e&&(_m(),lb(0,"g"),ab(1,Ohe,1,6,"rect",9),ab(2,The,1,3,"ng-template",null,10,OP),ab(4,Ihe,1,2,"circle",18),hb()),2&e){var n=ob(3),r=wb();Pw(1),ub("ngIf",r.pieceInHand.isRectangle())("ngIfElse",n),Pw(3),ub("ngIf",r.pieceHasDot(r.pieceInHand.value))}}function Ahe(e,t){if(1&e&&(_m(),fb(0,"rect",27)),2&e){var n=wb(2).index,r=wb().index,i=wb();tb("x",i.SPACE_SIZE*n)("y",i.SPACE_SIZE*r)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)}}function Rhe(e,t){if(1&e&&(_m(),fb(0,"rect",11)),2&e){var n=wb(2).index,r=wb().index,i=wb();ub("ngClass",i.getPieceClasses(4*r+n)),tb("x",i.SPACE_SIZE*n+i.SPACE_SIZE/2-i.getPieceSize(4*r+n))("y",i.SPACE_SIZE*r+i.SPACE_SIZE/2-i.getPieceSize(4*r+n))("width",2*i.getPieceSize(4*r+n))("height",2*i.getPieceSize(4*r+n))}}function Nhe(e,t){if(1&e&&(_m(),fb(0,"circle",11)),2&e){var n=wb(2).index,r=wb().index,i=wb();ub("ngClass",i.getPieceClasses(4*r+n)),tb("cx",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*r+i.SPACE_SIZE/2)("r",i.getPieceSize(4*r+n))}}function Mhe(e,t){if(1&e&&(_m(),fb(0,"circle")),2&e){var n=wb(2).index,r=wb().index,i=wb();tb("cx",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*r+i.SPACE_SIZE/2)("r",10)}}function Dhe(e,t){if(1&e){var n=pb();_m(),lb(0,"g",25),mb("click",function(){$y(n);var e=wb().index,t=wb().index;return wb().choosePiece(4*t+e)}),ab(1,Ahe,1,4,"rect",26),ab(2,Rhe,1,5,"rect",9),ab(3,Nhe,1,4,"ng-template",null,10,OP),ab(5,Mhe,1,3,"circle",3),hb()}if(2&e){var r=ob(4),i=wb().index,a=wb().index,o=wb();Cb("id","choosePiece_",4*a+i,""),Pw(1),ub("ngIf",o.pieceToGive.value===4*a+i),Pw(1),ub("ngIf",(4*a+i)%4<2)("ngIfElse",r),Pw(3),ub("ngIf",o.pieceHasDot(4*a+i))}}function Lhe(e,t){if(1&e&&(_m(),lb(0,"g"),ab(1,Dhe,6,5,"g",24),hb()),2&e){var n=t.index,r=wb().index,i=wb();Pw(1),ub("ngIf",i.isRemaining(4*r+n))}}function Fhe(e,t){if(1&e&&(_m(),lb(0,"g",null,21),fb(2,"rect",22,23),ab(4,Lhe,2,1,"g",2),hb()),2&e){var n=t.$implicit,r=wb();tb("transform","translate(0 "+6.5*r.SPACE_SIZE+")"),Pw(2),tb("x",-.125*r.SPACE_SIZE)("y",-.125*r.SPACE_SIZE)("width",4.25*r.SPACE_SIZE)("height",4.25*r.SPACE_SIZE),Pw(2),ub("ngForOf",n)}}var Bhe=function(){var e=function(e){Gv(n,e);var t=$v(n);function n(e){var r;return tp(this,n),(r=t.call(this,e)).EMPTY=Zle.NONE,r.chosen=sB.empty(),r.lastMove=sB.empty(),r.pieceInHand=Zle.NONE,r.pieceToGive=Zle.NONE,r.victoriousCoords=[],r.rules=new ehe(Kle),r.availableMinimaxes=[new the(r.rules,"QuartoMinimax")],r.encoder=Yle.encoder,r.tutorial=(new phe).tutorial,r.pieceInHand=r.rules.node.gameState.pieceInHand,r.updateBoard(),r}return rp(n,[{key:"updateBoard",value:function(){var e=this.rules.node.gameState,t=this.rules.node.move;this.board=e.getCopiedBoard(),this.chosen=sB.empty(),this.pieceInHand=e.pieceInHand,this.victoriousCoords=this.rules.getVictoriousCoords(e),this.lastMove=t.map(function(e){return e.coord})}},{key:"chooseCoord",value:function(e,t){var n=this;return tB(regeneratorRuntime.mark(function r(){var i,a,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#chooseCoord_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:if(n.hideLastMove(),n.board[t][e]!==Zle.NONE){r.next=11;break}if(n.showPieceInHandOnBoard(e,t),15!==n.rules.node.gameState.turn){r.next=7;break}return a=new Yle(e,t,Zle.NONE),r.abrupt("return",n.chooseMove(a,n.rules.node.gameState));case 7:if(n.pieceToGive!==Zle.NONE){r.next=9;break}return r.abrupt("return",K5.SUCCESS);case 9:return o=new Yle(e,t,n.pieceToGive),r.abrupt("return",n.chooseMove(o,n.rules.node.gameState));case 11:return r.abrupt("return",n.cancelMove(pre.MUST_CLICK_ON_EMPTY_SPACE()));case 12:case"end":return r.stop()}},r)}))()}},{key:"choosePiece",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#choosePiece_"+e)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:if(t.hideLastMove(),t.pieceToGive=Zle.fromInt(e),!t.chosen.isAbsent()){n.next=5;break}return n.abrupt("return",K5.SUCCESS);case 5:return i=t.chosen.get(),a=new Yle(i.x,i.y,t.pieceToGive),n.abrupt("return",t.chooseMove(a,t.rules.node.gameState));case 7:case"end":return n.stop()}},n)}))()}},{key:"hideLastMove",value:function(){this.lastMove=sB.empty()}},{key:"cancelMoveAttempt",value:function(){this.hideLastMove(),this.pieceToGive=Zle.NONE}},{key:"showPieceInHandOnBoard",value:function(e,t){this.chosen=sB.of(new ire(e,t))}},{key:"isRemaining",value:function(e){return Kle.isGivable(Zle.fromInt(e),this.board,this.pieceInHand)}},{key:"getSquareClasses",value:function(e,t){var n=new ire(e,t);return this.lastMove.equalsValue(n)?["moved"]:[]}},{key:"getPieceClasses",value:function(e){var t=[];return t.push(e%2==0?"player0":"player1"),t}},{key:"getPieceSize",value:function(e){return e<8?40:25}},{key:"pieceHasDot",value:function(e){return e!==Zle.NONE.value&&e%8<4}}]),n}(yie);return e.\u0275fac=function(t){return new(t||e)(sb(ore))},e.\u0275cmp=ey({type:e,selectors:[["app-quarto"]],features:[zC],decls:11,vars:10,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],["transform","translate(5 5)"],[4,"ngFor","ngForOf"],[4,"ngIf"],["pieceInHandDiv",""],["x","0","y","0",1,"base","no-fill"],["rectangleInWhichThePieceInHandIsWaiting",""],["boardDiv",""],[1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass",4,"ngIf","ngIfElse"],["circle",""],[1,"base",3,"ngClass"],["chosenPiece",""],["id","highlight","x","0","y","0",1,"base","highlighted","mid-stroke"],["x","0","y","0","class","base",3,"ngClass",4,"ngIf","ngIfElse"],["x","0","y","0",1,"base",3,"ngClass"],["victoriousCoordsDiv",""],["id","victory","x","0","y","0",1,"base","no-fill","victory-stroke"],["cx","0",4,"ngIf"],["cx","0",1,"base",3,"ngClass"],["cx","0"],["remainingPiece",""],["stroke-dasharray","10, 10",1,"base","no-fill"],["rectangleInWhichTheRemainingPiecesAre",""],[3,"id","click",4,"ngIf"],[3,"id","click"],["class","base highlighted",4,"ngIf"],[1,"base","highlighted"]],template:function(e,t){1&e&&(_m(),lb(0,"svg",0),lb(1,"g",1),ab(2,whe,3,1,"g",2),ab(3,She,7,6,"g",3),ab(4,Phe,3,3,"g",2),lb(5,"g",null,4),fb(7,"rect",5,6),ab(9,xhe,5,3,"g",3),hb(),ab(10,Fhe,5,6,"g",2),hb(),hb()),2&e&&(tb("viewBox","0 0 "+4.25*t.SPACE_SIZE+" "+10.75*t.SPACE_SIZE),Pw(2),ub("ngForOf",t.board),Pw(1),ub("ngIf",t.chosen.isPresent()),Pw(1),ub("ngForOf",t.victoriousCoords),Pw(1),tb("transform","translate("+2*t.SPACE_SIZE+", "+4.5*t.SPACE_SIZE+")"),Pw(2),tb("width",1.5*t.SPACE_SIZE)("height",1.5*t.SPACE_SIZE)("transform","translate("+-.75*t.SPACE_SIZE+", 0)"),Pw(2),ub("ngIf",t.chosen.isAbsent()),Pw(1),ub("ngForOf",t.board))},directives:[AT,NT,IT],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Vhe=function(){var e=rp(function e(){tp(this,e)});return e.NO_INSIDE_CLICK=function(){return $localize(cs||(cs=Rv(["You must pick a space from the edge of the board."])))},e}(),Uhe=function(e){Gv(n,e);var t=$v(n);function n(e,r,i){var a;tp(this,n),(a=t.call(this,e,r)).direction=i;var o=n.isValidCoord(a.coord);if(o.isFailure())throw new Error(o.getReason());if(0===e&&i===rre.LEFT)throw new Error("Invalid direction: pawn on the left side can't be moved to the left.");if(4===e&&i===rre.RIGHT)throw new Error("Invalid direction: pawn on the right side can't be moved to the right.");if(0===r&&i===rre.UP)throw new Error("Invalid direction: pawn on the top side can't be moved up.");if(4===r&&i===rre.DOWN)throw new Error("Invalid direction: pawn on the bottom side can't be moved down.");return a}return rp(n,[{key:"toString",value:function(){return"QuixoMove("+this.coord.x+", "+this.coord.y+", "+this.direction.toString()+")"}},{key:"equals",value:function(e){return e===this||!!e.coord.equals(this.coord)&&e.direction===this.direction}}],[{key:"isValidCoord",value:function(e){return e.isNotInRange(5,5)?K5.failure("Invalid coord for QuixoMove: "+e.toString()+" is outside the board."):0!==e.x&&4!==e.x&&0!==e.y&&4!==e.y?K5.failure(Vhe.NO_INSIDE_CLICK()):K5.SUCCESS}}]),n}(Ere);Uhe.encoder=new(function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"maxValue",value:function(){return 128}},{key:"encodeNumber",value:function(e){var t=e.direction.toInt();return 20*e.coord.x+4*e.coord.y+t}},{key:"decodeNumber",value:function(e){var t=rre.factory.fromInt(e%4).get();e-=e%4;var n=(e/=4)%5;return e-=e%5,new Uhe(e/=5,n,t)}}]),n}(Jee));var zhe=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"applyLegalMove",value:function(e){for(var t=this.getCopiedBoard(),r=this.turn+1,i=e.coord,a=e.coord.getNext(e.direction);a.isInRange(5,5);)t[i.y][i.x]=t[a.y][a.x],i=i.getNext(e.direction),a=a.getNext(e.direction);return t[i.y][i.x]=this.getCurrentPlayer(),new n(t,r)}}],[{key:"getInitialState",value:function(){return new n(ite.createTable(5,5,Xee.NONE),0)}}]),n}(wre),Hhe=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"applyLegalMove",value:function(e,t,r){return n.applyLegalMove(e,t,r)}},{key:"isLegal",value:function(e,t){return t.getPieceAt(e.coord)===t.getCurrentOpponent()?j5.failure(pre.CANNOT_CHOOSE_OPPONENT_PIECE()):j5.success(void 0)}},{key:"getGameStatus",value:function(e){var t=e.gameState,r=n.getLinesSums(t),i=n.getFullestLine(r[ete.ZERO.value]),a=n.getFullestLine(r[ete.ONE.value]),o=t.getCurrentPlayer();return 5===i&&(o===ete.ZERO||a<5)?Are.ZERO_WON:5===a?Are.ONE_WON:Are.ONGOING}}],[{key:"getVerticalCoords",value:function(e){for(var t=e.gameState.getCurrentOpponent(),n=[],r=0;r<5;r++)e.gameState.getPieceAtXY(0,r)!==t&&n.push(new ire(0,r)),e.gameState.getPieceAtXY(4,r)!==t&&n.push(new ire(4,r));return n}},{key:"getHorizontalCenterCoords",value:function(e){for(var t=e.gameState.getCurrentOpponent(),n=[],r=1;r<4;r++)e.gameState.getPieceAtXY(r,0)!==t&&n.push(new ire(r,0)),e.gameState.getPieceAtXY(r,4)!==t&&n.push(new ire(r,4));return n}},{key:"getPossibleDirections",value:function(e){var t=[];return 0!==e.x&&t.push(rre.LEFT),0!==e.y&&t.push(rre.UP),4!==e.x&&t.push(rre.RIGHT),4!==e.y&&t.push(rre.DOWN),t}},{key:"getLinesSums",value:function(e){var t={};t[ete.ZERO.value]={columns:[0,0,0,0,0],rows:[0,0,0,0,0],diagonals:[0,0]},t[ete.ONE.value]={columns:[0,0,0,0,0],rows:[0,0,0,0,0],diagonals:[0,0]};for(var n=0;n<5;n++)for(var r=0;r<5;r++){var i=e.getPieceAtXY(r,n);if(i.isPlayer()){var a=i.value;t[a].columns[r]=t[a].columns[r]+1,t[a].rows[n]=t[a].rows[n]+1,r===n&&(t[a].diagonals[0]=t[a].diagonals[0]+1),r+n===4&&(t[a].diagonals[1]=t[a].diagonals[1]+1)}}return t}},{key:"getVictoriousCoords",value:function(e){for(var t=n.getLinesSums(e),r=[],i=0;i<2;i++){for(var a=0;a<5;a++){if(5===t[i].columns[a])for(var o=0;o<5;o++)r.push(new ire(a,o));if(5===t[i].rows[a])for(var s=0;s<5;s++)r.push(new ire(s,a))}if(5===t[i].diagonals[0])for(var u=0;u<5;u++)r.push(new ire(u,u));if(5===t[i].diagonals[1])for(var c=0;c<5;c++)r.push(new ire(c,4-c))}return r}},{key:"getFullestLine",value:function(e){var t=e.columns.concat(e.rows.concat(e.diagonals));return Math.max.apply(Math,Kv(t))}},{key:"applyLegalMove",value:function(e,t,n){return t.applyLegalMove(e)}}]),n}(Rre),Ghe=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"getListMoves",value:function(e){var t,n=[],r=Hhe.getVerticalCoords(e),i=Qv(Hhe.getHorizontalCenterCoords(e).concat(r));try{for(i.s();!(t=i.n()).done;){var a,o=t.value,s=Qv(Hhe.getPossibleDirections(o));try{for(s.s();!(a=s.n()).done;){var u=a.value,c=new Uhe(o.x,o.y,u);n.push(c)}}catch(l){s.e(l)}finally{s.f()}}}catch(l){i.e(l)}finally{i.f()}return n}},{key:"getBoardValue",value:function(e){var t=e.gameState,n=Hhe.getLinesSums(t),r=Hhe.getFullestLine(n[ete.ZERO.value]),i=Hhe.getFullestLine(n[ete.ONE.value]),a=t.getCurrentPlayer();return new yre(5===r&&(a===ete.ZERO||i<5)?ete.ZERO.getVictoryValue():5===i?ete.ONE.getVictoryValue():i-r)}}]),n}(gre),qhe=function(){function e(){tp(this,e)}return rp(e,null,[{key:"getArrowTransform",value:function(e,t,n){var r,i,a;switch(n){case rre.UP:r=0,i=-1,a=-90;break;case rre.DOWN:r=0,i=1,a=90;break;case rre.LEFT:r=-1,i=0,a=180;break;default:nB.expectToBe(n,rre.RIGHT),r=1,i=0,a=0}return["translate(".concat(t.x*e+e/2+r*e/4," ").concat(t.y*e+e/2+i*e/4,")"),"scale(2.5)","rotate(".concat(a,")")].join(" ")}}]),e}(),$he=Xee.NONE,Whe=ete.ZERO,jhe=ete.ONE,Zhe=rp(function e(){tp(this,e),this.tutorial=[Lre.informational($localize(ls||(ls=Rv(["Goal of the game."]))),$localize(hs||(hs=Rv(["At Quixo, the goal is to align 5 of your pieces.\n        The first player plays with dark pieces, the second with light pieces.\n        The board is made of 25 spaces spread over a 5x5 square.\n        Every piece has a neutral side, a light side, and a dark side."]))),zhe.getInitialState()),Lre.fromMove($localize(fs||(fs=Rv(["What a move looks like (without animation)"]))),$localize(ds||(ds=Rv(["When it is your turn:\n        <ol>\n            <li>Click on one of your pieces or on a neutral one. You cannot choose a piece of the opponent.\n                You can only choose a piece from the edge of the board.</li>\n            <li>Pick a direction in which you want to send the piece (by clicking on the arrow).</li>\n        </ol>\n        You have to imagine that the piece you picked has been moved to the other side of the board, in the chosen direction.\n        Once on the other side, all pieces will move by one space in the opposing direction.\n        Afterwards, if the piece was neutral, it will become yours and takes your color.<br/><br/>\n        For example, take the bottom right neutral piece, and move it to the left (you're playing Light)."]))),new zhe([[$he,$he,$he,$he,$he],[$he,$he,$he,$he,$he],[$he,$he,$he,$he,$he],[$he,$he,$he,$he,$he],[Whe,Whe,Whe,Whe,$he]],1),[new Uhe(4,4,rre.LEFT)],$localize(vs||(vs=Rv(["See how the four dark pieces have been moved one space to the right.\n        The neutral piece has been move 4 pieces to the left and has become light."]))),$localize(ps||(ps=Rv(["Failed!"])))),Lre.fromMove($localize(gs||(gs=Rv(["Victory"]))),$localize(ys||(ys=Rv(["You already know everything you need in order to play, but there is one last particularity.\n        If you create a line of 5 of your pieces, you win.\n        If you create a line of 5 of your opponent's pieces, you lose.\n        If you create both, you lose too!<br/><br/>\n        You can win with this board, try it.\n        You're playing Light."]))),new zhe([[$he,jhe,$he,jhe,jhe],[$he,Whe,Whe,$he,Whe],[jhe,jhe,jhe,Whe,jhe],[Whe,$he,Whe,jhe,jhe],[jhe,Whe,$he,jhe,Whe]],31),[new Uhe(3,0,rre.DOWN)],$localize(ms||(ms=Rv(["Congratulations, you won!"]))),$localize(ks||(ks=Rv(["Failed!"]))))]});function Yhe(e,t){if(1&e){var n=pb();_m(),lb(0,"g"),lb(1,"circle",4),mb("click",function(){var e=$y(n).index,t=wb().index;return wb().onBoardClick(e,t)}),hb(),hb()}if(2&e){var r=t.index,i=wb().index,a=wb();Pw(1),bb("id","click_",r,"_",i,""),ub("ngClass",a.getPieceClasses(r,i)),tb("cx",50+100*r)("cy",50+100*i)}}function Khe(e,t){if(1&e&&(_m(),lb(0,"g"),ab(1,Yhe,2,5,"g",2),hb()),2&e){var n=t.$implicit;Pw(1),ub("ngForOf",n)}}function Jhe(e,t){if(1&e){var n=pb();_m(),lb(0,"use",6),mb("click",function(){var e=$y(n).$implicit;return wb(2).chooseDirection(e)}),hb()}if(2&e){var r=t.$implicit,i=wb(2);Cb("id","chooseDirection_",r,""),tb("transform",i.getArrowTransform(i.chosenCoord.get(),r))}}function Qhe(e,t){if(1&e&&(_m(),lb(0,"g"),ab(1,Jhe,1,2,"use",5),hb()),2&e){var n=wb();Pw(1),ub("ngForOf",n.getPossiblesDirections())}}var Xhe=function(){var e=function(e){Gv(n,e);var t=$v(n);function n(e){var r;return tp(this,n),(r=t.call(this,e)).lastMoveCoord=sB.empty(),r.chosenCoord=sB.empty(),r.victoriousCoords=[],r.rules=new Hhe(zhe),r.availableMinimaxes=[new Ghe(r.rules,"QuixoMinimax")],r.encoder=Uhe.encoder,r.tutorial=(new Zhe).tutorial,r.updateBoard(),r}return rp(n,[{key:"updateBoard",value:function(){this.state=this.rules.node.gameState,this.board=this.state.board,this.lastMoveCoord=this.rules.node.move.map(function(e){return e.coord}),this.victoriousCoords=Hhe.getVictoriousCoords(this.state)}},{key:"cancelMoveAttempt",value:function(){this.chosenCoord=sB.empty()}},{key:"getPieceClasses",value:function(e,t){var n=new ire(e,t),r=[];return r.push(this.getPlayerClass(this.board[t][e])),this.chosenCoord.equalsValue(n)?r.push("selected"):this.lastMoveCoord.equalsValue(n)&&r.push("last-move"),this.victoriousCoords.some(function(e){return e.equals(n)})&&r.push("victory-stroke"),r}},{key:"onBoardClick",value:function(e,t){var n=this.canUserPlay("#click_"+e+"_"+t);if(n.isFailure())return this.cancelMove(n.getReason());var r=new ire(e,t),i=Uhe.isValidCoord(r);return i.isFailure()?this.cancelMove(i.getReason()):this.board[t][e]===this.state.getCurrentOpponent()?this.cancelMove(pre.CANNOT_CHOOSE_OPPONENT_PIECE()):(this.chosenCoord=sB.of(r),K5.SUCCESS)}},{key:"getPossiblesDirections",value:function(){var e=[],t=this.chosenCoord.get();return 4!==t.x&&e.push("RIGHT"),0!==t.x&&e.push("LEFT"),4!==t.y&&e.push("DOWN"),0!==t.y&&e.push("UP"),e}},{key:"chooseDirection",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#chooseDirection_"+e)).isFailure()){n.next=5;break}n.t0=t.cancelMove(r.getReason()),n.next=9;break;case 5:return t.chosenDirection=rre.factory.fromString(e).get(),n.next=8,t.tryMove();case 8:n.t0=n.sent;case 9:return n.abrupt("return",n.t0);case 10:case"end":return n.stop()}},n)}))()}},{key:"tryMove",value:function(){var e=this;return tB(regeneratorRuntime.mark(function t(){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.chosenCoord.get(),r=new Uhe(n.x,n.y,e.chosenDirection),t.abrupt("return",(e.cancelMove(),e.chooseMove(r,e.rules.node.gameState)));case 2:case"end":return t.stop()}},t)}))()}},{key:"getArrowTransform",value:function(e,t){return qhe.getArrowTransform(this.SPACE_SIZE,e,rre.factory.fromString(t).get())}}]),n}(yie);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(sb(ore))},e.\u0275cmp=ey({type:e,selectors:[["app-quixo"]],features:[zC],decls:5,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 0 500 500","preserveAspectRatio","xMidYMid meet"],["id","triangle","points","0 -3.5, 10 0, 0 3.5"],[4,"ngFor","ngForOf"],[4,"ngIf"],["r","45",1,"base",3,"id","ngClass","click"],[0,"xlink","href","#triangle",3,"id","click",4,"ngFor","ngForOf"],[0,"xlink","href","#triangle",3,"id","click"]],template:function(e,t){1&e&&(_m(),lb(0,"svg",0),lb(1,"defs"),fb(2,"polygon",1),hb(),ab(3,Khe,2,1,"g",2),ab(4,Qhe,2,1,"g",3),hb()),2&e&&(Pw(3),ub("ngForOf",t.board),Pw(1),ub("ngIf",t.chosenCoord.isPresent()))},directives:[AT,NT,IT],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),efe=function(){var e=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"countScore",value:function(){for(var e=[0,0],t=0;t<n.BOARD_HEIGHT;t++)for(var r=0;r<n.BOARD_WIDTH;r++){var i=this.board[t][r];i.isPlayer()&&(e[i.value]+=1)}return e}}],[{key:"getInitialState",value:function(){var e=ite.createTable(n.BOARD_WIDTH,n.BOARD_HEIGHT,Xee.NONE);return e[3][3]=ete.ZERO,e[4][4]=ete.ZERO,e[3][4]=ete.ONE,e[4][3]=ete.ONE,new n(e,0)}},{key:"getNeighbooringPawnLike",value:function(e,t,n,r){for(var i,a=[],o=-1;o<2;o++)for(var s=-1;s<2;s++)(i=new ire(n+s,r+o)).isInRange(this.BOARD_WIDTH,this.BOARD_HEIGHT)&&e[i.y][i.x]===t&&a.push(i);return a}}]),n}(wre);return e.BOARD_WIDTH=8,e.BOARD_HEIGHT=8,e}(),tfe=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"equals",value:function(e){return e===this||e.coord.equals(this.coord)}},{key:"toString",value:function(){return"ReversiMove("+this.coord.x+", "+this.coord.y+")"}}]),n}(Ere);tfe.encoder=new(function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"maxValue",value:function(){return(efe.BOARD_HEIGHT-1)*efe.BOARD_WIDTH+(efe.BOARD_WIDTH-1)}},{key:"encodeNumber",value:function(e){return e.coord.y*efe.BOARD_WIDTH+e.coord.x}},{key:"decodeNumber",value:function(e){var t=e%efe.BOARD_WIDTH;return new tfe(t,(e-t)/efe.BOARD_WIDTH)}}]),n}(Jee)),tfe.PASS=new tfe(-1,-1),tfe.PASS_NUMBER=tfe.encoder.encodeNumber(tfe.PASS);var nfe=function(){var e=rp(function e(){tp(this,e)});return e.NO_ELEMENT_SWITCHED=function(){return $localize(_s||(_s=Rv(["Your move should switch at least one piece."])))},e}(),rfe=rp(function e(t,n){tp(this,e),this.move=t,this.switched=n}),ife=function(){var e=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"applyLegalMove",value:function(e,t,n){var r=t.turn,i=t.getCurrentPlayer(),a=t.getCopiedBoard();if(e.equals(tfe.PASS))return new efe(a,r+1);var o,s=Qv(n);try{for(s.s();!(o=s.n()).done;){var u=o.value;a[u.y][u.x]=i}}catch(c){s.e(c)}finally{s.f()}return a[e.coord.y][e.coord.x]=i,new efe(a,r+1)}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}},{key:"isLegal",value:function(e,t){if(e.equals(tfe.PASS))return n.playerCanOnlyPass(t)?j5.success([]):j5.failure(pre.MUST_PASS());if(t.getPieceAt(e.coord).isPlayer())return rB(n.VERBOSE,"ReversiRules.isLegal: you cannot play on a busy space"),j5.failure(pre.MUST_CLICK_ON_EMPTY_SPACE());var r=t.getCopiedBoard(),i=n.getAllSwitcheds(e,t.getCurrentPlayer(),r);return rB(n.VERBOSE,"ReversiRules.isLegal: "+i.length+" element(s) switched"),0===i.length?j5.failure(nfe.NO_ELEMENT_SWITCHED()):j5.success(i)}}],[{key:"getGameStatus",value:function(e){var t=e.gameState;if(!1===n.isGameEnded(t))return Are.ONGOING;var r=t.countScore(),i=r[1]-r[0];return i<0?Are.ZERO_WON:i>0?Are.ONE_WON:Are.DRAW}},{key:"getAllSwitcheds",value:function(e,t,r){var i,a=[],o=t.getOpponent(),s=Qv(nre.DIRECTIONS);try{for(s.s();!(i=s.n()).done;){var u=i.value,c=e.coord.getNext(u);if(c.isInRange(efe.BOARD_WIDTH,efe.BOARD_HEIGHT)&&r[c.y][c.x]===o){var l,h=Qv(n.getSandwicheds(t,u,c,r));try{for(h.s();!(l=h.n()).done;){var f=l.value;a.push(f)}}catch(d){h.e(d)}finally{h.f()}}}}catch(d){s.e(d)}finally{s.f()}return a}},{key:"getSandwicheds",value:function(e,t,n,r){for(var i=[n],a=n.getNext(t);a.isInRange(efe.BOARD_WIDTH,efe.BOARD_HEIGHT);){var o=r[a.y][a.x];if(o===e)return i;if(o===Xee.NONE)return[];i.push(a),a=a.getNext(t)}return[]}},{key:"isGameEnded",value:function(e){return this.playerCanOnlyPass(e)&&this.nextPlayerCantOnlyPass(e)}},{key:"playerCanOnlyPass",value:function(e){var t=this.getListMoves(e);return 1===t.length&&t[0].move.equals(tfe.PASS)}},{key:"nextPlayerCantOnlyPass",value:function(e){var t=e.getCopiedBoard(),n=new efe(t,e.turn+1);return this.playerCanOnlyPass(n)}},{key:"getListMoves",value:function(e){for(var t,r=[],i=e.getCurrentPlayer(),a=e.getCurrentOpponent(),o=0;o<8;o++)for(var s=0;s<8;s++)if(e.getPieceAtXY(s,o)===Xee.NONE&&(t=e.getCopiedBoard(),efe.getNeighbooringPawnLike(t,a,s,o).length>0)){var u=new tfe(s,o),c=n.getAllSwitcheds(u,i,t);if(c.length>0){var l,h=Qv(c);try{for(h.s();!(l=h.n()).done;){var f=l.value;X5(i!==e.getPieceAt(f),f+"was already switched!"),t[f.y][f.x]=i}}catch(d){h.e(d)}finally{h.f()}t[o][s]=i,r.push(new rfe(u,c.length))}}return 0===r.length&&r.push(new rfe(tfe.PASS,0)),r}}]),n}(Rre);return e.VERBOSE=!1,e}(),afe=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"getBoardValue",value:function(e){var t=ife.getGameStatus(e);if(t.isEndGame)return yre.fromWinner(t.winner);for(var n=e.gameState.getCopiedBoard(),r=0,i=0,a=0;a<efe.BOARD_HEIGHT;a++)for(var o=0;o<efe.BOARD_WIDTH;o++){var s=(0===o||o===efe.BOARD_WIDTH-1?4:1)*(0===a||a===efe.BOARD_HEIGHT-1?4:1);n[a][o]===ete.ZERO&&(r+=s),n[a][o]===ete.ONE&&(i+=s)}return r*=ete.ZERO.getScoreModifier(),i*=ete.ONE.getScoreModifier(),new yre(i+r)}},{key:"getListMoves",value:function(e){var t=ife.getListMoves(e.gameState);return ite.sortByDescending(t,function(e){return n.bestCoords.some(function(t){return e.move.coord.equals(t)})?100:e.switched}),t.map(function(e){return e.move})}}]),n}(gre);afe.bestCoords=[new ire(0,0),new ire(0,efe.BOARD_HEIGHT-1),new ire(efe.BOARD_WIDTH-1,0),new ire(efe.BOARD_WIDTH-1,efe.BOARD_HEIGHT-1)];var ofe=Xee.NONE,sfe=ete.ZERO,ufe=ete.ONE,cfe=rp(function e(){tp(this,e),this.tutorial=[Lre.informational($localize(ws||(ws=Rv(["Goal of the game"]))),$localize(Cs||(Cs=Rv(["At Reversi, the pieces are double sided: one dark side for the first player, one light side for the second player.\n        When one piece is flipped, its owner changes.\n        The player owning the most pieces at the end of the game wins.\n        Here, Dark has 28 points and Light has 36, hence Light wins."]))),new efe([[sfe,sfe,sfe,sfe,sfe,sfe,sfe,sfe],[sfe,ufe,ufe,ufe,ufe,ufe,ufe,sfe],[sfe,ufe,ufe,ufe,ufe,ufe,ufe,sfe],[sfe,ufe,ufe,ufe,ufe,ufe,ufe,sfe],[sfe,ufe,ufe,ufe,ufe,ufe,ufe,sfe],[sfe,ufe,ufe,ufe,ufe,ufe,ufe,sfe],[sfe,ufe,ufe,ufe,ufe,ufe,ufe,sfe],[sfe,sfe,sfe,sfe,sfe,sfe,sfe,sfe]],60)),Lre.anyMove($localize(bs||(bs=Rv(["Capture (1/2)"]))),$localize(Es||(Es=Rv(["At the beginning of the game, pieces are placed as shown here.\n        For a move to be legal, it must sandwich at least one piece of the opponent between the piece you're putting and another of your pieces.<br/><br/>\n        Do any move by clicking to put your piece\n        Dark plays first."]))),efe.getInitialState(),new tfe(2,4),$localize(Ss||(Ss=Rv(["Congratulations!"])))),Lre.fromMove($localize(Ps||(Ps=Rv(["Capture (2/2)"]))),$localize(Os||(Os=Rv(["A move can also capture a bigger line, and more than one lines at a time\n        You're playing light here.<br/><br/>\n        Play on the bottom left to see an example."]))),new efe([[ofe,ofe,ofe,ofe,ofe,ofe,ofe,ofe],[ofe,ofe,ofe,ofe,ofe,ofe,ofe,ofe],[ofe,ofe,ofe,ofe,ofe,ofe,ofe,ofe],[ofe,ofe,ofe,ofe,ufe,ofe,ofe,ofe],[ofe,ofe,ofe,sfe,ofe,ofe,ofe,ofe],[ofe,ofe,sfe,ofe,ofe,ofe,ofe,ofe],[sfe,sfe,ofe,ofe,ofe,ofe,ofe,ofe],[ofe,sfe,ufe,sfe,ufe,sfe,ofe,ofe]],1),[new tfe(0,7)],$localize(Ts||(Ts=Rv(["Congratulations!"]))),$localize(Is||(Is=Rv(["Lower and more to the left, please."])))),Lre.informational($localize(xs||(xs=Rv(["Passing a turn"]))),$localize(As||(As=Rv(["If, during its turn, a player has no move that would allow that player to flip a piece, that player must pass\n        Moreover, if the next player could not play neither, the game ends before the board is full, and points are counted in the usual way."]))),new efe([[ufe,sfe,sfe,sfe,sfe,sfe,ufe,sfe],[sfe,ufe,ufe,ufe,ufe,ufe,ufe,sfe],[sfe,ufe,ufe,ufe,ufe,ufe,ufe,sfe],[sfe,ufe,ufe,ufe,ufe,ufe,ufe,sfe],[sfe,ufe,ufe,ufe,ufe,ufe,ufe,sfe],[sfe,ufe,ufe,ufe,ufe,ufe,ufe,sfe],[ufe,ufe,ufe,ufe,ufe,ufe,ofe,ofe],[sfe,sfe,sfe,sfe,sfe,sfe,ofe,ofe]],60))]});function lfe(e,t){if(1&e&&(_m(),fb(0,"circle",4)),2&e){var n=wb().index,r=wb().index,i=wb();ub("ngClass",i.getPieceClass(n,r)),tb("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)("cx",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*r+i.SPACE_SIZE/2)}}function hfe(e,t){if(1&e){var n=pb();_m(),lb(0,"g"),lb(1,"rect",2),mb("click",function(){var e=$y(n).index,t=wb().index;return wb().onClick(e,t)}),hb(),ab(2,lfe,1,4,"circle",3),hb()}if(2&e){var r=t.index,i=wb().index,a=wb();Pw(1),bb("id","click_",r,"_",i,""),ub("ngClass",a.getRectClasses(r,i)),tb("x",a.SPACE_SIZE*r)("y",a.SPACE_SIZE*i)("width",a.SPACE_SIZE)("height",a.SPACE_SIZE),Pw(1),ub("ngIf",a.board[i][r]!==a.NONE)}}function ffe(e,t){if(1&e&&(_m(),lb(0,"g"),ab(1,hfe,3,8,"g",1),hb()),2&e){var n=t.$implicit;Pw(1),ub("ngForOf",n)}}var dfe=function(){var e=function(e){Gv(n,e);var t=$v(n);function n(e){var r;return tp(this,n),(r=t.call(this,e)).NONE=Xee.NONE,r.lastMove=new ire(-2,-2),r.captureds=[],r.scores=sB.of([2,2]),r.rules=new ife(efe),r.availableMinimaxes=[new afe(r.rules,"ReversiMinimax")],r.encoder=tfe.encoder,r.tutorial=(new cfe).tutorial,r.canPass=!1,r.updateBoard(),r}return rp(n,[{key:"onClick",value:function(e,t){var n=this;return tB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:return a=new tfe(e,t),r.next=6,n.chooseMove(a,n.rules.node.gameState,n.scores.get());case 6:return r.abrupt("return",r.sent);case 7:case"end":return r.stop()}},r)}))()}},{key:"updateBoard",value:function(){var e=this.rules.node.gameState;this.board=e.getCopiedBoard(),this.captureds=[],this.rules.node.move.isPresent()?this.showPreviousMove():this.lastMove=new ire(-2,-2),this.scores=sB.of(e.countScore()),this.canPass=ife.playerCanOnlyPass(e)}},{key:"showPreviousMove",value:function(){this.lastMove=this.rules.node.move.get().coord;var e,t=this.rules.node.gameState.getCurrentPlayer(),n=this.rules.node.gameState.getCurrentOpponent(),r=Qv(nre.DIRECTIONS);try{for(r.s();!(e=r.n()).done;)for(var i=e.value,a=this.lastMove.getNext(i,1);a.isInRange(efe.BOARD_WIDTH,efe.BOARD_HEIGHT)&&this.rules.node.gameState.getPieceAt(a)===n&&this.rules.node.mother.get().gameState.getPieceAt(a)===t;)this.captureds.push(a),a=a.getNext(i,1)}catch(o){r.e(o)}finally{r.f()}}},{key:"getRectClasses",value:function(e,t){var n=new ire(e,t);return this.captureds.some(function(e){return e.equals(n)})?["captured"]:n.equals(this.lastMove)?["moved"]:[]}},{key:"getPieceClass",value:function(e,t){return this.getPlayerClass(this.board[t][e])}},{key:"pass",value:function(){var e=this;return tB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(X5(e.canPass,"ReversiComponent: pass() can only be called if canPass is true"),e.onClick(tfe.PASS.coord.x,tfe.PASS.coord.y)));case 1:case"end":return t.stop()}},t)}))()}}]),n}(yie);return e.\u0275fac=function(t){return new(t||e)(sb(ore))},e.\u0275cmp=ey({type:e,selectors:[["app-reversi"]],features:[zC],decls:2,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass",4,"ngIf"],[1,"base",3,"ngClass"]],template:function(e,t){1&e&&(_m(),lb(0,"svg",0),ab(1,ffe,2,1,"g",1),hb()),2&e&&(tb("viewBox","0 -4 "+8*t.SPACE_SIZE+" "+(10+8*t.SPACE_SIZE)),Pw(1),ub("ngForOf",t.board))},directives:[AT,IT,NT],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),vfe=function(){var e=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,null,[{key:"getInitialState",value:function(){var e=cre.NONE,t=cre.ZERO,r=cre.ONE,i=cre.EMPTY;return new n([[e,e,t,r,i,i,i,t,r,e,e],[e,i,i,i,i,i,i,i,i,i,e],[r,i,i,i,i,i,i,i,i,i,t],[t,i,i,i,i,i,i,i,i,i,r],[e,i,i,i,i,i,i,i,i,i,e],[e,e,r,t,i,i,i,r,t,e,e]],0)}}]),n}(vae);return e.HEIGHT=6,e.WIDTH=11,e}(),pfe=function(){var e=rp(function e(){tp(this,e)});return e.CAN_ONLY_REBOUND_ON_BLACK=function(){return $localize(Rs||(Rs=Rv(["You can only rebound on dark spaces."])))},e.CAN_ONLY_REBOUND_ON_EMPTY_SPACE=function(){return $localize(Ns||(Ns=Rv(["You can only rebound on empty spaces."])))},e.MUST_CHOOSE_PYRAMID_FIRST=function(){return $localize(Ms||(Ms=Rv(["You must pick one of your pyramids first."])))},e.MUST_CHOOSE_OWN_PYRAMID=function(){return $localize(Ds||(Ds=Rv(["You must pick one of your pyramids."])))},e.THOSE_TWO_SPACES_ARE_NOT_NEIGHBORS=function(){return $localize(Ls||(Ls=Rv(["Those two spaces are not neighbors."])))},e.THOSE_TWO_SPACES_HAVE_NO_COMMON_NEIGHBOR=function(){return $localize(Fs||(Fs=Rv(["Those two spaces have no intermediary neighbor."])))},e}(),gfe=function(e){Gv(n,e);var t=$v(n);function n(e,r){return tp(this,n),t.call(this,e,r)}return rp(n,[{key:"isSimpleStep",value:function(){return Math.abs(this.coord.x-this.end.x)+Math.abs(this.coord.y-this.end.y)===1}},{key:"equals",value:function(e){return e===this||!!e.coord.equals(this.coord)&&e.end.equals(this.end)}},{key:"toString",value:function(){return"SaharaMove("+this.coord+"->"+this.end+")"}}],[{key:"checkDistanceAndLocation",value:function(e,t){var n=Math.abs(e.x-t.x)+Math.abs(e.y-t.y);if(0===n)return K5.failure(pre.MOVE_CANNOT_BE_STATIC());if(1===n){var r=dae.getFakeNeighbors(e);if(t.equals(r))return K5.failure(pfe.THOSE_TWO_SPACES_ARE_NOT_NEIGHBORS())}else{if(2!==n)return K5.failure($localize(Bs||(Bs=Rv(["You can move one or two spaces, not ","."])),n));if((e.x+e.y)%2==0)return K5.failure(pfe.CAN_ONLY_REBOUND_ON_BLACK());if(e.x===t.x)return K5.failure(pfe.THOSE_TWO_SPACES_HAVE_NO_COMMON_NEIGHBOR())}return K5.SUCCESS}},{key:"from",value:function(e,t){if(!e.isInRange(vfe.WIDTH,vfe.HEIGHT))throw new Error("Move must start inside the board not at "+e.toString()+".");if(!t.isInRange(vfe.WIDTH,vfe.HEIGHT))throw new Error("Move must end inside the board not at "+t.toString()+".");var r=n.checkDistanceAndLocation(e,t);return r.isFailure()?r.toFailedFallible():j5.success(new n(e,t))}}]),n}(Oie);gfe.encoder=new(function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"maxValue",value:function(){return 396*vfe.WIDTH+66*vfe.HEIGHT+6*vfe.WIDTH+vfe.HEIGHT}},{key:"encodeNumber",value:function(e){return 396*e.coord.x+66*e.coord.y+6*e.end.x+e.end.y}},{key:"decodeNumber",value:function(e){var t=e%6;e-=t;var n=(e/=6)%11;e-=n;var r=(e/=11)%6;return e-=r,gfe.from(new ire(e/=6,r),new ire(n,t)).get()}}]),n}(Jee));var yfe=function(){var e=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"applyLegalMove",value:function(e,t,r){rB(n.VERBOSE,"Legal move "+e.toString()+" applied");var i=t.getCopiedBoard();return i[e.end.y][e.end.x]=i[e.coord.y][e.coord.x],i[e.coord.y][e.coord.x]=cre.EMPTY,new vfe(i,t.turn+1)}},{key:"isLegal",value:function(e,t){if(t.getPieceAt(e.coord).value!==t.getCurrentPlayer().value)return j5.failure(pre.CANNOT_CHOOSE_OPPONENT_PIECE());if(t.getPieceAt(e.end)!==cre.EMPTY)return j5.failure(pre.MUST_LAND_ON_EMPTY_SPACE());var n=dae.getCommonNeighbor(e.coord,e.end);return n.isPresent()?t.getPieceAt(n.get())===cre.EMPTY?j5.success(void 0):j5.failure(pfe.CAN_ONLY_REBOUND_ON_EMPTY_SPACE()):j5.success(void 0)}},{key:"getGameStatus",value:function(e){var t=e.gameState.getCopiedBoard(),r=n.getBoardValuesFor(t,ete.ZERO),i=n.getBoardValuesFor(t,ete.ONE);return n.getGameStatusFromFreedoms(r,i)}}],[{key:"getStartingCoords",value:function(e,t){for(var n=[],r=0;r<vfe.HEIGHT;r++)for(var i=0;i<vfe.WIDTH;i++)e[r][i].is(t)&&n.push(new ire(i,r));return n}},{key:"getBoardValuesFor",value:function(e,t){var r,i=[],a=Qv(n.getStartingCoords(e,t));try{for(a.s();!(r=a.n()).done;){var o=r.value,s=vae.getEmptyNeighbors(e,o,cre.EMPTY).length;if(0===s)return[0];i.push(s)}}catch(u){a.e(u)}finally{a.f()}return i.sort(function(e,t){return e-t})}},{key:"getGameStatusFromFreedoms",value:function(e,t){return 0===e[0]?Are.ONE_WON:0===t[0]?Are.ZERO_WON:Are.ONGOING}}]),n}(Rre);return e.VERBOSE=!1,e}(),mfe=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"getListMoves",value:function(e){var t,n=[],r=e.gameState.getCopiedBoard(),i=e.gameState.getCurrentPlayer(),a=Qv(yfe.getStartingCoords(r,i));try{for(a.s();!(t=a.n()).done;){var o,s=t.value,u=Qv(vae.getEmptyNeighbors(r,s,cre.EMPTY));try{for(u.s();!(o=u.n()).done;){var c=o.value,l=gfe.from(s,c).get();if(r[c.y][c.x]=r[s.y][s.x],r[s.y][s.x]=cre.EMPTY,n.push(l),(c.y+c.x)%2==0){var h,f=Qv(vae.getEmptyNeighbors(r,c,cre.EMPTY));try{for(f.s();!(h=f.n()).done;){var d=h.value;if(!d.equals(s)){var v=gfe.from(s,d).get();r[d.y][d.x]=r[c.y][c.x],r[c.y][c.x]=cre.EMPTY,n.push(v),r[c.y][c.x]=r[d.y][d.x],r[d.y][d.x]=cre.EMPTY}}}catch(p){f.e(p)}finally{f.f()}}r[s.y][s.x]=r[c.y][c.x],r[c.y][c.x]=cre.EMPTY}}catch(p){u.e(p)}finally{u.f()}}}catch(p){a.e(p)}finally{a.f()}return n}},{key:"getBoardValue",value:function(e){var t=e.gameState.getCopiedBoard(),n=yfe.getBoardValuesFor(t,ete.ZERO),r=yfe.getBoardValuesFor(t,ete.ONE),i=yfe.getGameStatusFromFreedoms(n,r);if(i.isEndGame)return yre.fromWinner(i.winner);for(var a=0;a<6&&n[a]===r[a];)a++;return new yre(r[a%6]-n[a%6])}}]),n}(gre),kfe=cre.NONE,_fe=cre.ZERO,wfe=cre.ONE,Cfe=cre.EMPTY,bfe=rp(function e(){tp(this,e),this.tutorial=[Lre.informational($localize(Vs||(Vs=Rv(["Initial board"]))),$localize(Us||(Us=Rv(["S\xe2h\xe2r\xe2 is played on a board where each space is a triangle.\n        Each player has six pyramids."]))),vfe.getInitialState()),Lre.informational($localize(zs||(zs=Rv(["Goal of the game"]))),$localize(Hs||(Hs=Rv(["At S\xe2h\xe2r\xe2, the goal of the game is to immobilize one of the opponent's pyramids.\n        To do so, you have to occupy all neighboring space of that pyramid.\n        Here, Light has lost because its leftmost pyramid is immobilized."]))),new vfe([[kfe,kfe,Cfe,Cfe,wfe,Cfe,Cfe,_fe,wfe,kfe,kfe],[kfe,Cfe,Cfe,Cfe,Cfe,Cfe,Cfe,Cfe,Cfe,Cfe,kfe],[wfe,_fe,Cfe,Cfe,Cfe,Cfe,Cfe,Cfe,Cfe,Cfe,_fe],[_fe,Cfe,Cfe,Cfe,Cfe,Cfe,Cfe,Cfe,Cfe,Cfe,wfe],[kfe,Cfe,Cfe,Cfe,Cfe,Cfe,Cfe,Cfe,Cfe,Cfe,kfe],[kfe,kfe,wfe,_fe,Cfe,Cfe,Cfe,wfe,_fe,kfe,kfe]],3)),Lre.fromPredicate($localize(Gs||(Gs=Rv(["Simple step"]))),$localize(qs||(qs=Rv(["To immobilize your opponent, you have to move your pyramids.\n        When a pyramid shares its vertices with light spaces, it can move on these spaces (we call this a simple step).\n        You're the first player, playing with the dark pyramids.\n        <ol>\n            <li>Click on one of your pyramids.</li>\n            <li>Click on one of its two or three neighboring spaces in order to move your pyramid there.</li>\n        </ol><br/>\n        Do any simple step."]))),vfe.getInitialState(),gfe.from(new ire(2,0),new ire(2,1)).get(),function(e,t){return e.isSimpleStep()?K5.SUCCESS:K5.failure($localize($s||($s=Rv(["You have made a double step, which is good but it is the next exercise!"]))))},$localize(Ws||(Ws=Rv(["Congratulations!"])))),Lre.fromPredicate($localize(js||(js=Rv(["Double step"]))),$localize(Zs||(Zs=Rv(["When a pyramid shares its vertices with dark spaces, it can move one or two steps.\n        To do so:\n        <ol>\n            <li>Click on the pyramid to move.</li>\n            <li>Click on one of the 6 destinations that you can reach in two steps:\n                 the 6 neighboring light spaces of the 3 dark spaces that are neighbors of your pyramid.\n        </ol>"]))),vfe.getInitialState(),gfe.from(new ire(7,0),new ire(5,0)).get(),function(e,t){return e.isSimpleStep()?K5.failure($localize(Ys||(Ys=Rv(["Failed! You have made a single step."])))):K5.SUCCESS},$localize(Ks||(Ks=Rv(["Congratulations!"]))))]});function Efe(e,t){if(1&e&&(_m(),lb(0,"g"),fb(1,"polyline",6),hb()),2&e){var n=wb().index,r=wb().index,i=wb();Pw(1),ub("ngClass",i.getPlayerClassFor(n,r)),tb("points",i.getPyramidCoordinate(n,r))}}function Sfe(e,t){if(1&e&&(_m(),fb(0,"polyline",9)),2&e){var n=wb(2).index,r=wb().index;tb("points",wb().getTriangleCoordinate(n,r))}}function Pfe(e,t){if(1&e&&(_m(),fb(0,"polyline",10)),2&e){var n=wb(2).index,r=wb().index;tb("points",wb().getTriangleCoordinate(n,r))}}function Ofe(e,t){if(1&e&&(_m(),lb(0,"g"),ab(1,Sfe,1,1,"polyline",7),ab(2,Pfe,1,1,"polyline",8),hb()),2&e){var n=wb().index,r=wb().index;Pw(1),ub("ngIf",(n+r)%2==1),Pw(1),ub("ngIf",(n+r)%2==0)}}function Tfe(e,t){if(1&e){var n=pb();_m(),lb(0,"g",5),mb("click",function(){var e=$y(n).index,t=wb().index;return wb().onClick(e,t)}),ab(1,Efe,2,2,"g",2),ab(2,Ofe,3,2,"g",2),hb()}if(2&e){var r=t.$implicit;bb("id","click_",t.index,"_",wb().index,""),Pw(1),ub("ngIf",r.isPlayer()),Pw(1),ub("ngIf",2===r.value)}}function Ife(e,t){if(1&e&&(_m(),lb(0,"g"),ab(1,Tfe,3,4,"g",4),hb()),2&e){var n=t.$implicit;Pw(1),ub("ngForOf",n)}}function xfe(e,t){if(1&e&&(_m(),db(0),fb(1,"polyline",11),fb(2,"polyline",11),vb()),2&e){var n=wb();Pw(1),tb("points",n.getTriangleCoordinate(n.lastCoord.get().x,n.lastCoord.get().y)),Pw(1),tb("points",n.getTriangleCoordinate(n.lastMoved.get().x,n.lastMoved.get().y))}}function Afe(e,t){if(1&e&&(_m(),fb(0,"polyline",12)),2&e){var n=wb();tb("points",n.getTriangleCoordinate(n.chosenCoord.get().x,n.chosenCoord.get().y))}}var Rfe=function(){var e=function(e){Gv(n,e);var t=$v(n);function n(e){var r;return tp(this,n),(r=t.call(this,e)).lastCoord=sB.empty(),r.lastMoved=sB.empty(),r.chosenCoord=sB.empty(),r.rules=new yfe(vfe),r.availableMinimaxes=[new mfe(r.rules,"SaharaMinimax")],r.encoder=gfe.encoder,r.tutorial=(new bfe).tutorial,r.updateBoard(),r}return rp(n,[{key:"cancelMoveAttempt",value:function(){this.chosenCoord=sB.empty()}},{key:"onClick",value:function(e,t){var n=this;return tB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=n.canUserPlay("#click_"+e+"_"+t),r.abrupt("return",i.isFailure()?n.cancelMove(i.getReason()):n.chosenCoord.isAbsent()?n.choosePiece(e,t):n.chooseLandingCoord(e,t));case 2:case"end":return r.stop()}},r)}))()}},{key:"choosePiece",value:function(e,t){return this.board[t][e]===cre.EMPTY?this.cancelMove(pfe.MUST_CHOOSE_PYRAMID_FIRST()):this.board[t][e].value===this.getTurn()%2?(this.chosenCoord=sB.of(new ire(e,t)),K5.SUCCESS):this.cancelMove(pfe.MUST_CHOOSE_OWN_PYRAMID())}},{key:"chooseLandingCoord",value:function(e,t){var n=this;return tB(regeneratorRuntime.mark(function r(){var i,a,o,s;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=new ire(e,t),a=n.rules.node.gameState.getCurrentPlayer(),o=cre.ofPlayer(a),n.board[t][e]!==o){r.next=3;break}return r.abrupt("return",(n.chosenCoord=sB.of(new ire(e,t)),K5.SUCCESS));case 3:if(!(s=gfe.from(n.chosenCoord.get(),i)).isFailure()){r.next=8;break}r.t0=n.cancelMove(s.getReason()),r.next=11;break;case 8:return r.next=10,n.chooseMove(s.get(),n.rules.node.gameState);case 10:r.t0=r.sent;case 11:return r.abrupt("return",r.t0);case 12:case"end":return r.stop()}},r)}))()}},{key:"updateBoard",value:function(){this.chosenCoord=sB.empty();var e=this.rules.node.move;this.lastCoord=e.map(function(e){return e.coord}),this.lastMoved=e.map(function(e){return e.end}),this.board=this.rules.node.gameState.board}},{key:"getPlayerClassFor",value:function(e,t){return this.getPlayerClass(ete.of(this.board[t][e].value))}}]),n}(cae);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(sb(ore))},e.\u0275cmp=ey({type:e,selectors:[["app-sahara"]],features:[zC],decls:4,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-4 -4 300 308","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf"],["class","base no-fill small-stroke selected",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base","small-stroke",3,"ngClass"],["class","base small-stroke",4,"ngIf"],["class","base small-stroke background2",4,"ngIf"],[1,"base","small-stroke"],[1,"base","small-stroke","background2"],[1,"base","no-fill","small-stroke","highlighted"],[1,"base","no-fill","small-stroke","selected"]],template:function(e,t){1&e&&(_m(),lb(0,"svg",0),ab(1,Ife,2,1,"g",1),ab(2,xfe,3,2,"ng-container",2),ab(3,Afe,1,1,"polyline",3),hb()),2&e&&(Pw(1),ub("ngForOf",t.board),Pw(1),ub("ngIf",t.lastMoved.isPresent()),Pw(1),ub("ngIf",t.chosenCoord.isPresent()))},directives:[AT,NT,IT],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Nfe=function(e){Gv(n,e);var t=$v(n);function n(e,r,i,a){var o;return tp(this,n),(o=t.call(this,e,r)).x=e,o.y=r,o.moveDirection=i,o.landingOrientation=a,o.checkValidity(),o}return rp(n,[{key:"checkValidity",value:function(){var e=this.coord.isInRange(5,5);if(this.isRotation()){if(!e)throw new Error("Cannot rotate piece outside the board: "+this.toString()+".")}else if(this.coord.getNext(this.moveDirection.get()).isNotInRange(5,5)){if(!e)throw new Error("SiamMove should end or start on the board: "+this.toString()+".");if(this.moveDirection.get()!==this.landingOrientation)throw new Error("SiamMove should have moveDirection and landingOrientation matching when a piece goes out of the board: "+this.toString()+".")}}},{key:"isRotation",value:function(){return this.moveDirection.isAbsent()}},{key:"equals",value:function(e){return this===e||!(!this.coord.equals(e.coord)||!1===this.moveDirection.equals(e.moveDirection))&&this.landingOrientation===e.landingOrientation}},{key:"toString",value:function(){var e=this.moveDirection.isAbsent()?"-":this.moveDirection.get().toString();return"SiamMove("+this.coord.x+", "+this.coord.y+", "+e+", "+this.landingOrientation+")"}},{key:"isInsertion",value:function(){return-1===this.coord.x||5===this.coord.x||-1===this.coord.y||5===this.coord.y}}]),n}(Ere);Nfe.encoder=new(function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"maxValue",value:function(){return 2408}},{key:"encodeNumber",value:function(e){var t=e.coord.y+1,n=e.coord.x+1,r=e.moveDirection.isAbsent()?4:e.moveDirection.get().toInt();return 245*e.landingOrientation.toInt()+49*r+7*n+t}},{key:"decodeNumber",value:function(e){var t=e%7;e-=t;var n=(e/=7)%7;e-=n;var r=(e/=7)%5,i=4===r?sB.empty():rre.factory.fromInt(r).toOptional();e-=r;var a=rre.factory.fromInt(e/=5).get();return new Nfe(n-1,t-1,i,a)}}]),n}(Jee));var Mfe=function(){function e(t){tp(this,e),this.value=t}return rp(e,[{key:"belongTo",value:function(e){return e===ete.ZERO?1<=this.value&&this.value<=4:5<=this.value&&this.value<=8}},{key:"isEmptyOrMountain",value:function(){return 0===this.value||9===this.value}},{key:"isPiece",value:function(){return!this.isEmptyOrMountain()}},{key:"getOwner",value:function(){return 1<=this.value&&this.value<=4?ete.ZERO:5<=this.value&&this.value<=8?ete.ONE:Xee.NONE}},{key:"getOptionalDirection",value:function(){switch(this.value){case 0:return sB.empty();case 1:case 5:return sB.of(rre.UP);case 2:case 6:return sB.of(rre.RIGHT);case 3:case 7:return sB.of(rre.DOWN);case 4:case 8:return sB.of(rre.LEFT);default:return nB.expectToBe(this.value,9),sB.empty()}}},{key:"getDirection",value:function(){return this.getOptionalDirection().get()}},{key:"toString",value:function(){switch(this.value){case 0:return"EMPTY";case 1:return"WHITE_UP";case 2:return"WHITE_RIGHT";case 3:return"WHITE_DOWN";case 4:return"WHITE_LEFT";case 5:return"BLACK_UP";case 6:return"BLACK_RIGHT";case 7:return"BLACK_DOWN";case 8:return"BLACK_LEFT";default:return nB.expectToBe(this.value,9),"MOUNTAIN"}}}],[{key:"decode",value:function(t){switch(t){case 0:return e.EMPTY;case 1:return e.WHITE_UP;case 2:return e.WHITE_RIGHT;case 3:return e.WHITE_DOWN;case 4:return e.WHITE_LEFT;case 5:return e.BLACK_UP;case 6:return e.BLACK_RIGHT;case 7:return e.BLACK_DOWN;case 8:return e.BLACK_LEFT;case 9:return e.MOUNTAIN}}},{key:"of",value:function(t,n){return n===ete.ZERO?t===rre.UP?e.WHITE_UP:t===rre.RIGHT?e.WHITE_RIGHT:t===rre.DOWN?e.WHITE_DOWN:e.WHITE_LEFT:t===rre.UP?e.BLACK_UP:t===rre.RIGHT?e.BLACK_RIGHT:t===rre.DOWN?e.BLACK_DOWN:e.BLACK_LEFT}}]),e}();Mfe.EMPTY=new Mfe(0),Mfe.WHITE_UP=new Mfe(1),Mfe.WHITE_RIGHT=new Mfe(2),Mfe.WHITE_DOWN=new Mfe(3),Mfe.WHITE_LEFT=new Mfe(4),Mfe.BLACK_UP=new Mfe(5),Mfe.BLACK_RIGHT=new Mfe(6),Mfe.BLACK_DOWN=new Mfe(7),Mfe.BLACK_LEFT=new Mfe(8),Mfe.MOUNTAIN=new Mfe(9);var Dfe=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"countPlayerPawn",value:function(){for(var e=0,t=0;t<5;t++)for(var n=0;n<5;n++)this.board[t][n].belongTo(this.getCurrentPlayer())&&e++;return e}}],[{key:"getInitialState",value:function(){var e=ite.createTable(5,5,Mfe.EMPTY);return e[2][1]=Mfe.MOUNTAIN,e[2][2]=Mfe.MOUNTAIN,e[2][3]=Mfe.MOUNTAIN,new n(e,0)}}]),n}(wre),Lfe=function(){var e=rp(function e(){tp(this,e)});return e.CANNOT_INSERT_WHEN_SELECTED=function(){return $localize(Js||(Js=Rv(["You cannot insert a piece when you have already selected a piece."])))},e.NO_REMAINING_PIECE_TO_INSERT=function(){return $localize(Qs||(Qs=Rv(["You cannot insert a piece, all your pieces are already on the board."])))},e.NOT_ENOUGH_FORCE_TO_PUSH=function(){return $localize(Xs||(Xs=Rv(["You do not have enough strength to push."])))},e.ILLEGAL_ROTATION=function(){return $localize(eu||(eu=Rv(["You cannot push and turn at the same time."])))},e.ILLEGAL_PUSH=function(){return $localize(tu||(tu=Rv(["Your push is invalid: it is either not straight, is not pushing anything, or is leaving the board."])))},e}(),Ffe=rp(function e(t,n){tp(this,e),this.resultingBoard=t,this.moved=n}),Bfe=function(){var e=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"isLegal",value:function(e,t){if(rB(n.VERBOSE,{SiamRules_isLegal:{move:e,state:t}}),!e.isInsertion()&&!t.getPieceAt(e.coord).belongTo(t.getCurrentPlayer()))return j5.failure(pre.MUST_CHOOSE_PLAYER_PIECE());if(e.isRotation())return rB(n.VERBOSE,"Move is rotation"),this.isLegalRotation(e,t);var r;if(e.isInsertion()){rB(n.VERBOSE,"Move is insertion");var i=this.isLegalInsertion(e.coord,t);if(i.legal.isFailure())return j5.failure(i.legal.getReason());r=i.insertedPiece}else rB(n.VERBOSE,"Move is forward"),r=t.getPieceAt(e.coord);return n.isLegalForwarding(e,t,r)}},{key:"isLegalInsertion",value:function(e,t){var r=t.countPlayerPawn(),i=t.getCurrentPlayer(),a=r<5?K5.SUCCESS:K5.failure(Lfe.NO_REMAINING_PIECE_TO_INSERT());return{insertedPiece:n.getInsertedPiece(e,i),legal:a}}},{key:"isLegalRotation",value:function(e,t){rB(n.VERBOSE,{isLegalRotation:{rotation:e,state:t}});var r=e.coord,i=t.getPieceAt(r),a=t.getCurrentPlayer();if(i.getDirection()===e.landingOrientation)return j5.failure(Lfe.ILLEGAL_ROTATION());var o=t.getCopiedBoard();return o[r.y][r.x]=Mfe.of(e.landingOrientation,a),j5.success(new Ffe(o,[r]))}},{key:"applyLegalMove",value:function(e,t,n){var r=ite.copyBiArray(n.resultingBoard);return new Dfe(r,t.turn+1)}},{key:"getGameStatus",value:function(e){var t=n.getMountainsRowsAndColumns(e.gameState),r=n.getWinner(e.gameState,e.move,t.nbMountain);return r.isPlayer()?Are.getVictory(r):Are.ONGOING}}],[{key:"getInsertedPiece",value:function(e,t){return Mfe.of(-1===e.x?rre.RIGHT:-1===e.y?rre.DOWN:5===e.x?rre.LEFT:rre.UP,t)}},{key:"isLegalForwarding",value:function(e,t,r){rB(n.VERBOSE,{isLegalForwarding:{move:e.toString(),state:t,firstPiece:r}});var i=[],a=Mfe.of(e.landingOrientation,t.getCurrentPlayer()),o=e.moveDirection.get(),s=e.coord.getNext(o);if(s.isInRange(5,5)&&t.getPieceAt(s)!==Mfe.EMPTY&&!1===n.isStraight(r,e))return rB(n.VERBOSE,"Illegal push because not straight or not pushing anything or leaving the board"),j5.failure(Lfe.ILLEGAL_PUSH());var u=sB.of(o),c=o.getOpposite(),l=0,h=t.getCopiedBoard();e.coord.isInRange(5,5)&&(h[e.coord.y][e.coord.x]=Mfe.EMPTY,i.push(e.coord));for(var f=s.isInRange(5,5)&&a!==Mfe.EMPTY;f;){u.equalsValue(o)?l++:u.equalsValue(c)&&l--,rB(n.VERBOSE,{totalForce:l,movingPiece:a,landingCoord:s});var d=h[s.y][s.x];d===Mfe.MOUNTAIN&&(l-=.9),h[s.y][s.x]=a,i.push(s),a=d,s=s.getNext(o),u=a.getOptionalDirection(),f=s.isInRange(5,5)&&a!==Mfe.EMPTY&&l>0}return s.isNotInRange(5,5)&&(rB(n.VERBOSE,"This movement would push "+a+" outside the board"),u.equalsValue(o)?l++:u.equalsValue(c)&&l--),l<=0?(rB(n.VERBOSE,"This move is an illegal push: "+h),j5.failure(Lfe.NOT_ENOUGH_FORCE_TO_PUSH())):(rB(n.VERBOSE,"This move is a legal push: "+h),j5.success(new Ffe(h,i)))}},{key:"isStraight",value:function(e,t){var n=e.getDirection();return t.moveDirection.equalsValue(n)&&n===t.landingOrientation}},{key:"getBoardValueInfo",value:function(e,t){var r=n.getMountainsRowsAndColumns(t),i=r.rows,a=r.columns,o=n.getWinner(t,e,r.nbMountain);if(o.isPlayer())return o===ete.ZERO?{shortestZero:0,shortestOne:Number.POSITIVE_INFINITY,boardValue:Number.MIN_SAFE_INTEGER}:{shortestZero:Number.POSITIVE_INFINITY,shortestOne:0,boardValue:Number.MAX_SAFE_INTEGER};var s,u=n.getPushers(t,a,i),c=Number.MAX_SAFE_INTEGER,l=Number.MAX_SAFE_INTEGER,h=t.getCurrentPlayer(),f=Qv(u);try{for(f.s();!(s=f.n()).done;){var d=s.value;d.coord.isInRange(5,5)?t.getPieceAt(d.coord).belongTo(ete.ZERO)?c=Math.min(c,d.distance):l=Math.min(l,d.distance):h===ete.ZERO?c=Math.min(c,d.distance):l=Math.min(l,d.distance)}}catch(v){f.e(v)}finally{f.f()}return{shortestZero:c,shortestOne:l,boardValue:n.getScoreFromShortestDistances(c,l,h)}}},{key:"getScoreFromShortestDistances",value:function(e,t,n){e===Number.MAX_SAFE_INTEGER&&(e=6),t===Number.MAX_SAFE_INTEGER&&(t=6);var r=6-e,i=6-t;return r===i?n.getScoreModifier():r>i?-10*(r+1)+(i+1):10*(i+1)-(r+1)}},{key:"getMountainsRowsAndColumns",value:function(e){for(var t=[],n=[],r=0,i=0;i<5;i++)for(var a=0;a<5;a++)e.getPieceAtXY(a,i)===Mfe.MOUNTAIN&&(t.includes(i)||t.push(i),n.includes(a)||n.push(a),r++);return{rows:t,columns:n,nbMountain:r}}},{key:"getWinner",value:function(e,t,r){return 2===r?n.getPusher(e,t.get()):Xee.NONE}},{key:"getPusher",value:function(e,t){var r=t.coord,i=(r.isInRange(5,5)?e.getPieceAt(r.getNext(t.landingOrientation)):n.getInsertedPiece(r,e.getCurrentOpponent())).getDirection(),a=n.getPusherCoord(e,i,r),o=e.getPieceAt(a).getOwner();return rB(n.VERBOSE,r.toString()+" belong to "+e.getCurrentOpponent().value+", "+a.toString()+" belong to "+o.value+", "+o.value+" win"),o}},{key:"getPusherCoord",value:function(e,t,n){for(var r=n.getNext(t),i=n;r.isInRange(5,5);){n=r,r=r.getNext(t);var a=e.getPieceAt(n);a!==Mfe.MOUNTAIN&&a.getDirection()===t&&(i=n)}return i}},{key:"getPushers",value:function(e,t,r){rB(n.VERBOSE,{getPushers:{state:e,mountainsColumn:t,mountainsRow:r}});var i,a=[],o=[],s=Qv(t);try{for(s.s();!(i=s.n()).done;){var u=i.value,c=rre.DOWN,l=new ire(u,4);o.push({direction:c,fallingCoord:l}),c=rre.UP,l=new ire(u,0),o.push({direction:c,fallingCoord:l})}}catch(k){s.e(k)}finally{s.f()}var h,f=Qv(r);try{for(f.s();!(h=f.n()).done;){var d=h.value,v=rre.LEFT,p=new ire(0,d);o.push({direction:v,fallingCoord:p}),v=rre.RIGHT,p=new ire(4,d),o.push({direction:v,fallingCoord:p})}}catch(k){f.e(k)}finally{f.f()}for(var g=0,y=o;g<y.length;g++){var m=y[g];a=n.addPotentialDirectionPusher(e,m.fallingCoord,m.direction,a)}return a}},{key:"addPotentialDirectionPusher",value:function(e,t,r,i){var a=n.getLineClosestPusher(e,t,r);if(a.isAbsent())return i;var o=a.get(),s=o.distance;return rB(n.VERBOSE,"new closest challenger"),i.push({coord:o.coord,distance:s}),i}},{key:"getLineClosestPusher",value:function(e,t,r){rB(n.VERBOSE,{getDirectionClosestPusher:{state:e,fallingCoord:t,direction:r.toString()}});for(var i=r.getOpposite(),a=1,o=e.getPieceAt(t),s=t,u=sB.empty(),c=!1,l=!1,h=0;s.isInRange(5,5)&&!1===c;){var f=e.getPieceAt(s);if(f.isEmptyOrMountain())f===Mfe.MOUNTAIN?(h+=.9,l=!0):a++;else{var d=f.getDirection();d===r?l&&((h-=1)<=0&&(c=!0,s=s.getNext(r))):d===i?(h+=1,l||a++):l?(u=sB.of(s),o!==Mfe.EMPTY&&a++):a++}o=f,s=s.getPrevious(r)}if(!1===c&&u.isPresent())for(a++,h-=1;!1===s.equals(u.get());)s=s.getNext(r),a--;return s.isNotInRange(5,5)&&(h-=1,5===e.countPlayerPawn())||h>0?sB.empty():sB.of({distance:a,coord:s})}},{key:"getPushingInsertions",value:function(e){for(var t=[],n=e.gameState.getCurrentPlayer(),r=[],i=[],a=0;a<5;a++)r.push(new Nfe(-1,a,sB.of(rre.RIGHT),rre.RIGHT)),i.push(Mfe.of(rre.RIGHT,n)),r.push(new Nfe(5,a,sB.of(rre.LEFT),rre.LEFT)),i.push(Mfe.of(rre.LEFT,n)),r.push(new Nfe(a,-1,sB.of(rre.DOWN),rre.DOWN)),i.push(Mfe.of(rre.DOWN,n)),r.push(new Nfe(a,5,sB.of(rre.UP),rre.UP)),i.push(Mfe.of(rre.UP,n));for(var o=0;o<r.length;o++)this.isLegalForwarding(r[o],e.gameState,i[o]).isSuccess()&&t.push(r[o]);return t}},{key:"getDerapingInsertions",value:function(e){for(var t,n,r=[],i=e.gameState.getCurrentPlayer(),a=1;a<=3;a++)t=new Nfe(-1,a,sB.of(rre.RIGHT),rre.UP),n=Mfe.of(rre.UP,i),this.isLegalForwarding(t,e.gameState,n).isSuccess()&&(r.push(t),t=new Nfe(-1,a,sB.of(rre.RIGHT),rre.DOWN),n=Mfe.of(rre.DOWN,i),this.isLegalForwarding(t,e.gameState,n),r.push(t)),t=new Nfe(5,a,sB.of(rre.LEFT),rre.UP),n=Mfe.of(rre.UP,i),this.isLegalForwarding(t,e.gameState,n).isSuccess()&&(r.push(t),t=new Nfe(5,a,sB.of(rre.LEFT),rre.DOWN),n=Mfe.of(rre.DOWN,i),this.isLegalForwarding(t,e.gameState,n),r.push(t));for(var o=1;o<=3;o++)t=new Nfe(o,-1,sB.of(rre.DOWN),rre.LEFT),n=Mfe.of(rre.LEFT,i),this.isLegalForwarding(t,e.gameState,n).isSuccess()&&(r.push(t),t=new Nfe(o,-1,sB.of(rre.DOWN),rre.RIGHT),n=Mfe.of(rre.RIGHT,i),this.isLegalForwarding(t,e.gameState,n),r.push(t)),t=new Nfe(o,5,sB.of(rre.UP),rre.LEFT),n=Mfe.of(rre.LEFT,i),this.isLegalForwarding(t,e.gameState,n).isSuccess()&&(r.push(t),t=new Nfe(o,5,sB.of(rre.UP),rre.RIGHT),n=Mfe.of(rre.RIGHT,i),this.isLegalForwarding(t,e.gameState,n),r.push(t));return r}},{key:"getCoordDirection",value:function(e,t,n){var r=new ire(e,t);return this.getInsertedPiece(r,n.getCurrentPlayer()).getDirection()}}]),n}(Rre);return e.VERBOSE=!1,e}(),Vfe=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"getBoardValue",value:function(e){return new yre(Bfe.getBoardValueInfo(e.move,e.gameState).boardValue)}},{key:"getListMoves",value:function(e){for(var t,n=[],r=e.gameState.getCurrentPlayer(),i=0;i<5;i++)for(var a=0;a<5;a++)if((t=e.gameState.getPieceAtXY(a,i)).belongTo(r)){var o,s=t.getDirection(),u=Qv(rre.ORTHOGONALS);try{for(u.s();!(o=u.n()).done;){var c=o.value;if(c!==s){var l=e.gameState.getCopiedBoard(),h=new Nfe(a,i,sB.empty(),c);l[i][a]=Mfe.of(c,r),n.push(h)}var f,d=Qv(new ire(a+c.x,i+c.y).isInRange(5,5)?rre.ORTHOGONALS:[c]);try{for(d.s();!(f=d.n()).done;){var v=f.value,p=new Nfe(a,i,sB.of(c),v);Bfe.isLegalForwarding(p,e.gameState,t).isSuccess()&&n.push(p)}}catch(g){d.e(g)}finally{d.f()}}}catch(g){u.e(g)}finally{u.f()}}return e.gameState.countPlayerPawn()<5&&(n=(n=n.concat(Bfe.getPushingInsertions(e))).concat(Bfe.getDerapingInsertions(e))),rB(Bfe.VERBOSE,{getListMovesResult:n}),n}}]),n}(gre),Ufe=Mfe.EMPTY,zfe=Mfe.MOUNTAIN,Hfe=Mfe.WHITE_UP,Gfe=Mfe.WHITE_LEFT,qfe=Mfe.WHITE_RIGHT,$fe=Mfe.WHITE_DOWN,Wfe=Mfe.BLACK_UP,jfe=Mfe.BLACK_LEFT,Zfe=Mfe.BLACK_RIGHT,Yfe=Mfe.BLACK_DOWN,Kfe=rp(function e(){tp(this,e),this.tutorial=[Lre.informational($localize(nu||(nu=Rv(["Goal of the game"]))),$localize(ru||(ru=Rv(["The goal at Siam is to be the first to push a mountain out of the board.\n        The initial board contains three mountains, and no pieces are initially on the board.\n        During its turn, a player can do one of the following three actions:\n        <ol>\n            <li>Put a new piece on the board.</li>\n            <li>Change the orientation of one of its piece, and optionally move it.</li>\n            <li>Take one of its pieces out of the board.</li>\n        </ol>"]))),Dfe.getInitialState()),Lre.anyMove($localize(iu||(iu=Rv(["Inserting a piece"]))),$localize(au||(au=Rv(["Each player has 5 pieces in total.\n        As long as you do not have 5 pieces on the board, you can insert new pieces. To do so:\n        <ol>\n            <li>Click on one of the big arrows alongside the board.</li>\n            <li>Click on one of the small arrows that appeared on the landing square of your piece.\n                This is the direction in which your piece will be oriented.</li>\n        </ol><br/>\n        Insert a piece on the board."]))),Dfe.getInitialState(),new Nfe(2,-1,sB.of(rre.DOWN),rre.DOWN),$localize(ou||(ou=Rv(["Congratulations!"])))),Lre.fromMove($localize(su||(su=Rv(["Moving a piece"]))),$localize(uu||(uu=Rv(['We will distinguish here "moving" and "pushing".\n        A move is made from a piece\'s square to an empty neighboring square, horizontally or vertically.\n        During that move, you can also move the piece out of the board.\n        To move a piece:\n        <ol>\n            <li>Click on it.</li>\n            <li>Click on one of the 4 arrows to pick the direction in which it will move.\n                You can also click on the middle dot to change the piece\'s orientation without moving it.</li>\n            <li>Click on one of the 4 arrows on the landing square to pick its orientation.</li>\n        </ol><br/>\n        Try to move the piece that is on the board one square upwards and to orient it downwards.']))),new Dfe([[Ufe,Ufe,Ufe,Ufe,Ufe],[Ufe,Ufe,Ufe,Ufe,Ufe],[Ufe,zfe,zfe,zfe,Ufe],[Ufe,Ufe,Ufe,Ufe,Ufe],[Ufe,Ufe,Hfe,Ufe,Ufe]],0),[new Nfe(2,4,sB.of(rre.UP),rre.DOWN)],$localize(cu||(cu=Rv(["Congratulations, you made a side-slip!"]))),$localize(lu||(lu=Rv(["Failed!"])))),Lre.fromMove($localize(hu||(hu=Rv(["Moving a piece out of the board"]))),$localize(fu||(fu=Rv(["To move a piece out of the board, you do not have to pick an orientation after the move.<br/><br/>\n        Get that piece out of the board!"]))),new Dfe([[Ufe,Ufe,Ufe,Ufe,Ufe],[Ufe,Ufe,Ufe,Ufe,Ufe],[Ufe,zfe,zfe,zfe,Ufe],[Ufe,Ufe,Ufe,Ufe,Ufe],[Ufe,Ufe,Hfe,Ufe,Ufe]],0),[new Nfe(2,4,sB.of(rre.DOWN),rre.DOWN)],$localize(du||(du=Rv(["Congratulations, even if in this context it was not a useful move."]))),$localize(vu||(vu=Rv(["Failed, the piece is still on the board."])))),Lre.fromMove($localize(pu||(pu=Rv(["Pushing"]))),$localize(gu||(gu=Rv(['When the landing square of your move is occupied, we use the term "push".\n        In order to push, multiple conditions must hold:\n        <ol>\n            <li>Your piece must already be oriented in the direction of the push.</li>\n            <li>The number of the pieces (opponent\'s or not) that are facing yours (called the resistants)\n                must be smaller than the number of pieces that are oriented in the same direction as the push, yourself included (the pushers).</li>\n            <li>The number of mountains on that line must be smaller or equal to the difference between the pushers and the resistants.</li>\n        </ol>\n        Your piece on the top right cannot push because there is one mountain too much.\n        Your piece on the bottom right can push.<br/><br/>\n        Do it.']))),new Dfe([[qfe,zfe,zfe,jfe,Gfe],[Ufe,Ufe,Ufe,Ufe,Ufe],[Ufe,Ufe,Ufe,zfe,Ufe],[Ufe,Ufe,Ufe,Ufe,Ufe],[Ufe,Ufe,Zfe,jfe,Gfe]],0),[new Nfe(4,4,sB.of(rre.LEFT),rre.LEFT)],$localize(yu||(yu=Rv(["Congratulations!"]))),$localize(mu||(mu=Rv(["Failed!"])))),Lre.fromMove($localize(ku||(ku=Rv(["Victory"]))),$localize(_u||(_u=Rv(["The game ends when a mountain is pushed out of the board.\n        If you pushed it and nobody is in front of you, you're the winner.\n        However, if you were pushing an opponent oriented in the same direction as you, your opponent will win because that piece is closer to the mountain.\n        However, if that opponent is closer to the mountain but not oriented towards it, victory will be yours.<br/><br/>\n        You have two ways of ending the game here: you can either win, or lose. Choose correctly!"]))),new Dfe([[Ufe,Ufe,Ufe,Ufe,Ufe],[Ufe,Ufe,Ufe,Ufe,Ufe],[zfe,Wfe,Gfe,Ufe,$fe],[Ufe,Ufe,Ufe,Ufe,Yfe],[Ufe,Ufe,Ufe,Ufe,zfe]],0),[new Nfe(2,2,sB.of(rre.LEFT),rre.LEFT)],$localize(wu||(wu=Rv(["Congratulations, you won!"]))),$localize(Cu||(Cu=Rv(["Failed, you lost."]))))]});function Jfe(e,t){if(1&e){var n=pb();_m(),lb(0,"use",7),mb("click",function(){var e=$y(n).$implicit;return wb(3).insertAt(e.x,e.y)}),hb()}if(2&e){var r=t.$implicit,i=wb(3);bb("id","insertAt_",r.x,"_",r.y,""),tb("transform",i.getInsertionArrowTransform(r.x+1,r.y+1,r.dir))}}var Qfe=function(e,t){return{dir:"DOWN",x:e,y:t}},Xfe=function(e){return{dir:"UP",x:e,y:5}},ede=function(e,t){return{dir:"RIGHT",x:e,y:t}},tde=function(e){return{dir:"LEFT",x:5,y:e}},nde=function(e,t,n,r){return[e,t,n,r]};function rde(e,t){if(1&e&&(_m(),lb(0,"g"),ab(1,Jfe,1,3,"use",6),hb()),2&e){var n=t.$implicit;Pw(1),ub("ngForOf",function(e,t,n,r,i,a,o){return function(e,t,n,r,i,a,o,s,u){var c=t+n;return function(e,t,n,r,i,a){var o=XC(e,t,n,r);return XC(e,t+2,i,a)||o}(e,c,i,a,o,s)?JC(e,c+4,u?r.call(u,i,a,o,s):r(i,a,o,s)):rP(e,c+4)}(Gy(),em(),e,t,n,r,i,a,o)}(11,nde,nP(1,Qfe,n,-1),tP(4,Xfe,n),nP(6,ede,-1,n),tP(9,tde,n)))}}var ide=function(){return[0,1,2,3,4]};function ade(e,t){1&e&&(_m(),db(0),ab(1,rde,2,16,"g",5),vb()),2&e&&(Pw(1),ub("ngForOf",eP(1,ide)))}function ode(e,t){if(1&e){var n=pb();_m(),lb(0,"use",13),mb("click",function(){var e=$y(n).$implicit;return wb(5).chooseDirection(e)}),hb()}if(2&e){var r=t.$implicit,i=wb(3).index,a=wb().index,o=wb();Cb("id","chooseDirection_",r,""),tb("transform",o.getArrowTransform(i+1,a+1,r))}}var sde=function(){return["RIGHT","DOWN","LEFT","UP"]};function ude(e,t){if(1&e){var n=pb();_m(),lb(0,"g"),lb(1,"circle",11),mb("click",function(){return $y(n),wb(4).chooseDirection("")}),hb(),ab(2,ode,1,2,"use",12),hb()}if(2&e){var r=wb(2).index,i=wb().index,a=wb();Pw(1),tb("cx",(r+1)*a.SPACE_SIZE+a.SPACE_SIZE/2)("cy",(i+1)*a.SPACE_SIZE+a.SPACE_SIZE/2),Pw(1),ub("ngForOf",eP(3,sde))}}function cde(e,t){if(1&e){var n=pb();_m(),lb(0,"g"),lb(1,"use",10),mb("click",function(){$y(n);var e=wb().index,t=wb().index;return wb().clickPiece(e,t)}),hb(),ab(2,ude,3,4,"g",4),hb()}if(2&e){var r=wb(),i=r.index,a=r.$implicit,o=wb().index,s=wb();Pw(1),bb("id","clickPiece_",i,"_",o,""),ub("ngClass",s.getPieceClasses(a)),tb("transform",s.getPieceTransform(i,o)),Pw(1),ub("ngIf",s.choosingDirection(i,o))}}function lde(e,t){if(1&e&&(_m(),fb(0,"use",14)),2&e){var n=wb().index,r=wb().index,i=wb();tb("transform","translate("+(n+1)*i.SPACE_SIZE+" "+(r+1)*i.SPACE_SIZE+")")}}function hde(e,t){if(1&e){var n=pb();_m(),lb(0,"use",13),mb("click",function(){var e=$y(n).$implicit;return wb(4).chooseOrientation(e)}),hb()}if(2&e){var r=t.$implicit,i=wb(2).index,a=wb().index,o=wb();Cb("id","chooseOrientation_",r,""),tb("transform",o.getArrowTransform(i+1,a+1,r))}}function fde(e,t){1&e&&(_m(),lb(0,"g"),ab(1,hde,1,2,"use",12),hb()),2&e&&(Pw(1),ub("ngForOf",eP(1,sde)))}function dde(e,t){if(1&e){var n=pb();_m(),lb(0,"g"),lb(1,"rect",8),mb("click",function(){var e=$y(n).index,t=wb().index;return wb().insertAt(e,t)}),hb(),ab(2,cde,3,5,"g",4),ab(3,lde,1,1,"use",9),ab(4,fde,2,2,"g",4),hb()}if(2&e){var r=t.$implicit,i=t.index,a=wb().index,o=wb();Pw(1),bb("id","insertAt_",i,"_",a,""),ub("ngClass",o.getSquareClasses(i,a)),tb("x",o.SPACE_SIZE*(i+1))("y",o.SPACE_SIZE*(a+1))("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),Pw(1),ub("ngIf",r.isPiece()),Pw(1),ub("ngIf",o.isMountain(r)),Pw(1),ub("ngIf",o.choosingOrientation(i,a))}}function vde(e,t){if(1&e&&(_m(),lb(0,"g"),ab(1,dde,5,10,"g",5),hb()),2&e){var n=t.$implicit;Pw(1),ub("ngForOf",n)}}var pde=function(){var e=function(e){Gv(n,e);var t=$v(n);function n(e){var r;return tp(this,n),(r=t.call(this,e)).lastMove=sB.empty(),r.chosenCoord=sB.empty(),r.landingCoord=sB.empty(),r.chosenDirection=sB.empty(),r.chosenOrientation=sB.empty(),r.movedPieces=[],r.rules=new Bfe(Dfe),r.availableMinimaxes=[new Vfe(r.rules,"SiamMinimax")],r.encoder=Nfe.encoder,r.tutorial=(new Kfe).tutorial,r.updateBoard(),r}return rp(n,[{key:"updateBoard",value:function(){if(rB(n.VERBOSE,"updateBoard"),this.board=this.rules.node.gameState.board,this.lastMove=this.rules.node.move,this.lastMove.isPresent()){var e=this.rules.node.mother.get().gameState;this.movedPieces=this.rules.isLegal(this.lastMove.get(),e).get().moved}else this.movedPieces=[]}},{key:"cancelMoveAttempt",value:function(){this.chosenCoord=sB.empty(),this.chosenDirection=sB.empty(),this.landingCoord=sB.empty(),this.chosenOrientation=sB.empty()}},{key:"clickPiece",value:function(e,t){var n=this.canUserPlay("#clickPiece_"+e+"_"+t);if(n.isFailure())return this.cancelMove(n.getReason());var r=this.board[t][e],i=this.rules.node.gameState.getCurrentOpponent();return r.getOwner()===i?this.cancelMove(pre.MUST_CHOOSE_PLAYER_PIECE()):(this.chosenCoord=sB.of(new ire(e,t)),K5.SUCCESS)}},{key:"chooseDirection",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(rB(n.VERBOSE,"SiamComponent.chooseDirection("+e+")"),!(i=t.canUserPlay("#chooseDirection_"+e)).isFailure()){r.next=4;break}return r.abrupt("return",t.cancelMove(i.getReason()));case 4:if(""!==e){r.next=8;break}t.chosenDirection=sB.empty(),t.landingCoord=t.chosenCoord,r.next=15;break;case 8:if(a=rre.factory.fromString(e).get(),t.chosenDirection=sB.of(a),t.landingCoord=sB.of(t.chosenCoord.get().getNext(a)),!t.landingCoord.get().isNotInRange(5,5)){r.next=15;break}return rB(n.VERBOSE,"orientation and direction should be the same: "+a),t.chosenOrientation=sB.of(a),r.next=14,t.tryMove();case 14:return r.abrupt("return",r.sent);case 15:return r.abrupt("return",K5.SUCCESS);case 16:case"end":return r.stop()}},r)}))()}},{key:"chooseOrientation",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(rB(n.VERBOSE,"SiamComponent.chooseOrientation("+e+")"),!(i=t.canUserPlay("#chooseOrientation_"+e)).isFailure()){r.next=6;break}r.t0=t.cancelMove(i.getReason()),r.next=10;break;case 6:return t.chosenOrientation=sB.of(rre.factory.fromString(e).get()),r.next=9,t.tryMove();case 9:r.t0=r.sent;case 10:return r.abrupt("return",r.t0);case 11:case"end":return r.stop()}},r)}))()}},{key:"insertAt",value:function(e,t){var r=this;return tB(regeneratorRuntime.mark(function i(){var a,o;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(rB(n.VERBOSE,"SiamComponent.insertAt("+e+", "+t+")"),!(a=r.canUserPlay("#insertAt_"+e+"_"+t)).isFailure()){i.next=4;break}return i.abrupt("return",r.cancelMove(a.getReason()));case 4:if(!r.chosenCoord.isPresent()){i.next=6;break}return i.abrupt("return",r.cancelMove(Lfe.CANNOT_INSERT_WHEN_SELECTED()));case 6:return r.chosenCoord=sB.of(new ire(e,t)),o=Bfe.getCoordDirection(e,t,r.rules.node.gameState),i.abrupt("return",(r.chosenDirection=sB.of(o),r.landingCoord=sB.of(r.chosenCoord.get().getNext(o)),K5.SUCCESS));case 9:case"end":return i.stop()}},i)}))()}},{key:"tryMove",value:function(){var e=this;return tB(regeneratorRuntime.mark(function t(){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.chosenCoord.get(),r=new Nfe(n.x,n.y,e.chosenDirection,e.chosenOrientation.get()),e.cancelMove(),t.next=4,e.chooseMove(r,e.rules.node.gameState);case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}},t)}))()}},{key:"isMountain",value:function(e){return e===Mfe.MOUNTAIN}},{key:"choosingOrientation",value:function(e,t){var r=new ire(e,t);return!!(this.chosenCoord.isPresent()&&this.landingCoord.equalsValue(r)&&this.chosenOrientation.isAbsent())&&(rB(n.VERBOSE,"choosing orientation now"),!0)}},{key:"choosingDirection",value:function(e,t){var r=new ire(e,t);return!!(this.chosenCoord.equalsValue(r)&&this.chosenDirection.isAbsent()&&this.landingCoord.isAbsent()&&this.chosenOrientation.isAbsent())&&(rB(n.VERBOSE,"choosing direction now"),!0)}},{key:"getInsertionArrowTransform",value:function(e,t,n){var r="rotate(".concat(90*(rre.factory.fromString(n).get().toInt()-2)," ").concat(this.SPACE_SIZE/2," ").concat(this.SPACE_SIZE/2,")");return["translate("+e*this.SPACE_SIZE+", "+t*this.SPACE_SIZE+")",r].join(" ")}},{key:"getPieceTransform",value:function(e,t){var n="rotate(".concat(90*(this.board[t][e].getDirection().toInt()-2)," ").concat(this.SPACE_SIZE/2," ").concat(this.SPACE_SIZE/2,")");return["translate("+(e+1)*this.SPACE_SIZE+", "+(t+1)*this.SPACE_SIZE+")",n].join(" ")}},{key:"getArrowTransform",value:function(e,t,n){return qhe.getArrowTransform(this.SPACE_SIZE,new ire(e,t),rre.factory.fromString(n).get())}},{key:"getPieceClasses",value:function(e){return[this.getPlayerClass(e.getOwner())]}},{key:"getSquareClasses",value:function(e,t){var n=new ire(e,t);return this.movedPieces.some(function(e){return e.equals(n)})?["moved"]:[]}}]),n}(yie);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(sb(ore))},e.\u0275cmp=ey({type:e,selectors:[["app-siam"]],features:[zC],decls:7,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 0 700 700","preserveAspectRatio","xMidYMid meet"],["id","triangle","points","0 -6, 10 0, 0 6"],["id","arrow","points","30 7, 30 50, 10 50, 50 93, 90 50, 70 50, 70 7, 27.5 7"],["id","mountain","points","5 95, 16 68, 24 76, 48 28, 64 60, 72 44, 95 95, 5 95"],[4,"ngIf"],[4,"ngFor","ngForOf"],[0,"xlink","href","#arrow","class","base mid-stroke",3,"id","click",4,"ngFor","ngForOf"],[0,"xlink","href","#arrow",1,"base","mid-stroke",3,"id","click"],[1,"base",3,"id","ngClass","click"],[0,"xlink","href","#mountain","fill","brown",4,"ngIf"],[0,"xlink","href","#arrow",1,"base","mid-stroke",3,"id","ngClass","click"],["id","chooseDirection_","r","8",1,"arrow","selected-fill","no-stroke",3,"click"],[0,"xlink","href","#triangle","class","arrow selected-fill no-stroke",3,"id","click",4,"ngFor","ngForOf"],[0,"xlink","href","#triangle",1,"arrow","selected-fill","no-stroke",3,"id","click"],[0,"xlink","href","#mountain","fill","brown"]],template:function(e,t){1&e&&(_m(),lb(0,"svg",0),lb(1,"defs"),fb(2,"polygon",1),fb(3,"polygon",2),fb(4,"polygon",3),hb(),ab(5,ade,2,2,"ng-container",4),ab(6,vde,2,1,"g",5),hb()),2&e&&(Pw(5),ub("ngIf",t.isPlayerTurn()),Pw(1),ub("ngForOf",t.board))},directives:[NT,AT,IT],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),gde=function(){var e=rp(function e(){tp(this,e)});return e.NO_MOVEMENT_BEFORE_TURN_40=function(){return $localize(bu||(bu=Rv(["You cannot move yet. Pick a space where you will put a new piece."])))},e.MUST_CUT=function(){return $localize(Eu||(Eu=Rv(["Several groups are of the same size, you must pick the one to keep."])))},e.CANNOT_CHOOSE_TO_KEEP=function(){return $localize(Su||(Su=Rv(["You cannot choose which part to keep when one is smaller than the other."])))},e.CAN_NO_LONGER_DROP=function(){return $localize(Pu||(Pu=Rv(["You cannot put new pieces anymore. Pick a piece to move."])))},e.MUST_CAPTURE_BIGGEST_GROUPS=function(){return $localize(Ou||(Ou=Rv(["You must choose one of the biggest groups to keep it."])))},e.CANNOT_KEEP_EMPTY_COORD=function(){return $localize(Tu||(Tu=Rv(["You cannot pick an empty space. Pick one of the biggest groups."])))},e.MUST_DROP_NEXT_TO_OTHER_PIECE=function(){return $localize(Iu||(Iu=Rv(["You must put this piece next to another piece."])))},e}(),yde=function(e){Gv(n,e);var t=$v(n);function n(e,r,i){var a;tp(this,n),(a=t.call(this,r)).pieces=e;var o=a.getCalculatedScale();return a.pieces=o.pieces,a.width=o.width,a.height=o.height,a.offset=null!=i?i:o.offset,a.pieces.makeImmutable(),a}return rp(n,[{key:"getCalculatedScale",value:function(){var e,t=Number.MAX_SAFE_INTEGER,n=Number.MIN_SAFE_INTEGER,r=Number.MAX_SAFE_INTEGER,i=Number.MIN_SAFE_INTEGER,a=Qv(this.pieces.listKeys());try{for(a.s();!(e=a.n()).done;){var o=e.value;t=Math.min(o.x,t),n=Math.max(o.x,n),r=Math.min(o.y,r),i=Math.max(o.y,i)}}catch(v){a.e(v)}finally{a.f()}var s=new Tre,u=new Xne(-t,-r);if(0!==t||0!==r){var c,l=Qv(this.pieces.listKeys());try{for(l.s();!(c=l.n()).done;){var h=c.value,f=this.pieces.delete(h),d=h.getNext(u);s.set(d,f)}}catch(v){l.e(v)}finally{l.f()}}else s=this.pieces;return{width:n+1-t,height:i+1-r,pieces:s,offset:u}}},{key:"toRepresentation",value:function(){var e,t=ite.createTable(this.width,this.height,Xee.NONE.value),n=Qv(this.pieces.listKeys());try{for(n.s();!(e=n.n()).done;){var r=e.value,i=this.getPieceAt(r).value;t[r.y][r.x]=i}}catch(a){n.e(a)}finally{n.f()}return t}},{key:"isIllegalLandingZone",value:function(e,t){return this.pieces.containsKey(e)?K5.failure(pre.MUST_LAND_ON_EMPTY_SPACE()):this.isCoordConnected(e,t)?K5.SUCCESS:K5.failure(gde.MUST_DROP_NEXT_TO_OTHER_PIECE())}},{key:"isCoordConnected",value:function(e,t){var n,r=Qv(lre.factory.all);try{for(r.s();!(n=r.n()).done;){var i=n.value,a=e.getNext(i,1);if(this.pieces.containsKey(a)&&!1===t.equalsValue(a))return!0}}catch(o){r.e(o)}finally{r.f()}return!1}},{key:"isOnBoard",value:function(e){return this.pieces.containsKey(e)}},{key:"getPieceAt",value:function(e){return this.isOnBoard(e)?this.pieces.get(e).get():Xee.NONE}},{key:"applyLegalDrop",value:function(e){var t=this.pieces.getCopy();return t.put(e,this.getCurrentPlayer()),new n(t,this.turn+1)}},{key:"applyLegalDeplacement",value:function(e,t){var r=n.deplacePiece(this,e),i=new Tre;if(t.size()>0){i=new Tre;var a,o=Qv(t);try{for(o.s();!(a=o.n()).done;){var s=a.value;i.set(s,r.get(s).get())}}catch(u){o.e(u)}finally{o.f()}}else i=r.getCopy();return new n(i,this.turn+1)}},{key:"countPieces",value:function(){var e=this.pieces.reverse(),t=e.get(ete.ZERO).getOrElse(new Hie),n=e.get(ete.ONE).getOrElse(new Hie);return[t.size(),n.size()]}},{key:"switchPiece",value:function(e){var t=this.pieces.getCopy(),r=this.getPieceAt(e);if(r.isPlayer())return t.replace(e,r.getOpponent()),new n(t,this.turn,this.offset);Q5.logErrorAndFail("SixState","Cannot switch piece if there is no piece!",{coord:e.toString()})}},{key:"equals",value:function(e){return this.turn===e.turn&&this.pieces.equals(e.pieces)}}],[{key:"getInitialState",value:function(){return n.fromRepresentation([[ete.ZERO.value],[ete.ONE.value]],0)}},{key:"fromRepresentation",value:function(e,t,r){for(var i=new Tre,a=0;a<e.length;a++)for(var o=0;o<e[0].length;o++)e[a][o]!==Xee.NONE.value&&i.set(new ire(o,a),ete.of(e[a][o]));return new n(i,t,r)}},{key:"deplacePiece",value:function(e,t){var n=e.pieces.getCopy();return n.delete(t.start.get()),n.set(t.landing,e.getCurrentPlayer()),n}},{key:"getGroups",value:function(e,t){var r,i=new Tre,a=0,o=Qv(lre.factory.all);try{for(o.s();!(r=o.n()).done;){var s=r.value,u=t.getNext(s,1);i=n.putCoordInGroup(e,u,i,""+a),a++}}catch(f){o.e(f)}finally{o.f()}for(var c=i.reverse(),l=new kre,h=0;h<c.size();h++)l.add(c.getByIndex(h).value);return l}},{key:"putCoordInGroup",value:function(e,t,r,i){if(e.get(t).isPresent()&&r.get(t).isAbsent()){r.set(t,i);var a,o=Qv(lre.factory.all);try{for(o.s();!(a=o.n()).done;){var s=a.value,u=t.getNext(s,1);r=n.putCoordInGroup(e,u,r,i)}}catch(c){o.e(c)}finally{o.f()}}return r}}]),n}(_re),mde=function(e){Gv(n,e);var t=$v(n);function n(e,r,i){var a;if(tp(this,n),(a=t.call(this)).start=e,a.landing=r,a.keep=i,e.equalsValue(r))throw new Error("Deplacement cannot be static!");if(e.isPresent()&&e.equals(i))throw new Error("Cannot keep starting coord, since it will always be empty after move!");return Wv(a)}return rp(n,[{key:"isDrop",value:function(){return this.start.isAbsent()}},{key:"isCut",value:function(){return this.keep.isPresent()}},{key:"toString",value:function(){return this.isDrop()?"SixMove("+this.landing.toString()+")":this.isCut()?"SixMove("+this.start.get().toString()+" > "+this.landing+", keep: "+this.keep.get().toString()+")":"SixMove("+this.start.get().toString()+" > "+this.landing+")"}},{key:"equals",value:function(e){return!1!==this.landing.equals(e.landing)&&!1!==this.start.equals(e.start)&&this.keep.equals(e.keep)}}],[{key:"fromDrop",value:function(e){return new n(sB.empty(),e,sB.empty())}},{key:"fromMovement",value:function(e,t){return new n(sB.of(e),t,sB.empty())}},{key:"fromCut",value:function(e,t,r){return new n(sB.of(e),t,sB.of(r))}}]),n}(bre);mde.encoder=new(function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"encodeMove",value:function(e){return{start:e.start.isPresent()?ire.encoder.encode(e.start.get()):null,landing:ire.encoder.encode(e.landing),keep:e.keep.isPresent()?ire.encoder.encode(e.keep.get()):null}}},{key:"decodeMove",value:function(e){var t=e;if("object"!=typeof e)throw new Error("Invalid encodedMove of type "+typeof e+"!");var n=ire.encoder.decode(t.landing);if(null==t.start)return mde.fromDrop(n);var r=ire.encoder.decode(t.start);if(null==t.keep)return mde.fromMovement(r,n);var i=ire.encoder.decode(t.keep);return mde.fromCut(r,n,i)}}]),n}(Kee));var kde=function(e){Gv(n,e);var t=$v(n);function n(){var e;return tp(this,n),(e=t.apply(this,arguments)).VERBOSE=!1,e}return rp(n,[{key:"applyLegalMove",value:function(e,t,n){return t.turn<40?t.applyLegalDrop(e.landing):t.applyLegalDeplacement(e,n)}},{key:"isLegal",value:function(e,t){rB(this.VERBOSE,{called:"SixRules.isLegal",move:e,state:t});var r=t.isIllegalLandingZone(e.landing,e.start);return r.isFailure()?r.toFailedFallible():t.turn<40?this.isLegalDrop(e,t):n.isLegalPhaseTwoMove(e,t)}},{key:"isLegalDrop",value:function(e,t){return!1===e.isDrop()?j5.failure(gde.NO_MOVEMENT_BEFORE_TURN_40()):j5.success(t.pieces.getKeySet())}},{key:"getGameStatus",value:function(e){var t=e.gameState,n=t.getCurrentOpponent(),r=[];if(e.move.isPresent()&&(r=this.getShapeVictory(e.move.get(),t)),6===r.length)return Are.getVictory(n);if(t.turn>39){var i=t.countPieces(),a=i[0],o=i[1];return a<6&&o<6?a<o?Are.ONE_WON:o<a?Are.ZERO_WON:Are.DRAW:a<6?Are.getDefeat(ete.ZERO):o<6?Are.getDefeat(ete.ONE):Are.ONGOING}return Are.ONGOING}},{key:"startSearchingVictorySources",value:function(){rB(this.VERBOSE,"SixRules.startSearchingVictorySources()"),this.currentVictorySource={typeSource:"LINE",index:-1}}},{key:"getShapeVictory",value:function(e,t){for(this.startSearchingVictorySources();this.hasNextVictorySource();){this.getNextVictorySource();var n=this.searchVictoryOnly(this.currentVictorySource,e,t);if(6===n.length)return n}return[]}},{key:"hasNextVictorySource",value:function(){return"CIRCLE"!==this.currentVictorySource.typeSource||5!==this.currentVictorySource.index}},{key:"getNextVictorySource",value:function(){if(5===this.currentVictorySource.index){var e;switch(this.currentVictorySource.typeSource){case"LINE":e="TRIANGLE_CORNER";break;case"TRIANGLE_CORNER":e="TRIANGLE_EDGE";break;default:e="CIRCLE"}this.currentVictorySource={typeSource:e,index:0}}else{var t=1;"LINE"===this.currentVictorySource.typeSource&&(t=2),this.currentVictorySource={typeSource:this.currentVictorySource.typeSource,index:this.currentVictorySource.index+t}}return this.currentVictorySource}},{key:"searchVictoryOnly",value:function(e,t,n){var r=t.landing.getNext(n.offset,1);switch(rB(this.VERBOSE,{called:"SixRules.searchVictoryOnly",victorySource:e,move:t,state:n}),e.typeSource){case"LINE":return this.searchVictoryOnlyForLine(e.index,r,n);case"CIRCLE":return this.searchVictoryOnlyForCircle(e.index,r,n);case"TRIANGLE_CORNER":return this.searchVictoryOnlyForTriangleCorner(e.index,r,n);default:return this.searchVictoryOnlyForTriangleEdge(e.index,r,n)}}},{key:"searchVictoryOnlyForCircle",value:function(e,t,n){rB(this.VERBOSE,{called:"SixRules.searchVictoryOnlyForCircle",index:e,lastDrop:t,state:n});for(var r=n.getCurrentOpponent(),i=[t],a=t.getNext(lre.factory.all[e],1);i.length<6;){if(n.getPieceAt(a)!==r)return[];var o=(e+i.length)%6;i.push(a),a=a.getNext(lre.factory.all[o],1)}return i}},{key:"searchVictoryOnlyForLine",value:function(e,t,n){for(var r=n.getCurrentOpponent(),i=lre.factory.all[e],a=t.getNext(i,1),o=[t],s=!1;o.length<6;){if(n.getPieceAt(a)===r)o.push(a);else{if(s)return[];s=!0,i=i.getOpposite(),a=a.getNext(i,o.length)}a=a.getNext(i,1)}return o}},{key:"searchVictoryOnlyForTriangleCorner",value:function(e,t,n){rB(this.VERBOSE,{called:"SixRules.searchVictoryTriangleCornerOnly",index:e,lastDrop:t,state:n});for(var r=n.getCurrentOpponent(),i=lre.factory.all[e],a=[t],o=t.getNext(i,1);a.length<6;){if(n.getPieceAt(o)!==r)return[];a.length%2==0&&(i=lre.factory.all[(e+a.length)%6]),a.push(o),o=o.getNext(i,1)}return a}},{key:"searchVictoryOnlyForTriangleEdge",value:function(e,t,n){rB(this.VERBOSE,{called:"SixRules.searchVictoryTriangleEdgeOnly",index:e,lastDrop:t,state:n});for(var r=n.getCurrentOpponent(),i=lre.factory.all[e],a=[t],o=t.getNext(i,1);a.length<6;){if(n.getPieceAt(o)!==r)return[];a.push(o),a.length%2==0&&(i=lre.factory.all[(e+a.length)%6]),o=o.getNext(i,1)}return a}}],[{key:"getLegalLandings",value:function(e){var t,n=new Hie,r=Qv(e.pieces.listKeys());try{for(r.s();!(t=r.n()).done;){var i,a=t.value,o=Qv(lre.factory.all);try{for(o.s();!(i=o.n()).done;){var s=i.value,u=a.getNext(s,1);e.getPieceAt(u)===Xee.NONE&&n.add(u)}}catch(c){o.e(c)}finally{o.f()}}}catch(c){r.e(c)}finally{r.f()}return n.toList()}},{key:"isLegalPhaseTwoMove",value:function(e,t){if(e.isDrop())return j5.failure(gde.CAN_NO_LONGER_DROP());switch(t.getPieceAt(e.start.get())){case Xee.NONE:return j5.failure(pre.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());case t.getCurrentOpponent():return j5.failure(pre.CANNOT_CHOOSE_OPPONENT_PIECE())}var r=yde.deplacePiece(t,e),i=yde.getGroups(r,e.start.get());if(n.isSplit(i)){var a=this.getBiggerGroups(i);return 1===a.size()?e.keep.isPresent()?j5.failure(gde.CANNOT_CHOOSE_TO_KEEP()):j5.success(a.getAnyElement().get()):this.moveKeepBiggerGroup(e.keep,a,r)}return j5.success(new Hie)}},{key:"isSplit",value:function(e){return e.size()>1}},{key:"getBiggerGroups",value:function(e){var t,n=0,r=new kre,i=Qv(e);try{for(i.s();!(t=i.n()).done;){var a=t.value,o=a.size();o>n?(n=o,r=new kre([a])):o===n&&r.add(a)}}catch(s){i.e(s)}finally{i.f()}return r}},{key:"moveKeepBiggerGroup",value:function(e,t,n){if(e.isAbsent())return j5.failure(gde.MUST_CUT());if(n.get(e.get()).isAbsent())return j5.failure(gde.CANNOT_KEEP_EMPTY_COORD());var r,i=e.get(),a=Qv(t);try{for(a.s();!(r=a.n()).done;){var o=r.value;if(o.contains(i))return j5.success(o)}}catch(s){a.e(s)}finally{a.f()}return j5.failure(gde.MUST_CAPTURE_BIGGEST_GROUPS())}}]),n}(Rre),_de=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"calculateBoardValue",value:function(e,t){this.startSearchingVictorySources();for(var n={status:Pre.DEFAULT,victory:sB.empty(),preVictory:sB.empty(),sum:0};this.hasNextVictorySource();){var r,i=this.getNextVictorySource();if((r=n.status===Pre.PRE_VICTORY?this.searchVictoryOnly(i,e,t):this.getBoardInfo(i,e,t,n)).status===Pre.VICTORY)return r;n={status:r.status,victory:sB.empty(),preVictory:r.preVictory,sum:n.sum+r.sum}}return n}}]),n}(gre),wde=function(e){Gv(n,e);var t=$v(n);function n(e,r){var i;return tp(this,n),(i=t.call(this,e)).value=e,i.preVictory=r,i}return rp(n)}(yre),Cde=function(e){Gv(n,e);var t=$v(n);function n(){var e;return tp(this,n),(e=t.apply(this,arguments)).VERBOSE=!1,e}return rp(n,[{key:"getListMoves",value:function(e){var t=n.get(),r=e.getOwnValue(t);if(r.preVictory.isPresent())return e.gameState.turn<40?this.createForcedDrop(r):this.createForcedDeplacement(e,r);var i=kde.getLegalLandings(e.gameState);return e.gameState.turn<40?this.getListDrop(i):this.getListDeplacement(e.gameState,i)}},{key:"createForcedDrop",value:function(e){rB(this.VERBOSE,{called:"SixMinimax.createForceDrop",unheritance:e});var t=[],n=mde.fromDrop(e.preVictory.get());return t.push(n),t}},{key:"createForcedDeplacement",value:function(e,t){rB(this.VERBOSE,{called:"SixRules.createForcedDeplacement",node:e});var n=this.getSafelyMovablePieceOrFirstOne(e),r=[t.preVictory.get()];return this.getDeplacementFrom(e.gameState,n,r)}},{key:"getDeplacementFrom",value:function(e,t,n){var r,i=[],a=Qv(t);try{for(a.s();!(r=a.n()).done;){var o,s=r.value,u=Qv(n);try{for(u.s();!(o=u.n()).done;){var c=o.value,l=mde.fromMovement(s,c);if(e.isCoordConnected(c,sB.of(s))){var h=yde.deplacePiece(e,l),f=yde.getGroups(h,l.start.get());if(kde.isSplit(f)){var d,v=Qv(f);try{for(v.s();!(d=v.n()).done;){var p=d.value.getAnyElement().get(),g=mde.fromCut(s,c,p);i.push(g)}}catch(y){v.e(y)}finally{v.f()}}else i.push(l)}}}catch(y){u.e(y)}finally{u.f()}}}catch(y){a.e(y)}finally{a.f()}return i}},{key:"getSafelyMovablePieceOrFirstOne",value:function(e){var t,n=e.gameState,r=n.pieces.reverse(),i=n.getCurrentPlayer(),a=r.get(i).get(),o=a.getAnyElement().get(),s=[],u=Qv(a);try{for(u.s();!(t=u.n()).done;){var c=t.value;!1===this.isPieceBlockingAVictory(n,c)&&s.push(c)}}catch(l){u.e(l)}finally{u.f()}return new Hie(0===s.length?[o]:s)}},{key:"isPieceBlockingAVictory",value:function(e,t){var n=e.switchPiece(t),r=mde.fromDrop(t);for(this.startSearchingVictorySources();this.hasNextVictorySource();)if(this.currentVictorySource=this.getNextVictorySource(),this.searchVictoryOnly(this.currentVictorySource,r,n).status===Pre.VICTORY)return!0;return!1}},{key:"getListDrop",value:function(e){var t,n=[],r=Qv(e);try{for(r.s();!(t=r.n()).done;){var i=t.value,a=mde.fromDrop(i);n.push(a)}}catch(o){r.e(o)}finally{r.f()}return n}},{key:"getListDeplacement",value:function(e,t){var n=e.getCurrentPlayer(),r=e.pieces.reverse().get(n).get();return this.getDeplacementFrom(e,r,t)}},{key:"getBoardValue",value:function(e){var t=e.move,n=e.gameState,r=n.getCurrentOpponent(),i=r.getVictoryValue(),a={status:Pre.DEFAULT,victory:sB.empty(),preVictory:sB.empty(),sum:0};t.isPresent()&&(a=this.calculateBoardValue(t.get(),n));var o=sB.empty();if(a.status===Pre.DEFAULT&&a.preVictory.isPresent()&&(o=sB.of(a.preVictory.get())),a.status===Pre.VICTORY)return new wde(i,sB.empty());if(n.turn>39){var s=n.countPieces(),u=s[0],c=s[1];return u<6&&c<6?new wde(u<c?ete.ONE.getVictoryValue():c<u?ete.ZERO.getVictoryValue():0,sB.empty()):u<6?new wde(ete.ZERO.getDefeatValue(),sB.empty()):c<6?new wde(ete.ONE.getDefeatValue(),sB.empty()):new wde(u-c,o)}return new wde(a.status===Pre.PRE_VICTORY?r.getPreVictory():a.sum*r.getScoreModifier(),o)}},{key:"startSearchingVictorySources",value:function(){rB(this.VERBOSE,"SixRules.startSearchingVictorySources()"),this.currentVictorySource={typeSource:"LINE",index:-1}}},{key:"hasNextVictorySource",value:function(){return"CIRCLE"!==this.currentVictorySource.typeSource||5!==this.currentVictorySource.index}},{key:"getNextVictorySource",value:function(){if(5===this.currentVictorySource.index){var e;switch(this.currentVictorySource.typeSource){case"LINE":e="TRIANGLE_CORNER";break;case"TRIANGLE_CORNER":e="TRIANGLE_EDGE";break;default:e="CIRCLE"}this.currentVictorySource={typeSource:e,index:0}}else{var t=1;"LINE"===this.currentVictorySource.typeSource&&(t=2),this.currentVictorySource={typeSource:this.currentVictorySource.typeSource,index:this.currentVictorySource.index+t}}return this.currentVictorySource}},{key:"searchVictoryOnly",value:function(e,t,n){var r=t.landing.getNext(n.offset,1);switch(rB(this.VERBOSE,{called:"SixRules.searchVictoryOnly",victorySource:e,move:t,state:n}),e.typeSource){case"LINE":return this.searchVictoryOnlyForLine(e.index,r,n);case"CIRCLE":return this.searchVictoryOnlyForCircle(e.index,r,n);case"TRIANGLE_CORNER":return this.searchVictoryOnlyForTriangleCorner(e.index,r,n);default:return this.searchVictoryOnlyForTriangleEdge(e.index,r,n)}}},{key:"searchVictoryOnlyForCircle",value:function(e,t,n){rB(this.VERBOSE,{called:"SixRules.searchVictoryOnlyForCircle",index:e,lastDrop:t,state:n});for(var r=n.getCurrentOpponent(),i=[t],a=t.getNext(lre.factory.all[e],1);i.length<6;){if(n.getPieceAt(a)!==r)return{status:Pre.PRE_VICTORY,victory:sB.empty(),preVictory:sB.empty(),sum:0};var o=(e+i.length)%6;i.push(a),a=a.getNext(lre.factory.all[o],1)}return{status:Pre.VICTORY,victory:sB.of(i),preVictory:sB.empty(),sum:0}}},{key:"searchVictoryOnlyForLine",value:function(e,t,n){for(var r=n.getCurrentOpponent(),i=lre.factory.all[e],a=t.getNext(i,1),o=[t],s=!1;o.length<6;){if(n.getPieceAt(a)===r)o.push(a);else{if(s)return{status:Pre.PRE_VICTORY,victory:sB.empty(),preVictory:sB.empty(),sum:0};s=!0,i=i.getOpposite(),a=a.getNext(i,o.length-1)}a=a.getNext(i,1)}return{status:Pre.VICTORY,victory:sB.of(o),preVictory:sB.empty(),sum:0}}},{key:"searchVictoryOnlyForTriangleCorner",value:function(e,t,n){rB(this.VERBOSE,{called:"SixRules.searchVictoryTriangleCornerOnly",index:e,lastDrop:t,state:n});for(var r=n.getCurrentOpponent(),i=lre.factory.all[e],a=[t],o=t.getNext(i,1);a.length<6;){if(n.getPieceAt(o)!==r)return{status:Pre.PRE_VICTORY,victory:sB.empty(),preVictory:sB.empty(),sum:0};a.length%2==0&&(i=lre.factory.all[(e+a.length)%6]),a.push(o),o=o.getNext(i,1)}return{status:Pre.VICTORY,victory:sB.of(a),preVictory:sB.empty(),sum:0}}},{key:"searchVictoryOnlyForTriangleEdge",value:function(e,t,n){rB(this.VERBOSE,{called:"SixRules.searchVictoryTriangleEdgeOnly",index:e,lastDrop:t,state:n});for(var r=n.getCurrentOpponent(),i=lre.factory.all[e],a=[t],o=t.getNext(i,1);a.length<6;){if(n.getPieceAt(o)!==r)return{status:Pre.PRE_VICTORY,victory:sB.empty(),preVictory:sB.empty(),sum:0};a.push(o),a.length%2==0&&(i=lre.factory.all[(e+a.length)%6]),o=o.getNext(i,1)}return{status:Pre.VICTORY,victory:sB.of(a),preVictory:sB.empty(),sum:0}}},{key:"getBoardInfo",value:function(e,t,n,r){rB(this.VERBOSE,{called:"SixRules.getBoardInfo",victorySource:e,move:t,state:n,boardInfo:r});var i=t.landing.getNext(n.offset,1);switch(e.typeSource){case"CIRCLE":return this.getBoardInfoForCircle(e.index,i,n,r);case"LINE":return this.getBoardInfoForLine(e.index,i,n,r);case"TRIANGLE_CORNER":return this.getBoardInfoForTriangleCorner(e.index,i,n,r);default:return this.getBoardInfoForTriangleEdge(e.index,i,n,r)}}},{key:"getBoardInfoForCircle",value:function(e,t,n,r){rB(this.VERBOSE,{called:"SixMinimaw.getBoardInfoForCircle",index:e,lastDrop:t,state:n,boardInfo:r});for(var i=n.getCurrentPlayer(),a=[t],o=t.getNext(lre.factory.all[e],1),s=0,u=sB.empty();a.length<6;){var c=n.getPieceAt(o);if(c===i)return r;var l=(e+a.length)%6;a.push(o);var h=lre.factory.all[l];c===Xee.NONE?(s+=.16,u=sB.of(o)):s++,o=o.getNext(h,1)}return this.getBoardInfoResult(s,u,a,r)}},{key:"getBoardInfoResult",value:function(e,t,n,r){var i=r.preVictory;if(4.16===e){if(rB(this.VERBOSE,"5+1 found!"),i.isPresent()&&!1===i.equals(t))return{status:Pre.PRE_VICTORY,victory:sB.empty(),preVictory:sB.empty(),sum:0};i=t}else if(5===e)return{status:Pre.VICTORY,victory:sB.of(n),preVictory:sB.empty(),sum:0};return{status:r.status,victory:sB.empty(),preVictory:i,sum:r.sum+e}}},{key:"getBoardInfoForLine",value:function(e,t,n,r){rB(this.VERBOSE,{called:"SixRules.getBoardInfoForLine",index:e,lastDrop:t,state:n,boardInfo:r});for(var i=lre.factory.all[e],a=t.getPrevious(i,5),o=[],s=[],u=sB.empty(),c=0;c<6;c++){var l=this.updateEncounterAndReturnLastEmpty(n,a,s);l.isPresent()&&(u=l),o.push(a),a=a.getNext(i,1)}for(var h=r.status,f=r.preVictory,d=0,v=0;d<6;){var p=s.reduce(function(e,t){return e+t});if(6===p)return{status:Pre.VICTORY,victory:sB.of(o),preVictory:sB.empty(),sum:0};5.16===p&&h===Pre.DEFAULT&&(f.isPresent()?(X5(!1===f.equals(u),"Impossible to have point aligned with differents line to a same point"),h=Pre.PRE_VICTORY):f=u),v=Math.max(v,p),(o=o.slice(1,6)).push(a),s=s.slice(1,6);var g=this.updateEncounterAndReturnLastEmpty(n,a,s);g.isPresent()&&(u=g),d++,a=a.getNext(i,1)}var y={status:h,victory:sB.of(o),preVictory:f,sum:v};return this.getBoardInfoResult(v,u,o,y)}},{key:"updateEncounterAndReturnLastEmpty",value:function(e,t,n){var r=e.getCurrentPlayer();switch(e.getPieceAt(t)){case r:return n.push(-7),sB.empty();case Xee.NONE:return n.push(.16),sB.of(t);default:return n.push(1),sB.empty()}}},{key:"getBoardInfoForTriangleCorner",value:function(e,t,n,r){rB(this.VERBOSE,{called:"SixRules.getBoardInfoForTriangleCorner",index:e,lastDrop:t,state:n,boardInfo:r});for(var i=n.getCurrentPlayer(),a=lre.factory.all[e],o=[t],s=t.getNext(a,1),u=0,c=sB.empty();o.length<6;){var l=n.getPieceAt(s);if(l===i)return r;l===Xee.NONE?(u+=.16,c=sB.of(s)):u++,o.length%2==0&&(a=lre.factory.all[(e+o.length)%6]),o.push(s),s=s.getNext(a,1)}return this.getBoardInfoResult(u,c,o,r)}},{key:"getBoardInfoForTriangleEdge",value:function(e,t,n,r){rB(this.VERBOSE,{called:"SixRules.getBoardInfoForTriangleEdge",index:e,lastDrop:t,state:n,boardInfo:r});for(var i=n.getCurrentPlayer(),a=lre.factory.all[e],o=[t],s=t.getNext(a,1),u=0,c=sB.empty();o.length<6;){var l=n.getPieceAt(s);if(l===i)return r;l===Xee.NONE?(u+=.16,c=sB.of(s)):u++,o.push(s),o.length%2==0&&(a=lre.factory.all[(e+o.length)%6]),s=s.getNext(a,1)}return this.getBoardInfoResult(u,c,o,r)}}],[{key:"get",value:function(){if(null==n.INSTANCE){var e=new kde(yde);n.INSTANCE=new n(e,"SixMinimax")}return n.INSTANCE}}]),n}(_de),bde=Xee.NONE.value,Ede=ete.ZERO.value,Sde=ete.ONE.value,Pde=function(){var e=rp(function e(){tp(this,e)});return e.MOVEMENT_NOT_DISCONNECTING=function(){return $localize(xu||(xu=Rv(["This move does not disconnect your opponent's pieces. Try again with another piece."])))},e.MOVEMENT_SELF_DISCONNECTING=function(){return $localize(Au||(Au=Rv(["You lost one of your pieces during this move. There is a way to disconnect an opponent's piece without losing any of yours, try again!"])))},e}(),Ode=rp(function e(){tp(this,e),this.tutorial=[Lre.informational($localize(Ru||(Ru=Rv(["Six"]))),$localize(Nu||(Nu=Rv(["Six is a game without board, where pieces are placed on the side of each other, in a contiguous block.\n        Each player has 21 pieces, with one for each player already on the board.\n        The goal of the game is to form one of the three winning shapes with your pieces."]))),yde.getInitialState()),Lre.fromMove($localize(Mu||(Mu=Rv(["Victory (line)"]))),$localize(Du||(Du=Rv(["On this board, by putting your piece at the right place, you can align six of your pieces and win the game<br/><br/>\n        Find the victory. You're playing Dark."]))),yde.fromRepresentation([[Ede,Sde,Sde,Sde,Sde,Ede],[bde,Ede,Sde,bde,Ede,bde],[Sde,Sde,Ede,bde,bde,bde],[bde,bde,Ede,bde,bde,bde],[bde,Ede,bde,bde,bde,bde],[Ede,bde,bde,bde,bde,bde]],0),[mde.fromDrop(new ire(3,2))],$localize(Lu||(Lu=Rv(["Congratulations!"]))),$localize(Fu||(Fu=Rv(["Failed!"])))),Lre.fromMove($localize(Bu||(Bu=Rv(["Victory (circle)"]))),$localize(Vu||(Vu=Rv(["On this board, by putting your piece at the right place, you can form a circle with six of your pieces and win the game.<br/><br/>\n        Find the victory. You're playing Dark."]))),yde.fromRepresentation([[bde,bde,bde,Sde,bde,bde],[bde,bde,Sde,Sde,Ede,Ede],[bde,Sde,bde,Ede,Sde,bde],[Sde,Ede,Ede,Ede,Ede,Sde]],0),[mde.fromDrop(new ire(5,2))],$localize(Uu||(Uu=Rv(["Congratulations! Note that if a piece is inside the circle, it does not change anything."]))),$localize(zu||(zu=Rv(["Failed!"])))),Lre.fromMove($localize(Hu||(Hu=Rv(["Victory (triangle)"]))),$localize(Gu||(Gu=Rv(["On this board, by putting your piece at the right place, you can form a triangle with six of your pieces and win the game.<br/><br/>\n        Find the victory. You're playing Dark."]))),yde.fromRepresentation([[bde,bde,bde,Sde,bde,bde],[bde,Ede,Sde,Ede,Ede,Ede],[bde,Ede,bde,Ede,Ede,bde],[Sde,Sde,Sde,bde,Sde,bde]],0),[mde.fromDrop(new ire(3,3))],$localize(qu||(qu=Rv(["Congratulations!"]))),$localize($u||($u=Rv(["Failed!"])))),Lre.fromPredicate($localize(Wu||(Wu=Rv(["Second phase"]))),$localize(ju||(ju=Rv(["After 40 turns, your pieces have all been placed and we move on to the second phase of the game.\n        You now have to move your pieces, paying attention not to remove a piece that was preventing the opponent's victory.\n        From now on, if after move, on or more pieces are disconnected from the largest group of pieces, these will be taken out of the game.<br/><br/>\n        You're playing Dark. Make a move that disconnects one of your opponent's pieces."]))),yde.fromRepresentation([[bde,bde,bde,bde,bde,bde,bde,Sde,bde],[bde,bde,bde,bde,bde,bde,Ede,bde,bde],[bde,bde,bde,bde,Ede,Ede,Ede,bde,bde],[bde,bde,bde,bde,Sde,Sde,bde,Sde,Ede],[bde,Ede,Sde,Sde,Ede,Ede,Sde,bde,bde],[Ede,Ede,Ede,Ede,Sde,Sde,Sde,Ede,bde],[Sde,Sde,Ede,bde,Sde,Sde,Ede,bde,bde],[bde,Ede,bde,Ede,Ede,bde,bde,bde,bde],[Sde,Sde,Sde,Sde,bde,bde,bde,bde,bde],[bde,Ede,bde,Sde,bde,bde,bde,bde,bde]],40),mde.fromMovement(new ire(6,1),new ire(5,1)),function(e,t){var n=t.countPieces();return 19===n[0]?18===n[1]?K5.SUCCESS:K5.failure(Pde.MOVEMENT_NOT_DISCONNECTING()):K5.failure(Pde.MOVEMENT_SELF_DISCONNECTING())},$localize(Zu||(Zu=Rv(["Congratulations, your opponent now has one piece less and you're closer to victory!"])))),Lre.fromPredicate($localize(Yu||(Yu=Rv(["Victory by disconnection"]))),$localize(Ku||(Ku=Rv(["During the second phase of the game, on top of normal victories (line, circle, triangle), you can win by disconnection.\n        If at any time, at least one player does not have enough pieces to win (less than 6), the game ends.\n        The one with the most pieces wins. In case they both have the same number of pieces, it's a draw.<br/><br/>\n        Here, you're playing Dark and you can win. Do it!"]))),yde.fromRepresentation([[bde,bde,bde,bde,bde,Sde],[bde,bde,bde,bde,Ede,Sde],[bde,bde,bde,Sde,Ede,Ede],[bde,bde,Ede,bde,Sde,Ede],[Sde,Sde,bde,bde,bde,Ede],[Ede,Sde,bde,bde,bde,bde],[Ede,bde,bde,bde,bde,bde]],40),mde.fromMovement(new ire(2,3),new ire(3,3)),function(e,t){return e.start.equalsValue(new ire(2,3))?K5.SUCCESS:K5.failure(Pde.MOVEMENT_NOT_DISCONNECTING())},$localize(Ju||(Ju=Rv(["Congratulations, you won!"])))),Lre.fromPredicate($localize(Qu||(Qu=Rv(["Special disconnection"]))),$localize(Xu||(Xu=Rv(["During a disconnection, two or more groups could have the same size,\n        in which case you will have to click on the group you wish to keep.<br/><br/>\n        You're playing Dark, play such a move!"]))),yde.fromRepresentation([[bde,bde,bde,bde,bde,Sde],[bde,bde,bde,bde,Ede,Sde],[bde,bde,bde,Sde,Ede,Ede],[Ede,bde,Ede,bde,bde,Sde],[Sde,Sde,bde,bde,bde,bde],[Ede,Ede,bde,bde,bde,bde],[Ede,bde,bde,bde,bde,bde]],40),mde.fromCut(new ire(2,3),new ire(2,5),new ire(2,5)),function(e,t){return e.keep.isAbsent()?K5.failure($localize(ec||(ec=Rv(["This move has not cut the board in two equal halves."])))):t.getPieceAt(e.landing.getNext(t.offset))===Xee.NONE?K5.failure($localize(tc||(tc=Rv(["Failed. You did cut the board in two but you kept the half where you're in minority. Therefore, you lost! Try again."])))):K5.SUCCESS},$localize(nc||(nc=Rv(["Congratulations, you won!"]))))]});function Tde(e,t){if(1&e){var n=pb();_m(),lb(0,"polyline",10),mb("click",function(){var e=$y(n).$implicit;return wb().onPieceClick(e)}),hb()}if(2&e){var r=t.$implicit,i=wb();bb("id","piece_",r.x,"_",r.y,""),ub("ngClass",i.getPieceClass(r)),tb("points",i.getHexaCoordsAt(r))}}function Ide(e,t){if(1&e){var n=pb();_m(),lb(0,"polyline",11),mb("click",function(){var e=$y(n).$implicit;return wb().onNeighborClick(e)}),hb()}if(2&e){var r=t.$implicit,i=wb();bb("id","neighbor_",r.x,"_",r.y,""),tb("points",i.getHexaCoordsAt(r))}}function xde(e,t){if(1&e){var n=pb();_m(),lb(0,"polyline",10),mb("click",function(){$y(n);var e=wb();return e.onPieceClick(e.chosenLanding.get())}),hb()}if(2&e){var r=wb();bb("id","chosenLanding_",r.chosenLanding.get().x,"_",r.chosenLanding.get().y,""),ub("ngClass",r.getPlayerClass(r.state.getCurrentPlayer())),tb("points",r.getHexaCoordsAt(r.chosenLanding.get()))}}function Ade(e,t){if(1&e&&(_m(),fb(0,"polyline",12)),2&e){var n=t.$implicit,r=wb();bb("id","disconnected_",n.x,"_",n.y,""),tb("points",r.getHexaCoordsAt(n))}}function Rde(e,t){if(1&e){var n=pb();_m(),lb(0,"polyline",13),mb("click",function(){$y(n);var e=wb();return e.onNeighborClick(e.leftCoord.get())}),hb()}if(2&e){var r=wb();bb("id","leftCoord_",r.leftCoord.get().x,"_",r.leftCoord.get().y,""),tb("points",r.getHexaCoordsAt(r.leftCoord.get()))}}function Nde(e,t){if(1&e){var n=pb();_m(),lb(0,"polyline",14),mb("click",function(){$y(n);var e=wb();return e.onPieceClick(e.lastDrop.get())}),hb()}if(2&e){var r=wb();bb("id","lastDrop_",r.lastDrop.get().x,"_",r.lastDrop.get().y,""),tb("points",r.getHexaCoordsAt(r.lastDrop.get()))}}function Mde(e,t){if(1&e){var n=pb();_m(),lb(0,"polyline",15),mb("click",function(){$y(n);var e=wb();return e.onPieceClick(e.selectedPiece.get())}),hb()}if(2&e){var r=wb();bb("id","selectedPiece_",r.selectedPiece.get().x,"_",r.selectedPiece.get().y,""),ub("ngClass",r.getSelectedPieceClass()),tb("points",r.getHexaCoordsAt(r.selectedPiece.get()))}}function Dde(e,t){if(1&e&&(_m(),fb(0,"polyline",16)),2&e){var n=t.$implicit,r=wb();bb("id","victoryCoord_",n.x,"_",n.y,""),tb("points",r.getHexaCoordsAt(n))}}function Lde(e,t){if(1&e){var n=pb();_m(),lb(0,"g",19),mb("click",function(){var e=$y(n).$implicit;return wb(2).onPieceClick(e)}),fb(1,"polyline",20),hb()}if(2&e){var r=t.$implicit,i=wb(2);Pw(1),bb("id","cuttable_",r.x,"_",r.y,""),tb("points",i.getHexaCoordsAt(r))}}function Fde(e,t){if(1&e&&(_m(),lb(0,"g",17),ab(1,Lde,2,3,"g",18),hb()),2&e){var n=t.$implicit;Pw(1),ub("ngForOf",n)}}var Bde=function(){var e=function(e){Gv(n,e);var t=$v(n);function n(e){var r;return tp(this,n),(r=t.call(this,e)).disconnecteds=[],r.cuttableGroups=[],r.leftCoord=sB.empty(),r.lastDrop=sB.empty(),r.selectedPiece=sB.empty(),r.chosenLanding=sB.empty(),r.nextClickShouldSelectGroup=!1,r.rules=new kde(yde),r.availableMinimaxes=[new Cde(r.rules,"SixMinimax")],r.encoder=mde.encoder,r.tutorial=(new Ode).tutorial,r.SPACE_SIZE=30,r.hexaLayout=new hre(1.5*r.SPACE_SIZE,new ire(2*r.SPACE_SIZE,0),vre.INSTANCE),r.updateBoard(),r}return rp(n,[{key:"cancelMoveAttempt",value:function(){this.selectedPiece=sB.empty(),this.chosenLanding=sB.empty(),this.cuttableGroups=[],this.nextClickShouldSelectGroup=!1,this.updateBoard()}},{key:"updateBoard",value:function(){this.state=this.rules.node.gameState,this.rules.node.move.isPresent()?this.showLastMove():(this.leftCoord=sB.empty(),this.lastDrop=sB.empty(),this.victoryCoords=[],this.disconnecteds=[]),this.pieces=this.state.pieces.listKeys(),this.neighbors=this.getEmptyNeighbors(),this.viewBox=this.getViewBox()}},{key:"getViewBox",value:function(){var e=this.mapAbstractCoordToCornerCoords(),t=this.getLimits(e);return t.minX-this.STROKE_WIDTH/2+" "+(t.minY-this.STROKE_WIDTH/2)+" "+(this.STROKE_WIDTH+t.maxX-t.minX)+" "+(this.STROKE_WIDTH+t.maxY-t.minY)}},{key:"mapAbstractCoordToCornerCoords",value:function(){var e,t=this,n=[],r=Qv(this.pieces.concat(this.disconnecteds).concat(this.neighbors).map(function(e){return t.hexaLayout.getHexaCoordsAt(e)}));try{for(r.s();!(e=r.n()).done;){var i=e.value;n=n.concat(i)}}catch(a){r.e(a)}finally{r.f()}return n}},{key:"getLimits",value:function(e){var t,n=Number.MIN_SAFE_INTEGER,r=Number.MIN_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER,a=Number.MAX_SAFE_INTEGER,o=Qv(e);try{for(o.s();!(t=o.n()).done;){var s=t.value;s.x<i&&(i=s.x),s.y<a&&(a=s.y),n=Math.max(n,s.x),r=Math.max(r,s.y)}}catch(u){o.e(u)}finally{o.f()}return{minX:i,minY:a,maxX:n,maxY:r}}},{key:"showLastMove",value:function(){var e=this.rules.node.move.get();this.lastDrop=sB.of(e.landing.getNext(this.state.offset,1)),this.leftCoord=!1===e.isDrop()?sB.of(e.start.get().getNext(this.state.offset,1)):sB.empty();var t=this.rules.node.gameState;this.rules.getGameStatus(this.rules.node).isEndGame&&(this.victoryCoords=this.rules.getShapeVictory(e,t)),this.disconnecteds=this.getDisconnected()}},{key:"getDisconnected",value:function(){var e,t=this,n=this.rules.node.mother.get().gameState.pieces.listKeys(),r=this.rules.node.gameState.pieces.listKeys(),i=[],a=Qv(n);try{var o=function(){var n=e.value;!1===t.rules.node.move.get().start.equalsValue(n)&&!1===r.some(function(e){return e.equals(n.getNext(t.state.offset,1))})&&i.push(n.getNext(t.state.offset,1))};for(a.s();!(e=a.n()).done;)o()}catch(u){a.e(u)}finally{a.f()}var s=this.lastDrop.get();return!1===this.pieces.some(function(e){return e.equals(s)})&&!1===r.some(function(e){return e.equals(s)})&&i.push(s),i}},{key:"getEmptyNeighbors",value:function(){var e=kde.getLegalLandings(this.state);if(this.chosenLanding.isPresent()){var t=this.chosenLanding.get();e=e.filter(function(e){return!1===e.equals(t)})}return e}},{key:"getPieceClass",value:function(e){var t=this.rules.node.gameState.getPieceAt(e);return this.getPlayerClass(t)}},{key:"onPieceClick",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#piece_"+e.x+"_"+e.y)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:if(!(t.state.turn<40)){n.next=5;break}return n.abrupt("return",t.cancelMove(gde.NO_MOVEMENT_BEFORE_TURN_40()));case 5:if(!t.chosenLanding.isAbsent()){n.next=7;break}return n.abrupt("return",t.state.getPieceAt(e)===t.state.getCurrentOpponent()?t.cancelMove(pre.CANNOT_CHOOSE_OPPONENT_PIECE()):(t.selectedPiece=sB.of(e),K5.SUCCESS));case 7:return i=mde.fromCut(t.selectedPiece.get(),t.chosenLanding.get(),e),n.abrupt("return",t.chooseMove(i,t.state));case 9:case"end":return n.stop()}},n)}))()}},{key:"onNeighborClick",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#neighbor_"+e.x+"_"+e.y)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:if(!t.nextClickShouldSelectGroup){n.next=5;break}return n.abrupt("return",t.cancelMove(gde.MUST_CUT()));case 5:if(!(t.state.turn<40)){n.next=7;break}return n.abrupt("return",t.chooseMove(mde.fromDrop(e),t.state));case 7:if(!t.selectedPiece.isAbsent()){n.next=9;break}return n.abrupt("return",t.cancelMove(gde.CAN_NO_LONGER_DROP()));case 9:return i=mde.fromMovement(t.selectedPiece.get(),e),a=kde.isLegalPhaseTwoMove(i,t.state),n.abrupt("return",t.neededCutting(a)?(t.chosenLanding=sB.of(e),t.moveVirtuallyPiece(),t.showCuttable(),t.nextClickShouldSelectGroup=!0,K5.SUCCESS):t.chooseMove(i,t.state));case 11:case"end":return n.stop()}},n)}))()}},{key:"neededCutting",value:function(e){return e.isFailure()&&e.getReason()===gde.MUST_CUT()}},{key:"moveVirtuallyPiece",value:function(){var e=this.selectedPiece.get();this.pieces=this.pieces.filter(function(t){return!1===t.equals(e)}),this.neighbors=this.getEmptyNeighbors()}},{key:"showCuttable",value:function(){var e=mde.fromMovement(this.selectedPiece.get(),this.chosenLanding.get()),t=yde.deplacePiece(this.state,e),n=yde.getGroups(t,e.start.get()),r=kde.getBiggerGroups(n);this.cuttableGroups=[];var i,a=Qv(r);try{for(a.s();!(i=a.n()).done;){var o=i.value;this.cuttableGroups.push(o.toList())}}catch(s){a.e(s)}finally{a.f()}}},{key:"getSelectedPieceClass",value:function(){return this.chosenLanding.isPresent()?"moved":"selected"}}]),n}(ure);return e.\u0275fac=function(t){return new(t||e)(sb(ore))},e.\u0275cmp=ey({type:e,selectors:[["app-six"]],features:[zC],decls:10,vars:10,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],["class","base round",3,"id","ngClass","click",4,"ngFor","ngForOf"],["class","base round",3,"id","click",4,"ngFor","ngForOf"],["class","base round",3,"id","ngClass","click",4,"ngIf"],["class","base round captured",3,"id",4,"ngFor","ngForOf"],["class","base round moved mid-stroke",3,"id","click",4,"ngIf"],["class","base no-fill round last-move mid-stroke",3,"id","click",4,"ngIf"],["class","base no-fill round",3,"id","ngClass","click",4,"ngIf"],["class","base no-fill round highlighted mid-stroke",3,"id",4,"ngFor","ngForOf"],["pointer-events","fill","class","capturable",4,"ngFor","ngForOf"],[1,"base","round",3,"id","ngClass","click"],[1,"base","round",3,"id","click"],[1,"base","round","captured",3,"id"],[1,"base","round","moved","mid-stroke",3,"id","click"],[1,"base","no-fill","round","last-move","mid-stroke",3,"id","click"],[1,"base","no-fill","round",3,"id","ngClass","click"],[1,"base","no-fill","round","highlighted","mid-stroke",3,"id"],["pointer-events","fill",1,"capturable"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],["stroke-linecap","round",1,"no-fill",3,"id"]],template:function(e,t){1&e&&(_m(),lb(0,"svg",0),ab(1,Tde,1,4,"polyline",1),ab(2,Ide,1,3,"polyline",2),ab(3,xde,1,4,"polyline",3),ab(4,Ade,1,3,"polyline",4),ab(5,Rde,1,3,"polyline",5),ab(6,Nde,1,3,"polyline",6),ab(7,Mde,1,4,"polyline",7),ab(8,Dde,1,3,"polyline",8),ab(9,Fde,2,1,"g",9),hb()),2&e&&(tb("viewBox",t.viewBox),Pw(1),ub("ngForOf",t.pieces),Pw(1),ub("ngForOf",t.neighbors),Pw(1),ub("ngIf",t.chosenLanding.isPresent()),Pw(1),ub("ngForOf",t.disconnecteds),Pw(1),ub("ngIf",t.leftCoord.isPresent()),Pw(1),ub("ngIf",t.lastDrop.isPresent()),Pw(1),ub("ngIf",t.selectedPiece.isPresent()),Pw(1),ub("ngForOf",t.victoryCoords),Pw(1),ub("ngForOf",t.cuttableGroups))},directives:[AT,NT,IT],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Vde=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"getMaximalDistance",value:function(){return 9}}],[{key:"of",value:function(e,t){return new n(e,t)}},{key:"from",value:function(e,t){try{var r=new n(e,t);return j5.success(r)}catch(r){return j5.failure(r.message)}}}]),n}(Iie);Vde.encoder=Oie.getEncoder(9,9,Vde.of);var Ude={CASTLE_IS_LEFT_FOR_GOOD:!1,BORDER_CAN_SURROUND_KING:!0,CENTRAL_THRONE_CAN_SURROUND_KING:!1,KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED:!1,WIDTH:9,INVADER:ete.ZERO},zde=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"from",value:function(e,t){return new n(e,t)}}],[{key:"getInitialState",value:function(){var e=Rie.UNOCCUPIED,t=Rie.INVADERS,r=Rie.DEFENDERS;return new n([[e,e,e,t,t,t,e,e,e],[e,e,e,e,t,e,e,e,e],[e,e,e,e,r,e,e,e,e],[t,e,e,e,r,e,e,e,t],[t,t,r,r,Rie.PLAYER_ONE_KING,r,r,t,t],[t,e,e,e,r,e,e,e,t],[e,e,e,e,r,e,e,e,e],[e,e,e,e,t,e,e,e,e],[e,e,e,t,t,t,e,e,e]],0)}}]),n}(Mie),Hde=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.call(this,zde,Ude,Vde.of)}return rp(n,null,[{key:"get",value:function(){return null==n.singleton&&(n.singleton=new n),xre.ruler=this.singleton,n.singleton}}]),n}(Lie),Gde=Rie.UNOCCUPIED,qde=Rie.INVADERS,$de=Rie.DEFENDERS,Wde=Rie.PLAYER_ONE_KING,jde=rp(function e(){tp(this,e),this.tutorial=[Lre.informational($localize(rc||(rc=Rv(["Goal of the game"]))),$localize(ic||(ic=Rv(["Tablut is a strategy game that was played by the Vikings.\n        The goal of the game is different for each player.\n        The attacker plays first. Its pieces (dark) are close to the edges.\n        Its goal is to capture the king, which is in the center of the board.\n        The defender plays second. Its pieces (light) are in the middle.\n        Its goal is to move the king on one of the 4 thrones in the corners.\n        Note that the square in which the king starts, in the center of the board, is also a throne."]))),zde.getInitialState()),Lre.anyMove($localize(ac||(ac=Rv(["Moving"]))),$localize(oc||(oc=Rv(["All pieces move the same way.\n        Similarly to a rook in chess, a piece can move:\n        <ol>\n            <li>By as many squares as you want.</li>\n            <li>Without going over another piece or stopping on another piece.</li>\n            <li>Horizontally or vertically.</li>\n            <li>Only the king can land on a throne.</li>\n        </ol>\n        To move a piece, click on it and then on its landing square.<br/><br/>\n        You're playing Dark, do the first move."]))),zde.getInitialState(),Vde.of(new ire(4,1),new ire(1,1)),$localize(sc||(sc=Rv(["Congratulations!"])))),Lre.fromMove($localize(uc||(uc=Rv(["Capturing a soldier (1/2)"]))),$localize(cc||(cc=Rv(["All pieces, attackers and defenders, except the king, are soldiers. To capture them, they have to be sandwiched between two of your pieces. By getting too close, an attacker's soldier is in danger.<br/><br/>Capture it."]))),new zde([[Gde,Gde,Gde,qde,qde,qde,Gde,Gde,Gde],[Gde,Gde,Gde,Gde,qde,Gde,Gde,Gde,Gde],[Gde,Gde,Gde,Gde,$de,Gde,Gde,Gde,Gde],[Gde,Gde,Gde,qde,$de,Gde,Gde,Gde,qde],[qde,qde,$de,$de,Wde,$de,$de,qde,qde],[Gde,Gde,Gde,Gde,$de,Gde,Gde,Gde,qde],[Gde,Gde,Gde,Gde,$de,Gde,Gde,Gde,Gde],[Gde,Gde,Gde,Gde,qde,Gde,Gde,Gde,Gde],[Gde,Gde,Gde,qde,qde,qde,Gde,Gde,Gde]],1),[Vde.of(new ire(2,4),new ire(2,3)),Vde.of(new ire(4,2),new ire(3,2))],$localize(lc||(lc=Rv(["Congratulations, that will teach him a lesson!"]))),$localize(hc||(hc=Rv(["Failed, you missed an opportunity to capture a piece of the opponent."])))),Lre.fromMove($localize(fc||(fc=Rv(["Capturing a soldier (2/2)"]))),$localize(dc||(dc=Rv(["A second way to capture a soldier is to sandwich it against an empty throne. The king has moved and endangered one of its soldiers.<br/><br/>Capture it."]))),new zde([[Gde,Gde,Gde,qde,qde,qde,Gde,Gde,Gde],[Gde,Gde,Gde,Gde,qde,Gde,Gde,Gde,Gde],[Gde,Gde,Gde,Gde,$de,Gde,Gde,Gde,Gde],[Gde,Gde,$de,Gde,Wde,Gde,$de,Gde,qde],[qde,qde,Gde,$de,Gde,$de,$de,qde,qde],[Gde,Gde,Gde,Gde,$de,Gde,Gde,Gde,qde],[Gde,Gde,Gde,Gde,$de,Gde,Gde,Gde,Gde],[Gde,Gde,Gde,Gde,qde,Gde,Gde,Gde,Gde],[Gde,Gde,Gde,qde,qde,qde,Gde,Gde,Gde]],12),[Vde.of(new ire(1,4),new ire(2,4))],$localize(vc||(vc=Rv(["Congratulations, one less defender. But keep an eye on the king, it is the most important."]))),$localize(pc||(pc=Rv(["Failed, you did not do the expected move."])))),Lre.fromMove($localize(gc||(gc=Rv(["Capturing the king (1/2)"]))),$localize(yc||(yc=Rv(["To capture the king, two soldiers are not enough.\n        For the first solution, the four squares neighbor to the king (horizontally and vertically) must be occupied by your soldiers.\n        This also works if the king is on the throne.<br/><br/>\n        Capture the king."]))),new zde([[Gde,Gde,Gde,Gde,Gde,Gde,Gde,Gde,Gde],[Gde,Gde,Gde,Gde,Gde,Gde,Gde,Gde,Gde],[Gde,Gde,Gde,Gde,Gde,Gde,Gde,Gde,Gde],[Gde,qde,Gde,Gde,Gde,Gde,Gde,Gde,Gde],[qde,Wde,Gde,qde,Gde,Gde,Gde,Gde,Gde],[Gde,qde,Gde,Gde,Gde,Gde,Gde,Gde,Gde],[Gde,Gde,Gde,Gde,Gde,Gde,Gde,Gde,Gde],[Gde,Gde,Gde,Gde,Gde,Gde,Gde,Gde,Gde],[Gde,Gde,Gde,Gde,Gde,Gde,Gde,Gde,Gde]],72),[Vde.of(new ire(3,4),new ire(2,4))],$localize(mc||(mc=Rv(["Congratulations, you won!"]))),$localize(kc||(kc=Rv(["Failed, you let the king run away."])))),Lre.fromMove($localize(_c||(_c=Rv(["Capturing the king (2/2)"]))),$localize(wc||(wc=Rv(["Another way to capture the king is to immobilize it against an edge of the board.\n        Note that the king cannot be captured next to a throne.<br/><br/>\n        Capture the king."]))),new zde([[Gde,Gde,qde,Wde,qde,Gde,Gde,Gde,Gde],[Gde,Gde,Gde,Gde,Gde,Gde,Gde,Gde,Gde],[Gde,Gde,Gde,Gde,Gde,Gde,Gde,Gde,Gde],[Gde,Gde,Gde,qde,Gde,Gde,Gde,Gde,Gde],[Gde,Gde,Gde,Gde,Gde,Gde,Gde,Gde,Gde],[Gde,Gde,Gde,Gde,Gde,Gde,Gde,Gde,Gde],[Gde,Gde,Gde,Gde,Gde,Gde,Gde,Gde,Gde],[Gde,Gde,Gde,Gde,Gde,Gde,Gde,Gde,Gde],[Gde,Gde,Gde,Gde,Gde,Gde,Gde,Gde,Gde]],72),[Vde.of(new ire(3,3),new ire(3,1))],$localize(Cc||(Cc=Rv(["The king is dead, long live the king. Congratulations, you won."]))),$localize(bc||(bc=Rv(["Failed!"]))))]});function Zde(e,t){if(1&e){var n=pb();_m(),lb(0,"polyline",6),mb("click",function(){$y(n);var e=wb(2).index,t=wb().index;return wb().onClick(e,t)}),hb()}if(2&e){var r=wb(2).index,i=wb().index,a=wb();tb("transform","translate("+r*a.SPACE_SIZE+" "+i*a.SPACE_SIZE+")")}}function Yde(e,t){if(1&e){var n=pb();_m(),lb(0,"polyline",7),mb("click",function(){$y(n);var e=wb(2).index,t=wb().index;return wb().onClick(e,t)}),hb()}if(2&e){var r=wb(2).index,i=wb().index,a=wb();tb("transform","translate("+r*a.SPACE_SIZE+" "+i*a.SPACE_SIZE+")")}}function Kde(e,t){if(1&e&&(_m(),lb(0,"g"),ab(1,Zde,1,1,"polyline",4),ab(2,Yde,1,1,"ng-template",null,5,OP),hb()),2&e){var n=ob(3),r=wb().index,i=wb().index,a=wb();Pw(1),ub("ngIf",a.isCentralThrone(r,i))("ngIfElse",n)}}function Jde(e,t){if(1&e){var n=pb();_m(),lb(0,"g"),lb(1,"line",11),mb("click",function(){$y(n);var e=wb(2).index,t=wb().index;return wb().onClick(e,t)}),hb(),lb(2,"line",11),mb("click",function(){$y(n);var e=wb(2).index,t=wb().index;return wb().onClick(e,t)}),hb(),lb(3,"line",11),mb("click",function(){$y(n);var e=wb(2).index,t=wb().index;return wb().onClick(e,t)}),hb(),lb(4,"line",11),mb("click",function(){$y(n);var e=wb(2).index,t=wb().index;return wb().onClick(e,t)}),hb(),lb(5,"line",11),mb("click",function(){$y(n);var e=wb(2).index,t=wb().index;return wb().onClick(e,t)}),hb(),hb()}if(2&e){var r=wb(2).index,i=wb().index,a=wb();Pw(1),tb("x1",a.SPACE_SIZE*r+.5*a.SPACE_SIZE)("y1",a.SPACE_SIZE*i+.04*a.SPACE_SIZE)("x2",a.SPACE_SIZE*r+.5*a.SPACE_SIZE)("y2",a.SPACE_SIZE*i+.96*a.SPACE_SIZE),Pw(1),tb("x1",a.SPACE_SIZE*r+.5*a.SPACE_SIZE)("y1",a.SPACE_SIZE*i+.2*a.SPACE_SIZE)("x2",a.SPACE_SIZE*r+.05*a.SPACE_SIZE)("y2",a.SPACE_SIZE*i+.65*a.SPACE_SIZE),Pw(1),tb("x1",a.SPACE_SIZE*r+.5*a.SPACE_SIZE)("y1",a.SPACE_SIZE*i+.2*a.SPACE_SIZE)("x2",a.SPACE_SIZE*r+.95*a.SPACE_SIZE)("y2",a.SPACE_SIZE*i+.65*a.SPACE_SIZE),Pw(1),tb("x1",a.SPACE_SIZE*r+.5*a.SPACE_SIZE)("y1",a.SPACE_SIZE*i+.4*a.SPACE_SIZE)("x2",a.SPACE_SIZE*r+.15*a.SPACE_SIZE)("y2",a.SPACE_SIZE*i+.75*a.SPACE_SIZE),Pw(1),tb("x1",a.SPACE_SIZE*r+.5*a.SPACE_SIZE)("y1",a.SPACE_SIZE*i+.4*a.SPACE_SIZE)("x2",a.SPACE_SIZE*r+.85*a.SPACE_SIZE)("y2",a.SPACE_SIZE*i+.75*a.SPACE_SIZE)}}function Qde(e,t){if(1&e){var n=pb();_m(),lb(0,"g"),lb(1,"polyline",13),mb("click",function(){$y(n);var e=wb(3).index,t=wb().index;return wb().onClick(e,t)}),hb(),hb()}if(2&e){var r=wb(3).index,i=wb().index,a=wb();Pw(1),tb("points",a.getKingPolyline(r,i))}}function Xde(e,t){if(1&e){var n=pb();_m(),lb(0,"line",11),mb("click",function(){$y(n);var e=wb(3).index,t=wb().index;return wb().onClick(e,t)}),hb(),lb(1,"line",11),mb("click",function(){$y(n);var e=wb(3).index,t=wb().index;return wb().onClick(e,t)}),hb(),lb(2,"line",11),mb("click",function(){$y(n);var e=wb(3).index,t=wb().index;return wb().onClick(e,t)}),hb(),lb(3,"line",11),mb("click",function(){$y(n);var e=wb(3).index,t=wb().index;return wb().onClick(e,t)}),hb()}if(2&e){var r=wb(3).index,i=wb().index,a=wb();tb("x1",a.SPACE_SIZE*r+.5*a.SPACE_SIZE)("y1",a.SPACE_SIZE*i+.04*a.SPACE_SIZE)("x2",a.SPACE_SIZE*r+.5*a.SPACE_SIZE)("y2",a.SPACE_SIZE*i+.96*a.SPACE_SIZE),Pw(1),tb("x1",a.SPACE_SIZE*r+.04*a.SPACE_SIZE)("y1",a.SPACE_SIZE*i+.5*a.SPACE_SIZE)("x2",a.SPACE_SIZE*r+.96*a.SPACE_SIZE)("y2",a.SPACE_SIZE*i+.5*a.SPACE_SIZE),Pw(1),tb("x1",a.SPACE_SIZE*r+.15*a.SPACE_SIZE)("y1",a.SPACE_SIZE*i+.15*a.SPACE_SIZE)("x2",a.SPACE_SIZE*r+.85*a.SPACE_SIZE)("y2",a.SPACE_SIZE*i+.85*a.SPACE_SIZE),Pw(1),tb("x1",a.SPACE_SIZE*r+.85*a.SPACE_SIZE)("y1",a.SPACE_SIZE*i+.15*a.SPACE_SIZE)("x2",a.SPACE_SIZE*r+.15*a.SPACE_SIZE)("y2",a.SPACE_SIZE*i+.85*a.SPACE_SIZE)}}function eve(e,t){if(1&e&&(_m(),ab(0,Qde,2,1,"g",9),ab(1,Xde,4,16,"ng-template",null,12,OP)),2&e){var n=ob(2),r=wb(2).index,i=wb().index;ub("ngIf",wb().isKing(r,i))("ngIfElse",n)}}function tve(e,t){if(1&e){var n=pb();_m(),lb(0,"g"),lb(1,"circle",8),mb("click",function(){$y(n);var e=wb().index,t=wb().index;return wb().onClick(e,t)}),hb(),ab(2,Jde,6,20,"g",9),ab(3,eve,3,2,"ng-template",null,10,OP),hb()}if(2&e){var r=ob(4),i=wb().index,a=wb().index,o=wb();Pw(1),ub("ngClass",o.getPieceClasses(i,a)),tb("r",(o.SPACE_SIZE-o.STROKE_WIDTH)/2)("cx",o.SPACE_SIZE*i+.5*o.SPACE_SIZE)("cy",o.SPACE_SIZE*a+.5*o.SPACE_SIZE),Pw(1),ub("ngIf",o.isInvader(i,a))("ngIfElse",r)}}function nve(e,t){if(1&e){var n=pb();_m(),lb(0,"g"),lb(1,"rect",2),mb("click",function(){var e=$y(n).index,t=wb().index;return wb().onClick(e,t)}),hb(),ab(2,Kde,4,2,"g",3),ab(3,tve,5,6,"g",3),hb()}if(2&e){var r=t.index,i=wb().index,a=wb();Pw(1),bb("id","click_",r,"_",i,""),ub("ngClass",a.getRectClasses(r,i)),tb("x",a.SPACE_SIZE*r)("y",a.SPACE_SIZE*i)("width",a.SPACE_SIZE)("height",a.SPACE_SIZE),Pw(1),ub("ngIf",a.board[i][r]===a.NONE&&a.isThrone(r,i)),Pw(1),ub("ngIf",a.board[i][r]!==a.NONE)}}function rve(e,t){if(1&e&&(_m(),lb(0,"g"),ab(1,nve,4,9,"g",1),hb()),2&e){var n=t.$implicit;Pw(1),ub("ngForOf",n)}}function ive(e,t){if(1&e){var n=pb();_m(),lb(0,"g"),lb(1,"rect",14),mb("click",function(){var e=$y(n).$implicit;return wb().onClick(e.x,e.y)}),hb(),hb()}if(2&e){var r=t.$implicit,i=wb();Pw(1),bb("id","click_",r.x,"_",r.y,""),tb("x",i.SPACE_SIZE*r.x)("y",i.SPACE_SIZE*r.y)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)}}var ave=function(){var e=function(e){Gv(n,e);var t=$v(n);function n(e){var r;return tp(this,n),(r=t.call(this,e,!1,Vde.from)).rules=Hde.get(),r.availableMinimaxes=[new Vie(r.rules,"DummyBot"),new Gie(r.rules,"Piece > Influence"),new qie(r.rules,"Piece > Control"),new $ie(r.rules,"Escape > Piece > Control")],r.encoder=Vde.encoder,r.tutorial=(new jde).tutorial,r.updateBoard(),r}return rp(n)}(Bie);return e.\u0275fac=function(t){return new(t||e)(sb(ore))},e.\u0275cmp=ey({type:e,selectors:[["app-tablut"]],features:[zC],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[1,"base",3,"id","ngClass","click"],[4,"ngIf"],["points","15 15, 85 15, 85 85, 15 85, 15 15, 85 15","class","base",3,"click",4,"ngIf","ngIfElse"],["cornerThrone",""],["points","15 15, 85 15, 85 85, 15 85, 15 15, 85 15",1,"base",3,"click"],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60, 10 20",1,"base",3,"click"],[1,"base",3,"ngClass","click"],[4,"ngIf","ngIfElse"],["defender",""],[1,"base",3,"click"],["soldierDefender",""],[1,"base","no-fill",3,"click"],[1,"no-fill","mid-stroke","clickable",3,"id","click"]],template:function(e,t){1&e&&(_m(),lb(0,"svg",0),ab(1,rve,2,1,"g",1),ab(2,ive,2,6,"g",1),hb()),2&e&&(tb("viewBox",t.getViewBox()),Pw(1),ub("ngForOf",t.board),Pw(1),ub("ngForOf",t.getClickables()))},directives:[AT,IT,NT],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),ove=rp(function e(){tp(this,e)});ove.PLACEMENT_AFTER_INITIAL_PHASE=function(){return $localize(Ec||(Ec=Rv(["You cannot put a new ring after the tenth turn."])))},ove.NO_MARKERS_IN_INITIAL_PHASE=function(){return $localize(Sc||(Sc=Rv(["You cannot put a marker in a ring before placing all of your rings."])))},ove.MISSING_CAPTURES=jse.MISSING_CAPTURES,ove.MOVE_DIRECTION_INVALID=function(){return $localize(Pc||(Pc=Rv(["The direction of your move is invalid: a move is made along a straight line."])))},ove.CAN_ONLY_CAPTURE_YOUR_MARKERS=function(){return $localize(Oc||(Oc=Rv(["You can only capture your own markers."])))},ove.SHOULD_SELECT_PLAYER_RING=function(){return $localize(Tc||(Tc=Rv(["You must pick one of your own rings to move."])))},ove.SHOULD_END_MOVE_ON_EMPTY_SPACE=function(){return $localize(Ic||(Ic=Rv(["Your ring must land on an empty space."])))},ove.MOVE_SHOULD_NOT_PASS_ABOVE_RING=function(){return $localize(xc||(xc=Rv(["A ring can only jump over markers or empty spaces, not over another ring."])))},ove.MOVE_SHOULD_END_AT_FIRST_EMPTY_SPACE_AFTER_MARKERS=function(){return $localize(Ac||(Ac=Rv(["Your ring must land on the first empty space after a group of markers."])))},ove.AMBIGUOUS_CAPTURE_COORD=jse.AMBIGUOUS_CAPTURE_COORD,ove.CAPTURE_SHOULD_TAKE_RING=function(){return $localize(Rc||(Rc=Rv(["When you capture markers, you must take one of your ring as well by clicking on it."])))};var sve=function(){function e(t,n){tp(this,e),this.player=t,this.isRing=n}return rp(e,[{key:"equals",value:function(e){return this===e}},{key:"flip",value:function(){return X5(!1===this.isRing,"cannot flip a ring (it should never happen)"),X5(this.player.isPlayer(),"cannot flip a non-player piece"),e.of(this.player.getOpponent(),this.isRing)}},{key:"toString",value:function(){switch(this){case e.NONE:return"NONE";case e.EMPTY:return"EMPTY";case e.MARKER_ZERO:return"MARKER_ZERO";case e.MARKER_ONE:return"MARKER_ONE";case e.RING_ZERO:return"RING_ZERO";default:return nB.expectToBe(this,e.RING_ONE),"RING_ONE"}}}],[{key:"of",value:function(t,n){return t===Xee.NONE?e.EMPTY:n?e.RINGS[t.value]:e.MARKERS[t.value]}}]),e}();sve.encoder=Jee.tuple([ete.numberEncoder,Jee.booleanEncoder],function(e){return[e.player,e.isRing]},function(e){return sve.of(e[0],e[1])}),sve.NONE=new sve(Xee.NONE,!1),sve.EMPTY=new sve(Xee.NONE,!1),sve.MARKER_ZERO=new sve(ete.ZERO,!1),sve.MARKER_ONE=new sve(ete.ONE,!1),sve.MARKERS=[sve.MARKER_ZERO,sve.MARKER_ONE],sve.RING_ZERO=new sve(ete.ZERO,!0),sve.RING_ONE=new sve(ete.ONE,!0),sve.RINGS=[sve.RING_ZERO,sve.RING_ONE];var uve=function(){var e=function(e){Gv(n,e);var t=$v(n);function n(e,r,i){var a;return tp(this,n),(a=t.call(this,i,e,n.SIZE,n.SIZE,[6,4,3,2,1],sve.EMPTY)).sideRings=r,a}return rp(n,[{key:"isInitialPlacementPhase",value:function(){return this.turn<10}},{key:"countScores",value:function(){return this.turn<10?[0,0]:this.sideRings}},{key:"equals",value:function(e){return this===e||this.turn===e.turn&&this.sideRings[0]===e.sideRings[0]&&this.sideRings[1]===e.sideRings[1]&&ite.compareTable(this.board,e.board)}},{key:"getRingCoords",value:function(e){var t=[];return this.forEachCoord(function(n,r){r.isRing&&r.player===e&&t.push(n)}),t}},{key:"isOnBoard",value:function(e){return!e.isNotInRange(this.width,this.height)&&this.board[e.y][e.x]!==sve.NONE}},{key:"setAtUnsafe",value:function(e,t){var r=ite.copyBiArray(this.board);return r[e.y][e.x]=t,new n(r,this.sideRings,this.turn)}}],[{key:"getInitialState",value:function(){var e=sve.EMPTY,t=sve.NONE;return new n([[t,t,t,t,t,t,e,e,e,e,t],[t,t,t,t,e,e,e,e,e,e,e],[t,t,t,e,e,e,e,e,e,e,e],[t,t,e,e,e,e,e,e,e,e,e],[t,e,e,e,e,e,e,e,e,e,e],[t,e,e,e,e,e,e,e,e,e,t],[e,e,e,e,e,e,e,e,e,e,t],[e,e,e,e,e,e,e,e,e,t,t],[e,e,e,e,e,e,e,e,t,t,t],[e,e,e,e,e,e,e,t,t,t,t],[t,e,e,e,e,t,t,t,t,t,t]],[5,5],0)}}]),n}(Ooe);return e.SIZE=11,e}(),cve=function(e){Gv(n,e);var t=$v(n);function n(e,r){var i;if(tp(this,n),i=t.call(this,e),5!==e.length)throw new Error("YinshCapture must capture exactly 5 pieces");return i.ringTaken=sB.ofNullable(r),Wv(i)}return rp(n,[{key:"setRingTaken",value:function(e){return new n(this.capturedSpaces,e)}},{key:"equals",value:function(e){return!(!1===zv(Yv(n.prototype),"equals",this).call(this,e)||!1===this.ringTaken.equals(e.ringTaken))}}],[{key:"of",value:function(e,t,r){for(var i=[],a=lre.factory.fromMove(e,t).get(),o=e;!1===o.equals(t);o=o.getNext(a))i.push(o);return i.push(t),new n(i,r)}}]),n}(Gse);cve.encoder=new(function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"encode",value:function(e){return{captured:e.capturedSpaces.map(function(e){return ire.encoder.encode(e)}),ringTaken:ire.encoder.encode(e.ringTaken.get())}}},{key:"decode",value:function(e){var t=e;return X5(null!=t.captured&&null!=t.ringTaken,"Invalid encoded YinshCapture"),new cve(t.captured.map(function(e){return ire.encoder.decode(e)}),ire.encoder.decode(t.ringTaken))}}]),n}(Yee));var lve=function(e){Gv(n,e);var t=$v(n);function n(e,r,i,a){var o;return tp(this,n),(o=t.call(this)).initialCaptures=e,o.start=r,o.end=i,o.finalCaptures=a,o}return rp(n,[{key:"isInitialPlacement",value:function(){return this.end.isAbsent()}},{key:"equals",value:function(e){return this===e||!(!1===this.start.equals(e.start)||!1===this.end.equals(e.end)||!1===ite.compareArray(this.initialCaptures,e.initialCaptures)||!1===ite.compareArray(this.finalCaptures,e.finalCaptures))}},{key:"toString",value:function(){return"YinshMove(["+this.capturesToString(this.initialCaptures)+"], "+this.start.toString()+", "+this.end.toString()+", ["+this.capturesToString(this.finalCaptures)+"])"}},{key:"capturesToString",value:function(e){var t,n="",r=Qv(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;""!==n&&(n+=","),n+="["+i.toString()+"]"}}catch(a){r.e(a)}finally{r.f()}return n}}]),n}(bre);lve.coordOptionalEncoder=Hse(ire.encoder),lve.encoder=new(function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"encodeMove",value:function(e){var t={moveStart:ire.encoder.encode(e.start),moveEnd:lve.coordOptionalEncoder.encode(e.end)};return e.initialCaptures.map(function(e,n){t["initialCapture"+n]=cve.encoder.encode(e)}),e.finalCaptures.map(function(e,n){t["finalCapture"+n]=cve.encoder.encode(e)}),t}},{key:"decodeMove",value:function(e){var t=e;return X5(null!=t.moveStart,"Invalid encoded YinshMove"),new lve(this.decodeArray(t,"initialCapture",cve.encoder.decode),ire.encoder.decode(t.moveStart),lve.coordOptionalEncoder.decode(t.moveEnd),this.decodeArray(t,"finalCapture",cve.encoder.decode))}},{key:"decodeArray",value:function(e,t,n){for(var r=[],i=0;null!=e[t+i];i++)r.push(n(e[t+i]));return r}}]),n}(Kee));var hve=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"getBoardValue",value:function(e){var t=this.ruler.getGameStatus(e);return t.isEndGame?yre.fromWinner(t.winner):new yre(e.gameState.sideRings[0]*ete.ZERO.getScoreModifier()+e.gameState.sideRings[1]*ete.ONE.getScoreModifier())}},{key:"getListMoves",value:function(e){var t=this,n=[],r=e.gameState;if(r.isInitialPlacementPhase()){var i,a=Qv(r.getCoordsAndContents());try{for(a.s();!(i=a.n()).done;){var o=Lv(i.value,2),s=o[0];o[1]===sve.EMPTY&&n.push(new lve([],s,sB.empty(),[]))}}catch(c){a.e(c)}finally{a.f()}}else{var u=this.ruler;this.getPossibleCaptureCombinations(r).forEach(function(e){var i=u.applyCaptures(r,e);t.getRingMoves(i).forEach(function(r){var a=u.applyRingMoveAndFlip(i,r.start,r.end);t.getPossibleCaptureCombinations(a).forEach(function(t){var i=new lve(e,r.start,sB.of(r.end),t);n.push(i)})})})}return n}},{key:"getPossibleCaptureCombinations",value:function(e){var t=this.ruler.getPossibleCaptures(e),n=this.getRingCoords(e);return Yse.getPossibleCaptureCombinationsFromPossibleCaptures(t).map(function(e){return function(){function e(){tp(this,e)}return rp(e,null,[{key:"getCombinations",value:function(e,t){var n=this;return X5(e.length>=t,"cannot compute combinations for less elements than needed"),this.getSubsetsOfSize(e,t).map(function(e){return n.getPermutations(e)}).reduce(function(e,t){return e.concat(t)})}},{key:"getPermutations",value:function(e){for(var t=e.length,n=[e.slice()],r=new Array(t).fill(0),i=1;i<t;)if(r[i]<i){var a=i%2&&r[i],o=e[i];e[i]=e[a],e[a]=o,++r[i],i=1,n.push(e.slice())}else r[i]=0,++i;return n}},{key:"getSubsetsOfSize",value:function(e,t){return function t(n,r){if(r>=e.length||n<1)return[[]];for(var i=[];r<=e.length-n;){var a,o=e[r],s=Qv(t(n-1,r+1));try{for(s.s();!(a=s.n()).done;){var u=a.value;u.push(o),i.push(u)}}catch(c){s.e(c)}finally{s.f()}++r}return i}(t,0)}}]),e}().getCombinations(n,e.length).map(function(t){return e.map(function(e,n){return new cve(e.capturedSpaces,t[n])})})}).reduce(function(e,t){return e.concat(t)},[])}},{key:"getRingMoves",value:function(e){var t,n=this.ruler,r=[],i=Qv(this.getRingCoords(e));try{for(i.s();!(t=i.n()).done;){var a,o=t.value,s=Qv(n.getRingTargets(e,o));try{for(s.s();!(a=s.n()).done;){var u=a.value;r.push({start:o,end:u})}}catch(c){s.e(c)}finally{s.f()}}}catch(c){i.e(c)}finally{i.f()}return r}},{key:"getRingCoords",value:function(e){var t=e.getCurrentPlayer().value,n=[];return e.forEachCoord(function(e,r){r===sve.RINGS[t]&&n.push(e)}),n}}]),n}(gre),fve=function(e){Gv(n,e);var t=$v(n);function n(){return tp(this,n),t.apply(this,arguments)}return rp(n,[{key:"applyLegalMove",value:function(e,t,n){return new uve(n.board,n.sideRings,n.turn+1)}},{key:"applyCaptures",value:function(e,t){var n=this,r=e;return t.forEach(function(e){r=n.applyCapture(r,e)}),r}},{key:"applyCapture",value:function(e,t){var n=this.applyCaptureWithoutTakingRing(e,t);return this.takeRing(new uve(n,e.sideRings,e.turn),t.ringTaken.get())}},{key:"takeRing",value:function(e,t){var n=e.getCurrentPlayer().value,r=e.setAt(t,sve.EMPTY).board,i=[e.sideRings[0],e.sideRings[1]];return i[n]+=1,new uve(r,i,e.turn)}},{key:"applyCaptureWithoutTakingRing",value:function(e,t){return t.forEach(function(t){e=e.setAt(t,sve.EMPTY)}),e.board}},{key:"ringSelectionValidity",value:function(e,t){var n=e.getCurrentPlayer().value;return e.getPieceAt(t)===sve.RINGS[n]?K5.SUCCESS:K5.failure(ove.CAPTURE_SHOULD_TAKE_RING())}},{key:"applyRingMoveAndFlip",value:function(e,t,n){var r=e.getCurrentPlayer().value,i=e.setAt(t,sve.MARKERS[r]);i=i.setAt(n,sve.RINGS[r]);for(var a=lre.factory.fromMove(t,n).get(),o=t.getNext(a);!1===o.equals(n);o=o.getNext(a)){var s=i.getPieceAt(o);s!==sve.EMPTY&&(i=i.setAt(o,s.flip()))}return i}},{key:"isLegal",value:function(e,t){if(e.isInitialPlacement())return this.initialPlacementValidity(t,e.start);if(t.isInitialPlacementPhase())return j5.failure(ove.NO_MARKERS_IN_INITIAL_PHASE());var n=this.capturesValidity(t,e.initialCaptures);if(n.isFailure())return n.toFailedFallible();var r=this.applyCaptures(t,e.initialCaptures),i=this.moveValidity(r,e.start,e.end.get());if(i.isFailure())return i.toFailedFallible();var a=this.applyRingMoveAndFlip(r,e.start,e.end.get()),o=this.capturesValidity(a,e.finalCaptures);if(o.isFailure())return o.toFailedFallible();var s=this.applyCaptures(a,e.finalCaptures),u=this.noMoreCapturesValidity(s);return u.isFailure()?u.toFailedFallible():j5.success(s)}},{key:"initialPlacementValidity",value:function(e,t){if(!0!==e.isInitialPlacementPhase())return j5.failure(ove.PLACEMENT_AFTER_INITIAL_PHASE());if(e.getPieceAt(t)!==sve.EMPTY)return j5.failure(pre.MUST_CLICK_ON_EMPTY_SPACE());var n=e.getCurrentPlayer(),r=[e.sideRings[0],e.sideRings[1]];r[n.value]-=1;var i=e.setAt(t,sve.of(n,!0)).board,a=new uve(i,r,e.turn);return j5.success(a)}},{key:"moveStartValidity",value:function(e,t){var n=e.getCurrentPlayer().value;return e.getPieceAt(t)!==sve.RINGS[n]?K5.failure(ove.SHOULD_SELECT_PLAYER_RING()):K5.SUCCESS}},{key:"moveValidity",value:function(e,t,n){var r=this.moveStartValidity(e,t);if(r.isFailure())return r;if(e.getPieceAt(n)!==sve.EMPTY)return K5.failure(ove.SHOULD_END_MOVE_ON_EMPTY_SPACE());var i=lre.factory.fromMove(t,n);if(i.isFailure())return K5.failure(ove.MOVE_DIRECTION_INVALID());for(var a=i.get(),o=!1,s=t.getNext(a);!1===s.equals(n);s=s.getNext(a)){var u=e.getPieceAt(s);if(u===sve.EMPTY){if(o)return K5.failure(ove.MOVE_SHOULD_END_AT_FIRST_EMPTY_SPACE_AFTER_MARKERS())}else{if(u.isRing)return K5.failure(ove.MOVE_SHOULD_NOT_PASS_ABOVE_RING());o=!0}}return K5.SUCCESS}},{key:"capturesValidity",value:function(e,t){var n,r=e,i=Qv(t);try{for(i.s();!(n=i.n()).done;){var a=n.value,o=this.captureValidity(r,a);if(o.isFailure())return o;r=this.applyCapture(r,a)}}catch(s){i.e(s)}finally{i.f()}return K5.SUCCESS}},{key:"captureValidity",value:function(e,t){var n,r=e.getCurrentPlayer().value,i=Qv(t.capturedSpaces);try{for(i.s();!(n=i.n()).done;){var a=n.value;if(e.getPieceAt(a)!==sve.MARKERS[r])return K5.failure(ove.CAN_ONLY_CAPTURE_YOUR_MARKERS())}}catch(o){i.e(o)}finally{i.f()}return e.getPieceAt(t.ringTaken.get())!==sve.RINGS[r]?K5.failure(ove.CAPTURE_SHOULD_TAKE_RING()):K5.SUCCESS}},{key:"noMoreCapturesValidity",value:function(e){var t=e.getCurrentPlayer();return 0===this.getLinePortionsWithAtLeastFivePiecesOfPlayer(e,t).length?K5.SUCCESS:K5.failure(ove.MISSING_CAPTURES())}},{key:"getLinePortionsWithAtLeastFivePiecesOfPlayer",value:function(e,t){var n=this,r=[];return e.allLines().forEach(function(i){var a=n.getLinePortionWithAtLeastFivePiecesOfPlayer(e,t,i);a.isPresent()&&r.push(a.get())}),r}},{key:"getLinePortionWithAtLeastFivePiecesOfPlayer",value:function(e,t,n){var r,i=0,a=e.getEntranceOnLine(n),o=n.getDirection(),s=a;for(r=a;e.isOnBoard(r);r=r.getNext(o)){var u=e.getPieceAt(r);if(u.player===t&&!1===u.isRing)0===i&&(s=r),i+=1;else{if(i>=5)break;i=0}}return i>=5?sB.of({start:s,end:r,dir:o}):sB.empty()}},{key:"getPossibleCaptures",value:function(e){var t=e.getCurrentPlayer(),n=[];return this.getLinePortionsWithAtLeastFivePiecesOfPlayer(e,t).forEach(function(e){for(var t=e.start;t.getDistance(e.end)>=5;t=t.getNext(e.dir))n.push(cve.of(t,t.getNext(e.dir,4)))}),n}},{key:"getRingTargets",value:function(e,t){var n,r=[],i=Qv(lre.factory.all);try{for(i.s();!(n=i.n()).done;)for(var a=n.value,o=!1,s=t.getNext(a);e.isOnBoard(s);s=s.getNext(a)){var u=e.getPieceAt(s);if(u===sve.EMPTY){if(r.push(s),o)break}else{if(u.isRing)break;o=!0}}}catch(c){i.e(c)}finally{i.f()}return r}},{key:"getGameStatus",value:function(e){return e.gameState.isInitialPlacementPhase()?Are.ONGOING:e.gameState.sideRings[0]>=3?Are.ZERO_WON:e.gameState.sideRings[1]>=3?Are.ONE_WON:Are.ONGOING}}]),n}(Rre),dve=sve.EMPTY,vve=sve.NONE,pve=sve.MARKER_ZERO,gve=sve.RING_ZERO,yve=sve.MARKER_ONE,mve=sve.RING_ONE,kve=function(){var e=rp(function e(){tp(this,e)});return e.MUST_ALIGN_FIVE=function(){return $localize(Nc||(Nc=Rv(["Failed! You need to align 5 markers of your color in order to get them, and to get a ring at the same time."])))},e.MUST_CAPTURE_TWO=function(){return $localize(Mc||(Mc=Rv(["Failed! You can capture two rings in total, by capturing two times 5 of your markers. Try again."])))},e}(),_ve=rp(function e(){tp(this,e),this.tutorial=[Lre.informational($localize(Dc||(Dc=Rv(["Goal of the game"]))),$localize(Lc||(Lc=Rv(["The goal at Yinsh is to capture three rings in total.\n        The rings taken are shown on the top left for the dark player,\n        and on the bottom right for the light player. Here, Dark won the game.\n        Note that on the board you have two types of pieces for each player:\n        rings (empty circles) and markers (full circles)."]))),new uve([[vve,vve,vve,vve,vve,vve,dve,dve,dve,dve,vve],[vve,vve,vve,vve,dve,dve,dve,dve,dve,dve,dve],[vve,vve,vve,pve,mve,dve,dve,dve,dve,dve,dve],[vve,vve,dve,pve,dve,mve,dve,yve,dve,dve,dve],[vve,dve,gve,yve,dve,dve,mve,pve,dve,dve,dve],[vve,dve,dve,pve,yve,dve,dve,dve,dve,dve,vve],[dve,dve,dve,pve,dve,dve,dve,mve,dve,dve,vve],[dve,dve,dve,yve,pve,gve,dve,dve,dve,vve,vve],[dve,dve,dve,dve,dve,dve,dve,dve,vve,vve,vve],[dve,dve,dve,dve,dve,dve,dve,vve,vve,vve,vve],[vve,dve,dve,dve,dve,vve,vve,vve,vve,vve,vve]],[3,1],20)),Lre.anyMove($localize(Fc||(Fc=Rv(["Initial board and placement phase"]))),$localize(Bc||(Bc=Rv(["The initial board is empty.\n        At the beginning of the game, each player puts one of its ring on the board at their turn.\n        This phase stops when all rings have been placed on the board.\n        Put one of your ring on the board by clicking the space where you want to place it."]))),new uve(uve.getInitialState().board,[5,5],0),new lve([],new ire(5,5),sB.empty(),[]),$localize(Vc||(Vc=Rv(["Congratulations!"])))),Lre.anyMove($localize(Uc||(Uc=Rv(["Putting a marker"]))),$localize(zc||(zc=Rv(["Once the initial phase is done and all rings are on the board, you need to place markers on the board.\n        To do so, put a marker in a ring by clicking on that ring.\n        Then, the ring must be moved in a straight line, in any direction.\n        A ring cannot pass through other rings during its move.\n        If it goes over a group of markers, your move must stop at the first empty space after that group.\n        All markers in the group are then flipped and their color change.<br/><br/>\n        You're playing Dark, do a move."]))),new uve([[vve,vve,vve,vve,vve,vve,dve,dve,dve,dve,vve],[vve,vve,vve,vve,dve,dve,dve,dve,dve,dve,dve],[vve,vve,vve,mve,dve,dve,dve,dve,dve,dve,dve],[vve,vve,mve,dve,dve,mve,dve,dve,dve,dve,dve],[vve,dve,gve,yve,dve,dve,mve,dve,dve,dve,dve],[vve,dve,dve,yve,dve,dve,dve,dve,dve,dve,vve],[dve,dve,dve,dve,gve,dve,dve,mve,dve,dve,vve],[dve,dve,dve,dve,dve,gve,dve,dve,dve,vve,vve],[dve,dve,dve,gve,dve,dve,dve,vve,vve,vve,vve],[dve,dve,dve,dve,dve,dve,dve,vve,vve,vve,vve],[vve,dve,dve,dve,dve,vve,vve,vve,vve,vve,vve]],[0,0],20),new lve([],new ire(2,4),sB.of(new ire(4,4)),[]),$localize(Hc||(Hc=Rv(["Congratulations!"])))),Lre.fromPredicate($localize(Gc||(Gc=Rv(["Getting a ring by aligning 5 markers"]))),$localize(qc||(qc=Rv(["Finally, the last mechanic you need is to be able to get a ring from the board in order to gain points.\n        To do so, you need to align 5 markers of your color.\n        You can then get these markers by clicking on them, and then get one of your ring by clicking on it.\n        You will then have one more point.\n        You must capture when you can.<br/><br/>\n        You're playing Dark, perform a capture!"]))),new uve([[vve,vve,vve,vve,vve,vve,dve,dve,dve,dve,vve],[vve,vve,vve,vve,dve,dve,dve,dve,dve,dve,dve],[vve,vve,vve,mve,dve,dve,dve,dve,dve,dve,dve],[vve,vve,mve,dve,dve,mve,dve,dve,dve,dve,dve],[vve,dve,pve,pve,gve,yve,yve,dve,dve,dve,dve],[vve,dve,dve,mve,dve,dve,dve,dve,dve,dve,vve],[dve,dve,dve,dve,gve,dve,dve,mve,dve,dve,vve],[dve,dve,dve,dve,dve,gve,dve,dve,dve,vve,vve],[dve,dve,dve,gve,dve,dve,dve,gve,vve,vve,vve],[dve,dve,dve,dve,dve,dve,dve,vve,vve,vve,vve],[vve,dve,dve,dve,dve,vve,vve,vve,vve,vve,vve]],[0,0],20),new lve([],new ire(4,4),sB.of(new ire(7,4)),[cve.of(new ire(2,4),new ire(6,4),new ire(7,4))]),function(e,t){return 1===t.sideRings[ete.ZERO.value]?K5.SUCCESS:K5.failure(kve.MUST_ALIGN_FIVE())},$localize($c||($c=Rv(["Congratulations!"])))),Lre.fromPredicate($localize(Wc||(Wc=Rv(["Compound captures"]))),$localize(jc||(jc=Rv(["During a turn, you could have to choose between multiple captures,\n        or you could even capture multiple times!\n        During the capture selection, if you see that the marker you clicked belongs to two captures, you have to click on a second marker to avoid any ambiguity.<br/><br/>\n        Here, you can capture two rings, do it!"]))),new uve([[vve,vve,vve,vve,vve,vve,dve,dve,dve,dve,vve],[vve,vve,vve,vve,gve,dve,dve,mve,mve,gve,dve],[vve,vve,vve,gve,dve,dve,yve,mve,dve,gve,dve],[vve,vve,dve,gve,dve,dve,dve,dve,dve,mve,dve],[vve,dve,dve,dve,dve,pve,dve,dve,mve,dve,dve],[vve,dve,dve,dve,pve,pve,dve,yve,dve,dve,vve],[dve,dve,dve,pve,dve,pve,dve,dve,dve,dve,vve],[dve,dve,pve,dve,dve,pve,dve,dve,dve,vve,vve],[dve,pve,dve,dve,dve,pve,dve,dve,vve,vve,vve],[dve,dve,dve,dve,dve,pve,dve,vve,vve,vve,vve],[vve,dve,dve,dve,dve,vve,vve,vve,vve,vve,vve]],[0,0],10),new lve([cve.of(new ire(5,4),new ire(1,8),new ire(3,2)),cve.of(new ire(5,9),new ire(5,5),new ire(3,3))],new ire(4,1),sB.of(new ire(4,2)),[]),function(e,t){return 2===t.sideRings[ete.ZERO.value]?K5.SUCCESS:K5.failure(kve.MUST_CAPTURE_TWO())},$localize(Zc||(Zc=Rv(["Congratulations!"]))))]});function wve(e,t){if(1&e&&(_m(),fb(0,"circle",9)),2&e){var n=wb(2).$implicit,r=wb(2);tb("cx",n.center.x)("cy",n.center.y)("r",r.viewInfo.ringOuterSize)}}function Cve(e,t){if(1&e&&(_m(),fb(0,"circle",10)),2&e){var n=wb(2),r=n.index,i=n.$implicit,a=wb().index,o=wb();bb("id","ring_",r,"_",a,""),ub("ngClass",i.ringClasses),tb("cx",i.center.x)("cy",i.center.y)("r",o.viewInfo.ringMidSize)}}function bve(e,t){if(1&e&&(_m(),fb(0,"circle",9)),2&e){var n=wb(2).$implicit,r=wb(2);tb("cx",n.center.x)("cy",n.center.y)("r",r.viewInfo.ringInnerSize)}}function Eve(e,t){if(1&e&&(_m(),fb(0,"circle",11)),2&e){var n=wb(2),r=n.index,i=n.$implicit,a=wb().index,o=wb();bb("id","marker_",r,"_",a,""),ub("ngClass",i.markerClasses),tb("cx",i.center.x)("cy",i.center.y)("r",o.viewInfo.markerSize)}}function Sve(e,t){if(1&e){var n=pb();_m(),lb(0,"g",3),mb("click",function(){$y(n);var e=wb().$implicit;return wb(2).onClick(e.coord)}),fb(1,"polyline",4),lb(2,"g",5),ab(3,wve,1,3,"circle",6),ab(4,Cve,1,6,"circle",7),ab(5,bve,1,3,"circle",6),ab(6,Eve,1,6,"circle",8),hb(),hb()}if(2&e){var r=wb(),i=r.index,a=r.$implicit,o=wb().index;bb("id","click_",i,"_",o,""),Pw(1),bb("id","space_",i,"_",o,""),ub("ngClass",a.spaceClasses),tb("points",a.coordinates),Pw(1),bb("id","pieceGroup_",i,"_",o,""),ub("ngClass",a.removedClass),Pw(1),ub("ngIf",a.isRing),Pw(1),ub("ngIf",a.isRing),Pw(1),ub("ngIf",a.isRing),Pw(1),ub("ngIf",a.isMarker)}}function Pve(e,t){if(1&e&&(_m(),lb(0,"g"),ab(1,Sve,7,13,"g",2),hb()),2&e){var n=t.$implicit;Pw(1),ub("ngIf",null!=n)}}function Ove(e,t){if(1&e&&(_m(),lb(0,"g"),ab(1,Pve,2,1,"g",1),hb()),2&e){var n=t.$implicit;Pw(1),ub("ngForOf",n)}}function Tve(e,t){if(1&e){var n=pb();_m(),lb(0,"g"),lb(1,"polyline",12),mb("click",function(){var e=$y(n).$implicit;return wb().onClick(e)}),hb(),hb()}if(2&e){var r=t.$implicit,i=wb();Pw(1),bb("id","selected_",r.x,"_",r.y,""),tb("points",i.viewInfo.spaceInfo[r.y][r.x].coordinates)}}function Ive(e,t){if(1&e){var n=pb();_m(),lb(0,"polyline",14),mb("click",function(){$y(n);var e=wb().$implicit;return wb().onClick(e)}),hb()}if(2&e){var r=wb().$implicit,i=wb();bb("id","selectable_",r.x,"_",r.y,""),tb("points",i.viewInfo.spaceInfo[r.y][r.x].coordinates)}}function xve(e,t){if(1&e&&(_m(),lb(0,"g"),ab(1,Ive,1,3,"polyline",13),hb()),2&e){var n=wb();Pw(1),ub("ngIf",n.isPlayerTurn())}}function Ave(e,t){if(1&e){var n=pb();_m(),lb(0,"g"),lb(1,"rect",15),mb("click",function(){var e=$y(n).$implicit;return wb().onClick(e)}),hb(),hb()}if(2&e){var r=t.$implicit,i=wb();Pw(1),tb("x",i.viewInfo.spaceInfo[r.y][r.x].center.x-i.viewInfo.indicatorSize/2)("y",i.viewInfo.spaceInfo[r.y][r.x].center.y-i.viewInfo.indicatorSize/2)("width",i.viewInfo.indicatorSize)("height",i.viewInfo.indicatorSize)}}function Rve(e,t){if(1&e&&(_m(),lb(0,"g"),fb(1,"circle",16),fb(2,"circle",9),fb(3,"circle",17),hb()),2&e){var n=t.index,r=wb().$implicit,i=wb();Pw(1),bb("id","player_",r,"_sideRing_",n+1,""),tb("cx",(0===r?0:1050)+1.2*(0===r?1:-1)*i.viewInfo.ringOuterSize*(n+1))("cy",0===r?300:1260)("r",i.viewInfo.ringOuterSize),Pw(1),tb("cx",(0===r?0:1050)+1.2*(0===r?1:-1)*i.viewInfo.ringOuterSize*(n+1))("cy",0===r?300:1260)("r",i.viewInfo.ringInnerSize),Pw(1),ub("ngClass",i.viewInfo.sideRingClass[r]),tb("cx",(0===r?0:1050)+1.2*(0===r?1:-1)*i.viewInfo.ringOuterSize*(n+1))("cy",0===r?300:1260)("r",i.viewInfo.ringMidSize)}}var Nve=function(){return[]};function Mve(e,t){if(1&e&&(_m(),lb(0,"g"),ab(1,Rve,4,12,"g",1),hb()),2&e){var n=t.$implicit,r=wb();Pw(1),ub("ngForOf",eP(1,Nve).constructor(r.viewInfo.sideRings[n]))}}var Dve=function(){return[0,1]},Lve=function(e){Gv(n,e);var t=$v(n);function n(e){var r;return tp(this,n),(r=t.call(this,e)).movePhase="MOVE_START",r.moveStart=sB.empty(),r.moveEnd=sB.empty(),r.currentlyMoved=[],r.currentCapture=sB.empty(),r.initialCaptures=[],r.finalCaptures=[],r.possibleCaptures=[],r.viewInfo={spaceInfo:[],selectableCoords:[],selectedCoords:[],targets:[],markerSize:n.MARKER_SIZE,ringOuterSize:n.RING_OUTER_SIZE,ringMidSize:n.RING_MID_SIZE,ringInnerSize:n.RING_INNER_SIZE,indicatorSize:n.INDICATOR_SIZE,sideRings:[5,5],sideRingClass:["player0-stroke","player1-stroke"]},r.scores=sB.of([0,0]),r.rules=new fve(uve),r.availableMinimaxes=[new hve(r.rules,"YinshMinimax")],r.encoder=lve.encoder,r.tutorial=(new _ve).tutorial,r.hexaLayout=new hre(1.5*n.RING_OUTER_SIZE,new ire(2*n.RING_OUTER_SIZE,0),vre.INSTANCE),r.constructedState=r.rules.node.gameState,r.constructedState.allCoords().forEach(function(e){null==r.viewInfo.spaceInfo[e.y]&&(r.viewInfo.spaceInfo[e.y]=[]),r.viewInfo.spaceInfo[e.y][e.x]={coord:e,coordinates:r.getHexaCoordsAt(e),center:r.getCenterAt(e),spaceClasses:[],markerClasses:[],ringClasses:[],isMarker:!1,isRing:!1,removedClass:""}}),r}return rp(n,[{key:"updateBoard",value:function(){this.cancelMoveAttempt(),this.scores=sB.of(this.rules.node.gameState.countScores())}},{key:"updateViewInfo",value:function(){var e=this;this.constructedState.allCoords().forEach(function(t){e.viewInfo.spaceInfo[t.y][t.x].spaceClasses=e.getSpaceClasses(t);var n=e.constructedState.getPieceAt(t);e.viewInfo.spaceInfo[t.y][t.x].removedClass="",e.setRingInfo(t,n),e.setMarkerInfo(t,n)});for(var t=0,n=[ete.ZERO,ete.ONE];t<n.length;t++){var r=n[t];this.viewInfo.sideRings[r.value]=this.constructedState.sideRings[r.value]}switch(this.showCurrentMoveCaptures(),this.showLastMove(),this.viewInfo.targets=[],this.viewInfo.selectableCoords=[],this.movePhase){case"INITIAL_CAPTURE_SELECT_FIRST":case"INITIAL_CAPTURE_SELECT_LAST":case"FINAL_CAPTURE_SELECT_FIRST":case"FINAL_CAPTURE_SELECT_LAST":this.viewInfo.selectableCoords=[];var i,a=Qv(this.possibleCaptures);try{for(a.s();!(i=a.n()).done;){var o,s=Qv(i.value.capturedSpaces);try{for(s.s();!(o=s.n()).done;){var u=o.value;this.viewInfo.selectableCoords.push(u)}}catch(c){s.e(c)}finally{s.f()}}}catch(c){a.e(c)}finally{a.f()}break;case"INITIAL_CAPTURE_SELECT_RING":case"FINAL_CAPTURE_SELECT_RING":this.viewInfo.selectableCoords=this.constructedState.getRingCoords(this.constructedState.getCurrentPlayer());break;case"MOVE_START":!1===this.rules.node.gameState.isInitialPlacementPhase()&&(this.viewInfo.selectableCoords=this.constructedState.getRingCoords(this.constructedState.getCurrentPlayer()));break;case"MOVE_END":this.viewInfo.targets=this.rules.getRingTargets(this.constructedState,this.moveStart.get())}}},{key:"showCurrentMoveCaptures",value:function(){this.currentCapture.isPresent()&&this.markCurrentCapture(this.currentCapture.get());var e,t=Qv(this.initialCaptures);try{for(t.s();!(e=t.n()).done;){var n=e.value;this.markCurrentCapture(n)}}catch(o){t.e(o)}finally{t.f()}var r,i=Qv(this.finalCaptures);try{for(i.s();!(r=i.n()).done;){var a=r.value;this.markCurrentCapture(a)}}catch(o){i.e(o)}finally{i.f()}}},{key:"getSpaceClasses",value:function(e){return this.currentlyMoved.some(function(t){return t.equals(e)})?["moved"]:[]}},{key:"setRingInfo",value:function(e,t){if(t.isRing){var n=this.getPlayerClass(t.player);this.viewInfo.spaceInfo[e.y][e.x].isRing=!0,this.viewInfo.spaceInfo[e.y][e.x].ringClasses=[n+"-stroke"]}else this.viewInfo.spaceInfo[e.y][e.x].isRing=!1,this.viewInfo.spaceInfo[e.y][e.x].ringClasses=[]}},{key:"setMarkerInfo",value:function(e,t){if(this.viewInfo.spaceInfo[e.y][e.x].isMarker=!1,this.viewInfo.spaceInfo[e.y][e.x].markerClasses=[],t!==sve.EMPTY&&(!t.isRing||t.isRing&&this.moveStart.equalsValue(e))){var n=this.getPlayerClass(t.player);this.viewInfo.spaceInfo[e.y][e.x].isMarker=!0,this.viewInfo.spaceInfo[e.y][e.x].markerClasses=[n]}}},{key:"cancelMoveAttempt",value:function(){this.constructedState=this.rules.node.gameState,this.possibleCaptures=[],this.initialCaptures=[],this.finalCaptures=[],this.viewInfo.selectedCoords=[],this.currentCapture=sB.empty(),this.moveStart=sB.empty(),this.moveEnd=sB.empty(),this.currentlyMoved=[],this.moveToInitialCaptureOrMovePhase()}},{key:"showLastMove",value:function(){var e=this,t=this.rules.node.move;if(t.isPresent()){var n=t.get();if(n.isInitialPlacement())this.viewInfo.spaceInfo[n.start.y][n.start.x].spaceClasses=["moved"];else{var r,i=Qv(this.coordsBetween(n.start,n.end.get()));try{for(i.s();!(r=i.n()).done;){var a=r.value;this.viewInfo.spaceInfo[a.y][a.x].spaceClasses=["moved"]}}catch(s){i.e(s)}finally{i.f()}var o=this.currentCapture.isAbsent()&&0===this.initialCaptures.length&&this.moveStart.isAbsent();n.initialCaptures.forEach(function(t){return e.showLastMoveCapture(t,o)}),n.finalCaptures.forEach(function(t){return e.showLastMoveCapture(t,o)})}}}},{key:"coordsBetween",value:function(e,t){for(var n=[],r=lre.factory.fromMove(e,t).get(),i=e;!i.equals(t);i=i.getNext(r))this.constructedState.getPieceAt(i)!==sve.EMPTY&&n.push(i),n.push(t);return n}},{key:"showLastMoveCapture",value:function(e,t){var n,r=Qv(e.capturedSpaces);try{for(r.s();!(n=r.n()).done;){var i=n.value;this.viewInfo.spaceInfo[i.y][i.x].spaceClasses=["captured"],t&&this.markRemovedMarker(i,this.rules.node.gameState.getCurrentPlayer().getOpponent())}}catch(a){r.e(a)}finally{r.f()}this.viewInfo.spaceInfo[e.ringTaken.get().y][e.ringTaken.get().x].spaceClasses=["captured"],t&&this.markRemovedRing(e.ringTaken.get(),this.rules.node.gameState.getCurrentPlayer().getOpponent())}},{key:"moveToInitialCaptureOrMovePhase",value:function(){return this.possibleCaptures=this.rules.getPossibleCaptures(this.constructedState),this.movePhase=0===this.possibleCaptures.length?"MOVE_START":"INITIAL_CAPTURE_SELECT_FIRST",this.updateViewInfo(),K5.SUCCESS}},{key:"onClick",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#click_"+e.x+"_"+e.y)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:n.t0=t.movePhase,n.next="INITIAL_CAPTURE_SELECT_FIRST"===n.t0||"FINAL_CAPTURE_SELECT_FIRST"===n.t0?6:"INITIAL_CAPTURE_SELECT_LAST"===n.t0||"FINAL_CAPTURE_SELECT_LAST"===n.t0?7:"INITIAL_CAPTURE_SELECT_RING"===n.t0||"FINAL_CAPTURE_SELECT_RING"===n.t0?8:"MOVE_START"===n.t0?9:"MOVE_END"===n.t0?10:11;break;case 6:return n.abrupt("return",t.selectCaptureFirstCoord(e));case 7:return n.abrupt("return",t.selectCaptureLastCoord(e));case 8:return n.abrupt("return",t.selectRing(e));case 9:return n.abrupt("return",t.selectMoveStart(e));case 10:return n.abrupt("return",t.selectMoveEnd(e));case 11:case"end":return n.stop()}},n)}))()}},{key:"selectCaptureFirstCoord",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r=[],t.possibleCaptures.forEach(function(t){t.contains(e)&&r.push(t)}),!(r.length>1)){n.next=5;break}t.viewInfo.selectedCoords.push(e),t.moveToCaptureSelectLast(r),n.next=8;break;case 5:if(0!==r.length){n.next=7;break}return n.abrupt("return",t.cancelMove(ove.MISSING_CAPTURES()));case 7:t.selectCapture(r[0]);case 8:return n.abrupt("return",K5.SUCCESS);case 9:case"end":return n.stop()}},n)}))()}},{key:"moveToCaptureSelectLast",value:function(e){this.viewInfo.selectableCoords=[],this.possibleCaptures=e;var t,n=Qv(e);try{for(n.s();!(t=n.n()).done;){var r,i=Qv(t.value.capturedSpaces);try{for(i.s();!(r=i.n()).done;){var a=r.value;this.viewInfo.selectableCoords.push(a)}}catch(o){i.e(o)}finally{i.f()}}}catch(o){n.e(o)}finally{n.f()}switch(this.movePhase){case"INITIAL_CAPTURE_SELECT_FIRST":this.movePhase="INITIAL_CAPTURE_SELECT_LAST";break;case"FINAL_CAPTURE_SELECT_FIRST":this.movePhase="FINAL_CAPTURE_SELECT_LAST"}}},{key:"selectCaptureLastCoord",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=[],n.abrupt("return",(t.possibleCaptures.forEach(function(t){t.contains(e)&&r.push(t)}),r.length>1?t.cancelMove(ove.AMBIGUOUS_CAPTURE_COORD()):0===r.length?t.cancelMove(ove.MISSING_CAPTURES()):t.selectCapture(r[0])));case 2:case"end":return n.stop()}},n)}))()}},{key:"selectCapture",value:function(e){switch(this.currentCapture=sB.of(e),this.constructedState=new uve(this.rules.applyCaptureWithoutTakingRing(this.constructedState,e),this.constructedState.sideRings,this.constructedState.turn),this.movePhase){case"INITIAL_CAPTURE_SELECT_FIRST":case"INITIAL_CAPTURE_SELECT_LAST":this.movePhase="INITIAL_CAPTURE_SELECT_RING";break;case"FINAL_CAPTURE_SELECT_FIRST":case"FINAL_CAPTURE_SELECT_LAST":this.movePhase="FINAL_CAPTURE_SELECT_RING"}return this.updateViewInfo(),K5.SUCCESS}},{key:"markCurrentCapture",value:function(e){var t,n=Qv(e.capturedSpaces);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.viewInfo.selectedCoords.push(r),this.markRemovedMarker(r,this.rules.node.gameState.getCurrentPlayer())}}catch(i){n.e(i)}finally{n.f()}e.ringTaken.isPresent()&&(this.viewInfo.selectedCoords.push(e.ringTaken.get()),this.markRemovedRing(e.ringTaken.get(),this.rules.node.gameState.getCurrentPlayer()))}},{key:"markRemovedMarker",value:function(e,t){this.viewInfo.spaceInfo[e.y][e.x].removedClass="transparent",this.setMarkerInfo(e,sve.MARKERS[t.value])}},{key:"markRemovedRing",value:function(e,t){this.viewInfo.spaceInfo[e.y][e.x].removedClass="transparent",this.setRingInfo(e,sve.RINGS[t.value])}},{key:"selectRing",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.rules.ringSelectionValidity(t.constructedState,e)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:t.constructedState=t.rules.takeRing(t.constructedState,e),i=t.currentCapture.get().setRingTaken(e),n.t0=(t.currentCapture=sB.empty(),t.possibleCaptures=t.rules.getPossibleCaptures(t.constructedState),t.movePhase),n.next="INITIAL_CAPTURE_SELECT_RING"===n.t0?8:9;break;case 8:return n.abrupt("return",(t.initialCaptures.push(i),0===t.possibleCaptures.length?t.moveToMovePhase():(t.movePhase="INITIAL_CAPTURE_SELECT_FIRST",t.updateViewInfo(),K5.SUCCESS)));case 9:return n.abrupt("return",(nB.expectToBe(t.movePhase,"FINAL_CAPTURE_SELECT_RING"),t.finalCaptures.push(i),0===t.possibleCaptures.length?t.tryMove():(t.movePhase="FINAL_CAPTURE_SELECT_FIRST",t.updateViewInfo(),K5.SUCCESS)));case 10:case"end":return n.stop()}},n)}))()}},{key:"moveToMovePhase",value:function(){return this.movePhase="MOVE_START",this.updateViewInfo(),K5.SUCCESS}},{key:"tryMove",value:function(){var e=this;return tB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=new lve(e.initialCaptures,e.moveStart.get(),e.moveEnd,e.finalCaptures),t.next=3,e.chooseMove(n,e.rules.node.gameState,e.scores.get());case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}},t)}))()}},{key:"selectMoveStart",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!t.constructedState.isInitialPlacementPhase()){n.next=3;break}return r=t.rules.initialPlacementValidity(t.constructedState,e),n.abrupt("return",r.isFailure()?t.cancelMove(r.getReason()):(t.moveStart=sB.of(e),t.tryMove()));case 3:if(!(i=t.rules.moveStartValidity(t.constructedState,e)).isFailure()){n.next=6;break}return n.abrupt("return",t.cancelMove(i.getReason()));case 6:return t.moveStart=sB.of(e),t.movePhase="MOVE_END",t.updateViewInfo(),n.abrupt("return",K5.SUCCESS);case 8:case"end":return n.stop()}},n)}))()}},{key:"selectMoveEnd",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.rules.moveValidity(t.constructedState,t.moveStart.get(),e),n.abrupt("return",r.isFailure()?t.cancelMove(r.getReason()):(t.moveEnd=sB.of(e),t.currentlyMoved=t.coordsBetween(t.moveStart.get(),e),t.constructedState=t.rules.applyRingMoveAndFlip(t.constructedState,t.moveStart.get(),e),t.updateViewInfo(),t.moveToFinalCapturePhaseOrTryMove()));case 2:case"end":return n.stop()}},n)}))()}},{key:"moveToFinalCapturePhaseOrTryMove",value:function(){var e=this;return tB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(e.possibleCaptures=e.rules.getPossibleCaptures(e.constructedState),0===e.possibleCaptures.length?e.tryMove():(e.movePhase="FINAL_CAPTURE_SELECT_FIRST",e.updateViewInfo(),K5.SUCCESS)));case 1:case"end":return t.stop()}},t)}))()}}]),n}(ure);function Fve(e,t){if(1&e&&(lb(0,"option",5),Rb(1),hb()),2&e){var n=t.$implicit;ub("value",n),Pw(1),Nb(n)}}Lve.RING_OUTER_SIZE=40,Lve.RING_MID_SIZE=34,Lve.RING_INNER_SIZE=28,Lve.MARKER_SIZE=Lve.RING_INNER_SIZE,Lve.INDICATOR_SIZE=10,Lve.\u0275fac=function(e){return new(e||Lve)(sb(ore))},Lve.\u0275cmp=ey({type:Lve,selectors:[["app-yinsh"]],features:[zC],decls:6,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 250 1065 1060","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngIf"],[3,"id","click"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[3,"id","ngClass"],["class","base no-fill mid-stroke",4,"ngIf"],["class","base no-fill",3,"id","ngClass",4,"ngIf"],["class","base mid-stroke",3,"id","ngClass",4,"ngIf"],[1,"base","no-fill","mid-stroke"],[1,"base","no-fill",3,"id","ngClass"],[1,"base","mid-stroke",3,"id","ngClass"],["pointer-events","fill","stroke-linecap","round",1,"base","no-fill","selected",3,"id","click"],["pointer-events","fill","class","base no-fill capturable","stroke-linecap","round",3,"id","click",4,"ngIf"],["pointer-events","fill","stroke-linecap","round",1,"base","no-fill","capturable",3,"id","click"],[1,"indicator",3,"click"],[1,"base","no-fill","mid-stroke",3,"id"],[1,"base","no-fill",3,"ngClass"]],template:function(e,t){1&e&&(_m(),lb(0,"svg",0),ab(1,Ove,2,1,"g",1),ab(2,Tve,2,3,"g",1),ab(3,xve,2,1,"g",1),ab(4,Ave,2,4,"g",1),ab(5,Mve,2,2,"g",1),hb()),2&e&&(Pw(1),ub("ngForOf",t.viewInfo.spaceInfo),Pw(1),ub("ngForOf",t.viewInfo.selectedCoords),Pw(1),ub("ngForOf",t.viewInfo.selectableCoords),Pw(1),ub("ngForOf",t.viewInfo.targets),Pw(1),ub("ngForOf",eP(5,Dve)))},directives:[AT,NT,IT],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});var Bve=function(){var e=rp(function e(){tp(this,e)});return e.ABALONE=function(){return $localize(Yc||(Yc=Rv(["Use simple mechanics to push 6 of the opponent's pieces out of the board!"])))},e.APAGOS=function(){return $localize(Kc||(Kc=Rv(["Very simple game, but, will you be able to win everytime?"])))},e.AWALE=function(){return $localize(Jc||(Jc=Rv(["The international version of the famous African strategy game!"])))},e.BRANDHUB=function(){return $localize(Qc||(Qc=Rv(["The Irish version of the Tafl game family!"])))},e.COERCEO=function(){return $localize(Xc||(Xc=Rv(["Get rid of all of your opponent's pieces on a board that shrinks little by little!"])))},e.CONSPIRATEURS=function(){return $localize(el||(el=Rv(["Hide all of your pieces before your opponent does, or risk to be discovered!"])))},e.DIAM=function(){return $localize(tl||(tl=Rv(["Drop your pieces and move them around to align two pieces of the same color across the board to win!"])))},e.DVONN=function(){return $localize(nl||(nl=Rv(["Stack your pieces and control as many stacks as you can to win!"])))},e.ENCAPSULE=function(){return $localize(rl||(rl=Rv(["An enhanced tic-tac-toe where piece can encapsule other and prevent them to win."])))},e.EPAMINONDAS=function(){return $localize(il||(il=Rv(["An antiquity-war inspired game. Be the first to pierce your opponent's lines!"])))},e.GIPF=function(){return $localize(al||(al=Rv(["A hexagonal game of alignment. Insert your pieces on the board to capture your opponent's pieces!"])))},e.GO=function(){return $localize(ol||(ol=Rv(["The oldest strategy game still practiced widely. A territory control game."])))},e.KAMISADO=function(){return $localize(sl||(sl=Rv(["Your goal is simple: reach the last line. But the piece you move depends on your opponent's last move!"])))},e.LINES_OF_ACTION=function(){return $localize(ul||(ul=Rv(["Regroup your pieces to win. But your possible moves will often change!"])))},e.P4=function(){return $localize(cl||(cl=Rv(["The classical 4 in a row game!"])))},e.PENTAGO=function(){return $localize(ll||(ll=Rv(["Drop a piece, then rotate a quadrant. The first player to align 5 pieces wins!"])))},e.PYLOS=function(){return $localize(hl||(hl=Rv(["Overlay your pieces and use two game mechanics to conserve your pieces. First player to run out of pieces loses!"])))},e.QUARTO=function(){return $localize(fl||(fl=Rv(["Create a winning alignment. The problem: you don't pick the piece that you're placing on the board!"])))},e.QUIXO=function(){return $localize(dl||(dl=Rv(["Align 5 of your pieces on a board where pieces slide!"])))},e.REVERSI=function(){return $localize(vl||(vl=Rv(["Sandwich your opponent's pieces to dominate the board!"])))},e.SAHARA=function(){return $localize(pl||(pl=Rv(["Immobilize one of your opponent's pyramids before your opponent does!"])))},e.SIAM=function(){return $localize(gl||(gl=Rv(["Be the first to push a mountain out of the board!"])))},e.SIX=function(){return $localize(yl||(yl=Rv(["Put your hexagonal pieces next to another one, and create one of the 3 victorious shapes to win!"])))},e.TABLUT=function(){return $localize(ml||(ml=Rv(["The Viking board game! Invaders must capture the king, defender must make him escape!"])))},e.YINSH=function(){return $localize(kl||(kl=Rv(["Align your pieces to score points, but beware, pieces can flip!"])))},e}(),Vve=function(){var e=rp(function e(t,n,r,i,a){var o=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];tp(this,e),this.name=t,this.urlName=n,this.component=r,this.creationDate=i,this.description=a,this.display=o});return e.ALL_GAMES=function(){return[new e("MinimaxTesting","MinimaxTesting",Gce,new Date("1970-01-01"),"",!1),new e($localize(_l||(_l=Rv(["Four in a Row"]))),"P4",ile,new Date("2018-08-28"),Bve.P4()),new e($localize(wl||(wl=Rv(["Awal\xe9"]))),"Awale",Pie,new Date("2018-11-29"),Bve.AWALE()),new e($localize(Cl||(Cl=Rv(["Quarto"]))),"Quarto",Bhe,new Date("2018-12-09"),Bve.QUARTO()),new e($localize(bl||(bl=Rv(["Tablut"]))),"Tablut",ave,new Date("2018-12-27"),Bve.TABLUT()),new e($localize(El||(El=Rv(["Reversi"]))),"Reversi",dfe,new Date("2019-01-16"),Bve.REVERSI()),new e($localize(Sl||(Sl=Rv(["Go"]))),"Go",Vue,new Date("2019-12-21"),Bve.GO()),new e($localize(Pl||(Pl=Rv(["Encapsule"]))),"Encapsule",Sse,new Date("2019-12-30"),Bve.ENCAPSULE()),new e($localize(Ol||(Ol=Rv(["Siam"]))),"Siam",pde,new Date("2020-01-11"),Bve.SIAM()),new e($localize(Tl||(Tl=Rv(["Sahara"]))),"Sahara",Rfe,new Date("2020-02-29"),Bve.SAHARA()),new e($localize(Il||(Il=Rv(["Pylos"]))),"Pylos",jle,new Date("2020-10-02"),Bve.PYLOS()),new e($localize(xl||(xl=Rv(["Kamisado"]))),"Kamisado",mce,new Date("2020-10-03"),Bve.KAMISADO()),new e($localize(Al||(Al=Rv(["Quixo"]))),"Quixo",Xhe,new Date("2020-10-15"),Bve.QUIXO()),new e($localize(Rl||(Rl=Rv(["Dvonn"]))),"Dvonn",tse,new Date("2020-10-21"),Bve.DVONN()),new e($localize(Nl||(Nl=Rv(["Epaminondas"]))),"Epaminondas",zse,new Date("2021-01-16"),Bve.EPAMINONDAS()),new e($localize(Ml||(Ml=Rv(["Gipf"]))),"Gipf",hue,new Date("2021-02-22"),Bve.GIPF()),new e($localize(Dl||(Dl=Rv(["Coerceo"]))),"Coerceo",Fae,new Date("2021-03-21"),Bve.COERCEO()),new e($localize(Ll||(Ll=Rv(["Six"]))),"Six",Bde,new Date("2021-04-08"),Bve.SIX()),new e($localize(Fl||(Fl=Rv(["Lines of Action"]))),"LinesOfAction",Rce,new Date("2021-04-28"),Bve.LINES_OF_ACTION()),new e($localize(Bl||(Bl=Rv(["Pentago"]))),"Pentago",Ele,new Date("2021-05-23"),Bve.PENTAGO()),new e($localize(Vl||(Vl=Rv(["Abalone"]))),"Abalone",tie,new Date("2021-07-13"),Bve.ABALONE()),new e($localize(Ul||(Ul=Rv(["Yinsh"]))),"Yinsh",Lve,new Date("2021-07-31"),Bve.YINSH()),new e($localize(zl||(zl=Rv(["Apagos"]))),"Apagos",gie,new Date("2021-11-04"),Bve.APAGOS()),new e($localize(Hl||(Hl=Rv(["Diam"]))),"Diam",Soe,new Date("2021-11-30"),Bve.DIAM()),new e($localize(Gl||(Gl=Rv(["Brandhub"]))),"Brandhub",uae,new Date("2021-12-07"),Bve.BRANDHUB()),new e($localize(ql||(ql=Rv(["Conspirateurs"]))),"Conspirateurs",ioe,new Date("2021-12-30"),Bve.CONSPIRATEURS())].sort(function(e,t){return e.name.localeCompare(t.name)})},e}(),Uve=function(){var e=function(){function e(){tp(this,e),this.gameNameList=Vve.ALL_GAMES().filter(function(e){return!0===e.display}).map(function(e){return e.urlName}),this.pickGame=new hP}return rp(e,[{key:"onChange",value:function(e){this.pickGame.emit(e.target.value)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=ey({type:e,selectors:[["app-pick-game"]],outputs:{pickGame:"pickGame"},decls:5,vars:1,consts:function(){return[[1,"select","is-primary","is-fullwidth"],["id","gameType",3,"change"],["value","","selected",""],$localize($l||($l=Rv(["Pick a game"]))),[3,"value",4,"ngFor","ngForOf"],[3,"value"]]},template:function(e,t){1&e&&(lb(0,"div",0),lb(1,"select",1),mb("change",function(e){return t.onChange(e)}),lb(2,"option",2),UE(3,3),hb(),ab(4,Fve,2,2,"option",4),hb(),hb()),2&e&&(Pw(4),ub("ngForOf",t.gameNameList))},directives:[nA,oA,AT],encapsulation:2}),e}();function zve(e,t){if(1&e){var n=pb();lb(0,"div",26),lb(1,"div",27),mb("click",function(){return $y(n),wb().closeInfo()}),hb(),lb(2,"div",28),lb(3,"header",29),lb(4,"p",30),Rb(5),hb(),lb(6,"button",31),mb("click",function(){return $y(n),wb().closeInfo()}),hb(),hb(),lb(7,"section",32),lb(8,"div",6),lb(9,"div",33),lb(10,"p",34),fb(11,"img",35),hb(),hb(),lb(12,"div",7),lb(13,"div",13),Rb(14),hb(),hb(),hb(),lb(15,"div",6),lb(16,"div",33),lb(17,"a",36),mb("click",function(){$y(n);var e=wb();return e.createGame(e.gameInfoDetails.get().urlName)}),fb(18,"fa-icon",37),Rb(19,"\xa0"),lb(20,"span"),UE(21,38),hb(),hb(),hb(),lb(22,"div",33),lb(23,"a",36),mb("click",function(){$y(n);var e=wb();return e.createLocalGame(e.gameInfoDetails.get().urlName)}),fb(24,"fa-icon",37),Rb(25,"\xa0"),lb(26,"span"),UE(27,39),hb(),hb(),hb(),lb(28,"div",33),lb(29,"a",36),mb("click",function(){$y(n);var e=wb();return e.createTutorial(e.gameInfoDetails.get().urlName)}),fb(30,"fa-icon",37),Rb(31,"\xa0"),lb(32,"span"),UE(33,40),hb(),hb(),hb(),hb(),hb(),hb(),hb()}if(2&e){var r=wb();Pw(5),Nb(r.gameInfoDetails.get().name),Pw(6),bb("src","assets/images/",r.theme,"/",r.gameInfoDetails.get().urlName,".png",k_),Pw(3),Mb(" ",r.gameInfoDetails.get().description," "),Pw(4),ub("icon",r.iconOnlineGame),Pw(6),ub("icon",r.iconLocalGame),Pw(6),ub("icon",r.iconTutorial)}}function Hve(e,t){if(1&e){var n=pb();lb(0,"div",8),lb(1,"div",9),lb(2,"p",10),Rb(3),hb(),hb(),lb(4,"div",42),lb(5,"figure",34),lb(6,"img",43),mb("click",function(){var e=$y(n).$implicit;return wb(2).openInfo(e)}),hb(),lb(7,"figcaption",44),mb("click",function(){var e=$y(n).$implicit;return wb(2).openInfo(e)}),lb(8,"div",45),Rb(9,"?"),hb(),hb(),lb(10,"figcaption",46),lb(11,"a",47),mb("click",function(){var e=$y(n).$implicit;return wb(2).createGame(e.urlName)}),fb(12,"fa-icon",37),hb(),lb(13,"a",48),mb("click",function(){var e=$y(n).$implicit;return wb(2).createLocalGame(e.urlName)}),fb(14,"fa-icon",37),hb(),lb(15,"a",49),mb("click",function(){var e=$y(n).$implicit;return wb(2).createTutorial(e.urlName)}),fb(16,"fa-icon",37),hb(),hb(),hb(),hb(),lb(17,"div",50),Rb(18),hb(),hb()}if(2&e){var r=t.$implicit,i=wb(2);Pw(3),Nb(r.name),Pw(3),Cb("id","image_",r.urlName,""),bb("src","assets/images/",i.theme,"/",r.urlName,".png",k_),Pw(5),Cb("id","playOnline_",r.urlName,""),Pw(1),ub("icon",i.iconOnlineGame),Pw(1),Cb("id","playLocally_",r.urlName,""),Pw(1),ub("icon",i.iconLocalGame),Pw(1),Cb("id","startTutorial_",r.urlName,""),Pw(1),ub("icon",i.iconTutorial),Pw(2),Mb(" ",r.description," ")}}function Gve(e,t){if(1&e&&(lb(0,"div",7),ab(1,Hve,19,11,"div",41),hb()),2&e){var n=t.$implicit;Pw(1),ub("ngForOf",n)}}var qve=function(){var e=function(){function e(t,n){tp(this,e),this.router=t,this.numberOfColumns=4,this.games=[],this.iconOnlineGame=pte,this.iconLocalGame=dte,this.iconTutorial=hte,this.gameInfoDetails=sB.empty(),this.theme=n.getTheme();for(var r=Vve.ALL_GAMES().filter(function(e){return!0===e.display}),i=0,a=0;a<r.length;a++)a<this.numberOfColumns&&this.games.push([]),this.games[i].push(r[a]),i=(i+1)%this.numberOfColumns}return rp(e,[{key:"createGame",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t.router.navigate(["/play",e]));case 1:case"end":return n.stop()}},n)}))()}},{key:"createLocalGame",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t.router.navigate(["/local",e]));case 1:case"end":return n.stop()}},n)}))()}},{key:"createTutorial",value:function(e){return this.router.navigate(["/tutorial",e])}},{key:"openInfo",value:function(e){this.gameInfoDetails=sB.of(e)}},{key:"closeInfo",value:function(){this.gameInfoDetails=sB.empty()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(sb(qM),sb(lte))},e.\u0275cmp=ey({type:e,selectors:[["app-welcome"]],decls:33,vars:2,consts:function(){return[[1,"hero"],[1,"hero-body"],[1,"title"],$localize(Wl||(Wl=Rv(["EveryBoard"]))),[1,"subtitle"],$localize(jl||(jl=Rv(["EveryBoard is a website to play and learn the rules of various abstract strategy games with perfect information.",":LINE_BREAK: Such games are games that do not include any randomness, agility, or hidden information. These games are played by two players, turn by turn."])),"\ufffd#6\ufffd\ufffd/#6\ufffd"),[1,"columns"],[1,"column"],[1,"card"],[1,"card-header"],[1,"card-header-title"],$localize(Zl||(Zl=Rv(["Play online"]))),[1,"card-content"],[1,"content"],["id","createOnlineGame","routerLink","/play",1,"button","is-medium","is-fullwidth","is-primary","mb-1"],$localize(Yl||(Yl=Rv(["Create an online game"]))),["id","seeGameList","routerLink","/lobby",1,"button","is-medium","is-fullwidth","is-primary"],$localize(Kl||(Kl=Rv(["See the game list"]))),$localize(Jl||(Jl=Rv(["Play offline"]))),[1,"content","has-text-centered"],["routerLink","/local",1,"button","is-medium","is-fullwidth","is-primary","mb-1"],$localize(Ql||(Ql=Rv(["Play"]))),["routerLink","/tutorial",1,"button","is-medium","is-fullwidth","is-primary"],$localize(Xl||(Xl=Rv(["Learn"]))),["id","gameInfoModal","class","modal is-active",4,"ngIf"],["class","column",4,"ngFor","ngForOf"],["id","gameInfoModal",1,"modal","is-active"],["id","modalBackground",1,"modal-background",3,"click"],[1,"modal-card"],[1,"modal-card-head","is-primary"],[1,"modal-card-title"],["id","closeInfo","aria-label","close",1,"delete",3,"click"],[1,"modal-card-body"],[1,"column","is-one-third"],[1,"image"],[3,"src"],[1,"button","is-fullwidth",3,"click"],[3,"icon"],$localize(eh||(eh=Rv(["Play online"]))),$localize(th||(th=Rv(["Play offline"]))),$localize(nh||(nh=Rv(["Learn the rules"]))),["class","card",4,"ngFor","ngForOf"],[1,"card-image","game-card"],[1,"is-clickable",3,"id","src","click"],[1,"has-text-centered","is-overlay","game-image-text","is-clickable",3,"click"],[1,"is-size-1","has-text-weight-bold"],[1,"has-text-centered","is-overlay","game-image-buttons"],["data-tooltip",$localize(rh||(rh=Rv(["Play online"]))),1,"button",3,"id","click"],["data-tooltip",$localize(ih||(ih=Rv(["Play offline"]))),1,"button",3,"id","click"],["data-tooltip",$localize(ah||(ah=Rv(["Learn the rules"]))),1,"button",3,"id","click"],[1,"card-content","is-hidden"]]},template:function(e,t){1&e&&(lb(0,"section",0),lb(1,"div",1),lb(2,"p",2),UE(3,3),hb(),lb(4,"p",4),BE(5,5),fb(6,"br"),VE(),hb(),hb(),lb(7,"div",6),lb(8,"div",7),lb(9,"div",8),lb(10,"header",9),lb(11,"p",10),UE(12,11),hb(),hb(),lb(13,"div",12),lb(14,"div",13),lb(15,"button",14),UE(16,15),hb(),lb(17,"button",16),UE(18,17),hb(),hb(),hb(),hb(),hb(),lb(19,"div",7),lb(20,"div",8),lb(21,"header",9),lb(22,"p",10),UE(23,18),hb(),hb(),lb(24,"div",12),lb(25,"div",19),lb(26,"button",20),UE(27,21),hb(),lb(28,"button",22),UE(29,23),hb(),hb(),hb(),hb(),hb(),hb(),ab(30,zve,34,7,"div",24),lb(31,"div",6),ab(32,Gve,2,1,"div",25),hb(),hb()),2&e&&(Pw(30),ub("ngIf",t.gameInfoDetails.isPresent()),Pw(2),ub("ngForOf",t.games))},directives:[WM,NT,AT,Vne],encapsulation:2}),e}(),$ve=function(){var e=function(){function e(t){tp(this,e),this.element=t}return rp(e,[{key:"ngAfterViewInit",value:function(){this.element.nativeElement.focus()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(sb(rS))},e.\u0275dir=oy({type:e,selectors:[["","autofocus",""]]}),e}(),Wve=function(){var e=function(){function e(t){var n=this;tp(this,e),this.shown=!1,this.input=t.nativeElement.parentNode.previousSibling,t.nativeElement.addEventListener("click",function(e){n.toggle()})}return rp(e,[{key:"toggle",value:function(){this.shown=!this.shown,this.input.setAttribute("type",this.shown?"text":"password"),this.input.focus()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(sb(rS))},e.\u0275dir=oy({type:e,selectors:[["","toggleVisibility",""]]}),e}();function jve(e,t){if(1&e&&(lb(0,"div",29),lb(1,"div",30),UE(2,31),hb(),lb(3,"div",32),Rb(4),hb(),hb()),2&e){var n=wb();Pw(4),Nb(n.errorMessage)}}var Zve=function(){return["/register"]},Yve=function(){return["/reset-password"]},Kve=function(){var e=function(){function e(t,n){tp(this,e),this.router=t,this.authenticationService=n,this.faEye=vte,this.loginForm=new Lx({email:new Dx,password:new Dx})}return rp(e,[{key:"ngOnInit",value:function(){var e,t=this;this.authenticationService.getUserObs().subscribe((e=tB(regeneratorRuntime.mark(function e(n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=n!==qee.NOT_CONNECTED,!e.t0){e.next=4;break}return e.next=4,t.redirect();case 4:case"end":return e.stop()}},e)})),function(t){return e.apply(this,arguments)}))}},{key:"loginWithEmail",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.authenticationService.doEmailLogin(e.email,e.password);case 2:(r=n.sent).isFailure()&&(t.errorMessage=r.getReason());case 4:case"end":return n.stop()}},n)}))()}},{key:"loginWithGoogle",value:function(){var e=this;return tB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.authenticationService.doGoogleLogin();case 2:(n=t.sent).isFailure()&&(e.errorMessage=n.getReason());case 4:case"end":return t.stop()}},t)}))()}},{key:"redirect",value:function(){var e=this;return tB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.router.navigate(["/lobby"]));case 1:case"end":return t.stop()}},t)}))()}},{key:"canLogin",value:function(){return!(""===(this.loginForm.value.email||"")||""===(this.loginForm.value.password||""))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(sb(qM),sb($ee))},e.\u0275cmp=ey({type:e,selectors:[["app-login"]],decls:49,vars:8,consts:function(){return[[1,"box"],[1,"title"],$localize(oh||(oh=Rv(["Log in"]))),[3,"formGroup"],[1,"field","is-horizontal"],[1,"field-label"],["for","email",1,"label"],$localize(sh||(sh=Rv(["Email"]))),[1,"field-body"],[1,"field"],[1,"control"],["id","email","type","text","placeholder",$localize(uh||(uh=Rv(["Email"]))),"formControlName","email","name","email","type","email","autofocus","","required","",1,"input"],["for","password",1,"label"],$localize(ch||(ch=Rv(["Password"]))),[1,"control","has-icons-right","is-expanded"],["id","password","type","password","placeholder",$localize(lh||(lh=Rv(["Password"]))),"formControlName","password","name","password","required","",1,"input"],[1,"icon","is-small","is-right"],["toggleVisibility","",1,"clickable-icon",3,"icon"],["id","loginButton",1,"button","is-primary","is-fullwidth",3,"disabled","click"],$localize(hh||(hh=Rv(["Log in"]))),["id","googleButton","type","submit",1,"button","is-fullwidth",3,"click"],$localize(fh||(fh=Rv(["Log in with Google"]))),["class","message is-danger","role","alert",4,"ngIf"],[1,"help","level-right"],$localize(dh||(dh=Rv(["No account?"]))),[3,"routerLink"],$localize(vh||(vh=Rv(["Register"]))),$localize(ph||(ph=Rv(["Forgot your password?"]))),$localize(gh||(gh=Rv(["Reset your password"]))),["role","alert",1,"message","is-danger"],[1,"message-header"],$localize(yh||(yh=Rv(["Connection error"]))),["id","errorMessage",1,"message-body"]]},template:function(e,t){1&e&&(lb(0,"div",0),lb(1,"p",1),UE(2,2),hb(),lb(3,"form",3),lb(4,"div",4),lb(5,"div",5),lb(6,"label",6),UE(7,7),hb(),hb(),lb(8,"div",8),lb(9,"div",9),lb(10,"div",10),fb(11,"input",11),hb(),hb(),hb(),hb(),lb(12,"div",4),lb(13,"div",5),lb(14,"label",12),UE(15,13),hb(),hb(),lb(16,"div",8),lb(17,"div",9),lb(18,"div",14),fb(19,"input",15),lb(20,"span",16),fb(21,"fa-icon",17),hb(),hb(),hb(),hb(),hb(),lb(22,"div",4),fb(23,"div",5),lb(24,"div",8),lb(25,"div",9),lb(26,"div",10),lb(27,"button",18),mb("click",function(){return t.loginWithEmail(t.loginForm.value)}),UE(28,19),hb(),hb(),hb(),hb(),hb(),lb(29,"div",4),fb(30,"div",5),lb(31,"div",8),lb(32,"div",9),lb(33,"div",10),lb(34,"button",20),mb("click",function(){return t.loginWithGoogle()}),UE(35,21),hb(),hb(),hb(),hb(),hb(),ab(36,jve,5,1,"div",22),lb(37,"p",23),db(38),UE(39,24),vb(),Rb(40,"\xa0 "),lb(41,"a",25),UE(42,26),hb(),hb(),lb(43,"p",23),db(44),UE(45,27),vb(),Rb(46,"\xa0 "),lb(47,"a",25),UE(48,28),hb(),hb(),hb(),hb()),2&e&&(Pw(3),ub("formGroup",t.loginForm),Pw(18),ub("icon",t.faEye),Pw(6),ub("disabled",!t.canLogin()),Pw(9),ub("ngIf",t.errorMessage),Pw(5),ub("routerLink",eP(6,Zve)),Pw(6),ub("routerLink",eP(7,Yve)))},directives:[qx,fx,Kx,DI,hx,Qx,$ve,uA,Vne,Wve,NT,jM],encapsulation:2}),e}(),Jve=function(){var e=function(){function e(t){tp(this,e),this.partDAO=t,this.unsubscribe=sB.empty(),this.activePartsBS=new QA([]),this.activePartsObs=this.activePartsBS.asObservable()}return rp(e,[{key:"getActivePartsObs",value:function(){return this.activePartsObs}},{key:"startObserving",value:function(){var e=this;X5(this.unsubscribe.isAbsent(),"ActivePartsService: already observing");var t=new o6(function(t){var n,r=(n=e.activePartsBS.value).concat.apply(n,Kv(t));e.activePartsBS.next(r)},function(t){var n,r=e.activePartsBS.value,i=Qv(t);try{var a=function(){var e=n.value;r.forEach(function(t){t.id===e.id&&(t.data=e.data)})};for(i.s();!(n=i.n()).done;)a()}catch(o){i.e(o)}finally{i.f()}e.activePartsBS.next(r)},function(t){var n,r=[],i=Qv(e.activePartsBS.value);try{var a=function(){var e=n.value;t.some(function(t){return t.id===e.id})||r.push(e)};for(i.s();!(n=i.n()).done;)a()}catch(o){i.e(o)}finally{i.f()}e.activePartsBS.next(r)});this.unsubscribe=sB.of(this.partDAO.observeActiveParts(t))}},{key:"stopObserving",value:function(){X5(this.unsubscribe.isPresent(),"Cannot stop observing active parts when you have not started observing"),this.activePartsBS.next([]),this.unsubscribe.get()(),this.unsubscribe=sB.empty()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Pk(n6))},e.\u0275prov=Eg({token:e,factory:e.\u0275fac,providedIn:"any"}),e}(),Qve=function(){var e=function(){function e(t){tp(this,e),this.router=t}return rp(e,[{key:"pickGame",value:function(e){this.selectedGame=e}},{key:"navigateToOnlineGameCreation",value:function(){var e=this;return tB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.router.navigate(["/play",e.selectedGame]);case 2:case"end":return t.stop()}},t)}))()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(sb(qM))},e.\u0275cmp=ey({type:e,selectors:[["app-online-game-selection"]],decls:3,vars:1,consts:function(){return[[3,"pickGame"],["id","playOnline",1,"button","is-primary","is-fullwidth",3,"disabled","click"],$localize(mh||(mh=Rv(["Create an online game"])))]},template:function(e,t){1&e&&(lb(0,"app-pick-game",0),mb("pickGame",function(e){return t.pickGame(e)}),hb(),lb(1,"button",1),mb("click",function(){return t.navigateToOnlineGameCreation()}),UE(2,2),hb()),2&e&&(Pw(1),ub("disabled",!t.selectedGame))},directives:[Uve],encapsulation:2}),e}(),Xve=function(){var e=function(){function e(){tp(this,e)}return rp(e,[{key:"transform",value:function(e){return lT(1e3*e.seconds,"HH:mm:ss","en-US")}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=sy({name:"firebaseDate",type:e,pure:!0}),e}(),epe=["chatDiv"];function tpe(e,t){1&e&&(db(0),UE(1,5),vb())}function npe(e,t){1&e&&UE(0,6),2&e&&(zE(wb().unreadMessagesText),HE(0))}function rpe(e,t){if(1&e){var n=pb();lb(0,"button",11),mb("click",function(){return $y(n),wb(2).scrollToBottom()}),Rb(1),hb()}if(2&e){var r=wb(2);Pw(1),Mb("",r.unreadMessagesText," \u2193")}}function ipe(e,t){if(1&e&&(lb(0,"p"),Rb(1),oP(2,"firebaseDate"),lb(3,"b",12),Rb(4),hb(),lb(5,"span",13),Rb(6),hb(),hb()),2&e){var n=t.$implicit;Pw(1),Mb(" [",sP(2,3,n.postedTime),"] "),Pw(3),Mb("",n.sender.name," : "),Pw(2),Nb(n.content)}}function ape(e,t){if(1&e){var n=pb();lb(0,"div"),ab(1,rpe,2,1,"button",7),lb(2,"div",8,9),mb("scroll",function(){return $y(n),wb().updateCurrentScrollPosition()}),ab(4,ipe,7,5,"p",10),hb(),hb()}if(2&e){var r=wb();Pw(1),ub("ngIf",r.showUnreadMessagesButton),Pw(3),ub("ngForOf",r.chat)}}var ope=function(){return{standalone:!0}};function spe(e,t){if(1&e){var n=pb();lb(0,"form",14),mb("onSubmit",function(){return $y(n),wb().sendMessage()}),lb(1,"div",15),lb(2,"div",16),lb(3,"input",17,18),mb("ngModelChange",function(e){return $y(n),wb().userMessage=e}),hb(),lb(5,"p",19),Rb(6),hb(),hb(),lb(7,"div",20),lb(8,"button",21),mb("click",function(){return $y(n),wb().sendMessage()}),fb(9,"fa-icon",22),hb(),hb(),hb(),lb(10,"div",23),lb(11,"p"),lb(12,"strong"),UE(13,24),hb(),hb(),hb(),hb()}if(2&e){var r=ob(4),i=wb();Pw(3),ub("ngModel",i.userMessage)("ngModelOptions",eP(4,ope)),Pw(3),Mb("",r.value.length,"/128"),Pw(3),ub("icon",i.faReply)}}var upe=function(){var e=function(){function e(t,n){tp(this,e),this.chatService=t,this.authenticationService=n,this.userMessage="",this.connected=!1,this.chat=[],this.readMessages=0,this.unreadMessagesText="",this.showUnreadMessagesButton=!1,this.visible=!0,this.faReply=gte,this.isNearBottom=!0,this.notYetScrolled=!0,rB(e.VERBOSE,"ChatComponent constructor")}return rp(e,[{key:"ngOnInit",value:function(){rB(e.VERBOSE,"ChatComponent.ngOnInit for chat ".concat(this.chatId)),X5(null!=this.chatId&&""!==this.chatId,"No chat to join mentionned"),this.loadChatContent()}},{key:"ngAfterViewChecked",value:function(){this.scrollToBottomIfNeeded()}},{key:"loadChatContent",value:function(){var e=this,t=function(t){e.updateMessages(t.flatMap(function(e){return null==e.data.postedTime?[]:[e.data]}))},n=new o6(t,t,function(){});this.chatService.startObserving(this.chatId,n)}},{key:"updateMessages",value:function(e){this.chat=this.chat.concat(e);var t=this.chat.length;!0===this.visible&&!0===this.isNearBottom?(this.readMessages=t,this.updateUnreadMessagesText(0),this.scrollToBottom()):this.updateUnreadMessagesText(t-this.readMessages)}},{key:"updateUnreadMessagesText",value:function(e){this.showUnreadMessagesButton=!(!this.visible||!1!==this.isNearBottom),0===e?(this.unreadMessagesText=$localize(kh||(kh=Rv(["no new message"]))),this.showUnreadMessagesButton=!1):this.unreadMessagesText=1===e?$localize(_h||(_h=Rv(["1 new message"]))):$localize(wh||(wh=Rv([""," new messages"])),e)}},{key:"scrollToBottomIfNeeded",value:function(){this.visible&&(this.isNearBottom||this.notYetScrolled)&&this.scrollToBottom()}},{key:"updateCurrentScrollPosition",value:function(){this.isNearBottom=this.chatDiv.nativeElement.scrollTop+this.chatDiv.nativeElement.offsetHeight>this.chatDiv.nativeElement.scrollHeight-10}},{key:"scrollToBottom",value:function(){null!=this.chatDiv&&(this.updateUnreadMessagesText(0),this.scrollTo(this.chatDiv.nativeElement.scrollHeight),this.notYetScrolled=!1)}},{key:"scrollTo",value:function(e){this.chatDiv.nativeElement.scroll({top:e,left:0,behavior:"smooth"})}},{key:"sendMessage",value:function(){var e=this;return tB(regeneratorRuntime.mark(function t(){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.userMessage,e.userMessage="",r=e.authenticationService.user.get().toMinimalUser(),t.next=5,e.chatService.sendMessage(r,n,e.turn);case 5:case"end":return t.stop()}},t)}))()}},{key:"ngOnDestroy",value:function(){this.chatService.stopObserving()}},{key:"switchChatVisibility",value:function(){!0===this.visible?this.visible=!1:(this.visible=!0,this.updateUnreadMessagesText(0),this.scrollToBottom(),this.readMessages=this.chat.length)}}]),e}();return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(sb(a6),sb($ee))},e.\u0275cmp=ey({type:e,selectors:[["app-chat"]],viewQuery:function(e,t){var n;(1&e&&EP(epe,5),2&e)&&(bP(n=SP())&&(t.chatDiv=n.first))},inputs:{chatId:"chatId",turn:"turn"},decls:7,vars:4,consts:function(){return[["id","switchChatVisibilityButton",1,"button","is-primary","is-light","is-fullwidth",3,"click"],[4,"ngIf","ngIfElse"],["showChat",""],[4,"ngIf"],["id","chatForm",3,"onSubmit",4,"ngIf"],$localize(Ch||(Ch=Rv(["Hide chat"]))),$localize(bh||(bh=Rv(["Show chat (",":INTERPOLATION:)"])),"\ufffd0\ufffd"),["id","scrollToBottomIndicator","class","notification button is-info is-light is-fullwidth",3,"click",4,"ngIf"],["id","chatDiv",1,"is-fullwidth","block",2,"overflow-y","scroll","max-height","50vh",3,"scroll"],["chatDiv",""],[4,"ngFor","ngForOf"],["id","scrollToBottomIndicator",1,"notification","button","is-info","is-light","is-fullwidth",3,"click"],[1,"chat-sender"],[1,"chat-message"],["id","chatForm",3,"onSubmit"],[1,"field","has-addons","is-fullwidth"],[1,"control","is-expanded"],["id","message","type","text","placeholder",$localize(Eh||(Eh=Rv(["Type your message here"]))),"maxlength","128","value","",1,"input",3,"ngModel","ngModelOptions","ngModelChange"],["message",""],[1,"help"],[1,"control"],["type","submit","id","send",1,"button","is-primary",3,"click"],[1,"clickable-icon",3,"icon"],[1,"content","is-small"],$localize(Sh||(Sh=Rv(["Be polite"])))]},template:function(e,t){if(1&e&&(lb(0,"div"),lb(1,"button",0),mb("click",function(){return t.switchChatVisibility()}),ab(2,tpe,2,0,"ng-container",1),ab(3,npe,1,1,"ng-template",null,2,OP),hb(),ab(5,ape,5,2,"div",3),ab(6,spe,14,5,"form",4),hb()),2&e){var n=ob(4);Pw(2),ub("ngIf",t.visible)("ngIfElse",n),Pw(3),ub("ngIf",t.visible),Pw(1),ub("ngIf",t.visible)}},directives:[NT,AT,qx,fx,Ux,DI,lA,hx,Gx,Vne],pipes:[Xve],encapsulation:2}),e}();function cpe(e,t){if(1&e&&(db(0),Rb(1),vb()),2&e){var n=wb().$implicit;Pw(1),Nb(n.data.playerOne)}}function lpe(e,t){1&e&&UE(0,26)}function hpe(e,t){if(1&e){var n=pb();lb(0,"tr",22),mb("click",function(){var e=$y(n).$implicit;return wb(2).joinGame(e.id,e.data.typeGame)}),lb(1,"td",23),Rb(2),hb(),lb(3,"td",23),Rb(4),hb(),lb(5,"td",23),ab(6,cpe,2,1,"ng-container",24),ab(7,lpe,1,0,"ng-template",null,25,OP),hb(),lb(9,"td",23),Rb(10),hb(),hb()}if(2&e){var r=t.$implicit,i=t.index,a=ob(8);Cb("id","part_",i,""),Pw(2),Nb(r.data.typeGame),Pw(2),Nb(r.data.playerZero),Pw(2),ub("ngIf",r.data.playerOne)("ngIfElse",a),Pw(4),Nb(r.data.turn)}}function fpe(e,t){if(1&e&&(lb(0,"div",13),lb(1,"div",14),lb(2,"table",15),lb(3,"thead"),lb(4,"tr"),lb(5,"th",16),UE(6,17),hb(),lb(7,"th",16),UE(8,18),hb(),lb(9,"th",16),UE(10,19),hb(),lb(11,"th",16),UE(12,20),hb(),hb(),hb(),lb(13,"tbody"),ab(14,hpe,11,6,"tr",21),hb(),hb(),hb(),hb()),2&e){var n=wb();Pw(14),ub("ngForOf",n.activeParts)}}function dpe(e,t){1&e&&(lb(0,"div",27),fb(1,"app-online-game-selection",28),hb())}function vpe(e,t){if(1&e&&(db(0),Rb(1),oP(2,"date"),vb()),2&e){var n=wb().$implicit;Pw(1),Db(" ",n.data.username,": ",function(e,t,n,r,i){var a=e+20,o=Gy(),s=My(o,a);return cP(o,uP(o,a)?function(e,t,n,r,i,a,o,s){var u=t+n;return eb(e,u,i,a,o)?JC(e,u+3,s?r.call(s,i,a,o):r(i,a,o)):rP(e,u+3)}(o,em(),t,s.transform,n,r,i,s):s.transform(n,r,i))}(2,2,1e3*n.data.last_changed.seconds,"HH:mm:ss","+0100")," ")}}function ppe(e,t){if(1&e&&(lb(0,"li"),ab(1,vpe,3,6,"ng-container",37),hb()),2&e){var n=t.$implicit;Pw(1),ub("ngIf",n.data.last_changed)}}function gpe(e,t){if(1&e&&(lb(0,"div",29),lb(1,"div",30),lb(2,"div",31),fb(3,"app-chat",32),hb(),hb(),lb(4,"div",33),lb(5,"div",34),lb(6,"p"),UE(7,35),hb(),lb(8,"ul"),ab(9,ppe,2,1,"li",36),hb(),hb(),hb(),hb()),2&e){var n=wb();Pw(3),ub("turn",-1),Pw(6),ub("ngForOf",n.activeUsers)}}var ype=function(){var e=function(){function e(t,n,r){tp(this,e),this.router=t,this.userService=n,this.activePartsService=r,this.activeUsers=[],this.activeParts=[],this.currentTab="games"}return rp(e,[{key:"ngOnInit",value:function(){var t=this;rB(e.VERBOSE,"lobbyComponent.ngOnInit"),this.activeUsersSub=this.userService.getActiveUsersObs().subscribe(function(e){t.activeUsers=e}),this.activePartsService.startObserving(),this.activePartsSub=this.activePartsService.getActivePartsObs().subscribe(function(e){t.activeParts=e})}},{key:"ngOnDestroy",value:function(){rB(e.VERBOSE,"lobbyComponent.ngOnDestroy"),this.activeUsersSub.unsubscribe(),this.activePartsService.stopObserving(),this.activePartsSub.unsubscribe(),this.userService.unSubFromActiveUsersObs()}},{key:"joinGame",value:function(e,t){var n=this;return tB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.router.navigate(["/play",t,e]);case 2:case"end":return r.stop()}},r)}))()}},{key:"selectTab",value:function(e){this.currentTab=e}}]),e}();return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(sb(qM),sb(c6),sb(Jve))},e.\u0275cmp=ey({type:e,selectors:[["app-lobby"]],decls:14,vars:3,consts:function(){return[[1,"tabs","is-centered"],["ngClass","if (currentTab === 'games') 'is-active'"],["id","tab-games",3,"click"],$localize(Ph||(Ph=Rv(["Games"]))),["ngClass","if (currentTab === 'create') 'is-active'"],["id","tab-create",3,"click"],$localize(Oh||(Oh=Rv(["Create"]))),["ngClass","if (currentTab === 'chat') 'is-active'"],["id","tab-chat",3,"click"],$localize(Th||(Th=Rv(["Chat"]))),["id","actualGames","class","box",4,"ngIf"],["id","gameCreator","class","box",4,"ngIf"],["id","chatTab","class","columns",4,"ngIf"],["id","actualGames",1,"box"],[1,"table-container"],[1,"table","is-fullwidth","is-hoverable","is-striped"],["scope","col",1,"th"],$localize(Ih||(Ih=Rv(["Game"]))),$localize(xh||(xh=Rv(["First player"]))),$localize(Ah||(Ah=Rv(["Second player"]))),$localize(Rh||(Rh=Rv(["Turn"]))),[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"td"],[4,"ngIf","ngIfElse"],["waitingForOpponent",""],$localize(Nh||(Nh=Rv(["Waiting for opponent"]))),["id","gameCreator",1,"box"],["id","online-game-selection"],["id","chatTab",1,"columns"],["id","chatContainerDiv",1,"column","is-9"],["id","chat",1,"box"],["chatId","server",3,"turn"],[1,"column","is-3"],["id","onlineUser",1,"box"],$localize(Mh||(Mh=Rv(["Connected users:"]))),[4,"ngFor","ngForOf"],[4,"ngIf"]]},template:function(e,t){1&e&&(lb(0,"div",0),lb(1,"ul"),lb(2,"li",1),lb(3,"a",2),mb("click",function(){return t.selectTab("games")}),UE(4,3),hb(),hb(),lb(5,"li",4),lb(6,"a",5),mb("click",function(){return t.selectTab("create")}),UE(7,6),hb(),hb(),lb(8,"li",7),lb(9,"a",8),mb("click",function(){return t.selectTab("chat")}),UE(10,9),hb(),hb(),hb(),hb(),ab(11,fpe,15,1,"div",10),ab(12,dpe,2,0,"div",11),ab(13,gpe,10,2,"div",12)),2&e&&(Pw(11),ub("ngIf","games"===t.currentTab),Pw(1),ub("ngIf","create"===t.currentTab),Pw(1),ub("ngIf","chat"===t.currentTab))},directives:[IT,NT,AT,Qve,upe],pipes:[FT],encapsulation:2}),e}(),mpe=function(){var e=rp(function e(){tp(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=ey({type:e,selectors:[["app-not-found"]],decls:5,vars:0,consts:function(){return[[1,"message","is-danger"],[1,"message-header"],$localize(Dh||(Dh=Rv(["Game does not exist"]))),[1,"message-body"],$localize(Lh||(Lh=Rv(["The game you tried to join does not exist anymore."])))]},template:function(e,t){1&e&&(lb(0,"div",0),lb(1,"div",1),UE(2,2),hb(),lb(3,"div",3),UE(4,4),hb(),hb())},encapsulation:2}),e}();function kpe(e,t){}var _pe=function(){var e=rp(function e(t){tp(this,e),this.viewContainerRef=t,rB(e.VERBOSE,"GameIncluderComponent constructor")});return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(sb(US))},e.\u0275cmp=ey({type:e,selectors:[["app-game-includer"]],decls:1,vars:0,template:function(e,t){1&e&&ab(0,kpe,0,0,"ng-template")},encapsulation:2}),e}(),wpe=function(){var e=rp(function e(){tp(this,e)});return e.NOT_YOUR_TURN=function(){return $localize(Fh||(Fh=Rv(["It is not your turn!"])))},e.NO_CLONING_FEATURE=function(){return $localize(Bh||(Bh=Rv(["You cannot clone a game. This feature might be implemented later."])))},e}(),Cpe=function(){var e=function(){function e(t,n,r){tp(this,e),this.componentFactoryResolver=t,this.actRoute=n,this.authenticationService=r,this.players=[sB.empty(),sB.empty()],this.endGame=!1,rB(e.VERBOSE,"GameWrapper.constructed: "+(null!=this.gameIncluder))}return rp(e,[{key:"getMatchingComponent",value:function(t){rB(e.VERBOSE,"GameWrapper.getMatchingComponent");var n=sB.ofNullable(Vve.ALL_GAMES().find(function(e){return e.urlName===t}));return X5(n.isPresent(),"Unknown Games are unwrappable"),n.get().component}},{key:"afterGameIncluderViewInit",value:function(){rB(e.VERBOSE,"GameWrapper.afterGameIncluderViewInit"),this.createGameComponent(),this.gameComponent.rules.setInitialBoard()}},{key:"createGameComponent",value:function(){var t=this;rB(e.VERBOSE,"GameWrapper.createGameComponent"),X5(null!=this.gameIncluder,"GameIncluder should be present");var n=nB.getNonNullable(this.actRoute.snapshot.paramMap.get("compo")),r=this.getMatchingComponent(n),i=this.componentFactoryResolver.resolveComponentFactory(r),a=this.gameIncluder.viewContainerRef.createComponent(i);this.gameComponent=a.instance,this.gameComponent.chooseMove=function(e,n,r){return t.receiveValidMove(e,n,r)},this.gameComponent.canUserPlay=function(e){return t.onUserClick(e)},this.gameComponent.isPlayerTurn=function(){return t.isPlayerTurn()},this.gameComponent.cancelMoveOnWrapper=function(e){t.onCancelMove(e)},this.gameComponent.observerRole=this.observerRole,this.canPass=this.gameComponent.canPass}},{key:"receiveValidMove",value:function(t,n,r){var i=this;return tB(regeneratorRuntime.mark(function a(){var o;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(rB(e.VERBOSE||!1,{gameWrapper_receiveValidMove_AKA_chooseMove:{move:t,state:n,scores:r}}),i.isPlayerTurn()){a.next=2;break}return a.abrupt("return",K5.failure(wpe.NOT_YOUR_TURN()));case 2:if(!i.endGame){a.next=4;break}return a.abrupt("return",K5.failure($localize(Vh||(Vh=Rv(["The game has ended."])))));case 4:if(!(o=i.gameComponent.rules.isLegal(t,n)).isFailure()){a.next=9;break}a.t0=(i.gameComponent.cancelMove(o.getReason()),K5.ofFallible(o)),a.next=14;break;case 9:return i.gameComponent.cancelMoveAttempt(),a.next=12,i.onLegalUserMove(t,r);case 12:rB(e.VERBOSE||!1,"GameWrapper.receiveValidMove says: valid move legal"),a.t0=K5.SUCCESS;case 14:return a.abrupt("return",a.t0);case 15:case"end":return a.stop()}},a)}))()}},{key:"onUserClick",value:function(e){if(this.observerRole===Xee.NONE.value){var t=wpe.NO_CLONING_FEATURE();return K5.failure(t)}return this.isPlayerTurn()?K5.SUCCESS:K5.failure(wpe.NOT_YOUR_TURN())}},{key:"onCancelMove",value:function(e){}},{key:"isPlayerTurn",value:function(){if(this.observerRole===Xee.NONE.value||null==this.gameComponent)return!1;var t=this.gameComponent.rules.node.gameState.turn,n=t%2,r=this.getPlayerName();return rB(e.VERBOSE,{isPlayerTurn:{turn:t,players:this.players,username:r,observer:this.observerRole,areYouPlayer:this.players[n].equalsValue(r),isThereAPlayer:this.players[n]}}),!this.players[n].isPresent()||this.players[n].equalsValue(r)}},{key:"getBoardHighlight",value:function(){return this.endGame?["endgame-bg"]:this.isPlayerTurn()?["player"+this.gameComponent.rules.node.gameState.turn%2+"-bg"]:[]}}]),e}();return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(sb(XE),sb(bN),sb($ee))},e.\u0275cmp=ey({type:e,selectors:[["ng-component"]],viewQuery:function(e,t){var n;(1&e&&EP(_pe,5),2&e)&&(bP(n=SP())&&(t.gameIncluder=n.first))},decls:0,vars:0,template:function(e,t){},encapsulation:2}),e}(),bpe=function(){function e(t,n,r){tp(this,e),this.added=t,this.modified=n,this.removed=r}return rp(e,[{key:"addNewKeys",value:function(e,t){var n,r=Qv(e);try{for(r.s();!(n=r.n()).done;){var i=n.value;null!=t[i]&&(this.added[i]=t[i])}}catch(a){r.e(a)}finally{r.f()}}},{key:"addCommonKey",value:function(t,n,r){var i,a=Qv(t);try{for(a.s();!(i=a.n()).done;){var o=i.value;if(null==n[o])null!=r[o]&&(this.removed[o]=r[o]);else if(null==r[o])null!=n[o]&&(this.added[o]=n[o]);else{if(["function","symbol","bigint"].includes(typeof r[o]))throw new Error("Not implemented yet");if(void 0===r[o])throw new Error("YOU RE NOT A REAL VALUE "+o);if(["string","boolean","number"].includes(typeof r[o]))r[o]!==n[o]&&(this.modified[o]=n[o]);else if("number"==typeof r[o].length){if("number"!=typeof n[o].length)throw new Error("Thing should not change type");if(r[o].length===n[o].length)for(var s=!0,u=0;s&&u<r[o].length;u++)e.from(r[o][u],n[o][u]).countChanges()>0&&(s=!1,this.modified[o]=n[o]);else this.modified[o]=n[o]}else{var c=e.from(r[o],n[o]);c.countChanges()>0&&(this.modified[o]=c)}}}}catch(l){a.e(l)}finally{a.f()}}},{key:"countChanges",value:function(){var e=Object.keys(this.removed).length,t=Object.keys(this.modified).length;return Object.keys(this.added).length+t+e}},{key:"addRemovedKeys",value:function(e,t){var n,r=Qv(e);try{for(r.s();!(n=r.n()).done;){var i=n.value;this.removed[i]=t[i]}}catch(a){r.e(a)}finally{r.f()}}},{key:"isPresent",value:function(e){return null!=this.added[e]?{state:"added",present:!0}:null!=this.modified[e]?{state:"modified",present:!0}:null!=this.removed[e]?{state:"removed",present:!0}:{state:null,present:!1}}}],[{key:"from",value:function(t,n){var r=new e({},{},{});if(null==t)return r.added=Mv({},n),r;if(null==n)return r.removed=Mv({},t),r;var i=Object.keys(t),a=Object.keys(n),o=i.filter(function(e){return!1===a.includes(e)}),s=i.filter(function(e){return a.includes(e)}),u=a.filter(function(e){return!1===i.includes(e)});return r.addNewKeys(u,n),r.addCommonKey(s,n,t),r.addRemovedKeys(o,t),r}}]),e}();function Epe(e){return 1e3*e.seconds+e.nanoseconds/1e6}function Spe(e){return Mp(function(t,n){Kp(e).subscribe(new Dp(n,function(){return n.complete()},pp)),!n.closed&&t.subscribe(n)})}var Ppe=function(){var e=function(){function e(){tp(this,e)}return rp(e,[{key:"transform",value:function(e){var t=e%60,n=(e-t)%3600/60,r=(e-60*n-t)/3600,i=[];if(r>1?i.push($localize(Uh||(Uh=Rv([""," hours"])),r)):1===r&&i.push($localize(zh||(zh=Rv(["1 hour"])))),n>1?i.push($localize(Hh||(Hh=Rv([""," minutes"])),n)):1===n&&i.push($localize(Gh||(Gh=Rv(["1 minute"])))),t>1?i.push($localize(qh||(qh=Rv([""," seconds"])),t)):1===t&&i.push($localize($h||($h=Rv(["1 second"])))),0===i.length)return $localize(Wh||(Wh=Rv(["0 seconds"])));if(1===i.length)return i[0];var a=i.slice(0,-1).join(", "),o=i.slice(-1)[0];return $localize(jh||(jh=Rv([""," and ",""])),a,o)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=sy({name:"humanDuration",type:e,pure:!0}),e}();function Ope(e,t){if(1&e&&(db(0),Rb(1),vb()),2&e){var n=wb(3);Pw(1),Nb(n.viewInfo.chosenOpponent)}}function Tpe(e,t){1&e&&UE(0,44)}function Ipe(e,t){if(1&e&&(lb(0,"div",45),lb(1,"div",8),lb(2,"label",46),db(3),UE(4,47),vb(),lb(5,"output"),Rb(6),oP(7,"humanDuration"),hb(),hb(),lb(8,"div",37),fb(9,"input",48),hb(),hb(),lb(10,"div",8),lb(11,"label",49),BE(12,50),fb(13,"output"),oP(14,"humanDuration"),VE(),hb(),lb(15,"div",37),fb(16,"input",51),hb(),hb(),hb()),2&e){var n=wb(3);Pw(6),Nb(sP(7,2,n.viewInfo.maximalMoveDuration||0)),Pw(8),zE(sP(14,4,n.viewInfo.totalPartDuration||0)),HE(12)}}function xpe(e,t){1&e&&(lb(0,"div"),BE(1,52),fb(2,"br"),VE(),hb())}function Ape(e,t){1&e&&(lb(0,"button",64),UE(1,65),hb())}function Rpe(e,t){if(1&e){var n=pb();lb(0,"tr",60),mb("click",function(){var e=$y(n).$implicit;return wb(4).selectOpponent(e)}),lb(1,"td",61),Rb(2),hb(),lb(3,"td",62),ab(4,Ape,2,0,"button",63),hb(),hb()}if(2&e){var r=t.$implicit,i=wb(4);Cb("id","presenceOf_",r,""),ub("ngClass",i.viewInfo.candidateClasses[r]),Pw(1),ub("id",i.viewInfo.chosenOpponent===r&&"selected_"+r||"candidate_"+r),Pw(1),Nb(r),Pw(2),ub("ngIf",i.viewInfo.chosenOpponent!==r)}}function Npe(e,t){if(1&e&&(db(0),UE(1,53),vb(),lb(2,"div",54),lb(3,"table",55),lb(4,"thead"),lb(5,"tr"),lb(6,"th",56),UE(7,57),hb(),lb(8,"th",56),UE(9,58),hb(),hb(),hb(),lb(10,"tbody"),ab(11,Rpe,5,5,"tr",59),hb(),hb(),hb()),2&e){var n=wb(3);Pw(11),ub("ngForOf",n.viewInfo.candidates)}}function Mpe(e,t){if(1&e){var n=pb();lb(0,"button",66),mb("click",function(){return $y(n),wb(3).changeConfig()}),UE(1,67),hb()}}function Dpe(e,t){if(1&e){var n=pb();lb(0,"div"),lb(1,"h1",4),UE(2,5),hb(),lb(3,"form",6),lb(4,"fieldset",7),lb(5,"div",8),lb(6,"label",9),UE(7,10),hb(),lb(8,"div",11),lb(9,"button",12),mb("click",function(){return $y(n),wb(2).selectFirstPlayer("RANDOM")}),UE(10,13),hb(),lb(11,"button",14),mb("click",function(){return $y(n),wb(2).selectFirstPlayer("CREATOR")}),UE(12,15),hb(),lb(13,"button",16),mb("click",function(){return $y(n),wb(2).selectFirstPlayer("CHOSEN_PLAYER")}),ab(14,Ope,2,1,"ng-container",17),ab(15,Tpe,1,0,"ng-template",null,18,OP),hb(),hb(),hb(),lb(17,"div",8),lb(18,"label",9),UE(19,19),hb(),lb(20,"div",11),lb(21,"div",20),mb("click",function(){return $y(n),wb(2).selectPartType("STANDARD")}),lb(22,"div",21),lb(23,"span"),UE(24,22),hb(),hb(),lb(25,"div",23),lb(26,"div",24),lb(27,"div",25),lb(28,"p"),db(29),UE(30,26),vb(),lb(31,"strong"),Rb(32),oP(33,"humanDuration"),hb(),fb(34,"br"),db(35),BE(36,27),fb(37,"strong"),oP(38,"humanDuration"),VE(),vb(),hb(),hb(),hb(),hb(),hb(),lb(39,"div",28),mb("click",function(){return $y(n),wb(2).selectPartType("BLITZ")}),lb(40,"div",21),lb(41,"span"),UE(42,29),hb(),hb(),lb(43,"div",23),lb(44,"div",24),lb(45,"div",25),lb(46,"p"),db(47),UE(48,30),vb(),lb(49,"strong"),Rb(50),oP(51,"humanDuration"),hb(),fb(52,"br"),db(53),BE(54,31),fb(55,"strong"),oP(56,"humanDuration"),VE(),vb(),hb(),hb(),hb(),hb(),hb(),lb(57,"button",32),mb("click",function(){return $y(n),wb(2).selectPartType("CUSTOM")}),UE(58,33),hb(),hb(),hb(),ab(59,Ipe,17,6,"div",34),lb(60,"div",8),lb(61,"label",35),UE(62,36),hb(),lb(63,"div",37),ab(64,xpe,3,0,"div",17),ab(65,Npe,12,1,"ng-template",null,38,OP),hb(),hb(),hb(),lb(67,"div",8),lb(68,"div",11),lb(69,"button",39),mb("click",function(){return $y(n),wb(2).proposeConfig()}),UE(70,40),hb(),ab(71,Mpe,2,0,"button",41),lb(72,"button",42),mb("click",function(){return $y(n),wb(2).cancelGameCreation()}),UE(73,43),hb(),hb(),hb(),hb(),hb()}if(2&e){var r=ob(16),i=ob(66),a=wb(2);Pw(3),ub("formGroup",a.configFormGroup),Pw(1),ub("disabled",!a.viewInfo.canEditConfig),Pw(5),ub("ngClass",a.viewInfo.firstPlayerClasses.RANDOM),Pw(2),ub("ngClass",a.viewInfo.firstPlayerClasses.CREATOR),Pw(2),ub("ngClass",a.viewInfo.firstPlayerClasses.CHOSEN_PLAYER),Pw(1),ub("ngIf",a.viewInfo.chosenOpponent)("ngIfElse",r),Pw(7),ub("ngClass",a.viewInfo.partTypeClasses.STANDARD),Pw(11),Nb(sP(33,19,a.partType.NORMAL_MOVE_DURATION)),Pw(6),zE(sP(38,21,a.partType.NORMAL_PART_DURATION)),HE(36),Pw(1),ub("ngClass",a.viewInfo.partTypeClasses.BLITZ),Pw(11),Nb(sP(51,23,a.partType.BLITZ_MOVE_DURATION)),Pw(6),zE(sP(56,25,a.partType.BLITZ_PART_DURATION)),HE(54),Pw(1),ub("ngClass",a.viewInfo.partTypeClasses.CUSTOM),Pw(2),ub("ngIf",a.viewInfo.showCustomTime),Pw(5),ub("ngIf",0===a.viewInfo.candidates.length)("ngIfElse",i),Pw(5),ub("disabled",!a.viewInfo.canProposeConfig),Pw(2),ub("ngIf",a.viewInfo.canReviewConfig)}}function Lpe(e,t){if(1&e&&(lb(0,"div",74),lb(1,"p"),BE(2,75),fb(3,"br"),VE(),hb(),hb()),2&e){var n=wb(3);Pw(3),zE(n.viewInfo.creator),HE(2)}}function Fpe(e,t){if(1&e&&(lb(0,"span"),UE(1,81),hb()),2&e){var n=wb(4);Pw(1),zE(n.viewInfo.creator),HE(1)}}function Bpe(e,t){1&e&&(lb(0,"span"),UE(1,82),hb())}function Vpe(e,t){1&e&&(lb(0,"span"),UE(1,83),hb())}function Upe(e,t){if(1&e){var n=pb();lb(0,"div",74),lb(1,"p"),UE(2,76),hb(),lb(3,"ul"),lb(4,"li"),ab(5,Fpe,2,1,"span",2),ab(6,Bpe,2,0,"span",2),ab(7,Vpe,2,0,"span",2),hb(),lb(8,"li"),BE(9,77),fb(10,"strong"),oP(11,"humanDuration"),VE(),hb(),lb(12,"li"),BE(13,78),fb(14,"strong"),oP(15,"humanDuration"),VE(),hb(),hb(),lb(16,"button",79),mb("click",function(){return $y(n),wb(3).acceptConfig()}),UE(17,80),hb(),hb()}if(2&e){var r=wb(3);Pw(2),zE(r.viewInfo.creator)(r.viewInfo.partTypeName),HE(2),Pw(3),ub("ngIf","CREATOR"===r.viewInfo.firstPlayer),Pw(1),ub("ngIf","CHOSEN_PLAYER"===r.viewInfo.firstPlayer),Pw(1),ub("ngIf","RANDOM"===r.viewInfo.firstPlayer),Pw(4),zE(sP(11,7,r.viewInfo.maximalMoveDuration||0)),HE(9),Pw(4),zE(sP(15,9,r.viewInfo.totalPartDuration||0)),HE(13)}}function zpe(e,t){if(1&e&&(lb(0,"div"),lb(1,"div",68),lb(2,"div",69),lb(3,"p"),UE(4,70),hb(),hb(),lb(5,"div",71),ab(6,Lpe,4,1,"div",72),ab(7,Upe,18,11,"ng-template",null,73,OP),hb(),hb(),hb()),2&e){var n=ob(8),r=wb(2);Pw(6),ub("ngIf",r.viewInfo.creatorIsModifyingConfig)("ngIfElse",n)}}function Hpe(e,t){if(1&e&&(db(0),UE(1,86),vb()),2&e){var n=wb(3);Pw(1),zE(n.viewInfo.creator),HE(1)}}function Gpe(e,t){if(1&e&&UE(0,87),2&e){var n=wb(3);zE(n.viewInfo.creator)(n.viewInfo.chosenOpponent),HE(0)}}function qpe(e,t){if(1&e&&(lb(0,"div",68),lb(1,"div",69),lb(2,"p"),UE(3,84),hb(),hb(),lb(4,"div",71),lb(5,"p"),ab(6,Hpe,2,1,"ng-container",17),ab(7,Gpe,1,2,"ng-template",null,85,OP),hb(),hb(),hb()),2&e){var n=ob(8),r=wb(2);Pw(6),ub("ngIf",r.viewInfo.creatorIsModifyingConfig)("ngIfElse",n)}}function $pe(e,t){if(1&e&&(lb(0,"div",1),ab(1,Dpe,74,27,"div",2),ab(2,zpe,9,2,"div",2),ab(3,qpe,9,2,"div",3),hb()),2&e){var n=wb();Pw(1),ub("ngIf",n.viewInfo.userIsCreator),Pw(1),ub("ngIf",n.viewInfo.userIsChosenOpponent),Pw(1),ub("ngIf",n.viewInfo.userIsObserver)}}var Wpe=function(){var e=function(){function e(t,n,r,i,a,o,s){tp(this,e),this.router=t,this.gameService=n,this.joinerService=r,this.chatService=i,this.userService=a,this.formBuilder=o,this.messageDisplayer=s,this.partType=jee,this.gameStartNotification=new hP,this.gameStarted=!1,this.gameExists=!1,this.viewInfo={userIsCreator:!1,userIsChosenOpponent:!1,userIsObserver:!1,partType:"STANDARD",partTypeClasses:{STANDARD:["is-selected","is-primary"],BLITZ:[],CUSTOM:[]},firstPlayer:"RANDOM",firstPlayerClasses:{CREATOR:[],RANDOM:["is-selected","is-primary"],CHOSEN_PLAYER:[]},candidateClasses:{},candidates:[]},this.currentJoiner=null,this.candidateSubscription=new Ore,this.creatorSubscription=null,this.ngUnsubscribe=new Ap,this.allDocDeleted=!1,rB(e.VERBOSE,"PartCreationComponent constructed for "+this.userName)}return rp(e,[{key:"ngOnInit",value:function(){var t=this;return tB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return rB(e.VERBOSE,"PartCreationComponent.ngOnInit for "+t.userName),t.checkInputs(),t.createForms(),n.next=5,t.joinerService.joinGame(t.partId,t.userName);case 5:if(n.t0=!n.sent.isFailure(),!n.t0){n.next=8;break}t.gameExists=!0,t.subscribeToJoinerDoc(),t.subscribeToFormElements(),rB(e.VERBOSE,"PartCreationComponent.ngOnInit asynchronouseries finisheds");case 8:case"end":return n.stop()}},n)}))()}},{key:"checkInputs",value:function(){X5(null!=this.userName&&""!==this.userName,"PartCreationComponent should not be created with an empty userName"),X5(null!=this.partId&&""!==this.partId,"PartCreationComponent should not be created with an empty partId")}},{key:"createForms",value:function(){this.configFormGroup=this.formBuilder.group({firstPlayer:[Wee.RANDOM.value,zI.required],maximalMoveDuration:[jee.NORMAL_MOVE_DURATION,zI.required],partType:["STANDARD",zI.required],totalPartDuration:[jee.NORMAL_PART_DURATION,zI.required],chosenOpponent:["",zI.required]})}},{key:"subscribeToJoinerDoc",value:function(){var e,t=this;this.joinerService.subscribeToChanges(this.partId,(e=tB(regeneratorRuntime.mark(function e(n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.onCurrentJoinerUpdate(n);case 2:case"end":return e.stop()}},e)})),function(t){return e.apply(this,arguments)}))}},{key:"getForm",value:function(e){return nB.getNonNullable(this.configFormGroup.get(e))}},{key:"subscribeToFormElements",value:function(){var e=this;this.getForm("chosenOpponent").valueChanges.pipe(Spe(this.ngUnsubscribe)).subscribe(function(t){void 0!==e.viewInfo.chosenOpponent&&(e.viewInfo.candidateClasses[e.viewInfo.chosenOpponent]=[]),e.viewInfo.candidateClasses[t]=["is-selected"],e.viewInfo.chosenOpponent=t,e.viewInfo.canProposeConfig=nB.getNonNullable(e.currentJoiner).partStatus!==Zee.CONFIG_PROPOSED.value&&""!==t}),this.getForm("partType").valueChanges.pipe(Spe(this.ngUnsubscribe)).subscribe(function(t){e.viewInfo.partTypeClasses[e.viewInfo.partType]=[],e.viewInfo.partTypeClasses[t]=["is-primary","is-selected"],e.viewInfo.partType=t,e.viewInfo.showCustomTime="CUSTOM"===t}),this.getForm("maximalMoveDuration").valueChanges.pipe(Spe(this.ngUnsubscribe)).subscribe(function(t){e.viewInfo.maximalMoveDuration=t}),this.getForm("totalPartDuration").valueChanges.pipe(Spe(this.ngUnsubscribe)).subscribe(function(t){e.viewInfo.totalPartDuration=t}),this.getForm("firstPlayer").valueChanges.pipe(Spe(this.ngUnsubscribe)).subscribe(function(t){e.viewInfo.firstPlayerClasses[e.viewInfo.firstPlayer]=[],e.viewInfo.firstPlayerClasses[t]=["is-primary","is-selected"],e.viewInfo.firstPlayer=t})}},{key:"updateViewInfo",value:function(){var e=nB.getNonNullable(this.currentJoiner);switch(this.viewInfo.canReviewConfig=e.partStatus===Zee.CONFIG_PROPOSED.value,this.viewInfo.canEditConfig=e.partStatus!==Zee.CONFIG_PROPOSED.value,this.viewInfo.userIsCreator=this.userName===e.creator.name,this.viewInfo.userIsChosenOpponent=this.userName===e.chosenPlayer,this.viewInfo.userIsObserver=!1===this.viewInfo.userIsChosenOpponent&&!1===this.viewInfo.userIsCreator,this.viewInfo.creatorIsModifyingConfig=e.partStatus!==Zee.CONFIG_PROPOSED.value,this.viewInfo.showCustomTime="CUSTOM"===this.getForm("partType").value,this.viewInfo.creator=e.creator.name,this.viewInfo.candidates=e.candidates,this.userName===e.creator.name?this.setDataForCreator(e):(this.viewInfo.maximalMoveDuration=e.maximalMoveDuration,this.viewInfo.totalPartDuration=e.totalPartDuration,this.viewInfo.partType=e.partType,this.viewInfo.chosenOpponent=e.chosenPlayer||void 0,this.viewInfo.firstPlayer=e.firstPlayer),e.partType){case"CUSTOM":this.viewInfo.partTypeName=$localize(Zh||(Zh=Rv(["custom"])));break;case"BLITZ":this.viewInfo.partTypeName=$localize(Yh||(Yh=Rv(["blitz"])));break;case"STANDARD":this.viewInfo.partTypeName=$localize(Kh||(Kh=Rv(["standard"])))}}},{key:"setDataForCreator",value:function(e){this.viewInfo.maximalMoveDuration=this.viewInfo.maximalMoveDuration||e.maximalMoveDuration,this.viewInfo.totalPartDuration=this.viewInfo.totalPartDuration||e.totalPartDuration;var t=this.viewInfo.chosenOpponent;t?-1===e.candidates.indexOf(t)&&(t=""):t=e.chosenPlayer||"",this.getForm("chosenOpponent").setValue(t)}},{key:"selectFirstPlayer",value:function(e){this.getForm("firstPlayer").setValue(e)}},{key:"selectPartType",value:function(e){"STANDARD"===e?(this.getForm("maximalMoveDuration").setValue(jee.NORMAL_MOVE_DURATION),this.getForm("totalPartDuration").setValue(jee.NORMAL_PART_DURATION)):"BLITZ"===e&&(this.getForm("maximalMoveDuration").setValue(jee.BLITZ_MOVE_DURATION),this.getForm("totalPartDuration").setValue(jee.BLITZ_PART_DURATION)),this.getForm("partType").setValue(e)}},{key:"selectOpponent",value:function(t){var n=this;return tB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(rB(e.VERBOSE,"PartCreationComponent.setChosenPlayer("+t+")"),n.joinerService.setChosenPlayer(t)));case 1:case"end":return r.stop()}},r)}))()}},{key:"changeConfig",value:function(){var e=this;return tB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.joinerService.reviewConfig());case 1:case"end":return t.stop()}},t)}))()}},{key:"proposeConfig",value:function(){var e=this;return tB(regeneratorRuntime.mark(function t(){var n,r,i,a,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.getForm("chosenOpponent").value,r=e.getForm("partType").value,i=e.getForm("maximalMoveDuration").value,a=e.getForm("firstPlayer").value,o=e.getForm("totalPartDuration").value,t.abrupt("return",e.joinerService.proposeConfig(n,jee.of(r),i,Wee.of(a),o));case 2:case"end":return t.stop()}},t)}))()}},{key:"cancelGameCreation",value:function(){var t=this;return tB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t.allDocDeleted=!0,rB(e.VERBOSE,"PartCreationComponent.cancelGameCreation"),n.next=4,t.chatService.deleteChat(t.partId);case 4:return rB(e.VERBOSE,"PartCreationComponent.cancelGameCreation: chat deleted"),n.next=7,t.joinerService.deleteJoiner();case 7:return rB(e.VERBOSE,"PartCreationComponent.cancelGameCreation: chat and joiner deleted"),n.next=10,t.gameService.deletePart(t.partId);case 10:rB(e.VERBOSE,"PartCreationComponent.cancelGameCreation: chat, joiner, and part deleted");case 11:case"end":return n.stop()}},n)}))()}},{key:"onCurrentJoinerUpdate",value:function(t){if(rB(e.VERBOSE,{PartCreationComponent_onCurrentJoinerUpdate:{before:JSON.stringify(this.currentJoiner),then:JSON.stringify(t)}}),t.isAbsent())return rB(e.VERBOSE,"PartCreationComponent.onCurrentJoinerUpdate: LAST UPDATE : the game is cancelled"),this.onGameCancelled();this.currentJoiner=t.get(),this.observeNeededPlayers(),this.updateViewInfo(),this.isGameStarted()&&(rB(e.VERBOSE,"PartCreationComponent.onCurrentJoinerUpdate: the game has started"),this.onGameStarted())}},{key:"onGameCancelled",value:function(){var t=this;return tB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return rB(e.VERBOSE,"PartCreationComponent.onGameCancelled"),t.messageDisplayer.infoMessage($localize(Jh||(Jh=Rv(["The game has been canceled!"])))),n.next=4,t.router.navigate(["/lobby"]);case 4:case"end":return n.stop()}},n)}))()}},{key:"isGameStarted",value:function(){var e=nB.getNonNullable(this.currentJoiner);return null!=e&&e.partStatus===Zee.PART_STARTED.value}},{key:"onGameStarted",value:function(){var t=nB.getNonNullable(this.currentJoiner);rB(e.VERBOSE,{partCreationComponent_onGameStarted:{joiner:t}}),this.gameStartNotification.emit(t),this.gameStarted=!0,rB(e.VERBOSE,"PartCreationComponent.onGameStarted finished")}},{key:"observeNeededPlayers",value:function(){var t=nB.getNonNullable(this.currentJoiner);rB(e.VERBOSE,{PartCreationComponent_updateJoiner:{joiner:t}}),this.userName===t.creator.name?this.observeCandidates():this.observeCreator()}},{key:"observeCreator",value:function(){var e=this,t=nB.getNonNullable(this.currentJoiner);if(null==this.creatorSubscription){var n,r=(n=tB(regeneratorRuntime.mark(function t(n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.destroyDocIfCreatorOffline(n);case 2:case"end":return t.stop()}},t)})),function(e){return n.apply(this,arguments)}),i=new o6(r,r,r);this.creatorSubscription=this.userService.observeUserByUsername(t.creator.name,i)}}},{key:"destroyDocIfCreatorOffline",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function n(){var r,i,a,o;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:r=nB.getNonNullable(t.currentJoiner),i=Qv(e),n.prev=2,i.s();case 4:if((a=i.n()).done){n.next=13;break}if(X5((o=a.value).data.username===r.creator.name,"found non creator while observing creator!"),n.t0="offline"===o.data.state&&!1===t.allDocDeleted&&r.partStatus!==Zee.PART_STARTED.value,!n.t0){n.next=11;break}return n.next=11,t.cancelGameCreation();case 11:n.next=4;break;case 13:n.next=18;break;case 15:n.prev=15,n.t1=n.catch(2),i.e(n.t1);case 18:return n.prev=18,i.f(),n.finish(18);case 21:case"end":return n.stop()}},n,null,[[2,15,18,21]])}))()}},{key:"observeCandidates",value:function(){var t=this,n=nB.getNonNullable(this.currentJoiner);rB(e.VERBOSE,{PartCreation_observeCandidates:n});var r,i,a=new o6((r=tB(regeneratorRuntime.mark(function e(n){var r,i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=Qv(n),e.prev=1,r.s();case 3:if((i=r.n()).done){e.next=12;break}if("offline"!==(a=i.value).data.state){e.next=10;break}return o=nB.getNonNullable(a.data.username),e.next=9,t.removeUserFromLobby(o);case 9:Q5.logError("PartCreationComponent","user is already offline",{id:a.id,username:o});case 10:e.next=3;break;case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(1),r.e(e.t0);case 17:return e.prev=17,r.f(),e.finish(17);case 20:case"end":return e.stop()}},e,null,[[1,14,17,20]])})),function(e){return r.apply(this,arguments)}),function(){var e=tB(regeneratorRuntime.mark(function e(n){var r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=Qv(n),e.prev=1,r.s();case 3:if((i=r.n()).done){e.next=11;break}if(a=i.value,e.t0="offline"===a.data.state,!e.t0){e.next=9;break}return e.next=9,t.removeUserFromLobby(nB.getNonNullable(a.data.username));case 9:e.next=3;break;case 11:e.next=16;break;case 13:e.prev=13,e.t1=e.catch(1),r.e(e.t1);case 16:return e.prev=16,r.f(),e.finish(16);case 19:case"end":return e.stop()}},e,null,[[1,13,16,19]])}));return function(t){return e.apply(this,arguments)}}(),function(){var e=tB(regeneratorRuntime.mark(function e(n){var r,i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=Qv(n),e.prev=1,r.s();case 3:if((i=r.n()).done){e.next=11;break}return a=i.value,o=nB.getNonNullable(a.data.username),e.next=8,t.removeUserFromLobby(o);case 8:Q5.logError("PartCreationComponent","user was deleted",{id:a.id,username:o});case 9:e.next=3;break;case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),r.e(e.t0);case 16:return e.prev=16,r.f(),e.finish(16);case 19:case"end":return e.stop()}},e,null,[[1,13,16,19]])}));return function(t){return e.apply(this,arguments)}}()),o=Qv(n.candidates);try{for(o.s();!(i=o.n()).done;){var s=i.value;if(this.candidateSubscription.get(s).isAbsent()){var u=this.userService.observeUserByUsername(s,a);this.candidateSubscription.set(s,u)}}}catch(f){o.e(f)}finally{o.f()}var c,l=Qv(this.candidateSubscription.listKeys());try{for(l.s();!(c=l.n()).done;){var h=c.value;h!==n.chosenPlayer&&!1===n.candidates.includes(h)&&this.unsubscribeFrom(h)}}catch(f){l.e(f)}finally{l.f()}}},{key:"removeUserFromLobby",value:function(e){var t=nB.getNonNullable(this.currentJoiner),n=t.candidates.indexOf(e);X5(-1!==n,"PartCreationComponent: attempting to remove a user not in the lobby");var r=t.candidates.slice(0,n),i=t.candidates.slice(n+1),a=r.concat(i);return e===t.chosenPlayer?(this.messageDisplayer.infoMessage($localize(Qh||(Qh=Rv([""," left the game, please pick another opponent."])),e)),this.joinerService.reviewConfigRemoveChosenPlayerAndUpdateCandidates(a)):this.joinerService.updateCandidates(a)}},{key:"unsubscribeFrom",value:function(e){this.candidateSubscription.delete(e)()}},{key:"acceptConfig",value:function(){return rB(e.VERBOSE,"PartCreationComponent.acceptConfig"),this.gameService.acceptConfig(this.partId,nB.getNonNullable(this.currentJoiner))}},{key:"ngOnDestroy",value:function(){var t=this;return tB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:rB(e.VERBOSE,"PartCreationComponent.ngOnDestroy"),t.ngUnsubscribe.next(),t.ngUnsubscribe.complete(),t.gameExists&&t.joinerService.unsubscribe(),r=Qv(t.candidateSubscription.listKeys());try{for(r.s();!(i=r.n()).done;)a=i.value,t.unsubscribeFrom(a)}catch(o){r.e(o)}finally{r.f()}if(!1!==t.gameStarted){n.next=17;break}if(null!==t.currentJoiner){n.next=6;break}return n.abrupt("return",void rB(e.VERBOSE,"PartCreationComponent.ngOnDestroy: there is no part here"));case 6:if(t.userName!==t.currentJoiner.creator.name||!1!==t.allDocDeleted){n.next=12;break}return rB(e.VERBOSE,"PartCreationComponent.ngOnDestroy: you(creator) about to cancel creation."),n.next=10,t.cancelGameCreation();case 10:n.next=17;break;case 12:if(n.t0=!1===t.allDocDeleted,!n.t0){n.next=17;break}return rB(e.VERBOSE,"PartCreationComponent.ngOnDestroy: you(joiner) about to cancel game joining"),n.next=17,t.joinerService.cancelJoining(t.userName);case 17:case"end":return n.stop()}},n)}))()}}]),e}();return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(sb(qM),sb(ste),sb(ote),sb(a6),sb(c6),sb(vA),sb(ore))},e.\u0275cmp=ey({type:e,selectors:[["app-part-creation"]],inputs:{partId:"partId",userName:"userName"},outputs:{gameStartNotification:"gameStartNotification"},decls:1,vars:1,consts:function(){return[["class","box",4,"ngIf"],[1,"box"],[4,"ngIf"],["class","message is-primary",4,"ngIf"],[1,"title"],$localize(Xh||(Xh=Rv(["Game creation"]))),[3,"formGroup"],[3,"disabled"],[1,"field"],["for","firstPlayer",1,"label"],$localize(ef||(ef=Rv(["First player"]))),[1,"buttons","has-addons"],["id","firstPlayerRandom",1,"button",3,"ngClass","click"],$localize(tf||(tf=Rv(["Random"]))),["id","firstPlayerCreator",1,"button",3,"ngClass","click"],$localize(nf||(nf=Rv(["You"]))),["id","firstPlayerOpponent",1,"button",3,"ngClass","click"],[4,"ngIf","ngIfElse"],["opponentWithoutName",""],$localize(rf||(rf=Rv(["Game type"]))),["id","partTypeStandard",1,"button","dropdown","is-hoverable",3,"ngClass","click"],[1,"dropdown-trigger"],$localize(af||(af=Rv(["Standard"]))),["role","menu",1,"dropdown-menu"],[1,"dropdown-content"],[1,"dropdown-item"],$localize(of||(of=Rv(["Maximal turn duration: "]))),$localize(sf||(sf=Rv(["Maximal game duration: ",":START_TAG_STRONG:",":INTERPOLATION: per player",":CLOSE_TAG_STRONG:"])),"\ufffd#37\ufffd","\ufffd0\ufffd","\ufffd/#37\ufffd"),["id","partTypeBlitz",1,"button","dropdown","is-hoverable",3,"ngClass","click"],$localize(uf||(uf=Rv(["Blitz"]))),$localize(cf||(cf=Rv(["Maximal turn duration: "]))),$localize(lf||(lf=Rv(["Maximal game duration: ",":START_TAG_STRONG:",":INTERPOLATION: per player",":CLOSE_TAG_STRONG:"])),"\ufffd#55\ufffd","\ufffd0\ufffd","\ufffd/#55\ufffd"),["id","partTypeCustom",1,"button",3,"ngClass","click"],$localize(hf||(hf=Rv(["Custom"]))),["id","customTime",4,"ngIf"],[1,"label"],$localize(ff||(ff=Rv(["Opponents"]))),[1,"control"],["chooseCandidate",""],["id","proposeConfig",1,"button","is-primary",3,"disabled","click"],$localize(df||(df=Rv(["Propose configuration"]))),["class","button","id","reviewConfig",3,"click",4,"ngIf"],["id","cancel",1,"button",3,"click"],$localize(vf||(vf=Rv(["Cancel game"]))),$localize(pf||(pf=Rv(["The opponent"]))),["id","customTime"],["for","maximalMoveDuration",1,"label"],$localize(gf||(gf=Rv(["Maximal turn duration: "]))),["step","10","min","10","max","300","name","maximalMoveDuration","formControlName","maximalMoveDuration","type","range",1,"slider","is-circle","is-primary"],["for","totalPartDuration",1,"label"],$localize(yf||(yf=Rv(["Maximal game duration: ",":START_TAG_OUTPUT:",":INTERPOLATION: per player",":CLOSE_TAG_OUTPUT:"])),"\ufffd#13\ufffd","\ufffd0\ufffd","\ufffd/#13\ufffd"),["step","10","min","10","max","3600","name","totalPartDuration","formControlName","totalPartDuration","type","range",1,"slider","is-circle","is-primary"],$localize(mf||(mf=Rv(["Potential opponents that join the game will appear here.",":LINE_BREAK:Wait for an opponent to join, so that you can pick one."])),"\ufffd#2\ufffd\ufffd/#2\ufffd"),$localize(kf||(kf=Rv(["Click on the opponent against which you would like to play."]))),["id","chooseCandidate",1,"table-container"],[1,"table","is-fullwidth","is-hoverable","is-striped"],["scope","col",1,"th"],$localize(_f||(_f=Rv(["Name"]))),$localize(wf||(wf=Rv(["Actions"]))),[3,"ngClass","id","click",4,"ngFor","ngForOf"],[3,"ngClass","id","click"],[1,"td",3,"id"],[1,"td"],["class","button is-primary",4,"ngIf"],[1,"button","is-primary"],$localize(Cf||(Cf=Rv(["Pick"]))),["id","reviewConfig",1,"button",3,"click"],$localize(bf||(bf=Rv(["Change configuration"]))),[1,"message","is-primary"],[1,"message-header"],$localize(Ef||(Ef=Rv(["Configuration proposal"]))),[1,"message-body"],["class","content",4,"ngIf","ngIfElse"],["configProposal",""],[1,"content"],$localize(Sf||(Sf=Rv(["You have been selected as the opponent.",":LINE_BREAK: ",":INTERPOLATION: is modifying the configuration."])),"\ufffd#3\ufffd\ufffd/#3\ufffd","\ufffd0\ufffd"),$localize(Pf||(Pf=Rv(["",":INTERPOLATION: proposes to play a ",":INTERPOLATION_1: game"])),"\ufffd0\ufffd","\ufffd1\ufffd"),$localize(Of||(Of=Rv(["a turn lasts at most ",":START_TAG_STRONG:",":INTERPOLATION: ",":CLOSE_TAG_STRONG:"])),"\ufffd#10\ufffd","\ufffd0\ufffd","\ufffd/#10\ufffd"),$localize(Tf||(Tf=Rv(["the game lasts at most ",":START_TAG_STRONG:",":INTERPOLATION: per player",":CLOSE_TAG_STRONG:"])),"\ufffd#14\ufffd","\ufffd0\ufffd","\ufffd/#14\ufffd"),["id","acceptConfig",1,"button","is-primary",3,"click"],$localize(If||(If=Rv(["Accept and start"]))),$localize(xf||(xf=Rv(["",":INTERPOLATION: plays first"])),"\ufffd0\ufffd"),$localize(Af||(Af=Rv(["you play first"]))),$localize(Rf||(Rf=Rv(["the first player is selected randomly"]))),$localize(Nf||(Nf=Rv(["One moment..."]))),["proposalSent",""],$localize(Mf||(Mf=Rv(["",":INTERPOLATION: is configuring the game."])),"\ufffd0\ufffd"),$localize(Df||(Df=Rv(["",":INTERPOLATION: has proposed a configuration to ",":INTERPOLATION_1:."])),"\ufffd0\ufffd","\ufffd1\ufffd")]},template:function(e,t){1&e&&ab(0,$pe,4,3,"div",0),2&e&&ub("ngIf",t.viewInfo)},directives:[NT,qx,fx,Kx,IT,DI,jx,hx,Qx,AT],pipes:[Ppe],encapsulation:2}),e}();function jpe(e,t){if(1&e){var n=pb();lb(0,"button",3),mb("click",function(){return $y(n),wb().addTime()}),UE(1,4),hb()}if(2&e){var r=wb();Pw(1),zE(r.timeToAdd),HE(1)}}var Zpe=function(){var e=function(){function e(){tp(this,e),this.isPaused=!0,this.isSet=!1,this.started=!1,this.outOfTimeAction=new hP,this.addTimeToOpponent=new hP,this.cssClasses=e.SAFE_TIME}return rp(e,[{key:"ngOnInit",value:function(){rB(e.VERBOSE,"CountDownComponent.ngOnInit ("+this.debugName+")")}},{key:"setDuration",value:function(t){if(rB(e.VERBOSE,this.debugName+".set("+t+"ms)"),this.started)throw new Error("Should not set a chrono that has already been started ("+this.debugName+")!");this.isSet=!0,this.changeDuration(t)}},{key:"changeDuration",value:function(e){var t=!1;!1===this.isPaused&&(this.pause(),t=!0),this.remainingMs=e,this.displayDuration(),t&&this.resume()}},{key:"displayDuration",value:function(){this.displayedSec=this.remainingMs%6e4,this.displayedMinute=(this.remainingMs-this.displayedSec)/6e4,this.displayedSec=Math.floor(this.displayedSec/1e3)}},{key:"start",value:function(){if(rB(e.VERBOSE,this.debugName+".start("+this.remainingMs+"ms);"),!1===this.isSet)throw new Error("Should not start a chrono that has not been set!");if(this.started)throw new Error("Should not start chrono that has already been started ("+this.debugName+")");this.started=!0,this.resume()}},{key:"resume",value:function(){var t=this;if(rB(e.VERBOSE,this.debugName+".resume("+this.remainingMs+"ms)"),!1===this.isPaused||!1===this.started)throw new Error("Should only resume chrono that are started and paused!");this.startTime=Date.now();var n=this.remainingMs;this.isPaused=!1,this.timeoutHandleGlobal=window.setTimeout(function(){t.onEndReached()},n),this.countSeconds()}},{key:"onEndReached",value:function(){rB(e.VERBOSE,this.debugName+".onEndReached"),this.isPaused=!0,this.started=!1,this.clearTimeouts(),this.changeDuration(0),this.outOfTimeAction.emit()}},{key:"countSeconds",value:function(){var e=this;this.timeoutHandleSec=window.setTimeout(function(){e.updateShownTime()},1e3)}},{key:"isIdle",value:function(){return!1===this.started||this.isPaused}},{key:"pause",value:function(){if(rB(e.VERBOSE,this.debugName+".pause("+this.remainingMs+"ms)"),!this.started)throw new Error("Should not pause not started chrono ("+this.debugName+")");if(this.isPaused)throw new Error("Should not pause already paused chrono ("+this.debugName+")");this.clearTimeouts(),this.isPaused=!0,this.updateShownTime()}},{key:"stop",value:function(){if(rB(e.VERBOSE,this.debugName+".stop("+this.remainingMs+"ms)"),!1===this.started)throw new Error("Should only stop chrono that are started!");this.pause(),this.started=!1,this.isSet=!1}},{key:"isStarted",value:function(){return this.started}},{key:"getTimeClass",value:function(){return!1===this.active?e.PASSIVE_STYLE:this.remainingMs<this.dangerTimeLimit?this.remainingMs%2e3<1e3?e.DANGER_TIME_ODD:e.DANGER_TIME_EVEN:e.SAFE_TIME}},{key:"updateShownTime",value:function(){var e=Date.now();this.remainingMs-=e-this.startTime,this.displayDuration(),this.cssClasses=this.getTimeClass(),this.startTime=e,!1===this.isPaused&&this.countSeconds()}},{key:"clearTimeouts",value:function(){rB(e.VERBOSE,this.debugName+".clearTimeouts"),null!=this.timeoutHandleSec&&(clearTimeout(this.timeoutHandleSec),this.timeoutHandleSec=null),null!=this.timeoutHandleGlobal&&(clearTimeout(this.timeoutHandleGlobal),this.timeoutHandleGlobal=null)}},{key:"addTime",value:function(){this.addTimeToOpponent.emit()}},{key:"ngOnDestroy",value:function(){this.clearTimeouts()}}]),e}();return e.VERBOSE=!1,e.DANGER_TIME_EVEN="has-background-danger has-text-white",e.DANGER_TIME_ODD="has-background-warning has-text-white",e.PASSIVE_STYLE="has-text-passive is-italic",e.SAFE_TIME="",e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=ey({type:e,selectors:[["app-count-down"]],inputs:{debugName:"debugName",timeToAdd:"timeToAdd",dangerTimeLimit:"dangerTimeLimit",active:"active",canAddTime:"canAddTime"},outputs:{outOfTimeAction:"outOfTimeAction",addTimeToOpponent:"addTimeToOpponent"},decls:5,vars:7,consts:function(){return[[3,"ngClass"],["id","remainingTime"],["id","addTimeButton","class","button is-small is-fullwidth",3,"click",4,"ngIf"],["id","addTimeButton",1,"button","is-small","is-fullwidth",3,"click"],$localize(Lf||(Lf=Rv(["Add ",":INTERPOLATION:"])),"\ufffd0\ufffd")]},template:function(e,t){1&e&&(lb(0,"div",0),lb(1,"p",1),Rb(2),oP(3,"number"),hb(),ab(4,jpe,2,1,"button",2),hb()),2&e&&(ub("ngClass",t.getTimeClass()),Pw(2),Db("",t.displayedMinute,":",function(e,t,n,r){var i=Gy(),a=My(i,23);return cP(i,uP(i,23)?aP(i,em(),4,a.transform,n,r,a):a.transform(n,r))}(0,0,t.displayedSec,"2.0-0"),""),Pw(2),ub("ngIf",t.canAddTime))},directives:[IT,NT],pipes:[BT],encapsulation:2}),e}(),Ype=["partCreation"],Kpe=["chatComponent"],Jpe=["chronoZeroGlobal"],Qpe=["chronoOneGlobal"],Xpe=["chronoZeroTurn"],ege=["chronoOneTurn"];function tge(e,t){if(1&e){var n=pb();lb(0,"app-part-creation",5,6),mb("gameStartNotification",function(e){return $y(n),wb().startGame(e)}),hb()}if(2&e){var r=wb();ub("partId",r.currentPartId)("userName",r.getPlayerName())}}function nge(e,t){1&e&&(db(0),UE(1,40),vb())}function rge(e,t){1&e&&UE(0,41),2&e&&(zE(wb(4).currentPlayer),HE(0))}function ige(e,t){if(1&e&&(lb(0,"p",37),ab(1,nge,2,0,"ng-container",38),ab(2,rge,1,1,"ng-template",null,39,OP),hb()),2&e){var n=ob(3),r=wb(3);Pw(1),ub("ngIf",r.currentPlayer===r.getPlayerName())("ngIfElse",n)}}function age(e,t){if(1&e&&(lb(0,"div",33),lb(1,"p",34),UE(2,35),hb(),ab(3,ige,4,2,"p",36),hb()),2&e){var n=wb(2);Pw(2),zE(n.currentPart.getTurn()+1),HE(2),Pw(1),ub("ngIf",!1===n.endGame)}}function oge(e,t){if(1&e&&(lb(0,"p",42),Rb(1),hb()),2&e){var n=wb(2);ub("ngClass",n.getPlayerNameClass(0)),Pw(1),Nb(n.players[0].get())}}function sge(e,t){if(1&e&&(lb(0,"p",43),UE(1,44),hb()),2&e){var n=wb(2);Pw(1),zE(n.gameComponent.scores.get()[0]),HE(1)}}function uge(e,t){if(1&e&&(lb(0,"p",45),Rb(1),hb()),2&e){var n=wb(2);ub("ngClass",n.getPlayerNameClass(1)),Pw(1),Nb(n.players[1].get())}}function cge(e,t){if(1&e&&(lb(0,"p",46),UE(1,47),hb()),2&e){var n=wb(2);Pw(1),zE(n.gameComponent.scores.get()[1]),HE(1)}}function lge(e,t){if(1&e){var n=pb();lb(0,"button",56),mb("click",function(){return $y(n),wb(3).resign()}),UE(1,57),hb()}}function hge(e,t){if(1&e){var n=pb();lb(0,"button",58),mb("click",function(){return $y(n),wb(3).proposeDraw()}),UE(1,59),hb()}}function fge(e,t){if(1&e){var n=pb();lb(0,"button",60),mb("click",function(){return $y(n),wb(3).acceptDraw()}),UE(1,61),hb()}}function dge(e,t){if(1&e){var n=pb();lb(0,"button",62),mb("click",function(){return $y(n),wb(3).refuseDraw()}),UE(1,63),hb()}}function vge(e,t){if(1&e){var n=pb();lb(0,"button",64),mb("click",function(){return $y(n),wb(3).gameComponent.pass()}),UE(1,65),hb()}}function pge(e,t){if(1&e){var n=pb();lb(0,"button",66),mb("click",function(){return $y(n),wb(3).acceptTakeBack()}),UE(1,67),hb()}}function gge(e,t){if(1&e){var n=pb();lb(0,"button",68),mb("click",function(){return $y(n),wb(3).refuseTakeBack()}),UE(1,69),hb()}}function yge(e,t){if(1&e){var n=pb();lb(0,"button",70),mb("click",function(){return $y(n),wb(3).askTakeBack()}),UE(1,71),hb()}}function mge(e,t){if(1&e&&(db(0),ab(1,lge,2,0,"button",48),ab(2,hge,2,0,"button",49),ab(3,fge,2,0,"button",50),ab(4,dge,2,0,"button",51),ab(5,vge,2,0,"button",52),ab(6,pge,2,0,"button",53),ab(7,gge,2,0,"button",54),ab(8,yge,2,0,"button",55),vb()),2&e){var n=wb(2);Pw(1),ub("ngIf",n.canResign()),Pw(1),ub("ngIf",n.canProposeDraw()),Pw(1),ub("ngIf",!1===n.endGame&&n.isOpponentWaitingForDrawResponse()),Pw(1),ub("ngIf",!1===n.endGame&&n.isOpponentWaitingForDrawResponse()),Pw(1),ub("ngIf",!1===n.endGame&&n.isPlaying()&&n.gameComponent.canPass&&n.currentPlayer===n.getPlayerName()),Pw(1),ub("ngIf",!1===n.endGame&&n.isOpponentWaitingForTakeBackResponse()),Pw(1),ub("ngIf",!1===n.endGame&&n.isOpponentWaitingForTakeBackResponse()),Pw(1),ub("ngIf",!1===n.endGame&&!1===n.isOpponentWaitingForTakeBackResponse()&&n.canAskTakeBack())}}function kge(e,t){1&e&&(lb(0,"div"),lb(1,"p",73),UE(2,74),hb(),hb())}function _ge(e,t){1&e&&(lb(0,"p",78),UE(1,79),hb())}function wge(e,t){1&e&&(lb(0,"p",80),UE(1,81),hb())}function Cge(e,t){1&e&&(lb(0,"p",82),UE(1,83),hb())}function bge(e,t){if(1&e&&(lb(0,"div"),ab(1,_ge,2,0,"p",75),ab(2,wge,2,0,"p",76),ab(3,Cge,2,0,"p",77),hb()),2&e){var n=wb(3);Pw(1),ub("ngIf",n.currentPart.getDrawAccepter()===n.getPlayerName()),Pw(1),ub("ngIf",n.currentPart.getDrawAccepter()!==n.getPlayerName()&&n.isPlaying()),Pw(1),ub("ngIf",!1===n.isPlaying())}}function Ege(e,t){1&e&&(lb(0,"p",86),UE(1,87),hb())}function Sge(e,t){1&e&&(lb(0,"p",88),UE(1,89),hb())}function Pge(e,t){if(1&e&&(lb(0,"p",88),UE(1,90),hb()),2&e){var n=wb(4);Pw(1),zE(n.currentPart.getWinner().get()),HE(1)}}function Oge(e,t){if(1&e&&(lb(0,"div"),ab(1,Ege,2,0,"p",84),ab(2,Sge,2,0,"p",85),ab(3,Pge,2,1,"p",85),hb()),2&e){var n=wb(3);Pw(1),ub("ngIf",n.currentPart.getWinner().get()===n.getPlayerName()),Pw(1),ub("ngIf",n.currentPart.getWinner().get()!==n.getPlayerName()&&n.isPlaying()),Pw(1),ub("ngIf",!1===n.isPlaying())}}function Tge(e,t){if(1&e&&(lb(0,"p",86),UE(1,91),hb()),2&e){var n=wb(4);Pw(1),zE(n.currentPart.getLoser().get()),HE(1)}}function Ige(e,t){1&e&&(lb(0,"p",88),UE(1,92),hb())}function xge(e,t){if(1&e&&(lb(0,"p",88),UE(1,93),hb()),2&e){var n=wb(4);Pw(1),zE(n.currentPart.getLoser().get()),HE(1)}}function Age(e,t){if(1&e&&(lb(0,"div"),ab(1,Tge,2,1,"p",84),ab(2,Ige,2,0,"p",85),ab(3,xge,2,1,"p",85),hb()),2&e){var n=wb(3);Pw(1),ub("ngIf",n.currentPart.getWinner().get()===n.getPlayerName()),Pw(1),ub("ngIf",n.currentPart.getWinner().get()!==n.getPlayerName()&&n.isPlaying()),Pw(1),ub("ngIf",!1===n.isPlaying())}}function Rge(e,t){1&e&&(lb(0,"p",95),UE(1,96),hb())}function Nge(e,t){if(1&e&&(lb(0,"p",95),UE(1,97),hb()),2&e){var n=wb(4);Pw(1),zE(n.currentPart.getLoser().get()),HE(1)}}function Mge(e,t){if(1&e&&(lb(0,"div"),ab(1,Rge,2,0,"p",94),ab(2,Nge,2,1,"p",94),hb()),2&e){var n=wb(3);Pw(1),ub("ngIf",n.currentPart.getWinner().get()!==n.getPlayerName()&&n.isPlaying()),Pw(1),ub("ngIf",!1===n.isPlaying()||n.currentPart.getWinner().get()===n.getPlayerName())}}function Dge(e,t){if(1&e&&(lb(0,"div",72),fb(1,"hr"),ab(2,kge,3,0,"div",26),ab(3,bge,4,3,"div",26),ab(4,Oge,4,3,"div",26),ab(5,Age,4,3,"div",26),ab(6,Mge,3,2,"div",26),hb()),2&e){var n=wb(2);Pw(2),ub("ngIf",n.currentPart.isHardDraw()),Pw(1),ub("ngIf",n.currentPart.isAgreedDraw()),Pw(1),ub("ngIf",n.currentPart.isWin()),Pw(1),ub("ngIf",n.currentPart.isTimeout()),Pw(1),ub("ngIf",n.currentPart.isResign())}}function Lge(e,t){1&e&&(lb(0,"button",98),UE(1,99),hb())}function Fge(e,t){if(1&e){var n=pb();lb(0,"button",100),mb("click",function(){return $y(n),wb(2).proposeRematch()}),UE(1,101),hb()}}function Bge(e,t){if(1&e){var n=pb();lb(0,"button",102),mb("click",function(){return $y(n),wb(2).acceptRematch()}),UE(1,103),hb()}}function Vge(e,t){if(1&e){var n=pb();lb(0,"div",7),lb(1,"div",8),lb(2,"div",9),ab(3,age,4,2,"div",10),lb(4,"div",11),ab(5,oge,2,2,"p",12),ab(6,sge,2,1,"p",13),lb(7,"app-count-down",14,15),mb("outOfTimeAction",function(){return $y(n),wb().reachedOutOfTime(0)})("addTimeToOpponent",function(){return $y(n),wb().addGlobalTime()}),hb(),lb(9,"app-count-down",16,17),mb("outOfTimeAction",function(){return $y(n),wb().reachedOutOfTime(0)})("addTimeToOpponent",function(){return $y(n),wb().addTurnTime()}),hb(),hb(),lb(11,"p",18),UE(12,19),hb(),lb(13,"div",11),ab(14,uge,2,2,"p",20),ab(15,cge,2,1,"p",21),lb(16,"app-count-down",22,23),mb("outOfTimeAction",function(){return $y(n),wb().reachedOutOfTime(1)})("addTimeToOpponent",function(){return $y(n),wb().addGlobalTime()}),hb(),lb(18,"app-count-down",24,25),mb("outOfTimeAction",function(){return $y(n),wb().reachedOutOfTime(1)})("addTimeToOpponent",function(){return $y(n),wb().addTurnTime()}),hb(),hb(),fb(20,"hr"),ab(21,mge,9,8,"ng-container",26),ab(22,Dge,7,5,"div",27),ab(23,Lge,2,0,"button",28),ab(24,Fge,2,0,"button",29),ab(25,Bge,2,0,"button",30),hb(),hb(),lb(26,"div",31),lb(27,"div",32),fb(28,"app-game-includer"),hb(),hb(),hb()}if(2&e){var r=wb();Pw(3),ub("ngIf",r.currentPart),Pw(2),ub("ngIf",r.players[0].isPresent()),Pw(1),ub("ngIf",r.currentPart&&r.gameComponent&&r.gameComponent.scores.isPresent()),Pw(1),ub("dangerTimeLimit",6e4)("active",null!=r.currentPart&&r.currentPart.getTurn()%2==0)("canAddTime",1===r.observerRole&&!1===r.endGame)("timeToAdd",r.globalTimeMessage),Pw(2),ub("dangerTimeLimit",15e3)("active",null!=r.currentPart&&r.currentPart.getTurn()%2==0)("canAddTime",1===r.observerRole&&!1===r.endGame)("timeToAdd",r.turnTimeMessage),Pw(5),ub("ngIf",r.players[1].isPresent()),Pw(1),ub("ngIf",r.currentPart&&r.gameComponent&&r.gameComponent.scores.isPresent()),Pw(1),ub("dangerTimeLimit",6e4)("active",null!=r.currentPart&&r.currentPart.getTurn()%2==1)("canAddTime",0===r.observerRole&&!1===r.endGame)("timeToAdd",r.globalTimeMessage),Pw(2),ub("dangerTimeLimit",15e3)("active",null!=r.currentPart&&r.currentPart.getTurn()%2==1)("canAddTime",0===r.observerRole&&!1===r.endGame)("timeToAdd",r.turnTimeMessage),Pw(3),ub("ngIf",r.isPlaying()),Pw(1),ub("ngIf",r.endGame),Pw(1),ub("ngIf",r.endGame),Pw(1),ub("ngIf",r.endGame&&r.isPlaying()&&!1===r.rematchProposed),Pw(1),ub("ngIf",r.endGame&&r.isPlaying()&&r.rematchProposed&&r.opponentProposedRematch),Pw(1),ub("ngClass",r.getBoardHighlight())}}var Uge=rp(function e(t){tp(this,e),this.value=t});Uge.PRE_START_DOC=new Uge("PRE_START_DOC"),Uge.STARTING_DOC=new Uge("STARTING_DOC"),Uge.DUPLICATE=new Uge("DUPLICATE"),Uge.MOVE_WITHOUT_TIME=new Uge("MOVE_WITHOUT_TIME"),Uge.MOVE=new Uge("MOVE"),Uge.REQUEST=new Uge("REQUEST"),Uge.END_GAME=new Uge("END_GAME"),Uge.END_GAME_WITHOUT_TIME=new Uge("END_GAME_WITHOUT_TIME"),Uge.ACCEPT_TAKE_BACK_WITHOUT_TIME=new Uge("ACCEPT_TAKE_BACK_WITHOUT_TIME");var zge=function(){var e=function(e){Gv(n,e);var t=$v(n);function n(e,r,i,a,o,s){var u;return tp(this,n),(u=t.call(this,e,r,o)).router=i,u.userService=a,u.gameService=s,u.gameStarted=!1,u.opponent=null,u.playerName=null,u.rematchProposed=!1,u.opponentProposedRematch=!1,u.hasUserPlayed=[!1,!1],u.msToSubstract=[0,0],u.opponentSubscription=sB.empty(),u.OFFLINE_FONT_COLOR={color:"lightgrey"},u.globalTimeMessage=$localize(Ff||(Ff=Rv(["5 minutes"]))),u.turnTimeMessage=$localize(Bf||(Bf=Rv(["30 seconds"]))),rB(n.VERBOSE,"OnlineGameWrapperComponent constructed"),u}return rp(n,[{key:"extractPartIdFromURL",value:function(){return nB.getNonNullable(this.actRoute.snapshot.paramMap.get("id"))}},{key:"extractGameTypeFromURL",value:function(){return nB.getNonNullable(this.actRoute.snapshot.paramMap.get("compo"))}},{key:"isPlaying",value:function(){return this.observerRole===ete.ZERO.value||this.observerRole===ete.ONE.value}},{key:"getPlayer",value:function(){return ete.of(this.observerRole)}},{key:"getPlayerName",value:function(){return nB.getNonNullable(this.playerName)}},{key:"isPlayer",value:function(e){return this.observerRole===e.value}},{key:"isOpponent",value:function(e){return this.observerRole!==e.value}},{key:"redirectIfPartIsInvalid",value:function(){var e=this;return tB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.extractGameTypeFromURL(),t.next=3,e.gameService.getPartValidity(e.currentPartId,n);case 3:if(!t.sent.isFailure()){t.next=8;break}return"/notFound",e.routerEventsSub.unsubscribe(),t.next=8,e.router.navigate(["/notFound"]);case 8:case"end":return t.stop()}},t)}))()}},{key:"setCurrentPartIdOrRedirect",value:function(){return this.currentPartId=this.extractPartIdFromURL(),this.redirectIfPartIsInvalid()}},{key:"ngOnInit",value:function(){var e=this;return tB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return rB(n.VERBOSE,"OnlineGameWrapperComponent.ngOnInit"),e.routerEventsSub=e.router.events.subscribe(function(){var t=tB(regeneratorRuntime.mark(function t(n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=n instanceof yR,!t.t0){t.next=4;break}return t.next=4,e.setCurrentPartIdOrRedirect();case 4:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()),e.userSub=e.authenticationService.getUserObs().subscribe(function(t){e.playerName=t.username.get()}),t.next=5,e.setCurrentPartIdOrRedirect();case 5:case"end":return t.stop()}},t)}))()}},{key:"startGame",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:rB(n.VERBOSE,"OnlineGameWrapperComponent.startGame"),X5(!1===t.gameStarted,"Should not start already started game"),t.joiner=e,t.gameStarted=!0,setTimeout(function(){t.afterGameIncluderViewInit(),t.startPart()},1);case 1:case"end":return r.stop()}},r)}))()}},{key:"startPart",value:function(){var e,t=this;rB(n.VERBOSE,"OnlineGameWrapperComponent.startPart"),this.gameService.startObserving(this.currentPartId,(e=tB(regeneratorRuntime.mark(function e(n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return X5(n.isPresent(),"OnlineGameWrapper observed a part being deleted, this should not happen"),e.next=3,t.onCurrentPartUpdate(n.get());case 3:case"end":return e.stop()}},e)})),function(t){return e.apply(this,arguments)}))}},{key:"onCurrentPartUpdate",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function r(){var i,a,o,s,u;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:i=new t6(t.currentPartId,e),rB(n.VERBOSE,{OnlineGameWrapperComponent_onCurrentPartUpdate:{before:t.currentPart,then:e.data,before_part_turn:i.data.turn,before_state_turn:t.gameComponent.rules.node.gameState.turn,nbPlayedMoves:i.data.listMoves.length}}),a=t.getUpdateType(i),o=e.turn,rB(n.VERBOSE,a===Uge.REQUEST?"UpdateType: Request("+nB.getNonNullable(i.data.request).code+") ("+o+")":"UpdateType: "+a.value+"("+o+")"),s=t.currentPart,r.t0=(t.currentPart=i,a),r.next=r.t0===Uge.REQUEST?8:r.t0===Uge.ACCEPT_TAKE_BACK_WITHOUT_TIME?11:r.t0===Uge.DUPLICATE?12:r.t0===Uge.END_GAME_WITHOUT_TIME?13:r.t0===Uge.END_GAME?14:r.t0===Uge.MOVE_WITHOUT_TIME?15:r.t0===Uge.MOVE?16:r.t0===Uge.PRE_START_DOC?17:19;break;case 8:return r.next=10,t.onRequest(nB.getNonNullable(i.data.request),s);case 10:return r.abrupt("return",r.sent);case 11:return r.abrupt("return",void(t.currentPart=s));case 12:return r.abrupt("return");case 13:return r.abrupt("return",void(t.currentPart=s));case 14:return r.abrupt("return",t.applyEndGame());case 15:return r.abrupt("return",void(t.currentPart=s));case 16:return r.abrupt("return",(t.msToSubstract=t.getLastUpdateTime(s,i,a),t.doNewMoves(i)));case 17:return u=null==t.currentPart||null!=t.currentPart.data.beginning,r.abrupt("return",void X5(null==s||null==s.data.beginning||u,"old part had no beginning time or new part has, we did not expect this!"));case 19:return r.abrupt("return",(X5(a===Uge.STARTING_DOC,"Unexpected update type "+a),t.setChronos(),t.setPlayersDatas(i),t.startCountDownFor(ete.ZERO)));case 20:case"end":return r.stop()}},r)}))()}},{key:"getUpdateType",value:function(e){var t=bpe.from(null!=this.currentPart?this.currentPart.data:null,e.data);rB(n.VERBOSE,{diff:t});var r=t.countChanges();if(0===r)return Uge.DUPLICATE;if(e.data.request){var i=null!=t.removed.lastUpdateTime;return"TakeBackAccepted"===e.data.request.code&&i?Uge.ACCEPT_TAKE_BACK_WITHOUT_TIME:Uge.REQUEST}if(this.isMove(t,r))return 1===e.data.turn?null==e.data.lastUpdateTime?Uge.MOVE_WITHOUT_TIME:Uge.MOVE:null==t.modified.lastUpdateTime?Uge.MOVE_WITHOUT_TIME:Uge.MOVE;if(null==e.data.beginning)return Uge.PRE_START_DOC;if(e.data.result!==e6.UNACHIEVED.value){var a=null==t.modified.lastUpdateTime;return null!=t.modified.turn&&a?Uge.END_GAME_WITHOUT_TIME:Uge.END_GAME}return X5(null!=e.data.beginning&&0===e.data.listMoves.length,"Unexpected update: "+JSON.stringify(t)),Uge.STARTING_DOC}},{key:"isMove",value:function(e,t){if(null!=e.modified.listMoves&&null!=e.modified.turn){return t===(e.isPresent("lastUpdateTime").present?1:0)+(e.isPresent("scorePlayerZero").present?1:0)+(e.isPresent("scorePlayerOne").present?1:0)+(e.isPresent("remainingMsForZero").present?1:0)+(e.isPresent("remainingMsForOne").present?1:0)+(null==e.removed.request?0:1)+3}return!1}},{key:"getLastUpdateTime",value:function(e,t,n){var r=this.getMoreRecentTime(e),i=this.getMoreRecentTime(t);X5(null!=r,"TODO: OLD_TIME WAS NULL, UNDO COMMENT AND TEST!"),X5(null!=i,"TODO UPDATE_TIME WAS NULL, UNDO COMMENT AND TEST!");var a=ete.fromTurn(e.data.turn);return this.getTimeUsedForLastTurn(nB.getNonNullable(r),nB.getNonNullable(i),n,a)}},{key:"getMoreRecentTime",value:function(e){var t;return null!==(t=e.data.lastUpdateTime)&&void 0!==t?t:e.data.beginning}},{key:"getTimeUsedForLastTurn",value:function(e,t,n,r){var i=function(e,t){return Epe(t)-Epe(e)}(e,t),a=[0,0];return a[r.value]=i,a}},{key:"setChronos",value:function(){rB(n.VERBOSE,"onlineGameWrapperComponent.setChronos()"),this.chronoZeroGlobal.setDuration(1e3*this.joiner.totalPartDuration),this.chronoOneGlobal.setDuration(1e3*this.joiner.totalPartDuration),this.chronoZeroTurn.setDuration(1e3*this.joiner.maximalMoveDuration),this.chronoOneTurn.setDuration(1e3*this.joiner.maximalMoveDuration)}},{key:"didUserPlay",value:function(e){return this.hasUserPlayed[e.value]}},{key:"doNewMoves",value:function(e){this.switchPlayer();for(var t=ite.copyImmutableArray(e.data.listMoves),n=this.gameComponent.rules;n.node.gameState.turn<t.length;){var r=n.node.gameState.turn,i=this.gameComponent.encoder.decode(t[r]),a=n.isLegal(i,n.node.gameState),o="We received an incorrect db move: "+i.toString()+" in "+t+" at turn "+r+'because "'+a.getReasonOr("")+'"';X5(a.isSuccess(),o),n.choose(i)}this.currentPlayer=this.players[this.gameComponent.rules.node.gameState.turn%2].get(),this.gameComponent.updateBoard()}},{key:"switchPlayer",value:function(){rB(n.VERBOSE,"OnlineGameWrapperComponent.switchPlayer");var e=ete.fromTurn(this.currentPart.data.turn);this.currentPlayer=this.players[this.gameComponent.rules.node.gameState.turn%2].get();var t=e.getOpponent();this.didUserPlay(t)&&this.pauseCountDownsFor(t),this.didUserPlay(e)?(rB(n.VERBOSE,"OnlineGameWrapperComponent.onCurrentPartUpdate: changing current player"),this.resumeCountDownFor(e)):this.startCountDownFor(e)}},{key:"resetChronoFor",value:function(e){this.pauseCountDownsFor(e),this.resumeCountDownFor(e)}},{key:"applyEndGame",value:function(){var e=this.currentPart,t=ete.fromTurn(e.data.turn);this.endGame=!0,[e6.VICTORY,e6.HARD_DRAW].some(function(t){return t.value===e.data.result})?this.doNewMoves(this.currentPart):(X5(!0===[e6.RESIGN,e6.TIMEOUT,e6.HARD_DRAW,e6.AGREED_DRAW_BY_ZERO,e6.AGREED_DRAW_BY_ONE].some(function(t){return t.value===e.data.result}),"Unknown type of end game ("+e.data.result+")"),rB(n.VERBOSE,"endGame est true et winner est "+e.getWinner())),this.stopCountdownsFor(t)}},{key:"notifyDraw",value:function(e,t){this.endGame=!0;var n=this.getPlayer();return this.gameService.updateDBBoard(this.currentPartId,n,e,[0,0],t,!0)}},{key:"notifyTimeoutVictory",value:function(e,t,n,r){var i=this;return tB(regeneratorRuntime.mark(function a(){var o;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return i.endGame=!0,o=i.currentPart.setWinnerAndLoser(e,r),i.currentPart=o,a.next=5,i.gameService.notifyTimeout(i.currentPartId,t,n,e,r);case 5:case"end":return a.stop()}},a)}))()}},{key:"notifyVictory",value:function(e,t){rB(n.VERBOSE,"OnlineGameWrapperComponent.notifyVictory");var r=this.gameComponent.rules.getGameStatus(this.gameComponent.rules.node);r===Are.ONE_WON?this.currentPart=this.currentPart.setWinnerAndLoser(this.players[1].get(),this.players[0].get()):(X5(r===Are.ZERO_WON,"impossible to get a victory without winner!"),this.currentPart=this.currentPart.setWinnerAndLoser(this.players[0].get(),this.players[1].get())),this.endGame=!0;var i=this.getPlayer();return this.gameService.updateDBBoard(this.currentPartId,i,e,[0,0],t,!1,this.currentPart.getWinner().get(),this.currentPart.getLoser().get())}},{key:"canAskTakeBack",value:function(){return X5(this.isPlaying(),"Non playing should not call canAskTakeBack"),!(null==this.currentPart||this.currentPart.data.turn<=this.observerRole||this.currentPart.data.request&&"TakeBackRefused"===this.currentPart.data.request.code&&this.currentPart.data.request.data.player===this.getPlayer().getOpponent().value)&&this.getTakeBackRequester()===Xee.NONE}},{key:"isOpponentWaitingForTakeBackResponse",value:function(){var e=this.getTakeBackRequester();return!!e.isPlayer()&&this.isOpponent(e)}},{key:"getTakeBackRequester",value:function(){if(null==this.currentPart)return Xee.NONE;var e=this.currentPart.data.request;return e&&"TakeBackAsked"===e.code?tte.getPlayer(e):Xee.NONE}},{key:"canProposeDraw",value:function(){return X5(this.isPlaying(),"Non playing should not call canProposeDraw"),!(this.endGame||null==this.currentPart||this.currentPart.data.request&&"DrawRefused"===this.currentPart.data.request.code&&tte.getPlayer(this.currentPart.data.request)===this.getPlayer().getOpponent()||this.isOpponentWaitingForDrawResponse())&&this.getDrawRequester()===Xee.NONE}},{key:"isOpponentWaitingForDrawResponse",value:function(){var e=this.getDrawRequester();return e!==Xee.NONE&&this.isOpponent(e)}},{key:"getDrawRequester",value:function(){if(null==this.currentPart)return Xee.NONE;var e=this.currentPart.data.request;return e&&"DrawProposed"===e.code?tte.getPlayer(e):Xee.NONE}},{key:"onRequest",value:function(e,t){var r=this;return tB(regeneratorRuntime.mark(function i(){var a,o,s;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:i.t0=(rB(n.VERBOSE,{called:"OnlineGameWrapper.onRequest(",request:e,oldPart:t}),e.code),i.next="TakeBackAsked"===i.t0||"TakeBackRefused"===i.t0?3:"TakeBackAccepted"===i.t0?4:"RematchProposed"===i.t0?6:"RematchAccepted"===i.t0?10:"DrawProposed"===i.t0||"DrawRefused"===i.t0?15:"AddTurnTime"===i.t0?16:"AddGlobalTime"===i.t0?19:22;break;case 3:return i.abrupt("break",25);case 4:return r.takeBackTo(r.currentPart.data.turn),i.abrupt("break",25);case 6:return r.rematchProposed=!0,a=tte.getPlayer(e).getOpponent(),r.isPlayer(a)&&(rB(n.VERBOSE,"ton adversaire te propose une revanche"),r.opponentProposedRematch=!0),i.abrupt("break",25);case 10:return i.next=12,r.router.navigate(["/nextGameLoading"]);case 12:return i.next=14,r.router.navigate(["/play",tte.getTypeGame(e),tte.getPartId(e)]);case 14:case 15:return i.abrupt("break",25);case 16:return 3e4,o=ete.of(e.data.player),r.addTurnTimeTo(o,3e4),i.abrupt("break",25);case 19:return 3e5,s=ete.of(e.data.player),r.addGlobalTimeTo(s,3e5),i.abrupt("break",25);case 22:return nB.expectToBe(e.code,"DrawAccepted","Unknown RequestType : "+e.code+" for "+JSON.stringify(e)),i.next=25,r.acceptDraw();case 25:case"end":return i.stop()}},i)}))()}},{key:"takeBackTo",value:function(e){if(this.gameComponent.rules.node=this.gameComponent.rules.node.mother.get(),this.gameComponent.rules.node.gameState.turn===e)this.switchPlayer();else{this.gameComponent.rules.node=this.gameComponent.rules.node.mother.get();var t=ete.fromTurn(e);this.resetChronoFor(t)}this.gameComponent.updateBoard()}},{key:"setPlayersDatas",value:function(e){var t=this;rB(n.VERBOSE,{OnlineGameWrapper_setPlayersDatas:e}),this.players=[sB.of(e.data.playerZero),sB.ofNullable(e.data.playerOne)],X5(null!=e.data.playerOne,"should not setPlayersDatas when players data is not received"),this.currentPlayer=this.players[e.data.turn%2].get();var r=sB.empty();if(this.players[0].equalsValue(this.getPlayerName())?(this.observerRole=ete.ZERO.value,r=this.players[1]):this.players[1].equalsValue(this.getPlayerName())?(this.observerRole=ete.ONE.value,r=this.players[0]):this.observerRole=Xee.NONE.value,r.isPresent()){var i=new o6(function(e){t.opponent=e[0].data},function(e){t.opponent=e[0].data},function(e){throw new Error("OnlineGameWrapper: Opponent was deleted, what sorcery is this: "+JSON.stringify(e))});this.opponentSubscription=sB.of(this.userService.observeUserByUsername(r.get(),i))}}},{key:"onLegalUserMove",value:function(e,t){var r=this;return tB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(rB(n.VERBOSE,"dans OnlineGameWrapperComponent.onLegalUserMove"),r.isOpponentWaitingForTakeBackResponse()){i.next=2;break}return i.abrupt("return",r.updateDBBoard(e,r.msToSubstract,t));case 2:r.gameComponent.message("You must answer to take back request");case 3:case"end":return i.stop()}},i)}))()}},{key:"updateDBBoard",value:function(e,t,r){var i=this;return tB(regeneratorRuntime.mark(function a(){var o,s,u;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(o=i.gameComponent.encoder.encodeMove(e),rB(n.VERBOSE,"OnlineGameWrapperComponent.updateDBBoard("+e.toString()+", "+r+")"),i.gameComponent.rules.choose(e),!(s=i.gameComponent.rules.getGameStatus(i.gameComponent.rules.node)).isEndGame){a.next=5;break}return a.abrupt("return",s===Are.DRAW?i.notifyDraw(o,r):i.notifyVictory(o,r));case 5:return u=i.getPlayer(),a.abrupt("return",i.gameService.updateDBBoard(i.currentPartId,u,o,t,r));case 7:case"end":return a.stop()}},a)}))()}},{key:"resign",value:function(){var e=this;return tB(regeneratorRuntime.mark(function t(){var n,r,i,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.getLastIndex(),r=e.getPlayer(),i=e.players[e.observerRole%2].get(),a=e.players[(e.observerRole+1)%2].get(),t.next=3,e.gameService.resign(e.currentPartId,n,r,a,i);case 3:case"end":return t.stop()}},t)}))()}},{key:"getLastIndex",value:function(){return this.currentPart.data.lastUpdate.index}},{key:"reachedOutOfTime",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function r(){var i,a,o,s,u;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(rB(n.VERBOSE,"OnlineGameWrapperComponent.reachedOutOfTime("+e+")"),i=t.getLastIndex(),a=t.getPlayer(),t.stopCountdownsFor(ete.of(e)),o=nB.getNonNullable(t.opponent),e!==t.observerRole){r.next=10;break}return s=nB.getNonNullable(o.username),r.next=8,t.notifyTimeoutVictory(s,a,i,t.getPlayerName());case 8:r.next=19;break;case 10:if(!t.endGame){r.next=14;break}rB(!0,"time might be better handled in the future"),r.next=19;break;case 14:if(!t.opponentIsOffline()){r.next=19;break}return u=nB.getNonNullable(o.username),r.next=18,t.notifyTimeoutVictory(t.getPlayerName(),a,e,u);case 18:t.endGame=!0;case 19:case"end":return r.stop()}},r)}))()}},{key:"acceptRematch",value:function(){var e=this;return tB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return X5(e.isPlaying(),"Non playing should not call acceptRematch"),n=new t6(e.currentPartId,e.currentPart.data),t.next=4,e.gameService.acceptRematch(n,e.getLastIndex(),e.getPlayer());case 4:return t.abrupt("return",!0);case 5:case"end":return t.stop()}},t)}))()}},{key:"proposeRematch",value:function(){var e=this;return tB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return X5(e.isPlaying(),"Non playing should not call proposeRematch"),t.next=3,e.gameService.proposeRematch(e.currentPartId,e.getLastIndex(),e.getPlayer());case 3:return t.abrupt("return",!0);case 4:case"end":return t.stop()}},t)}))()}},{key:"proposeDraw",value:function(){return this.gameService.proposeDraw(this.currentPartId,this.getLastIndex(),this.getPlayer())}},{key:"acceptDraw",value:function(){return this.gameService.acceptDraw(this.currentPartId,this.getLastIndex(),this.getPlayer())}},{key:"refuseDraw",value:function(){return this.gameService.refuseDraw(this.currentPartId,this.getLastIndex(),this.getPlayer())}},{key:"askTakeBack",value:function(){return this.gameService.askTakeBack(this.currentPartId,this.getLastIndex(),this.getPlayer())}},{key:"acceptTakeBack",value:function(){var e=this;return tB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.getPlayer(),t.next=3,e.gameService.acceptTakeBack(e.currentPartId,e.currentPart,n,e.msToSubstract);case 3:e.msToSubstract=[0,0];case 4:case"end":return t.stop()}},t)}))()}},{key:"refuseTakeBack",value:function(){return this.gameService.refuseTakeBack(this.currentPartId,this.getLastIndex(),this.getPlayer())}},{key:"startCountDownFor",value:function(e){rB(n.VERBOSE,"dans OnlineGameWrapperComponent.startCountDownFor("+e.toString()+") (turn "+this.currentPart.data.turn+")"),this.hasUserPlayed[e.value]=!0,e===ete.ZERO?(this.chronoZeroGlobal.start(),this.chronoZeroTurn.start()):(this.chronoOneGlobal.start(),this.chronoOneTurn.start())}},{key:"resumeCountDownFor",value:function(e){var t,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];rB(n.VERBOSE,"dans OnlineGameWrapperComponent.resumeCountDownFor("+e.toString()+") (turn "+this.currentPart.data.turn+")"),e===ete.ZERO?(this.chronoZeroGlobal.changeDuration(nB.getNonNullable(this.currentPart.data.remainingMsForZero)),this.chronoZeroGlobal.resume(),t=this.chronoZeroTurn):(this.chronoOneGlobal.changeDuration(nB.getNonNullable(this.currentPart.data.remainingMsForOne)),this.chronoOneGlobal.resume(),t=this.chronoOneTurn),r?(t.setDuration(1e3*this.joiner.maximalMoveDuration),t.start()):t.resume()}},{key:"pauseCountDownsFor",value:function(e){var t,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];rB(n.VERBOSE,"dans OnlineGameWrapperComponent.pauseCountDownFor("+e.value+") (turn "+this.currentPart.data.turn+")"),e===ete.ZERO?(this.chronoZeroGlobal.pause(),t=this.chronoZeroTurn):(this.chronoOneGlobal.pause(),t=this.chronoOneTurn),r?t.stop():t.pause()}},{key:"stopCountdownsFor",value:function(e){rB(n.VERBOSE,"cdc::stopCountDownsFor("+e.toString()+") (turn "+this.currentPart.data.turn+")"),e===ete.ZERO?(this.chronoZeroGlobal.isStarted()&&this.chronoZeroGlobal.stop(),this.chronoZeroTurn.isStarted()&&this.chronoZeroTurn.stop()):(this.chronoOneGlobal.isStarted()&&this.chronoOneGlobal.stop(),this.chronoOneTurn.isStarted()&&this.chronoOneTurn.stop())}},{key:"getPlayerNameClass",value:function(e){return this.opponentIsOffline()?"has-text-grey-light":0===e?"has-text-white":"has-text-black"}},{key:"opponentIsOffline",value:function(){return null!=this.opponent&&"offline"===this.opponent.state}},{key:"canResign",value:function(){return X5(this.isPlaying(),"Non playing should not call canResign"),!(!0===this.endGame||null==this.opponent)}},{key:"addGlobalTime",value:function(){var e=this.getPlayer(),t=this.getLastIndex();return this.gameService.addGlobalTime(this.currentPartId,t,this.currentPart.data,e)}},{key:"addTurnTime",value:function(){var e=this.getPlayer();return this.gameService.addTurnTime(e,this.getLastIndex(),this.currentPartId)}},{key:"addTurnTimeTo",value:function(e,t){var n=ete.fromTurn(this.currentPart.getTurn());this.pauseCountDownsFor(n,!1),e===ete.ZERO?this.chronoZeroTurn.changeDuration(this.chronoZeroTurn.remainingMs+t):this.chronoOneTurn.changeDuration(this.chronoOneTurn.remainingMs+t),this.resumeCountDownFor(n,!1)}},{key:"addGlobalTimeTo",value:function(e,t){e===ete.ZERO?this.chronoZeroGlobal.changeDuration(this.chronoZeroGlobal.remainingMs+t):this.chronoOneGlobal.changeDuration(this.chronoOneGlobal.remainingMs+t)}},{key:"ngOnDestroy",value:function(){null!=this.routerEventsSub&&null!=this.routerEventsSub.unsubscribe&&this.routerEventsSub.unsubscribe(),null!=this.userSub&&null!=this.userSub.unsubscribe&&this.userSub.unsubscribe(),!0===this.gameStarted&&(this.opponentSubscription.isPresent()&&this.opponentSubscription.get()(),this.gameService.stopObserving())}}]),n}(Cpe);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(sb(XE),sb(bN),sb(qM),sb(c6),sb($ee),sb(ste))},e.\u0275cmp=ey({type:e,selectors:[["app-online-game-wrapper"]],viewQuery:function(e,t){var n;(1&e&&(EP(Ype,5),EP(Kpe,5),EP(Jpe,5),EP(Qpe,5),EP(Xpe,5),EP(ege,5)),2&e)&&(bP(n=SP())&&(t.partCreation=n.first),bP(n=SP())&&(t.chatComponent=n.first),bP(n=SP())&&(t.chronoZeroGlobal=n.first),bP(n=SP())&&(t.chronoOneGlobal=n.first),bP(n=SP())&&(t.chronoZeroTurn=n.first),bP(n=SP())&&(t.chronoOneTurn=n.first))},features:[zC],decls:5,vars:4,consts:function(){return[["id","partCreation",3,"partId","userName","gameStartNotification",4,"ngIf"],["id","game","class","tile is-ancestor",4,"ngIf"],[1,"block","mt-2"],["id","chat",1,"box"],[3,"chatId","turn"],["id","partCreation",3,"partId","userName","gameStartNotification"],["partCreation",""],["id","game",1,"tile","is-ancestor"],[1,"tile","is-parent"],[1,"tile","is-child","box","has-text-centered"],["class","block","id","turnIndicator",4,"ngIf"],[1,"block"],["id","playerZeroIndicator","class","player0-bg",3,"ngClass",4,"ngIf"],["id","scoreZeroIndicator",4,"ngIf"],["debugName","ZERO Global",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoZeroGlobal",""],["debugName","ZERO Turn",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoZeroTurn",""],[1,"is-size-3"],$localize(Vf||(Vf=Rv(["vs."]))),["id","playerOneIndicator","class","player1-bg",3,"ngClass",4,"ngIf"],["id","scoreOneIndicator",4,"ngIf"],["debugName","ONE Global",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoOneGlobal",""],["debugName","ONE Turn",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoOneTurn",""],[4,"ngIf"],["class","block","id","winnerIndicator",4,"ngIf"],["class","button is-primary is-fullwidth mb-1","id","backToServerButton","routerLink","/lobby",4,"ngIf"],["id","proposeRematchButton","class","button is-fullwidth mb-1",3,"click",4,"ngIf"],["class","button is-fullwidth is-warning","id","acceptRematchButton",3,"click",4,"ngIf"],["id","board-tile",1,"tile","is-9","is-parent","rounded-div",3,"ngClass"],["id","board",1,"tile","is-child","box"],["id","turnIndicator",1,"block"],[1,"subtitle"],$localize(Uf||(Uf=Rv(["Turn n\xb0",":INTERPOLATION:"])),"\ufffd0\ufffd"),["class","subtitle","id","currentPlayerIndicator",4,"ngIf"],["id","currentPlayerIndicator",1,"subtitle"],[4,"ngIf","ngIfElse"],["opponentsTurn",""],$localize(zf||(zf=Rv(["It is your turn."]))),$localize(Hf||(Hf=Rv(["It is ",":INTERPOLATION:'s turn."])),"\ufffd0\ufffd"),["id","playerZeroIndicator",1,"player0-bg",3,"ngClass"],["id","scoreZeroIndicator"],$localize(Gf||(Gf=Rv(["",":INTERPOLATION: points"])),"\ufffd0\ufffd"),["id","playerOneIndicator",1,"player1-bg",3,"ngClass"],["id","scoreOneIndicator"],$localize(qf||(qf=Rv(["",":INTERPOLATION: points"])),"\ufffd0\ufffd"),["class","button is-fullwidth mb-1","id","resignButton",3,"click",4,"ngIf"],["class","button is-fullwidth mb-1","id","proposeDrawButton",3,"click",4,"ngIf"],["class","button is-warning is-fullwidth mb-1","id","acceptDrawButton",3,"click",4,"ngIf"],["class","button is-warning is-fullwidth mb-1","id","refuseDrawButton",3,"click",4,"ngIf"],["class","button is-fullwidth mb-1","id","passButton",3,"click",4,"ngIf"],["class","button is-warning is-fullwidth mb-1","id","acceptTakeBackButton",3,"click",4,"ngIf"],["class","button is-warning is-fullwidth mb-1","color","warn","id","refuseTakeBackButton",3,"click",4,"ngIf"],["class","button is-fullwidth","id","askTakeBackButton",3,"click",4,"ngIf"],["id","resignButton",1,"button","is-fullwidth","mb-1",3,"click"],$localize($f||($f=Rv(["Resign"]))),["id","proposeDrawButton",1,"button","is-fullwidth","mb-1",3,"click"],$localize(Wf||(Wf=Rv(["Propose a draw"]))),["id","acceptDrawButton",1,"button","is-warning","is-fullwidth","mb-1",3,"click"],$localize(jf||(jf=Rv(["Accept draw"]))),["id","refuseDrawButton",1,"button","is-warning","is-fullwidth","mb-1",3,"click"],$localize(Zf||(Zf=Rv(["Reject draw"]))),["id","passButton",1,"button","is-fullwidth","mb-1",3,"click"],$localize(Yf||(Yf=Rv(["Pass a turn"]))),["id","acceptTakeBackButton",1,"button","is-warning","is-fullwidth","mb-1",3,"click"],$localize(Kf||(Kf=Rv(["Accept take back"]))),["color","warn","id","refuseTakeBackButton",1,"button","is-warning","is-fullwidth","mb-1",3,"click"],$localize(Jf||(Jf=Rv(["Reject take back"]))),["id","askTakeBackButton",1,"button","is-fullwidth",3,"click"],$localize(Qf||(Qf=Rv(["Ask to take back one move"]))),["id","winnerIndicator",1,"block"],["id","hardDrawIndicator",1,"title"],$localize(Xf||(Xf=Rv(["Draw"]))),["class","title","id","youAgreedToDrawIndicator",4,"ngIf"],["class","title","id","yourOpponentAgreedToDrawIndicator",4,"ngIf"],["class","title","id","playersAgreedToDraw",4,"ngIf"],["id","youAgreedToDrawIndicator",1,"title"],$localize(ed||(ed=Rv(["You agreed to draw."]))),["id","yourOpponentAgreedToDrawIndicator",1,"title"],$localize(td||(td=Rv(["Your draw proposal has been accepted."]))),["id","playersAgreedToDraw",1,"title"],$localize(nd||(nd=Rv(["Players agreed to draw."]))),["class","title","id","youWonIndicator",4,"ngIf"],["class","title",4,"ngIf"],["id","youWonIndicator",1,"title"],$localize(rd||(rd=Rv(["You won."]))),[1,"title"],$localize(id||(id=Rv(["You lost."]))),$localize(ad||(ad=Rv(["",":INTERPOLATION: won."])),"\ufffd0\ufffd"),$localize(od||(od=Rv(["",":INTERPOLATION: has reached their time limit. You won."])),"\ufffd0\ufffd"),$localize(sd||(sd=Rv(["You reached your time limit."]))),$localize(ud||(ud=Rv(["",":INTERPOLATION: has reached their time limit."])),"\ufffd0\ufffd"),["class","title","id","resignIndicator",4,"ngIf"],["id","resignIndicator",1,"title"],$localize(cd||(cd=Rv(["You resigned."]))),$localize(ld||(ld=Rv(["",":INTERPOLATION: has resigned."])),"\ufffd0\ufffd"),["id","backToServerButton","routerLink","/lobby",1,"button","is-primary","is-fullwidth","mb-1"],$localize(hd||(hd=Rv(["Go back to the game list"]))),["id","proposeRematchButton",1,"button","is-fullwidth","mb-1",3,"click"],$localize(fd||(fd=Rv(["Propose to play again"]))),["id","acceptRematchButton",1,"button","is-fullwidth","is-warning",3,"click"],$localize(dd||(dd=Rv(["Accept to play again"])))]},template:function(e,t){1&e&&(ab(0,tge,2,2,"app-part-creation",0),ab(1,Vge,29,27,"div",1),lb(2,"div",2),lb(3,"div",3),fb(4,"app-chat",4),hb(),hb()),2&e&&(ub("ngIf",!1===t.gameStarted),Pw(1),ub("ngIf",t.gameStarted),Pw(3),ub("chatId",t.currentPartId)("turn",null==t.currentPart?null:t.currentPart.getTurn()))},directives:[NT,upe,Wpe,Zpe,IT,_pe,WM],encapsulation:2}),e}();function Hge(e,t){if(1&e&&(lb(0,"option",25),Rb(1),hb()),2&e){var n=t.$implicit;ub("value",n.name),Pw(1),Nb(n.name)}}function Gge(e,t){if(1&e&&(lb(0,"option",25),UE(1,29),hb()),2&e){var n=t.$implicit;ub("value",n),Pw(1),zE(n),HE(1)}}var qge=function(){return[1,2,3,4,5,6,7,8,9,10,11,12]};function $ge(e,t){if(1&e){var n=pb();lb(0,"select",26),mb("ngModelChange",function(e){return $y(n),wb(2).aiDepths[0]=e})("change",function(){return $y(n),wb(2).updatePlayer(0)}),lb(1,"option",27),UE(2,28),hb(),ab(3,Gge,2,2,"option",16),hb()}2&e&&(ub("ngModel",wb(2).aiDepths[0]),Pw(3),ub("ngForOf",eP(2,qge)))}function Wge(e,t){if(1&e&&(lb(0,"p",30),UE(1,31),hb()),2&e){var n=wb(2);Pw(1),zE(n.gameComponent.scores.get()[0]),HE(1)}}function jge(e,t){if(1&e&&(lb(0,"option",25),Rb(1),hb()),2&e){var n=t.$implicit;ub("value",n.name),Pw(1),Nb(n.name)}}function Zge(e,t){if(1&e&&(lb(0,"option",25),UE(1,34),hb()),2&e){var n=t.$implicit;ub("value",n),Pw(1),zE(n),HE(1)}}function Yge(e,t){if(1&e){var n=pb();lb(0,"select",32),mb("ngModelChange",function(e){return $y(n),wb(2).aiDepths[1]=e})("change",function(){return $y(n),wb(2).updatePlayer(1)}),lb(1,"option",27),UE(2,33),hb(),ab(3,Zge,2,2,"option",16),hb()}2&e&&(ub("ngModel",wb(2).aiDepths[1]),Pw(3),ub("ngForOf",eP(2,qge)))}function Kge(e,t){if(1&e&&(lb(0,"p",35),UE(1,36),hb()),2&e){var n=wb(2);Pw(1),zE(n.gameComponent.scores.get()[1]),HE(1)}}function Jge(e,t){if(1&e&&(lb(0,"h4"),UE(1,40),hb()),2&e){var n=wb(3);Pw(1),zE(n.winner.get()),HE(1)}}function Qge(e,t){1&e&&(lb(0,"h4",41),UE(1,42),hb())}function Xge(e,t){if(1&e&&(lb(0,"div",37),ab(1,Jge,2,1,"h4",38),ab(2,Qge,2,0,"h4",39),hb()),2&e){var n=wb(2);Pw(1),ub("ngIf",n.winner.isPresent()),Pw(1),ub("ngIf",n.winner.isAbsent())}}function eye(e,t){if(1&e){var n=pb();lb(0,"div",6),lb(1,"div",7),lb(2,"p",8),UE(3,9),hb(),hb(),lb(4,"div",10),lb(5,"div",11),lb(6,"div",12),lb(7,"select",13),mb("change",function(){return $y(n),wb().updatePlayer(0)})("ngModelChange",function(e){return $y(n),wb().playerSelection[0]=e}),lb(8,"option",14),UE(9,15),hb(),ab(10,Hge,2,2,"option",16),hb(),hb(),lb(11,"div",12),ab(12,$ge,4,3,"select",17),hb(),ab(13,Wge,2,1,"p",18),hb(),lb(14,"div",19),lb(15,"div",12),lb(16,"select",20),mb("change",function(){return $y(n),wb().updatePlayer(1)})("ngModelChange",function(e){return $y(n),wb().playerSelection[1]=e}),lb(17,"option",14),UE(18,21),hb(),ab(19,jge,2,2,"option",16),hb(),hb(),lb(20,"div",12),ab(21,Yge,4,3,"select",22),hb(),ab(22,Kge,2,1,"p",23),hb(),hb(),ab(23,Xge,3,2,"div",24),hb()}if(2&e){var r=wb();Pw(3),zE(r.gameComponent.rules.node.gameState.turn+1),HE(3),Pw(4),ub("ngModel",r.playerSelection[0]),Pw(3),ub("ngForOf",r.gameComponent.availableMinimaxes),Pw(2),ub("ngIf",!1===r.players[0].equalsValue("human")),Pw(1),ub("ngIf",r.gameComponent.scores.isPresent()),Pw(3),ub("ngModel",r.playerSelection[1]),Pw(3),ub("ngForOf",r.gameComponent.availableMinimaxes),Pw(2),ub("ngIf",!1===r.players[1].equalsValue("human")),Pw(1),ub("ngIf",r.gameComponent.scores.isPresent()),Pw(1),ub("ngIf",r.endGame)}}function tye(e,t){if(1&e&&(db(0),Rb(1),fb(2,"br"),vb()),2&e){var n=t.$implicit,r=wb(3);Pw(1),Mb(" ",n.name+": "+n.getBoardValue(r.gameComponent.rules.node)," ")}}function nye(e,t){if(1&e&&(db(0),ab(1,tye,3,1,"ng-container",48),Rb(2),fb(3,"br"),Rb(4),fb(5,"br"),vb()),2&e){var n=wb(2);Pw(1),ub("ngForOf",n.gameComponent.availableMinimaxes),Pw(1),Mb(" Created ",n.getCreatedNodes()," nodes."),Pw(2),Mb(" Minimax time: ",n.getMinimaxTime(),"ms.")}}function rye(e,t){if(1&e){var n=pb();lb(0,"button",49),mb("click",function(){return $y(n),wb(2).gameComponent.pass()}),UE(1,50),hb()}}function iye(e,t){if(1&e){var n=pb();lb(0,"button",51),mb("click",function(){return $y(n),wb(2).takeBack()}),UE(1,52),hb()}}function aye(e,t){if(1&e){var n=pb();lb(0,"div",43),ab(1,nye,6,3,"ng-container",38),ab(2,rye,2,0,"button",44),ab(3,iye,2,0,"button",45),lb(4,"button",46),mb("click",function(){return $y(n),wb().restartGame()}),UE(5,47),hb(),hb()}if(2&e){var r=wb();Pw(1),ub("ngIf",r.gameComponent.rules.node.move),Pw(1),ub("ngIf",!1===r.endGame&&r.gameComponent.canPass),Pw(1),ub("ngIf",r.canTakeBack())}}var oye=function(){var e=function(e){Gv(n,e);var t=$v(n);function n(e,r,i,a,o){var s;return tp(this,n),(s=t.call(this,e,r,i)).cdr=a,s.messageDisplayer=o,s.aiDepths=["0","0"],s.playerSelection=["human","human"],s.winner=sB.empty(),s.botTimeOut=1e3,s.players=[sB.of(s.playerSelection[0]),sB.of(s.playerSelection[1])],rB(n.VERBOSE,"LocalGameWrapper.constructor"),s}return rp(n,[{key:"getCreatedNodes",value:function(){return Ire.createdNodes}},{key:"getMinimaxTime",value:function(){return Ire.minimaxTime}},{key:"ngAfterViewInit",value:function(){var e=this;setTimeout(function(){e.afterGameIncluderViewInit(),e.restartGame(),e.cdr.detectChanges()},1)}},{key:"updatePlayer",value:function(e){this.players[e]=sB.of(this.playerSelection[e]),this.proposeAIToPlay()}},{key:"onLegalUserMove",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:rB(n.VERBOSE,"LocalGameWrapperComponent.onLegalUserMove"),t.gameComponent.rules.choose(e),t.updateBoard(),t.proposeAIToPlay();case 1:case"end":return r.stop()}},r)}))()}},{key:"updateBoard",value:function(){this.gameComponent.updateBoard();var e=this.gameComponent.rules.getGameStatus(this.gameComponent.rules.node);!0===e.isEndGame&&(this.endGame=!0,e.winner.isPlayer()&&(this.winner=sB.of($localize(vd||(vd=Rv(["Player ",""])),e.winner.value+1))))}},{key:"proposeAIToPlay",value:function(){var e=this,t=this.getPlayingAI();t.isPresent()&&setTimeout(tB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.doAIMove(t.get());case 2:case"end":return n.stop()}},n)})),this.botTimeOut)}},{key:"getPlayingAI",value:function(){var e=this;if(this.gameComponent.rules.getGameStatus(this.gameComponent.rules.node).isEndGame)return sB.empty();var t=this.gameComponent.rules.node.gameState.turn%2;return"0"===this.aiDepths[t]?sB.empty():sB.ofNullable(this.gameComponent.availableMinimaxes.find(function(n){return e.players[t].equalsValue(n.name)}))}},{key:"doAIMove",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return X5((r=t.gameComponent.rules).getGameStatus(r.node)===Are.ONGOING,"IA should not try to play when game is over!"),i=Number.parseInt(t.aiDepths[r.node.gameState.turn%2%2]),a=r.node.findBestMove(i,e,!0),n.abrupt("return",r.choose(a)?(t.updateBoard(),t.cdr.detectChanges(),t.proposeAIToPlay(),K5.SUCCESS):(t.messageDisplayer.criticalMessage($localize(pd||(pd=Rv(["The AI chose an illegal move! This is an unexpected situation that we logged, we will try to solve this as soon as possible. In the meantime, consider that you won!"])))),Q5.logError("LocalGameWrapper","AI chose illegal move",{name:e.name,move:a.toString()})));case 4:case"end":return n.stop()}},n)}))()}},{key:"canTakeBack",value:function(){return this.gameComponent.rules.node.gameState.turn>0}},{key:"takeBack",value:function(){this.gameComponent.rules.node=this.gameComponent.rules.node.mother.get(),this.isAITurn()&&(this.gameComponent.rules.node=this.gameComponent.rules.node.mother.get()),this.gameComponent.updateBoard()}},{key:"isAITurn",value:function(){return this.getPlayingAI().isPresent()}},{key:"restartGame",value:function(){var e=this.gameComponent.rules.stateType.getInitialState();this.gameComponent.rules.node=new xre(e),this.gameComponent.updateBoard(),this.endGame=!1,this.winner=sB.empty(),this.proposeAIToPlay()}},{key:"getPlayerName",value:function(){return"human"}}]),n}(Cpe);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(sb(XE),sb(bN),sb($ee),sb(IS),sb(ore))},e.\u0275cmp=ey({type:e,selectors:[["app-local-game-wrapper"]],features:[zC],decls:7,vars:3,consts:function(){return[[1,"tile","is-ancestor"],[1,"tile","is-3","is-vertical","is-parent"],["class","tile is-child box has-text-centered","id","info",4,"ngIf"],["class","tile is-child box is-vcentered",4,"ngIf"],[1,"tile","is-parent","is-9","is-vcentered",3,"ngClass"],["id","board",1,"tile","is-child","box"],["id","info",1,"tile","is-child","box","has-text-centered"],["id","turnIndicator",1,"block"],[1,"subtitle"],$localize(gd||(gd=Rv(["Turn n\xb0",":INTERPOLATION:"])),"\ufffd0\ufffd"),["id","playerSelector",1,"columns"],[1,"column","is-6","is-vcentered"],[1,"select"],["id","playerZeroSelect",3,"ngModel","change","ngModelChange"],["selected","","value","human"],$localize(yd||(yd=Rv(["Human"]))),[3,"value",4,"ngFor","ngForOf"],["id","aiZeroDepthSelect",3,"ngModel","ngModelChange","change",4,"ngIf"],["id","scoreOne","class","block",4,"ngIf"],[1,"column","is-6"],["id","playerOneSelect",3,"ngModel","change","ngModelChange"],$localize(md||(md=Rv(["Human"]))),["id","aiOneDepthSelect",3,"ngModel","ngModelChange","change",4,"ngIf"],["id","scoreZero","class","block",4,"ngIf"],["class","block","id","gameResult",4,"ngIf"],[3,"value"],["id","aiZeroDepthSelect",3,"ngModel","ngModelChange","change"],["selected","","value","0"],$localize(kd||(kd=Rv(["Pick the level"]))),$localize(_d||(_d=Rv(["Level ",":INTERPOLATION:"])),"\ufffd0\ufffd"),["id","scoreOne",1,"block"],$localize(wd||(wd=Rv(["",":INTERPOLATION: points"])),"\ufffd0\ufffd"),["id","aiOneDepthSelect",3,"ngModel","ngModelChange","change"],$localize(Cd||(Cd=Rv(["Pick the level"]))),$localize(bd||(bd=Rv(["Level ",":INTERPOLATION:"])),"\ufffd0\ufffd"),["id","scoreZero",1,"block"],$localize(Ed||(Ed=Rv(["",":INTERPOLATION: points"])),"\ufffd0\ufffd"),["id","gameResult",1,"block"],[4,"ngIf"],["id","draw",4,"ngIf"],$localize(Sd||(Sd=Rv(["",":INTERPOLATION: won"])),"\ufffd0\ufffd"),["id","draw"],$localize(Pd||(Pd=Rv(["Draw"]))),[1,"tile","is-child","box","is-vcentered"],["id","passButton","class","button is-primary is-fullwidth mb-1",3,"click",4,"ngIf"],["id","takeBack","class","button is-fullwidth mb-1",3,"click",4,"ngIf"],["id","restartButton",1,"button","is-fullwidth",3,"click"],$localize(Od||(Od=Rv(["Start a new game"]))),[4,"ngFor","ngForOf"],["id","passButton",1,"button","is-primary","is-fullwidth","mb-1",3,"click"],$localize(Td||(Td=Rv(["Pass a turn"]))),["id","takeBack",1,"button","is-fullwidth","mb-1",3,"click"],$localize(Id||(Id=Rv(["Take back move"])))]},template:function(e,t){1&e&&(lb(0,"div",0),lb(1,"div",1),ab(2,eye,24,10,"div",2),ab(3,aye,6,3,"div",3),hb(),lb(4,"div",4),lb(5,"div",5),fb(6,"app-game-includer"),hb(),hb(),hb()),2&e&&(Pw(2),ub("ngIf",t.gameComponent),Pw(1),ub("ngIf",t.gameComponent),Pw(1),ub("ngClass",t.getBoardHighlight()))},directives:[NT,IT,_pe,tA,hx,Gx,nA,oA,AT],encapsulation:2,changeDetection:0}),e}(),sye=function(){var e=rp(function e(){tp(this,e)});return e.STEP_FINISHED=function(){return $localize(xd||(xd=Rv(["Step finished!"])))},e.INFORMATIONAL_STEP=function(){return $localize(Ad||(Ad=Rv(["This step is not expecting any move from your part."])))},e}();function uye(e,t){if(1&e&&(lb(0,"div",20),lb(1,"div",21),UE(2,22),hb(),lb(3,"div",23),Rb(4),hb(),hb()),2&e){var n=wb();Pw(4),Nb(n.currentReason.get())}}function cye(e,t){if(1&e){var n=pb();lb(0,"button",24),mb("click",function(){return $y(n),wb().retry()}),UE(1,25),hb()}}function lye(e,t){1&e&&(db(0),UE(1,30),vb())}function hye(e,t){1&e&&(db(0),UE(1,31),vb())}function fye(e,t){if(1&e&&ab(0,hye,2,0,"ng-container",27),2&e){wb();var n=ob(5),r=wb();ub("ngIf",r.stepFinished&&r.stepFinished[r.stepIndex])("ngIfElse",n)}}function dye(e,t){1&e&&(db(0),UE(1,32),vb())}function vye(e,t){if(1&e){var n=pb();lb(0,"button",26),mb("click",function(){return $y(n),wb().next()}),ab(1,lye,2,0,"ng-container",27),ab(2,fye,1,2,"ng-template",null,28,OP),ab(4,dye,2,0,"ng-template",null,29,OP),hb()}if(2&e){var r=ob(3),i=wb();Pw(1),ub("ngIf",i.steps[i.stepIndex]&&i.steps[i.stepIndex].isInformation())("ngIfElse",r)}}function pye(e,t){if(1&e){var n=pb();lb(0,"button",33),mb("click",function(){return $y(n),wb().start()}),UE(1,34),hb()}}function gye(e,t){if(1&e){var n=pb();lb(0,"button",35),mb("click",function(){return $y(n),wb().playLocally()}),UE(1,36),hb()}}function yye(e,t){if(1&e){var n=pb();lb(0,"button",37),mb("click",function(){return $y(n),wb().createGame()}),UE(1,38),hb()}}function mye(e,t){if(1&e){var n=pb();lb(0,"button",39),mb("click",function(){return $y(n),wb().showSolution()}),UE(1,40),hb()}}function kye(e,t){if(1&e&&(db(0),lb(1,"option",42),Rb(2),hb(),vb()),2&e){var n=wb(),r=n.index,i=n.$implicit;Pw(1),Cb("id","step_",r,""),ub("value",r),Pw(1),Nb(i.title)}}function _ye(e,t){1&e&&(db(0),Rb(1,"v "),vb())}function wye(e,t){1&e&&Rb(0,"x ")}function Cye(e,t){if(1&e&&(lb(0,"option",43),ab(1,_ye,2,0,"ng-container",27),ab(2,wye,1,0,"ng-template",null,44,OP),lb(4,"span",45),Rb(5),hb(),hb()),2&e){var n=ob(3),r=wb(),i=r.index,a=r.$implicit,o=wb();ub("value",i),Pw(1),ub("ngIf",o.stepFinished[i])("ngIfElse",n),Pw(3),Cb("id","step_",i,""),Pw(1),Nb(a.title)}}function bye(e,t){if(1&e&&(db(0),ab(1,kye,3,3,"ng-container",27),ab(2,Cye,6,5,"ng-template",null,41,OP),vb()),2&e){var n=t.index,r=ob(3),i=wb();Pw(1),ub("ngIf",n===i.stepIndex)("ngIfElse",r)}}var Eye=function(){var e=function(e){Gv(n,e);var t=$v(n);function n(e,r,i,a,o){var s;return tp(this,n),(s=t.call(this,e,r,a)).router=i,s.cdr=o,s.COMPLETED_TUTORIAL_MESSAGE=$localize(Rd||(Rd=Rv(["Congratulations, you completed the tutorial."]))),s.steps=[],s.successfulSteps=0,s.stepIndex=-1,s.currentMessage="",s.currentReason=sB.empty(),s.moveAttemptMade=!1,s.stepFinished=[],s.tutorialOver=!1,rB(n.VERBOSE,"TutorialGameWrapperComponent.constructor"),s}return rp(n,[{key:"getNumberOfSteps",value:function(){return this.steps.length}},{key:"getCurrentStepTitle",value:function(){return this.steps.length>0?this.steps[this.stepIndex].title:""}},{key:"ngAfterViewInit",value:function(){rB(n.VERBOSE,"TutorialGameWrapperComponent.ngAfterViewInit"),this.afterGameIncluderViewInit(),this.start()}},{key:"start",value:function(){this.startTutorial(this.gameComponent.tutorial)}},{key:"startTutorial",value:function(e){rB(n.VERBOSE,{tutorialGameWrapperComponent_startTutorial:{tutorial:e}}),this.steps=e,this.tutorialOver=!1,this.stepFinished=this.getCompletionArray(),this.successfulSteps=0,this.showStep(0)}},{key:"getCompletionArray",value:function(){return this.steps.map(function(){return!1})}},{key:"changeStep",value:function(e){this.showStep(Number.parseInt(e.target.value,10))}},{key:"showStep",value:function(e){rB(n.VERBOSE,"tutorialGameWrapperComponent.showStep("+e+")"),this.moveAttemptMade=!1,this.stepFinished[e]=!1,this.updateSuccessCount(),this.stepIndex=e;var t=this.steps[this.stepIndex];this.currentMessage=t.instruction,this.currentReason=sB.empty(),this.gameComponent.rules.node=new xre(t.state,sB.empty(),t.previousMove),this.gameComponent.updateBoard(),this.cdr.detectChanges()}},{key:"onLegalUserMove",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function r(){var i,a,o,s;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:rB(n.VERBOSE,{tutorialGameWrapper_onLegalUserMove:{move:e}}),i=t.steps[t.stepIndex],X5(t.gameComponent.rules.choose(e),"It should be impossible to call onLegalUserMove with an illegal move"),rB(n.VERBOSE,"tutorialGameWrapper.onLegalUserMove: legal move"),t.gameComponent.updateBoard(),t.moveAttemptMade=!0,i.isPredicate()?(a=t.gameComponent.rules.node.gameState,(o=nB.getNonNullable(i.predicate)(e,a)).isSuccess()?t.showStepSuccess(i.getSuccessMessage()):t.currentReason=sB.of(o.getReason())):i.isAnyMove()?(rB(n.VERBOSE,"tutorialGameWrapper.onLegalUserMove: awaited move!"),t.showStepSuccess(i.getSuccessMessage())):(X5(i.isMove(),"cannot reach here with a click step"),(s=i).acceptedMoves.some(function(t){return t.equals(e)})?(rB(n.VERBOSE,"tutorialGameWrapper.onLegalUserMove: awaited move!"),t.showStepSuccess(s.getSuccessMessage())):(rB(n.VERBOSE,"tutorialGameWrapper.onLegalUserMove: not the move that was awaited."),t.currentReason=sB.of(s.getFailureMessage()))),t.cdr.detectChanges();case 4:case"end":return r.stop()}},r)}))()}},{key:"retry",value:function(){rB(n.VERBOSE,"tutorialGameWrapper.retry"),this.moveAttemptMade=!1,this.showStep(this.stepIndex)}},{key:"onUserClick",value:function(e){var t=this;if(rB(n.VERBOSE,"tutorialGameWrapper.onUserClick("+e+")"),this.currentReason=sB.empty(),this.stepFinished[this.stepIndex]||this.moveAttemptMade)return K5.failure(sye.STEP_FINISHED());var r=this.steps[this.stepIndex];return r.isClick()?(this.gameComponent.updateBoard(),nB.getNonNullable(r.acceptedClicks).some(function(t){return t===e})?this.showStepSuccess(r.getSuccessMessage()):this.currentMessage=r.getFailureMessage(),K5.SUCCESS):r.isMove()||r.isPredicate()||r.isAnyMove()?(setTimeout(function(){t.cdr.detectChanges()},10),K5.SUCCESS):K5.failure(sye.INFORMATIONAL_STEP())}},{key:"onCancelMove",value:function(e){rB(n.VERBOSE,"tutorialGameWrapperComponent.onCancelMove("+e+")"),void 0!==e&&(this.currentReason=sB.of(e)),this.cdr.detectChanges()}},{key:"showStepSuccess",value:function(e){rB(n.VERBOSE,"tutorialGameWrapperComponent.showStepSuccess()"),this.currentMessage=e,this.stepFinished[this.stepIndex]=!0,this.updateSuccessCount()}},{key:"updateSuccessCount",value:function(){var e,t=0,n=Qv(this.stepFinished);try{for(n.s();!(e=n.n()).done;){e.value&&t++}}catch(r){n.e(r)}finally{n.f()}this.successfulSteps=t}},{key:"next",value:function(){if(this.steps[this.stepIndex].isInformation()&&(this.stepFinished[this.stepIndex]=!0,this.updateSuccessCount()),this.stepFinished.length===this.successfulSteps)this.currentMessage=this.COMPLETED_TUTORIAL_MESSAGE,this.tutorialOver=!0;else{for(var e=(this.stepIndex+1)%this.steps.length;!0===this.stepFinished[e];)e=(e+1)%this.steps.length;this.showStep(e)}}},{key:"showSolution",value:function(){var e=this;return tB(regeneratorRuntime.mark(function t(){var r,i,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:rB(n.VERBOSE,"tutorialGameWrapper.showSolution()"),X5((r=e.steps[e.stepIndex]).hasSolution(),"showSolution called on a step with no solution, this should not be reachable"),a=(i=r).getSolution(),e.showStep(e.stepIndex),e.gameComponent.rules.choose(a),e.gameComponent.updateBoard(),e.moveAttemptMade=!0,e.currentMessage=i.getSuccessMessage(),e.cdr.detectChanges();case 5:case"end":return t.stop()}},t)}))()}},{key:"playLocally",value:function(){var e=this;return tB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=nB.getNonNullable(e.actRoute.snapshot.paramMap.get("compo")),t.next=3,e.router.navigate(["/local",n]);case 3:case"end":return t.stop()}},t)}))()}},{key:"createGame",value:function(){var e=this;return tB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=nB.getNonNullable(e.actRoute.snapshot.paramMap.get("compo")),t.next=3,e.router.navigate(["/play",n]);case 3:case"end":return t.stop()}},t)}))()}},{key:"getPlayerName",value:function(){return""}}]),n}(Cpe);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(sb(XE),sb(bN),sb(qM),sb($ee),sb(IS))},e.\u0275cmp=ey({type:e,selectors:[["app-tutorial-game-wrapper"]],features:[zC],decls:22,vars:15,consts:function(){return[[1,"tile","is-ancestor"],[1,"tile","is-5","is-vertical","is-parent"],["id","infos",1,"tile","is-child","box"],[1,"progress","is-primary"],[1,"content","is-medium"],[1,"title"],["id","currentMessage",3,"innerHTML"],["class","message is-danger","role","alert",4,"ngIf"],[1,"block"],["id","retryButton","class","button mr-3",3,"click",4,"ngIf"],["id","nextButton","class","button is-primary mr-3 mb-1",3,"click",4,"ngIf"],["id","restartButton","class","button",3,"click",4,"ngIf"],["id","playLocallyButton","class","button",3,"click",4,"ngIf"],["id","playOnlineButton","class","button",3,"click",4,"ngIf"],["id","showSolutionButton","class","button",3,"click",4,"ngIf"],[1,"select"],["id","steps",3,"change"],[4,"ngFor","ngForOf"],[1,"tile","is-parent","is-7","is-vcentered",3,"ngClass"],["id","board",1,"tile","is-child","box"],["role","alert",1,"message","is-danger"],[1,"message-header"],$localize(Nd||(Nd=Rv(["Failure"]))),["id","currentReason",1,"message-body"],["id","retryButton",1,"button","mr-3",3,"click"],$localize(Md||(Md=Rv(["Try again"]))),["id","nextButton",1,"button","is-primary","mr-3","mb-1",3,"click"],[4,"ngIf","ngIfElse"],["notInfo",""],["notFinished",""],$localize(Dd||(Dd=Rv(["Ok"]))),$localize(Ld||(Ld=Rv(["Continue"]))),$localize(Fd||(Fd=Rv(["Skip"]))),["id","restartButton",1,"button",3,"click"],$localize(Bd||(Bd=Rv(["Try again"]))),["id","playLocallyButton",1,"button",3,"click"],$localize(Vd||(Vd=Rv(["Play locally"]))),["id","playOnlineButton",1,"button",3,"click"],$localize(Ud||(Ud=Rv(["Create an online game"]))),["id","showSolutionButton",1,"button",3,"click"],$localize(zd||(zd=Rv(["See solution"]))),["otherstep",""],["selected","",3,"id","value"],[3,"value"],["notdone",""],[3,"id"]]},template:function(e,t){1&e&&(lb(0,"div",0),lb(1,"div",1),lb(2,"div",2),fb(3,"progress",3),lb(4,"div",4),lb(5,"p",5),Rb(6),hb(),fb(7,"p",6),hb(),ab(8,uye,5,1,"div",7),lb(9,"div",8),ab(10,cye,2,0,"button",9),ab(11,vye,6,2,"button",10),ab(12,pye,2,0,"button",11),ab(13,gye,2,0,"button",12),ab(14,yye,2,0,"button",13),ab(15,mye,2,0,"button",14),lb(16,"div",15),lb(17,"select",16),mb("change",function(e){return t.changeStep(e)}),ab(18,bye,4,2,"ng-container",17),hb(),hb(),hb(),hb(),hb(),lb(19,"div",18),lb(20,"div",19),fb(21,"app-game-includer"),hb(),hb(),hb()),2&e&&(Pw(3),tb("value",t.successfulSteps)("max",t.getNumberOfSteps()),Pw(3),Lb("",t.getCurrentStepTitle()," [",t.stepIndex+1,"/",t.getNumberOfSteps(),"]"),Pw(1),ub("innerHTML",t.currentMessage,m_),Pw(1),ub("ngIf",t.currentReason.isPresent()),Pw(2),ub("ngIf",!1===t.tutorialOver&&(t.stepFinished&&!0===t.stepFinished[t.stepIndex]||t.moveAttemptMade)),Pw(1),ub("ngIf",!1===t.tutorialOver),Pw(1),ub("ngIf",t.tutorialOver),Pw(1),ub("ngIf",t.tutorialOver),Pw(1),ub("ngIf",t.tutorialOver),Pw(1),ub("ngIf",t.moveAttemptMade&&!1===t.stepFinished[t.stepIndex]),Pw(3),ub("ngForOf",t.steps),Pw(1),ub("ngClass",t.getBoardHighlight()))},directives:[NT,AT,IT,_pe,nA,oA],encapsulation:2,changeDetection:0}),e}();function Sye(e,t){if(1&e&&(lb(0,"div",35),lb(1,"div",36),UE(2,37),hb(),lb(3,"div",38),Rb(4),hb(),hb()),2&e){var n=wb();Pw(4),Nb(n.errorMessage)}}var Pye=function(){return["/login"]},Oye=function(){var e=function(){function e(t,n){tp(this,e),this.authService=t,this.router=n,this.faEye=vte,this.registrationForm=new Lx({email:new Dx,username:new Dx,password:new Dx})}return rp(e,[{key:"registerWithEmail",value:function(){var e=this;return tB(regeneratorRuntime.mark(function t(){var n,r,i,a,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.registrationForm.value.username,r=e.registrationForm.value.email,i=e.registrationForm.value.password,null!=n&&null!=r&&null!=i){t.next=5;break}e.errorMessage=$localize(Hd||(Hd=Rv(["There are missing fields in the registration form, please check that you filled in all fields."]))),t.next=21;break;case 5:return t.next=7,e.authService.doRegister(n,r,i);case 7:if(!(a=t.sent).isSuccess()){t.next=20;break}return t.next=11,e.authService.sendEmailVerification();case 11:if(!(o=t.sent).isSuccess()){t.next=17;break}return t.next=15,e.router.navigate(["/verify-account"]);case 15:t.next=18;break;case 17:e.errorMessage=o.getReason();case 18:t.next=21;break;case 20:e.errorMessage=a.getReason();case 21:case"end":return t.stop()}},t)}))()}},{key:"registerWithGoogle",value:function(){var e=this;return tB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.authService.doGoogleLogin();case 2:if(!(n=t.sent).isSuccess()){t.next=8;break}return t.next=6,e.router.navigate(["/verify-account"]);case 6:t.next=9;break;case 8:e.errorMessage=n.getReason();case 9:case"end":return t.stop()}},t)}))()}},{key:"getPasswordHelpClass",value:function(){var e=this.registrationForm.value.password;return null==e||""===e?"":e.length<6?"is-danger":"is-success"}},{key:"canRegister",value:function(){var e=this.registrationForm.value.password||"";return!(""===(this.registrationForm.value.email||"")||""===(this.registrationForm.value.username||"")||""===e||e.length<6)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(sb($ee),sb(qM))},e.\u0275cmp=ey({type:e,selectors:[["app-register"]],decls:56,vars:7,consts:function(){return[[1,"box"],[1,"title"],$localize(Gd||(Gd=Rv(["Registering"]))),[3,"formGroup"],[1,"field","is-horizontal"],[1,"field-label"],["for","email",1,"label"],$localize(qd||(qd=Rv(["Email"]))),[1,"field-body"],[1,"field"],[1,"control"],["id","email","formControlName","email","name","email","placeholder",$localize($d||($d=Rv(["Email"]))),"type","email","autofocus","","required","",1,"input"],[1,"help"],$localize(Wd||(Wd=Rv(["A confirmation email will be sent to validate your account."]))),["for","username",1,"label"],$localize(jd||(jd=Rv(["Username"]))),["id","username","formControlName","username","name","username","placeholder",$localize(Zd||(Zd=Rv(["Username"]))),"type","text","required","",1,"input"],["for","password",1,"label"],$localize(Yd||(Yd=Rv(["Password"]))),[1,"control","has-icons-right","is-expanded"],["id","password","formControlName","password","name","password","placeholder",$localize(Kd||(Kd=Rv(["Password"]))),"type","password","required","",1,"input"],[1,"icon","is-small","is-right"],["toggleVisibility","",1,"clickable-icon",3,"icon"],["id","passwordHelp",1,"help",3,"ngClass"],$localize(Jd||(Jd=Rv(["The password should be at least 6 characters long"]))),["id","registerButton",1,"button","is-primary","is-fullwidth",3,"disabled","click"],$localize(Qd||(Qd=Rv(["Register"]))),[1,"field-body","is-fullwidth"],["class","message is-danger is-fullwidth","role","alert",4,"ngIf"],["id","googleButton","type","submit",1,"button","is-fullwidth",3,"click"],$localize(Xd||(Xd=Rv(["Register with Google"]))),[1,"help","level-right"],$localize(ev||(ev=Rv(["Have an account?"]))),[3,"routerLink"],$localize(tv||(tv=Rv(["Log in"]))),["role","alert",1,"message","is-danger","is-fullwidth"],[1,"message-header"],$localize(nv||(nv=Rv(["Registration error"]))),["id","errorMessage",1,"message-body"]]},template:function(e,t){1&e&&(lb(0,"div",0),lb(1,"p",1),UE(2,2),hb(),lb(3,"form",3),lb(4,"div",4),lb(5,"div",5),lb(6,"label",6),UE(7,7),hb(),hb(),lb(8,"div",8),lb(9,"div",9),lb(10,"div",10),fb(11,"input",11),lb(12,"p",12),UE(13,13),hb(),hb(),hb(),hb(),hb(),lb(14,"div",4),lb(15,"div",5),lb(16,"label",14),UE(17,15),hb(),hb(),lb(18,"div",8),lb(19,"div",9),lb(20,"div",10),fb(21,"input",16),hb(),hb(),hb(),hb(),lb(22,"div",4),lb(23,"div",5),lb(24,"label",17),UE(25,18),hb(),hb(),lb(26,"div",8),lb(27,"div",9),lb(28,"div",19),fb(29,"input",20),lb(30,"span",21),fb(31,"fa-icon",22),hb(),lb(32,"p",23),UE(33,24),hb(),hb(),hb(),hb(),hb(),lb(34,"div",4),fb(35,"div",5),lb(36,"div",8),lb(37,"div",9),lb(38,"div",10),lb(39,"button",25),mb("click",function(){return t.registerWithEmail()}),UE(40,26),hb(),hb(),hb(),hb(),hb(),lb(41,"div",4),fb(42,"div",5),lb(43,"div",27),ab(44,Sye,5,1,"div",28),hb(),hb(),lb(45,"div",4),fb(46,"div",5),lb(47,"div",8),lb(48,"button",29),mb("click",function(){return t.registerWithGoogle()}),UE(49,30),hb(),hb(),hb(),lb(50,"p",31),db(51),UE(52,32),vb(),Rb(53,"\xa0 "),lb(54,"a",33),UE(55,34),hb(),hb(),hb(),hb()),2&e&&(Pw(3),ub("formGroup",t.registrationForm),Pw(28),ub("icon",t.faEye),Pw(1),ub("ngClass",t.getPasswordHelpClass()),Pw(7),ub("disabled",!t.canRegister()),Pw(5),ub("ngIf",t.errorMessage),Pw(10),ub("routerLink",eP(6,Pye)))},directives:[qx,fx,Kx,DI,hx,Qx,$ve,uA,Vne,Wve,IT,NT,jM],encapsulation:2}),e}(),Tye=function(){var e=function(){function e(t){tp(this,e),this.router=t}return rp(e,[{key:"pickGame",value:function(e){this.selectedGame=e}},{key:"playLocally",value:function(){var e=this;return tB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.router.navigate(["local/"+e.selectedGame]);case 2:case"end":return t.stop()}},t)}))()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(sb(qM))},e.\u0275cmp=ey({type:e,selectors:[["app-local-game-creation"]],decls:3,vars:1,consts:function(){return[[3,"pickGame"],["id","playLocally",1,"button","is-primary","is-fullwidth",3,"disabled","click"],$localize(rv||(rv=Rv(["Play offline"])))]},template:function(e,t){1&e&&(lb(0,"app-pick-game",0),mb("pickGame",function(e){return t.pickGame(e)}),hb(),lb(1,"button",1),mb("click",function(){return t.playLocally()}),UE(2,2),hb()),2&e&&(Pw(1),ub("disabled",!t.selectedGame))},directives:[Uve],encapsulation:2}),e}(),Iye=function(){var e=function(){function e(t){tp(this,e),this.router=t}return rp(e,[{key:"pickGame",value:function(e){this.selectedGame=e}},{key:"launchTutorial",value:function(){var e=this;return tB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.router.navigate(["/tutorial/",e.selectedGame]);case 2:case"end":return t.stop()}},t)}))()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(sb(qM))},e.\u0275cmp=ey({type:e,selectors:[["app-tutorial-game-creation"]],decls:3,vars:1,consts:function(){return[[3,"pickGame"],["id","launchTutorial",1,"button","is-primary","is-fullwidth",3,"disabled","click"],$localize(iv||(iv=Rv(["Learn the rules"])))]},template:function(e,t){1&e&&(lb(0,"app-pick-game",0),mb("pickGame",function(e){return t.pickGame(e)}),hb(),lb(1,"button",1),mb("click",function(){return t.launchTutorial()}),UE(2,2),hb()),2&e&&(Pw(1),ub("disabled",!t.selectedGame))},directives:[Uve],encapsulation:2}),e}(),xye=function(){var e=rp(function e(){tp(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=ey({type:e,selectors:[["app-next-game-loading"]],decls:2,vars:0,consts:function(){return[$localize(av||(av=Rv(["The replay game is loading, please wait, it should not take long."])))]},template:function(e,t){1&e&&(lb(0,"p"),UE(1,0),hb())},encapsulation:2}),e}(),Aye={production:!0,test:!1,root:"/",firebaseConfig:{apiKey:"AIzaSyAt5QHXLnm2Uf9X7VN6XPPiSaipoh3oRHo",authDomain:"firestore-c9d47.firebaseapp.com",databaseURL:"https://firestore-c9d47.firebaseio.com",projectId:"firestore-c9d47",storageBucket:"firestore-c9d47.appspot.com",messagingSenderId:"936588361631"},useEmulators:!1},Rye=function(){var e=function(){function e(t){tp(this,e),this.authService=t}return rp(e,[{key:"canActivate",value:function(){var e=this;return tB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise(function(t){var n;e.userSub=e.authService.getUserObs().subscribe((n=tB(regeneratorRuntime.mark(function n(r){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.evaluateUserPermission(r).then(t);case 2:case"end":return n.stop()}},n)})),function(e){return n.apply(this,arguments)}))}));case 1:case"end":return t.stop()}},t)}))()}},{key:"ngOnDestroy",value:function(){this.userSub.unsubscribe()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Pk($ee))},e.\u0275prov=Eg({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),Nye=function(){var e=function(e){Gv(n,e);var t=$v(n);function n(e,r){var i;return tp(this,n),(i=t.call(this,e)).router=r,i}return rp(n,[{key:"evaluateUserPermission",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",!1===e.isConnected()?t.router.parseUrl("/login"):!1!==e.verified||t.router.parseUrl("/verify-account"));case 1:case"end":return n.stop()}},n)}))()}}]),n}(Rye);return e.\u0275fac=function(t){return new(t||e)(Pk($ee),Pk(qM))},e.\u0275prov=Eg({token:e,factory:e.\u0275fac,providedIn:"root"}),e}();function Mye(e,t){1&e&&(lb(0,"p",20),UE(1,21),hb())}function Dye(e,t){if(1&e){var n=pb();lb(0,"div",7),lb(1,"p",8),UE(2,9),hb(),lb(3,"div",10),lb(4,"p",11),UE(5,12),hb(),lb(6,"button",13),mb("click",function(){return $y(n),wb().finalizeEmailVerification()}),UE(7,14),hb(),hb(),lb(8,"div",15),lb(9,"p",11),UE(10,16),hb(),lb(11,"button",17),mb("click",function(){return $y(n),wb().sendEmailVerification()}),UE(12,18),hb(),hb(),ab(13,Mye,2,0,"p",19),hb()}if(2&e){var r=wb();Pw(2),zE(r.emailAddress),HE(2),Pw(11),ub("ngIf",r.success)}}function Lye(e,t){if(1&e){var n=pb();lb(0,"div",24),lb(1,"div",8),UE(2,25),hb(),lb(3,"form",26),lb(4,"div",27),lb(5,"div",28),fb(6,"input",29),hb(),lb(7,"div",28),lb(8,"button",30),mb("click",function(){$y(n);var e=wb(2);return e.pickUsername(e.usernameForm.value)}),UE(9,31),hb(),hb(),hb(),hb(),hb()}if(2&e){var r=wb(2);Pw(3),ub("formGroup",r.usernameForm)}}var Fye=function(){return["/lobby"]};function Bye(e,t){1&e&&(lb(0,"div",32),BE(1,33),fb(2,"a",34),VE(),hb()),2&e&&(Pw(2),ub("routerLink",eP(1,Fye)))}function Vye(e,t){if(1&e&&(db(0),ab(1,Lye,10,1,"div",22),ab(2,Bye,3,2,"div",23),vb()),2&e){var n=wb();Pw(1),ub("ngIf",!n.success),Pw(1),ub("ngIf",n.success)}}function Uye(e,t){if(1&e&&(lb(0,"div",35),lb(1,"div",36),Rb(2),hb(),hb()),2&e){var n=wb();Pw(2),Nb(n.errorMessage)}}var zye=function(){var e=function(){function e(t,n){tp(this,e),this.authService=t,this.router=n,this.verificationType=null,this.success=!1,this.triedToFinalize=!1,this.usernameForm=new Lx({username:new Dx})}return rp(e,[{key:"ngOnInit",value:function(){var e=this;return tB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.userSub=e.authService.getUserObs().subscribe(function(){var t=tB(regeneratorRuntime.mark(function t(n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.emailAddress=n.email.get(),!n.username.isAbsent()){t.next=5;break}e.verificationType="enter-username",t.next=11;break;case 5:if(e.verificationType="send-email",!0===e.triedToFinalize&&!1===n.verified&&(e.errorMessage=$localize(ov||(ov=Rv(["You have not verified your email! Click on the link in the verification email."])))),t.t0=!0===n.verified,!t.t0){t.next=11;break}return t.next=11,e.router.navigate(["/lobby"]);case 11:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}());case 1:case"end":return t.stop()}},t)}))()}},{key:"pickUsername",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.authService.setUsername(e.username);case 2:(r=n.sent).isSuccess()?t.success=!0:t.errorMessage=r.getReason();case 4:case"end":return n.stop()}},n)}))()}},{key:"sendEmailVerification",value:function(){var e=this;return tB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.authService.sendEmailVerification();case 2:(n=t.sent).isSuccess()?e.success=!0:e.errorMessage=n.getReason();case 4:case"end":return t.stop()}},t)}))()}},{key:"finalizeEmailVerification",value:function(){var e=this;return tB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.triedToFinalize=!0,t.next=3,e.authService.reloadUser();case 3:window.open(window.location.href,"_self");case 4:case"end":return t.stop()}},t)}))()}},{key:"ngOnDestroy",value:function(){null!=this.userSub&&null!=this.userSub.unsubscribe&&this.userSub.unsubscribe()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(sb($ee),sb(qM))},e.\u0275cmp=ey({type:e,selectors:[["app-verify-account"]],decls:7,vars:3,consts:function(){return[[1,"box"],[1,"message","is-info"],[1,"message-header"],$localize(sv||(sv=Rv(["Account verification"]))),["class","message-body","id","verificationEmail",4,"ngIf"],[4,"ngIf"],["class","message is-danger",4,"ngIf"],["id","verificationEmail",1,"message-body"],[1,"block"],$localize(uv||(uv=Rv(["In order to finalize your account, you must click on the link that you should have received on your email address (",":INTERPOLATION:). The email could be in your spam folder."])),"\ufffd0\ufffd"),[1,"block","level-left"],[1,"level-item"],$localize(cv||(cv=Rv(["Once you have verified your email, click on the following button:"]))),["id","finalizeVerification",1,"button","is-primary","level-item","is-small",3,"click"],$localize(lv||(lv=Rv(["Finalize email verification"]))),[1,"level-left"],$localize(hv||(hv=Rv(["If you have not received the verification email, click on the following button:"]))),["id","sendEmail",1,"button","is-warning","level-item","is-small",3,"click"],$localize(fv||(fv=Rv(["Send verification email again"]))),["id","success","class","help is-success",4,"ngIf"],["id","success",1,"help","is-success"],$localize(dv||(dv=Rv(["The email has been sent"]))),["id","askUsername","class","message-body",4,"ngIf"],["id","success","class","message-body",4,"ngIf"],["id","askUsername",1,"message-body"],$localize(vv||(vv=Rv(["In order to finalize your account, you must choose a username."]))),[3,"formGroup"],[1,"field","has-addons"],[1,"control"],["id","username","type","text","placeholder",$localize(pv||(pv=Rv(["Username"]))),"name","username","required","","formControlName","username",1,"input"],["id","pickUsername",1,"button","is-info",3,"click"],$localize(gv||(gv=Rv(["Pick username"]))),["id","success",1,"message-body"],$localize(yv||(yv=Rv(["Your account has now been finalized, you can go back to the ",":START_LINK:list of games",":CLOSE_LINK:."])),"\ufffd#2\ufffd","\ufffd/#2\ufffd"),[3,"routerLink"],[1,"message","is-danger"],["id","errorMessage",1,"message-body"]]},template:function(e,t){1&e&&(lb(0,"div",0),lb(1,"div",1),lb(2,"div",2),UE(3,3),hb(),ab(4,Dye,14,2,"div",4),ab(5,Vye,3,2,"ng-container",5),hb(),ab(6,Uye,3,1,"div",6),hb()),2&e&&(Pw(4),ub("ngIf","send-email"===t.verificationType),Pw(1),ub("ngIf","enter-username"===t.verificationType),Pw(1),ub("ngIf",t.errorMessage))},directives:[NT,qx,fx,Kx,DI,uA,hx,Qx,jM],encapsulation:2}),e}(),Hye=function(){var e=function(e){Gv(n,e);var t=$v(n);function n(e,r){var i;return tp(this,n),(i=t.call(this,e)).router=r,i}return rp(n,[{key:"evaluateUserPermission",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",!1===e.isConnected()?t.router.parseUrl("/login"):!e.verified||t.router.parseUrl("/"));case 1:case"end":return n.stop()}},n)}))()}}]),n}(Rye);return e.\u0275fac=function(t){return new(t||e)(Pk($ee),Pk(qM))},e.\u0275prov=Eg({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),Gye=function(){var e=function(e){Gv(n,e);var t=$v(n);function n(e,r){var i;return tp(this,n),(i=t.call(this,e)).router=r,i}return rp(n,[{key:"evaluateUserPermission",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",!1===e.isConnected()||t.router.parseUrl("/"));case 1:case"end":return n.stop()}},n)}))()}}]),n}(Rye);return e.\u0275fac=function(t){return new(t||e)(Pk($ee),Pk(qM))},e.\u0275prov=Eg({token:e,factory:e.\u0275fac,providedIn:"root"}),e}();function qye(e,t){1&e&&(lb(0,"p",12),UE(1,13),hb())}function $ye(e,t){if(1&e&&(lb(0,"div",14),lb(1,"div",15),UE(2,16),hb(),lb(3,"div",17),Rb(4),hb(),hb()),2&e){var n=wb();Pw(4),Nb(n.errorMessage.get())}}var Wye=function(){return{standalone:!0}},jye=function(){var e=function(){function e(t){tp(this,e),this.authService=t,this.success=!1,this.errorMessage=sB.empty(),this.email=""}return rp(e,[{key:"resetPassword",value:function(){var e=this;return tB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return X5(""!==e.email,"No email was entered, but it should not be possible to submit the form then!"),e.errorMessage=sB.empty(),e.success=!1,t.next=3,e.authService.sendPasswordResetEmail(e.email);case 3:(n=t.sent).isSuccess()?e.success=!0:e.errorMessage=sB.of(n.getReason());case 5:case"end":return t.stop()}},t)}))()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(sb($ee))},e.\u0275cmp=ey({type:e,selectors:[["app-reset-password"]],decls:12,vars:6,consts:function(){return[[1,"box"],[1,"title"],$localize(mv||(mv=Rv(["Password reset"]))),[1,"field"],[1,"control"],["id","email","name","email","placeholder",$localize(kv||(kv=Rv(["Email"]))),"type","email","autofocus","","required","",1,"input",3,"ngModel","ngModelOptions","ngModelChange"],[1,"help"],$localize(_v||(_v=Rv(["An email will be sent with instruction to reset your password."]))),["id","successMessage","class","help is-success",4,"ngIf"],["id","resetPasswordButton",1,"button","is-primary","is-fullwidth","block",3,"disabled","click"],$localize(wv||(wv=Rv(["Reset password"]))),["class","message is-danger is-fullwidth","role","alert",4,"ngIf"],["id","successMessage",1,"help","is-success"],$localize(Cv||(Cv=Rv(["The email has been sent, please follow the instructions from that email."]))),["role","alert",1,"message","is-danger","is-fullwidth"],[1,"message-header"],$localize(bv||(bv=Rv(["Error"]))),["id","errorMessage",1,"message-body"]]},template:function(e,t){1&e&&(lb(0,"div",0),lb(1,"p",1),UE(2,2),hb(),lb(3,"div",3),lb(4,"div",4),lb(5,"input",5),mb("ngModelChange",function(e){return t.email=e}),hb(),lb(6,"p",6),UE(7,7),hb(),ab(8,qye,2,0,"p",8),hb(),hb(),lb(9,"button",9),mb("click",function(){return t.resetPassword()}),UE(10,10),hb(),ab(11,$ye,5,1,"div",11),hb()),2&e&&(Pw(5),ub("ngModel",t.email)("ngModelOptions",eP(5,Wye)),Pw(3),ub("ngIf",t.success),Pw(1),ub("disabled",""===t.email),Pw(2),ub("ngIf",t.errorMessage.isPresent()))},directives:[DI,$ve,uA,hx,Gx,NT],encapsulation:2}),e}();function Zye(e,t){if(1&e&&(lb(0,"option",13),Rb(1),hb()),2&e){var n=t.$implicit,r=wb();ub("value",n.value)("selected",n.value===r.currentTheme),Pw(1),Mb(" ",n.name," ")}}function Yye(e,t){if(1&e&&(lb(0,"option",13),Rb(1),hb()),2&e){var n=t.$implicit,r=wb();ub("value",n.value)("selected",n.value===r.currentLanguage),Pw(1),Mb(" ",n.name," ")}}var Kye=function(){var e=function(){function e(t,n){tp(this,e),this.userSettingsService=t,this.availableLanguages=[{value:"fr",name:"Fran\xe7ais"},{value:"en",name:"English"}],this.availableThemes=[{value:"light",name:$localize(Ev||(Ev=Rv(["Light"])))},{value:"dark",name:$localize(Sv||(Sv=Rv(["Dark"])))}],this.currentTheme=n.getTheme(),this.currentLanguage=this.userSettingsService.getLanguage()}return rp(e,[{key:"changeLanguage",value:function(e){this.userSettingsService.changeLanguage(e.target.value),this.reload()}},{key:"changeTheme",value:function(e){this.userSettingsService.changeTheme(e.target.value),this.reload()}},{key:"reload",value:function(){window.open(window.location.href,"_self")}}]),e}();return e.\u0275fac=function(t){return new(t||e)(sb(cte),sb(lte))},e.\u0275cmp=ey({type:e,selectors:[["app-settings"]],decls:17,vars:2,consts:function(){return[[1,"box"],[1,"title"],$localize(Pv||(Pv=Rv(["User settings"]))),[1,"field"],["for","theme",1,"label"],$localize(Ov||(Ov=Rv(["Theme"]))),[1,"control"],[1,"select"],["id","theme",3,"change"],[3,"value","selected",4,"ngFor","ngForOf"],["for","language",1,"label"],$localize(Tv||(Tv=Rv(["Language"]))),["id","language",3,"change"],[3,"value","selected"]]},template:function(e,t){1&e&&(lb(0,"div",0),lb(1,"p",1),UE(2,2),hb(),lb(3,"div",3),lb(4,"label",4),UE(5,5),hb(),lb(6,"div",6),lb(7,"div",7),lb(8,"select",8),mb("change",function(e){return t.changeTheme(e)}),ab(9,Zye,2,3,"option",9),hb(),hb(),hb(),hb(),lb(10,"div",3),lb(11,"label",10),UE(12,11),hb(),lb(13,"div",6),lb(14,"div",7),lb(15,"select",12),mb("change",function(e){return t.changeLanguage(e)}),ab(16,Yye,2,3,"option",9),hb(),hb(),hb(),hb(),hb()),2&e&&(Pw(9),ub("ngForOf",t.availableThemes),Pw(7),ub("ngForOf",t.availableLanguages))},directives:[AT,nA,oA],encapsulation:2}),e}(),Jye=function(){var e=rp(function e(){tp(this,e)});return e.ALREADY_INGAME=function(){return $localize(Iv||(Iv=Rv(["You are already in a game. Finish it or cancel it first."])))},e}(),Qye=function(){var e=function(){function e(t,n,r,i,a,o){tp(this,e),this.route=t,this.router=n,this.authenticationService=r,this.messageDisplayer=i,this.partDAO=a,this.gameService=o}return rp(e,[{key:"ngOnInit",value:function(){var e=this;return tB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.createGameAndRedirectOrShowError(e.extractGameFromURL());case 2:case"end":return t.stop()}},t)}))()}},{key:"extractGameFromURL",value:function(){return nB.getNonNullable(this.route.snapshot.paramMap.get("compo"))}},{key:"createGameAndRedirectOrShowError",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function n(){var r,i,a,o;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return X5((r=t.authenticationService.user.get()).isConnected(),"User must be connected and have a username to reach this page"),i=r.username.get(),n.next=5,t.canCreateOnlineGame(i);case 5:if(!n.sent){n.next=13;break}return a=r.toMinimalUser(),n.next=9,t.gameService.createPartJoinerAndChat(a,e);case 9:return o=n.sent,n.next=12,t.router.navigate(["/play",e,o]);case 12:return n.abrupt("return",!0);case 13:return t.messageDisplayer.infoMessage(Jye.ALREADY_INGAME()),n.next=16,t.router.navigate(["/lobby"]);case 16:return n.abrupt("return",!1);case 17:case"end":return n.stop()}},n)}))()}},{key:"canCreateOnlineGame",value:function(e){var t=this;return tB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.t0=!1,n.next=3,t.partDAO.userHasActivePart(e);case 3:return n.t1=n.sent,n.abrupt("return",n.t0===n.t1);case 5:case"end":return n.stop()}},n)}))()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(sb(bN),sb(qM),sb($ee),sb(ore),sb(n6),sb(ste))},e.\u0275cmp=ey({type:e,selectors:[["app-online-game-creation"]],decls:2,vars:0,consts:function(){return[$localize(xv||(xv=Rv(["Creating online game, please wait, it should not take long."])))]},template:function(e,t){1&e&&(lb(0,"p"),UE(1,0),hb())},encapsulation:2}),e}();!function(e,t,n){!function(e,t,n){"string"!=typeof t&&(n=t,t=e[qb.LocaleId]),t=t.toLowerCase().replace(/_/g,"-"),Ub[t]=e,n&&(Ub[t][qb.ExtraData]=n)}(e,void 0,void 0)}(XF());var Xye=[{path:"login",component:Kve},{path:"lobby",component:ype,canActivate:[Nye]},{path:"settings",component:Kye},{path:"register",component:Oye,canActivate:[Gye]},{path:"reset-password",component:jye,canActivate:[Gye]},{path:"notFound",component:mpe},{path:"nextGameLoading",component:xye,canActivate:[Nye]},{path:"verify-account",component:zye,canActivate:[Hye]},{path:"play",component:Qve,canActivate:[Nye]},{path:"play/:compo",component:Qye,canActivate:[Nye]},{path:"play/:compo/:id",component:zge,canActivate:[Nye]},{path:"local",component:Tye},{path:"local/:compo",component:oye},{path:"tutorial",component:Iye},{path:"tutorial/:compo",component:Eye},{path:"",component:qve},{path:"**",component:qve}],eme=function(){function e(){tp(this,e)}return rp(e,null,[{key:"app",value:function(){return function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return{ngModule:vG,providers:[{provide:lG,useFactory:dG(e),multi:!0,deps:[YP,VC,tG].concat(n)}]}}(function(){return Aye.useEmulators&&(Aye.firebaseConfig.databaseURL="http://localhost:9000?ns=default"),pG(Aye.firebaseConfig)})}},{key:"firestore",value:function(){return function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return{ngModule:x5,providers:[{provide:P5,useFactory:O5(e),multi:!0,deps:[YP,VC,tG,cG,[new Mk,sj],[new Mk,ZG]].concat(n)}]}}(function(){var e=B5(),t=e.toJSON().settings.host;return Aye.useEmulators&&"localhost:8080"!==t&&N5(e,"localhost",8080),e})}},{key:"database",value:function(){return function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return{ngModule:Lee,providers:[{provide:Ree,useFactory:Nee(e),multi:!0,deps:[YP,VC,tG,cG,[new Mk,sj],[new Mk,ZG]].concat(n)}]}}(function(){var e=Bee();return Aye.useEmulators&&!1===e._instanceStarted&&Fee(e,"localhost",9e3),e})}},{key:"auth",value:function(){return function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return{ngModule:dj,providers:[{provide:uj,useFactory:cj(e),multi:!0,deps:[YP,VC,tG,cG,[new Mk,ZG]].concat(n)}]}}(function(){var e=gj();return Aye.useEmulators&&null==e.config.emulator&&vj(e,"http://localhost:9099",{disableWarnings:!0}),e})}}]),e}(),tme=function(){var e=rp(function e(){tp(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=iy({type:e,bootstrap:[Qne]}),e.\u0275inj=Sg({providers:[$ee,ste,ote,c6,a6,n6,lte,{provide:FP,useValue:ute.getLocale()}],imports:[[eme.app(),eme.firestore(),eme.auth(),eme.database(),wI,JA,aD.forRoot(Xye,{useHash:!1}),dA,fA,JF,Une]]}),e}();"undefined"!=typeof window&&window,"undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,"undefined"!=typeof global&&global;var nme=function(){function e(t){tp(this,e),this.digits=t}return rp(e,[{key:"clone",value:function(){return new e(this.digits.slice())}},{key:"add",value:function(e){var t=this.clone();return t.addToSelf(e),t}},{key:"addToSelf",value:function(e){for(var t=Math.max(this.digits.length,e.digits.length),n=0,r=0;r<t;r++){var i=n;r<this.digits.length&&(i+=this.digits[r]),r<e.digits.length&&(i+=e.digits[r]),i>=10?(this.digits[r]=i-10,n=1):(this.digits[r]=i,n=0)}n>0&&(this.digits[t]=1)}},{key:"toString",value:function(){for(var e="",t=this.digits.length-1;t>=0;t--)e+=this.digits[t];return e}}],[{key:"zero",value:function(){return new e([0])}},{key:"one",value:function(){return new e([1])}}]),e}(),rme=function(){function e(t){tp(this,e),this.powerOfTwos=[t]}return rp(e,[{key:"getValue",value:function(){return this.powerOfTwos[0]}},{key:"multiplyBy",value:function(e){var t=nme.zero();return this.multiplyByAndAddTo(e,t),t}},{key:"multiplyByAndAddTo",value:function(e,t){for(var n=0;0!==e;e>>>=1,n++)if(1&e){var r=this.getMultipliedByPowerOfTwo(n);t.addToSelf(r)}}},{key:"getMultipliedByPowerOfTwo",value:function(e){for(var t=this.powerOfTwos.length;t<=e;t++){var n=this.powerOfTwos[t-1];this.powerOfTwos[t]=n.add(n)}return this.powerOfTwos[e]}}]),e}(),ime=function(){function e(t){tp(this,e),this.base=t,this.exponents=[new rme(nme.one())]}return rp(e,[{key:"toThePowerOf",value:function(e){for(var t=this.exponents.length;t<=e;t++){var n=this.exponents[t-1].multiplyBy(this.base);this.exponents[t]=new rme(n)}return this.exponents[e]}}]),e}();function ame(e){var t=function(e){for(var t=[],n=0;n<e.length;n++){var r=e.charCodeAt(n);if(r>=55296&&r<=56319&&e.length>n+1){var i=e.charCodeAt(n+1);i>=56320&&i<=57343&&(n++,r=(r-55296<<10)+i-56320+65536)}r<=127?t.push(r):r<=2047?t.push(r>>6&31|192,63&r|128):r<=65535?t.push(r>>12|224,r>>6&63|128,63&r|128):r<=2097151&&t.push(r>>18&7|240,r>>12&63|128,r>>6&63|128,63&r|128)}return t}(e),n=ome(t,0),r=ome(t,102072);return 0==n&&(0==r||1==r)&&(n^=319790063,r^=-1801410264),[n,r]}function ome(e,t){var n,r=2654435769,i=2654435769,a=e.length;for(n=0;n+12<=a;n+=12){var o=sme(r=cme(r,dme(e,n,ume.Little)),i=cme(i,dme(e,n+4,ume.Little)),t=cme(t,dme(e,n+8,ume.Little)));r=o[0],i=o[1],t=o[2]}return r=cme(r,dme(e,n,ume.Little)),i=cme(i,dme(e,n+4,ume.Little)),t=cme(t,a),sme(r,i,t=cme(t,dme(e,n+8,ume.Little)<<8))[2]}function sme(e,t,n){return e=hme(e,t),e=hme(e,n),e^=n>>>13,t=hme(t,n),t=hme(t,e),t^=e<<8,n=hme(n,e),n=hme(n,t),n^=t>>>13,e=hme(e,t),e=hme(e,n),e^=n>>>12,t=hme(t,n),t=hme(t,e),t^=e<<16,n=hme(n,e),n=hme(n,t),n^=t>>>5,e=hme(e,t),e=hme(e,n),e^=n>>>3,t=hme(t,n),t=hme(t,e),t^=e<<10,n=hme(n,e),n=hme(n,t),[e,t,n^=t>>>15]}var ume=((ume=ume||{})[ume.Little=0]="Little",ume[ume.Big=1]="Big",ume);function cme(e,t){return lme(e,t)[1]}function lme(e,t){var n=(65535&e)+(65535&t),r=(e>>>16)+(t>>>16)+(n>>>16);return[r>>>16,r<<16|65535&n]}function hme(e,t){var n=(65535&e)-(65535&t);return(e>>16)-(t>>16)+(n>>16)<<16|65535&n}function fme(e,t){return t>=e.length?0:e[t]}function dme(e,t,n){var r=0;if(n===ume.Big)for(var i=0;i<4;i++)r+=fme(e,t+i)<<24-8*i;else for(var a=0;a<4;a++)r+=fme(e,t+a)<<8*a;return r}var vme=new ime(256);function pme(e,t){if(":"!==t.charAt(0))return{text:e};var n=function(e,t){for(var n=1,r=1;n<e.length;n++,r++)if("\\"===t[r])r++;else if(":"===e[n])return n;throw new Error('Unterminated $localize metadata block in "'.concat(t,'".'))}(e,t);return{block:e.substring(1,n),text:e.substring(n+1)}}function gme(e){return 1===e?"PH":"PH_"+(e-1)}Object.keys({useClass:null}),Object.keys({useFactory:null}),Object.keys({useValue:null}),Object.keys({useExisting:null});var yme=function(e){Gv(n,e);var t=$v(n);function n(e){var r;return tp(this,n),(r=t.call(this,"No translation found for ".concat(kme(e),"."))).parsedMessage=e,r.type="MissingTranslationError",r}return rp(n)}(Vv(Error));function mme(e,t){return Object.defineProperty(e,"raw",{value:t}),e}function kme(e){var t=e.meaning&&' - "'.concat(e.meaning,'"'),n=e.legacyIds&&e.legacyIds.length>0?" [".concat(e.legacyIds.map(function(e){return'"'.concat(e,'"')}).join(", "),"]"):"";return'"'.concat(e.id,'"').concat(n,' ("').concat(e.text,'"').concat(t,")")}function _me(e,t){try{return function(e,t,n){var r=function(e,t,n,r){for(var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],a={},o={},s=function(e,t){var n=pme(e,t),r=n.text,i=n.block;if(void 0===i)return{text:r};var a=Av(i.split("\u241f")),o=a[0],s=a.slice(1),u=Lv(o.split("@@",2),2),c=u[0],l=u[1],h=Lv(c.split("|",2),2),f=h[0],d=h[1];return void 0===d&&(d=f,f=void 0),""===d&&(d=void 0),{text:r,meaning:f,description:d,customId:l,legacyIds:s}}(e[0],e.raw[0]),u=[s.text],c=[],l=s.text,h=1;h<e.length;h++){var f=pme(e[h],e.raw[h]),d=f.text,v=f.block,p=void 0===v?gme(h):v;l+="{$".concat(p,"}").concat(d),void 0!==t&&(a[p]=t[h-1],o[p]=i[h-1]),c.push(p),u.push(d)}var g=s.customId||function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=ame(e);if(t){var r=ame(t);n=function(e,t){var n=e[0],r=t[0],i=lme(e[1],t[1]),a=i[0],o=i[1];return[cme(cme(n,r),a),o]}(function(e,t){var n=e[0],r=e[1];return[n<<1|r>>>31,r<<1|n>>>31]}(n),r)}return function(e,t){var n=vme.toThePowerOf(0).multiplyBy(t);return vme.toThePowerOf(4).multiplyByAndAddTo(e,n),n.toString()}(2147483647&n[0],n[1])}(l,s.meaning||""),y=s.legacyIds?s.legacyIds.filter(function(e){return e!==g}):[];return{id:g,legacyIds:y,substitutions:a,substitutionLocations:o,text:l,customId:s.customId,meaning:s.meaning||"",description:s.description||"",messageParts:u,messagePartLocations:r,placeholderNames:c,location:n}}(t,n),i=e[r.id];if(void 0!==r.legacyIds)for(var a=0;a<r.legacyIds.length&&void 0===i;a++)i=e[r.legacyIds[a]];if(void 0===i)throw new yme(r);return[i.messageParts,i.placeholderNames.map(function(e){if(r.substitutions.hasOwnProperty(e))return r.substitutions[e];throw new Error("There is a placeholder name mismatch with the translation provided for the message ".concat(kme(r),".\nThe translation contains a placeholder with name ").concat(e,", which does not exist in the message."))})]}($localize.TRANSLATIONS,e,t)}catch(n){return console.warn(n.message),[e,t]}}function wme(){Aye.production&&function(){if(sO)throw new Error("Cannot enable prod mode after platform setup.");oO=!1}(),kI().bootstrapModule(tme).catch(function(e){return console.error(e)})}var Cme=ute.getLocale();"en"!==Cme?fetch(Aye.root+"assets/"+Cme+".json").then(function(e){return e.ok?e.json():{locale:"en",translations:{}}}).then(function(e){(function(e){$localize.translate||($localize.translate=_me),$localize.TRANSLATIONS||($localize.TRANSLATIONS={}),Object.keys(e).forEach(function(t){$localize.TRANSLATIONS[t]=function(e){for(var t=e.split(/{\$([^}]*)}/),n=[t[0]],r=[],i=1;i<t.length-1;i+=2)r.push(t[i]),n.push("".concat(t[i+1]));var a=n.map(function(e){return":"===e.charAt(0)?"\\"+e:e});return{text:e,messageParts:mme(n,a),placeholderNames:r}}(e[t])})})(e.translations),$localize.locale=e.locale,wme()}).catch(function(e){console.log(e)}):wme()}},function(e){e(e.s=9259)}])}();