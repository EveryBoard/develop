(self.webpackChunkeveryboard=self.webpackChunkeveryboard||[]).push([[179],{2052:(zu,G0,So)=>{"use strict";function Cn(r){return"function"==typeof r}function Po(r){const t=r(n=>{Error.call(n),n.stack=(new Error).stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}const s3=Po(r=>function(t){r(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((n,i)=>`${i+1}) ${n.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t});function o3(r,e){if(r){const t=r.indexOf(e);0<=t&&r.splice(t,1)}}class yn{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;const{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(const s of t)s.remove(this);else t.remove(this);const{initialTeardown:n}=this;if(Cn(n))try{n()}catch(s){e=s instanceof s3?s.errors:[s]}const{_finalizers:i}=this;if(i){this._finalizers=null;for(const s of i)try{c3(s)}catch(o){e=e??[],o instanceof s3?e=[...e,...o.errors]:e.push(o)}}if(e)throw new s3(e)}}add(e){var t;if(e&&e!==this)if(this.closed)c3(e);else{if(e instanceof yn){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=null!==(t=this._finalizers)&&void 0!==t?t:[]).push(e)}}_hasParent(e){const{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){const{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){const{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&o3(t,e)}remove(e){const{_finalizers:t}=this;t&&o3(t,e),e instanceof yn&&e._removeParent(this)}}yn.EMPTY=(()=>{const r=new yn;return r.closed=!0,r})();const Wl=yn.EMPTY;function a3(r){return r instanceof yn||r&&"closed"in r&&Cn(r.remove)&&Cn(r.add)&&Cn(r.unsubscribe)}function c3(r){Cn(r)?r():r.unsubscribe()}const Ja={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},S4={setTimeout(r,e,...t){const{delegate:n}=S4;return n?.setTimeout?n.setTimeout(r,e,...t):setTimeout(r,e,...t)},clearTimeout(r){const{delegate:e}=S4;return(e?.clearTimeout||clearTimeout)(r)},delegate:void 0};function ql(r){S4.setTimeout(()=>{const{onUnhandledError:e}=Ja;if(!e)throw r;e(r)})}function Es(){}const To=jl("C",void 0,void 0);function jl(r,e,t){return{kind:r,value:e,error:t}}let ua=null;function ht(r){if(Ja.useDeprecatedSynchronousErrorHandling){const e=!ua;if(e&&(ua={errorThrown:!1,error:null}),r(),e){const{errorThrown:t,error:n}=ua;if(ua=null,t)throw n}}else r()}class zt extends yn{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,a3(e)&&e.add(this)):this.destination=Vu}static create(e,t,n){return new Mi(e,t,n)}next(e){this.isStopped?Hu(function Du(r){return jl("N",r,void 0)}(e),this):this._next(e)}error(e){this.isStopped?Hu(function B0(r){return jl("E",void 0,r)}(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?Hu(To,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const xn=Function.prototype.bind;function xr(r,e){return xn.call(r,e)}class l3{constructor(e){this.partialObserver=e}next(e){const{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(n){Y2(n)}}error(e){const{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(n){Y2(n)}else Y2(e)}complete(){const{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){Y2(t)}}}class Mi extends zt{constructor(e,t,n){let i;if(super(),Cn(e)||!e)i={next:e??void 0,error:t??void 0,complete:n??void 0};else{let s;this&&Ja.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&xr(e.next,s),error:e.error&&xr(e.error,s),complete:e.complete&&xr(e.complete,s)}):i=e}this.destination=new l3(i)}}function Y2(r){Ja.useDeprecatedSynchronousErrorHandling?function st(r){Ja.useDeprecatedSynchronousErrorHandling&&ua&&(ua.errorThrown=!0,ua.error=r)}(r):ql(r)}function Hu(r,e){const{onStoppedNotification:t}=Ja;t&&S4.setTimeout(()=>t(r,e))}const Vu={closed:!0,next:Es,error:function Zl(r){throw r},complete:Es},Fu="function"==typeof Symbol&&Symbol.observable||"@@observable";function ec(r){return r}function rh(r){return 0===r.length?ec:1===r.length?r[0]:function(t){return r.reduce((n,i)=>i(n),t)}}let b1=(()=>{class r{constructor(t){t&&(this._subscribe=t)}lift(t){const n=new r;return n.source=this,n.operator=t,n}subscribe(t,n,i){const s=function ey(r){return r&&r instanceof zt||function JC(r){return r&&Cn(r.next)&&Cn(r.error)&&Cn(r.complete)}(r)&&a3(r)}(t)?t:new Mi(t,n,i);return ht(()=>{const{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(t){try{return this._subscribe(t)}catch(n){t.error(n)}}forEach(t,n){return new(n=ih(n))((i,s)=>{const o=new Mi({next:a=>{try{t(a)}catch(c){s(c),o.unsubscribe()}},error:s,complete:i});this.subscribe(o)})}_subscribe(t){var n;return null===(n=this.source)||void 0===n?void 0:n.subscribe(t)}[Fu](){return this}pipe(...t){return rh(t)(this)}toPromise(t){return new(t=ih(t))((n,i)=>{let s;this.subscribe(o=>s=o,o=>i(o),()=>n(s))})}}return r.create=e=>new r(e),r})();function ih(r){var e;return null!==(e=r??Ja.Promise)&&void 0!==e?e:Promise}const ty=Po(r=>function(){r(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let Ss=(()=>{class r extends b1{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){const n=new sh(this,this);return n.operator=t,n}_throwIfClosed(){if(this.closed)throw new ty}next(t){ht(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const n of this.currentObservers)n.next(t)}})}error(t){ht(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;const{observers:n}=this;for(;n.length;)n.shift().error(t)}})}complete(){ht(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return(null===(t=this.observers)||void 0===t?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){const{hasError:n,isStopped:i,observers:s}=this;return n||i?Wl:(this.currentObservers=null,s.push(t),new yn(()=>{this.currentObservers=null,o3(s,t)}))}_checkFinalizedStatuses(t){const{hasError:n,thrownError:i,isStopped:s}=this;n?t.error(i):s&&t.complete()}asObservable(){const t=new b1;return t.source=this,t}}return r.create=(e,t)=>new sh(e,t),r})();class sh extends Ss{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===n||n.call(t,e)}error(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===n||n.call(t,e)}complete(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)}_subscribe(e){var t,n;return null!==(n=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==n?n:Wl}}class Xi extends Ss{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){const{hasError:e,thrownError:t,_value:n}=this;if(e)throw t;return this._throwIfClosed(),n}next(e){super.next(this._value=e)}}function oh(r){return Cn(r?.lift)}function Yr(r){return e=>{if(oh(e))return e.lift(function(t){try{return r(t,this)}catch(n){this.error(n)}});throw new TypeError("Unable to lift unknown Observable type")}}function vr(r,e,t,n,i){return new ny(r,e,t,n,i)}class ny extends zt{constructor(e,t,n,i,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=t?function(a){try{t(a)}catch(c){e.error(c)}}:super._next,this._error=i?function(a){try{i(a)}catch(c){e.error(c)}finally{this.unsubscribe()}}:super._error,this._complete=n?function(){try{n()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:t}=this;super.unsubscribe(),!t&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}}}function Wn(r,e){return Yr((t,n)=>{let i=0;t.subscribe(vr(n,s=>{n.next(r.call(e,s,i++))}))})}function Gu(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(null!=r&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]])}return t}function js(r){return this instanceof js?(this.v=r,this):new js(r)}function Kl(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,e=r[Symbol.asyncIterator];return e?e.call(r):(r=function t1(r){var e="function"==typeof Symbol&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&"number"==typeof r.length)return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(r),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(s){t[s]=r[s]&&function(o){return new Promise(function(a,c){!function i(s,o,a,c){Promise.resolve(c).then(function(l){s({value:l,done:a})},o)}(a,c,(o=r[s](o)).done,o.value)})}}}"function"==typeof SuppressedError&&SuppressedError;const OR=r=>r&&"number"==typeof r.length&&"function"!=typeof r;function bR(r){return Cn(r?.then)}function wR(r){return Cn(r[Fu])}function AR(r){return Symbol.asyncIterator&&Cn(r?.[Symbol.asyncIterator])}function NR(r){return new TypeError(`You provided ${null!==r&&"object"==typeof r?"an invalid object":`'${r}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const IR=function O4e(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function kR(r){return Cn(r?.[IR])}function xR(r){return function W0(r,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,n=t.apply(r,e||[]),s=[];return i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i;function o(m){n[m]&&(i[m]=function(E){return new Promise(function(w,R){s.push([m,E,w,R])>1||a(m,E)})})}function a(m,E){try{!function c(m){m.value instanceof js?Promise.resolve(m.value.v).then(l,f):d(s[0][2],m)}(n[m](E))}catch(w){d(s[0][3],w)}}function l(m){a("next",m)}function f(m){a("throw",m)}function d(m,E){m(E),s.shift(),s.length&&a(s[0][0],s[0][1])}}(this,arguments,function*(){const t=r.getReader();try{for(;;){const{value:n,done:i}=yield js(t.read());if(i)return yield js(void 0);yield yield js(n)}}finally{t.releaseLock()}})}function LR(r){return Cn(r?.getReader)}function Ys(r){if(r instanceof b1)return r;if(null!=r){if(wR(r))return function b4e(r){return new b1(e=>{const t=r[Fu]();if(Cn(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(r);if(OR(r))return function w4e(r){return new b1(e=>{for(let t=0;t<r.length&&!e.closed;t++)e.next(r[t]);e.complete()})}(r);if(bR(r))return function A4e(r){return new b1(e=>{r.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,ql)})}(r);if(AR(r))return RR(r);if(kR(r))return function N4e(r){return new b1(e=>{for(const t of r)if(e.next(t),e.closed)return;e.complete()})}(r);if(LR(r))return function I4e(r){return RR(xR(r))}(r)}throw NR(r)}function RR(r){return new b1(e=>{(function k4e(r,e){var t,n,i,s;return function Se(r,e,t,n){return new(t||(t=Promise))(function(s,o){function a(f){try{l(n.next(f))}catch(d){o(d)}}function c(f){try{l(n.throw(f))}catch(d){o(d)}}function l(f){f.done?s(f.value):function i(s){return s instanceof t?s:new t(function(o){o(s)})}(f.value).then(a,c)}l((n=n.apply(r,e||[])).next())})}(this,void 0,void 0,function*(){try{for(t=Kl(r);!(n=yield t.next()).done;)if(e.next(n.value),e.closed)return}catch(o){i={error:o}}finally{try{n&&!n.done&&(s=t.return)&&(yield s.call(t))}finally{if(i)throw i.error}}e.complete()})})(r,e).catch(t=>e.error(t))})}function u3(r,e,t,n=0,i=!1){const s=e.schedule(function(){t(),i?r.add(this.schedule(null,n)):this.unsubscribe()},n);if(r.add(s),!i)return s}function K2(r,e,t=1/0){return Cn(e)?K2((n,i)=>Wn((s,o)=>e(n,s,i,o))(Ys(r(n,i))),t):("number"==typeof e&&(t=e),Yr((n,i)=>function x4e(r,e,t,n,i,s,o,a){const c=[];let l=0,f=0,d=!1;const m=()=>{d&&!c.length&&!l&&e.complete()},E=R=>l<n?w(R):c.push(R),w=R=>{s&&e.next(R),l++;let z=!1;Ys(t(R,f++)).subscribe(vr(e,$=>{i?.($),s?E($):e.next($)},()=>{z=!0},void 0,()=>{if(z)try{for(l--;c.length&&l<n;){const $=c.shift();o?u3(e,o,()=>w($)):w($)}m()}catch($){e.error($)}}))};return r.subscribe(vr(e,E,()=>{d=!0,m()})),()=>{a?.()}}(n,i,r,t)))}function q0(r=1/0){return K2(ec,r)}const tc=new b1(r=>r.complete());function cy(r){return r[r.length-1]}function zR(r){return Cn(cy(r))?r.pop():void 0}function Uu(r){return function R4e(r){return r&&Cn(r.schedule)}(cy(r))?r.pop():void 0}function ch(r,e=0){return Yr((t,n)=>{t.subscribe(vr(n,i=>u3(n,r,()=>n.next(i),e),()=>u3(n,r,()=>n.complete(),e),i=>u3(n,r,()=>n.error(i),e)))})}function lh(r,e=0){return Yr((t,n)=>{n.add(r.schedule(()=>t.subscribe(n),e))})}function DR(r,e){if(!r)throw new Error("Iterable cannot be null");return new b1(t=>{u3(t,e,()=>{const n=r[Symbol.asyncIterator]();u3(t,e,()=>{n.next().then(i=>{i.done?t.complete():t.next(i.value)})},0,!0)})})}function o2(r,e){return e?function G4e(r,e){if(null!=r){if(wR(r))return function D4e(r,e){return Ys(r).pipe(lh(e),ch(e))}(r,e);if(OR(r))return function V4e(r,e){return new b1(t=>{let n=0;return e.schedule(function(){n===r.length?t.complete():(t.next(r[n++]),t.closed||this.schedule())})})}(r,e);if(bR(r))return function H4e(r,e){return Ys(r).pipe(lh(e),ch(e))}(r,e);if(AR(r))return DR(r,e);if(kR(r))return function F4e(r,e){return new b1(t=>{let n;return u3(t,e,()=>{n=r[IR](),u3(t,e,()=>{let i,s;try{({value:i,done:s}=n.next())}catch(o){return void t.error(o)}s?t.complete():t.next(i)},0,!0)}),()=>Cn(n?.return)&&n.return()})}(r,e);if(LR(r))return function $4e(r,e){return DR(xR(r),e)}(r,e)}throw NR(r)}(r,e):Ys(r)}function Dt(...r){return o2(r,Uu(r))}function HR(r={}){const{connector:e=(()=>new Ss),resetOnError:t=!0,resetOnComplete:n=!0,resetOnRefCountZero:i=!0}=r;return s=>{let o,a,c,l=0,f=!1,d=!1;const m=()=>{a?.unsubscribe(),a=void 0},E=()=>{m(),o=c=void 0,f=d=!1},w=()=>{const R=o;E(),R?.unsubscribe()};return Yr((R,z)=>{l++,!d&&!f&&m();const $=c=c??e();z.add(()=>{l--,0===l&&!d&&!f&&(a=ly(w,i))}),$.subscribe(z),!o&&l>0&&(o=new Mi({next:G=>$.next(G),error:G=>{d=!0,m(),a=ly(E,t,G),$.error(G)},complete:()=>{f=!0,m(),a=ly(E,n),$.complete()}}),Ys(R).subscribe(o))})(s)}}function ly(r,e,...t){if(!0===e)return void r();if(!1===e)return;const n=new Mi({next:()=>{n.unsubscribe(),r()}});return Ys(e(...t)).subscribe(n)}function fa(r,e){return Yr((t,n)=>{let i=null,s=0,o=!1;const a=()=>o&&!i&&n.complete();t.subscribe(vr(n,c=>{i?.unsubscribe();let l=0;const f=s++;Ys(r(c,f)).subscribe(i=vr(n,d=>n.next(e?e(c,d,f,l++):d),()=>{i=null,a()}))},()=>{o=!0,a()}))})}function W4e(r,e){return r===e}function a1(r){for(let e in r)if(r[e]===a1)return e;throw Error("Could not find renamed property on target object.")}function uh(r,e){for(const t in e)e.hasOwnProperty(t)&&!r.hasOwnProperty(t)&&(r[t]=e[t])}function a2(r){if("string"==typeof r)return r;if(Array.isArray(r))return"["+r.map(a2).join(", ")+"]";if(null==r)return""+r;if(r.overriddenName)return`${r.overriddenName}`;if(r.name)return`${r.name}`;const e=r.toString();if(null==e)return""+e;const t=e.indexOf("\n");return-1===t?e:e.substring(0,t)}function uy(r,e){return null==r||""===r?null===e?"":e:null==e||""===e?r:r+" "+e}const q4e=a1({__forward_ref__:a1});function w1(r){return r.__forward_ref__=w1,r.toString=function(){return a2(this())},r}function $t(r){return fy(r)?r():r}function fy(r){return"function"==typeof r&&r.hasOwnProperty(q4e)&&r.__forward_ref__===w1}function dy(r){return r&&!!r.\u0275providers}const VR="https://g.co/ng/security#xss";class ge extends Error{constructor(e,t){super(function fh(r,e){return`NG0${Math.abs(r)}${e?": "+e:""}`}(e,t)),this.code=e}}function jt(r){return"string"==typeof r?r:null==r?"":String(r)}function hy(r,e){throw new ge(-201,!1)}function Ht(r,e,t,n){throw new Error(`ASSERTION ERROR: ${r}`+(null==n?"":` [Expected=> ${t} ${n} ${e} <=Actual]`))}function He(r){return{token:r.token,providedIn:r.providedIn||null,factory:r.factory,value:void 0}}function X2(r){return{providers:r.providers||[],imports:r.imports||[]}}function dh(r){return FR(r,ph)||FR(r,$R)}function FR(r,e){return r.hasOwnProperty(e)?r[e]:null}function hh(r){return r&&(r.hasOwnProperty(py)||r.hasOwnProperty(ele))?r[py]:null}const ph=a1({\u0275prov:a1}),py=a1({\u0275inj:a1}),$R=a1({ngInjectableDef:a1}),ele=a1({ngInjectorDef:a1});var an=function(r){return r[r.Default=0]="Default",r[r.Host=1]="Host",r[r.Self=2]="Self",r[r.SkipSelf=4]="SkipSelf",r[r.Optional=8]="Optional",r}(an||{});let gy;function Ps(r){const e=gy;return gy=r,e}function BR(r,e,t){const n=dh(r);return n&&"root"==n.providedIn?void 0===n.value?n.value=n.factory():n.value:t&an.Optional?null:void 0!==e?e:void hy(a2(r))}const C1=globalThis,Wu={},yy="__NG_DI_FLAG__",gh="ngTempTokenPath",rle=/\n/gm,WR="__source";let j0;function T4(r){const e=j0;return j0=r,e}function ole(r,e=an.Default){if(void 0===j0)throw new ge(-203,!1);return null===j0?BR(r,void 0,e):j0.get(r,e&an.Optional?null:void 0,e)}function Pe(r,e=an.Default){return(function GR(){return gy}()||ole)($t(r),e)}function rt(r,e=an.Default){return Pe(r,mh(e))}function mh(r){return typeof r>"u"||"number"==typeof r?r:0|(r.optional&&8)|(r.host&&1)|(r.self&&2)|(r.skipSelf&&4)}function My(r){const e=[];for(let t=0;t<r.length;t++){const n=$t(r[t]);if(Array.isArray(n)){if(0===n.length)throw new ge(900,!1);let i,s=an.Default;for(let o=0;o<n.length;o++){const a=n[o],c=ale(a);"number"==typeof c?-1===c?i=a.token:s|=c:i=a}e.push(Pe(i,s))}else e.push(Pe(n))}return e}function qu(r,e){return r[yy]=e,r.prototype[yy]=e,r}function ale(r){return r[yy]}function f3(r){return{toString:r}.toString()}var _h=function(r){return r[r.OnPush=0]="OnPush",r[r.Default=1]="Default",r}(_h||{}),bo=function(r){return r[r.Emulated=0]="Emulated",r[r.None=2]="None",r[r.ShadowDom=3]="ShadowDom",r}(bo||{});const nc={},qn=[],vh=a1({\u0275cmp:a1}),Ey=a1({\u0275dir:a1}),Sy=a1({\u0275pipe:a1}),jR=a1({\u0275mod:a1}),d3=a1({\u0275fac:a1}),ju=a1({__NG_ELEMENT_ID__:a1}),ZR=a1({__NG_ENV_ID__:a1});function YR(r,e,t){let n=r.length;for(;;){const i=r.indexOf(e,t);if(-1===i)return i;if(0===i||r.charCodeAt(i-1)<=32){const s=e.length;if(i+s===n||r.charCodeAt(i+s)<=32)return i}t=i+1}}function Py(r,e,t){let n=0;for(;n<t.length;){const i=t[n];if("number"==typeof i){if(0!==i)break;n++;const s=t[n++],o=t[n++],a=t[n++];r.setAttribute(e,o,a,s)}else{const s=i,o=t[++n];XR(s)?r.setProperty(e,s,o):r.setAttribute(e,s,o),n++}}return n}function KR(r){return 3===r||4===r||6===r}function XR(r){return 64===r.charCodeAt(0)}function Zu(r,e){if(null!==e&&0!==e.length)if(null===r||0===r.length)r=e.slice();else{let t=-1;for(let n=0;n<e.length;n++){const i=e[n];"number"==typeof i?t=i:0===t||QR(r,t,i,null,-1===t||2===t?e[++n]:null)}}return r}function QR(r,e,t,n,i){let s=0,o=r.length;if(-1===e)o=-1;else for(;s<r.length;){const a=r[s++];if("number"==typeof a){if(a===e){o=-1;break}if(a>e){o=s-1;break}}}for(;s<r.length;){const a=r[s];if("number"==typeof a)break;if(a===t){if(null===n)return void(null!==i&&(r[s+1]=i));if(n===r[s+1])return void(r[s+2]=i)}s++,null!==n&&s++,null!==i&&s++}-1!==o&&(r.splice(o,0,e),s=o+1),r.splice(s++,0,t),null!==n&&r.splice(s++,0,n),null!==i&&r.splice(s++,0,i)}const JR="ng-template";function ule(r,e,t){let n=0,i=!0;for(;n<r.length;){let s=r[n++];if("string"==typeof s&&i){const o=r[n++];if(t&&"class"===s&&-1!==YR(o.toLowerCase(),e,0))return!0}else{if(1===s){for(;n<r.length&&"string"==typeof(s=r[n++]);)if(s.toLowerCase()===e)return!0;return!1}"number"==typeof s&&(i=!1)}}return!1}function ez(r){return 4===r.type&&r.value!==JR}function fle(r,e,t){return e===(4!==r.type||t?r.value:JR)}function dle(r,e,t){let n=4;const i=r.attrs||[],s=function gle(r){for(let e=0;e<r.length;e++)if(KR(r[e]))return e;return r.length}(i);let o=!1;for(let a=0;a<e.length;a++){const c=e[a];if("number"!=typeof c){if(!o)if(4&n){if(n=2|1&n,""!==c&&!fle(r,c,t)||""===c&&1===e.length){if(da(n))return!1;o=!0}}else{const l=8&n?c:e[++a];if(8&n&&null!==r.attrs){if(!ule(r.attrs,l,t)){if(da(n))return!1;o=!0}continue}const d=hle(8&n?"class":c,i,ez(r),t);if(-1===d){if(da(n))return!1;o=!0;continue}if(""!==l){let m;m=d>s?"":i[d+1].toLowerCase();const E=8&n?m:null;if(E&&-1!==YR(E,l,0)||2&n&&l!==m){if(da(n))return!1;o=!0}}}}else{if(!o&&!da(n)&&!da(c))return!1;if(o&&da(c))continue;o=!1,n=c|1&n}}return da(n)||o}function da(r){return 0==(1&r)}function hle(r,e,t,n){if(null===e)return-1;let i=0;if(n||!t){let s=!1;for(;i<e.length;){const o=e[i];if(o===r)return i;if(3===o||6===o)s=!0;else{if(1===o||2===o){let a=e[++i];for(;"string"==typeof a;)a=e[++i];continue}if(4===o)break;if(0===o){i+=4;continue}}i+=s?1:2}return-1}return function mle(r,e){let t=r.indexOf(4);if(t>-1)for(t++;t<r.length;){const n=r[t];if("number"==typeof n)return-1;if(n===e)return t;t++}return-1}(e,r)}function tz(r,e,t=!1){for(let n=0;n<e.length;n++)if(dle(r,e[n],t))return!0;return!1}function _le(r,e){e:for(let t=0;t<e.length;t++){const n=e[t];if(r.length===n.length){for(let i=0;i<r.length;i++)if(r[i]!==n[i])continue e;return!0}}return!1}function nz(r,e){return r?":not("+e.trim()+")":e}function vle(r){let e=r[0],t=1,n=2,i="",s=!1;for(;t<r.length;){let o=r[t];if("string"==typeof o)if(2&n){const a=r[++t];i+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else 8&n?i+="."+o:4&n&&(i+=" "+o);else""!==i&&!da(o)&&(e+=nz(s,i),i=""),n=o,s=s||!da(n);t++}return""!==i&&(e+=nz(s,i)),e}function qe(r){return f3(()=>{const e=iz(r),t={...e,decls:r.decls,vars:r.vars,template:r.template,consts:r.consts||null,ngContentSelectors:r.ngContentSelectors,onPush:r.changeDetection===_h.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&r.dependencies||null,getStandaloneInjector:null,signals:r.signals??!1,data:r.data||{},encapsulation:r.encapsulation||bo.Emulated,styles:r.styles||qn,_:null,schemas:r.schemas||null,tView:null,id:""};sz(t);const n=r.dependencies;return t.directiveDefs=Ch(n,!1),t.pipeDefs=Ch(n,!0),t.id=function Tle(r){let e=0;const t=[r.selectors,r.ngContentSelectors,r.hostVars,r.hostAttrs,r.consts,r.vars,r.decls,r.encapsulation,r.standalone,r.signals,r.exportAs,JSON.stringify(r.inputs),JSON.stringify(r.outputs),Object.getOwnPropertyNames(r.type.prototype),!!r.contentQueries,!!r.viewQuery].join("|");for(const i of t)e=Math.imul(31,e)+i.charCodeAt(0)<<0;return e+=2147483648,"c"+e}(t),t})}function Ty(r,e,t){const n=r.\u0275cmp;n.directiveDefs=Ch(e,!1),n.pipeDefs=Ch(t,!0)}function Mle(r){return Ln(r)||Q2(r)}function Ele(r){return null!==r}function Ei(r){return f3(()=>({type:r.type,bootstrap:r.bootstrap||qn,declarations:r.declarations||qn,imports:r.imports||qn,exports:r.exports||qn,transitiveCompileScopes:null,schemas:r.schemas||null,id:r.id||null}))}function rz(r,e){if(null==r)return nc;const t={};for(const n in r)if(r.hasOwnProperty(n)){let i=r[n],s=i;Array.isArray(i)&&(s=i[1],i=i[0]),t[i]=n,e&&(e[i]=s)}return t}function Rt(r){return f3(()=>{const e=iz(r);return sz(e),e})}function Si(r){return{type:r.type,name:r.name,factory:null,pure:!1!==r.pure,standalone:!0===r.standalone,onDestroy:r.type.prototype.ngOnDestroy||null}}function Ln(r){return r[vh]||null}function Q2(r){return r[Ey]||null}function Qi(r){return r[Sy]||null}function Xs(r,e){const t=r[jR]||null;if(!t&&!0===e)throw new Error(`Type ${a2(r)} does not have '\u0275mod' property.`);return t}function iz(r){const e={};return{type:r.type,providersResolver:null,factory:null,hostBindings:r.hostBindings||null,hostVars:r.hostVars||0,hostAttrs:r.hostAttrs||null,contentQueries:r.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:r.inputs||nc,exportAs:r.exportAs||null,standalone:!0===r.standalone,signals:!0===r.signals,selectors:r.selectors||qn,viewQuery:r.viewQuery||null,features:r.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:rz(r.inputs,e),outputs:rz(r.outputs)}}function sz(r){r.features?.forEach(e=>e(r))}function Ch(r,e){if(!r)return null;const t=e?Qi:Mle;return()=>("function"==typeof r?r():r).map(n=>t(n)).filter(Ele)}const Lr=0,et=1,Kt=2,X1=3,ha=4,Yu=5,Pi=6,Y0=7,Rr=8,O4=9,K0=10,Zt=11,Ku=12,oz=13,X0=14,zr=15,Xu=16,Q0=17,rc=18,Qu=19,az=20,b4=21,h3=22,yh=23,Mh=24,pn=25,Oy=1,cz=2,ic=7,J0=9,J2=11;function Ts(r){return Array.isArray(r)&&"object"==typeof r[Oy]}function Os(r){return Array.isArray(r)&&!0===r[Oy]}function by(r){return 0!=(4&r.flags)}function Jl(r){return r.componentOffset>-1}function Sh(r){return 1==(1&r.flags)}function pa(r){return!!r.template}function wy(r){return 0!=(512&r[Kt])}function e6(r,e){return r.hasOwnProperty(d3)?r[d3]:null}let Ile=C1.WeakRef??class Nle{constructor(e){this.ref=e}deref(){return this.ref}},xle=0,sc=null,Ph=!1;function T2(r){const e=sc;return sc=r,e}class hz{constructor(){this.id=xle++,this.ref=function kle(r){return new Ile(r)}(this),this.producers=new Map,this.consumers=new Map,this.trackingVersion=0,this.valueVersion=0}consumerPollProducersForChange(){for(const[e,t]of this.producers){const n=t.producerNode.deref();if(null!=n&&t.atTrackingVersion===this.trackingVersion){if(n.producerPollStatus(t.seenValueVersion))return!0}else this.producers.delete(e),n?.consumers.delete(this.id)}return!1}producerMayHaveChanged(){const e=Ph;Ph=!0;try{for(const[t,n]of this.consumers){const i=n.consumerNode.deref();null!=i&&i.trackingVersion===n.atTrackingVersion?i.onConsumerDependencyMayHaveChanged():(this.consumers.delete(t),i?.producers.delete(this.id))}}finally{Ph=e}}producerAccessed(){if(Ph)throw new Error("");if(null===sc)return;let e=sc.producers.get(this.id);void 0===e?(e={consumerNode:sc.ref,producerNode:this.ref,seenValueVersion:this.valueVersion,atTrackingVersion:sc.trackingVersion},sc.producers.set(this.id,e),this.consumers.set(sc.id,e)):(e.seenValueVersion=this.valueVersion,e.atTrackingVersion=sc.trackingVersion)}get hasProducers(){return this.producers.size>0}get producerUpdatesAllowed(){return!1!==sc?.consumerAllowSignalWrites}producerPollStatus(e){return this.valueVersion!==e||(this.onProducerUpdateValueVersion(),this.valueVersion!==e)}}let pz=null;const mz=()=>{};class Dle extends hz{constructor(e,t,n){super(),this.watch=e,this.schedule=t,this.dirty=!1,this.cleanupFn=mz,this.registerOnCleanup=i=>{this.cleanupFn=i},this.consumerAllowSignalWrites=n}notify(){this.dirty||this.schedule(this),this.dirty=!0}onConsumerDependencyMayHaveChanged(){this.notify()}onProducerUpdateValueVersion(){}run(){if(this.dirty=!1,0!==this.trackingVersion&&!this.consumerPollProducersForChange())return;const e=T2(this);this.trackingVersion++;try{this.cleanupFn(),this.cleanupFn=mz,this.watch(this.registerOnCleanup)}finally{T2(e)}}cleanup(){this.cleanupFn()}}class Hle{constructor(e,t,n){this.previousValue=e,this.currentValue=t,this.firstChange=n}isFirstChange(){return this.firstChange}}function Ji(){return _z}function _z(r){return r.type.prototype.ngOnChanges&&(r.setInput=Fle),Vle}function Vle(){const r=Cz(this),e=r?.current;if(e){const t=r.previous;if(t===nc)r.previous=e;else for(let n in e)t[n]=e[n];r.current=null,this.ngOnChanges(e)}}function Fle(r,e,t,n){const i=this.declaredInputs[t],s=Cz(r)||function $le(r,e){return r[vz]=e}(r,{previous:nc,current:null}),o=s.current||(s.current={}),a=s.previous,c=a[i];o[i]=new Hle(c&&c.currentValue,e,a===nc),r[n]=e}Ji.ngInherit=!0;const vz="__ngSimpleChanges__";function Cz(r){return r[vz]||null}const oc=function(r,e,t){},yz="svg";function A1(r){for(;Array.isArray(r);)r=r[Lr];return r}function bh(r,e){return A1(e[r])}function bs(r,e){return A1(e[r.index])}function Ez(r,e){return r.data[e]}function e8(r,e){return r[e]}function Qs(r,e){const t=e[r];return Ts(t)?t:t[Lr]}function w4(r,e){return null==e?null:r[e]}function Sz(r){r[Q0]=0}function Zle(r){1024&r[Kt]||(r[Kt]|=1024,Tz(r,1))}function Pz(r){1024&r[Kt]&&(r[Kt]&=-1025,Tz(r,-1))}function Tz(r,e){let t=r[X1];if(null===t)return;t[Yu]+=e;let n=t;for(t=t[X1];null!==t&&(1===e&&1===n[Yu]||-1===e&&0===n[Yu]);)t[Yu]+=e,n=t,t=t[X1]}const Vt={lFrame:zz(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function wz(){return Vt.bindingsEnabled}function t8(){return null!==Vt.skipHydrationRootTNode}function Ee(){return Vt.lFrame.lView}function Rn(){return Vt.lFrame.tView}function te(r){return Vt.lFrame.contextLView=r,r[Rr]}function ne(r){return Vt.lFrame.contextLView=null,r}function ei(){let r=Az();for(;null!==r&&64===r.type;)r=r.parent;return r}function Az(){return Vt.lFrame.currentTNode}function e7(){const r=Vt.lFrame,e=r.currentTNode;return r.isParent?e:e.parent}function ac(r,e){const t=Vt.lFrame;t.currentTNode=r,t.isParent=e}function Ly(){return Vt.lFrame.isParent}function Ry(){Vt.lFrame.isParent=!1}function es(){const r=Vt.lFrame;let e=r.bindingRootIndex;return-1===e&&(e=r.bindingRootIndex=r.tView.bindingStartIndex),e}function p3(){return Vt.lFrame.bindingIndex}function n8(){return Vt.lFrame.bindingIndex++}function g3(r){const e=Vt.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+r,t}function kz(r){Vt.lFrame.inI18n=r}function o6e(r,e){const t=Vt.lFrame;t.bindingIndex=t.bindingRootIndex=r,zy(e)}function zy(r){Vt.lFrame.currentDirectiveIndex=r}function xz(){return Vt.lFrame.currentQueryIndex}function Hy(r){Vt.lFrame.currentQueryIndex=r}function c6e(r){const e=r[et];return 2===e.type?e.declTNode:1===e.type?r[Pi]:null}function Lz(r,e,t){if(t&an.SkipSelf){let i=e,s=r;for(;!(i=i.parent,null!==i||t&an.Host||(i=c6e(s),null===i||(s=s[X0],10&i.type))););if(null===i)return!1;e=i,r=s}const n=Vt.lFrame=Rz();return n.currentTNode=e,n.lView=r,!0}function Vy(r){const e=Rz(),t=r[et];Vt.lFrame=e,e.currentTNode=t.firstChild,e.lView=r,e.tView=t,e.contextLView=r,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function Rz(){const r=Vt.lFrame,e=null===r?null:r.child;return null===e?zz(r):e}function zz(r){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:r,child:null,inI18n:!1};return null!==r&&(r.child=e),e}function Dz(){const r=Vt.lFrame;return Vt.lFrame=r.parent,r.currentTNode=null,r.lView=null,r}const Hz=Dz;function Fy(){const r=Dz();r.isParent=!0,r.tView=null,r.selectedIndex=-1,r.contextLView=null,r.elementDepthCount=0,r.currentDirectiveIndex=-1,r.currentNamespace=null,r.bindingRootIndex=-1,r.bindingIndex=-1,r.currentQueryIndex=0}function ts(){return Vt.lFrame.selectedIndex}function t6(r){Vt.lFrame.selectedIndex=r}function sr(){const r=Vt.lFrame;return Ez(r.tView,r.selectedIndex)}function N(){Vt.lFrame.currentNamespace=yz}let Fz=!0;function wh(){return Fz}function A4(r){Fz=r}function Ah(r,e){for(let t=e.directiveStart,n=e.directiveEnd;t<n;t++){const s=r.data[t].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:c,ngAfterViewChecked:l,ngOnDestroy:f}=s;o&&(r.contentHooks??=[]).push(-t,o),a&&((r.contentHooks??=[]).push(t,a),(r.contentCheckHooks??=[]).push(t,a)),c&&(r.viewHooks??=[]).push(-t,c),l&&((r.viewHooks??=[]).push(t,l),(r.viewCheckHooks??=[]).push(t,l)),null!=f&&(r.destroyHooks??=[]).push(t,f)}}function Nh(r,e,t){$z(r,e,3,t)}function Ih(r,e,t,n){(3&r[Kt])===t&&$z(r,e,t,n)}function $y(r,e){let t=r[Kt];(3&t)===e&&(t&=8191,t+=1,r[Kt]=t)}function $z(r,e,t,n){const s=n??-1,o=e.length-1;let a=0;for(let c=void 0!==n?65535&r[Q0]:0;c<o;c++)if("number"==typeof e[c+1]){if(a=e[c],null!=n&&a>=n)break}else e[c]<0&&(r[Q0]+=65536),(a<s||-1==s)&&(g6e(r,t,e,c),r[Q0]=(4294901760&r[Q0])+c+2),c++}function Gz(r,e){oc(4,r,e);const t=T2(null);try{e.call(r)}finally{T2(t),oc(5,r,e)}}function g6e(r,e,t,n){const i=t[n]<0,s=t[n+1],a=r[i?-t[n]:t[n]];i?r[Kt]>>13<r[Q0]>>16&&(3&r[Kt])===e&&(r[Kt]+=8192,Gz(a,s)):Gz(a,s)}const r8=-1;class t7{constructor(e,t,n){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=n}}function By(r){return r!==r8}function n7(r){return 32767&r}function r7(r,e){let t=function C6e(r){return r>>16}(r),n=e;for(;t>0;)n=n[X0],t--;return n}let Uy=!0;function kh(r){const e=Uy;return Uy=r,e}const Bz=255,Uz=5;let y6e=0;const cc={};function xh(r,e){const t=Wz(r,e);if(-1!==t)return t;const n=e[et];n.firstCreatePass&&(r.injectorIndex=e.length,Wy(n.data,r),Wy(e,null),Wy(n.blueprint,null));const i=Lh(r,e),s=r.injectorIndex;if(By(i)){const o=n7(i),a=r7(i,e),c=a[et].data;for(let l=0;l<8;l++)e[s+l]=a[o+l]|c[o+l]}return e[s+8]=i,s}function Wy(r,e){r.push(0,0,0,0,0,0,0,0,e)}function Wz(r,e){return-1===r.injectorIndex||r.parent&&r.parent.injectorIndex===r.injectorIndex||null===e[r.injectorIndex+8]?-1:r.injectorIndex}function Lh(r,e){if(r.parent&&-1!==r.parent.injectorIndex)return r.parent.injectorIndex;let t=0,n=null,i=e;for(;null!==i;){if(n=Qz(i),null===n)return r8;if(t++,i=i[X0],-1!==n.injectorIndex)return n.injectorIndex|t<<16}return r8}function qy(r,e,t){!function M6e(r,e,t){let n;"string"==typeof t?n=t.charCodeAt(0)||0:t.hasOwnProperty(ju)&&(n=t[ju]),null==n&&(n=t[ju]=y6e++);const i=n&Bz;e.data[r+(i>>Uz)]|=1<<i}(r,e,t)}function qz(r,e,t){if(t&an.Optional||void 0!==r)return r;hy()}function jz(r,e,t,n){if(t&an.Optional&&void 0===n&&(n=null),!(t&(an.Self|an.Host))){const i=r[O4],s=Ps(void 0);try{return i?i.get(e,n,t&an.Optional):BR(e,n,t&an.Optional)}finally{Ps(s)}}return qz(n,0,t)}function Zz(r,e,t,n=an.Default,i){if(null!==r){if(2048&e[Kt]&&!(n&an.Self)){const o=function b6e(r,e,t,n,i){let s=r,o=e;for(;null!==s&&null!==o&&2048&o[Kt]&&!(512&o[Kt]);){const a=Yz(s,o,t,n|an.Self,cc);if(a!==cc)return a;let c=s.parent;if(!c){const l=o[az];if(l){const f=l.get(t,cc,n);if(f!==cc)return f}c=Qz(o),o=o[X0]}s=c}return i}(r,e,t,n,cc);if(o!==cc)return o}const s=Yz(r,e,t,n,cc);if(s!==cc)return s}return jz(e,t,n,i)}function Yz(r,e,t,n,i){const s=function P6e(r){if("string"==typeof r)return r.charCodeAt(0)||0;const e=r.hasOwnProperty(ju)?r[ju]:void 0;return"number"==typeof e?e>=0?e&Bz:O6e:e}(t);if("function"==typeof s){if(!Lz(e,r,n))return n&an.Host?qz(i,0,n):jz(e,t,n,i);try{let o;if(o=s(n),null!=o||n&an.Optional)return o;hy()}finally{Hz()}}else if("number"==typeof s){let o=null,a=Wz(r,e),c=r8,l=n&an.Host?e[zr][Pi]:null;for((-1===a||n&an.SkipSelf)&&(c=-1===a?Lh(r,e):e[a+8],c!==r8&&Xz(n,!1)?(o=e[et],a=n7(c),e=r7(c,e)):a=-1);-1!==a;){const f=e[et];if(Kz(s,a,f.data)){const d=S6e(a,e,t,o,n,l);if(d!==cc)return d}c=e[a+8],c!==r8&&Xz(n,e[et].data[a+8]===l)&&Kz(s,a,e)?(o=f,a=n7(c),e=r7(c,e)):a=-1}}return i}function S6e(r,e,t,n,i,s){const o=e[et],a=o.data[r+8],f=Rh(a,o,t,null==n?Jl(a)&&Uy:n!=o&&0!=(3&a.type),i&an.Host&&s===a);return null!==f?n6(e,o,f,a):cc}function Rh(r,e,t,n,i){const s=r.providerIndexes,o=e.data,a=1048575&s,c=r.directiveStart,f=s>>20,m=i?a+f:r.directiveEnd;for(let E=n?a:a+f;E<m;E++){const w=o[E];if(E<c&&t===w||E>=c&&w.type===t)return E}if(i){const E=o[c];if(E&&pa(E)&&E.type===t)return c}return null}function n6(r,e,t,n){let i=r[t];const s=e.data;if(function m6e(r){return r instanceof t7}(i)){const o=i;o.resolving&&function j4e(r,e){const t=e?`. Dependency path: ${e.join(" > ")} > ${r}`:"";throw new ge(-200,`Circular dependency in DI detected for ${r}${t}`)}(function r1(r){return"function"==typeof r?r.name||r.toString():"object"==typeof r&&null!=r&&"function"==typeof r.type?r.type.name||r.type.toString():jt(r)}(s[t]));const a=kh(o.canSeeViewProviders);o.resolving=!0;const l=o.injectImpl?Ps(o.injectImpl):null;Lz(r,n,an.Default);try{i=r[t]=o.factory(void 0,s,r,n),e.firstCreatePass&&t>=n.directiveStart&&function p6e(r,e,t){const{ngOnChanges:n,ngOnInit:i,ngDoCheck:s}=e.type.prototype;if(n){const o=_z(e);(t.preOrderHooks??=[]).push(r,o),(t.preOrderCheckHooks??=[]).push(r,o)}i&&(t.preOrderHooks??=[]).push(0-r,i),s&&((t.preOrderHooks??=[]).push(r,s),(t.preOrderCheckHooks??=[]).push(r,s))}(t,s[t],e)}finally{null!==l&&Ps(l),kh(a),o.resolving=!1,Hz()}}return i}function Kz(r,e,t){return!!(t[e+(r>>Uz)]&1<<r)}function Xz(r,e){return!(r&an.Self||r&an.Host&&e)}class ns{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,n){return Zz(this._tNode,this._lView,e,mh(n),t)}}function O6e(){return new ns(ei(),Ee())}function or(r){return f3(()=>{const e=r.prototype.constructor,t=e[d3]||jy(e),n=Object.prototype;let i=Object.getPrototypeOf(r.prototype).constructor;for(;i&&i!==n;){const s=i[d3]||jy(i);if(s&&s!==t)return s;i=Object.getPrototypeOf(i)}return s=>new s})}function jy(r){return fy(r)?()=>{const e=jy($t(r));return e&&e()}:e6(r)}function Qz(r){const e=r[et],t=e.type;return 2===t?e.declTNode:1===t?r[Pi]:null}const s8="__parameters__";function a8(r,e,t){return f3(()=>{const n=function Zy(r){return function(...t){if(r){const n=r(...t);for(const i in n)this[i]=n[i]}}}(e);function i(...s){if(this instanceof i)return n.apply(this,s),this;const o=new i(...s);return a.annotation=o,a;function a(c,l,f){const d=c.hasOwnProperty(s8)?c[s8]:Object.defineProperty(c,s8,{value:[]})[s8];for(;d.length<=f;)d.push(null);return(d[f]=d[f]||[]).push(o),c}}return t&&(i.prototype=Object.create(t.prototype)),i.prototype.ngMetadataName=r,i.annotationCls=i,i})}function l8(r,e){r.forEach(t=>Array.isArray(t)?l8(t,e):e(t))}function eD(r,e,t){e>=r.length?r.push(t):r.splice(e,0,t)}function Dh(r,e){return e>=r.length-1?r.pop():r.splice(e,1)[0]}function o7(r,e){const t=[];for(let n=0;n<r;n++)t.push(e);return t}function Js(r,e,t){let n=u8(r,e);return n>=0?r[1|n]=t:(n=~n,function L6e(r,e,t,n){let i=r.length;if(i==e)r.push(t,n);else if(1===i)r.push(n,r[0]),r[0]=t;else{for(i--,r.push(r[i-1],r[i]);i>e;)r[i]=r[i-2],i--;r[e]=t,r[e+1]=n}}(r,n,e,t)),n}function Yy(r,e){const t=u8(r,e);if(t>=0)return r[1|t]}function u8(r,e){return function tD(r,e,t){let n=0,i=r.length>>t;for(;i!==n;){const s=n+(i-n>>1),o=r[s<<t];if(e===o)return s<<t;o>e?i=s:n=s+1}return~(i<<t)}(r,e,1)}const rs=qu(a8("Optional"),8),Vh=qu(a8("SkipSelf"),4);function Uh(r){return 128==(128&r.flags)}var N4=function(r){return r[r.Important=1]="Important",r[r.DashCase=2]="DashCase",r}(N4||{});const t0e=/^>|^->|<!--|-->|--!>|<!-$/g,n0e=/(<|>)/,r0e="\u200b$1\u200b";const eM=new Map;let i0e=0;const nM="__ngContext__";function Ti(r,e){Ts(e)?(r[nM]=e[Qu],function o0e(r){eM.set(r[Qu],r)}(e)):r[nM]=e}let rM;function iM(r,e){return rM(r,e)}function l7(r){const e=r[X1];return Os(e)?e[X1]:e}function MD(r){return SD(r[Ku])}function ED(r){return SD(r[ha])}function SD(r){for(;null!==r&&!Os(r);)r=r[ha];return r}function h8(r,e,t,n,i){if(null!=n){let s,o=!1;Os(n)?s=n:Ts(n)&&(o=!0,n=n[Lr]);const a=A1(n);0===r&&null!==t?null==i?bD(e,t,a):r6(e,t,a,i||null,!0):1===r&&null!==t?r6(e,t,a,i||null,!0):2===r?Xh(e,a,o):3===r&&e.destroyNode(a),null!=s&&function w0e(r,e,t,n,i){const s=t[ic];s!==A1(t)&&h8(e,r,n,s,i);for(let a=J2;a<t.length;a++){const c=t[a];f7(c[et],c,r,e,n,s)}}(e,r,s,t,i)}}function qh(r,e){return r.createText(e)}function PD(r,e,t){r.setValue(e,t)}function sM(r,e){return r.createComment(function hD(r){return r.replace(t0e,e=>e.replace(n0e,r0e))}(e))}function jh(r,e,t){return r.createElement(e,t)}function TD(r,e){const t=r[J0],n=t.indexOf(e);Pz(e),t.splice(n,1)}function Zh(r,e){if(r.length<=J2)return;const t=J2+e,n=r[t];if(n){const i=n[Xu];null!==i&&i!==r&&TD(i,n),e>0&&(r[t-1][ha]=n[ha]);const s=Dh(r,J2+e);!function _0e(r,e){f7(r,e,e[Zt],2,null,null),e[Lr]=null,e[Pi]=null}(n[et],n);const o=s[rc];null!==o&&o.detachView(s[et]),n[X1]=null,n[ha]=null,n[Kt]&=-129}return n}function oM(r,e){if(!(256&e[Kt])){const t=e[Zt];e[yh]?.destroy(),e[Mh]?.destroy(),t.destroyNode&&f7(r,e,t,3,null,null),function y0e(r){let e=r[Ku];if(!e)return aM(r[et],r);for(;e;){let t=null;if(Ts(e))t=e[Ku];else{const n=e[J2];n&&(t=n)}if(!t){for(;e&&!e[ha]&&e!==r;)Ts(e)&&aM(e[et],e),e=e[X1];null===e&&(e=r),Ts(e)&&aM(e[et],e),t=e&&e[ha]}e=t}}(e)}}function aM(r,e){if(!(256&e[Kt])){e[Kt]&=-129,e[Kt]|=256,function P0e(r,e){let t;if(null!=r&&null!=(t=r.destroyHooks))for(let n=0;n<t.length;n+=2){const i=e[t[n]];if(!(i instanceof t7)){const s=t[n+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){const a=i[s[o]],c=s[o+1];oc(4,a,c);try{c.call(a)}finally{oc(5,a,c)}}else{oc(4,i,s);try{s.call(i)}finally{oc(5,i,s)}}}}}(r,e),function S0e(r,e){const t=r.cleanup,n=e[Y0];if(null!==t)for(let s=0;s<t.length-1;s+=2)if("string"==typeof t[s]){const o=t[s+3];o>=0?n[o]():n[-o].unsubscribe(),s+=2}else t[s].call(n[t[s+1]]);null!==n&&(e[Y0]=null);const i=e[b4];if(null!==i){e[b4]=null;for(let s=0;s<i.length;s++)(0,i[s])()}}(r,e),1===e[et].type&&e[Zt].destroy();const t=e[Xu];if(null!==t&&Os(e[X1])){t!==e[X1]&&TD(t,e);const n=e[rc];null!==n&&n.detachView(r)}!function a0e(r){eM.delete(r[Qu])}(e)}}function cM(r,e,t){return OD(r,e.parent,t)}function OD(r,e,t){let n=e;for(;null!==n&&40&n.type;)n=(e=n).parent;if(null===n)return t[Lr];{const{componentOffset:i}=n;if(i>-1){const{encapsulation:s}=r.data[n.directiveStart+i];if(s===bo.None||s===bo.Emulated)return null}return bs(n,t)}}function r6(r,e,t,n,i){r.insertBefore(e,t,n,i)}function bD(r,e,t){r.appendChild(e,t)}function wD(r,e,t,n,i){null!==n?r6(r,e,t,n,i):bD(r,e,t)}function Yh(r,e){return r.parentNode(e)}function AD(r,e,t){return ID(r,e,t)}function ND(r,e,t){return 40&r.type?bs(r,t):null}let lM,Qh,hM,Jh,ID=ND;function kD(r,e){ID=r,lM=e}function Kh(r,e,t,n){const i=cM(r,n,e),s=e[Zt],a=AD(n.parent||e[Pi],n,e);if(null!=i)if(Array.isArray(t))for(let c=0;c<t.length;c++)wD(s,i,t[c],a,!1);else wD(s,i,t,a,!1);void 0!==lM&&lM(s,n,e,t,i)}function u7(r,e){if(null!==e){const t=e.type;if(3&t)return bs(e,r);if(4&t)return uM(-1,r[e.index]);if(8&t){const n=e.child;if(null!==n)return u7(r,n);{const i=r[e.index];return Os(i)?uM(-1,i):A1(i)}}if(32&t)return iM(e,r)()||A1(r[e.index]);{const n=xD(r,e);return null!==n?Array.isArray(n)?n[0]:u7(l7(r[zr]),n):u7(r,e.next)}}return null}function xD(r,e){return null!==e?r[zr][Pi].projection[e.projection]:null}function uM(r,e){const t=J2+r+1;if(t<e.length){const n=e[t],i=n[et].firstChild;if(null!==i)return u7(n,i)}return e[ic]}function Xh(r,e,t){const n=Yh(r,e);n&&function T0e(r,e,t,n){r.removeChild(e,t,n)}(r,n,e,t)}function fM(r,e,t,n,i,s,o){for(;null!=t;){const a=n[t.index],c=t.type;if(o&&0===e&&(a&&Ti(A1(a),n),t.flags|=2),32!=(32&t.flags))if(8&c)fM(r,e,t.child,n,i,s,!1),h8(e,r,i,a,s);else if(32&c){const l=iM(t,n);let f;for(;f=l();)h8(e,r,i,f,s);h8(e,r,i,a,s)}else 16&c?RD(r,e,n,t,i,s):h8(e,r,i,a,s);t=o?t.projectionNext:t.next}}function f7(r,e,t,n,i,s){fM(t,n,r.firstChild,e,i,s,!1)}function RD(r,e,t,n,i,s){const o=t[zr],c=o[Pi].projection[n.projection];if(Array.isArray(c))for(let l=0;l<c.length;l++)h8(e,r,i,c[l],s);else{let l=c;const f=o[X1];Uh(n)&&(l.flags|=128),fM(r,e,l,f,i,s,!0)}}function zD(r,e,t){""===t?r.removeAttribute(e,"class"):r.setAttribute(e,"class",t)}function DD(r,e,t){const{mergedAttrs:n,classes:i,styles:s}=t;null!==n&&Py(r,e,n),null!==i&&zD(r,e,i),null!==s&&function N0e(r,e,t){r.setAttribute(e,"style",t)}(r,e,s)}function p8(r){return function dM(){if(void 0===Qh&&(Qh=null,C1.trustedTypes))try{Qh=C1.trustedTypes.createPolicy("angular",{createHTML:r=>r,createScript:r=>r,createScriptURL:r=>r})}catch{}return Qh}()?.createHTML(r)||r}function g8(){if(void 0!==hM)return hM;if(typeof document<"u")return document;throw new ge(210,!1)}function pM(){if(void 0===Jh&&(Jh=null,C1.trustedTypes))try{Jh=C1.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:r=>r,createScript:r=>r,createScriptURL:r=>r})}catch{}return Jh}function HD(r){return pM()?.createHTML(r)||r}function FD(r){return pM()?.createScriptURL(r)||r}class i6{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${VR})`}}class R0e extends i6{getTypeName(){return"HTML"}}class z0e extends i6{getTypeName(){return"Style"}}class D0e extends i6{getTypeName(){return"Script"}}class H0e extends i6{getTypeName(){return"URL"}}class V0e extends i6{getTypeName(){return"ResourceURL"}}function eo(r){return r instanceof i6?r.changingThisBreaksApplicationSecurity:r}function lc(r,e){const t=function F0e(r){return r instanceof i6&&r.getTypeName()||null}(r);if(null!=t&&t!==e){if("ResourceURL"===t&&"URL"===e)return!0;throw new Error(`Required a safe ${e}, got a ${t} (see ${VR})`)}return t===e}function $D(r){const e=new j0e(r);return function Z0e(){try{return!!(new window.DOMParser).parseFromString(p8(""),"text/html")}catch{return!1}}()?new q0e(e):e}class q0e{constructor(e){this.inertDocumentHelper=e}getInertBodyElement(e){e="<body><remove></remove>"+e;try{const t=(new window.DOMParser).parseFromString(p8(e),"text/html").body;return null===t?this.inertDocumentHelper.getInertBodyElement(e):(t.removeChild(t.firstChild),t)}catch{return null}}}class j0e{constructor(e){this.defaultDoc=e,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert")}getInertBodyElement(e){const t=this.inertDocument.createElement("template");return t.innerHTML=p8(e),t}}const Y0e=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function ep(r){return(r=String(r)).match(Y0e)?r:"unsafe:"+r}function m3(r){const e={};for(const t of r.split(","))e[t]=!0;return e}function d7(...r){const e={};for(const t of r)for(const n in t)t.hasOwnProperty(n)&&(e[n]=!0);return e}const GD=m3("area,br,col,hr,img,wbr"),BD=m3("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),UD=m3("rp,rt"),gM=d7(GD,d7(BD,m3("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),d7(UD,m3("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),d7(UD,BD)),mM=m3("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),WD=d7(mM,m3("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),m3("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),K0e=m3("script,style,template");class X0e{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(e){let t=e.firstChild,n=!0;for(;t;)if(t.nodeType===Node.ELEMENT_NODE?n=this.startElement(t):t.nodeType===Node.TEXT_NODE?this.chars(t.nodeValue):this.sanitizedSomething=!0,n&&t.firstChild)t=t.firstChild;else for(;t;){t.nodeType===Node.ELEMENT_NODE&&this.endElement(t);let i=this.checkClobberedElement(t,t.nextSibling);if(i){t=i;break}t=this.checkClobberedElement(t,t.parentNode)}return this.buf.join("")}startElement(e){const t=e.nodeName.toLowerCase();if(!gM.hasOwnProperty(t))return this.sanitizedSomething=!0,!K0e.hasOwnProperty(t);this.buf.push("<"),this.buf.push(t);const n=e.attributes;for(let i=0;i<n.length;i++){const s=n.item(i),o=s.name,a=o.toLowerCase();if(!WD.hasOwnProperty(a)){this.sanitizedSomething=!0;continue}let c=s.value;mM[a]&&(c=ep(c)),this.buf.push(" ",o,'="',qD(c),'"')}return this.buf.push(">"),!0}endElement(e){const t=e.nodeName.toLowerCase();gM.hasOwnProperty(t)&&!GD.hasOwnProperty(t)&&(this.buf.push("</"),this.buf.push(t),this.buf.push(">"))}chars(e){this.buf.push(qD(e))}checkClobberedElement(e,t){if(t&&(e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${e.outerHTML}`);return t}}const Q0e=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,J0e=/([^\#-~ |!])/g;function qD(r){return r.replace(/&/g,"&amp;").replace(Q0e,function(e){return"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";"}).replace(J0e,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let tp;function jD(r,e){let t=null;try{tp=tp||$D(r);let n=e?String(e):"";t=tp.getInertBodyElement(n);let i=5,s=n;do{if(0===i)throw new Error("Failed to sanitize html because the input is unstable");i--,n=s,s=t.innerHTML,t=tp.getInertBodyElement(n)}while(n!==s);return p8((new X0e).sanitizeChildren(_M(t)||t))}finally{if(t){const n=_M(t)||t;for(;n.firstChild;)n.removeChild(n.firstChild)}}}function _M(r){return"content"in r&&function e8e(r){return r.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===r.nodeName}(r)?r.content:null}var Ao=function(r){return r[r.NONE=0]="NONE",r[r.HTML=1]="HTML",r[r.STYLE=2]="STYLE",r[r.SCRIPT=3]="SCRIPT",r[r.URL=4]="URL",r[r.RESOURCE_URL=5]="RESOURCE_URL",r}(Ao||{});function h7(r){const e=p7();return e?HD(e.sanitize(Ao.HTML,r)||""):lc(r,"HTML")?HD(eo(r)):jD(g8(),jt(r))}function np(r){const e=p7();return e?e.sanitize(Ao.URL,r)||"":lc(r,"URL")?eo(r):ep(jt(r))}function ZD(r){const e=p7();if(e)return FD(e.sanitize(Ao.RESOURCE_URL,r)||"");if(lc(r,"ResourceURL"))return FD(eo(r));throw new ge(904,!1)}function p7(){const r=Ee();return r&&r[K0].sanitizer}class tt{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.\u0275prov=He({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}const g7=new tt("ENVIRONMENT_INITIALIZER"),KD=new tt("INJECTOR",-1),XD=new tt("INJECTOR_DEF_TYPES");class vM{get(e,t=Wu){if(t===Wu){const n=new Error(`NullInjectorError: No provider for ${a2(e)}!`);throw n.name="NullInjectorError",n}return t}}function o8e(...r){return{\u0275providers:QD(0,r),\u0275fromNgModule:!0}}function QD(r,...e){const t=[],n=new Set;let i;const s=o=>{t.push(o)};return l8(e,o=>{const a=o;rp(a,s,[],n)&&(i||=[],i.push(a))}),void 0!==i&&JD(i,s),t}function JD(r,e){for(let t=0;t<r.length;t++){const{ngModule:n,providers:i}=r[t];yM(i,s=>{e(s,n)})}}function rp(r,e,t,n){if(!(r=$t(r)))return!1;let i=null,s=hh(r);const o=!s&&Ln(r);if(s||o){if(o&&!o.standalone)return!1;i=r}else{const c=r.ngModule;if(s=hh(c),!s)return!1;i=c}const a=n.has(i);if(o){if(a)return!1;if(n.add(i),o.dependencies){const c="function"==typeof o.dependencies?o.dependencies():o.dependencies;for(const l of c)rp(l,e,t,n)}}else{if(!s)return!1;{if(null!=s.imports&&!a){let l;n.add(i);try{l8(s.imports,f=>{rp(f,e,t,n)&&(l||=[],l.push(f))})}finally{}void 0!==l&&JD(l,e)}if(!a){const l=e6(i)||(()=>new i);e({provide:i,useFactory:l,deps:qn},i),e({provide:XD,useValue:i,multi:!0},i),e({provide:g7,useValue:()=>Pe(i),multi:!0},i)}const c=s.providers;if(null!=c&&!a){const l=r;yM(c,f=>{e(f,l)})}}}return i!==r&&void 0!==r.providers}function yM(r,e){for(let t of r)dy(t)&&(t=t.\u0275providers),Array.isArray(t)?yM(t,e):e(t)}const a8e=a1({provide:String,useValue:a1});function MM(r){return null!==r&&"object"==typeof r&&a8e in r}function s6(r){return"function"==typeof r}const EM=new tt("Set Injector scope."),ip={},l8e={};let SM;function sp(){return void 0===SM&&(SM=new vM),SM}class to{}class op extends to{get destroyed(){return this._destroyed}constructor(e,t,n,i){super(),this.parent=t,this.source=n,this.scopes=i,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,TM(e,o=>this.processProvider(o)),this.records.set(KD,m8(void 0,this)),i.has("environment")&&this.records.set(to,m8(void 0,this));const s=this.records.get(EM);null!=s&&"string"==typeof s.value&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(XD.multi,qn,an.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const t of this._ngOnDestroyHooks)t.ngOnDestroy();const e=this._onDestroyHooks;this._onDestroyHooks=[];for(const t of e)t()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear()}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();const t=T4(this),n=Ps(void 0);try{return e()}finally{T4(t),Ps(n)}}get(e,t=Wu,n=an.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(ZR))return e[ZR](this);n=mh(n);const s=T4(this),o=Ps(void 0);try{if(!(n&an.SkipSelf)){let c=this.records.get(e);if(void 0===c){const l=function p8e(r){return"function"==typeof r||"object"==typeof r&&r instanceof tt}(e)&&dh(e);c=l&&this.injectableDefInScope(l)?m8(PM(e),ip):null,this.records.set(e,c)}if(null!=c)return this.hydrate(e,c)}return(n&an.Self?sp():this.parent).get(e,t=n&an.Optional&&t===Wu?null:t)}catch(a){if("NullInjectorError"===a.name){if((a[gh]=a[gh]||[]).unshift(a2(e)),s)throw a;return function cle(r,e,t,n){const i=r[gh];throw e[WR]&&i.unshift(e[WR]),r.message=function lle(r,e,t,n=null){r=r&&"\n"===r.charAt(0)&&"\u0275"==r.charAt(1)?r.slice(2):r;let i=a2(e);if(Array.isArray(e))i=e.map(a2).join(" -> ");else if("object"==typeof e){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+("string"==typeof a?JSON.stringify(a):a2(a)))}i=`{${s.join(", ")}}`}return`${t}${n?"("+n+")":""}[${i}]: ${r.replace(rle,"\n  ")}`}("\n"+r.message,i,t,n),r.ngTokenPath=i,r[gh]=null,r}(a,e,"R3InjectorError",this.source)}throw a}finally{Ps(o),T4(s)}}resolveInjectorInitializers(){const e=T4(this),t=Ps(void 0);try{const i=this.get(g7.multi,qn,an.Self);for(const s of i)s()}finally{T4(e),Ps(t)}}toString(){const e=[],t=this.records;for(const n of t.keys())e.push(a2(n));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new ge(205,!1)}processProvider(e){let t=s6(e=$t(e))?e:$t(e&&e.provide);const n=function f8e(r){return MM(r)?m8(void 0,r.useValue):m8(nH(r),ip)}(e);if(s6(e)||!0!==e.multi)this.records.get(t);else{let i=this.records.get(t);i||(i=m8(void 0,ip,!0),i.factory=()=>My(i.multi),this.records.set(t,i)),t=e,i.multi.push(e)}this.records.set(t,n)}hydrate(e,t){return t.value===ip&&(t.value=l8e,t.value=t.factory()),"object"==typeof t.value&&t.value&&function h8e(r){return null!==r&&"object"==typeof r&&"function"==typeof r.ngOnDestroy}(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}injectableDefInScope(e){if(!e.providedIn)return!1;const t=$t(e.providedIn);return"string"==typeof t?"any"===t||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){const t=this._onDestroyHooks.indexOf(e);-1!==t&&this._onDestroyHooks.splice(t,1)}}function PM(r){const e=dh(r),t=null!==e?e.factory:e6(r);if(null!==t)return t;if(r instanceof tt)throw new ge(204,!1);if(r instanceof Function)return function u8e(r){const e=r.length;if(e>0)throw o7(e,"?"),new ge(204,!1);const t=function J4e(r){return r&&(r[ph]||r[$R])||null}(r);return null!==t?()=>t.factory(r):()=>new r}(r);throw new ge(204,!1)}function nH(r,e,t){let n;if(s6(r)){const i=$t(r);return e6(i)||PM(i)}if(MM(r))n=()=>$t(r.useValue);else if(function tH(r){return!(!r||!r.useFactory)}(r))n=()=>r.useFactory(...My(r.deps||[]));else if(function eH(r){return!(!r||!r.useExisting)}(r))n=()=>Pe($t(r.useExisting));else{const i=$t(r&&(r.useClass||r.provide));if(!function d8e(r){return!!r.deps}(r))return e6(i)||PM(i);n=()=>new i(...My(r.deps))}return n}function m8(r,e,t=!1){return{factory:r,value:e,multi:t?[]:void 0}}function TM(r,e){for(const t of r)Array.isArray(t)?TM(t,e):t&&dy(t)?TM(t.\u0275providers,e):e(t)}const ap=new tt("AppId",{providedIn:"root",factory:()=>g8e}),g8e="ng",rH=new tt("Platform Initializer"),_3=new tt("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),iH=new tt("AnimationModuleType"),sH=new tt("CSP nonce",{providedIn:"root",factory:()=>g8().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});let aH=(r,e,t)=>null;function kM(r,e,t=!1){return aH(r,e,t)}class T8e{}class uH{}class b8e{resolveComponentFactory(e){throw function O8e(r){const e=Error(`No component factory found for ${a2(r)}.`);return e.ngComponent=r,e}(e)}}let hp=(()=>{class e{}return e.NULL=new b8e,e})();function w8e(){return v8(ei(),Ee())}function v8(r,e){return new Oi(bs(r,e))}let Oi=(()=>{class e{constructor(n){this.nativeElement=n}}return e.__NG_ELEMENT_ID__=w8e,e})();function A8e(r){return r instanceof Oi?r.nativeElement:r}class C7{}let uc=(()=>{class e{constructor(){this.destroyNode=null}}return e.__NG_ELEMENT_ID__=()=>function N8e(){const r=Ee(),t=Qs(ei().index,r);return(Ts(t)?t:r)[Zt]}(),e})(),I8e=(()=>{var r;class e{}return(r=e).\u0275prov=He({token:r,providedIn:"root",factory:()=>null}),e})();class C8{constructor(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}}const dH=new C8("16.2.0"),RM={};function mH(r,e=null,t=null,n){const i=_H(r,e,t,n);return i.resolveInjectorInitializers(),i}function _H(r,e=null,t=null,n,i=new Set){const s=[t||qn,o8e(r)];return n=n||("object"==typeof r?void 0:a2(r)),new op(s,e||sp(),n||null,i)}let ti=(()=>{var r;class e{static create(n,i){if(Array.isArray(n))return mH({name:""},i,n,"");{const s=n.name??"";return mH({name:s},n.parent,n.providers,s)}}}return(r=e).THROW_IF_NOT_FOUND=Wu,r.NULL=new vM,r.\u0275prov=He({token:r,providedIn:"any",factory:()=>Pe(KD)}),r.__NG_ELEMENT_ID__=-1,e})();function v3(r){return r instanceof Function?r():r}let HM=(()=>{var r;class e{constructor(){this.callbacks=new Set,this.deferredCallbacks=new Set,this.renderDepth=0,this.runningCallbacks=!1}begin(){if(this.runningCallbacks)throw new ge(102,!1);this.renderDepth++}end(){if(this.renderDepth--,0===this.renderDepth)try{this.runningCallbacks=!0;for(const n of this.callbacks)n.invoke()}finally{this.runningCallbacks=!1;for(const n of this.deferredCallbacks)this.callbacks.add(n);this.deferredCallbacks.clear()}}register(n){(this.runningCallbacks?this.deferredCallbacks:this.callbacks).add(n)}unregister(n){this.callbacks.delete(n),this.deferredCallbacks.delete(n)}ngOnDestroy(){this.callbacks.clear(),this.deferredCallbacks.clear()}}return(r=e).\u0275prov=He({token:r,providedIn:"root",factory:()=>new r}),e})();function y7(r){for(;r;){r[Kt]|=64;const e=l7(r);if(wy(r)&&!e)return r;r=e}return null}function VM(r){return r.ngOriginalError}class o6{constructor(){this._console=console}handleError(e){const t=this._findOriginalError(e);this._console.error("ERROR",e),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&VM(e);for(;t&&VM(t);)t=VM(t);return t||null}}const EH=new tt("",{providedIn:"root",factory:()=>!1});class OH extends hz{constructor(){super(...arguments),this.consumerAllowSignalWrites=!1,this._lView=null}set lView(e){this._lView=e}onConsumerDependencyMayHaveChanged(){y7(this._lView)}onProducerUpdateValueVersion(){}get hasReadASignal(){return this.hasProducers}runInContext(e,t,n){const i=T2(this);this.trackingVersion++;try{e(t,n)}finally{T2(i)}}destroy(){this.trackingVersion++}}let gp=null;function bH(){return gp??=new OH,gp}function wH(r,e){return r[e]??bH()}function AH(r,e){const t=bH();t.hasReadASignal&&(r[e]=gp,t.lView=r,gp=new OH)}const Xt={};function _(r){NH(Rn(),Ee(),ts()+r,!1)}function NH(r,e,t,n){if(!n)if(3==(3&e[Kt])){const s=r.preOrderCheckHooks;null!==s&&Nh(e,s,t)}else{const s=r.preOrderHooks;null!==s&&Ih(e,s,0,t)}t6(t)}function B(r,e=an.Default){const t=Ee();return null===t?Pe(r,e):Zz(ei(),t,$t(r),e)}function mp(r,e,t,n,i,s,o,a,c,l,f){const d=e.blueprint.slice();return d[Lr]=i,d[Kt]=140|n,(null!==l||r&&2048&r[Kt])&&(d[Kt]|=2048),Sz(d),d[X1]=d[X0]=r,d[Rr]=t,d[K0]=o||r&&r[K0],d[Zt]=a||r&&r[Zt],d[O4]=c||r&&r[O4]||null,d[Pi]=s,d[Qu]=function s0e(){return i0e++}(),d[h3]=f,d[az]=l,d[zr]=2==e.type?r[zr]:d,d}function E8(r,e,t,n,i){let s=r.data[e];if(null===s)s=FM(r,e,t,n,i),function s6e(){return Vt.lFrame.inI18n}()&&(s.flags|=32);else if(64&s.type){s.type=t,s.value=n,s.attrs=i;const o=e7();s.injectorIndex=null===o?-1:o.injectorIndex}return ac(s,!0),s}function FM(r,e,t,n,i){const s=Az(),o=Ly(),c=r.data[e]=function e5e(r,e,t,n,i,s){let o=e?e.injectorIndex:-1,a=0;return t8()&&(a|=128),{type:t,index:n,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?s:s&&s.parent,t,e,n,i);return null===r.firstChild&&(r.firstChild=c),null!==s&&(o?null==s.child&&null!==c.parent&&(s.child=c):null===s.next&&(s.next=c,c.prev=s)),c}function M7(r,e,t,n){if(0===t)return-1;const i=e.length;for(let s=0;s<t;s++)e.push(n),r.blueprint.push(n),r.data.push(null);return i}function kH(r,e,t,n,i){const s=wH(e,yh),o=ts(),a=2&n;try{if(t6(-1),a&&e.length>pn&&NH(r,e,pn,!1),oc(a?2:0,i),a)s.runInContext(t,n,i);else{const l=T2(null);try{t(n,i)}finally{T2(l)}}}finally{a&&null===e[yh]&&AH(e,yh),t6(o),oc(a?3:1,i)}}function $M(r,e,t){if(by(e)){const n=T2(null);try{const s=e.directiveEnd;for(let o=e.directiveStart;o<s;o++){const a=r.data[o];a.contentQueries&&a.contentQueries(1,t[o],o)}}finally{T2(n)}}}function GM(r,e,t){wz()&&(function a5e(r,e,t,n){const i=t.directiveStart,s=t.directiveEnd;Jl(t)&&function p5e(r,e,t){const n=bs(e,r),i=xH(t);let o=16;t.signals?o=4096:t.onPush&&(o=64);const a=_p(r,mp(r,i,null,o,n,e,null,r[K0].rendererFactory.createRenderer(n,t),null,null,null));r[e.index]=a}(e,t,r.data[i+t.componentOffset]),r.firstCreatePass||xh(t,e),Ti(n,e);const o=t.initialInputs;for(let a=i;a<s;a++){const c=r.data[a],l=n6(e,r,a,t);Ti(l,e),null!==o&&g5e(0,a-i,l,c,0,o),pa(c)&&(Qs(t.index,e)[Rr]=n6(e,r,a,t))}}(r,e,t,bs(t,e)),64==(64&t.flags)&&HH(r,e,t))}function BM(r,e,t=bs){const n=e.localNames;if(null!==n){let i=e.index+1;for(let s=0;s<n.length;s+=2){const o=n[s+1],a=-1===o?t(e,r):r[o];r[i++]=a}}}function xH(r){const e=r.tView;return null===e||e.incompleteFirstPass?r.tView=UM(1,null,r.template,r.decls,r.vars,r.directiveDefs,r.pipeDefs,r.viewQuery,r.schemas,r.consts,r.id):e}function UM(r,e,t,n,i,s,o,a,c,l,f){const d=pn+n,m=d+i,E=function Z8e(r,e){const t=[];for(let n=0;n<e;n++)t.push(n<r?null:Xt);return t}(d,m),w="function"==typeof l?l():l;return E[et]={type:r,blueprint:E,template:t,queries:null,viewQuery:a,declTNode:e,data:E.slice().fill(null,d),bindingStartIndex:d,expandoStartIndex:m,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:c,consts:w,incompleteFirstPass:!1,ssrId:f}}let LH=r=>null;function RH(r,e,t,n){for(let i in r)if(r.hasOwnProperty(i)){t=null===t?{}:t;const s=r[i];null===n?zH(t,e,i,s):n.hasOwnProperty(i)&&zH(t,e,n[i],s)}return t}function zH(r,e,t,n){r.hasOwnProperty(t)?r[t].push(e,n):r[t]=[e,n]}function no(r,e,t,n,i,s,o,a){const c=bs(e,t);let f,l=e.inputs;!a&&null!=l&&(f=l[n])?(YM(r,t,f,n,i),Jl(e)&&function r5e(r,e){const t=Qs(e,r);16&t[Kt]||(t[Kt]|=64)}(t,e.index)):3&e.type&&(n=function n5e(r){return"class"===r?"className":"for"===r?"htmlFor":"formaction"===r?"formAction":"innerHtml"===r?"innerHTML":"readonly"===r?"readOnly":"tabindex"===r?"tabIndex":r}(n),i=null!=o?o(i,e.value||"",n):i,s.setProperty(c,n,i))}function WM(r,e,t,n){if(wz()){const i=null===n?null:{"":-1},s=function l5e(r,e){const t=r.directiveRegistry;let n=null,i=null;if(t)for(let s=0;s<t.length;s++){const o=t[s];if(tz(e,o.selectors,!1))if(n||(n=[]),pa(o))if(null!==o.findHostDirectiveDefs){const a=[];i=i||new Map,o.findHostDirectiveDefs(o,a,i),n.unshift(...a,o),qM(r,e,a.length)}else n.unshift(o),qM(r,e,0);else i=i||new Map,o.findHostDirectiveDefs?.(o,n,i),n.push(o)}return null===n?null:[n,i]}(r,t);let o,a;null===s?o=a=null:[o,a]=s,null!==o&&DH(r,e,t,o,i,a),i&&function u5e(r,e,t){if(e){const n=r.localNames=[];for(let i=0;i<e.length;i+=2){const s=t[e[i+1]];if(null==s)throw new ge(-301,!1);n.push(e[i],s)}}}(t,n,i)}t.mergedAttrs=Zu(t.mergedAttrs,t.attrs)}function DH(r,e,t,n,i,s){for(let l=0;l<n.length;l++)qy(xh(t,e),r,n[l].type);!function d5e(r,e,t){r.flags|=1,r.directiveStart=e,r.directiveEnd=e+t,r.providerIndexes=e}(t,r.data.length,n.length);for(let l=0;l<n.length;l++){const f=n[l];f.providersResolver&&f.providersResolver(f)}let o=!1,a=!1,c=M7(r,e,n.length,null);for(let l=0;l<n.length;l++){const f=n[l];t.mergedAttrs=Zu(t.mergedAttrs,f.hostAttrs),h5e(r,t,e,c,f),f5e(c,f,i),null!==f.contentQueries&&(t.flags|=4),(null!==f.hostBindings||null!==f.hostAttrs||0!==f.hostVars)&&(t.flags|=64);const d=f.type.prototype;!o&&(d.ngOnChanges||d.ngOnInit||d.ngDoCheck)&&((r.preOrderHooks??=[]).push(t.index),o=!0),!a&&(d.ngOnChanges||d.ngDoCheck)&&((r.preOrderCheckHooks??=[]).push(t.index),a=!0),c++}!function t5e(r,e,t){const i=e.directiveEnd,s=r.data,o=e.attrs,a=[];let c=null,l=null;for(let f=e.directiveStart;f<i;f++){const d=s[f],m=t?t.get(d):null,w=m?m.outputs:null;c=RH(d.inputs,f,c,m?m.inputs:null),l=RH(d.outputs,f,l,w);const R=null===c||null===o||ez(e)?null:m5e(c,f,o);a.push(R)}null!==c&&(c.hasOwnProperty("class")&&(e.flags|=8),c.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=c,e.outputs=l}(r,t,s)}function HH(r,e,t){const n=t.directiveStart,i=t.directiveEnd,s=t.index,o=function a6e(){return Vt.lFrame.currentDirectiveIndex}();try{t6(s);for(let a=n;a<i;a++){const c=r.data[a],l=e[a];zy(a),(null!==c.hostBindings||0!==c.hostVars||null!==c.hostAttrs)&&c5e(c,l)}}finally{t6(-1),zy(o)}}function c5e(r,e){null!==r.hostBindings&&r.hostBindings(1,e)}function qM(r,e,t){e.componentOffset=t,(r.components??=[]).push(e.index)}function f5e(r,e,t){if(t){if(e.exportAs)for(let n=0;n<e.exportAs.length;n++)t[e.exportAs[n]]=r;pa(e)&&(t[""]=r)}}function h5e(r,e,t,n,i){r.data[n]=i;const s=i.factory||(i.factory=e6(i.type)),o=new t7(s,pa(i),B);r.blueprint[n]=o,t[n]=o,function s5e(r,e,t,n,i){const s=i.hostBindings;if(s){let o=r.hostBindingOpCodes;null===o&&(o=r.hostBindingOpCodes=[]);const a=~e.index;(function o5e(r){let e=r.length;for(;e>0;){const t=r[--e];if("number"==typeof t&&t<0)return t}return 0})(o)!=a&&o.push(a),o.push(t,n,s)}}(r,e,n,M7(r,t,i.hostVars,Xt),i)}function fc(r,e,t,n,i,s){const o=bs(r,e);jM(e[Zt],o,s,r.value,t,n,i)}function jM(r,e,t,n,i,s,o){if(null==s)r.removeAttribute(e,i,t);else{const a=null==o?jt(s):o(s,n||"",i);r.setAttribute(e,i,a,t)}}function g5e(r,e,t,n,i,s){const o=s[e];if(null!==o)for(let a=0;a<o.length;)VH(n,t,o[a++],o[a++],o[a++])}function VH(r,e,t,n,i){const s=T2(null);try{const o=r.inputTransforms;null!==o&&o.hasOwnProperty(n)&&(i=o[n].call(e,i)),null!==r.setInput?r.setInput(e,i,t,n):e[n]=i}finally{T2(s)}}function m5e(r,e,t){let n=null,i=0;for(;i<t.length;){const s=t[i];if(0!==s)if(5!==s){if("number"==typeof s)break;if(r.hasOwnProperty(s)){null===n&&(n=[]);const o=r[s];for(let a=0;a<o.length;a+=2)if(o[a]===e){n.push(s,o[a+1],t[i+1]);break}}i+=2}else i+=2;else i+=4}return n}function FH(r,e,t,n){return[r,!0,!1,e,null,0,n,t,null,null,null]}function $H(r,e){const t=r.contentQueries;if(null!==t)for(let n=0;n<t.length;n+=2){const s=t[n+1];if(-1!==s){const o=r.data[s];Hy(t[n]),o.contentQueries(2,e[s],s)}}}function _p(r,e){return r[Ku]?r[oz][ha]=e:r[Ku]=e,r[oz]=e,e}function ZM(r,e,t){Hy(0);const n=T2(null);try{e(r,t)}finally{T2(n)}}function GH(r){return r[Y0]||(r[Y0]=[])}function BH(r){return r.cleanup||(r.cleanup=[])}function WH(r,e){const t=r[O4],n=t?t.get(o6,null):null;n&&n.handleError(e)}function YM(r,e,t,n,i){for(let s=0;s<t.length;){const o=t[s++],a=t[s++];VH(r.data[o],e[o],n,a,i)}}function C3(r,e,t){const n=bh(e,r);PD(r[Zt],n,t)}function _5e(r,e){const t=Qs(e,r),n=t[et];!function v5e(r,e){for(let t=e.length;t<r.blueprint.length;t++)e.push(r.blueprint[t])}(n,t);const i=t[Lr];null!==i&&null===t[h3]&&(t[h3]=kM(i,t[O4])),KM(n,t,t[Rr])}function KM(r,e,t){Vy(e);try{const n=r.viewQuery;null!==n&&ZM(1,n,t);const i=r.template;null!==i&&kH(r,e,i,1,t),r.firstCreatePass&&(r.firstCreatePass=!1),r.staticContentQueries&&$H(r,e),r.staticViewQueries&&ZM(2,r.viewQuery,t);const s=r.components;null!==s&&function C5e(r,e){for(let t=0;t<e.length;t++)_5e(r,e[t])}(e,s)}catch(n){throw r.firstCreatePass&&(r.incompleteFirstPass=!0,r.firstCreatePass=!1),n}finally{e[Kt]&=-5,Fy()}}let qH=(()=>{var r;class e{constructor(){this.all=new Set,this.queue=new Map}create(n,i,s){const o=typeof Zone>"u"?null:Zone.current,a=new Dle(n,f=>{this.all.has(f)&&this.queue.set(f,o)},s);let c;this.all.add(a),a.notify();const l=()=>{a.cleanup(),c?.(),this.all.delete(a),this.queue.delete(a)};return c=i?.onDestroy(l),{destroy:l}}flush(){if(0!==this.queue.size)for(const[n,i]of this.queue)this.queue.delete(n),i?i.run(()=>n.run()):n.run()}get isQueueEmpty(){return 0===this.queue.size}}return(r=e).\u0275prov=He({token:r,providedIn:"root",factory:()=>new r}),e})();function vp(r,e,t){let n=t?r.styles:null,i=t?r.classes:null,s=0;if(null!==e)for(let o=0;o<e.length;o++){const a=e[o];"number"==typeof a?s=a:1==s?i=uy(i,a):2==s&&(n=uy(n,a+": "+e[++o]+";"))}t?r.styles=n:r.stylesWithoutHost=n,t?r.classes=i:r.classesWithoutHost=i}function E7(r,e,t,n,i=!1){for(;null!==t;){const s=e[t.index];if(null!==s&&n.push(A1(s)),Os(s)){for(let a=J2;a<s.length;a++){const c=s[a],l=c[et].firstChild;null!==l&&E7(c[et],c,l,n)}s[ic]!==s[Lr]&&n.push(s[ic])}const o=t.type;if(8&o)E7(r,e,t.child,n);else if(32&o){const a=iM(t,e);let c;for(;c=a();)n.push(c)}else if(16&o){const a=xD(e,t);if(Array.isArray(a))n.push(...a);else{const c=l7(e[zr]);E7(c[et],c,a,n,!0)}}t=i?t.projectionNext:t.next}return n}function Cp(r,e,t,n=!0){const i=e[K0],s=i.rendererFactory,o=i.afterRenderEventManager;s.begin?.(),o?.begin();try{jH(r,e,r.template,t)}catch(c){throw n&&WH(e,c),c}finally{s.end?.(),i.effectManager?.flush(),o?.end()}}function jH(r,e,t,n){const i=e[Kt];if(256!=(256&i)){e[K0].effectManager?.flush(),Vy(e);try{Sz(e),function Iz(r){return Vt.lFrame.bindingIndex=r}(r.bindingStartIndex),null!==t&&kH(r,e,t,2,n);const o=3==(3&i);if(o){const l=r.preOrderCheckHooks;null!==l&&Nh(e,l,null)}else{const l=r.preOrderHooks;null!==l&&Ih(e,l,0,null),$y(e,0)}if(function E5e(r){for(let e=MD(r);null!==e;e=ED(e)){if(!e[cz])continue;const t=e[J0];for(let n=0;n<t.length;n++){Zle(t[n])}}}(e),ZH(e,2),null!==r.contentQueries&&$H(r,e),o){const l=r.contentCheckHooks;null!==l&&Nh(e,l)}else{const l=r.contentHooks;null!==l&&Ih(e,l,1),$y(e,1)}!function j8e(r,e){const t=r.hostBindingOpCodes;if(null===t)return;const n=wH(e,Mh);try{for(let i=0;i<t.length;i++){const s=t[i];if(s<0)t6(~s);else{const o=s,a=t[++i],c=t[++i];o6e(a,o),n.runInContext(c,2,e[o])}}}finally{null===e[Mh]&&AH(e,Mh),t6(-1)}}(r,e);const a=r.components;null!==a&&KH(e,a,0);const c=r.viewQuery;if(null!==c&&ZM(2,c,n),o){const l=r.viewCheckHooks;null!==l&&Nh(e,l)}else{const l=r.viewHooks;null!==l&&Ih(e,l,2),$y(e,2)}!0===r.firstUpdatePass&&(r.firstUpdatePass=!1),e[Kt]&=-73,Pz(e)}finally{Fy()}}}function ZH(r,e){for(let t=MD(r);null!==t;t=ED(t))for(let n=J2;n<t.length;n++)YH(t[n],e)}function S5e(r,e,t){YH(Qs(e,r),t)}function YH(r,e){if(!function qle(r){return 128==(128&r[Kt])}(r))return;const t=r[et];if(80&r[Kt]&&0===e||1024&r[Kt]||2===e)jH(t,r,t.template,r[Rr]);else if(r[Yu]>0){ZH(r,1);const i=r[et].components;null!==i&&KH(r,i,1)}}function KH(r,e,t){for(let n=0;n<e.length;n++)S5e(r,e[n],t)}class S7{get rootNodes(){const e=this._lView,t=e[et];return E7(t,e,t.firstChild,[])}constructor(e,t){this._lView=e,this._cdRefInjectingView=t,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Rr]}set context(e){this._lView[Rr]=e}get destroyed(){return 256==(256&this._lView[Kt])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[X1];if(Os(e)){const t=e[8],n=t?t.indexOf(this):-1;n>-1&&(Zh(e,n),Dh(t,n))}this._attachedToViewContainer=!1}oM(this._lView[et],this._lView)}onDestroy(e){!function Oz(r,e){if(256==(256&r[Kt]))throw new ge(911,!1);null===r[b4]&&(r[b4]=[]),r[b4].push(e)}(this._lView,e)}markForCheck(){y7(this._cdRefInjectingView||this._lView)}detach(){this._lView[Kt]&=-129}reattach(){this._lView[Kt]|=128}detectChanges(){Cp(this._lView[et],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new ge(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function C0e(r,e){f7(r,e,e[Zt],2,null,null)}(this._lView[et],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new ge(902,!1);this._appRef=e}}class P5e extends S7{constructor(e){super(e),this._view=e}detectChanges(){const e=this._view;Cp(e[et],e,e[Rr],!1)}checkNoChanges(){}get context(){return null}}class XH extends hp{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const t=Ln(e);return new P7(t,this.ngModule)}}function QH(r){const e=[];for(let t in r)r.hasOwnProperty(t)&&e.push({propName:r[t],templateName:t});return e}class O5e{constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,n){n=mh(n);const i=this.injector.get(e,RM,n);return i!==RM||t===RM?i:this.parentInjector.get(e,t,n)}}class P7 extends uH{get inputs(){const e=this.componentDef,t=e.inputTransforms,n=QH(e.inputs);if(null!==t)for(const i of n)t.hasOwnProperty(i.propName)&&(i.transform=t[i.propName]);return n}get outputs(){return QH(this.componentDef.outputs)}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=function Cle(r){return r.map(vle).join(",")}(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}create(e,t,n,i){let s=(i=i||this.ngModule)instanceof to?i:i?.injector;s&&null!==this.componentDef.getStandaloneInjector&&(s=this.componentDef.getStandaloneInjector(s)||s);const o=s?new O5e(e,s):e,a=o.get(C7,null);if(null===a)throw new ge(407,!1);const d={rendererFactory:a,sanitizer:o.get(I8e,null),effectManager:o.get(qH,null),afterRenderEventManager:o.get(HM,null)},m=a.createRenderer(null,this.componentDef),E=this.componentDef.selectors[0][0]||"div",w=n?function Y8e(r,e,t,n){const s=n.get(EH,!1)||t===bo.ShadowDom,o=r.selectRootElement(e,s);return function K8e(r){LH(r)}(o),o}(m,n,this.componentDef.encapsulation,o):jh(m,E,function T5e(r){const e=r.toLowerCase();return"svg"===e?yz:"math"===e?"math":null}(E)),$=this.componentDef.signals?4608:this.componentDef.onPush?576:528;let G=null;null!==w&&(G=kM(w,o,!0));const de=UM(0,null,null,1,0,null,null,null,null,null,null),ve=mp(null,de,null,$,null,null,d,m,o,null,G);let Le,nt;Vy(ve);try{const gt=this.componentDef;let vn,Et=null;gt.findHostDirectiveDefs?(vn=[],Et=new Map,gt.findHostDirectiveDefs(gt,vn,Et),vn.push(gt)):vn=[gt];const Z2=function w5e(r,e){const t=r[et],n=pn;return r[n]=e,E8(t,n,2,"#host",null)}(ve,w),F0=function A5e(r,e,t,n,i,s,o){const a=i[et];!function N5e(r,e,t,n){for(const i of r)e.mergedAttrs=Zu(e.mergedAttrs,i.hostAttrs);null!==e.mergedAttrs&&(vp(e,e.mergedAttrs,!0),null!==t&&DD(n,t,e))}(n,r,e,o);let c=null;null!==e&&(c=kM(e,i[O4]));const l=s.rendererFactory.createRenderer(e,t);let f=16;t.signals?f=4096:t.onPush&&(f=64);const d=mp(i,xH(t),null,f,i[r.index],r,s,l,null,null,c);return a.firstCreatePass&&qM(a,r,n.length-1),_p(i,d),i[r.index]=d}(Z2,w,gt,vn,ve,d,m);nt=Ez(de,pn),w&&function k5e(r,e,t,n){if(n)Py(r,t,["ng-version",dH.full]);else{const{attrs:i,classes:s}=function yle(r){const e=[],t=[];let n=1,i=2;for(;n<r.length;){let s=r[n];if("string"==typeof s)2===i?""!==s&&e.push(s,r[++n]):8===i&&t.push(s);else{if(!da(i))break;i=s}n++}return{attrs:e,classes:t}}(e.selectors[0]);i&&Py(r,t,i),s&&s.length>0&&zD(r,t,s.join(" "))}}(m,gt,w,n),void 0!==t&&function x5e(r,e,t){const n=r.projection=[];for(let i=0;i<e.length;i++){const s=t[i];n.push(null!=s?Array.from(s):null)}}(nt,this.ngContentSelectors,t),Le=function I5e(r,e,t,n,i,s){const o=ei(),a=i[et],c=bs(o,i);DH(a,i,o,t,null,n);for(let f=0;f<t.length;f++)Ti(n6(i,a,o.directiveStart+f,o),i);HH(a,i,o),c&&Ti(c,i);const l=n6(i,a,o.directiveStart+o.componentOffset,o);if(r[Rr]=i[Rr]=l,null!==s)for(const f of s)f(l,e);return $M(a,o,r),l}(F0,gt,vn,Et,ve,[L5e]),KM(de,ve,null)}finally{Fy()}return new b5e(this.componentType,Le,v8(nt,ve),ve,nt)}}class b5e extends T8e{constructor(e,t,n,i,s){super(),this.location=n,this._rootLView=i,this._tNode=s,this.previousInputValues=null,this.instance=t,this.hostView=this.changeDetectorRef=new P5e(i),this.componentType=e}setInput(e,t){const n=this._tNode.inputs;let i;if(null!==n&&(i=n[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;const s=this._rootLView;YM(s[et],s,i,e,t),this.previousInputValues.set(e,t),y7(Qs(this._tNode.index,s))}}get injector(){return new ns(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}function L5e(){const r=ei();Ah(Ee()[et],r)}function Qe(r){let e=function JH(r){return Object.getPrototypeOf(r.prototype).constructor}(r.type),t=!0;const n=[r];for(;e;){let i;if(pa(r))i=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new ge(903,!1);i=e.\u0275dir}if(i){if(t){n.push(i);const o=r;o.inputs=yp(r.inputs),o.inputTransforms=yp(r.inputTransforms),o.declaredInputs=yp(r.declaredInputs),o.outputs=yp(r.outputs);const a=i.hostBindings;a&&H5e(r,a);const c=i.viewQuery,l=i.contentQueries;if(c&&z5e(r,c),l&&D5e(r,l),uh(r.inputs,i.inputs),uh(r.declaredInputs,i.declaredInputs),uh(r.outputs,i.outputs),null!==i.inputTransforms&&(null===o.inputTransforms&&(o.inputTransforms={}),uh(o.inputTransforms,i.inputTransforms)),pa(i)&&i.data.animation){const f=r.data;f.animation=(f.animation||[]).concat(i.data.animation)}}const s=i.features;if(s)for(let o=0;o<s.length;o++){const a=s[o];a&&a.ngInherit&&a(r),a===Qe&&(t=!1)}}e=Object.getPrototypeOf(e)}!function R5e(r){let e=0,t=null;for(let n=r.length-1;n>=0;n--){const i=r[n];i.hostVars=e+=i.hostVars,i.hostAttrs=Zu(i.hostAttrs,t=Zu(t,i.hostAttrs))}}(n)}function yp(r){return r===nc?{}:r===qn?[]:r}function z5e(r,e){const t=r.viewQuery;r.viewQuery=t?(n,i)=>{e(n,i),t(n,i)}:e}function D5e(r,e){const t=r.contentQueries;r.contentQueries=t?(n,i,s)=>{e(n,i,s),t(n,i,s)}:e}function H5e(r,e){const t=r.hostBindings;r.hostBindings=t?(n,i)=>{e(n,i),t(n,i)}:e}function rV(r){const e=r.inputConfig,t={};for(const n in e)if(e.hasOwnProperty(n)){const i=e[n];Array.isArray(i)&&i[2]&&(t[n]=i[2])}r.inputTransforms=t}function Mp(r){return!!XM(r)&&(Array.isArray(r)||!(r instanceof Map)&&Symbol.iterator in r)}function XM(r){return null!==r&&("function"==typeof r||"object"==typeof r)}function dc(r,e,t){return r[e]=t}function bi(r,e,t){return!Object.is(r[e],t)&&(r[e]=t,!0)}function a6(r,e,t,n){const i=bi(r,e,t);return bi(r,e+1,n)||i}function I(r,e,t,n){const i=Ee();return bi(i,n8(),e)&&(Rn(),fc(sr(),i,r,e,t,n)),I}function P8(r,e,t,n){return bi(r,n8(),t)?e+jt(t)+n:Xt}function T8(r,e,t,n,i,s){const a=a6(r,p3(),t,i);return g3(2),a?e+jt(t)+n+jt(i)+s:Xt}function O8(r,e,t,n,i,s,o,a){const l=function Ep(r,e,t,n,i){const s=a6(r,e,t,n);return bi(r,e+2,i)||s}(r,p3(),t,i,o);return g3(3),l?e+jt(t)+n+jt(i)+s+jt(o)+a:Xt}function c6(r,e,t,n,i,s){const o=Ee(),a=P8(o,e,t,n);return a!==Xt&&fc(sr(),o,r,a,i,s),c6}function T(r,e,t,n,i,s,o,a){const c=Ee(),l=Rn(),f=r+pn,d=l.firstCreatePass?function lue(r,e,t,n,i,s,o,a,c){const l=e.consts,f=E8(e,r,4,o||null,w4(l,a));WM(e,t,f,w4(l,c)),Ah(e,f);const d=f.tView=UM(2,f,n,i,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,l,null);return null!==e.queries&&(e.queries.template(e,f),d.queries=e.queries.embeddedTView(f)),f}(f,l,c,e,t,n,i,s,o):l.data[f];ac(d,!1);const m=gV(l,c,d,r);wh()&&Kh(l,c,m,d),Ti(m,c),_p(c,c[f]=FH(m,c,m,d)),Sh(d)&&GM(l,c,d),null!=o&&BM(c,d,a)}let gV=function mV(r,e,t,n){return A4(!0),e[Zt].createComment("")};function cn(r){return e8(function i6e(){return Vt.lFrame.contextLView}(),pn+r)}function y(r,e,t){const n=Ee();return bi(n,n8(),e)&&no(Rn(),sr(),n,r,e,n[Zt],t,!1),y}function rE(r,e,t,n,i){const o=i?"class":"style";YM(r,t,e.inputs[o],o,n)}function S(r,e,t,n){const i=Ee(),s=Rn(),o=pn+r,a=i[Zt],c=s.firstCreatePass?function hue(r,e,t,n,i,s){const o=e.consts,c=E8(e,r,2,n,w4(o,i));return WM(e,t,c,w4(o,s)),null!==c.attrs&&vp(c,c.attrs,!1),null!==c.mergedAttrs&&vp(c,c.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,c),c}(o,s,i,e,t,n):s.data[o],l=_V(s,i,c,a,e,r);i[o]=l;const f=Sh(c);return ac(c,!0),DD(a,l,c),32!=(32&c.flags)&&wh()&&Kh(s,i,l,c),0===function Kle(){return Vt.lFrame.elementDepthCount}()&&Ti(l,i),function Xle(){Vt.lFrame.elementDepthCount++}(),f&&(GM(s,i,c),$M(s,c,i)),null!==n&&BM(i,c),S}function P(){let r=ei();Ly()?Ry():(r=r.parent,ac(r,!1));const e=r;(function Jle(r){return Vt.skipHydrationRootTNode===r})(e)&&function r6e(){Vt.skipHydrationRootTNode=null}(),function Qle(){Vt.lFrame.elementDepthCount--}();const t=Rn();return t.firstCreatePass&&(Ah(t,r),by(r)&&t.queries.elementEnd(r)),null!=e.classesWithoutHost&&function _6e(r){return 0!=(8&r.flags)}(e)&&rE(t,e,Ee(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function v6e(r){return 0!=(16&r.flags)}(e)&&rE(t,e,Ee(),e.stylesWithoutHost,!1),P}function F(r,e,t,n){return S(r,e,t,n),P(),F}let _V=(r,e,t,n,i,s)=>(A4(!0),jh(n,i,function Vz(){return Vt.lFrame.currentNamespace}()));function Gt(r,e,t){const n=Ee(),i=Rn(),s=r+pn,o=i.firstCreatePass?function mue(r,e,t,n,i){const s=e.consts,o=w4(s,n),a=E8(e,r,8,"ng-container",o);return null!==o&&vp(a,o,!0),WM(e,t,a,w4(s,i)),null!==e.queries&&e.queries.elementStart(e,a),a}(s,i,n,e,t):i.data[s];ac(o,!0);const a=CV(i,n,o,r);return n[s]=a,wh()&&Kh(i,n,a,o),Ti(a,n),Sh(o)&&(GM(i,n,o),$M(i,o,n)),null!=t&&BM(n,o),Gt}function Bt(){let r=ei();const e=Rn();return Ly()?Ry():(r=r.parent,ac(r,!1)),e.firstCreatePass&&(Ah(e,r),by(r)&&e.queries.elementEnd(r)),Bt}let CV=(r,e,t,n)=>(A4(!0),sM(e[Zt],""));function pe(){return Ee()}function A7(r){return!!r&&"function"==typeof r.then}function yV(r){return!!r&&"function"==typeof r.subscribe}function W(r,e,t,n){const i=Ee(),s=Rn(),o=ei();return function EV(r,e,t,n,i,s,o){const a=Sh(n),l=r.firstCreatePass&&BH(r),f=e[Rr],d=GH(e);let m=!0;if(3&n.type||o){const R=bs(n,e),z=o?o(R):R,$=d.length,G=o?ve=>o(A1(ve[n.index])):n.index;let de=null;if(!o&&a&&(de=function Cue(r,e,t,n){const i=r.cleanup;if(null!=i)for(let s=0;s<i.length-1;s+=2){const o=i[s];if(o===t&&i[s+1]===n){const a=e[Y0],c=i[s+2];return a.length>c?a[c]:null}"string"==typeof o&&(s+=2)}return null}(r,e,i,n.index)),null!==de)(de.__ngLastListenerFn__||de).__ngNextListenerFn__=s,de.__ngLastListenerFn__=s,m=!1;else{s=PV(n,e,f,s,!1);const ve=t.listen(z,i,s);d.push(s,ve),l&&l.push(i,G,$,$+1)}}else s=PV(n,e,f,s,!1);const E=n.outputs;let w;if(m&&null!==E&&(w=E[i])){const R=w.length;if(R)for(let z=0;z<R;z+=2){const Le=e[w[z]][w[z+1]].subscribe(s),nt=d.length;d.push(s,Le),l&&l.push(i,n.index,nt,-(nt+1))}}}(s,i,i[Zt],o,r,e,n),W}function SV(r,e,t,n){try{return oc(6,e,t),!1!==t(n)}catch(i){return WH(r,i),!1}finally{oc(7,e,t)}}function PV(r,e,t,n,i){return function s(o){if(o===Function)return n;y7(r.componentOffset>-1?Qs(r.index,e):e);let c=SV(e,t,n,o),l=s.__ngNextListenerFn__;for(;l;)c=SV(e,t,l,o)&&c,l=l.__ngNextListenerFn__;return i&&!1===c&&o.preventDefault(),c}}function p(r=1){return function l6e(r){return(Vt.lFrame.contextLView=function u6e(r,e){for(;r>0;)e=e[X0],r--;return e}(r,Vt.lFrame.contextLView))[Rr]}(r)}function yue(r,e){let t=null;const n=function ple(r){const e=r.attrs;if(null!=e){const t=e.indexOf(5);if(!(1&t))return e[t+1]}return null}(r);for(let i=0;i<e.length;i++){const s=e[i];if("*"!==s){if(null===n?tz(r,s,!0):_le(n,s))return i}else t=i}return t}function zn(r,e,t,n,i){const s=Ee(),o=P8(s,e,t,n);return o!==Xt&&no(Rn(),sr(),s,r,o,s[Zt],i,!1),zn}function ye(r,e,t,n,i,s,o){const a=Ee(),c=T8(a,e,t,n,i,s);return c!==Xt&&no(Rn(),sr(),a,r,c,a[Zt],o,!1),ye}function wi(r,e,t,n,i,s,o,a,c){const l=Ee(),f=O8(l,e,t,n,i,s,o,a);return f!==Xt&&no(Rn(),sr(),l,r,f,l[Zt],c,!1),wi}function Op(r,e){return r<<17|e<<2}function I4(r){return r>>17&32767}function iE(r){return 2|r}function l6(r){return(131068&r)>>2}function sE(r,e){return-131069&r|e<<2}function oE(r){return 1|r}function LV(r,e,t,n,i){const s=r[t+1],o=null===e;let a=n?I4(s):l6(s),c=!1;for(;0!==a&&(!1===c||o);){const f=r[a+1];Oue(r[a],e)&&(c=!0,r[a+1]=n?oE(f):iE(f)),a=n?I4(f):l6(f)}c&&(r[t+1]=n?iE(s):oE(s))}function Oue(r,e){return null===r||null==e||(Array.isArray(r)?r[1]:r)===e||!(!Array.isArray(r)||"string"!=typeof e)&&u8(r,e)>=0}const l2={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function RV(r){return r.substring(l2.key,l2.keyEnd)}function bue(r){return r.substring(l2.value,l2.valueEnd)}function DV(r,e){const t=l2.textEnd;let n=l2.key=k8(r,e,t);return t===n?-1:(n=l2.keyEnd=function Iue(r,e,t){let n;for(;e<t&&(45===(n=r.charCodeAt(e))||95===n||(-33&n)>=65&&(-33&n)<=90||n>=48&&n<=57);)e++;return e}(r,n,t),n=VV(r,n,t),n=l2.value=k8(r,n,t),n=l2.valueEnd=function kue(r,e,t){let n=-1,i=-1,s=-1,o=e,a=o;for(;o<t;){const c=r.charCodeAt(o++);if(59===c)return a;34===c||39===c?a=o=FV(r,c,o,t):e===o-4&&85===s&&82===i&&76===n&&40===c?a=o=FV(r,41,o,t):c>32&&(a=o),s=i,i=n,n=-33&c}return a}(r,n,t),VV(r,n,t))}function k8(r,e,t){for(;e<t&&r.charCodeAt(e)<=32;)e++;return e}function VV(r,e,t,n){return(e=k8(r,e,t))<t&&e++,e}function FV(r,e,t,n){let i=-1,s=t;for(;s<n;){const o=r.charCodeAt(s++);if(o==e&&92!==i)return s;i=92==o&&92===i?0:o}throw new Error}function bp(r,e){return function ga(r,e,t,n){const i=Ee(),s=Rn(),o=g3(2);s.firstUpdatePass&&BV(s,r,o,n),e!==Xt&&bi(i,o,e)&&WV(s,s.data[ts()],i,i[Zt],r,i[o+1]=function Gue(r,e){return null==r||""===r||("string"==typeof e?r+=e:"object"==typeof r&&(r=a2(eo(r)))),r}(e,t),n,o)}(r,e,null,!0),bp}function ni(r){!function ma(r,e,t,n){const i=Rn(),s=g3(2);i.firstUpdatePass&&BV(i,null,s,n);const o=Ee();if(t!==Xt&&bi(o,s,t)){const a=i.data[ts()];if(jV(a,n)&&!GV(i,s)){let c=n?a.classesWithoutHost:a.stylesWithoutHost;null!==c&&(t=uy(c,t||"")),rE(i,a,o,t,n)}else!function $ue(r,e,t,n,i,s,o,a){i===Xt&&(i=qn);let c=0,l=0,f=0<i.length?i[0]:null,d=0<s.length?s[0]:null;for(;null!==f||null!==d;){const m=c<i.length?i[c+1]:void 0,E=l<s.length?s[l+1]:void 0;let R,w=null;f===d?(c+=2,l+=2,m!==E&&(w=d,R=E)):null===d||null!==f&&f<d?(c+=2,w=f):(l+=2,w=d,R=E),null!==w&&WV(r,e,t,n,w,R,o,a),f=c<i.length?i[c]:null,d=l<s.length?s[l]:null}}(i,a,o,o[Zt],o[s+1],o[s+1]=function Vue(r,e,t){if(null==t||""===t)return qn;const n=[],i=eo(t);if(Array.isArray(i))for(let s=0;s<i.length;s++)r(n,i[s],!0);else if("object"==typeof i)for(const s in i)i.hasOwnProperty(s)&&r(n,s,i[s]);else"string"==typeof i&&e(n,i);return n}(r,e,t),n,s)}}(UV,xue,r,!1)}function xue(r,e){for(let t=function Aue(r){return function HV(r){l2.key=0,l2.keyEnd=0,l2.value=0,l2.valueEnd=0,l2.textEnd=r.length}(r),DV(r,k8(r,0,l2.textEnd))}(e);t>=0;t=DV(e,t))UV(r,RV(e),bue(e))}function GV(r,e){return e>=r.expandoStartIndex}function BV(r,e,t,n){const i=r.data;if(null===i[t+1]){const s=i[ts()],o=GV(r,t);jV(s,n)&&null===e&&!o&&(e=!1),e=function Rue(r,e,t,n){const i=function Dy(r){const e=Vt.lFrame.currentDirectiveIndex;return-1===e?null:r[e]}(r);let s=n?e.residualClasses:e.residualStyles;if(null===i)0===(n?e.classBindings:e.styleBindings)&&(t=N7(t=aE(null,r,e,t,n),e.attrs,n),s=null);else{const o=e.directiveStylingLast;if(-1===o||r[o]!==i)if(t=aE(i,r,e,t,n),null===s){let c=function zue(r,e,t){const n=t?e.classBindings:e.styleBindings;if(0!==l6(n))return r[I4(n)]}(r,e,n);void 0!==c&&Array.isArray(c)&&(c=aE(null,r,e,c[1],n),c=N7(c,e.attrs,n),function Due(r,e,t,n){r[I4(t?e.classBindings:e.styleBindings)]=n}(r,e,n,c))}else s=function Hue(r,e,t){let n;const i=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<i;s++)n=N7(n,r[s].hostAttrs,t);return N7(n,e.attrs,t)}(r,e,n)}return void 0!==s&&(n?e.residualClasses=s:e.residualStyles=s),t}(i,s,e,n),function Pue(r,e,t,n,i,s){let o=s?e.classBindings:e.styleBindings,a=I4(o),c=l6(o);r[n]=t;let f,l=!1;if(Array.isArray(t)?(f=t[1],(null===f||u8(t,f)>0)&&(l=!0)):f=t,i)if(0!==c){const m=I4(r[a+1]);r[n+1]=Op(m,a),0!==m&&(r[m+1]=sE(r[m+1],n)),r[a+1]=function Eue(r,e){return 131071&r|e<<17}(r[a+1],n)}else r[n+1]=Op(a,0),0!==a&&(r[a+1]=sE(r[a+1],n)),a=n;else r[n+1]=Op(c,0),0===a?a=n:r[c+1]=sE(r[c+1],n),c=n;l&&(r[n+1]=iE(r[n+1])),LV(r,f,n,!0),LV(r,f,n,!1),function Tue(r,e,t,n,i){const s=i?r.residualClasses:r.residualStyles;null!=s&&"string"==typeof e&&u8(s,e)>=0&&(t[n+1]=oE(t[n+1]))}(e,f,r,n,s),o=Op(a,c),s?e.classBindings=o:e.styleBindings=o}(i,s,e,t,o,n)}}function aE(r,e,t,n,i){let s=null;const o=t.directiveEnd;let a=t.directiveStylingLast;for(-1===a?a=t.directiveStart:a++;a<o&&(s=e[a],n=N7(n,s.hostAttrs,i),s!==r);)a++;return null!==r&&(t.directiveStylingLast=a),n}function N7(r,e,t){const n=t?1:2;let i=-1;if(null!==e)for(let s=0;s<e.length;s++){const o=e[s];"number"==typeof o?i=o:i===n&&(Array.isArray(r)||(r=void 0===r?[]:["",r]),Js(r,o,!!t||e[++s]))}return void 0===r?null:r}function UV(r,e,t){Js(r,e,eo(t))}function WV(r,e,t,n,i,s,o,a){if(!(3&e.type))return;const c=r.data,l=c[a+1],f=function Sue(r){return 1==(1&r)}(l)?qV(c,e,t,i,l6(l),o):void 0;wp(f)||(wp(s)||function Mue(r){return 2==(2&r)}(l)&&(s=qV(c,null,t,i,a,o)),function A0e(r,e,t,n,i){if(e)i?r.addClass(t,n):r.removeClass(t,n);else{let s=-1===n.indexOf("-")?void 0:N4.DashCase;null==i?r.removeStyle(t,n,s):("string"==typeof i&&i.endsWith("!important")&&(i=i.slice(0,-10),s|=N4.Important),r.setStyle(t,n,i,s))}}(n,o,bh(ts(),t),i,s))}function qV(r,e,t,n,i,s){const o=null===e;let a;for(;i>0;){const c=r[i],l=Array.isArray(c),f=l?c[1]:c,d=null===f;let m=t[i+1];m===Xt&&(m=d?qn:void 0);let E=d?Yy(m,n):f===n?m:void 0;if(l&&!wp(E)&&(E=Yy(c,n)),wp(E)&&(a=E,o))return a;const w=r[i+1];i=o?I4(w):l6(w)}if(null!==e){let c=s?e.residualClasses:e.residualStyles;null!=c&&(a=Yy(c,n))}return a}function wp(r){return void 0!==r}function jV(r,e){return 0!=(r.flags&(e?8:16))}function lt(r,e=""){const t=Ee(),n=Rn(),i=r+pn,s=n.firstCreatePass?E8(n,i,1,e,null):n.data[i],o=ZV(n,t,s,e,r);t[i]=o,wh()&&Kh(n,t,o,s),ac(s,!1)}let ZV=(r,e,t,n,i)=>(A4(!0),qh(e[Zt],n));function An(r){return O2("",r,""),An}function O2(r,e,t){const n=Ee(),i=P8(n,r,e,t);return i!==Xt&&C3(n,ts(),i),O2}function cE(r,e,t,n,i){const s=Ee(),o=T8(s,r,e,t,n,i);return o!==Xt&&C3(s,ts(),o),cE}function lE(r,e,t,n,i,s,o){const a=Ee(),c=O8(a,r,e,t,n,i,s,o);return c!==Xt&&C3(a,ts(),c),lE}function uE(r,e,t){const n=Ee();return bi(n,n8(),e)&&no(Rn(),sr(),n,r,e,n[Zt],t,!0),uE}const u6=void 0;var u7e=["en",[["a","p"],["AM","PM"],u6],[["AM","PM"],u6,u6],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],u6,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],u6,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",u6,"{1} 'at' {0}",u6],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function l7e(r){const t=Math.floor(Math.abs(r)),n=r.toString().replace(/^[^.]*\.?/,"").length;return 1===t&&0===n?1:5}];let x8={};function is(r){const e=function d7e(r){return r.toLowerCase().replace(/_/g,"-")}(r);let t=dF(e);if(t)return t;const n=e.split("-")[0];if(t=dF(n),t)return t;if("en"===n)return u7e;throw new ge(701,!1)}function dF(r){return r in x8||(x8[r]=C1.ng&&C1.ng.common&&C1.ng.common.locales&&C1.ng.common.locales[r]),x8[r]}var N1=function(r){return r[r.LocaleId=0]="LocaleId",r[r.DayPeriodsFormat=1]="DayPeriodsFormat",r[r.DayPeriodsStandalone=2]="DayPeriodsStandalone",r[r.DaysFormat=3]="DaysFormat",r[r.DaysStandalone=4]="DaysStandalone",r[r.MonthsFormat=5]="MonthsFormat",r[r.MonthsStandalone=6]="MonthsStandalone",r[r.Eras=7]="Eras",r[r.FirstDayOfWeek=8]="FirstDayOfWeek",r[r.WeekendRange=9]="WeekendRange",r[r.DateFormat=10]="DateFormat",r[r.TimeFormat=11]="TimeFormat",r[r.DateTimeFormat=12]="DateTimeFormat",r[r.NumberSymbols=13]="NumberSymbols",r[r.NumberFormats=14]="NumberFormats",r[r.CurrencyCode=15]="CurrencyCode",r[r.CurrencySymbol=16]="CurrencySymbol",r[r.CurrencyName=17]="CurrencyName",r[r.Currencies=18]="Currencies",r[r.Directionality=19]="Directionality",r[r.PluralCase=20]="PluralCase",r[r.ExtraData=21]="ExtraData",r}(N1||{});const h7e=["zero","one","two","few","many"],L8="en-US",Ap={marker:"element"},Np={marker:"ICU"};var As=function(r){return r[r.SHIFT=2]="SHIFT",r[r.APPEND_EAGERLY=1]="APPEND_EAGERLY",r[r.COMMENT=2]="COMMENT",r}(As||{});let hF=L8;function pF(r){(function Oo(r,e){null==r&&Ht(e,r,null,"!=")})(r,"Expected localeId to be defined"),"string"==typeof r&&(hF=r.toLowerCase().replace(/_/g,"-"))}function gF(r,e,t){const n=e.insertBeforeIndex,i=Array.isArray(n)?n[0]:n;return null===i?ND(r,0,t):A1(t[i])}function mF(r,e,t,n,i){const s=e.insertBeforeIndex;if(Array.isArray(s)){let o=n,a=null;if(3&e.type||(a=o,o=i),null!==o&&-1===e.componentOffset)for(let c=1;c<s.length;c++)r6(r,o,t[s[c]],a,!1)}}function _F(r,e){if(r.push(e),r.length>1)for(let t=r.length-2;t>=0;t--){const n=r[t];vF(n)||_7e(n,e)&&null===v7e(n)&&C7e(n,e.index)}}function vF(r){return!(64&r.type)}function _7e(r,e){return vF(e)||r.index>e.index}function v7e(r){const e=r.insertBeforeIndex;return Array.isArray(e)?e[0]:e}function C7e(r,e){const t=r.insertBeforeIndex;Array.isArray(t)?t[0]=e:(kD(gF,mF),r.insertBeforeIndex=e)}function I7(r,e){const t=r.data[e];return null===t||"string"==typeof t?null:t.hasOwnProperty("currentCaseLViewIndex")?t:t.value}function E7e(r,e,t){const n=FM(r,t,64,null,null);return _F(e,n),n}function Ip(r,e){const t=e[r.currentCaseLViewIndex];return null===t?t:t<0?~t:t}function CF(r){return r>>>17}function yF(r){return(131070&r)>>>1}let k7=0,x7=0;function EF(r,e,t,n){const i=t[Zt];let o,s=null;for(let a=0;a<e.length;a++){const c=e[a];if("string"==typeof c){const l=e[++a];null===t[l]&&(t[l]=qh(i,c))}else if("number"==typeof c)switch(1&c){case 0:const l=CF(c);let f,d;if(null===s&&(s=l,o=Yh(i,n)),l===s?(f=n,d=o):(f=null,d=A1(t[l])),null!==d){const R=yF(c);r6(i,d,t[R],f,!1);const $=I7(r,R);if(null!==$&&"object"==typeof $){const G=Ip($,t);null!==G&&EF(r,$.create[G],t,t[$.anchorIdx])}}break;case 1:const E=e[++a],w=e[++a];jM(i,bh(c>>>1,t),null,null,E,w,null)}else switch(c){case Np:const l=e[++a],f=e[++a];null===t[f]&&Ti(t[f]=sM(i,l),t);break;case Ap:const d=e[++a],m=e[++a];null===t[m]&&Ti(t[m]=jh(i,d,null),t)}}}function SF(r,e,t,n,i){for(let s=0;s<t.length;s++){const o=t[s],a=t[++s];if(o&i){let c="";for(let l=s+1;l<=s+a;l++){const f=t[l];if("string"==typeof f)c+=f;else if("number"==typeof f)if(f<0)c+=jt(e[n-f]);else{const d=f>>>2;switch(3&f){case 1:const m=t[++l],E=t[++l],w=r.data[d];"string"==typeof w?jM(e[Zt],e[d],null,w,m,c,E):no(r,w,e,m,c,e[Zt],E,!1);break;case 0:const R=e[d];null!==R&&PD(e[Zt],R,c);break;case 2:b7e(r,I7(r,d),e,c);break;case 3:PF(r,I7(r,d),n,e)}}}}else{const c=t[s+1];if(c>0&&3==(3&c)){const f=I7(r,c>>>2);e[f.currentCaseLViewIndex]<0&&PF(r,f,n,e)}}s+=a}}function PF(r,e,t,n){let i=n[e.currentCaseLViewIndex];if(null!==i){let s=k7;i<0&&(i=n[e.currentCaseLViewIndex]=~i,s=-1),SF(r,n,e.update[i],t,s)}}function b7e(r,e,t,n){const i=function w7e(r,e){let t=r.cases.indexOf(e);if(-1===t)switch(r.type){case 1:{const n=function p7e(r,e){const t=function fF(r){return is(r)[N1.PluralCase]}(e)(parseInt(r,10)),n=h7e[t];return void 0!==n?n:"other"}(e,function m7e(){return hF}());t=r.cases.indexOf(n),-1===t&&"other"!==n&&(t=r.cases.indexOf("other"));break}case 0:t=r.cases.indexOf("other")}return-1===t?null:t}(e,n);if(Ip(e,t)!==i&&(TF(r,e,t),t[e.currentCaseLViewIndex]=null===i?null:~i,null!==i)){const o=t[e.anchorIdx];o&&EF(r,e.create[i],t,o)}}function TF(r,e,t){let n=Ip(e,t);if(null!==n){const i=e.remove[n];for(let s=0;s<i.length;s++){const o=i[s];if(o>0){const a=bh(o,t);null!==a&&Xh(t[Zt],a)}else TF(r,I7(r,~o),t)}}}function A7e(){const r=[];let t,n,e=-1;function s(a,c){e=0;const l=Ip(a,c);n=null!==l?a.remove[l]:qn}function o(){if(e<n.length){const a=n[e++];return a>0?t[a]:(r.push(e,n),s(t[et].data[~a],t),o())}return 0===r.length?null:(n=r.pop(),e=r.pop(),o())}return function i(a,c){for(t=c;r.length;)r.pop();return s(a.value,c),o}}const kp=/\ufffd(\d+):?\d*\ufffd/gi,I7e=/\ufffd(\d+)\ufffd/,bF=/^\s*(\ufffd\d+:?\d*\ufffd)\s*,\s*(select|plural)\s*,/,L7="\ufffd",k7e=/\ufffd\/?\*(\d+:\d+)\ufffd/gi,x7e=/\ufffd(\/?[#*]\d+):?\d*\ufffd/gi,L7e=/\uE500/g;function wF(r,e,t,n,i,s,o){const a=M7(r,n,1,null);let c=a<<As.SHIFT,l=e7();e===l&&(l=null),null===l&&(c|=As.APPEND_EAGERLY),o&&(c|=As.COMMENT,function p0e(r){void 0===rM&&(rM=r())}(A7e)),i.push(c,null===s?"":s);const f=FM(r,a,o?32:1,null===s?"":s,null);_F(t,f);const d=f.index;return ac(f,!1),null!==l&&e!==l&&function M7e(r,e){let t=r.insertBeforeIndex;null===t?(kD(gF,mF),t=r.insertBeforeIndex=[null,e]):(function Ql(r,e,t){r!=e&&Ht(t,r,e,"==")}(Array.isArray(t),!0,"Expecting array here"),t.push(e))}(l,d),f}function D7e(r,e,t,n,i,s,o){const a=o.match(kp),c=wF(r,e,t,s,n,a?null:o,!1);a&&R7(i,o,c.index,null,0,null)}function R7(r,e,t,n,i,s){const o=r.length,a=o+1;r.push(null,null);const c=o+2,l=e.split(kp);let f=0;for(let d=0;d<l.length;d++){const m=l[d];if(1&d){const E=i+parseInt(m,10);r.push(-1-E),f|=AF(E)}else""!==m&&r.push(m)}return r.push(t<<2|(n?1:0)),n&&r.push(n,s),r[o]=f,r[a]=r.length-c,f}function AF(r){return 1<<Math.min(r,31)}function NF(r){let e,s,t="",n=0,i=!1;for(;null!==(e=k7e.exec(r));)i?e[0]===`${L7}/*${s}${L7}`&&(n=e.index,i=!1):(t+=r.substring(n,e.index+e[0].length),s=e[1],i=!0);return t+=r.slice(n),t}function IF(r,e,t,n,i,s){let o=0;const a={type:i.type,currentCaseLViewIndex:M7(r,e,1,null),anchorIdx:s,cases:[],create:[],remove:[],update:[]};(function W7e(r,e,t){r.push(AF(e.mainBinding),2,-1-e.mainBinding,t<<2|2)})(t,i,s),function y7e(r,e,t){const n=r.data[e];null===n?r.data[e]=t:n.value=t}(r,s,a);const c=i.values;for(let l=0;l<c.length;l++){const f=c[l],d=[];for(let m=0;m<f.length;m++){const E=f[m];if("string"!=typeof E){const w=d.push(E)-1;f[m]=`\x3c!--\ufffd${w}\ufffd--\x3e`}}o=B7e(r,a,e,t,n,i.cases[l],f.join(""),d)|o}o&&function q7e(r,e,t){r.push(e,1,t<<2|3)}(t,o,s)}function G7e(r){const e=[],t=[];let n=1,i=0;const s=fE(r=r.replace(bF,function(o,a,c){return n="select"===c?0:1,i=parseInt(a.slice(1),10),""}));for(let o=0;o<s.length;){let a=s[o++].trim();1===n&&(a=a.replace(/\s*(?:=)?(\w+)\s*/,"$1")),a.length&&e.push(a);const c=fE(s[o++]);e.length>t.length&&t.push(c)}return{type:n,mainBinding:i,cases:e,values:t}}function fE(r){if(!r)return[];let e=0;const t=[],n=[],i=/[{}]/g;let s;for(i.lastIndex=0;s=i.exec(r);){const a=s.index;if("}"==s[0]){if(t.pop(),0==t.length){const c=r.substring(e,a);bF.test(c)?n.push(G7e(c)):n.push(c),e=a+1}}else{if(0==t.length){const c=r.substring(e,a);n.push(c),e=a+1}t.push("{")}}const o=r.substring(e);return n.push(o),n}function B7e(r,e,t,n,i,s,o,a){const c=[],l=[],f=[];e.cases.push(s),e.create.push(c),e.remove.push(l),e.update.push(f);const m=$D(g8()).getInertBodyElement(o),E=_M(m)||m;return E?kF(r,e,t,n,c,l,f,E,i,a,0):0}function kF(r,e,t,n,i,s,o,a,c,l,f){let d=0,m=a.firstChild;for(;m;){const E=M7(r,t,1,null);switch(m.nodeType){case Node.ELEMENT_NODE:const w=m,R=w.tagName.toLowerCase();if(gM.hasOwnProperty(R)){dE(i,Ap,R,c,E),r.data[E]=R;const de=w.attributes;for(let ve=0;ve<de.length;ve++){const Le=de.item(ve),nt=Le.name.toLowerCase();Le.value.match(kp)?WD.hasOwnProperty(nt)&&R7(o,Le.value,E,Le.name,0,mM[nt]?ep:null):j7e(i,E,Le)}d=kF(r,e,t,n,i,s,o,m,E,l,f+1)|d,xF(s,E,f)}break;case Node.TEXT_NODE:const z=m.textContent||"",$=z.match(kp);dE(i,null,$?"":z,c,E),xF(s,E,f),$&&(d=R7(o,z,E,null,0,null)|d);break;case Node.COMMENT_NODE:const G=I7e.exec(m.textContent||"");if(G){const ve=l[parseInt(G[1],10)];dE(i,Np,"",c,E),IF(r,t,n,c,ve,E),U7e(s,E,f)}}m=m.nextSibling}return d}function xF(r,e,t){0===t&&r.push(e)}function U7e(r,e,t){0===t&&(r.push(~e),r.push(e))}function dE(r,e,t,n,i){null!==e&&r.push(e),r.push(t,i,function S7e(r,e,t){return r|e<<17|t<<1}(0,n,i))}function j7e(r,e,t){r.push(e<<1|1,t.name,t.value)}function Ns(r,e,t=-1){const n=Rn(),i=Ee(),s=pn+r,o=w4(n.consts,e),a=e7();n.firstCreatePass&&function z7e(r,e,t,n,i,s){const o=e7(),a=[],c=[],l=[[]];i=function $7e(r,e){if(function F7e(r){return-1===r}(e))return NF(r);{const t=r.indexOf(`:${e}${L7}`)+2+e.toString().length,n=r.search(new RegExp(`${L7}\\/\\*\\d+:${e}${L7}`));return NF(r.substring(t,n))}}(i,s);const f=function R7e(r){return r.replace(L7e," ")}(i).split(x7e);for(let d=0;d<f.length;d++){let m=f[d];if(1&d){const E=47===m.charCodeAt(0),R=(m.charCodeAt(E?1:0),pn+Number.parseInt(m.substring(E?2:1)));if(E)l.shift(),ac(e7(),!1);else{const z=E7e(r,l[0],R);l.unshift([]),ac(z,!0)}}else{const E=fE(m);for(let w=0;w<E.length;w++){let R=E[w];if(1&w){const z=R;if("object"!=typeof z)throw new Error(`Unable to parse ICU expression in "${i}" message.`);IF(r,t,c,e,z,wF(r,o,l[0],t,a,"",!0).index)}else""!==R&&D7e(r,o,l[0],a,c,t,R)}}}r.data[n]={create:a,update:c}}(n,null===a?0:a.index,i,s,o,t),2===n.type?i[zr][Kt]|=32:i[Kt]|=32;const c=n.data[s],f=OD(n,a===i[Pi]?null:a,i);(function O7e(r,e,t,n){const i=r[Zt];for(let s=0;s<e.length;s++){const o=e[s++],a=e[s],l=(o&As.APPEND_EAGERLY)===As.APPEND_EAGERLY,f=o>>>As.SHIFT;let d=r[f];null===d&&(d=r[f]=(o&As.COMMENT)===As.COMMENT?i.createComment(a):qh(i,a)),l&&null!==t&&r6(i,t,d,n,!1)}})(i,c.create,f,a&&8&a.type?i[a.index]:null),kz(!0)}function Is(){kz(!1)}function oe(r,e,t){Ns(r,e,t),Is()}function $n(r){return function P7e(r){r&&(k7|=1<<Math.min(x7,31)),x7++}(bi(Ee(),n8(),r)),$n}function jn(r){!function T7e(r,e,t){if(x7>0){const n=r.data[t];SF(r,e,Array.isArray(n)?n:n.update,p3()-x7-1,k7)}k7=0,x7=0}(Rn(),Ee(),r+pn)}function hE(r,e,t,n,i){if(r=$t(r),Array.isArray(r))for(let s=0;s<r.length;s++)hE(r[s],e,t,n,i);else{const s=Rn(),o=Ee(),a=ei();let c=s6(r)?r:$t(r.provide);const l=nH(r),f=1048575&a.providerIndexes,d=a.directiveStart,m=a.providerIndexes>>20;if(s6(r)||!r.multi){const E=new t7(l,i,B),w=gE(c,e,i?f:f+m,d);-1===w?(qy(xh(a,o),s,c),pE(s,r,e.length),e.push(c),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),t.push(E),o.push(E)):(t[w]=E,o[w]=E)}else{const E=gE(c,e,f+m,d),w=gE(c,e,f,f+m),z=w>=0&&t[w];if(i&&!z||!i&&!(E>=0&&t[E])){qy(xh(a,o),s,c);const $=function cfe(r,e,t,n,i){const s=new t7(r,t,B);return s.multi=[],s.index=e,s.componentProviders=0,RF(s,i,n&&!t),s}(i?afe:ofe,t.length,i,n,l);!i&&z&&(t[w].providerFactory=$),pE(s,r,e.length,0),e.push(c),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),t.push($),o.push($)}else pE(s,r,E>-1?E:w,RF(t[i?w:E],l,!i&&n));!i&&n&&z&&t[w].componentProviders++}}}function pE(r,e,t,n){const i=s6(e),s=function c8e(r){return!!r.useClass}(e);if(i||s){const c=(s?$t(e.useClass):e).prototype.ngOnDestroy;if(c){const l=r.destroyHooks||(r.destroyHooks=[]);if(!i&&e.multi){const f=l.indexOf(t);-1===f?l.push(t,[n,c]):l[f+1].push(n,c)}else l.push(t,c)}}}function RF(r,e,t){return t&&r.componentProviders++,r.multi.push(e)-1}function gE(r,e,t,n){for(let i=t;i<n;i++)if(e[i]===r)return i;return-1}function ofe(r,e,t,n){return mE(this.multi,[])}function afe(r,e,t,n){const i=this.multi;let s;if(this.providerFactory){const o=this.providerFactory.componentProviders,a=n6(t,t[et],this.providerFactory.index,n);s=a.slice(0,o),mE(i,s);for(let c=o;c<a.length;c++)s.push(a[c])}else s=[],mE(i,s);return s}function mE(r,e){for(let t=0;t<r.length;t++)e.push((0,r[t])());return e}function Q1(r,e=[]){return t=>{t.providersResolver=(n,i)=>function sfe(r,e,t){const n=Rn();if(n.firstCreatePass){const i=pa(r);hE(t,n.data,n.blueprint,i,!0),hE(e,n.data,n.blueprint,i,!1)}}(n,i?i(r):r,e)}}class f6{}class zF{}class _E extends f6{constructor(e,t,n){super(),this._parent=t,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new XH(this);const i=Xs(e);this._bootstrapComponents=v3(i.bootstrap),this._r3Injector=_H(e,t,[{provide:f6,useValue:this},{provide:hp,useValue:this.componentFactoryResolver},...n],a2(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class vE extends zF{constructor(e){super(),this.moduleType=e}create(e){return new _E(this.moduleType,e,[])}}class DF extends f6{constructor(e){super(),this.componentFactoryResolver=new XH(this),this.instance=null;const t=new op([...e.providers,{provide:f6,useValue:this},{provide:hp,useValue:this.componentFactoryResolver}],e.parent||sp(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}}function CE(r,e,t=null){return new DF({providers:r,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}let ffe=(()=>{var r;class e{constructor(n){this._injector=n,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(n){if(!n.standalone)return null;if(!this.cachedInjectors.has(n)){const i=QD(0,n.type),s=i.length>0?CE([i],this._injector,`Standalone[${n.type.name}]`):null;this.cachedInjectors.set(n,s)}return this.cachedInjectors.get(n)}ngOnDestroy(){try{for(const n of this.cachedInjectors.values())null!==n&&n.destroy()}finally{this.cachedInjectors.clear()}}}return(r=e).\u0275prov=He({token:r,providedIn:"environment",factory:()=>new r(Pe(to))}),e})();function HF(r){r.getStandaloneInjector=e=>e.get(ffe).getOrCreateStandaloneInjector(r)}function D1(r,e,t){const n=es()+r,i=Ee();return i[n]===Xt?dc(i,n,t?e.call(t):e()):function T7(r,e){return r[e]}(i,n)}function _a(r,e,t,n){return WF(Ee(),es(),r,e,t,n)}function z7(r,e){const t=r[e];return t===Xt?void 0:t}function WF(r,e,t,n,i,s){const o=e+t;return bi(r,o,i)?dc(r,o+1,s?n.call(s,i):n(i)):z7(r,o+1)}function va(r,e){const t=Rn();let n;const i=r+pn;t.firstCreatePass?(n=function wfe(r,e){if(e)for(let t=e.length-1;t>=0;t--){const n=e[t];if(r===n.name)return n}}(e,t.pipeRegistry),t.data[i]=n,n.onDestroy&&(t.destroyHooks??=[]).push(i,n.onDestroy)):n=t.data[i];const s=n.factory||(n.factory=e6(n.type)),a=Ps(B);try{const c=kh(!1),l=s();return kh(c),function due(r,e,t,n){t>=r.data.length&&(r.data[t]=null,r.blueprint[t]=null),e[t]=n}(t,Ee(),i,l),l}finally{Ps(a)}}function pc(r,e,t){const n=r+pn,i=Ee(),s=e8(i,n);return D7(i,n)?WF(i,es(),e,s.transform,t,s):s.transform(t)}function KF(r,e,t,n){const i=r+pn,s=Ee(),o=e8(s,i);return D7(s,i)?function qF(r,e,t,n,i,s,o){const a=e+t;return a6(r,a,i,s)?dc(r,a+2,o?n.call(o,i,s):n(i,s)):z7(r,a+2)}(s,es(),e,o.transform,t,n,o):o.transform(t,n)}function D7(r,e){return r[et].data[e].pure}function ME(r){return e=>{setTimeout(r,void 0,e)}}const I1=class kfe extends Ss{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,t,n){let i=e,s=t||(()=>null),o=n;if(e&&"object"==typeof e){const c=e;i=c.next?.bind(c),s=c.error?.bind(c),o=c.complete?.bind(c)}this.__isAsync&&(s=ME(s),i&&(i=ME(i)),o&&(o=ME(o)));const a=super.subscribe({next:i,error:s,complete:o});return e instanceof yn&&e.add(a),a}};function xfe(){return this._results[Symbol.iterator]()}class EE{get changes(){return this._changes||(this._changes=new I1)}constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const t=EE.prototype;t[Symbol.iterator]||(t[Symbol.iterator]=xfe)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){const n=this;n.dirty=!1;const i=function wo(r){return r.flat(Number.POSITIVE_INFINITY)}(e);(this._changesDetected=!function k6e(r,e,t){if(r.length!==e.length)return!1;for(let n=0;n<r.length;n++){let i=r[n],s=e[n];if(t&&(i=t(i),s=t(s)),s!==i)return!1}return!0}(n._results,i,t))&&(n._results=i,n.length=i.length,n.last=i[this.length-1],n.first=i[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}function Rfe(r,e,t,n=!0){const i=e[et];if(function M0e(r,e,t,n){const i=J2+n,s=t.length;n>0&&(t[i-1][ha]=e),n<s-J2?(e[ha]=t[i],eD(t,J2+n,e)):(t.push(e),e[ha]=null),e[X1]=t;const o=e[Xu];null!==o&&t!==o&&function E0e(r,e){const t=r[J0];e[zr]!==e[X1][X1][zr]&&(r[cz]=!0),null===t?r[J0]=[e]:t.push(e)}(o,e);const a=e[rc];null!==a&&a.insertView(r),e[Kt]|=128}(i,e,r,t),n){const s=uM(t,r),o=e[Zt],a=Yh(o,r[ic]);null!==a&&function v0e(r,e,t,n,i,s){n[Lr]=i,n[Pi]=e,f7(r,n,t,1,i,s)}(i,r[Pi],o,e,a,s)}}let y3=(()=>{class e{}return e.__NG_ELEMENT_ID__=Hfe,e})();const zfe=y3,Dfe=class extends zfe{constructor(e,t,n){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=n}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,t){return this.createEmbeddedViewImpl(e,t)}createEmbeddedViewImpl(e,t,n){const i=function Lfe(r,e,t,n){const i=e.tView,a=mp(r,i,t,4096&r[Kt]?4096:16,null,e,null,null,null,n?.injector??null,n?.hydrationInfo??null);a[Xu]=r[e.index];const l=r[rc];return null!==l&&(a[rc]=l.createEmbeddedView(i)),KM(i,a,t),a}(this._declarationLView,this._declarationTContainer,e,{injector:t,hydrationInfo:n});return new S7(i)}};function Hfe(){return xp(ei(),Ee())}function xp(r,e){return 4&r.type?new Dfe(e,r,v8(r,e)):null}let ro=(()=>{class e{}return e.__NG_ELEMENT_ID__=Ufe,e})();function Ufe(){return r$(ei(),Ee())}const Wfe=ro,t$=class extends Wfe{constructor(e,t,n){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=n}get element(){return v8(this._hostTNode,this._hostLView)}get injector(){return new ns(this._hostTNode,this._hostLView)}get parentInjector(){const e=Lh(this._hostTNode,this._hostLView);if(By(e)){const t=r7(e,this._hostLView),n=n7(e);return new ns(t[et].data[n+8],t)}return new ns(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const t=n$(this._lContainer);return null!==t&&t[e]||null}get length(){return this._lContainer.length-J2}createEmbeddedView(e,t,n){let i,s;"number"==typeof n?i=n:null!=n&&(i=n.index,s=n.injector);const a=e.createEmbeddedViewImpl(t||{},s,null);return this.insertImpl(a,i,false),a}createComponent(e,t,n,i,s){const o=e&&!function s7(r){return"function"==typeof r}(e);let a;if(o)a=t;else{const R=t||{};a=R.index,n=R.injector,i=R.projectableNodes,s=R.environmentInjector||R.ngModuleRef}const c=o?e:new P7(Ln(e)),l=n||this.parentInjector;if(!s&&null==c.ngModule){const z=(o?l:this.parentInjector).get(to,null);z&&(s=z)}Ln(c.componentType??{});const E=c.create(l,i,null,s);return this.insertImpl(E.hostView,a,false),E}insert(e,t){return this.insertImpl(e,t,!1)}insertImpl(e,t,n){const i=e._lView;if(function jle(r){return Os(r[X1])}(i)){const c=this.indexOf(e);if(-1!==c)this.detach(c);else{const l=i[X1],f=new t$(l,l[Pi],l[X1]);f.detach(f.indexOf(e))}}const o=this._adjustIndex(t),a=this._lContainer;return Rfe(a,i,o,!n),e.attachToViewContainerRef(),eD(SE(a),o,e),e}move(e,t){return this.insert(e,t)}indexOf(e){const t=n$(this._lContainer);return null!==t?t.indexOf(e):-1}remove(e){const t=this._adjustIndex(e,-1),n=Zh(this._lContainer,t);n&&(Dh(SE(this._lContainer),t),oM(n[et],n))}detach(e){const t=this._adjustIndex(e,-1),n=Zh(this._lContainer,t);return n&&null!=Dh(SE(this._lContainer),t)?new S7(n):null}_adjustIndex(e,t=0){return e??this.length+t}};function n$(r){return r[8]}function SE(r){return r[8]||(r[8]=[])}function r$(r,e){let t;const n=e[r.index];return Os(n)?t=n:(t=FH(n,e,null,r),e[r.index]=t,_p(e,t)),i$(t,e,r,n),new t$(t,r,e)}let i$=function s$(r,e,t,n){if(r[ic])return;let i;i=8&t.type?A1(n):function qfe(r,e){const t=r[Zt],n=t.createComment(""),i=bs(e,r);return r6(t,Yh(t,i),n,function O0e(r,e){return r.nextSibling(e)}(t,i),!1),n}(e,t),r[ic]=i};class PE{constructor(e){this.queryList=e,this.matches=null}clone(){return new PE(this.queryList)}setDirty(){this.queryList.setDirty()}}class TE{constructor(e=[]){this.queries=e}createEmbeddedView(e){const t=e.queries;if(null!==t){const n=null!==e.contentQueries?e.contentQueries[0]:t.length,i=[];for(let s=0;s<n;s++){const o=t.getByIndex(s);i.push(this.queries[o.indexInDeclarationView].clone())}return new TE(i)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)null!==f$(e,t).matches&&this.queries[t].setDirty()}}class o${constructor(e,t,n=null){this.predicate=e,this.flags=t,this.read=n}}class OE{constructor(e=[]){this.queries=e}elementStart(e,t){for(let n=0;n<this.queries.length;n++)this.queries[n].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let n=0;n<this.length;n++){const i=null!==t?t.length:0,s=this.getByIndex(n).embeddedTView(e,i);s&&(s.indexInDeclarationView=n,null!==t?t.push(s):t=[s])}return null!==t?new OE(t):null}template(e,t){for(let n=0;n<this.queries.length;n++)this.queries[n].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}}class bE{constructor(e,t=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new bE(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const t=this._declarationNodeIndex;let n=e.parent;for(;null!==n&&8&n.type&&n.index!==t;)n=n.parent;return t===(null!==n?n.index:-1)}return this._appliesToNextNode}matchTNode(e,t){const n=this.metadata.predicate;if(Array.isArray(n))for(let i=0;i<n.length;i++){const s=n[i];this.matchTNodeWithReadOption(e,t,Yfe(t,s)),this.matchTNodeWithReadOption(e,t,Rh(t,e,s,!1,!1))}else n===y3?4&t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,Rh(t,e,n,!1,!1))}matchTNodeWithReadOption(e,t,n){if(null!==n){const i=this.metadata.read;if(null!==i)if(i===Oi||i===ro||i===y3&&4&t.type)this.addMatch(t.index,-2);else{const s=Rh(t,e,i,!1,!1);null!==s&&this.addMatch(t.index,s)}else this.addMatch(t.index,n)}}addMatch(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}function Yfe(r,e){const t=r.localNames;if(null!==t)for(let n=0;n<t.length;n+=2)if(t[n]===e)return t[n+1];return null}function Xfe(r,e,t,n){return-1===t?function Kfe(r,e){return 11&r.type?v8(r,e):4&r.type?xp(r,e):null}(e,r):-2===t?function Qfe(r,e,t){return t===Oi?v8(e,r):t===y3?xp(e,r):t===ro?r$(e,r):void 0}(r,e,n):n6(r,r[et],t,e)}function a$(r,e,t,n){const i=e[rc].queries[n];if(null===i.matches){const s=r.data,o=t.matches,a=[];for(let c=0;c<o.length;c+=2){const l=o[c];a.push(l<0?null:Xfe(e,s[l],o[c+1],t.metadata.read))}i.matches=a}return i.matches}function wE(r,e,t,n){const i=r.queries.getByIndex(t),s=i.matches;if(null!==s){const o=a$(r,e,i,t);for(let a=0;a<s.length;a+=2){const c=s[a];if(c>0)n.push(o[a/2]);else{const l=s[a+1],f=e[-c];for(let d=J2;d<f.length;d++){const m=f[d];m[Xu]===m[X1]&&wE(m[et],m,l,n)}if(null!==f[J0]){const d=f[J0];for(let m=0;m<d.length;m++){const E=d[m];wE(E[et],E,l,n)}}}}}return n}function M3(r){const e=Ee(),t=Rn(),n=xz();Hy(n+1);const i=f$(t,n);if(r.dirty&&function Wle(r){return 4==(4&r[Kt])}(e)===(2==(2&i.metadata.flags))){if(null===i.matches)r.reset([]);else{const s=i.crossesNgTemplate?wE(t,e,n,[]):a$(t,e,i,n);r.reset(s,A8e),r.notifyOnChanges()}return!0}return!1}function k4(r,e,t){const n=Rn();n.firstCreatePass&&(function u$(r,e,t){null===r.queries&&(r.queries=new OE),r.queries.track(new bE(e,t))}(n,new o$(r,e,t),-1),2==(2&e)&&(n.staticViewQueries=!0)),function l$(r,e,t){const n=new EE(4==(4&t));(function J8e(r,e,t,n){const i=GH(e);i.push(t),r.firstCreatePass&&BH(r).push(n,i.length-1)})(r,e,n,n.destroy),null===e[rc]&&(e[rc]=new TE),e[rc].queries.push(new PE(n))}(n,Ee(),e)}function E3(){return function Jfe(r,e){return r[rc].queries[e].queryList}(Ee(),xz())}function f$(r,e){return r.queries.getByIndex(e)}function un(r,e){return xp(r,e)}const LE=new tt("Application Initializer");let RE=(()=>{var r;class e{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((n,i)=>{this.resolve=n,this.reject=i}),this.appInits=rt(LE,{optional:!0})??[]}runInitializers(){if(this.initialized)return;const n=[];for(const s of this.appInits){const o=s();if(A7(o))n.push(o);else if(yV(o)){const a=new Promise((c,l)=>{o.subscribe({complete:c,error:l})});n.push(a)}}const i=()=>{this.done=!0,this.resolve()};Promise.all(n).then(()=>{i()}).catch(s=>{this.reject(s)}),0===n.length&&i(),this.initialized=!0}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=He({token:r,factory:r.\u0275fac,providedIn:"root"}),e})(),w$=(()=>{var r;class e{log(n){console.log(n)}warn(n){console.warn(n)}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=He({token:r,factory:r.\u0275fac,providedIn:"platform"}),e})();const gc=new tt("LocaleId",{providedIn:"root",factory:()=>rt(gc,an.Optional|an.SkipSelf)||function M9e(){return typeof $localize<"u"&&$localize.locale||L8}()});let zp=(()=>{var r;class e{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new Xi(!1)}add(){this.hasPendingTasks.next(!0);const n=this.taskId++;return this.pendingTasks.add(n),n}remove(n){this.pendingTasks.delete(n),0===this.pendingTasks.size&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks.next(!1)}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=He({token:r,factory:r.\u0275fac,providedIn:"root"}),e})();class P9e{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}}let A$=(()=>{var r;class e{compileModuleSync(n){return new vE(n)}compileModuleAsync(n){return Promise.resolve(this.compileModuleSync(n))}compileModuleAndAllComponentsSync(n){const i=this.compileModuleSync(n),o=v3(Xs(n).declarations).reduce((a,c)=>{const l=Ln(c);return l&&a.push(new P7(l)),a},[]);return new P9e(i,o)}compileModuleAndAllComponentsAsync(n){return Promise.resolve(this.compileModuleAndAllComponentsSync(n))}clearCache(){}clearCacheFor(n){}getModuleId(n){}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=He({token:r,factory:r.\u0275fac,providedIn:"root"}),e})();function x$(...r){}class c1{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:n=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new I1(!1),this.onMicrotaskEmpty=new I1(!1),this.onStable=new I1(!1),this.onError=new I1(!1),typeof Zone>"u")throw new ge(908,!1);Zone.assertZonePatched();const i=this;i._nesting=0,i._outer=i._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(i._inner=i._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(i._inner=i._inner.fork(Zone.longStackTraceZoneSpec)),i.shouldCoalesceEventChangeDetection=!n&&t,i.shouldCoalesceRunChangeDetection=n,i.lastRequestAnimationFrameId=-1,i.nativeRequestAnimationFrame=function U9e(){const r="function"==typeof C1.requestAnimationFrame;let e=C1[r?"requestAnimationFrame":"setTimeout"],t=C1[r?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&e&&t){const n=e[Zone.__symbol__("OriginalDelegate")];n&&(e=n);const i=t[Zone.__symbol__("OriginalDelegate")];i&&(t=i)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,function j9e(r){const e=()=>{!function q9e(r){r.isCheckStableRunning||-1!==r.lastRequestAnimationFrameId||(r.lastRequestAnimationFrameId=r.nativeRequestAnimationFrame.call(C1,()=>{r.fakeTopEventTask||(r.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{r.lastRequestAnimationFrameId=-1,VE(r),r.isCheckStableRunning=!0,HE(r),r.isCheckStableRunning=!1},void 0,()=>{},()=>{})),r.fakeTopEventTask.invoke()}),VE(r))}(r)};r._inner=r._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,n,i,s,o,a)=>{try{return L$(r),t.invokeTask(i,s,o,a)}finally{(r.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||r.shouldCoalesceRunChangeDetection)&&e(),R$(r)}},onInvoke:(t,n,i,s,o,a,c)=>{try{return L$(r),t.invoke(i,s,o,a,c)}finally{r.shouldCoalesceRunChangeDetection&&e(),R$(r)}},onHasTask:(t,n,i,s)=>{t.hasTask(i,s),n===i&&("microTask"==s.change?(r._hasPendingMicrotasks=s.microTask,VE(r),HE(r)):"macroTask"==s.change&&(r.hasPendingMacrotasks=s.macroTask))},onHandleError:(t,n,i,s)=>(t.handleError(i,s),r.runOutsideAngular(()=>r.onError.emit(s)),!1)})}(i)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!c1.isInAngularZone())throw new ge(909,!1)}static assertNotInAngularZone(){if(c1.isInAngularZone())throw new ge(909,!1)}run(e,t,n){return this._inner.run(e,t,n)}runTask(e,t,n,i){const s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+i,e,W9e,x$,x$);try{return s.runTask(o,t,n)}finally{s.cancelTask(o)}}runGuarded(e,t,n){return this._inner.runGuarded(e,t,n)}runOutsideAngular(e){return this._outer.run(e)}}const W9e={};function HE(r){if(0==r._nesting&&!r.hasPendingMicrotasks&&!r.isStable)try{r._nesting++,r.onMicrotaskEmpty.emit(null)}finally{if(r._nesting--,!r.hasPendingMicrotasks)try{r.runOutsideAngular(()=>r.onStable.emit(null))}finally{r.isStable=!0}}}function VE(r){r.hasPendingMicrotasks=!!(r._hasPendingMicrotasks||(r.shouldCoalesceEventChangeDetection||r.shouldCoalesceRunChangeDetection)&&-1!==r.lastRequestAnimationFrameId)}function L$(r){r._nesting++,r.isStable&&(r.isStable=!1,r.onUnstable.emit(null))}function R$(r){r._nesting--,HE(r)}class Z9e{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new I1,this.onMicrotaskEmpty=new I1,this.onStable=new I1,this.onError=new I1}run(e,t,n){return e.apply(t,n)}runGuarded(e,t,n){return e.apply(t,n)}runOutsideAngular(e){return e()}runTask(e,t,n,i){return e.apply(t,n)}}const z$=new tt("",{providedIn:"root",factory:D$});function D$(){const r=rt(c1);let e=!0;return function B4e(...r){const e=Uu(r),t=function z4e(r,e){return"number"==typeof cy(r)?r.pop():e}(r,1/0),n=r;return n.length?1===n.length?Ys(n[0]):q0(t)(o2(n,e)):tc}(new b1(i=>{e=r.isStable&&!r.hasPendingMacrotasks&&!r.hasPendingMicrotasks,r.runOutsideAngular(()=>{i.next(e),i.complete()})}),new b1(i=>{let s;r.runOutsideAngular(()=>{s=r.onStable.subscribe(()=>{c1.assertNotInAngularZone(),queueMicrotask(()=>{!e&&!r.hasPendingMacrotasks&&!r.hasPendingMicrotasks&&(e=!0,i.next(!0))})})});const o=r.onUnstable.subscribe(()=>{c1.assertInAngularZone(),e&&(e=!1,r.runOutsideAngular(()=>{i.next(!1)}))});return()=>{s.unsubscribe(),o.unsubscribe()}}).pipe(HR()))}const H$=new tt(""),Hp=new tt("");let GE,FE=(()=>{var r;class e{constructor(n,i,s){this._ngZone=n,this.registry=i,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,GE||(function Y9e(r){GE=r}(s),s.addToWindow(i)),this._watchAngularEvents(),n.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{c1.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;0!==this._callbacks.length;){let n=this._callbacks.pop();clearTimeout(n.timeoutId),n.doneCb(this._didWork)}this._didWork=!1});else{let n=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>!i.updateCb||!i.updateCb(n)||(clearTimeout(i.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(n=>({source:n.source,creationLocation:n.creationLocation,data:n.data})):[]}addCallback(n,i,s){let o=-1;i&&i>0&&(o=setTimeout(()=>{this._callbacks=this._callbacks.filter(a=>a.timeoutId!==o),n(this._didWork,this.getPendingTasks())},i)),this._callbacks.push({doneCb:n,timeoutId:o,updateCb:s})}whenStable(n,i,s){if(s&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(n,i,s),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(n){this.registry.registerApplication(n,this)}unregisterApplication(n){this.registry.unregisterApplication(n)}findProviders(n,i,s){return[]}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(c1),Pe($E),Pe(Hp))},r.\u0275prov=He({token:r,factory:r.\u0275fac}),e})(),$E=(()=>{var r;class e{constructor(){this._applications=new Map}registerApplication(n,i){this._applications.set(n,i)}unregisterApplication(n){this._applications.delete(n)}unregisterAllApplications(){this._applications.clear()}getTestability(n){return this._applications.get(n)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(n,i=!0){return GE?.findTestabilityInTree(this,n,i)??null}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=He({token:r,factory:r.\u0275fac,providedIn:"platform"}),e})(),x4=null;const V$=new tt("AllowMultipleToken"),BE=new tt("PlatformDestroyListeners"),UE=new tt("appBootstrapListener");class $${constructor(e,t){this.name=e,this.token=t}}function B$(r,e,t=[]){const n=`Platform: ${e}`,i=new tt(n);return(s=[])=>{let o=WE();if(!o||o.injector.get(V$,!1)){const a=[...t,...s,{provide:i,useValue:!0}];r?r(a):function Q9e(r){if(x4&&!x4.get(V$,!1))throw new ge(400,!1);(function F$(){!function Rle(r){pz=r}(()=>{throw new ge(600,!1)})})(),x4=r;const e=r.get(W$);(function G$(r){r.get(rH,null)?.forEach(t=>t())})(r)}(function U$(r=[],e){return ti.create({name:e,providers:[{provide:EM,useValue:"platform"},{provide:BE,useValue:new Set([()=>x4=null])},...r]})}(a,n))}return function ede(r){const e=WE();if(!e)throw new ge(401,!1);return e}()}}function WE(){return x4?.get(W$)??null}let W$=(()=>{var r;class e{constructor(n){this._injector=n,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(n,i){const s=function tde(r="zone.js",e){return"noop"===r?new Z9e:"zone.js"===r?new c1(e):r}(i?.ngZone,function q$(r){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:r?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:r?.runCoalescing??!1}}({eventCoalescing:i?.ngZoneEventCoalescing,runCoalescing:i?.ngZoneRunCoalescing}));return s.run(()=>{const o=function ufe(r,e,t){return new _E(r,e,t)}(n.moduleType,this.injector,function X$(r){return[{provide:c1,useFactory:r},{provide:g7,multi:!0,useFactory:()=>{const e=rt(rde,{optional:!0});return()=>e.initialize()}},{provide:K$,useFactory:nde},{provide:z$,useFactory:D$}]}(()=>s)),a=o.injector.get(o6,null);return s.runOutsideAngular(()=>{const c=s.onError.subscribe({next:l=>{a.handleError(l)}});o.onDestroy(()=>{Vp(this._modules,o),c.unsubscribe()})}),function j$(r,e,t){try{const n=t();return A7(n)?n.catch(i=>{throw e.runOutsideAngular(()=>r.handleError(i)),i}):n}catch(n){throw e.runOutsideAngular(()=>r.handleError(n)),n}}(a,s,()=>{const c=o.injector.get(RE);return c.runInitializers(),c.donePromise.then(()=>(pF(o.injector.get(gc,L8)||L8),this._moduleDoBootstrap(o),o))})})}bootstrapModule(n,i=[]){const s=Z$({},i);return function K9e(r,e,t){const n=new vE(t);return Promise.resolve(n)}(0,0,n).then(o=>this.bootstrapModuleFactory(o,s))}_moduleDoBootstrap(n){const i=n.injector.get(d6);if(n._bootstrapComponents.length>0)n._bootstrapComponents.forEach(s=>i.bootstrap(s));else{if(!n.instance.ngDoBootstrap)throw new ge(-403,!1);n.instance.ngDoBootstrap(i)}this._modules.push(n)}onDestroy(n){this._destroyListeners.push(n)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new ge(404,!1);this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());const n=this._injector.get(BE,null);n&&(n.forEach(i=>i()),n.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(ti))},r.\u0275prov=He({token:r,factory:r.\u0275fac,providedIn:"platform"}),e})();function Z$(r,e){return Array.isArray(e)?e.reduce(Z$,r):{...r,...e}}let d6=(()=>{var r;class e{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=rt(K$),this.zoneIsStable=rt(z$),this.componentTypes=[],this.components=[],this.isStable=rt(zp).hasPendingTasks.pipe(fa(n=>n?Dt(!1):this.zoneIsStable),function U4e(r,e=ec){return r=r??W4e,Yr((t,n)=>{let i,s=!0;t.subscribe(vr(n,o=>{const a=e(o);(s||!r(i,a))&&(s=!1,i=a,n.next(o))}))})}(),HR()),this._injector=rt(to)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(n,i){const s=n instanceof uH;if(!this._injector.get(RE).done)throw!s&&function Z0(r){const e=Ln(r)||Q2(r)||Qi(r);return null!==e&&e.standalone}(n),new ge(405,!1);let a;a=s?n:this._injector.get(hp).resolveComponentFactory(n),this.componentTypes.push(a.componentType);const c=function X9e(r){return r.isBoundToModule}(a)?void 0:this._injector.get(f6),f=a.create(ti.NULL,[],i||a.selector,c),d=f.location.nativeElement,m=f.injector.get(H$,null);return m?.registerApplication(d),f.onDestroy(()=>{this.detachView(f.hostView),Vp(this.components,f),m?.unregisterApplication(d)}),this._loadComponent(f),f}tick(){if(this._runningTick)throw new ge(101,!1);try{this._runningTick=!0;for(let n of this._views)n.detectChanges()}catch(n){this.internalErrorHandler(n)}finally{this._runningTick=!1}}attachView(n){const i=n;this._views.push(i),i.attachToAppRef(this)}detachView(n){const i=n;Vp(this._views,i),i.detachFromAppRef()}_loadComponent(n){this.attachView(n.hostView),this.tick(),this.components.push(n);const i=this._injector.get(UE,[]);i.push(...this._bootstrapListeners),i.forEach(s=>s(n))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(n=>n()),this._views.slice().forEach(n=>n.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(n){return this._destroyListeners.push(n),()=>Vp(this._destroyListeners,n)}destroy(){if(this._destroyed)throw new ge(406,!1);const n=this._injector;n.destroy&&!n.destroyed&&n.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=He({token:r,factory:r.\u0275fac,providedIn:"root"}),e})();function Vp(r,e){const t=r.indexOf(e);t>-1&&r.splice(t,1)}const K$=new tt("",{providedIn:"root",factory:()=>rt(o6).handleError.bind(void 0)});function nde(){const r=rt(c1),e=rt(o6);return t=>r.runOutsideAngular(()=>e.handleError(t))}let rde=(()=>{var r;class e{constructor(){this.zone=rt(c1),this.applicationRef=rt(d6)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=He({token:r,factory:r.\u0275fac,providedIn:"root"}),e})();let S3=(()=>{class e{}return e.__NG_ELEMENT_ID__=sde,e})();function sde(r){return function ode(r,e,t){if(Jl(r)&&!t){const n=Qs(r.index,e);return new S7(n,n)}return 47&r.type?new S7(e[zr],e):null}(ei(),Ee(),16==(16&r))}class tG{constructor(){}supports(e){return Mp(e)}create(e){return new dde(e)}}const fde=(r,e)=>e;class dde{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||fde}forEachItem(e){let t;for(t=this._itHead;null!==t;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,n=this._removalsHead,i=0,s=null;for(;t||n;){const o=!n||t&&t.currentIndex<rG(n,i,s)?t:n,a=rG(o,i,s),c=o.currentIndex;if(o===n)i--,n=n._nextRemoved;else if(t=t._next,null==o.previousIndex)i++;else{s||(s=[]);const l=a-i,f=c-i;if(l!=f){for(let m=0;m<l;m++){const E=m<s.length?s[m]:s[m]=0,w=E+m;f<=w&&w<l&&(s[m]=E+1)}s[o.previousIndex]=f-l}}a!==c&&e(o,a,c)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;null!==t;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)e(t)}diff(e){if(null==e&&(e=[]),!Mp(e))throw new ge(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let i,s,o,t=this._itHead,n=!1;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)s=e[a],o=this._trackByFn(a,s),null!==t&&Object.is(t.trackById,o)?(n&&(t=this._verifyReinsertion(t,s,o,a)),Object.is(t.item,s)||this._addIdentityChange(t,s)):(t=this._mismatch(t,s,o,a),n=!0),t=t._next}else i=0,function W5e(r,e){if(Array.isArray(r))for(let t=0;t<r.length;t++)e(r[t]);else{const t=r[Symbol.iterator]();let n;for(;!(n=t.next()).done;)e(n.value)}}(e,a=>{o=this._trackByFn(i,a),null!==t&&Object.is(t.trackById,o)?(n&&(t=this._verifyReinsertion(t,a,o,i)),Object.is(t.item,a)||this._addIdentityChange(t,a)):(t=this._mismatch(t,a,o,i),n=!0),t=t._next,i++}),this.length=i;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,n,i){let s;return null===e?s=this._itTail:(s=e._prev,this._remove(e)),null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,s,i)):null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(n,i))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,s,i)):e=this._addAfter(new hde(t,n),s,i),e}_verifyReinsertion(e,t,n,i){let s=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null);return null!==s?e=this._reinsertAfter(s,e._prev,i):e.currentIndex!=i&&(e.currentIndex=i,this._addToMoves(e,i)),e}_truncate(e){for(;null!==e;){const t=e._next;this._addToRemovals(this._unlink(e)),e=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,n){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);const i=e._prevRemoved,s=e._nextRemoved;return null===i?this._removalsHead=s:i._nextRemoved=s,null===s?this._removalsTail=i:s._prevRemoved=i,this._insertAfter(e,t,n),this._addToMoves(e,n),e}_moveAfter(e,t,n){return this._unlink(e),this._insertAfter(e,t,n),this._addToMoves(e,n),e}_addAfter(e,t,n){return this._insertAfter(e,t,n),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}_insertAfter(e,t,n){const i=null===t?this._itHead:t._next;return e._next=i,e._prev=t,null===i?this._itTail=e:i._prev=e,null===t?this._itHead=e:t._next=e,null===this._linkedRecords&&(this._linkedRecords=new nG),this._linkedRecords.put(e),e.currentIndex=n,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);const t=e._prev,n=e._next;return null===t?this._itHead=n:t._next=n,null===n?this._itTail=t:n._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}_addToRemovals(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new nG),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}class hde{constructor(e,t){this.item=e,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class pde{constructor(){this._head=null,this._tail=null}add(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let n;for(n=this._head;null!==n;n=n._nextDup)if((null===t||t<=n.currentIndex)&&Object.is(n.trackById,e))return n;return null}remove(e){const t=e._prevDup,n=e._nextDup;return null===t?this._head=n:t._nextDup=n,null===n?this._tail=t:n._prevDup=t,null===this._head}}class nG{constructor(){this.map=new Map}put(e){const t=e.trackById;let n=this.map.get(t);n||(n=new pde,this.map.set(t,n)),n.add(e)}get(e,t){const i=this.map.get(e);return i?i.get(e,t):null}remove(e){const t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function rG(r,e,t){const n=r.previousIndex;if(null===n)return n;let i=0;return t&&n<t.length&&(i=t[n]),n+e+i}class iG{constructor(){}supports(e){return e instanceof Map||XM(e)}create(){return new gde}}class gde{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(e){let t;for(t=this._mapHead;null!==t;t=t._next)e(t)}forEachPreviousItem(e){let t;for(t=this._previousMapHead;null!==t;t=t._nextPrevious)e(t)}forEachChangedItem(e){let t;for(t=this._changesHead;null!==t;t=t._nextChanged)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}diff(e){if(e){if(!(e instanceof Map||XM(e)))throw new ge(900,!1)}else e=new Map;return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._mapHead;if(this._appendAfter=null,this._forEach(e,(n,i)=>{if(t&&t.key===i)this._maybeAddToChanges(t,n),this._appendAfter=t,t=t._next;else{const s=this._getOrCreateRecordForKey(i,n);t=this._insertBeforeOrAppend(t,s)}}),t){t._prev&&(t._prev._next=null),this._removalsHead=t;for(let n=t;null!==n;n=n._nextRemoved)n===this._mapHead&&(this._mapHead=null),this._records.delete(n.key),n._nextRemoved=n._next,n.previousValue=n.currentValue,n.currentValue=null,n._prev=null,n._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(e,t){if(e){const n=e._prev;return t._next=e,t._prev=n,e._prev=t,n&&(n._next=t),e===this._mapHead&&(this._mapHead=t),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}_getOrCreateRecordForKey(e,t){if(this._records.has(e)){const i=this._records.get(e);this._maybeAddToChanges(i,t);const s=i._prev,o=i._next;return s&&(s._next=o),o&&(o._prev=s),i._next=null,i._prev=null,i}const n=new mde(e);return this._records.set(e,n),n.currentValue=t,this._addToAdditions(n),n}_reset(){if(this.isDirty){let e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;null!==e;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;null!=e;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(e,t){Object.is(t,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=t,this._addToChanges(e))}_addToAdditions(e){null===this._additionsHead?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}_addToChanges(e){null===this._changesHead?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}_forEach(e,t){e instanceof Map?e.forEach(t):Object.keys(e).forEach(n=>t(e[n],n))}}class mde{constructor(e){this.key=e,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function sG(){return new Gp([new tG])}let Gp=(()=>{var r;class e{constructor(n){this.factories=n}static create(n,i){if(null!=i){const s=i.factories.slice();n=n.concat(s)}return new e(n)}static extend(n){return{provide:e,useFactory:i=>e.create(n,i||sG()),deps:[[e,new Vh,new rs]]}}find(n){const i=this.factories.find(s=>s.supports(n));if(null!=i)return i;throw new ge(901,!1)}}return(r=e).\u0275prov=He({token:r,providedIn:"root",factory:sG}),e})();function oG(){return new F7([new iG])}let F7=(()=>{var r;class e{constructor(n){this.factories=n}static create(n,i){if(i){const s=i.factories.slice();n=n.concat(s)}return new e(n)}static extend(n){return{provide:e,useFactory:i=>e.create(n,i||oG()),deps:[[e,new Vh,new rs]]}}find(n){const i=this.factories.find(s=>s.supports(n));if(i)return i;throw new ge(901,!1)}}return(r=e).\u0275prov=He({token:r,providedIn:"root",factory:oG}),e})();const Cde=B$(null,"core",[]);let yde=(()=>{var r;class e{constructor(n){}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(d6))},r.\u0275mod=Ei({type:r}),r.\u0275inj=X2({}),e})();function D8(r){return"boolean"==typeof r?r:null!=r&&"false"!==r}let XE=null;function L4(){return XE}class Lde{}const b2=new tt("DocumentToken");let QE=(()=>{var r;class e{historyGo(n){throw new Error("Not implemented")}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=He({token:r,factory:function(){return rt(zde)},providedIn:"platform"}),e})();const Rde=new tt("Location Initialized");let zde=(()=>{var r;class e extends QE{constructor(){super(),this._doc=rt(b2),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return L4().getBaseHref(this._doc)}onPopState(n){const i=L4().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",n,!1),()=>i.removeEventListener("popstate",n)}onHashChange(n){const i=L4().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",n,!1),()=>i.removeEventListener("hashchange",n)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(n){this._location.pathname=n}pushState(n,i,s){this._history.pushState(n,i,s)}replaceState(n,i,s){this._history.replaceState(n,i,s)}forward(){this._history.forward()}back(){this._history.back()}historyGo(n=0){this._history.go(n)}getState(){return this._history.state}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=He({token:r,factory:function(){return new r},providedIn:"platform"}),e})();function JE(r,e){if(0==r.length)return e;if(0==e.length)return r;let t=0;return r.endsWith("/")&&t++,e.startsWith("/")&&t++,2==t?r+e.substring(1):1==t?r+e:r+"/"+e}function pG(r){const e=r.match(/#|\?|$/),t=e&&e.index||r.length;return r.slice(0,t-("/"===r[t-1]?1:0))+r.slice(t)}function P3(r){return r&&"?"!==r[0]?"?"+r:r}let p6=(()=>{var r;class e{historyGo(n){throw new Error("Not implemented")}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=He({token:r,factory:function(){return rt(mG)},providedIn:"root"}),e})();const gG=new tt("appBaseHref");let mG=(()=>{var r;class e extends p6{constructor(n,i){super(),this._platformLocation=n,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??rt(b2).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(n){this._removeListenerFns.push(this._platformLocation.onPopState(n),this._platformLocation.onHashChange(n))}getBaseHref(){return this._baseHref}prepareExternalUrl(n){return JE(this._baseHref,n)}path(n=!1){const i=this._platformLocation.pathname+P3(this._platformLocation.search),s=this._platformLocation.hash;return s&&n?`${i}${s}`:i}pushState(n,i,s,o){const a=this.prepareExternalUrl(s+P3(o));this._platformLocation.pushState(n,i,a)}replaceState(n,i,s,o){const a=this.prepareExternalUrl(s+P3(o));this._platformLocation.replaceState(n,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(n=0){this._platformLocation.historyGo?.(n)}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(QE),Pe(gG,8))},r.\u0275prov=He({token:r,factory:r.\u0275fac,providedIn:"root"}),e})(),Dde=(()=>{var r;class e extends p6{constructor(n,i){super(),this._platformLocation=n,this._baseHref="",this._removeListenerFns=[],null!=i&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(n){this._removeListenerFns.push(this._platformLocation.onPopState(n),this._platformLocation.onHashChange(n))}getBaseHref(){return this._baseHref}path(n=!1){let i=this._platformLocation.hash;return null==i&&(i="#"),i.length>0?i.substring(1):i}prepareExternalUrl(n){const i=JE(this._baseHref,n);return i.length>0?"#"+i:i}pushState(n,i,s,o){let a=this.prepareExternalUrl(s+P3(o));0==a.length&&(a=this._platformLocation.pathname),this._platformLocation.pushState(n,i,a)}replaceState(n,i,s,o){let a=this.prepareExternalUrl(s+P3(o));0==a.length&&(a=this._platformLocation.pathname),this._platformLocation.replaceState(n,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(n=0){this._platformLocation.historyGo?.(n)}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(QE),Pe(gG,8))},r.\u0275prov=He({token:r,factory:r.\u0275fac}),e})(),eS=(()=>{var r;class e{constructor(n){this._subject=new I1,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=n;const i=this._locationStrategy.getBaseHref();this._basePath=function Fde(r){if(new RegExp("^(https?:)?//").test(r)){const[,t]=r.split(/\/\/[^\/]+/);return t}return r}(pG(_G(i))),this._locationStrategy.onPopState(s=>{this._subject.emit({url:this.path(!0),pop:!0,state:s.state,type:s.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(n=!1){return this.normalize(this._locationStrategy.path(n))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(n,i=""){return this.path()==this.normalize(n+P3(i))}normalize(n){return e.stripTrailingSlash(function Vde(r,e){if(!r||!e.startsWith(r))return e;const t=e.substring(r.length);return""===t||["/",";","?","#"].includes(t[0])?t:e}(this._basePath,_G(n)))}prepareExternalUrl(n){return n&&"/"!==n[0]&&(n="/"+n),this._locationStrategy.prepareExternalUrl(n)}go(n,i="",s=null){this._locationStrategy.pushState(s,"",n,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(n+P3(i)),s)}replaceState(n,i="",s=null){this._locationStrategy.replaceState(s,"",n,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(n+P3(i)),s)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(n=0){this._locationStrategy.historyGo?.(n)}onUrlChange(n){return this._urlChangeListeners.push(n),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)})),()=>{const i=this._urlChangeListeners.indexOf(n);this._urlChangeListeners.splice(i,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(n="",i){this._urlChangeListeners.forEach(s=>s(n,i))}subscribe(n,i,s){return this._subject.subscribe({next:n,error:i,complete:s})}}return(r=e).normalizeQueryParams=P3,r.joinWithSlash=JE,r.stripTrailingSlash=pG,r.\u0275fac=function(n){return new(n||r)(Pe(p6))},r.\u0275prov=He({token:r,factory:function(){return function Hde(){return new eS(Pe(p6))}()},providedIn:"root"}),e})();function _G(r){return r.replace(/\/index.html$/,"")}var Up=function(r){return r[r.Decimal=0]="Decimal",r[r.Percent=1]="Percent",r[r.Currency=2]="Currency",r[r.Scientific=3]="Scientific",r}(Up||{}),os=function(r){return r[r.Format=0]="Format",r[r.Standalone=1]="Standalone",r}(os||{}),y1=function(r){return r[r.Narrow=0]="Narrow",r[r.Abbreviated=1]="Abbreviated",r[r.Wide=2]="Wide",r[r.Short=3]="Short",r}(y1||{}),io=function(r){return r[r.Short=0]="Short",r[r.Medium=1]="Medium",r[r.Long=2]="Long",r[r.Full=3]="Full",r}(io||{}),Dr=function(r){return r[r.Decimal=0]="Decimal",r[r.Group=1]="Group",r[r.List=2]="List",r[r.PercentSign=3]="PercentSign",r[r.PlusSign=4]="PlusSign",r[r.MinusSign=5]="MinusSign",r[r.Exponential=6]="Exponential",r[r.SuperscriptingExponent=7]="SuperscriptingExponent",r[r.PerMille=8]="PerMille",r[r.Infinity=9]="Infinity",r[r.NaN=10]="NaN",r[r.TimeSeparator=11]="TimeSeparator",r[r.CurrencyDecimal=12]="CurrencyDecimal",r[r.CurrencyGroup=13]="CurrencyGroup",r}(Dr||{});function Wp(r,e){return ko(is(r)[N1.DateFormat],e)}function qp(r,e){return ko(is(r)[N1.TimeFormat],e)}function jp(r,e){return ko(is(r)[N1.DateTimeFormat],e)}function Io(r,e){const t=is(r),n=t[N1.NumberSymbols][e];if(typeof n>"u"){if(e===Dr.CurrencyDecimal)return t[N1.NumberSymbols][Dr.Decimal];if(e===Dr.CurrencyGroup)return t[N1.NumberSymbols][Dr.Group]}return n}function CG(r){if(!r[N1.ExtraData])throw new Error(`Missing extra locale data for the locale "${r[N1.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function ko(r,e){for(let t=e;t>-1;t--)if(typeof r[t]<"u")return r[t];throw new Error("Locale data API: locale data undefined")}function nS(r){const[e,t]=r.split(":");return{hours:+e,minutes:+t}}const ehe=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,$7={},the=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;var T3=function(r){return r[r.Short=0]="Short",r[r.ShortGMT=1]="ShortGMT",r[r.Long=2]="Long",r[r.Extended=3]="Extended",r}(T3||{}),Xn=function(r){return r[r.FullYear=0]="FullYear",r[r.Month=1]="Month",r[r.Date=2]="Date",r[r.Hours=3]="Hours",r[r.Minutes=4]="Minutes",r[r.Seconds=5]="Seconds",r[r.FractionalSeconds=6]="FractionalSeconds",r[r.Day=7]="Day",r}(Xn||{}),Qn=function(r){return r[r.DayPeriods=0]="DayPeriods",r[r.Days=1]="Days",r[r.Months=2]="Months",r[r.Eras=3]="Eras",r}(Qn||{});function yG(r,e,t,n){let i=function uhe(r){if(SG(r))return r;if("number"==typeof r&&!isNaN(r))return new Date(r);if("string"==typeof r){if(r=r.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(r)){const[i,s=1,o=1]=r.split("-").map(a=>+a);return Zp(i,s-1,o)}const t=parseFloat(r);if(!isNaN(r-t))return new Date(t);let n;if(n=r.match(ehe))return function fhe(r){const e=new Date(0);let t=0,n=0;const i=r[8]?e.setUTCFullYear:e.setFullYear,s=r[8]?e.setUTCHours:e.setHours;r[9]&&(t=Number(r[9]+r[10]),n=Number(r[9]+r[11])),i.call(e,Number(r[1]),Number(r[2])-1,Number(r[3]));const o=Number(r[4]||0)-t,a=Number(r[5]||0)-n,c=Number(r[6]||0),l=Math.floor(1e3*parseFloat("0."+(r[7]||0)));return s.call(e,o,a,c,l),e}(n)}const e=new Date(r);if(!SG(e))throw new Error(`Unable to convert "${r}" into a date`);return e}(r);e=O3(t,e)||e;let a,o=[];for(;e;){if(a=the.exec(e),!a){o.push(e);break}{o=o.concat(a.slice(1));const f=o.pop();if(!f)break;e=f}}let c=i.getTimezoneOffset();n&&(c=EG(n,c),i=function lhe(r,e,t){const n=t?-1:1,i=r.getTimezoneOffset();return function che(r,e){return(r=new Date(r.getTime())).setMinutes(r.getMinutes()+e),r}(r,n*(EG(e,i)-i))}(i,n,!0));let l="";return o.forEach(f=>{const d=function ahe(r){if(iS[r])return iS[r];let e;switch(r){case"G":case"GG":case"GGG":e=k1(Qn.Eras,y1.Abbreviated);break;case"GGGG":e=k1(Qn.Eras,y1.Wide);break;case"GGGGG":e=k1(Qn.Eras,y1.Narrow);break;case"y":e=Xr(Xn.FullYear,1,0,!1,!0);break;case"yy":e=Xr(Xn.FullYear,2,0,!0,!0);break;case"yyy":e=Xr(Xn.FullYear,3,0,!1,!0);break;case"yyyy":e=Xr(Xn.FullYear,4,0,!1,!0);break;case"Y":e=Qp(1);break;case"YY":e=Qp(2,!0);break;case"YYY":e=Qp(3);break;case"YYYY":e=Qp(4);break;case"M":case"L":e=Xr(Xn.Month,1,1);break;case"MM":case"LL":e=Xr(Xn.Month,2,1);break;case"MMM":e=k1(Qn.Months,y1.Abbreviated);break;case"MMMM":e=k1(Qn.Months,y1.Wide);break;case"MMMMM":e=k1(Qn.Months,y1.Narrow);break;case"LLL":e=k1(Qn.Months,y1.Abbreviated,os.Standalone);break;case"LLLL":e=k1(Qn.Months,y1.Wide,os.Standalone);break;case"LLLLL":e=k1(Qn.Months,y1.Narrow,os.Standalone);break;case"w":e=rS(1);break;case"ww":e=rS(2);break;case"W":e=rS(1,!0);break;case"d":e=Xr(Xn.Date,1);break;case"dd":e=Xr(Xn.Date,2);break;case"c":case"cc":e=Xr(Xn.Day,1);break;case"ccc":e=k1(Qn.Days,y1.Abbreviated,os.Standalone);break;case"cccc":e=k1(Qn.Days,y1.Wide,os.Standalone);break;case"ccccc":e=k1(Qn.Days,y1.Narrow,os.Standalone);break;case"cccccc":e=k1(Qn.Days,y1.Short,os.Standalone);break;case"E":case"EE":case"EEE":e=k1(Qn.Days,y1.Abbreviated);break;case"EEEE":e=k1(Qn.Days,y1.Wide);break;case"EEEEE":e=k1(Qn.Days,y1.Narrow);break;case"EEEEEE":e=k1(Qn.Days,y1.Short);break;case"a":case"aa":case"aaa":e=k1(Qn.DayPeriods,y1.Abbreviated);break;case"aaaa":e=k1(Qn.DayPeriods,y1.Wide);break;case"aaaaa":e=k1(Qn.DayPeriods,y1.Narrow);break;case"b":case"bb":case"bbb":e=k1(Qn.DayPeriods,y1.Abbreviated,os.Standalone,!0);break;case"bbbb":e=k1(Qn.DayPeriods,y1.Wide,os.Standalone,!0);break;case"bbbbb":e=k1(Qn.DayPeriods,y1.Narrow,os.Standalone,!0);break;case"B":case"BB":case"BBB":e=k1(Qn.DayPeriods,y1.Abbreviated,os.Format,!0);break;case"BBBB":e=k1(Qn.DayPeriods,y1.Wide,os.Format,!0);break;case"BBBBB":e=k1(Qn.DayPeriods,y1.Narrow,os.Format,!0);break;case"h":e=Xr(Xn.Hours,1,-12);break;case"hh":e=Xr(Xn.Hours,2,-12);break;case"H":e=Xr(Xn.Hours,1);break;case"HH":e=Xr(Xn.Hours,2);break;case"m":e=Xr(Xn.Minutes,1);break;case"mm":e=Xr(Xn.Minutes,2);break;case"s":e=Xr(Xn.Seconds,1);break;case"ss":e=Xr(Xn.Seconds,2);break;case"S":e=Xr(Xn.FractionalSeconds,1);break;case"SS":e=Xr(Xn.FractionalSeconds,2);break;case"SSS":e=Xr(Xn.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":e=Kp(T3.Short);break;case"ZZZZZ":e=Kp(T3.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":e=Kp(T3.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":e=Kp(T3.Long);break;default:return null}return iS[r]=e,e}(f);l+=d?d(i,t,c):"''"===f?"'":f.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),l}function Zp(r,e,t){const n=new Date(0);return n.setFullYear(r,e,t),n.setHours(0,0,0),n}function O3(r,e){const t=function Gde(r){return is(r)[N1.LocaleId]}(r);if($7[t]=$7[t]||{},$7[t][e])return $7[t][e];let n="";switch(e){case"shortDate":n=Wp(r,io.Short);break;case"mediumDate":n=Wp(r,io.Medium);break;case"longDate":n=Wp(r,io.Long);break;case"fullDate":n=Wp(r,io.Full);break;case"shortTime":n=qp(r,io.Short);break;case"mediumTime":n=qp(r,io.Medium);break;case"longTime":n=qp(r,io.Long);break;case"fullTime":n=qp(r,io.Full);break;case"short":const i=O3(r,"shortTime"),s=O3(r,"shortDate");n=Yp(jp(r,io.Short),[i,s]);break;case"medium":const o=O3(r,"mediumTime"),a=O3(r,"mediumDate");n=Yp(jp(r,io.Medium),[o,a]);break;case"long":const c=O3(r,"longTime"),l=O3(r,"longDate");n=Yp(jp(r,io.Long),[c,l]);break;case"full":const f=O3(r,"fullTime"),d=O3(r,"fullDate");n=Yp(jp(r,io.Full),[f,d])}return n&&($7[t][e]=n),n}function Yp(r,e){return e&&(r=r.replace(/\{([^}]+)}/g,function(t,n){return null!=e&&n in e?e[n]:t})),r}function Ca(r,e,t="-",n,i){let s="";(r<0||i&&r<=0)&&(i?r=1-r:(r=-r,s=t));let o=String(r);for(;o.length<e;)o="0"+o;return n&&(o=o.slice(o.length-e)),s+o}function Xr(r,e,t=0,n=!1,i=!1){return function(s,o){let a=function rhe(r,e){switch(r){case Xn.FullYear:return e.getFullYear();case Xn.Month:return e.getMonth();case Xn.Date:return e.getDate();case Xn.Hours:return e.getHours();case Xn.Minutes:return e.getMinutes();case Xn.Seconds:return e.getSeconds();case Xn.FractionalSeconds:return e.getMilliseconds();case Xn.Day:return e.getDay();default:throw new Error(`Unknown DateType value "${r}".`)}}(r,s);if((t>0||a>-t)&&(a+=t),r===Xn.Hours)0===a&&-12===t&&(a=12);else if(r===Xn.FractionalSeconds)return function nhe(r,e){return Ca(r,3).substring(0,e)}(a,e);const c=Io(o,Dr.MinusSign);return Ca(a,e,c,n,i)}}function k1(r,e,t=os.Format,n=!1){return function(i,s){return function ihe(r,e,t,n,i,s){switch(t){case Qn.Months:return function Wde(r,e,t){const n=is(r),s=ko([n[N1.MonthsFormat],n[N1.MonthsStandalone]],e);return ko(s,t)}(e,i,n)[r.getMonth()];case Qn.Days:return function Ude(r,e,t){const n=is(r),s=ko([n[N1.DaysFormat],n[N1.DaysStandalone]],e);return ko(s,t)}(e,i,n)[r.getDay()];case Qn.DayPeriods:const o=r.getHours(),a=r.getMinutes();if(s){const l=function Yde(r){const e=is(r);return CG(e),(e[N1.ExtraData][2]||[]).map(n=>"string"==typeof n?nS(n):[nS(n[0]),nS(n[1])])}(e),f=function Kde(r,e,t){const n=is(r);CG(n);const s=ko([n[N1.ExtraData][0],n[N1.ExtraData][1]],e)||[];return ko(s,t)||[]}(e,i,n),d=l.findIndex(m=>{if(Array.isArray(m)){const[E,w]=m,R=o>=E.hours&&a>=E.minutes,z=o<w.hours||o===w.hours&&a<w.minutes;if(E.hours<w.hours){if(R&&z)return!0}else if(R||z)return!0}else if(m.hours===o&&m.minutes===a)return!0;return!1});if(-1!==d)return f[d]}return function Bde(r,e,t){const n=is(r),s=ko([n[N1.DayPeriodsFormat],n[N1.DayPeriodsStandalone]],e);return ko(s,t)}(e,i,n)[o<12?0:1];case Qn.Eras:return function qde(r,e){return ko(is(r)[N1.Eras],e)}(e,n)[r.getFullYear()<=0?0:1];default:throw new Error(`unexpected translation type ${t}`)}}(i,s,r,e,t,n)}}function Kp(r){return function(e,t,n){const i=-1*n,s=Io(t,Dr.MinusSign),o=i>0?Math.floor(i/60):Math.ceil(i/60);switch(r){case T3.Short:return(i>=0?"+":"")+Ca(o,2,s)+Ca(Math.abs(i%60),2,s);case T3.ShortGMT:return"GMT"+(i>=0?"+":"")+Ca(o,1,s);case T3.Long:return"GMT"+(i>=0?"+":"")+Ca(o,2,s)+":"+Ca(Math.abs(i%60),2,s);case T3.Extended:return 0===n?"Z":(i>=0?"+":"")+Ca(o,2,s)+":"+Ca(Math.abs(i%60),2,s);default:throw new Error(`Unknown zone width "${r}"`)}}}const she=0,Xp=4;function MG(r){return Zp(r.getFullYear(),r.getMonth(),r.getDate()+(Xp-r.getDay()))}function rS(r,e=!1){return function(t,n){let i;if(e){const s=new Date(t.getFullYear(),t.getMonth(),1).getDay()-1,o=t.getDate();i=1+Math.floor((o+s)/7)}else{const s=MG(t),o=function ohe(r){const e=Zp(r,she,1).getDay();return Zp(r,0,1+(e<=Xp?Xp:Xp+7)-e)}(s.getFullYear()),a=s.getTime()-o.getTime();i=1+Math.round(a/6048e5)}return Ca(i,r,Io(n,Dr.MinusSign))}}function Qp(r,e=!1){return function(t,n){return Ca(MG(t).getFullYear(),r,Io(n,Dr.MinusSign),e)}}const iS={};function EG(r,e){r=r.replace(/:/g,"");const t=Date.parse("Jan 01, 1970 00:00:00 "+r)/6e4;return isNaN(t)?e:t}function SG(r){return r instanceof Date&&!isNaN(r.valueOf())}const dhe=/^(\d+)?\.((\d+)(-(\d+))?)?$/;function cS(r){const e=parseInt(r);if(isNaN(e))throw new Error("Invalid integer literal when parsing "+r);return e}function bG(r,e){e=encodeURIComponent(e);for(const t of r.split(";")){const n=t.indexOf("="),[i,s]=-1==n?[t,""]:[t.slice(0,n),t.slice(n+1)];if(i.trim()===e)return decodeURIComponent(s)}return null}const uS=/\s+/,wG=[];let Ft=(()=>{var r;class e{constructor(n,i,s,o){this._iterableDiffers=n,this._keyValueDiffers=i,this._ngEl=s,this._renderer=o,this.initialClasses=wG,this.stateMap=new Map}set klass(n){this.initialClasses=null!=n?n.trim().split(uS):wG}set ngClass(n){this.rawClass="string"==typeof n?n.trim().split(uS):n}ngDoCheck(){for(const i of this.initialClasses)this._updateState(i,!0);const n=this.rawClass;if(Array.isArray(n)||n instanceof Set)for(const i of n)this._updateState(i,!0);else if(null!=n)for(const i of Object.keys(n))this._updateState(i,!!n[i]);this._applyStateDiff()}_updateState(n,i){const s=this.stateMap.get(n);void 0!==s?(s.enabled!==i&&(s.changed=!0,s.enabled=i),s.touched=!0):this.stateMap.set(n,{enabled:i,changed:!0,touched:!0})}_applyStateDiff(){for(const n of this.stateMap){const i=n[0],s=n[1];s.changed?(this._toggleClass(i,s.enabled),s.changed=!1):s.touched||(s.enabled&&this._toggleClass(i,!1),this.stateMap.delete(i)),s.touched=!1}}_toggleClass(n,i){(n=n.trim()).length>0&&n.split(uS).forEach(s=>{i?this._renderer.addClass(this._ngEl.nativeElement,s):this._renderer.removeClass(this._ngEl.nativeElement,s)})}}return(r=e).\u0275fac=function(n){return new(n||r)(B(Gp),B(F7),B(Oi),B(uc))},r.\u0275dir=Rt({type:r,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"},standalone:!0}),e})();class The{constructor(e,t,n,i){this.$implicit=e,this.ngForOf=t,this.index=n,this.count=i}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let Wt=(()=>{var r;class e{set ngForOf(n){this._ngForOf=n,this._ngForOfDirty=!0}set ngForTrackBy(n){this._trackByFn=n}get ngForTrackBy(){return this._trackByFn}constructor(n,i,s){this._viewContainer=n,this._template=i,this._differs=s,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(n){n&&(this._template=n)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const n=this._ngForOf;!this._differ&&n&&(this._differ=this._differs.find(n).create(this.ngForTrackBy))}if(this._differ){const n=this._differ.diff(this._ngForOf);n&&this._applyChanges(n)}}_applyChanges(n){const i=this._viewContainer;n.forEachOperation((s,o,a)=>{if(null==s.previousIndex)i.createEmbeddedView(this._template,new The(s.item,this._ngForOf,-1,-1),null===a?void 0:a);else if(null==a)i.remove(null===o?void 0:o);else if(null!==o){const c=i.get(o);i.move(c,a),NG(c,s)}});for(let s=0,o=i.length;s<o;s++){const c=i.get(s).context;c.index=s,c.count=o,c.ngForOf=this._ngForOf}n.forEachIdentityChange(s=>{NG(i.get(s.currentIndex),s)})}static ngTemplateContextGuard(n,i){return!0}}return(r=e).\u0275fac=function(n){return new(n||r)(B(ro),B(y3),B(Gp))},r.\u0275dir=Rt({type:r,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0}),e})();function NG(r,e){r.context.$implicit=e.item}let At=(()=>{var r;class e{constructor(n,i){this._viewContainer=n,this._context=new Ohe,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(n){this._context.$implicit=this._context.ngIf=n,this._updateView()}set ngIfThen(n){IG("ngIfThen",n),this._thenTemplateRef=n,this._thenViewRef=null,this._updateView()}set ngIfElse(n){IG("ngIfElse",n),this._elseTemplateRef=n,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(n,i){return!0}}return(r=e).\u0275fac=function(n){return new(n||r)(B(ro),B(y3))},r.\u0275dir=Rt({type:r,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0}),e})();class Ohe{constructor(){this.$implicit=null,this.ngIf=null}}function IG(r,e){if(e&&!e.createEmbeddedView)throw new Error(`${r} must be a TemplateRef, but received '${a2(e)}'.`)}let LG=(()=>{var r;class e{constructor(n){this._locale=n}transform(n,i,s){if(!function hS(r){return!(null==r||""===r||r!=r)}(n))return null;s=s||this._locale;try{return function vhe(r,e,t){return function oS(r,e,t,n,i,s,o=!1){let a="",c=!1;if(isFinite(r)){let l=function yhe(r){let n,i,s,o,a,e=Math.abs(r)+"",t=0;for((i=e.indexOf("."))>-1&&(e=e.replace(".","")),(s=e.search(/e/i))>0?(i<0&&(i=s),i+=+e.slice(s+1),e=e.substring(0,s)):i<0&&(i=e.length),s=0;"0"===e.charAt(s);s++);if(s===(a=e.length))n=[0],i=1;else{for(a--;"0"===e.charAt(a);)a--;for(i-=s,n=[],o=0;s<=a;s++,o++)n[o]=Number(e.charAt(s))}return i>22&&(n=n.splice(0,21),t=i-1,i=1),{digits:n,exponent:t,integerLen:i}}(r);o&&(l=function Che(r){if(0===r.digits[0])return r;const e=r.digits.length-r.integerLen;return r.exponent?r.exponent+=2:(0===e?r.digits.push(0,0):1===e&&r.digits.push(0),r.integerLen+=2),r}(l));let f=e.minInt,d=e.minFrac,m=e.maxFrac;if(s){const G=s.match(dhe);if(null===G)throw new Error(`${s} is not a valid digit info`);const de=G[1],ve=G[3],Le=G[5];null!=de&&(f=cS(de)),null!=ve&&(d=cS(ve)),null!=Le?m=cS(Le):null!=ve&&d>m&&(m=d)}!function Mhe(r,e,t){if(e>t)throw new Error(`The minimum number of digits after fraction (${e}) is higher than the maximum (${t}).`);let n=r.digits,i=n.length-r.integerLen;const s=Math.min(Math.max(e,i),t);let o=s+r.integerLen,a=n[o];if(o>0){n.splice(Math.max(r.integerLen,o));for(let d=o;d<n.length;d++)n[d]=0}else{i=Math.max(0,i),r.integerLen=1,n.length=Math.max(1,o=s+1),n[0]=0;for(let d=1;d<o;d++)n[d]=0}if(a>=5)if(o-1<0){for(let d=0;d>o;d--)n.unshift(0),r.integerLen++;n.unshift(1),r.integerLen++}else n[o-1]++;for(;i<Math.max(0,s);i++)n.push(0);let c=0!==s;const l=e+r.integerLen,f=n.reduceRight(function(d,m,E,w){return w[E]=(m+=d)<10?m:m-10,c&&(0===w[E]&&E>=l?w.pop():c=!1),m>=10?1:0},0);f&&(n.unshift(f),r.integerLen++)}(l,d,m);let E=l.digits,w=l.integerLen;const R=l.exponent;let z=[];for(c=E.every(G=>!G);w<f;w++)E.unshift(0);for(;w<0;w++)E.unshift(0);w>0?z=E.splice(w,E.length):(z=E,E=[0]);const $=[];for(E.length>=e.lgSize&&$.unshift(E.splice(-e.lgSize,E.length).join(""));E.length>e.gSize;)$.unshift(E.splice(-e.gSize,E.length).join(""));E.length&&$.unshift(E.join("")),a=$.join(Io(t,n)),z.length&&(a+=Io(t,i)+z.join("")),R&&(a+=Io(t,Dr.Exponential)+"+"+R)}else a=Io(t,Dr.Infinity);return a=r<0&&!c?e.negPre+a+e.negSuf:e.posPre+a+e.posSuf,a}(r,function aS(r,e="-"){const t={minInt:1,minFrac:0,maxFrac:0,posPre:"",posSuf:"",negPre:"",negSuf:"",gSize:0,lgSize:0},n=r.split(";"),i=n[0],s=n[1],o=-1!==i.indexOf(".")?i.split("."):[i.substring(0,i.lastIndexOf("0")+1),i.substring(i.lastIndexOf("0")+1)],a=o[0],c=o[1]||"";t.posPre=a.substring(0,a.indexOf("#"));for(let f=0;f<c.length;f++){const d=c.charAt(f);"0"===d?t.minFrac=t.maxFrac=f+1:"#"===d?t.maxFrac=f+1:t.posSuf+=d}const l=a.split(",");if(t.gSize=l[1]?l[1].length:0,t.lgSize=l[2]||l[1]?(l[2]||l[1]).length:0,s){const f=i.length-t.posPre.length-t.posSuf.length,d=s.indexOf("#");t.negPre=s.substring(0,d).replace(/'/g,""),t.negSuf=s.slice(d+f).replace(/'/g,"")}else t.negPre=e+t.posPre,t.negSuf=t.posSuf;return t}(function tS(r,e){return is(r)[N1.NumberFormats][e]}(e,Up.Decimal),Io(e,Dr.MinusSign)),e,Dr.Group,Dr.Decimal,t)}(function pS(r){if("string"==typeof r&&!isNaN(Number(r)-parseFloat(r)))return Number(r);if("number"!=typeof r)throw new Error(`${r} is not a number`);return r}(n),s,i)}catch(o){throw function ya(r,e){return new ge(2100,!1)}()}}}return(r=e).\u0275fac=function(n){return new(n||r)(B(gc,16))},r.\u0275pipe=Si({name:"number",type:r,pure:!0,standalone:!0}),e})();let Khe=(()=>{var r;class e{}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275mod=Ei({type:r}),r.\u0275inj=X2({}),e})();function zG(r){return"server"===r}let epe=(()=>{var r;class e{}return(r=e).\u0275prov=He({token:r,providedIn:"root",factory:()=>new tpe(Pe(b2),window)}),e})();class tpe{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){if(!this.supportsScrolling())return;const t=function npe(r,e){const t=r.getElementById(e)||r.getElementsByName(e)[0];if(t)return t;if("function"==typeof r.createTreeWalker&&r.body&&"function"==typeof r.body.attachShadow){const n=r.createTreeWalker(r.body,NodeFilter.SHOW_ELEMENT);let i=n.currentNode;for(;i;){const s=i.shadowRoot;if(s){const o=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(o)return o}i=n.nextNode()}}return null}(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){this.supportsScrolling()&&(this.window.history.scrollRestoration=e)}scrollToElement(e){const t=e.getBoundingClientRect(),n=t.left+this.window.pageXOffset,i=t.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(n-s[0],i-s[1])}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}class DG{}class Tpe extends Lde{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class _S extends Tpe{static makeCurrent(){!function xde(r){XE||(XE=r)}(new _S)}onAndCancel(e,t,n){return e.addEventListener(t,n),()=>{e.removeEventListener(t,n)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=function Ope(){return U7=U7||document.querySelector("base"),U7?U7.getAttribute("href"):null}();return null==t?null:function bpe(r){ng=ng||document.createElement("a"),ng.setAttribute("href",r);const e=ng.pathname;return"/"===e.charAt(0)?e:`/${e}`}(t)}resetBaseElement(){U7=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return bG(document.cookie,e)}}let ng,U7=null,Ape=(()=>{var r;class e{build(){return new XMLHttpRequest}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=He({token:r,factory:r.\u0275fac}),e})();const vS=new tt("EventManagerPlugins");let GG=(()=>{var r;class e{constructor(n,i){this._zone=i,this._eventNameToPlugin=new Map,n.forEach(s=>{s.manager=this}),this._plugins=n.slice().reverse()}addEventListener(n,i,s){return this._findPluginFor(i).addEventListener(n,i,s)}getZone(){return this._zone}_findPluginFor(n){let i=this._eventNameToPlugin.get(n);if(i)return i;if(i=this._plugins.find(o=>o.supports(n)),!i)throw new ge(5101,!1);return this._eventNameToPlugin.set(n,i),i}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(vS),Pe(c1))},r.\u0275prov=He({token:r,factory:r.\u0275fac}),e})();class BG{constructor(e){this._doc=e}}const CS="ng-app-id";let UG=(()=>{var r;class e{constructor(n,i,s,o={}){this.doc=n,this.appId=i,this.nonce=s,this.platformId=o,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=zG(o),this.resetHostNodes()}addStyles(n){for(const i of n)1===this.changeUsageCount(i,1)&&this.onStyleAdded(i)}removeStyles(n){for(const i of n)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){const n=this.styleNodesInDOM;n&&(n.forEach(i=>i.remove()),n.clear());for(const i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(n){this.hostNodes.add(n);for(const i of this.getAllStyles())this.addStyleToHost(n,i)}removeHost(n){this.hostNodes.delete(n)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(n){for(const i of this.hostNodes)this.addStyleToHost(i,n)}onStyleRemoved(n){const i=this.styleRef;i.get(n)?.elements?.forEach(s=>s.remove()),i.delete(n)}collectServerRenderedStyles(){const n=this.doc.head?.querySelectorAll(`style[${CS}="${this.appId}"]`);if(n?.length){const i=new Map;return n.forEach(s=>{null!=s.textContent&&i.set(s.textContent,s)}),i}return null}changeUsageCount(n,i){const s=this.styleRef;if(s.has(n)){const o=s.get(n);return o.usage+=i,o.usage}return s.set(n,{usage:i,elements:[]}),i}getStyleElement(n,i){const s=this.styleNodesInDOM,o=s?.get(i);if(o?.parentNode===n)return s.delete(i),o.removeAttribute(CS),o;{const a=this.doc.createElement("style");return this.nonce&&a.setAttribute("nonce",this.nonce),a.textContent=i,this.platformIsServer&&a.setAttribute(CS,this.appId),a}}addStyleToHost(n,i){const s=this.getStyleElement(n,i);n.appendChild(s);const o=this.styleRef,a=o.get(i)?.elements;a?a.push(s):o.set(i,{elements:[s],usage:1})}resetHostNodes(){const n=this.hostNodes;n.clear(),n.add(this.doc.head)}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(b2),Pe(ap),Pe(sH,8),Pe(_3))},r.\u0275prov=He({token:r,factory:r.\u0275fac}),e})();const yS={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},MS=/%COMP%/g,xpe=new tt("RemoveStylesOnCompDestroy",{providedIn:"root",factory:()=>!1});function qG(r,e){return e.map(t=>t.replace(MS,r))}let ES=(()=>{var r;class e{constructor(n,i,s,o,a,c,l,f=null){this.eventManager=n,this.sharedStylesHost=i,this.appId=s,this.removeStylesOnCompDestroy=o,this.doc=a,this.platformId=c,this.ngZone=l,this.nonce=f,this.rendererByCompId=new Map,this.platformIsServer=zG(c),this.defaultRenderer=new SS(n,a,l,this.platformIsServer)}createRenderer(n,i){if(!n||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===bo.ShadowDom&&(i={...i,encapsulation:bo.Emulated});const s=this.getOrCreateRenderer(n,i);return s instanceof ZG?s.applyToHost(n):s instanceof PS&&s.applyStyles(),s}getOrCreateRenderer(n,i){const s=this.rendererByCompId;let o=s.get(i.id);if(!o){const a=this.doc,c=this.ngZone,l=this.eventManager,f=this.sharedStylesHost,d=this.removeStylesOnCompDestroy,m=this.platformIsServer;switch(i.encapsulation){case bo.Emulated:o=new ZG(l,f,i,this.appId,d,a,c,m);break;case bo.ShadowDom:return new Dpe(l,f,n,i,a,c,this.nonce,m);default:o=new PS(l,f,i,d,a,c,m)}s.set(i.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(GG),Pe(UG),Pe(ap),Pe(xpe),Pe(b2),Pe(_3),Pe(c1),Pe(sH))},r.\u0275prov=He({token:r,factory:r.\u0275fac}),e})();class SS{constructor(e,t,n,i){this.eventManager=e,this.doc=t,this.ngZone=n,this.platformIsServer=i,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(e,t){return t?this.doc.createElementNS(yS[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(jG(e)?e.content:e).appendChild(t)}insertBefore(e,t,n){e&&(jG(e)?e.content:e).insertBefore(t,n)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let n="string"==typeof e?this.doc.querySelector(e):e;if(!n)throw new ge(-5104,!1);return t||(n.textContent=""),n}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,n,i){if(i){t=i+":"+t;const s=yS[i];s?e.setAttributeNS(s,t,n):e.setAttribute(t,n)}else e.setAttribute(t,n)}removeAttribute(e,t,n){if(n){const i=yS[n];i?e.removeAttributeNS(i,t):e.removeAttribute(`${n}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,n,i){i&(N4.DashCase|N4.Important)?e.style.setProperty(t,n,i&N4.Important?"important":""):e.style[t]=n}removeStyle(e,t,n){n&N4.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,n){e[t]=n}setValue(e,t){e.nodeValue=t}listen(e,t,n){if("string"==typeof e&&!(e=L4().getGlobalEventTarget(this.doc,e)))throw new Error(`Unsupported event target ${e} for event ${t}`);return this.eventManager.addEventListener(e,t,this.decoratePreventDefault(n))}decoratePreventDefault(e){return t=>{if("__ngUnwrap__"===t)return e;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))&&t.preventDefault()}}}function jG(r){return"TEMPLATE"===r.tagName&&void 0!==r.content}class Dpe extends SS{constructor(e,t,n,i,s,o,a,c){super(e,s,o,c),this.sharedStylesHost=t,this.hostEl=n,this.shadowRoot=n.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const l=qG(i.id,i.styles);for(const f of l){const d=document.createElement("style");a&&d.setAttribute("nonce",a),d.textContent=f,this.shadowRoot.appendChild(d)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,n){return super.insertBefore(this.nodeOrShadowRoot(e),t,n)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class PS extends SS{constructor(e,t,n,i,s,o,a,c){super(e,s,o,a),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=i,this.styles=c?qG(c,n.styles):n.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}}class ZG extends PS{constructor(e,t,n,i,s,o,a,c){const l=i+"-"+n.id;super(e,t,n,s,o,a,c,l),this.contentAttr=function Lpe(r){return"_ngcontent-%COMP%".replace(MS,r)}(l),this.hostAttr=function Rpe(r){return"_nghost-%COMP%".replace(MS,r)}(l)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){const n=super.createElement(e,t);return super.setAttribute(n,this.contentAttr,""),n}}let Hpe=(()=>{var r;class e extends BG{constructor(n){super(n)}supports(n){return!0}addEventListener(n,i,s){return n.addEventListener(i,s,!1),()=>this.removeEventListener(n,i,s)}removeEventListener(n,i,s){return n.removeEventListener(i,s)}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(b2))},r.\u0275prov=He({token:r,factory:r.\u0275fac}),e})();const YG=["alt","control","meta","shift"],Vpe={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Fpe={alt:r=>r.altKey,control:r=>r.ctrlKey,meta:r=>r.metaKey,shift:r=>r.shiftKey};let $pe=(()=>{var r;class e extends BG{constructor(n){super(n)}supports(n){return null!=e.parseEventName(n)}addEventListener(n,i,s){const o=e.parseEventName(i),a=e.eventCallback(o.fullKey,s,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>L4().onAndCancel(n,o.domEventName,a))}static parseEventName(n){const i=n.toLowerCase().split("."),s=i.shift();if(0===i.length||"keydown"!==s&&"keyup"!==s)return null;const o=e._normalizeKey(i.pop());let a="",c=i.indexOf("code");if(c>-1&&(i.splice(c,1),a="code."),YG.forEach(f=>{const d=i.indexOf(f);d>-1&&(i.splice(d,1),a+=f+".")}),a+=o,0!=i.length||0===o.length)return null;const l={};return l.domEventName=s,l.fullKey=a,l}static matchEventFullKeyCode(n,i){let s=Vpe[n.key]||n.key,o="";return i.indexOf("code.")>-1&&(s=n.code,o="code."),!(null==s||!s)&&(s=s.toLowerCase()," "===s?s="space":"."===s&&(s="dot"),YG.forEach(a=>{a!==s&&(0,Fpe[a])(n)&&(o+=a+".")}),o+=s,o===i)}static eventCallback(n,i,s){return o=>{e.matchEventFullKeyCode(o,n)&&s.runGuarded(()=>i(o))}}static _normalizeKey(n){return"esc"===n?"escape":n}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(b2))},r.\u0275prov=He({token:r,factory:r.\u0275fac}),e})();const XG=[{provide:_3,useValue:"browser"},{provide:rH,useValue:function Gpe(){_S.makeCurrent()},multi:!0},{provide:b2,useFactory:function Upe(){return function L0e(r){hM=r}(document),document},deps:[]}],Wpe=B$(Cde,"browser",XG),qpe=new tt(""),QG=[{provide:Hp,useClass:class wpe{addToWindow(e){C1.getAngularTestability=(n,i=!0)=>{const s=e.findTestabilityInTree(n,i);if(null==s)throw new ge(5103,!1);return s},C1.getAllAngularTestabilities=()=>e.getAllTestabilities(),C1.getAllAngularRootElements=()=>e.getAllRootElements(),C1.frameworkStabilizers||(C1.frameworkStabilizers=[]),C1.frameworkStabilizers.push(n=>{const i=C1.getAllAngularTestabilities();let s=i.length,o=!1;const a=function(c){o=o||c,s--,0==s&&n(o)};i.forEach(c=>{c.whenStable(a)})})}findTestabilityInTree(e,t,n){return null==t?null:e.getTestability(t)??(n?L4().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null)}},deps:[]},{provide:H$,useClass:FE,deps:[c1,$E,Hp]},{provide:FE,useClass:FE,deps:[c1,$E,Hp]}],JG=[{provide:EM,useValue:"root"},{provide:o6,useFactory:function Bpe(){return new o6},deps:[]},{provide:vS,useClass:Hpe,multi:!0,deps:[b2,c1,_3]},{provide:vS,useClass:$pe,multi:!0,deps:[b2]},ES,UG,GG,{provide:C7,useExisting:ES},{provide:DG,useClass:Ape,deps:[]},[]];let eB=(()=>{var r;class e{constructor(n){}static withServerTransition(n){return{ngModule:e,providers:[{provide:ap,useValue:n.appId}]}}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(qpe,12))},r.\u0275mod=Ei({type:r}),r.\u0275inj=X2({providers:[...JG,...QG],imports:[Khe,yde]}),e})(),tB=(()=>{var r;class e{constructor(n){this._doc=n}getTitle(){return this._doc.title}setTitle(n){this._doc.title=n||""}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(b2))},r.\u0275prov=He({token:r,factory:function(n){let i=null;return i=n?new n:function Zpe(){return new tB(Pe(b2))}(),i},providedIn:"root"}),e})();typeof window<"u"&&window;let iB=(()=>{var r;class e{}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=He({token:r,factory:function(n){let i=null;return i=n?new(n||r):Pe(sB),i},providedIn:"root"}),e})(),sB=(()=>{var r;class e extends iB{constructor(n){super(),this._doc=n}sanitize(n,i){if(null==i)return null;switch(n){case Ao.NONE:return i;case Ao.HTML:return lc(i,"HTML")?eo(i):jD(this._doc,String(i)).toString();case Ao.STYLE:return lc(i,"Style")?eo(i):i;case Ao.SCRIPT:if(lc(i,"Script"))return eo(i);throw new ge(5200,!1);case Ao.URL:return lc(i,"URL")?eo(i):ep(String(i));case Ao.RESOURCE_URL:if(lc(i,"ResourceURL"))return eo(i);throw new ge(5201,!1);default:throw new ge(5202,!1)}}bypassSecurityTrustHtml(n){return function $0e(r){return new R0e(r)}(n)}bypassSecurityTrustStyle(n){return function G0e(r){return new z0e(r)}(n)}bypassSecurityTrustScript(n){return function B0e(r){return new D0e(r)}(n)}bypassSecurityTrustUrl(n){return function U0e(r){return new H0e(r)}(n)}bypassSecurityTrustResourceUrl(n){return function W0e(r){return new V0e(r)}(n)}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(b2))},r.\u0275prov=He({token:r,factory:function(n){let i=null;return i=n?new n:function Qpe(r){return new sB(r.get(b2))}(Pe(ti)),i},providedIn:"root"}),e})();function W7(r){return(W7="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(r)}function u(r,e,t){return(e=function ege(r){var e=function Jpe(r,e){if("object"!==W7(r)||null===r)return r;var t=r[Symbol.toPrimitive];if(void 0!==t){var n=t.call(r,e||"default");if("object"!==W7(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(r)}(r,"string");return"symbol"===W7(e)?e:String(e)}(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}const{isArray:tge}=Array,{getPrototypeOf:nge,prototype:rge,keys:ige}=Object;function aB(r){if(1===r.length){const e=r[0];if(tge(e))return{args:e,keys:null};if(function sge(r){return r&&"object"==typeof r&&nge(r)===rge}(e)){const t=ige(e);return{args:t.map(n=>e[n]),keys:t}}}return{args:r,keys:null}}const{isArray:oge}=Array;function cB(r){return Wn(e=>function age(r,e){return oge(e)?r(...e):r(e)}(r,e))}function lB(r,e){return r.reduce((t,n,i)=>(t[n]=e[i],t),{})}let uB=(()=>{var r;class e{constructor(n,i){this._renderer=n,this._elementRef=i,this.onChange=s=>{},this.onTouched=()=>{}}setProperty(n,i){this._renderer.setProperty(this._elementRef.nativeElement,n,i)}registerOnTouched(n){this.onTouched=n}registerOnChange(n){this.onChange=n}setDisabledState(n){this.setProperty("disabled",n)}}return(r=e).\u0275fac=function(n){return new(n||r)(B(uc),B(Oi))},r.\u0275dir=Rt({type:r}),e})(),g6=(()=>{var r;class e extends uB{}return(r=e).\u0275fac=function(){let t;return function(i){return(t||(t=or(r)))(i||r)}}(),r.\u0275dir=Rt({type:r,features:[Qe]}),e})();const mc=new tt("NgValueAccessor"),lge={provide:mc,useExisting:w1(()=>OS),multi:!0};let OS=(()=>{var r;class e extends g6{writeValue(n){this.setProperty("checked",n)}}return(r=e).\u0275fac=function(){let t;return function(i){return(t||(t=or(r)))(i||r)}}(),r.\u0275dir=Rt({type:r,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(n,i){1&n&&W("change",function(o){return i.onChange(o.target.checked)})("blur",function(){return i.onTouched()})},features:[Q1([lge]),Qe]}),e})();const uge={provide:mc,useExisting:w1(()=>_c),multi:!0},dge=new tt("CompositionEventMode");let _c=(()=>{var r;class e extends uB{constructor(n,i,s){super(n,i),this._compositionMode=s,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function fge(){const r=L4()?L4().getUserAgent():"";return/android (\d+)/.test(r.toLowerCase())}())}writeValue(n){this.setProperty("value",n??"")}_handleInput(n){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(n)}_compositionStart(){this._composing=!0}_compositionEnd(n){this._composing=!1,this._compositionMode&&this.onChange(n)}}return(r=e).\u0275fac=function(n){return new(n||r)(B(uc),B(Oi),B(dge,8))},r.\u0275dir=Rt({type:r,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(n,i){1&n&&W("input",function(o){return i._handleInput(o.target.value)})("blur",function(){return i.onTouched()})("compositionstart",function(){return i._compositionStart()})("compositionend",function(o){return i._compositionEnd(o.target.value)})},features:[Q1([uge]),Qe]}),e})();function z4(r){return null==r||("string"==typeof r||Array.isArray(r))&&0===r.length}function fB(r){return null!=r&&"number"==typeof r.length}const Ai=new tt("NgValidators"),D4=new tt("NgAsyncValidators"),hge=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class q7{static min(e){return function dB(r){return e=>{if(z4(e.value)||z4(r))return null;const t=parseFloat(e.value);return!isNaN(t)&&t<r?{min:{min:r,actual:e.value}}:null}}(e)}static max(e){return function hB(r){return e=>{if(z4(e.value)||z4(r))return null;const t=parseFloat(e.value);return!isNaN(t)&&t>r?{max:{max:r,actual:e.value}}:null}}(e)}static required(e){return pB(e)}static requiredTrue(e){return function gB(r){return!0===r.value?null:{required:!0}}(e)}static email(e){return function mB(r){return z4(r.value)||hge.test(r.value)?null:{email:!0}}(e)}static minLength(e){return function _B(r){return e=>z4(e.value)||!fB(e.value)?null:e.value.length<r?{minlength:{requiredLength:r,actualLength:e.value.length}}:null}(e)}static maxLength(e){return vB(e)}static pattern(e){return function CB(r){if(!r)return rg;let e,t;return"string"==typeof r?(t="","^"!==r.charAt(0)&&(t+="^"),t+=r,"$"!==r.charAt(r.length-1)&&(t+="$"),e=new RegExp(t)):(t=r.toString(),e=r),n=>{if(z4(n.value))return null;const i=n.value;return e.test(i)?null:{pattern:{requiredPattern:t,actualValue:i}}}}(e)}static nullValidator(e){return null}static compose(e){return TB(e)}static composeAsync(e){return OB(e)}}function pB(r){return z4(r.value)?{required:!0}:null}function vB(r){return e=>fB(e.value)&&e.value.length>r?{maxlength:{requiredLength:r,actualLength:e.value.length}}:null}function rg(r){return null}function yB(r){return null!=r}function MB(r){return A7(r)?o2(r):r}function EB(r){let e={};return r.forEach(t=>{e=null!=t?{...e,...t}:e}),0===Object.keys(e).length?null:e}function SB(r,e){return e.map(t=>t(r))}function PB(r){return r.map(e=>function pge(r){return!r.validate}(e)?e:t=>e.validate(t))}function TB(r){if(!r)return null;const e=r.filter(yB);return 0==e.length?null:function(t){return EB(SB(t,e))}}function bS(r){return null!=r?TB(PB(r)):null}function OB(r){if(!r)return null;const e=r.filter(yB);return 0==e.length?null:function(t){return function cge(...r){const e=zR(r),{args:t,keys:n}=aB(r),i=new b1(s=>{const{length:o}=t;if(!o)return void s.complete();const a=new Array(o);let c=o,l=o;for(let f=0;f<o;f++){let d=!1;Ys(t[f]).subscribe(vr(s,m=>{d||(d=!0,l--),a[f]=m},()=>c--,void 0,()=>{(!c||!d)&&(l||s.next(n?lB(n,a):a),s.complete())}))}});return e?i.pipe(cB(e)):i}(SB(t,e).map(MB)).pipe(Wn(EB))}}function wS(r){return null!=r?OB(PB(r)):null}function bB(r,e){return null===r?[e]:Array.isArray(r)?[...r,e]:[r,e]}function wB(r){return r._rawValidators}function AB(r){return r._rawAsyncValidators}function AS(r){return r?Array.isArray(r)?r:[r]:[]}function ig(r,e){return Array.isArray(r)?r.includes(e):r===e}function NB(r,e){const t=AS(e);return AS(r).forEach(i=>{ig(t,i)||t.push(i)}),t}function IB(r,e){return AS(e).filter(t=>!ig(r,t))}class kB{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=bS(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=wS(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return!!this.control&&this.control.hasError(e,t)}getError(e,t){return this.control?this.control.getError(e,t):null}}class as extends kB{get formDirective(){return null}get path(){return null}}class H4 extends kB{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class xB{constructor(e){this._cd=e}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let b3=(()=>{var r;class e extends xB{constructor(n){super(n)}}return(r=e).\u0275fac=function(n){return new(n||r)(B(H4,2))},r.\u0275dir=Rt({type:r,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(n,i){2&n&&bp("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)},features:[Qe]}),e})(),m6=(()=>{var r;class e extends xB{constructor(n){super(n)}}return(r=e).\u0275fac=function(n){return new(n||r)(B(as,10))},r.\u0275dir=Rt({type:r,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(n,i){2&n&&bp("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)("ng-submitted",i.isSubmitted)},features:[Qe]}),e})();const j7="VALID",og="INVALID",V8="PENDING",Z7="DISABLED";function kS(r){return(ag(r)?r.validators:r)||null}function xS(r,e){return(ag(e)?e.asyncValidators:r)||null}function ag(r){return null!=r&&!Array.isArray(r)&&"object"==typeof r}function RB(r,e,t){const n=r.controls;if(!(e?Object.keys(n):n).length)throw new ge(1e3,"");if(!n[t])throw new ge(1001,"")}function zB(r,e,t){r._forEachChild((n,i)=>{if(void 0===t[i])throw new ge(1002,"")})}class cg{constructor(e,t){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===j7}get invalid(){return this.status===og}get pending(){return this.status==V8}get disabled(){return this.status===Z7}get enabled(){return this.status!==Z7}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(NB(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(NB(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(IB(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(IB(e,this._rawAsyncValidators))}hasValidator(e){return ig(this._rawValidators,e)}hasAsyncValidator(e){return ig(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(t=>{t.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(t=>{t.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=V8,!1!==e.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=Z7,this.errors=null,this._forEachChild(n=>{n.disable({...e,onlySelf:!0})}),this._updateValue(),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...e,skipPristineCheck:t}),this._onDisabledChange.forEach(n=>n(!0))}enable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=j7,this._forEachChild(n=>{n.enable({...e,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors({...e,skipPristineCheck:t}),this._onDisabledChange.forEach(n=>n(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===j7||this.status===V8)&&this._runAsyncValidator(e.emitEvent)),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Z7:j7}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=V8,this._hasOwnPendingAsyncValidator=!0;const t=MB(this.asyncValidator(this));this._asyncValidationSubscription=t.subscribe(n=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(n,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(!1!==t.emitEvent)}get(e){let t=e;return null==t||(Array.isArray(t)||(t=t.split(".")),0===t.length)?null:t.reduce((n,i)=>n&&n._find(i),this)}getError(e,t){const n=t?this.get(t):this;return n&&n.errors?n.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new I1,this.statusChanges=new I1}_calculateStatus(){return this._allControlsDisabled()?Z7:this.errors?og:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(V8)?V8:this._anyControlsHaveStatus(og)?og:j7}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){ag(e)&&null!=e.updateOn&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){return!e&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=function vge(r){return Array.isArray(r)?bS(r):r||null}(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=function Cge(r){return Array.isArray(r)?wS(r):r||null}(this._rawAsyncValidators)}}class V4 extends cg{constructor(e,t,n){super(kS(t),xS(n,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t,n={}){this.registerControl(e,t),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}removeControl(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(e,t,n={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){zB(this,0,e),Object.keys(e).forEach(n=>{RB(this,!0,n),this.controls[n].setValue(e[n],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){null!=e&&(Object.keys(e).forEach(n=>{const i=this.controls[n];i&&i.patchValue(e[n],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e={},t={}){this._forEachChild((n,i)=>{n.reset(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this._reduceChildren({},(e,t,n)=>(e[n]=t.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(t,n)=>!!n._syncPendingControls()||t);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(t=>{const n=this.controls[t];n&&e(n,t)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(const[t,n]of Object.entries(this.controls))if(this.contains(t)&&e(n))return!0;return!1}_reduceValue(){return this._reduceChildren({},(t,n,i)=>((n.enabled||this.disabled)&&(t[i]=n.value),t))}_reduceChildren(e,t){let n=e;return this._forEachChild((i,s)=>{n=t(n,i,s)}),n}_allControlsDisabled(){for(const e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}}class DB extends V4{}const _6=new tt("CallSetDisabledState",{providedIn:"root",factory:()=>Y7}),Y7="always";function lg(r,e){return[...e.path,r]}function K7(r,e,t=Y7){LS(r,e),e.valueAccessor.writeValue(r.value),(r.disabled||"always"===t)&&e.valueAccessor.setDisabledState?.(r.disabled),function Mge(r,e){e.valueAccessor.registerOnChange(t=>{r._pendingValue=t,r._pendingChange=!0,r._pendingDirty=!0,"change"===r.updateOn&&HB(r,e)})}(r,e),function Sge(r,e){const t=(n,i)=>{e.valueAccessor.writeValue(n),i&&e.viewToModelUpdate(n)};r.registerOnChange(t),e._registerOnDestroy(()=>{r._unregisterOnChange(t)})}(r,e),function Ege(r,e){e.valueAccessor.registerOnTouched(()=>{r._pendingTouched=!0,"blur"===r.updateOn&&r._pendingChange&&HB(r,e),"submit"!==r.updateOn&&r.markAsTouched()})}(r,e),function yge(r,e){if(e.valueAccessor.setDisabledState){const t=n=>{e.valueAccessor.setDisabledState(n)};r.registerOnDisabledChange(t),e._registerOnDestroy(()=>{r._unregisterOnDisabledChange(t)})}}(r,e)}function ug(r,e,t=!0){const n=()=>{};e.valueAccessor&&(e.valueAccessor.registerOnChange(n),e.valueAccessor.registerOnTouched(n)),dg(r,e),r&&(e._invokeOnDestroyCallbacks(),r._registerOnCollectionChange(()=>{}))}function fg(r,e){r.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function LS(r,e){const t=wB(r);null!==e.validator?r.setValidators(bB(t,e.validator)):"function"==typeof t&&r.setValidators([t]);const n=AB(r);null!==e.asyncValidator?r.setAsyncValidators(bB(n,e.asyncValidator)):"function"==typeof n&&r.setAsyncValidators([n]);const i=()=>r.updateValueAndValidity();fg(e._rawValidators,i),fg(e._rawAsyncValidators,i)}function dg(r,e){let t=!1;if(null!==r){if(null!==e.validator){const i=wB(r);if(Array.isArray(i)&&i.length>0){const s=i.filter(o=>o!==e.validator);s.length!==i.length&&(t=!0,r.setValidators(s))}}if(null!==e.asyncValidator){const i=AB(r);if(Array.isArray(i)&&i.length>0){const s=i.filter(o=>o!==e.asyncValidator);s.length!==i.length&&(t=!0,r.setAsyncValidators(s))}}}const n=()=>{};return fg(e._rawValidators,n),fg(e._rawAsyncValidators,n),t}function HB(r,e){r._pendingDirty&&r.markAsDirty(),r.setValue(r._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(r._pendingValue),r._pendingChange=!1}function VB(r,e){LS(r,e)}function zS(r,e){if(!r.hasOwnProperty("model"))return!1;const t=r.model;return!!t.isFirstChange()||!Object.is(e,t.currentValue)}function FB(r,e){r._syncPendingControls(),e.forEach(t=>{const n=t.control;"submit"===n.updateOn&&n._pendingChange&&(t.viewToModelUpdate(n._pendingValue),n._pendingChange=!1)})}function DS(r,e){if(!e)return null;let t,n,i;return Array.isArray(e),e.forEach(s=>{s.constructor===_c?t=s:function Oge(r){return Object.getPrototypeOf(r.constructor)===g6}(s)?n=s:i=s}),i||n||t||null}const wge={provide:as,useExisting:w1(()=>Q7)},X7=(()=>Promise.resolve())();let Q7=(()=>{var r;class e extends as{constructor(n,i,s){super(),this.callSetDisabledState=s,this.submitted=!1,this._directives=new Set,this.ngSubmit=new I1,this.form=new V4({},bS(n),wS(i))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(n){X7.then(()=>{const i=this._findContainer(n.path);n.control=i.registerControl(n.name,n.control),K7(n.control,n,this.callSetDisabledState),n.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(n)})}getControl(n){return this.form.get(n.path)}removeControl(n){X7.then(()=>{const i=this._findContainer(n.path);i&&i.removeControl(n.name),this._directives.delete(n)})}addFormGroup(n){X7.then(()=>{const i=this._findContainer(n.path),s=new V4({});VB(s,n),i.registerControl(n.name,s),s.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(n){X7.then(()=>{const i=this._findContainer(n.path);i&&i.removeControl(n.name)})}getFormGroup(n){return this.form.get(n.path)}updateModel(n,i){X7.then(()=>{this.form.get(n.path).setValue(i)})}setValue(n){this.control.setValue(n)}onSubmit(n){return this.submitted=!0,FB(this.form,this._directives),this.ngSubmit.emit(n),"dialog"===n?.target?.method}onReset(){this.resetForm()}resetForm(n=void 0){this.form.reset(n),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(n){return n.pop(),n.length?this.form.get(n):this.form}}return(r=e).\u0275fac=function(n){return new(n||r)(B(Ai,10),B(D4,10),B(_6,8))},r.\u0275dir=Rt({type:r,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(n,i){1&n&&W("submit",function(o){return i.onSubmit(o)})("reset",function(){return i.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Q1([wge]),Qe]}),e})();function $B(r,e){const t=r.indexOf(e);t>-1&&r.splice(t,1)}function GB(r){return"object"==typeof r&&null!==r&&2===Object.keys(r).length&&"value"in r&&"disabled"in r}const so=class extends cg{constructor(e=null,t,n){super(kS(t),xS(n,t)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),ag(t)&&(t.nonNullable||t.initialValueIsDefault)&&(this.defaultValue=GB(e)?e.value:e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&!1!==t.emitModelToViewChange&&this._onChange.forEach(n=>n(this.value,!1!==t.emitViewToModelChange)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){$B(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){$B(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(e){GB(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}},Ige={provide:H4,useExisting:w1(()=>J7)},WB=(()=>Promise.resolve())();let J7=(()=>{var r;class e extends H4{constructor(n,i,s,o,a,c){super(),this._changeDetectorRef=a,this.callSetDisabledState=c,this.control=new so,this._registered=!1,this.name="",this.update=new I1,this._parent=n,this._setValidators(i),this._setAsyncValidators(s),this.valueAccessor=DS(0,o)}ngOnChanges(n){if(this._checkForErrors(),!this._registered||"name"in n){if(this._registered&&(this._checkName(),this.formDirective)){const i=n.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in n&&this._updateDisabled(n),zS(n,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(n){this.viewModel=n,this.update.emit(n)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){K7(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(n){WB.then(()=>{this.control.setValue(n,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(n){const i=n.isDisabled.currentValue,s=0!==i&&D8(i);WB.then(()=>{s&&!this.control.disabled?this.control.disable():!s&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(n){return this._parent?lg(n,this._parent):[n]}}return(r=e).\u0275fac=function(n){return new(n||r)(B(as,9),B(Ai,10),B(D4,10),B(mc,10),B(S3,8),B(_6,8))},r.\u0275dir=Rt({type:r,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[Q1([Ige]),Qe,Ji]}),e})(),v6=(()=>{var r;class e{}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275dir=Rt({type:r,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),e})(),jB=(()=>{var r;class e{}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275mod=Ei({type:r}),r.\u0275inj=X2({}),e})();const Rge={provide:mc,useExisting:w1(()=>hg),multi:!0};let hg=(()=>{var r;class e extends g6{writeValue(n){this.setProperty("value",parseFloat(n))}registerOnChange(n){this.onChange=i=>{n(""==i?null:parseFloat(i))}}}return(r=e).\u0275fac=function(){let t;return function(i){return(t||(t=or(r)))(i||r)}}(),r.\u0275dir=Rt({type:r,selectors:[["input","type","range","formControlName",""],["input","type","range","formControl",""],["input","type","range","ngModel",""]],hostBindings:function(n,i){1&n&&W("change",function(o){return i.onChange(o.target.value)})("input",function(o){return i.onChange(o.target.value)})("blur",function(){return i.onTouched()})},features:[Q1([Rge]),Qe]}),e})();const HS=new tt("NgModelWithFormControlWarning"),zge={provide:H4,useExisting:w1(()=>VS)};let VS=(()=>{var r;class e extends H4{set isDisabled(n){}constructor(n,i,s,o,a){super(),this._ngModelWarningConfig=o,this.callSetDisabledState=a,this.update=new I1,this._ngModelWarningSent=!1,this._setValidators(n),this._setAsyncValidators(i),this.valueAccessor=DS(0,s)}ngOnChanges(n){if(this._isControlChanged(n)){const i=n.form.previousValue;i&&ug(i,this,!1),K7(this.form,this,this.callSetDisabledState),this.form.updateValueAndValidity({emitEvent:!1})}zS(n,this.viewModel)&&(this.form.setValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.form&&ug(this.form,this,!1)}get path(){return[]}get control(){return this.form}viewToModelUpdate(n){this.viewModel=n,this.update.emit(n)}_isControlChanged(n){return n.hasOwnProperty("form")}}return(r=e)._ngModelWarningSentOnce=!1,r.\u0275fac=function(n){return new(n||r)(B(Ai,10),B(D4,10),B(mc,10),B(HS,8),B(_6,8))},r.\u0275dir=Rt({type:r,selectors:[["","formControl",""]],inputs:{form:["formControl","form"],isDisabled:["disabled","isDisabled"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},exportAs:["ngForm"],features:[Q1([zge]),Qe,Ji]}),e})();const Dge={provide:as,useExisting:w1(()=>C6)};let C6=(()=>{var r;class e extends as{constructor(n,i,s){super(),this.callSetDisabledState=s,this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new I1,this._setValidators(n),this._setAsyncValidators(i)}ngOnChanges(n){this._checkFormPresent(),n.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(dg(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(n){const i=this.form.get(n.path);return K7(i,n,this.callSetDisabledState),i.updateValueAndValidity({emitEvent:!1}),this.directives.push(n),i}getControl(n){return this.form.get(n.path)}removeControl(n){ug(n.control||null,n,!1),function bge(r,e){const t=r.indexOf(e);t>-1&&r.splice(t,1)}(this.directives,n)}addFormGroup(n){this._setUpFormContainer(n)}removeFormGroup(n){this._cleanUpFormContainer(n)}getFormGroup(n){return this.form.get(n.path)}addFormArray(n){this._setUpFormContainer(n)}removeFormArray(n){this._cleanUpFormContainer(n)}getFormArray(n){return this.form.get(n.path)}updateModel(n,i){this.form.get(n.path).setValue(i)}onSubmit(n){return this.submitted=!0,FB(this.form,this.directives),this.ngSubmit.emit(n),"dialog"===n?.target?.method}onReset(){this.resetForm()}resetForm(n=void 0){this.form.reset(n),this.submitted=!1}_updateDomValue(){this.directives.forEach(n=>{const i=n.control,s=this.form.get(n.path);i!==s&&(ug(i||null,n),(r=>r instanceof so)(s)&&(K7(s,n,this.callSetDisabledState),n.control=s))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(n){const i=this.form.get(n.path);VB(i,n),i.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(n){if(this.form){const i=this.form.get(n.path);i&&function Pge(r,e){return dg(r,e)}(i,n)&&i.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){LS(this.form,this),this._oldForm&&dg(this._oldForm,this)}_checkFormPresent(){}}return(r=e).\u0275fac=function(n){return new(n||r)(B(Ai,10),B(D4,10),B(_6,8))},r.\u0275dir=Rt({type:r,selectors:[["","formGroup",""]],hostBindings:function(n,i){1&n&&W("submit",function(o){return i.onSubmit(o)})("reset",function(){return i.onReset()})},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Q1([Dge]),Qe,Ji]}),e})();const Fge={provide:H4,useExisting:w1(()=>F8)};let F8=(()=>{var r;class e extends H4{set isDisabled(n){}constructor(n,i,s,o,a){super(),this._ngModelWarningConfig=a,this._added=!1,this.name=null,this.update=new I1,this._ngModelWarningSent=!1,this._parent=n,this._setValidators(i),this._setAsyncValidators(s),this.valueAccessor=DS(0,o)}ngOnChanges(n){this._added||this._setUpControl(),zS(n,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(n){this.viewModel=n,this.update.emit(n)}get path(){return lg(null==this.name?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this._added=!0}}return(r=e)._ngModelWarningSentOnce=!1,r.\u0275fac=function(n){return new(n||r)(B(as,13),B(Ai,10),B(D4,10),B(mc,10),B(HS,8))},r.\u0275dir=Rt({type:r,selectors:[["","formControlName",""]],inputs:{name:["formControlName","name"],isDisabled:["disabled","isDisabled"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},features:[Q1([Fge]),Qe,Ji]}),e})();const $ge={provide:mc,useExisting:w1(()=>pg),multi:!0};function KB(r,e){return null==r?`${e}`:(e&&"object"==typeof e&&(e="Object"),`${r}: ${e}`.slice(0,50))}let pg=(()=>{var r;class e extends g6{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(n){this._compareWith=n}writeValue(n){this.value=n;const s=KB(this._getOptionId(n),n);this.setProperty("value",s)}registerOnChange(n){this.onChange=i=>{this.value=this._getOptionValue(i),n(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(n){for(const i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i),n))return i;return null}_getOptionValue(n){const i=function Gge(r){return r.split(":")[0]}(n);return this._optionMap.has(i)?this._optionMap.get(i):n}}return(r=e).\u0275fac=function(){let t;return function(i){return(t||(t=or(r)))(i||r)}}(),r.\u0275dir=Rt({type:r,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(n,i){1&n&&W("change",function(o){return i.onChange(o.target.value)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},features:[Q1([$ge]),Qe]}),e})(),ef=(()=>{var r;class e{constructor(n,i,s){this._element=n,this._renderer=i,this._select=s,this._select&&(this.id=this._select._registerOption())}set ngValue(n){null!=this._select&&(this._select._optionMap.set(this.id,n),this._setElementValue(KB(this.id,n)),this._select.writeValue(this._select.value))}set value(n){this._setElementValue(n),this._select&&this._select.writeValue(this._select.value)}_setElementValue(n){this._renderer.setProperty(this._element.nativeElement,"value",n)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return(r=e).\u0275fac=function(n){return new(n||r)(B(Oi),B(uc),B(pg,9))},r.\u0275dir=Rt({type:r,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),e})();const Bge={provide:mc,useExisting:w1(()=>GS),multi:!0};function XB(r,e){return null==r?`${e}`:("string"==typeof e&&(e=`'${e}'`),e&&"object"==typeof e&&(e="Object"),`${r}: ${e}`.slice(0,50))}let GS=(()=>{var r;class e extends g6{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(n){this._compareWith=n}writeValue(n){let i;if(this.value=n,Array.isArray(n)){const s=n.map(o=>this._getOptionId(o));i=(o,a)=>{o._setSelected(s.indexOf(a.toString())>-1)}}else i=(s,o)=>{s._setSelected(!1)};this._optionMap.forEach(i)}registerOnChange(n){this.onChange=i=>{const s=[],o=i.selectedOptions;if(void 0!==o){const a=o;for(let c=0;c<a.length;c++){const f=this._getOptionValue(a[c].value);s.push(f)}}else{const a=i.options;for(let c=0;c<a.length;c++){const l=a[c];if(l.selected){const f=this._getOptionValue(l.value);s.push(f)}}}this.value=s,n(s)}}_registerOption(n){const i=(this._idCounter++).toString();return this._optionMap.set(i,n),i}_getOptionId(n){for(const i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i)._value,n))return i;return null}_getOptionValue(n){const i=function Uge(r){return r.split(":")[0]}(n);return this._optionMap.has(i)?this._optionMap.get(i)._value:n}}return(r=e).\u0275fac=function(){let t;return function(i){return(t||(t=or(r)))(i||r)}}(),r.\u0275dir=Rt({type:r,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(n,i){1&n&&W("change",function(o){return i.onChange(o.target)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},features:[Q1([Bge]),Qe]}),e})(),tf=(()=>{var r;class e{constructor(n,i,s){this._element=n,this._renderer=i,this._select=s,this._select&&(this.id=this._select._registerOption(this))}set ngValue(n){null!=this._select&&(this._value=n,this._setElementValue(XB(this.id,n)),this._select.writeValue(this._select.value))}set value(n){this._select?(this._value=n,this._setElementValue(XB(this.id,n)),this._select.writeValue(this._select.value)):this._setElementValue(n)}_setElementValue(n){this._renderer.setProperty(this._element.nativeElement,"value",n)}_setSelected(n){this._renderer.setProperty(this._element.nativeElement,"selected",n)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return(r=e).\u0275fac=function(n){return new(n||r)(B(Oi),B(uc),B(GS,9))},r.\u0275dir=Rt({type:r,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),e})();let y6=(()=>{var r;class e{constructor(){this._validator=rg}ngOnChanges(n){if(this.inputName in n){const i=this.normalizeInput(n[this.inputName].currentValue);this._enabled=this.enabled(i),this._validator=this._enabled?this.createValidator(i):rg,this._onChange&&this._onChange()}}validate(n){return this._validator(n)}registerOnValidatorChange(n){this._onChange=n}enabled(n){return null!=n}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275dir=Rt({type:r,features:[Ji]}),e})();const jge={provide:Ai,useExisting:w1(()=>M6),multi:!0};let M6=(()=>{var r;class e extends y6{constructor(){super(...arguments),this.inputName="required",this.normalizeInput=D8,this.createValidator=n=>pB}enabled(n){return n}}return(r=e).\u0275fac=function(){let t;return function(i){return(t||(t=or(r)))(i||r)}}(),r.\u0275dir=Rt({type:r,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(n,i){2&n&&I("required",i._enabled?"":null)},inputs:{required:"required"},features:[Q1([jge]),Qe]}),e})();const Xge={provide:Ai,useExisting:w1(()=>BS),multi:!0};let BS=(()=>{var r;class e extends y6{constructor(){super(...arguments),this.inputName="maxlength",this.normalizeInput=n=>function QB(r){return"number"==typeof r?r:parseInt(r,10)}(n),this.createValidator=n=>vB(n)}}return(r=e).\u0275fac=function(){let t;return function(i){return(t||(t=or(r)))(i||r)}}(),r.\u0275dir=Rt({type:r,selectors:[["","maxlength","","formControlName",""],["","maxlength","","formControl",""],["","maxlength","","ngModel",""]],hostVars:1,hostBindings:function(n,i){2&n&&I("maxlength",i._enabled?i.maxlength:null)},inputs:{maxlength:"maxlength"},features:[Q1([Xge]),Qe]}),e})(),oU=(()=>{var r;class e{}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275mod=Ei({type:r}),r.\u0275inj=X2({imports:[jB]}),e})();class aU extends cg{constructor(e,t,n){super(kS(t),xS(n,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(e){return this.controls[this._adjustIndex(e)]}push(e,t={}){this.controls.push(e),this._registerControl(e),this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}insert(e,t,n={}){this.controls.splice(e,0,t),this._registerControl(t),this.updateValueAndValidity({emitEvent:n.emitEvent})}removeAt(e,t={}){let n=this._adjustIndex(e);n<0&&(n=0),this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),this.controls.splice(n,1),this.updateValueAndValidity({emitEvent:t.emitEvent})}setControl(e,t,n={}){let i=this._adjustIndex(e);i<0&&(i=0),this.controls[i]&&this.controls[i]._registerOnCollectionChange(()=>{}),this.controls.splice(i,1),t&&(this.controls.splice(i,0,t),this._registerControl(t)),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(e,t={}){zB(this,0,e),e.forEach((n,i)=>{RB(this,!1,i),this.at(i).setValue(n,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){null!=e&&(e.forEach((n,i)=>{this.at(i)&&this.at(i).patchValue(n,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e=[],t={}){this._forEachChild((n,i)=>{n.reset(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this.controls.map(e=>e.getRawValue())}clear(e={}){this.controls.length<1||(this._forEachChild(t=>t._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:e.emitEvent}))}_adjustIndex(e){return e<0?e+this.length:e}_syncPendingControls(){let e=this.controls.reduce((t,n)=>!!n._syncPendingControls()||t,!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){this.controls.forEach((t,n)=>{e(t,n)})}_updateValue(){this.value=this.controls.filter(e=>e.enabled||this.disabled).map(e=>e.value)}_anyControls(e){return this.controls.some(t=>t.enabled&&e(t))}_setUpControls(){this._forEachChild(e=>this._registerControl(e))}_allControlsDisabled(){for(const e of this.controls)if(e.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}_find(e){return this.at(e)??null}}function cU(r){return!!r&&(void 0!==r.asyncValidators||void 0!==r.validators||void 0!==r.updateOn)}let Jge=(()=>{var r;class e{constructor(){this.useNonNullable=!1}get nonNullable(){const n=new e;return n.useNonNullable=!0,n}group(n,i=null){const s=this._reduceControls(n);let o={};return cU(i)?o=i:null!==i&&(o.validators=i.validator,o.asyncValidators=i.asyncValidator),new V4(s,o)}record(n,i=null){const s=this._reduceControls(n);return new DB(s,i)}control(n,i,s){let o={};return this.useNonNullable?(cU(i)?o=i:(o.validators=i,o.asyncValidators=s),new so(n,{...o,nonNullable:!0})):new so(n,i,s)}array(n,i,s){const o=n.map(a=>this._createControl(a));return new aU(o,i,s)}_reduceControls(n){const i={};return Object.keys(n).forEach(s=>{i[s]=this._createControl(n[s])}),i}_createControl(n){return n instanceof so||n instanceof cg?n:Array.isArray(n)?this.control(n[0],n.length>1?n[1]:null,n.length>2?n[2]:null):this.control(n)}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=He({token:r,factory:r.\u0275fac,providedIn:"root"}),e})(),eme=(()=>{var r;class e{static withConfig(n){return{ngModule:e,providers:[{provide:_6,useValue:n.callSetDisabledState??Y7}]}}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275mod=Ei({type:r}),r.\u0275inj=X2({imports:[oU]}),e})(),tme=(()=>{var r;class e{static withConfig(n){return{ngModule:e,providers:[{provide:HS,useValue:n.warnOnNgModelWithFormControl??"always"},{provide:_6,useValue:n.callSetDisabledState??Y7}]}}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275mod=Ei({type:r}),r.\u0275inj=X2({imports:[oU]}),e})();function $8(r,e){return Cn(e)?K2(r,e,1):K2(r,1)}function w3(r,e){return Yr((t,n)=>{let i=0;t.subscribe(vr(n,s=>r.call(e,s,i++)&&n.next(s)))})}function nf(r){return Yr((e,t)=>{try{e.subscribe(t)}finally{t.add(r)}})}class gg{}class mg{}class vc{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?"string"==typeof e?this.lazyInit=()=>{this.headers=new Map,e.split("\n").forEach(t=>{const n=t.indexOf(":");if(n>0){const i=t.slice(0,n),s=i.toLowerCase(),o=t.slice(n+1).trim();this.maybeSetNormalizedName(i,s),this.headers.has(s)?this.headers.get(s).push(o):this.headers.set(s,[o])}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((t,n)=>{this.setHeaderEntries(n,t)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([t,n])=>{this.setHeaderEntries(t,n)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();const t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof vc?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){const t=new vc;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof vc?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){const t=e.name.toLowerCase();switch(e.op){case"a":case"s":let n=e.value;if("string"==typeof n&&(n=[n]),0===n.length)return;this.maybeSetNormalizedName(e.name,t);const i=("a"===e.op?this.headers.get(t):void 0)||[];i.push(...n),this.headers.set(t,i);break;case"d":const s=e.value;if(s){let o=this.headers.get(t);if(!o)return;o=o.filter(a=>-1===s.indexOf(a)),0===o.length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,o)}else this.headers.delete(t),this.normalizedNames.delete(t)}}setHeaderEntries(e,t){const n=(Array.isArray(t)?t:[t]).map(s=>s.toString()),i=e.toLowerCase();this.headers.set(i,n),this.maybeSetNormalizedName(e,i)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}}class nme{encodeKey(e){return lU(e)}encodeValue(e){return lU(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}}const ime=/%(\d[a-f0-9])/gi,sme={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function lU(r){return encodeURIComponent(r).replace(ime,(e,t)=>sme[t]??e)}function _g(r){return`${r}`}class F4{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new nme,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function rme(r,e){const t=new Map;return r.length>0&&r.replace(/^\?/,"").split("&").forEach(i=>{const s=i.indexOf("="),[o,a]=-1==s?[e.decodeKey(i),""]:[e.decodeKey(i.slice(0,s)),e.decodeValue(i.slice(s+1))],c=t.get(o)||[];c.push(a),t.set(o,c)}),t}(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{const n=e.fromObject[t],i=Array.isArray(n)?n.map(_g):[_g(n)];this.map.set(t,i)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();const t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){const t=[];return Object.keys(e).forEach(n=>{const i=e[n];Array.isArray(i)?i.forEach(s=>{t.push({param:n,value:s,op:"a"})}):t.push({param:n,value:i,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{const t=this.encoder.encodeKey(e);return this.map.get(e).map(n=>t+"="+this.encoder.encodeValue(n)).join("&")}).filter(e=>""!==e).join("&")}clone(e){const t=new F4({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":const t=("a"===e.op?this.map.get(e.param):void 0)||[];t.push(_g(e.value)),this.map.set(e.param,t);break;case"d":if(void 0===e.value){this.map.delete(e.param);break}{let n=this.map.get(e.param)||[];const i=n.indexOf(_g(e.value));-1!==i&&n.splice(i,1),n.length>0?this.map.set(e.param,n):this.map.delete(e.param)}}}),this.cloneFrom=this.updates=null)}}class ome{constructor(){this.map=new Map}set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}}function uU(r){return typeof ArrayBuffer<"u"&&r instanceof ArrayBuffer}function fU(r){return typeof Blob<"u"&&r instanceof Blob}function dU(r){return typeof FormData<"u"&&r instanceof FormData}class rf{constructor(e,t,n,i){let s;if(this.url=t,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase(),function ame(r){switch(r){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||i?(this.body=void 0!==n?n:null,s=i):s=n,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params)),this.headers||(this.headers=new vc),this.context||(this.context=new ome),this.params){const o=this.params.toString();if(0===o.length)this.urlWithParams=t;else{const a=t.indexOf("?");this.urlWithParams=t+(-1===a?"?":a<t.length-1?"&":"")+o}}else this.params=new F4,this.urlWithParams=t}serializeBody(){return null===this.body?null:uU(this.body)||fU(this.body)||dU(this.body)||function cme(r){return typeof URLSearchParams<"u"&&r instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof F4?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||dU(this.body)?null:fU(this.body)?this.body.type||null:uU(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof F4?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(e={}){const t=e.method||this.method,n=e.url||this.url,i=e.responseType||this.responseType,s=void 0!==e.body?e.body:this.body,o=void 0!==e.withCredentials?e.withCredentials:this.withCredentials,a=void 0!==e.reportProgress?e.reportProgress:this.reportProgress;let c=e.headers||this.headers,l=e.params||this.params;const f=e.context??this.context;return void 0!==e.setHeaders&&(c=Object.keys(e.setHeaders).reduce((d,m)=>d.set(m,e.setHeaders[m]),c)),e.setParams&&(l=Object.keys(e.setParams).reduce((d,m)=>d.set(m,e.setParams[m]),l)),new rf(t,n,s,{params:l,headers:c,context:f,reportProgress:a,responseType:i,withCredentials:o})}}var G8=function(r){return r[r.Sent=0]="Sent",r[r.UploadProgress=1]="UploadProgress",r[r.ResponseHeader=2]="ResponseHeader",r[r.DownloadProgress=3]="DownloadProgress",r[r.Response=4]="Response",r[r.User=5]="User",r}(G8||{});class US{constructor(e,t=200,n="OK"){this.headers=e.headers||new vc,this.status=void 0!==e.status?e.status:t,this.statusText=e.statusText||n,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}}class WS extends US{constructor(e={}){super(e),this.type=G8.ResponseHeader}clone(e={}){return new WS({headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class B8 extends US{constructor(e={}){super(e),this.type=G8.Response,this.body=void 0!==e.body?e.body:null}clone(e={}){return new B8({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class hU extends US{constructor(e){super(e,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${e.url||"(unknown url)"}`:`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}}function qS(r,e){return{body:e,headers:r.headers,context:r.context,observe:r.observe,params:r.params,reportProgress:r.reportProgress,responseType:r.responseType,withCredentials:r.withCredentials}}let lme=(()=>{var r;class e{constructor(n){this.handler=n}request(n,i,s={}){let o;if(n instanceof rf)o=n;else{let l,f;l=s.headers instanceof vc?s.headers:new vc(s.headers),s.params&&(f=s.params instanceof F4?s.params:new F4({fromObject:s.params})),o=new rf(n,i,void 0!==s.body?s.body:null,{headers:l,context:s.context,params:f,reportProgress:s.reportProgress,responseType:s.responseType||"json",withCredentials:s.withCredentials})}const a=Dt(o).pipe($8(l=>this.handler.handle(l)));if(n instanceof rf||"events"===s.observe)return a;const c=a.pipe(w3(l=>l instanceof B8));switch(s.observe||"body"){case"body":switch(o.responseType){case"arraybuffer":return c.pipe(Wn(l=>{if(null!==l.body&&!(l.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return l.body}));case"blob":return c.pipe(Wn(l=>{if(null!==l.body&&!(l.body instanceof Blob))throw new Error("Response is not a Blob.");return l.body}));case"text":return c.pipe(Wn(l=>{if(null!==l.body&&"string"!=typeof l.body)throw new Error("Response is not a string.");return l.body}));default:return c.pipe(Wn(l=>l.body))}case"response":return c;default:throw new Error(`Unreachable: unhandled observe type ${s.observe}}`)}}delete(n,i={}){return this.request("DELETE",n,i)}get(n,i={}){return this.request("GET",n,i)}head(n,i={}){return this.request("HEAD",n,i)}jsonp(n,i){return this.request("JSONP",n,{params:(new F4).append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(n,i={}){return this.request("OPTIONS",n,i)}patch(n,i,s={}){return this.request("PATCH",n,qS(s,i))}post(n,i,s={}){return this.request("POST",n,qS(s,i))}put(n,i,s={}){return this.request("PUT",n,qS(s,i))}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(gg))},r.\u0275prov=He({token:r,factory:r.\u0275fac}),e})();function mU(r,e){return e(r)}function fme(r,e){return(t,n)=>e.intercept(t,{handle:i=>r(i,n)})}const hme=new tt(""),sf=new tt(""),_U=new tt("");function pme(){let r=null;return(e,t)=>{null===r&&(r=(rt(hme,{optional:!0})??[]).reduceRight(fme,mU));const n=rt(zp),i=n.add();return r(e,t).pipe(nf(()=>n.remove(i)))}}let vU=(()=>{var r;class e extends gg{constructor(n,i){super(),this.backend=n,this.injector=i,this.chain=null,this.pendingTasks=rt(zp)}handle(n){if(null===this.chain){const s=Array.from(new Set([...this.injector.get(sf),...this.injector.get(_U,[])]));this.chain=s.reduceRight((o,a)=>function dme(r,e,t){return(n,i)=>t.runInContext(()=>e(n,s=>r(s,i)))}(o,a,this.injector),mU)}const i=this.pendingTasks.add();return this.chain(n,s=>this.backend.handle(s)).pipe(nf(()=>this.pendingTasks.remove(i)))}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(mg),Pe(to))},r.\u0275prov=He({token:r,factory:r.\u0275fac}),e})();const vme=/^\)\]\}',?\n/;let yU=(()=>{var r;class e{constructor(n){this.xhrFactory=n}handle(n){if("JSONP"===n.method)throw new ge(-2800,!1);const i=this.xhrFactory;return(i.\u0275loadImpl?o2(i.\u0275loadImpl()):Dt(null)).pipe(fa(()=>new b1(o=>{const a=i.build();if(a.open(n.method,n.urlWithParams),n.withCredentials&&(a.withCredentials=!0),n.headers.forEach((z,$)=>a.setRequestHeader(z,$.join(","))),n.headers.has("Accept")||a.setRequestHeader("Accept","application/json, text/plain, */*"),!n.headers.has("Content-Type")){const z=n.detectContentTypeHeader();null!==z&&a.setRequestHeader("Content-Type",z)}if(n.responseType){const z=n.responseType.toLowerCase();a.responseType="json"!==z?z:"text"}const c=n.serializeBody();let l=null;const f=()=>{if(null!==l)return l;const z=a.statusText||"OK",$=new vc(a.getAllResponseHeaders()),G=function Cme(r){return"responseURL"in r&&r.responseURL?r.responseURL:/^X-Request-URL:/m.test(r.getAllResponseHeaders())?r.getResponseHeader("X-Request-URL"):null}(a)||n.url;return l=new WS({headers:$,status:a.status,statusText:z,url:G}),l},d=()=>{let{headers:z,status:$,statusText:G,url:de}=f(),ve=null;204!==$&&(ve=typeof a.response>"u"?a.responseText:a.response),0===$&&($=ve?200:0);let Le=$>=200&&$<300;if("json"===n.responseType&&"string"==typeof ve){const nt=ve;ve=ve.replace(vme,"");try{ve=""!==ve?JSON.parse(ve):null}catch(gt){ve=nt,Le&&(Le=!1,ve={error:gt,text:ve})}}Le?(o.next(new B8({body:ve,headers:z,status:$,statusText:G,url:de||void 0})),o.complete()):o.error(new hU({error:ve,headers:z,status:$,statusText:G,url:de||void 0}))},m=z=>{const{url:$}=f(),G=new hU({error:z,status:a.status||0,statusText:a.statusText||"Unknown Error",url:$||void 0});o.error(G)};let E=!1;const w=z=>{E||(o.next(f()),E=!0);let $={type:G8.DownloadProgress,loaded:z.loaded};z.lengthComputable&&($.total=z.total),"text"===n.responseType&&a.responseText&&($.partialText=a.responseText),o.next($)},R=z=>{let $={type:G8.UploadProgress,loaded:z.loaded};z.lengthComputable&&($.total=z.total),o.next($)};return a.addEventListener("load",d),a.addEventListener("error",m),a.addEventListener("timeout",m),a.addEventListener("abort",m),n.reportProgress&&(a.addEventListener("progress",w),null!==c&&a.upload&&a.upload.addEventListener("progress",R)),a.send(c),o.next({type:G8.Sent}),()=>{a.removeEventListener("error",m),a.removeEventListener("abort",m),a.removeEventListener("load",d),a.removeEventListener("timeout",m),n.reportProgress&&(a.removeEventListener("progress",w),null!==c&&a.upload&&a.upload.removeEventListener("progress",R)),a.readyState!==a.DONE&&a.abort()}})))}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(DG))},r.\u0275prov=He({token:r,factory:r.\u0275fac}),e})();const jS=new tt("XSRF_ENABLED"),MU=new tt("XSRF_COOKIE_NAME",{providedIn:"root",factory:()=>"XSRF-TOKEN"}),EU=new tt("XSRF_HEADER_NAME",{providedIn:"root",factory:()=>"X-XSRF-TOKEN"});class SU{}let Eme=(()=>{var r;class e{constructor(n,i,s){this.doc=n,this.platform=i,this.cookieName=s,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const n=this.doc.cookie||"";return n!==this.lastCookieString&&(this.parseCount++,this.lastToken=bG(n,this.cookieName),this.lastCookieString=n),this.lastToken}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(b2),Pe(_3),Pe(MU))},r.\u0275prov=He({token:r,factory:r.\u0275fac}),e})();function Sme(r,e){const t=r.url.toLowerCase();if(!rt(jS)||"GET"===r.method||"HEAD"===r.method||t.startsWith("http://")||t.startsWith("https://"))return e(r);const n=rt(SU).getToken(),i=rt(EU);return null!=n&&!r.headers.has(i)&&(r=r.clone({headers:r.headers.set(i,n)})),e(r)}var $4=function(r){return r[r.Interceptors=0]="Interceptors",r[r.LegacyInterceptors=1]="LegacyInterceptors",r[r.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",r[r.NoXsrfProtection=3]="NoXsrfProtection",r[r.JsonpSupport=4]="JsonpSupport",r[r.RequestsMadeViaParent=5]="RequestsMadeViaParent",r[r.Fetch=6]="Fetch",r}($4||{});function E6(r,e){return{\u0275kind:r,\u0275providers:e}}function Pme(...r){const e=[lme,yU,vU,{provide:gg,useExisting:vU},{provide:mg,useExisting:yU},{provide:sf,useValue:Sme,multi:!0},{provide:jS,useValue:!0},{provide:SU,useClass:Eme}];for(const t of r)e.push(...t.\u0275providers);return function CM(r){return{\u0275providers:r}}(e)}const PU=new tt("LEGACY_INTERCEPTOR_FN");let Ome=(()=>{var r;class e{}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275mod=Ei({type:r}),r.\u0275inj=X2({providers:[Pme(E6($4.LegacyInterceptors,[{provide:PU,useFactory:pme},{provide:sf,useExisting:PU,multi:!0}]))]}),e})();function ZS(...r){const e=Uu(r),t=zR(r),{args:n,keys:i}=aB(r);if(0===n.length)return o2([],e);const s=new b1(function xme(r,e,t=ec){return n=>{TU(e,()=>{const{length:i}=r,s=new Array(i);let o=i,a=i;for(let c=0;c<i;c++)TU(e,()=>{const l=o2(r[c],e);let f=!1;l.subscribe(vr(n,d=>{s[c]=d,f||(f=!0,a--),a||n.next(t(s.slice()))},()=>{--o||n.complete()}))},n)},n)}}(n,e,i?o=>lB(i,o):ec));return t?s.pipe(cB(t)):s}function TU(r,e,t){r?u3(t,r,e):e()}const Cg=Po(r=>function(){r(this),this.name="EmptyError",this.message="no elements in sequence"});function YS(...r){return function Lme(){return q0(1)}()(o2(r,Uu(r)))}function OU(r){return new b1(e=>{Ys(r()).subscribe(e)})}function af(r,e){const t=Cn(r)?r:()=>r,n=i=>i.error(t());return new b1(e?i=>e.schedule(n,0,i):n)}function KS(){return Yr((r,e)=>{let t=null;r._refCount++;const n=vr(e,void 0,void 0,void 0,()=>{if(!r||r._refCount<=0||0<--r._refCount)return void(t=null);const i=r._connection,s=t;t=null,i&&(!s||i===s)&&i.unsubscribe(),e.unsubscribe()});r.subscribe(n),n.closed||(t=r.connect())})}class bU extends b1{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,oh(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new yn;const t=this.getSubject();e.add(this.source.subscribe(vr(t,void 0,()=>{this._teardown(),t.complete()},n=>{this._teardown(),t.error(n)},()=>this._teardown()))),e.closed&&(this._connection=null,e=yn.EMPTY)}return e}refCount(){return KS()(this)}}function U8(r){return r<=0?()=>tc:Yr((e,t)=>{let n=0;e.subscribe(vr(t,i=>{++n<=r&&(t.next(i),r<=n&&t.complete())}))})}function yg(r){return Yr((e,t)=>{let n=!1;e.subscribe(vr(t,i=>{n=!0,t.next(i)},()=>{n||t.next(r),t.complete()}))})}function wU(r=zme){return Yr((e,t)=>{let n=!1;e.subscribe(vr(t,i=>{n=!0,t.next(i)},()=>n?t.complete():t.error(r())))})}function zme(){return new Cg}function S6(r,e){const t=arguments.length>=2;return n=>n.pipe(r?w3((i,s)=>r(i,s,n)):ec,U8(1),t?yg(e):wU(()=>new Cg))}function Ni(r,e,t){const n=Cn(r)||e||t?{next:r,error:e,complete:t}:r;return n?Yr((i,s)=>{var o;null===(o=n.subscribe)||void 0===o||o.call(n);let a=!0;i.subscribe(vr(s,c=>{var l;null===(l=n.next)||void 0===l||l.call(n,c),s.next(c)},()=>{var c;a=!1,null===(c=n.complete)||void 0===c||c.call(n),s.complete()},c=>{var l;a=!1,null===(l=n.error)||void 0===l||l.call(n,c),s.error(c)},()=>{var c,l;a&&(null===(c=n.unsubscribe)||void 0===c||c.call(n)),null===(l=n.finalize)||void 0===l||l.call(n)}))}):ec}function P6(r){return Yr((e,t)=>{let s,n=null,i=!1;n=e.subscribe(vr(t,void 0,void 0,o=>{s=Ys(r(o,P6(r)(e))),n?(n.unsubscribe(),n=null,s.subscribe(t)):i=!0})),i&&(n.unsubscribe(),n=null,s.subscribe(t))})}function XS(r){return r<=0?()=>tc:Yr((e,t)=>{let n=[];e.subscribe(vr(t,i=>{n.push(i),r<n.length&&n.shift()},()=>{for(const i of n)t.next(i);t.complete()},void 0,()=>{n=null}))})}const tn="primary",cf=Symbol("RouteTitle");class $me{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}}function W8(r){return new $me(r)}function Gme(r,e,t){const n=t.path.split("/");if(n.length>r.length||"full"===t.pathMatch&&(e.hasChildren()||n.length<r.length))return null;const i={};for(let s=0;s<n.length;s++){const o=n[s],a=r[s];if(o.startsWith(":"))i[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:r.slice(0,n.length),posParams:i}}function Cc(r,e){const t=r?Object.keys(r):void 0,n=e?Object.keys(e):void 0;if(!t||!n||t.length!=n.length)return!1;let i;for(let s=0;s<t.length;s++)if(i=t[s],!AU(r[i],e[i]))return!1;return!0}function AU(r,e){if(Array.isArray(r)&&Array.isArray(e)){if(r.length!==e.length)return!1;const t=[...r].sort(),n=[...e].sort();return t.every((i,s)=>n[s]===i)}return r===e}function NU(r){return r.length>0?r[r.length-1]:null}function G4(r){return function kme(r){return!!r&&(r instanceof b1||Cn(r.lift)&&Cn(r.subscribe))}(r)?r:A7(r)?o2(Promise.resolve(r)):Dt(r)}const Ume={exact:function xU(r,e,t){if(!T6(r.segments,e.segments)||!Mg(r.segments,e.segments,t)||r.numberOfChildren!==e.numberOfChildren)return!1;for(const n in e.children)if(!r.children[n]||!xU(r.children[n],e.children[n],t))return!1;return!0},subset:LU},IU={exact:function Wme(r,e){return Cc(r,e)},subset:function qme(r,e){return Object.keys(e).length<=Object.keys(r).length&&Object.keys(e).every(t=>AU(r[t],e[t]))},ignored:()=>!0};function kU(r,e,t){return Ume[t.paths](r.root,e.root,t.matrixParams)&&IU[t.queryParams](r.queryParams,e.queryParams)&&!("exact"===t.fragment&&r.fragment!==e.fragment)}function LU(r,e,t){return RU(r,e,e.segments,t)}function RU(r,e,t,n){if(r.segments.length>t.length){const i=r.segments.slice(0,t.length);return!(!T6(i,t)||e.hasChildren()||!Mg(i,t,n))}if(r.segments.length===t.length){if(!T6(r.segments,t)||!Mg(r.segments,t,n))return!1;for(const i in e.children)if(!r.children[i]||!LU(r.children[i],e.children[i],n))return!1;return!0}{const i=t.slice(0,r.segments.length),s=t.slice(r.segments.length);return!!(T6(r.segments,i)&&Mg(r.segments,i,n)&&r.children[tn])&&RU(r.children[tn],e,s,n)}}function Mg(r,e,t){return e.every((n,i)=>IU[t](r[i].parameters,n.parameters))}class q8{constructor(e=new l1([],{}),t={},n=null){this.root=e,this.queryParams=t,this.fragment=n}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=W8(this.queryParams)),this._queryParamMap}toString(){return Yme.serialize(this)}}class l1{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Object.values(t).forEach(n=>n.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Eg(this)}}class lf{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap||(this._parameterMap=W8(this.parameters)),this._parameterMap}toString(){return HU(this)}}function T6(r,e){return r.length===e.length&&r.every((t,n)=>t.path===e[n].path)}let uf=(()=>{var r;class e{}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=He({token:r,factory:function(){return new QS},providedIn:"root"}),e})();class QS{parse(e){const t=new o_e(e);return new q8(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){const t=`/${ff(e.root,!0)}`,n=function Qme(r){const e=Object.keys(r).map(t=>{const n=r[t];return Array.isArray(n)?n.map(i=>`${Sg(t)}=${Sg(i)}`).join("&"):`${Sg(t)}=${Sg(n)}`}).filter(t=>!!t);return e.length?`?${e.join("&")}`:""}(e.queryParams);return`${t}${n}${"string"==typeof e.fragment?`#${function Kme(r){return encodeURI(r)}(e.fragment)}`:""}`}}const Yme=new QS;function Eg(r){return r.segments.map(e=>HU(e)).join("/")}function ff(r,e){if(!r.hasChildren())return Eg(r);if(e){const t=r.children[tn]?ff(r.children[tn],!1):"",n=[];return Object.entries(r.children).forEach(([i,s])=>{i!==tn&&n.push(`${i}:${ff(s,!1)}`)}),n.length>0?`${t}(${n.join("//")})`:t}{const t=function Zme(r,e){let t=[];return Object.entries(r.children).forEach(([n,i])=>{n===tn&&(t=t.concat(e(i,n)))}),Object.entries(r.children).forEach(([n,i])=>{n!==tn&&(t=t.concat(e(i,n)))}),t}(r,(n,i)=>i===tn?[ff(r.children[tn],!1)]:[`${i}:${ff(n,!1)}`]);return 1===Object.keys(r.children).length&&null!=r.children[tn]?`${Eg(r)}/${t[0]}`:`${Eg(r)}/(${t.join("//")})`}}function zU(r){return encodeURIComponent(r).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Sg(r){return zU(r).replace(/%3B/gi,";")}function JS(r){return zU(r).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Pg(r){return decodeURIComponent(r)}function DU(r){return Pg(r.replace(/\+/g,"%20"))}function HU(r){return`${JS(r.path)}${function Xme(r){return Object.keys(r).map(e=>`;${JS(e)}=${JS(r[e])}`).join("")}(r.parameters)}`}const Jme=/^[^\/()?;#]+/;function eP(r){const e=r.match(Jme);return e?e[0]:""}const e_e=/^[^\/()?;=#]+/,n_e=/^[^=?&#]+/,i_e=/^[^&#]+/;class o_e{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new l1([],{}):new l1([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let n={};return this.peekStartsWith("(")&&(n=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(n[tn]=new l1(e,t)),n}parseSegment(){const e=eP(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new ge(4009,!1);return this.capture(e),new lf(Pg(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const t=function t_e(r){const e=r.match(e_e);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let n="";if(this.consumeOptional("=")){const i=eP(this.remaining);i&&(n=i,this.capture(n))}e[Pg(t)]=Pg(n)}parseQueryParam(e){const t=function r_e(r){const e=r.match(n_e);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let n="";if(this.consumeOptional("=")){const o=function s_e(r){const e=r.match(i_e);return e?e[0]:""}(this.remaining);o&&(n=o,this.capture(n))}const i=DU(t),s=DU(n);if(e.hasOwnProperty(i)){let o=e[i];Array.isArray(o)||(o=[o],e[i]=o),o.push(s)}else e[i]=s}parseParens(e){const t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const n=eP(this.remaining),i=this.remaining[n.length];if("/"!==i&&")"!==i&&";"!==i)throw new ge(4010,!1);let s;n.indexOf(":")>-1?(s=n.slice(0,n.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=tn);const o=this.parseChildren();t[s]=1===Object.keys(o).length?o[tn]:new l1([],o),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new ge(4011,!1)}}function VU(r){return r.segments.length>0?new l1([],{[tn]:r}):r}function FU(r){const e={};for(const n of Object.keys(r.children)){const s=FU(r.children[n]);if(n===tn&&0===s.segments.length&&s.hasChildren())for(const[o,a]of Object.entries(s.children))e[o]=a;else(s.segments.length>0||s.hasChildren())&&(e[n]=s)}return function a_e(r){if(1===r.numberOfChildren&&r.children[tn]){const e=r.children[tn];return new l1(r.segments.concat(e.segments),e.children)}return r}(new l1(r.segments,e))}function O6(r){return r instanceof q8}function $U(r){let e;const i=VU(function t(s){const o={};for(const c of s.children){const l=t(c);o[c.outlet]=l}const a=new l1(s.url,o);return s===r&&(e=a),a}(r.root));return e??i}function GU(r,e,t,n){let i=r;for(;i.parent;)i=i.parent;if(0===e.length)return tP(i,i,i,t,n);const s=function l_e(r){if("string"==typeof r[0]&&1===r.length&&"/"===r[0])return new UU(!0,0,r);let e=0,t=!1;const n=r.reduce((i,s,o)=>{if("object"==typeof s&&null!=s){if(s.outlets){const a={};return Object.entries(s.outlets).forEach(([c,l])=>{a[c]="string"==typeof l?l.split("/"):l}),[...i,{outlets:a}]}if(s.segmentPath)return[...i,s.segmentPath]}return"string"!=typeof s?[...i,s]:0===o?(s.split("/").forEach((a,c)=>{0==c&&"."===a||(0==c&&""===a?t=!0:".."===a?e++:""!=a&&i.push(a))}),i):[...i,s]},[]);return new UU(t,e,n)}(e);if(s.toRoot())return tP(i,i,new l1([],{}),t,n);const o=function u_e(r,e,t){if(r.isAbsolute)return new Og(e,!0,0);if(!t)return new Og(e,!1,NaN);if(null===t.parent)return new Og(t,!0,0);const n=Tg(r.commands[0])?0:1;return function f_e(r,e,t){let n=r,i=e,s=t;for(;s>i;){if(s-=i,n=n.parent,!n)throw new ge(4005,!1);i=n.segments.length}return new Og(n,!1,i-s)}(t,t.segments.length-1+n,r.numberOfDoubleDots)}(s,i,r),a=o.processChildren?hf(o.segmentGroup,o.index,s.commands):WU(o.segmentGroup,o.index,s.commands);return tP(i,o.segmentGroup,a,t,n)}function Tg(r){return"object"==typeof r&&null!=r&&!r.outlets&&!r.segmentPath}function df(r){return"object"==typeof r&&null!=r&&r.outlets}function tP(r,e,t,n,i){let o,s={};n&&Object.entries(n).forEach(([c,l])=>{s[c]=Array.isArray(l)?l.map(f=>`${f}`):`${l}`}),o=r===e?t:BU(r,e,t);const a=VU(FU(o));return new q8(a,s,i)}function BU(r,e,t){const n={};return Object.entries(r.children).forEach(([i,s])=>{n[i]=s===e?t:BU(s,e,t)}),new l1(r.segments,n)}class UU{constructor(e,t,n){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=n,e&&n.length>0&&Tg(n[0]))throw new ge(4003,!1);const i=n.find(df);if(i&&i!==NU(n))throw new ge(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class Og{constructor(e,t,n){this.segmentGroup=e,this.processChildren=t,this.index=n}}function WU(r,e,t){if(r||(r=new l1([],{})),0===r.segments.length&&r.hasChildren())return hf(r,e,t);const n=function h_e(r,e,t){let n=0,i=e;const s={match:!1,pathIndex:0,commandIndex:0};for(;i<r.segments.length;){if(n>=t.length)return s;const o=r.segments[i],a=t[n];if(df(a))break;const c=`${a}`,l=n<t.length-1?t[n+1]:null;if(i>0&&void 0===c)break;if(c&&l&&"object"==typeof l&&void 0===l.outlets){if(!jU(c,l,o))return s;n+=2}else{if(!jU(c,{},o))return s;n++}i++}return{match:!0,pathIndex:i,commandIndex:n}}(r,e,t),i=t.slice(n.commandIndex);if(n.match&&n.pathIndex<r.segments.length){const s=new l1(r.segments.slice(0,n.pathIndex),{});return s.children[tn]=new l1(r.segments.slice(n.pathIndex),r.children),hf(s,0,i)}return n.match&&0===i.length?new l1(r.segments,{}):n.match&&!r.hasChildren()?nP(r,e,t):n.match?hf(r,0,i):nP(r,e,t)}function hf(r,e,t){if(0===t.length)return new l1(r.segments,{});{const n=function d_e(r){return df(r[0])?r[0].outlets:{[tn]:r}}(t),i={};if(!n[tn]&&r.children[tn]&&1===r.numberOfChildren&&0===r.children[tn].segments.length){const s=hf(r.children[tn],e,t);return new l1(r.segments,s.children)}return Object.entries(n).forEach(([s,o])=>{"string"==typeof o&&(o=[o]),null!==o&&(i[s]=WU(r.children[s],e,o))}),Object.entries(r.children).forEach(([s,o])=>{void 0===n[s]&&(i[s]=o)}),new l1(r.segments,i)}}function nP(r,e,t){const n=r.segments.slice(0,e);let i=0;for(;i<t.length;){const s=t[i];if(df(s)){const c=p_e(s.outlets);return new l1(n,c)}if(0===i&&Tg(t[0])){n.push(new lf(r.segments[e].path,qU(t[0]))),i++;continue}const o=df(s)?s.outlets[tn]:`${s}`,a=i<t.length-1?t[i+1]:null;o&&a&&Tg(a)?(n.push(new lf(o,qU(a))),i+=2):(n.push(new lf(o,{})),i++)}return new l1(n,{})}function p_e(r){const e={};return Object.entries(r).forEach(([t,n])=>{"string"==typeof n&&(n=[n]),null!==n&&(e[t]=nP(new l1([],{}),0,n))}),e}function qU(r){const e={};return Object.entries(r).forEach(([t,n])=>e[t]=`${n}`),e}function jU(r,e,t){return r==t.path&&Cc(e,t.parameters)}const pf="imperative";class yc{constructor(e,t){this.id=e,this.url=t}}class rP extends yc{constructor(e,t,n="imperative",i=null){super(e,t),this.type=0,this.navigationTrigger=n,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class B4 extends yc{constructor(e,t,n){super(e,t),this.urlAfterRedirects=n,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class bg extends yc{constructor(e,t,n,i){super(e,t),this.reason=n,this.code=i,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class gf extends yc{constructor(e,t,n,i){super(e,t),this.reason=n,this.code=i,this.type=16}}class iP extends yc{constructor(e,t,n,i){super(e,t),this.error=n,this.target=i,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class g_e extends yc{constructor(e,t,n,i){super(e,t),this.urlAfterRedirects=n,this.state=i,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class m_e extends yc{constructor(e,t,n,i){super(e,t),this.urlAfterRedirects=n,this.state=i,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class __e extends yc{constructor(e,t,n,i,s){super(e,t),this.urlAfterRedirects=n,this.state=i,this.shouldActivate=s,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class v_e extends yc{constructor(e,t,n,i){super(e,t),this.urlAfterRedirects=n,this.state=i,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class C_e extends yc{constructor(e,t,n,i){super(e,t),this.urlAfterRedirects=n,this.state=i,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class y_e{constructor(e){this.route=e,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class M_e{constructor(e){this.route=e,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class E_e{constructor(e){this.snapshot=e,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class S_e{constructor(e){this.snapshot=e,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class P_e{constructor(e){this.snapshot=e,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class T_e{constructor(e){this.snapshot=e,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class ZU{constructor(e,t,n){this.routerEvent=e,this.position=t,this.anchor=n,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class O_e{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new mf,this.attachRef=null}}let mf=(()=>{var r;class e{constructor(){this.contexts=new Map}onChildOutletCreated(n,i){const s=this.getOrCreateContext(n);s.outlet=i,this.contexts.set(n,s)}onChildOutletDestroyed(n){const i=this.getContext(n);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){const n=this.contexts;return this.contexts=new Map,n}onOutletReAttached(n){this.contexts=n}getOrCreateContext(n){let i=this.getContext(n);return i||(i=new O_e,this.contexts.set(n,i)),i}getContext(n){return this.contexts.get(n)||null}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=He({token:r,factory:r.\u0275fac,providedIn:"root"}),e})();class YU{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){const t=sP(e,this._root);return t?t.children.map(n=>n.value):[]}firstChild(e){const t=sP(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){const t=oP(e,this._root);return t.length<2?[]:t[t.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return oP(e,this._root).map(t=>t.value)}}function sP(r,e){if(r===e.value)return e;for(const t of e.children){const n=sP(r,t);if(n)return n}return null}function oP(r,e){if(r===e.value)return[e];for(const t of e.children){const n=oP(r,t);if(n.length)return n.unshift(e),n}return[]}class A3{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}}function j8(r){const e={};return r&&r.children.forEach(t=>e[t.value.outlet]=t),e}class KU extends YU{constructor(e,t){super(e),this.snapshot=t,aP(this,e)}toString(){return this.snapshot.toString()}}function XU(r,e){const t=function b_e(r,e){const o=new wg([],{},{},"",{},tn,e,null,{});return new JU("",new A3(o,[]))}(0,e),n=new Xi([new lf("",{})]),i=new Xi({}),s=new Xi({}),o=new Xi({}),a=new Xi(""),c=new xs(n,i,o,a,s,tn,e,t.root);return c.snapshot=t.root,new KU(new A3(c,[]),t)}class xs{constructor(e,t,n,i,s,o,a,c){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=n,this.fragmentSubject=i,this.dataSubject=s,this.outlet=o,this.component=a,this._futureSnapshot=c,this.title=this.dataSubject?.pipe(Wn(l=>l[cf]))??Dt(void 0),this.url=e,this.params=t,this.queryParams=n,this.fragment=i,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(Wn(e=>W8(e)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(Wn(e=>W8(e)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function QU(r,e="emptyOnly"){const t=r.pathFromRoot;let n=0;if("always"!==e)for(n=t.length-1;n>=1;){const i=t[n],s=t[n-1];if(i.routeConfig&&""===i.routeConfig.path)n--;else{if(s.component)break;n--}}return function w_e(r){return r.reduce((e,t)=>({params:{...e.params,...t.params},data:{...e.data,...t.data},resolve:{...t.data,...e.resolve,...t.routeConfig?.data,...t._resolvedData}}),{params:{},data:{},resolve:{}})}(t.slice(n))}class wg{get title(){return this.data?.[cf]}constructor(e,t,n,i,s,o,a,c,l){this.url=e,this.params=t,this.queryParams=n,this.fragment=i,this.data=s,this.outlet=o,this.component=a,this.routeConfig=c,this._resolve=l}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=W8(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=W8(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(n=>n.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class JU extends YU{constructor(e,t){super(t),this.url=e,aP(this,t)}toString(){return eW(this._root)}}function aP(r,e){e.value._routerState=r,e.children.forEach(t=>aP(r,t))}function eW(r){const e=r.children.length>0?` { ${r.children.map(eW).join(", ")} } `:"";return`${r.value}${e}`}function cP(r){if(r.snapshot){const e=r.snapshot,t=r._futureSnapshot;r.snapshot=t,Cc(e.queryParams,t.queryParams)||r.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&r.fragmentSubject.next(t.fragment),Cc(e.params,t.params)||r.paramsSubject.next(t.params),function Bme(r,e){if(r.length!==e.length)return!1;for(let t=0;t<r.length;++t)if(!Cc(r[t],e[t]))return!1;return!0}(e.url,t.url)||r.urlSubject.next(t.url),Cc(e.data,t.data)||r.dataSubject.next(t.data)}else r.snapshot=r._futureSnapshot,r.dataSubject.next(r._futureSnapshot.data)}function lP(r,e){const t=Cc(r.params,e.params)&&function jme(r,e){return T6(r,e)&&r.every((t,n)=>Cc(t.parameters,e[n].parameters))}(r.url,e.url);return t&&!(!r.parent!=!e.parent)&&(!r.parent||lP(r.parent,e.parent))}let uP=(()=>{var r;class e{constructor(){this.activated=null,this._activatedRoute=null,this.name=tn,this.activateEvents=new I1,this.deactivateEvents=new I1,this.attachEvents=new I1,this.detachEvents=new I1,this.parentContexts=rt(mf),this.location=rt(ro),this.changeDetector=rt(S3),this.environmentInjector=rt(to),this.inputBinder=rt(Ag,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(n){if(n.name){const{firstChange:i,previousValue:s}=n.name;if(i)return;this.isTrackedInParentContexts(s)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(s)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(n){return this.parentContexts.getContext(n)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const n=this.parentContexts.getContext(this.name);n?.route&&(n.attachRef?this.attach(n.attachRef,n.route):this.activateWith(n.route,n.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new ge(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new ge(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new ge(4012,!1);this.location.detach();const n=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(n.instance),n}attach(n,i){this.activated=n,this._activatedRoute=i,this.location.insert(n.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(n.instance)}deactivate(){if(this.activated){const n=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(n)}}activateWith(n,i){if(this.isActivated)throw new ge(4013,!1);this._activatedRoute=n;const s=this.location,a=n.snapshot.component,c=this.parentContexts.getOrCreateContext(this.name).children,l=new A_e(n,c,s.injector);this.activated=s.createComponent(a,{index:s.length,injector:l,environmentInjector:i??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275dir=Rt({type:r,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[Ji]}),e})();class A_e{constructor(e,t,n){this.route=e,this.childContexts=t,this.parent=n}get(e,t){return e===xs?this.route:e===mf?this.childContexts:this.parent.get(e,t)}}const Ag=new tt("");let tW=(()=>{var r;class e{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(n){this.unsubscribeFromRouteData(n),this.subscribeToRouteData(n)}unsubscribeFromRouteData(n){this.outletDataSubscriptions.get(n)?.unsubscribe(),this.outletDataSubscriptions.delete(n)}subscribeToRouteData(n){const{activatedRoute:i}=n,s=ZS([i.queryParams,i.params,i.data]).pipe(fa(([o,a,c],l)=>(c={...o,...a,...c},0===l?Dt(c):Promise.resolve(c)))).subscribe(o=>{if(!n.isActivated||!n.activatedComponentRef||n.activatedRoute!==i||null===i.component)return void this.unsubscribeFromRouteData(n);const a=function kde(r){const e=Ln(r);if(!e)return null;const t=new P7(e);return{get selector(){return t.selector},get type(){return t.componentType},get inputs(){return t.inputs},get outputs(){return t.outputs},get ngContentSelectors(){return t.ngContentSelectors},get isStandalone(){return e.standalone},get isSignal(){return e.signals}}}(i.component);if(a)for(const{templateName:c}of a.inputs)n.activatedComponentRef.setInput(c,o[c]);else this.unsubscribeFromRouteData(n)});this.outletDataSubscriptions.set(n,s)}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=He({token:r,factory:r.\u0275fac}),e})();function _f(r,e,t){if(t&&r.shouldReuseRoute(e.value,t.value.snapshot)){const n=t.value;n._futureSnapshot=e.value;const i=function I_e(r,e,t){return e.children.map(n=>{for(const i of t.children)if(r.shouldReuseRoute(n.value,i.value.snapshot))return _f(r,n,i);return _f(r,n)})}(r,e,t);return new A3(n,i)}{if(r.shouldAttach(e.value)){const s=r.retrieve(e.value);if(null!==s){const o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>_f(r,a)),o}}const n=function k_e(r){return new xs(new Xi(r.url),new Xi(r.params),new Xi(r.queryParams),new Xi(r.fragment),new Xi(r.data),r.outlet,r.component,r)}(e.value),i=e.children.map(s=>_f(r,s));return new A3(n,i)}}const fP="ngNavigationCancelingError";function nW(r,e){const{redirectTo:t,navigationBehaviorOptions:n}=O6(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=rW(!1,0,e);return i.url=t,i.navigationBehaviorOptions=n,i}function rW(r,e,t){const n=new Error("NavigationCancelingError: "+(r||""));return n[fP]=!0,n.cancellationCode=e,t&&(n.url=t),n}function iW(r){return sW(r)&&O6(r.url)}function sW(r){return r&&r[fP]}let oW=(()=>{var r;class e{}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275cmp=qe({type:r,selectors:[["ng-component"]],standalone:!0,features:[HF],decls:1,vars:0,template:function(n,i){1&n&&F(0,"router-outlet")},dependencies:[uP],encapsulation:2}),e})();function dP(r){const e=r.children&&r.children.map(dP),t=e?{...r,children:e}:{...r};return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==tn&&(t.component=oW),t}function Ma(r){return r.outlet||tn}function vf(r){if(!r)return null;if(r.routeConfig?._injector)return r.routeConfig._injector;for(let e=r.parent;e;e=e.parent){const t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}class V_e{constructor(e,t,n,i,s){this.routeReuseStrategy=e,this.futureState=t,this.currState=n,this.forwardEvent=i,this.inputBindingEnabled=s}activate(e){const t=this.futureState._root,n=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,n,e),cP(this.futureState.root),this.activateChildRoutes(t,n,e)}deactivateChildRoutes(e,t,n){const i=j8(t);e.children.forEach(s=>{const o=s.value.outlet;this.deactivateRoutes(s,i[o],n),delete i[o]}),Object.values(i).forEach(s=>{this.deactivateRouteAndItsChildren(s,n)})}deactivateRoutes(e,t,n){const i=e.value,s=t?t.value:null;if(i===s)if(i.component){const o=n.getContext(i.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,n);else s&&this.deactivateRouteAndItsChildren(t,n)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){const n=t.getContext(e.value.outlet),i=n&&e.value.component?n.children:t,s=j8(e);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],i);if(n&&n.outlet){const o=n.outlet.detach(),a=n.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){const n=t.getContext(e.value.outlet),i=n&&e.value.component?n.children:t,s=j8(e);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],i);n&&(n.outlet&&(n.outlet.deactivate(),n.children.onOutletDeactivated()),n.attachRef=null,n.route=null)}activateChildRoutes(e,t,n){const i=j8(t);e.children.forEach(s=>{this.activateRoutes(s,i[s.value.outlet],n),this.forwardEvent(new T_e(s.value.snapshot))}),e.children.length&&this.forwardEvent(new S_e(e.value.snapshot))}activateRoutes(e,t,n){const i=e.value,s=t?t.value:null;if(cP(i),i===s)if(i.component){const o=n.getOrCreateContext(i.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,n);else if(i.component){const o=n.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){const a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),cP(a.route.value),this.activateChildRoutes(e,null,o.children)}else{const a=vf(i.snapshot);o.attachRef=null,o.route=i,o.injector=a,o.outlet&&o.outlet.activateWith(i,o.injector),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,n)}}class aW{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class Ng{constructor(e,t){this.component=e,this.route=t}}function F_e(r,e,t){const n=r._root;return Cf(n,e?e._root:null,t,[n.value])}function Z8(r,e){const t=Symbol(),n=e.get(r,t);return n===t?"function"!=typeof r||function Q4e(r){return null!==dh(r)}(r)?e.get(r):r:n}function Cf(r,e,t,n,i={canDeactivateChecks:[],canActivateChecks:[]}){const s=j8(e);return r.children.forEach(o=>{(function G_e(r,e,t,n,i={canDeactivateChecks:[],canActivateChecks:[]}){const s=r.value,o=e?e.value:null,a=t?t.getContext(r.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){const c=function B_e(r,e,t){if("function"==typeof t)return t(r,e);switch(t){case"pathParamsChange":return!T6(r.url,e.url);case"pathParamsOrQueryParamsChange":return!T6(r.url,e.url)||!Cc(r.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!lP(r,e)||!Cc(r.queryParams,e.queryParams);default:return!lP(r,e)}}(o,s,s.routeConfig.runGuardsAndResolvers);c?i.canActivateChecks.push(new aW(n)):(s.data=o.data,s._resolvedData=o._resolvedData),Cf(r,e,s.component?a?a.children:null:t,n,i),c&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new Ng(a.outlet.component,o))}else o&&yf(e,a,i),i.canActivateChecks.push(new aW(n)),Cf(r,null,s.component?a?a.children:null:t,n,i)})(o,s[o.value.outlet],t,n.concat([o.value]),i),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,a])=>yf(a,t.getContext(o),i)),i}function yf(r,e,t){const n=j8(r),i=r.value;Object.entries(n).forEach(([s,o])=>{yf(o,i.component?e?e.children.getContext(s):null:e,t)}),t.canDeactivateChecks.push(new Ng(i.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,i))}function Mf(r){return"function"==typeof r}function cW(r){return r instanceof Cg||"EmptyError"===r?.name}const Ig=Symbol("INITIAL_VALUE");function Y8(){return fa(r=>ZS(r.map(e=>e.pipe(U8(1),function Rme(...r){const e=Uu(r);return Yr((t,n)=>{(e?YS(r,t,e):YS(r,t)).subscribe(n)})}(Ig)))).pipe(Wn(e=>{for(const t of e)if(!0!==t){if(t===Ig)return Ig;if(!1===t||t instanceof q8)return t}return!0}),w3(e=>e!==Ig),U8(1)))}function lW(r){return function nh(...r){return rh(r)}(Ni(e=>{if(O6(e))throw nW(0,e)}),Wn(e=>!0===e))}class kg{constructor(e){this.segmentGroup=e||null}}class uW{constructor(e){this.urlTree=e}}function K8(r){return af(new kg(r))}function fW(r){return af(new uW(r))}class lve{constructor(e,t){this.urlSerializer=e,this.urlTree=t}noMatchError(e){return new ge(4002,!1)}lineralizeSegments(e,t){let n=[],i=t.root;for(;;){if(n=n.concat(i.segments),0===i.numberOfChildren)return Dt(n);if(i.numberOfChildren>1||!i.children[tn])return af(new ge(4e3,!1));i=i.children[tn]}}applyRedirectCommands(e,t,n){return this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,n)}applyRedirectCreateUrlTree(e,t,n,i){const s=this.createSegmentGroup(e,t.root,n,i);return new q8(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){const n={};return Object.entries(e).forEach(([i,s])=>{if("string"==typeof s&&s.startsWith(":")){const a=s.substring(1);n[i]=t[a]}else n[i]=s}),n}createSegmentGroup(e,t,n,i){const s=this.createSegments(e,t.segments,n,i);let o={};return Object.entries(t.children).forEach(([a,c])=>{o[a]=this.createSegmentGroup(e,c,n,i)}),new l1(s,o)}createSegments(e,t,n,i){return t.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,i):this.findOrReturn(s,n))}findPosParam(e,t,n){const i=n[t.path.substring(1)];if(!i)throw new ge(4001,!1);return i}findOrReturn(e,t){let n=0;for(const i of t){if(i.path===e.path)return t.splice(n),i;n++}return e}}const hP={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function uve(r,e,t,n,i){const s=pP(r,e,t);return s.matched?(n=function x_e(r,e){return r.providers&&!r._injector&&(r._injector=CE(r.providers,e,`Route: ${r.path}`)),r._injector??e}(e,n),function ove(r,e,t,n){const i=e.canMatch;return i&&0!==i.length?Dt(i.map(o=>{const a=Z8(o,r);return G4(function Y_e(r){return r&&Mf(r.canMatch)}(a)?a.canMatch(e,t):r.runInContext(()=>a(e,t)))})).pipe(Y8(),lW()):Dt(!0)}(n,e,t).pipe(Wn(o=>!0===o?s:{...hP}))):Dt(s)}function pP(r,e,t){if(""===e.path)return"full"===e.pathMatch&&(r.hasChildren()||t.length>0)?{...hP}:{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};const i=(e.matcher||Gme)(t,r,e);if(!i)return{...hP};const s={};Object.entries(i.posParams??{}).forEach(([a,c])=>{s[a]=c.path});const o=i.consumed.length>0?{...s,...i.consumed[i.consumed.length-1].parameters}:s;return{matched:!0,consumedSegments:i.consumed,remainingSegments:t.slice(i.consumed.length),parameters:o,positionalParamSegments:i.posParams??{}}}function dW(r,e,t,n){return t.length>0&&function hve(r,e,t){return t.some(n=>xg(r,e,n)&&Ma(n)!==tn)}(r,t,n)?{segmentGroup:new l1(e,dve(n,new l1(t,r.children))),slicedSegments:[]}:0===t.length&&function pve(r,e,t){return t.some(n=>xg(r,e,n))}(r,t,n)?{segmentGroup:new l1(r.segments,fve(r,0,t,n,r.children)),slicedSegments:t}:{segmentGroup:new l1(r.segments,r.children),slicedSegments:t}}function fve(r,e,t,n,i){const s={};for(const o of n)if(xg(r,t,o)&&!i[Ma(o)]){const a=new l1([],{});s[Ma(o)]=a}return{...i,...s}}function dve(r,e){const t={};t[tn]=e;for(const n of r)if(""===n.path&&Ma(n)!==tn){const i=new l1([],{});t[Ma(n)]=i}return t}function xg(r,e,t){return(!(r.hasChildren()||e.length>0)||"full"!==t.pathMatch)&&""===t.path}class vve{constructor(e,t,n,i,s,o,a){this.injector=e,this.configLoader=t,this.rootComponentType=n,this.config=i,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a,this.allowRedirects=!0,this.applyRedirects=new lve(this.urlSerializer,this.urlTree)}noMatchError(e){return new ge(4002,!1)}recognize(){const e=dW(this.urlTree.root,[],[],this.config).segmentGroup;return this.processSegmentGroup(this.injector,this.config,e,tn).pipe(P6(t=>{if(t instanceof uW)return this.allowRedirects=!1,this.urlTree=t.urlTree,this.match(t.urlTree);throw t instanceof kg?this.noMatchError(t):t}),Wn(t=>{const n=new wg([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},tn,this.rootComponentType,null,{}),i=new A3(n,t),s=new JU("",i),o=function c_e(r,e,t=null,n=null){return GU($U(r),e,t,n)}(n,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),this.inheritParamsAndData(s._root),{state:s,tree:o}}))}match(e){return this.processSegmentGroup(this.injector,this.config,e.root,tn).pipe(P6(n=>{throw n instanceof kg?this.noMatchError(n):n}))}inheritParamsAndData(e){const t=e.value,n=QU(t,this.paramsInheritanceStrategy);t.params=Object.freeze(n.params),t.data=Object.freeze(n.data),e.children.forEach(i=>this.inheritParamsAndData(i))}processSegmentGroup(e,t,n,i){return 0===n.segments.length&&n.hasChildren()?this.processChildren(e,t,n):this.processSegment(e,t,n,n.segments,i,!0)}processChildren(e,t,n){const i=[];for(const s of Object.keys(n.children))"primary"===s?i.unshift(s):i.push(s);return o2(i).pipe($8(s=>{const o=n.children[s],a=function D_e(r,e){const t=r.filter(n=>Ma(n)===e);return t.push(...r.filter(n=>Ma(n)!==e)),t}(t,s);return this.processSegmentGroup(e,a,o,s)}),function Hme(r,e){return Yr(function Dme(r,e,t,n,i){return(s,o)=>{let a=t,c=e,l=0;s.subscribe(vr(o,f=>{const d=l++;c=a?r(c,f,d):(a=!0,f),n&&o.next(c)},i&&(()=>{a&&o.next(c),o.complete()})))}}(r,e,arguments.length>=2,!0))}((s,o)=>(s.push(...o),s)),yg(null),function Vme(r,e){const t=arguments.length>=2;return n=>n.pipe(r?w3((i,s)=>r(i,s,n)):ec,XS(1),t?yg(e):wU(()=>new Cg))}(),K2(s=>{if(null===s)return K8(n);const o=hW(s);return function Cve(r){r.sort((e,t)=>e.value.outlet===tn?-1:t.value.outlet===tn?1:e.value.outlet.localeCompare(t.value.outlet))}(o),Dt(o)}))}processSegment(e,t,n,i,s,o){return o2(t).pipe($8(a=>this.processSegmentAgainstRoute(a._injector??e,t,a,n,i,s,o).pipe(P6(c=>{if(c instanceof kg)return Dt(null);throw c}))),S6(a=>!!a),P6(a=>{if(cW(a))return function mve(r,e,t){return 0===e.length&&!r.children[t]}(n,i,s)?Dt([]):K8(n);throw a}))}processSegmentAgainstRoute(e,t,n,i,s,o,a){return function gve(r,e,t,n){return!!(Ma(r)===n||n!==tn&&xg(e,t,r))&&("**"===r.path||pP(e,r,t).matched)}(n,i,s,o)?void 0===n.redirectTo?this.matchSegmentAgainstRoute(e,i,n,s,o,a):a&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,i,t,n,s,o):K8(i):K8(i)}expandSegmentAgainstRouteUsingRedirect(e,t,n,i,s,o){return"**"===i.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,n,i,o):this.expandRegularSegmentAgainstRouteUsingRedirect(e,t,n,i,s,o)}expandWildCardWithParamsAgainstRouteUsingRedirect(e,t,n,i){const s=this.applyRedirects.applyRedirectCommands([],n.redirectTo,{});return n.redirectTo.startsWith("/")?fW(s):this.applyRedirects.lineralizeSegments(n,s).pipe(K2(o=>{const a=new l1(o,{});return this.processSegment(e,t,a,o,i,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(e,t,n,i,s,o){const{matched:a,consumedSegments:c,remainingSegments:l,positionalParamSegments:f}=pP(t,i,s);if(!a)return K8(t);const d=this.applyRedirects.applyRedirectCommands(c,i.redirectTo,f);return i.redirectTo.startsWith("/")?fW(d):this.applyRedirects.lineralizeSegments(i,d).pipe(K2(m=>this.processSegment(e,n,t,m.concat(l),o,!1)))}matchSegmentAgainstRoute(e,t,n,i,s,o){let a;if("**"===n.path){const c=i.length>0?NU(i).parameters:{};a=Dt({snapshot:new wg(i,c,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,pW(n),Ma(n),n.component??n._loadedComponent??null,n,gW(n)),consumedSegments:[],remainingSegments:[]}),t.children={}}else a=uve(t,n,i,e).pipe(Wn(({matched:c,consumedSegments:l,remainingSegments:f,parameters:d})=>c?{snapshot:new wg(l,d,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,pW(n),Ma(n),n.component??n._loadedComponent??null,n,gW(n)),consumedSegments:l,remainingSegments:f}:null));return a.pipe(fa(c=>null===c?K8(t):this.getChildConfig(e=n._injector??e,n,i).pipe(fa(({routes:l})=>{const f=n._loadedInjector??e,{snapshot:d,consumedSegments:m,remainingSegments:E}=c,{segmentGroup:w,slicedSegments:R}=dW(t,m,E,l);if(0===R.length&&w.hasChildren())return this.processChildren(f,l,w).pipe(Wn($=>null===$?null:[new A3(d,$)]));if(0===l.length&&0===R.length)return Dt([new A3(d,[])]);const z=Ma(n)===s;return this.processSegment(f,l,w,R,z?tn:s,!0).pipe(Wn($=>[new A3(d,$)]))}))))}getChildConfig(e,t,n){return t.children?Dt({routes:t.children,injector:e}):t.loadChildren?void 0!==t._loadedRoutes?Dt({routes:t._loadedRoutes,injector:t._loadedInjector}):function sve(r,e,t,n){const i=e.canLoad;return void 0===i||0===i.length?Dt(!0):Dt(i.map(o=>{const a=Z8(o,r);return G4(function W_e(r){return r&&Mf(r.canLoad)}(a)?a.canLoad(e,t):r.runInContext(()=>a(e,t)))})).pipe(Y8(),lW())}(e,t,n).pipe(K2(i=>i?this.configLoader.loadChildren(e,t).pipe(Ni(s=>{t._loadedRoutes=s.routes,t._loadedInjector=s.injector})):function cve(r){return af(rW(!1,3))}())):Dt({routes:[],injector:e})}}function yve(r){const e=r.value.routeConfig;return e&&""===e.path}function hW(r){const e=[],t=new Set;for(const n of r){if(!yve(n)){e.push(n);continue}const i=e.find(s=>n.value.routeConfig===s.value.routeConfig);void 0!==i?(i.children.push(...n.children),t.add(i)):e.push(n)}for(const n of t){const i=hW(n.children);e.push(new A3(n.value,i))}return e.filter(n=>!t.has(n))}function pW(r){return r.data||{}}function gW(r){return r.resolve||{}}function mW(r){return"string"==typeof r.title||null===r.title}function gP(r){return fa(e=>{const t=r(e);return t?o2(t).pipe(Wn(()=>e)):Dt(e)})}const X8=new tt("ROUTES");let mP=(()=>{var r;class e{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=rt(A$)}loadComponent(n){if(this.componentLoaders.get(n))return this.componentLoaders.get(n);if(n._loadedComponent)return Dt(n._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(n);const i=G4(n.loadComponent()).pipe(Wn(_W),Ni(o=>{this.onLoadEndListener&&this.onLoadEndListener(n),n._loadedComponent=o}),nf(()=>{this.componentLoaders.delete(n)})),s=new bU(i,()=>new Ss).pipe(KS());return this.componentLoaders.set(n,s),s}loadChildren(n,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return Dt({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);const o=this.loadModuleFactoryOrRoutes(i.loadChildren).pipe(Wn(c=>{this.onLoadEndListener&&this.onLoadEndListener(i);let l,f;return Array.isArray(c)?f=c:(l=c.create(n).injector,f=l.get(X8,[],an.Self|an.Optional).flat()),{routes:f.map(dP),injector:l}}),nf(()=>{this.childrenLoaders.delete(i)})),a=new bU(o,()=>new Ss).pipe(KS());return this.childrenLoaders.set(i,a),a}loadModuleFactoryOrRoutes(n){return G4(n()).pipe(Wn(_W),K2(i=>i instanceof zF||Array.isArray(i)?Dt(i):o2(this.compiler.compileModuleAsync(i))))}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=He({token:r,factory:r.\u0275fac,providedIn:"root"}),e})();function _W(r){return function bve(r){return r&&"object"==typeof r&&"default"in r}(r)?r.default:r}let Lg=(()=>{var r;class e{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.lastSuccessfulNavigation=null,this.events=new Ss,this.configLoader=rt(mP),this.environmentInjector=rt(to),this.urlSerializer=rt(uf),this.rootContexts=rt(mf),this.inputBindingEnabled=null!==rt(Ag,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>Dt(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=s=>this.events.next(new M_e(s)),this.configLoader.onLoadStartListener=s=>this.events.next(new y_e(s))}complete(){this.transitions?.complete()}handleNavigationRequest(n){const i=++this.navigationId;this.transitions?.next({...this.transitions.value,...n,id:i})}setupNavigations(n){return this.transitions=new Xi({id:0,currentUrlTree:n.currentUrlTree,currentRawUrl:n.currentUrlTree,extractedUrl:n.urlHandlingStrategy.extract(n.currentUrlTree),urlAfterRedirects:n.urlHandlingStrategy.extract(n.currentUrlTree),rawUrl:n.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:pf,restoredState:null,currentSnapshot:n.routerState.snapshot,targetSnapshot:null,currentRouterState:n.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(w3(i=>0!==i.id),Wn(i=>({...i,extractedUrl:n.urlHandlingStrategy.extract(i.rawUrl)})),fa(i=>{let s=!1,o=!1;return Dt(i).pipe(Ni(a=>{this.currentNavigation={id:a.id,initialUrl:a.rawUrl,extractedUrl:a.extractedUrl,trigger:a.source,extras:a.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),fa(a=>{const c=n.browserUrlTree.toString(),l=!n.navigated||a.extractedUrl.toString()!==c||c!==n.currentUrlTree.toString();if(!l&&"reload"!==(a.extras.onSameUrlNavigation??n.onSameUrlNavigation)){const d="";return this.events.next(new gf(a.id,n.serializeUrl(i.rawUrl),d,0)),n.rawUrlTree=a.rawUrl,a.resolve(null),tc}if(n.urlHandlingStrategy.shouldProcessUrl(a.rawUrl))return vW(a.source)&&(n.browserUrlTree=a.extractedUrl),Dt(a).pipe(fa(d=>{const m=this.transitions?.getValue();return this.events.next(new rP(d.id,this.urlSerializer.serialize(d.extractedUrl),d.source,d.restoredState)),m!==this.transitions?.getValue()?tc:Promise.resolve(d)}),function Mve(r,e,t,n,i,s){return K2(o=>function _ve(r,e,t,n,i,s,o="emptyOnly"){return new vve(r,e,t,n,i,o,s).recognize()}(r,e,t,n,o.extractedUrl,i,s).pipe(Wn(({state:a,tree:c})=>({...o,targetSnapshot:a,urlAfterRedirects:c}))))}(this.environmentInjector,this.configLoader,this.rootComponentType,n.config,this.urlSerializer,n.paramsInheritanceStrategy),Ni(d=>{if(i.targetSnapshot=d.targetSnapshot,i.urlAfterRedirects=d.urlAfterRedirects,this.currentNavigation={...this.currentNavigation,finalUrl:d.urlAfterRedirects},"eager"===n.urlUpdateStrategy){if(!d.extras.skipLocationChange){const E=n.urlHandlingStrategy.merge(d.urlAfterRedirects,d.rawUrl);n.setBrowserUrl(E,d)}n.browserUrlTree=d.urlAfterRedirects}const m=new g_e(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects),d.targetSnapshot);this.events.next(m)}));if(l&&n.urlHandlingStrategy.shouldProcessUrl(n.rawUrlTree)){const{id:d,extractedUrl:m,source:E,restoredState:w,extras:R}=a,z=new rP(d,this.urlSerializer.serialize(m),E,w);this.events.next(z);const $=XU(0,this.rootComponentType).snapshot;return Dt(i={...a,targetSnapshot:$,urlAfterRedirects:m,extras:{...R,skipLocationChange:!1,replaceUrl:!1}})}{const d="";return this.events.next(new gf(a.id,n.serializeUrl(i.extractedUrl),d,1)),n.rawUrlTree=a.rawUrl,a.resolve(null),tc}}),Ni(a=>{const c=new m_e(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);this.events.next(c)}),Wn(a=>i={...a,guards:F_e(a.targetSnapshot,a.currentSnapshot,this.rootContexts)}),function X_e(r,e){return K2(t=>{const{targetSnapshot:n,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:o}}=t;return 0===o.length&&0===s.length?Dt({...t,guardsResult:!0}):function Q_e(r,e,t,n){return o2(r).pipe(K2(i=>function ive(r,e,t,n,i){const s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return s&&0!==s.length?Dt(s.map(a=>{const c=vf(e)??i,l=Z8(a,c);return G4(function Z_e(r){return r&&Mf(r.canDeactivate)}(l)?l.canDeactivate(r,e,t,n):c.runInContext(()=>l(r,e,t,n))).pipe(S6())})).pipe(Y8()):Dt(!0)}(i.component,i.route,t,e,n)),S6(i=>!0!==i,!0))}(o,n,i,r).pipe(K2(a=>a&&function U_e(r){return"boolean"==typeof r}(a)?function J_e(r,e,t,n){return o2(e).pipe($8(i=>YS(function tve(r,e){return null!==r&&e&&e(new E_e(r)),Dt(!0)}(i.route.parent,n),function eve(r,e){return null!==r&&e&&e(new P_e(r)),Dt(!0)}(i.route,n),function rve(r,e,t){const n=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>function $_e(r){const e=r.routeConfig?r.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:r,guards:e}:null}(o)).filter(o=>null!==o).map(o=>OU(()=>Dt(o.guards.map(c=>{const l=vf(o.node)??t,f=Z8(c,l);return G4(function j_e(r){return r&&Mf(r.canActivateChild)}(f)?f.canActivateChild(n,r):l.runInContext(()=>f(n,r))).pipe(S6())})).pipe(Y8())));return Dt(s).pipe(Y8())}(r,i.path,t),function nve(r,e,t){const n=e.routeConfig?e.routeConfig.canActivate:null;if(!n||0===n.length)return Dt(!0);const i=n.map(s=>OU(()=>{const o=vf(e)??t,a=Z8(s,o);return G4(function q_e(r){return r&&Mf(r.canActivate)}(a)?a.canActivate(e,r):o.runInContext(()=>a(e,r))).pipe(S6())}));return Dt(i).pipe(Y8())}(r,i.route,t))),S6(i=>!0!==i,!0))}(n,s,r,e):Dt(a)),Wn(a=>({...t,guardsResult:a})))})}(this.environmentInjector,a=>this.events.next(a)),Ni(a=>{if(i.guardsResult=a.guardsResult,O6(a.guardsResult))throw nW(0,a.guardsResult);const c=new __e(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot,!!a.guardsResult);this.events.next(c)}),w3(a=>!!a.guardsResult||(n.restoreHistory(a),this.cancelNavigationTransition(a,"",3),!1)),gP(a=>{if(a.guards.canActivateChecks.length)return Dt(a).pipe(Ni(c=>{const l=new v_e(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(l)}),fa(c=>{let l=!1;return Dt(c).pipe(function Eve(r,e){return K2(t=>{const{targetSnapshot:n,guards:{canActivateChecks:i}}=t;if(!i.length)return Dt(t);let s=0;return o2(i).pipe($8(o=>function Sve(r,e,t,n){const i=r.routeConfig,s=r._resolve;return void 0!==i?.title&&!mW(i)&&(s[cf]=i.title),function Pve(r,e,t,n){const i=function Tve(r){return[...Object.keys(r),...Object.getOwnPropertySymbols(r)]}(r);if(0===i.length)return Dt({});const s={};return o2(i).pipe(K2(o=>function Ove(r,e,t,n){const i=vf(e)??n,s=Z8(r,i);return G4(s.resolve?s.resolve(e,t):i.runInContext(()=>s(e,t)))}(r[o],e,t,n).pipe(S6(),Ni(a=>{s[o]=a}))),XS(1),function Fme(r){return Wn(()=>r)}(s),P6(o=>cW(o)?tc:af(o)))}(s,r,e,n).pipe(Wn(o=>(r._resolvedData=o,r.data=QU(r,t).resolve,i&&mW(i)&&(r.data[cf]=i.title),null)))}(o.route,n,r,e)),Ni(()=>s++),XS(1),K2(o=>s===i.length?Dt(t):tc))})}(n.paramsInheritanceStrategy,this.environmentInjector),Ni({next:()=>l=!0,complete:()=>{l||(n.restoreHistory(c),this.cancelNavigationTransition(c,"",2))}}))}),Ni(c=>{const l=new C_e(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(l)}))}),gP(a=>{const c=l=>{const f=[];l.routeConfig?.loadComponent&&!l.routeConfig._loadedComponent&&f.push(this.configLoader.loadComponent(l.routeConfig).pipe(Ni(d=>{l.component=d}),Wn(()=>{})));for(const d of l.children)f.push(...c(d));return f};return ZS(c(a.targetSnapshot.root)).pipe(yg(),U8(1))}),gP(()=>this.afterPreactivation()),Wn(a=>{const c=function N_e(r,e,t){const n=_f(r,e._root,t?t._root:void 0);return new KU(n,e)}(n.routeReuseStrategy,a.targetSnapshot,a.currentRouterState);return i={...a,targetRouterState:c}}),Ni(a=>{n.currentUrlTree=a.urlAfterRedirects,n.rawUrlTree=n.urlHandlingStrategy.merge(a.urlAfterRedirects,a.rawUrl),n.routerState=a.targetRouterState,"deferred"===n.urlUpdateStrategy&&(a.extras.skipLocationChange||n.setBrowserUrl(n.rawUrlTree,a),n.browserUrlTree=a.urlAfterRedirects)}),((r,e,t,n)=>Wn(i=>(new V_e(e,i.targetRouterState,i.currentRouterState,t,n).activate(r),i)))(this.rootContexts,n.routeReuseStrategy,a=>this.events.next(a),this.inputBindingEnabled),U8(1),Ni({next:a=>{s=!0,this.lastSuccessfulNavigation=this.currentNavigation,n.navigated=!0,this.events.next(new B4(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(n.currentUrlTree))),n.titleStrategy?.updateTitle(a.targetRouterState.snapshot),a.resolve(!0)},complete:()=>{s=!0}}),nf(()=>{s||o||this.cancelNavigationTransition(i,"",1),this.currentNavigation?.id===i.id&&(this.currentNavigation=null)}),P6(a=>{if(o=!0,sW(a)){iW(a)||(n.navigated=!0,n.restoreHistory(i,!0));const c=new bg(i.id,this.urlSerializer.serialize(i.extractedUrl),a.message,a.cancellationCode);if(this.events.next(c),iW(a)){const l=n.urlHandlingStrategy.merge(a.url,n.rawUrlTree),f={skipLocationChange:i.extras.skipLocationChange,replaceUrl:"eager"===n.urlUpdateStrategy||vW(i.source)};n.scheduleNavigation(l,pf,null,f,{resolve:i.resolve,reject:i.reject,promise:i.promise})}else i.resolve(!1)}else{n.restoreHistory(i,!0);const c=new iP(i.id,this.urlSerializer.serialize(i.extractedUrl),a,i.targetSnapshot??void 0);this.events.next(c);try{i.resolve(n.errorHandler(a))}catch(l){i.reject(l)}}return tc}))}))}cancelNavigationTransition(n,i,s){const o=new bg(n.id,this.urlSerializer.serialize(n.extractedUrl),i,s);this.events.next(o),n.resolve(!1)}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=He({token:r,factory:r.\u0275fac,providedIn:"root"}),e})();function vW(r){return r!==pf}let CW=(()=>{var r;class e{buildTitle(n){let i,s=n.root;for(;void 0!==s;)i=this.getResolvedTitleForRoute(s)??i,s=s.children.find(o=>o.outlet===tn);return i}getResolvedTitleForRoute(n){return n.data[cf]}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=He({token:r,factory:function(){return rt(wve)},providedIn:"root"}),e})(),wve=(()=>{var r;class e extends CW{constructor(n){super(),this.title=n}updateTitle(n){const i=this.buildTitle(n);void 0!==i&&this.title.setTitle(i)}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(tB))},r.\u0275prov=He({token:r,factory:r.\u0275fac,providedIn:"root"}),e})(),Ave=(()=>{var r;class e{}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=He({token:r,factory:function(){return rt(Ive)},providedIn:"root"}),e})();class Nve{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}}let Ive=(()=>{var r;class e extends Nve{}return(r=e).\u0275fac=function(){let t;return function(i){return(t||(t=or(r)))(i||r)}}(),r.\u0275prov=He({token:r,factory:r.\u0275fac,providedIn:"root"}),e})();const Rg=new tt("",{providedIn:"root",factory:()=>({})});let kve=(()=>{var r;class e{}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=He({token:r,factory:function(){return rt(xve)},providedIn:"root"}),e})(),xve=(()=>{var r;class e{shouldProcessUrl(n){return!0}extract(n){return n}merge(n,i){return n}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=He({token:r,factory:r.\u0275fac,providedIn:"root"}),e})();var Ef=function(r){return r[r.COMPLETE=0]="COMPLETE",r[r.FAILED=1]="FAILED",r[r.REDIRECTING=2]="REDIRECTING",r}(Ef||{});function yW(r,e){r.events.pipe(w3(t=>t instanceof B4||t instanceof bg||t instanceof iP||t instanceof gf),Wn(t=>t instanceof B4||t instanceof gf?Ef.COMPLETE:t instanceof bg&&(0===t.code||1===t.code)?Ef.REDIRECTING:Ef.FAILED),w3(t=>t!==Ef.REDIRECTING),U8(1)).subscribe(()=>{e()})}function Lve(r){throw r}function Rve(r,e,t){return e.parse("/")}const zve={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},Dve={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let Gn=(()=>{var r;class e{get navigationId(){return this.navigationTransitions.navigationId}get browserPageId(){if("computed"===this.canceledNavigationResolution)return this.location.getState()?.\u0275routerPageId}get events(){return this.navigationTransitions.events}constructor(){this.disposed=!1,this.currentPageId=0,this.console=rt(w$),this.isNgZoneEnabled=!1,this.options=rt(Rg,{optional:!0})||{},this.pendingTasks=rt(zp),this.errorHandler=this.options.errorHandler||Lve,this.malformedUriErrorHandler=this.options.malformedUriErrorHandler||Rve,this.navigated=!1,this.lastSuccessfulId=-1,this.urlHandlingStrategy=rt(kve),this.routeReuseStrategy=rt(Ave),this.titleStrategy=rt(CW),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.config=rt(X8,{optional:!0})?.flat()??[],this.navigationTransitions=rt(Lg),this.urlSerializer=rt(uf),this.location=rt(eS),this.componentInputBindingEnabled=!!rt(Ag,{optional:!0}),this.isNgZoneEnabled=rt(c1)instanceof c1&&c1.isInAngularZone(),this.resetConfig(this.config),this.currentUrlTree=new q8,this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=XU(0,null),this.navigationTransitions.setupNavigations(this).subscribe(n=>{this.lastSuccessfulId=n.id,this.currentPageId=this.browserPageId??0},n=>{this.console.warn(`Unhandled Navigation Error: ${n}`)})}resetRootComponentType(n){this.routerState.root.component=n,this.navigationTransitions.rootComponentType=n}initialNavigation(){if(this.setUpLocationChangeListener(),!this.navigationTransitions.hasRequestedNavigation){const n=this.location.getState();this.navigateToSyncWithBrowser(this.location.path(!0),pf,n)}}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(n=>{const i="popstate"===n.type?"popstate":"hashchange";"popstate"===i&&setTimeout(()=>{this.navigateToSyncWithBrowser(n.url,i,n.state)},0)}))}navigateToSyncWithBrowser(n,i,s){const o={replaceUrl:!0},a=s?.navigationId?s:null;if(s){const l={...s};delete l.navigationId,delete l.\u0275routerPageId,0!==Object.keys(l).length&&(o.state=l)}const c=this.parseUrl(n);this.scheduleNavigation(c,i,a,o)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(n){this.config=n.map(dP),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(n,i={}){const{relativeTo:s,queryParams:o,fragment:a,queryParamsHandling:c,preserveFragment:l}=i,f=l?this.currentUrlTree.fragment:a;let m,d=null;switch(c){case"merge":d={...this.currentUrlTree.queryParams,...o};break;case"preserve":d=this.currentUrlTree.queryParams;break;default:d=o||null}null!==d&&(d=this.removeEmptyProps(d));try{m=$U(s?s.snapshot:this.routerState.snapshot.root)}catch{("string"!=typeof n[0]||!n[0].startsWith("/"))&&(n=[]),m=this.currentUrlTree.root}return GU(m,n,d,f??null)}navigateByUrl(n,i={skipLocationChange:!1}){const s=O6(n)?n:this.parseUrl(n),o=this.urlHandlingStrategy.merge(s,this.rawUrlTree);return this.scheduleNavigation(o,pf,null,i)}navigate(n,i={skipLocationChange:!1}){return function Hve(r){for(let e=0;e<r.length;e++)if(null==r[e])throw new ge(4008,!1)}(n),this.navigateByUrl(this.createUrlTree(n,i),i)}serializeUrl(n){return this.urlSerializer.serialize(n)}parseUrl(n){let i;try{i=this.urlSerializer.parse(n)}catch(s){i=this.malformedUriErrorHandler(s,this.urlSerializer,n)}return i}isActive(n,i){let s;if(s=!0===i?{...zve}:!1===i?{...Dve}:i,O6(n))return kU(this.currentUrlTree,n,s);const o=this.parseUrl(n);return kU(this.currentUrlTree,o,s)}removeEmptyProps(n){return Object.keys(n).reduce((i,s)=>{const o=n[s];return null!=o&&(i[s]=o),i},{})}scheduleNavigation(n,i,s,o,a){if(this.disposed)return Promise.resolve(!1);let c,l,f;a?(c=a.resolve,l=a.reject,f=a.promise):f=new Promise((m,E)=>{c=m,l=E});const d=this.pendingTasks.add();return yW(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(d))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:s,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:n,extras:o,resolve:c,reject:l,promise:f,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),f.catch(m=>Promise.reject(m))}setBrowserUrl(n,i){const s=this.urlSerializer.serialize(n);if(this.location.isCurrentPathEqualTo(s)||i.extras.replaceUrl){const a={...i.extras.state,...this.generateNgRouterState(i.id,this.browserPageId)};this.location.replaceState(s,"",a)}else{const o={...i.extras.state,...this.generateNgRouterState(i.id,(this.browserPageId??0)+1)};this.location.go(s,"",o)}}restoreHistory(n,i=!1){if("computed"===this.canceledNavigationResolution){const o=this.currentPageId-(this.browserPageId??this.currentPageId);0!==o?this.location.historyGo(o):this.currentUrlTree===this.getCurrentNavigation()?.finalUrl&&0===o&&(this.resetState(n),this.browserUrlTree=n.currentUrlTree,this.resetUrlToCurrentUrlTree())}else"replace"===this.canceledNavigationResolution&&(i&&this.resetState(n),this.resetUrlToCurrentUrlTree())}resetState(n){this.routerState=n.currentRouterState,this.currentUrlTree=n.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,n.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(n,i){return"computed"===this.canceledNavigationResolution?{navigationId:n,\u0275routerPageId:i}:{navigationId:n}}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=He({token:r,factory:r.\u0275fac,providedIn:"root"}),e})(),Mc=(()=>{var r;class e{constructor(n,i,s,o,a,c){this.router=n,this.route=i,this.tabIndexAttribute=s,this.renderer=o,this.el=a,this.locationStrategy=c,this.href=null,this.commands=null,this.onChanges=new Ss,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1;const l=a.nativeElement.tagName?.toLowerCase();this.isAnchorElement="a"===l||"area"===l,this.isAnchorElement?this.subscription=n.events.subscribe(f=>{f instanceof B4&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(n){null!=this.tabIndexAttribute||this.isAnchorElement||this.applyAttributeValue("tabindex",n)}ngOnChanges(n){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(n){null!=n?(this.commands=Array.isArray(n)?n:[n],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(n,i,s,o,a){return!!(null===this.urlTree||this.isAnchorElement&&(0!==n||i||s||o||a||"string"==typeof this.target&&"_self"!=this.target))||(this.router.navigateByUrl(this.urlTree,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state}),!this.isAnchorElement)}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){this.href=null!==this.urlTree&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null;const n=null===this.href?null:function YD(r,e,t){return function s8e(r,e){return"src"===e&&("embed"===r||"frame"===r||"iframe"===r||"media"===r||"script"===r)||"href"===e&&("base"===r||"link"===r)?ZD:np}(e,t)(r)}(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",n)}applyAttributeValue(n,i){const s=this.renderer,o=this.el.nativeElement;null!==i?s.setAttribute(o,n,i):s.removeAttribute(o,n)}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}}return(r=e).\u0275fac=function(n){return new(n||r)(B(Gn),B(xs),function zh(r){return function E6e(r,e){if("class"===e)return r.classes;if("style"===e)return r.styles;const t=r.attrs;if(t){const n=t.length;let i=0;for(;i<n;){const s=t[i];if(KR(s))break;if(0===s)i+=2;else if("number"==typeof s)for(i++;i<n&&"string"==typeof t[i];)i++;else{if(s===e)return t[i+1];i+=2}}}return null}(ei(),r)}("tabindex"),B(uc),B(Oi),B(p6))},r.\u0275dir=Rt({type:r,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(n,i){1&n&&W("click",function(o){return i.onClick(o.button,o.ctrlKey,o.shiftKey,o.altKey,o.metaKey)}),2&n&&I("target",i.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",relativeTo:"relativeTo",preserveFragment:["preserveFragment","preserveFragment",D8],skipLocationChange:["skipLocationChange","skipLocationChange",D8],replaceUrl:["replaceUrl","replaceUrl",D8],routerLink:"routerLink"},standalone:!0,features:[rV,Ji]}),e})();class MW{}let $ve=(()=>{var r;class e{constructor(n,i,s,o,a){this.router=n,this.injector=s,this.preloadingStrategy=o,this.loader=a}setUpPreloading(){this.subscription=this.router.events.pipe(w3(n=>n instanceof B4),$8(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(n,i){const s=[];for(const o of i){o.providers&&!o._injector&&(o._injector=CE(o.providers,n,`Route: ${o.path}`));const a=o._injector??n,c=o._loadedInjector??a;(o.loadChildren&&!o._loadedRoutes&&void 0===o.canLoad||o.loadComponent&&!o._loadedComponent)&&s.push(this.preloadConfig(a,o)),(o.children||o._loadedRoutes)&&s.push(this.processRoutes(c,o.children??o._loadedRoutes))}return o2(s).pipe(q0())}preloadConfig(n,i){return this.preloadingStrategy.preload(i,()=>{let s;s=i.loadChildren&&void 0===i.canLoad?this.loader.loadChildren(n,i):Dt(null);const o=s.pipe(K2(a=>null===a?Dt(void 0):(i._loadedRoutes=a.routes,i._loadedInjector=a.injector,this.processRoutes(a.injector??n,a.routes))));return i.loadComponent&&!i._loadedComponent?o2([o,this.loader.loadComponent(i)]).pipe(q0()):o})}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(Gn),Pe(A$),Pe(to),Pe(MW),Pe(mP))},r.\u0275prov=He({token:r,factory:r.\u0275fac,providedIn:"root"}),e})();const _P=new tt("");let EW=(()=>{var r;class e{constructor(n,i,s,o,a={}){this.urlSerializer=n,this.transitions=i,this.viewportScroller=s,this.zone=o,this.options=a,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},a.scrollPositionRestoration=a.scrollPositionRestoration||"disabled",a.anchorScrolling=a.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(n=>{n instanceof rP?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=n.navigationTrigger,this.restoredId=n.restoredState?n.restoredState.navigationId:0):n instanceof B4?(this.lastId=n.id,this.scheduleScrollEvent(n,this.urlSerializer.parse(n.urlAfterRedirects).fragment)):n instanceof gf&&0===n.code&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(n,this.urlSerializer.parse(n.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(n=>{n instanceof ZU&&(n.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(n.position):n.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(n.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(n,i){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new ZU(n,"popstate"===this.lastSource?this.store[this.restoredId]:null,i))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}}return(r=e).\u0275fac=function(n){!function IH(){throw new Error("invalid")}()},r.\u0275prov=He({token:r,factory:r.\u0275fac}),e})();function N3(r,e){return{\u0275kind:r,\u0275providers:e}}function PW(){const r=rt(ti);return e=>{const t=r.get(d6);if(e!==t.components[0])return;const n=r.get(Gn),i=r.get(TW);1===r.get(vP)&&n.initialNavigation(),r.get(OW,null,an.Optional)?.setUpPreloading(),r.get(_P,null,an.Optional)?.init(),n.resetRootComponentType(t.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}const TW=new tt("",{factory:()=>new Ss}),vP=new tt("",{providedIn:"root",factory:()=>1}),OW=new tt("");function Wve(r){return N3(0,[{provide:OW,useExisting:$ve},{provide:MW,useExisting:r}])}const bW=new tt("ROUTER_FORROOT_GUARD"),jve=[eS,{provide:uf,useClass:QS},Gn,mf,{provide:xs,useFactory:function SW(r){return r.routerState.root},deps:[Gn]},mP,[]];function Zve(){return new $$("Router",Gn)}let Yve=(()=>{var r;class e{constructor(n){}static forRoot(n,i){return{ngModule:e,providers:[jve,[],{provide:X8,multi:!0,useValue:n},{provide:bW,useFactory:Jve,deps:[[Gn,new rs,new Vh]]},{provide:Rg,useValue:i||{}},i?.useHash?{provide:p6,useClass:Dde}:{provide:p6,useClass:mG},{provide:_P,useFactory:()=>{const r=rt(epe),e=rt(c1),t=rt(Rg),n=rt(Lg),i=rt(uf);return t.scrollOffset&&r.setOffset(t.scrollOffset),new EW(i,n,r,e,t)}},i?.preloadingStrategy?Wve(i.preloadingStrategy).\u0275providers:[],{provide:$$,multi:!0,useFactory:Zve},i?.initialNavigation?eCe(i):[],i?.bindToComponentInputs?N3(8,[tW,{provide:Ag,useExisting:tW}]).\u0275providers:[],[{provide:wW,useFactory:PW},{provide:UE,multi:!0,useExisting:wW}]]}}static forChild(n){return{ngModule:e,providers:[{provide:X8,multi:!0,useValue:n}]}}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(bW,8))},r.\u0275mod=Ei({type:r}),r.\u0275inj=X2({}),e})();function Jve(r){return"guarded"}function eCe(r){return["disabled"===r.initialNavigation?N3(3,[{provide:LE,multi:!0,useFactory:()=>{const e=rt(Gn);return()=>{e.setUpLocationChangeListener()}}},{provide:vP,useValue:2}]).\u0275providers:[],"enabledBlocking"===r.initialNavigation?N3(2,[{provide:vP,useValue:0},{provide:LE,multi:!0,deps:[ti],useFactory:e=>{const t=e.get(Rde,Promise.resolve());return()=>t.then(()=>new Promise(n=>{const i=e.get(Gn),s=e.get(TW);yW(i,()=>{n(!0)}),e.get(Lg).afterPreactivation=()=>(n(!0),s.closed?Dt(void 0):s),i.initialNavigation()}))}}]).\u0275providers:[]]}const wW=new tt("");class AW{}class nCe{}const I3="*";function NW(r,e=null){return{type:2,steps:r,options:e}}function IW(r){return{type:6,styles:r,offset:null}}class Sf{constructor(e=0,t=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=e+t}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){queueMicrotask(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(e=>e()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(e){this._position=this.totalTime?e*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(n=>n()),t.length=0}}class kW{constructor(e){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=e;let t=0,n=0,i=0;const s=this.players.length;0==s?queueMicrotask(()=>this._onFinish()):this.players.forEach(o=>{o.onDone(()=>{++t==s&&this._onFinish()}),o.onDestroy(()=>{++n==s&&this._onDestroy()}),o.onStart(()=>{++i==s&&this._onStart()})}),this.totalTime=this.players.reduce((o,a)=>Math.max(o,a.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this.players.forEach(e=>e.init())}onStart(e){this._onStartFns.push(e)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(e=>e()),this._onStartFns=[])}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(e=>e.play())}pause(){this.players.forEach(e=>e.pause())}restart(){this.players.forEach(e=>e.restart())}finish(){this._onFinish(),this.players.forEach(e=>e.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(e=>e.destroy()),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this.players.forEach(e=>e.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(e){const t=e*this.totalTime;this.players.forEach(n=>{const i=n.totalTime?Math.min(1,t/n.totalTime):1;n.setPosition(i)})}getPosition(){const e=this.players.reduce((t,n)=>null===t||n.totalTime>t.totalTime?n:t,null);return null!=e?e.getPosition():0}beforeDestroy(){this.players.forEach(e=>{e.beforeDestroy&&e.beforeDestroy()})}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(n=>n()),t.length=0}}function xW(r){return new ge(3e3,!1)}function U4(r){switch(r.length){case 0:return new Sf;case 1:return r[0];default:return new kW(r)}}function LW(r,e,t=new Map,n=new Map){const i=[],s=[];let o=-1,a=null;if(e.forEach(c=>{const l=c.get("offset"),f=l==o,d=f&&a||new Map;c.forEach((m,E)=>{let w=E,R=m;if("offset"!==E)switch(w=r.normalizePropertyName(w,i),R){case"!":R=t.get(E);break;case I3:R=n.get(E);break;default:R=r.normalizeStyleValue(E,w,R,i)}d.set(w,R)}),f||s.push(d),a=d,o=l}),i.length)throw function TCe(r){return new ge(3502,!1)}();return s}function yP(r,e,t,n){switch(e){case"start":r.onStart(()=>n(t&&MP(t,"start",r)));break;case"done":r.onDone(()=>n(t&&MP(t,"done",r)));break;case"destroy":r.onDestroy(()=>n(t&&MP(t,"destroy",r)))}}function MP(r,e,t){const s=EP(r.element,r.triggerName,r.fromState,r.toState,e||r.phaseName,t.totalTime??r.totalTime,!!t.disabled),o=r._data;return null!=o&&(s._data=o),s}function EP(r,e,t,n,i="",s=0,o){return{element:r,triggerName:e,fromState:t,toState:n,phaseName:i,totalTime:s,disabled:!!o}}function oo(r,e,t){let n=r.get(e);return n||r.set(e,n=t),n}function RW(r){const e=r.indexOf(":");return[r.substring(1,e),r.slice(e+1)]}const DCe=(()=>typeof document>"u"?null:document.documentElement)();function SP(r){const e=r.parentNode||r.host||null;return e===DCe?null:e}let b6=null,zW=!1;function DW(r,e){for(;e;){if(e===r)return!0;e=SP(e)}return!1}function HW(r,e,t){if(t)return Array.from(r.querySelectorAll(e));const n=r.querySelector(e);return n?[n]:[]}let VW=(()=>{var r;class e{validateStyleProperty(n){return function VCe(r){b6||(b6=function FCe(){return typeof document<"u"?document.body:null}()||{},zW=!!b6.style&&"WebkitAppearance"in b6.style);let e=!0;return b6.style&&!function HCe(r){return"ebkit"==r.substring(1,6)}(r)&&(e=r in b6.style,!e&&zW&&(e="Webkit"+r.charAt(0).toUpperCase()+r.slice(1)in b6.style)),e}(n)}matchesElement(n,i){return!1}containsElement(n,i){return DW(n,i)}getParentElement(n){return SP(n)}query(n,i,s){return HW(n,i,s)}computeStyle(n,i,s){return s||""}animate(n,i,s,o,a,c=[],l){return new Sf(s,o)}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=He({token:r,factory:r.\u0275fac}),e})(),PP=(()=>{class e{}return e.NOOP=new VW,e})();const $Ce=1e3,TP="ng-enter",zg="ng-leave",Dg="ng-trigger",Hg=".ng-trigger",$W="ng-animating",OP=".ng-animating";function k3(r){if("number"==typeof r)return r;const e=r.match(/^(-?[\.\d]+)(m?s)/);return!e||e.length<2?0:bP(parseFloat(e[1]),e[2])}function bP(r,e){return"s"===e?r*$Ce:r}function Vg(r,e,t){return r.hasOwnProperty("duration")?r:function BCe(r,e,t){let i,s=0,o="";if("string"==typeof r){const a=r.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===a)return e.push(xW()),{duration:0,delay:0,easing:""};i=bP(parseFloat(a[1]),a[2]);const c=a[3];null!=c&&(s=bP(parseFloat(c),a[4]));const l=a[5];l&&(o=l)}else i=r;if(!t){let a=!1,c=e.length;i<0&&(e.push(function rCe(){return new ge(3100,!1)}()),a=!0),s<0&&(e.push(function iCe(){return new ge(3101,!1)}()),a=!0),a&&e.splice(c,0,xW())}return{duration:i,delay:s,easing:o}}(r,e,t)}function Pf(r,e={}){return Object.keys(r).forEach(t=>{e[t]=r[t]}),e}function GW(r){const e=new Map;return Object.keys(r).forEach(t=>{e.set(t,r[t])}),e}function W4(r,e=new Map,t){if(t)for(let[n,i]of t)e.set(n,i);for(let[n,i]of r)e.set(n,i);return e}function Ec(r,e,t){e.forEach((n,i)=>{const s=AP(i);t&&!t.has(i)&&t.set(i,r.style[s]),r.style[s]=n})}function w6(r,e){e.forEach((t,n)=>{const i=AP(n);r.style[i]=""})}function Tf(r){return Array.isArray(r)?1==r.length?r[0]:NW(r):r}const wP=new RegExp("{{\\s*(.+?)\\s*}}","g");function UW(r){let e=[];if("string"==typeof r){let t;for(;t=wP.exec(r);)e.push(t[1]);wP.lastIndex=0}return e}function Of(r,e,t){const n=r.toString(),i=n.replace(wP,(s,o)=>{let a=e[o];return null==a&&(t.push(function oCe(r){return new ge(3003,!1)}()),a=""),a.toString()});return i==n?r:i}function Fg(r){const e=[];let t=r.next();for(;!t.done;)e.push(t.value),t=r.next();return e}const qCe=/-+([a-z0-9])/g;function AP(r){return r.replace(qCe,(...e)=>e[1].toUpperCase())}function ao(r,e,t){switch(e.type){case 7:return r.visitTrigger(e,t);case 0:return r.visitState(e,t);case 1:return r.visitTransition(e,t);case 2:return r.visitSequence(e,t);case 3:return r.visitGroup(e,t);case 4:return r.visitAnimate(e,t);case 5:return r.visitKeyframes(e,t);case 6:return r.visitStyle(e,t);case 8:return r.visitReference(e,t);case 9:return r.visitAnimateChild(e,t);case 10:return r.visitAnimateRef(e,t);case 11:return r.visitQuery(e,t);case 12:return r.visitStagger(e,t);default:throw function aCe(r){return new ge(3004,!1)}()}}function WW(r,e){return window.getComputedStyle(r)[e]}const $g="*";function YCe(r,e){const t=[];return"string"==typeof r?r.split(/\s*,\s*/).forEach(n=>function KCe(r,e,t){if(":"==r[0]){const c=function XCe(r,e){switch(r){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(t,n)=>parseFloat(n)>parseFloat(t);case":decrement":return(t,n)=>parseFloat(n)<parseFloat(t);default:return e.push(function MCe(r){return new ge(3016,!1)}()),"* => *"}}(r,t);if("function"==typeof c)return void e.push(c);r=c}const n=r.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==n||n.length<4)return t.push(function yCe(r){return new ge(3015,!1)}()),e;const i=n[1],s=n[2],o=n[3];e.push(qW(i,o));"<"==s[0]&&!(i==$g&&o==$g)&&e.push(qW(o,i))}(n,t,e)):t.push(r),t}const Gg=new Set(["true","1"]),Bg=new Set(["false","0"]);function qW(r,e){const t=Gg.has(r)||Bg.has(r),n=Gg.has(e)||Bg.has(e);return(i,s)=>{let o=r==$g||r==i,a=e==$g||e==s;return!o&&t&&"boolean"==typeof i&&(o=i?Gg.has(r):Bg.has(r)),!a&&n&&"boolean"==typeof s&&(a=s?Gg.has(e):Bg.has(e)),o&&a}}const QCe=new RegExp("s*:selfs*,?","g");function NP(r,e,t,n){return new JCe(r).build(e,t,n)}class JCe{constructor(e){this._driver=e}build(e,t,n){const i=new nye(t);return this._resetContextStyleTimingState(i),ao(this,Tf(e),i)}_resetContextStyleTimingState(e){e.currentQuerySelector="",e.collectedStyles=new Map,e.collectedStyles.set("",new Map),e.currentTime=0}visitTrigger(e,t){let n=t.queryCount=0,i=t.depCount=0;const s=[],o=[];return"@"==e.name.charAt(0)&&t.errors.push(function lCe(){return new ge(3006,!1)}()),e.definitions.forEach(a=>{if(this._resetContextStyleTimingState(t),0==a.type){const c=a,l=c.name;l.toString().split(/\s*,\s*/).forEach(f=>{c.name=f,s.push(this.visitState(c,t))}),c.name=l}else if(1==a.type){const c=this.visitTransition(a,t);n+=c.queryCount,i+=c.depCount,o.push(c)}else t.errors.push(function uCe(){return new ge(3007,!1)}())}),{type:7,name:e.name,states:s,transitions:o,queryCount:n,depCount:i,options:null}}visitState(e,t){const n=this.visitStyle(e.styles,t),i=e.options&&e.options.params||null;if(n.containsDynamicStyles){const s=new Set,o=i||{};n.styles.forEach(a=>{a instanceof Map&&a.forEach(c=>{UW(c).forEach(l=>{o.hasOwnProperty(l)||s.add(l)})})}),s.size&&(Fg(s.values()),t.errors.push(function fCe(r,e){return new ge(3008,!1)}()))}return{type:0,name:e.name,style:n,options:i?{params:i}:null}}visitTransition(e,t){t.queryCount=0,t.depCount=0;const n=ao(this,Tf(e.animation),t);return{type:1,matchers:YCe(e.expr,t.errors),animation:n,queryCount:t.queryCount,depCount:t.depCount,options:A6(e.options)}}visitSequence(e,t){return{type:2,steps:e.steps.map(n=>ao(this,n,t)),options:A6(e.options)}}visitGroup(e,t){const n=t.currentTime;let i=0;const s=e.steps.map(o=>{t.currentTime=n;const a=ao(this,o,t);return i=Math.max(i,t.currentTime),a});return t.currentTime=i,{type:3,steps:s,options:A6(e.options)}}visitAnimate(e,t){const n=function iye(r,e){if(r.hasOwnProperty("duration"))return r;if("number"==typeof r)return IP(Vg(r,e).duration,0,"");const t=r;if(t.split(/\s+/).some(s=>"{"==s.charAt(0)&&"{"==s.charAt(1))){const s=IP(0,0,"");return s.dynamic=!0,s.strValue=t,s}const i=Vg(t,e);return IP(i.duration,i.delay,i.easing)}(e.timings,t.errors);t.currentAnimateTimings=n;let i,s=e.styles?e.styles:IW({});if(5==s.type)i=this.visitKeyframes(s,t);else{let o=e.styles,a=!1;if(!o){a=!0;const l={};n.easing&&(l.easing=n.easing),o=IW(l)}t.currentTime+=n.duration+n.delay;const c=this.visitStyle(o,t);c.isEmptyStep=a,i=c}return t.currentAnimateTimings=null,{type:4,timings:n,style:i,options:null}}visitStyle(e,t){const n=this._makeStyleAst(e,t);return this._validateStyleAst(n,t),n}_makeStyleAst(e,t){const n=[],i=Array.isArray(e.styles)?e.styles:[e.styles];for(let a of i)"string"==typeof a?a===I3?n.push(a):t.errors.push(new ge(3002,!1)):n.push(GW(a));let s=!1,o=null;return n.forEach(a=>{if(a instanceof Map&&(a.has("easing")&&(o=a.get("easing"),a.delete("easing")),!s))for(let c of a.values())if(c.toString().indexOf("{{")>=0){s=!0;break}}),{type:6,styles:n,easing:o,offset:e.offset,containsDynamicStyles:s,options:null}}_validateStyleAst(e,t){const n=t.currentAnimateTimings;let i=t.currentTime,s=t.currentTime;n&&s>0&&(s-=n.duration+n.delay),e.styles.forEach(o=>{"string"!=typeof o&&o.forEach((a,c)=>{const l=t.collectedStyles.get(t.currentQuerySelector),f=l.get(c);let d=!0;f&&(s!=i&&s>=f.startTime&&i<=f.endTime&&(t.errors.push(function hCe(r,e,t,n,i){return new ge(3010,!1)}()),d=!1),s=f.startTime),d&&l.set(c,{startTime:s,endTime:i}),t.options&&function WCe(r,e,t){const n=e.params||{},i=UW(r);i.length&&i.forEach(s=>{n.hasOwnProperty(s)||t.push(function sCe(r){return new ge(3001,!1)}())})}(a,t.options,t.errors)})})}visitKeyframes(e,t){const n={type:5,styles:[],options:null};if(!t.currentAnimateTimings)return t.errors.push(function pCe(){return new ge(3011,!1)}()),n;let s=0;const o=[];let a=!1,c=!1,l=0;const f=e.steps.map($=>{const G=this._makeStyleAst($,t);let de=null!=G.offset?G.offset:function rye(r){if("string"==typeof r)return null;let e=null;if(Array.isArray(r))r.forEach(t=>{if(t instanceof Map&&t.has("offset")){const n=t;e=parseFloat(n.get("offset")),n.delete("offset")}});else if(r instanceof Map&&r.has("offset")){const t=r;e=parseFloat(t.get("offset")),t.delete("offset")}return e}(G.styles),ve=0;return null!=de&&(s++,ve=G.offset=de),c=c||ve<0||ve>1,a=a||ve<l,l=ve,o.push(ve),G});c&&t.errors.push(function gCe(){return new ge(3012,!1)}()),a&&t.errors.push(function mCe(){return new ge(3200,!1)}());const d=e.steps.length;let m=0;s>0&&s<d?t.errors.push(function _Ce(){return new ge(3202,!1)}()):0==s&&(m=1/(d-1));const E=d-1,w=t.currentTime,R=t.currentAnimateTimings,z=R.duration;return f.forEach(($,G)=>{const de=m>0?G==E?1:m*G:o[G],ve=de*z;t.currentTime=w+R.delay+ve,R.duration=ve,this._validateStyleAst($,t),$.offset=de,n.styles.push($)}),n}visitReference(e,t){return{type:8,animation:ao(this,Tf(e.animation),t),options:A6(e.options)}}visitAnimateChild(e,t){return t.depCount++,{type:9,options:A6(e.options)}}visitAnimateRef(e,t){return{type:10,animation:this.visitReference(e.animation,t),options:A6(e.options)}}visitQuery(e,t){const n=t.currentQuerySelector,i=e.options||{};t.queryCount++,t.currentQuery=e;const[s,o]=function eye(r){const e=!!r.split(/\s*,\s*/).find(t=>":self"==t);return e&&(r=r.replace(QCe,"")),r=r.replace(/@\*/g,Hg).replace(/@\w+/g,t=>Hg+"-"+t.slice(1)).replace(/:animating/g,OP),[r,e]}(e.selector);t.currentQuerySelector=n.length?n+" "+s:s,oo(t.collectedStyles,t.currentQuerySelector,new Map);const a=ao(this,Tf(e.animation),t);return t.currentQuery=null,t.currentQuerySelector=n,{type:11,selector:s,limit:i.limit||0,optional:!!i.optional,includeSelf:o,animation:a,originalSelector:e.selector,options:A6(e.options)}}visitStagger(e,t){t.currentQuery||t.errors.push(function vCe(){return new ge(3013,!1)}());const n="full"===e.timings?{duration:0,delay:0,easing:"full"}:Vg(e.timings,t.errors,!0);return{type:12,animation:ao(this,Tf(e.animation),t),timings:n,options:null}}}class nye{constructor(e){this.errors=e,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function A6(r){return r?(r=Pf(r)).params&&(r.params=function tye(r){return r?Pf(r):null}(r.params)):r={},r}function IP(r,e,t){return{duration:r,delay:e,easing:t}}function kP(r,e,t,n,i,s,o=null,a=!1){return{type:1,element:r,keyframes:e,preStyleProps:t,postStyleProps:n,duration:i,delay:s,totalTime:i+s,easing:o,subTimeline:a}}class Ug{constructor(){this._map=new Map}get(e){return this._map.get(e)||[]}append(e,t){let n=this._map.get(e);n||this._map.set(e,n=[]),n.push(...t)}has(e){return this._map.has(e)}clear(){this._map.clear()}}const aye=new RegExp(":enter","g"),lye=new RegExp(":leave","g");function xP(r,e,t,n,i,s=new Map,o=new Map,a,c,l=[]){return(new uye).buildKeyframes(r,e,t,n,i,s,o,a,c,l)}class uye{buildKeyframes(e,t,n,i,s,o,a,c,l,f=[]){l=l||new Ug;const d=new LP(e,t,l,i,s,f,[]);d.options=c;const m=c.delay?k3(c.delay):0;d.currentTimeline.delayNextStep(m),d.currentTimeline.setStyles([o],null,d.errors,c),ao(this,n,d);const E=d.timelines.filter(w=>w.containsAnimation());if(E.length&&a.size){let w;for(let R=E.length-1;R>=0;R--){const z=E[R];if(z.element===t){w=z;break}}w&&!w.allowOnlyTimelineStyles()&&w.setStyles([a],null,d.errors,c)}return E.length?E.map(w=>w.buildKeyframes()):[kP(t,[],[],[],0,m,"",!1)]}visitTrigger(e,t){}visitState(e,t){}visitTransition(e,t){}visitAnimateChild(e,t){const n=t.subInstructions.get(t.element);if(n){const i=t.createSubContext(e.options),s=t.currentTimeline.currentTime,o=this._visitSubInstructions(n,i,i.options);s!=o&&t.transformIntoNewTimeline(o)}t.previousNode=e}visitAnimateRef(e,t){const n=t.createSubContext(e.options);n.transformIntoNewTimeline(),this._applyAnimationRefDelays([e.options,e.animation.options],t,n),this.visitReference(e.animation,n),t.transformIntoNewTimeline(n.currentTimeline.currentTime),t.previousNode=e}_applyAnimationRefDelays(e,t,n){for(const i of e){const s=i?.delay;if(s){const o="number"==typeof s?s:k3(Of(s,i?.params??{},t.errors));n.delayNextStep(o)}}}_visitSubInstructions(e,t,n){let s=t.currentTimeline.currentTime;const o=null!=n.duration?k3(n.duration):null,a=null!=n.delay?k3(n.delay):null;return 0!==o&&e.forEach(c=>{const l=t.appendInstructionToTimeline(c,o,a);s=Math.max(s,l.duration+l.delay)}),s}visitReference(e,t){t.updateOptions(e.options,!0),ao(this,e.animation,t),t.previousNode=e}visitSequence(e,t){const n=t.subContextCount;let i=t;const s=e.options;if(s&&(s.params||s.delay)&&(i=t.createSubContext(s),i.transformIntoNewTimeline(),null!=s.delay)){6==i.previousNode.type&&(i.currentTimeline.snapshotCurrentStyles(),i.previousNode=Wg);const o=k3(s.delay);i.delayNextStep(o)}e.steps.length&&(e.steps.forEach(o=>ao(this,o,i)),i.currentTimeline.applyStylesToKeyframe(),i.subContextCount>n&&i.transformIntoNewTimeline()),t.previousNode=e}visitGroup(e,t){const n=[];let i=t.currentTimeline.currentTime;const s=e.options&&e.options.delay?k3(e.options.delay):0;e.steps.forEach(o=>{const a=t.createSubContext(e.options);s&&a.delayNextStep(s),ao(this,o,a),i=Math.max(i,a.currentTimeline.currentTime),n.push(a.currentTimeline)}),n.forEach(o=>t.currentTimeline.mergeTimelineCollectedStyles(o)),t.transformIntoNewTimeline(i),t.previousNode=e}_visitTiming(e,t){if(e.dynamic){const n=e.strValue;return Vg(t.params?Of(n,t.params,t.errors):n,t.errors)}return{duration:e.duration,delay:e.delay,easing:e.easing}}visitAnimate(e,t){const n=t.currentAnimateTimings=this._visitTiming(e.timings,t),i=t.currentTimeline;n.delay&&(t.incrementTime(n.delay),i.snapshotCurrentStyles());const s=e.style;5==s.type?this.visitKeyframes(s,t):(t.incrementTime(n.duration),this.visitStyle(s,t),i.applyStylesToKeyframe()),t.currentAnimateTimings=null,t.previousNode=e}visitStyle(e,t){const n=t.currentTimeline,i=t.currentAnimateTimings;!i&&n.hasCurrentStyleProperties()&&n.forwardFrame();const s=i&&i.easing||e.easing;e.isEmptyStep?n.applyEmptyStep(s):n.setStyles(e.styles,s,t.errors,t.options),t.previousNode=e}visitKeyframes(e,t){const n=t.currentAnimateTimings,i=t.currentTimeline.duration,s=n.duration,a=t.createSubContext().currentTimeline;a.easing=n.easing,e.styles.forEach(c=>{a.forwardTime((c.offset||0)*s),a.setStyles(c.styles,c.easing,t.errors,t.options),a.applyStylesToKeyframe()}),t.currentTimeline.mergeTimelineCollectedStyles(a),t.transformIntoNewTimeline(i+s),t.previousNode=e}visitQuery(e,t){const n=t.currentTimeline.currentTime,i=e.options||{},s=i.delay?k3(i.delay):0;s&&(6===t.previousNode.type||0==n&&t.currentTimeline.hasCurrentStyleProperties())&&(t.currentTimeline.snapshotCurrentStyles(),t.previousNode=Wg);let o=n;const a=t.invokeQuery(e.selector,e.originalSelector,e.limit,e.includeSelf,!!i.optional,t.errors);t.currentQueryTotal=a.length;let c=null;a.forEach((l,f)=>{t.currentQueryIndex=f;const d=t.createSubContext(e.options,l);s&&d.delayNextStep(s),l===t.element&&(c=d.currentTimeline),ao(this,e.animation,d),d.currentTimeline.applyStylesToKeyframe(),o=Math.max(o,d.currentTimeline.currentTime)}),t.currentQueryIndex=0,t.currentQueryTotal=0,t.transformIntoNewTimeline(o),c&&(t.currentTimeline.mergeTimelineCollectedStyles(c),t.currentTimeline.snapshotCurrentStyles()),t.previousNode=e}visitStagger(e,t){const n=t.parentContext,i=t.currentTimeline,s=e.timings,o=Math.abs(s.duration),a=o*(t.currentQueryTotal-1);let c=o*t.currentQueryIndex;switch(s.duration<0?"reverse":s.easing){case"reverse":c=a-c;break;case"full":c=n.currentStaggerTime}const f=t.currentTimeline;c&&f.delayNextStep(c);const d=f.currentTime;ao(this,e.animation,t),t.previousNode=e,n.currentStaggerTime=i.currentTime-d+(i.startTime-n.currentTimeline.startTime)}}const Wg={};class LP{constructor(e,t,n,i,s,o,a,c){this._driver=e,this.element=t,this.subInstructions=n,this._enterClassName=i,this._leaveClassName=s,this.errors=o,this.timelines=a,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=Wg,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=c||new qg(this._driver,t,0),a.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(e,t){if(!e)return;const n=e;let i=this.options;null!=n.duration&&(i.duration=k3(n.duration)),null!=n.delay&&(i.delay=k3(n.delay));const s=n.params;if(s){let o=i.params;o||(o=this.options.params={}),Object.keys(s).forEach(a=>{(!t||!o.hasOwnProperty(a))&&(o[a]=Of(s[a],o,this.errors))})}}_copyOptions(){const e={};if(this.options){const t=this.options.params;if(t){const n=e.params={};Object.keys(t).forEach(i=>{n[i]=t[i]})}}return e}createSubContext(e=null,t,n){const i=t||this.element,s=new LP(this._driver,i,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(i,n||0));return s.previousNode=this.previousNode,s.currentAnimateTimings=this.currentAnimateTimings,s.options=this._copyOptions(),s.updateOptions(e),s.currentQueryIndex=this.currentQueryIndex,s.currentQueryTotal=this.currentQueryTotal,s.parentContext=this,this.subContextCount++,s}transformIntoNewTimeline(e){return this.previousNode=Wg,this.currentTimeline=this.currentTimeline.fork(this.element,e),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(e,t,n){const i={duration:t??e.duration,delay:this.currentTimeline.currentTime+(n??0)+e.delay,easing:""},s=new fye(this._driver,e.element,e.keyframes,e.preStyleProps,e.postStyleProps,i,e.stretchStartingKeyframe);return this.timelines.push(s),i}incrementTime(e){this.currentTimeline.forwardTime(this.currentTimeline.duration+e)}delayNextStep(e){e>0&&this.currentTimeline.delayNextStep(e)}invokeQuery(e,t,n,i,s,o){let a=[];if(i&&a.push(this.element),e.length>0){e=(e=e.replace(aye,"."+this._enterClassName)).replace(lye,"."+this._leaveClassName);let l=this._driver.query(this.element,e,1!=n);0!==n&&(l=n<0?l.slice(l.length+n,l.length):l.slice(0,n)),a.push(...l)}return!s&&0==a.length&&o.push(function CCe(r){return new ge(3014,!1)}()),a}}class qg{constructor(e,t,n,i){this._driver=e,this.element=t,this.startTime=n,this._elementTimelineStylesLookup=i,this.duration=0,this.easing=null,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(t),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(t,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(e){const t=1===this._keyframes.size&&this._pendingStyles.size;this.duration||t?(this.forwardTime(this.currentTime+e),t&&this.snapshotCurrentStyles()):this.startTime+=e}fork(e,t){return this.applyStylesToKeyframe(),new qg(this._driver,e,t||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(e){this.applyStylesToKeyframe(),this.duration=e,this._loadKeyframe()}_updateStyle(e,t){this._localTimelineStyles.set(e,t),this._globalTimelineStyles.set(e,t),this._styleSummary.set(e,{time:this.currentTime,value:t})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(e){e&&this._previousKeyframe.set("easing",e);for(let[t,n]of this._globalTimelineStyles)this._backFill.set(t,n||I3),this._currentKeyframe.set(t,I3);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(e,t,n,i){t&&this._previousKeyframe.set("easing",t);const s=i&&i.params||{},o=function dye(r,e){const t=new Map;let n;return r.forEach(i=>{if("*"===i){n=n||e.keys();for(let s of n)t.set(s,I3)}else W4(i,t)}),t}(e,this._globalTimelineStyles);for(let[a,c]of o){const l=Of(c,s,n);this._pendingStyles.set(a,l),this._localTimelineStyles.has(a)||this._backFill.set(a,this._globalTimelineStyles.get(a)??I3),this._updateStyle(a,l)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((e,t)=>{this._currentKeyframe.set(t,e)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((e,t)=>{this._currentKeyframe.has(t)||this._currentKeyframe.set(t,e)}))}snapshotCurrentStyles(){for(let[e,t]of this._localTimelineStyles)this._pendingStyles.set(e,t),this._updateStyle(e,t)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const e=[];for(let t in this._currentKeyframe)e.push(t);return e}mergeTimelineCollectedStyles(e){e._styleSummary.forEach((t,n)=>{const i=this._styleSummary.get(n);(!i||t.time>i.time)&&this._updateStyle(n,t.value)})}buildKeyframes(){this.applyStylesToKeyframe();const e=new Set,t=new Set,n=1===this._keyframes.size&&0===this.duration;let i=[];this._keyframes.forEach((a,c)=>{const l=W4(a,new Map,this._backFill);l.forEach((f,d)=>{"!"===f?e.add(d):f===I3&&t.add(d)}),n||l.set("offset",c/this.duration),i.push(l)});const s=e.size?Fg(e.values()):[],o=t.size?Fg(t.values()):[];if(n){const a=i[0],c=new Map(a);a.set("offset",0),c.set("offset",1),i=[a,c]}return kP(this.element,i,s,o,this.duration,this.startTime,this.easing,!1)}}class fye extends qg{constructor(e,t,n,i,s,o,a=!1){super(e,t,o.delay),this.keyframes=n,this.preStyleProps=i,this.postStyleProps=s,this._stretchStartingKeyframe=a,this.timings={duration:o.duration,delay:o.delay,easing:o.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let e=this.keyframes,{delay:t,duration:n,easing:i}=this.timings;if(this._stretchStartingKeyframe&&t){const s=[],o=n+t,a=t/o,c=W4(e[0]);c.set("offset",0),s.push(c);const l=W4(e[0]);l.set("offset",YW(a)),s.push(l);const f=e.length-1;for(let d=1;d<=f;d++){let m=W4(e[d]);const E=m.get("offset");m.set("offset",YW((t+E*n)/o)),s.push(m)}n=o,t=0,i="",e=s}return kP(this.element,e,this.preStyleProps,this.postStyleProps,n,t,i,!0)}}function YW(r,e=3){const t=Math.pow(10,e-1);return Math.round(r*t)/t}class RP{}const hye=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class pye extends RP{normalizePropertyName(e,t){return AP(e)}normalizeStyleValue(e,t,n,i){let s="";const o=n.toString().trim();if(hye.has(t)&&0!==n&&"0"!==n)if("number"==typeof n)s="px";else{const a=n.match(/^[+-]?[\d\.]+([a-z]*)$/);a&&0==a[1].length&&i.push(function cCe(r,e){return new ge(3005,!1)}())}return o+s}}function KW(r,e,t,n,i,s,o,a,c,l,f,d,m){return{type:0,element:r,triggerName:e,isRemovalTransition:i,fromState:t,fromStyles:s,toState:n,toStyles:o,timelines:a,queriedElements:c,preStyleProps:l,postStyleProps:f,totalTime:d,errors:m}}const zP={};class XW{constructor(e,t,n){this._triggerName=e,this.ast=t,this._stateStyles=n}match(e,t,n,i){return function gye(r,e,t,n,i){return r.some(s=>s(e,t,n,i))}(this.ast.matchers,e,t,n,i)}buildStyles(e,t,n){let i=this._stateStyles.get("*");return void 0!==e&&(i=this._stateStyles.get(e?.toString())||i),i?i.buildStyles(t,n):new Map}build(e,t,n,i,s,o,a,c,l,f){const d=[],m=this.ast.options&&this.ast.options.params||zP,w=this.buildStyles(n,a&&a.params||zP,d),R=c&&c.params||zP,z=this.buildStyles(i,R,d),$=new Set,G=new Map,de=new Map,ve="void"===i,Le={params:mye(R,m),delay:this.ast.options?.delay},nt=f?[]:xP(e,t,this.ast.animation,s,o,w,z,Le,l,d);let gt=0;if(nt.forEach(Et=>{gt=Math.max(Et.duration+Et.delay,gt)}),d.length)return KW(t,this._triggerName,n,i,ve,w,z,[],[],G,de,gt,d);nt.forEach(Et=>{const Z2=Et.element,F0=oo(G,Z2,new Set);Et.preStyleProps.forEach(r3=>F0.add(r3));const Bl=oo(de,Z2,new Set);Et.postStyleProps.forEach(r3=>Bl.add(r3)),Z2!==t&&$.add(Z2)});const vn=Fg($.values());return KW(t,this._triggerName,n,i,ve,w,z,nt,vn,G,de,gt)}}function mye(r,e){const t=Pf(e);for(const n in r)r.hasOwnProperty(n)&&null!=r[n]&&(t[n]=r[n]);return t}class _ye{constructor(e,t,n){this.styles=e,this.defaultParams=t,this.normalizer=n}buildStyles(e,t){const n=new Map,i=Pf(this.defaultParams);return Object.keys(e).forEach(s=>{const o=e[s];null!==o&&(i[s]=o)}),this.styles.styles.forEach(s=>{"string"!=typeof s&&s.forEach((o,a)=>{o&&(o=Of(o,i,t));const c=this.normalizer.normalizePropertyName(a,t);o=this.normalizer.normalizeStyleValue(a,c,o,t),n.set(a,o)})}),n}}class Cye{constructor(e,t,n){this.name=e,this.ast=t,this._normalizer=n,this.transitionFactories=[],this.states=new Map,t.states.forEach(i=>{this.states.set(i.name,new _ye(i.style,i.options&&i.options.params||{},n))}),QW(this.states,"true","1"),QW(this.states,"false","0"),t.transitions.forEach(i=>{this.transitionFactories.push(new XW(e,i,this.states))}),this.fallbackTransition=function yye(r,e,t){return new XW(r,{type:1,animation:{type:2,steps:[],options:null},matchers:[(o,a)=>!0],options:null,queryCount:0,depCount:0},e)}(e,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(e,t,n,i){return this.transitionFactories.find(o=>o.match(e,t,n,i))||null}matchStyles(e,t,n){return this.fallbackTransition.buildStyles(e,t,n)}}function QW(r,e,t){r.has(e)?r.has(t)||r.set(t,r.get(e)):r.has(t)&&r.set(e,r.get(t))}const Mye=new Ug;class Eye{constructor(e,t,n){this.bodyNode=e,this._driver=t,this._normalizer=n,this._animations=new Map,this._playersById=new Map,this.players=[]}register(e,t){const n=[],s=NP(this._driver,t,n,[]);if(n.length)throw function OCe(r){return new ge(3503,!1)}();this._animations.set(e,s)}_buildPlayer(e,t,n){const i=e.element,s=LW(this._normalizer,e.keyframes,t,n);return this._driver.animate(i,s,e.duration,e.delay,e.easing,[],!0)}create(e,t,n={}){const i=[],s=this._animations.get(e);let o;const a=new Map;if(s?(o=xP(this._driver,t,s,TP,zg,new Map,new Map,n,Mye,i),o.forEach(f=>{const d=oo(a,f.element,new Map);f.postStyleProps.forEach(m=>d.set(m,null))})):(i.push(function bCe(){return new ge(3300,!1)}()),o=[]),i.length)throw function wCe(r){return new ge(3504,!1)}();a.forEach((f,d)=>{f.forEach((m,E)=>{f.set(E,this._driver.computeStyle(d,E,I3))})});const l=U4(o.map(f=>{const d=a.get(f.element);return this._buildPlayer(f,new Map,d)}));return this._playersById.set(e,l),l.onDestroy(()=>this.destroy(e)),this.players.push(l),l}destroy(e){const t=this._getPlayer(e);t.destroy(),this._playersById.delete(e);const n=this.players.indexOf(t);n>=0&&this.players.splice(n,1)}_getPlayer(e){const t=this._playersById.get(e);if(!t)throw function ACe(r){return new ge(3301,!1)}();return t}listen(e,t,n,i){const s=EP(t,"","","");return yP(this._getPlayer(e),n,s,i),()=>{}}command(e,t,n,i){if("register"==n)return void this.register(e,i[0]);if("create"==n)return void this.create(e,t,i[0]||{});const s=this._getPlayer(e);switch(n){case"play":s.play();break;case"pause":s.pause();break;case"reset":s.reset();break;case"restart":s.restart();break;case"finish":s.finish();break;case"init":s.init();break;case"setPosition":s.setPosition(parseFloat(i[0]));break;case"destroy":this.destroy(e)}}}const JW="ng-animate-queued",DP="ng-animate-disabled",bye=[],eq={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},wye={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},Ea="__ng_removed";class HP{get params(){return this.options.params}constructor(e,t=""){this.namespaceId=t;const n=e&&e.hasOwnProperty("value");if(this.value=function kye(r){return r??null}(n?e.value:e),n){const s=Pf(e);delete s.value,this.options=s}else this.options={};this.options.params||(this.options.params={})}absorbOptions(e){const t=e.params;if(t){const n=this.options.params;Object.keys(t).forEach(i=>{null==n[i]&&(n[i]=t[i])})}}}const bf="void",VP=new HP(bf);class Aye{constructor(e,t,n){this.id=e,this.hostElement=t,this._engine=n,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+e,xo(t,this._hostClassName)}listen(e,t,n,i){if(!this._triggers.has(t))throw function NCe(r,e){return new ge(3302,!1)}();if(null==n||0==n.length)throw function ICe(r){return new ge(3303,!1)}();if(!function xye(r){return"start"==r||"done"==r}(n))throw function kCe(r,e){return new ge(3400,!1)}();const s=oo(this._elementListeners,e,[]),o={name:t,phase:n,callback:i};s.push(o);const a=oo(this._engine.statesByElement,e,new Map);return a.has(t)||(xo(e,Dg),xo(e,Dg+"-"+t),a.set(t,VP)),()=>{this._engine.afterFlush(()=>{const c=s.indexOf(o);c>=0&&s.splice(c,1),this._triggers.has(t)||a.delete(t)})}}register(e,t){return!this._triggers.has(e)&&(this._triggers.set(e,t),!0)}_getTrigger(e){const t=this._triggers.get(e);if(!t)throw function xCe(r){return new ge(3401,!1)}();return t}trigger(e,t,n,i=!0){const s=this._getTrigger(t),o=new FP(this.id,t,e);let a=this._engine.statesByElement.get(e);a||(xo(e,Dg),xo(e,Dg+"-"+t),this._engine.statesByElement.set(e,a=new Map));let c=a.get(t);const l=new HP(n,this.id);if(!(n&&n.hasOwnProperty("value"))&&c&&l.absorbOptions(c.options),a.set(t,l),c||(c=VP),l.value!==bf&&c.value===l.value){if(!function zye(r,e){const t=Object.keys(r),n=Object.keys(e);if(t.length!=n.length)return!1;for(let i=0;i<t.length;i++){const s=t[i];if(!e.hasOwnProperty(s)||r[s]!==e[s])return!1}return!0}(c.params,l.params)){const R=[],z=s.matchStyles(c.value,c.params,R),$=s.matchStyles(l.value,l.params,R);R.length?this._engine.reportError(R):this._engine.afterFlush(()=>{w6(e,z),Ec(e,$)})}return}const m=oo(this._engine.playersByElement,e,[]);m.forEach(R=>{R.namespaceId==this.id&&R.triggerName==t&&R.queued&&R.destroy()});let E=s.matchTransition(c.value,l.value,e,l.params),w=!1;if(!E){if(!i)return;E=s.fallbackTransition,w=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:t,transition:E,fromState:c,toState:l,player:o,isFallbackTransition:w}),w||(xo(e,JW),o.onStart(()=>{Q8(e,JW)})),o.onDone(()=>{let R=this.players.indexOf(o);R>=0&&this.players.splice(R,1);const z=this._engine.playersByElement.get(e);if(z){let $=z.indexOf(o);$>=0&&z.splice($,1)}}),this.players.push(o),m.push(o),o}deregister(e){this._triggers.delete(e),this._engine.statesByElement.forEach(t=>t.delete(e)),this._elementListeners.forEach((t,n)=>{this._elementListeners.set(n,t.filter(i=>i.name!=e))})}clearElementCache(e){this._engine.statesByElement.delete(e),this._elementListeners.delete(e);const t=this._engine.playersByElement.get(e);t&&(t.forEach(n=>n.destroy()),this._engine.playersByElement.delete(e))}_signalRemovalForInnerTriggers(e,t){const n=this._engine.driver.query(e,Hg,!0);n.forEach(i=>{if(i[Ea])return;const s=this._engine.fetchNamespacesByElement(i);s.size?s.forEach(o=>o.triggerLeaveAnimation(i,t,!1,!0)):this.clearElementCache(i)}),this._engine.afterFlushAnimationsDone(()=>n.forEach(i=>this.clearElementCache(i)))}triggerLeaveAnimation(e,t,n,i){const s=this._engine.statesByElement.get(e),o=new Map;if(s){const a=[];if(s.forEach((c,l)=>{if(o.set(l,c.value),this._triggers.has(l)){const f=this.trigger(e,l,bf,i);f&&a.push(f)}}),a.length)return this._engine.markElementAsRemoved(this.id,e,!0,t,o),n&&U4(a).onDone(()=>this._engine.processLeaveNode(e)),!0}return!1}prepareLeaveAnimationListeners(e){const t=this._elementListeners.get(e),n=this._engine.statesByElement.get(e);if(t&&n){const i=new Set;t.forEach(s=>{const o=s.name;if(i.has(o))return;i.add(o);const c=this._triggers.get(o).fallbackTransition,l=n.get(o)||VP,f=new HP(bf),d=new FP(this.id,o,e);this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:o,transition:c,fromState:l,toState:f,player:d,isFallbackTransition:!0})})}}removeNode(e,t){const n=this._engine;if(e.childElementCount&&this._signalRemovalForInnerTriggers(e,t),this.triggerLeaveAnimation(e,t,!0))return;let i=!1;if(n.totalAnimations){const s=n.players.length?n.playersByQueriedElement.get(e):[];if(s&&s.length)i=!0;else{let o=e;for(;o=o.parentNode;)if(n.statesByElement.get(o)){i=!0;break}}}if(this.prepareLeaveAnimationListeners(e),i)n.markElementAsRemoved(this.id,e,!1,t);else{const s=e[Ea];(!s||s===eq)&&(n.afterFlush(()=>this.clearElementCache(e)),n.destroyInnerAnimations(e),n._onRemovalComplete(e,t))}}insertNode(e,t){xo(e,this._hostClassName)}drainQueuedTransitions(e){const t=[];return this._queue.forEach(n=>{const i=n.player;if(i.destroyed)return;const s=n.element,o=this._elementListeners.get(s);o&&o.forEach(a=>{if(a.name==n.triggerName){const c=EP(s,n.triggerName,n.fromState.value,n.toState.value);c._data=e,yP(n.player,a.phase,c,a.callback)}}),i.markedForDestroy?this._engine.afterFlush(()=>{i.destroy()}):t.push(n)}),this._queue=[],t.sort((n,i)=>{const s=n.transition.ast.depCount,o=i.transition.ast.depCount;return 0==s||0==o?s-o:this._engine.driver.containsElement(n.element,i.element)?1:-1})}destroy(e){this.players.forEach(t=>t.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,e)}}class Nye{_onRemovalComplete(e,t){this.onRemovalComplete(e,t)}constructor(e,t,n){this.bodyNode=e,this.driver=t,this._normalizer=n,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(i,s)=>{}}get queuedPlayers(){const e=[];return this._namespaceList.forEach(t=>{t.players.forEach(n=>{n.queued&&e.push(n)})}),e}createNamespace(e,t){const n=new Aye(e,t,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,t)?this._balanceNamespaceList(n,t):(this.newHostElements.set(t,n),this.collectEnterElement(t)),this._namespaceLookup[e]=n}_balanceNamespaceList(e,t){const n=this._namespaceList,i=this.namespacesByHostElement;if(n.length-1>=0){let o=!1,a=this.driver.getParentElement(t);for(;a;){const c=i.get(a);if(c){const l=n.indexOf(c);n.splice(l+1,0,e),o=!0;break}a=this.driver.getParentElement(a)}o||n.unshift(e)}else n.push(e);return i.set(t,e),e}register(e,t){let n=this._namespaceLookup[e];return n||(n=this.createNamespace(e,t)),n}registerTrigger(e,t,n){let i=this._namespaceLookup[e];i&&i.register(t,n)&&this.totalAnimations++}destroy(e,t){e&&(this.afterFlush(()=>{}),this.afterFlushAnimationsDone(()=>{const n=this._fetchNamespace(e);this.namespacesByHostElement.delete(n.hostElement);const i=this._namespaceList.indexOf(n);i>=0&&this._namespaceList.splice(i,1),n.destroy(t),delete this._namespaceLookup[e]}))}_fetchNamespace(e){return this._namespaceLookup[e]}fetchNamespacesByElement(e){const t=new Set,n=this.statesByElement.get(e);if(n)for(let i of n.values())if(i.namespaceId){const s=this._fetchNamespace(i.namespaceId);s&&t.add(s)}return t}trigger(e,t,n,i){if(jg(t)){const s=this._fetchNamespace(e);if(s)return s.trigger(t,n,i),!0}return!1}insertNode(e,t,n,i){if(!jg(t))return;const s=t[Ea];if(s&&s.setForRemoval){s.setForRemoval=!1,s.setForMove=!0;const o=this.collectedLeaveElements.indexOf(t);o>=0&&this.collectedLeaveElements.splice(o,1)}if(e){const o=this._fetchNamespace(e);o&&o.insertNode(t,n)}i&&this.collectEnterElement(t)}collectEnterElement(e){this.collectedEnterElements.push(e)}markElementAsDisabled(e,t){t?this.disabledNodes.has(e)||(this.disabledNodes.add(e),xo(e,DP)):this.disabledNodes.has(e)&&(this.disabledNodes.delete(e),Q8(e,DP))}removeNode(e,t,n){if(jg(t)){const i=e?this._fetchNamespace(e):null;i?i.removeNode(t,n):this.markElementAsRemoved(e,t,!1,n);const s=this.namespacesByHostElement.get(t);s&&s.id!==e&&s.removeNode(t,n)}else this._onRemovalComplete(t,n)}markElementAsRemoved(e,t,n,i,s){this.collectedLeaveElements.push(t),t[Ea]={namespaceId:e,setForRemoval:i,hasAnimation:n,removedBeforeQueried:!1,previousTriggersValues:s}}listen(e,t,n,i,s){return jg(t)?this._fetchNamespace(e).listen(t,n,i,s):()=>{}}_buildInstruction(e,t,n,i,s){return e.transition.build(this.driver,e.element,e.fromState.value,e.toState.value,n,i,e.fromState.options,e.toState.options,t,s)}destroyInnerAnimations(e){let t=this.driver.query(e,Hg,!0);t.forEach(n=>this.destroyActiveAnimationsForElement(n)),0!=this.playersByQueriedElement.size&&(t=this.driver.query(e,OP,!0),t.forEach(n=>this.finishActiveQueriedAnimationOnElement(n)))}destroyActiveAnimationsForElement(e){const t=this.playersByElement.get(e);t&&t.forEach(n=>{n.queued?n.markedForDestroy=!0:n.destroy()})}finishActiveQueriedAnimationOnElement(e){const t=this.playersByQueriedElement.get(e);t&&t.forEach(n=>n.finish())}whenRenderingDone(){return new Promise(e=>{if(this.players.length)return U4(this.players).onDone(()=>e());e()})}processLeaveNode(e){const t=e[Ea];if(t&&t.setForRemoval){if(e[Ea]=eq,t.namespaceId){this.destroyInnerAnimations(e);const n=this._fetchNamespace(t.namespaceId);n&&n.clearElementCache(e)}this._onRemovalComplete(e,t.setForRemoval)}e.classList?.contains(DP)&&this.markElementAsDisabled(e,!1),this.driver.query(e,".ng-animate-disabled",!0).forEach(n=>{this.markElementAsDisabled(n,!1)})}flush(e=-1){let t=[];if(this.newHostElements.size&&(this.newHostElements.forEach((n,i)=>this._balanceNamespaceList(n,i)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let n=0;n<this.collectedEnterElements.length;n++)xo(this.collectedEnterElements[n],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const n=[];try{t=this._flushAnimations(n,e)}finally{for(let i=0;i<n.length;i++)n[i]()}}else for(let n=0;n<this.collectedLeaveElements.length;n++)this.processLeaveNode(this.collectedLeaveElements[n]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(n=>n()),this._flushFns=[],this._whenQuietFns.length){const n=this._whenQuietFns;this._whenQuietFns=[],t.length?U4(t).onDone(()=>{n.forEach(i=>i())}):n.forEach(i=>i())}}reportError(e){throw function LCe(r){return new ge(3402,!1)}()}_flushAnimations(e,t){const n=new Ug,i=[],s=new Map,o=[],a=new Map,c=new Map,l=new Map,f=new Set;this.disabledNodes.forEach(ft=>{f.add(ft);const Ot=this.driver.query(ft,".ng-animate-queued",!0);for(let xt=0;xt<Ot.length;xt++)f.add(Ot[xt])});const d=this.bodyNode,m=Array.from(this.statesByElement.keys()),E=rq(m,this.collectedEnterElements),w=new Map;let R=0;E.forEach((ft,Ot)=>{const xt=TP+R++;w.set(Ot,xt),ft.forEach(wn=>xo(wn,xt))});const z=[],$=new Set,G=new Set;for(let ft=0;ft<this.collectedLeaveElements.length;ft++){const Ot=this.collectedLeaveElements[ft],xt=Ot[Ea];xt&&xt.setForRemoval&&(z.push(Ot),$.add(Ot),xt.hasAnimation?this.driver.query(Ot,".ng-star-inserted",!0).forEach(wn=>$.add(wn)):G.add(Ot))}const de=new Map,ve=rq(m,Array.from($));ve.forEach((ft,Ot)=>{const xt=zg+R++;de.set(Ot,xt),ft.forEach(wn=>xo(wn,xt))}),e.push(()=>{E.forEach((ft,Ot)=>{const xt=w.get(Ot);ft.forEach(wn=>Q8(wn,xt))}),ve.forEach((ft,Ot)=>{const xt=de.get(Ot);ft.forEach(wn=>Q8(wn,xt))}),z.forEach(ft=>{this.processLeaveNode(ft)})});const Le=[],nt=[];for(let ft=this._namespaceList.length-1;ft>=0;ft--)this._namespaceList[ft].drainQueuedTransitions(t).forEach(xt=>{const wn=xt.player,wt=xt.element;if(Le.push(wn),this.collectedEnterElements.length){const Ki=wt[Ea];if(Ki&&Ki.setForMove){if(Ki.previousTriggersValues&&Ki.previousTriggersValues.has(xt.triggerName)){const $0=Ki.previousTriggersValues.get(xt.triggerName),la=this.statesByElement.get(xt.element);if(la&&la.has(xt.triggerName)){const QC=la.get(xt.triggerName);QC.value=$0,la.set(xt.triggerName,QC)}}return void wn.destroy()}}const i3=!d||!this.driver.containsElement(d,wt),Eo=de.get(wt),Ul=w.get(wt),_r=this._buildInstruction(xt,n,Ul,Eo,i3);if(_r.errors&&_r.errors.length)return void nt.push(_r);if(i3)return wn.onStart(()=>w6(wt,_r.fromStyles)),wn.onDestroy(()=>Ec(wt,_r.toStyles)),void i.push(wn);if(xt.isFallbackTransition)return wn.onStart(()=>w6(wt,_r.fromStyles)),wn.onDestroy(()=>Ec(wt,_r.toStyles)),void i.push(wn);const y4e=[];_r.timelines.forEach(Ki=>{Ki.stretchStartingKeyframe=!0,this.disabledNodes.has(Ki.element)||y4e.push(Ki)}),_r.timelines=y4e,n.append(wt,_r.timelines),o.push({instruction:_r,player:wn,element:wt}),_r.queriedElements.forEach(Ki=>oo(a,Ki,[]).push(wn)),_r.preStyleProps.forEach((Ki,$0)=>{if(Ki.size){let la=c.get($0);la||c.set($0,la=new Set),Ki.forEach((QC,PR)=>la.add(PR))}}),_r.postStyleProps.forEach((Ki,$0)=>{let la=l.get($0);la||l.set($0,la=new Set),Ki.forEach((QC,PR)=>la.add(PR))})});if(nt.length){const ft=[];nt.forEach(Ot=>{ft.push(function RCe(r,e){return new ge(3505,!1)}())}),Le.forEach(Ot=>Ot.destroy()),this.reportError(ft)}const gt=new Map,vn=new Map;o.forEach(ft=>{const Ot=ft.element;n.has(Ot)&&(vn.set(Ot,Ot),this._beforeAnimationBuild(ft.player.namespaceId,ft.instruction,gt))}),i.forEach(ft=>{const Ot=ft.element;this._getPreviousPlayers(Ot,!1,ft.namespaceId,ft.triggerName,null).forEach(wn=>{oo(gt,Ot,[]).push(wn),wn.destroy()})});const Et=z.filter(ft=>sq(ft,c,l)),Z2=new Map;nq(Z2,this.driver,G,l,I3).forEach(ft=>{sq(ft,c,l)&&Et.push(ft)});const Bl=new Map;E.forEach((ft,Ot)=>{nq(Bl,this.driver,new Set(ft),c,"!")}),Et.forEach(ft=>{const Ot=Z2.get(ft),xt=Bl.get(ft);Z2.set(ft,new Map([...Ot?.entries()??[],...xt?.entries()??[]]))});const r3=[],eh=[],th={};o.forEach(ft=>{const{element:Ot,player:xt,instruction:wn}=ft;if(n.has(Ot)){if(f.has(Ot))return xt.onDestroy(()=>Ec(Ot,wn.toStyles)),xt.disabled=!0,xt.overrideTotalTime(wn.totalTime),void i.push(xt);let wt=th;if(vn.size>1){let Eo=Ot;const Ul=[];for(;Eo=Eo.parentNode;){const _r=vn.get(Eo);if(_r){wt=_r;break}Ul.push(Eo)}Ul.forEach(_r=>vn.set(_r,wt))}const i3=this._buildAnimation(xt.namespaceId,wn,gt,s,Bl,Z2);if(xt.setRealPlayer(i3),wt===th)r3.push(xt);else{const Eo=this.playersByElement.get(wt);Eo&&Eo.length&&(xt.parentPlayer=U4(Eo)),i.push(xt)}}else w6(Ot,wn.fromStyles),xt.onDestroy(()=>Ec(Ot,wn.toStyles)),eh.push(xt),f.has(Ot)&&i.push(xt)}),eh.forEach(ft=>{const Ot=s.get(ft.element);if(Ot&&Ot.length){const xt=U4(Ot);ft.setRealPlayer(xt)}}),i.forEach(ft=>{ft.parentPlayer?ft.syncPlayerEvents(ft.parentPlayer):ft.destroy()});for(let ft=0;ft<z.length;ft++){const Ot=z[ft],xt=Ot[Ea];if(Q8(Ot,zg),xt&&xt.hasAnimation)continue;let wn=[];if(a.size){let i3=a.get(Ot);i3&&i3.length&&wn.push(...i3);let Eo=this.driver.query(Ot,OP,!0);for(let Ul=0;Ul<Eo.length;Ul++){let _r=a.get(Eo[Ul]);_r&&_r.length&&wn.push(..._r)}}const wt=wn.filter(i3=>!i3.destroyed);wt.length?Lye(this,Ot,wt):this.processLeaveNode(Ot)}return z.length=0,r3.forEach(ft=>{this.players.push(ft),ft.onDone(()=>{ft.destroy();const Ot=this.players.indexOf(ft);this.players.splice(Ot,1)}),ft.play()}),r3}afterFlush(e){this._flushFns.push(e)}afterFlushAnimationsDone(e){this._whenQuietFns.push(e)}_getPreviousPlayers(e,t,n,i,s){let o=[];if(t){const a=this.playersByQueriedElement.get(e);a&&(o=a)}else{const a=this.playersByElement.get(e);if(a){const c=!s||s==bf;a.forEach(l=>{l.queued||!c&&l.triggerName!=i||o.push(l)})}}return(n||i)&&(o=o.filter(a=>!(n&&n!=a.namespaceId||i&&i!=a.triggerName))),o}_beforeAnimationBuild(e,t,n){const s=t.element,o=t.isRemovalTransition?void 0:e,a=t.isRemovalTransition?void 0:t.triggerName;for(const c of t.timelines){const l=c.element,f=l!==s,d=oo(n,l,[]);this._getPreviousPlayers(l,f,o,a,t.toState).forEach(E=>{const w=E.getRealPlayer();w.beforeDestroy&&w.beforeDestroy(),E.destroy(),d.push(E)})}w6(s,t.fromStyles)}_buildAnimation(e,t,n,i,s,o){const a=t.triggerName,c=t.element,l=[],f=new Set,d=new Set,m=t.timelines.map(w=>{const R=w.element;f.add(R);const z=R[Ea];if(z&&z.removedBeforeQueried)return new Sf(w.duration,w.delay);const $=R!==c,G=function Rye(r){const e=[];return iq(r,e),e}((n.get(R)||bye).map(gt=>gt.getRealPlayer())).filter(gt=>!!gt.element&&gt.element===R),de=s.get(R),ve=o.get(R),Le=LW(this._normalizer,w.keyframes,de,ve),nt=this._buildPlayer(w,Le,G);if(w.subTimeline&&i&&d.add(R),$){const gt=new FP(e,a,R);gt.setRealPlayer(nt),l.push(gt)}return nt});l.forEach(w=>{oo(this.playersByQueriedElement,w.element,[]).push(w),w.onDone(()=>function Iye(r,e,t){let n=r.get(e);if(n){if(n.length){const i=n.indexOf(t);n.splice(i,1)}0==n.length&&r.delete(e)}return n}(this.playersByQueriedElement,w.element,w))}),f.forEach(w=>xo(w,$W));const E=U4(m);return E.onDestroy(()=>{f.forEach(w=>Q8(w,$W)),Ec(c,t.toStyles)}),d.forEach(w=>{oo(i,w,[]).push(E)}),E}_buildPlayer(e,t,n){return t.length>0?this.driver.animate(e.element,t,e.duration,e.delay,e.easing,n):new Sf(e.duration,e.delay)}}class FP{constructor(e,t,n){this.namespaceId=e,this.triggerName=t,this.element=n,this._player=new Sf,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.parentPlayer=null,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(e){this._containsRealPlayer||(this._player=e,this._queuedCallbacks.forEach((t,n)=>{t.forEach(i=>yP(e,n,void 0,i))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(e.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(e){this.totalTime=e}syncPlayerEvents(e){const t=this._player;t.triggerCallback&&e.onStart(()=>t.triggerCallback("start")),e.onDone(()=>this.finish()),e.onDestroy(()=>this.destroy())}_queueEvent(e,t){oo(this._queuedCallbacks,e,[]).push(t)}onDone(e){this.queued&&this._queueEvent("done",e),this._player.onDone(e)}onStart(e){this.queued&&this._queueEvent("start",e),this._player.onStart(e)}onDestroy(e){this.queued&&this._queueEvent("destroy",e),this._player.onDestroy(e)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(e){this.queued||this._player.setPosition(e)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(e){const t=this._player;t.triggerCallback&&t.triggerCallback(e)}}function jg(r){return r&&1===r.nodeType}function tq(r,e){const t=r.style.display;return r.style.display=e??"none",t}function nq(r,e,t,n,i){const s=[];t.forEach(c=>s.push(tq(c)));const o=[];n.forEach((c,l)=>{const f=new Map;c.forEach(d=>{const m=e.computeStyle(l,d,i);f.set(d,m),(!m||0==m.length)&&(l[Ea]=wye,o.push(l))}),r.set(l,f)});let a=0;return t.forEach(c=>tq(c,s[a++])),o}function rq(r,e){const t=new Map;if(r.forEach(a=>t.set(a,[])),0==e.length)return t;const i=new Set(e),s=new Map;function o(a){if(!a)return 1;let c=s.get(a);if(c)return c;const l=a.parentNode;return c=t.has(l)?l:i.has(l)?1:o(l),s.set(a,c),c}return e.forEach(a=>{const c=o(a);1!==c&&t.get(c).push(a)}),t}function xo(r,e){r.classList?.add(e)}function Q8(r,e){r.classList?.remove(e)}function Lye(r,e,t){U4(t).onDone(()=>r.processLeaveNode(e))}function iq(r,e){for(let t=0;t<r.length;t++){const n=r[t];n instanceof kW?iq(n.players,e):e.push(n)}}function sq(r,e,t){const n=t.get(r);if(!n)return!1;let i=e.get(r);return i?n.forEach(s=>i.add(s)):e.set(r,n),t.delete(r),!0}class Zg{constructor(e,t,n){this.bodyNode=e,this._driver=t,this._normalizer=n,this._triggerCache={},this.onRemovalComplete=(i,s)=>{},this._transitionEngine=new Nye(e,t,n),this._timelineEngine=new Eye(e,t,n),this._transitionEngine.onRemovalComplete=(i,s)=>this.onRemovalComplete(i,s)}registerTrigger(e,t,n,i,s){const o=e+"-"+i;let a=this._triggerCache[o];if(!a){const c=[],f=NP(this._driver,s,c,[]);if(c.length)throw function PCe(r,e){return new ge(3404,!1)}();a=function vye(r,e,t){return new Cye(r,e,t)}(i,f,this._normalizer),this._triggerCache[o]=a}this._transitionEngine.registerTrigger(t,i,a)}register(e,t){this._transitionEngine.register(e,t)}destroy(e,t){this._transitionEngine.destroy(e,t)}onInsert(e,t,n,i){this._transitionEngine.insertNode(e,t,n,i)}onRemove(e,t,n){this._transitionEngine.removeNode(e,t,n)}disableAnimations(e,t){this._transitionEngine.markElementAsDisabled(e,t)}process(e,t,n,i){if("@"==n.charAt(0)){const[s,o]=RW(n);this._timelineEngine.command(s,t,o,i)}else this._transitionEngine.trigger(e,t,n,i)}listen(e,t,n,i,s){if("@"==n.charAt(0)){const[o,a]=RW(n);return this._timelineEngine.listen(o,t,a,s)}return this._transitionEngine.listen(e,t,n,i,s)}flush(e=-1){this._transitionEngine.flush(e)}get players(){return[...this._transitionEngine.players,...this._timelineEngine.players]}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}afterFlushAnimationsDone(e){this._transitionEngine.afterFlushAnimationsDone(e)}}let Hye=(()=>{class e{constructor(n,i,s){this._element=n,this._startStyles=i,this._endStyles=s,this._state=0;let o=e.initialStylesByElement.get(n);o||e.initialStylesByElement.set(n,o=new Map),this._initialStyles=o}start(){this._state<1&&(this._startStyles&&Ec(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(Ec(this._element,this._initialStyles),this._endStyles&&(Ec(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(e.initialStylesByElement.delete(this._element),this._startStyles&&(w6(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(w6(this._element,this._endStyles),this._endStyles=null),Ec(this._element,this._initialStyles),this._state=3)}}return e.initialStylesByElement=new WeakMap,e})();function $P(r){let e=null;return r.forEach((t,n)=>{(function Vye(r){return"display"===r||"position"===r})(n)&&(e=e||new Map,e.set(n,t))}),e}class oq{constructor(e,t,n,i){this.element=e,this.keyframes=t,this.options=n,this._specialStyles=i,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=n.duration,this._delay=n.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const e=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,e,this.options),this._finalKeyframe=e.length?e[e.length-1]:new Map,this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(e){const t=[];return e.forEach(n=>{t.push(Object.fromEntries(n))}),t}_triggerWebAnimation(e,t,n){return e.animate(this._convertKeyframesToObject(t),n)}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(e=>e()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}setPosition(e){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=e*this.time}getPosition(){return+(this.domPlayer.currentTime??0)/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const e=new Map;this.hasStarted()&&this._finalKeyframe.forEach((n,i)=>{"offset"!==i&&e.set(i,this._finished?n:WW(this.element,i))}),this.currentSnapshot=e}triggerCallback(e){const t="start"===e?this._onStartFns:this._onDoneFns;t.forEach(n=>n()),t.length=0}}class Fye{validateStyleProperty(e){return!0}validateAnimatableStyleProperty(e){return!0}matchesElement(e,t){return!1}containsElement(e,t){return DW(e,t)}getParentElement(e){return SP(e)}query(e,t,n){return HW(e,t,n)}computeStyle(e,t,n){return window.getComputedStyle(e)[t]}animate(e,t,n,i,s,o=[]){const c={duration:n,delay:i,fill:0==i?"both":"forwards"};s&&(c.easing=s);const l=new Map,f=o.filter(E=>E instanceof oq);(function jCe(r,e){return 0===r||0===e})(n,i)&&f.forEach(E=>{E.currentSnapshot.forEach((w,R)=>l.set(R,w))});let d=function UCe(r){return r.length?r[0]instanceof Map?r:r.map(e=>GW(e)):[]}(t).map(E=>W4(E));d=function ZCe(r,e,t){if(t.size&&e.length){let n=e[0],i=[];if(t.forEach((s,o)=>{n.has(o)||i.push(o),n.set(o,s)}),i.length)for(let s=1;s<e.length;s++){let o=e[s];i.forEach(a=>o.set(a,WW(r,a)))}}return e}(e,d,l);const m=function Dye(r,e){let t=null,n=null;return Array.isArray(e)&&e.length?(t=$P(e[0]),e.length>1&&(n=$P(e[e.length-1]))):e instanceof Map&&(t=$P(e)),t||n?new Hye(r,t,n):null}(e,d);return new oq(e,d,c,m)}}let $ye=(()=>{var r;class e extends AW{constructor(n,i){super(),this._nextAnimationId=0,this._renderer=n.createRenderer(i.body,{id:"0",encapsulation:bo.None,styles:[],data:{animation:[]}})}build(n){const i=this._nextAnimationId.toString();this._nextAnimationId++;const s=Array.isArray(n)?NW(n):n;return aq(this._renderer,null,i,"register",[s]),new Gye(i,this._renderer)}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(C7),Pe(b2))},r.\u0275prov=He({token:r,factory:r.\u0275fac}),e})();class Gye extends nCe{constructor(e,t){super(),this._id=e,this._renderer=t}create(e,t){return new Bye(this._id,e,t||{},this._renderer)}}class Bye{constructor(e,t,n,i){this.id=e,this.element=t,this._renderer=i,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",n)}_listen(e,t){return this._renderer.listen(this.element,`@@${this.id}:${e}`,t)}_command(e,...t){return aq(this._renderer,this.element,this.id,e,t)}onDone(e){this._listen("done",e)}onStart(e){this._listen("start",e)}onDestroy(e){this._listen("destroy",e)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(e){this._command("setPosition",e)}getPosition(){return this._renderer.engine.players[+this.id]?.getPosition()??0}}function aq(r,e,t,n,i){return r.setProperty(e,`@@${t}:${n}`,i)}const cq="@.disabled";let Uye=(()=>{var r;class e{constructor(n,i,s){this.delegate=n,this.engine=i,this._zone=s,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,i.onRemovalComplete=(o,a)=>{const c=a?.parentNode(o);c&&a.removeChild(c,o)}}createRenderer(n,i){const o=this.delegate.createRenderer(n,i);if(!(n&&i&&i.data&&i.data.animation)){let d=this._rendererCache.get(o);return d||(d=new lq("",o,this.engine,()=>this._rendererCache.delete(o)),this._rendererCache.set(o,d)),d}const a=i.id,c=i.id+"-"+this._currentId;this._currentId++,this.engine.register(c,n);const l=d=>{Array.isArray(d)?d.forEach(l):this.engine.registerTrigger(a,c,n,d.name,d)};return i.data.animation.forEach(l),new Wye(this,c,o,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){queueMicrotask(()=>{this._microtaskId++})}scheduleListenerCallback(n,i,s){n>=0&&n<this._microtaskId?this._zone.run(()=>i(s)):(0==this._animationCallbacksBuffer.length&&queueMicrotask(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(o=>{const[a,c]=o;a(c)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([i,s]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(C7),Pe(Zg),Pe(c1))},r.\u0275prov=He({token:r,factory:r.\u0275fac}),e})();class lq{constructor(e,t,n,i){this.namespaceId=e,this.delegate=t,this.engine=n,this._onDestroy=i}get data(){return this.delegate.data}destroyNode(e){this.delegate.destroyNode?.(e)}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.engine.afterFlushAnimationsDone(()=>{queueMicrotask(()=>{this.delegate.destroy()})}),this._onDestroy?.()}createElement(e,t){return this.delegate.createElement(e,t)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}appendChild(e,t){this.delegate.appendChild(e,t),this.engine.onInsert(this.namespaceId,t,e,!1)}insertBefore(e,t,n,i=!0){this.delegate.insertBefore(e,t,n),this.engine.onInsert(this.namespaceId,t,e,i)}removeChild(e,t,n){this.engine.onRemove(this.namespaceId,t,this.delegate)}selectRootElement(e,t){return this.delegate.selectRootElement(e,t)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,t,n,i){this.delegate.setAttribute(e,t,n,i)}removeAttribute(e,t,n){this.delegate.removeAttribute(e,t,n)}addClass(e,t){this.delegate.addClass(e,t)}removeClass(e,t){this.delegate.removeClass(e,t)}setStyle(e,t,n,i){this.delegate.setStyle(e,t,n,i)}removeStyle(e,t,n){this.delegate.removeStyle(e,t,n)}setProperty(e,t,n){"@"==t.charAt(0)&&t==cq?this.disableAnimations(e,!!n):this.delegate.setProperty(e,t,n)}setValue(e,t){this.delegate.setValue(e,t)}listen(e,t,n){return this.delegate.listen(e,t,n)}disableAnimations(e,t){this.engine.disableAnimations(e,t)}}class Wye extends lq{constructor(e,t,n,i,s){super(t,n,i,s),this.factory=e,this.namespaceId=t}setProperty(e,t,n){"@"==t.charAt(0)?"."==t.charAt(1)&&t==cq?this.disableAnimations(e,n=void 0===n||!!n):this.engine.process(this.namespaceId,e,t.slice(1),n):this.delegate.setProperty(e,t,n)}listen(e,t,n){if("@"==t.charAt(0)){const i=function qye(r){switch(r){case"body":return document.body;case"document":return document;case"window":return window;default:return r}}(e);let s=t.slice(1),o="";return"@"!=s.charAt(0)&&([s,o]=function jye(r){const e=r.indexOf(".");return[r.substring(0,e),r.slice(e+1)]}(s)),this.engine.listen(this.namespaceId,i,s,o,a=>{this.factory.scheduleListenerCallback(a._data||-1,n,a)})}return this.delegate.listen(e,t,n)}}let Zye=(()=>{var r;class e extends Zg{constructor(n,i,s,o){super(n.body,i,s)}ngOnDestroy(){this.flush()}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(b2),Pe(PP),Pe(RP),Pe(d6))},r.\u0275prov=He({token:r,factory:r.\u0275fac}),e})();const uq=[{provide:AW,useClass:$ye},{provide:RP,useFactory:function Yye(){return new pye}},{provide:Zg,useClass:Zye},{provide:C7,useFactory:function Kye(r,e,t){return new Uye(r,e,t)},deps:[ES,Zg,c1]}],GP=[{provide:PP,useFactory:()=>new Fye},{provide:iH,useValue:"BrowserAnimations"},...uq],fq=[{provide:PP,useClass:VW},{provide:iH,useValue:"NoopAnimations"},...uq];let Xye=(()=>{var r;class e{static withConfig(n){return{ngModule:e,providers:n.disableAnimations?fq:GP}}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275mod=Ei({type:r}),r.\u0275inj=X2({providers:GP,imports:[eB]}),e})();const Hr=void 0,Jye=["fr",[["AM","PM"],Hr,Hr],Hr,[["D","L","M","M","J","V","S"],["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"],["di","lu","ma","me","je","ve","sa"]],Hr,[["J","F","M","A","M","J","J","A","S","O","N","D"],["janv.","f\xe9vr.","mars","avr.","mai","juin","juil.","ao\xfbt","sept.","oct.","nov.","d\xe9c."],["janvier","f\xe9vrier","mars","avril","mai","juin","juillet","ao\xfbt","septembre","octobre","novembre","d\xe9cembre"]],Hr,[["av. J.-C.","ap. J.-C."],Hr,["avant J\xe9sus-Christ","apr\xe8s J\xe9sus-Christ"]],1,[6,0],["dd/MM/y","d MMM y","d MMMM y","EEEE d MMMM y"],["HH:mm","HH:mm:ss","HH:mm:ss z","HH:mm:ss zzzz"],["{1} {0}","{1}, {0}","{1} '\xe0' {0}",Hr],[",","\u202f",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0\xa0%","#,##0.00\xa0\xa4","#E0"],"EUR","\u20ac","euro",{ARS:["$AR","$"],AUD:["$AU","$"],BEF:["FB"],BMD:["$BM","$"],BND:["$BN","$"],BYN:[Hr,"\u0440."],BZD:["$BZ","$"],CAD:["$CA","$"],CLP:["$CL","$"],CNY:[Hr,"\xa5"],COP:["$CO","$"],CYP:["\xa3CY"],EGP:[Hr,"\xa3E"],FJD:["$FJ","$"],FKP:["\xa3FK","\xa3"],FRF:["F"],GBP:["\xa3GB","\xa3"],GIP:["\xa3GI","\xa3"],HKD:[Hr,"$"],IEP:["\xa3IE"],ILP:["\xa3IL"],ITL:["\u20a4IT"],JPY:[Hr,"\xa5"],KMF:[Hr,"FC"],LBP:["\xa3LB","\xa3L"],MTP:["\xa3MT"],MXN:["$MX","$"],NAD:["$NA","$"],NIO:[Hr,"$C"],NZD:["$NZ","$"],PHP:[Hr,"\u20b1"],RHD:["$RH"],RON:[Hr,"L"],RWF:[Hr,"FR"],SBD:["$SB","$"],SGD:["$SG","$"],SRD:["$SR","$"],TOP:[Hr,"$T"],TTD:["$TT","$"],TWD:[Hr,"NT$"],USD:["$US","$"],UYU:["$UY","$"],WST:["$WS"],XCD:[Hr,"$"],XPF:["FCFP"],ZMW:[Hr,"Kw"]},"ltr",function Qye(r){const t=Math.floor(Math.abs(r)),n=r.toString().replace(/^[^.]*\.?/,"").length,i=parseInt(r.toString().replace(/^[^e]*(e([-+]?\d+))?/,"$2"))||0;return 0===t||1===t?1:0===i&&0!==t&&t%1e6==0&&0===n||!(i>=0&&i<=5)?4:5}];function dq(r,e,t,n,i,s,o){try{var a=r[s](o),c=a.value}catch(l){return void t(l)}a.done?e(c):Promise.resolve(c).then(n,i)}function M(r){return function(){var e=this,t=arguments;return new Promise(function(n,i){var s=r.apply(e,t);function o(c){dq(s,n,i,o,a,"next",c)}function a(c){dq(s,n,i,o,a,"throw",c)}o(void 0)})}}const hq=function(r){const e=[];let t=0;for(let n=0;n<r.length;n++){let i=r.charCodeAt(n);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=63&i|128):55296==(64512&i)&&n+1<r.length&&56320==(64512&r.charCodeAt(n+1))?(i=65536+((1023&i)<<10)+(1023&r.charCodeAt(++n)),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=63&i|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=63&i|128)}return e},UP={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(r,e){if(!Array.isArray(r))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<r.length;i+=3){const s=r[i],o=i+1<r.length,a=o?r[i+1]:0,c=i+2<r.length,l=c?r[i+2]:0;let m=(15&a)<<2|l>>6,E=63&l;c||(E=64,o||(m=64)),n.push(t[s>>2],t[(3&s)<<4|a>>4],t[m],t[E])}return n.join("")},encodeString(r,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(r):this.encodeByteArray(hq(r),e)},decodeString(r,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(r):function(r){const e=[];let t=0,n=0;for(;t<r.length;){const i=r[t++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const s=r[t++];e[n++]=String.fromCharCode((31&i)<<6|63&s)}else if(i>239&&i<365){const c=((7&i)<<18|(63&r[t++])<<12|(63&r[t++])<<6|63&r[t++])-65536;e[n++]=String.fromCharCode(55296+(c>>10)),e[n++]=String.fromCharCode(56320+(1023&c))}else{const s=r[t++],o=r[t++];e[n++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&o)}}return e.join("")}(this.decodeStringToByteArray(r,e))},decodeStringToByteArray(r,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<r.length;){const s=t[r.charAt(i++)],a=i<r.length?t[r.charAt(i)]:0;++i;const l=i<r.length?t[r.charAt(i)]:64;++i;const d=i<r.length?t[r.charAt(i)]:64;if(++i,null==s||null==a||null==l||null==d)throw new rMe;n.push(s<<2|a>>4),64!==l&&(n.push(a<<4&240|l>>2),64!==d&&n.push(l<<6&192|d))}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let r=0;r<this.ENCODED_VALS.length;r++)this.byteToCharMap_[r]=this.ENCODED_VALS.charAt(r),this.charToByteMap_[this.byteToCharMap_[r]]=r,this.byteToCharMapWebSafe_[r]=this.ENCODED_VALS_WEBSAFE.charAt(r),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[r]]=r,r>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(r)]=r,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(r)]=r)}}};class rMe extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Kg=function(r){return function(r){const e=hq(r);return UP.encodeByteArray(e,!0)}(r).replace(/\./g,"")},Xg=function(r){try{return UP.decodeString(r,!0)}catch(e){console.error("base64Decode failed: ",e)}return null},Qg=()=>{try{return function oMe(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if(typeof process>"u"||typeof process.env>"u")return;const r=process.env.__FIREBASE_DEFAULTS__;return r?JSON.parse(r):void 0})()||(()=>{if(typeof document>"u")return;let r;try{r=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=r&&Xg(r[1]);return e&&JSON.parse(e)})()}catch(r){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${r}`)}},gq=r=>{var e,t;return null===(t=null===(e=Qg())||void 0===e?void 0:e.emulatorHosts)||void 0===t?void 0:t[r]},mq=()=>{var r;return null===(r=Qg())||void 0===r?void 0:r.config},_q=r=>{var e;return null===(e=Qg())||void 0===e?void 0:e[`_${r}`]};class Jg{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"==typeof e&&(this.promise.catch(()=>{}),1===e.length?e(t):e(t,n))}}}function w2(){return typeof navigator<"u"&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function WP(){const r="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof r&&void 0!==r.id}function N6(){try{return"object"==typeof indexedDB}catch{return!1}}function wf(){return new Promise((r,e)=>{try{let t=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(n),r(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var s;e((null===(s=i.error)||void 0===s?void 0:s.message)||"")}}catch(t){e(t)}})}function qP(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}class Lo extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,Lo.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Sc.prototype.create)}}class Sc{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?function _Me(r,e){return r.replace(vMe,(t,n)=>{const i=e[n];return null!=i?String(i):`<${n}?>`})}(s,n):"Error";return new Lo(i,`${this.serviceName}: ${o} (${i}).`,n)}}const vMe=/\{\$([^}]+)}/g;function tm(r,e){if(r===e)return!0;const t=Object.keys(r),n=Object.keys(e);for(const i of t){if(!n.includes(i))return!1;const s=r[i],o=e[i];if(Cq(s)&&Cq(o)){if(!tm(s,o))return!1}else if(s!==o)return!1}for(const i of n)if(!t.includes(i))return!1;return!0}function Cq(r){return null!==r&&"object"==typeof r}function Af(r){const e=[];for(const[t,n]of Object.entries(r))Array.isArray(n)?n.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function Nf(r){const e={};return r.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[i,s]=n.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function If(r){const e=r.indexOf("?");if(!e)return"";const t=r.indexOf("#",e);return r.substring(e,t>0?t:void 0)}class MMe{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,n){let i;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");i=function EMe(r,e){if("object"!=typeof r||null===r)return!1;for(const t of e)if(t in r&&"function"==typeof r[t])return!0;return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n},void 0===i.next&&(i.next=jP),void 0===i.error&&(i.error=jP),void 0===i.complete&&(i.complete=jP);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){void 0===this.observers||void 0===this.observers[e]||(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function jP(){}const SMe=1e3,PMe=2,TMe=144e5,OMe=.5;function YP(r,e=SMe,t=PMe){const n=e*Math.pow(t,r),i=Math.round(OMe*n*(Math.random()-.5)*2);return Math.min(TMe,n+i)}function yr(r){return r&&r._delegate?r._delegate:r}class Ii{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const I6="[DEFAULT]";class wMe{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const n=new Jg;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(e?.identifier),i=null!==(t=e?.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(i)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(i)return null;throw s}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function NMe(r){return"EAGER"===r.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:I6})}catch{}for(const[t,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:i});n.resolve(s)}catch{}}}}clearInstance(e=I6){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){var e=this;return M(function*(){const t=Array.from(e.instances.values());yield Promise.all([...t.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...t.filter(n=>"_delete"in n).map(n=>n._delete())])})()}isComponentSet(){return null!=this.component}isInitialized(e=I6){return this.instances.has(e)}getOptions(e=I6){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[s,o]of this.instancesDeferred.entries())n===this.normalizeInstanceIdentifier(s)&&o.resolve(i);return i}onInit(e,t){var n;const i=this.normalizeInstanceIdentifier(t),s=null!==(n=this.onInitCallbacks.get(i))&&void 0!==n?n:new Set;s.add(e),this.onInitCallbacks.set(i,s);const o=this.instances.get(i);return o&&e(o,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const i of n)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(r=e,r===I6?void 0:r),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}var r;return n||null}normalizeInstanceIdentifier(e=I6){return this.component?this.component.multipleInstances?e:I6:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class IMe{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new wMe(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const KP=[];var Bn=function(r){return r[r.DEBUG=0]="DEBUG",r[r.VERBOSE=1]="VERBOSE",r[r.INFO=2]="INFO",r[r.WARN=3]="WARN",r[r.ERROR=4]="ERROR",r[r.SILENT=5]="SILENT",r}(Bn||{});const yq={debug:Bn.DEBUG,verbose:Bn.VERBOSE,info:Bn.INFO,warn:Bn.WARN,error:Bn.ERROR,silent:Bn.SILENT},kMe=Bn.INFO,xMe={[Bn.DEBUG]:"log",[Bn.VERBOSE]:"log",[Bn.INFO]:"info",[Bn.WARN]:"warn",[Bn.ERROR]:"error"},LMe=(r,e,...t)=>{if(e<r.logLevel)return;const n=(new Date).toISOString(),i=xMe[e];if(!i)throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`);console[i](`[${n}]  ${r.name}:`,...t)};class J8{constructor(e){this.name=e,this._logLevel=kMe,this._logHandler=LMe,this._userLogHandler=null,KP.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Bn))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?yq[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Bn.DEBUG,...e),this._logHandler(this,Bn.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Bn.VERBOSE,...e),this._logHandler(this,Bn.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Bn.INFO,...e),this._logHandler(this,Bn.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Bn.WARN,...e),this._logHandler(this,Bn.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Bn.ERROR,...e),this._logHandler(this,Bn.ERROR,...e)}}const RMe=(r,e)=>e.some(t=>r instanceof t);let Mq,Eq;const Sq=new WeakMap,XP=new WeakMap,Pq=new WeakMap,QP=new WeakMap,JP=new WeakMap;let eT={get(r,e,t){if(r instanceof IDBTransaction){if("done"===e)return XP.get(r);if("objectStoreNames"===e)return r.objectStoreNames||Pq.get(r);if("store"===e)return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return q4(r[e])},set:(r,e,t)=>(r[e]=t,!0),has:(r,e)=>r instanceof IDBTransaction&&("done"===e||"store"===e)||e in r};function GMe(r){return"function"==typeof r?function $Me(r){return r!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function DMe(){return Eq||(Eq=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(r)?function(...e){return r.apply(tT(this),e),q4(Sq.get(this))}:function(...e){return q4(r.apply(tT(this),e))}:function(e,...t){const n=r.call(tT(this),e,...t);return Pq.set(n,e.sort?e.sort():[e]),q4(n)}}(r):(r instanceof IDBTransaction&&function VMe(r){if(XP.has(r))return;const e=new Promise((t,n)=>{const i=()=>{r.removeEventListener("complete",s),r.removeEventListener("error",o),r.removeEventListener("abort",o)},s=()=>{t(),i()},o=()=>{n(r.error||new DOMException("AbortError","AbortError")),i()};r.addEventListener("complete",s),r.addEventListener("error",o),r.addEventListener("abort",o)});XP.set(r,e)}(r),RMe(r,function zMe(){return Mq||(Mq=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(r,eT):r)}function q4(r){if(r instanceof IDBRequest)return function HMe(r){const e=new Promise((t,n)=>{const i=()=>{r.removeEventListener("success",s),r.removeEventListener("error",o)},s=()=>{t(q4(r.result)),i()},o=()=>{n(r.error),i()};r.addEventListener("success",s),r.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&Sq.set(t,r)}).catch(()=>{}),JP.set(e,r),e}(r);if(QP.has(r))return QP.get(r);const e=GMe(r);return e!==r&&(QP.set(r,e),JP.set(e,r)),e}const tT=r=>JP.get(r),UMe=["get","getKey","getAll","getAllKeys","count"],WMe=["put","add","delete","clear"],nT=new Map;function Tq(r,e){if(!(r instanceof IDBDatabase)||e in r||"string"!=typeof e)return;if(nT.get(e))return nT.get(e);const t=e.replace(/FromIndex$/,""),n=e!==t,i=WMe.includes(t);if(!(t in(n?IDBIndex:IDBObjectStore).prototype)||!i&&!UMe.includes(t))return;const s=function(){var o=M(function*(a,...c){const l=this.transaction(a,i?"readwrite":"readonly");let f=l.store;return n&&(f=f.index(c.shift())),(yield Promise.all([f[t](...c),i&&l.done]))[0]});return function(c){return o.apply(this,arguments)}}();return nT.set(e,s),s}!function FMe(r){eT=r(eT)}(r=>({...r,get:(e,t,n)=>Tq(e,t)||r.get(e,t,n),has:(e,t)=>!!Tq(e,t)||r.has(e,t)}));class qMe{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(function jMe(r){const e=r.getComponent();return"VERSION"===e?.type}(t)){const n=t.getImmediate();return`${n.library}/${n.version}`}return null}).filter(t=>t).join(" ")}}const rT="@firebase/app",k6=new J8("@firebase/app"),nm="[DEFAULT]",CEe={[rT]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},x6=new Map,rm=new Map;function yEe(r,e){try{r.container.addComponent(e)}catch(t){k6.debug(`Component ${e.name} failed to register with FirebaseApp ${r.name}`,t)}}function cs(r){const e=r.name;if(rm.has(e))return k6.debug(`There were multiple attempts to register component ${e}.`),!1;rm.set(e,r);for(const t of x6.values())yEe(t,r);return!0}function e5(r,e){const t=r.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),r.container.getProvider(e)}const x3=new Sc("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class EEe{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Ii("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw x3.create("app-deleted",{appName:this._name})}}const L6="9.23.0";function bq(r,e={}){let t=r;"object"!=typeof e&&(e={name:e});const n=Object.assign({name:nm,automaticDataCollectionEnabled:!1},e),i=n.name;if("string"!=typeof i||!i)throw x3.create("bad-app-name",{appName:String(i)});if(t||(t=mq()),!t)throw x3.create("no-options");const s=x6.get(i);if(s){if(tm(t,s.options)&&tm(n,s.config))return s;throw x3.create("duplicate-app",{appName:i})}const o=new IMe(i);for(const c of rm.values())o.addComponent(c);const a=new EEe(t,n,o);return x6.set(i,a),a}function iT(r=nm){const e=x6.get(r);if(!e&&r===nm&&mq())return bq();if(!e)throw x3.create("no-app",{appName:r});return e}function wq(){return Array.from(x6.values())}function Mr(r,e,t){var n;let i=null!==(n=CEe[r])&&void 0!==n?n:r;t&&(i+=`-${t}`);const s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const a=[`Unable to register library "${i}" with version "${e}":`];return s&&a.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),void k6.warn(a.join(" "))}cs(new Ii(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}const SEe="firebase-heartbeat-database",PEe=1,kf="firebase-heartbeat-store";let oT=null;function Aq(){return oT||(oT=function BMe(r,e,{blocked:t,upgrade:n,blocking:i,terminated:s}={}){const o=indexedDB.open(r,e),a=q4(o);return n&&o.addEventListener("upgradeneeded",c=>{n(q4(o.result),c.oldVersion,c.newVersion,q4(o.transaction),c)}),t&&o.addEventListener("blocked",c=>t(c.oldVersion,c.newVersion,c)),a.then(c=>{s&&c.addEventListener("close",()=>s()),i&&c.addEventListener("versionchange",l=>i(l.oldVersion,l.newVersion,l))}).catch(()=>{}),a}(SEe,PEe,{upgrade:(r,e)=>{0===e&&r.createObjectStore(kf)}}).catch(r=>{throw x3.create("idb-open",{originalErrorMessage:r.message})})),oT}function aT(){return(aT=M(function*(r){try{return yield(yield Aq()).transaction(kf).objectStore(kf).get(Iq(r))}catch(e){if(e instanceof Lo)k6.warn(e.message);else{const t=x3.create("idb-get",{originalErrorMessage:e?.message});k6.warn(t.message)}}})).apply(this,arguments)}function Nq(r,e){return cT.apply(this,arguments)}function cT(){return(cT=M(function*(r,e){try{const n=(yield Aq()).transaction(kf,"readwrite");yield n.objectStore(kf).put(e,Iq(r)),yield n.done}catch(t){if(t instanceof Lo)k6.warn(t.message);else{const n=x3.create("idb-set",{originalErrorMessage:t?.message});k6.warn(n.message)}}})).apply(this,arguments)}function Iq(r){return`${r.name}!${r.options.appId}`}class wEe{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new NEe(t),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}triggerHeartbeat(){var e=this;return M(function*(){const n=e.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=kq();if(null===e._heartbeatsCache&&(e._heartbeatsCache=yield e._heartbeatsCachePromise),e._heartbeatsCache.lastSentHeartbeatDate!==i&&!e._heartbeatsCache.heartbeats.some(s=>s.date===i))return e._heartbeatsCache.heartbeats.push({date:i,agent:n}),e._heartbeatsCache.heartbeats=e._heartbeatsCache.heartbeats.filter(s=>{const o=new Date(s.date).valueOf();return Date.now()-o<=2592e6}),e._storage.overwrite(e._heartbeatsCache)})()}getHeartbeatsHeader(){var e=this;return M(function*(){if(null===e._heartbeatsCache&&(yield e._heartbeatsCachePromise),null===e._heartbeatsCache||0===e._heartbeatsCache.heartbeats.length)return"";const t=kq(),{heartbeatsToSend:n,unsentEntries:i}=function AEe(r,e=1024){const t=[];let n=r.slice();for(const i of r){const s=t.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),xq(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),xq(t)>e){t.pop();break}n=n.slice(1)}return{heartbeatsToSend:t,unsentEntries:n}}(e._heartbeatsCache.heartbeats),s=Kg(JSON.stringify({version:2,heartbeats:n}));return e._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(e._heartbeatsCache.heartbeats=i,yield e._storage.overwrite(e._heartbeatsCache)):(e._heartbeatsCache.heartbeats=[],e._storage.overwrite(e._heartbeatsCache)),s})()}}function kq(){return(new Date).toISOString().substring(0,10)}class NEe{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return M(function*(){return!!N6()&&wf().then(()=>!0).catch(()=>!1)})()}read(){var e=this;return M(function*(){return(yield e._canUseIndexedDBPromise)&&(yield function TEe(r){return aT.apply(this,arguments)}(e.app))||{heartbeats:[]}})()}overwrite(e){var t=this;return M(function*(){var n;if(yield t._canUseIndexedDBPromise){const s=yield t.read();return Nq(t.app,{lastSentHeartbeatDate:null!==(n=e.lastSentHeartbeatDate)&&void 0!==n?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}})()}add(e){var t=this;return M(function*(){var n;if(yield t._canUseIndexedDBPromise){const s=yield t.read();return Nq(t.app,{lastSentHeartbeatDate:null!==(n=e.lastSentHeartbeatDate)&&void 0!==n?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}})()}}function xq(r){return Kg(JSON.stringify({version:2,heartbeats:r})).length}!function IEe(r){cs(new Ii("platform-logger",e=>new qMe(e),"PRIVATE")),cs(new Ii("heartbeat",e=>new wEe(e),"PRIVATE")),Mr(rT,"0.9.13",r),Mr(rT,"0.9.13","esm2017"),Mr("fire-js","")}("");var Je,kEe=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Sa={},lT=lT||{},Yt=kEe||self;function im(r){var e=typeof r;return"array"==(e="object"!=e?e:r?Array.isArray(r)?"array":e:"null")||"object"==e&&"number"==typeof r.length}function xf(r){var e=typeof r;return"object"==e&&null!=r||"function"==e}var uT="closure_uid_"+(1e9*Math.random()>>>0),LEe=0;function REe(r,e,t){return r.call.apply(r.bind,arguments)}function zEe(r,e,t){if(!r)throw Error();if(2<arguments.length){var n=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,n),r.apply(e,i)}}return function(){return r.apply(e,arguments)}}function ki(r,e,t){return(ki=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?REe:zEe).apply(null,arguments)}function sm(r,e){var t=Array.prototype.slice.call(arguments,1);return function(){var n=t.slice();return n.push.apply(n,arguments),r.apply(this,n)}}function A2(r,e){function t(){}t.prototype=e.prototype,r.$=e.prototype,r.prototype=new t,r.prototype.constructor=r,r.ac=function(n,i,s){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return e.prototype[i].apply(n,o)}}function j4(){this.s=this.s,this.o=this.o}j4.prototype.s=!1,j4.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),0)&&function xEe(r){Object.prototype.hasOwnProperty.call(r,uT)&&r[uT]||(r[uT]=++LEe)}(this)},j4.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const Lq=Array.prototype.indexOf?function(r,e){return Array.prototype.indexOf.call(r,e,void 0)}:function(r,e){if("string"==typeof r)return"string"!=typeof e||1!=e.length?-1:r.indexOf(e,0);for(let t=0;t<r.length;t++)if(t in r&&r[t]===e)return t;return-1};function fT(r){const e=r.length;if(0<e){const t=Array(e);for(let n=0;n<e;n++)t[n]=r[n];return t}return[]}function Rq(r,e){for(let t=1;t<arguments.length;t++){const n=arguments[t];if(im(n)){const i=r.length||0,s=n.length||0;r.length=i+s;for(let o=0;o<s;o++)r[i+o]=n[o]}else r.push(n)}}function xi(r,e){this.type=r,this.g=this.target=e,this.defaultPrevented=!1}xi.prototype.h=function(){this.defaultPrevented=!0};var HEe=function(){if(!Yt.addEventListener||!Object.defineProperty)return!1;var r=!1,e=Object.defineProperty({},"passive",{get:function(){r=!0}});try{Yt.addEventListener("test",()=>{},e),Yt.removeEventListener("test",()=>{},e)}catch{}return r}();function Lf(r){return/^[\s\xa0]*$/.test(r)}function om(){var r=Yt.navigator;return r&&(r=r.userAgent)?r:""}function Pc(r){return-1!=om().indexOf(r)}function dT(r){return dT[" "](r),r}dT[" "]=function(){};var pT,r,FEe=Pc("Opera"),t5=Pc("Trident")||Pc("MSIE"),zq=Pc("Edge"),hT=zq||t5,Dq=Pc("Gecko")&&!(-1!=om().toLowerCase().indexOf("webkit")&&!Pc("Edge"))&&!(Pc("Trident")||Pc("MSIE"))&&!Pc("Edge"),$Ee=-1!=om().toLowerCase().indexOf("webkit")&&!Pc("Edge");function Hq(){var r=Yt.document;return r?r.documentMode:void 0}e:{var gT="",mT=(r=om(),Dq?/rv:([^\);]+)(\)|;)/.exec(r):zq?/Edge\/([\d\.]+)/.exec(r):t5?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(r):$Ee?/WebKit\/(\S+)/.exec(r):FEe?/(?:Version)[ \/]?(\S+)/.exec(r):void 0);if(mT&&(gT=mT?mT[1]:""),t5){var _T=Hq();if(null!=_T&&_T>parseFloat(gT)){pT=String(_T);break e}}pT=gT}var GEe=Yt.document&&t5&&(Hq()||parseInt(pT,10))||void 0;function Rf(r,e){if(xi.call(this,r?r.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,r){var t=this.type=r.type,n=r.changedTouches&&r.changedTouches.length?r.changedTouches[0]:null;if(this.target=r.target||r.srcElement,this.g=e,e=r.relatedTarget){if(Dq){e:{try{dT(e.nodeName);var i=!0;break e}catch{}i=!1}i||(e=null)}}else"mouseover"==t?e=r.fromElement:"mouseout"==t&&(e=r.toElement);this.relatedTarget=e,n?(this.clientX=void 0!==n.clientX?n.clientX:n.pageX,this.clientY=void 0!==n.clientY?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0):(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0),this.button=r.button,this.key=r.key||"",this.ctrlKey=r.ctrlKey,this.altKey=r.altKey,this.shiftKey=r.shiftKey,this.metaKey=r.metaKey,this.pointerId=r.pointerId||0,this.pointerType="string"==typeof r.pointerType?r.pointerType:BEe[r.pointerType]||"",this.state=r.state,this.i=r,r.defaultPrevented&&Rf.$.h.call(this)}}A2(Rf,xi);var BEe={2:"touch",3:"pen",4:"mouse"};Rf.prototype.h=function(){Rf.$.h.call(this);var r=this.i;r.preventDefault?r.preventDefault():r.returnValue=!1};var zf="closure_listenable_"+(1e6*Math.random()|0),UEe=0;function WEe(r,e,t,n,i){this.listener=r,this.proxy=null,this.src=e,this.type=t,this.capture=!!n,this.la=i,this.key=++UEe,this.fa=this.ia=!1}function am(r){r.fa=!0,r.listener=null,r.proxy=null,r.src=null,r.la=null}function CT(r,e,t){for(const n in r)e.call(t,r[n],n,r)}function Fq(r){const e={};for(const t in r)e[t]=r[t];return e}const $q="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Gq(r,e){let t,n;for(let i=1;i<arguments.length;i++){for(t in n=arguments[i],n)r[t]=n[t];for(let s=0;s<$q.length;s++)t=$q[s],Object.prototype.hasOwnProperty.call(n,t)&&(r[t]=n[t])}}function cm(r){this.src=r,this.g={},this.h=0}function yT(r,e){var t=e.type;if(t in r.g){var s,n=r.g[t],i=Lq(n,e);(s=0<=i)&&Array.prototype.splice.call(n,i,1),s&&(am(e),0==r.g[t].length&&(delete r.g[t],r.h--))}}function MT(r,e,t,n){for(var i=0;i<r.length;++i){var s=r[i];if(!s.fa&&s.listener==e&&s.capture==!!t&&s.la==n)return i}return-1}cm.prototype.add=function(r,e,t,n,i){var s=r.toString();(r=this.g[s])||(r=this.g[s]=[],this.h++);var o=MT(r,e,n,i);return-1<o?(e=r[o],t||(e.ia=!1)):((e=new WEe(e,this.src,s,!!n,i)).ia=t,r.push(e)),e};var ET="closure_lm_"+(1e6*Math.random()|0),ST={};function Bq(r,e,t,n,i){if(n&&n.once)return Wq(r,e,t,n,i);if(Array.isArray(e)){for(var s=0;s<e.length;s++)Bq(r,e[s],t,n,i);return null}return t=bT(t),r&&r[zf]?r.O(e,t,xf(n)?!!n.capture:!!n,i):Uq(r,e,t,!1,n,i)}function Uq(r,e,t,n,i,s){if(!e)throw Error("Invalid event type");var o=xf(i)?!!i.capture:!!i,a=TT(r);if(a||(r[ET]=a=new cm(r)),(t=a.add(e,t,n,o,s)).proxy)return t;if(n=function jEe(){const e=ZEe;return function r(t){return e.call(r.src,r.listener,t)}}(),t.proxy=n,n.src=r,n.listener=t,r.addEventListener)HEe||(i=o),void 0===i&&(i=!1),r.addEventListener(e.toString(),n,i);else if(r.attachEvent)r.attachEvent(jq(e.toString()),n);else{if(!r.addListener||!r.removeListener)throw Error("addEventListener and attachEvent are unavailable.");r.addListener(n)}return t}function Wq(r,e,t,n,i){if(Array.isArray(e)){for(var s=0;s<e.length;s++)Wq(r,e[s],t,n,i);return null}return t=bT(t),r&&r[zf]?r.P(e,t,xf(n)?!!n.capture:!!n,i):Uq(r,e,t,!0,n,i)}function qq(r,e,t,n,i){if(Array.isArray(e))for(var s=0;s<e.length;s++)qq(r,e[s],t,n,i);else n=xf(n)?!!n.capture:!!n,t=bT(t),r&&r[zf]?(r=r.i,(e=String(e).toString())in r.g&&-1<(t=MT(s=r.g[e],t,n,i))&&(am(s[t]),Array.prototype.splice.call(s,t,1),0==s.length&&(delete r.g[e],r.h--))):r&&(r=TT(r))&&(e=r.g[e.toString()],r=-1,e&&(r=MT(e,t,n,i)),(t=-1<r?e[r]:null)&&PT(t))}function PT(r){if("number"!=typeof r&&r&&!r.fa){var e=r.src;if(e&&e[zf])yT(e.i,r);else{var t=r.type,n=r.proxy;e.removeEventListener?e.removeEventListener(t,n,r.capture):e.detachEvent?e.detachEvent(jq(t),n):e.addListener&&e.removeListener&&e.removeListener(n),(t=TT(e))?(yT(t,r),0==t.h&&(t.src=null,e[ET]=null)):am(r)}}}function jq(r){return r in ST?ST[r]:ST[r]="on"+r}function ZEe(r,e){if(r.fa)r=!0;else{e=new Rf(e,this);var t=r.listener,n=r.la||r.src;r.ia&&PT(r),r=t.call(n,e)}return r}function TT(r){return(r=r[ET])instanceof cm?r:null}var OT="__closure_events_fn_"+(1e9*Math.random()>>>0);function bT(r){return"function"==typeof r?r:(r[OT]||(r[OT]=function(e){return r.handleEvent(e)}),r[OT])}function N2(){j4.call(this),this.i=new cm(this),this.S=this,this.J=null}function ri(r,e){var t,n=r.J;if(n)for(t=[];n;n=n.J)t.push(n);if(r=r.S,n=e.type||e,"string"==typeof e)e=new xi(e,r);else if(e instanceof xi)e.target=e.target||r;else{var i=e;Gq(e=new xi(n,r),i)}if(i=!0,t)for(var s=t.length-1;0<=s;s--){var o=e.g=t[s];i=lm(o,n,!0,e)&&i}if(i=lm(o=e.g=r,n,!0,e)&&i,i=lm(o,n,!1,e)&&i,t)for(s=0;s<t.length;s++)i=lm(o=e.g=t[s],n,!1,e)&&i}function lm(r,e,t,n){if(!(e=r.i.g[String(e)]))return!0;e=e.concat();for(var i=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.fa&&o.capture==t){var a=o.listener,c=o.la||o.src;o.ia&&yT(r.i,o),i=!1!==a.call(c,n)&&i}}return i&&!n.defaultPrevented}A2(N2,j4),N2.prototype[zf]=!0,N2.prototype.removeEventListener=function(r,e,t,n){qq(this,r,e,t,n)},N2.prototype.N=function(){if(N2.$.N.call(this),this.i){var e,r=this.i;for(e in r.g){for(var t=r.g[e],n=0;n<t.length;n++)am(t[n]);delete r.g[e],r.h--}}this.J=null},N2.prototype.O=function(r,e,t,n){return this.i.add(String(r),e,!1,t,n)},N2.prototype.P=function(r,e,t,n){return this.i.add(String(r),e,!0,t,n)};var wT=Yt.JSON.stringify;function KEe(){var r=AT;let e=null;return r.g&&(e=r.g,r.g=r.g.next,r.g||(r.h=null),e.next=null),e}var Zq=new class YEe{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}(()=>new QEe,r=>r.reset());class QEe{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function JEe(r){var e=1;r=r.split(":");const t=[];for(;0<e&&r.length;)t.push(r.shift()),e--;return r.length&&t.push(r.join(":")),t}function eSe(r){Yt.setTimeout(()=>{throw r},0)}let Df,Hf=!1,AT=new class XEe{constructor(){this.h=this.g=null}add(e,t){const n=Zq.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}},Yq=()=>{const r=Yt.Promise.resolve(void 0);Df=()=>{r.then(tSe)}};var tSe=()=>{for(var r;r=KEe();){try{r.h.call(r.g)}catch(t){eSe(t)}var e=Zq;e.j(r),100>e.h&&(e.h++,r.next=e.g,e.g=r)}Hf=!1};function um(r,e){N2.call(this),this.h=r||1,this.g=e||Yt,this.j=ki(this.qb,this),this.l=Date.now()}function NT(r){r.ga=!1,r.T&&(r.g.clearTimeout(r.T),r.T=null)}function IT(r,e,t){if("function"==typeof r)t&&(r=ki(r,t));else{if(!r||"function"!=typeof r.handleEvent)throw Error("Invalid listener argument");r=ki(r.handleEvent,r)}return 2147483647<Number(e)?-1:Yt.setTimeout(r,e||0)}function Kq(r){r.g=IT(()=>{r.g=null,r.i&&(r.i=!1,Kq(r))},r.j);const e=r.h;r.h=null,r.m.apply(null,e)}A2(um,N2),(Je=um.prototype).ga=!1,Je.T=null,Je.qb=function(){if(this.ga){var r=Date.now()-this.l;0<r&&r<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-r):(this.T&&(this.g.clearTimeout(this.T),this.T=null),ri(this,"tick"),this.ga&&(NT(this),this.start()))}},Je.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())},Je.N=function(){um.$.N.call(this),NT(this),delete this.g};class nSe extends j4{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:Kq(this)}N(){super.N(),this.g&&(Yt.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Vf(r){j4.call(this),this.h=r,this.g={}}A2(Vf,j4);var Xq=[];function Qq(r,e,t,n){Array.isArray(t)||(t&&(Xq[0]=t.toString()),t=Xq);for(var i=0;i<t.length;i++){var s=Bq(e,t[i],n||r.handleEvent,!1,r.h||r);if(!s)break;r.g[s.key]=s}}function Jq(r){CT(r.g,function(e,t){this.g.hasOwnProperty(t)&&PT(e)},r),r.g={}}function fm(){this.g=!0}function n5(r,e,t,n){r.info(function(){return"XMLHTTP TEXT ("+e+"): "+function oSe(r,e){if(!r.g)return e;if(!e)return null;try{var t=JSON.parse(e);if(t)for(r=0;r<t.length;r++)if(Array.isArray(t[r])){var n=t[r];if(!(2>n.length)){var i=n[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<i.length;o++)i[o]=""}}}return wT(t)}catch{return e}}(r,t)+(n?" "+n:"")})}Vf.prototype.N=function(){Vf.$.N.call(this),Jq(this)},Vf.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},fm.prototype.Ea=function(){this.g=!1},fm.prototype.info=function(){};var R6={},ej=null;function dm(){return ej=ej||new N2}function tj(r){xi.call(this,R6.Ta,r)}function Ff(r){const e=dm();ri(e,new tj(e))}function nj(r,e){xi.call(this,R6.STAT_EVENT,r),this.stat=e}function ls(r){const e=dm();ri(e,new nj(e,r))}function rj(r,e){xi.call(this,R6.Ua,r),this.size=e}function $f(r,e){if("function"!=typeof r)throw Error("Fn must not be null and must be a function");return Yt.setTimeout(function(){r()},e)}R6.Ta="serverreachability",A2(tj,xi),R6.STAT_EVENT="statevent",A2(nj,xi),R6.Ua="timingevent",A2(rj,xi);var hm={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},ij={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function kT(){}function oj(){}kT.prototype.h=null;var RT,Gf={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function xT(){xi.call(this,"d")}function LT(){xi.call(this,"c")}function pm(){}function Bf(r,e,t,n){this.l=r,this.j=e,this.m=t,this.W=n||1,this.U=new Vf(this),this.P=aSe,this.V=new um(r=hT?125:void 0),this.I=null,this.i=!1,this.s=this.A=this.v=this.L=this.G=this.Y=this.B=null,this.F=[],this.g=null,this.C=0,this.o=this.u=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new aj}function aj(){this.i=null,this.g="",this.h=!1}A2(xT,xi),A2(LT,xi),A2(pm,kT),pm.prototype.g=function(){return new XMLHttpRequest},pm.prototype.i=function(){return{}},RT=new pm;var aSe=45e3,zT={},gm={};function DT(r,e,t){r.L=1,r.v=Cm(L3(e)),r.s=t,r.S=!0,cj(r,null)}function cj(r,e){r.G=Date.now(),Uf(r),r.A=L3(r.v);var t=r.A,n=r.W;Array.isArray(n)||(n=[String(n)]),vj(t.i,"t",n),r.C=0,t=r.l.J,r.h=new aj,r.g=Gj(r.l,t?e:null,!r.s),0<r.O&&(r.M=new nSe(ki(r.Pa,r,r.g),r.O)),Qq(r.U,r.g,"readystatechange",r.nb),e=r.I?Fq(r.I):{},r.s?(r.u||(r.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",r.g.ha(r.A,r.u,r.s,e)):(r.u="GET",r.g.ha(r.A,r.u,null,e)),Ff(),function rSe(r,e,t,n,i,s){r.info(function(){if(r.g)if(s)for(var o="",a=s.split("&"),c=0;c<a.length;c++){var l=a[c].split("=");if(1<l.length){var f=l[0];l=l[1];var d=f.split("_");o=2<=d.length&&"type"==d[1]?o+(f+"=")+l+"&":o+(f+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+n+") [attempt "+i+"]: "+e+"\n"+t+"\n"+o})}(r.j,r.u,r.A,r.m,r.W,r.s)}function lj(r){return!!r.g&&"GET"==r.u&&2!=r.L&&r.l.Ha}function uj(r,e,t){let i,n=!0;for(;!r.J&&r.C<t.length;){if(i=cSe(r,t),i==gm){4==e&&(r.o=4,ls(14),n=!1),n5(r.j,r.m,null,"[Incomplete Response]");break}if(i==zT){r.o=4,ls(15),n5(r.j,r.m,t,"[Invalid Chunk]"),n=!1;break}n5(r.j,r.m,i,null),HT(r,i)}lj(r)&&i!=gm&&i!=zT&&(r.h.g="",r.C=0),4!=e||0!=t.length||r.h.h||(r.o=1,ls(16),n=!1),r.i=r.i&&n,n?0<t.length&&!r.ba&&(r.ba=!0,(e=r.l).g==r&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+t.length),WT(e),e.M=!0,ls(11))):(n5(r.j,r.m,t,"[Invalid Chunked Response]"),z6(r),Wf(r))}function cSe(r,e){var t=r.C,n=e.indexOf("\n",t);return-1==n?gm:(t=Number(e.substring(t,n)),isNaN(t)?zT:(n+=1)+t>e.length?gm:(e=e.slice(n,n+t),r.C=n+t,e))}function Uf(r){r.Y=Date.now()+r.P,fj(r,r.P)}function fj(r,e){if(null!=r.B)throw Error("WatchDog timer not null");r.B=$f(ki(r.lb,r),e)}function mm(r){r.B&&(Yt.clearTimeout(r.B),r.B=null)}function Wf(r){0==r.l.H||r.J||Hj(r.l,r)}function z6(r){mm(r);var e=r.M;e&&"function"==typeof e.sa&&e.sa(),r.M=null,NT(r.V),Jq(r.U),r.g&&(e=r.g,r.g=null,e.abort(),e.sa())}function HT(r,e){try{var t=r.l;if(0!=t.H&&(t.g==r||VT(t.i,r)))if(!r.K&&VT(t.i,r)&&3==t.H){try{var n=t.Ja.g.parse(e)}catch{n=null}if(Array.isArray(n)&&3==n.length){var i=n;if(0==i[0]){e:if(!t.u){if(t.g){if(!(t.g.G+3e3<r.G))break e;Tm(t),Sm(t)}UT(t),ls(18)}}else t.Fa=i[1],0<t.Fa-t.V&&37500>i[2]&&t.G&&0==t.A&&!t.v&&(t.v=$f(ki(t.ib,t),6e3));if(1>=Mj(t.i)&&t.oa){try{t.oa()}catch{}t.oa=void 0}}else H6(t,11)}else if((r.K||t.g==r)&&Tm(t),!Lf(e))for(i=t.Ja.g.parse(e),e=0;e<i.length;e++){let l=i[e];if(t.V=l[0],l=l[1],2==t.H)if("c"==l[0]){t.K=l[1],t.pa=l[2];const f=l[3];null!=f&&(t.ra=f,t.l.info("VER="+t.ra));const d=l[4];null!=d&&(t.Ga=d,t.l.info("SVER="+t.Ga));const m=l[5];null!=m&&"number"==typeof m&&0<m&&(t.L=n=1.5*m,t.l.info("backChannelRequestTimeoutMs_="+n)),n=t;const E=r.g;if(E){const w=E.g?E.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(w){var s=n.i;s.g||-1==w.indexOf("spdy")&&-1==w.indexOf("quic")&&-1==w.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(FT(s,s.h),s.h=null))}if(n.F){const R=E.g?E.g.getResponseHeader("X-HTTP-Session-Id"):null;R&&(n.Da=R,H1(n.I,n.F,R))}}t.H=3,t.h&&t.h.Ba(),t.ca&&(t.S=Date.now()-r.G,t.l.info("Handshake RTT: "+t.S+"ms"));var o=r;if((n=t).wa=$j(n,n.J?n.pa:null,n.Y),o.K){Ej(n.i,o);var a=o,c=n.L;c&&a.setTimeout(c),a.B&&(mm(a),Uf(a)),n.g=o}else zj(n);0<t.j.length&&Pm(t)}else"stop"!=l[0]&&"close"!=l[0]||H6(t,7);else 3==t.H&&("stop"==l[0]||"close"==l[0]?"stop"==l[0]?H6(t,7):BT(t):"noop"!=l[0]&&t.h&&t.h.Aa(l),t.A=0)}Ff()}catch{}}function dj(r,e){if(r.forEach&&"function"==typeof r.forEach)r.forEach(e,void 0);else if(im(r)||"string"==typeof r)Array.prototype.forEach.call(r,e,void 0);else for(var t=function uSe(r){if(r.ta&&"function"==typeof r.ta)return r.ta();if(!r.Z||"function"!=typeof r.Z){if(typeof Map<"u"&&r instanceof Map)return Array.from(r.keys());if(!(typeof Set<"u"&&r instanceof Set)){if(im(r)||"string"==typeof r){var e=[];r=r.length;for(var t=0;t<r;t++)e.push(t);return e}e=[],t=0;for(const n in r)e[t++]=n;return e}}}(r),n=function lSe(r){if(r.Z&&"function"==typeof r.Z)return r.Z();if(typeof Map<"u"&&r instanceof Map||typeof Set<"u"&&r instanceof Set)return Array.from(r.values());if("string"==typeof r)return r.split("");if(im(r)){for(var e=[],t=r.length,n=0;n<t;n++)e.push(r[n]);return e}for(n in e=[],t=0,r)e[t++]=r[n];return e}(r),i=n.length,s=0;s<i;s++)e.call(void 0,n[s],t&&t[s],r)}(Je=Bf.prototype).setTimeout=function(r){this.P=r},Je.nb=function(r){r=r.target;const e=this.M;e&&3==Tc(r)?e.l():this.Pa(r)},Je.Pa=function(r){try{if(r==this.g)e:{const f=Tc(this.g);var e=this.g.Ia();if(this.g.da(),!(3>f)&&(3!=f||hT||this.g&&(this.h.h||this.g.ja()||Nj(this.g)))){this.J||4!=f||7==e||Ff(),mm(this);var t=this.g.da();this.ca=t;t:if(lj(this)){var n=Nj(this.g);r="";var i=n.length,s=4==Tc(this.g);if(!this.h.i){if(typeof TextDecoder>"u"){z6(this),Wf(this);var o="";break t}this.h.i=new Yt.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,r+=this.h.i.decode(n[e],{stream:s&&e==i-1});n.splice(0,i),this.h.g+=r,this.C=0,o=this.h.g}else o=this.g.ja();if(this.i=200==t,function iSe(r,e,t,n,i,s,o){r.info(function(){return"XMLHTTP RESP ("+n+") [ attempt "+i+"]: "+e+"\n"+t+"\n"+s+" "+o})}(this.j,this.u,this.A,this.m,this.W,f,t),this.i){if(this.aa&&!this.K){t:{if(this.g){var a,c=this.g;if((a=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Lf(a)){var l=a;break t}}l=null}if(!(t=l)){this.i=!1,this.o=3,ls(12),z6(this),Wf(this);break e}n5(this.j,this.m,t,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,HT(this,t)}this.S?(uj(this,f,o),hT&&this.i&&3==f&&(Qq(this.U,this.V,"tick",this.mb),this.V.start())):(n5(this.j,this.m,o,null),HT(this,o)),4==f&&z6(this),this.i&&!this.J&&(4==f?Hj(this.l,this):(this.i=!1,Uf(this)))}else(function wSe(r){const e={};r=(r.g&&2<=Tc(r)&&r.g.getAllResponseHeaders()||"").split("\r\n");for(let n=0;n<r.length;n++){if(Lf(r[n]))continue;var t=JEe(r[n]);const i=t[0];if("string"!=typeof(t=t[1]))continue;t=t.trim();const s=e[i]||[];e[i]=s,s.push(t)}!function qEe(r,e){for(const t in r)e.call(void 0,r[t],t,r)}(e,function(n){return n.join(", ")})})(this.g),400==t&&0<o.indexOf("Unknown SID")?(this.o=3,ls(12)):(this.o=0,ls(13)),z6(this),Wf(this)}}}catch{}},Je.mb=function(){if(this.g){var r=Tc(this.g),e=this.g.ja();this.C<e.length&&(mm(this),uj(this,r,e),this.i&&4!=r&&Uf(this))}},Je.cancel=function(){this.J=!0,z6(this)},Je.lb=function(){this.B=null;const r=Date.now();0<=r-this.Y?(function sSe(r,e){r.info(function(){return"TIMEOUT: "+e})}(this.j,this.A),2!=this.L&&(Ff(),ls(17)),z6(this),this.o=2,Wf(this)):fj(this,this.Y-r)};var hj=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function D6(r){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,r instanceof D6){this.h=r.h,_m(this,r.j),this.s=r.s,this.g=r.g,vm(this,r.m),this.l=r.l;var e=r.i,t=new Zf;t.i=e.i,e.g&&(t.g=new Map(e.g),t.h=e.h),pj(this,t),this.o=r.o}else r&&(e=String(r).match(hj))?(this.h=!1,_m(this,e[1]||"",!0),this.s=qf(e[2]||""),this.g=qf(e[3]||"",!0),vm(this,e[4]),this.l=qf(e[5]||"",!0),pj(this,e[6]||"",!0),this.o=qf(e[7]||"")):(this.h=!1,this.i=new Zf(null,this.h))}function L3(r){return new D6(r)}function _m(r,e,t){r.j=t?qf(e,!0):e,r.j&&(r.j=r.j.replace(/:$/,""))}function vm(r,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);r.m=e}else r.m=null}function pj(r,e,t){e instanceof Zf?(r.i=e,function _Se(r,e){e&&!r.j&&(Z4(r),r.i=null,r.g.forEach(function(t,n){var i=n.toLowerCase();n!=i&&(mj(this,n),vj(this,i,t))},r)),r.j=e}(r.i,r.h)):(t||(e=jf(e,gSe)),r.i=new Zf(e,r.h))}function H1(r,e,t){r.i.set(e,t)}function Cm(r){return H1(r,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),r}function qf(r,e){return r?e?decodeURI(r.replace(/%25/g,"%2525")):decodeURIComponent(r):""}function jf(r,e,t){return"string"==typeof r?(r=encodeURI(r).replace(e,dSe),t&&(r=r.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),r):null}function dSe(r){return"%"+((r=r.charCodeAt(0))>>4&15).toString(16)+(15&r).toString(16)}D6.prototype.toString=function(){var r=[],e=this.j;e&&r.push(jf(e,gj,!0),":");var t=this.g;return(t||"file"==e)&&(r.push("//"),(e=this.s)&&r.push(jf(e,gj,!0),"@"),r.push(encodeURIComponent(String(t)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(t=this.m)&&r.push(":",String(t))),(t=this.l)&&(this.g&&"/"!=t.charAt(0)&&r.push("/"),r.push(jf(t,"/"==t.charAt(0)?pSe:hSe,!0))),(t=this.i.toString())&&r.push("?",t),(t=this.o)&&r.push("#",jf(t,mSe)),r.join("")};var gj=/[#\/\?@]/g,hSe=/[#\?:]/g,pSe=/[#\?]/g,gSe=/[#\?@]/g,mSe=/#/g;function Zf(r,e){this.h=this.g=null,this.i=r||null,this.j=!!e}function Z4(r){r.g||(r.g=new Map,r.h=0,r.i&&function fSe(r,e){if(r){r=r.split("&");for(var t=0;t<r.length;t++){var n=r[t].indexOf("="),i=null;if(0<=n){var s=r[t].substring(0,n);i=r[t].substring(n+1)}else s=r[t];e(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(r.i,function(e,t){r.add(decodeURIComponent(e.replace(/\+/g," ")),t)}))}function mj(r,e){Z4(r),e=r5(r,e),r.g.has(e)&&(r.i=null,r.h-=r.g.get(e).length,r.g.delete(e))}function _j(r,e){return Z4(r),e=r5(r,e),r.g.has(e)}function vj(r,e,t){mj(r,e),0<t.length&&(r.i=null,r.g.set(r5(r,e),fT(t)),r.h+=t.length)}function r5(r,e){return e=String(e),r.j&&(e=e.toLowerCase()),e}function Cj(r){this.l=r||CSe,r=Yt.PerformanceNavigationTiming?0<(r=Yt.performance.getEntriesByType("navigation")).length&&("hq"==r[0].nextHopProtocol||"h2"==r[0].nextHopProtocol):!!(Yt.g&&Yt.g.Ka&&Yt.g.Ka()&&Yt.g.Ka().ec),this.j=r?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(Je=Zf.prototype).add=function(r,e){Z4(this),this.i=null,r=r5(this,r);var t=this.g.get(r);return t||this.g.set(r,t=[]),t.push(e),this.h+=1,this},Je.forEach=function(r,e){Z4(this),this.g.forEach(function(t,n){t.forEach(function(i){r.call(e,i,n,this)},this)},this)},Je.ta=function(){Z4(this);const r=Array.from(this.g.values()),e=Array.from(this.g.keys()),t=[];for(let n=0;n<e.length;n++){const i=r[n];for(let s=0;s<i.length;s++)t.push(e[n])}return t},Je.Z=function(r){Z4(this);let e=[];if("string"==typeof r)_j(this,r)&&(e=e.concat(this.g.get(r5(this,r))));else{r=Array.from(this.g.values());for(let t=0;t<r.length;t++)e=e.concat(r[t])}return e},Je.set=function(r,e){return Z4(this),this.i=null,_j(this,r=r5(this,r))&&(this.h-=this.g.get(r).length),this.g.set(r,[e]),this.h+=1,this},Je.get=function(r,e){return r&&0<(r=this.Z(r)).length?String(r[0]):e},Je.toString=function(){if(this.i)return this.i;if(!this.g)return"";const r=[],e=Array.from(this.g.keys());for(var t=0;t<e.length;t++){var n=e[t];const s=encodeURIComponent(String(n)),o=this.Z(n);for(n=0;n<o.length;n++){var i=s;""!==o[n]&&(i+="="+encodeURIComponent(String(o[n]))),r.push(i)}}return this.i=r.join("&")};var CSe=10;function yj(r){return!!r.h||!!r.g&&r.g.size>=r.j}function Mj(r){return r.h?1:r.g?r.g.size:0}function VT(r,e){return r.h?r.h==e:!!r.g&&r.g.has(e)}function FT(r,e){r.g?r.g.add(e):r.h=e}function Ej(r,e){r.h&&r.h==e?r.h=null:r.g&&r.g.has(e)&&r.g.delete(e)}function Sj(r){if(null!=r.h)return r.i.concat(r.h.F);if(null!=r.g&&0!==r.g.size){let e=r.i;for(const t of r.g.values())e=e.concat(t.F);return e}return fT(r.i)}Cj.prototype.cancel=function(){if(this.i=Sj(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const r of this.g.values())r.cancel();this.g.clear()}};var ySe=class{stringify(r){return Yt.JSON.stringify(r,void 0)}parse(r){return Yt.JSON.parse(r,void 0)}};function MSe(){this.g=new ySe}function ESe(r,e,t){const n=t||"";try{dj(r,function(i,s){let o=i;xf(i)&&(o=wT(i)),e.push(n+s+"="+encodeURIComponent(o))})}catch(i){throw e.push(n+"type="+encodeURIComponent("_badmap")),i}}function ym(r,e,t,n,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(n)}catch{}}function Yf(r){this.l=r.fc||null,this.j=r.ob||!1}function Mm(r,e){N2.call(this),this.F=r,this.u=e,this.m=void 0,this.readyState=$T,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}A2(Yf,kT),Yf.prototype.g=function(){return new Mm(this.l,this.j)},Yf.prototype.i=function(r){return function(){return r}}({}),A2(Mm,N2);var $T=0;function Pj(r){r.j.read().then(r.Xa.bind(r)).catch(r.ka.bind(r))}function Kf(r){r.readyState=4,r.l=null,r.j=null,r.A=null,Xf(r)}function Xf(r){r.onreadystatechange&&r.onreadystatechange.call(r)}(Je=Mm.prototype).open=function(r,e){if(this.readyState!=$T)throw this.abort(),Error("Error reopening a connection");this.C=r,this.B=e,this.readyState=1,Xf(this)},Je.send=function(r){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};r&&(e.body=r),(this.F||Yt).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))},Je.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Kf(this)),this.readyState=$T},Je.$a=function(r){if(this.g&&(this.l=r,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=r.headers,this.readyState=2,Xf(this)),this.g&&(this.readyState=3,Xf(this),this.g)))if("arraybuffer"===this.responseType)r.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof Yt.ReadableStream<"u"&&"body"in r){if(this.j=r.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;Pj(this)}else r.text().then(this.Za.bind(this),this.ka.bind(this))},Je.Xa=function(r){if(this.g){if(this.u&&r.value)this.response.push(r.value);else if(!this.u){var e=r.value?r.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!r.done}))&&(this.response=this.responseText+=e)}r.done?Kf(this):Xf(this),3==this.readyState&&Pj(this)}},Je.Za=function(r){this.g&&(this.response=this.responseText=r,Kf(this))},Je.Ya=function(r){this.g&&(this.response=r,Kf(this))},Je.ka=function(){this.g&&Kf(this)},Je.setRequestHeader=function(r,e){this.v.append(r,e)},Je.getResponseHeader=function(r){return this.h&&this.h.get(r.toLowerCase())||""},Je.getAllResponseHeaders=function(){if(!this.h)return"";const r=[],e=this.h.entries();for(var t=e.next();!t.done;)r.push((t=t.value)[0]+": "+t[1]),t=e.next();return r.join("\r\n")},Object.defineProperty(Mm.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(r){this.m=r?"include":"same-origin"}});var PSe=Yt.JSON.parse;function Er(r){N2.call(this),this.headers=new Map,this.u=r||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=Tj,this.L=this.M=!1}A2(Er,N2);var Tj="",TSe=/^https?$/i,OSe=["POST","PUT"];function Oj(r,e){r.h=!1,r.g&&(r.l=!0,r.g.abort(),r.l=!1),r.j=e,r.m=5,bj(r),Em(r)}function bj(r){r.F||(r.F=!0,ri(r,"complete"),ri(r,"error"))}function wj(r){if(r.h&&typeof lT<"u"&&(!r.C[1]||4!=Tc(r)||2!=r.da()))if(r.v&&4==Tc(r))IT(r.La,0,r);else if(ri(r,"readystatechange"),4==Tc(r)){r.h=!1;try{const o=r.da();e:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var t;if(!(t=e)){var n;if(n=0===o){var i=String(r.I).match(hj)[1]||null;!i&&Yt.self&&Yt.self.location&&(i=Yt.self.location.protocol.slice(0,-1)),n=!TSe.test(i?i.toLowerCase():"")}t=n}if(t)ri(r,"complete"),ri(r,"success");else{r.m=6;try{var s=2<Tc(r)?r.g.statusText:""}catch{s=""}r.j=s+" ["+r.da()+"]",bj(r)}}finally{Em(r)}}}function Em(r,e){if(r.g){Aj(r);const t=r.g,n=r.C[0]?()=>{}:null;r.g=null,r.C=null,e||ri(r,"ready");try{t.onreadystatechange=n}catch{}}}function Aj(r){r.g&&r.L&&(r.g.ontimeout=null),r.A&&(Yt.clearTimeout(r.A),r.A=null)}function Tc(r){return r.g?r.g.readyState:0}function Nj(r){try{if(!r.g)return null;if("response"in r.g)return r.g.response;switch(r.K){case Tj:case"text":return r.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in r.g)return r.g.mozResponseArrayBuffer}return null}catch{return null}}function Ij(r){let e="";return CT(r,function(t,n){e+=n,e+=":",e+=t,e+="\r\n"}),e}function GT(r,e,t){e:{for(n in t){var n=!1;break e}n=!0}n||(t=Ij(t),"string"==typeof r?null!=t&&encodeURIComponent(String(t)):H1(r,e,t))}function Qf(r,e,t){return t&&t.internalChannelParams&&t.internalChannelParams[r]||e}function kj(r){this.Ga=0,this.j=[],this.l=new fm,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=Qf("failFast",!1,r),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=Qf("baseRetryDelayMs",5e3,r),this.hb=Qf("retryDelaySeedMs",1e4,r),this.eb=Qf("forwardChannelMaxRetries",2,r),this.xa=Qf("forwardChannelRequestTimeoutMs",2e4,r),this.va=r&&r.xmlHttpFactory||void 0,this.Ha=r&&r.dc||!1,this.L=void 0,this.J=r&&r.supportsCrossDomainXhr||!1,this.K="",this.i=new Cj(r&&r.concurrentRequestLimit),this.Ja=new MSe,this.P=r&&r.fastHandshake||!1,this.O=r&&r.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=r&&r.bc||!1,r&&r.Ea&&this.l.Ea(),r&&r.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&r&&r.detectBufferingProxy||!1,this.qa=void 0,r&&r.longPollingTimeout&&0<r.longPollingTimeout&&(this.qa=r.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}function BT(r){if(xj(r),3==r.H){var e=r.W++,t=L3(r.I);if(H1(t,"SID",r.K),H1(t,"RID",e),H1(t,"TYPE","terminate"),Jf(r,t),(e=new Bf(r,r.l,e)).L=2,e.v=Cm(L3(t)),t=!1,Yt.navigator&&Yt.navigator.sendBeacon)try{t=Yt.navigator.sendBeacon(e.v.toString(),"")}catch{}!t&&Yt.Image&&((new Image).src=e.v,t=!0),t||(e.g=Gj(e.l,null),e.g.ha(e.v)),e.G=Date.now(),Uf(e)}Fj(r)}function Sm(r){r.g&&(WT(r),r.g.cancel(),r.g=null)}function xj(r){Sm(r),r.u&&(Yt.clearTimeout(r.u),r.u=null),Tm(r),r.i.cancel(),r.m&&("number"==typeof r.m&&Yt.clearTimeout(r.m),r.m=null)}function Pm(r){if(!yj(r.i)&&!r.m){r.m=!0;var e=r.Na;Df||Yq(),Hf||(Df(),Hf=!0),AT.add(e,r),r.C=0}}function Lj(r,e){var t;t=e?e.m:r.W++;const n=L3(r.I);H1(n,"SID",r.K),H1(n,"RID",t),H1(n,"AID",r.V),Jf(r,n),r.o&&r.s&&GT(n,r.o,r.s),t=new Bf(r,r.l,t,r.C+1),null===r.o&&(t.I=r.s),e&&(r.j=e.F.concat(r.j)),e=Rj(r,t,1e3),t.setTimeout(Math.round(.5*r.xa)+Math.round(.5*r.xa*Math.random())),FT(r.i,t),DT(t,n,e)}function Jf(r,e){r.na&&CT(r.na,function(t,n){H1(e,n,t)}),r.h&&dj({},function(t,n){H1(e,n,t)})}function Rj(r,e,t){t=Math.min(r.j.length,t);var n=r.h?ki(r.h.Va,r.h,r):null;e:{var i=r.j;let s=-1;for(;;){const o=["count="+t];-1==s?0<t?(s=i[0].g,o.push("ofs="+s)):s=0:o.push("ofs="+s);let a=!0;for(let c=0;c<t;c++){let l=i[c].g;const f=i[c].map;if(l-=s,0>l)s=Math.max(0,i[c].g-100),a=!1;else try{ESe(f,o,"req"+l+"_")}catch{n&&n(f)}}if(a){n=o.join("&");break e}}}return r=r.j.splice(0,t),e.F=r,n}function zj(r){if(!r.g&&!r.u){r.ba=1;var e=r.Ma;Df||Yq(),Hf||(Df(),Hf=!0),AT.add(e,r),r.A=0}}function UT(r){return!(r.g||r.u||3<=r.A||(r.ba++,r.u=$f(ki(r.Ma,r),Vj(r,r.A)),r.A++,0))}function WT(r){null!=r.B&&(Yt.clearTimeout(r.B),r.B=null)}function Dj(r){r.g=new Bf(r,r.l,"rpc",r.ba),null===r.o&&(r.g.I=r.s),r.g.O=0;var e=L3(r.wa);H1(e,"RID","rpc"),H1(e,"SID",r.K),H1(e,"AID",r.V),H1(e,"CI",r.G?"0":"1"),!r.G&&r.qa&&H1(e,"TO",r.qa),H1(e,"TYPE","xmlhttp"),Jf(r,e),r.o&&r.s&&GT(e,r.o,r.s),r.L&&r.g.setTimeout(r.L);var t=r.g;r=r.pa,t.L=1,t.v=Cm(L3(e)),t.s=null,t.S=!0,cj(t,r)}function Tm(r){null!=r.v&&(Yt.clearTimeout(r.v),r.v=null)}function Hj(r,e){var t=null;if(r.g==e){Tm(r),WT(r),r.g=null;var n=2}else{if(!VT(r.i,e))return;t=e.F,Ej(r.i,e),n=1}if(0!=r.H)if(e.i)if(1==n){t=e.s?e.s.length:0,e=Date.now()-e.G;var i=r.C;ri(n=dm(),new rj(n,t)),Pm(r)}else zj(r);else if(3==(i=e.o)||0==i&&0<e.ca||!(1==n&&function ASe(r,e){return!(Mj(r.i)>=r.i.j-(r.m?1:0)||(r.m?(r.j=e.F.concat(r.j),0):1==r.H||2==r.H||r.C>=(r.cb?0:r.eb)||(r.m=$f(ki(r.Na,r,e),Vj(r,r.C)),r.C++,0)))}(r,e)||2==n&&UT(r)))switch(t&&0<t.length&&(e=r.i,e.i=e.i.concat(t)),i){case 1:H6(r,5);break;case 4:H6(r,10);break;case 3:H6(r,6);break;default:H6(r,2)}}function Vj(r,e){let t=r.ab+Math.floor(Math.random()*r.hb);return r.isActive()||(t*=2),t*e}function H6(r,e){if(r.l.info("Error code "+e),2==e){var t=null;r.h&&(t=null);var n=ki(r.pb,r);t||(t=new D6("//www.google.com/images/cleardot.gif"),Yt.location&&"http"==Yt.location.protocol||_m(t,"https"),Cm(t)),function SSe(r,e){const t=new fm;if(Yt.Image){const n=new Image;n.onload=sm(ym,t,n,"TestLoadImage: loaded",!0,e),n.onerror=sm(ym,t,n,"TestLoadImage: error",!1,e),n.onabort=sm(ym,t,n,"TestLoadImage: abort",!1,e),n.ontimeout=sm(ym,t,n,"TestLoadImage: timeout",!1,e),Yt.setTimeout(function(){n.ontimeout&&n.ontimeout()},1e4),n.src=r}else e(!1)}(t.toString(),n)}else ls(2);r.H=0,r.h&&r.h.za(e),Fj(r),xj(r)}function Fj(r){if(r.H=0,r.ma=[],r.h){const e=Sj(r.i);(0!=e.length||0!=r.j.length)&&(Rq(r.ma,e),Rq(r.ma,r.j),r.i.i.length=0,fT(r.j),r.j.length=0),r.h.ya()}}function $j(r,e,t){var n=t instanceof D6?L3(t):new D6(t);if(""!=n.g)e&&(n.g=e+"."+n.g),vm(n,n.m);else{var i=Yt.location;n=i.protocol,e=e?e+"."+i.hostname:i.hostname,i=+i.port;var s=new D6(null);n&&_m(s,n),e&&(s.g=e),i&&vm(s,i),t&&(s.l=t),n=s}return e=r.Da,(t=r.F)&&e&&H1(n,t,e),H1(n,"VER",r.ra),Jf(r,n),n}function Gj(r,e,t){if(e&&!r.J)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Er(t&&r.Ha&&!r.va?new Yf({ob:!0}):r.va)).Oa(r.J),e}function Bj(){}function Om(){if(t5&&!(10<=Number(GEe)))throw Error("Environmental error: no available transport.")}function co(r,e){N2.call(this),this.g=new kj(e),this.l=r,this.h=e&&e.messageUrlParams||null,r=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(r?r["X-Client-Protocol"]="webchannel":r={"X-Client-Protocol":"webchannel"}),this.g.s=r,r=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(r?r["X-WebChannel-Content-Type"]=e.messageContentType:r={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(r?r["X-WebChannel-Client-Profile"]=e.Ca:r={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=r,(r=e&&e.cc)&&!Lf(r)&&(this.g.o=r),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Lf(e)&&(this.g.F=e,null!==(r=this.h)&&e in r&&e in(r=this.h)&&delete r[e]),this.j=new i5(this)}function Uj(r){xT.call(this),r.__headers__&&(this.headers=r.__headers__,this.statusCode=r.__status__,delete r.__headers__,delete r.__status__);var e=r.__sm__;if(e){e:{for(const t in e){r=t;break e}r=void 0}(this.i=r)&&(r=this.i,e=null!==e&&r in e?e[r]:void 0),this.data=e}else this.data=r}function Wj(){LT.call(this),this.status=1}function i5(r){this.g=r}function Pa(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}function qT(r,e,t){t||(t=0);var n=Array(16);if("string"==typeof e)for(var i=0;16>i;++i)n[i]=e.charCodeAt(t++)|e.charCodeAt(t++)<<8|e.charCodeAt(t++)<<16|e.charCodeAt(t++)<<24;else for(i=0;16>i;++i)n[i]=e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24;var s=r.g[3],o=(e=r.g[0])+(s^(t=r.g[1])&((i=r.g[2])^s))+n[0]+3614090360&4294967295;o=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=t+(o<<7&4294967295|o>>>25))+((o=s+(i^e&(t^i))+n[1]+3905402710&4294967295)<<12&4294967295|o>>>20))+((o=i+(t^s&(e^t))+n[2]+606105819&4294967295)<<17&4294967295|o>>>15))+((o=t+(e^i&(s^e))+n[3]+3250441966&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^t&(i^s))+n[4]+4118548399&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^e&(t^i))+n[5]+1200080426&4294967295)<<12&4294967295|o>>>20))+((o=i+(t^s&(e^t))+n[6]+2821735955&4294967295)<<17&4294967295|o>>>15))+((o=t+(e^i&(s^e))+n[7]+4249261313&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^t&(i^s))+n[8]+1770035416&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^e&(t^i))+n[9]+2336552879&4294967295)<<12&4294967295|o>>>20))+((o=i+(t^s&(e^t))+n[10]+4294925233&4294967295)<<17&4294967295|o>>>15))+((o=t+(e^i&(s^e))+n[11]+2304563134&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^t&(i^s))+n[12]+1804603682&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^e&(t^i))+n[13]+4254626195&4294967295)<<12&4294967295|o>>>20))+((o=i+(t^s&(e^t))+n[14]+2792965006&4294967295)<<17&4294967295|o>>>15))+((o=t+(e^i&(s^e))+n[15]+1236535329&4294967295)<<22&4294967295|o>>>10))+((o=e+(i^s&(t^i))+n[1]+4129170786&4294967295)<<5&4294967295|o>>>27))+((o=s+(t^i&(e^t))+n[6]+3225465664&4294967295)<<9&4294967295|o>>>23))+((o=i+(e^t&(s^e))+n[11]+643717713&4294967295)<<14&4294967295|o>>>18))+((o=t+(s^e&(i^s))+n[0]+3921069994&4294967295)<<20&4294967295|o>>>12))+((o=e+(i^s&(t^i))+n[5]+3593408605&4294967295)<<5&4294967295|o>>>27))+((o=s+(t^i&(e^t))+n[10]+38016083&4294967295)<<9&4294967295|o>>>23))+((o=i+(e^t&(s^e))+n[15]+3634488961&4294967295)<<14&4294967295|o>>>18))+((o=t+(s^e&(i^s))+n[4]+3889429448&4294967295)<<20&4294967295|o>>>12))+((o=e+(i^s&(t^i))+n[9]+568446438&4294967295)<<5&4294967295|o>>>27))+((o=s+(t^i&(e^t))+n[14]+3275163606&4294967295)<<9&4294967295|o>>>23))+((o=i+(e^t&(s^e))+n[3]+4107603335&4294967295)<<14&4294967295|o>>>18))+((o=t+(s^e&(i^s))+n[8]+1163531501&4294967295)<<20&4294967295|o>>>12))+((o=e+(i^s&(t^i))+n[13]+2850285829&4294967295)<<5&4294967295|o>>>27))+((o=s+(t^i&(e^t))+n[2]+4243563512&4294967295)<<9&4294967295|o>>>23))+((o=i+(e^t&(s^e))+n[7]+1735328473&4294967295)<<14&4294967295|o>>>18))+((o=t+(s^e&(i^s))+n[12]+2368359562&4294967295)<<20&4294967295|o>>>12))+((o=e+(t^i^s)+n[5]+4294588738&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^t^i)+n[8]+2272392833&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^e^t)+n[11]+1839030562&4294967295)<<16&4294967295|o>>>16))+((o=t+(i^s^e)+n[14]+4259657740&4294967295)<<23&4294967295|o>>>9))+((o=e+(t^i^s)+n[1]+2763975236&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^t^i)+n[4]+1272893353&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^e^t)+n[7]+4139469664&4294967295)<<16&4294967295|o>>>16))+((o=t+(i^s^e)+n[10]+3200236656&4294967295)<<23&4294967295|o>>>9))+((o=e+(t^i^s)+n[13]+681279174&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^t^i)+n[0]+3936430074&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^e^t)+n[3]+3572445317&4294967295)<<16&4294967295|o>>>16))+((o=t+(i^s^e)+n[6]+76029189&4294967295)<<23&4294967295|o>>>9))+((o=e+(t^i^s)+n[9]+3654602809&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^t^i)+n[12]+3873151461&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^e^t)+n[15]+530742520&4294967295)<<16&4294967295|o>>>16))+((o=t+(i^s^e)+n[2]+3299628645&4294967295)<<23&4294967295|o>>>9))+((o=e+(i^(t|~s))+n[0]+4096336452&4294967295)<<6&4294967295|o>>>26))+((o=s+(t^(e|~i))+n[7]+1126891415&4294967295)<<10&4294967295|o>>>22))+((o=i+(e^(s|~t))+n[14]+2878612391&4294967295)<<15&4294967295|o>>>17))+((o=t+(s^(i|~e))+n[5]+4237533241&4294967295)<<21&4294967295|o>>>11))+((o=e+(i^(t|~s))+n[12]+1700485571&4294967295)<<6&4294967295|o>>>26))+((o=s+(t^(e|~i))+n[3]+2399980690&4294967295)<<10&4294967295|o>>>22))+((o=i+(e^(s|~t))+n[10]+4293915773&4294967295)<<15&4294967295|o>>>17))+((o=t+(s^(i|~e))+n[1]+2240044497&4294967295)<<21&4294967295|o>>>11))+((o=e+(i^(t|~s))+n[8]+1873313359&4294967295)<<6&4294967295|o>>>26))+((o=s+(t^(e|~i))+n[15]+4264355552&4294967295)<<10&4294967295|o>>>22))+((o=i+(e^(s|~t))+n[6]+2734768916&4294967295)<<15&4294967295|o>>>17))+((o=t+(s^(i|~e))+n[13]+1309151649&4294967295)<<21&4294967295|o>>>11))+((s=(e=t+((o=e+(i^(t|~s))+n[4]+4149444226&4294967295)<<6&4294967295|o>>>26))+((o=s+(t^(e|~i))+n[11]+3174756917&4294967295)<<10&4294967295|o>>>22))^((i=s+((o=i+(e^(s|~t))+n[2]+718787259&4294967295)<<15&4294967295|o>>>17))|~e))+n[9]+3951481745&4294967295,r.g[0]=r.g[0]+e&4294967295,r.g[1]=r.g[1]+(i+(o<<21&4294967295|o>>>11))&4294967295,r.g[2]=r.g[2]+i&4294967295,r.g[3]=r.g[3]+s&4294967295}function u1(r,e){this.h=e;for(var t=[],n=!0,i=r.length-1;0<=i;i--){var s=0|r[i];n&&s==e||(t[i]=s,n=!1)}this.g=t}(Je=Er.prototype).Oa=function(r){this.M=r},Je.ha=function(r,e,t,n){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+r);e=e?e.toUpperCase():"GET",this.I=r,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():RT.g(),this.C=function sj(r){return r.h||(r.h=r.i())}(this.u?this.u:RT),this.g.onreadystatechange=ki(this.La,this);try{this.G=!0,this.g.open(e,String(r),!0),this.G=!1}catch(s){return void Oj(this,s)}if(r=t||"",t=new Map(this.headers),n)if(Object.getPrototypeOf(n)===Object.prototype)for(var i in n)t.set(i,n[i]);else{if("function"!=typeof n.keys||"function"!=typeof n.get)throw Error("Unknown input type for opt_headers: "+String(n));for(const s of n.keys())t.set(s,n.get(s))}n=Array.from(t.keys()).find(s=>"content-type"==s.toLowerCase()),i=Yt.FormData&&r instanceof Yt.FormData,!(0<=Lq(OSe,e))||n||i||t.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[s,o]of t)this.g.setRequestHeader(s,o);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{Aj(this),0<this.B&&((this.L=function bSe(r){return t5&&"number"==typeof r.timeout&&void 0!==r.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=ki(this.ua,this)):this.A=IT(this.ua,this.B,this)),this.v=!0,this.g.send(r),this.v=!1}catch(s){Oj(this,s)}},Je.ua=function(){typeof lT<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,ri(this,"timeout"),this.abort(8))},Je.abort=function(r){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=r||7,ri(this,"complete"),ri(this,"abort"),Em(this))},Je.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Em(this,!0)),Er.$.N.call(this)},Je.La=function(){this.s||(this.G||this.v||this.l?wj(this):this.kb())},Je.kb=function(){wj(this)},Je.isActive=function(){return!!this.g},Je.da=function(){try{return 2<Tc(this)?this.g.status:-1}catch{return-1}},Je.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}},Je.Wa=function(r){if(this.g){var e=this.g.responseText;return r&&0==e.indexOf(r)&&(e=e.substring(r.length)),PSe(e)}},Je.Ia=function(){return this.m},Je.Sa=function(){return"string"==typeof this.j?this.j:String(this.j)},(Je=kj.prototype).ra=8,Je.H=1,Je.Na=function(r){if(this.m)if(this.m=null,1==this.H){if(!r){this.W=Math.floor(1e5*Math.random()),r=this.W++;const i=new Bf(this,this.l,r);let s=this.s;if(this.U&&(s?(s=Fq(s),Gq(s,this.U)):s=this.U),null!==this.o||this.O||(i.I=s,s=null),this.P)e:{for(var e=0,t=0;t<this.j.length;t++){var n=this.j[t];if(void 0===(n="__data__"in n.map&&"string"==typeof(n=n.map.__data__)?n.length:void 0))break;if(4096<(e+=n)){e=t;break e}if(4096===e||t===this.j.length-1){e=t+1;break e}}e=1e3}else e=1e3;e=Rj(this,i,e),H1(t=L3(this.I),"RID",r),H1(t,"CVER",22),this.F&&H1(t,"X-HTTP-Session-Id",this.F),Jf(this,t),s&&(this.O?e="headers="+encodeURIComponent(String(Ij(s)))+"&"+e:this.o&&GT(t,this.o,s)),FT(this.i,i),this.bb&&H1(t,"TYPE","init"),this.P?(H1(t,"$req",e),H1(t,"SID","null"),i.aa=!0,DT(i,t,null)):DT(i,t,e),this.H=2}}else 3==this.H&&(r?Lj(this,r):0==this.j.length||yj(this.i)||Lj(this))},Je.Ma=function(){if(this.u=null,Dj(this),this.ca&&!(this.M||null==this.g||0>=this.S)){var r=2*this.S;this.l.info("BP detection timer enabled: "+r),this.B=$f(ki(this.jb,this),r)}},Je.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,ls(10),Sm(this),Dj(this))},Je.ib=function(){null!=this.v&&(this.v=null,Sm(this),UT(this),ls(19))},Je.pb=function(r){r?(this.l.info("Successfully pinged google.com"),ls(2)):(this.l.info("Failed to ping google.com"),ls(1))},Je.isActive=function(){return!!this.h&&this.h.isActive(this)},(Je=Bj.prototype).Ba=function(){},Je.Aa=function(){},Je.za=function(){},Je.ya=function(){},Je.isActive=function(){return!0},Je.Va=function(){},Om.prototype.g=function(r,e){return new co(r,e)},A2(co,N2),co.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var r=this.g,e=this.l,t=this.h||void 0;ls(0),r.Y=e,r.na=t||{},r.G=r.aa,r.I=$j(r,null,r.Y),Pm(r)},co.prototype.close=function(){BT(this.g)},co.prototype.u=function(r){var e=this.g;if("string"==typeof r){var t={};t.__data__=r,r=t}else this.v&&((t={}).__data__=wT(r),r=t);e.j.push(new class{constructor(r,e){this.g=r,this.map=e}}(e.fb++,r)),3==e.H&&Pm(e)},co.prototype.N=function(){this.g.h=null,delete this.j,BT(this.g),delete this.g,co.$.N.call(this)},A2(Uj,xT),A2(Wj,LT),A2(i5,Bj),i5.prototype.Ba=function(){ri(this.g,"a")},i5.prototype.Aa=function(r){ri(this.g,new Uj(r))},i5.prototype.za=function(r){ri(this.g,new Wj)},i5.prototype.ya=function(){ri(this.g,"b")},A2(Pa,function NSe(){this.blockSize=-1}),Pa.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0},Pa.prototype.j=function(r,e){void 0===e&&(e=r.length);for(var t=e-this.blockSize,n=this.m,i=this.h,s=0;s<e;){if(0==i)for(;s<=t;)qT(this,r,s),s+=this.blockSize;if("string"==typeof r){for(;s<e;)if(n[i++]=r.charCodeAt(s++),i==this.blockSize){qT(this,n),i=0;break}}else for(;s<e;)if(n[i++]=r[s++],i==this.blockSize){qT(this,n),i=0;break}}this.h=i,this.i+=e},Pa.prototype.l=function(){var r=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);r[0]=128;for(var e=1;e<r.length-8;++e)r[e]=0;var t=8*this.i;for(e=r.length-8;e<r.length;++e)r[e]=255&t,t/=256;for(this.j(r),r=Array(16),e=t=0;4>e;++e)for(var n=0;32>n;n+=8)r[t++]=this.g[e]>>>n&255;return r};var ISe={};function jT(r){return-128<=r&&128>r?function VEe(r,e){var t=ISe;return Object.prototype.hasOwnProperty.call(t,r)?t[r]:t[r]=e(r)}(r,function(e){return new u1([0|e],0>e?-1:0)}):new u1([0|r],0>r?-1:0)}function Oc(r){if(isNaN(r)||!isFinite(r))return s5;if(0>r)return ii(Oc(-r));for(var e=[],t=1,n=0;r>=t;n++)e[n]=r/t|0,t*=ZT;return new u1(e,0)}var ZT=4294967296,s5=jT(0),YT=jT(1),jj=jT(16777216);function R3(r){if(0!=r.h)return!1;for(var e=0;e<r.g.length;e++)if(0!=r.g[e])return!1;return!0}function Ro(r){return-1==r.h}function ii(r){for(var e=r.g.length,t=[],n=0;n<e;n++)t[n]=~r.g[n];return new u1(t,~r.h).add(YT)}function bm(r,e){return r.add(ii(e))}function wm(r,e){for(;(65535&r[e])!=r[e];)r[e+1]+=r[e]>>>16,r[e]&=65535,e++}function e9(r,e){this.g=r,this.h=e}function Am(r,e){if(R3(e))throw Error("division by zero");if(R3(r))return new e9(s5,s5);if(Ro(r))return e=Am(ii(r),e),new e9(ii(e.g),ii(e.h));if(Ro(e))return e=Am(r,ii(e)),new e9(ii(e.g),e.h);if(30<r.g.length){if(Ro(r)||Ro(e))throw Error("slowDivide_ only works with positive integers.");for(var t=YT,n=e;0>=n.X(r);)t=Zj(t),n=Zj(n);var i=o5(t,1),s=o5(n,1);for(n=o5(n,2),t=o5(t,2);!R3(n);){var o=s.add(n);0>=o.X(r)&&(i=i.add(t),s=o),n=o5(n,1),t=o5(t,1)}return e=bm(r,i.R(e)),new e9(i,e)}for(i=s5;0<=r.X(e);){for(t=Math.max(1,Math.floor(r.ea()/e.ea())),n=48>=(n=Math.ceil(Math.log(t)/Math.LN2))?1:Math.pow(2,n-48),o=(s=Oc(t)).R(e);Ro(o)||0<o.X(r);)o=(s=Oc(t-=n)).R(e);R3(s)&&(s=YT),i=i.add(s),r=bm(r,o)}return new e9(i,r)}function Zj(r){for(var e=r.g.length+1,t=[],n=0;n<e;n++)t[n]=r.D(n)<<1|r.D(n-1)>>>31;return new u1(t,r.h)}function o5(r,e){var t=e>>5;e%=32;for(var n=r.g.length-t,i=[],s=0;s<n;s++)i[s]=0<e?r.D(s+t)>>>e|r.D(s+t+1)<<32-e:r.D(s+t);return new u1(i,r.h)}(Je=u1.prototype).ea=function(){if(Ro(this))return-ii(this).ea();for(var r=0,e=1,t=0;t<this.g.length;t++){var n=this.D(t);r+=(0<=n?n:ZT+n)*e,e*=ZT}return r},Je.toString=function(r){if(2>(r=r||10)||36<r)throw Error("radix out of range: "+r);if(R3(this))return"0";if(Ro(this))return"-"+ii(this).toString(r);for(var e=Oc(Math.pow(r,6)),t=this,n="";;){var i=Am(t,e).g,s=((0<(t=bm(t,i.R(e))).g.length?t.g[0]:t.h)>>>0).toString(r);if(R3(t=i))return s+n;for(;6>s.length;)s="0"+s;n=s+n}},Je.D=function(r){return 0>r?0:r<this.g.length?this.g[r]:this.h},Je.X=function(r){return Ro(r=bm(this,r))?-1:R3(r)?0:1},Je.abs=function(){return Ro(this)?ii(this):this},Je.add=function(r){for(var e=Math.max(this.g.length,r.g.length),t=[],n=0,i=0;i<=e;i++){var s=n+(65535&this.D(i))+(65535&r.D(i)),o=(s>>>16)+(this.D(i)>>>16)+(r.D(i)>>>16);n=o>>>16,t[i]=(o&=65535)<<16|(s&=65535)}return new u1(t,-2147483648&t[t.length-1]?-1:0)},Je.R=function(r){if(R3(this)||R3(r))return s5;if(Ro(this))return Ro(r)?ii(this).R(ii(r)):ii(ii(this).R(r));if(Ro(r))return ii(this.R(ii(r)));if(0>this.X(jj)&&0>r.X(jj))return Oc(this.ea()*r.ea());for(var e=this.g.length+r.g.length,t=[],n=0;n<2*e;n++)t[n]=0;for(n=0;n<this.g.length;n++)for(var i=0;i<r.g.length;i++){var s=this.D(n)>>>16,o=65535&this.D(n),a=r.D(i)>>>16,c=65535&r.D(i);t[2*n+2*i]+=o*c,wm(t,2*n+2*i),t[2*n+2*i+1]+=s*c,wm(t,2*n+2*i+1),t[2*n+2*i+1]+=o*a,wm(t,2*n+2*i+1),t[2*n+2*i+2]+=s*a,wm(t,2*n+2*i+2)}for(n=0;n<e;n++)t[n]=t[2*n+1]<<16|t[2*n];for(n=e;n<2*e;n++)t[n]=0;return new u1(t,0)},Je.gb=function(r){return Am(this,r).h},Je.and=function(r){for(var e=Math.max(this.g.length,r.g.length),t=[],n=0;n<e;n++)t[n]=this.D(n)&r.D(n);return new u1(t,this.h&r.h)},Je.or=function(r){for(var e=Math.max(this.g.length,r.g.length),t=[],n=0;n<e;n++)t[n]=this.D(n)|r.D(n);return new u1(t,this.h|r.h)},Je.xor=function(r){for(var e=Math.max(this.g.length,r.g.length),t=[],n=0;n<e;n++)t[n]=this.D(n)^r.D(n);return new u1(t,this.h^r.h)},Om.prototype.createWebChannel=Om.prototype.g,co.prototype.send=co.prototype.u,co.prototype.open=co.prototype.m,co.prototype.close=co.prototype.close,hm.NO_ERROR=0,hm.TIMEOUT=8,hm.HTTP_ERROR=6,ij.COMPLETE="complete",oj.EventType=Gf,Gf.OPEN="a",Gf.CLOSE="b",Gf.ERROR="c",Gf.MESSAGE="d",N2.prototype.listen=N2.prototype.O,Er.prototype.listenOnce=Er.prototype.P,Er.prototype.getLastError=Er.prototype.Sa,Er.prototype.getLastErrorCode=Er.prototype.Ia,Er.prototype.getStatus=Er.prototype.da,Er.prototype.getResponseJson=Er.prototype.Wa,Er.prototype.getResponseText=Er.prototype.ja,Er.prototype.send=Er.prototype.ha,Er.prototype.setWithCredentials=Er.prototype.Oa,Pa.prototype.digest=Pa.prototype.l,Pa.prototype.reset=Pa.prototype.reset,Pa.prototype.update=Pa.prototype.j,u1.prototype.add=u1.prototype.add,u1.prototype.multiply=u1.prototype.R,u1.prototype.modulo=u1.prototype.gb,u1.prototype.compare=u1.prototype.X,u1.prototype.toNumber=u1.prototype.ea,u1.prototype.toString=u1.prototype.toString,u1.prototype.getBits=u1.prototype.D,u1.fromNumber=Oc,u1.fromString=function qj(r,e){if(0==r.length)throw Error("number format error: empty string");if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if("-"==r.charAt(0))return ii(qj(r.substring(1),e));if(0<=r.indexOf("-"))throw Error('number format error: interior "-" character');for(var t=Oc(Math.pow(e,8)),n=s5,i=0;i<r.length;i+=8){var s=Math.min(8,r.length-i),o=parseInt(r.substring(i,i+s),e);8>s?(s=Oc(Math.pow(e,s)),n=n.R(s).add(Oc(o))):n=(n=n.R(t)).add(Oc(o))}return n};var kSe=Sa.createWebChannelTransport=function(){return new Om},xSe=Sa.getStatEventTarget=function(){return dm()},KT=Sa.ErrorCode=hm,LSe=Sa.EventType=ij,RSe=Sa.Event=R6,Yj=Sa.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},zSe=Sa.FetchXmlHttpFactory=Yf,Nm=Sa.WebChannel=oj,DSe=Sa.XhrIo=Er,HSe=Sa.Md5=Pa,a5=Sa.Integer=u1;const Kj="@firebase/firestore";class I2{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}I2.UNAUTHENTICATED=new I2(null),I2.GOOGLE_CREDENTIALS=new I2("google-credentials-uid"),I2.FIRST_PARTY=new I2("first-party-uid"),I2.MOCK_USER=new I2("mock-user");let c5="9.23.0";const Y4=new J8("@firebase/firestore");function XT(){return Y4.logLevel}function Oe(r,...e){if(Y4.logLevel<=Bn.DEBUG){const t=e.map(QT);Y4.debug(`Firestore (${c5}): ${r}`,...t)}}function Vr(r,...e){if(Y4.logLevel<=Bn.ERROR){const t=e.map(QT);Y4.error(`Firestore (${c5}): ${r}`,...t)}}function Ta(r,...e){if(Y4.logLevel<=Bn.WARN){const t=e.map(QT);Y4.warn(`Firestore (${c5}): ${r}`,...t)}}function QT(r){if("string"==typeof r)return r;try{return JSON.stringify(r)}catch{return r}}function at(r="Unexpected state"){const e=`FIRESTORE (${c5}) INTERNAL ASSERTION FAILED: `+r;throw Vr(e),new Error(e)}function mt(r,e){r||at()}function je(r,e){return r}const fe={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Te extends Lo{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class u2{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class Xj{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class VSe{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(I2.UNAUTHENTICATED))}shutdown(){}}class FSe{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class $Se{constructor(e){this.t=e,this.currentUser=I2.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){var n=this;let i=this.i;const s=l=>this.i!==i?(i=this.i,t(l)):Promise.resolve();let o=new u2;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new u2,e.enqueueRetryable(()=>s(this.currentUser))};const a=()=>{const l=o;e.enqueueRetryable(M(function*(){yield l.promise,yield s(n.currentUser)}))},c=l=>{Oe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.auth.addAuthTokenListener(this.o),a()};this.t.onInit(l=>c(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?c(l):(Oe("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new u2)}},0),a()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(n=>this.i!==e?(Oe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(mt("string"==typeof n.accessToken),new Xj(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return mt(null===e||"string"==typeof e),new I2(e)}}class GSe{constructor(e,t,n){this.h=e,this.l=t,this.m=n,this.type="FirstParty",this.user=I2.FIRST_PARTY,this.g=new Map}p(){return this.m?this.m():null}get headers(){this.g.set("X-Goog-AuthUser",this.h);const e=this.p();return e&&this.g.set("Authorization",e),this.l&&this.g.set("X-Goog-Iam-Authorization-Token",this.l),this.g}}class BSe{constructor(e,t,n){this.h=e,this.l=t,this.m=n}getToken(){return Promise.resolve(new GSe(this.h,this.l,this.m))}start(e,t){e.enqueueRetryable(()=>t(I2.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Qj{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class USe{constructor(e){this.I=e,this.forceRefresh=!1,this.appCheck=null,this.T=null}start(e,t){const n=s=>{null!=s.error&&Oe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.T;return this.T=s.token,Oe("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>n(s))};const i=s=>{Oe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.I.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.I.getImmediate({optional:!0});s?i(s):Oe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(mt("string"==typeof t.token),this.T=t.token,new Qj(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function WSe(r){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(r);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(t);else for(let n=0;n<r;n++)t[n]=Math.floor(256*Math.random());return t}class Jj{static A(){const t=62*Math.floor(256/62);let n="";for(;n.length<20;){const i=WSe(40);for(let s=0;s<i.length;++s)n.length<20&&i[s]<t&&(n+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(i[s]%62))}return n}}function qt(r,e){return r<e?-1:r>e?1:0}function l5(r,e,t){return r.length===e.length&&r.every((n,i)=>t(n,e[i]))}class ar{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Te(fe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Te(fe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new Te(fe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Te(fe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return ar.fromMillis(Date.now())}static fromDate(e){return ar.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*t));return new ar(t,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?qt(this.nanoseconds,e.nanoseconds):qt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class Ct{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Ct(e)}static min(){return new Ct(new ar(0,0))}static max(){return new Ct(new ar(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class t9{constructor(e,t,n){void 0===t?t=0:t>e.length&&at(),void 0===n?n=e.length-t:n>e.length-t&&at(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===t9.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof t9?e.forEach(n=>{t.push(n)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return this.construct(this.segments,this.offset+(e=void 0===e?1:e),this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let i=0;i<n;i++){const s=e.get(i),o=t.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class Dn extends t9{construct(e,t,n){return new Dn(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new Te(fe.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter(i=>i.length>0))}return new Dn(t)}static emptyPath(){return new Dn([])}}const qSe=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Fr extends t9{construct(e,t,n){return new Fr(e,t,n)}static isValidIdentifier(e){return qSe.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Fr.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new Fr(["__name__"])}static fromServerFormat(e){const t=[];let n="",i=0;const s=()=>{if(0===n.length)throw new Te(fe.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let o=!1;for(;i<e.length;){const a=e[i];if("\\"===a){if(i+1===e.length)throw new Te(fe.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[i+1];if("\\"!==c&&"."!==c&&"`"!==c)throw new Te(fe.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=c,i+=2}else"`"===a?(o=!o,i++):"."!==a||o?(n+=a,i++):(s(),i++)}if(s(),o)throw new Te(fe.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Fr(t)}static emptyPath(){return new Fr([])}}class Be{constructor(e){this.path=e}static fromPath(e){return new Be(Dn.fromString(e))}static fromName(e){return new Be(Dn.fromString(e).popFirst(5))}static empty(){return new Be(Dn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===Dn.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return Dn.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Be(new Dn(e.slice()))}}function nZ(r){return new lo(r.readTime,r.key,-1)}class lo{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new lo(Ct.min(),Be.empty(),-1)}static max(){return new lo(Ct.max(),Be.empty(),-1)}}function eO(r,e){let t=r.readTime.compareTo(e.readTime);return 0!==t?t:(t=Be.comparator(r.documentKey,e.documentKey),0!==t?t:qt(r.largestBatchId,e.largestBatchId))}const rZ="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class YSe{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}function K4(r){return tO.apply(this,arguments)}function tO(){return tO=M(function*(r){if(r.code!==fe.FAILED_PRECONDITION||r.message!==rZ)throw r;Oe("LocalStore","Unexpectedly lost primary lease")}),tO.apply(this,arguments)}class ce{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&at(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new ce((n,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(n,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(n,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof ce?t:ce.resolve(t)}catch(t){return ce.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):ce.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):ce.reject(t)}static resolve(e){return new ce((t,n)=>{t(e)})}static reject(e){return new ce((t,n)=>{n(e)})}static waitFor(e){return new ce((t,n)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&t()},c=>n(c))}),o=!0,s===i&&t()})}static or(e){let t=ce.resolve(!1);for(const n of e)t=t.next(i=>i?ce.resolve(i):n());return t}static forEach(e,t){const n=[];return e.forEach((i,s)=>{n.push(t.call(this,i,s))}),this.waitFor(n)}static mapArray(e,t){return new ce((n,i)=>{const s=e.length,o=new Array(s);let a=0;for(let c=0;c<s;c++){const l=c;t(e[l]).next(f=>{o[l]=f,++a,a===s&&n(o)},f=>i(f))}})}static doWhile(e,t){return new ce((n,i)=>{const s=()=>{!0===e()?t().next(()=>{s()},i):n()};s()})}}function X4(r){return"IndexedDbTransactionError"===r.name}let uo=(()=>{class r{constructor(t,n){this.previousValue=t,n&&(n.sequenceNumberHandler=i=>this.ot(i),this.ut=i=>n.writeSequenceNumber(i))}ot(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.ut&&this.ut(t),t}}return r.ct=-1,r})();function i9(r){return null==r}function s9(r){return 0===r&&1/r==-1/0}function dZ(r){let e=0;for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&e++;return e}function Q4(r,e){for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&e(t,r[t])}function hZ(r){for(const e in r)if(Object.prototype.hasOwnProperty.call(r,e))return!1;return!0}class x1{constructor(e,t){this.comparator=e,this.root=t||si.EMPTY}insert(e,t){return new x1(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,si.BLACK,null,null))}remove(e){return new x1(this.comparator,this.root.remove(e,this.comparator).copy(null,null,si.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(0===i)return t+n.left.size;i<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){const e=[];return this.inorderTraversal((t,n)=>(e.push(`${t}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Rm(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Rm(this.root,e,this.comparator,!1)}getReverseIterator(){return new Rm(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Rm(this.root,e,this.comparator,!0)}}class Rm{constructor(e,t,n,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?n(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(0===s){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class si{constructor(e,t,n,i,s){this.key=e,this.value=t,this.color=n??si.RED,this.left=i??si.EMPTY,this.right=s??si.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,i,s){return new si(e??this.key,t??this.value,n??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let i=this;const s=n(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,n),null):0===s?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return si.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===t(e,i.key)){if(i.right.isEmpty())return si.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,si.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,si.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw at();const e=this.left.check();if(e!==this.right.check())throw at();return e+(this.isRed()?0:1)}}si.EMPTY=null,si.RED=!0,si.BLACK=!1,si.EMPTY=new class{constructor(){this.size=0}get key(){throw at()}get value(){throw at()}get color(){throw at()}get left(){throw at()}get right(){throw at()}copy(r,e,t,n,i){return this}insert(r,e,t){return new si(r,e)}remove(r,e){return this}isEmpty(){return!0}inorderTraversal(r){return!1}reverseTraversal(r){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class V1{constructor(e){this.comparator=e,this.data=new x1(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new pZ(this.data.getIterator())}getIteratorFrom(e){return new pZ(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(n=>{t=t.add(n)}),t}isEqual(e){if(!(e instanceof V1)||this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=n.getNext().key;if(0!==this.comparator(i,s))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new V1(this.comparator);return t.data=e,t}}class pZ{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Ls{constructor(e){this.fields=e,e.sort(Fr.comparator)}static empty(){return new Ls([])}unionWith(e){let t=new V1(Fr.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new Ls(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return l5(this.fields,e.fields,(t,n)=>t.isEqual(n))}}class gZ extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class f2{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(n){try{return atob(n)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new gZ("Invalid base64 string: "+i):i}}(e);return new f2(t)}static fromUint8Array(e){const t=function(n){let i="";for(let s=0;s<n.length;++s)i+=String.fromCharCode(n[s]);return i}(e);return new f2(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return qt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}f2.EMPTY_BYTE_STRING=new f2("");const vPe=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function J4(r){if(mt(!!r),"string"==typeof r){let e=0;const t=vPe.exec(r);if(mt(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const n=new Date(r);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Sr(r.seconds),nanos:Sr(r.nanos)}}function Sr(r){return"number"==typeof r?r:"string"==typeof r?Number(r):0}function z3(r){return"string"==typeof r?f2.fromBase64String(r):f2.fromUint8Array(r)}function zm(r){var e,t;return"server_timestamp"===(null===(t=((null===(e=r?.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function Dm(r){const e=r.mapValue.fields.__previous_value__;return zm(e)?Dm(e):e}function o9(r){const e=J4(r.mapValue.fields.__local_write_time__.timestampValue);return new ar(e.seconds,e.nanos)}class CPe{constructor(e,t,n,i,s,o,a,c,l){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=l}}class $6{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new $6("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof $6&&e.projectId===this.projectId&&e.database===this.database}}const el={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function tl(r){return"nullValue"in r?0:"booleanValue"in r?1:"integerValue"in r||"doubleValue"in r?2:"timestampValue"in r?3:"stringValue"in r?5:"bytesValue"in r?6:"referenceValue"in r?7:"geoPointValue"in r?8:"arrayValue"in r?9:"mapValue"in r?zm(r)?4:CZ(r)?9007199254740991:10:at()}function wc(r,e){if(r===e)return!0;const t=tl(r);if(t!==tl(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return r.booleanValue===e.booleanValue;case 4:return o9(r).isEqual(o9(e));case 3:return function(n,i){if("string"==typeof n.timestampValue&&"string"==typeof i.timestampValue&&n.timestampValue.length===i.timestampValue.length)return n.timestampValue===i.timestampValue;const s=J4(n.timestampValue),o=J4(i.timestampValue);return s.seconds===o.seconds&&s.nanos===o.nanos}(r,e);case 5:return r.stringValue===e.stringValue;case 6:return i=e,z3(r.bytesValue).isEqual(z3(i.bytesValue));case 7:return r.referenceValue===e.referenceValue;case 8:return function(n,i){return Sr(n.geoPointValue.latitude)===Sr(i.geoPointValue.latitude)&&Sr(n.geoPointValue.longitude)===Sr(i.geoPointValue.longitude)}(r,e);case 2:return function(n,i){if("integerValue"in n&&"integerValue"in i)return Sr(n.integerValue)===Sr(i.integerValue);if("doubleValue"in n&&"doubleValue"in i){const s=Sr(n.doubleValue),o=Sr(i.doubleValue);return s===o?s9(s)===s9(o):isNaN(s)&&isNaN(o)}return!1}(r,e);case 9:return l5(r.arrayValue.values||[],e.arrayValue.values||[],wc);case 10:return function(n,i){const s=n.mapValue.fields||{},o=i.mapValue.fields||{};if(dZ(s)!==dZ(o))return!1;for(const a in s)if(s.hasOwnProperty(a)&&(void 0===o[a]||!wc(s[a],o[a])))return!1;return!0}(r,e);default:return at()}var i}function a9(r,e){return void 0!==(r.values||[]).find(t=>wc(t,e))}function nl(r,e){if(r===e)return 0;const t=tl(r),n=tl(e);if(t!==n)return qt(t,n);switch(t){case 0:case 9007199254740991:return 0;case 1:return qt(r.booleanValue,e.booleanValue);case 2:return function(i,s){const o=Sr(i.integerValue||i.doubleValue),a=Sr(s.integerValue||s.doubleValue);return o<a?-1:o>a?1:o===a?0:isNaN(o)?isNaN(a)?0:-1:1}(r,e);case 3:return mZ(r.timestampValue,e.timestampValue);case 4:return mZ(o9(r),o9(e));case 5:return qt(r.stringValue,e.stringValue);case 6:return function(i,s){const o=z3(i),a=z3(s);return o.compareTo(a)}(r.bytesValue,e.bytesValue);case 7:return function(i,s){const o=i.split("/"),a=s.split("/");for(let c=0;c<o.length&&c<a.length;c++){const l=qt(o[c],a[c]);if(0!==l)return l}return qt(o.length,a.length)}(r.referenceValue,e.referenceValue);case 8:return function(i,s){const o=qt(Sr(i.latitude),Sr(s.latitude));return 0!==o?o:qt(Sr(i.longitude),Sr(s.longitude))}(r.geoPointValue,e.geoPointValue);case 9:return function(i,s){const o=i.values||[],a=s.values||[];for(let c=0;c<o.length&&c<a.length;++c){const l=nl(o[c],a[c]);if(l)return l}return qt(o.length,a.length)}(r.arrayValue,e.arrayValue);case 10:return function(i,s){if(i===el.mapValue&&s===el.mapValue)return 0;if(i===el.mapValue)return 1;if(s===el.mapValue)return-1;const o=i.fields||{},a=Object.keys(o),c=s.fields||{},l=Object.keys(c);a.sort(),l.sort();for(let f=0;f<a.length&&f<l.length;++f){const d=qt(a[f],l[f]);if(0!==d)return d;const m=nl(o[a[f]],c[l[f]]);if(0!==m)return m}return qt(a.length,l.length)}(r.mapValue,e.mapValue);default:throw at()}}function mZ(r,e){if("string"==typeof r&&"string"==typeof e&&r.length===e.length)return qt(r,e);const t=J4(r),n=J4(e),i=qt(t.seconds,n.seconds);return 0!==i?i:qt(t.nanos,n.nanos)}function f5(r){return iO(r)}function iO(r){return"nullValue"in r?"null":"booleanValue"in r?""+r.booleanValue:"integerValue"in r?""+r.integerValue:"doubleValue"in r?""+r.doubleValue:"timestampValue"in r?function(n){const i=J4(n);return`time(${i.seconds},${i.nanos})`}(r.timestampValue):"stringValue"in r?r.stringValue:"bytesValue"in r?z3(r.bytesValue).toBase64():"referenceValue"in r?Be.fromName(r.referenceValue).toString():"geoPointValue"in r?`geo(${(e=r.geoPointValue).latitude},${e.longitude})`:"arrayValue"in r?function(n){let i="[",s=!0;for(const o of n.values||[])s?s=!1:i+=",",i+=iO(o);return i+"]"}(r.arrayValue):"mapValue"in r?function(n){const i=Object.keys(n.fields||{}).sort();let s="{",o=!0;for(const a of i)o?o=!1:s+=",",s+=`${a}:${iO(n.fields[a])}`;return s+"}"}(r.mapValue):at();var e}function G6(r,e){return{referenceValue:`projects/${r.projectId}/databases/${r.database}/documents/${e.path.canonicalString()}`}}function sO(r){return!!r&&"integerValue"in r}function c9(r){return!!r&&"arrayValue"in r}function _Z(r){return!!r&&"nullValue"in r}function vZ(r){return!!r&&"doubleValue"in r&&isNaN(Number(r.doubleValue))}function Fm(r){return!!r&&"mapValue"in r}function l9(r){if(r.geoPointValue)return{geoPointValue:Object.assign({},r.geoPointValue)};if(r.timestampValue&&"object"==typeof r.timestampValue)return{timestampValue:Object.assign({},r.timestampValue)};if(r.mapValue){const e={mapValue:{fields:{}}};return Q4(r.mapValue.fields,(t,n)=>e.mapValue.fields[t]=l9(n)),e}if(r.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(r.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=l9(r.arrayValue.values[t]);return e}return Object.assign({},r)}function CZ(r){return"__max__"===(((r.mapValue||{}).fields||{}).__type__||{}).stringValue}class oi{constructor(e){this.value=e}static empty(){return new oi({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!Fm(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=l9(t)}setAll(e){let t=Fr.emptyPath(),n={},i=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){const c=this.getFieldsMap(t);this.applyChanges(c,n,i),n={},i=[],t=a.popLast()}o?n[a.lastSegment()]=l9(o):i.push(a.lastSegment())});const s=this.getFieldsMap(t);this.applyChanges(s,n,i)}delete(e){const t=this.field(e.popLast());Fm(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return wc(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=t.mapValue.fields[e.get(n)];Fm(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,n){Q4(t,(i,s)=>e[i]=s);for(const i of n)delete e[i]}clone(){return new oi(l9(this.value))}}function EZ(r){const e=[];return Q4(r.fields,(t,n)=>{const i=new Fr([t]);if(Fm(n)){const s=EZ(n.mapValue).fields;if(0===s.length)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new Ls(e)}class F1{constructor(e,t,n,i,s,o,a){this.key=e,this.documentType=t,this.version=n,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new F1(e,0,Ct.min(),Ct.min(),Ct.min(),oi.empty(),0)}static newFoundDocument(e,t,n,i){return new F1(e,1,t,Ct.min(),n,i,0)}static newNoDocument(e,t){return new F1(e,2,t,Ct.min(),Ct.min(),oi.empty(),0)}static newUnknownDocument(e,t){return new F1(e,3,t,Ct.min(),Ct.min(),oi.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Ct.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=oi.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=oi.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ct.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof F1&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new F1(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class rl{constructor(e,t){this.position=e,this.inclusive=t}}function SZ(r,e,t){let n=0;for(let i=0;i<r.position.length;i++){const s=e[i],o=r.position[i];if(n=s.field.isKeyField()?Be.comparator(Be.fromName(o.referenceValue),t.key):nl(o,t.data.field(s.field)),"desc"===s.dir&&(n*=-1),0!==n)break}return n}function PZ(r,e){if(null===r)return null===e;if(null===e||r.inclusive!==e.inclusive||r.position.length!==e.position.length)return!1;for(let t=0;t<r.position.length;t++)if(!wc(r.position[t],e.position[t]))return!1;return!0}class d5{constructor(e,t="asc"){this.field=e,this.dir=t}}function EPe(r,e){return r.dir===e.dir&&r.field.isEqual(e.field)}class TZ{}class Mn extends TZ{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new SPe(e,t,n):"array-contains"===t?new OPe(e,n):"in"===t?new IZ(e,n):"not-in"===t?new bPe(e,n):"array-contains-any"===t?new wPe(e,n):new Mn(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new PPe(e,n):new TPe(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(nl(t,this.value)):null!==t&&tl(this.value)===tl(t)&&this.matchesComparison(nl(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return at()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}getFirstInequalityField(){return this.isInequality()?this.field:null}}class f1 extends TZ{constructor(e,t){super(),this.filters=e,this.op=t,this.lt=null}static create(e,t){return new f1(e,t)}matches(e){return h5(this)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.lt||(this.lt=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.lt}getFilters(){return Object.assign([],this.filters)}getFirstInequalityField(){const e=this.ft(t=>t.isInequality());return null!==e?e.field:null}ft(e){for(const t of this.getFlattenedFilters())if(e(t))return t;return null}}function h5(r){return"and"===r.op}function aO(r){return function OZ(r){for(const e of r.filters)if(e instanceof f1)return!1;return!0}(r)&&h5(r)}function cO(r){if(r instanceof Mn)return r.field.canonicalString()+r.op.toString()+f5(r.value);if(aO(r))return r.filters.map(e=>cO(e)).join(",");{const e=r.filters.map(t=>cO(t)).join(",");return`${r.op}(${e})`}}function bZ(r,e){return r instanceof Mn?(t=r,(n=e)instanceof Mn&&t.op===n.op&&t.field.isEqual(n.field)&&wc(t.value,n.value)):r instanceof f1?function(t,n){return n instanceof f1&&t.op===n.op&&t.filters.length===n.filters.length&&t.filters.reduce((i,s,o)=>i&&bZ(s,n.filters[o]),!0)}(r,e):void at();var t,n}function AZ(r){return r instanceof Mn?`${(e=r).field.canonicalString()} ${e.op} ${f5(e.value)}`:r instanceof f1?function(e){return e.op.toString()+" {"+e.getFilters().map(AZ).join(" ,")+"}"}(r):"Filter";var e}class SPe extends Mn{constructor(e,t,n){super(e,t,n),this.key=Be.fromName(n.referenceValue)}matches(e){const t=Be.comparator(e.key,this.key);return this.matchesComparison(t)}}class PPe extends Mn{constructor(e,t){super(e,"in",t),this.keys=NZ(0,t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class TPe extends Mn{constructor(e,t){super(e,"not-in",t),this.keys=NZ(0,t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function NZ(r,e){var t;return((null===(t=e.arrayValue)||void 0===t?void 0:t.values)||[]).map(n=>Be.fromName(n.referenceValue))}class OPe extends Mn{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return c9(t)&&a9(t.arrayValue,this.value)}}class IZ extends Mn{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&a9(this.value.arrayValue,t)}}class bPe extends Mn{constructor(e,t){super(e,"not-in",t)}matches(e){if(a9(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!a9(this.value.arrayValue,t)}}class wPe extends Mn{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!c9(t)||!t.arrayValue.values)&&t.arrayValue.values.some(n=>a9(this.value.arrayValue,n))}}class APe{constructor(e,t=null,n=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.dt=null}}function lO(r,e=null,t=[],n=[],i=null,s=null,o=null){return new APe(r,e,t,n,i,s,o)}function B6(r){const e=je(r);if(null===e.dt){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(n=>cO(n)).join(","),t+="|ob:",t+=e.orderBy.map(n=>{return(i=n).field.canonicalString()+i.dir;var i}).join(","),i9(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(n=>f5(n)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(n=>f5(n)).join(",")),e.dt=t}return e.dt}function u9(r,e){if(r.limit!==e.limit||r.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<r.orderBy.length;t++)if(!EPe(r.orderBy[t],e.orderBy[t]))return!1;if(r.filters.length!==e.filters.length)return!1;for(let t=0;t<r.filters.length;t++)if(!bZ(r.filters[t],e.filters[t]))return!1;return r.collectionGroup===e.collectionGroup&&!!r.path.isEqual(e.path)&&!!PZ(r.startAt,e.startAt)&&PZ(r.endAt,e.endAt)}function $m(r){return Be.isDocumentKey(r.path)&&null===r.collectionGroup&&0===r.filters.length}class D3{constructor(e,t=null,n=[],i=[],s=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=c,this.wt=null,this._t=null}}function p5(r){return new D3(r)}function RZ(r){return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.explicitOrderBy.length||1===r.explicitOrderBy.length&&r.explicitOrderBy[0].field.isKeyField())}function uO(r){return r.explicitOrderBy.length>0?r.explicitOrderBy[0].field:null}function Bm(r){for(const e of r.filters){const t=e.getFirstInequalityField();if(null!==t)return t}return null}function fO(r){return null!==r.collectionGroup}function U6(r){const e=je(r);if(null===e.wt){e.wt=[];const t=Bm(e),n=uO(e);if(null!==t&&null===n)t.isKeyField()||e.wt.push(new d5(t)),e.wt.push(new d5(Fr.keyField(),"asc"));else{let i=!1;for(const s of e.explicitOrderBy)e.wt.push(s),s.field.isKeyField()&&(i=!0);if(!i){const s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.wt.push(new d5(Fr.keyField(),s))}}}return e.wt}function us(r){const e=je(r);if(!e._t)if("F"===e.limitType)e._t=lO(e.path,e.collectionGroup,U6(e),e.filters,e.limit,e.startAt,e.endAt);else{const t=[];for(const s of U6(e))t.push(new d5(s.field,"desc"===s.dir?"asc":"desc"));const n=e.endAt?new rl(e.endAt.position,e.endAt.inclusive):null,i=e.startAt?new rl(e.startAt.position,e.startAt.inclusive):null;e._t=lO(e.path,e.collectionGroup,t,e.filters,e.limit,n,i)}return e._t}function dO(r,e){e.getFirstInequalityField(),Bm(r);const t=r.filters.concat([e]);return new D3(r.path,r.collectionGroup,r.explicitOrderBy.slice(),t,r.limit,r.limitType,r.startAt,r.endAt)}function Um(r,e,t){return new D3(r.path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),e,t,r.startAt,r.endAt)}function f9(r,e){return u9(us(r),us(e))&&r.limitType===e.limitType}function zZ(r){return`${B6(us(r))}|lt:${r.limitType}`}function hO(r){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map(n=>AZ(n)).join(", ")}]`),i9(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map(n=>{return`${(i=n).field.canonicalString()} (${i.dir})`;var i}).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(n=>f5(n)).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(n=>f5(n)).join(",")),`Target(${t})`}(us(r))}; limitType=${r.limitType})`}function d9(r,e){return e.isFoundDocument()&&function(t,n){const i=n.key.path;return null!==t.collectionGroup?n.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(i):Be.isDocumentKey(t.path)?t.path.isEqual(i):t.path.isImmediateParentOf(i)}(r,e)&&function(t,n){for(const i of U6(t))if(!i.field.isKeyField()&&null===n.data.field(i.field))return!1;return!0}(r,e)&&function(t,n){for(const i of t.filters)if(!i.matches(n))return!1;return!0}(r,e)&&(n=e,!((t=r).startAt&&!function(i,s,o){const a=SZ(i,s,o);return i.inclusive?a<=0:a<0}(t.startAt,U6(t),n)||t.endAt&&!function(i,s,o){const a=SZ(i,s,o);return i.inclusive?a>=0:a>0}(t.endAt,U6(t),n)));var t,n}function HZ(r){return(e,t)=>{let n=!1;for(const i of U6(r)){const s=NPe(i,e,t);if(0!==s)return s;n=n||i.field.isKeyField()}return 0}}function NPe(r,e,t){const n=r.field.isKeyField()?Be.comparator(e.key,t.key):function(i,s,o){const a=s.data.field(i),c=o.data.field(i);return null!==a&&null!==c?nl(a,c):at()}(r.field,e,t);switch(r.dir){case"asc":return n;case"desc":return-1*n;default:return at()}}class H3{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[i,s]of n)if(this.equalsFn(i,e))return s}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),i=this.inner[n];if(void 0===i)return this.inner[n]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return 1===n.length?delete this.inner[t]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Q4(this.inner,(t,n)=>{for(const[i,s]of n)e(i,s)})}isEmpty(){return hZ(this.inner)}size(){return this.innerSize}}const IPe=new x1(Be.comparator);function Rs(){return IPe}const VZ=new x1(Be.comparator);function h9(...r){let e=VZ;for(const t of r)e=e.insert(t.key,t);return e}function FZ(r){let e=VZ;return r.forEach((t,n)=>e=e.insert(t,n.overlayedDocument)),e}function Ac(){return p9()}function $Z(){return p9()}function p9(){return new H3(r=>r.toString(),(r,e)=>r.isEqual(e))}const kPe=new x1(Be.comparator),xPe=new V1(Be.comparator);function nn(...r){let e=xPe;for(const t of r)e=e.add(t);return e}const LPe=new V1(qt);function GZ(r,e){if(r.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:s9(e)?"-0":e}}function BZ(r){return{integerValue:""+r}}function UZ(r,e){return function sZ(r){return"number"==typeof r&&Number.isInteger(r)&&!s9(r)&&r<=Number.MAX_SAFE_INTEGER&&r>=Number.MIN_SAFE_INTEGER}(e)?BZ(e):GZ(r,e)}class Wm{constructor(){this._=void 0}}function RPe(r,e,t){return r instanceof g5?function(n,i){const s={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:n.seconds,nanos:n.nanoseconds}}}};return i&&zm(i)&&(i=Dm(i)),i&&(s.fields.__previous_value__=i),{mapValue:s}}(t,e):r instanceof W6?qZ(r,e):r instanceof q6?jZ(r,e):function(n,i){const s=WZ(n,i),o=ZZ(s)+ZZ(n.gt);return sO(s)&&sO(n.gt)?BZ(o):GZ(n.serializer,o)}(r,e)}function zPe(r,e,t){return r instanceof W6?qZ(r,e):r instanceof q6?jZ(r,e):t}function WZ(r,e){return r instanceof m5?sO(t=e)||(n=t)&&"doubleValue"in n?e:{integerValue:0}:null;var n,t}class g5 extends Wm{}class W6 extends Wm{constructor(e){super(),this.elements=e}}function qZ(r,e){const t=YZ(e);for(const n of r.elements)t.some(i=>wc(i,n))||t.push(n);return{arrayValue:{values:t}}}class q6 extends Wm{constructor(e){super(),this.elements=e}}function jZ(r,e){let t=YZ(e);for(const n of r.elements)t=t.filter(i=>!wc(i,n));return{arrayValue:{values:t}}}class m5 extends Wm{constructor(e,t){super(),this.serializer=e,this.gt=t}}function ZZ(r){return Sr(r.integerValue||r.doubleValue)}function YZ(r){return c9(r)&&r.arrayValue.values?r.arrayValue.values.slice():[]}class g9{constructor(e,t){this.field=e,this.transform=t}}class HPe{constructor(e,t){this.version=e,this.transformResults=t}}class J1{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new J1}static exists(e){return new J1(void 0,e)}static updateTime(e){return new J1(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function qm(r,e){return void 0!==r.updateTime?e.isFoundDocument()&&e.version.isEqual(r.updateTime):void 0===r.exists||r.exists===e.isFoundDocument()}class jm{}function KZ(r,e){if(!r.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return r.isNoDocument()?new v5(r.key,J1.none()):new _5(r.key,r.data,J1.none());{const t=r.data,n=oi.empty();let i=new V1(Fr.comparator);for(let s of e.fields)if(!i.has(s)){let o=t.field(s);null===o&&s.length>1&&(s=s.popLast(),o=t.field(s)),null===o?n.delete(s):n.set(s,o),i=i.add(s)}return new V3(r.key,n,new Ls(i.toArray()),J1.none())}}function VPe(r,e,t){r instanceof _5?function(n,i,s){const o=n.value.clone(),a=JZ(n.fieldTransforms,i,s.transformResults);o.setAll(a),i.convertToFoundDocument(s.version,o).setHasCommittedMutations()}(r,e,t):r instanceof V3?function(n,i,s){if(!qm(n.precondition,i))return void i.convertToUnknownDocument(s.version);const o=JZ(n.fieldTransforms,i,s.transformResults),a=i.data;a.setAll(QZ(n)),a.setAll(o),i.convertToFoundDocument(s.version,a).setHasCommittedMutations()}(r,e,t):e.convertToNoDocument(t.version).setHasCommittedMutations()}function m9(r,e,t,n){return r instanceof _5?function(i,s,o,a){if(!qm(i.precondition,s))return o;const c=i.value.clone(),l=eY(i.fieldTransforms,a,s);return c.setAll(l),s.convertToFoundDocument(s.version,c).setHasLocalMutations(),null}(r,e,t,n):r instanceof V3?function(i,s,o,a){if(!qm(i.precondition,s))return o;const c=eY(i.fieldTransforms,a,s),l=s.data;return l.setAll(QZ(i)),l.setAll(c),s.convertToFoundDocument(s.version,l).setHasLocalMutations(),null===o?null:o.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(f=>f.field))}(r,e,t,n):(o=t,qm(r.precondition,s=e)?(s.convertToNoDocument(s.version).setHasLocalMutations(),null):o);var s,o}function FPe(r,e){let t=null;for(const n of r.fieldTransforms){const i=e.data.field(n.field),s=WZ(n.transform,i||null);null!=s&&(null===t&&(t=oi.empty()),t.set(n.field,s))}return t||null}function XZ(r,e){return r.type===e.type&&!!r.key.isEqual(e.key)&&!!r.precondition.isEqual(e.precondition)&&(n=e.fieldTransforms,!!(void 0===(t=r.fieldTransforms)&&void 0===n||t&&n&&l5(t,n,(i,s)=>function DPe(r,e){return r.field.isEqual(e.field)&&(n=e.transform,(t=r.transform)instanceof W6&&n instanceof W6||t instanceof q6&&n instanceof q6?l5(t.elements,n.elements,wc):t instanceof m5&&n instanceof m5?wc(t.gt,n.gt):t instanceof g5&&n instanceof g5);var t,n}(i,s))))&&(0===r.type?r.value.isEqual(e.value):1!==r.type||r.data.isEqual(e.data)&&r.fieldMask.isEqual(e.fieldMask));var t,n}class _5 extends jm{constructor(e,t,n,i=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class V3 extends jm{constructor(e,t,n,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function QZ(r){const e=new Map;return r.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const n=r.data.field(t);e.set(t,n)}}),e}function JZ(r,e,t){const n=new Map;mt(r.length===t.length);for(let i=0;i<t.length;i++){const s=r[i],o=s.transform,a=e.data.field(s.field);n.set(s.field,zPe(o,a,t[i]))}return n}function eY(r,e,t){const n=new Map;for(const i of r){const s=i.transform,o=t.data.field(i.field);n.set(i.field,RPe(s,o,e))}return n}class v5 extends jm{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class gO extends jm{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class mO{constructor(e,t,n,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&VPe(s,e,n[i])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=m9(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=m9(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=$Z();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=t.has(i.key)?null:a;const c=KZ(o,a);null!==c&&n.set(i.key,c),o.isValidDocument()||o.convertToNoDocument(Ct.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),nn())}isEqual(e){return this.batchId===e.batchId&&l5(this.mutations,e.mutations,(t,n)=>XZ(t,n))&&l5(this.baseMutations,e.baseMutations,(t,n)=>XZ(t,n))}}class _O{constructor(e,t,n,i){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=i}static from(e,t,n){mt(e.mutations.length===n.length);let i=kPe;const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,n[o].version);return new _O(e,t,n,i)}}class vO{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class GPe{constructor(e,t){this.count=e,this.unchangedNames=t}}var Qr,Hn;function nY(r){if(void 0===r)return Vr("GRPC error has no .code"),fe.UNKNOWN;switch(r){case Qr.OK:return fe.OK;case Qr.CANCELLED:return fe.CANCELLED;case Qr.UNKNOWN:return fe.UNKNOWN;case Qr.DEADLINE_EXCEEDED:return fe.DEADLINE_EXCEEDED;case Qr.RESOURCE_EXHAUSTED:return fe.RESOURCE_EXHAUSTED;case Qr.INTERNAL:return fe.INTERNAL;case Qr.UNAVAILABLE:return fe.UNAVAILABLE;case Qr.UNAUTHENTICATED:return fe.UNAUTHENTICATED;case Qr.INVALID_ARGUMENT:return fe.INVALID_ARGUMENT;case Qr.NOT_FOUND:return fe.NOT_FOUND;case Qr.ALREADY_EXISTS:return fe.ALREADY_EXISTS;case Qr.PERMISSION_DENIED:return fe.PERMISSION_DENIED;case Qr.FAILED_PRECONDITION:return fe.FAILED_PRECONDITION;case Qr.ABORTED:return fe.ABORTED;case Qr.OUT_OF_RANGE:return fe.OUT_OF_RANGE;case Qr.UNIMPLEMENTED:return fe.UNIMPLEMENTED;case Qr.DATA_LOSS:return fe.DATA_LOSS;default:return at()}}(Hn=Qr||(Qr={}))[Hn.OK=0]="OK",Hn[Hn.CANCELLED=1]="CANCELLED",Hn[Hn.UNKNOWN=2]="UNKNOWN",Hn[Hn.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Hn[Hn.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Hn[Hn.NOT_FOUND=5]="NOT_FOUND",Hn[Hn.ALREADY_EXISTS=6]="ALREADY_EXISTS",Hn[Hn.PERMISSION_DENIED=7]="PERMISSION_DENIED",Hn[Hn.UNAUTHENTICATED=16]="UNAUTHENTICATED",Hn[Hn.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Hn[Hn.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Hn[Hn.ABORTED=10]="ABORTED",Hn[Hn.OUT_OF_RANGE=11]="OUT_OF_RANGE",Hn[Hn.UNIMPLEMENTED=12]="UNIMPLEMENTED",Hn[Hn.INTERNAL=13]="INTERNAL",Hn[Hn.UNAVAILABLE=14]="UNAVAILABLE",Hn[Hn.DATA_LOSS=15]="DATA_LOSS";class CO{constructor(){this.onExistenceFilterMismatchCallbacks=new Map}static get instance(){return Zm}static getOrCreateInstance(){return null===Zm&&(Zm=new CO),Zm}onExistenceFilterMismatch(e){const t=Symbol();return this.onExistenceFilterMismatchCallbacks.set(t,e),()=>this.onExistenceFilterMismatchCallbacks.delete(t)}notifyOnExistenceFilterMismatch(e){this.onExistenceFilterMismatchCallbacks.forEach(t=>t(e))}}let Zm=null;const BPe=new a5([4294967295,4294967295],0);function iY(r){const e=function rY(){return new TextEncoder}().encode(r),t=new HSe;return t.update(e),new Uint8Array(t.digest())}function sY(r){const e=new DataView(r.buffer),t=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new a5([t,n],0),new a5([i,s],0)]}class yO{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new _9(`Invalid padding: ${t}`);if(n<0)throw new _9(`Invalid hash count: ${n}`);if(e.length>0&&0===this.hashCount)throw new _9(`Invalid hash count: ${n}`);if(0===e.length&&0!==t)throw new _9(`Invalid padding when bitmap length is 0: ${t}`);this.It=8*e.length-t,this.Tt=a5.fromNumber(this.It)}Et(e,t,n){let i=e.add(t.multiply(a5.fromNumber(n)));return 1===i.compare(BPe)&&(i=new a5([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Tt).toNumber()}At(e){return 0!=(this.bitmap[Math.floor(e/8)]&1<<e%8)}vt(e){if(0===this.It)return!1;const t=iY(e),[n,i]=sY(t);for(let s=0;s<this.hashCount;s++){const o=this.Et(n,i,s);if(!this.At(o))return!1}return!0}static create(e,t,n){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new yO(s,i,t);return n.forEach(a=>o.insert(a)),o}insert(e){if(0===this.It)return;const t=iY(e),[n,i]=sY(t);for(let s=0;s<this.hashCount;s++){const o=this.Et(n,i,s);this.Rt(o)}}Rt(e){const t=Math.floor(e/8);this.bitmap[t]|=1<<e%8}}class _9 extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class v9{constructor(e,t,n,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const i=new Map;return i.set(e,C9.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new v9(Ct.min(),i,new x1(qt),Rs(),nn())}}class C9{constructor(e,t,n,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new C9(n,t,nn(),nn(),nn())}}class Ym{constructor(e,t,n,i){this.Pt=e,this.removedTargetIds=t,this.key=n,this.bt=i}}class oY{constructor(e,t){this.targetId=e,this.Vt=t}}class aY{constructor(e,t,n=f2.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=i}}class cY{constructor(){this.St=0,this.Dt=uY(),this.Ct=f2.EMPTY_BYTE_STRING,this.xt=!1,this.Nt=!0}get current(){return this.xt}get resumeToken(){return this.Ct}get kt(){return 0!==this.St}get Mt(){return this.Nt}$t(e){e.approximateByteSize()>0&&(this.Nt=!0,this.Ct=e)}Ot(){let e=nn(),t=nn(),n=nn();return this.Dt.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:n=n.add(i);break;default:at()}}),new C9(this.Ct,this.xt,e,t,n)}Ft(){this.Nt=!1,this.Dt=uY()}Bt(e,t){this.Nt=!0,this.Dt=this.Dt.insert(e,t)}Lt(e){this.Nt=!0,this.Dt=this.Dt.remove(e)}qt(){this.St+=1}Ut(){this.St-=1}Kt(){this.Nt=!0,this.xt=!0}}class UPe{constructor(e){this.Gt=e,this.Qt=new Map,this.jt=Rs(),this.zt=lY(),this.Wt=new x1(qt)}Ht(e){for(const t of e.Pt)e.bt&&e.bt.isFoundDocument()?this.Jt(t,e.bt):this.Yt(t,e.key,e.bt);for(const t of e.removedTargetIds)this.Yt(t,e.key,e.bt)}Xt(e){this.forEachTarget(e,t=>{const n=this.Zt(t);switch(e.state){case 0:this.te(t)&&n.$t(e.resumeToken);break;case 1:n.Ut(),n.kt||n.Ft(),n.$t(e.resumeToken);break;case 2:n.Ut(),n.kt||this.removeTarget(t);break;case 3:this.te(t)&&(n.Kt(),n.$t(e.resumeToken));break;case 4:this.te(t)&&(this.ee(t),n.$t(e.resumeToken));break;default:at()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Qt.forEach((n,i)=>{this.te(i)&&t(i)})}ne(e){var t;const n=e.targetId,i=e.Vt.count,s=this.se(n);if(s){const o=s.target;if($m(o))if(0===i){const a=new Be(o.path);this.Yt(n,a,F1.newNoDocument(a,Ct.min()))}else mt(1===i);else{const a=this.ie(n);if(a!==i){const c=this.re(e,a);0!==c&&(this.ee(n),this.Wt=this.Wt.insert(n,2===c?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch")),null===(t=CO.instance)||void 0===t||t.notifyOnExistenceFilterMismatch(function(l,f,d){var m,E,w,R,z,$;const G={localCacheCount:f,existenceFilterCount:d.count},de=d.unchangedNames;return de&&(G.bloomFilter={applied:0===l,hashCount:null!==(m=de?.hashCount)&&void 0!==m?m:0,bitmapLength:null!==(R=null===(w=null===(E=de?.bits)||void 0===E?void 0:E.bitmap)||void 0===w?void 0:w.length)&&void 0!==R?R:0,padding:null!==($=null===(z=de?.bits)||void 0===z?void 0:z.padding)&&void 0!==$?$:0}),G}(c,a,e.Vt))}}}}re(e,t){const{unchangedNames:n,count:i}=e.Vt;if(!n||!n.bits)return 1;const{bits:{bitmap:s="",padding:o=0},hashCount:a=0}=n;let c,l;try{c=z3(s).toUint8Array()}catch(f){if(f instanceof gZ)return Ta("Decoding the base64 bloom filter in existence filter failed ("+f.message+"); ignoring the bloom filter and falling back to full re-query."),1;throw f}try{l=new yO(c,o,a)}catch(f){return Ta(f instanceof _9?"BloomFilter error: ":"Applying bloom filter failed: ",f),1}return 0===l.It?1:i!==t-this.oe(e.targetId,l)?2:0}oe(e,t){const n=this.Gt.getRemoteKeysForTarget(e);let i=0;return n.forEach(s=>{const o=this.Gt.ue(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;t.vt(a)||(this.Yt(e,s,null),i++)}),i}ce(e){const t=new Map;this.Qt.forEach((s,o)=>{const a=this.se(o);if(a){if(s.current&&$m(a.target)){const c=new Be(a.target.path);null!==this.jt.get(c)||this.ae(o,c)||this.Yt(o,c,F1.newNoDocument(c,e))}s.Mt&&(t.set(o,s.Ot()),s.Ft())}});let n=nn();this.zt.forEach((s,o)=>{let a=!0;o.forEachWhile(c=>{const l=this.se(c);return!l||"TargetPurposeLimboResolution"===l.purpose||(a=!1,!1)}),a&&(n=n.add(s))}),this.jt.forEach((s,o)=>o.setReadTime(e));const i=new v9(e,t,this.Wt,this.jt,n);return this.jt=Rs(),this.zt=lY(),this.Wt=new x1(qt),i}Jt(e,t){if(!this.te(e))return;const n=this.ae(e,t.key)?2:0;this.Zt(e).Bt(t.key,n),this.jt=this.jt.insert(t.key,t),this.zt=this.zt.insert(t.key,this.he(t.key).add(e))}Yt(e,t,n){if(!this.te(e))return;const i=this.Zt(e);this.ae(e,t)?i.Bt(t,1):i.Lt(t),this.zt=this.zt.insert(t,this.he(t).delete(e)),n&&(this.jt=this.jt.insert(t,n))}removeTarget(e){this.Qt.delete(e)}ie(e){const t=this.Zt(e).Ot();return this.Gt.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}qt(e){this.Zt(e).qt()}Zt(e){let t=this.Qt.get(e);return t||(t=new cY,this.Qt.set(e,t)),t}he(e){let t=this.zt.get(e);return t||(t=new V1(qt),this.zt=this.zt.insert(e,t)),t}te(e){const t=null!==this.se(e);return t||Oe("WatchChangeAggregator","Detected inactive target",e),t}se(e){const t=this.Qt.get(e);return t&&t.kt?null:this.Gt.le(e)}ee(e){this.Qt.set(e,new cY),this.Gt.getRemoteKeysForTarget(e).forEach(t=>{this.Yt(e,t,null)})}ae(e,t){return this.Gt.getRemoteKeysForTarget(e).has(t)}}function lY(){return new x1(Be.comparator)}function uY(){return new x1(Be.comparator)}const WPe={asc:"ASCENDING",desc:"DESCENDING"},qPe={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},jPe={and:"AND",or:"OR"};class ZPe{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function MO(r,e){return r.useProto3Json||i9(e)?e:{value:e}}function C5(r,e){return r.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function fY(r,e){return r.useProto3Json?e.toBase64():e.toUint8Array()}function YPe(r,e){return C5(r,e.toTimestamp())}function $r(r){return mt(!!r),Ct.fromTimestamp(function(e){const t=J4(e);return new ar(t.seconds,t.nanos)}(r))}function EO(r,e){return(t=r,new Dn(["projects",t.projectId,"databases",t.database])).child("documents").child(e).canonicalString();var t}function dY(r){const e=Dn.fromString(r);return mt(MY(e)),e}function y9(r,e){return EO(r.databaseId,e.path)}function Nc(r,e){const t=dY(e);if(t.get(1)!==r.databaseId.projectId)throw new Te(fe.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+r.databaseId.projectId);if(t.get(3)!==r.databaseId.database)throw new Te(fe.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+r.databaseId.database);return new Be(pY(t))}function SO(r,e){return EO(r.databaseId,e)}function M9(r){return new Dn(["projects",r.databaseId.projectId,"databases",r.databaseId.database]).canonicalString()}function pY(r){return mt(r.length>4&&"documents"===r.get(4)),r.popFirst(5)}function gY(r,e,t){return{name:y9(r,e),fields:t.value.mapValue.fields}}function _Y(r,e){return{documents:[SO(r,e.path)]}}function TO(r,e){const t={structuredQuery:{}},n=e.path;null!==e.collectionGroup?(t.parent=SO(r,n),t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(t.parent=SO(r,n.popLast()),t.structuredQuery.from=[{collectionId:n.lastSegment()}]);const i=function(c){if(0!==c.length)return yY(f1.create(c,"and"))}(e.filters);i&&(t.structuredQuery.where=i);const s=function(c){if(0!==c.length)return c.map(l=>{return{field:il((f=l).field),direction:eTe(f.dir)};var f})}(e.orderBy);s&&(t.structuredQuery.orderBy=s);const o=MO(r,e.limit);var a,c;return null!==o&&(t.structuredQuery.limit=o),e.startAt&&(t.structuredQuery.startAt={before:(a=e.startAt).inclusive,values:a.position}),e.endAt&&(t.structuredQuery.endAt={before:!(c=e.endAt).inclusive,values:c.position}),t}function vY(r){let e=function hY(r){const e=dY(r);return 4===e.length?Dn.emptyPath():pY(e)}(r.parent);const t=r.structuredQuery,n=t.from?t.from.length:0;let i=null;if(n>0){mt(1===n);const f=t.from[0];f.allDescendants?i=f.collectionId:e=e.child(f.collectionId)}let s=[];t.where&&(s=function(f){const d=CY(f);return d instanceof f1&&aO(d)?d.getFilters():[d]}(t.where));let o=[];t.orderBy&&(o=t.orderBy.map(f=>{return new d5(y5((d=f).field),function(m){switch(m){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(d.direction));var d}));let a=null;t.limit&&(a=function(f){let d;return d="object"==typeof f?f.value:f,i9(d)?null:d}(t.limit));let c=null;var f;t.startAt&&(c=new rl((f=t.startAt).values||[],!!f.before));let l=null;return t.endAt&&(l=function(f){return new rl(f.values||[],!f.before)}(t.endAt)),function LZ(r,e,t,n,i,s,o,a){return new D3(r,e,t,n,i,s,o,a)}(e,i,o,s,a,"F",c,l)}function CY(r){return void 0!==r.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=y5(e.unaryFilter.field);return Mn.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=y5(e.unaryFilter.field);return Mn.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=y5(e.unaryFilter.field);return Mn.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=y5(e.unaryFilter.field);return Mn.create(s,"!=",{nullValue:"NULL_VALUE"});default:return at()}}(r):void 0!==r.fieldFilter?Mn.create(y5((e=r).fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return at()}}(e.fieldFilter.op),e.fieldFilter.value):void 0!==r.compositeFilter?function(e){return f1.create(e.compositeFilter.filters.map(t=>CY(t)),function(t){switch(t){case"AND":return"and";case"OR":return"or";default:return at()}}(e.compositeFilter.op))}(r):at();var e}function eTe(r){return WPe[r]}function tTe(r){return qPe[r]}function nTe(r){return jPe[r]}function il(r){return{fieldPath:r.canonicalString()}}function y5(r){return Fr.fromServerFormat(r.fieldPath)}function yY(r){return r instanceof Mn?function(e){if("=="===e.op){if(vZ(e.value))return{unaryFilter:{field:il(e.field),op:"IS_NAN"}};if(_Z(e.value))return{unaryFilter:{field:il(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(vZ(e.value))return{unaryFilter:{field:il(e.field),op:"IS_NOT_NAN"}};if(_Z(e.value))return{unaryFilter:{field:il(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:il(e.field),op:tTe(e.op),value:e.value}}}(r):r instanceof f1?function(e){const t=e.getFilters().map(n=>yY(n));return 1===t.length?t[0]:{compositeFilter:{op:nTe(e.op),filters:t}}}(r):at()}function rTe(r){const e=[];return r.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function MY(r){return r.length>=4&&"projects"===r.get(0)&&"databases"===r.get(2)}class F3{constructor(e,t,n,i,s=Ct.min(),o=Ct.min(),a=f2.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new F3(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new F3(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new F3(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new F3(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class EY{constructor(e){this.fe=e}}function OO(r){const e=vY({parent:r.parent,structuredQuery:r.structuredQuery});return"LAST"===r.limitType?Um(e,e.limit,"L"):e}class K6{constructor(){}_e(e,t){this.me(e,t),t.ge()}me(e,t){if("nullValue"in e)this.ye(t,5);else if("booleanValue"in e)this.ye(t,10),t.pe(e.booleanValue?1:0);else if("integerValue"in e)this.ye(t,15),t.pe(Sr(e.integerValue));else if("doubleValue"in e){const n=Sr(e.doubleValue);isNaN(n)?this.ye(t,13):(this.ye(t,15),s9(n)?t.pe(0):t.pe(n))}else if("timestampValue"in e){const n=e.timestampValue;this.ye(t,20),"string"==typeof n?t.Ie(n):(t.Ie(`${n.seconds||""}`),t.pe(n.nanos||0))}else if("stringValue"in e)this.Te(e.stringValue,t),this.Ee(t);else if("bytesValue"in e)this.ye(t,30),t.Ae(z3(e.bytesValue)),this.Ee(t);else if("referenceValue"in e)this.ve(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.ye(t,45),t.pe(n.latitude||0),t.pe(n.longitude||0)}else"mapValue"in e?CZ(e)?this.ye(t,Number.MAX_SAFE_INTEGER):(this.Re(e.mapValue,t),this.Ee(t)):"arrayValue"in e?(this.Pe(e.arrayValue,t),this.Ee(t)):at()}Te(e,t){this.ye(t,25),this.be(e,t)}be(e,t){t.Ie(e)}Re(e,t){const n=e.fields||{};this.ye(t,55);for(const i of Object.keys(n))this.Te(i,t),this.me(n[i],t)}Pe(e,t){const n=e.values||[];this.ye(t,50);for(const i of n)this.me(i,t)}ve(e,t){this.ye(t,37),Be.fromName(e).path.forEach(n=>{this.ye(t,60),this.be(n,t)})}ye(e,t){e.pe(t)}Ee(e){e.pe(2)}}K6.Ve=new K6;class dTe{constructor(){this.rn=new kO}addToCollectionParentIndex(e,t){return this.rn.add(t),ce.resolve()}getCollectionParents(e,t){return ce.resolve(this.rn.getEntries(t))}addFieldIndex(e,t){return ce.resolve()}deleteFieldIndex(e,t){return ce.resolve()}getDocumentsMatchingTarget(e,t){return ce.resolve(null)}getIndexType(e,t){return ce.resolve(0)}getFieldIndexes(e,t){return ce.resolve([])}getNextCollectionGroupToUpdate(e){return ce.resolve(null)}getMinOffset(e,t){return ce.resolve(lo.min())}getMinOffsetFromCollectionGroup(e,t){return ce.resolve(lo.min())}updateCollectionGroup(e,t,n){return ce.resolve()}updateIndexEntries(e,t){return ce.resolve()}}class kO{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t]||new V1(Dn.comparator),s=!i.has(n);return this.index[t]=i.add(n),s}has(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t];return i&&i.has(n)}getEntries(e){return(this.index[e]||new V1(Dn.comparator)).toArray()}}new Uint8Array(0);class Ri{constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new Ri(e,Ri.DEFAULT_COLLECTION_PERCENTILE,Ri.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}Ri.DEFAULT_COLLECTION_PERCENTILE=10,Ri.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ri.DEFAULT=new Ri(41943040,Ri.DEFAULT_COLLECTION_PERCENTILE,Ri.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ri.DISABLED=new Ri(-1,0,0);class Q6{constructor(e){this.Nn=e}next(){return this.Nn+=2,this.Nn}static kn(){return new Q6(0)}static Mn(){return new Q6(-1)}}class vTe{constructor(){this.changes=new H3(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,F1.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?ce.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class MTe{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class ZY{constructor(e,t,n,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(null!==n&&m9(n.mutation,i,Ls.empty(),ar.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.getLocalViewOfDocuments(e,n,nn()).next(()=>n))}getLocalViewOfDocuments(e,t,n=nn()){const i=Ac();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,n).next(s=>{let o=h9();return s.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){const n=Ac();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,nn()))}populateOverlays(e,t,n){const i=[];return n.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,n,i){let s=Rs();const o=p9(),a=p9();return t.forEach((c,l)=>{const f=n.get(l.key);i.has(l.key)&&(void 0===f||f.mutation instanceof V3)?s=s.insert(l.key,l):void 0!==f?(o.set(l.key,f.mutation.getFieldMask()),m9(f.mutation,l,f.mutation.getFieldMask(),ar.now())):o.set(l.key,Ls.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((l,f)=>o.set(l,f)),t.forEach((l,f)=>{var d;return a.set(l,new MTe(f,null!==(d=o.get(l))&&void 0!==d?d:null))}),a))}recalculateAndSaveOverlays(e,t){const n=p9();let i=new x1((o,a)=>o-a),s=nn();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(const a of o)a.keys().forEach(c=>{const l=t.get(c);if(null===l)return;let f=n.get(c)||Ls.empty();f=a.applyToLocalView(l,f),n.set(c,f);const d=(i.get(a.batchId)||nn()).add(c);i=i.insert(a.batchId,d)})}).next(()=>{const o=[],a=i.getReverseIterator();for(;a.hasNext();){const c=a.getNext(),l=c.key,f=c.value,d=$Z();f.forEach(m=>{if(!s.has(m)){const E=KZ(t.get(m),n.get(m));null!==E&&d.set(m,E),s=s.add(m)}}),o.push(this.documentOverlayCache.saveOverlays(e,l,d))}return ce.waitFor(o)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,t,n){return Be.isDocumentKey((i=t).path)&&null===i.collectionGroup&&0===i.filters.length?this.getDocumentsMatchingDocumentQuery(e,t.path):fO(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n):this.getDocumentsMatchingCollectionQuery(e,t,n);var i}getNextDocuments(e,t,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,i-s.size):ce.resolve(Ac());let a=-1,c=s;return o.next(l=>ce.forEach(l,(f,d)=>(a<d.largestBatchId&&(a=d.largestBatchId),s.get(f)?ce.resolve():this.remoteDocumentCache.getEntry(e,f).next(m=>{c=c.insert(f,m)}))).next(()=>this.populateOverlays(e,l,s)).next(()=>this.computeViews(e,c,l,nn())).next(f=>({batchId:a,changes:FZ(f)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Be(t)).next(n=>{let i=h9();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,n){const i=t.collectionGroup;let s=h9();return this.indexManager.getCollectionParents(e,i).next(o=>ce.forEach(o,a=>{const c=(l=t,f=a.child(i),new D3(f,null,l.explicitOrderBy.slice(),l.filters.slice(),l.limit,l.limitType,l.startAt,l.endAt));var l,f;return this.getDocumentsMatchingCollectionQuery(e,c,n).next(l=>{l.forEach((f,d)=>{s=s.insert(f,d)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,t,n){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(s=>(i=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,i))).next(s=>{i.forEach((a,c)=>{const l=c.getKey();null===s.get(l)&&(s=s.insert(l,F1.newInvalidDocument(l)))});let o=h9();return s.forEach((a,c)=>{const l=i.get(a);void 0!==l&&m9(l.mutation,c,Ls.empty(),ar.now()),d9(t,c)&&(o=o.insert(a,c))}),o})}}class ETe{constructor(e){this.serializer=e,this.cs=new Map,this.hs=new Map}getBundleMetadata(e,t){return ce.resolve(this.cs.get(t))}saveBundleMetadata(e,t){var n;return this.cs.set(t.id,{id:(n=t).id,version:n.version,createTime:$r(n.createTime)}),ce.resolve()}getNamedQuery(e,t){return ce.resolve(this.hs.get(t))}saveNamedQuery(e,t){return this.hs.set(t.name,{name:(n=t).name,query:OO(n.bundledQuery),readTime:$r(n.readTime)}),ce.resolve();var n}}class STe{constructor(){this.overlays=new x1(Be.comparator),this.ls=new Map}getOverlay(e,t){return ce.resolve(this.overlays.get(t))}getOverlays(e,t){const n=Ac();return ce.forEach(t,i=>this.getOverlay(e,i).next(s=>{null!==s&&n.set(i,s)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((i,s)=>{this.we(e,t,s)}),ce.resolve()}removeOverlaysForBatchId(e,t,n){const i=this.ls.get(n);return void 0!==i&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.ls.delete(n)),ce.resolve()}getOverlaysForCollection(e,t,n){const i=Ac(),s=t.length+1,o=new Be(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const c=a.getNext().value,l=c.getKey();if(!t.isPrefixOf(l.path))break;l.path.length===s&&c.largestBatchId>n&&i.set(c.getKey(),c)}return ce.resolve(i)}getOverlaysForCollectionGroup(e,t,n,i){let s=new x1((l,f)=>l-f);const o=this.overlays.getIterator();for(;o.hasNext();){const l=o.getNext().value;if(l.getKey().getCollectionGroup()===t&&l.largestBatchId>n){let f=s.get(l.largestBatchId);null===f&&(f=Ac(),s=s.insert(l.largestBatchId,f)),f.set(l.getKey(),l)}}const a=Ac(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((l,f)=>a.set(l,f)),!(a.size()>=i)););return ce.resolve(a)}we(e,t,n){const i=this.overlays.get(n.key);if(null!==i){const o=this.ls.get(i.largestBatchId).delete(n.key);this.ls.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(n.key,new vO(t,n));let s=this.ls.get(t);void 0===s&&(s=nn(),this.ls.set(t,s)),this.ls.set(t,s.add(n.key))}}class xO{constructor(){this.fs=new V1(x2.ds),this.ws=new V1(x2._s)}isEmpty(){return this.fs.isEmpty()}addReference(e,t){const n=new x2(e,t);this.fs=this.fs.add(n),this.ws=this.ws.add(n)}gs(e,t){e.forEach(n=>this.addReference(n,t))}removeReference(e,t){this.ys(new x2(e,t))}ps(e,t){e.forEach(n=>this.removeReference(n,t))}Is(e){const t=new Be(new Dn([])),n=new x2(t,e),i=new x2(t,e+1),s=[];return this.ws.forEachInRange([n,i],o=>{this.ys(o),s.push(o.key)}),s}Ts(){this.fs.forEach(e=>this.ys(e))}ys(e){this.fs=this.fs.delete(e),this.ws=this.ws.delete(e)}Es(e){const t=new Be(new Dn([])),n=new x2(t,e),i=new x2(t,e+1);let s=nn();return this.ws.forEachInRange([n,i],o=>{s=s.add(o.key)}),s}containsKey(e){const t=new x2(e,0),n=this.fs.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class x2{constructor(e,t){this.key=e,this.As=t}static ds(e,t){return Be.comparator(e.key,t.key)||qt(e.As,t.As)}static _s(e,t){return qt(e.As,t.As)||Be.comparator(e.key,t.key)}}class PTe{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.vs=1,this.Rs=new V1(x2.ds)}checkEmpty(e){return ce.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,i){const s=this.vs;this.vs++;const o=new mO(s,t,n,i);this.mutationQueue.push(o);for(const a of i)this.Rs=this.Rs.add(new x2(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return ce.resolve(o)}lookupMutationBatch(e,t){return ce.resolve(this.Ps(t))}getNextMutationBatchAfterBatchId(e,t){const i=this.bs(t+1),s=i<0?0:i;return ce.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return ce.resolve(0===this.mutationQueue.length?-1:this.vs-1)}getAllMutationBatches(e){return ce.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new x2(t,0),i=new x2(t,Number.POSITIVE_INFINITY),s=[];return this.Rs.forEachInRange([n,i],o=>{const a=this.Ps(o.As);s.push(a)}),ce.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new V1(qt);return t.forEach(i=>{const s=new x2(i,0),o=new x2(i,Number.POSITIVE_INFINITY);this.Rs.forEachInRange([s,o],a=>{n=n.add(a.As)})}),ce.resolve(this.Vs(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,i=n.length+1;let s=n;Be.isDocumentKey(s)||(s=s.child(""));const o=new x2(new Be(s),0);let a=new V1(qt);return this.Rs.forEachWhile(c=>{const l=c.key.path;return!!n.isPrefixOf(l)&&(l.length===i&&(a=a.add(c.As)),!0)},o),ce.resolve(this.Vs(a))}Vs(e){const t=[];return e.forEach(n=>{const i=this.Ps(n);null!==i&&t.push(i)}),t}removeMutationBatch(e,t){mt(0===this.Ss(t.batchId,"removed")),this.mutationQueue.shift();let n=this.Rs;return ce.forEach(t.mutations,i=>{const s=new x2(i.key,t.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Rs=n})}Cn(e){}containsKey(e,t){const n=new x2(t,0),i=this.Rs.firstAfterOrEqual(n);return ce.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return ce.resolve()}Ss(e,t){return this.bs(e)}bs(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Ps(e){const t=this.bs(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class TTe{constructor(e){this.Ds=e,this.docs=new x1(Be.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,i=this.docs.get(n),s=i?i.size:0,o=this.Ds(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return ce.resolve(n?n.document.mutableCopy():F1.newInvalidDocument(t))}getEntries(e,t){let n=Rs();return t.forEach(i=>{const s=this.docs.get(i);n=n.insert(i,s?s.document.mutableCopy():F1.newInvalidDocument(i))}),ce.resolve(n)}getDocumentsMatchingQuery(e,t,n,i){let s=Rs();const o=t.path,a=new Be(o.child("")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){const{key:l,value:{document:f}}=c.getNext();if(!o.isPrefixOf(l.path))break;l.path.length>o.length+1||eO(nZ(f),n)<=0||(i.has(f.key)||d9(t,f))&&(s=s.insert(f.key,f.mutableCopy()))}return ce.resolve(s)}getAllFromCollectionGroup(e,t,n,i){at()}Cs(e,t){return ce.forEach(this.docs,n=>t(n))}newChangeBuffer(e){return new OTe(this)}getSize(e){return ce.resolve(this.size)}}class OTe extends vTe{constructor(e){super(),this.os=e}applyChanges(e){const t=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?t.push(this.os.addEntry(e,i)):this.os.removeEntry(n)}),ce.waitFor(t)}getFromCache(e,t){return this.os.getEntry(e,t)}getAllFromCache(e,t){return this.os.getEntries(e,t)}}class bTe{constructor(e){this.persistence=e,this.xs=new H3(t=>B6(t),u9),this.lastRemoteSnapshotVersion=Ct.min(),this.highestTargetId=0,this.Ns=0,this.ks=new xO,this.targetCount=0,this.Ms=Q6.kn()}forEachTarget(e,t){return this.xs.forEach((n,i)=>t(i)),ce.resolve()}getLastRemoteSnapshotVersion(e){return ce.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ce.resolve(this.Ns)}allocateTargetId(e){return this.highestTargetId=this.Ms.next(),ce.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Ns&&(this.Ns=t),ce.resolve()}Fn(e){this.xs.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Ms=new Q6(t),this.highestTargetId=t),e.sequenceNumber>this.Ns&&(this.Ns=e.sequenceNumber)}addTargetData(e,t){return this.Fn(t),this.targetCount+=1,ce.resolve()}updateTargetData(e,t){return this.Fn(t),ce.resolve()}removeTargetData(e,t){return this.xs.delete(t.target),this.ks.Is(t.targetId),this.targetCount-=1,ce.resolve()}removeTargets(e,t,n){let i=0;const s=[];return this.xs.forEach((o,a)=>{a.sequenceNumber<=t&&null===n.get(a.targetId)&&(this.xs.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),ce.waitFor(s).next(()=>i)}getTargetCount(e){return ce.resolve(this.targetCount)}getTargetData(e,t){const n=this.xs.get(t)||null;return ce.resolve(n)}addMatchingKeys(e,t,n){return this.ks.gs(t,n),ce.resolve()}removeMatchingKeys(e,t,n){this.ks.ps(t,n);const i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),ce.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.ks.Is(t),ce.resolve()}getMatchingKeysForTargetId(e,t){const n=this.ks.Es(t);return ce.resolve(n)}containsKey(e,t){return ce.resolve(this.ks.containsKey(t))}}class LO{constructor(e,t){this.$s={},this.overlays={},this.Os=new uo(0),this.Fs=!1,this.Fs=!0,this.referenceDelegate=e(this),this.Bs=new bTe(this),this.indexManager=new dTe,this.remoteDocumentCache=new TTe(n=>this.referenceDelegate.Ls(n)),this.serializer=new EY(t),this.qs=new ETe(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Fs=!1,Promise.resolve()}get started(){return this.Fs}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new STe,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.$s[e.toKey()];return n||(n=new PTe(t,this.referenceDelegate),this.$s[e.toKey()]=n),n}getTargetCache(){return this.Bs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.qs}runTransaction(e,t,n){Oe("MemoryPersistence","Starting transaction:",e);const i=new wTe(this.Os.next());return this.referenceDelegate.Us(),n(i).next(s=>this.referenceDelegate.Ks(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Gs(e,t){return ce.or(Object.values(this.$s).map(n=>()=>n.containsKey(e,t)))}}class wTe extends YSe{constructor(e){super(),this.currentSequenceNumber=e}}class i_{constructor(e){this.persistence=e,this.Qs=new xO,this.js=null}static zs(e){return new i_(e)}get Ws(){if(this.js)return this.js;throw at()}addReference(e,t,n){return this.Qs.addReference(n,t),this.Ws.delete(n.toString()),ce.resolve()}removeReference(e,t,n){return this.Qs.removeReference(n,t),this.Ws.add(n.toString()),ce.resolve()}markPotentiallyOrphaned(e,t){return this.Ws.add(t.toString()),ce.resolve()}removeTarget(e,t){this.Qs.Is(t.targetId).forEach(i=>this.Ws.add(i.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.Ws.add(s.toString()))}).next(()=>n.removeTargetData(e,t))}Us(){this.js=new Set}Ks(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ce.forEach(this.Ws,n=>{const i=Be.fromPath(n);return this.Hs(e,i).next(s=>{s||t.removeEntry(i,Ct.min())})}).next(()=>(this.js=null,t.apply(e)))}updateLimboDocument(e,t){return this.Hs(e,t).next(n=>{n?this.Ws.delete(t.toString()):this.Ws.add(t.toString())})}Ls(e){return 0}Hs(e,t){return ce.or([()=>ce.resolve(this.Qs.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Gs(e,t)])}}class HO{constructor(e,t,n,i){this.targetId=e,this.fromCache=t,this.Fi=n,this.Bi=i}static Li(e,t){let n=nn(),i=nn();for(const s of t.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new HO(e,t.fromCache,n,i)}}class KY{constructor(){this.qi=!1}initialize(e,t){this.Ui=e,this.indexManager=t,this.qi=!0}getDocumentsMatchingQuery(e,t,n,i){return this.Ki(e,t).next(s=>s||this.Gi(e,t,i,n)).next(s=>s||this.Qi(e,t))}Ki(e,t){if(RZ(t))return ce.resolve(null);let n=us(t);return this.indexManager.getIndexType(e,n).next(i=>0===i?null:(null!==t.limit&&1===i&&(t=Um(t,null,"F"),n=us(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(s=>{const o=nn(...s);return this.Ui.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,n).next(c=>{const l=this.ji(t,a);return this.zi(t,l,o,c.readTime)?this.Ki(e,Um(t,null,"F")):this.Wi(e,l,t,c)}))})))}Gi(e,t,n,i){return RZ(t)||i.isEqual(Ct.min())?this.Qi(e,t):this.Ui.getDocuments(e,n).next(s=>{const o=this.ji(t,s);return this.zi(t,o,n,i)?this.Qi(e,t):(XT()<=Bn.DEBUG&&Oe("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),hO(t)),this.Wi(e,o,t,function tZ(r,e){const t=r.toTimestamp().seconds,n=r.toTimestamp().nanoseconds+1,i=Ct.fromTimestamp(1e9===n?new ar(t+1,0):new ar(t,n));return new lo(i,Be.empty(),e)}(i,-1)))})}ji(e,t){let n=new V1(HZ(e));return t.forEach((i,s)=>{d9(e,s)&&(n=n.add(s))}),n}zi(e,t,n,i){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const s="F"===e.limitType?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Qi(e,t){return XT()<=Bn.DEBUG&&Oe("QueryEngine","Using full collection scan to execute query:",hO(t)),this.Ui.getDocumentsMatchingQuery(e,t,lo.min())}Wi(e,t,n,i){return this.Ui.getDocumentsMatchingQuery(e,n,i).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}}class NTe{constructor(e,t,n,i){this.persistence=e,this.Hi=t,this.serializer=i,this.Ji=new x1(qt),this.Yi=new H3(s=>B6(s),u9),this.Xi=new Map,this.Zi=e.getRemoteDocumentCache(),this.Bs=e.getTargetCache(),this.qs=e.getBundleCache(),this.tr(n)}tr(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new ZY(this.Zi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Zi.setIndexManager(this.indexManager),this.Hi.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ji))}}function QY(r,e){return VO.apply(this,arguments)}function VO(){return VO=M(function*(r,e){const t=je(r);return yield t.persistence.runTransaction("Handle user change","readonly",n=>{let i;return t.mutationQueue.getAllMutationBatches(n).next(s=>(i=s,t.tr(e),t.mutationQueue.getAllMutationBatches(n))).next(s=>{const o=[],a=[];let c=nn();for(const l of i){o.push(l.batchId);for(const f of l.mutations)c=c.add(f.key)}for(const l of s){a.push(l.batchId);for(const f of l.mutations)c=c.add(f.key)}return t.localDocuments.getDocuments(n,c).next(l=>({er:l,removedBatchIds:o,addedBatchIds:a}))})})}),VO.apply(this,arguments)}function JY(r){const e=je(r);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Bs.getLastRemoteSnapshotVersion(t))}function xTe(r,e){const t=je(r);return t.persistence.runTransaction("Get next mutation batch","readonly",n=>(void 0===e&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function P5(r,e,t){return FO.apply(this,arguments)}function FO(){return FO=M(function*(r,e,t){const n=je(r),i=n.Ji.get(e),s=t?"readwrite":"readwrite-primary";try{t||(yield n.persistence.runTransaction("Release target",s,o=>n.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!X4(o))throw o;Oe("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}n.Ji=n.Ji.remove(e),n.Yi.delete(i.target)}),FO.apply(this,arguments)}function a_(r,e,t){const n=je(r);let i=Ct.min(),s=nn();return n.persistence.runTransaction("Execute query","readonly",o=>function(a,c,l){const f=je(a),d=f.Yi.get(l);return void 0!==d?ce.resolve(f.Ji.get(d)):f.Bs.getTargetData(c,l)}(n,o,us(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,n.Bs.getMatchingKeysForTargetId(o,a.targetId).next(c=>{s=c})}).next(()=>n.Hi.getDocumentsMatchingQuery(o,e,t?i:Ct.min(),t?s:nn())).next(a=>(function rK(r,e,t){let n=r.Xi.get(e)||Ct.min();t.forEach((i,s)=>{s.readTime.compareTo(n)>0&&(n=s.readTime)}),r.Xi.set(e,n)}(n,function DZ(r){return r.collectionGroup||(r.path.length%2==1?r.path.lastSegment():r.path.get(r.path.length-2))}(e),a),{documents:a,ir:s})))}class WO{constructor(){this.activeTargetIds=function pO(){return LPe}()}lr(e){this.activeTargetIds=this.activeTargetIds.add(e)}dr(e){this.activeTargetIds=this.activeTargetIds.delete(e)}hr(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class oK{constructor(){this.Hr=new WO,this.Jr={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return this.Hr.lr(e),this.Jr[e]||"not-current"}updateQueryState(e,t,n){this.Jr[e]=t}removeLocalQueryTarget(e){this.Hr.dr(e)}isLocalQueryTarget(e){return this.Hr.activeTargetIds.has(e)}clearQueryState(e){delete this.Jr[e]}getAllActiveQueryTargets(){return this.Hr.activeTargetIds}isActiveQueryTarget(e){return this.Hr.activeTargetIds.has(e)}start(){return this.Hr=new WO,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class zTe{Yr(e){}shutdown(){}}class aK{constructor(){this.Xr=()=>this.Zr(),this.eo=()=>this.no(),this.so=[],this.io()}Yr(e){this.so.push(e)}shutdown(){window.removeEventListener("online",this.Xr),window.removeEventListener("offline",this.eo)}io(){window.addEventListener("online",this.Xr),window.addEventListener("offline",this.eo)}Zr(){Oe("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.so)e(0)}no(){Oe("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.so)e(1)}static D(){return typeof window<"u"&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let u_=null;function jO(){return null===u_?u_=268435456+Math.round(2147483648*Math.random()):u_++,"0x"+u_.toString(16)}const DTe={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class HTe{constructor(e){this.ro=e.ro,this.oo=e.oo}uo(e){this.co=e}ao(e){this.ho=e}onMessage(e){this.lo=e}close(){this.oo()}send(e){this.ro(e)}fo(){this.co()}wo(e){this.ho(e)}_o(e){this.lo(e)}}const zi="WebChannelConnection";class VTe extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId,this.mo=(e.ssl?"https":"http")+"://"+e.host,this.yo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}get po(){return!1}Io(e,t,n,i,s){const o=jO(),a=this.To(e,t);Oe("RestConnection",`Sending RPC '${e}' ${o}:`,a,n);const c={};return this.Eo(c,i,s),this.Ao(e,a,c,n).then(l=>(Oe("RestConnection",`Received RPC '${e}' ${o}: `,l),l),l=>{throw Ta("RestConnection",`RPC '${e}' ${o} failed with error: `,l,"url: ",a,"request:",n),l})}vo(e,t,n,i,s,o){return this.Io(e,t,n,i,s)}Eo(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+c5,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((i,s)=>e[s]=i),n&&n.headers.forEach((i,s)=>e[s]=i)}To(e,t){return`${this.mo}/v1/${t}:${DTe[e]}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Ao(e,t,n,i){const s=jO();return new Promise((o,a)=>{const c=new DSe;c.setWithCredentials(!0),c.listenOnce(LSe.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case KT.NO_ERROR:const f=c.getResponseJson();Oe(zi,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(f)),o(f);break;case KT.TIMEOUT:Oe(zi,`RPC '${e}' ${s} timed out`),a(new Te(fe.DEADLINE_EXCEEDED,"Request time out"));break;case KT.HTTP_ERROR:const d=c.getStatus();if(Oe(zi,`RPC '${e}' ${s} failed with status:`,d,"response text:",c.getResponseText()),d>0){let m=c.getResponseJson();Array.isArray(m)&&(m=m[0]);const E=m?.error;if(E&&E.status&&E.message){const w=function(R){const z=R.toLowerCase().replace(/_/g,"-");return Object.values(fe).indexOf(z)>=0?z:fe.UNKNOWN}(E.status);a(new Te(w,E.message))}else a(new Te(fe.UNKNOWN,"Server responded with status "+c.getStatus()))}else a(new Te(fe.UNAVAILABLE,"Connection failed."));break;default:at()}}finally{Oe(zi,`RPC '${e}' ${s} completed.`)}});const l=JSON.stringify(i);Oe(zi,`RPC '${e}' ${s} sending request:`,i),c.send(t,"POST",l,n,15)})}Ro(e,t,n){const i=jO(),s=[this.mo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=kSe(),a=xSe(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;void 0!==l&&(c.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(c.xmlHttpFactory=new zSe({})),this.Eo(c.initMessageHeaders,t,n),c.encodeInitMessageHeaders=!0;const f=s.join("");Oe(zi,`Creating RPC '${e}' stream ${i}: ${f}`,c);const d=o.createWebChannel(f,c);let m=!1,E=!1;const w=new HTe({ro:z=>{E?Oe(zi,`Not sending because RPC '${e}' stream ${i} is closed:`,z):(m||(Oe(zi,`Opening RPC '${e}' stream ${i} transport.`),d.open(),m=!0),Oe(zi,`RPC '${e}' stream ${i} sending:`,z),d.send(z))},oo:()=>d.close()}),R=(z,$,G)=>{z.listen($,de=>{try{G(de)}catch(ve){setTimeout(()=>{throw ve},0)}})};return R(d,Nm.EventType.OPEN,()=>{E||Oe(zi,`RPC '${e}' stream ${i} transport opened.`)}),R(d,Nm.EventType.CLOSE,()=>{E||(E=!0,Oe(zi,`RPC '${e}' stream ${i} transport closed`),w.wo())}),R(d,Nm.EventType.ERROR,z=>{E||(E=!0,Ta(zi,`RPC '${e}' stream ${i} transport errored:`,z),w.wo(new Te(fe.UNAVAILABLE,"The operation could not be completed")))}),R(d,Nm.EventType.MESSAGE,z=>{var $;if(!E){const G=z.data[0];mt(!!G);const ve=G.error||(null===($=G[0])||void 0===$?void 0:$.error);if(ve){Oe(zi,`RPC '${e}' stream ${i} received error:`,ve);const Le=ve.status;let nt=function(vn){const Et=Qr[vn];if(void 0!==Et)return nY(Et)}(Le),gt=ve.message;void 0===nt&&(nt=fe.INTERNAL,gt="Unknown error status: "+Le+" with message "+ve.message),E=!0,w.wo(new Te(nt,gt)),d.close()}else Oe(zi,`RPC '${e}' stream ${i} received:`,G),w._o(G)}}),R(a,RSe.STAT_EVENT,z=>{z.stat===Yj.PROXY?Oe(zi,`RPC '${e}' stream ${i} detected buffering proxy`):z.stat===Yj.NOPROXY&&Oe(zi,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{w.fo()},0),w}}function f_(){return typeof document<"u"?document:null}function I9(r){return new ZPe(r,!0)}class ZO{constructor(e,t,n=1e3,i=1.5,s=6e4){this.ii=e,this.timerId=t,this.Po=n,this.bo=i,this.Vo=s,this.So=0,this.Do=null,this.Co=Date.now(),this.reset()}reset(){this.So=0}xo(){this.So=this.Vo}No(e){this.cancel();const t=Math.floor(this.So+this.ko()),n=Math.max(0,Date.now()-this.Co),i=Math.max(0,t-n);i>0&&Oe("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.So} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.Do=this.ii.enqueueAfterDelay(this.timerId,i,()=>(this.Co=Date.now(),e())),this.So*=this.bo,this.So<this.Po&&(this.So=this.Po),this.So>this.Vo&&(this.So=this.Vo)}Mo(){null!==this.Do&&(this.Do.skipDelay(),this.Do=null)}cancel(){null!==this.Do&&(this.Do.cancel(),this.Do=null)}ko(){return(Math.random()-.5)*this.So}}class lK{constructor(e,t,n,i,s,o,a,c){this.ii=e,this.$o=n,this.Oo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.Fo=0,this.Bo=null,this.Lo=null,this.stream=null,this.qo=new ZO(e,t)}Uo(){return 1===this.state||5===this.state||this.Ko()}Ko(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Go()}stop(){var e=this;return M(function*(){e.Uo()&&(yield e.close(0))})()}Qo(){this.state=0,this.qo.reset()}jo(){this.Ko()&&null===this.Bo&&(this.Bo=this.ii.enqueueAfterDelay(this.$o,6e4,()=>this.zo()))}Wo(e){this.Ho(),this.stream.send(e)}zo(){var e=this;return M(function*(){if(e.Ko())return e.close(0)})()}Ho(){this.Bo&&(this.Bo.cancel(),this.Bo=null)}Jo(){this.Lo&&(this.Lo.cancel(),this.Lo=null)}close(e,t){var n=this;return M(function*(){n.Ho(),n.Jo(),n.qo.cancel(),n.Fo++,4!==e?n.qo.reset():t&&t.code===fe.RESOURCE_EXHAUSTED?(Vr(t.toString()),Vr("Using maximum backoff delay to prevent overloading the backend."),n.qo.xo()):t&&t.code===fe.UNAUTHENTICATED&&3!==n.state&&(n.authCredentialsProvider.invalidateToken(),n.appCheckCredentialsProvider.invalidateToken()),null!==n.stream&&(n.Yo(),n.stream.close(),n.stream=null),n.state=e,yield n.listener.ao(t)})()}Yo(){}auth(){this.state=1;const e=this.Xo(this.Fo),t=this.Fo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.Fo===t&&this.Zo(n,i)},n=>{e(()=>{const i=new Te(fe.UNKNOWN,"Fetching auth token failed: "+n.message);return this.tu(i)})})}Zo(e,t){const n=this.Xo(this.Fo);this.stream=this.eu(e,t),this.stream.uo(()=>{n(()=>(this.state=2,this.Lo=this.ii.enqueueAfterDelay(this.Oo,1e4,()=>(this.Ko()&&(this.state=3),Promise.resolve())),this.listener.uo()))}),this.stream.ao(i=>{n(()=>this.tu(i))}),this.stream.onMessage(i=>{n(()=>this.onMessage(i))})}Go(){var e=this;this.state=5,this.qo.No(M(function*(){e.state=0,e.start()}))}tu(e){return Oe("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Xo(e){return t=>{this.ii.enqueueAndForget(()=>this.Fo===e?t():(Oe("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class FTe extends lK{constructor(e,t,n,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,i,o),this.serializer=s}eu(e,t){return this.connection.Ro("Listen",e,t)}onMessage(e){this.qo.reset();const t=function XPe(r,e){let t;if("targetChange"in e){const n="NO_CHANGE"===(c=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===c?1:"REMOVE"===c?2:"CURRENT"===c?3:"RESET"===c?4:at(),i=e.targetChange.targetIds||[],s=function(c,l){return c.useProto3Json?(mt(void 0===l||"string"==typeof l),f2.fromBase64String(l||"")):(mt(void 0===l||l instanceof Uint8Array),f2.fromUint8Array(l||new Uint8Array))}(r,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(c){const l=void 0===c.code?fe.UNKNOWN:nY(c.code);return new Te(l,c.message||"")}(o);t=new aY(n,i,s,a||null)}else if("documentChange"in e){const n=e.documentChange,i=Nc(r,n.document.name),s=$r(n.document.updateTime),o=n.document.createTime?$r(n.document.createTime):Ct.min(),a=new oi({mapValue:{fields:n.document.fields}}),c=F1.newFoundDocument(i,s,o,a);t=new Ym(n.targetIds||[],n.removedTargetIds||[],c.key,c)}else if("documentDelete"in e){const n=e.documentDelete,i=Nc(r,n.document),s=n.readTime?$r(n.readTime):Ct.min(),o=F1.newNoDocument(i,s);t=new Ym([],n.removedTargetIds||[],o.key,o)}else if("documentRemove"in e){const n=e.documentRemove,i=Nc(r,n.document);t=new Ym([],n.removedTargetIds||[],i,null)}else{if(!("filter"in e))return at();{const n=e.filter,{count:i=0,unchangedNames:s}=n,o=new GPe(i,s);t=new oY(n.targetId,o)}}var c;return t}(this.serializer,e),n=function(i){if(!("targetChange"in i))return Ct.min();const s=i.targetChange;return s.targetIds&&s.targetIds.length?Ct.min():s.readTime?$r(s.readTime):Ct.min()}(e);return this.listener.nu(t,n)}su(e){const t={};t.database=M9(this.serializer),t.addTarget=function(i,s){let o;const a=s.target;if(o=$m(a)?{documents:_Y(i,a)}:{query:TO(i,a)},o.targetId=s.targetId,s.resumeToken.approximateByteSize()>0){o.resumeToken=fY(i,s.resumeToken);const c=MO(i,s.expectedCount);null!==c&&(o.expectedCount=c)}else if(s.snapshotVersion.compareTo(Ct.min())>0){o.readTime=C5(i,s.snapshotVersion.toTimestamp());const c=MO(i,s.expectedCount);null!==c&&(o.expectedCount=c)}return o}(this.serializer,e);const n=function JPe(r,e){const t=function(n){switch(n){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return at()}}(e.purpose);return null==t?null:{"goog-listen-tags":t}}(0,e);n&&(t.labels=n),this.Wo(t)}iu(e){const t={};t.database=M9(this.serializer),t.removeTarget=e,this.Wo(t)}}class $Te extends lK{constructor(e,t,n,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,i,o),this.serializer=s,this.ru=!1}get ou(){return this.ru}start(){this.ru=!1,this.lastStreamToken=void 0,super.start()}Yo(){this.ru&&this.uu([])}eu(e,t){return this.connection.Ro("Write",e,t)}onMessage(e){if(mt(!!e.streamToken),this.lastStreamToken=e.streamToken,this.ru){this.qo.reset();const t=function QPe(r,e){return r&&r.length>0?(mt(void 0!==e),r.map(t=>function(n,i){let s=$r(n.updateTime?n.updateTime:i);return s.isEqual(Ct.min())&&(s=$r(i)),new HPe(s,n.transformResults||[])}(t,e))):[]}(e.writeResults,e.commitTime),n=$r(e.commitTime);return this.listener.cu(n,t)}return mt(!e.writeResults||0===e.writeResults.length),this.ru=!0,this.listener.au()}hu(){const e={};e.database=M9(this.serializer),this.Wo(e)}uu(e){const t={streamToken:this.lastStreamToken,writes:e.map(n=>function E9(r,e){let t;if(e instanceof _5)t={update:gY(r,e.key,e.value)};else if(e instanceof v5)t={delete:y9(r,e.key)};else if(e instanceof V3)t={update:gY(r,e.key,e.data),updateMask:rTe(e.fieldMask)};else{if(!(e instanceof gO))return at();t={verify:y9(r,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(n=>function(i,s){const o=s.transform;if(o instanceof g5)return{fieldPath:s.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof W6)return{fieldPath:s.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof q6)return{fieldPath:s.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof m5)return{fieldPath:s.field.canonicalString(),increment:o.gt};throw at()}(0,n))),e.precondition.isNone||(t.currentDocument=void 0!==(i=e.precondition).updateTime?{updateTime:YPe(r,i.updateTime)}:void 0!==i.exists?{exists:i.exists}:at()),t;var i}(this.serializer,n))};this.Wo(t)}}class GTe extends class{}{constructor(e,t,n,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=i,this.lu=!1}fu(){if(this.lu)throw new Te(fe.FAILED_PRECONDITION,"The client has already been terminated.")}Io(e,t,n){return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,s])=>this.connection.Io(e,t,n,i,s)).catch(i=>{throw"FirebaseError"===i.name?(i.code===fe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Te(fe.UNKNOWN,i.toString())})}vo(e,t,n,i){return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.vo(e,t,n,s,o,i)).catch(s=>{throw"FirebaseError"===s.name?(s.code===fe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Te(fe.UNKNOWN,s.toString())})}terminate(){this.lu=!0}}class UTe{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.wu=0,this._u=null,this.mu=!0}gu(){0===this.wu&&(this.yu("Unknown"),this._u=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._u=null,this.pu("Backend didn't respond within 10 seconds."),this.yu("Offline"),Promise.resolve())))}Iu(e){"Online"===this.state?this.yu("Unknown"):(this.wu++,this.wu>=1&&(this.Tu(),this.pu(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.yu("Offline")))}set(e){this.Tu(),this.wu=0,"Online"===e&&(this.mu=!1),this.yu(e)}yu(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}pu(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.mu?(Vr(t),this.mu=!1):Oe("OnlineStateTracker",t)}Tu(){null!==this._u&&(this._u.cancel(),this._u=null)}}class WTe{constructor(e,t,n,i,s){var o=this;this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Eu=[],this.Au=new Map,this.vu=new Set,this.Ru=[],this.Pu=s,this.Pu.Yr(a=>{n.enqueueAndForget(M(function*(){var c;cl(o)&&(Oe("RemoteStore","Restarting streams for network reachability change."),yield(c=M(function*(l){const f=je(l);f.vu.add(4),yield T5(f),f.bu.set("Unknown"),f.vu.delete(4),yield k9(f)}),function(l){return c.apply(this,arguments)})(o))}))}),this.bu=new UTe(n,i)}}function k9(r){return KO.apply(this,arguments)}function KO(){return KO=M(function*(r){if(cl(r))for(const e of r.Ru)yield e(!0)}),KO.apply(this,arguments)}function T5(r){return XO.apply(this,arguments)}function XO(){return XO=M(function*(r){for(const e of r.Ru)yield e(!1)}),XO.apply(this,arguments)}function d_(r,e){const t=je(r);t.Au.has(e.targetId)||(t.Au.set(e.targetId,e),eb(t)?JO(t):b5(t).Ko()&&QO(t,e))}function x9(r,e){const t=je(r),n=b5(t);t.Au.delete(e),n.Ko()&&uK(t,e),0===t.Au.size&&(n.Ko()?n.jo():cl(t)&&t.bu.set("Unknown"))}function QO(r,e){if(r.Vu.qt(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ct.min())>0){const t=r.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}b5(r).su(e)}function uK(r,e){r.Vu.qt(e),b5(r).iu(e)}function JO(r){r.Vu=new UPe({getRemoteKeysForTarget:e=>r.remoteSyncer.getRemoteKeysForTarget(e),le:e=>r.Au.get(e)||null,ue:()=>r.datastore.serializer.databaseId}),b5(r).start(),r.bu.gu()}function eb(r){return cl(r)&&!b5(r).Uo()&&r.Au.size>0}function cl(r){return 0===je(r).vu.size}function fK(r){r.Vu=void 0}function qTe(r){return tb.apply(this,arguments)}function tb(){return tb=M(function*(r){r.Au.forEach((e,t)=>{QO(r,e)})}),tb.apply(this,arguments)}function jTe(r,e){return nb.apply(this,arguments)}function nb(){return nb=M(function*(r,e){fK(r),eb(r)?(r.bu.Iu(e),JO(r)):r.bu.set("Unknown")}),nb.apply(this,arguments)}function ZTe(r,e,t){return rb.apply(this,arguments)}function rb(){return rb=M(function*(r,e,t){if(r.bu.set("Online"),e instanceof aY&&2===e.state&&e.cause)try{yield(n=M(function*(i,s){const o=s.cause;for(const a of s.targetIds)i.Au.has(a)&&(yield i.remoteSyncer.rejectListen(a,o),i.Au.delete(a),i.Vu.removeTarget(a))}),function(i,s){return n.apply(this,arguments)})(r,e)}catch(n){Oe("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),yield h_(r,n)}else if(e instanceof Ym?r.Vu.Ht(e):e instanceof oY?r.Vu.ne(e):r.Vu.Xt(e),!t.isEqual(Ct.min()))try{const n=yield JY(r.localStore);t.compareTo(n)>=0&&(yield function(i,s){const o=i.Vu.ce(s);return o.targetChanges.forEach((a,c)=>{if(a.resumeToken.approximateByteSize()>0){const l=i.Au.get(c);l&&i.Au.set(c,l.withResumeToken(a.resumeToken,s))}}),o.targetMismatches.forEach((a,c)=>{const l=i.Au.get(a);if(!l)return;i.Au.set(a,l.withResumeToken(f2.EMPTY_BYTE_STRING,l.snapshotVersion)),uK(i,a);const f=new F3(l.target,a,c,l.sequenceNumber);QO(i,f)}),i.remoteSyncer.applyRemoteEvent(o)}(r,t))}catch(n){Oe("RemoteStore","Failed to raise snapshot:",n),yield h_(r,n)}var n}),rb.apply(this,arguments)}function h_(r,e,t){return ib.apply(this,arguments)}function ib(){return ib=M(function*(r,e,t){if(!X4(e))throw e;r.vu.add(1),yield T5(r),r.bu.set("Offline"),t||(t=()=>JY(r.localStore)),r.asyncQueue.enqueueRetryable(M(function*(){Oe("RemoteStore","Retrying IndexedDB access"),yield t(),r.vu.delete(1),yield k9(r)}))}),ib.apply(this,arguments)}function dK(r,e){return e().catch(t=>h_(r,t,e))}function O5(r){return sb.apply(this,arguments)}function sb(){return sb=M(function*(r){const e=je(r),t=ll(e);let n=e.Eu.length>0?e.Eu[e.Eu.length-1].batchId:-1;for(;YTe(e);)try{const i=yield xTe(e.localStore,n);if(null===i){0===e.Eu.length&&t.jo();break}n=i.batchId,KTe(e,i)}catch(i){yield h_(e,i)}hK(e)&&pK(e)}),sb.apply(this,arguments)}function YTe(r){return cl(r)&&r.Eu.length<10}function KTe(r,e){r.Eu.push(e);const t=ll(r);t.Ko()&&t.ou&&t.uu(e.mutations)}function hK(r){return cl(r)&&!ll(r).Uo()&&r.Eu.length>0}function pK(r){ll(r).start()}function XTe(r){return ob.apply(this,arguments)}function ob(){return ob=M(function*(r){ll(r).hu()}),ob.apply(this,arguments)}function QTe(r){return ab.apply(this,arguments)}function ab(){return ab=M(function*(r){const e=ll(r);for(const t of r.Eu)e.uu(t.mutations)}),ab.apply(this,arguments)}function JTe(r,e,t){return cb.apply(this,arguments)}function cb(){return cb=M(function*(r,e,t){const n=r.Eu.shift(),i=_O.from(n,e,t);yield dK(r,()=>r.remoteSyncer.applySuccessfulWrite(i)),yield O5(r)}),cb.apply(this,arguments)}function eOe(r,e){return lb.apply(this,arguments)}function lb(){return lb=M(function*(r,e){var t;e&&ll(r).ou&&(yield(t=M(function*(n,i){if(function tY(r){switch(r){default:return at();case fe.CANCELLED:case fe.UNKNOWN:case fe.DEADLINE_EXCEEDED:case fe.RESOURCE_EXHAUSTED:case fe.INTERNAL:case fe.UNAVAILABLE:case fe.UNAUTHENTICATED:return!1;case fe.INVALID_ARGUMENT:case fe.NOT_FOUND:case fe.ALREADY_EXISTS:case fe.PERMISSION_DENIED:case fe.FAILED_PRECONDITION:case fe.ABORTED:case fe.OUT_OF_RANGE:case fe.UNIMPLEMENTED:case fe.DATA_LOSS:return!0}}(s=i.code)&&s!==fe.ABORTED){const o=n.Eu.shift();ll(n).Qo(),yield dK(n,()=>n.remoteSyncer.rejectFailedWrite(o.batchId,i)),yield O5(n)}var s}),function(n,i){return t.apply(this,arguments)})(r,e)),hK(r)&&pK(r)}),lb.apply(this,arguments)}function gK(r,e){return ub.apply(this,arguments)}function ub(){return ub=M(function*(r,e){const t=je(r);t.asyncQueue.verifyOperationInProgress(),Oe("RemoteStore","RemoteStore received new credentials");const n=cl(t);t.vu.add(3),yield T5(t),n&&t.bu.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.vu.delete(3),yield k9(t)}),ub.apply(this,arguments)}function db(){return db=M(function*(r,e){const t=je(r);e?(t.vu.delete(2),yield k9(t)):e||(t.vu.add(2),yield T5(t),t.bu.set("Unknown"))}),db.apply(this,arguments)}function b5(r){return r.Su||(r.Su=function(e,t,n){const i=je(e);return i.fu(),new FTe(t,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,n)}(r.datastore,r.asyncQueue,{uo:qTe.bind(null,r),ao:jTe.bind(null,r),nu:ZTe.bind(null,r)}),r.Ru.push(function(){var e=M(function*(t){t?(r.Su.Qo(),eb(r)?JO(r):r.bu.set("Unknown")):(yield r.Su.stop(),fK(r))});return function(t){return e.apply(this,arguments)}}())),r.Su}function ll(r){return r.Du||(r.Du=function(e,t,n){const i=je(e);return i.fu(),new $Te(t,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,n)}(r.datastore,r.asyncQueue,{uo:XTe.bind(null,r),ao:eOe.bind(null,r),au:QTe.bind(null,r),cu:JTe.bind(null,r)}),r.Ru.push(function(){var e=M(function*(t){t?(r.Du.Qo(),yield O5(r)):(yield r.Du.stop(),r.Eu.length>0&&(Oe("RemoteStore",`Stopping write stream with ${r.Eu.length} pending writes`),r.Eu=[]))});return function(t){return e.apply(this,arguments)}}())),r.Du}class hb{constructor(e,t,n,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=i,this.removalCallback=s,this.deferred=new u2,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}static createAndSchedule(e,t,n,i,s){const o=Date.now()+n,a=new hb(e,t,o,i,s);return a.start(n),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Te(fe.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function w5(r,e){if(Vr("AsyncQueue",`${e}: ${r}`),X4(r))return new Te(fe.UNAVAILABLE,`${e}: ${r}`);throw r}class A5{constructor(e){this.comparator=e?(t,n)=>e(t,n)||Be.comparator(t.key,n.key):(t,n)=>Be.comparator(t.key,n.key),this.keyedMap=h9(),this.sortedSet=new x1(this.comparator)}static emptySet(e){return new A5(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof A5)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=n.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new A5;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class mK{constructor(){this.Cu=new x1(Be.comparator)}track(e){const t=e.doc.key,n=this.Cu.get(t);n?0!==e.type&&3===n.type?this.Cu=this.Cu.insert(t,e):3===e.type&&1!==n.type?this.Cu=this.Cu.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.Cu=this.Cu.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.Cu=this.Cu.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.Cu=this.Cu.remove(t):1===e.type&&2===n.type?this.Cu=this.Cu.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.Cu=this.Cu.insert(t,{type:2,doc:e.doc}):at():this.Cu=this.Cu.insert(t,e)}xu(){const e=[];return this.Cu.inorderTraversal((t,n)=>{e.push(n)}),e}}class N5{constructor(e,t,n,i,s,o,a,c,l){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=l}static fromInitialDocuments(e,t,n,i,s){const o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new N5(e,t,A5.emptySet(t),o,n,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&f9(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==n[i].type||!t[i].doc.isEqual(n[i].doc))return!1;return!0}}class tOe{constructor(){this.Nu=void 0,this.listeners=[]}}class nOe{constructor(){this.queries=new H3(e=>zZ(e),f9),this.onlineState="Unknown",this.ku=new Set}}function pb(r,e){return gb.apply(this,arguments)}function gb(){return gb=M(function*(r,e){const t=je(r),n=e.query;let i=!1,s=t.queries.get(n);if(s||(i=!0,s=new tOe),i)try{s.Nu=yield t.onListen(n)}catch(o){const a=w5(o,`Initialization of query '${hO(e.query)}' failed`);return void e.onError(a)}t.queries.set(n,s),s.listeners.push(e),e.Mu(t.onlineState),s.Nu&&e.$u(s.Nu)&&vb(t)}),gb.apply(this,arguments)}function mb(r,e){return _b.apply(this,arguments)}function _b(){return _b=M(function*(r,e){const t=je(r),n=e.query;let i=!1;const s=t.queries.get(n);if(s){const o=s.listeners.indexOf(e);o>=0&&(s.listeners.splice(o,1),i=0===s.listeners.length)}if(i)return t.queries.delete(n),t.onUnlisten(n)}),_b.apply(this,arguments)}function rOe(r,e){const t=je(r);let n=!1;for(const i of e){const o=t.queries.get(i.query);if(o){for(const a of o.listeners)a.$u(i)&&(n=!0);o.Nu=i}}n&&vb(t)}function iOe(r,e,t){const n=je(r),i=n.queries.get(e);if(i)for(const s of i.listeners)s.onError(t);n.queries.delete(e)}function vb(r){r.ku.forEach(e=>{e.next()})}class Cb{constructor(e,t,n){this.query=e,this.Ou=t,this.Fu=!1,this.Bu=null,this.onlineState="Unknown",this.options=n||{}}$u(e){if(!this.options.includeMetadataChanges){const n=[];for(const i of e.docChanges)3!==i.type&&n.push(i);e=new N5(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Fu?this.Lu(e)&&(this.Ou.next(e),t=!0):this.qu(e,this.onlineState)&&(this.Uu(e),t=!0),this.Bu=e,t}onError(e){this.Ou.error(e)}Mu(e){this.onlineState=e;let t=!1;return this.Bu&&!this.Fu&&this.qu(this.Bu,e)&&(this.Uu(this.Bu),t=!0),t}qu(e,t){return!e.fromCache||(!this.options.Ku||!("Offline"!==t))&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}Lu(e){return e.docChanges.length>0||!!(e.syncStateChanged||this.Bu&&this.Bu.hasPendingWrites!==e.hasPendingWrites)&&!0===this.options.includeMetadataChanges}Uu(e){e=N5.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Fu=!0,this.Ou.next(e)}}class CK{constructor(e){this.key=e}}class yK{constructor(e){this.key=e}}class MK{constructor(e,t){this.query=e,this.Yu=t,this.Xu=null,this.hasCachedResults=!1,this.current=!1,this.Zu=nn(),this.mutatedKeys=nn(),this.tc=HZ(e),this.ec=new A5(this.tc)}get nc(){return this.Yu}sc(e,t){const n=t?t.ic:new mK,i=t?t.ec:this.ec;let s=t?t.mutatedKeys:this.mutatedKeys,o=i,a=!1;const c="F"===this.query.limitType&&i.size===this.query.limit?i.last():null,l="L"===this.query.limitType&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((f,d)=>{const m=i.get(f),E=d9(this.query,d)?d:null,w=!!m&&this.mutatedKeys.has(m.key),R=!!E&&(E.hasLocalMutations||this.mutatedKeys.has(E.key)&&E.hasCommittedMutations);let z=!1;m&&E?m.data.isEqual(E.data)?w!==R&&(n.track({type:3,doc:E}),z=!0):this.rc(m,E)||(n.track({type:2,doc:E}),z=!0,(c&&this.tc(E,c)>0||l&&this.tc(E,l)<0)&&(a=!0)):!m&&E?(n.track({type:0,doc:E}),z=!0):m&&!E&&(n.track({type:1,doc:m}),z=!0,(c||l)&&(a=!0)),z&&(E?(o=o.add(E),s=R?s.add(f):s.delete(f)):(o=o.delete(f),s=s.delete(f)))}),null!==this.query.limit)for(;o.size>this.query.limit;){const f="F"===this.query.limitType?o.last():o.first();o=o.delete(f.key),s=s.delete(f.key),n.track({type:1,doc:f})}return{ec:o,ic:n,zi:a,mutatedKeys:s}}rc(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n){const i=this.ec;this.ec=e.ec,this.mutatedKeys=e.mutatedKeys;const s=e.ic.xu();s.sort((l,f)=>function(d,m){const E=w=>{switch(w){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return at()}};return E(d)-E(m)}(l.type,f.type)||this.tc(l.doc,f.doc)),this.oc(n);const o=t?this.uc():[],a=0===this.Zu.size&&this.current?1:0,c=a!==this.Xu;return this.Xu=a,0!==s.length||c?{snapshot:new N5(this.query,e.ec,i,s,e.mutatedKeys,0===a,c,!1,!!n&&n.resumeToken.approximateByteSize()>0),cc:o}:{cc:o}}Mu(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({ec:this.ec,ic:new mK,mutatedKeys:this.mutatedKeys,zi:!1},!1)):{cc:[]}}ac(e){return!this.Yu.has(e)&&!!this.ec.has(e)&&!this.ec.get(e).hasLocalMutations}oc(e){e&&(e.addedDocuments.forEach(t=>this.Yu=this.Yu.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Yu=this.Yu.delete(t)),this.current=e.current)}uc(){if(!this.current)return[];const e=this.Zu;this.Zu=nn(),this.ec.forEach(n=>{this.ac(n.key)&&(this.Zu=this.Zu.add(n.key))});const t=[];return e.forEach(n=>{this.Zu.has(n)||t.push(new yK(n))}),this.Zu.forEach(n=>{e.has(n)||t.push(new CK(n))}),t}hc(e){this.Yu=e.ir,this.Zu=nn();const t=this.sc(e.documents);return this.applyChanges(t,!0)}lc(){return N5.fromInitialDocuments(this.query,this.ec,this.mutatedKeys,0===this.Xu,this.hasCachedResults)}}class aOe{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class cOe{constructor(e){this.key=e,this.fc=!1}}class lOe{constructor(e,t,n,i,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.dc={},this.wc=new H3(a=>zZ(a),f9),this._c=new Map,this.mc=new Set,this.gc=new x1(Be.comparator),this.yc=new Map,this.Ic=new xO,this.Tc={},this.Ec=new Map,this.Ac=Q6.Mn(),this.onlineState="Unknown",this.vc=void 0}get isPrimaryClient(){return!0===this.vc}}function uOe(r,e){return yb.apply(this,arguments)}function yb(){return yb=M(function*(r,e){const t=function Bb(r){const e=je(r);return e.remoteStore.remoteSyncer.applyRemoteEvent=EK.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=COe.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=hOe.bind(null,e),e.dc.nu=rOe.bind(null,e.eventManager),e.dc.Pc=iOe.bind(null,e.eventManager),e}(r);let n,i;const s=t.wc.get(e);if(s)n=s.targetId,t.sharedClientState.addLocalQueryTarget(n),i=s.view.lc();else{const o=yield function S5(r,e){const t=je(r);return t.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return t.Bs.getTargetData(n,e).next(s=>s?(i=s,ce.resolve(i)):t.Bs.allocateTargetId(n).next(o=>(i=new F3(e,o,"TargetPurposeListen",n.currentSequenceNumber),t.Bs.addTargetData(n,i).next(()=>i))))}).then(n=>{const i=t.Ji.get(n.targetId);return(null===i||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Ji=t.Ji.insert(n.targetId,n),t.Yi.set(e,n.targetId)),n})}(t.localStore,us(e)),a=t.sharedClientState.addLocalQueryTarget(o.targetId);n=o.targetId,i=yield function Mb(r,e,t,n,i){return Eb.apply(this,arguments)}(t,e,n,"current"===a,o.resumeToken),t.isPrimaryClient&&d_(t.remoteStore,o)}return i}),yb.apply(this,arguments)}function Eb(){return Eb=M(function*(r,e,t,n,i){r.Rc=(d,m,E)=>{return(w=M(function*(R,z,$,G){let de=z.view.sc($);de.zi&&(de=yield a_(R.localStore,z.query,!1).then(({documents:nt})=>z.view.sc(nt,de)));const ve=G&&G.targetChanges.get(z.targetId),Le=z.view.applyChanges(de,R.isPrimaryClient,ve);return kb(R,z.targetId,Le.cc),Le.snapshot}),function(R,z,$,G){return w.apply(this,arguments)})(r,d,m,E);var w};const s=yield a_(r.localStore,e,!0),o=new MK(e,s.ir),a=o.sc(s.documents),c=C9.createSynthesizedTargetChangeForCurrentChange(t,n&&"Offline"!==r.onlineState,i),l=o.applyChanges(a,r.isPrimaryClient,c);kb(r,t,l.cc);const f=new aOe(e,t,o);return r.wc.set(e,f),r._c.has(t)?r._c.get(t).push(e):r._c.set(t,[e]),l.snapshot}),Eb.apply(this,arguments)}function fOe(r,e){return Sb.apply(this,arguments)}function Sb(){return Sb=M(function*(r,e){const t=je(r),n=t.wc.get(e),i=t._c.get(n.targetId);if(i.length>1)return t._c.set(n.targetId,i.filter(s=>!f9(s,e))),void t.wc.delete(e);t.isPrimaryClient?(t.sharedClientState.removeLocalQueryTarget(n.targetId),t.sharedClientState.isActiveQueryTarget(n.targetId)||(yield P5(t.localStore,n.targetId,!1).then(()=>{t.sharedClientState.clearQueryState(n.targetId),x9(t.remoteStore,n.targetId),I5(t,n.targetId)}).catch(K4))):(I5(t,n.targetId),yield P5(t.localStore,n.targetId,!0))}),Sb.apply(this,arguments)}function Pb(){return Pb=M(function*(r,e,t){const n=function Ub(r){const e=je(r);return e.remoteStore.remoteSyncer.applySuccessfulWrite=pOe.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=gOe.bind(null,e),e}(r);try{const i=yield function(s,o){const a=je(s),c=ar.now(),l=o.reduce((m,E)=>m.add(E.key),nn());let f,d;return a.persistence.runTransaction("Locally write mutations","readwrite",m=>{let E=Rs(),w=nn();return a.Zi.getEntries(m,l).next(R=>{E=R,E.forEach((z,$)=>{$.isValidDocument()||(w=w.add(z))})}).next(()=>a.localDocuments.getOverlayedDocuments(m,E)).next(R=>{f=R;const z=[];for(const $ of o){const G=FPe($,f.get($.key).overlayedDocument);null!=G&&z.push(new V3($.key,G,EZ(G.value.mapValue),J1.exists(!0)))}return a.mutationQueue.addMutationBatch(m,c,z,o)}).next(R=>{d=R;const z=R.applyToLocalDocumentSet(f,w);return a.documentOverlayCache.saveOverlays(m,R.batchId,z)})}).then(()=>({batchId:d.batchId,changes:FZ(f)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),function(s,o,a){let c=s.Tc[s.currentUser.toKey()];c||(c=new x1(qt)),c=c.insert(o,a),s.Tc[s.currentUser.toKey()]=c}(n,i.batchId,t),yield $3(n,i.changes),yield O5(n.remoteStore)}catch(i){const s=w5(i,"Failed to persist write");t.reject(s)}}),Pb.apply(this,arguments)}function EK(r,e){return Tb.apply(this,arguments)}function Tb(){return Tb=M(function*(r,e){const t=je(r);try{const n=yield function kTe(r,e){const t=je(r),n=e.snapshotVersion;let i=t.Ji;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=t.Zi.newChangeBuffer({trackRemovals:!0});i=t.Ji;const a=[];e.targetChanges.forEach((f,d)=>{const m=i.get(d);if(!m)return;a.push(t.Bs.removeMatchingKeys(s,f.removedDocuments,d).next(()=>t.Bs.addMatchingKeys(s,f.addedDocuments,d)));let E=m.withSequenceNumber(s.currentSequenceNumber);var w,R,z;null!==e.targetMismatches.get(d)?E=E.withResumeToken(f2.EMPTY_BYTE_STRING,Ct.min()).withLastLimboFreeSnapshotVersion(Ct.min()):f.resumeToken.approximateByteSize()>0&&(E=E.withResumeToken(f.resumeToken,n)),i=i.insert(d,E),R=E,z=f,(0===(w=m).resumeToken.approximateByteSize()||R.snapshotVersion.toMicroseconds()-w.snapshotVersion.toMicroseconds()>=3e8||z.addedDocuments.size+z.modifiedDocuments.size+z.removedDocuments.size>0)&&a.push(t.Bs.updateTargetData(s,E))});let c=Rs(),l=nn();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(s,f))}),a.push(function eK(r,e,t){let n=nn(),i=nn();return t.forEach(s=>n=n.add(s)),e.getEntries(r,n).next(s=>{let o=Rs();return t.forEach((a,c)=>{const l=s.get(a);c.isFoundDocument()!==l.isFoundDocument()&&(i=i.add(a)),c.isNoDocument()&&c.version.isEqual(Ct.min())?(e.removeEntry(a,c.readTime),o=o.insert(a,c)):!l.isValidDocument()||c.version.compareTo(l.version)>0||0===c.version.compareTo(l.version)&&l.hasPendingWrites?(e.addEntry(c),o=o.insert(a,c)):Oe("LocalStore","Ignoring outdated watch update for ",a,". Current version:",l.version," Watch version:",c.version)}),{nr:o,sr:i}})}(s,o,e.documentUpdates).next(f=>{c=f.nr,l=f.sr})),!n.isEqual(Ct.min())){const f=t.Bs.getLastRemoteSnapshotVersion(s).next(d=>t.Bs.setTargetsMetadata(s,s.currentSequenceNumber,n));a.push(f)}return ce.waitFor(a).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,c,l)).next(()=>c)}).then(s=>(t.Ji=i,s))}(t.localStore,e);e.targetChanges.forEach((i,s)=>{const o=t.yc.get(s);o&&(mt(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.fc=!0:i.modifiedDocuments.size>0?mt(o.fc):i.removedDocuments.size>0&&(mt(o.fc),o.fc=!1))}),yield $3(t,n,e)}catch(n){yield K4(n)}}),Tb.apply(this,arguments)}function SK(r,e,t){const n=je(r);if(n.isPrimaryClient&&0===t||!n.isPrimaryClient&&1===t){const i=[];n.wc.forEach((s,o)=>{const a=o.view.Mu(e);a.snapshot&&i.push(a.snapshot)}),function(s,o){const a=je(s);a.onlineState=o;let c=!1;a.queries.forEach((l,f)=>{for(const d of f.listeners)d.Mu(o)&&(c=!0)}),c&&vb(a)}(n.eventManager,e),i.length&&n.dc.nu(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}function hOe(r,e,t){return Ob.apply(this,arguments)}function Ob(){return Ob=M(function*(r,e,t){const n=je(r);n.sharedClientState.updateQueryState(e,"rejected",t);const i=n.yc.get(e),s=i&&i.key;if(s){let o=new x1(Be.comparator);o=o.insert(s,F1.newNoDocument(s,Ct.min()));const a=nn().add(s),c=new v9(Ct.min(),new Map,new x1(qt),o,a);yield EK(n,c),n.gc=n.gc.remove(s),n.yc.delete(e),xb(n)}else yield P5(n.localStore,e,!1).then(()=>I5(n,e,t)).catch(K4)}),Ob.apply(this,arguments)}function pOe(r,e){return bb.apply(this,arguments)}function bb(){return bb=M(function*(r,e){const t=je(r),n=e.batch.batchId;try{const i=yield function ITe(r,e){const t=je(r);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const i=e.batch.keys(),s=t.Zi.newChangeBuffer({trackRemovals:!0});return function(o,a,c,l){const f=c.batch,d=f.keys();let m=ce.resolve();return d.forEach(E=>{m=m.next(()=>l.getEntry(a,E)).next(w=>{const R=c.docVersions.get(E);mt(null!==R),w.version.compareTo(R)<0&&(f.applyToRemoteDocument(w,c),w.isValidDocument()&&(w.setReadTime(c.commitVersion),l.addEntry(w)))})}),m.next(()=>o.mutationQueue.removeMutationBatch(a,f))}(t,n,e,s).next(()=>s.apply(n)).next(()=>t.mutationQueue.performConsistencyCheck(n)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(o){let a=nn();for(let c=0;c<o.mutationResults.length;++c)o.mutationResults[c].transformResults.length>0&&(a=a.add(o.batch.mutations[c].key));return a}(e))).next(()=>t.localDocuments.getDocuments(n,i))})}(t.localStore,e);Ib(t,n,null),Nb(t,n),t.sharedClientState.updateMutationState(n,"acknowledged"),yield $3(t,i)}catch(i){yield K4(i)}}),bb.apply(this,arguments)}function gOe(r,e,t){return wb.apply(this,arguments)}function wb(){return wb=M(function*(r,e,t){const n=je(r);try{const i=yield function(s,o){const a=je(s);return a.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let l;return a.mutationQueue.lookupMutationBatch(c,o).next(f=>(mt(null!==f),l=f.keys(),a.mutationQueue.removeMutationBatch(c,f))).next(()=>a.mutationQueue.performConsistencyCheck(c)).next(()=>a.documentOverlayCache.removeOverlaysForBatchId(c,l,o)).next(()=>a.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,l)).next(()=>a.localDocuments.getDocuments(c,l))})}(n.localStore,e);Ib(n,e,t),Nb(n,e),n.sharedClientState.updateMutationState(e,"rejected",t),yield $3(n,i)}catch(i){yield K4(i)}}),wb.apply(this,arguments)}function Nb(r,e){(r.Ec.get(e)||[]).forEach(t=>{t.resolve()}),r.Ec.delete(e)}function Ib(r,e,t){const n=je(r);let i=n.Tc[n.currentUser.toKey()];if(i){const s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),n.Tc[n.currentUser.toKey()]=i}}function I5(r,e,t=null){r.sharedClientState.removeLocalQueryTarget(e);for(const n of r._c.get(e))r.wc.delete(n),t&&r.dc.Pc(n,t);r._c.delete(e),r.isPrimaryClient&&r.Ic.Is(e).forEach(n=>{r.Ic.containsKey(n)||PK(r,n)})}function PK(r,e){r.mc.delete(e.path.canonicalString());const t=r.gc.get(e);null!==t&&(x9(r.remoteStore,t),r.gc=r.gc.remove(e),r.yc.delete(t),xb(r))}function kb(r,e,t){for(const n of t)n instanceof CK?(r.Ic.addReference(n.key,e),_Oe(r,n)):n instanceof yK?(Oe("SyncEngine","Document no longer in limbo: "+n.key),r.Ic.removeReference(n.key,e),r.Ic.containsKey(n.key)||PK(r,n.key)):at()}function _Oe(r,e){const t=e.key,n=t.path.canonicalString();r.gc.get(t)||r.mc.has(n)||(Oe("SyncEngine","New document in limbo: "+t),r.mc.add(n),xb(r))}function xb(r){for(;r.mc.size>0&&r.gc.size<r.maxConcurrentLimboResolutions;){const e=r.mc.values().next().value;r.mc.delete(e);const t=new Be(Dn.fromString(e)),n=r.Ac.next();r.yc.set(n,new cOe(t)),r.gc=r.gc.insert(t,n),d_(r.remoteStore,new F3(us(p5(t.path)),n,"TargetPurposeLimboResolution",uo.ct))}}function $3(r,e,t){return Lb.apply(this,arguments)}function Lb(){return Lb=M(function*(r,e,t){const n=je(r),i=[],s=[],o=[];var a;n.wc.isEmpty()||(n.wc.forEach((a,c)=>{o.push(n.Rc(c,e,t).then(l=>{if((l||t)&&n.isPrimaryClient&&n.sharedClientState.updateQueryState(c.targetId,l?.fromCache?"not-current":"current"),l){i.push(l);const f=HO.Li(c.targetId,l);s.push(f)}}))}),yield Promise.all(o),n.dc.nu(i),yield(a=M(function*(c,l){const f=je(c);try{yield f.persistence.runTransaction("notifyLocalViewChanges","readwrite",d=>ce.forEach(l,m=>ce.forEach(m.Fi,E=>f.persistence.referenceDelegate.addReference(d,m.targetId,E)).next(()=>ce.forEach(m.Bi,E=>f.persistence.referenceDelegate.removeReference(d,m.targetId,E)))))}catch(d){if(!X4(d))throw d;Oe("LocalStore","Failed to update sequence numbers: "+d)}for(const d of l){const m=d.targetId;if(!d.fromCache){const E=f.Ji.get(m),R=E.withLastLimboFreeSnapshotVersion(E.snapshotVersion);f.Ji=f.Ji.insert(m,R)}}}),function(c,l){return a.apply(this,arguments)})(n.localStore,s))}),Lb.apply(this,arguments)}function vOe(r,e){return Rb.apply(this,arguments)}function Rb(){return Rb=M(function*(r,e){const t=je(r);if(!t.currentUser.isEqual(e)){Oe("SyncEngine","User change. New user:",e.toKey());const n=yield QY(t.localStore,e);t.currentUser=e,(i=t).Ec.forEach(o=>{o.forEach(a=>{a.reject(new Te(fe.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),i.Ec.clear(),t.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),yield $3(t,n.er)}var i}),Rb.apply(this,arguments)}function COe(r,e){const t=je(r),n=t.yc.get(e);if(n&&n.fc)return nn().add(n.key);{let i=nn();const s=t._c.get(e);if(!s)return i;for(const o of s){const a=t.wc.get(o);i=i.unionWith(a.view.nc)}return i}}class p_{constructor(){this.synchronizeTabs=!1}initialize(e){var t=this;return M(function*(){t.serializer=I9(e.databaseInfo.databaseId),t.sharedClientState=t.createSharedClientState(e),t.persistence=t.createPersistence(e),yield t.persistence.start(),t.localStore=t.createLocalStore(e),t.gcScheduler=t.createGarbageCollectionScheduler(e,t.localStore),t.indexBackfillerScheduler=t.createIndexBackfillerScheduler(e,t.localStore)})()}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return function XY(r,e,t,n){return new NTe(r,e,t,n)}(this.persistence,new KY,e.initialUser,this.serializer)}createPersistence(e){return new LO(i_.zs,this.serializer)}createSharedClientState(e){return new oK}terminate(){var e=this;return M(function*(){e.gcScheduler&&e.gcScheduler.stop(),yield e.sharedClientState.shutdown(),yield e.persistence.shutdown()})()}}class k5{initialize(e,t){var n=this;return M(function*(){n.localStore||(n.localStore=e.localStore,n.sharedClientState=e.sharedClientState,n.datastore=n.createDatastore(t),n.remoteStore=n.createRemoteStore(t),n.eventManager=n.createEventManager(t),n.syncEngine=n.createSyncEngine(t,!e.synchronizeTabs),n.sharedClientState.onlineStateHandler=i=>SK(n.syncEngine,i,1),n.remoteStore.remoteSyncer.handleCredentialChange=vOe.bind(null,n.syncEngine),yield function fb(r,e){return db.apply(this,arguments)}(n.remoteStore,n.syncEngine.isPrimaryClient))})()}createEventManager(e){return new nOe}createDatastore(e){const t=I9(e.databaseInfo.databaseId),n=new VTe(e.databaseInfo);return new GTe(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return t=this.localStore,n=this.datastore,i=e.asyncQueue,s=a=>SK(this.syncEngine,a,0),o=aK.D()?new aK:new zTe,new WTe(t,n,i,s,o);var t,n,i,s,o}createSyncEngine(e,t){return function(n,i,s,o,a,c,l){const f=new lOe(n,i,s,o,a,c);return l&&(f.vc=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return(e=M(function*(t){const n=je(t);Oe("RemoteStore","RemoteStore shutting down."),n.vu.add(5),yield T5(n),n.Pu.shutdown(),n.bu.set("Unknown")}),function(t){return e.apply(this,arguments)})(this.remoteStore);var e}}class g_{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Sc(this.observer.next,e)}error(e){this.observer.error?this.Sc(this.observer.error,e):Vr("Uncaught Error in snapshot listener:",e.toString())}Dc(){this.muted=!0}Sc(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}}class kOe{constructor(e,t,n,i){var s=this;this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=i,this.user=I2.UNAUTHENTICATED,this.clientId=Jj.A(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,function(){var o=M(function*(a){Oe("FirestoreClient","Received user=",a.uid),yield s.authCredentialListener(a),s.user=a});return function(a){return o.apply(this,arguments)}}()),this.appCheckCredentials.start(n,o=>(Oe("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}getConfiguration(){var e=this;return M(function*(){return{asyncQueue:e.asyncQueue,databaseInfo:e.databaseInfo,clientId:e.clientId,authCredentials:e.authCredentials,appCheckCredentials:e.appCheckCredentials,initialUser:e.user,maxConcurrentLimboResolutions:100}})()}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Te(fe.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){var e=this;this.asyncQueue.enterRestrictedMode();const t=new u2;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(M(function*(){try{e._onlineComponents&&(yield e._onlineComponents.terminate()),e._offlineComponents&&(yield e._offlineComponents.terminate()),e.authCredentials.shutdown(),e.appCheckCredentials.shutdown(),t.resolve()}catch(n){const i=w5(n,"Failed to shutdown persistence");t.reject(i)}})),t.promise}}function m_(r,e){return Wb.apply(this,arguments)}function Wb(){return Wb=M(function*(r,e){r.asyncQueue.verifyOperationInProgress(),Oe("FirestoreClient","Initializing OfflineComponentProvider");const t=yield r.getConfiguration();yield e.initialize(t);let n=t.initialUser;r.setCredentialChangeListener(function(){var i=M(function*(s){n.isEqual(s)||(yield QY(e.localStore,s),n=s)});return function(s){return i.apply(this,arguments)}}()),e.persistence.setDatabaseDeletedListener(()=>r.terminate()),r._offlineComponents=e}),Wb.apply(this,arguments)}function qb(r,e){return jb.apply(this,arguments)}function jb(){return jb=M(function*(r,e){r.asyncQueue.verifyOperationInProgress();const t=yield function Zb(r){return Yb.apply(this,arguments)}(r);Oe("FirestoreClient","Initializing OnlineComponentProvider");const n=yield r.getConfiguration();yield e.initialize(t,n),r.setCredentialChangeListener(i=>gK(e.remoteStore,i)),r.setAppCheckTokenChangeListener((i,s)=>gK(e.remoteStore,s)),r._onlineComponents=e}),jb.apply(this,arguments)}function Yb(){return Yb=M(function*(r){if(!r._offlineComponents)if(r._uninitializedComponentsProvider){Oe("FirestoreClient","Using user provided OfflineComponentProvider");try{yield m_(r,r._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function NK(r){return"FirebaseError"===r.name?r.code===fe.FAILED_PRECONDITION||r.code===fe.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||22===r.code||20===r.code||11===r.code}(t))throw t;Ta("Error using user provided cache. Falling back to memory cache: "+t),yield m_(r,new p_)}}else Oe("FirestoreClient","Using default OfflineComponentProvider"),yield m_(r,new p_);return r._offlineComponents}),Yb.apply(this,arguments)}function __(r){return Kb.apply(this,arguments)}function Kb(){return Kb=M(function*(r){return r._onlineComponents||(r._uninitializedComponentsProvider?(Oe("FirestoreClient","Using user provided OnlineComponentProvider"),yield qb(r,r._uninitializedComponentsProvider._online)):(Oe("FirestoreClient","Using default OnlineComponentProvider"),yield qb(r,new k5))),r._onlineComponents}),Kb.apply(this,arguments)}function x5(r){return Qb.apply(this,arguments)}function Qb(){return Qb=M(function*(r){const e=yield __(r),t=e.eventManager;return t.onListen=uOe.bind(null,e.syncEngine),t.onUnlisten=fOe.bind(null,e.syncEngine),t}),Qb.apply(this,arguments)}function zK(r){const e={};return void 0!==r.timeoutSeconds&&(e.timeoutSeconds=r.timeoutSeconds),e}const DK=new Map;function Jb(r,e,t){if(!t)throw new Te(fe.INVALID_ARGUMENT,`Function ${r}() cannot be called with an empty ${e}.`)}function HK(r){if(!Be.isDocumentKey(r))throw new Te(fe.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${r} has ${r.length}.`)}function VK(r){if(Be.isDocumentKey(r))throw new Te(fe.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${r} has ${r.length}.`)}function C_(r){if(void 0===r)return"undefined";if(null===r)return"null";if("string"==typeof r)return r.length>20&&(r=`${r.substring(0,20)}...`),JSON.stringify(r);if("number"==typeof r||"boolean"==typeof r)return""+r;if("object"==typeof r){if(r instanceof Array)return"an array";{const e=(t=r).constructor?t.constructor.name:null;return e?`a custom ${e} object`:"an object"}}var t;return"function"==typeof r?"a function":at()}function Nn(r,e){if("_delegate"in r&&(r=r._delegate),!(r instanceof e)){if(e.name===r.constructor.name)throw new Te(fe.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=C_(r);throw new Te(fe.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return r}class $K{constructor(e){var t,n;if(void 0===e.host){if(void 0!==e.ssl)throw new Te(fe.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.cache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new Te(fe.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function $Oe(r,e,t,n){if(!0===e&&!0===n)throw new Te(fe.INVALID_ARGUMENT,`${r} and ${t} cannot be used together.`)})("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!(this.experimentalForceLongPolling||void 0!==e.experimentalAutoDetectLongPolling&&!e.experimentalAutoDetectLongPolling),this.experimentalLongPollingOptions=zK(null!==(n=e.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(i){if(void 0!==i.timeoutSeconds){if(isNaN(i.timeoutSeconds))throw new Te(fe.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new Te(fe.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new Te(fe.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.experimentalLongPollingOptions.timeoutSeconds===e.experimentalLongPollingOptions.timeoutSeconds&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class L9{constructor(e,t,n,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new $K({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new Te(fe.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new Te(fe.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new $K(e),void 0!==e.credentials&&(this._authCredentials=function(t){if(!t)return new VSe;switch(t.type){case"firstParty":return new BSe(t.sessionIndex||"0",t.iamToken||null,t.authTokenFactory||null);case"provider":return t.client;default:throw new Te(fe.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=DK.get(e);t&&(Oe("ComponentProvider","Removing Datastore"),DK.delete(e),t.terminate())}(this),Promise.resolve()}}function GK(r,e,t,n={}){var i;const s=(r=Nn(r,L9))._getSettings(),o=`${e}:${t}`;if("firestore.googleapis.com"!==s.host&&s.host!==o&&Ta("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),r._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),n.mockUserToken){let a,c;if("string"==typeof n.mockUserToken)a=n.mockUserToken,c=I2.MOCK_USER;else{a=function fMe(r,e){if(r.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=e||"demo-project",i=r.iat||0,s=r.sub||r.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},r);return[Kg(JSON.stringify({alg:"none",type:"JWT"})),Kg(JSON.stringify(o)),""].join(".")}(n.mockUserToken,null===(i=r._app)||void 0===i?void 0:i.options.projectId);const l=n.mockUserToken.sub||n.mockUserToken.user_id;if(!l)throw new Te(fe.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new I2(l)}r._authCredentials=new FSe(new Xj(a,c))}}class Gr{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ic(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Gr(this.firestore,e,this._key)}}class ai{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new ai(this.firestore,e,this._query)}}class Ic extends ai{constructor(e,t,n){super(e,t,p5(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Gr(this.firestore,null,new Be(e))}withConverter(e){return new Ic(this.firestore,e,this._path)}}function GOe(r,e,...t){if(r=yr(r),Jb("collection","path",e),r instanceof L9){const n=Dn.fromString(e,...t);return VK(n),new Ic(r,null,n)}{if(!(r instanceof Gr||r instanceof Ic))throw new Te(fe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=r._path.child(Dn.fromString(e,...t));return VK(n),new Ic(r.firestore,null,n)}}function BK(r,e,...t){if(r=yr(r),1===arguments.length&&(e=Jj.A()),Jb("doc","path",e),r instanceof L9){const n=Dn.fromString(e,...t);return HK(n),new Gr(r,null,new Be(n))}{if(!(r instanceof Gr||r instanceof Ic))throw new Te(fe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=r._path.child(Dn.fromString(e,...t));return HK(n),new Gr(r.firestore,r instanceof Ic?r.converter:null,new Be(n))}}class BOe{constructor(){this.Gc=Promise.resolve(),this.Qc=[],this.jc=!1,this.zc=[],this.Wc=null,this.Hc=!1,this.Jc=!1,this.Yc=[],this.qo=new ZO(this,"async_queue_retry"),this.Xc=()=>{const t=f_();t&&Oe("AsyncQueue","Visibility state changed to "+t.visibilityState),this.qo.Mo()};const e=f_();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Xc)}get isShuttingDown(){return this.jc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Zc(),this.ta(e)}enterRestrictedMode(e){if(!this.jc){this.jc=!0,this.Jc=e||!1;const t=f_();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Xc)}}enqueue(e){if(this.Zc(),this.jc)return new Promise(()=>{});const t=new u2;return this.ta(()=>this.jc&&this.Jc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Qc.push(e),this.ea()))}ea(){var e=this;return M(function*(){if(0!==e.Qc.length){try{yield e.Qc[0](),e.Qc.shift(),e.qo.reset()}catch(t){if(!X4(t))throw t;Oe("AsyncQueue","Operation failed with retryable error: "+t)}e.Qc.length>0&&e.qo.No(()=>e.ea())}})()}ta(e){const t=this.Gc.then(()=>(this.Hc=!0,e().catch(n=>{throw this.Wc=n,this.Hc=!1,Vr("INTERNAL UNHANDLED ERROR: ",function(s){let o=s.message||"";return s.stack&&(o=s.stack.includes(s.message)?s.stack:s.message+"\n"+s.stack),o}(n)),n}).then(n=>(this.Hc=!1,n))));return this.Gc=t,t}enqueueAfterDelay(e,t,n){this.Zc(),this.Yc.indexOf(e)>-1&&(t=0);const i=hb.createAndSchedule(this,e,t,n,s=>this.na(s));return this.zc.push(i),i}Zc(){this.Wc&&at()}verifyOperationInProgress(){}sa(){var e=this;return M(function*(){let t;do{t=e.Gc,yield t}while(t!==e.Gc)})()}ia(e){for(const t of this.zc)if(t.timerId===e)return!0;return!1}ra(e){return this.sa().then(()=>{this.zc.sort((t,n)=>t.targetTimeMs-n.targetTimeMs);for(const t of this.zc)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.sa()})}oa(e){this.Yc.push(e)}na(e){const t=this.zc.indexOf(e);this.zc.splice(t,1)}}function ew(r){return function(e,t){if("object"!=typeof e||null===e)return!1;const n=e;for(const i of["next","error","complete"])if(i in n&&"function"==typeof n[i])return!0;return!1}(r)}class $1 extends L9{constructor(e,t,n,i){super(e,t,n,i),this.type="firestore",this._queue=new BOe,this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||WK(this),this._firestoreClient.terminate()}}function WOe(r,e){const n="string"==typeof r?r:e||"(default)",i=e5("object"==typeof r?r:iT(),"firestore").getImmediate({identifier:n});if(!i._initialized){const s=(r=>{const e=gq("firestore");if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(t+1),10);return"["===e[0]?[e.substring(1,t-1),n]:[e.substring(0,t),n]})();s&&GK(i,...s)}return i}function Jr(r){return r._firestoreClient||WK(r),r._firestoreClient.verifyNotTerminated(),r._firestoreClient}function WK(r){var e,t,n;const i=r._freezeSettings(),s=(a=(null===(e=r._app)||void 0===e?void 0:e.options.appId)||"",new CPe(r._databaseId,a,r._persistenceKey,(l=i).host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,zK(l.experimentalLongPollingOptions),l.useFetchStreams));var a,l;r._firestoreClient=new kOe(r._authCredentials,r._appCheckCredentials,r._queue,s),null!==(t=i.cache)&&void 0!==t&&t._offlineComponentProvider&&null!==(n=i.cache)&&void 0!==n&&n._onlineComponentProvider&&(r._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.cache.kind,_offline:i.cache._offlineComponentProvider,_online:i.cache._onlineComponentProvider})}class e0{constructor(e){this._byteString=e}static fromBase64String(e){try{return new e0(f2.fromBase64String(e))}catch(t){throw new Te(fe.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new e0(f2.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class L5{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new Te(fe.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Fr(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class y_{constructor(e){this._methodName=e}}class tw{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Te(fe.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Te(fe.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return qt(this._lat,e._lat)||qt(this._long,e._long)}}const jOe=/^__.*__$/;class ZOe{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new V3(e,this.data,this.fieldMask,t,this.fieldTransforms):new _5(e,this.data,t,this.fieldTransforms)}}class ZK{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new V3(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function YK(r){switch(r){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw at()}}class M_{constructor(e,t,n,i,s,o){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=i,void 0===s&&this.ua(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get ca(){return this.settings.ca}aa(e){return new M_(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ha(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.aa({path:n,la:!1});return i.fa(e),i}da(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.aa({path:n,la:!1});return i.ua(),i}wa(e){return this.aa({path:void 0,la:!0})}_a(e){return S_(e,this.settings.methodName,this.settings.ma||!1,this.path,this.settings.ga)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}ua(){if(this.path)for(let e=0;e<this.path.length;e++)this.fa(this.path.get(e))}fa(e){if(0===e.length)throw this._a("Document fields must not be empty");if(YK(this.ca)&&jOe.test(e))throw this._a('Document fields cannot begin and end with "__"')}}class YOe{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||I9(e)}ya(e,t,n,i=!1){return new M_({ca:e,methodName:t,ga:n,path:Fr.emptyPath(),la:!1,ma:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function R5(r){const e=r._freezeSettings(),t=I9(r._databaseId);return new YOe(r._databaseId,!!e.ignoreUndefinedProperties,t)}function nw(r,e,t,n,i,s={}){const o=r.ya(s.merge||s.mergeFields?2:0,e,t,i);iw("Data must be an object, but it was:",o,n);const a=eX(n,o);let c,l;if(s.merge)c=new Ls(o.fieldMask),l=o.fieldTransforms;else if(s.mergeFields){const f=[];for(const d of s.mergeFields){const m=D9(e,d,t);if(!o.contains(m))throw new Te(fe.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);nX(f,m)||f.push(m)}c=new Ls(f),l=o.fieldTransforms.filter(d=>c.covers(d.field))}else c=null,l=o.fieldTransforms;return new ZOe(new oi(a),c,l)}class z9 extends y_{_toFieldTransform(e){if(2!==e.ca)throw e._a(1===e.ca?`${this._methodName}() can only appear at the top level of your update data`:`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof z9}}class rw extends y_{_toFieldTransform(e){return new g9(e.path,new g5)}isEqual(e){return e instanceof rw}}function t0(r,e){if(tX(r=yr(r)))return iw("Unsupported field value:",e,r),eX(r,e);if(r instanceof y_)return function(t,n){if(!YK(n.ca))throw n._a(`${t._methodName}() can only be used with update() and set()`);if(!n.path)throw n._a(`${t._methodName}() is not currently supported inside arrays`);const i=t._toFieldTransform(n);i&&n.fieldTransforms.push(i)}(r,e),null;if(void 0===r&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),r instanceof Array){if(e.settings.la&&4!==e.ca)throw e._a("Nested arrays are not supported");return function(t,n){const i=[];let s=0;for(const o of t){let a=t0(o,n.wa(s));null==a&&(a={nullValue:"NULL_VALUE"}),i.push(a),s++}return{arrayValue:{values:i}}}(r,e)}return function(t,n){if(null===(t=yr(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return UZ(n.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){const i=ar.fromDate(t);return{timestampValue:C5(n.serializer,i)}}if(t instanceof ar){const i=new ar(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:C5(n.serializer,i)}}if(t instanceof tw)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof e0)return{bytesValue:fY(n.serializer,t._byteString)};if(t instanceof Gr){const i=n.databaseId,s=t.firestore._databaseId;if(!s.isEqual(i))throw n._a(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:EO(t.firestore._databaseId||n.databaseId,t._key.path)}}throw n._a(`Unsupported field value: ${C_(t)}`)}(r,e)}function eX(r,e){const t={};return hZ(r)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Q4(r,(n,i)=>{const s=t0(i,e.ha(n));null!=s&&(t[n]=s)}),{mapValue:{fields:t}}}function tX(r){return!("object"!=typeof r||null===r||r instanceof Array||r instanceof Date||r instanceof ar||r instanceof tw||r instanceof e0||r instanceof Gr||r instanceof y_)}function iw(r,e,t){if(!tX(t)||"object"!=typeof(n=t)||null===n||Object.getPrototypeOf(n)!==Object.prototype&&null!==Object.getPrototypeOf(n)){const n=C_(t);throw e._a("an object"===n?r+" a custom object":r+" "+n)}var n}function D9(r,e,t){if((e=yr(e))instanceof L5)return e._internalPath;if("string"==typeof e)return E_(r,e);throw S_("Field path arguments must be of type string or ",r,!1,void 0,t)}const JOe=new RegExp("[~\\*/\\[\\]]");function E_(r,e,t){if(e.search(JOe)>=0)throw S_(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,r,!1,void 0,t);try{return new L5(...e.split("."))._internalPath}catch{throw S_(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,r,!1,void 0,t)}}function S_(r,e,t,n,i){const s=n&&!n.isEmpty(),o=void 0!==i;let a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${n}`),o&&(c+=` in document ${i}`),c+=")"),new Te(fe.INVALID_ARGUMENT,a+r+c)}function nX(r,e){return r.some(t=>t.isEqual(e))}class sw{constructor(e,t,n,i,s){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Gr(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new ebe(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(P_("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class ebe extends sw{data(){return super.data()}}function P_(r,e){return"string"==typeof e?E_(r,e):e instanceof L5?e._internalPath:e._delegate._internalPath}function rX(r){if("L"===r.limitType&&0===r.explicitOrderBy.length)throw new Te(fe.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class ow{}class aw extends ow{}function tbe(r,e,...t){let n=[];e instanceof ow&&n.push(e),n=n.concat(t),function(i){const s=i.filter(a=>a instanceof z5).length,o=i.filter(a=>a instanceof H9).length;if(s>1||s>0&&o>0)throw new Te(fe.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const i of n)r=i._apply(r);return r}class H9 extends aw{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new H9(e,t,n)}_apply(e){const t=this._parse(e);return aX(e._query,t),new ai(e.firestore,e.converter,dO(e._query,t))}_parse(e){const t=R5(e.firestore);return function(i,s,o,a,c,l,f){let d;if(c.isKeyField()){if("array-contains"===l||"array-contains-any"===l)throw new Te(fe.INVALID_ARGUMENT,`Invalid Query. You can't perform '${l}' queries on documentId().`);if("in"===l||"not-in"===l){oX(f,l);const m=[];for(const E of f)m.push(sX(a,i,E));d={arrayValue:{values:m}}}else d=sX(a,i,f)}else"in"!==l&&"not-in"!==l&&"array-contains-any"!==l||oX(f,l),d=function JK(r,e,t,n=!1){return t0(t,r.ya(n?4:3,e))}(o,"where",f,"in"===l||"not-in"===l);return Mn.create(c,l,d)}(e._query,0,t,e.firestore._databaseId,this._field,this._op,this._value)}}function nbe(r,e,t){const n=e,i=P_("where",r);return H9._create(i,n,t)}class z5 extends ow{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new z5(e,t)}_parse(e){const t=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return 1===t.length?t[0]:f1.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(n,i){let s=n;const o=i.getFlattenedFilters();for(const a of o)aX(s,a),s=dO(s,a)}(e._query,t),new ai(e.firestore,e.converter,dO(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class cw extends aw{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new cw(e,t)}_apply(e){const t=function(n,i,s){if(null!==n.startAt)throw new Te(fe.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==n.endAt)throw new Te(fe.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const o=new d5(i,s);return function(a,c){if(null===uO(a)){const l=Bm(a);null!==l&&cX(0,l,c.field)}}(n,o),o}(e._query,this._field,this._direction);return new ai(e.firestore,e.converter,function(n,i){const s=n.explicitOrderBy.concat([i]);return new D3(n.path,n.collectionGroup,s,n.filters.slice(),n.limit,n.limitType,n.startAt,n.endAt)}(e._query,t))}}function rbe(r,e="asc"){const t=e,n=P_("orderBy",r);return cw._create(n,t)}class T_ extends aw{constructor(e,t,n){super(),this.type=e,this._limit=t,this._limitType=n}static _create(e,t,n){return new T_(e,t,n)}_apply(e){return new ai(e.firestore,e.converter,Um(e._query,this._limit,this._limitType))}}function ibe(r){return function FK(r,e){if(e<=0)throw new Te(fe.INVALID_ARGUMENT,`Function ${r}() requires a positive number, but it was: ${e}.`)}("limit",r),T_._create("limit",r,"F")}function sX(r,e,t){if("string"==typeof(t=yr(t))){if(""===t)throw new Te(fe.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!fO(e)&&-1!==t.indexOf("/"))throw new Te(fe.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const n=e.path.child(Dn.fromString(t));if(!Be.isDocumentKey(n))throw new Te(fe.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return G6(r,new Be(n))}if(t instanceof Gr)return G6(r,t._key);throw new Te(fe.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${C_(t)}.`)}function oX(r,e){if(!Array.isArray(r)||0===r.length)throw new Te(fe.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function aX(r,e){if(e.isInequality()){const n=Bm(r),i=e.field;if(null!==n&&!n.isEqual(i))throw new Te(fe.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${n.toString()}' and '${i.toString()}'`);const s=uO(r);null!==s&&cX(0,i,s)}const t=function(n,i){for(const s of n)for(const o of s.getFlattenedFilters())if(i.indexOf(o.op)>=0)return o.op;return null}(r.filters,function(n){switch(n){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==t)throw new Te(fe.INVALID_ARGUMENT,t===e.op?`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`:`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function cX(r,e,t){if(!t.isEqual(e))throw new Te(fe.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${e.toString()}' and so you must also use '${e.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${t.toString()}' instead.`)}class sbe{convertValue(e,t="none"){switch(tl(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Sr(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(z3(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw at()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const n={};return Q4(e,(i,s)=>{n[i]=this.convertValue(s,t)}),n}convertGeoPoint(e){return new tw(Sr(e.latitude),Sr(e.longitude))}convertArray(e,t){return(e.values||[]).map(n=>this.convertValue(n,t))}convertServerTimestamp(e,t){switch(t){case"previous":const n=Dm(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(o9(e));default:return null}}convertTimestamp(e){const t=J4(e);return new ar(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=Dn.fromString(e);mt(MY(n));const i=new $6(n.get(1),n.get(3)),s=new Be(n.popFirst(5));return i.isEqual(t)||Vr(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}function lw(r,e,t){let n;return n=r?t&&(t.merge||t.mergeFields)?r.toFirestore(e,t):r.toFirestore(e):e,n}class n0{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class D5 extends sw{constructor(e,t,n,i,s,o){super(e,t,n,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new w_(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(P_("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class w_ extends D5{data(e={}){return super.data(e)}}class H5{constructor(e,t,n,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new n0(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new w_(this._firestore,this._userDataWriter,n.key,n,new n0(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Te(fe.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(n,i){if(n._snapshot.oldDocs.isEmpty()){let s=0;return n._snapshot.docChanges.map(o=>({type:"added",doc:new w_(n._firestore,n._userDataWriter,o.doc.key,o.doc,new n0(n._snapshot.mutatedKeys.has(o.doc.key),n._snapshot.fromCache),n.query.converter),oldIndex:-1,newIndex:s++}))}{let s=n._snapshot.oldDocs;return n._snapshot.docChanges.filter(o=>i||3!==o.type).map(o=>{const a=new w_(n._firestore,n._userDataWriter,o.doc.key,o.doc,new n0(n._snapshot.mutatedKeys.has(o.doc.key),n._snapshot.fromCache),n.query.converter);let c=-1,l=-1;return 0!==o.type&&(c=s.indexOf(o.doc.key),s=s.delete(o.doc.key)),1!==o.type&&(s=s.add(o.doc),l=s.indexOf(o.doc.key)),{type:abe(o.type),doc:a,oldIndex:c,newIndex:l}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function abe(r){switch(r){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return at()}}function cbe(r){r=Nn(r,Gr);const e=Nn(r.firestore,$1);return function LK(r,e,t={}){const n=new u2;return r.asyncQueue.enqueueAndForget(M(function*(){return function(i,s,o,a,c){const l=new g_({next:d=>{s.enqueueAndForget(()=>mb(i,f));const m=d.docs.has(o);!m&&d.fromCache?c.reject(new Te(fe.UNAVAILABLE,"Failed to get document because the client is offline.")):m&&d.fromCache&&a&&"server"===a.source?c.reject(new Te(fe.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(d)},error:d=>c.reject(d)}),f=new Cb(p5(o.path),l,{includeMetadataChanges:!0,Ku:!0});return pb(i,f)}(yield x5(r),r.asyncQueue,e,t,n)})),n.promise}(Jr(e),r._key).then(t=>uw(e,r,t))}class ul extends sbe{constructor(e){super(),this.firestore=e}convertBytes(e){return new e0(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Gr(this.firestore,null,t)}}function lbe(r){r=Nn(r,ai);const e=Nn(r.firestore,$1),t=Jr(e),n=new ul(e);return rX(r._query),function RK(r,e,t={}){const n=new u2;return r.asyncQueue.enqueueAndForget(M(function*(){return function(i,s,o,a,c){const l=new g_({next:d=>{s.enqueueAndForget(()=>mb(i,f)),d.fromCache&&"server"===a.source?c.reject(new Te(fe.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(d)},error:d=>c.reject(d)}),f=new Cb(o,l,{includeMetadataChanges:!0,Ku:!0});return pb(i,f)}(yield x5(r),r.asyncQueue,e,t,n)})),n.promise}(t,r._query).then(i=>new H5(e,n,r,i))}function ube(r,e,t){r=Nn(r,Gr);const n=Nn(r.firestore,$1),i=lw(r.converter,e,t);return V9(n,[nw(R5(n),"setDoc",r._key,i,null!==r.converter,t).toMutation(r._key,J1.none())])}function fbe(r,e,t,...n){r=Nn(r,Gr);const i=Nn(r.firestore,$1),s=R5(i);let o;return o="string"==typeof(e=yr(e))||e instanceof L5?function QK(r,e,t,n,i,s){const o=r.ya(1,e,t),a=[D9(e,n,t)],c=[i];if(s.length%2!=0)throw new Te(fe.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<s.length;m+=2)a.push(D9(e,s[m])),c.push(s[m+1]);const l=[],f=oi.empty();for(let m=a.length-1;m>=0;--m)if(!nX(l,a[m])){const E=a[m];let w=c[m];w=yr(w);const R=o.da(E);if(w instanceof z9)l.push(E);else{const z=t0(w,R);null!=z&&(l.push(E),f.set(E,z))}}const d=new Ls(l);return new ZK(f,d,o.fieldTransforms)}(s,"updateDoc",r._key,e,t,n):function XK(r,e,t,n){const i=r.ya(1,e,t);iw("Data must be an object, but it was:",i,n);const s=[],o=oi.empty();Q4(n,(c,l)=>{const f=E_(e,c,t);l=yr(l);const d=i.da(f);if(l instanceof z9)s.push(f);else{const m=t0(l,d);null!=m&&(s.push(f),o.set(f,m))}});const a=new Ls(s);return new ZK(o,a,i.fieldTransforms)}(s,"updateDoc",r._key,e),V9(i,[o.toMutation(r._key,J1.exists(!0))])}function dbe(r){return V9(Nn(r.firestore,$1),[new v5(r._key,J1.none())])}function hbe(r,e){const t=Nn(r.firestore,$1),n=BK(r),i=lw(r.converter,e);return V9(t,[nw(R5(r.firestore),"addDoc",n._key,i,null!==r.converter,{}).toMutation(n._key,J1.exists(!1))]).then(()=>n)}function pbe(r,...e){var t,n,i;r=yr(r);let s={includeMetadataChanges:!1},o=0;"object"!=typeof e[o]||ew(e[o])||(s=e[o],o++);const a={includeMetadataChanges:s.includeMetadataChanges};if(ew(e[o])){const d=e[o];e[o]=null===(t=d.next)||void 0===t?void 0:t.bind(d),e[o+1]=null===(n=d.error)||void 0===n?void 0:n.bind(d),e[o+2]=null===(i=d.complete)||void 0===i?void 0:i.bind(d)}let c,l,f;if(r instanceof Gr)l=Nn(r.firestore,$1),f=p5(r._key.path),c={next:d=>{e[o]&&e[o](uw(l,r,d))},error:e[o+1],complete:e[o+2]};else{const d=Nn(r,ai);l=Nn(d.firestore,$1),f=d._query;const m=new ul(l);c={next:E=>{e[o]&&e[o](new H5(l,m,d,E))},error:e[o+1],complete:e[o+2]},rX(r._query)}return function(d,m,E,w){const R=new g_(w),z=new Cb(m,R,E);return d.asyncQueue.enqueueAndForget(M(function*(){return pb(yield x5(d),z)})),()=>{R.Dc(),d.asyncQueue.enqueueAndForget(M(function*(){return mb(yield x5(d),z)}))}}(Jr(l),f,a,c)}function V9(r,e){return function(t,n){const i=new u2;return t.asyncQueue.enqueueAndForget(M(function*(){return function dOe(r,e,t){return Pb.apply(this,arguments)}(yield function Xb(r){return __(r).then(e=>e.syncEngine)}(t),n,i)})),i.promise}(Jr(r),e)}function uw(r,e,t){const n=t.docs.get(e._key),i=new ul(r);return new D5(r,i,e._key,n,new n0(t.hasPendingWrites,t.fromCache),e.converter)}function kc(){return new rw("serverTimestamp")}function fX(r,e){if(null!=r&&null!=e&&"object"==typeof r){if(null!=r.equals)return r.equals(e);{const t=r,n=e;for(const i of Object.keys(t)){if(!(i in n))return!1;if(!1===fX(t[i],n[i]))return!1}return!0}}return r===e}function fw(r){return null==r||function Obe(r){return"object"==typeof r&&null!=r&&null!=r.equals}(r)||function fRe(r){return"string"==typeof r||"number"==typeof r||"boolean"==typeof r||null===r}(r)||function bbe(r){if("object"==typeof r){for(const e in r)if(null!=r[e]&&!1===fw(r[e]))return!1;return null!=r&&r.constructor.prototype===Object.prototype}return!1}(r)}function zo(r,e){if(fw(r)&&fw(e))return fX(r,e);throw new Error(`Comparing non comparable objects: ${r.constructor.name} and ${e.constructor.name}`)}!function(r,e=!0){c5=L6,cs(new Ii("firestore",(t,{instanceIdentifier:n,options:i})=>{const s=t.getProvider("app").getImmediate(),o=new $1(new $Se(t.getProvider("auth-internal")),new USe(t.getProvider("app-check-internal")),function(a,c){if(!Object.prototype.hasOwnProperty.apply(a.options,["projectId"]))throw new Te(fe.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new $6(a.options.projectId,c)}(s,n),s);return i=Object.assign({useFetchStreams:e},i),o._setSettings(i),o},"PUBLIC").setMultipleInstances(!0)),Mr(Kj,"3.13.0",r),Mr(Kj,"3.13.0","esm2017")}();class we{static fromFunctions(e,t){return new class extends we{encode(n){return e(n)}decode(n){return t(n)}}}static identity(){function e(t){return t}return we.fromFunctions(e,e)}static constant(e,t){return new class extends we{encode(n){return e}decode(n){return t}}}static tuple(e,t,n){return new class extends we{encode(i){const s=t(i),o={};return Object.keys(s).forEach(a=>{o[a]=e[a].encode(s[a])}),o}decode(i){const s={};return Object.keys(e).reverse().forEach(o=>{s[o]=e[o].decode(i[o])}),n(Object.values(s))}}}static disjunction(e,t){return U.assert(e.length===t.length,"typePredicates and encoders should have same length"),new class extends we{encode(n){let i=0;for(const s of e){if(!0===s(n))return{type:i,encoded:t[i].encode(n)};i++}}decode(n){const i=U.getNonNullable(n).type,s=U.getNonNullable(n).encoded;return t[i].decode(s)}}}static list(e){return new class extends we{encode(t){return t.map(n=>{const i=e.encode(n);return U.assert(!1===Array.isArray(i),"This encoder should not encode as array"),i})}decode(t){return t.map(e.decode)}}}}class g{static of(e){return new g(e)}static ofNullable(e){return null==e?g.empty():g.of(e)}static empty(){return new g(null)}static getEncoder(e){return new class extends we{encode(t){return t.isPresent()?e.encode(t.get()):null}decode(t){return null===t?g.empty():g.of(e.decode(t))}}}constructor(e){u(this,"value",void 0),this.value=e}isPresent(){return null!=this.value}isAbsent(){return null==this.value}get(){if(this.isPresent())return this.value;throw new Error("Value is absent")}getOrElse(e){return this.isPresent()?this.value:e}equals(e){return this.isAbsent()?e.isAbsent():!e.isAbsent()&&zo(this.value,e.value)}equalsValue(e){return this.equals(g.of(e))}toString(){return this.isAbsent()?"MGPOptional.empty()":`MGPOptional.of(${this.value})`}map(e){return this.isPresent()?g.of(e(this.get())):g.empty()}}class ie{static success(e){return new wbe(e)}static failure(e){return new Abe(e)}constructor(){}equals(e){return this.isFailure()?e.isFailure()&&this.getReason()===e.getReason():!e.isFailure()&&zo(this.get(),e.get())}}class wbe extends ie{constructor(e){super(),u(this,"value",void 0),u(this,"__nominal",void 0),this.value=e}isSuccess(){return!0}isFailure(){return!1}get(){return this.value}getReason(){throw new Error("Cannot get failure reason from a success")}getReasonOr(e){return e}toOptional(){return g.of(this.value)}toString(){return`MGPFallible.success(${this.value})`}}class Abe extends ie{constructor(e){super(),u(this,"reason",void 0),u(this,"__nominal",void 0),this.reason=e}isSuccess(){return!1}isFailure(){return!0}get(){throw new Error("Value is absent from failure, with the following reason: "+this.reason)}getReason(){return this.reason}getReasonOr(e){return this.getReason()}toOptional(){return g.empty()}toString(){return`MGPFallible.failure(${this.reason})`}toOtherFallible(){return ie.failure(this.reason)}}var b;!function(r){r.SUCCESS=ie.success(void 0),r.ofFallible=function e(n){return n.isSuccess()?r.SUCCESS:r.failure(n.getReason())},r.failure=function t(n){return ie.failure(n)}}(b||(b={})),Mr("firebase","9.23.0","app");const kbe=(r,e)=>e.some(t=>r instanceof t);let dX,hX;const pX=new WeakMap,dw=new WeakMap,gX=new WeakMap,hw=new WeakMap,pw=new WeakMap;let gw={get(r,e,t){if(r instanceof IDBTransaction){if("done"===e)return dw.get(r);if("objectStoreNames"===e)return r.objectStoreNames||gX.get(r);if("store"===e)return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return fl(r[e])},set:(r,e,t)=>(r[e]=t,!0),has:(r,e)=>r instanceof IDBTransaction&&("done"===e||"store"===e)||e in r};function Vbe(r){return"function"==typeof r?function Hbe(r){return r!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function Lbe(){return hX||(hX=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(r)?function(...e){return r.apply(mw(this),e),fl(pX.get(this))}:function(...e){return fl(r.apply(mw(this),e))}:function(e,...t){const n=r.call(mw(this),e,...t);return gX.set(n,e.sort?e.sort():[e]),fl(n)}}(r):(r instanceof IDBTransaction&&function zbe(r){if(dw.has(r))return;const e=new Promise((t,n)=>{const i=()=>{r.removeEventListener("complete",s),r.removeEventListener("error",o),r.removeEventListener("abort",o)},s=()=>{t(),i()},o=()=>{n(r.error||new DOMException("AbortError","AbortError")),i()};r.addEventListener("complete",s),r.addEventListener("error",o),r.addEventListener("abort",o)});dw.set(r,e)}(r),kbe(r,function xbe(){return dX||(dX=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(r,gw):r)}function fl(r){if(r instanceof IDBRequest)return function Rbe(r){const e=new Promise((t,n)=>{const i=()=>{r.removeEventListener("success",s),r.removeEventListener("error",o)},s=()=>{t(fl(r.result)),i()},o=()=>{n(r.error),i()};r.addEventListener("success",s),r.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&pX.set(t,r)}).catch(()=>{}),pw.set(e,r),e}(r);if(hw.has(r))return hw.get(r);const e=Vbe(r);return e!==r&&(hw.set(r,e),pw.set(e,r)),e}const mw=r=>pw.get(r),$be=["get","getKey","getAll","getAllKeys","count"],Gbe=["put","add","delete","clear"],_w=new Map;function mX(r,e){if(!(r instanceof IDBDatabase)||e in r||"string"!=typeof e)return;if(_w.get(e))return _w.get(e);const t=e.replace(/FromIndex$/,""),n=e!==t,i=Gbe.includes(t);if(!(t in(n?IDBIndex:IDBObjectStore).prototype)||!i&&!$be.includes(t))return;const s=function(){var o=M(function*(a,...c){const l=this.transaction(a,i?"readwrite":"readonly");let f=l.store;return n&&(f=f.index(c.shift())),(yield Promise.all([f[t](...c),i&&l.done]))[0]});return function(c){return o.apply(this,arguments)}}();return _w.set(e,s),s}!function Dbe(r){gw=r(gw)}(r=>({...r,get:(e,t,n)=>mX(e,t)||r.get(e,t,n),has:(e,t)=>!!mX(e,t)||r.has(e,t)}));const _X="@firebase/installations",vw="0.6.4",vX=1e4,CX=`w:${vw}`,yX="FIS_v2",Bbe="https://firebaseinstallations.googleapis.com/v1",Ube=36e5,G3=new Sc("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function MX(r){return r instanceof Lo&&r.code.includes("request-failed")}function Cw({projectId:r}){return`${Bbe}/projects/${r}/installations`}function EX(r){return{token:r.token,requestStatus:2,expiresIn:Zbe(r.expiresIn),creationTime:Date.now()}}function yw(r,e){return Mw.apply(this,arguments)}function Mw(){return Mw=M(function*(r,e){const n=(yield e.json()).error;return G3.create("request-failed",{requestName:r,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}),Mw.apply(this,arguments)}function SX({apiKey:r}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":r})}function Ew(r){return Sw.apply(this,arguments)}function Sw(){return Sw=M(function*(r){const e=yield r();return e.status>=500&&e.status<600?r():e}),Sw.apply(this,arguments)}function Zbe(r){return Number(r.replace("s","000"))}function Pw(){return Pw=M(function*({appConfig:r,heartbeatServiceProvider:e},{fid:t}){const n=Cw(r),i=SX(r),s=e.getImmediate({optional:!0});if(s){const l=yield s.getHeartbeatsHeader();l&&i.append("x-firebase-client",l)}const a={method:"POST",headers:i,body:JSON.stringify({fid:t,authVersion:yX,appId:r.appId,sdkVersion:CX})},c=yield Ew(()=>fetch(n,a));if(c.ok){const l=yield c.json();return{fid:l.fid||t,registrationStatus:2,refreshToken:l.refreshToken,authToken:EX(l.authToken)}}throw yield yw("Create Installation",c)}),Pw.apply(this,arguments)}function TX(r){return new Promise(e=>{setTimeout(e,r)})}const Qbe=/^[cdef][\w-]{21}$/,Tw="";function Jbe(){try{const r=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(r),r[0]=112+r[0]%16;const t=function ewe(r){return function Xbe(r){return btoa(String.fromCharCode(...r)).replace(/\+/g,"-").replace(/\//g,"_")}(r).substr(0,22)}(r);return Qbe.test(t)?t:Tw}catch{return Tw}}function V5(r){return`${r.appName}!${r.appId}`}const F5=new Map;function OX(r,e){const t=V5(r);bX(t,e),function rwe(r,e){const t=function wX(){return!r0&&"BroadcastChannel"in self&&(r0=new BroadcastChannel("[Firebase] FID Change"),r0.onmessage=r=>{bX(r.data.key,r.data.fid)}),r0}();t&&t.postMessage({key:r,fid:e}),function AX(){0===F5.size&&r0&&(r0.close(),r0=null)}()}(t,e)}function bX(r,e){const t=F5.get(r);if(t)for(const n of t)n(e)}let r0=null;const iwe="firebase-installations-database",swe=1,s0="firebase-installations-store";let Ow=null;function bw(){return Ow||(Ow=function Fbe(r,e,{blocked:t,upgrade:n,blocking:i,terminated:s}={}){const o=indexedDB.open(r,e),a=fl(o);return n&&o.addEventListener("upgradeneeded",c=>{n(fl(o.result),c.oldVersion,c.newVersion,fl(o.transaction))}),t&&o.addEventListener("blocked",()=>t()),a.then(c=>{s&&c.addEventListener("close",()=>s()),i&&c.addEventListener("versionchange",()=>i())}).catch(()=>{}),a}(iwe,swe,{upgrade:(r,e)=>{0===e&&r.createObjectStore(s0)}})),Ow}function N_(r,e){return ww.apply(this,arguments)}function ww(){return ww=M(function*(r,e){const t=V5(r),i=(yield bw()).transaction(s0,"readwrite"),s=i.objectStore(s0),o=yield s.get(t);return yield s.put(e,t),yield i.done,(!o||o.fid!==e.fid)&&OX(r,e.fid),e}),ww.apply(this,arguments)}function Aw(r){return Nw.apply(this,arguments)}function Nw(){return Nw=M(function*(r){const e=V5(r),n=(yield bw()).transaction(s0,"readwrite");yield n.objectStore(s0).delete(e),yield n.done}),Nw.apply(this,arguments)}function F9(r,e){return Iw.apply(this,arguments)}function Iw(){return Iw=M(function*(r,e){const t=V5(r),i=(yield bw()).transaction(s0,"readwrite"),s=i.objectStore(s0),o=yield s.get(t),a=e(o);return void 0===a?yield s.delete(t):yield s.put(a,t),yield i.done,a&&(!o||o.fid!==a.fid)&&OX(r,a.fid),a}),Iw.apply(this,arguments)}function kw(r){return xw.apply(this,arguments)}function xw(){return xw=M(function*(r){let e;const t=yield F9(r.appConfig,n=>{const i=function owe(r){return IX(r||{fid:Jbe(),registrationStatus:0})}(n),s=function awe(r,e){if(0===e.registrationStatus){if(!navigator.onLine)return{installationEntry:e,registrationPromise:Promise.reject(G3.create("app-offline"))};const t={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},n=function cwe(r,e){return Lw.apply(this,arguments)}(r,t);return{installationEntry:t,registrationPromise:n}}return 1===e.registrationStatus?{installationEntry:e,registrationPromise:lwe(r)}:{installationEntry:e}}(r,i);return e=s.registrationPromise,s.installationEntry});return t.fid===Tw?{installationEntry:yield e}:{installationEntry:t,registrationPromise:e}}),xw.apply(this,arguments)}function Lw(){return Lw=M(function*(r,e){try{const t=yield function Kbe(r,e){return Pw.apply(this,arguments)}(r,e);return N_(r.appConfig,t)}catch(t){throw MX(t)&&409===t.customData.serverCode?yield Aw(r.appConfig):yield N_(r.appConfig,{fid:e.fid,registrationStatus:0}),t}}),Lw.apply(this,arguments)}function lwe(r){return Rw.apply(this,arguments)}function Rw(){return Rw=M(function*(r){let e=yield NX(r.appConfig);for(;1===e.registrationStatus;)yield TX(100),e=yield NX(r.appConfig);if(0===e.registrationStatus){const{installationEntry:t,registrationPromise:n}=yield kw(r);return n||t}return e}),Rw.apply(this,arguments)}function NX(r){return F9(r,e=>{if(!e)throw G3.create("installation-not-found");return IX(e)})}function IX(r){return function uwe(r){return 1===r.registrationStatus&&r.registrationTime+vX<Date.now()}(r)?{fid:r.fid,registrationStatus:0}:r}function zw(){return zw=M(function*({appConfig:r,heartbeatServiceProvider:e},t){const n=function dwe(r,{fid:e}){return`${Cw(r)}/${e}/authTokens:generate`}(r,t),i=function PX(r,{refreshToken:e}){const t=SX(r);return t.append("Authorization",function Ybe(r){return`${yX} ${r}`}(e)),t}(r,t),s=e.getImmediate({optional:!0});if(s){const l=yield s.getHeartbeatsHeader();l&&i.append("x-firebase-client",l)}const a={method:"POST",headers:i,body:JSON.stringify({installation:{sdkVersion:CX,appId:r.appId}})},c=yield Ew(()=>fetch(n,a));if(c.ok)return EX(yield c.json());throw yield yw("Generate Auth Token",c)}),zw.apply(this,arguments)}function Dw(r){return Hw.apply(this,arguments)}function Hw(){return Hw=M(function*(r,e=!1){let t;const n=yield F9(r.appConfig,s=>{if(!xX(s))throw G3.create("not-registered");const o=s.authToken;if(!e&&function gwe(r){return 2===r.requestStatus&&!function mwe(r){const e=Date.now();return e<r.creationTime||r.creationTime+r.expiresIn<e+Ube}(r)}(o))return s;if(1===o.requestStatus)return t=function hwe(r,e){return Vw.apply(this,arguments)}(r,e),s;{if(!navigator.onLine)throw G3.create("app-offline");const a=function _we(r){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},r),{authToken:e})}(s);return t=function pwe(r,e){return Fw.apply(this,arguments)}(r,a),a}});return t?yield t:n.authToken}),Hw.apply(this,arguments)}function Vw(){return Vw=M(function*(r,e){let t=yield kX(r.appConfig);for(;1===t.authToken.requestStatus;)yield TX(100),t=yield kX(r.appConfig);const n=t.authToken;return 0===n.requestStatus?Dw(r,e):n}),Vw.apply(this,arguments)}function kX(r){return F9(r,e=>{if(!xX(e))throw G3.create("not-registered");return function vwe(r){return 1===r.requestStatus&&r.requestTime+vX<Date.now()}(e.authToken)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}function Fw(){return Fw=M(function*(r,e){try{const t=yield function fwe(r,e){return zw.apply(this,arguments)}(r,e),n=Object.assign(Object.assign({},e),{authToken:t});return yield N_(r.appConfig,n),t}catch(t){if(!MX(t)||401!==t.customData.serverCode&&404!==t.customData.serverCode){const n=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});yield N_(r.appConfig,n)}else yield Aw(r.appConfig);throw t}}),Fw.apply(this,arguments)}function xX(r){return void 0!==r&&2===r.registrationStatus}function $w(){return $w=M(function*(r){const e=r,{installationEntry:t,registrationPromise:n}=yield kw(e);return n?n.catch(console.error):Dw(e).catch(console.error),t.fid}),$w.apply(this,arguments)}function Gw(){return Gw=M(function*(r,e=!1){const t=r;return yield function Mwe(r){return Bw.apply(this,arguments)}(t),(yield Dw(t,e)).token}),Gw.apply(this,arguments)}function Bw(){return Bw=M(function*(r){const{registrationPromise:e}=yield kw(r);e&&(yield e)}),Bw.apply(this,arguments)}function qw(r){return G3.create("missing-app-config-values",{valueName:r})}const LX="installations",Owe=r=>{const e=r.getProvider("app").getImmediate(),t=function Pwe(r){if(!r||!r.options)throw qw("App Configuration");if(!r.name)throw qw("App Name");const e=["projectId","apiKey","appId"];for(const t of e)if(!r.options[t])throw qw(t);return{appName:r.name,projectId:r.options.projectId,apiKey:r.options.apiKey,appId:r.options.appId}}(e);return{app:e,appConfig:t,heartbeatServiceProvider:e5(e,"heartbeat"),_delete:()=>Promise.resolve()}},bwe=r=>{const t=e5(r.getProvider("app").getImmediate(),LX).getImmediate();return{getId:()=>function Cwe(r){return $w.apply(this,arguments)}(t),getToken:i=>function ywe(r){return Gw.apply(this,arguments)}(t,i)}};(function wwe(){cs(new Ii(LX,Owe,"PUBLIC")),cs(new Ii("installations-internal",bwe,"PRIVATE"))})(),Mr(_X,vw),Mr(_X,vw,"esm2017");const jw="@firebase/remote-config",zs=new Sc("remoteconfig","Remote Config",{"registration-window":"Undefined window object. This SDK only supports usage in a browser environment.","registration-project-id":"Undefined project identifier. Check Firebase app initialization.","registration-api-key":"Undefined API key. Check Firebase app initialization.","registration-app-id":"Undefined app identifier. Check Firebase app initialization.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}.","fetch-client-network":"Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-timeout":'The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',"fetch-throttle":'The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',"fetch-client-parse":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","indexed-db-unavailable":"Indexed DB is not supported by current browser"});class Vwe{constructor(e,t,n,i){this.client=e,this.storage=t,this.storageCache=n,this.logger=i}isCachedDataFresh(e,t){if(!t)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;const n=Date.now()-t,i=n<=e;return this.logger.debug(`Config fetch cache check. Cache age millis: ${n}. Cache max age millis (minimumFetchIntervalMillis setting): ${e}. Is cache hit: ${i}.`),i}fetch(e){var t=this;return M(function*(){const[n,i]=yield Promise.all([t.storage.getLastSuccessfulFetchTimestampMillis(),t.storage.getLastSuccessfulFetchResponse()]);if(i&&t.isCachedDataFresh(e.cacheMaxAgeMillis,n))return i;e.eTag=i&&i.eTag;const s=yield t.client.fetch(e),o=[t.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())];return 200===s.status&&o.push(t.storage.setLastSuccessfulFetchResponse(s)),yield Promise.all(o),s})()}}function Fwe(r=navigator){return r.languages&&r.languages[0]||r.language}class $we{constructor(e,t,n,i,s,o){this.firebaseInstallations=e,this.sdkVersion=t,this.namespace=n,this.projectId=i,this.apiKey=s,this.appId=o}fetch(e){var t=this;return M(function*(){const[n,i]=yield Promise.all([t.firebaseInstallations.getId(),t.firebaseInstallations.getToken()]),o=`${window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com"}/v1/projects/${t.projectId}/namespaces/${t.namespace}:fetch?key=${t.apiKey}`,a={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":e.eTag||"*"},c={sdk_version:t.sdkVersion,app_instance_id:n,app_instance_id_token:i,app_id:t.appId,language_code:Fwe()},l={method:"POST",headers:a,body:JSON.stringify(c)},f=fetch(o,l),d=new Promise(($,G)=>{e.signal.addEventListener(()=>{const de=new Error("The operation was aborted.");de.name="AbortError",G(de)})});let m;try{yield Promise.race([f,d]),m=yield f}catch($){let G="fetch-client-network";throw"AbortError"===$?.name&&(G="fetch-timeout"),zs.create(G,{originalErrorMessage:$?.message})}let E=m.status;const w=m.headers.get("ETag")||void 0;let R,z;if(200===m.status){let $;try{$=yield m.json()}catch(G){throw zs.create("fetch-client-parse",{originalErrorMessage:G?.message})}R=$.entries,z=$.state}if("INSTANCE_STATE_UNSPECIFIED"===z?E=500:"NO_CHANGE"===z?E=304:("NO_TEMPLATE"===z||"EMPTY_CONFIG"===z)&&(R={}),304!==E&&200!==E)throw zs.create("fetch-status",{httpStatus:E});return{status:E,eTag:w,config:R}})()}}class Uwe{constructor(e,t){this.client=e,this.storage=t}fetch(e){var t=this;return M(function*(){const n=(yield t.storage.getThrottleMetadata())||{backoffCount:0,throttleEndTimeMillis:Date.now()};return t.attemptFetch(e,n)})()}attemptFetch(e,{throttleEndTimeMillis:t,backoffCount:n}){var i=this;return M(function*(){yield function Gwe(r,e){return new Promise((t,n)=>{const i=Math.max(e-Date.now(),0),s=setTimeout(t,i);r.addEventListener(()=>{clearTimeout(s),n(zs.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}(e.signal,t);try{const s=yield i.client.fetch(e);return yield i.storage.deleteThrottleMetadata(),s}catch(s){if(!function Bwe(r){if(!(r instanceof Lo&&r.customData))return!1;const e=Number(r.customData.httpStatus);return 429===e||500===e||503===e||504===e}(s))throw s;const o={throttleEndTimeMillis:Date.now()+YP(n),backoffCount:n+1};return yield i.storage.setThrottleMetadata(o),i.attemptFetch(e,o)}})()}}class jwe{constructor(e,t,n,i,s){this.app=e,this._client=t,this._storageCache=n,this._storage=i,this._logger=s,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:6e4,minimumFetchIntervalMillis:432e5},this.defaultConfig={}}get fetchTimeMillis(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1}get lastFetchStatus(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"}}function k_(r,e){const t=r.target.error||void 0;return zs.create(e,{originalErrorMessage:t&&t?.message})}const o0="app_namespace_store";class Xwe{constructor(e,t,n,i=function Kwe(){return new Promise((r,e)=>{try{const t=indexedDB.open("firebase_remote_config",1);t.onerror=n=>{e(k_(n,"storage-open"))},t.onsuccess=n=>{r(n.target.result)},t.onupgradeneeded=n=>{0===n.oldVersion&&n.target.result.createObjectStore(o0,{keyPath:"compositeKey"})}}catch(t){e(zs.create("storage-open",{originalErrorMessage:t?.message}))}})}()){this.appId=e,this.appName=t,this.namespace=n,this.openDbPromise=i}getLastFetchStatus(){return this.get("last_fetch_status")}setLastFetchStatus(e){return this.set("last_fetch_status",e)}getLastSuccessfulFetchTimestampMillis(){return this.get("last_successful_fetch_timestamp_millis")}setLastSuccessfulFetchTimestampMillis(e){return this.set("last_successful_fetch_timestamp_millis",e)}getLastSuccessfulFetchResponse(){return this.get("last_successful_fetch_response")}setLastSuccessfulFetchResponse(e){return this.set("last_successful_fetch_response",e)}getActiveConfig(){return this.get("active_config")}setActiveConfig(e){return this.set("active_config",e)}getActiveConfigEtag(){return this.get("active_config_etag")}setActiveConfigEtag(e){return this.set("active_config_etag",e)}getThrottleMetadata(){return this.get("throttle_metadata")}setThrottleMetadata(e){return this.set("throttle_metadata",e)}deleteThrottleMetadata(){return this.delete("throttle_metadata")}get(e){var t=this;return M(function*(){const n=yield t.openDbPromise;return new Promise((i,s)=>{const a=n.transaction([o0],"readonly").objectStore(o0),c=t.createCompositeKey(e);try{const l=a.get(c);l.onerror=f=>{s(k_(f,"storage-get"))},l.onsuccess=f=>{const d=f.target.result;i(d?d.value:void 0)}}catch(l){s(zs.create("storage-get",{originalErrorMessage:l?.message}))}})})()}set(e,t){var n=this;return M(function*(){const i=yield n.openDbPromise;return new Promise((s,o)=>{const c=i.transaction([o0],"readwrite").objectStore(o0),l=n.createCompositeKey(e);try{const f=c.put({compositeKey:l,value:t});f.onerror=d=>{o(k_(d,"storage-set"))},f.onsuccess=()=>{s()}}catch(f){o(zs.create("storage-set",{originalErrorMessage:f?.message}))}})})()}delete(e){var t=this;return M(function*(){const n=yield t.openDbPromise;return new Promise((i,s)=>{const a=n.transaction([o0],"readwrite").objectStore(o0),c=t.createCompositeKey(e);try{const l=a.delete(c);l.onerror=f=>{s(k_(f,"storage-delete"))},l.onsuccess=()=>{i()}}catch(l){s(zs.create("storage-delete",{originalErrorMessage:l?.message}))}})})()}createCompositeKey(e){return[this.appId,this.appName,this.namespace,e].join()}}class Qwe{constructor(e){this.storage=e}getLastFetchStatus(){return this.lastFetchStatus}getLastSuccessfulFetchTimestampMillis(){return this.lastSuccessfulFetchTimestampMillis}getActiveConfig(){return this.activeConfig}loadFromStorage(){var e=this;return M(function*(){const t=e.storage.getLastFetchStatus(),n=e.storage.getLastSuccessfulFetchTimestampMillis(),i=e.storage.getActiveConfig(),s=yield t;s&&(e.lastFetchStatus=s);const o=yield n;o&&(e.lastSuccessfulFetchTimestampMillis=o);const a=yield i;a&&(e.activeConfig=a)})()}setLastFetchStatus(e){return this.lastFetchStatus=e,this.storage.setLastFetchStatus(e)}setLastSuccessfulFetchTimestampMillis(e){return this.lastSuccessfulFetchTimestampMillis=e,this.storage.setLastSuccessfulFetchTimestampMillis(e)}setActiveConfig(e){return this.activeConfig=e,this.storage.setActiveConfig(e)}}function eAe(){return Qw.apply(this,arguments)}function Qw(){return(Qw=M(function*(){if(!N6())return!1;try{return yield wf()}catch{return!1}})).apply(this,arguments)}!function Jwe(){cs(new Ii("remote-config",function r(e,{instanceIdentifier:t}){const n=e.getProvider("app").getImmediate(),i=e.getProvider("installations-internal").getImmediate();if(typeof window>"u")throw zs.create("registration-window");if(!N6())throw zs.create("indexed-db-unavailable");const{projectId:s,apiKey:o,appId:a}=n.options;if(!s)throw zs.create("registration-project-id");if(!o)throw zs.create("registration-api-key");if(!a)throw zs.create("registration-app-id");const c=new Xwe(a,n.name,t=t||"firebase"),l=new Qwe(c),f=new J8(jw);f.logLevel=Bn.ERROR;const d=new $we(i,L6,t,s,o,a),m=new Uwe(d,c),E=new Vwe(m,c,l,f),w=new jwe(n,E,l,c,f);return function zwe(r){const e=yr(r);e._initializePromise||(e._initializePromise=e._storageCache.loadFromStorage().then(()=>{e._isInitializationComplete=!0}))}(w),w},"PUBLIC").setMultipleInstances(!0)),Mr(jw,"0.4.4"),Mr(jw,"0.4.4","esm2017")}();const tAe=(r,e)=>e.some(t=>r instanceof t);let HX,VX;const FX=new WeakMap,Jw=new WeakMap,$X=new WeakMap,eA=new WeakMap,tA=new WeakMap;let nA={get(r,e,t){if(r instanceof IDBTransaction){if("done"===e)return Jw.get(r);if("objectStoreNames"===e)return r.objectStoreNames||$X.get(r);if("store"===e)return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return B3(r[e])},set:(r,e,t)=>(r[e]=t,!0),has:(r,e)=>r instanceof IDBTransaction&&("done"===e||"store"===e)||e in r};function cAe(r){return"function"==typeof r?function aAe(r){return r!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function rAe(){return VX||(VX=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(r)?function(...e){return r.apply(rA(this),e),B3(FX.get(this))}:function(...e){return B3(r.apply(rA(this),e))}:function(e,...t){const n=r.call(rA(this),e,...t);return $X.set(n,e.sort?e.sort():[e]),B3(n)}}(r):(r instanceof IDBTransaction&&function sAe(r){if(Jw.has(r))return;const e=new Promise((t,n)=>{const i=()=>{r.removeEventListener("complete",s),r.removeEventListener("error",o),r.removeEventListener("abort",o)},s=()=>{t(),i()},o=()=>{n(r.error||new DOMException("AbortError","AbortError")),i()};r.addEventListener("complete",s),r.addEventListener("error",o),r.addEventListener("abort",o)});Jw.set(r,e)}(r),tAe(r,function nAe(){return HX||(HX=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(r,nA):r)}function B3(r){if(r instanceof IDBRequest)return function iAe(r){const e=new Promise((t,n)=>{const i=()=>{r.removeEventListener("success",s),r.removeEventListener("error",o)},s=()=>{t(B3(r.result)),i()},o=()=>{n(r.error),i()};r.addEventListener("success",s),r.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&FX.set(t,r)}).catch(()=>{}),tA.set(e,r),e}(r);if(eA.has(r))return eA.get(r);const e=cAe(r);return e!==r&&(eA.set(r,e),tA.set(e,r)),e}const rA=r=>tA.get(r);function GX(r,e,{blocked:t,upgrade:n,blocking:i,terminated:s}={}){const o=indexedDB.open(r,e),a=B3(o);return n&&o.addEventListener("upgradeneeded",c=>{n(B3(o.result),c.oldVersion,c.newVersion,B3(o.transaction))}),t&&o.addEventListener("blocked",()=>t()),a.then(c=>{s&&c.addEventListener("close",()=>s()),i&&c.addEventListener("versionchange",()=>i())}).catch(()=>{}),a}function iA(r,{blocked:e}={}){const t=indexedDB.deleteDatabase(r);return e&&t.addEventListener("blocked",()=>e()),B3(t).then(()=>{})}const lAe=["get","getKey","getAll","getAllKeys","count"],uAe=["put","add","delete","clear"],sA=new Map;function BX(r,e){if(!(r instanceof IDBDatabase)||e in r||"string"!=typeof e)return;if(sA.get(e))return sA.get(e);const t=e.replace(/FromIndex$/,""),n=e!==t,i=uAe.includes(t);if(!(t in(n?IDBIndex:IDBObjectStore).prototype)||!i&&!lAe.includes(t))return;const s=function(){var o=M(function*(a,...c){const l=this.transaction(a,i?"readwrite":"readonly");let f=l.store;return n&&(f=f.index(c.shift())),(yield Promise.all([f[t](...c),i&&l.done]))[0]});return function(c){return o.apply(this,arguments)}}();return sA.set(e,s),s}!function oAe(r){nA=r(nA)}(r=>({...r,get:(e,t,n)=>BX(e,t)||r.get(e,t,n),has:(e,t)=>!!BX(e,t)||r.has(e,t)}));const fAe="/firebase-messaging-sw.js",dAe="/firebase-cloud-messaging-push-scope",UX="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",hAe="https://fcmregistrations.googleapis.com/v1",WX="google.c.a.c_id",pAe="google.c.a.c_l",gAe="google.c.a.ts";var x_=function(r){return r.PUSH_RECEIVED="push-received",r.NOTIFICATION_CLICKED="notification-clicked",r}(x_||{});function U3(r){const e=new Uint8Array(r);return btoa(String.fromCharCode(...e)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function vAe(r){const t=(r+"=".repeat((4-r.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),n=atob(t),i=new Uint8Array(n.length);for(let s=0;s<n.length;++s)i[s]=n.charCodeAt(s);return i}const oA="fcm_token_details_db",CAe=5,qX="fcm_token_object_Store";function aA(){return aA=M(function*(r){if("databases"in indexedDB&&!(yield indexedDB.databases()).map(s=>s.name).includes(oA))return null;let e=null;return(yield GX(oA,CAe,{upgrade:(n=M(function*(i,s,o,a){var c;if(s<2||!i.objectStoreNames.contains(qX))return;const l=a.objectStore(qX),f=yield l.index("fcmSenderId").get(r);if(yield l.clear(),f)if(2===s){const d=f;if(!d.auth||!d.p256dh||!d.endpoint)return;e={token:d.fcmToken,createTime:null!==(c=d.createTime)&&void 0!==c?c:Date.now(),subscriptionOptions:{auth:d.auth,p256dh:d.p256dh,endpoint:d.endpoint,swScope:d.swScope,vapidKey:"string"==typeof d.vapidKey?d.vapidKey:U3(d.vapidKey)}}}else if(3===s){const d=f;e={token:d.fcmToken,createTime:d.createTime,subscriptionOptions:{auth:U3(d.auth),p256dh:U3(d.p256dh),endpoint:d.endpoint,swScope:d.swScope,vapidKey:U3(d.vapidKey)}}}else if(4===s){const d=f;e={token:d.fcmToken,createTime:d.createTime,subscriptionOptions:{auth:U3(d.auth),p256dh:U3(d.p256dh),endpoint:d.endpoint,swScope:d.swScope,vapidKey:U3(d.vapidKey)}}}}),function(s,o,a,c){return n.apply(this,arguments)})})).close(),yield iA(oA),yield iA("fcm_vapid_details_db"),yield iA("undefined"),function MAe(r){if(!r||!r.subscriptionOptions)return!1;const{subscriptionOptions:e}=r;return"number"==typeof r.createTime&&r.createTime>0&&"string"==typeof r.token&&r.token.length>0&&"string"==typeof e.auth&&e.auth.length>0&&"string"==typeof e.p256dh&&e.p256dh.length>0&&"string"==typeof e.endpoint&&e.endpoint.length>0&&"string"==typeof e.swScope&&e.swScope.length>0&&"string"==typeof e.vapidKey&&e.vapidKey.length>0}(e)?e:null;var n}),aA.apply(this,arguments)}const EAe="firebase-messaging-database",SAe=1,a0="firebase-messaging-store";let cA=null;function lA(){return cA||(cA=GX(EAe,SAe,{upgrade:(r,e)=>{0===e&&r.createObjectStore(a0)}})),cA}function jX(r){return uA.apply(this,arguments)}function uA(){return uA=M(function*(r){const e=pA(r),n=yield(yield lA()).transaction(a0).objectStore(a0).get(e);if(n)return n;{const i=yield function yAe(r){return aA.apply(this,arguments)}(r.appConfig.senderId);if(i)return yield fA(r,i),i}}),uA.apply(this,arguments)}function fA(r,e){return dA.apply(this,arguments)}function dA(){return dA=M(function*(r,e){const t=pA(r),i=(yield lA()).transaction(a0,"readwrite");return yield i.objectStore(a0).put(e,t),yield i.done,e}),dA.apply(this,arguments)}function hA(){return hA=M(function*(r){const e=pA(r),n=(yield lA()).transaction(a0,"readwrite");yield n.objectStore(a0).delete(e),yield n.done}),hA.apply(this,arguments)}function pA({appConfig:r}){return r.appId}const ci=new Sc("messaging","Messaging",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."});function OAe(r,e){return gA.apply(this,arguments)}function gA(){return gA=M(function*(r,e){const t=yield CA(r),n=YX(e),i={method:"POST",headers:t,body:JSON.stringify(n)};let s;try{s=yield(yield fetch(vA(r.appConfig),i)).json()}catch(o){throw ci.create("token-subscribe-failed",{errorInfo:o?.toString()})}if(s.error)throw ci.create("token-subscribe-failed",{errorInfo:s.error.message});if(!s.token)throw ci.create("token-subscribe-no-token");return s.token}),gA.apply(this,arguments)}function mA(){return mA=M(function*(r,e){const t=yield CA(r),n=YX(e.subscriptionOptions),i={method:"PATCH",headers:t,body:JSON.stringify(n)};let s;try{s=yield(yield fetch(`${vA(r.appConfig)}/${e.token}`,i)).json()}catch(o){throw ci.create("token-update-failed",{errorInfo:o?.toString()})}if(s.error)throw ci.create("token-update-failed",{errorInfo:s.error.message});if(!s.token)throw ci.create("token-update-no-token");return s.token}),mA.apply(this,arguments)}function ZX(r,e){return _A.apply(this,arguments)}function _A(){return _A=M(function*(r,e){const n={method:"DELETE",headers:yield CA(r)};try{const s=yield(yield fetch(`${vA(r.appConfig)}/${e}`,n)).json();if(s.error)throw ci.create("token-unsubscribe-failed",{errorInfo:s.error.message})}catch(i){throw ci.create("token-unsubscribe-failed",{errorInfo:i?.toString()})}}),_A.apply(this,arguments)}function vA({projectId:r}){return`${hAe}/projects/${r}/registrations`}function CA(r){return yA.apply(this,arguments)}function yA(){return yA=M(function*({appConfig:r,installations:e}){const t=yield e.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":r.apiKey,"x-goog-firebase-installations-auth":`FIS ${t}`})}),yA.apply(this,arguments)}function YX({p256dh:r,auth:e,endpoint:t,vapidKey:n}){const i={web:{endpoint:t,auth:e,p256dh:r}};return n!==UX&&(i.web.applicationPubKey=n),i}const wAe=6048e5;function MA(){return MA=M(function*(r){const e=yield function IAe(r,e){return TA.apply(this,arguments)}(r.swRegistration,r.vapidKey),t={vapidKey:r.vapidKey,swScope:r.swRegistration.scope,endpoint:e.endpoint,auth:U3(e.getKey("auth")),p256dh:U3(e.getKey("p256dh"))},n=yield jX(r.firebaseDependencies);if(n){if(function kAe(r,e){return e.vapidKey===r.vapidKey&&e.endpoint===r.endpoint&&e.auth===r.auth&&e.p256dh===r.p256dh}(n.subscriptionOptions,t))return Date.now()>=n.createTime+wAe?function NAe(r,e){return SA.apply(this,arguments)}(r,{token:n.token,createTime:Date.now(),subscriptionOptions:t}):n.token;try{yield ZX(r.firebaseDependencies,n.token)}catch(i){console.warn(i)}return XX(r.firebaseDependencies,t)}return XX(r.firebaseDependencies,t)}),MA.apply(this,arguments)}function EA(){return EA=M(function*(r){const e=yield jX(r.firebaseDependencies);e&&(yield ZX(r.firebaseDependencies,e.token),yield function PAe(r){return hA.apply(this,arguments)}(r.firebaseDependencies));const t=yield r.swRegistration.pushManager.getSubscription();return!t||t.unsubscribe()}),EA.apply(this,arguments)}function SA(){return SA=M(function*(r,e){try{const t=yield function bAe(r,e){return mA.apply(this,arguments)}(r.firebaseDependencies,e),n=Object.assign(Object.assign({},e),{token:t,createTime:Date.now()});return yield fA(r.firebaseDependencies,n),t}catch(t){throw yield function KX(r){return EA.apply(this,arguments)}(r),t}}),SA.apply(this,arguments)}function XX(r,e){return PA.apply(this,arguments)}function PA(){return PA=M(function*(r,e){const n={token:yield OAe(r,e),createTime:Date.now(),subscriptionOptions:e};return yield fA(r,n),n.token}),PA.apply(this,arguments)}function TA(){return TA=M(function*(r,e){return(yield r.pushManager.getSubscription())||r.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:vAe(e)})}),TA.apply(this,arguments)}function QX(r){const e={from:r.from,collapseKey:r.collapse_key,messageId:r.fcmMessageId};return function xAe(r,e){if(!e.notification)return;r.notification={};const t=e.notification.title;t&&(r.notification.title=t);const n=e.notification.body;n&&(r.notification.body=n);const i=e.notification.image;i&&(r.notification.image=i);const s=e.notification.icon;s&&(r.notification.icon=s)}(e,r),function LAe(r,e){e.data&&(r.data=e.data)}(e,r),function RAe(r,e){var t,n,i,s,o;if(!(e.fcmOptions||null!==(t=e.notification)&&void 0!==t&&t.click_action))return;r.fcmOptions={};const a=null!==(i=null===(n=e.fcmOptions)||void 0===n?void 0:n.link)&&void 0!==i?i:null===(s=e.notification)||void 0===s?void 0:s.click_action;a&&(r.fcmOptions.link=a);const c=null===(o=e.fcmOptions)||void 0===o?void 0:o.analytics_label;c&&(r.fcmOptions.analyticsLabel=c)}(e,r),e}function JX(r,e){const t=[];for(let n=0;n<r.length;n++)t.push(r.charAt(n)),n<e.length&&t.push(e.charAt(n));return t.join("")}function OA(r){return ci.create("missing-app-config-values",{valueName:r})}JX("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),JX("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");class HAe{constructor(e,t,n){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const i=function DAe(r){if(!r||!r.options)throw OA("App Configuration Object");if(!r.name)throw OA("App Name");const e=["projectId","apiKey","appId","messagingSenderId"],{options:t}=r;for(const n of e)if(!t[n])throw OA(n);return{appName:r.name,projectId:t.projectId,apiKey:t.apiKey,appId:t.appId,senderId:t.messagingSenderId}}(e);this.firebaseDependencies={app:e,appConfig:i,installations:t,analyticsProvider:n}}_delete(){return Promise.resolve()}}function bA(){return bA=M(function*(r){try{r.swRegistration=yield navigator.serviceWorker.register(fAe,{scope:dAe}),r.swRegistration.update().catch(()=>{})}catch(e){throw ci.create("failed-service-worker-registration",{browserErrorMessage:e?.message})}}),bA.apply(this,arguments)}function wA(){return wA=M(function*(r,e){if(!e&&!r.swRegistration&&(yield function eQ(r){return bA.apply(this,arguments)}(r)),e||!r.swRegistration){if(!(e instanceof ServiceWorkerRegistration))throw ci.create("invalid-sw-registration");r.swRegistration=e}}),wA.apply(this,arguments)}function AA(){return AA=M(function*(r,e){e?r.vapidKey=e:r.vapidKey||(r.vapidKey=UX)}),AA.apply(this,arguments)}function NA(){return NA=M(function*(r,e){if(!navigator)throw ci.create("only-available-in-window");if("default"===Notification.permission&&(yield Notification.requestPermission()),"granted"!==Notification.permission)throw ci.create("permission-blocked");return yield function FAe(r,e){return AA.apply(this,arguments)}(r,e?.vapidKey),yield function VAe(r,e){return wA.apply(this,arguments)}(r,e?.serviceWorkerRegistration),function AAe(r){return MA.apply(this,arguments)}(r)}),NA.apply(this,arguments)}function IA(){return IA=M(function*(r,e,t){const n=function GAe(r){switch(r){case x_.NOTIFICATION_CLICKED:return"notification_open";case x_.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}(e);(yield r.firebaseDependencies.analyticsProvider.get()).logEvent(n,{message_id:t[WX],message_name:t[pAe],message_time:t[gAe],message_device_time:Math.floor(Date.now()/1e3)})}),IA.apply(this,arguments)}function kA(){return kA=M(function*(r,e){const t=e.data;if(!t.isFirebaseMessaging)return;r.onMessageHandler&&t.messageType===x_.PUSH_RECEIVED&&("function"==typeof r.onMessageHandler?r.onMessageHandler(QX(t)):r.onMessageHandler.next(QX(t)));const n=t.data;(function zAe(r){return"object"==typeof r&&!!r&&WX in r})(n)&&"1"===n["google.c.a.e"]&&(yield function $Ae(r,e,t){return IA.apply(this,arguments)}(r,t.messageType,n))}),kA.apply(this,arguments)}const nQ="@firebase/messaging",UAe=r=>{const e=new HAe(r.getProvider("app").getImmediate(),r.getProvider("installations-internal").getImmediate(),r.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",t=>function BAe(r,e){return kA.apply(this,arguments)}(e,t)),e},WAe=r=>{const e=r.getProvider("messaging").getImmediate();return{getToken:n=>function tQ(r,e){return NA.apply(this,arguments)}(e,n)}};function iQ(){return xA.apply(this,arguments)}function xA(){return(xA=M(function*(){try{yield wf()}catch{return!1}return typeof window<"u"&&N6()&&qP()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")})).apply(this,arguments)}!function qAe(){cs(new Ii("messaging",UAe,"PUBLIC")),cs(new Ii("messaging-internal",WAe,"PRIVATE")),Mr(nQ,"0.12.4"),Mr(nQ,"0.12.4","esm2017")}();const L_="analytics",YAe="firebase_id",KAe="origin",XAe=6e4,QAe="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",zA="https://www.googletagmanager.com/gtag/js",L2=new J8("@firebase/analytics"),fs=new Sc("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."});function eNe(r){if(!r.startsWith(zA)){const e=fs.create("invalid-gtag-resource",{gtagURL:r});return L2.warn(e.message),""}return r}function sQ(r){return Promise.all(r.map(e=>e.catch(t=>t)))}function DA(){return DA=M(function*(r,e,t,n,i,s){const o=n[i];try{if(o)yield e[o];else{const c=(yield sQ(t)).find(l=>l.measurementId===i);c&&(yield e[c.appId])}}catch(a){L2.error(a)}r("config",i,s)}),DA.apply(this,arguments)}function HA(){return HA=M(function*(r,e,t,n,i){try{let s=[];if(i&&i.send_to){let o=i.send_to;Array.isArray(o)||(o=[o]);const a=yield sQ(t);for(const c of o){const l=a.find(d=>d.measurementId===c),f=l&&e[l.appId];if(!f){s=[];break}s.push(f)}}0===s.length&&(s=Object.values(e)),yield Promise.all(s),r("event",n,i||{})}catch(s){L2.error(s)}}),HA.apply(this,arguments)}const lNe=30,oQ=new class fNe{constructor(e={},t=1e3){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}};function dNe(r){return new Headers({Accept:"application/json","x-goog-api-key":r})}function VA(){return VA=M(function*(r){var e;const{appId:t,apiKey:n}=r,i={method:"GET",headers:dNe(n)},s=QAe.replace("{app-id}",t),o=yield fetch(s,i);if(200!==o.status&&304!==o.status){let a="";try{const c=yield o.json();null!==(e=c.error)&&void 0!==e&&e.message&&(a=c.error.message)}catch{}throw fs.create("config-fetch-failed",{httpStatus:o.status,responseMessage:a})}return o.json()}),VA.apply(this,arguments)}function FA(){return FA=M(function*(r,e=oQ,t){const{appId:n,apiKey:i,measurementId:s}=r.options;if(!n)throw fs.create("no-app-id");if(!i){if(s)return{measurementId:s,appId:n};throw fs.create("no-api-key")}const o=e.getThrottleMetadata(n)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new _Ne;return setTimeout(M(function*(){a.abort()}),void 0!==t?t:XAe),aQ({appId:n,apiKey:i,measurementId:s},o,a,e)}),FA.apply(this,arguments)}function aQ(r,e,t){return $A.apply(this,arguments)}function $A(){return $A=M(function*(r,{throttleEndTimeMillis:e,backoffCount:t},n,i=oQ){var s;const{appId:o,measurementId:a}=r;try{yield function gNe(r,e){return new Promise((t,n)=>{const i=Math.max(e-Date.now(),0),s=setTimeout(t,i);r.addEventListener(()=>{clearTimeout(s),n(fs.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}(n,e)}catch(c){if(a)return L2.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${c?.message}]`),{appId:o,measurementId:a};throw c}try{const c=yield function hNe(r){return VA.apply(this,arguments)}(r);return i.deleteThrottleMetadata(o),c}catch(c){const l=c;if(!function mNe(r){if(!(r instanceof Lo&&r.customData))return!1;const e=Number(r.customData.httpStatus);return 429===e||500===e||503===e||504===e}(l)){if(i.deleteThrottleMetadata(o),a)return L2.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${l?.message}]`),{appId:o,measurementId:a};throw c}const f=503===Number(null===(s=l?.customData)||void 0===s?void 0:s.httpStatus)?YP(t,i.intervalMillis,lNe):YP(t,i.intervalMillis),d={throttleEndTimeMillis:Date.now()+f,backoffCount:t+1};return i.setThrottleMetadata(o,d),L2.debug(`Calling attemptFetch again in ${f} millis`),aQ(r,d,n,i)}}),$A.apply(this,arguments)}class _Ne{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}let GA,YA;function BA(){return BA=M(function*(r,e,t,n,i){if(i&&i.global)r("event",t,n);else{const s=yield e;r("event",t,Object.assign(Object.assign({},n),{send_to:s}))}}),BA.apply(this,arguments)}function KA(){return KA=M(function*(){if(!N6())return L2.warn(fs.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{yield wf()}catch(r){return L2.warn(fs.create("indexeddb-unavailable",{errorInfo:r?.toString()}).message),!1}return!0}),KA.apply(this,arguments)}function XA(){return XA=M(function*(r,e,t,n,i,s,o){var a;const c=function pNe(r){return FA.apply(this,arguments)}(r);c.then(E=>{t[E.measurementId]=E.appId,r.options.measurementId&&E.measurementId!==r.options.measurementId&&L2.warn(`The measurement ID in the local Firebase config (${r.options.measurementId}) does not match the measurement ID fetched from the server (${E.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(E=>L2.error(E)),e.push(c);const l=function PNe(){return KA.apply(this,arguments)}().then(E=>{if(E)return n.getId()}),[f,d]=yield Promise.all([c,l]);(function cNe(r){const e=window.document.getElementsByTagName("script");for(const t of Object.values(e))if(t.src&&t.src.includes(zA)&&t.src.includes(r))return t;return null})(s)||function nNe(r,e){const t=function tNe(r,e){let t;return window.trustedTypes&&(t=window.trustedTypes.createPolicy(r,e)),t}("firebase-js-sdk-policy",{createScriptURL:eNe}),n=document.createElement("script"),i=`${zA}?l=${r}&id=${e}`;n.src=t?t?.createScriptURL(i):i,n.async=!0,document.head.appendChild(n)}(s,f.measurementId),YA&&(i("consent","default",YA),function cQ(r){YA=r}(void 0)),i("js",new Date);const m=null!==(a=o?.config)&&void 0!==a?a:{};return m[KAe]="firebase",m.update=!0,null!=d&&(m[YAe]=d),i("config",f.measurementId,m),GA&&(i("set",GA),function lQ(r){GA=r}(void 0)),f.measurementId}),XA.apply(this,arguments)}class ONe{constructor(e){this.app=e}_delete(){return delete xc[this.app.options.appId],Promise.resolve()}}let xc={},uQ=[];const fQ={};let hQ,Lc,R_="dataLayer",QA=!1;function wNe(r,e,t){!function bNe(){const r=[];if(WP()&&r.push("This is a browser extension environment."),qP()||r.push("Cookies are not available."),r.length>0){const e=r.map((n,i)=>`(${i+1}) ${n}`).join(" "),t=fs.create("invalid-analytics-context",{errorInfo:e});L2.warn(t.message)}}();const n=r.options.appId;if(!n)throw fs.create("no-app-id");if(!r.options.apiKey){if(!r.options.measurementId)throw fs.create("no-api-key");L2.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${r.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=xc[n])throw fs.create("already-exists",{id:n});if(!QA){!function rNe(r){let e=[];Array.isArray(window[r])?e=window[r]:window[r]=e}(R_);const{wrappedGtag:s,gtagCore:o}=function aNe(r,e,t,n,i){let s=function(...o){window[n].push(arguments)};return window[i]&&"function"==typeof window[i]&&(s=window[i]),window[i]=function oNe(r,e,t,n){function s(){return s=M(function*(o,...a){try{if("event"===o){const[c,l]=a;yield function sNe(r,e,t,n,i){return HA.apply(this,arguments)}(r,e,t,c,l)}else if("config"===o){const[c,l]=a;yield function iNe(r,e,t,n,i,s){return DA.apply(this,arguments)}(r,e,t,n,c,l)}else if("consent"===o){const[c]=a;r("consent","update",c)}else if("get"===o){const[c,l,f]=a;r("get",c,l,f)}else if("set"===o){const[c]=a;r("set",c)}else r(o,...a)}catch(c){L2.error(c)}}),s.apply(this,arguments)}return function i(o){return s.apply(this,arguments)}}(s,r,e,t),{gtagCore:s,wrappedGtag:window[i]}}(xc,uQ,fQ,R_,"gtag");Lc=s,hQ=o,QA=!0}return xc[n]=function TNe(r,e,t,n,i,s,o){return XA.apply(this,arguments)}(r,uQ,fQ,e,hQ,R_,t),new ONe(r)}function NNe(){return JA.apply(this,arguments)}function JA(){return(JA=M(function*(){if(WP()||!qP()||!N6())return!1;try{return yield wf()}catch{return!1}})).apply(this,arguments)}const pQ="@firebase/analytics";!function kNe(){cs(new Ii(L_,(e,{options:t})=>wNe(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),t),"PUBLIC")),cs(new Ii("analytics-internal",function r(e){try{const t=e.getProvider(L_).getImmediate();return{logEvent:(n,i,s)=>function INe(r,e,t,n){r=yr(r),function vNe(r,e,t,n,i){return BA.apply(this,arguments)}(Lc,xc[r.app.options.appId],e,t,n).catch(i=>L2.error(i))}(t,n,i,s)}}catch(t){throw fs.create("interop-component-reg-failed",{reason:t})}},"PRIVATE")),Mr(pQ,"0.10.0"),Mr(pQ,"0.10.0","esm2017")}();class xNe extends yn{constructor(e,t){super()}schedule(e,t=0){return this}}const z_={setInterval(r,e,...t){const{delegate:n}=z_;return n?.setInterval?n.setInterval(r,e,...t):setInterval(r,e,...t)},clearInterval(r){const{delegate:e}=z_;return(e?.clearInterval||clearInterval)(r)},delegate:void 0};class mQ extends xNe{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){var n;if(this.closed)return this;this.state=e;const i=this.id,s=this.scheduler;return null!=i&&(this.id=this.recycleAsyncId(s,i,t)),this.pending=!0,this.delay=t,this.id=null!==(n=this.id)&&void 0!==n?n:this.requestAsyncId(s,this.id,t),this}requestAsyncId(e,t,n=0){return z_.setInterval(e.flush.bind(e,this),n)}recycleAsyncId(e,t,n=0){if(null!=n&&this.delay===n&&!1===this.pending)return t;null!=t&&z_.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let i,n=!1;try{this.work(e)}catch(s){n=!0,i=s||new Error("Scheduled action threw falsy error")}if(n)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){const{id:e,scheduler:t}=this,{actions:n}=t;this.work=this.state=this.scheduler=null,this.pending=!1,o3(n,this),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}}const tN={now:()=>(tN.delegate||Date).now(),delegate:void 0};class $9{constructor(e,t=$9.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,n){return new this.schedulerActionCtor(this,e).schedule(n,t)}}$9.now=tN.now;class _Q extends $9{constructor(e,t=$9.now){super(e,t),this.actions=[],this._active=!1}flush(e){const{actions:t}=this;if(this._active)return void t.push(e);let n;this._active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}}const zNe=new class RNe extends _Q{}(class LNe extends mQ{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}schedule(e,t=0){return t>0?super.schedule(e,t):(this.delay=t,this.state=e,this.scheduler.flush(this),this)}execute(e,t){return t>0||this.closed?super.execute(e,t):this._execute(e,t)}requestAsyncId(e,t,n=0){return null!=n&&n>0||null==n&&this.delay>0?super.requestAsyncId(e,t,n):(e.flush(this),0)}}),DNe=new _Q(mQ),D_=new C8("7.6.1"),nN="__angularfire_symbol__analyticsIsSupportedValue",rN="__angularfire_symbol__analyticsIsSupported",iN="__angularfire_symbol__remoteConfigIsSupportedValue",sN="__angularfire_symbol__remoteConfigIsSupported",oN="__angularfire_symbol__messagingIsSupportedValue",aN="__angularfire_symbol__messagingIsSupported";function lN(r,e,t){if(e){if(1===e.length)return e[0];const s=e.filter(o=>o.app===t);if(1===s.length)return s[0]}return t.container.getProvider(r).getImmediate({optional:!0})}globalThis[rN]||(globalThis[rN]=NNe().then(r=>globalThis[nN]=r).catch(()=>globalThis[nN]=!1)),globalThis[aN]||(globalThis[aN]=iQ().then(r=>globalThis[oN]=r).catch(()=>globalThis[oN]=!1)),globalThis[sN]||(globalThis[sN]=eAe().then(r=>globalThis[iN]=r).catch(()=>globalThis[iN]=!1));const uN=(r,e)=>{const t=e?[e]:wq(),n=[];return t.forEach(i=>{i.container.getProvider(r).instances.forEach(o=>{n.includes(o)||n.push(o)})}),n};function $5(){}class vQ{constructor(e,t=zNe){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,n){const i=this.zone;return this.delegate.schedule(function(o){i.runGuarded(()=>{e.apply(this,[o])})},t,n)}}class HNe{constructor(e){this.zone=e,this.task=null}call(e,t){const n=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",$5,{},$5,$5)),t.pipe(Ni({next:n,complete:n,error:n})).subscribe(e).add(n)}unscheduleTask(){setTimeout(()=>{null!=this.task&&"scheduled"===this.task.state&&(this.task.invoke(),this.task=null)},10)}}let fN=(()=>{class r{constructor(t){this.ngZone=t,this.outsideAngular=t.runOutsideAngular(()=>new vQ(Zone.current)),this.insideAngular=t.run(()=>new vQ(Zone.current,DNe)),globalThis.\u0275AngularFireScheduler||(globalThis.\u0275AngularFireScheduler=this)}}return r.\u0275fac=function(t){return new(t||r)(Pe(c1))},r.\u0275prov=He({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();function c0(){const r=globalThis.\u0275AngularFireScheduler;if(!r)throw new Error("Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using\nprovideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).");return r}function l0(r){return c0().ngZone.run(()=>r())}function FNe(r){return c0(),function $Ne(r){return function(t){return(t=t.lift(new HNe(r.ngZone))).pipe(lh(r.outsideAngular),ch(r.insideAngular))}}(c0())(r)}const GNe=(r,e)=>function(){const n=arguments;return e&&setTimeout(()=>{"scheduled"===e.state&&e.invoke()},10),l0(()=>r.apply(void 0,n))},G1=(r,e)=>function(){let t;const n=arguments;for(let s=0;s<arguments.length;s++)"function"==typeof n[s]&&(e&&(t||(t=l0(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",$5,{},$5,$5)))),n[s]=GNe(n[s],t));const i=function VNe(r){return c0().ngZone.runOutsideAngular(()=>r())}(()=>r.apply(this,n));if(!e){if(i instanceof b1){const s=c0();return i.pipe(lh(s.outsideAngular),ch(s.insideAngular))}return l0(()=>i)}return i instanceof b1?i.pipe(FNe):i instanceof Promise?l0(()=>new Promise((s,o)=>i.then(a=>l0(()=>s(a)),a=>l0(()=>o(a))))):"function"==typeof i&&t?function(){return setTimeout(()=>{t&&"scheduled"===t.state&&t.invoke()},10),i.apply(this,arguments)}:l0(()=>i)};class G5{constructor(e){return e}}class dN{constructor(){return wq()}}const hN=new tt("angularfire2._apps"),UNe={provide:G5,useFactory:function BNe(r){return r&&1===r.length?r[0]:new G5(iT())},deps:[[new rs,hN]]},WNe={provide:dN,deps:[[new rs,hN]]};function qNe(r){return(e,t)=>{const n=e.runOutsideAngular(()=>r(t));return new G5(n)}}let jNe=(()=>{class r{constructor(t){Mr("angularfire",D_.full,"core"),Mr("angularfire",D_.full,"app"),Mr("angular",dH.full,t.toString())}}return r.\u0275fac=function(t){return new(t||r)(Pe(_3))},r.\u0275mod=Ei({type:r}),r.\u0275inj=X2({providers:[UNe,WNe]}),r})();const YNe=G1(bq,!0),pN=new Map,CQ={activated:!1,tokenObservers:[]},KNe={initialized:!1,enabled:!1};function Pr(r){return pN.get(r)||Object.assign({},CQ)}function H_(){return KNe}const gN="https://content-firebaseappcheck.googleapis.com/v1",eIe="exchangeDebugToken",yQ={OFFSET_DURATION:3e5,RETRIAL_MIN_WAIT:3e4,RETRIAL_MAX_WAIT:96e4};class nIe{constructor(e,t,n,i,s){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=n,this.lowerBound=i,this.upperBound=s,this.pending=null,this.nextErrorWaitInterval=i,i>s)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){var t=this;return M(function*(){t.stop();try{t.pending=new Jg,yield function rIe(r){return new Promise(e=>{setTimeout(e,r)})}(t.getNextRun(e)),t.pending.resolve(),yield t.pending.promise,t.pending=new Jg,yield t.operation(),t.pending.resolve(),yield t.pending.promise,t.process(!0).catch(()=>{})}catch(n){t.retryPolicy(n)?t.process(!1).catch(()=>{}):t.stop()}})()}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{const t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}}const li=new Sc("appCheck","AppCheck",{"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"});function mN(r){if(!Pr(r).activated)throw li.create("use-before-activation",{appName:r.name})}function $_(r,e){return vN.apply(this,arguments)}function vN(){return vN=M(function*({url:r,body:e},t){const n={"Content-Type":"application/json"},i=t.getImmediate({optional:!0});if(i){const d=yield i.getHeartbeatsHeader();d&&(n["X-Firebase-Client"]=d)}const s={method:"POST",body:JSON.stringify(e),headers:n};let o,a;try{o=yield fetch(r,s)}catch(d){throw li.create("fetch-network-error",{originalErrorMessage:d?.message})}if(200!==o.status)throw li.create("fetch-status-error",{httpStatus:o.status});try{a=yield o.json()}catch(d){throw li.create("fetch-parse-error",{originalErrorMessage:d?.message})}const c=a.ttl.match(/^([\d.]+)(s)$/);if(!c||!c[2]||isNaN(Number(c[1])))throw li.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${a.ttl}`});const l=1e3*Number(c[1]),f=Date.now();return{token:a.token,expireTimeMillis:f+l,issuedAtTimeMillis:f}}),vN.apply(this,arguments)}function MQ(r,e){const{projectId:t,appId:n,apiKey:i}=r.options;return{url:`${gN}/projects/${t}/apps/${n}:${eIe}?key=${i}`,body:{debug_token:e}}}const aIe="firebase-app-check-database",cIe=1,G9="firebase-app-check-store";let G_=null;function CN(){return CN=M(function*(r,e){const n=(yield function SQ(){return G_||(G_=new Promise((r,e)=>{try{const t=indexedDB.open(aIe,cIe);t.onsuccess=n=>{r(n.target.result)},t.onerror=n=>{var i;e(li.create("storage-open",{originalErrorMessage:null===(i=n.target.error)||void 0===i?void 0:i.message}))},t.onupgradeneeded=n=>{0===n.oldVersion&&n.target.result.createObjectStore(G9,{keyPath:"compositeKey"})}}catch(t){e(li.create("storage-open",{originalErrorMessage:t?.message}))}}),G_)}()).transaction(G9,"readwrite"),s=n.objectStore(G9).put({compositeKey:r,value:e});return new Promise((o,a)=>{s.onsuccess=c=>{o()},n.onerror=c=>{var l;a(li.create("storage-set",{originalErrorMessage:null===(l=c.target.error)||void 0===l?void 0:l.message}))}})}),CN.apply(this,arguments)}const B9=new J8("@firebase/app-check");function EN(r,e){return N6()?function uIe(r,e){return function PQ(r,e){return CN.apply(this,arguments)}(function OQ(r){return`${r.options.appId}-${r.name}`}(r),e)}(r,e).catch(t=>{B9.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function PN(){return H_().enabled}function TN(){return ON.apply(this,arguments)}function ON(){return ON=M(function*(){const r=H_();if(r.enabled&&r.token)return r.token.promise;throw Error("\n            Can't get debug token in production mode.\n        ")}),ON.apply(this,arguments)}const mIe={error:"UNKNOWN_ERROR"};function _Ie(r){return UP.encodeString(JSON.stringify(r),!1)}function B_(r){return bN.apply(this,arguments)}function bN(){return bN=M(function*(r,e=!1){const t=r.app;mN(t);const n=Pr(t);let s,i=n.token;if(i&&!B5(i)&&(n.token=void 0,i=void 0),!i){const c=yield n.cachedTokenPromise;c&&(B5(c)?i=c:yield EN(t,void 0))}if(!e&&i&&B5(i))return{token:i.token};let a,o=!1;if(PN()){n.exchangeTokenPromise||(n.exchangeTokenPromise=$_(MQ(t,yield TN()),r.heartbeatServiceProvider).finally(()=>{n.exchangeTokenPromise=void 0}),o=!0);const c=yield n.exchangeTokenPromise;return yield EN(t,c),n.token=c,{token:c.token}}try{n.exchangeTokenPromise||(n.exchangeTokenPromise=n.provider.getToken().finally(()=>{n.exchangeTokenPromise=void 0}),o=!0),i=yield Pr(t).exchangeTokenPromise}catch(c){"appCheck/throttled"===c.code?B9.warn(c.message):B9.error(c),s=c}return i?s?a=B5(i)?{token:i.token,internalError:s}:NQ(s):(a={token:i.token},n.token=i,yield EN(t,i)):a=NQ(s),o&&function AQ(r,e){const t=Pr(r).tokenObservers;for(const n of t)try{"EXTERNAL"===n.type&&null!=e.error?n.error(e.error):n.next(e)}catch{}}(t,a),a}),bN.apply(this,arguments)}function wN(){return wN=M(function*(r){const e=r.app;mN(e);const{provider:t}=Pr(e);if(PN()){const n=yield TN(),{token:i}=yield $_(MQ(e,n),r.heartbeatServiceProvider);return{token:i}}{const{token:n}=yield t.getToken();return{token:n}}}),wN.apply(this,arguments)}function NN(r,e){const t=Pr(r),n=t.tokenObservers.filter(i=>i.next!==e);0===n.length&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),t.tokenObservers=n}function wQ(r){const{app:e}=r,t=Pr(e);let n=t.tokenRefresher;n||(n=function vIe(r){const{app:e}=r;return new nIe(M(function*(){let n;if(n=Pr(e).token?yield B_(r,!0):yield B_(r),n.error)throw n.error;if(n.internalError)throw n.internalError}),()=>!0,()=>{const t=Pr(e);if(t.token){let n=t.token.issuedAtTimeMillis+.5*(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)+3e5;return n=Math.min(n,t.token.expireTimeMillis-3e5),Math.max(0,n-Date.now())}return 0},yQ.RETRIAL_MIN_WAIT,yQ.RETRIAL_MAX_WAIT)}(r),t.tokenRefresher=n),!n.isRunning()&&t.isTokenAutoRefreshEnabled&&n.start()}function B5(r){return r.expireTimeMillis-Date.now()>0}function NQ(r){return{token:_Ie(mIe),error:r}}class CIe{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){const{tokenObservers:e}=Pr(this.app);for(const t of e)NN(this.app,t.next);return Promise.resolve()}}const HQ="app-check-internal";!function xIe(){cs(new Ii("app-check",r=>function yIe(r,e){return new CIe(r,e)}(r.getProvider("app").getImmediate(),r.getProvider("heartbeat")),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((r,e,t)=>{r.getProvider(HQ).initialize()})),cs(new Ii(HQ,r=>function MIe(r){return{getToken:e=>B_(r,e),getLimitedUseToken:()=>function bQ(r){return wN.apply(this,arguments)}(r),addTokenListener:e=>function AN(r,e,t,n){const{app:i}=r,s=Pr(i);if(s.tokenObservers=[...s.tokenObservers,{next:t,error:n,type:e}],s.token&&B5(s.token)){const a=s.token;Promise.resolve().then(()=>{t({token:a.token}),wQ(r)}).catch(()=>{})}s.cachedTokenPromise.then(()=>wQ(r))}(r,"INTERNAL",e),removeTokenListener:e=>NN(r.app,e)}}(r.getProvider("app-check").getImmediate()),"PUBLIC").setInstantiationMode("EXPLICIT")),Mr("@firebase/app-check","0.8.0")}();class LN{constructor(){return uN("app-check")}}typeof window<"u"&&window;const HIe=function FQ(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},$Q=new Sc("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),W_=new J8("@firebase/auth");function q_(r,...e){W_.logLevel<=Bn.ERROR&&W_.error(`Auth (${L6}): ${r}`,...e)}function Ds(r,...e){throw zN(r,...e)}function fo(r,...e){return zN(r,...e)}function GQ(r,e,t){const n=Object.assign(Object.assign({},HIe()),{[e]:t});return new Sc("auth","Firebase",n).create(e,{appName:r.name})}function zN(r,...e){if("string"!=typeof r){const t=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=r.name),r._errorFactory.create(t,...n)}return $Q.create(r,...e)}function Ve(r,e,...t){if(!r)throw zN(e,...t)}function Rc(r){const e="INTERNAL ASSERTION FAILED: "+r;throw q_(e),new Error(e)}function W3(r,e){r||Rc(e)}function U9(){var r;return typeof self<"u"&&(null===(r=self.location)||void 0===r?void 0:r.href)||""}function BQ(){var r;return typeof self<"u"&&(null===(r=self.location)||void 0===r?void 0:r.protocol)||null}class W9{constructor(e,t){this.shortDelay=e,this.longDelay=t,W3(t>e,"Short delay should be less than long delay!"),this.isMobile=function dMe(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(w2())}()||function pMe(){return"object"==typeof navigator&&"ReactNative"===navigator.product}()}get(){return function FIe(){return!(typeof navigator<"u"&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(function DN(){return"http:"===BQ()||"https:"===BQ()}()||WP()||"connection"in navigator))||navigator.onLine}()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function HN(r,e){W3(r.emulator,"Emulator should always be set here");const{url:t}=r.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class UQ{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:typeof self<"u"&&"fetch"in self?self.fetch:void Rc("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:typeof self<"u"&&"Headers"in self?self.Headers:void Rc("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:typeof self<"u"&&"Response"in self?self.Response:void Rc("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const GIe={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},BIe=new W9(3e4,6e4);function cr(r,e){return r.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:r.tenantId}):e}function Tr(r,e,t,n){return VN.apply(this,arguments)}function VN(){return VN=M(function*(r,e,t,n,i={}){return WQ(r,i,M(function*(){let s={},o={};n&&("GET"===e?o=n:s={body:JSON.stringify(n)});const a=Af(Object.assign({key:r.config.apiKey},o)).slice(1),c=yield r._getAdditionalHeaders();return c["Content-Type"]="application/json",r.languageCode&&(c["X-Firebase-Locale"]=r.languageCode),UQ.fetch()(qQ(r,r.config.apiHost,t,a),Object.assign({method:e,headers:c,referrerPolicy:"no-referrer"},s))}))}),VN.apply(this,arguments)}function WQ(r,e,t){return FN.apply(this,arguments)}function FN(){return FN=M(function*(r,e,t){r._canInitEmulator=!1;const n=Object.assign(Object.assign({},GIe),e);try{const i=new UIe(r),s=yield Promise.race([t(),i.promise]);i.clearNetworkTimeout();const o=yield s.json();if("needConfirmation"in o)throw q9(r,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const a=s.ok?o.errorMessage:o.error.message,[c,l]=a.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===c)throw q9(r,"credential-already-in-use",o);if("EMAIL_EXISTS"===c)throw q9(r,"email-already-in-use",o);if("USER_DISABLED"===c)throw q9(r,"user-disabled",o);const f=n[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(l)throw GQ(r,f,l);Ds(r,f)}}catch(i){if(i instanceof Lo)throw i;Ds(r,"network-request-failed",{message:String(i)})}}),FN.apply(this,arguments)}function q3(r,e,t,n){return $N.apply(this,arguments)}function $N(){return $N=M(function*(r,e,t,n,i={}){const s=yield Tr(r,e,t,n,i);return"mfaPendingCredential"in s&&Ds(r,"multi-factor-auth-required",{_serverResponse:s}),s}),$N.apply(this,arguments)}function qQ(r,e,t,n){const i=`${e}${t}?${n}`;return r.config.emulator?HN(r.config,i):`${r.config.apiScheme}://${i}`}class UIe{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,n)=>{this.timer=setTimeout(()=>n(fo(this.auth,"network-request-failed")),BIe.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function q9(r,e,t){const n={appName:r.name};t.email&&(n.email=t.email),t.phoneNumber&&(n.phoneNumber=t.phoneNumber);const i=fo(r,e,n);return i.customData._tokenResponse=t,i}function GN(){return GN=M(function*(r,e){return Tr(r,"POST","/v1/accounts:delete",e)}),GN.apply(this,arguments)}function UN(){return UN=M(function*(r,e){return Tr(r,"POST","/v1/accounts:lookup",e)}),UN.apply(this,arguments)}function j9(r){if(r)try{const e=new Date(Number(r));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}function WN(){return WN=M(function*(r,e=!1){const t=yr(r),n=yield t.getIdToken(e),i=j_(n);Ve(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");const s="object"==typeof i.firebase?i.firebase:void 0,o=s?.sign_in_provider;return{claims:i,token:n,authTime:j9(qN(i.auth_time)),issuedAtTime:j9(qN(i.iat)),expirationTime:j9(qN(i.exp)),signInProvider:o||null,signInSecondFactor:s?.sign_in_second_factor||null}}),WN.apply(this,arguments)}function qN(r){return 1e3*Number(r)}function j_(r){const[e,t,n]=r.split(".");if(void 0===e||void 0===t||void 0===n)return q_("JWT malformed, contained fewer than 3 sections"),null;try{const i=Xg(t);return i?JSON.parse(i):(q_("Failed to decode base64 JWT payload"),null)}catch(i){return q_("Caught error parsing JWT payload as JSON",i?.toString()),null}}function j3(r,e){return jN.apply(this,arguments)}function jN(){return jN=M(function*(r,e,t=!1){if(t)return e;try{return yield e}catch(n){throw n instanceof Lo&&function KIe({code:r}){return"auth/user-disabled"===r||"auth/user-token-expired"===r}(n)&&r.auth.currentUser===r&&(yield r.auth.signOut()),n}}),jN.apply(this,arguments)}class XIe{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),n}{this.errorBackoff=3e4;const i=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){var t=this;if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(M(function*(){yield t.iteration()}),n)}iteration(){var e=this;return M(function*(){try{yield e.user.getIdToken(!0)}catch(t){return void("auth/network-request-failed"===t?.code&&e.schedule(!0))}e.schedule()})()}}class jQ{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=j9(this.lastLoginAt),this.creationTime=j9(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}function Z9(r){return ZN.apply(this,arguments)}function ZN(){return ZN=M(function*(r){var e;const t=r.auth,n=yield r.getIdToken(),i=yield j3(r,function jIe(r,e){return UN.apply(this,arguments)}(t,{idToken:n}));Ve(i?.users.length,t,"internal-error");const s=i.users[0];r._notifyReloadListener(s);const o=null!==(e=s.providerUserInfo)&&void 0!==e&&e.length?function eke(r){return r.map(e=>{var{providerId:t}=e,n=Gu(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}(s.providerUserInfo):[],a=function JIe(r,e){return[...r.filter(n=>!e.some(i=>i.providerId===n.providerId)),...e]}(r.providerData,o),f=!!r.isAnonymous&&!(r.email&&s.passwordHash||a?.length),d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new jQ(s.createdAt,s.lastLoginAt),isAnonymous:f};Object.assign(r,d)}),ZN.apply(this,arguments)}function YN(){return YN=M(function*(r){const e=yr(r);yield Z9(e),yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}),YN.apply(this,arguments)}function KN(){return KN=M(function*(r,e){const t=yield WQ(r,{},M(function*(){const n=Af({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=r.config,o=qQ(r,i,"/v1/token",`key=${s}`),a=yield r._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",UQ.fetch()(o,{method:"POST",headers:a,body:n})}));return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}),KN.apply(this,arguments)}class Y9{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ve(e.idToken,"internal-error"),Ve(typeof e.idToken<"u","internal-error"),Ve(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):function YIe(r){const e=j_(r);return Ve(e,"internal-error"),Ve(typeof e.exp<"u","internal-error"),Ve(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}getToken(e,t=!1){var n=this;return M(function*(){return Ve(!n.accessToken||n.refreshToken,e,"user-token-expired"),t||!n.accessToken||n.isExpired?n.refreshToken?(yield n.refresh(e,n.refreshToken),n.accessToken):null:n.accessToken})()}clearRefreshToken(){this.refreshToken=null}refresh(e,t){var n=this;return M(function*(){const{accessToken:i,refreshToken:s,expiresIn:o}=yield function tke(r,e){return KN.apply(this,arguments)}(e,t);n.updateTokensAndExpiration(i,s,Number(o))})()}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:i,expirationTime:s}=t,o=new Y9;return n&&(Ve("string"==typeof n,"internal-error",{appName:e}),o.refreshToken=n),i&&(Ve("string"==typeof i,"internal-error",{appName:e}),o.accessToken=i),s&&(Ve("number"==typeof s,"internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Y9,this.toJSON())}_performRefresh(){return Rc("not implemented")}}function dl(r,e){Ve("string"==typeof r||typeof r>"u","internal-error",{appName:e})}class u0{constructor(e){var{uid:t,auth:n,stsTokenManager:i}=e,s=Gu(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new XIe(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new jQ(s.createdAt||void 0,s.lastLoginAt||void 0)}getIdToken(e){var t=this;return M(function*(){const n=yield j3(t,t.stsTokenManager.getToken(t.auth,e));return Ve(n,t.auth,"internal-error"),t.accessToken!==n&&(t.accessToken=n,yield t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)),n})()}getIdTokenResult(e){return function ZIe(r){return WN.apply(this,arguments)}(this,e)}reload(){return function QIe(r){return YN.apply(this,arguments)}(this)}_assign(e){this!==e&&(Ve(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new u0(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){Ve(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,t=!1){var n=this;return M(function*(){let i=!1;e.idToken&&e.idToken!==n.stsTokenManager.accessToken&&(n.stsTokenManager.updateFromServerResponse(e),i=!0),t&&(yield Z9(n)),yield n.auth._persistUserIfCurrent(n),i&&n.auth._notifyListenersIfCurrent(n)})()}delete(){var e=this;return M(function*(){const t=yield e.getIdToken();return yield j3(e,function WIe(r,e){return GN.apply(this,arguments)}(e.auth,{idToken:t})),e.stsTokenManager.clearRefreshToken(),e.auth.signOut()})()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,i,s,o,a,c,l,f;const d=null!==(n=t.displayName)&&void 0!==n?n:void 0,m=null!==(i=t.email)&&void 0!==i?i:void 0,E=null!==(s=t.phoneNumber)&&void 0!==s?s:void 0,w=null!==(o=t.photoURL)&&void 0!==o?o:void 0,R=null!==(a=t.tenantId)&&void 0!==a?a:void 0,z=null!==(c=t._redirectEventId)&&void 0!==c?c:void 0,$=null!==(l=t.createdAt)&&void 0!==l?l:void 0,G=null!==(f=t.lastLoginAt)&&void 0!==f?f:void 0,{uid:de,emailVerified:ve,isAnonymous:Le,providerData:nt,stsTokenManager:gt}=t;Ve(de&&gt,e,"internal-error");const vn=Y9.fromJSON(this.name,gt);Ve("string"==typeof de,e,"internal-error"),dl(d,e.name),dl(m,e.name),Ve("boolean"==typeof ve,e,"internal-error"),Ve("boolean"==typeof Le,e,"internal-error"),dl(E,e.name),dl(w,e.name),dl(R,e.name),dl(z,e.name),dl($,e.name),dl(G,e.name);const Et=new u0({uid:de,auth:e,email:m,emailVerified:ve,displayName:d,isAnonymous:Le,photoURL:w,phoneNumber:E,tenantId:R,stsTokenManager:vn,createdAt:$,lastLoginAt:G});return nt&&Array.isArray(nt)&&(Et.providerData=nt.map(Z2=>Object.assign({},Z2))),z&&(Et._redirectEventId=z),Et}static _fromIdTokenResponse(e,t,n=!1){return M(function*(){const i=new Y9;i.updateFromServerResponse(t);const s=new u0({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:n});return yield Z9(s),s})()}}const ZQ=new Map;function Z3(r){W3(r instanceof Function,"Expected a class definition");let e=ZQ.get(r);return e?(W3(e instanceof r,"Instance stored in cache mismatched with class"),e):(e=new r,ZQ.set(r,e),e)}const YQ=(()=>{class r{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return M(function*(){return!0})()}_set(t,n){var i=this;return M(function*(){i.storage[t]=n})()}_get(t){var n=this;return M(function*(){const i=n.storage[t];return void 0===i?null:i})()}_remove(t){var n=this;return M(function*(){delete n.storage[t]})()}_addListener(t,n){}_removeListener(t,n){}}return r.type="NONE",r})();function Z_(r,e,t){return`firebase:${r}:${e}:${t}`}class W5{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:i,name:s}=this.auth;this.fullUserKey=Z_(this.userKey,i.apiKey,s),this.fullPersistenceKey=Z_("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){var e=this;return M(function*(){const t=yield e.persistence._get(e.fullUserKey);return t?u0._fromJSON(e.auth,t):null})()}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){var t=this;return M(function*(){if(t.persistence===e)return;const n=yield t.getCurrentUser();return yield t.removeCurrentUser(),t.persistence=e,n?t.setCurrentUser(n):void 0})()}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,t,n="authUser"){return M(function*(){if(!t.length)return new W5(Z3(YQ),e,n);const i=(yield Promise.all(t.map(function(){var l=M(function*(f){if(yield f._isAvailable())return f});return function(f){return l.apply(this,arguments)}}()))).filter(l=>l);let s=i[0]||Z3(YQ);const o=Z_(n,e.config.apiKey,e.name);let a=null;for(const l of t)try{const f=yield l._get(o);if(f){const d=u0._fromJSON(e,f);l!==s&&(a=d),s=l;break}}catch{}const c=i.filter(l=>l._shouldAllowMigration);return s._shouldAllowMigration&&c.length?(s=c[0],a&&(yield s._set(o,a.toJSON())),yield Promise.all(t.map(function(){var l=M(function*(f){if(f!==s)try{yield f._remove(o)}catch{}});return function(f){return l.apply(this,arguments)}}())),new W5(s,e,n)):new W5(s,e,n)})()}}function KQ(r){const e=r.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(JQ(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(XQ(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(tJ(e))return"Blackberry";if(nJ(e))return"Webos";if(XN(e))return"Safari";if((e.includes("chrome/")||QQ(e))&&!e.includes("edge/"))return"Chrome";if(eJ(e))return"Android";{const n=r.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if(2===n?.length)return n[1]}return"Other"}function XQ(r=w2()){return/firefox\//i.test(r)}function XN(r=w2()){const e=r.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function QQ(r=w2()){return/crios\//i.test(r)}function JQ(r=w2()){return/iemobile/i.test(r)}function eJ(r=w2()){return/android/i.test(r)}function tJ(r=w2()){return/blackberry/i.test(r)}function nJ(r=w2()){return/webos/i.test(r)}function Y_(r=w2()){return/iphone|ipad|ipod/i.test(r)||/macintosh/i.test(r)&&/mobile/i.test(r)}function rJ(r=w2()){return Y_(r)||eJ(r)||nJ(r)||tJ(r)||/windows phone/i.test(r)||JQ(r)}function iJ(r,e=[]){let t;switch(r){case"Browser":t=KQ(w2());break;case"Worker":t=`${KQ(w2())}-${r}`;break;default:t=r}const n=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${L6}/${n}`}function sJ(r,e){return JN.apply(this,arguments)}function JN(){return JN=M(function*(r,e){return Tr(r,"GET","/v2/recaptchaConfig",cr(r,e))}),JN.apply(this,arguments)}function aJ(r){return void 0!==r&&void 0!==r.enterprise}class cJ{constructor(e){if(this.siteKey="",this.emailPasswordEnabled=!1,void 0===e.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.emailPasswordEnabled=e.recaptchaEnforcementState.some(t=>"EMAIL_PASSWORD_PROVIDER"===t.provider&&"OFF"!==t.enforcementState)}}function eI(r){return new Promise((e,t)=>{const n=document.createElement("script");n.setAttribute("src",r),n.onload=e,n.onerror=i=>{const s=fo("internal-error");s.customData=i,t(s)},n.type="text/javascript",n.charset="UTF-8",function oke(){var r,e;return null!==(e=null===(r=document.getElementsByTagName("head"))||void 0===r?void 0:r[0])&&void 0!==e?e:document}().appendChild(n)})}function lJ(r){return`__${r}${Math.floor(1e6*Math.random())}`}class uJ{constructor(e){this.type="recaptcha-enterprise",this.auth=R2(e)}verify(e="verify",t=!1){var n=this;return M(function*(){function s(){return s=M(function*(a){if(!t){if(null==a.tenantId&&null!=a._agentRecaptchaConfig)return a._agentRecaptchaConfig.siteKey;if(null!=a.tenantId&&void 0!==a._tenantRecaptchaConfigs[a.tenantId])return a._tenantRecaptchaConfigs[a.tenantId].siteKey}return new Promise(function(){var c=M(function*(l,f){sJ(a,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(d=>{if(void 0!==d.recaptchaKey){const m=new cJ(d);return null==a.tenantId?a._agentRecaptchaConfig=m:a._tenantRecaptchaConfigs[a.tenantId]=m,l(m.siteKey)}f(new Error("recaptcha Enterprise site key undefined"))}).catch(d=>{f(d)})});return function(l,f){return c.apply(this,arguments)}}())}),s.apply(this,arguments)}function o(a,c,l){const f=window.grecaptcha;aJ(f)?f.enterprise.ready(()=>{f.enterprise.execute(a,{action:e}).then(d=>{c(d)}).catch(()=>{c("NO_RECAPTCHA")})}):l(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((a,c)=>{(function i(a){return s.apply(this,arguments)})(n.auth).then(l=>{if(!t&&aJ(window.grecaptcha))o(l,a,c);else{if(typeof window>"u")return void c(new Error("RecaptchaVerifier is only supported in browser"));eI("https://www.google.com/recaptcha/enterprise.js?render="+l).then(()=>{o(l,a,c)}).catch(f=>{c(f)})}}).catch(l=>{c(l)})})})()}}function hl(r,e,t){return tI.apply(this,arguments)}function tI(){return tI=M(function*(r,e,t,n=!1){const i=new uJ(r);let s;try{s=yield i.verify(t)}catch{s=yield i.verify(t,!0)}const o=Object.assign({},e);return Object.assign(o,n?{captchaResp:s}:{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}),tI.apply(this,arguments)}class uke{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=s=>new Promise((o,a)=>{try{o(e(s))}catch(c){a(c)}});n.onAbort=t,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}runMiddleware(e){var t=this;return M(function*(){if(t.auth.currentUser===e)return;const n=[];try{for(const i of t.queue)yield i(e),i.onAbort&&n.push(i.onAbort)}catch(i){n.reverse();for(const s of n)try{s()}catch{}throw t.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}})()}}class fke{constructor(e,t,n,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new fJ(this),this.idTokenSubscription=new fJ(this),this.beforeStateQueue=new uke(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=$Q,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,t){var n=this;return t&&(this._popupRedirectResolver=Z3(t)),this._initializationPromise=this.queue(M(function*(){var i,s;if(!n._deleted&&(n.persistenceManager=yield W5.create(n,e),!n._deleted)){if(null!==(i=n._popupRedirectResolver)&&void 0!==i&&i._shouldInitProactively)try{yield n._popupRedirectResolver._initialize(n)}catch{}yield n.initializeCurrentUser(t),n.lastNotifiedUid=(null===(s=n.currentUser)||void 0===s?void 0:s.uid)||null,!n._deleted&&(n._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){var e=this;return M(function*(){if(e._deleted)return;const t=yield e.assertedPersistence.getCurrentUser();if(e.currentUser||t){if(e.currentUser&&t&&e.currentUser.uid===t.uid)return e._currentUser._assign(t),void(yield e.currentUser.getIdToken());yield e._updateCurrentUser(t,!0)}})()}initializeCurrentUser(e){var t=this;return M(function*(){var n;const i=yield t.assertedPersistence.getCurrentUser();let s=i,o=!1;if(e&&t.config.authDomain){yield t.getOrInitRedirectPersistenceManager();const a=null===(n=t.redirectUser)||void 0===n?void 0:n._redirectEventId,c=s?._redirectEventId,l=yield t.tryRedirectSignIn(e);(!a||a===c)&&l?.user&&(s=l.user,o=!0)}if(!s)return t.directlySetCurrentUser(null);if(!s._redirectEventId){if(o)try{yield t.beforeStateQueue.runMiddleware(s)}catch(a){s=i,t._popupRedirectResolver._overrideRedirectResult(t,()=>Promise.reject(a))}return s?t.reloadAndSetCurrentUserOrClear(s):t.directlySetCurrentUser(null)}return Ve(t._popupRedirectResolver,t,"argument-error"),yield t.getOrInitRedirectPersistenceManager(),t.redirectUser&&t.redirectUser._redirectEventId===s._redirectEventId?t.directlySetCurrentUser(s):t.reloadAndSetCurrentUserOrClear(s)})()}tryRedirectSignIn(e){var t=this;return M(function*(){let n=null;try{n=yield t._popupRedirectResolver._completeRedirectFn(t,e,!0)}catch{yield t._setRedirectUser(null)}return n})()}reloadAndSetCurrentUserOrClear(e){var t=this;return M(function*(){try{yield Z9(e)}catch(n){if("auth/network-request-failed"!==n?.code)return t.directlySetCurrentUser(null)}return t.directlySetCurrentUser(e)})()}useDeviceLanguage(){this.languageCode=function $Ie(){if(typeof navigator>"u")return null;const r=navigator;return r.languages&&r.languages[0]||r.language||null}()}_delete(){var e=this;return M(function*(){e._deleted=!0})()}updateCurrentUser(e){var t=this;return M(function*(){const n=e?yr(e):null;return n&&Ve(n.auth.config.apiKey===t.config.apiKey,t,"invalid-user-token"),t._updateCurrentUser(n&&n._clone(t))})()}_updateCurrentUser(e,t=!1){var n=this;return M(function*(){if(!n._deleted)return e&&Ve(n.tenantId===e.tenantId,n,"tenant-id-mismatch"),t||(yield n.beforeStateQueue.runMiddleware(e)),n.queue(M(function*(){yield n.directlySetCurrentUser(e),n.notifyAuthListeners()}))})()}signOut(){var e=this;return M(function*(){return yield e.beforeStateQueue.runMiddleware(null),(e.redirectPersistenceManager||e._popupRedirectResolver)&&(yield e._setRedirectUser(null)),e._updateCurrentUser(null,!0)})()}setPersistence(e){var t=this;return this.queue(M(function*(){yield t.assertedPersistence.setPersistence(Z3(e))}))}initializeRecaptchaConfig(){var e=this;return M(function*(){const t=yield sJ(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),n=new cJ(t);null==e.tenantId?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,n.emailPasswordEnabled&&new uJ(e).verify()})()}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Sc("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}_setRedirectUser(e,t){var n=this;return M(function*(){const i=yield n.getOrInitRedirectPersistenceManager(t);return null===e?i.removeCurrentUser():i.setCurrentUser(e)})()}getOrInitRedirectPersistenceManager(e){var t=this;return M(function*(){if(!t.redirectPersistenceManager){const n=e&&Z3(e)||t._popupRedirectResolver;Ve(n,t,"argument-error"),t.redirectPersistenceManager=yield W5.create(t,[Z3(n._redirectPersistence)],"redirectUser"),t.redirectUser=yield t.redirectPersistenceManager.getCurrentUser()}return t.redirectPersistenceManager})()}_redirectUserForId(e){var t=this;return M(function*(){var n,i;return t._isInitialized&&(yield t.queue(M(function*(){}))),(null===(n=t._currentUser)||void 0===n?void 0:n._redirectEventId)===e?t._currentUser:(null===(i=t.redirectUser)||void 0===i?void 0:i._redirectEventId)===e?t.redirectUser:null})()}_persistUserIfCurrent(e){var t=this;return M(function*(){if(e===t.currentUser)return t.queue(M(function*(){return t.directlySetCurrentUser(e)}))})()}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,i){if(this._deleted)return()=>{};const s="function"==typeof t?t:t.next.bind(t),o=this._isInitialized?Promise.resolve():this._initializationPromise;return Ve(o,this,"internal-error"),o.then(()=>s(this.currentUser)),"function"==typeof t?e.addObserver(t,n,i):e.addObserver(t)}directlySetCurrentUser(e){var t=this;return M(function*(){t.currentUser&&t.currentUser!==e&&t._currentUser._stopProactiveRefresh(),e&&t.isProactiveRefreshEnabled&&e._startProactiveRefresh(),t.currentUser=e,e?yield t.assertedPersistence.setCurrentUser(e):yield t.assertedPersistence.removeCurrentUser()})()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ve(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=iJ(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){var e=this;return M(function*(){var t;const n={"X-Client-Version":e.clientVersion};e.app.options.appId&&(n["X-Firebase-gmpid"]=e.app.options.appId);const i=yield null===(t=e.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===t?void 0:t.getHeartbeatsHeader();i&&(n["X-Firebase-Client"]=i);const s=yield e._getAppCheckToken();return s&&(n["X-Firebase-AppCheck"]=s),n})()}_getAppCheckToken(){var e=this;return M(function*(){var t;const n=yield null===(t=e.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===t?void 0:t.getToken();return n?.error&&function VIe(r,...e){W_.logLevel<=Bn.WARN&&W_.warn(`Auth (${L6}): ${r}`,...e)}(`Error while retrieving App Check token: ${n.error}`),n?.token})()}}function R2(r){return yr(r)}class fJ{constructor(e){this.auth=e,this.observer=null,this.addObserver=function yMe(r,e){const t=new MMe(r,e);return t.subscribe.bind(t)}(t=>this.observer=t)}get next(){return Ve(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function dJ(r,e,t){const n=R2(r);Ve(n._canInitEmulator,n,"emulator-config-failed"),Ve(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const i=!!t?.disableWarnings,s=hJ(e),{host:o,port:a}=function pke(r){const e=hJ(r),t=/(\/\/)?([^?#/]+)/.exec(r.substr(e.length));if(!t)return{host:"",port:null};const n=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){const s=i[1];return{host:s,port:pJ(n.substr(s.length+1))}}{const[s,o]=n.split(":");return{host:s,port:pJ(o)}}}(e);n.config.emulator={url:`${s}//${o}${null===a?"":`:${a}`}/`},n.settings.appVerificationDisabledForTesting=!0,n.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||function gke(){function r(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",r):r())}()}function hJ(r){const e=r.indexOf(":");return e<0?"":r.substr(0,e+1)}function pJ(r){if(!r)return null;const e=Number(r);return isNaN(e)?null:e}class nI{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Rc("not implemented")}_getIdTokenResponse(e){return Rc("not implemented")}_linkToIdToken(e,t){return Rc("not implemented")}_getReauthenticationResolver(e){return Rc("not implemented")}}function iI(){return iI=M(function*(r,e){return Tr(r,"POST","/v1/accounts:update",e)}),iI.apply(this,arguments)}function oI(r,e){return aI.apply(this,arguments)}function aI(){return aI=M(function*(r,e){return q3(r,"POST","/v1/accounts:signInWithPassword",cr(r,e))}),aI.apply(this,arguments)}function K_(r,e){return cI.apply(this,arguments)}function cI(){return cI=M(function*(r,e){return Tr(r,"POST","/v1/accounts:sendOobCode",cr(r,e))}),cI.apply(this,arguments)}function lI(){return lI=M(function*(r,e){return K_(r,e)}),lI.apply(this,arguments)}function uI(r,e){return fI.apply(this,arguments)}function fI(){return fI=M(function*(r,e){return K_(r,e)}),fI.apply(this,arguments)}function gI(){return gI=M(function*(r,e){return q3(r,"POST","/v1/accounts:signInWithEmailLink",cr(r,e))}),gI.apply(this,arguments)}function mI(){return mI=M(function*(r,e){return q3(r,"POST","/v1/accounts:signInWithEmailLink",cr(r,e))}),mI.apply(this,arguments)}class K9 extends nI{constructor(e,t,n,i=null){super("password",n),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new K9(e,t,"password")}static _fromEmailAndCode(e,t,n=null){return new K9(e,t,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e;if(t?.email&&t?.password){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}_getIdTokenResponse(e){var t=this;return M(function*(){var n;switch(t.signInMethod){case"password":const i={returnSecureToken:!0,email:t._email,password:t._password,clientType:"CLIENT_TYPE_WEB"};if(null!==(n=e._getRecaptchaConfig())&&void 0!==n&&n.emailPasswordEnabled){const s=yield hl(e,i,"signInWithPassword");return oI(e,s)}return oI(e,i).catch(function(){var s=M(function*(o){if("auth/missing-recaptcha-token"===o.code){console.log("Sign-in with email address and password is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-in flow.");const a=yield hl(e,i,"signInWithPassword");return oI(e,a)}return Promise.reject(o)});return function(o){return s.apply(this,arguments)}}());case"emailLink":return function Cke(r,e){return gI.apply(this,arguments)}(e,{email:t._email,oobCode:t._password});default:Ds(e,"internal-error")}})()}_linkToIdToken(e,t){var n=this;return M(function*(){switch(n.signInMethod){case"password":return function mJ(r,e){return iI.apply(this,arguments)}(e,{idToken:t,returnSecureToken:!0,email:n._email,password:n._password});case"emailLink":return function yke(r,e){return mI.apply(this,arguments)}(e,{idToken:t,email:n._email,oobCode:n._password});default:Ds(e,"internal-error")}})()}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}function Y3(r,e){return _I.apply(this,arguments)}function _I(){return _I=M(function*(r,e){return q3(r,"POST","/v1/accounts:signInWithIdp",cr(r,e))}),_I.apply(this,arguments)}class q5 extends nI{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new q5(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Ds("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e,{providerId:n,signInMethod:i}=t,s=Gu(t,["providerId","signInMethod"]);if(!n||!i)return null;const o=new q5(n,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){return Y3(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,Y3(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Y3(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Af(t)}return e}}class Q9{constructor(e){var t,n,i,s,o,a;const c=Nf(If(e)),l=null!==(t=c.apiKey)&&void 0!==t?t:null,f=null!==(n=c.oobCode)&&void 0!==n?n:null,d=function bke(r){switch(r){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(i=c.mode)&&void 0!==i?i:null);Ve(l&&f&&d,"argument-error"),this.apiKey=l,this.operation=d,this.code=f,this.continueUrl=null!==(s=c.continueUrl)&&void 0!==s?s:null,this.languageCode=null!==(o=c.languageCode)&&void 0!==o?o:null,this.tenantId=null!==(a=c.tenantId)&&void 0!==a?a:null}static parseLink(e){const t=function wke(r){const e=Nf(If(r)).link,t=e?Nf(If(e)).deep_link_id:null,n=Nf(If(r)).deep_link_id;return(n?Nf(If(n)).link:null)||n||t||e||r}(e);try{return new Q9(t)}catch{return null}}}let _J=(()=>{class r{constructor(){this.providerId=r.PROVIDER_ID}static credential(t,n){return K9._fromEmailAndPassword(t,n)}static credentialWithLink(t,n){const i=Q9.parseLink(n);return Ve(i,"argument-error"),K9._fromEmailAndCode(t,i.code,i.tenantId)}}return r.PROVIDER_ID="password",r.EMAIL_PASSWORD_SIGN_IN_METHOD="password",r.EMAIL_LINK_SIGN_IN_METHOD="emailLink",r})();class pl{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class vJ extends pl{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}let Ake=(()=>{class r extends vJ{constructor(){super("google.com"),this.addScope("profile")}static credential(t,n){return q5._fromParams({providerId:r.PROVIDER_ID,signInMethod:r.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:n})}static credentialFromResult(t){return r.credentialFromTaggedObject(t)}static credentialFromError(t){return r.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthIdToken:n,oauthAccessToken:i}=t;if(!n&&!i)return null;try{return r.credential(n,i)}catch{return null}}}return r.GOOGLE_SIGN_IN_METHOD="google.com",r.PROVIDER_ID="google.com",r})();function Q_(r,e){return SI.apply(this,arguments)}function SI(){return SI=M(function*(r,e){return q3(r,"POST","/v1/accounts:signUp",cr(r,e))}),SI.apply(this,arguments)}class Do{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static _fromIdTokenResponse(e,t,n,i=!1){return M(function*(){const s=yield u0._fromIdTokenResponse(e,n,i),o=CJ(n);return new Do({user:s,providerId:o,_tokenResponse:n,operationType:t})})()}static _forOperation(e,t,n){return M(function*(){yield e._updateTokensIfNecessary(n,!0);const i=CJ(n);return new Do({user:e,providerId:i,_tokenResponse:n,operationType:t})})()}}function CJ(r){return r.providerId?r.providerId:"phoneNumber"in r?"phone":null}class J_ extends Lo{constructor(e,t,n,i){var s;super(t.code,t.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,J_.prototype),this.customData={appName:e.name,tenantId:null!==(s=e.tenantId)&&void 0!==s?s:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,i){return new J_(e,t,n,i)}}function yJ(r,e,t,n){return("reauthenticate"===e?t._getReauthenticationResolver(r):t._getIdTokenResponse(r)).catch(s=>{throw"auth/multi-factor-auth-required"===s.code?J_._fromErrorAndOperation(r,s,e,n):s})}function bI(){return bI=M(function*(r,e,t=!1){const n=yield j3(r,e._linkToIdToken(r.auth,yield r.getIdToken()),t);return Do._forOperation(r,"link",n)}),bI.apply(this,arguments)}function AI(){return AI=M(function*(r,e,t=!1){const{auth:n}=r,i="reauthenticate";try{const s=yield j3(r,yJ(n,i,e,r),t);Ve(s.idToken,n,"internal-error");const o=j_(s.idToken);Ve(o,n,"internal-error");const{sub:a}=o;return Ve(r.uid===a,n,"user-mismatch"),Do._forOperation(r,i,s)}catch(s){throw"auth/user-not-found"===s?.code&&Ds(n,"user-mismatch"),s}}),AI.apply(this,arguments)}function SJ(r,e){return NI.apply(this,arguments)}function NI(){return NI=M(function*(r,e,t=!1){const n="signIn",i=yield yJ(r,n,e),s=yield Do._fromIdTokenResponse(r,n,i);return t||(yield r._updateCurrentUser(s.user)),s}),NI.apply(this,arguments)}function kI(){return kI=M(function*(r,e){return SJ(R2(r),e)}),kI.apply(this,arguments)}function j5(r,e,t){var n;Ve((null===(n=t.url)||void 0===n?void 0:n.length)>0,r,"invalid-continue-uri"),Ve(typeof t.dynamicLinkDomain>"u"||t.dynamicLinkDomain.length>0,r,"invalid-dynamic-link-domain"),e.continueUrl=t.url,e.dynamicLinkDomain=t.dynamicLinkDomain,e.canHandleCodeInApp=t.handleCodeInApp,t.iOS&&(Ve(t.iOS.bundleId.length>0,r,"missing-ios-bundle-id"),e.iOSBundleId=t.iOS.bundleId),t.android&&(Ve(t.android.packageName.length>0,r,"missing-android-pkg-name"),e.androidInstallApp=t.android.installApp,e.androidMinimumVersionCode=t.android.minimumVersion,e.androidPackageName=t.android.packageName)}function Rke(r,e,t){return FI.apply(this,arguments)}function FI(){return FI=M(function*(r,e,t){var n;const i=R2(r),s={requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"};if(null!==(n=i._getRecaptchaConfig())&&void 0!==n&&n.emailPasswordEnabled){const o=yield hl(i,s,"getOobCode",!0);t&&j5(i,o,t),yield uI(i,o)}else t&&j5(i,s,t),yield uI(i,s).catch(function(){var o=M(function*(a){if("auth/missing-recaptcha-token"!==a.code)return Promise.reject(a);{console.log("Password resets are protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the password reset flow.");const c=yield hl(i,s,"getOobCode",!0);t&&j5(i,c,t),yield uI(i,c)}});return function(a){return o.apply(this,arguments)}}())}),FI.apply(this,arguments)}function Dke(r,e,t){return WI.apply(this,arguments)}function WI(){return WI=M(function*(r,e,t){var n;const i=R2(r),s={returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"};let o;if(null!==(n=i._getRecaptchaConfig())&&void 0!==n&&n.emailPasswordEnabled){const l=yield hl(i,s,"signUpPassword");o=Q_(i,l)}else o=Q_(i,s).catch(function(){var l=M(function*(f){if("auth/missing-recaptcha-token"===f.code){console.log("Sign-up is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-up flow.");const d=yield hl(i,s,"signUpPassword");return Q_(i,d)}return Promise.reject(f)});return function(f){return l.apply(this,arguments)}}());const a=yield o.catch(l=>Promise.reject(l)),c=yield Do._fromIdTokenResponse(i,"signIn",a);return yield i._updateCurrentUser(c.user),c}),WI.apply(this,arguments)}function Hke(r,e,t){return function II(r,e){return kI.apply(this,arguments)}(yr(r),_J.credential(e,t))}function Fke(r,e){return KI.apply(this,arguments)}function KI(){return KI=M(function*(r,e){const t=yr(r),i={requestType:"VERIFY_EMAIL",idToken:yield r.getIdToken()};e&&j5(t.auth,i,e);const{email:s}=yield function _ke(r,e){return lI.apply(this,arguments)}(t.auth,i);s!==r.email&&(yield r.reload())}),KI.apply(this,arguments)}function QI(){return QI=M(function*(r,e){return Tr(r,"POST","/v1/accounts:update",e)}),QI.apply(this,arguments)}function Gke(r,e){return JI.apply(this,arguments)}function JI(){return JI=M(function*(r,{displayName:e,photoURL:t}){if(void 0===e&&void 0===t)return;const n=yr(r),s={idToken:yield n.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},o=yield j3(n,function $ke(r,e){return QI.apply(this,arguments)}(n.auth,s));n.displayName=o.displayName||null,n.photoURL=o.photoUrl||null;const a=n.providerData.find(({providerId:c})=>"password"===c);a&&(a.displayName=n.displayName,a.photoURL=n.photoURL),yield n._updateTokensIfNecessary(o)}),JI.apply(this,arguments)}function Kke(r,e,t,n){return yr(r).onAuthStateChanged(e,t,n)}const tv="__sak";class TJ{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(tv,"1"),this.storage.removeItem(tv),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const ixe=(()=>{class r extends TJ{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,n)=>this.onStorageEvent(t,n),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function txe(){const r=w2();return XN(r)||Y_(r)}()&&function ike(){try{return!(!window||window===window.top)}catch{return!1}}(),this.fallbackToPolling=rJ(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(const n of Object.keys(this.listeners)){const i=this.storage.getItem(n),s=this.localCache[n];i!==s&&t(n,s,i)}}onStorageEvent(t,n=!1){if(!t.key)return void this.forAllChangedKeys((a,c,l)=>{this.notifyListeners(a,l)});const i=t.key;if(n?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const a=this.storage.getItem(i);if(t.newValue!==a)null!==t.newValue?this.storage.setItem(i,t.newValue):this.storage.removeItem(i);else if(this.localCache[i]===t.newValue&&!n)return}const s=()=>{const a=this.storage.getItem(i);!n&&this.localCache[i]===a||this.notifyListeners(i,a)},o=this.storage.getItem(i);!function rke(){return function gMe(){const r=w2();return r.indexOf("MSIE ")>=0||r.indexOf("Trident/")>=0}()&&10===document.documentMode}()||o===t.newValue||t.newValue===t.oldValue?s():setTimeout(s,10)}notifyListeners(t,n){this.localCache[t]=n;const i=this.listeners[t];if(i)for(const s of Array.from(i))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,n,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:n,newValue:i}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,n){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(n)}_removeListener(t,n){this.listeners[t]&&(this.listeners[t].delete(n),0===this.listeners[t].size&&delete this.listeners[t]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}_set(t,n){var i=()=>super._set,s=this;return M(function*(){yield i().call(s,t,n),s.localCache[t]=JSON.stringify(n)})()}_get(t){var n=()=>super._get,i=this;return M(function*(){const s=yield n().call(i,t);return i.localCache[t]=JSON.stringify(s),s})()}_remove(t){var n=()=>super._remove,i=this;return M(function*(){yield n().call(i,t),delete i.localCache[t]})()}}return r.type="LOCAL",r})(),OJ=(()=>{class r extends TJ{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,n){}_removeListener(t,n){}}return r.type="SESSION",r})();let oxe=(()=>{class r{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){const n=this.receivers.find(s=>s.isListeningto(t));if(n)return n;const i=new r(t);return this.receivers.push(i),i}isListeningto(t){return this.eventTarget===t}handleEvent(t){var n=this;return M(function*(){const i=t,{eventId:s,eventType:o,data:a}=i.data,c=n.handlersMap[o];if(!c?.size)return;i.ports[0].postMessage({status:"ack",eventId:s,eventType:o});const l=Array.from(c).map(function(){var d=M(function*(m){return m(i.origin,a)});return function(m){return d.apply(this,arguments)}}()),f=yield function sxe(r){return Promise.all(r.map(function(){var e=M(function*(t){try{return{fulfilled:!0,value:yield t}}catch(n){return{fulfilled:!1,reason:n}}});return function(t){return e.apply(this,arguments)}}()))}(l);i.ports[0].postMessage({status:"done",eventId:s,eventType:o,response:f})})()}_subscribe(t,n){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(n)}_unsubscribe(t,n){this.handlersMap[t]&&n&&this.handlersMap[t].delete(n),(!n||0===this.handlersMap[t].size)&&delete this.handlersMap[t],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}return r.receivers=[],r})();function nv(r="",e=10){let t="";for(let n=0;n<e;n++)t+=Math.floor(10*Math.random());return r+t}class axe{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}_send(e,t,n=50){var i=this;return M(function*(){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let o,a;return new Promise((c,l)=>{const f=nv("",20);s.port1.start();const d=setTimeout(()=>{l(new Error("unsupported_event"))},n);a={messageChannel:s,onMessage(m){const E=m;if(E.data.eventId===f)switch(E.data.status){case"ack":clearTimeout(d),o=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),c(E.data.response);break;default:clearTimeout(d),clearTimeout(o),l(new Error("invalid_response"))}}},i.handlers.add(a),s.port1.addEventListener("message",a.onMessage),i.target.postMessage({eventType:e,eventId:f,data:t},[s.port2])}).finally(()=>{a&&i.removeMessageHandler(a)})})()}}function e2(){return window}function ok(){return typeof e2().WorkerGlobalScope<"u"&&"function"==typeof e2().importScripts}function ak(){return(ak=M(function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})).apply(this,arguments)}const bJ="firebaseLocalStorageDb",rv="firebaseLocalStorage",wJ="fbase_key";class ed{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function iv(r,e){return r.transaction([rv],e?"readwrite":"readonly").objectStore(rv)}function ck(){const r=indexedDB.open(bJ,1);return new Promise((e,t)=>{r.addEventListener("error",()=>{t(r.error)}),r.addEventListener("upgradeneeded",()=>{const n=r.result;try{n.createObjectStore(rv,{keyPath:wJ})}catch(i){t(i)}}),r.addEventListener("success",M(function*(){const n=r.result;n.objectStoreNames.contains(rv)?e(n):(n.close(),yield function hxe(){const r=indexedDB.deleteDatabase(bJ);return new ed(r).toPromise()}(),e(yield ck()))}))})}function AJ(r,e,t){return lk.apply(this,arguments)}function lk(){return lk=M(function*(r,e,t){const n=iv(r,!0).put({[wJ]:e,value:t});return new ed(n).toPromise()}),lk.apply(this,arguments)}function uk(){return uk=M(function*(r,e){const t=iv(r,!1).get(e),n=yield new ed(t).toPromise();return void 0===n?null:n.value}),uk.apply(this,arguments)}function NJ(r,e){const t=iv(r,!0).delete(e);return new ed(t).toPromise()}const _xe=(()=>{class r{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){var t=this;return M(function*(){return t.db||(t.db=yield ck()),t.db})()}_withRetries(t){var n=this;return M(function*(){let i=0;for(;;)try{const s=yield n._openDb();return yield t(s)}catch(s){if(i++>3)throw s;n.db&&(n.db.close(),n.db=void 0)}})()}initializeServiceWorkerMessaging(){var t=this;return M(function*(){return ok()?t.initializeReceiver():t.initializeSender()})()}initializeReceiver(){var t=this;return M(function*(){t.receiver=oxe._getInstance(function fxe(){return ok()?self:null}()),t.receiver._subscribe("keyChanged",function(){var n=M(function*(i,s){return{keyProcessed:(yield t._poll()).includes(s.key)}});return function(i,s){return n.apply(this,arguments)}}()),t.receiver._subscribe("ping",function(){var n=M(function*(i,s){return["keyChanged"]});return function(i,s){return n.apply(this,arguments)}}())})()}initializeSender(){var t=this;return M(function*(){var n,i;if(t.activeServiceWorker=yield function lxe(){return ak.apply(this,arguments)}(),!t.activeServiceWorker)return;t.sender=new axe(t.activeServiceWorker);const s=yield t.sender._send("ping",{},800);s&&null!==(n=s[0])&&void 0!==n&&n.fulfilled&&null!==(i=s[0])&&void 0!==i&&i.value.includes("keyChanged")&&(t.serviceWorkerReceiverAvailable=!0)})()}notifyServiceWorker(t){var n=this;return M(function*(){if(n.sender&&n.activeServiceWorker&&function uxe(){var r;return(null===(r=navigator?.serviceWorker)||void 0===r?void 0:r.controller)||null}()===n.activeServiceWorker)try{yield n.sender._send("keyChanged",{key:t},n.serviceWorkerReceiverAvailable?800:50)}catch{}})()}_isAvailable(){return M(function*(){try{if(!indexedDB)return!1;const t=yield ck();return yield AJ(t,tv,"1"),yield NJ(t,tv),!0}catch{}return!1})()}_withPendingWrite(t){var n=this;return M(function*(){n.pendingWrites++;try{yield t()}finally{n.pendingWrites--}})()}_set(t,n){var i=this;return M(function*(){return i._withPendingWrite(M(function*(){return yield i._withRetries(s=>AJ(s,t,n)),i.localCache[t]=n,i.notifyServiceWorker(t)}))})()}_get(t){var n=this;return M(function*(){const i=yield n._withRetries(s=>function pxe(r,e){return uk.apply(this,arguments)}(s,t));return n.localCache[t]=i,i})()}_remove(t){var n=this;return M(function*(){return n._withPendingWrite(M(function*(){return yield n._withRetries(i=>NJ(i,t)),delete n.localCache[t],n.notifyServiceWorker(t)}))})()}_poll(){var t=this;return M(function*(){const n=yield t._withRetries(o=>{const a=iv(o,!1).getAll();return new ed(a).toPromise()});if(!n)return[];if(0!==t.pendingWrites)return[];const i=[],s=new Set;for(const{fbase_key:o,value:a}of n)s.add(o),JSON.stringify(t.localCache[o])!==JSON.stringify(a)&&(t.notifyListeners(o,a),i.push(o));for(const o of Object.keys(t.localCache))t.localCache[o]&&!s.has(o)&&(t.notifyListeners(o,null),i.push(o));return i})()}notifyListeners(t,n){this.localCache[t]=n;const i=this.listeners[t];if(i)for(const s of Array.from(i))s(n)}startPolling(){var t=this;this.stopPolling(),this.pollTimer=setInterval(M(function*(){return t._poll()}),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,n){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(n)}_removeListener(t,n){this.listeners[t]&&(this.listeners[t].delete(n),0===this.listeners[t].size&&delete this.listeners[t]),0===Object.keys(this.listeners).length&&this.stopPolling()}}return r.type="LOCAL",r})();function d0(r,e){return e?Z3(e):(Ve(r._popupRedirectResolver,r,"argument-error"),r._popupRedirectResolver)}lJ("rcb"),new W9(3e4,6e4);class Ck extends nI{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Y3(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Y3(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Y3(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function xxe(r){return SJ(r.auth,new Ck(r),r.bypassAuthState)}function Lxe(r){const{auth:e,user:t}=r;return Ve(t,e,"internal-error"),function EJ(r,e){return AI.apply(this,arguments)}(t,new Ck(r),r.bypassAuthState)}function Rxe(r){return yk.apply(this,arguments)}function yk(){return yk=M(function*(r){const{auth:e,user:t}=r;return Ve(t,e,"internal-error"),function OI(r,e){return bI.apply(this,arguments)}(t,new Ck(r),r.bypassAuthState)}),yk.apply(this,arguments)}class kJ{constructor(e,t,n,i,s=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){var e=this;return new Promise(function(){var t=M(function*(n,i){e.pendingPromise={resolve:n,reject:i};try{e.eventManager=yield e.resolver._initialize(e.auth),yield e.onExecution(),e.eventManager.registerConsumer(e)}catch(s){e.reject(s)}});return function(n,i){return t.apply(this,arguments)}}())}onAuthEvent(e){var t=this;return M(function*(){const{urlResponse:n,sessionId:i,postBody:s,tenantId:o,error:a,type:c}=e;if(a)return void t.reject(a);const l={auth:t.auth,requestUri:n,sessionId:i,tenantId:o||void 0,postBody:s||void 0,user:t.user,bypassAuthState:t.bypassAuthState};try{t.resolve(yield t.getIdpTask(c)(l))}catch(f){t.reject(f)}})()}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return xxe;case"linkViaPopup":case"linkViaRedirect":return Rxe;case"reauthViaPopup":case"reauthViaRedirect":return Lxe;default:Ds(this.auth,"internal-error")}}resolve(e){W3(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){W3(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const zxe=new W9(2e3,1e4);function Dxe(r,e,t){return Mk.apply(this,arguments)}function Mk(){return Mk=M(function*(r,e,t){const n=R2(r);!function U5(r,e,t){if(!(e instanceof t))throw t.name!==e.constructor.name&&Ds(r,"argument-error"),GQ(r,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}(r,e,pl);const i=d0(n,t);return new Pk(n,"signInViaPopup",e,i).executeNotNull()}),Mk.apply(this,arguments)}let Pk=(()=>{class r extends kJ{constructor(t,n,i,s,o){super(t,n,s,o),this.provider=i,this.authWindow=null,this.pollId=null,r.currentPopupAction&&r.currentPopupAction.cancel(),r.currentPopupAction=this}executeNotNull(){var t=this;return M(function*(){const n=yield t.execute();return Ve(n,t.auth,"internal-error"),n})()}onExecution(){var t=this;return M(function*(){W3(1===t.filter.length,"Popup operations only handle one event");const n=nv();t.authWindow=yield t.resolver._openPopup(t.auth,t.provider,t.filter[0],n),t.authWindow.associatedEvent=n,t.resolver._originValidation(t.auth).catch(i=>{t.reject(i)}),t.resolver._isIframeWebStorageSupported(t.auth,i=>{i||t.reject(fo(t.auth,"web-storage-unsupported"))}),t.pollUserCancellation()})()}get eventId(){var t;return(null===(t=this.authWindow)||void 0===t?void 0:t.associatedEvent)||null}cancel(){this.reject(fo(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,r.currentPopupAction=null}pollUserCancellation(){const t=()=>{var n,i;this.pollId=null!==(i=null===(n=this.authWindow)||void 0===n?void 0:n.window)&&void 0!==i&&i.closed?window.setTimeout(()=>{this.pollId=null,this.reject(fo(this.auth,"popup-closed-by-user"))},8e3):window.setTimeout(t,zxe.get())};t()}}return r.currentPopupAction=null,r})();const Hxe="pendingRedirect",td=new Map;class Vxe extends kJ{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}execute(){var e=()=>super.execute,t=this;return M(function*(){let n=td.get(t.auth._key());if(!n){try{const s=(yield function Fxe(r,e){return Tk.apply(this,arguments)}(t.resolver,t.auth))?yield e().call(t):null;n=()=>Promise.resolve(s)}catch(i){n=()=>Promise.reject(i)}td.set(t.auth._key(),n)}return t.bypassAuthState||td.set(t.auth._key(),()=>Promise.resolve(null)),n()})()}onAuthEvent(e){var t=()=>super.onAuthEvent,n=this;return M(function*(){if("signInViaRedirect"===e.type)return t().call(n,e);if("unknown"!==e.type){if(e.eventId){const i=yield n.auth._redirectUserForId(e.eventId);if(i)return n.user=i,t().call(n,e);n.resolve(null)}}else n.resolve(null)})()}onExecution(){return M(function*(){})()}cleanUp(){}}function Tk(){return Tk=M(function*(r,e){const t=function LJ(r){return Z_(Hxe,r.config.apiKey,r.name)}(e),n=function xJ(r){return Z3(r._redirectPersistence)}(r);if(!(yield n._isAvailable()))return!1;const i="true"===(yield n._get(t));return yield n._remove(t),i}),Tk.apply(this,arguments)}function $xe(r,e){td.set(r._key(),e)}function RJ(r,e){return kk.apply(this,arguments)}function kk(){return kk=M(function*(r,e,t=!1){const n=R2(r),i=d0(n,e),o=yield new Vxe(n,i,t).execute();return o&&!t&&(delete o.user._redirectEventId,yield n._persistUserIfCurrent(o.user),yield n._setRedirectUser(null,e)),o}),kk.apply(this,arguments)}class qxe{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!function jxe(r){switch(r.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return HJ(r);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!HJ(e)){const i=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(fo(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(DJ(e))}saveEventToCache(e){this.cachedEventUids.add(DJ(e)),this.lastProcessedEventTime=Date.now()}}function DJ(r){return[r.type,r.eventId,r.sessionId,r.tenantId].filter(e=>e).join("-")}function HJ({type:r,error:e}){return"unknown"===r&&"auth/no-auth-event"===e?.code}function Lk(){return Lk=M(function*(r,e={}){return Tr(r,"GET","/v1/projects",e)}),Lk.apply(this,arguments)}const Yxe=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Kxe=/^https?/;function Rk(){return Rk=M(function*(r){if(r.config.emulator)return;const{authorizedDomains:e}=yield function Zxe(r){return Lk.apply(this,arguments)}(r);for(const t of e)try{if(Qxe(t))return}catch{}Ds(r,"unauthorized-domain")}),Rk.apply(this,arguments)}function Qxe(r){const e=U9(),{protocol:t,hostname:n}=new URL(e);if(r.startsWith("chrome-extension://")){const o=new URL(r);return""===o.hostname&&""===n?"chrome-extension:"===t&&r.replace("chrome-extension://","")===e.replace("chrome-extension://",""):"chrome-extension:"===t&&o.hostname===n}if(!Kxe.test(t))return!1;if(Yxe.test(r))return n===r;const i=r.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}const Jxe=new W9(3e4,6e4);function VJ(){const r=e2().___jsl;if(r?.H)for(const e of Object.keys(r.H))if(r.H[e].r=r.H[e].r||[],r.H[e].L=r.H[e].L||[],r.H[e].r=[...r.H[e].L],r.CP)for(let t=0;t<r.CP.length;t++)r.CP[t]=null}let ov=null;const nLe=new W9(5e3,15e3),rLe="__/auth/iframe",iLe="emulator/auth/iframe",sLe={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},oLe=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function aLe(r){const e=r.config;Ve(e.authDomain,r,"auth-domain-config-required");const t=e.emulator?HN(e,iLe):`https://${r.config.authDomain}/${rLe}`,n={apiKey:e.apiKey,appName:r.name,v:L6},i=oLe.get(r.config.apiHost);i&&(n.eid=i);const s=r._getFrameworks();return s.length&&(n.fw=s.join(",")),`${t}?${Af(n).slice(1)}`}function zk(){return zk=M(function*(r){const e=yield function tLe(r){return ov=ov||function eLe(r){return new Promise((e,t)=>{var n,i,s;function o(){VJ(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{VJ(),t(fo(r,"network-request-failed"))},timeout:Jxe.get()})}if(null!==(i=null===(n=e2().gapi)||void 0===n?void 0:n.iframes)&&void 0!==i&&i.Iframe)e(gapi.iframes.getContext());else{if(null===(s=e2().gapi)||void 0===s||!s.load){const a=lJ("iframefcb");return e2()[a]=()=>{gapi.load?o():t(fo(r,"network-request-failed"))},eI(`https://apis.google.com/js/api.js?onload=${a}`).catch(c=>t(c))}o()}}).catch(e=>{throw ov=null,e})}(r),ov}(r),t=e2().gapi;return Ve(t,r,"internal-error"),e.open({where:document.body,url:aLe(r),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:sLe,dontclear:!0},n=>new Promise(function(){var i=M(function*(s,o){yield n.restyle({setHideOnLeave:!1});const a=fo(r,"network-request-failed"),c=e2().setTimeout(()=>{o(a)},nLe.get());function l(){e2().clearTimeout(c),s(n)}n.ping(l).then(l,()=>{o(a)})});return function(s,o){return i.apply(this,arguments)}}()))}),zk.apply(this,arguments)}const lLe={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class FJ{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}const mLe="__/auth/handler",_Le="emulator/auth/handler",vLe=encodeURIComponent("fac");function $J(r,e,t,n,i,s){return Dk.apply(this,arguments)}function Dk(){return Dk=M(function*(r,e,t,n,i,s){Ve(r.config.authDomain,r,"auth-domain-config-required"),Ve(r.config.apiKey,r,"invalid-api-key");const o={apiKey:r.config.apiKey,appName:r.name,authType:t,redirectUrl:n,v:L6,eventId:i};if(e instanceof pl){e.setDefaultLanguage(r.languageCode),o.providerId=e.providerId||"",function CMe(r){for(const e in r)if(Object.prototype.hasOwnProperty.call(r,e))return!1;return!0}(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,d]of Object.entries(s||{}))o[f]=d}if(e instanceof vJ){const f=e.getScopes().filter(d=>""!==d);f.length>0&&(o.scopes=f.join(","))}r.tenantId&&(o.tid=r.tenantId);const a=o;for(const f of Object.keys(a))void 0===a[f]&&delete a[f];const c=yield r._getAppCheckToken(),l=c?`#${vLe}=${encodeURIComponent(c)}`:"";return`${function CLe({config:r}){return r.emulator?HN(r,_Le):`https://${r.authDomain}/${mLe}`}(r)}?${Af(a).slice(1)}${l}`}),Dk.apply(this,arguments)}const Hk="webStorageSupport",MLe=class yLe{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=OJ,this._completeRedirectFn=RJ,this._overrideRedirectResult=$xe}_openPopup(e,t,n,i){var s=this;return M(function*(){var o;W3(null===(o=s.eventManagers[e._key()])||void 0===o?void 0:o.manager,"_initialize() not called before _openPopup()");const a=yield $J(e,t,n,U9(),i);return function pLe(r,e,t,n=500,i=600){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-n)/2,0).toString();let a="";const c=Object.assign(Object.assign({},lLe),{width:n.toString(),height:i.toString(),top:s,left:o}),l=w2().toLowerCase();t&&(a=QQ(l)?"_blank":t),XQ(l)&&(e=e||"http://localhost",c.scrollbars="yes");const f=Object.entries(c).reduce((m,[E,w])=>`${m}${E}=${w},`,"");if(function nke(r=w2()){var e;return Y_(r)&&!(null===(e=window.navigator)||void 0===e||!e.standalone)}(l)&&"_self"!==a)return function gLe(r,e){const t=document.createElement("a");t.href=r,t.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(n)}(e||"",a),new FJ(null);const d=window.open(e||"",a,f);Ve(d,r,"popup-blocked");try{d.focus()}catch{}return new FJ(d)}(e,a,nv())})()}_openRedirect(e,t,n,i){var s=this;return M(function*(){return yield s._originValidation(e),function cxe(r){e2().location.href=r}(yield $J(e,t,n,U9(),i)),new Promise(()=>{})})()}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:i,promise:s}=this.eventManagers[t];return i?Promise.resolve(i):(W3(s,"If manager is not set, promise should be"),s)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch(()=>{delete this.eventManagers[t]}),n}initAndGetManager(e){var t=this;return M(function*(){const n=yield function cLe(r){return zk.apply(this,arguments)}(e),i=new qxe(e);return n.register("authEvent",s=>(Ve(s?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),t.eventManagers[e._key()]={manager:i},t.iframes[e._key()]=n,i})()}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Hk,{type:Hk},i=>{var s;const o=null===(s=i?.[0])||void 0===s?void 0:s[Hk];void 0!==o&&t(!!o),Ds(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=function Xxe(r){return Rk.apply(this,arguments)}(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return rJ()||XN()||Y_()}};var UJ="@firebase/auth";class ELe{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}getToken(e){var t=this;return M(function*(){return t.assertAuthConfigured(),yield t.auth._initializationPromise,t.auth.currentUser?{accessToken:yield t.auth.currentUser.getIdToken(e)}:null})()}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(n=>{e(n?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Ve(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const OLe=_q("authIdTokenMaxAge")||300;let qJ=null;const bLe=r=>function(){var e=M(function*(t){const n=t&&(yield t.getIdTokenResult()),i=n&&((new Date).getTime()-Date.parse(n.issuedAtTime))/1e3;if(i&&i>OLe)return;const s=n?.token;qJ!==s&&(qJ=s,yield fetch(r,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))});return function(t){return e.apply(this,arguments)}}();function wLe(r=iT()){const e=e5(r,"auth");if(e.isInitialized())return e.getImmediate();const t=function dke(r,e){const t=e5(r,"auth");if(t.isInitialized()){const i=t.getImmediate();if(tm(t.getOptions(),e??{}))return i;Ds(i,"already-initialized")}return t.initialize({options:e})}(r,{popupRedirectResolver:MLe,persistence:[_xe,ixe,OJ]}),n=_q("authTokenSyncURL");if(n){const s=bLe(n);(function Yke(r,e,t){yr(r).beforeAuthStateChanged(e,t)})(t,s,()=>s(t.currentUser)),function Zke(r,e,t,n){yr(r).onIdTokenChanged(e,t,n)}(t,o=>s(o))}const i=gq("auth");return i&&dJ(t,`http://${i}`),t}!function PLe(r){cs(new Ii("auth",(e,{options:t})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=n.options;Ve(o&&!o.includes(":"),"invalid-api-key",{appName:n.name});const c={apiKey:o,authDomain:a,clientPlatform:r,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:iJ(r)},l=new fke(n,i,s,c);return function hke(r,e){const t=e?.persistence||[],n=(Array.isArray(t)?t:[t]).map(Z3);e?.errorMap&&r._updateErrorMap(e.errorMap),r._initializeWithPersistence(n,e?.popupRedirectResolver)}(l,t),l},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider("auth-internal").initialize()})),cs(new Ii("auth-internal",e=>{const t=R2(e.getProvider("auth").getImmediate());return new ELe(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Mr(UJ,"0.23.2",function SLe(r){switch(r){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(r)),Mr(UJ,"0.23.2","esm2017")}("Browser");class cv{constructor(e){return e}}class ZJ{constructor(){return uN("auth")}}const Fk=new tt("angularfire2.auth-instances");function NLe(r){return(e,t)=>{const n=e.runOutsideAngular(()=>r(t));return new cv(n)}}const ILe={provide:ZJ,deps:[[new rs,Fk]]},kLe={provide:cv,useFactory:function ALe(r,e){const t=lN("auth",r,e);return t&&new cv(t)},deps:[[new rs,Fk],G5]};let xLe=(()=>{class r{constructor(){Mr("angularfire",D_.full,"auth")}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=Ei({type:r}),r.\u0275inj=X2({providers:[kLe,ILe]}),r})();const zLe=G1(Dke,!0),DLe=G1(wLe,!0),HLe=G1(Kke,!0),VLe=G1(Fke,!0),FLe=G1(Rke,!0),$Le=G1(Hke,!0),GLe=G1(Dxe,!0),BLe=G1(Gke,!0);class gl{constructor(e){return e}}const YJ="firestore",$k=new tt("angularfire2.firestore-instances");function qLe(r){return(e,t)=>{const n=e.runOutsideAngular(()=>r(t));return new gl(n)}}const jLe={provide:class ULe{constructor(){return uN(YJ)}},deps:[[new rs,$k]]},ZLe={provide:gl,useFactory:function WLe(r,e){const t=lN(YJ,r,e);return t&&new gl(t)},deps:[[new rs,$k],G5]};let YLe=(()=>{class r{constructor(){Mr("angularfire",D_.full,"fst")}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=Ei({type:r}),r.\u0275inj=X2({providers:[ZLe,jLe]}),r})();const XLe=G1(hbe,!0),QLe=G1(GOe,!0),eRe=G1(dbe,!0),nd=G1(BK,!0),tRe=G1(cbe,!0),nRe=G1(lbe,!0),rRe=G1(WOe,!0),iRe=G1(ibe,!0),KJ=G1(pbe,!0),sRe=G1(rbe,!0),lv=G1(tbe,!0),oRe=G1(ube,!0),aRe=G1(fbe,!0),cRe=G1(nbe,!0);class h0{constructor(e,t){u(this,"collectionName",void 0),u(this,"firestore",void 0),u(this,"collection",void 0),u(this,"subDAOs",{}),this.collectionName=e,this.firestore=t;this.collection=QLe(t,this.collectionName).withConverter({fromFirestore:i=>i.data(),toFirestore:i=>i})}create(e){var t=this;return M(function*(){return(yield XLe(t.collection,e)).id})()}read(e){var t=this;return M(function*(){const n=yield tRe(nd(t.collection,e));return n.exists()?g.of(U.getNonNullable(n.data())):g.empty()})()}exists(e){var t=this;return M(function*(){return(yield t.read(e)).isPresent()})()}update(e,t){var n=this;return M(function*(){return aRe(nd(n.collection,e),t)})()}delete(e){return eRe(nd(this.collection,e))}set(e,t){return oRe(nd(this.collection,e),t)}subscribeToChanges(e,t){return new yn(KJ(nd(this.collection,e),n=>{t(g.ofNullable(n.data()))}))}findWhere(e,t,n){var i=this;return M(function*(){const s=i.constructQuery(e,t,n);return(yield nRe(s)).docs.map(a=>({id:a.id,data:a.data()}))})()}observingWhere(e,t,n){const i=this.constructQuery(e,n);return new yn(KJ(i,s=>{const o=[],a=[],c=[];s.docChanges().forEach(l=>{const f={id:l.doc.id,data:l.doc.data()};switch(l.type){case"added":o.push(f);break;case"modified":a.push(f);break;case"removed":c.push(f)}}),o.length>0&&(Ne.display("FirestoreDAO","subscription","firebase gave us "+o.length+" NEW "+this.collectionName),t.onDocumentCreated(o)),a.length>0&&(Ne.display("FirestoreDAO","subscription","firebase gave us "+a.length+" MODIFIED "+this.collectionName),t.onDocumentModified(a)),c.length>0&&(Ne.display("FirestoreDAO","subscription","firebase gave us "+c.length+" DELETED "+this.collectionName),t.onDocumentDeleted(c))}))}constructQuery(e,t,n){let i=lv(this.collection);null!=t&&(i=lv(i,sRe(t))),null!=n&&(i=lv(i,iRe(n)));for(const s of e)i=lv(i,cRe(s[0],s[1],s[2]));return i}subCollectionDAO(e,t){const n=`${this.collection.path}/${e}/${t}`;if(n in this.subDAOs)return this.subDAOs[n];{const i=new class extends h0{constructor(s){super(n,s)}}(this.firestore);return this.subDAOs[n]=i,i}}}let lRe=(()=>{var r;class e extends h0{constructor(n){super("errors",n)}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(Pe(gl))}),u(e,"\u0275prov",He({token:r,factory:r.\u0275fac,providedIn:"root"})),e})();var uRe=So(1);let Ut=(()=>{var r;class e{infoMessage(n){this.message(n,"is-info")}gameMessage(n){this.message(n,"is-warning")}criticalMessage(n){this.message(n,"is-danger")}message(n,i){const s=this.getDuration(n);this.toast(n,i,s)}toast(n,i,s){(0,uRe.toast)({message:n,duration:s,type:i,position:"top-center",closeOnClick:!0,dismissible:!0})}getDuration(n){const i=n.split(" ").length;return Math.max(60*i*1e3/150,3e3)}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)}),u(e,"\u0275prov",He({token:r,factory:r.\u0275fac,providedIn:"root"})),e})();var uv,p0;class d2{static setSingletonInstance(e){d2.singleton=g.of(e)}static logErrorAndFail(e,t,n){throw d2.logError(e,t,n),new Error(`${e}: ${t} (extra data: ${JSON.stringify(n)})`)}static logError(e,t,n){if(this.singleton.isAbsent())throw new Error(`${e}: ${t} (extra data: ${JSON.stringify(n)})`);return this.singleton.get().logError(e,t,n),b.failure(e+": "+t)}constructor(e,t,n){u(this,"errorDAO",void 0),u(this,"router",void 0),u(this,"messageDisplayer",void 0),this.errorDAO=e,this.router=t,this.messageDisplayer=n,d2.setSingletonInstance(this)}findErrors(e,t,n,i){return this.errorDAO.findWhere(void 0===i?[["component","==",e],["route","==",t],["message","==",n]]:[["component","==",e],["route","==",t],["message","==",n],["data","==",i]])}logError(e,t,n){var i=this;return M(function*(){i.messageDisplayer.criticalMessage($localize`An unexpected error was encountered. We have logged it and will try to fix its cause as soon as possible.`);const s=i.router.url,o=yield i.findErrors(e,s,t,n);if(0===o.length){const a={component:e,route:s,message:t,firstEncounter:kc(),lastEncounter:kc(),occurences:1};null!=n&&(a.data=n),yield i.errorDAO.create(a)}else{const a=o[0].id,c=o[0].data;yield i.errorDAO.update(a,{lastEncounter:kc(),occurences:c.occurences+1})}})()}}uv=d2,u(d2,"singleton",g.empty()),u(d2,"\u0275fac",function(e){return new(e||uv)(Pe(lRe),Pe(Gn),Pe(Ut))}),u(d2,"\u0275prov",He({token:uv,factory:uv.\u0275fac,providedIn:"root"}));class Ne{static enableLog(e,t,n){const i=localStorage.getItem("verbosity");let s={};null!=i&&(s=JSON.parse(i)),n?s[t+"."+n]=e:s[t]=e,localStorage.setItem("verbosity",JSON.stringify(s))}static isVerbose(e){const t=localStorage.getItem("verbosity");if(null==t)return[!1,!1];const n=JSON.parse(t);return null==n[e]?[!1,!1]:(U.assert(Array.isArray(n[e]),`malformed verbosity levels: ${n[e]}`),n[e])}static isMethodVerboseEntry(e,t){return Ne.isVerbose(e)[0]||Ne.isVerbose(e+"."+t)[0]}static isMethodVerboseExit(e,t){return Ne.isVerbose(e)[1]||Ne.isVerbose(e+"."+t)[1]}static display(e,t,n){Ne.isMethodVerboseEntry(e,t)&&console.log(`${e}.${t}: ${n}`)}static log(e){const t=e.name;for(const n of Object.getOwnPropertyNames(e.prototype)){const i=Object.getOwnPropertyDescriptor(e.prototype,n),s=U.getNonNullable(i);U.assert(s.value instanceof Function,"cannot add logging to properties that are not methods!");const a=s.value;s.value=function(...c){if(Ne.isMethodVerboseEntry(t,n)){const f=Array.from(c).map(d=>JSON.stringify(d)).join(", ");console.log(`> ${t}.${n}(${f})`)}const l=a.apply(this,c);return Ne.isMethodVerboseExit(t,n)&&console.log(`< ${t}.${n} -> ${JSON.stringify(l)}`),l},Object.defineProperty(e.prototype,n,s)}}}window.enableLog=Ne.enableLog;class U{static expectToBe(e,t,n){if(e!==t)throw void 0!==n?new Error(n):new Error(`A default switch case did not observe the correct value, expected ${t}, but got ${e} instead.`)}static expectToBeMultiple(e,t){let n=!1;for(const i of t)if(e===i){n=!0;break}if(!1===n)throw new Error(`A default switch case did not observe the correct value, expected a value among ${t}, but got ${e} instead.`)}static getNonNullable(e){if(null==e)throw new Error("Expected value not to be null or undefined, but it was.");return e}static assert(e,t){if(!1===e)throw d2.logError("Assertion failure",t),new Error(`Assertion failure: ${t}`)}static identity(e){return e}}let Gk=(u(p0=class extends h0{constructor(e){super("chats",e)}},"\u0275fac",function(e){return new(e||p0)(Pe(gl))}),u(p0,"\u0275prov",He({token:p0,factory:p0.\u0275fac,providedIn:"root"})),p0);var g0;Gk=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ne.log],Gk);let XJ=(()=>{class r{}return u(r,"CANNOT_SEND_MESSAGE",()=>$localize`You're not allowed to send a message here.`),u(r,"FORBIDDEN_MESSAGE",()=>$localize`This message is forbidden.`),r})(),Z5=(g0=class{constructor(e){u(this,"chatDAO",void 0),this.chatDAO=e}addMessage(e,t){var n=this;return M(function*(){return n.chatDAO.subCollectionDAO(e,"messages").create(t)})()}getLastMessages(e,t){var n=this;return M(function*(){return n.chatDAO.subCollectionDAO(e,"messages").findWhere([],"postedTime",t)})()}subscribeToMessages(e,t){return this.chatDAO.subCollectionDAO(e,"messages").observingWhere([],t,"postedTime")}deleteChat(e){var t=this;return M(function*(){return t.chatDAO.delete(e)})()}createNewChat(e){var t=this;return M(function*(){return t.chatDAO.set(e,{})})()}sendMessage(e,t,n,i){var s=this;return M(function*(){if(!1===s.userCanSendMessage(t.name,e))return b.failure(XJ.CANNOT_SEND_MESSAGE());if(s.isForbiddenMessage(n))return b.failure(XJ.FORBIDDEN_MESSAGE());const o={content:n,sender:t,postedTime:kc(),currentTurn:i};return yield s.addMessage(e,o),b.SUCCESS})()}userCanSendMessage(e,t){return""!==e}isForbiddenMessage(e){return""===e}},u(g0,"\u0275fac",function(e){return new(e||g0)(Pe(Gk))}),u(g0,"\u0275prov",He({token:g0,factory:g0.\u0275fac,providedIn:"root"})),g0);function Ze(r,e,t){if(!1===r)throw void 0!==t&&console.log(t),d2.logError("Assertion failure",e),new Error(`Assertion failure: ${e}`)}var K3,Bk;Z5=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ne.log],Z5);let rd=(Bk=K3=class extends h0{constructor(e){super(Bk.COLLECTION_NAME,e)}},u(K3,"COLLECTION_NAME","users"),u(K3,"\u0275fac",function(e){return new(e||K3)(Pe(gl))}),u(K3,"\u0275prov",He({token:K3,factory:K3.\u0275fac,providedIn:"root"})),K3);rd=Bk=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ne.log],rd);let Y5=(()=>{var r;class e{constructor(n){u(this,"userDAO",void 0),this.userDAO=n}usernameIsAvailable(n){var i=this;return M(function*(){return 0===(yield i.userDAO.findWhere([["username","==",n]])).length})()}setUsername(n,i){var s=this;return M(function*(){yield s.userDAO.update(n,{username:i})})()}markAsVerified(n){var i=this;return M(function*(){yield i.userDAO.update(n,{verified:!0})})()}observeUserOnServer(n,i){return this.userDAO.subscribeToChanges(n,s=>{s.isPresent()&&null===s.get().lastUpdateTime||i(s)})}getUserLastUpdateTime(n){var i=this;return M(function*(){const s=yield i.userDAO.read(n);if(s.isAbsent())return g.empty();{const o=s.get().lastUpdateTime;return Ze(null!=o,"should not receive a lastUpdateTime equal to null"),g.of(o)}})()}updatePresenceToken(n){return this.userDAO.update(n,{lastUpdateTime:kc()})}getServerTime(n){var i=this;return M(function*(){return new Promise(s=>{let o=!1;const c=i.userDAO.subscribeToChanges(n,l=>{null==l.get().lastUpdateTime?o=!0:o&&(c.unsubscribe(),s(l.get().lastUpdateTime))});i.updatePresenceToken(n)})})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(Pe(rd))}),u(e,"\u0275prov",He({token:r,factory:r.\u0275fac,providedIn:"root"})),e})();class QJ extends Ss{constructor(e=1/0,t=1/0,n=tN){super(),this._bufferSize=e,this._windowTime=t,this._timestampProvider=n,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=t===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,t)}next(e){const{isStopped:t,_buffer:n,_infiniteTimeWindow:i,_timestampProvider:s,_windowTime:o}=this;t||(n.push(e),!i&&n.push(s.now()+o)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();const t=this._innerSubscribe(e),{_infiniteTimeWindow:n,_buffer:i}=this,s=i.slice();for(let o=0;o<s.length&&!e.closed;o+=n?1:2)e.next(s[o]);return this._checkFinalizedStatuses(e),t}_trimBuffer(){const{_bufferSize:e,_timestampProvider:t,_buffer:n,_infiniteTimeWindow:i}=this,s=(i?1:2)*e;if(e<1/0&&s<n.length&&n.splice(0,n.length-s),!i){const o=t.now();let a=0;for(let c=1;c<n.length&&n[c]<=o;c+=2)a=c;a&&n.splice(0,a+1)}}}var m0;let id=(()=>{class r{}return u(r,"YOU_ARE_ALREADY_PLAYING",()=>$localize`You are already playing in another game.`),u(r,"YOU_ARE_ALREADY_CREATING",()=>$localize`You are already the creator of another game.`),u(r,"YOU_ARE_ALREADY_CHOSEN_OPPONENT",()=>$localize`You are already the chosen opponent in another game.`),u(r,"YOU_ARE_ALREADY_CANDIDATE",()=>$localize`You are already candidate in another game.`),u(r,"YOU_ARE_ALREADY_OBSERVING",()=>$localize`You are already observing another game.`),r})();class ml{static createUserWithEmailAndPassword(e,t,n){return zLe(e,t,n)}static sendEmailVerification(e){return VLe(e)}static sendPasswordResetEmail(e,t){return FLe(e,t)}static signInWithEmailAndPassword(e,t,n){return M(function*(){return(yield $Le(e,t,n)).user})()}static signInWithPopup(e,t){return M(function*(){return(yield GLe(e,t)).user})()}static updateProfile(e,t){return BLe(e,t)}}class _0{constructor(e,t,n,i){u(this,"id",void 0),u(this,"email",void 0),u(this,"username",void 0),u(this,"verified",void 0),this.id=e,this.email=t,this.username=n,this.verified=i}isConnected(){return this.email.isPresent()}toMinimalUser(){return{id:this.id,name:this.username.get()}}equals(e){return this.id===e.id&&this.email.equals(e.email)&&this.username.equals(e.username)&&this.verified===e.verified}}u(_0,"NOT_CONNECTED",new _0("",g.empty(),g.empty(),!1));let lr=(m0=class{constructor(e,t,n){var i=this;u(this,"userDAO",void 0),u(this,"userService",void 0),u(this,"auth",void 0),u(this,"authSubscription",void 0),u(this,"user",g.empty()),u(this,"userRS",void 0),u(this,"userObs",void 0),u(this,"userSubscription",new yn),this.userDAO=e,this.userService=t,this.auth=n,this.userRS=new QJ(1),this.userObs=this.userRS.asObservable(),this.authSubscription=new yn(HLe(this.auth,function(){var s=M(function*(o){null==o?(Ne.display("ConnectedUserService","subscription","User is not connected"),i.userSubscription.unsubscribe(),i.userRS.next(_0.NOT_CONNECTED),i.user=g.empty()):(Ze(i.user.isAbsent(),"ConnectedUserService received a double update for an user, this is unexpected"),i.userSubscription=i.userDAO.subscribeToChanges(o.uid,a=>{if(a.isPresent()){const c=a.get(),l=c.username;Ne.display("ConnectedUserService","subscription",`User ${l} is connected, and the verified status is ${i.emailVerified(o)}`);const f=!0===i.emailVerified(o)&&null!=l;if(!0===f&&!1===c.verified)return i.userService.markAsVerified(o.uid);const d=new _0(o.uid,g.ofNullable(o.email),g.ofNullable(l),f);!1===i.user.equalsValue(d)&&(i.user=g.of(d),i.userRS.next(d))}}))});return function(o){return s.apply(this,arguments)}}()))}emailVerified(e){return e.emailVerified}sendPasswordResetEmail(e){var t=this;return M(function*(){try{return yield ml.sendPasswordResetEmail(t.auth,e),b.SUCCESS}catch(n){return b.failure(t.mapFirebaseError(n))}})()}doRegister(e,t,n){var i=this;return M(function*(){return(yield i.userService.usernameIsAvailable(e))?i.registerAfterUsernameCheck(e,t,n):ie.failure($localize`This username is already in use.`)})()}registerAfterUsernameCheck(e,t,n){var i=this;return M(function*(){try{const s=yield ml.createUserWithEmailAndPassword(i.auth,t,n);yield ml.signInWithEmailAndPassword(i.auth,t,n);const o=U.getNonNullable(s.user);return yield i.createUser(o.uid,e),ie.success(o)}catch(s){return ie.failure(i.mapFirebaseError(s))}})()}mapFirebaseError(e){switch(e.code){case"auth/email-already-in-use":return $localize`This email address is already in use.`;case"auth/invalid-email":return $localize`This email address is invalid.`;case"auth/user-not-found":case"auth/wrong-password":return $localize`You have entered invalid credentials.`;case"auth/invalid-credential":return $localize`The credential is invalid or has expired, please try again.`;case"auth/weak-password":return $localize`Your password is too weak, please use a stronger password.`;case"auth/too-many-requests":return $localize`There has been too many requests from your device. You are temporarily blocked due to unusual activity. Try again later.`;case"auth/popup-closed-by-user":return $localize`You closed the authentication popup without finalizing your log in.`;case"auth/popup-blocked":return $localize`The authentication popup was blocked. Try again after disabling popup blocking.`;default:return d2.logError("ConnectedUserService","Unsupported firebase error",{errorCode:e.code,errorMessage:e.message}),e.message}}sendEmailVerification(){var e=this;return M(function*(){const t=g.ofNullable(e.auth.currentUser);if(!t.isPresent())return d2.logError("ConnectedUserService","Unlogged users cannot request for email verification");if(e.emailVerified(t.get()))return d2.logError("ConnectedUserService","Verified users should not ask email verification after being verified");try{return yield ml.sendEmailVerification(t.get()),b.SUCCESS}catch(n){return b.failure(e.mapFirebaseError(n))}})()}doEmailLogin(e,t){var n=this;return M(function*(){try{return yield ml.signInWithEmailAndPassword(n.auth,e,t),b.SUCCESS}catch(i){return b.failure(n.mapFirebaseError(i))}})()}createUser(e,t){var n=this;return M(function*(){null==t?yield n.userDAO.set(e,{verified:!1,currentGame:null}):yield n.userDAO.set(e,{username:t,verified:!1,currentGame:null})})()}doGoogleLogin(){var e=this;return M(function*(){return b.ofFallible(yield e.registerOrLoginWithGoogle())})()}registerOrLoginWithGoogle(){var e=this;return M(function*(){try{const t=new Ake;t.addScope("profile"),t.addScope("email");const n=yield ml.signInWithPopup(e.auth,t);return!1===(yield e.userDAO.exists(n.uid))&&(yield e.createUser(n.uid)),ie.success(n)}catch(t){return ie.failure(e.mapFirebaseError(t))}})()}disconnect(){var e=this;return M(function*(){return g.ofNullable(e.auth.currentUser).isPresent()?(yield e.auth.signOut(),b.SUCCESS):b.failure("Cannot disconnect a non-connected user")})()}subscribeToUser(e){return this.userObs.subscribe(e)}setUsername(e){var t=this;return M(function*(){if(""===e)return b.failure($localize`Your username may not be empty.`);try{if(!1===(yield t.userService.usernameIsAvailable(e)))return b.failure($localize`This username is already in use, please select a different one.`);const i=U.getNonNullable(t.auth.currentUser);return yield ml.updateProfile(i,{displayName:e}),yield t.userService.setUsername(i.uid,e),yield t.userService.markAsVerified(i.uid),yield t.reloadUser(),b.SUCCESS}catch(n){return b.failure(t.mapFirebaseError(n))}})()}setPicture(e){var t=this;return M(function*(){try{const n=U.getNonNullable(t.auth.currentUser);return yield ml.updateProfile(n,{photoURL:e}),b.SUCCESS}catch(n){return b.failure(t.mapFirebaseError(n))}})()}reloadUser(){var e=this;return M(function*(){const t=U.getNonNullable(e.auth.currentUser);yield t.getIdToken(!0),yield t.reload()})()}sendPresenceToken(){return Ze(this.user.isPresent(),"Should not call sendPresenceToken when not connected"),this.userService.updatePresenceToken(this.user.get().id)}ngOnDestroy(){this.userSubscription.unsubscribe(),this.authSubscription.unsubscribe()}},u(m0,"\u0275fac",function(e){return new(e||m0)(Pe(rd),Pe(Y5),Pe(cv))}),u(m0,"\u0275prov",He({token:m0,factory:m0.\u0275fac,providedIn:"root"})),m0);var X3,dv,hv,sd,K5,K,v0;lr=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ne.log],lr);class L1{constructor(e){u(this,"value",void 0),this.value=e}}u(L1,"HARD_DRAW",new(X3=L1)(0)),u(L1,"RESIGN",new X3(1)),u(L1,"ESCAPE",new X3(2)),u(L1,"VICTORY",new X3(3)),u(L1,"TIMEOUT",new X3(4)),u(L1,"UNACHIEVED",new X3(5)),u(L1,"AGREED_DRAW_BY_ZERO",new X3(6)),u(L1,"AGREED_DRAW_BY_ONE",new X3(7));class fv{constructor(e,t){u(this,"id",void 0),u(this,"data",void 0),this.id=e,this.data=t}getTurn(){return this.data.turn}isHardDraw(){return this.data.result===L1.HARD_DRAW.value}isAgreedDraw(){return this.data.result===L1.AGREED_DRAW_BY_ZERO.value||this.data.result===L1.AGREED_DRAW_BY_ONE.value}getDrawAccepter(){return this.data.result===L1.AGREED_DRAW_BY_ZERO.value?this.data.playerZero:(Ze(this.data.result===L1.AGREED_DRAW_BY_ONE.value,"should not access getDrawAccepter when no draw accepted!"),U.getNonNullable(this.data.playerOne))}isWin(){return this.data.result===L1.VICTORY.value}isTimeout(){return this.data.result===L1.TIMEOUT.value}isResign(){return this.data.result===L1.RESIGN.value}getWinner(){return g.ofNullable(this.data.winner)}getLoser(){return g.ofNullable(this.data.loser)}setWinnerAndLoser(e,t){return new fv(this.id,{...this.data,winner:e,loser:t})}}class z2{constructor(e){u(this,"value",void 0),this.value=e}static of(e){switch(e){case"CREATOR":return z2.CREATOR;case"RANDOM":return z2.RANDOM;default:return Ze("CHOSEN_PLAYER"===e,"Invalid value for FirstPlayer: "+e+"."),z2.CHOSEN_PLAYER}}}u(z2,"CREATOR",new(dv=z2)("CREATOR")),u(z2,"RANDOM",new dv("RANDOM")),u(z2,"CHOSEN_PLAYER",new dv("CHOSEN_PLAYER"));class ur{constructor(e){u(this,"value",void 0),this.value=e}static of(e){switch(e){case"STANDARD":return ur.STANDARD;case"BLITZ":return ur.BLITZ;case"CUSTOM":return ur.CUSTOM;default:throw new Error("Invalid part type: "+e+".")}}}u(ur,"STANDARD",new(hv=ur)("STANDARD")),u(ur,"BLITZ",new hv("BLITZ")),u(ur,"CUSTOM",new hv("CUSTOM")),u(ur,"NORMAL_MOVE_DURATION",120),u(ur,"NORMAL_PART_DURATION",1800),u(ur,"BLITZ_MOVE_DURATION",30),u(ur,"BLITZ_PART_DURATION",900);class ui{constructor(e){u(this,"value",void 0),this.value=e}}u(ui,"PART_CREATED",new(sd=ui)(0)),u(ui,"CONFIG_PROPOSED",new sd(2)),u(ui,"PART_STARTED",new sd(3)),u(ui,"PART_FINISHED",new sd(4));class Uk{constructor(){u(this,"value",2)}isPlayer(){return!1}toString(){return"PLAYER_NONE"}equals(e){return this===e}}u(Uk,"NONE",new Uk);class k{static of(e){return 0===e?k.ZERO:(U.expectToBe(e,1),k.ONE)}static ofTurn(e){return e%2==0?k.ZERO:k.ONE}constructor(e){u(this,"value",void 0),this.value=e}isPlayer(){return!0}toString(){return this===k.ZERO?"PLAYER_ZERO":(U.expectToBe(this,k.ONE,"Player should not be something else than Player.ZERO and Player.ONE"),"PLAYER_ONE")}equals(e){return this===e}getScoreModifier(){return 0===this.value?-1:1}getPreVictory(){return this.getVictoryValue()-this.getScoreModifier()}getVictoryValue(){return this===k.ZERO?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER}getOpponent(){return this===k.ZERO?k.ONE:(U.expectToBe(this,k.ONE),k.ZERO)}}K5=k,u(k,"encoder",we.tuple([we.identity()],r=>[r.value],r=>K5.of(r[0]))),u(k,"ZERO",new K5(0)),u(k,"ONE",new K5(1)),u(k,"PLAYERS",[K5.ZERO,K5.ONE]),function(r){r.ZERO=k.ZERO,r.ONE=k.ONE,r.NONE=Uk.NONE,r.encoder=new class extends we{encode(e){return e.value}decode(e){return 2===e?r.NONE:(U.assert(0===e||1===e,"Invalid encoded player: "+e),k.of(e))}}}(K||(K={}));let od=(u(v0=class extends h0{constructor(e){super("parts",e)}},"\u0275fac",function(e){return new(e||v0)(Pe(gl))}),u(v0,"\u0275prov",He({token:v0,factory:v0.\u0275fac,providedIn:"root"})),v0);od=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ne.log],od);class pv{constructor(e,t,n){u(this,"onDocumentCreated",void 0),u(this,"onDocumentModified",void 0),u(this,"onDocumentDeleted",void 0),this.onDocumentCreated=e,this.onDocumentModified=t,this.onDocumentDeleted=n}}let Wk=(()=>{var r;class e{constructor(n){u(this,"partDAO",void 0),this.partDAO=n}eventsCollection(n){return this.partDAO.subCollectionDAO(n,"events")}addEvent(n,i){return this.eventsCollection(n).create(i)}addMove(n,i,s){return this.addEvent(n,{eventType:"Move",time:kc(),player:i.value,move:s})}addRequest(n,i,s){return this.addEvent(n,{eventType:"Request",time:kc(),player:i.value,requestType:s})}addReply(n,i,s,o,a=null){return this.addEvent(n,{eventType:"Reply",time:kc(),player:i.value,reply:s,requestType:o,data:a})}startGame(n,i){return this.addAction(n,i,"StartGame")}addAction(n,i,s){return this.addEvent(n,{eventType:"Action",time:kc(),player:i.value,action:s})}subscribeToEvents(n,i){const s=new pv(o=>{const a=o.map(c=>c.data).filter(c=>null!=c.time);a.length>0&&i(a)},o=>{i(o.map(a=>a.data))},()=>{});return this.eventsCollection(n).observingWhere([],s,"time")}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(Pe(od))}),u(e,"\u0275prov",He({token:r,factory:r.\u0275fac,providedIn:"root"})),e})();var C0;let qk=(u(C0=class extends h0{constructor(e){super("config-room",e)}},"\u0275fac",function(e){return new(e||C0)(Pe(gl))}),u(C0,"\u0275prov",He({token:C0,factory:C0.\u0275fac,providedIn:"root"})),C0);var Q3,jk;qk=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ne.log],qk);let ad=(Q3=class{constructor(e,t){u(this,"configRoomDAO",void 0),u(this,"connectedUserService",void 0),this.configRoomDAO=e,this.connectedUserService=t}addCandidate(e,t){return this.configRoomDAO.subCollectionDAO(e,"candidates").set(t.id,t)}removeCandidate(e,t){return this.configRoomDAO.subCollectionDAO(e,"candidates").delete(t.id)}subscribeToChanges(e,t){return this.configRoomDAO.subscribeToChanges(e,t)}subscribeToCandidates(e,t){let n=[];const i=new pv(o=>{for(const a of o)n.push(a.data);t(n)},o=>{for(const a of o)n=n.map(c=>c.id===a.data.id?a.data:c);t(n)},o=>{for(const a of o)n=n.filter(c=>c.id!==a.data.id);t(n)});return this.configRoomDAO.subCollectionDAO(e,"candidates").observingWhere([],i)}createInitialConfigRoom(e){var t=this;return M(function*(){const n=t.connectedUserService.user.get().toMinimalUser();return t.configRoomDAO.set(e,{chosenOpponent:null,firstPlayer:z2.RANDOM.value,partType:ur.STANDARD.value,partStatus:ui.PART_CREATED.value,maximalMoveDuration:ur.NORMAL_MOVE_DURATION,totalPartDuration:ur.NORMAL_PART_DURATION,creator:n})})()}joinGame(e){var t=this;return M(function*(){const n=t.connectedUserService.user.get().toMinimalUser(),i=yield t.configRoomDAO.read(e);return i.isAbsent()?b.failure(jk.GAME_DOES_NOT_EXIST()):(i.get().creator.id!==n.id&&(yield t.addCandidate(e,n)),b.SUCCESS)})()}cancelJoining(e){var t=this;return M(function*(){const n=t.connectedUserService.user.get().toMinimalUser(),i=yield t.configRoomDAO.read(e);if(!i.isAbsent()){const s=i.get(),o=[t.removeCandidate(e,n)];s.chosenOpponent?.id===n.id&&o.push(t.configRoomDAO.update(e,{chosenOpponent:null,partStatus:ui.PART_CREATED.value})),yield Promise.all(o)}})()}deleteConfigRoom(e,t){var n=this;return M(function*(){yield Promise.all(t.map(i=>n.removeCandidate(e,i))),yield n.configRoomDAO.delete(e)})()}proposeConfig(e,t,n,i,s,o){var a=this;return M(function*(){return a.configRoomDAO.update(e,{partStatus:ui.CONFIG_PROPOSED.value,chosenOpponent:t,partType:n.value,maximalMoveDuration:i,totalPartDuration:o,firstPlayer:s.value})})()}setChosenOpponent(e,t){return this.configRoomDAO.update(e,{chosenOpponent:t})}reviewConfig(e){var t=this;return M(function*(){return t.configRoomDAO.update(e,{partStatus:ui.PART_CREATED.value})})()}reviewConfigAndRemoveChosenOpponent(e){var t=this;return M(function*(){return t.configRoomDAO.update(e,{partStatus:ui.PART_CREATED.value,chosenOpponent:null})})()}acceptConfig(e){return this.configRoomDAO.update(e,{partStatus:ui.PART_STARTED.value})}createConfigRoom(e,t){var n=this;return M(function*(){return n.configRoomDAO.set(e,t)})()}readConfigRoomById(e){var t=this;return M(function*(){return(yield t.configRoomDAO.read(e)).get()})()}},jk=Q3,u(Q3,"GAME_DOES_NOT_EXIST",()=>$localize`Game does not exist`),u(Q3,"\u0275fac",function(e){return new(e||Q3)(Pe(qk),Pe(lr))}),u(Q3,"\u0275prov",He({token:Q3,factory:Q3.\u0275fac,providedIn:"root"})),Q3);var y0;ad=jk=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ne.log],ad);let X5=(y0=class{constructor(e,t,n,i,s){u(this,"partDAO",void 0),u(this,"gameEventService",void 0),u(this,"connectedUserService",void 0),u(this,"configRoomService",void 0),u(this,"chatService",void 0),this.partDAO=e,this.gameEventService=t,this.connectedUserService=n,this.configRoomService=i,this.chatService=s}update(e,t){var n=this;return M(function*(){return n.partDAO.update(e,t)})()}getPartValidity(e,t){var n=this;return M(function*(){const i=yield n.partDAO.read(e);return i.isAbsent()?b.failure("NONEXISTENT_PART"):i.get().typeGame===t?b.SUCCESS:b.failure("WRONG_GAME_TYPE")})()}createUnstartedPart(e){const t=this.connectedUserService.user.get().toMinimalUser();return this.partDAO.create({typeGame:e,playerZero:t,turn:-1,result:L1.UNACHIEVED.value})}createChat(e){return this.chatService.createNewChat(e)}createPartConfigRoomAndChat(e){var t=this;return M(function*(){const n=yield t.createUnstartedPart(e);return yield t.configRoomService.createInitialConfigRoom(n),yield t.createChat(n),n})()}getStartingConfig(e){let n,i,t=z2.of(e.firstPlayer);return t===z2.RANDOM&&(t=Math.random()<.5?z2.CREATOR:z2.CHOSEN_PLAYER),t===z2.CREATOR?(n=e.creator,i=U.getNonNullable(e.chosenOpponent)):(n=U.getNonNullable(e.chosenOpponent),i=e.creator),{playerZero:n,playerOne:i,turn:0,beginning:kc()}}deletePart(e){return this.partDAO.delete(e)}acceptConfig(e,t){var n=this;return M(function*(){yield n.configRoomService.acceptConfig(e);const i=n.getStartingConfig(t);let s;s=i.playerZero===t.creator?k.ONE:k.ZERO,yield n.partDAO.update(e,i),yield n.gameEventService.startGame(e,s)})()}getPart(e){return this.partDAO.read(e)}subscribeToChanges(e,t){return this.partDAO.subscribeToChanges(e,t)}resign(e,t,n,i){var s=this;return M(function*(){const o={winner:n,loser:i,result:L1.RESIGN.value};yield s.partDAO.update(e,o),yield s.gameEventService.addAction(e,t,"EndGame")})()}notifyTimeout(e,t,n,i){var s=this;return M(function*(){const o={winner:n,loser:i,result:L1.TIMEOUT.value};yield s.partDAO.update(e,o),yield s.gameEventService.addAction(e,t,"EndGame")})()}proposeDraw(e,t){var n=this;return M(function*(){yield n.gameEventService.addRequest(e,t,"Draw")})()}acceptDraw(e,t){var n=this;return M(function*(){yield n.gameEventService.addReply(e,t,"Accept","Draw");const s={result:(t===k.ZERO?L1.AGREED_DRAW_BY_ZERO:L1.AGREED_DRAW_BY_ONE).value};yield n.partDAO.update(e,s),yield n.gameEventService.addAction(e,t,"EndGame")})()}refuseDraw(e,t){var n=this;return M(function*(){yield n.gameEventService.addReply(e,t,"Reject","Draw")})()}proposeRematch(e,t){var n=this;return M(function*(){yield n.gameEventService.addRequest(e,t,"Rematch")})()}rejectRematch(e,t){var n=this;return M(function*(){yield n.gameEventService.addReply(e,t,"Reject","Rematch")})()}acceptRematch(e,t){var n=this;return M(function*(){const i=U.getNonNullable(e.data),s=yield n.configRoomService.readConfigRoomById(e.id);let o;const a=n.connectedUserService.user.get().toMinimalUser();let c;i.playerZero.id===a.id?(c=U.getNonNullable(i.playerOne),o=z2.CHOSEN_PLAYER):(c=i.playerZero,o=z2.CREATOR);const l={...s,firstPlayer:o.value,creator:a,chosenOpponent:c,partStatus:ui.PART_STARTED.value},f=n.getStartingConfig(l),d={typeGame:i.typeGame,result:L1.UNACHIEVED.value,...f},m=yield n.partDAO.create(d);yield n.configRoomService.createConfigRoom(m,l),yield n.createChat(m),yield n.gameEventService.addReply(e.id,t,"Accept","Rematch",m),yield n.gameEventService.startGame(m,t.getOpponent())})()}askTakeBack(e,t){var n=this;return M(function*(){yield n.gameEventService.addRequest(e,t,"TakeBack")})()}acceptTakeBack(e,t,n){var i=this;return M(function*(){let s=t-1;s%2===n.value&&s--;const o={turn:s};return yield i.gameEventService.addReply(e,n,"Accept","TakeBack"),yield i.partDAO.update(e,o)})()}refuseTakeBack(e,t){var n=this;return M(function*(){yield n.gameEventService.addReply(e,t,"Reject","TakeBack")})()}addGlobalTime(e,t){var n=this;return M(function*(){yield n.gameEventService.addAction(e,t,"AddGlobalTime")})()}addTurnTime(e,t){var n=this;return M(function*(){yield n.gameEventService.addAction(e,t,"AddTurnTime")})()}preparePartUpdate(e,t){var n=this;return M(function*(){let o={turn:(yield n.partDAO.read(e)).get().turn+1};return o=n.updateScore(o,t),o})()}updatePart(e,t){var n=this;return M(function*(){const i=yield n.preparePartUpdate(e,t);yield n.update(e,i)})()}drawPart(e,t,n){var i=this;return M(function*(){let s=yield i.preparePartUpdate(e,n);s={...s,result:L1.HARD_DRAW.value},yield i.update(e,s),yield i.gameEventService.addAction(e,t,"EndGame")})()}endPartWithVictory(e,t,n,i,s){var o=this;return M(function*(){let a=yield o.preparePartUpdate(e,s);a={...a,winner:n,loser:i,result:L1.VICTORY.value},yield o.update(e,a),yield o.gameEventService.addAction(e,t,"EndGame")})()}addMove(e,t,n){var i=this;return M(function*(){yield i.gameEventService.addMove(e,t,n)})()}updateScore(e,t){return t.isPresent()?{...e,scorePlayerZero:t.get()[0],scorePlayerOne:t.get()[1]}:e}},u(y0,"\u0275fac",function(e){return new(e||y0)(Pe(od),Pe(Wk),Pe(lr),Pe(ad),Pe(Z5))}),u(y0,"\u0275prov",He({token:y0,factory:y0.\u0275fac,providedIn:"root"})),y0);X5=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ne.log],X5);var Pee={prefix:"fab",iconName:"facebook",icon:[512,512,[62e3],"f09a","M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"]},Nee={prefix:"fab",iconName:"github",icon:[496,512,[],"f09b","M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"]},Iee={prefix:"fab",iconName:"twitter",icon:[512,512,[],"f099","M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"]};class cd{static getNavigatorLanguage(){return navigator.language}static getLocale(){const n=(localStorage.getItem("locale")??cd.getNavigatorLanguage()??"fr").slice(0,2).toLowerCase();return["en","fr"].some(i=>i===n)?n:"fr"}}let zee=(()=>{var r;class e{changeTheme(n){localStorage.setItem("theme",n)}getTheme(){return g.ofNullable(localStorage.getItem("theme"))}changeLanguage(n){localStorage.setItem("locale",n.toLowerCase())}getLanguage(){return cd.getLocale()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)}),u(e,"\u0275prov",He({token:r,factory:r.\u0275fac,providedIn:"root"})),e})(),gv=(()=>{var r;class e{constructor(n,i){u(this,"document",void 0),u(this,"userSettingsService",void 0),u(this,"theme",void 0),u(this,"availableThemes",["dark","light"]),this.document=n,this.userSettingsService=i;const s=this.getStoredTheme();s.isPresent()?this.loadTheme(s.get()):window.matchMedia("(prefers-color-scheme: dark)").matches?this.loadTheme("dark"):window.matchMedia("(prefers-color-scheme: light)").matches?this.loadTheme("light"):this.loadTheme("dark")}getStoredTheme(){const n=this.userSettingsService.getTheme();if(n.isPresent()){const i=n.get();if(this.availableThemes.some(s=>s===i))return g.of(i)}return g.empty()}loadTheme(n){this.loadStyle(n+".css"),this.theme=n}loadStyle(n){const i=this.document.getElementsByTagName("head")[0],s=this.document.getElementById("theme");if(null!=s)s.href=n;else{const o=this.document.createElement("link");o.id="theme",o.rel="stylesheet",o.href=`${n}`,i.appendChild(o)}}getTheme(){return this.theme}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(Pe(b2),Pe(zee))}),u(e,"\u0275prov",He({token:r,factory:r.\u0275fac,providedIn:"root"})),e})();function Dee(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function ct(r){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?Dee(Object(t),!0).forEach(function(n){h2(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):Dee(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function mv(r){return(mv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(r)}function Hee(r,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function h2(r,e,t){return e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function Yk(r,e){return function cUe(r){if(Array.isArray(r))return r}(r)||function uUe(r,e){var t=null==r?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var o,a,n=[],i=!0,s=!1;try{for(t=t.call(r);!(i=(o=t.next()).done)&&(n.push(o.value),!e||n.length!==e);i=!0);}catch(c){s=!0,a=c}finally{try{!i&&null!=t.return&&t.return()}finally{if(s)throw a}}return n}}(r,e)||Vee(r,e)||function dUe(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ud(r){return function aUe(r){if(Array.isArray(r))return Kk(r)}(r)||function lUe(r){if(typeof Symbol<"u"&&null!=r[Symbol.iterator]||null!=r["@@iterator"])return Array.from(r)}(r)||Vee(r)||function fUe(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Vee(r,e){if(r){if("string"==typeof r)return Kk(r,e);var t=Object.prototype.toString.call(r).slice(8,-1);if("Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t)return Array.from(r);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Kk(r,e)}}function Kk(r,e){(null==e||e>r.length)&&(e=r.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=r[t];return n}var Fee=function(){},Xk={},$ee={},Gee=null,Bee={mark:Fee,measure:Fee};try{typeof window<"u"&&(Xk=window),typeof document<"u"&&($ee=document),typeof MutationObserver<"u"&&(Gee=MutationObserver),typeof performance<"u"&&(Bee=performance)}catch{}var Cv,yv,Mv,Ev,Sv,Uee=(Xk.navigator||{}).userAgent,Wee=void 0===Uee?"":Uee,_l=Xk,B1=$ee,qee=Gee,vv=Bee,J3=!!B1.documentElement&&!!B1.head&&"function"==typeof B1.addEventListener&&"function"==typeof B1.createElement,jee=~Wee.indexOf("MSIE")||~Wee.indexOf("Trident/"),e4="___FONT_AWESOME___",Zee="fa",Yee="svg-inline--fa",M0="data-fa-i2svg",Jk="data-fa-pseudo-element",pUe="data-fa-pseudo-element-pending",ex="data-prefix",tx="data-icon",Kee="fontawesome-i2svg",gUe="async",mUe=["HTML","HEAD","STYLE","SCRIPT"],Xee=function(){try{return!0}catch{return!1}}(),U1="classic",Or="sharp",nx=[U1,Or];function fd(r){return new Proxy(r,{get:function(t,n){return n in t?t[n]:t[U1]}})}var dd=fd((h2(Cv={},U1,{fa:"solid",fas:"solid","fa-solid":"solid",far:"regular","fa-regular":"regular",fal:"light","fa-light":"light",fat:"thin","fa-thin":"thin",fad:"duotone","fa-duotone":"duotone",fab:"brands","fa-brands":"brands",fak:"kit","fa-kit":"kit"}),h2(Cv,Or,{fa:"solid",fass:"solid","fa-solid":"solid",fasr:"regular","fa-regular":"regular",fasl:"light","fa-light":"light"}),Cv)),hd=fd((h2(yv={},U1,{solid:"fas",regular:"far",light:"fal",thin:"fat",duotone:"fad",brands:"fab",kit:"fak"}),h2(yv,Or,{solid:"fass",regular:"fasr",light:"fasl"}),yv)),pd=fd((h2(Mv={},U1,{fab:"fa-brands",fad:"fa-duotone",fak:"fa-kit",fal:"fa-light",far:"fa-regular",fas:"fa-solid",fat:"fa-thin"}),h2(Mv,Or,{fass:"fa-solid",fasr:"fa-regular",fasl:"fa-light"}),Mv)),_Ue=fd((h2(Ev={},U1,{"fa-brands":"fab","fa-duotone":"fad","fa-kit":"fak","fa-light":"fal","fa-regular":"far","fa-solid":"fas","fa-thin":"fat"}),h2(Ev,Or,{"fa-solid":"fass","fa-regular":"fasr","fa-light":"fasl"}),Ev)),vUe=/fa(s|r|l|t|d|b|k|ss|sr|sl)?[\-\ ]/,Qee="fa-layers-text",CUe=/Font ?Awesome ?([56 ]*)(Solid|Regular|Light|Thin|Duotone|Brands|Free|Pro|Sharp|Kit)?.*/i,yUe=fd((h2(Sv={},U1,{900:"fas",400:"far",normal:"far",300:"fal",100:"fat"}),h2(Sv,Or,{900:"fass",400:"fasr",300:"fasl"}),Sv)),Jee=[1,2,3,4,5,6,7,8,9,10],MUe=Jee.concat([11,12,13,14,15,16,17,18,19,20]),EUe=["class","data-prefix","data-icon","data-fa-transform","data-fa-mask"],E0={GROUP:"duotone-group",SWAP_OPACITY:"swap-opacity",PRIMARY:"primary",SECONDARY:"secondary"},gd=new Set;Object.keys(hd[U1]).map(gd.add.bind(gd)),Object.keys(hd[Or]).map(gd.add.bind(gd));var SUe=[].concat(nx,ud(gd),["2xs","xs","sm","lg","xl","2xl","beat","border","fade","beat-fade","bounce","flip-both","flip-horizontal","flip-vertical","flip","fw","inverse","layers-counter","layers-text","layers","li","pull-left","pull-right","pulse","rotate-180","rotate-270","rotate-90","rotate-by","shake","spin-pulse","spin-reverse","spin","stack-1x","stack-2x","stack","ul",E0.GROUP,E0.SWAP_OPACITY,E0.PRIMARY,E0.SECONDARY]).concat(Jee.map(function(r){return"".concat(r,"x")})).concat(MUe.map(function(r){return"w-".concat(r)})),md=_l.FontAwesomeConfig||{};B1&&"function"==typeof B1.querySelector&&[["data-family-prefix","familyPrefix"],["data-css-prefix","cssPrefix"],["data-family-default","familyDefault"],["data-style-default","styleDefault"],["data-replacement-class","replacementClass"],["data-auto-replace-svg","autoReplaceSvg"],["data-auto-add-css","autoAddCss"],["data-auto-a11y","autoA11y"],["data-search-pseudo-elements","searchPseudoElements"],["data-observe-mutations","observeMutations"],["data-mutate-approach","mutateApproach"],["data-keep-original-source","keepOriginalSource"],["data-measure-performance","measurePerformance"],["data-show-missing-icons","showMissingIcons"]].forEach(function(r){var e=Yk(r,2),n=e[1],i=function TUe(r){return""===r||"false"!==r&&("true"===r||r)}(function PUe(r){var e=B1.querySelector("script["+r+"]");if(e)return e.getAttribute(r)}(e[0]));null!=i&&(md[n]=i)});var ete={styleDefault:"solid",familyDefault:"classic",cssPrefix:Zee,replacementClass:Yee,autoReplaceSvg:!0,autoAddCss:!0,autoA11y:!0,searchPseudoElements:!1,observeMutations:!0,mutateApproach:"async",keepOriginalSource:!0,measurePerformance:!1,showMissingIcons:!0};md.familyPrefix&&(md.cssPrefix=md.familyPrefix);var Q5=ct(ct({},ete),md);Q5.autoReplaceSvg||(Q5.observeMutations=!1);var _t={};Object.keys(ete).forEach(function(r){Object.defineProperty(_t,r,{enumerable:!0,set:function(t){Q5[r]=t,_d.forEach(function(n){return n(_t)})},get:function(){return Q5[r]}})}),Object.defineProperty(_t,"familyPrefix",{enumerable:!0,set:function(e){Q5.cssPrefix=e,_d.forEach(function(t){return t(_t)})},get:function(){return Q5.cssPrefix}}),_l.FontAwesomeConfig=_t;var _d=[],zc={size:16,x:0,y:0,rotate:0,flipX:!1,flipY:!1},AUe="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";function vd(){for(var r=12,e="";r-- >0;)e+=AUe[62*Math.random()|0];return e}function J5(r){for(var e=[],t=(r||[]).length>>>0;t--;)e[t]=r[t];return e}function rx(r){return r.classList?J5(r.classList):(r.getAttribute("class")||"").split(" ").filter(function(e){return e})}function tte(r){return"".concat(r).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function Pv(r){return Object.keys(r||{}).reduce(function(e,t){return e+"".concat(t,": ").concat(r[t].trim(),";")},"")}function ix(r){return r.size!==zc.size||r.x!==zc.x||r.y!==zc.y||r.rotate!==zc.rotate||r.flipX||r.flipY}var xUe=':root, :host {\n  --fa-font-solid: normal 900 1em/1 "Font Awesome 6 Solid";\n  --fa-font-regular: normal 400 1em/1 "Font Awesome 6 Regular";\n  --fa-font-light: normal 300 1em/1 "Font Awesome 6 Light";\n  --fa-font-thin: normal 100 1em/1 "Font Awesome 6 Thin";\n  --fa-font-duotone: normal 900 1em/1 "Font Awesome 6 Duotone";\n  --fa-font-sharp-solid: normal 900 1em/1 "Font Awesome 6 Sharp";\n  --fa-font-sharp-regular: normal 400 1em/1 "Font Awesome 6 Sharp";\n  --fa-font-sharp-light: normal 300 1em/1 "Font Awesome 6 Sharp";\n  --fa-font-brands: normal 400 1em/1 "Font Awesome 6 Brands";\n}\n\nsvg:not(:root).svg-inline--fa, svg:not(:host).svg-inline--fa {\n  overflow: visible;\n  box-sizing: content-box;\n}\n\n.svg-inline--fa {\n  display: var(--fa-display, inline-block);\n  height: 1em;\n  overflow: visible;\n  vertical-align: -0.125em;\n}\n.svg-inline--fa.fa-2xs {\n  vertical-align: 0.1em;\n}\n.svg-inline--fa.fa-xs {\n  vertical-align: 0em;\n}\n.svg-inline--fa.fa-sm {\n  vertical-align: -0.0714285705em;\n}\n.svg-inline--fa.fa-lg {\n  vertical-align: -0.2em;\n}\n.svg-inline--fa.fa-xl {\n  vertical-align: -0.25em;\n}\n.svg-inline--fa.fa-2xl {\n  vertical-align: -0.3125em;\n}\n.svg-inline--fa.fa-pull-left {\n  margin-right: var(--fa-pull-margin, 0.3em);\n  width: auto;\n}\n.svg-inline--fa.fa-pull-right {\n  margin-left: var(--fa-pull-margin, 0.3em);\n  width: auto;\n}\n.svg-inline--fa.fa-li {\n  width: var(--fa-li-width, 2em);\n  top: 0.25em;\n}\n.svg-inline--fa.fa-fw {\n  width: var(--fa-fw-width, 1.25em);\n}\n\n.fa-layers svg.svg-inline--fa {\n  bottom: 0;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n}\n\n.fa-layers-counter, .fa-layers-text {\n  display: inline-block;\n  position: absolute;\n  text-align: center;\n}\n\n.fa-layers {\n  display: inline-block;\n  height: 1em;\n  position: relative;\n  text-align: center;\n  vertical-align: -0.125em;\n  width: 1em;\n}\n.fa-layers svg.svg-inline--fa {\n  -webkit-transform-origin: center center;\n          transform-origin: center center;\n}\n\n.fa-layers-text {\n  left: 50%;\n  top: 50%;\n  -webkit-transform: translate(-50%, -50%);\n          transform: translate(-50%, -50%);\n  -webkit-transform-origin: center center;\n          transform-origin: center center;\n}\n\n.fa-layers-counter {\n  background-color: var(--fa-counter-background-color, #ff253a);\n  border-radius: var(--fa-counter-border-radius, 1em);\n  box-sizing: border-box;\n  color: var(--fa-inverse, #fff);\n  line-height: var(--fa-counter-line-height, 1);\n  max-width: var(--fa-counter-max-width, 5em);\n  min-width: var(--fa-counter-min-width, 1.5em);\n  overflow: hidden;\n  padding: var(--fa-counter-padding, 0.25em 0.5em);\n  right: var(--fa-right, 0);\n  text-overflow: ellipsis;\n  top: var(--fa-top, 0);\n  -webkit-transform: scale(var(--fa-counter-scale, 0.25));\n          transform: scale(var(--fa-counter-scale, 0.25));\n  -webkit-transform-origin: top right;\n          transform-origin: top right;\n}\n\n.fa-layers-bottom-right {\n  bottom: var(--fa-bottom, 0);\n  right: var(--fa-right, 0);\n  top: auto;\n  -webkit-transform: scale(var(--fa-layers-scale, 0.25));\n          transform: scale(var(--fa-layers-scale, 0.25));\n  -webkit-transform-origin: bottom right;\n          transform-origin: bottom right;\n}\n\n.fa-layers-bottom-left {\n  bottom: var(--fa-bottom, 0);\n  left: var(--fa-left, 0);\n  right: auto;\n  top: auto;\n  -webkit-transform: scale(var(--fa-layers-scale, 0.25));\n          transform: scale(var(--fa-layers-scale, 0.25));\n  -webkit-transform-origin: bottom left;\n          transform-origin: bottom left;\n}\n\n.fa-layers-top-right {\n  top: var(--fa-top, 0);\n  right: var(--fa-right, 0);\n  -webkit-transform: scale(var(--fa-layers-scale, 0.25));\n          transform: scale(var(--fa-layers-scale, 0.25));\n  -webkit-transform-origin: top right;\n          transform-origin: top right;\n}\n\n.fa-layers-top-left {\n  left: var(--fa-left, 0);\n  right: auto;\n  top: var(--fa-top, 0);\n  -webkit-transform: scale(var(--fa-layers-scale, 0.25));\n          transform: scale(var(--fa-layers-scale, 0.25));\n  -webkit-transform-origin: top left;\n          transform-origin: top left;\n}\n\n.fa-1x {\n  font-size: 1em;\n}\n\n.fa-2x {\n  font-size: 2em;\n}\n\n.fa-3x {\n  font-size: 3em;\n}\n\n.fa-4x {\n  font-size: 4em;\n}\n\n.fa-5x {\n  font-size: 5em;\n}\n\n.fa-6x {\n  font-size: 6em;\n}\n\n.fa-7x {\n  font-size: 7em;\n}\n\n.fa-8x {\n  font-size: 8em;\n}\n\n.fa-9x {\n  font-size: 9em;\n}\n\n.fa-10x {\n  font-size: 10em;\n}\n\n.fa-2xs {\n  font-size: 0.625em;\n  line-height: 0.1em;\n  vertical-align: 0.225em;\n}\n\n.fa-xs {\n  font-size: 0.75em;\n  line-height: 0.0833333337em;\n  vertical-align: 0.125em;\n}\n\n.fa-sm {\n  font-size: 0.875em;\n  line-height: 0.0714285718em;\n  vertical-align: 0.0535714295em;\n}\n\n.fa-lg {\n  font-size: 1.25em;\n  line-height: 0.05em;\n  vertical-align: -0.075em;\n}\n\n.fa-xl {\n  font-size: 1.5em;\n  line-height: 0.0416666682em;\n  vertical-align: -0.125em;\n}\n\n.fa-2xl {\n  font-size: 2em;\n  line-height: 0.03125em;\n  vertical-align: -0.1875em;\n}\n\n.fa-fw {\n  text-align: center;\n  width: 1.25em;\n}\n\n.fa-ul {\n  list-style-type: none;\n  margin-left: var(--fa-li-margin, 2.5em);\n  padding-left: 0;\n}\n.fa-ul > li {\n  position: relative;\n}\n\n.fa-li {\n  left: calc(var(--fa-li-width, 2em) * -1);\n  position: absolute;\n  text-align: center;\n  width: var(--fa-li-width, 2em);\n  line-height: inherit;\n}\n\n.fa-border {\n  border-color: var(--fa-border-color, #eee);\n  border-radius: var(--fa-border-radius, 0.1em);\n  border-style: var(--fa-border-style, solid);\n  border-width: var(--fa-border-width, 0.08em);\n  padding: var(--fa-border-padding, 0.2em 0.25em 0.15em);\n}\n\n.fa-pull-left {\n  float: left;\n  margin-right: var(--fa-pull-margin, 0.3em);\n}\n\n.fa-pull-right {\n  float: right;\n  margin-left: var(--fa-pull-margin, 0.3em);\n}\n\n.fa-beat {\n  -webkit-animation-name: fa-beat;\n          animation-name: fa-beat;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, ease-in-out);\n          animation-timing-function: var(--fa-animation-timing, ease-in-out);\n}\n\n.fa-bounce {\n  -webkit-animation-name: fa-bounce;\n          animation-name: fa-bounce;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.28, 0.84, 0.42, 1));\n          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.28, 0.84, 0.42, 1));\n}\n\n.fa-fade {\n  -webkit-animation-name: fa-fade;\n          animation-name: fa-fade;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));\n          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));\n}\n\n.fa-beat-fade {\n  -webkit-animation-name: fa-beat-fade;\n          animation-name: fa-beat-fade;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));\n          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));\n}\n\n.fa-flip {\n  -webkit-animation-name: fa-flip;\n          animation-name: fa-flip;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, ease-in-out);\n          animation-timing-function: var(--fa-animation-timing, ease-in-out);\n}\n\n.fa-shake {\n  -webkit-animation-name: fa-shake;\n          animation-name: fa-shake;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, linear);\n          animation-timing-function: var(--fa-animation-timing, linear);\n}\n\n.fa-spin {\n  -webkit-animation-name: fa-spin;\n          animation-name: fa-spin;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 2s);\n          animation-duration: var(--fa-animation-duration, 2s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, linear);\n          animation-timing-function: var(--fa-animation-timing, linear);\n}\n\n.fa-spin-reverse {\n  --fa-animation-direction: reverse;\n}\n\n.fa-pulse,\n.fa-spin-pulse {\n  -webkit-animation-name: fa-spin;\n          animation-name: fa-spin;\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, steps(8));\n          animation-timing-function: var(--fa-animation-timing, steps(8));\n}\n\n@media (prefers-reduced-motion: reduce) {\n  .fa-beat,\n.fa-bounce,\n.fa-fade,\n.fa-beat-fade,\n.fa-flip,\n.fa-pulse,\n.fa-shake,\n.fa-spin,\n.fa-spin-pulse {\n    -webkit-animation-delay: -1ms;\n            animation-delay: -1ms;\n    -webkit-animation-duration: 1ms;\n            animation-duration: 1ms;\n    -webkit-animation-iteration-count: 1;\n            animation-iteration-count: 1;\n    -webkit-transition-delay: 0s;\n            transition-delay: 0s;\n    -webkit-transition-duration: 0s;\n            transition-duration: 0s;\n  }\n}\n@-webkit-keyframes fa-beat {\n  0%, 90% {\n    -webkit-transform: scale(1);\n            transform: scale(1);\n  }\n  45% {\n    -webkit-transform: scale(var(--fa-beat-scale, 1.25));\n            transform: scale(var(--fa-beat-scale, 1.25));\n  }\n}\n@keyframes fa-beat {\n  0%, 90% {\n    -webkit-transform: scale(1);\n            transform: scale(1);\n  }\n  45% {\n    -webkit-transform: scale(var(--fa-beat-scale, 1.25));\n            transform: scale(var(--fa-beat-scale, 1.25));\n  }\n}\n@-webkit-keyframes fa-bounce {\n  0% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n  10% {\n    -webkit-transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);\n            transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);\n  }\n  30% {\n    -webkit-transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));\n            transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));\n  }\n  50% {\n    -webkit-transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);\n            transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);\n  }\n  57% {\n    -webkit-transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));\n            transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));\n  }\n  64% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n  100% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n}\n@keyframes fa-bounce {\n  0% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n  10% {\n    -webkit-transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);\n            transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);\n  }\n  30% {\n    -webkit-transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));\n            transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));\n  }\n  50% {\n    -webkit-transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);\n            transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);\n  }\n  57% {\n    -webkit-transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));\n            transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));\n  }\n  64% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n  100% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n}\n@-webkit-keyframes fa-fade {\n  50% {\n    opacity: var(--fa-fade-opacity, 0.4);\n  }\n}\n@keyframes fa-fade {\n  50% {\n    opacity: var(--fa-fade-opacity, 0.4);\n  }\n}\n@-webkit-keyframes fa-beat-fade {\n  0%, 100% {\n    opacity: var(--fa-beat-fade-opacity, 0.4);\n    -webkit-transform: scale(1);\n            transform: scale(1);\n  }\n  50% {\n    opacity: 1;\n    -webkit-transform: scale(var(--fa-beat-fade-scale, 1.125));\n            transform: scale(var(--fa-beat-fade-scale, 1.125));\n  }\n}\n@keyframes fa-beat-fade {\n  0%, 100% {\n    opacity: var(--fa-beat-fade-opacity, 0.4);\n    -webkit-transform: scale(1);\n            transform: scale(1);\n  }\n  50% {\n    opacity: 1;\n    -webkit-transform: scale(var(--fa-beat-fade-scale, 1.125));\n            transform: scale(var(--fa-beat-fade-scale, 1.125));\n  }\n}\n@-webkit-keyframes fa-flip {\n  50% {\n    -webkit-transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));\n            transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));\n  }\n}\n@keyframes fa-flip {\n  50% {\n    -webkit-transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));\n            transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));\n  }\n}\n@-webkit-keyframes fa-shake {\n  0% {\n    -webkit-transform: rotate(-15deg);\n            transform: rotate(-15deg);\n  }\n  4% {\n    -webkit-transform: rotate(15deg);\n            transform: rotate(15deg);\n  }\n  8%, 24% {\n    -webkit-transform: rotate(-18deg);\n            transform: rotate(-18deg);\n  }\n  12%, 28% {\n    -webkit-transform: rotate(18deg);\n            transform: rotate(18deg);\n  }\n  16% {\n    -webkit-transform: rotate(-22deg);\n            transform: rotate(-22deg);\n  }\n  20% {\n    -webkit-transform: rotate(22deg);\n            transform: rotate(22deg);\n  }\n  32% {\n    -webkit-transform: rotate(-12deg);\n            transform: rotate(-12deg);\n  }\n  36% {\n    -webkit-transform: rotate(12deg);\n            transform: rotate(12deg);\n  }\n  40%, 100% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n}\n@keyframes fa-shake {\n  0% {\n    -webkit-transform: rotate(-15deg);\n            transform: rotate(-15deg);\n  }\n  4% {\n    -webkit-transform: rotate(15deg);\n            transform: rotate(15deg);\n  }\n  8%, 24% {\n    -webkit-transform: rotate(-18deg);\n            transform: rotate(-18deg);\n  }\n  12%, 28% {\n    -webkit-transform: rotate(18deg);\n            transform: rotate(18deg);\n  }\n  16% {\n    -webkit-transform: rotate(-22deg);\n            transform: rotate(-22deg);\n  }\n  20% {\n    -webkit-transform: rotate(22deg);\n            transform: rotate(22deg);\n  }\n  32% {\n    -webkit-transform: rotate(-12deg);\n            transform: rotate(-12deg);\n  }\n  36% {\n    -webkit-transform: rotate(12deg);\n            transform: rotate(12deg);\n  }\n  40%, 100% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n}\n@-webkit-keyframes fa-spin {\n  0% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n            transform: rotate(360deg);\n  }\n}\n@keyframes fa-spin {\n  0% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n            transform: rotate(360deg);\n  }\n}\n.fa-rotate-90 {\n  -webkit-transform: rotate(90deg);\n          transform: rotate(90deg);\n}\n\n.fa-rotate-180 {\n  -webkit-transform: rotate(180deg);\n          transform: rotate(180deg);\n}\n\n.fa-rotate-270 {\n  -webkit-transform: rotate(270deg);\n          transform: rotate(270deg);\n}\n\n.fa-flip-horizontal {\n  -webkit-transform: scale(-1, 1);\n          transform: scale(-1, 1);\n}\n\n.fa-flip-vertical {\n  -webkit-transform: scale(1, -1);\n          transform: scale(1, -1);\n}\n\n.fa-flip-both,\n.fa-flip-horizontal.fa-flip-vertical {\n  -webkit-transform: scale(-1, -1);\n          transform: scale(-1, -1);\n}\n\n.fa-rotate-by {\n  -webkit-transform: rotate(var(--fa-rotate-angle, none));\n          transform: rotate(var(--fa-rotate-angle, none));\n}\n\n.fa-stack {\n  display: inline-block;\n  vertical-align: middle;\n  height: 2em;\n  position: relative;\n  width: 2.5em;\n}\n\n.fa-stack-1x,\n.fa-stack-2x {\n  bottom: 0;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n  z-index: var(--fa-stack-z-index, auto);\n}\n\n.svg-inline--fa.fa-stack-1x {\n  height: 1em;\n  width: 1.25em;\n}\n.svg-inline--fa.fa-stack-2x {\n  height: 2em;\n  width: 2.5em;\n}\n\n.fa-inverse {\n  color: var(--fa-inverse, #fff);\n}\n\n.sr-only,\n.fa-sr-only {\n  position: absolute;\n  width: 1px;\n  height: 1px;\n  padding: 0;\n  margin: -1px;\n  overflow: hidden;\n  clip: rect(0, 0, 0, 0);\n  white-space: nowrap;\n  border-width: 0;\n}\n\n.sr-only-focusable:not(:focus),\n.fa-sr-only-focusable:not(:focus) {\n  position: absolute;\n  width: 1px;\n  height: 1px;\n  padding: 0;\n  margin: -1px;\n  overflow: hidden;\n  clip: rect(0, 0, 0, 0);\n  white-space: nowrap;\n  border-width: 0;\n}\n\n.svg-inline--fa .fa-primary {\n  fill: var(--fa-primary-color, currentColor);\n  opacity: var(--fa-primary-opacity, 1);\n}\n\n.svg-inline--fa .fa-secondary {\n  fill: var(--fa-secondary-color, currentColor);\n  opacity: var(--fa-secondary-opacity, 0.4);\n}\n\n.svg-inline--fa.fa-swap-opacity .fa-primary {\n  opacity: var(--fa-secondary-opacity, 0.4);\n}\n\n.svg-inline--fa.fa-swap-opacity .fa-secondary {\n  opacity: var(--fa-primary-opacity, 1);\n}\n\n.svg-inline--fa mask .fa-primary,\n.svg-inline--fa mask .fa-secondary {\n  fill: black;\n}\n\n.fad.fa-inverse,\n.fa-duotone.fa-inverse {\n  color: var(--fa-inverse, #fff);\n}';function nte(){var r=Zee,e=Yee,t=_t.cssPrefix,n=_t.replacementClass,i=xUe;if(t!==r||n!==e){var s=new RegExp("\\.".concat(r,"\\-"),"g"),o=new RegExp("\\--".concat(r,"\\-"),"g"),a=new RegExp("\\.".concat(e),"g");i=i.replace(s,".".concat(t,"-")).replace(o,"--".concat(t,"-")).replace(a,".".concat(n))}return i}var rte=!1;function sx(){_t.autoAddCss&&!rte&&(function wUe(r){if(r&&J3){var e=B1.createElement("style");e.setAttribute("type","text/css"),e.innerHTML=r;for(var t=B1.head.childNodes,n=null,i=t.length-1;i>-1;i--){var s=t[i],o=(s.tagName||"").toUpperCase();["STYLE","LINK"].indexOf(o)>-1&&(n=s)}B1.head.insertBefore(e,n)}}(nte()),rte=!0)}var LUe={mixout:function(){return{dom:{css:nte,insertCss:sx}}},hooks:function(){return{beforeDOMElementCreation:function(){sx()},beforeI2svg:function(){sx()}}}},t4=_l||{};t4[e4]||(t4[e4]={}),t4[e4].styles||(t4[e4].styles={}),t4[e4].hooks||(t4[e4].hooks={}),t4[e4].shims||(t4[e4].shims=[]);var ba=t4[e4],ite=[],Tv=!1;function Cd(r){var e=r.tag,t=r.attributes,n=void 0===t?{}:t,i=r.children,s=void 0===i?[]:i;return"string"==typeof r?tte(r):"<".concat(e," ").concat(function NUe(r){return Object.keys(r||{}).reduce(function(e,t){return e+"".concat(t,'="').concat(tte(r[t]),'" ')},"").trim()}(n),">").concat(s.map(Cd).join(""),"</").concat(e,">")}function ste(r,e,t){if(r&&r[e]&&r[e][t])return{prefix:e,iconName:t,icon:r[e][t]}}J3&&((Tv=(B1.documentElement.doScroll?/^loaded|^c/:/^loaded|^i|^c/).test(B1.readyState))||B1.addEventListener("DOMContentLoaded",function r(){B1.removeEventListener("DOMContentLoaded",r),Tv=1,ite.map(function(e){return e()})}));var ox=function(e,t,n,i){var c,l,f,s=Object.keys(e),o=s.length,a=void 0!==i?function(e,t){return function(n,i,s,o){return e.call(t,n,i,s,o)}}(t,i):t;for(void 0===n?(c=1,f=e[s[0]]):(c=0,f=n);c<o;c++)f=a(f,e[l=s[c]],l,e);return f};function ax(r){var e=function HUe(r){for(var e=[],t=0,n=r.length;t<n;){var i=r.charCodeAt(t++);if(i>=55296&&i<=56319&&t<n){var s=r.charCodeAt(t++);56320==(64512&s)?e.push(((1023&i)<<10)+(1023&s)+65536):(e.push(i),t--)}else e.push(i)}return e}(r);return 1===e.length?e[0].toString(16):null}function ote(r){return Object.keys(r).reduce(function(e,t){var n=r[t];return n.icon?e[n.iconName]=n.icon:e[t]=n,e},{})}function cx(r,e){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).skipHooks,i=void 0!==n&&n,s=ote(e);"function"!=typeof ba.hooks.addPack||i?ba.styles[r]=ct(ct({},ba.styles[r]||{}),s):ba.hooks.addPack(r,ote(e)),"fas"===r&&cx("fa",e)}var Ov,bv,wv,eu=ba.styles,FUe=ba.shims,$Ue=(h2(Ov={},U1,Object.values(pd[U1])),h2(Ov,Or,Object.values(pd[Or])),Ov),lx=null,ate={},cte={},lte={},ute={},fte={},GUe=(h2(bv={},U1,Object.keys(dd[U1])),h2(bv,Or,Object.keys(dd[Or])),bv);var dte=function(){var e=function(s){return ox(eu,function(o,a,c){return o[c]=ox(a,s,{}),o},{})};ate=e(function(i,s,o){return s[3]&&(i[s[3]]=o),s[2]&&s[2].filter(function(c){return"number"==typeof c}).forEach(function(c){i[c.toString(16)]=o}),i}),cte=e(function(i,s,o){return i[o]=o,s[2]&&s[2].filter(function(c){return"string"==typeof c}).forEach(function(c){i[c]=o}),i}),fte=e(function(i,s,o){var a=s[2];return i[o]=o,a.forEach(function(c){i[c]=o}),i});var t="far"in eu||_t.autoFetchSvg,n=ox(FUe,function(i,s){var o=s[0],a=s[1],c=s[2];return"far"===a&&!t&&(a="fas"),"string"==typeof o&&(i.names[o]={prefix:a,iconName:c}),"number"==typeof o&&(i.unicodes[o.toString(16)]={prefix:a,iconName:c}),i},{names:{},unicodes:{}});lte=n.names,ute=n.unicodes,lx=Av(_t.styleDefault,{family:_t.familyDefault})};function ux(r,e){return(ate[r]||{})[e]}function S0(r,e){return(fte[r]||{})[e]}function hte(r){return lte[r]||{prefix:null,iconName:null}}function Cl(){return lx}(function bUe(r){_d.push(r)})(function(r){lx=Av(r.styleDefault,{family:_t.familyDefault})}),dte();var fx=function(){return{prefix:null,iconName:null,rest:[]}};function Av(r){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).family,n=void 0===t?U1:t;return hd[n][r]||hd[n][dd[n][r]]||(r in ba.styles?r:null)||null}var pte=(h2(wv={},U1,Object.keys(pd[U1])),h2(wv,Or,Object.keys(pd[Or])),wv);function Nv(r){var e,n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).skipLookups,i=void 0!==n&&n,s=(h2(e={},U1,"".concat(_t.cssPrefix,"-").concat(U1)),h2(e,Or,"".concat(_t.cssPrefix,"-").concat(Or)),e),o=null,a=U1;(r.includes(s[U1])||r.some(function(l){return pte[U1].includes(l)}))&&(a=U1),(r.includes(s[Or])||r.some(function(l){return pte[Or].includes(l)}))&&(a=Or);var c=r.reduce(function(l,f){var d=function UUe(r,e){var t=e.split("-"),n=t[0],i=t.slice(1).join("-");return n!==r||""===i||function BUe(r){return~SUe.indexOf(r)}(i)?null:i}(_t.cssPrefix,f);if(eu[f]?(f=$Ue[a].includes(f)?_Ue[a][f]:f,o=f,l.prefix=f):GUe[a].indexOf(f)>-1?(o=f,l.prefix=Av(f,{family:a})):d?l.iconName=d:f!==_t.replacementClass&&f!==s[U1]&&f!==s[Or]&&l.rest.push(f),!i&&l.prefix&&l.iconName){var m="fa"===o?hte(l.iconName):{},E=S0(l.prefix,l.iconName);m.prefix&&(o=null),l.iconName=m.iconName||E||l.iconName,l.prefix=m.prefix||l.prefix,"far"===l.prefix&&!eu.far&&eu.fas&&!_t.autoFetchSvg&&(l.prefix="fas")}return l},fx());return(r.includes("fa-brands")||r.includes("fab"))&&(c.prefix="fab"),(r.includes("fa-duotone")||r.includes("fad"))&&(c.prefix="fad"),!c.prefix&&a===Or&&(eu.fass||_t.autoFetchSvg)&&(c.prefix="fass",c.iconName=S0(c.prefix,c.iconName)||c.iconName),("fa"===c.prefix||"fa"===o)&&(c.prefix=Cl()||"fas"),c}var jUe=function(){function r(){(function iUe(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")})(this,r),this.definitions={}}return function sUe(r,e,t){e&&Hee(r.prototype,e),t&&Hee(r,t),Object.defineProperty(r,"prototype",{writable:!1})}(r,[{key:"add",value:function(){for(var t=this,n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];var o=i.reduce(this._pullDefinitions,{});Object.keys(o).forEach(function(a){t.definitions[a]=ct(ct({},t.definitions[a]||{}),o[a]),cx(a,o[a]);var c=pd[U1][a];c&&cx(c,o[a]),dte()})}},{key:"reset",value:function(){this.definitions={}}},{key:"_pullDefinitions",value:function(t,n){var i=n.prefix&&n.iconName&&n.icon?{0:n}:n;return Object.keys(i).map(function(s){var o=i[s],a=o.prefix,c=o.iconName,l=o.icon,f=l[2];t[a]||(t[a]={}),f.length>0&&f.forEach(function(d){"string"==typeof d&&(t[a][d]=l)}),t[a][c]=l}),t}}]),r}(),gte=[],tu={},nu={},ZUe=Object.keys(nu);function dx(r,e){for(var t=arguments.length,n=new Array(t>2?t-2:0),i=2;i<t;i++)n[i-2]=arguments[i];return(tu[r]||[]).forEach(function(o){e=o.apply(null,[e].concat(n))}),e}function P0(r){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];(tu[r]||[]).forEach(function(s){s.apply(null,t)})}function n4(){var r=arguments[0],e=Array.prototype.slice.call(arguments,1);return nu[r]?nu[r].apply(null,e):void 0}function hx(r){"fa"===r.prefix&&(r.prefix="fas");var e=r.iconName,t=r.prefix||Cl();if(e)return e=S0(t,e)||e,ste(mte.definitions,t,e)||ste(ba.styles,t,e)}var mte=new jUe,XUe={i2svg:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return J3?(P0("beforeI2svg",e),n4("pseudoElements2svg",e),n4("i2svg",e)):Promise.reject("Operation requires a DOM of some kind.")},watch:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.autoReplaceSvgRoot;!1===_t.autoReplaceSvg&&(_t.autoReplaceSvg=!0),_t.observeMutations=!0,function zUe(r){J3&&(Tv?setTimeout(r,0):ite.push(r))}(function(){JUe({autoReplaceSvgRoot:t}),P0("watch",e)})}},ho={noAuto:function(){_t.autoReplaceSvg=!1,_t.observeMutations=!1,P0("noAuto")},config:_t,dom:XUe,parse:{icon:function(e){if(null===e)return null;if("object"===mv(e)&&e.prefix&&e.iconName)return{prefix:e.prefix,iconName:S0(e.prefix,e.iconName)||e.iconName};if(Array.isArray(e)&&2===e.length){var t=0===e[1].indexOf("fa-")?e[1].slice(3):e[1],n=Av(e[0]);return{prefix:n,iconName:S0(n,t)||t}}if("string"==typeof e&&(e.indexOf("".concat(_t.cssPrefix,"-"))>-1||e.match(vUe))){var i=Nv(e.split(" "),{skipLookups:!0});return{prefix:i.prefix||Cl(),iconName:S0(i.prefix,i.iconName)||i.iconName}}if("string"==typeof e){var s=Cl();return{prefix:s,iconName:S0(s,e)||e}}}},library:mte,findIconDefinition:hx,toHtml:Cd},JUe=function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).autoReplaceSvgRoot,n=void 0===t?B1:t;(Object.keys(ba.styles).length>0||_t.autoFetchSvg)&&J3&&_t.autoReplaceSvg&&ho.dom.i2svg({node:n})};function Iv(r,e){return Object.defineProperty(r,"abstract",{get:e}),Object.defineProperty(r,"html",{get:function(){return r.abstract.map(function(n){return Cd(n)})}}),Object.defineProperty(r,"node",{get:function(){if(J3){var n=B1.createElement("div");return n.innerHTML=r.html,n.children}}}),r}function px(r){var e=r.icons,t=e.main,n=e.mask,i=r.prefix,s=r.iconName,o=r.transform,a=r.symbol,c=r.title,l=r.maskId,f=r.titleId,d=r.extra,m=r.watchable,E=void 0!==m&&m,w=n.found?n:t,R=w.width,z=w.height,$="fak"===i,G=[_t.replacementClass,s?"".concat(_t.cssPrefix,"-").concat(s):""].filter(function(Et){return-1===d.classes.indexOf(Et)}).filter(function(Et){return""!==Et||!!Et}).concat(d.classes).join(" "),de={children:[],attributes:ct(ct({},d.attributes),{},{"data-prefix":i,"data-icon":s,class:G,role:d.attributes.role||"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 ".concat(R," ").concat(z)})},ve=$&&!~d.classes.indexOf("fa-fw")?{width:"".concat(R/z*16*.0625,"em")}:{};E&&(de.attributes[M0]=""),c&&(de.children.push({tag:"title",attributes:{id:de.attributes["aria-labelledby"]||"title-".concat(f||vd())},children:[c]}),delete de.attributes.title);var Le=ct(ct({},de),{},{prefix:i,iconName:s,main:t,mask:n,maskId:l,transform:o,symbol:a,styles:ct(ct({},ve),d.styles)}),nt=n.found&&t.found?n4("generateAbstractMask",Le)||{children:[],attributes:{}}:n4("generateAbstractIcon",Le)||{children:[],attributes:{}},vn=nt.attributes;return Le.children=nt.children,Le.attributes=vn,a?function tWe(r){var t=r.iconName,n=r.children,i=r.attributes,s=r.symbol,o=!0===s?"".concat(r.prefix,"-").concat(_t.cssPrefix,"-").concat(t):s;return[{tag:"svg",attributes:{style:"display: none;"},children:[{tag:"symbol",attributes:ct(ct({},i),{},{id:o}),children:n}]}]}(Le):function eWe(r){var e=r.children,t=r.main,n=r.mask,i=r.attributes,s=r.styles,o=r.transform;if(ix(o)&&t.found&&!n.found){var l={x:t.width/t.height/2,y:.5};i.style=Pv(ct(ct({},s),{},{"transform-origin":"".concat(l.x+o.x/16,"em ").concat(l.y+o.y/16,"em")}))}return[{tag:"svg",attributes:i,children:e}]}(Le)}function _te(r){var e=r.content,t=r.width,n=r.height,i=r.transform,s=r.title,o=r.extra,a=r.watchable,c=void 0!==a&&a,l=ct(ct(ct({},o.attributes),s?{title:s}:{}),{},{class:o.classes.join(" ")});c&&(l[M0]="");var f=ct({},o.styles);ix(i)&&(f.transform=function kUe(r){var e=r.transform,t=r.width,i=r.height,s=void 0===i?16:i,o=r.startCentered,a=void 0!==o&&o,c="";return c+=a&&jee?"translate(".concat(e.x/16-(void 0===t?16:t)/2,"em, ").concat(e.y/16-s/2,"em) "):a?"translate(calc(-50% + ".concat(e.x/16,"em), calc(-50% + ").concat(e.y/16,"em)) "):"translate(".concat(e.x/16,"em, ").concat(e.y/16,"em) "),(c+="scale(".concat(e.size/16*(e.flipX?-1:1),", ").concat(e.size/16*(e.flipY?-1:1),") "))+"rotate(".concat(e.rotate,"deg) ")}({transform:i,startCentered:!0,width:t,height:n}),f["-webkit-transform"]=f.transform);var d=Pv(f);d.length>0&&(l.style=d);var m=[];return m.push({tag:"span",attributes:l,children:[e]}),s&&m.push({tag:"span",attributes:{class:"sr-only"},children:[s]}),m}var gx=ba.styles;function mx(r){var e=r[0],t=r[1],s=Yk(r.slice(4),1)[0];return{found:!0,width:e,height:t,icon:Array.isArray(s)?{tag:"g",attributes:{class:"".concat(_t.cssPrefix,"-").concat(E0.GROUP)},children:[{tag:"path",attributes:{class:"".concat(_t.cssPrefix,"-").concat(E0.SECONDARY),fill:"currentColor",d:s[0]}},{tag:"path",attributes:{class:"".concat(_t.cssPrefix,"-").concat(E0.PRIMARY),fill:"currentColor",d:s[1]}}]}:{tag:"path",attributes:{fill:"currentColor",d:s}}}}var rWe={found:!1,width:512,height:512};function _x(r,e){var t=e;return"fa"===e&&null!==_t.styleDefault&&(e=Cl()),new Promise(function(n,i){if(n4("missingIconAbstract"),"fa"===t){var o=hte(r)||{};r=o.iconName||r,e=o.prefix||e}if(r&&e&&gx[e]&&gx[e][r])return n(mx(gx[e][r]));(function iWe(r,e){!Xee&&!_t.showMissingIcons&&r&&console.error('Icon with name "'.concat(r,'" and prefix "').concat(e,'" is missing.'))})(r,e),n(ct(ct({},rWe),{},{icon:_t.showMissingIcons&&r&&n4("missingIconAbstract")||{}}))})}var vte=function(){},vx=_t.measurePerformance&&vv&&vv.mark&&vv.measure?vv:{mark:vte,measure:vte},yd='FA "6.4.2"',Cte=function(e){vx.mark("".concat(yd," ").concat(e," ends")),vx.measure("".concat(yd," ").concat(e),"".concat(yd," ").concat(e," begins"),"".concat(yd," ").concat(e," ends"))},Cx={begin:function(e){return vx.mark("".concat(yd," ").concat(e," begins")),function(){return Cte(e)}},end:Cte},kv=function(){};function yte(r){return"string"==typeof(r.getAttribute?r.getAttribute(M0):null)}function lWe(r){return B1.createElementNS("http://www.w3.org/2000/svg",r)}function uWe(r){return B1.createElement(r)}function Mte(r){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).ceFn,n=void 0===t?"svg"===r.tag?lWe:uWe:t;if("string"==typeof r)return B1.createTextNode(r);var i=n(r.tag);return Object.keys(r.attributes||[]).forEach(function(o){i.setAttribute(o,r.attributes[o])}),(r.children||[]).forEach(function(o){i.appendChild(Mte(o,{ceFn:n}))}),i}var xv={replace:function(e){var t=e[0];if(t.parentNode)if(e[1].forEach(function(i){t.parentNode.insertBefore(Mte(i),t)}),null===t.getAttribute(M0)&&_t.keepOriginalSource){var n=B1.createComment(function fWe(r){var e=" ".concat(r.outerHTML," ");return"".concat(e,"Font Awesome fontawesome.com ")}(t));t.parentNode.replaceChild(n,t)}else t.remove()},nest:function(e){var t=e[0],n=e[1];if(~rx(t).indexOf(_t.replacementClass))return xv.replace(e);var i=new RegExp("".concat(_t.cssPrefix,"-.*"));if(delete n[0].attributes.id,n[0].attributes.class){var s=n[0].attributes.class.split(" ").reduce(function(a,c){return c===_t.replacementClass||c.match(i)?a.toSvg.push(c):a.toNode.push(c),a},{toNode:[],toSvg:[]});n[0].attributes.class=s.toSvg.join(" "),0===s.toNode.length?t.removeAttribute("class"):t.setAttribute("class",s.toNode.join(" "))}var o=n.map(function(a){return Cd(a)}).join("\n");t.setAttribute(M0,""),t.innerHTML=o}};function Ete(r){r()}function Ste(r,e){var t="function"==typeof e?e:kv;if(0===r.length)t();else{var n=Ete;_t.mutateApproach===gUe&&(n=_l.requestAnimationFrame||Ete),n(function(){var i=function cWe(){return!0===_t.autoReplaceSvg?xv.replace:xv[_t.autoReplaceSvg]||xv.replace}(),s=Cx.begin("mutate");r.map(i),s(),t()})}}var yx=!1;function Pte(){yx=!0}function Mx(){yx=!1}var Lv=null;function Tte(r){if(qee&&_t.observeMutations){var e=r.treeCallback,t=void 0===e?kv:e,n=r.nodeCallback,i=void 0===n?kv:n,s=r.pseudoElementsCallback,o=void 0===s?kv:s,a=r.observeMutationsRoot,c=void 0===a?B1:a;Lv=new qee(function(l){if(!yx){var f=Cl();J5(l).forEach(function(d){if("childList"===d.type&&d.addedNodes.length>0&&!yte(d.addedNodes[0])&&(_t.searchPseudoElements&&o(d.target),t(d.target)),"attributes"===d.type&&d.target.parentNode&&_t.searchPseudoElements&&o(d.target.parentNode),"attributes"===d.type&&yte(d.target)&&~EUe.indexOf(d.attributeName))if("class"===d.attributeName&&function oWe(r){var e=r.getAttribute?r.getAttribute(ex):null,t=r.getAttribute?r.getAttribute(tx):null;return e&&t}(d.target)){var m=Nv(rx(d.target)),w=m.iconName;d.target.setAttribute(ex,m.prefix||f),w&&d.target.setAttribute(tx,w)}else(function aWe(r){return r&&r.classList&&r.classList.contains&&r.classList.contains(_t.replacementClass)})(d.target)&&i(d.target)})}}),J3&&Lv.observe(c,{childList:!0,attributes:!0,characterData:!0,subtree:!0})}}function Ote(r){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{styleParser:!0},t=function pWe(r){var e=r.getAttribute("data-prefix"),t=r.getAttribute("data-icon"),n=void 0!==r.innerText?r.innerText.trim():"",i=Nv(rx(r));return i.prefix||(i.prefix=Cl()),e&&t&&(i.prefix=e,i.iconName=t),i.iconName&&i.prefix||(i.prefix&&n.length>0&&(i.iconName=function WUe(r,e){return(cte[r]||{})[e]}(i.prefix,r.innerText)||ux(i.prefix,ax(r.innerText))),!i.iconName&&_t.autoFetchSvg&&r.firstChild&&r.firstChild.nodeType===Node.TEXT_NODE&&(i.iconName=r.firstChild.data)),i}(r),n=t.iconName,i=t.prefix,s=t.rest,o=function gWe(r){var e=J5(r.attributes).reduce(function(i,s){return"class"!==i.name&&"style"!==i.name&&(i[s.name]=s.value),i},{}),t=r.getAttribute("title"),n=r.getAttribute("data-fa-title-id");return _t.autoA11y&&(t?e["aria-labelledby"]="".concat(_t.replacementClass,"-title-").concat(n||vd()):(e["aria-hidden"]="true",e.focusable="false")),e}(r),a=dx("parseNodeAttributes",{},r),c=e.styleParser?function hWe(r){var e=r.getAttribute("style"),t=[];return e&&(t=e.split(";").reduce(function(n,i){var s=i.split(":"),o=s[0],a=s.slice(1);return o&&a.length>0&&(n[o]=a.join(":").trim()),n},{})),t}(r):[];return ct({iconName:n,title:r.getAttribute("title"),titleId:r.getAttribute("data-fa-title-id"),prefix:i,transform:zc,mask:{iconName:null,prefix:null,rest:[]},maskId:null,symbol:!1,extra:{classes:s,styles:c,attributes:o}},a)}var _We=ba.styles;function bte(r){var e="nest"===_t.autoReplaceSvg?Ote(r,{styleParser:!1}):Ote(r);return~e.extra.classes.indexOf(Qee)?n4("generateLayersText",r,e):n4("generateSvgReplacementMutation",r,e)}var yl=new Set;function wte(r){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!J3)return Promise.resolve();var t=B1.documentElement.classList,n=function(d){return t.add("".concat(Kee,"-").concat(d))},i=function(d){return t.remove("".concat(Kee,"-").concat(d))},s=_t.autoFetchSvg?yl:nx.map(function(f){return"fa-".concat(f)}).concat(Object.keys(_We));s.includes("fa")||s.push("fa");var o=[".".concat(Qee,":not([").concat(M0,"])")].concat(s.map(function(f){return".".concat(f,":not([").concat(M0,"])")})).join(", ");if(0===o.length)return Promise.resolve();var a=[];try{a=J5(r.querySelectorAll(o))}catch{}if(!(a.length>0))return Promise.resolve();n("pending"),i("complete");var c=Cx.begin("onTree"),l=a.reduce(function(f,d){try{var m=bte(d);m&&f.push(m)}catch(E){Xee||"MissingIcon"===E.name&&console.error(E)}return f},[]);return new Promise(function(f,d){Promise.all(l).then(function(m){Ste(m,function(){n("active"),n("complete"),i("pending"),"function"==typeof e&&e(),c(),f()})}).catch(function(m){c(),d(m)})})}function vWe(r){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;bte(r).then(function(t){t&&Ste([t],e)})}function CWe(r){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(e||{}).icon?e:hx(e||{}),i=t.mask;return i&&(i=(i||{}).icon?i:hx(i||{})),r(n,ct(ct({},t),{},{mask:i}))}}nx.map(function(r){yl.add("fa-".concat(r))}),Object.keys(dd[U1]).map(yl.add.bind(yl)),Object.keys(dd[Or]).map(yl.add.bind(yl)),yl=ud(yl);var yWe=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.transform,i=void 0===n?zc:n,s=t.symbol,o=void 0!==s&&s,a=t.mask,c=void 0===a?null:a,l=t.maskId,f=void 0===l?null:l,d=t.title,m=void 0===d?null:d,E=t.titleId,w=void 0===E?null:E,R=t.classes,z=void 0===R?[]:R,$=t.attributes,G=void 0===$?{}:$,de=t.styles,ve=void 0===de?{}:de;if(e){var Le=e.prefix,nt=e.iconName,gt=e.icon;return Iv(ct({type:"icon"},e),function(){return P0("beforeDOMElementCreation",{iconDefinition:e,params:t}),_t.autoA11y&&(m?G["aria-labelledby"]="".concat(_t.replacementClass,"-title-").concat(w||vd()):(G["aria-hidden"]="true",G.focusable="false")),px({icons:{main:mx(gt),mask:c?mx(c.icon):{found:!1,width:null,height:null,icon:{}}},prefix:Le,iconName:nt,transform:ct(ct({},zc),i),symbol:o,title:m,maskId:f,titleId:w,extra:{attributes:G,styles:ve,classes:z}})})}},MWe={mixout:function(){return{icon:CWe(yWe)}},hooks:function(){return{mutationObserverCallbacks:function(t){return t.treeCallback=wte,t.nodeCallback=vWe,t}}},provides:function(e){e.i2svg=function(t){var n=t.node,s=t.callback;return wte(void 0===n?B1:n,void 0===s?function(){}:s)},e.generateSvgReplacementMutation=function(t,n){var i=n.iconName,s=n.title,o=n.titleId,a=n.prefix,c=n.transform,l=n.symbol,f=n.mask,d=n.maskId,m=n.extra;return new Promise(function(E,w){Promise.all([_x(i,a),f.iconName?_x(f.iconName,f.prefix):Promise.resolve({found:!1,width:512,height:512,icon:{}})]).then(function(R){var z=Yk(R,2);E([t,px({icons:{main:z[0],mask:z[1]},prefix:a,iconName:i,transform:c,symbol:l,maskId:d,title:s,titleId:o,extra:m,watchable:!0})])}).catch(w)})},e.generateAbstractIcon=function(t){var l,n=t.children,i=t.attributes,s=t.main,o=t.transform,c=Pv(t.styles);return c.length>0&&(i.style=c),ix(o)&&(l=n4("generateAbstractTransformGrouping",{main:s,transform:o,containerWidth:s.width,iconWidth:s.width})),n.push(l||s.icon),{children:n,attributes:i}}}},EWe={mixout:function(){return{layer:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.classes,s=void 0===i?[]:i;return Iv({type:"layer"},function(){P0("beforeDOMElementCreation",{assembler:t,params:n});var o=[];return t(function(a){Array.isArray(a)?a.map(function(c){o=o.concat(c.abstract)}):o=o.concat(a.abstract)}),[{tag:"span",attributes:{class:["".concat(_t.cssPrefix,"-layers")].concat(ud(s)).join(" ")},children:o}]})}}}},SWe={mixout:function(){return{counter:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.title,s=void 0===i?null:i,o=n.classes,a=void 0===o?[]:o,c=n.attributes,l=void 0===c?{}:c,f=n.styles,d=void 0===f?{}:f;return Iv({type:"counter",content:t},function(){return P0("beforeDOMElementCreation",{content:t,params:n}),function nWe(r){var e=r.content,t=r.title,n=r.extra,i=ct(ct(ct({},n.attributes),t?{title:t}:{}),{},{class:n.classes.join(" ")}),s=Pv(n.styles);s.length>0&&(i.style=s);var o=[];return o.push({tag:"span",attributes:i,children:[e]}),t&&o.push({tag:"span",attributes:{class:"sr-only"},children:[t]}),o}({content:t.toString(),title:s,extra:{attributes:l,styles:d,classes:["".concat(_t.cssPrefix,"-layers-counter")].concat(ud(a))}})})}}}},PWe={mixout:function(){return{text:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.transform,s=void 0===i?zc:i,o=n.title,a=void 0===o?null:o,c=n.classes,l=void 0===c?[]:c,f=n.attributes,d=void 0===f?{}:f,m=n.styles,E=void 0===m?{}:m;return Iv({type:"text",content:t},function(){return P0("beforeDOMElementCreation",{content:t,params:n}),_te({content:t,transform:ct(ct({},zc),s),title:a,extra:{attributes:d,styles:E,classes:["".concat(_t.cssPrefix,"-layers-text")].concat(ud(l))}})})}}},provides:function(e){e.generateLayersText=function(t,n){var i=n.title,s=n.transform,o=n.extra,a=null,c=null;if(jee){var l=parseInt(getComputedStyle(t).fontSize,10),f=t.getBoundingClientRect();a=f.width/l,c=f.height/l}return _t.autoA11y&&!i&&(o.attributes["aria-hidden"]="true"),Promise.resolve([t,_te({content:t.innerHTML,width:a,height:c,transform:s,title:i,extra:o,watchable:!0})])}}},TWe=new RegExp('"',"ug"),Ate=[1105920,1112319];function Nte(r,e){var t="".concat(pUe).concat(e.replace(":","-"));return new Promise(function(n,i){if(null!==r.getAttribute(t))return n();var o=J5(r.children).filter(function(gt){return gt.getAttribute(Jk)===e})[0],a=_l.getComputedStyle(r,e),c=a.getPropertyValue("font-family").match(CUe),l=a.getPropertyValue("font-weight"),f=a.getPropertyValue("content");if(o&&!c)return r.removeChild(o),n();if(c&&"none"!==f&&""!==f){var d=a.getPropertyValue("content"),m=~["Sharp"].indexOf(c[2])?Or:U1,E=~["Solid","Regular","Light","Thin","Duotone","Brands","Kit"].indexOf(c[2])?hd[m][c[2].toLowerCase()]:yUe[m][l],w=function OWe(r){var e=r.replace(TWe,""),t=function VUe(r,e){var i,t=r.length,n=r.charCodeAt(e);return n>=55296&&n<=56319&&t>e+1&&(i=r.charCodeAt(e+1))>=56320&&i<=57343?1024*(n-55296)+i-56320+65536:n}(e,0),n=t>=Ate[0]&&t<=Ate[1],i=2===e.length&&e[0]===e[1];return{value:ax(i?e[0]:e),isSecondary:n||i}}(d),R=w.value,z=w.isSecondary,$=c[0].startsWith("FontAwesome"),G=ux(E,R),de=G;if($){var ve=function qUe(r){var e=ute[r],t=ux("fas",r);return e||(t?{prefix:"fas",iconName:t}:null)||{prefix:null,iconName:null}}(R);ve.iconName&&ve.prefix&&(G=ve.iconName,E=ve.prefix)}if(!G||z||o&&o.getAttribute(ex)===E&&o.getAttribute(tx)===de)n();else{r.setAttribute(t,de),o&&r.removeChild(o);var Le=function mWe(){return{iconName:null,title:null,titleId:null,prefix:null,transform:zc,symbol:!1,mask:{iconName:null,prefix:null,rest:[]},maskId:null,extra:{classes:[],styles:{},attributes:{}}}}(),nt=Le.extra;nt.attributes[Jk]=e,_x(G,E).then(function(gt){var vn=px(ct(ct({},Le),{},{icons:{main:gt,mask:fx()},prefix:E,iconName:de,extra:nt,watchable:!0})),Et=B1.createElementNS("http://www.w3.org/2000/svg","svg");"::before"===e?r.insertBefore(Et,r.firstChild):r.appendChild(Et),Et.outerHTML=vn.map(function(Z2){return Cd(Z2)}).join("\n"),r.removeAttribute(t),n()}).catch(i)}}else n()})}function bWe(r){return Promise.all([Nte(r,"::before"),Nte(r,"::after")])}function wWe(r){return!(r.parentNode===document.head||~mUe.indexOf(r.tagName.toUpperCase())||r.getAttribute(Jk)||r.parentNode&&"svg"===r.parentNode.tagName)}function Ite(r){if(J3)return new Promise(function(e,t){var n=J5(r.querySelectorAll("*")).filter(wWe).map(bWe),i=Cx.begin("searchPseudoElements");Pte(),Promise.all(n).then(function(){i(),Mx(),e()}).catch(function(){i(),Mx(),t()})})}var kte=!1,xte=function(e){return e.toLowerCase().split(" ").reduce(function(n,i){var s=i.toLowerCase().split("-"),o=s[0],a=s.slice(1).join("-");if(o&&"h"===a)return n.flipX=!0,n;if(o&&"v"===a)return n.flipY=!0,n;if(a=parseFloat(a),isNaN(a))return n;switch(o){case"grow":n.size=n.size+a;break;case"shrink":n.size=n.size-a;break;case"left":n.x=n.x-a;break;case"right":n.x=n.x+a;break;case"up":n.y=n.y-a;break;case"down":n.y=n.y+a;break;case"rotate":n.rotate=n.rotate+a}return n},{size:16,x:0,y:0,flipX:!1,flipY:!1,rotate:0})},Ex={x:0,y:0,width:"100%",height:"100%"};function Lte(r){return r.attributes&&(r.attributes.fill||!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&(r.attributes.fill="black"),r}function kWe(r){return"g"===r.tag?r.children:[r]}var xWe={hooks:function(){return{parseNodeAttributes:function(t,n){var i=n.getAttribute("data-fa-mask"),s=i?Nv(i.split(" ").map(function(o){return o.trim()})):fx();return s.prefix||(s.prefix=Cl()),t.mask=s,t.maskId=n.getAttribute("data-fa-mask-id"),t}}},provides:function(e){e.generateAbstractMask=function(t){var n=t.children,i=t.attributes,s=t.main,o=t.mask,a=t.maskId,f=s.icon,m=o.icon,E=function IUe(r){var e=r.transform,n=r.iconWidth,i={transform:"translate(".concat(r.containerWidth/2," 256)")},s="translate(".concat(32*e.x,", ").concat(32*e.y,") "),o="scale(".concat(e.size/16*(e.flipX?-1:1),", ").concat(e.size/16*(e.flipY?-1:1),") "),a="rotate(".concat(e.rotate," 0 0)");return{outer:i,inner:{transform:"".concat(s," ").concat(o," ").concat(a)},path:{transform:"translate(".concat(n/2*-1," -256)")}}}({transform:t.transform,containerWidth:o.width,iconWidth:s.width}),w={tag:"rect",attributes:ct(ct({},Ex),{},{fill:"white"})},R=f.children?{children:f.children.map(Lte)}:{},z={tag:"g",attributes:ct({},E.inner),children:[Lte(ct({tag:f.tag,attributes:ct(ct({},f.attributes),E.path)},R))]},$={tag:"g",attributes:ct({},E.outer),children:[z]},G="mask-".concat(a||vd()),de="clip-".concat(a||vd()),ve={tag:"mask",attributes:ct(ct({},Ex),{},{id:G,maskUnits:"userSpaceOnUse",maskContentUnits:"userSpaceOnUse"}),children:[w,$]},Le={tag:"defs",children:[{tag:"clipPath",attributes:{id:de},children:kWe(m)},ve]};return n.push(Le,{tag:"rect",attributes:ct({fill:"currentColor","clip-path":"url(#".concat(de,")"),mask:"url(#".concat(G,")")},Ex)}),{children:n,attributes:i}}}};!function YUe(r,e){var t=e.mixoutsTo;gte=r,tu={},Object.keys(nu).forEach(function(n){-1===ZUe.indexOf(n)&&delete nu[n]}),gte.forEach(function(n){var i=n.mixout?n.mixout():{};if(Object.keys(i).forEach(function(o){"function"==typeof i[o]&&(t[o]=i[o]),"object"===mv(i[o])&&Object.keys(i[o]).forEach(function(a){t[o]||(t[o]={}),t[o][a]=i[o][a]})}),n.hooks){var s=n.hooks();Object.keys(s).forEach(function(o){tu[o]||(tu[o]=[]),tu[o].push(s[o])})}n.provides&&n.provides(nu)})}([LUe,MWe,EWe,SWe,PWe,{hooks:function(){return{mutationObserverCallbacks:function(t){return t.pseudoElementsCallback=Ite,t}}},provides:function(e){e.pseudoElements2svg=function(t){var n=t.node;_t.searchPseudoElements&&Ite(void 0===n?B1:n)}}},{mixout:function(){return{dom:{unwatch:function(){Pte(),kte=!0}}}},hooks:function(){return{bootstrap:function(){Tte(dx("mutationObserverCallbacks",{}))},noAuto:function(){!function dWe(){Lv&&Lv.disconnect()}()},watch:function(t){var n=t.observeMutationsRoot;kte?Mx():Tte(dx("mutationObserverCallbacks",{observeMutationsRoot:n}))}}}},{mixout:function(){return{parse:{transform:function(t){return xte(t)}}}},hooks:function(){return{parseNodeAttributes:function(t,n){var i=n.getAttribute("data-fa-transform");return i&&(t.transform=xte(i)),t}}},provides:function(e){e.generateAbstractTransformGrouping=function(t){var n=t.main,i=t.transform,o=t.iconWidth,a={transform:"translate(".concat(t.containerWidth/2," 256)")},c="translate(".concat(32*i.x,", ").concat(32*i.y,") "),l="scale(".concat(i.size/16*(i.flipX?-1:1),", ").concat(i.size/16*(i.flipY?-1:1),") "),f="rotate(".concat(i.rotate," 0 0)"),E={outer:a,inner:{transform:"".concat(c," ").concat(l," ").concat(f)},path:{transform:"translate(".concat(o/2*-1," -256)")}};return{tag:"g",attributes:ct({},E.outer),children:[{tag:"g",attributes:ct({},E.inner),children:[{tag:n.icon.tag,children:n.icon.children,attributes:ct(ct({},n.icon.attributes),E.path)}]}]}}}},xWe,{provides:function(e){var t=!1;_l.matchMedia&&(t=_l.matchMedia("(prefers-reduced-motion: reduce)").matches),e.missingIconAbstract=function(){var n=[],i={fill:"currentColor"},s={attributeType:"XML",repeatCount:"indefinite",dur:"2s"};n.push({tag:"path",attributes:ct(ct({},i),{},{d:"M156.5,447.7l-12.6,29.5c-18.7-9.5-35.9-21.2-51.5-34.9l22.7-22.7C127.6,430.5,141.5,440,156.5,447.7z M40.6,272H8.5 c1.4,21.2,5.4,41.7,11.7,61.1L50,321.2C45.1,305.5,41.8,289,40.6,272z M40.6,240c1.4-18.8,5.2-37,11.1-54.1l-29.5-12.6 C14.7,194.3,10,216.7,8.5,240H40.6z M64.3,156.5c7.8-14.9,17.2-28.8,28.1-41.5L69.7,92.3c-13.7,15.6-25.5,32.8-34.9,51.5 L64.3,156.5z M397,419.6c-13.9,12-29.4,22.3-46.1,30.4l11.9,29.8c20.7-9.9,39.8-22.6,56.9-37.6L397,419.6z M115,92.4 c13.9-12,29.4-22.3,46.1-30.4l-11.9-29.8c-20.7,9.9-39.8,22.6-56.8,37.6L115,92.4z M447.7,355.5c-7.8,14.9-17.2,28.8-28.1,41.5 l22.7,22.7c13.7-15.6,25.5-32.9,34.9-51.5L447.7,355.5z M471.4,272c-1.4,18.8-5.2,37-11.1,54.1l29.5,12.6 c7.5-21.1,12.2-43.5,13.6-66.8H471.4z M321.2,462c-15.7,5-32.2,8.2-49.2,9.4v32.1c21.2-1.4,41.7-5.4,61.1-11.7L321.2,462z M240,471.4c-18.8-1.4-37-5.2-54.1-11.1l-12.6,29.5c21.1,7.5,43.5,12.2,66.8,13.6V471.4z M462,190.8c5,15.7,8.2,32.2,9.4,49.2h32.1 c-1.4-21.2-5.4-41.7-11.7-61.1L462,190.8z M92.4,397c-12-13.9-22.3-29.4-30.4-46.1l-29.8,11.9c9.9,20.7,22.6,39.8,37.6,56.9 L92.4,397z M272,40.6c18.8,1.4,36.9,5.2,54.1,11.1l12.6-29.5C317.7,14.7,295.3,10,272,8.5V40.6z M190.8,50 c15.7-5,32.2-8.2,49.2-9.4V8.5c-21.2,1.4-41.7,5.4-61.1,11.7L190.8,50z M442.3,92.3L419.6,115c12,13.9,22.3,29.4,30.5,46.1 l29.8-11.9C470,128.5,457.3,109.4,442.3,92.3z M397,92.4l22.7-22.7c-15.6-13.7-32.8-25.5-51.5-34.9l-12.6,29.5 C370.4,72.1,384.4,81.5,397,92.4z"})});var o=ct(ct({},s),{},{attributeName:"opacity"}),a={tag:"circle",attributes:ct(ct({},i),{},{cx:"256",cy:"364",r:"28"}),children:[]};return t||a.children.push({tag:"animate",attributes:ct(ct({},s),{},{attributeName:"r",values:"28;14;28;28;14;28;"})},{tag:"animate",attributes:ct(ct({},o),{},{values:"1;0;1;1;0;1;"})}),n.push(a),n.push({tag:"path",attributes:ct(ct({},i),{},{opacity:"1",d:"M263.7,312h-16c-6.6,0-12-5.4-12-12c0-71,77.4-63.9,77.4-107.8c0-20-17.8-40.2-57.4-40.2c-29.1,0-44.3,9.6-59.2,28.7 c-3.9,5-11.1,6-16.2,2.4l-13.1-9.2c-5.6-3.9-6.9-11.8-2.6-17.2c21.2-27.2,46.4-44.7,91.2-44.7c52.3,0,97.4,29.8,97.4,80.2 c0,67.6-77.4,63.5-77.4,107.8C275.7,306.6,270.3,312,263.7,312z"}),children:t?[]:[{tag:"animate",attributes:ct(ct({},o),{},{values:"1;0;0;0;0;1;"})}]}),t||n.push({tag:"path",attributes:ct(ct({},i),{},{opacity:"0",d:"M232.5,134.5l7,168c0.3,6.4,5.6,11.5,12,11.5h9c6.4,0,11.7-5.1,12-11.5l7-168c0.3-6.8-5.2-12.5-12-12.5h-23 C237.7,122,232.2,127.7,232.5,134.5z"}),children:[{tag:"animate",attributes:ct(ct({},o),{},{values:"0;0;1;1;0;0;"})}]}),{tag:"g",attributes:{class:"missing"},children:n}}}},{hooks:function(){return{parseNodeAttributes:function(t,n){var i=n.getAttribute("data-fa-symbol");return t.symbol=null!==i&&(""===i||i),t}}}}],{mixoutsTo:ho});var DWe=ho.parse,HWe=ho.icon;const VWe=["*"],GWe=r=>{const e={[`fa-${r.animation}`]:null!=r.animation&&!r.animation.startsWith("spin"),"fa-spin":"spin"===r.animation||"spin-reverse"===r.animation,"fa-spin-pulse":"spin-pulse"===r.animation||"spin-pulse-reverse"===r.animation,"fa-spin-reverse":"spin-reverse"===r.animation||"spin-pulse-reverse"===r.animation,"fa-pulse":"spin-pulse"===r.animation||"spin-pulse-reverse"===r.animation,"fa-fw":r.fixedWidth,"fa-border":r.border,"fa-inverse":r.inverse,"fa-layers-counter":r.counter,"fa-flip-horizontal":"horizontal"===r.flip||"both"===r.flip,"fa-flip-vertical":"vertical"===r.flip||"both"===r.flip,[`fa-${r.size}`]:null!==r.size,[`fa-rotate-${r.rotate}`]:null!==r.rotate,[`fa-pull-${r.pull}`]:null!==r.pull,[`fa-stack-${r.stackItemSize}`]:null!=r.stackItemSize};return Object.keys(e).map(t=>e[t]?t:null).filter(t=>t)};let WWe=(()=>{var r;class e{constructor(){this.defaultPrefix="fas",this.fallbackIcon=null}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=He({token:r,factory:r.\u0275fac,providedIn:"root"}),e})(),qWe=(()=>{var r;class e{constructor(){this.definitions={}}addIcons(...n){for(const i of n){i.prefix in this.definitions||(this.definitions[i.prefix]={}),this.definitions[i.prefix][i.iconName]=i;for(const s of i.icon[2])"string"==typeof s&&(this.definitions[i.prefix][s]=i)}}addIconPacks(...n){for(const i of n){const s=Object.keys(i).map(o=>i[o]);this.addIcons(...s)}}getIconDefinition(n,i){return n in this.definitions&&i in this.definitions[n]?this.definitions[n][i]:null}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=He({token:r,factory:r.\u0275fac,providedIn:"root"}),e})(),jWe=(()=>{var r;class e{constructor(){this.stackItemSize="1x"}ngOnChanges(n){if("size"in n)throw new Error('fa-icon is not allowed to customize size when used inside fa-stack. Set size on the enclosing fa-stack instead: <fa-stack size="4x">...</fa-stack>.')}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275dir=Rt({type:r,selectors:[["fa-icon","stackItemSize",""],["fa-duotone-icon","stackItemSize",""]],inputs:{stackItemSize:"stackItemSize",size:"size"},features:[Ji]}),e})(),ZWe=(()=>{var r;class e{constructor(n,i){this.renderer=n,this.elementRef=i}ngOnInit(){this.renderer.addClass(this.elementRef.nativeElement,"fa-stack")}ngOnChanges(n){"size"in n&&(null!=n.size.currentValue&&this.renderer.addClass(this.elementRef.nativeElement,`fa-${n.size.currentValue}`),null!=n.size.previousValue&&this.renderer.removeClass(this.elementRef.nativeElement,`fa-${n.size.previousValue}`))}}return(r=e).\u0275fac=function(n){return new(n||r)(B(uc),B(Oi))},r.\u0275cmp=qe({type:r,selectors:[["fa-stack"]],inputs:{size:"size"},features:[Ji],ngContentSelectors:VWe,decls:1,vars:0,template:function(n,i){1&n&&(function TV(r){const e=Ee()[zr][Pi];if(!e.projection){const n=e.projection=o7(r?r.length:1,null),i=n.slice();let s=e.child;for(;null!==s;){const o=r?yue(s,r):0;null!==o&&(i[o]?i[o].projectionNext=s:n[o]=s,i[o]=s),s=s.next}}}(),function OV(r,e=0,t){const n=Ee(),i=Rn(),s=E8(i,pn+r,16,null,t||null);null===s.projection&&(s.projection=e),Ry(),(!n[h3]||t8())&&32!=(32&s.flags)&&function b0e(r,e,t){RD(e[Zt],0,e,t,cM(r,t,e),AD(t.parent||e[Pi],t,e))}(i,n,s)}(0))},encapsulation:2}),e})(),T0=(()=>{var r;class e{set spin(n){this.animation=n?"spin":void 0}set pulse(n){this.animation=n?"spin-pulse":void 0}constructor(n,i,s,o,a){this.sanitizer=n,this.config=i,this.iconLibrary=s,this.stackItem=o,this.classes=[],null!=a&&null==o&&console.error('FontAwesome: fa-icon and fa-duotone-icon elements must specify stackItemSize attribute when wrapped into fa-stack. Example: <fa-icon stackItemSize="2x"></fa-icon>.')}ngOnChanges(n){if(null!=this.icon||null!=this.config.fallbackIcon){if(n){const s=this.findIconDefinition(null!=this.icon?this.icon:this.config.fallbackIcon);if(null!=s){const o=this.buildParams();this.renderIcon(s,o)}}}else(()=>{throw new Error("Property `icon` is required for `fa-icon`/`fa-duotone-icon` components.")})()}render(){this.ngOnChanges({})}findIconDefinition(n){const i=((r,e)=>(r=>void 0!==r.prefix&&void 0!==r.iconName)(r)?r:"string"==typeof r?{prefix:e,iconName:r}:{prefix:r[0],iconName:r[1]})(n,this.config.defaultPrefix);return"icon"in i?i:this.iconLibrary.getIconDefinition(i.prefix,i.iconName)??((r=>{throw new Error(`Could not find icon with iconName=${r.iconName} and prefix=${r.prefix} in the icon library.`)})(i),null)}buildParams(){const n={flip:this.flip,animation:this.animation,border:this.border,inverse:this.inverse,size:this.size||null,pull:this.pull||null,rotate:this.rotate||null,fixedWidth:"boolean"==typeof this.fixedWidth?this.fixedWidth:this.config.fixedWidth,stackItemSize:null!=this.stackItem?this.stackItem.stackItemSize:null},i="string"==typeof this.transform?DWe.transform(this.transform):this.transform;return{title:this.title,transform:i,classes:[...GWe(n),...this.classes],mask:null!=this.mask?this.findIconDefinition(this.mask):null,styles:null!=this.styles?this.styles:{},symbol:this.symbol,attributes:{role:this.a11yRole}}}renderIcon(n,i){const s=HWe(n,i);this.renderedIconHTML=this.sanitizer.bypassSecurityTrustHtml(s.html.join("\n"))}}return(r=e).\u0275fac=function(n){return new(n||r)(B(iB),B(WWe),B(qWe),B(jWe,8),B(ZWe,8))},r.\u0275cmp=qe({type:r,selectors:[["fa-icon"]],hostAttrs:[1,"ng-fa-icon"],hostVars:2,hostBindings:function(n,i){2&n&&(uE("innerHTML",i.renderedIconHTML,h7),I("title",i.title))},inputs:{icon:"icon",title:"title",animation:"animation",spin:"spin",pulse:"pulse",mask:"mask",styles:"styles",flip:"flip",size:"size",pull:"pull",border:"border",inverse:"inverse",symbol:"symbol",rotate:"rotate",fixedWidth:"fixedWidth",classes:"classes",transform:"transform",a11yRole:"a11yRole"},features:[Ji],decls:0,vars:0,template:function(n,i){},encapsulation:2}),e})(),YWe=(()=>{var r;class e{}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275mod=Ei({type:r}),r.\u0275inj=X2({}),e})();var Ox={prefix:"fas",iconName:"reply",icon:[512,512,[61714,"mail-reply"],"f3e5","M205 34.8c11.5 5.1 19 16.6 19 29.2v64H336c97.2 0 176 78.8 176 176c0 113.3-81.5 163.9-100.2 174.1c-2.5 1.4-5.3 1.9-8.1 1.9c-10.9 0-19.7-8.9-19.7-19.7c0-7.5 4.3-14.4 9.8-19.5c9.4-8.8 22.2-26.4 22.2-56.7c0-53-43-96-96-96H224v64c0 12.6-7.4 24.1-19 29.2s-25 3-34.4-5.4l-160-144C3.9 225.7 0 217.1 0 208s3.9-17.7 10.6-23.8l160-144c9.4-8.5 22.9-10.6 34.4-5.4z"]},Dne={prefix:"fas",iconName:"flag",icon:[448,512,[127988,61725],"f024","M64 32C64 14.3 49.7 0 32 0S0 14.3 0 32V64 368 480c0 17.7 14.3 32 32 32s32-14.3 32-32V352l64.3-16.1c41.1-10.3 84.6-5.5 122.5 13.4c44.2 22.1 95.5 24.8 141.7 7.4l34.7-13c12.5-4.7 20.8-16.6 20.8-30V66.1c0-23-24.2-38-44.8-27.7l-9.6 4.8c-46.3 23.2-100.8 23.2-147.1 0c-35.1-17.6-75.4-22-113.5-12.5L64 48V32z"]},v1e={prefix:"fas",iconName:"repeat",icon:[512,512,[128257],"f363","M0 224c0 17.7 14.3 32 32 32s32-14.3 32-32c0-53 43-96 96-96H320v32c0 12.9 7.8 24.6 19.8 29.6s25.7 2.2 34.9-6.9l64-64c12.5-12.5 12.5-32.8 0-45.3l-64-64c-9.2-9.2-22.9-11.9-34.9-6.9S320 19.1 320 32V64H160C71.6 64 0 135.6 0 224zm512 64c0-17.7-14.3-32-32-32s-32 14.3-32 32c0 53-43 96-96 96H192V352c0-12.9-7.8-24.6-19.8-29.6s-25.7-2.2-34.9 6.9l-64 64c-12.5 12.5-12.5 32.8 0 45.3l64 64c9.2 9.2 22.9 11.9 34.9 6.9s19.8-16.6 19.8-29.6V448H352c88.4 0 160-71.6 160-160z"]},$x={prefix:"fas",iconName:"eye",icon:[576,512,[128065],"f06e","M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM144 256a144 144 0 1 1 288 0 144 144 0 1 1 -288 0zm144-64c0 35.3-28.7 64-64 64c-7.1 0-13.9-1.2-20.3-3.3c-5.5-1.8-11.9 1.6-11.7 7.4c.3 6.9 1.3 13.8 3.2 20.7c13.7 51.2 66.4 81.6 117.6 67.9s81.6-66.4 67.9-117.6c-11.1-41.5-47.8-69.4-88.6-71.1c-5.8-.2-9.2 6.1-7.4 11.7c2.1 6.4 3.3 13.2 3.3 20.3z"]},Pie={prefix:"fas",iconName:"gear",icon:[512,512,[9881,"cog"],"f013","M495.9 166.6c3.2 8.7 .5 18.4-6.4 24.6l-43.3 39.4c1.1 8.3 1.7 16.8 1.7 25.4s-.6 17.1-1.7 25.4l43.3 39.4c6.9 6.2 9.6 15.9 6.4 24.6c-4.4 11.9-9.7 23.3-15.8 34.3l-4.7 8.1c-6.6 11-14 21.4-22.1 31.2c-5.9 7.2-15.7 9.6-24.5 6.8l-55.7-17.7c-13.4 10.3-28.2 18.9-44 25.4l-12.5 57.1c-2 9.1-9 16.3-18.2 17.8c-13.8 2.3-28 3.5-42.5 3.5s-28.7-1.2-42.5-3.5c-9.2-1.5-16.2-8.7-18.2-17.8l-12.5-57.1c-15.8-6.5-30.6-15.1-44-25.4L83.1 425.9c-8.8 2.8-18.6 .3-24.5-6.8c-8.1-9.8-15.5-20.2-22.1-31.2l-4.7-8.1c-6.1-11-11.4-22.4-15.8-34.3c-3.2-8.7-.5-18.4 6.4-24.6l43.3-39.4C64.6 273.1 64 264.6 64 256s.6-17.1 1.7-25.4L22.4 191.2c-6.9-6.2-9.6-15.9-6.4-24.6c4.4-11.9 9.7-23.3 15.8-34.3l4.7-8.1c6.6-11 14-21.4 22.1-31.2c5.9-7.2 15.7-9.6 24.5-6.8l55.7 17.7c13.4-10.3 28.2-18.9 44-25.4l12.5-57.1c2-9.1 9-16.3 18.2-17.8C227.3 1.2 241.5 0 256 0s28.7 1.2 42.5 3.5c9.2 1.5 16.2 8.7 18.2 17.8l12.5 57.1c15.8 6.5 30.6 15.1 44 25.4l55.7-17.7c8.8-2.8 18.6-.3 24.5 6.8c8.1 9.8 15.5 20.2 22.1 31.2l4.7 8.1c6.1 11 11.4 22.4 15.8 34.3zM256 336a80 80 0 1 0 0-160 80 80 0 1 0 0 160z"]},Yx={prefix:"fas",iconName:"backward-step",icon:[320,512,["step-backward"],"f048","M267.5 440.6c9.5 7.9 22.8 9.7 34.1 4.4s18.4-16.6 18.4-29V96c0-12.4-7.2-23.7-18.4-29s-24.5-3.6-34.1 4.4l-192 160L64 241V96c0-17.7-14.3-32-32-32S0 78.3 0 96V416c0 17.7 14.3 32 32 32s32-14.3 32-32V271l11.5 9.6 192 160z"]},Lie={prefix:"fas",iconName:"network-wired",icon:[640,512,[],"f6ff","M256 64H384v64H256V64zM240 0c-26.5 0-48 21.5-48 48v96c0 26.5 21.5 48 48 48h48v32H32c-17.7 0-32 14.3-32 32s14.3 32 32 32h96v32H80c-26.5 0-48 21.5-48 48v96c0 26.5 21.5 48 48 48H240c26.5 0 48-21.5 48-48V368c0-26.5-21.5-48-48-48H192V288H448v32H400c-26.5 0-48 21.5-48 48v96c0 26.5 21.5 48 48 48H560c26.5 0 48-21.5 48-48V368c0-26.5-21.5-48-48-48H512V288h96c17.7 0 32-14.3 32-32s-14.3-32-32-32H352V192h48c26.5 0 48-21.5 48-48V48c0-26.5-21.5-48-48-48H240zM96 448V384H224v64H96zm320-64H544v64H416V384z"]},eoe={prefix:"fas",iconName:"spinner",icon:[512,512,[],"f110","M304 48a48 48 0 1 0 -96 0 48 48 0 1 0 96 0zm0 416a48 48 0 1 0 -96 0 48 48 0 1 0 96 0zM48 304a48 48 0 1 0 0-96 48 48 0 1 0 0 96zm464-48a48 48 0 1 0 -96 0 48 48 0 1 0 96 0zM142.9 437A48 48 0 1 0 75 369.1 48 48 0 1 0 142.9 437zm0-294.2A48 48 0 1 0 75 75a48 48 0 1 0 67.9 67.9zM369.1 437A48 48 0 1 0 437 369.1 48 48 0 1 0 369.1 437z"]},fL={prefix:"fas",iconName:"desktop",icon:[576,512,[128421,61704,"desktop-alt"],"f390","M64 0C28.7 0 0 28.7 0 64V352c0 35.3 28.7 64 64 64H240l-10.7 32H160c-17.7 0-32 14.3-32 32s14.3 32 32 32H416c17.7 0 32-14.3 32-32s-14.3-32-32-32H346.7L336 416H512c35.3 0 64-28.7 64-64V64c0-35.3-28.7-64-64-64H64zM512 64V288H64V64H512z"]},zoe={prefix:"fas",iconName:"book-open",icon:[576,512,[128214,128366],"f518","M249.6 471.5c10.8 3.8 22.4-4.1 22.4-15.5V78.6c0-4.2-1.6-8.4-5-11C247.4 52 202.4 32 144 32C93.5 32 46.3 45.3 18.1 56.1C6.8 60.5 0 71.7 0 83.8V454.1c0 11.9 12.8 20.2 24.1 16.5C55.6 460.1 105.5 448 144 448c33.9 0 79 14 105.6 23.5zm76.8 0C353 462 398.1 448 432 448c38.5 0 88.4 12.1 119.9 22.6c11.3 3.8 24.1-4.6 24.1-16.5V83.8c0-12.1-6.8-23.3-18.1-27.6C529.7 45.3 482.5 32 432 32c-58.4 0-103.4 20-123 35.6c-3.3 2.6-5 6.8-5 11V456c0 11.4 11.7 19.3 22.4 15.5z"]};class uae{static toComparableObjectSet(e){const t=[];return e.forEach(n=>{!1===t.some(i=>i.equals(n))&&t.push(n)}),t}static toComparableSet(e){const t=[];return e.forEach(n=>{!1===t.some(i=>zo(i,n))&&t.push(n)}),t}}let fae;fae=Symbol.iterator;class dt{constructor(e){u(this,"values",void 0),this.values=void 0===e?[]:uae.toComparableSet(e)}equals(e){if(e.size()!==this.size())return!1;for(const t of this)if(!1===e.contains(t))return!1;return!0}toString(){let e="";for(const t of this)e+=null==t?"null, ":t.toString()+", ";return"["+e.slice(0,-2)+"]"}add(e){return!this.contains(e)&&(this.values.push(e),!0)}remove(e){for(let t=0;t<this.values.length;t++)if(zo(this.values[t],e))return this.values.splice(t,1),!0;return!1}addAll(e){for(const t of e)this.add(t)}union(e){const t=new dt(this.toList());return t.addAll(e),t}contains(e){for(const t of this.values)if(zo(t,e))return!0;return!1}size(){return this.values.length}toList(){const e=[];for(const t of this)e.push(t);return e}getAnyElement(){return this.size()>0?g.of(this.values[0]):g.empty()}isEmpty(){return 0===this.values.length}hasElements(){return!1===this.isEmpty()}map(e){const t=[];for(const n of this.values)t.push(e(n));return new dt(t)}flatMap(e){const t=new dt;for(const n of this)t.addAll(e(n));return t}filter(e){const t=new dt;for(const n of this)e(n)&&t.add(n);return t}findAnyCommonElement(e){for(const t of e)if(this.contains(t))return g.of(t);return g.empty()}intersection(e){const t=new dt;for(const n of e)this.contains(n)&&t.add(n);return t}[fae](){return this.values.values()}}class En{static from(e){const t=Object.keys(e),n=new En;for(const i of t)n.set(i,e[i]);return n}constructor(e=[],t=!1){u(this,"map",void 0),u(this,"isImmutable",void 0),this.map=e,this.isImmutable=t}makeImmutable(){this.isImmutable=!0}get(e){for(const t of this.map)if(zo(t.key,e))return g.of(t.value);return g.empty()}getAnyPair(){return this.size()>0?g.of(this.map[0]):g.empty()}forEach(e){for(const t of this.map)e(t)}putAll(e){this.checkImmutability("putAll");for(const t of e.map)this.put(t.key,t.value)}checkImmutability(e){if(this.isImmutable)throw new Error("Cannot call "+e+" on immutable map!")}put(e,t){this.checkImmutability("put");for(const n of this.map)if(zo(n.key,e)){const i=n.value;return n.value=t,g.of(i)}return this.map.push({key:e,value:t}),g.empty()}containsKey(e){return this.map.some(t=>zo(t.key,e))}size(){return this.map.length}listKeys(){return this.map.map(e=>e.key)}listValues(){return this.map.map(e=>e.value)}getKeySet(){return new dt(this.listKeys())}filter(e){const t=new En;for(const n of this.map)e(n.key,n.value)&&t.set(n.key,n.value);return t}replace(e,t){if(this.checkImmutability("replace"),this.get(e).isAbsent())throw new Error("No Value to replace for key "+e.toString()+"!");return this.put(e,t),t}set(e,t){if(this.checkImmutability("set"),this.containsKey(e))throw new Error("Key "+e.toString()+" already exist in Map!");this.map.push({key:e,value:t})}delete(e){this.checkImmutability("delete");for(let t=0;t<this.map.length;t++)if(zo(this.map[t].key,e)){const i=this.map[t].value,s=this.map.slice(0,t),o=this.map.slice(t+1);return this.map=s.concat(o),i}throw new Error('No Value to delete for key "'+e.toString()+'"!')}getCopy(){const e=new this.constructor;for(const t of this.listKeys())e.set(t,this.get(t).get());return e}equals(e){const t=this.getKeySet(),n=e.getKeySet();if(!1===t.equals(n))return!1;for(const i of t){const s=this.get(i).get(),o=e.get(i);if(Ze(o.isPresent(),"value is absent in a map even though its key is present!"),!1===zo(s,o.get()))return!1}return!0}}class ru extends En{reverse(){const e=new ru;for(const t of this.listKeys()){const n=this.get(t).get();if(e.containsKey(n))e.get(n).get().add(t);else{const i=new dt;i.add(t),e.set(n,i)}}return e}}var Xv;class ds{constructor(e,t,n){var i=this;u(this,"userDAO",void 0),u(this,"userService",void 0),u(this,"connectedUserService",void 0),u(this,"authSubscription",void 0),u(this,"userSubscription",new yn),u(this,"currentGame",g.empty()),u(this,"currentGameRS",void 0),u(this,"currentGameObs",void 0),this.userDAO=e,this.userService=t,this.connectedUserService=n,this.currentGameRS=new QJ(1),this.currentGameObs=this.currentGameRS.asObservable(),this.authSubscription=this.connectedUserService.subscribeToUser(function(){var s=M(function*(o){yield i.onUserUpdate(o)});return function(o){return s.apply(this,arguments)}}())}onUserUpdate(e){var t=this;return M(function*(){if(e===_0.NOT_CONNECTED)t.userSubscription.unsubscribe(),t.currentGame=g.empty(),t.currentGameRS.next(g.empty());else{t.userSubscription=t.userService.observeUserOnServer(e.id,i=>{Ze(i.isPresent(),"Observing part service expected user to already have a document!");const s=i.get();t.onCurrentGameUpdate(s.currentGame)});const n=yield t.userDAO.read(e.id);t.currentGame=g.ofNullable(n.get().currentGame),t.currentGameRS.next(t.currentGame)}})()}onCurrentGameUpdate(e){const t=this.currentGame,n=null==e&&t.isAbsent(),i=null!=e&&t.equalsValue(e);!1===n&&!1===i&&(this.currentGame=g.ofNullable(e),this.currentGameRS.next(this.currentGame))}updateCurrentGame(e){if(Ze(this.connectedUserService.user.isPresent(),"Should not call updateCurrentGame when not connected"),this.currentGame.isPresent()){const n={...this.currentGame.get(),...e};return this.userDAO.update(this.connectedUserService.user.get().id,{currentGame:n})}{const n=Object.keys({id:"id",role:"Candidate",typeGame:"P4"});for(const i of n)Ze(null!=e[i],"field "+i+" should be set before updating currentGame");return this.userDAO.update(this.connectedUserService.user.get().id,{currentGame:e})}}removeCurrentGame(){return Ze(this.connectedUserService.user.isPresent(),"Should not call removeCurrentGame when not connected"),this.userDAO.update(this.connectedUserService.user.get().id,{currentGame:null})}subscribeToCurrentGame(e){return this.currentGameObs.subscribe(e)}canUserCreate(){if(this.currentGame.isAbsent())return b.SUCCESS;{const e=ds.roleToMessage.get(this.currentGame.get().role).get()();return b.failure(e)}}canUserJoin(e,t){if(this.currentGame.isAbsent()||this.currentGame.get().id===e)return b.SUCCESS;if(t&&"Observer"===this.currentGame.get().role)return b.SUCCESS;{const n=ds.roleToMessage.get(this.currentGame.get().role).get()();return b.failure(n)}}getCurrentGame(){return new Promise(e=>{let t=new yn;t=this.currentGameObs.subscribe(n=>{e(n),t.unsubscribe()})})}ngOnDestroy(){this.userSubscription.unsubscribe(),this.authSubscription.unsubscribe()}}function m7t(r,e){if(1&r&&(Gt(0),oe(1,31),Bt()),2&r){const t=p(2);_(1),$n(t.currentGame.get().typeGame)(null==t.currentGame.get().opponent?null:t.currentGame.get().opponent.name),jn(1)}}function _7t(r,e){if(1&r&&(Gt(0),oe(1,33),Bt()),2&r){const t=p(3);_(1),$n(t.currentGame.get().typeGame)(null==t.currentGame.get().opponent?null:t.currentGame.get().opponent.name),jn(1)}}function v7t(r,e){if(1&r&&(Gt(0),oe(1,34),Bt()),2&r){const t=p(3);_(1),$n(t.currentGame.get().typeGame),jn(1)}}function C7t(r,e){if(1&r&&(T(0,_7t,2,2,"ng-container",27),T(1,v7t,2,1,"ng-template",null,32,un)),2&r){const t=cn(2);y("ngIf",p(2).currentGame.get().opponent)("ngIfElse",t)}}function y7t(r,e){if(1&r){const t=pe();S(0,"a",29),W("click",function(){return te(t),ne(p().navigateToPart())}),T(1,m7t,2,2,"ng-container",27),T(2,C7t,3,2,"ng-template",null,30,un),P()}if(2&r){const t=cn(3),n=p();_(1),y("ngIf","Observer"===n.currentGame.get().role||"Candidate"===n.currentGame.get().role)("ngIfElse",t)}}function M7t(r,e){if(1&r&&(Gt(0),F(1,"fa-icon",35),Bt()),2&r){const t=p();_(1),y("icon",t.faSpinner)}}function E7t(r,e){if(1&r){const t=pe();Gt(0),S(1,"div",10)(2,"a",37),lt(3),P(),S(4,"div",13)(5,"a",38),oe(6,39),P(),S(7,"a",40),W("click",function(){return te(t),ne(p(2).logout())}),oe(8,41),P()()(),Bt()}if(2&r){const t=p(2);_(3),An(t.username.get())}}Xv=ds,u(ds,"roleToMessage",new En([{key:"Candidate",value:id.YOU_ARE_ALREADY_CANDIDATE},{key:"ChosenOpponent",value:id.YOU_ARE_ALREADY_CHOSEN_OPPONENT},{key:"Creator",value:id.YOU_ARE_ALREADY_CREATING},{key:"Player",value:id.YOU_ARE_ALREADY_PLAYING},{key:"Observer",value:id.YOU_ARE_ALREADY_OBSERVING}])),u(ds,"\u0275fac",function(e){return new(e||Xv)(Pe(rd),Pe(Y5),Pe(lr))}),u(ds,"\u0275prov",He({token:Xv,factory:Xv.\u0275fac,providedIn:"root"}));const S7t=function(){return["/register"]},P7t=function(){return["/login"]};function T7t(r,e){1&r&&(S(0,"div",42)(1,"a",43)(2,"strong"),oe(3,44),P()(),S(4,"a",45),oe(5,46),P()()),2&r&&(_(1),y("routerLink",D1(2,S7t)),_(3),y("routerLink",D1(3,P7t)))}function O7t(r,e){if(1&r&&(T(0,E7t,9,1,"ng-container",27),T(1,T7t,6,4,"ng-template",null,36,un)),2&r){const t=cn(2);y("ngIf",p().username.isPresent())("ngIfElse",t)}}const dae=function(){return["/"]},b7t=function(){return["/play"]},w7t=function(){return["/lobby"]},A7t=function(){return["/local"]},N7t=function(){return["/tutorial"]},I7t=function(){return["/settings"]};let k7t=(()=>{var r;class e{constructor(n,i,s,o){u(this,"router",void 0),u(this,"connectedUserService",void 0),u(this,"currentGameService",void 0),u(this,"userService",void 0),u(this,"loading",!0),u(this,"username",g.empty()),u(this,"faCog",Pie),u(this,"faSpinner",eoe),u(this,"userSubscription",void 0),u(this,"currentGameSubscription",void 0),u(this,"showMenu",!1),u(this,"currentGame",g.empty()),this.router=n,this.connectedUserService=i,this.currentGameService=s,this.userService=o}ngOnInit(){this.userSubscription=this.connectedUserService.subscribeToUser(n=>{this.loading=!1,this.username=n.username.isPresent()?n.username:n.email}),this.currentGameSubscription=this.currentGameService.subscribeToCurrentGame(n=>{this.currentGame=n})}logout(){var n=this;return M(function*(){yield n.connectedUserService.disconnect(),yield n.router.navigate(["/"])})()}navigateToPart(){var n=this;return M(function*(){return n.router.navigate(["/play",n.currentGame.get().typeGame,n.currentGame.get().id])})()}ngOnDestroy(){this.userSubscription.unsubscribe(),this.currentGameSubscription.unsubscribe()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(Gn),B(lr),B(ds),B(Y5))}),u(e,"\u0275cmp",qe({type:r,selectors:[["app-header"]],decls:36,vars:20,consts:function(){let t,n,i,s,o,a,c,l,f,d,m,E,w,R,z;return t=$localize`Home`,n=$localize`Play online`,i=$localize`Create a game`,s=$localize`Join a game`,o=$localize`Play offline`,a=$localize`Create a game`,c=$localize`Learn the rules`,l=$localize`Settings`,f=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: by ${"\ufffd1\ufffd"}:INTERPOLATION_1:`,d=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: against ${"\ufffd1\ufffd"}:INTERPOLATION_1:`,m=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: (waiting for opponent)`,E=$localize`Account`,w=$localize`Log out`,R=$localize`Register`,z=$localize`Log in`,[["role","navigation","aria-label","main navigation",1,"navbar","is-primary"],[1,"navbar-brand"],[1,"navbar-item",3,"routerLink"],["id","logo","src","assets/images/logo.png","width","28","height","28"],["role","button","aria-label","menu","aria-expanded","false","data-target","menu",1,"navbar-burger",3,"ngClass","click"],["aria-hidden","true"],["id","menu",1,"navbar-menu",3,"ngClass","click"],[1,"navbar-start"],["id","home",1,"navbar-item",3,"routerLink"],t,[1,"navbar-item","has-dropdown","is-hoverable"],[1,"navbar-link"],n,[1,"navbar-dropdown"],i,s,["id","playOffline",1,"navbar-link"],o,["id","playLocally",1,"navbar-item",3,"routerLink"],a,["id","tutorial",1,"navbar-item",3,"routerLink"],c,[1,"navbar-end"],["id","currentGameLink","class","navbar-item",3,"click",4,"ngIf"],["data-tooltip",l,1,"navbar-item",3,"routerLink"],[3,"icon"],[1,"navbar-item"],[4,"ngIf","ngIfElse"],["showUsernameOrLogin",""],["id","currentGameLink",1,"navbar-item",3,"click"],["activeUser",""],f,["waitingForOpponent",""],d,m,[1,"navbar-item","fa-spin",3,"icon"],["connect",""],["id","connectedUserName",1,"navbar-link"],["id","account","routerLink","/account",1,"navbar-item"],E,["id","logout",1,"navbar-item",3,"click"],w,[1,"buttons"],["id","register",1,"button","is-primary",3,"routerLink"],R,["id","login",1,"button","is-light",3,"routerLink"],z]},template:function(n,i){if(1&n&&(S(0,"nav",0)(1,"div",1)(2,"a",2),F(3,"img",3),P(),S(4,"a",4),W("click",function(){return i.showMenu=!i.showMenu}),F(5,"span",5)(6,"span",5)(7,"span",5),P()(),S(8,"div",6),W("click",function(){return i.showMenu=!i.showMenu}),S(9,"div",7)(10,"a",8),oe(11,9),P(),S(12,"div",10)(13,"a",11),oe(14,12),P(),S(15,"div",13)(16,"a",2),oe(17,14),P(),S(18,"a",2),oe(19,15),P()()(),S(20,"div",10)(21,"a",16),oe(22,17),P(),S(23,"div",13)(24,"a",18),oe(25,19),P(),S(26,"a",20),oe(27,21),P()()()(),S(28,"div",22),T(29,y7t,4,2,"a",23),S(30,"a",24),F(31,"fa-icon",25),P(),S(32,"div",26),T(33,M7t,2,1,"ng-container",27),T(34,O7t,3,2,"ng-template",null,28,un),P()()()()),2&n){const s=cn(35);_(2),y("routerLink",D1(13,dae)),_(2),y("ngClass",i.showMenu?"is-active":""),_(4),y("ngClass",i.showMenu?"is-active":""),_(2),y("routerLink",D1(14,dae)),_(6),y("routerLink",D1(15,b7t)),_(2),y("routerLink",D1(16,w7t)),_(6),y("routerLink",D1(17,A7t)),_(2),y("routerLink",D1(18,N7t)),_(3),y("ngIf",i.currentGame.isPresent()),_(1),y("routerLink",D1(19,I7t)),_(1),y("icon",i.faCog),_(2),y("ngIf",i.loading)("ngIfElse",s)}},dependencies:[Ft,At,Mc,T0],encapsulation:2})),e})(),x7t=(()=>{var r;class e{constructor(n,i){u(this,"_themeService",void 0),u(this,"_errorLoggerService",void 0),u(this,"faTwitter",Iee),u(this,"faFacebook",Pee),u(this,"faGithub",Nee),this._themeService=n,this._errorLoggerService=i}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(gv),B(d2))}),u(e,"\u0275cmp",qe({type:r,selectors:[["app-root"]],decls:18,vars:3,consts:function(){let t;return t=$localize`If you like ${"\ufffd#8\ufffd"}:START_TAG_STRONG:EveryBoard${"\ufffd/#8\ufffd"}:CLOSE_TAG_STRONG:, follow us!`,[[1,"container","mt-2"],[1,"footer"],[1,"content","has-text-centered"],t,["href","https://github.com/EveryBoard/EveryBoard"],[3,"icon"],["href","https://twitter.com/EveryBoardGames"],["href","https://facebook.com/EveryBoard"]]},template:function(n,i){1&n&&(F(0,"app-header"),S(1,"main",0),F(2,"router-outlet"),P(),S(3,"footer",1)(4,"div",2)(5,"p")(6,"span"),Ns(7,3),F(8,"strong"),Is(),P(),lt(9," \xa0 "),S(10,"a",4),F(11,"fa-icon",5),P(),lt(12,"\xa0 "),S(13,"a",6),F(14,"fa-icon",5),P(),lt(15,"\xa0 "),S(16,"a",7),F(17,"fa-icon",5),P()()()()),2&n&&(_(11),y("icon",i.faGithub),_(3),y("icon",i.faTwitter),_(3),y("icon",i.faFacebook))},dependencies:[uP,T0,k7t],encapsulation:2})),e})();class Di{constructor(){u(this,"__nominal",void 0)}}var iu;class Jt{static of(e){switch(e){case 0:return Jt.ZERO;case 1:return Jt.ONE;case 2:return Jt.TWO;default:return Ze(3===e,"Invalid Apagos Coord "+e),Jt.THREE}}constructor(e){u(this,"x",void 0),this.x=e}equals(e){return this.x===e.x}}iu=Jt,u(Jt,"encoder",we.tuple([we.identity()],r=>[r.x],r=>iu.of(r[0]))),u(Jt,"ZERO",new iu(0)),u(Jt,"ONE",new iu(1)),u(Jt,"TWO",new iu(2)),u(Jt,"THREE",new iu(3));let su=(()=>{class r{}return u(r,"PIECE_SHOULD_MOVE_DOWNWARD",()=>$localize`Pieces should only move downward!`),u(r,"CANNOT_LAND_ON_A_FULL_SQUARE",()=>$localize`That square is already full, you cannot put a piece in it!`),u(r,"NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE",()=>$localize`You have no pieces in that square, select one that contains at least one of your pieces!`),u(r,"NO_PIECE_REMAINING_TO_DROP",()=>$localize`There are no remaining pieces of that color to drop!`),u(r,"NO_POSSIBLE_TRANSFER_REMAINS",()=>$localize`There is no possible transfer from that square!`),r})();var Hi;class po extends Di{static drop(e,t){return U.getNonNullable(po.ALL_MOVES.find(i=>i.landing.equals(e)&&i.piece.equalsValue(t)&&i.starting.equals(g.empty())))}static transfer(e,t){if(e.x<=t.x)return ie.failure(su.PIECE_SHOULD_MOVE_DOWNWARD());const n=U.getNonNullable(po.ALL_MOVES.find(i=>i.landing.equals(t)&&i.piece.equals(g.empty())&&i.starting.equals(g.of(e))));return ie.success(n)}constructor(e,t,n){super(),u(this,"landing",void 0),u(this,"piece",void 0),u(this,"starting",void 0),this.landing=e,this.piece=t,this.starting=n}isDrop(){return this.piece.isPresent()}toString(){return this.isDrop()?"ApagosMove.drop("+this.piece.get().toString()+" on "+this.landing.x+")":"ApagosMove.slideDown("+this.starting.get().x+" > "+this.landing.x+")"}equals(e){return!1!==this.starting.equals(e.starting)&&!1!==this.landing.equals(e.landing)&&this.piece.equals(e.piece)}}u(po,"ALL_MOVES",[new(Hi=po)(Jt.ZERO,g.of(k.ZERO),g.empty()),new Hi(Jt.ONE,g.of(k.ZERO),g.empty()),new Hi(Jt.TWO,g.of(k.ZERO),g.empty()),new Hi(Jt.THREE,g.of(k.ZERO),g.empty()),new Hi(Jt.ZERO,g.of(k.ONE),g.empty()),new Hi(Jt.ONE,g.of(k.ONE),g.empty()),new Hi(Jt.TWO,g.of(k.ONE),g.empty()),new Hi(Jt.THREE,g.of(k.ONE),g.empty()),new Hi(Jt.TWO,g.empty(),g.of(Jt.THREE)),new Hi(Jt.ONE,g.empty(),g.of(Jt.THREE)),new Hi(Jt.ZERO,g.empty(),g.of(Jt.THREE)),new Hi(Jt.ONE,g.empty(),g.of(Jt.TWO)),new Hi(Jt.ZERO,g.empty(),g.of(Jt.TWO)),new Hi(Jt.ZERO,g.empty(),g.of(Jt.ONE))]),u(po,"encoder",we.tuple([Jt.encoder,g.getEncoder(k.encoder),g.getEncoder(Jt.encoder)],r=>[r.landing,r.piece,r.starting],r=>new Hi(r[0],r[1],r[2])));class Qv{constructor(e){u(this,"turn",void 0),this.turn=e}getCurrentPlayer(){return k.ofTurn(this.turn)}getCurrentOpponent(){return this.turn%2==1?k.ZERO:k.ONE}}let hae;class Ie{static mapBiArray(e,t){const n=[];let i=0;for(;i<e.length;){n[i]=[];let s=0;for(;s<e[i].length;)n[i][s]=t(e[i][s]),s++;i++}return n}static create3DTable(e,t,n,i){const s=[];for(let o=0;o<e;o++)s.push(Ie.createTable(t,n,i));return s}static createTable(e,t,n){const i=[];for(let s=0;s<t;s++)i.push(Ie.createArray(e,n));return i}static createArray(e,t){const n=[];for(let i=0;i<e;i++)n.push(t);return n}static copyBiArray(e){const t=[];let n=0;for(;n<e.length;)t[n]=Ie.copyImmutableArray(e[n]),n++;return t}static copyImmutableArray(e){const t=[];let n=0;for(;n<e.length;)t[n]=e[n],n++;return t}static sortByDescending(e,t){e.sort((n,i)=>{const s=t(n),o=t(i);return s<o?1:s>o?-1:0})}static compareArray(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!1===zo(e[n],t[n]))return!1;return!0}static compareTable(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!1===Ie.compareArray(e[n],t[n]))return!1;return!0}static isPrefix(e,t){return!(e.length>t.length)&&Ie.compareArray(e,t.slice(0,e.length))}static range(e){const t=[];for(let n=0;n<e;n++)t.push(n);return t}static smallerFirst(e,t){return e-t}static getRandomElement(e){return U.assert(e.length>0,"ArrayUtils.getRandomElement must be called on an array containing elements"),e[Math.floor(Math.random()*e.length)]}static maximumsBy(e,t){const n=[];let i=Number.MIN_SAFE_INTEGER;for(let s=0;s<e.length;s++){const o=t(e[s]);o>i&&(i=o,n.push(e[s]))}return n}}hae=Symbol.iterator;class pae{constructor(){u(this,"content",new En)}get(e){const t=this.content.get(e.y);return t.isAbsent()?g.empty():t.get().get(e.x)}set(e,t){const n=this.content.get(e.y);let i;n.isPresent()?i=n.get():(i=new En,this.content.set(e.y,i)),i.set(e.x,t)}[hae](){const e=[],t=this.content.getKeySet().toList();t.sort(Ie.smallerFirst);for(const n of t){const i=this.content.get(n).get(),s=i.getKeySet().toList();s.sort(Ie.smallerFirst);for(const o of s){const a=i.get(o).get();e.push({x:o,y:n,content:a})}}return e.values()}}class Od{static from(e,t,n){if(e+t>n)return ie.failure("invalid starting space");const i=new En([{key:k.ZERO,value:e},{key:k.ONE,value:t},{key:K.NONE,value:n}]);i.makeImmutable();const s=new Od(i);return ie.success(s)}constructor(e){u(this,"containing",void 0),this.containing=e}isFull(){return this.count(k.ZERO)+this.count(k.ONE)>=this.count(K.NONE)}count(e){return this.containing.get(e).get()}addPiece(e){let t=this.count(k.ZERO),n=this.count(k.ONE);const i=this.count(K.NONE);return e===k.ZERO?t++:n++,Od.from(t,n,i).get()}substractPiece(e){let t=this.count(k.ZERO),n=this.count(k.ONE);const i=this.count(K.NONE);return e===k.ZERO?t--:n--,Od.from(t,n,i).get()}getDominatingPlayer(){const e=this.count(k.ZERO),t=this.count(k.ONE);return e>t?k.ZERO:t>e?k.ONE:K.NONE}equals(e){return this.containing.equals(e.containing)}}let Ml=(()=>{class r extends Qv{static getInitialState(){return r.fromRepresentation(0,[[0,0,0,0],[0,0,0,0],[7,5,3,1]],this.PIECES_PER_PLAYER,this.PIECES_PER_PLAYER)}static fromRepresentation(t,n,i,s){const o=[];for(let c=0;c<4;c++){const m=Od.from(n[0][c],n[1][c],n[2][c]).get();o.push(m)}const a=new En;return a.set(k.ZERO,i),a.set(k.ONE,s),new r(t,o,a)}constructor(t,n,i){super(t),u(this,"board",void 0),u(this,"remaining",void 0),this.board=n,this.remaining=i,this.remaining.makeImmutable()}getPieceAt(t){return this.board[t.x]}updateAt(t,n){const i=[];for(let o=0;o<4;o++)i.push(t.x===o?n:this.board[o]);const s=this.getRemainingCopy();return new r(this.turn,i,s)}getRemainingCopy(){return this.remaining.getCopy()}getRemaining(t){return this.remaining.get(t).get()}equals(t){return this.turn===t.turn&&Ie.compareArray(t.board,this.board)&&this.remaining.equals(t.remaining)}}return u(r,"PIECES_PER_PLAYER",10),r})();class q{static fromMove(e,t,n,i,s,o){return new L7t(e,t,n,i,s,o)}static forClick(e,t,n,i,s,o){return new z7t(e,t,n,i,s,o)}static anyMove(e,t,n,i,s){return new R7t(e,t,n,i,s)}static fromPredicate(e,t,n,i,s,o){return new D7t(e,t,n,i,s,o)}static informational(e,t,n){return new H7t(e,t,n)}constructor(e,t,n){u(this,"title",void 0),u(this,"instruction",void 0),u(this,"state",void 0),u(this,"previousMove",g.empty()),this.title=e,this.instruction=t,this.state=n}isMove(){return!1}isAnyMove(){return!1}isClick(){return!1}isPredicate(){return!1}isInformation(){return!1}hasSolution(){return!1}withPreviousMove(e){return this.previousMove=g.of(e),this}}class Jv extends q{constructor(e,t,n,i){super(e,t,n),u(this,"successMessage",void 0),this.successMessage=i}hasSolution(){return!0}getSuccessMessage(){return this.successMessage}}class L7t extends Jv{constructor(e,t,n,i,s,o){super(e,t,n,s),u(this,"acceptedMoves",void 0),u(this,"failureMessage",void 0),this.acceptedMoves=i,this.failureMessage=o,Ze(i.length>0,"TutorialStepMove: At least one accepted move should be provided, otherwise use TutorialStepInformational")}isMove(){return!0}getSolution(){return this.acceptedMoves[0]}getFailureMessage(){return this.failureMessage}}class R7t extends Jv{constructor(e,t,n,i,s){super(e,t,n,s),u(this,"solutionMove",void 0),this.solutionMove=i}getSolution(){return this.solutionMove}isAnyMove(){return!0}}class z7t extends Jv{constructor(e,t,n,i,s,o){super(e,t,n,s),u(this,"acceptedClicks",void 0),u(this,"failureMessage",void 0),this.acceptedClicks=i,this.failureMessage=o}isClick(){return!0}getSolution(){return this.acceptedClicks[0]}getFailureMessage(){return this.failureMessage}}class D7t extends Jv{constructor(e,t,n,i,s,o){super(e,t,n,o),u(this,"solutionMove",void 0),u(this,"predicate",void 0),this.solutionMove=i,this.predicate=s}getSolution(){return this.solutionMove}isPredicate(){return!0}}class H7t extends q{isInformation(){return!0}}class Zn{}class gae extends Zn{constructor(...e){super(...e),u(this,"tutorial",[q.informational($localize`Initial board and object of the game`,$localize`At Apagos, there are 4 squares, each of them has a fixed number of holes for pieces. Each player starts with 10 pieces. Dark pieces belong to the first player, light pieces belong to the second one. The game ends when no one can play. The player owning the most pieces in the rightmost square wins!`,Ml.getInitialState()),q.anyMove($localize`Drop`,$localize`There are two kinds of moves. One is the drop. To do one, you must click on a visible arrow, being of your color or the opponent's. If the chosen square is one of the 3 leftmost ones, it will exchange position with the square on its right.<br/><br/>You're playing Light. Drop a piece on one of those three squares.`,Ml.fromRepresentation(1,[[0,0,0,1],[0,0,0,0],[7,5,3,1]],9,10),po.drop(Jt.ZERO,k.ZERO),$localize`Congratulations!`),q.fromPredicate($localize`Transfer`,$localize`The other kind of move is the transfer.<ol><li>Choose one of your pieces on the board by clicking on the square in which it is.</li><li>Choose its landing square by clicking on one of the arrow to finish the transfer.</li></ol>It can only be done with your pieces, from a higher square to a lower one.<br/><br/>You're playing Dark, do a transfer!`,Ml.fromRepresentation(2,[[0,0,1,0],[0,1,0,0],[7,5,3,1]],9,9),po.transfer(Jt.TWO,Jt.ZERO).get(),(t,n,i)=>t.isDrop()?b.failure($localize`This move is a drop, please do a transfer!`):b.SUCCESS,$localize`Congratulations!`),q.fromPredicate($localize`Victory`,$localize`When you put a last piece into a square, the games end. In this configuration you can win.<br/><br/>You're playing Light, do the winning move!`,Ml.fromRepresentation(3,[[1,0,3,4],[2,1,3,1],[3,1,7,5]],2,3),po.drop(Jt.TWO,k.ONE),(t,n,i)=>t.isDrop()?t.piece.equalsValue(k.ONE)?b.SUCCESS:b.failure($localize`You actively made your opponent win!`):b.failure($localize`Wrong choice, your opponent will win in the next turn no matter which piece is dropped!`),$localize`Congratulations!`)])}}class Jn{static isVictory(e){return e===Number.MAX_SAFE_INTEGER||e===Number.MIN_SAFE_INTEGER}static isPreVictory(e){return e===Number.MAX_SAFE_INTEGER-1||e===Number.MIN_SAFE_INTEGER+1}static of(e,t){return e*=k.ZERO.getScoreModifier(),t*=k.ONE.getScoreModifier(),new Jn(e+t)}constructor(e){u(this,"value",void 0),this.value=e}}var bd,eC,CL;u(Jn,"VICTORIES",[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER]);class _e{static getVictory(e){return e===k.ZERO?_e.ZERO_WON:_e.ONE_WON}static getDefeat(e){return e===k.ZERO?_e.ONE_WON:_e.ZERO_WON}constructor(e,t){u(this,"isEndGame",void 0),u(this,"winner",void 0),this.isEndGame=e,this.winner=t}toBoardValue(){return this.winner.isPlayer()?new Jn(this.winner.getVictoryValue()):new Jn(0)}}u(_e,"ZERO_WON",new(bd=_e)(!0,k.ZERO)),u(_e,"ONE_WON",new bd(!0,k.ONE)),u(_e,"DRAW",new bd(!0,K.NONE)),u(_e,"ONGOING",new bd(!1,K.NONE));let mae=(()=>{class r{}return u(r,"createdNodes",0),r})(),Ho=(eC=class{constructor(e,t=g.empty(),n=g.empty()){u(this,"gameState",void 0),u(this,"parent",void 0),u(this,"previousMove",void 0),u(this,"id",void 0),u(this,"children",new En),u(this,"cache",new En),this.gameState=e,this.parent=t,this.previousMove=n,this.id=CL.ID++,mae.createdNodes++}getChild(e){return this.children.get(e)}hasChildren(){return this.getChildren().length>0}getChildren(){return this.children.listValues()}addChild(e){U.assert(e.previousMove.isPresent(),"GameNode: addChild expects a node with a previous move"),this.children.set(e.previousMove.get(),e)}printDot(e,t,n,i=0,s=0){0===i&&console.log("digraph G {");const o=e.getGameStatus(this);let a="white";if(o.isEndGame)switch(o.winner){case k.ZERO:a="#994d00";break;case k.ONE:a="#ffc34d";break;default:a="grey"}let c=`#${this.gameState.turn}: ${this.id}`;t&&(c+=` - ${t(this)}`),console.log(`    node_${s} [label="${c}", style=filled, fillcolor="${a}"];`);let l=s+1;if(void 0===n||i<n)for(const f of this.children.listValues())console.log(`    node_${s} -> node_${l} [label="${f.previousMove.get()}"];`),l=f.printDot(e,t,n,i+1,l);return 0===i&&console.log("}"),l}getCache(e){return this.cache.get(e)}setCache(e,t){this.cache.containsKey(e)?this.cache.replace(e,t):this.cache.set(e,t)}},CL=eC,u(eC,"ID",0),eC);Ho=CL=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ne.log],Ho);class Yn{constructor(e){u(this,"stateType",void 0),this.stateType=e}choose(e,t){Ne.display("Rules","choose",t.toString()+" was proposed");const n=this.isLegal(t,e.gameState),i=e.getChild(t);if(n.isFailure())return Ne.display("Rules","choose","Move is illegal: "+n.getReason()),g.empty();if(i.isPresent())return U.assert(n.isSuccess(),"Rules.choose: Move is illegal: "+n.getReasonOr("")),Ne.display("Rules","choose","and this proposed move is found in the list, so it is legal"),g.of(i.get());const s=this.applyLegalMove(t,e.gameState,n.get()),o=new Ho(s,g.of(e),g.of(t));return g.of(o)}getInitialNode(){const e=this.stateType.getInitialState();return new Ho(e)}}class r4 extends Yn{static get(){return r4.singleton.isAbsent()&&(r4.singleton=g.of(new r4)),r4.singleton.get()}constructor(){super(Ml)}applyLegalMove(e,t,n){return e.isDrop()?this.applyLegalDrop(e,t):this.applyLegalTransfer(e,t)}applyLegalDrop(e,t){const n=t.getRemainingCopy(),i=n.get(e.piece.get()).get();n.put(e.piece.get(),i-1);const s=new Ml(t.turn+1,t.board,n),o=e.piece.get(),a=s.getPieceAt(e.landing).addPiece(o);if(e.landing===Jt.THREE)return s.updateAt(e.landing,a);{const c=Jt.of(e.landing.x+1),l=s.getPieceAt(c);return s.updateAt(e.landing,l).updateAt(c,a)}}applyLegalTransfer(e,t){const n=t.getCurrentPlayer(),i=e.starting.get(),s=t.getPieceAt(i).substractPiece(n),o=t.getPieceAt(e.landing).addPiece(n);let a=t.updateAt(i,s);return a=a.updateAt(e.landing,o),new Ml(a.turn+1,a.board,a.remaining)}isLegal(e,t){return t.getPieceAt(e.landing).isFull()?b.failure(su.CANNOT_LAND_ON_A_FULL_SQUARE()):e.isDrop()?this.isLegalDrop(e,t):this.isLegalSlideDown(e,t)}isLegalDrop(e,t){return t.getRemaining(e.piece.get())<=0?b.failure(su.NO_PIECE_REMAINING_TO_DROP()):b.SUCCESS}isLegalSlideDown(e,t){const n=t.getCurrentPlayer();return 0===t.getPieceAt(e.starting.get()).count(n)?b.failure(su.NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE()):b.SUCCESS}getGameStatus(e){const t=e.gameState;for(let i=0;i<4;i++)if(!1===t.getPieceAt(Jt.of(i)).isFull())return _e.ONGOING;const n=t.getPieceAt(Jt.THREE).getDominatingPlayer();return Ze(n.isPlayer(),"winner can only be a player if the game is finished"),_e.getVictory(n)}}u(r4,"singleton",g.empty());class yL{static gcd(e,t){return 0===t?Math.abs(e):yL.gcd(t,e%t)}}class St{constructor(e,t){u(this,"x",void 0),u(this,"y",void 0),this.x=e,this.y=t}equals(e){return this.x===e.x&&this.y===e.y}isDiagonalOfLength(e){return Math.abs(this.x)===e&&Math.abs(this.y)===e}toMinimalVector(){const e=yL.gcd(this.x,this.y);return new St(this.x/e,this.y/e)}combine(e,t=1){return new St(this.x+t*e.x,this.y+t*e.y)}toString(){return"("+this.x+", "+this.y+")"}}var M1,hs;class ML extends St{isDown(){return 1===this.y}isUp(){return-1===this.y}isLeft(){return-1===this.x}isRight(){return 1===this.x}toInt(){return 0===this.x&&-1===this.y?0:1===this.x&&0===this.y?1:0===this.x&&1===this.y?2:-1===this.x&&0===this.y?3:-1===this.x&&-1===this.y?4:1===this.x&&-1===this.y?5:-1===this.x&&1===this.y?6:7}toString(){return 0===this.x&&-1===this.y?"UP":1===this.x&&0===this.y?"RIGHT":0===this.x&&1===this.y?"DOWN":-1===this.x&&0===this.y?"LEFT":-1===this.x&&-1===this.y?"UP_LEFT":1===this.x&&-1===this.y?"UP_RIGHT":-1===this.x&&1===this.y?"DOWN_LEFT":"DOWN_RIGHT"}}class EL{from(e,t){for(const n of this.all)if(n.x===e&&n.y===t)return ie.success(n);return ie.failure("Invalid x and y in direction construction")}fromDelta(e,t){return 0===e&&0===t?ie.failure("Empty delta for direction"):Math.abs(e)===Math.abs(t)||0===e||0===t?this.from(Math.sign(e),Math.sign(t)):ie.failure(F7t.DIRECTION_MUST_BE_LINEAR())}fromMove(e,t){return this.fromDelta(t.x-e.x,t.y-e.y)}fromString(e){switch(e){case"UP":return this.from(0,-1);case"RIGHT":return this.from(1,0);case"DOWN":return this.from(0,1);case"LEFT":return this.from(-1,0);case"UP_LEFT":return this.from(-1,-1);case"UP_RIGHT":return this.from(1,-1);case"DOWN_LEFT":return this.from(-1,1);case"DOWN_RIGHT":return this.from(1,1);default:return ie.failure(`Invalid direction string ${e}`)}}fromInt(e){switch(e){case 0:return this.from(0,-1);case 1:return this.from(1,0);case 2:return this.from(0,1);case 3:return this.from(-1,0);case 4:return this.from(-1,-1);case 5:return this.from(1,-1);case 6:return this.from(-1,1);case 7:return this.from(1,1);default:return ie.failure(`Invalid int direction: ${e}`)}}}class Me extends ML{constructor(e,t){super(e,t)}isDiagonal(){return 0!==this.x&&0!==this.y}getOpposite(){return Me.factory.from(-this.x,-this.y).get()}}u(Me,"UP",new(M1=Me)(0,-1)),u(Me,"UP_RIGHT",new M1(1,-1)),u(Me,"RIGHT",new M1(1,0)),u(Me,"DOWN_RIGHT",new M1(1,1)),u(Me,"DOWN",new M1(0,1)),u(Me,"DOWN_LEFT",new M1(-1,1)),u(Me,"LEFT",new M1(-1,0)),u(Me,"UP_LEFT",new M1(-1,-1)),u(Me,"factory",new class extends EL{constructor(...r){super(...r),u(this,"all",[M1.UP,M1.UP_RIGHT,M1.RIGHT,M1.DOWN_RIGHT,M1.DOWN,M1.DOWN_LEFT,M1.LEFT,M1.UP_LEFT])}}),u(Me,"DIRECTIONS",M1.factory.all),u(Me,"DIAGONALS",[M1.UP_RIGHT,M1.DOWN_RIGHT,M1.DOWN_LEFT,M1.UP_LEFT]),u(Me,"ORTHOGONALS",[M1.UP,M1.RIGHT,M1.DOWN,M1.LEFT]),u(Me,"encoder",we.fromFunctions(r=>r.toString(),r=>(Ze("string"==typeof r,"Invalid encoded direction"),M1.factory.fromString(r).get())));class ze extends ML{constructor(e,t){super(e,t)}getOpposite(){return ze.factory.from(-this.x,-this.y).get()}rotateClockwise(){return ze.factory.from(-this.y,this.x).get()}}u(ze,"UP",new(hs=ze)(0,-1)),u(ze,"RIGHT",new hs(1,0)),u(ze,"DOWN",new hs(0,1)),u(ze,"LEFT",new hs(-1,0)),u(ze,"factory",new class extends EL{constructor(...r){super(...r),u(this,"all",[hs.UP,hs.RIGHT,hs.DOWN,hs.LEFT])}from(r,e){return 0===r&&-1===e?ie.success(hs.UP):1===r&&0===e?ie.success(hs.RIGHT):0===r&&1===e?ie.success(hs.DOWN):-1===r&&0===e?ie.success(hs.LEFT):ie.failure("Invalid orthogonal from x and y")}}),u(ze,"ORTHOGONALS",hs.factory.all),u(ze,"encoder",we.fromFunctions(r=>r.toString(),r=>(Ze("string"==typeof r,"Invalid encoded orthogonal"),hs.factory.fromString(r).get())));let F7t=(()=>{class r{}return u(r,"DIRECTION_MUST_BE_LINEAR",()=>$localize`You must move in a straight line! You can only move orthogonally or diagonally!`),r})();var SL;let ou=(()=>{class r{}return u(r,"OUT_OF_RANGE",e=>`The coordinate ${e.toString()} is not on the board`),r})();class C extends St{static getEncoder(e){return we.tuple([we.identity(),we.identity()],t=>[t.x,t.y],t=>e(t[0],t[1]))}constructor(e,t){super(e,t)}getNext(e,t){const n=this.combine(e,t);return new C(n.x,n.y)}getPrevious(e,t){return this.getNext(e,-(t=t??1))}getLeft(e){return new C(this.x+e.y,this.y+-e.x)}getRight(e){return new C(this.x+-e.y,this.y+e.x)}isInRange(e,t){return!(this.x<0||this.y<0||this.x>=e||this.y>=t)}isNotInRange(e,t){return this.x<0||this.y<0||this.x>=e||this.y>=t}getDirectionToward(e){return Me.factory.fromMove(this,e)}getOrthogonalDistance(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}getDistance(e){if(!1===e.isAlignedWith(this))throw new Error("Cannot calculate distance with non aligned coords.");const t=Math.abs(e.x-this.x),n=Math.abs(e.y-this.y);return Math.max(t,n)}isHexagonallyAlignedWith(e){const t=this.x-e.x,n=this.y-e.y;return t!==n&&(t===-n||t*n==0)}isAlignedWith(e){const t=Math.abs(this.x-e.x),n=Math.abs(this.y-e.y);return t===n||t*n==0}getVectorToward(e){return new St(e.x-this.x,e.y-this.y)}toVector(){return new St(this.x,this.y)}getCoordsToward(e){if(e.equals(this))return[];if(!1===e.isAlignedWith(this))return[];const t=this.getDirectionToward(e).get();let n=this.getNext(t,1);const i=[];for(;!1===n.equals(e);)i.push(n),n=n.getNext(t,1);return i}getUntil(e){const t=[],n=this.getDirectionToward(e).get();let i=this.getNext(n);for(;!1===i.equals(e);)t.push(i),i=i.getNext(n);return t}equals(e){return this===e||e.x===this.x&&e.y===this.y}compareTo(e){return e.y===this.y?e.x===this.x?0:this.x<e.x?-1:1:this.y<e.y?-1:1}toSVGPoint(){return this.x+","+this.y}}u(C,"encoder",(SL=C).getEncoder((r,e)=>new SL(r,e)));class _ae{constructor(){u(this,"ArrayUtils",Ie)}getPlayerClass(e){switch(e){case k.ZERO:return"player0-fill";case k.ONE:return"player1-fill";default:return U.expectToBe(e,K.NONE),""}}}let El=(()=>{var r;class e extends _ae{constructor(n){super(),u(this,"messageDisplayer",void 0),u(this,"encoder",void 0),u(this,"Player",k),u(this,"SPACE_SIZE",100),u(this,"STROKE_WIDTH",8),u(this,"SMALL_STROKE_WIDTH",2),u(this,"rules",void 0),u(this,"node",void 0),u(this,"availableAIs",void 0),u(this,"canPass",!1),u(this,"scores",g.empty()),u(this,"imagesLocation","assets/images/"),u(this,"hasAsymmetricBoard",!1),u(this,"rotation",""),u(this,"tutorial",void 0),u(this,"isPlayerTurn",void 0),u(this,"chooseMove",void 0),u(this,"canUserPlay",void 0),u(this,"cancelMoveOnWrapper",void 0),u(this,"role",void 0),this.messageDisplayer=n}message(n){this.messageDisplayer.gameMessage(n)}cancelMove(n){var i=this;return M(function*(){return i.cancelMoveAttempt(),i.cancelMoveOnWrapper(n),i.node.previousMove.isPresent()&&(yield i.showLastMove(i.node.previousMove.get())),null==n?b.SUCCESS:(i.messageDisplayer.gameMessage(n),b.failure(n))})()}cancelMoveAttempt(){}pass(){var n=this;return M(function*(){return d2.logError("GameComponent","pass() called on a game that does not redefine it",{gameName:n.constructor.name})})()}getTurn(){return this.node.gameState.turn}getCurrentPlayer(){return this.node.gameState.getCurrentPlayer()}getCurrentOpponent(){return this.node.gameState.getCurrentOpponent()}getState(){return this.node.gameState}getPreviousState(){return this.node.parent.get().gameState}showLastMove(n){return M(function*(){})()}hideLastMove(){}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(Ut))}),u(e,"\u0275cmp",qe({type:r,selectors:[["ng-component"]],features:[Qe],decls:0,vars:0,template:function(n,i){},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})(),au=(()=>{var r;class e extends El{constructor(...n){super(...n),u(this,"hexaLayout",void 0),u(this,"hexaBoard",void 0)}getHexaPointsAtXY(n,i){const s=new C(n,i);return this.getHexaPointsAt(s)}getHexaPointsAt(n){return this.hexaLayout.getHexaPointsAt(n)}getCenterAtXY(n,i){const s=new C(n,i);return this.getCenterAt(s)}getCenterAt(n){return this.hexaLayout.getCenterAt(n)}}return r=e,u(e,"\u0275fac",function(){let t;return function(i){return(t||(t=or(r)))(i||r)}}()),u(e,"\u0275cmp",qe({type:r,selectors:[["ng-component"]],features:[Qe],decls:0,vars:0,template:function(n,i){},encapsulation:2})),e})();var wd,p2;class Ce{static of(e){switch(e){case Ce.ZERO.value:return Ce.ZERO;case Ce.ONE.value:return Ce.ONE;case Ce.EMPTY.value:return Ce.EMPTY;case Ce.UNREACHABLE.value:return Ce.UNREACHABLE;default:throw new Error("FourStatePiece has no value matching "+e)}}static ofPlayer(e){return e===k.ZERO?Ce.ZERO:(U.expectToBe(e,k.ONE),Ce.ONE)}constructor(e){u(this,"value",void 0),this.value=e}equals(e){return this===e}is(e){return this.value===e.value}isPlayer(){return this===Ce.ZERO||this===Ce.ONE}}u(Ce,"ZERO",new(wd=Ce)(k.ZERO.value)),u(Ce,"ONE",new wd(k.ONE.value)),u(Ce,"EMPTY",new wd(K.NONE.value)),u(Ce,"UNREACHABLE",new wd(3));class be extends ML{static getAngle(e){switch(e){case be.UP:return 0;case be.UP_RIGHT:return 60;case be.RIGHT:return 120;case be.DOWN:return 180;case be.DOWN_LEFT:return 240;default:return U.expectToBe(e,be.LEFT),300}}constructor(e,t){super(e,t)}getOpposite(){return be.factory.from(-this.x,-this.y).get()}}u(be,"UP",new(p2=be)(0,-1)),u(be,"LEFT",new p2(-1,0)),u(be,"UP_RIGHT",new p2(1,-1)),u(be,"DOWN_LEFT",new p2(-1,1)),u(be,"RIGHT",new p2(1,0)),u(be,"DOWN",new p2(0,1)),u(be,"factory",new class extends EL{constructor(...r){super(...r),u(this,"all",[p2.UP,p2.UP_RIGHT,p2.RIGHT,p2.DOWN,p2.DOWN_LEFT,p2.LEFT])}}),u(be,"encoder",we.fromFunctions(r=>{switch(r){case p2.UP:return 0;case p2.UP_RIGHT:return 1;case p2.RIGHT:return 2;case p2.DOWN:return 3;case p2.DOWN_LEFT:return 4;default:return 5}},r=>(U.assert(0<=r&&r<=5,"Invalid encoded number for HexaDirection "+r),p2.factory.all[r])));class yae{constructor(){u(this,"startAngle",void 0),u(this,"conversionMatrix",void 0),u(this,"inverseConversionMatrix",void 0)}}class tC extends yae{constructor(){super(),u(this,"startAngle",.5),u(this,"conversionMatrix",[Math.sqrt(3),Math.sqrt(3)/2,0,1.5]),u(this,"inverseConversionMatrix",[Math.sqrt(3)/3,-1/3,0,2/3])}}u(tC,"INSTANCE",new tC);class Br extends yae{constructor(){super(),u(this,"startAngle",0),u(this,"conversionMatrix",[1.5,0,Math.sqrt(3)/2,Math.sqrt(3)]),u(this,"inverseConversionMatrix",[2/3,0,-1/3,Math.sqrt(3)/3])}isOnBorder(e,t){return this.isOnTopRightBorder(e,t)||this.isOnRightBorder(e,t)||this.isOnBottomRightBorder(e,t)||this.isOnBottomLeftBorder(e,t)||this.isOnLeftBorder(e,t)||this.isOnTopLeftBorder(e,t)}isOnTopRightBorder(e,t){return 0===t.y}isOnRightBorder(e,t){return t.x===e.width-1}isOnLeftBorder(e,t){return 0===t.x}isOnBottomLeftBorder(e,t){return t.y===e.height-1}isOnTopLeftBorder(e,t){return null!=e.excludedSpaces[t.y]?t.x===e.excludedSpaces[t.y]:t.y===e.excludedSpaces.length&&0===t.x}isOnBottomRightBorder(e,t){return null!=e.excludedSpaces[e.height-1-t.y]?e.width-1-t.x===e.excludedSpaces[e.height-1-t.y]:e.height-1-t.y===e.excludedSpaces.length&&t.x===e.width-1}getAllBorders(e){const t=[];return e.forEachCoord((n,i)=>{this.isOnBorder(e,n)&&t.push(n)}),t}isTopCorner(e,t){return this.isOnTopLeftBorder(e,t)&&this.isOnTopRightBorder(e,t)}isTopLeftCorner(e,t){return this.isOnTopLeftBorder(e,t)&&this.isOnLeftBorder(e,t)}isTopRightCorner(e,t){return this.isOnTopRightBorder(e,t)&&this.isOnRightBorder(e,t)}isBottomCorner(e,t){return this.isOnBottomLeftBorder(e,t)&&this.isOnBottomRightBorder(e,t)}isBottomLeftCorner(e,t){return this.isOnBottomLeftBorder(e,t)&&this.isOnLeftBorder(e,t)}isBottomRightCorner(e,t){return this.isOnBottomRightBorder(e,t)&&this.isOnRightBorder(e,t)}}u(Br,"INSTANCE",new Br);class cu{constructor(e,t,n){u(this,"size",void 0),u(this,"origin",void 0),u(this,"orientation",void 0),this.size=e,this.origin=t,this.orientation=n}getCenterAt(e){const t=this.orientation.conversionMatrix;return new C(this.size*(t[0]*e.x+t[1]*e.y)+this.origin.x,this.size*(t[2]*e.x+t[3]*e.y)+this.origin.y)}getCornerOffset(e){const t=2*Math.PI*(this.orientation.startAngle+e)/6;return new C(this.size*Math.cos(t),this.size*Math.sin(t))}getHexaPointsListAt(e){const t=this.getCenterAt(e),n=[];for(let i=0;i<6;i+=1){const s=this.getCornerOffset(i);n.push(new C(t.x+s.x,t.y+s.y))}return n}getHexaPointsAt(e){return this.getHexaPointsListAt(e).map(n=>n.toSVGPoint()).join(" ")}getIsoPoints(e,t){U.assert(this.orientation===Br.INSTANCE,"HexaLayout.getIsoPoints can only be used with flat orientation");const n=this.getCenterAt(e),i=this.getCornerOffset(0),s=this.getCornerOffset(1),o=this.getCornerOffset(2),a=this.getCornerOffset(3);return[[new C(n.x+a.x,n.y+a.y),new C(n.x+a.x,n.y+a.y+t),new C(n.x+o.x,n.y+o.y+t),new C(n.x+o.x,n.y+o.y)],[new C(n.x+i.x,n.y+i.y),new C(n.x+i.x,n.y+i.y+t),new C(n.x+s.x,n.y+s.y+t),new C(n.x+o.x,n.y+o.y+t),new C(n.x+o.x,n.y+o.y),new C(n.x+s.x,n.y+s.y)],[new C(n.x+a.x,n.y+a.y),new C(n.x+a.x,n.y+a.y+t),new C(n.x+o.x,n.y+o.y+t),new C(n.x+s.x,n.y+s.y+t),new C(n.x+i.x,n.y+i.y+t),new C(n.x+i.x,n.y+i.y),new C(n.x+s.x,n.y+s.y),new C(n.x+o.x,n.y+o.y)]]}}let Mae,Re=(()=>{class r{}return u(r,"CANNOT_CHOOSE_OPPONENT_PIECE",()=>$localize`You cannot pick a piece of the opponent.`),u(r,"MUST_CLICK_ON_EMPTY_SPACE",()=>$localize`You must click on an empty space.`),u(r,"MUST_CLICK_ON_EMPTY_SQUARE",()=>$localize`You must click on an empty square.`),u(r,"SHOULD_LAND_ON_EMPTY_OR_OPPONENT_SPACE",()=>$localize`Your landing space should be empty or contain a piece of the opponent.`),u(r,"CANNOT_SELF_CAPTURE",()=>$localize`You cannot capture your own pieces.`),u(r,"MUST_CHOOSE_PLAYER_PIECE",()=>$localize`You must pick one of your pieces.`),u(r,"CANNOT_PASS",()=>$localize`You cannot pass your turn.`),u(r,"MUST_LAND_ON_EMPTY_SPACE",()=>$localize`You must drop your piece on an empty space.`),u(r,"MUST_PASS",()=>$localize`You must pass your turn.`),u(r,"MUST_CHOOSE_OWN_PIECE_NOT_EMPTY",()=>$localize`You have selected an empty space, you must select one of your own pieces.`),u(r,"MOVE_CANNOT_BE_STATIC",()=>$localize`You must choose different starting and ending coordinates.`),u(r,"SOMETHING_IN_THE_WAY",()=>$localize`There is a piece between the piece you chose and its landing space.`),r})(),Sl=(()=>{class r{}return u(r,"CANNOT_MOVE_MORE_THAN_THREE_PIECES",()=>$localize`You cannot move more than 3 of your pieces!`),u(r,"NOT_ENOUGH_PIECE_TO_PUSH",()=>$localize`You don't have enough pieces to push that group!`),u(r,"CANNOT_PUSH_YOUR_OWN_PIECES",()=>$localize`You cannot push this piece because it is blocked by one of yours!`),u(r,"MUST_ONLY_TRANSLATE_YOUR_PIECES",()=>$localize`This line contains pieces of your opponent or empty spaces, which is forbidden.`),u(r,"TRANSLATION_IMPOSSIBLE",()=>$localize`This move is impossible, some landing spaces are occupied.`),u(r,"LINE_AND_COORD_NOT_ALIGNED",()=>$localize`This space is not aligned with the current line.`),r})();Mae=Symbol.iterator;class W1 extends Qv{constructor(e,t){super(t),u(this,"board",void 0),this.board=e}getPieceAt(e){if(this.isOnBoard(e))return this.board[e.y][e.x];throw new Error("Accessing coord not on board "+e+".")}tryToGetPieceAt(e){return this.isOnBoard(e)?g.of(this.board[e.y][e.x]):g.empty()}isOnBoard(e){return e.isInRange(this.board[0].length,this.board.length)}getPieceAtXY(e,t){return this.getPieceAt(new C(e,t))}forEachCoord(e){for(const{coord:t,content:n}of this.getCoordsAndContents())e(t,n)}getCoordsAndContents(){const e=[];for(let t=0;t<this.board.length;t++)for(let n=0;n<this.board[t].length;n++){const i=new C(n,t);this.isOnBoard(i)&&e.push({coord:i,content:this.getPieceAt(i)})}return e}getCopiedBoard(){return Ie.copyBiArray(this.board)}toMap(){const e=[];for(let t=0;t<this.board.length;t++)for(let n=0;n<this.board[0].length;n++){const i=new C(n,t);e.push({key:i,value:this.getPieceAt(i)})}return e}[Mae](){const e=[];for(const t of this.board)e.push(...t);return e.values()}}class Vi extends W1{static getInitialState(){const e=Ce.EMPTY,t=Ce.UNREACHABLE,n=Ce.ZERO,i=Ce.ONE;return new Vi([[t,t,t,t,i,i,i,i,i],[t,t,t,i,i,i,i,i,i],[t,t,e,e,i,i,i,e,e],[t,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,t],[e,e,n,n,n,e,e,t,t],[n,n,n,n,n,n,t,t,t],[n,n,n,n,n,t,t,t,t]],0)}static isOnBoard(e){return e.isInRange(9,9)&&Vi.getInitialState().getPieceAt(e)!==Ce.UNREACHABLE}isPiece(e){return this.getPieceAt(e).isPlayer()}getScores(){const e=[14,14];for(let t=0;t<9;t++)for(let n=0;n<9;n++)this.getPieceAtXY(n,t)===Ce.ZERO&&(e[1]=e[1]-1),this.getPieceAtXY(n,t)===Ce.ONE&&(e[0]=e[0]-1);return e}}class br extends Di{static getFallibleEncoder(e){return we.tuple([C.encoder],t=>[t.coord],t=>e(t[0]).get())}static getEncoder(e){return we.tuple([C.encoder],t=>[t.coord],t=>e(t[0]))}constructor(e,t){super(),u(this,"coord",void 0),this.coord=new C(e,t)}equals(e){return this===e||this.coord.equals(e.coord)}}var Eae;class D2 extends br{static fromSingleCoord(e,t){try{return ie.success(new D2(e,t,g.empty()))}catch(n){return ie.failure(n.message)}}static fromDoubleCoord(e,t,n){const i=[e,t];Ie.sortByDescending(i,D2.sortCoord);const s=i[1].getDirectionToward(i[0]).get(),o=be.factory.fromDelta(s.x,s.y);if(o.isFailure())return ie.failure("Invalid direction");const a=o.get();return i[1].getDistance(i[0])>2?ie.failure("Distance between first coord and last coord is too big"):a.equals(n)?D2.fromSingleCoord(i[1],n):a.getOpposite().equals(n)?D2.fromSingleCoord(i[0],n):ie.success(new D2(i[1],n,g.of(i[0])))}static sortCoord(e){return 9*e.y+e.x}constructor(e,t,n){if(super(e.x,e.y),u(this,"dir",void 0),u(this,"lastPiece",void 0),this.dir=t,this.lastPiece=n,e.isNotInRange(9,9))throw new Error("Coord "+e.toString()+" out of range, invalid move!")}toString(){return this.isSingleCoord()?"AbaloneMove("+this.coord.x+", "+this.coord.y+", "+this.dir.toString()+")":"AbaloneMove("+this.coord.toString()+" > "+this.lastPiece.get().toString()+", "+this.dir.toString()+")"}isSingleCoord(){return this.lastPiece.isAbsent()}equals(e){return e.coord.equals(this.coord)&&e.dir.equals(this.dir)&&e.lastPiece.equals(this.lastPiece)}}Eae=D2,u(D2,"encoder",we.tuple([C.encoder,be.encoder,g.getEncoder(C.encoder)],r=>[r.coord,r.dir,r.lastPiece],r=>new Eae(r[0],r[1],r[2])));class Vo extends Yn{static get(){return Vo.singleton.isAbsent()&&(Vo.singleton=g.of(new Vo)),Vo.singleton.get()}constructor(){super(Vi)}static isLegalRealPush(e,t,n,i,s){let o=0;const a=Ce.ofPlayer(n.getCurrentOpponent()),c=Ce.ofPlayer(n.getCurrentPlayer());for(;o<i&&n.isOnBoard(e)&&n.getPieceAt(e)===a;)o++,e=e.getNext(t.dir);return o>=i?ie.failure(Sl.NOT_ENOUGH_PIECE_TO_PUSH()):Vi.isOnBoard(e)&&(n.getPieceAt(e)===Ce.EMPTY&&(s[e.y][e.x]=a),n.getPieceAt(e)===c)?ie.failure(Sl.CANNOT_PUSH_YOUR_OWN_PIECES()):ie.success(s)}static getGameStatus(e){const t=e.gameState.getScores();return t[0]>5?_e.ZERO_WON:t[1]>5?_e.ONE_WON:_e.ONGOING}applyLegalMove(e,t,n){return new Vi(n,t.turn+1)}isLegal(e,t){const n=this.getFirstPieceValidity(e,t);return n.isFailure()?n.toOtherFallible():e.isSingleCoord()?this.isLegalPush(e,t):this.isLegalSideStep(e,t)}getFirstPieceValidity(e,t){const n=t.getPieceAt(e.coord);return!1===t.isPiece(e.coord)?b.failure(Re.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):n===Ce.ofPlayer(t.getCurrentOpponent())?b.failure(Re.CANNOT_CHOOSE_OPPONENT_PIECE()):b.SUCCESS}isLegalPush(e,t){let n=1,i=e.coord.getNext(e.dir);const s=Ce.ofPlayer(t.getCurrentPlayer()),o=Ce.EMPTY,a=t.getCopiedBoard();for(a[e.coord.y][e.coord.x]=o;n<=3&&t.isOnBoard(i)&&t.getPieceAt(i)===s;)n++,i=i.getNext(e.dir);return n>3?ie.failure(Sl.CANNOT_MOVE_MORE_THAN_THREE_PIECES()):!1===Vi.isOnBoard(i)||(a[i.y][i.x]=s,t.getPieceAt(i)===o)?ie.success(a):Vo.isLegalRealPush(i,e,t,n,a)}isLegalSideStep(e,t){let n=e.lastPiece.get();const i=e.coord.getDirectionToward(n).get();n=n.getNext(i);let s=e.coord;const o=Ce.ofPlayer(t.getCurrentPlayer()),a=t.getCopiedBoard();for(;!1===s.equals(n)&&Vi.isOnBoard(s);){if(t.getPieceAt(s)!==o)return ie.failure(Sl.MUST_ONLY_TRANSLATE_YOUR_PIECES());const c=s.getNext(e.dir);if(a[s.y][s.x]=Ce.EMPTY,Vi.isOnBoard(c)){if(t.isPiece(c))return ie.failure(Sl.TRANSLATION_IMPOSSIBLE());t.getPieceAt(c)===Ce.EMPTY&&(a[c.y][c.x]=o)}s=s.getNext(i)}return ie.success(a)}getGameStatus(e){return Vo.getGameStatus(e)}}u(Vo,"singleton",g.empty());const en=Ce.EMPTY,t2=Ce.UNREACHABLE,Fo=Ce.ZERO,lu=Ce.ONE;class Sae extends Zn{constructor(...e){super(...e),u(this,"tutorial",[q.informational($localize`Initial board and object of the game`,$localize`At Abalone, the goal of the game is to be the first player to push 6 opponent's pieces out of the board. Let us see how!`,Vi.getInitialState()),q.anyMove($localize`Moving a piece`,$localize`At each turn, move one, two, or three pieces either along their line, or on their side.
        For your moves you can therefore choose between up to 6 directions.
        The pieces you move must be aligned and consecutive, and the move should land on an empty space (except to push, we will see that later).
        To make a move, click on one of your pieces, then click on an arrow to choose the move direction.<br/><br/>
        You're playing Dark, make any move!`,Vi.getInitialState(),D2.fromSingleCoord(new C(2,6),be.UP).get(),$localize`Congratulations!`),q.fromMove($localize`Pushing`,$localize`To push one opponent piece, you must move at least two of your pieces.
        To push two opponent pieces, you must move three of your pieces.
        If one of your pieces is in the way, it will be impossible to push.
        You cannot move more than three pieces.<br/><br/>
        Only one push towards the right is possible here, find it. (You're playing Dark).`,new Vi([[t2,t2,t2,t2,en,Fo,Fo,lu,lu],[t2,t2,t2,en,en,en,en,en,en],[t2,t2,en,Fo,Fo,Fo,lu,Fo,en],[t2,en,en,en,en,en,en,en,en],[en,en,en,en,Fo,Fo,Fo,lu,lu],[en,en,en,en,en,en,en,en,t2],[en,en,en,en,Fo,lu,en,t2,t2],[en,en,en,Fo,en,en,t2,t2,t2],[en,en,Fo,en,en,t2,t2,t2,t2]],0),[D2.fromSingleCoord(new C(4,4),be.RIGHT).get()],$localize`Congratulations! You know everything you need to start a game!`,$localize`Failed. Try again.`)])}}class Kn{constructor(e,t,n){u(this,"name",void 0),u(this,"moveGenerator",void 0),u(this,"rules",void 0),u(this,"explorationParameter",Math.sqrt(2)),u(this,"maxGameLength",8),u(this,"availableOptions",[]),this.name=e,this.moveGenerator=t,this.rules=n;for(let i=1;i<10;i++)this.availableOptions.push({name:i*i+" seconds",maxSeconds:i*i})}chooseNextMove(e,t){U.assert(!1===this.rules.getGameStatus(e).isEndGame,"cannot search from a finished game");const n=e.gameState.getCurrentPlayer(),i=Date.now(),s=Date.now()+1e3*t.maxSeconds;let o=0;for(;Date.now()<s;){const f=this.expand(this.select({node:e,path:[e]})),d=this.simulate(f.node,s);this.backpropagate(f.path,this.winScore(d,n)),o++}Ne.display("MCTS","chooseNextMove","root winRatio: "+this.winRatio(e)),Ne.display("MCTS","chooseNextMove","children winRatio: "+e.getChildren().map(f=>f.id+": "+this.winRatio(f)));const a=Ie.maximumsBy(e.getChildren(),f=>this.winRatio(f)),c=Ie.getRandomElement(a),l=(Date.now()-i)/1e3;return Ne.display("MCTS","chooseNextMove",`Computed ${o} in ${l} (rate: ${o/l} it/s)`),Ne.display("MCTS","chooseNextMove","Best child has a win ratio of: "+this.winRatio(c)),c.previousMove.get()}winScore(e,t){switch(e){case _e.DRAW:case _e.ONGOING:return.5;default:return e.winner===t?1:0}}ucb(e,t){const n=this.simulations(e);return 0===t||0===n?Number.MAX_SAFE_INTEGER:this.wins(e)/n+this.explorationParameter*Math.sqrt(Math.log(t)/n)}winRatio(e){const t=this.simulations(e);return 0===this.simulations(e)?1:this.wins(e)/t}wins(e){return this.getCounterFromCache(e,"wins")}simulations(e){return this.getCounterFromCache(e,"simulations")}getCounterFromCache(e,t){const n=e.getCache(t);return n.isPresent()?n.get():(e.setCache(t,0),0)}select(e){const t=e.node;if(Ne.display("MCTS","select","Exploring node: "+t.id),t.hasChildren()){const n=this.simulations(t);Ne.display("MCTS","select","UCB values: "+t.getChildren().map(o=>o.id+": "+this.ucb(t,n)));const i=Ie.maximumsBy(t.getChildren(),o=>this.ucb(o,n)),s=Ie.getRandomElement(i);return Ne.display("MCTS","select","selecting children "+s.id),this.select({node:s,path:e.path.concat([s])})}return Ne.display("MCTS","select","this is a leaf node, we select it"),e}expand(e){if(this.rules.getGameStatus(e.node).isEndGame)return e;const t=e.node,n=this.moveGenerator.getListMoves(t);U.assert(n.length>0,`${this.name}: move generator did not return any move on a non-finished game: ${this.moveGenerator.constructor.name}`);for(const s of n)t.addChild(this.play(t,s));const i=Ie.getRandomElement(t.getChildren());return{node:i,path:e.path.concat([i])}}simulate(e,t){Ne.display("MCTS","simulate","simulate from node which has a last move of "+e.previousMove.get().toString());let n=e,i=0;for(;i<this.maxGameLength&&Date.now()<t;){const s=this.rules.getGameStatus(n);if(s.isEndGame)return Ne.display("MCTS","simulate",`end game in ${i} steps, winner is ${s.winner}`),s;i++,n=this.playRandomStep(n)}return _e.ONGOING}playRandomStep(e){const t=Ie.getRandomElement(this.moveGenerator.getListMoves(e));return this.play(e,t)}play(e,t){const n=this.rules.isLegal(t,e.gameState);U.assert(n.isSuccess(),"heuristic returned illegal move");const i=this.rules.applyLegalMove(t,e.gameState,n.get());return new Ho(i,g.of(e),g.of(t))}backpropagate(e,t){for(const n of e)this.addSimulationResult(n,t),Ne.display("MCTS","backpropagate","backpropagate to node which now has "+this.wins(n)/this.simulations(n))}addSimulationResult(e,t){const n=this.simulations(e)+1,i=this.wins(e)+t;e.setCache("wins",i),e.setCache("simulations",n)}getInfo(e){return`wins/simulations=${this.getCounterFromCache(e,"wins")}/${this.getCounterFromCache(e,"simulations")}`}}class wa{}class fr extends wa{getBoardValue(e){const t=this.getMetrics(e);return Jn.of(t[0],t[1])}}class PL extends fr{getMetrics(e){return[0,0]}}class on{constructor(e,t,n,i){u(this,"name",void 0),u(this,"rules",void 0),u(this,"heuristic",void 0),u(this,"moveGenerator",void 0),u(this,"random",!1),u(this,"prune",!0),u(this,"availableOptions",[]),this.name=e,this.rules=t,this.heuristic=n,this.moveGenerator=i;for(let s=1;s<10;s++)this.availableOptions.push({name:`Level ${s}`,maxDepth:s})}toString(){return this.name}chooseNextMove(e,t){U.assert(!1===this.rules.getGameStatus(e).isEndGame,"Minimax has been asked to choose a move from a finished game");let n=this.alphaBeta(e,t.maxDepth,Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER);for(;n.gameState.turn>e.gameState.turn+1;)n=n.parent.get();return n.previousMove.get()}alphaBeta(e,t,n,i){if(t<1)return e;if(this.rules.getGameStatus(e).isEndGame)return e;const s=this.getPossibleMoves(e);U.assert(s.size()>0,"Minimax "+this.name+" should give move, received none!");const o=this.getBestChildren(e,s,t,n,i),a=this.getBestChildAmong(o),c=this.getScore(a);return this.setScore(e,c),a}getPossibleMoves(e){const t=this.getMoves(e);if(t.isAbsent()){const n=this.moveGenerator.getListMoves(e);return this.setMoves(e,new dt(n)),new dt(n)}return t.get()}getBestChildren(e,t,n,i,s){let o=[];const a=e.gameState.getCurrentPlayer();let c=a===k.ZERO?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER;const l=a===k.ZERO?(f,d)=>f<d:(f,d)=>d<f;for(const f of t){const d=this.getOrCreateChild(e,f),m=this.alphaBeta(d,n-1,i,s),E=this.getScore(m).value;if(l(E,c)||0===o.length?(c=E,o=[m]):E===c&&o.push(m),this.prune&&l(c,a===k.ZERO?i:s))break;a===k.ZERO?s=Math.min(c,s):i=Math.max(c,i)}return o}getBestChildAmong(e){return this.random?Ie.getRandomElement(e):e[0]}getOrCreateChild(e,t){const n=e.getChild(t);if(n.isAbsent()){const i=this.rules.isLegal(t,e.gameState),s=t.toString();U.assert(i.isSuccess(),'The minimax "'+this.name+'" has proposed an illegal move ('+s+"), refusal reason: "+i.getReasonOr("")+" this should not happen.");const o=this.rules.applyLegalMove(t,e.gameState,i.get()),a=new Ho(o,g.of(e),g.of(t));return e.addChild(a),this.setScore(a,this.computeBoardValue(a)),a}return n.get()}setScore(e,t){e.setCache(this.name+"-score",t)}getScore(e){const t=e.getCache(this.name+"-score");if(t.isPresent())return t.get();{const n=this.computeBoardValue(e);return this.setScore(e,n),n}}computeBoardValue(e){const t=this.rules.getGameStatus(e);return t.isEndGame?t.toBoardValue():this.heuristic.getBoardValue(e)}setMoves(e,t){e.setCache(this.name+"-moves",t)}getMoves(e){return e.getCache(this.name+"-moves")}getInfo(e){return"BoardValue="+this.heuristic.getBoardValue(e).value}}class $7t extends fr{getMetrics(e){return e.gameState.getScores()}}class Un{}let G7t=(()=>{class r{}return u(r,"aiTime",0),r})();class Pae extends Un{getListMoves(e){const t=[],n=e.gameState,i=n.getCurrentPlayer();for(let s=0;s<9;s++)for(let o=0;o<9;o++){const a=new C(o,s);if(!1!==n.getPieceAt(a).is(i))for(const c of be.factory.all){const l=D2.fromSingleCoord(a,c).get();if(this.isAcceptablePush(l,n)){t.push(l);for(const f of be.factory.all)for(let d=1;d<=2&&!f.equals(c);d++){const m=a.getNext(f,d);if(!Vi.isOnBoard(m))break;{const E=D2.fromDoubleCoord(a,m,c).get();Vo.get().isLegal(E,n).isSuccess()&&t.push(E)}}}}}return new dt(t).toList()}isAcceptablePush(e,t){const n=t.getScores(),i=Vo.get().isLegal(e,t);if(i.isSuccess()){const s=t.getCurrentOpponent().value;return!(new Vi(i.get(),t.turn+1).getScores()[s]>n[s])}return!1}}function B7t(r,e){if(1&r){const t=pe();N(),S(0,"circle",6),W("click",function(){te(t);const i=p(2).index,s=p().index;return ne(p().onPieceClick(i,s))}),P()}if(2&r){const t=p(2).index,n=p().index,i=p();ye("id","piece_",t,"_",n,""),y("ngClass",i.getPieceClasses(t,n)),I("cx",i.getCenterAtXY(t,n).x)("cy",i.getCenterAtXY(t,n).y)("r",.5*i.SPACE_SIZE)}}function U7t(r,e){if(1&r){const t=pe();N(),S(0,"g")(1,"polygon",4),W("click",function(){te(t);const i=p().index,s=p().index;return ne(p().onSpaceClick(i,s))}),P(),T(2,B7t,1,6,"circle",5),P()}if(2&r){const t=p(),n=t.index,i=t.$implicit,s=p().index,o=p();_(1),ye("id","space_",n,"_",s,""),y("ngClass",o.getSquareClasses(n,s)),I("points",o.getHexaPointsAtXY(n,s)),_(1),y("ngIf",o.isPiece(i))}}function W7t(r,e){if(1&r&&(N(),S(0,"g"),T(1,U7t,3,5,"g",3),P()),2&r){const t=e.$implicit,n=p(2);_(1),y("ngIf",n.isBoard(t))}}function q7t(r,e){if(1&r&&(N(),S(0,"g"),T(1,W7t,2,1,"g",1),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function j7t(r,e){1&r&&(N(),S(0,"marker",7),F(1,"polygon",8),P()),2&r&&zn("id","arrowhead_",e.$implicit.dir.toString(),"")}function Z7t(r,e){if(1&r){const t=pe();N(),S(0,"g"),F(1,"line",9),S(2,"line",10),W("click",function(){const s=te(t).$implicit;return ne(p().chooseDirection(s.dir))}),P(),S(3,"polygon",11),W("click",function(){const s=te(t).$implicit;return ne(p().chooseDirection(s.dir))}),P()()}if(2&r){const t=e.$implicit;_(1),zn("id","line_start_",t.dir.toString(),""),I("x1",t.startCenter.x)("y1",t.startCenter.y)("x2",t.middle.x)("y2",t.middle.y),_(1),zn("id","line_end_",t.dir.toString(),""),I("x1",t.middle.x)("y1",t.middle.y)("x2",t.landingCenter.x)("y2",t.landingCenter.y),_(1),zn("id","direction_",t.dir.toString(),""),I("transform",t.transformation)}}class Y7t{constructor(e,t,n,i,s,o){u(this,"startCenter",void 0),u(this,"middle",void 0),u(this,"landingCenter",void 0),u(this,"landing",void 0),u(this,"dir",void 0),u(this,"transformation",void 0),this.startCenter=e,this.middle=t,this.landingCenter=n,this.landing=i,this.dir=s,this.transformation=o}}let K7t=(()=>{var r;class e extends au{constructor(n){super(n),u(this,"moveds",[]),u(this,"directions",[]),u(this,"selecteds",[]),this.rules=Vo.get(),this.node=this.rules.getInitialNode(),this.availableAIs=[new on($localize`Score`,this.rules,new $7t,new Pae),new Kn($localize`MCTS`,new Pae,this.rules)],this.encoder=D2.encoder,this.tutorial=(new Sae).tutorial,this.scores=g.of([0,0]),this.SPACE_SIZE=30,this.hexaLayout=new cu(this.SPACE_SIZE,new C(-8*this.SPACE_SIZE,2*this.SPACE_SIZE),tC.INSTANCE)}updateBoard(n){var i=this;return M(function*(){i.hexaBoard=i.getState().getCopiedBoard(),i.scores=g.of(i.getState().getScores())})()}hideLastMove(){this.moveds=[]}cancelMoveAttempt(){this.directions=[],this.selecteds=[]}showLastMove(n){var i=this;return M(function*(){n.isSingleCoord()?i.showPushingMove(n):i.showSideStepMove(n)})()}showPushingMove(n){const i=this.getPreviousState();let s=n.coord;for(this.moveds=[s],s=s.getNext(n.dir);Vi.isOnBoard(s)&&i.isPiece(s);)this.moveds.push(s),s=s.getNext(n.dir);Vi.isOnBoard(s)&&this.moveds.push(s)}showSideStepMove(n){let i=n.lastPiece.get();const s=n.coord.getDirectionToward(i).get();i=i.getNext(s);let o=n.coord;for(;!1===o.equals(i);)this.moveds.push(o),this.moveds.push(o.getNext(n.dir)),o=o.getNext(s)}onPieceClick(n,i){var s=this;return M(function*(){const o=yield s.canUserPlay("#piece_"+n+"_"+i);if(o.isFailure())return s.cancelMove(o.getReason());const a=s.getState().getCurrentOpponent();return s.hexaBoard[i][n].is(a)?s.opponentClick(n,i):0===s.selecteds.length?s.firstClick(n,i):1===s.selecteds.length?s.secondClick(n,i):s.thirdClick(n,i)})()}opponentClick(n,i){var s=this;return M(function*(){return(yield s.tryChoosingDirection(n,i)).isSuccess()?b.SUCCESS:s.cancelMove(Re.CANNOT_CHOOSE_OPPONENT_PIECE())})()}firstClick(n,i){var s=this;return M(function*(){return s.selecteds=[new C(n,i)],s.showPossibleDirections(),b.SUCCESS})()}showPossibleDirections(){this.directions=[],this.showDirection(1===this.selecteds.length)}showDirection(n){const i=this.getState(),s=Ce.ofPlayer(i.getCurrentPlayer()),o=this.selecteds[0],a=this.selecteds[this.selecteds.length-1];for(const c of be.factory.all){let f,l=o.getNext(c,1);if(i.isOnBoard(l)&&i.getPieceAt(l)===s){if(n)continue;if(l=a.getNext(c,1),i.isOnBoard(l)&&i.getPieceAt(l)===s)continue}if(f=n?D2.fromSingleCoord(o,c).get():D2.fromDoubleCoord(o,a,c).get(),this.rules.isLegal(f,i).isSuccess()){const m=this.getCenterAt(o),E=this.getCenterAt(l),w=this.getMiddleOfArrow(c,l,E),R=E.x+" "+E.y,$="rotate("+(be.getAngle(c)+150)+" "+R+")",ve=new Y7t(m,w,E,l,c,$+" translate("+R+")");this.directions.push(ve)}}}getMiddleOfArrow(n,i,s){const o=i.getPrevious(n),a=this.getCenterAt(o);return new C(a.x+(s.x-a.x)/2,a.y+(s.y-a.y)/2)}isBoard(n){return n!==Ce.UNREACHABLE}isPiece(n){return n!==Ce.EMPTY}secondClick(n,i){var s=this;return M(function*(){const o=s.selecteds[0],a=new C(n,i);if(a.equals(o))return s.cancelMoveAttempt(),b.SUCCESS;if(!1===a.isHexagonallyAlignedWith(o))return s.cancelMoveAttempt(),s.firstClick(n,i);const c=a.getDistance(o);if(c>2)return s.cancelMove(Sl.CANNOT_MOVE_MORE_THAN_THREE_PIECES());const l=o.getDirectionToward(a).get();s.selecteds=[o];for(let f=0;f<c;f++)s.selecteds.push(o.getNext(l,f+1));if(3===s.selecteds.length){const f=s.selecteds[1],d=s.getState().getCurrentPlayer();if(!1===s.hexaBoard[f.y][f.x].is(d))return s.cancelMoveAttempt(),s.firstClick(n,i)}return s.showPossibleDirections(),b.SUCCESS})()}thirdClick(n,i){var s=this;return M(function*(){const o=new C(n,i),a=s.selecteds[0];if(o.equals(a))return s.deselectExtremity(!0);const c=s.selecteds[s.selecteds.length-1];return o.equals(c)?s.deselectExtremity(!1):3===s.selecteds.length&&o.equals(s.selecteds[1])?(s.cancelMoveAttempt(),b.SUCCESS):s.tryExtension(o,a,c)})()}tryExtension(n,i,s){var o=this;return M(function*(){const a=Me.factory.fromMove(i,n);if(a.isSuccess()){const l=Me.factory.fromMove(s,n);if(a.equals(l)){const f=i.getDistance(n),d=s.getDistance(n);return 2===Math.max(f,d)?(o.selecteds.push(n),Ie.sortByDescending(o.selecteds,D2.sortCoord),o.showPossibleDirections(),b.SUCCESS):o.cancelMove(Sl.CANNOT_MOVE_MORE_THAN_THREE_PIECES())}}const c=yield o.cancelMove(Sl.LINE_AND_COORD_NOT_ALIGNED());return yield o.firstClick(n.x,n.y),c})()}deselectExtremity(n){var i=this;return M(function*(){return i.selecteds=i.selecteds.slice(n?1:0,n?void 0:-1),i.showPossibleDirections(),b.SUCCESS})()}chooseDirection(n){var i=this;return M(function*(){const s=yield i.canUserPlay("#direction_"+n.toString());return s.isFailure()?i.cancelMove(s.getReason()):i._chooseDirection(n)})()}_chooseDirection(n){var i=this;return M(function*(){const s=i.selecteds[0];if(1===i.selecteds.length){const o=D2.fromSingleCoord(s,n).get();return i.chooseMove(o)}{const a=D2.fromDoubleCoord(s,i.selecteds[i.selecteds.length-1],n).get();return i.chooseMove(a)}})()}onSpaceClick(n,i){var s=this;return M(function*(){const o=yield s.canUserPlay("#space_"+n+"_"+i);return o.isFailure()?s.cancelMove(o.getReason()):s.tryChoosingDirection(n,i)})()}tryChoosingDirection(n,i){var s=this;return M(function*(){const o=new C(n,i);for(const a of s.directions)if(a.landing.equals(o))return s._chooseDirection(a.dir);return b.failure("not a direction")})()}getSquareClasses(n,i){const s=new C(n,i),o=[];return this.moveds.some(a=>a.equals(s))&&o.push("moved-fill"),o}getPieceClasses(n,i){const s=new C(n,i),o=k.of(this.hexaBoard[i][n].value),a=[this.getPlayerClass(o)];return this.selecteds.some(c=>c.equals(s))&&a.push("selected-stroke"),a}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(Ut))}),u(e,"\u0275cmp",qe({type:r,selectors:[["app-abalone"]],features:[Qe],decls:5,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-165 0 470 500","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto",3,"id",4,"ngFor","ngForOf"],[4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass","click"],["class","base",3,"id","ngClass","click",4,"ngIf"],[1,"base",3,"id","ngClass","click"],["markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto",3,"id"],["points","0 0, 10 3.5, 0 7"],[1,"arrow",3,"id"],[1,"arrow",3,"id","click"],["points","-10 -5, 10 -5, 0 15, -10 -5",1,"arrow",3,"id","click"]],template:function(n,i){1&n&&(N(),S(0,"svg",0),T(1,q7t,2,1,"g",1),S(2,"defs"),T(3,j7t,2,1,"marker",2),P(),T(4,Z7t,4,12,"g",1),P()),2&n&&(_(1),y("ngForOf",i.hexaBoard),_(2),y("ngForOf",i.directions),_(1),y("ngForOf",i.directions))},dependencies:[Ft,Wt,At],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();class X7t extends fr{getMetrics(e){const t=e.gameState.board[3].getDominatingPlayer(),n=[0,0];return t.isPlayer()&&(n[t.value]=1),n}}class Tae extends Un{getListMoves(e){const t=e.gameState;return po.ALL_MOVES.filter(function n(i){return r4.get().isLegal(i,t).isSuccess()})}}function Q7t(r,e){if(1&r&&(N(),F(0,"circle",5)),2&r){const t=e.$implicit,n=p();I("cx",n.getRemainingPieceCx(t))("cy",n.PIECE_RADIUS)("r",n.PIECE_RADIUS-5)}}function J7t(r,e){if(1&r&&(N(),F(0,"circle",6)),2&r){const t=e.$implicit,n=p();I("cx",n.BOARD_WIDTH-n.getRemainingPieceCx(t))("cy",n.BOARD_HEIGHT-n.PIECE_RADIUS)("r",n.PIECE_RADIUS-5)}}function eft(r,e){if(1&r){const t=pe();N(),S(0,"polygon",9),W("click",function(){te(t);const i=p().index,s=p();return ne(s.onArrowClick(i,s.PlayerOrNone.ZERO))}),P()}if(2&r){const t=p().index,n=p();zn("id","dropArrow_zero_",t,""),y("ngClass",n.getArrowClasses(t,n.PlayerOrNone.ZERO)),I("points",n.ARROW_COORD)("transform","translate("+n.SPACE_SIZE/2+" "+-n.SPACE_SIZE/2+")")}}function tft(r,e){if(1&r){const t=pe();N(),S(0,"polygon",9),W("click",function(){te(t);const i=p().index,s=p();return ne(s.onArrowClick(i,s.PlayerOrNone.ONE))}),P()}if(2&r){const t=p().index,n=p();zn("id","dropArrow_one_",t,""),y("ngClass",n.getArrowClasses(t,n.PlayerOrNone.ONE)),I("points",n.ARROW_COORD)("transform","translate(0 "+-n.SPACE_SIZE/2+")")}}function nft(r,e){if(1&r){const t=pe();N(),Gt(0),S(1,"circle",10),W("click",function(){te(t);const i=p().index;return ne(p().onSquareClick(i))}),P(),Bt()}if(2&r){const t=e.$implicit,n=p(),i=n.index,s=n.$implicit,o=p();_(1),wi("id","square_",i,"_piece_",t,"_out_of_",s.count(o.PlayerOrNone.NONE),""),y("ngClass",o.getPieceClasses(i,t,s)),I("cx",o.getCircleCenter(i,t,s).x)("cy",o.getCircleCenter(i,t,s).y)}}function rft(r,e){if(1&r){const t=pe();N(),S(0,"g"),T(1,eft,1,4,"polygon",7),T(2,tft,1,4,"polygon",7),S(3,"rect",8),W("click",function(){const s=te(t).index;return ne(p().onSquareClick(s))}),P(),T(4,nft,2,6,"ng-container",4),P()}if(2&r){const t=e.$implicit,n=e.index,i=p();I("transform",i.getBlockTransform(n)),_(1),y("ngIf",i.canDisplayArrow(n,i.PlayerOrNone.ZERO)),_(1),y("ngIf",i.canDisplayArrow(n,i.PlayerOrNone.ONE)),_(1),zn("id","square_",n,""),y("ngClass",i.getSquareClasses(n)),I("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),_(1),y("ngForOf",i.ArrayUtils.range(t.count(i.PlayerOrNone.NONE)))}}let Oae,ift=(()=>{var r;class e extends El{static getArrowCoord(){return"12.5,0 37.5,0 37.5,25 50,25 25,50 0,25 12.5,25"}constructor(n){super(n),u(this,"PlayerOrNone",K),u(this,"BOARD_WIDTH",4*this.SPACE_SIZE),u(this,"BOARD_HEIGHT",4.5*this.SPACE_SIZE),u(this,"board",void 0),u(this,"remainingZero",void 0),u(this,"remainingOne",void 0),u(this,"ARROW_COORD",e.getArrowCoord()),u(this,"PIECES_PER_PLAYER",Ml.PIECES_PER_PLAYER),u(this,"PIECE_RADIUS",void 0),u(this,"movedSquare",void 0),u(this,"selectedPiece",g.empty()),u(this,"leftPiece",g.empty()),u(this,"droppedPiece",g.empty()),u(this,"displayableArrow",[]),this.rules=r4.get(),this.node=this.rules.getInitialNode(),this.hasAsymmetricBoard=!0,this.availableAIs=[new on($localize`Minimax`,this.rules,new X7t,new Tae),new Kn($localize`MCTS`,new Tae,this.rules)],this.encoder=po.encoder,this.tutorial=(new gae).tutorial,this.PIECE_RADIUS=2*this.SPACE_SIZE/(this.PIECES_PER_PLAYER+.5)}cancelMoveAttempt(){this.selectedPiece=g.empty(),this.showPossibleDrops()}updateBoard(n){var i=this;return M(function*(){const s=i.getState();i.board=s.board,i.remainingZero=s.remaining.get(k.ZERO).get(),i.remainingOne=s.remaining.get(k.ONE).get(),i.hideLastMove(),i.showPossibleDrops()})()}hideLastMove(){this.movedSquare=[],this.droppedPiece=g.empty(),this.leftPiece=g.empty(),this.selectedPiece=g.empty()}showLastMove(n){var i=this;return M(function*(){n.isDrop()?i.showLastDrop(n):i.showLastTransfer(n)})()}showLastDrop(n){const i=n.piece.get();let s=n.landing.x;this.movedSquare=[s],3!==n.landing.x&&(s+=1,this.movedSquare.push(s));const a=this.getLowestPlayerPiece(this.board[s],i);this.droppedPiece=g.of({square:s,piece:a})}getLowestPlayerPiece(n,i){const s=n.count(i);return i===k.ZERO?s-1:n.count(K.NONE)-s}showLastTransfer(n){const i=this.getPreviousState(),s=i.getCurrentPlayer(),o=n.starting.get().x,c=this.getLowestPlayerPiece(i.board[o],s);this.leftPiece=g.of({square:o,piece:c});const l=n.landing.x,d=this.getLowestPlayerPiece(this.board[l],s);this.droppedPiece=g.of({square:l,piece:d})}showPossibleDrops(){this.displayableArrow=[];const n=this.getState();for(let i=0;i<4;i++)!1===n.board[i].isFull()&&(n.remaining.get(k.ZERO).get()>0&&this.displayableArrow.push({x:i,player:k.ZERO}),n.remaining.get(k.ONE).get()>0&&this.displayableArrow.push({x:i,player:k.ONE}))}getCircleCenter(n,i,s){const o=this.SPACE_SIZE/2,a=this.SPACE_SIZE/2;if(1===s.count(K.NONE))return new C(o,a);const c=s.count(K.NONE),l=2*i*Math.PI/c-Math.PI/2,f=.3*this.SPACE_SIZE,d=f*Math.cos(l),m=f*Math.sin(l);return new C(o+d,a+m)}canDisplayArrow(n,i){return this.displayableArrow.some(s=>s.x===n&&s.player.equals(i))}getArrowClasses(n,i){return[this.getPlayerClass(i)]}getBlockTransform(n){return"translate("+n*this.SPACE_SIZE+", "+((3-n)*this.SPACE_SIZE+.5*this.SPACE_SIZE)+")"}getSquareClasses(n){const i=["base"];return this.selectedPiece.isPresent()&&this.selectedPiece.get().square===n?i.push("selected-stroke"):this.movedSquare.includes(n)&&i.push("last-move-stroke"),i}onArrowClick(n,i){var s=this;return M(function*(){const o=i===k.ZERO?"zero":"one",a=yield s.canUserPlay("#dropArrow_"+o+"_"+n);if(a.isFailure())return s.cancelMove(a.getReason());const c=Jt.of(n);if(s.selectedPiece.isPresent()){const l=s.selectedPiece.get().square,f=po.transfer(Jt.of(l),c).get();return s.chooseMove(f)}{const l=po.drop(c,i);return s.chooseMove(l)}})()}getPieceClasses(n,i,s){const o={square:n,piece:i},a=[];let c=s.count(k.ZERO),l=s.count(k.ONE);if(this.selectedPiece.equalsValue(o))a.push("selected-stroke");else if(this.droppedPiece.equalsValue(o))a.push("last-move-stroke");else if(this.leftPiece.isPresent()&&this.leftPiece.get().square===n){if(this.leftPiece.get().piece===i)return a.push("captured-stroke"),a;this.getState().getCurrentOpponent()===k.ZERO?c++:l++}const f=s.count(K.NONE)-(l+c),d=this.getPieceColor(i,c,f);return""!==d&&a.push(d),a}getPieceColor(n,i,s){return n<i?"player0-fill":n>=i+s?"player1-fill":""}onSquareClick(n){var i=this;return M(function*(){const s=yield i.canUserPlay("#square_"+n);if(s.isFailure())return i.cancelMove(s.getReason());if(i.selectedPiece.isPresent()&&i.selectedPiece.get().square===n)return i.cancelMoveAttempt(),b.SUCCESS;const o=i.getState().getCurrentPlayer(),a=i.board[n];return a.count(o)<=0?i.cancelMove(su.NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE()):(i.selectedPiece=g.of({square:n,piece:i.getLowestPlayerPiece(a,o)}),0===i.showAndGetPossibleTranfers().length?i.cancelMove(su.NO_POSSIBLE_TRANSFER_REMAINS()):b.SUCCESS)})()}showAndGetPossibleTranfers(){this.displayableArrow=[];let n=this.selectedPiece.get().square-1;const i=this.getState().getCurrentPlayer();for(;0<=n;)!1===this.board[n].isFull()&&this.displayableArrow.push({x:n,player:i}),n--;return this.displayableArrow}getRemainingPieceCx(n){return(n+.5)*this.PIECE_RADIUS*1.5}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(Ut))}),u(e,"\u0275cmp",qe({type:r,selectors:[["app-apagos"]],features:[Qe],decls:6,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["class","base mid-stroke player1-fill",4,"ngFor","ngForOf"],["class","base mid-stroke player0-fill",4,"ngFor","ngForOf"],["id","board"],[4,"ngFor","ngForOf"],[1,"base","mid-stroke","player1-fill"],[1,"base","mid-stroke","player0-fill"],["class","base mid-stroke",3,"id","ngClass","click",4,"ngIf"],["x","0","y","0",1,"base","mid-stroke",3,"id","ngClass","click"],[1,"base","mid-stroke",3,"id","ngClass","click"],["r","10",1,"base","mid-stroke",3,"id","ngClass","click"]],template:function(n,i){1&n&&(N(),S(0,"svg",0)(1,"g"),T(2,Q7t,1,3,"circle",1),T(3,J7t,1,3,"circle",2),P(),S(4,"g",3),T(5,rft,5,8,"g",4),P()()),2&n&&(I("viewBox",-i.STROKE_WIDTH/2+" "+-i.STROKE_WIDTH/2+" "+(i.BOARD_WIDTH+i.STROKE_WIDTH)+" "+(i.BOARD_HEIGHT+i.STROKE_WIDTH)),_(1),I("transform","rotate("+180*i.role.value+" "+i.BOARD_WIDTH/2+" "+i.BOARD_HEIGHT/2+")"),_(1),y("ngForOf",i.ArrayUtils.range(i.remainingOne)),_(1),y("ngForOf",i.ArrayUtils.range(i.remainingZero)),_(2),y("ngForOf",i.board))},dependencies:[Ft,Wt,At],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})(),Sn=(()=>{class r extends W1{static getInitialState(){const t=Ie.createTable(r.WIDTH,2,4);return new r(t,0,[0,0])}constructor(t,n,i){super(t,n),u(this,"scores",void 0),this.scores=i}getScoresCopy(){return[this.scores[0],this.scores[1]]}equals(t){return!1!==Ie.compareTable(this.board,t.board)&&!1!==Ie.compareArray(this.scores,t.scores)&&this.turn===t.turn}getCurrentPlayerY(){return this.getCurrentOpponent().value}getOpponentY(){return this.getCurrentPlayer().value}}return u(r,"WIDTH",6),r})(),uu=(()=>{class r{}return u(r,"MUST_DISTRIBUTE_YOUR_OWN_HOUSES",()=>$localize`You must distribute one of your houses.`),u(r,"MUST_CHOOSE_NON_EMPTY_HOUSE",()=>$localize`You should choose a non-empty house to distribute.`),u(r,"SHOULD_DISTRIBUTE",()=>$localize`You should feed but you do not.`),r})();class ps extends Yn{static isStarving(e,t){let n=0;const i=e.getOpponent().value;for(;n<Sn.WIDTH;)if(t[i][n++]>0)return!1;return!0}constructor(e){super(Sn),u(this,"config",void 0),this.config=e}mustMansoon(e){const t=e.getCopiedBoard(),n=e.getCurrentOpponent(),i=e.getCurrentPlayer();if(this.config.mustFeed){if(ps.isStarving(i,t)&&!1===this.canDistribute(n,t))return n}else{if(ps.isStarving(n,t))return i;if(ps.isStarving(i,t))return n}return K.NONE}getGameStatus(e){const t=e.gameState;return t.scores[0]>24?_e.ZERO_WON:t.scores[1]>24?_e.ONE_WON:24===t.scores[0]&&24===t.scores[1]?_e.DRAW:_e.ONGOING}applyLegalMove(e,t,n){const i=this.distributeMove(e,t),s=this.applyCapture(i);let o=s.resultingState;const a=this.mustMansoon(o);return a!==K.NONE&&(o=this.monsoon(a,s).resultingState),new Sn(o.board,o.turn+1,o.scores)}distributeHouse(e,t,n){let i=new C(e,t);const s=n.getCopiedBoard(),o=n.getCurrentPlayer(),a=new C(e,t);let c=s[t][e];const l=[];s[t][e]=0;let f=0,d=!1,m=!1;for(;c>0;){d=m,m=!1;const E=this.getNextCoord(i,o,d);m=E.isAbsent(),m?(f++,c--,l.push(ps.FAKE_STORE_COORD.get(o).get())):(i=E.get(),(!1===a.equals(i)||this.config.feedOriginalHouse)&&(s[i.y][i.x]+=1,l.push(i),c--))}return{filledCoords:l,passedByKalahNTimes:f,endsUpInKalah:m,resultingState:new Sn(s,n.turn,n.getScoresCopy())}}getNextCoord(e,t,n){return 0===e.y?e.x===Sn.WIDTH-1?this.config.passByPlayerStore&&t===k.ONE&&!1===n?g.empty():g.of(new C(e.x,1)):g.of(new C(e.x+1,e.y)):0===e.x?this.config.passByPlayerStore&&t===k.ZERO&&!1===n?g.empty():g.of(new C(e.x,0)):g.of(new C(e.x-1,e.y))}doesDistribute(e,t,n){return 0===t?n[t][e]>Sn.WIDTH-1-e:n[t][e]>e}canDistribute(e,t){for(let n=0;n<Sn.WIDTH;n++)if(this.doesDistribute(n,e.getOpponent().value,t))return!0;return!1}monsoon(e,t){const n=t.resultingState,i=n.getCopiedBoard(),s=n.getScoresCopy();let o=0;const a=Ie.copyBiArray(t.captureMap);let c=0;const l=e.getOpponent().value;for(;c<Sn.WIDTH;)o+=i[l][c],a[l][c]+=i[l][c],i[l][c]=0,c++;return s[e.value]+=o,{capturedSum:o,captureMap:a,resultingState:new Sn(i,n.turn,s)}}}u(ps,"FAKE_STORE_COORD",new ru([{key:k.ZERO,value:new C(-1,-1)},{key:k.ONE,value:new C(2,2)}]));class i4 extends ps{static get(){return i4.singleton.isAbsent()&&(i4.singleton=g.of(new i4)),i4.singleton.get()}constructor(){super({passByPlayerStore:!1,mustFeed:!0,feedOriginalHouse:!1})}distributeMove(e,t){const n=t.getCurrentPlayerY();return this.distributeHouse(e.x,n,t)}applyCapture(e){const t=e.filledCoords,n=t[t.length-1];return this.captureIfLegal(n.x,n.y,e.resultingState)}isLegal(e,t){const n=t.getCurrentOpponent(),i=t.getCurrentPlayerY(),s=e.x;if(0===t.getPieceAtXY(s,i))return b.failure(uu.MUST_CHOOSE_NON_EMPTY_HOUSE());const o=ps.isStarving(n,t.board),a=!1===this.doesDistribute(s,i,t.board);return o&&a?b.failure(uu.SHOULD_DISTRIBUTE()):b.SUCCESS}capture(e,t,n){const i=n.getCurrentPlayerY();U.assert(t!==i,"AwaleRules.capture cannot capture the players house");const s=n.getCopiedBoard();let o=s[t][e],a=0;const c=[[0,0,0,0,0,0],[0,0,0,0,0,0]];if(o<2||o>3)return{capturedSum:0,captureMap:c,resultingState:n};let l=-1,f=-1;n.getCurrentPlayer()===k.ONE&&(l=1,f=Sn.WIDTH);do{c[t][e]=o,a+=o,s[t][e]=0,o=s[t][e+=l]}while(e!==f&&(2===o||3===o));const d=n.getScoresCopy();return d[n.getCurrentPlayer().value]+=a,{capturedSum:a,captureMap:c,resultingState:new Sn(s,n.turn,d)}}captureIfLegal(e,t,n){const i=n.getCurrentPlayer(),s={capturedSum:0,resultingState:n,captureMap:[[0,0,0,0,0,0],[0,0,0,0,0,0]]};if(t===i.getOpponent().value)return s;{const o=this.capture(e,t,n),a=ps.isStarving(i.getOpponent(),o.resultingState.board);return o.capturedSum>0&&a?s:o}}}var Pl,Tl;u(i4,"singleton",g.empty());class d1{static of(e){switch(e){case 0:return d1.ZERO;case 1:return d1.ONE;case 2:return d1.TWO;case 3:return d1.THREE;case 4:return d1.FOUR;default:return U.expectToBe(e,5,"Invalid x for AwaleMove: "+e),d1.FIVE}}constructor(e){u(this,"x",void 0),this.x=e}equals(e){return e===this||e.x===this.x}}Pl=d1,u(d1,"encoder",we.tuple([we.identity()],r=>[r.x],r=>Pl.of(r[0]))),u(d1,"ZERO",new Pl(0)),u(d1,"ONE",new Pl(1)),u(d1,"TWO",new Pl(2)),u(d1,"THREE",new Pl(3)),u(d1,"FOUR",new Pl(4)),u(d1,"FIVE",new Pl(5)),Oae=Symbol.iterator;class bae extends Di{constructor(e){super(),u(this,"distributions",void 0),this.distributions=e}[Oae](){return this.distributions.values()}}class g1 extends bae{static of(e){switch(e){case 0:return g1.ZERO;case 1:return g1.ONE;case 2:return g1.TWO;case 3:return g1.THREE;case 4:return g1.FOUR;default:return U.expectToBe(e,5,"Invalid x for AwaleMove: "+e),g1.FIVE}}constructor(e){super([d1.of(e)]),u(this,"x",void 0),this.x=e}equals(e){return e===this||e.x===this.x}toString(){return"AwaleMove("+this.x+")"}}u(g1,"ZERO",new(Tl=g1)(0)),u(g1,"ONE",new Tl(1)),u(g1,"TWO",new Tl(2)),u(g1,"THREE",new Tl(3)),u(g1,"FOUR",new Tl(4)),u(g1,"FIVE",new Tl(5)),u(g1,"encoder",we.tuple([we.identity()],r=>[r.x],r=>Tl.of(r[0])));let wae=(()=>{class r{}return u(r,"SOWING",e=>q.fromMove($localize`Sowing`,$localize`The main move in Mancala games is sowing, let's see how seeds are sown. As you are playing Dark, the 6 houses on the bottom are yours.<br/><br>Click on the rightmost bottom house to sow the seeds it contains: they will be sown clockwise, one seed per house.<br/><br/>Click on the rightmost house!`,Sn.getInitialState(),[e],$localize`Look at the 4 houses that follow clockwise the one you picked, they now contain 5 seeds. This is how seeds are sown: one by one from the house next to the one they come from, clockwise.`,$localize`Failed. Choose the rightmost house on the bottom.`)),r})();class Aae extends Zn{constructor(...e){super(...e),u(this,"gameName",$localize`Awal`),u(this,"tutorial",[q.informational(this.gameName,$localize`${this.gameName} is a Mancala. Mancala is the name of a family of board games that dates back at least to the third century. Mancalas are games of distribution (sowing) and capture. Their goal is to capture the most seeds. The spaces in Mancalas are called the houses. The ones on the extreme left and right are called the stores, they contain the seeds that each player won. As you are playing Dark, the 6 houses on the bottom are yours.`,Sn.getInitialState()),q.informational($localize`Awal`,$localize`Bonus fact: Awal is the most common of all Mancalas.`,Sn.getInitialState()),wae.SOWING(g1.FIVE),q.anyMove($localize`Big sowing`,$localize`When there are enough seeds to make a full turn, something else happens.<br/><br/>
        You're playing Dark.
        Sow the house that contains 12 seeds.`,new Sn([[0,0,0,0,0,0],[0,12,0,0,0,0]],0,[0,0]),g1.ONE,$localize`See, the house that you sowed has not been refilled, and the sowing immediately continued to the next house (which therefore contains two seeds).`),q.fromMove($localize`Simple capture`,$localize`After sowing, if the last seed falls in an opponent's house and if there is now two or three seeds in this house, the player captures these two or three seeds.<br/><br/>You're playing Dark, do a capture!`,new Sn([[0,1,0,0,1,0],[2,0,0,0,1,0]],0,[0,0]),[g1.ZERO],$localize`Well done! This was a simple capture, now let us see how to make multiple captures.`,$localize`Failed. Try again and sow from the leftmost house.`),q.fromMove($localize`Multiple captures`,$localize`By sowing from your leftmost house, you will end in the opponent's second leftmost house, which now contains 2 seeds, so this will be a capture. But now, the house right before it contains 3 seeds, which is also capturable, so, that house will get captured as well!<br/><br/>You're playing Dark, do a capture!`,new Sn([[2,1,0,0,1,0],[2,0,0,0,1,0]],0,[0,0]),[g1.ZERO],$localize`Nice, you win 3 points from the first house, and 2 from the second!`,$localize`Failed. Try again.`),q.fromMove($localize`Interrupted capture`,$localize`By clicking on your leftmost house, you end up on the 3rd house, which is capturable.<br/><br/>You're playing Dark, do a capture!`,new Sn([[1,0,1,0,0,1],[3,0,0,0,1,0]],0,[0,0]),[g1.ZERO],$localize`Notice that because the second house was not capturable, the capture was interrupted and you have not captured the first house.`,$localize`Failed. Try again.`),q.fromMove($localize`Capture on the other side only`,$localize`You're playing Dark. Try to capture the two leftmost houses of the opponent.`,new Sn([[2,2,0,0,1,0],[1,3,0,0,0,0]],0,[0,0]),[g1.ONE],$localize`Congratulations! Notice that the capture was interrupted when entering your territory: you cannot capture your own houses!`,$localize`You have only captured one house, try again!`),q.fromMove($localize`Do not starve`,$localize`You have a very nice capture that seems possible: it seems that you can capture all the opponent's seeds!<br/><br/>You're playing Dark. Try it.`,new Sn([[1,1,1,1,1,0],[5,0,0,1,0,0]],0,[0,0]),[g1.ZERO],$localize`Sadly, you cannot capture here, otherwise the opponent could not play after you.
        When this happens, the move can be made, but no capture takes place!`,$localize`Failed. Try again.`),q.anyMove($localize`Feeding is mandatory`,$localize`You cannot let another player starve, meaning that if your opponent has no seeds anymore and if you can give them at least one, you have to do it.<br/><br/>You're playing Dark. Give a seed to your opponent!`,new Sn([[0,0,0,0,0,0],[0,1,2,4,4,5]],0,[0,0]),g1.THREE,$localize`Congratulations! Note that you can choose to give your opponent the least number of seeds if it is better for you.
        It is often a good way to have easy captures!`),q.anyMove($localize`End of the game`,$localize`A game is won as soon as one player has captured 25 seeds, as that player has more than half of all the seeds.<br/><br/>You're playing Dark, sow the leftmost house.`,new Sn([[4,4,3,2,1,0],[1,0,0,0,0,0]],0,[23,10]),g1.ZERO,$localize`Also, as soon as on player cannot play, the other player captures all the seeds in its own side. Here, it was the first player's turn, and the second player has taken all the remaining seeds.`)])}}let Fi=(()=>{var r;class e extends El{constructor(...n){super(...n),u(this,"board",void 0)}getViewBox(){return-.5*this.STROKE_WIDTH+" "+-.5*this.STROKE_WIDTH+" "+(this.board.length*this.SPACE_SIZE+this.STROKE_WIDTH)+" "+(this.board[0].length*this.SPACE_SIZE+this.STROKE_WIDTH)}}return r=e,u(e,"\u0275fac",function(){let t;return function(i){return(t||(t=or(r)))(i||r)}}()),u(e,"\u0275cmp",qe({type:r,selectors:[["ng-component"]],features:[Qe],decls:0,vars:0,template:function(n,i){},encapsulation:2})),e})();function Nae(r){return 1e3*r.seconds+r.nanoseconds/1e6}function Iae(r,e){return Nae(e)-Nae(r)}class TL{static sleep(e){return M(function*(){return new Promise(t=>{window.setTimeout(t,e)})})()}}class sft extends fr{getMetrics(e){const t=e.gameState.getScoresCopy();return[t[0],t[1]]}}class oft extends on{constructor(e,t){super($localize`Score`,e,new sft,t)}}let kae=(()=>{class r extends Fi{constructor(t,n){super(t),u(this,"cdr",void 0),u(this,"MGPOptional",g),u(this,"lastDistributedHouses",[]),u(this,"currentMove",g.empty()),u(this,"clickOngoing",!1),u(this,"captured",[[0,0,0,0,0,0],[0,0,0,0,0,0]]),u(this,"droppedInStore",[0,0]),u(this,"filledCoords",[]),u(this,"constructedState",void 0),u(this,"opponentMoveIsBeingAnimated",!1),this.cdr=n,this.hasAsymmetricBoard=!0,this.scores=g.of([0,0])}showLastMove(t){var n=this;return M(function*(){n.droppedInStore=[0,0];const i=n.getPreviousState(),s=n.rules.distributeMove(t,i);n.filledCoords=s.filledCoords;let o=n.rules.applyCapture(s);n.captured=o.captureMap;const a=i.getCurrentPlayerY();n.lastDistributedHouses=t.distributions.map(l=>new C(l.x,a));const c=n.rules.mustMansoon(o.resultingState);c!==K.NONE&&(o=n.rules.monsoon(c,o),n.captured=o.captureMap),n.changeVisibleState(n.getState())})()}updateBoard(t){var n=this;return M(function*(){const i=n.getState();if(t){n.opponentMoveIsBeingAnimated=!0,U.assert(n.node.parent.isPresent(),"triggerAnimation in store should be false at first turn"),n.changeVisibleState(n.node.parent.get().gameState);let s=0;const o=n.node.previousMove.get();for(const a of o)yield n.showSimpleDistribution(a),s+1<o.distributions.length&&(yield TL.sleep(r.TIMEOUT_BETWEEN_DISTRIBUTION)),s++;n.opponentMoveIsBeingAnimated=!1}n.scores=g.of(i.getScoresCopy()),n.changeVisibleState(i)})()}onClick(t,n){var i=this;return M(function*(){const s=yield i.canUserPlay("#click_"+t+"_"+n);if(s.isFailure())return i.cancelMove(s.getReason());if(!0===i.clickOngoing)return b.SUCCESS;if(!0===i.opponentMoveIsBeingAnimated)return b.SUCCESS;{i.clickOngoing=!0;const o=yield i.onLegalClick(t,n);return i.clickOngoing=!1,o}})()}onLegalClick(t,n){var i=this;return M(function*(){return n===i.getState().getCurrentPlayer().value?i.cancelMove(uu.MUST_DISTRIBUTE_YOUR_OWN_HOUSES()):(i.updateOrCreateCurrentMove(t),0===i.constructedState.getPieceAtXY(t,n)?i.cancelMove(uu.MUST_CHOOSE_NON_EMPTY_HOUSE()):i.continueMoveConstruction(t))})()}continueMoveConstruction(t){var n=this;return M(function*(){const i=yield n.showSimpleDistribution(d1.of(t));if(i.endsUpInKalah){const s=n.constructedState.getCurrentPlayer();return ps.isStarving(s,i.resultingState.board)?n.chooseMove(n.currentMove.get()):b.SUCCESS}return n.chooseMove(n.currentMove.get())})()}showSimpleDistribution(t){var n=this;return M(function*(){const i=n.constructedState,s=i.getCurrentPlayerY(),o=new C(t.x,s);return n.lastDistributedHouses.push(o),yield n.showSeedBySeed(o,i),n.rules.distributeHouse(t.x,s,i)})()}showSeedBySeed(t,n){var i=this;return M(function*(){const s=n.getCopiedBoard(),o=n.getCurrentPlayer(),a=t;let c=s[t.y][t.x],l=!1;const f=n.getScoresCopy();for(s[t.y][t.x]=0,i.changeVisibleState(new Sn(s,n.turn,f)),yield TL.sleep(r.TIMEOUT_BETWEEN_SEED);c>0;){const d=i.rules.getNextCoord(t,o,l);l=d.isAbsent(),l?(c--,i.filledCoords.push(ps.FAKE_STORE_COORD.get(o).get()),i.droppedInStore[o.value]+=1,f[o.value]+=1):(t=d.get(),(!1===a.equals(t)||i.rules.config.feedOriginalHouse)&&(s[t.y][t.x]+=1,i.filledCoords.push(t),c--)),i.changeVisibleState(new Sn(s,n.turn,f)),yield TL.sleep(r.TIMEOUT_BETWEEN_SEED)}})()}hideLastMove(){this.captured=[[0,0,0,0,0,0],[0,0,0,0,0,0]],this.filledCoords=[],this.lastDistributedHouses=[],this.changeVisibleState(this.getState())}cancelMoveAttempt(){this.currentMove=g.empty(),this.droppedInStore=[0,0],this.filledCoords=[],this.lastDistributedHouses=[],this.changeVisibleState(this.getState())}getSpaceClasses(t,n){const i=new C(t,n),s=this.getSpaceOwner(i),o=this.getPlayerClass(s);return this.getStoreOwner(i).isAbsent()&&this.captured[n][t]>0?["captured-fill","moved-stroke"]:this.lastDistributedHouses.some(a=>a.equals(i))?["last-move-stroke",o]:this.filledCoords.some(a=>a.equals(i))?["moved-stroke",o]:[o]}getStoreOwner(t){return ps.FAKE_STORE_COORD.reverse().get(t)}getSpaceOwner(t){const n=this.getStoreOwner(t);return n.isPresent()?n.get().getAnyElement().get():k.of((t.y+1)%2)}getPieceCx(t){return 80+100*(t+1)}getPieceCy(t){return 60+120*t}getPieceTransform(t,n){return"translate("+this.getPieceCx(t)+", "+this.getPieceCy(n)+")"}getPieceRotation(){return"rotate("+180*this.role.value+")"}getHouseSecondaryContent(t,n){const i=this.getPreviousStableState().getPieceAtXY(t,n),o=this.constructedState.getPieceAtXY(t,n)-i;return this.captured[n][t]>0?g.of("-"+this.captured[n][t]):o>0?g.of("+"+o):o<0?g.of(""+o):g.empty()}getStoreContent(t){return this.scores.get()[t.value]+this.droppedInStore[t.value]}getStoreSecondaryContent(t){const n=this.getPreviousStableState().scores[t.value],s=this.constructedState.scores[t.value]-n;return s>0?g.of("+"+s):g.empty()}getPreviousStableState(){return this.opponentMoveIsBeingAnimated?(U.assert(this.getTurn()>0,"Kalah: Should not animate move at turn 0"),this.node.parent.get().gameState):!0===this.constructedState.equals(this.getState())&&this.node.parent.isPresent()?this.node.parent.get().gameState:this.getState()}onStoreClick(t){var n=this;return M(function*(){const i=yield n.canUserPlay("#store_player_"+t.value);return i.isFailure()?n.cancelMove(i.getReason()):n.cancelMove(uu.MUST_DISTRIBUTE_YOUR_OWN_HOUSES())})()}changeVisibleState(t){this.constructedState=t,this.board=this.constructedState.board,this.cdr.detectChanges()}createAIs(t){return[new oft(this.rules,t),new Kn($localize`MCTS`,t,this.rules)]}}return u(r,"TIMEOUT_BETWEEN_SEED",200),u(r,"TIMEOUT_BETWEEN_DISTRIBUTION",1e3),r})();class aft extends kae{constructor(e,t){super(e,t)}updateOrCreateCurrentMove(e){this.currentMove=g.of(this.generateMove(e))}}class cft extends Un{getListMoves(e){const t=[],n=e.gameState,s=(n.turn+1)%2;let o,a=0;for(;a<Sn.WIDTH;)0!==n.getPieceAtXY(a,s)&&(o=g1.of(a),i4.get().isLegal(o,n).isSuccess()&&(o=g1.of(a),t.push(o))),a++;return t}}const lft=["app-numbered-circle",""];function uft(r,e){if(1&r&&(N(),S(0,"text",3),lt(1),P()),2&r){const t=p();ye("id","secondary_message_",t.x,"_",t.y,""),I("x",15)("y",31)("transform",t.rotation),_(1),O2(" ",t.secondaryContent.get()," ")}}let xae=(()=>{var r;class e{constructor(){u(this,"x",void 0),u(this,"y",void 0),u(this,"spaceClasses",void 0),u(this,"content",void 0),u(this,"secondaryContent",void 0),u(this,"rotation",void 0)}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)}),u(e,"\u0275cmp",qe({type:r,selectors:[["","app-numbered-circle",""]],inputs:{x:"x",y:"y",spaceClasses:"spaceClasses",content:"content",secondaryContent:"secondaryContent",rotation:"rotation"},attrs:lft,decls:4,vars:10,consts:[["r","45",1,"base",3,"id","ngClass"],[1,"text-big","text-center",3,"id"],["class","text-20 text-center",3,"id",4,"ngIf"],[1,"text-20","text-center",3,"id"]],template:function(n,i){1&n&&(N(),F(0,"circle",0),S(1,"text",1),lt(2),P(),T(3,uft,2,6,"text",2)),2&n&&(ye("id","circle_",i.x,"_",i.y,""),y("ngClass",i.spaceClasses),_(1),ye("id","number_",i.x,"_",i.y,""),I("x",0)("y",16)("transform",i.rotation),_(1),O2(" ",i.content," "),_(1),y("ngIf",i.secondaryContent.isPresent()))},dependencies:[Ft,At],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();function fft(r,e){if(1&r){const t=pe();N(),S(0,"g")(1,"g",8),W("click",function(){const s=te(t).index,o=p().index;return ne(p().onClick(s,o))}),P()()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,s=p();_(1),ye("id","click_",n,"_",i,""),y("x",n)("y",i)("content",t)("spaceClasses",s.getSpaceClasses(n,i))("rotation",s.getPieceRotation())("secondaryContent",s.getHouseSecondaryContent(n,i)),I("transform",s.getPieceTransform(n,i))}}function dft(r,e){if(1&r&&(N(),S(0,"g"),T(1,fft,2,9,"g",2),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}let hft=(()=>{var r;class e extends aft{constructor(n,i){super(n,i),this.rules=i4.get(),this.node=this.rules.getInitialNode(),this.availableAIs=this.createAIs(new cft),this.encoder=g1.encoder,this.tutorial=(new Aae).tutorial}generateMove(n){return g1.of(n)}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(Ut),B(S3))}),u(e,"\u0275cmp",qe({type:r,selectors:[["app-awale-component"]],features:[Qe],decls:8,vars:14,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-5 -5 870 250","preserveAspectRatio","xMidYMid meet"],["x","0","y","0","ry","115","rx","115","width","860","height","240","fill","blue",1,"base"],[4,"ngFor","ngForOf"],["x1","120","y1","120","x2","740","y2","120",1,"base"],["x1","120","y1","0","x2","120","y2","240",1,"base"],["x1","740","y1","0","x2","740","y2","240",1,"base"],["id","store_player_0","app-numbered-circle","","transform","translate(60 120)",3,"x","y","content","spaceClasses","rotation","secondaryContent","click"],["id","store_player_1","app-numbered-circle","","transform","translate(800 120)",3,"x","y","content","spaceClasses","rotation","secondaryContent","click"],["app-numbered-circle","",3,"id","x","y","content","spaceClasses","rotation","secondaryContent","click"]],template:function(n,i){1&n&&(N(),S(0,"svg",0),F(1,"rect",1),T(2,dft,2,1,"g",2),F(3,"line",3)(4,"line",4)(5,"line",5),S(6,"g",6),W("click",function(){return i.onStoreClick(i.Player.ZERO)}),P(),S(7,"g",7),W("click",function(){return i.onStoreClick(i.Player.ONE)}),P()()),2&n&&(I("transform",i.rotation),_(2),y("ngForOf",i.board),_(4),y("x",-1)("y",-1)("content",i.getStoreContent(i.Player.ZERO))("spaceClasses",i.getSpaceClasses(-1,-1))("rotation",i.getPieceRotation())("secondaryContent",i.getStoreSecondaryContent(i.Player.ZERO)),_(1),y("x",2)("y",2)("content",i.getStoreContent(i.Player.ONE))("spaceClasses",i.getSpaceClasses(2,2))("rotation",i.getPieceRotation())("secondaryContent",i.getStoreSecondaryContent(i.Player.ONE)))},dependencies:[Wt,xae],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();class Hs extends Di{static getFallibleEncoder(e){return we.tuple([C.encoder,C.encoder],t=>[t.first,t.second],t=>e(t[0],t[1]).get())}static getEncoder(e){return we.tuple([C.encoder,C.encoder],t=>[t.first,t.second],t=>e(t[0],t[1]))}constructor(e,t){super(),u(this,"first",void 0),u(this,"second",void 0),this.first=e,this.second=t}getFirst(){return this.first}getSecond(){return this.second}}class $o extends Hs{constructor(e,t){if(super(e,t),e.equals(t))throw new Error(Re.MOVE_CANNOT_BE_STATIC())}length(){return this.getStart().getDistance(this.getEnd())}getDirection(){return Me.factory.fromMove(this.getStart(),this.getEnd())}getStart(){return this.getFirst()}getEnd(){return this.getSecond()}equals(e){return this===e||!1!==this.getStart().equals(e.getStart())&&this.getEnd().equals(e.getEnd())}}let nC=(()=>{class r{}return u(r,"LANDING_ON_OCCUPIED_SQUARE",()=>$localize`You cannot land on an occupied square.`),u(r,"THRONE_IS_LEFT_FOR_GOOD",()=>$localize`Once you left the central throne, you cannot return to it.`),u(r,"SOLDIERS_CANNOT_SIT_ON_THRONE",()=>$localize`Soldiers cannot sit on the throne.`),u(r,"MOVE_MUST_BE_ORTHOGONAL",()=>$localize`Tafl moves must be orthogonal.`),r})();class OL extends $o{constructor(e,t){if(super(e,t),e.isNotInRange(this.getMaximalDistance(),this.getMaximalDistance()))throw new Error("Starting coord of TaflMove must be on the board, not at "+e.toString()+".");if(t.isNotInRange(this.getMaximalDistance(),this.getMaximalDistance()))throw new Error("Landing coord of TaflMove must be on the board, not at "+t.toString()+".");const n=e.getDirectionToward(t);if(n.isFailure()||n.get().isDiagonal())throw new Error(nC.MOVE_MUST_BE_ORTHOGONAL())}toString(){return"TaflMove("+this.getStart()+"->"+this.getEnd()+")"}}class gs extends OL{static of(e,t){return new gs(e,t)}static from(e,t){try{const n=new gs(e,t);return ie.success(n)}catch(n){return ie.failure(n.message)}}getMaximalDistance(){return 7}}u(gs,"encoder",Hs.getFallibleEncoder(gs.from));const pft={CASTLE_IS_LEFT_FOR_GOOD:!0,BORDER_CAN_SURROUND_KING:!1,CENTRAL_THRONE_CAN_SURROUND_KING:!0,KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED:!0,WIDTH:7,INVADER:k.ZERO};var Ad,rC;class rn{constructor(e,t){u(this,"owner",void 0),u(this,"king",void 0),this.owner=e,this.king=t}isKing(){return this.king}getOwner(){return this.owner}}u(rn,"UNOCCUPIED",new(Ad=rn)(K.NONE,!1)),u(rn,"PLAYER_ONE_KING",new Ad(K.ONE,!0)),u(rn,"INVADERS",new Ad(K.ZERO,!1)),u(rn,"DEFENDERS",new Ad(K.ONE,!1));class E1{constructor(e){u(this,"value",void 0),this.value=e}}u(E1,"NONE",new(rC=E1)("NONE")),u(E1,"OPPONENT",new rC("OPPONENT")),u(E1,"PLAYER",new rC("PLAYER"));class bL extends W1{isCentralThrone(e){return e.equals(this.getCentralThrone())}getCentralThrone(){const e=(this.board.length-1)/2;return new C(e,e)}getRelativeOwner(e,t){const n=this.getAbsoluteOwner(t);let i;return i=n===K.NONE?E1.NONE:e===n?E1.PLAYER:E1.OPPONENT,i}getAbsoluteOwner(e){return this.getPieceAt(e).getOwner()}}class Aa extends bL{static getInitialState(){const e=rn.UNOCCUPIED,t=rn.INVADERS,n=rn.DEFENDERS;return new Aa([[e,e,e,t,e,e,e],[e,e,e,t,e,e,e],[e,e,e,n,e,e,e],[t,t,n,rn.PLAYER_ONE_KING,n,t,t],[e,e,e,n,e,e,e],[e,e,e,t,e,e,e],[e,e,e,t,e,e,e]],0)}of(e,t){return new Aa(e,t)}}class wL extends Yn{constructor(e,t,n){super(e),u(this,"config",void 0),u(this,"generateMove",void 0),this.config=t,this.generateMove=n}isLegal(e,t){const n=t.getCurrentPlayer(),i=this.getMoveValidity(n,e,t);return i.isFailure()?b.failure(i.getReason()):b.SUCCESS}getMoveValidity(e,t,n){const i=n.getRelativeOwner(e,t.getStart());if(i===E1.NONE)return b.failure(Re.MUST_CHOOSE_PLAYER_PIECE());if(i===E1.OPPONENT)return b.failure(Re.CANNOT_CHOOSE_OPPONENT_PIECE());if(n.getRelativeOwner(e,t.getEnd())!==E1.NONE)return b.failure(nC.LANDING_ON_OCCUPIED_SQUARE());if(this.isThrone(n,t.getEnd())){if(!n.getPieceAt(t.getStart()).isKing())return b.failure(nC.SOLDIERS_CANNOT_SIT_ON_THRONE());if(n.isCentralThrone(t.getEnd())&&this.config.CASTLE_IS_LEFT_FOR_GOOD)return b.failure(nC.THRONE_IS_LEFT_FOR_GOOD())}const o=t.getStart().getDirectionToward(t.getEnd()).get(),a=t.getStart().getOrthogonalDistance(t.getEnd());let c=t.getStart().getNext(o);for(let l=1;l<a;l++){if(n.getPieceAt(c)!==rn.UNOCCUPIED)return b.failure(Re.SOMETHING_IN_THE_WAY());c=c.getNext(o)}return b.SUCCESS}isThrone(e,t){return!!this.isExternalThrone(t)||e.isCentralThrone(t)}isExternalThrone(e){const t=this.config.WIDTH-1;return!(0!==e.x&&e.x!==t||0!==e.y&&e.y!==t)}tryCapture(e,t,n,i){const s=t.getNext(n);return s.isNotInRange(this.config.WIDTH,this.config.WIDTH)||i.getRelativeOwner(e,s)!==E1.OPPONENT?g.empty():i.getPieceAt(s).isKing()?this.captureKing(e,t,n,i):this.capturePawn(e,t,n,i)}captureKing(e,t,n,i){const s=t.getNext(n),{backCoord:o,back:a,backInRange:c,left:l,leftCoord:f,right:d,rightCoord:m}=this.getSurroundings(s,n,e,i);return!1===c?this.captureKingAgainstTheWall(l,d,s):a===E1.NONE&&this.isThrone(i,o)?this.captureKingAgainstThrone(o,s,l,d):a===E1.PLAYER?this.captureKingWithAtLeastASandwich(i,s,l,f,d,m):g.empty()}getSurroundings(e,t,n,i){const s=e.getNext(t),o=s.isInRange(this.config.WIDTH,this.config.WIDTH),a=o?i.getRelativeOwner(n,s):E1.NONE,c=e.getLeft(t),f=c.isInRange(this.config.WIDTH,this.config.WIDTH)?i.getRelativeOwner(n,c):E1.NONE,d=e.getRight(t),E=d.isInRange(this.config.WIDTH,this.config.WIDTH)?i.getRelativeOwner(n,d):E1.NONE;return{backCoord:s,back:a,backInRange:o,leftCoord:c,left:f,rightCoord:d,right:E}}captureKingAgainstTheWall(e,t,n){let i=e===E1.PLAYER?1:0;return i+=t===E1.PLAYER?1:0,2===i&&this.config.BORDER_CAN_SURROUND_KING?g.of(n):g.empty()}captureKingAgainstThrone(e,t,n,i){if(this.isExternalThrone(e)){if(this.config.KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED)return g.of(t)}else if(this.config.CENTRAL_THRONE_CAN_SURROUND_KING&&(n===E1.PLAYER||i===E1.PLAYER))return g.of(t);return g.empty()}capturePawn(e,t,n,i){const s=t.getNext(n),o=s.getNext(n);let a=E1.NONE;return o.isInRange(this.config.WIDTH,this.config.WIDTH)&&(a=i.getRelativeOwner(e,o)),a===E1.NONE?!1===this.isThrone(i,o)?(Ne.display("TaflRules","capturePawn","cannot capture a pawn without an ally; "+s+"threatened by "+e+"'s pawn in "+t+" coming from this direction ("+n.x+", "+n.y+")cannot capture a pawn without an ally behind"),g.empty()):(Ne.display("TaflRules","capturePawn","pawn captured by 1 opponent and 1 throne; "+s+"threatened by "+e+"'s pawn in "+t+" coming from this direction ("+n.x+", "+n.y+")"),g.of(s)):a===E1.PLAYER?(Ne.display("TaflRules","capturePawn","pawn captured by 2 opponents; "+s+"threatened by "+e+"'s pawn in "+t+" coming from this direction ("+n.x+", "+n.y+")"),g.of(s)):(Ne.display("TaflRules","capturePawn","no captures; "+s+"threatened by "+e+"'s pawn in "+t+" coming from this direction ("+n.x+", "+n.y+")"),g.empty())}captureKingWithAtLeastASandwich(e,t,n,i,s,o){if(!1===this.kingTouchCentralThrone(e,t)&&this.config.KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED)return g.of(t);const a=this.config.CENTRAL_THRONE_CAN_SURROUND_KING,c=this.isThrone(e,i),l=n===E1.PLAYER||c&&a,f=this.isThrone(e,o);return l&&(s===E1.PLAYER||f&&a)?g.of(t):g.empty()}kingTouchCentralThrone(e,t){const n=e.getCentralThrone();return t.getOrthogonalDistance(n)<=1}applyLegalMove(e,t,n){const i=t.turn,s=t.getCopiedBoard(),o=t.getCurrentPlayer(),a=e.getStart(),c=e.getEnd();s[c.y][c.x]=s[a.y][a.x],s[a.y][a.x]=rn.UNOCCUPIED;for(const l of ze.ORTHOGONALS){const f=this.tryCapture(o,e.getEnd(),l,t);f.isPresent()&&(s[f.get().y][f.get().x]=rn.UNOCCUPIED)}return t.of(s,i+1)}getGameStatus(e){const n=this.getWinner(e.gameState);return n.isPresent()?_e.getVictory(n.get()):_e.ONGOING}getWinner(e){const t=this.getKingCoord(e);if(t.isAbsent())return Ne.display("TaflRules","getWinner","The king is dead, victory to invader"),g.of(this.getInvader());const n=t.get();return this.isExternalThrone(n)?(Ne.display("TaflRules","getWinner","The king escape, victory to defender"),g.of(this.getDefender())):this.isPlayerImmobilized(k.ZERO,e)?(Ne.display("TaflRules","getWinner","Zero has no move, victory to one"),g.of(k.ONE)):this.isPlayerImmobilized(k.ONE,e)?(Ne.display("TaflRules","getWinner","One has no move, victory to zero"),g.of(k.ZERO)):(Ne.display("TaflRules","getWinner","no victory"),g.empty())}getKingCoord(e){for(let t=0;t<this.config.WIDTH;t++)for(let n=0;n<this.config.WIDTH;n++)if(e.getPieceAtXY(n,t).isKing())return g.of(new C(n,t));return g.empty()}getInvader(){return this.config.INVADER}getDefender(){return this.config.INVADER.getOpponent()}isPlayerImmobilized(e,t){return 0===this.getPlayerListMoves(e,t).length}getPlayerListMoves(e,t){const n=[],i=this.getPlayerListPawns(e,t);for(const s of i){const o=this.getPossibleDestinations(s,t);for(const a of o){const c=this.generateMove(s,a).get();n.push(c)}}return n}getPlayerListPawns(e,t){const n=[];for(let i=0;i<this.config.WIDTH;i++)for(let s=0;s<this.config.WIDTH;s++){const o=new C(s,i);t.getAbsoluteOwner(o)===e&&n.push(o)}return n}getPossibleDestinations(e,t){const n=[];let i;for(const s of ze.ORTHOGONALS){i=e.getNext(s,1);let o=!1;for(;i.isInRange(this.config.WIDTH,this.config.WIDTH)&&!1===o;)t.getAbsoluteOwner(i)===K.NONE?this.isExternalThrone(i)?t.getPieceAt(e).isKing()&&n.push(i):t.isCentralThrone(i)?t.getPieceAt(e).isKing()&&!1===this.config.CASTLE_IS_LEFT_FOR_GOOD&&n.push(i):n.push(i):o=!0,i=i.getNext(s,1)}return n}}class Ol extends wL{static get(){return Ol.singleton.isAbsent()&&(Ol.singleton=g.of(new Ol)),Ol.singleton.get()}constructor(){super(Aa,pft,gs.from)}}u(Ol,"singleton",g.empty());let zae,O0=class extends Un{constructor(e){super(),u(this,"rules",void 0),this.rules=e}getListMoves(e){const t=e.gameState,n=t.getCurrentPlayer(),i=this.rules.getPlayerListMoves(n,t);return this.orderMoves(t,i)}orderMoves(e,t){const n=this.rules.getKingCoord(e).get();return e.getCurrentPlayer()===this.rules.config.INVADER?Ie.sortByDescending(t,i=>-i.getEnd().getOrthogonalDistance(n)):Ie.sortByDescending(t,i=>i.getStart().equals(n)?this.rules.isExternalThrone(i.getEnd())?2:1:0),t}};O0=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ne.log],O0);class iC{constructor(e,t){u(this,"directThreats",void 0),u(this,"mover",void 0),this.directThreats=e,this.mover=t}equals(e){return e.directThreats.equals(this.directThreats)&&e.mover.equals(this.mover)}}class Rae extends iC{constructor(e,t){super(new dt([e]),t),u(this,"directThreat",void 0),this.directThreat=e}}zae=Symbol.iterator;class mft extends dt{constructor(e){if(super(),u(this,"valueMap",void 0),this.valueMap=[],this.values=[],void 0!==e)for(const t of e)this.add(t)}add(e){const t=this.toFields(e);let n=this.valueMap;for(const s of t[0])void 0===n[s]&&(n[s]=[]),n=n[s];const i=t[1];return void 0===n[i]&&(n[i]=!0,this.values.push(e),!0)}contains(e){const t=this.toFields(e);let n=this.valueMap;for(const s of t[0]){if(void 0===n[s])return!1;n=n[s]}return void 0!==n[t[1]]}[zae](){return this.values.values()}}class q1 extends mft{toFields(e){return[[e.y],e.x]}}class Dae extends fr{constructor(e){super(),u(this,"rules",void 0),this.rules=e}getMetrics(e){const t=e.gameState,n=this.rules.getPlayerListPawns(k.ZERO,t).length,i=this.rules.getPlayerListPawns(k.ONE,t).length;return[n*[1,2][this.rules.config.INVADER.value],i*[2,1][this.rules.config.INVADER.value]]}}class Hae extends Dae{constructor(e){super(e),u(this,"width",void 0),u(this,"maxInfluence",void 0),u(this,"scoreByThreatenedPiece",void 0),u(this,"scoreBySafePiece",void 0),this.width=this.rules.config.WIDTH,this.maxInfluence=16*(2*this.width-2),this.scoreByThreatenedPiece=16*this.maxInfluence+1,this.scoreBySafePiece=16*this.scoreByThreatenedPiece+1}getBoardValue(e){const t=this.rules.getGameStatus(e);if(t.isEndGame)return t.toBoardValue();const n=e.gameState,i=rn.UNOCCUPIED;let s=0;const o=this.getPiecesMap(n),a=this.getThreatMap(n,o),c=this.filterThreatMap(a,n);for(const l of k.PLAYERS)for(const f of o.get(l).get())if(c.get(f).isPresent())s+=l.getScoreModifier()*this.scoreByThreatenedPiece;else{s+=l.getScoreModifier()*this.scoreBySafePiece;let d=0;for(const m of ze.ORTHOGONALS){let E=f.getNext(m,1);for(;E.isInRange(this.width,this.width)&&n.getPieceAt(E)===i;)d++,E=E.getNext(m,1)}s+=d*l.getScoreModifier()}return new Jn(s)}getPiecesMap(e){const t=rn.UNOCCUPIED,n=[],i=[];for(let o=0;o<this.width;o++)for(let a=0;a<this.width;a++){const c=new C(a,o);e.getPieceAt(c)!==t&&(e.getAbsoluteOwner(c)===k.ZERO?n.push(c):i.push(c))}return new En([{key:k.ZERO,value:new q1(n)},{key:k.ONE,value:new q1(i)}])}getThreatMap(e,t){const n=new En;for(const i of k.PLAYERS)for(const s of t.get(i).get()){const o=this.getThreats(s,e);this.isThreatReal(s,e,o)&&n.set(s,new dt(o))}return n}getThreats(e,t){const n=t.getAbsoluteOwner(e);Ze(n.isPlayer(),"TaflPieceAndInfluenceMinimax.getThreats should be called with an occupied coordinate");const i=n.getOpponent(),s=[];for(const o of ze.ORTHOGONALS){const a=e.getPrevious(o,1);if(this.isAThreat(a,t,i)){const c=[];for(const l of ze.ORTHOGONALS){if(l===o.getOpposite())continue;let f=e.getNext(o,1);for(;f.isInRange(this.width,this.width)&&t.getPieceAt(f)===rn.UNOCCUPIED;)f=f.getNext(l);f.isInRange(this.width,this.width)&&t.getAbsoluteOwner(f)===i&&!1===e.getNext(o,1).equals(f)&&c.push(f)}s.push(new Rae(a,new q1(c)))}}return s}isAThreat(e,t,n){return!(e.isNotInRange(this.width,this.width)||t.getAbsoluteOwner(e)!==n&&(!this.rules.isThrone(t,e)||n!==k.ONE&&t.getPieceAt(e)!==rn.UNOCCUPIED))}isThreatReal(e,t,n){if(0===n.length)return!1;if(t.getPieceAt(e).isKing())return 3===n.length;for(const i of n)if(i.mover.size()>0)return!0;return!1}filterThreatMap(e,t){const n=new En,i=e.listKeys(),s=i.filter(a=>t.getAbsoluteOwner(a)===t.getCurrentPlayer()),o=new q1(i.filter(a=>t.getAbsoluteOwner(a)===t.getCurrentOpponent()));for(const a of s){const c=e.get(a).get(),l=[];for(const f of c)if(!1===o.contains(f.directThreat)){const d=[];for(const m of f.mover)!1===o.contains(m)&&d.push(m);d.length>0&&l.push(new Rae(f.directThreat,new q1(d)))}l.length>0&&n.set(a,new dt(l))}for(const a of o){const c=e.get(a).get();n.set(a,c)}return n}}class _ft extends on{constructor(e){super($localize`Pieces > Influence`,e,new Hae(e),new O0(e))}}class vft extends on{constructor(e){super($localize`Pieces`,e,new Dae(e),new O0(e))}}class Vae extends Hae{getBoardValue(e){const t=e.gameState,n=this.getControlScoreAndPieceScores(t);let i=n.controlScore;i+=n.safeScore*this.getScoreBySafePiece(t);const s=this.getScoreByThreatenedPiece(t);return i+=n.threatenedScore*s,Ze(n.controlScore<=s,"Control Score should be below "+s+", got "+n.controlScore),Ze(n.threatenedScore<=16,"Threatened Score should be below 16, got "+n.threatenedScore),Ze(n.safeScore<=16,"Safe Score should be below 16, got "+n.threatenedScore),new Jn(i)}getControlScoreAndPieceScores(e){const t=this.getPiecesMap(e),n=this.getThreatMap(e,t),i=this.filterThreatMap(n,e),s={safeScore:0,threatenedScore:0,controlScore:0};for(const o of k.PLAYERS){const a=new q1;for(const c of t.get(o).get())if(i.get(c).isPresent())s.threatenedScore+=o.getScoreModifier();else{s.safeScore+=o.getScoreModifier();for(const l of ze.ORTHOGONALS){let f=c.getNext(l,1);for(;f.isInRange(this.width,this.width)&&e.getPieceAt(f)===rn.UNOCCUPIED;)a.add(f),f=f.getNext(l,1)}}for(const c of a){const l=this.getControlledPieceValue(c.x,c.y,this.width);s.controlScore+=o.getScoreModifier()*l}}return s}getControlledPieceValue(e,t,n){let i=1;return(0===e||e===n-1)&&(i*=n),(0===t||t===n-1)&&(i*=n),i}getScoreByThreatenedPiece(e){const t=e.board.length,n=t-2;return 4*t*t+4*n*t+n*n}getScoreBySafePiece(e){return 16*this.getScoreByThreatenedPiece(e)+1}}class Cft extends on{constructor(e){super($localize`Pieces > Control`,e,new Vae(e),new O0(e))}}class yft extends Vae{getBoardValue(e){const t=e.gameState,n=this.getControlScoreAndPieceScores(t),i=t.getPieceAt(this.rules.getKingCoord(t).get()).getOwner(),s=this.getStepForEscape(t)*i.getScoreModifier();if(-1===s)return new Jn(i.getOpponent().getPreVictory());const o=this.getScoreByThreatenedPiece(t);return U.assert(n.controlScore<=o,"Control Score should be below "+o+", got "+n.controlScore),U.assert(n.threatenedScore<=16,"Threatened Score should be below 16, got "+n.threatenedScore),U.assert(n.safeScore<=16,"Safe Score should be below 16, got "+n.threatenedScore),new Jn(-1*s*(o+1)*17*17+n.safeScore*(o+1)*17+n.threatenedScore*(o+1)+n.controlScore)}getStepForEscape(e){const t=this.rules.getKingCoord(e).get();return this._getStepForEscape(e,1,[t],[]).getOrElse(-1)}_getStepForEscape(e,t,n,i){const s=this.getNextGen(e,n,i);return 0===s.length?g.empty():s.some(o=>this.rules.isExternalThrone(o))?g.of(t):(t++,i.push(...s),this._getStepForEscape(e,t,s,i))}getNextGen(e,t,n){const i=[];for(const s of t)for(const o of ze.ORTHOGONALS){let a=s.getNext(o,1);for(;a.isInRange(this.width,this.width)&&e.getPieceAt(a)===rn.UNOCCUPIED;)n.every(c=>!1===c.equals(a))&&i.push(a),a=a.getNext(o,1)}return i}}class Mft extends on{constructor(e){super($localize`Escape > Pieces > Control`,e,new yft(e),new O0(e))}}class AL extends Fi{constructor(e,t){super(e),u(this,"generateMove",void 0),u(this,"viewInfo",{pieceClasses:[]}),u(this,"EMPTY",rn.UNOCCUPIED),u(this,"capturedCoords",[]),u(this,"chosen",g.empty()),this.generateMove=t}getViewBox(){const e=-this.STROKE_WIDTH,t=this.rules.config.WIDTH*this.SPACE_SIZE+2*this.STROKE_WIDTH;return e+" "+e+" "+t+" "+t}updateBoard(e){var t=this;return M(function*(){t.board=t.getState().getCopiedBoard(),t.capturedCoords=[],t.updateViewInfo()})()}showLastMove(e){var t=this;return M(function*(){const n=t.getPreviousState(),i=t.getState().getCurrentOpponent();for(const s of ze.ORTHOGONALS){const o=e.getEnd().getNext(s,1);if(o.isInRange(t.rules.config.WIDTH,t.rules.config.WIDTH)){const c=n.getRelativeOwner(i,o)===E1.OPPONENT,f=t.getState().getPieceAt(o)===rn.UNOCCUPIED;c&&f&&t.capturedCoords.push(o)}}})()}updateViewInfo(){const e=[];this.board=this.getState().getCopiedBoard();for(let t=0;t<this.board.length;t++){const n=[];for(let i=0;i<this.board[0].length;i++){let s=[];s=this.board[t][i].getOwner()===K.NONE?[""]:this.getPieceClasses(i,t),n.push(s)}e.push(n)}this.viewInfo={pieceClasses:e}}onClick(e,t){var n=this;return M(function*(){const i=yield n.canUserPlay("#click_"+e+"_"+t);if(i.isFailure())return n.cancelMove(i.getReason());const s=new C(e,t);return n.chosen.equalsValue(s)?(n.cancelMoveAttempt(),b.SUCCESS):n.chosen.isAbsent()||n.pieceBelongToCurrentPlayer(s)?n.choosePiece(s):n.chooseDestination(e,t)})()}chooseDestination(e,t){var n=this;return M(function*(){const i=n.chosen.get(),s=new C(e,t),o=n.generateMove(i,s);return o.isSuccess()?yield n.chooseMove(o.get()):n.cancelMove(o.getReason())})()}choosePiece(e){var t=this;return M(function*(){return t.board[e.y][e.x]===rn.UNOCCUPIED?t.cancelMove(Re.MUST_CHOOSE_PLAYER_PIECE()):!1===t.pieceBelongToCurrentPlayer(e)?t.cancelMove(Re.CANNOT_CHOOSE_OPPONENT_PIECE()):(t.chosen=g.of(e),t.updateViewInfo(),b.SUCCESS)})()}pieceBelongToCurrentPlayer(e){const t=this.getState(),n=t.getCurrentPlayer();return t.getRelativeOwner(n,e)===E1.PLAYER}cancelMoveAttempt(){this.chosen=g.empty(),this.updateViewInfo()}isThrone(e,t){const n=this.getState();return this.rules.isThrone(n,new C(e,t))}isCentralThrone(e,t){return this.getState().isCentralThrone(new C(e,t))}getPieceClasses(e,t){const n=[],i=new C(e,t),s=this.getState().getAbsoluteOwner(i);return n.push(this.getPlayerClass(s)),this.chosen.equalsValue(i)&&n.push("selected-stroke"),n}getRectClasses(e,t){const n=[],i=new C(e,t);if(this.capturedCoords.some(s=>s.equals(i)))n.push("captured-fill");else if(this.node.previousMove.isPresent()){const s=this.node.previousMove.get().getStart(),o=this.node.previousMove.get().getEnd();(i.equals(s)||i.equals(o))&&n.push("moved-fill")}return n}getClickables(){const e=[];for(let t=0;t<this.board.length;t++)for(let n=0;n<this.board[t].length;n++){const i=new C(n,t);this.isClickable(i)&&e.push(i)}return e}isClickable(e){return this.pieceBelongToCurrentPlayer(e)}isInvader(e,t){return this.board[t][e]===rn.INVADERS}isKing(e,t){return this.board[t][e].isKing()}createAIs(){const e=new O0(this.rules);return[new vft(this.rules),new _ft(this.rules),new Cft(this.rules),new Mft(this.rules),new Kn($localize`MCTS`,e,this.rules)]}}const j=rn.UNOCCUPIED,h1=rn.INVADERS,Vs=rn.DEFENDERS,Nd=rn.PLAYER_ONE_KING;class Fae extends Zn{constructor(...e){super(...e),u(this,"tutorial",[q.informational($localize`Goal of the game`,$localize`Brandhub is the Irish version of the Tafl, Tafl being a family of viking strategy game. The goal of the game is different for each player. The attacker plays first. Their pieces (dark) are close to the edges. Their goal is to capture the king, which is in the center of the board. The defender plays second. Their pieces (light) are in the middle. Their goal is to move the king on one of the 4 thrones in the corners. Note that the square in which the king starts, in the center of the board, is also a throne.`,Aa.getInitialState()),q.anyMove($localize`Moving`,$localize`All pieces move the same way. Similarly to a rook in chess, a piece can move: <ol><li>By as many squares as you want.</li><li>Without going over another piece or stopping on another piece.</li><li>Horizontally or vertically.</li><li>Only the king can land on a corner throne.</li><li>Once the king left his central throne, no piece can land on it, but all can pass over it.</li></ol>To move a piece, click on it and then on its landing square.<br/><br/>You're playing Dark, do the first move.`,Aa.getInitialState(),gs.of(new C(3,1),new C(1,1)),$localize`Congratulations!`),q.fromMove($localize`Capturing a soldier (1/2)`,$localize`All pieces, attackers and defenders, except the king, are soldiers. To capture them, they have to be sandwiched between two of your pieces. By getting too close, an attacker's soldier is in danger.<br/><br/>You're playing Light. Capture the soldier.`,new Aa([[j,j,j,h1,j,j,j],[j,j,j,h1,j,j,j],[h1,j,j,Vs,j,j,j],[j,j,Vs,Nd,Vs,h1,h1],[j,j,h1,j,j,j,j],[j,j,j,Vs,j,h1,j],[j,j,j,h1,j,j,j]],1),[gs.of(new C(3,5),new C(2,5))],$localize`Congratulations, that will teach him a lesson!`,$localize`Failed, you missed an opportunity to capture a piece of the opponent.`),q.fromMove($localize`Capturing a soldier (2/2)`,$localize`A second way to capture a soldier is to sandwich it against an empty throne. The king has moved and endangered one of its soldiers.<br/><br/>You're playing Dark. Capture the soldier.`,new Aa([[j,j,j,h1,j,j,j],[j,j,h1,j,j,j,j],[j,j,j,Vs,j,j,j],[h1,Vs,j,j,Vs,h1,h1],[j,Vs,j,j,j,j,j],[j,h1,j,Nd,j,h1,j],[j,j,j,h1,j,j,j]],12),[gs.of(new C(2,1),new C(3,1)),gs.of(new C(3,0),new C(3,1))],$localize`Congratulations, one less defender. But keep an eye on the king, it is the most important.`,$localize`Failed, you did not do the expected move.`),q.fromMove($localize`Capturing the king on his throne`,$localize`To capture the king when he sits on his throne, the four squares neighbor to the king (horizontally and vertically) must be occupied by your soldiers.<br/><br/>You're playing Dark. Capture the king.`,new Aa([[j,j,j,j,j,j,j],[j,j,j,Vs,j,j,j],[j,j,j,h1,j,j,j],[j,h1,j,Nd,h1,j,j],[j,j,j,h1,j,j,j],[j,Vs,j,j,j,j,j],[j,j,j,j,j,j,j]],72),[gs.of(new C(1,3),new C(2,3))],$localize`Congratulations, you won!`,$localize`Failed, you let the king run away.`),q.fromMove($localize`Capturing the king next to his throne`,$localize`Another way to capture the king is to use three soldier plus the central throne to surround the king on four sides.<br/><br/>You're playing Dark. Capture the king.`,new Aa([[j,j,h1,j,j,j,j],[j,j,j,h1,j,j,j],[j,j,j,Nd,h1,j,j],[j,h1,Vs,j,Vs,j,j],[j,j,j,h1,j,j,j],[j,j,j,j,j,j,j],[j,j,j,j,j,j,j]],72),[gs.of(new C(2,0),new C(2,2))],$localize`The king is dead, long live the king. Congratulations, you won.`,$localize`Failed. Try again.`),q.fromMove($localize`Capturing the king far from his throne`,$localize`When the king is not on his central throne nor next to it, he can be captured like a soldier.<br/><br/>You're playing Dark. Capture the king.`,new Aa([[j,j,j,j,j,j,j],[j,j,j,j,j,j,j],[j,h1,j,h1,j,j,j],[h1,j,j,j,Vs,j,j],[j,j,j,Vs,j,j,j],[j,j,j,j,j,j,j],[j,Nd,j,h1,j,j,j]],72),[gs.of(new C(3,6),new C(2,6))],$localize`The king is dead, long live the king. Congratulations, you won.`,$localize`Failed. Try again.`)])}}function Eft(r,e){1&r&&(N(),F(0,"polygon",8))}function Sft(r,e){1&r&&(N(),F(0,"rect",9))}function Pft(r,e){if(1&r&&(N(),S(0,"g"),T(1,Eft,1,0,"polygon",6),T(2,Sft,1,0,"ng-template",null,7,un),P()),2&r){const t=cn(3),n=p().index,i=p().index,s=p();_(1),y("ngIf",s.isCentralThrone(n,i))("ngIfElse",t)}}function Tft(r,e){if(1&r&&(N(),S(0,"g"),F(1,"line",13)(2,"line",13)(3,"line",13)(4,"line",13)(5,"line",13),P()),2&r){const t=p(2).index,n=p().index,i=p();_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),I("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),I("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.1*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),I("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.9*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),I("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.15*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),I("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.85*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE)}}function Oft(r,e){if(1&r&&(N(),F(0,"polyline",16)),2&r){const t=p(3).index,n=p().index;y("ngClass",p().viewInfo.pieceClasses[n][t])}}function bft(r,e){if(1&r&&(N(),F(0,"line",13)(1,"line",13)(2,"line",13)(3,"line",13)),2&r){const t=p(3).index,n=p().index,i=p();y("ngClass",i.viewInfo.pieceClasses[n][t]),I("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),I("x1",.04*i.SPACE_SIZE)("y1",.5*i.SPACE_SIZE)("x2",.96*i.SPACE_SIZE)("y2",.5*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),I("x1",.2*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.8*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),I("x1",.8*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.2*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE)}}function wft(r,e){if(1&r&&(N(),T(0,Oft,1,1,"polyline",14),T(1,bft,4,20,"ng-template",null,15,un)),2&r){const t=cn(2),n=p(2).index,i=p().index;y("ngIf",p().isKing(n,i))("ngIfElse",t)}}function Aft(r,e){if(1&r&&(N(),S(0,"g"),F(1,"circle",10),T(2,Tft,6,25,"g",11),T(3,wft,3,2,"ng-template",null,12,un),P()),2&r){const t=cn(4),n=p().index,i=p().index,s=p();_(1),ye("id","piece_",n,"_",i,""),y("ngClass",s.viewInfo.pieceClasses[i][n]),I("r",s.SPACE_SIZE/2-s.STROKE_WIDTH)("cx",.5*s.SPACE_SIZE)("cy",.5*s.SPACE_SIZE),_(1),y("ngIf",s.isInvader(n,i))("ngIfElse",t)}}function Nft(r,e){if(1&r){const t=pe();N(),S(0,"g",3),W("click",function(){const s=te(t).index,o=p().index;return ne(p().onClick(s,o))}),F(1,"rect",4),T(2,Pft,4,2,"g",5),T(3,Aft,5,8,"g",5),P()}if(2&r){const t=e.index,n=p().index,i=p();ye("id","click_",t,"_",n,""),I("transform","translate("+i.SPACE_SIZE*t+", "+i.SPACE_SIZE*n+")"),_(1),ye("id","space_",t,"_",n,""),y("ngClass",i.getRectClasses(t,n)),I("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),_(1),y("ngIf",i.board[n][t]===i.EMPTY&&i.isThrone(t,n)),_(1),y("ngIf",i.board[n][t]!==i.EMPTY)}}function Ift(r,e){if(1&r&&(N(),S(0,"g"),T(1,Nft,4,10,"g",2),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function kft(r,e){if(1&r){const t=pe();N(),S(0,"g")(1,"rect",17),W("click",function(){const s=te(t).$implicit;return ne(p().onClick(s.x,s.y))}),P()()}if(2&r){const t=e.$implicit,n=p();_(1),ye("id","click_",t.x,"_",t.y,""),I("x",n.SPACE_SIZE*t.x)("y",n.SPACE_SIZE*t.y)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}let xft=(()=>{var r;class e extends AL{constructor(n){super(n,gs.from),this.rules=Ol.get(),this.node=this.rules.getInitialNode(),this.availableAIs=this.createAIs(),this.encoder=gs.encoder,this.tutorial=(new Fae).tutorial}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(Ut))}),u(e,"\u0275cmp",qe({type:r,selectors:[["app-brandhub"]],features:[Qe],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["x","0","y","0",1,"base",3,"id","ngClass"],[4,"ngIf"],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60","class","base",4,"ngIf","ngIfElse"],["cornerThrone",""],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60",1,"base"],["x","15","y","15","width","70","height","70",1,"base"],[1,"base",3,"id","ngClass"],[4,"ngIf","ngIfElse"],["defender",""],[1,"base",3,"ngClass"],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85","class","base no-fill",3,"ngClass",4,"ngIf","ngIfElse"],["soldierDefender",""],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85",1,"base","no-fill",3,"ngClass"],[1,"no-fill","mid-stroke","clickable-stroke",3,"id","click"]],template:function(n,i){1&n&&(N(),S(0,"svg",0),T(1,Ift,2,1,"g",1),T(2,kft,2,6,"g",1),P()),2&n&&(I("viewBox",i.getViewBox()),_(1),y("ngForOf",i.board),_(1),y("ngForOf",i.getClickables()))},dependencies:[Ft,Wt,At],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})(),fi=(()=>{class r extends W1{static isOnBoard(t){return t.isInRange(r.WIDTH,r.HEIGHT)}static getInitialState(){const t=Ie.createTable(r.WIDTH,r.HEIGHT,K.NONE);return new r(t,0)}}return u(r,"WIDTH",19),u(r,"HEIGHT",19),r})();var NL;class Na extends br{static of(e){return U.assert(fi.isOnBoard(e),"FIRST_COORD_IS_OUT_OF_RANGE"),new Na(e.x,e.y)}constructor(e,t){super(e,t)}toString(){return"ConnectSixFirstMove("+this.coord.x+", "+this.coord.y+")"}}u(Na,"encoder",br.getEncoder(Na.of));class Ia extends Hs{static of(e,t){return U.assert(fi.isOnBoard(e),"FIRST_COORD_IS_OUT_OF_RANGE"),U.assert(fi.isOnBoard(t),"SECOND_COORD_IS_OUT_OF_RANGE"),U.assert(!1===e.equals(t),"COORDS_SHOULD_BE_DIFFERENT"),new Ia(e,t)}toString(){return"ConnectSixDrops("+this.getFirst().toString()+", "+this.getSecond().toString()+")"}equals(e){const t=this.getFirst(),n=e.getFirst(),i=this.getSecond(),s=e.getSecond();return!(!t.equals(n)||!i.equals(s))||!(!t.equals(s)||!i.equals(n))}}u(Ia,"encoder",Hs.getEncoder(Ia.of)),function(r){r.isFirstMove=function e(n){return n instanceof Na},r.isDrop=function t(n){return n instanceof Ia},r.encoder=we.disjunction([r.isFirstMove,r.isDrop],[Na.encoder,Ia.encoder])}(NL||(NL={}));class fu{constructor(e,t,n){u(this,"isInRange",void 0),u(this,"getOwner",void 0),u(this,"N",void 0),this.isInRange=e,this.getOwner=t,this.N=n}getBoardValue(e){let t=0;for(const n of e.getCoordsAndContents()){const s=n.coord;if(this.getOwner(n.content,e).isPlayer()){const o=this.getSquareScore(e,s);if(Jn.VICTORIES.some(a=>a===o))return new Jn(o);t+=o}}return new Jn(t)}getSquareScore(e,t){const n=e.getPieceAt(t),i=this.getOwner(n,e);Ze(i.isPlayer(),"getSquareScore should not be called with PlayerOrNone.NONE piece");const s=new En,o=new En;for(const c of Me.DIRECTIONS){const l=this.getNumberOfFreeSpacesAndAllies(e,t,c,i);s.set(c,l[0]),o.set(c,l[1])}return this.getScoreFromDirectionAlliesAndFreeSpaces(o,s)*i.getScoreModifier()}getScoreFromDirectionAlliesAndFreeSpaces(e,t){let n=0;for(const i of[Me.UP,Me.UP_RIGHT,Me.RIGHT,Me.DOWN_RIGHT]){const s=e.get(i).get(),o=e.get(i.getOpposite()).get();if(this.N<=s+o+1)return Number.MAX_SAFE_INTEGER;const f=t.get(i).get()+t.get(i.getOpposite()).get();this.N<=f+1&&(n+=2+f-this.N)}return n}getNumberOfFreeSpacesAndAllies(e,t,n,i){let s=0,o=0,a=!0,c=new C(t.x+n.x,t.y+n.y),l=1;const f=i.getOpponent();for(;this.isInRange(c)&&l<this.N;){const d=e.getPieceAt(c);if(this.getOwner(d,e)===f)return[s,o];this.getOwner(d,e)===i&&a?o++:a=!1,d!==f&&d!==i&&s++,c=c.getNext(n),l++}return[s,o]}getVictoriousCoord(e){const t=[];for(const n of e.getCoordsAndContents())if(this.getOwner(n.content,e).isPlayer()){const i=n.coord,s=this.getSquareScore(e,i);Jn.isVictory(s)&&(s===k.ZERO.getVictoryValue()||s===k.ONE.getVictoryValue())&&t.push(i)}return t}}class Fs extends Yn{static get(){return Fs.singleton.isAbsent()&&(Fs.singleton=g.of(new Fs)),Fs.singleton.get()}static getVictoriousCoords(e){return Fs.CONNECT_SIX_HELPER.getVictoriousCoord(e)}constructor(){super(fi)}applyLegalMove(e,t,n){return e instanceof Ia?this.applyLegalDrops(e,t):this.applyLegalFirstMove(e,t)}applyLegalDrops(e,t){const n=t.getCurrentPlayer(),i=e.getFirst(),s=e.getSecond(),o=t.getCopiedBoard();return o[i.y][i.x]=n,o[s.y][s.x]=n,new fi(o,t.turn+1)}applyLegalFirstMove(e,t){const n=t.getCurrentPlayer(),i=t.getCopiedBoard();return i[e.coord.y][e.coord.x]=n,new fi(i,t.turn+1)}isLegal(e,t){return 0===t.turn?(U.assert(e instanceof Na,"First move should be instance of ConnectSixFirstMove"),b.SUCCESS):(U.assert(e instanceof Ia,"non-firsts moves should be instance of ConnectSixDrops"),this.isLegalDrops(e,t))}isLegalDrops(e,t){return t.getPieceAt(e.getFirst()).isPlayer()||t.getPieceAt(e.getSecond()).isPlayer()?b.failure(Re.MUST_CLICK_ON_EMPTY_SQUARE()):b.SUCCESS}getGameStatus(e){const t=e.gameState;return Fs.CONNECT_SIX_HELPER.getVictoriousCoord(t).length>0?_e.getVictory(t.getCurrentOpponent()):181===t.turn?_e.DRAW:_e.ONGOING}}u(Fs,"singleton",g.empty()),u(Fs,"CONNECT_SIX_HELPER",new fu(fi.isOnBoard,U.identity,6));const L=K.NONE,di=K.ZERO,H2=K.ONE;class Bae extends Zn{constructor(...e){super(...e),u(this,"tutorial",[q.informational($localize`Initial board and object of the game`,$localize`Connect Six is played on a 19x19 board, on which stones are put on the intersections. The aim of the game is to align 6 of your pieces.`,fi.getInitialState()),q.anyMove($localize`First turn`,$localize`On the first turn, the first player plays only one piece.<br/><br/>You're playing Dark, place your first piece by clicking on an intersection.`,fi.getInitialState(),Na.of(new C(9,9)),$localize`Congratulations!`),q.anyMove($localize`Next turns`,$localize`On all following turns, the players play two pieces.<br/><br/>You're playing Light, do the winning move.`,new fi([[L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,H2,L,L,L,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,di,L,H2,di,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,di,di,L,L,H2,L,L,L,L,L,L],[L,L,L,L,L,L,L,H2,di,di,di,di,H2,L,L,L,L,L,L],[L,L,L,L,L,L,H2,di,di,di,di,H2,L,L,L,L,L,L,L],[L,L,L,L,L,L,H2,L,H2,di,H2,H2,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,di,H2,di,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,H2,L,H2,L,di,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,H2,H2,L,H2,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,H2,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,di,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L]],20),Ia.of(new C(4,11),new C(5,10)),$localize`Congratulations!`)])}}let IL=(()=>{var r;class e extends Fi{constructor(...n){super(...n),u(this,"hoshis",[])}createHoshis(){const n=this.board.length,i=Math.floor(n/2),s=n<12?2:3,o=n-(s+1);18<n&&this.hoshis.push(new C(s,i),new C(i,s),new C(i,o),new C(o,i)),this.hoshis.push(new C(i,i),new C(s,s),new C(s,o),new C(o,s),new C(o,o))}isHoshi(n,i){return this.hoshis.some(s=>s.x===n&&s.y===i)}}return r=e,u(e,"\u0275fac",function(){let t;return function(i){return(t||(t=or(r)))(i||r)}}()),u(e,"\u0275cmp",qe({type:r,selectors:[["ng-component"]],features:[Qe],decls:0,vars:0,template:function(n,i){},encapsulation:2})),e})();class Uae extends Un{getListMoves(e){return 0===e.gameState.turn?this.getFirstMove():this.getListDrops(e)}getFirstMove(){const t=fi.HEIGHT,n=Math.floor(fi.WIDTH/2),i=Math.floor(t/2);return[Na.of(new C(n,i))]}getListDrops(e){const t=this.getAvailableCoords(e.gameState),n=[];for(const i of t){const s=e.gameState.getCopiedBoard();s[i.y][i.x]=e.gameState.getCurrentPlayer();const o=new fi(s,e.gameState.turn),a=this.getAvailableCoords(o);for(const c of a){const l=Ia.of(i,c);n.push(l)}}return new dt(n).toList()}getAvailableCoords(e){const t=this.getUsefulCoordsMap(e),n=[];for(const i of e.getCoordsAndContents()){const s=i.coord;!0===t[s.y][s.x]&&!1===i.content.isPlayer()&&n.push(s)}return n}getUsefulCoordsMap(e){const t=Ie.createTable(fi.WIDTH,fi.HEIGHT,!1);for(const n of e.getCoordsAndContents())n.content.isPlayer()&&this.addNeighboringCoord(t,n.coord);return t}addNeighboringCoord(e,t){const i=Math.max(0,t.x-1),s=Math.max(0,t.y-1),o=Math.min(fi.WIDTH-1,t.x+1),a=Math.min(fi.HEIGHT-1,t.y+1);for(let c=s;c<=a;c++)for(let l=i;l<=o;l++)e[c][l]=!0}}class Lft extends wa{getBoardValue(e){const t=e.gameState;let n=0;for(const i of t.getCoordsAndContents())i.content.isPlayer()&&(n+=Fs.CONNECT_SIX_HELPER.getSquareScore(t,i.coord));return new Jn(n)}}class Rft extends on{constructor(){super($localize`Alignment`,Fs.get(),new Lft,new Uae)}}function zft(r,e){if(1&r&&(N(),F(0,"circle",8)),2&r){const t=p().index,n=p().index,i=p();ye("id","piece_",t,"_",n,""),y("ngClass",i.getSpaceClass(t,n)),I("cx",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*t)("cy",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*n)("r",.22*i.SPACE_SIZE)}}function Dft(r,e){if(1&r&&(N(),F(0,"circle",12)),2&r){const t=p(2).index,n=p().index,i=p();ye("id","hoshi_",t,"_",n,""),I("cx",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*t)("cy",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*n)("r",.1*i.SPACE_SIZE)}}function Hft(r,e){if(1&r&&(N(),F(0,"rect",9)(1,"line",10)(2,"line",10),T(3,Dft,1,5,"circle",11)),2&r){const t=p().index,n=p().index,i=p();I("width",.5*i.SPACE_SIZE)("height",.5*i.SPACE_SIZE)("x",.5*i.SPACE_SIZE*t)("y",.5*i.SPACE_SIZE*n),_(1),I("x1",.5*i.SPACE_SIZE*t)("y1",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*n)("x2",.5*i.SPACE_SIZE+.5*i.SPACE_SIZE*t)("y2",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*n),_(1),I("x1",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*t)("y1",.5*i.SPACE_SIZE*n)("x2",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*t)("y2",.5*i.SPACE_SIZE+.5*i.SPACE_SIZE*n),_(1),y("ngIf",i.isHoshi(t,n))}}function Vft(r,e){if(1&r){const t=pe();N(),S(0,"g",5),W("click",function(){const s=te(t).index,o=p().index;return ne(p().onClick(s,o))}),T(1,zft,1,6,"circle",6),T(2,Hft,4,13,"ng-template",null,7,un),P()}if(2&r){const t=e.$implicit,n=e.index,i=cn(3);ye("id","click_",n,"_",p().index,""),_(1),y("ngIf",t.isPlayer())("ngIfElse",i)}}function Fft(r,e){if(1&r&&(N(),S(0,"g"),T(1,Vft,4,4,"g",4),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function $ft(r,e){if(1&r){const t=pe();N(),S(0,"circle",13),W("click",function(){te(t);const i=p();return ne(i.onClick(i.droppedCoord.get().x,i.droppedCoord.get().y))}),P()}if(2&r){const t=p();y("ngClass",t.getSpaceClass(t.droppedCoord.get().x,t.droppedCoord.get().y)),I("cx",.25*t.SPACE_SIZE+.5*t.SPACE_SIZE*t.droppedCoord.get().x)("cy",.25*t.SPACE_SIZE+.5*t.SPACE_SIZE*t.droppedCoord.get().y)("r",.22*t.SPACE_SIZE)}}let Gft=(()=>{var r;class e extends IL{constructor(n){super(n),u(this,"droppedCoord",g.empty()),u(this,"lastMoved",[]),u(this,"victoryCoords",[]),this.rules=Fs.get(),this.node=this.rules.getInitialNode(),this.availableAIs=[new Rft,new Kn($localize`MCTS`,new Uae,this.rules)],this.encoder=NL.encoder,this.tutorial=(new Bae).tutorial}updateBoard(n){var i=this;return M(function*(){const s=i.getState();i.board=s.getCopiedBoard(),i.victoryCoords=Fs.getVictoriousCoords(s),i.createHoshis()})()}showLastMove(n){var i=this;return M(function*(){i.lastMoved=n instanceof Na?[n.coord]:[n.getFirst(),n.getSecond()]})()}onClick(n,i){var s=this;return M(function*(){const o=yield s.canUserPlay("#click_"+n+"_"+i);if(o.isFailure())return s.cancelMove(o.getReason());const a=new C(n,i);if(0===s.getState().turn){const c=Na.of(a);return s.chooseMove(c)}if(s.getState().getPieceAt(a).isPlayer())return s.cancelMove(Re.MUST_CLICK_ON_EMPTY_SQUARE());if(s.droppedCoord.isPresent()){if(s.droppedCoord.equalsValue(a))return s.droppedCoord=g.empty(),b.SUCCESS;{const c=Ia.of(s.droppedCoord.get(),a);return s.chooseMove(c)}}return s.droppedCoord=g.of(a),b.SUCCESS})()}getSpaceClass(n,i){const s=new C(n,i),o=this.getState().getPieceAt(s),a=[];return this.droppedCoord.equalsValue(s)?(a.push(this.getPlayerClass(this.getState().getCurrentPlayer())),a.push("highlighted-stroke")):(a.push(this.getPlayerClass(o)),this.victoryCoords.some(c=>c.equals(s))&&a.push("victory-stroke"),this.lastMoved.some(c=>c.equals(s))&&a.push("last-move-stroke")),a}cancelMoveAttempt(){this.droppedCoord=g.empty()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(Ut))}),u(e,"\u0275cmp",qe({type:r,selectors:[["app-connect-six"]],features:[Qe],decls:4,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["x","0","y","0",1,"base","mid-small-stroke"],[4,"ngFor","ngForOf"],["id","dropped","class","base mid-stroke moved-stroke",3,"ngClass","click",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["class","base mid-stroke",3,"id","ngClass",4,"ngIf","ngIfElse"],["empty",""],[1,"base","mid-stroke",3,"id","ngClass"],["fill-opacity","0",1,"base","no-stroke"],[1,"base","mid-stroke"],["class","base-no-stroke",3,"id",4,"ngIf"],[1,"base-no-stroke",3,"id"],["id","dropped",1,"base","mid-stroke","moved-stroke",3,"ngClass","click"]],template:function(n,i){1&n&&(N(),S(0,"svg",0),F(1,"rect",1),T(2,Fft,2,1,"g",2),T(3,$ft,1,4,"circle",3),P()),2&n&&(I("viewBox","0 -3 "+i.board.length*i.SPACE_SIZE*.5+" "+(6+i.board.length*i.SPACE_SIZE*.5)),_(1),I("width",i.board.length*i.SPACE_SIZE*.5)("height",i.board.length*i.SPACE_SIZE*.5),_(1),y("ngForOf",i.board),_(1),y("ngIf",i.droppedCoord.isPresent()))},dependencies:[Ft,Wt,At],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})(),s4=(()=>{class r{}return u(r,"SIMPLE_MOVE_SHOULD_BE_OF_ONE_STEP",()=>$localize`Your piece should land on a neighboring square.`),u(r,"CANNOT_DROP_AFTER_TURN_40",()=>$localize`You cannot drop a piece during the moving phase.`),u(r,"CANNOT_MOVE_BEFORE_TURN_40",()=>$localize`You cannot move a piece before both players have dropped all of their pieces.`),u(r,"MUST_JUMP_OVER_PIECES",()=>$localize`A jump must be made over a piece, not over an empty square.`),u(r,"MUST_DROP_IN_CENTRAL_ZONE",()=>$localize`A drop must occur in the central zone of the board.`),u(r,"INVALID_JUMP",()=>$localize`A jump must land two squares from its original position, and be done in a straight line in any direction.`),u(r,"SAME_LOCATION_VISITED_IN_JUMP",()=>$localize`You are visiting the same location twice in a move, you are not allowed to do so.`),r})();var sC,jae,g2;class Lt extends W1{static isOnBoard(e){return e.isInRange(Lt.WIDTH,Lt.HEIGHT)}static getInitialState(){const e=Ie.createTable(Lt.WIDTH,Lt.HEIGHT,K.NONE);return new Lt(e,0)}isShelter(e){return 0===e.x||e.x===Lt.WIDTH-1?Lt.SHELTERS_INDICES.some(t=>e.y===t):(0===e.y||e.y===Lt.HEIGHT-1)&&Lt.SHELTERS_INDICES.some(t=>e.x===t)}isCentralZone(e){return e.x>=Lt.CENTRAL_ZONE_TOP_LEFT.x&&e.x<=Lt.CENTRAL_ZONE_BOTTOM_RIGHT.x&&e.y>=Lt.CENTRAL_ZONE_TOP_LEFT.y&&e.y<=Lt.CENTRAL_ZONE_BOTTOM_RIGHT.y}isDropPhase(){return this.turn<40}getSidePieces(){return this.turn%2==0?[20-this.turn/2,20-this.turn/2]:[20-(this.turn-1)/2-1,20-(this.turn-1)/2]}}sC=Lt,u(Lt,"WIDTH",17),u(Lt,"HEIGHT",17),u(Lt,"CENTRAL_ZONE_TOP_LEFT",new C(4,6)),u(Lt,"CENTRAL_ZONE_BOTTOM_RIGHT",new C(12,10)),u(Lt,"SHELTERS_INDICES",[0,1,3,5,7,8,9,11,13,15,16]),u(Lt,"ALL_SHELTERS",new dt(sC.SHELTERS_INDICES.flatMap(r=>[new C(r,0),new C(r,sC.HEIGHT-1),new C(0,r),new C(sC.WIDTH-1,r)])).toList());class o4 extends br{static of(e){return U.assert(Lt.isOnBoard(e),"Move out of board"),new o4(e)}constructor(e){super(e.x,e.y)}toString(){return`ConspirateursMoveDrop(${this.coord.toString()})`}equals(e){return!!g2.isDrop(e)&&this.coord.equals(e.coord)}}u(o4,"encoder",br.getEncoder(o4.of));class a4 extends $o{static from(e,t){const n=Lt.isOnBoard(e),i=Lt.isOnBoard(t);return U.assert(n&&i,"Move out of board"),e.isAlignedWith(t)&&1===e.getDistance(t)?ie.success(new a4(e,t)):ie.failure(s4.SIMPLE_MOVE_SHOULD_BE_OF_ONE_STEP())}constructor(e,t){super(e,t)}toString(){return`ConspirateursMoveSimple(${this.getStart().toString()} -> ${this.getEnd().toString()})`}equals(e){return!!g2.isSimple(e)&&super.equals(e)}}u(a4,"encoder",Hs.getFallibleEncoder(a4.from));class Go extends Di{static from(e){if(e.length<2)return ie.failure("ConspirateursMoveJump requires at least one jump, so two coords");for(const n of e)if(!1===Lt.isOnBoard(n))return ie.failure("Move out of board");for(let n=1;n<e.length;n++)if(e[n-1].getDirectionToward(e[n]).isFailure()||2!==e[n-1].getDistance(e[n]))return ie.failure(s4.INVALID_JUMP());return new q1(e).size()===e.length?ie.success(new Go(e)):ie.failure(s4.SAME_LOCATION_VISITED_IN_JUMP())}constructor(e){super(),u(this,"coords",void 0),this.coords=e}addJump(e){const t=Ie.copyImmutableArray(this.coords);return t.push(e),Go.from(t)}getStartingCoord(){return this.coords[0]}getEndingCoord(){return this.coords[this.coords.length-1]}getLandingCoords(){return this.coords.slice(1)}getJumpedOverCoords(){const e=[];for(let t=1;t<this.coords.length;t++){const n=this.coords[t-1].getDirectionToward(this.coords[t]).get();e.push(this.coords[t-1].getNext(n,1))}return e}toString(){return`ConspirateursMoveJump(${this.coords.map(t=>t.toString()).reduce((t,n)=>t+" -> "+n)})`}equals(e){return!(g2.isSimple(e)||g2.isDrop(e)||e!==this&&(!1===this.getStartingCoord().equals(e.getStartingCoord())||!1===this.getEndingCoord().equals(e.getEndingCoord())))}}jae=Go,u(Go,"encoder",we.tuple([we.list(C.encoder)],r=>[Ie.copyImmutableArray(r.coords)],r=>jae.from(r[0]).get())),function(r){r.isDrop=function e(i){return i instanceof o4},r.isSimple=function t(i){return i instanceof a4},r.isJump=function n(i){return i instanceof Go},r.encoder=we.disjunction([r.isDrop,r.isSimple,r.isJump],[o4.encoder,a4.encoder,Go.encoder])}(g2||(g2={}));const v=K.NONE,vt=K.ZERO,pt=K.ONE;class Zae extends Zn{constructor(...e){super(...e),u(this,"tutorial",[q.informational($localize`Board and aim of the game`,$localize`Conspirateurs is played on a 17x17 board. The goal of the game is to place all of your pieces in shelters, which are the special squares on the edge of the board. Note the central zone in the middle of the board, where each player will put their pieces initially.`,Lt.getInitialState()),q.anyMove($localize`Initial phase`,$localize`In the initial phase of the game, each player drop their 20 pieces, one per turn consecutively, in the central zone of the board. This phase does not allow any other kind of move.<br/><br/>You're playing Dark, drop one of your piece in the central zone.`,Lt.getInitialState(),o4.of(new C(7,7)),$localize`Congratulations!`),q.fromPredicate($localize`Simple move`,$localize`Once all pieces have been placed, there are two kind of moves that can be performed. The first is a simple move in any direction, orthogonally or diagonally, of a single step.<br/><br/>You're playing Dark. Click on one of your piece and perform such a move.`,new Lt([[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,vt,vt,pt,pt,vt,vt,pt,vt,pt,v,v,v,v],[v,v,v,v,vt,pt,vt,pt,vt,vt,vt,vt,pt,v,v,v,v],[v,v,v,v,vt,pt,v,v,v,v,v,pt,vt,v,v,v,v],[v,v,v,v,pt,vt,vt,pt,pt,pt,vt,vt,vt,v,v,v,v],[v,v,v,v,pt,vt,pt,pt,pt,pt,pt,pt,vt,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v]],40),a4.from(new C(4,6),new C(3,5)).get(),(t,n,i)=>g2.isSimple(t)?b.SUCCESS:b.failure($localize`You have made a jump, not a simple move. Try again!`),$localize`Congratulations!`),q.fromPredicate($localize`Jumps`,$localize`The other type of move is a jump. A piece can jump over a neighboring piece in any direction, as long as it lands directly on the square after that piece, along the same direction.<br/><br/>You're playing Dark. Perform a jump by clicking on one of your piece that can perform a jump, and then on the target square. You may need to click a second time on the target square to confirm your jump, in case your piece is still highlighted (we will see shortly why this is useful).`,new Lt([[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,vt,vt,pt,pt,vt,vt,pt,vt,pt,v,v,v,v],[v,v,v,v,vt,pt,vt,pt,vt,vt,vt,vt,pt,v,v,v,v],[v,v,v,v,vt,pt,v,v,v,v,v,pt,vt,v,v,v,v],[v,v,v,v,pt,vt,vt,pt,pt,pt,vt,vt,vt,v,v,v,v],[v,v,v,v,pt,vt,pt,pt,pt,pt,pt,pt,vt,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v]],40),Go.from([new C(6,7),new C(6,5)]).get(),(t,n,i)=>g2.isJump(t)?b.SUCCESS:b.failure($localize`You have not performed a jump. Try again!`),$localize`Congratulations!`),q.fromMove($localize`Chaining jumps in a single move`,$localize`Jumps can be chained when possible. You can decide whether to continue a jump or to stop it at any time. To finish your jump, click a second time on your current location. Otherwise, simply keep clicking on your next location. Once no more destination is possible, your move will end without you needing to click the piece a second time.<br/><br/>You're playing Dark and you can perform a triple jump! Do it.`,new Lt([[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,pt,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,pt,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,pt,v,v,v,v,v,v,v,v,v],[v,v,v,v,vt,vt,v,pt,vt,vt,pt,vt,pt,v,v,v,v],[v,v,v,v,vt,v,vt,pt,vt,vt,vt,vt,pt,v,v,v,v],[v,v,v,v,vt,pt,v,v,v,v,v,pt,vt,v,v,v,v],[v,v,v,v,pt,vt,vt,pt,pt,pt,vt,vt,vt,v,v,v,v],[v,v,v,v,pt,vt,pt,pt,pt,pt,pt,pt,vt,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v]],40),[Go.from([new C(8,6),new C(6,4),new C(6,2),new C(6,0)]).get()],$localize`Congratulations! You now know everything to play the game. Remember: to win, you have to place all of your pieces in shelters before your opponent does.`,$localize`You have not performed a triple jump. Try again!`)])}}class $s extends Yn{static get(){return $s.singleton.isAbsent()&&($s.singleton=g.of(new $s)),$s.singleton.get()}constructor(){super(Lt)}applyLegalMove(e,t,n){const i=t.getCopiedBoard();if(g2.isDrop(e))i[e.coord.y][e.coord.x]=t.getCurrentPlayer();else if(g2.isSimple(e))i[e.getStart().y][e.getStart().x]=K.NONE,i[e.getEnd().y][e.getEnd().x]=t.getCurrentPlayer();else{const s=e.getStartingCoord(),o=e.getEndingCoord();i[s.y][s.x]=K.NONE,i[o.y][o.x]=t.getCurrentPlayer()}return new Lt(i,t.turn+1)}isLegal(e,t){return g2.isDrop(e)?this.dropLegality(e,t):g2.isSimple(e)?this.simpleMoveLegality(e,t):this.jumpLegality(e,t)}dropLegality(e,t){return t.turn>=40?b.failure(s4.CANNOT_DROP_AFTER_TURN_40()):t.getPieceAt(e.coord).isPlayer()?b.failure(Re.MUST_LAND_ON_EMPTY_SPACE()):!1===t.isCentralZone(e.coord)?b.failure(s4.MUST_DROP_IN_CENTRAL_ZONE()):b.SUCCESS}simpleMoveLegality(e,t){return t.turn<40?b.failure(s4.CANNOT_MOVE_BEFORE_TURN_40()):t.getPieceAt(e.getStart())!==t.getCurrentPlayer()?b.failure(Re.MUST_CHOOSE_PLAYER_PIECE()):t.getPieceAt(e.getEnd()).isPlayer()?b.failure(Re.MUST_LAND_ON_EMPTY_SPACE()):b.SUCCESS}jumpLegality(e,t){if(t.turn<40)return b.failure(s4.CANNOT_MOVE_BEFORE_TURN_40());if(t.getPieceAt(e.getStartingCoord())!==t.getCurrentPlayer())return b.failure(Re.MUST_CHOOSE_PLAYER_PIECE());for(const n of e.getJumpedOverCoords())if(t.getPieceAt(n)===K.NONE)return b.failure(s4.MUST_JUMP_OVER_PIECES());for(const n of e.getLandingCoords())if(t.getPieceAt(n).isPlayer())return b.failure(Re.MUST_LAND_ON_EMPTY_SPACE());return b.SUCCESS}jumpTargetsFrom(e){const t=[new C(e.x+2,e.y),new C(e.x-2,e.y),new C(e.x,e.y+2),new C(e.x,e.y-2),new C(e.x+2,e.y+2),new C(e.x+2,e.y-2),new C(e.x-2,e.y+2),new C(e.x-2,e.y-2)],n=[];for(const i of t)Go.from([e,i]).isSuccess()&&n.push(i);return n}nextJumps(e,t){const n=e.getEndingCoord(),i=[];for(const s of this.jumpTargetsFrom(n)){const o=e.addJump(s);o.isSuccess()&&this.jumpLegality(o.get(),t).isSuccess()&&i.push(o.get())}return i}jumpHasPossibleNextTargets(e,t){return this.nextJumps(e,t).length>0}getGameStatus(e){const t=e.gameState,n=[0,0];for(const i of Lt.ALL_SHELTERS){const s=t.getPieceAt(i);if(s.isPlayer()&&(n[s.value]+=1,20===n[s.value]))return _e.getVictory(s)}return _e.ONGOING}}u($s,"singleton",g.empty());let Id=(()=>{class r{}return u(r,"NO_MORE_PIECES_OF_THIS_TYPE",()=>$localize`You do not have any pieces of this type anymore.`),u(r,"SPACE_IS_FULL",()=>$localize`You cannot play here: this space is already full.`),u(r,"TARGET_STACK_TOO_HIGH",()=>$localize`You cannot add more pieces to the target stack, as it will contain more than 4 pieces.`),u(r,"MUST_SHIFT_TO_NEIGHBOR",()=>$localize`To perform a shift, you must move the pieces to a neighboring space.`),u(r,"MUST_SELECT_PIECE_FIRST",()=>$localize`You must first select either a piece from the side, or a stack of pieces to shift on the board.`),r})();var ka,Yae,Kae;class Pn{static of(e,t){return e===k.ZERO?t?Pn.ZERO_SECOND:Pn.ZERO_FIRST:e===k.ONE?t?Pn.ONE_SECOND:Pn.ONE_FIRST:Pn.EMPTY}constructor(e,t){u(this,"owner",void 0),u(this,"otherPieceType",void 0),this.owner=e,this.otherPieceType=t}toString(){return`DiamPiece(${this.owner}, ${this.otherPieceType})`}equals(e){return this===e}}ka=Pn,u(Pn,"encoder",we.tuple([K.encoder,we.identity()],r=>[r.owner,r.otherPieceType],r=>ka.of(r[0],r[1]))),u(Pn,"EMPTY",new ka(K.NONE,!1)),u(Pn,"ZERO_FIRST",new ka(k.ZERO,!1)),u(Pn,"ZERO_SECOND",new ka(k.ZERO,!0)),u(Pn,"ONE_FIRST",new ka(k.ONE,!1)),u(Pn,"ONE_SECOND",new ka(k.ONE,!0)),u(Pn,"PLAYER_PIECES",[ka.ZERO_FIRST,ka.ZERO_SECOND,ka.ONE_FIRST,ka.ONE_SECOND]);class Xae extends Di{isDrop(){return this instanceof c4}isShift(){return this instanceof V2}}class c4 extends Xae{constructor(e,t){if(super(),u(this,"target",void 0),u(this,"piece",void 0),this.target=e,this.piece=t,t===Pn.EMPTY)throw new Error("Cannot drop an empty piece")}getTarget(){return this.target}equals(e){return e instanceof c4&&!(this.target!==e.target||this.piece!==e.piece)}toString(){return`DiamMoveDrop(${this.target}, ${this.piece})`}}Yae=c4,u(c4,"encoder",we.tuple([we.identity(),Pn.encoder],r=>[r.target,r.piece],r=>new Yae(r[0],r[1])));class V2 extends Xae{static ofRepresentation(e,t){return new V2(new C(e.x,3-e.y),t)}constructor(e,t){super(),u(this,"start",void 0),u(this,"moveDirection",void 0),this.start=e,this.moveDirection=t}getTarget(){return"clockwise"===this.moveDirection?(this.start.x+1)%8:(this.start.x+7)%8}equals(e){return e instanceof V2&&!(!1===this.start.equals(e.start)||this.moveDirection!==e.moveDirection)}toString(){return`DiamMoveShift(${this.start}, ${this.moveDirection})`}}Kae=V2,u(V2,"encoder",we.tuple([C.encoder,we.identity()],r=>[r.start,"clockwise"===r.moveDirection],r=>new Kae(r[0],r[1]?"clockwise":"counterclockwise")));const Bft=we.disjunction([r=>r.isDrop(),r=>r.isShift()],[c4.encoder,V2.encoder]);let er=(()=>{class r extends W1{static getInitialState(){const t=Pn.EMPTY;return new r([[t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t]],[4,4,4,4],0)}static ofRepresentation(t,n){const i=t.reverse(),s=[4,4,4,4];for(let o=0;o<r.HEIGHT;o++)for(let a=0;a<r.WIDTH;a++)i[o][a]!==Pn.EMPTY&&s[r.pieceIndex(i[o][a])]--;return Ze(s.every(o=>o>=0),"Invalid DiamState representation uses too many pieces"),new r(i,s,n)}static pieceIndex(t){switch(t){case Pn.ZERO_FIRST:return 0;case Pn.ZERO_SECOND:return 1;case Pn.ONE_FIRST:return 2;default:return U.expectToBe(t,Pn.ONE_SECOND),3}}constructor(t,n,i){super(t,i),u(this,"remainingPieces",void 0),this.remainingPieces=n}getRemainingPiecesOf(t){return this.remainingPieces[r.pieceIndex(t)]}getStackHeight(t){let n=0;for(let i=0;i<r.HEIGHT&&this.getPieceAtXY(t,i)!==Pn.EMPTY;i++)n++;return n}}return u(r,"WIDTH",8),u(r,"HEIGHT",4),r})();class Dc extends Yn{static get(){return Dc.singleton.isAbsent()&&(Dc.singleton=g.of(new Dc)),Dc.singleton.get()}constructor(){super(er)}applyLegalMove(e,t,n){return e.isDrop()?this.applyLegalDrop(e,t):this.applyLegalShift(e,t)}applyLegalDrop(e,t){const n=Ie.copyBiArray(t.board);n[t.getStackHeight(e.target)][e.target]=e.piece;const i=Ie.copyImmutableArray(t.remainingPieces);return i[er.pieceIndex(e.piece)]-=1,new er(n,i,t.turn+1)}applyLegalShift(e,t){const n=Ie.copyBiArray(t.board),i=e.getTarget();let s=t.getStackHeight(i),o=e.start.y;for(;o<er.HEIGHT&&t.getPieceAtXY(e.start.x,o)!==Pn.EMPTY;)n[s][i]=t.getPieceAtXY(e.start.x,o),n[o][e.start.x]=Pn.EMPTY,s++,o++;return new er(n,t.remainingPieces,t.turn+1)}isLegal(e,t){return e.isDrop()?this.isDropLegal(e,t):this.isShiftLegal(e,t)}isDropLegal(e,t){return e.piece.owner!==t.getCurrentPlayer()?b.failure(Re.MUST_CHOOSE_PLAYER_PIECE()):0===t.getRemainingPiecesOf(e.piece)?b.failure(Id.NO_MORE_PIECES_OF_THIS_TYPE()):this.dropHeightValidity(e,t)}dropHeightValidity(e,t){return t.getStackHeight(e.target)===er.HEIGHT?b.failure(Id.SPACE_IS_FULL()):b.SUCCESS}isShiftLegal(e,t){return t.getPieceAt(e.start).owner!==t.getCurrentPlayer()?b.failure(Re.MUST_CHOOSE_PLAYER_PIECE()):this.shiftHeightValidity(e,t)}shiftHeightValidity(e,t){const n=t.getStackHeight(e.start.x)-e.start.y;return t.getStackHeight(e.getTarget())+n>er.HEIGHT?b.failure(Id.TARGET_STACK_TOO_HIGH()):b.SUCCESS}getGameStatus(e){const t=this.findHighestAlignment(e.gameState);if(t.isPresent()){const n=e.gameState.getPieceAt(t.get());return Ze(n.owner.isPlayer(),"highest alignment is owned by a player"),_e.getVictory(n.owner)}return _e.ONGOING}findHighestAlignment(e){for(let t=0;t<er.WIDTH/2;t++)for(let n=er.HEIGHT-1;n>0;n--){const i=e.getPieceAtXY(t,n),s=e.getPieceAtXY(t+er.WIDTH/2,n);if(i!==Pn.EMPTY&&i===s)return g.of(new C(t,n))}return g.empty()}pieceCanMove(e,t){return!!this.isShiftLegal(new V2(t,"clockwise"),e).isSuccess()||!!this.isShiftLegal(new V2(t,"counterclockwise"),e).isSuccess()}}u(Dc,"singleton",g.empty());const $e=Pn.EMPTY,du=Pn.ZERO_FIRST,Qae=Pn.ZERO_SECOND,oC=Pn.ONE_FIRST,kL=Pn.ONE_SECOND;class Jae{constructor(){u(this,"tutorial",[q.informational($localize`Initial board and player pieces`,$localize`Diam's board is a circular board made of 8 spaces. Each player has 8 pieces: 4 of one color, and 4 of another color. Initially, the board is empty. All the remaining pieces are displayed next to the board: Dark's pieces are on the left, Light's pieces are on the right.`,er.getInitialState()),q.fromMove($localize`Goal of the game`,$localize`At Diam, the goal is to align two of your pieces, having exactly the same color, on diametrically opposed spaces, on top of at least another piece. Note here that Dark does not win because the dark pieces are not on top of any other piece. You're playing Light. Here, you can win by dropping one of your pieces on the leftmost space. You can do it by clicking on the corresponding piece next to the board, and then on the space in which you want to drop your piece.<br/><br/>You're playing Light, win the game!`,er.ofRepresentation([[$e,$e,$e,$e,$e,$e,$e,$e],[$e,$e,$e,$e,$e,$e,$e,$e],[$e,$e,$e,$e,oC,$e,$e,$e],[du,$e,$e,$e,du,$e,$e,$e]],3),[new c4(0,Pn.ONE_FIRST)],$localize`Congratulations, you won!`,$localize`Failed, you should drop your piece on the leftmost space, using the piece of the same color of the other piece you already have on the board.`),q.fromMove($localize`Types of move`,$localize`You can perform two types of move: either dropping one of your piece like you did in the previous step, or you can shift one of your pieces on the board to a neighboring space. You can pick any of your piece on the board, even if there are pieces on top of it. Only one condition applies: there can never be more than 4 pieces in a space. When you pick a piece with other pieces on top of it, all the other pieces move with yours.<br/><br/>You're playing Dark, try to move one of your piece that is already on the board.`,er.ofRepresentation([[$e,$e,$e,$e,$e,$e,$e,$e],[$e,$e,$e,$e,kL,$e,$e,$e],[$e,$e,$e,$e,du,$e,$e,$e],[oC,$e,$e,$e,Qae,$e,$e,$e]],4),[V2.ofRepresentation(new C(4,3),"counterclockwise"),V2.ofRepresentation(new C(4,3),"clockwise"),V2.ofRepresentation(new C(4,2),"counterclockwise"),V2.ofRepresentation(new C(4,2),"clockwise")],$localize`Congratulations!`,$localize`Failed, try to move one of your piece that is already on the board.`),q.fromMove($localize`Special case`,$localize`It can happen that, in a single turn, both players reach an alignment. If it is the case, only the player with the highest alignment wins.<br/><br/>Here, playing Dark, you can win by performing such a move, do it!`,er.ofRepresentation([[$e,$e,$e,$e,du,$e,$e,$e],[$e,$e,$e,$e,kL,$e,$e,du],[$e,$e,$e,$e,du,$e,$e,kL],[$e,oC,$e,$e,Qae,$e,$e,oC]],8),[V2.ofRepresentation(new C(4,2),"counterclockwise")],$localize`Congratulations!`,$localize`Failed, try to shift a stack of pieces to the left.`)])}}let ece=(()=>{var r;class e extends El{constructor(...n){super(...n),u(this,"SPACE_SIZE",100),u(this,"board",void 0)}getTriangleCornerCoords(n,i){return(n+i)%2==0?this.getUpwardCoordinate():this.getDownwardCoordinate()}getTrianglePoints(n,i){return this.getTriangleCornerCoords(n,i).map(a=>a.x+","+a.y).reduce((a,c)=>a+","+c)}getTriangleTranslateCoord(n,i){return new C(.5*n*this.SPACE_SIZE,i*this.SPACE_SIZE)}getTriangleTranslate(n,i){const s=this.getTriangleTranslateCoord(n,i);return"translate("+s.x+", "+s.y+")"}getDownwardCoordinate(){const s=this.SPACE_SIZE/2,o=-this.SPACE_SIZE/2,a=this.SPACE_SIZE/2,c=new C(-this.SPACE_SIZE/2,o);return[c,new C(0,a),new C(s,o),c]}getUpwardCoordinate(){const s=this.SPACE_SIZE/2,o=-this.SPACE_SIZE/2,a=this.SPACE_SIZE/2,c=new C(-this.SPACE_SIZE/2,a);return[c,new C(0,o),new C(s,a),c]}getPyramidPoints(n,i){return(n+i)%2==1?this.getDownwardPyramidPoints():this.getUpwardPyramidPoints()}getDownwardPyramidPoints(){const n=this.SPACE_SIZE/2,i=-n+", "+-n,s=n+", "+-n,o="0, "+n,a="0, 0";return i+","+o+","+a+","+i+","+a+","+s+","+i+","+s+","+o+","+a+","+s}getUpwardPyramidPoints(){const n=this.SPACE_SIZE/2,i=-n+", "+n,s=n+", "+n,o="0, "+-n,a="0, 0";return i+","+o+","+a+","+i+","+a+","+s+","+i+","+s+","+o+","+a+","+s}}return r=e,u(e,"\u0275fac",function(){let t;return function(i){return(t||(t=or(r)))(i||r)}}()),u(e,"\u0275cmp",qe({type:r,selectors:[["ng-component"]],features:[Qe],decls:0,vars:0,template:function(n,i){},encapsulation:2})),e})(),kd=(()=>{class r{}return u(r,"INVALID_DISTANCE",()=>$localize`Your piece must land on one of the closest six triangles with the same color as the triangle on which the piece is.`),u(r,"NOT_ENOUGH_TILES_TO_EXCHANGE",()=>$localize`You do not have enough tiles to exchange in order to capture this piece. Pick one of your piece and move it.`),u(r,"FIRST_CLICK_SHOULD_NOT_BE_NULL",()=>$localize`Your first click must be on the piece that you want to move, or on a piece of your opponent that you want to exchange against two tiles.`),u(r,"CANNOT_CAPTURE_FROM_EMPTY",()=>$localize`You cannot capture from an empty space.`),r})();class Bo{static getNeighbors(e){let t;const n=new C(e.x-1,e.y),i=new C(e.x+1,e.y);return t=(e.x+e.y)%2==1?[n,i,new C(e.x,e.y-1)]:[n,i,new C(e.x,e.y+1)],t}static getFakeNeighbors(e){return new C(e.x,(e.x+e.y)%2==1?e.y+1:e.y-1)}static getCommonNeighbor(e,t){const n=Bo.getNeighbors(e),i=Bo.getNeighbors(t);let s=0;for(;s<n.length;){const o=n[s];let a=0;for(;a<i.length;){if(o.equals(i[a]))return g.of(o);a++}s++}return g.empty()}static isSpaceDark(e){return(e.x+e.y)%2==0}}class b0 extends W1{static getEmptyNeighbors(e,t,n){const i=[];for(const s of Bo.getNeighbors(t))s.isInRange(e[0].length,e.length)&&e[s.y][s.x]===n&&i.push(s);return i}getEmptyNeighbors(e,t){return b0.getEmptyNeighbors(this.board,e,t)}}var aC,xa;let Ur=(aC=class extends b0{static getTilesUpperLeftCoord(e){const t=e.x-e.x%3;let n=e.y;return n-=t%2==0?e.y%2:(e.y+1)%2,new C(t,n)}static isOnBoard(e){return e.isInRange(15,10)}static getPresentNeighborEntrances(e){return[new C(e.x+1,e.y-1),new C(e.x+3,e.y+0),new C(e.x+3,e.y+1),new C(e.x+1,e.y+2),new C(e.x-1,e.y+1),new C(e.x-1,e.y+0)].filter(xa.isOnBoard)}static getInitialState(){const e=Ce.EMPTY,t=Ce.UNREACHABLE,n=Ce.ZERO,i=Ce.ONE;return new xa([[t,t,t,t,t,t,n,e,n,t,t,t,t,t,t],[t,t,t,e,e,n,e,e,e,n,e,e,t,t,t],[e,i,e,i,e,e,n,e,n,e,e,i,e,i,e],[i,e,e,e,i,e,e,e,e,e,i,e,e,e,i],[e,i,e,i,e,e,e,e,e,e,e,i,e,i,e],[e,n,e,n,e,e,e,e,e,e,e,n,e,n,e],[n,e,e,e,n,e,e,e,e,e,n,e,e,e,n],[e,n,e,n,e,e,i,e,i,e,e,n,e,n,e],[t,t,t,e,e,i,e,e,e,i,e,e,t,t,t],[t,t,t,t,t,t,i,e,i,t,t,t,t,t,t]],0,[0,0],[0,0])}constructor(e,t,n,i){super(e,t),u(this,"tiles",void 0),u(this,"captures",void 0),this.tiles=n,this.captures=i}applyLegalMovement(e){const t=e.getStart(),n=e.getEnd(),i=this.getCopiedBoard();return i[n.y][n.x]=Ce.ofPlayer(this.getCurrentPlayer()),i[t.y][t.x]=Ce.EMPTY,new xa(i,this.turn,this.tiles,this.captures)}doMovementCaptures(e){const t=this.getCapturedNeighbors(e.getEnd());let n=this;for(const i of t)n=n.capture(i);return n}getCapturedNeighbors(e){const t=this.getCurrentOpponent();return Bo.getNeighbors(e).filter(i=>!i.isNotInRange(15,10)&&!!this.getPieceAt(i).is(t)&&this.isSurrounded(i))}isSurrounded(e){return 0===this.getEmptyNeighbors(e,Ce.EMPTY).length}capture(e){const t=this.getCopiedBoard(),n=[this.captures[0],this.captures[1]];return t[e.y][e.x]=Ce.EMPTY,n[this.getCurrentPlayer().value]+=1,new xa(t,this.turn,this.tiles,n)}removeTilesIfNeeded(e,t){let n=this;const i=xa.getTilesUpperLeftCoord(e);if(this.isTileEmpty(i)&&this.isDeconnectable(i)){n=this.deconnectTile(i,t);const s=xa.getPresentNeighborEntrances(i);for(const o of s){const a=n.getPieceAt(o);a===Ce.EMPTY?n=n.removeTilesIfNeeded(o,t):a.is(this.getCurrentOpponent())&&n.isSurrounded(o)&&(n=n.capture(o))}}return n}isTileEmpty(e){U.assert(this.getPieceAt(e)!==Ce.UNREACHABLE,"Should not call isTileEmpty on removed tile");for(let t=0;t<2;t++)for(let n=0;n<3;n++){const i=e.getNext(new St(n,t),1);if(this.getPieceAt(i)!==Ce.EMPTY)return!1}return!0}isDeconnectable(e){const t=this.getPresentNeighborTilesRelativeIndexes(e);if(t.length>3)return!1;let n=0;for(let i=1;i<t.length;i++)!1===this.areNeighbor(t[i-1],t[i])&&(n+=1);return!1===this.areNeighbor(t[0],t[t.length-1])&&(n+=1),n<=1}areNeighbor(e,t){return e+1===t||0===e&&5===t}getPresentNeighborTilesRelativeIndexes(e){const t=[];let n=g.empty();for(let i=0;i<6;i++){const o=e.getNext(xa.NEIGHBORS_TILES_DIRECTIONS[i],1);xa.isOnBoard(o)&&this.getPieceAt(o)!==Ce.UNREACHABLE&&(n.isAbsent()&&(n=g.of(i)),t.push(i-n.get()))}return t}deconnectTile(e,t){const n=this.getCopiedBoard(),i=e.x,s=e.y;for(let a=0;a<2;a++)for(let c=0;c<3;c++)n[s+a][i+c]=Ce.UNREACHABLE;const o=[this.tiles[0],this.tiles[1]];return t&&(o[this.getCurrentPlayer().value]+=1),new xa(n,this.turn,o,this.captures)}getLegalLandings(e){const t=[];for(const n of ms.STEPS){const i=e.getNext(n.direction,1);this.isOnBoard(i)&&this.getPieceAt(i)===Ce.EMPTY&&t.push(i)}return t}getPiecesByFreedom(){const e=[[0,0,0,0],[0,0,0,0]];for(let t=0;t<10;t++)for(let n=0;n<15;n++){const i=this.board[t][n];if(i.isPlayer()){const s=this.getEmptyNeighbors(new C(n,t),Ce.EMPTY).length;e[i.value][s]=e[i.value][s]+1}}return e}},xa=aC,u(aC,"NEIGHBORS_TILES_DIRECTIONS",[new St(0,-2),new St(3,-1),new St(3,1),new St(0,2),new St(-3,1),new St(-3,-1)]),aC);var go,bl,cC,w0;Ur=xa=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ne.log],Ur);class ms{static ofCoords(e,t){const n=e.getVectorToward(t),i=ms.STEPS.findIndex(s=>s.direction.equals(n));return U.assert(-1!==i,kd.INVALID_DISTANCE()),ms.STEPS[i]}constructor(e,t){u(this,"direction",void 0),u(this,"str",void 0),this.direction=e,this.str=t}}u(ms,"LEFT",new(go=ms)(new St(-2,0),"LEFT")),u(ms,"UP_LEFT",new go(Me.UP_LEFT,"UP_LEFT")),u(ms,"UP_RIGHT",new go(Me.UP_RIGHT,"UP_RIGHT")),u(ms,"RIGHT",new go(new St(2,0),"RIGHT")),u(ms,"DOWN_LEFT",new go(Me.DOWN_LEFT,"DOWN_LEFT")),u(ms,"DOWN_RIGHT",new go(Me.DOWN_RIGHT,"DOWN_RIGHT")),u(ms,"STEPS",[go.LEFT,go.UP_LEFT,go.UP_RIGHT,go.RIGHT,go.DOWN_LEFT,go.DOWN_RIGHT]);class F2 extends $o{static of(e,t){const n=ms.ofCoords(e,t);return F2.ofMovement(e,n)}static ofMovement(e,t){U.assert(Ur.isOnBoard(e),"Starting coord cannot be out of range (width: 15, height: 10).");const n=new C(e.x+t.direction.x,e.y+t.direction.y);return U.assert(Ur.isOnBoard(n),"Landing coord cannot be out of range (width: 15, height: 10)."),new F2(e,n)}constructor(e,t){super(e,t)}toString(){return"CoerceoRegularMove("+this.getStart().toString()+" > "+this.getEnd().toString()+")"}equals(e){return!bl.isTileExchange(e)&&super.equals(e)}}u(F2,"encoder",$o.getEncoder(F2.of));class l4 extends br{static of(e){return U.assert(Ur.isOnBoard(e),"Captured coord cannot be out of range (width: 15, height: 10)."),new l4(e)}constructor(e){super(e.x,e.y)}toString(){return"CoerceoTileExchangeMove("+this.coord.x+", "+this.coord.y+")"}equals(e){return!!bl.isTileExchange(e)&&e.coord.equals(this.coord)}}u(l4,"encoder",br.getEncoder(l4.of)),function(r){r.isNormalMove=function e(n){return n instanceof F2},r.isTileExchange=function t(n){return n instanceof l4},r.encoder=we.disjunction([r.isNormalMove,r.isTileExchange],[F2.encoder,l4.encoder])}(bl||(bl={}));let lC=(cC=class extends Yn{static get(){return w0.singleton.isAbsent()&&(w0.singleton=g.of(new w0)),w0.singleton.get()}constructor(){super(Ur)}applyLegalMove(e,t,n){return bl.isTileExchange(e)?this.applyLegalTileExchange(e,t):this.applyLegalMovement(e,t)}applyLegalTileExchange(e,t){const n=t.getCopiedBoard(),i=e.coord;n[i.y][i.x]=Ce.EMPTY;const s=[t.captures[0],t.captures[1]];s[t.getCurrentPlayer().value]+=1;const o=[t.tiles[0],t.tiles[1]];o[t.getCurrentPlayer().value]-=2;const c=new Ur(n,t.turn,o,s).removeTilesIfNeeded(i,!1);return new Ur(c.getCopiedBoard(),c.turn+1,c.tiles,c.captures)}applyLegalMovement(e,t){const s=t.applyLegalMovement(e).removeTilesIfNeeded(e.getStart(),!0).doMovementCaptures(e);return new Ur(s.board,t.turn+1,s.tiles,s.captures)}isLegal(e,t){return bl.isTileExchange(e)?this.isLegalTileExchange(e,t):this.isLegalMovement(e,t)}isLegalTileExchange(e,t){if(t.tiles[t.getCurrentPlayer().value]<2)return b.failure(kd.NOT_ENOUGH_TILES_TO_EXCHANGE());const n=t.getPieceAt(e.coord);return n===Ce.UNREACHABLE||n===Ce.EMPTY?b.failure(kd.CANNOT_CAPTURE_FROM_EMPTY()):n.is(t.getCurrentPlayer())?b.failure(Re.CANNOT_SELF_CAPTURE()):b.SUCCESS}isLegalMovement(e,t){U.assert(t.getPieceAt(e.getStart())!==Ce.UNREACHABLE,"Cannot start with a coord outside the board "+e.getStart().toString()+"."),U.assert(t.getPieceAt(e.getEnd())!==Ce.UNREACHABLE,"Cannot end with a coord outside the board "+e.getEnd().toString()+".");const n=t.getPieceAt(e.getStart());return n===Ce.EMPTY?b.failure(Re.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):n.is(t.getCurrentOpponent())?b.failure(Re.CANNOT_CHOOSE_OPPONENT_PIECE()):t.getPieceAt(e.getEnd()).is(t.getCurrentPlayer())?b.failure(Re.MUST_LAND_ON_EMPTY_SPACE()):b.SUCCESS}static getGameStatus(e){const t=e.gameState;return t.captures[0]>=18?_e.ZERO_WON:t.captures[1]>=18?_e.ONE_WON:_e.ONGOING}getGameStatus(e){return w0.getGameStatus(e)}},w0=cC,u(cC,"singleton",g.empty()),cC);lC=w0=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ne.log],lC);const ee=Ce.EMPTY,x=Ce.UNREACHABLE,i1=Ce.ZERO,gn=Ce.ONE;class rce extends Zn{constructor(...e){super(...e),u(this,"tutorial",[q.informational($localize`Board and goal of the game`,$localize`Coerceo is played on a board like this, composed of hexagonal tiles, each comprising 6 triangles.
         The triangles are the spaces on which pieces move during the game.
         The tiles can be removed from the board (you will see how later).
         The dark pieces belong to the first player and can only move on the dark spaces,
         while the light pieces belong to the second player and can only move on the light spaces.
         The goal of the game is to capture all of the opponent's pieces.`,Ur.getInitialState()),q.anyMove($localize`Move`,$localize`To move a piece, you need to:
        <ol>
          <li>Click on one of your pieces.</li>
          <li>Click on one of the triangular space highlighted in yellow.</li>
        </ol>
        You can pass through the opponent's pieces.<br/><br/>
        You're playing first, hence you're playing Dark.
        Perform any move.`,Ur.getInitialState(),F2.of(new C(3,5),new C(5,5)),$localize`Congratulations! Let's see captures now.`),q.fromMove($localize`Capture`,$localize`Every piece has three neighboring triangular spaces (2 on the sides).
        When all neighboring spaces except one are occupied, and one opponent moves to that last free space, your piece is captured!
        However, it is possible to place a piece between 3 of the opponent's pieces (or 2 on the side) without being captured.<br/><br/>
        You're playing Light, make a capture.`,new Ur([[x,x,x,x,x,x,i1,ee,i1,x,x,x,x,x,x],[x,x,x,i1,ee,ee,ee,ee,ee,i1,ee,ee,x,x,x],[ee,gn,ee,gn,i1,gn,ee,ee,i1,ee,ee,gn,ee,gn,ee],[gn,ee,ee,ee,ee,ee,ee,ee,ee,ee,gn,ee,ee,ee,gn],[ee,gn,ee,gn,ee,ee,ee,ee,ee,ee,ee,gn,ee,gn,ee],[ee,i1,ee,i1,ee,ee,ee,ee,ee,ee,ee,i1,ee,i1,ee],[i1,ee,ee,ee,i1,ee,ee,ee,ee,ee,i1,ee,ee,ee,i1],[ee,i1,ee,i1,ee,ee,gn,ee,gn,ee,ee,i1,ee,i1,ee],[x,x,x,ee,ee,gn,ee,ee,ee,gn,ee,ee,x,x,x],[x,x,x,x,x,x,gn,ee,gn,x,x,x,x,x,x]],3,[0,0],[0,0]),[F2.of(new C(5,2),new C(4,1)),F2.of(new C(3,4),new C(4,3))],$localize`Congratulations!`,$localize`Failed, you have not captured any piece.`),q.fromMove($localize`Gain a tile`,$localize`When a tile is empty, it can become removable from the board.
        For it to be removable, at least three of its sides must be free, and these should be neighboring sides.
        Note that if one empty tile, neighboring a tile that was just removed, also becomes removable, it will be removed too.
        For example, here, the topmost dark piece will not disconnect its tile when leaving it.
        But, by leaving the bottom left tile, two tiles will be removed.<br/><br/>
        You're playing Dark, perform a move that lets you gain two tiles.`,new Ur([[x,x,x,x,x,x,ee,ee,ee,x,x,x,x,x,x],[x,x,x,x,x,x,gn,ee,ee,x,x,x,x,x,x],[ee,ee,ee,x,x,x,ee,ee,ee,x,x,x,x,x,x],[ee,ee,gn,ee,ee,ee,ee,i1,ee,x,x,x,x,x,x],[ee,ee,ee,gn,ee,ee,ee,ee,ee,x,x,x,x,x,x],[ee,ee,ee,ee,ee,ee,ee,ee,ee,ee,ee,i1,x,x,x],[ee,ee,i1,ee,ee,gn,ee,ee,ee,ee,i1,ee,ee,ee,i1],[ee,ee,ee,ee,ee,ee,gn,ee,gn,ee,ee,i1,ee,i1,ee],[x,x,x,ee,ee,gn,ee,ee,ee,gn,ee,ee,x,x,x],[x,x,x,x,x,x,gn,ee,gn,x,x,x,x,x,x]],2,[0,0],[0,0]),[F2.of(new C(2,6),new C(4,6)),F2.of(new C(2,6),new C(3,5)),F2.of(new C(2,6),new C(3,7))],$localize`Congratulations!`,$localize`Failed, you have not gained the two tiles that you could, try again!`),q.fromMove($localize`Exchanging a tile`,$localize`When you have a tile, you can see it on the left of the board.
        As soon as you have two, you can click on an opponent's piece to capture it immediately instead of moving one of your pieces.
        This will cost you two tiles.
        If any tiles are removed during that turn, nobody will get them.<br/><br/>
        You're playing Light, gain some time and capture the last piece to win directly!`,new Ur([[x,x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,ee,ee,i1,x,x,x,x,x,x,x,x,x],[x,x,x,ee,ee,ee,ee,ee,ee,x,x,x,x,x,x],[x,x,x,ee,ee,ee,gn,ee,gn,x,x,x,x,x,x],[x,x,x,ee,ee,gn,ee,ee,ee,x,x,x,x,x,x],[x,x,x,x,x,x,gn,ee,gn,x,x,x,x,x,x]],1,[0,2],[0,0]),[l4.of(new C(5,5))],$localize`Congratulations!`,$localize`It's nice to move a piece, but you could have had the opponent's piece immediately by clicking on it!`),q.fromMove($localize`Special capture`,$localize`When a tile is removed from the board during your turn, some of the opponent's pieces may have lost their last free neighboring space, they will therefore be captured!
        If this happens to one of your piece during your turn, it will however stay on the board.<br/><br/>
        A move that demonstrates both of these things can be done on this board by Light. Try it!`,new Ur([[x,x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,ee,ee,i1,x,x,x,x,x,x],[x,x,x,ee,ee,i1,ee,ee,ee,x,x,x,x,x,x],[x,x,x,ee,i1,gn,ee,gn,ee,x,x,x,x,x,x],[x,x,x,ee,gn,i1,ee,ee,ee,x,x,x,x,x,x],[x,x,x,ee,ee,gn,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x,x]],1,[0,0],[0,0]),[F2.of(new C(7,6),new C(6,5)),F2.of(new C(7,6),new C(8,5))],$localize`Congratulations! See, your piece no longer had any empty neighboring space after you have gained the tile, but it stayed on the board as it was your turn.
        However, the opponent's piece has disappeared because the tile's capture has removed its last empty neighboring space.`,$localize`Failed. Try again.`)])}}class qft extends fr{getMetrics(e){const t=e.gameState,n=t.getPiecesByFreedom(),i=this.getPiecesScore(n);return[2*t.captures[0]+i[0],2*t.captures[1]+i[1]]}getPiecesScore(e){return[this.getPlayerPiecesScore(e[0]),this.getPlayerPiecesScore(e[1])]}getPlayerPiecesScore(e){return 3*e[0]+1*e[1]+3*e[2]+3*e[3]}}class xL extends Un{getListMoves(e){let t=this.getListExchanges(e);return t=t.concat(this.getListMovement(e)),t}getListExchanges(e){const t=[],n=e.gameState,i=n.getCurrentPlayer().value,s=Ce.ofPlayer(n.getCurrentOpponent());if(n.tiles[i]<2)return t;for(const o of n.getCoordsAndContents())if(o.content===s){const a=l4.of(o.coord);t.push(a)}return t}getListMovement(e){const t=[],n=e.gameState,i=n.getCurrentPlayer();for(const s of n.getCoordsAndContents()){const o=s.coord;if(s.content.is(i)){const a=n.getLegalLandings(o);for(const c of a){const l=F2.of(o,c);t.push(l)}}}return t}}let jft=(()=>{class r extends fr{getMetrics(t){const n=t.gameState,i=this.getPiecesMap(n),s=this.getThreatMap(n,i),o=this.filterThreatMap(s,n),a=[0,0];for(const c of k.PLAYERS){for(const l of i.get(c).get())o.get(l).isPresent()?a[c.value]+=r.SCORE_BY_THREATENED_PIECE:a[c.value]+=r.SCORE_BY_SAFE_PIECE;a[c.value]+=n.tiles[c.value]}return a}getPiecesMap(t){const n=new En,i=[],s=[];for(const o of t.getCoordsAndContents()){const a=o.coord,c=t.getPieceAt(a);c===Ce.ZERO?i.push(a):c===Ce.ONE&&s.push(a)}return n.set(k.ZERO,new q1(i)),n.set(k.ONE,new q1(s)),n}getThreatMap(t,n){const i=new En;for(const s of k.PLAYERS)for(const o of n.get(s).get()){const a=this.getThreat(o,t);a.isPresent()&&i.set(o,a.get())}return i}getThreat(t,n){const s=k.of(n.getPieceAt(t).value).getOpponent();let o=g.empty(),a=g.empty(),c=[];const l=Bo.getNeighbors(t).filter(Ur.isOnBoard);for(const f of l){const d=n.getPieceAt(f);if(d.is(s))c.push(f),this.tileCouldBeRemovedThisTurn(f,n,s)&&(a=g.of(f));else if(d===Ce.EMPTY){if(o.isPresent())return g.empty();o=g.of(f)}}if(o.isPresent()){const f=[];for(const d of ms.STEPS){const m=o.get().getNext(d.direction,1);Ur.isOnBoard(m)&&n.getPieceAt(m).is(s)&&!1===c.some(E=>E.equals(m))&&f.push(m)}if(f.length>0)return g.of(new iC(new q1(c),new q1(f)))}if(a.isPresent()){c=c.filter(d=>d.equals(a.get()));const f=new q1(c);return g.of(new iC(f,new q1([a.get()])))}return g.empty()}tileCouldBeRemovedThisTurn(t,n,i){const s=i.getOpponent();if(!1===n.isDeconnectable(t))return!1;let a=g.empty();const c=Ur.getTilesUpperLeftCoord(t);for(let l=0;l<2;l++)for(let f=0;f<3;f++){const d=c.getNext(new St(f,l),1);if(n.getPieceAt(d).is(i)){if(!this.pieceCouldLeaveTheTile(d,n))return!1;a=g.of(d)}else if(n.getPieceAt(d).is(s))return!1}return a.isPresent()}pieceCouldLeaveTheTile(t,n){const i=Ur.getTilesUpperLeftCoord(t);for(const s of ms.STEPS){const o=t.getNext(s.direction,1),a=Ur.getTilesUpperLeftCoord(o);if(!1===i.equals(a)&&Ur.isOnBoard(o)&&n.getPieceAt(o)===Ce.EMPTY)return!0}return!1}filterThreatMap(t,n){const i=new En,s=t.listKeys(),o=s.filter(c=>n.getPieceAt(c).is(n.getCurrentPlayer())),a=new q1(s.filter(c=>n.getPieceAt(c).is(n.getCurrentOpponent())));for(const c of o){const l=t.get(c).get();let f=g.empty();for(const d of l.directThreats)if(!1===a.contains(d)){const m=[];for(const E of l.mover)!1===a.contains(E)&&m.push(E);m.length>0&&(f=g.of(new iC(l.directThreats,new q1(m))))}f.isPresent()&&i.set(c,f.get())}for(const c of a){const l=t.get(c).get();i.set(c,l)}return i}}return u(r,"SCORE_BY_THREATENED_PIECE",1e3),u(r,"SCORE_BY_SAFE_PIECE",1e6),r})();class Zft extends xL{getListMoves(e){const t=super.getListMoves(e);return this.putCaptureFirst(e,t)}putCaptureFirst(e,t){return Ie.sortByDescending(t,n=>this.moveCapturesList(e,n).length),t}moveCapturesList(e,t){return bl.isTileExchange(t)?[t.coord]:e.gameState.applyLegalMovement(t).removeTilesIfNeeded(t.getStart(),!0).getCapturedNeighbors(t.getEnd())}}function Yft(r,e){if(1&r&&(N(),F(0,"polygon",7)),2&r){const t=p().index,n=p().index,i=p();ye("id","space_",t,"_",n,""),y("ngClass",i.getSpaceClass(t,n)),I("points",i.getTrianglePoints(t,n))("transform",i.getTriangleInHexTranslate(t,n))}}function Kft(r,e){if(1&r){const t=pe();N(),S(0,"g",5),W("click",function(){const s=te(t).index,o=p().index;return ne(p().onClick(s,o))}),T(1,Yft,1,5,"polygon",6),P()}if(2&r){const t=e.index,n=p().index,i=p();ye("id","click_",t,"_",n,""),_(1),y("ngIf",i.mustDraw(t,n))}}function Xft(r,e){if(1&r&&(N(),S(0,"g"),T(1,Kft,2,3,"g",4),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function Qft(r,e){if(1&r&&(N(),F(0,"polygon",9)),2&r){const t=p().index,n=p().index,i=p();ye("id","pyramid_",t,"_",n,""),y("ngClass",i.getPyramidClass(t,n)),I("points",i.getPyramidPoints(t,n))("transform",i.getTriangleInHexTranslate(t,n))}}function Jft(r,e){if(1&r){const t=pe();N(),S(0,"g",5),W("click",function(){const s=te(t).index,o=p().index;return ne(p().onClick(s,o))}),T(1,Qft,1,5,"polygon",8),P()}if(2&r){const t=e.index,n=p().index,i=p();ye("id","click_",t,"_",n,""),_(1),y("ngIf",i.isPyramid(t,n))}}function e9t(r,e){if(1&r&&(N(),S(0,"g"),T(1,Jft,2,3,"g",4),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function t9t(r,e){if(1&r){const t=pe();N(),S(0,"rect",12),W("click",function(){const s=te(t).$implicit;return ne(p(2).onClick(s.x,s.y))}),P()}if(2&r){const t=e.$implicit,n=p(2);I("x",-n.INDICATOR_SIZE/2)("y",n.getIndicatorY(t))("width",n.INDICATOR_SIZE)("height",n.INDICATOR_SIZE)("transform",n.getTriangleInHexTranslate(t.x,t.y))}}function n9t(r,e){if(1&r&&(N(),S(0,"g"),F(1,"polygon",10),T(2,t9t,1,5,"rect",11),P()),2&r){const t=p();_(1),ye("id","selected_",t.chosenCoord.get().x,"_",t.chosenCoord.get().y,""),I("points",t.getTrianglePoints(t.chosenCoord.get().x,t.chosenCoord.get().y))("transform",t.getTriangleInHexTranslate(t.chosenCoord.get().x,t.chosenCoord.get().y)),_(1),y("ngForOf",t.possibleLandings)}}function r9t(r,e){if(1&r&&(N(),F(0,"polygon",14)),2&r){const t=p(2);ye("id","last_start_",t.lastStart.get().x,"_",t.lastStart.get().y,""),I("points",t.getTrianglePoints(t.lastStart.get().x,t.lastStart.get().y))("transform",t.getTriangleInHexTranslate(t.lastStart.get().x,t.lastStart.get().y))}}function i9t(r,e){if(1&r&&(N(),F(0,"polygon",14)),2&r){const t=p(2);ye("id","last_end_",t.lastEnd.get().x,"_",t.lastEnd.get().y,""),I("points",t.getTrianglePoints(t.lastEnd.get().x,t.lastEnd.get().y))("transform",t.getTriangleInHexTranslate(t.lastEnd.get().x,t.lastEnd.get().y))}}function s9t(r,e){if(1&r&&(N(),T(0,r9t,1,4,"polygon",13),T(1,i9t,1,4,"polygon",13)),2&r){const t=p();y("ngIf",t.lastStart.isPresent()),_(1),y("ngIf",t.lastEnd.isPresent())}}const o9t=function(r){return["base",r]};function a9t(r,e){if(1&r&&(N(),S(0,"g",16),F(1,"polygon",17),S(2,"text",18),lt(3),P()()),2&r){const t=p().$implicit,n=p();y("id","tilesCount"+t.value),I("transform",n.getTilesCountTranslate(t)),_(1),y("ngClass",_a(7,o9t,"player"+t+"-fill")),I("points",n.getTilesCountCoordinate())("stroke",n.lastTurnWasTilesExchange(t)?"yellow":"black"),_(1),I("font-size",n.SPACE_SIZE/2),_(1),An(n.tiles[t.value])}}function c9t(r,e){if(1&r&&(N(),S(0,"g"),T(1,a9t,4,9,"g",15),P()),2&r){const t=e.$implicit,n=p();_(1),y("ngIf",n.mustShowTilesOf(t))}}let l9t=(()=>{var r;class e extends ece{constructor(n){super(n),u(this,"state",void 0),u(this,"tiles",[0,0]),u(this,"NONE",Ce.UNREACHABLE),u(this,"INDICATOR_SIZE",15),u(this,"chosenCoord",g.empty()),u(this,"lastStart",g.empty()),u(this,"lastEnd",g.empty()),u(this,"possibleLandings",[]),u(this,"left",-2*this.STROKE_WIDTH),u(this,"up",-this.SPACE_SIZE/2-2*this.STROKE_WIDTH),u(this,"width",8*this.SPACE_SIZE),u(this,"height",10*(this.SPACE_SIZE+this.STROKE_WIDTH)),this.scores=g.of([0,0]),this.rules=lC.get(),this.node=this.rules.getInitialNode(),this.availableAIs=[new on($localize`Pieces > Threats > Tiles`,this.rules,new jft,new Zft),new on($localize`Captures > Freedom`,this.rules,new qft,new xL),new Kn($localize`MCTS`,new xL,this.rules)],this.encoder=bl.encoder,this.tutorial=(new rce).tutorial,this.SPACE_SIZE=70}updateBoard(n){var i=this;return M(function*(){i.chosenCoord=g.empty(),i.state=i.getState(),i.scores=g.of(i.state.captures),i.tiles=i.state.tiles,i.board=i.getState().board})()}showHighlight(){this.possibleLandings=this.state.getLegalLandings(this.chosenCoord.get())}cancelMoveAttempt(){this.chosenCoord=g.empty(),this.possibleLandings=[]}showLastMove(n){var i=this;return M(function*(){n instanceof F2?(i.lastStart=g.of(n.getStart()),i.lastEnd=g.of(n.getEnd())):(i.lastStart=g.empty(),i.lastEnd=g.empty())})()}onClick(n,i){var s=this;return M(function*(){const o=yield s.canUserPlay("#click_"+n+"_"+i);if(o.isFailure())return s.cancelMove(o.getReason());const a=new C(n,i),c=s.state.getCurrentPlayer();return s.chosenCoord.equalsValue(a)?(s.cancelMoveAttempt(),b.SUCCESS):s.chosenCoord.isAbsent()||s.state.getPieceAt(a).is(c)?s.firstClick(a):s.secondClick(a)})()}firstClick(n){var i=this;return M(function*(){const s=i.state.getPieceAt(n);if(s.is(i.state.getCurrentOpponent())){const o=l4.of(n);return i.chooseMove(o)}return s.is(i.state.getCurrentPlayer())?(i.chosenCoord=g.of(n),i.showHighlight(),b.SUCCESS):i.cancelMove(kd.FIRST_CLICK_SHOULD_NOT_BE_NULL())})()}secondClick(n){var i=this;return M(function*(){if(i.possibleLandings.some(s=>s.equals(n))){const s=F2.of(i.chosenCoord.get(),n);return i.chooseMove(s)}return i.cancelMove(kd.INVALID_DISTANCE())})()}isPyramid(n,i){return this.board[i][n].isPlayer()||this.wasOpponent(n,i)}wasOpponent(n,i){const s=this.node.parent;if(s.isPresent()){const o=s.get().gameState.getCurrentOpponent();return s.get().gameState.getPieceAtXY(n,i).is(o)}return!1}getPyramidClass(n,i){const s=this.board[i][n];return s===Ce.ZERO?this.getPlayerClass(k.ZERO):s===Ce.ONE?this.getPlayerClass(k.ONE):"captured-fill"}mustDraw(n,i){return this.board[i][n]!==Ce.UNREACHABLE||this.wasRemoved(n,i)}wasRemoved(n,i){const o=this.node.parent;if(this.board[i][n]===Ce.UNREACHABLE&&o.isPresent()){const a=o.get().gameState.getPieceAtXY(n,i);return a===Ce.EMPTY||a.is(o.get().gameState.getCurrentPlayer())}return!1}getSpaceClass(n,i){return this.wasRemoved(n,i)?"captured-alternate-fill":(n+i)%2==1?"background":"background2"}getTilesCountCoordinate(){return"-15, -40, 35, -40, 60, 10, 35, 60, -15, 60, -40, 10, -15, -40"}mustShowTilesOf(n){return this.tiles[n.value]>0||this.lastTurnWasTilesExchange(n)}lastTurnWasTilesExchange(n){return!this.node.parent.isAbsent()&&this.getPreviousState().tiles[n.value]>this.tiles[n.value]}getIndicatorY(n){const i=this.INDICATOR_SIZE/2;return(n.x+n.y)%2==0?i:i-30}getTriangleInHexTranslate(n,i){const s=this.getTriangleTranslateCoord(n,i),o=s.x+2*Math.floor(n/3)*this.STROKE_WIDTH;let a=s.y;return Math.floor(n/3)%2==0?a+=2*Math.floor(i/2)*this.STROKE_WIDTH:(a+=2*Math.abs(Math.floor((i-1)/2))*this.STROKE_WIDTH,a+=this.STROKE_WIDTH),"translate("+o+", "+a+")"}getTilesCountTranslate(n){let i,s;return n===k.ZERO?(i=-.05,s=-.1):(i=7.5,s=9.45),i*=this.SPACE_SIZE,s*=this.SPACE_SIZE,"translate("+i+", "+s+")"}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(Ut))}),u(e,"\u0275cmp",qe({type:r,selectors:[["app-coerceo"]],features:[Qe],decls:7,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf","ngIfElse"],["lastMove",""],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["class","base mid-stroke","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["stroke-linecap","round",1,"base","mid-stroke",3,"id","ngClass"],["class","base small-stroke","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["stroke-linecap","round",1,"base","small-stroke",3,"id","ngClass"],[1,"base","no-fill","mid-stroke","selected-stroke",3,"id"],["class","base-no-fill indicator clickable-fill",3,"click",4,"ngFor","ngForOf"],[1,"base-no-fill","indicator","clickable-fill",3,"click"],["class","base no-fill mid-stroke last-move-stroke",3,"id",4,"ngIf"],[1,"base","no-fill","mid-stroke","last-move-stroke",3,"id"],[3,"id",4,"ngIf"],[3,"id"],["stroke-linecap","round",3,"ngClass"],["id","playerZeroTilesCount","x","-5","y","5",1,"text-giant"]],template:function(n,i){if(1&n&&(N(),S(0,"svg",0),T(1,Xft,2,1,"g",1),T(2,e9t,2,1,"g",1),T(3,n9t,3,5,"g",2),T(4,s9t,2,2,"ng-template",null,3,un),T(6,c9t,2,1,"g",1),P()),2&n){const s=cn(5);I("viewBox",i.left+" "+i.up+" "+i.width+" "+i.height),_(1),y("ngForOf",i.board),_(1),y("ngForOf",i.board),_(1),y("ngIf",i.chosenCoord.isPresent())("ngIfElse",s),_(3),y("ngForOf",i.Player.PLAYERS)}},dependencies:[Ft,Wt,At],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();class ice extends Un{getListMoves(e){return e.gameState.turn<40?this.getListMovesDrop(e.gameState):this.getListMovesAfterDrop(e.gameState)}getListMovesDrop(e){const t=[],n=Lt.CENTRAL_ZONE_TOP_LEFT,i=Lt.CENTRAL_ZONE_BOTTOM_RIGHT;for(let s=n.y;s<=i.y;s++)for(let o=n.x;o<=i.x;o++)e.getPieceAtXY(o,s)===K.NONE&&t.push(o4.of(new C(o,s)));return t}getListMovesAfterDrop(e){let t=[];const n=e.getCurrentPlayer();for(let i=0;i<Lt.HEIGHT;i++)for(let s=0;s<Lt.WIDTH;s++){const o=new C(s,i);e.getPieceAt(o)===n&&(t=t.concat(this.getListSimpleMoves(e,o)),t=t.concat(this.getListJumps(e,o)))}return t}getListSimpleMoves(e,t){const n=[],i=[new C(t.x+1,t.y),new C(t.x-1,t.y),new C(t.x,t.y+1),new C(t.x,t.y-1),new C(t.x+1,t.y+1),new C(t.x+1,t.y-1),new C(t.x-1,t.y+1),new C(t.x-1,t.y-1)].filter(s=>Lt.isOnBoard(s));for(const s of i){const o=a4.from(t,s);o.isSuccess()&&$s.get().simpleMoveLegality(o.get(),e).isSuccess()&&n.push(o.get())}return n}getListJumps(e,t){const n=new dt;for(const i of $s.get().jumpTargetsFrom(t)){const s=Go.from([t,i]).get();$s.get().jumpLegality(s,e).isSuccess()&&(n.add(s),n.addAll(this.getListJumpStartingFrom(e,s)))}return n.toList()}getListJumpStartingFrom(e,t){const n=$s.get().nextJumps(t,e),i=new dt(n);for(const s of n)i.addAll(this.getListJumpStartingFrom(e,s));return i}}class u9t extends fr{getMetrics(e){const t=e.gameState,n=[0,0];for(let i=0;i<Lt.HEIGHT;i++)for(let s=0;s<Lt.WIDTH;s++){const o=new C(s,i),a=t.getPieceAt(o);if(a.isPlayer())if(t.isShelter(o))n[a.value]+=20;else{let c=100;for(const l of Lt.ALL_SHELTERS)if(t.getPieceAt(l)===K.NONE){const f=o.getOrthogonalDistance(l);c=Math.min(c,f)}n[a.value]-=c}}return n}}class f9t extends ice{getListMoves(e){return this.sortByNumberOfJumps(super.getListMoves(e))}sortByNumberOfJumps(e){return e.sort((t,n)=>{const i=g2.isDrop(t)?1:g2.isSimple(t)?2:t.coords.length;return(g2.isDrop(n)?1:g2.isSimple(n)?2:n.coords.length)-i})}}class d9t extends on{constructor(){super($localize`Jump`,$s.get(),new u9t,new f9t)}}function h9t(r,e){if(1&r){const t=pe();N(),S(0,"rect",9),W("click",function(){te(t);const i=p().$implicit;return ne(p(2).onClick(i.coord))}),P()}if(2&r){const t=p().$implicit,n=p(2);I("x",1.5*n.STROKE_WIDTH+n.SPACE_SIZE*t.coord.x+n.STROKE_WIDTH)("y",1.5*n.STROKE_WIDTH+n.SPACE_SIZE*t.coord.y+n.STROKE_WIDTH)("width",n.SPACE_SIZE-3*n.STROKE_WIDTH)("height",n.SPACE_SIZE-3*n.STROKE_WIDTH)}}function p9t(r,e){if(1&r){const t=pe();N(),S(0,"circle",6),W("click",function(){te(t);const i=p().$implicit;return ne(p(2).onClick(i.coord))}),P()}if(2&r){const t=p(),n=t.index,i=t.$implicit,s=p().index,o=p();ye("id","piece_",n,"_",s,""),y("ngClass",i.pieceClasses),I("r",o.PIECE_RADIUS)("cx",o.SPACE_SIZE*n+o.STROKE_WIDTH+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*s+o.STROKE_WIDTH+o.SPACE_SIZE/2)}}function g9t(r,e){if(1&r){const t=pe();N(),S(0,"g")(1,"rect",6),W("click",function(){const s=te(t).$implicit;return ne(p(2).onClick(s.coord))}),P(),T(2,h9t,1,4,"rect",7),T(3,p9t,1,6,"circle",8),P()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,s=p();_(1),ye("id","click_",n,"_",i,""),y("ngClass",t.squareClasses),I("x",s.SPACE_SIZE*n+s.STROKE_WIDTH)("y",s.SPACE_SIZE*i+s.STROKE_WIDTH)("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),_(1),y("ngIf",t.isShelter),_(1),y("ngIf",t.hasPiece)}}function m9t(r,e){if(1&r&&(N(),S(0,"g"),T(1,g9t,4,9,"g",1),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function _9t(r,e){if(1&r){const t=pe();N(),S(0,"g")(1,"rect",10),W("click",function(){const s=te(t).$implicit;return ne(p().onClick(s))}),P()()}if(2&r){const t=e.$implicit,n=p();_(1),y("ngClass",n.viewInfo.boardInfo[t.y][t.x].shelterClasses),I("x",n.SPACE_SIZE*t.x+n.STROKE_WIDTH)("y",n.SPACE_SIZE*t.y+n.STROKE_WIDTH)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}function v9t(r,e){if(1&r&&(N(),F(0,"circle",11)),2&r){const t=e.$implicit,n=p();zn("id","sidePiece_0_",t,""),I("cx",-n.PIECE_RADIUS)("cy",1670-t*n.PIECE_RADIUS)("r",n.PIECE_RADIUS-5)}}function C9t(r,e){if(1&r&&(N(),F(0,"circle",12)),2&r){const t=e.$implicit,n=p();zn("id","sidePiece_1_",t,""),I("cx",1715+n.PIECE_RADIUS)("cy",1670-t*n.PIECE_RADIUS)("r",n.PIECE_RADIUS-5)}}function y9t(r,e){if(1&r&&(N(),F(0,"rect",13)),2&r){const t=p();I("x",t.SPACE_SIZE*t.CENTRAL_ZONE_START.x+t.STROKE_WIDTH)("y",t.SPACE_SIZE*t.CENTRAL_ZONE_START.y+t.STROKE_WIDTH)("width",t.CENTRAL_ZONE_SIZE.x*t.SPACE_SIZE)("height",t.CENTRAL_ZONE_SIZE.y*t.SPACE_SIZE)}}let M9t=(()=>{var r;class e extends El{constructor(n){super(n),u(this,"PIECE_RADIUS",void 0),u(this,"ALL_SHELTERS",Lt.ALL_SHELTERS),u(this,"CENTRAL_ZONE_START",Lt.CENTRAL_ZONE_TOP_LEFT),u(this,"CENTRAL_ZONE_SIZE",new St(Lt.CENTRAL_ZONE_BOTTOM_RIGHT.x-Lt.CENTRAL_ZONE_TOP_LEFT.x+1,Lt.CENTRAL_ZONE_BOTTOM_RIGHT.y-Lt.CENTRAL_ZONE_TOP_LEFT.y+1)),u(this,"viewInfo",{dropPhase:!0,boardInfo:[],victory:[],lastMoveArrow:"",sidePieces:[20,20]}),u(this,"selected",g.empty()),u(this,"jumpInConstruction",g.empty()),this.PIECE_RADIUS=this.SPACE_SIZE/2-this.STROKE_WIDTH,this.rules=$s.get(),this.node=this.rules.getInitialNode(),this.availableAIs=[new d9t,new Kn($localize`MCTS`,new ice,this.rules)],this.encoder=g2.encoder,this.tutorial=(new Zae).tutorial}updateBoard(n){var i=this;return M(function*(){i.updateViewInfo()})()}updateViewInfo(){const n=this.getState();this.viewInfo.dropPhase=n.isDropPhase(),this.viewInfo.boardInfo=[],this.viewInfo.lastMoveArrow="";for(let i=0;i<Lt.HEIGHT;i++){this.viewInfo.boardInfo.push([]);for(let s=0;s<Lt.WIDTH;s++){const o=new C(s,i),a=n.getPieceAt(o),c={coord:o,squareClasses:[],shelterClasses:[],pieceClasses:[this.getPlayerClass(a)],hasPiece:a.isPlayer(),isShelter:!1,isOccupiedShelter:!1};this.viewInfo.boardInfo[i].push(c)}}this.viewInfo.sidePieces=n.getSidePieces(),this.updateOccupiedShelters(),this.updateSelected(),this.updateVictory()}updateOccupiedShelters(){for(const n of Lt.ALL_SHELTERS){const i=this.viewInfo.boardInfo[n.y][n.x];i.isShelter=!0,i.hasPiece&&i.shelterClasses.push("selectable-stroke")}}updateSelected(){if(this.selected.isPresent())if(this.jumpInConstruction.isPresent()){const n=this.jumpInConstruction.get(),i=n.getStartingCoord(),s=n.getEndingCoord();this.viewInfo.boardInfo[i.y][i.x].hasPiece=!1,this.viewInfo.boardInfo[s.y][s.x].pieceClasses=[this.getPlayerClass(this.getCurrentPlayer()),"selected-stroke"],this.viewInfo.boardInfo[s.y][s.x].hasPiece=!0;for(const o of n.coords)this.viewInfo.boardInfo[o.y][o.x].squareClasses.push("moved-fill")}else{const n=this.selected.get();this.viewInfo.boardInfo[n.y][n.x].pieceClasses.push("selected-stroke")}}updateVictory(){const n=this.getState(),i=$s.get().getGameStatus(this.node);if(!0===i.isEndGame)for(const s of Lt.ALL_SHELTERS)n.getPieceAt(s)===i.winner&&this.viewInfo.boardInfo[s.y][s.x].squareClasses.push("victory-fill")}showLastMove(n){var i=this;return M(function*(){if(g2.isDrop(n))i.viewInfo.boardInfo[n.coord.y][n.coord.x].squareClasses.push("moved-fill");else if(g2.isSimple(n))i.viewInfo.boardInfo[n.getStart().y][n.getStart().x].squareClasses.push("moved-fill"),i.viewInfo.boardInfo[n.getEnd().y][n.getEnd().x].squareClasses.push("moved-fill");else{i.viewInfo.lastMoveArrow="";for(const s of n.coords)i.viewInfo.boardInfo[s.y][s.x].squareClasses.push("moved-fill"),i.viewInfo.lastMoveArrow+=s.x*i.SPACE_SIZE+i.SPACE_SIZE/2+i.STROKE_WIDTH,i.viewInfo.lastMoveArrow+=" ",i.viewInfo.lastMoveArrow+=s.y*i.SPACE_SIZE+i.SPACE_SIZE/2+i.STROKE_WIDTH,i.viewInfo.lastMoveArrow+=" "}})()}cancelMoveAttempt(){var n=this;return M(function*(){n.jumpInConstruction=g.empty(),n.selected=g.empty(),yield n.updateBoard(!1)})()}onClick(n){var i=this;return M(function*(){const s=yield i.canUserPlay("#click_"+n.x+"_"+n.y);if(s.isFailure())return i.cancelMove(s.getReason());const o=i.getState();if(o.getPieceAt(n)===i.getCurrentPlayer())return i.selected.equalsValue(n)?yield i.cancelMoveAttempt():(i.selected=g.of(n),i.jumpInConstruction=g.empty()),i.updateViewInfo(),b.SUCCESS;if(i.jumpInConstruction.isPresent())return i.constructJump(n);if(i.selected.isPresent())return i.selectNextCoord(n);if(o.isDropPhase()){const a=o4.of(n);return i.chooseMove(a)}return i.cancelMove(Re.MUST_CHOOSE_PLAYER_PIECE())})()}constructJump(n){var i=this;return M(function*(){const s=i.jumpInConstruction.get(),o=i.getState();if(n.equals(s.getEndingCoord()))return i.chooseMove(s);{const a=s.addJump(n);if(a.isFailure())return i.cancelMove(a.getReason());const c=i.rules.jumpLegality(a.get(),o);return c.isFailure()?i.cancelMove(c.getReason()):i.updateJump(a.get())}})()}updateJump(n){var i=this;return M(function*(){const s=i.getState();return i.rules.jumpHasPossibleNextTargets(n,s)?(i.jumpInConstruction=g.of(n),i.updateViewInfo(),b.SUCCESS):i.chooseMove(n)})()}selectNextCoord(n){var i=this;return M(function*(){const s=i.selected.get(),o=a4.from(s,n);if(o.isSuccess())return i.chooseMove(o.get());{const a=Go.from([s,n]);return a.isFailure()?i.cancelMove(a.getReason()):i.updateJump(a.get())}})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(Ut))}),u(e,"\u0275cmp",qe({type:r,selectors:[["app-conspirateurs"]],features:[Qe],decls:7,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-100 0 1915 1715","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base mid-stroke player0-fill",3,"id",4,"ngFor","ngForOf"],["class","base mid-stroke player1-fill",3,"id",4,"ngFor","ngForOf"],["class","base no-fill selectable-stroke mid-stroke",4,"ngIf"],["id","lastJump",1,"base","no-fill"],[1,"base",3,"id","ngClass","click"],["class","base no-fill mid-stroke",3,"click",4,"ngIf"],["class","base",3,"id","ngClass","click",4,"ngIf"],[1,"base","no-fill","mid-stroke",3,"click"],[1,"base","no-fill","mid-stroke",3,"ngClass","click"],[1,"base","mid-stroke","player0-fill",3,"id"],[1,"base","mid-stroke","player1-fill",3,"id"],[1,"base","no-fill","selectable-stroke","mid-stroke"]],template:function(n,i){1&n&&(N(),S(0,"svg",0),T(1,m9t,2,1,"g",1),T(2,_9t,2,5,"g",1),T(3,v9t,1,4,"circle",2),T(4,C9t,1,4,"circle",3),T(5,y9t,1,4,"rect",4),F(6,"polyline",5),P()),2&n&&(_(1),y("ngForOf",i.viewInfo.boardInfo),_(1),y("ngForOf",i.ALL_SHELTERS),_(1),y("ngForOf",i.ArrayUtils.range(i.viewInfo.sidePieces[0])),_(1),y("ngForOf",i.ArrayUtils.range(i.viewInfo.sidePieces[1])),_(1),y("ngIf",i.viewInfo.dropPhase),_(1),I("points",i.viewInfo.lastMoveArrow))},dependencies:[Ft,Wt,At],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();class sce extends Un{getListMoves(e){const t=e.gameState,n=this.getListDrops(t),i=this.getListShifts(t);return n.concat(i)}getListShifts(e){const t=[],n=this.getShiftSources(e);for(const i of n)for(const s of[new V2(i,"clockwise"),new V2(i,"counterclockwise")])Dc.get().shiftHeightValidity(s,e).isSuccess()&&t.push(s);return t}getListDrops(e){const t=this.getRemainingPiecesForCurrentPlayer(e),n=[];for(let i=0;i<er.WIDTH;i++)for(const s of t){const o=new c4(i,s);Dc.get().dropHeightValidity(o,e).isSuccess()&&n.push(o)}return n}getRemainingPiecesForCurrentPlayer(e){const t=[];for(const n of Pn.PLAYER_PIECES)this.currentPlayerCanDropPiece(e,n)&&t.push(n);return t}currentPlayerCanDropPiece(e,t){return e.getCurrentPlayer()===t.owner&&e.getRemainingPiecesOf(t)>0}getShiftSources(e){const t=[],n=e.getCurrentPlayer();for(let i=0;i<er.HEIGHT;i++)for(let s=0;s<er.WIDTH;s++)e.getPieceAtXY(s,i).owner===n&&t.push(new C(s,i));return t}}var LL;function E9t(r,e){if(1&r){const t=pe();N(),S(0,"g",6)(1,"path",7),W("click",function(){const s=te(t).$implicit;return ne(p().onSpaceClick(s))}),P(),S(2,"path",8),W("click",function(){const s=te(t).$implicit;return ne(p().onSpaceClick(s))}),P()()}if(2&r){const t=e.$implicit,n=p();zn("id","board_space_",t,""),_(1),zn("id","click_",t,""),y("ngClass",n.viewInfo.boardInfo[t].spaceClasses),I("d",n.BOARD_PATHS[t]),_(1),y("ngClass",n.viewInfo.boardInfo[t].spaceClasses),I("d",n.DECORATION_PATHS[t])}}function S9t(r,e){if(1&r){const t=pe();N(),S(0,"g",10),W("click",function(){const s=te(t).$implicit,o=p().$implicit;return ne(p().onPieceInGameClick(o,s.y))}),F(1,"use",11)(2,"use",12),P()}if(2&r){const t=e.$implicit;ye("id","click_",p().$implicit,"_",t.y,""),y("ngClass",t.foregroundClasses),_(1),y("ngClass",t.backgroundClasses),I("x",t.drawPosition.x)("y",t.drawPosition.y),_(1),I("x",t.drawPosition.x)("y",t.drawPosition.y)}}function P9t(r,e){if(1&r&&(N(),S(0,"g"),T(1,S9t,3,8,"g",9),P()),2&r){const t=e.$implicit,n=p();_(1),y("ngForOf",n.viewInfo.boardInfo[t].pieces)}}function T9t(r,e){if(1&r){const t=pe();N(),S(0,"g",14),W("click",function(){const i=te(t),s=i.$implicit,o=i.index;return ne(p(2).onRemainingPieceClick(s.actualPiece,o))}),F(1,"use",11)(2,"use",12),P()}if(2&r){const t=e.$implicit,n=e.index;wi("id","piece_",t.actualPiece.owner.toString(),"_",t.actualPiece.otherPieceType?1:0,"_",n,""),y("ngClass",t.foregroundClasses),_(1),y("ngClass",t.backgroundClasses),I("x",t.drawPosition.x)("y",t.drawPosition.y),_(1),I("x",t.drawPosition.x)("y",t.drawPosition.y)}}function O9t(r,e){if(1&r&&(N(),S(0,"g"),T(1,T9t,3,9,"g",13),P()),2&r){const t=e.$implicit,n=p();_(1),y("ngForOf",n.viewInfo.remainingPieces.get(t).get())}}const b9t=function(){return[0,1,2,3,4,5,6,7]},w9t=function(){return[2,1,3,0,4,7,5,6]};class Hc extends El{constructor(e){super(e),u(this,"BOARD_PATHS",["M 2.8324855,277.57643 164.46619,228.81694 170.57257,148.42756 32.571357,104.19835 Z","M 170.57257,148.42237 246.4213,96.276913 195.13813,2.0233391 32.571357,104.19315 Z","m 195.14159,2.0268021 205.0898,0.010821 -52.1686,94.2453509 -101.64149,-0.0057 z","M 348.06279,96.281239 400.23529,2.0330788 564.39307,104.19207 424.66384,148.41891 Z","m 424.66384,148.42237 7.27882,80.37683 164.9712,48.72701 -32.52079,-173.33068 z","m 431.94266,228.80481 -75.73854,62.15055 79.06197,135.86929 161.64688,-149.29953 z","m 356.20412,290.9506 79.06197,135.86929 -268.2864,0.0433 74.14082,-135.90175 z","M 241.12051,290.96379 166.97969,426.86556 2.8324855,277.57708 164.46619,228.81759 Z"]),u(this,"DECORATION_PATHS",["m 170.57257,148.42302 v 40.08918 l -6.11049,80.38634 v -40.09025 z","m 170.57646,188.51696 v -40.08918 l 75.8509,-52.140047 v 40.086147 z","m 246.42323,96.285785 v 40.086155 l 101.63847,-0.003 0.001,-40.082256 z","m 424.66037,148.42345 v 40.08377 l -76.60213,-52.14178 10e-4,-40.082033 z","m 424.66037,148.42193 v 40.08377 l 7.27884,80.37445 v -40.08377 z","m 435.26609,466.90582 v -40.08615 l 161.64688,-149.2995 8.9e-4,40.08701 z","m 166.97969,426.86815 v 40.08638 l 268.28379,-0.0433 v -40.08031 z","m 2.8324855,277.57297 v 40.08636 L 166.97969,466.94782 v -40.08636 z"]),u(this,"selected",g.empty()),u(this,"viewInfo",{boardInfo:[],remainingPieces:new En([{key:k.ZERO,value:[]},{key:k.ONE,value:[]}])}),this.rules=Dc.get(),this.node=this.rules.getInitialNode(),this.availableAIs=[new on($localize`Dummy`,this.rules,new PL,new sce),new Kn($localize`MCTS`,new sce,this.rules)],this.encoder=Bft,this.tutorial=(new Jae).tutorial}onSpaceClick(e){var t=this;return M(function*(){const n=yield t.canUserPlay("#click_"+e);return n.isFailure()?t.cancelMove(n.getReason()):t.onSpaceClickAfterCheck(e)})()}onSpaceClickAfterCheck(e){var t=this;return M(function*(){if(t.selected.isPresent()){const n=t.selected.get();let i;if("pieceFromReserve"===n.type)i=new c4(e,n.piece);else if((n.position.x+1)%er.WIDTH===e)i=new V2(n.position,"clockwise");else{if((n.position.x+(er.WIDTH-1))%er.WIDTH!==e)return t.cancelMove(Id.MUST_SHIFT_TO_NEIGHBOR());i=new V2(n.position,"counterclockwise")}return t.chooseMove(i)}return t.cancelMove(Id.MUST_SELECT_PIECE_FIRST())})()}onPieceInGameClick(e,t){var n=this;return M(function*(){const i=yield n.canUserPlay("#click_"+e+"_"+t);if(i.isFailure())return n.cancelMove(i.getReason());const s=new C(e,t);return n.getState().getPieceAt(s).owner===n.getCurrentPlayer()?(n.isSelected(null,s)?yield n.cancelMoveAttempt():n.selected=g.of({type:"pieceFromBoard",position:s}),n.updateViewInfo(),b.SUCCESS):n.selected.isPresent()?n.onSpaceClickAfterCheck(e):n.cancelMove(Re.MUST_CHOOSE_PLAYER_PIECE())})()}onRemainingPieceClick(e,t){var n=this;return M(function*(){const i=yield n.canUserPlay(n.getPieceId(e,t));return i.isFailure()?n.cancelMove(i.getReason()):e.owner===n.getCurrentPlayer()?(n.selected=n.isSelected(e)?g.empty():g.of({type:"pieceFromReserve",piece:e}),n.updateViewInfo(),b.SUCCESS):n.cancelMove(Re.MUST_CHOOSE_PLAYER_PIECE())})()}getPieceId(e,t){return"#piece_"+e.owner.toString()+"_"+(e.otherPieceType?1:0)+"_"+t}isSelected(e,t){return!this.selected.isAbsent()&&(null==e&&"pieceFromBoard"===this.selected.get().type?this.selected.get().position.equals(t):this.selected.get().piece===e)}updateBoard(e){var t=this;return M(function*(){t.updateViewInfo()})()}getLastMovedFromDrop(e,t){const n=this.getDrawPositionRemainingPiece(e.piece,t.getRemainingPiecesOf(e.piece)-1),i=e.getTarget(),s=t.getStackHeight(e.getTarget()),o=this.getDrawPositionOnBoard(i,s),a=new C(i,s);return[{start:g.empty(),end:a,startDrawPosition:n,endDrawPosition:o}]}getLastMovedFromShift(e,t){const n=e.start.x,i=e.getTarget();let s=t.getStackHeight(i);const o=[];for(let a=e.start.y;a<er.HEIGHT&&t.getPieceAtXY(n,a)!==Pn.EMPTY;a++,s++)o.push({start:g.of(new C(n,a)),end:new C(i,s),startDrawPosition:this.getDrawPositionOnBoard(n,a),endDrawPosition:this.getDrawPositionOnBoard(i,s)});return o}updateViewInfo(){this.updateBoardInfo(),this.updateRemainingPiecesInfo()}updateBoardInfo(){for(let e=0;e<er.WIDTH;e++)this.viewInfo.boardInfo[e]={x:e,spaceClasses:[],pieces:this.getPieces(e)}}showLastMove(e){var t=this;return M(function*(){t.showLastMoveOnSpaces(e),t.showLastMoveOnPieces(e)})()}showLastMoveOnSpaces(e){for(let t=0;t<er.WIDTH;t++){const n=[];if(e.isDrop())e.getTarget()===t&&n.push("moved-fill");else{const i=e;(i.getTarget()===t||i.start.x===t)&&n.push("moved-fill")}this.viewInfo.boardInfo[t].spaceClasses=n}}showLastMoveOnPieces(e){const t=this.getPreviousState();let n=[];n=e.isDrop()?this.getLastMovedFromDrop(e,t):this.getLastMovedFromShift(e,t);for(const i of n)this.viewInfo.boardInfo[i.end.x].pieces[i.end.y].foregroundClasses.push("last-move-stroke")}updateRemainingPiecesInfo(){const e=this.getCurrentPlayer();this.viewInfo.remainingPieces=new En([{key:k.ZERO,value:[]},{key:k.ONE,value:[]}]);const t=this.isPlayerTurn();for(const n of Pn.PLAYER_PIECES){const i=this.getState().getRemainingPiecesOf(n);for(let s=0;s<i;s++){const o=[];this.isTopPieceOfReserveAndSelected(s,i,n)&&o.push("selected-stroke"),t&&s===i-1&&n.owner===e&&o.push("clickable-stroke-hover");const a=this.viewInfo.remainingPieces.get(n.owner).get(),c=[];c.push(n.otherPieceType?"player"+n.owner.value+"-alternate-fill":"player"+n.owner.value+"-fill"),a.push({backgroundClasses:c,foregroundClasses:o,y:s,drawPosition:this.getDrawPositionRemainingPiece(n,s),actualPiece:n}),this.viewInfo.remainingPieces.put(n.owner,a)}}}isTopPieceOfReserveAndSelected(e,t,n){if(this.selected.isPresent()){const i=this.selected.get();return"pieceFromReserve"===i.type&&i.piece===n&&e===t-1}return!1}getDrawPositionRemainingPiece(e,t){let n,i;return n=e.owner===k.ZERO?-100:600,i=e.otherPieceType?100:450,new C(n,i).getNext(new St(0,-t*Hc.PIECE_HEIGHT))}getPieces(e){const t=this.rules.findHighestAlignment(this.getState()),n=this.isPlayerTurn(),i=[];for(let s=0;s<er.HEIGHT;s++){const o=this.getState().getPieceAtXY(e,s),a=new C(e,s);if(o!==Pn.EMPTY){const c=[];this.pieceFromBoardIsSelected(e,s)&&c.push("selected-stroke"),this.isVictory(e,s,t)&&c.push("victory-stroke"),n&&this.rules.pieceCanMove(this.getState(),a)&&c.push("clickable-stroke-hover"),i.push({backgroundClasses:["player"+o.owner.value+(o.otherPieceType?"-alternate-fill":"-fill")],foregroundClasses:c,y:s,drawPosition:this.getDrawPositionOnBoard(e,s),actualPiece:o})}}return i}pieceFromBoardIsSelected(e,t){if(this.selected.isPresent()){const n=this.selected.get();return"pieceFromBoard"===n.type&&n.position.x===e&&n.position.y===t}return!1}isVictory(e,t,n){if(n.isPresent()){const i=n.get();return i.x%4==e%4&&i.y===t}return!1}getDrawPositionOnBoard(e,t){return Hc.CENTER[e].getNext(new St(0,-t*Hc.PIECE_HEIGHT))}cancelMoveAttempt(){var e=this;return M(function*(){e.selected=g.empty(),yield e.updateBoard(!1)})()}}LL=Hc,u(Hc,"CENTER",[new C(40,160),new C(100,50),new C(255,2),new C(400,50),new C(460,160),new C(400,270),new C(255,320),new C(100,270)]),u(Hc,"PIECE_HEIGHT",36),u(Hc,"\u0275fac",function(e){return new(e||LL)(B(Ut))}),u(Hc,"\u0275cmp",qe({type:LL,selectors:[["app-diam"]],features:[Qe],decls:8,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-110 -120 800 710","preserveAspectRatio","xMidYMid meet"],["id","piece"],["d","M 0 15 v 35 A 40 15, 0, 0, 0, 80 50 v -35 A 40 15, 0, 0, 0, 0 15 Z"],["cx","40","cy","15","rx","40","ry","15"],[3,"id",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],[3,"id"],[1,"base","mid-stroke",3,"id","ngClass","click"],[1,"base","mid-stroke","high-brightness",3,"ngClass","click"],["pointer-events","fill","class","base-no-fill no-fill mid-small-stroke",3,"id","ngClass","click",4,"ngFor","ngForOf"],["pointer-events","fill",1,"base-no-fill","no-fill","mid-small-stroke",3,"id","ngClass","click"],[0,"xlink","href","#piece",1,"base","mid-stroke",3,"ngClass"],[0,"xlink","href","#piece"],["class","base-no-fill no-fill mid-small-stroke",3,"id","ngClass","click",4,"ngFor","ngForOf"],[1,"base-no-fill","no-fill","mid-small-stroke",3,"id","ngClass","click"]],template:function(e,t){1&e&&(N(),S(0,"svg",0)(1,"defs")(2,"g",1),F(3,"path",2)(4,"ellipse",3),P()(),T(5,E9t,3,6,"g",4),T(6,P9t,2,1,"g",5),T(7,O9t,2,1,"g",5),P()),2&e&&(_(5),y("ngForOf",D1(3,b9t)),_(1),y("ngForOf",D1(4,w9t)),_(1),y("ngForOf",t.Player.PLAYERS))},dependencies:[Ft,Wt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}));class mo{static fromTwoCoords(e,t){const n=e.x,i=t.x,s=e.y,o=t.y,a=n+s,c=i+o;return n===i&&s!==o&&a!==c?g.of(mo.constantQ(n)):n!==i&&s===o&&a!==c?g.of(mo.constantR(s)):n!==i&&s!==o&&a===c?g.of(mo.constantS(a)):g.empty()}static constantQ(e){return new mo(e,"q")}static constantR(e){return new mo(e,"r")}static constantS(e){return new mo(e,"s")}static areOnSameLine(e){if(e.length<2)return!0;const t=mo.fromTwoCoords(e[0],e[1]);if(t.isAbsent())return!1;const n=t.get();for(const i of e.slice(2))if(!1===n.contains(i))return!1;return!0}constructor(e,t){u(this,"offset",void 0),u(this,"constant",void 0),this.offset=e,this.constant=t}toString(){return`Line(${this.constant}, ${this.offset})`}equals(e){return this===e||!(this.offset!==e.offset||this.constant!==e.constant)}contains(e){switch(this.constant){case"q":return e.x===this.offset;case"r":return e.y===this.offset;case"s":return e.x+e.y===this.offset}}getDirection(){switch(this.constant){case"q":return be.DOWN;case"r":return be.RIGHT;case"s":return be.DOWN_LEFT}}}class RL extends W1{constructor(e,t,n,i,s,o){super(t,e),u(this,"width",void 0),u(this,"height",void 0),u(this,"excludedSpaces",void 0),u(this,"empty",void 0),this.width=n,this.height=i,this.excludedSpaces=s,this.empty=o,Ze(this.excludedSpaces.length<this.height/2+1,"Invalid excluded spaces specification for HexagonalGameState.")}setAt(e,t){if(this.isOnBoard(e))return this.setAtUnsafe(e,t);throw new Error("Setting coord not on board: "+e+".")}equalsT(e,t){if(this===e)return!0;if(this.width!==e.width||this.height!==e.height||!1===t(this.empty,e.empty)||this.excludedSpaces.length!==e.excludedSpaces.length)return!1;for(let n=0;n<this.excludedSpaces.length;n++)if(this.excludedSpaces[n]!==e.excludedSpaces[n])return!1;for(const n of this.allCoords())if(!1===t(this.getPieceAt(n),e.getPieceAt(n)))return!1;return!0}allCoords(){const e=[];return this.forEachCoord(t=>{e.push(t)}),e}allLines(){const e=[];for(let t=0;t<this.width;t++)e.push(mo.constantQ(t));for(let t=0;t<this.height;t++)e.push(mo.constantR(t));for(let t=this.excludedSpaces.length;t<this.height+this.excludedSpaces.length;t++)e.push(mo.constantS(t));return e}getEntranceOnLine(e){let t,n;switch(e.constant){case"q":return n=null!=this.excludedSpaces[e.offset]?this.excludedSpaces[e.offset]:0,this.findEntranceFrom(e,new C(e.offset,n));case"r":return t=null!=this.excludedSpaces[e.offset]?this.excludedSpaces[e.offset]:0,this.findEntranceFrom(e,new C(t,e.offset));case"s":return this.findEntranceFrom(e,e.offset<this.width?new C(e.offset,0):new C(this.width-1,e.offset-this.width+1))}}findEntranceFrom(e,t){const n=e.getDirection();let i=t;for(let o=0;o<Math.max(this.width,this.height);o++){if(this.isOnBoard(i))return i;i=i.getNext(n)}const s=d2.logError("HexagonalGameState.findEntranceFrom","could not find a board entrance, board must be invalid",{start:t.toString(),line:e.toString()});throw new Error(s.getReason())}}class m2{static getNeighbors(e,t=1){const n=[];for(const i of be.factory.all)n.push(e.getNext(i,t));return n}static areNeighbors(e,t){for(const n of be.factory.all)if(e.getNext(n).equals(t))return!0;return!1}}var A0;class p1{static append(e,t){return new p1(e.owner,e.size+t.size,e.source||t.source)}constructor(e,t,n){u(this,"owner",void 0),u(this,"size",void 0),u(this,"source",void 0),this.owner=e,this.size=t,this.source=n}getOwner(){return this.owner}belongsTo(e){return this.owner===e}containsSource(){return this.source}isEmpty(){return 0===this.size}hasPieces(){return!1===this.isEmpty()}getSize(){return this.size}toString(){return"DvonnPieceStack("+this.owner.toString()+", "+this.size+", "+this.source+")"}equals(e){return this.owner===e.owner&&this.size===e.size&&this.source===e.source}}A0=p1,u(p1,"encoder",we.tuple([we.identity(),k.encoder,we.identity()],r=>[r.source,r.owner,r.size],r=>new A0(r[1],r[2],r[0]))),u(p1,"MAX_SIZE",49),u(p1,"EMPTY",new A0(K.NONE,0,!1)),u(p1,"UNREACHABLE",new A0(K.NONE,-1,!1)),u(p1,"PLAYER_ZERO",new A0(k.ZERO,1,!1)),u(p1,"PLAYER_ONE",new A0(k.ONE,1,!1)),u(p1,"SOURCE",new A0(K.NONE,1,!0));let Uo=(()=>{class r extends RL{static balancedBoard(){const t=p1.UNREACHABLE,n=p1.PLAYER_ZERO,i=p1.PLAYER_ONE,s=p1.SOURCE;return[[t,t,n,i,i,i,n,n,i,s,i],[t,i,i,n,n,n,i,i,n,i,i],[i,i,i,i,n,s,i,n,n,n,n],[n,n,i,n,n,i,i,i,n,n,t],[n,s,n,i,i,n,n,n,i,t,t]]}static isOnBoard(t){return!t.isNotInRange(r.WIDTH,r.HEIGHT)&&r.balancedBoard()[t.y][t.x]!==p1.UNREACHABLE}static getInitialState(){return new r(r.balancedBoard(),0,!1)}constructor(t,n,i){super(n,t,r.WIDTH,r.HEIGHT,r.EXCLUDED_SPACES,p1.EMPTY),u(this,"alreadyPassed",void 0),this.alreadyPassed=i}getAllPieces(){const t=[];for(let n=0;n<r.HEIGHT;n++)for(let i=0;i<r.WIDTH;i++){const s=new C(i,n);this.isOnBoard(s)&&this.getPieceAt(s).hasPieces()&&t.push(s)}return t}numberOfNeighbors(t){return m2.getNeighbors(t,1).filter(s=>this.isOnBoard(s)&&this.getPieceAt(s).hasPieces()).length}setAtUnsafe(t,n){const i=Ie.copyBiArray(this.board);return i[t.y][t.x]=n,new r(i,this.turn,this.alreadyPassed)}isOnBoard(t){return!t.isNotInRange(this.width,this.height)&&this.board[t.y][t.x]!==p1.UNREACHABLE}}return u(r,"WIDTH",11),u(r,"HEIGHT",5),u(r,"EXCLUDED_SPACES",[2,1]),r})(),N0=(()=>{class r{}return u(r,"NOT_PLAYER_PIECE",()=>$localize`You must select a piece or a stack of your color.`),u(r,"EMPTY_STACK",()=>$localize`You must select a stack.`),u(r,"TOO_MANY_NEIGHBORS",()=>$localize`This stack cannot be moved because all 6 of its neighbors are occupied. You must select a stack with strictly less than 6 neighbors.`),u(r,"CANT_REACH_TARGET",()=>$localize`This stack cannot move because it could never land on another piece.`),u(r,"INVALID_MOVE_LENGTH",()=>$localize`A stack must always be moved by as many spaces as there are pieces in the stack.`),u(r,"EMPTY_TARGET_STACK",()=>$localize`The stack must land on an occupied space.`),u(r,"MUST_MOVE_IN_STRAIGHT_LINE",()=>$localize`A stack must move in a straight line.`),r})();var zL;class dr extends $o{constructor(e,t){super(e,t)}static from(e,t){return-1===e.x&&-1===e.y&&-2===t.x&&-2===t.y?ie.success(dr.PASS):!1===Uo.isOnBoard(e)?ie.failure("Starting coord of DvonnMove must be on the board, not at "+e.toString()):!1===Uo.isOnBoard(t)?ie.failure("End coord of DvonnMove must be on the board, not at "+e.toString()):e.y===t.y||e.x===t.x||e.x+e.y===t.x+t.y?ie.success(new dr(e,t)):ie.failure(N0.MUST_MOVE_IN_STRAIGHT_LINE())}toString(){return this===dr.PASS?"DvonnMove.PASS":"DvonnMove("+this.getStart()+"->"+this.getEnd()+")"}length(){return this.getStart().y===this.getEnd().y?Math.abs(this.getStart().x-this.getEnd().x):(this.getStart(),this.getEnd(),Math.abs(this.getStart().y-this.getEnd().y))}}u(dr,"PASS",new(zL=dr)(new C(-1,-1),new C(-2,-2))),u(dr,"encoder",Hs.getFallibleEncoder(zL.from));const se=p1.EMPTY,tr=p1.UNREACHABLE,wl=p1.SOURCE,hu=p1.PLAYER_ZERO,pu=p1.PLAYER_ONE,A9t=new p1(k.ZERO,2,!1),DL=new p1(k.ONE,2,!1),oce=new p1(k.ZERO,4,!1),N9t=new p1(k.ONE,4,!1);class ace extends Zn{constructor(...e){super(...e),u(this,"tutorial",[q.anyMove($localize`Moving`,$localize`At Dvonn, each hexagonal space contains a stack of pieces.
        If no number is indicated on a stack, it means that it only contains one piece.
        The number written on a stack indicates the number of pieces within that stack, hence the number of points its owner gets.
        The owner of a stack is the one that has a piece at the top of the stack.
        Only the owner of a stack can move it.
        A stack cannot be moved if it is surrounded by 6 other stacks.
        A stack is moved by as many spaces as there are pieces within, in a straight line, and it should land on an occupied space.
        This line cannot move along the vertex of two neighboring spaces, as would a vertical move.
        Therefore, there are six possible directions.
        The player with dark pieces starts.<br/><br/>
        You're playing Dark, click on a stack and move it by one space.`,Uo.getInitialState(),dr.from(new C(2,0),new C(3,0)).get(),$localize`Congratulations!`),q.fromPredicate($localize`Disconnection`,$localize`Pieces with a lightning strike are called "sources".
        When a stack is not directly nor indirectly connected to a source, it is removed from the board.<br/><br/>
        You're playing Dark, try to disconnect the stack of 4 pieces from your opponent. There are two ways of doing that, one is better than the other: try to find that one!`,new Uo([[tr,tr,pu,wl,se,se,se,se,se,se,se],[tr,se,hu,se,se,se,se,se,se,se,se],[se,se,N9t,se,se,se,se,pu,wl,se,se],[se,se,se,se,se,se,se,se,se,se,tr],[se,se,se,se,se,se,se,se,se,tr,tr]],0,!1),dr.from(new C(2,1),new C(2,0)).get(),(t,n,i)=>t.getEnd().equals(new C(3,0))?b.failure($localize`You have successfully disconnected the stack of 4 pieces of your opponent, but on the next move your opponent will be able to move on your new stack, and to win the game! There exists a better outcome of this situation, try to find it.`):(Ze(t.getEnd().equals(new C(2,0)),"player made an impossible move"),b.SUCCESS),$localize`Nice, you have disconnected 4 pieces of your opponent, and your new stack cannot be reached by your opponent!
        Your opponent therefore lost 5 points: 4 from the disconnected stack, and one from the stack on which you moved.
        Disconnected stacks will not be visible at the next turn.`),q.fromPredicate($localize`Moving on a source`,$localize`You are allowed to move your stacks on any other stack.
        This means that you can take control of a source by moving one of your stack on top of it.
        This way, you know that this stack may never be disconnected, as it contains a source.<br/><br/>
        You're playing Dark and you can take control of a source, do it!`,new Uo([[tr,tr,wl,pu,se,se,se,se,se,se,se],[tr,hu,hu,se,se,se,se,se,se,se,se],[se,pu,hu,pu,se,se,hu,DL,wl,se,se],[se,se,pu,se,se,se,se,se,se,se,tr],[se,se,se,se,se,se,se,se,se,tr,tr]],0,!1),dr.from(new C(2,1),new C(2,0)).get(),(t,n,i)=>t.getEnd().equals(new C(2,0))?b.SUCCESS:b.failure($localize`You have not taken possession of a source, try again.`),$localize`Congratulations! However, note that your opponent could later take possession of one of your stack that contains a source, so watch out when you take control of sources!`),q.informational($localize`Passing`,$localize`It can happen that you have no possible move to make.
        If this is the case, and if your opponent can still move, you must pass your turn.<br/><br/>
        This is a situation that occurs here for Dark.`,new Uo([[tr,tr,wl,se,se,se,se,se,se,se,se],[tr,se,A9t,se,se,se,se,se,se,se,se],[se,se,DL,se,se,se,se,DL,wl,oce,se],[se,se,se,se,se,se,se,se,se,se,tr],[se,se,se,se,se,se,se,se,se,tr,tr]],0,!1)),q.fromMove($localize`End of the game`,$localize`When no more move is possible for both players, the game ends and the player with the most points wins.<br/><br/>You're playing Dark, make your last move.`,new Uo([[tr,tr,wl,se,se,se,se,se,se,se,se],[tr,se,hu,se,se,se,se,se,se,se,se],[se,se,se,se,se,se,se,se,wl,oce,se],[se,se,se,se,se,se,se,se,se,se,tr],[se,se,se,se,se,se,se,se,se,tr,tr]],0,!1),[dr.from(new C(2,1),new C(2,0)).get()],$localize`Congratulations, you won 6 - 0!`,$localize`Bad idea, by moving on the source you would have won a point.`)])}}class wr extends Yn{static get(){return wr.singleton.isAbsent()&&(wr.singleton=g.of(new wr)),wr.singleton.get()}constructor(){super(Uo)}static getGameStatus(e){const t=e.gameState,n=wr.getScores(t);return 0===wr.getMovablePieces(t).length?n[0]>n[1]?_e.ZERO_WON:n[0]<n[1]?_e.ONE_WON:_e.DRAW:_e.ONGOING}static getMovablePieces(e){return wr.getFreePieces(e).filter(t=>wr.pieceHasTarget(e,t))}static getFreePieces(e){return e.getAllPieces().filter(t=>e.getPieceAt(t).belongsTo(e.getCurrentPlayer())&&e.numberOfNeighbors(t)<6)}static pieceHasTarget(e,t){const n=e.getPieceAt(t).getSize();return void 0!==m2.getNeighbors(t,n).find(s=>e.isOnBoard(s)&&e.getPieceAt(s).hasPieces())}static pieceTargets(e,t){const n=e.getPieceAt(t).getSize();return m2.getNeighbors(t,n).filter(s=>e.isOnBoard(s)&&e.getPieceAt(s).hasPieces())}static getScores(e){let t=0,n=0;return e.getAllPieces().map(i=>{const s=e.getPieceAt(i);s.belongsTo(k.ZERO)?t+=s.getSize():s.belongsTo(k.ONE)&&(n+=s.getSize())}),[t,n]}isMovablePiece(e,t){Ze(e.isOnBoard(t),"piece is not on the board");const n=e.getPieceAt(t);return n.getSize()<1?b.failure(N0.EMPTY_STACK()):!1===n.belongsTo(e.getCurrentPlayer())?b.failure(N0.NOT_PLAYER_PIECE()):e.numberOfNeighbors(t)>=6?b.failure(N0.TOO_MANY_NEIGHBORS()):!1===wr.pieceHasTarget(e,t)?b.failure(N0.CANT_REACH_TARGET()):b.SUCCESS}canOnlyPass(e){return 0===wr.getMovablePieces(e).length}sourceCoords(e){return e.getAllPieces().filter(t=>e.getPieceAt(t).containsSource())}markPiecesConnectedTo(e,t,n){m2.getNeighbors(t,1).forEach(i=>{e.isOnBoard(i)&&!1===n[i.y][i.x]&&e.getPieceAt(i).hasPieces()&&(n[i.y][i.x]=!0,this.markPiecesConnectedTo(e,i,n))})}removeDisconnectedPieces(e){const t=Ie.createTable(Uo.WIDTH,Uo.HEIGHT,!1);this.sourceCoords(e).forEach(i=>{t[i.y][i.x]=!0,this.markPiecesConnectedTo(e,i,t)});let n=e;return n.getAllPieces().forEach(i=>{!1===t[i.y][i.x]&&(n=n.setAt(i,p1.EMPTY))}),n}applyLegalMove(e,t,n){if(e===dr.PASS)return new Uo(t.board,t.turn+1,!0);{const i=t.getPieceAt(e.getStart()),s=t.getPieceAt(e.getEnd()),o=t.setAt(e.getStart(),p1.EMPTY).setAt(e.getEnd(),p1.append(i,s));return this.removeDisconnectedPieces(new Uo(o.board,t.turn+1,!1))}}isLegal(e,t){if(0===wr.getMovablePieces(t).length)return e===dr.PASS&&!1===t.alreadyPassed?b.SUCCESS:b.failure(Re.MUST_PASS());if(e===dr.PASS)return b.failure(Re.CANNOT_PASS());const n=this.isMovablePiece(t,e.getStart());if(n.isFailure())return n;const i=t.getPieceAt(e.getStart());return e.length()!==i.getSize()?ie.failure(N0.INVALID_MOVE_LENGTH()):t.getPieceAt(e.getEnd()).isEmpty()?ie.failure(N0.EMPTY_TARGET_STACK()):ie.success(void 0)}getGameStatus(e){return wr.getGameStatus(e)}}u(wr,"singleton",g.empty());class I9t extends fr{getMetrics(e){return wr.getScores(e.gameState)}}class cce extends Un{getListMoves(e){const t=e.previousMove,n=e.gameState,i=[];return wr.getMovablePieces(n).forEach(s=>wr.pieceTargets(n,s).forEach(o=>{const a=dr.from(s,o).get();i.push(a)})),0===i.length&&!1===t.equalsValue(dr.PASS)&&i.push(dr.PASS),i}}class lce extends cce{getListMoves(e){const t=e.gameState,n=super.getListMoves(e),i=t.getCurrentOpponent();return Ie.sortByDescending(n,s=>{Ze(s!==dr.PASS,"Cannot sort with DvonnMove.PASS");const o=t.getPieceAt(s.getEnd());return o.belongsTo(i)?o.getSize():0}),n}}class k9t extends fr{getMetrics(e){const t=e.gameState,n=wr.getScores(t),i=t.getAllPieces(),s=i.length;for(const o of k.PLAYERS){const a=i.filter(c=>t.getPieceAt(c).belongsTo(o)).length;n[o.value]=n[o.value]*a/s}return n}}function x9t(r,e){if(1&r&&(N(),F(0,"circle",11)),2&r){const t=p().$implicit,n=p().$implicit,i=p();ye("id","piece_",n.x,"_",n.y,""),y("ngClass",i.getPieceClasses(t)),I("cx",i.getCenterAt(n).x)("cy",i.getCenterAt(n).y)("r",i.SPACE_SIZE)}}function L9t(r,e){if(1&r&&(N(),F(0,"polygon",12)),2&r){const t=p().$implicit,n=p().$implicit,i=p();I("transform",1===t.getSize()?"translate("+(i.getCenterAt(n).x-18)+" "+(i.getCenterAt(n).y-16)+") scale(0.10)":"translate("+(i.getCenterAt(n).x-3)+" "+(i.getCenterAt(n).y-12)+") scale(0.07)")}}function R9t(r,e){if(1&r){const t=pe();N(),S(0,"text",13),W("click",function(){te(t);const i=p(2).$implicit;return ne(p().onClick(i.x,i.y))}),lt(1),P()}if(2&r){const t=p().$implicit,n=p().$implicit,i=p();I("x",t.containsSource()?i.getCenterAt(n).x-7:i.getCenterAt(n).x)("y",i.getCenterAt(n).y),_(1),An(t.getSize())}}function z9t(r,e){if(1&r){const t=pe();N(),S(0,"g",6),W("click",function(){te(t);const i=p().$implicit;return ne(p().onClick(i.x,i.y))}),F(1,"polygon",7),T(2,x9t,1,6,"circle",8),T(3,L9t,1,1,"polygon",9),T(4,R9t,2,3,"text",10),P()}if(2&r){const t=e.$implicit,n=p().$implicit,i=p();ye("id","click_",n.x,"_",n.y,""),_(1),I("points",i.getHexaPointsAt(n)),_(1),y("ngIf",t.getSize()>0),_(1),y("ngIf",t.containsSource()),_(1),y("ngIf",t.getSize()>1)}}const D9t=function(r){return[r]};function H9t(r,e){if(1&r&&(N(),S(0,"g"),T(1,z9t,5,6,"g",5),P()),2&r){const t=e.$implicit,n=p();_(1),y("ngForOf",_a(1,D9t,n.state.getPieceAt(t)))}}function V9t(r,e){if(1&r&&(N(),S(0,"text",18),lt(1),P()),2&r){const t=p().$implicit,n=p();I("x",n.getCenterAt(t.coord).x)("y",n.getCenterAt(t.coord).y),_(1),An(t.spaceContent.getSize())}}function F9t(r,e){if(1&r&&(N(),S(0,"g",14),F(1,"polygon",15)(2,"circle",16),T(3,V9t,2,3,"text",17),P()),2&r){const t=e.$implicit,n=p();ye("id","disconnected_",t.coord.x,"_",t.coord.y,""),_(1),I("points",n.getHexaPointsAt(t.coord)),_(1),ye("id","captured_",t.coord.x,"_",t.coord.y,""),y("ngClass",n.getPieceClasses(t.spaceContent)),I("cx",n.getCenterAt(t.coord).x)("cy",n.getCenterAt(t.coord).y)("r",n.SPACE_SIZE),_(1),y("ngIf",t.spaceContent.getSize()>1)}}function $9t(r,e){if(1&r&&(N(),Gt(0),F(1,"polygon",19)(2,"polygon",19),Bt()),2&r){const t=p();_(1),I("points",t.getHexaPointsAt(t.lastMove.get().getStart())),_(1),I("points",t.getHexaPointsAt(t.lastMove.get().getEnd()))}}function G9t(r,e){if(1&r&&(N(),F(0,"polygon",20)),2&r){const t=p();ye("id","chosen_",t.chosen.get().x,"_",t.chosen.get().y,""),I("points",t.getHexaPointsAt(t.chosen.get()))}}let B9t=(()=>{var r;class e extends au{constructor(n){super(n),u(this,"lastMove",g.empty()),u(this,"chosen",g.empty()),u(this,"disconnecteds",[]),u(this,"state",void 0),this.rules=wr.get(),this.node=this.rules.getInitialNode(),this.availableAIs=[new on($localize`Stacks`,this.rules,new k9t,new lce),new on($localize`Score`,this.rules,new I9t,new lce),new Kn($localize`MCTS`,new cce,this.rules)],this.encoder=dr.encoder,this.tutorial=(new ace).tutorial,this.SPACE_SIZE=30,this.canPass=!1,this.scores=g.of(wr.getScores(this.getState())),this.hexaLayout=new cu(1.5*this.SPACE_SIZE,new C(-this.SPACE_SIZE,2*this.SPACE_SIZE),tC.INSTANCE),this.state=this.getState(),this.hexaBoard=this.getState().board}hideLastMove(){this.lastMove=g.empty()}updateBoard(n){var i=this;return M(function*(){i.cancelMoveAttempt(),i.state=i.getState(),i.disconnecteds=[],i.hideLastMove(),i.canPass=i.rules.canOnlyPass(i.state),i.scores=g.of(wr.getScores(i.state))})()}showLastMove(n){var i=this;return M(function*(){i.lastMove=g.of(n);const s=i.getPreviousState(),o=i.getState();for(let a=0;a<o.board.length;a++)for(let c=0;c<o.board[a].length;c++){const l=new C(c,a);if(!0===o.isOnBoard(l)&&!1===l.equals(i.lastMove.get().getStart())){const f=o.getPieceAt(l),d=s.getPieceAt(l);if(f.isEmpty()&&d.hasPieces()){const E={coord:new C(c,a),spaceContent:d};i.disconnecteds.push(E)}}}})()}cancelMoveAttempt(){this.chosen=g.empty()}pass(){var n=this;return M(function*(){return Ze(n.canPass,"DvonnComponent: pass() can only be called if canPass is true"),yield n.chooseMove(dr.PASS)})()}onClick(n,i){var s=this;return M(function*(){const o=yield s.canUserPlay("#click_"+n+"_"+i);return o.isFailure()?s.cancelMove(o.getReason()):s.chosen.isAbsent()?s.choosePiece(n,i):s.chosen.equalsValue(new C(n,i))?(s.cancelMoveAttempt(),b.SUCCESS):yield s.chooseDestination(n,i)})()}choosePiece(n,i){var s=this;return M(function*(){const o=new C(n,i),a=s.rules.isMovablePiece(s.getState(),o);return a.isSuccess()?(s.chosen=g.of(o),b.SUCCESS):s.cancelMove(a.getReason())})()}chooseDestination(n,i){var s=this;return M(function*(){const o=s.getState(),a=s.chosen.get(),c=new C(n,i),l=dr.from(a,c);return l.isFailure()?s.rules.isMovablePiece(o,c).isSuccess()?s.choosePiece(n,i):s.cancelMove(l.getReason()):s.rules.isLegal(l.get(),o).isFailure()&&s.rules.isMovablePiece(o,c).isSuccess()?s.choosePiece(n,i):s.chooseMove(l.get())})()}getPieceClasses(n){if(n.containsSource()&&1===n.getSize())return["nonplayer-fill","dashed-stroke"];const i=this.getPlayerClass(n.getOwner());return n.containsSource()?[i,"nonplayer-stroke","dashed-stroke"]:[i]}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(Ut))}),u(e,"\u0275cmp",qe({type:r,selectors:[["app-dvonn"]],features:[Qe],decls:5,vars:4,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","0 0 875 380","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id",4,"ngFor","ngForOf"],[4,"ngIf"],["class","base no-fill selected-stroke",3,"id",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base","mid-stroke"],["class","base mid-stroke",3,"id","ngClass",4,"ngIf"],["class","nonplayer-light-fill","points","157.055,0 90.798,196.319 164.417,196.319 88.344,400 289.571,159.509 218.405,159.509 311.656,0",4,"ngIf"],["class","text-center text-medium","dy","13",3,"click",4,"ngIf"],[1,"base","mid-stroke",3,"id","ngClass"],["points","157.055,0 90.798,196.319 164.417,196.319 88.344,400 289.571,159.509 218.405,159.509 311.656,0",1,"nonplayer-light-fill"],["dy","13",1,"text-center","text-medium",3,"click"],[3,"id"],[1,"base","mid-stroke","captured-fill"],[1,"base","mid-stroke","semi-transparent",3,"id","ngClass"],["class","text-center text-medium","dy","13",4,"ngIf"],["dy","13",1,"text-center","text-medium"],[1,"base","no-fill","last-move-stroke"],[1,"base","no-fill","selected-stroke",3,"id"]],template:function(n,i){1&n&&(N(),S(0,"svg",0),T(1,H9t,2,3,"g",1),T(2,F9t,4,10,"g",2),T(3,$9t,3,2,"ng-container",3),T(4,G9t,1,3,"polygon",4),P()),2&n&&(_(1),y("ngForOf",i.state.allCoords()),_(1),y("ngForOf",i.disconnecteds),_(1),y("ngIf",i.lastMove.isPresent()),_(1),y("ngIf",i.chosen.isPresent()))},dependencies:[Ft,Wt,At],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();var u4,R1=function(r){return r[r.NONE=0]="NONE",r[r.SMALL=1]="SMALL",r[r.MEDIUM=2]="MEDIUM",r[r.BIG=3]="BIG",r}(R1||{});class Ue{static of(e){switch(e){case 0:return this.SMALL_DARK;case 1:return this.SMALL_LIGHT;case 2:return this.MEDIUM_DARK;case 3:return this.MEDIUM_LIGHT;case 4:return this.BIG_DARK;case 5:return this.BIG_LIGHT;case 6:return this.NONE;default:throw new Error("Invalid value "+e+" for EncapsulePiece")}}static ofSizeAndPlayer(e,t){return t===k.ZERO&&e===R1.BIG?Ue.BIG_DARK:t===k.ZERO&&e===R1.MEDIUM?Ue.MEDIUM_DARK:t===k.ZERO&&e===R1.SMALL?Ue.SMALL_DARK:t===k.ONE&&e===R1.BIG?Ue.BIG_LIGHT:t===k.ONE&&e===R1.MEDIUM?Ue.MEDIUM_LIGHT:t===k.ONE&&e===R1.SMALL?Ue.SMALL_LIGHT:Ue.NONE}constructor(e){u(this,"value",void 0),this.value=e}getPlayer(){switch(this){case Ue.SMALL_DARK:case Ue.MEDIUM_DARK:case Ue.BIG_DARK:return k.ZERO;case Ue.SMALL_LIGHT:case Ue.MEDIUM_LIGHT:case Ue.BIG_LIGHT:return k.ONE;default:return K.NONE}}getSize(){switch(this){case Ue.BIG_DARK:case Ue.BIG_LIGHT:return R1.BIG;case Ue.MEDIUM_DARK:case Ue.MEDIUM_LIGHT:return R1.MEDIUM;case Ue.SMALL_DARK:case Ue.SMALL_LIGHT:return R1.SMALL;default:return U.expectToBe(this,Ue.NONE),R1.NONE}}belongsTo(e){return this.getPlayer()===e}equals(e){return this===e}toString(){switch(this){case Ue.BIG_DARK:return"BIG_DARK";case Ue.BIG_LIGHT:return"BIG_LIGHT";case Ue.MEDIUM_DARK:return"MEDIUM_DARK";case Ue.MEDIUM_LIGHT:return"MEDIUM_LIGHT";case Ue.SMALL_DARK:return"SMALL_DARK";case Ue.SMALL_LIGHT:return"SMALL_LIGHT";default:return U.expectToBe(this,Ue.NONE),"EMPTY"}}}u4=Ue,u(Ue,"encoder",we.tuple([we.identity()],r=>[r.value],r=>u4.of(r[0]))),u(Ue,"SMALL_DARK",new u4(0)),u(Ue,"SMALL_LIGHT",new u4(1)),u(Ue,"MEDIUM_DARK",new u4(2)),u(Ue,"MEDIUM_LIGHT",new u4(3)),u(Ue,"BIG_DARK",new u4(4)),u(Ue,"BIG_LIGHT",new u4(5)),u(Ue,"NONE",new u4(6));class Al extends W1{constructor(e,t,n){super(e,t),u(this,"remainingPieces",void 0),this.remainingPieces=n}static getInitialState(){const e=new $2(K.NONE,K.NONE,K.NONE),t=Ie.createTable(3,3,e);return new Al(t,0,[Ue.BIG_DARK,Ue.BIG_DARK,Ue.BIG_LIGHT,Ue.BIG_LIGHT,Ue.MEDIUM_DARK,Ue.MEDIUM_DARK,Ue.MEDIUM_LIGHT,Ue.MEDIUM_LIGHT,Ue.SMALL_DARK,Ue.SMALL_DARK,Ue.SMALL_LIGHT,Ue.SMALL_LIGHT])}getRemainingPieces(){return Ie.copyImmutableArray(this.remainingPieces)}getRemainingPiecesOfPlayer(e){return this.getRemainingPieces().filter(t=>t.getPlayer()===e)}pieceBelongsToCurrentPlayer(e){return e.belongsTo(this.getCurrentPlayer())}isDroppable(e){return this.pieceBelongsToCurrentPlayer(e)&&this.isInRemainingPieces(e)}isInRemainingPieces(e){return this.remainingPieces.some(t=>t===e)}getPlayerRemainingPieces(){return this.remainingPieces.filter(e=>this.pieceBelongsToCurrentPlayer(e))}}class $2{constructor(e,t,n){u(this,"small",void 0),u(this,"medium",void 0),u(this,"big",void 0),this.small=e,this.medium=t,this.big=n}isEmpty(){return this.small===K.NONE&&this.medium===K.NONE&&this.big===K.NONE}toList(){const e=[];return this.small.isPlayer()&&e.push(Ue.ofSizeAndPlayer(R1.SMALL,this.small)),this.medium.isPlayer()&&e.push(Ue.ofSizeAndPlayer(R1.MEDIUM,this.medium)),this.big.isPlayer()&&e.push(Ue.ofSizeAndPlayer(R1.BIG,this.big)),e}toOrderedPieceNames(){const e=Ue.ofSizeAndPlayer(R1.SMALL,this.small),t=Ue.ofSizeAndPlayer(R1.MEDIUM,this.medium),n=Ue.ofSizeAndPlayer(R1.BIG,this.big);return[e.toString(),t.toString(),n.toString()]}getBiggest(){return this.big===k.ZERO?Ue.BIG_DARK:this.big===k.ONE?Ue.BIG_LIGHT:this.medium===k.ZERO?Ue.MEDIUM_DARK:this.medium===k.ONE?Ue.MEDIUM_LIGHT:this.small===k.ZERO?Ue.SMALL_DARK:this.small===k.ONE?Ue.SMALL_LIGHT:Ue.NONE}tryToSuperposePiece(e){const t=this.getBiggest().getSize();if(e===Ue.NONE)throw new Error("Cannot move EMPTY on a space");return e.getSize()>t?g.of(this.put(e)):g.empty()}removeBiggest(){const e=this.getBiggest();if(e===Ue.NONE)throw new Error("Cannot removed piece from empty space");let t;const n=e.getSize();switch(n){case R1.BIG:t=new $2(this.small,this.medium,K.NONE);break;case R1.MEDIUM:t=new $2(this.small,K.NONE,K.NONE);break;default:U.expectToBe(n,R1.SMALL),t=new $2(K.NONE,K.NONE,K.NONE)}return{removedSpace:t,removedPiece:e}}put(e){if(e===Ue.NONE)throw new Error("Cannot put NONE on space");const t=e.getPlayer(),n=e.getSize();switch(n){case R1.BIG:return new $2(this.small,this.medium,t);case R1.MEDIUM:return Ze(this.big===K.NONE,"Cannot put a piece on top of a bigger one"),new $2(this.small,t,this.big);default:return U.expectToBe(n,R1.SMALL),Ze(this.big===K.NONE,"Cannot put a piece on top of a bigger one"),Ze(this.medium===K.NONE,"Cannot put a piece on top of a bigger one"),new $2(t,this.medium,this.big)}}belongsTo(e){return this.getBiggest().getPlayer()===e}toString(){const e=this.toOrderedPieceNames();return"("+e[0]+", "+e[1]+", "+e[2]+")"}}u($2,"EMPTY",new $2(K.NONE,K.NONE,K.NONE));let xd=(()=>{class r{}return u(r,"PIECE_OUT_OF_STOCK",()=>$localize`You do not have pieces of this type anymore.`),u(r,"INVALID_PLACEMENT",()=>$localize`You must put your piece on an empty square or on a smaller piece.`),u(r,"NOT_DROPPABLE",()=>$localize`You must pick your piece among the remaining ones.`),u(r,"INVALID_PIECE_SELECTED",()=>$localize`You must pick one of your remaining pieces or one piece on the board that is the biggest of its square.`),u(r,"END_YOUR_MOVE",()=>$localize`You are performing a move, you must select a landing square.`),r})();var Ld,La;let gu=(Ld=class extends Yn{static get(){return La.singleton.isAbsent()&&(La.singleton=g.of(new La)),La.singleton.get()}constructor(){super(Al)}static isVictory(e){const t=e.getCopiedBoard();for(const n of La.LINES){const s=La.isVictoriousLine([t[n[0].y][n[0].x],t[n[1].y][n[1].x],t[n[2].y][n[2].x]]);if(s.isPresent())return s}return g.empty()}static isVictoriousLine(e){const n=e.map(i=>i.getBiggest()).map(i=>i.getPlayer());return n[0]===K.NONE?g.empty():n[0]===n[1]&&n[1]===n[2]?g.of(n[0]):g.empty()}static isLegal(e,t){let n;if(e.isDropping()){if(n=e.piece.get(),!1===t.pieceBelongsToCurrentPlayer(n))return ie.failure(Re.MUST_CHOOSE_PLAYER_PIECE());if(!1===t.isInRemainingPieces(n))return ie.failure(xd.PIECE_OUT_OF_STOCK())}else{const o=e.startingCoord.get();if(n=t.getPieceAt(o).getBiggest(),!1===t.pieceBelongsToCurrentPlayer(n))return ie.failure(Re.MUST_CHOOSE_PLAYER_PIECE())}const s=t.getPieceAt(e.landingCoord).tryToSuperposePiece(n);return s.isPresent()?ie.success(s.get()):ie.failure(xd.INVALID_PLACEMENT())}isLegal(e,t){return La.isLegal(e,t)}applyLegalMove(e,t,n){const i=t.getCopiedBoard();let s=t.getRemainingPieces();const o=t.turn+1;let a;if(i[e.landingCoord.y][e.landingCoord.x]=n,e.isDropping()){a=e.piece.get();const l=s.indexOf(a);s=s.slice(0,l).concat(s.slice(l+1))}else{const l=e.startingCoord.get(),d=i[l.y][l.x].removeBiggest();i[l.y][l.x]=d.removedSpace,a=d.removedPiece}return new Al(i,o,s)}static getGameStatus(e){const n=La.isVictory(e.gameState);return n.isPresent()?_e.getVictory(n.get()):_e.ONGOING}getGameStatus(e){return La.getGameStatus(e)}},La=Ld,u(Ld,"singleton",g.empty()),u(Ld,"LINES",[[new C(0,0),new C(0,1),new C(0,2)],[new C(1,0),new C(1,1),new C(1,2)],[new C(2,0),new C(2,1),new C(2,2)],[new C(0,0),new C(1,0),new C(2,0)],[new C(0,1),new C(1,1),new C(2,1)],[new C(0,2),new C(1,2),new C(2,2)],[new C(0,0),new C(1,1),new C(2,2)],[new C(0,2),new C(1,1),new C(2,0)]]),Ld);var fce;gu=La=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ne.log],gu);class _2 extends Di{constructor(e,t,n){super(),u(this,"startingCoord",void 0),u(this,"landingCoord",void 0),u(this,"piece",void 0),this.startingCoord=e,this.landingCoord=t,this.piece=n}static ofMove(e,t){return U.assert(!1===e.equals(t),"Starting coord and landing coord must be separate coords"),new _2(g.of(e),t,g.empty())}static ofDrop(e,t){return new _2(g.empty(),t,g.of(e))}isDropping(){return this.startingCoord.isAbsent()}equals(e){return this===e||!1!==e.landingCoord.equals(this.landingCoord)&&!1!==this.startingCoord.equals(e.startingCoord)&&this.piece.equals(e.piece)}toString(){return this.isDropping()?"EncapsuleMove("+this.piece.get().toString()+" -> "+this.landingCoord+")":"EncapsuleMove("+this.startingCoord.get()+"->"+this.landingCoord+")"}}fce=_2,u(_2,"encoder",we.tuple([g.getEncoder(C.encoder),C.encoder,g.getEncoder(Ue.encoder)],r=>[r.startingCoord,r.landingCoord,r.piece],r=>new fce(r[0],r[1],r[2])));const _s=new $2(K.NONE,K.NONE,K.NONE),dce=new $2(k.ZERO,K.NONE,K.NONE),W9t=new $2(K.NONE,k.ZERO,K.NONE),q9t=new $2(K.NONE,K.NONE,k.ZERO),hce=new $2(k.ONE,K.NONE,K.NONE),uC=new $2(K.NONE,K.NONE,k.ONE),j9t=new $2(k.ONE,k.ZERO,K.NONE),Z9t=new $2(k.ZERO,k.ZERO,K.NONE);class pce extends Zn{constructor(...e){super(...e),u(this,"tutorial",[q.informational($localize`Goal of the game`,$localize`The goal of Encapsule is to align three of your pieces.
        Here, we have a victory of the dark player.`,new Al([[dce,hce,uC],[_s,W9t,_s],[_s,_s,q9t]],0,[Ue.SMALL_DARK,Ue.MEDIUM_DARK,Ue.BIG_DARK,Ue.SMALL_LIGHT,Ue.MEDIUM_LIGHT,Ue.MEDIUM_LIGHT,Ue.BIG_LIGHT])),q.anyMove($localize`Putting a piece`,$localize`This is the initial board.<br/><br/>
        You're playing Dark. Pick one of your piece on the side of the board and put it on the board.`,Al.getInitialState(),_2.ofDrop(Ue.SMALL_DARK,new C(1,1)),$localize`Congratulations!`),q.fromMove($localize`Moving`,$localize`Another possible action is to move one of your pieces that is already on the board.<br/><br/>
        You're playing Dark, click on your piece already on the board and then on any empty square of the board.`,new Al([[dce,uC,_s],[_s,_s,_s],[_s,_s,_s]],0,[]),[_2.ofMove(new C(0,0),new C(2,0)),_2.ofMove(new C(0,0),new C(0,1)),_2.ofMove(new C(0,0),new C(1,1)),_2.ofMove(new C(0,0),new C(2,1)),_2.ofMove(new C(0,0),new C(0,2)),_2.ofMove(new C(0,0),new C(1,2)),_2.ofMove(new C(0,0),new C(2,2))],$localize`Congratulations!`,$localize`Failed. Try again.`),q.fromPredicate($localize`Particularity`,$localize`At Encapsule, pieces encapsulate each other.
        It is therefore possible to have up to three pieces per square!
        However, only the biggest piece of each square counts:
        you cannot win with a piece that is "hidden" by a bigger piece.
        Similarly, you cannot move a piece if it is encapsulated by a bigger piece.
        Finally, you cannot encapsulate a piece with a smaller piece.
        Here, Dark can win now in various ways.<br/><br/>
        You're playing Dark, try to win by making a move, and not by putting a new piece on the board.`,new Al([[j9t,_s,hce],[Z9t,uC,uC],[_s,_s,_s]],0,[Ue.MEDIUM_DARK,Ue.BIG_DARK,Ue.MEDIUM_LIGHT,Ue.MEDIUM_LIGHT]),_2.ofMove(new C(0,1),new C(0,2)),(t,n,i)=>{if(t.landingCoord.equals(new C(0,2))){if(t.isDropping())return b.failure($localize`You won, but the exercise is to win while moving a piece!`);if(t.startingCoord.equalsValue(new C(0,1)))return b.SUCCESS}return b.failure($localize`Failed. Try again.`)},$localize`Congratulations!`)])}}class gce extends Un{getListMoves(e){const t=[],n=e.gameState,i=n.getCopiedBoard(),s=n.getCurrentPlayer(),o=uae.toComparableObjectSet(n.getPlayerRemainingPieces());for(let a=0;a<3;a++)for(let c=0;c<3;c++){const l=new C(c,a);for(const f of o){const d=_2.ofDrop(f,l);gu.isLegal(d,n).isSuccess()&&t.push(d)}if(i[a][c].belongsTo(s))for(let f=0;f<3;f++)for(let d=0;d<3;d++){const m=new C(d,f);if(!1===m.equals(l)){const E=_2.ofMove(l,m);gu.isLegal(E,n).isSuccess()&&t.push(E)}}}return t}}function Y9t(r,e){if(1&r){const t=pe();N(),S(0,"g")(1,"circle",5),W("click",function(){const i=te(t),s=i.$implicit,o=i.index,a=p().$implicit;return ne(p().onPieceClick(a.value,s,o))}),P()()}if(2&r){const t=e.$implicit,n=e.index,i=p().$implicit,s=p();_(1),wi("id","piece_",i.value,"_",t.toString(),"_",n,""),y("ngClass",s.getSidePieceClasses(t,n)),I("transform","rotate("+180*(s.role.value+i.value)+" "+s.CENTER+" "+s.CENTER+")")("r",s.getPieceRadius(t))("cx",s.getRemainingPieceCenterCoord(i,n).x)("cy",s.getRemainingPieceCenterCoord(i,n).y)}}function K9t(r,e){if(1&r&&(N(),S(0,"g",null,4),T(2,Y9t,2,8,"g",1),P()),2&r){const t=e.$implicit,n=p();_(2),y("ngForOf",n.getRemainingPieces(t))}}function X9t(r,e){if(1&r){const t=pe();N(),S(0,"circle",8),W("click",function(){te(t);const i=p().index,s=p().index;return ne(p().onBoardClick(i,s))}),P()}if(2&r){const t=e.$implicit,n=p().index,i=p().index,s=p();y("ngClass",s.getPieceClasses(t)),I("r",s.getPieceRadius(t))("cx",s.getPieceCenter(n))("cy",s.getPieceCenter(i))}}function Q9t(r,e){if(1&r){const t=pe();N(),S(0,"g")(1,"rect",6),W("click",function(){const s=te(t).index,o=p().index;return ne(p().onBoardClick(s,o))}),P(),T(2,X9t,1,4,"circle",7),P()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,s=p();_(1),ye("id","click_",n,"_",i,""),y("ngClass",s.getRectClasses(n,i)),I("x",s.SPACE_SIZE*n+s.STROKE_WIDTH)("y",s.SPACE_SIZE*i+s.STROKE_WIDTH)("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),_(1),y("ngForOf",s.getListPieces(t))}}function J9t(r,e){if(1&r&&(N(),S(0,"g"),T(1,Q9t,3,8,"g",1),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function edt(r,e){if(1&r){const t=pe();N(),S(0,"rect",9),W("click",function(){te(t);const i=p();return ne(i.onBoardClick(i.chosenCoord.get().x,i.chosenCoord.get().y))}),P()}if(2&r){const t=p();ye("id","chosenCoord_",t.chosenCoord.get().x,"_",t.chosenCoord.get().y,""),I("x",t.SPACE_SIZE*t.chosenCoord.get().x+t.STROKE_WIDTH)("y",t.SPACE_SIZE*t.chosenCoord.get().y+t.STROKE_WIDTH)("width",t.SPACE_SIZE)("height",t.SPACE_SIZE)}}let tdt=(()=>{var r;class e extends Fi{constructor(n){super(n),u(this,"CENTER",this.getPieceCenter(1)),u(this,"UPLEFT",-(this.SPACE_SIZE+.5*this.STROKE_WIDTH)),u(this,"WIDTH",5*this.SPACE_SIZE+3*this.STROKE_WIDTH),u(this,"lastLandingCoord",g.empty()),u(this,"lastStartingCoord",g.empty()),u(this,"chosenCoord",g.empty()),u(this,"chosenPiece",g.empty()),u(this,"chosenPieceIndex",void 0),u(this,"remainingPieceCenterCoords",new En),this.rules=gu.get(),this.node=this.rules.getInitialNode(),this.availableAIs=[new on($localize`Dummy`,this.rules,new PL,new gce),new Kn($localize`MCTS`,new gce,this.rules)],this.encoder=_2.encoder,this.tutorial=(new pce).tutorial}updateBoard(n){var i=this;return M(function*(){const s=i.getState();i.board=s.getCopiedBoard();const o=i.node.previousMove;i.calculateLeftPieceCoords(),o.isPresent()?(i.lastLandingCoord=g.of(o.get().landingCoord),i.lastStartingCoord=o.get().startingCoord):(i.lastLandingCoord=g.empty(),i.lastStartingCoord=g.empty())})()}getListPieces(n){return n.toList()}getRemainingPieces(n){return this.getState().getRemainingPiecesOfPlayer(n)}onBoardClick(n,i){var s=this;return M(function*(){const o=yield s.canUserPlay("#click_"+n+"_"+i);if(o.isFailure())return s.cancelMove(o.getReason());const a=new C(n,i),c=s.getState();if(s.chosenCoord.isAbsent()){if(s.chosenCoord=g.of(a),s.chosenPiece.isPresent()){const l=_2.ofDrop(s.chosenPiece.get(),a);return s.chooseMove(l)}return!1===c.getPieceAt(a).belongsTo(c.getCurrentPlayer())?s.cancelMove(xd.INVALID_PIECE_SELECTED()):b.SUCCESS}if(s.chosenCoord.equalsValue(a))return s.cancelMoveAttempt(),b.SUCCESS;{const l=_2.ofMove(s.chosenCoord.get(),a);return s.chooseMove(l)}})()}cancelMoveAttempt(){this.chosenCoord=g.empty(),this.chosenPiece=g.empty(),this.chosenPieceIndex=g.empty()}onPieceClick(n,i,s){var o=this;return M(function*(){const a="#piece_"+n+"_"+i.toString()+"_"+s,c=yield o.canUserPlay(a);return c.isFailure()?o.cancelMove(c.getReason()):!1===o.getState().isDroppable(i)?o.cancelMove(xd.NOT_DROPPABLE()):o.chosenCoord.isAbsent()?(o.chosenPiece.equalsValue(i)&&o.chosenPieceIndex.equalsValue(s)?(o.chosenPiece=g.empty(),o.chosenPieceIndex=g.empty()):(o.chosenPiece=g.of(i),o.chosenPieceIndex=g.of(s)),b.SUCCESS):o.cancelMove(xd.END_YOUR_MOVE())})()}getRectClasses(n,i){return this.isSelected(n,i)?"moved-fill":""}isSelected(n,i){const s=new C(n,i);return!(!this.lastStartingCoord.equalsValue(s)&&!this.lastLandingCoord.equalsValue(s))}getPieceClasses(n){return[this.getPieceStrokeClass(n)]}getPieceCenter(n){return this.SPACE_SIZE*n+this.STROKE_WIDTH+this.SPACE_SIZE/2}getPieceStrokeClass(n){const i=n.getPlayer();return Ze(i.isPlayer(),"EncapsuleComponent.getPieceStrokeClass should only be called with actual pieces!"),"player"+i.value+"-stroke"}getPieceRadius(n){switch(n.getSize()){case R1.BIG:return this.SPACE_SIZE/2-1*this.STROKE_WIDTH;case R1.MEDIUM:return this.SPACE_SIZE/2-2*this.STROKE_WIDTH-3;default:return U.expectToBe(n.getSize(),R1.SMALL),this.SPACE_SIZE/2-3*this.STROKE_WIDTH-6}}getSidePieceClasses(n,i){const s=this.getPieceClasses(n);return this.isSelectedPiece(n)&&this.chosenPieceIndex.equalsValue(i)&&s.push("selected-stroke"),s}isSelectedPiece(n){return this.chosenPiece.equalsValue(n)}calculateLeftPieceCoords(){this.remainingPieceCenterCoords=new En;for(const n of k.PLAYERS){const i=[],s=this.getRemainingPieces(n);for(let o=0;o<s.length;o++){let a,c=0,l=0;o<=2?(a=new C(2-o,3),l=this.STROKE_WIDTH):(a=new C(-1,5-o),c=-this.STROKE_WIDTH);const f=this.getPieceCenter(a.x),d=this.getPieceCenter(a.y);i.push(new C(f+c,d+l))}this.remainingPieceCenterCoords.set(n,i)}}getRemainingPieceCenterCoord(n,i){return this.remainingPieceCenterCoords.get(n).get()[i]}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(Ut))}),u(e,"\u0275cmp",qe({type:r,selectors:[["app-encapsule"]],features:[Qe],decls:6,vars:4,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["boardDiv",""],["class","base no-fill selected-stroke","pointer-events","fill",3,"id","click",4,"ngIf"],["remainingPieces",""],["pointer-events","fill",1,"base","no-fill",3,"id","ngClass","click"],[1,"base",3,"id","ngClass","click"],["class","base no-fill",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"base","no-fill",3,"ngClass","click"],["pointer-events","fill",1,"base","no-fill","selected-stroke",3,"id","click"]],template:function(n,i){1&n&&(N(),S(0,"svg",0),T(1,K9t,3,1,"g",1),S(2,"g",null,2),T(4,J9t,2,1,"g",1),T(5,edt,1,6,"rect",3),P()()),2&n&&(I("viewBox",i.UPLEFT+" "+i.UPLEFT+" "+i.WIDTH+" "+i.WIDTH),_(1),y("ngForOf",i.Player.PLAYERS),_(3),y("ngForOf",i.board),_(1),y("ngIf",i.chosenCoord.isPresent()))},dependencies:[Ft,Wt,At],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})(),fn=(()=>{class r extends W1{static getInitialState(){const t=K.NONE,n=K.ZERO,i=K.ONE;return new r([[i,i,i,i,i,i,i,i,i,i,i,i,i,i],[i,i,i,i,i,i,i,i,i,i,i,i,i,i],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[n,n,n,n,n,n,n,n,n,n,n,n,n,n],[n,n,n,n,n,n,n,n,n,n,n,n,n,n]],0)}static isOnBoard(t){return t.isInRange(r.WIDTH,r.HEIGHT)}count(t,n){let i=0;for(let s=0;s<14;s++)this.board[n][s]===t&&i++;return i}doesOwnPiece(t){for(const n of this.getCoordsAndContents())if(n.content===t)return!0;return!1}}return u(r,"WIDTH",14),u(r,"HEIGHT",12),r})();var mce;class Wo extends br{constructor(e,t,n,i,s){super(e,t),u(this,"movedPieces",void 0),u(this,"stepSize",void 0),u(this,"direction",void 0),this.movedPieces=n,this.stepSize=i,this.direction=s,U.assert(fn.isOnBoard(this.coord),"Illegal coord outside of board "+this.coord.toString()+"."),U.assert(n>0,"Must select minimum one piece (got "+n+")."),U.assert(i>0,"Step size must be minimum one (got "+i+")."),U.assert(i<=n,"Cannot move a phalanx further than its size (got step size "+i+" for "+n+" pieces).")}toString(){return"EpaminondasMove("+this.coord.toString()+", m:"+this.movedPieces+", s:"+this.stepSize+", "+this.direction.toString()+")"}equals(e){return this===e||!1!==this.coord.equals(e.coord)&&this.movedPieces===e.movedPieces&&this.stepSize===e.stepSize&&this.direction.equals(e.direction)}}mce=Wo,u(Wo,"encoder",we.tuple([C.encoder,we.identity(),we.identity(),Me.encoder],r=>[r.coord,r.movedPieces,r.stepSize,r.direction],r=>new mce(r[0].x,r[0].y,r[1],r[2],r[3])));let qo=(()=>{class r{}return u(r,"PHALANX_IS_LEAVING_BOARD",()=>$localize`The move distance of your phalanx puts it out of the board.`),u(r,"SOMETHING_IN_PHALANX_WAY",()=>$localize`There is something in the way of your phalanx.`),u(r,"PHALANX_SHOULD_BE_GREATER_TO_CAPTURE",()=>$localize`Your phalanx must be bigger than the one you are capturing.`),u(r,"SQUARE_NOT_ALIGNED_WITH_SELECTED",()=>$localize`This square is not aligned with the selected piece.`),u(r,"SINGLE_PIECE_MUST_MOVE_BY_ONE",()=>$localize`A single piece can only move by one square.`),u(r,"SINGLE_PIECE_CANNOT_CAPTURE",()=>$localize`A single piece cannot make a capture.`),u(r,"SQUARE_NOT_ALIGNED_WITH_PHALANX",()=>$localize`This square is not aligned with the direction of the phalanx.`),u(r,"PHALANX_CANNOT_CONTAIN_PIECES_OUTSIDE_BOARD",()=>$localize`A phalanx can't contain pieces outside of the board.`),u(r,"PHALANX_CANNOT_CONTAIN_EMPTY_SQUARE",()=>$localize`A phalanx cannot contain an empty square.`),u(r,"PHALANX_CANNOT_CONTAIN_OPPONENT_PIECE",()=>$localize`A phalanx cannot contain a piece of the opponent.`),r})();class $i extends Yn{static get(){return $i.singleton.isAbsent()&&($i.singleton=g.of(new $i)),$i.singleton.get()}constructor(){super(fn)}static isLegal(e,t){const n=this.getPhalanxValidity(t,e);if(n.isFailure())return ie.failure(n.getReason());const i=this.getLandingStatus(t,e);if(i.isFailure())return i;const s=Ie.copyBiArray(i.get()),o=t.getCurrentOpponent(),a=$i.getCaptureValidity(t,s,e,o);return a.isFailure()?a:ie.success(a.get())}static getPhalanxValidity(e,t){let n=t.coord,i=0;const s=e.getCurrentOpponent();for(;i<t.movedPieces;){if(!1===fn.isOnBoard(n))return b.failure(qo.PHALANX_CANNOT_CONTAIN_PIECES_OUTSIDE_BOARD());const o=e.getPieceAt(n);if(o===K.NONE)return b.failure(qo.PHALANX_CANNOT_CONTAIN_EMPTY_SQUARE());if(o===s)return b.failure(qo.PHALANX_CANNOT_CONTAIN_OPPONENT_PIECE());n=n.getNext(t.direction,1),i++}return b.SUCCESS}static getLandingStatus(e,t){const n=e.getCopiedBoard(),i=e.getCurrentPlayer();let s=t.coord,o=t.coord.getNext(t.direction,t.movedPieces),a=0;for(;a+1<t.stepSize;){if(n[s.y][s.x]=K.NONE,n[o.y][o.x]=i,!1===fn.isOnBoard(o))return ie.failure(qo.PHALANX_IS_LEAVING_BOARD());if(e.getPieceAt(o).isPlayer())return ie.failure(qo.SOMETHING_IN_PHALANX_WAY());a++,o=o.getNext(t.direction,1),s=s.getNext(t.direction,1)}return!1===fn.isOnBoard(o)?ie.failure(qo.PHALANX_IS_LEAVING_BOARD()):e.getPieceAt(o)===i?ie.failure(Re.SHOULD_LAND_ON_EMPTY_OR_OPPONENT_SPACE()):(n[s.y][s.x]=K.NONE,n[o.y][o.x]=i,ie.success(n))}static getCaptureValidity(e,t,n,i){let s=n.coord.getNext(n.direction,n.movedPieces+n.stepSize-1),o=0;for(;fn.isOnBoard(s)&&e.getPieceAt(s)===i;){if(o>0&&(t[s.y][s.x]=K.NONE),o++,o>=n.movedPieces)return ie.failure(qo.PHALANX_SHOULD_BE_GREATER_TO_CAPTURE());s=s.getNext(n.direction,1)}return ie.success(t)}isLegal(e,t){return $i.isLegal(e,t)}applyLegalMove(e,t,n){return new fn(n,t.turn+1)}getGameStatus(e){const t=e.gameState,n=t.count(k.ZERO,0),i=t.count(k.ONE,fn.HEIGHT-1);if(t.turn%2==0){if(n>i)return _e.ZERO_WON}else if(i>n)return _e.ONE_WON;return!1===t.doesOwnPiece(k.ZERO)?_e.ONE_WON:!1===t.doesOwnPiece(k.ONE)?_e.ZERO_WON:_e.ONGOING}}u($i,"singleton",g.empty());const O=K.NONE,j1=K.ZERO,s1=K.ONE;class _ce extends Zn{constructor(...e){super(...e),u(this,"tutorial",[q.informational($localize`Initial board`,$localize`This is the initial board of Epaminondas.
        The top line is the starting line of Light.
        The bottom line is the starting line of Dark.`,fn.getInitialState()),q.informational($localize`Goal of the game (1/2)`,$localize`After multiple moves, if at the beginning of its turn, a player has more pieces on the opponent's starting line
        than the number of pieces the opponent has on the player's starting line, the player wins.
        Here, it's Dark's turn to play: Dark has therefore won.`,new fn([[O,O,O,O,O,j1,O,O,s1,s1,s1,s1,s1,s1],[O,O,O,O,O,j1,O,O,O,O,O,O,s1,s1],[O,O,O,O,O,O,O,O,O,O,O,O,O,O],[O,O,O,O,O,O,O,O,O,O,O,O,O,O],[O,O,O,O,O,O,O,O,O,O,O,O,O,O],[O,O,O,O,O,O,O,O,O,O,O,O,O,O],[O,O,O,O,O,O,O,O,O,O,O,O,O,O],[O,O,O,O,O,O,O,O,O,O,O,O,O,O],[O,O,O,O,O,O,O,s1,O,O,O,O,O,O],[O,O,O,O,O,O,O,O,O,O,O,O,O,O],[O,O,O,O,O,O,O,O,O,O,O,O,O,O],[O,O,O,O,O,O,O,j1,j1,j1,j1,O,O,O]],0)),q.informational($localize`Goal of the game (2/2)`,$localize`Here, it is Light's turn.
        Light wins because they have two pieces on Dark's starting line, and Dark only has one on Light's starting line.`,new fn([[O,O,O,O,O,j1,O,O,O,O,s1,s1,s1,s1],[O,O,O,O,O,j1,O,O,O,O,O,O,O,O],[O,O,O,O,O,O,O,O,O,O,O,O,O,O],[O,O,O,O,O,O,O,O,O,O,O,O,O,O],[O,O,O,O,O,O,O,O,O,O,O,O,O,O],[O,O,O,O,O,O,O,O,O,O,O,O,O,O],[O,O,O,O,O,O,O,O,O,O,O,O,O,O],[O,O,O,O,O,O,O,O,O,O,O,O,O,O],[O,O,O,O,O,O,O,s1,O,O,O,O,O,O],[O,O,O,O,O,O,O,O,O,O,O,O,O,O],[O,O,O,O,O,O,O,O,O,O,O,O,O,O],[O,O,s1,s1,O,O,O,j1,j1,O,j1,j1,j1,j1]],1)),q.fromPredicate($localize`Moving a piece`,$localize`Here is the starting board. Dark plays first.
        Let's start with moving a single piece:
        <ol>
            <li>Click on a piece.</li>
            <li>Click on a empty neighboring square.</li>
        </ol><br/>You're playing Dark, move a piece.`,fn.getInitialState(),new Wo(0,10,1,1,Me.UP),(t,n,i)=>1===t.movedPieces?b.SUCCESS:b.failure($localize`Congratulations, you are in advance. But this is not the exercise here, try again.`),$localize`This is how you move a single piece.`),q.fromPredicate($localize`Moving a phalanx`,$localize`Let us now see how to move multiple pieces along a line, which is called a phalanx:
        <ol>
            <li>Click on the first piece of the phalanx.</li>
            <li>Click on the last piece of the phalanx.</li>
            <li>Click on one of the squares highlighted in yellow; you can move your phalanx up to a distance equal to its length.</li>
        </ol><br/>
        You're playing Dark, Move a phalanx!`,fn.getInitialState(),new Wo(0,11,2,1,Me.UP),(t,n,i)=>t.movedPieces>1?b.SUCCESS:b.failure($localize`Failed! You moved only one piece.`),$localize`Congratulations!
        The moved pieces can be horizontally, vertically, or diagonally aligned.
        The move should be made along this axis, forward or backwards.
        There can be no opponent nor holes in the phalanx.`),q.fromMove($localize`Capture`,$localize`In order to capture pieces of the opponent:
        <ol>
            <li>It must be aligned with the phalanx you are moving.</li>
            <li>It must be strictly shorter than your phalanx.</li>
            <li>The first piece of your phalanx should land on the first piece of the opponent's phalanx that you want to capture.</li>
        </ol><br/>
        You're playing Dark, capture a phalanx.`,new fn([[O,O,O,O,O,O,O,O,s1,s1,s1,s1,s1,s1],[O,O,O,O,O,O,s1,O,O,O,O,O,O,O],[O,O,O,O,O,s1,O,O,O,O,O,O,O,O],[O,O,s1,O,s1,O,O,O,O,O,O,O,O,O],[O,O,s1,s1,O,O,O,O,O,O,O,O,O,O],[O,O,s1,O,O,O,O,O,O,O,O,O,O,O],[O,O,O,O,O,O,O,O,O,O,O,O,O,O],[O,O,j1,O,O,O,O,O,O,O,O,O,O,O],[O,O,j1,O,O,O,O,s1,O,O,O,O,O,O],[O,O,j1,O,O,O,O,O,O,O,O,O,O,O],[O,O,j1,O,O,O,O,O,O,O,O,O,O,O],[O,O,O,O,O,O,O,j1,j1,j1,j1,j1,j1,j1]],0),[new Wo(2,10,4,2,Me.UP)],$localize`Congratulations, you made it!
        Note that the diagonal phalanx was not aligned with your phalanx, hence even if it is longer, this does not prevent you from capturing some of its pieces on another alignment.`,$localize`Failed, you have not captured the phalanx.`)])}}class vce extends Un{getListMoves(e){const t=e.gameState.getCurrentPlayer(),n=e.gameState.getCurrentOpponent(),i=K.NONE;let s=[];const o=e.gameState;for(const a of o.getCoordsAndContents()){const c=a.coord;if(a.content===t){let l;for(const f of Me.DIRECTIONS){let d=1,m=c.getNext(f,1);for(;fn.isOnBoard(m)&&o.getPieceAt(m)===t;)d+=1,m=m.getNext(f,1);let E=1;for(;fn.isOnBoard(m)&&E<=d&&o.getPieceAt(m)===i;)l=new Wo(c.x,c.y,d,E,f),s=this.addMove(s,l,o),E++,m=m.getNext(f,1);fn.isOnBoard(m)&&E<=d&&o.getPieceAt(m)===n&&(l=new Wo(c.x,c.y,d,E,f),s=this.addMove(s,l,o))}}}return s}addMove(e,t,n){return $i.isLegal(t,n).isSuccess()&&e.push(t),e}}class Cce extends wa{getBoardValue(e){return new Jn(this.getPieceCountPlusRowDomination(e.gameState))}getPieceCountPlusRowDomination(e){const t=13*fn.WIDTH*11;let o=0;for(let a=0;a<fn.HEIGHT;a++){let c=0;const l=[0,0];for(let f=0;f<fn.WIDTH;f++){const d=new C(f,a),m=e.getPieceAt(d);if(m.isPlayer()){const E=m.getScoreModifier();o+=t*E,l[m.value]=E,c+=E;for(const w of[Me.UP_LEFT,Me.UP,Me.UP_RIGHT]){let R=d.getNext(w,1);for(;fn.isOnBoard(R)&&e.getPieceAt(R)===m;)o+=1*E,R=R.getNext(w,1)}}}0!==c&&(o+=Math.abs(c)/c*2),o+=1*l.reduce((f,d)=>f+d)}return o}}class ndt extends Cce{constructor(...e){super(...e),u(this,"DOMINANCE_FACTOR",20),u(this,"DEFENSE_FACTOR",5),u(this,"TERRITORY_FACTOR",2),u(this,"OFFENSE_FACTOR",10),u(this,"CENTER_FACTOR",5),u(this,"MOBILITY_FACTOR",.12)}getBoardValue(e){const t=e.gameState,n=this.getDominance(t),i=this.getDefense(t),s=this.getTerritory(t),o=this.getCenter(t),a=this.getOffense(t),c=this.getMobility(t);return new Jn(n+i+s+o+a+c)}getDominance(e){let t=0;for(const n of e.getCoordsAndContents())n.content.isPlayer()&&(t+=n.content.getScoreModifier());return t*this.DOMINANCE_FACTOR}getDefense(e){let t=0;for(let n=0;n<fn.WIDTH;n++)e.getPieceAtXY(n,fn.HEIGHT-1)===k.ZERO&&(t+=k.ZERO.getScoreModifier()),e.getPieceAtXY(n,0)===k.ONE&&(t+=k.ONE.getScoreModifier());return t*this.DEFENSE_FACTOR}getTerritory(e){let t=0;for(const n of e.getCoordsAndContents()){const i=n.content;if(i.isPlayer()){for(let s=-1;s<=1;s++)for(let o=-1;o<=1;o++){const a=n.coord.getNext(new C(s,o),1);if(fn.isOnBoard(a)){const c=e.getPieceAt(a);(c===i||c===K.NONE)&&(t+=1*i.getScoreModifier())}}t-=i.getScoreModifier()}}return t*this.TERRITORY_FACTOR}getOffense(e){let t=0;for(let n=0;n<fn.WIDTH;n++)e.getPieceAtXY(n,0)===k.ZERO&&(t+=k.ZERO.getScoreModifier()),e.getPieceAtXY(n,fn.HEIGHT-1)===k.ONE&&(t+=k.ONE.getScoreModifier());return t*this.OFFENSE_FACTOR}getCenter(e){let t=0;const n=(fn.WIDTH-1)/2;for(const i of e.getCoordsAndContents()){const s=i.content;s.isPlayer()&&(t+=s.getScoreModifier()*Math.abs(i.coord.x-n))}return t*this.CENTER_FACTOR}getMobility(e){let t=0,n=0,i=0;for(const s of e.getCoordsAndContents()){const o=s.coord,a=s.content;if(a.isPlayer())for(const c of Me.DIRECTIONS){let l=1,f=o.getNext(c,1);for(;fn.isOnBoard(f)&&e.getPieceAt(f)===a;)l+=1,f=f.getNext(c,1);let d=1;for(;fn.isOnBoard(f)&&d<=l&&e.getPieceAt(f)===K.NONE;)d++,f=f.getNext(c,1);t+=d*d*a.getScoreModifier(),a===k.ZERO?n=Math.max(n,d):a===k.ONE&&(i=Math.max(i,d))}}return(t+n*k.ZERO.getScoreModifier()+i*k.ONE.getScoreModifier())*this.MOBILITY_FACTOR}}class HL extends vce{getListMoves(e){const t=super.getListMoves(e);return this.orderMovesByPhalanxSizeAndFilter(t,e.gameState)}orderMovesByPhalanxSizeAndFilter(e,t){return Ie.sortByDescending(e,n=>n.movedPieces),e.length>40?e.filter(i=>!!this.moveIsCapture(i,t)||i.movedPieces*Math.random()>1):e}moveIsCapture(e,t){const n=e.coord.getNext(e.direction,e.movedPieces+e.stepSize-1);return t.board[n.y][n.x]===t.getCurrentOpponent()}}class rdt extends on{constructor(){super($localize`Attack`,$i.get(),new ndt,new HL)}}class idt extends wa{getBoardValue(e){return new Jn(this.getPieceCountThenSupportThenAdvancement(e.gameState))}getPieceCountThenSupportThenAdvancement(e){const n=28*fn.WIDTH+1,s=444*n+1;let o=0;for(const a of e.getCoordsAndContents()){const c=a.coord,l=a.content;if(l.isPlayer()){let f,d;l===k.ZERO?(f=fn.HEIGHT-c.y,d=[Me.UP_LEFT,Me.UP,Me.UP_RIGHT]):(f=c.y+1,d=[Me.DOWN_LEFT,Me.DOWN,Me.DOWN_RIGHT]);const m=l.getScoreModifier();o+=f*m,o+=s*m;for(const E of d){let w=c.getNext(E,1);for(;fn.isOnBoard(w)&&e.getPieceAt(w)===l;)o+=m*n,w=w.getNext(E,1)}}}return o}}class sdt extends on{constructor(){super($localize`Positional`,$i.get(),new idt,new HL)}}class odt extends on{constructor(){super($localize`Minimax`,$i.get(),new Cce,new HL)}}function adt(r,e){if(1&r){const t=pe();N(),S(0,"circle",4),W("click",function(){te(t);const i=p().index,s=p().index;return ne(p().onClick(i,s))}),P()}if(2&r){const t=p().index,n=p().index,i=p();y("ngClass",i.getPieceClasses(t,n)),I("cx",i.SPACE_SIZE*t+i.STROKE_WIDTH+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*n+i.STROKE_WIDTH+i.SPACE_SIZE/2)("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)}}function cdt(r,e){if(1&r){const t=pe();N(),S(0,"g")(1,"rect",2),W("click",function(){const s=te(t).index,o=p().index;return ne(p().onClick(s,o))}),P(),T(2,adt,1,4,"circle",3),P()}if(2&r){const t=e.index,n=p().index,i=p();_(1),ye("id","click_",t,"_",n,""),y("ngClass",i.getRectClasses(t,n)),I("x",i.SPACE_SIZE*t+i.STROKE_WIDTH)("y",i.SPACE_SIZE*n+i.STROKE_WIDTH)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),_(1),y("ngIf",i.board[n][t]!==i.NONE)}}function ldt(r,e){if(1&r&&(N(),S(0,"g"),T(1,cdt,3,8,"g",1),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function udt(r,e){if(1&r){const t=pe();N(),S(0,"g")(1,"rect",5),W("click",function(){const s=te(t).$implicit;return ne(p().onClick(s.x,s.y))}),P()()}if(2&r){const t=e.$implicit,n=p();_(1),I("x",n.SPACE_SIZE*t.x+n.STROKE_WIDTH)("y",n.SPACE_SIZE*t.y+n.STROKE_WIDTH)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}let fdt=(()=>{var r;class e extends Fi{constructor(n){super(n),u(this,"NONE",K.NONE),u(this,"firstPiece",g.empty()),u(this,"validExtensions",[]),u(this,"phalanxValidLandings",[]),u(this,"lastPiece",g.empty()),u(this,"phalanxDirection",g.empty()),u(this,"phalanxMiddles",[]),u(this,"moveds",[]),u(this,"capturedCoords",[]),this.hasAsymmetricBoard=!0,this.rules=$i.get(),this.node=this.rules.getInitialNode(),this.availableAIs=[new odt,new sdt,new rdt,new Kn($localize`MCTS`,new vce,this.rules)],this.encoder=Wo.encoder,this.tutorial=(new _ce).tutorial}updateBoard(n){var i=this;return M(function*(){i.firstPiece=g.empty(),i.lastPiece=g.empty(),i.hideLastMove(),i.board=i.getState().getCopiedBoard()})()}showLastMove(n){var i=this;return M(function*(){let s=n.coord;i.moveds=[s];for(let c=1;c<n.stepSize+n.movedPieces;c++)s=s.getNext(n.direction,1),i.moveds.push(s);const o=i.node.parent.get(),a=o.gameState.getCurrentOpponent();for(;fn.isOnBoard(s)&&o.gameState.getPieceAt(s)===a;)i.capturedCoords.push(s),s=s.getNext(n.direction,1)})()}onClick(n,i){var s=this;return M(function*(){const o=yield s.canUserPlay("#click_"+n+"_"+i);return o.isFailure()?s.cancelMove(o.getReason()):s.firstPiece.isAbsent()?s.firstClick(n,i):s.lastPiece.isAbsent()?s.secondClick(n,i):s.thirdClick(n,i)})()}firstClick(n,i){var s=this;return M(function*(){const o=s.getState().getCurrentOpponent(),a=s.getState().getCurrentPlayer();switch(s.board[i][n]){case a:return s.firstPiece=g.of(new C(n,i)),s.validExtensions=s.getValidExtensions(a),s.phalanxValidLandings=s.getPhalanxValidLandings(),b.SUCCESS;case o:return s.cancelMove(Re.CANNOT_CHOOSE_OPPONENT_PIECE());default:return U.expectToBe(s.board[i][n],K.NONE),s.cancelMove(Re.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY())}})()}hideLastMove(){this.capturedCoords=[],this.moveds=[]}getValidExtensions(n){return this.lastPiece.isPresent()?this.getPhalanxValidExtensions(n):this.getFirstPieceExtensions(n)}getFirstPieceExtensions(n){const i=[];for(const s of Me.DIRECTIONS){let o=this.firstPiece.get().getNext(s,1);for(;fn.isOnBoard(o)&&this.board[o.y][o.x]===n;)i.push(o),o=o.getNext(s,1)}return i}getPhalanxValidExtensions(n){let i=Me.factory.fromMove(this.firstPiece.get(),this.lastPiece.get()).get();const s=this.lastPiece.get().getNext(i,1),o=this.getExtensionsToward(s,i,n);i=i.getOpposite();const a=this.firstPiece.get().getNext(i,1),c=this.getExtensionsToward(a,i,n);return o.concat(c)}getExtensionsToward(n,i,s){const o=[];for(;fn.isOnBoard(n)&&this.board[n.y][n.x]===s;)o.push(n),n=n.getNext(i,1);return o}getPhalanxValidLandings(){if(this.lastPiece.isPresent()){const n=this.firstPiece.get(),i=this.lastPiece.get(),s=Math.abs(n.x-i.x),o=Math.abs(n.y-i.y),a=Math.max(s,o)+1;let c=Me.factory.fromMove(n,i).get();const l=i.getNext(c,1),f=this.getLandingsToward(l,c,a);c=c.getOpposite();const d=n.getNext(c,1);return this.getLandingsToward(d,c,a).concat(f)}return this.getNeighboringEmptySpaces()}getNeighboringEmptySpaces(){const n=[];for(const i of Me.DIRECTIONS){const s=this.firstPiece.get().getNext(i,1);fn.isOnBoard(s)&&this.board[s.y][s.x]===K.NONE&&n.push(s)}return n}getLandingsToward(n,i,s){const o=this.getState().getCurrentPlayer(),a=this.getState().getCurrentOpponent(),c=[];for(;fn.isOnBoard(n)&&c.length<s&&this.board[n.y][n.x]!==o;){if(this.board[n.y][n.x]===a)return this.getPhalanxLength(n,i,a)<s&&c.push(n),c;c.push(n),n=n.getNext(i,1)}return c}getPhalanxLength(n,i,s){let o=0;for(;fn.isOnBoard(n)&&this.board[n.y][n.x]===s;)o++,n=n.getNext(i,1);return o}cancelMoveAttempt(){this.firstPiece=g.empty(),this.validExtensions=[],this.phalanxValidLandings=[],this.lastPiece=g.empty(),this.phalanxMiddles=[],this.hideLastMove()}secondClick(n,i){var s=this;return M(function*(){const o=new C(n,i),a=s.firstPiece.get();if(o.equals(a))return s.cancelMoveAttempt(),b.SUCCESS;const c=s.getState().getCurrentOpponent(),l=s.getState().getCurrentPlayer();if(!1===o.isAlignedWith(a))return s.cancelMove(qo.SQUARE_NOT_ALIGNED_WITH_SELECTED());const f=o.getDistance(a),d=a.getDirectionToward(o).get();switch(s.board[i][n]){case K.NONE:return 1===f?s.chooseMove(new Wo(a.x,a.y,1,1,d)):s.cancelMove(qo.SINGLE_PIECE_MUST_MOVE_BY_ONE());case c:return s.cancelMove(qo.SINGLE_PIECE_CANNOT_CAPTURE());default:U.expectToBe(s.board[i][n],l);const m=new Wo(a.x,a.y,f,1,d),E=s.getState(),w=$i.getPhalanxValidity(E,m);return w.isFailure()?s.cancelMove(w.getReason()):(s.lastPiece=g.of(o),s.validExtensions=s.getValidExtensions(l),s.phalanxValidLandings=s.getPhalanxValidLandings(),s.phalanxMiddles=a.getCoordsToward(o),s.phalanxDirection=g.of(d),b.SUCCESS)}})()}thirdClick(n,i){var s=this;return M(function*(){const o=s.getState().getCurrentPlayer(),a=new C(n,i);if(s.firstPiece.equalsValue(a))return s.moveFirstPiece(o);if(s.lastPiece.equalsValue(a))return s.moveLastPiece(o);const c=s.firstPiece.get(),l=s.lastPiece.get();if(!1===a.isAlignedWith(c))return s.cancelMove(qo.SQUARE_NOT_ALIGNED_WITH_PHALANX());let f=Me.factory.fromMove(c,l).get();const d=Me.factory.fromMove(c,a).get();if(f===d.getOpposite()&&(s.firstPiece=g.of(l),s.lastPiece=g.of(c),f=d),f!==d)return s.cancelMove(qo.SQUARE_NOT_ALIGNED_WITH_PHALANX());if(s.board[i][n]===o)return s.thirdClickOnPlayerPiece(a,f,o);{const m=s.firstPiece.get().getDistance(s.lastPiece.get())+1,E=s.lastPiece.get().getDistance(a),w=new Wo(s.firstPiece.get().x,s.firstPiece.get().y,m,E,f);return s.chooseMove(w)}})()}thirdClickOnPlayerPiece(n,i,s){var o=this;return M(function*(){o.lastPiece=g.of(n);const a=o.firstPiece.get().getDistance(n)+1,c=new Wo(o.firstPiece.get().x,o.firstPiece.get().y,a,1,i),l=$i.getPhalanxValidity(o.node.gameState,c);return l.isFailure()?o.cancelMove(l.getReason()):(o.phalanxMiddles=o.firstPiece.get().getCoordsToward(o.lastPiece.get()),o.validExtensions=o.getValidExtensions(s),o.phalanxValidLandings=o.getPhalanxValidLandings(),b.SUCCESS)})()}moveFirstPiece(n){var i=this;return M(function*(){return i.firstPiece=g.of(i.firstPiece.get().getNext(i.phalanxDirection.get(),1)),i.firstPiece.equals(i.lastPiece)?yield i.moveOnlyPiece(n):(i.phalanxMiddles=i.phalanxMiddles.slice(1),i.validExtensions=i.getPhalanxValidExtensions(n)),i.phalanxValidLandings=i.getPhalanxValidLandings(),b.SUCCESS})()}moveLastPiece(n){var i=this;return M(function*(){return i.lastPiece=g.of(i.lastPiece.get().getPrevious(i.phalanxDirection.get(),1)),i.firstPiece.equals(i.lastPiece)?i.moveOnlyPiece(n):(i.phalanxMiddles=i.firstPiece.get().getCoordsToward(i.lastPiece.get()),i.validExtensions=i.getPhalanxValidExtensions(n),i.phalanxValidLandings=i.getPhalanxValidLandings(),b.SUCCESS)})()}moveOnlyPiece(n){var i=this;return M(function*(){return i.lastPiece=g.empty(),i.validExtensions=i.getFirstPieceExtensions(n),i.phalanxDirection=g.empty(),i.phalanxMiddles=[],i.phalanxValidLandings=i.getPhalanxValidLandings(),b.SUCCESS})()}getPieceClasses(n,i){const s=this.getPlayerClass(this.board[i][n]);return this.getPieceStrokeClasses(n,i).concat([s])}getPieceStrokeClasses(n,i){const s=new C(n,i);return this.firstPiece.isAbsent()?[]:this.firstPiece.equalsValue(s)||this.lastPiece.equalsValue(s)||this.phalanxMiddles.some(o=>o.equals(s))?["selected-stroke"]:[]}getRectClasses(n,i){const s=new C(n,i);return this.capturedCoords.some(o=>o.equals(s))?["captured-fill"]:this.moveds.some(o=>o.equals(s))?["moved-fill"]:[]}getHighlightedCoords(){return this.firstPiece.isPresent()?this.phalanxValidLandings.concat(this.validExtensions):this.getCurrentPlayerPieces()}getCurrentPlayerPieces(){const n=[],s=this.getState().getCurrentPlayer();for(let o=0;o<this.board.length;o++)for(let a=0;a<this.board[o].length;a++)this.board[o][a]===s&&n.push(new C(a,o));return n}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(Ut))}),u(e,"\u0275cmp",qe({type:r,selectors:[["app-epaminondas"]],features:[Qe],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","0 0 1410 1210","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass","click",4,"ngIf"],[1,"base",3,"ngClass","click"],[1,"no-fill","mid-stroke","clickable-stroke",3,"click"]],template:function(n,i){1&n&&(N(),S(0,"svg",0),T(1,ldt,2,1,"g",1),T(2,udt,2,4,"g",1),P()),2&n&&(I("transform",i.rotation),_(1),y("ngForOf",i.board),_(1),y("ngForOf",i.getHighlightedCoords()))},dependencies:[Ft,Wt,At],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();var VL,yce,Mce;class G2{constructor(e){u(this,"capturedSpaces",void 0),U.assert(e.length>=4,"Cannot create a GipfCapture with less than 4 captured pieces"),U.assert(mo.areOnSameLine(e),"Cannot create a GipfCapture with pieces that are not on the same line"),this.capturedSpaces=Ie.copyImmutableArray(e).sort((n,i)=>n.x===i.x?(U.assert(n.y!==i.y,"Cannot create a GipfCapture with duplicate coords"),n.y>i.y?1:-1):n.x>i.x?1:-1);let t=g.empty();for(const n of this.capturedSpaces)U.assert(t.isAbsent()||1===t.get().getDistance(n),"Cannot create a GipfCapture with non-consecutive coords"),t=g.of(n)}toString(){let e="";for(const t of this.capturedSpaces)""!==e&&(e+=","),e+=t.toString();return e}size(){return this.capturedSpaces.length}forEach(e){this.capturedSpaces.forEach(e)}contains(e){for(let t=0;t<this.capturedSpaces.length;t++)if(this.capturedSpaces[t].equals(e))return!0;return!1}intersectsWith(e){return this.capturedSpaces.some(t=>e.contains(t))}getLine(){return mo.fromTwoCoords(this.capturedSpaces[0],this.capturedSpaces[1]).get()}equals(e){if(this===e)return!0;if(this.capturedSpaces.length!==e.capturedSpaces.length)return!1;for(let t=0;t<this.capturedSpaces.length;t++)if(!1===this.capturedSpaces[t].equals(e.capturedSpaces[t]))return!1;return!0}}VL=G2,u(G2,"encoder",we.tuple([we.list(C.encoder)],r=>[r.capturedSpaces],r=>new VL(r[0]))),u(G2,"listEncoder",we.list(VL.encoder));class fC{static getPossibleCaptureCombinationsFromPossibleCaptures(e){const t=fC.computeIntersections(e);let n=[[]];return e.forEach((i,s)=>{if(0===t[s].length)n.forEach(o=>{o.push(s)});else{const o=[],a=t[s].some(c=>c>s);for(const c of n)!0===c.some(f=>t[s].some(d=>f===d))?o.push(Ie.copyImmutableArray(c)):a?(o.push(Ie.copyImmutableArray(c)),c.push(s),o.push(Ie.copyImmutableArray(c))):(c.push(s),o.push(Ie.copyImmutableArray(c)));n=o}}),n.map(i=>i.map(s=>e[s]))}static computeIntersections(e){const t=[];return e.forEach((n,i)=>{t.push([]),e.forEach((s,o)=>{i!==o&&n.intersectsWith(s)&&t[i].push(o)})}),t}}class jo{constructor(e,t){u(this,"coord",void 0),u(this,"direction",void 0),this.coord=e,this.direction=t}toString(){return this.direction.isPresent()?this.coord.toString()+"@"+this.direction.get().toString():this.coord.toString()}equals(e){return!1!==this.coord.equals(e.coord)&&this.direction.equals(e.direction)}}yce=jo,u(jo,"encoder",we.tuple([C.encoder,g.getEncoder(be.encoder)],r=>[r.coord,r.direction],r=>new yce(r[0],r[1])));class Ra extends Di{constructor(e,t,n){super(),u(this,"placement",void 0),u(this,"initialCaptures",void 0),u(this,"finalCaptures",void 0),this.placement=e,this.initialCaptures=t,this.finalCaptures=n}toString(){return"GipfMove(["+this.capturesToString(this.initialCaptures)+"], "+this.placement.toString()+", ["+this.capturesToString(this.finalCaptures)+"])"}capturesToString(e){let t="";for(const n of e)""!==t&&(t+=","),t+="["+n.toString()+"]";return t}equals(e){return this===e||!(!1===this.placement.equals(e.placement)||!1===Ie.compareArray(this.initialCaptures,e.initialCaptures)||!1===Ie.compareArray(this.finalCaptures,e.finalCaptures))}}Mce=Ra,u(Ra,"encoder",we.tuple([jo.encoder,G2.listEncoder,G2.listEncoder],r=>[r.placement,r.initialCaptures,r.finalCaptures],r=>new Mce(r[0],r[1],r[2])));class Zo extends RL{static getInitialState(){const e=Ce.EMPTY,t=Ce.UNREACHABLE,n=Ce.ZERO,i=Ce.ONE;return new Zo([[t,t,t,i,e,e,n],[t,t,e,e,e,e,e],[t,e,e,e,e,e,e],[n,e,e,e,e,e,i],[e,e,e,e,e,e,t],[e,e,e,e,e,t,t],[i,e,e,n,t,t,t]],0,[12,12],[0,0])}constructor(e,t,n,i){super(t,e,7,7,[3,2,1],Ce.EMPTY),u(this,"sidePieces",void 0),u(this,"capturedPieces",void 0),this.sidePieces=n,this.capturedPieces=i}equals(e){return this.turn===e.turn&&this.sidePieces[0]===e.sidePieces[0]&&this.sidePieces[1]===e.sidePieces[1]&&this.capturedPieces[0]===e.capturedPieces[0]&&this.capturedPieces[1]===e.capturedPieces[1]&&Ie.compareTable(this.board,e.board)}getNumberOfPiecesToPlace(e){return this.sidePieces[e.value]}getNumberOfPiecesCaptured(e){return this.capturedPieces[e.value]}setAtUnsafe(e,t){const n=Ie.copyBiArray(this.board);return n[e.y][e.x]=t,new Zo(n,this.turn,this.sidePieces,this.capturedPieces)}isOnBoard(e){return!e.isNotInRange(this.width,this.height)&&this.board[e.y][e.x]!==Ce.UNREACHABLE}}let Yo=(()=>{class r{}return u(r,"CAPTURE_MUST_BE_ALIGNED",()=>$localize`You can only capture when 4 or more of your pieces are aligned, and it is not the case.`),u(r,"INVALID_CAPTURED_PIECES",()=>$localize`You must select a valid capture that contains 4 pieces or more.`),u(r,"MISSING_CAPTURES",()=>$localize`There are still possible captures to be done.`),u(r,"PLACEMENT_NOT_ON_BORDER",()=>$localize`Pieces must be inserted in spaces on the edge of the board.`),u(r,"INVALID_PLACEMENT_DIRECTION",()=>$localize`You must select a valid placement direction.`),u(r,"PLACEMENT_WITHOUT_DIRECTION",()=>$localize`You must select a placement with a direction alongside the insertion space.`),u(r,"PLACEMENT_ON_COMPLETE_LINE",()=>$localize`You cannot place a piece on a complete line.`),u(r,"AMBIGUOUS_CAPTURE_COORD",()=>$localize`This piece belongs to two captures. Please select another piece in the capture you'd like to make.`),u(r,"NO_DIRECTIONS_AVAILABLE",()=>$localize`You cannot insert a piece here, as all lines are full. Select another space.`),r})();class Qt extends Yn{static get(){return Qt.singleton.isAbsent()&&(Qt.singleton=g.of(new Qt)),Qt.singleton.get()}constructor(){super(Zo)}applyLegalMove(e,t,n){return new Zo(n.board,n.turn+1,n.sidePieces,n.capturedPieces)}static applyCaptures(e,t){let n=t;return e.forEach(i=>{n=Qt.applyCapture(i,n)}),n}static applyCapture(e,t){const n=t.getCurrentPlayer();let i=t;const s=[t.sidePieces[0],t.sidePieces[1]],o=[t.capturedPieces[0],t.capturedPieces[1]];return e.forEach(a=>{const c=t.getPieceAt(a);i=i.setAt(a,Ce.EMPTY),c.is(n)?s[n.value]+=1:o[n.value]+=1}),new Zo(i.board,t.turn,s,o)}static getPlacements(e){const t=[];return Br.INSTANCE.getAllBorders(e).forEach(n=>{e.getPieceAt(n)===Ce.EMPTY?t.push(new jo(n,g.empty())):Qt.getAllDirectionsForEntrance(e,n).forEach(i=>{!1===Qt.isLineComplete(e,n,i)&&t.push(new jo(n,g.of(i)))})}),t}static isLineComplete(e,t,n){return Qt.nextGapInLine(e,t,n).isAbsent()}static nextGapInLine(e,t,n){for(let i=t;e.isOnBoard(i);i=i.getNext(n))if(e.getPieceAt(i)===Ce.EMPTY)return g.of(i);return g.empty()}static applyPlacement(e,t){const n=t.getCurrentPlayer();let i=t,s=Ce.ofPlayer(t.getCurrentPlayer());if(e.direction.isAbsent()){const a=e.coord;if(t.getPieceAt(a)!==Ce.EMPTY)throw new Error("Apply placement called without direction while the coord is occupied");i=i.setAt(a,s)}else for(let a=e.coord;i.isOnBoard(a)&&s!==Ce.EMPTY;a=a.getNext(e.direction.get())){const c=t.getPieceAt(a);i=i.setAt(a,s),s=c}const o=[t.sidePieces[0],t.sidePieces[1]];return o[n.value]-=1,new Zo(i.board,t.turn,o,t.capturedPieces)}getPiecesMoved(e,t,n){const i=Qt.applyCaptures(t,e);if(n.direction.isAbsent())return[n.coord];{const s=n.direction.get(),o=[];o.push(n.coord);let a=n.coord.getNext(s);for(;i.isOnBoard(a)&&i.getPieceAt(a)!==Ce.EMPTY;)o.push(a),a=a.getNext(s);return Ze(i.isOnBoard(a)&&i.getPieceAt(a)===Ce.EMPTY,"getPiecesMoved called with an invalid placement performed on a full line"),o.push(a),o}}static getAllDirectionsForEntrance(e,t){if(Br.INSTANCE.isTopLeftCorner(e,t))return[be.RIGHT,be.DOWN,be.UP_RIGHT];if(Br.INSTANCE.isTopCorner(e,t))return[be.DOWN,be.DOWN_LEFT,be.RIGHT];if(Br.INSTANCE.isTopRightCorner(e,t))return[be.DOWN_LEFT,be.DOWN,be.LEFT];if(Br.INSTANCE.isBottomLeftCorner(e,t))return[be.UP_RIGHT,be.UP,be.RIGHT];if(Br.INSTANCE.isBottomCorner(e,t))return[be.UP,be.LEFT,be.UP_RIGHT];if(Br.INSTANCE.isBottomRightCorner(e,t))return[be.LEFT,be.UP,be.DOWN_LEFT];if(Br.INSTANCE.isOnTopLeftBorder(e,t))return[be.RIGHT,be.DOWN];if(Br.INSTANCE.isOnLeftBorder(e,t))return[be.UP_RIGHT,be.RIGHT];if(Br.INSTANCE.isOnBottomLeftBorder(e,t))return[be.UP,be.UP_RIGHT];if(Br.INSTANCE.isOnBottomRightBorder(e,t))return[be.LEFT,be.UP];if(Br.INSTANCE.isOnRightBorder(e,t))return[be.LEFT,be.DOWN_LEFT];if(Br.INSTANCE.isOnTopRightBorder(e,t))return[be.DOWN_LEFT,be.DOWN];throw new Error("not a border")}isLegal(e,t){const n=this.capturesValidity(t,e.initialCaptures);if(n.isFailure())return n.toOtherFallible();const i=Qt.applyCaptures(e.initialCaptures,t),s=this.noMoreCapturesValidity(i);if(s.isFailure())return s.toOtherFallible();const o=this.placementValidity(i,e.placement);if(o.isFailure())return o.toOtherFallible();const a=Qt.applyPlacement(e.placement,i),c=this.capturesValidity(a,e.finalCaptures);if(c.isFailure())return c.toOtherFallible();const l=Qt.applyCaptures(e.finalCaptures,a),f=this.noMoreCapturesValidity(l);return f.isFailure()?f.toOtherFallible():ie.success(l)}capturesValidity(e,t){let n=e;for(const i of t){const s=this.captureValidity(n,i);if(s.isFailure())return s;n=Qt.applyCapture(i,n)}return b.SUCCESS}captureValidity(e,t){const n=e.getCurrentPlayer(),i=Qt.getLinePortionWithFourPiecesOfPlayer(e,n,t.getLine());if(i.isAbsent())return b.failure(Yo.CAPTURE_MUST_BE_ALIGNED());const s=i.get();return Qt.getCapturable(e,s).equals(t)?b.SUCCESS:b.failure(Yo.INVALID_CAPTURED_PIECES())}static getLinePortionsWithFourPiecesOfPlayer(e,t){const n=[];return e.allLines().forEach(i=>{const s=Qt.getLinePortionWithFourPiecesOfPlayer(e,t,i);s.isPresent()&&n.push(s.get())}),n}static getLinePortionWithFourPiecesOfPlayer(e,t,n){let i=0;const s=e.getEntranceOnLine(n),o=n.getDirection();let a=s;for(let c=s;e.isOnBoard(c);c=c.getNext(o))if(e.getPieceAt(c).is(t)?(0===i&&(a=c),i+=1):i=0,4===i)return g.of({0:a,1:c,2:o});return g.empty()}noMoreCapturesValidity(e){const t=e.getCurrentPlayer();return 0===Qt.getLinePortionsWithFourPiecesOfPlayer(e,t).length?b.SUCCESS:b.failure(Yo.MISSING_CAPTURES())}placementValidity(e,t){const n=this.placementCoordValidity(e,t.coord);if(n.isFailure())return n;if(e.getPieceAt(t.coord)!==Ce.EMPTY){if(t.direction.isAbsent())return b.failure(Yo.PLACEMENT_WITHOUT_DIRECTION());if(Qt.isLineComplete(e,t.coord,t.direction.get()))return b.failure(Yo.PLACEMENT_ON_COMPLETE_LINE());for(const i of Qt.getAllDirectionsForEntrance(e,t.coord))if(i===t.direction.get())return b.SUCCESS;return b.failure(Yo.INVALID_PLACEMENT_DIRECTION())}return b.SUCCESS}placementCoordValidity(e,t){return Br.INSTANCE.isOnBorder(e,t)?b.SUCCESS:b.failure(Yo.PLACEMENT_NOT_ON_BORDER())}static getCapturable(e,t){const n=[],i=t[0],s=t[1],o=t[2],a=o.getOpposite();let c=i.getNext(a);for(;e.isOnBoard(c)&&e.getPieceAt(c)!==Ce.EMPTY;)n.push(c),c=c.getNext(a);for(let l=i;!1===l.equals(s);l=l.getNext(o))n.push(l);for(let l=s;e.isOnBoard(l)&&e.getPieceAt(l)!==Ce.EMPTY;l=l.getNext(o))n.push(l);return new G2(n)}static getPossibleCaptures(e){const t=e.getCurrentPlayer(),n=[];return Qt.getLinePortionsWithFourPiecesOfPlayer(e,t).forEach(i=>{n.push(Qt.getCapturable(e,i))}),n}static getPlayerScore(e,t){const n=e.getNumberOfPiecesToPlace(t);if(0===n&&0===Qt.getPossibleCaptures(e).length)return g.empty();const i=e.getNumberOfPiecesCaptured(t);return g.of(n+3*i)}static isGameOver(e){const t=Qt.getPlayerScore(e,k.ZERO),n=Qt.getPlayerScore(e,k.ONE);return t.isAbsent()||n.isAbsent()}getGameStatus(e){const t=e.gameState,n=Qt.getPlayerScore(t,k.ZERO),i=Qt.getPlayerScore(t,k.ONE);return n.isAbsent()?_e.ONE_WON:i.isAbsent()?_e.ZERO_WON:_e.ONGOING}}u(Qt,"singleton",g.empty());class Ece{constructor(e,t,n,i,s,o){u(this,"source",void 0),u(this,"destination",void 0),u(this,"x1",void 0),u(this,"y1",void 0),u(this,"x2",void 0),u(this,"y2",void 0),this.source=e,this.destination=t,this.x1=n,this.y1=i,this.x2=s,this.y2=o}}const Tn=Ce.UNREACHABLE,Xe=Ce.EMPTY,Z1=Ce.ZERO,Vc=Ce.ONE;class Sce extends Zn{constructor(...e){super(...e),u(this,"tutorial",[q.informational($localize`Goal of the game`,$localize`The goal of Gipf is to capture the opponent's piece so that the opponent can no longer play.
        This is the initial board.
        Each player has 12 pieces on the side and 3 pieces on the board.
        When, at its turn, a player has no more pieces on the side, that player cannot play anymore and loses the game.
        The first player plays with the dark pieces, the second player plays with the light pieces.`,Zo.getInitialState()),q.anyMove($localize`Pushing`,$localize`Pieces can only enter the board through the edges. To insert a new piece:
        <ol>
            <li>Click on a space on the edge of the board.</li>
            <li>If that space was already occupied, click on the arrow that indicates the direction in which you want to push the piece(s) already on the corresponding line.</li>
        </ol>
        You cannot push when a line is full.<br/><br/>
        You're playing Dark, insert a piece.`,Zo.getInitialState(),new Ra(new jo(new C(3,0),g.of(be.DOWN)),[],[]),$localize`Congratulations!`),q.fromMove($localize`Capture (1/3)`,$localize`To capture, you must align 4 of your own pieces, which will be the first 4 captured pieces.
        There are multiple important aspects of a capture:
        <ol>
            <li>When 4 pieces are captured, all pieces that are directly aligned with these 4 pieces are also captured.</li>
            <li>As soon as there is an empty space on the line, the capture stops.</li>
            <li>Your own pieces that are captured go back to your stock.
                Your opponent's pieces however are really captured and do not go back to your opponent's stock.</li>
            <li>If you create a line of 4 of your opponent's pieces, it will be at the beginning of your opponent's turn that your opponent can capture them.
                This means that a turn happens in three phases:
                <ol type="A">
                    <li>Pick the capture(s) resulting from the last move of your opponent (by clicking on it).</li>
                    <li>Make your insertion.</li>
                    <li>Pick the capture(s) resulting from your move (by clicking on it).</li>
                </ol>
            </li>
        </ol><br/>
        You're playing Dark, you can make a capture, do it.`,new Zo([[Tn,Tn,Tn,Z1,Vc,Xe,Xe],[Tn,Tn,Xe,Xe,Xe,Xe,Xe],[Tn,Xe,Xe,Xe,Xe,Xe,Xe],[Z1,Z1,Z1,Xe,Xe,Xe,Xe],[Vc,Xe,Xe,Xe,Xe,Xe,Tn],[Xe,Xe,Xe,Vc,Xe,Tn,Tn],[Xe,Xe,Xe,Vc,Tn,Tn,Tn]],42,[8,8],[0,0]),[new Ra(new jo(new C(0,3),g.of(be.RIGHT)),[],[new G2([new C(0,3),new C(1,3),new C(2,3),new C(3,3)])])],$localize`Congratulations, you have gotten 4 of your pieces back. This is not the most useful capture.
        Let's now see how captures can really be useful.`,$localize`Failed. Try again.`),q.fromMove($localize`Capture (2/3)`,$localize`Here, there are three different ways for Dark to capture.
        <ol>
          <li>One way does not capture any of your opponent's pieces.</li>
          <li>Another way captures one of your opponent's pieces.</li>
          <li>The last way captures two of your opponent's pieces.</li>
        </ol>
        <br/>
        You're playing Dark, capture the most pieces from your opponent.`,new Zo([[Tn,Tn,Tn,Xe,Xe,Xe,Xe],[Tn,Tn,Xe,Vc,Xe,Xe,Xe],[Tn,Xe,Xe,Z1,Xe,Xe,Xe],[Z1,Z1,Z1,Vc,Xe,Xe,Xe],[Xe,Xe,Xe,Z1,Xe,Xe,Tn],[Xe,Xe,Xe,Z1,Xe,Tn,Tn],[Xe,Xe,Xe,Vc,Tn,Tn,Tn]],42,[8,4],[2,3]),[new Ra(new jo(new C(0,3),g.of(be.RIGHT)),[],[new G2([new C(3,1),new C(3,2),new C(3,3),new C(3,4),new C(3,5),new C(3,6)])])],$localize`Congratulations, you have gotten back 4 of your pieces and captured 2 of the opponent's.
        The most you can get is 3 per capture.`,$localize`Failed, the best capture was taking 2 of your opponent's pieces`),q.fromMove($localize`Capture (3/3)`,$localize`Here, you must capture at the beginning of your turn.
        This is due to a move of your opponent at the previous turn
        (even though this is a fictitious board for pedagogical purpose).
        After your capture, by performing the right move you can even capture two more of your opponent's pieces!
        Keep it mind that the most useful in a capture is to take your opponent's pieces.<br/><br/>
        You're playing Dark, capture the most pieces from your opponent.`,new Zo([[Tn,Tn,Tn,Z1,Xe,Xe,Z1],[Tn,Tn,Xe,Z1,Xe,Xe,Z1],[Tn,Z1,Z1,Xe,Z1,Vc,Z1],[Xe,Xe,Xe,Z1,Xe,Xe,Z1],[Xe,Xe,Xe,Z1,Xe,Xe,Tn],[Z1,Z1,Z1,Vc,Vc,Tn,Tn],[Xe,Xe,Xe,Z1,Tn,Tn,Tn]],42,[3,4],[2,3]),[new Ra(new jo(new C(3,6),g.of(be.UP)),[new G2([new C(6,0),new C(6,1),new C(6,2),new C(6,3)])],[new G2([new C(0,5),new C(1,5),new C(2,5),new C(3,5),new C(4,5)]),new G2([new C(1,2),new C(2,2),new C(3,2),new C(4,2),new C(5,2)])]),new Ra(new jo(new C(4,6),g.of(be.UP)),[new G2([new C(6,0),new C(6,1),new C(6,2),new C(6,3)])],[new G2([new C(0,5),new C(1,5),new C(2,5),new C(3,5),new C(4,5)]),new G2([new C(3,0),new C(3,1),new C(3,2),new C(3,3),new C(3,4)])]),new Ra(new jo(new C(3,6),g.of(be.UP)),[new G2([new C(6,0),new C(6,1),new C(6,2),new C(6,3)])],[new G2([new C(1,2),new C(2,2),new C(3,2),new C(4,2),new C(5,2)]),new G2([new C(0,5),new C(1,5),new C(2,5),new C(3,5),new C(4,5)])])],$localize`Congratulations, you have gotten 12 of your pieces back and captured 2 of your opponent's pieces.`,$localize`Failed, the best capture takes 2 of your opponent's pieces.`)])}}class Pce extends Un{getListMoves(e){const t=e.gameState,n=[];return Qt.isGameOver(t)||this.getPossibleCaptureCombinations(t).forEach(i=>{const s=Qt.applyCaptures(i,t);Qt.getPlacements(s).forEach(o=>{const a=Qt.applyPlacement(o,s);this.getPossibleCaptureCombinations(a).forEach(c=>{const l=new Ra(o,i,c);n.push(l)})})}),n}getPossibleCaptureCombinations(e){const t=Qt.getPossibleCaptures(e);return fC.getPossibleCaptureCombinationsFromPossibleCaptures(t)}}class ddt extends fr{getMetrics(e){const t=e.gameState;return[Qt.getPlayerScore(t,k.ZERO).get(),Qt.getPlayerScore(t,k.ONE).get()]}}function hdt(r,e){if(1&r&&(N(),F(0,"circle",13)),2&r){const t=p().$implicit,n=p();y("ngClass",n.getPieceClass(t)),I("cx",n.getCenterAt(t).x)("cy",n.getCenterAt(t).y)("r",n.SPACE_SIZE)}}function pdt(r,e){if(1&r){const t=pe();N(),S(0,"g",10),W("click",function(){const s=te(t).$implicit;return ne(p().onClick(s))}),F(1,"polygon",11),T(2,hdt,1,4,"circle",12),P()}if(2&r){const t=e.$implicit,n=p();ye("id","click_",t.x,"_",t.y,""),_(1),ye("id","space_",t.x,"_",t.y,""),y("ngClass",n.getSpaceClass(t)),I("points",n.getHexaPointsAt(t)),_(1),y("ngIf",n.isPiece(t))}}function gdt(r,e){if(1&r){const t=pe();N(),S(0,"polygon",16),W("click",function(){const s=te(t).$implicit;return ne(p(2).onClick(s))}),P()}if(2&r){const t=e.$implicit;I("points",p(2).getHexaPointsAt(t))}}function mdt(r,e){if(1&r&&(N(),S(0,"g",14),T(1,gdt,1,1,"polygon",15),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t.capturedSpaces)}}function _dt(r,e){if(1&r){const t=pe();N(),S(0,"line",17),W("click",function(){const s=te(t).$implicit;return ne(p().onClick(s.destination))}),P()}if(2&r){const t=e.$implicit;I("x1",t.x1)("y1",t.y1)("x2",t.x2)("y2",t.y2)}}function vdt(r,e){if(1&r&&(N(),S(0,"g"),F(1,"circle",18),P()),2&r){const t=e.$implicit,n=p().$implicit,i=p();_(1),ye("id","piece_",n.value,"_",t,""),y("ngClass",i.getPlayerClass(n)),I("cx",i.getRemainingPieceCx(n,t))("cy",i.getRemainingPieceCy(n))("r",.5*i.SPACE_SIZE)}}function Cdt(r,e){if(1&r&&(N(),S(0,"g"),T(1,vdt,2,6,"g",8),P()),2&r){const t=e.$implicit,n=p();_(1),y("ngForOf",n.getPlayerSidePieces(t))}}function ydt(r,e){if(1&r&&(N(),F(0,"line",19)),2&r){const t=p();I("x1",t.inserted.get().x1)("y1",t.inserted.get().y1)("x2",t.inserted.get().x2)("y2",t.inserted.get().y2)}}let Mdt=(()=>{var r;class e extends au{constructor(n){super(n),u(this,"inserted",g.empty()),u(this,"arrows",[]),u(this,"captured",[]),u(this,"moved",[]),u(this,"hexagonWidth",this.SPACE_SIZE),u(this,"sharedHexagonX",Math.cos(30)*this.hexagonWidth*.5),u(this,"boardWidth",this.hexagonWidth+6*(this.hexagonWidth-this.sharedHexagonX)+3*this.STROKE_WIDTH/2),u(this,"boardHeight",7*this.hexagonWidth+4.5*this.STROKE_WIDTH),u(this,"movePhase",e.PHASE_PLACEMENT_COORD),u(this,"constructedState",void 0),u(this,"possibleCaptures",[]),u(this,"initialCaptures",[]),u(this,"placement",g.empty()),u(this,"placementEntrance",g.empty()),u(this,"finalCaptures",[]),this.hasAsymmetricBoard=!0,this.scores=g.of([0,0]),this.rules=Qt.get(),this.node=this.rules.getInitialNode(),this.availableAIs=[new on($localize`Score`,this.rules,new ddt,new Pce),new Kn($localize`MCTS`,new Pce,this.rules)],this.encoder=Ra.encoder,this.tutorial=(new Sce).tutorial,this.SPACE_SIZE=40,this.constructedState=this.getState(),this.hexaLayout=new cu(1.5*this.SPACE_SIZE,new C(this.hexagonWidth/2+3*this.STROKE_WIDTH/4,-this.hexagonWidth),Br.INSTANCE)}updateBoard(n){var i=this;return M(function*(){i.cancelMoveAttempt()})()}showLastMove(n){var i=this;return M(function*(){if(i.inserted=g.empty(),n.placement.direction.isPresent()){const s=n.placement;i.inserted=g.of(i.arrowTowards(s.coord,s.direction.get()))}i.cancelMoveAttempt()})()}arrowTowards(n,i){const s=n.getNext(i.getOpposite()),o=this.getCenterAt(n),a=this.getCenterAt(s);return new Ece(s,n,a.x,a.y,o.x,o.y)}markCapture(n){n.forEach(i=>{this.captured.push(i)})}getAllCoords(){return this.constructedState.allCoords()}getPlayerSidePieces(n){const i=this.constructedState.getNumberOfPiecesToPlace(n),s=[];for(let o=0;o<i;o+=1)s.push(o);return s}isPiece(n){return this.getPiece(n)!==Ce.EMPTY}getPiece(n){return this.constructedState.getPieceAt(n)}onClick(n){var i=this;return M(function*(){const s=yield i.canUserPlay("#click_"+n.x+"_"+n.y);if(s.isFailure())return i.cancelMove(s.getReason());switch(i.movePhase){case e.PHASE_INITIAL_CAPTURE:case e.PHASE_FINAL_CAPTURE:return i.selectCapture(n);case e.PHASE_PLACEMENT_COORD:return i.selectPlacementCoord(n);default:return U.expectToBe(i.movePhase,e.PHASE_PLACEMENT_DIRECTION),i.selectPlacementDirectionOrPlacementCoord(n)}})()}selectCapture(n){var i=this;return M(function*(){const s=[];if(i.possibleCaptures.forEach(a=>{a.contains(n)&&s.push(a)}),s.length>1)return i.cancelMove(Yo.AMBIGUOUS_CAPTURE_COORD());if(0===s.length)return i.cancelMove(Yo.MISSING_CAPTURES());const o=s[0];return i.constructedState=Qt.applyCapture(o,i.constructedState),i.markCapture(o),i.possibleCaptures=Qt.getPossibleCaptures(i.constructedState),i.movePhase===e.PHASE_INITIAL_CAPTURE?(i.initialCaptures.push(o),0===i.possibleCaptures.length?i.moveToPlacementPhase():b.SUCCESS):(U.expectToBe(i.movePhase,e.PHASE_FINAL_CAPTURE),i.finalCaptures.push(o),0===i.possibleCaptures.length?i.tryMove(i.initialCaptures,i.placement.get(),i.finalCaptures):b.SUCCESS)})()}moveToPlacementPhase(){return this.movePhase=e.PHASE_PLACEMENT_COORD,b.SUCCESS}moveToInitialCaptureOrPlacementPhase(){return this.possibleCaptures=Qt.getPossibleCaptures(this.constructedState),this.movePhase=0===this.possibleCaptures.length?e.PHASE_PLACEMENT_COORD:e.PHASE_INITIAL_CAPTURE,b.SUCCESS}moveToFinalCapturePhaseOrTryMove(){var n=this;return M(function*(){return n.possibleCaptures=Qt.getPossibleCaptures(n.constructedState),0===n.possibleCaptures.length?n.tryMove(n.initialCaptures,n.placement.get(),n.finalCaptures):(n.movePhase=e.PHASE_FINAL_CAPTURE,b.SUCCESS)})()}computeArrows(n){this.arrows=[];for(const i of Qt.getAllDirectionsForEntrance(this.constructedState,n))if(!1===Qt.isLineComplete(this.constructedState,n,i)){const s=n.getNext(i),o=this.getCenterAt(n),a=this.getCenterAt(s);this.arrows.push(new Ece(n,s,o.x,o.y,a.x,a.y))}}selectPlacementCoord(n){var i=this;return M(function*(){const s=i.rules.placementCoordValidity(i.constructedState,n);return s.isFailure()?i.cancelMove(s.getReason()):i.placementEntrance.equalsValue(n)?(i.cancelMoveAttempt(),b.SUCCESS):(i.placementEntrance=g.of(n),i.constructedState.getPieceAt(n)===Ce.EMPTY?i.selectPlacementDirection(g.empty()):(i.movePhase=e.PHASE_PLACEMENT_DIRECTION,i.computeArrows(n),0===i.arrows.length&&(yield i.cancelMove(Yo.NO_DIRECTIONS_AVAILABLE())),b.SUCCESS))})()}selectPlacementDirection(n){var i=this;return M(function*(){i.placement=g.of(new jo(i.placementEntrance.get(),n));const s=i.rules.placementValidity(i.constructedState,i.placement.get());return s.isFailure()?i.cancelMove(s.getReason()):(i.arrows=[],i.constructedState=Qt.applyPlacement(i.placement.get(),i.constructedState),i.moveToFinalCapturePhaseOrTryMove())})()}selectPlacementDirectionOrPlacementCoord(n){var i=this;return M(function*(){const s=i.placementEntrance.get();if(!1===s.isAlignedWith(n)||1!==s.getDistance(n))return i.selectPlacementCoord(n);const o=be.factory.fromMove(s,n);return i.selectPlacementDirection(o.toOptional())})()}tryMove(n,i,s){const o=new Ra(i,n,s);return this.chooseMove(o)}cancelMoveAttempt(){this.constructedState=this.getState(),this.captured=[],this.moved=[];const n=this.node.previousMove;if(n.isPresent()){const i=n.get(),s=this.getPreviousState();i.initialCaptures.forEach(o=>this.markCapture(o)),i.finalCaptures.forEach(o=>this.markCapture(o)),this.moved=this.rules.getPiecesMoved(s,i.initialCaptures,i.placement)}this.initialCaptures=[],this.finalCaptures=[],this.placementEntrance=g.empty(),this.placement=g.empty(),this.arrows=[],this.moveToInitialCaptureOrPlacementPhase()}getSpaceClass(n){return this.captured.some(i=>i.equals(n))?"captured-fill":this.moved.some(i=>i.equals(n))?"moved-fill":""}getPieceClass(n){const i=this.getPiece(n);return this.getPlayerClass(k.of(i.value))}getRemainingPieceCy(n){return n===k.ONE?25:this.boardHeight-25}getRemainingPieceCx(n,i){const s=20+i*this.SPACE_SIZE*.5;return n===k.ONE?s:this.boardWidth-(15+s)}}return r=e,u(e,"PHASE_INITIAL_CAPTURE",0),u(e,"PHASE_PLACEMENT_COORD",1),u(e,"PHASE_PLACEMENT_DIRECTION",2),u(e,"PHASE_FINAL_CAPTURE",3),u(e,"\u0275fac",function(n){return new(n||r)(B(Ut))}),u(e,"\u0275cmp",qe({type:r,selectors:[["app-gipf"]],features:[Qe],decls:11,vars:7,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["id","arrowhead","markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto"],["points","0 0, 10 3.5, 0 7"],["id","arrowhead-moved","markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto"],["points","0 0, 10 3.5, 0 7",1,"moved-fill","moved-stroke"],[3,"id","click",4,"ngFor","ngForOf"],["pointer-events","fill","class","capturable-stroke",4,"ngFor","ngForOf"],["class","arrow","marker-end","url(#arrowhead)",3,"click",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],["class","arrow moved-stroke","marker-end","url(#arrowhead-moved)",4,"ngIf"],[3,"id","click"],["stroke-linecap","round",1,"base",3,"id","ngClass"],["class","base",3,"ngClass",4,"ngIf"],[1,"base",3,"ngClass"],["pointer-events","fill",1,"capturable-stroke"],["class","no-fill","stroke-linecap","round",3,"click",4,"ngFor","ngForOf"],["stroke-linecap","round",1,"no-fill",3,"click"],["marker-end","url(#arrowhead)",1,"arrow",3,"click"],[1,"base","small-stroke",3,"id","ngClass"],["marker-end","url(#arrowhead-moved)",1,"arrow","moved-stroke"]],template:function(n,i){1&n&&(N(),S(0,"svg",0)(1,"defs")(2,"marker",1),F(3,"polygon",2),P(),S(4,"marker",3),F(5,"polygon",4),P()(),T(6,pdt,3,7,"g",5),T(7,mdt,2,1,"g",6),T(8,_dt,1,4,"line",7),T(9,Cdt,2,1,"g",8),T(10,ydt,1,4,"line",9),P()),2&n&&(I("viewBox",-i.STROKE_WIDTH+" 0 "+i.boardWidth+" "+i.boardHeight)("transform",i.rotation),_(6),y("ngForOf",i.getAllCoords()),_(1),y("ngForOf",i.possibleCaptures),_(1),y("ngForOf",i.arrows),_(1),y("ngForOf",i.Player.PLAYERS),_(1),y("ngIf",i.inserted.isPresent()))},dependencies:[Ft,Wt,At],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();var dC,Nl;class nr extends br{static of(e){return new nr(e.x,e.y)}toString(){return this===nr.PASS?"GoMove.PASS":this===nr.ACCEPT?"GoMove.ACCEPT":"GoMove("+this.coord.x+", "+this.coord.y+")"}}u(nr,"PASS",new(dC=nr)(-1,0)),u(nr,"ACCEPT",new dC(-2,0)),u(nr,"encoder",br.getEncoder(dC.of));class xe{constructor(e,t){u(this,"player",void 0),u(this,"type",void 0),this.player=e,this.type=t}equals(e){return e===this}toString(){switch(this){case xe.DARK:return"GoPiece.DARK";case xe.LIGHT:return"GoPiece.LIGHT";case xe.EMPTY:return"GoPiece.EMPTY";case xe.DEAD_DARK:return"GoPiece.DEAD_DARK";case xe.DEAD_LIGHT:return"GoPiece.DEAD_LIGHT";case xe.DARK_TERRITORY:return"GoPiece.DARK_TERRITORY";default:return Ze(this===xe.LIGHT_TERRITORY,"Unexisting GoPiece"),"GoPiece.LIGHT_TERRITORY"}}static pieceBelongTo(e,t){return t===e.player&&"territory"!==e.type}static ofPlayer(e){return e===k.ZERO?xe.DARK:xe.LIGHT}isOccupied(){return[xe.DARK,xe.LIGHT,xe.DEAD_DARK,xe.DEAD_LIGHT].includes(this)}isEmpty(){return[xe.DARK_TERRITORY,xe.LIGHT_TERRITORY,xe.EMPTY].includes(this)}isDead(){return[xe.DEAD_DARK,xe.DEAD_LIGHT].includes(this)}isTerritory(){return[xe.DARK_TERRITORY,xe.LIGHT_TERRITORY].includes(this)}getOwner(){return this.player}nonTerritory(){return Ze(this.isEmpty(),'Usually not false, if false, cover by test and return "this"'),xe.EMPTY}}u(xe,"DARK",new(Nl=xe)(k.ZERO,"alive")),u(xe,"LIGHT",new Nl(k.ONE,"alive")),u(xe,"EMPTY",new Nl(K.NONE,"empty")),u(xe,"DEAD_DARK",new Nl(k.ZERO,"dead")),u(xe,"DEAD_LIGHT",new Nl(k.ONE,"dead")),u(xe,"DARK_TERRITORY",new Nl(K.NONE,"territory")),u(xe,"LIGHT_TERRITORY",new Nl(K.NONE,"territory"));var dn=function(r){return r.PLAYING="PLAYING",r.PASSED="PASSED",r.COUNTING="COUNTING",r.ACCEPT="ACCEPT",r.FINISHED="FINISHED",r}(dn||{});let Ar=(()=>{class r extends W1{constructor(t,n,i,s,o){super(t,i),u(this,"koCoord",void 0),u(this,"captured",void 0),u(this,"phase",void 0),this.captured=n,this.koCoord=s,this.phase=o}static getInitialState(){const t=r.getStartingBoard();return new r(t,[0,0],0,g.empty(),dn.PLAYING)}getCapturedCopy(){return[this.captured[0],this.captured[1]]}static getStartingBoard(){return Ie.createTable(r.WIDTH,r.HEIGHT,xe.EMPTY)}copy(){return new r(this.getCopiedBoard(),this.getCapturedCopy(),this.turn,this.koCoord,this.phase)}isDead(t){return this.getPieceAt(t).isDead()}isTerritory(t){return this.getPieceAt(t).isTerritory()}}return u(r,"WIDTH",19),u(r,"HEIGHT",19),r})();const We=xe.LIGHT,Fe=xe.DARK,FL=xe.DEAD_LIGHT,mu=xe.LIGHT_TERRITORY,Ko=xe.DARK_TERRITORY,le=xe.EMPTY;class Tce extends Zn{constructor(...e){super(...e),u(this,"tutorial",[q.informational($localize`Preliminary information`,$localize`The game of Go is played on a board called a Goban, and the stones are placed on the intersections.
        The traditional board is made of 19x19 intersections, but on this website we have the 13x13 board.
        (For shorter parts, 9x9 and 5x5 boards exist, but are not yet available here).
        For this tutorial, we will use a smaller board for pedagogical purposes.`,Ar.getInitialState()),q.informational($localize`Goal of the game`,$localize`The goal of the game is to have the most points at the end of the game.
        We call "territories" the intersections that are empty and isolated from the rest of the Goban by the stones of a single player.
        Here, Dark has 9 territories on the left, and Light has 8 on the right.
        The top part belongs to no one.
        Each player's score at the end of the game is the sum of that player's territories and captures.`,new Ar([[le,Fe,le,le,We,We],[le,Fe,le,le,We,le],[le,Fe,Fe,We,We,le],[le,le,Fe,We,le,le],[le,le,Fe,We,le,le],[le,le,Fe,We,le,le]],[0,0],0,g.empty(),dn.PLAYING)),q.fromMove($localize`Simple capture`,$localize`An isolated stone, like the one in the middle here, has 4 neighboring intersections (not 8, because we do not count diagonals).
        It is said of a group which has exactly 2 free neighboring squares, that this group has two liberties.
        If Dark plays on the last liberty of the light stone, this stone is removed from the Goban (captured) and Dark earns one point.<br/><br/>
        You're playing Dark. The light piece on the board only has one liberty left, play there.`,new Ar([[le,le,le,le,le],[le,le,Fe,le,le],[le,Fe,We,le,le],[le,le,Fe,le,le],[le,le,le,le,le]],[0,0],0,g.empty(),dn.PLAYING),[new nr(3,2)],$localize`Congratulations, you have earned one point.`,$localize`Failed, try again by playing on one of the intersections directly next to the light stone.`),q.fromMove($localize`Capturing multiple stones`,$localize`Stones that are connected horizontally or vertically must be captured at the same time, and are not capturable in isolation.<br/><br/>
        You're playing Dark. The light group here only has one liberty left, capture it.`,new Ar([[le,Fe,le,le,le],[Fe,We,le,le,le],[Fe,We,We,Fe,le],[le,Fe,Fe,le,le],[le,le,le,le,le]],[0,0],0,g.empty(),dn.PLAYING),[new nr(2,1)],$localize`Congratulations, you have earned three points and formed a territory.`,$localize`Failed, you have not captured the group. Play on the last liberty of that group.`),q.informational($localize`Suicide`,$localize`In Go, suicide is forbidden.
        If putting a piece on an intersection removes the last liberty of your group and does not capture any stone, playing on that intersection would be a suicide and is therefore forbidden.
        Here, the top left intersection is a suicide for Light.
        On the bottom right, it would be a suicide for Dark, and on the bottom left it is not a suicide for any player.`,new Ar([[le,Fe,le,le,le],[Fe,le,le,le,le],[Fe,le,le,le,We],[We,Fe,le,We,le],[le,We,le,We,Fe]],[0,0],0,g.empty(),dn.PLAYING)),q.informational($localize`Life and death (death)`,$localize`From the capture rule follows the life and death notion:
        dead stones are stones that are definitely capturable (without losing anything else).
        Alive stones are stones that can never be captured.
        From the capture rule, Dark can play inside Light's territory and make a capture.
        In this case, we say that Light has only one eye (its last liberty) and that Light is dead (even if not yet captured).
        At the end of the game, the dead stones will count as captures, and the intersections they occupy as territories.`,new Ar([[le,le,le,le,le],[Fe,Fe,Fe,le,le],[We,We,Fe,le,le],[le,We,Fe,le,le],[We,We,Fe,le,le]],[0,0],0,g.empty(),dn.PLAYING)),q.informational($localize`Life and death (eyes)`,$localize`Here, Light cannot play on the top left, nor on the bottom left.
        Light will never be able to capture Dark.
        We say that Dark has two eyes (the eye on the top left, and the one on the bottom left) and that Dark is alive.`,new Ar([[le,Fe,We,le,le],[We,Fe,We,le,le],[Fe,Fe,We,le,le],[We,Fe,We,le,le],[le,Fe,We,le,le]],[0,0],0,g.empty(),dn.PLAYING)),q.informational($localize`Seki`,$localize`If Dark plays on the middle line, Light will play on the opposite intersection and capture Dark.
        Similarly, if Light plays on the middle line, Dark will capture Light.
        In other words, there is no point in playing on the middle line.
        In that case, we say that stones in the middle are alive by Seki, and that both intersections in the middle are neutral.`,new Ar([[le,We,Fe,le,We,Fe,le],[le,We,Fe,Fe,We,Fe,le],[le,We,Fe,Fe,We,Fe,le],[le,We,Fe,Fe,We,Fe,le],[le,We,Fe,We,We,Fe,le],[le,We,Fe,We,We,Fe,le],[le,We,Fe,le,We,Fe,le]],[0,0],0,g.empty(),dn.PLAYING)),q.fromMove($localize`Ko`,$localize`A player, by putting a stone, cannot go back to an identical state of the Goban as before, in order to avoid an endless game.<br/><br/>
        You're playing Dark, capture the light stone.`,new Ar([[le,le,le,le,le,le,le],[le,le,le,le,le,le,le],[le,le,le,Fe,We,le,le],[le,le,Fe,We,le,We,le],[le,le,le,Fe,We,le,le],[le,le,le,le,le,le,le],[le,le,le,le,le,le,le]],[0,0],0,g.empty(),dn.PLAYING),[new nr(4,3)],$localize`Now, if Light tries to recapture the stone that Dark has just put on the Goban, this one would go back to its previous state, opening the door for an endless game.
        This intersection is therefore marked with a red square, to remind the players that this intersection is forbidden.
        This rule is called the Ko.
        The trick for Light is to try to create a big enough threat so that Dark must answer immediately, and does not have the time to protect its last stone, so that Light can capture it right after.`,$localize`Failed. Try again.`),q.fromMove($localize`End of the game`,$localize`When a player feels that there is no advantage to putting a new stone, that player can pass a turn.
        The game phase stops when both players pass consecutively, and we move on to the counting phase.
        The dead groups are then marked by clicking on them.
        Every intersection in a player's territory earns that player a point.
        The winner is the one with most points.<br/><br/>
        You're playing Dark. A last stone is dead, mark it.`,new Ar([[We,Fe,Fe,Fe,Fe,Fe,Ko,Ko,Ko],[We,We,We,We,Fe,Fe,Fe,Ko,Ko],[We,mu,We,We,Fe,FL,FL,Fe,Ko],[Fe,We,We,We,We,Fe,Ko,Ko,Ko],[le,We,mu,We,Fe,Fe,FL,Fe,Ko],[We,mu,We,We,Fe,Fe,Fe,Fe,Fe],[We,We,Fe,Fe,Fe,We,We,Fe,We],[Fe,Fe,Fe,We,We,We,mu,We,We],[Ko,Ko,Fe,Fe,Fe,We,We,mu,mu]],[0,0],0,g.empty(),dn.COUNTING),[new nr(0,3)],$localize`Congratulations, Dark has 15 territories and 3 light stones still present, called prisoners at the end of the game.
        The intersections where the prisoners are count as Dark's territory
        Light has 8 territories and 1 prisoner.
        The end result is therefore 18 - 9 for Dark.`,$localize`Failed, try again.`)])}}let $L=class{getGroupDatas(e,t){const i=this.getNewInstance(t[e.y][e.x]);return this._getGroupDatas(e,t,i)}_getGroupDatas(e,t,n){const i=t[e.y][e.x];if(n.addPawn(e,i),i===n.color)for(const s of this.getDirections()){const o=e.getNext(s);o.isInRange(t[0].length,t.length)&&!1===n.contains(o)&&(n=this._getGroupDatas(o,t,n))}return n}};$L=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ne.log],$L);class _u{constructor(e){u(this,"color",void 0),this.color=e}selfContains(e){return this.getCoords().some(n=>n.equals(e))}static insertAsEntryPoint(e,t){return 0===e.length?[t]:t.compareTo(e[0])<0?[t].concat(e):e.concat([t])}}class Pdt extends _u{constructor(e,t,n,i,s,o){super(e),u(this,"emptyCoords",void 0),u(this,"darkCoords",void 0),u(this,"lightCoords",void 0),u(this,"deadDarkCoords",void 0),u(this,"deadLightCoords",void 0),this.emptyCoords=t,this.darkCoords=n,this.lightCoords=i,this.deadDarkCoords=s,this.deadLightCoords=o}getCoords(){return this.color===xe.DARK?this.darkCoords:this.color===xe.LIGHT?this.lightCoords:this.color===xe.DEAD_DARK?this.deadDarkCoords:this.color===xe.DEAD_LIGHT?this.deadLightCoords:this.emptyCoords}contains(e){return this.darkCoords.concat(this.lightCoords.concat(this.emptyCoords.concat(this.deadDarkCoords.concat(this.deadLightCoords)))).some(n=>n.equals(e))}addPawn(e,t){switch(Ze(!1===this.contains(e),"This group already contains "+e.toString()),t){case xe.DARK:this.darkCoords=_u.insertAsEntryPoint(this.darkCoords,e);break;case xe.LIGHT:this.lightCoords=_u.insertAsEntryPoint(this.lightCoords,e);break;case xe.DEAD_DARK:this.deadDarkCoords=_u.insertAsEntryPoint(this.deadDarkCoords,e);break;case xe.DEAD_LIGHT:this.deadLightCoords=_u.insertAsEntryPoint(this.deadLightCoords,e);break;default:U.expectToBeMultiple(t,[xe.EMPTY,xe.DARK_TERRITORY,xe.LIGHT_TERRITORY]),this.emptyCoords=_u.insertAsEntryPoint(this.emptyCoords,e)}}isMonoWrapped(){return(this.darkCoords.length+this.deadLightCoords.length===0?0:1)+(this.lightCoords.length+this.deadDarkCoords.length===0?0:1)==1}getWrapper(){const e=new En;e.set(xe.EMPTY,this.emptyCoords.length),e.set(xe.DARK,this.darkCoords.length+this.deadLightCoords.length),e.set(xe.LIGHT,this.lightCoords.length+this.deadDarkCoords.length),e.put(this.color.nonTerritory(),0);const t=e.filter((n,i)=>i>0);if(1===t.size())return t.getAnyPair().get().key;throw new Error("Can't call getWrapper on non-mono-wrapped group")}getNeighborsEntryPoints(){const e=[];return this.color!==xe.EMPTY&&this.emptyCoords.length>0&&e.push(this.emptyCoords[0]),this.color!==xe.DARK&&this.darkCoords.length>0&&e.push(this.darkCoords[0]),this.color!==xe.LIGHT&&this.lightCoords.length>0&&e.push(this.lightCoords[0]),this.color!==xe.DEAD_DARK&&this.deadDarkCoords.length>0&&e.push(this.deadDarkCoords[0]),this.color!==xe.DEAD_LIGHT&&this.deadLightCoords.length>0&&e.push(this.deadLightCoords[0]),e}}class Rd extends $L{getNewInstance(e){return new Pdt(e,[],[],[],[],[])}getDirections(){return ze.ORTHOGONALS}}let zd=(()=>{class r{}return u(r,"ILLEGAL_KO",()=>$localize`This move is a ko, you must play somewhere else before you can play in this intersection again.`),u(r,"CANNOT_PASS_AFTER_PASSED_PHASE",()=>$localize`We are in the counting phase, you must mark stones as dead or alive or accept the current board by passing your turn.`),u(r,"CANNOT_ACCEPT_BEFORE_COUNTING_PHASE",()=>$localize`You cannot accept before the counting phase.`),u(r,"OCCUPIED_INTERSECTION",()=>$localize`This intersection is already occupied.`),u(r,"CANNOT_COMMIT_SUICIDE",()=>$localize`You cannot commit suicide.`),r})();var hC,mn;let Fc=(hC=class extends Yn{static get(){return mn.singleton.isAbsent()&&(mn.singleton=g.of(new mn)),mn.singleton.get()}constructor(){super(Ar)}static isLegal(e,t){if(mn.isPass(e)){const n=t.phase===dn.PLAYING,i=t.phase===dn.PASSED;return Ne.display("GoRules","isLegal","at "+t.phase+(n||i?" forbid":" allowed")+" passing on "+t.getCopiedBoard()),n||i?ie.success([]):ie.failure(zd.CANNOT_PASS_AFTER_PASSED_PHASE())}return mn.isAccept(e)?t.phase===dn.COUNTING||t.phase===dn.ACCEPT?ie.success([]):ie.failure(zd.CANNOT_ACCEPT_BEFORE_COUNTING_PHASE()):mn.isOccupied(e.coord,t.getCopiedBoard())?(Ne.display("GoRules","isLegal","move is marking"),mn.isLegalDeadMarking(e,t)?ie.success([]):ie.failure(zd.OCCUPIED_INTERSECTION())):(Ne.display("GoRules","isLegal","move is normal stuff: "+e.toString()),mn.isLegalNormalMove(e,t))}static getNewKo(e,t,n){if(1===n.length){const i=n[0],s=e.coord,o=t[s.y][s.x],c=(new Rd).getGroupDatas(s,t),l=c.emptyCoords,f=xe.pieceBelongTo(o,k.ZERO)?c.darkCoords:c.lightCoords;if(1===l.length&&l[0].equals(i)&&1===f.length)return g.of(i)}return g.empty()}static markTerritoryAndCount(e){const t=e.getCopiedBoard(),n=mn.getTerritoryLikeGroup(e),i=e.getCapturedCopy();for(const s of n){const o=s.getWrapper();if(o===xe.LIGHT){i[1]+=s.emptyCoords.length;for(const a of s.getCoords())t[a.y][a.x]=xe.LIGHT_TERRITORY}else{Ze(o===xe.DARK,"territory should be wrapped by dark or light, not by "+o.toString()),i[0]+=s.emptyCoords.length;for(const a of s.getCoords())t[a.y][a.x]=xe.DARK_TERRITORY}}return new Ar(t,i,e.turn,e.koCoord,e.phase)}static removeAndSubstractTerritory(e){const t=e.getCopiedBoard(),n=e.getCapturedCopy();let i;for(let s=0;s<e.board.length;s++)for(let o=0;o<e.board[0].length;o++)i=t[s][o],i===xe.DARK_TERRITORY?(t[s][o]=xe.EMPTY,n[0]=n[0]-1):i===xe.LIGHT_TERRITORY&&(t[s][o]=xe.EMPTY,n[1]=n[1]-1);return new Ar(t,n,e.turn,e.koCoord,e.phase)}static getEmptyZones(e){return mn.getGroupsDatasWhere(e.getCopiedBoard(),t=>t.isEmpty())}static getGroupsDatasWhere(e,t){const n=[];let i,s,o;const a=new Rd;for(let c=0;c<e.length;c++)for(let l=0;l<e[0].length;l++)i=new C(l,c),o=e[c][l],t(o)&&!1===n.some(f=>f.selfContains(i))&&(s=a.getGroupDatas(i,e),n.push(s));return n}static addDeadToScore(e){const t=e.getCapturedCopy();let s,n=t[1],i=t[0];for(let o=0;o<e.board.length;o++)for(let a=0;a<e.board[0].length;a++)s=e.getPieceAtXY(a,o),s===xe.DEAD_DARK?n++:s===xe.DEAD_LIGHT&&i++;return[i,n]}static switchAliveness(e,t){const n=t.getCopiedBoard();Ze(n[e.y][e.x].isOccupied(),"Can't switch emptyness aliveness");const o=(new Rd).getGroupDatas(e,n),a=t.getCapturedCopy();switch(o.color){case xe.DEAD_DARK:a[1]-=2*o.deadDarkCoords.length;for(const c of o.deadDarkCoords)n[c.y][c.x]=xe.DARK;break;case xe.DEAD_LIGHT:a[0]-=2*o.deadLightCoords.length;for(const c of o.deadLightCoords)n[c.y][c.x]=xe.LIGHT;break;case xe.LIGHT:a[0]+=2*o.lightCoords.length;for(const c of o.lightCoords)n[c.y][c.x]=xe.DEAD_LIGHT;break;default:U.expectToBe(o.color,xe.DARK),a[1]+=2*o.darkCoords.length;for(const c of o.darkCoords)n[c.y][c.x]=xe.DEAD_DARK}return new Ar(n,a,t.turn,t.koCoord,t.phase)}static getGameStatus(e){const t=e.gameState;return t.phase===dn.FINISHED?t.captured[0]>t.captured[1]?_e.ZERO_WON:t.captured[1]>t.captured[0]?_e.ONE_WON:_e.DRAW:_e.ONGOING}static isPass(e){return e.equals(nr.PASS)}static isAccept(e){return e.equals(nr.ACCEPT)}static isLegalDeadMarking(e,t){return mn.isOccupied(e.coord,t.getCopiedBoard())&&(t.phase===dn.COUNTING||t.phase===dn.ACCEPT)}static isLegalNormalMove(e,t){const n=t.getCopiedBoard();if(mn.isKo(e,t))return ie.failure(zd.ILLEGAL_KO());[dn.COUNTING,dn.ACCEPT].includes(t.phase)&&(t=mn.resurrectStones(t));const i=mn.getCaptureState(e,t);if(bce.isCapturing(i))return ie.success(i.capturedCoords);{n[e.coord.y][e.coord.x]=t.turn%2==0?xe.DARK:xe.LIGHT;const a=0===(new Rd).getGroupDatas(e.coord,n).emptyCoords.length;return n[e.coord.y][e.coord.x]=xe.EMPTY,a?ie.failure(zd.CANNOT_COMMIT_SUICIDE()):ie.success([])}}static isOccupied(e,t){return t[e.y][e.x].isOccupied()}static isKo(e,t){return!!t.koCoord.isPresent()&&e.coord.equals(t.koCoord.get())}static getCaptureState(e,t){const n=new bce;let i;for(const s of ze.ORTHOGONALS)i=mn.getCapturedInDirection(e.coord,s,t),i.length>0&&n.capturedCoords.every(o=>!1===i[0].equals(o))&&(n.capturedCoords=n.capturedCoords.concat(i));return n}static getCapturedInDirection(e,t,n){const i=n.getCopiedBoard(),s=e.getNext(t);if(s.isInRange(n.board[0].length,n.board.length)&&i[s.y][s.x]===(n.turn%2==0?xe.LIGHT:xe.DARK)){Ne.display("GoRules","getCapturedInDirection","a group could be captured");const c=(new Rd).getGroupDatas(s,i);if(mn.isCapturableGroup(c,n.koCoord))return Ne.display("GoRules","getCapturedInDirection",{neightbooringGroupCoord:c.getCoords(),message:"is capturable"}),c.getCoords()}return[]}static isCapturableGroup(e,t){return!(!e.color.isOccupied()||1!==e.emptyCoords.length)&&!1===t.equalsValue(e.emptyCoords[0])}static getTerritoryLikeGroup(e){return mn.getEmptyZones(e).filter(n=>n.isMonoWrapped())}static applyPass(e){const t=e.getCopiedBoard(),n=e.getCapturedCopy(),i=e.turn;let s,o;return e.phase===dn.PASSED?(s=dn.COUNTING,o=new Ar(t,n,i+1,g.empty(),s),o=mn.markTerritoryAndCount(o)):(Ze(e.phase===dn.PLAYING,"Cannot pass in counting phase!"),s=dn.PASSED,o=new Ar(t,n,i+1,g.empty(),s)),o}static applyLegalAccept(e){const t=e.getCopiedBoard();let n;return n=e.phase===dn.COUNTING?dn.ACCEPT:dn.FINISHED,new Ar(t,e.getCapturedCopy(),e.turn+1,g.empty(),n)}static applyNormalLegalMove(e,t,n){let i;i=[dn.COUNTING,dn.ACCEPT].includes(t.phase)?mn.resurrectStones(t):t.copy();const s=e.coord.x,o=e.coord.y,a=i.getCopiedBoard(),c=i.turn,l=xe.ofPlayer(i.getCurrentPlayer()),f=c+1;a[o][s]=l;for(const E of n)a[E.y][E.x]=xe.EMPTY;const d=mn.getNewKo(e,a,n),m=i.getCapturedCopy();return m[l.player.value]+=n.length,new Ar(a,m,f,d,dn.PLAYING)}static resurrectStones(e){for(let t=0;t<e.board.length;t++)for(let n=0;n<e.board[0].length;n++)e.getPieceAtXY(n,t).isDead()&&(e=mn.switchAliveness(new C(n,t),e));return mn.removeAndSubstractTerritory(e)}static applyDeadMarkingMove(e,t){const n=mn.removeAndSubstractTerritory(t),i=mn.switchAliveness(e.coord,n),s=new Ar(i.getCopiedBoard(),i.getCapturedCopy(),i.turn+1,g.empty(),dn.COUNTING);return mn.markTerritoryAndCount(s)}isLegal(e,t){return mn.isLegal(e,t)}applyLegalMove(e,t,n){return mn.isPass(e)?(Ne.display("GoRules","applyLegalMove","isPass"),mn.applyPass(t)):mn.isAccept(e)?(Ne.display("GoRules","applyLegalMove","isAccept"),mn.applyLegalAccept(t)):mn.isLegalDeadMarking(e,t)?(Ne.display("GoRules","applyLegalMove","isDeadMarking"),mn.applyDeadMarkingMove(e,t)):(Ne.display("GoRules","applyLegalMove","else it is normal move"),mn.applyNormalLegalMove(e,t,n))}getGameStatus(e){return mn.getGameStatus(e)}},mn=hC,u(hC,"singleton",g.empty()),hC);Fc=mn=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ne.log],Fc);class bce{constructor(){u(this,"capturedCoords",[])}static isCapturing(e){return e.capturedCoords.length>0}}class Odt extends fr{getMetrics(e){const t=Fc.markTerritoryAndCount(e.gameState),n=t.getCapturedCopy(),i=this.getDeadStones(t);return[n[0]+2*i[1],n[1]+2*i[0]]}getDeadStones(e){const t=[0,0];for(let n=0;n<e.board.length;n++)for(let i=0;i<e.board[0].length;i++){const s=e.getPieceAtXY(i,n);"dead"===s.type&&(t[s.player.value]=t[s.player.value]+1)}return t}}let pC=class extends Un{getListMoves(e){const t=e.gameState,n=this.getPlayingMovesList(t);if(t.phase===dn.PLAYING||t.phase===dn.PASSED)return n.push(nr.PASS),n;{const i=this.getCountingMovesList(t);return 0===i.length?[nr.ACCEPT]:i}}getPlayingMovesList(e){const t=[];let n;for(let i=0;i<e.board.length;i++)for(let s=0;s<e.board[0].length;s++)n=new nr(s,i),e.getPieceAt(n.coord)===xe.EMPTY&&Fc.isLegal(n,e).isSuccess()&&t.push(n);return t}getCountingMovesList(e){const t=[],n=this.getCorrectBoard(e).getCopiedBoard(),i=Fc.getGroupsDatasWhere(n,s=>s!==xe.EMPTY);for(const s of i){const o=s.getCoords()[0],a=n[o.y][o.x];if(e.getPieceAt(o)!==a){const l=new nr(o.x,o.y);return t.push(l),t}}return t}getCorrectBoard(e){const n=this.mapBoard(e.getCopiedBoard(),o=>o===xe.DARK?xe.DEAD_DARK:o===xe.LIGHT?xe.DEAD_LIGHT:o.isTerritory()?xe.EMPTY:o),i=new Ar(n,e.getCapturedCopy(),e.turn,e.koCoord,e.phase),s=Fc.getTerritoryLikeGroup(i);return this.setAliveUniqueWrapper(i,s)}mapBoard(e,t){const n=[];for(let i=0;i<e.length;i++){n[i]=[];for(let s=0;s<e[0].length;s++)n[i][s]=t(e[i][s])}return n}setAliveUniqueWrapper(e,t){let i,n=e.copy();for(const s of t){i=s.deadDarkCoords.concat(s.deadLightCoords);for(const o of i)n.isDead(o)&&(n=Fc.switchAliveness(o,n))}return n}};var vu;function Adt(r,e){if(1&r){const t=pe();N(),S(0,"g")(1,"rect",8),W("click",function(){const s=te(t).index,o=p().index;return ne(p().onClick(s,o))}),P(),S(2,"line",9),W("click",function(){const s=te(t).index,o=p().index;return ne(p().onClick(s,o))}),P(),S(3,"line",9),W("click",function(){const s=te(t).index,o=p().index;return ne(p().onClick(s,o))}),P()()}if(2&r){const t=e.index,n=p().index,i=p();_(1),ye("id","click_",t,"_",n,""),I("width",.5*i.SPACE_SIZE)("height",.5*i.SPACE_SIZE)("x",.5*i.SPACE_SIZE*t)("y",.5*i.SPACE_SIZE*n),_(1),I("x1",.5*i.SPACE_SIZE*t)("y1",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*n)("x2",.5*i.SPACE_SIZE+.5*i.SPACE_SIZE*t)("y2",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*n),_(1),I("x1",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*t)("y1",.5*i.SPACE_SIZE*n)("x2",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*t)("y2",.5*i.SPACE_SIZE+.5*i.SPACE_SIZE*n)}}function Ndt(r,e){if(1&r&&(N(),S(0,"g"),T(1,Adt,4,14,"g",3),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function Idt(r,e){if(1&r){const t=pe();N(),S(0,"circle",10),W("click",function(){const s=te(t).$implicit;return ne(p().onClick(s.x,s.y))}),P()}if(2&r){const t=e.$implicit,n=p();ye("id","hoshi_",t.x,"_",t.y,""),I("cx",.25*n.SPACE_SIZE+.5*n.SPACE_SIZE*t.x)("cy",.25*n.SPACE_SIZE+.5*n.SPACE_SIZE*t.y)("r",.1*n.SPACE_SIZE)}}function kdt(r,e){if(1&r&&(N(),F(0,"circle",16)),2&r){const t=p(2).index,n=p().index,i=p();I("cx",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*t)("cy",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*n)("r",.22*i.SPACE_SIZE)}}function xdt(r,e){if(1&r){const t=pe();N(),S(0,"line",17),W("click",function(){te(t);const i=p(2).index,s=p().index;return ne(p().onClick(i,s))}),P()}if(2&r){const t=p(2).index,n=p().index,i=p();I("x1",.5*i.SPACE_SIZE*t)("y1",.5*i.SPACE_SIZE*n)("x2",.5*i.SPACE_SIZE+.5*i.SPACE_SIZE*t)("y2",.5*i.SPACE_SIZE+.5*i.SPACE_SIZE*n)}}function Ldt(r,e){if(1&r){const t=pe();N(),S(0,"g")(1,"circle",13),W("click",function(){te(t);const i=p().index,s=p().index;return ne(p().onClick(i,s))}),P(),T(2,kdt,1,3,"circle",14),T(3,xdt,1,4,"line",15),P()}if(2&r){const t=p().index,n=p().index,i=p();_(1),y("ngClass",i.getSpaceClass(t,n)),I("cx",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*t)("cy",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*n)("r",.22*i.SPACE_SIZE),_(1),y("ngIf",i.isLastSpace(t,n)),_(1),y("ngIf",i.isDead(t,n))}}function Rdt(r,e){if(1&r){const t=pe();N(),S(0,"circle",19),W("click",function(){te(t);const i=p(2).index,s=p().index;return ne(p().onClick(i,s))}),P()}if(2&r){const t=p(2),n=t.index,i=t.$implicit,s=p().index,o=p();I("cx",.25*o.SPACE_SIZE+.5*o.SPACE_SIZE*n)("cy",.25*o.SPACE_SIZE+.5*o.SPACE_SIZE*s)("r",.1*o.SPACE_SIZE)("class",i===o.GoPiece.LIGHT_TERRITORY?"player1-fill":"player0-fill")}}function zdt(r,e){if(1&r&&(N(),T(0,Rdt,1,4,"circle",18)),2&r){const t=p().index,n=p().index;y("ngIf",p().isTerritory(t,n))}}function Ddt(r,e){if(1&r&&(N(),S(0,"g"),T(1,Ldt,4,6,"g",11),T(2,zdt,1,1,"ng-template",null,12,un),P()),2&r){const t=e.index,n=cn(3),i=p().index,s=p();_(1),y("ngIf",s.spaceIsFull(t,i))("ngIfElse",n)}}function Hdt(r,e){if(1&r&&(N(),S(0,"g"),T(1,Ddt,4,2,"g",3),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function Vdt(r,e){if(1&r&&(N(),F(0,"rect",20)),2&r){const t=p();I("width",.25*t.SPACE_SIZE)("height",.25*t.SPACE_SIZE)("x",.125*t.SPACE_SIZE+.5*t.SPACE_SIZE*t.ko.get().x)("y",.125*t.SPACE_SIZE+.5*t.SPACE_SIZE*t.ko.get().y)}}function Fdt(r,e){if(1&r){const t=pe();N(),S(0,"circle",21),W("click",function(){const s=te(t).$implicit;return ne(p().onClick(s.x,s.y))}),P()}if(2&r){const t=e.$implicit,n=p();I("cx",.25*n.SPACE_SIZE+.5*n.SPACE_SIZE*t.x)("cy",.25*n.SPACE_SIZE+.5*n.SPACE_SIZE*t.y)("r",.07*n.SPACE_SIZE)}}pC=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ne.log],pC);let GL=(vu=class extends IL{constructor(e){super(e),u(this,"boardInfo",void 0),u(this,"ko",g.empty()),u(this,"last",g.empty()),u(this,"captures",[]),u(this,"GoPiece",xe),u(this,"boardHeight",Ar.HEIGHT),u(this,"boardWidth",Ar.WIDTH),this.scores=g.of([0,0]),this.rules=Fc.get(),this.node=this.rules.getInitialNode(),this.availableAIs=[new on($localize`Minimax`,Fc.get(),new Odt,new pC),new Kn($localize`MCTS`,new pC,this.rules)],this.encoder=nr.encoder,this.tutorial=(new Tce).tutorial,this.canPass=!0,this.boardHeight=this.getState().board.length,this.boardWidth=this.getState().board[0].length}onClick(e,t){var n=this;return M(function*(){const i=yield n.canUserPlay("#click_"+e+"_"+t);if(i.isFailure())return n.cancelMove(i.getReason());n.last=g.empty();const s=new nr(e,t);return n.chooseMove(s)})()}updateBoard(e){var t=this;return M(function*(){const n=t.getState(),i=t.node.previousMove,s=n.phase;t.board=n.getCopiedBoard(),t.scores=g.of(n.getCapturedCopy()),t.ko=n.koCoord,i.isPresent()?t.showCaptures():t.captures=[],t.last=i.map(o=>o.coord),t.canPass=s!==dn.FINISHED,t.createHoshis()})()}showCaptures(){const e=this.getPreviousState();this.captures=[];for(let t=0;t<this.board.length;t++)for(let n=0;n<this.board[0].length;n++){const i=new C(n,t),s=e.getPieceAt(i).isOccupied(),o=this.board[t][n]===xe.EMPTY,a=!1===this.ko.equalsValue(i);s&&o&&a&&this.captures.push(i)}}pass(){var e=this;return M(function*(){const t=e.getState().phase;return t===dn.PLAYING||t===dn.PASSED?e.onClick(nr.PASS.coord.x,nr.PASS.coord.y):(Ze(t===dn.COUNTING||t===dn.ACCEPT,"GoComponent: pass() must be called only in playing, passed, counting, or accept phases"),e.onClick(nr.ACCEPT.coord.x,nr.ACCEPT.coord.y))})()}getSpaceClass(e,t){const n=this.getState().getPieceAtXY(e,t);return this.getPlayerClass(n.getOwner())}spaceIsFull(e,t){return this.getState().getPieceAtXY(e,t)!==xe.EMPTY&&!1===this.isTerritory(e,t)}isLastSpace(e,t){if(this.last.isPresent()){const n=this.last.get();return e===n.x&&t===n.y}return!1}isDead(e,t){return this.getState().isDead(new C(e,t))}isTerritory(e,t){return this.getState().isTerritory(new C(e,t))}},u(vu,"\u0275fac",function(e){return new(e||vu)(B(Ut))}),u(vu,"\u0275cmp",qe({type:vu,selectors:[["app-go"]],features:[Qe],decls:9,vars:8,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["x","0","y","0",1,"base","mid-small-stroke"],["id","blank_board"],[4,"ngFor","ngForOf"],["class","base-no-stroke",3,"id","click",4,"ngFor","ngForOf"],["id","piece_ko_territory_markers_and_dead_stones"],["class","captured-stroke mid-stroke no-fill",4,"ngIf"],["class","captured-fill",3,"click",4,"ngFor","ngForOf"],["fill-opacity","0",1,"base","no-stroke",3,"id","click"],[1,"base","mid-stroke",3,"click"],[1,"base-no-stroke",3,"id","click"],[4,"ngIf","ngIfElse"],["empty",""],[1,"base","mid-stroke",3,"ngClass","click"],["class","base no-fill mid-stroke last-move-stroke",4,"ngIf"],["class","base no-fill captured-stroke",3,"click",4,"ngIf"],[1,"base","no-fill","mid-stroke","last-move-stroke"],[1,"base","no-fill","captured-stroke",3,"click"],[3,"click",4,"ngIf"],[3,"click"],[1,"captured-stroke","mid-stroke","no-fill"],[1,"captured-fill",3,"click"]],template:function(e,t){1&e&&(N(),S(0,"svg",0),F(1,"rect",1),S(2,"g",2),T(3,Ndt,2,1,"g",3),T(4,Idt,1,5,"circle",4),P(),S(5,"g",5),T(6,Hdt,2,1,"g",3),P(),T(7,Vdt,1,4,"rect",6),T(8,Fdt,1,3,"circle",7),P()),2&e&&(I("viewBox","0 -3 "+t.boardWidth*t.SPACE_SIZE*.5+" "+(6+t.boardHeight*t.SPACE_SIZE*.5)),_(1),I("width",t.boardWidth*t.SPACE_SIZE*.5)("height",t.boardHeight*t.SPACE_SIZE*.5),_(2),y("ngForOf",t.board),_(1),y("ngForOf",t.hoshis),_(2),y("ngForOf",t.board),_(1),y("ngIf",t.ko.isPresent()),_(1),y("ngForOf",t.captures))},dependencies:[Ft,Wt,At],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),vu);GL=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ne.log],GL);class f4{static fromLimits(e,t,n,i){return new f4(e,n,t-e,i-n)}static fromHexa(e,t,n){const i=e.flatMap(f=>t.getHexaPointsListAt(f)),s=f4.getLimits(i);return new f4(s.minX-n/2,s.minY-n/2,n+s.maxX-s.minX,n+s.maxY-s.minY)}static getLimits(e){let t=Number.MIN_SAFE_INTEGER,n=Number.MIN_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER,s=Number.MAX_SAFE_INTEGER;for(const o of e)i=Math.min(i,o.x),s=Math.min(s,o.y),t=Math.max(t,o.x),n=Math.max(n,o.y);return{minX:i,minY:s,maxX:t,maxY:n}}constructor(e,t,n,i){u(this,"left",void 0),u(this,"up",void 0),u(this,"width",void 0),u(this,"height",void 0),this.left=e,this.up=t,this.width=n,this.height=i}center(){return new C(this.left+this.width/2,this.up+this.height/2)}bottom(){return this.up+this.height}right(){return this.left+this.width}expand(e,t,n,i){return new f4(this.left-e,this.up-n,this.width+e+t,this.height+n+i)}containingAtLeast(e){const t=Math.min(this.left,e.left),n=Math.max(this.right(),e.right()),i=Math.min(this.up,e.up),s=Math.max(this.bottom(),e.bottom());return f4.fromLimits(t,n,i,s)}toSVGString(){return`${this.left} ${this.up} ${this.width} ${this.height}`}}class $dt{static getArrowTransform(e,t,n){let i,s,o;switch(n){case ze.UP:i=1,s=0,o=-90;break;case ze.DOWN:i=1,s=2,o=90;break;case ze.LEFT:i=0,s=1,o=180;break;default:U.expectToBe(n,ze.RIGHT),i=2,s=1,o=0}return["scale("+e/300+")",`translate(${100*i} ${100*s})`,"rotate("+o+" 50 50)"].join(" ")}}let hr=(()=>{class r{}return u(r,"CANNOT_DROP_PIECE_YOU_DONT_HAVE",()=>"You cannot drop a piece that you do not have in your reserve."),u(r,"QUEEN_BEE_CAN_ONLY_MOVE_TO_DIRECT_NEIGHBORS",()=>$localize`The queen bee can only move to one of its direct neighbors.`),u(r,"BEETLE_CAN_ONLY_MOVE_TO_DIRECT_NEIGHBORS",()=>$localize`The beetle can only move to one of its direct neighbors.`),u(r,"GRASSHOPPER_MUST_MOVE_IN_STRAIGHT_LINE",()=>$localize`The grasshopper must move in a straight line.`),u(r,"GRASSHOPPER_MUST_JUMP_OVER_PIECES",()=>$localize`The grasshopper must jump over other pieces, without any empty spaces.`),u(r,"SPIDER_MUST_MOVE_ON_NEIGHBORING_SPACES",()=>$localize`The spider must move on neighboring spaces.`),u(r,"SPIDER_CAN_ONLY_MOVE_WITH_DIRECT_CONTACT",()=>$localize`The spider can only move around pieces that are in direct contact with it.`),u(r,"SPIDER_CANNOT_BACKTRACK",()=>$localize`The spider cannot go twice through the same space in the same move.`),u(r,"QUEEN_BEE_MUST_BE_ON_BOARD_BEFORE_MOVE",()=>$localize`The queen bee must be placed on the board before moving a piece.`),u(r,"THIS_PIECE_CANNOT_CLIMB",()=>$localize`Only the beetle is allowed to climb over other pieces.`),u(r,"CANNOT_DISCONNECT_HIVE",()=>$localize`You are not allowed to split the hive.`),u(r,"MUST_BE_ABLE_TO_SLIDE",()=>$localize`This piece must be able to slide to its destination.`),u(r,"MUST_PLACE_QUEEN_BEE_LATEST_AT_FOURTH_TURN",()=>$localize`You must place your queen bee at this turn!`),u(r,"CANNOT_DROP_NEXT_TO_OPPONENT",()=>$localize`You cannot drop a piece next to one of your opponent's stack.`),u(r,"MUST_DROP_ON_EMPTY_SPACE",()=>$localize`You must always drop your piece on an empty space.`),u(r,"MUST_BE_CONNECTED_TO_HIVE",()=>$localize`The piece you are dropping must be connected to the hive.`),r})();var wce;const Gdt=we.fromFunctions(r=>r,r=>r);class n2{constructor(e,t){u(this,"owner",void 0),u(this,"kind",void 0),this.owner=e,this.kind=t}toString(){return`${this.kind}_${this.owner.toString()}`}equals(e){return this.owner===e.owner&&this.kind===e.kind}}wce=n2,u(n2,"encoder",we.tuple([k.encoder,Gdt],r=>[r.owner,r.kind],r=>new wce(r[0],r[1])));class $c{constructor(e){u(this,"pieces",void 0),this.pieces=e}equals(e){return this.size()===e.size()&&Ie.compareArray(this.pieces,e.pieces)}isEmpty(){return 0===this.pieces.length}hasPieces(){return!1===this.isEmpty()}add(e){return new $c([e,...this.pieces])}topPiece(){return U.assert(this.hasPieces(),"HivePieceStack: cannot get top piece of an empty stack"),this.pieces[0]}removeTopPiece(){const e=[...this.pieces];return e.shift(),new $c(e)}size(){return this.pieces.length}}var Nce,kce,v2;u($c,"EMPTY",new $c([]));class Xo extends br{static of(e,t){return new Xo(e,t.x,t.y)}constructor(e,t,n){super(t,n),u(this,"piece",void 0),this.piece=e}toString(){return`HiveDrop(${this.piece.toString()}, ${this.coord.toString()})`}equals(e){return e instanceof Xo&&this.piece.equals(e.piece)&&this.coord.equals(e.coord)}}Nce=Xo,u(Xo,"encoder",we.tuple([n2.encoder,C.encoder],r=>[r.piece,r.coord],r=>new Nce(r[0],r[1].x,r[1].y)));class Gi extends $o{static from(e,t){return e.equals(t)?ie.failure(Re.MOVE_CANNOT_BE_STATIC()):ie.success(new Gi(e,t))}constructor(e,t){super(e,t)}toString(){return`HiveMoveCoordToCoord(${this.getStart().toString()} -> ${this.getEnd().toString()})`}equals(e){return!(e instanceof za)&&e instanceof Gi&&this.getStart().equals(e.getStart())&&this.getEnd().equals(e.getEnd())}}u(Gi,"encoder",Hs.getFallibleEncoder(Gi.from));class za extends Gi{static ofCoords(e){return new za(e)}constructor(e){super(e[0],e[3]),u(this,"coords",void 0),this.coords=e}toString(){return`HiveMoveSpider(${this.coords.map(t=>t.toString()).join(", ")})`}equals(e){return e instanceof za&&this.getStart().equals(e.getStart())&&this.getEnd().equals(e.getEnd())}}kce=za,u(za,"encoder",we.tuple([C.encoder,C.encoder,C.encoder,C.encoder],r=>r.coords,r=>new kce(r)));class I0 extends Di{toString(){return"HiveMovePass"}equals(e){return e instanceof I0}}function Bdt(r){return r instanceof Xo}function Udt(r){return r instanceof za}function Wdt(r){return r instanceof Gi}function qdt(r){return r instanceof I0}u(I0,"encoder",we.constant("HiveMovePass",new I0)),function(r){r.PASS=new I0,r.drop=function e(i,s){return Xo.of(i,s)},r.move=function t(i,s){return Gi.from(i,s)},r.spiderMove=function n(i){return za.ofCoords(i)},r.encoder=we.disjunction([Bdt,Udt,Wdt,qdt],[Xo.encoder,za.encoder,Gi.encoder,I0.encoder])}(v2||(v2={}));class Qo{static of(e){return Qo.INSTANCES.isAbsent()&&(Qo.INSTANCES=g.of({QueenBee:gC.get(),Beetle:mC.get(),Grasshopper:_C.get(),Spider:Dd.get(),SoldierAnt:vC.get()})),Qo.INSTANCES.get()[e.kind]}checkEmptyDestination(e,t){return t.getAt(e.getEnd()).hasPieces()?b.failure(hr.THIS_PIECE_CANNOT_CLIMB()):b.SUCCESS}canSlideBetweenNeighbors(e,t,n){const i=new dt(m2.getNeighbors(t)),s=new dt(m2.getNeighbors(n)),o=i.intersection(s);for(const a of o)if(e.getAt(a).isEmpty())return!0;return!1}}u(Qo,"INSTANCES",g.empty());class gC extends Qo{static get(){return this.INSTANCE.isAbsent()&&(this.INSTANCE=g.of(new gC)),this.INSTANCE.get()}moveValidity(e,t){return!1===m2.areNeighbors(e.getStart(),e.getEnd())?b.failure(hr.QUEEN_BEE_CAN_ONLY_MOVE_TO_DIRECT_NEIGHBORS()):!1===this.canSlideBetweenNeighbors(t,e.getStart(),e.getEnd())?b.failure(hr.MUST_BE_ABLE_TO_SLIDE()):this.checkEmptyDestination(e,t)}getPotentialMoves(e,t){const n=[];for(const i of m2.getNeighbors(e))t.getAt(i).isEmpty()&&n.push(Gi.from(e,i).get());return n}}u(gC,"INSTANCE",g.empty());class mC extends Qo{static get(){return this.INSTANCE.isAbsent()&&(this.INSTANCE=g.of(new mC)),this.INSTANCE.get()}moveValidity(e,t){return!1===m2.areNeighbors(e.getStart(),e.getEnd())?b.failure(hr.BEETLE_CAN_ONLY_MOVE_TO_DIRECT_NEIGHBORS()):b.SUCCESS}getPotentialMoves(e,t){const n=[];for(const i of m2.getNeighbors(e))n.push(Gi.from(e,i).get());return n}}u(mC,"INSTANCE",g.empty());class _C extends Qo{static get(){return this.INSTANCE.isAbsent()&&(this.INSTANCE=g.of(new _C)),this.INSTANCE.get()}moveValidity(e,t){if(be.factory.fromMove(e.getStart(),e.getEnd()).isFailure())return b.failure(hr.GRASSHOPPER_MUST_MOVE_IN_STRAIGHT_LINE());const i=e.getStart().getCoordsToward(e.getEnd());if(0===i.length)return b.failure(hr.GRASSHOPPER_MUST_JUMP_OVER_PIECES());for(const s of i)if(t.getAt(s).isEmpty())return b.failure(hr.GRASSHOPPER_MUST_JUMP_OVER_PIECES());return this.checkEmptyDestination(e,t)}getPotentialMoves(e,t){const n=[];for(const i of be.factory.all){const s=e.getNext(i);if(t.getAt(s).hasPieces()){let o=s;for(;t.getAt(o).hasPieces();)o=o.getNext(i);n.push(Gi.from(e,o).get())}}return n}}u(_C,"INSTANCE",g.empty());class Dd extends Qo{static get(){return this.INSTANCE.isAbsent()&&(this.INSTANCE=g.of(new Dd)),this.INSTANCE.get()}prefixLegality(e,t){const n=new dt,i=t.update().setAt(e[0],$c.EMPTY).increaseTurnAndFinalizeUpdate();for(let s=1;s<e.length;s++){if(i.getAt(e[s]).hasPieces())return b.failure(hr.THIS_PIECE_CANNOT_CLIMB());if(!1===m2.areNeighbors(e[s-1],e[s]))return b.failure(hr.SPIDER_MUST_MOVE_ON_NEIGHBORING_SPACES());if(!1===i.haveCommonNeighbor(e[s],e[s-1]))return b.failure(hr.SPIDER_CAN_ONLY_MOVE_WITH_DIRECT_CONTACT());if(!1===this.canSlideBetweenNeighbors(i,e[s-1],e[s]))return b.failure(hr.MUST_BE_ABLE_TO_SLIDE());if(n.contains(e[s]))return b.failure(hr.SPIDER_CANNOT_BACKTRACK());n.add(e[s])}return b.SUCCESS}moveValidity(e,t){U.assert(e instanceof za,"HiveSpiderRules: move should be a spider move");const i=this.prefixLegality(e.coords,t);return i.isFailure()?i:this.checkEmptyDestination(e,t)}getPotentialMoves(e,t){const n=t.update().setAt(e,$c.EMPTY).increaseTurnAndFinalizeUpdate();let i=[[e]];for(let a=0;a<3;a++)i=i.flatMap(c=>this.nextMoveStep(n,c));return new dt(i.map(function s(a){return za.ofCoords(a)})).toList()}nextMoveStep(e,t){const n=t[t.length-1];return new dt(m2.getNeighbors(n)).filter(function i(o){return!e.getAt(o).hasPieces()&&void 0===t.find(a=>o.equals(a))&&e.haveCommonNeighbor(o,n)}).toList().map(o=>[...t,o])}}u(Dd,"INSTANCE",g.empty());class vC extends Qo{static get(){return this.INSTANCE.isAbsent()&&(this.INSTANCE=g.of(new vC)),this.INSTANCE.get()}pathExists(e,t,n){const i=new dt,s=[t];for(;s.length>0;){const o=s.pop();if(!i.contains(o)){if(i.add(o),o.equals(n))return!0;for(const a of m2.getNeighbors(o)){const c=e.getAt(a).isEmpty(),l=e.getOccupiedNeighbors(a).size()>0,f=this.canSlideBetweenNeighbors(e,o,a);c&&l&&f&&s.push(a)}}}return!1}moveValidity(e,t){return!1===this.pathExists(t,e.getStart(),e.getEnd())?b.failure(hr.MUST_BE_ABLE_TO_SLIDE()):this.checkEmptyDestination(e,t)}getPotentialMoves(e,t){const n=new dt;for(const i of t.occupiedSpaces())if(!i.equals(e))for(const s of t.emptyNeighbors(i))n.add(Gi.from(e,s).get());return n.toList()}}u(vC,"INSTANCE",g.empty());class Lce extends Qv{constructor(e,t){super(t),u(this,"pieces",void 0),u(this,"width",void 0),u(this,"height",void 0),this.pieces=e;const n=this.computeScale();this.width=n.width,this.height=n.height,this.pieces.makeImmutable()}getPieces(){return this.pieces}getPieceCoords(){return this.pieces.listKeys()}computeScale(){let e=Number.MAX_SAFE_INTEGER,t=Number.MIN_SAFE_INTEGER,n=Number.MAX_SAFE_INTEGER,i=Number.MIN_SAFE_INTEGER;for(const s of this.pieces.listKeys())e=Math.min(s.x,e),t=Math.max(s.x,t),n=Math.min(s.y,n),i=Math.max(s.y,i);return{width:t+1-e,height:i+1-n}}isOnBoard(e){return this.pieces.containsKey(e)}getOccupiedNeighbors(e){return new dt(m2.getNeighbors(e)).filter(n=>this.pieces.get(n).isPresent())}getGroups(){const e=new dt,t=new dt;return this.pieces.forEach(n=>{if(!1===e.contains(n.key)){const i=new dt,s=new dt([n.key]);for(;s.hasElements();){const o=s.getAnyElement().get();s.remove(o),e.add(o),i.add(o),s.addAll(this.getOccupiedNeighbors(o).filter(a=>!1===e.contains(a)))}t.add(i)}}),t}}class CC{static getInitial(){const e=new En;for(const t of k.PLAYERS)e.set(new n2(t,"QueenBee"),1),e.set(new n2(t,"Beetle"),2),e.set(new n2(t,"Spider"),2),e.set(new n2(t,"Grasshopper"),3),e.set(new n2(t,"SoldierAnt"),3);return e.makeImmutable(),new CC(e)}constructor(e){u(this,"pieces",void 0),this.pieces=e}equals(e){return this.pieces.equals(e.pieces)}getQuantity(e){return this.pieces.get(e).get()}hasRemaining(e){return this.getQuantity(e)>0}getAny(e){for(const t of this.pieces.listKeys())if(t.owner===e&&this.hasRemaining(t))return g.of(t);return g.empty()}remove(e){const t=this.pieces.get(e).get();U.assert(t>0,"HiveRemainingPieces cannot remove a non-remainingPiece");const n=this.pieces.getCopy();return n.replace(e,t-1),new CC(n)}toListOfStacks(){const e=[];return this.pieces.forEach(t=>{const n=[];for(let i=0;i<t.value;i++)n.push(t.key);e.push(new $c(n))}),e}getPlayerPieces(e){const t=[];return this.pieces.forEach(n=>{n.key.owner===e&&n.value>0&&t.push(n.key)}),t}}class Hd{static of(e){return new Hd(e.pieces,e.remainingPieces,e.queenBees,e.turn)}constructor(e,t,n,i){u(this,"pieces",void 0),u(this,"remainingPieces",void 0),u(this,"queenBees",void 0),u(this,"turn",void 0),this.pieces=e,this.remainingPieces=t,this.queenBees=n,this.turn=i}setAt(e,t){const n=this.queenBees.getCopy();for(const s of k.PLAYERS)n.get(s).equalsValue(e)&&n.delete(s);for(const s of t.pieces)"QueenBee"===s.kind&&n.put(s.owner,e);const i=this.pieces.getCopy();return t.isEmpty()?i.delete(e):i.put(e,t),new Hd(i,this.remainingPieces,n,this.turn)}removeRemainingPiece(e){return new Hd(this.pieces,this.remainingPieces.remove(e),this.queenBees,this.turn)}increaseTurnAndFinalizeUpdate(){return new hi(this.pieces,this.remainingPieces,this.queenBees,this.turn+1)}}class hi extends Lce{static getInitialState(){return hi.fromRepresentation([],0)}static fromRepresentation(e,t,n=new St(0,0)){const i=new ru;let s=CC.getInitial();const o=new En;for(let a=0;a<e.length;a++)for(let c=0;c<e[0].length;c++)if(e[a][c].length>0){const l=new C(c,a).getNext(n,1);i.set(l,new $c(e[a][c]));const f=g.ofNullable(e[a][c].find(d=>"QueenBee"===d.kind));f.isPresent()&&o.set(f.get().owner,l);for(const d of e[a][c])s=s.remove(d)}return new hi(i,s,o,t)}constructor(e,t,n,i){super(e,i),u(this,"remainingPieces",void 0),u(this,"queenBees",void 0),this.remainingPieces=t,this.queenBees=n,this.queenBees=n.getCopy();for(const s of n.listKeys()){const o=n.get(s).get();this.queenBees.replace(s,o)}this.queenBees.makeImmutable()}update(){return Hd.of(this)}equals(e){return this.pieces.equals(e.pieces)&&this.remainingPieces.equals(e.remainingPieces)&&this.queenBees.equals(e.queenBees)&&this.turn===e.turn}getAt(e){return this.isOnBoard(e)?this.pieces.get(e).get():$c.EMPTY}queenBeeLocation(e){return this.queenBees.get(e)}hasQueenBeeOnBoard(e){return this.queenBeeLocation(e).isPresent()}numberOfNeighbors(e){let t=0;for(const n of m2.getNeighbors(e))this.getAt(n).hasPieces()&&(t+=1);return t}isDisconnected(){return this.getGroups().size()>1}occupiedSpaces(){return this.pieces.listKeys()}emptyNeighbors(e){const t=[];for(const n of m2.getNeighbors(e))this.getAt(n).isEmpty()&&t.push(n);return t}haveCommonNeighbor(e,t){const n=this.getOccupiedNeighbors(e),i=this.getOccupiedNeighbors(t);return n.findAnyCommonElement(i).isPresent()}}class C2 extends Yn{static get(){return C2.singleton.isAbsent()&&(C2.singleton=g.of(new C2)),C2.singleton.get()}constructor(){super(hi)}applyLegalMove(e,t,n){return e instanceof Xo?this.applyLegalDrop(e,t):e instanceof Gi?this.applyLegalMoveCoordToCoord(e,t):t.update().increaseTurnAndFinalizeUpdate()}applyLegalDrop(e,t){const n=t.getAt(e.coord);return t.update().setAt(e.coord,n.add(e.piece)).removeRemainingPiece(e.piece).increaseTurnAndFinalizeUpdate()}applyLegalMoveCoordToCoord(e,t){const n=t.getAt(e.getStart()),i=t.getAt(e.getEnd());return t.update().setAt(e.getStart(),n.removeTopPiece()).setAt(e.getEnd(),i.add(n.topPiece())).increaseTurnAndFinalizeUpdate()}isLegal(e,t){return e instanceof Xo?this.isLegalDrop(e,t):e instanceof Gi?this.isLegalMoveCoordToCoord(e,t):this.shouldPass(t)?b.SUCCESS:b.failure(Re.CANNOT_PASS())}isLegalMoveCoordToCoord(e,t){if(!1===t.queenBeeLocation(t.getCurrentPlayer()).isPresent())return b.failure(hr.QUEEN_BEE_MUST_BE_ON_BOARD_BEFORE_MOVE());const n=t.getAt(e.getStart());if(n.isEmpty())return b.failure(Re.MUST_CHOOSE_PLAYER_PIECE());const i=n.topPiece();if(i.owner===t.getCurrentOpponent())return b.failure(Re.MUST_CHOOSE_PLAYER_PIECE());const s=Qo.of(i).moveValidity(e,t);if(s.isFailure())return s;const o=t.update().setAt(e.getStart(),n.removeTopPiece()).increaseTurnAndFinalizeUpdate();if(o.isDisconnected())return b.failure(hr.CANNOT_DISCONNECT_HIVE());const a=e.getEnd();return 0===o.numberOfNeighbors(a)?b.failure(hr.CANNOT_DISCONNECT_HIVE()):b.SUCCESS}mustPlaceQueenBee(e){return e.turn>=6&&!1===e.hasQueenBeeOnBoard(e.getCurrentPlayer())}isLegalDrop(e,t){const n=t.getCurrentPlayer();if(e.piece.owner===n.getOpponent())return b.failure(Re.MUST_CHOOSE_PLAYER_PIECE());if(!1===t.remainingPieces.hasRemaining(e.piece))return b.failure(hr.CANNOT_DROP_PIECE_YOU_DONT_HAVE());if("QueenBee"!==e.piece.kind&&this.mustPlaceQueenBee(t))return b.failure(hr.MUST_PLACE_QUEEN_BEE_LATEST_AT_FOURTH_TURN());const i=this.checkNeighborValidity(e,t);return i.isFailure()?i:t.getAt(e.coord).hasPieces()?b.failure(hr.MUST_DROP_ON_EMPTY_SPACE()):b.SUCCESS}checkNeighborValidity(e,t){const n=t.getCurrentPlayer();let i=!1;for(const s of m2.getNeighbors(e.coord)){const o=t.getAt(s);if(o.hasPieces()&&(i=!0,1!==t.turn&&o.topPiece().owner===n.getOpponent()))return b.failure(hr.CANNOT_DROP_NEXT_TO_OPPONENT())}return 0!==t.turn&&!1===i?b.failure(hr.MUST_BE_CONNECTED_TO_HIVE()):b.SUCCESS}getPossibleDropLocations(e){const t=e.getCurrentPlayer();if(0===e.turn)return new dt([new C(0,0)]);if(1===e.turn)return new dt(m2.getNeighbors(new C(0,0)));const n=e.remainingPieces.getAny(t);if(n.isAbsent())return new dt;const i=n.get(),s=new dt;for(const o of e.occupiedSpaces())if(e.getAt(o).topPiece().owner===t)for(const a of e.emptyNeighbors(o)){const c=Xo.of(i,a);this.isLegalDrop(c,e).isSuccess()&&s.add(a)}return s}getPossibleMovesFrom(e,t){const n=e.getCurrentPlayer(),i=new dt,s=e.getAt(t).topPiece();if(s.owner===n)for(const o of Qo.of(s).getPotentialMoves(t,e))this.isLegalMoveCoordToCoord(o,e).isSuccess()&&i.add(o);return i}getPossibleMovesOnBoard(e){const t=new dt;for(const n of e.occupiedSpaces())t.addAll(this.getPossibleMovesFrom(e,n));return t}shouldPass(e){return 0===this.getPossibleDropLocations(e).size()&&0===this.getPossibleMovesOnBoard(e).size()}getGameStatus(e){const t=e.gameState,n=[0,0];for(const i of k.PLAYERS){const s=t.queenBeeLocation(i);s.isPresent()&&(n[i.value]=t.numberOfNeighbors(s.get()))}return 6===n[0]&&6===n[1]?_e.DRAW:6===n[0]?_e.getVictory(k.ONE):6===n[1]?_e.getVictory(k.ZERO):_e.ONGOING}}u(C2,"singleton",g.empty());class jdt extends fr{getMetrics(e){return[this.queenBeeMobility(e.gameState,k.ZERO),this.queenBeeMobility(e.gameState,k.ONE)]}queenBeeMobility(e,t){const n=e.queenBeeLocation(t);return n.isPresent()?C2.get().getPossibleMovesFrom(e,n.get()).size():0}}class Rce extends Un{getListMoves(e){const t=this.getListDrops(e.gameState),n=this.getListOfOnBoardMoves(e.gameState),i=t.concat(n);return 0===i.length?[v2.PASS]:i}getListOfOnBoardMoves(e){return C2.get().getPossibleMovesOnBoard(e).toList()}getListDrops(e){const t=[],n=e.getCurrentPlayer(),i=new n2(n,"QueenBee");for(const s of C2.get().getPossibleDropLocations(e))if(C2.get().mustPlaceQueenBee(e))t.push(v2.drop(i,s));else for(const o of e.remainingPieces.getPlayerPieces(e.getCurrentPlayer()))t.push(v2.drop(o,s));return t}}const Gc=new n2(k.ZERO,"QueenBee"),k0=new n2(k.ZERO,"Beetle"),Cu=new n2(k.ZERO,"Grasshopper"),yC=new n2(k.ZERO,"Spider"),MC=new n2(k.ZERO,"SoldierAnt"),x0=new n2(k.ONE,"QueenBee"),_o=new n2(k.ONE,"Beetle"),BL=new n2(k.ONE,"Grasshopper"),UL=new n2(k.ONE,"Spider"),Vd=new n2(k.ONE,"SoldierAnt");class zce extends Zn{constructor(...e){super(...e),u(this,"tutorial",[q.informational($localize`Hive`,$localize`Hive is a game without a board, where pieces are placed on the side of each other, in a contiguous block called the hive. Each player has 11 pieces, representing various insects.`,hi.fromRepresentation([[[x0],[_o],[UL],[Cu]],[[Cu],[],[MC],[]],[[MC],[],[],[]]],8)),q.informational($localize`Object of the game`,$localize`The object of the game at Hive is to surround the opponent's queen. Once the queen is surrounded by 6 pieces, no matter the owner of these pieces, the game ends. The player with a queen that is not surrounded wins. In case both queens are fully surrounded at the same turn, it is a draw. Here, Dark won.`,hi.fromRepresentation([[[],[_o],[yC]],[[Vd],[x0],[Gc]],[[Cu],[k0],[]]],7)),q.anyMove($localize`Placing the first and second piece`,$localize`There are two types of actions: drops and moves. Initially, the board is empty, so we will have to put (drop) pieces on the board. For the first piece dropped on the board, there is no placement restriction: you can choose any piece and put in on the board. The second piece, put by Light, will need to be put in a neighboring space of the first piece. To drop a piece on the board, select the piece of your choice in your remaining pieces (below the board), and then click on the space you want to drop it on.<br/><br/>You're playing Dark and starting the game, put any piece on the board.`,hi.getInitialState(),v2.drop(k0,new C(0,0)),$localize`Congratulations!`),q.anyMove($localize`Placing pieces after the second turn`,$localize`After the second turn, you are still allowed to place pieces any time you want, as long as you respect two conditions: <ol><li>your piece must be connected to the hive, and</li><li>the space on which you drop your piece must not touch a stack of the opponent.</li></ol><br/><br/>You're playing Dark, drop a piece on the board.`,hi.fromRepresentation([[[_o],[Cu]]],2),v2.drop(Gc,new C(2,0)),$localize`Congratulations!`),q.fromMove($localize`Moving pieces: the queen bee`,$localize`Once you have placed you queen bee on the board, you can move your pieces. You must place your queen bee on the board as your fourth piece at the latest. Each creature moves in a different way, and moves should respect two restrictions:<ol><li>the hive must always remain fully connected, and</li><li>pieces should be able to physically slide to their destination (except for the beetle and grasshopper as we will see later).</li></ol>The queen bee can move to any of its empty neighbors. To move a piece, click on it and then click on its destination. The possible destinations are highlighted.<br/><br/>You are playing Dark, move your queen bee.`,hi.fromRepresentation([[[],[yC],[BL],[x0],[_o]],[[_o],[Gc],[k0],[],[]]],4),[v2.move(new C(1,1),new C(0,2)).get(),v2.move(new C(1,1),new C(1,2)).get()],$localize`Congratulations!`,$localize`Failed. Try again.`),q.fromMove($localize`Moving the beetle`,$localize`The beetle moves like the queen bee, but it is allowed to climb on top of other pieces! Therefore, it need not adhere to the sliding restriction. Note that you are not allowed to drop the beetle on top of another piece in the drop phase, this can only be achieved when moving a beetle already on the board. A piece with a beetle on top is not allowed to move. A stack is considered to be of the player who has the beetle of the top.<br/><br/>You're playing Dark, block your opponent's queen by moving on top of it!`,hi.fromRepresentation([[[Gc],[x0],[k0]],[[_o],[],[]]],6),[v2.move(new C(2,0),new C(1,0)).get()],$localize`Congratulations!`,$localize`Failed. Try again.`),q.forClick($localize`Inspecting stacks`,$localize`When pieces are stacked together, you are allowed to inspect the stack to see which pieces are under the beetle. This works with opponent-controlled stacks too. To do so, you can simply click on any stack to see their composition.<br/><br/>You're playing Dark and your opponent has a beetle on top of one of your piece, click on it.`,hi.fromRepresentation([[[_o,Gc],[x0],[k0]]],2),["#piece_0_0"],$localize`Congratulations!`,$localize`Failed. Try again.`),q.fromMove($localize`Moving the grasshopper`,$localize`The grasshopper jumps over one or more pieces in a straight line, and stops at the first empty space encountered. It cannot jump over empty spaces, and can only move through jumps. Because it jumps, it does not adhere to the sliding restriction.<br/><br/>You're playing Dark. Jump over three pieces with your grasshopper!`,hi.fromRepresentation([[[Cu],[Gc],[_o],[Vd]],[[BL],[],[],[]]],6),[v2.move(new C(0,0),new C(4,0)).get()],$localize`Congratulations!`,$localize`Failed. Try again.`),q.fromPredicate($localize`Moving the soldier ant`,$localize`The soldier ant is a powerful piece: it can move anywhere in the hive as long as it respects the sliding and the one hive restrictions!<br/><br/>You're playing Dark. Your queen bee is stuck, move your soldier ant to free up your queen!`,hi.fromRepresentation([[[],[MC],[x0]],[[],[Gc],[_o]],[[Vd],[UL],[]]],6),v2.move(new C(1,0),new C(3,1)).get(),(t,n,i)=>t.equals(v2.move(new C(1,0),new C(0,1)).get())?b.failure($localize`You have not freed your queen, try again!`):b.SUCCESS,$localize`Congratulations!`),q.anyMove($localize`Moving the spider`,$localize`Finally, the spider can move exactly 3 spaces at a time. It is not allowed to go twice through the same space in a move. As the spider crawls around other pieces, it can only move around pieces that are in direct contact with it. This means that the spider is not allowed to temporarily split the hive. For example, here, Dark's spider cannot go on the left as its first move. To do a spider move, select a spider and click on the three spaces that compose the move.<br/><br/>You're playing Dark, move your spider!`,hi.fromRepresentation([[[],[yC],[UL],[_o]],[[],[],[],[k0]],[[_o],[],[],[Vd]],[[MC],[],[Cu],[]],[[Gc],[BL],[],[]]],6),v2.spiderMove([new C(1,0),new C(1,1),new C(2,1),new C(2,2)]),$localize`Congratulations!`),q.informational($localize`Restrictions`,$localize`Let us clarify the two restrictions during moves.<ol><li>All pieces of the hive should always be connected in a way that there is a single hive. It can be the case that your piece disconnects from the hive when you slide it, but after the move there should be only one hive.</li><li>Except grasshoppers and beetles, all moves should be done by sliding the piece without disturbing the rest of the hive.</li></ol>Observe here how the queen bee is stuck, as it is not possible to slide it without moving one of the other pieces. Moreover, moving it would split the hive in two.`,hi.fromRepresentation([[[],[yC],[]],[[],[Gc],[_o]],[[Vd],[],[]]],6)),q.informational($localize`Passing your turn`,$localize`Finally, it is possible that you are not able to do any move: when it is the case, you must pass your turn. Here, Dark must pass: the queen bee cannot move without disconnecting the hive, the beetle is stuck beneath another beetle, and a dropped piece would be in contact with an opponent's piece.`,hi.fromRepresentation([[[_o,k0],[Gc],[x0]]],4))])}}const Zdt=["app-hive-piece",""];function Ydt(r,e){1&r&&(N(),F(0,"path",9))}function Kdt(r,e){1&r&&(N(),F(0,"path",10))}function Xdt(r,e){1&r&&(N(),F(0,"path",11))}function Qdt(r,e){1&r&&(N(),F(0,"path",12))}function Jdt(r,e){1&r&&(N(),F(0,"path",13))}let eht=(()=>{var r;class e extends _ae{constructor(...n){super(...n),u(this,"piece",void 0),u(this,"x",void 0),u(this,"y",void 0),u(this,"hexaLayout",void 0),u(this,"layer",void 0),u(this,"pieceHeight",void 0),u(this,"hexaPoints",""),u(this,"pieceClass",""),u(this,"isoPointsLight",""),u(this,"isoPointsDark",""),u(this,"isoPointsStroke",""),u(this,"layerTransform",""),u(this,"hexaCenter",new C(0,0))}ngAfterContentChecked(){const n=new C(this.x,this.y);this.pieceClass=this.getPlayerClass(this.piece.owner),this.hexaPoints=this.hexaLayout.getHexaPointsAt(n),this.hexaCenter=this.hexaLayout.getCenterAt(n);const s=this.hexaLayout.getIsoPoints(n,this.pieceHeight).map(o=>o.map(a=>a.toSVGPoint()).join(" "));this.isoPointsLight=s[0],this.isoPointsDark=s[1],this.isoPointsStroke=s[2],this.layerTransform=`translate(0 -${(this.layer+1)*this.pieceHeight})`}}return r=e,u(e,"\u0275fac",function(){let t;return function(i){return(t||(t=or(r)))(i||r)}}()),u(e,"\u0275cmp",qe({type:r,selectors:[["","app-hive-piece",""]],inputs:{piece:"piece",x:"x",y:"y",hexaLayout:"hexaLayout",layer:"layer",pieceHeight:"pieceHeight"},features:[Qe],attrs:Zdt,decls:11,vars:14,consts:[[1,"base","no-stroke","lighter",3,"ngClass"],[1,"base","no-stroke","darker",3,"ngClass"],[1,"base","no-fill","small-stroke"],[1,"base","small-stroke",3,"ngClass"],["d","M 15.3841 1.25408 C 22.8728 -1.82428 29.9895 -8.66692 29.9895 -11.9438 C 29.9895 -12.8799 29.4656 -13.6136 28.5873 -13.906 C 27.8046 -14.1664 24.6195 -14.3188 14.4763 -7.04548 C 14.3844 -7.97908 13.9844 -8.82172 13.3836 -9.47812 C 13.4167 -9.58096 13.4394 -9.6886 13.4394 -9.80284 C 13.4394 -13.1571 9.49688 -15.9237 3.91664 -16.864 C 3.97556 -18.4007 4.88768 -22.8456 12.8845 -26.8437 C 13.4073 -27.1052 13.6191 -27.7406 13.3578 -28.2634 C 13.0953 -28.7862 12.4609 -28.9971 11.938 -28.7367 C 3.34424 -24.4397 1.97336 -19.361 1.81856 -17.1244 C 1.12448 -17.1802 0.41168 -17.2094 -0.31564 -17.2094 C -1.40548 -17.2094 -2.46052 -17.1422 -3.47128 -17.0189 C -3.59032 -19.1981 -4.86616 -24.371 -13.5975 -28.7366 C -14.1203 -28.997 -14.7548 -28.7861 -15.0172 -28.2633 C -15.2787 -27.7404 -15.0668 -27.1049 -14.5439 -26.8436 C -6.16912 -22.6568 -5.56468 -17.9801 -5.57296 -16.6665 C -10.6046 -15.5753 -14.0706 -12.9474 -14.0706 -9.8026 C -14.0706 -9.68836 -14.048 -9.58072 -14.0146 -9.47788 C -14.6715 -8.76052 -15.0833 -7.81948 -15.121 -6.78208 C -25.5504 -14.3201 -28.8038 -14.17 -29.5978 -13.9058 C -30.4761 -13.6134 -31 -12.8799 -31 -11.9438 C -31 -8.63464 -23.7414 -1.68868 -16.1718 1.3442 C -23.7414 4.3772 -31 11.3233 -31 14.6323 C -31 15.5684 -30.4761 16.3021 -29.5968 16.5955 C -29.4222 16.6533 -29.1701 16.7371 -28.7516 16.7371 C -27.2727 16.7371 -23.7153 15.6854 -14.1678 8.74748 C -13.8431 9.143 -13.5125 9.47624 -13.0664 9.73316 C -12.821 16.1545 -7.58992 21.3656 -1.50604 21.892 L -1.50604 27.23 C -1.50604 27.8149 -1.03276 28.288 -0.448 28.288 C 0.13688 28.288 0.61004 27.8148 0.61004 27.23 L 0.61004 21.892 C 6.95852 21.3656 12.0572 16.1545 12.3026 9.73316 C 12.7614 9.46892 13.1995 9.12296 13.5294 8.71304 C 23.1112 15.6825 26.6942 16.738 28.1769 16.738 C 28.5964 16.738 28.8579 16.6533 29.0335 16.5944 C 29.9118 16.302 30.4398 15.5684 30.4398 14.6322 C 30.44 11.2893 23.0366 4.23644 15.3841 1.25408 Z M -28.8921 -11.9096 C -27.3192 -12.3306 -20.102 -7.90708 -13.9077 -3.24676 C -14.6109 -2.53432 -15.059 -1.57444 -15.1169 -0.51196 C -23.053 -3.54004 -29.0001 -10.3224 -28.8921 -11.9096 Z M -15.1288 6.06848 C -15.1288 6.31232 -15.1035 6.55004 -15.0636 6.78248 C -22.932 12.527 -27.6682 14.8687 -28.8932 14.593 C -28.9924 12.9306 -22.5395 5.64788 -14.1152 2.8394 C -14.0278 2.81048 -13.9496 2.76812 -13.8756 2.72 C -13.8144 2.78096 -13.7488 2.837 -13.6838 2.89412 C -14.5674 3.67016 -15.1288 4.80368 -15.1288 6.06848 Z M 27.8827 -11.9055 C 27.9772 -10.3347 22.2198 -3.74764 14.4784 -0.65668 C 14.3818 -1.74316 13.8714 -2.71012 13.1071 -3.40516 C 19.2103 -7.978 26.2028 -12.271 27.8827 -11.9055 Z M -0.31564 -15.0932 C 5.65928 -15.0932 10.0551 -12.9976 11.0895 -10.7981 C 10.8201 -10.8519 10.5422 -10.9012 10.257 -10.9012 L -10.8881 -10.9012 C -11.1731 -10.9012 -11.4513 -10.8519 -11.7207 -10.7981 C -10.6866 -12.9976 -6.29056 -15.0932 -0.31564 -15.0932 Z M -0.31564 19.7833 C -5.79256 19.7833 -10.3106 15.551 -10.8432 10.2606 L 10.2122 10.2606 C 9.67952 15.5509 5.16128 19.7833 -0.31564 19.7833 Z M 10.257 8.14436 L -10.8881 8.14436 C -12.0599 8.14436 -13.0126 7.1948 -13.0126 6.02816 C -13.0126 4.86152 -12.0599 3.91196 -10.8881 3.91196 L 10.257 3.91196 C 11.4286 3.91196 12.3813 4.86152 12.3813 6.02816 C 12.3813 7.1948 11.4286 8.14436 10.257 8.14436 Z M 10.257 1.79588 L -10.8881 1.79588 C -12.0599 1.79588 -13.0126 0.84632 -13.0126 -0.32032 C -13.0126 -1.48696 -12.0599 -2.43652 -10.8881 -2.43652 L 10.257 -2.43652 C 11.4286 -2.43652 12.3813 -1.48696 12.3813 -0.32032 C 12.3813 0.84632 11.4286 1.79588 10.257 1.79588 Z M 10.257 -4.5526 L -10.8881 -4.5526 C -12.0599 -4.5526 -13.0126 -5.50216 -13.0126 -6.6688 C -13.0126 -7.83544 -12.0599 -8.785 -10.8881 -8.785 L 10.257 -8.785 C 11.4286 -8.785 12.3813 -7.83544 12.3813 -6.6688 C 12.3813 -5.50216 11.4286 -4.5526 10.257 -4.5526 Z M 28.3363 14.5982 C 27.2038 14.8942 22.4127 12.5611 14.4402 6.73292 C 14.4745 6.51596 14.4975 6.29504 14.4975 6.06848 C 14.4975 4.8038 13.9364 3.67028 13.0527 2.89424 C 13.1287 2.82764 13.2044 2.7602 13.2751 2.68832 C 13.3609 2.75036 13.4539 2.80436 13.5592 2.8394 C 21.9908 5.651 28.4488 12.945 28.3363 14.5982 Z",4,"ngIf"],["d","M 27.079 1.30667 L 15.7412 -4.79822 L 15.7412 -7.89145 C 15.7412 -8.39311 15.335 -8.80033 14.8324 -8.80033 L 12.1056 -8.80033 L 12.1056 -9.70918 C 12.1056 -10.4088 12.0442 -11.0941 11.927 -11.7605 L 17.9173 -14.3278 C 18.2517 -14.4705 18.4681 -14.7995 18.4681 -15.1622 L 18.4681 -25.1602 L 23.9215 -25.1602 C 24.4242 -25.1602 24.8304 -25.5674 24.8304 -26.0691 C 24.8304 -26.5718 24.4242 -26.978 23.9215 -26.978 L 17.5592 -26.978 C 17.0566 -26.978 16.6503 -26.5718 16.6503 -26.0691 L 16.6503 -15.7621 L 11.4679 -13.5404 C 10.6322 -15.9716 9.02444 -18.0467 6.93872 -19.4717 C 7.86471 -20.1312 8.47025 -21.2128 8.47025 -22.4339 C 8.47025 -24.439 6.83966 -26.0695 4.83465 -26.0695 C 4.33202 -26.0695 3.92577 -25.6623 3.92577 -25.1607 C 3.92577 -24.659 4.33202 -24.2518 4.83465 -24.2518 C 5.83716 -24.2518 6.65252 -23.4366 6.65252 -22.4339 C 6.65252 -21.4314 5.83726 -20.6161 4.83465 -20.6161 L 4.83336 -20.616 C 3.43401 -21.2012 1.89916 -21.525 0.290076 -21.525 C -1.31901 -21.525 -2.85386 -21.2012 -4.25324 -20.616 L -4.2545 -20.6161 C -5.257 -20.6161 -6.07236 -21.4313 -6.07236 -22.4339 C -6.07236 -23.4365 -5.25711 -24.2518 -4.2545 -24.2518 C -3.75186 -24.2518 -3.34563 -24.659 -3.34563 -25.1607 C -3.34563 -25.6623 -3.75186 -26.0695 -4.2545 -26.0695 C -6.25961 -26.0695 -7.89009 -24.4389 -7.89009 -22.4339 C -7.89009 -21.2127 -7.28459 -20.1312 -6.35856 -19.4717 C -8.44428 -18.0467 -10.0521 -15.9716 -10.8877 -13.5404 L -16.0702 -15.7621 L -16.0702 -26.0691 C -16.0702 -26.5718 -16.4764 -26.978 -16.979 -26.978 L -23.3419 -26.978 C -23.8445 -26.978 -24.2508 -26.5718 -24.2508 -26.0691 C -24.2508 -25.5674 -23.8445 -25.1602 -23.3419 -25.1602 L -17.8884 -25.1602 L -17.8884 -15.1622 C -17.8884 -14.7995 -17.6721 -14.4705 -17.3377 -14.3278 L -11.3474 -11.7605 C -11.4646 -11.0941 -11.526 -10.4086 -11.526 -9.70917 L -11.526 -8.80033 L -14.2527 -8.80033 C -14.7554 -8.80033 -15.1616 -8.3931 -15.1616 -7.89145 L -15.1616 -4.79822 L -26.4994 1.30667 C -26.9411 1.54388 -27.1074 2.09561 -26.8693 2.53732 C -26.7047 2.84269 -26.3912 3.01546 -26.0677 3.01546 C -25.9223 3.01546 -25.775 2.98095 -25.6378 2.90639 L -15.1617 -2.73463 L -15.1617 5.31601 L -20.2889 9.58867 C -20.6025 9.85047 -20.7034 10.2904 -20.5334 10.663 L -16.1815 20.2374 L -19.5862 26.1962 C -19.8362 26.6316 -19.6845 27.1869 -19.2482 27.4359 C -19.1064 27.5177 -18.951 27.5559 -18.7983 27.5559 C -18.4819 27.5559 -18.1757 27.3913 -18.0085 27.0978 L -14.3729 20.7354 C -14.2283 20.4818 -14.2138 20.1747 -14.3347 19.9084 L -18.5921 10.5411 L -15.1618 7.68295 L -15.1618 8.46881 C -15.1618 16.989 -8.23053 23.9203 0.28965 23.9203 C 8.80982 23.9203 15.7411 16.989 15.7411 8.46881 L 15.7411 7.68295 L 19.1714 10.5411 L 14.9141 19.9084 C 14.7932 20.1747 14.8078 20.4819 14.9522 20.7354 L 18.5878 27.0978 C 18.755 27.3913 19.0614 27.5559 19.3776 27.5559 C 19.5303 27.5559 19.6857 27.5177 19.8275 27.4359 C 20.2638 27.1869 20.4155 26.6316 20.1656 26.1962 L 16.7608 20.2374 L 21.1127 10.663 C 21.2827 10.2903 21.1817 9.85037 20.8681 9.58867 L 15.741 5.31601 L 15.741 -2.73463 L 26.2171 2.90639 C 26.3544 2.98095 26.5016 3.01546 26.647 3.01546 C 26.9705 3.01546 27.2841 2.8428 27.4486 2.53732 C 27.687 2.09561 27.5207 1.54398 27.079 1.30667 Z M -9.70827 -9.70928 C -9.70827 -15.2218 -5.22281 -19.7073 0.289757 -19.7073 C 5.80234 -19.7073 10.2878 -15.2219 10.2878 -9.70928 L 10.2878 -8.80044 L -9.70827 -8.80044 Z M -10.6171 -6.98257 L 11.1966 -6.98257 L 13.9234 -6.98257 L 13.9234 -4.26531 C 13.9233 -4.25796 13.9233 -4.25065 13.9234 -4.24316 L 13.9234 -3.87835 L 0.289757 3.79022 L -13.3439 -3.87835 L -13.3439 -4.24316 C -13.3438 -4.25051 -13.3438 -4.25786 -13.3439 -4.26531 L -13.3439 -6.98257 Z M -13.3439 8.46892 L -13.3439 5.74091 L -13.3439 5.73461 L -13.3439 -1.79295 L -0.619115 5.36501 L -0.619115 22.0715 C -7.71446 21.6021 -13.3439 15.681 -13.3439 8.46892 Z M 1.19863 22.0715 L 1.19863 5.36501 L 13.9234 -1.79295 L 13.9234 5.73471 L 13.9234 5.7408 L 13.9234 8.46902 C 13.9234 15.681 8.29409 21.6021 1.19863 22.0715 Z",4,"ngIf"],["d","M 23.1993 15.5733 C 21.3366 14.109 18.3446 11.7414 17.7296 11.2169 C 12.9652 2.64827 6.39655 -0.814228 5.07856 -1.44294 C 5.33756 -1.88486 5.4918 -2.35409 5.4918 -2.83719 C 5.4918 -3.30048 5.3294 -3.93486 5.04265 -5.01624 C 4.8512 -5.73792 4.63024 -6.57068 4.49294 -7.31486 C 4.59374 -7.31187 4.69419 -7.30891 4.79464 -7.30891 C 8.94543 -7.30891 12.7535 -9.75455 12.9341 -9.87229 C 13.1714 -10.0271 13.3373 -10.2703 13.3943 -10.5478 C 13.451 -10.8255 13.3949 -11.1144 13.2379 -11.3502 L 11.5052 -13.9494 C 13.7039 -15.6498 16.0931 -16.5487 16.1187 -16.5583 C 16.6686 -16.7613 16.9498 -17.3717 16.7467 -17.9216 C 16.5433 -18.4713 15.9332 -18.7522 15.3835 -18.5494 C 15.2491 -18.4996 12.0538 -17.304 9.38881 -14.9538 C 8.99075 -14.6026 8.91323 -14.0109 9.20786 -13.5691 L 10.8409 -11.1198 C 9.64329 -10.4953 7.44869 -9.53254 5.16354 -9.43858 C 5.21814 -9.64602 5.24334 -9.83818 5.25069 -10.0066 C 5.28989 -10.9199 4.88588 -11.8072 4.04914 -12.6442 C 3.74954 -12.9441 3.51227 -13.3816 3.26136 -13.8449 C 2.98206 -14.3609 2.65176 -14.9693 2.15511 -15.4578 C 2.8653 -18.087 7.91209 -26.8789 12.9465 -30.2572 C 13.4331 -30.5838 13.5628 -31.2431 13.2359 -31.7297 C 12.909 -32.2165 12.2501 -32.3464 11.7633 -32.0197 C 6.51594 -28.4984 1.39127 -19.8963 0.213976 -16.338 C 0.113176 -16.3457 0.00992607 -16.351 -0.0975239 -16.351 C -0.204974 -16.351 -0.308574 -16.3457 -0.409374 -16.338 C -1.58669 -19.8963 -6.71146 -28.4984 -11.9586 -32.0197 C -12.4453 -32.3465 -13.1048 -32.2168 -13.4313 -31.7297 C -13.7575 -31.2431 -13.6283 -30.5836 -13.1415 -30.2572 C -8.10712 -26.8789 -3.0603 -18.087 -2.35008 -15.4578 C -2.8469 -14.9693 -3.17709 -14.3609 -3.45639 -13.8449 C -3.70734 -13.3816 -3.94429 -12.9441 -4.24417 -12.6442 C -5.08116 -11.8072 -5.48531 -10.9199 -5.44569 -10.0066 C -5.43869 -9.83861 -5.41034 -9.64675 -5.35889 -9.43985 C -7.63784 -9.53621 -9.83525 -10.4982 -11.0349 -11.1215 L -9.4031 -13.5691 C -9.1084 -14.0109 -9.18575 -14.6025 -9.58405 -14.9538 C -12.249 -17.304 -15.4439 -18.4998 -15.5787 -18.5494 C -16.1283 -18.7529 -16.7389 -18.4714 -16.9419 -17.9216 C -17.1453 -17.3717 -16.8639 -16.7614 -16.3139 -16.5583 C -16.2894 -16.5485 -13.9065 -15.6578 -11.7003 -13.9495 L -13.4331 -11.3502 C -13.5903 -11.1144 -13.6466 -10.8255 -13.5896 -10.5478 C -13.5325 -10.2702 -13.3666 -10.027 -13.1294 -9.87229 C -12.9485 -9.75455 -9.14095 -7.30891 -4.98985 -7.30891 C -4.8894 -7.30891 -4.7886 -7.31201 -4.68815 -7.31486 C -4.82535 -6.57068 -5.04669 -5.73792 -5.23789 -5.01624 C -5.52454 -3.93472 -5.68701 -3.30048 -5.68701 -2.8372 C -5.68701 -2.35409 -5.53301 -1.885 -5.27377 -1.44294 C -6.59176 -0.814515 -13.1606 2.64715 -17.9248 11.2169 C -18.5398 11.7414 -21.5318 14.109 -23.3946 15.5733 C -23.8553 15.9355 -23.9353 16.6027 -23.5731 17.0635 C -23.3638 17.3299 -23.0524 17.4689 -22.7381 17.4689 C -22.5085 17.4689 -22.2773 17.3949 -22.0829 17.2419 C -16.329 12.7187 -16.2836 12.636 -16.1484 12.3905 C -12.7212 6.15479 -8.19525 2.75469 -5.81882 1.2894 L -6.09532 2.62182 C -6.25842 3.40845 -6.37112 4.19975 -6.43447 4.99303 C -6.63957 5.8207 -7.95109 11.2654 -7.95109 15.2755 L -7.95109 28.8035 C -7.95109 30.0442 -6.94176 31.0534 -5.6958 31.0534 C -4.54097 31.0534 -3.57917 30.1874 -3.45818 29.0391 L -3.23488 26.9188 L -2.46904 31.3227 C -2.26779 32.4787 -1.27065 33.3177 -0.0974189 33.3177 C 1.07582 33.3177 2.07325 32.4787 2.27422 31.3229 L 3.04019 26.9189 L 3.26349 29.0391 C 3.38389 30.1876 4.34632 31.0536 5.50647 31.0536 C 6.74711 31.0536 7.75644 30.0442 7.75644 28.8036 L 7.75644 15.2757 C 7.75644 11.2658 6.4452 5.82155 6.23979 4.99331 C 6.17609 4.20003 6.06374 3.40873 5.90029 2.62196 L 5.62274 1.2836 C 7.99413 2.73998 12.5115 6.12819 15.9537 12.391 C 16.0888 12.6363 16.1339 12.719 21.888 17.2422 C 22.0826 17.395 22.3137 17.4692 22.5432 17.4692 C 22.8578 17.4692 23.1687 17.3302 23.3782 17.0637 C 23.7406 16.6029 23.6603 15.9355 23.1997 15.5733 Z M -0.0974189 -0.50221 C -1.23145 -0.50221 -3.5643 -2.07335 -3.5643 -2.83621 C -3.5608 -3.05937 -3.34415 -3.87585 -3.18616 -4.47201 C -2.94361 -5.38656 -2.65811 -6.46286 -2.51829 -7.43599 L 2.32336 -7.43599 C 2.46301 -6.46286 2.74857 -5.38656 2.99126 -4.47201 C 3.14946 -3.87585 3.36587 -3.0595 3.3694 -2.83706 C 3.36958 -2.07335 1.03665 -0.50221 -0.0973489 -0.50221 Z M -2.74316 -11.143 C -2.22485 -11.6614 -1.88748 -12.2843 -1.58991 -12.834 C -1.01925 -13.8877 -0.777679 -14.2284 -0.0976289 -14.2284 C 0.582456 -14.2284 0.824166 -13.8878 1.39474 -12.834 C 1.69259 -12.2843 2.02964 -11.6614 2.54799 -11.143 C 2.93554 -10.7554 3.14232 -10.3845 3.1299 -10.0984 C 3.1229 -9.90554 3.00985 -9.71847 2.8709 -9.55872 L -3.06667 -9.55872 C -3.20527 -9.71849 -3.31727 -9.90557 -3.32532 -10.0984 C -3.33582 -10.3844 -3.13072 -10.7553 -2.74341 -11.143 Z M -5.5692 28.8171 C -5.5762 28.882 -5.63045 28.931 -5.7015 28.931 C -5.7715 28.931 -5.8289 28.8738 -5.8289 28.8036 L -5.8289 15.2757 C -5.8289 14.5074 -5.7743 13.6716 -5.6868 12.8224 L -4.56484 19.2736 Z M 0.182861 30.9593 C 0.158361 31.0959 0.0411111 31.1951 -0.0974889 31.1951 C -0.236439 31.1951 -0.354039 31.0959 -0.377839 30.9592 L -4.12024 9.4401 C -4.36139 8.05221 -4.42929 6.65441 -4.32604 5.26327 C -4.32334 5.23737 -4.32254 5.21161 -4.32254 5.18602 C -4.26619 4.47255 -4.16574 3.76092 -4.01909 3.05339 L -3.46252 0.371859 C -2.71761 0.872219 -1.89235 1.25047 -1.1611 1.45324 L -1.1611 19.804 C -1.1611 20.3903 -0.685909 20.8653 -0.0997989 20.8653 C 0.486346 20.8653 0.961506 20.3903 0.961506 19.804 L 0.961506 1.4531 C 1.6928 1.25045 2.51806 0.872079 3.26293 0.371716 L 3.8195 3.05325 C 3.96615 3.76078 4.06695 4.47241 4.12295 5.18588 C 4.12407 5.21178 4.12617 5.2374 4.12645 5.26313 C 4.2297 6.65413 4.1618 8.05193 3.92065 9.43996 Z M 5.63355 28.8035 C 5.63355 28.8737 5.57615 28.9309 5.50055 28.9309 C 5.4351 28.9309 5.38085 28.8819 5.3742 28.8168 L 4.36967 19.2735 L 5.49166 12.8221 C 5.57951 13.6713 5.63376 14.5072 5.63376 15.2754 Z",4,"ngIf"],["d","M 26.2796 -9.91591 C 26.0694 -10.4424 25.4717 -10.6985 24.9452 -10.488 L 13.9952 -6.10798 C 13.8372 -6.04429 13.6972 -5.94331 13.588 -5.8123 L 8.42091 0.388326 L 4.52341 0.388326 L 8.59528 -4.49777 C 8.68702 -4.60766 8.75434 -4.73537 8.79361 -4.87289 L 13.1189 -20.0116 L 20.6616 -29.7097 C 21.0095 -30.1573 20.9295 -30.8021 20.4821 -31.1502 C 20.0347 -31.498 19.3896 -31.4175 19.0416 -30.9702 L 11.3767 -21.1152 C 11.2958 -21.0115 11.2364 -20.8935 11.1998 -20.7668 L 6.87935 -5.64532 L 3.30485 -1.35594 C 3.18605 -2.00651 2.8709 -2.58958 2.42256 -3.04056 L 3.25011 -4.69564 C 3.50388 -5.20275 3.29829 -5.81939 2.79124 -6.07303 C 2.28436 -6.3268 1.66762 -6.12088 1.41399 -5.6137 L 0.587006 -3.95974 C 0.441806 -3.97954 0.292976 -3.99472 0.142034 -3.99472 C -0.00910632 -3.99472 -0.157276 -3.98812 -0.302971 -3.95974 L -1.12991 -5.6137 C -1.38335 -6.12068 -2.00005 -6.32611 -2.50716 -6.07303 C -3.01427 -5.81926 -3.21983 -5.20292 -2.96599 -4.69564 L -2.13845 -3.04056 C -2.58676 -2.58938 -2.90151 -2.00667 -3.02074 -1.35594 L -6.5952 -5.64532 L -10.9158 -20.7666 C -10.9547 -20.8928 -11.0118 -21.0109 -11.0926 -21.1151 L -18.7576 -30.97 C -19.1055 -31.4177 -19.7506 -31.4983 -20.198 -31.15 C -20.6454 -30.802 -20.7262 -30.157 -20.3785 -29.7096 L -12.8358 -20.0115 L -8.51046 -4.87279 C -8.47152 -4.73518 -8.40354 -4.6078 -8.31213 -4.49768 L -4.24022 0.388425 L -8.13769 0.388425 L -13.3048 -5.81223 C -13.4137 -5.94324 -13.554 -6.04521 -13.7121 -6.10791 L -24.6622 -10.4879 C -25.1888 -10.6981 -25.7861 -10.4401 -25.9966 -9.91598 C -26.2072 -9.38953 -25.9488 -8.7922 -25.4248 -8.58156 L -14.7158 -4.29806 L -9.4072 2.07245 C -9.21217 2.30642 -8.92325 2.44211 -8.61853 2.44211 L -4.49492 2.44211 L -10.118 4.85187 C -10.2909 4.92612 -10.4398 5.04591 -10.5486 5.199 L -16.0236 12.8639 C -16.0985 12.9686 -16.153 13.0867 -16.1843 13.2114 L -17.2793 17.5914 C -17.4169 18.1415 -17.0823 18.6989 -16.5324 18.8364 C -16.4489 18.8562 -16.365 18.8714 -16.2825 18.8714 C -15.8228 18.8714 -15.4041 18.5596 -15.2875 18.0936 L -14.2397 13.9027 L -9.04496 6.63014 L -3.91861 4.43304 C -4.18822 4.70496 -4.4401 4.99859 -4.67127 5.31067 L -10.4723 11.6784 C -10.5927 11.811 -10.6762 11.9724 -10.7155 12.1472 L -12.9055 22.0021 C -12.9286 22.117 -12.9404 22.2354 -12.9253 22.3524 L -11.8303 31.1123 C -11.7653 31.6316 -11.3231 32.0116 -10.8129 32.0116 C -10.7697 32.0116 -10.7275 32.009 -10.6842 32.005 C -10.1217 31.9347 -9.72255 31.4215 -9.79287 30.8589 L -10.8659 22.2755 L -8.77373 12.8608 L -6.36268 10.2144 C -6.34288 13.6592 -3.66998 19.968 0.138371 19.968 C 3.94677 19.968 6.62264 13.6592 6.6395 10.2144 L 9.05055 12.8608 L 11.1426 22.2755 L 10.0697 30.8589 C 9.99943 31.4215 10.3981 31.9346 10.961 32.005 C 11.0042 32.0083 11.0468 32.0116 11.0897 32.0116 C 11.6 32.0116 12.0421 31.6318 12.1071 31.1123 L 13.2021 22.3524 C 13.2186 22.2352 13.2087 22.1171 13.1856 22.0021 L 10.9956 12.1472 C 10.9566 11.9726 10.8728 11.8106 10.7524 11.6784 L 4.95135 5.31067 C 4.72002 4.99849 4.46804 4.70499 4.19869 4.43304 L 9.32498 6.63014 L 14.5198 13.9027 L 15.5676 18.0936 C 15.6841 18.5601 16.1027 18.8714 16.5626 18.8714 C 16.6451 18.8714 16.729 18.8648 16.8124 18.8364 C 17.3625 18.6988 17.6969 18.1415 17.5594 17.5914 L 16.4644 13.2114 C 16.4294 13.0867 16.3789 12.9686 16.3037 12.8639 L 10.8287 5.199 C 10.7198 5.04621 10.5707 4.92609 10.3981 4.85187 L 4.77501 2.44211 L 8.89863 2.44211 C 9.20289 2.44211 9.49223 2.30681 9.68729 2.07245 L 14.9959 -4.29806 L 25.7048 -8.58156 C 26.2309 -8.7921 26.4871 -9.38969 26.2765 -9.91604 Z M 3.32851 6.55639 C 3.33511 6.56299 3.34831 6.57949 3.35491 6.59533 C 3.44038 6.71413 3.52189 6.83623 3.6001 6.9615 L -3.31728 6.9615 C -3.2394 6.83643 -3.15723 6.71433 -3.07209 6.59533 C -3.06549 6.58873 -3.05229 6.57223 -3.04569 6.55639 C -2.22788 5.4365 -1.08892 4.63183 0.141308 4.63183 C 1.37151 4.63183 2.51044 5.43634 3.32825 6.55639 Z M -4.30682 10.1751 C -4.30682 9.7961 -4.25897 9.40383 -4.16987 9.01166 L 4.45319 9.01166 C 4.54229 9.4036 4.59014 9.79583 4.59014 10.1751 C 4.59014 10.5284 4.5512 10.9222 4.47728 11.3385 L -4.19435 11.3385 C -4.26695 10.9222 -4.30655 10.5285 -4.30655 10.1751 Z M 1.30499 -0.774814 L 1.30499 2.50003 L 1.30499 2.50663 L 1.30499 2.71651 C 0.928325 2.62543 0.540278 2.57461 0.141572 2.57461 C -0.257068 2.57461 -0.645313 2.62543 -1.02187 2.71651 L -1.02187 2.50663 L -1.02187 2.50003 L -1.02187 -0.774814 C -1.02187 -1.4163 -0.499981 -1.93823 0.141572 -1.93823 C 0.783092 -1.93823 1.30499 -1.41623 1.30499 -0.774814 Z M 0.141572 17.9085 C -1.29768 17.9085 -2.79123 15.6796 -3.62943 13.3916 L 3.91268 13.3916 C 3.07435 15.6796 1.58077 17.9085 0.141572 17.9085 Z",4,"ngIf"],["d","M 21.8842 2.21077 L 18.0181 2.21077 L 13.0729 -0.756106 C 12.911 -0.853707 12.7271 -0.904573 12.5381 -0.904573 L 6.18206 -0.904573 C 6.26409 -1.2402 6.30742 -1.58751 6.30742 -1.94298 C 6.30742 -2.35345 6.24815 -2.75236 6.13972 -3.13557 L 10.6647 -4.04062 C 10.9348 -4.09355 11.1726 -4.25344 11.3252 -4.48199 L 15.2411 -10.3555 L 20.0108 -11.3098 C 20.2808 -11.3628 20.5186 -11.5227 20.6712 -11.7512 L 22.7482 -14.8665 C 23.067 -15.3442 22.9382 -15.9892 22.4605 -16.3069 C 21.9817 -16.6267 21.3378 -16.4959 21.0201 -16.0192 L 19.181 -13.2611 L 14.4113 -12.3067 C 14.1413 -12.2538 13.9035 -12.0939 13.7509 -11.8653 L 9.83492 -5.99184 L 5.07504 -5.03946 C 4.8146 -5.33056 4.51767 -5.59756 4.1913 -5.83727 C 6.07121 -6.88908 7.3457 -8.89921 7.3457 -11.2028 L 7.3457 -13.4521 C 7.3457 -13.6801 7.33217 -13.9049 7.30798 -14.1266 C 7.3256 -14.1905 7.33742 -14.257 7.34266 -14.3255 C 7.34788 -14.3889 7.864 -20.6352 11.4996 -20.6352 C 17.0843 -20.6352 17.7053 -29.5377 17.7282 -29.9168 C 17.7635 -30.489 17.3284 -30.9813 16.7572 -31.0175 C 16.1861 -31.057 15.6907 -30.6188 15.6554 -30.0456 C 15.6502 -29.9729 15.0967 -22.7121 11.4996 -22.7121 C 8.14265 -22.7121 6.5767 -19.8132 5.85813 -17.4544 C 5.37949 -18.0105 4.80424 -18.4808 4.15721 -18.8374 C 4.84539 -19.5678 5.26657 -20.5387 5.26462 -21.5875 C 5.28337 -21.8035 5.40896 -23.7278 4.30508 -24.9262 C 3.76306 -25.516 3.01841 -25.8275 2.15341 -25.8275 C 1.57915 -25.8275 1.11501 -25.3623 1.11501 -24.7892 C 1.11501 -24.216 1.57915 -23.7508 2.15341 -23.7508 C 2.51691 -23.7508 2.67681 -23.6282 2.77551 -23.5223 C 3.19194 -23.0727 3.21786 -22.0716 3.19194 -21.6739 C 3.19194 -20.5286 2.2605 -19.597 1.11501 -19.597 L -0.96193 -19.597 C -2.1073 -19.597 -3.03886 -20.5284 -3.043 -21.7601 C -3.07306 -22.135 -3.01185 -23.0986 -2.6245 -23.5203 C -2.52581 -23.6272 -2.3659 -23.7508 -2.00034 -23.7508 C -1.42607 -23.7508 -0.96193 -24.216 -0.96193 -24.7892 C -0.96193 -25.3623 -1.42607 -25.8275 -2.00034 -25.8275 C -2.86533 -25.8275 -3.60997 -25.516 -4.15199 -24.9262 C -5.25588 -23.7279 -5.13015 -21.8035 -5.11569 -21.6738 C -5.11569 -20.5799 -4.69026 -19.5842 -3.99683 -18.8416 C -4.6468 -18.4846 -5.22446 -18.0128 -5.70491 -17.4546 C -6.42352 -19.8137 -7.98933 -22.7127 -11.3464 -22.7127 C -14.9311 -22.7127 -15.4971 -29.9735 -15.5022 -30.0462 C -15.5386 -30.6193 -16.0442 -31.0587 -16.605 -31.0172 C -17.1761 -30.9808 -17.6102 -30.4887 -17.5749 -29.9164 C -17.552 -29.5374 -16.931 -20.6359 -11.3463 -20.6359 C -7.72626 -20.6359 -7.19456 -14.3876 -7.18935 -14.3253 C -7.18397 -14.257 -7.17219 -14.1909 -7.15466 -14.1274 C -7.17899 -13.9057 -7.19248 -13.6806 -7.19248 -13.4525 L -7.19248 -11.2032 C -7.19248 -8.8997 -5.91799 -6.88944 -4.03808 -5.83763 C -4.36448 -5.59792 -4.66142 -5.33105 -4.92182 -5.03983 L -9.68174 -5.99221 L -13.5977 -11.8657 C -13.7503 -12.0941 -13.9881 -12.254 -14.2581 -12.3071 L -19.0278 -13.2614 L -20.8669 -16.0196 C -21.1846 -16.4963 -21.8295 -16.6271 -22.3073 -16.3073 C -22.7849 -15.9895 -22.9138 -15.3447 -22.5949 -14.8669 L -20.518 -11.7516 C -20.3654 -11.5231 -20.1275 -11.3633 -19.8576 -11.3102 L -15.0879 -10.3559 L -11.172 -4.48236 C -11.0194 -4.25393 -10.7816 -4.09401 -10.5116 -4.04098 L -5.98653 -3.13594 C -6.09507 -2.75272 -6.1542 -2.35382 -6.1542 -1.94335 C -6.1542 -1.58776 -6.11087 -1.24057 -6.02887 -0.904939 L -12.3849 -0.904939 C -12.5739 -0.904939 -12.7576 -0.85407 -12.9197 -0.756472 L -17.8648 2.21041 L -21.7311 2.21041 C -22.3053 2.21041 -22.7695 2.67564 -22.7695 3.24881 C -22.7695 3.82199 -22.3053 4.28723 -21.7311 4.28723 L -17.5773 4.28723 C -17.3883 4.28723 -17.2045 4.23634 -17.0425 4.13876 L -12.0973 1.17188 L -5.11579 1.17188 C -5.04949 1.17188 -4.98475 1.16506 -4.92182 1.15314 C -4.41144 1.72375 -3.76306 2.20335 -3.01939 2.55979 C -3.67679 3.29481 -4.07738 4.26409 -4.07738 5.32574 L -4.07738 5.72187 L -13.8876 10.627 C -14.1752 10.7713 -14.3787 11.0381 -14.441 11.3529 L -17.495 26.6212 L -20.3882 29.5143 C -20.7943 29.9204 -20.7943 30.5767 -20.3882 30.9827 C -20.1857 31.1852 -19.9198 31.2869 -19.654 31.2869 C -19.3881 31.2869 -19.1223 31.1852 -18.9198 30.9827 L -15.8045 27.8673 C -15.6591 27.7219 -15.5614 27.5381 -15.5209 27.3366 L -12.5043 12.2584 L -4.07728 8.04487 L -4.07728 8.44097 C -4.07728 9.47136 -3.69953 10.4145 -3.07635 11.1411 C -6.09774 12.3855 -8.23116 15.3606 -8.23116 18.8254 L -8.23116 22.9792 C -8.23116 27.5598 -4.50417 31.2868 0.0764775 31.2868 C 4.65712 31.2868 8.38411 27.5598 8.38411 22.9792 L 8.38411 18.8254 C 8.38411 15.3604 6.25083 12.3854 3.2293 11.1411 C 3.85249 10.4145 4.23024 9.47136 4.23024 8.44097 L 4.23024 8.04487 L 12.6572 12.2584 L 15.6739 27.3366 C 15.7144 27.538 15.812 27.7219 15.9574 27.8673 L 19.0728 30.9827 C 19.2753 31.1852 19.5412 31.2869 19.807 31.2869 C 20.0728 31.2869 20.3386 31.1852 20.5411 30.9827 C 20.9471 30.5767 20.9471 29.9203 20.5411 29.5143 L 17.648 26.6212 L 14.5939 11.3529 C 14.5315 11.0381 14.328 10.7713 14.0404 10.627 L 4.23024 5.72187 L 4.23024 5.32574 C 4.23024 4.26409 3.82962 3.29481 3.17223 2.55979 C 3.91601 2.20335 4.56426 1.72388 5.07464 1.15314 C 5.13757 1.16506 5.20219 1.17188 5.26865 1.17188 L 12.2502 1.17188 L 17.1953 4.13876 C 17.3573 4.23634 17.5411 4.28723 17.7301 4.28723 L 21.8839 4.28723 C 22.4581 4.28723 22.9223 3.82199 22.9223 3.24881 C 22.9223 2.67564 22.4585 2.21077 21.8842 2.21077 Z M -1.04894 -7.13526 C -3.29089 -7.13526 -5.11556 -8.9598 -5.11556 -11.2028 L -5.11556 -13.4521 C -5.11556 -15.6952 -3.29101 -17.5197 -1.04894 -17.5197 L 1.20238 -17.5197 C 3.44434 -17.5197 5.26901 -15.6952 5.26901 -13.4521 L 5.26901 -11.2028 C 5.26901 -8.9598 3.44444 -7.13526 1.20238 -7.13526 Z M 6.30752 18.8259 L 6.30752 22.9796 C 6.30752 26.4159 3.51308 29.2103 0.0768428 29.2103 C -3.3594 29.2103 -6.15384 26.4159 -6.15384 22.9796 L -6.15384 18.8259 C -6.15384 15.3896 -3.3594 12.5952 0.0768428 12.5952 C 3.51308 12.5952 6.30752 15.3896 6.30752 18.8259 Z M 2.15366 5.3261 L 2.15366 6.39593 L 2.15366 6.39956 L 2.15366 8.44147 C 2.15366 9.58683 1.22222 10.5184 0.076721 10.5184 C -1.06878 10.5184 -2.00022 9.58696 -2.00022 8.44147 L -2.00022 6.39956 L -2.00022 6.39593 L -2.00022 5.3261 C -2.00022 4.18074 -1.06878 3.24918 0.076721 3.24918 C 1.22222 3.24918 2.15366 4.18074 2.15366 5.3261 Z M 0.0768428 1.17236 C -2.21403 1.17236 -4.07692 -0.225404 -4.07692 -1.94298 C -4.07692 -3.66056 -2.21391 -5.05834 0.0768428 -5.05834 C 2.36759 -5.05834 4.2306 -3.66056 4.2306 -1.94298 C 4.2306 -0.225404 2.36759 1.17236 0.0768428 1.17236 Z",4,"ngIf"],["d","M 15.3841 1.25408 C 22.8728 -1.82428 29.9895 -8.66692 29.9895 -11.9438 C 29.9895 -12.8799 29.4656 -13.6136 28.5873 -13.906 C 27.8046 -14.1664 24.6195 -14.3188 14.4763 -7.04548 C 14.3844 -7.97908 13.9844 -8.82172 13.3836 -9.47812 C 13.4167 -9.58096 13.4394 -9.6886 13.4394 -9.80284 C 13.4394 -13.1571 9.49688 -15.9237 3.91664 -16.864 C 3.97556 -18.4007 4.88768 -22.8456 12.8845 -26.8437 C 13.4073 -27.1052 13.6191 -27.7406 13.3578 -28.2634 C 13.0953 -28.7862 12.4609 -28.9971 11.938 -28.7367 C 3.34424 -24.4397 1.97336 -19.361 1.81856 -17.1244 C 1.12448 -17.1802 0.41168 -17.2094 -0.31564 -17.2094 C -1.40548 -17.2094 -2.46052 -17.1422 -3.47128 -17.0189 C -3.59032 -19.1981 -4.86616 -24.371 -13.5975 -28.7366 C -14.1203 -28.997 -14.7548 -28.7861 -15.0172 -28.2633 C -15.2787 -27.7404 -15.0668 -27.1049 -14.5439 -26.8436 C -6.16912 -22.6568 -5.56468 -17.9801 -5.57296 -16.6665 C -10.6046 -15.5753 -14.0706 -12.9474 -14.0706 -9.8026 C -14.0706 -9.68836 -14.048 -9.58072 -14.0146 -9.47788 C -14.6715 -8.76052 -15.0833 -7.81948 -15.121 -6.78208 C -25.5504 -14.3201 -28.8038 -14.17 -29.5978 -13.9058 C -30.4761 -13.6134 -31 -12.8799 -31 -11.9438 C -31 -8.63464 -23.7414 -1.68868 -16.1718 1.3442 C -23.7414 4.3772 -31 11.3233 -31 14.6323 C -31 15.5684 -30.4761 16.3021 -29.5968 16.5955 C -29.4222 16.6533 -29.1701 16.7371 -28.7516 16.7371 C -27.2727 16.7371 -23.7153 15.6854 -14.1678 8.74748 C -13.8431 9.143 -13.5125 9.47624 -13.0664 9.73316 C -12.821 16.1545 -7.58992 21.3656 -1.50604 21.892 L -1.50604 27.23 C -1.50604 27.8149 -1.03276 28.288 -0.448 28.288 C 0.13688 28.288 0.61004 27.8148 0.61004 27.23 L 0.61004 21.892 C 6.95852 21.3656 12.0572 16.1545 12.3026 9.73316 C 12.7614 9.46892 13.1995 9.12296 13.5294 8.71304 C 23.1112 15.6825 26.6942 16.738 28.1769 16.738 C 28.5964 16.738 28.8579 16.6533 29.0335 16.5944 C 29.9118 16.302 30.4398 15.5684 30.4398 14.6322 C 30.44 11.2893 23.0366 4.23644 15.3841 1.25408 Z M -28.8921 -11.9096 C -27.3192 -12.3306 -20.102 -7.90708 -13.9077 -3.24676 C -14.6109 -2.53432 -15.059 -1.57444 -15.1169 -0.51196 C -23.053 -3.54004 -29.0001 -10.3224 -28.8921 -11.9096 Z M -15.1288 6.06848 C -15.1288 6.31232 -15.1035 6.55004 -15.0636 6.78248 C -22.932 12.527 -27.6682 14.8687 -28.8932 14.593 C -28.9924 12.9306 -22.5395 5.64788 -14.1152 2.8394 C -14.0278 2.81048 -13.9496 2.76812 -13.8756 2.72 C -13.8144 2.78096 -13.7488 2.837 -13.6838 2.89412 C -14.5674 3.67016 -15.1288 4.80368 -15.1288 6.06848 Z M 27.8827 -11.9055 C 27.9772 -10.3347 22.2198 -3.74764 14.4784 -0.65668 C 14.3818 -1.74316 13.8714 -2.71012 13.1071 -3.40516 C 19.2103 -7.978 26.2028 -12.271 27.8827 -11.9055 Z M -0.31564 -15.0932 C 5.65928 -15.0932 10.0551 -12.9976 11.0895 -10.7981 C 10.8201 -10.8519 10.5422 -10.9012 10.257 -10.9012 L -10.8881 -10.9012 C -11.1731 -10.9012 -11.4513 -10.8519 -11.7207 -10.7981 C -10.6866 -12.9976 -6.29056 -15.0932 -0.31564 -15.0932 Z M -0.31564 19.7833 C -5.79256 19.7833 -10.3106 15.551 -10.8432 10.2606 L 10.2122 10.2606 C 9.67952 15.5509 5.16128 19.7833 -0.31564 19.7833 Z M 10.257 8.14436 L -10.8881 8.14436 C -12.0599 8.14436 -13.0126 7.1948 -13.0126 6.02816 C -13.0126 4.86152 -12.0599 3.91196 -10.8881 3.91196 L 10.257 3.91196 C 11.4286 3.91196 12.3813 4.86152 12.3813 6.02816 C 12.3813 7.1948 11.4286 8.14436 10.257 8.14436 Z M 10.257 1.79588 L -10.8881 1.79588 C -12.0599 1.79588 -13.0126 0.84632 -13.0126 -0.32032 C -13.0126 -1.48696 -12.0599 -2.43652 -10.8881 -2.43652 L 10.257 -2.43652 C 11.4286 -2.43652 12.3813 -1.48696 12.3813 -0.32032 C 12.3813 0.84632 11.4286 1.79588 10.257 1.79588 Z M 10.257 -4.5526 L -10.8881 -4.5526 C -12.0599 -4.5526 -13.0126 -5.50216 -13.0126 -6.6688 C -13.0126 -7.83544 -12.0599 -8.785 -10.8881 -8.785 L 10.257 -8.785 C 11.4286 -8.785 12.3813 -7.83544 12.3813 -6.6688 C 12.3813 -5.50216 11.4286 -4.5526 10.257 -4.5526 Z M 28.3363 14.5982 C 27.2038 14.8942 22.4127 12.5611 14.4402 6.73292 C 14.4745 6.51596 14.4975 6.29504 14.4975 6.06848 C 14.4975 4.8038 13.9364 3.67028 13.0527 2.89424 C 13.1287 2.82764 13.2044 2.7602 13.2751 2.68832 C 13.3609 2.75036 13.4539 2.80436 13.5592 2.8394 C 21.9908 5.651 28.4488 12.945 28.3363 14.5982 Z"],["d","M 27.079 1.30667 L 15.7412 -4.79822 L 15.7412 -7.89145 C 15.7412 -8.39311 15.335 -8.80033 14.8324 -8.80033 L 12.1056 -8.80033 L 12.1056 -9.70918 C 12.1056 -10.4088 12.0442 -11.0941 11.927 -11.7605 L 17.9173 -14.3278 C 18.2517 -14.4705 18.4681 -14.7995 18.4681 -15.1622 L 18.4681 -25.1602 L 23.9215 -25.1602 C 24.4242 -25.1602 24.8304 -25.5674 24.8304 -26.0691 C 24.8304 -26.5718 24.4242 -26.978 23.9215 -26.978 L 17.5592 -26.978 C 17.0566 -26.978 16.6503 -26.5718 16.6503 -26.0691 L 16.6503 -15.7621 L 11.4679 -13.5404 C 10.6322 -15.9716 9.02444 -18.0467 6.93872 -19.4717 C 7.86471 -20.1312 8.47025 -21.2128 8.47025 -22.4339 C 8.47025 -24.439 6.83966 -26.0695 4.83465 -26.0695 C 4.33202 -26.0695 3.92577 -25.6623 3.92577 -25.1607 C 3.92577 -24.659 4.33202 -24.2518 4.83465 -24.2518 C 5.83716 -24.2518 6.65252 -23.4366 6.65252 -22.4339 C 6.65252 -21.4314 5.83726 -20.6161 4.83465 -20.6161 L 4.83336 -20.616 C 3.43401 -21.2012 1.89916 -21.525 0.290076 -21.525 C -1.31901 -21.525 -2.85386 -21.2012 -4.25324 -20.616 L -4.2545 -20.6161 C -5.257 -20.6161 -6.07236 -21.4313 -6.07236 -22.4339 C -6.07236 -23.4365 -5.25711 -24.2518 -4.2545 -24.2518 C -3.75186 -24.2518 -3.34563 -24.659 -3.34563 -25.1607 C -3.34563 -25.6623 -3.75186 -26.0695 -4.2545 -26.0695 C -6.25961 -26.0695 -7.89009 -24.4389 -7.89009 -22.4339 C -7.89009 -21.2127 -7.28459 -20.1312 -6.35856 -19.4717 C -8.44428 -18.0467 -10.0521 -15.9716 -10.8877 -13.5404 L -16.0702 -15.7621 L -16.0702 -26.0691 C -16.0702 -26.5718 -16.4764 -26.978 -16.979 -26.978 L -23.3419 -26.978 C -23.8445 -26.978 -24.2508 -26.5718 -24.2508 -26.0691 C -24.2508 -25.5674 -23.8445 -25.1602 -23.3419 -25.1602 L -17.8884 -25.1602 L -17.8884 -15.1622 C -17.8884 -14.7995 -17.6721 -14.4705 -17.3377 -14.3278 L -11.3474 -11.7605 C -11.4646 -11.0941 -11.526 -10.4086 -11.526 -9.70917 L -11.526 -8.80033 L -14.2527 -8.80033 C -14.7554 -8.80033 -15.1616 -8.3931 -15.1616 -7.89145 L -15.1616 -4.79822 L -26.4994 1.30667 C -26.9411 1.54388 -27.1074 2.09561 -26.8693 2.53732 C -26.7047 2.84269 -26.3912 3.01546 -26.0677 3.01546 C -25.9223 3.01546 -25.775 2.98095 -25.6378 2.90639 L -15.1617 -2.73463 L -15.1617 5.31601 L -20.2889 9.58867 C -20.6025 9.85047 -20.7034 10.2904 -20.5334 10.663 L -16.1815 20.2374 L -19.5862 26.1962 C -19.8362 26.6316 -19.6845 27.1869 -19.2482 27.4359 C -19.1064 27.5177 -18.951 27.5559 -18.7983 27.5559 C -18.4819 27.5559 -18.1757 27.3913 -18.0085 27.0978 L -14.3729 20.7354 C -14.2283 20.4818 -14.2138 20.1747 -14.3347 19.9084 L -18.5921 10.5411 L -15.1618 7.68295 L -15.1618 8.46881 C -15.1618 16.989 -8.23053 23.9203 0.28965 23.9203 C 8.80982 23.9203 15.7411 16.989 15.7411 8.46881 L 15.7411 7.68295 L 19.1714 10.5411 L 14.9141 19.9084 C 14.7932 20.1747 14.8078 20.4819 14.9522 20.7354 L 18.5878 27.0978 C 18.755 27.3913 19.0614 27.5559 19.3776 27.5559 C 19.5303 27.5559 19.6857 27.5177 19.8275 27.4359 C 20.2638 27.1869 20.4155 26.6316 20.1656 26.1962 L 16.7608 20.2374 L 21.1127 10.663 C 21.2827 10.2903 21.1817 9.85037 20.8681 9.58867 L 15.741 5.31601 L 15.741 -2.73463 L 26.2171 2.90639 C 26.3544 2.98095 26.5016 3.01546 26.647 3.01546 C 26.9705 3.01546 27.2841 2.8428 27.4486 2.53732 C 27.687 2.09561 27.5207 1.54398 27.079 1.30667 Z M -9.70827 -9.70928 C -9.70827 -15.2218 -5.22281 -19.7073 0.289757 -19.7073 C 5.80234 -19.7073 10.2878 -15.2219 10.2878 -9.70928 L 10.2878 -8.80044 L -9.70827 -8.80044 Z M -10.6171 -6.98257 L 11.1966 -6.98257 L 13.9234 -6.98257 L 13.9234 -4.26531 C 13.9233 -4.25796 13.9233 -4.25065 13.9234 -4.24316 L 13.9234 -3.87835 L 0.289757 3.79022 L -13.3439 -3.87835 L -13.3439 -4.24316 C -13.3438 -4.25051 -13.3438 -4.25786 -13.3439 -4.26531 L -13.3439 -6.98257 Z M -13.3439 8.46892 L -13.3439 5.74091 L -13.3439 5.73461 L -13.3439 -1.79295 L -0.619115 5.36501 L -0.619115 22.0715 C -7.71446 21.6021 -13.3439 15.681 -13.3439 8.46892 Z M 1.19863 22.0715 L 1.19863 5.36501 L 13.9234 -1.79295 L 13.9234 5.73471 L 13.9234 5.7408 L 13.9234 8.46902 C 13.9234 15.681 8.29409 21.6021 1.19863 22.0715 Z"],["d","M 23.1993 15.5733 C 21.3366 14.109 18.3446 11.7414 17.7296 11.2169 C 12.9652 2.64827 6.39655 -0.814228 5.07856 -1.44294 C 5.33756 -1.88486 5.4918 -2.35409 5.4918 -2.83719 C 5.4918 -3.30048 5.3294 -3.93486 5.04265 -5.01624 C 4.8512 -5.73792 4.63024 -6.57068 4.49294 -7.31486 C 4.59374 -7.31187 4.69419 -7.30891 4.79464 -7.30891 C 8.94543 -7.30891 12.7535 -9.75455 12.9341 -9.87229 C 13.1714 -10.0271 13.3373 -10.2703 13.3943 -10.5478 C 13.451 -10.8255 13.3949 -11.1144 13.2379 -11.3502 L 11.5052 -13.9494 C 13.7039 -15.6498 16.0931 -16.5487 16.1187 -16.5583 C 16.6686 -16.7613 16.9498 -17.3717 16.7467 -17.9216 C 16.5433 -18.4713 15.9332 -18.7522 15.3835 -18.5494 C 15.2491 -18.4996 12.0538 -17.304 9.38881 -14.9538 C 8.99075 -14.6026 8.91323 -14.0109 9.20786 -13.5691 L 10.8409 -11.1198 C 9.64329 -10.4953 7.44869 -9.53254 5.16354 -9.43858 C 5.21814 -9.64602 5.24334 -9.83818 5.25069 -10.0066 C 5.28989 -10.9199 4.88588 -11.8072 4.04914 -12.6442 C 3.74954 -12.9441 3.51227 -13.3816 3.26136 -13.8449 C 2.98206 -14.3609 2.65176 -14.9693 2.15511 -15.4578 C 2.8653 -18.087 7.91209 -26.8789 12.9465 -30.2572 C 13.4331 -30.5838 13.5628 -31.2431 13.2359 -31.7297 C 12.909 -32.2165 12.2501 -32.3464 11.7633 -32.0197 C 6.51594 -28.4984 1.39127 -19.8963 0.213976 -16.338 C 0.113176 -16.3457 0.00992607 -16.351 -0.0975239 -16.351 C -0.204974 -16.351 -0.308574 -16.3457 -0.409374 -16.338 C -1.58669 -19.8963 -6.71146 -28.4984 -11.9586 -32.0197 C -12.4453 -32.3465 -13.1048 -32.2168 -13.4313 -31.7297 C -13.7575 -31.2431 -13.6283 -30.5836 -13.1415 -30.2572 C -8.10712 -26.8789 -3.0603 -18.087 -2.35008 -15.4578 C -2.8469 -14.9693 -3.17709 -14.3609 -3.45639 -13.8449 C -3.70734 -13.3816 -3.94429 -12.9441 -4.24417 -12.6442 C -5.08116 -11.8072 -5.48531 -10.9199 -5.44569 -10.0066 C -5.43869 -9.83861 -5.41034 -9.64675 -5.35889 -9.43985 C -7.63784 -9.53621 -9.83525 -10.4982 -11.0349 -11.1215 L -9.4031 -13.5691 C -9.1084 -14.0109 -9.18575 -14.6025 -9.58405 -14.9538 C -12.249 -17.304 -15.4439 -18.4998 -15.5787 -18.5494 C -16.1283 -18.7529 -16.7389 -18.4714 -16.9419 -17.9216 C -17.1453 -17.3717 -16.8639 -16.7614 -16.3139 -16.5583 C -16.2894 -16.5485 -13.9065 -15.6578 -11.7003 -13.9495 L -13.4331 -11.3502 C -13.5903 -11.1144 -13.6466 -10.8255 -13.5896 -10.5478 C -13.5325 -10.2702 -13.3666 -10.027 -13.1294 -9.87229 C -12.9485 -9.75455 -9.14095 -7.30891 -4.98985 -7.30891 C -4.8894 -7.30891 -4.7886 -7.31201 -4.68815 -7.31486 C -4.82535 -6.57068 -5.04669 -5.73792 -5.23789 -5.01624 C -5.52454 -3.93472 -5.68701 -3.30048 -5.68701 -2.8372 C -5.68701 -2.35409 -5.53301 -1.885 -5.27377 -1.44294 C -6.59176 -0.814515 -13.1606 2.64715 -17.9248 11.2169 C -18.5398 11.7414 -21.5318 14.109 -23.3946 15.5733 C -23.8553 15.9355 -23.9353 16.6027 -23.5731 17.0635 C -23.3638 17.3299 -23.0524 17.4689 -22.7381 17.4689 C -22.5085 17.4689 -22.2773 17.3949 -22.0829 17.2419 C -16.329 12.7187 -16.2836 12.636 -16.1484 12.3905 C -12.7212 6.15479 -8.19525 2.75469 -5.81882 1.2894 L -6.09532 2.62182 C -6.25842 3.40845 -6.37112 4.19975 -6.43447 4.99303 C -6.63957 5.8207 -7.95109 11.2654 -7.95109 15.2755 L -7.95109 28.8035 C -7.95109 30.0442 -6.94176 31.0534 -5.6958 31.0534 C -4.54097 31.0534 -3.57917 30.1874 -3.45818 29.0391 L -3.23488 26.9188 L -2.46904 31.3227 C -2.26779 32.4787 -1.27065 33.3177 -0.0974189 33.3177 C 1.07582 33.3177 2.07325 32.4787 2.27422 31.3229 L 3.04019 26.9189 L 3.26349 29.0391 C 3.38389 30.1876 4.34632 31.0536 5.50647 31.0536 C 6.74711 31.0536 7.75644 30.0442 7.75644 28.8036 L 7.75644 15.2757 C 7.75644 11.2658 6.4452 5.82155 6.23979 4.99331 C 6.17609 4.20003 6.06374 3.40873 5.90029 2.62196 L 5.62274 1.2836 C 7.99413 2.73998 12.5115 6.12819 15.9537 12.391 C 16.0888 12.6363 16.1339 12.719 21.888 17.2422 C 22.0826 17.395 22.3137 17.4692 22.5432 17.4692 C 22.8578 17.4692 23.1687 17.3302 23.3782 17.0637 C 23.7406 16.6029 23.6603 15.9355 23.1997 15.5733 Z M -0.0974189 -0.50221 C -1.23145 -0.50221 -3.5643 -2.07335 -3.5643 -2.83621 C -3.5608 -3.05937 -3.34415 -3.87585 -3.18616 -4.47201 C -2.94361 -5.38656 -2.65811 -6.46286 -2.51829 -7.43599 L 2.32336 -7.43599 C 2.46301 -6.46286 2.74857 -5.38656 2.99126 -4.47201 C 3.14946 -3.87585 3.36587 -3.0595 3.3694 -2.83706 C 3.36958 -2.07335 1.03665 -0.50221 -0.0973489 -0.50221 Z M -2.74316 -11.143 C -2.22485 -11.6614 -1.88748 -12.2843 -1.58991 -12.834 C -1.01925 -13.8877 -0.777679 -14.2284 -0.0976289 -14.2284 C 0.582456 -14.2284 0.824166 -13.8878 1.39474 -12.834 C 1.69259 -12.2843 2.02964 -11.6614 2.54799 -11.143 C 2.93554 -10.7554 3.14232 -10.3845 3.1299 -10.0984 C 3.1229 -9.90554 3.00985 -9.71847 2.8709 -9.55872 L -3.06667 -9.55872 C -3.20527 -9.71849 -3.31727 -9.90557 -3.32532 -10.0984 C -3.33582 -10.3844 -3.13072 -10.7553 -2.74341 -11.143 Z M -5.5692 28.8171 C -5.5762 28.882 -5.63045 28.931 -5.7015 28.931 C -5.7715 28.931 -5.8289 28.8738 -5.8289 28.8036 L -5.8289 15.2757 C -5.8289 14.5074 -5.7743 13.6716 -5.6868 12.8224 L -4.56484 19.2736 Z M 0.182861 30.9593 C 0.158361 31.0959 0.0411111 31.1951 -0.0974889 31.1951 C -0.236439 31.1951 -0.354039 31.0959 -0.377839 30.9592 L -4.12024 9.4401 C -4.36139 8.05221 -4.42929 6.65441 -4.32604 5.26327 C -4.32334 5.23737 -4.32254 5.21161 -4.32254 5.18602 C -4.26619 4.47255 -4.16574 3.76092 -4.01909 3.05339 L -3.46252 0.371859 C -2.71761 0.872219 -1.89235 1.25047 -1.1611 1.45324 L -1.1611 19.804 C -1.1611 20.3903 -0.685909 20.8653 -0.0997989 20.8653 C 0.486346 20.8653 0.961506 20.3903 0.961506 19.804 L 0.961506 1.4531 C 1.6928 1.25045 2.51806 0.872079 3.26293 0.371716 L 3.8195 3.05325 C 3.96615 3.76078 4.06695 4.47241 4.12295 5.18588 C 4.12407 5.21178 4.12617 5.2374 4.12645 5.26313 C 4.2297 6.65413 4.1618 8.05193 3.92065 9.43996 Z M 5.63355 28.8035 C 5.63355 28.8737 5.57615 28.9309 5.50055 28.9309 C 5.4351 28.9309 5.38085 28.8819 5.3742 28.8168 L 4.36967 19.2735 L 5.49166 12.8221 C 5.57951 13.6713 5.63376 14.5072 5.63376 15.2754 Z"],["d","M 26.2796 -9.91591 C 26.0694 -10.4424 25.4717 -10.6985 24.9452 -10.488 L 13.9952 -6.10798 C 13.8372 -6.04429 13.6972 -5.94331 13.588 -5.8123 L 8.42091 0.388326 L 4.52341 0.388326 L 8.59528 -4.49777 C 8.68702 -4.60766 8.75434 -4.73537 8.79361 -4.87289 L 13.1189 -20.0116 L 20.6616 -29.7097 C 21.0095 -30.1573 20.9295 -30.8021 20.4821 -31.1502 C 20.0347 -31.498 19.3896 -31.4175 19.0416 -30.9702 L 11.3767 -21.1152 C 11.2958 -21.0115 11.2364 -20.8935 11.1998 -20.7668 L 6.87935 -5.64532 L 3.30485 -1.35594 C 3.18605 -2.00651 2.8709 -2.58958 2.42256 -3.04056 L 3.25011 -4.69564 C 3.50388 -5.20275 3.29829 -5.81939 2.79124 -6.07303 C 2.28436 -6.3268 1.66762 -6.12088 1.41399 -5.6137 L 0.587006 -3.95974 C 0.441806 -3.97954 0.292976 -3.99472 0.142034 -3.99472 C -0.00910632 -3.99472 -0.157276 -3.98812 -0.302971 -3.95974 L -1.12991 -5.6137 C -1.38335 -6.12068 -2.00005 -6.32611 -2.50716 -6.07303 C -3.01427 -5.81926 -3.21983 -5.20292 -2.96599 -4.69564 L -2.13845 -3.04056 C -2.58676 -2.58938 -2.90151 -2.00667 -3.02074 -1.35594 L -6.5952 -5.64532 L -10.9158 -20.7666 C -10.9547 -20.8928 -11.0118 -21.0109 -11.0926 -21.1151 L -18.7576 -30.97 C -19.1055 -31.4177 -19.7506 -31.4983 -20.198 -31.15 C -20.6454 -30.802 -20.7262 -30.157 -20.3785 -29.7096 L -12.8358 -20.0115 L -8.51046 -4.87279 C -8.47152 -4.73518 -8.40354 -4.6078 -8.31213 -4.49768 L -4.24022 0.388425 L -8.13769 0.388425 L -13.3048 -5.81223 C -13.4137 -5.94324 -13.554 -6.04521 -13.7121 -6.10791 L -24.6622 -10.4879 C -25.1888 -10.6981 -25.7861 -10.4401 -25.9966 -9.91598 C -26.2072 -9.38953 -25.9488 -8.7922 -25.4248 -8.58156 L -14.7158 -4.29806 L -9.4072 2.07245 C -9.21217 2.30642 -8.92325 2.44211 -8.61853 2.44211 L -4.49492 2.44211 L -10.118 4.85187 C -10.2909 4.92612 -10.4398 5.04591 -10.5486 5.199 L -16.0236 12.8639 C -16.0985 12.9686 -16.153 13.0867 -16.1843 13.2114 L -17.2793 17.5914 C -17.4169 18.1415 -17.0823 18.6989 -16.5324 18.8364 C -16.4489 18.8562 -16.365 18.8714 -16.2825 18.8714 C -15.8228 18.8714 -15.4041 18.5596 -15.2875 18.0936 L -14.2397 13.9027 L -9.04496 6.63014 L -3.91861 4.43304 C -4.18822 4.70496 -4.4401 4.99859 -4.67127 5.31067 L -10.4723 11.6784 C -10.5927 11.811 -10.6762 11.9724 -10.7155 12.1472 L -12.9055 22.0021 C -12.9286 22.117 -12.9404 22.2354 -12.9253 22.3524 L -11.8303 31.1123 C -11.7653 31.6316 -11.3231 32.0116 -10.8129 32.0116 C -10.7697 32.0116 -10.7275 32.009 -10.6842 32.005 C -10.1217 31.9347 -9.72255 31.4215 -9.79287 30.8589 L -10.8659 22.2755 L -8.77373 12.8608 L -6.36268 10.2144 C -6.34288 13.6592 -3.66998 19.968 0.138371 19.968 C 3.94677 19.968 6.62264 13.6592 6.6395 10.2144 L 9.05055 12.8608 L 11.1426 22.2755 L 10.0697 30.8589 C 9.99943 31.4215 10.3981 31.9346 10.961 32.005 C 11.0042 32.0083 11.0468 32.0116 11.0897 32.0116 C 11.6 32.0116 12.0421 31.6318 12.1071 31.1123 L 13.2021 22.3524 C 13.2186 22.2352 13.2087 22.1171 13.1856 22.0021 L 10.9956 12.1472 C 10.9566 11.9726 10.8728 11.8106 10.7524 11.6784 L 4.95135 5.31067 C 4.72002 4.99849 4.46804 4.70499 4.19869 4.43304 L 9.32498 6.63014 L 14.5198 13.9027 L 15.5676 18.0936 C 15.6841 18.5601 16.1027 18.8714 16.5626 18.8714 C 16.6451 18.8714 16.729 18.8648 16.8124 18.8364 C 17.3625 18.6988 17.6969 18.1415 17.5594 17.5914 L 16.4644 13.2114 C 16.4294 13.0867 16.3789 12.9686 16.3037 12.8639 L 10.8287 5.199 C 10.7198 5.04621 10.5707 4.92609 10.3981 4.85187 L 4.77501 2.44211 L 8.89863 2.44211 C 9.20289 2.44211 9.49223 2.30681 9.68729 2.07245 L 14.9959 -4.29806 L 25.7048 -8.58156 C 26.2309 -8.7921 26.4871 -9.38969 26.2765 -9.91604 Z M 3.32851 6.55639 C 3.33511 6.56299 3.34831 6.57949 3.35491 6.59533 C 3.44038 6.71413 3.52189 6.83623 3.6001 6.9615 L -3.31728 6.9615 C -3.2394 6.83643 -3.15723 6.71433 -3.07209 6.59533 C -3.06549 6.58873 -3.05229 6.57223 -3.04569 6.55639 C -2.22788 5.4365 -1.08892 4.63183 0.141308 4.63183 C 1.37151 4.63183 2.51044 5.43634 3.32825 6.55639 Z M -4.30682 10.1751 C -4.30682 9.7961 -4.25897 9.40383 -4.16987 9.01166 L 4.45319 9.01166 C 4.54229 9.4036 4.59014 9.79583 4.59014 10.1751 C 4.59014 10.5284 4.5512 10.9222 4.47728 11.3385 L -4.19435 11.3385 C -4.26695 10.9222 -4.30655 10.5285 -4.30655 10.1751 Z M 1.30499 -0.774814 L 1.30499 2.50003 L 1.30499 2.50663 L 1.30499 2.71651 C 0.928325 2.62543 0.540278 2.57461 0.141572 2.57461 C -0.257068 2.57461 -0.645313 2.62543 -1.02187 2.71651 L -1.02187 2.50663 L -1.02187 2.50003 L -1.02187 -0.774814 C -1.02187 -1.4163 -0.499981 -1.93823 0.141572 -1.93823 C 0.783092 -1.93823 1.30499 -1.41623 1.30499 -0.774814 Z M 0.141572 17.9085 C -1.29768 17.9085 -2.79123 15.6796 -3.62943 13.3916 L 3.91268 13.3916 C 3.07435 15.6796 1.58077 17.9085 0.141572 17.9085 Z"],["d","M 21.8842 2.21077 L 18.0181 2.21077 L 13.0729 -0.756106 C 12.911 -0.853707 12.7271 -0.904573 12.5381 -0.904573 L 6.18206 -0.904573 C 6.26409 -1.2402 6.30742 -1.58751 6.30742 -1.94298 C 6.30742 -2.35345 6.24815 -2.75236 6.13972 -3.13557 L 10.6647 -4.04062 C 10.9348 -4.09355 11.1726 -4.25344 11.3252 -4.48199 L 15.2411 -10.3555 L 20.0108 -11.3098 C 20.2808 -11.3628 20.5186 -11.5227 20.6712 -11.7512 L 22.7482 -14.8665 C 23.067 -15.3442 22.9382 -15.9892 22.4605 -16.3069 C 21.9817 -16.6267 21.3378 -16.4959 21.0201 -16.0192 L 19.181 -13.2611 L 14.4113 -12.3067 C 14.1413 -12.2538 13.9035 -12.0939 13.7509 -11.8653 L 9.83492 -5.99184 L 5.07504 -5.03946 C 4.8146 -5.33056 4.51767 -5.59756 4.1913 -5.83727 C 6.07121 -6.88908 7.3457 -8.89921 7.3457 -11.2028 L 7.3457 -13.4521 C 7.3457 -13.6801 7.33217 -13.9049 7.30798 -14.1266 C 7.3256 -14.1905 7.33742 -14.257 7.34266 -14.3255 C 7.34788 -14.3889 7.864 -20.6352 11.4996 -20.6352 C 17.0843 -20.6352 17.7053 -29.5377 17.7282 -29.9168 C 17.7635 -30.489 17.3284 -30.9813 16.7572 -31.0175 C 16.1861 -31.057 15.6907 -30.6188 15.6554 -30.0456 C 15.6502 -29.9729 15.0967 -22.7121 11.4996 -22.7121 C 8.14265 -22.7121 6.5767 -19.8132 5.85813 -17.4544 C 5.37949 -18.0105 4.80424 -18.4808 4.15721 -18.8374 C 4.84539 -19.5678 5.26657 -20.5387 5.26462 -21.5875 C 5.28337 -21.8035 5.40896 -23.7278 4.30508 -24.9262 C 3.76306 -25.516 3.01841 -25.8275 2.15341 -25.8275 C 1.57915 -25.8275 1.11501 -25.3623 1.11501 -24.7892 C 1.11501 -24.216 1.57915 -23.7508 2.15341 -23.7508 C 2.51691 -23.7508 2.67681 -23.6282 2.77551 -23.5223 C 3.19194 -23.0727 3.21786 -22.0716 3.19194 -21.6739 C 3.19194 -20.5286 2.2605 -19.597 1.11501 -19.597 L -0.96193 -19.597 C -2.1073 -19.597 -3.03886 -20.5284 -3.043 -21.7601 C -3.07306 -22.135 -3.01185 -23.0986 -2.6245 -23.5203 C -2.52581 -23.6272 -2.3659 -23.7508 -2.00034 -23.7508 C -1.42607 -23.7508 -0.96193 -24.216 -0.96193 -24.7892 C -0.96193 -25.3623 -1.42607 -25.8275 -2.00034 -25.8275 C -2.86533 -25.8275 -3.60997 -25.516 -4.15199 -24.9262 C -5.25588 -23.7279 -5.13015 -21.8035 -5.11569 -21.6738 C -5.11569 -20.5799 -4.69026 -19.5842 -3.99683 -18.8416 C -4.6468 -18.4846 -5.22446 -18.0128 -5.70491 -17.4546 C -6.42352 -19.8137 -7.98933 -22.7127 -11.3464 -22.7127 C -14.9311 -22.7127 -15.4971 -29.9735 -15.5022 -30.0462 C -15.5386 -30.6193 -16.0442 -31.0587 -16.605 -31.0172 C -17.1761 -30.9808 -17.6102 -30.4887 -17.5749 -29.9164 C -17.552 -29.5374 -16.931 -20.6359 -11.3463 -20.6359 C -7.72626 -20.6359 -7.19456 -14.3876 -7.18935 -14.3253 C -7.18397 -14.257 -7.17219 -14.1909 -7.15466 -14.1274 C -7.17899 -13.9057 -7.19248 -13.6806 -7.19248 -13.4525 L -7.19248 -11.2032 C -7.19248 -8.8997 -5.91799 -6.88944 -4.03808 -5.83763 C -4.36448 -5.59792 -4.66142 -5.33105 -4.92182 -5.03983 L -9.68174 -5.99221 L -13.5977 -11.8657 C -13.7503 -12.0941 -13.9881 -12.254 -14.2581 -12.3071 L -19.0278 -13.2614 L -20.8669 -16.0196 C -21.1846 -16.4963 -21.8295 -16.6271 -22.3073 -16.3073 C -22.7849 -15.9895 -22.9138 -15.3447 -22.5949 -14.8669 L -20.518 -11.7516 C -20.3654 -11.5231 -20.1275 -11.3633 -19.8576 -11.3102 L -15.0879 -10.3559 L -11.172 -4.48236 C -11.0194 -4.25393 -10.7816 -4.09401 -10.5116 -4.04098 L -5.98653 -3.13594 C -6.09507 -2.75272 -6.1542 -2.35382 -6.1542 -1.94335 C -6.1542 -1.58776 -6.11087 -1.24057 -6.02887 -0.904939 L -12.3849 -0.904939 C -12.5739 -0.904939 -12.7576 -0.85407 -12.9197 -0.756472 L -17.8648 2.21041 L -21.7311 2.21041 C -22.3053 2.21041 -22.7695 2.67564 -22.7695 3.24881 C -22.7695 3.82199 -22.3053 4.28723 -21.7311 4.28723 L -17.5773 4.28723 C -17.3883 4.28723 -17.2045 4.23634 -17.0425 4.13876 L -12.0973 1.17188 L -5.11579 1.17188 C -5.04949 1.17188 -4.98475 1.16506 -4.92182 1.15314 C -4.41144 1.72375 -3.76306 2.20335 -3.01939 2.55979 C -3.67679 3.29481 -4.07738 4.26409 -4.07738 5.32574 L -4.07738 5.72187 L -13.8876 10.627 C -14.1752 10.7713 -14.3787 11.0381 -14.441 11.3529 L -17.495 26.6212 L -20.3882 29.5143 C -20.7943 29.9204 -20.7943 30.5767 -20.3882 30.9827 C -20.1857 31.1852 -19.9198 31.2869 -19.654 31.2869 C -19.3881 31.2869 -19.1223 31.1852 -18.9198 30.9827 L -15.8045 27.8673 C -15.6591 27.7219 -15.5614 27.5381 -15.5209 27.3366 L -12.5043 12.2584 L -4.07728 8.04487 L -4.07728 8.44097 C -4.07728 9.47136 -3.69953 10.4145 -3.07635 11.1411 C -6.09774 12.3855 -8.23116 15.3606 -8.23116 18.8254 L -8.23116 22.9792 C -8.23116 27.5598 -4.50417 31.2868 0.0764775 31.2868 C 4.65712 31.2868 8.38411 27.5598 8.38411 22.9792 L 8.38411 18.8254 C 8.38411 15.3604 6.25083 12.3854 3.2293 11.1411 C 3.85249 10.4145 4.23024 9.47136 4.23024 8.44097 L 4.23024 8.04487 L 12.6572 12.2584 L 15.6739 27.3366 C 15.7144 27.538 15.812 27.7219 15.9574 27.8673 L 19.0728 30.9827 C 19.2753 31.1852 19.5412 31.2869 19.807 31.2869 C 20.0728 31.2869 20.3386 31.1852 20.5411 30.9827 C 20.9471 30.5767 20.9471 29.9203 20.5411 29.5143 L 17.648 26.6212 L 14.5939 11.3529 C 14.5315 11.0381 14.328 10.7713 14.0404 10.627 L 4.23024 5.72187 L 4.23024 5.32574 C 4.23024 4.26409 3.82962 3.29481 3.17223 2.55979 C 3.91601 2.20335 4.56426 1.72388 5.07464 1.15314 C 5.13757 1.16506 5.20219 1.17188 5.26865 1.17188 L 12.2502 1.17188 L 17.1953 4.13876 C 17.3573 4.23634 17.5411 4.28723 17.7301 4.28723 L 21.8839 4.28723 C 22.4581 4.28723 22.9223 3.82199 22.9223 3.24881 C 22.9223 2.67564 22.4585 2.21077 21.8842 2.21077 Z M -1.04894 -7.13526 C -3.29089 -7.13526 -5.11556 -8.9598 -5.11556 -11.2028 L -5.11556 -13.4521 C -5.11556 -15.6952 -3.29101 -17.5197 -1.04894 -17.5197 L 1.20238 -17.5197 C 3.44434 -17.5197 5.26901 -15.6952 5.26901 -13.4521 L 5.26901 -11.2028 C 5.26901 -8.9598 3.44444 -7.13526 1.20238 -7.13526 Z M 6.30752 18.8259 L 6.30752 22.9796 C 6.30752 26.4159 3.51308 29.2103 0.0768428 29.2103 C -3.3594 29.2103 -6.15384 26.4159 -6.15384 22.9796 L -6.15384 18.8259 C -6.15384 15.3896 -3.3594 12.5952 0.0768428 12.5952 C 3.51308 12.5952 6.30752 15.3896 6.30752 18.8259 Z M 2.15366 5.3261 L 2.15366 6.39593 L 2.15366 6.39956 L 2.15366 8.44147 C 2.15366 9.58683 1.22222 10.5184 0.076721 10.5184 C -1.06878 10.5184 -2.00022 9.58696 -2.00022 8.44147 L -2.00022 6.39956 L -2.00022 6.39593 L -2.00022 5.3261 C -2.00022 4.18074 -1.06878 3.24918 0.076721 3.24918 C 1.22222 3.24918 2.15366 4.18074 2.15366 5.3261 Z M 0.0768428 1.17236 C -2.21403 1.17236 -4.07692 -0.225404 -4.07692 -1.94298 C -4.07692 -3.66056 -2.21391 -5.05834 0.0768428 -5.05834 C 2.36759 -5.05834 4.2306 -3.66056 4.2306 -1.94298 C 4.2306 -0.225404 2.36759 1.17236 0.0768428 1.17236 Z"]],template:function(n,i){1&n&&(N(),S(0,"g"),F(1,"polygon",0)(2,"polygon",1)(3,"polygon",2)(4,"polygon",3),S(5,"g"),T(6,Ydt,1,0,"path",4),T(7,Kdt,1,0,"path",5),T(8,Xdt,1,0,"path",6),T(9,Qdt,1,0,"path",7),T(10,Jdt,1,0,"path",8),P()()),2&n&&(I("transform",i.layerTransform),_(1),y("ngClass",i.pieceClass),I("points",i.isoPointsLight),_(1),y("ngClass",i.pieceClass),I("points",i.isoPointsDark),_(1),I("points",i.isoPointsStroke),_(1),y("ngClass",i.pieceClass),I("points",i.hexaPoints),_(1),I("transform","translate("+i.hexaCenter.x+" "+i.hexaCenter.y+")"),_(1),y("ngIf","QueenBee"===i.piece.kind),_(1),y("ngIf","Beetle"===i.piece.kind),_(1),y("ngIf","Grasshopper"===i.piece.kind),_(1),y("ngIf","Spider"===i.piece.kind),_(1),y("ngIf","SoldierAnt"===i.piece.kind))},dependencies:[Ft,At],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();function tht(r,e){if(1&r){const t=pe();N(),S(0,"g")(1,"polygon",4),W("click",function(){const s=te(t).$implicit;return ne(p().selectSpace(s.x,s.y))}),P()()}if(2&r){const t=e.$implicit,n=p();_(1),ye("id","space_",t.x,"_",t.y,""),y("ngClass",t.content.spaceClasses),I("points",n.getHexaPointsAtXY(t.x,t.y))}}function nht(r,e){if(1&r){const t=pe();N(),S(0,"polygon",6),W("click",function(){te(t);const i=p().$implicit;return ne(p().selectSpace(i.x,i.y))}),P()}if(2&r){const t=p().$implicit,n=p();ye("id","stroke_",t.x,"_",t.y,""),y("ngClass",t.content.strokeClasses),I("points",n.getHexaPointsAtXY(t.x,t.y))}}function rht(r,e){if(1&r&&(N(),S(0,"g"),T(1,nht,1,4,"polygon",5),P()),2&r){const t=e.$implicit;_(1),y("ngIf",t.content.strokeClasses.length>0)}}function iht(r,e){if(1&r){const t=pe();N(),S(0,"polygon",8),W("click",function(){te(t);const i=p().$implicit;return ne(p().selectSpace(i.x,i.y))}),P()}if(2&r){const t=p().$implicit,n=p();ye("id","stroke_",t.x,"_",t.y,""),I("points",n.getHexaPointsAtXY(t.x,t.y))}}function sht(r,e){if(1&r&&(N(),S(0,"g"),T(1,iht,1,3,"polygon",7),P()),2&r){const t=e.$implicit;_(1),y("ngIf",t.content.selected)}}function oht(r,e){if(1&r){const t=pe();N(),S(0,"g")(1,"g",9),W("click",function(){const s=te(t).$implicit;return ne(p(2).selectStack(s.x,s.y))}),P()()}if(2&r){const t=e.$implicit,n=p().index,i=p();_(1),ye("id","piece_",t.x,"_",t.y,""),y("piece",t.content.piece)("x",t.x)("y",t.y)("pieceHeight",i.PIECE_HEIGHT)("hexaLayout",i.hexaLayout)("layer",n)}}function aht(r,e){if(1&r){const t=pe();N(),S(0,"polygon",6),W("click",function(){te(t);const i=p().$implicit;return ne(p(2).selectStack(i.x,i.y))}),P()}if(2&r){const t=p().$implicit,n=p().index,i=p();ye("id","stroke_",t.x,"_",t.y,""),y("ngClass",t.content.strokeClasses),I("transform","translate(0 "+-(n+1)*i.PIECE_HEIGHT+")")("points",i.getHexaPointsAtXY(t.x,t.y))}}function cht(r,e){if(1&r&&(N(),S(0,"g"),T(1,aht,1,5,"polygon",5),P()),2&r){const t=e.$implicit;_(1),y("ngIf",t.content.strokeClasses.length>0)}}function lht(r,e){if(1&r&&(N(),S(0,"g"),T(1,oht,2,8,"g",1),T(2,cht,2,1,"g",1),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t),_(1),y("ngForOf",t)}}function uht(r,e){if(1&r){const t=pe();N(),S(0,"g")(1,"g",10),W("click",function(){const s=te(t).$implicit;return ne(p(2).selectRemaining(s))}),P()()}if(2&r){const t=e.$implicit,n=e.index,i=p(2);_(1),zn("id","remainingPiece_",t.toString(),""),y("piece",t)("pieceHeight",i.PIECE_HEIGHT)("x",0)("y",0)("layer",n)("hexaLayout",i.hexaLayout),I("transform",i.getRemainingPieceTransform(t))}}function fht(r,e){if(1&r&&(N(),S(0,"g"),T(1,uht,2,8,"g",1),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t.pieces)}}function dht(r,e){if(1&r&&(N(),F(0,"polygon",11)),2&r){const t=p();I("transform",t.getRemainingPieceHighlightTransform(t.selectedRemaining.get()))("points",t.getHexaPointsAt(t.ORIGIN))}}function hht(r,e){if(1&r&&(N(),F(0,"g",13)),2&r){const t=e.$implicit,n=e.index,i=p(2);zn("id","inspectedStack_",n,""),y("piece",t)("pieceHeight",i.PIECE_HEIGHT)("x",0)("y",0)("hexaLayout",i.hexaLayout)("layer",6*n),I("transform",i.inspectedStackTransform)}}function pht(r,e){if(1&r&&(N(),S(0,"g"),T(1,hht,1,8,"g",12),P()),2&r){const t=p();_(1),y("ngForOf",t.inspectedStack.get().pieces.slice().reverse())}}class Dce extends pae{constructor(...e){super(...e),u(this,"highlighted",[])}initialize(e){this.set(e,{spaceClasses:[],strokeClasses:[],selected:!1})}highlightFill(e,t){this.highlighted.push(e),this.get(e).map(n=>n.spaceClasses.push(t))}highlightStroke(e,t){this.highlighted.push(e),this.get(e).map(n=>n.strokeClasses.push(t))}select(e){this.highlighted.push(e),this.get(e).map(t=>t.selected=!0)}clearHighlights(){for(const e of this.highlighted)this.get(e).map(t=>{t.strokeClasses=[],t.spaceClasses=[],t.selected=!1});this.highlighted=[]}}class ght extends pae{constructor(...e){super(...e),u(this,"highlighted",[])}initialize(e,t){this.set(e,{piece:t,strokeClasses:[]})}highlight(e,t){this.highlighted.push(e),this.get(e).map(n=>n.strokeClasses.push(t))}clearHighlights(){for(const e of this.highlighted)this.get(e).map(t=>{t.strokeClasses=[]});this.highlighted=[]}}let mht=(()=>{var r;class e extends au{constructor(n){super(n),u(this,"ORIGIN",new C(0,0)),u(this,"remainingStacks",[]),u(this,"layers",[]),u(this,"ground",new Dce),u(this,"inspectedStack",g.empty()),u(this,"inspectedStackCoord",g.empty()),u(this,"selectedRemaining",g.empty()),u(this,"selectedStart",g.empty()),u(this,"selectedSpiderCoords",[]),u(this,"PIECE_HEIGHT",void 0),u(this,"boardViewBox",void 0),u(this,"viewBox",void 0),u(this,"inspectedStackTransform",void 0),this.rules=C2.get(),this.node=this.rules.getInitialNode(),this.availableAIs=[new on($localize`Minimax`,C2.get(),new jdt,new Rce),new Kn($localize`MCTS`,new Rce,this.rules)],this.encoder=v2.encoder,this.tutorial=(new zce).tutorial,this.SPACE_SIZE=30,this.PIECE_HEIGHT=this.SPACE_SIZE/3,this.hexaLayout=new cu(1.5*this.SPACE_SIZE,new C(2*this.SPACE_SIZE,0),Br.INSTANCE),this.canPass=!1}updateBoard(n){var i=this;return M(function*(){i.layers=[];for(const o of i.getState().occupiedSpaces()){const a=i.getState().getAt(o),c=o.x,l=o.y;for(let f=0;f<a.size();f++){f in i.layers||(i.layers[f]=new ght);const d=a.pieces[a.size()-1-f];i.layers[f].initialize(new C(c,l),d)}}i.ground=i.getGround(),i.computeViewBox(),i.remainingStacks=i.getState().remainingPieces.toListOfStacks(),i.canPass=C2.get().shouldPass(i.getState());const s=C2.get().getGameStatus(i.node);switch(s){case _e.ONGOING:break;case _e.DRAW:i.highlight(i.getState().queenBeeLocation(k.ZERO).get(),"victory-stroke"),i.highlight(i.getState().queenBeeLocation(k.ONE).get(),"victory-stroke");break;default:const a=s.winner.getOpponent();i.highlight(i.getState().queenBeeLocation(a).get(),"victory-stroke")}})()}highlight(n,i){const s=this.getState().getAt(n).size();s-1 in this.layers&&this.layers[s-1].highlight(n,i)}pass(){var n=this;return M(function*(){return U.assert(n.canPass,"DvonnComponent: pass() can only be called if canPass is true"),yield n.chooseMove(v2.PASS)})()}computeViewBox(){const n=this.getPieceCoords().union(this.getAllNeighbors()).toList();n.push(new C(0,0)),this.boardViewBox=f4.fromHexa(n,this.hexaLayout,this.STROKE_WIDTH);const i=new f4(this.getRemainingPieceTransformAsCoord(new n2(k.ZERO,"QueenBee")).x,0,4*this.SPACE_SIZE*5,0),s=5*this.SPACE_SIZE;let o=0;this.getState().remainingPieces.getAny(k.ZERO).isPresent()&&(o=s);let a=0;this.getState().remainingPieces.getAny(k.ONE).isPresent()&&(a=s);const c=this.boardViewBox.containingAtLeast(i).expand(0,0,o,a);if(this.inspectedStack.isPresent()){const l=new C(c.right()+this.SPACE_SIZE,c.center().y),f=this.inspectedStack.get().size();this.inspectedStackTransform=`translate(${l.x} ${l.y+3*(f-1)*this.PIECE_HEIGHT})`,this.viewBox=c.expand(0,5*this.SPACE_SIZE,0,0).toSVGString()}else this.viewBox=c.toSVGString()}getPieceCoords(){return this.getState().pieces.getKeySet()}getGround(){const n=new Dce;for(const i of this.getAllNeighbors())n.initialize(i);return n}getAllNeighbors(){const n=new dt;for(const i of this.getPieceCoords())n.addAll(new dt(this.getState().emptyNeighbors(i)));return n.isEmpty()&&n.add(new C(0,0)),n}clearHighlights(){for(const n of this.layers)n.clearHighlights();this.ground.clearHighlights()}cancelMoveAttempt(){this.clearHighlights(),this.selectedStart=g.empty(),this.selectedRemaining=g.empty(),this.selectedSpiderCoords=[],this.inspectedStack=g.empty(),this.computeViewBox()}showLastMove(n){var i=this;return M(function*(){for(const s of i.getLastMoveCoords(n))i.highlight(s,"last-move-stroke"),i.ground.highlightStroke(s,"last-move-stroke"),i.ground.highlightFill(s,"moved-fill")})()}getLastMoveCoords(n){let i=[];return n instanceof Xo?i=[n.coord]:n instanceof Gi&&(i=[n.getStart(),n.getEnd()]),i}getRemainingPieceTransformAsCoord(n){const i=this.getRemainingPieceShift(n),s=this.boardViewBox.center().x+i*this.SPACE_SIZE*4;let o;return o=n.owner===this.role?this.boardViewBox.bottom()+3*this.SPACE_SIZE:this.boardViewBox.up-2*this.SPACE_SIZE,new C(s,o)}getRemainingPieceTransform(n){const i=this.getRemainingPieceTransformAsCoord(n);return`translate(${i.x} ${i.y})`}getRemainingPieceHighlightTransform(n){const i=this.getRemainingPieceTransformAsCoord(n),s=this.getState().remainingPieces.getQuantity(n);return`translate(${i.x} ${i.y-this.PIECE_HEIGHT*s})`}getRemainingPieceShift(n){switch(n.kind){case"QueenBee":return-2.5;case"Beetle":return-1.5;case"Grasshopper":return-.5;case"Spider":return.5;default:return U.expectToBe(n.kind,"SoldierAnt"),1.5}}selectRemaining(n){var i=this;return M(function*(){const s=yield i.canUserPlay(`#remainingPiece_${n.toString()}`);if(s.isFailure())return i.cancelMove(s.getReason());if(n.owner===i.getCurrentOpponent())return i.cancelMove(Re.MUST_CHOOSE_PLAYER_PIECE());if("QueenBee"!==n.kind&&C2.get().mustPlaceQueenBee(i.getState()))return i.cancelMove(hr.MUST_PLACE_QUEEN_BEE_LATEST_AT_FOURTH_TURN());if(i.selectedRemaining.equalsValue(n))i.cancelMoveAttempt();else{i.cancelMoveAttempt(),i.selectedRemaining=g.of(n),i.clearHighlights();const o=C2.get().getPossibleDropLocations(i.getState()).toList();for(const a of o)i.ground.highlightStroke(a,"clickable-stroke")}return b.SUCCESS})()}selectStack(n,i){var s=this;return M(function*(){return yield s.select(new C(n,i),"piece")})()}selectSpace(n,i){var s=this;return M(function*(){return yield s.select(new C(n,i),"space")})()}select(n,i){var s=this;return M(function*(){const o=yield s.canUserPlay(`#${i}_${n.x}_${n.y}`);if(o.isFailure())return s.cancelMove(o.getReason());const a=s.getState(),c=a.getAt(n);if(s.selectedRemaining.isPresent()){const l=v2.drop(s.selectedRemaining.get(),n);return s.chooseMove(l)}if(s.selectedStart.isPresent()){const l=a.getAt(s.selectedStart.get()).topPiece();return s.selectedStart.equalsValue(n)?s.cancelMove():s.selectTarget(n,l)}return 0===c.size()?s.cancelMove():s.selectStart(n,c)})()}selectTarget(n,i){var s=this;return M(function*(){if("Spider"===i.kind)return s.selectNextSpiderSpace(n);{const o=v2.move(s.selectedStart.get(),n);return Ze(o.isSuccess(),"Hive: the only forbidden moves are static moves"),s.chooseMove(o.get())}})()}selectStart(n,i){var s=this;return M(function*(){const o=s.getState(),a=i.topPiece();return a.owner===o.getCurrentOpponent()?1===i.size()?s.cancelMove(Re.MUST_CHOOSE_PLAYER_PIECE()):s.inspectedStack.isPresent()?(s.cancelMoveAttempt(),s.clearHighlights(),b.SUCCESS):(s.highlight(n,"selected-stroke"),s.inspectedStack=g.of(i),s.inspectedStackCoord=g.of(n),s.computeViewBox(),b.SUCCESS):(s.cancelMoveAttempt(),s.clearHighlights(),"QueenBee"!==a.kind&&C2.get().mustPlaceQueenBee(o)?s.cancelMove(hr.MUST_PLACE_QUEEN_BEE_LATEST_AT_FOURTH_TURN()):(s.selectedStart=g.of(n),s.highlight(n,"selected-stroke"),"Spider"===a.kind&&s.selectedSpiderCoords.push(s.selectedStart.get()),i.size()>1&&(s.inspectedStack=g.of(i),s.inspectedStackCoord=g.of(n),s.computeViewBox()),s.highlightNextPossibleCoords(n),b.SUCCESS))})()}highlightNextPossibleCoords(n){for(const i of this.getNextPossibleCoords(n))this.highlight(i,"clickable-stroke"),this.ground.highlightStroke(i,"clickable-stroke")}getNextPossibleCoords(n){const i=this.getState(),s=i.getAt(n).topPiece(),o=C2.get().getPossibleMovesFrom(i,n);return"Spider"===s.kind?o.filter(c=>Ie.isPrefix(this.selectedSpiderCoords,c.coords)).map(c=>c.coords[this.selectedSpiderCoords.length]).toList():o.map(a=>a.getEnd()).toList()}selectNextSpiderSpace(n){var i=this;return M(function*(){if(i.selectedSpiderCoords.push(n),4===i.selectedSpiderCoords.length){const o=v2.spiderMove(i.selectedSpiderCoords);return i.chooseMove(o)}const s=Dd.get().prefixLegality(i.selectedSpiderCoords,i.getState());if(s.isFailure())return i.cancelMove(s.getReason());i.clearHighlights(),i.highlight(i.selectedStart.get(),"selected-stroke");for(const o of i.selectedSpiderCoords)i.ground.select(o);return i.highlightNextPossibleCoords(i.selectedStart.get()),b.SUCCESS})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(Ut))}),u(e,"\u0275cmp",qe({type:r,selectors:[["app-hive"]],features:[Qe],decls:8,vars:8,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["id","remaining_highlight","class","base no-fill small-stroke selected-stroke",4,"ngIf"],[4,"ngIf"],[1,"base","mid-stroke",3,"id","ngClass","click"],["class","base no-fill small-stroke",3,"id","ngClass","click",4,"ngIf"],[1,"base","no-fill","small-stroke",3,"id","ngClass","click"],["class","base no-fill small-stroke","ngClass","selected-stroke",3,"id","click",4,"ngIf"],["ngClass","selected-stroke",1,"base","no-fill","small-stroke",3,"id","click"],["app-hive-piece","",3,"id","piece","x","y","pieceHeight","hexaLayout","layer","click"],["app-hive-piece","",3,"id","piece","pieceHeight","x","y","layer","hexaLayout","click"],["id","remaining_highlight",1,"base","no-fill","small-stroke","selected-stroke"],["app-hive-piece","",3,"id","piece","pieceHeight","x","y","hexaLayout","layer",4,"ngFor","ngForOf"],["app-hive-piece","",3,"id","piece","pieceHeight","x","y","hexaLayout","layer"]],template:function(n,i){1&n&&(N(),S(0,"svg",0),T(1,tht,2,4,"g",1),T(2,rht,2,1,"g",1),T(3,sht,2,1,"g",1),T(4,lht,3,2,"g",1),T(5,fht,2,1,"g",1),T(6,dht,1,2,"polygon",2),T(7,pht,2,1,"g",3),P()),2&n&&(I("viewBox",i.viewBox),_(1),y("ngForOf",i.ground),_(1),y("ngForOf",i.ground),_(1),y("ngForOf",i.ground),_(1),y("ngForOf",i.layers),_(1),y("ngForOf",i.remainingStacks),_(1),y("ngIf",i.selectedRemaining.isPresent()),_(1),y("ngIf",i.inspectedStack.isPresent()))},dependencies:[Ft,Wt,At,eht],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();const _ht={CASTLE_IS_LEFT_FOR_GOOD:!1,BORDER_CAN_SURROUND_KING:!0,CENTRAL_THRONE_CAN_SURROUND_KING:!1,KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED:!1,WIDTH:11,INVADER:k.ZERO};class Bc extends bL{static getInitialState(){const e=rn.UNOCCUPIED,t=rn.INVADERS,n=rn.DEFENDERS;return new Bc([[e,e,e,t,t,t,t,t,e,e,e],[e,e,e,e,e,t,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e],[t,e,e,e,e,n,e,e,e,e,t],[t,e,e,e,n,n,n,e,e,e,t],[t,t,e,n,n,rn.PLAYER_ONE_KING,n,n,e,t,t],[t,e,e,e,n,n,n,e,e,e,t],[t,e,e,e,e,n,e,e,e,e,t],[e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,t,e,e,e,e,e],[e,e,e,t,t,t,t,t,e,e,e]],0)}of(e,t){return new Bc(e,t)}}class vs extends OL{static of(e,t){return new vs(e,t)}static from(e,t){try{const n=new vs(e,t);return ie.success(n)}catch(n){return ie.failure(n.message)}}getMaximalDistance(){return 11}}u(vs,"encoder",Hs.getFallibleEncoder(vs.from));class Il extends wL{static get(){return Il.singleton.isAbsent()&&(Il.singleton=g.of(new Il)),Il.singleton.get()}constructor(){super(Bc,_ht,vs.from)}}u(Il,"singleton",g.empty());const A=rn.UNOCCUPIED,Nt=rn.INVADERS,pr=rn.DEFENDERS,EC=rn.PLAYER_ONE_KING;class Vce extends Zn{constructor(...e){super(...e),u(this,"tutorial",[q.informational($localize`Goal of the game`,$localize`Hnefatafl is a strategy game that was played by the vikings, it's part of a larger family of games called Tafl. The goal of the game is different for each player. The attacker plays first. Their pieces (dark) are close to the edges. Their goal is to capture the king, which is in the center of the board. The defender plays second. Their pieces (light) are in the middle. Their goal is to move the king on one of the 4 thrones in the corners. Note that the square in which the king starts, in the center of the board, is also a throne.`,Bc.getInitialState()),q.anyMove($localize`Moving`,$localize`All pieces move the same way. Similarly to a rook in chess, a piece can move:<ol><li>By as many squares as you want.</li><li>Without going over another piece or stopping on another piece.</li><li>Horizontally or vertically.</li><li>Only the king can land on a throne.</li></ol>To move a piece, click on it and then on its landing square.<br/><br/>You're playing Dark, do the first move.`,Bc.getInitialState(),vs.of(new C(5,1),new C(1,1)),$localize`Congratulations!`),q.fromMove($localize`Capturing a soldier (1/2)`,$localize`All pieces, attackers and defenders, except the king, are soldiers. To capture them, they have to be sandwiched between two of your pieces. By getting too close, an attacker's soldier is in danger.<br/><br/>You're playing Light. Capture the soldier.`,new Bc([[A,A,A,A,Nt,Nt,Nt,Nt,A,A,A],[A,A,A,A,A,Nt,A,A,A,A,A],[A,A,A,A,A,A,A,A,A,A,A],[Nt,A,A,A,A,pr,A,A,A,A,Nt],[Nt,A,A,Nt,pr,pr,pr,A,A,A,Nt],[Nt,Nt,A,pr,pr,EC,pr,pr,A,Nt,Nt],[Nt,A,A,A,pr,pr,pr,A,A,A,Nt],[Nt,A,A,A,A,pr,A,A,A,A,Nt],[A,A,A,A,A,A,A,A,A,A,A],[A,A,A,A,A,Nt,A,A,A,A,A],[A,A,A,Nt,Nt,Nt,Nt,Nt,A,A,A]],1),[vs.of(new C(5,3),new C(3,3))],$localize`Congratulations, that will teach him a lesson!`,$localize`Failed, you missed an opportunity to capture a piece of the opponent.`).withPreviousMove(vs.of(new C(3,0),new C(3,4))),q.fromMove($localize`Capturing a soldier (2/2)`,$localize`A second way to capture a soldier is to sandwich it against an empty throne. The king has moved and endangered one of its soldiers.<br/><br/>You're playing Dark. Capture the soldier.`,new Bc([[A,A,A,Nt,Nt,Nt,Nt,Nt,A,A,A],[A,pr,A,A,A,Nt,A,A,A,A,A],[A,A,A,A,A,A,A,A,A,A,A],[A,A,A,A,A,pr,A,A,A,A,Nt],[Nt,A,A,A,A,pr,pr,A,A,A,Nt],[Nt,Nt,EC,A,pr,A,pr,pr,A,A,Nt],[A,A,Nt,A,A,pr,pr,A,A,A,Nt],[Nt,A,A,A,A,pr,A,A,A,A,A],[A,A,A,A,A,A,A,A,A,A,A],[A,Nt,A,A,A,A,A,A,A,A,A],[A,A,A,Nt,Nt,Nt,Nt,A,Nt,A,A]],12),[vs.of(new C(3,0),new C(3,5)),vs.of(new C(3,10),new C(3,5))],$localize`Congratulations, one less defender. But keep an eye on the king, it is the most important.`,$localize`Failed, you did not do the expected move.`),q.fromMove($localize`Capturing the king (1/2)`,$localize`To capture the king, two soldiers are not enough. For the first solution, the four squares neighbor to the king (horizontally and vertically) must be occupied by your soldiers. This also works if the king is on the throne.<br/><br/>You're playing Dark, capture the king.`,new Bc([[A,A,A,A,A,A,A,A,A,A,A],[A,A,A,A,A,A,A,A,A,A,A],[A,A,A,A,A,A,A,A,A,A,A],[A,Nt,A,A,A,A,A,A,A,A,A],[Nt,EC,A,Nt,A,A,A,A,A,A,A],[A,Nt,A,A,A,A,A,A,A,A,A],[A,A,A,A,A,A,A,A,A,A,A],[A,A,A,A,A,A,A,A,A,A,A],[A,A,A,A,A,A,A,A,A,A,A],[A,A,A,A,A,A,A,A,A,A,A],[A,A,A,A,A,A,A,A,A,A,A]],72),[vs.of(new C(3,4),new C(2,4))],$localize`Congratulations, you won!`,$localize`Failed, you let the king run away.`),q.fromMove($localize`Capturing the king (2/2)`,$localize`Another way to capture the king is to immobilize it against an edge of the board. Note that the king cannot be captured next to a throne.<br/><br/>You're playing Dark, capture the king.`,new Bc([[A,A,Nt,EC,Nt,A,A,A,A,A,A],[A,A,A,A,A,A,pr,A,A,A,A],[A,A,A,A,A,A,A,A,A,A,A],[A,A,A,Nt,A,A,A,A,A,A,A],[A,A,A,A,A,A,A,A,A,A,A],[A,A,A,A,A,A,A,A,A,A,A],[A,A,A,A,A,A,A,A,A,A,A],[A,A,A,A,A,A,A,A,A,A,A],[A,A,A,A,A,A,A,A,A,A,A],[A,A,A,A,A,A,A,A,A,A,A],[A,A,A,A,A,A,A,A,A,A,A]],72),[vs.of(new C(3,3),new C(3,1))],$localize`The king is dead, long live the king. Congratulations, you won.`,$localize`Failed. Try again.`)])}}function vht(r,e){1&r&&(N(),F(0,"polygon",8))}function Cht(r,e){1&r&&(N(),F(0,"rect",9))}function yht(r,e){if(1&r&&(N(),S(0,"g"),T(1,vht,1,0,"polygon",6),T(2,Cht,1,0,"ng-template",null,7,un),P()),2&r){const t=cn(3),n=p().index,i=p().index,s=p();_(1),y("ngIf",s.isCentralThrone(n,i))("ngIfElse",t)}}function Mht(r,e){if(1&r&&(N(),S(0,"g"),F(1,"line",13)(2,"line",13)(3,"line",13)(4,"line",13)(5,"line",13),P()),2&r){const t=p(2).index,n=p().index,i=p();_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),I("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),I("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.1*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),I("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.9*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),I("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.15*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),I("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.85*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE)}}function Eht(r,e){if(1&r&&(N(),F(0,"polyline",16)),2&r){const t=p(3).index,n=p().index;y("ngClass",p().viewInfo.pieceClasses[n][t])}}function Sht(r,e){if(1&r&&(N(),F(0,"line",13)(1,"line",13)(2,"line",13)(3,"line",13)),2&r){const t=p(3).index,n=p().index,i=p();y("ngClass",i.viewInfo.pieceClasses[n][t]),I("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),I("x1",.04*i.SPACE_SIZE)("y1",.5*i.SPACE_SIZE)("x2",.96*i.SPACE_SIZE)("y2",.5*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),I("x1",.2*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.8*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),I("x1",.8*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.2*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE)}}function Pht(r,e){if(1&r&&(N(),T(0,Eht,1,1,"polyline",14),T(1,Sht,4,20,"ng-template",null,15,un)),2&r){const t=cn(2),n=p(2).index,i=p().index;y("ngIf",p().isKing(n,i))("ngIfElse",t)}}function Tht(r,e){if(1&r&&(N(),S(0,"g"),F(1,"circle",10),T(2,Mht,6,25,"g",11),T(3,Pht,3,2,"ng-template",null,12,un),P()),2&r){const t=cn(4),n=p().index,i=p().index,s=p();_(1),ye("id","piece_",n,"_",i,""),y("ngClass",s.viewInfo.pieceClasses[i][n]),I("r",s.SPACE_SIZE/2-s.STROKE_WIDTH)("cx",.5*s.SPACE_SIZE)("cy",.5*s.SPACE_SIZE),_(1),y("ngIf",s.isInvader(n,i))("ngIfElse",t)}}function Oht(r,e){if(1&r){const t=pe();N(),S(0,"g",3),W("click",function(){const s=te(t).index,o=p().index;return ne(p().onClick(s,o))}),F(1,"rect",4),T(2,yht,4,2,"g",5),T(3,Tht,5,8,"g",5),P()}if(2&r){const t=e.index,n=p().index,i=p();ye("id","click_",t,"_",n,""),I("transform","translate("+i.SPACE_SIZE*t+", "+i.SPACE_SIZE*n+")"),_(1),ye("id","space_",t,"_",n,""),y("ngClass",i.getRectClasses(t,n)),I("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),_(1),y("ngIf",i.board[n][t]===i.EMPTY&&i.isThrone(t,n)),_(1),y("ngIf",i.board[n][t]!==i.EMPTY)}}function bht(r,e){if(1&r&&(N(),S(0,"g"),T(1,Oht,4,10,"g",2),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function wht(r,e){if(1&r){const t=pe();N(),S(0,"g")(1,"rect",17),W("click",function(){const s=te(t).$implicit;return ne(p().onClick(s.x,s.y))}),P()()}if(2&r){const t=e.$implicit,n=p();_(1),ye("id","click_",t.x,"_",t.y,""),I("x",n.SPACE_SIZE*t.x)("y",n.SPACE_SIZE*t.y)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}let Aht=(()=>{var r;class e extends AL{constructor(n){super(n,vs.from),this.rules=Il.get(),this.node=this.rules.getInitialNode(),this.availableAIs=this.createAIs(),this.encoder=vs.encoder,this.tutorial=(new Vce).tutorial}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(Ut))}),u(e,"\u0275cmp",qe({type:r,selectors:[["app-hnefatafl"]],features:[Qe],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["x","0","y","0",1,"base",3,"id","ngClass"],[4,"ngIf"],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60","class","base",4,"ngIf","ngIfElse"],["cornerThrone",""],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60",1,"base"],["x","15","y","15","width","70","height","70",1,"base"],[1,"base",3,"id","ngClass"],[4,"ngIf","ngIfElse"],["defender",""],[1,"base",3,"ngClass"],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85","class","base no-fill",3,"ngClass",4,"ngIf","ngIfElse"],["soldierDefender",""],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85",1,"base","no-fill",3,"ngClass"],[1,"no-fill","mid-stroke","clickable-stroke",3,"id","click"]],template:function(n,i){1&n&&(N(),S(0,"svg",0),T(1,bht,2,1,"g",1),T(2,wht,2,6,"g",1),P()),2&n&&(I("viewBox",i.getViewBox()),_(1),y("ngForOf",i.board),_(1),y("ngForOf",i.getClickables()))},dependencies:[Ft,Wt,At],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();class Nht extends kae{constructor(e,t){super(e,t)}updateOrCreateCurrentMove(e){if(this.currentMove.isAbsent())this.hideLastMove(),this.currentMove=g.of(this.generateMove(e));else{const t=this.addToMove(e);this.currentMove=g.of(t)}}}class d4 extends ps{static get(){return d4.singleton.isAbsent()&&(d4.singleton=g.of(new d4)),d4.singleton.get()}constructor(){super({passByPlayerStore:!0,mustFeed:!1,feedOriginalHouse:!0})}isLegal(e,t){const n=t.getCurrentPlayerY();let i=!0;for(const s of e){U.assert(!0===i,"CANNOT_PLAY_AFTER_NON_KALAH_MOVE");const o=this.isLegalDistribution(s,t);if(o.isFailure())return b.ofFallible(o);t=this.distributeHouse(s.x,n,t).resultingState,i=o.get()}return U.assert(!1===i,"MUST_CONTINUE_PLAYING_AFTER_KALAH_MOVE"),b.SUCCESS}isLegalDistribution(e,t){const n=t.getCurrentPlayerY();if(0===t.getPieceAtXY(e.x,n))return ie.failure(uu.MUST_CHOOSE_NON_EMPTY_HOUSE());const i=this.distributeHouse(e.x,n,t),s=ps.isStarving(i.resultingState.getCurrentPlayer(),i.resultingState.board);return ie.success(i.endsUpInKalah&&!1===s)}distributeMove(e,t){const n=t.getCurrentPlayer().value,i=t.getCurrentPlayerY(),s=[];let o=0,a=!1,c=t;for(const d of e){const m=this.distributeHouse(d.x,i,c);c.getScoresCopy()[n]+=m.passedByKalahNTimes,c=m.resultingState,s.push(...m.filledCoords),o+=m.passedByKalahNTimes,a=m.endsUpInKalah}const l=c.getScoresCopy();return l[n]+=o,{endsUpInKalah:a,filledCoords:s,passedByKalahNTimes:o,resultingState:new Sn(c.getCopiedBoard(),c.turn,l)}}applyCapture(e){const t=e.resultingState,n={capturedSum:0,captureMap:[[0,0,0,0,0,0],[0,0,0,0,0,0]],resultingState:t};if(e.endsUpInKalah)return n;{const i=e.filledCoords[e.filledCoords.length-1],s=e.resultingState.getCurrentPlayerY(),o=e.resultingState.getOpponentY(),a=e.resultingState.getPieceAt(i),c=e.resultingState.getPieceAtXY(i.x,o);if(i.y===s&&1===a&&c>0){const l=t.getCopiedBoard(),f=l[0][i.x]+l[1][i.x],d=Ie.createTable(Sn.WIDTH,2,0);d[0][i.x]=l[0][i.x],d[1][i.x]=l[1][i.x],l[0][i.x]=0,l[1][i.x]=0;const m=t.getScoresCopy();return m[t.getCurrentPlayer().value]+=f,{capturedSum:f,captureMap:d,resultingState:new Sn(l,t.turn,m)}}return n}}}var Fce;u(d4,"singleton",g.empty());class Jo extends bae{static of(e,t=[]){const n=[e];return n.push(...t),new Jo(n)}add(e){return Jo.of(this.distributions[0],this.distributions.slice(1).concat(e))}toString(){return"KalahMove(["+this.distributions.map(t=>t.x).join(", ")+"])"}equals(e){return Ie.compareArray(this.distributions,e.distributions)}}Fce=Jo,u(Jo,"encoder",we.tuple([we.list(d1.encoder)],r=>[r.distributions],r=>Fce.of(r[0][0],r[0].slice(1))));class $ce extends Zn{constructor(...e){super(...e),u(this,"gameName",$localize`Kalah`),u(this,"tutorial",[q.informational(this.gameName,$localize`${this.gameName} is a Mancala. Mancala is the name of a family of board games that dates back at least to the third century. Mancalas are games of distribution (sowing) and capture. Their goal is to capture the most seeds. The spaces in Mancalas are called the houses. The ones on the extreme left and right are called the stores, they contain the seeds that each player won. As you are playing Dark, the 6 houses on the bottom are yours.`,Sn.getInitialState()),q.informational($localize`Kalah`,$localize`Bonus fact: Kalah has been created in the U.S.A in 1940 by William Julius Champion Jr.`,Sn.getInitialState()),wae.SOWING(Jo.of(d1.FIVE)),q.forClick($localize`The Kalah (1/2)`,$localize`The houses on the extreme left and right, unaligned with the others, are the Kalah. Yours is on the left, the opponent's on the right. When sowing, before passing from your last house to the first of the opponent, you must drop one seed in your Kalah, but you won't have to drop seed in your opponent's Kalah. When you make a capture, the captured seeds are put in your Kalah.<br/><br/>You're playing Dark. Make a move that passes through your Kalah then feeds opponent's houses.`,Sn.getInitialState(),["#click_0_1","#click_1_1","#click_2_1"],$localize`As you see, three houses have been fed in addition to your Kalah.`,$localize`Failed. Choose the three leftmost house on the bottom.`),q.fromPredicate($localize`The Kalah (2/2)`,$localize`When ending in the Kalah, you must distribute again.<br/><br/>You're playing Dark, play the house that ends up in the Kalah then do a second distribution!`,Sn.getInitialState(),Jo.of(d1.THREE,[d1.ONE]),(t,n,i)=>1===t.distributions.length?b.failure($localize`This move only distributed one house, do one distribution that ends in the Kalah, then do a second one!`):b.SUCCESS,$localize`Congratulations!`),q.fromPredicate($localize`Capture`,$localize`When the last seed of a distribution ends up in one of your empty houses, if the opposite house is filled, then you capture both houses. On this board, such a move is possible.<br/><br/>You're playing Dark, do a capture!`,new Sn([[0,4,4,4,4,4],[0,2,0,2,4,0]],4,[0,0]),Jo.of(d1.ONE,[d1.ZERO,d1.THREE]),(t,n,i)=>0===i.getPieceAtXY(1,0)?b.SUCCESS:b.failure($localize`You did not capture, try again!`),$localize`Congratulations!`),q.fromMove($localize`End of the game`,$localize`At any moment, when one player has more than 24 seeds in their Kalah, they win. That can happen before the board is empty, but, there is also a second way. When you don't have any seed in your houses, the game is over and your opponent takes all the remaining seeds from their houses. Here, your opponent just need one more point to win and will get it next turn if you allow it.<br/><br/>You're playing Dark, win!`,new Sn([[0,0,0,0,2,0],[2,0,0,0,0,1]],0,[19,24]),[Jo.of(d1.FIVE)],$localize`Since there is no longer seeds in the opponent houses, all your seeds have been captured by you. Congratulations, you won!`,$localize`Failed, you gave the opponent a seed! Try again.`)])}}class Iht extends Un{getListMoves(e){const t=[],n=e.gameState.getCurrentPlayerY();for(let i=0;i<Sn.WIDTH;i++)if(e.gameState.getPieceAtXY(i,n)>0){const s=e.gameState,o=Jo.of(d1.of(i));t.push(...this.getPossibleMoveContinuations(s,i,n,o))}return t}getPossibleMoveContinuations(e,t,n,i){const s=[],o=d4.get().distributeHouse(t,n,e),a=o.resultingState,c=!1===ps.isStarving(a.getCurrentPlayer(),a.board);if(o.endsUpInKalah&&c){for(let l=0;l<Sn.WIDTH;l++)if(a.getPieceAtXY(l,n)>0){const f=i.add(d1.of(l));s.push(...this.getPossibleMoveContinuations(a,l,n,f))}return s}return[i]}}function kht(r,e){if(1&r){const t=pe();N(),S(0,"g")(1,"g",8),W("click",function(){const s=te(t).index,o=p().index;return ne(p().onClick(s,o))}),P()()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,s=p();_(1),ye("id","click_",n,"_",i,""),y("x",n)("y",i)("content",t)("spaceClasses",s.getSpaceClasses(n,i))("rotation",s.getPieceRotation())("secondaryContent",s.getHouseSecondaryContent(n,i)),I("transform",s.getPieceTransform(n,i))}}function xht(r,e){if(1&r&&(N(),S(0,"g"),T(1,kht,2,9,"g",2),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}let Lht=(()=>{var r;class e extends Nht{constructor(n,i){super(n,i),this.rules=d4.get(),this.node=this.rules.getInitialNode(),this.availableAIs=this.createAIs(new Iht),this.encoder=Jo.encoder,this.tutorial=(new $ce).tutorial}generateMove(n){return Jo.of(d1.of(n))}addToMove(n){return this.currentMove.get().add(d1.of(n))}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(Ut),B(S3))}),u(e,"\u0275cmp",qe({type:r,selectors:[["app-kalah-component"]],features:[Qe],decls:8,vars:14,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-5 -5 870 250","preserveAspectRatio","xMidYMid meet"],["x","0","y","0","ry","115","rx","115","width","860","height","240","fill","blue",1,"base"],[4,"ngFor","ngForOf"],["x1","120","y1","120","x2","740","y2","120",1,"base"],["x1","120","y1","0","x2","120","y2","240",1,"base"],["x1","740","y1","0","x2","740","y2","240",1,"base"],["id","store_player_0","app-numbered-circle","","transform","translate(60 120)",3,"x","y","content","spaceClasses","rotation","secondaryContent","click"],["id","store_player_1","app-numbered-circle","","transform","translate(800 120)",3,"x","y","content","spaceClasses","rotation","secondaryContent","click"],["app-numbered-circle","",3,"id","x","y","content","spaceClasses","rotation","secondaryContent","click"]],template:function(n,i){1&n&&(N(),S(0,"svg",0),F(1,"rect",1),T(2,xht,2,1,"g",2),F(3,"line",3)(4,"line",4)(5,"line",5),S(6,"g",6),W("click",function(){return i.onStoreClick(i.Player.ZERO)}),P(),S(7,"g",7),W("click",function(){return i.onStoreClick(i.Player.ONE)}),P()()),2&n&&(I("transform",i.rotation),_(2),y("ngForOf",i.board),_(4),y("x",-1)("y",-1)("content",i.getStoreContent(i.Player.ZERO))("spaceClasses",i.getSpaceClasses(-1,-1))("rotation",i.getPieceRotation())("secondaryContent",i.getStoreSecondaryContent(i.Player.ZERO)),_(1),y("x",2)("y",2)("content",i.getStoreContent(i.Player.ONE))("spaceClasses",i.getSpaceClasses(2,2))("rotation",i.getPieceRotation())("secondaryContent",i.getStoreSecondaryContent(i.Player.ONE)))},dependencies:[Wt,xae],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"],changeDetection:0})),e})();var Uc,SC,WL,y2;class _n{static of(e){switch(e){case 0:return _n.ANY;case 1:return _n.ORANGE;case 2:return _n.BLUE;case 3:return _n.PURPLE;case 4:return _n.PINK;case 5:return _n.YELLOW;case 6:return _n.RED;case 7:return _n.GREEN;default:return U.expectToBe(e,8,"Invalid value "+e+" for KamisadoColor"),_n.BROWN}}constructor(e,t,n){u(this,"value",void 0),u(this,"name",void 0),u(this,"rgb",void 0),this.value=e,this.name=t,this.rgb=n}}u(_n,"ANY",new(Uc=_n)(0,"any","#000")),u(_n,"ORANGE",new Uc(1,"orange","#d67421")),u(_n,"BLUE",new Uc(2,"blue","#006bac")),u(_n,"PURPLE",new Uc(3,"purple","#6f3787")),u(_n,"PINK",new Uc(4,"pink","#d2719e")),u(_n,"YELLOW",new Uc(5,"yellow","#e2c200")),u(_n,"RED",new Uc(6,"red","#d23339")),u(_n,"GREEN",new Uc(7,"green","#009157")),u(_n,"BROWN",new Uc(8,"brown","#562500"));class hn{constructor(e,t){u(this,"player",void 0),u(this,"color",void 0),this.player=e,this.color=t}static of(e,t){return new hn(e,_n.of(t))}static createPlayerColors(e){return{ORANGE:new hn(e,_n.ORANGE),BLUE:new hn(e,_n.BLUE),PURPLE:new hn(e,_n.PURPLE),PINK:new hn(e,_n.PINK),YELLOW:new hn(e,_n.YELLOW),RED:new hn(e,_n.RED),GREEN:new hn(e,_n.GREEN),BROWN:new hn(e,_n.BROWN)}}equals(e){return e.player===this.player&&e.color===this.color}isEmpty(){return this.player.equals(K.NONE)}belongsTo(e){return this.player===e}}u(hn,"EMPTY",new(SC=hn)(K.NONE,_n.ANY)),u(hn,"ZERO",SC.createPlayerColors(k.ZERO)),u(hn,"ONE",SC.createPlayerColors(k.ONE));class pi{static getColorAt(e,t){return pi.COLORS[t][e]}static getInitialBoard(){const e=hn.EMPTY;return[[1,2,3,4,5,6,7,8].map(t=>hn.of(k.ONE,t)),[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[8,7,6,5,4,3,2,1].map(t=>hn.of(k.ZERO,t))]}static isEmptyAt(e,t){return e[t.y][t.x].equals(hn.EMPTY)}static allPieceCoords(e){const t=[];for(let n=0;n<e.length;n++)for(let i=0;i<e[n].length;i++){const s=new C(i,n);!1===pi.isEmptyAt(e,s)&&t.push(s)}return t}}u(pi,"INITIAL",pi.getInitialBoard()),u(pi,"SIZE",8),u(pi,"COLORS",Ie.mapBiArray([[1,2,3,4,5,6,7,8],[6,1,4,7,2,5,8,3],[7,4,1,6,3,8,5,2],[4,3,2,1,8,7,6,5],[5,6,7,8,1,2,3,4],[2,5,8,3,6,1,4,7],[3,8,5,2,7,4,1,6],[8,7,6,5,4,3,2,1]],_n.of));class ea extends W1{static isOnBoard(e){return e.isInRange(pi.SIZE,pi.SIZE)}static getInitialState(){return new ea(0,_n.ANY,g.empty(),!1,pi.INITIAL)}constructor(e,t,n,i,s){super(Ie.copyBiArray(s),e),u(this,"colorToPlay",void 0),u(this,"coordToPlay",void 0),u(this,"alreadyPassed",void 0),this.colorToPlay=t,this.coordToPlay=n,this.alreadyPassed=i}}class yu extends Di{constructor(){super()}length(){return 0}equals(e){return this===e}toString(){return"KamisadoMove(PASS)"}}u(yu,"PASS",new(WL=yu)),u(yu,"encoder",we.constant("PASS",WL.PASS));class L0 extends $o{static of(e,t){return U.assert(ea.isOnBoard(e),"Starting coord of KamisadoMove must be on the board, not at "+e.toString()),U.assert(ea.isOnBoard(t),"End coord of KamisadoMove must be on the board, not at "+t.toString()),new L0(e,t)}constructor(e,t){super(e,t)}equals(e){return e===this||!!y2.isPiece(e)&&!1!==e.getStart().equals(this.getStart())&&e.getEnd().equals(this.getEnd())}toString(){return"KamisadoMove("+this.getStart()+"->"+this.getEnd()+")"}}function Rht(r){return r instanceof yu}u(L0,"encoder",Hs.getEncoder(L0.of)),function(r){r.PASS=yu.PASS,r.of=function e(n,i){return L0.of(n,i)},r.isPiece=function t(n){return n instanceof L0},r.encoder=we.disjunction([r.isPiece,Rht],[L0.encoder,yu.encoder])}(y2||(y2={}));let Fd=(()=>{class r{}return u(r,"NOT_RIGHT_COLOR",()=>$localize`This piece is not of the color you have to play.`),u(r,"DIRECTION_NOT_ALLOWED",()=>$localize`You can only move forward, orthogonally or diagonally.`),u(r,"MOVE_BLOCKED",()=>$localize`This move is blocked by another piece.`),u(r,"PLAY_WITH_SELECTED_PIECE",()=>$localize`You must play with the selected piece.`),r})();class B2 extends Yn{static get(){return B2.singleton.isAbsent()&&(B2.singleton=g.of(new B2)),B2.singleton.get()}constructor(){super(ea)}static getColorMatchingPiece(e){return e.coordToPlay.isPresent()?[e.coordToPlay.get()]:[new C(0,7),new C(1,7),new C(2,7),new C(3,7),new C(4,7),new C(5,7),new C(6,7),new C(7,7)]}static getMovablePieces(e){return B2.getColorMatchingPiece(e).filter(t=>{for(const n of this.playerDirections(e.getCurrentPlayer())){const i=t.getNext(n);if(e.isOnBoard(i)&&pi.isEmptyAt(e.board,i))return!0}return!1})}static playerDirections(e){return e===k.ONE?[Me.DOWN,Me.DOWN_LEFT,Me.DOWN_RIGHT]:[Me.UP,Me.UP_LEFT,Me.UP_RIGHT]}static directionAllowedForPlayer(e,t){return t===k.ZERO?e.y<0:e.y>0}static mustPass(e){return 0===this.getMovablePieces(e).length}static getFurthestPiecePositions(e){let t=7,n=0;return pi.allPieceCoords(e.board).forEach(i=>{const s=e.getPieceAt(i);Ze(s!==hn.EMPTY,"allPieceCoords failed to filter KamisadoPiece.EMPTY"),s.player===k.ONE?n=Math.max(n,i.y):t=Math.min(t,i.y)}),[t,n]}static isLegal(e,t){if(y2.isPiece(e)){const n=e.getStart(),i=e.getEnd(),s=t.colorToPlay,o=t.getPieceAt(n);if(!1===o.belongsTo(t.getCurrentPlayer()))return b.failure(Re.MUST_CHOOSE_PLAYER_PIECE());if(s!==_n.ANY&&o.color!==s)return b.failure(Fd.NOT_RIGHT_COLOR());if(!1===t.getPieceAt(i).isEmpty())return b.failure(Re.MUST_CLICK_ON_EMPTY_SPACE());const c=Me.factory.fromMove(n,i);if(c.isFailure())return b.failure(Fd.DIRECTION_NOT_ALLOWED());const l=c.get();if(!1===B2.directionAllowedForPlayer(l,t.getCurrentPlayer()))return b.failure(Fd.DIRECTION_NOT_ALLOWED());let f=n;for(;!1===f.equals(i);)if(f=f.getNext(l),!1===t.getPieceAt(f).isEmpty())return b.failure(Fd.MOVE_BLOCKED());return b.SUCCESS}return this.isLegalPass(t)}static isLegalPass(e){return this.mustPass(e)&&!1===e.alreadyPassed?b.SUCCESS:b.failure(Re.CANNOT_PASS())}nextCoordToPlay(e,t){return g.ofNullable(pi.allPieceCoords(e.board).find(n=>{const i=e.getPieceAt(n);return i.player===e.getCurrentOpponent()&&i.color===t}))}applyLegalMove(e,t,n){if(y2.isPiece(e)){const i=e.getStart(),s=e.getEnd(),o=t.getCopiedBoard();o[s.y][s.x]=o[i.y][i.x],o[i.y][i.x]=hn.EMPTY;const a=pi.getColorAt(s.x,s.y),c=this.nextCoordToPlay(t,a);return new ea(t.turn+1,a,c,!1,o)}{const i=this.nextCoordToPlay(t,t.colorToPlay);return new ea(t.turn+1,t.colorToPlay,i,!0,t.board)}}isLegal(e,t){return B2.isLegal(e,t)}getGameStatus(e){const t=e.gameState,n=t.getCurrentPlayer();if(B2.mustPass(t)&&t.alreadyPassed)return _e.getDefeat(n);const[i,s]=B2.getFurthestPiecePositions(t);return 7===s?_e.ONE_WON:0===i?_e.ZERO_WON:_e.ONGOING}}u(B2,"singleton",g.empty());const Y=hn.EMPTY,PC=hn.ZERO.ORANGE,TC=hn.ONE.ORANGE,OC=hn.ZERO.BLUE,bC=hn.ONE.BLUE,qL=hn.ZERO.PURPLE,$d=hn.ONE.PURPLE,wC=hn.ZERO.PINK,AC=hn.ONE.PINK,NC=hn.ZERO.YELLOW,IC=hn.ONE.YELLOW,kC=hn.ZERO.RED,xC=hn.ONE.RED,LC=hn.ZERO.GREEN,RC=hn.ONE.GREEN,zC=hn.ZERO.BROWN,DC=hn.ONE.BROWN;class Uce extends Zn{constructor(...e){super(...e),u(this,"tutorial",[q.informational($localize`Goal of the game`,$localize`At Kamisado, there are two ways to win the game:
        either by moving one of your pieces on the opponent's starting line,
        or by forcing the opponent to make a move that blocks the entire game.
        Here, Dark wins because its brown piece is on Light's starting line, on the top left.`,new ea(5,_n.ORANGE,g.empty(),!1,[[zC,bC,$d,AC,IC,xC,RC,DC],[Y,Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,TC,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y,Y],[Y,LC,kC,NC,wC,qL,OC,PC]])).withPreviousMove(y2.of(new C(0,7),new C(0,0))),q.anyMove($localize`Initial board and initial move`,$localize`Here is the initial board.
        At Kamisado, pieces can only move forward, vertically or diagonally.
        You're playing first, with dark pieces, you can make your first move.<br/><br/>
        You're playing Dark, click on the piece of your choice and click on a landing square.`,ea.getInitialState(),y2.of(new C(7,7),new C(3,3)),$localize`Perfect! Note that each of your piece has a different color.`),q.fromMove($localize`Moving`,$localize`Let us now consider the move of Light, after the blue piece has been moved by Dark.
        All moves after the initial move must be made from the piece that corresponds to the color
        of the square upon which the last move ended.
        Here, the last move ended on the pink square, hence the pink piece must move.
        It is already selected, you do not have to click on it.<br/><br/>
        You're playing Light, move your piece on a blue square.`,new ea(1,_n.PINK,g.of(new C(3,0)),!1,[[TC,bC,$d,AC,IC,xC,RC,DC],[Y,Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,OC,Y],[Y,Y,Y,Y,Y,Y,Y,Y],[zC,LC,kC,NC,wC,qL,Y,PC]]),[y2.of(new C(3,0),new C(3,6)),y2.of(new C(3,0),new C(4,1))],$localize`Congratulations!`,$localize`You have not moved your pink piece on a blue square!`).withPreviousMove(y2.of(new C(6,7),new C(6,5))),q.informational($localize`Stuck situation`,$localize`Dark moved to another pink square, hence you have to move your pink piece again.
        However, your pink piece is stuck! In this case, you must pass your turn.
        Dark will now have to play by moving its pink piece.`,new ea(1,_n.PINK,g.of(new C(3,6)),!1,[[TC,bC,$d,Y,IC,xC,RC,DC],[Y,Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y,OC],[Y,Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,AC,Y,Y,Y,Y],[zC,LC,kC,NC,wC,qL,Y,PC]])).withPreviousMove(y2.of(new C(6,5),new C(7,4))),q.fromMove($localize`Victory by blocking`,$localize`At any time, if a player blocks the entire game, that player loses.
        In other words, if a player forces its opponent to move a piece that the opponent cannot move,
        and the player cannot move its own piece of the same color, then that player loses.
        Here, you're playing Dark and you can force your opponent to create such a situation, hence you can force your opponent to lose!<br/><br/>
        You're playing Dark, analyze the board and make the winning move.`,new ea(2,_n.RED,g.of(new C(2,4)),!1,[[Y,bC,$d,Y,Y,xC,Y,Y],[Y,Y,Y,IC,Y,Y,Y,Y],[Y,Y,Y,AC,Y,$d,Y,Y],[Y,Y,Y,NC,Y,Y,Y,Y],[Y,Y,kC,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,RC,Y],[TC,Y,Y,Y,Y,wC,Y,DC],[zC,LC,Y,Y,Y,Y,OC,PC]]),[y2.of(new C(2,4),new C(0,2))],$localize`Perfect!
         Your opponent must move its green piece on the orange square, forcing you to play with your orange piece.
         Your orange piece will be stuck and you will have to pass your turn.
         Your opponent will have to pass its turn too because its orange piece is also stuck: the game is completely stuck.
         In this case, the last player to have moved a piece loses.
         Here, your opponent will have moved its green piece last, you therefore win!`,$localize`Failed. Try again.`).withPreviousMove(y2.of(new C(4,0),new C(3,1)))])}}class zht extends fr{getMetrics(e){const t=e.gameState,[n,i]=B2.getFurthestPiecePositions(t);return[7-n,i]}}class Wce extends Un{getListMoves(e){const t=e.gameState,n=B2.getMovablePieces(t);if(0===n.length)return U.assert(!1===t.alreadyPassed,"getListMovesFromState should not be called once game is ended."),[y2.PASS];{const i=this.getListMovesFromNonBlockedState(t,n);return Ie.sortByDescending(i,s=>s.length()),i}}getListMovesFromNonBlockedState(e,t){const n=[],i=e.getCurrentPlayer();for(const s of t)for(const o of B2.playerDirections(i))for(let a=1;a<pi.SIZE;a++){const c=s.getNext(o,a);if(!e.isOnBoard(c)||!pi.isEmptyAt(e.board,c))break;{const l=y2.of(s,c);n.push(l)}}return n}}function Dht(r,e){if(1&r&&(N(),F(0,"circle",8)),2&r){const t=p(),n=t.$implicit,i=t.index,s=p().index,o=p();y("ngClass",o.piecePlayerClass(n)),I("cx",o.SPACE_SIZE/2+i*o.SPACE_SIZE)("cy",o.SPACE_SIZE/2+s*o.SPACE_SIZE)("r",o.SPACE_SIZE/2-o.STROKE_WIDTH)}}function Hht(r,e){if(1&r&&(N(),F(0,"rect",9)),2&r){const t=p(),n=t.index,i=t.$implicit,s=p().index,o=p();I("x",o.SPACE_SIZE/2+n*o.SPACE_SIZE-o.SPACE_SIZE/8)("y",o.SPACE_SIZE/2+s*o.SPACE_SIZE-o.SPACE_SIZE/8)("rx",o.isPlayerZero(i)?o.SPACE_SIZE:0)("ry",o.isPlayerZero(i)?o.SPACE_SIZE:0)("width",o.SPACE_SIZE/4)("height",o.SPACE_SIZE/4)("fill",o.pieceColor(i))}}function Vht(r,e){if(1&r){const t=pe();N(),S(0,"g")(1,"g",4),W("click",function(){const s=te(t).index,o=p().index;return ne(p().onClick(s,o))}),F(2,"rect",5),T(3,Dht,1,4,"circle",6),T(4,Hht,1,7,"rect",7),P()()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,s=p();_(1),ye("id","click_",n,"_",i,""),_(1),I("x",n*s.SPACE_SIZE)("y",i*s.SPACE_SIZE)("width",s.SPACE_SIZE)("height",s.SPACE_SIZE)("fill",s.backgroundColor(n,i)),_(1),y("ngIf",t!==s.UNOCCUPIED),_(1),y("ngIf",t!==s.UNOCCUPIED)}}function Fht(r,e){if(1&r&&(N(),S(0,"g"),T(1,Vht,5,9,"g",1),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function $ht(r,e){if(1&r&&(N(),S(0,"g"),F(1,"rect",10)(2,"rect",10),P()),2&r){const t=p();_(1),ye("id","last_move_start_",t.lastPieceMove.get().getStart().x,"_",t.lastPieceMove.get().getStart().y,""),I("x",t.lastPieceMove.get().getStart().x*t.SPACE_SIZE)("y",t.lastPieceMove.get().getStart().y*t.SPACE_SIZE)("width",t.SPACE_SIZE)("height",t.SPACE_SIZE),_(1),ye("id","last_move_start_",t.lastPieceMove.get().getEnd().x,"_",t.lastPieceMove.get().getEnd().y,""),I("x",t.lastPieceMove.get().getEnd().x*t.SPACE_SIZE)("y",t.lastPieceMove.get().getEnd().y*t.SPACE_SIZE)("width",t.SPACE_SIZE)("height",t.SPACE_SIZE)}}function Ght(r,e){if(1&r&&(N(),F(0,"circle",11)),2&r){const t=p();I("cx",t.SPACE_SIZE/2+t.chosen.get().x*t.SPACE_SIZE)("cy",t.SPACE_SIZE/2+t.chosen.get().y*t.SPACE_SIZE)("r",t.SPACE_SIZE/2-t.STROKE_WIDTH)}}let Bht=(()=>{var r;class e extends Fi{constructor(n){super(n),u(this,"UNOCCUPIED",hn.EMPTY),u(this,"lastMove",g.empty()),u(this,"lastPieceMove",g.empty()),u(this,"chosen",g.empty()),u(this,"chosenAutomatically",!1),this.hasAsymmetricBoard=!0,this.rules=B2.get(),this.node=this.rules.getInitialNode(),this.availableAIs=[new on($localize`Minimax`,B2.get(),new zht,new Wce),new Kn($localize`MCTS`,new Wce,this.rules)],this.encoder=y2.encoder,this.tutorial=(new Uce).tutorial,this.canPass=!1}backgroundColor(n,i){return pi.getColorAt(n,i).rgb}isPlayerZero(n){return n.player===k.ZERO}pieceColor(n){return n.color.rgb}piecePlayerClass(n){return this.getPlayerClass(n.player)}updateBoard(n){var i=this;return M(function*(){const s=i.getState();i.board=s.getCopiedBoard(),i.lastPieceMove=g.empty(),i.canPass=B2.mustPass(s);const o=i.rules.getGameStatus(i.node)!==_e.ONGOING;i.canPass||s.coordToPlay.isAbsent()||o?(i.chosenAutomatically=!1,i.chosen=g.empty()):(i.chosenAutomatically=!0,i.chosen=s.coordToPlay)})()}showLastMove(n){var i=this;return M(function*(){y2.isPiece(n)&&(i.lastPieceMove=g.of(n))})()}pass(){var n=this;return M(function*(){return Ze(n.canPass,"KamisadoComponent: pass() must be called only if canPass is true"),n.chooseMove(y2.PASS)})()}onClick(n,i){var s=this;return M(function*(){const o=yield s.canUserPlay("#click_"+n+"_"+i);if(o.isFailure())return s.cancelMove(o.getReason());const a=new C(n,i);if(s.canPass)return s.cancelMove(Re.MUST_PASS());if(s.chosen.isAbsent())return s.choosePiece(n,i);if(!1===s.chosenAutomatically&&s.chosen.equalsValue(a))return s.cancelMoveAttempt(),b.SUCCESS;{const c=s.getState().getPieceAtXY(n,i),l=s.getState().getCurrentPlayer();return c.belongsTo(l)?s.chosenAutomatically?s.cancelMove(Fd.PLAY_WITH_SELECTED_PIECE()):(s.chosen=g.of(a),b.SUCCESS):yield s.chooseDestination(n,i)}})()}choosePiece(n,i){var s=this;return M(function*(){const o=s.getState().getPieceAtXY(n,i),a=s.getState().getCurrentOpponent();return o.belongsTo(a)?s.cancelMove(Re.CANNOT_CHOOSE_OPPONENT_PIECE()):(s.chosen=g.of(new C(n,i)),b.SUCCESS)})()}chooseDestination(n,i){var s=this;return M(function*(){const o=s.chosen.get(),a=new C(n,i),c=y2.of(o,a);return s.chooseMove(c)})()}cancelMoveAttempt(){!1===this.chosenAutomatically&&(this.chosen=g.empty())}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(Ut))}),u(e,"\u0275cmp",qe({type:r,selectors:[["app-kamisado"]],features:[Qe],decls:4,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf"],["id","selectedPiece","class","base mid-stroke no-fill selected-stroke",4,"ngIf"],[3,"id","click"],["fill-opacity","0.7",1,"base-no-fill"],["class","base-no-fill",3,"ngClass",4,"ngIf"],["class","no-stroke",4,"ngIf"],[1,"base-no-fill",3,"ngClass"],[1,"no-stroke"],[1,"base","no-fill","mid-stroke","last-move-stroke",3,"id"],["id","selectedPiece",1,"base","mid-stroke","no-fill","selected-stroke"]],template:function(n,i){1&n&&(N(),S(0,"svg",0),T(1,Fht,2,1,"g",1),T(2,$ht,3,12,"g",2),T(3,Ght,1,3,"circle",3),P()),2&n&&(I("viewBox",i.getViewBox())("transform",i.rotation),_(1),y("ngForOf",i.board),_(1),y("ngIf",i.lastPieceMove.isPresent()),_(1),y("ngIf",i.chosen.isPresent()))},dependencies:[Ft,Wt,At],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})(),qce=(()=>{var r;class e extends Fi{getParallelogramCoords(n){const i=n.parallelogramHeight,s=i*n.horizontalWidthRatio,o=i*n.offsetRatio,a=s,l=s-o,f=i,d=-o,m=i;return[new C(0,0),new C(a,0),new C(l,f),new C(d,m)]}getCoordTranslate(n,i,s,o){const a=o.parallelogramHeight;return new C(n*(a*o.horizontalWidthRatio)+o.offsetRatio*a*(o.abstractBoardSize-i),i*a-o.pieceHeightRatio*a*s)}}return r=e,u(e,"\u0275fac",function(){let t;return function(i){return(t||(t=or(r)))(i||r)}}()),u(e,"\u0275cmp",qe({type:r,selectors:[["ng-component"]],features:[Qe],decls:0,vars:0,template:function(n,i){},encapsulation:2})),e})(),h4=(()=>{class r{}return u(r,"CANNOT_GO_BACKWARD",()=>$localize`You cannot go backward with normal pieces!`),u(r,"CANNOT_CAPTURE_EMPTY_SPACE",()=>$localize`You cannot capture an empty square, nor jump over it!`),u(r,"CANNOT_SKIP_CAPTURE",()=>$localize`You must capture when it is possible!`),u(r,"MUST_FINISH_CAPTURING",()=>$localize`You must finish this capture!`),u(r,"THIS_PIECE_CANNOT_MOVE",()=>$localize`This piece cannot move!`),u(r,"CAPTURE_STEPS_MUST_BE_DOUBLE_DIAGONAL",()=>$localize`A capture should be a double diagonal step. Look at the green indicators to help you!`),u(r,"MOVE_STEPS_MUST_BE_SINGLE_DIAGONAL",()=>$localize`You must move in a single diagonal step!`),u(r,"CANNOT_CAPTURE_TWICE_THE_SAME_COORD",()=>$localize`You cannot jump over the same square several times!`),r})();var Gd;class U2{static getPlayerOfficer(e){return e===k.ZERO?U2.ZERO_OFFICER:U2.ONE_OFFICER}constructor(e,t){u(this,"player",void 0),u(this,"isOfficer",void 0),this.player=e,this.isOfficer=t}toString(){switch(this){case U2.ZERO:return"u";case U2.ONE:return"v";case U2.ZERO_OFFICER:return"O";default:return U.expectToBe(this,U2.ONE_OFFICER),"X"}}equals(e){return this===e}}u(U2,"ZERO",new(Gd=U2)(k.ZERO,!1)),u(U2,"ONE",new Gd(k.ONE,!1)),u(U2,"ZERO_OFFICER",new Gd(k.ZERO,!0)),u(U2,"ONE_OFFICER",new Gd(k.ONE,!0));class Cs{constructor(e){u(this,"pieces",void 0),this.pieces=e}isEmpty(){return 0===this.pieces.length}isCommandedBy(e){return!this.isEmpty()&&this.getCommander().player===e}getCommander(){return this.pieces[0]}getPiecesUnderCommander(){return new Cs(this.pieces.slice(1))}capturePiece(e){return new Cs(this.pieces.concat(e))}addStackBelow(e){let t=this;for(const n of e.pieces)t=t.capturePiece(n);return t}getStackSize(){return this.pieces.length}promoteCommander(){let e=this.getCommander();if(e.isOfficer)return this;{e=U2.getPlayerOfficer(e.player);const t=this.getPiecesUnderCommander();return new Cs([e]).addStackBelow(t)}}get(e){return this.pieces[e]}toString(e){let t=e-this.getStackSize(),n="";for(;t>0;)n+="_",t--;for(const i of this.pieces)n+=i.toString();return n}}u(Cs,"EMPTY",new Cs([]));let m1=(()=>{class r extends W1{static getInitialState(){const t=new Cs([U2.ZERO]),n=new Cs([U2.ONE]),i=Cs.EMPTY;return new r([[n,i,n,i,n,i,n],[i,n,i,n,i,n,i],[n,i,n,i,n,i,n],[i,i,i,i,i,i,i],[t,i,t,i,t,i,t],[i,t,i,t,i,t,i],[t,i,t,i,t,i,t]],0)}static of(t,n){return new r(t,n)}static isNotOnBoard(t){return t.isNotInRange(r.SIZE,r.SIZE)}static isOnBoard(t){return t.isInRange(r.SIZE,r.SIZE)}getStacksOf(t){const n=[];for(let i=0;i<r.SIZE;i++)for(let s=0;s<r.SIZE;s++)this.getPieceAtXY(s,i).isCommandedBy(t)&&n.push(new C(s,i));return n}set(t,n){const i=this.getCopiedBoard();return i[t.y][t.x]=n,new r(i,this.turn)}remove(t){return this.set(t,Cs.EMPTY)}incrementTurn(){return new r(this.getCopiedBoard(),this.turn+1)}getFinishLineOf(t){return t===k.ZERO?0:r.SIZE-1}toString(){let t=1;for(let i=0;i<r.SIZE;i++)for(let s=0;s<r.SIZE;s++){const o=this.getPieceAtXY(s,i).getStackSize();t=Math.max(t,o)}const n=[];for(let i=0;i<r.SIZE;i++){const s=[];for(let o=0;o<r.SIZE;o++)s.push(this.getPieceAtXY(o,i).toString(t));n.push(s.join(" "))}return n.join("\n")}}return u(r,"SIZE",7),r})();class Uht extends dt{equals(e){if(e.size()!==this.size())return!1;for(let t=0;t<this.size();t++)if(!1===zo(e.get(t),this.get(t)))return!1;return!0}get(e){return U.assert(e<this.values.length,"MGPUniqueList: index out of bounds: "+e),this.values[e]}getFromEnd(e){return U.assert(e<this.values.length,"MGPUniqueList: index (from end) out of bounds: "+e),this.get(this.values.length-1-e)}}var Zce;class Wr extends Di{static of(e,t){return new Wr(e,t)}static fromCapture(e){const t=Wr.getSteppedOverCoords(e);return t.isSuccess()?ie.success(new Wr(e,!1)):ie.failure(t.getReason())}static getSteppedOverCoords(e){let t=g.empty();const n=new dt;for(const i of e){if(m1.isNotOnBoard(i))return ie.failure(ou.OUT_OF_RANGE(i));if(t.isPresent()){const s=t.get();if(!1===s.getVectorToward(i).isDiagonalOfLength(2))return ie.failure(h4.CAPTURE_STEPS_MUST_BE_DOUBLE_DIAGONAL());const a=s.getCoordsToward(i)[0];if(n.contains(a))return ie.failure(h4.CANNOT_CAPTURE_TWICE_THE_SAME_COORD());n.add(a)}t=g.of(i)}return ie.success(n)}static fromStep(e,t){return m1.isNotOnBoard(e)?ie.failure(ou.OUT_OF_RANGE(e)):m1.isNotOnBoard(t)?ie.failure(ou.OUT_OF_RANGE(t)):!1===e.getVectorToward(t).isDiagonalOfLength(1)?ie.failure(h4.MOVE_STEPS_MUST_BE_SINGLE_DIAGONAL()):ie.success(new Wr([e,t],!0))}constructor(e,t){super(),u(this,"isStep",void 0),u(this,"coords",void 0),this.isStep=t,this.coords=new Uht(e)}toString(){return"LascaMove("+this.coords.toList().map(n=>n.toString()).join(", ")+")"}getRelation(e){const t=this.coords.size(),n=e.coords.size(),i=Math.min(t,n);for(let s=0;s<i;s++)if(!1===this.coords.toList()[s].equals(e.coords.toList()[s]))return"INEQUALITY";return t===n?"EQUALITY":"PREFIX"}equals(e){return"EQUALITY"===this.getRelation(e)}isPrefix(e){return"PREFIX"===this.getRelation(e)}getStartingCoord(){return this.coords.get(0)}getEndingCoord(){return this.coords.getFromEnd(0)}getCapturedCoords(){return Wr.getSteppedOverCoords(this.coords.toList())}concatenate(e){const t=this.getEndingCoord(),n=e.coords.toList()[0];Ze(t.equals(n),"should not concatenate non-touching move");const i=this.coords.toList(),s=Ie.copyImmutableArray(i),o=e.coords.toList(),a=Ie.copyImmutableArray(o).slice(1);return Wr.fromCapture(s.concat(a)).get()}}Zce=Wr,u(Wr,"encoder",we.tuple([we.list(C.encoder),we.identity()],r=>[r.coords.toList(),r.isStep],r=>Zce.of(r[0],r[1])));class ta extends Yn{static get(){return ta.singleton.isAbsent()&&(ta.singleton=g.of(new ta)),ta.singleton.get()}constructor(){super(m1)}getCaptures(e){const t=e.getCurrentPlayer();return this.getCapturesOf(e,t)}getCapturesOf(e,t){const n=[],i=e.getStacksOf(t);for(const s of i)n.push(...this.getPieceCaptures(e,s));return n}getPieceCaptures(e,t){let n=[];const o=e.getPieceAt(t).getCommander().player.getOpponent(),a=this.getPieceDirections(e,t),c=e.getPieceAt(t);for(const l of a){const f=t.getNext(l,1);if(m1.isOnBoard(f)&&e.getPieceAt(f).isCommandedBy(o)){const d=f.getNext(l,1);if(m1.isOnBoard(d)&&e.getPieceAt(d).isEmpty()){const m=e.remove(t).remove(f).set(d,c),E=Wr.fromCapture([t,d]).get(),w=this.getPieceCaptures(m,d);if(0===w.length)n=n.concat(E);else{const R=w.map(z=>E.concatenate(z));n=n.concat(R)}}}}return n}getPieceDirections(e,t){const s=e.getPieceAt(t).getCommander().player.getScoreModifier(),o=[Me.factory.fromDelta(-1,s).get(),Me.factory.fromDelta(1,s).get()];return e.getPieceAt(t).getCommander().isOfficer&&o.push(Me.factory.fromDelta(-1,-s).get(),Me.factory.fromDelta(1,-s).get()),o}getSteps(e){const t=e.getCurrentPlayer();return this.getStepsOf(e,t)}getStepsOf(e,t){const n=[],i=e.getStacksOf(t);for(const s of i)n.push(...this.getPieceSteps(e,s));return n}getPieceSteps(e,t){const n=[],i=this.getPieceDirections(e,t);for(const s of i){const o=t.getNext(s,1);if(m1.isOnBoard(o)&&e.getPieceAt(o).isEmpty()){const a=Wr.fromStep(t,o).get();n.push(a)}}return n}applyLegalMove(e,t,n){const i=e.getStartingCoord(),s=e.getEndingCoord();let o=t.getPieceAt(i),a=t.remove(i);if(!1===e.isStep)for(const c of e.getCapturedCoords().get()){const l=t.getPieceAt(c),f=l.getCommander();o=o.capturePiece(f);const d=l.getPiecesUnderCommander();a=a.set(c,d)}if(a=a.set(s,o),s.y===t.getFinishLineOf(t.getCurrentPlayer())){const c=o.promoteCommander();a=a.set(s,c)}return a.incrementTurn()}isLegal(e,t){const n=e.getStartingCoord();if(t.getPieceAt(n).isEmpty())return b.failure(Re.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());const i=t.getPieceAt(n),s=t.getCurrentOpponent();if(i.isCommandedBy(s))return b.failure(Re.CANNOT_CHOOSE_OPPONENT_PIECE());const o=e.coords.get(1);if(!1===i.getCommander().isOfficer&&n.getDirectionToward(o).get().y===s.getScoreModifier())return b.failure(h4.CANNOT_GO_BACKWARD());if(!1===t.getPieceAt(o).isEmpty())return b.failure(Re.MUST_LAND_ON_EMPTY_SPACE());const a=this.getCaptures(t);return e.isStep?a.length>0?b.failure(h4.CANNOT_SKIP_CAPTURE()):b.SUCCESS:this.isLegalCapture(e,t,a)}isLegalCapture(e,t,n){const i=t.getCurrentPlayer(),s=e.getCapturedCoords().get();for(const o of s){const a=t.getPieceAt(o);if(a.isCommandedBy(i))return b.failure(Re.CANNOT_SELF_CAPTURE());if(a.isEmpty())return b.failure(h4.CANNOT_CAPTURE_EMPTY_SPACE())}return n.some(o=>o.equals(e))?b.SUCCESS:b.failure(h4.MUST_FINISH_CAPTURING())}getGameStatus(e){const t=e.gameState;return this.getCaptures(t).length>0||this.getSteps(t).length>0?_e.ONGOING:_e.getVictory(t.getCurrentOpponent())}}u(ta,"singleton",g.empty());const Yce=U2.ZERO,jL=U2.ONE,qr=new Cs([Yce]),z1=new Cs([jL]),Wht=new Cs([Yce,jL]),qht=new Cs([U2.ZERO_OFFICER,jL]),Z=Cs.EMPTY;class Kce extends Zn{constructor(...e){super(...e),u(this,"tutorial",[q.informational($localize`Lasca: origins`,$localize`Lasca is a game based on draughts created in 1911 by Emanuel Lasker, chess world champion. It's played on a 7x7 board, each player has 11 pieces.`,m1.getInitialState()),q.informational($localize`Goal of the game`,$localize`The goal of Lasca is, like for draughts, to render the opponent unable to move, either by capturing all his pieces, either by blocking them.`,m1.getInitialState()),q.anyMove($localize`Steps`,$localize`A simple step is made by one diagonal move forward, left or right. Click on the chosen piece, then on its landing square.<br/><br/>You are playing Dark, do the first move.`,m1.getInitialState(),Wr.fromStep(new C(4,4),new C(3,3)).get(),$localize`Congratulations!`),q.anyMove($localize`Capture`,$localize`A capture happens when you jump diagonally over an opponent piece to land right behind it. You have to capture when you can. It is the case here, so click on the piece that must capture, and then on its landing square.<br/><br/>You're playing Dark, go ahead.`,m1.of([[z1,Z,Z,Z,z1,Z,z1],[Z,Z,Z,z1,Z,z1,Z],[Z,Z,z1,Z,z1,Z,z1],[Z,z1,Z,Z,Z,Z,Z],[qr,Z,qr,Z,qr,Z,qr],[Z,qr,Z,qr,Z,qr,Z],[qr,Z,qr,Z,qr,Z,qr]],2),Wr.fromCapture([new C(2,4),new C(0,2)]).get(),$localize`Congratulations, notice that the captured piece was not removed from the board, but put below the capturing pieces.`),q.anyMove($localize`Multiple captures`,$localize`If, after the beginning of your capture, the piece that you just moved can capture another piece, it has to capture until it can no longer capture. To do so, you must then click again on the next landing square. Note that, you cannot jump twice over the same stack.<br/><br/>You are playing Dark, a double capture is possible, go ahead.`,m1.of([[Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z],[z1,Z,Z,Z,z1,Z,z1],[Z,z1,Z,z1,Z,z1,Z],[Z,Z,z1,Z,z1,Z,z1],[Z,z1,Z,Z,Z,Z,Z],[Z,Z,qr,Z,qr,Z,qr]],2),Wr.fromCapture([new C(2,6),new C(0,4),new C(2,2)]).get(),$localize`Congratulations!`),q.informational($localize`Minority capture is allowed`,$localize`If you have several capture choices, you are allowed to choose any of them. For example if one choice is to capture one piece, and the other choice is to capture two pieces, you can choose either.`,m1.of([[Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,z1,Z],[Z,Z,Z,Z,Z,Z,Z],[Z,z1,Z,z1,Z,Z,Z],[Z,Z,qr,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z]],2)),q.fromMove($localize`Promotion`,$localize`When a stack reaches the last line, its commander becomes an officer, and gains the ability to go backward, which is illegal for the other pieces! One of your piece could be promoted now.<br/><br/>You're playing Dark. Do it.`,m1.of([[Z,Z,Z,Z,Z,Z,z1],[Z,Z,Z,Wht,Z,z1,Z],[Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z],[Z,Z,qr,Z,qr,Z,qr]],2),[Wr.fromStep(new C(3,1),new C(2,0)).get(),Wr.fromStep(new C(3,1),new C(4,0)).get()],$localize`Congratulations!`,$localize`You did not choose the correct stack, and got no promotion.`),q.fromMove($localize`Officer move`,$localize`Officers can move and capture backward as well as forward.<br/><br/>You're playing Dark, move your officier!`,m1.of([[Z,Z,Z,Z,qht,Z,z1],[Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,z1,Z,Z],[Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z],[Z,Z,qr,Z,qr,Z,qr]],2),[Wr.fromStep(new C(4,0),new C(3,1)).get(),Wr.fromStep(new C(4,0),new C(5,1)).get()],$localize`Congratulations!`,$localize`You did not move your officer.`)])}}class Xce extends fr{getMetrics(e){const t=e.gameState;return[this.getNumberOfMobileCoords(t,k.ZERO),this.getNumberOfMobileCoords(t,k.ONE)]}getNumberOfMobileCoords(e,t){const i=this.getCapturesAndSteps(e,t).map(o=>o.getStartingCoord());return new dt(i).size()}getCapturesAndSteps(e,t){const n=ta.get().getCapturesOf(e,t),i=ta.get().getStepsOf(e,t);return n.concat(i)}}class jht extends Un{getListMoves(e){const t=ta.get().getCaptures(e.gameState);return t.length>0?t:ta.get().getSteps(e.gameState)}}class Zht extends Xce{getBoardValue(e){const t=12*super.getBoardValue(e).value;let n=0;for(let i=0;i<m1.SIZE;i++)for(let s=0;s<m1.SIZE;s++){const o=e.gameState.getPieceAtXY(s,i);if(o.getStackSize()>0){const a=o.getStackSize();let c=0;const l=o.getCommander().player;for(;c<a&&o.get(c).player===l;)c++;n+=c*l.getScoreModifier()}}return new Jn(t+n)}}function Yht(r,e){if(1&r&&(N(),F(0,"circle",13)),2&r){const t=p(),n=t.index,i=t.$implicit,s=p().index,o=p().index,a=p();wi("id","square_",s,"_",o,"_piece_",n,"_officer_symbol"),y("ngClass",i.classes),I("cx",.4*a.SPACE_SIZE)("cy",.575*a.SPACE_SIZE)("r",.045*a.SPACE_SIZE)}}function Kht(r,e){if(1&r&&(N(),S(0,"g",10),F(1,"use",11),T(2,Yht,1,7,"circle",12),P()),2&r){const t=e.$implicit,n=e.index,i=p().index,s=p().index;I("transform",p().getPieceTranslate(n)),_(1),wi("id","square_",i,"_",s,"_piece_",n,""),y("ngClass",t.classes),_(1),y("ngIf",t.isOfficer)}}function Xht(r,e){if(1&r){const t=pe();N(),S(0,"g")(1,"g",7),W("click",function(){const s=te(t).index,o=p().index;return ne(p().onClick(s,o))}),F(2,"polygon",8),T(3,Kht,3,6,"g",9),P()()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,s=p();_(1),ye("id","coord_",n,"_",i,""),I("transform",s.getTranslate(n,i,0)),_(1),ye("id","square_",n,"_",i,""),y("ngClass",t.squareClasses),I("points",s.getParallelogramPoints()),_(1),y("ngForOf",t.pieceInfos)}}function Qht(r,e){if(1&r&&(N(),S(0,"g"),T(1,Xht,4,8,"g",4),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}let Jht=(()=>{var r;class e extends qce{constructor(n){super(n),u(this,"THICKNESS",40),u(this,"mode",{horizontalWidthRatio:1.2,offsetRatio:.4,pieceHeightRatio:1,parallelogramHeight:100,abstractBoardSize:m1.SIZE}),u(this,"LEFT",0),u(this,"UP",-this.SPACE_SIZE),u(this,"basicWidth",this.mode.abstractBoardSize*this.mode.parallelogramHeight),u(this,"WIDTH",this.basicWidth*(this.mode.horizontalWidthRatio+this.mode.offsetRatio)),u(this,"HEIGHT",this.basicWidth+this.THICKNESS+this.STROKE_WIDTH-this.UP),u(this,"CX",this.WIDTH/2),u(this,"CY",(this.HEIGHT+this.UP)/2),u(this,"adaptedBoard",{isAlreadySwitched:!1,spaceInfo:[]}),u(this,"lastMove",g.empty()),u(this,"currentMoveClicks",[]),u(this,"capturedCoords",[]),u(this,"legalMoves",[]),u(this,"moveGenerator",new jht),this.hasAsymmetricBoard=!0,this.rules=ta.get(),this.node=this.rules.getInitialNode(),this.availableAIs=[new on($localize`Control`,this.rules,new Xce,this.moveGenerator),new on($localize`Control and Domination`,this.rules,new Zht,this.moveGenerator),new Kn($localize`MCTS`,this.moveGenerator,this.rules)],this.encoder=Wr.encoder,this.tutorial=(new Kce).tutorial,this.canPass=!1}updateBoard(n){var i=this;return M(function*(){i.lastMove=i.node.previousMove;const s=i.getState();i.board=s.getCopiedBoard(),i.legalMoves=i.moveGenerator.getListMoves(i.node),i.createAdaptedBoardFrom(s),i.showPossibleMoves(),i.rotateAdaptedBoardIfNeeded()})()}createAdaptedBoardFrom(n){this.adaptedBoard={isAlreadySwitched:!1,spaceInfo:[]};for(let o=0;o<m1.SIZE;o++){const a=[];for(let c=0;c<m1.SIZE;c++){const l=this.getSpaceInfo(n,c,o);a.push(l)}this.adaptedBoard.spaceInfo.push(a)}const s=g.ofNullable(this.currentMoveClicks[this.currentMoveClicks.length-1]);if(s.isPresent()){const o=s.get();for(const a of this.getSpaceInfoAt(o).pieceInfos)a.classes.push("selected-stroke");this.showPossibleLandings(o,n)}for(const o of this.capturedCoords)this.getSpaceInfoAt(o).squareClasses.push("captured-fill");for(const o of this.currentMoveClicks)this.getSpaceInfoAt(o).squareClasses.push("moved-fill")}getSpaceInfo(n,i,s){const o=n.getPieceAtXY(i,s),a=[];for(let c=o.getStackSize()-1;c>=0;c--){const l=o.get(c);a.push({classes:[this.getPlayerClass(l.player)],isOfficer:l.isOfficer})}return{pieceInfos:a,squareClasses:[]}}showLastMove(n){var i=this;return M(function*(){i.showLastCapture(n),i.showSteppedOnCoord(n)})()}showLastCapture(n){if(!1===n.isStep){const i=n.getCapturedCoords();U.assert(i.isSuccess(),"Last move is a capture yet has illegal jumps !?");for(const s of i.get())this.getSpaceInfoAt(s).squareClasses.push("captured-fill")}}showSteppedOnCoord(n){for(const i of n.coords)this.getSpaceInfoAt(i).squareClasses.push("moved-fill")}showPossibleMoves(){for(const n of this.legalMoves){const i=n.getStartingCoord();this.getSpaceInfoAt(i).squareClasses.push("selectable-fill")}}getSpaceInfoAt(n){if(this.role===k.ONE&&this.adaptedBoard.isAlreadySwitched){const i=m1.SIZE-1,s=new C(i-n.x,i-n.y);return this.adaptedBoard.spaceInfo[s.y][s.x]}return this.adaptedBoard.spaceInfo[n.y][n.x]}rotateAdaptedBoardIfNeeded(){if(this.role===k.ONE){const n=[];for(let i=0;i<m1.SIZE;i++){n[m1.SIZE-1-i]=[];for(let s=0;s<m1.SIZE;s++)n[m1.SIZE-1-i][m1.SIZE-1-s]=this.getSpaceInfoAt(new C(s,i))}this.adaptedBoard={isAlreadySwitched:!0,spaceInfo:n}}}hideLastMove(){this.createAdaptedBoardFrom(this.getState()),this.rotateAdaptedBoardIfNeeded()}onClick(n,i){var s=this;return M(function*(){s.role===k.ONE&&(n=m1.SIZE-1-n,i=m1.SIZE-1-i);const o=yield s.canUserPlay("#coord_"+n+"_"+i);if(o.isFailure())return s.cancelMove(o.getReason());const a=new C(n,i),c=s.getState().getPieceAt(a),l=s.getState().getCurrentOpponent();return c.isCommandedBy(l)?s.cancelMove(Re.CANNOT_CHOOSE_OPPONENT_PIECE()):0===s.currentMoveClicks.length?s.trySelectingPiece(a):s.moveClick(a)})()}cancelMoveAttempt(){this.currentMoveClicks=[],this.capturedCoords=[],this.createAdaptedBoardFrom(this.getState()),this.showPossibleMoves(),this.rotateAdaptedBoardIfNeeded()}moveClick(n){var i=this;return M(function*(){if(n.equals(i.currentMoveClicks[0]))return i.cancelMoveAttempt(),b.SUCCESS;const s=i.getState().getPieceAt(n),o=i.getState().getCurrentPlayer();if(s.isCommandedBy(o))return i.cancelMoveAttempt(),i.trySelectingPiece(n);if(1===i.currentMoveClicks.length&&i.currentMoveClicks[0].getVectorToward(n).isDiagonalOfLength(1)){const c=Wr.fromStep(i.currentMoveClicks[0],n).get();return i.chooseMove(c)}return i.capture(n)})()}capture(n){var i=this;return M(function*(){const o=i.currentMoveClicks[i.currentMoveClicks.length-1],a=o.getVectorToward(n);if(a.isDiagonalOfLength(2)){const c=new C(o.x+a.x/2,o.y+a.y/2);i.capturedCoords.push(c),i.currentMoveClicks.push(n);const l=Wr.fromCapture(i.currentMoveClicks).get();return i.legalMoves.some(f=>f.isPrefix(l))?i.applyPartialCapture():i.chooseMove(l)}return i.cancelMove(h4.CAPTURE_STEPS_MUST_BE_DOUBLE_DIAGONAL())})()}applyPartialCapture(){let n=this.getState().remove(this.currentMoveClicks[0]),i=this.getState().getPieceAt(this.currentMoveClicks[0]);for(const o of this.capturedCoords){const a=this.getState().getPieceAt(o),c=a.getCommander(),l=a.getPiecesUnderCommander();n=n.set(o,l),i=i.capturePiece(c)}return n=n.set(this.currentMoveClicks[this.currentMoveClicks.length-1],i),this.createAdaptedBoardFrom(n),this.rotateAdaptedBoardIfNeeded(),b.SUCCESS}trySelectingPiece(n){var i=this;return M(function*(){return i.getState().getPieceAt(n).isEmpty()?i.cancelMove(Re.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):i.selectPiece(n)})()}selectPiece(n){var i=this;return M(function*(){return i.capturedCoords=[],i.legalMoves.some(s=>s.getStartingCoord().equals(n))?(i.currentMoveClicks=[n],i.hideLastMove(),b.SUCCESS):i.cancelMove(h4.THIS_PIECE_CANNOT_MOVE())})()}showPossibleLandings(n,i){const s=this.rules.getPieceCaptures(i,n);if(0===s.length){const o=this.rules.getPieceSteps(i,n);for(const a of o)this.getSpaceInfoAt(a.getEndingCoord()).squareClasses.push("selectable-fill")}else{const o=s.map(a=>a.coords.get(1));for(const a of o)this.getSpaceInfoAt(a).squareClasses.push("capturable-fill")}}getTranslate(n,i,s){const o=this.getCoordTranslate(n,i,s,this.mode);return"translate("+o.x+" "+o.y+")"}getParallelogramPoints(){return this.getParallelogramCoordsForLasca().map(i=>i.x+", "+i.y).join(" ")}getParallelogramCoordsForLasca(){return this.getParallelogramCoords(this.mode)}getParallelogramCenter(){const n=this.getParallelogramCoordsForLasca();return this.getParallelogramCenterOf(n[0],n[1],n[2],n[3])}getParallelogramCenterOf(n,i,s,o){const a=Math.max(n.x,i.x,s.x,o.x),c=Math.max(n.y,i.y,s.y,o.y),l=Math.min(n.x,i.x,s.x,o.x),f=Math.min(n.y,i.y,s.y,o.y);return new C((a-l)/2,(c-f)/2)}getRightEdge(){const n=this.basicWidth*this.mode.horizontalWidthRatio,i=this.basicWidth*this.mode.offsetRatio;return[i+n,0,i+n,this.THICKNESS,n,this.basicWidth+this.THICKNESS,n,this.basicWidth].join(" ")}getPieceTranslate(n){return"translate(0 "+(this.getParallelogramCenter().y-32.5-n*(.15*this.SPACE_SIZE))+")"}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(Ut))}),u(e,"\u0275cmp",qe({type:r,selectors:[["app-lasca"]],features:[Qe],decls:8,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["id","piece"],["d","M 0 25 v 15 a 40 25, 0, 0, 0, 80 0 v -15 a 40 25, 0, 0, 0, -80 0 Z"],["cx","40","cy","25","rx","40","ry","25"],[4,"ngFor","ngForOf"],["x","0",1,"base"],[1,"base"],[3,"id","click"],[1,"base",3,"id","ngClass"],["pointer-events","fill","class","base mid-small-stroke",4,"ngFor","ngForOf"],["pointer-events","fill",1,"base","mid-small-stroke"],[0,"xlink","href","#piece",1,"base","mid-stroke",3,"id","ngClass"],[3,"id","ngClass",4,"ngIf"],[3,"id","ngClass"]],template:function(n,i){1&n&&(N(),S(0,"svg",0)(1,"defs")(2,"g",1),F(3,"path",2)(4,"ellipse",3),P()(),T(5,Qht,2,1,"g",4),F(6,"rect",5)(7,"polygon",6),P()),2&n&&(I("viewBox",i.LEFT+" "+i.UP+" "+i.WIDTH+" "+i.HEIGHT),_(5),y("ngForOf",i.adaptedBoard.spaceInfo),_(1),I("y",i.basicWidth)("width",i.basicWidth*i.mode.horizontalWidthRatio)("height",i.THICKNESS),_(1),I("points",i.getRightEdge()))},dependencies:[Ft,Wt,At],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})(),gi=(()=>{class r extends W1{static getInitialState(){const t=K.NONE,n=K.ZERO,i=K.ONE;return new r([[t,n,n,n,n,n,n,t],[i,t,t,t,t,t,t,i],[i,t,t,t,t,t,t,i],[i,t,t,t,t,t,t,i],[i,t,t,t,t,t,t,i],[i,t,t,t,t,t,t,i],[i,t,t,t,t,t,t,i],[t,n,n,n,n,n,n,t]],0)}static isOnBoard(t){return t.isInRange(r.SIZE,r.SIZE)}}return u(r,"SIZE",8),r})();class Bi extends $o{static from(e,t){const n=Me.factory.fromMove(e,t);return n.isFailure()?ie.failure(n.getReason()):e.isNotInRange(gi.SIZE,gi.SIZE)?ie.failure("start coord is not in range"):t.isNotInRange(gi.SIZE,gi.SIZE)?ie.failure("end coord is not in range"):ie.success(new Bi(e,t,n.get()))}constructor(e,t,n){super(e,t),u(this,"direction",void 0),this.direction=n,this.direction=Me.factory.fromMove(e,t).get()}toString(){return"LinesOfActionMove("+this.getStart()+"->"+this.getEnd()+")"}}u(Bi,"encoder",Hs.getFallibleEncoder(Bi.from));let ZL=(()=>{class r{}return u(r,"INVALID_MOVE_LENGTH",()=>$localize`Your move should have a length equal to the number of pieces that exist on the same line.`),u(r,"CANNOT_JUMP_OVER_OPPONENT",()=>$localize`You cannot jump over the opponent's pieces.`),u(r,"PIECE_CANNOT_MOVE",()=>$localize`This piece has no possible move, select another one.`),r})();class r2 extends Yn{static get(){return r2.singleton.isAbsent()&&(r2.singleton=g.of(new r2)),r2.singleton.get()}constructor(){super(gi)}static getNumberOfGroups(e){const t=Ie.createTable(gi.SIZE,gi.SIZE,-1),n=[0,0];let i=0;for(const s of e.getCoordsAndContents())-1===t[s.coord.y][s.coord.x]&&s.content.isPlayer()&&(i+=1,r2.markGroupStartingAt(e,t,s.coord,i),n[s.content.value]+=1);return n}static markGroupStartingAt(e,t,n,i){const s=[n],o=e.getPieceAt(n);for(;s.length>0;){const a=U.getNonNullable(s.pop());if(-1===t[a.y][a.x]){const c=e.getPieceAt(a);if(c===o){t[a.y][a.x]=i;for(const l of Me.DIRECTIONS){const f=a.getNext(l);e.isOnBoard(f)&&s.push(f)}}else c===K.NONE&&(t[a.y][a.x]=0)}}}applyLegalMove(e,t,n){const i=t.getCopiedBoard();return i[e.getStart().y][e.getStart().x]=K.NONE,i[e.getEnd().y][e.getEnd().x]=t.getCurrentPlayer(),new gi(i,t.turn+1)}static isLegal(e,t){return t.getPieceAt(e.getStart())!==t.getCurrentPlayer()?b.failure(Re.MUST_CHOOSE_PLAYER_PIECE()):e.length()!==this.numberOfPiecesOnLine(t,e.getStart(),e.direction)?b.failure(ZL.INVALID_MOVE_LENGTH()):e.getStart().getCoordsToward(e.getEnd()).some(n=>t.getPieceAt(n)===t.getCurrentOpponent())?b.failure(ZL.CANNOT_JUMP_OVER_OPPONENT()):t.getPieceAt(e.getEnd())===t.getCurrentPlayer()?b.failure(Re.SHOULD_LAND_ON_EMPTY_OR_OPPONENT_SPACE()):b.SUCCESS}isLegal(e,t){return r2.isLegal(e,t)}static numberOfPiecesOnLine(e,t,n){let i=0;for(const s of r2.getLineCoords(t,n))e.getPieceAt(s).isPlayer()&&(i+=1);return i}static getLineCoords(e,t){const n=r2.getEntranceAndForwardDirection(e,t);let i=n[0];const s=n[1],o=[];for(;gi.isOnBoard(i);)o.push(i),i=i.getNext(s);return o}static getEntranceAndForwardDirection(e,t){switch(t){case Me.UP:case Me.DOWN:return[new C(e.x,0),Me.DOWN];case Me.LEFT:case Me.RIGHT:return[new C(0,e.y),Me.RIGHT];case Me.UP_RIGHT:case Me.DOWN_LEFT:return[new C(Math.max(0,e.x+e.y-7),Math.min(7,e.x+e.y)),Me.UP_RIGHT];default:return U.expectToBeMultiple(t,[Me.UP_LEFT,Me.DOWN_RIGHT]),[new C(e.x-Math.min(e.x,e.y),e.y-Math.min(e.x,e.y)),Me.DOWN_RIGHT]}}static getVictory(e){const[t,n]=r2.getNumberOfGroups(e);return 1===t&&1===n?g.of(K.NONE):1===t?g.of(k.ZERO):1===n?g.of(k.ONE):g.empty()}static possibleTargets(e,t){const n=[];for(const i of Me.DIRECTIONS){const s=r2.numberOfPiecesOnLine(e,t,i),o=t.getNext(i,s);if(e.isOnBoard(o)){const a=Bi.from(t,o).get();r2.isLegal(a,e).isSuccess()&&n.push(o)}}return n}getGameStatus(e){const t=e.gameState,[n,i]=r2.getNumberOfGroups(t);return 1===n&&i>1?_e.ZERO_WON:n>1&&1===i?_e.ONE_WON:_e.ONGOING}}u(r2,"singleton",g.empty());const V=K.NONE,S1=K.ZERO,_1=K.ONE;class Jce{constructor(){u(this,"tutorial",[q.informational($localize`Goal of the game`,$localize`At Lines of Actions, the goal is to group your pieces contiguously, orthogonally and/or diagonally.
        Here, Dark wins the game:
        Dark's pieces are forming a single group, while Light's pieces form three groups.`,new gi([[V,V,V,V,V,V,V,V],[_1,V,V,V,S1,V,V,_1],[V,V,S1,S1,_1,V,V,V],[V,V,V,S1,V,V,V,V],[V,V,V,V,V,V,V,V],[V,V,V,V,V,V,V,V],[V,V,V,V,V,V,V,V],[V,V,V,V,V,V,V,V]],0)),q.anyMove($localize`Initial board and initial move`,$localize`Here is the initial board.
         Moves can be made orthogonally or diagonally.
         The length of a move is equal to the number of pieces that are on the line of the move.
         Note that there is a helping indicator to let you know where a piece can land when you select it.<br/><br/>
         You're playing Dark, make the first move!`,gi.getInitialState(),Bi.from(new C(1,7),new C(1,5)).get(),$localize`Congratulations!`),q.fromMove($localize`Jumping`,$localize`During a move, it is possible to jump above your own pieces.
        But it is forbidden to jump over the opponent's pieces.<br/><br/>
        You're playing Dark, make a jump over one of your pieces on the following board.`,new gi([[V,V,V,V,V,V,V,V],[V,V,_1,S1,S1,V,V,V],[V,V,V,V,V,V,V,V],[V,V,V,V,V,V,V,V],[V,V,V,V,V,V,V,V],[V,V,V,V,V,V,V,V],[V,V,V,V,V,V,V,_1],[V,V,V,V,V,V,V,S1]],0),[Bi.from(new C(3,1),new C(6,1)).get()],$localize`Congratulations!`,$localize`Failed. You did not jump over one of your pieces.`),q.fromMove($localize`Moving`,$localize`Here is a different board. Pick the dark piece in the middle (line 4, column 4)
        and observe its possible moves.
        <ul>
            <li>Horizontally, this piece can move only of one square because it is the only piece on this line.</li>
            <li>Vertically, this piece can move of three squares because there are in total three pieces on that vertical line.
                But it can only go up, as below it the landing square is occupied by one of your pieces.</li>
            <li>Diagonally, only one move is possible: on the diagonal that contains three pieces,
                only in the direction where it does not jump over one of the opponent's pieces.
                On the other diagonal, there are too many pieces to end the move on the board.</li>
        </ul><br/>
        You're playing Dark, make one of these moves.`,new gi([[V,V,V,V,V,V,_1,V],[V,V,V,V,V,S1,V,V],[V,V,V,V,_1,V,V,V],[V,V,V,S1,V,V,V,V],[V,V,V,V,V,V,V,_1],[V,V,V,V,V,_1,V,_1],[V,V,V,S1,V,V,_1,_1],[V,V,V,S1,V,V,V,V]],0),[Bi.from(new C(3,3),new C(3,0)).get(),Bi.from(new C(3,3),new C(0,0)).get(),Bi.from(new C(3,3),new C(2,3)).get(),Bi.from(new C(3,3),new C(4,3)).get()],$localize`Congratulations!`,$localize`Failed. This was not one of the expected moves.`),q.fromPredicate($localize`Capturing`,$localize`If a move ends on an opponent's piece, it is captured and removed from the board.
        However, a move cannot end on one of the player's pieces.
        Watch out, having less pieces at Lines of Action makes a victory easier, as there are less pieces to regroup!
        If a player has only one piece, that player wins the game.<br/><br/>
        On the following board, try to capture one piece with Dark.`,new gi([[V,S1,V,S1,S1,S1,S1,V],[_1,V,V,V,V,V,V,_1],[V,V,S1,V,_1,V,V,V],[_1,V,V,V,V,V,V,_1],[_1,V,V,V,V,V,V,_1],[_1,V,V,V,V,V,V,_1],[_1,V,V,V,V,V,V,_1],[V,S1,S1,S1,S1,S1,S1,V]],0),Bi.from(new C(2,2),new C(4,2)).get(),(e,t,n)=>t.getPieceAt(e.getEnd())===K.ONE?b.SUCCESS:b.failure($localize`Failed. Try again.`),$localize`Congratulations!`),q.fromMove($localize`Tie`,$localize`In the special case where a move ends up connecting all pieces of both player, simultaneously,
        then the game ends up with a tie.<br/><br/>
        You're playing Dark, force the tie in one move.`,new gi([[V,V,V,V,V,V,V,V],[V,V,V,V,V,V,V,V],[S1,V,V,S1,_1,S1,V,V],[V,V,V,S1,V,V,V,_1],[V,V,V,V,V,V,V,_1],[V,V,V,V,V,V,V,_1],[V,V,V,V,V,V,V,_1],[V,V,V,V,V,V,V,V]],0),[Bi.from(new C(0,2),new C(4,2)).get()],$localize`Congratulations!`,$localize`Failed. Try again.`)])}}class ept extends fr{getMetrics(e){const t=e.gameState,[n,i]=r2.getNumberOfGroups(t);return[100/n,100/i]}}class e3e extends Un{getListMoves(e){const t=e.gameState,n=[];if(r2.getVictory(t).isPresent())return n;for(let i=0;i<gi.SIZE;i++)for(let s=0;s<gi.SIZE;s++){const o=new C(s,i);if(t.getPieceAt(o).isPlayer())for(const c of r2.possibleTargets(t,o)){const l=Bi.from(o,c).get();n.push(l)}}return n}}function tpt(r,e){if(1&r&&(N(),F(0,"circle",4)),2&r){const t=p().index,n=p().index,i=p();ye("id","piece_",t,"_",n,""),y("ngClass",i.getPieceClasses(t,n)),I("cx",i.SPACE_SIZE/2+t*i.SPACE_SIZE)("cy",i.SPACE_SIZE/2+n*i.SPACE_SIZE)("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)}}function npt(r,e){if(1&r){const t=pe();N(),S(0,"g")(1,"g",3),W("click",function(){const s=te(t).index,o=p().index;return ne(p().onClick(s,o))}),F(2,"rect",4),T(3,tpt,1,6,"circle",5),P()()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,s=p();_(1),ye("id","click_",n,"_",i,""),_(1),ye("id","space_",n,"_",i,""),y("ngClass",s.getSquareClasses(n,i)),I("x",n*s.SPACE_SIZE)("y",i*s.SPACE_SIZE)("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),_(1),y("ngIf",t!==s.EMPTY)}}function rpt(r,e){if(1&r&&(N(),S(0,"g"),T(1,npt,4,10,"g",1),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function ipt(r,e){if(1&r){const t=pe();N(),S(0,"rect",6),W("click",function(){const s=te(t).$implicit;return ne(p().onClick(s.x,s.y))}),P()}if(2&r){const t=e.$implicit,n=p();I("x",t.x*n.SPACE_SIZE+(n.SPACE_SIZE/2-n.INDICATOR_SIZE/2))("y",t.y*n.SPACE_SIZE+(n.SPACE_SIZE/2-n.INDICATOR_SIZE/2))("width",n.INDICATOR_SIZE)("height",n.INDICATOR_SIZE)}}let spt=(()=>{var r;class e extends Fi{constructor(n){super(n),u(this,"INDICATOR_SIZE",20),u(this,"EMPTY",K.NONE),u(this,"targets",[]),u(this,"state",void 0),u(this,"selected",g.empty()),u(this,"lastMove",g.empty()),u(this,"captured",g.empty()),this.rules=r2.get(),this.node=this.rules.getInitialNode(),this.availableAIs=[new on($localize`Minimax`,this.rules,new ept,new e3e),new Kn($localize`MCTS`,new e3e,this.rules)],this.encoder=Bi.encoder,this.tutorial=(new Jce).tutorial}onClick(n,i){var s=this;return M(function*(){const o=yield s.canUserPlay("#click_"+n+"_"+i);if(o.isFailure())return s.cancelMove(o.getReason());const a=new C(n,i);if(s.selected.equalsValue(a))return s.cancelMoveAttempt(),b.SUCCESS;const c=s.getState().getCurrentPlayer();return s.selected.isAbsent()||s.getState().getPieceAt(a)===c?s.select(a):s.concludeMove(a)})()}concludeMove(n){var i=this;return M(function*(){const s=Bi.from(i.selected.get(),n);return s.isSuccess()?i.chooseMove(s.get()):i.cancelMove(s.getReason())})()}select(n){var i=this;return M(function*(){return i.getState().getPieceAt(n)!==i.getState().getCurrentPlayer()?i.cancelMove(Re.MUST_CHOOSE_PLAYER_PIECE()):(i.selected=g.of(n),i.targets=r2.possibleTargets(i.getState(),i.selected.get()),0===i.targets.length?i.cancelMove(ZL.PIECE_CANNOT_MOVE()):b.SUCCESS)})()}updateBoard(n){var i=this;return M(function*(){i.cancelMoveAttempt(),i.board=i.getState().board,i.lastMove=i.node.previousMove})()}showLastMove(n){var i=this;return M(function*(){i.captured=i.getPreviousState().getPieceAt(n.getEnd()).isPlayer()?g.of(n.getEnd()):g.empty()})()}cancelMoveAttempt(){this.selected=g.empty(),this.targets=[]}getSquareClasses(n,i){const s=new C(n,i);if(this.lastMove.isPresent()){const o=this.lastMove.get().getStart(),a=this.lastMove.get().getEnd();if(this.captured.isPresent()&&s.equals(this.captured.get()))return["captured-fill"];if(s.equals(o)||s.equals(a))return["moved-fill"]}return[]}getPieceClasses(n,i){const s=this.board[i][n],o=new C(n,i),a=[this.getPlayerClass(s)];return this.selected.isPresent()&&this.selected.get().equals(o)&&a.push("selected-stroke"),a}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(Ut))}),u(e,"\u0275cmp",qe({type:r,selectors:[["app-linesofaction"]],features:[Qe],decls:3,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","0 -4 800 808","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","indicator",3,"click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base",3,"id","ngClass"],["class","base",3,"id","ngClass",4,"ngIf"],[1,"indicator",3,"click"]],template:function(n,i){1&n&&(N(),S(0,"svg",0),T(1,rpt,2,1,"g",1),T(2,ipt,1,4,"rect",2),P()),2&n&&(_(1),y("ngForOf",i.board),_(1),y("ngForOf",i.targets))},dependencies:[Ft,Wt,At],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();var t3e,YL,KL,p4,XL;class Wc extends br{constructor(e,t,n,i={top:0,bottom:0,left:0,right:0}){super(e.x,e.y),u(this,"direction",void 0),u(this,"orientation",void 0),u(this,"captures",void 0),this.direction=t,this.orientation=n,this.captures=i}toString(){return`LodestoneMove(${this.coord.toString()}, ${this.direction}, ${this.orientation}, { top: ${this.captures.top}, bottom: ${this.captures.bottom}, left: ${this.captures.left}, right: ${this.captures.right} })`}equals(e){return this===e||!(!1===this.coord.equals(e.coord)||this.orientation!==e.orientation||this.direction!==e.direction||this.captures.top!==e.captures.top||this.captures.bottom!==e.captures.bottom||this.captures.left!==e.captures.left||this.captures.right!==e.captures.right)}}t3e=Wc,u(Wc,"encoder",new class extends we{encode(r){return{coord:C.encoder.encode(r.coord),direction:r.direction,orientation:r.orientation,captures:r.captures}}decode(r){const e=r;return Ze(null!=e.coord,"Invalid encoded LodestoneMove"),Ze(null!=e.direction,"Invalid encoded LodestoneMove"),Ze(null!=e.orientation,"Invalid encoded LodestoneMove"),Ze(null!=e.captures,"Invalid encoded LodestoneMove"),new t3e(C.encoder.decode(e.coord),e.direction,e.orientation,e.captures)}});class ys{constructor(e){u(this,"unreachable",void 0),this.unreachable=e}isLodestone(){return!1}isPlayerPiece(){return!1}isEmpty(){return!0}isUnreachable(){return this.unreachable}equals(e){return this===e}}u(ys,"UNREACHABLE",new(YL=ys)(!0)),u(ys,"EMPTY",new YL(!1));class Da{static of(e){return e===k.ZERO?Da.ZERO:Da.ONE}constructor(e){u(this,"owner",void 0),this.owner=e}isLodestone(){return!1}isPlayerPiece(){return!0}isEmpty(){return!1}isUnreachable(){return!1}equals(e){return this===e}}u(Da,"ZERO",new(KL=Da)(k.ZERO)),u(Da,"ONE",new KL(k.ONE));class kl{constructor(e,t,n){u(this,"owner",void 0),u(this,"direction",void 0),u(this,"orientation",void 0),this.owner=e,this.direction=t,this.orientation=n}static of(e,t){return kl.LODESTONES[e.value][t.direction][t.orientation]}isLodestone(){return!0}isPlayerPiece(){return!1}isEmpty(){return!1}isUnreachable(){return!1}equals(e){return this===e}}u(kl,"LODESTONES",{0:{push:{diagonal:new(p4=kl)(k.ZERO,"push","diagonal"),orthogonal:new p4(k.ZERO,"push","orthogonal")},pull:{diagonal:new p4(k.ZERO,"pull","diagonal"),orthogonal:new p4(k.ZERO,"pull","orthogonal")}},1:{push:{diagonal:new p4(k.ONE,"push","diagonal"),orthogonal:new p4(k.ONE,"push","orthogonal")},pull:{diagonal:new p4(k.ONE,"pull","diagonal"),orthogonal:new p4(k.ONE,"pull","orthogonal")}}});class Y1{constructor(e,t){u(this,"width",void 0),u(this,"pieces",void 0),this.width=e,this.pieces=t}remainingSpaces(){return 5===this.width?8-this.pieces.length:3-this.pieces.length}addCaptured(e,t){if(this.pieces.length+t>=this.width)return 5===this.width?Y1.EMPTY_3.addCaptured(e,t+this.pieces.length-5):(Ze(this.pieces.length+t===3,"should never put more pieces than the plate can support"),g.empty());{const n=Ie.copyImmutableArray(this.pieces);for(let i=0;i<t;i++)n.push(Da.of(e));return g.of(new Y1(this.width,n))}}getPieceAt(e){return e<this.pieces.length?this.pieces[e]:ys.EMPTY}}XL=Y1,u(Y1,"POSITIONS",["top","bottom","left","right"]),u(Y1,"EMPTY_5",new XL(5,[])),u(Y1,"EMPTY_3",new XL(3,[]));let v1=(()=>{class r extends W1{static getInitialState(){const t=ys.EMPTY,n=Da.ZERO,i=Da.ONE;return new r([[t,t,n,i,n,i,t,t],[t,n,i,n,i,n,i,t],[n,i,n,i,n,i,n,i],[i,n,i,t,t,n,i,n],[n,i,n,t,t,i,n,i],[i,n,i,n,i,n,i,n],[t,i,n,i,n,i,n,t],[t,t,i,n,i,n,t,t]],0,new En,{top:g.of(Y1.EMPTY_5),bottom:g.of(Y1.EMPTY_5),left:g.of(Y1.EMPTY_5),right:g.of(Y1.EMPTY_5)})}constructor(t,n,i,s){super(t,n),u(this,"lodestones",void 0),u(this,"pressurePlates",void 0),this.lodestones=i,this.pressurePlates=s}withBoard(t){return new r(t,this.turn,this.lodestones,this.pressurePlates)}remainingSpaces(){const t=this.remainingSpacesDetails();return t.top+t.bottom+t.left+t.right}remainingSpacesDetails(){const t={top:0,bottom:0,left:0,right:0};for(const n of Y1.POSITIONS){const i=this.pressurePlates[n];i.isPresent()&&(t[n]=i.get().remainingSpaces())}return t}numberOfPieces(){const t=[0,0];for(let n=0;n<r.SIZE;n++)for(let i=0;i<r.SIZE;i++){const s=this.getPieceAtXY(i,n);s.isPlayerPiece()&&(t[s.owner.value]+=1)}return t}getScores(){const t=this.numberOfPieces();return[24-t[1],24-t[0]]}nextLodestoneDirection(){const t=this.getCurrentPlayer(),n=this.lodestones.get(t);if(!n.isPresent())return g.empty();{const i=this.getPieceAt(n.get());switch(Ze(i.isLodestone(),"Piece must be lodestone (invariant from LodestoneState)"+n.get()),i.direction){case"push":return g.of("pull");case"pull":return g.of("push")}}}}return u(r,"SIZE",8),r})();const Ae=ys.UNREACHABLE,J=ys.EMPTY,Nr=Da.ZERO,Ui=Da.ONE,Bd=kl.of(k.ONE,{direction:"push",orientation:"orthogonal"}),QL={top:g.of(Y1.EMPTY_5),bottom:g.of(Y1.EMPTY_5),left:g.of(Y1.EMPTY_5),right:g.of(Y1.EMPTY_5)};class n3e extends Zn{constructor(...e){super(...e),u(this,"tutorial",[q.informational($localize`Board and aim of the game`,$localize`Lodestone is played on a 8x8 board, which contains so-called <i>pressure plates</i> along the board, that will contain captured pieces. The initial board is shown here. The aim of the game is to be the only player with pieces remaining on the board. To do so, you will have to either push your opponent's pieces off the board, or to crush them with your pieces. You will do it by using a lodestone.`,v1.getInitialState()),q.forClick($localize`Selecting a lodestone`,$localize`To perform a move, you have to place your lodestone on the board. Your lodestone has two sides: <ul><li>its <i>repelling</i> side with which it will repel the opponent's pieces (indicated by the outward triangles of your opponent's color on the lodestone), and</li><li>its <i>attracting</i> side with which it will attract your pieces (indicated by the inward triangles of your color on the lodestone).</li></ul>Your lodestone can be placed to move pieces orthogonally or diagonally. All available lodestone sides and orientation are shown below the board.<br/><br/>You're playing Dark. Select the lodestone that repels your opponent's pieces diagonally.`,v1.getInitialState(),["#lodestone_push_diagonal"],$localize`Congratulations!`,$localize`This is not the right lodestone, try again.`),q.informational($localize`The repelling lodestone`,$localize`Upon placing a lodestone on the board, it will move all pieces it acts upon (according to its direction and orientation) simultaneously. Let us first see how the repelling lodestone acts on the pieces. All the opponent's pieces aligned with the lodestone, as indicated by the triangles' orientations, will be pushed one square away from the lodestone. An opponent's piece will be blocked in case it encounters on its way either one of your piece, a lodestone, or another blocked piece. Finally, if an opponent's piece falls out of the board, it is captured.`,v1.getInitialState()),q.informational($localize`The attracting lodestone`,$localize`When the lodestone is on its attracting side it will pull your pieces one square towards it. In case one of your pieces encounters a lodestone on its way or another blocked piece, it is blocked. However, if it encounter an opponent's piece, it will capture it.`,v1.getInitialState()),q.informational($localize`Flipping the lodestone`,$localize`Note that, after every move, you must flip your lodestone: if it was on its repelling side, you must use it on its attracting side, and vice versa. Also, you are allowed to place your lodestone on the same location as it was on your previous turn.`,v1.getInitialState()),q.fromPredicate($localize`Capturing`,$localize`To summarize, it is possible to capture the opponent's pieces in two ways:<ul><li>with a repelling lodestone, by pushing your opponent's pieces out of the board, or</li><li>with an attracting lodestone, by moving your pieces on your opponent's pieces.</li></ul>Once a lodestone is placed and the pieces have been moved and/or captured, in case any of the opponent's pieces have been captured, you have to place them on the <i>pressure plates</i> that lie around the board. To do so, click on an empty space of the pressure plate of your choice for each capture. You can cancel this by clicking again on a piece you just put on a pressure plate.<br/><br/>You're playing Dark. Try to perform a move that captures at least one of your opponent's piece, and place your capture(s) on pressure plates.`,v1.getInitialState(),new Wc(new C(0,6),"pull","orthogonal",{top:2,bottom:1,left:1,right:1}),(t,n,i)=>32===i.remainingSpaces()?b.failure($localize`You have not captured any of the opponent's pieces, try again!`):b.SUCCESS,$localize`Congratulations!`),q.fromPredicate($localize`Crumbling a first pressure plate`,$localize`When a pressure plate is full, it will crumble and take a full row or column of the board with it! All pieces that are on the crumbled squares are considered lost, but will not have to be placed on pressure plates. You have here a board with a pressure plate that only requires one more piece to crumble.<br/><br/>You're playing Dark. Perform a move that captures at least one piece, and fill that pressure plate to make it crumble.`,new v1([[J,J,J,J,Ui,J,J,J],[J,J,Nr,J,J,Ui,J,J],[J,J,Bd,J,J,J,J,Nr],[J,J,J,J,Ui,J,J,Nr],[J,J,J,J,J,Nr,J,J],[J,J,J,J,J,J,J,J],[J,J,J,J,J,J,J,J],[J,J,J,J,J,J,J,J]],0,new En([{key:k.ONE,value:new C(2,2)}]),{...QL,top:Y1.EMPTY_5.addCaptured(k.ONE,4)}),new Wc(new C(6,2),"push","diagonal",{top:1,bottom:0,left:0,right:0}),(t,n,i)=>5===i.pressurePlates.top.get().width?b.failure($localize`You must capture and place your capture on the top pressure plate to make it crumble!`):b.SUCCESS,$localize`Congratulations!`),q.fromPredicate($localize`Crumbling a second pressure plate`,$localize`Once a pressure plate has crumbled, a shorter pressure plate takes it place. It is the case here, where only 3 spots are available on the top pressure plate.<br/><br/>You're playing Dark. Perform a move that captures enough pieces to fill the top pressure plate, and make it crumble.`,new v1([[Ae,Ae,Ae,Ae,Ae,Ae,Ae,Ae],[J,J,J,J,J,J,J,J],[J,J,J,J,J,J,J,Nr],[J,J,J,J,J,Nr,J,Nr],[J,Bd,J,J,Ui,J,J,J],[J,J,J,J,J,J,J,J],[J,J,J,J,Ui,J,J,J],[J,J,J,J,J,J,J,J]],0,new En([{key:k.ONE,value:new C(1,4)}]),{...QL,top:Y1.EMPTY_3.addCaptured(k.ONE,2)}),new Wc(new C(3,5),"pull","diagonal",{top:1,bottom:0,left:0,right:0}),(t,n,i)=>i.pressurePlates.top.isPresent()?b.failure($localize`You must capture and place your capture on the top pressure plate to make it crumble a second time!`):b.SUCCESS,$localize`Congratulations!`),q.informational($localize`Minimal board`,$localize`After a pressure plate has crumbled for a second time, there is no more pressure plate available on that side. In case all pressure plates have crumbled, the board is reduced to a 4x4 board.`,new v1([[Ae,Ae,Ae,Ae,Ae,Ae,Ae,Ae],[Ae,Ae,Ae,Ae,Ae,Ae,Ae,Ae],[Ae,Ae,Nr,Ui,J,J,Ae,Ae],[Ae,Ae,Bd,Ui,J,J,Ae,Ae],[Ae,Ae,J,Nr,Nr,J,Ae,Ae],[Ae,Ae,Nr,J,J,J,Ae,Ae],[Ae,Ae,Ae,Ae,Ae,Ae,Ae,Ae],[Ae,Ae,Ae,Ae,Ae,Ae,Ae,Ae]],0,new En([{key:k.ONE,value:new C(2,3)}]),{top:g.empty(),bottom:g.empty(),left:g.empty(),right:g.empty()})),q.fromMove($localize`Making the lodestone fall`,$localize`If, at any point during the game, your lodestone is situated on a square that crumbles with a pressure plate, you will be allowed to select any lodestone side on your next turn.<br/><br/>In this board, playing Dark, you can place your lodestone and make a pressure plate crumble so that your lodestone falls too, allowing to choose more freely its side on your next turn. Do it!`,new v1([[J,J,J,J,J,J,J,J],[J,J,J,J,J,Ui,J,J],[J,J,J,Bd,J,J,Nr,J],[J,J,Nr,Nr,Ui,J,J,Nr],[J,J,J,J,J,Nr,J,J],[J,J,Nr,J,J,J,J,J],[J,J,Ui,J,J,J,J,J],[J,J,J,J,J,J,J,J]],0,new En([{key:k.ONE,value:new C(3,2)}]),{...QL,top:Y1.EMPTY_5.addCaptured(k.ONE,4)}),[new Wc(new C(4,0),"pull","diagonal",{top:1,bottom:0,left:0,right:0})],$localize`Congratulations! At your next turn, you will be allowed to place your lodestone on any side.`,$localize`Failed, try again.`),q.fromMove($localize`End of the game`,$localize`In order to win, you must take out all of your opponent's pieces.<br/><br/>Here, you can win in a single move, do it!`,new v1([[Ae,Ae,Ae,Ae,Ae,Ae,Ae,Ae],[Ae,Ae,Ae,Ae,Ae,Ae,Ae,Ae],[Ae,Ui,Nr,Ui,J,J,Ae,Ae],[Ae,Ui,Bd,J,Ui,J,Ae,Ae],[Ae,J,J,Nr,Nr,J,Ae,Ae],[Ae,Ui,Nr,J,Ui,J,Ae,Ae],[Ae,J,J,J,Nr,J,Ae,Ae],[Ae,Ae,Ae,Ae,Ae,Ae,Ae,Ae]],0,new En([{key:k.ONE,value:new C(2,3)}]),{top:g.empty(),bottom:Y1.EMPTY_3.addCaptured(k.ZERO,2),left:g.of(Y1.EMPTY_3),right:g.empty()}),[new Wc(new C(4,2),"pull","orthogonal",{top:0,bottom:0,left:3,right:0})],$localize`Congratulations, you won!`,$localize`This is not the winning move. Try again.`)])}}let Mu=(()=>{class r{}return u(r,"MUST_FLIP_LODESTONE",()=>$localize`You must flip your lodestone before putting it back on the board.`),u(r,"MUST_PLACE_CAPTURES_ON_PRESSURE_PLATES",()=>$localize`As long as there are pressure plates, you must place all the pieces that you have captured on them.`),u(r,"TARGET_IS_CRUMBLED",()=>$localize`You must place your lodestone on a non-crumbled square!`),u(r,"TOO_MANY_CAPTURES_ON_SAME_PRESSURE_PLATE",()=>$localize`You placed too many captures on the same pressure plate, which has not enough space left.`),u(r,"MUST_PLACE_CAPTURES",()=>$localize`You must place your captures on the pressure plates, on the side of the board.`),u(r,"NO_CAPTURES_TO_PLACE_YET",()=>$localize`You cannot place any capture now, you must first place your lodestone on the board!`),r})();class mi extends Yn{static get(){return mi.singleton.isAbsent()&&(mi.singleton=g.of(new mi)),mi.singleton.get()}constructor(){super(v1)}applyLegalMove(e,t,n){const i=t.getCurrentPlayer(),s=i.getOpponent(),o=Ie.copyBiArray(n.board),a=t.lodestones.getCopy();a.put(i,e.coord);const c={...t.pressurePlates};return this.updatePressurePlates(o,c,a,s,e.captures),new v1(o,t.turn+1,a,c)}updatePressurePlates(e,t,n,i,s){for(const o of Y1.POSITIONS)t[o]=this.updatePressurePlate(e,o,t[o],n,i,s[o])}updatePressurePlate(e,t,n,i,s,o){if(n.isPresent()){const a=n.get().addCaptured(s,o),c=mi.THREATENED_COORD_RANGE.get(t).get();return a.isAbsent()?(this.removePressurePlate(e,c.startForBigPlate,c.direction,i),this.removePressurePlate(e,c.startForSmallPlate,c.direction,i)):a.get().width<n.get().width&&this.removePressurePlate(e,c.startForBigPlate,c.direction,i),a}return n}removePressurePlate(e,t,n,i){for(let s=t;s.isInRange(v1.SIZE,v1.SIZE);s=s.getNext(n)){for(const o of k.PLAYERS)i.get(o).equalsValue(s)&&i.delete(o);e[s.y][s.x]=ys.UNREACHABLE}}isLegal(e,t){const n=this.isLegalWithoutCaptures(t,e.coord,e.direction);if(n.isFailure())return ie.failure(n.getReason());const i=this.applyMoveWithoutPlacingCaptures(t,e.coord,e);if(e.captures.top+e.captures.bottom+e.captures.left+e.captures.right!==Math.min(i.captures.length,t.remainingSpaces()))return ie.failure(Mu.MUST_PLACE_CAPTURES_ON_PRESSURE_PLATES());for(const a of Y1.POSITIONS){const c=t.pressurePlates[a];if(c.isPresent()&&c.get().remainingSpaces()<e.captures[a])return ie.failure(Mu.TOO_MANY_CAPTURES_ON_SAME_PRESSURE_PLATE())}return ie.success(i)}applyMoveWithoutPlacingCaptures(e,t,n){let i;const s=Ie.copyBiArray(e.board),o=e.lodestones.get(e.getCurrentPlayer());if(o.isPresent()){const a=o.get();s[a.y][a.x]=ys.EMPTY}return i="pull"===n.direction?this.applyPull(e,s,t,n.orientation):this.applyPush(e,s,t,n.orientation),i.board[t.y][t.x]=kl.of(e.getCurrentPlayer(),n),i.moved.push(t),i}applyPull(e,t,n,i){const s=e.getCurrentPlayer(),o=s.getOpponent(),a=[],c=[],l="diagonal"===i?Me.DIAGONALS:Me.ORTHOGONALS;for(const f of l)for(let d=n.getNext(f);e.isOnBoard(d);d=d.getNext(f)){const m=t[d.y][d.x],E=d.getNext(f);if(e.isOnBoard(E)){const w=t[E.y][E.x];w.isPlayerPiece()&&w.owner===s&&(m.isEmpty()?(c.push(d),t[d.y][d.x]=w,c.push(E),t[E.y][E.x]=ys.EMPTY):m.isPlayerPiece()&&m.owner===o&&(a.push(d),t[d.y][d.x]=w,c.push(E),t[E.y][E.x]=ys.EMPTY))}}return{board:t,captures:a,moved:c}}applyPush(e,t,n,i){const o=e.getCurrentPlayer().getOpponent(),a=[],c=[],l="diagonal"===i?Me.DIAGONALS:Me.ORTHOGONALS;for(const f of l)for(let m=n.getNext(f,v1.SIZE);!1===m.equals(n);m=m.getPrevious(f))if(e.isOnBoard(m)){const E=t[m.y][m.x];if(E.isPlayerPiece()&&E.owner===o){const w=m.getNext(f);if(e.isOnBoard(w)){const R=t[w.y][w.x];R.isUnreachable()?(a.push(m),t[m.y][m.x]=ys.EMPTY):R.isEmpty()&&(c.push(w),t[w.y][w.x]=E,c.push(m),t[m.y][m.x]=ys.EMPTY)}else a.push(m),t[m.y][m.x]=ys.EMPTY}}return{board:t,captures:a,moved:c}}isLegalWithoutCaptures(e,t,n){const i=this.isTargetLegal(e,t);if(i.isFailure())return i;const s=e.nextLodestoneDirection();return!1===(s.isAbsent()||s.equalsValue(n))?b.failure(Mu.MUST_FLIP_LODESTONE()):b.SUCCESS}isTargetLegal(e,t){const n=e.getPieceAt(t);if(n.isUnreachable())return b.failure(Mu.TARGET_IS_CRUMBLED());if(n.isPlayerPiece())return b.failure(Re.MUST_CLICK_ON_EMPTY_SQUARE());const i=e.getCurrentPlayer();return n.isLodestone()&&n.owner!==i?b.failure(Re.MUST_CLICK_ON_EMPTY_SQUARE()):b.SUCCESS}getGameStatus(e){const n=e.gameState.numberOfPieces();return 0===n[0]&&0===n[1]?_e.DRAW:0===n[0]?_e.ONE_WON:0===n[1]?_e.ZERO_WON:_e.ONGOING}}u(mi,"THREATENED_COORD_RANGE",En.from({top:{startForBigPlate:new C(0,0),startForSmallPlate:new C(0,1),direction:Me.RIGHT},bottom:{startForBigPlate:new C(0,v1.SIZE-1),startForSmallPlate:new C(0,v1.SIZE-2),direction:Me.RIGHT},left:{startForBigPlate:new C(0,0),startForSmallPlate:new C(1,0),direction:Me.DOWN},right:{startForBigPlate:new C(v1.SIZE-1,0),startForSmallPlate:new C(v1.SIZE-2,0),direction:Me.DOWN}})),u(mi,"singleton",g.empty());class r3e extends Un{getListMoves(e){const t=e.gameState;return this.flatMapEmptyCoords(t,n=>{const i=[];for(const s of this.nextDirection(t)){const o=["diagonal","orthogonal"];for(const a of o){const f=mi.get().applyMoveWithoutPlacingCaptures(t,n,{direction:s,orientation:a}).captures.length;for(const d of this.captureCombinations(t,f))i.push(new Wc(n,s,a,d))}}return i})}captureCombinations(e,t){if(0===t)return new dt([{top:0,bottom:0,left:0,right:0}]);{const n=new dt,i=e.remainingSpacesDetails(),s=this.captureCombinations(e,t-1);for(const o of s)o.top+1<=i.top&&n.add({...o,top:o.top+1}),o.bottom+1<=i.bottom&&n.add({...o,bottom:o.bottom+1}),o.left+1<=i.left&&n.add({...o,left:o.left+1}),o.right+1<=i.right&&n.add({...o,right:o.right+1});return 0===n.size()?s:n}}flatMapEmptyCoords(e,t){let n=[];for(let i=0;i<v1.SIZE;i++)for(let s=0;s<v1.SIZE;s++){const o=new C(s,i),a=e.getPieceAt(o);(a.isEmpty()&&!1===a.isUnreachable()||a.isLodestone()&&a.owner===e.getCurrentPlayer())&&(n=n.concat(t(o)))}return n}nextDirection(e){const t=e.nextLodestoneDirection();return t.isPresent()?[t.get()]:["push","pull"]}}class opt extends fr{getMetrics(e){return e.gameState.getScores()}}var Ha;function apt(r,e){if(1&r&&(N(),F(0,"circle",10)),2&r){const t=p(2),n=t.index,i=t.$implicit,s=p().index,o=p();ye("id","piece_",n,"_",s,""),y("ngClass",i.pieceClasses),I("r",o.PIECE_RADIUS)("cx",o.SPACE_SIZE*n+o.STROKE_WIDTH+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*s+o.STROKE_WIDTH+o.SPACE_SIZE/2)}}function cpt(r,e){if(1&r&&(N(),F(0,"polygon",15)),2&r){const t=p().$implicit,n=p(3).$implicit,i=p(2);c6("transform","rotate(",90*t,")"),y("ngClass",n.lodestone.movingClass),I("points",i.TRIANGLE_OUT)}}function lpt(r,e){if(1&r&&(N(),F(0,"polygon",15)),2&r){const t=p().$implicit,n=p(3).$implicit,i=p(2);c6("transform","rotate(",90*t,")"),y("ngClass",n.lodestone.movingClass),I("points",i.TRIANGLE_IN)}}function upt(r,e){if(1&r&&(N(),S(0,"g"),T(1,cpt,1,3,"polygon",14),T(2,lpt,1,3,"polygon",14),P()),2&r){const t=p(3).$implicit;_(1),y("ngIf","push"===t.lodestone.direction),_(1),y("ngIf","pull"===t.lodestone.direction)}}const i3e=function(){return[0,1,2,3]};function fpt(r,e){if(1&r&&(N(),S(0,"g",11),F(1,"circle",12)(2,"circle",13),S(3,"g"),T(4,upt,3,2,"g",1),P()()),2&r){const t=p(2),n=t.index,i=t.$implicit,s=p().index,o=p();I("transform",o.getSquareTransform(n,s)),_(1),y("ngClass",i.lodestone.selectedClass),I("r",o.PIECE_RADIUS),_(1),y("ngClass",i.lodestone.pieceClasses),I("r",o.PIECE_RADIUS/4),_(1),c6("transform","rotate(","diagonal"===i.lodestone.orientation?45:0,")"),_(1),y("ngForOf",D1(7,i3e))}}function dpt(r,e){if(1&r){const t=pe();N(),S(0,"g",6),W("click",function(){te(t);const i=p().$implicit;return ne(p(2).selectCoord(i.coord))}),F(1,"rect",7),T(2,apt,1,6,"circle",8),T(3,fpt,5,8,"g",9),P()}if(2&r){const t=p(),n=t.index,i=t.$implicit,s=p().index,o=p();ye("id","square_",n,"_",s,""),_(1),y("ngClass",i.squareClasses),I("x",o.SPACE_SIZE*n+o.STROKE_WIDTH)("y",o.SPACE_SIZE*s+o.STROKE_WIDTH)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),_(1),y("ngIf",i.hasPiece),_(1),y("ngIf",i.lodestone)}}function hpt(r,e){if(1&r&&(N(),S(0,"g"),T(1,dpt,4,9,"g",5),P()),2&r){const t=e.$implicit;_(1),y("ngIf",!1===t.crumbled)}}function ppt(r,e){if(1&r&&(N(),S(0,"g"),T(1,hpt,2,1,"g",1),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function gpt(r,e){if(1&r&&(N(),S(0,"g",16),F(1,"circle",17),P()),2&r){const t=e.$implicit,n=e.index,i=p();zn("id","capture_",n,""),I("transform",i.getCaptureTransform(n)),_(1),y("ngClass",t.pieceClasses),I("r",i.PIECE_RADIUS)}}function mpt(r,e){if(1&r&&(N(),S(0,"g"),F(1,"polygon",15),P()),2&r){const t=e.$implicit,n=p().$implicit,i=p();_(1),c6("transform","rotate(",90*t,")"),y("ngClass",n.movingClass),I("points","push"===n.direction?i.TRIANGLE_OUT:i.TRIANGLE_IN)}}function _pt(r,e){if(1&r){const t=pe();N(),S(0,"g",6),W("click",function(){const s=te(t).$implicit;return ne(p().selectLodestone(s))}),F(1,"circle",12)(2,"circle",13),S(3,"g"),T(4,mpt,2,3,"g",1),P()()}if(2&r){const t=e.$implicit,n=e.index,i=p();ye("id","lodestone_",t.direction,"_",t.orientation,""),I("transform",i.getAvailableLodestoneTransform(n)),_(1),y("ngClass",t.selectedClass),I("r",i.PIECE_RADIUS),_(1),y("ngClass",t.pieceClasses),I("r",i.PIECE_RADIUS/4),_(1),c6("transform","rotate(","diagonal"===t.orientation?45:0,")"),_(1),y("ngForOf",D1(9,i3e))}}function vpt(r,e){if(1&r&&(N(),F(0,"circle",10)),2&r){const t=p(),n=t.index,i=t.$implicit,s=p().$implicit,o=p();ye("id","platePiece_",s.position,"_",n,""),y("ngClass",i.pieceClasses),I("r",o.PIECE_RADIUS)("cx",o.SPACE_SIZE*i.coord.x+o.STROKE_WIDTH+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*i.coord.y+o.STROKE_WIDTH+o.SPACE_SIZE/2)}}function Cpt(r,e){if(1&r){const t=pe();N(),S(0,"g")(1,"g",6),W("click",function(){const i=te(t),s=i.$implicit,o=i.index,a=p().$implicit;return ne(p().onPressurePlateClick(s.temporary,a.position,o))}),F(2,"rect",18),T(3,vpt,1,6,"circle",8),P()()}if(2&r){const t=e.$implicit,n=e.index,i=p().$implicit,s=p();I("transform",s.getPressurePlateTransform(i.position)),_(1),ye("id","plate_",i.position,"_",n,""),_(1),ye("id","plateSquare_",i.position,"_",n,""),y("ngClass",t.squareClasses),I("x",s.SPACE_SIZE*t.coord.x+s.STROKE_WIDTH)("y",s.SPACE_SIZE*t.coord.y+s.STROKE_WIDTH)("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),_(1),y("ngIf",t.hasPiece)}}function ypt(r,e){if(1&r&&(N(),S(0,"g",16),T(1,Cpt,4,11,"g",1),P()),2&r){const t=e.$implicit;zn("id","pressurePlate_",t.position,""),_(1),y("ngForOf",t.coords)}}function Mpt(r,e){if(1&r&&(N(),F(0,"rect",19)),2&r){const t=p();ye("id","selection_",t.viewInfo.selected.get().x,"_",t.viewInfo.selected.get().y,""),I("x",t.SPACE_SIZE*t.viewInfo.selected.get().x+t.STROKE_WIDTH)("y",t.SPACE_SIZE*t.viewInfo.selected.get().y+t.STROKE_WIDTH)("width",t.SPACE_SIZE)("height",t.SPACE_SIZE)}}class xl extends El{constructor(e){super(e),u(this,"PIECE_RADIUS",void 0),u(this,"TRIANGLE_OUT",void 0),u(this,"TRIANGLE_IN",void 0),u(this,"viewInfo",{availableLodestones:[],capturesToPlace:[],boardInfo:[],currentPlayerClass:"",opponentClass:"",pressurePlates:[],selected:g.empty(),pressurePlateShift:{top:new St(0,0),left:new St(0,0),right:new St(0,0),bottom:new St(0,0)}}),u(this,"displayedState",void 0),u(this,"stateAfterPlacingLodestone",g.empty()),u(this,"lastInfos",g.empty()),u(this,"capturesToPlace",0),u(this,"selectedCoord",g.empty()),u(this,"selectedLodestone",g.empty()),u(this,"captures",{top:0,bottom:0,left:0,right:0}),this.rules=mi.get(),this.node=this.rules.getInitialNode(),this.tutorial=(new n3e).tutorial,this.availableAIs=[new on($localize`Score`,this.rules,new opt,new r3e),new Kn($localize`MCTS`,new r3e,this.rules)],this.encoder=Wc.encoder,this.PIECE_RADIUS=.5*(this.SPACE_SIZE-2*this.STROKE_WIDTH);const t=.8*this.PIECE_RADIUS,n=.3*this.PIECE_RADIUS,i=.2*this.PIECE_RADIUS;this.TRIANGLE_OUT=`${t},0 ${n},${i} ${n},-${i}`,this.TRIANGLE_IN=`${n},0 ${t},${n} ${t},-${n}`,this.displayedState=this.getState(),this.scores=g.of([0,0])}selectCoord(e){var t=this;return M(function*(){const n=yield t.canUserPlay("#square_"+e.x+"_"+e.y);if(n.isFailure())return t.cancelMove(n.getReason());if(t.capturesToPlace>0)return t.cancelMove(Mu.MUST_PLACE_CAPTURES());const i=mi.get().isTargetLegal(t.getState(),e);return i.isFailure()?t.cancelMove(i.getReason()):t.selectedCoord.equalsValue(e)?(t.cancelMoveAttempt(),b.SUCCESS):(t.selectedCoord=g.of(e),t.selectedLodestone.isPresent()?t.putLodestone():(t.updateViewInfo(),b.SUCCESS))})()}selectLodestone(e){var t=this;return M(function*(){const n=yield t.canUserPlay("#lodestone_"+e.direction+"_"+e.orientation);if(n.isFailure())return t.cancelMove(n.getReason());Ze(0===t.capturesToPlace,"should not be able to click on a lodestone when captures need to be placed");const i=t.getCurrentPlayer(),s=kl.of(i,e);return t.selectedLodestone.equalsValue(s)?(t.cancelMoveAttempt(),b.SUCCESS):(t.selectedLodestone=g.of(s),t.selectedCoord.isPresent()?t.putLodestone():(t.updateViewInfo(),b.SUCCESS))})()}putLodestone(){var e=this;return M(function*(){Ze(e.selectedCoord.isPresent(),"coord should have been selected"),Ze(e.selectedLodestone.isPresent(),"lodestone should have been selected");const t=e.selectedCoord.get(),n=e.selectedLodestone.get(),i=e.getState();Ze(mi.get().isLegalWithoutCaptures(i,t,n.direction).isSuccess(),"Lodestone component should only allow creation of legal moves");const o=mi.get().applyMoveWithoutPlacingCaptures(i,t,n);return e.lastInfos=g.of(o),e.capturesToPlace=Math.min(o.captures.length,i.remainingSpaces()),0===e.capturesToPlace?e.applyMove():(e.displayedState=e.displayedState.withBoard(o.board),e.stateAfterPlacingLodestone=g.of(e.displayedState),e.updateViewInfo(),b.SUCCESS)})()}applyMove(){var e=this;return M(function*(){Ze(e.selectedCoord.isPresent(),"coord should have been selected"),Ze(e.selectedLodestone.isPresent(),"lodestone should have been selected");const t=e.selectedCoord.get(),n=e.selectedLodestone.get(),i=new Wc(t,n.direction,n.orientation,e.captures);return e.chooseMove(i)})()}onPressurePlateClick(e,t,n){return e?this.deselectPressurePlate(t,n):this.selectPressurePlate(t,n)}selectPressurePlate(e,t){var n=this;return M(function*(){const i=yield n.canUserPlay("#plate_"+e+"_"+t);if(i.isFailure())return n.cancelMove(i.getReason());if(0===n.capturesToPlace)return n.cancelMove(Mu.NO_CAPTURES_TO_PLACE_YET());n.capturesToPlace--,n.captures[e]++;const s=n.stateAfterPlacingLodestone.get(),o=n.getCurrentOpponent(),a=Ie.copyBiArray(s.board),c={...s.pressurePlates},l=s.lodestones.getCopy();return mi.get().updatePressurePlates(a,c,l,o,n.captures),n.displayedState=new v1(a,s.turn,l,c),0===n.capturesToPlace?n.applyMove():(n.updateViewInfo(),n.showPressurePlateDifferences(n.getState(),n.displayedState,!0),b.SUCCESS)})()}deselectPressurePlate(e,t){var n=this;return M(function*(){const i=yield n.canUserPlay("#plate_"+e+"_"+t);if(i.isFailure())return n.cancelMove(i.getReason());n.capturesToPlace++,n.captures[e]--;const s=n.stateAfterPlacingLodestone.get(),o=n.getCurrentOpponent(),a=Ie.copyBiArray(s.board),c={...s.pressurePlates},l=s.lodestones.getCopy();return mi.get().updatePressurePlates(a,c,l,o,n.captures),n.displayedState=new v1(a,s.turn,l,c),n.updateViewInfo(),n.showPressurePlateDifferences(n.getState(),n.displayedState,!0),b.SUCCESS})()}updateBoard(e){var t=this;return M(function*(){t.cancelMoveAttempt(),t.scores=g.of(t.getState().getScores())})()}cancelMoveAttempt(){this.displayedState=this.getState(),this.stateAfterPlacingLodestone=g.empty(),this.lastInfos=g.empty();const e=this.displayedState.lodestones.get(this.getCurrentPlayer());if(e.isPresent()){const t=Ie.copyBiArray(this.displayedState.board);t[e.get().y][e.get().x]=ys.EMPTY,this.displayedState=this.displayedState.withBoard(t)}this.selectedCoord=g.empty(),this.selectedLodestone=g.empty(),this.capturesToPlace=0,this.captures={top:0,bottom:0,left:0,right:0},this.updateViewInfo()}updateViewInfo(){const t=this.getState().getCurrentPlayer();this.viewInfo.currentPlayerClass=this.getPlayerClass(t),this.viewInfo.opponentClass=this.getPlayerClass(t.getOpponent()),this.showBoard(),this.showAvailableLodestones(),this.showCapturesToPlace(),this.showPressurePlates(),this.computePressurePlateShift(),this.lastInfos.isPresent()&&this.showMovedAndCaptured(this.lastInfos.get())}showBoard(){this.viewInfo.boardInfo=[];for(let e=0;e<v1.SIZE;e++){this.viewInfo.boardInfo.push([]);for(let t=0;t<v1.SIZE;t++){const n=new C(t,e);this.viewInfo.boardInfo[e].push(this.getSquareInfo(n))}}this.viewInfo.selected=this.selectedCoord.isPresent()&&!1===this.displayedState.getPieceAt(this.selectedCoord.get()).isUnreachable()?this.selectedCoord:g.empty()}getSquareInfo(e){const t=this.displayedState.getPieceAt(e),n={coord:e,squareClasses:[],crumbled:t.isUnreachable(),hasPiece:t.isPlayerPiece(),pieceClasses:[]};return t.isPlayerPiece()&&(n.pieceClasses=[this.getPlayerClass(t.owner)]),t.isLodestone()&&(n.lodestone={direction:t.direction,pieceClasses:[this.getPlayerClass(t.owner)],selectedClass:"",movingClass:"",orientation:t.orientation},n.lodestone.movingClass=this.getPlayerClass("push"===t.direction?t.owner.getOpponent():t.owner)),n}showAvailableLodestones(){if(this.capturesToPlace>0)this.viewInfo.availableLodestones=[];else{const e=this.getState().getCurrentPlayer(),t=this.getState().nextLodestoneDirection();if(t.isPresent()){const n=t.get();this.viewInfo.availableLodestones=[this.nextLodestone(e,{direction:n,orientation:"orthogonal"}),this.nextLodestone(e,{direction:n,orientation:"diagonal"})]}else this.viewInfo.availableLodestones=[this.nextLodestone(e,{direction:"push",orientation:"orthogonal"}),this.nextLodestone(e,{direction:"push",orientation:"diagonal"}),this.nextLodestone(e,{direction:"pull",orientation:"orthogonal"}),this.nextLodestone(e,{direction:"pull",orientation:"diagonal"})]}}showCapturesToPlace(){const e=this.getCurrentOpponent();this.viewInfo.capturesToPlace=[];for(let t=0;t<this.capturesToPlace;t++)this.viewInfo.capturesToPlace.push({pieceClasses:[this.getPlayerClass(e)]})}nextLodestone(e,t){const n=kl.of(e,t),i={direction:n.direction,orientation:n.orientation,pieceClasses:[this.getPlayerClass(n.owner)],movingClass:"",selectedClass:""};return i.movingClass=this.getPlayerClass("push"===n.direction?n.owner.getOpponent():n.owner),this.selectedLodestone.equalsValue(n)&&(i.selectedClass="selected-stroke"),i}showPressurePlates(){this.viewInfo.pressurePlates=[];for(const e of Y1.POSITIONS){const t=[],n=this.displayedState.pressurePlates[e];if(n.isPresent()){const i=xl.PRESSURE_PLATES_POSITIONS.get(e).get(),s=n.get().width;let o=5===s?i.startForBigPlate:i.startForSmallPlate;for(let a=0;a<s;a++){o=o.getNext(i.direction);const c=n.get().getPieceAt(a);let l="";c.isPlayerPiece()&&(l=this.getPlayerClass(c.owner)),t.push({coord:o,hasPiece:c.isPlayerPiece(),pieceClasses:[l],squareClasses:[],temporary:!1})}}this.viewInfo.pressurePlates.push({position:e,coords:t})}}showLastMove(e){var t=this;return M(function*(){const n=t.getPreviousState();t.lastInfos=g.of(mi.get().applyMoveWithoutPlacingCaptures(n,e.coord,e)),t.updateViewInfo();const i=t.getState();t.showPressurePlateDifferences(n,i,!1)})()}showPressurePlateDifferences(e,t,n){for(const i of Y1.POSITIONS)this.showPressurePlateDifference(e.pressurePlates[i],t.pressurePlates[i],i,n)}showPressurePlateDifference(e,t,n,i){if(e.isPresent()&&t.isPresent()){const s=e.get(),o=t.get(),a=U.getNonNullable(this.viewInfo.pressurePlates.find(c=>c.position===n));if(s.width===o.width)for(let c=0;c<o.width;c++){const l=s.getPieceAt(c),f=o.getPieceAt(c);!1===l.equals(f)&&(a.coords[c].squareClasses.push("moved-fill"),a.coords[c].temporary=i,i&&a.coords[c].pieceClasses.push("semi-transparent"))}else for(const c of a.coords)c.squareClasses.push("moved-fill")}}showMovedAndCaptured(e){for(const t of e.moved)this.viewInfo.boardInfo[t.y][t.x].squareClasses.push("moved-fill");for(const t of e.captures)this.viewInfo.boardInfo[t.y][t.x].squareClasses.push("captured-fill")}computePressurePlateShift(){const e=this.displayedState,t=this.getPressurePlateShift(e.pressurePlates.left),n=this.getPressurePlateShift(e.pressurePlates.right),i=this.getPressurePlateShift(e.pressurePlates.top),s=this.getPressurePlateShift(e.pressurePlates.bottom);this.viewInfo.pressurePlateShift.top=new St(.5*(t-n),0),this.viewInfo.pressurePlateShift.bottom=new St(.5*(t-n),0),this.viewInfo.pressurePlateShift.left=new St(0,.5*(i-s)),this.viewInfo.pressurePlateShift.right=new St(0,.5*(i-s))}getPressurePlateShift(e){return e.isAbsent()?2:3===e.get().width?1:0}getSquareTransform(e,t){return`translate(${e*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2}, ${t*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2})`}getCaptureTransform(e){return`translate(${(e+(v1.SIZE/2-this.viewInfo.capturesToPlace.length/2))*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2+this.viewInfo.pressurePlateShift.top.x*this.SPACE_SIZE}, ${-2*this.SPACE_SIZE-30+this.STROKE_WIDTH+this.SPACE_SIZE/2})`}getAvailableLodestoneTransform(e){return`translate(${(e+(v1.SIZE/2-this.viewInfo.availableLodestones.length/2))*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2+this.viewInfo.pressurePlateShift.top.x*this.SPACE_SIZE}, ${30+9*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2})`}getPressurePlateTransform(e){return`translate(${this.viewInfo.pressurePlateShift[e].x*this.SPACE_SIZE}, ${this.viewInfo.pressurePlateShift[e].y*this.SPACE_SIZE})`}}var Ud,s3e;Ha=xl,u(xl,"PRESSURE_PLATE_EXTRA_SHIFT",.2),u(xl,"PRESSURE_PLATES_POSITIONS",En.from({top:{startForBigPlate:new C(.5,-1-Ha.PRESSURE_PLATE_EXTRA_SHIFT),startForSmallPlate:new C(1.5,0-Ha.PRESSURE_PLATE_EXTRA_SHIFT),direction:Me.RIGHT},bottom:{startForBigPlate:new C(.5,8+Ha.PRESSURE_PLATE_EXTRA_SHIFT),startForSmallPlate:new C(1.5,7+Ha.PRESSURE_PLATE_EXTRA_SHIFT),direction:Me.RIGHT},left:{startForBigPlate:new C(-1-Ha.PRESSURE_PLATE_EXTRA_SHIFT,.5),startForSmallPlate:new C(0-Ha.PRESSURE_PLATE_EXTRA_SHIFT,1.5),direction:Me.DOWN},right:{startForBigPlate:new C(8+Ha.PRESSURE_PLATE_EXTRA_SHIFT,.5),startForSmallPlate:new C(7+Ha.PRESSURE_PLATE_EXTRA_SHIFT,1.5),direction:Me.DOWN}})),u(xl,"\u0275fac",function(e){return new(e||Ha)(B(Ut))}),u(xl,"\u0275cmp",qe({type:Ha,selectors:[["app-lodestone"]],features:[Qe],decls:6,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-100 -220 1016 1256","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id",4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],["class","base no-fill selected-stroke",3,"id",4,"ngIf"],[3,"id","click",4,"ngIf"],[3,"id","click"],[1,"base",3,"ngClass"],["class","base",3,"id","ngClass",4,"ngIf"],["class","lodestone",4,"ngIf"],[1,"base",3,"id","ngClass"],[1,"lodestone"],["cx","0","cy","0",1,"base","black-fill","outside",3,"ngClass"],["cx","0","cy","0",1,"base","no-stroke",3,"ngClass"],["class","base no-stroke",3,"ngClass",4,"ngIf"],[1,"base","no-stroke",3,"ngClass"],[3,"id"],["cx","0","cy","0",1,"base",3,"ngClass"],["rx","20","ry","20",1,"base",3,"id","ngClass"],[1,"base","no-fill","selected-stroke",3,"id"]],template:function(e,t){1&e&&(N(),S(0,"svg",0),T(1,ppt,2,1,"g",1),T(2,gpt,2,4,"g",2),T(3,_pt,5,10,"g",3),T(4,ypt,2,2,"g",2),T(5,Mpt,1,6,"rect",4),P()),2&e&&(_(1),y("ngForOf",t.viewInfo.boardInfo),_(1),y("ngForOf",t.viewInfo.capturesToPlace),_(1),y("ngForOf",t.viewInfo.availableLodestones),_(1),y("ngForOf",t.viewInfo.pressurePlates),_(1),y("ngIf",t.viewInfo.selected.isPresent()))},dependencies:[Ft,Wt,At],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}));class bt{static tryMerge(e,t){Ze(e!==bt.EMPTY&&t!==bt.EMPTY,"tryMerge cannot be called with empty pieces");const i=e.value+t.value;return 2===i||3===i?g.of(bt.of(i)):g.empty()}static of(e){return e===bt.DRONE.value?bt.DRONE:(U.expectToBe(e,bt.QUEEN.value),bt.QUEEN)}constructor(e){u(this,"value",void 0),this.value=e}getValue(){return this.value}equals(e){return this.getValue()===e.getValue()}}u(bt,"EMPTY",new(Ud=bt)(0)),u(bt,"PAWN",new Ud(1)),u(bt,"DRONE",new Ud(2)),u(bt,"QUEEN",new Ud(3));class R0{static of(e){const t=new En;for(const n of e)R0.addToMap(t,n);return new R0(t)}static addToMap(e,t){const n=e.get(t);n.isPresent()?e.replace(t,n.get()+1):e.set(t,1)}constructor(e){u(this,"captures",void 0),this.captures=e,e.makeImmutable()}toValue(){let e=0;return this.captures.forEach(t=>{e+=t.key.getValue()*t.value}),e}add(e){const t=this.captures.getCopy();return R0.addToMap(t,e),new R0(t)}}class On extends W1{static getInitialState(){const e=bt.EMPTY,t=bt.PAWN,n=bt.DRONE,i=bt.QUEEN;return new On([[i,i,n,e],[i,n,t,e],[n,t,t,e],[e,e,e,e],[e,e,e,e],[e,t,t,n],[e,t,n,i],[e,n,i,i]],0,g.empty())}static isOnBoard(e){return e.isInRange(On.WIDTH,On.HEIGHT)}constructor(e,t,n=g.empty(),i=g.empty(),s){super(e,t),u(this,"lastMove",void 0),u(this,"countDown",void 0),u(this,"captured",void 0),this.lastMove=n,this.countDown=i,null==s&&(s=new En([{key:k.ZERO,value:R0.of([])},{key:k.ONE,value:R0.of([])}])),s.makeImmutable(),this.captured=s}getPlayerTerritory(e){return e===k.ZERO?On.PLAYER_ZERO_TERRITORY:On.PLAYER_ONE_TERRITORY}isTherePieceOnPlayerSide(e){const t=this.getCurrentPlayer(),n=this.getPlayerTerritory(t);for(const i of n)for(let s=0;s<On.WIDTH;s++)if(this.getPieceAtXY(s,i)===e)return!0;return!1}getScoreOf(e){return this.captured.get(e).get().toValue()}getEmptyTerritory(){return this.isTerritoryEmpty(k.ZERO)?g.of(k.ZERO):this.isTerritoryEmpty(k.ONE)?g.of(k.ONE):g.empty()}isTerritoryEmpty(e){const t=this.getPlayerTerritory(e);for(const n of t)for(let i=0;i<On.WIDTH;i++)if(this.getPieceAtXY(i,n)!==bt.EMPTY)return!1;return!0}isInOpponentTerritory(e){const t=this.getCurrentOpponent();return this.getPlayerTerritory(t).contains(e.y)}isInPlayerTerritory(e){const t=this.getCurrentPlayer();return this.getPlayerTerritory(t).contains(e.y)}getCapturesOf(e){const t=this.captured.get(e).get();return[t.captures.get(bt.PAWN).getOrElse(0),t.captures.get(bt.DRONE).getOrElse(0),t.captures.get(bt.QUEEN).getOrElse(0)]}}u(On,"WIDTH",4),u(On,"HEIGHT",8),u(On,"PLAYER_ZERO_TERRITORY",new dt([4,5,6,7])),u(On,"PLAYER_ONE_TERRITORY",new dt([0,1,2,3]));let HC=(()=>{class r{}return u(r,"START_COORD_OUT_OF_RANGE",()=>$localize`Start coord cannot be out of range`),u(r,"END_COORD_OUT_OF_RANGE",()=>$localize`End coord cannot be out of range`),u(r,"PAWN_MUST_MOVE_ONE_DIAGONAL_STEP",()=>$localize`Pawns must move one step diagonally.`),u(r,"DRONE_MUST_DO_TWO_ORTHOGONAL_STEPS",()=>$localize`Drones must move one or two steps in any direction.`),r})();class Ir extends $o{static from(e,t,n=!1){if(!1===On.isOnBoard(e))return ie.failure(HC.START_COORD_OUT_OF_RANGE());if(!1===On.isOnBoard(t))return ie.failure(HC.END_COORD_OUT_OF_RANGE());if(t.equals(e))return ie.failure(Re.MOVE_CANNOT_BE_STATIC());const i=Me.factory.fromDelta(t.x-e.x,t.y-e.y);return i.isFailure()?ie.failure(i.getReason()):ie.success(new Ir(e,t,n))}constructor(e,t,n){super(e,t),u(this,"calledTheClock",void 0),this.calledTheClock=n}toString(){const e=this.calledTheClock?", CALL_THE_CLOCK":"";return"MartianChessMove(("+this.getStart().x+", "+this.getStart().y+") -> ("+this.getEnd().x+", "+this.getEnd().y+")"+e+")"}equals(e){return!1!==super.equals(e)&&this.calledTheClock===e.calledTheClock}isValidForPawn(){return this.getStart().getVectorToward(this.getEnd()).isDiagonalOfLength(1)}isValidForDrone(){return this.getStart().getDistance(this.getEnd())<=2}isUndoneBy(e){if(e.isAbsent())return!1;const t=e.get();return t.getEnd().equals(this.getStart())&&t.getStart().equals(this.getEnd())}}s3e=Ir,u(Ir,"encoder",we.tuple([C.encoder,C.encoder,we.identity()],r=>[r.getStart(),r.getEnd(),r.calledTheClock],r=>s3e.from(r[0],r[1],r[2]).get()));let o3e=(()=>{class r{}return u(r,"YOU_DID_NOT_CAPTURE_ANY_PIECE",()=>$localize`Failed, you did not capture any piece.`),r})();const X=bt.EMPTY,_i=bt.PAWN,g4=bt.DRONE,Ll=bt.QUEEN;class a3e extends Zn{constructor(...e){super(...e),u(this,"tutorial",[q.informational($localize`Goal of the game`,$localize`At Martian Chess, the goal is to have the most points at the end of the game. Each piece is assigned a value, you win this value when capturing the piece. The board is divided in two by a line called the canal. There is one side for each player. You do not own pieces, but you control the ones on your side of the canal. Pieces are colored to help you: they will change color when crossing the canal.`,On.getInitialState()),q.informational($localize`The pieces`,$localize`The pieces are dark on the side of the first player, the light ones on the side of the second one. There are 3 kind of pieces: <ul><li>The Queens: represented as circles with 3 dots.</li><li>The Drones: represented as circles with 2 dots.</li><li>The Pawns: represented as circles with one dot.</li></ul>`,On.getInitialState()),q.fromPredicate($localize`Moving pawns`,$localize`Pawns are worth one point. They can move one step diagonally.<br/><br/>You're playing Dark, move a pawn.`,On.getInitialState(),Ir.from(new C(2,5),new C(1,4)).get(),(t,n,i)=>i.getPieceAt(t.getEnd())===bt.PAWN?b.SUCCESS:b.failure($localize`This is not a pawn!`),$localize`Congratulations!`),q.fromPredicate($localize`Moving drones`,$localize`Drones are worth two points. They can move one or two steps in any direction, in a straight line, without jumping over other pieces.<br/><br/>You're playing Dark, move a drone.`,On.getInitialState(),Ir.from(new C(1,7),new C(0,7)).get(),(t,n,i)=>i.getPieceAt(t.getEnd())===bt.DRONE?b.SUCCESS:b.failure($localize`This is not a drone!`),$localize`Congratulations!`),q.fromPredicate($localize`Moving queens`,$localize`Queens are worth three points. They can move any number of steps in any direction, in a straight line, without jumping over other pieces.<br/><br/>You're playing Dark, move a queen.`,new On([[g4,_i,X,X],[Ll,X,X,X],[X,X,X,X],[X,X,Ll,X],[X,X,X,X],[X,X,X,X],[X,X,X,X],[Ll,g4,_i,X]],1),Ir.from(new C(2,3),new C(2,7)).get(),(t,n,i)=>i.getPieceAt(t.getEnd())===bt.QUEEN?b.SUCCESS:b.failure($localize`This is not a queen!`),$localize`Congratulations!`),q.fromMove($localize`Capture`,$localize`When a piece crosses the canal and lands on another piece, you capture it and gain the value of that captured piece. However, you lose control of your piece as it crosses the canal!<br/><br/>A capture is possible for Dark, do it.`,new On([[g4,_i,_i,X],[X,X,X,X],[Ll,X,X,X],[X,X,X,X],[X,X,_i,X],[X,X,X,X],[X,X,X,X],[X,g4,_i,X]],1),[Ir.from(new C(0,2),new C(2,4)).get()],$localize`Congratulations! By capturing that pawn, you won one point.`,o3e.YOU_DID_NOT_CAPTURE_ANY_PIECE()),q.fromMove($localize`Field Promotion (1/2)`,$localize`It is sometimes possible to perform what is called a field promotion. If you are out of one type of piece, you can merge two pieces to add their value and get a new piece. For example, if you have no drones, you can merge two pawns into a drone. To merge two pawns, move one of your pawns on another.<br/><br/>Such a move is possible for Dark. Do it.`,new On([[X,X,X,Ll],[X,_i,X,X],[X,X,_i,X],[X,X,X,X],[X,X,X,X],[X,X,X,Ll],[X,X,g4,X],[X,_i,X,X]],1),[Ir.from(new C(1,1),new C(2,2)).get(),Ir.from(new C(2,2),new C(1,1)).get()],$localize`Congratulations!`,$localize`This is not a field promotion!`),q.fromPredicate($localize`Field Promotion (2/2)`,$localize`The other kind of field promotion is to merge a drone and a pawn to obtain a queen.<br/><br/>Such a move is possible for Light. Do it.`,new On([[_i,X,X,X],[X,X,X,X],[X,X,X,X],[X,X,X,X],[X,X,X,X],[X,X,X,X],[X,X,g4,X],[X,_i,X,X]],0),Ir.from(new C(1,7),new C(2,6)).get(),(t,n,i)=>i.getPieceAt(t.getEnd())===bt.QUEEN?b.SUCCESS:b.failure($localize`This is not a field promotion!`),$localize`Congratulations!`),q.fromPredicate($localize`Call the clock`,$localize`When the game seems to be going nowhere, you can "call the clock" during your turn. To do so, click on the clock symbol on the right, then perform your move. Once the clock is called, seven more turn will be played.<br/><br/>You're playing Dark. Call the clock and perform a move.`,On.getInitialState(),Ir.from(new C(1,5),new C(0,4),!0).get(),(t,n,i)=>t.calledTheClock?b.SUCCESS:b.failure($localize`You did not call the clock!`),$localize`Congratulations!`),q.fromMove($localize`Restarting the clock`,$localize`If the clock has been called, whenever a capture is done the countdown restarts.<br/><br/>You're playing Dark, do a capture to restart the countdown.`,new On([[X,X,X,X],[X,_i,X,X],[X,X,X,X],[X,X,X,X],[X,X,X,X],[X,X,X,_i],[X,X,g4,X],[X,_i,X,X]],15,g.empty(),g.of(1)),[Ir.from(new C(1,1),new C(2,2)).get()],$localize`Congratulations!`,$localize`This is not a capture, the game is now over, please retry!`),q.anyMove($localize`End game (by clock)`,$localize`When seven turns have passed after the clock has been called, the player with the most points win. If both player have the same number of points, it is a tie.<br/><br/>You're playing Dark, do the last move.`,new On([[X,X,X,Ll],[X,_i,X,X],[X,X,X,X],[X,X,X,X],[X,X,X,X],[g4,X,X,X],[X,X,X,X],[X,g4,X,X]],15,g.empty(),g.of(1)),Ir.from(new C(1,1),new C(2,2)).get(),$localize`Congratulations!`),q.fromPredicate($localize`End by emptyness`,$localize`When a player's last piece is moved into the opponent territory, the game ends. If both players have the same number of points, the last player win!<br/><br/>Light player can win this way, do it!`,new On([[X,X,X,Ll],[X,_i,X,X],[X,X,X,X],[X,X,X,X],[X,X,_i,X],[X,X,X,X],[X,X,X,X],[X,X,X,X]],0),Ir.from(new C(2,4),new C(1,3)).get(),(t,n,i)=>3===t.getEnd().y?b.SUCCESS:b.failure($localize`Your piece is still in you territory!`),$localize`Congratulations!`)])}}let VC=(()=>{class r{}return u(r,"MUST_CHOOSE_PIECE_FROM_YOUR_TERRITORY",()=>$localize`You must pick a piece from your side of the board in order to move it.`),u(r,"CANNOT_CAPTURE_YOUR_OWN_PIECE_NOR_PROMOTE_IT",()=>$localize`This is not a valid promotion nor a valid capture.`),u(r,"CANNOT_UNDO_LAST_MOVE",()=>$localize`You cannot perform a move that is the reverse of the previous one.`),r})();class Va extends Yn{static get(){return Va.singleton.isAbsent()&&(Va.singleton=g.of(new Va)),Va.singleton.get()}constructor(){super(On)}applyLegalMove(e,t,n){const i=t.getCopiedBoard();i[e.getStart().y][e.getStart().x]=bt.EMPTY;const s=n.finalPiece;i[e.getEnd().y][e.getEnd().x]=s;const o=n.score;let a=t.countDown;if(a.isPresent())if(this.isCapture(e,t))a=Va.STARTING_COUNT_DOWN;else{const l=t.countDown.get();a=g.of(l-1)}return e.calledTheClock&&(a=Va.STARTING_COUNT_DOWN),new On(i,t.turn+1,g.of(e),a,o)}isLegal(e,t){this.assertNonDoubleClockCall(e,t);const n=this.isLegalMove(e,t);if(n.isFailure())return n.toOtherFallible();if(e.isUndoneBy(t.lastMove))return ie.failure(VC.CANNOT_UNDO_LAST_MOVE());if(this.isFieldPromotion(e,t))return this.isLegalFieldPromotion(e,t);const i=t.getPieceAt(e.getStart()),s=t.captured.getCopy();if(this.isCapture(e,t)){const a=t.getCurrentPlayer();let c=s.get(a).get();const l=t.getPieceAt(e.getEnd());c=c.add(l),s.replace(a,c),s.makeImmutable()}return ie.success({finalPiece:i,score:s})}assertNonDoubleClockCall(e,t){Ze(!1===(t.countDown.isPresent()&&e.calledTheClock),"Should not call the clock twice")}isCapture(e,t){const n=t.isInOpponentTerritory(e.getEnd()),i=t.getPieceAt(e.getEnd())!==bt.EMPTY;return n&&i}isFieldPromotion(e,t){const n=t.isInPlayerTerritory(e.getEnd()),i=t.getPieceAt(e.getEnd())!==bt.EMPTY;return n&&i}isLegalFieldPromotion(e,t){const n=this.getPromotedPiece(e,t);if(n.isAbsent())return ie.failure(VC.CANNOT_CAPTURE_YOUR_OWN_PIECE_NOR_PROMOTE_IT());const i=n.get();if(t.isTherePieceOnPlayerSide(i))return ie.failure(VC.CANNOT_CAPTURE_YOUR_OWN_PIECE_NOR_PROMOTE_IT());{const s={finalPiece:i,score:t.captured.getCopy()};return ie.success(s)}}isLegalMove(e,t){if(!1===t.isInPlayerTerritory(e.getStart()))return b.failure(VC.MUST_CHOOSE_PIECE_FROM_YOUR_TERRITORY());const i=t.getPieceAt(e.getStart());if(i===bt.EMPTY)return b.failure(Re.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(i===bt.PAWN)return e.isValidForPawn()?b.SUCCESS:b.failure(HC.PAWN_MUST_MOVE_ONE_DIAGONAL_STEP());if(i===bt.DRONE&&!1===e.isValidForDrone())return b.failure(HC.DRONE_MUST_DO_TWO_ORTHOGONAL_STEPS());for(const s of e.getStart().getUntil(e.getEnd()))if(t.getPieceAt(s)!==bt.EMPTY)return b.failure(Re.SOMETHING_IN_THE_WAY());return b.SUCCESS}getPromotedPiece(e,t){const n=t.getPieceAt(e.getStart()),i=t.getPieceAt(e.getEnd());return bt.tryMerge(n,i)}getGameStatus(e){const t=e.gameState;if(t.countDown.equalsValue(0))return this.getGameStatusScoreVictoryOr(t,_e.DRAW);if(t.getEmptyTerritory().isPresent()){const i=t.getCurrentOpponent(),s=_e.getVictory(i);return this.getGameStatusScoreVictoryOr(t,s)}return _e.ONGOING}getGameStatusScoreVictoryOr(e,t){const n=e.getScoreOf(k.ZERO),i=e.getScoreOf(k.ONE);return n>i?_e.ZERO_WON:i>n?_e.ONE_WON:t}}u(Va,"STARTING_COUNT_DOWN",g.of(7)),u(Va,"singleton",g.empty());class c3e extends Un{getListMoves(e){const t=e.gameState,n=t.getCurrentPlayer(),i=t.getPlayerTerritory(n);let s=[];for(const o of i)for(let a=0;a<On.WIDTH;a++)switch(t.getPieceAtXY(a,o)){case bt.PAWN:s=s.concat(this.getMovesForPawnAt(t,a,o));break;case bt.DRONE:s=s.concat(this.getMovesForDroneAt(t,a,o));break;case bt.QUEEN:s=s.concat(this.getMovesForQueenAt(t,a,o))}return s}getMovesForPawnAt(e,t,n){const i=new C(t,n),s=[];for(const o of Me.DIAGONALS){const a=i.getNext(o);On.isOnBoard(a)&&s.push(a)}return this.addLegalMoves(e,i,s)}addLegalMoves(e,t,n){const i=[],s=e.getPieceAt(t),o=!1===e.isTherePieceOnPlayerSide(bt.DRONE),a=!1===e.isTherePieceOnPlayerSide(bt.QUEEN),c=e.lastMove;for(const l of n){const f=e.getPieceAt(l);if(f===bt.EMPTY)this.add(i,Ir.from(t,l).get(),c);else if(e.isInPlayerTerritory(l)){const d=bt.tryMerge(f,s);if(d.isPresent()){const m=d.get(),E=Ir.from(t,l).get();(m===bt.DRONE&&o||m===bt.QUEEN&&a)&&this.add(i,E,c)}}else this.add(i,Ir.from(t,l).get(),c)}return i}add(e,t,n){!1===t.isUndoneBy(n)&&e.push(t)}getMovesForDroneAt(e,t,n){const i=new C(t,n),s=this.getLandingCoordsForLinearMove(i,e,2);return this.addLegalMoves(e,i,s)}getLandingCoordsForLinearMove(e,t,n){const i=[];for(const s of Me.DIRECTIONS){let o=1,a=e.getNext(s,o),c=t.tryToGetPieceAt(a),l=c.equalsValue(bt.EMPTY);for(;l;)i.push(a),o++,a=e.getNext(s,o),c=t.tryToGetPieceAt(a),l=c.equalsValue(bt.EMPTY)&&o<n;c.isPresent()&&i.push(a)}return i}getMovesForQueenAt(e,t,n){const i=new C(t,n),s=this.getLandingCoordsForQueen(i,e);return this.addLegalMoves(e,i,s)}getLandingCoordsForQueen(e,t){return this.getLandingCoordsForLinearMove(e,t,On.HEIGHT)}}class Ept extends fr{getMetrics(e){return[e.gameState.getScoreOf(k.ZERO),e.gameState.getScoreOf(k.ONE)]}}function Spt(r,e){if(1&r&&(N(),F(0,"g",19)),2&r){const t=p(2).index,n=p().index,i=p();ni(i.style),ye("mainShapeId","pawn_",t,"_",n,""),y("pieceClasses",i.getPieceClasses(t,n))}}function Ppt(r,e){if(1&r&&(N(),F(0,"g",20)),2&r){const t=p(2).index,n=p().index,i=p();ni(i.style),ye("mainShapeId","drone_",t,"_",n,""),y("pieceClasses",i.getPieceClasses(t,n))}}function Tpt(r,e){if(1&r&&(N(),F(0,"g",21)),2&r){const t=p(2).index,n=p().index,i=p();ni(i.style),ye("mainShapeId","queen_",t,"_",n,""),y("pieceClasses",i.getPieceClasses(t,n))}}function Opt(r,e){if(1&r&&(N(),S(0,"g"),T(1,Spt,1,5,"g",16),T(2,Ppt,1,5,"g",17),T(3,Tpt,1,5,"g",18),P()),2&r){const t=p(),n=t.index,i=t.$implicit,s=p().index,o=p();I("transform",o.getPieceLocation(n,s)),_(1),y("ngIf",i===o.pieces.PAWN),_(1),y("ngIf",i===o.pieces.DRONE),_(1),y("ngIf",i===o.pieces.QUEEN)}}function bpt(r,e){if(1&r){const t=pe();N(),S(0,"g",14),W("click",function(){const s=te(t).index,o=p().index;return ne(p().onClick(s,o))}),F(1,"rect",15),T(2,Opt,4,4,"g",13),P()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,s=p();ye("id","click_",n,"_",i,""),I("transform",s.getPieceTranslation(i)),_(1),ye("id","square_",n,"_",i,""),y("ngClass",s.getSquareClasses(n,i)),I("x",n*s.SPACE_SIZE)("y",i*s.SPACE_SIZE)("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),_(1),y("ngIf",t!==s.pieces.EMPTY)}}function wpt(r,e){if(1&r){const t=pe();N(),S(0,"g")(1,"rect",22),W("click",function(){const s=te(t).$implicit;return ne(p(3).onClick(s.x,s.y))}),P()()}if(2&r){const t=e.$implicit,n=p(3);_(1),ye("id","indicator_",t.x,"_",t.y,""),I("transform",n.getPieceTranslation(t.y))("x",t.x*n.SPACE_SIZE+(n.SPACE_SIZE/2-n.INDICATOR_SIZE/2))("y",t.y*n.SPACE_SIZE+(n.SPACE_SIZE/2-n.INDICATOR_SIZE/2))("width",n.INDICATOR_SIZE)("height",n.INDICATOR_SIZE)}}function Apt(r,e){if(1&r&&(N(),S(0,"g"),T(1,wpt,2,7,"g",1),P()),2&r){const t=p(2);_(1),y("ngForOf",t.selectedPieceInfo.get().legalLandings)}}function Npt(r,e){if(1&r&&(N(),S(0,"g"),T(1,bpt,3,11,"g",12),T(2,Apt,2,1,"g",13),P()),2&r){const t=e.$implicit,n=p();_(1),y("ngForOf",t),_(1),y("ngIf",n.selectedPieceInfo.isPresent())}}function Ipt(r,e){if(1&r&&(N(),S(0,"text",23),lt(1),P()),2&r){const t=p();y("ngClass","player"+t.getCurrentPlayer().value)("ngClass",t.getClockCircleClasses()),I("x",.5*t.SPACE_SIZE)("y",.5*t.SPACE_SIZE),_(1),An(t.countDown.get())}}function kpt(r,e){if(1&r&&(N(),F(0,"polyline",24)),2&r){const t=p();y("ngClass",t.getClockCircleClasses()),I("points",t.clockNeedlesPoints)}}const FC=function(r){return[r]};function xpt(r,e){if(1&r){const t=pe();N(),Gt(0),S(1,"g",27),W("click",function(){const s=te(t).index;return ne(p(2).chooseStyle(s))}),P(),Bt()}if(2&r){const t=e.$implicit,n=e.index,i=p(2);_(1),ni(t.style),y("id",t.name)("pieceClasses",_a(5,FC,"player"+i.getCurrentPlayer().value+"-fill")),I("transform","translate(0, "+-(n+1)*i.SPACE_SIZE+")")}}function Lpt(r,e){if(1&r&&(N(),S(0,"g",25),F(1,"rect",26),T(2,xpt,2,7,"ng-container",1),P()),2&r){const t=p();_(1),I("x",0)("y",-t.listOfStyles.length*t.SPACE_SIZE)("width",1*t.SPACE_SIZE)("height",t.listOfStyles.length*t.SPACE_SIZE),_(1),y("ngForOf",t.listOfStyles)}}function Rpt(r,e){if(1&r&&(N(),S(0,"text",33),lt(1),P()),2&r){const t=p(2).$implicit,n=p().$implicit,i=p();y("ngClass",i.getPlayerClass(n)),I("x",i.SPACE_SIZE/2)("y",i.SPACE_SIZE/2),_(1),An(t+" x ")}}function zpt(r,e){if(1&r&&(N(),F(0,"g",34)),2&r){const t=p(3).$implicit,n=p();ni(n.style),y("pieceClasses",_a(3,FC,n.getPlayerClass(t)))}}function Dpt(r,e){if(1&r&&(N(),F(0,"g",35)),2&r){const t=p(3).$implicit,n=p();ni(n.style),y("pieceClasses",_a(3,FC,n.getPlayerClass(t)))}}function Hpt(r,e){if(1&r&&(N(),F(0,"g",36)),2&r){const t=p(3).$implicit,n=p();ni(n.style),y("pieceClasses",_a(3,FC,n.getPlayerClass(t)))}}function Vpt(r,e){if(1&r&&(N(),S(0,"g"),T(1,Rpt,2,4,"text",29),S(2,"g",28),T(3,zpt,1,5,"g",30),T(4,Dpt,1,5,"g",31),T(5,Hpt,1,5,"g",32),P()()),2&r){const t=p(),n=t.index,i=t.$implicit,s=p().$implicit,o=p();I("transform","translate(0, "+2*n*o.SPACE_SIZE+")"),_(1),y("ngIf",i>1),_(1),ye("id","piece_",n,"_player_",s.value,""),I("transform","translate("+o.SPACE_SIZE+", 0)"),_(1),y("ngIf",0===n),_(1),y("ngIf",1===n),_(1),y("ngIf",2===n)}}function Fpt(r,e){if(1&r&&(N(),S(0,"g"),T(1,Vpt,6,8,"g",13),P()),2&r){const t=e.$implicit;_(1),y("ngIf",t>0)}}function $pt(r,e){if(1&r&&(N(),S(0,"g")(1,"g",28),T(2,Fpt,2,1,"g",1),P()()),2&r){const t=e.$implicit,n=p();_(1),zn("id","capture_of_player_",t.value,""),I("transform",n.getCapturesTransformation(t)),_(1),y("ngForOf",n.state.getCapturesOf(t))}}let Ms=(()=>{var r;class e extends Fi{static getRegularPolygon(n,i=0){const s=e.getRegularPolygonCoords(n,i);return e.mapCoordsToString(s)}static getNPointedStar(n,i){const s=this.getNPointedStarCoords(n,i);return e.mapCoordsToString(s)}static getNPointedStarCoords(n,i){const s=[],o=.5*e.SPACE_SIZE,a=.5*e.SPACE_SIZE;n*=2;for(let c=0;c<n;c++){const f=(c*(360/n)+i)/180*Math.PI,d=c%2==0?e.SPACE_SIZE/2:e.SPACE_SIZE/6,m=o+.8*d*Math.cos(f),E=a+.8*d*Math.sin(f);s.push(new C(m,E))}return s}static getRegularPolygonCoords(n,i=0){const s=[],o=.5*e.SPACE_SIZE,a=.5*e.SPACE_SIZE;for(let c=0;c<n;c++){const f=(c*(360/n)-90)/180*Math.PI,d=.5*e.SPACE_SIZE,m=o+.8*d*Math.cos(f),E=a+.8*d*Math.sin(f)+i;s.push(new C(m,E))}return s}static mapCoordsToString(n){let i="";for(const s of n)i+=s.x+", "+s.y+" ";return i}static getRadius(n){return this.SPACE_SIZE*n/10}constructor(n){super(n),u(this,"INDICATOR_SIZE",20),u(this,"HORIZONTAL_CENTER",.5*On.WIDTH*e.SPACE_SIZE),u(this,"UNSTROKED_HEIGHT",On.HEIGHT*e.SPACE_SIZE),u(this,"VERTICAL_CENTER",.5*this.UNSTROKED_HEIGHT+e.STROKE_WIDTH),u(this,"LEFT",e.SPACE_SIZE/-4+e.STROKE_WIDTH/-2),u(this,"UNSTROKED_WIDTH",On.WIDTH*e.SPACE_SIZE),u(this,"UP",-e.STROKE_WIDTH/2),u(this,"WIDTH",this.UNSTROKED_WIDTH+2.5*e.SPACE_SIZE+e.STROKE_WIDTH),u(this,"HEIGHT",this.UNSTROKED_HEIGHT+3*e.STROKE_WIDTH),u(this,"MartianChessComponent",e),u(this,"style",{shape:"Circle",points:"Horizontal Points"}),u(this,"pieces",bt),u(this,"state",void 0),u(this,"configViewTranslation",void 0),u(this,"configCogTransformation",void 0),u(this,"selectedPieceInfo",g.empty()),u(this,"countDown",g.empty()),u(this,"callTheClock",!1),u(this,"displayModePanel",!1),u(this,"listOfStyles",[{name:"Star",style:{shape:"Star",points:"Dots"}},{name:"Polygon",style:{shape:"Polygon",points:"Concentric Circles"}},{name:"Simple",style:{shape:"Circle",points:"Horizontal Points"}},{name:"Circely",style:{shape:"Circle",points:"Concentric Circles"}}]),u(this,"clockNeedlesPoints",void 0),this.hasAsymmetricBoard=!0,this.rules=Va.get(),this.node=this.rules.getInitialNode(),this.availableAIs=[new on($localize`Score`,this.rules,new Ept,new c3e),new Kn($localize`MCTS`,new c3e,this.rules)],this.SPACE_SIZE=e.SPACE_SIZE,this.configCogTransformation=this.getConfigCogTransformation(),this.configViewTranslation=this.getConfigViewTranslation(),this.clockNeedlesPoints=this.getClockNeedlesPoints(),this.encoder=Ir.encoder,this.tutorial=(new a3e).tutorial,this.scores=g.of([0,0])}getConfigViewTranslation(){return"translate("+(5.25*this.SPACE_SIZE+0)+", "+(7*this.SPACE_SIZE+0+2*this.STROKE_WIDTH)+")"}getConfigCogTransformation(){const n=this.STROKE_WIDTH,s=(this.SPACE_SIZE-n)/40;return"translate("+1*n+", "+1*n+") scale("+s+" "+s+")"}getClockNeedlesPoints(){const n=.5*this.SPACE_SIZE;return n+" "+.1*this.SPACE_SIZE+", "+n+" "+n+", "+.75*this.SPACE_SIZE+" "+n}updateBoard(n){var i=this;return M(function*(){i.state=i.getState(),i.board=i.state.board;const s=i.state.getScoreOf(k.ZERO),o=i.state.getScoreOf(k.ONE);i.countDown=i.state.countDown,i.scores=g.of([s,o])})()}getPieceLocation(n,i){return"translate("+this.SPACE_SIZE*n+", "+this.SPACE_SIZE*i+")"}getPieceClasses(n,i){const s=new C(n,i),o=[];return o.push(i>3?"player0-fill":"player1-fill"),this.selectedPieceInfo.isPresent()&&this.selectedPieceInfo.get().selectedPiece.equals(s)&&o.push("selected-stroke"),this.node.previousMove.isPresent()&&this.node.previousMove.get().getEnd().equals(s)&&this.getPreviousState().getPieceAt(s)!==bt.EMPTY&&this.getState().isInOpponentTerritory(new C(0,i))&&o.push("last-move-stroke"),o}onClick(n,i){var s=this;return M(function*(){s.displayModePanel=!1;const o=yield s.canUserPlay("#click_"+n+"_"+i);if(o.isFailure())return s.cancelMove(o.getReason());const a=new C(n,i);return s.selectedPieceInfo.isPresent()?s.secondClick(a):s.firstClick(a)})()}firstClick(n){var i=this;return M(function*(){return i.isOneOfUsersPieces(n)?i.selectAsFirstPiece(n):(i.cancelMoveAttempt(),b.SUCCESS)})()}selectAsFirstPiece(n){var i=this;return M(function*(){const s=i.getLegalLandings(n);return i.selectedPieceInfo=g.of({selectedPiece:n,legalLandings:s}),b.SUCCESS})()}getLegalLandings(n){const i=this.state.getPieceAt(n);let s;return s=i===bt.PAWN?Me.DIAGONALS.map(o=>n.getNext(o)):this.getValidLinearLandingSquareUntil(n,i===bt.DRONE?2:On.HEIGHT),s.filter(o=>{const a=Ir.from(n,o);return!!a.isSuccess()&&this.rules.isLegal(a.get(),this.getState()).isSuccess()})}getValidLinearLandingSquareUntil(n,i){return Me.DIRECTIONS.flatMap(s=>{const o=[];let a=n.getNext(s),c=1;for(;On.isOnBoard(a)&&c<=i&&(o.push(a),this.getState().getPieceAt(a)===bt.EMPTY);)a=a.getNext(s),c++;return o})}secondClick(n){var i=this;return M(function*(){const s=i.selectedPieceInfo.get();if(s.selectedPiece.equals(n))return i.cancelMoveAttempt(),b.SUCCESS;if(s.legalLandings.some(o=>o.equals(n))){const o=Ir.from(s.selectedPiece,n,i.callTheClock);return U.assert(o.isSuccess(),"MartianChessComponent or Rules did a mistake thinking this would have been a legal move!"),i.chooseMove(o.get())}if(i.isOneOfUsersPieces(n))return i.selectAsFirstPiece(n);{const o=Ir.from(s.selectedPiece,n,i.callTheClock);return o.isSuccess()?i.chooseMove(o.get()):i.cancelMove(o.getReason())}})()}isOneOfUsersPieces(n){return this.state.getPieceAt(n)!==bt.EMPTY&&this.state.isInPlayerTerritory(n)}cancelMoveAttempt(){this.selectedPieceInfo=g.empty(),this.callTheClock=!1}onClockClick(){var n=this;return M(function*(){const i=yield n.canUserPlay("#clockOrCountDownView");return i.isFailure()?n.cancelMove(i.getReason()):(n.getState().countDown.isAbsent()&&(n.callTheClock=!1===n.callTheClock),b.SUCCESS)})()}getClockCircleClasses(){const n=["base"];return this.callTheClock&&n.push("selected-stroke"),this.getCurrentPlayer()===k.ZERO?n.push("player0-stroke"):n.push("player1-stroke"),n}getSquareClasses(n,i){const s=new C(n,i),o=["base"];if(this.node.previousMove.isPresent()){const a=this.node,c=a.previousMove.get();c.getStart().equals(s)?o.push("moved-fill"):c.getEnd().equals(s)&&(a.parent.get().gameState.getPieceAt(s)===bt.EMPTY||a.gameState.isInOpponentTerritory(new C(0,i))?o.push("moved-fill"):o.push("captured-fill"))}return o}onModeCogClick(){this.displayModePanel=!1===this.displayModePanel}chooseStyle(n){this.style=this.listOfStyles[n].style,this.displayModePanel=!1}getPieceTranslation(n){return"translate(0, "+(n<=3?0:2*this.STROKE_WIDTH)+")"}getBoardTransformation(){return"translate("+this.SPACE_SIZE+", 0) rotate("+180*this.role.value+" "+this.HORIZONTAL_CENTER+" "+this.VERTICAL_CENTER+")"}getCapturesTransformation(n){let o=this.SPACE_SIZE/2;return n===this.role&&(o+=10*this.SPACE_SIZE+4*this.STROKE_WIDTH),"scale(0.5, 0.5) translate("+-this.SPACE_SIZE/2+", "+o+")"}}return r=e,u(e,"SPACE_SIZE",100),u(e,"STROKE_WIDTH",8),u(e,"\u0275fac",function(n){return new(n||r)(B(Ut))}),u(e,"\u0275cmp",qe({type:r,selectors:[["app-martian-chess"]],features:[Qe],decls:15,vars:19,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["id","clockOrCountDownView",3,"click"],["x","0","y","0",1,"transparent"],["id","clockOrCountDownCircle",3,"ngClass"],["id","countDownText","class","text-giant text-center",3,"ngClass",4,"ngIf"],["class","base","stroke-linecap","round",3,"ngClass",4,"ngIf"],["id","modeCogView"],["id","modeCog",3,"click"],["d","M35.497,15.111h-1.656c-0.282-0.924-0.653-1.807-1.102-2.646l1.176-1.175c1.364-1.366,1.366-3.582,0-4.949l-1.258-1.258 c-0.656-0.656-1.548-1.025-2.476-1.025l0,0c-0.93,0-1.818,0.369-2.477,1.025l-1.176,1.175c-0.838-0.446-1.721-0.817-2.645-1.102 V3.501c0-1.934-1.566-3.5-3.5-3.5h-1.778c-1.934,0-3.5,1.566-3.5,3.5v1.655c-0.923,0.282-1.807,0.653-2.645,1.102l-1.174-1.175 c-1.367-1.367-3.584-1.367-4.951,0L5.081,6.34c-1.367,1.366-1.367,3.583,0,4.949l1.174,1.175c-0.446,0.84-0.818,1.723-1.102,2.646 H3.5c-1.934,0-3.5,1.566-3.5,3.5v1.778c0,1.932,1.566,3.5,3.5,3.5h1.654c0.283,0.922,0.654,1.807,1.102,2.645l-1.175,1.176 c-1.366,1.365-1.366,3.582-0.001,4.949l1.258,1.258c0.656,0.654,1.547,1.023,2.475,1.023h0.001c0.929,0,1.818-0.369,2.475-1.023 l1.176-1.176c0.837,0.447,1.722,0.818,2.644,1.102v1.656c0,1.932,1.566,3.5,3.5,3.5h1.778c1.934,0,3.5-1.568,3.5-3.5v-1.656 c0.924-0.283,1.807-0.654,2.645-1.102l1.177,1.176c0.655,0.656,1.547,1.023,2.476,1.023c0.93,0,1.817-0.369,2.477-1.023 l1.256-1.258c1.366-1.367,1.365-3.582,0-4.949l-1.176-1.174c0.447-0.84,0.818-1.725,1.102-2.646h1.656c1.934,0,3.5-1.568,3.5-3.5 v-1.777C38.997,16.679,37.43,15.111,35.497,15.111z M19.499,27.499c-4.41,0-8-3.588-8-8c0-4.411,3.59-8,8-8c4.412,0,8,3.589,8,8 C27.499,23.911,23.911,27.499,19.499,27.499z",3,"ngClass"],["id","modePanel",4,"ngIf"],["id","captures"],[3,"id","click",4,"ngFor","ngForOf"],[4,"ngIf"],[3,"id","click"],[3,"id","ngClass"],["app-martian-chess-pawn","",3,"mainShapeId","pieceClasses","style",4,"ngIf"],["app-martian-chess-drone","",3,"pieceClasses","mainShapeId","style",4,"ngIf"],["app-martian-chess-queen","",3,"mainShapeId","pieceClasses","style",4,"ngIf"],["app-martian-chess-pawn","",3,"mainShapeId","pieceClasses"],["app-martian-chess-drone","",3,"pieceClasses","mainShapeId"],["app-martian-chess-queen","",3,"mainShapeId","pieceClasses"],[1,"indicator",3,"id","click"],["id","countDownText",1,"text-giant","text-center",3,"ngClass"],["stroke-linecap","round",1,"base",3,"ngClass"],["id","modePanel"],["stroke-width","8",1,"base"],["app-martian-chess-queen","",3,"id","pieceClasses","click"],[3,"id"],["class","text-giant text-center",3,"ngClass",4,"ngIf"],["app-martian-chess-pawn","",3,"pieceClasses","style",4,"ngIf"],["app-martian-chess-drone","",3,"pieceClasses","style",4,"ngIf"],["app-martian-chess-queen","",3,"pieceClasses","style",4,"ngIf"],[1,"text-giant","text-center",3,"ngClass"],["app-martian-chess-pawn","",3,"pieceClasses"],["app-martian-chess-drone","",3,"pieceClasses"],["app-martian-chess-queen","",3,"pieceClasses"]],template:function(n,i){1&n&&(N(),S(0,"svg",0)(1,"g"),T(2,Npt,3,2,"g",1),P(),S(3,"g",2),W("click",function(){return i.onClockClick()}),F(4,"rect",3)(5,"circle",4),T(6,Ipt,2,5,"text",5),T(7,kpt,1,2,"polyline",6),P(),S(8,"g",7)(9,"g",8),W("click",function(){return i.onModeCogClick()}),F(10,"rect",3)(11,"path",9),P(),T(12,Lpt,3,5,"g",10),P(),S(13,"g",11),T(14,$pt,3,3,"g",1),P()()),2&n&&(I("viewBox",i.LEFT+" "+i.UP+" "+i.WIDTH+" "+i.HEIGHT),_(1),I("transform",i.getBoardTransformation()),_(1),y("ngForOf",i.board),_(1),I("transform","translate("+5.25*i.SPACE_SIZE+", 0)"),_(1),I("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),_(1),y("ngClass",i.getClockCircleClasses()),I("cx",.5*i.SPACE_SIZE)("cy",.5*i.SPACE_SIZE)("r",.4*i.SPACE_SIZE),_(1),y("ngIf",i.countDown.isPresent()),_(1),y("ngIf",i.countDown.isAbsent()),_(1),I("transform",i.configViewTranslation),_(2),I("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),_(1),y("ngClass",i.getPlayerClass(i.getCurrentPlayer())),I("transform",i.configCogTransformation),_(1),y("ngIf",i.displayModePanel),_(2),y("ngForOf",i.Player.PLAYERS))},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})(),Fa=(()=>{class r extends W1{static getInitialState(){const t=Ie.createTable(r.WIDTH,r.HEIGHT,K.NONE);return new r(t,0)}static isOnBoard(t){return t.isInRange(r.WIDTH,r.HEIGHT)}}return u(r,"WIDTH",7),u(r,"HEIGHT",6),r})();var m4;class rr extends Di{static of(e){switch(e){case 0:return rr.ZERO;case 1:return rr.ONE;case 2:return rr.TWO;case 3:return rr.THREE;case 4:return rr.FOUR;case 5:return rr.FIVE;case 6:return rr.SIX;default:throw new Error("Invalid P4Move")}}constructor(e){super(),u(this,"x",void 0),this.x=e}equals(e){return this===e}toString(){return"P4Move("+this.x+")"}}u(rr,"ZERO",new(m4=rr)(0)),u(rr,"ONE",new m4(1)),u(rr,"TWO",new m4(2)),u(rr,"THREE",new m4(3)),u(rr,"FOUR",new m4(4)),u(rr,"FIVE",new m4(5)),u(rr,"SIX",new m4(6)),u(rr,"encoder",we.tuple([we.identity()],r=>[r.x],r=>m4.of(r[0])));let Gpt=(()=>{class r{}return u(r,"COLUMN_IS_FULL",()=>$localize`Please put your piece in an incomplete column.`),r})();var Wd,_4;let v4=(Wd=class extends Yn{static get(){return _4.singleton.isAbsent()&&(_4.singleton=g.of(new _4)),_4.singleton.get()}static getVictoriousCoords(e){return _4.P4_HELPER.getVictoriousCoord(e)}static getLowestUnoccupiedSpace(e,t){let n=0;for(;n<Fa.HEIGHT&&e[n][t]===K.NONE;)n++;return n-1}static getListMoves(e){const t=e.gameState,n=[];for(let i=0;i<Fa.WIDTH;i++)if(t.getPieceAtXY(i,0)===K.NONE){const s=rr.of(i);n.push(s)}return n}constructor(){super(Fa)}applyLegalMove(e,t,n){const i=e.x,s=t.getCopiedBoard(),o=_4.getLowestUnoccupiedSpace(s,i),a=t.turn;return s[o][i]=t.getCurrentPlayer(),new Fa(s,a+1)}isLegal(e,t){return t.getPieceAtXY(e.x,0).isPlayer()?b.failure(Gpt.COLUMN_IS_FULL()):b.SUCCESS}getGameStatus(e){const t=e.gameState;return _4.P4_HELPER.getVictoriousCoord(t).length>0?_e.getVictory(t.getCurrentOpponent()):42===t.turn?_e.DRAW:_e.ONGOING}},_4=Wd,u(Wd,"singleton",g.empty()),u(Wd,"P4_HELPER",new fu(Fa.isOnBoard,U.identity,4)),Wd);v4=_4=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ne.log],v4);const it=K.NONE,C4=K.ZERO,Eu=K.ONE;class l3e extends Zn{constructor(...e){super(...e),u(this,"tutorial",[q.informational($localize`Goal of the game`,$localize`The board at Four in a Row is made of 7 columns and 6 rows, and it is initially empty.
        The first player plays Dark, the second plays Light.
        The goal is to be the first to align 4 of its pieces (horizontally, vertically, or diagonally).`,Fa.getInitialState()),q.anyMove($localize`Dropping a piece`,$localize`Click on any space in any column.`,Fa.getInitialState(),rr.THREE,$localize`As you can see, the piece falls at the bottom of the column.`),q.fromMove($localize`Victory`,$localize`You're playing Dark.
        Place your piece so that you create a horizontal alignment of 4 of your pieces.`,new Fa([[it,it,it,it,it,it,it],[it,it,it,it,it,it,it],[it,it,it,it,it,it,it],[it,it,it,Eu,it,it,it],[it,it,it,Eu,it,it,it],[it,it,C4,C4,C4,Eu,it]],0),[rr.of(1)],$localize`You won!`,$localize`Failed, you have not aligned 4 pieces and missed an opportunity to win.`),q.fromMove($localize`Other victory`,$localize`You can also align 4 pieces diagonally or vertically.`,new Fa([[it,it,it,it,it,it,it],[it,it,it,it,it,it,it],[it,it,it,it,it,it,it],[it,it,it,C4,Eu,it,it],[it,it,C4,C4,Eu,it,it],[it,C4,Eu,C4,C4,it,it]],0),[rr.of(3),rr.of(4)],$localize`You won!`,$localize`Failed, you have not aligned 4 pieces and missed an opportunity to win.`)])}}let $C=class extends Un{getListMoves(e){return v4.getListMoves(e).sort((t,n)=>Math.abs(t.x-3)-Math.abs(n.x-3))}};$C=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ne.log],$C);class Wpt extends wa{getBoardValue(e){const t=e.gameState;let n=0;for(let i=0;i<Fa.WIDTH;i++)for(let s=Fa.HEIGHT-1;-1!==s&&t.board[s][i].isPlayer();s--)n+=v4.P4_HELPER.getSquareScore(t,new C(i,s));return new Jn(n)}}class qpt extends on{constructor(){super($localize`Minimax`,v4.get(),new Wpt,new $C)}}function jpt(r,e){if(1&r&&(N(),F(0,"circle",8)),2&r){const t=p().index,n=p().index,i=p();y("ngClass",i.getSquareFillClass(t,n)),I("cx",i.SPACE_SIZE*t+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)}}function Zpt(r,e){if(1&r){const t=pe();N(),S(0,"g",5),W("click",function(){const s=te(t).index;return ne(p(2).onClick(s))}),F(1,"rect",6),T(2,jpt,1,4,"circle",7),P()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,s=p();zn("id","click_",n,""),_(1),I("x",s.SPACE_SIZE*n)("y",s.SPACE_SIZE*i)("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),_(1),y("ngIf",t!==s.EMPTY)}}function Ypt(r,e){if(1&r&&(N(),S(0,"g"),T(1,Zpt,3,6,"g",4),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function Kpt(r,e){if(1&r&&(N(),F(0,"rect",9)),2&r){const t=p();I("x",t.SPACE_SIZE*t.last.get().x)("y",t.SPACE_SIZE*t.last.get().y)("width",t.SPACE_SIZE)("height",t.SPACE_SIZE)}}function Xpt(r,e){if(1&r&&(N(),F(0,"rect",10)),2&r){const t=e.$implicit,n=p();ye("id","victory_coord_",t.x,"_",t.y,""),I("x",n.SPACE_SIZE*t.x)("y",n.SPACE_SIZE*t.y)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}let Qpt=(()=>{var r;class e extends Fi{constructor(n){super(n),u(this,"EMPTY",K.NONE),u(this,"last",void 0),u(this,"victoryCoords",[]),this.rules=v4.get(),this.node=this.rules.getInitialNode(),this.availableAIs=[new qpt,new Kn($localize`MCTS`,new $C,this.rules)],this.encoder=rr.encoder,this.tutorial=(new l3e).tutorial}onClick(n){var i=this;return M(function*(){const s=yield i.canUserPlay("#click_"+n);if(s.isFailure())return i.cancelMove(s.getReason());const o=rr.of(n);return yield i.chooseMove(o)})()}updateBoard(n){var i=this;return M(function*(){const s=i.getState();i.victoryCoords=v4.getVictoriousCoords(s),i.board=s.board})()}showLastMove(n){var i=this;return M(function*(){const s=i.getState(),o=v4.getLowestUnoccupiedSpace(s.board,n.x)+1;i.last=g.of(new C(n.x,o))})()}hideLastMove(){this.last=g.empty()}getSquareFillClass(n,i){return[this.getPlayerClass(this.board[i][n])]}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(Ut))}),u(e,"\u0275cmp",qe({type:r,selectors:[["app-p4"]],features:[Qe],decls:4,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-4 -4 708 608","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base no-fill last-move-stroke mid-stroke",4,"ngIf"],["class","base no-fill victory-stroke mid-stroke",3,"id",4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base"],["class","base","pointer-events","fill",3,"ngClass",4,"ngIf"],["pointer-events","fill",1,"base",3,"ngClass"],[1,"base","no-fill","last-move-stroke","mid-stroke"],[1,"base","no-fill","victory-stroke","mid-stroke",3,"id"]],template:function(n,i){1&n&&(N(),S(0,"svg",0),T(1,Ypt,2,1,"g",1),T(2,Kpt,1,4,"rect",2),T(3,Xpt,1,6,"rect",3),P()),2&n&&(_(1),y("ngForOf",i.board),_(1),y("ngIf",i.last.isPresent()),_(1),y("ngForOf",i.victoryCoords))},dependencies:[Ft,Wt,At],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();class P1 extends W1{static getInitialState(){const e=Ie.createTable(P1.SIZE,P1.SIZE,K.NONE);return new P1(e,0)}static isOnBoard(e){return e.isInRange(P1.SIZE,P1.SIZE)}constructor(e,t){super(e,t),u(this,"neutralBlocks",void 0),this.neutralBlocks=this.getBlocksNeutralities()}getBlocksNeutralities(){const e=[];for(let t=0;t<4;t++)this.getBlockNeutrality(t)&&e.push(t);return e}getBlockNeutrality(e){const t=P1.getBlockCenter(e),n=this.getPieceAt(t.getNext(Me.UP,1)),i=this.getPieceAt(t.getNext(Me.UP_LEFT,1));return this.getPieceAt(t.getNext(Me.RIGHT,1))===n&&this.getPieceAt(t.getNext(Me.DOWN,1))===n&&this.getPieceAt(t.getNext(Me.LEFT,1))===n&&this.getPieceAt(t.getNext(Me.UP_RIGHT,1))===i&&this.getPieceAt(t.getNext(Me.DOWN_RIGHT,1))===i&&this.getPieceAt(t.getNext(Me.DOWN_LEFT,1))===i}static getBlockCenter(e){return new C(1+(e%2==0?0:3),1+(e<2?0:3))}applyLegalDrop(e){const t=this.getCopiedBoard();return t[e.coord.y][e.coord.x]=this.getCurrentPlayer(),new P1(t,this.turn)}applyLegalMove(e){const t=this.applyLegalDrop(e),n=t.getCopiedBoard();if(e.blockTurned.isPresent()){const s=P1.getBlockCenter(e.blockTurned.get()).toVector();if(e.turnedClockwise)for(const o of P1.ROTATION_MAP){const a=o[0].getNext(s),c=o[1].getNext(s),l=t.getPieceAt(a);n[c.y][c.x]=l}else for(const o of P1.ROTATION_MAP){const a=o[1].getNext(s),c=o[0].getNext(s),l=t.getPieceAt(a);n[c.y][c.x]=l}}return new P1(n,this.turn+1)}blockIsNeutral(e){return this.neutralBlocks.includes(e)}}var u3e;u(P1,"SIZE",6),u(P1,"ROTATION_MAP",[[new C(-1,-1),new C(1,-1)],[new C(0,-1),new C(1,0)],[new C(1,-1),new C(1,1)],[new C(1,0),new C(0,1)],[new C(1,1),new C(-1,1)],[new C(0,1),new C(-1,0)],[new C(-1,1),new C(-1,-1)],[new C(-1,0),new C(0,-1)]]);class jr extends br{static of(e,t,n){return new jr(e.x,e.y,t,n)}static withRotation(e,t,n,i){return U.assert(0<=n&&n<=3,"This block does not exist: "+n),new jr(e,t,g.of(n),i)}static rotationless(e,t){return new jr(e,t,g.empty())}constructor(e,t,n,i=!1){super(e,t),u(this,"blockTurned",void 0),u(this,"turnedClockwise",void 0),this.blockTurned=n,this.turnedClockwise=i,U.assert(P1.isOnBoard(this.coord),"The board is a "+P1.SIZE+" space wide square, invalid coord: "+this.coord.toString())}toString(){return this.blockTurned.isPresent()?"PentagoMove("+this.coord.toString()+", "+this.blockTurned.get()+", "+(this.turnedClockwise?"CLOCKWISE":"ANTI-CLOCKWISE")+")":"PentagoMove"+this.coord.toString()}equals(e){return!1!==this.coord.equals(e.coord)&&!1!==this.blockTurned.equals(e.blockTurned)&&this.turnedClockwise===e.turnedClockwise}}u3e=jr,u(jr,"encoder",we.tuple([C.encoder,g.getEncoder(we.identity()),we.identity()],r=>[r.coord,r.blockTurned,r.turnedClockwise],r=>u3e.of(r[0],r[1],r[2])));let f3e=(()=>{class r{}return u(r,"CANNOT_ROTATE_NEUTRAL_BLOCK",()=>$localize`If the quadrant to turn is neutral, please just use move without rotation.`),u(r,"MUST_CHOOSE_BLOCK_TO_ROTATE",()=>$localize`No quadrant is neutral, you must pick a quadrant to rotate.`),r})();class qc extends Yn{static get(){return qc.singleton.isAbsent()&&(qc.singleton=g.of(new qc)),qc.singleton.get()}constructor(){super(P1)}applyLegalMove(e,t,n){return t.applyLegalMove(e)}isLegal(e,t){if(t.getPieceAt(e.coord).isPlayer())return b.failure(Re.MUST_LAND_ON_EMPTY_SPACE());const n=t.applyLegalDrop(e);if(0===n.neutralBlocks.length){if(e.blockTurned.isAbsent())return b.failure(f3e.MUST_CHOOSE_BLOCK_TO_ROTATE())}else if(e.blockTurned.isPresent()){const i=e.blockTurned.get();if(n.neutralBlocks.includes(i))return b.failure(f3e.CANNOT_ROTATE_NEUTRAL_BLOCK())}return b.SUCCESS}getVictoryCoords(e){let t=[];for(const n of qc.VICTORY_SOURCE){const i=e.getPieceAt(n[0]),s=[n[0]];if(i.isPlayer()){let o=n[0].getNext(n[1]),a=!0;for(let c=0;c<3&&a;c++)e.getPieceAt(o)!==i?a=!1:(s.push(o),o=o.getNext(n[1]));if(a&&(e.getPieceAt(o)===i&&(s.push(o),t=t.concat(s)),n[2])){const c=n[0].getPrevious(n[1],1);e.getPieceAt(c)===i&&(s.push(c),t=t.concat(s))}}}return t}getGameStatus(e){const t=e.gameState,n=this.getVictoryCoords(t),i=[!1,!1];for(let s=0;s<n.length;s+=5)i[t.getPieceAt(n[s]).value]=!0;return!0===i[0]?!0===i[1]?_e.DRAW:_e.ZERO_WON:!0===i[1]?_e.ONE_WON:t.turn===P1.SIZE*P1.SIZE?_e.DRAW:_e.ONGOING}}u(qc,"singleton",g.empty()),u(qc,"VICTORY_SOURCE",[[new C(1,0),new St(1,1),!1],[new C(0,1),new St(1,1),!1],[new C(4,0),new St(-1,1),!1],[new C(5,1),new St(-1,1),!1],[new C(1,1),new St(1,1),!0],[new C(4,1),new St(-1,1),!0],[new C(0,1),new St(0,1),!0],[new C(1,1),new St(0,1),!0],[new C(2,1),new St(0,1),!0],[new C(3,1),new St(0,1),!0],[new C(4,1),new St(0,1),!0],[new C(5,1),new St(0,1),!0],[new C(1,0),new St(1,0),!0],[new C(1,1),new St(1,0),!0],[new C(1,2),new St(1,0),!0],[new C(1,3),new St(1,0),!0],[new C(1,4),new St(1,0),!0],[new C(1,5),new St(1,0),!0]]);const De=K.NONE,jc=K.ZERO,y4=K.ONE;class d3e{constructor(){u(this,"tutorial",[q.informational($localize`Initial board`,$localize`The initial Pentago board is made of 6x6 spaces, subdivided in 4 quadrants, which can each rotate.`,P1.getInitialState()),q.informational($localize`Goal of the game`,$localize`The goal at Pentago is to align 5 of your pieces. In the following board, Dark wins.`,new P1([[jc,De,De,jc,y4,De],[jc,y4,De,De,De,De],[jc,De,y4,De,De,De],[jc,De,De,De,De,y4],[jc,De,De,De,y4,De],[De,De,De,De,De,De]],10)).withPreviousMove(jr.withRotation(0,0,0,!1)),q.fromPredicate($localize`Simple move`,$localize`At their turn, players put a piece on the board and possibly rotate one quadrant.
        As long as there are neutral quadrants, i.e., quadrants that would not change after being rotated, a player may skip rotating a quadrant.
        To do this, you have to click on the crossed circle that appears at the center of the board when it is possible.<br/><br/>
        You're playing dark, do a simple move.`,new P1([[De,De,De,De,De,De],[De,jc,De,De,y4,De],[De,De,De,De,De,De],[De,De,De,De,De,De],[De,y4,De,De,jc,De],[De,De,De,De,De,De]],10),jr.rotationless(2,2),(e,t,n)=>e.blockTurned.isPresent()?b.failure($localize`You have made a move with a rotation. This tutorial step is about moves without rotations!`):b.SUCCESS,$localize`Congratulations!`),q.fromPredicate($localize`Move with rotation`,$localize`After putting a piece, arrows will appear on non-neutral quadrants.<br/><br/>
        You're playing Dark, place a piece on a quadrant and do a rotation!`,new P1([[De,De,De,De,De,De],[De,jc,De,De,y4,De],[De,De,De,De,De,De],[De,De,De,De,De,De],[De,y4,De,De,jc,De],[De,De,De,De,De,De]],10),jr.withRotation(0,0,0,!0),(e,t,n)=>e.blockTurned.isPresent()?b.SUCCESS:b.failure($localize`You made a move without rotation, try again!`),$localize`Congratulations! Note that if all quadrants are neutral after you have put your piece, there will be no rotation.`)])}}class qd extends Un{getListMoves(e){const t=[],n=e.gameState.neutralBlocks;if(0===e.gameState.turn)return qd.FIRST_TURN_MOVES;const i=this.getLegalDrops(e.gameState);for(const s of i){const o=jr.rotationless(s.x,s.y),a=e.gameState.applyLegalDrop(o),c=this.getLegalRotations(a,n);for(const f of c)t.push(jr.withRotation(s.x,s.y,f[0],f[1]));0===a.neutralBlocks.length==0&&t.push(o)}return t}getLegalDrops(e){const t=[];for(let n=0;n<P1.SIZE;n++)for(let i=0;i<P1.SIZE;i++){const s=new C(i,n);e.getPieceAt(s)===K.NONE&&t.push(s)}return t}getLegalRotations(e,t){const n=0===e.neutralBlocks.length,i=[];for(let s=0;s<4;s++)!1===e.blockIsNeutral(s)&&(t.includes(s)?n&&i.push([s,!0]):i.push([s,!0],[s,!1]));return i}}function Jpt(r,e){if(1&r){const t=pe();N(),S(0,"circle",12),W("click",function(){const s=te(t).$implicit,o=p().$implicit,a=p().index,c=p().index;return ne(p().onClick(3*a+s,3*c+o))}),P()}if(2&r){const t=e.$implicit,n=p().$implicit,i=p(),s=i.index,o=i.$implicit,a=p(),c=a.index,l=a.$implicit,f=p();ye("id","click_",3*s+t,"_",3*c+n,""),y("ngClass",f.getSquareClasses(3*s+t,3*c+n)),I("cx",o+2*f.STROKE_WIDTH+(t+.5)*f.SPACE_SIZE)("cy",l+2*f.STROKE_WIDTH+(n+.5)*f.SPACE_SIZE)("r",(f.SPACE_SIZE-f.STROKE_WIDTH)/2)}}u(qd,"FIRST_TURN_MOVES",[jr.rotationless(0,0),jr.rotationless(1,0),jr.rotationless(2,0),jr.rotationless(0,1),jr.rotationless(1,1),jr.rotationless(0,2)]);const h3e=function(){return[0,1,2]};function egt(r,e){1&r&&(N(),Gt(0),T(1,Jpt,1,6,"circle",11),Bt()),2&r&&(_(1),y("ngForOf",D1(1,h3e)))}function tgt(r,e){if(1&r&&(N(),Gt(0),F(1,"rect",10),T(2,egt,2,2,"ng-container",4),Bt()),2&r){const t=e.$implicit,n=e.index,i=p(),s=i.index,o=i.$implicit,a=p();_(1),y("ngClass",a.getBlockClasses(n,s)),I("x",a.STROKE_WIDTH+t)("y",a.STROKE_WIDTH+o)("rx",3*a.STROKE_WIDTH)("ry",3*a.STROKE_WIDTH)("width",a.BLOCK_WIDTH)("height",a.BLOCK_WIDTH),_(1),y("ngForOf",D1(8,h3e))}}const p3e=function(r){return[0,r]};function ngt(r,e){if(1&r&&(N(),Gt(0),T(1,tgt,3,9,"ng-container",4),Bt()),2&r){const t=p();_(1),y("ngForOf",_a(1,p3e,t.BLOCK_SEPARATION))}}function rgt(r,e){if(1&r&&(N(),F(0,"circle",13)),2&r){const t=p();ye("id","currentDrop_",t.currentDrop.get().x,"_",t.currentDrop.get().y,""),y("ngClass",t.getPlayerClass(t.getCurrentPlayer())),I("cx",t.getCenter(t.currentDrop.get().x))("cy",t.getCenter(t.currentDrop.get().y))("r",(t.SPACE_SIZE-t.STROKE_WIDTH)/2)}}function igt(r,e){if(1&r){const t=pe();N(),S(0,"path",14),W("click",function(){const s=te(t).$implicit;return ne(p().rotate(s))}),P()}if(2&r){const t=e.$implicit,n=p();ye("id","rotate_",t.blockIndex,"_",t.clockwise?"clockwise":"counterclockwise",""),I("d",t.path)("stroke-width",2*n.STROKE_WIDTH)}}function sgt(r,e){if(1&r&&(N(),F(0,"path",15)),2&r){const t=p();ye("id","last_rotation_",t.lastRotation.get().blockIndex,"_",t.lastRotation.get().clockwise?"clockwise":"counterclockwise",""),I("d",t.lastRotation.get().path)("stroke-width",2*t.STROKE_WIDTH)}}function ogt(r,e){if(1&r&&(N(),F(0,"circle",16)),2&r){const t=e.$implicit,n=p();ye("id","victoryCoord_",t.x,"_",t.y,""),y("ngClass",n.getSquareClasses(t.x,t.y)),I("cx",n.getCenter(t.x))("cy",n.getCenter(t.y))("r",(n.SPACE_SIZE-n.STROKE_WIDTH)/2)("stroke-width",n.STROKE_WIDTH)}}function agt(r,e){if(1&r){const t=pe();N(),S(0,"g",17),W("click",function(){return te(t),ne(p().skipRotation())}),F(1,"circle",18)(2,"line",19),P()}if(2&r){const t=p();_(1),I("cx",t.BLOCK_SEPARATION)("cy",t.BLOCK_SEPARATION)("r",.75*t.SPACE_SIZE)("stroke-width",2*t.STROKE_WIDTH),_(1),I("x1",t.BLOCK_SEPARATION-t.DIAGONAL_BAR_OFFSET)("y1",t.BLOCK_SEPARATION+t.DIAGONAL_BAR_OFFSET)("x2",t.BLOCK_SEPARATION+t.DIAGONAL_BAR_OFFSET)("y2",t.BLOCK_SEPARATION-t.DIAGONAL_BAR_OFFSET)("stroke-width",2*t.STROKE_WIDTH)}}let cgt=(()=>{var r;class e extends Fi{constructor(n){super(n),u(this,"BLOCK_WIDTH",void 0),u(this,"BLOCK_SEPARATION",void 0),u(this,"DIAGONAL_BAR_OFFSET",void 0),u(this,"arrows",[]),u(this,"victoryCoords",[]),u(this,"canSkipRotation",void 0),u(this,"currentDrop",g.empty()),u(this,"movedBlock",g.empty()),u(this,"lastDrop",g.empty()),u(this,"lastRotation",g.empty()),u(this,"ARROWS",void 0),this.rules=qc.get(),this.node=this.rules.getInitialNode(),this.availableAIs=[new on($localize`Dummy`,this.rules,new PL,new qd),new Kn($localize`MCTS`,new qd,this.rules)],this.encoder=jr.encoder,this.tutorial=(new d3e).tutorial,this.BLOCK_WIDTH=3*this.SPACE_SIZE+2*this.STROKE_WIDTH,this.BLOCK_SEPARATION=this.BLOCK_WIDTH+2*this.STROKE_WIDTH,this.DIAGONAL_BAR_OFFSET=.75*Math.cos(Math.PI/4)*this.SPACE_SIZE,this.ARROWS=this.generateArrowsCoord()}updateBoard(n){var i=this;return M(function*(){i.board=i.getState().getCopiedBoard(),i.victoryCoords=i.rules.getVictoryCoords(i.getState()),i.lastDrop=g.empty(),i.lastRotation=g.empty()})()}showLastMove(n){var i=this;return M(function*(){i.cancelMoveAttempt(),i.movedBlock=n.blockTurned;const s=new C(n.coord.x%3-1,n.coord.y%3-1);if(n.blockTurned.isPresent()&&(i.showLastRotation(n),!1===s.equals(new C(0,0))&&i.coordBelongToBlock(n)))return i.showLastDrop(n,s);i.lastDrop=g.of(n.coord)})()}showLastRotation(n){if(n.blockTurned.isPresent()){const i=n.blockTurned.get(),s=this.ARROWS.filter(o=>o.blockIndex===i&&o.clockwise===n.turnedClockwise)[0];this.lastRotation=g.of(s)}}showLastDrop(n,i){let s;s=n.turnedClockwise?U.getNonNullable(P1.ROTATION_MAP.find(f=>f[0].equals(i)))[1]:U.getNonNullable(P1.ROTATION_MAP.find(f=>f[1].equals(i)))[0];const o=n.blockTurned.get(),l=new C(o%2==0?1:4,o<2?1:4);s=s.getNext(l,1),this.lastDrop=g.of(s)}coordBelongToBlock(n){return n.blockTurned.equalsValue(2*(n.coord.y<3?0:1)+(n.coord.x<3?0:1))}hideLastMove(){this.lastDrop=g.empty(),this.movedBlock=g.empty(),this.lastRotation=g.empty(),this.victoryCoords=[]}generateArrowsCoord(){const n=2*this.BLOCK_SEPARATION,s=this.SPACE_SIZE,o=n-s,a=2*s,c=.5*this.SPACE_SIZE;return[{path:"M "+c+" 0 q  "+s+" -"+s+"  "+a+"  0",blockIndex:0,clockwise:!0},{path:"M 0 "+c+" q -"+s+"  "+s+"  0  "+a,blockIndex:0,clockwise:!1},{path:"M "+n+" "+c+" q  "+s+"  "+s+"  0  "+a,blockIndex:1,clockwise:!0},{path:"M "+o+" 0 q -"+s+" -"+s+" -"+a+"  0",blockIndex:1,clockwise:!1},{path:"M 0 "+o+" q -"+s+" -"+s+"  0 -"+a,blockIndex:2,clockwise:!0},{path:"M "+c+" "+n+" q  "+s+"  "+s+"  "+a+"  0",blockIndex:2,clockwise:!1},{path:"M "+o+" "+n+" q -"+s+"  "+s+" -"+a+"  0",blockIndex:3,clockwise:!0},{path:"M "+n+" "+o+" q  "+s+" -"+s+"  0 -"+a,blockIndex:3,clockwise:!1}]}cancelMoveAttempt(){this.arrows=[],this.currentDrop=g.empty(),this.canSkipRotation=!1}onClick(n,i){var s=this;return M(function*(){const o=yield s.canUserPlay("#click_"+n+"_"+i);if(o.isFailure())return s.cancelMove(o.getReason());if(s.hideLastMove(),s.board[i][n].isPlayer())return s.cancelMove(Re.MUST_LAND_ON_EMPTY_SPACE());const a=jr.rotationless(n,i),l=s.getState().applyLegalDrop(a);if(4===l.neutralBlocks.length)return s.chooseMove(a);const f=s.rules.getGameStatus(s.node);return s.canSkipRotation=l.neutralBlocks.length>0&&!1===f.isEndGame,s.currentDrop=g.of(new C(n,i)),s.displayArrows(l.neutralBlocks),b.SUCCESS})()}getCenter(n){return(n<3?0:this.BLOCK_SEPARATION)+2*this.STROKE_WIDTH+(n%3+.5)*this.SPACE_SIZE}displayArrows(n){this.arrows=[];for(let i=0;i<4;i++)if(!1===n.includes(i)){const s=this.ARROWS.filter(o=>o.blockIndex===i);this.arrows=this.arrows.concat(s)}}getBlockClasses(n,i){return this.movedBlock.equalsValue(n+2*i)?["last-move-stroke"]:[]}getSquareClasses(n,i){const s=[],o=this.getPlayerClass(this.board[i][n]);return s.push(o),this.lastDrop.equalsValue(new C(n,i))&&s.push("last-move-stroke"),s}rotate(n){var i=this;return M(function*(){const s=n.clockwise?"clockwise":"counterclockwise",o=yield i.canUserPlay("#rotate_"+n.blockIndex+"_"+s);if(o.isFailure())return i.cancelMove(o.getReason());const a=i.currentDrop.get(),c=jr.withRotation(a.x,a.y,n.blockIndex,n.clockwise);return i.chooseMove(c)})()}skipRotation(){var n=this;return M(function*(){const i=yield n.canUserPlay("#skipRotation");if(i.isFailure())return n.cancelMove(i.getReason());const s=n.currentDrop.get(),o=jr.rotationless(s.x,s.y);return n.chooseMove(o)})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(Ut))}),u(e,"\u0275cmp",qe({type:r,selectors:[["app-pentago"]],features:[Qe],decls:13,vars:8,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-60 -60 780 780"],["id","bluearrowhead","markerWidth","5","markerHeight","3.5","refX","2.5","refY","1.75","orient","auto","fill","blue"],["points","0 0, 5 1.75, 0 3.5"],["id","movedarrowhead","markerWidth","5","markerHeight","3.5","refX","2.5","refY","1.75","orient","auto",1,"last-move-fill"],[4,"ngFor","ngForOf"],["class","base","pointer-events","fill",3,"id","ngClass",4,"ngIf"],["class","no-fill","stroke","blue","marker-end","url(#bluearrowhead)",3,"id","click",4,"ngFor","ngForOf"],["class","no-fill last-move-stroke","marker-end","url(#movedarrowhead)",3,"id",4,"ngIf"],["class","base victory-stroke",3,"id","ngClass",4,"ngFor","ngForOf"],["id","skipRotation",3,"click",4,"ngIf"],[1,"base","no-fill",3,"ngClass"],["class","base","pointer-events","fill",3,"id","ngClass","click",4,"ngFor","ngForOf"],["pointer-events","fill",1,"base",3,"id","ngClass","click"],["pointer-events","fill",1,"base",3,"id","ngClass"],["stroke","blue","marker-end","url(#bluearrowhead)",1,"no-fill",3,"id","click"],["marker-end","url(#movedarrowhead)",1,"no-fill","last-move-stroke",3,"id"],[1,"base","victory-stroke",3,"id","ngClass"],["id","skipRotation",3,"click"],["stroke","red",1,"background"],["stroke","red"]],template:function(n,i){1&n&&(N(),S(0,"svg",0)(1,"defs")(2,"marker",1),F(3,"polygon",2),P()(),S(4,"defs")(5,"marker",3),F(6,"polygon",2),P()(),T(7,ngt,2,3,"ng-container",4),T(8,rgt,1,6,"circle",5),T(9,igt,1,4,"path",6),T(10,sgt,1,4,"path",7),T(11,ogt,1,7,"circle",8),T(12,agt,3,9,"g",9),P()),2&n&&(_(7),y("ngForOf",_a(6,p3e,i.BLOCK_SEPARATION)),_(1),y("ngIf",i.currentDrop.isPresent()),_(1),y("ngForOf",i.arrows),_(1),y("ngIf",i.lastRotation.isPresent()),_(1),y("ngForOf",i.victoryCoords),_(1),y("ngIf",i.canSkipRotation))},dependencies:[Ft,Wt,At],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})(),$a=(()=>{class r extends W1{static getInitialState(){const t=Ie.createTable(r.SIZE,r.SIZE,K.NONE);return t[9][9]=K.ONE,new r(t,[0,0],0)}constructor(t,n,i){super(t,i),u(this,"captures",void 0),this.captures=n}}return u(r,"SIZE",19),r})();class W2 extends br{static isOnBoard(e){return e.isInRange($a.SIZE,$a.SIZE)}static of(e){return U.assert(W2.isOnBoard(e),"PenteMove: coord is out of the board"),new W2(e.x,e.y)}constructor(e,t){super(e,t)}toString(){return`PenteMove(${this.coord.x}, ${this.coord.y})`}}u(W2,"encoder",br.getEncoder(W2.of));class vo extends Yn{static get(){return vo.singleton.isAbsent()&&(vo.singleton=g.of(new vo)),vo.singleton.get()}constructor(){super($a)}isLegal(e,t){return t.getPieceAt(e.coord).isPlayer()?b.failure(Re.MUST_CLICK_ON_EMPTY_SQUARE()):b.SUCCESS}applyLegalMove(e,t,n){const i=t.getCurrentPlayer(),s=t.getCopiedBoard();s[e.coord.y][e.coord.x]=i;const o=this.getCaptures(e.coord,t,i);for(const c of o)s[c.y][c.x]=K.NONE;const a=[t.captures[0],t.captures[1]];return a[i.value]+=o.length,new $a(s,a,t.turn+1)}getCaptures(e,t,n){const i=n.getOpponent(),s=[];for(const o of Me.factory.all){const a=e.getNext(o,1),c=e.getNext(o,2),l=e.getNext(o,3);W2.isOnBoard(a)&&t.getPieceAt(a)===i&&W2.isOnBoard(c)&&t.getPieceAt(c)===i&&W2.isOnBoard(l)&&t.getPieceAt(l)===n&&(s.push(a),s.push(c))}return s}getGameStatus(e){const t=e.gameState,n=t.getCurrentOpponent();return t.captures[n.value]>=10||vo.PENTE_HELPER.getVictoriousCoord(t).length>0?_e.getVictory(n):this.stillHaveEmptySquare(t)?_e.ONGOING:_e.DRAW}stillHaveEmptySquare(e){for(let t=0;t<$a.SIZE;t++)for(let n=0;n<$a.SIZE;n++)if(e.board[t][n]===K.NONE)return!0;return!1}}u(vo,"PENTE_HELPER",new fu(W2.isOnBoard,U.identity,5)),u(vo,"singleton",g.empty());const h=K.NONE,Zc=K.ZERO,Ga=K.ONE;class m3e extends Zn{constructor(...e){super(...e),u(this,"tutorial",[q.informational($localize`Initial board and object of the game`,$localize`Pente is played on a 19x19 board, on which the pieces are put on the intersections of the squares. The object of the game is to align 5 of your pieces, or to capture 10 pieces of your opponent. Initially, a piece of the second player is in the center location of the board.`,$a.getInitialState()),q.anyMove($localize`Dropping a piece`,$localize`At your turn, you must drop one piece on any empty space of the board. There is no other restriction.<br/><br/>You're playing Dark, put a piece on the board.`,$a.getInitialState(),W2.of(new C(9,8)),$localize`Congratulations!`),q.fromMove($localize`Capturing`,$localize`You can capture exactly two pieces of your opponent by sandwiching them between two of your pieces.<br/><br/>You're playing Light and you can capture, do it!`,new $a([[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,Zc,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,Ga,Zc,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,Ga,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h]],[0,0],3),[W2.of(new C(9,6))],$localize`Congratulations!`,$localize`Failed. Try again.`),q.fromMove($localize`Placing in a sandwich position`,$localize`You can safely place a piece next to another of your piece in what would look like a sandwich from the opponent's pieces. This is a safe move.<br/><br/>You're playing Light and have the opportunity to do such a move here, do it!`,new $a([[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,Ga,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,Ga,Zc,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,Ga,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h]],[0,0],4),[W2.of(new C(9,7))],$localize`Congratulations!`,$localize`Failed. Try again.`),q.fromMove($localize`Victory`,$localize`Remember, to win you can either align 5 or your pieces, or capture 10 pieces of your opponent. Here, as Light, you have already captured 8 pieces and you only need two more to win.<br/><br/>You're playing Light, you can win in two ways. Win!`,new $a([[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,Ga,h,h,Zc,Zc,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,Zc,h,Zc,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,Ga,Zc,Zc,Zc,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,Ga,Ga,Ga,Ga,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h]],[8,8],7),[W2.of(new C(9,6)),W2.of(new C(8,9)),W2.of(new C(13,9))],$localize`Congratulations!`,$localize`Failed. Try again.`)])}}class _3e extends Un{getListMoves(e){const n=[];return e.gameState.forEachCoord((i,s)=>{!1===s.isPlayer()&&n.push(W2.of(i))}),n}}class lgt extends wa{getBoardValue(e){return vo.PENTE_HELPER.getBoardValue(e.gameState)}}function ugt(r,e){if(1&r&&(N(),F(0,"circle",8)),2&r){const t=p().index,n=p().index,i=p();ye("id","piece_",t,"_",n,""),y("ngClass",i.getSpaceClass(t,n)),I("cx",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*t)("cy",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*n)("r",.22*i.SPACE_SIZE)}}function fgt(r,e){if(1&r&&(N(),F(0,"circle",12)),2&r){const t=p(2).index,n=p().index,i=p();ye("id","hoshi_",t,"_",n,""),I("cx",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*t)("cy",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*n)("r",.1*i.SPACE_SIZE)}}function dgt(r,e){if(1&r&&(N(),F(0,"rect",9)(1,"line",10)(2,"line",10),T(3,fgt,1,5,"circle",11)),2&r){const t=p().index,n=p().index,i=p();I("width",.5*i.SPACE_SIZE)("height",.5*i.SPACE_SIZE)("x",.5*i.SPACE_SIZE*t)("y",.5*i.SPACE_SIZE*n),_(1),I("x1",.5*i.SPACE_SIZE*t)("y1",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*n)("x2",.5*i.SPACE_SIZE+.5*i.SPACE_SIZE*t)("y2",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*n),_(1),I("x1",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*t)("y1",.5*i.SPACE_SIZE*n)("x2",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*t)("y2",.5*i.SPACE_SIZE+.5*i.SPACE_SIZE*n),_(1),y("ngIf",i.isHoshi(t,n))}}function hgt(r,e){if(1&r){const t=pe();N(),S(0,"g",5),W("click",function(){const s=te(t).index,o=p().index;return ne(p().onClick(s,o))}),T(1,ugt,1,6,"circle",6),T(2,dgt,4,13,"ng-template",null,7,un),P()}if(2&r){const t=e.$implicit,n=e.index,i=cn(3);ye("id","click_",n,"_",p().index,""),_(1),y("ngIf",t.isPlayer())("ngIfElse",i)}}function pgt(r,e){if(1&r&&(N(),S(0,"g"),T(1,hgt,4,4,"g",4),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function ggt(r,e){if(1&r){const t=pe();N(),S(0,"circle",13),W("click",function(){const s=te(t).$implicit;return ne(p().onClick(s.x,s.y))}),P()}if(2&r){const t=e.$implicit,n=p();ye("id","capture_",t.x,"_",t.y,""),I("cx",.25*n.SPACE_SIZE+.5*n.SPACE_SIZE*t.x)("cy",.25*n.SPACE_SIZE+.5*n.SPACE_SIZE*t.y)("r",.07*n.SPACE_SIZE)}}let mgt=(()=>{var r;class e extends IL{constructor(n){super(n),u(this,"lastMoved",g.empty()),u(this,"victoryCoords",[]),u(this,"captured",[]),this.scores=g.of([0,0]),this.rules=vo.get(),this.node=this.rules.getInitialNode(),this.encoder=W2.encoder,this.tutorial=(new m3e).tutorial,this.availableAIs=[new on($localize`Alignment`,this.rules,new lgt,new _3e),new Kn($localize`MCTS`,new _3e,this.rules)]}updateBoard(n){var i=this;return M(function*(){const s=i.getState();i.board=s.board,i.scores=g.of(i.getState().captures),i.victoryCoords=vo.PENTE_HELPER.getVictoriousCoord(s),i.createHoshis(),i.cancelMoveAttempt()})()}showLastMove(n){var i=this;return M(function*(){i.lastMoved=g.of(n.coord);const s=i.getCurrentOpponent();i.captured=vo.get().getCaptures(n.coord,i.getPreviousState(),s)})()}cancelMoveAttempt(){this.lastMoved=g.empty(),this.captured=[]}onClick(n,i){var s=this;return M(function*(){const o=yield s.canUserPlay("#click_"+n+"_"+i);if(o.isFailure())return s.cancelMove(o.getReason());const a=new C(n,i);return s.chooseMove(W2.of(a))})()}getSpaceClass(n,i){const s=new C(n,i),o=this.getState().getPieceAt(s),a=[];return a.push(this.getPlayerClass(o)),this.victoryCoords.some(c=>c.equals(s))&&a.push("victory-stroke"),this.lastMoved.equalsValue(s)&&a.push("last-move-stroke"),a}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(Ut))}),u(e,"\u0275cmp",qe({type:r,selectors:[["app-new-game"]],features:[Qe],decls:4,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["x","0","y","0",1,"base","mid-small-stroke"],[4,"ngFor","ngForOf"],["class","captured-fill",3,"id","click",4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["class","base mid-stroke",3,"id","ngClass",4,"ngIf","ngIfElse"],["empty",""],[1,"base","mid-stroke",3,"id","ngClass"],["fill-opacity","0",1,"base","no-stroke"],[1,"base","mid-stroke"],["class","base-no-stroke",3,"id",4,"ngIf"],[1,"base-no-stroke",3,"id"],[1,"captured-fill",3,"id","click"]],template:function(n,i){1&n&&(N(),S(0,"svg",0),F(1,"rect",1),T(2,pgt,2,1,"g",2),T(3,ggt,1,5,"circle",3),P()),2&n&&(I("viewBox","0 -3 "+i.board.length*i.SPACE_SIZE*.5+" "+(6+i.board.length*i.SPACE_SIZE*.5)),_(1),I("width",i.board.length*i.SPACE_SIZE*.5)("height",i.board.length*i.SPACE_SIZE*.5),_(1),y("ngForOf",i.board),_(1),y("ngForOf",i.captured))},dependencies:[Ft,Wt,At],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();class jd extends C{static getCoord3DEncoder(e){return we.tuple([we.identity(),we.identity(),we.identity()],t=>[t.x,t.y,t.z],t=>e(t[0],t[1],t[2]))}static of(e,t,n){return new jd(e,t,n)}constructor(e,t,n){super(e,t),u(this,"z",void 0),this.z=n}toString(){return"Coord3D"+this.toShortString()}toShortString(){return"("+this.x+", "+this.y+", "+this.z+")"}equals(e){return this===e||e.x===this.x&&e.y===this.y&&e.z===this.z}isHigherThan(e){return this.z>e.z}}var JL;class ln extends jd{static of(e,t,n){return new ln(e,t,n)}constructor(e,t,n){super(e,t,n),U.assert(0<=e&&e<=3,`PylosCoord: Invalid X: ${e}.`),U.assert(0<=t&&t<=3,`PylosCoord: Invalid Y: ${t}.`),U.assert(0<=n&&n<=3,`PylosCoord: Invalid Z: ${n}.`);const i=4-n;U.assert(this.isInRange(i,i),this.toString()+" is not in range.")}toString(){return"PylosCoord"+this.toShortString()}getLowerPieces(){if(0===this.z)throw new Error("PylosCoord: floor pieces don't have lower pieces.");const e=this.z-1;return[new ln(this.x,this.y,e),new ln(this.x+1,this.y,e),new ln(this.x,this.y+1,e),new ln(this.x+1,this.y+1,e)]}getHigherCoords(){if(3===this.z)throw new Error("Top piece don't have lower pieces.");const e=this.z+1,t=new C(this.x-1,this.y-1),n=new C(this.x,this.y-1),i=new C(this.x-1,this.y),s=new C(this.x,this.y),o=4-e;return[t,n,i,s].filter(a=>a.isInRange(o,o)).map(a=>new ln(a.x,a.y,e))}getNextValid(e){const t=new C(this.x,this.y).getNext(e),n=4-this.z;return t.isNotInRange(n,n)?g.empty():g.of(new ln(t.x,t.y,this.z))}}u(ln,"coordEncoder",jd.getCoord3DEncoder((JL=ln).of)),u(ln,"optionalEncoder",g.getEncoder(JL.coordEncoder));let Rl=(()=>{class r{}return u(r,"MUST_MOVE_UPWARD",()=>$localize`You must move your pieces upward.`),u(r,"SHOULD_HAVE_SUPPORTING_PIECES",()=>$localize`Your piece must land on the board or on 4 other pieces.`),u(r,"CANNOT_MOVE_SUPPORTING_PIECE",()=>$localize`You cannot move a supporting piece.`),u(r,"CANNOT_CAPTURE",()=>$localize`You cannot capture.`),u(r,"INVALID_FIRST_CAPTURE",()=>$localize`Your first capture is invalid.`),u(r,"INVALID_SECOND_CAPTURE",()=>$localize`Your second capture is invalid.`),r})();var v3e;let C3e=(()=>{class r{}return u(r,"MUST_CAPTURE_MAXIMUM_TWO_PIECES",()=>$localize`You must capture one or two pieces, not more.`),r})();class gr extends Di{static ofClimb(e,t,n){const i=g.of(e),s=gr.checkCaptures(n),o=new gr(i,t,s.firstCapture,s.secondCapture);return U.assert(t.isHigherThan(e),Rl.MUST_MOVE_UPWARD()),o}static checkCaptures(e){let t=g.empty(),n=g.empty();if(e.length>0&&(t=g.of(e[0]),e.length>1)){if(e[1].equals(e[0]))throw new Error("PylosMove: should not capture twice same piece.");if(n=g.of(e[1]),e[1].isHigherThan(e[0])&&(t=g.of(e[1]),n=g.of(e[0])),e.length>2)throw new Error(C3e.MUST_CAPTURE_MAXIMUM_TWO_PIECES())}return{firstCapture:t,secondCapture:n}}static ofDrop(e,t){const n=g.empty(),i=gr.checkCaptures(t);return new gr(n,e,i.firstCapture,i.secondCapture)}static changeCapture(e,t){const n=gr.checkCaptures(t);return new gr(e.startingCoord,e.landingCoord,n.firstCapture,n.secondCapture)}static of(e,t,n,i){return new gr(e,t,n,i)}constructor(e,t,n,i){super(),u(this,"startingCoord",void 0),u(this,"landingCoord",void 0),u(this,"firstCapture",void 0),u(this,"secondCapture",void 0),this.startingCoord=e,this.landingCoord=t,this.firstCapture=n,this.secondCapture=i}isClimb(){return this.startingCoord.isPresent()}toString(){const e=this.startingCoord.isAbsent()?"-":this.startingCoord.get().toShortString(),t=this.firstCapture.isAbsent()?"-":this.firstCapture.get().toShortString(),n=this.secondCapture.isAbsent()?"-":this.secondCapture.get().toShortString();return"PylosMove("+e+", "+this.landingCoord.toShortString()+", "+t+", "+n+")"}equals(e){return e===this||!(!1===this.startingCoord.equals(e.startingCoord)||!1===this.landingCoord.equals(e.landingCoord)||!1===this.firstCapture.equals(e.firstCapture)||!1===this.secondCapture.equals(e.secondCapture))}}v3e=gr,u(gr,"encoder",we.tuple([ln.optionalEncoder,ln.coordEncoder,ln.optionalEncoder,ln.optionalEncoder],r=>[r.startingCoord,r.landingCoord,r.firstCapture,r.secondCapture],r=>v3e.of(r[0],r[1],r[2],r[3])));class Ba extends Qv{static getInitialState(){const e=Ie.createTable(4,4,K.NONE),t=Ie.createTable(3,3,K.NONE),n=Ie.createTable(2,2,K.NONE);return new Ba([e,t,n,[[K.NONE]]],0)}static getLevelRange(e){switch(e){case 0:return[0,1,2,3];case 1:return[0,1,2];default:return U.expectToBe(e,2),[0,1]}}constructor(e,t){super(t),u(this,"boards",void 0),this.boards=e}getPieceAt(e){return this.boards[e.z][e.y][e.x]}applyLegalMove(e,t=!0){const n=[];let i;return n.push({coord:e.landingCoord,value:this.getCurrentPlayer()}),e.startingCoord.isPresent()&&n.push({coord:e.startingCoord.get(),value:K.NONE}),e.firstCapture.isPresent()&&n.push({coord:e.firstCapture.get(),value:K.NONE}),e.secondCapture.isPresent()&&n.push({coord:e.secondCapture.get(),value:K.NONE}),i=t?this.turn+1:this.turn,this.setBoardAtCoords(n,i)}setBoardAtCoords(e,t){const n=[Ie.copyBiArray(this.boards[0]),Ie.copyBiArray(this.boards[1]),Ie.copyBiArray(this.boards[2]),Ie.copyBiArray(this.boards[3])];for(const i of e){const s=i.coord;n[s.z][s.y][s.x]=i.value}return new Ba(n,t)}isLandable(e){if(this.getPieceAt(e).isPlayer())return!1;if(0===e.z)return!0;const t=e.getLowerPieces();for(const n of t)if(this.getPieceAt(n)===K.NONE)return!1;return!0}isSupporting(e){if(3===e.z)return!1;const t=e.getHigherCoords();for(const n of t)if(this.getPieceAt(n).isPlayer())return!0;return!1}getPiecesRepartition(){const e={};e[K.NONE.value]=0,e[k.ZERO.value]=0,e[k.ONE.value]=0;for(let t=0;t<3;t++)for(let n=0;n<4-t;n++)for(let i=0;i<4-t;i++){const s=new ln(i,n,t),o=this.getPieceAt(s);e[o.value]=1+e[o.value]}return e}removePieceAt(e){return this.setBoardAtCoords([{coord:e,value:K.NONE}],this.turn)}dropCurrentPlayersPieceAt(e){const t={coord:e,value:this.getCurrentPlayer()};return this.setBoardAtCoords([t],this.turn)}getFreeToMoves(){const e=[],t=this.getCurrentPlayer();for(let n=0;n<=2;n++){const i=Ba.getLevelRange(n);for(const s of i)for(const o of i){const a=new ln(o,s,n);this.getPieceAt(a).equals(t)&&!1===this.isSupporting(a)&&e.push(a)}}return e}}class M2 extends Yn{static get(){return M2.singleton.isAbsent()&&(M2.singleton=g.of(new M2)),M2.singleton.get()}constructor(){super(Ba)}static getStateInfo(e){const t=[],n=[];for(let i=0;i<3;i++)for(let s=0;s<4-i;s++)for(let o=0;o<4-i;o++){const a=new ln(o,s,i);e.getPieceAt(a)===e.getCurrentPlayer()&&!1===e.isSupporting(a)&&t.push(a),e.isLandable(a)&&n.push(a)}return{freeToMove:t,landable:n}}static getClimbingMoves(e){const t=[];for(const n of e.freeToMove)for(const i of e.landable)if(i.isHigherThan(n)&&!1===i.getLowerPieces().some(s=>n.equals(s))){const s=gr.ofClimb(n,i,[]);t.push(s)}return t}static getDropMoves(e){const t=[];for(const n of e.landable){const i=gr.ofDrop(n,[]);t.push(i)}return t}static canCapture(e,t){const n=e.getCurrentPlayer();for(const i of[ze.UP,ze.DOWN]){const s=t.getNextValid(i);if(s.isPresent()&&e.getPieceAt(s.get())===n)for(const o of[ze.LEFT,ze.RIGHT]){const a=s.get().getNextValid(o);if(a.isPresent()&&e.getPieceAt(a.get())===n){const c=i.getOpposite(),l=a.get().getNextValid(c).get();if(e.getPieceAt(l)===n)return!0}}}return!1}static getPossibleCaptures(e){const t=new dt,n=e.getFreeToMoves();for(const i of n){t.add(new dt([i]));const o=e.removePieceAt(i).getFreeToMoves();for(const a of o){const c=new dt([i,a]);t.add(c)}}return t}static applyLegalMove(e,t,n){return t.applyLegalMove(e)}static isValidCapture(e,t,n){const i=e.getCurrentPlayer();return(!1!==n.equals(t.landingCoord)||e.getPieceAt(n)===i)&&0===n.getHigherCoords().filter(o=>e.getPieceAt(o).isPlayer()&&!1===o.equals(t.firstCapture.get())).length}static getGameStatus(e){const n=e.gameState.getPiecesRepartition();return 15===n[k.ZERO.value]?_e.ONE_WON:15===n[k.ONE.value]?_e.ZERO_WON:_e.ONGOING}applyLegalMove(e,t,n){return M2.applyLegalMove(e,t,n)}isLegal(e,t){const n=this.isLegalStartingCoord(e,t);if(n.isFailure())return n.toOtherFallible();const i=n.get(),s=this.isLegalLandingCoord(e,i);if(s.isFailure())return s.toOtherFallible();const o=s.get(),a=this.isLegalCaptures(e,o);return a.isFailure()?a:b.SUCCESS}isLegalStartingCoord(e,t){const n=t.getCurrentOpponent();if(e.startingCoord.isPresent()){const i=e.startingCoord.get(),s=t.getPieceAt(i);if(s===n)return ie.failure(Re.CANNOT_CHOOSE_OPPONENT_PIECE());if(s===K.NONE)return ie.failure(Re.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(0===i.getHigherCoords().filter(a=>t.getPieceAt(a).isPlayer()).length){const a=t.removePieceAt(e.startingCoord.get());return ie.success(a)}return ie.failure(Rl.CANNOT_MOVE_SUPPORTING_PIECE())}return ie.success(t)}isLegalLandingCoord(e,t){return t.getPieceAt(e.landingCoord).isPlayer()?ie.failure(Re.MUST_LAND_ON_EMPTY_SPACE()):t.isLandable(e.landingCoord)?ie.success(t.dropCurrentPlayersPieceAt(e.landingCoord)):ie.failure(Rl.SHOULD_HAVE_SUPPORTING_PIECES())}isLegalCaptures(e,t){if(e.firstCapture.isAbsent())return b.SUCCESS;if(!1===M2.canCapture(t,e.landingCoord))return b.failure(Rl.CANNOT_CAPTURE());if(M2.isValidCapture(t,e,e.firstCapture.get())){const n=t.removePieceAt(e.firstCapture.get());return e.secondCapture.isAbsent()||M2.isValidCapture(n,e,e.secondCapture.get())?b.SUCCESS:b.failure(Rl.INVALID_SECOND_CAPTURE())}return b.failure(Rl.INVALID_FIRST_CAPTURE())}getGameStatus(e){return M2.getGameStatus(e)}}u(M2,"singleton",g.empty());const Ge=K.NONE,M4=K.ZERO,y3e=K.ONE;class M3e extends Zn{constructor(...e){super(...e),u(this,"tutorial",[q.informational($localize`Goal of the game`,$localize`At Pylos, the goal is to be the last to play.
        To do this, you have to save up your pieces.
        As soon as a player puts its last piece, that player loses the game immediately.
        Here is what the initial board looks like, it is a board of 4 x 4 squares.
        This board will become a pyramid, little by little.
        It will be filled by the pieces of your stock. Each player has 15 pieces.`,Ba.getInitialState()),q.anyMove($localize`Dropping a piece`,$localize`When it is your turn, you can always drop one of your piece on an empty square.
        The gray squares are where you can drop your pieces.<br/><br/>
        Click on one of the squares to drop a piece there.`,Ba.getInitialState(),gr.ofDrop(new ln(1,1,0),[]),$localize`There you go, as simple as that.`),q.fromMove($localize`Climbing`,$localize`When 4 pieces form a square, it is possible to put a fifth piece on top.
        However, when that happens, you can save a piece by climbing instead of dropping a piece.
        To climb:
        <ol>
            <li>Click on one of your free pieces, which should be lower than the landing square.</li>
            <li>Click on an empty landing square, higher than your selected piece.</li>
        </ol><br/>
        You're playing Dark, go ahead and climb!`,new Ba([[[M4,y3e,Ge,Ge],[y3e,M4,Ge,Ge],[Ge,Ge,Ge,Ge],[Ge,Ge,Ge,M4]],[[Ge,Ge,Ge],[Ge,Ge,Ge],[Ge,Ge,Ge]],[[Ge,Ge],[Ge,Ge]],[[Ge]]],0),[gr.ofClimb(new ln(3,3,0),new ln(0,0,1),[])],$localize`Congratulations!<br/>
        Some important notes:
        <ol>
            <li>You cannot move a piece that is directly below another one.</li>
            <li>Of course, you cannot move the opponent's pieces.</li>
            <li>You can only climb when the landing square is higher than the starting square.</li>
        </ol>`,$localize`Failed. Try again.`),q.fromMove($localize`Square (1/2)`,$localize`When the piece you just moved or dropped is the fourth one of a square of your color,
        you can choose anywhere on the board one or two of your pieces.
        These pieces will be removed from the board, allowing you to save up one or two pieces.
        A chosen piece must not be directly below another piece.
        A chosen piece can be the piece you just placed.<br/><br/>
        You're playing Dark. Form a square, click on one of the four pieces, then click on the V symbol on the bottom right to finalize your move.`,new Ba([[[M4,M4,Ge,Ge],[Ge,M4,Ge,Ge],[Ge,Ge,Ge,Ge],[Ge,Ge,Ge,Ge]],[[Ge,Ge,Ge],[Ge,Ge,Ge],[Ge,Ge,Ge]],[[Ge,Ge],[Ge,Ge]],[[Ge]]],0),[gr.ofDrop(new ln(0,1,0),[new ln(0,0,0)]),gr.ofDrop(new ln(0,1,0),[new ln(0,1,0)]),gr.ofDrop(new ln(0,1,0),[new ln(1,0,0)]),gr.ofDrop(new ln(0,1,0),[new ln(1,1,0)])],$localize`Congratulations, you have saved up one piece. Note, you can cancel your selection by clicking again on the piece.`,$localize`Failed. Try again.`),q.fromPredicate($localize`Square (2/2)`,$localize`You're playing Dark.<br/><br/>
        Do like in the previous step, but this time click on two different pieces before validating.`,new Ba([[[M4,M4,Ge,Ge],[Ge,M4,Ge,Ge],[Ge,Ge,Ge,Ge],[Ge,Ge,Ge,Ge]],[[Ge,Ge,Ge],[Ge,Ge,Ge],[Ge,Ge,Ge]],[[Ge,Ge],[Ge,Ge]],[[Ge]]],0),gr.ofDrop(new ln(0,1,0),[new ln(0,0,0),new ln(1,0,0)]),(t,n,i)=>t.secondCapture.isPresent()?b.SUCCESS:t.firstCapture.isPresent()?b.failure($localize`Failed, you only captured one piece.`):b.failure(o3e.YOU_DID_NOT_CAPTURE_ANY_PIECE()),$localize`Congratulations, you have saved up two pieces.`)])}}class E3e extends Un{getListMoves(e){const t=e.gameState,n=[],i=M2.getStateInfo(t),s=M2.getClimbingMoves(i),o=M2.getDropMoves(i),a=s.concat(o);for(const c of a){const l=t.applyLegalMove(c,!1);let f=new dt;M2.canCapture(l,c.landingCoord)?f=M2.getPossibleCaptures(l):n.push(c);for(const d of f){const m=gr.changeCapture(c,d.toList());n.push(m)}}return n}}class _gt extends E3e{getListMoves(e){const t=super.getListMoves(e);return this.orderMoves(t)}orderMoves(e){return e.sort((t,n)=>{const i=12*this.countStoneUsed(t),s=12*this.countStoneUsed(n);return i+this.sumMoveEmplacementByValue(t)-(s+this.sumMoveEmplacementByValue(n))})}countStoneUsed(e){let t=e.isClimb()?0:1;return e.firstCapture.isPresent()&&(t-=1,e.secondCapture.isPresent()&&(t-=1)),t}sumMoveEmplacementByValue(e){let t=e.landingCoord.z;return e.startingCoord.isPresent()&&(t+=3-e.startingCoord.get().z),e.firstCapture.isPresent()&&(t+=3-e.firstCapture.get().z,e.secondCapture.isPresent()&&(t+=3-e.secondCapture.get().z)),t}}class vgt extends fr{getMetrics(e){const t=e.gameState.getPiecesRepartition();return[t[k.ZERO.value],t[k.ONE.value]]}}function Cgt(r,e){if(1&r&&(N(),F(0,"circle",8)),2&r){const t=e.$implicit,n=p().$implicit,i=p();ye("id","piece_",n.value,"_",t,""),y("ngClass",i.getPlayerClass(n)),I("cx",i.SPACE_SIZE/4+t/15*(i.boardWidth-i.SPACE_SIZE/4))("cy",i.getPiecesCyForPlayer(n))("r",i.SPACE_SIZE/4-i.STROKE_WIDTH)}}function ygt(r,e){if(1&r&&(N(),S(0,"g"),T(1,Cgt,1,6,"circle",7),P()),2&r){const t=e.$implicit,n=p();_(1),y("ngForOf",n.getPlayerSidePieces(t))}}function Mgt(r,e){if(1&r){const t=pe();N(),S(0,"circle",12),W("click",function(){te(t);const i=p(2).$implicit,s=p().$implicit,o=p().$implicit;return ne(p().onPieceClick(i,s,o))}),P()}if(2&r){const t=p(2).$implicit,n=p().$implicit,i=p().$implicit,s=p();wi("id","piece_",t,"_",n,"_",i,""),y("ngClass",s.getPieceClasses(t,n,i)),I("r",s.getPieceRadius(i)-s.STROKE_WIDTH)("cx",s.getPieceCx(t,n,i))("cy",s.getPieceCy(t,n,i))}}function Egt(r,e){if(1&r){const t=pe();N(),S(0,"rect",12),W("click",function(){te(t);const i=p(3).$implicit,s=p().$implicit,o=p().$implicit;return ne(p().onDrop(i,s,o))}),P()}if(2&r){const t=p(3).$implicit,n=p().$implicit,i=p().$implicit,s=p();wi("id","drop_",t,"_",n,"_",i,""),y("ngClass",s.getSquareClasses(t,n,i)),I("width",2*s.getPieceRadius(i))("height",2*s.getPieceRadius(i))("x",s.getPieceCx(t,n,i)-s.getPieceRadius(i))("y",s.getPieceCy(t,n,i)-s.getPieceRadius(i))}}function Sgt(r,e){if(1&r&&(N(),T(0,Egt,1,8,"rect",13)),2&r){const t=p(2).$implicit,n=p().$implicit,i=p().$implicit;y("ngIf",p().mustDisplayLandingCoord(t,n,i))}}function Pgt(r,e){if(1&r&&(N(),Gt(0),T(1,Mgt,1,7,"circle",10),T(2,Sgt,1,1,"ng-template",null,11,un),Bt()),2&r){const t=cn(3),n=p().$implicit,i=p().$implicit,s=p().$implicit,o=p();_(1),y("ngIf",o.isOccupied(n,i,s))("ngIfElse",t)}}function Tgt(r,e){if(1&r&&(N(),S(0,"g"),T(1,Pgt,4,2,"ng-container",9),P()),2&r){const t=e.$implicit,n=p().$implicit,i=p().$implicit,s=p();_(1),y("ngIf",s.mustDraw(t,n,i))}}function Ogt(r,e){if(1&r&&(N(),S(0,"g"),T(1,Tgt,2,1,"g",1),P()),2&r){const t=p().$implicit,n=p();_(1),y("ngForOf",n.getLevelRange(t))}}function bgt(r,e){if(1&r&&(N(),S(0,"g"),T(1,Ogt,2,1,"g",1),P()),2&r){const t=e.$implicit,n=p();_(1),y("ngForOf",n.getLevelRange(t))}}function wgt(r,e){if(1&r&&(N(),F(0,"rect",14)),2&r){const t=p();wi("id","highCapture_",t.highCapture.get().x,"_",t.highCapture.get().y,"_",t.highCapture.get().z,""),I("width",2*t.getPieceRadius(t.highCapture.get().z))("height",2*t.getPieceRadius(t.highCapture.get().z))("x",t.getPieceCxByCoord(t.highCapture.get())-t.getPieceRadius(t.highCapture.get().z))("y",t.getPieceCyByCoord(t.highCapture.get())-t.getPieceRadius(t.highCapture.get().z))}}function Agt(r,e){if(1&r){const t=pe();N(),S(0,"g",15),W("click",function(){return te(t),ne(p().validateCapture())}),F(1,"circle",16)(2,"polygon",17),P()}if(2&r){const t=p();I("transform","translate("+4*t.SPACE_SIZE+" "+4*t.SPACE_SIZE+")"),_(1),y("ngClass",t.getCaptureValidationButtonClasses()),I("cx",t.STROKE_WIDTH/2)("cy",t.STROKE_WIDTH/2)("r",t.SPACE_SIZE/2)}}function Ngt(r,e){if(1&r){const t=pe();N(),S(0,"g",18),W("click",function(){const s=te(t).$implicit;return ne(p().onPieceClick(s.x,s.y,s.z))}),F(1,"line",19)(2,"line",19),P()}if(2&r){const t=e.$implicit,n=p();wi("id","capturable_",t.x,"_",t.y,"_",t.z,""),I("transform","translate("+n.getPieceCxByCoord(t)+" "+n.getPieceCyByCoord(t)+")"),_(1),I("x1",-.25*n.getPieceRadius(t.z))("y1",-.25*n.getPieceRadius(t.z))("x2",.25*n.getPieceRadius(t.z))("y2",.25*n.getPieceRadius(t.z)),_(1),I("x1",.25*n.getPieceRadius(t.z))("y1",-.25*n.getPieceRadius(t.z))("x2",-.25*n.getPieceRadius(t.z))("y2",.25*n.getPieceRadius(t.z))}}const Igt=function(){return[0,1,2]};let kgt=(()=>{var r;class e extends El{constructor(n){super(n),u(this,"boardWidth",4*this.SPACE_SIZE+this.STROKE_WIDTH),u(this,"pieceRowHeight",this.SPACE_SIZE/2),u(this,"boardHeight",this.boardWidth+2*this.pieceRowHeight),u(this,"state",void 0),u(this,"constructedState",void 0),u(this,"lastLandingCoord",g.empty()),u(this,"lastStartingCoord",g.empty()),u(this,"lastFirstCapture",g.empty()),u(this,"lastSecondCapture",g.empty()),u(this,"highCapture",g.empty()),u(this,"capturables",[]),u(this,"chosenStartingCoord",g.empty()),u(this,"chosenLandingCoord",g.empty()),u(this,"chosenFirstCapture",g.empty()),u(this,"chosenSecondCapture",g.empty()),u(this,"lastMove",g.empty()),u(this,"remainingPieces",{0:15,1:15}),this.hasAsymmetricBoard=!0,this.rules=M2.get(),this.node=this.rules.getInitialNode(),this.availableAIs=[new on($localize`Minimax`,this.rules,new vgt,new _gt),new Kn($localize`MCTS`,new E3e,this.rules)],this.encoder=gr.encoder,this.tutorial=(new M3e).tutorial}getPiecesCyForPlayer(n){return n===k.ONE?this.pieceRowHeight/2:this.boardWidth+1.5*this.pieceRowHeight}getLevelRange(n){return Ba.getLevelRange(n)}mustDraw(n,i,s){const o=new ln(n,i,s);return!!(this.constructedState.getPieceAt(o).isPlayer()||this.justClimbed(o)||this.isCaptured(o))||this.chosenLandingCoord.isAbsent()&&this.constructedState.isLandable(o)}isCaptured(n){return this.chosenFirstCapture.equalsValue(n)||this.chosenSecondCapture.equalsValue(n)}onPieceClick(n,i,s){var o=this;return M(function*(){const a=yield o.canUserPlay("#piece_"+n+"_"+i+"_"+s);if(a.isFailure())return o.cancelMove(a.getReason());const c=new ln(n,i,s);return o.state.getPieceAt(c)===o.state.getCurrentOpponent()?o.cancelMove(Re.CANNOT_CHOOSE_OPPONENT_PIECE()):o.chosenStartingCoord.equalsValue(c)?(o.cancelMoveAttempt(),b.SUCCESS):o.chosenLandingCoord.isPresent()?o.isSupporting(c,o.constructedState)?o.cancelMove(Rl.CANNOT_MOVE_SUPPORTING_PIECE()):o.onCaptureClick(c):o.isSupporting(c,o.getState())?o.cancelMove(Rl.CANNOT_MOVE_SUPPORTING_PIECE()):o.onClimbClick(c)})()}isSupporting(n,i){return i.isSupporting(n)}onClimbClick(n){var i=this;return M(function*(){return i.chosenStartingCoord=g.of(n),i.constructedState=i.constructedState.removePieceAt(n),b.SUCCESS})()}onCaptureClick(n){var i=this;return M(function*(){return i.chosenFirstCapture.equalsValue(n)?(i.chosenFirstCapture=g.empty(),i.constructedState=i.constructedState.dropCurrentPlayersPieceAt(n),i.updateCapturableList(),b.SUCCESS):i.chosenSecondCapture.equalsValue(n)?(i.chosenSecondCapture=g.empty(),i.constructedState=i.constructedState.dropCurrentPlayersPieceAt(n),i.updateCapturableList(),b.SUCCESS):i.chosenFirstCapture.isAbsent()?(i.chosenFirstCapture=g.of(n),i.constructedState=i.constructedState.removePieceAt(n),i.updateCapturableList(),b.SUCCESS):i.chosenSecondCapture.isAbsent()?(i.chosenSecondCapture=g.of(n),i.constructedState=i.constructedState.removePieceAt(n),i.updateCapturableList(),b.SUCCESS):i.cancelMove(C3e.MUST_CAPTURE_MAXIMUM_TWO_PIECES())})()}updateCapturableList(){this.capturables=this.constructedState.getFreeToMoves()}getCaptureValidationButtonClasses(){return this.chosenFirstCapture.isPresent()||this.chosenSecondCapture.isPresent()?"":"semi-transparent"}validateCapture(){var n=this;return M(function*(){const i=yield n.canUserPlay("#capture_validation");return i.isFailure()?n.cancelMove(i.getReason()):n.chosenFirstCapture.isAbsent()&&n.chosenSecondCapture.isAbsent()?b.SUCCESS:n.chosenFirstCapture.isPresent()&&n.chosenSecondCapture.isAbsent()?n.concludeMoveWithCapture([n.chosenFirstCapture.get()]):n.chosenFirstCapture.isAbsent()&&n.chosenSecondCapture.isPresent()?n.concludeMoveWithCapture([n.chosenSecondCapture.get()]):n.concludeMoveWithCapture([n.chosenFirstCapture.get(),n.chosenSecondCapture.get()])})()}concludeMoveWithCapture(n){var i=this;return M(function*(){if(i.chosenStartingCoord.isAbsent()){const s=gr.ofDrop(i.chosenLandingCoord.get(),n);return i.chooseMove(s)}{const s=gr.ofClimb(i.chosenStartingCoord.get(),i.chosenLandingCoord.get(),n);return i.chooseMove(s)}})()}cancelMoveAttempt(){this.constructedState=this.state,this.chosenStartingCoord=g.empty(),this.chosenLandingCoord=g.empty(),this.chosenFirstCapture=g.empty(),this.chosenSecondCapture=g.empty(),this.capturables=[]}onDrop(n,i,s){var o=this;return M(function*(){const a=yield o.canUserPlay("#drop_"+n+"_"+i+"_"+s);if(a.isFailure())return o.cancelMove(a.getReason());const c=new ln(n,i,s);return M2.canCapture(o.constructedState,c)?(o.chosenLandingCoord=g.of(c),o.constructedState=o.constructedState.dropCurrentPlayersPieceAt(c),o.updateCapturableList(),b.SUCCESS):(o.chosenLandingCoord=g.of(c),o.concludeMoveWithCapture([]))})()}getSquareClasses(n,i,s){const o=new ln(n,i,s);if(this.lastMove.isPresent()){const a=this.lastMove.get();if(a.firstCapture.equalsValue(o)||a.secondCapture.equalsValue(o))return["captured-fill"];if(o.equals(a.landingCoord)||a.startingCoord.equalsValue(o))return["moved-fill"]}else if(this.justClimbed(o))return["moved-fill"];return[]}justClimbed(n){return this.chosenLandingCoord.isPresent()&&this.chosenStartingCoord.equalsValue(n)}getPieceRadius(n){return this.SPACE_SIZE*(.45+.025*n)}getPieceCx(n,i,s){return this.SPACE_SIZE/2+.5*s*this.SPACE_SIZE+n*this.SPACE_SIZE}getPieceCy(n,i,s){return this.SPACE_SIZE/2+.5*s*this.SPACE_SIZE+i*this.SPACE_SIZE}getPieceCxByCoord(n){return this.getPieceCx(n.x,n.y,n.z)}getPieceCyByCoord(n){return this.getPieceCy(n.x,n.y,n.z)}isOccupied(n,i,s){const o=new ln(n,i,s);if(this.justClimbed(o))return!1;const a=this.getState().getPieceAt(o).isPlayer(),c=this.chosenLandingCoord.equalsValue(o);return a||c}getPieceClasses(n,i,s){const o=new ln(n,i,s),a=[this.getPieceFillClass(o)];return(this.lastLandingCoord.equalsValue(o)||this.lastStartingCoord.equalsValue(o))&&a.push("last-move-stroke"),(this.chosenStartingCoord.equalsValue(o)||this.chosenLandingCoord.equalsValue(o))&&a.push("selected-stroke"),this.isCaptured(o)&&a.push("pre-captured-fill"),a}getPieceFillClass(n){return this.chosenLandingCoord.equalsValue(n)?this.getPlayerClass(this.state.getCurrentPlayer()):this.getPlayerClass(this.state.getPieceAt(n))}getPlayerSidePieces(n){const i=this.remainingPieces[n.value],s=[];for(let o=0;o<i;o++)s.push(o);return s}updateBoard(n){var i=this;return M(function*(){i.state=i.getState(),i.constructedState=i.state,i.lastMove=i.node.previousMove;const s=i.state.getPiecesRepartition();i.remainingPieces={0:15-s[0],1:15-s[1]},i.highCapture=g.empty(),i.cancelMoveAttempt(),i.hideLastMove()})()}showLastMove(n){var i=this;return M(function*(){i.lastLandingCoord=g.of(n.landingCoord),i.lastStartingCoord=n.startingCoord,i.lastFirstCapture=n.firstCapture,i.lastSecondCapture=n.secondCapture,i.lastFirstCapture.isPresent()&&!1===i.mustDrawCoord(i.lastFirstCapture.get())&&(i.highCapture=i.lastFirstCapture)})()}hideLastMove(){this.lastStartingCoord=g.empty(),this.lastLandingCoord=g.empty(),this.lastFirstCapture=g.empty(),this.lastSecondCapture=g.empty()}mustDrawCoord(n){return this.mustDraw(n.x,n.y,n.z)}mustDisplayLandingCoord(n,i,s){return!this.chosenStartingCoord.isPresent()||!!this.chosenStartingCoord.get().equals(new ln(n,i,s))||this.chosenStartingCoord.get().z<s}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(Ut))}),u(e,"\u0275cmp",qe({type:r,selectors:[["app-pylos"]],features:[Qe],decls:10,vars:11,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["boardInItself",""],["x","0","y","0",1,"base","small-stroke"],["class","base captured-fill small-stroke",3,"id",4,"ngIf"],["id","capture_validation",3,"click",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],["class","base small-stroke",3,"id","ngClass",4,"ngFor","ngForOf"],[1,"base","small-stroke",3,"id","ngClass"],[4,"ngIf"],["class","base small-stroke",3,"id","ngClass","click",4,"ngIf","ngIfElse"],["onlyRect",""],[1,"base","small-stroke",3,"id","ngClass","click"],["class","base small-stroke",3,"id","ngClass","click",4,"ngIf"],[1,"base","captured-fill","small-stroke",3,"id"],["id","capture_validation",3,"click"],["fill","red",1,"base-no-fill","small-stroke",3,"ngClass"],["points","-32.5,-2.5 -32.5,12.5 -10,35 -2.5,35 35,-21.25 25,-21.275 -5,25 -32.5,-2.5","fill","green",1,"base-no-fill","small-stroke"],[3,"id","click"],["stroke-width","8","stroke","red"]],template:function(n,i){1&n&&(N(),S(0,"svg",0)(1,"g"),T(2,ygt,2,1,"g",1),P(),S(3,"g",null,2),F(5,"rect",3),T(6,bgt,2,1,"g",1),T(7,wgt,1,7,"rect",4),T(8,Agt,3,5,"g",5),T(9,Ngt,3,12,"g",6),P()()),2&n&&(I("viewBox","0 0 "+i.boardWidth+" "+i.boardHeight),_(1),I("transform","rotate("+180*i.role.value+" "+i.boardWidth/2+" "+i.boardHeight/2+")"),_(1),y("ngForOf",i.Player.PLAYERS),_(1),I("transform","translate("+i.STROKE_WIDTH/2+" "+(i.STROKE_WIDTH/2+i.pieceRowHeight)+")"),_(2),I("width",4*i.SPACE_SIZE)("height",4*i.SPACE_SIZE),_(1),y("ngForOf",D1(10,Igt)),_(1),y("ngIf",i.highCapture.isPresent()),_(1),y("ngIf",i.chosenLandingCoord.isPresent()),_(1),y("ngForOf",i.capturables))},dependencies:[Ft,Wt,At],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();var In,S3e;class yt{static ofInt(e){if(0<=e&&e<=15)return yt.pieces[e];if(16===e)return yt.EMPTY;throw new Error("Invalid piece ("+e+")")}constructor(e){u(this,"value",void 0),this.value=e}equals(e){return this===e}toString(){return"QuartoPiece("+this.value+")"}isRectangle(){return this.value%4<2}}u(yt,"AAAA",new(In=yt)(0)),u(yt,"AAAB",new In(1)),u(yt,"AABA",new In(2)),u(yt,"AABB",new In(3)),u(yt,"ABAA",new In(4)),u(yt,"ABAB",new In(5)),u(yt,"ABBA",new In(6)),u(yt,"ABBB",new In(7)),u(yt,"BAAA",new In(8)),u(yt,"BAAB",new In(9)),u(yt,"BABA",new In(10)),u(yt,"BABB",new In(11)),u(yt,"BBAA",new In(12)),u(yt,"BBAB",new In(13)),u(yt,"BBBA",new In(14)),u(yt,"BBBB",new In(15)),u(yt,"EMPTY",new In(16)),u(yt,"pieces",[In.AAAA,In.AAAB,In.AABA,In.AABB,In.ABAA,In.ABAB,In.ABBA,In.ABBB,In.BAAA,In.BAAB,In.BABA,In.BABB,In.BBAA,In.BBAB,In.BBBA,In.BBBB]),u(yt,"encoder",we.fromFunctions(r=>r.value,In.ofInt));class Yc extends br{constructor(e,t,n){super(e,t),u(this,"piece",void 0),this.piece=n}toString(){return"QuartoMove("+this.coord.x+", "+this.coord.y+", "+this.piece.value+")"}equals(e){return this===e||!1!==e.coord.equals(this.coord)&&this.piece===e.piece}}S3e=Yc,u(Yc,"encoder",we.tuple([C.encoder,yt.encoder],r=>[r.coord,r.piece],r=>new S3e(r[0].x,r[0].y,r[1])));class Ua extends W1{constructor(e,t,n){super(e,t),u(this,"pieceInHand",void 0),this.pieceInHand=n}static getInitialState(){const e=Ie.createTable(4,4,yt.EMPTY);return new Ua(e,0,yt.AAAA)}static isGivable(e,t,n){return e!==n&&!1===Ua.isAlreadyOnBoard(e,t)}static isAlreadyOnBoard(e,t){for(let n=0;n<4;n++)for(let i=0;i<4;i++)if(t[n][i]===e)return!0;return!1}getRemainingPieces(){const e=yt.pieces,t=[];for(const n of e)Ua.isGivable(n,this.board,this.pieceInHand)&&t.push(n);return t}}var o1=function(r){return r.VICTORY="VICTORY",r.PRE_VICTORY="PRE_VICTORY",r.DEFAULT="DEFAULT",r}(o1||{});let eR=(()=>{class r{}return u(r,"MUST_GIVE_A_PIECE",()=>$localize`You must give a piece.`),u(r,"PIECE_ALREADY_ON_BOARD",()=>$localize`That piece is already on the board.`),u(r,"CANNOT_GIVE_PIECE_IN_HAND",()=>$localize`You cannot give the piece that was in your hands.`),r})();class Zd{constructor(e){u(this,"subCriterion",[g.empty(),g.empty(),g.empty(),g.empty()]),this.subCriterion[0]=g.of(8==(8&e.value)),this.subCriterion[1]=g.of(4==(4&e.value)),this.subCriterion[2]=g.of(2==(2&e.value)),this.subCriterion[3]=g.of(1==(1&e.value))}mergeWith(e){let t=4;for(let n=0;n<4;n++)!1===this.subCriterion[n].equals(e.subCriterion[n])&&(this.subCriterion[n]=g.empty()),this.subCriterion[n].isAbsent()&&t--;return t>0}mergeWithQuartoPiece(e){const t=new Zd(e);return this.mergeWith(t)}areAllAbsent(){for(let e=0;e<4;e++)if(this.subCriterion[e].isPresent())return!1;return!0}match(e){for(let t=0;t<4;t++)if(this.subCriterion[t].equals(e.subCriterion[t]))return!0;return!1}matchPiece(e){return this.match(new Zd(e))}toString(){return"Criterion{"+this.subCriterion.map(e=>e.isPresent()?e.get()?"1":"0":"x").join(" ")+"}"}}class Kc{constructor(e,t){u(this,"initialCoord",void 0),u(this,"direction",void 0),this.initialCoord=e,this.direction=t}allCoords(){const e=[];for(let t=0;t<4;t++)e.push(this.initialCoord.getNext(this.direction,t));return e}}class kr extends Yn{static get(){return kr.singleton.isAbsent()&&(kr.singleton=g.of(new kr)),kr.singleton.get()}constructor(){super(Ua)}static isOccupied(e){return e!==yt.EMPTY}static isLegal(e,t){const n=e.coord.x,i=e.coord.y,s=e.piece,o=t.getCopiedBoard(),a=t.pieceInHand;return kr.isOccupied(o[i][n])?b.failure(Re.MUST_LAND_ON_EMPTY_SPACE()):s===yt.EMPTY?15===t.turn?b.SUCCESS:b.failure(eR.MUST_GIVE_A_PIECE()):Ua.isAlreadyOnBoard(s,o)?b.failure(eR.PIECE_ALREADY_ON_BOARD()):a===s?b.failure(eR.CANNOT_GIVE_PIECE_IN_HAND()):b.SUCCESS}isLegal(e,t){return kr.isLegal(e,t)}applyLegalMove(e,t,n){const i=t.getCopiedBoard();return i[e.coord.y][e.coord.x]=t.pieceInHand,new Ua(i,t.turn+1,e.piece)}static updateBoardStatus(e,t,n){return n.score===o1.PRE_VICTORY?this.isThereAVictoriousLine(e,t)?{score:o1.VICTORY,sensitiveSquares:new q1}:n:this.searchForVictoryOrPreVictoryInLine(e,t,n)}static isThereAVictoriousLine(e,t){let n=e.initialCoord,i=t.getPieceAt(n);const s=new Zd(i);for(let o=0;o<3&&!1!==kr.isOccupied(i)&&!s.areAllAbsent();o++)n=n.getNext(e.direction,1),i=t.getPieceAt(n),s.mergeWithQuartoPiece(i);return!(!kr.isOccupied(i)||!1!==s.areAllAbsent())}static searchForVictoryOrPreVictoryInLine(e,t,n){const i=kr.getLineInfos(e,t,n);if(i.boardStatus.isPresent())return i.boardStatus.get();const s=i.commonCriterion,o=i.sensitiveCoord;if(s.isPresent()&&!1===s.get().areAllAbsent()){if(o.isAbsent())return{score:o1.VICTORY,sensitiveSquares:new q1};{s.get().matchPiece(t.pieceInHand)&&(n.score=o1.PRE_VICTORY);const a=o.get();n.sensitiveSquares.add(a)}}return n}static getLineInfos(e,t,n){let i=g.empty(),s=g.empty(),o=e.initialCoord;for(let a=0;a<4;a++){const c=t.getPieceAt(o);if(c===yt.EMPTY){if(!i.isAbsent())return{sensitiveCoord:g.of(o),commonCriterion:s,boardStatus:g.of(n)};i=g.of(o)}else s.isAbsent()?(s=g.of(new Zd(c)),Ne.display("QuartoRules","getLineInfos","set commonCrit to "+s.toString())):(s.get().mergeWithQuartoPiece(c),Ne.display("QuartoRules","getLineInfos","update commonCrit: "+s.toString()));o=o.getNext(e.direction,1)}return{commonCriterion:s,sensitiveCoord:i,boardStatus:g.empty()}}static scoreToGameStatus(e,t){const n=k.of(t%2);return e===o1.VICTORY?_e.getDefeat(n):16===t?_e.DRAW:_e.ONGOING}getGameStatus(e){const t=e.gameState;let n={score:o1.DEFAULT,sensitiveSquares:new q1};for(const i of kr.lines)if(n=kr.updateBoardStatus(i,t,n),n.score===o1.VICTORY)return kr.scoreToGameStatus(n.score,t.turn);return kr.scoreToGameStatus(n.score,t.turn)}getVictoriousCoords(e){for(const t of kr.lines)if(kr.isThereAVictoriousLine(t,e))return t.allCoords();return[]}}u(kr,"singleton",g.empty()),u(kr,"lines",[new Kc(new C(0,0),Me.DOWN),new Kc(new C(1,0),Me.DOWN),new Kc(new C(2,0),Me.DOWN),new Kc(new C(3,0),Me.DOWN),new Kc(new C(0,0),Me.RIGHT),new Kc(new C(0,1),Me.RIGHT),new Kc(new C(0,2),Me.RIGHT),new Kc(new C(0,3),Me.RIGHT),new Kc(new C(0,0),Me.DOWN_RIGHT),new Kc(new C(0,3),Me.UP_RIGHT)]);const xgt=yt.AABA,Lgt=yt.AABB,P3e=yt.ABAA,Rgt=yt.ABAB,zgt=yt.ABBA,T3e=yt.BAAA,Dgt=yt.BAAB,Hgt=yt.BABB,O3e=yt.BBAA,Vgt=yt.BBAB,tR=yt.BBBA,Fgt=yt.BBBB,e1=yt.EMPTY;class b3e extends Zn{constructor(...e){super(...e),u(this,"tutorial",[q.informational($localize`Goal of the game`,$localize`Quarto is an alignment game.
        The goal is to align four pieces that have at least one common aspect:
        <ul>
          <li>their color (light or dark),</li>
          <li>their size (big or small),</li>
          <li>their pattern (empty or dotted),</li>
          <li>their shape (round or square).</li>
        </ul>
        Here, we have a board with a victory by an alignment of dark pieces.
        Note that the pieces are not owned by any player.`,new Ua([[tR,O3e,P3e,xgt],[e1,e1,e1,e1],[e1,e1,e1,e1],[e1,e1,e1,e1]],7,yt.ABAB)),q.anyMove($localize`Placement`,$localize`Every placement occurs in two steps: placing the piece you have in hand (in the small square) on a square of the board,
        and picking a piece that the opponent will have to place, by clicking on one of the pieces inside the dotted square.
        If you prefer, the order of these two steps can be reversed.
        Keep in mind that the second click confirms the move.<br/><br/>
        Make a move.`,new Ua([[tR,Lgt,zgt,e1],[e1,e1,e1,e1],[e1,T3e,e1,e1],[e1,e1,e1,e1]],7,yt.ABAA),new Yc(2,2,yt.BAAB),$localize`Perfect!`),q.fromMove($localize`Situation`,$localize`We have here a tricky situation.<br/><br/>
        Analyze the board and play your move, carefully paying attention not to let the opponent win on the next move.`,new Ua([[Fgt,tR,Vgt,e1],[P3e,Hgt,O3e,e1],[Rgt,T3e,Dgt,e1],[e1,e1,e1,e1]],7,yt.AABA),[new Yc(3,3,yt.AABB)],$localize`Well done!`,$localize`Failed! Your opponent can either align:<ul><li>the squares horizontally on the third line or vertically on the third column,</li><li>small pieces horizontally on the first line or vertically on the second or third column,</li><li>empty pieces horizontally on the first line or vertically on the first column,</li><li>clear pieces diagonally.</li></ul>`)])}}class $gt extends wa{scoreToBoardValue(e,t){if(e===o1.DEFAULT)return new Jn(0);{U.assert(e===o1.PRE_VICTORY,"QuartoHeuristic score can only be pre-victory or default");const n=k.of(t%2);return new Jn(n.getPreVictory())}}getBoardValue(e){const t=e.gameState;let n={score:o1.DEFAULT,sensitiveSquares:new q1};for(const i of kr.lines)n=kr.updateBoardStatus(i,t,n);return this.scoreToBoardValue(n.score,t.turn)}}class w3e extends Un{getListMoves(e){const t=[],n=e.gameState,i=n.getCopiedBoard(),s=n.getRemainingPieces(),o=n.pieceInHand;let a;for(let c=0;c<4;c++)for(let l=0;l<4;l++)if(i[c][l]===yt.EMPTY){if(a=n.getCopiedBoard(),a[c][l]=o,15===n.turn){const f=new Yc(l,c,yt.EMPTY);return t.push(f),t}for(const f of s){const d=new Yc(l,c,f);t.push(d)}}return t}}function Ggt(r,e){if(1&r&&(N(),F(0,"rect",12)),2&r){const t=p(2),n=t.$implicit,i=t.index,s=p().index,o=p();y("ngClass",o.getPieceClasses(n.value)),I("x",o.SPACE_SIZE*i+(o.SPACE_SIZE/2-o.getPieceSize(n.value)))("y",o.SPACE_SIZE*s+(o.SPACE_SIZE/2-o.getPieceSize(n.value)))("width",2*o.getPieceSize(n.value))("height",2*o.getPieceSize(n.value))}}function Bgt(r,e){if(1&r&&(N(),F(0,"circle",12)),2&r){const t=p(2),n=t.$implicit,i=t.index,s=p().index,o=p();y("ngClass",o.getPieceClasses(n.value)),I("cx",o.SPACE_SIZE*i+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*s+o.SPACE_SIZE/2)("r",o.getPieceSize(n.value))}}function Ugt(r,e){if(1&r&&(N(),F(0,"circle")),2&r){const t=p(2).index,n=p().index,i=p();I("cx",i.SPACE_SIZE*t+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("r",10)}}function Wgt(r,e){if(1&r&&(N(),S(0,"g"),T(1,Ggt,1,5,"rect",10),T(2,Bgt,1,4,"ng-template",null,11,un),T(4,Ugt,1,3,"circle",7),P()),2&r){const t=cn(3),n=p().$implicit,i=p(2);_(1),y("ngIf",n.isRectangle())("ngIfElse",t),_(3),y("ngIf",i.pieceHasDot(n.value))}}function qgt(r,e){if(1&r){const t=pe();N(),S(0,"g")(1,"rect",9),W("click",function(){const s=te(t).index,o=p().index;return ne(p().chooseCoord(s,o))}),P(),T(2,Wgt,5,3,"g",7),P()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,s=p();_(1),ye("id","chooseCoord_",n,"_",i,""),y("ngClass",s.getSquareClasses(n,i)),I("x",s.SPACE_SIZE*n)("y",s.SPACE_SIZE*i)("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),_(1),y("ngIf",t!==s.EMPTY)}}function jgt(r,e){if(1&r&&(N(),S(0,"g",null,8),T(2,qgt,3,8,"g",2),P()),2&r){const t=e.$implicit;_(2),y("ngForOf",t)}}function Zgt(r,e){if(1&r&&(N(),F(0,"rect",17)),2&r){const t=p(2);y("ngClass",t.getPieceClasses(t.pieceInHand.value)),I("x",t.SPACE_SIZE/2-t.getPieceSize(t.pieceInHand.value))("y",t.SPACE_SIZE/2-t.getPieceSize(t.pieceInHand.value))("width",2*t.getPieceSize(t.pieceInHand.value))("height",2*t.getPieceSize(t.pieceInHand.value))}}function Ygt(r,e){if(1&r&&(N(),F(0,"circle",12)),2&r){const t=p(2);y("ngClass",t.getPieceClasses(t.pieceInHand.value)),I("cx",t.SPACE_SIZE/2)("cy",t.SPACE_SIZE/2)("r",t.getPieceSize(t.pieceInHand.value))}}function Kgt(r,e){if(1&r&&(N(),F(0,"circle")),2&r){const t=p(2);I("cx",t.SPACE_SIZE/2)("cy",t.SPACE_SIZE/2)("r",10)}}function Xgt(r,e){if(1&r){const t=pe();N(),S(0,"g",13,14),W("click",function(){return te(t),ne(p().deselectDroppedPiece())}),F(2,"rect",15),T(3,Zgt,1,5,"rect",16),T(4,Ygt,1,4,"ng-template",null,11,un),T(6,Kgt,1,3,"circle",7),P()}if(2&r){const t=cn(5),n=p();ye("id","droppedPiece_",n.chosen.get().x,"_",n.chosen.get().y,""),I("transform","translate("+n.chosen.get().x*n.SPACE_SIZE+" "+n.chosen.get().y*n.SPACE_SIZE+")"),_(2),I("width",n.SPACE_SIZE)("height",n.SPACE_SIZE),_(1),y("ngIf",n.pieceInHand.isRectangle())("ngIfElse",t),_(3),y("ngIf",n.pieceHasDot(n.pieceInHand.value))}}function Qgt(r,e){if(1&r&&(N(),S(0,"g",null,18),F(2,"rect",19),P()),2&r){const t=e.$implicit,n=p();_(2),I("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)("transform","translate("+t.x*n.SPACE_SIZE+" "+t.y*n.SPACE_SIZE+")")}}function Jgt(r,e){if(1&r&&(N(),F(0,"rect",12)),2&r){const t=p(2);y("ngClass",t.getPieceClasses(t.pieceInHand.value)),I("x",0)("y",.75*t.SPACE_SIZE)("transform","translate("+-t.getPieceSize(t.pieceInHand.value)+", "+-t.getPieceSize(t.pieceInHand.value)+")")("width",2*t.getPieceSize(t.pieceInHand.value))("height",2*t.getPieceSize(t.pieceInHand.value))}}function emt(r,e){if(1&r&&(N(),F(0,"circle",21)),2&r){const t=p(2);y("ngClass",t.getPieceClasses(t.pieceInHand.value)),I("cy",.75*t.SPACE_SIZE)("r",t.getPieceSize(t.pieceInHand.value))}}function tmt(r,e){1&r&&(N(),F(0,"circle",22)),2&r&&I("cy",.75*p(2).SPACE_SIZE)("r",10)}function nmt(r,e){if(1&r&&(N(),S(0,"g"),T(1,Jgt,1,6,"rect",10),T(2,emt,1,3,"ng-template",null,11,un),T(4,tmt,1,2,"circle",20),P()),2&r){const t=cn(3),n=p();_(1),y("ngIf",n.pieceInHand.isRectangle())("ngIfElse",t),_(3),y("ngIf",n.pieceHasDot(n.pieceInHand.value))}}function rmt(r,e){if(1&r&&(N(),F(0,"rect",27)),2&r){const t=p(2).index,n=p().index,i=p();zn("id","chosenPiece_",4*n+t,""),I("x",i.SPACE_SIZE*t)("y",i.SPACE_SIZE*n)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)}}function imt(r,e){if(1&r&&(N(),F(0,"rect",12)),2&r){const t=p(2).index,n=p().index,i=p();y("ngClass",i.getPieceClasses(4*n+t)),I("x",i.SPACE_SIZE*t+i.SPACE_SIZE/2-i.getPieceSize(4*n+t))("y",i.SPACE_SIZE*n+i.SPACE_SIZE/2-i.getPieceSize(4*n+t))("width",2*i.getPieceSize(4*n+t))("height",2*i.getPieceSize(4*n+t))}}function smt(r,e){if(1&r&&(N(),F(0,"circle",12)),2&r){const t=p(2).index,n=p().index,i=p();y("ngClass",i.getPieceClasses(4*n+t)),I("cx",i.SPACE_SIZE*t+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("r",i.getPieceSize(4*n+t))}}function omt(r,e){if(1&r&&(N(),F(0,"circle")),2&r){const t=p(2).index,n=p().index,i=p();I("cx",i.SPACE_SIZE*t+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("r",10)}}function amt(r,e){if(1&r){const t=pe();N(),S(0,"g",13),W("click",function(){te(t);const i=p().index,s=p().index;return ne(p().choosePiece(4*s+i))}),T(1,rmt,1,5,"rect",26),T(2,imt,1,5,"rect",10),T(3,smt,1,4,"ng-template",null,11,un),T(5,omt,1,3,"circle",7),P()}if(2&r){const t=cn(4),n=p().index,i=p().index,s=p();zn("id","choosePiece_",4*i+n,""),_(1),y("ngIf",s.pieceToGive.equalsValue(s.QuartoPiece.ofInt(4*i+n))),_(1),y("ngIf",(4*i+n)%4<2)("ngIfElse",t),_(3),y("ngIf",s.pieceHasDot(4*i+n))}}function cmt(r,e){if(1&r&&(N(),S(0,"g"),T(1,amt,6,5,"g",3),P()),2&r){const t=e.index,n=p().index,i=p();_(1),y("ngIf",i.isRemaining(4*n+t))}}function lmt(r,e){if(1&r&&(N(),S(0,"g",null,23),F(2,"rect",24,25),T(4,cmt,2,1,"g",2),P()),2&r){const t=e.$implicit,n=p();I("transform","translate(0 "+6.5*n.SPACE_SIZE+")"),_(2),I("x",-.125*n.SPACE_SIZE)("y",-.125*n.SPACE_SIZE)("width",4.25*n.SPACE_SIZE)("height",4.25*n.SPACE_SIZE),_(2),y("ngForOf",t)}}let umt=(()=>{var r;class e extends Fi{constructor(n){super(n),u(this,"EMPTY",yt.EMPTY),u(this,"QuartoPiece",yt),u(this,"chosen",g.empty()),u(this,"lastMove",g.empty()),u(this,"pieceInHand",yt.EMPTY),u(this,"pieceToGive",g.empty()),u(this,"victoriousCoords",[]),this.rules=kr.get(),this.node=this.rules.getInitialNode(),this.node=this.rules.getInitialNode(),this.availableAIs=[new on($localize`Minimax`,this.rules,new $gt,new w3e),new Kn($localize`MCTS`,new w3e,this.rules)],this.encoder=Yc.encoder,this.tutorial=(new b3e).tutorial,this.pieceInHand=this.getState().pieceInHand}updateBoard(n){var i=this;return M(function*(){const s=i.getState(),o=i.node.previousMove;i.board=s.getCopiedBoard(),i.chosen=g.empty(),i.pieceInHand=s.pieceInHand,i.victoriousCoords=i.rules.getVictoriousCoords(s),i.lastMove=o.map(a=>a.coord)})()}chooseCoord(n,i){var s=this;return M(function*(){const o=yield s.canUserPlay("#chooseCoord_"+n+"_"+i);if(o.isFailure())return s.cancelMove(o.getReason());if(s.hideLastMove(),s.board[i][n]===yt.EMPTY){if(s.showPieceInHandOnBoard(n,i),15===s.getState().turn){const a=new Yc(n,i,yt.EMPTY);return s.chooseMove(a)}if(s.pieceToGive.isAbsent())return b.SUCCESS;{const a=new Yc(n,i,s.pieceToGive.get());return s.chooseMove(a)}}return s.cancelMove(Re.MUST_CLICK_ON_EMPTY_SPACE())})()}choosePiece(n){var i=this;return M(function*(){const s=yield i.canUserPlay("#choosePiece_"+n);if(s.isFailure())return i.cancelMove(s.getReason());if(i.hideLastMove(),i.pieceToGive.equalsValue(yt.ofInt(n)))return i.cancelMoveAttempt(),b.SUCCESS;if(i.pieceToGive=g.of(yt.ofInt(n)),i.chosen.isAbsent())return b.SUCCESS;{const o=i.chosen.get(),a=new Yc(o.x,o.y,i.pieceToGive.get());return i.chooseMove(a)}})()}hideLastMove(){this.lastMove=g.empty()}cancelMoveAttempt(){this.hideLastMove(),this.pieceToGive=g.empty(),this.chosen=g.empty()}deselectDroppedPiece(){var n=this;return M(function*(){const i=n.chosen.getOrElse(new C(404,404)),s="#droppedPiece_"+i.x+"_"+i.y,o=yield n.canUserPlay(s);return o.isFailure()?n.cancelMove(o.getReason()):(n.cancelMoveAttempt(),b.SUCCESS)})()}showPieceInHandOnBoard(n,i){this.chosen=g.of(new C(n,i))}isRemaining(n){return Ua.isGivable(yt.ofInt(n),this.board,this.pieceInHand)}getSquareClasses(n,i){const s=new C(n,i);return this.lastMove.equalsValue(s)?["moved-fill"]:[]}getPieceClasses(n){const i=[];return i.push(n%2==0?"player0-fill":"player1-fill"),i}getPieceSize(n){return n<8?40:25}pieceHasDot(n){return n!==yt.EMPTY.value&&n%8<4}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(Ut))}),u(e,"\u0275cmp",qe({type:r,selectors:[["app-quarto"]],features:[Qe],decls:11,vars:10,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["transform","translate(5 5)"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngIf"],["pieceInHandDiv",""],["x","0","y","0",1,"base","no-fill"],["rectangleInWhichThePieceInHandIsWaiting",""],[4,"ngIf"],["boardDiv",""],[1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass",4,"ngIf","ngIfElse"],["circle",""],[1,"base",3,"ngClass"],[3,"id","click"],["droppedPiece",""],["id","selected","x","0","y","0",1,"base","selected","mid-stroke"],["x","0","y","0","class","base",3,"ngClass",4,"ngIf","ngIfElse"],["x","0","y","0",1,"base",3,"ngClass"],["victoriousCoordsDiv",""],["id","victory","x","0","y","0",1,"base","no-fill","victory-stroke"],["cx","0",4,"ngIf"],["cx","0",1,"base",3,"ngClass"],["cx","0"],["remainingPiece",""],["stroke-dasharray","10, 10",1,"base","no-fill"],["rectangleInWhichTheRemainingPiecesAre",""],["class","base selected-stroke",3,"id",4,"ngIf"],[1,"base","selected-stroke",3,"id"]],template:function(n,i){1&n&&(N(),S(0,"svg",0)(1,"g",1),T(2,jgt,3,1,"g",2),T(3,Xgt,7,8,"g",3),T(4,Qgt,3,3,"g",2),S(5,"g",null,4),F(7,"rect",5,6),T(9,nmt,5,3,"g",7),P(),T(10,lmt,5,6,"g",2),P()()),2&n&&(I("viewBox","0 0 "+4.25*i.SPACE_SIZE+" "+10.75*i.SPACE_SIZE),_(2),y("ngForOf",i.board),_(1),y("ngIf",i.chosen.isPresent()),_(1),y("ngForOf",i.victoriousCoords),_(1),I("transform","translate("+2*i.SPACE_SIZE+", "+4.5*i.SPACE_SIZE+")"),_(2),I("width",1.5*i.SPACE_SIZE)("height",1.5*i.SPACE_SIZE)("transform","translate("+-.75*i.SPACE_SIZE+", 0)"),_(2),y("ngIf",i.chosen.isAbsent()),_(1),y("ngForOf",i.board))},dependencies:[Ft,Wt,At],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})(),fmt=(()=>{class r{}return u(r,"NO_INSIDE_CLICK",()=>$localize`You must pick a space from the edge of the board.`),r})(),ir=(()=>{class r extends W1{static getInitialState(){const t=Ie.createTable(r.SIZE,r.SIZE,K.NONE);return new r(t,0)}static isOnBoard(t){return t.isInRange(r.SIZE,r.SIZE)}applyLegalMove(t){const n=this.getCopiedBoard(),i=this.turn+1;let s=t.coord,o=t.coord.getNext(t.direction);for(;r.isOnBoard(o);)n[s.y][s.x]=n[o.y][o.x],s=s.getNext(t.direction),o=o.getNext(t.direction);return n[s.y][s.x]=this.getCurrentPlayer(),new r(n,i)}}return u(r,"SIZE",5),r})();var A3e;class Xc extends br{static isValidCoord(e){return!1===ir.isOnBoard(e)?b.failure("Invalid coord for QuixoMove: "+e.toString()+" is outside the board."):0!==e.x&&e.x!==ir.SIZE-1&&0!==e.y&&e.y!==ir.SIZE-1?b.failure(fmt.NO_INSIDE_CLICK()):b.SUCCESS}constructor(e,t,n){super(e,t),u(this,"direction",void 0),this.direction=n;const i=Xc.isValidCoord(this.coord);if(i.isFailure())throw new Error(i.getReason());if(0===e&&n===ze.LEFT)throw new Error("Invalid direction: pawn on the left side can't be moved to the left.");if(e===ir.SIZE-1&&n===ze.RIGHT)throw new Error("Invalid direction: pawn on the right side can't be moved to the right.");if(0===t&&n===ze.UP)throw new Error("Invalid direction: pawn on the top side can't be moved up.");if(t===ir.SIZE-1&&n===ze.DOWN)throw new Error("Invalid direction: pawn on the bottom side can't be moved down.")}toString(){return"QuixoMove("+this.coord.x+", "+this.coord.y+", "+this.direction.toString()+")"}equals(e){return e===this||!1!==e.coord.equals(this.coord)&&e.direction===this.direction}}A3e=Xc,u(Xc,"encoder",we.tuple([C.encoder,ze.encoder],r=>[r.coord,r.direction],r=>new A3e(r[0].x,r[0].y,r[1])));class q2 extends Yn{static get(){return q2.singleton.isAbsent()&&(q2.singleton=g.of(new q2)),q2.singleton.get()}constructor(){super(ir)}static getVerticalCoords(e){const t=e.gameState.getCurrentOpponent(),n=[];for(let i=0;i<ir.SIZE;i++)e.gameState.getPieceAtXY(0,i)!==t&&n.push(new C(0,i)),e.gameState.getPieceAtXY(ir.SIZE-1,i)!==t&&n.push(new C(ir.SIZE-1,i));return n}static getHorizontalCenterCoords(e){const t=e.gameState.getCurrentOpponent(),n=[];for(let i=1;i<ir.SIZE-1;i++)e.gameState.getPieceAtXY(i,0)!==t&&n.push(new C(i,0)),e.gameState.getPieceAtXY(i,ir.SIZE-1)!==t&&n.push(new C(i,ir.SIZE-1));return n}static getPossibleDirections(e){const t=[];return 0!==e.x&&t.push(ze.LEFT),0!==e.y&&t.push(ze.UP),e.x!==ir.SIZE-1&&t.push(ze.RIGHT),e.y!==ir.SIZE-1&&t.push(ze.DOWN),t}static getLinesSums(e){const t={};t[k.ZERO.value]={columns:[0,0,0,0,0],rows:[0,0,0,0,0],diagonals:[0,0]},t[k.ONE.value]={columns:[0,0,0,0,0],rows:[0,0,0,0,0],diagonals:[0,0]};for(const n of e.getCoordsAndContents()){const i=n.content,s=n.coord.x,o=n.coord.y;if(i.isPlayer()){const a=i.value;t[a].columns[s]=t[a].columns[s]+1,t[a].rows[o]=t[a].rows[o]+1,s===o&&(t[a].diagonals[0]=t[a].diagonals[0]+1),s+o===ir.SIZE-1&&(t[a].diagonals[1]=t[a].diagonals[1]+1)}}return t}static getVictoriousCoords(e){return q2.QUIXO_HELPER.getVictoriousCoord(e)}static getFullestLine(e){const t=e.columns.concat(e.rows.concat(e.diagonals));return Math.max(...t)}applyLegalMove(e,t,n){return t.applyLegalMove(e)}isLegal(e,t){return t.getPieceAt(e.coord)===t.getCurrentOpponent()?b.failure(Re.CANNOT_CHOOSE_OPPONENT_PIECE()):b.SUCCESS}getGameStatus(e){const t=e.gameState,i=q2.QUIXO_HELPER.getVictoriousCoord(t).map(o=>t.getPieceAt(o)),s=new dt(i);return 0===s.size()?_e.ONGOING:1===s.size()?_e.getVictory(s.getAnyElement().get()):_e.getVictory(t.getCurrentPlayer())}}u(q2,"singleton",g.empty()),u(q2,"QUIXO_HELPER",new fu(ir.isOnBoard,U.identity,ir.SIZE));const T1=K.NONE,na=K.ZERO,Wa=K.ONE;class N3e extends Zn{constructor(...e){super(...e),u(this,"tutorial",[q.informational($localize`Goal of the game.`,$localize`At Quixo, the goal is to align 5 of your pieces.
        The first player plays with dark pieces, the second with light pieces.
        The board is made of 25 spaces spread over a 5x5 square.
        Every piece has a neutral side, a light side, and a dark side.`,ir.getInitialState()),q.fromMove($localize`What a move looks like (without animation)`,$localize`When it is your turn:
        <ol>
            <li>Click on one of your pieces or on a neutral one. You cannot choose a piece of the opponent.
                You can only choose a piece from the edge of the board.</li>
            <li>Pick a direction in which you want to send the piece (by clicking on the arrow).</li>
        </ol>
        You have to imagine that the piece you picked has been moved to the other side of the board, in the chosen direction.
        Once on the other side, all pieces will move by one space in the opposing direction.
        Afterwards, if the piece was neutral, it will become yours and takes your color.<br/><br/>
        For example, take the bottom right neutral piece, and move it to the left (you're playing Light).`,new ir([[T1,T1,T1,T1,T1],[T1,T1,T1,T1,T1],[T1,T1,T1,T1,T1],[T1,T1,T1,T1,T1],[na,na,na,na,T1]],1),[new Xc(4,4,ze.LEFT)],$localize`See how the four dark pieces have been moved one space to the right.
        The neutral piece has been move 4 pieces to the left and has become light.`,$localize`Failed. Try again.`),q.fromMove($localize`Victory`,$localize`You already know everything you need in order to play, but there is one last particularity.
        If you create a line of 5 of your pieces, you win.
        If you create a line of 5 of your opponent's pieces, you lose.
        If you create both, you lose too!<br/><br/>
        You can win with this board, try it.
        You're playing Light.`,new ir([[T1,Wa,T1,Wa,Wa],[T1,na,na,T1,na],[Wa,Wa,Wa,na,Wa],[na,T1,na,Wa,Wa],[Wa,na,T1,Wa,na]],31),[new Xc(3,0,ze.DOWN)],$localize`Congratulations, you won!`,$localize`Failed. Try again.`)])}}class I3e extends Un{getListMoves(e){const t=[],n=q2.getVerticalCoords(e),s=q2.getHorizontalCenterCoords(e).concat(n);for(const o of s){const a=q2.getPossibleDirections(o);for(const c of a){const l=new Xc(o.x,o.y,c);t.push(l)}}return t}}class dmt extends fr{getMetrics(e){const n=q2.getLinesSums(e.gameState);return[q2.getFullestLine(n[k.ZERO.value]),q2.getFullestLine(n[k.ONE.value])]}}function hmt(r,e){if(1&r){const t=pe();N(),S(0,"g")(1,"circle",4),W("click",function(){const s=te(t).index,o=p().index;return ne(p().onBoardClick(s,o))}),P()()}if(2&r){const t=e.index,n=p().index,i=p();_(1),ye("id","click_",t,"_",n,""),y("ngClass",i.getPieceClasses(t,n)),I("r",.45*i.SPACE_SIZE)("cx",(t+.5)*i.SPACE_SIZE)("cy",(n+.5)*i.SPACE_SIZE)}}function pmt(r,e){if(1&r&&(N(),S(0,"g"),T(1,hmt,2,6,"g",2),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function gmt(r,e){if(1&r){const t=pe();N(),S(0,"use",6),W("click",function(){const s=te(t).$implicit;return ne(p(2).chooseDirection(s))}),P()}if(2&r){const t=e.$implicit,n=p(2);zn("id","chooseDirection_",t,""),I("transform",n.getArrowTransform(t))}}function mmt(r,e){if(1&r&&(N(),S(0,"g"),T(1,gmt,1,2,"use",5),P()),2&r){const t=p();_(1),y("ngForOf",t.getPossiblesDirections())}}let _mt=(()=>{var r;class e extends Fi{constructor(n){super(n),u(this,"QuixoState",ir),u(this,"state",void 0),u(this,"lastMoveCoord",g.empty()),u(this,"chosenCoord",g.empty()),u(this,"chosenDirection",void 0),u(this,"victoriousCoords",[]),this.rules=q2.get(),this.node=this.rules.getInitialNode(),this.availableAIs=[new on($localize`Minimax`,this.rules,new dmt,new I3e),new Kn($localize`MCTS`,new I3e,this.rules)],this.encoder=Xc.encoder,this.tutorial=(new N3e).tutorial}updateBoard(n){var i=this;return M(function*(){i.state=i.getState(),i.board=i.state.board,i.lastMoveCoord=i.node.previousMove.map(s=>s.coord),i.victoriousCoords=q2.getVictoriousCoords(i.state)})()}cancelMoveAttempt(){this.chosenCoord=g.empty()}getPieceClasses(n,i){const s=new C(n,i),a=[];return a.push(this.getPlayerClass(this.board[i][n])),this.chosenCoord.equalsValue(s)?a.push("selected-stroke"):this.lastMoveCoord.equalsValue(s)&&a.push("last-move-stroke"),this.victoriousCoords.some(c=>c.equals(s))&&a.push("victory-stroke"),a}onBoardClick(n,i){var s=this;return M(function*(){const o=yield s.canUserPlay("#click_"+n+"_"+i);if(o.isFailure())return s.cancelMove(o.getReason());const a=new C(n,i),c=Xc.isValidCoord(a);return c.isFailure()?s.cancelMove(c.getReason()):s.board[i][n]===s.state.getCurrentOpponent()?s.cancelMove(Re.CANNOT_CHOOSE_OPPONENT_PIECE()):(s.chosenCoord.equalsValue(a)?s.cancelMoveAttempt():s.chosenCoord=g.of(a),b.SUCCESS)})()}getPossiblesDirections(){const n=[],i=this.chosenCoord.get();return i.x!==ir.SIZE-1&&n.push(ze.RIGHT),0!==i.x&&n.push(ze.LEFT),i.y!==ir.SIZE&&n.push(ze.DOWN),0!==i.y&&n.push(ze.UP),n}chooseDirection(n){var i=this;return M(function*(){const s=yield i.canUserPlay("#chooseDirection_"+n.toString());return s.isFailure()?i.cancelMove(s.getReason()):(i.chosenDirection=n,yield i.tryMove())})()}tryMove(){var n=this;return M(function*(){const i=n.chosenCoord.get(),s=new Xc(i.x,i.y,n.chosenDirection);return n.chooseMove(s)})()}getArrowTransform(n){return $dt.getArrowTransform(ir.SIZE*this.SPACE_SIZE,new C(0,0),n)}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(Ut))}),u(e,"\u0275cmp",qe({type:r,selectors:[["app-quixo"]],features:[Qe],decls:5,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["id","triangle","points","0 0, 100 50, 0 100"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"base",3,"id","ngClass","click"],[0,"xlink","href","#triangle","class","semi-transparent",3,"id","click",4,"ngFor","ngForOf"],[0,"xlink","href","#triangle",1,"semi-transparent",3,"id","click"]],template:function(n,i){1&n&&(N(),S(0,"svg",0)(1,"defs"),F(2,"polygon",1),P(),T(3,pmt,2,1,"g",2),T(4,mmt,2,1,"g",3),P()),2&n&&(I("viewBox","0 0 "+i.QuixoState.SIZE*i.SPACE_SIZE+" "+i.QuixoState.SIZE*i.SPACE_SIZE),_(3),y("ngForOf",i.board),_(1),y("ngIf",i.chosenCoord.isPresent()))},dependencies:[Ft,Wt,At],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})(),Wi=(()=>{class r extends W1{static getInitialState(){const t=Ie.createTable(r.BOARD_WIDTH,r.BOARD_HEIGHT,K.NONE);return t[3][3]=k.ZERO,t[4][4]=k.ZERO,t[3][4]=k.ONE,t[4][3]=k.ONE,new r(t,0)}static isOnBoard(t){return t.isInRange(r.BOARD_WIDTH,r.BOARD_HEIGHT)}static getNeighboringPawnLike(t,n,i,s){let o;const a=[];for(let c=-1;c<2;c++)for(let l=-1;l<2;l++)o=new C(i+l,s+c),r.isOnBoard(o)&&t[o.y][o.x]===n&&a.push(o);return a}countScore(){const t=[0,0];for(let n=0;n<r.BOARD_HEIGHT;n++)for(let i=0;i<r.BOARD_WIDTH;i++){const s=this.board[n][i];s.isPlayer()&&(t[s.value]+=1)}return t}}return u(r,"BOARD_WIDTH",8),u(r,"BOARD_HEIGHT",8),r})();var nR;class qi extends br{static of(e){return new qi(e.x,e.y)}toString(){return"ReversiMove("+this.coord.x+", "+this.coord.y+")"}}u(qi,"encoder",br.getEncoder((nR=qi).of)),u(qi,"PASS",new nR(-1,-1));let vmt=(()=>{class r{}return u(r,"NO_ELEMENT_SWITCHED",()=>$localize`Your move should switch at least one piece.`),r})();var GC,ra;class k3e{constructor(e,t){u(this,"move",void 0),u(this,"switched",void 0),this.move=e,this.switched=t}}let z0=(GC=class extends Yn{static get(){return ra.singleton.isAbsent()&&(ra.singleton=g.of(new ra)),ra.singleton.get()}constructor(){super(Wi)}static getGameStatus(e){const t=e.gameState;if(!1===ra.isGameEnded(t))return _e.ONGOING;const i=t.countScore(),s=i[1]-i[0];return s<0?_e.ZERO_WON:s>0?_e.ONE_WON:_e.DRAW}applyLegalMove(e,t,n){const i=t.turn,s=t.getCurrentPlayer(),o=t.getCopiedBoard();if(e.equals(qi.PASS))return new Wi(o,i+1);for(const c of n)o[c.y][c.x]=s;return o[e.coord.y][e.coord.x]=s,new Wi(o,i+1)}static getAllSwitcheds(e,t,n){const i=[],s=t.getOpponent();for(const o of Me.DIRECTIONS){const a=e.coord.getNext(o);if(Wi.isOnBoard(a)&&n[a.y][a.x]===s){const c=ra.getSandwicheds(t,o,a,n);for(const l of c)i.push(l)}}return i}static getSandwicheds(e,t,n,i){const s=[n];let o=n.getNext(t);for(;Wi.isOnBoard(o);){const a=i[o.y][o.x];if(a===e)return s;if(a===K.NONE)return[];s.push(o),o=o.getNext(t)}return[]}static isGameEnded(e){return this.playerCanOnlyPass(e)&&this.nextPlayerCantOnlyPass(e)}getGameStatus(e){return ra.getGameStatus(e)}static playerCanOnlyPass(e){const t=this.getListMoves(e);return 1===t.length&&t[0].move.equals(qi.PASS)}static nextPlayerCantOnlyPass(e){const t=e.getCopiedBoard(),i=new Wi(t,e.turn+1);return this.playerCanOnlyPass(i)}static getListMoves(e){const t=[];let n;const i=e.getCurrentPlayer(),s=e.getCurrentOpponent();for(let o=0;o<8;o++)for(let a=0;a<8;a++)if(e.getPieceAtXY(a,o)===K.NONE&&(n=e.getCopiedBoard(),Wi.getNeighboringPawnLike(n,s,a,o).length>0)){const l=new qi(a,o),f=ra.getAllSwitcheds(l,i,n);if(f.length>0){for(const d of f)U.assert(i!==e.getPieceAt(d),d+"was already switched!"),n[d.y][d.x]=i;n[o][a]=i,t.push(new k3e(l,f.length))}}return 0===t.length&&t.push(new k3e(qi.PASS,0)),t}isLegal(e,t){if(e.equals(qi.PASS))return ra.playerCanOnlyPass(t)?ie.success([]):ie.failure(Re.CANNOT_PASS());if(t.getPieceAt(e.coord).isPlayer())return ie.failure(Re.MUST_CLICK_ON_EMPTY_SPACE());const n=t.getCopiedBoard(),i=ra.getAllSwitcheds(e,t.getCurrentPlayer(),n);return 0===i.length?ie.failure(vmt.NO_ELEMENT_SWITCHED()):ie.success(i)}},ra=GC,u(GC,"singleton",g.empty()),GC);z0=ra=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ne.log],z0);const Mt=K.NONE,Pt=K.ZERO,Ye=K.ONE;class x3e extends Zn{constructor(...e){super(...e),u(this,"tutorial",[q.informational($localize`Goal of the game`,$localize`At Reversi, the pieces are double sided: one dark side for the first player, one light side for the second player.
        When one piece is flipped, its owner changes.
        The player owning the most pieces at the end of the game wins.
        Here, Dark has 28 points and Light has 36, hence Light wins.`,new Wi([[Pt,Pt,Pt,Pt,Pt,Pt,Pt,Pt],[Pt,Ye,Ye,Ye,Ye,Ye,Ye,Pt],[Pt,Ye,Ye,Ye,Ye,Ye,Ye,Pt],[Pt,Ye,Ye,Ye,Ye,Ye,Ye,Pt],[Pt,Ye,Ye,Ye,Ye,Ye,Ye,Pt],[Pt,Ye,Ye,Ye,Ye,Ye,Ye,Pt],[Pt,Ye,Ye,Ye,Ye,Ye,Ye,Pt],[Pt,Pt,Pt,Pt,Pt,Pt,Pt,Pt]],60)),q.anyMove($localize`Capture (1/2)`,$localize`At the beginning of the game, pieces are placed as shown here.
        For a move to be legal, it must sandwich at least one piece of the opponent between the piece you're putting and another of your pieces.<br/><br/>
        Do any move by clicking to put your piece
        Dark plays first.`,Wi.getInitialState(),new qi(2,4),$localize`Congratulations!`),q.fromMove($localize`Capture (2/2)`,$localize`A move can also capture a bigger line, and more than one line at a time<br/><br/>
        You're playing light here. Play on the bottom left to see a capture.`,new Wi([[Mt,Mt,Mt,Mt,Mt,Mt,Mt,Mt],[Mt,Mt,Mt,Mt,Mt,Mt,Mt,Mt],[Mt,Mt,Mt,Mt,Mt,Mt,Mt,Mt],[Mt,Mt,Mt,Mt,Ye,Mt,Mt,Mt],[Mt,Mt,Mt,Pt,Mt,Mt,Mt,Mt],[Mt,Mt,Pt,Mt,Mt,Mt,Mt,Mt],[Pt,Pt,Mt,Mt,Mt,Mt,Mt,Mt],[Mt,Pt,Ye,Pt,Ye,Pt,Mt,Mt]],1),[new qi(0,7)],$localize`Congratulations!`,$localize`Lower and more to the left, please.`),q.informational($localize`Passing a turn`,$localize`If, during its turn, a player has no move that would allow that player to flip a piece, that player must pass
        Moreover, if the next player could not play neither, the game ends before the board is full, and points are counted in the usual way.`,new Wi([[Ye,Pt,Pt,Pt,Pt,Pt,Ye,Pt],[Pt,Ye,Ye,Ye,Ye,Ye,Ye,Pt],[Pt,Ye,Ye,Ye,Ye,Ye,Ye,Pt],[Pt,Ye,Ye,Ye,Ye,Ye,Ye,Pt],[Pt,Ye,Ye,Ye,Ye,Ye,Ye,Pt],[Pt,Ye,Ye,Ye,Ye,Ye,Ye,Pt],[Ye,Ye,Ye,Ye,Ye,Ye,Mt,Mt],[Pt,Pt,Pt,Pt,Pt,Pt,Mt,Mt]],60))])}}class L3e extends Un{getListMoves(e){return z0.getListMoves(e.gameState).map(n=>n.move)}}class ymt extends fr{getMetrics(e){const n=e.gameState.getCopiedBoard();let i=0,s=0;for(let o=0;o<Wi.BOARD_HEIGHT;o++)for(let a=0;a<Wi.BOARD_WIDTH;a++){const f=(0===a||a===Wi.BOARD_WIDTH-1?4:1)*(0===o||o===Wi.BOARD_HEIGHT-1?4:1);n[o][a]===k.ZERO&&(i+=f),n[o][a]===k.ONE&&(s+=f)}return[i,s]}}class Mmt extends on{constructor(){super($localize`Minimax`,z0.get(),new ymt,new L3e)}}function Emt(r,e){if(1&r&&(N(),F(0,"circle",4)),2&r){const t=p().index,n=p().index,i=p();y("ngClass",i.getPieceClass(t,n)),I("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)("cx",i.SPACE_SIZE*t+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*n+i.SPACE_SIZE/2)}}function Smt(r,e){if(1&r){const t=pe();N(),S(0,"g")(1,"rect",2),W("click",function(){const s=te(t).index,o=p().index;return ne(p().onClick(s,o))}),P(),T(2,Emt,1,4,"circle",3),P()}if(2&r){const t=e.index,n=p().index,i=p();_(1),ye("id","click_",t,"_",n,""),y("ngClass",i.getRectClasses(t,n)),I("x",i.SPACE_SIZE*t)("y",i.SPACE_SIZE*n)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),_(1),y("ngIf",i.board[n][t]!==i.EMPTY)}}function Pmt(r,e){if(1&r&&(N(),S(0,"g"),T(1,Smt,3,8,"g",1),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}let Tmt=(()=>{var r;class e extends Fi{constructor(n){super(n),u(this,"EMPTY",K.NONE),u(this,"lastMove",new C(-2,-2)),u(this,"capturedCoords",[]),this.scores=g.of([2,2]),this.rules=z0.get(),this.node=this.rules.getInitialNode(),this.availableAIs=[new Mmt,new Kn($localize`MCTS`,new L3e,this.rules)],this.encoder=qi.encoder,this.tutorial=(new x3e).tutorial,this.canPass=!1}onClick(n,i){var s=this;return M(function*(){const o=yield s.canUserPlay("#click_"+n+"_"+i);if(o.isFailure())return s.cancelMove(o.getReason());const a=new qi(n,i);return yield s.chooseMove(a)})()}updateBoard(n){var i=this;return M(function*(){const s=i.getState();i.board=s.getCopiedBoard(),i.capturedCoords=[],i.lastMove=new C(-2,-2),i.scores=g.of(s.countScore()),i.canPass=z0.playerCanOnlyPass(s)})()}showLastMove(n){var i=this;return M(function*(){i.lastMove=n.coord;const s=i.getState().getCurrentPlayer(),o=i.getState().getCurrentOpponent();for(const a of Me.DIRECTIONS){let c=i.lastMove.getNext(a,1);for(;Wi.isOnBoard(c)&&i.getState().getPieceAt(c)===o&&i.getPreviousState().getPieceAt(c)===s;)i.capturedCoords.push(c),c=c.getNext(a,1)}})()}getRectClasses(n,i){const s=new C(n,i);return this.capturedCoords.some(o=>o.equals(s))?["captured-fill"]:s.equals(this.lastMove)?["moved-fill"]:[]}getPieceClass(n,i){return this.getPlayerClass(this.board[i][n])}pass(){var n=this;return M(function*(){return U.assert(n.canPass,"ReversiComponent: pass() can only be called if canPass is true"),n.onClick(qi.PASS.coord.x,qi.PASS.coord.y)})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(Ut))}),u(e,"\u0275cmp",qe({type:r,selectors:[["app-reversi"]],features:[Qe],decls:2,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass",4,"ngIf"],[1,"base",3,"ngClass"]],template:function(n,i){1&n&&(N(),S(0,"svg",0),T(1,Pmt,2,1,"g",1),P()),2&n&&(I("viewBox","0 -4 "+8*i.SPACE_SIZE+" "+(10+8*i.SPACE_SIZE)),_(1),y("ngForOf",i.board))},dependencies:[Ft,Wt,At],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})(),qa=(()=>{class r extends b0{static getInitialState(){const t=Ce.UNREACHABLE,n=Ce.ZERO,i=Ce.ONE,s=Ce.EMPTY;return new r([[t,t,n,i,s,s,s,n,i,t,t],[t,s,s,s,s,s,s,s,s,s,t],[i,s,s,s,s,s,s,s,s,s,n],[n,s,s,s,s,s,s,s,s,s,i],[t,s,s,s,s,s,s,s,s,s,t],[t,t,i,n,s,s,s,i,n,t,t]],0)}static isOnBoard(t){return t.isInRange(r.WIDTH,r.HEIGHT)}}return u(r,"HEIGHT",6),u(r,"WIDTH",11),r})(),Su=(()=>{class r{}return u(r,"CAN_ONLY_REBOUND_ON_BLACK",()=>$localize`You can only rebound on dark spaces.`),u(r,"CAN_ONLY_REBOUND_ON_EMPTY_SPACE",()=>$localize`You can only rebound on empty spaces.`),u(r,"MUST_CHOOSE_PYRAMID_FIRST",()=>$localize`You must pick one of your pyramids first.`),u(r,"MUST_CHOOSE_OWN_PYRAMID",()=>$localize`You must pick one of your pyramids.`),u(r,"THOSE_TWO_SPACES_ARE_NOT_NEIGHBORS",()=>$localize`Those two spaces are not neighbors.`),u(r,"THOSE_TWO_SPACES_HAVE_NO_COMMON_NEIGHBOR",()=>$localize`Those two spaces have no intermediary neighbor.`),r})();class ja extends $o{static checkDistanceAndLocation(e,t){const n=e.getOrthogonalDistance(t);if(0===n)return b.failure(Re.MOVE_CANNOT_BE_STATIC());if(1===n){const i=Bo.getFakeNeighbors(e);if(t.equals(i))return b.failure(Su.THOSE_TWO_SPACES_ARE_NOT_NEIGHBORS())}else{if(2!==n)return b.failure($localize`You can move one or two spaces, not ${n}.`);if(Bo.isSpaceDark(e))return b.failure(Su.CAN_ONLY_REBOUND_ON_BLACK());if(e.x===t.x)return b.failure(Su.THOSE_TWO_SPACES_HAVE_NO_COMMON_NEIGHBOR())}return b.SUCCESS}static from(e,t){U.assert(qa.isOnBoard(e),"Move must start inside the board not at "+e.toString()+"."),U.assert(qa.isOnBoard(t),"Move must end inside the board not at "+t.toString()+".");const n=ja.checkDistanceAndLocation(e,t);return n.isFailure()?n.toOtherFallible():ie.success(new ja(e,t))}constructor(e,t){super(e,t)}isSimpleStep(){return Math.abs(this.getStart().x-this.getEnd().x)+Math.abs(this.getStart().y-this.getEnd().y)===1}toString(){return"SaharaMove("+this.getStart()+"->"+this.getEnd()+")"}}var BC,Qc;u(ja,"encoder",Hs.getFallibleEncoder(ja.from));let D0=(BC=class extends Yn{static get(){return Qc.singleton.isAbsent()&&(Qc.singleton=g.of(new Qc)),Qc.singleton.get()}constructor(){super(qa)}static getStartingCoords(e,t){const n=[];for(let i=0;i<qa.HEIGHT;i++)for(let s=0;s<qa.WIDTH;s++)e[i][s].is(t)&&n.push(new C(s,i));return n}static getBoardValuesFor(e,t){const n=Qc.getStartingCoords(e,t),i=[];for(const s of n){const o=b0.getEmptyNeighbors(e,s,Ce.EMPTY).length;if(0===o)return[0];i.push(o)}return i.sort((s,o)=>s-o)}applyLegalMove(e,t,n){const i=t.getCopiedBoard();return i[e.getEnd().y][e.getEnd().x]=i[e.getStart().y][e.getStart().x],i[e.getStart().y][e.getStart().x]=Ce.EMPTY,new qa(i,t.turn+1)}isLegal(e,t){if(t.getPieceAt(e.getStart()).value!==t.getCurrentPlayer().value)return b.failure(Re.CANNOT_CHOOSE_OPPONENT_PIECE());if(t.getPieceAt(e.getEnd())!==Ce.EMPTY)return b.failure(Re.MUST_LAND_ON_EMPTY_SPACE());const s=Bo.getCommonNeighbor(e.getStart(),e.getEnd());return s.isPresent()?t.getPieceAt(s.get())===Ce.EMPTY?b.SUCCESS:b.failure(Su.CAN_ONLY_REBOUND_ON_EMPTY_SPACE()):b.SUCCESS}getGameStatus(e){const t=e.gameState.getCopiedBoard(),n=Qc.getBoardValuesFor(t,k.ZERO),i=Qc.getBoardValuesFor(t,k.ONE);return Qc.getGameStatusFromFreedoms(n,i)}getLandingCoords(e,t){const n=s=>qa.isOnBoard(s)&&e[s.y][s.x]===Ce.EMPTY,i=new dt(Bo.getNeighbors(t).filter(n));if(!0===Bo.isSpaceDark(t))return i.toList();{const s=new dt(i.toList());for(const o of i){const a=Bo.getNeighbors(o).filter(n);for(const c of a)s.add(c)}return s.toList()}}static getGameStatusFromFreedoms(e,t){return 0===e[0]?_e.ONE_WON:0===t[0]?_e.ZERO_WON:_e.ONGOING}},Qc=BC,u(BC,"singleton",g.empty()),BC);D0=Qc=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ne.log],D0);const ia=Ce.UNREACHABLE,Pu=Ce.ZERO,Tu=Ce.ONE,sn=Ce.EMPTY;class z3e extends Zn{constructor(...e){super(...e),u(this,"tutorial",[q.informational($localize`Initial board`,$localize`Shr is played on a board where each space is a triangle.
        Each player has six pyramids.`,qa.getInitialState()),q.informational($localize`Goal of the game`,$localize`At Shr, the goal of the game is to immobilize one of the opponent's pyramids.
        To do so, you have to occupy all neighboring space of that pyramid.
        Here, Light has lost because its leftmost pyramid is immobilized.`,new qa([[ia,ia,sn,sn,Tu,sn,sn,Pu,Tu,ia,ia],[ia,sn,sn,sn,sn,sn,sn,sn,sn,sn,ia],[Tu,Pu,sn,sn,sn,sn,sn,sn,sn,sn,Pu],[Pu,sn,sn,sn,sn,sn,sn,sn,sn,sn,Tu],[ia,sn,sn,sn,sn,sn,sn,sn,sn,sn,ia],[ia,ia,Tu,Pu,sn,sn,sn,Tu,Pu,ia,ia]],3)),q.fromPredicate($localize`Simple step`,$localize`To immobilize your opponent, you have to move your pyramids.
        When a pyramid shares its vertices with light spaces, it can move on these spaces (we call this a simple step).
        To perform a move:
        <ol>
            <li>Click on one of your pyramids.</li>
            <li>Click on one of its two or three neighboring spaces in order to move your pyramid there.</li>
        </ol><br/>
        You're playing Dark, do any simple step.`,qa.getInitialState(),ja.from(new C(2,0),new C(2,1)).get(),(t,n,i)=>t.isSimpleStep()?b.SUCCESS:b.failure($localize`You have made a double step, which is good but it is the next exercise!`),$localize`Congratulations!`),q.fromPredicate($localize`Double step`,$localize`When a pyramid shares its vertices with dark spaces, it can move one or two steps.
        To do so:
        <ol>
            <li>Click on the pyramid to move.</li>
            <li>Click on one of the 6 destinations that you can reach in two steps:
                 the 6 neighboring light spaces of the 3 dark spaces that are neighbors of your pyramid.
        </ol><br/>
        You're playing Dark, do a double step.`,qa.getInitialState(),ja.from(new C(7,0),new C(5,0)).get(),(t,n,i)=>t.isSimpleStep()?b.failure($localize`Failed! You have made a single step.`):b.SUCCESS,$localize`Congratulations!`)])}}class bmt extends fr{getMetrics(e){const t=e.gameState.board,n=D0.getBoardValuesFor(t,k.ZERO),i=D0.getBoardValuesFor(t,k.ONE);let s=0;for(;s<6&&n[s]===i[s];)s++;return[n[s%6],i[s%6]]}}class D3e extends Un{getListMoves(e){const t=[],n=e.gameState.getCopiedBoard(),i=e.gameState.getCurrentPlayer(),s=D0.getStartingCoords(n,i);for(const o of s){const a=b0.getEmptyNeighbors(n,o,Ce.EMPTY);for(const c of a){const l=ja.from(o,c).get();if(n[c.y][c.x]=n[o.y][o.x],n[o.y][o.x]=Ce.EMPTY,t.push(l),(c.y+c.x)%2==0){const d=b0.getEmptyNeighbors(n,c,Ce.EMPTY);for(const m of d)if(!1===m.equals(o)){const E=ja.from(o,m).get();n[m.y][m.x]=n[c.y][c.x],n[c.y][c.x]=Ce.EMPTY,t.push(E),n[c.y][c.x]=n[m.y][m.x],n[m.y][m.x]=Ce.EMPTY}}n[o.y][o.x]=n[c.y][c.x],n[c.y][c.x]=Ce.EMPTY}}return t}}function wmt(r,e){if(1&r&&(N(),S(0,"g"),F(1,"polygon",7),P()),2&r){const t=p().index,n=p().index,i=p();_(1),y("ngClass",i.getPlayerClassFor(t,n)),I("points",i.getPyramidPoints(t,n))("transform",i.getTriangleTranslate(t,n))}}function Amt(r,e){if(1&r&&(N(),F(0,"polygon",10)),2&r){const t=p(2).index,n=p().index,i=p();I("points",i.getTrianglePoints(t,n))("transform",i.getTriangleTranslate(t,n))}}function Nmt(r,e){if(1&r&&(N(),F(0,"polygon",11)),2&r){const t=p(2).index,n=p().index,i=p();I("points",i.getTrianglePoints(t,n))("transform",i.getTriangleTranslate(t,n))}}function Imt(r,e){if(1&r&&(N(),S(0,"g"),T(1,Amt,1,2,"polygon",8),T(2,Nmt,1,2,"polygon",9),P()),2&r){const t=p().index,n=p().index;_(1),y("ngIf",(t+n)%2==1),_(1),y("ngIf",(t+n)%2==0)}}function kmt(r,e){if(1&r){const t=pe();N(),S(0,"g",5),W("click",function(){const s=te(t).index,o=p().index;return ne(p().onClick(s,o))}),T(1,wmt,2,3,"g",6),T(2,Imt,3,2,"g",6),P()}if(2&r){const t=e.$implicit;ye("id","click_",e.index,"_",p().index,""),_(1),y("ngIf",t.isPlayer()),_(1),y("ngIf",2===t.value)}}function xmt(r,e){if(1&r&&(N(),S(0,"g"),T(1,kmt,3,4,"g",4),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function Lmt(r,e){if(1&r&&(N(),F(0,"polygon",14)),2&r){const t=e.$implicit,n=p(2);ye("id","possible_landing_",t.x,"_",t.y,""),I("points",n.getTrianglePoints(t.x,t.y))("transform",n.getTriangleTranslate(t.x,t.y))}}function Rmt(r,e){if(1&r&&(N(),F(0,"polygon",14)),2&r){const t=p(2);ye("id","chosen_coord_",t.chosenCoord.get().x,"_",t.chosenCoord.get().y,""),I("points",t.getTrianglePoints(t.chosenCoord.get().x,t.chosenCoord.get().y))("transform",t.getTriangleTranslate(t.chosenCoord.get().x,t.chosenCoord.get().y))}}function zmt(r,e){if(1&r&&(N(),Gt(0),T(1,Lmt,1,4,"polygon",12),T(2,Rmt,1,4,"polygon",13),Bt()),2&r){const t=p();_(1),y("ngForOf",t.possibleLandings),_(1),y("ngIf",t.chosenCoord.isPresent())}}function Dmt(r,e){if(1&r&&(N(),Gt(0),F(1,"polygon",15)(2,"polygon",15),Bt()),2&r){const t=p(2);_(1),I("points",t.getTrianglePoints(t.lastCoord.get().x,t.lastCoord.get().y))("transform",t.getTriangleTranslate(t.lastCoord.get().x,t.lastCoord.get().y)),_(1),I("points",t.getTrianglePoints(t.lastMoved.get().x,t.lastMoved.get().y))("transform",t.getTriangleTranslate(t.lastMoved.get().x,t.lastMoved.get().y))}}function Hmt(r,e){1&r&&(N(),T(0,Dmt,3,4,"ng-container",6)),2&r&&y("ngIf",p().lastMoved.isPresent())}let Vmt=(()=>{var r;class e extends ece{constructor(n){super(n),u(this,"lastCoord",g.empty()),u(this,"lastMoved",g.empty()),u(this,"chosenCoord",g.empty()),u(this,"possibleLandings",[]),this.rules=D0.get(),this.node=this.rules.getInitialNode(),this.availableAIs=[new on($localize`Minimax`,this.rules,new bmt,new D3e),new Kn($localize`MCTS`,new D3e,this.rules)],this.encoder=ja.encoder,this.tutorial=(new z3e).tutorial}cancelMoveAttempt(){this.possibleLandings=[],this.chosenCoord=g.empty()}onClick(n,i){var s=this;return M(function*(){const o=yield s.canUserPlay("#click_"+n+"_"+i);if(o.isFailure())return s.cancelMove(o.getReason());const a=s.getState().getCurrentPlayer(),c=Ce.ofPlayer(a);return s.chosenCoord.equalsValue(new C(n,i))?(s.cancelMoveAttempt(),b.SUCCESS):s.chosenCoord.isAbsent()||s.board[i][n]===c?s.choosePiece(n,i):s.chooseLandingCoord(n,i)})()}choosePiece(n,i){var s=this;return M(function*(){if(s.board[i][n]===Ce.EMPTY)return s.cancelMove(Su.MUST_CHOOSE_PYRAMID_FIRST());if(s.board[i][n].is(k.ofTurn(s.getTurn()))){const o=new C(n,i);return s.selectPiece(o),b.SUCCESS}return s.cancelMove(Su.MUST_CHOOSE_OWN_PYRAMID())})()}selectPiece(n){this.chosenCoord=g.of(n),this.possibleLandings=this.rules.getLandingCoords(this.board,n)}chooseLandingCoord(n,i){var s=this;return M(function*(){const o=new C(n,i),a=ja.from(s.chosenCoord.get(),o);return a.isFailure()?s.cancelMove(a.getReason()):yield s.chooseMove(a.get())})()}updateBoard(n){var i=this;return M(function*(){const s=i.node.previousMove;i.lastCoord=s.map(o=>o.getStart()),i.lastMoved=s.map(o=>o.getEnd()),i.board=i.getState().board})()}getPlayerClassFor(n,i){return this.getPlayerClass(k.of(this.board[i][n].value))}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(Ut))}),u(e,"\u0275cmp",qe({type:r,selectors:[["app-sahara"]],features:[Qe],decls:5,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-55 -55 610 610","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf","ngIfElse"],["lastMove",""],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[4,"ngIf"],[1,"base","mid-stroke",3,"ngClass"],["class","base mid-stroke",4,"ngIf"],["class","base mid-stroke background2",4,"ngIf"],[1,"base","mid-stroke"],[1,"base","mid-stroke","background2"],["class","base no-fill mid-stroke selected-stroke",3,"id",4,"ngFor","ngForOf"],["class","base no-fill mid-stroke selected-stroke",3,"id",4,"ngIf"],[1,"base","no-fill","mid-stroke","selected-stroke",3,"id"],[1,"base","no-fill","mid-stroke","moved-stroke"]],template:function(n,i){if(1&n&&(N(),S(0,"svg",0),T(1,xmt,2,1,"g",1),T(2,zmt,3,2,"ng-container",2),T(3,Hmt,1,1,"ng-template",null,3,un),P()),2&n){const s=cn(4);_(1),y("ngForOf",i.board),_(1),y("ngIf",i.chosenCoord.isPresent())("ngIfElse",s)}},dependencies:[Ft,Wt,At],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();var Za;class ut{static decode(e){switch(e){case 0:return ut.EMPTY;case 1:return ut.LIGHT_UP;case 2:return ut.LIGHT_RIGHT;case 3:return ut.LIGHT_DOWN;case 4:return ut.LIGHT_LEFT;case 5:return ut.DARK_UP;case 6:return ut.DARK_RIGHT;case 7:return ut.DARK_DOWN;case 8:return ut.DARK_LEFT;case 9:return ut.MOUNTAIN}}belongTo(e){return e===k.ZERO?1<=this.value&&this.value<=4:5<=this.value&&this.value<=8}isEmptyOrMountain(){return 0===this.value||9===this.value}isPiece(){return!1===this.isEmptyOrMountain()}getOwner(){return 1<=this.value&&this.value<=4?k.ZERO:5<=this.value&&this.value<=8?k.ONE:K.NONE}getOptionalDirection(){switch(this.value){case 0:return g.empty();case 1:case 5:return g.of(ze.UP);case 2:case 6:return g.of(ze.RIGHT);case 3:case 7:return g.of(ze.DOWN);case 4:case 8:return g.of(ze.LEFT);default:return U.expectToBe(this.value,9),g.empty()}}static of(e,t){return t===k.ZERO?e===ze.UP?ut.LIGHT_UP:e===ze.RIGHT?ut.LIGHT_RIGHT:e===ze.DOWN?ut.LIGHT_DOWN:ut.LIGHT_LEFT:e===ze.UP?ut.DARK_UP:e===ze.RIGHT?ut.DARK_RIGHT:e===ze.DOWN?ut.DARK_DOWN:ut.DARK_LEFT}constructor(e){u(this,"value",void 0),this.value=e}getDirection(){return this.getOptionalDirection().get()}toString(){switch(this.value){case 0:return"EMPTY";case 1:return"LIGHT_UP";case 2:return"LIGHT_RIGHT";case 3:return"LIGHT_DOWN";case 4:return"LIGHT_LEFT";case 5:return"DARK_UP";case 6:return"DARK_RIGHT";case 7:return"DARK_DOWN";case 8:return"DARK_LEFT";default:return U.expectToBe(this.value,9),"MOUNTAIN"}}}u(ut,"EMPTY",new(Za=ut)(0)),u(ut,"LIGHT_UP",new Za(1)),u(ut,"LIGHT_RIGHT",new Za(2)),u(ut,"LIGHT_DOWN",new Za(3)),u(ut,"LIGHT_LEFT",new Za(4)),u(ut,"DARK_UP",new Za(5)),u(ut,"DARK_RIGHT",new Za(6)),u(ut,"DARK_DOWN",new Za(7)),u(ut,"DARK_LEFT",new Za(8)),u(ut,"MOUNTAIN",new Za(9));let O1=(()=>{class r extends W1{static getInitialState(){const t=Ie.createTable(r.SIZE,r.SIZE,ut.EMPTY);return t[2][1]=ut.MOUNTAIN,t[2][2]=ut.MOUNTAIN,t[2][3]=ut.MOUNTAIN,new r(t,0)}static isOnBoard(t){return t.isInRange(r.SIZE,r.SIZE)}countCurrentPlayerPawn(){return this.countPlayersPawn()[this.getCurrentPlayer().value]}countPlayersPawn(){const t=[0,0];for(const n of this.getCoordsAndContents())n.content!==ut.EMPTY&&t[n.content.getOwner().value]++;return t}}return u(r,"SIZE",5),r})();var H3e;class Gs extends br{constructor(e,t,n,i){super(e,t),u(this,"x",void 0),u(this,"y",void 0),u(this,"direction",void 0),u(this,"landingOrientation",void 0),this.x=e,this.y=t,this.direction=n,this.landingOrientation=i}static from(e,t,n,i){const s=new Gs(e,t,n,i),o=!1===O1.isOnBoard(s.coord);if(s.isRotation()){if(o)return ie.failure("Cannot rotate piece outside the board: "+s.toString())}else if(!1===O1.isOnBoard(s.coord.getNext(s.direction.get()))){if(o)return ie.failure("SiamMove should end or start on the board: "+s.toString());if(s.direction.get()!==s.landingOrientation)return ie.failure("SiamMove should have moveDirection and landingOrientation matching when a piece goes out of the board: "+s.toString())}return ie.success(s)}isRotation(){return this.direction.isAbsent()}equals(e){return this===e||!1!==this.coord.equals(e.coord)&&!1!==this.direction.equals(e.direction)&&this.landingOrientation===e.landingOrientation}toString(){const e=this.direction.isAbsent()?"-":this.direction.get().toString();return"SiamMove("+this.coord.x+", "+this.coord.y+", "+e+", "+this.landingOrientation+")"}isInsertion(){return-1===this.coord.x||this.coord.x===+O1.SIZE||-1===this.coord.y||this.coord.y===+O1.SIZE}}H3e=Gs,u(Gs,"encoder",we.tuple([we.identity(),we.identity(),g.getEncoder(ze.encoder),ze.encoder],r=>[r.x,r.y,r.direction,r.landingOrientation],r=>H3e.from(r[0],r[1],r[2],r[3]).get()));let Ou=(()=>{class r{}return u(r,"NO_REMAINING_PIECE_TO_INSERT",()=>$localize`You cannot insert a piece, all your pieces are already on the board.`),u(r,"NOT_ENOUGH_FORCE_TO_PUSH",()=>$localize`You do not have enough strength to push.`),u(r,"MUST_MOVE_OR_ROTATE",()=>$localize`You must move or rotate your piece.`),u(r,"ILLEGAL_PUSH",()=>$localize`Your push is invalid: it is either not straight, is not pushing anything, or is leaving the board.`),u(r,"MUST_SELECT_VALID_DESTINATION",()=>$localize`You must select a valid destination (highlighted on the board) for your piece`),u(r,"MUST_SELECT_ORIENTATION",()=>$localize`You should select the orientation of your piece by clicking on one of the arrows.`),r})();var UC,bu;class V3e{constructor(e,t){u(this,"resultingBoard",void 0),u(this,"moved",void 0),this.resultingBoard=e,this.moved=t}}let Bs=(UC=class extends Yn{static get(){return bu.singleton.isAbsent()&&(bu.singleton=g.of(new bu)),bu.singleton.get()}constructor(){super(O1)}isLegal(e,t){if(!1===e.isInsertion()&&!1===t.getPieceAt(e.coord).belongTo(t.getCurrentPlayer()))return ie.failure(Re.MUST_CHOOSE_PLAYER_PIECE());if(e.isRotation())return this.isLegalRotation(e,t);{let n;if(e.isInsertion()){const i=this.isLegalInsertion(e.coord,t);if(i.legal.isFailure())return ie.failure(i.legal.getReason());n=i.insertedPiece}else n=t.getPieceAt(e.coord);return this.isLegalForwarding(e,t,n)}}isLegalInsertion(e,t){const n=t.countCurrentPlayerPawn(),i=t.getCurrentPlayer(),s=n<5?b.SUCCESS:b.failure(Ou.NO_REMAINING_PIECE_TO_INSERT());return{insertedPiece:this.getInsertedPiece(e,i),legal:s}}getInsertedPiece(e,t){return ut.of(-1===e.x?ze.RIGHT:-1===e.y?ze.DOWN:e.x===O1.SIZE?ze.LEFT:ze.UP,t)}isLegalForwarding(e,t,n){U.assert(n!==ut.MOUNTAIN&&n!==ut.EMPTY,"forwarding must be done with player piece");const i=[];let s=ut.of(e.landingOrientation,t.getCurrentPlayer());const o=e.direction.get();let a=e.coord.getNext(o);if(O1.isOnBoard(a)&&t.getPieceAt(a)!==ut.EMPTY&&!1===this.isStraight(n,e))return ie.failure(Ou.ILLEGAL_PUSH());let c=g.of(o);const l=o.getOpposite();let f=0;const d=t.getCopiedBoard();O1.isOnBoard(e.coord)&&(d[e.coord.y][e.coord.x]=ut.EMPTY,i.push(e.coord));let m=O1.isOnBoard(a)&&s!==ut.EMPTY;for(;m;){c.equalsValue(o)?f++:c.equalsValue(l)&&f--;const E=d[a.y][a.x];E===ut.MOUNTAIN&&(f-=.9),d[a.y][a.x]=s,i.push(a),s=E,a=a.getNext(o),c=s.getOptionalDirection(),m=O1.isOnBoard(a)&&s!==ut.EMPTY&&f>0}return!1===O1.isOnBoard(a)&&(c.equalsValue(o)?f++:c.equalsValue(l)&&f--),f<=0?ie.failure(Ou.NOT_ENOUGH_FORCE_TO_PUSH()):ie.success(new V3e(d,i))}isStraight(e,t){const n=e.getDirection();return t.direction.equalsValue(n)&&n===t.landingOrientation}isLegalRotation(e,t){const n=e.coord,i=t.getPieceAt(n),s=t.getCurrentPlayer();if(i.getDirection()===e.landingOrientation)return ie.failure(Ou.MUST_MOVE_OR_ROTATE());const o=t.getCopiedBoard();return o[n.y][n.x]=ut.of(e.landingOrientation,s),ie.success(new V3e(o,[n]))}applyLegalMove(e,t,n){const i=Ie.copyBiArray(n.resultingBoard);return new O1(i,t.turn+1)}getScoreFromShortestDistances(e,t,n){e===Number.MAX_SAFE_INTEGER&&(e=6),t===Number.MAX_SAFE_INTEGER&&(t=6);const i=6-e,s=6-t;return i===s?n.getScoreModifier():i>s?-10*(i+1)+(s+1):10*(s+1)-(i+1)}getMountainsRowsAndColumns(e){const t=[],n=[];let i=0;for(const s of e.getCoordsAndContents())s.content===ut.MOUNTAIN&&(!1===t.includes(s.coord.y)&&t.push(s.coord.y),!1===n.includes(s.coord.x)&&n.push(s.coord.x),i++);return{rows:t,columns:n,nbMountain:i}}getWinner(e,t,n){return 2===n?this.getPusher(e,t.get()):K.NONE}getPusher(e,t){const n=t.coord;let i;i=O1.isOnBoard(n)?e.getPieceAt(n.getNext(t.landingOrientation)):this.getInsertedPiece(n,e.getCurrentOpponent());const s=i.getDirection(),o=this.getPusherCoord(e,s,n),a=e.getPieceAt(o).getOwner();return Ne.display("SiamRules","getPusher",n.toString()+" belong to "+e.getCurrentOpponent().value+", "+o.toString()+" belong to "+a.value+", "+a.value+" win"),a}getPusherCoord(e,t,n){let i=n.getNext(t),s=n;for(;O1.isOnBoard(i);){n=i,i=i.getNext(t);const o=e.getPieceAt(n);o!==ut.MOUNTAIN&&o.getDirection()===t&&(s=n)}return s}getPushers(e,t,n){let i=[];const s=[];for(const o of t){let a=ze.DOWN,c=new C(o,4);s.push({direction:a,fallingCoord:c}),a=ze.UP,c=new C(o,0),s.push({direction:a,fallingCoord:c})}for(const o of n){let a=ze.LEFT,c=new C(0,o);s.push({direction:a,fallingCoord:c}),a=ze.RIGHT,c=new C(4,o),s.push({direction:a,fallingCoord:c})}for(const o of s)i=this.addPotentialDirectionPusher(e,o.fallingCoord,o.direction,i);return i}addPotentialDirectionPusher(e,t,n,i){const s=this.getLineClosestPusher(e,t,n);if(s.isAbsent())return i;const o=s.get();return i.push({coord:o.coord,distance:o.distance}),i}getLineClosestPusher(e,t,n){const i=n.getOpposite();let s=1,o=e.getPieceAt(t),a=t,c=g.empty(),l=!1,f=!1,d=0;for(;O1.isOnBoard(a)&&!1===l;){const m=e.getPieceAt(a);if(m.isEmptyOrMountain())m===ut.MOUNTAIN?(d+=.9,f=!0):s++;else{const E=m.getDirection();E===n?f&&(d-=1,d<=0&&(l=!0,a=a.getNext(n))):E===i?(d+=1,!1===f&&s++):f?(c=g.of(a),o!==ut.EMPTY&&s++):s++}o=m,a=a.getPrevious(n)}if(!1===l&&c.isPresent())for(s++,d-=1;!1===a.equals(c.get());)a=a.getNext(n),s--;return!1===O1.isOnBoard(a)&&(d-=1,5===e.countCurrentPlayerPawn())||d>0?g.empty():g.of({distance:s,coord:a})}getInsertions(e){let t=[];for(let n=1;n<4;n++)t=t.concat(this.getInsertionsAt(e,0,n)),t=t.concat(this.getInsertionsAt(e,4,n)),t=t.concat(this.getInsertionsAt(e,n,0)),t=t.concat(this.getInsertionsAt(e,n,4));return t=t.concat(this.getInsertionsAt(e,0,0)),t=t.concat(this.getInsertionsAt(e,0,4)),t=t.concat(this.getInsertionsAt(e,4,0)),t=t.concat(this.getInsertionsAt(e,4,4)),t}getInsertionsAt(e,t,n){const i=[];for(const s of ze.ORTHOGONALS){const o=new C(t,n).getPrevious(s);if(!1===O1.isOnBoard(o))for(const a of ze.ORTHOGONALS){const c=Gs.from(o.x,o.y,g.of(s),a);U.assert(c.isSuccess(),"SiamRules.getInsertionsAt should only construct valid insertions"),this.isLegal(c.get(),e).isSuccess()&&i.push(c.get())}}return i}getMovesFrom(e,t,n,i){const s=new C(n,i);let o=this.getRotationMovesAt(s,t);for(const a of ze.ORTHOGONALS){const c=s.getNext(a);o=o.concat(this.getForwardMovesBetween(e,s,c))}return o}getMovesBetween(e,t,n,i){return n.equals(i)?this.getRotationMovesAt(n,t):ze.factory.fromMove(n,i).isSuccess()&&1===n.getDistance(i)?this.getForwardMovesBetween(e,n,i):[]}getRotationMovesAt(e,t){const n=[],i=t.getDirection();for(const s of ze.ORTHOGONALS)if(s!==i){const o=Gs.from(e.x,e.y,g.empty(),s).get();n.push(o)}return n}getForwardMovesBetween(e,t,n){const i=[];let s;const o=ze.factory.fromMove(t,n).get(),a=e.getPieceAt(t);s=O1.isOnBoard(n)?ze.ORTHOGONALS:[o];for(const c of s){const l=Gs.from(t.x,t.y,g.of(o),c).get();this.isLegalForwarding(l,e,a).isSuccess()&&i.push(l)}return i}getGameStatus(e){const t=this.getMountainsRowsAndColumns(e.gameState),n=this.getWinner(e.gameState,e.previousMove,t.nbMountain);return n.isPlayer()?_e.getVictory(n):_e.ONGOING}},bu=UC,u(UC,"singleton",g.empty()),UC);Bs=bu=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ne.log],Bs);const ke=ut.EMPTY,Co=ut.MOUNTAIN,rR=ut.LIGHT_UP,iR=ut.LIGHT_LEFT,wu=ut.LIGHT_RIGHT,$mt=ut.LIGHT_DOWN,Gmt=ut.DARK_UP,F3e=ut.DARK_LEFT,$3e=ut.DARK_RIGHT,Bmt=ut.DARK_DOWN;class G3e extends Zn{constructor(...e){super(...e),u(this,"tutorial",[q.informational($localize`Goal of the game`,$localize`The goal at Siam is to be the first to push a mountain out of the board.
        The initial board contains three mountains, and no pieces are initially on the board.
        During its turn, a player can do one of the following actions:
        <ol>
            <li>Put a new piece on the board.</li>
            <li>Change the orientation of one of its piece</li>
            <li>Move one of its piece and optionally reorient it.</li>
            <li>Take one of its pieces out of the board.</li>
        </ol>`,O1.getInitialState()),q.anyMove($localize`Inserting a piece`,$localize`Each player has 5 pieces in total.
        As long as you have remaining pieces next to the board, you can insert new pieces. To do so:
        <ol>
            <li>Click on one of your pieces from your reserve, next to board.</li>
            <li>Click on one of the highlighted squares to select a landing for your piece.</li>
            <li>Select an orientation for your piece by clicking on one of the arrows that appear on top of the board.</li>
        </ol><br/>
        You're playing Dark, insert a piece on the board.`,O1.getInitialState(),Gs.from(2,-1,g.of(ze.DOWN),ze.DOWN).get(),$localize`Congratulations!`),q.fromMove($localize`Moving a piece`,$localize`We will distinguish here "moving" and "pushing".
        A move is made from a piece's square to an empty neighboring square, horizontally or vertically.
        You can also move a piece out of the board.
        To move a piece:
        <ol>
            <li>Click on it.</li>
            <li>Click on the square on which you want the piece to move.
                You can also click a second time on your piece to change its orientation without moving it.</li>
            <li>Select the orientation of your piece by clicking one one of the arrows that appear on top of the board.</li>
        </ol><br/>
        You're playing Dark. Try to move your piece that is already on the board one square upwards and to orient it to the left.`,new O1([[ke,ke,ke,ke,ke],[ke,ke,ke,ke,ke],[ke,Co,Co,Co,ke],[ke,ke,ke,ke,ke],[ke,ke,rR,ke,ke]],0),[Gs.from(2,4,g.of(ze.UP),ze.LEFT).get()],$localize`Congratulations, you made a side-slip!`,$localize`Failed. Try again.`),q.fromMove($localize`Moving a piece out of the board`,$localize`To move a piece out of the board, you do not have to pick an orientation after the move.<br/><br/>
        You're playing Dark, get that piece out of the board!`,new O1([[ke,ke,ke,ke,ke],[ke,ke,ke,ke,ke],[ke,Co,Co,Co,ke],[ke,ke,ke,ke,ke],[ke,ke,rR,ke,ke]],0),[Gs.from(2,4,g.of(ze.DOWN),ze.DOWN).get()],$localize`Congratulations, even if in this context it was not a useful move.`,$localize`Failed, the piece is still on the board.`),q.fromMove($localize`Pushing (1/2)`,$localize`When the landing square of your move is occupied, we use the term "push".
        In order to push player pieces, the following conditions must hold:
        <ol>
            <li>Your piece must already be oriented in the direction of the push.</li>
            <li>Along the line that you are pushing, the number of pieces (yours or your opponent's) that are oriented in the same way as the push should be strictly greater than the number of pieces oriented in the opposite way.</li>
        </ol>
        Look closely at the board. On the first row, you cannot push as there is exactly one piece in the opposite direction.
        On the second row, you can push because there are two pieces against one.<br/><br/>
        You're playing Dark. Vertically, you can push using your piece in the center, as there is no resistance on that axis. Do it.`,new O1([[ke,wu,F3e,ke,ke],[wu,$3e,iR,ke,ke],[ke,ke,rR,ke,ke],[ke,ke,ke,ke,ke],[ke,ke,ke,ke,ke]],0),[Gs.from(2,2,g.of(ze.UP),ze.UP).get()],$localize`Congratulations!`,$localize`Failed. Try again.`),q.fromMove($localize`Pushing (2/2)`,$localize`To be able to push a mountain, you need at least one pusher per mountain. Each resistant (pieces in the opposite way) cancel the force of one pusher.
        In short, if there is no mountain, you need strictly more pushers than resistants. If there is a mountain, you need at least as much pushers than there are resistants and mountains.
        On the following board, as Dark, you can push the mountain on the first row.
        On the second and third row, because of the resisting forces, you cannot push.
        On the fourth row, you can push as there is one more pusher than resistant pieces.<br/><br/>
        You're playing Dark, push on the fourth row it.`,new O1([[ke,ke,wu,Co,ke],[ke,ke,wu,Co,iR],[ke,wu,Co,Co,ke],[ke,wu,$3e,F3e,Co],[ke,ke,ke,ke,ke]],0),[Gs.from(1,3,g.of(ze.RIGHT),ze.RIGHT).get()],$localize`Congratulations! Note that this move made you lose the game, you will see why in the next step.`,$localize`Failed. Try again.`),q.fromMove($localize`Victory`,$localize`The game ends when a mountain is pushed out of the board.
        If you pushed it and nobody is in front of you, you're the winner.
        However, if you were pushing an opponent oriented in the same direction as you, your opponent will win because that piece is closer to the mountain.
        However, if that opponent is closer to the mountain but not oriented towards it, victory will be yours.<br/><br/>
        Here, playing Dark, you can push a mountain off the board and either win, or lose. Choose correctly!`,new O1([[ke,ke,ke,ke,ke],[ke,ke,ke,ke,ke],[Co,Gmt,iR,ke,$mt],[ke,ke,ke,ke,Bmt],[ke,ke,ke,ke,Co]],0),[Gs.from(2,2,g.of(ze.LEFT),ze.LEFT).get()],$localize`Congratulations, you won!`,$localize`Failed, you lost.`)])}}class B3e extends Un{getListMoves(e){let t=[];const n=e.gameState.getCurrentPlayer();for(const i of e.gameState.getCoordsAndContents()){const s=i.content;s.belongTo(n)&&(t=t.concat(Bs.get().getMovesFrom(e.gameState,s,i.coord.x,i.coord.y)))}if(e.gameState.countCurrentPlayerPawn()<5)for(const i of Bs.get().getInsertions(e.gameState))if(i.direction.get().getOpposite()!==i.landingOrientation){if(this.isOnBorder(i)&&i.direction.get()!==i.landingOrientation)continue;t.push(i)}return t}isOnBorder(e){return 0===e.coord.x||4===e.coord.x||0===e.coord.y||4===e.coord.y}}class Umt extends wa{getBoardValue(e){const t=this.getBoardValueInfo(e.gameState);return new Jn(t.boardValue)}getBoardValueInfo(e){const t=Bs.get().getMountainsRowsAndColumns(e),n=t.rows,i=t.columns,s=Bs.get().getPushers(e,i,n);let o=Number.MAX_SAFE_INTEGER,a=Number.MAX_SAFE_INTEGER;const c=e.getCurrentPlayer();for(const f of s)O1.isOnBoard(f.coord)?e.getPieceAt(f.coord).belongTo(k.ZERO)?o=Math.min(o,f.distance):a=Math.min(a,f.distance):c===k.ZERO?o=Math.min(o,f.distance):a=Math.min(a,f.distance);return{shortestZero:o,shortestOne:a,boardValue:Bs.get().getScoreFromShortestDistances(o,a,c)}}}class Wmt extends on{constructor(){super($localize`Minimax`,Bs.get(),new Umt,new B3e)}}var Au;function jmt(r,e){if(1&r){const t=pe();N(),S(0,"use",11),W("click",function(){te(t);const i=p().index,s=p().index;return ne(p().clickSquare(i,s))}),P()}if(2&r){const t=p(),n=t.index,i=t.$implicit,s=p().index,o=p();ye("id","piece_",n,"_",s,""),y("ngClass",o.getPieceClasses(n,s,i)),I("transform",o.getPieceTransform(n,s))}}function Zmt(r,e){if(1&r){const t=pe();N(),S(0,"use",12),W("click",function(){te(t);const i=p().index,s=p().index;return ne(p().clickSquare(i,s))}),P()}if(2&r){const t=p().index,n=p().index,i=p();I("transform","translate("+(t+1)*i.SPACE_SIZE+" "+(n+1)*i.SPACE_SIZE+")")}}function Ymt(r,e){if(1&r){const t=pe();N(),S(0,"g")(1,"rect",8),W("click",function(){const s=te(t).index,o=p().index;return ne(p().clickSquare(s,o))}),P(),T(2,jmt,1,4,"use",9),T(3,Zmt,1,1,"use",10),P()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,s=p();_(1),ye("id","square_",n,"_",i,""),y("ngClass",s.getSquareClasses(n,i)),I("x",s.SPACE_SIZE*(n+1))("y",s.SPACE_SIZE*(i+1))("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),_(1),y("ngIf",t.isPiece()),_(1),y("ngIf",s.isMountain(t))}}function Kmt(r,e){if(1&r&&(N(),S(0,"g"),T(1,Ymt,4,9,"g",4),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function Xmt(r,e){if(1&r){const t=pe();N(),S(0,"rect",15),W("click",function(){te(t);const i=p().$implicit;return ne(p().clickSquare(i.x,i.y))}),P()}if(2&r){const t=p().$implicit,n=p();ye("id","square_",t.x,"_",t.y,""),y("ngClass",n.getSquareClasses(t.x,t.y)),I("x",n.SPACE_SIZE*(t.x+1))("y",n.SPACE_SIZE*(t.y+1))("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}function Qmt(r,e){if(1&r){const t=pe();N(),S(0,"g"),T(1,Xmt,1,7,"rect",13),S(2,"rect",14),W("click",function(){const s=te(t).$implicit;return ne(p().clickSquare(s.x,s.y))}),P()()}if(2&r){const t=e.$implicit,n=p();_(1),y("ngIf",!1===n.SiamState.isOnBoard(t)),_(1),I("x",n.SPACE_SIZE*(t.x+1))("y",n.SPACE_SIZE*(t.y+1))("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}function Jmt(r,e){if(1&r){const t=pe();N(),S(0,"rect",16),W("click",function(){te(t);const i=p();return ne(i.clickSquare(i.selectedLanding.get().x,i.selectedLanding.get().y))}),P()}if(2&r){const t=p();I("x",t.SPACE_SIZE*(t.selectedLanding.get().x+1))("y",t.SPACE_SIZE*(t.selectedLanding.get().y+1))("width",t.SPACE_SIZE)("height",t.SPACE_SIZE)}}function e_t(r,e){if(1&r){const t=pe();N(),S(0,"rect",16),W("click",function(){te(t);const i=p();return ne(i.clickSquare(i.selectedPiece.get().x,i.selectedPiece.get().y))}),P()}if(2&r){const t=p();I("x",t.SPACE_SIZE*(t.selectedPiece.get().x+1))("y",t.SPACE_SIZE*(t.selectedPiece.get().y+1))("width",t.SPACE_SIZE)("height",t.SPACE_SIZE)}}function t_t(r,e){if(1&r&&(N(),F(0,"use",19)),2&r){const t=e.$implicit,n=p().$implicit,i=p();ye("id","remainingPieces_",n.value,"_",t,""),y("ngClass",i.getRemainingPieceClasses(n,t)),I("transform",i.getRemainingPieceTransform(t,n))}}function n_t(r,e){if(1&r){const t=pe();N(),S(0,"g",17),W("click",function(){const s=te(t).$implicit;return ne(p().selectPieceForInsertion(s))}),T(1,t_t,1,4,"use",18),P()}if(2&r){const t=e.$implicit,n=p();zn("id","remainingPieces_",t.value,""),_(1),y("ngForOf",n.ArrayUtils.range(n.playerPieces(t)))}}function r_t(r,e){if(1&r){const t=pe();N(),S(0,"use",22),W("click",function(){te(t);const i=p().$implicit;return ne(p().clickSquare(i.source.get().coord.x,i.source.get().coord.y))}),P()}if(2&r){const t=p().$implicit,n=p();y("ngClass",n.getPieceClasses(t.source.get().coord.x,t.source.get().coord.y,t.source.get().piece)),I("transform",n.getPieceTransform(t.source.get().coord.x,t.source.get().coord.y))}}function i_t(r,e){if(1&r){const t=pe();N(),S(0,"g")(1,"use",20),W("click",function(){const s=te(t).$implicit;return ne(p().clickArrow(s))}),P(),T(2,r_t,1,2,"use",21),P()}if(2&r){const t=e.$implicit,n=p();_(1),wi("id","indicator_",t.target.x,"_",t.target.y,"_",t.direction.toString(),""),I("transform",n.getIndicatorTransform(t)),_(1),y("ngIf",t.source.isPresent())}}function s_t(r,e){if(1&r){const t=pe();N(),S(0,"use",23),W("click",function(){const s=te(t).$implicit;return ne(p().selectOrientation(s))}),P()}if(2&r){const t=e.$implicit,n=p();zn("id","orientation_",t.landingOrientation,""),y("ngClass",n.getCurrentPlayerClass()),I("transform",n.getOrientationTransform(t.landingOrientation))}}let sR=(Au=class extends Fi{constructor(e){super(e),u(this,"SiamState",O1),u(this,"lastMove",g.empty()),u(this,"movedPieces",[]),u(this,"selectedPiece",g.empty()),u(this,"selectedLanding",g.empty()),u(this,"orientations",[]),u(this,"clickableCoords",new dt),u(this,"indicatorArrows",[]),u(this,"insertingPiece",!1),this.rules=Bs.get(),this.node=this.rules.getInitialNode(),this.availableAIs=[new Wmt,new Kn($localize`MCTS`,new B3e,this.rules)],this.encoder=Gs.encoder,this.tutorial=(new G3e).tutorial}updateBoard(e){var t=this;return M(function*(){const n=t.getState();t.board=n.board,t.movedPieces=[]})()}showLastMove(e){var t=this;return M(function*(){t.lastMove=g.of(e);const n=t.getPreviousState();t.movedPieces=t.rules.isLegal(t.lastMove.get(),n).get().moved})()}cancelMoveAttempt(){this.insertingPiece=!1,this.selectedPiece=g.empty(),this.selectedLanding=g.empty(),this.orientations=[],this.clickableCoords=new dt,this.indicatorArrows=[]}selectPieceForInsertion(e){var t=this;return M(function*(){const n=yield t.canUserPlay("#remainingPieces_"+e.value);if(n.isFailure())return t.cancelMove(n.getReason());if(e!==t.getCurrentPlayer())return t.cancelMove(Re.MUST_CHOOSE_PLAYER_PIECE());if(t.insertingPiece)return t.cancelMoveAttempt(),b.SUCCESS;t.cancelMoveAttempt();for(const i of Bs.get().getInsertions(t.getState())){const s=i.coord.getNext(i.direction.get());if(t.board[s.y][s.x]!==ut.EMPTY){const o={source:g.empty(),target:s,direction:i.direction.get(),move:i};t.indicatorArrows.push(o)}t.clickableCoords.add(s)}return t.insertingPiece=!0,b.SUCCESS})()}selectOrientation(e){var t=this;return M(function*(){const n=yield t.canUserPlay("#orientation_"+e.landingOrientation.toString());return n.isFailure()?t.cancelMove(n.getReason()):t.chooseMove(e)})()}clickSquare(e,t,n=!1){var i=this;return M(function*(){if(!1===n){const o=yield i.canUserPlay("#square_"+e+"_"+t);if(o.isFailure())return i.cancelMove(o.getReason())}const s=new C(e,t);if(i.insertingPiece)return i.insertPiece(s);if(i.selectedLanding.isPresent())return i.cancelMoveAttempt(),b.SUCCESS;if(i.selectedPiece.isPresent()){i.selectedLanding=g.of(s);const o=Bs.get().getMovesBetween(i.getState(),i.getState().getPieceAt(i.selectedPiece.get()),i.selectedPiece.get(),s);return 0===o.length?i.changeMoveDestinationClick(s):i.performMoveOrShowOrientationArrows(o)}{U.assert(i.getState().isOnBoard(s),"SiamComponent: user clicked outside of board when it should not be possible");const o=i.board[t][e];return o.getOwner()!==i.getCurrentPlayer()?i.cancelMove(Re.MUST_CHOOSE_PLAYER_PIECE()):i.selectPiece(s,o)}})()}insertPiece(e){var t=this;return M(function*(){if(t.selectedLanding.isPresent())return yield t.cancelMove(Ou.MUST_SELECT_ORIENTATION()),b.SUCCESS;t.selectedLanding=g.of(e);const n=Bs.get().getInsertionsAt(t.getState(),e.x,e.y);return 0===n.length?t.changeMoveDestinationClick(e):t.performMoveOrShowOrientationArrows(n)})()}changeMoveDestinationClick(e){var t=this;return M(function*(){return t.cancelMoveAttempt(),t.getState().getPieceAt(e).getOwner()===t.getCurrentPlayer()?t.clickSquare(e.x,e.y,!0):t.cancelMove(Ou.MUST_SELECT_VALID_DESTINATION())})()}performMoveOrShowOrientationArrows(e){var t=this;return M(function*(){return U.assert(e.length>0,"SiamComponent.performMoveOrShowOrientationArrows expects at least one move"),1===e.length?t.chooseMove(e[0]):(t.clickableCoords=new dt,t.indicatorArrows=[],t.orientations=e,b.SUCCESS)})()}selectPiece(e,t){this.cancelMoveAttempt();const n=this.getState();this.selectedPiece=g.of(e);const i=Bs.get().getMovesFrom(n,t,e.x,e.y);for(const s of i)if(s.direction.isPresent()){const o=s.coord.getNext(s.direction.get());if(this.clickableCoords.add(o),n.isOnBoard(o)&&n.getPieceAt(o)!==ut.EMPTY){const a={source:g.of({coord:e,piece:t}),target:o,direction:s.direction.get(),move:s};this.indicatorArrows.push(a)}}else this.clickableCoords.add(s.coord);return b.SUCCESS}clickArrow(e){var t=this;return M(function*(){const n=yield t.canUserPlay("#indicator_"+e.target.x+"_"+e.target.y+"_"+e.move.landingOrientation);return n.isFailure()?t.cancelMove(n.getReason()):t.chooseMove(e.move)})()}isMountain(e){return e===ut.MOUNTAIN}getArrowTransform(e,t,n){const s=`rotate(${90*(n.toInt()-2)} ${this.SPACE_SIZE/2} ${this.SPACE_SIZE/2})`;return["translate("+e*this.SPACE_SIZE+", "+t*this.SPACE_SIZE+")",s].join(" ")}getPieceTransform(e,t){return this.getArrowTransform(e+1,t+1,this.board[t][e].getDirection())}getIndicatorTransform(e){const t=e.target.getPrevious(e.direction,.5);return this.getArrowTransform(t.x+1,t.y+1,e.direction)}getRemainingPieceTransform(e,t){const n=this.playerPieces(t);let a,c,o=2;return t===k.ONE?(o+=(n-e+(5-n)/2)/3,a=-1,c=ze.RIGHT):(o+=(e+1+(5-n)/2)/3,a=7,c=ze.LEFT),this.getArrowTransform(o,a,c)}getOrientationTransform(e){const t=`translate(0, ${this.SPACE_SIZE/1.6})`,i=`rotate(${90*(e.toInt()-2)} ${this.SPACE_SIZE/2} ${this.SPACE_SIZE/2})`;return[`translate(${2.27*this.SPACE_SIZE}, ${2.27*this.SPACE_SIZE})`,"scale(2.43)",i,t].join(" ")}getPieceClasses(e,t,n){const i=new C(e,t),s=[this.getPlayerClass(n.getOwner())];return this.selectedPiece.equalsValue(i)&&s.push("selected-stroke"),s}getSquareClasses(e,t){const n=new C(e,t);return this.movedPieces.some(i=>i.equals(n))?["moved-fill"]:[]}getRemainingPieceClasses(e,t){const n=[this.getPlayerClass(e)];return this.insertingPiece&&this.getCurrentPlayer()===e&&t===this.playerPieces(e)-1&&n.push("selected-stroke"),n}getCurrentPlayerClass(){return this.getPlayerClass(this.getCurrentPlayer())}playerPieces(e){return 5-this.getState().countPlayersPawn()[e.value]}},u(Au,"\u0275fac",function(e){return new(e||Au)(B(Ut))}),u(Au,"\u0275cmp",qe({type:Au,selectors:[["app-siam"]],features:[Qe],decls:12,vars:7,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","0 -100 700 900","preserveAspectRatio","xMidYMid meet"],["id","triangle","points","0 -6, 10 0, 0 6"],["id","arrow","points","30 7, 30 50, 10 50, 50 90, 90 50, 70 50, 70 7"],["id","mountain","points","5 95, 16 68, 24 76, 48 28, 64 60, 72 44, 95 95, 5 95"],[4,"ngFor","ngForOf"],["class","base no-fill small-stroke selected-stroke",3,"click",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],["class","base mid-stroke semi-transparent",0,"xlink","href","#arrow",3,"id","ngClass","click",4,"ngFor","ngForOf"],[1,"base",3,"id","ngClass","click"],["class","base mid-stroke",0,"xlink","href","#arrow",3,"id","ngClass","click",4,"ngIf"],[0,"xlink","href","#mountain","class","nonplayer-fill",3,"click",4,"ngIf"],[0,"xlink","href","#arrow",1,"base","mid-stroke",3,"id","ngClass","click"],[0,"xlink","href","#mountain",1,"nonplayer-fill",3,"click"],["class","base semi-transparent",3,"id","ngClass","click",4,"ngIf"],[1,"base","no-fill","small-stroke","clickable-stroke",3,"click"],[1,"base","semi-transparent",3,"id","ngClass","click"],[1,"base","no-fill","small-stroke","selected-stroke",3,"click"],[3,"id","click"],["class","base mid-stroke",0,"xlink","href","#arrow",3,"id","ngClass",4,"ngFor","ngForOf"],[0,"xlink","href","#arrow",1,"base","mid-stroke",3,"id","ngClass"],[0,"xlink","href","#arrow",1,"base","mid-stroke","indicator-fill",3,"id","click"],["class","base mid-stroke",0,"xlink","href","#arrow",3,"ngClass","click",4,"ngIf"],[0,"xlink","href","#arrow",1,"base","mid-stroke",3,"ngClass","click"],[0,"xlink","href","#arrow",1,"base","mid-stroke","semi-transparent",3,"id","ngClass","click"]],template:function(e,t){1&e&&(N(),S(0,"svg",0)(1,"defs"),F(2,"polygon",1)(3,"polygon",2)(4,"polygon",3),P(),T(5,Kmt,2,1,"g",4),T(6,Qmt,3,5,"g",4),T(7,Jmt,1,4,"rect",5),T(8,e_t,1,4,"rect",5),T(9,n_t,2,2,"g",6),T(10,i_t,3,5,"g",4),T(11,s_t,1,3,"use",7),P()),2&e&&(_(5),y("ngForOf",t.board),_(1),y("ngForOf",t.clickableCoords),_(1),y("ngIf",t.selectedLanding.isPresent()),_(1),y("ngIf",t.selectedPiece.isPresent()),_(1),y("ngForOf",t.Player.PLAYERS),_(1),y("ngForOf",t.indicatorArrows),_(1),y("ngForOf",t.orientations))},dependencies:[Ft,Wt,At],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),Au);var U3e;sR=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ne.log],sR);class mr extends Di{static of(e,t,n){return new mr(e,t,n)}static ofDrop(e){return new mr(g.empty(),e,g.empty())}static ofMovement(e,t){return new mr(g.of(e),t,g.empty())}static ofCut(e,t,n){return new mr(g.of(e),t,g.of(n))}constructor(e,t,n){super(),u(this,"start",void 0),u(this,"landing",void 0),u(this,"keep",void 0),this.start=e,this.landing=t,this.keep=n,U.assert(!1===e.equalsValue(t),"Deplacement cannot be static!"),U.assert(e.isAbsent()||!1===e.equals(n),"Cannot keep starting coord, since it will always be empty after move!")}isDrop(){return this.start.isAbsent()}isCut(){return this.keep.isPresent()}toString(){return this.isDrop()?"SixMove("+this.landing.toString()+")":this.isCut()?"SixMove("+this.start.get().toString()+" > "+this.landing+", keep: "+this.keep.get().toString()+")":"SixMove("+this.start.get().toString()+" > "+this.landing+")"}equals(e){return!1!==this.landing.equals(e.landing)&&!1!==this.start.equals(e.start)&&this.keep.equals(e.keep)}}U3e=mr,u(mr,"encoder",we.tuple([g.getEncoder(C.encoder),C.encoder,g.getEncoder(C.encoder)],r=>[r.start,r.landing,r.keep],r=>U3e.of(r[0],r[1],r[2])));let Ya=(()=>{class r{}return u(r,"NO_MOVEMENT_BEFORE_TURN_40",()=>$localize`You cannot move yet. Pick a space where you will put a new piece.`),u(r,"MUST_CUT",()=>$localize`Several groups are of the same size, you must pick the one to keep.`),u(r,"CANNOT_CHOOSE_TO_KEEP",()=>$localize`You cannot choose which part to keep when one is smaller than the other.`),u(r,"CAN_NO_LONGER_DROP",()=>$localize`You cannot put new pieces anymore. Pick a piece to move.`),u(r,"MUST_CAPTURE_BIGGEST_GROUPS",()=>$localize`You must choose one of the biggest groups to keep it.`),u(r,"CANNOT_KEEP_EMPTY_COORD",()=>$localize`You cannot pick an empty space. Pick one of the biggest groups.`),u(r,"MUST_DROP_NEXT_TO_OTHER_PIECE",()=>$localize`You must put this piece next to another piece.`),r})();class ji extends Lce{static getInitialState(){return ji.ofRepresentation([[k.ZERO],[k.ONE]],0)}static ofRepresentation(e,t,n=new St(0,0)){const i=new ru;for(let s=0;s<e.length;s++)for(let o=0;o<e[0].length;o++)if(e[s][o]!==K.NONE){const a=new C(o,s).getNext(n);i.set(a,e[s][o])}return new ji(i,t)}movePiece(e){const t=this.pieces.getCopy();return t.delete(e.start.get()),t.set(e.landing,this.getCurrentPlayer()),new ji(t,this.turn)}toRepresentation(){const e=Ie.createTable(this.width,this.height,K.NONE);for(const t of this.pieces.listKeys()){const n=this.getPieceAt(t);e[t.y][t.x]=n}return e}isIllegalLandingZone(e,t){return this.pieces.containsKey(e)?b.failure(Re.MUST_LAND_ON_EMPTY_SPACE()):this.isCoordConnected(e,t)?b.SUCCESS:b.failure(Ya.MUST_DROP_NEXT_TO_OTHER_PIECE())}isCoordConnected(e,t){for(const n of m2.getNeighbors(e))if(this.pieces.containsKey(n)&&!1===t.equalsValue(n))return!0;return!1}getPieceAt(e){return this.isOnBoard(e)?this.pieces.get(e).get():K.NONE}applyLegalDrop(e){const t=this.pieces.getCopy();return t.put(e,this.getCurrentPlayer()),new ji(t,this.turn+1)}applyLegalDeplacement(e,t){const n=this.movePiece(e);if(t.size()>0){const i=new ru;for(const s of t)i.set(s,n.getPieceAt(s));return new ji(i,this.turn+1)}return new ji(n.pieces,this.turn+1)}countPieces(){const e=this.pieces.reverse(),t=e.get(k.ZERO).getOrElse(new q1),n=e.get(k.ONE).getOrElse(new q1);return[t.size(),n.size()]}switchPiece(e){const t=this.pieces.getCopy(),n=this.getPieceAt(e);if(n.isPlayer())return t.replace(e,n.getOpponent()),new ji(t,this.turn);d2.logErrorAndFail("SixState","Cannot switch piece if there is no piece!",{coord:e.toString()})}equals(e){return this.turn===e.turn&&this.pieces.equals(e.pieces)}}var WC,zl;let Jc=(WC=class extends Yn{static get(){return zl.singleton.isAbsent()&&(zl.singleton=g.of(new zl)),zl.singleton.get()}constructor(){super(ji),u(this,"currentVictorySource",void 0)}applyLegalMove(e,t,n){return t.turn<40?t.applyLegalDrop(e.landing):t.applyLegalDeplacement(e,n)}isLegal(e,t){const n=t.isIllegalLandingZone(e.landing,e.start);return n.isFailure()?n.toOtherFallible():t.turn<40?this.isLegalDrop(e,t):zl.isLegalPhaseTwoMove(e,t)}static getLegalLandings(e){const t=new q1;for(const n of e.getPieceCoords())for(const i of be.factory.all){const s=n.getNext(i,1);e.getPieceAt(s)===K.NONE&&t.add(s)}return t.toList()}isLegalDrop(e,t){return!1===e.isDrop()?ie.failure(Ya.NO_MOVEMENT_BEFORE_TURN_40()):ie.success(new dt(t.getPieceCoords()))}static isLegalPhaseTwoMove(e,t){if(e.isDrop())return ie.failure(Ya.CAN_NO_LONGER_DROP());const n=t.getPieceAt(e.start.get());if(n===K.NONE)return ie.failure(Re.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(n===t.getCurrentOpponent())return ie.failure(Re.CANNOT_CHOOSE_OPPONENT_PIECE());const i=t.movePiece(e),s=i.getGroups();if(zl.isSplit(s)){const o=this.getLargestGroups(s);return 1===o.size()?e.keep.isPresent()?ie.failure(Ya.CANNOT_CHOOSE_TO_KEEP()):ie.success(o.getAnyElement().get()):this.moveKeepBiggerGroup(e.keep,o,i)}return ie.success(new q1)}static isSplit(e){return e.size()>1}static getLargestGroups(e){let t=0,n=new dt;for(const i of e){const s=i.size();s>t?(t=s,n=new dt([i])):s===t&&n.add(i)}return n}static moveKeepBiggerGroup(e,t,n){if(e.isAbsent())return ie.failure(Ya.MUST_CUT());if(n.getPieces().get(e.get()).isAbsent())return ie.failure(Ya.CANNOT_KEEP_EMPTY_COORD());const i=e.get();for(const s of t)if(s.contains(i))return ie.success(s);return ie.failure(Ya.MUST_CAPTURE_BIGGEST_GROUPS())}getGameStatus(e){const t=e.gameState,n=t.getCurrentOpponent();let i=[];if(e.previousMove.isPresent()&&(i=this.getShapeVictory(e.previousMove.get(),t)),6===i.length)return _e.getVictory(n);if(t.turn>39){const s=t.countPieces(),o=s[0],a=s[1];return o<6&&a<6?o<a?_e.ONE_WON:a<o?_e.ZERO_WON:_e.DRAW:o<6?_e.getDefeat(k.ZERO):a<6?_e.getDefeat(k.ONE):_e.ONGOING}return _e.ONGOING}startSearchingVictorySources(){this.currentVictorySource={typeSource:"LINE",index:-1}}getShapeVictory(e,t){for(this.startSearchingVictorySources();this.hasNextVictorySource();){this.getNextVictorySource();const n=this.searchVictoryOnly(this.currentVictorySource,e,t);if(6===n.length)return n}return[]}hasNextVictorySource(){return"CIRCLE"!==this.currentVictorySource.typeSource||5!==this.currentVictorySource.index}getNextVictorySource(){if(5===this.currentVictorySource.index){let t;switch(this.currentVictorySource.typeSource){case"LINE":t="TRIANGLE_CORNER";break;case"TRIANGLE_CORNER":t="TRIANGLE_EDGE";break;default:t="CIRCLE"}this.currentVictorySource={typeSource:t,index:0}}else{let t=1;"LINE"===this.currentVictorySource.typeSource&&(t=2),this.currentVictorySource={typeSource:this.currentVictorySource.typeSource,index:this.currentVictorySource.index+t}}return this.currentVictorySource}searchVictoryOnly(e,t,n){const i=t.landing;switch(e.typeSource){case"LINE":return this.searchVictoryOnlyForLine(e.index,i,n);case"CIRCLE":return this.searchVictoryOnlyForCircle(e.index,i,n);case"TRIANGLE_CORNER":return this.searchVictoryOnlyForTriangleCorner(e.index,i,n);default:return this.searchVictoryOnlyForTriangleEdge(e.index,i,n)}}searchVictoryOnlyForCircle(e,t,n){const i=n.getCurrentOpponent(),o=[t];let a=t.getNext(be.factory.all[e],1);for(;o.length<6;){if(n.getPieceAt(a)!==i)return[];const l=(e+o.length)%6;o.push(a),a=a.getNext(be.factory.all[l],1)}return o}searchVictoryOnlyForLine(e,t,n){const i=n.getCurrentOpponent();let s=be.factory.all[e],o=t.getNext(s,1);const a=[t];let c=!1;for(;a.length<6;){if(n.getPieceAt(o)===i)a.push(o);else{if(c)return[];c=!0,s=s.getOpposite(),o=o.getNext(s,a.length)}o=o.getNext(s,1)}return a}searchVictoryOnlyForTriangleCorner(e,t,n){const i=n.getCurrentOpponent();let s=be.factory.all[e];const o=[t];let a=t.getNext(s,1);for(;o.length<6;){if(n.getPieceAt(a)!==i)return[];o.length%2==0&&(s=be.factory.all[(e+o.length)%6]),o.push(a),a=a.getNext(s,1)}return o}searchVictoryOnlyForTriangleEdge(e,t,n){const i=n.getCurrentOpponent();let s=be.factory.all[e];const o=[t];let a=t.getNext(s,1);for(;o.length<6;){if(n.getPieceAt(a)!==i)return[];o.push(a),o.length%2==0&&(s=be.factory.all[(e+o.length)%6]),a=a.getNext(s,1)}return o}},zl=WC,u(WC,"singleton",g.empty()),WC);Jc=zl=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ne.log],Jc);const ue=K.NONE,Tt=k.ZERO,It=k.ONE;let oR=(()=>{class r{}return u(r,"MOVEMENT_NOT_DISCONNECTING",()=>$localize`This move does not disconnect your opponent's pieces. Try again with another piece.`),u(r,"MOVEMENT_SELF_DISCONNECTING",()=>$localize`You lost one of your pieces during this move. There is a way to disconnect an opponent's piece without losing any of yours, try again!`),r})();class W3e extends Zn{constructor(...e){super(...e),u(this,"tutorial",[q.informational($localize`Six`,$localize`Six is a game without board, where pieces are placed on the side of each other, in a contiguous block.
        Each player has 21 pieces, with one for each player already on the board.
        The goal of the game is to form one of the three winning shapes with your pieces.`,ji.getInitialState()),q.fromMove($localize`Victory (line)`,$localize`On this board, by putting your piece at the right place, you can align six of your pieces and win the game<br/><br/>
        Find the victory. You're playing Dark.`,ji.ofRepresentation([[Tt,It,It,It,It,Tt],[ue,Tt,It,ue,Tt,ue],[It,It,Tt,ue,ue,ue],[ue,ue,Tt,ue,ue,ue],[ue,Tt,ue,ue,ue,ue],[Tt,ue,ue,ue,ue,ue]],0),[mr.ofDrop(new C(3,2))],$localize`Congratulations!`,$localize`Failed. Try again.`),q.fromMove($localize`Victory (circle)`,$localize`On this board, by putting your piece at the right place, you can form a circle with six of your pieces and win the game.<br/><br/>
        Find the victory. You're playing Dark.`,ji.ofRepresentation([[ue,ue,ue,It,ue,ue],[ue,ue,It,It,Tt,Tt],[ue,It,ue,Tt,It,ue],[It,Tt,Tt,Tt,Tt,It]],0),[mr.ofDrop(new C(5,2))],$localize`Congratulations! Note that if a piece is inside the circle, it does not change anything.`,$localize`Failed. Try again.`),q.fromMove($localize`Victory (triangle)`,$localize`On this board, by putting your piece at the right place, you can form a triangle with six of your pieces and win the game.<br/><br/>
        Find the victory. You're playing Dark.`,ji.ofRepresentation([[ue,ue,ue,It,ue,ue],[ue,Tt,It,Tt,Tt,Tt],[ue,Tt,ue,Tt,Tt,ue],[It,It,It,ue,It,ue]],0),[mr.ofDrop(new C(3,3))],$localize`Congratulations!`,$localize`Failed. Try again.`),q.fromPredicate($localize`Second phase`,$localize`After 40 turns, your pieces have all been placed and we move on to the second phase of the game.
        You now have to move your pieces, paying attention not to remove a piece that was preventing the opponent's victory.
        From now on, if after move, on or more pieces are disconnected from the largest group of pieces, these will be taken out of the game.<br/><br/>
        You're playing Dark. Make a move that disconnects one of your opponent's pieces.`,ji.ofRepresentation([[ue,ue,ue,ue,ue,ue,ue,It,ue],[ue,ue,ue,ue,ue,ue,Tt,ue,ue],[ue,ue,ue,ue,Tt,Tt,Tt,ue,ue],[ue,ue,ue,ue,It,It,ue,It,Tt],[ue,Tt,It,It,Tt,Tt,It,ue,ue],[Tt,Tt,Tt,Tt,It,It,It,Tt,ue],[It,It,Tt,ue,It,It,Tt,ue,ue],[ue,Tt,ue,Tt,Tt,ue,ue,ue,ue],[It,It,It,It,ue,ue,ue,ue,ue],[ue,Tt,ue,It,ue,ue,ue,ue,ue]],40),mr.ofMovement(new C(6,1),new C(5,1)),(t,n,i)=>{const s=i.countPieces();return 19===s[0]?18===s[1]?b.SUCCESS:b.failure(oR.MOVEMENT_NOT_DISCONNECTING()):b.failure(oR.MOVEMENT_SELF_DISCONNECTING())},$localize`Congratulations, your opponent now has one piece less and you're closer to victory!`),q.fromPredicate($localize`Victory by disconnection`,$localize`During the second phase of the game, on top of normal victories (line, circle, triangle), you can win by disconnection.
        If at any time, at least one player does not have enough pieces to win (less than 6), the game ends.
        The one with the most pieces wins. In case they both have the same number of pieces, it's a draw.<br/><br/>
        Here, you're playing Dark and you can win. Do it!`,ji.ofRepresentation([[ue,ue,ue,ue,ue,It],[ue,ue,ue,ue,Tt,It],[ue,ue,ue,It,Tt,Tt],[ue,ue,Tt,ue,It,Tt],[It,It,ue,ue,ue,Tt],[Tt,It,ue,ue,ue,ue],[Tt,ue,ue,ue,ue,ue]],40),mr.ofMovement(new C(2,3),new C(3,3)),(t,n,i)=>t.start.equalsValue(new C(2,3))?b.SUCCESS:b.failure(oR.MOVEMENT_NOT_DISCONNECTING()),$localize`Congratulations, you won!`),q.fromPredicate($localize`Special disconnection`,$localize`During a disconnection, two or more groups could have the same size,
        in which case you will have to click on the group you wish to keep.<br/><br/>
        You're playing Dark, play such a move!`,ji.ofRepresentation([[ue,ue,ue,ue,ue,It],[ue,ue,ue,ue,Tt,It],[ue,ue,ue,It,Tt,Tt],[Tt,ue,Tt,ue,ue,It],[It,It,ue,ue,ue,ue],[Tt,Tt,ue,ue,ue,ue],[Tt,ue,ue,ue,ue,ue]],40),mr.ofCut(new C(2,3),new C(2,5),new C(2,5)),(t,n,i)=>t.keep.isAbsent()?b.failure($localize`This move has not cut the board in two equal halves.`):i.getPieceAt(t.landing)===K.NONE?b.failure($localize`Failed. You did cut the board in two but you kept the half where you're in minority. Therefore, you lost! Try again.`):b.SUCCESS,$localize`Congratulations, you won!`)])}}class a_t extends wa{calculateBoardValue(e,t){this.startSearchingVictorySources();const n={status:o1.DEFAULT,victory:g.empty(),preVictory:g.empty(),sum:0};for(;this.hasNextVictorySource();){const i=this.getNextVictorySource();let s;if(s=n.status===o1.PRE_VICTORY?this.searchVictoryOnly(i,e,t):this.getBoardInfo(i,e,t,n),s.status===o1.VICTORY)return s;n.status=s.status,n.sum=n.sum+s.sum,n.preVictory.isAbsent()&&(n.preVictory=s.preVictory)}return n}}class q3e extends a_t{constructor(...e){super(...e),u(this,"VERBOSE",!1),u(this,"currentVictorySource",void 0)}getBoardValue(e){const t=e.previousMove,n=e.gameState,i=n.getCurrentOpponent(),s=i.getVictoryValue();let o={status:o1.DEFAULT,victory:g.empty(),preVictory:g.empty(),sum:0};if(t.isPresent()&&(o=this.calculateBoardValue(t.get(),n)),o.status===o1.VICTORY)return new Jn(s);if(n.turn>39){const a=n.countPieces();return new Jn(a[0]-a[1])}return new Jn(o.status===o1.PRE_VICTORY?i.getPreVictory():o.sum*i.getScoreModifier())}startSearchingVictorySources(){this.currentVictorySource={typeSource:"LINE",index:-1}}hasNextVictorySource(){return"CIRCLE"!==this.currentVictorySource.typeSource||5!==this.currentVictorySource.index}getNextVictorySource(){if(5===this.currentVictorySource.index){let t;switch(this.currentVictorySource.typeSource){case"LINE":t="TRIANGLE_CORNER";break;case"TRIANGLE_CORNER":t="TRIANGLE_EDGE";break;default:t="CIRCLE"}this.currentVictorySource={typeSource:t,index:0}}else{let t=1;"LINE"===this.currentVictorySource.typeSource&&(t=2),this.currentVictorySource={typeSource:this.currentVictorySource.typeSource,index:this.currentVictorySource.index+t}}return this.currentVictorySource}searchVictoryOnly(e,t,n){const i=t.landing;switch(e.typeSource){case"LINE":return this.searchVictoryOnlyForLine(e.index,i,n);case"CIRCLE":return this.searchVictoryOnlyForCircle(e.index,i,n);case"TRIANGLE_CORNER":return this.searchVictoryOnlyForTriangleCorner(e.index,i,n);default:return this.searchVictoryOnlyForTriangleEdge(e.index,i,n)}}searchVictoryOnlyForCircle(e,t,n){const i=n.getCurrentOpponent(),o=[t];let a=t.getNext(be.factory.all[e],1);for(;o.length<6;){if(n.getPieceAt(a)!==i)return{status:o1.PRE_VICTORY,victory:g.empty(),preVictory:g.empty(),sum:0};const l=(e+o.length)%6;o.push(a),a=a.getNext(be.factory.all[l],1)}return{status:o1.VICTORY,victory:g.of(o),preVictory:g.empty(),sum:0}}searchVictoryOnlyForLine(e,t,n){const i=n.getCurrentOpponent();let s=be.factory.all[e],o=t.getNext(s,1);const a=[t];let c=!1;for(;a.length<6;){if(n.getPieceAt(o)===i)a.push(o);else{if(c)return{status:o1.PRE_VICTORY,victory:g.empty(),preVictory:g.empty(),sum:0};c=!0,s=s.getOpposite(),o=o.getNext(s,a.length-1)}o=o.getNext(s,1)}return{status:o1.VICTORY,victory:g.of(a),preVictory:g.empty(),sum:0}}searchVictoryOnlyForTriangleCorner(e,t,n){const i=n.getCurrentOpponent();let s=be.factory.all[e];const o=[t];let a=t.getNext(s,1);for(;o.length<6;){if(n.getPieceAt(a)!==i)return{status:o1.PRE_VICTORY,victory:g.empty(),preVictory:g.empty(),sum:0};o.length%2==0&&(s=be.factory.all[(e+o.length)%6]),o.push(a),a=a.getNext(s,1)}return{status:o1.VICTORY,victory:g.of(o),preVictory:g.empty(),sum:0}}searchVictoryOnlyForTriangleEdge(e,t,n){const i=n.getCurrentOpponent();let s=be.factory.all[e];const o=[t];let a=t.getNext(s,1);for(;o.length<6;){if(n.getPieceAt(a)!==i)return{status:o1.PRE_VICTORY,victory:g.empty(),preVictory:g.empty(),sum:0};o.push(a),o.length%2==0&&(s=be.factory.all[(e+o.length)%6]),a=a.getNext(s,1)}return{status:o1.VICTORY,victory:g.of(o),preVictory:g.empty(),sum:0}}getBoardInfo(e,t,n,i){const s=t.landing;switch(e.typeSource){case"CIRCLE":return this.getBoardInfoForCircle(e.index,s,n,i);case"LINE":return this.getBoardInfoForLine(e.index,s,n,i);case"TRIANGLE_CORNER":return this.getBoardInfoForTriangleCorner(e.index,s,n,i);default:return this.getBoardInfoForTriangleEdge(e.index,s,n,i)}}getBoardInfoForCircle(e,t,n,i){const s=n.getCurrentPlayer(),a=[t];let c=t.getNext(be.factory.all[e],1),l=0,f=g.empty();for(;a.length<6;){const d=n.getPieceAt(c);if(d===s)return i;const m=(e+a.length)%6;a.push(c);const E=be.factory.all[m];d===K.NONE?(l+=.16,f=g.of(c)):l++,c=c.getNext(E,1)}return this.getBoardInfoResult(l,f,a,i)}getBoardInfoResult(e,t,n,i){let s=i.preVictory;if(4.16===e){if(s.isPresent()&&!1===s.equals(t))return{status:o1.PRE_VICTORY,victory:g.empty(),preVictory:g.empty(),sum:0};s=t}else if(5===e)return{status:o1.VICTORY,victory:g.of(n),preVictory:g.empty(),sum:0};return{status:i.status,victory:g.empty(),preVictory:s,sum:i.sum+e}}getBoardInfoForLine(e,t,n,i){const s=be.factory.all[e];let o=t.getPrevious(s,5),a=[],c=[],l=g.empty();for(let R=0;R<6;R++){const z=this.updateEncounterAndReturnLastEmpty(n,o,c);z.isPresent()&&(l=z),a.push(o),o=o.getNext(s,1)}let f=i.status,d=i.preVictory,m=0,E=0;for(;m<6;){const R=c.reduce(($,G)=>$+G);5.16===R&&f===o1.DEFAULT&&(d.isPresent()?(U.assert(!1===d.equals(l),"Impossible to have point aligned with different line to a same point"),f=o1.PRE_VICTORY):d=l),E=Math.max(E,R),a=a.slice(1,6),a.push(o),c=c.slice(1,6);const z=this.updateEncounterAndReturnLastEmpty(n,o,c);z.isPresent()&&(l=z),m++,o=o.getNext(s,1)}const w={status:f,victory:g.of(a),preVictory:d,sum:E};return this.getBoardInfoResult(E,l,a,w)}updateEncounterAndReturnLastEmpty(e,t,n){const i=e.getCurrentPlayer();switch(e.getPieceAt(t)){case i:return n.push(-7),g.empty();case K.NONE:return n.push(.16),g.of(t);default:return n.push(1),g.empty()}}getBoardInfoForTriangleCorner(e,t,n,i){const s=n.getCurrentPlayer();let o=be.factory.all[e];const a=[t];let c=t.getNext(o,1),l=0,f=g.empty();for(;a.length<6;){const d=n.getPieceAt(c);if(d===s)return i;d===K.NONE?(l+=.16,f=g.of(c)):l++,a.length%2==0&&(o=be.factory.all[(e+a.length)%6]),a.push(c),c=c.getNext(o,1)}return this.getBoardInfoResult(l,f,a,i)}getBoardInfoForTriangleEdge(e,t,n,i){const s=n.getCurrentPlayer();let o=be.factory.all[e];const a=[t];let c=t.getNext(o,1),l=0,f=g.empty();for(;a.length<6;){const d=n.getPieceAt(c);if(d===s)return i;d===K.NONE?(l+=.16,f=g.of(c)):l++,a.push(c),a.length%2==0&&(o=be.factory.all[(e+a.length)%6]),c=c.getNext(o,1)}return this.getBoardInfoResult(l,f,a,i)}}let qC=class extends Un{getListMoves(e){const t=Jc.getLegalLandings(e.gameState);return e.gameState.turn<40?this.getListDrops(t):this.getMovements(e.gameState,t)}getMovements(e,t){const n=e.getPieces().reverse(),i=e.getCurrentPlayer(),s=n.get(i).get();return this.getMovementsFrom(e,s,t)}getMovementsFrom(e,t,n){const i=[];for(const s of t)for(const o of n){const a=mr.ofMovement(s,o);if(e.isCoordConnected(o,g.of(s))){const l=e.movePiece(a).getGroups();if(Jc.isSplit(l)){const f=Jc.getLargestGroups(l);if(1===f.size())i.push(mr.ofMovement(s,o));else for(const d of f){const m=d.getAnyElement().get(),E=mr.ofCut(s,o,m);i.push(E)}}else i.push(a)}}return i}getListDrops(e){const t=[];for(const n of e){const i=mr.ofDrop(n);t.push(i)}return t}};qC=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ne.log],qC);class l_t extends qC{constructor(...e){super(...e),u(this,"heuristic",new q3e)}getMovements(e,t){const n=this.getSafelyMovablePieceOrFirstOne(e);return this.getMovementsFrom(e,n,t)}getSafelyMovablePieceOrFirstOne(e){const t=e.getPieces().reverse(),n=e.getCurrentPlayer(),i=t.get(n).get(),s=i.getAnyElement().get(),o=[];for(const a of i)!1===this.isPieceBlockingAVictory(e,a)&&o.push(a);return new q1(0===o.length?[s]:o)}isPieceBlockingAVictory(e,t){const n=e.switchPiece(t),i=mr.ofDrop(t);for(this.heuristic.startSearchingVictorySources();this.heuristic.hasNextVictorySource();)if(this.heuristic.currentVictorySource=this.heuristic.getNextVictorySource(),this.heuristic.searchVictoryOnly(this.heuristic.currentVictorySource,i,n).status===o1.VICTORY)return!0;return!1}}function u_t(r,e){if(1&r){const t=pe();N(),S(0,"polygon",10),W("click",function(){const s=te(t).$implicit;return ne(p().onPieceClick(s))}),P()}if(2&r){const t=e.$implicit,n=p();ye("id","piece_",t.x,"_",t.y,""),y("ngClass",n.getPieceClass(t)),I("points",n.getHexaPointsAt(t))}}function f_t(r,e){if(1&r){const t=pe();N(),S(0,"polygon",11),W("click",function(){const s=te(t).$implicit;return ne(p().onNeighborClick(s))}),P()}if(2&r){const t=e.$implicit,n=p();ye("id","neighbor_",t.x,"_",t.y,""),I("points",n.getHexaPointsAt(t))}}function d_t(r,e){if(1&r){const t=pe();N(),S(0,"polygon",10),W("click",function(){te(t);const i=p();return ne(i.onPieceClick(i.chosenLanding.get()))}),P()}if(2&r){const t=p();ye("id","chosenLanding_",t.chosenLanding.get().x,"_",t.chosenLanding.get().y,""),y("ngClass",t.getPlayerClass(t.state.getCurrentPlayer())),I("points",t.getHexaPointsAt(t.chosenLanding.get()))}}function h_t(r,e){if(1&r&&(N(),F(0,"polygon",12)),2&r){const t=e.$implicit,n=p();ye("id","disconnected_",t.x,"_",t.y,""),I("points",n.getHexaPointsAt(t))}}function p_t(r,e){if(1&r){const t=pe();N(),S(0,"polygon",13),W("click",function(){te(t);const i=p();return ne(i.onNeighborClick(i.leftCoord.get()))}),P()}if(2&r){const t=p();ye("id","leftCoord_",t.leftCoord.get().x,"_",t.leftCoord.get().y,""),I("points",t.getHexaPointsAt(t.leftCoord.get()))}}function g_t(r,e){if(1&r){const t=pe();N(),S(0,"polygon",14),W("click",function(){te(t);const i=p();return ne(i.onPieceClick(i.lastDrop.get()))}),P()}if(2&r){const t=p();ye("id","lastDrop_",t.lastDrop.get().x,"_",t.lastDrop.get().y,""),I("points",t.getHexaPointsAt(t.lastDrop.get()))}}function m_t(r,e){if(1&r){const t=pe();N(),S(0,"polygon",15),W("click",function(){te(t);const i=p();return ne(i.onPieceClick(i.selectedPiece.get()))}),P()}if(2&r){const t=p();ye("id","selectedPiece_",t.selectedPiece.get().x,"_",t.selectedPiece.get().y,""),y("ngClass",t.getSelectedPieceClass()),I("points",t.getHexaPointsAt(t.selectedPiece.get()))}}function __t(r,e){if(1&r&&(N(),F(0,"polygon",16)),2&r){const t=e.$implicit,n=p();ye("id","victoryCoord_",t.x,"_",t.y,""),I("points",n.getHexaPointsAt(t))}}function v_t(r,e){if(1&r){const t=pe();N(),S(0,"polygon",19),W("click",function(){const s=te(t).$implicit;return ne(p(2).onPieceClick(s))}),P()}if(2&r){const t=e.$implicit,n=p(2);ye("id","cuttable_",t.x,"_",t.y,""),I("points",n.getHexaPointsAt(t))}}function C_t(r,e){if(1&r&&(N(),S(0,"g",17),T(1,v_t,1,3,"polygon",18),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}let y_t=(()=>{var r;class e extends au{constructor(n){super(n),u(this,"state",void 0),u(this,"pieces",void 0),u(this,"disconnecteds",[]),u(this,"cuttableGroups",[]),u(this,"victoryCoords",void 0),u(this,"neighbors",void 0),u(this,"leftCoord",g.empty()),u(this,"lastDrop",g.empty()),u(this,"selectedPiece",g.empty()),u(this,"chosenLanding",g.empty()),u(this,"viewBox",void 0),u(this,"nextClickShouldSelectGroup",!1),this.rules=Jc.get(),this.node=this.rules.getInitialNode(),this.availableAIs=[new on($localize`Minimax`,this.rules,new q3e,new l_t),new Kn($localize`MCTS`,new qC,this.rules)],this.encoder=mr.encoder,this.tutorial=(new W3e).tutorial,this.SPACE_SIZE=30,this.hexaLayout=new cu(1.5*this.SPACE_SIZE,new C(2*this.SPACE_SIZE,0),Br.INSTANCE)}cancelMoveAttempt(){var n=this;return M(function*(){n.selectedPiece=g.empty(),n.chosenLanding=g.empty(),n.cuttableGroups=[],n.nextClickShouldSelectGroup=!1,yield n.updateBoard(!1)})()}updateBoard(n){var i=this;return M(function*(){i.state=i.node.gameState,i.node.previousMove.isAbsent()&&i.hideLastMove(),i.pieces=i.state.getPieceCoords(),i.neighbors=i.getEmptyNeighbors(),i.viewBox=i.getViewBox()})()}hideLastMove(){this.leftCoord=g.empty(),this.lastDrop=g.empty(),this.victoryCoords=[],this.disconnecteds=[]}getViewBox(){const n=this.pieces.concat(this.disconnecteds).concat(this.neighbors);return f4.fromHexa(n,this.hexaLayout,this.STROKE_WIDTH).toSVGString()}showLastMove(n){var i=this;return M(function*(){i.lastDrop=g.of(n.landing),i.leftCoord=!1===n.isDrop()?g.of(n.start.get()):g.empty();const s=i.getState();i.rules.getGameStatus(i.node).isEndGame&&(i.victoryCoords=i.rules.getShapeVictory(n,s)),i.disconnecteds=i.getDisconnected()})()}getDisconnected(){const n=this.getPreviousState().getPieceCoords(),i=this.getState().getPieceCoords(),s=[];for(const a of n)!1===this.node.previousMove.get().start.equalsValue(a)&&!1===i.some(l=>l.equals(a))&&s.push(a);const o=this.lastDrop.get();return!1===this.pieces.some(a=>a.equals(o))&&!1===i.some(a=>a.equals(o))&&s.push(o),s}getEmptyNeighbors(){let n=Jc.getLegalLandings(this.state);if(this.chosenLanding.isPresent()){const i=this.chosenLanding.get();n=n.filter(s=>!1===s.equals(i))}return n}getPieceClass(n){const i=this.getState().getPieceAt(n);return this.getPlayerClass(i)}onPieceClick(n){var i=this;return M(function*(){const s=yield i.canUserPlay("#piece_"+n.x+"_"+n.y);if(s.isFailure())return i.cancelMove(s.getReason());if(i.state.turn<40)return i.cancelMove(Ya.NO_MOVEMENT_BEFORE_TURN_40());if(i.chosenLanding.isAbsent())return i.state.getPieceAt(n)===i.state.getCurrentOpponent()?i.cancelMove(Re.CANNOT_CHOOSE_OPPONENT_PIECE()):(i.selectedPiece=i.selectedPiece.equalsValue(n)?g.empty():g.of(n),b.SUCCESS);{const o=mr.ofCut(i.selectedPiece.get(),i.chosenLanding.get(),n);return i.chooseMove(o)}})()}onNeighborClick(n){var i=this;return M(function*(){const s=yield i.canUserPlay("#neighbor_"+n.x+"_"+n.y);if(s.isFailure())return i.cancelMove(s.getReason());if(i.nextClickShouldSelectGroup)return i.cancelMove(Ya.MUST_CUT());if(i.state.turn<40)return i.chooseMove(mr.ofDrop(n));if(i.selectedPiece.isAbsent())return i.cancelMove(Ya.CAN_NO_LONGER_DROP());{const o=mr.ofMovement(i.selectedPiece.get(),n),a=Jc.isLegalPhaseTwoMove(o,i.state);return i.neededCutting(a)?(i.chosenLanding=g.of(n),i.moveVirtuallyPiece(),i.showCuttable(),i.nextClickShouldSelectGroup=!0,b.SUCCESS):i.chooseMove(o)}})()}neededCutting(n){return n.isFailure()&&n.getReason()===Ya.MUST_CUT()}moveVirtuallyPiece(){const n=this.selectedPiece.get();this.pieces=this.pieces.filter(i=>!1===i.equals(n)),this.neighbors=this.getEmptyNeighbors()}showCuttable(){const n=mr.ofMovement(this.selectedPiece.get(),this.chosenLanding.get()),s=this.state.movePiece(n).getGroups(),o=Jc.getLargestGroups(s);this.cuttableGroups=[];for(const a of o)this.cuttableGroups.push(a.toList())}getSelectedPieceClass(){return this.chosenLanding.isPresent()?"moved-fill":"selected-stroke"}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(Ut))}),u(e,"\u0275cmp",qe({type:r,selectors:[["app-six"]],features:[Qe],decls:10,vars:10,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["class","base round",3,"id","ngClass","click",4,"ngFor","ngForOf"],["class","base round",3,"id","click",4,"ngFor","ngForOf"],["class","base round",3,"id","ngClass","click",4,"ngIf"],["class","base round captured-fill",3,"id",4,"ngFor","ngForOf"],["class","base round moved-fill mid-stroke",3,"id","click",4,"ngIf"],["class","base no-fill round last-move-stroke mid-stroke",3,"id","click",4,"ngIf"],["class","base no-fill round",3,"id","ngClass","click",4,"ngIf"],["class","base no-fill round victory-stroke mid-stroke",3,"id",4,"ngFor","ngForOf"],["pointer-events","fill","class","capturable-stroke",4,"ngFor","ngForOf"],[1,"base","round",3,"id","ngClass","click"],[1,"base","round",3,"id","click"],[1,"base","round","captured-fill",3,"id"],[1,"base","round","moved-fill","mid-stroke",3,"id","click"],[1,"base","no-fill","round","last-move-stroke","mid-stroke",3,"id","click"],[1,"base","no-fill","round",3,"id","ngClass","click"],[1,"base","no-fill","round","victory-stroke","mid-stroke",3,"id"],["pointer-events","fill",1,"capturable-stroke"],["class","no-fill","stroke-linecap","round",3,"id","click",4,"ngFor","ngForOf"],["stroke-linecap","round",1,"no-fill",3,"id","click"]],template:function(n,i){1&n&&(N(),S(0,"svg",0),T(1,u_t,1,4,"polygon",1),T(2,f_t,1,3,"polygon",2),T(3,d_t,1,4,"polygon",3),T(4,h_t,1,3,"polygon",4),T(5,p_t,1,3,"polygon",5),T(6,g_t,1,3,"polygon",6),T(7,m_t,1,4,"polygon",7),T(8,__t,1,3,"polygon",8),T(9,C_t,2,1,"g",9),P()),2&n&&(I("viewBox",i.viewBox),_(1),y("ngForOf",i.pieces),_(1),y("ngForOf",i.neighbors),_(1),y("ngIf",i.chosenLanding.isPresent()),_(1),y("ngForOf",i.disconnecteds),_(1),y("ngIf",i.leftCoord.isPresent()),_(1),y("ngIf",i.lastDrop.isPresent()),_(1),y("ngIf",i.selectedPiece.isPresent()),_(1),y("ngForOf",i.victoryCoords),_(1),y("ngForOf",i.cuttableGroups))},dependencies:[Ft,Wt,At],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();class Us extends OL{static of(e,t){return new Us(e,t)}static from(e,t){try{const n=new Us(e,t);return ie.success(n)}catch(n){return ie.failure(n.message)}}getMaximalDistance(){return 9}}u(Us,"encoder",Hs.getFallibleEncoder(Us.from));const M_t={CASTLE_IS_LEFT_FOR_GOOD:!1,BORDER_CAN_SURROUND_KING:!0,CENTRAL_THRONE_CAN_SURROUND_KING:!1,KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED:!1,WIDTH:9,INVADER:k.ZERO};class e3 extends bL{static getInitialState(){const e=rn.UNOCCUPIED,t=rn.INVADERS,n=rn.DEFENDERS;return new e3([[e,e,e,t,t,t,e,e,e],[e,e,e,e,t,e,e,e,e],[e,e,e,e,n,e,e,e,e],[t,e,e,e,n,e,e,e,t],[t,t,n,n,rn.PLAYER_ONE_KING,n,n,t,t],[t,e,e,e,n,e,e,e,t],[e,e,e,e,n,e,e,e,e],[e,e,e,e,t,e,e,e,e],[e,e,e,t,t,t,e,e,e]],0)}of(e,t){return new e3(e,t)}}class Dl extends wL{static get(){return Dl.singleton.isAbsent()&&(Dl.singleton=g.of(new Dl)),Dl.singleton.get()}constructor(){super(e3,M_t,Us.from)}}u(Dl,"singleton",g.empty());const H=rn.UNOCCUPIED,bn=rn.INVADERS,Zi=rn.DEFENDERS,jC=rn.PLAYER_ONE_KING;class Z3e extends Zn{constructor(...e){super(...e),u(this,"tutorial",[q.informational($localize`Goal of the game`,$localize`Tablut is the lapland version of the Tafl, Tafl being a family of viking strategy game. The goal of the game is different for each player. The attacker plays first. Its pieces (dark) are close to the edges. Its goal is to capture the king, which is in the center of the board. The defender plays second. Its pieces (light) are in the middle. Its goal is to move the king on one of the 4 thrones in the corners. Note that the square in which the king starts, in the center of the board, is also a throne.`,e3.getInitialState()),q.anyMove($localize`Moving`,$localize`All pieces move the same way. Similarly to a rook in chess, a piece can move:<ol><li>By as many squares as you want.</li><li>Without going over another piece or stopping on another piece.</li><li>Horizontally or vertically.</li><li>Only the king can land on a throne.</li></ol>To move a piece, click on it and then on its landing square.<br/><br/>You're playing Dark, do the first move.`,e3.getInitialState(),Us.of(new C(4,1),new C(1,1)),$localize`Congratulations!`),q.fromMove($localize`Capturing a soldier (1/2)`,$localize`All pieces, attackers and defenders, except the king, are soldiers. To capture them, they have to be sandwiched between two of your pieces. By getting too close, an attacker's soldier is in danger.<br/><br/>You're playing Light. Capture the soldier.`,new e3([[H,H,H,bn,bn,bn,H,H,H],[H,H,H,H,bn,H,H,H,H],[H,H,H,H,Zi,H,H,H,H],[H,H,H,bn,Zi,H,H,H,bn],[bn,bn,Zi,Zi,jC,Zi,Zi,bn,bn],[H,H,H,H,Zi,H,H,H,bn],[H,H,H,H,Zi,H,H,H,H],[H,H,H,H,bn,H,H,H,H],[H,H,H,bn,bn,bn,H,H,H]],1),[Us.of(new C(2,4),new C(2,3)),Us.of(new C(4,2),new C(3,2))],$localize`Congratulations, that will teach him a lesson!`,$localize`Failed, you missed an opportunity to capture a piece of the opponent.`),q.fromMove($localize`Capturing a soldier (2/2)`,$localize`A second way to capture a soldier is to sandwich it against an empty throne. The king has moved and endangered one of its soldiers.<br/><br/>You're playing Dark. Capture the soldier.`,new e3([[H,H,H,bn,bn,bn,H,H,H],[H,H,H,H,bn,H,H,H,H],[H,H,H,H,Zi,H,H,H,H],[H,H,Zi,H,jC,H,Zi,H,bn],[bn,bn,H,Zi,H,Zi,Zi,bn,bn],[H,H,H,H,Zi,H,H,H,bn],[H,H,H,H,Zi,H,H,H,H],[H,H,H,H,bn,H,H,H,H],[H,H,H,bn,bn,bn,H,H,H]],12),[Us.of(new C(1,4),new C(2,4))],$localize`Congratulations, one less defender. But keep an eye on the king, it is the most important.`,$localize`Failed, you did not do the expected move.`),q.fromMove($localize`Capturing the king (1/2)`,$localize`To capture the king, two soldiers are not enough. For the first solution, the four squares neighbor to the king (horizontally and vertically) must be occupied by your soldiers. This also works if the king is on the throne.<br/><br/>You're playing Dark, capture the king.`,new e3([[H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H],[H,bn,H,H,H,H,H,H,H],[bn,jC,H,bn,H,H,H,H,H],[H,bn,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H]],72),[Us.of(new C(3,4),new C(2,4))],$localize`Congratulations, you won!`,$localize`Failed, you let the king run away.`),q.fromMove($localize`Capturing the king (2/2)`,$localize`Another way to capture the king is to immobilize it against an edge of the board. Note that the king cannot be captured next to a throne.<br/><br/>You're playing Dark, capture the king.`,new e3([[H,H,bn,jC,bn,H,H,H,H],[H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H],[H,H,H,bn,H,H,H,H,H],[H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H]],72),[Us.of(new C(3,3),new C(3,1))],$localize`The king is dead, long live the king. Congratulations, you won.`,$localize`Failed. Try again.`)])}}function E_t(r,e){1&r&&(N(),F(0,"polygon",8))}function S_t(r,e){1&r&&(N(),F(0,"rect",9))}function P_t(r,e){if(1&r&&(N(),S(0,"g"),T(1,E_t,1,0,"polygon",6),T(2,S_t,1,0,"ng-template",null,7,un),P()),2&r){const t=cn(3),n=p().index,i=p().index,s=p();_(1),y("ngIf",s.isCentralThrone(n,i))("ngIfElse",t)}}function T_t(r,e){if(1&r&&(N(),S(0,"g"),F(1,"line",13)(2,"line",13)(3,"line",13)(4,"line",13)(5,"line",13),P()),2&r){const t=p(2).index,n=p().index,i=p();_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),I("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),I("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.1*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),I("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.9*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),I("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.15*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),I("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.85*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE)}}function O_t(r,e){if(1&r&&(N(),F(0,"polyline",16)),2&r){const t=p(3).index,n=p().index;y("ngClass",p().viewInfo.pieceClasses[n][t])}}function b_t(r,e){if(1&r&&(N(),F(0,"line",13)(1,"line",13)(2,"line",13)(3,"line",13)),2&r){const t=p(3).index,n=p().index,i=p();y("ngClass",i.viewInfo.pieceClasses[n][t]),I("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),I("x1",.04*i.SPACE_SIZE)("y1",.5*i.SPACE_SIZE)("x2",.96*i.SPACE_SIZE)("y2",.5*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),I("x1",.2*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.8*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),I("x1",.8*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.2*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE)}}function w_t(r,e){if(1&r&&(N(),T(0,O_t,1,1,"polyline",14),T(1,b_t,4,20,"ng-template",null,15,un)),2&r){const t=cn(2),n=p(2).index,i=p().index;y("ngIf",p().isKing(n,i))("ngIfElse",t)}}function A_t(r,e){if(1&r&&(N(),S(0,"g"),F(1,"circle",10),T(2,T_t,6,25,"g",11),T(3,w_t,3,2,"ng-template",null,12,un),P()),2&r){const t=cn(4),n=p().index,i=p().index,s=p();_(1),ye("id","piece_",n,"_",i,""),y("ngClass",s.viewInfo.pieceClasses[i][n]),I("r",s.SPACE_SIZE/2-s.STROKE_WIDTH)("cx",.5*s.SPACE_SIZE)("cy",.5*s.SPACE_SIZE),_(1),y("ngIf",s.isInvader(n,i))("ngIfElse",t)}}function N_t(r,e){if(1&r){const t=pe();N(),S(0,"g",3),W("click",function(){const s=te(t).index,o=p().index;return ne(p().onClick(s,o))}),F(1,"rect",4),T(2,P_t,4,2,"g",5),T(3,A_t,5,8,"g",5),P()}if(2&r){const t=e.index,n=p().index,i=p();ye("id","click_",t,"_",n,""),I("transform","translate("+i.SPACE_SIZE*t+", "+i.SPACE_SIZE*n+")"),_(1),ye("id","space_",t,"_",n,""),y("ngClass",i.getRectClasses(t,n)),I("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),_(1),y("ngIf",i.board[n][t]===i.EMPTY&&i.isThrone(t,n)),_(1),y("ngIf",i.board[n][t]!==i.EMPTY)}}function I_t(r,e){if(1&r&&(N(),S(0,"g"),T(1,N_t,4,10,"g",2),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function k_t(r,e){if(1&r){const t=pe();N(),S(0,"g")(1,"rect",17),W("click",function(){const s=te(t).$implicit;return ne(p().onClick(s.x,s.y))}),P()()}if(2&r){const t=e.$implicit,n=p();_(1),ye("id","click_",t.x,"_",t.y,""),I("x",n.SPACE_SIZE*t.x)("y",n.SPACE_SIZE*t.y)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}let x_t=(()=>{var r;class e extends AL{constructor(n){super(n,Us.from),this.rules=Dl.get(),this.node=this.rules.getInitialNode(),this.availableAIs=this.createAIs(),this.encoder=Us.encoder,this.tutorial=(new Z3e).tutorial}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(Ut))}),u(e,"\u0275cmp",qe({type:r,selectors:[["app-tablut"]],features:[Qe],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["x","0","y","0",1,"base",3,"id","ngClass"],[4,"ngIf"],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60","class","base",4,"ngIf","ngIfElse"],["cornerThrone",""],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60",1,"base"],["x","15","y","15","width","70","height","70",1,"base"],[1,"base",3,"id","ngClass"],[4,"ngIf","ngIfElse"],["defender",""],[1,"base",3,"ngClass"],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85","class","base no-fill",3,"ngClass",4,"ngIf","ngIfElse"],["soldierDefender",""],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85",1,"base","no-fill",3,"ngClass"],[1,"no-fill","mid-stroke","clickable-stroke",3,"id","click"]],template:function(n,i){1&n&&(N(),S(0,"svg",0),T(1,I_t,2,1,"g",1),T(2,k_t,2,6,"g",1),P()),2&n&&(I("viewBox",i.getViewBox()),_(1),y("ngForOf",i.board),_(1),y("ngForOf",i.getClickables()))},dependencies:[Ft,Wt,At],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})(),yo=(()=>{class r extends W1{static isOnBoard(t){return t.isInRange(r.WIDTH,r.WIDTH)}static getInitialState(){const t=Ie.createTable(r.WIDTH,r.WIDTH,K.NONE);return new r(t,0)}isInDropPhase(){return this.turn<8}}return u(r,"WIDTH",5),r})();var aR;class Mo extends br{static from(e){return yo.isOnBoard(e)?ie.success(new Mo(e.x,e.y)):ie.failure(ou.OUT_OF_RANGE(e))}toString(){return"TeekoMove"+this.coord.toString()}equals(e){return e instanceof Mo&&super.equals(e)}}u(Mo,"encoder",br.getFallibleEncoder(Mo.from));class Ws extends $o{static from(e,t){return!1===yo.isOnBoard(e)?ie.failure(ou.OUT_OF_RANGE(e)):!1===yo.isOnBoard(t)?ie.failure(ou.OUT_OF_RANGE(t)):e.equals(t)?ie.failure(Re.MOVE_CANNOT_BE_STATIC()):ie.success(new Ws(e,t))}toString(){return"TeekoMove("+this.getStart().toString()+" -> "+this.getEnd().toString()+")"}equals(e){return e instanceof Ws&&super.equals(e)}}u(Ws,"encoder",$o.getFallibleEncoder(Ws.from)),function(r){r.encoder=we.disjunction([e=>e instanceof Mo,e=>e instanceof Ws],[Mo.encoder,Ws.encoder])}(aR||(aR={}));class sa extends Yn{static get(){return sa.singleton.isAbsent()&&(sa.singleton=g.of(new sa)),sa.singleton.get()}constructor(){super(yo)}isLegal(e,t){return t.isInDropPhase()?this.isLegalDrop(e,t):this.isLegalTranslation(e,t)}isLegalDrop(e,t){return U.assert(e instanceof Mo,"Cannot translate in dropping phase !"),t.getPieceAt(e.coord).isPlayer()?b.failure(Re.MUST_LAND_ON_EMPTY_SPACE()):b.SUCCESS}isLegalTranslation(e,t){U.assert(e instanceof Ws,"Cannot drop in translation phase !");const n=e,i=t.getCurrentOpponent();return t.getPieceAt(n.getStart())===i?b.failure(Re.CANNOT_CHOOSE_OPPONENT_PIECE()):t.getPieceAt(n.getStart())===K.NONE?b.failure(Re.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):t.getPieceAt(n.getEnd()).isPlayer()?b.failure(Re.MUST_LAND_ON_EMPTY_SPACE()):b.SUCCESS}applyLegalMove(e,t){return e instanceof Mo?this.applyLegalDrop(e,t):this.applyLegalTranslate(e,t)}applyLegalDrop(e,t){const n=t.getCopiedBoard();return n[e.coord.y][e.coord.x]=t.getCurrentPlayer(),new yo(n,t.turn+1)}applyLegalTranslate(e,t){const n=t.getCopiedBoard();return n[e.getStart().y][e.getStart().x]=K.NONE,n[e.getEnd().y][e.getEnd().x]=t.getCurrentPlayer(),new yo(n,t.turn+1)}getGameStatus(e){const t=e.gameState;return this.getVictoryCoord(t).length>0?_e.getVictory(t.getCurrentOpponent()):_e.ONGOING}getLastCoord(e){return e instanceof Mo?e.coord:e.getEnd()}getSquareInfo(e){const t=[],n=[0,0];for(let i=0;i<yo.WIDTH-1;i++)for(let s=0;s<yo.WIDTH-1;s++){const o=new C(i,s),a=new C(i+1,s),c=new C(i,s+1),l=new C(i+1,s+1),f=[e.getPieceAt(o),e.getPieceAt(a),e.getPieceAt(c),e.getPieceAt(l)],d=this.count(f,K.NONE),m=this.count(f,K.ZERO),E=this.count(f,K.ONE);d<4&&(4===m||4===E?t.push(o,a,c,l):m>0?n[0]=n[0]+1:n[1]=n[1]+1)}return{score:n[1]-n[0],victoriousCoords:t}}count(e,t){let n=0;for(const i of e)i===t&&n++;return n}getVictoryCoord(e){const t=sa.TEEKO_HELPER.getVictoriousCoord(e);return t.push(...this.getSquareInfo(e).victoriousCoords),t}}u(sa,"singleton",g.empty()),u(sa,"TEEKO_HELPER",new fu(yo.isOnBoard,U.identity,4));const Vn=K.NONE,Hl=K.ZERO,Vl=K.ONE;class X3e extends Zn{constructor(...e){super(...e),u(this,"tutorial",[q.informational($localize`Goal of the game`,$localize`The goal of the game is to align your 4 pieces, or to form a square with them.`,yo.getInitialState()),q.anyMove($localize`Dropping a piece`,$localize`During your first four turns, you must drop one piece on any empty space of the board. There is no other restriction.<br/><br/>You're playing Dark, put a piece on the board.`,yo.getInitialState(),Mo.from(new C(2,2)).get(),$localize`Congratulations!`),q.anyMove($localize`Moving a piece`,$localize`Once all of your four pieces are placed on the board, you must now move one of your piece to another empty space. The goal remain to be the first to create a line or a square.<br/><br/>You're playing Dark, move a piece.`,new yo([[Hl,Vl,Vn,Vn,Vn],[Hl,Hl,Vn,Vn,Vn],[Vl,Vl,Vn,Vn,Vn],[Vl,Hl,Vn,Vn,Vn],[Vn,Vn,Vn,Vn,Vn]],8),Ws.from(new C(1,3),new C(2,1)).get(),$localize`Congratulations!`),q.fromMove($localize`Victory`,$localize`In this board, you can win either by creating a line, or a square.<br/><br/>You are playing Dark, win.`,new yo([[Vl,Vn,Vn,Vn,Vn],[Vl,Hl,Vn,Vn,Vn],[Vn,Hl,Hl,Vl,Vn],[Vn,Vl,Vn,Hl,Vn],[Vn,Vn,Vn,Vn,Vn]],8),[Ws.from(new C(1,2),new C(4,4)).get(),Ws.from(new C(3,3),new C(2,1)).get()],$localize`Congratulations, you won!`,$localize`Failed. Try again.`)])}}class L_t extends wa{getBoardValue(e){const t=sa.TEEKO_HELPER.getBoardValue(e.gameState).value,n=sa.get().getSquareInfo(e.gameState);return new Jn(n.score+t)}}class Q3e extends Un{getListMoves(e){return e.gameState.isInDropPhase()?this.getListDrops(e.gameState):this.getListTranslations(e.gameState)}getListDrops(e){const t=[];for(const n of e.getCoordsAndContents()){const i=n.coord;if(!1===e.getPieceAt(i).isPlayer()){const s=Mo.from(i).get();t.push(s)}}return t}getListTranslations(e){const t=[],n=e.getCurrentPlayer(),i=this.getCoordsContaining(e,n),s=this.getCoordsContaining(e,K.NONE);for(const o of i)for(const a of s){const c=Ws.from(o,a).get();t.push(c)}return t}getCoordsContaining(e,t){const n=[];for(const i of e.getCoordsAndContents())i.content===t&&n.push(i.coord);return n}}function R_t(r,e){if(1&r&&(N(),F(0,"circle",4)),2&r){const t=p().index,n=p().index,i=p();ye("id","piece_",t,"_",n,""),y("ngClass",i.getPieceClasses(t,n)),I("r",42)("cx",i.SPACE_SIZE*t+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*n+i.SPACE_SIZE/2)}}function z_t(r,e){if(1&r){const t=pe();N(),S(0,"g",3),W("click",function(){const s=te(t).index,o=p().index;return ne(p().onClick(s,o))}),F(1,"rect",4),T(2,R_t,1,6,"circle",5),P()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,s=p();ye("id","click_",n,"_",i,""),_(1),ye("id","space_",n,"_",i,""),y("ngClass",s.getSpaceClasses(n,i)),I("x",s.SPACE_SIZE*n)("y",s.SPACE_SIZE*i)("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),_(1),y("ngIf",t.isPlayer())}}function D_t(r,e){if(1&r&&(N(),S(0,"g"),T(1,z_t,3,10,"g",2),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}let H_t=(()=>{var r;class e extends Fi{constructor(n){super(n),u(this,"selected",g.empty()),u(this,"last",g.empty()),u(this,"moved",[]),u(this,"victory",[]),this.rules=sa.get(),this.node=this.rules.getInitialNode(),this.encoder=aR.encoder,this.tutorial=(new X3e).tutorial,this.availableAIs=[new on($localize`Minimax`,this.rules,new L_t,new Q3e),new Kn($localize`MCTS`,new Q3e,this.rules)]}updateBoard(n){var i=this;return M(function*(){i.board=i.node.gameState.board})()}showLastMove(n){var i=this;return M(function*(){i.last=g.of(i.rules.getLastCoord(n)),i.moved=n instanceof Ws?[n.getStart(),n.getEnd()]:[],i.victory=i.rules.getVictoryCoord(i.getState())})()}hideLastMove(){var n=this;return M(function*(){n.last=g.empty(),n.moved=[],n.victory=[]})()}cancelMoveAttempt(){this.selected=g.empty()}onClick(n,i){var s=this;return M(function*(){const o=yield s.canUserPlay("#click_"+n+"_"+i);if(o.isFailure())return s.cancelMove(o.getReason());const a=new C(n,i);if(s.getState().isInDropPhase()){const c=Mo.from(a).get();return s.chooseMove(c)}if(s.selected.isPresent()){if(s.selected.equalsValue(a))return s.selected=g.empty(),b.SUCCESS;{const c=Ws.from(s.selected.get(),a).get();return s.chooseMove(c)}}{const c=s.getState().getCurrentPlayer(),l=s.getState().getPieceAt(a);return l===c?(s.selected=g.of(a),b.SUCCESS):s.cancelMove(l===K.NONE?Re.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY():Re.CANNOT_CHOOSE_OPPONENT_PIECE())}})()}getPieceClasses(n,i){const s=new C(n,i),a=[this.getPlayerClass(this.getState().getPieceAt(s))];return this.victory.some(c=>c.equals(s))?a.push("victory-stroke"):this.last.equalsValue(s)?a.push("last-move-stroke"):this.selected.equalsValue(s)&&a.push("selected-stroke"),a}getSpaceClasses(n,i){const s=new C(n,i);return this.moved.some(o=>o.equals(s))?["moved-fill"]:[]}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(Ut))}),u(e,"\u0275cmp",qe({type:r,selectors:[["app-teeko"]],features:[Qe],decls:2,vars:1,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-5 -5 510 510","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base",3,"id","ngClass"],["class","base",3,"id","ngClass",4,"ngIf"]],template:function(n,i){1&n&&(N(),S(0,"svg",0),T(1,D_t,2,1,"g",1),P()),2&n&&(_(1),y("ngForOf",i.board))},dependencies:[Ft,Wt,At],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();class vi{constructor(e,t){u(this,"owner",void 0),u(this,"tileId",void 0),this.owner=e,this.tileId=t}toString(){return`TrexoPiece(${this.owner.toString()}, ${this.tileId})`}}class Zr{static of(e){let t=-1;for(const n of e)U.assert(t<n.tileId,"TrexoPieceStack: dropped turn should be ascending"),t=n.tileId;return new Zr(e)}constructor(e){u(this,"pieces",void 0),this.pieces=e}getHeight(){return this.pieces.length}getOwner(){const e=this.pieces.length;return 0===e?K.NONE:this.pieces[e-1].owner}getUpperTileId(){const e=this.pieces.length;return 0===e?-1:this.pieces[e-1].tileId}add(e){return Zr.of(this.pieces.concat(e))}getPieceAt(e){return U.assert(e<this.pieces.length,"no element "+e+"in piece!"),this.pieces[e]}isGround(){return-1===this.getUpperTileId()}toString(){return"["+this.pieces.map(e=>"("+e.toString()+")").join(" ")+"]"}}u(Zr,"EMPTY",Zr.of([]));let E2=(()=>{class r extends W1{static getInitialState(){const t=Ie.createTable(r.SIZE,r.SIZE,Zr.EMPTY);return new r(t,0)}static isOnBoard(t){return t.isInRange(r.SIZE,r.SIZE)}static of(t,n){U.assert(t.length===r.SIZE,"Invalid board dimensions");for(const i of t)U.assert(i.length===r.SIZE,"Invalid board dimensions");return new r(t,n)}drop(t,n){const i=this.getCopiedBoard(),s=new vi(n,this.turn);return i[t.y][t.x]=i[t.y][t.x].add(s),new r(i,this.turn)}incrementTurn(){return new r(this.getCopiedBoard(),this.turn+1)}toString(){return this.board.map(t=>"["+t.map(n=>"TrexoPieceStack.of("+n.toString()+")").join(", ")+"]").join("\n,")}getPieceAtXYZ(t,n,i){return this.getPieceAtXY(t,n).getPieceAt(i)}}return u(r,"SIZE",10),r})(),ZC=(()=>{class r{}return u(r,"NON_NEIGHBORING_SPACES",()=>$localize`Those two spaces are not neighbors!`),u(r,"NO_WAY_TO_DROP_IT_HERE",()=>$localize`There is no way to put a piece there!`),u(r,"CANNOT_DROP_ON_ONLY_ONE_PIECE",()=>$localize`You cannot drop on only one piece!`),u(r,"CANNOT_DROP_PIECE_ON_UNEVEN_GROUNDS",()=>$localize`You cannot drop a piece on uneven grounds!`),r})();var t4e;class qs extends Hs{static from(e,t){return U.assert(E2.isOnBoard(e),`${e.toString()} is out of the TrexoBoard!`),U.assert(E2.isOnBoard(t),`${t.toString()} is out of the TrexoBoard!`),1===e.getOrthogonalDistance(t)?ie.success(new qs(e,t)):ie.failure(ZC.NON_NEIGHBORING_SPACES())}constructor(e,t){super(e,t)}toString(){return this.getFirst().toString()+" && "+this.getSecond().toString()}equals(e){return this.getFirst().equals(e.getFirst())&&this.getSecond().equals(e.getSecond())}getZero(){return this.getFirst()}getOne(){return this.getSecond()}}u(qs,"encoder",Hs.getFallibleEncoder(qs.from));class Ci extends Yn{static get(){return Ci.instance.isAbsent()&&(Ci.instance=g.of(new Ci)),Ci.instance.get()}static getOwner(e){return e.getOwner()}constructor(){super(E2)}applyLegalMove(e,t,n){return t.drop(e.getZero(),k.ZERO).drop(e.getOne(),k.ONE).incrementTurn()}isLegal(e,t){return this.isUnevenGround(e,t)?b.failure(ZC.CANNOT_DROP_PIECE_ON_UNEVEN_GROUNDS()):this.landsOnOnlyOnePiece(e,t)?b.failure(ZC.CANNOT_DROP_ON_ONLY_ONE_PIECE()):b.SUCCESS}isUnevenGround(e,t){const n=t.getPieceAt(e.getZero()),i=t.getPieceAt(e.getOne());return n.getHeight()!==i.getHeight()}landsOnOnlyOnePiece(e,t){const n=t.getPieceAt(e.getZero()),i=t.getPieceAt(e.getOne());return(-1!==n.getUpperTileId()||-1!==i.getUpperTileId())&&n.getUpperTileId()===i.getUpperTileId()}static getSquareScore(e,t){return Ci.TREXO_HELPER.getSquareScore(e,t)}static getVictoriousCoords(e){const t=[],n=[],i=e.getCurrentOpponent();for(const s of e.toMap()){const o=s.key,a=e.getPieceAt(o).getOwner();if(a.isPlayer()){const c=Ci.getSquareScore(e,o);Jn.isVictory(c)&&(a===i?t.push(o):n.push(o))}}return n.length>0?n:t}getGameStatus(e){const t=e.gameState,n=t.getCurrentOpponent();let i=!1;for(const s of t.toMap()){const o=s.key,a=t.getPieceAt(o).getOwner();if(a.isPlayer()){const c=Ci.getSquareScore(t,o);if(Jn.isVictory(c)){if(a!==n)return _e.getDefeat(n);i=!0}}}return i?_e.getVictory(n):_e.ONGOING}getLegalMoves(e){const t=[];for(const n of e.toMap()){const i=n.key;if(i.x+1<E2.SIZE){const s=new C(i.x+1,i.y);t.push(...this.getPossiblesMoves(e,i,s))}if(i.y+1<E2.SIZE){const s=new C(i.x,i.y+1);t.push(...this.getPossiblesMoves(e,i,s))}}return t}getPossiblesMoves(e,t,n){const i=e.getPieceAt(t),s=e.getPieceAt(n);let o;o=!i.isGround()&&i.getUpperTileId()===s.getUpperTileId();const a=i.getHeight()!==s.getHeight();return o||a?[]:[qs.from(t,n).get(),qs.from(n,t).get()]}}t4e=Ci,u(Ci,"instance",g.empty()),u(Ci,"TREXO_HELPER",new fu(E2.isOnBoard,t4e.getOwner,5));const Q=Zr.EMPTY,n4e=Zr.of([new vi(k.ONE,0)]),V_t=Zr.of([new vi(k.ZERO,0)]),F_t=Zr.of([new vi(k.ONE,1)]),r4e=Zr.of([new vi(k.ZERO,1)]),$_t=Zr.of([new vi(k.ZERO,2)]),G_t=Zr.of([new vi(k.ONE,2)]),B_t=Zr.of([new vi(k.ZERO,0),new vi(k.ZERO,3)]),U_t=Zr.of([new vi(k.ONE,1),new vi(k.ONE,3)]),W_t=Zr.of([new vi(k.ZERO,4)]),q_t=Zr.of([new vi(k.ONE,4)]),j_t=Zr.of([new vi(k.ZERO,5)]),Z_t=Zr.of([new vi(k.ONE,5)]),Y_t=Zr.of([new vi(k.ONE,6)]),K_t=Zr.of([new vi(k.ZERO,6)]);class i4e extends Zn{constructor(...e){super(...e),u(this,"tutorial",[q.informational($localize`Goal of the game`,$localize`At Trexo, the goal of the game is to align 5 pieces of your color in a vertical, horizontal or diagonal line. However, the players play with tiles that are constituted of two pieces, one from each player!`,E2.getInitialState()),q.anyMove($localize`Dropping a tile`,$localize`When you drop a tile, it needs to be on even ground, and it cannot be right on top of another tile. In others words, it needs to be either on the floor, or on two tiles at the same height. To drop a tile, just click on the square where you want to put the opponent side of the tile, then on the neighboring square where you want to put your piece.<br/><br/>You're playing Dark, put a tile on the board.`,E2.getInitialState(),qs.from(new C(4,4),new C(3,4)).get(),$localize`Congratulations!`),q.fromMove($localize`Dropping a piece over other pieces`,$localize`You can put a tile on other tiles. For that you must respect two rules:<br/><ul><li>The two pieces must be at the same height.</li><li>You cannot drop your piece on only one other piece.</li></ul><br/>You're playing Dark, do such a move!`,new E2([[Q,Q,Q,n4e,V_t,r4e,F_t,Q,Q,Q],[Q,Q,Q,Q,Q,Q,Q,Q,Q,Q],[Q,Q,Q,Q,Q,Q,Q,Q,Q,Q],[Q,Q,Q,Q,Q,Q,Q,Q,Q,Q],[Q,Q,Q,Q,Q,Q,Q,Q,Q,Q],[Q,Q,Q,Q,Q,Q,Q,Q,Q,Q],[Q,Q,Q,Q,Q,Q,Q,Q,Q,Q],[Q,Q,Q,Q,Q,Q,Q,Q,Q,Q],[Q,Q,Q,Q,Q,Q,Q,Q,Q,Q],[Q,Q,Q,Q,Q,Q,Q,Q,Q,Q]],7),[qs.from(new C(4,0),new C(5,0)).get(),qs.from(new C(5,0),new C(4,0)).get()],$localize`Congratulations!`,$localize`Failed, you put that piece on the floor level, please put it on top of two pieces.`),q.fromPredicate($localize`Victory`,$localize`To win at Trexo, you need to align 5 of your pieces. Only the piece on top counts, the hidden piece are no longer threats, and a victory can include pieces on differents heights. Since you have to put the piece of your opponent first, if you create a victory for them, you lose, even if you aligned 5 of your pieces too.<br/><br/>You're playing Light, win.`,new E2([[Q,Q,Q,Q,Q,Q,Q,Q,Q,Q],[Q,Q,Q,j_t,Q,Q,Q,Q,Q,Q],[Q,Q,Q,Z_t,Q,Q,Q,Q,Q,Q],[Q,Q,Q,Q,n4e,Q,Q,W_t,q_t,Q],[Q,Q,Q,Q,B_t,U_t,r4e,Q,Q,Q],[Q,Q,Q,Q,Q,$_t,Y_t,K_t,Q,Q],[Q,Q,Q,Q,Q,G_t,Q,Q,Q,Q],[Q,Q,Q,Q,Q,Q,Q,Q,Q,Q],[Q,Q,Q,Q,Q,Q,Q,Q,Q,Q],[Q,Q,Q,Q,Q,Q,Q,Q,Q,Q]],7),qs.from(new C(2,0),new C(2,1)).get(),(t,n,i)=>Ci.TREXO_HELPER.getSquareScore(i,t.getOne())===Number.MAX_SAFE_INTEGER?b.SUCCESS:b.failure($localize`Failed. Try again.`),$localize`Congratulations, you won!`)])}}class X_t extends wa{getBoardValue(e){let t=0;const n=e.gameState;for(const i of n.toMap())n.getPieceAt(i.key).getOwner().isPlayer()&&(t+=Ci.getSquareScore(n,i.key));return new Jn(t)}}class s4e extends Un{constructor(...e){super(...e),u(this,"rules",Ci.get())}getListMoves(e){return this.rules.getLegalMoves(e.gameState)}}var cR;function Q_t(r,e){if(1&r){const t=pe();N(),S(0,"g")(1,"polygon",5),W("click",function(){const s=te(t).index,o=p().index;return ne(p().onClick(s,o))}),P()()}if(2&r){const t=e.index,n=p().index,i=p();_(1),ye("id","space_",t,"_",n,""),y("ngClass",i.getSpaceClasses(t,n)),I("points",i.getParallelogramPoints())("transform",i.getTranslate(t,n,0))}}function J_t(r,e){if(1&r&&(N(),S(0,"g"),T(1,Q_t,2,5,"g",1),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function evt(r,e){if(1&r){const t=pe();N(),S(0,"g",8),W("click",function(){te(t);const i=p().index,s=p().index;return ne(p(2).onClick(i,s))}),P()}if(2&r){const t=p(),n=t.index,i=t.$implicit,s=p().index,o=p().index,a=p();wi("id","half_tile_",n,"_",s,"_",o,""),y("mode",a.mode)("coord",a.Coord3D.of(n,s,o))("mustDisplayHeight","2D"===a.chosenMode)("move",i.move.get())("pieceClasses",a.getPieceClasses(n,s,o)),I("transform",a.getTranslate(n,s,o+1))}}const o4e=function(r){return[r]};function tvt(r,e){if(1&r){const t=pe();N(),S(0,"g",9),W("click",function(){te(t);const i=p().index,s=p().index;return ne(p(2).onClick(i,s))}),P()}if(2&r){const t=p().index,n=p().index,i=p().index,s=p();wi("id","dropped_piece_",t,"_",n,"_",i,""),y("mode",s.mode)("coord",s.Coord3D.of(t,n,i))("pieceClasses",_a(7,o4e,s.currentOpponentClass)),I("transform",s.getTranslate(t,n,i+1))}}function nvt(r,e){if(1&r&&(N(),S(0,"g"),T(1,evt,1,9,"g",6),T(2,tvt,1,9,"g",7),P()),2&r){const t=e.$implicit;_(1),y("ngIf",t.move.isPresent()),_(1),y("ngIf",t.isDroppedPiece)}}function rvt(r,e){if(1&r&&(N(),S(0,"g"),T(1,nvt,3,2,"g",1),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function ivt(r,e){if(1&r&&(N(),S(0,"g"),T(1,rvt,2,1,"g",1),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}const svt=function(){return["player0-fill"]};function ovt(r,e){if(1&r){const t=pe();N(),S(0,"g",10),W("click",function(){return te(t),ne(p().switchToMode("3D"))}),P()}if(2&r){const t=p();y("mode",t.TrexoComponent.modeMap["3D"])("coord",t.Coord3D.of(10.5,8.5,0))("pieceClasses",D1(4,svt)),I("transform",t.get3DSwitcherTransform())}}function avt(r,e){if(1&r){const t=pe();N(),S(0,"g",11),W("click",function(){return te(t),ne(p().switchToMode("2D"))}),P()}if(2&r){const t=p();y("mode",t.TrexoComponent.modeMap["2D"])("coord",t.Coord3D.of(12,9,0))("pieceClasses",_a(4,o4e,t.currentPlayerClass)),I("transform",t.getTranslate(12,9,0))}}class Fn extends qce{constructor(e){super(e),u(this,"TrexoComponent",Fn),u(this,"left",-this.STROKE_WIDTH/2),u(this,"Coord3D",jd),u(this,"up",0),u(this,"width",void 0),u(this,"height",void 0),u(this,"mode",void 0),u(this,"chosenMode","3D"),u(this,"victoryCoords",[]),u(this,"droppedPiece",g.empty()),u(this,"possibleNextClicks",[]),u(this,"possibleMoves",[]),u(this,"pieceOnBoard",[]),u(this,"currentOpponentClass","player1"),u(this,"currentPlayerClass","player0"),this.rules=Ci.get(),this.node=this.rules.getInitialNode(),this.availableAIs=[new on($localize`Alignment`,this.rules,new X_t,new s4e),new Kn($localize`MCTS`,new s4e,this.rules)],this.encoder=qs.encoder,this.tutorial=(new i4e).tutorial,Fn.STROKE_WIDTH=this.STROKE_WIDTH,this.switchToMode("3D")}switchToMode(e){this.chosenMode=e,this.width=this.getViewBoxWidth(),this.up=this.getViewBoxUp(),this.height=this.getViewBoxHeight(),this.mode=Fn.modeMap[e]}getViewBoxWidth(){const e=Fn.modeMap["3D"],t=E2.SIZE;return"2D"===this.chosenMode?(t+1)*this.SPACE_SIZE+2*this.STROKE_WIDTH:t*(this.SPACE_SIZE*(e.horizontalWidthRatio+e.offsetRatio))+this.STROKE_WIDTH}getViewBoxHeight(){const t=E2.SIZE*this.SPACE_SIZE;return"2D"===this.chosenMode?t:this.STROKE_WIDTH+t+this.getHigherStackHeight()}getViewBoxUp(){if("2D"===this.chosenMode)return 0;{const e=this.getHigherStackHeight();return-(this.STROKE_WIDTH/2+e)}}getHigherStackHeight(){return(this.pieceOnBoard.length+1)*Fn.modeMap[this.chosenMode].pieceHeightRatio*this.SPACE_SIZE}updateBoard(e){var t=this;return M(function*(){const n=t.getState();t.board=n.getCopiedBoard(),t.currentOpponentClass=t.getPlayerClass(n.getCurrentOpponent()),t.currentPlayerClass=t.getPlayerClass(n.getCurrentPlayer()),t.possibleMoves=t.rules.getLegalMoves(n),t.victoryCoords=Ci.getVictoriousCoords(n),t.pieceOnBoard=t.get3DBoard(),t.height=t.getViewBoxHeight(),t.up=t.getViewBoxUp()})()}get3DBoard(){const e=Ie.create3DTable(1,E2.SIZE,E2.SIZE,Fn.INITIAL_PIECE_ON_BOARD);let t=1;for(let n=0;n<=t;n++)for(const i of this.getState().toMap()){const s=i.key,o=i.value.getHeight();if(t=Math.max(t,o),n<o){const a=this.extractMoveFromState(s.x,s.y,n);this.addMoveToArray(n,a,e)}}return e}extractMoveFromState(e,t,n){const i=this.getState().getPieceAtXYZ(e,t,n),s=new C(e,t);let o=new C(-2,-2);for(const a of Me.ORTHOGONALS){const c=s.getNext(a);if(E2.isOnBoard(c)){const l=this.getState().getPieceAt(c);l.getHeight()>n&&l.getPieceAt(n).tileId===i.tileId&&(o=c)}}return i.owner===k.ZERO?qs.from(s,o).get():qs.from(o,s).get()}addMoveToArray(e,t,n){for(;n.length<=e;)n.push(Ie.createTable(E2.SIZE,E2.SIZE,Fn.INITIAL_PIECE_ON_BOARD));n[e][t.getZero().y][t.getZero().x]={isDroppedPiece:!1,isPossibleClick:!1,move:g.of(t)},n[e][t.getOne().y][t.getOne().x]={isDroppedPiece:!1,isPossibleClick:!1,move:g.of(t)}}onClick(e,t){var n=this;return M(function*(){const i=yield n.canUserPlay("#space_"+e+"_"+t);if(i.isFailure())return n.cancelMove(i.getReason());const s=new C(e,t);if(n.droppedPiece.isPresent()){const o=n.droppedPiece.get();if(n.droppedPiece.equalsValue(s))return yield n.cancelMoveAttempt(),b.SUCCESS;if(n.possibleNextClicks.some(a=>a.equals(s))){const a=n.getState().getCurrentPlayer()===k.ZERO,f=qs.from(a?s:o,a?o:s).get();return n.chooseMove(f)}n.deselectPiece()}return n.selectPiece(s)})()}deselectPiece(){const e=this.getState().getPieceAt(this.droppedPiece.get()).getHeight(),t=this.droppedPiece.get().y,n=this.droppedPiece.get().x;this.pieceOnBoard[e][t][n]=Fn.INITIAL_PIECE_ON_BOARD;for(const i of this.possibleNextClicks)this.pieceOnBoard[e][i.y][i.x].isPossibleClick=!1}selectPiece(e){var t=this;return M(function*(){if(t.possibleMoves.some(n=>n.getZero().equals(e))){const n=t.getState().getPieceAt(e).getHeight();return n>=t.pieceOnBoard.length&&t.pieceOnBoard.push(Ie.createTable(E2.SIZE,E2.SIZE,Fn.INITIAL_PIECE_ON_BOARD)),t.showDroppedPieceAndIndicators(e,n),b.SUCCESS}return t.cancelMove(ZC.NO_WAY_TO_DROP_IT_HERE())})()}showDroppedPieceAndIndicators(e,t){this.droppedPiece=g.of(e),this.possibleNextClicks=this.getPossibleNextClicks(e);for(const n of this.possibleNextClicks)this.pieceOnBoard[t][n.y][n.x]={isDroppedPiece:!1,isPossibleClick:!0,move:g.empty()};this.pieceOnBoard[t][e.y][e.x]={isDroppedPiece:!0,isPossibleClick:!1,move:g.empty()}}getPossibleNextClicks(e){return this.possibleMoves.filter(n=>n.getZero().equals(e)).map(n=>n.getOne())}cancelMoveAttempt(){var e=this;return M(function*(){e.droppedPiece=g.empty(),e.possibleNextClicks=[],yield e.updateBoard(!1)})()}getPieceClasses(e,t,n){const i=new C(e,t),s=this.getState().getPieceAtXYZ(e,t,n).owner;let o=[this.getPlayerClass(s)];o=o.concat(this.getSpaceClasses(e,t));for(const a of this.victoryCoords)if(a.equals(i)){o.push("victory-stroke");break}if(this.node.previousMove.isPresent()){const a=this.node.previousMove.get();(a.getZero().equals(i)||a.getOne().equals(i))&&o.push("last-move-stroke")}return o}getSpaceClasses(e,t){for(const n of this.pieceOnBoard)if(n[t][e].isPossibleClick)return["darker"];return[]}getTranslate(e,t,n){const s=this.getCoordTranslate(e,t,n,Fn.modeMap[this.chosenMode]);return"translate("+s.x+" "+s.y+")"}getParallelogramPoints(){return this.getParallelogramCoordsForTrexo().map(t=>t.x+" "+t.y).join(" ")}getParallelogramCoordsForTrexo(){return this.getParallelogramCoords(Fn.modeMap[this.chosenMode])}get3DSwitcherTransform(){const e=Fn.modeMap["3D"],t=e.horizontalWidthRatio+e.offsetRatio;return"translate("+(10+e.offsetRatio)*e.parallelogramHeight+", "+(9+(1-1/t)/2)*e.parallelogramHeight+") scale("+1/t+")"}}cR=Fn,u(Fn,"STROKE_WIDTH",void 0),u(Fn,"INITIAL_PIECE_ON_BOARD",{isDroppedPiece:!1,isPossibleClick:!1,move:g.empty()}),u(Fn,"modeMap",{"2D":{offsetRatio:0,horizontalWidthRatio:1,pieceHeightRatio:0,parallelogramHeight:100,abstractBoardSize:10},"3D":{offsetRatio:.4,horizontalWidthRatio:1.2,pieceHeightRatio:.2,parallelogramHeight:100,abstractBoardSize:10}}),u(Fn,"\u0275fac",function(e){return new(e||cR)(B(Ut))}),u(Fn,"\u0275cmp",qe({type:cR,selectors:[["app-trexo"]],features:[Qe],decls:8,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%"],[4,"ngFor","ngForOf"],["switchModeIndicator",""],["id","switchTo3D","mgp-trexo-half-piece","",3,"mode","coord","pieceClasses","click",4,"ngIf","ngIfElse"],["switchTo2D",""],[1,"base",3,"id","ngClass","click"],["mgp-trexo-half-piece","",3,"id","mode","coord","mustDisplayHeight","move","pieceClasses","click",4,"ngIf"],["mgp-trexo-half-piece","",3,"mode","id","coord","pieceClasses","click",4,"ngIf"],["mgp-trexo-half-piece","",3,"id","mode","coord","mustDisplayHeight","move","pieceClasses","click"],["mgp-trexo-half-piece","",3,"mode","id","coord","pieceClasses","click"],["id","switchTo3D","mgp-trexo-half-piece","",3,"mode","coord","pieceClasses","click"],["mgp-trexo-half-piece","","id","switchTo2D",3,"mode","coord","pieceClasses","click"]],template:function(e,t){if(1&e&&(N(),S(0,"svg",0),T(1,J_t,2,1,"g",1),T(2,ivt,2,1,"g",1),S(3,"g",null,2),T(5,ovt,1,5,"g",3),T(6,avt,1,6,"ng-template",null,4,un),P()()),2&e){const n=cn(7);I("viewBox",t.left+" "+t.up+" "+t.width+" "+t.height),_(1),y("ngForOf",t.board),_(1),y("ngForOf",t.pieceOnBoard),_(3),y("ngIf","2D"===t.chosenMode)("ngIfElse",n)}},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}));class K1{}var oa;u(K1,"PLACEMENT_AFTER_INITIAL_PHASE",()=>$localize`You cannot put a new ring after the tenth turn.`),u(K1,"NO_MARKERS_IN_INITIAL_PHASE",()=>$localize`You cannot put a marker in a ring before placing all of your rings.`),u(K1,"MISSING_CAPTURES",Yo.MISSING_CAPTURES),u(K1,"MOVE_DIRECTION_INVALID",()=>$localize`The direction of your move is invalid: a move is made along a straight line.`),u(K1,"CAN_ONLY_CAPTURE_YOUR_MARKERS",()=>$localize`You can only capture your own markers.`),u(K1,"SHOULD_SELECT_PLAYER_RING",()=>$localize`You must pick one of your own rings to move.`),u(K1,"SHOULD_END_MOVE_ON_EMPTY_SPACE",()=>$localize`Your ring must land on an empty space.`),u(K1,"MOVE_SHOULD_NOT_PASS_ABOVE_RING",()=>$localize`A ring can only jump over markers or empty spaces, not over another ring.`),u(K1,"MOVE_SHOULD_END_AT_FIRST_EMPTY_SPACE_AFTER_MARKERS",()=>$localize`Your ring must land on the first empty space after a group of markers.`),u(K1,"AMBIGUOUS_CAPTURE_COORD",Yo.AMBIGUOUS_CAPTURE_COORD),u(K1,"CAPTURE_SHOULD_TAKE_RING",()=>$localize`When you capture markers, you must take one of your ring as well by clicking on it.`);class kt{static of(e,t){return e===K.NONE?kt.EMPTY:t?kt.RINGS[e.value]:kt.MARKERS[e.value]}constructor(e,t){u(this,"player",void 0),u(this,"isRing",void 0),this.player=e,this.isRing=t}equals(e){return this===e}flip(){return Ze(!1===this.isRing,"cannot flip a ring (it should never happen)"),Ze(this.player.isPlayer(),"cannot flip a non-player piece"),kt.of(this.player.getOpponent(),this.isRing)}toString(){switch(this){case kt.UNREACHABLE:return"NONE";case kt.EMPTY:return"EMPTY";case kt.MARKER_ZERO:return"MARKER_ZERO";case kt.MARKER_ONE:return"MARKER_ONE";case kt.RING_ZERO:return"RING_ZERO";default:return U.expectToBe(this,kt.RING_ONE),"RING_ONE"}}}oa=kt,u(kt,"encoder",we.tuple([K.encoder,we.identity()],r=>[r.player,r.isRing],r=>oa.of(r[0],r[1]))),u(kt,"UNREACHABLE",new oa(K.NONE,!1)),u(kt,"EMPTY",new oa(K.NONE,!1)),u(kt,"MARKER_ZERO",new oa(k.ZERO,!1)),u(kt,"MARKER_ONE",new oa(k.ONE,!1)),u(kt,"MARKERS",[oa.MARKER_ZERO,oa.MARKER_ONE]),u(kt,"RING_ZERO",new oa(k.ZERO,!0)),u(kt,"RING_ONE",new oa(k.ONE,!0)),u(kt,"RINGS",[oa.RING_ZERO,oa.RING_ONE]);let aa=(()=>{class r extends RL{static getInitialState(){const t=kt.EMPTY,n=kt.UNREACHABLE;return new r([[n,n,n,n,n,n,t,t,t,t,n],[n,n,n,n,t,t,t,t,t,t,t],[n,n,n,t,t,t,t,t,t,t,t],[n,n,t,t,t,t,t,t,t,t,t],[n,t,t,t,t,t,t,t,t,t,t],[n,t,t,t,t,t,t,t,t,t,n],[t,t,t,t,t,t,t,t,t,t,n],[t,t,t,t,t,t,t,t,t,n,n],[t,t,t,t,t,t,t,t,n,n,n],[t,t,t,t,t,t,t,n,n,n,n],[n,t,t,t,t,n,n,n,n,n,n]],[5,5],0)}constructor(t,n,i){super(i,t,r.SIZE,r.SIZE,[6,4,3,2,1],kt.EMPTY),u(this,"sideRings",void 0),this.sideRings=n}isInitialPlacementPhase(){return this.turn<10}countScores(){return this.turn<10?[0,0]:this.sideRings}equals(t){return this===t||this.turn===t.turn&&this.sideRings[0]===t.sideRings[0]&&this.sideRings[1]===t.sideRings[1]&&Ie.compareTable(this.board,t.board)}getRingCoords(t){const n=[];return this.forEachCoord((i,s)=>{s.isRing&&s.player===t&&n.push(i)}),n}isOnBoard(t){return!t.isNotInRange(this.width,this.height)&&this.board[t.y][t.x]!==kt.UNREACHABLE}setAtUnsafe(t,n){const i=Ie.copyBiArray(this.board);return i[t.y][t.x]=n,new r(i,this.sideRings,this.turn)}}return u(r,"SIZE",11),r})();var a4e,c4e;class ca extends G2{static of(e,t,n){const i=[],s=be.factory.fromMove(e,t).get();for(let o=e;!1===o.equals(t);o=o.getNext(s))i.push(o);return i.push(t),new ca(i,n)}constructor(e,t=g.empty()){if(super(e),u(this,"ringTaken",void 0),5!==e.length)throw new Error("YinshCapture must capture exactly 5 pieces");this.ringTaken=t}setRingTaken(e){return new ca(this.capturedSpaces,g.of(e))}equals(e){return!(!1===super.equals(e)||!1===this.ringTaken.equals(e.ringTaken))}}a4e=ca,u(ca,"encoder",we.tuple([we.list(C.encoder),g.getEncoder(C.encoder)],r=>[r.capturedSpaces,r.ringTaken],r=>new a4e(r[0],r[1])));class t3 extends Di{constructor(e,t,n,i){super(),u(this,"initialCaptures",void 0),u(this,"start",void 0),u(this,"end",void 0),u(this,"finalCaptures",void 0),this.initialCaptures=e,this.start=t,this.end=n,this.finalCaptures=i}isInitialPlacement(){return this.end.isAbsent()}equals(e){return this===e||!(!1===this.start.equals(e.start)||!1===this.end.equals(e.end)||!1===Ie.compareArray(this.initialCaptures,e.initialCaptures)||!1===Ie.compareArray(this.finalCaptures,e.finalCaptures))}toString(){return"YinshMove(["+this.capturesToString(this.initialCaptures)+"], "+this.start.toString()+", "+this.end.toString()+", ["+this.capturesToString(this.finalCaptures)+"])"}capturesToString(e){let t="";for(const n of e)""!==t&&(t+=","),t+="["+n.toString()+"]";return t}}c4e=t3,u(t3,"encoder",we.tuple([we.list(ca.encoder),C.encoder,g.getEncoder(C.encoder),we.list(ca.encoder)],r=>[r.initialCaptures,r.start,r.end,r.finalCaptures],r=>new c4e(r[0],r[1],r[2],r[3])));class Ka extends Yn{static get(){return Ka.singleton.isAbsent()&&(Ka.singleton=g.of(new Ka)),Ka.singleton.get()}constructor(){super(aa)}applyLegalMove(e,t,n){return new aa(n.board,n.sideRings,n.turn+1)}applyCaptures(e,t){let n=t;return e.forEach(i=>{n=this.applyCapture(i,n)}),n}applyCapture(e,t){const n=this.applyCaptureWithoutTakingRing(t,e);return this.takeRing(new aa(n,t.sideRings,t.turn),e.ringTaken.get())}takeRing(e,t){const n=e.getCurrentPlayer().value,i=e.setAt(t,kt.EMPTY).board,s=[e.sideRings[0],e.sideRings[1]];return s[n]+=1,new aa(i,s,e.turn)}applyCaptureWithoutTakingRing(e,t){return t.forEach(n=>{e=e.setAt(n,kt.EMPTY)}),e.board}ringSelectionValidity(e,t){const n=e.getCurrentPlayer().value;return e.getPieceAt(t)===kt.RINGS[n]?b.SUCCESS:b.failure(K1.CAPTURE_SHOULD_TAKE_RING())}applyRingMoveAndFlip(e,t,n){const i=n.getCurrentPlayer().value;let s=n.setAt(e,kt.MARKERS[i]);s=s.setAt(t,kt.RINGS[i]);const o=be.factory.fromMove(e,t).get();for(let a=e.getNext(o);!1===a.equals(t);a=a.getNext(o)){const c=s.getPieceAt(a);c!==kt.EMPTY&&(s=s.setAt(a,c.flip()))}return s}isLegal(e,t){if(e.isInitialPlacement())return this.initialPlacementValidity(t,e.start);if(t.isInitialPlacementPhase())return ie.failure(K1.NO_MARKERS_IN_INITIAL_PHASE());const n=this.capturesValidity(t,e.initialCaptures);if(n.isFailure())return n.toOtherFallible();const i=this.applyCaptures(e.initialCaptures,t),s=this.moveValidity(i,e.start,e.end.get());if(s.isFailure())return s.toOtherFallible();const o=this.applyRingMoveAndFlip(e.start,e.end.get(),i),a=this.capturesValidity(o,e.finalCaptures);if(a.isFailure())return a.toOtherFallible();const c=this.applyCaptures(e.finalCaptures,o),l=this.noMoreCapturesValidity(c);return l.isFailure()?l.toOtherFallible():ie.success(c)}initialPlacementValidity(e,t){if(!0!==e.isInitialPlacementPhase())return ie.failure(K1.PLACEMENT_AFTER_INITIAL_PHASE());if(e.getPieceAt(t)!==kt.EMPTY)return ie.failure(Re.MUST_CLICK_ON_EMPTY_SPACE());const n=e.getCurrentPlayer(),i=[e.sideRings[0],e.sideRings[1]];i[n.value]-=1;const s=e.setAt(t,kt.of(n,!0)).board,o=new aa(s,i,e.turn);return ie.success(o)}moveStartValidity(e,t){const n=e.getCurrentPlayer().value;return e.getPieceAt(t)!==kt.RINGS[n]?b.failure(K1.SHOULD_SELECT_PLAYER_RING()):b.SUCCESS}moveValidity(e,t,n){const i=this.moveStartValidity(e,t);if(i.isFailure())return i;if(e.getPieceAt(n)!==kt.EMPTY)return b.failure(K1.SHOULD_END_MOVE_ON_EMPTY_SPACE());const s=be.factory.fromMove(t,n);if(s.isFailure())return b.failure(K1.MOVE_DIRECTION_INVALID());const o=s.get();let a=!1;for(let c=t.getNext(o);!1===c.equals(n);c=c.getNext(o)){const l=e.getPieceAt(c);if(l===kt.EMPTY){if(a)return b.failure(K1.MOVE_SHOULD_END_AT_FIRST_EMPTY_SPACE_AFTER_MARKERS())}else{if(l.isRing)return b.failure(K1.MOVE_SHOULD_NOT_PASS_ABOVE_RING());a=!0}}return b.SUCCESS}capturesValidity(e,t){let n=e;for(const i of t){const s=this.captureValidity(n,i);if(s.isFailure())return s;n=this.applyCapture(i,n)}return b.SUCCESS}captureValidity(e,t){const n=e.getCurrentPlayer().value;for(const i of t.capturedSpaces)if(e.getPieceAt(i)!==kt.MARKERS[n])return b.failure(K1.CAN_ONLY_CAPTURE_YOUR_MARKERS());return e.getPieceAt(t.ringTaken.get())!==kt.RINGS[n]?b.failure(K1.CAPTURE_SHOULD_TAKE_RING()):b.SUCCESS}noMoreCapturesValidity(e){const t=e.getCurrentPlayer();return 0===this.getLinePortionsWithAtLeastFivePiecesOfPlayer(e,t).length?b.SUCCESS:b.failure(K1.MISSING_CAPTURES())}getLinePortionsWithAtLeastFivePiecesOfPlayer(e,t){const n=[];return e.allLines().forEach(i=>{const s=this.getLinePortionWithAtLeastFivePiecesOfPlayer(e,t,i);s.isPresent()&&n.push(s.get())}),n}getLinePortionWithAtLeastFivePiecesOfPlayer(e,t,n){let i=0;const s=e.getEntranceOnLine(n),o=n.getDirection();let c,a=s;for(c=s;e.isOnBoard(c);c=c.getNext(o)){const l=e.getPieceAt(c);if(l.player===t&&!1===l.isRing)0===i&&(a=c),i+=1;else{if(i>=5)break;i=0}}return i>=5?g.of({start:a,end:c,dir:o}):g.empty()}getPossibleCaptures(e){const t=e.getCurrentPlayer(),n=[];return this.getLinePortionsWithAtLeastFivePiecesOfPlayer(e,t).forEach(i=>{for(let s=i.start;s.getDistance(i.end)>=5;s=s.getNext(i.dir))n.push(ca.of(s,s.getNext(i.dir,4)))}),n}getRingTargets(e,t){const n=[];for(const i of be.factory.all){let s=!1;for(let o=t.getNext(i);e.isOnBoard(o);o=o.getNext(i)){const a=e.getPieceAt(o);if(a===kt.EMPTY){if(n.push(o),s)break}else{if(a.isRing)break;s=!0}}}return n}getGameStatus(e){return e.gameState.isInitialPlacementPhase()?_e.ONGOING:e.gameState.sideRings[0]>=3?_e.ZERO_WON:e.gameState.sideRings[1]>=3?_e.ONE_WON:_e.ONGOING}}u(Ka,"singleton",g.empty());const D=kt.EMPTY,he=kt.UNREACHABLE,j2=kt.MARKER_ZERO,Yi=kt.RING_ZERO,n3=kt.MARKER_ONE,S2=kt.RING_ONE;let l4e=(()=>{class r{}return u(r,"MUST_ALIGN_FIVE",()=>$localize`Failed! You need to align 5 markers of your color in order to get them, and to get a ring at the same time.`),u(r,"MUST_CAPTURE_TWO",()=>$localize`Failed! You can capture two rings in total, by capturing two times 5 of your markers. Try again.`),r})();class u4e extends Zn{constructor(...e){super(...e),u(this,"tutorial",[q.informational($localize`Goal of the game`,$localize`The goal at Yinsh is to capture three rings in total.
        The rings taken are shown on the top left for the dark player,
        and on the bottom right for the light player. Here, Dark won the game.
        Note that on the board you have two types of pieces for each player:
        rings (empty circles) and markers (full circles).`,new aa([[he,he,he,he,he,he,D,D,D,D,he],[he,he,he,he,D,D,D,D,D,D,D],[he,he,he,j2,S2,D,D,D,D,D,D],[he,he,D,j2,D,S2,D,n3,D,D,D],[he,D,Yi,n3,D,D,S2,j2,D,D,D],[he,D,D,j2,n3,D,D,D,D,D,he],[D,D,D,j2,D,D,D,S2,D,D,he],[D,D,D,n3,j2,Yi,D,D,D,he,he],[D,D,D,D,D,D,D,D,he,he,he],[D,D,D,D,D,D,D,he,he,he,he],[he,D,D,D,D,he,he,he,he,he,he]],[3,1],20)),q.anyMove($localize`Initial board and placement phase`,$localize`The initial board is empty.
        At the beginning of the game, each player puts one of its ring on the board at their turn.
        This phase stops when all rings have been placed on the board.<br/><br/>
        You're playing Dark, put one of your ring on the board by clicking the space where you want to place it.`,new aa(aa.getInitialState().board,[5,5],0),new t3([],new C(5,5),g.empty(),[]),$localize`Congratulations!`),q.anyMove($localize`Putting a marker`,$localize`Once the initial phase is done and all rings are on the board, you need to place markers on the board.
        To do so, put a marker in a ring by clicking on that ring.
        Then, the ring must be moved in a straight line, in any direction.
        A ring cannot pass through other rings during its move.
        If it goes over a group of markers, your move must stop at the first empty space after that group.
        All markers in the group are then flipped and their color change.<br/><br/>
        You're playing Dark, do a move.`,new aa([[he,he,he,he,he,he,D,D,D,D,he],[he,he,he,he,D,D,D,D,D,D,D],[he,he,he,S2,D,D,D,D,D,D,D],[he,he,S2,D,D,S2,D,D,D,D,D],[he,D,Yi,n3,D,D,S2,D,D,D,D],[he,D,D,n3,D,D,D,D,D,D,he],[D,D,D,D,Yi,D,D,S2,D,D,he],[D,D,D,D,D,Yi,D,D,D,he,he],[D,D,D,Yi,D,D,D,he,he,he,he],[D,D,D,D,D,D,D,he,he,he,he],[he,D,D,D,D,he,he,he,he,he,he]],[0,0],20),new t3([],new C(2,4),g.of(new C(4,4)),[]),$localize`Congratulations!`),q.fromPredicate($localize`Getting a ring by aligning 5 markers`,$localize`Finally, the last mechanic you need is to be able to get a ring from the board in order to gain points.
        To do so, you need to align 5 markers of your color.
        You can then get these markers by clicking on them, and then get one of your ring by clicking on it.
        You will then have one more point.
        You must capture when you can.<br/><br/>
        You're playing Dark, perform a capture!`,new aa([[he,he,he,he,he,he,D,D,D,D,he],[he,he,he,he,D,D,D,D,D,D,D],[he,he,he,S2,D,D,D,D,D,D,D],[he,he,S2,D,D,S2,D,D,D,D,D],[he,D,j2,j2,Yi,n3,n3,D,D,D,D],[he,D,D,S2,D,D,D,D,D,D,he],[D,D,D,D,Yi,D,D,S2,D,D,he],[D,D,D,D,D,Yi,D,D,D,he,he],[D,D,D,Yi,D,D,D,Yi,he,he,he],[D,D,D,D,D,D,D,he,he,he,he],[he,D,D,D,D,he,he,he,he,he,he]],[0,0],20),new t3([],new C(4,4),g.of(new C(7,4)),[ca.of(new C(2,4),new C(6,4),g.of(new C(7,4)))]),(t,n,i)=>1===i.sideRings[k.ZERO.value]?b.SUCCESS:b.failure(l4e.MUST_ALIGN_FIVE()),$localize`Congratulations!`),q.fromPredicate($localize`Compound captures`,$localize`During a turn, you could have to choose between multiple captures,
        or you could even capture multiple times!
        During the capture selection, if you see that the marker you clicked belongs to two captures, you have to click on a second marker to avoid any ambiguity.<br/><br/>
        Here, playing Dark, you can capture two rings, do it!`,new aa([[he,he,he,he,he,he,D,D,D,D,he],[he,he,he,he,Yi,D,D,S2,S2,Yi,D],[he,he,he,Yi,D,D,n3,S2,D,Yi,D],[he,he,D,Yi,D,D,D,D,D,S2,D],[he,D,D,D,D,j2,D,D,S2,D,D],[he,D,D,D,j2,j2,D,n3,D,D,he],[D,D,D,j2,D,j2,D,D,D,D,he],[D,D,j2,D,D,j2,D,D,D,he,he],[D,j2,D,D,D,j2,D,D,he,he,he],[D,D,D,D,D,j2,D,he,he,he,he],[he,D,D,D,D,he,he,he,he,he,he]],[0,0],10),new t3([ca.of(new C(5,4),new C(1,8),g.of(new C(3,2))),ca.of(new C(5,9),new C(5,5),g.of(new C(3,3)))],new C(4,1),g.of(new C(4,2)),[]),(t,n,i)=>2===i.sideRings[k.ZERO.value]?b.SUCCESS:b.failure(l4e.MUST_CAPTURE_TWO()),$localize`Congratulations!`)])}}class cvt extends fr{getMetrics(e){return e.gameState.sideRings}}class lvt{static getCombinations(e,t){return Ze(e.length>=t,"cannot compute combinations for less elements than needed"),this.getSubsetsOfSize(e,t).map(n=>this.getPermutations(n)).reduce((n,i)=>n.concat(i))}static getPermutations(e){const t=e.length,n=[e.slice()],i=new Array(t).fill(0);let s=1;for(;s<t;)if(i[s]<s){const o=s%2&&i[s],a=e[s];e[s]=e[o],e[o]=a,++i[s],s=1,n.push(e.slice())}else i[s]=0,++s;return n}static getSubsetsOfSize(e,t){return function n(i,s){if(s>=e.length||i<1)return[[]];{const o=[];for(;s<=e.length-i;){const a=e[s];for(const c of n(i-1,s+1))c.push(a),o.push(c);++s}return o}}(t,0)}}class f4e extends Un{getListMoves(e){const t=[],n=e.gameState;if(n.isInitialPlacementPhase())for(const{coord:i,content:s}of n.getCoordsAndContents())s===kt.EMPTY&&t.push(new t3([],i,g.empty(),[]));else{const i=Ka.get();this.getPossibleCaptureCombinations(n).forEach(s=>{const o=i.applyCaptures(s,n);this.getRingMoves(o).forEach(a=>{const c=i.applyRingMoveAndFlip(a.start,a.end,o);this.getPossibleCaptureCombinations(c).forEach(l=>{const f=new t3(s,a.start,g.of(a.end),l);t.push(f)})})})}return t}getPossibleCaptureCombinations(e){const n=Ka.get().getPossibleCaptures(e),i=this.getRingCoords(e);return fC.getPossibleCaptureCombinationsFromPossibleCaptures(n).map(s=>lvt.getCombinations(i,s.length).map(o=>s.map((a,c)=>new ca(a.capturedSpaces,g.of(o[c]))))).reduce((s,o)=>s.concat(o),[])}getRingMoves(e){const t=Ka.get(),n=[];for(const i of this.getRingCoords(e))for(const s of t.getRingTargets(e,i))n.push({start:i,end:s});return n}getRingCoords(e){const t=e.getCurrentPlayer().value,n=[];return e.forEachCoord((i,s)=>{s===kt.RINGS[t]&&n.push(i)}),n}}var YC;function uvt(r,e){if(1&r&&(N(),F(0,"circle",12)),2&r){const t=p(2).$implicit,n=p(2);I("cx",t.center.x)("cy",t.center.y)("r",n.viewInfo.ringOuterSize)}}function fvt(r,e){if(1&r&&(N(),F(0,"circle",13)),2&r){const t=p(2),n=t.index,i=t.$implicit,s=p().index,o=p();ye("id","ring_",n,"_",s,""),y("ngClass",i.ringClasses),I("cx",i.center.x)("cy",i.center.y)("r",o.viewInfo.ringMidSize)}}function dvt(r,e){if(1&r&&(N(),F(0,"circle",12)),2&r){const t=p(2).$implicit,n=p(2);I("cx",t.center.x)("cy",t.center.y)("r",n.viewInfo.ringInnerSize)}}function hvt(r,e){if(1&r&&(N(),F(0,"circle",14)),2&r){const t=p(2),n=t.index,i=t.$implicit,s=p().index,o=p();ye("id","marker_",n,"_",s,""),y("ngClass",i.markerClasses),I("cx",i.center.x)("cy",i.center.y)("r",o.viewInfo.markerSize)}}function pvt(r,e){if(1&r){const t=pe();N(),S(0,"g",6),W("click",function(){te(t);const i=p().$implicit;return ne(p(2).onClick(i.coord))}),F(1,"polygon",7),S(2,"g",8),T(3,uvt,1,3,"circle",9),T(4,fvt,1,6,"circle",10),T(5,dvt,1,3,"circle",9),T(6,hvt,1,6,"circle",11),P()()}if(2&r){const t=p(),n=t.index,i=t.$implicit,s=p().index;ye("id","click_",n,"_",s,""),_(1),ye("id","space_",n,"_",s,""),y("ngClass",i.spaceClasses),I("points",i.coordinates),_(1),ye("id","pieceGroup_",n,"_",s,""),y("ngClass",i.removedClass),_(1),y("ngIf",i.isRing),_(1),y("ngIf",i.isRing),_(1),y("ngIf",i.isRing),_(1),y("ngIf",i.isMarker)}}function gvt(r,e){if(1&r&&(N(),S(0,"g"),T(1,pvt,7,13,"g",5),P()),2&r){const t=e.$implicit;_(1),y("ngIf",null!=t)}}function mvt(r,e){if(1&r&&(N(),S(0,"g"),T(1,gvt,2,1,"g",1),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function _vt(r,e){if(1&r){const t=pe();N(),S(0,"polygon",15),W("click",function(){const s=te(t).$implicit;return ne(p().onClick(s))}),P()}if(2&r){const t=e.$implicit,n=p();ye("id","selected_",t.x,"_",t.y,""),I("points",n.viewInfo.spaceInfo[t.y][t.x].coordinates)}}function vvt(r,e){if(1&r){const t=pe();N(),S(0,"polygon",17),W("click",function(){const s=te(t).$implicit;return ne(p(2).onClick(s))}),P()}if(2&r){const t=e.$implicit,n=p(2);ye("id","selectable_",t.x,"_",t.y,""),I("points",n.viewInfo.spaceInfo[t.y][t.x].coordinates)}}function Cvt(r,e){if(1&r&&(N(),S(0,"g"),T(1,vvt,1,3,"polygon",16),P()),2&r){const t=p();_(1),y("ngForOf",t.viewInfo.selectableCoords)}}function yvt(r,e){if(1&r){const t=pe();N(),S(0,"rect",18),W("click",function(){const s=te(t).$implicit;return ne(p().onClick(s))}),P()}if(2&r){const t=e.$implicit,n=p();ye("id","indicator_",t.x,"_",t.y,""),I("x",n.viewInfo.spaceInfo[t.y][t.x].center.x-n.viewInfo.indicatorSize/2)("y",n.viewInfo.spaceInfo[t.y][t.x].center.y-n.viewInfo.indicatorSize/2)("width",n.viewInfo.indicatorSize)("height",n.viewInfo.indicatorSize)}}function Mvt(r,e){if(1&r&&(N(),S(0,"g"),F(1,"circle",19)(2,"circle",12)(3,"circle",20),P()),2&r){const t=e.index,n=p().$implicit,i=p();_(1),ye("id","player_",n.value,"_sideRing_",t+1,""),I("cx",(0===n.value?15:1050)+1.2*(0===n.value?1:-1)*i.viewInfo.ringOuterSize*(t+1))("cy",0===n.value?300:1260)("r",i.viewInfo.ringOuterSize),_(1),I("cx",(0===n.value?15:1050)+1.2*(0===n.value?1:-1)*i.viewInfo.ringOuterSize*(t+1))("cy",0===n.value?300:1260)("r",i.viewInfo.ringInnerSize),_(1),y("ngClass",i.viewInfo.sideRingClass[n.value]),I("cx",(0===n.value?15:1050)+1.2*(0===n.value?1:-1)*i.viewInfo.ringOuterSize*(t+1))("cy",0===n.value?300:1260)("r",i.viewInfo.ringMidSize)}}const Evt=function(){return[]};function Svt(r,e){if(1&r&&(N(),S(0,"g"),T(1,Mvt,4,12,"g",1),P()),2&r){const t=e.$implicit,n=p();I("transform","rotate("+180*(n.role.value+1)+" 532.5 780)"),_(1),y("ngForOf",D1(2,Evt).constructor(n.viewInfo.sideRings[t.value]))}}class yi extends au{constructor(e){super(e),u(this,"constructedState",void 0),u(this,"movePhase","MOVE_START"),u(this,"moveStart",g.empty()),u(this,"moveEnd",g.empty()),u(this,"currentlyMoved",[]),u(this,"currentCapture",g.empty()),u(this,"initialCaptures",[]),u(this,"finalCaptures",[]),u(this,"possibleCaptures",[]),u(this,"viewInfo",{spaceInfo:[],selectableCoords:[],selectedCoords:[],targets:[],markerSize:yi.MARKER_SIZE,ringOuterSize:yi.RING_OUTER_SIZE,ringMidSize:yi.RING_MID_SIZE,ringInnerSize:yi.RING_INNER_SIZE,indicatorSize:yi.INDICATOR_SIZE,sideRings:[5,5],sideRingClass:["player0-stroke","player1-stroke"]}),this.scores=g.of([0,0]),this.rules=Ka.get(),this.node=this.rules.getInitialNode(),this.availableAIs=[new on($localize`Score`,this.rules,new cvt,new f4e),new Kn($localize`MCTS`,new f4e,this.rules)],this.encoder=t3.encoder,this.tutorial=(new u4e).tutorial,this.hexaLayout=new cu(1.5*yi.RING_OUTER_SIZE,new C(2*yi.RING_OUTER_SIZE,0),Br.INSTANCE),this.constructedState=this.getState(),this.constructedState.allCoords().forEach(t=>{null==this.viewInfo.spaceInfo[t.y]&&(this.viewInfo.spaceInfo[t.y]=[]),this.viewInfo.spaceInfo[t.y][t.x]={coord:t,coordinates:this.getHexaPointsAt(t),center:this.getCenterAt(t),spaceClasses:[],markerClasses:[],ringClasses:[],isMarker:!1,isRing:!1,removedClass:""}})}updateBoard(e){var t=this;return M(function*(){t.cancelMoveAttempt();const n=t.getState();t.scores=g.of(n.countScores())})()}updateViewInfo(){this.constructedState.allCoords().forEach(e=>{this.viewInfo.spaceInfo[e.y][e.x].spaceClasses=this.getSpaceClasses(e);const t=this.constructedState.getPieceAt(e);this.viewInfo.spaceInfo[e.y][e.x].removedClass="",this.setRingInfo(e,t),this.setMarkerInfo(e,t)});for(const e of k.PLAYERS)this.viewInfo.sideRings[e.value]=this.constructedState.sideRings[e.value];switch(this.showCurrentMoveCaptures(),this.viewInfo.targets=[],this.viewInfo.selectableCoords=[],this.movePhase){case"INITIAL_CAPTURE_SELECT_FIRST":case"INITIAL_CAPTURE_SELECT_LAST":case"FINAL_CAPTURE_SELECT_FIRST":case"FINAL_CAPTURE_SELECT_LAST":this.viewInfo.selectableCoords=[];for(const e of this.possibleCaptures)for(const t of e.capturedSpaces)this.viewInfo.selectableCoords.push(t);break;case"INITIAL_CAPTURE_SELECT_RING":case"FINAL_CAPTURE_SELECT_RING":this.viewInfo.selectableCoords=this.constructedState.getRingCoords(this.constructedState.getCurrentPlayer());break;case"MOVE_START":!1===this.getState().isInitialPlacementPhase()&&(this.viewInfo.selectableCoords=this.constructedState.getRingCoords(this.constructedState.getCurrentPlayer()));break;case"MOVE_END":this.viewInfo.targets=this.rules.getRingTargets(this.constructedState,this.moveStart.get())}}showCurrentMoveCaptures(){this.currentCapture.isPresent()&&this.markCurrentCapture(this.currentCapture.get());for(const e of this.initialCaptures)this.markCurrentCapture(e);for(const e of this.finalCaptures)this.markCurrentCapture(e)}getSpaceClasses(e){return this.currentlyMoved.some(t=>t.equals(e))?["moved-fill"]:[]}setRingInfo(e,t){t.isRing?(this.viewInfo.spaceInfo[e.y][e.x].isRing=!0,this.viewInfo.spaceInfo[e.y][e.x].ringClasses=["player"+t.player.value+"-stroke"]):(this.viewInfo.spaceInfo[e.y][e.x].isRing=!1,this.viewInfo.spaceInfo[e.y][e.x].ringClasses=[])}setMarkerInfo(e,t){if(this.viewInfo.spaceInfo[e.y][e.x].isMarker=!1,this.viewInfo.spaceInfo[e.y][e.x].markerClasses=[],t!==kt.EMPTY&&(!1===t.isRing||this.moveStart.equalsValue(e))){const i=this.getPlayerClass(t.player);this.viewInfo.spaceInfo[e.y][e.x].isMarker=!0,this.viewInfo.spaceInfo[e.y][e.x].markerClasses=[i]}}cancelMoveAttempt(){this.constructedState=this.getState(),this.possibleCaptures=[],this.initialCaptures=[],this.finalCaptures=[],this.viewInfo.selectedCoords=[],this.currentCapture=g.empty(),this.moveStart=g.empty(),this.moveEnd=g.empty(),this.currentlyMoved=[],this.moveToInitialCaptureOrMovePhase()}showLastMove(e){var t=this;return M(function*(){if(e.isInitialPlacement())t.viewInfo.spaceInfo[e.start.y][e.start.x].spaceClasses=["moved-fill"];else{for(const i of t.coordsBetween(e.start,e.end.get()))t.viewInfo.spaceInfo[i.y][i.x].spaceClasses=["moved-fill"];const n=t.currentCapture.isAbsent()&&0===t.initialCaptures.length&&t.moveStart.isAbsent();e.initialCaptures.forEach(i=>t.showLastMoveCapture(i,n)),e.finalCaptures.forEach(i=>t.showLastMoveCapture(i,n))}})()}coordsBetween(e,t){const n=[],i=be.factory.fromMove(e,t).get();for(let s=e;!1===s.equals(t);s=s.getNext(i))this.constructedState.getPieceAt(s)!==kt.EMPTY&&n.push(s),n.push(t);return n}showLastMoveCapture(e,t){for(const n of e.capturedSpaces)this.viewInfo.spaceInfo[n.y][n.x].spaceClasses=["captured-fill"],t&&this.markRemovedMarker(n,this.getState().getCurrentOpponent());this.viewInfo.spaceInfo[e.ringTaken.get().y][e.ringTaken.get().x].spaceClasses=["captured-fill"],t&&this.markRemovedRing(e.ringTaken.get(),this.getState().getCurrentOpponent())}moveToInitialCaptureOrMovePhase(){return this.possibleCaptures=this.rules.getPossibleCaptures(this.constructedState),this.movePhase=0===this.possibleCaptures.length?"MOVE_START":"INITIAL_CAPTURE_SELECT_FIRST",this.updateViewInfo(),b.SUCCESS}onClick(e){var t=this;return M(function*(){const n=yield t.canUserPlay("#click_"+e.x+"_"+e.y);if(n.isFailure())return t.cancelMove(n.getReason());switch(t.movePhase){case"INITIAL_CAPTURE_SELECT_FIRST":case"FINAL_CAPTURE_SELECT_FIRST":return t.selectCaptureFirstCoord(e);case"INITIAL_CAPTURE_SELECT_LAST":case"FINAL_CAPTURE_SELECT_LAST":return t.selectCaptureLastCoord(e);case"INITIAL_CAPTURE_SELECT_RING":case"FINAL_CAPTURE_SELECT_RING":return t.selectRing(e);case"MOVE_START":return t.selectMoveStart(e);case"MOVE_END":return t.selectMoveEnd(e)}})()}selectCaptureFirstCoord(e){var t=this;return M(function*(){const n=[];if(t.possibleCaptures.forEach(i=>{i.contains(e)&&n.push(i)}),n.length>1)t.viewInfo.selectedCoords.push(e),t.moveToCaptureSelectLast(n);else{if(0===n.length)return t.cancelMove(K1.MISSING_CAPTURES());t.selectCapture(n[0])}return b.SUCCESS})()}moveToCaptureSelectLast(e){this.viewInfo.selectableCoords=[],this.possibleCaptures=e;for(const t of e)for(const n of t.capturedSpaces)this.viewInfo.selectableCoords.push(n);"INITIAL_CAPTURE_SELECT_FIRST"===this.movePhase?this.movePhase="INITIAL_CAPTURE_SELECT_LAST":(U.expectToBe(this.movePhase,"FINAL_CAPTURE_SELECT_FIRST","moveToCaptureSelectLast did not expect to be called in movePhase"+this.movePhase),this.movePhase="FINAL_CAPTURE_SELECT_LAST")}selectCaptureLastCoord(e){var t=this;return M(function*(){const n=[];return t.possibleCaptures.forEach(i=>{i.contains(e)&&n.push(i)}),n.length>1?t.cancelMove(K1.AMBIGUOUS_CAPTURE_COORD()):0===n.length?t.cancelMove(K1.MISSING_CAPTURES()):t.selectCapture(n[0])})()}selectCapture(e){return this.currentCapture=g.of(e),this.constructedState=new aa(this.rules.applyCaptureWithoutTakingRing(this.constructedState,e),this.constructedState.sideRings,this.constructedState.turn),"INITIAL_CAPTURE_SELECT_FIRST"===this.movePhase||"INITIAL_CAPTURE_SELECT_LAST"===this.movePhase?this.movePhase="INITIAL_CAPTURE_SELECT_RING":(Ze("FINAL_CAPTURE_SELECT_FIRST"===this.movePhase||"FINAL_CAPTURE_SELECT_LAST"===this.movePhase,"selectCapture did not expect to be called in movePhase "+this.movePhase),this.movePhase="FINAL_CAPTURE_SELECT_RING"),this.updateViewInfo(),b.SUCCESS}markCurrentCapture(e){for(const t of e.capturedSpaces)this.viewInfo.selectedCoords.push(t),this.markRemovedMarker(t,this.getState().getCurrentPlayer());e.ringTaken.isPresent()&&(this.viewInfo.selectedCoords.push(e.ringTaken.get()),this.markRemovedRing(e.ringTaken.get(),this.getState().getCurrentPlayer()))}markRemovedMarker(e,t){this.viewInfo.spaceInfo[e.y][e.x].removedClass="semi-transparent",this.setMarkerInfo(e,kt.MARKERS[t.value])}markRemovedRing(e,t){this.viewInfo.spaceInfo[e.y][e.x].removedClass="semi-transparent",this.setRingInfo(e,kt.RINGS[t.value])}selectRing(e){var t=this;return M(function*(){const n=t.rules.ringSelectionValidity(t.constructedState,e);if(n.isFailure())return t.cancelMove(n.getReason());t.constructedState=t.rules.takeRing(t.constructedState,e);const i=t.currentCapture.get().setRingTaken(e);return"INITIAL_CAPTURE_SELECT_RING"===(t.currentCapture=g.empty(),t.possibleCaptures=t.rules.getPossibleCaptures(t.constructedState),t.movePhase)?(t.initialCaptures.push(i),0===t.possibleCaptures.length?t.moveToMovePhase():(t.movePhase="INITIAL_CAPTURE_SELECT_FIRST",t.updateViewInfo(),b.SUCCESS)):(U.expectToBe(t.movePhase,"FINAL_CAPTURE_SELECT_RING"),t.finalCaptures.push(i),0===t.possibleCaptures.length?t.tryMove():(t.movePhase="FINAL_CAPTURE_SELECT_FIRST",t.updateViewInfo(),b.SUCCESS))})()}moveToMovePhase(){return this.movePhase="MOVE_START",this.updateViewInfo(),b.SUCCESS}tryMove(){var e=this;return M(function*(){const t=new t3(e.initialCaptures,e.moveStart.get(),e.moveEnd,e.finalCaptures);return yield e.chooseMove(t)})()}selectMoveStart(e){var t=this;return M(function*(){if(t.constructedState.isInitialPlacementPhase()){const n=t.rules.initialPlacementValidity(t.constructedState,e);return n.isFailure()?t.cancelMove(n.getReason()):(t.moveStart=g.of(e),t.tryMove())}{const n=t.rules.moveStartValidity(t.constructedState,e);if(n.isFailure())return t.cancelMove(n.getReason());t.moveStart=g.of(e),t.movePhase="MOVE_END",t.updateViewInfo()}return b.SUCCESS})()}selectMoveEnd(e){var t=this;return M(function*(){if(t.moveStart.equalsValue(e))return t.cancelMoveAttempt(),b.SUCCESS;const n=kt.RINGS[t.getState().getCurrentPlayer().value];if(t.constructedState.getPieceAt(e)===n)return t.cancelMoveAttempt(),t.selectMoveStart(e);const i=t.rules.moveValidity(t.constructedState,t.moveStart.get(),e);return i.isFailure()?t.cancelMove(i.getReason()):(t.moveEnd=g.of(e),t.currentlyMoved=t.coordsBetween(t.moveStart.get(),e),t.constructedState=t.rules.applyRingMoveAndFlip(t.moveStart.get(),e,t.constructedState),t.updateViewInfo(),t.moveToFinalCapturePhaseOrTryMove())})()}moveToFinalCapturePhaseOrTryMove(){var e=this;return M(function*(){return e.possibleCaptures=e.rules.getPossibleCaptures(e.constructedState),0===e.possibleCaptures.length?e.tryMove():(e.movePhase="FINAL_CAPTURE_SELECT_FIRST",e.updateViewInfo(),b.SUCCESS)})()}}function Pvt(r,e){if(1&r&&(S(0,"option",5),lt(1),P()),2&r){const t=e.$implicit;y("value",t.urlName),_(1),An(t.name)}}YC=yi,u(yi,"RING_OUTER_SIZE",40),u(yi,"RING_MID_SIZE",34),u(yi,"RING_INNER_SIZE",28),u(yi,"MARKER_SIZE",YC.RING_INNER_SIZE),u(yi,"INDICATOR_SIZE",10),u(yi,"\u0275fac",function(e){return new(e||YC)(B(Ut))}),u(yi,"\u0275cmp",qe({type:YC,selectors:[["app-yinsh"]],features:[Qe],decls:6,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","0 250 1065 1060","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base no-fill selected-stroke","pointer-events","fill","stroke-linecap","round",3,"id","click",4,"ngFor","ngForOf"],[4,"ngIf"],["class","indicator",3,"id","click",4,"ngFor","ngForOf"],[3,"id","click",4,"ngIf"],[3,"id","click"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[3,"id","ngClass"],["class","base no-fill mid-stroke",4,"ngIf"],["class","base no-fill",3,"id","ngClass",4,"ngIf"],["class","base mid-stroke",3,"id","ngClass",4,"ngIf"],[1,"base","no-fill","mid-stroke"],[1,"base","no-fill",3,"id","ngClass"],[1,"base","mid-stroke",3,"id","ngClass"],["pointer-events","fill","stroke-linecap","round",1,"base","no-fill","selected-stroke",3,"id","click"],["class","base no-fill capturable-stroke","pointer-events","fill","stroke-linecap","round",3,"id","click",4,"ngFor","ngForOf"],["pointer-events","fill","stroke-linecap","round",1,"base","no-fill","capturable-stroke",3,"id","click"],[1,"indicator",3,"id","click"],[1,"base","no-fill","mid-stroke",3,"id"],[1,"base","no-fill",3,"ngClass"]],template:function(e,t){1&e&&(N(),S(0,"svg",0),T(1,mvt,2,1,"g",1),T(2,_vt,1,3,"polygon",2),T(3,Cvt,2,1,"g",3),T(4,yvt,1,6,"rect",4),T(5,Svt,2,3,"g",1),P()),2&e&&(_(1),y("ngForOf",t.viewInfo.spaceInfo),_(1),y("ngForOf",t.viewInfo.selectedCoords),_(1),y("ngIf",t.isPlayerTurn()),_(1),y("ngForOf",t.viewInfo.targets),_(1),y("ngForOf",t.Player.PLAYERS))},dependencies:[Ft,Wt,At],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}));let kn=(()=>{class r{}return u(r,"ABALONE",()=>$localize`Use simple mechanics to push 6 of the opponent's pieces out of the board!`),u(r,"APAGOS",()=>$localize`Very simple game, but, will you be able to win everytime?`),u(r,"AWALE",()=>$localize`The most widespread of the Mancalas.`),u(r,"BRANDHUB",()=>$localize`The Irish version of the Tafl game family! Invaders must capture the king, defender must make him escape!`),u(r,"COERCEO",()=>$localize`Get rid of all of your opponent's pieces on a board that shrinks little by little!`),u(r,"CONNECT_SIX",()=>$localize`Put two pieces on the board at each turn, and be the first to align six pieces!`),u(r,"CONSPIRATEURS",()=>$localize`Hide all of your pieces before your opponent does, or risk to be discovered!`),u(r,"DIAM",()=>$localize`Drop your pieces and move them around to align two pieces of the same color across the board to win!`),u(r,"DVONN",()=>$localize`Stack your pieces and control as many stacks as you can to win!`),u(r,"ENCAPSULE",()=>$localize`An enhanced tic-tac-toe where piece can encapsule other and prevent them to win.`),u(r,"EPAMINONDAS",()=>$localize`An antiquity-war inspired game. Be the first to pierce your opponent's lines!`),u(r,"GIPF",()=>$localize`A hexagonal game of alignment. Insert your pieces on the board to capture your opponent's pieces!`),u(r,"GO",()=>$localize`The oldest strategy game still practiced widely. A territory control game.`),u(r,"HIVE",()=>$localize`You are in charge of a hive full of insects. Use the abilities of your insects to block the opponent's queen in order to win!`),u(r,"HNEFATAFL",()=>$localize`The Viking board game! Invaders must capture the king, defender must make him escape!`),u(r,"KALAH",()=>$localize`A modern version of the famous African strategy game!`),u(r,"KAMISADO",()=>$localize`Your goal is simple: reach the last line. But the piece you move depends on your opponent's last move!`),u(r,"LASCA",()=>$localize`Similar to checkers, capture opponent's pieces, free your own, and immobilize your opponent to win the game!`),u(r,"LINES_OF_ACTION",()=>$localize`Regroup your pieces to win. But your possible moves will often change!`),u(r,"LODESTONE",()=>$localize`Push and crush your opponent's pieces using magnetic forces!`),u(r,"MARTIAN_CHESS",()=>$localize`Win points by capturing pieces, but you only control pieces on your side of the board!`),u(r,"P4",()=>$localize`The classical 4 in a row game!`),u(r,"PENTAGO",()=>$localize`Drop a piece, then rotate a quadrant. The first player to align 5 pieces wins!`),u(r,"PENTE",()=>$localize`You can align 5 pieces to win, or you can capture 10 pieces of your opponent to win!`),u(r,"PYLOS",()=>$localize`Overlay your pieces and use two game mechanics to conserve your pieces. First player to run out of pieces loses!`),u(r,"QUARTO",()=>$localize`Create a winning alignment. The problem: you don't pick the piece that you're placing on the board!`),u(r,"QUIXO",()=>$localize`Align 5 of your pieces on a board where pieces slide!`),u(r,"REVERSI",()=>$localize`Sandwich your opponent's pieces to dominate the board!`),u(r,"SAHARA",()=>$localize`Immobilize one of your opponent's pyramids before your opponent does!`),u(r,"SIAM",()=>$localize`Be the first to push a mountain out of the board!`),u(r,"SIX",()=>$localize`Put your hexagonal pieces next to another one, and create one of the 3 victorious shapes to win!`),u(r,"TABLUT",()=>$localize`Lapland version of the Tafl game family! Invaders must capture the king, defender must make him escape!`),u(r,"TEEKO",()=>$localize`Align your 4 pieces or form a square with them to win!`),u(r,"TREXO",()=>$localize`Align 5 pieces of your color in a row, but beware, the pieces can be put on top of other pieces!`),u(r,"YINSH",()=>$localize`Align your pieces to score points, but beware, pieces can flip!`),r})(),Nu=(()=>{var r;class e{constructor(n,i,s,o,a,c,l,f=!0){u(this,"name",void 0),u(this,"urlName",void 0),u(this,"component",void 0),u(this,"tutorial",void 0),u(this,"rules",void 0),u(this,"creationDate",void 0),u(this,"description",void 0),u(this,"display",void 0),this.name=n,this.urlName=i,this.component=s,this.tutorial=o,this.rules=a,this.creationDate=c,this.description=l,this.display=f}}return r=e,u(e,"ALL_GAMES",()=>[new r($localize`Four in a Row`,"P4",Qpt,new l3e,v4.get(),new Date("2018-08-28"),kn.P4()),new r($localize`Awal`,"Awale",hft,new Aae,i4.get(),new Date("2018-11-29"),kn.AWALE()),new r($localize`Quarto`,"Quarto",umt,new b3e,kr.get(),new Date("2018-12-09"),kn.QUARTO()),new r($localize`Tablut`,"Tablut",x_t,new Z3e,Dl.get(),new Date("2018-12-27"),kn.TABLUT()),new r($localize`Reversi`,"Reversi",Tmt,new x3e,z0.get(),new Date("2019-01-16"),kn.REVERSI()),new r($localize`Go`,"Go",GL,new Tce,Fc.get(),new Date("2019-12-21"),kn.GO()),new r($localize`Encapsule`,"Encapsule",tdt,new pce,gu.get(),new Date("2019-12-30"),kn.ENCAPSULE()),new r($localize`Siam`,"Siam",sR,new G3e,Bs.get(),new Date("2020-01-11"),kn.SIAM()),new r($localize`Sahara`,"Sahara",Vmt,new z3e,D0.get(),new Date("2020-02-29"),kn.SAHARA()),new r($localize`Pylos`,"Pylos",kgt,new M3e,M2.get(),new Date("2020-10-02"),kn.PYLOS()),new r($localize`Kamisado`,"Kamisado",Bht,new Uce,B2.get(),new Date("2020-10-03"),kn.KAMISADO()),new r($localize`Quixo`,"Quixo",_mt,new N3e,q2.get(),new Date("2020-10-15"),kn.QUIXO()),new r($localize`Dvonn`,"Dvonn",B9t,new ace,wr.get(),new Date("2020-10-21"),kn.DVONN()),new r($localize`Epaminondas`,"Epaminondas",fdt,new _ce,$i.get(),new Date("2021-01-16"),kn.EPAMINONDAS()),new r($localize`Gipf`,"Gipf",Mdt,new Sce,Qt.get(),new Date("2021-02-22"),kn.GIPF()),new r($localize`Coerceo`,"Coerceo",l9t,new rce,lC.get(),new Date("2021-03-21"),kn.COERCEO()),new r($localize`Six`,"Six",y_t,new W3e,Jc.get(),new Date("2021-04-08"),kn.SIX()),new r($localize`Lines of Action`,"LinesOfAction",spt,new Jce,r2.get(),new Date("2021-04-28"),kn.LINES_OF_ACTION()),new r($localize`Pentago`,"Pentago",cgt,new d3e,qc.get(),new Date("2021-05-23"),kn.PENTAGO()),new r($localize`Abalone`,"Abalone",K7t,new Sae,Vo.get(),new Date("2021-07-13"),kn.ABALONE()),new r($localize`Yinsh`,"Yinsh",yi,new u4e,Ka.get(),new Date("2021-07-31"),kn.YINSH()),new r($localize`Apagos`,"Apagos",ift,new gae,r4.get(),new Date("2021-11-04"),kn.APAGOS()),new r($localize`Diam`,"Diam",Hc,new Jae,Dc.get(),new Date("2021-11-30"),kn.DIAM()),new r($localize`Brandhub`,"Brandhub",xft,new Fae,Ol.get(),new Date("2021-12-07"),kn.BRANDHUB()),new r($localize`Conspirateurs`,"Conspirateurs",M9t,new Zae,$s.get(),new Date("2021-12-30"),kn.CONSPIRATEURS()),new r($localize`Lodestone`,"Lodestone",xl,new n3e,mi.get(),new Date("2022-06-24"),kn.LODESTONE()),new r($localize`Martian Chess`,"MartianChess",Ms,new a3e,Va.get(),new Date("2022-07-01"),kn.MARTIAN_CHESS()),new r($localize`Hnefatafl`,"Hnefatafl",Aht,new Vce,Il.get(),new Date("2022-09-21"),kn.HNEFATAFL()),new r($localize`Hive`,"Hive",mht,new zce,C2.get(),new Date("2023-04-02"),kn.HIVE()),new r($localize`Trexo`,"Trexo",Fn,new i4e,Ci.get(),new Date("2023-04-23"),kn.TREXO()),new r($localize`Lasca`,"Lasca",Jht,new Kce,ta.get(),new Date("2023-05-11"),kn.LASCA()),new r($localize`Connect Six`,"ConnectSix",Gft,new Bae,Fs.get(),new Date("2023-05-13"),kn.CONNECT_SIX()),new r($localize`Pente`,"Pente",mgt,new m3e,vo.get(),new Date("2023-05-20"),kn.PENTE()),new r($localize`Teeko`,"Teeko",H_t,new X3e,sa.get(),new Date("2023-07-30"),kn.TEEKO()),new r($localize`Kalah`,"Kalah",Lht,new $ce,d4.get(),new Date("2023-09-07"),kn.KALAH())].sort((t,n)=>t.name.localeCompare(n.name))),e})(),lR=(()=>{var r;class e{constructor(){u(this,"games",Nu.ALL_GAMES()),u(this,"pickGame",new I1)}onChange(n){this.pickGame.emit(n.target.value)}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)}),u(e,"\u0275cmp",qe({type:r,selectors:[["app-pick-game"]],outputs:{pickGame:"pickGame"},decls:5,vars:1,consts:function(){let t;return t=$localize`Pick a game`,[[1,"select","is-primary","is-fullwidth"],["id","gameType",3,"change"],["value","","selected",""],t,[3,"value",4,"ngFor","ngForOf"],[3,"value"]]},template:function(n,i){1&n&&(S(0,"div",0)(1,"select",1),W("change",function(o){return i.onChange(o)}),S(2,"option",2),oe(3,3),P(),T(4,Pvt,2,2,"option",4),P()()),2&n&&(_(4),y("ngForOf",i.games))},dependencies:[Wt,ef,tf],encapsulation:2})),e})();function Tvt(r,e){if(1&r){const t=pe();S(0,"div",26)(1,"div",27),W("click",function(){return te(t),ne(p().closeInfo())}),P(),S(2,"div",28)(3,"header",29)(4,"p",30),lt(5),P(),S(6,"button",31),W("click",function(){return te(t),ne(p().closeInfo())}),P()(),S(7,"section",32)(8,"div",6)(9,"div",33)(10,"p",34),F(11,"img",35),P()(),S(12,"div",7)(13,"div",13),lt(14),P()()(),S(15,"div",6)(16,"div",33)(17,"a",36),W("click",function(){te(t);const i=p();return ne(i.createGame(i.gameInfoDetails.get().urlName))}),F(18,"fa-icon",37),lt(19,"\xa0"),S(20,"span"),oe(21,38),P()()(),S(22,"div",33)(23,"a",36),W("click",function(){te(t);const i=p();return ne(i.createLocalGame(i.gameInfoDetails.get().urlName))}),F(24,"fa-icon",37),lt(25,"\xa0"),S(26,"span"),oe(27,39),P()()(),S(28,"div",33)(29,"a",36),W("click",function(){te(t);const i=p();return ne(i.createTutorial(i.gameInfoDetails.get().urlName))}),F(30,"fa-icon",37),lt(31,"\xa0"),S(32,"span"),oe(33,40),P()()()()()()()}if(2&r){const t=p();_(5),An(t.gameInfoDetails.get().name),_(6),ye("src","assets/images/",t.theme,"/",t.gameInfoDetails.get().urlName,".png",np),_(3),O2(" ",t.gameInfoDetails.get().description," "),_(4),y("icon",t.iconOnlineGame),_(6),y("icon",t.iconLocalGame),_(6),y("icon",t.iconTutorial)}}function Ovt(r,e){if(1&r){const t=pe();S(0,"div",8)(1,"div",9)(2,"p",10),lt(3),P()(),S(4,"div",42)(5,"figure",34)(6,"img",43),W("click",function(){const s=te(t).$implicit;return ne(p(2).openInfo(s))}),P(),S(7,"figcaption",44),W("click",function(){const s=te(t).$implicit;return ne(p(2).openInfo(s))}),S(8,"div",45),lt(9,"?"),P()(),S(10,"figcaption",46)(11,"a",47),W("click",function(){const s=te(t).$implicit;return ne(p(2).createGame(s.urlName))}),F(12,"fa-icon",37),P(),S(13,"a",48),W("click",function(){const s=te(t).$implicit;return ne(p(2).createLocalGame(s.urlName))}),F(14,"fa-icon",37),P(),S(15,"a",49),W("click",function(){const s=te(t).$implicit;return ne(p(2).createTutorial(s.urlName))}),F(16,"fa-icon",37),P()()()(),S(17,"div",50),lt(18),P()()}if(2&r){const t=e.$implicit,n=p(2);_(3),An(t.name),_(3),zn("id","image_",t.urlName,""),ye("src","assets/images/",n.theme,"/",t.urlName,".png",np),_(5),zn("id","playOnline_",t.urlName,""),_(1),y("icon",n.iconOnlineGame),_(1),zn("id","playLocally_",t.urlName,""),_(1),y("icon",n.iconLocalGame),_(1),zn("id","startTutorial_",t.urlName,""),_(1),y("icon",n.iconTutorial),_(2),O2(" ",t.description," ")}}function bvt(r,e){if(1&r&&(S(0,"div",7),T(1,Ovt,19,11,"div",41),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}let wvt=(()=>{var r;class e{constructor(n,i,s,o){u(this,"router",void 0),u(this,"messageDisplayer",void 0),u(this,"currentGameService",void 0),u(this,"numberOfColumns",5),u(this,"games",[]),u(this,"theme",void 0),u(this,"iconOnlineGame",Lie),u(this,"iconLocalGame",fL),u(this,"iconTutorial",zoe),u(this,"gameInfoDetails",g.empty()),this.router=n,this.messageDisplayer=i,this.currentGameService=s,this.theme=o.getTheme();const a=Nu.ALL_GAMES();let c=0;for(let l=0;l<a.length;l++)l<this.numberOfColumns&&this.games.push([]),this.games[c].push(a[l]),c=(c+1)%this.numberOfColumns}createGame(n){var i=this;return M(function*(){const s=i.currentGameService.canUserCreate();return s.isSuccess()?i.router.navigate(null==n?["/play"]:["/play",n]):(i.messageDisplayer.criticalMessage(s.getReason()),!1)})()}createLocalGame(n){var i=this;return M(function*(){return i.router.navigate(["/local",n])})()}createTutorial(n){return this.router.navigate(["/tutorial",n])}openInfo(n){this.gameInfoDetails=g.of(n)}closeInfo(){this.gameInfoDetails=g.empty()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(Gn),B(Ut),B(ds),B(gv))}),u(e,"\u0275cmp",qe({type:r,selectors:[["app-welcome"]],decls:33,vars:2,consts:function(){let t,n,i,s,o,a,c,l,f,d,m,E,w,R;return t=$localize`EveryBoard`,n=$localize`EveryBoard is a website to play and learn the rules of various abstract strategy games with perfect information.${"\ufffd#6\ufffd\ufffd/#6\ufffd"}:LINE_BREAK: Such games are games that do not include any randomness, agility, or hidden information. These games are played by two players, turn by turn.`,i=$localize`Play online`,s=$localize`Create an online game`,o=$localize`See the game list`,a=$localize`Play offline`,c=$localize`Play`,l=$localize`Learn`,f=$localize`Play online`,d=$localize`Play offline`,m=$localize`Learn the rules`,E=$localize`Play online`,w=$localize`Play offline`,R=$localize`Learn the rules`,[[1,"hero"],[1,"hero-body"],[1,"title"],t,[1,"subtitle"],n,[1,"columns"],[1,"column"],[1,"card"],[1,"card-header"],[1,"card-header-title"],i,[1,"card-content"],[1,"content"],["id","createOnlineGame",1,"button","is-medium","is-fullwidth","is-primary","mb-1",3,"click"],s,["id","seeGameList","routerLink","/lobby",1,"button","is-medium","is-fullwidth","is-primary"],o,a,[1,"content","has-text-centered"],["routerLink","/local",1,"button","is-medium","is-fullwidth","is-primary","mb-1"],c,["routerLink","/tutorial",1,"button","is-medium","is-fullwidth","is-primary"],l,["id","gameInfoModal","class","modal is-active",4,"ngIf"],["class","column",4,"ngFor","ngForOf"],["id","gameInfoModal",1,"modal","is-active"],["id","modalBackground",1,"modal-background",3,"click"],[1,"modal-card"],[1,"modal-card-head","is-primary"],[1,"modal-card-title"],["id","closeInfo","aria-label","close",1,"delete",3,"click"],[1,"modal-card-body"],[1,"column","is-one-third"],[1,"image"],[3,"src"],[1,"button","is-fullwidth",3,"click"],[3,"icon"],f,d,m,["class","card",4,"ngFor","ngForOf"],[1,"card-image","game-card"],[1,"is-clickable",3,"id","src","click"],[1,"has-text-centered","is-overlay","game-image-text","is-clickable",3,"click"],[1,"is-size-1","has-text-weight-bold"],[1,"has-text-centered","is-overlay","game-image-buttons"],["data-tooltip",E,1,"button",3,"id","click"],["data-tooltip",w,1,"button",3,"id","click"],["data-tooltip",R,1,"button",3,"id","click"],[1,"card-content","is-hidden"]]},template:function(n,i){1&n&&(S(0,"section",0)(1,"div",1)(2,"p",2),oe(3,3),P(),S(4,"p",4),Ns(5,5),F(6,"br"),Is(),P()(),S(7,"div",6)(8,"div",7)(9,"div",8)(10,"header",9)(11,"p",10),oe(12,11),P()(),S(13,"div",12)(14,"div",13)(15,"button",14),W("click",function(){return i.createGame()}),oe(16,15),P(),S(17,"button",16),oe(18,17),P()()()()(),S(19,"div",7)(20,"div",8)(21,"header",9)(22,"p",10),oe(23,18),P()(),S(24,"div",12)(25,"div",19)(26,"button",20),oe(27,21),P(),S(28,"button",22),oe(29,23),P()()()()()(),T(30,Tvt,34,7,"div",24),S(31,"div",6),T(32,bvt,2,1,"div",25),P()()),2&n&&(_(30),y("ngIf",i.gameInfoDetails.isPresent()),_(2),y("ngForOf",i.games))},dependencies:[Wt,At,Mc,T0],encapsulation:2})),e})();const Avt=["board"];let H0=(()=>{class r{static NO_MATCHING_GAME(t){return $localize`This game (${t}) does not exist.`}}return u(r,"NOT_YOUR_TURN",()=>$localize`It is not your turn!`),u(r,"GAME_HAS_ENDED",()=>$localize`This game has ended.`),u(r,"CANNOT_PLAY_AS_OBSERVER",()=>$localize`You are an observer in this game, you cannot play.`),u(r,"MUST_ANSWER_REQUEST",()=>$localize`You must answer your opponent's request.`),r})(),KC=(()=>{var r;class e{constructor(n,i,s,o){u(this,"actRoute",void 0),u(this,"connectedUserService",void 0),u(this,"router",void 0),u(this,"messageDisplayer",void 0),u(this,"boardRef",null),u(this,"gameComponent",void 0),u(this,"players",[g.empty(),g.empty()]),u(this,"role",K.NONE),u(this,"endGame",!1),u(this,"Player",k),this.actRoute=n,this.connectedUserService=i,this.router=s,this.messageDisplayer=o}getMatchingComponent(n){return g.ofNullable(Nu.ALL_GAMES().find(s=>s.urlName===n)).map(s=>s.component)}afterViewInit(){var n=this;return M(function*(){const i=yield n.createGameComponent();return i&&(n.gameComponent.node=n.gameComponent.rules.getInitialNode(),yield n.gameComponent.updateBoard(!1)),i})()}getGameName(){return U.getNonNullable(this.actRoute.snapshot.paramMap.get("compo"))}createGameComponent(){var n=this;return M(function*(){const i=n.getGameName(),s=n.getMatchingComponent(i);if(s.isAbsent())return yield n.router.navigate(["/notFound",H0.NO_MATCHING_GAME(i)],{skipLocationChange:!0}),!1;Ze(null!=n.boardRef,"Board element should be present");const o=U.getNonNullable(n.boardRef).createComponent(s.get());return n.gameComponent=o.instance,n.gameComponent.chooseMove=a=>n.receiveValidMove(a),n.gameComponent.canUserPlay=a=>n.canUserPlay(a),n.gameComponent.isPlayerTurn=()=>n.isPlayerTurn(),n.gameComponent.cancelMoveOnWrapper=a=>n.onCancelMove(a),yield n.setRole(n.role),!0})()}setRole(n){var i=this;return M(function*(){i.role=n,i.gameComponent.role=i.role,i.gameComponent.hasAsymmetricBoard&&(i.gameComponent.rotation="rotate("+180*i.role.value+")"),yield i.updateBoardAndShowLastMove(!1)})()}receiveValidMove(n){var i=this;return M(function*(){const s=i.gameComponent.rules.isLegal(n,i.gameComponent.getState());return s.isFailure()?(yield i.gameComponent.cancelMove(s.getReason()),b.ofFallible(s)):(i.gameComponent.cancelMoveAttempt(),yield i.onLegalUserMove(n),b.SUCCESS)})()}canUserPlay(n){var i=this;return M(function*(){if(i.role===K.NONE){const s=H0.CANNOT_PLAY_AS_OBSERVER();return b.failure(s)}return!1===i.isPlayerTurn()?b.failure(H0.NOT_YOUR_TURN()):i.endGame?b.failure(H0.GAME_HAS_ENDED()):b.SUCCESS})()}isPlayerTurn(){if(this.role===K.NONE||null==this.gameComponent)return!1;const i=this.gameComponent.getTurn()%2,s=this.getPlayer();return!this.players[i].isPresent()||this.players[i].equalsValue(s)}getBoardHighlight(){return this.endGame?["endgame-bg"]:this.isPlayerTurn()?["player"+this.gameComponent.getTurn()%2+"-bg"]:[]}updateBoardAndShowLastMove(n){var i=this;return M(function*(){if(i.gameComponent.cancelMoveAttempt(),i.gameComponent.hideLastMove(),yield i.gameComponent.updateBoard(n),i.gameComponent.node.previousMove.isPresent()){const s=i.gameComponent.node.previousMove.get();yield i.gameComponent.showLastMove(s)}})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(xs),B(lr),B(Gn),B(Ut))}),u(e,"\u0275cmp",qe({type:r,selectors:[["ng-component"]],viewQuery:function(n,i){if(1&n&&k4(Avt,5,ro),2&n){let s;M3(s=E3())&&(i.boardRef=s.first)}},decls:0,vars:0,template:function(n,i){},encapsulation:2})),e})();const Nvt=["board"];let Ivt=(()=>{var r;class e extends KC{constructor(n,i,s,o,a){super(n,i,s,o),u(this,"cdr",void 0),u(this,"demoNodeInfo",void 0),u(this,"boardRef",null),this.cdr=a}getGameName(){return this.demoNodeInfo.name}ngAfterViewInit(){var n=this;return M(function*(){window.setTimeout(M(function*(){yield n.afterViewInit(),n.gameComponent.node=n.demoNodeInfo.node,yield n.setRole(n.gameComponent.getCurrentPlayer()),n.cdr.detectChanges(),n.demoNodeInfo.click.isPresent()&&(U.getNonNullable(document.querySelector(n.demoNodeInfo.click.get())).dispatchEvent(new Event("click")),n.cdr.detectChanges())}),1)})()}onLegalUserMove(n,i){return M(function*(){})()}getPlayer(){return"no-player"}onCancelMove(n){return M(function*(){})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(xs),B(lr),B(Gn),B(Ut),B(S3))}),u(e,"\u0275cmp",qe({type:r,selectors:[["app-demo-card"]],viewQuery:function(n,i){if(1&n&&k4(Nvt,5,ro),2&n){let s;M3(s=E3())&&(i.boardRef=s.first)}},inputs:{demoNodeInfo:"demoNodeInfo"},features:[Qe],decls:2,vars:0,consts:[["board",""]],template:function(n,i){1&n&&F(0,"div",null,0)},encapsulation:2})),e})();function kvt(r,e){if(1&r&&(S(0,"div",17)(1,"figure",18),F(2,"app-demo-card",19),P()()),2&r){const t=p().$implicit;_(2),y("demoNodeInfo",t)}}function xvt(r,e){if(1&r&&(S(0,"div",20)(1,"figure",21),F(2,"app-demo-card",19),P()()),2&r){const t=p().$implicit;_(2),y("demoNodeInfo",t)}}function Lvt(r,e){if(1&r&&(S(0,"div",12)(1,"div",13)(2,"p",14),lt(3),P()(),T(4,kvt,3,1,"div",15),T(5,xvt,3,1,"ng-template",null,16,un),P()),2&r){const t=e.$implicit,n=cn(6),i=p(2);_(3),An(t.name),_(1),y("ngIf",i.squared.value)("ngIfElse",n)}}function Rvt(r,e){if(1&r&&(S(0,"div",10),T(1,Lvt,7,3,"div",11),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}let zvt=(()=>{var r;class e{constructor(){u(this,"numberOfColumns",new so(5)),u(this,"squared",new so(!0)),u(this,"columns",[]),this.fillColumns(this.numberOfColumns.value),this.numberOfColumns.valueChanges.subscribe(n=>{this.fillColumns(n)})}fillColumns(n){const i=Nu.ALL_GAMES();let s=0,o=0;this.columns=[];for(const a of i){const c=[],l=a.rules,f=a.tutorial.tutorial;for(const d of f){const m=this.getNodeFromStep(d,l);c.push(m)}for(const d of c)o<n&&this.columns.push([]),this.columns[s].push({name:a.urlName,node:d.node,click:d.click}),o++,s=(s+1)%n}}getNodeFromStep(n,i){if(n.hasSolution()){const s=n.getSolution();if("string"==typeof s)return{node:new Ho(n.state),click:g.of(s)};{const o=s,a=i.isLegal(o,n.state).get(),c=i.applyLegalMove(o,n.state,a),l=g.of(new Ho(n.state));return{node:new Ho(c,l,g.of(o)),click:g.empty()}}}return{node:new Ho(n.state),click:g.empty()}}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)}),u(e,"\u0275cmp",qe({type:r,selectors:[["app-demo-page"]],decls:17,vars:4,consts:function(){let t,n;return t=$localize`Number of columns: `,n=$localize`Squared`,[[1,"field"],["for","numberOfColumns",1,"label"],t,[1,"control"],["step","1","min","1","max","10","name","maximalMoveDuration","type","range",1,"slider","is-circle","is-primary",3,"formControl"],[1,"checkbox"],["type","checkbox",3,"formControl"],n,[1,"columns"],["class","column",4,"ngFor","ngForOf"],[1,"column"],["class","card",4,"ngFor","ngForOf"],[1,"card"],[1,"card-header"],[1,"card-header-title"],["class","card-image game-card","style","height: 200px;",4,"ngIf","ngIfElse"],["nonSquared",""],[1,"card-image","game-card",2,"height","200px"],[1,"image",2,"height","100%"],[3,"demoNodeInfo"],[1,"card-image","game-card"],[1,"image"]]},template:function(n,i){1&n&&(S(0,"form")(1,"div",0)(2,"label",1),Gt(3),oe(4,2),Bt(),S(5,"output"),lt(6),P()(),S(7,"div",3),F(8,"input",4),P()(),S(9,"div",0)(10,"label",5),F(11,"input",6),lt(12," \xa0"),Gt(13),oe(14,7),Bt(),P()()(),S(15,"div",8),T(16,Rvt,2,1,"div",9),P()),2&n&&(_(6),An(i.numberOfColumns.value),_(2),y("formControl",i.numberOfColumns),_(3),y("formControl",i.squared),_(5),y("ngForOf",i.columns))},dependencies:[Wt,At,v6,_c,hg,OS,b3,m6,VS,Q7,Ivt],encapsulation:2})),e})(),uR=(()=>{var r;class e{constructor(n){u(this,"element",void 0),this.element=n}ngAfterViewInit(){this.element.nativeElement.focus()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(Oi))}),u(e,"\u0275dir",Rt({type:r,selectors:[["","autofocus",""]]})),e})(),d4e=(()=>{var r;class e{constructor(n){u(this,"shown",!1),u(this,"input",void 0),this.input=n.nativeElement.parentNode.previousSibling,n.nativeElement.addEventListener("click",i=>{this.toggle()})}toggle(){this.shown=!1===this.shown,this.input.setAttribute("type",this.shown?"text":"password"),this.input.focus()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(Oi))}),u(e,"\u0275dir",Rt({type:r,selectors:[["","toggleVisibility",""]]})),e})();function Dvt(r,e){if(1&r&&(S(0,"div",29)(1,"div",30),oe(2,31),P(),S(3,"div",32),lt(4),P()()),2&r){const t=p();_(4),An(t.errorMessage)}}const Hvt=function(){return["/register"]},Vvt=function(){return["/reset-password"]};let Fvt=(()=>{var r;class e{constructor(n,i){u(this,"router",void 0),u(this,"connectedUserService",void 0),u(this,"faEye",$x),u(this,"errorMessage",void 0),u(this,"loginForm",new V4({email:new so,password:new so})),u(this,"userSubscription",void 0),this.router=n,this.connectedUserService=i}ngOnInit(){var n=this;this.userSubscription=this.connectedUserService.subscribeToUser(function(){var i=M(function*(s){s!==_0.NOT_CONNECTED&&(yield n.redirect())});return function(s){return i.apply(this,arguments)}}())}loginWithEmail(n){var i=this;return M(function*(){const s=yield i.connectedUserService.doEmailLogin(n.email,n.password);s.isFailure()&&(i.errorMessage=s.getReason())})()}loginWithGoogle(){var n=this;return M(function*(){const i=yield n.connectedUserService.doGoogleLogin();i.isFailure()&&(n.errorMessage=i.getReason())})()}redirect(){var n=this;return M(function*(){return n.router.navigate(["/lobby"])})()}canLogin(){return!(""===(this.loginForm.value.email??"")||""===(this.loginForm.value.password??""))}ngOnDestroy(){this.userSubscription.unsubscribe()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(Gn),B(lr))}),u(e,"\u0275cmp",qe({type:r,selectors:[["app-login"]],decls:49,vars:8,consts:function(){let t,n,i,s,o,a,c,l,f,d,m,E;return t=$localize`Log in`,n=$localize`Email`,i=$localize`Email`,s=$localize`Password`,o=$localize`Password`,a=$localize`Log in`,c=$localize`Log in with Google`,l=$localize`No account?`,f=$localize`Register`,d=$localize`Forgot your password?`,m=$localize`Reset your password`,E=$localize`Connection error`,[[1,"box"],[1,"title"],t,[3,"formGroup"],[1,"field","is-horizontal"],[1,"field-label","is-normal"],["for","email",1,"label"],n,[1,"field-body"],[1,"field"],[1,"control"],["id","email","type","text","placeholder",i,"formControlName","email","name","email","type","email","autofocus","","required","",1,"input"],["for","password",1,"label"],s,[1,"control","has-icons-right","is-expanded"],["id","password","type","password","placeholder",o,"formControlName","password","name","password","required","",1,"input"],[1,"icon","is-small","is-right"],["toggleVisibility","",1,"clickable-icon",3,"icon"],["id","loginButton",1,"button","is-primary","is-fullwidth",3,"disabled","click"],a,["id","googleButton","type","submit",1,"button","is-fullwidth",3,"click"],c,["class","message is-danger","role","alert",4,"ngIf"],[1,"help","level-right"],l,[3,"routerLink"],f,d,m,["role","alert",1,"message","is-danger"],[1,"message-header"],E,["id","errorMessage",1,"message-body"]]},template:function(n,i){1&n&&(S(0,"div",0)(1,"p",1),oe(2,2),P(),S(3,"form",3)(4,"div",4)(5,"div",5)(6,"label",6),oe(7,7),P()(),S(8,"div",8)(9,"div",9)(10,"div",10),F(11,"input",11),P()()()(),S(12,"div",4)(13,"div",5)(14,"label",12),oe(15,13),P()(),S(16,"div",8)(17,"div",9)(18,"div",14),F(19,"input",15),S(20,"span",16),F(21,"fa-icon",17),P()()()()(),S(22,"div",4),F(23,"div",5),S(24,"div",8)(25,"div",9)(26,"div",10)(27,"button",18),W("click",function(){return i.loginWithEmail(i.loginForm.value)}),oe(28,19),P()()()()(),S(29,"div",4),F(30,"div",5),S(31,"div",8)(32,"div",9)(33,"div",10)(34,"button",20),W("click",function(){return i.loginWithGoogle()}),oe(35,21),P()()()()(),T(36,Dvt,5,1,"div",22),S(37,"p",23),Gt(38),oe(39,24),Bt(),lt(40,"\xa0 "),S(41,"a",25),oe(42,26),P()(),S(43,"p",23),Gt(44),oe(45,27),Bt(),lt(46,"\xa0 "),S(47,"a",25),oe(48,28),P()()()()),2&n&&(_(3),y("formGroup",i.loginForm),_(18),y("icon",i.faEye),_(6),y("disabled",!i.canLogin()),_(9),y("ngIf",i.errorMessage),_(5),y("routerLink",D1(6,Hvt)),_(6),y("routerLink",D1(7,Vvt)))},dependencies:[At,Mc,v6,_c,b3,m6,M6,C6,F8,T0,uR,d4e],encapsulation:2})),e})(),$vt=(()=>{var r;class e{constructor(n){u(this,"partDAO",void 0),this.partDAO=n}subscribeToActiveParts(n){let i=[];const c=new pv(l=>{i=i.concat(...l),n(i)},l=>{const f=i;for(const d of l)f.forEach(m=>{m.id===d.id&&(m.data=d.data)});i=f,n(i)},l=>{const f=[];for(const d of i)l.every(m=>m.id!==d.id)&&f.push(d);i=f,n(i)});return this.partDAO.observingWhere([["result","==",L1.UNACHIEVED.value]],c)}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(Pe(od))}),u(e,"\u0275prov",He({token:r,factory:r.\u0275fac,providedIn:"root"})),e})(),Gvt=(()=>{var r;class e{transform(n){return yG(1e3*n.seconds,"HH:mm:ss","en-US")}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)}),u(e,"\u0275pipe",Si({name:"firestoreTime",type:r,pure:!0})),e})();var Iu;const Uvt=["chatDiv"];function Wvt(r,e){1&r&&(Gt(0),oe(1,5),Bt())}function qvt(r,e){1&r&&oe(0,6),2&r&&($n(p().unreadMessagesText),jn(0))}function jvt(r,e){if(1&r){const t=pe();S(0,"button",11),W("click",function(){return te(t),ne(p(2).scrollToBottom())}),lt(1),P()}if(2&r){const t=p(2);_(1),O2("",t.unreadMessagesText," \u2193")}}function Zvt(r,e){if(1&r&&(S(0,"p"),lt(1),va(2,"firestoreTime"),S(3,"b",12),lt(4),P(),S(5,"span",13),lt(6),P()()),2&r){const t=e.$implicit;_(1),O2(" [",pc(2,3,t.postedTime),"] "),_(3),O2("",t.sender.name," : "),_(2),An(t.content)}}function Yvt(r,e){if(1&r){const t=pe();S(0,"div"),T(1,jvt,2,1,"button",7),S(2,"div",8,9),W("scroll",function(){return te(t),ne(p().updateCurrentScrollPosition())}),T(4,Zvt,7,5,"p",10),P()()}if(2&r){const t=p();_(1),y("ngIf",t.showUnreadMessagesButton),_(3),y("ngForOf",t.chat)}}const Kvt=function(){return{standalone:!0}};function Xvt(r,e){if(1&r){const t=pe();S(0,"form",14),W("onSubmit",function(){return te(t),ne(p().sendMessage())}),S(1,"div",15)(2,"div",16)(3,"input",17,18),W("ngModelChange",function(i){return te(t),ne(p().userMessage=i)}),P(),S(5,"p",19),lt(6),P()(),S(7,"div",20)(8,"button",21),W("click",function(){return te(t),ne(p().sendMessage())}),F(9,"fa-icon",22),P()()(),S(10,"div",23)(11,"p")(12,"strong"),oe(13,24),P()()()()}if(2&r){const t=cn(4),n=p();_(3),y("ngModel",n.userMessage)("ngModelOptions",D1(4,Kvt)),_(3),O2("",t.value.length,"/128"),_(3),y("icon",n.faReply)}}let XC=(Iu=class{constructor(e,t){u(this,"chatService",void 0),u(this,"connectedUserService",void 0),u(this,"chatId",void 0),u(this,"turn",void 0),u(this,"userMessage",""),u(this,"connected",!1),u(this,"chat",[]),u(this,"readMessages",0),u(this,"unreadMessagesText",""),u(this,"showUnreadMessagesButton",!1),u(this,"visible",!0),u(this,"faReply",Ox),u(this,"isNearBottom",!0),u(this,"notYetScrolled",!0),u(this,"chatSubscription",void 0),u(this,"chatDiv",void 0),this.chatService=e,this.connectedUserService=t}ngOnInit(){Ze(null!=this.chatId&&""!==this.chatId,"No chat to join mentionned"),this.loadChatContent()}ngAfterViewChecked(){this.scrollToBottomIfNeeded()}loadChatContent(){const e=n=>{this.updateMessages(n.flatMap(i=>null==i.data.postedTime?[]:[i.data]))},t=new pv(e,e,()=>{});this.chatSubscription=this.chatService.subscribeToMessages(this.chatId,t)}updateMessages(e){this.chat=this.chat.concat(e);const t=this.chat.length;!0===this.visible&&!0===this.isNearBottom?(this.readMessages=t,this.updateUnreadMessagesText(0),this.scrollToBottom()):this.updateUnreadMessagesText(t-this.readMessages)}updateUnreadMessagesText(e){this.showUnreadMessagesButton=!(!this.visible||!1!==this.isNearBottom),0===e?(this.unreadMessagesText=$localize`no new message`,this.showUnreadMessagesButton=!1):this.unreadMessagesText=1===e?$localize`1 new message`:$localize`${e} new messages`}scrollToBottomIfNeeded(){this.visible&&(this.isNearBottom||this.notYetScrolled)&&this.scrollToBottom()}updateCurrentScrollPosition(){this.isNearBottom=this.chatDiv.nativeElement.scrollTop+this.chatDiv.nativeElement.offsetHeight>this.chatDiv.nativeElement.scrollHeight-10}scrollToBottom(){null!=this.chatDiv&&(this.updateUnreadMessagesText(0),this.scrollTo(this.chatDiv.nativeElement.scrollHeight),this.notYetScrolled=!1)}scrollTo(e){this.chatDiv.nativeElement.scroll({top:e,left:0,behavior:"smooth"})}sendMessage(){var e=this;return M(function*(){const t=e.userMessage;e.userMessage="";const n=e.connectedUserService.user.get().toMinimalUser();yield e.chatService.sendMessage(e.chatId,n,t,e.turn)})()}ngOnDestroy(){this.chatSubscription.unsubscribe()}switchChatVisibility(){!0===this.visible?this.visible=!1:(this.visible=!0,this.updateUnreadMessagesText(0),this.scrollToBottom(),this.readMessages=this.chat.length)}},u(Iu,"\u0275fac",function(e){return new(e||Iu)(B(Z5),B(lr))}),u(Iu,"\u0275cmp",qe({type:Iu,selectors:[["app-chat"]],viewQuery:function(e,t){if(1&e&&k4(Uvt,5),2&e){let n;M3(n=E3())&&(t.chatDiv=n.first)}},inputs:{chatId:"chatId",turn:"turn"},decls:7,vars:4,consts:function(){let r,e,t,n;return r=$localize`Hide chat`,e=$localize`Show chat (${"\ufffd0\ufffd"}:INTERPOLATION:)`,t=$localize`Type your message here`,n=$localize`Be polite`,[["id","switchChatVisibilityButton",1,"button","is-primary","is-light","is-fullwidth",3,"click"],[4,"ngIf","ngIfElse"],["showChat",""],[4,"ngIf"],["id","chatForm",3,"onSubmit",4,"ngIf"],r,e,["id","scrollToBottomIndicator","class","notification button is-info is-light is-fullwidth",3,"click",4,"ngIf"],["id","chatDiv",1,"is-fullwidth","block",2,"overflow-y","scroll","max-height","50vh",3,"scroll"],["chatDiv",""],[4,"ngFor","ngForOf"],["id","scrollToBottomIndicator",1,"notification","button","is-info","is-light","is-fullwidth",3,"click"],[1,"chat-sender"],[1,"chat-message"],["id","chatForm",3,"onSubmit"],[1,"field","has-addons","is-fullwidth"],[1,"control","is-expanded"],["id","message","type","text","placeholder",t,"maxlength","128","value","",1,"input",3,"ngModel","ngModelOptions","ngModelChange"],["message",""],[1,"help"],[1,"control"],["type","submit","id","send",1,"button","is-primary",3,"click"],[1,"clickable-icon",3,"icon"],[1,"content","is-small"],n]},template:function(e,t){if(1&e&&(S(0,"div")(1,"button",0),W("click",function(){return t.switchChatVisibility()}),T(2,Wvt,2,0,"ng-container",1),T(3,qvt,1,1,"ng-template",null,2,un),P(),T(5,Yvt,5,2,"div",3),T(6,Xvt,14,5,"form",4),P()),2&e){const n=cn(4);_(2),y("ngIf",t.visible)("ngIfElse",n),_(3),y("ngIf",t.visible),_(1),y("ngIf",t.visible)}},dependencies:[Wt,At,v6,_c,b3,m6,BS,J7,Q7,T0,Gvt],encapsulation:2})),Iu);XC=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ne.log],XC);let h4e=(()=>{var r;class e{constructor(n,i,s){u(this,"router",void 0),u(this,"currentGameService",void 0),u(this,"messageDisplayer",void 0),u(this,"selectedGame",void 0),this.router=n,this.currentGameService=i,this.messageDisplayer=s}pickGame(n){this.selectedGame=n}navigateToOnlineGameCreation(){var n=this;return M(function*(){const i=n.currentGameService.canUserCreate();i.isSuccess()?yield n.router.navigate(["/play",n.selectedGame]):n.messageDisplayer.criticalMessage(i.getReason())})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(Gn),B(ds),B(Ut))}),u(e,"\u0275cmp",qe({type:r,selectors:[["app-online-game-selection"]],decls:3,vars:1,consts:function(){let t;return t=$localize`Create an online game`,[[3,"pickGame"],["id","launchGame",1,"button","is-primary","is-fullwidth",3,"disabled","click"],t]},template:function(n,i){1&n&&(S(0,"app-pick-game",0),W("pickGame",function(o){return i.pickGame(o)}),P(),S(1,"button",1),W("click",function(){return i.navigateToOnlineGameCreation()}),oe(2,2),P()),2&n&&(_(1),y("disabled",!i.selectedGame))},dependencies:[lR],encapsulation:2})),e})();var ku;function Jvt(r,e){if(1&r&&(Gt(0),lt(1),Bt()),2&r){const t=p().$implicit;_(1),An(t.data.playerOne.name)}}function eCt(r,e){1&r&&(Gt(0),oe(1,27),Bt())}function tCt(r,e){if(1&r){const t=pe();S(0,"tr",22),W("click",function(){const s=te(t).$implicit;return ne(p(2).joinGame(s))}),S(1,"td",23),lt(2),P(),S(3,"td",23),lt(4),P(),S(5,"td",23),T(6,Jvt,2,1,"ng-container",24),T(7,eCt,2,0,"ng-template",null,25,un),P(),S(9,"td",26),lt(10),P()()}if(2&r){const t=e.$implicit,n=e.index,i=cn(8);zn("id","part_",n,""),_(2),An(t.data.typeGame),_(2),An(t.data.playerZero.name),_(2),y("ngIf",t.data.playerOne)("ngIfElse",i),_(4),An(t.data.turn+1)}}function nCt(r,e){if(1&r&&(S(0,"div",13)(1,"div",14)(2,"table",15)(3,"thead")(4,"tr")(5,"th",16),oe(6,17),P(),S(7,"th",16),oe(8,18),P(),S(9,"th",16),oe(10,19),P(),S(11,"th",16),oe(12,20),P()()(),S(13,"tbody"),T(14,tCt,11,6,"tr",21),P()()()()),2&r){const t=p();_(14),y("ngForOf",t.activeParts)}}function rCt(r,e){1&r&&(S(0,"div",28),F(1,"app-online-game-selection",29),P())}function iCt(r,e){1&r&&(S(0,"div",30)(1,"div",31)(2,"div",32),F(3,"app-chat",33),P()()()),2&r&&(_(3),y("turn",-1))}let fR=(ku=class{constructor(e,t,n,i){u(this,"router",void 0),u(this,"messageDisplayer",void 0),u(this,"activePartsService",void 0),u(this,"currentGameService",void 0),u(this,"activeParts",[]),u(this,"activePartsSubscription",void 0),u(this,"currentGameSubscription",void 0),u(this,"currentTab","games"),u(this,"createTabClasses",[]),this.router=e,this.messageDisplayer=t,this.activePartsService=n,this.currentGameService=i}ngOnInit(){this.activePartsSubscription=this.activePartsService.subscribeToActiveParts(e=>{this.activeParts=e}),this.currentGameSubscription=this.currentGameService.subscribeToCurrentGame(e=>{this.createTabClasses=[],e.isPresent()&&(this.createTabClasses=["disabled-tab"])})}ngOnDestroy(){this.activePartsSubscription.unsubscribe(),this.currentGameSubscription.unsubscribe()}joinGame(e){var t=this;return M(function*(){const n=e.id,i=e.data.typeGame,o=t.currentGameService.canUserJoin(n,null!=e.data.beginning);o.isSuccess()?yield t.router.navigate(["/play",i,n]):t.messageDisplayer.criticalMessage(o.getReason())})()}selectTab(e){if("create"===e){const t=this.currentGameService.canUserCreate();t.isSuccess()?this.currentTab=e:this.messageDisplayer.criticalMessage(t.getReason())}else this.currentTab=e}},u(ku,"\u0275fac",function(e){return new(e||ku)(B(Gn),B(Ut),B($vt),B(ds))}),u(ku,"\u0275cmp",qe({type:ku,selectors:[["app-lobby"]],decls:14,vars:4,consts:function(){let r,e,t,n,i,s,o,a;return r=$localize`Games`,e=$localize`Create`,t=$localize`Chat`,n=$localize`Game`,i=$localize`First player`,s=$localize`Second player`,o=$localize`Turn`,a=$localize`Waiting for opponent`,[[1,"tabs","is-toggle","is-fullwidth"],["ngClass","if (currentTab === 'games') 'is-active'"],["id","tab-games",3,"click"],r,["ngClass","if (currentTab === 'create') 'is-active'"],["id","tab-create",3,"ngClass","click"],e,["ngClass","if (currentTab === 'chat') 'is-active'"],["id","tab-chat",3,"click"],t,["id","actualGames","class","box",4,"ngIf"],["id","gameCreator","class","box",4,"ngIf"],["id","chatTab","class","columns",4,"ngIf"],["id","actualGames",1,"box"],[1,"table-container"],[1,"table","is-fullwidth","is-hoverable","is-striped"],["scope","col",1,"th"],n,i,s,o,[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"td"],[4,"ngIf","ngIfElse"],["waitingForOpponent",""],[1,"td","turn"],a,["id","gameCreator",1,"box"],["id","online-game-selection"],["id","chatTab",1,"columns"],[1,"column","is-12"],["id","chat",1,"box"],["chatId","server",3,"turn"]]},template:function(e,t){1&e&&(S(0,"div",0)(1,"ul")(2,"li",1)(3,"a",2),W("click",function(){return t.selectTab("games")}),oe(4,3),P()(),S(5,"li",4)(6,"a",5),W("click",function(){return t.selectTab("create")}),oe(7,6),P()(),S(8,"li",7)(9,"a",8),W("click",function(){return t.selectTab("chat")}),oe(10,9),P()()()(),T(11,nCt,15,1,"div",10),T(12,rCt,2,0,"div",11),T(13,iCt,4,1,"div",12)),2&e&&(_(6),y("ngClass",t.createTabClasses),_(5),y("ngIf","games"===t.currentTab),_(1),y("ngIf","create"===t.currentTab),_(1),y("ngIf","chat"===t.currentTab))},dependencies:[Ft,Wt,At,XC,h4e],encapsulation:2})),ku);fR=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ne.log],fR);let sCt=(()=>{var r;class e{constructor(){}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)}),u(e,"\u0275cmp",qe({type:r,selectors:[["app-account"]],decls:11,vars:0,consts:function(){let t,n,i;return t=$localize`User settings`,n=$localize`If you forgot your password or want to change it, click on the following button:`,i=$localize`Reset password`,[[1,"hero-body"],[1,"title"],t,[1,"box"],[1,"block","level-left"],[1,"level-item"],n,["id","reset","routerLink","/reset-password",1,"button","is-primary","level-item","is-small"],i]},template:function(n,i){1&n&&(S(0,"div",0)(1,"p",1),oe(2,2),P()(),S(3,"div",3)(4,"p",1),lt(5,"Resetting password"),P(),S(6,"div",4)(7,"p",5),oe(8,6),P(),S(9,"button",7),oe(10,8),P()()())},dependencies:[Mc],encapsulation:2})),e})(),p4e=(()=>{var r;class e{constructor(n){u(this,"route",void 0),u(this,"message",void 0),this.route=n,this.message=n.snapshot.paramMap.get("message")??$localize`This page does not exist.`}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(xs))}),u(e,"\u0275cmp",qe({type:r,selectors:[["app-not-found"]],decls:5,vars:1,consts:function(){let t;return t=$localize`Not found`,[[1,"message","is-danger"],[1,"message-header"],t,[1,"message-body"]]},template:function(n,i){1&n&&(S(0,"div",0)(1,"div",1),oe(2,2),P(),S(3,"div",3),lt(4),P()()),2&n&&(_(4),An(i.message))},encapsulation:2})),e})();new Error("timeout while waiting for mutex to become available"),new Error("mutex already locked");const cCt=new Error("request for lock canceled");class uCt{constructor(e,t=cCt){this._value=e,this._cancelError=t,this._weightedQueues=[],this._weightedWaiters=[]}acquire(e=1){if(e<=0)throw new Error(`invalid weight ${e}: must be positive`);return new Promise((t,n)=>{this._weightedQueues[e-1]||(this._weightedQueues[e-1]=[]),this._weightedQueues[e-1].push({resolve:t,reject:n}),this._dispatch()})}runExclusive(e,t=1){return function(r,e,t,n){return new(t||(t=Promise))(function(s,o){function a(f){try{l(n.next(f))}catch(d){o(d)}}function c(f){try{l(n.throw(f))}catch(d){o(d)}}function l(f){f.done?s(f.value):function i(s){return s instanceof t?s:new t(function(o){o(s)})}(f.value).then(a,c)}l((n=n.apply(r,e||[])).next())})}(this,void 0,void 0,function*(){const[n,i]=yield this.acquire(t);try{return yield e(n)}finally{i()}})}waitForUnlock(e=1){if(e<=0)throw new Error(`invalid weight ${e}: must be positive`);return new Promise(t=>{this._weightedWaiters[e-1]||(this._weightedWaiters[e-1]=[]),this._weightedWaiters[e-1].push(t),this._dispatch()})}isLocked(){return this._value<=0}getValue(){return this._value}setValue(e){this._value=e,this._dispatch()}release(e=1){if(e<=0)throw new Error(`invalid weight ${e}: must be positive`);this._value+=e,this._dispatch()}cancel(){this._weightedQueues.forEach(e=>e.forEach(t=>t.reject(this._cancelError))),this._weightedQueues=[]}_dispatch(){var e;for(let t=this._value;t>0;t--){const n=null===(e=this._weightedQueues[t-1])||void 0===e?void 0:e.shift();if(!n)continue;const i=this._value,s=t;this._value-=t,t=this._value+1,n.resolve([i,this._newReleaser(s)])}this._drainUnlockWaiters()}_newReleaser(e){let t=!1;return()=>{t||(t=!0,this.release(e))}}_drainUnlockWaiters(){for(let e=this._value;e>0;e--)this._weightedWaiters[e-1]&&(this._weightedWaiters[e-1].forEach(t=>t()),this._weightedWaiters[e-1]=[])}}class dCt{constructor(e){this._semaphore=new uCt(1,e)}acquire(){return function(r,e,t,n){return new(t||(t=Promise))(function(s,o){function a(f){try{l(n.next(f))}catch(d){o(d)}}function c(f){try{l(n.throw(f))}catch(d){o(d)}}function l(f){f.done?s(f.value):function i(s){return s instanceof t?s:new t(function(o){o(s)})}(f.value).then(a,c)}l((n=n.apply(r,e||[])).next())})}(this,void 0,void 0,function*(){const[,e]=yield this._semaphore.acquire();return e})}runExclusive(e){return this._semaphore.runExclusive(()=>e())}isLocked(){return this._semaphore.isLocked()}waitForUnlock(){return this._semaphore.waitForUnlock()}release(){this._semaphore.isLocked()&&this._semaphore.release()}cancel(){return this._semaphore.cancel()}}let m4e=(()=>{var r;class e{constructor(){u(this,"requestAwaitingReply",g.empty()),u(this,"lastDeniedRequest",g.empty()),u(this,"forbiddenRequests",new dt)}onGameStart(){this.requestAwaitingReply=g.empty(),this.lastDeniedRequest=g.empty(),this.forbiddenRequests=new dt}onReceivedMove(){this.forbiddenRequests=new dt,this.lastDeniedRequest=g.empty()}onReceivedRequest(n){U.assert(this.requestAwaitingReply.isAbsent(),"Should not receive two requests in a row!"),this.requestAwaitingReply=g.of(n)}onReceivedReply(n,i){var s=this;return M(function*(){switch(s.requestAwaitingReply=g.empty(),n.reply){case"Accept":return!0;case"Reject":return n.player===i.getOpponent().value&&(s.lastDeniedRequest=g.of(n.requestType),s.forbiddenRequests.add(n.requestType)),!1}})()}canMakeRequest(n){return!(this.requestAwaitingReply.isPresent()||this.forbiddenRequests.contains(n))}getRequestAwaitingReplyFrom(n){return this.requestAwaitingReply.isPresent()&&this.requestAwaitingReply.get().player===n.getOpponent().value?g.of(this.requestAwaitingReply.get().requestType):g.empty()}getCurrentRequest(){return this.requestAwaitingReply}deniedRequest(){return this.lastDeniedRequest}}return r=e,u(e,"requestInfos",{TakeBack:{requestType:"TakeBack",textForRequest:()=>$localize`Ask to take back one move`,textForReply:()=>$localize`Your opponent is asking for a take back.`,name:()=>$localize`take back`,icon:Yx},Draw:{requestType:"Draw",textForRequest:()=>$localize`Propose a draw`,textForReply:()=>$localize`Your opponent is proposing a draw.`,name:()=>$localize`draw`,icon:Dne},Rematch:{requestType:"Rematch",textForRequest:()=>$localize`Propose a rematch`,textForReply:()=>$localize`Your opponent is proposing a rematch.`,name:()=>$localize`rematch`,icon:v1e}}),u(e,"\u0275fac",function(n){return new(n||r)}),u(e,"\u0275prov",He({token:r,factory:r.\u0275fac,providedIn:"root"})),e})(),pCt=(()=>{var r;class e{constructor(){u(this,"turnClocks",void 0),u(this,"globalClocks",void 0),u(this,"allClocks",void 0),u(this,"configRoom",g.empty()),u(this,"takenGlobalTime",[0,0]),u(this,"extraGlobalTime",[0,0]),u(this,"availableTurnTime",[0,0]),u(this,"lastMoveStartTimestamp",g.empty())}setClocks(n,i){this.turnClocks=n,this.globalClocks=i,this.allClocks=n.concat(i)}onGameStart(n){this.configRoom=g.of(n);for(const i of k.PLAYERS)this.takenGlobalTime[i.value]=0,this.extraGlobalTime[i.value]=0,this.availableTurnTime[i.value]=this.getMoveDurationInMs(),this.globalClocks[i.value].setDuration(this.getPartDurationInMs()),this.turnClocks[i.value].setDuration(this.getMoveDurationInMs());for(const i of this.allClocks)i.start(),i.pause()}getPartDurationInMs(){return 1e3*this.configRoom.get().totalPartDuration}getMoveDurationInMs(){return 1e3*this.configRoom.get().maximalMoveDuration}onReceivedAction(n){switch(n.action){case"AddTurnTime":this.addTurnTime(k.of(n.player));break;case"AddGlobalTime":this.addGlobalTime(k.of(n.player));break;case"StartGame":this.lastMoveStartTimestamp=g.of(n.time);break;case"EndGame":this.onGameEnd()}}onReceivedMove(n){const i=k.of(n.player),s=n.time,o=this.getMillisecondsElapsedSinceLastMoveStart(s);this.lastMoveStartTimestamp=g.of(s),this.takenGlobalTime[i.value]+=o,this.availableTurnTime[i.value]-=o;const a=i.getOpponent();this.availableTurnTime[a.value]=this.getMoveDurationInMs();const c=this.getPartDurationInMs()-this.takenGlobalTime[a.value];this.globalClocks[a.value].changeDuration(c)}getMillisecondsElapsedSinceLastMoveStart(n){return Iae(this.lastMoveStartTimestamp.get(),n)}onGameEnd(){for(const n of this.allClocks)n.isStarted()&&n.stop();this.updateClocks()}beforeEventsBatch(n){!1===n&&this.pauseAllClocks()}afterEventsBatch(n,i,s){if(this.updateClocks(),!1===n){const o=this.getMillisecondsElapsedSinceLastMoveStart(s);this.turnClocks[i.value].subtract(o),this.globalClocks[i.value].subtract(o),this.resumeClocks(i)}}resumeClocks(n){this.turnClocks[n.value].resume(),this.globalClocks[n.value].resume()}addTurnTime(n){this.availableTurnTime[n.getOpponent().value]+=3e4}addGlobalTime(n){this.extraGlobalTime[n.getOpponent().value]+=3e5}updateClocks(){for(const n of k.PLAYERS){this.turnClocks[n.value].changeDuration(this.availableTurnTime[n.value]);const i=this.getPartDurationInMs()+this.extraGlobalTime[n.value]-this.takenGlobalTime[n.value];this.globalClocks[n.value].changeDuration(i)}}pauseAllClocks(){for(const n of this.allClocks)!1===n.isIdle()&&n.pause()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)}),u(e,"\u0275prov",He({token:r,factory:r.\u0275fac,providedIn:"root"})),e})();function Yd(r){return Yr((e,t)=>{Ys(r).subscribe(vr(t,()=>t.complete(),Es)),!t.closed&&e.subscribe(t)})}let gCt=(()=>{var r;class e{transform(n){const i=n%60,s=(n-i)%3600/60,o=(n-60*s-i)/3600,a=[];if(o>1?a.push($localize`${o} hours`):1===o&&a.push($localize`1 hour`),s>1?a.push($localize`${s} minutes`):1===s&&a.push($localize`1 minute`),i>1?a.push($localize`${i} seconds`):1===i&&a.push($localize`1 second`),0===a.length)return $localize`0 seconds`;if(1===a.length)return a[0];{const c=a.slice(0,-1).join(", "),l=a.slice(-1)[0];return $localize`${c} and ${l}`}}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)}),u(e,"\u0275pipe",Si({name:"humanDuration",type:r,pure:!0})),e})();var E4,Kd;function _Ct(r,e){if(1&r&&(Gt(0),lt(1),Bt()),2&r){const t=p(3);_(1),An(t.viewInfo.chosenOpponent)}}function vCt(r,e){1&r&&oe(0,44)}function CCt(r,e){if(1&r&&(S(0,"div",45)(1,"div",8)(2,"label",46),Gt(3),oe(4,47),Bt(),S(5,"output"),lt(6),va(7,"humanDuration"),P()(),S(8,"div",37),F(9,"input",48),P()(),S(10,"div",8)(11,"label",49),Ns(12,50),F(13,"output"),va(14,"humanDuration"),Is(),P(),S(15,"div",37),F(16,"input",51),P()()()),2&r){const t=p(3);_(6),An(pc(7,2,t.viewInfo.maximalMoveDuration||0)),_(8),$n(pc(14,4,t.viewInfo.totalPartDuration||0)),jn(12)}}function yCt(r,e){1&r&&(S(0,"div"),Ns(1,52),F(2,"br"),Is(),P())}function MCt(r,e){1&r&&(S(0,"button",64),oe(1,65),P())}function ECt(r,e){if(1&r){const t=pe();S(0,"tr",60),W("click",function(){const s=te(t).$implicit;return ne(p(4).selectOpponent(s))}),S(1,"td",61),lt(2),P(),S(3,"td",62),T(4,MCt,2,0,"button",63),P()()}if(2&r){const t=e.$implicit,n=p(4);zn("id","presenceOf_",t,""),y("ngClass",n.viewInfo.candidateClasses[t]),_(1),y("id",n.viewInfo.chosenOpponent===t?"selected_"+t:"candidate_"+t),_(1),An(t),_(2),y("ngIf",n.viewInfo.chosenOpponent!==t)}}function SCt(r,e){if(1&r&&(Gt(0),oe(1,53),Bt(),S(2,"div",54)(3,"table",55)(4,"thead")(5,"tr")(6,"th",56),oe(7,57),P(),S(8,"th",56),oe(9,58),P()()(),S(10,"tbody"),T(11,ECt,5,5,"tr",59),P()()()),2&r){const t=p(3);_(11),y("ngForOf",t.viewInfo.candidates)}}function PCt(r,e){if(1&r){const t=pe();S(0,"button",66),W("click",function(){return te(t),ne(p(3).changeConfig())}),oe(1,67),P()}}function TCt(r,e){if(1&r){const t=pe();S(0,"div")(1,"h1",4),oe(2,5),P(),S(3,"form",6)(4,"fieldset",7)(5,"div",8)(6,"label",9),oe(7,10),P(),S(8,"div",11)(9,"button",12),W("click",function(){return te(t),ne(p(2).selectFirstPlayer("RANDOM"))}),oe(10,13),P(),S(11,"button",14),W("click",function(){return te(t),ne(p(2).selectFirstPlayer("CREATOR"))}),oe(12,15),P(),S(13,"button",16),W("click",function(){return te(t),ne(p(2).selectFirstPlayer("CHOSEN_PLAYER"))}),T(14,_Ct,2,1,"ng-container",17),T(15,vCt,1,0,"ng-template",null,18,un),P()()(),S(17,"div",8)(18,"label",9),oe(19,19),P(),S(20,"div",11)(21,"div",20),W("click",function(){return te(t),ne(p(2).selectPartType("STANDARD"))}),S(22,"div",21)(23,"span"),oe(24,22),P()(),S(25,"div",23)(26,"div",24)(27,"div",25)(28,"p"),Gt(29),oe(30,26),Bt(),S(31,"strong"),lt(32),va(33,"humanDuration"),P(),F(34,"br"),Gt(35),Ns(36,27),F(37,"strong"),va(38,"humanDuration"),Is(),Bt(),P()()()()(),S(39,"div",28),W("click",function(){return te(t),ne(p(2).selectPartType("BLITZ"))}),S(40,"div",21)(41,"span"),oe(42,29),P()(),S(43,"div",23)(44,"div",24)(45,"div",25)(46,"p"),Gt(47),oe(48,30),Bt(),S(49,"strong"),lt(50),va(51,"humanDuration"),P(),F(52,"br"),Gt(53),Ns(54,31),F(55,"strong"),va(56,"humanDuration"),Is(),Bt(),P()()()()(),S(57,"button",32),W("click",function(){return te(t),ne(p(2).selectPartType("CUSTOM"))}),oe(58,33),P()()(),T(59,CCt,17,6,"div",34),S(60,"div",8)(61,"label",35),oe(62,36),P(),S(63,"div",37),T(64,yCt,3,0,"div",17),T(65,SCt,12,1,"ng-template",null,38,un),P()()(),S(67,"div",8)(68,"div",11)(69,"button",39),W("click",function(){return te(t),ne(p(2).proposeConfig())}),oe(70,40),P(),T(71,PCt,2,0,"button",41),S(72,"button",42),W("click",function(){return te(t),ne(p(2).cancelGameCreation())}),oe(73,43),P()()()()()}if(2&r){const t=cn(16),n=cn(66),i=p(2);_(3),y("formGroup",i.configFormGroup),_(1),y("disabled",!i.viewInfo.canEditConfig),_(5),y("ngClass",i.viewInfo.firstPlayerClasses.RANDOM),_(2),y("ngClass",i.viewInfo.firstPlayerClasses.CREATOR),_(2),y("ngClass",i.viewInfo.firstPlayerClasses.CHOSEN_PLAYER),_(1),y("ngIf",i.viewInfo.chosenOpponent)("ngIfElse",t),_(7),y("ngClass",i.viewInfo.partTypeClasses.STANDARD),_(11),An(pc(33,19,i.partType.NORMAL_MOVE_DURATION)),_(6),$n(pc(38,21,i.partType.NORMAL_PART_DURATION)),jn(36),_(1),y("ngClass",i.viewInfo.partTypeClasses.BLITZ),_(11),An(pc(51,23,i.partType.BLITZ_MOVE_DURATION)),_(6),$n(pc(56,25,i.partType.BLITZ_PART_DURATION)),jn(54),_(1),y("ngClass",i.viewInfo.partTypeClasses.CUSTOM),_(2),y("ngIf",i.viewInfo.showCustomTime),_(5),y("ngIf",0===i.viewInfo.candidates.length)("ngIfElse",n),_(5),y("disabled",!i.viewInfo.canProposeConfig),_(2),y("ngIf",i.viewInfo.canReviewConfig)}}function OCt(r,e){if(1&r&&(S(0,"div",74)(1,"p"),Ns(2,75),F(3,"br"),Is(),P()()),2&r){const t=p(3);_(3),$n(t.viewInfo.creator),jn(2)}}function bCt(r,e){if(1&r&&(S(0,"span"),oe(1,81),P()),2&r){const t=p(4);_(1),$n(t.viewInfo.creator),jn(1)}}function wCt(r,e){1&r&&(S(0,"span"),oe(1,82),P())}function ACt(r,e){1&r&&(S(0,"span"),oe(1,83),P())}function NCt(r,e){if(1&r){const t=pe();S(0,"div",74)(1,"p"),oe(2,76),P(),S(3,"ul")(4,"li"),T(5,bCt,2,1,"span",2),T(6,wCt,2,0,"span",2),T(7,ACt,2,0,"span",2),P(),S(8,"li"),Ns(9,77),F(10,"strong"),va(11,"humanDuration"),Is(),P(),S(12,"li"),Ns(13,78),F(14,"strong"),va(15,"humanDuration"),Is(),P()(),S(16,"button",79),W("click",function(){return te(t),ne(p(3).acceptConfig())}),oe(17,80),P()()}if(2&r){const t=p(3);_(2),$n(t.viewInfo.creator)(t.viewInfo.partTypeName),jn(2),_(3),y("ngIf","CREATOR"===t.viewInfo.firstPlayer),_(1),y("ngIf","CHOSEN_PLAYER"===t.viewInfo.firstPlayer),_(1),y("ngIf","RANDOM"===t.viewInfo.firstPlayer),_(4),$n(pc(11,7,t.viewInfo.maximalMoveDuration||0)),jn(9),_(4),$n(pc(15,9,t.viewInfo.totalPartDuration||0)),jn(13)}}function ICt(r,e){if(1&r&&(S(0,"div")(1,"div",68)(2,"div",69)(3,"p"),oe(4,70),P()(),S(5,"div",71),T(6,OCt,4,1,"div",72),T(7,NCt,18,11,"ng-template",null,73,un),P()()()),2&r){const t=cn(8),n=p(2);_(6),y("ngIf",n.viewInfo.creatorIsModifyingConfig)("ngIfElse",t)}}function kCt(r,e){if(1&r&&(Gt(0),oe(1,86),Bt()),2&r){const t=p(3);_(1),$n(t.viewInfo.creator),jn(1)}}function xCt(r,e){if(1&r&&oe(0,87),2&r){const t=p(3);$n(t.viewInfo.creator)(t.viewInfo.chosenOpponent),jn(0)}}function LCt(r,e){if(1&r&&(S(0,"div",68)(1,"div",69)(2,"p"),oe(3,84),P()(),S(4,"div",71)(5,"p"),T(6,kCt,2,1,"ng-container",17),T(7,xCt,1,2,"ng-template",null,85,un),P()()()),2&r){const t=cn(8),n=p(2);_(6),y("ngIf",n.viewInfo.creatorIsModifyingConfig)("ngIfElse",t)}}function RCt(r,e){if(1&r&&(S(0,"div",1),T(1,TCt,74,27,"div",2),T(2,ICt,9,2,"div",2),T(3,LCt,9,2,"div",3),P()),2&r){const t=p();_(1),y("ngIf",t.viewInfo.userIsCreator),_(1),y("ngIf",t.viewInfo.userIsChosenOpponent),_(1),y("ngIf",t.viewInfo.userIsObserver)}}let dR=(Kd=E4=class{constructor(e,t,n,i,s,o,a,c,l,f){u(this,"router",void 0),u(this,"actRoute",void 0),u(this,"connectedUserService",void 0),u(this,"currentGameService",void 0),u(this,"gameService",void 0),u(this,"configRoomService",void 0),u(this,"chatService",void 0),u(this,"userService",void 0),u(this,"formBuilder",void 0),u(this,"messageDisplayer",void 0),u(this,"partType",ur),u(this,"partId",void 0),u(this,"gameStartNotification",new I1),u(this,"gameStarted",!1),u(this,"viewInfo",{userIsCreator:!1,userIsChosenOpponent:!1,userIsObserver:!1,partType:"STANDARD",partTypeClasses:{STANDARD:["is-selected","is-primary"],BLITZ:[],CUSTOM:[]},firstPlayer:"RANDOM",firstPlayerClasses:{CREATOR:[],RANDOM:["is-selected","is-primary"],CHOSEN_PLAYER:[]},candidateClasses:{},candidates:[]}),u(this,"currentConfigRoom",null),u(this,"candidates",[]),u(this,"ngUnsubscribe",new Ss),u(this,"allUserInterval",g.empty()),u(this,"ownTokenInterval",g.empty()),u(this,"lastToken",void 0),u(this,"selfSubscription",new yn),u(this,"configRoomSubscription",new yn),u(this,"candidatesSubscription",new yn),u(this,"configFormGroup",void 0),u(this,"allDocDeleted",!1),this.router=e,this.actRoute=t,this.connectedUserService=n,this.currentGameService=i,this.gameService=s,this.configRoomService=o,this.chatService=a,this.userService=c,this.formBuilder=l,this.messageDisplayer=f}ngOnInit(){var e=this;return M(function*(){e.checkInputs(),e.createForms();const t=yield e.configRoomService.joinGame(e.partId);if(t.isFailure()){const n=t.getReason();e.messageDisplayer.criticalMessage(n)}else yield e.startSendingPresenceTokens(),e.subscribeToConfigRoomDoc(),e.subscribeToFormElements()})()}checkInputs(){const e=this.connectedUserService.user;Ze(e.isPresent(),"PartCreationComponent should not be called without connected user"),Ze(e.get()!==_0.NOT_CONNECTED,"PartCreationComponent should not be created with an empty userName"),Ze(""!==this.partId,"PartCreationComponent should not be created with an empty partId")}createForms(){this.configFormGroup=this.formBuilder.group({firstPlayer:[z2.RANDOM.value,q7.required],maximalMoveDuration:[ur.NORMAL_MOVE_DURATION,q7.required],partType:["STANDARD",q7.required],totalPartDuration:[ur.NORMAL_PART_DURATION,q7.required],chosenOpponent:["",q7.required]})}updateUserDocWithCurrentGame(e){const t=this.getUserRoleInPart(e),n={id:this.partId,opponent:this.getOpponent(),typeGame:U.getNonNullable(this.actRoute.snapshot.paramMap.get("compo")),role:t};return this.currentGameService.updateCurrentGame(n)}getUserRoleInPart(e){const t=this.connectedUserService.user.get().id;return t===e.creator.id?"Creator":t===e.chosenOpponent?.id?"ChosenOpponent":"Candidate"}getOpponent(){let e=null;return e=this.connectedUserService.user.get().id===this.currentConfigRoom?.creator.id?this.currentConfigRoom.chosenOpponent:U.getNonNullable(this.currentConfigRoom?.creator),e}subscribeToConfigRoomDoc(){var e=this;const t=function(){var i=M(function*(s){yield e.onCurrentConfigRoomUpdate(s)});return function(o){return i.apply(this,arguments)}}(),n=function(){var i=M(function*(s){yield e.onCandidatesUpdate(s)});return function(o){return i.apply(this,arguments)}}();this.configRoomSubscription=this.configRoomService.subscribeToChanges(this.partId,t),this.candidatesSubscription=this.configRoomService.subscribeToCandidates(this.partId,n)}getForm(e){return U.getNonNullable(this.configFormGroup.get(e))}subscribeToFormElements(){this.getForm("chosenOpponent").valueChanges.pipe(Yd(this.ngUnsubscribe)).subscribe(e=>{void 0!==this.viewInfo.chosenOpponent&&(this.viewInfo.candidateClasses[this.viewInfo.chosenOpponent]=[]),this.viewInfo.candidateClasses[e]=["is-selected"],this.viewInfo.chosenOpponent=e;const t=U.getNonNullable(this.currentConfigRoom).partStatus;this.viewInfo.canProposeConfig=t!==ui.CONFIG_PROPOSED.value&&""!==e}),this.getForm("partType").valueChanges.pipe(Yd(this.ngUnsubscribe)).subscribe(e=>{this.viewInfo.partTypeClasses[this.viewInfo.partType]=[],this.viewInfo.partTypeClasses[e]=["is-primary","is-selected"],this.viewInfo.partType=e,this.viewInfo.showCustomTime="CUSTOM"===e}),this.getForm("maximalMoveDuration").valueChanges.pipe(Yd(this.ngUnsubscribe)).subscribe(e=>{this.viewInfo.maximalMoveDuration=e}),this.getForm("totalPartDuration").valueChanges.pipe(Yd(this.ngUnsubscribe)).subscribe(e=>{this.viewInfo.totalPartDuration=e}),this.getForm("firstPlayer").valueChanges.pipe(Yd(this.ngUnsubscribe)).subscribe(e=>{this.viewInfo.firstPlayerClasses[this.viewInfo.firstPlayer]=[],this.viewInfo.firstPlayerClasses[e]=["is-primary","is-selected"],this.viewInfo.firstPlayer=e})}updateViewInfo(){const e=U.getNonNullable(this.currentConfigRoom),t=this.connectedUserService.user.get();switch(this.viewInfo.canReviewConfig=e.partStatus===ui.CONFIG_PROPOSED.value,this.viewInfo.canEditConfig=e.partStatus!==ui.CONFIG_PROPOSED.value,this.viewInfo.userIsCreator=this.userIsCreator(e),this.viewInfo.userIsChosenOpponent=t.id===e.chosenOpponent?.id,this.viewInfo.userIsObserver=!1===this.viewInfo.userIsChosenOpponent&&!1===this.viewInfo.userIsCreator,this.viewInfo.creatorIsModifyingConfig=e.partStatus!==ui.CONFIG_PROPOSED.value,this.viewInfo.showCustomTime="CUSTOM"===this.getForm("partType").value,this.viewInfo.creator=e.creator.name,this.viewInfo.candidates=this.candidates.map(n=>n.name),this.userIsCreator(e)?this.setDataForCreator(e):(this.viewInfo.maximalMoveDuration=e.maximalMoveDuration,this.viewInfo.totalPartDuration=e.totalPartDuration,this.viewInfo.partType=e.partType,this.viewInfo.chosenOpponent=e.chosenOpponent?.name,this.viewInfo.firstPlayer=e.firstPlayer),e.partType){case"CUSTOM":this.viewInfo.partTypeName=$localize`custom`;break;case"BLITZ":this.viewInfo.partTypeName=$localize`blitz`;break;case"STANDARD":this.viewInfo.partTypeName=$localize`standard`}}setDataForCreator(e){this.viewInfo.maximalMoveDuration=this.viewInfo.maximalMoveDuration??e.maximalMoveDuration,this.viewInfo.totalPartDuration=this.viewInfo.totalPartDuration??e.totalPartDuration;let t=this.viewInfo.chosenOpponent;null==t||""===t?t=e.chosenOpponent?.name??"":!1===this.candidates.some(i=>i.name===t)&&(t=""),this.getForm("chosenOpponent").setValue(t)}selectFirstPlayer(e){this.getForm("firstPlayer").setValue(e)}selectPartType(e){"STANDARD"===e?(this.getForm("maximalMoveDuration").setValue(ur.NORMAL_MOVE_DURATION),this.getForm("totalPartDuration").setValue(ur.NORMAL_PART_DURATION)):"BLITZ"===e&&(this.getForm("maximalMoveDuration").setValue(ur.BLITZ_MOVE_DURATION),this.getForm("totalPartDuration").setValue(ur.BLITZ_PART_DURATION)),this.getForm("partType").setValue(e)}selectOpponent(e){var t=this;return M(function*(){const n=t.getUserFromName(e);yield Promise.all([t.currentGameService.updateCurrentGame({opponent:n}),t.configRoomService.setChosenOpponent(t.partId,n)])})()}getUserFromName(e){const t=this.candidates.find(n=>n.name===e);return U.getNonNullable(t)}changeConfig(){var e=this;return M(function*(){return e.configRoomService.reviewConfig(e.partId)})()}proposeConfig(){var e=this;return M(function*(){const t=e.getForm("chosenOpponent").value,n=e.getForm("partType").value,i=e.getForm("maximalMoveDuration").value,s=e.getForm("firstPlayer").value,o=e.getForm("totalPartDuration").value,a=e.getUserFromName(t);return e.configRoomService.proposeConfig(e.partId,a,ur.of(n),i,z2.of(s),o)})()}cancelGameCreation(){var e=this;return M(function*(){e.allDocDeleted=!0,yield e.currentGameService.removeCurrentGame(),Ne.display("PartCreationComponent","cancelGameCreation","observed part removed"),yield e.chatService.deleteChat(e.partId),Ne.display("PartCreationComponent","cancelGameCreation","chat deleted"),yield e.gameService.deletePart(e.partId),Ne.display("PartCreationComponent","cancelGameCreation","chat and part deleted"),yield e.configRoomService.deleteConfigRoom(e.partId,e.candidates),Ne.display("PartCreationComponent","cancelGameCreation","chat, part, and configRoom deleted")})()}onCurrentConfigRoomUpdate(e){var t=this;return M(function*(){if(e.isAbsent())return Ne.display("PartCreationComponent","onCurrentConfigRoomUpdate","LAST UPDATE : the game is cancelled"),t.onGameCanceled();{const n=e.get();if(t.chosenOpponentJustLeft(n)&&t.userIsCreator(n)){const s=U.getNonNullable(t.currentConfigRoom),o=U.getNonNullable(s.chosenOpponent).name;t.messageDisplayer.infoMessage($localize`${o} left the game, please pick another opponent.`),yield t.currentGameService.updateCurrentGame({opponent:null})}let i=!1;t.userJustChosenAsOpponent(n)&&(yield t.updateUserDocWithCurrentGame(n),i=!0),t.currentConfigRoom=n,t.allUserInterval.isAbsent()&&(Ze(!1===i,"Expected currentGameUpdate to be false at first call of onCurrentConfigRoomUpdate"),yield t.updateUserDocWithCurrentGame(t.currentConfigRoom),yield t.observeNeededPlayers()),t.updateViewInfo(),t.isGameStarted(t.currentConfigRoom)&&(Ne.display("PartCreationComponent","onCurrentConfigRoomUpdate","the game has started"),t.onGameStarted())}})()}onCandidatesUpdate(e){var t=this;return M(function*(){t.candidates=e,t.updateViewInfo()})()}userJustChosenAsOpponent(e){if(this.isGameStarted(e))return!1;const t=this.connectedUserService.user.get().id;return this.currentConfigRoom?.chosenOpponent?.id!==t&&e.chosenOpponent?.id===t}chosenOpponentJustLeft(e){return null!=this.currentConfigRoom&&(null!=this.currentConfigRoom.chosenOpponent&&null==e.chosenOpponent)}onGameCanceled(){var e=this;return M(function*(){e.messageDisplayer.infoMessage($localize`The game has been canceled!`),yield e.router.navigate(["/lobby"])})()}isGameStarted(e){return Ze(null!=e,"configRoom should not be null (isGameStarted)"),U.getNonNullable(e).partStatus===ui.PART_STARTED.value}onGameStarted(){const e=U.getNonNullable(this.currentConfigRoom);this.gameStartNotification.emit(e),this.gameStarted=!0}observeNeededPlayers(){var e=this;return M(function*(){const t=U.getNonNullable(e.currentConfigRoom);Ze(e.allUserInterval.isAbsent(),"Cannot observe players multiple times"),e.allUserInterval=g.of(window.setInterval(M(function*(){const n=e.lastToken;e.userIsCreator(t)?yield e.checkCandidatesTokensFreshness(n):yield e.checkCreatorTokenFreshness(n)}),Kd.TOKEN_INTERVAL))})()}userIsCreator(e){return this.connectedUserService.user.get().id===e.creator.id}checkCreatorTokenFreshness(e){var t=this;return M(function*(){const n=U.getNonNullable(t.currentConfigRoom);(yield t.didUserTimeout(n.creator.id,e))&&(yield t.destroyDocIfPartDidNotStart())})()}destroyDocIfPartDidNotStart(){var e=this;return M(function*(){Ze(!1===e.isGameStarted(e.currentConfigRoom),"Should not try to cancelGameCreation when part started!"),Ze(!1===e.allDocDeleted,"Should not delete doc twice"),yield e.cancelGameCreation()})()}checkCandidatesTokensFreshness(e){var t=this;return M(function*(){for(const n of t.candidates)(yield t.didUserTimeout(n.id,e))&&(yield t.removeCandidateFromLobby(n))})()}didUserTimeout(e,t){var n=this;return M(function*(){const i=yield n.userService.getUserLastUpdateTime(e);return i.isAbsent()?(d2.logError("PartCreationComponent","found no user while observing "+e+" !"),!0):Iae(i.get(),t)>Kd.TOKEN_TIMEOUT})()}removeCandidateFromLobby(e){var t=this;return M(function*(){const n=U.getNonNullable(t.currentConfigRoom);return e.id===n.chosenOpponent?.id&&(yield t.configRoomService.reviewConfigAndRemoveChosenOpponent(t.partId)),t.configRoomService.removeCandidate(t.partId,e)})()}startSendingPresenceTokens(){var e=this;return M(function*(){yield e.connectedUserService.sendPresenceToken(),Ze(e.ownTokenInterval.isAbsent(),"should not start sending presence tokens twice"),e.ownTokenInterval=g.of(window.setInterval(()=>{e.connectedUserService.sendPresenceToken()},Kd.TOKEN_INTERVAL));const t=e.connectedUserService.user.get().id;e.selfSubscription=e.userService.observeUserOnServer(t,n=>{Ze(n.isPresent(),"connected user should exist"),e.lastToken=U.getNonNullable(n.get().lastUpdateTime)})})()}stopSendingPresenceTokensAndObservingUsersIfNeeded(){this.ownTokenInterval.isPresent()&&(window.clearInterval(this.ownTokenInterval.get()),this.ownTokenInterval=g.empty()),this.allUserInterval.isPresent()&&window.clearInterval(this.allUserInterval.get()),this.selfSubscription.unsubscribe()}acceptConfig(){return this.gameService.acceptConfig(this.partId,U.getNonNullable(this.currentConfigRoom))}ngOnDestroy(){var e=this;return M(function*(){if(e.ngUnsubscribe.next(),e.ngUnsubscribe.complete(),e.configRoomSubscription.unsubscribe(),e.candidatesSubscription.unsubscribe(),e.stopSendingPresenceTokensAndObservingUsersIfNeeded(),e.connectedUserService.user.isAbsent())return;const t=e.connectedUserService.user.get();!0!==e.gameStarted&&(null===e.currentConfigRoom?Ne.display("PartCreationComponent","ngOnDestroy","there is no part here"):!0===e.allDocDeleted?Ne.display("PartCreationComponent","ngOnDestroy","part has already been deleted"):t.id===e.currentConfigRoom.creator.id?(Ne.display("PartCreationComponent","ngOnDestroy","you(creator) about to cancel creation."),yield e.cancelGameCreation()):(Ne.display("PartCreationComponent","ngOnDestroy","you are about to cancel game joining"),yield e.currentGameService.removeCurrentGame(),yield e.configRoomService.cancelJoining(e.partId)))})()}},u(E4,"TOKEN_INTERVAL",5e3),u(E4,"TOKEN_TIMEOUT",1e4),u(E4,"\u0275fac",function(e){return new(e||E4)(B(Gn),B(xs),B(lr),B(ds),B(X5),B(ad),B(Z5),B(Y5),B(Jge),B(Ut))}),u(E4,"\u0275cmp",qe({type:E4,selectors:[["app-part-creation"]],inputs:{partId:"partId"},outputs:{gameStartNotification:"gameStartNotification"},decls:1,vars:1,consts:function(){let r,e,t,n,i,s,o,a,c,l,f,d,m,E,w,R,z,$,G,de,ve,Le,nt,gt,vn,Et,Z2,F0,Bl,r3,eh,th,ft,Ot,xt,wn;return r=$localize`Game creation`,e=$localize`First player`,t=$localize`Random`,n=$localize`You`,i=$localize`Game type`,s=$localize`Standard`,o=$localize`Maximal turn duration: `,a=$localize`Maximal game duration: ${"\ufffd#37\ufffd"}:START_TAG_STRONG:${"\ufffd0\ufffd"}:INTERPOLATION: per player${"\ufffd/#37\ufffd"}:CLOSE_TAG_STRONG:`,c=$localize`Blitz`,l=$localize`Maximal turn duration: `,f=$localize`Maximal game duration: ${"\ufffd#55\ufffd"}:START_TAG_STRONG:${"\ufffd0\ufffd"}:INTERPOLATION: per player${"\ufffd/#55\ufffd"}:CLOSE_TAG_STRONG:`,d=$localize`Custom`,m=$localize`Opponents`,E=$localize`Propose configuration`,w=$localize`Cancel game`,R=$localize`The opponent`,z=$localize`Maximal turn duration: `,$=$localize`Maximal game duration: ${"\ufffd#13\ufffd"}:START_TAG_OUTPUT:${"\ufffd0\ufffd"}:INTERPOLATION: per player${"\ufffd/#13\ufffd"}:CLOSE_TAG_OUTPUT:`,G=$localize`Potential opponents that join the game will appear here.${"\ufffd#2\ufffd\ufffd/#2\ufffd"}:LINE_BREAK:Wait for an opponent to join, so that you can pick one.`,de=$localize`Click on the opponent against which you would like to play.`,ve=$localize`Name`,Le=$localize`Actions`,nt=$localize`Pick`,gt=$localize`Change configuration`,vn=$localize`Configuration proposal`,Et=$localize`You have been selected as the opponent.${"\ufffd#3\ufffd\ufffd/#3\ufffd"}:LINE_BREAK: ${"\ufffd0\ufffd"}:INTERPOLATION: is modifying the configuration.`,Z2=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: proposes to play a ${"\ufffd1\ufffd"}:INTERPOLATION_1: game`,F0=$localize`a turn lasts at most ${"\ufffd#10\ufffd"}:START_TAG_STRONG:${"\ufffd0\ufffd"}:INTERPOLATION: ${"\ufffd/#10\ufffd"}:CLOSE_TAG_STRONG:`,Bl=$localize`the game lasts at most ${"\ufffd#14\ufffd"}:START_TAG_STRONG:${"\ufffd0\ufffd"}:INTERPOLATION: per player${"\ufffd/#14\ufffd"}:CLOSE_TAG_STRONG:`,r3=$localize`Accept and start`,eh=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: plays first`,th=$localize`you play first`,ft=$localize`the first player is selected randomly`,Ot=$localize`One moment...`,xt=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: is configuring the game.`,wn=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: has proposed a configuration to ${"\ufffd1\ufffd"}:INTERPOLATION_1:.`,[["class","box",4,"ngIf"],[1,"box"],[4,"ngIf"],["class","message is-primary",4,"ngIf"],[1,"title"],r,[3,"formGroup"],[3,"disabled"],[1,"field"],["for","firstPlayer",1,"label"],e,[1,"buttons","has-addons"],["id","firstPlayerRandom",1,"button",3,"ngClass","click"],t,["id","firstPlayerCreator",1,"button",3,"ngClass","click"],n,["id","firstPlayerOpponent",1,"button",3,"ngClass","click"],[4,"ngIf","ngIfElse"],["opponentWithoutName",""],i,["id","partTypeStandard",1,"button","dropdown","is-hoverable",3,"ngClass","click"],[1,"dropdown-trigger"],s,["role","menu",1,"dropdown-menu"],[1,"dropdown-content"],[1,"dropdown-item"],o,a,["id","partTypeBlitz",1,"button","dropdown","is-hoverable",3,"ngClass","click"],c,l,f,["id","partTypeCustom",1,"button",3,"ngClass","click"],d,["id","customTime",4,"ngIf"],[1,"label"],m,[1,"control"],["chooseOpponent",""],["id","proposeConfig",1,"button","is-primary",3,"disabled","click"],E,["class","button","id","reviewConfig",3,"click",4,"ngIf"],["id","cancel",1,"button",3,"click"],w,R,["id","customTime"],["for","maximalMoveDuration",1,"label"],z,["step","10","min","10","max","300","name","maximalMoveDuration","formControlName","maximalMoveDuration","type","range",1,"slider","is-circle","is-primary"],["for","totalPartDuration",1,"label"],$,["step","10","min","10","max","3600","name","totalPartDuration","formControlName","totalPartDuration","type","range",1,"slider","is-circle","is-primary"],G,de,["id","chooseOpponent",1,"table-container"],[1,"table","is-fullwidth","is-hoverable","is-striped"],["scope","col",1,"th"],ve,Le,[3,"id","ngClass","click",4,"ngFor","ngForOf"],[3,"id","ngClass","click"],[1,"td",3,"id"],[1,"td"],["class","button is-primary",4,"ngIf"],[1,"button","is-primary"],nt,["id","reviewConfig",1,"button",3,"click"],gt,[1,"message","is-primary"],[1,"message-header"],vn,[1,"message-body"],["class","content",4,"ngIf","ngIfElse"],["configProposal",""],[1,"content"],Et,Z2,F0,Bl,["id","acceptConfig",1,"button","is-primary",3,"click"],r3,eh,th,ft,Ot,["proposalSent",""],xt,wn]},template:function(e,t){1&e&&T(0,RCt,4,3,"div",0),2&e&&y("ngIf",t.viewInfo)},dependencies:[Ft,Wt,At,v6,_c,hg,b3,m6,C6,F8,gCt],encapsulation:2})),E4);var Xa,V0;function DCt(r,e){if(1&r){const t=pe();S(0,"button",3),W("click",function(){return te(t),ne(p().addTime())}),oe(1,4),P()}if(2&r){const t=p();_(1),$n(t.timeToAdd),jn(1)}}dR=Kd=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ne.log],dR);let hR=(V0=Xa=class{constructor(){u(this,"debugName",void 0),u(this,"timeToAdd",void 0),u(this,"dangerTimeLimit",void 0),u(this,"active",void 0),u(this,"canAddTime",void 0),u(this,"remainingMs",void 0),u(this,"displayedSec",void 0),u(this,"displayedMinute",void 0),u(this,"timeoutHandleGlobal",null),u(this,"timeoutHandleSec",null),u(this,"isPaused",!0),u(this,"isSet",!1),u(this,"started",!1),u(this,"startTime",void 0),u(this,"outOfTimeAction",new I1),u(this,"addTimeToOpponent",new I1),u(this,"cssClasses",V0.SAFE_TIME)}setDuration(e){U.assert(!1===this.started,"Should not set a chrono that has already been started ("+this.debugName+")!"),this.isSet=!0,this.changeDuration(e)}changeDuration(e){U.assert(this.isPaused,"Should not change duration of a clock while it is running"),this.remainingMs=e,this.displayDuration()}subtract(e){this.changeDuration(this.remainingMs-e)}displayDuration(){this.displayedSec=this.remainingMs%6e4,this.displayedMinute=(this.remainingMs-this.displayedSec)/6e4,this.displayedSec=Math.floor(this.displayedSec/1e3)}start(){U.assert(this.isSet,"Should not start a chrono that has not been set!"),U.assert(!1===this.started,"Should not start chrono that has already been started ("+this.debugName+")"),this.started=!0,this.resume()}resume(){U.assert(this.isPaused&&this.started,"Should only resume chrono that are started and paused!"),this.startTime=Date.now();const e=this.remainingMs;this.isPaused=!1,this.timeoutHandleGlobal=window.setTimeout(()=>{this.onEndReached()},e),this.countSeconds()}onEndReached(){this.isPaused=!0,this.started=!1,this.clearTimeouts(),this.changeDuration(0),this.outOfTimeAction.emit()}countSeconds(){this.timeoutHandleSec=window.setTimeout(()=>{this.updateShownTime()},1e3)}isIdle(){return!1===this.started||this.isPaused}pause(){U.assert(this.started,"Should not pause not started chrono ("+this.debugName+")"),U.assert(!1===this.isPaused,"Should not pause already paused chrono ("+this.debugName+")"),this.clearTimeouts(),this.isPaused=!0,this.updateShownTime()}stop(){U.assert(this.started,"Should only stop chrono that are started!"),!1===this.isPaused&&this.pause(),this.started=!1,this.isSet=!1}isStarted(){return this.started}getTimeClass(){return!1===this.active?V0.PASSIVE_STYLE:this.remainingMs<this.dangerTimeLimit?this.remainingMs%2e3<1e3?V0.DANGER_TIME_ODD:V0.DANGER_TIME_EVEN:V0.SAFE_TIME}updateShownTime(){const e=Date.now();this.remainingMs-=e-this.startTime,this.displayDuration(),this.cssClasses=this.getTimeClass(),this.startTime=e,!1===this.isPaused&&this.countSeconds()}clearTimeouts(){null!=this.timeoutHandleSec&&(window.clearTimeout(this.timeoutHandleSec),this.timeoutHandleSec=null),null!=this.timeoutHandleGlobal&&(window.clearTimeout(this.timeoutHandleGlobal),this.timeoutHandleGlobal=null)}addTime(){this.addTimeToOpponent.emit()}ngOnDestroy(){this.clearTimeouts()}},u(Xa,"DANGER_TIME_EVEN","has-background-danger has-text-white"),u(Xa,"DANGER_TIME_ODD","has-background-warning has-text-white"),u(Xa,"PASSIVE_STYLE","has-text-passive is-italic"),u(Xa,"SAFE_TIME",""),u(Xa,"\u0275fac",function(e){return new(e||Xa)}),u(Xa,"\u0275cmp",qe({type:Xa,selectors:[["app-count-down"]],inputs:{debugName:"debugName",timeToAdd:"timeToAdd",dangerTimeLimit:"dangerTimeLimit",active:"active",canAddTime:"canAddTime"},outputs:{outOfTimeAction:"outOfTimeAction",addTimeToOpponent:"addTimeToOpponent"},decls:5,vars:7,consts:function(){let r;return r=$localize`Add ${"\ufffd0\ufffd"}:INTERPOLATION:`,[[3,"ngClass"],["id","remainingTime"],["id","addTimeButton","class","button is-small is-fullwidth",3,"click",4,"ngIf"],["id","addTimeButton",1,"button","is-small","is-fullwidth",3,"click"],r]},template:function(e,t){1&e&&(S(0,"div",0)(1,"p",1),lt(2),va(3,"number"),P(),T(4,DCt,2,1,"button",2),P()),2&e&&(y("ngClass",t.getTimeClass()),_(2),cE("",t.displayedMinute,":",KF(3,4,t.displayedSec,"2.0-0"),""),_(2),y("ngIf",t.canAddTime))},dependencies:[Ft,At,LG],encapsulation:2})),Xa);var xu;hR=V0=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ne.log],hR);const VCt=["chronoZeroGlobal"],FCt=["chronoOneGlobal"],$Ct=["chronoZeroTurn"],GCt=["chronoOneTurn"];function BCt(r,e){if(1&r){const t=pe();S(0,"app-part-creation",5,6),W("gameStartNotification",function(i){return te(t),ne(p().startGame(i))}),P()}2&r&&y("partId",p().currentPartId)}function UCt(r,e){1&r&&(Gt(0),S(1,"span",39),oe(2,40),P(),Bt())}function WCt(r,e){if(1&r&&(S(0,"span",41),oe(1,42),P()),2&r){const t=p(4);_(1),$n(null==t.currentPlayer?null:t.currentPlayer.name),jn(1)}}function qCt(r,e){if(1&r&&(S(0,"p",36),T(1,UCt,3,0,"ng-container",37),T(2,WCt,2,1,"ng-template",null,38,un),P()),2&r){const t=cn(3),n=p(3);_(1),y("ngIf",(null==n.currentPlayer?null:n.currentPlayer.name)===n.getPlayer().name)("ngIfElse",t)}}function jCt(r,e){if(1&r&&(S(0,"div",32)(1,"p",33),oe(2,34),P(),T(3,qCt,4,2,"p",35),P()),2&r){const t=p(2);_(2),$n(t.currentPart.getTurn()+1),jn(2),_(1),y("ngIf",!1===t.endGame)}}function ZCt(r,e){if(1&r&&(S(0,"p",43),lt(1),P()),2&r){const t=p(2);y("ngClass",t.getPlayerNameClass(t.Player.ZERO)),_(1),An(t.players[0].get().name)}}function YCt(r,e){if(1&r&&(S(0,"p",44),oe(1,45),P()),2&r){const t=p(2);_(1),$n(t.gameComponent.scores.get()[0]),jn(1)}}function KCt(r,e){if(1&r&&(S(0,"p",46),lt(1),P()),2&r){const t=p(2);y("ngClass",t.getPlayerNameClass(t.Player.ONE)),_(1),An(t.players[1].get().name)}}function XCt(r,e){if(1&r&&(S(0,"p",47),oe(1,48),P()),2&r){const t=p(2);_(1),$n(t.gameComponent.scores.get()[1]),jn(1)}}function QCt(r,e){1&r&&(S(0,"div")(1,"p",50),oe(2,51),P()())}function JCt(r,e){1&r&&(S(0,"p",55),oe(1,56),P())}function eyt(r,e){1&r&&(S(0,"p",57),oe(1,58),P())}function tyt(r,e){1&r&&(S(0,"p",59),oe(1,60),P())}function nyt(r,e){if(1&r&&(S(0,"div"),T(1,JCt,2,0,"p",52),T(2,eyt,2,0,"p",53),T(3,tyt,2,0,"p",54),P()),2&r){const t=p(3);_(1),y("ngIf",t.currentPart.getDrawAccepter().name===t.getPlayer().name),_(1),y("ngIf",t.currentPart.getDrawAccepter().name!==t.getPlayer().name&&t.isPlaying()),_(1),y("ngIf",!1===t.isPlaying())}}function ryt(r,e){1&r&&(S(0,"p",64),oe(1,65),P())}function iyt(r,e){1&r&&(S(0,"p",66),oe(1,67),P())}function syt(r,e){if(1&r&&(S(0,"p",68),oe(1,69),P()),2&r){const t=p(4);_(1),$n(t.currentPart.getWinner().get().name),jn(1)}}function oyt(r,e){if(1&r&&(S(0,"div"),T(1,ryt,2,0,"p",61),T(2,iyt,2,0,"p",62),T(3,syt,2,1,"p",63),P()),2&r){const t=p(3);_(1),y("ngIf",t.currentPart.getWinner().get().name===t.getPlayer().name),_(1),y("ngIf",t.currentPart.getWinner().get().name!==t.getPlayer().name&&t.isPlaying()),_(1),y("ngIf",!1===t.isPlaying())}}function ayt(r,e){if(1&r&&(S(0,"p",64),oe(1,70),P()),2&r){const t=p(4);_(1),$n(t.currentPart.getLoser().get().name),jn(1)}}function cyt(r,e){1&r&&(S(0,"p",68),oe(1,71),P())}function lyt(r,e){if(1&r&&(S(0,"p",68),oe(1,72),P()),2&r){const t=p(4);_(1),$n(t.currentPart.getLoser().get().name),jn(1)}}function uyt(r,e){if(1&r&&(S(0,"div"),T(1,ayt,2,1,"p",61),T(2,cyt,2,0,"p",63),T(3,lyt,2,1,"p",63),P()),2&r){const t=p(3);_(1),y("ngIf",t.currentPart.getWinner().get().name===t.getPlayer().name),_(1),y("ngIf",t.currentPart.getWinner().get().name!==t.getPlayer().name&&t.isPlaying()),_(1),y("ngIf",!1===t.isPlaying())}}function fyt(r,e){1&r&&(S(0,"p",74),oe(1,75),P())}function dyt(r,e){if(1&r&&(S(0,"p",74),oe(1,76),P()),2&r){const t=p(4);_(1),$n(t.currentPart.getLoser().get().name),jn(1)}}function hyt(r,e){if(1&r&&(S(0,"div"),T(1,fyt,2,0,"p",73),T(2,dyt,2,1,"p",73),P()),2&r){const t=p(3);_(1),y("ngIf",t.currentPart.getWinner().get().name!==t.getPlayer().name&&t.isPlaying()),_(1),y("ngIf",!1===t.isPlaying()||t.currentPart.getWinner().get().name===t.getPlayer().name)}}function pyt(r,e){if(1&r&&(S(0,"div",49),F(1,"hr"),T(2,QCt,3,0,"div",27),T(3,nyt,4,3,"div",27),T(4,oyt,4,3,"div",27),T(5,uyt,4,3,"div",27),T(6,hyt,3,2,"div",27),P()),2&r){const t=p(2);_(2),y("ngIf",t.currentPart.isHardDraw()),_(1),y("ngIf",t.currentPart.isAgreedDraw()),_(1),y("ngIf",t.currentPart.isWin()),_(1),y("ngIf",t.currentPart.isTimeout()),_(1),y("ngIf",t.currentPart.isResign())}}function gyt(r,e){if(1&r){const t=pe();Gt(0),S(1,"button",85),W("click",function(){const s=te(t).$implicit;return ne(p(4).propose(s))}),lt(2),F(3,"fa-icon",86),P(),Bt()}if(2&r){const t=e.$implicit,n=p(4);_(1),zn("id","propose",t,""),y("disabled",!1===n.requestAvailable(t)),_(1),O2("",n.requestInfos[t].textForRequest(),"\xa0\xa0"),_(1),y("icon",n.requestInfos[t].icon)}}function myt(r,e){if(1&r){const t=pe();Gt(0),S(1,"button",80),W("click",function(){return te(t),ne(p(3).resign())}),oe(2,81),P(),S(3,"button",82),W("click",function(){return te(t),ne(p(3).gameComponent.pass())}),oe(4,83),P(),T(5,gyt,4,4,"ng-container",84),Bt()}if(2&r){const t=p(3);_(1),y("disabled",!1===t.canResign()),_(2),y("disabled",!1===t.canPass()),_(2),y("ngForOf",t.allRequests)}}function _yt(r,e){if(1&r){const t=pe();S(0,"div",87)(1,"p"),lt(2),F(3,"fa-icon",86),P(),S(4,"button",88),W("click",function(){return te(t),ne(p(3).accept())}),oe(5,89),P(),S(6,"button",90),W("click",function(){return te(t),ne(p(3).reject())}),oe(7,91),P()()}if(2&r){const t=p(3);_(2),O2(" ",t.requestInfos[t.requestAwaitingReplyFromUs().get()].textForReply(),"\xa0\xa0 "),_(1),y("icon",t.requestInfos[t.requestAwaitingReplyFromUs().get()].icon)}}function vyt(r,e){if(1&r&&(S(0,"div",92)(1,"p")(2,"span"),Ns(3,93),F(4,"fa-icon",86),Is(),P()()()),2&r){const t=p(3);_(4),y("icon",t.requestInfos[t.deniedRequest().get()].icon),$n(t.requestInfos[t.deniedRequest().get()].name()),jn(3)}}function Cyt(r,e){if(1&r&&(S(0,"div",94)(1,"p")(2,"span"),Ns(3,95),F(4,"fa-icon",86),Is(),P()()()),2&r){const t=p(3);_(4),y("icon",t.requestInfos[t.requestAwaitingReplyFromOpponent().get()].icon),$n(t.requestInfos[t.requestAwaitingReplyFromOpponent().get()].name()),jn(3)}}function yyt(r,e){if(1&r&&(Gt(0),T(1,myt,6,3,"ng-container",37),T(2,_yt,8,2,"ng-template",null,77,un),T(4,vyt,5,2,"div",78),T(5,Cyt,5,2,"div",79),Bt()),2&r){const t=cn(3),n=p(2);_(1),y("ngIf",!1===n.mustReply())("ngIfElse",t),_(3),y("ngIf",n.deniedRequest().isPresent()),_(1),y("ngIf",n.requestAwaitingReplyFromOpponent().isPresent())}}function Myt(r,e){1&r&&(S(0,"button",96),oe(1,97),P())}function Eyt(r,e){if(1&r){const t=pe();S(0,"div",7)(1,"div",8)(2,"div",9),T(3,jCt,4,2,"div",10),S(4,"div",11),T(5,ZCt,2,2,"p",12),T(6,YCt,2,1,"p",13),S(7,"app-count-down",14,15),W("outOfTimeAction",function(){te(t);const i=p();return ne(i.reachedOutOfTime(i.Player.ZERO))})("addTimeToOpponent",function(){return te(t),ne(p().addGlobalTime())}),P(),S(9,"app-count-down",16,17),W("outOfTimeAction",function(){te(t);const i=p();return ne(i.reachedOutOfTime(i.Player.ZERO))})("addTimeToOpponent",function(){return te(t),ne(p().addTurnTime())}),P()(),S(11,"p",18),oe(12,19),P(),S(13,"div",11),T(14,KCt,2,2,"p",20),T(15,XCt,2,1,"p",21),S(16,"app-count-down",22,23),W("outOfTimeAction",function(){te(t);const i=p();return ne(i.reachedOutOfTime(i.Player.ONE))})("addTimeToOpponent",function(){return te(t),ne(p().addGlobalTime())}),P(),S(18,"app-count-down",24,25),W("outOfTimeAction",function(){te(t);const i=p();return ne(i.reachedOutOfTime(i.Player.ONE))})("addTimeToOpponent",function(){return te(t),ne(p().addTurnTime())}),P()(),F(20,"hr"),T(21,pyt,7,5,"div",26),T(22,yyt,6,4,"ng-container",27),T(23,Myt,2,0,"button",28),P()(),S(24,"div",29)(25,"div",30),F(26,"div",null,31),P()()()}if(2&r){const t=p();_(3),y("ngIf",null!==t.currentPart),_(2),y("ngIf",t.players[0].isPresent()),_(1),y("ngIf",null!==t.currentPart&&t.gameComponent&&t.gameComponent.scores.isPresent()),_(1),y("dangerTimeLimit",6e4)("active",null!==t.currentPart&&t.currentPart.getTurn()%2==0)("canAddTime",t.role===t.Player.ONE&&!1===t.endGame)("timeToAdd",t.globalTimeMessage),_(2),y("dangerTimeLimit",15e3)("active",null!==t.currentPart&&t.currentPart.getTurn()%2==0)("canAddTime",t.role===t.Player.ONE&&!1===t.endGame)("timeToAdd",t.turnTimeMessage),_(5),y("ngIf",t.players[1].isPresent()),_(1),y("ngIf",null!==t.currentPart&&t.gameComponent&&t.gameComponent.scores.isPresent()),_(1),y("dangerTimeLimit",6e4)("active",null!==t.currentPart&&t.currentPart.getTurn()%2==1)("canAddTime",t.role===t.Player.ZERO&&!1===t.endGame)("timeToAdd",t.globalTimeMessage),_(2),y("dangerTimeLimit",15e3)("active",null!==t.currentPart&&t.currentPart.getTurn()%2==1)("canAddTime",t.role===t.Player.ZERO&&!1===t.endGame)("timeToAdd",t.turnTimeMessage),_(3),y("ngIf",t.endGame&&null!==t.currentPart),_(1),y("ngIf",t.isPlaying()),_(1),y("ngIf",t.endGame),_(1),y("ngClass",t.getBoardHighlight())}}let Syt=(()=>{class r{}return u(r,"NO_MATCHING_PART",()=>$localize`The game you tried to join does not exist.`),r})(),pR=(xu=class extends KC{constructor(e,t,n,i,s,o,a,c,l,f){super(e,t,n,i),u(this,"currentGameService",void 0),u(this,"userService",void 0),u(this,"gameService",void 0),u(this,"gameEventService",void 0),u(this,"timeManager",void 0),u(this,"requestManager",void 0),u(this,"chronoZeroGlobal",void 0),u(this,"chronoOneGlobal",void 0),u(this,"chronoZeroTurn",void 0),u(this,"chronoOneTurn",void 0),u(this,"currentPart",null),u(this,"currentPartId",void 0),u(this,"gameStarted",!1),u(this,"opponent",null),u(this,"authUser",void 0),u(this,"currentPlayer",null),u(this,"configRoom",void 0),u(this,"currentGame",g.empty()),u(this,"userLinkedToThisPart",!0),u(this,"routerEventsSubscription",void 0),u(this,"userSubscription",void 0),u(this,"opponentSubscription",new yn),u(this,"partSubscription",new yn),u(this,"gameEventsSubscription",new yn),u(this,"currentGameSubscription",new yn),u(this,"OFFLINE_FONT_COLOR",{color:"lightgrey"}),u(this,"globalTimeMessage",$localize`5 minutes`),u(this,"turnTimeMessage",$localize`30 seconds`),u(this,"requestInfos",m4e.requestInfos),u(this,"allRequests",["TakeBack","Draw","Rematch"]),this.currentGameService=s,this.userService=o,this.gameService=a,this.gameEventService=c,this.timeManager=l,this.requestManager=f}extractPartIdFromURL(){return U.getNonNullable(this.actRoute.snapshot.paramMap.get("id"))}extractGameNameFromURL(){return U.getNonNullable(this.actRoute.snapshot.paramMap.get("compo"))}isPlaying(){return this.role.isPlayer()}getPlayer(){return this.authUser.toMinimalUser()}redirectIfPartOrGameIsInvalid(){var e=this;return M(function*(){const t=e.extractGameNameFromURL();if(Nu.ALL_GAMES().some(i=>i.urlName===t)){if((yield e.gameService.getPartValidity(e.currentPartId,t)).isFailure()){e.routerEventsSubscription.unsubscribe();const s=Syt.NO_MATCHING_PART();yield e.router.navigate(["/notFound",s],{skipLocationChange:!0})}}else{e.routerEventsSubscription.unsubscribe();const i=H0.NO_MATCHING_GAME(t);yield e.router.navigate(["/notFound",i],{skipLocationChange:!0})}})()}setCurrentPartIdOrRedirect(){return this.currentPartId=this.extractPartIdFromURL(),this.redirectIfPartOrGameIsInvalid()}ngOnInit(){var e=this;return M(function*(){e.routerEventsSubscription=e.router.events.subscribe(function(){var t=M(function*(n){n instanceof B4&&(yield e.setCurrentPartIdOrRedirect())});return function(n){return t.apply(this,arguments)}}()),e.userSubscription=e.connectedUserService.subscribeToUser(t=>{e.authUser=t}),yield e.setCurrentPartIdOrRedirect(),e.currentGameSubscription=e.currentGameService.subscribeToCurrentGame(function(){var t=M(function*(n){yield e.onCurrentGameUpdate(n)});return function(n){return t.apply(this,arguments)}}())})()}onCurrentGameUpdate(e){var t=this;return M(function*(){if(e.isPresent()){const n=e.get();"Observer"===n.role||n.id===t.currentPartId?t.currentGame=e:(t.userLinkedToThisPart=!1,yield t.router.navigate(["/lobby"]))}else t.currentGame=g.empty()})()}startGame(e){var t=this;return M(function*(){U.assert(!1===t.gameStarted,"Should not start already started game"),t.configRoom=e,t.gameStarted=!0,window.setTimeout(M(function*(){const n=yield t.afterViewInit();t.timeManager.setClocks([t.chronoZeroTurn,t.chronoOneTurn],[t.chronoZeroGlobal,t.chronoOneGlobal]),U.assert(n,"Game should be created successfully, otherwise part-creation would have redirected"),yield t.startPart()}),2)})()}startPart(){var e=this;return M(function*(){const t=(yield e.gameService.getPart(e.currentPartId)).get();e.currentPart=new fv(e.currentPartId,t),e.partSubscription=e.gameService.subscribeToChanges(e.currentPartId,function(){var n=M(function*(i){U.assert(i.isPresent(),"OnlineGameWrapper observed a part being deleted, this should not happen"),e.currentPart=new fv(e.currentPartId,i.get())});return function(i){return n.apply(this,arguments)}}()),e.subscribeToEvents()})()}onGameStart(){var e=this;return M(function*(){yield e.initializePlayersDatas(e.currentPart);const t=e.gameComponent.getTurn();U.assert(0===t,"turn should always be 0 upon game start"),e.timeManager.onGameStart(e.configRoom),e.requestManager.onGameStart()})()}subscribeToEvents(){var e=this;const t=new dCt,n=function(){var i=M(function*(s){yield t.runExclusive(M(function*(){const o=s.filter(c=>"Move"===c.eventType).length;let a=0;e.beforeEventsBatch();for(const c of s)switch(c.eventType){case"Move":const l=a+1===o;yield e.onReceivedMove(c,l),a+=1;break;case"Request":e.requestManager.onReceivedRequest(c);break;case"Reply":(yield e.requestManager.onReceivedReply(c,e.role))&&(yield e.handleReply(c));break;default:U.expectToBe(c.eventType,"Action","Event should be an action"),e.timeManager.onReceivedAction(c),"EndGame"===c.action?yield e.onGameEnd():"StartGame"===c.action&&(yield e.onGameStart())}yield e.afterEventsBatch()}))});return function(o){return i.apply(this,arguments)}}();this.gameEventsSubscription=this.gameEventService.subscribeToEvents(this.currentPartId,n)}handleReply(e){var t=this;return M(function*(){switch(e.requestType){case"TakeBack":const n=k.of(e.player);yield t.takeBackToPreviousPlayerTurn(n.getOpponent());break;case"Rematch":yield t.router.navigate(["/nextGameLoading"]);const i=t.extractGameNameFromURL();yield t.router.navigate(["/play",i,e.data])}})()}onGameEnd(){var e=this;return M(function*(){yield e.currentGameService.removeCurrentGame(),e.endGame=!0})()}onReceivedMove(e,t){var n=this;return M(function*(){const i=n.gameComponent.rules,s=n.gameComponent.getTurn(),o=n.gameComponent.encoder.decode(e.move),a=i.isLegal(o,n.gameComponent.getState()),c="We received an incorrect db move: "+o.toString()+" at turn "+s+'because "'+a.getReasonOr("")+'"';U.assert(a.isSuccess(),c);const l=i.choose(n.gameComponent.node,o);if(U.assert(l.isPresent(),"Chosen move should be legal after all checks, but it is not!"),n.gameComponent.node=l.get(),n.role===K.NONE)yield n.updateBoardAndShowLastMove(t);else{const f=s%2!==n.role.value;yield n.updateBoardAndShowLastMove(f&&t)}n.currentPlayer=n.players[n.gameComponent.getTurn()%2].get(),n.timeManager.onReceivedMove(e),n.requestManager.onReceivedMove()})()}beforeEventsBatch(){this.timeManager.beforeEventsBatch(this.endGame)}afterEventsBatch(){var e=this;return M(function*(){const t=k.ofTurn(e.gameComponent.getTurn()),n=yield e.userService.getServerTime(e.connectedUserService.user.get().id);e.timeManager.afterEventsBatch(e.endGame,t,n)})()}takeBackToPreviousPlayerTurn(e){var t=this;return M(function*(){t.gameComponent.node=t.gameComponent.node.parent.get(),t.gameComponent.getCurrentPlayer()!==e&&(U.assert(t.gameComponent.getTurn()>0,"Should not allow player that never played to take back"),t.gameComponent.node=t.gameComponent.node.parent.get()),t.currentPlayer=t.players[t.gameComponent.getTurn()%2].get(),0===t.gameComponent.getTurn()?yield t.updateBoardAndShowLastMove(!1):yield t.updateBoardAndShowLastMove(!0)})()}canResign(){return U.assert(this.isPlaying(),"Non playing should not call canResign"),!0!==this.endGame&&null!=this.opponent}requestAvailable(e){switch(e){case"TakeBack":return this.canAskTakeBack();case"Draw":return this.canProposeDraw();default:return U.expectToBe(e,"Rematch"),this.endGame}}mustReply(){return this.requestAwaitingReplyFromUs().isPresent()}requestAwaitingReplyFromUs(){return U.assert(this.role.isPlayer(),"User should be playing"),this.requestManager.getRequestAwaitingReplyFrom(this.role)}requestAwaitingReplyFromOpponent(){return U.assert(this.role.isPlayer(),"User should be playing"),this.requestManager.getRequestAwaitingReplyFrom(this.role.getOpponent())}deniedRequest(){return this.requestManager.deniedRequest()}canPass(){return U.assert(this.isPlaying(),"Non playing should not call canPass"),!this.endGame&&this.currentPlayer?.name===this.getPlayer().name&&this.gameComponent.canPass}canAskTakeBack(){return U.assert(this.isPlaying(),"Non playing should not call canAskTakeBack"),U.assert(null!=this.currentPart,"should not call canAskTakeBack when currentPart is not defined yet"),!(!0===this.endGame||U.getNonNullable(this.currentPart).data.turn<=this.role.value)&&this.requestManager.canMakeRequest("TakeBack")}canProposeDraw(){return U.assert(this.isPlaying(),"Non playing should not call canProposeDraw"),!this.endGame&&this.requestManager.canMakeRequest("Draw")}initializePlayersDatas(e){var t=this;return M(function*(){t.players=[g.of(e.data.playerZero),g.ofNullable(e.data.playerOne)],U.assert(null!=e.data.playerOne,"should not initializePlayersDatas when players data is not received"),t.currentPlayer=t.players[e.data.turn%2].get();const n=yield t.setRealObserverRole();if(n.isPresent()){const i=s=>{U.assert(s.isPresent(),"opponent was deleted, what sorcery is this"),t.opponent=n.get()};t.opponentSubscription=t.userService.observeUserOnServer(n.get().id,i)}})()}setRealObserverRole(){var e=this;return M(function*(){let t=g.empty();return e.players[0].equalsValue(e.getPlayer())?(yield e.setRole(k.ZERO),t=e.players[1]):e.players[1].equalsValue(e.getPlayer())?(yield e.setRole(k.ONE),t=e.players[0]):yield e.setRole(K.NONE),yield e.currentGameService.updateCurrentGame({...e.currentGame.get(),role:e.role===K.NONE?"Observer":"Player"}),t})()}onLegalUserMove(e){var t=this;return M(function*(){if(!t.mustReply()){const n=t.gameComponent.rules.isLegal(e,t.gameComponent.node.gameState);U.assert(n.isSuccess(),"onLegalUserMove called with an illegal move");const i=t.gameComponent.rules.applyLegalMove(e,t.gameComponent.node.gameState,n.get()),s=new Ho(i,g.of(t.gameComponent.node),g.of(e)),o=t.gameComponent.rules.getGameStatus(s),a=t.gameComponent.encoder.encode(e);return yield t.gameService.addMove(t.currentPartId,t.role,a),t.updatePartWithStatusAndScores(o,t.gameComponent.scores)}t.gameComponent.message(H0.MUST_ANSWER_REQUEST())})()}updatePartWithStatusAndScores(e,t){var n=this;return M(function*(){return e.isEndGame?e===_e.DRAW?yield n.gameService.drawPart(n.currentPartId,n.role,t):(U.assert(e.winner.isPlayer(),"Non-draw end games should have a winner"),n.notifyVictory(e.winner,t)):n.gameService.updatePart(n.currentPartId,t)})()}notifyTimeoutVictory(e,t){var n=this;return M(function*(){const i=n.role;yield n.gameService.notifyTimeout(n.currentPartId,i,e,t)})()}notifyVictory(e,t){var n=this;return M(function*(){const i=U.getNonNullable(n.currentPart),s=n.players[0].get(),o=n.players[1].get();n.currentPart=e===k.ONE?i.setWinnerAndLoser(o,s):i.setWinnerAndLoser(s,o);const a=n.role;yield n.gameService.endPartWithVictory(n.currentPartId,a,n.currentPart.getWinner().get(),n.currentPart.getLoser().get(),t)})()}resign(){var e=this;return M(function*(){const t=e.role,n=e.getPlayer(),i=e.players[(e.role.value+1)%2].get();yield e.gameService.resign(e.currentPartId,t,i,n)})()}reachedOutOfTime(e){var t=this;return M(function*(){if(!1===t.isPlaying())return;const n=U.getNonNullable(t.opponent);e===t.role?yield t.notifyTimeoutVictory(n,t.authUser.toMinimalUser()):yield t.notifyTimeoutVictory(t.authUser.toMinimalUser(),n)})()}propose(e){var t=this;return M(function*(){U.assert(t.role.isPlayer(),"cannot propose request if not player");const n=t.role;switch(e){case"Rematch":return t.gameService.proposeRematch(t.currentPartId,n);case"Draw":return t.gameService.proposeDraw(t.currentPartId,n);default:return U.expectToBe(e,"TakeBack"),t.gameService.askTakeBack(t.currentPartId,n)}})()}accept(){var e=this;return M(function*(){U.assert(e.role.isPlayer(),"cannot accept request if not player");const t=e.role,n=U.getNonNullable(e.currentPart),i=e.requestManager.getCurrentRequest().get().requestType;switch(i){case"Rematch":return e.gameService.acceptRematch(n,t);case"Draw":return e.gameService.acceptDraw(n.id,t);default:return U.expectToBe(i,"TakeBack"),e.gameService.acceptTakeBack(n.id,n.data.turn,t)}})()}reject(){var e=this;return M(function*(){U.assert(e.role.isPlayer(),"cannot reject request if not player");const t=e.role,n=e.requestManager.getCurrentRequest().get().requestType;switch(n){case"Rematch":return e.gameService.rejectRematch(e.currentPartId,t);case"Draw":return e.gameService.refuseDraw(e.currentPartId,t);default:return U.expectToBe(n,"TakeBack"),e.gameService.refuseTakeBack(e.currentPartId,t)}})()}getPlayerNameClass(e){return this.opponentIsOffline()?"has-text-grey-light":e===k.ZERO?"has-text-white":"has-text-black"}opponentIsOffline(){return!1}addGlobalTime(){return this.gameService.addGlobalTime(this.currentPartId,this.role)}addTurnTime(){return this.gameService.addTurnTime(this.currentPartId,this.role)}onCancelMove(e){var t=this;return M(function*(){if(t.gameComponent.node.previousMove.isPresent()){const n=t.gameComponent.node.previousMove.get();yield t.gameComponent.showLastMove(n)}})()}ngOnDestroy(){var e=this;return M(function*(){e.routerEventsSubscription.unsubscribe(),e.userSubscription.unsubscribe(),e.currentGameSubscription.unsubscribe(),!1===e.isPlaying()&&e.userLinkedToThisPart&&e.connectedUserService.user.isPresent()&&(yield e.currentGameService.removeCurrentGame()),!0===e.gameStarted&&(e.opponentSubscription.unsubscribe(),e.partSubscription.unsubscribe(),e.gameEventsSubscription.unsubscribe())})()}},u(xu,"\u0275fac",function(e){return new(e||xu)(B(xs),B(lr),B(Gn),B(Ut),B(ds),B(Y5),B(X5),B(Wk),B(pCt),B(m4e))}),u(xu,"\u0275cmp",qe({type:xu,selectors:[["app-online-game-wrapper"]],viewQuery:function(e,t){if(1&e&&(k4(VCt,5),k4(FCt,5),k4($Ct,5),k4(GCt,5)),2&e){let n;M3(n=E3())&&(t.chronoZeroGlobal=n.first),M3(n=E3())&&(t.chronoOneGlobal=n.first),M3(n=E3())&&(t.chronoZeroTurn=n.first),M3(n=E3())&&(t.chronoOneTurn=n.first)}},features:[Qe],decls:5,vars:4,consts:function(){let r,e,t,n,i,s,o,a,c,l,f,d,m,E,w,R,z,$,G,de,ve,Le,nt,gt,vn;return r=$localize`vs.`,e=$localize`Turn n${"\ufffd0\ufffd"}:INTERPOLATION:`,t=$localize`It is your turn.`,n=$localize`It is ${"\ufffd0\ufffd"}:INTERPOLATION:'s turn.`,i=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: points`,s=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: points`,o=$localize`Draw`,a=$localize`You agreed to draw.`,c=$localize`Your draw proposal has been accepted.`,l=$localize`Players agreed to draw.`,f=$localize`You won.`,d=$localize`You lost.`,m=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: won.`,E=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: has reached their time limit. You won.`,w=$localize`You reached your time limit.`,R=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: has reached their time limit.`,z=$localize`You resigned.`,$=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: has resigned.`,G=$localize`Resign`,de=$localize`Pass a turn`,ve=$localize`Accept`,Le=$localize`Reject`,nt=$localize`Your ${"\ufffd0\ufffd"}:INTERPOLATION: request has been rejected.${"\ufffd#4\ufffd"}:START_TAG_FA_ICON:${"\ufffd/#4\ufffd"}:CLOSE_TAG_FA_ICON:`,gt=$localize`Your request for a ${"\ufffd0\ufffd"}:INTERPOLATION: has been sent.${"\ufffd#4\ufffd"}:START_TAG_FA_ICON:${"\ufffd/#4\ufffd"}:CLOSE_TAG_FA_ICON:`,vn=$localize`Go back to the game list`,[["id","partCreation",3,"partId","gameStartNotification",4,"ngIf"],["id","game","class","tile is-ancestor",4,"ngIf"],[1,"block","mt-2"],["id","chat",1,"box"],[3,"chatId","turn"],["id","partCreation",3,"partId","gameStartNotification"],["partCreation",""],["id","game",1,"tile","is-ancestor"],[1,"tile","is-parent"],[1,"tile","is-child","box","has-text-centered"],["class","block","id","turnIndicator",4,"ngIf"],[1,"block"],["id","playerZeroIndicator","class","player0-bg",3,"ngClass",4,"ngIf"],["id","scoreZeroIndicator",4,"ngIf"],["debugName","ZERO Global",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoZeroGlobal",""],["debugName","ZERO Turn",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoZeroTurn",""],[1,"is-size-3"],r,["id","playerOneIndicator","class","player1-bg",3,"ngClass",4,"ngIf"],["id","scoreOneIndicator",4,"ngIf"],["debugName","ONE Global",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoOneGlobal",""],["debugName","ONE Turn",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoOneTurn",""],["class","block","id","winnerIndicator",4,"ngIf"],[4,"ngIf"],["class","button is-primary is-fullwidth mb-1","id","backToServerButton","routerLink","/lobby",4,"ngIf"],["id","board-tile",1,"tile","is-9","is-parent","rounded-div",3,"ngClass"],["id","board",1,"tile","is-child","box"],["board",""],["id","turnIndicator",1,"block"],[1,"subtitle"],e,["class","subtitle","id","currentPlayerIndicator",4,"ngIf"],["id","currentPlayerIndicator",1,"subtitle"],[4,"ngIf","ngIfElse"],["opponentsTurn",""],["id","playerTurn"],t,["id","opponentTurn"],n,["id","playerZeroIndicator",1,"player0-bg",3,"ngClass"],["id","scoreZeroIndicator"],i,["id","playerOneIndicator",1,"player1-bg",3,"ngClass"],["id","scoreOneIndicator"],s,["id","winnerIndicator",1,"block"],["id","hardDrawIndicator",1,"title"],o,["class","title","id","youAgreedToDrawIndicator",4,"ngIf"],["class","title","id","yourOpponentAgreedToDrawIndicator",4,"ngIf"],["class","title","id","playersAgreedToDraw",4,"ngIf"],["id","youAgreedToDrawIndicator",1,"title"],a,["id","yourOpponentAgreedToDrawIndicator",1,"title"],c,["id","playersAgreedToDraw",1,"title"],l,["class","title","id","youWonIndicator",4,"ngIf"],["class","title","id","youLostIndicator",4,"ngIf"],["class","title",4,"ngIf"],["id","youWonIndicator",1,"title"],f,["id","youLostIndicator",1,"title"],d,[1,"title"],m,E,w,R,["class","title","id","resignIndicator",4,"ngIf"],["id","resignIndicator",1,"title"],z,$,["replyButtons",""],["id","requestRejected","class","notification is-danger",4,"ngIf"],["id","requestAwaitingReply","class","notification",4,"ngIf"],["id","resign",1,"button","is-fullwidth","mb-1","is-danger",3,"disabled","click"],G,["id","pass",1,"button","is-fullwidth","mb-1","is-success",3,"disabled","click"],de,[4,"ngFor","ngForOf"],[1,"button","is-fullwidth","mb-1",3,"id","disabled","click"],[3,"icon"],[1,"notification"],["id","accept",1,"button","is-fullwidth","mb-1","is-success",3,"click"],ve,["id","reject",1,"button","is-fullwidth","mb-1","is-danger",3,"click"],Le,["id","requestRejected",1,"notification","is-danger"],nt,["id","requestAwaitingReply",1,"notification"],gt,["id","backToServerButton","routerLink","/lobby",1,"button","is-primary","is-fullwidth","mb-1"],vn]},template:function(e,t){1&e&&(T(0,BCt,2,1,"app-part-creation",0),T(1,Eyt,28,25,"div",1),S(2,"div",2)(3,"div",3),F(4,"app-chat",4),P()()),2&e&&(y("ngIf",!1===t.gameStarted),_(1),y("ngIf",t.gameStarted),_(3),y("chatId",t.currentPartId)("turn",null==t.currentPart?null:t.currentPart.getTurn()))},dependencies:[Ft,Wt,At,Mc,T0,XC,dR,hR],encapsulation:2})),xu);var Fl,gR;function Tyt(r,e){if(1&r&&(S(0,"option",26),lt(1),P()),2&r){const t=e.$implicit;y("value",t.name),_(1),An(t.name)}}function Oyt(r,e){if(1&r&&(S(0,"option",26),oe(1,30),P()),2&r){const t=e.$implicit;y("value",t.name),_(1),$n(t.name),jn(1)}}function byt(r,e){if(1&r){const t=pe();S(0,"select",27),W("ngModelChange",function(i){return te(t),ne(p(2).aiOptions[0]=i)})("change",function(){te(t);const i=p(2);return ne(i.updatePlayer(i.Player.ZERO))}),S(1,"option",28),oe(2,29),P(),T(3,Oyt,2,2,"option",17),P()}if(2&r){const t=p(2);y("ngModel",t.aiOptions[0]),_(3),y("ngForOf",t.availableAIOptions(0))}}function wyt(r,e){if(1&r&&(S(0,"p",31),oe(1,32),P()),2&r){const t=p(2);_(1),$n(t.gameComponent.scores.get()[0]),jn(1)}}function Ayt(r,e){if(1&r&&(S(0,"option",26),lt(1),P()),2&r){const t=e.$implicit;y("value",t.name),_(1),An(t.name)}}function Nyt(r,e){if(1&r&&(S(0,"option",26),oe(1,35),P()),2&r){const t=e.$implicit;y("value",t.name),_(1),$n(t.name),jn(1)}}function Iyt(r,e){if(1&r){const t=pe();S(0,"select",33),W("ngModelChange",function(i){return te(t),ne(p(2).aiOptions[1]=i)})("change",function(){te(t);const i=p(2);return ne(i.updatePlayer(i.Player.ONE))}),S(1,"option",28),oe(2,34),P(),T(3,Nyt,2,2,"option",17),P()}if(2&r){const t=p(2);y("ngModel",t.aiOptions[1]),_(3),y("ngForOf",t.availableAIOptions(1))}}function kyt(r,e){if(1&r&&(S(0,"p",36),oe(1,37),P()),2&r){const t=p(2);_(1),$n(t.gameComponent.scores.get()[1]),jn(1)}}function xyt(r,e){if(1&r&&(S(0,"h4",41),lt(1),P()),2&r){const t=p(3);_(1),An(t.winnerMessage.get())}}function Lyt(r,e){1&r&&(S(0,"h4",42),oe(1,43),P())}function Ryt(r,e){if(1&r&&(S(0,"div",38),T(1,xyt,2,1,"h4",39),T(2,Lyt,2,0,"h4",40),P()),2&r){const t=p(2);_(1),y("ngIf",t.winnerMessage.isPresent()),_(1),y("ngIf",t.winnerMessage.isAbsent())}}function zyt(r,e){if(1&r){const t=pe();S(0,"div",7)(1,"div",8)(2,"p",9),oe(3,10),P()(),S(4,"div",11)(5,"div",12)(6,"div",13)(7,"select",14),W("change",function(){te(t);const i=p();return ne(i.updatePlayer(i.Player.ZERO))})("ngModelChange",function(i){return te(t),ne(p().playerSelection[0]=i)}),S(8,"option",15),oe(9,16),P(),T(10,Tyt,2,2,"option",17),P()(),S(11,"div",13),T(12,byt,4,2,"select",18),P(),T(13,wyt,2,1,"p",19),P(),S(14,"div",20)(15,"div",13)(16,"select",21),W("change",function(){te(t);const i=p();return ne(i.updatePlayer(i.Player.ONE))})("ngModelChange",function(i){return te(t),ne(p().playerSelection[1]=i)}),S(17,"option",15),oe(18,22),P(),T(19,Ayt,2,2,"option",17),P()(),S(20,"div",13),T(21,Iyt,4,2,"select",23),P(),T(22,kyt,2,1,"p",24),P()(),T(23,Ryt,3,2,"div",25),P()}if(2&r){const t=p();_(3),$n(t.gameComponent.getTurn()+1),jn(3),_(4),y("ngModel",t.playerSelection[0]),_(3),y("ngForOf",t.gameComponent.availableAIs),_(2),y("ngIf",!1===t.players[0].equalsValue("human")),_(1),y("ngIf",t.gameComponent.scores.isPresent()),_(3),y("ngModel",t.playerSelection[1]),_(3),y("ngForOf",t.gameComponent.availableAIs),_(2),y("ngIf",!1===t.players[1].equalsValue("human")),_(1),y("ngIf",t.gameComponent.scores.isPresent()),_(1),y("ngIf",t.endGame)}}function Dyt(r,e){if(1&r){const t=pe();S(0,"button",50),W("click",function(){return te(t),ne(p(2).gameComponent.pass())}),oe(1,51),P()}}function Hyt(r,e){if(1&r){const t=pe();S(0,"button",52),W("click",function(){return te(t),ne(p(2).takeBack())}),oe(1,53),P()}}function Vyt(r,e){if(1&r&&(Gt(0),lt(1),F(2,"br"),Bt()),2&r){const t=e.$implicit,n=p(3);_(1),O2(" ",t.name+": "+t.getInfo(n.gameComponent.node)," ")}}function Fyt(r,e){if(1&r&&(S(0,"div",54),T(1,Vyt,3,1,"ng-container",55),lt(2),F(3,"br"),lt(4),F(5,"br"),P()),2&r){const t=p(2);_(1),y("ngForOf",t.gameComponent.availableAIs),_(1),O2(" Created ",t.getCreatedNodes()," nodes."),_(2),O2(" Minimax time: ",t.getMinimaxTime(),"ms.")}}function $yt(r,e){if(1&r){const t=pe();S(0,"div",44),T(1,Dyt,2,0,"button",45),T(2,Hyt,2,0,"button",46),S(3,"button",47),W("click",function(){return te(t),ne(p().restartGame())}),oe(4,48),P(),T(5,Fyt,6,3,"div",49),P()}if(2&r){const t=p();_(1),y("ngIf",!1===t.endGame&&t.gameComponent.canPass),_(1),y("ngIf",t.canTakeBack()),_(3),y("ngIf",t.gameComponent.node.previousMove.isPresent()&&t.displayAIInfo())}}pR=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ne.log],pR);let mR=(gR=Fl=class extends KC{constructor(e,t,n,i,s){super(e,t,n,i),u(this,"cdr",void 0),u(this,"aiOptions",["none","none"]),u(this,"playerSelection",["human","human"]),u(this,"winnerMessage",g.empty()),u(this,"displayAIMetrics",!1),this.cdr=s,this.players=[g.of(this.playerSelection[0]),g.of(this.playerSelection[1])],this.role=k.ZERO}getCreatedNodes(){return mae.createdNodes}getMinimaxTime(){return G7t.aiTime}ngAfterViewInit(){var e=this;window.setTimeout(M(function*(){(yield e.afterViewInit())&&(yield e.restartGame(),e.cdr.detectChanges())}),1)}updatePlayer(e){var t=this;return M(function*(){t.players[e.value]=g.of(t.playerSelection[e.value]),"human"===t.playerSelection[1]&&"human"!==t.playerSelection[0]?yield t.setRole(k.ONE):yield t.setRole(k.ZERO),t.proposeAIToPlay()})()}onLegalUserMove(e){var t=this;return M(function*(){t.gameComponent.node=t.gameComponent.rules.choose(t.gameComponent.node,e).get(),yield t.updateBoard(!1),t.proposeAIToPlay(),t.cdr.detectChanges()})()}updateBoard(e){var t=this;return M(function*(){yield t.updateBoardAndShowLastMove(e);const n=t.gameComponent.rules.getGameStatus(t.gameComponent.node);if(!0===n.isEndGame&&(t.endGame=!0,n.winner.isPlayer())){const i=$localize`Player ${n.winner.value+1}`,o=n.winner.getOpponent().value;t.winnerMessage=t.players[n.winner.value].equalsValue("human")?t.players[o].equalsValue("human")?g.of($localize`${i} won`):g.of($localize`You won`):t.players[o].equalsValue("human")?g.of($localize`You lost`):g.of($localize`${t.players[n.winner.value].get()} (Player ${n.winner.value+1}) won`)}})()}proposeAIToPlay(){var e=this;const t=this.getPlayingAI();t.isPresent()&&window.setTimeout(M(function*(){yield e.doAIMove(t.get().ai,t.get().options)}),gR.AI_TIMEOUT)}getPlayingAI(){if(this.gameComponent.rules.getGameStatus(this.gameComponent.node).isEndGame)return g.empty();const e=this.gameComponent.getTurn()%2,t=this.findAI(e);if(t.isPresent()){const n=t.get(),i=this.aiOptions[e];return g.ofNullable(n.availableOptions.find(o=>o.name===i)).map(o=>({ai:n,options:o}))}return g.empty()}findAI(e){return g.ofNullable(this.gameComponent.availableAIs.find(t=>this.players[e].equalsValue(t.name)))}doAIMove(e,t){var n=this;return M(function*(){const i=n.gameComponent.rules;Ze(i.getGameStatus(n.gameComponent.node)===_e.ONGOING,"AI should not try to play when game is over!");const o=e.chooseNextMove(n.gameComponent.node,t),a=i.choose(n.gameComponent.node,o);return a.isPresent()?(n.gameComponent.node=a.get(),yield n.updateBoard(!0),n.cdr.detectChanges(),n.proposeAIToPlay(),b.SUCCESS):(n.messageDisplayer.criticalMessage($localize`The AI chose an illegal move! This is an unexpected situation that we logged, we will try to solve this as soon as possible. In the meantime, consider that you won!`),d2.logError("LocalGameWrapper","AI chose illegal move",{game:n.getGameName(),name:e.name,move:o.toString()}))})()}availableAIOptions(e){return this.findAI(e).get().availableOptions}canTakeBack(){return this.players[0].equalsValue("human")?this.gameComponent.getTurn()>0:!!this.players[1].equalsValue("human")&&this.gameComponent.getTurn()>1}takeBack(){var e=this;return M(function*(){e.gameComponent.node=e.gameComponent.node.parent.get(),e.isAITurn()&&(U.assert(e.gameComponent.node.parent.isPresent(),"Cannot take back in first turn when AI is Player.ZERO"),e.gameComponent.node=e.gameComponent.node.parent.get()),yield e.updateBoardAndShowLastMove(!1)})()}isAITurn(){return this.getPlayingAI().isPresent()}restartGame(){var e=this;return M(function*(){e.gameComponent.node=e.gameComponent.rules.getInitialNode(),e.gameComponent.hideLastMove(),yield e.gameComponent.updateBoard(!1),e.endGame=!1,e.winnerMessage=g.empty(),e.proposeAIToPlay()})()}getPlayer(){return"human"}onCancelMove(e){var t=this;return M(function*(){if(t.gameComponent.node.previousMove.isPresent()){const n=t.gameComponent.node.previousMove.get();yield t.gameComponent.showLastMove(n)}})()}displayAIInfo(){return"true"===localStorage.getItem("displayAIInfo")}},u(Fl,"AI_TIMEOUT",1e3),u(Fl,"\u0275fac",function(e){return new(e||Fl)(B(xs),B(lr),B(Gn),B(Ut),B(S3))}),u(Fl,"\u0275cmp",qe({type:Fl,selectors:[["app-local-game-wrapper"]],features:[Qe],decls:8,vars:3,consts:function(){let r,e,t,n,i,s,o,a,c,l,f,d,m;return r=$localize`Turn n${"\ufffd0\ufffd"}:INTERPOLATION:`,e=$localize`Human`,t=$localize`Human`,n=$localize`Pick the options`,i=$localize`${"\ufffd0\ufffd"}:INTERPOLATION:`,s=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: points`,o=$localize`Pick the options`,a=$localize`${"\ufffd0\ufffd"}:INTERPOLATION:`,c=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: points`,l=$localize`Draw`,f=$localize`Start a new game`,d=$localize`Pass a turn`,m=$localize`Take back move`,[[1,"tile","is-ancestor"],[1,"tile","is-3","is-vertical","is-parent"],["class","tile is-child box has-text-centered","id","info",4,"ngIf"],["class","tile is-child box is-vcentered",4,"ngIf"],[1,"tile","is-parent","is-9","is-vcentered",3,"ngClass"],["id","board",1,"tile","is-child","box"],["board",""],["id","info",1,"tile","is-child","box","has-text-centered"],["id","turnIndicator",1,"block"],[1,"subtitle"],r,["id","playerSelector",1,"columns"],[1,"column","is-6","is-vcentered"],[1,"select"],["id","playerZeroSelect",3,"ngModel","change","ngModelChange"],["selected","","value","human"],e,[3,"value",4,"ngFor","ngForOf"],["id","aiZeroLevelSelect",3,"ngModel","ngModelChange","change",4,"ngIf"],["id","scoreOne","class","block",4,"ngIf"],[1,"column","is-6"],["id","playerOneSelect",3,"ngModel","change","ngModelChange"],t,["id","aiOneLevelSelect",3,"ngModel","ngModelChange","change",4,"ngIf"],["id","scoreZero","class","block",4,"ngIf"],["id","gameResult","class","block",4,"ngIf"],[3,"value"],["id","aiZeroLevelSelect",3,"ngModel","ngModelChange","change"],["selected","","value","none"],n,i,["id","scoreOne",1,"block"],s,["id","aiOneLevelSelect",3,"ngModel","ngModelChange","change"],o,a,["id","scoreZero",1,"block"],c,["id","gameResult",1,"block"],["id","winner",4,"ngIf"],["id","draw",4,"ngIf"],["id","winner"],["id","draw"],l,[1,"tile","is-child","box","is-vcentered"],["id","passButton","class","button is-primary is-fullwidth mb-1",3,"click",4,"ngIf"],["id","takeBack","class","button is-fullwidth mb-1",3,"click",4,"ngIf"],["id","restartButton",1,"button","is-fullwidth",3,"click"],f,["id","AIInfo",4,"ngIf"],["id","passButton",1,"button","is-primary","is-fullwidth","mb-1",3,"click"],d,["id","takeBack",1,"button","is-fullwidth","mb-1",3,"click"],m,["id","AIInfo"],[4,"ngFor","ngForOf"]]},template:function(e,t){1&e&&(S(0,"div",0)(1,"div",1),T(2,zyt,24,10,"div",2),T(3,$yt,6,3,"div",3),P(),S(4,"div",4)(5,"div",5),F(6,"div",null,6),P()()()),2&e&&(_(2),y("ngIf",t.gameComponent),_(1),y("ngIf",t.gameComponent),_(1),y("ngClass",t.getBoardHighlight()))},dependencies:[Ft,Wt,At,ef,tf,pg,b3,J7],encapsulation:2,changeDetection:0})),Fl);mR=gR=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ne.log],mR);let _4e=(()=>{class r{}return u(r,"STEP_FINISHED",()=>$localize`Step finished!`),u(r,"INFORMATIONAL_STEP",()=>$localize`This step is not expecting any move from your part.`),r})();var Lu;function Byt(r,e){if(1&r&&(S(0,"div",21)(1,"div",22),oe(2,23),P(),F(3,"div",24),P()),2&r){const t=p();_(3),y("innerHTML",t.currentReason.get(),h7)}}function Uyt(r,e){if(1&r){const t=pe();S(0,"button",25),W("click",function(){return te(t),ne(p().retry())}),oe(1,26),P()}}function Wyt(r,e){1&r&&(Gt(0),oe(1,31),Bt())}function qyt(r,e){1&r&&(Gt(0),oe(1,32),Bt())}function jyt(r,e){if(1&r&&T(0,qyt,2,0,"ng-container",28),2&r){p();const t=cn(5),n=p();y("ngIf",n.stepFinished&&n.stepFinished[n.stepIndex])("ngIfElse",t)}}function Zyt(r,e){1&r&&(Gt(0),oe(1,33),Bt())}function Yyt(r,e){if(1&r){const t=pe();S(0,"button",27),W("click",function(){return te(t),ne(p().next())}),T(1,Wyt,2,0,"ng-container",28),T(2,jyt,1,2,"ng-template",null,29,un),T(4,Zyt,2,0,"ng-template",null,30,un),P()}if(2&r){const t=cn(3),n=p();_(1),y("ngIf",n.steps[n.stepIndex]&&n.steps[n.stepIndex].isInformation())("ngIfElse",t)}}function Kyt(r,e){if(1&r){const t=pe();S(0,"button",34),W("click",function(){return te(t),ne(p().start())}),oe(1,35),P()}}function Xyt(r,e){if(1&r){const t=pe();S(0,"button",36),W("click",function(){return te(t),ne(p().playLocally())}),oe(1,37),P()}}function Qyt(r,e){if(1&r){const t=pe();S(0,"button",38),W("click",function(){return te(t),ne(p().createGame())}),oe(1,39),P()}}function Jyt(r,e){if(1&r){const t=pe();S(0,"button",40),W("click",function(){return te(t),ne(p().showSolution())}),oe(1,41),P()}}function eMt(r,e){if(1&r&&(Gt(0),S(1,"option",43),lt(2),P(),Bt()),2&r){const t=p(),n=t.index,i=t.$implicit;_(1),zn("id","step_",n,""),y("value",n),_(1),An(i.title)}}function tMt(r,e){1&r&&(Gt(0),lt(1,"v "),Bt())}function nMt(r,e){1&r&&lt(0,"x ")}function rMt(r,e){if(1&r&&(S(0,"option",44),T(1,tMt,2,0,"ng-container",28),T(2,nMt,1,0,"ng-template",null,45,un),S(4,"span",46),lt(5),P()()),2&r){const t=cn(3),n=p(),i=n.index,s=n.$implicit,o=p();y("value",i),_(1),y("ngIf",o.stepFinished[i])("ngIfElse",t),_(3),zn("id","step_",i,""),_(1),An(s.title)}}function iMt(r,e){if(1&r&&(Gt(0),T(1,eMt,3,3,"ng-container",28),T(2,rMt,6,5,"ng-template",null,42,un),Bt()),2&r){const t=e.index,n=cn(3),i=p();_(1),y("ngIf",t===i.stepIndex)("ngIfElse",n)}}let _R=(Lu=class extends KC{constructor(e,t,n,i,s){super(e,s,t,n),u(this,"cdr",void 0),u(this,"COMPLETED_TUTORIAL_MESSAGE",$localize`Congratulations, you completed the tutorial.`),u(this,"steps",[]),u(this,"successfulSteps",0),u(this,"stepIndex",-1),u(this,"currentMessage",""),u(this,"currentReason",g.empty()),u(this,"moveAttemptMade",!1),u(this,"stepFinished",[]),u(this,"tutorialOver",!1),this.cdr=i,this.role=k.ZERO}getNumberOfSteps(){return this.steps.length}getCurrentStepTitle(){return this.steps.length>0?this.steps[this.stepIndex].title:""}ngAfterViewInit(){var e=this;return M(function*(){(yield e.afterViewInit())&&(yield e.start())})()}start(){var e=this;return M(function*(){const t=e.gameComponent.tutorial;yield e.startTutorial(t)})()}startTutorial(e){var t=this;return M(function*(){t.steps=e,t.tutorialOver=!1,t.stepFinished=t.getCompletionArray(),t.successfulSteps=0,yield t.showStep(0)})()}getCompletionArray(){return this.steps.map(()=>!1)}changeStep(e){var t=this;return M(function*(){const n=e.target;yield t.showStep(Number.parseInt(n.value,10))})()}showStep(e){var t=this;return M(function*(){t.moveAttemptMade=!1,t.stepFinished[e]=!1,t.updateSuccessCount(),t.stepIndex=e;const n=t.steps[t.stepIndex];t.currentMessage=n.instruction,t.currentReason=g.empty(),t.gameComponent.node=new Ho(n.state,g.empty(),n.previousMove),yield t.setRole(t.gameComponent.getCurrentPlayer()),t.cdr.detectChanges()})()}onLegalUserMove(e){var t=this;return M(function*(){const n=t.steps[t.stepIndex],i=t.gameComponent.rules.choose(t.gameComponent.node,e);if(U.assert(i.isPresent(),"It should be impossible to call onLegalUserMove with an illegal move"),t.gameComponent.node=i.get(),yield t.updateBoardAndShowLastMove(!1),t.moveAttemptMade=!0,n.isPredicate()){const s=t.gameComponent.getPreviousState(),o=t.gameComponent.getState(),a=U.getNonNullable(n.predicate)(e,s,o);a.isSuccess()?t.showStepSuccess(n.getSuccessMessage()):t.currentReason=g.of(a.getReason())}else if(n.isAnyMove())Ne.display("TutorialGameWrapperComponent","onLegalUserMove","awaited move!"),t.showStepSuccess(n.getSuccessMessage());else if(n.isMove()){const s=n;s.acceptedMoves.some(o=>o.equals(e))?(Ne.display("TutorialGameWrapperComponent","onLegalUserMove","awaited move!"),t.showStepSuccess(s.getSuccessMessage())):(Ne.display("TutorialGameWrapperComponent","onLegalUserMove","not the move that was awaited."),t.currentReason=g.of(s.getFailureMessage()))}else U.assert(n.isClick(),"Here, we should have a click");t.cdr.detectChanges()})()}retry(){var e=this;return M(function*(){e.moveAttemptMade=!1,yield e.showStep(e.stepIndex)})()}canUserPlay(e){var t=this;return M(function*(){if(t.currentReason=g.empty(),t.stepFinished[t.stepIndex]||t.moveAttemptMade)return b.failure(_4e.STEP_FINISHED());const n=t.steps[t.stepIndex];return n.isClick()?(yield t.updateBoardAndShowLastMove(!1),t.moveAttemptMade=!0,U.getNonNullable(n.acceptedClicks).some(i=>i===e)?t.showStepSuccess(n.getSuccessMessage()):t.currentMessage=n.getFailureMessage(),b.SUCCESS):n.isMove()||n.isPredicate()||n.isAnyMove()?b.SUCCESS:b.failure(_4e.INFORMATIONAL_STEP())})()}onCancelMove(e){var t=this;return M(function*(){void 0!==e&&(t.currentReason=g.of(e)),t.cdr.detectChanges()})()}showStepSuccess(e){this.currentMessage=e,this.stepFinished[this.stepIndex]=!0,this.updateSuccessCount()}updateSuccessCount(){let e=0;for(const t of this.stepFinished)t&&e++;this.successfulSteps=e}next(){var e=this;return M(function*(){if(e.steps[e.stepIndex].isInformation()&&(e.stepFinished[e.stepIndex]=!0,e.updateSuccessCount()),e.stepFinished.length===e.successfulSteps)e.currentMessage=e.COMPLETED_TUTORIAL_MESSAGE,e.tutorialOver=!0;else{let t=(e.stepIndex+1)%e.steps.length;for(;!0===e.stepFinished[t];)t=(t+1)%e.steps.length;yield e.showStep(t)}})()}showSolution(){var e=this;return M(function*(){const t=e.steps[e.stepIndex];U.assert(t.hasSolution(),"step must have solution");const n=t,i=n.getSolution();i instanceof Di?(yield e.showStep(e.stepIndex),e.gameComponent.node=e.gameComponent.rules.choose(e.gameComponent.node,i).get(),yield e.updateBoardAndShowLastMove(!0)):(yield e.showStep(e.stepIndex),window.document.querySelector(i).dispatchEvent(new Event("click"))),e.currentMessage=n.getSuccessMessage(),e.moveAttemptMade=!0,e.cdr.detectChanges()})()}playLocally(){var e=this;return M(function*(){const t=U.getNonNullable(e.actRoute.snapshot.paramMap.get("compo"));yield e.router.navigate(["/local",t])})()}createGame(){var e=this;return M(function*(){const t=U.getNonNullable(e.actRoute.snapshot.paramMap.get("compo"));yield e.router.navigate(["/play",t])})()}getPlayer(){return"tutorial-player"}},u(Lu,"\u0275fac",function(e){return new(e||Lu)(B(xs),B(Gn),B(Ut),B(S3),B(lr))}),u(Lu,"\u0275cmp",qe({type:Lu,selectors:[["app-tutorial-game-wrapper"]],features:[Qe],decls:23,vars:15,consts:function(){let r,e,t,n,i,s,o,a,c;return r=$localize`Failure`,e=$localize`Try again`,t=$localize`Ok`,n=$localize`Continue`,i=$localize`Skip`,s=$localize`Try again`,o=$localize`Play locally`,a=$localize`Create an online game`,c=$localize`See solution`,[[1,"tile","is-ancestor"],[1,"tile","is-5","is-vertical","is-parent"],["id","infos",1,"tile","is-child","box"],[1,"progress","is-primary"],[1,"content","is-medium"],[1,"title"],["id","currentMessage",3,"innerHTML"],["class","message is-danger","role","alert",4,"ngIf"],[1,"block"],["id","retryButton","class","button mr-3",3,"click",4,"ngIf"],["id","nextButton","class","button is-primary mr-3 mb-1",3,"click",4,"ngIf"],["id","restartButton","class","button",3,"click",4,"ngIf"],["id","playLocallyButton","class","button",3,"click",4,"ngIf"],["id","playOnlineButton","class","button",3,"click",4,"ngIf"],["id","showSolutionButton","class","button",3,"click",4,"ngIf"],[1,"select"],["id","steps",3,"change"],[4,"ngFor","ngForOf"],[1,"tile","is-parent","is-7","is-vcentered",3,"ngClass"],["id","board",1,"tile","is-child","box"],["board",""],["role","alert",1,"message","is-danger"],[1,"message-header"],r,["id","currentReason",1,"message-body",3,"innerHTML"],["id","retryButton",1,"button","mr-3",3,"click"],e,["id","nextButton",1,"button","is-primary","mr-3","mb-1",3,"click"],[4,"ngIf","ngIfElse"],["notInfo",""],["notFinished",""],t,n,i,["id","restartButton",1,"button",3,"click"],s,["id","playLocallyButton",1,"button",3,"click"],o,["id","playOnlineButton",1,"button",3,"click"],a,["id","showSolutionButton",1,"button",3,"click"],c,["otherstep",""],["selected","",3,"id","value"],[3,"value"],["notdone",""],[3,"id"]]},template:function(e,t){1&e&&(S(0,"div",0)(1,"div",1)(2,"div",2),F(3,"progress",3),S(4,"div",4)(5,"p",5),lt(6),P(),F(7,"p",6),P(),T(8,Byt,4,1,"div",7),S(9,"div",8),T(10,Uyt,2,0,"button",9),T(11,Yyt,6,2,"button",10),T(12,Kyt,2,0,"button",11),T(13,Xyt,2,0,"button",12),T(14,Qyt,2,0,"button",13),T(15,Jyt,2,0,"button",14),S(16,"div",15)(17,"select",16),W("change",function(i){return t.changeStep(i)}),T(18,iMt,4,2,"ng-container",17),P()()()()(),S(19,"div",18)(20,"div",19),F(21,"div",null,20),P()()()),2&e&&(_(3),I("value",t.successfulSteps)("max",t.getNumberOfSteps()),_(3),lE("",t.getCurrentStepTitle()," [",t.stepIndex+1,"/",t.getNumberOfSteps(),"]"),_(1),y("innerHTML",t.currentMessage,h7),_(1),y("ngIf",t.currentReason.isPresent()),_(2),y("ngIf",!1===t.tutorialOver&&(t.stepFinished&&!0===t.stepFinished[t.stepIndex]||t.moveAttemptMade)),_(1),y("ngIf",!1===t.tutorialOver),_(1),y("ngIf",t.tutorialOver),_(1),y("ngIf",t.tutorialOver),_(1),y("ngIf",t.tutorialOver),_(1),y("ngIf",t.moveAttemptMade&&!1===t.stepFinished[t.stepIndex]),_(3),y("ngForOf",t.steps),_(1),y("ngClass",t.getBoardHighlight()))},dependencies:[Ft,Wt,At,ef,tf],encapsulation:2,changeDetection:0})),Lu);function sMt(r,e){if(1&r&&(S(0,"div",35)(1,"div",36),oe(2,37),P(),S(3,"div",38),lt(4),P()()),2&r){const t=p();_(4),An(t.errorMessage)}}_R=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ne.log],_R);const oMt=function(){return["/login"]};let aMt=(()=>{var r;class e{constructor(n,i){u(this,"connectedUserService",void 0),u(this,"router",void 0),u(this,"faEye",$x),u(this,"errorMessage",void 0),u(this,"registrationForm",new V4({email:new so,username:new so,password:new so})),this.connectedUserService=n,this.router=i}registerWithEmail(){var n=this;return M(function*(){const i=n.registrationForm.value.username,s=n.registrationForm.value.email,o=n.registrationForm.value.password;if(null==i||null==s||null==o)n.errorMessage=$localize`There are missing fields in the registration form, please check that you filled in all fields.`;else{const a=yield n.connectedUserService.doRegister(i,s,o);if(a.isSuccess()){const c=yield n.connectedUserService.sendEmailVerification();c.isSuccess()?yield n.router.navigate(["/verify-account"]):n.errorMessage=c.getReason()}else n.errorMessage=a.getReason()}})()}registerWithGoogle(){var n=this;return M(function*(){const i=yield n.connectedUserService.doGoogleLogin();i.isSuccess()?yield n.router.navigate(["/verify-account"]):n.errorMessage=i.getReason()})()}getPasswordHelpClass(){const n=this.registrationForm.value.password;return null==n||""===n?"":n.length<6?"is-danger":"is-success"}canRegister(){const n=this.registrationForm.value.password??"";return!(""===(this.registrationForm.value.email??"")||""===(this.registrationForm.value.username??"")||""===n||n.length<6)}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(lr),B(Gn))}),u(e,"\u0275cmp",qe({type:r,selectors:[["app-register"]],decls:56,vars:7,consts:function(){let t,n,i,s,o,a,c,l,f,d,m,E,w,R;return t=$localize`Registering`,n=$localize`Email`,i=$localize`Email`,s=$localize`A confirmation email will be sent to validate your account.`,o=$localize`Username`,a=$localize`Username`,c=$localize`Password`,l=$localize`Password`,f=$localize`The password should be at least 6 characters long`,d=$localize`Register`,m=$localize`Register with Google`,E=$localize`Have an account?`,w=$localize`Log in`,R=$localize`Registration error`,[[1,"box"],[1,"title"],t,[3,"formGroup"],[1,"field","is-horizontal"],[1,"field-label","is-normal"],["for","email",1,"label"],n,[1,"field-body"],[1,"field"],[1,"control"],["id","email","formControlName","email","name","email","placeholder",i,"type","email","autofocus","","required","",1,"input"],[1,"help"],s,["for","username",1,"label"],o,["id","username","formControlName","username","name","username","placeholder",a,"type","text","required","",1,"input"],["for","password",1,"label"],c,[1,"control","has-icons-right","is-expanded"],["id","password","formControlName","password","name","password","placeholder",l,"type","password","required","",1,"input"],[1,"icon","is-small","is-right"],["toggleVisibility","",1,"clickable-icon",3,"icon"],["id","passwordHelp",1,"help",3,"ngClass"],f,["id","registerButton",1,"button","is-primary","is-fullwidth",3,"disabled","click"],d,[1,"field-body","is-fullwidth"],["class","message is-danger is-fullwidth","role","alert",4,"ngIf"],["id","googleButton","type","submit",1,"button","is-fullwidth",3,"click"],m,[1,"help","level-right"],E,[3,"routerLink"],w,["role","alert",1,"message","is-danger","is-fullwidth"],[1,"message-header"],R,["id","errorMessage",1,"message-body"]]},template:function(n,i){1&n&&(S(0,"div",0)(1,"p",1),oe(2,2),P(),S(3,"form",3)(4,"div",4)(5,"div",5)(6,"label",6),oe(7,7),P()(),S(8,"div",8)(9,"div",9)(10,"div",10),F(11,"input",11),S(12,"p",12),oe(13,13),P()()()()(),S(14,"div",4)(15,"div",5)(16,"label",14),oe(17,15),P()(),S(18,"div",8)(19,"div",9)(20,"div",10),F(21,"input",16),P()()()(),S(22,"div",4)(23,"div",5)(24,"label",17),oe(25,18),P()(),S(26,"div",8)(27,"div",9)(28,"div",19),F(29,"input",20),S(30,"span",21),F(31,"fa-icon",22),P(),S(32,"p",23),oe(33,24),P()()()()(),S(34,"div",4),F(35,"div",5),S(36,"div",8)(37,"div",9)(38,"div",10)(39,"button",25),W("click",function(){return i.registerWithEmail()}),oe(40,26),P()()()()(),S(41,"div",4),F(42,"div",5),S(43,"div",27),T(44,sMt,5,1,"div",28),P()(),S(45,"div",4),F(46,"div",5),S(47,"div",8)(48,"button",29),W("click",function(){return i.registerWithGoogle()}),oe(49,30),P()()(),S(50,"p",31),Gt(51),oe(52,32),Bt(),lt(53,"\xa0 "),S(54,"a",33),oe(55,34),P()()()()),2&n&&(_(3),y("formGroup",i.registrationForm),_(28),y("icon",i.faEye),_(1),y("ngClass",i.getPasswordHelpClass()),_(7),y("disabled",!i.canRegister()),_(5),y("ngIf",i.errorMessage),_(10),y("routerLink",D1(6,oMt)))},dependencies:[Ft,At,Mc,v6,_c,b3,m6,M6,C6,F8,T0,uR,d4e],encapsulation:2})),e})(),cMt=(()=>{var r;class e{constructor(n){u(this,"router",void 0),u(this,"selectedGame",void 0),this.router=n}pickGame(n){this.selectedGame=n}playLocally(){var n=this;return M(function*(){yield n.router.navigate(["local/"+n.selectedGame])})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(Gn))}),u(e,"\u0275cmp",qe({type:r,selectors:[["app-local-game-creation"]],decls:3,vars:1,consts:function(){let t;return t=$localize`Play offline`,[[3,"pickGame"],["id","launchGame",1,"button","is-primary","is-fullwidth",3,"disabled","click"],t]},template:function(n,i){1&n&&(S(0,"app-pick-game",0),W("pickGame",function(o){return i.pickGame(o)}),P(),S(1,"button",1),W("click",function(){return i.playLocally()}),oe(2,2),P()),2&n&&(_(1),y("disabled",!i.selectedGame))},dependencies:[lR],encapsulation:2})),e})(),lMt=(()=>{var r;class e{constructor(n){u(this,"router",void 0),u(this,"selectedGame",void 0),this.router=n}pickGame(n){this.selectedGame=n}launchTutorial(){var n=this;return M(function*(){yield n.router.navigate(["/tutorial/",n.selectedGame])})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(Gn))}),u(e,"\u0275cmp",qe({type:r,selectors:[["app-tutorial-game-creation"]],decls:3,vars:1,consts:function(){let t;return t=$localize`Learn the rules`,[[3,"pickGame"],["id","launchTutorial",1,"button","is-primary","is-fullwidth",3,"disabled","click"],t]},template:function(n,i){1&n&&(S(0,"app-pick-game",0),W("pickGame",function(o){return i.pickGame(o)}),P(),S(1,"button",1),W("click",function(){return i.launchTutorial()}),oe(2,2),P()),2&n&&(_(1),y("disabled",!i.selectedGame))},dependencies:[lR],encapsulation:2})),e})(),uMt=(()=>{var r;class e{}return r=e,u(e,"\u0275fac",function(n){return new(n||r)}),u(e,"\u0275cmp",qe({type:r,selectors:[["app-next-game-loading"]],decls:2,vars:0,consts:function(){let t;return t=$localize`The replay game is loading, please wait, it should not take long.`,[t]},template:function(n,i){1&n&&(S(0,"p"),oe(1,0),P())},encapsulation:2})),e})();var vR,CR,Xd,yR;function dMt(r,e){if(1&r&&(N(),F(0,"polygon",4)),2&r){const t=p();y("id",t.mainShapeId)("ngClass",t.pieceClasses),I("points",t.MartianChessQueenComponent.HEPTAGON)}}function hMt(r,e){if(1&r&&(N(),F(0,"polygon",4)),2&r){const t=p();y("id",t.mainShapeId)("ngClass",t.pieceClasses),I("points",t.MartianChessQueenComponent.EIGHT_POINTED_STAR)}}function pMt(r,e){if(1&r&&(N(),F(0,"circle",5)),2&r){const t=p();y("id",t.mainShapeId)("ngClass",t.pieceClasses),I("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",.5*t.MartianChessComponent.SPACE_SIZE-t.MartianChessComponent.STROKE_WIDTH)}}function gMt(r,e){if(1&r&&(Gt(0),N(),F(1,"circle",6)(2,"circle",6)(3,"circle",6),Bt()),2&r){const t=p();_(1),I("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",t.MartianChessComponent.getRadius(3)),_(1),I("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",t.MartianChessComponent.getRadius(2)),_(1),I("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",t.MartianChessComponent.getRadius(1))}}function mMt(r,e){if(1&r&&(N(),S(0,"g"),F(1,"circle",7)(2,"circle",7)(3,"circle",7),P()),2&r){const t=p();_(1),I("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.45*t.MartianChessComponent.SPACE_SIZE)("r",.2/3*t.MartianChessComponent.SPACE_SIZE),_(1),I("cx",.45*t.MartianChessComponent.SPACE_SIZE)("cy",.55*t.MartianChessComponent.SPACE_SIZE)("r",.2/3*t.MartianChessComponent.SPACE_SIZE),_(1),I("cx",.55*t.MartianChessComponent.SPACE_SIZE)("cy",.55*t.MartianChessComponent.SPACE_SIZE)("r",.2/3*t.MartianChessComponent.SPACE_SIZE)}}function _Mt(r,e){if(1&r&&(N(),S(0,"g",8),F(1,"circle",9)(2,"circle",9)(3,"circle",9),P()),2&r){const t=p();y("ngClass",t.pieceClasses),_(1),I("cx",.5*t.MartianChessComponent.SPACE_SIZE-3*t.horizontalDotsRadius)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",1.5*t.horizontalDotsRadius),_(1),I("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",1.5*t.horizontalDotsRadius),_(1),I("cx",.5*t.MartianChessComponent.SPACE_SIZE+3*t.horizontalDotsRadius)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",1.5*t.horizontalDotsRadius)}}class $l{constructor(){u(this,"mainShapeId",void 0),u(this,"pieceClasses",void 0),u(this,"style",void 0),u(this,"MartianChessQueenComponent",$l),u(this,"MartianChessComponent",Ms),u(this,"horizontalDotsRadius",Ms.SPACE_SIZE/15)}}function CMt(r,e){if(1&r&&(N(),F(0,"polygon",4)),2&r){const t=p();y("id",t.mainShapeId)("ngClass",t.pieceClasses),I("points",t.MartianChessDroneComponent.PENTAGON)}}function yMt(r,e){if(1&r&&(N(),F(0,"polygon",4)),2&r){const t=p();y("id",t.mainShapeId)("ngClass",t.pieceClasses),I("points",t.MartianChessDroneComponent.FOUR_POINTED_STAR_VERTICAL)}}function MMt(r,e){if(1&r&&(N(),F(0,"circle",5)),2&r){const t=p();y("id",t.mainShapeId)("ngClass",t.pieceClasses),I("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",.5*t.MartianChessComponent.SPACE_SIZE-t.MartianChessComponent.STROKE_WIDTH)}}function EMt(r,e){if(1&r&&(Gt(0),N(),F(1,"circle",6)(2,"circle",6),Bt()),2&r){const t=p();_(1),I("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",t.MartianChessComponent.getRadius(2)),_(1),I("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",t.MartianChessComponent.getRadius(1))}}function SMt(r,e){if(1&r&&(N(),S(0,"g",7),F(1,"circle",8)(2,"circle",8),P()),2&r){const t=p();y("ngClass",t.pieceClasses),_(1),I("cx",.4*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",.2/3*t.MartianChessComponent.SPACE_SIZE),_(1),I("cx",.6*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",.2/3*t.MartianChessComponent.SPACE_SIZE)}}function PMt(r,e){if(1&r&&(N(),S(0,"g",7),F(1,"circle",9)(2,"circle",9),P()),2&r){const t=p();y("ngClass",t.pieceClasses),_(1),I("cx",.5*t.MartianChessComponent.SPACE_SIZE-2*t.horizontalDotsRadius)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",1.5*t.horizontalDotsRadius),_(1),I("cx",.5*t.MartianChessComponent.SPACE_SIZE+2*t.horizontalDotsRadius)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",1.5*t.horizontalDotsRadius)}}vR=$l,u($l,"HEPTAGON",Ms.getRegularPolygon(7)),u($l,"EIGHT_POINTED_STAR",Ms.getNPointedStar(8,0)),u($l,"\u0275fac",function(e){return new(e||vR)}),u($l,"\u0275cmp",qe({type:vR,selectors:[["","app-martian-chess-queen",""]],inputs:{mainShapeId:"mainShapeId",pieceClasses:"pieceClasses",style:"style"},attrs:["app-martian-chess-queen",""],decls:6,vars:6,consts:[["class","base","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["class","base",3,"id","ngClass",4,"ngIf"],[4,"ngIf"],[3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[1,"base",3,"id","ngClass"],[1,"base","no-fill","mid-stroke"],[1,"base","mid-stroke"],[3,"ngClass"],[1,"base-no-stroke"]],template:function(e,t){1&e&&(T(0,dMt,1,3,"polygon",0),T(1,hMt,1,3,"polygon",0),T(2,pMt,1,5,"circle",1),T(3,gMt,4,9,"ng-container",2),T(4,mMt,4,9,"g",2),T(5,_Mt,4,10,"g",3)),2&e&&(y("ngIf","Polygon"===t.style.shape),_(1),y("ngIf","Star"===t.style.shape),_(1),y("ngIf","Circle"===t.style.shape),_(1),y("ngIf","Concentric Circles"===t.style.points),_(1),y("ngIf","Dots"===t.style.points),_(1),y("ngIf","Horizontal Points"===t.style.points))},dependencies:[Ft,At],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}));class Gl{constructor(){u(this,"mainShapeId",void 0),u(this,"pieceClasses",void 0),u(this,"style",void 0),u(this,"MartianChessComponent",Ms),u(this,"MartianChessDroneComponent",Gl),u(this,"horizontalDotsRadius",Ms.SPACE_SIZE/15)}}function OMt(r,e){if(1&r&&(N(),F(0,"polygon",5)),2&r){const t=p();y("id",t.mainShapeId)("ngClass",t.pieceClasses),I("points",t.MartianChessPawnComponent.TRIANGLE)}}function bMt(r,e){if(1&r&&(N(),F(0,"polygon",5)),2&r){const t=p();y("id",t.mainShapeId)("ngClass",t.pieceClasses),I("points",t.MartianChessPawnComponent.FOUR_POINTED_STAR_DIAGONAL)}}function wMt(r,e){if(1&r&&(N(),F(0,"circle",6)),2&r){const t=p();y("id",t.mainShapeId)("ngClass",t.pieceClasses),I("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",.5*t.MartianChessComponent.SPACE_SIZE-t.MartianChessComponent.STROKE_WIDTH)}}function AMt(r,e){if(1&r&&(N(),F(0,"circle",7)),2&r){const t=p();I("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE+t.getConcreteTriangleYOffset())("r",t.MartianChessComponent.getRadius(1))}}function NMt(r,e){if(1&r&&(N(),F(0,"circle",8)),2&r){const t=p();I("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",.2/3*t.MartianChessComponent.SPACE_SIZE)}}function IMt(r,e){if(1&r&&(N(),S(0,"g",9),F(1,"circle",10),P()),2&r){const t=p();y("ngClass",t.pieceClasses),_(1),I("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",1.5*t.horizontalDotsRadius)}}CR=Gl,u(Gl,"FOUR_POINTED_STAR_VERTICAL",Ms.getNPointedStar(4,0)),u(Gl,"PENTAGON",Ms.getRegularPolygon(5)),u(Gl,"\u0275fac",function(e){return new(e||CR)}),u(Gl,"\u0275cmp",qe({type:CR,selectors:[["","app-martian-chess-drone",""]],inputs:{mainShapeId:"mainShapeId",pieceClasses:"pieceClasses",style:"style"},attrs:["app-martian-chess-drone",""],decls:6,vars:6,consts:[["class","base","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["class","base",3,"id","ngClass",4,"ngIf"],[4,"ngIf"],[3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[1,"base",3,"id","ngClass"],[1,"base","no-fill","mid-stroke"],[3,"ngClass"],[1,"base","mid-stroke"],[1,"base-no-stroke"]],template:function(e,t){1&e&&(T(0,CMt,1,3,"polygon",0),T(1,yMt,1,3,"polygon",0),T(2,MMt,1,5,"circle",1),T(3,EMt,3,6,"ng-container",2),T(4,SMt,3,7,"g",3),T(5,PMt,3,7,"g",3)),2&e&&(y("ngIf","Polygon"===t.style.shape),_(1),y("ngIf","Star"===t.style.shape),_(1),y("ngIf","Circle"===t.style.shape),_(1),y("ngIf","Concentric Circles"===t.style.points),_(1),y("ngIf","Dots"===t.style.points),_(1),y("ngIf","Horizontal Points"===t.style.points))},dependencies:[Ft,At],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}));class Qa{constructor(){u(this,"mainShapeId",void 0),u(this,"pieceClasses",void 0),u(this,"style",void 0),u(this,"MartianChessComponent",Ms),u(this,"MartianChessPawnComponent",Qa),u(this,"horizontalDotsRadius",Ms.SPACE_SIZE/15)}static getTriangle(){return Ms.getRegularPolygon(3,Qa.TRIANGLE_Y_OFFSET)}static yOffsetForVerticalCentering(){const t=Ms.getRegularPolygonCoords(3).map(c=>c.y);return(t.reduce((c,l)=>Math.min(c,l))+(100-t.reduce((c,l)=>Math.max(c,l))))/4}getConcreteTriangleYOffset(){return"Polygon"===this.style.shape?Qa.TRIANGLE_Y_OFFSET:0}}function xMt(r,e){if(1&r&&(N(),F(0,"text",8)),2&r){const t=p();wi("id","height_",t.coord.x,"_",t.coord.y,"_",t.coord.z,""),y("innerHTML",t.coord.z,h7)}}function LMt(r,e){if(1&r&&(N(),F(0,"polyline",9)),2&r){const t=p();y("ngClass",t.pieceClasses),I("points",t.getUpperHorizontalLine())}}function RMt(r,e){if(1&r&&(N(),S(0,"g"),F(1,"polyline",10)(2,"polyline",11),P()),2&r){const t=p();_(1),y("ngClass",t.pieceClasses),I("points",t.getMiddleHorizontalLine()),_(1),y("ngClass",t.pieceClasses),I("points",t.getLowerHorizontalLine())}}function zMt(r,e){if(1&r&&(N(),F(0,"polyline",12)),2&r){const t=p();y("ngClass",t.pieceClasses),I("points",t.getLeftDiagonalLine())}}function DMt(r,e){if(1&r&&(N(),S(0,"g"),F(1,"polyline",13)(2,"polyline",14),P()),2&r){const t=p();_(1),y("ngClass",t.pieceClasses),I("points",t.getMiddleDiagonalLine()),_(1),y("ngClass",t.pieceClasses),I("points",t.getRighterDiagonalLine())}}function HMt(r,e){if(1&r&&(N(),F(0,"polyline",15)),2&r){const t=p();y("ngClass",t.pieceClasses),I("points",t.getLeftVerticalLine())}}function VMt(r,e){if(1&r&&(N(),F(0,"polyline",16)),2&r){const t=p();y("ngClass",t.pieceClasses),I("points",t.getMiddleVerticalLine())}}function FMt(r,e){if(1&r&&(N(),F(0,"polyline",17)),2&r){const t=p();y("ngClass",t.pieceClasses),I("points",t.getRighterVerticalLine())}}Xd=Qa,u(Qa,"FOUR_POINTED_STAR_DIAGONAL",Ms.getNPointedStar(4,45)),u(Qa,"TRIANGLE_Y_OFFSET",Xd.yOffsetForVerticalCentering()),u(Qa,"TRIANGLE",Xd.getTriangle()),u(Qa,"\u0275fac",function(e){return new(e||Xd)}),u(Qa,"\u0275cmp",qe({type:Xd,selectors:[["","app-martian-chess-pawn",""]],inputs:{mainShapeId:"mainShapeId",pieceClasses:"pieceClasses",style:"style"},attrs:["app-martian-chess-pawn",""],decls:6,vars:6,consts:[["class","base","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["class","base",3,"id","ngClass",4,"ngIf"],["class","base no-fill mid-stroke",4,"ngIf"],["class","base mid-stroke",4,"ngIf"],[3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[1,"base",3,"id","ngClass"],[1,"base","no-fill","mid-stroke"],[1,"base","mid-stroke"],[3,"ngClass"],[1,"base-no-stroke"]],template:function(e,t){1&e&&(T(0,OMt,1,3,"polygon",0),T(1,bMt,1,3,"polygon",0),T(2,wMt,1,5,"circle",1),T(3,AMt,1,3,"circle",2),T(4,NMt,1,3,"circle",3),T(5,IMt,2,4,"g",4)),2&e&&(y("ngIf","Polygon"===t.style.shape),_(1),y("ngIf","Star"===t.style.shape),_(1),y("ngIf","Circle"===t.style.shape),_(1),y("ngIf","Concentric Circles"===t.style.points),_(1),y("ngIf","Dots"===t.style.points),_(1),y("ngIf","Horizontal Points"===t.style.points))},dependencies:[Ft,At],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}));class Qd{constructor(){u(this,"coord",void 0),u(this,"move",void 0),u(this,"pieceClasses",void 0),u(this,"mode",void 0),u(this,"mustDisplayHeight",void 0)}mustForceStrokeDisplay(){return void 0===this.move||this.pieceClasses.some(e=>"victory-stroke"===e)||this.pieceClasses.some(e=>"last-move-stroke"===e)}get3DIsoSquarePoints(){const e=this.getParallelogramPoints();return this.mapCoordToPoints([e[0],e[1],e[4],e[6],e[5],e[2],e[0]])}getParallelogramPoints(){const e=this.mode.parallelogramHeight*this.mode.horizontalWidthRatio,t=this.mode.parallelogramHeight,n=this.mode.offsetRatio*this.mode.parallelogramHeight,i=this.mode.parallelogramHeight*this.mode.pieceHeightRatio,s=e,a=e-n,c=t,l=-n,f=t;return[new C(0,0),new C(s,0),new C(l,f),new C(a,c),new C(s,0+i),new C(l,f+i),new C(a,c+i)]}mapCoordToPoints(e){return e.map(t=>t.x+" "+t.y).join(" ")}getUpperHorizontalLineCoords(){const e=this.getParallelogramPoints(),t=e[0],n=e[1],s=new St(-1*this.mode.offsetRatio*Fn.STROKE_WIDTH,Fn.STROKE_WIDTH),o=t.getNext(s),a=n.getNext(s);return[t,n,a,o]}getUpperHorizontalLine(){const e=this.getUpperHorizontalLineCoords();return this.mapCoordToPoints(e)}getMiddleHorizontalCoords(){const e=this.getParallelogramPoints(),t=e[2],n=e[3],s=new St(-1*this.mode.offsetRatio*Fn.STROKE_WIDTH,Fn.STROKE_WIDTH);return[t.getNext(s,-1),n.getNext(s,-1),n,t]}getMiddleHorizontalLine(){const e=this.getMiddleHorizontalCoords();return this.mapCoordToPoints(e)}getLowerHorizontalLine(){const e=this.getParallelogramPoints(),t=e[5],n=e[6],i=new St(0,Fn.STROKE_WIDTH),s=t.getNext(i,-1),o=n.getNext(i,-1);return this.mapCoordToPoints([s,o,n,t])}getLeftDiagonalLine(){const e=this.getParallelogramPoints(),t=e[0],n=e[2],s=new St(Fn.STROKE_WIDTH,0),o=t.getNext(s,1),a=n.getNext(s,1);return this.mapCoordToPoints([t,o,a,n])}getMiddleDiagonalLine(){const e=this.getParallelogramPoints(),t=e[1],n=e[3],s=new St(Fn.STROKE_WIDTH,0),o=t.getNext(s,-1),a=n.getNext(s,-1);return this.mapCoordToPoints([o,t,n,a])}getRighterDiagonalLine(){const e=this.getParallelogramPoints(),t=e[4],n=e[6],s=new St(0,Fn.STROKE_WIDTH),o=t.getNext(s,-1),a=n.getNext(s,-1);return this.mapCoordToPoints([o,t,n,a])}getLeftVerticalLine(){const e=this.getParallelogramPoints(),t=e[2],n=e[5],s=new St(Fn.STROKE_WIDTH,0),o=t.getNext(s,1),a=n.getNext(s,1);return this.mapCoordToPoints([t,o,a,n])}getMiddleVerticalLine(){const e=this.getParallelogramPoints(),t=e[3],n=e[6],s=new St(Fn.STROKE_WIDTH,0),o=t.getNext(s,-1),a=n.getNext(s,-1);return this.mapCoordToPoints([o,t,n,a])}getRighterVerticalLine(){const e=this.getParallelogramPoints(),t=e[1],n=e[4],o=new St(Fn.STROKE_WIDTH,-Fn.STROKE_WIDTH/this.mode.offsetRatio),a=t.getNext(o,-1),c=n.getNext(o,-1);return this.mapCoordToPoints([a,t,n,c])}getOtherCoord(){Ze(null!=this.move,"Move should be set before calling getOtherCoord");const e=this.move;return e.getZero().equals(this.coord)?e.getOne():e.getZero()}isLeftHalf(){if(null==this.move)return!1;{const e=this.getOtherCoord();return this.coord.x===e.x-1}}isRightHalf(){if(null==this.move)return!1;{const e=this.getOtherCoord();return this.coord.x===e.x+1}}isTopHalf(){if(null==this.move)return!1;{const e=this.getOtherCoord();return this.coord.y===e.y-1}}isBottomHalf(){if(null==this.move)return!1;{const e=this.getOtherCoord();return this.coord.y===e.y+1}}}yR=Qd,u(Qd,"STROKE_OFFSET",Fn.STROKE_WIDTH/2),u(Qd,"\u0275fac",function(e){return new(e||yR)}),u(Qd,"\u0275cmp",qe({type:yR,selectors:[["","mgp-trexo-half-piece",""]],inputs:{coord:"coord",move:"move",pieceClasses:"pieceClasses",mode:"mode",mustDisplayHeight:"mustDisplayHeight"},attrs:["mgp-trexo-half-piece",""],decls:9,vars:13,consts:[[3,"id","ngClass"],["x","50","y","66","class","text-big text-center",3,"id","innerHTML",4,"ngIf"],["id","line_0_to_1","class","base manual-stroke",3,"ngClass",4,"ngIf"],[4,"ngIf"],["id","line_0_to_2","class","base manual-stroke",3,"ngClass",4,"ngIf"],["id","line_2_to_5","class","base manual-stroke",3,"ngClass",4,"ngIf"],["id","line_3_to_6","class","base manual-stroke",3,"ngClass",4,"ngIf"],["id","line_1_to_4","class","base manual-stroke",3,"ngClass",4,"ngIf"],["x","50","y","66",1,"text-big","text-center",3,"id","innerHTML"],["id","line_0_to_1",1,"base","manual-stroke",3,"ngClass"],["id","line_2_to_3",1,"base","manual-stroke",3,"ngClass"],["id","line_5_to_6",1,"base","manual-stroke",3,"ngClass"],["id","line_0_to_2",1,"base","manual-stroke",3,"ngClass"],["id","line_1_to_3",1,"base","manual-stroke",3,"ngClass"],["id","line_4_to_6",1,"base","manual-stroke",3,"ngClass"],["id","line_2_to_5",1,"base","manual-stroke",3,"ngClass"],["id","line_3_to_6",1,"base","manual-stroke",3,"ngClass"],["id","line_1_to_4",1,"base","manual-stroke",3,"ngClass"]],template:function(e,t){1&e&&(N(),F(0,"polyline",0),T(1,xMt,1,4,"text",1),T(2,LMt,1,2,"polyline",2),T(3,RMt,3,4,"g",3),T(4,zMt,1,2,"polyline",4),T(5,DMt,3,4,"g",3),T(6,HMt,1,2,"polyline",5),T(7,VMt,1,2,"polyline",6),T(8,FMt,1,2,"polyline",7)),2&e&&(wi("id","tile_",t.coord.x,"_",t.coord.y,"_",t.coord.z,""),y("ngClass",t.pieceClasses),I("points",t.get3DIsoSquarePoints()),_(1),y("ngIf",t.mustDisplayHeight),_(1),y("ngIf",!1===t.isBottomHalf()||t.mustForceStrokeDisplay()),_(1),y("ngIf",!1===t.isTopHalf()||t.mustForceStrokeDisplay()),_(1),y("ngIf",!1===t.isRightHalf()||t.mustForceStrokeDisplay()),_(1),y("ngIf",!1===t.isLeftHalf()||t.mustForceStrokeDisplay()),_(1),y("ngIf",t.isBottomHalf()||t.isLeftHalf()||t.mustForceStrokeDisplay()),_(1),y("ngIf",t.isBottomHalf()||t.isRightHalf()||t.mustForceStrokeDisplay()),_(1),y("ngIf",t.isTopHalf()||t.isRightHalf()||t.mustForceStrokeDisplay()))},dependencies:[Ft,At],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}));const Jd_firebaseConfig={apiKey:"AIzaSyCgOzdBWz58aFnjCFGzH_KiLMtA8PXaQhc",authDomain:"everyboard-dev.firebaseapp.com",projectId:"everyboard-dev",storageBucket:"everyboard-dev.appspot.com",messagingSenderId:"579824736515"};let MR=(()=>{var r;class e{constructor(n){u(this,"connectedUserService",void 0),u(this,"userSubscription",void 0),this.connectedUserService=n}canActivate(){var n=this;return M(function*(){const i=yield new Promise(s=>{n.userSubscription=n.connectedUserService.subscribeToUser(function(){var o=M(function*(a){return s(yield n.evaluateUserPermission(a))});return function(a){return o.apply(this,arguments)}}())});return n.userSubscription.unsubscribe(),i})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(Pe(lr))}),u(e,"\u0275prov",He({token:r,factory:r.\u0275fac,providedIn:"root"})),e})(),Ru=(()=>{var r;class e extends MR{static evaluateUserPermission(n,i){return M(function*(){return!1===i.isConnected()?n.parseUrl("/login"):!1!==i.verified||n.parseUrl("/verify-account")})()}constructor(n,i){super(n),u(this,"router",void 0),this.router=i}evaluateUserPermission(n){var i=this;return M(function*(){return e.evaluateUserPermission(i.router,n)})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(Pe(lr),Pe(Gn))}),u(e,"\u0275prov",He({token:r,factory:r.\u0275fac,providedIn:"root"})),e})(),ER=(()=>{var r;class e{constructor(n,i){u(this,"currentGameService",void 0),u(this,"router",void 0),u(this,"currentGameSubscription",g.empty()),this.currentGameService=n,this.router=i}canActivate(n){var i=this;return M(function*(){const s=yield i.currentGameService.getCurrentGame();if(s.isAbsent())return!0;const o=s.get();return n.params.id===o.id||i.router.parseUrl("/play/"+o.typeGame+"/"+o.id)})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(Pe(ds),Pe(Gn))}),u(e,"\u0275prov",He({token:r,factory:r.\u0275fac,providedIn:"root"})),e})(),$Mt=(()=>{var r;class e extends MR{constructor(n,i){super(n),u(this,"router",void 0),this.router=i}evaluateUserPermission(n){var i=this;return M(function*(){return!1===n.isConnected()?i.router.parseUrl("/login"):!n.verified||i.router.parseUrl("/")})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(Pe(lr),Pe(Gn))}),u(e,"\u0275prov",He({token:r,factory:r.\u0275fac,providedIn:"root"})),e})(),GMt=(()=>{var r;class e extends MR{constructor(n,i){super(n),u(this,"router",void 0),this.router=i}evaluateUserPermission(n){var i=this;return M(function*(){return!1===n.isConnected()||i.router.parseUrl("/")})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(Pe(lr),Pe(Gn))}),u(e,"\u0275prov",He({token:r,factory:r.\u0275fac,providedIn:"root"})),e})();function BMt(r,e){1&r&&(S(0,"p",20),oe(1,21),P())}function UMt(r,e){if(1&r){const t=pe();S(0,"div",7)(1,"p",8),oe(2,9),P(),S(3,"div",10)(4,"p",11),oe(5,12),P(),S(6,"button",13),W("click",function(){return te(t),ne(p().finalizeEmailVerification())}),oe(7,14),P()(),S(8,"div",15)(9,"p",11),oe(10,16),P(),S(11,"button",17),W("click",function(){return te(t),ne(p().sendEmailVerification())}),oe(12,18),P()(),T(13,BMt,2,0,"p",19),P()}if(2&r){const t=p();_(2),$n(t.emailAddress),jn(2),_(11),y("ngIf",t.success)}}function WMt(r,e){if(1&r){const t=pe();S(0,"div",24)(1,"div",8),oe(2,25),P(),S(3,"form",26)(4,"div",27)(5,"div",28),F(6,"input",29),P(),S(7,"div",28)(8,"button",30),W("click",function(){te(t);const i=p(2);return ne(i.pickUsername(i.usernameForm.value))}),oe(9,31),P()()()()()}if(2&r){const t=p(2);_(3),y("formGroup",t.usernameForm)}}const qMt=function(){return["/lobby"]};function jMt(r,e){1&r&&(S(0,"div",32),Ns(1,33),F(2,"a",34),Is(),P()),2&r&&(_(2),y("routerLink",D1(1,qMt)))}function ZMt(r,e){if(1&r&&(Gt(0),T(1,WMt,10,1,"div",22),T(2,jMt,3,2,"div",23),Bt()),2&r){const t=p();_(1),y("ngIf",!t.success),_(1),y("ngIf",t.success)}}function YMt(r,e){if(1&r&&(S(0,"div",35)(1,"div",36),lt(2),P()()),2&r){const t=p();_(2),An(t.errorMessage)}}let KMt=(()=>{var r;class e{constructor(n,i){u(this,"connectedUserService",void 0),u(this,"router",void 0),u(this,"verificationType",null),u(this,"success",!1),u(this,"triedToFinalize",!1),u(this,"errorMessage",void 0),u(this,"emailAddress",void 0),u(this,"userSubscription",void 0),u(this,"usernameForm",new V4({username:new so})),this.connectedUserService=n,this.router=i}ngOnInit(){var n=this;return M(function*(){n.userSubscription=n.connectedUserService.subscribeToUser(function(){var i=M(function*(s){n.emailAddress=s.email.get(),s.username.isAbsent()?n.verificationType="enter-username":(n.verificationType="send-email",!0===n.triedToFinalize&&!1===s.verified&&(n.errorMessage=$localize`You have not verified your email! Click on the link in the verification email.`),!0===s.verified&&(yield n.router.navigate(["/lobby"])))});return function(s){return i.apply(this,arguments)}}())})()}pickUsername(n){var i=this;return M(function*(){const s=yield i.connectedUserService.setUsername(n.username);s.isSuccess()?i.success=!0:i.errorMessage=s.getReason()})()}sendEmailVerification(){var n=this;return M(function*(){const i=yield n.connectedUserService.sendEmailVerification();i.isSuccess()?n.success=!0:n.errorMessage=i.getReason()})()}finalizeEmailVerification(){var n=this;return M(function*(){n.triedToFinalize=!0,yield n.connectedUserService.reloadUser(),window.open(window.location.href,"_self")})()}ngOnDestroy(){null!=this.userSubscription&&null!=this.userSubscription.unsubscribe&&this.userSubscription.unsubscribe()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(lr),B(Gn))}),u(e,"\u0275cmp",qe({type:r,selectors:[["app-verify-account"]],decls:7,vars:3,consts:function(){let t,n,i,s,o,a,c,l,f,d,m;return t=$localize`Account verification`,n=$localize`In order to finalize your account, you must click on the link that you should have received on your email address (${"\ufffd0\ufffd"}:INTERPOLATION:). The email could be in your spam folder.`,i=$localize`Once you have verified your email, click on the following button:`,s=$localize`Finalize email verification`,o=$localize`If you have not received the verification email, click on the following button:`,a=$localize`Send verification email again`,c=$localize`The email has been sent`,l=$localize`In order to finalize your account, you must choose a username.`,f=$localize`Username`,d=$localize`Pick username`,m=$localize`Your account has now been finalized, you can go back to the ${"\ufffd#2\ufffd"}:START_LINK:list of games${"\ufffd/#2\ufffd"}:CLOSE_LINK:.`,[[1,"box"],[1,"message","is-info"],[1,"message-header"],t,["class","message-body","id","verificationEmail",4,"ngIf"],[4,"ngIf"],["class","message is-danger",4,"ngIf"],["id","verificationEmail",1,"message-body"],[1,"block"],n,[1,"block","level-left"],[1,"level-item"],i,["id","finalizeVerification",1,"button","is-primary","level-item","is-small",3,"click"],s,[1,"level-left"],o,["id","sendEmail",1,"button","is-warning","level-item","is-small",3,"click"],a,["id","success","class","help is-success",4,"ngIf"],["id","success",1,"help","is-success"],c,["id","askUsername","class","message-body",4,"ngIf"],["id","success","class","message-body",4,"ngIf"],["id","askUsername",1,"message-body"],l,[3,"formGroup"],[1,"field","has-addons"],[1,"control"],["id","username","type","text","placeholder",f,"name","username","required","","formControlName","username",1,"input"],["id","pickUsername",1,"button","is-info",3,"click"],d,["id","success",1,"message-body"],m,[3,"routerLink"],[1,"message","is-danger"],["id","errorMessage",1,"message-body"]]},template:function(n,i){1&n&&(S(0,"div",0)(1,"div",1)(2,"div",2),oe(3,3),P(),T(4,UMt,14,2,"div",4),T(5,ZMt,3,2,"ng-container",5),P(),T(6,YMt,3,1,"div",6),P()),2&n&&(_(4),y("ngIf","send-email"===i.verificationType),_(1),y("ngIf","enter-username"===i.verificationType),_(1),y("ngIf",i.errorMessage))},dependencies:[At,Mc,v6,_c,b3,m6,M6,C6,F8],encapsulation:2})),e})();function XMt(r,e){1&r&&(S(0,"p",17),oe(1,18),P())}function QMt(r,e){if(1&r&&(S(0,"div",19)(1,"div",20),oe(2,21),P(),S(3,"div",22),lt(4),P()()),2&r){const t=p();_(4),An(t.errorMessage.get())}}const JMt=function(){return{standalone:!0}};let eEt=(()=>{var r;class e{constructor(n){u(this,"connectedUserService",void 0),u(this,"success",!1),u(this,"errorMessage",g.empty()),u(this,"email",""),this.connectedUserService=n}resetPassword(){var n=this;return M(function*(){Ze(""!==n.email,"No email was entered, but it should not be possible to submit the form then!"),n.errorMessage=g.empty(),n.success=!1;const i=yield n.connectedUserService.sendPasswordResetEmail(n.email);i.isSuccess()?n.success=!0:n.errorMessage=g.of(i.getReason())})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(lr))}),u(e,"\u0275cmp",qe({type:r,selectors:[["app-reset-password"]],decls:17,vars:6,consts:function(){let t,n,i,s,o,a,c;return t=$localize`Password reset`,n=$localize`Email`,i=$localize`Email`,s=$localize`An email will be sent with instruction to reset your password.`,o=$localize`Reset password`,a=$localize`The email has been sent, please follow the instructions from that email.`,c=$localize`Error`,[[1,"box"],[1,"title"],t,[1,"field","is-horizontal"],[1,"field-label","is-normal"],["for","email",1,"label"],n,[1,"field-body"],[1,"field"],[1,"control"],["id","email","name","email","placeholder",i,"type","email","autofocus","","required","",1,"input",3,"ngModel","ngModelOptions","ngModelChange"],[1,"help"],s,["id","successMessage","class","help is-success",4,"ngIf"],["id","resetPasswordButton",1,"button","is-primary","is-fullwidth","block",3,"disabled","click"],o,["class","message is-danger is-fullwidth","role","alert",4,"ngIf"],["id","successMessage",1,"help","is-success"],a,["role","alert",1,"message","is-danger","is-fullwidth"],[1,"message-header"],c,["id","errorMessage",1,"message-body"]]},template:function(n,i){1&n&&(S(0,"div",0)(1,"p",1),oe(2,2),P(),S(3,"div",3)(4,"div",4)(5,"label",5),oe(6,6),P()(),S(7,"div",7)(8,"div",8)(9,"div",9)(10,"input",10),W("ngModelChange",function(o){return i.email=o}),P(),S(11,"p",11),oe(12,12),P(),T(13,XMt,2,0,"p",13),P()()()(),S(14,"button",14),W("click",function(){return i.resetPassword()}),oe(15,15),P(),T(16,QMt,5,1,"div",16),P()),2&n&&(_(10),y("ngModel",i.email)("ngModelOptions",D1(5,JMt)),_(3),y("ngIf",i.success),_(1),y("disabled",""===i.email),_(2),y("ngIf",i.errorMessage.isPresent()))},dependencies:[At,_c,b3,M6,J7,uR],encapsulation:2})),e})();function tEt(r,e){if(1&r&&(S(0,"option",13),lt(1),P()),2&r){const t=e.$implicit,n=p();y("value",t.value)("selected",t.value===n.currentTheme),_(1),O2(" ",t.name," ")}}function nEt(r,e){if(1&r&&(S(0,"option",13),lt(1),P()),2&r){const t=e.$implicit,n=p();y("value",t.value)("selected",t.value===n.currentLanguage),_(1),O2(" ",t.name," ")}}let rEt=(()=>{var r;class e{constructor(n,i){u(this,"userSettingsService",void 0),u(this,"availableLanguages",[{value:"fr",name:"Fran\xe7ais"},{value:"en",name:"English"}]),u(this,"availableThemes",[{value:"light",name:$localize`Light`},{value:"dark",name:$localize`Dark`}]),u(this,"currentTheme",void 0),u(this,"currentLanguage",void 0),this.userSettingsService=n,this.currentTheme=i.getTheme(),this.currentLanguage=this.userSettingsService.getLanguage()}changeLanguage(n){this.userSettingsService.changeLanguage(n.target.value),this.reload()}changeTheme(n){this.userSettingsService.changeTheme(n.target.value),this.reload()}reload(){window.open(window.location.href,"_self")}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(zee),B(gv))}),u(e,"\u0275cmp",qe({type:r,selectors:[["app-settings"]],decls:17,vars:2,consts:function(){let t,n,i;return t=$localize`User settings`,n=$localize`Theme`,i=$localize`Language`,[[1,"box"],[1,"title"],t,[1,"field"],["for","theme",1,"label"],n,[1,"control"],[1,"select"],["id","theme",3,"change"],[3,"value","selected",4,"ngFor","ngForOf"],["for","language",1,"label"],i,["id","language",3,"change"],[3,"value","selected"]]},template:function(n,i){1&n&&(S(0,"div",0)(1,"p",1),oe(2,2),P(),S(3,"div",3)(4,"label",4),oe(5,5),P(),S(6,"div",6)(7,"div",7)(8,"select",8),W("change",function(o){return i.changeTheme(o)}),T(9,tEt,2,3,"option",9),P()()()(),S(10,"div",3)(11,"label",10),oe(12,11),P(),S(13,"div",6)(14,"div",7)(15,"select",12),W("change",function(o){return i.changeLanguage(o)}),T(16,nEt,2,3,"option",9),P()()()()()),2&n&&(_(9),y("ngForOf",i.availableThemes),_(7),y("ngForOf",i.availableLanguages))},dependencies:[Wt,ef,tf],encapsulation:2})),e})(),iEt=(()=>{var r;class e{constructor(n,i,s,o,a,c){u(this,"route",void 0),u(this,"router",void 0),u(this,"connectedUserService",void 0),u(this,"currentGameService",void 0),u(this,"messageDisplayer",void 0),u(this,"gameService",void 0),this.route=n,this.router=i,this.connectedUserService=s,this.currentGameService=o,this.messageDisplayer=a,this.gameService=c}ngOnInit(){var n=this;return M(function*(){yield n.createGameAndRedirectOrShowError(n.extractGameFromURL())})()}extractGameFromURL(){return U.getNonNullable(this.route.snapshot.paramMap.get("compo"))}createGameAndRedirectOrShowError(n){var i=this;return M(function*(){if(Ze(i.connectedUserService.user.get().isConnected(),"User must be connected and have a username to reach this page"),!1===i.gameExists(n))return yield i.router.navigate(["/notFound",H0.NO_MATCHING_GAME(n)],{skipLocationChange:!0}),!1;const o=i.currentGameService.canUserCreate();if(o.isSuccess()){const a=yield i.gameService.createPartConfigRoomAndChat(n);return yield i.router.navigate(["/play",n,a]),!0}return i.messageDisplayer.infoMessage(o.getReason()),yield i.router.navigate(["/lobby"]),!1})()}gameExists(n){return g.ofNullable(Nu.ALL_GAMES().find(s=>s.urlName===n)).isPresent()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(xs),B(Gn),B(lr),B(ds),B(Ut),B(X5))}),u(e,"\u0275cmp",qe({type:r,selectors:[["app-online-game-creation"]],decls:2,vars:0,consts:function(){let t;return t=$localize`Creating online game, please wait, it should not take long.`,[t]},template:function(n,i){1&n&&(S(0,"p"),oe(1,0),P())},encapsulation:2})),e})();!function She(r,e,t){(function f7e(r,e,t){"string"!=typeof e&&(t=e,e=r[N1.LocaleId]),e=e.toLowerCase().replace(/_/g,"-"),x8[e]=r,t&&(x8[e][N1.ExtraData]=t)})(r,e,t)}(Jye);const sEt=[{path:"login",component:Fvt},{path:"lobby",component:fR,canActivate:[Ru]},{path:"account",component:sCt,canActivate:[Ru]},{path:"settings",component:rEt},{path:"register",component:aMt,canActivate:[GMt]},{path:"reset-password",component:eEt},{path:"notFound/:message",component:p4e},{path:"nextGameLoading",component:uMt,canActivate:[Ru]},{path:"verify-account",component:KMt,canActivate:[$Mt]},{path:"play",component:h4e,canActivate:[Ru,ER]},{path:"play/:compo",component:iEt,canActivate:[Ru,ER]},{path:"play/:compo/:id",component:pR,canActivate:[Ru,ER]},{path:"local",component:cMt},{path:"local/:compo",component:mR},{path:"tutorial",component:lMt},{path:"tutorial/:compo",component:_R},{path:"",component:wvt},{path:"demo",component:zvt},{path:"**",component:p4e}];class SR{static app(){return function ZNe(r,...e){return{ngModule:jNe,providers:[{provide:hN,useFactory:qNe(r),multi:!0,deps:[c1,ti,fN,...e]}]}}(()=>YNe(Jd_firebaseConfig))}static firestore(){return function KLe(r,...e){return{ngModule:YLe,providers:[{provide:$k,useFactory:qLe(r),multi:!0,deps:[c1,ti,fN,dN,[new rs,ZJ],[new rs,LN],...e]}]}}(()=>{const e=rRe();e.toJSON();return e})}static auth(){return function LLe(r,...e){return{ngModule:xLe,providers:[{provide:Fk,useFactory:NLe(r),multi:!0,deps:[c1,ti,fN,dN,[new rs,LN],...e]}]}}(()=>{const e=DLe();return e})}}let oEt=(()=>{var r;class e{}return r=e,u(e,"\u0275fac",function(n){return new(n||r)}),u(e,"\u0275mod",Ei({type:r,bootstrap:[x7t]})),u(e,"\u0275inj",X2({providers:[lr,X5,Wk,ad,Y5,Z5,gv,{provide:gc,useValue:cd.getLocale()}],imports:[SR.app(),SR.firestore(),SR.auth(),eB,Ome,Yve.forRoot(sEt,{useHash:!1}),tme,eme,Xye,YWe]})),e})();Ty(Ms,function(){return[Ft,Wt,At,$l,Gl,Qa]},[]),Ty(Fn,function(){return[Ft,Wt,At,Qd]},[]);var aEt=So(522);function v4e(){Wpe().bootstrapModule(oEt).catch(r=>console.error(r))}const C4e=cd.getLocale();"en"!==C4e?fetch("/assets/"+C4e+".json").then(r=>r.ok?r.json():{locale:"en",translations:{}}).then(r=>{(0,aEt.XJ)(r.translations),$localize.locale=r.locale,v4e()}).catch(function(r){console.log(r)}):v4e()},1:function(zu,G0){!function(So){"use strict";function Cn(ht,st){var zt=Object.keys(ht);if(Object.getOwnPropertySymbols){var xn=Object.getOwnPropertySymbols(ht);st&&(xn=xn.filter(function(xr){return Object.getOwnPropertyDescriptor(ht,xr).enumerable})),zt.push.apply(zt,xn)}return zt}function Po(ht){for(var st,zt=1;zt<arguments.length;zt++)st=null==arguments[zt]?{}:arguments[zt],zt%2?Cn(Object(st),!0).forEach(function(xn){Wl(ht,xn,st[xn])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ht,Object.getOwnPropertyDescriptors(st)):Cn(Object(st)).forEach(function(xn){Object.defineProperty(ht,xn,Object.getOwnPropertyDescriptor(st,xn))});return ht}function s3(ht,st){if(!(ht instanceof st))throw new TypeError("Cannot call a class as a function")}function o3(ht,st){for(var zt,xn=0;xn<st.length;xn++)(zt=st[xn]).enumerable=zt.enumerable||!1,zt.configurable=!0,"value"in zt&&(zt.writable=!0),Object.defineProperty(ht,zt.key,zt)}function yn(ht,st,zt){return st&&o3(ht.prototype,st),zt&&o3(ht,zt),ht}function Wl(ht,st,zt){return st in ht?Object.defineProperty(ht,st,{value:zt,enumerable:!0,configurable:!0,writable:!0}):ht[st]=zt,ht}function a3(){var ht;return null!==(ht=B0)&&void 0!==ht?ht:document}var ql={duration:2e3,position:"top-right",closeOnClick:!0,opacity:1,single:!1,offsetTop:0,offsetBottom:0,offsetLeft:0,offsetRight:0,extraClasses:""},Es=Po({},ql),To={},B0=null,Du=function(ht,st,zt,xn,xr){return"top-left"===ht?"left:".concat(xn,";top:").concat(st,";text-align:left;align-items:flex-start;"):"top-right"===ht?"right:".concat(xr,";top:").concat(st,";text-align:right;align-items:flex-end;"):"top-center"===ht?"top:".concat(st,";left:0;right:0;text-align:center;align-items:center;"):"bottom-left"===ht?"left:".concat(xn,";bottom:").concat(zt,";text-align:left;align-items:flex-start;"):"bottom-right"===ht?"right:".concat(xr,";bottom:").concat(zt,";text-align:right;align-items:flex-end;"):"bottom-center"===ht?"bottom:".concat(zt,";left:0;right:0;text-align:center;align-items:center;"):"center"===ht?"top:0;left:0;right:0;bottom:0;flex-flow:column;justify-content:center;align-items:center;":void 0},jl=function(){function ht(st){var zt=this;s3(this,ht),this.element=a3().createElement("div"),this.opacity=st.opacity,this.type=st.type,this.animate=st.animate,this.dismissible=st.dismissible,this.closeOnClick=st.closeOnClick,this.message=st.message,this.duration=st.duration,this.pauseOnHover=st.pauseOnHover,this.offsetTop=st.offsetTop,this.offsetBottom=st.offsetBottom,this.offsetLeft=st.offsetLeft,this.offsetRight=st.offsetRight,this.extraClasses=st.extraClasses;var xn="width:auto;pointer-events:auto;display:inline-flex;white-space:pre-wrap;opacity:".concat(this.opacity,";"),xr=["notification",this.extraClasses];if(this.type&&xr.push(this.type),this.animate&&this.animate.in){var l3="animate__".concat(this.animate.in),Mi=this.animate.speed?"animate__".concat(this.animate.speed):"animate__faster";xr.push("animate__animated ".concat(l3," ").concat(Mi)),this.onAnimationEnd(function(){return zt.element.classList.remove(l3)})}if(this.element.className=xr.join(" "),this.dismissible){var Y2=a3().createElement("button");Y2.className="delete",Y2.addEventListener("click",function(){zt.destroy()}),this.element.insertAdjacentElement("afterbegin",Y2)}else xn+="padding: 1.25rem 1.5rem";this.closeOnClick&&this.element.addEventListener("click",function(){zt.destroy()}),this.element.setAttribute("style",xn),"string"==typeof this.message?this.element.insertAdjacentHTML("beforeend",this.message):this.element.appendChild(this.message);var Zl=new ua(function(){zt.destroy()},this.duration);this.pauseOnHover&&(this.element.addEventListener("mouseover",function(){Zl.pause()}),this.element.addEventListener("mouseout",function(){Zl.resume()}))}return yn(ht,[{key:"destroy",value:function(){var st=this;this.animate&&this.animate.out?(this.element.classList.add("animate__".concat(this.animate.out)),this.onAnimationEnd(function(){st.removeParent(st.element.parentNode),st.element.remove(),delete To.position})):(this.removeParent(this.element.parentNode),this.element.remove(),delete To.position)}},{key:"removeParent",value:function(st){st&&1>=st.children.length&&st.remove()}},{key:"onAnimationEnd",value:function(){var st=0<arguments.length&&void 0!==arguments[0]?arguments[0]:function(){},zt={animation:"animationend",OAnimation:"oAnimationEnd",MozAnimation:"mozAnimationEnd",WebkitAnimation:"webkitAnimationEnd"};for(var xn in zt)if(void 0!==this.element.style[xn]){this.element.addEventListener(zt[xn],function(){return st()});break}}}]),ht}(),ua=function(){function ht(st,zt){s3(this,ht),this.remaining=zt,this.callback=st,this.resume()}return yn(ht,[{key:"pause",value:function(){typeof document>"u"||(window.clearTimeout(this.timer),this.remaining-=new Date-this.start)}},{key:"resume",value:function(){typeof document>"u"||(this.start=new Date,window.clearTimeout(this.timer),this.timer=window.setTimeout(this.callback,this.remaining))}}]),ht}();So.resetDefaults=function(){Es=Po({},ql)},So.setDefaults=function(ht){Es=Po(Po({},ql),ht)},So.setDoc=function Ja(ht){for(var st in To)To[st].remove();To={},B0=ht},So.toast=function S4(ht){if(!ht.message)throw new Error("message is required");var st=Po(Po({},Es),ht),zt=new jl(st),xn=function c3(ht,st,zt,xn,xr,l3){if(To.position)return To.position;var Mi=a3().createElement("div");return Mi.setAttribute("style","width:100%;z-index:99999;position:fixed;pointer-events:none;display:flex;flex-direction:column;padding:15px;"+Du(st,zt,xn,xr,l3)),ht.appendChild(Mi),To.position=Mi,Mi}(st.appendTo||a3().body,st.position||Es.position,st.offsetTop||Es.offsetTop,st.offsetBottom||Es.offsetBottom,st.offsetLeft||Es.offsetLeft,st.offsetRight||Es.offsetRight);if(st.single)for(var xr=xn.lastElementChild;xr;)xn.removeChild(xr),xr=xn.lastElementChild;xn.appendChild(zt.element)},Object.defineProperty(So,"__esModule",{value:!0})}(G0)},522:(zu,G0,So)=>{"use strict";So.d(G0,{XJ:()=>$u,pQ:()=>Bu});const Cn=":",Po="|",s3="@@",o3="\u241f";class yn{static zero(){return new yn([0])}static one(){return new yn([1])}constructor(re){this.digits=re}clone(){return new yn(this.digits.slice())}add(re){const me=this.clone();return me.addToSelf(re),me}addToSelf(re){const me=Math.max(this.digits.length,re.digits.length);let Se=0;for(let Ke=0;Ke<me;Ke++){let ot=Se;Ke<this.digits.length&&(ot+=this.digits[Ke]),Ke<re.digits.length&&(ot+=re.digits[Ke]),ot>=10?(this.digits[Ke]=ot-10,Se=1):(this.digits[Ke]=ot,Se=0)}Se>0&&(this.digits[me]=1)}toString(){let re="";for(let me=this.digits.length-1;me>=0;me--)re+=this.digits[me];return re}}class Wl{constructor(re){this.powerOfTwos=[re]}getValue(){return this.powerOfTwos[0]}multiplyBy(re){const me=yn.zero();return this.multiplyByAndAddTo(re,me),me}multiplyByAndAddTo(re,me){for(let Se=0;0!==re;re>>>=1,Se++)if(1&re){const Ke=this.getMultipliedByPowerOfTwo(Se);me.addToSelf(Ke)}}getMultipliedByPowerOfTwo(re){for(let me=this.powerOfTwos.length;me<=re;me++){const Se=this.powerOfTwos[me-1];this.powerOfTwos[me]=Se.add(Se)}return this.powerOfTwos[re]}}class a3{constructor(re){this.base=re,this.exponents=[new Wl(yn.one())]}toThePowerOf(re){for(let me=this.exponents.length;me<=re;me++){const Se=this.exponents[me-1].multiplyBy(this.base);this.exponents[me]=new Wl(Se)}return this.exponents[re]}}let c3;function zt(ae){c3??=new TextEncoder;const re=c3.encode(ae),me=new DataView(re.buffer,re.byteOffset,re.byteLength);let Se=xr(me,re.length,0),Ke=xr(me,re.length,102072);return 0==Se&&(0==Ke||1==Ke)&&(Se^=319790063,Ke^=-1801410264),[Se,Ke]}function xr(ae,re,me){let Se=2654435769,Ke=2654435769,ot=0;const s2=re-12;for(;ot<=s2;ot+=12){Se+=ae.getUint32(ot,!0),Ke+=ae.getUint32(ot+4,!0);const n1=l3(Se,Ke,me+=ae.getUint32(ot+8,!0));Se=n1[0],Ke=n1[1],me=n1[2]}const t1=re-ot;return me+=re,t1>=4?(Se+=ae.getUint32(ot,!0),ot+=4,t1>=8?(Ke+=ae.getUint32(ot,!0),ot+=4,t1>=9&&(me+=ae.getUint8(ot++)<<8),t1>=10&&(me+=ae.getUint8(ot++)<<16),11===t1&&(me+=ae.getUint8(ot++)<<24)):(t1>=5&&(Ke+=ae.getUint8(ot++)),t1>=6&&(Ke+=ae.getUint8(ot++)<<8),7===t1&&(Ke+=ae.getUint8(ot++)<<16))):(t1>=1&&(Se+=ae.getUint8(ot++)),t1>=2&&(Se+=ae.getUint8(ot++)<<8),3===t1&&(Se+=ae.getUint8(ot++)<<16)),l3(Se,Ke,me)[2]}function l3(ae,re,me){return ae-=re,ae-=me,re-=me,re-=ae^=me>>>13,me-=ae,me-=re^=ae<<8,ae-=re,ae-=me^=re>>>13,re-=me,re-=ae^=me>>>12,me-=ae,me-=re^=ae<<16,ae-=re,ae-=me^=re>>>5,re-=me,re-=ae^=me>>>3,me-=ae,me-=re^=ae<<10,[ae,re,me^=re>>>15]}function Y2(ae,re){return Zl(ae,re)[1]}function Zl(ae,re){const me=(65535&ae)+(65535&re),Se=(ae>>>16)+(re>>>16)+(me>>>16);return[Se>>>16,Se<<16|65535&me]}const b1=new a3(256);function JC(ae,re,me,Se,Ke=[]){const ot={},s2={},t1={},n1=function ey(ae,re){const{text:me,block:Se}=Ss(ae,re);if(void 0===Se)return{text:me};{const[Ke,...ot]=Se.split(o3),[s2,t1]=Ke.split(s3,2);let[n1,P2]=s2.split(Po,2);return void 0===P2&&(P2=n1,n1=void 0),""===P2&&(P2=void 0),{text:me,meaning:n1,description:P2,customId:t1,legacyIds:ot}}}(ae[0],ae.raw[0]),P2=[n1.text],P4=[];let Yl=n1.text;for(let Zs=1;Zs<ae.length;Zs++){const{messagePart:Kl,placeholderName:Kr=sh(Zs),associatedMessageId:Xl}=ty(ae[Zs],ae.raw[Zs]);Yl+=`{$${Kr}}${Kl}`,void 0!==re&&(ot[Kr]=re[Zs-1],s2[Kr]=Ke[Zs-1]),P4.push(Kr),void 0!==Xl&&(t1[Kr]=Xl),P2.push(Kl)}const js=n1.customId||function xn(ae,re=""){let me=zt(ae);if(re){const ot=zt(re);me=function Hu(ae,re){const me=ae[0],Ke=re[0],s2=Zl(ae[1],re[1]),t1=s2[0],n1=s2[1];return[Y2(Y2(me,Ke),t1),n1]}(function Fu(ae,re){const me=ae[0],Se=ae[1];return[me<<re|Se>>>32-re,Se<<re|me>>>32-re]}(me,1),ot)}return function ih(ae,re){const me=b1.toThePowerOf(0).multiplyBy(re);return b1.toThePowerOf(4).multiplyByAndAddTo(ae,me),me.toString()}(2147483647&me[0],me[1])}(Yl,n1.meaning||""),W0=n1.legacyIds?n1.legacyIds.filter(Zs=>Zs!==js):[];return{id:js,legacyIds:W0,substitutions:ot,substitutionLocations:s2,text:Yl,customId:n1.customId,meaning:n1.meaning||"",description:n1.description||"",messageParts:P2,messagePartLocations:Se,placeholderNames:P4,associatedMessageIds:t1,location:me}}function ty(ae,re){const{text:me,block:Se}=Ss(ae,re);if(void 0===Se)return{messagePart:me};{const[Ke,ot]=Se.split(s3);return{messagePart:me,placeholderName:Ke,associatedMessageId:ot}}}function Ss(ae,re){if(re.charAt(0)!==Cn)return{text:ae};{const me=Xi(ae,re);return{block:ae.substring(1,me),text:ae.substring(me+1)}}}function sh(ae){return 1===ae?"PH":"PH_"+(ae-1)}function Xi(ae,re){for(let me=1,Se=1;me<ae.length;me++,Se++)if("\\"===re[Se])Se++;else if(ae[me]===Cn)return me;throw new Error(`Unterminated $localize metadata block in "${re}".`)}class oh extends Error{constructor(re){super(`No translation found for ${ah(re)}.`),this.parsedMessage=re,this.type="MissingTranslationError"}}function U0(ae,re){return Object.defineProperty(ae,"raw",{value:re}),ae}function ah(ae){const re=ae.meaning&&` - "${ae.meaning}"`,me=ae.legacyIds&&ae.legacyIds.length>0?` [${ae.legacyIds.map(Se=>`"${Se}"`).join(", ")}]`:"";return`"${ae.id}"${me} ("${ae.text}"${re})`}function $u(ae){$localize.translate||($localize.translate=ry),$localize.TRANSLATIONS||($localize.TRANSLATIONS={}),Object.keys(ae).forEach(re=>{$localize.TRANSLATIONS[re]=function ny(ae){const re=ae.split(/{\$([^}]*)}/),me=[re[0]],Se=[];for(let ot=1;ot<re.length-1;ot+=2)Se.push(re[ot]),me.push(`${re[ot+1]}`);const Ke=me.map(ot=>ot.charAt(0)===Cn?"\\"+ot:ot);return{text:ae,messageParts:U0(me,Ke),placeholderNames:Se}}(ae[re])})}function ry(ae,re){try{return function vr(ae,re,me){const Se=JC(re,me);let Ke=ae[Se.id];if(void 0!==Se.legacyIds)for(let ot=0;ot<Se.legacyIds.length&&void 0===Ke;ot++)Ke=ae[Se.legacyIds[ot]];if(void 0===Ke)throw new oh(Se);return[Ke.messageParts,Ke.placeholderNames.map(ot=>{if(Se.substitutions.hasOwnProperty(ot))return Se.substitutions[ot];throw new Error(`There is a placeholder name mismatch with the translation provided for the message ${ah(Se)}.\nThe translation contains a placeholder with name ${ot}, which does not exist in the message.`)})]}($localize.TRANSLATIONS,ae,re)}catch(me){return console.warn(me.message),[ae,re]}}const Bu=function(ae,...re){if(Bu.translate){const Se=Bu.translate(ae,re);ae=Se[0],re=Se[1]}let me=iy(ae[0],ae.raw[0]);for(let Se=1;Se<ae.length;Se++)me+=re[Se-1]+iy(ae[Se],ae.raw[Se]);return me},TR=":";function iy(ae,re){return re.charAt(0)===TR?ae.substring(Xi(ae,re)+1):ae}}},zu=>{zu(zu.s=2052)}]);