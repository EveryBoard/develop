(self.webpackChunkeveryboard=self.webpackChunkeveryboard||[]).push([[179],{583:(U9,A5,oc)=>{"use strict";function an(n){return"function"==typeof n}function as(n){const e=n(r=>{Error.call(r),r.stack=(new Error).stack});return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e}const j3=as(n=>function(e){n(this),this.message=e?`${e.length} errors occurred during unsubscription:\n${e.map((r,s)=>`${s+1}) ${r.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=e});function Qc(n,t){if(n){const e=n.indexOf(t);0<=e&&n.splice(e,1)}}class Z1{constructor(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let t;if(!this.closed){this.closed=!0;const{_parentage:e}=this;if(e)if(this._parentage=null,Array.isArray(e))for(const i of e)i.remove(this);else e.remove(this);const{initialTeardown:r}=this;if(an(r))try{r()}catch(i){t=i instanceof j3?i.errors:[i]}const{_finalizers:s}=this;if(s){this._finalizers=null;for(const i of s)try{pn(i)}catch(o){t=t??[],o instanceof j3?t=[...t,...o.errors]:t.push(o)}}if(t)throw new j3(t)}}add(t){var e;if(t&&t!==this)if(this.closed)pn(t);else{if(t instanceof Z1){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(e=this._finalizers)&&void 0!==e?e:[]).push(t)}}_hasParent(t){const{_parentage:e}=this;return e===t||Array.isArray(e)&&e.includes(t)}_addParent(t){const{_parentage:e}=this;this._parentage=Array.isArray(e)?(e.push(t),e):e?[e,t]:t}_removeParent(t){const{_parentage:e}=this;e===t?this._parentage=null:Array.isArray(e)&&Qc(e,t)}remove(t){const{_finalizers:e}=this;e&&Qc(e,t),t instanceof Z1&&t._removeParent(this)}}Z1.EMPTY=(()=>{const n=new Z1;return n.closed=!0,n})();const g8=Z1.EMPTY;function Jc(n){return n instanceof Z1||n&&"closed"in n&&an(n.remove)&&an(n.add)&&an(n.unsubscribe)}function pn(n){an(n)?n():n.unsubscribe()}const ac={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},e3={setTimeout(n,t,...e){const{delegate:r}=e3;return r?.setTimeout?r.setTimeout(n,t,...e):setTimeout(n,t,...e)},clearTimeout(n){const{delegate:t}=e3;return(t?.clearTimeout||clearTimeout)(n)},delegate:void 0};function Z3(n){e3.setTimeout(()=>{const{onUnhandledError:t}=ac;if(!t)throw n;t(n)})}function lo(){}const ni=m8("C",void 0,void 0);function m8(n,t,e){return{kind:n,value:t,error:e}}let t3=null;function dt(n){if(ac.useDeprecatedSynchronousErrorHandling){const t=!t3;if(t&&(t3={errorThrown:!1,error:null}),n(),t){const{errorThrown:e,error:r}=t3;if(t3=null,e)throw r}}else n()}class tn extends Z1{constructor(t){super(),this.isStopped=!1,t?(this.destination=t,Jc(t)&&t.add(this)):this.destination=x5}static create(t,e,r){return new ur(t,e,r)}next(t){this.isStopped?W9(function G9(n){return m8("N",n,void 0)}(t),this):this._next(t)}error(t){this.isStopped?W9(function K4(n){return m8("E",void 0,n)}(t),this):(this.isStopped=!0,this._error(t))}complete(){this.isStopped?W9(ni,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(t){this.destination.next(t)}_error(t){try{this.destination.error(t)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const a1=Function.prototype.bind;function Vs(n,t){return a1.call(n,t)}class Nn{constructor(t){this.partialObserver=t}next(t){const{partialObserver:e}=this;if(e.next)try{e.next(t)}catch(r){Y3(r)}}error(t){const{partialObserver:e}=this;if(e.error)try{e.error(t)}catch(r){Y3(r)}else Y3(t)}complete(){const{partialObserver:t}=this;if(t.complete)try{t.complete()}catch(e){Y3(e)}}}class ur extends tn{constructor(t,e,r){let s;if(super(),an(t)||!t)s={next:t??void 0,error:e??void 0,complete:r??void 0};else{let i;this&&ac.useDeprecatedNextContext?(i=Object.create(t),i.unsubscribe=()=>this.unsubscribe(),s={next:t.next&&Vs(t.next,i),error:t.error&&Vs(t.error,i),complete:t.complete&&Vs(t.complete,i)}):s=t}this.destination=new Nn(s)}}function Y3(n){ac.useDeprecatedSynchronousErrorHandling?function ct(n){ac.useDeprecatedSynchronousErrorHandling&&t3&&(t3.errorThrown=!0,t3.error=n)}(n):Z3(n)}function W9(n,t){const{onStoppedNotification:e}=ac;e&&e3.setTimeout(()=>e(n,t))}const x5={closed:!0,next:lo,error:function I5(n){throw n},complete:lo},r_="function"==typeof Symbol&&Symbol.observable||"@@observable";function X4(n){return n}function s_(n){return 0===n.length?X4:1===n.length?n[0]:function(e){return n.reduce((r,s)=>s(r),e)}}let Er=(()=>{class n{constructor(e){e&&(this._subscribe=e)}lift(e){const r=new n;return r.source=this,r.operator=e,r}subscribe(e,r,s){const i=function k5(n){return n&&n instanceof tn||function nT(n){return n&&an(n.next)&&an(n.error)&&an(n.complete)}(n)&&Jc(n)}(e)?e:new ur(e,r,s);return dt(()=>{const{operator:o,source:c}=this;i.add(o?o.call(i,c):c?this._subscribe(i):this._trySubscribe(i))}),i}_trySubscribe(e){try{return this._subscribe(e)}catch(r){e.error(r)}}forEach(e,r){return new(r=q9(r))((s,i)=>{const o=new ur({next:c=>{try{e(c)}catch(u){i(u),o.unsubscribe()}},error:i,complete:s});this.subscribe(o)})}_subscribe(e){var r;return null===(r=this.source)||void 0===r?void 0:r.subscribe(e)}[r_](){return this}pipe(...e){return s_(e)(this)}toPromise(e){return new(e=q9(e))((r,s)=>{let i;this.subscribe(o=>i=o,o=>s(o),()=>r(i))})}}return n.create=t=>new n(t),n})();function q9(n){var t;return null!==(t=n??ac.Promise)&&void 0!==t?t:Promise}const QH=as(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let F2=(()=>{class n extends Er{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(e){const r=new j9(this,this);return r.operator=e,r}_throwIfClosed(){if(this.closed)throw new QH}next(e){dt(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const r of this.currentObservers)r.next(e)}})}error(e){dt(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=e;const{observers:r}=this;for(;r.length;)r.shift().error(e)}})}complete(){dt(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:e}=this;for(;e.length;)e.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0}_trySubscribe(e){return this._throwIfClosed(),super._trySubscribe(e)}_subscribe(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)}_innerSubscribe(e){const{hasError:r,isStopped:s,observers:i}=this;return r||s?g8:(this.currentObservers=null,i.push(e),new Z1(()=>{this.currentObservers=null,Qc(i,e)}))}_checkFinalizedStatuses(e){const{hasError:r,thrownError:s,isStopped:i}=this;r?e.error(s):i&&e.complete()}asObservable(){const e=new Er;return e.source=this,e}}return n.create=(t,e)=>new j9(t,e),n})();class j9 extends F2{constructor(t,e){super(),this.destination=t,this.source=e}next(t){var e,r;null===(r=null===(e=this.destination)||void 0===e?void 0:e.next)||void 0===r||r.call(e,t)}error(t){var e,r;null===(r=null===(e=this.destination)||void 0===e?void 0:e.error)||void 0===r||r.call(e,t)}complete(){var t,e;null===(e=null===(t=this.destination)||void 0===t?void 0:t.complete)||void 0===e||e.call(t)}_subscribe(t){var e,r;return null!==(r=null===(e=this.source)||void 0===e?void 0:e.subscribe(t))&&void 0!==r?r:g8}}function i_(n){return an(n?.lift)}function gr(n){return t=>{if(i_(t))return t.lift(function(e){try{return n(e,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function cs(n,t,e,r,s){return new rT(n,t,e,r,s)}class rT extends tn{constructor(t,e,r,s,i,o){super(t),this.onFinalize=i,this.shouldUnsubscribe=o,this._next=e?function(c){try{e(c)}catch(u){t.error(u)}}:super._next,this._error=s?function(c){try{s(c)}catch(u){t.error(u)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(c){t.error(c)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:e}=this;super.unsubscribe(),!e&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}}}function gn(n,t){return gr((e,r)=>{let s=0;e.subscribe(cs(r,i=>{r.next(n.call(t,i,s++))}))})}function R5(n,t){var e={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(e[r]=n[r]);if(null!=n&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(r=Object.getOwnPropertySymbols(n);s<r.length;s++)t.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(e[r[s]]=n[r[s]])}return e}function qr(n){return this instanceof qr?(this.v=n,this):new qr(n)}function Xi(n,t,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s,r=e.apply(n,t||[]),i=[];return s={},o("next"),o("throw"),o("return"),s[Symbol.asyncIterator]=function(){return this},s;function o(C){r[C]&&(s[C]=function(w){return new Promise(function(I,H){i.push([C,w,I,H])>1||c(C,w)})})}function c(C,w){try{!function u(C){C.value instanceof qr?Promise.resolve(C.value.v).then(h,p):m(i[0][2],C)}(r[C](w))}catch(I){m(i[0][3],I)}}function h(C){c("next",C)}function p(C){c("throw",C)}function m(C,w){C(w),i.shift(),i.length&&c(i[0][0],i[0][1])}}function uT(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,t=n[Symbol.asyncIterator];return t?t.call(n):(n=function c_(n){var t="function"==typeof Symbol&&Symbol.iterator,e=t&&n[t],r=0;if(e)return e.call(n);if(n&&"number"==typeof n.length)return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(n),e={},r("next"),r("throw"),r("return"),e[Symbol.asyncIterator]=function(){return this},e);function r(i){e[i]=n[i]&&function(o){return new Promise(function(c,u){!function s(i,o,c,u){Promise.resolve(u).then(function(h){i({value:h,done:c})},o)}(c,u,(o=n[i](o)).done,o.value)})}}}const h_=n=>n&&"number"==typeof n.length&&"function"!=typeof n;function d_(n){return an(n?.then)}function K9(n){return an(n[r_])}function p_(n){return Symbol.asyncIterator&&an(n?.[Symbol.asyncIterator])}function cc(n){return new TypeError(`You provided ${null!==n&&"object"==typeof n?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const A1=function _8(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function lc(n){return an(n?.[A1])}function Ma(n){return Xi(this,arguments,function*(){const e=n.getReader();try{for(;;){const{value:r,done:s}=yield qr(e.read());if(s)return yield qr(void 0);yield yield qr(r)}}finally{e.releaseLock()}})}function g_(n){return an(n?.getReader)}function uo(n){if(n instanceof Er)return n;if(null!=n){if(K9(n))return function Q4(n){return new Er(t=>{const e=n[r_]();if(an(e.subscribe))return e.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(n);if(h_(n))return function Qi(n){return new Er(t=>{for(let e=0;e<n.length&&!t.closed;e++)t.next(n[e]);t.complete()})}(n);if(d_(n))return function m_(n){return new Er(t=>{n.then(e=>{t.closed||(t.next(e),t.complete())},e=>t.error(e)).then(null,Z3)})}(n);if(p_(n))return J4(n);if(lc(n))return function fT(n){return new Er(t=>{for(const e of n)if(t.next(e),t.closed)return;t.complete()})}(n);if(g_(n))return function X9(n){return J4(Ma(n))}(n)}throw cc(n)}function J4(n){return new Er(t=>{(function hT(n,t){var e,r,s,i;return function oT(n,t,e,r){return new(e||(e=Promise))(function(i,o){function c(p){try{h(r.next(p))}catch(m){o(m)}}function u(p){try{h(r.throw(p))}catch(m){o(m)}}function h(p){p.done?i(p.value):function s(i){return i instanceof e?i:new e(function(o){o(i)})}(p.value).then(c,u)}h((r=r.apply(n,t||[])).next())})}(this,void 0,void 0,function*(){try{for(e=uT(n);!(r=yield e.next()).done;)if(t.next(r.value),t.closed)return}catch(o){s={error:o}}finally{try{r&&!r.done&&(i=e.return)&&(yield i.call(e))}finally{if(s)throw s.error}}t.complete()})})(n,t).catch(e=>t.error(e))})}function Hs(n,t,e,r=0,s=!1){const i=t.schedule(function(){e(),s?n.add(this.schedule(null,r)):this.unsubscribe()},r);if(n.add(i),!s)return i}function ze(n,t,e=1/0){return an(t)?ze((r,s)=>gn((i,o)=>t(r,i,s,o))(uo(n(r,s))),e):("number"==typeof t&&(e=t),gr((r,s)=>function Uo(n,t,e,r,s,i,o,c){const u=[];let h=0,p=0,m=!1;const C=()=>{m&&!u.length&&!h&&t.complete()},w=H=>h<r?I(H):u.push(H),I=H=>{i&&t.next(H),h++;let K=!1;uo(e(H,p++)).subscribe(cs(t,ie=>{s?.(ie),i?w(ie):t.next(ie)},()=>{K=!0},void 0,()=>{if(K)try{for(h--;u.length&&h<r;){const ie=u.shift();o?Hs(t,o,()=>I(ie)):I(ie)}C()}catch(ie){t.error(ie)}}))};return n.subscribe(cs(t,w,()=>{m=!0,C()})),()=>{c?.()}}(r,s,n,e)))}function el(n=1/0){return ze(X4,n)}const uc=new Er(n=>n.complete());function tl(n){return n[n.length-1]}function Qt(n){return an(tl(n))?n.pop():void 0}function K3(n){return function S6(n){return n&&an(n.schedule)}(tl(n))?n.pop():void 0}function nl(n,t=0){return gr((e,r)=>{e.subscribe(cs(r,s=>Hs(r,n,()=>r.next(s),t),()=>Hs(r,n,()=>r.complete(),t),s=>Hs(r,n,()=>r.error(s),t)))})}function fc(n,t=0){return gr((e,r)=>{r.add(n.schedule(()=>e.subscribe(r),t))})}function V5(n,t){if(!n)throw new Error("Iterable cannot be null");return new Er(e=>{Hs(e,t,()=>{const r=n[Symbol.asyncIterator]();Hs(e,t,()=>{r.next().then(s=>{s.done?e.complete():e.next(s.value)})},0,!0)})})}function ls(n,t){return t?function v8(n,t){if(null!=n){if(K9(n))return function z5(n,t){return uo(n).pipe(fc(t),nl(t))}(n,t);if(h_(n))return function Wo(n,t){return new Er(e=>{let r=0;return t.schedule(function(){r===n.length?e.complete():(e.next(n[r++]),e.closed||this.schedule())})})}(n,t);if(d_(n))return function P6(n,t){return uo(n).pipe(fc(t),nl(t))}(n,t);if(p_(n))return V5(n,t);if(lc(n))return function Q9(n,t){return new Er(e=>{let r;return Hs(e,t,()=>{r=n[A1](),Hs(e,t,()=>{let s,i;try{({value:s,done:i}=r.next())}catch(o){return void e.error(o)}i?e.complete():e.next(s)},0,!0)}),()=>an(r?.return)&&r.return()})}(n,t);if(g_(n))return function T6(n,t){return V5(Ma(n),t)}(n,t)}throw cc(n)}(n,t):uo(n)}function H5(n,t,...e){if(!0===t)return void n();if(!1===t)return;const r=new ur({next:()=>{r.unsubscribe(),n()}});return uo(t(...e)).subscribe(r)}function E1(n){for(let t in n)if(n[t]===E1)return t;throw Error("Could not find renamed property on target object.")}function J9(n,t){for(const e in t)t.hasOwnProperty(e)&&!n.hasOwnProperty(e)&&(n[e]=t[e])}function Y1(n){if("string"==typeof n)return n;if(Array.isArray(n))return"["+n.map(Y1).join(", ")+"]";if(null==n)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;const t=n.toString();if(null==t)return""+t;const e=t.indexOf("\n");return-1===e?t:t.substring(0,e)}function C8(n,t){return null==n||""===n?null===t?"":t:null==t||""===t?n:n+" "+t}const v_=E1({__forward_ref__:E1});function M1(n){return n.__forward_ref__=M1,n.toString=function(){return Y1(this())},n}function nn(n){return w6(n)?n():n}function w6(n){return"function"==typeof n&&n.hasOwnProperty(v_)&&n.__forward_ref__===M1}class Ae extends Error{constructor(t,e){super(function n3(n,t){return`NG0${Math.abs(n)}${t?": "+t.trim():""}`}(t,e)),this.code=t}}function rn(n){return"string"==typeof n?n:null==n?"":String(n)}function O6(n,t){throw new Ae(-201,!1)}function S1(n,t,e,r){throw new Error(`ASSERTION ERROR: ${n}`+(null==r?"":` [Expected=> ${e} ${r} ${t} <=Actual]`))}function nt(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function jr(n){return{providers:n.providers||[],imports:n.imports||[]}}function kn(n){return M_(n,N6)||M_(n,rh)}function M_(n,t){return n.hasOwnProperty(t)?n[t]:null}function M8(n){return n&&(n.hasOwnProperty(Ee)||n.hasOwnProperty(sh))?n[Ee]:null}const N6=E1({\u0275prov:E1}),Ee=E1({\u0275inj:E1}),rh=E1({ngInjectableDef:E1}),sh=E1({ngInjectorDef:E1});var jt=(()=>((jt=jt||{})[jt.Default=0]="Default",jt[jt.Host=1]="Host",jt[jt.Self=2]="Self",jt[jt.SkipSelf=4]="SkipSelf",jt[jt.Optional=8]="Optional",jt))();let ih;function qo(n){const t=ih;return ih=n,t}function oh(n,t,e){const r=kn(n);return r&&"root"==r.providedIn?void 0===r.value?r.value=r.factory():r.value:e&jt.Optional?null:void 0!==t?t:void O6(Y1(n))}function J3(n){return{toString:n}.toString()}var U2=(()=>((U2=U2||{})[U2.OnPush=0]="OnPush",U2[U2.Default=1]="Default",U2))(),z1=(()=>{return(n=z1||(z1={}))[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",z1;var n})();const er=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),Y={},C1=[],U5=E1({\u0275cmp:E1}),ah=E1({\u0275dir:E1}),ch=E1({\u0275pipe:E1}),S8=E1({\u0275mod:E1}),r3=E1({\u0275fac:E1}),s3=E1({__NG_ELEMENT_ID__:E1});let vT=0;function gt(n){return J3(()=>{const e=!0===n.standalone,r={},s={type:n.type,providersResolver:null,decls:n.decls,vars:n.vars,factory:null,template:n.template||null,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:r,inputs:null,outputs:null,exportAs:n.exportAs||null,onPush:n.changeDetection===U2.OnPush,directiveDefs:null,pipeDefs:null,standalone:e,dependencies:e&&n.dependencies||null,getStandaloneInjector:null,selectors:n.selectors||C1,viewQuery:n.viewQuery||null,features:n.features||null,data:n.data||{},encapsulation:n.encapsulation||z1.Emulated,id:"c"+vT++,styles:n.styles||C1,_:null,setInput:null,schemas:n.schemas||null,tView:null},i=n.dependencies,o=n.features;return s.inputs=uh(n.inputs,r),s.outputs=uh(n.outputs),o&&o.forEach(c=>c(s)),s.directiveDefs=i?()=>("function"==typeof i?i():i).map(lh).filter(G5):null,s.pipeDefs=i?()=>("function"==typeof i?i():i).map(e2).filter(G5):null,s})}function P8(n,t,e){const r=n.\u0275cmp;r.directiveDefs=()=>("function"==typeof t?t():t).map(lh),r.pipeDefs=()=>("function"==typeof e?e():e).map(e2)}function lh(n){return P1(n)||Ji(n)}function G5(n){return null!==n}function oi(n){return J3(()=>({type:n.type,bootstrap:n.bootstrap||C1,declarations:n.declarations||C1,imports:n.imports||C1,exports:n.exports||C1,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function uh(n,t){if(null==n)return Y;const e={};for(const r in n)if(n.hasOwnProperty(r)){let s=n[r],i=s;Array.isArray(s)&&(i=s[1],s=s[0]),e[s]=r,t&&(t[s]=i)}return e}const Ut=gt;function ai(n){return{type:n.type,name:n.name,factory:null,pure:!1!==n.pure,standalone:!0===n.standalone,onDestroy:n.type.prototype.ngOnDestroy||null}}function P1(n){return n[U5]||null}function Ji(n){return n[ah]||null}function e2(n){return n[ch]||null}function ho(n,t){const e=n[S8]||null;if(!e&&!0===t)throw new Error(`Type ${Y1(n)} does not have '\u0275mod' property.`);return e}function po(n){return Array.isArray(n)&&"object"==typeof n[1]}function Mr(n){return Array.isArray(n)&&!0===n[1]}function W2(n){return 0!=(8&n.flags)}function Ko(n){return 2==(2&n.flags)}function Xo(n){return 1==(1&n.flags)}function Es(n){return null!==n.template}function L6(n){return 0!=(256&n[2])}function Pa(n,t){return n.hasOwnProperty(r3)?n[r3]:null}class ET{constructor(t,e,r){this.previousValue=t,this.currentValue=e,this.firstChange=r}isFirstChange(){return this.firstChange}}function r2(){return O_}function O_(n){return n.type.prototype.ngOnChanges&&(n.setInput=N_),MT}function MT(){const n=K5(this),t=n?.current;if(t){const e=n.previous;if(e===Y)n.previous=t;else for(let r in t)e[r]=t[r];n.current=null,this.ngOnChanges(t)}}function N_(n,t,e,r){const s=K5(n)||function ST(n,t){return n[A_]=t}(n,{previous:Y,current:null}),i=s.current||(s.current={}),o=s.previous,c=this.declaredInputs[e],u=o[c];i[c]=new ET(u&&u.currentValue,t,o===Y),n[r]=t}r2.ngInherit=!0;const A_="__ngSimpleChanges__";function K5(n){return n[A_]||null}function Sr(n){for(;Array.isArray(n);)n=n[0];return n}function b8(n,t){return Sr(t[n])}function s2(n,t){return Sr(t[n.index])}function gh(n,t){return n.data[t]}function il(n,t){return n[t]}function Ii(n,t){const e=t[n];return po(e)?e:e[0]}function z6(n){return 64==(64&n[2])}function o3(n,t){return null==t?null:n[t]}function L_(n){n[18]=0}function mh(n,t){n[5]+=t;let e=n,r=n[3];for(;null!==r&&(1===t&&1===e[5]||-1===t&&0===e[5]);)r[5]+=t,e=r,r=r[3]}const cn={lFrame:Sh(null),bindingsEnabled:!0};function _h(){return cn.bindingsEnabled}function Re(){return cn.lFrame.lView}function Xn(){return cn.lFrame.tView}function he(n){return cn.lFrame.contextLView=n,n[8]}function le(n){return cn.lFrame.contextLView=null,n}function Rr(){let n=R_();for(;null!==n&&64===n.type;)n=n.parent;return n}function R_(){return cn.lFrame.currentTNode}function ol(){const n=cn.lFrame,t=n.currentTNode;return n.isParent?t:t.parent}function hc(n,t){const e=cn.lFrame;e.currentTNode=n,e.isParent=t}function Zr(){return cn.lFrame.isParent}function vh(){cn.lFrame.isParent=!1}function xi(){const n=cn.lFrame;let t=n.bindingRootIndex;return-1===t&&(t=n.bindingRootIndex=n.tView.bindingStartIndex),t}function dc(){return cn.lFrame.bindingIndex}function H6(){return cn.lFrame.bindingIndex++}function Jo(n){const t=cn.lFrame,e=t.bindingIndex;return t.bindingIndex=t.bindingIndex+n,e}function o2(n){cn.lFrame.inI18n=n}function kT(n,t){const e=cn.lFrame;e.bindingIndex=e.bindingRootIndex=n,a3(t)}function a3(n){cn.lFrame.currentDirectiveIndex=n}function Eh(){return cn.lFrame.currentQueryIndex}function N8(n){cn.lFrame.currentQueryIndex=n}function z_(n){const t=n[1];return 2===t.type?t.declTNode:1===t.type?n[6]:null}function n7(n,t,e){if(e&jt.SkipSelf){let s=t,i=n;for(;!(s=s.parent,null!==s||e&jt.Host||(s=z_(i),null===s||(i=i[15],10&s.type))););if(null===s)return!1;t=s,n=i}const r=cn.lFrame=Mh();return r.currentTNode=t,r.lView=n,!0}function al(n){const t=Mh(),e=n[1];cn.lFrame=t,t.currentTNode=e.firstChild,t.lView=n,t.tView=e,t.contextLView=n,t.bindingIndex=e.bindingStartIndex,t.inI18n=!1}function Mh(){const n=cn.lFrame,t=null===n?null:n.child;return null===t?Sh(n):t}function Sh(n){const t={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=t),t}function V_(){const n=cn.lFrame;return cn.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const A8=V_;function cl(){const n=V_();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function a2(){return cn.lFrame.selectedIndex}function c3(n){cn.lFrame.selectedIndex=n}function T1(){const n=cn.lFrame;return gh(n.tView,n.selectedIndex)}function F(){cn.lFrame.currentNamespace="svg"}function f3(n,t){for(let e=t.directiveStart,r=t.directiveEnd;e<r;e++){const i=n.data[e].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:c,ngAfterViewInit:u,ngAfterViewChecked:h,ngOnDestroy:p}=i;o&&(n.contentHooks||(n.contentHooks=[])).push(-e,o),c&&((n.contentHooks||(n.contentHooks=[])).push(e,c),(n.contentCheckHooks||(n.contentCheckHooks=[])).push(e,c)),u&&(n.viewHooks||(n.viewHooks=[])).push(-e,u),h&&((n.viewHooks||(n.viewHooks=[])).push(e,h),(n.viewCheckHooks||(n.viewCheckHooks=[])).push(e,h)),null!=p&&(n.destroyHooks||(n.destroyHooks=[])).push(e,p)}}function Ta(n,t,e){H_(n,t,3,e)}function x8(n,t,e,r){(3&n[2])===e&&H_(n,t,e,r)}function k8(n,t){let e=n[2];(3&e)===t&&(e&=2047,e+=1,n[2]=e)}function H_(n,t,e,r){const i=r??-1,o=t.length-1;let c=0;for(let u=void 0!==r?65535&n[18]:0;u<o;u++)if("number"==typeof t[u+1]){if(c=t[u],null!=r&&c>=r)break}else t[u]<0&&(n[18]+=65536),(c<i||-1==i)&&(F_(n,e,t,u),n[18]=(4294901760&n[18])+u+2),u++}function F_(n,t,e,r){const s=e[r]<0,i=e[r+1],c=n[s?-e[r]:e[r]];if(s){if(n[2]>>11<n[18]>>16&&(3&n[2])===t){n[2]+=2048;try{i.call(c)}finally{}}}else try{i.call(c)}finally{}}class L8{constructor(t,e,r){this.factory=t,this.resolving=!1,this.canSeeViewProviders=e,this.injectImpl=r}}function pc(n,t,e){let r=0;for(;r<e.length;){const s=e[r];if("number"==typeof s){if(0!==s)break;r++;const i=e[r++],o=e[r++],c=e[r++];n.setAttribute(t,o,c,i)}else{const i=s,o=e[++r];U_(i)?n.setProperty(t,i,o):n.setAttribute(t,i,o),r++}}return r}function $_(n){return 3===n||4===n||6===n}function U_(n){return 64===n.charCodeAt(0)}function $6(n,t){if(null!==t&&0!==t.length)if(null===n||0===n.length)n=t.slice();else{let e=-1;for(let r=0;r<t.length;r++){const s=t[r];"number"==typeof s?e=s:0===e||Th(n,e,s,null,-1===e||2===e?t[++r]:null)}}return n}function Th(n,t,e,r,s){let i=0,o=n.length;if(-1===t)o=-1;else for(;i<n.length;){const c=n[i++];if("number"==typeof c){if(c===t){o=-1;break}if(c>t){o=i-1;break}}}for(;i<n.length;){const c=n[i];if("number"==typeof c)break;if(c===e){if(null===r)return void(null!==s&&(n[i+1]=s));if(r===n[i+1])return void(n[i+2]=s)}i++,null!==r&&i++,null!==s&&i++}-1!==o&&(n.splice(o,0,t),i=o+1),n.splice(i++,0,e),null!==r&&n.splice(i++,0,r),null!==s&&n.splice(i++,0,s)}function wh(n){return-1!==n}function ul(n){return 32767&n}function fl(n,t){let e=function G_(n){return n>>16}(n),r=t;for(;e>0;)r=r[15],e--;return r}let s7=!0;function i4(n){const t=s7;return s7=n,t}let W_=0;const h3={};function i7(n,t){const e=D8(n,t);if(-1!==e)return e;const r=t[1];r.firstCreatePass&&(n.injectorIndex=t.length,Oh(r.data,n),Oh(t,null),Oh(r.blueprint,null));const s=ba(n,t),i=n.injectorIndex;if(wh(s)){const o=ul(s),c=fl(s,t),u=c[1].data;for(let h=0;h<8;h++)t[i+h]=c[o+h]|u[o+h]}return t[i+8]=s,i}function Oh(n,t){n.push(0,0,0,0,0,0,0,0,t)}function D8(n,t){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===t[n.injectorIndex+8]?-1:n.injectorIndex}function ba(n,t){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let e=0,r=null,s=t;for(;null!==s;){if(r=Z_(s),null===r)return-1;if(e++,s=s[15],-1!==r.injectorIndex)return r.injectorIndex|e<<16}return-1}function U6(n,t,e){!function mF(n,t,e){let r;"string"==typeof e?r=e.charCodeAt(0)||0:e.hasOwnProperty(s3)&&(r=e[s3]),null==r&&(r=e[s3]=W_++);const s=255&r;t.data[n+(s>>5)]|=1<<s}(n,t,e)}function Nh(n,t,e){if(e&jt.Optional||void 0!==n)return n;O6()}function Ah(n,t,e,r){if(e&jt.Optional&&void 0===r&&(r=null),0==(e&(jt.Self|jt.Host))){const s=n[9],i=qo(void 0);try{return s?s.get(t,r,e&jt.Optional):oh(t,r,e&jt.Optional)}finally{qo(i)}}return Nh(r,0,e)}function o7(n,t,e,r=jt.Default,s){if(null!==n){if(1024&t[2]){const o=function a7(n,t,e,r,s){let i=n,o=t;for(;null!==i&&null!==o&&1024&o[2]&&!(256&o[2]);){const c=o4(i,o,e,r|jt.Self,h3);if(c!==h3)return c;let u=i.parent;if(!u){const h=o[21];if(h){const p=h.get(e,h3,r);if(p!==h3)return p}u=Z_(o),o=o[15]}i=u}return s}(n,t,e,r,h3);if(o!==h3)return o}const i=o4(n,t,e,r,h3);if(i!==h3)return i}return Ah(t,e,r,s)}function o4(n,t,e,r,s){const i=function z8(n){if("string"==typeof n)return n.charCodeAt(0)||0;const t=n.hasOwnProperty(s3)?n[s3]:void 0;return"number"==typeof t?t>=0?255&t:W6:t}(e);if("function"==typeof i){if(!n7(t,n,r))return r&jt.Host?Nh(s,0,r):Ah(t,e,r,s);try{const o=i(r);if(null!=o||r&jt.Optional)return o;O6()}finally{A8()}}else if("number"==typeof i){let o=null,c=D8(n,t),u=-1,h=r&jt.Host?t[16][6]:null;for((-1===c||r&jt.SkipSelf)&&(u=-1===c?ba(n,t):t[c+8],-1!==u&&j_(r,!1)?(o=t[1],c=ul(u),t=fl(u,t)):c=-1);-1!==c;){const p=t[1];if(q_(i,c,p.data)){const m=Ih(c,t,e,o,r,h);if(m!==h3)return m}u=t[c+8],-1!==u&&j_(r,t[1].data[c+8]===h)&&q_(i,c,t)?(o=p,c=ul(u),t=fl(u,t)):c=-1}}return s}function Ih(n,t,e,r,s,i){const o=t[1],c=o.data[n+8],p=Yr(c,o,e,null==r?Ko(c)&&s7:r!=o&&0!=(3&c.type),s&jt.Host&&i===c);return null!==p?Fs(t,o,p,c):h3}function Yr(n,t,e,r,s){const i=n.providerIndexes,o=t.data,c=1048575&i,u=n.directiveStart,p=i>>20,C=s?c+p:n.directiveEnd;for(let w=r?c:c+p;w<C;w++){const I=o[w];if(w<u&&e===I||w>=u&&I.type===e)return w}if(s){const w=o[u];if(w&&Es(w)&&w.type===e)return u}return null}function Fs(n,t,e,r){let s=n[e];const i=t.data;if(function LT(n){return n instanceof L8}(s)){const o=s;o.resolving&&function y8(n,t){const e=t?`. Dependency path: ${t.join(" > ")} > ${n}`:"";throw new Ae(-200,`Circular dependency in DI detected for ${n}${e}`)}(function Rt(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():rn(n)}(i[e]));const c=i4(o.canSeeViewProviders);o.resolving=!0;const u=o.injectImpl?qo(o.injectImpl):null;n7(n,r,jt.Default);try{s=n[e]=o.factory(void 0,i,n,r),t.firstCreatePass&&e>=r.directiveStart&&function B6(n,t,e){const{ngOnChanges:r,ngOnInit:s,ngDoCheck:i}=t.type.prototype;if(r){const o=O_(t);(e.preOrderHooks||(e.preOrderHooks=[])).push(n,o),(e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(n,o)}s&&(e.preOrderHooks||(e.preOrderHooks=[])).push(0-n,s),i&&((e.preOrderHooks||(e.preOrderHooks=[])).push(n,i),(e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(n,i))}(e,i[e],t)}finally{null!==u&&qo(u),i4(c),o.resolving=!1,A8()}}return s}function q_(n,t,e){return!!(e[t+(n>>5)]&1<<n)}function j_(n,t){return!(n&jt.Self||n&jt.Host&&t)}class G6{constructor(t,e){this._tNode=t,this._lView=e}get(t,e,r){return o7(this._tNode,this._lView,t,r,e)}}function W6(){return new G6(Rr(),Re())}function Dr(n){return J3(()=>{const t=n.prototype.constructor,e=t[r3]||xh(t),r=Object.prototype;let s=Object.getPrototypeOf(n.prototype).constructor;for(;s&&s!==r;){const i=s[r3]||xh(s);if(i&&i!==e)return i;s=Object.getPrototypeOf(s)}return i=>new i})}function xh(n){return w6(n)?()=>{const t=xh(nn(n));return t&&t()}:Pa(n)}function Z_(n){const t=n[1],e=t.type;return 2===e?t.declTNode:1===e?n[6]:null}function V8(n){return function DT(n,t){if("class"===t)return n.classes;if("style"===t)return n.styles;const e=n.attrs;if(e){const r=e.length;let s=0;for(;s<r;){const i=e[s];if($_(i))break;if(0===i)s+=2;else if("number"==typeof i)for(s++;s<r&&"string"==typeof e[s];)s++;else{if(i===t)return e[s+1];s+=2}}}return null}(Rr(),n)}const q6="__parameters__";function pl(n,t,e){return J3(()=>{const r=function c7(n){return function(...e){if(n){const r=n(...e);for(const s in r)this[s]=r[s]}}}(t);function s(...i){if(this instanceof s)return r.apply(this,i),this;const o=new s(...i);return c.annotation=o,c;function c(u,h,p){const m=u.hasOwnProperty(q6)?u[q6]:Object.defineProperty(u,q6,{value:[]})[q6];for(;m.length<=p;)m.push(null);return(m[p]=m[p]||[]).push(o),u}}return e&&(s.prototype=Object.create(e.prototype)),s.prototype.ngMetadataName=n,s.annotationCls=s,s})}class kt{constructor(t,e){this._desc=t,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof e?this.__NG_ELEMENT_ID__=e:void 0!==e&&(this.\u0275prov=nt({token:this,providedIn:e.providedIn||"root",factory:e.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}function c2(n,t){void 0===t&&(t=n);for(let e=0;e<n.length;e++){let r=n[e];Array.isArray(r)?(t===n&&(t=n.slice(0,e)),c2(r,t)):t!==n&&t.push(r)}return t}function Oa(n,t){n.forEach(e=>Array.isArray(e)?Oa(e,t):t(e))}function d3(n,t,e){t>=n.length?n.push(e):n.splice(t,0,e)}function Y6(n,t){return t>=n.length-1?n.pop():n.splice(t,1)[0]}function gl(n,t){const e=[];for(let r=0;r<n;r++)e.push(t);return e}function l2(n,t,e){let r=u2(n,t);return r>=0?n[1|r]=e:(r=~r,function Lh(n,t,e,r){let s=n.length;if(s==t)n.push(e,r);else if(1===s)n.push(r,n[0]),n[0]=e;else{for(s--,n.push(n[s-1],n[s]);s>t;)n[s]=n[s-2],s--;n[t]=e,n[t+1]=r}}(n,r,t,e)),r}function ci(n,t){const e=u2(n,t);if(e>=0)return n[1|e]}function u2(n,t){return function f7(n,t,e){let r=0,s=n.length>>e;for(;s!==r;){const i=r+(s-r>>1),o=n[i<<e];if(t===o)return i<<e;o>t?s=i:r=i+1}return~(s<<e)}(n,t,1)}const $8={},U8="__NG_DI_FLAG__",li="ngTempTokenPath",FT=/\n/gm,p7="__source";let G8;function X6(n){const t=G8;return G8=n,t}function BT(n,t=jt.Default){if(void 0===G8)throw new Ae(-203,!1);return null===G8?oh(n,void 0,t):G8.get(n,t&jt.Optional?null:void 0,t)}function De(n,t=jt.Default){return(function iF(){return ih}()||BT)(nn(n),t)}function zr(n,t=jt.Default){return"number"!=typeof t&&(t=0|(t.optional&&8)|(t.host&&1)|(t.self&&2)|(t.skipSelf&&4)),De(n,t)}function Hh(n){const t=[];for(let e=0;e<n.length;e++){const r=nn(n[e]);if(Array.isArray(r)){if(0===r.length)throw new Ae(900,!1);let s,i=jt.Default;for(let o=0;o<r.length;o++){const c=r[o],u=tv(c);"number"==typeof u?-1===u?s=c.token:i|=u:s=c}t.push(De(s,i))}else t.push(De(r))}return t}function ml(n,t){return n[U8]=t,n.prototype[U8]=t,n}function tv(n){return n[U8]}const ui=ml(pl("Optional"),8),W8=ml(pl("SkipSelf"),4);let jh,m7,_7;function rv(){return void 0!==jh?jh:typeof document<"u"?document:void 0}function l4(n){return function Zh(){if(void 0===m7&&(m7=null,er.trustedTypes))try{m7=er.trustedTypes.createPolicy("angular",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return m7}()?.createHTML(n)||n}function v7(n){return function Yh(){if(void 0===_7&&(_7=null,er.trustedTypes))try{_7=er.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return _7}()?.createHTML(n)||n}class u4{constructor(t){this.changingThisBreaksApplicationSecurity=t}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}class JT extends u4{getTypeName(){return"HTML"}}class ew extends u4{getTypeName(){return"Style"}}class tw extends u4{getTypeName(){return"Script"}}class iv extends u4{getTypeName(){return"URL"}}class ov extends u4{getTypeName(){return"ResourceURL"}}function mo(n){return n instanceof u4?n.changingThisBreaksApplicationSecurity:n}function _o(n,t){const e=function av(n){return n instanceof u4&&n.getTypeName()||null}(n);if(null!=e&&e!==t){if("ResourceURL"===e&&"URL"===t)return!0;throw new Error(`Required a safe ${t}, got a ${e} (see https://g.co/ng/security#xss)`)}return e===t}function uv(n){const t=new Lt(n);return function iw(){try{return!!(new window.DOMParser).parseFromString(l4(""),"text/html")}catch{return!1}}()?new fv(t):t}class fv{constructor(t){this.inertDocumentHelper=t}getInertBodyElement(t){t="<body><remove></remove>"+t;try{const e=(new window.DOMParser).parseFromString(l4(t),"text/html").body;return null===e?this.inertDocumentHelper.getInertBodyElement(t):(e.removeChild(e.firstChild),e)}catch{return null}}}class Lt{constructor(t){if(this.defaultDoc=t,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),null==this.inertDocument.body){const e=this.inertDocument.createElement("html");this.inertDocument.appendChild(e);const r=this.inertDocument.createElement("body");e.appendChild(r)}}getInertBodyElement(t){const e=this.inertDocument.createElement("template");if("content"in e)return e.innerHTML=l4(t),e;const r=this.inertDocument.createElement("body");return r.innerHTML=l4(t),this.defaultDoc.documentMode&&this.stripCustomNsAttrs(r),r}stripCustomNsAttrs(t){const e=t.attributes;for(let s=e.length-1;0<s;s--){const o=e.item(s).name;("xmlns:ns1"===o||0===o.indexOf("ns1:"))&&t.removeAttribute(o)}let r=t.firstChild;for(;r;)r.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(r),r=r.nextSibling}}const hv=/^(?:(?:https?|mailto|data|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi;function ra(n){return(n=String(n)).match(hv)?n:"unsafe:"+n}function mc(n){const t={};for(const e of n.split(","))t[e]=!0;return t}function Z8(...n){const t={};for(const e of n)for(const r in e)e.hasOwnProperty(r)&&(t[r]=!0);return t}const dv=mc("area,br,col,hr,img,wbr"),pv=mc("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),C7=mc("rp,rt"),Y8=Z8(dv,Z8(pv,mc("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),Z8(C7,mc("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),Z8(C7,pv)),y7=mc("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),E7=Z8(y7,mc("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),mc("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),ow=mc("script,style,template");class aw{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(t){let e=t.firstChild,r=!0;for(;e;)if(e.nodeType===Node.ELEMENT_NODE?r=this.startElement(e):e.nodeType===Node.TEXT_NODE?this.chars(e.nodeValue):this.sanitizedSomething=!0,r&&e.firstChild)e=e.firstChild;else for(;e;){e.nodeType===Node.ELEMENT_NODE&&this.endElement(e);let s=this.checkClobberedElement(e,e.nextSibling);if(s){e=s;break}e=this.checkClobberedElement(e,e.parentNode)}return this.buf.join("")}startElement(t){const e=t.nodeName.toLowerCase();if(!Y8.hasOwnProperty(e))return this.sanitizedSomething=!0,!ow.hasOwnProperty(e);this.buf.push("<"),this.buf.push(e);const r=t.attributes;for(let s=0;s<r.length;s++){const i=r.item(s),o=i.name,c=o.toLowerCase();if(!E7.hasOwnProperty(c)){this.sanitizedSomething=!0;continue}let u=i.value;y7[c]&&(u=ra(u)),this.buf.push(" ",o,'="',mv(u),'"')}return this.buf.push(">"),!0}endElement(t){const e=t.nodeName.toLowerCase();Y8.hasOwnProperty(e)&&!dv.hasOwnProperty(e)&&(this.buf.push("</"),this.buf.push(e),this.buf.push(">"))}chars(t){this.buf.push(mv(t))}checkClobberedElement(t,e){if(e&&(t.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${t.outerHTML}`);return e}}const cw=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,lw=/([^\#-~ |!])/g;function mv(n){return n.replace(/&/g,"&amp;").replace(cw,function(t){return"&#"+(1024*(t.charCodeAt(0)-55296)+(t.charCodeAt(1)-56320)+65536)+";"}).replace(lw,function(t){return"&#"+t.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let M7;function Xh(n,t){let e=null;try{M7=M7||uv(n);let r=t?String(t):"";e=M7.getInertBodyElement(r);let s=5,i=r;do{if(0===s)throw new Error("Failed to sanitize html because the input is unstable");s--,r=i,i=e.innerHTML,e=M7.getInertBodyElement(r)}while(r!==i);return l4((new aw).sanitizeChildren(vo(e)||e))}finally{if(e){const r=vo(e)||e;for(;r.firstChild;)r.removeChild(r.firstChild)}}}function vo(n){return"content"in n&&function K8(n){return n.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===n.nodeName}(n)?n.content:null}var tr=(()=>((tr=tr||{})[tr.NONE=0]="NONE",tr[tr.HTML=1]="HTML",tr[tr.STYLE=2]="STYLE",tr[tr.SCRIPT=3]="SCRIPT",tr[tr.URL=4]="URL",tr[tr.RESOURCE_URL=5]="RESOURCE_URL",tr))();function X8(n){const t=t0();return t?v7(t.sanitize(tr.HTML,n)||""):_o(n,"HTML")?v7(mo(n)):Xh(rv(),rn(n))}function p3(n){const t=t0();return t?t.sanitize(tr.URL,n)||"":_o(n,"URL")?mo(n):ra(rn(n))}function t0(){const n=Re();return n&&n[12]}const tu=new kt("ENVIRONMENT_INITIALIZER"),vv=new kt("INJECTOR",-1),Cv=new kt("INJECTOR_DEF_TYPES");class yv{get(t,e=$8){if(e===$8){const r=new Error(`NullInjectorError: No provider for ${Y1(t)}!`);throw r.name="NullInjectorError",r}return e}}function nu(...n){return{\u0275providers:Jh(0,n)}}function Jh(n,...t){const e=[],r=new Set;let s;return Oa(t,i=>{const o=i;g3(o,e,[],r)&&(s||(s=[]),s.push(o))}),void 0!==s&&Ev(s,e),e}function Ev(n,t){for(let e=0;e<n.length;e++){const{providers:s}=n[e];Oa(s,i=>{t.push(i)})}}function g3(n,t,e,r){if(!(n=nn(n)))return!1;let s=null,i=M8(n);const o=!i&&P1(n);if(i||o){if(o&&!o.standalone)return!1;s=n}else{const u=n.ngModule;if(i=M8(u),!i)return!1;s=u}const c=r.has(s);if(o){if(c)return!1;if(r.add(s),o.dependencies){const u="function"==typeof o.dependencies?o.dependencies():o.dependencies;for(const h of u)g3(h,t,e,r)}}else{if(!i)return!1;{if(null!=i.imports&&!c){let h;r.add(s);try{Oa(i.imports,p=>{g3(p,t,e,r)&&(h||(h=[]),h.push(p))})}finally{}void 0!==h&&Ev(h,t)}if(!c){const h=Pa(s)||(()=>new s);t.push({provide:s,useFactory:h,deps:C1},{provide:Cv,useValue:s,multi:!0},{provide:tu,useValue:()=>De(s),multi:!0})}const u=i.providers;null==u||c||Oa(u,p=>{t.push(p)})}}return s!==n&&void 0!==n.providers}const uw=E1({provide:String,useValue:E1});function f2(n){return null!==n&&"object"==typeof n&&uw in n}function Cl(n){return"function"==typeof n}const td=new kt("Set Injector scope."),P7={},Pv={};let nd;function f4(){return void 0===nd&&(nd=new yv),nd}class Aa{}class T7 extends Aa{constructor(t,e,r,s){super(),this.parent=e,this.source=r,this.scopes=s,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,b7(t,o=>this.processProvider(o)),this.records.set(vv,yl(void 0,this)),s.has("environment")&&this.records.set(Aa,yl(void 0,this));const i=this.records.get(td);null!=i&&"string"==typeof i.value&&this.scopes.add(i.value),this.injectorDefTypes=new Set(this.get(Cv.multi,C1,jt.Self))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const t of this._ngOnDestroyHooks)t.ngOnDestroy();for(const t of this._onDestroyHooks)t()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),this._onDestroyHooks.length=0}}onDestroy(t){this._onDestroyHooks.push(t)}runInContext(t){this.assertNotDestroyed();const e=X6(this),r=qo(void 0);try{return t()}finally{X6(e),qo(r)}}get(t,e=$8,r=jt.Default){this.assertNotDestroyed();const s=X6(this),i=qo(void 0);try{if(!(r&jt.SkipSelf)){let c=this.records.get(t);if(void 0===c){const u=function bv(n){return"function"==typeof n||"object"==typeof n&&n instanceof kt}(t)&&kn(t);c=u&&this.injectableDefInScope(u)?yl(Co(t),P7):null,this.records.set(t,c)}if(null!=c)return this.hydrate(t,c)}return(r&jt.Self?f4():this.parent).get(t,e=r&jt.Optional&&e===$8?null:e)}catch(o){if("NullInjectorError"===o.name){if((o[li]=o[li]||[]).unshift(Y1(t)),s)throw o;return function $T(n,t,e,r){const s=n[li];throw t[p7]&&s.unshift(t[p7]),n.message=function qn(n,t,e,r=null){n=n&&"\n"===n.charAt(0)&&"\u0275"==n.charAt(1)?n.slice(2):n;let s=Y1(t);if(Array.isArray(t))s=t.map(Y1).join(" -> ");else if("object"==typeof t){let i=[];for(let o in t)if(t.hasOwnProperty(o)){let c=t[o];i.push(o+":"+("string"==typeof c?JSON.stringify(c):Y1(c)))}s=`{${i.join(", ")}}`}return`${e}${r?"("+r+")":""}[${s}]: ${n.replace(FT,"\n  ")}`}("\n"+n.message,s,e,r),n.ngTokenPath=s,n[li]=null,n}(o,t,"R3InjectorError",this.source)}throw o}finally{qo(i),X6(s)}}resolveInjectorInitializers(){const t=X6(this),e=qo(void 0);try{const r=this.get(tu.multi,C1,jt.Self);for(const s of r)s()}finally{X6(t),qo(e)}}toString(){const t=[],e=this.records;for(const r of e.keys())t.push(Y1(r));return`R3Injector[${t.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Ae(205,!1)}processProvider(t){let e=Cl(t=nn(t))?t:nn(t&&t.provide);const r=function hw(n){return f2(n)?yl(void 0,n.useValue):yl(w7(n),P7)}(t);if(Cl(t)||!0!==t.multi)this.records.get(e);else{let s=this.records.get(e);s||(s=yl(void 0,P7,!0),s.factory=()=>Hh(s.multi),this.records.set(e,s)),e=t,s.multi.push(t)}this.records.set(e,r)}hydrate(t,e){return e.value===P7&&(e.value=Pv,e.value=e.factory()),"object"==typeof e.value&&e.value&&function wv(n){return null!==n&&"object"==typeof n&&"function"==typeof n.ngOnDestroy}(e.value)&&this._ngOnDestroyHooks.add(e.value),e.value}injectableDefInScope(t){if(!t.providedIn)return!1;const e=nn(t.providedIn);return"string"==typeof e?"any"===e||this.scopes.has(e):this.injectorDefTypes.has(e)}}function Co(n){const t=kn(n),e=null!==t?t.factory:Pa(n);if(null!==e)return e;if(n instanceof kt)throw new Ae(204,!1);if(n instanceof Function)return function ru(n){const t=n.length;if(t>0)throw gl(t,"?"),new Ae(204,!1);const e=function S_(n){const t=n&&(n[N6]||n[rh]);if(t){const e=function ii(n){if(n.hasOwnProperty("name"))return n.name;const t=(""+n).match(/^function\s*([^\s(]+)/);return null===t?"":t[1]}(n);return console.warn(`DEPRECATED: DI is instantiating a token "${e}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${e}" class.`),t}return null}(n);return null!==e?()=>e.factory(n):()=>new n}(n);throw new Ae(204,!1)}function w7(n,t,e){let r;if(Cl(n)){const s=nn(n);return Pa(s)||Co(s)}if(f2(n))r=()=>nn(n.useValue);else if(function Sv(n){return!(!n||!n.useFactory)}(n))r=()=>n.useFactory(...Hh(n.deps||[]));else if(function ed(n){return!(!n||!n.useExisting)}(n))r=()=>De(nn(n.useExisting));else{const s=nn(n&&(n.useClass||n.provide));if(!function Tv(n){return!!n.deps}(n))return Pa(s)||Co(s);r=()=>new s(...Hh(n.deps))}return r}function yl(n,t,e=!1){return{factory:n,value:t,multi:e?[]:void 0}}function dw(n){return!!n.\u0275providers}function b7(n,t){for(const e of n)Array.isArray(e)?b7(e,t):dw(e)?b7(e.\u0275providers,t):t(e)}class Ov{}class _w{resolveComponentFactory(t){throw function gw(n){const t=Error(`No component factory found for ${Y1(n)}. Did you add it to @NgModule.entryComponents?`);return t.ngComponent=n,t}(t)}}let Ia=(()=>{class n{}return n.NULL=new _w,n})();function OF(){return n0(Rr(),Re())}function n0(n,t){return new h2(s2(n,t))}let h2=(()=>{class n{constructor(e){this.nativeElement=e}}return n.__NG_ELEMENT_ID__=OF,n})();function O7(n){return n instanceof h2?n.nativeElement:n}class r0{}let yo=(()=>{class n{}return n.__NG_ELEMENT_ID__=()=>function vw(){const n=Re(),e=Ii(Rr().index,n);return(po(e)?e:n)[11]}(),n})(),NF=(()=>{class n{}return n.\u0275prov=nt({token:n,providedIn:"root",factory:()=>null}),n})();class s0{constructor(t){this.full=t,this.major=t.split(".")[0],this.minor=t.split(".")[1],this.patch=t.split(".").slice(2).join(".")}}const Nv=new s0("14.2.10"),id={};function ad(n){return n.ngOriginalError}class o0{constructor(){this._console=console}handleError(t){const e=this._findOriginalError(t);this._console.error("ERROR",t),e&&this._console.error("ORIGINAL ERROR",e)}_findOriginalError(t){let e=t&&ad(t);for(;e&&ad(e);)e=ad(e);return e||null}}const bw=/^>|^->|<!--|-->|--!>|<!-$/g,Ow=/(<|>)/;const cd=new Map;let kv=0;const x7="__ngContext__";function Di(n,t){po(t)?(n[x7]=t[20],function Lw(n){cd.set(n[20],n)}(t)):n[x7]=t}function xa(n){return n instanceof Function?n():n}var p2=(()=>((p2=p2||{})[p2.Important=1]="Important",p2[p2.DashCase=2]="DashCase",p2))();let fd;function hd(n,t){return fd(n,t)}function ou(n){const t=n[3];return Mr(t)?t[3]:t}function dd(n){return _c(n[13])}function pd(n){return _c(n[4])}function _c(n){for(;null!==n&&!Mr(n);)n=n[4];return n}function El(n,t,e,r,s){if(null!=r){let i,o=!1;Mr(r)?i=r:po(r)&&(o=!0,r=r[0]);const c=Sr(r);0===n&&null!==e?null==s?Zv(t,e,c):v3(t,e,c,s||null,!0):1===n&&null!==e?v3(t,e,c,s||null,!0):2===n?eC(t,c,o):3===n&&t.destroyNode(c),null!=i&&function tb(n,t,e,r,s){const i=e[7];i!==Sr(e)&&El(t,n,r,i,s);for(let c=10;c<e.length;c++){const u=e[c];l0(u[1],u,n,t,r,i)}}(t,n,i,e,s)}}function gd(n,t){return n.createText(t)}function Gv(n,t,e){n.setValue(t,e)}function qw(n,t){return n.createComment(function xv(n){return n.replace(bw,t=>t.replace(Ow,"\u200b$1\u200b"))}(t))}function md(n,t,e){return n.createElement(t,e)}function Wv(n,t){const e=n[9],r=e.indexOf(t),s=t[3];512&t[2]&&(t[2]&=-513,mh(s,-1)),e.splice(r,1)}function _d(n,t){if(n.length<=10)return;const e=10+t,r=n[e];if(r){const s=r[17];null!==s&&s!==n&&Wv(s,r),t>0&&(n[e-1][4]=r[4]);const i=Y6(n,10+t);!function jw(n,t){l0(n,t,t[11],2,null,null),t[0]=null,t[6]=null}(r[1],r);const o=i[19];null!==o&&o.detachView(i[1]),r[3]=null,r[4]=null,r[2]&=-65}return r}function qv(n,t){if(!(128&t[2])){const e=t[11];e.destroyNode&&l0(n,t,e,3,null,null),function Kw(n){let t=n[13];if(!t)return vd(n[1],n);for(;t;){let e=null;if(po(t))e=t[13];else{const r=t[10];r&&(e=r)}if(!e){for(;t&&!t[4]&&t!==n;)po(t)&&vd(t[1],t),t=t[3];null===t&&(t=n),po(t)&&vd(t[1],t),e=t&&t[4]}t=e}}(t)}}function vd(n,t){if(!(128&t[2])){t[2]&=-65,t[2]|=128,function Jw(n,t){let e;if(null!=n&&null!=(e=n.destroyHooks))for(let r=0;r<e.length;r+=2){const s=t[e[r]];if(!(s instanceof L8)){const i=e[r+1];if(Array.isArray(i))for(let o=0;o<i.length;o+=2){const c=s[i[o]],u=i[o+1];try{u.call(c)}finally{}}else try{i.call(s)}finally{}}}}(n,t),function Cd(n,t){const e=n.cleanup,r=t[7];let s=-1;if(null!==e)for(let i=0;i<e.length-1;i+=2)if("string"==typeof e[i]){const o=e[i+1],c="function"==typeof o?o(t):Sr(t[o]),u=r[s=e[i+2]],h=e[i+3];"boolean"==typeof h?c.removeEventListener(e[i],u,h):h>=0?r[s=h]():r[s=-h].unsubscribe(),i+=2}else{const o=r[s=e[i+1]];e[i].call(o)}if(null!==r){for(let i=s+1;i<r.length;i++)(0,r[i])();t[7]=null}}(n,t),1===t[1].type&&t[11].destroy();const e=t[17];if(null!==e&&Mr(t[3])){e!==t[3]&&Wv(e,t);const r=t[19];null!==r&&r.detachView(n)}!function Rw(n){cd.delete(n[20])}(t)}}function jv(n,t,e){return yd(n,t.parent,e)}function yd(n,t,e){let r=t;for(;null!==r&&40&r.type;)r=(t=r).parent;if(null===r)return e[0];if(2&r.flags){const s=n.data[r.directiveStart].encapsulation;if(s===z1.None||s===z1.Emulated)return null}return s2(r,e)}function v3(n,t,e,r,s){n.insertBefore(t,e,r,s)}function Zv(n,t,e){n.appendChild(t,e)}function C3(n,t,e,r,s){null!==r?v3(n,t,e,r,s):Zv(n,t,e)}function a0(n,t){return n.parentNode(t)}function Xv(n,t,e){return Jv(n,t,e)}function Qv(n,t,e){return 40&n.type?s2(n,e):null}let Ed,Jv=Qv;function L7(n,t){Jv=n,Ed=t}function au(n,t,e,r){const s=jv(n,r,t),i=t[11],c=Xv(r.parent||t[6],r,t);if(null!=s)if(Array.isArray(e))for(let u=0;u<e.length;u++)C3(i,s,e[u],c,!1);else C3(i,s,e,c,!1);void 0!==Ed&&Ed(i,r,t,e,s)}function cu(n,t){if(null!==t){const e=t.type;if(3&e)return s2(t,n);if(4&e)return c0(-1,n[t.index]);if(8&e){const r=t.child;if(null!==r)return cu(n,r);{const s=n[t.index];return Mr(s)?c0(-1,s):Sr(s)}}if(32&e)return hd(t,n)()||Sr(n[t.index]);{const r=Ml(n,t);return null!==r?Array.isArray(r)?r[0]:cu(ou(n[16]),r):cu(n,t.next)}}return null}function Ml(n,t){return null!==t?n[16][6].projection[t.projection]:null}function c0(n,t){const e=10+n+1;if(e<t.length){const r=t[e],s=r[1].firstChild;if(null!==s)return cu(r,s)}return t[7]}function eC(n,t,e){const r=a0(n,t);r&&function Yv(n,t,e,r){n.removeChild(t,e,r)}(n,r,t,e)}function Md(n,t,e,r,s,i,o){for(;null!=e;){const c=r[e.index],u=e.type;if(o&&0===t&&(c&&Di(Sr(c),r),e.flags|=4),64!=(64&e.flags))if(8&u)Md(n,t,e.child,r,s,i,!1),El(t,n,s,c,i);else if(32&u){const h=hd(e,r);let p;for(;p=h();)El(t,n,s,p,i);El(t,n,s,c,i)}else 16&u?tC(n,t,r,e,s,i):El(t,n,s,c,i);e=o?e.projectionNext:e.next}}function l0(n,t,e,r,s,i){Md(e,r,n.firstChild,t,s,i,!1)}function tC(n,t,e,r,s,i){const o=e[16],u=o[6].projection[r.projection];if(Array.isArray(u))for(let h=0;h<u.length;h++)El(t,n,s,u[h],i);else Md(n,t,u,o[3],s,i,!0)}function lu(n,t,e){n.setAttribute(t,"style",e)}function R7(n,t,e){""===e?n.removeAttribute(t,"class"):n.setAttribute(t,"class",e)}function rC(n,t,e){let r=n.length;for(;;){const s=n.indexOf(t,e);if(-1===s)return s;if(0===s||n.charCodeAt(s-1)<=32){const i=t.length;if(s+i===r||n.charCodeAt(s+i)<=32)return s}e=s+1}}const sC="ng-template";function Sd(n,t,e){let r=0;for(;r<n.length;){let s=n[r++];if(e&&"class"===s){if(s=n[r],-1!==rC(s.toLowerCase(),t,0))return!0}else if(1===s){for(;r<n.length&&"string"==typeof(s=n[r++]);)if(s.toLowerCase()===t)return!0;return!1}}return!1}function uu(n){return 4===n.type&&n.value!==sC}function iC(n,t,e){return t===(4!==n.type||e?n.value:sC)}function nb(n,t,e){let r=4;const s=n.attrs||[],i=function rb(n){for(let t=0;t<n.length;t++)if($_(n[t]))return t;return n.length}(s);let o=!1;for(let c=0;c<t.length;c++){const u=t[c];if("number"!=typeof u){if(!o)if(4&r){if(r=2|1&r,""!==u&&!iC(n,u,e)||""===u&&1===t.length){if(ka(r))return!1;o=!0}}else{const h=8&r?u:t[++c];if(8&r&&null!==n.attrs){if(!Sd(n.attrs,h,e)){if(ka(r))return!1;o=!0}continue}const m=oC(8&r?"class":u,s,uu(n),e);if(-1===m){if(ka(r))return!1;o=!0;continue}if(""!==h){let C;C=m>i?"":s[m+1].toLowerCase();const w=8&r?C:null;if(w&&-1!==rC(w,h,0)||2&r&&h!==C){if(ka(r))return!1;o=!0}}}}else{if(!o&&!ka(r)&&!ka(u))return!1;if(o&&ka(u))continue;o=!1,r=u|1&r}}return ka(r)||o}function ka(n){return 0==(1&n)}function oC(n,t,e,r){if(null===t)return-1;let s=0;if(r||!e){let i=!1;for(;s<t.length;){const o=t[s];if(o===n)return s;if(3===o||6===o)i=!0;else{if(1===o||2===o){let c=t[++s];for(;"string"==typeof c;)c=t[++s];continue}if(4===o)break;if(0===o){s+=4;continue}}s+=i?1:2}return-1}return function sb(n,t){let e=n.indexOf(4);if(e>-1)for(e++;e<n.length;){const r=n[e];if("number"==typeof r)return-1;if(r===t)return e;e++}return-1}(t,n)}function aC(n,t,e=!1){for(let r=0;r<t.length;r++)if(nb(n,t[r],e))return!0;return!1}function lC(n,t){e:for(let e=0;e<t.length;e++){const r=t[e];if(n.length===r.length){for(let s=0;s<n.length;s++)if(n[s]!==r[s])continue e;return!0}}return!1}function Pd(n,t){return n?":not("+t.trim()+")":t}function ib(n){let t=n[0],e=1,r=2,s="",i=!1;for(;e<n.length;){let o=n[e];if("string"==typeof o)if(2&r){const c=n[++e];s+="["+o+(c.length>0?'="'+c+'"':"")+"]"}else 8&r?s+="."+o:4&r&&(s+=" "+o);else""!==s&&!ka(o)&&(t+=Pd(i,s),s=""),r=o,i=i||!ka(r);e++}return""!==s&&(t+=Pd(i,s)),t}const hn={};function S(n){fC(Xn(),Re(),a2()+n,!1)}function fC(n,t,e,r){if(!r)if(3==(3&t[2])){const i=n.preOrderCheckHooks;null!==i&&Ta(t,i,e)}else{const i=n.preOrderHooks;null!==i&&x8(t,i,0,e)}c3(e)}function Od(n,t=null,e=null,r){const s=pC(n,t,e,r);return s.resolveInjectorInitializers(),s}function pC(n,t=null,e=null,r,s=new Set){const i=[e||C1,nu(n)];return r=r||("object"==typeof n?void 0:Y1(n)),new T7(i,t||f4(),r||null,s)}let fi=(()=>{class n{static create(e,r){if(Array.isArray(e))return Od({name:""},r,e,"");{const s=e.name??"";return Od({name:s},e.parent,e.providers,s)}}}return n.THROW_IF_NOT_FOUND=$8,n.NULL=new yv,n.\u0275prov=nt({token:n,providedIn:"any",factory:()=>De(vv)}),n.__NG_ELEMENT_ID__=-1,n})();function J(n,t=jt.Default){const e=Re();return null===e?De(n,t):o7(Rr(),e,nn(n),t)}function H7(){throw new Error("invalid")}function F7(n,t){return n<<17|t<<2}function La(n){return n>>17&32767}function Dd(n){return 2|n}function vc(n){return(131068&n)>>2}function Pl(n,t){return-131069&n|t<<2}function zd(n){return 1|n}function bC(n,t){const e=n.contentQueries;if(null!==e)for(let r=0;r<e.length;r+=2){const s=e[r],i=e[r+1];if(-1!==i){const o=n.data[i];N8(s),o.contentQueries(2,t[i],i)}}}function W7(n,t,e,r,s,i,o,c,u,h,p){const m=t.blueprint.slice();return m[0]=s,m[2]=76|r,(null!==p||n&&1024&n[2])&&(m[2]|=1024),L_(m),m[3]=m[15]=n,m[8]=e,m[10]=o||n&&n[10],m[11]=c||n&&n[11],m[12]=u||n&&n[12]||null,m[9]=h||n&&n[9]||null,m[6]=i,m[20]=function hr(){return kv++}(),m[21]=p,m[16]=2==t.type?n[16]:m,m}function f0(n,t,e,r,s){let i=n.data[t];if(null===i)i=q7(n,t,e,r,s),function ea(){return cn.lFrame.inI18n}()&&(i.flags|=64);else if(64&i.type){i.type=e,i.value=r,i.attrs=s;const o=ol();i.injectorIndex=null===o?-1:o.injectorIndex}return hc(i,!0),i}function q7(n,t,e,r,s){const i=R_(),o=Zr(),u=n.data[t]=function nB(n,t,e,r,s,i){return{type:e,index:r,insertBeforeIndex:null,injectorIndex:t?t.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:s,attrs:i,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:t,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?i:i&&i.parent,e,t,r,s);return null===n.firstChild&&(n.firstChild=u),null!==i&&(o?null==i.child&&null!==u.parent&&(i.child=u):null===i.next&&(i.next=u)),u}function Tl(n,t,e,r){if(0===e)return-1;const s=t.length;for(let i=0;i<e;i++)t.push(r),n.blueprint.push(r),n.data.push(null);return s}function j7(n,t,e){al(t);try{const r=n.viewQuery;null!==r&&Yd(1,r,e);const s=n.template;null!==s&&OC(n,t,s,1,e),n.firstCreatePass&&(n.firstCreatePass=!1),n.staticContentQueries&&bC(n,t),n.staticViewQueries&&Yd(2,n.viewQuery,e);const i=n.components;null!==i&&function Ib(n,t){for(let e=0;e<t.length;e++)lB(n,t[e])}(t,i)}catch(r){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),r}finally{t[2]&=-5,cl()}}function Z7(n,t,e,r){const s=t[2];if(128!=(128&s)){al(t);try{L_(t),function D_(n){return cn.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==e&&OC(n,t,e,2,r);const o=3==(3&s);if(o){const h=n.preOrderCheckHooks;null!==h&&Ta(t,h,null)}else{const h=n.preOrderHooks;null!==h&&x8(t,h,0,null),k8(t,0)}if(function cB(n){for(let t=dd(n);null!==t;t=pd(t)){if(!t[2])continue;const e=t[9];for(let r=0;r<e.length;r++){const s=e[r],i=s[3];0==(512&s[2])&&mh(i,1),s[2]|=512}}}(t),function Bb(n){for(let t=dd(n);null!==t;t=pd(t))for(let e=10;e<t.length;e++){const r=t[e],s=r[1];z6(r)&&Z7(s,r,s.template,r[8])}}(t),null!==n.contentQueries&&bC(n,t),o){const h=n.contentCheckHooks;null!==h&&Ta(t,h)}else{const h=n.contentHooks;null!==h&&x8(t,h,1),k8(t,1)}!function Gd(n,t){const e=n.hostBindingOpCodes;if(null!==e)try{for(let r=0;r<e.length;r++){const s=e[r];if(s<0)c3(~s);else{const i=s,o=e[++r],c=e[++r];kT(o,i),c(2,t[i])}}}finally{c3(-1)}}(n,t);const c=n.components;null!==c&&function Ab(n,t){for(let e=0;e<t.length;e++)$b(n,t[e])}(t,c);const u=n.viewQuery;if(null!==u&&Yd(2,u,r),o){const h=n.viewCheckHooks;null!==h&&Ta(t,h)}else{const h=n.viewHooks;null!==h&&x8(t,h,2),k8(t,2)}!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),t[2]&=-41,512&t[2]&&(t[2]&=-513,mh(t[3],-1))}finally{cl()}}}function OC(n,t,e,r,s){const i=a2(),o=2&r;try{c3(-1),o&&t.length>22&&fC(n,t,22,!1),e(r,s)}finally{c3(i)}}function NC(n,t,e){if(W2(t)){const s=t.directiveEnd;for(let i=t.directiveStart;i<s;i++){const o=n.data[i];o.contentQueries&&o.contentQueries(1,e[i],i)}}}function Wd(n,t,e){!_h()||(function kC(n,t,e,r){const s=e.directiveStart,i=e.directiveEnd;n.firstCreatePass||i7(e,t),Di(r,t);const o=e.initialInputs;for(let c=s;c<i;c++){const u=n.data[c],h=Es(u);h&&Hb(t,e,u);const p=Fs(t,n,c,e);Di(p,t),null!==o&&aB(0,c-s,p,u,0,o),h&&(Ii(e.index,t)[8]=p)}}(n,t,e,s2(e,t)),128==(128&e.flags)&&function Db(n,t,e){const r=e.directiveStart,s=e.directiveEnd,i=e.index,o=function yh(){return cn.lFrame.currentDirectiveIndex}();try{c3(i);for(let c=r;c<s;c++){const u=n.data[c],h=t[c];a3(c),(null!==u.hostBindings||0!==u.hostVars||null!==u.hostAttrs)&&zb(u,h)}}finally{c3(-1),a3(o)}}(n,t,e))}function h0(n,t,e=s2){const r=t.localNames;if(null!==r){let s=t.index+1;for(let i=0;i<r.length;i+=2){const o=r[i+1],c=-1===o?e(t,n):n[o];n[s++]=c}}}function AC(n){const t=n.tView;return null===t||t.incompleteFirstPass?n.tView=IC(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts):t}function IC(n,t,e,r,s,i,o,c,u,h){const p=22+r,m=p+s,C=function xb(n,t){const e=[];for(let r=0;r<t;r++)e.push(r<n?null:hn);return e}(p,m),w="function"==typeof h?h():h;return C[1]={type:n,blueprint:C,template:e,queries:null,viewQuery:c,declTNode:t,data:C.slice().fill(null,p),bindingStartIndex:p,expandoStartIndex:m,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof i?i():i,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:u,consts:w,incompleteFirstPass:!1}}function Lb(n,t,e,r){const s=FC(t);null===e?s.push(r):(s.push(e),n.firstCreatePass&&BC(n).push(r,s.length-1))}function d0(n,t,e){for(let r in n)if(n.hasOwnProperty(r)){const s=n[r];(e=null===e?{}:e).hasOwnProperty(r)?e[r].push(t,s):e[r]=[t,s]}return e}function Y7(n,t){const r=t.directiveEnd,s=n.data,i=t.attrs,o=[];let c=null,u=null;for(let h=t.directiveStart;h<r;h++){const p=s[h],m=p.inputs,C=null===i||uu(t)?null:Fb(m,i);o.push(C),c=d0(m,h,c),u=d0(p.outputs,h,u)}null!==c&&(c.hasOwnProperty("class")&&(t.flags|=16),c.hasOwnProperty("style")&&(t.flags|=32)),t.initialInputs=o,t.inputs=c,t.outputs=u}function Eo(n,t,e,r,s,i,o,c){const u=s2(t,e);let p,h=t.inputs;!c&&null!=h&&(p=h[r])?(ef(n,e,p,r,s),Ko(t)&&xC(e,t.index)):3&t.type&&(r=function K7(n){return"class"===n?"className":"for"===n?"htmlFor":"formaction"===n?"formAction":"innerHtml"===n?"innerHTML":"readonly"===n?"readOnly":"tabindex"===n?"tabIndex":n}(r),s=null!=o?o(s,t.value||"",r):s,i.setProperty(u,r,s))}function xC(n,t){const e=Ii(t,n);16&e[2]||(e[2]|=32)}function wl(n,t,e,r){let s=!1;if(_h()){const i=function LC(n,t,e){const r=n.directiveRegistry;let s=null;if(r)for(let i=0;i<r.length;i++){const o=r[i];aC(e,o.selectors,!1)&&(s||(s=[]),U6(i7(e,t),n,o.type),Es(o)?(qd(n,e),s.unshift(o)):s.push(o))}return s}(n,t,e),o=null===r?null:{"":-1};if(null!==i){s=!0,RC(e,n.data.length,i.length);for(let p=0;p<i.length;p++){const m=i[p];m.providersResolver&&m.providersResolver(m)}let c=!1,u=!1,h=Tl(n,t,i.length,null);for(let p=0;p<i.length;p++){const m=i[p];e.mergedAttrs=$6(e.mergedAttrs,m.hostAttrs),DC(n,e,t,h,m),oB(h,m,o),null!==m.contentQueries&&(e.flags|=8),(null!==m.hostBindings||null!==m.hostAttrs||0!==m.hostVars)&&(e.flags|=128);const C=m.type.prototype;!c&&(C.ngOnChanges||C.ngOnInit||C.ngDoCheck)&&((n.preOrderHooks||(n.preOrderHooks=[])).push(e.index),c=!0),!u&&(C.ngOnChanges||C.ngDoCheck)&&((n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(e.index),u=!0),h++}Y7(n,e)}o&&function Vb(n,t,e){if(t){const r=n.localNames=[];for(let s=0;s<t.length;s+=2){const i=e[t[s+1]];if(null==i)throw new Ae(-301,!1);r.push(t[s],i)}}}(e,r,o)}return e.mergedAttrs=$6(e.mergedAttrs,e.attrs),s}function X7(n,t,e,r,s,i){const o=i.hostBindings;if(o){let c=n.hostBindingOpCodes;null===c&&(c=n.hostBindingOpCodes=[]);const u=~t.index;(function Rb(n){let t=n.length;for(;t>0;){const e=n[--t];if("number"==typeof e&&e<0)return e}return 0})(c)!=u&&c.push(u),c.push(r,s,o)}}function zb(n,t){null!==n.hostBindings&&n.hostBindings(1,t)}function qd(n,t){t.flags|=2,(n.components||(n.components=[])).push(t.index)}function oB(n,t,e){if(e){if(t.exportAs)for(let r=0;r<t.exportAs.length;r++)e[t.exportAs[r]]=n;Es(t)&&(e[""]=n)}}function RC(n,t,e){n.flags|=1,n.directiveStart=t,n.directiveEnd=t+e,n.providerIndexes=t}function DC(n,t,e,r,s){n.data[r]=s;const i=s.factory||(s.factory=Pa(s.type)),o=new L8(i,Es(s),J);n.blueprint[r]=o,e[r]=o,X7(n,t,0,r,Tl(n,e,s.hostVars,hn),s)}function Hb(n,t,e){const r=s2(t,n),s=AC(e),i=n[10],o=Q7(n,W7(n,s,null,e.onPush?32:16,r,t,i,i.createRenderer(r,e),null,null,null));n[t.index]=o}function Cc(n,t,e,r,s,i){const o=s2(n,t);jd(t[11],o,i,n.value,e,r,s)}function jd(n,t,e,r,s,i,o){if(null==i)n.removeAttribute(t,s,e);else{const c=null==o?rn(i):o(i,r||"",s);n.setAttribute(t,s,c,e)}}function aB(n,t,e,r,s,i){const o=i[t];if(null!==o){const c=r.setInput;for(let u=0;u<o.length;){const h=o[u++],p=o[u++],m=o[u++];null!==c?r.setInput(e,m,h,p):e[p]=m}}}function Fb(n,t){let e=null,r=0;for(;r<t.length;){const s=t[r];if(0!==s)if(5!==s){if("number"==typeof s)break;n.hasOwnProperty(s)&&(null===e&&(e=[]),e.push(s,n[s],t[r+1])),r+=2}else r+=2;else r+=4}return e}function zC(n,t,e,r){return new Array(n,!0,!1,t,null,0,r,e,null,null)}function $b(n,t){const e=Ii(t,n);if(z6(e)){const r=e[1];48&e[2]?Z7(r,e,r.template,e[8]):e[5]>0&&Zd(e)}}function Zd(n){for(let r=dd(n);null!==r;r=pd(r))for(let s=10;s<r.length;s++){const i=r[s];if(z6(i))if(512&i[2]){const o=i[1];Z7(o,i,o.template,i[8])}else i[5]>0&&Zd(i)}const e=n[1].components;if(null!==e)for(let r=0;r<e.length;r++){const s=Ii(e[r],n);z6(s)&&s[5]>0&&Zd(s)}}function lB(n,t){const e=Ii(t,n),r=e[1];(function Ub(n,t){for(let e=t.length;e<n.blueprint.length;e++)t.push(n.blueprint[e])})(r,e),j7(r,e,e[8])}function Q7(n,t){return n[13]?n[14][4]=t:n[13]=t,n[14]=t,t}function VC(n){for(;n;){n[2]|=32;const t=ou(n);if(L6(n)&&!t)return n;n=t}return null}function J7(n,t,e,r=!0){const s=t[10];s.begin&&s.begin();try{Z7(n,t,n.template,e)}catch(o){throw r&&UC(t,o),o}finally{s.end&&s.end()}}function Yd(n,t,e){N8(0),t(n,e)}function FC(n){return n[7]||(n[7]=[])}function BC(n){return n.cleanup||(n.cleanup=[])}function UC(n,t){const e=n[9],r=e?e.get(o0,null):null;r&&r.handleError(t)}function ef(n,t,e,r,s){for(let i=0;i<e.length;){const o=e[i++],c=e[i++],u=t[o],h=n.data[o];null!==h.setInput?h.setInput(u,s,r,c):u[c]=s}}function E3(n,t,e){const r=b8(t,n);Gv(n[11],r,e)}function hu(n,t,e){let r=e?n.styles:null,s=e?n.classes:null,i=0;if(null!==t)for(let o=0;o<t.length;o++){const c=t[o];"number"==typeof c?i=c:1==i?s=C8(s,c):2==i&&(r=C8(r,c+": "+t[++o]+";"))}e?n.styles=r:n.stylesWithoutHost=r,e?n.classes=s:n.classesWithoutHost=s}function tf(n,t,e,r,s=!1){for(;null!==e;){const i=t[e.index];if(null!==i&&r.push(Sr(i)),Mr(i))for(let c=10;c<i.length;c++){const u=i[c],h=u[1].firstChild;null!==h&&tf(u[1],u,h,r)}const o=e.type;if(8&o)tf(n,t,e.child,r);else if(32&o){const c=hd(e,t);let u;for(;u=c();)r.push(u)}else if(16&o){const c=Ml(t,e);if(Array.isArray(c))r.push(...c);else{const u=ou(t[16]);tf(u[1],u,c,r,!0)}}e=s?e.projectionNext:e.next}return r}class nf{constructor(t,e){this._lView=t,this._cdRefInjectingView=e,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const t=this._lView,e=t[1];return tf(e,t,e.firstChild,[])}get context(){return this._lView[8]}set context(t){this._lView[8]=t}get destroyed(){return 128==(128&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const t=this._lView[3];if(Mr(t)){const e=t[8],r=e?e.indexOf(this):-1;r>-1&&(_d(t,r),Y6(e,r))}this._attachedToViewContainer=!1}qv(this._lView[1],this._lView)}onDestroy(t){Lb(this._lView[1],this._lView,null,t)}markForCheck(){VC(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-65}reattach(){this._lView[2]|=64}detectChanges(){J7(this._lView[1],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new Ae(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function Yw(n,t){l0(n,t,t[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(t){if(this._attachedToViewContainer)throw new Ae(902,!1);this._appRef=t}}class Wb extends nf{constructor(t){super(t),this._view=t}detectChanges(){const t=this._view;J7(t[1],t,t[8],!1)}checkNoChanges(){}get context(){return null}}class Kd extends Ia{constructor(t){super(),this.ngModule=t}resolveComponentFactory(t){const e=P1(t);return new du(e,this.ngModule)}}function qb(n){const t=[];for(let e in n)n.hasOwnProperty(e)&&t.push({propName:n[e],templateName:e});return t}class WC{constructor(t,e){this.injector=t,this.parentInjector=e}get(t,e,r){const s=this.injector.get(t,id,r);return s!==id||e===id?s:this.parentInjector.get(t,e,r)}}class du extends Ov{constructor(t,e){super(),this.componentDef=t,this.ngModule=e,this.componentType=t.type,this.selector=function ob(n){return n.map(ib).join(",")}(t.selectors),this.ngContentSelectors=t.ngContentSelectors?t.ngContentSelectors:[],this.isBoundToModule=!!e}get inputs(){return qb(this.componentDef.inputs)}get outputs(){return qb(this.componentDef.outputs)}create(t,e,r,s){let i=(s=s||this.ngModule)instanceof Aa?s:s?.injector;i&&null!==this.componentDef.getStandaloneInjector&&(i=this.componentDef.getStandaloneInjector(i)||i);const o=i?new WC(t,i):t,c=o.get(r0,null);if(null===c)throw new Ae(407,!1);const u=o.get(NF,null),h=c.createRenderer(null,this.componentDef),p=this.componentDef.selectors[0][0]||"div",m=r?function kb(n,t,e){return n.selectRootElement(t,e===z1.ShadowDom)}(h,r,this.componentDef.encapsulation):md(h,p,function GC(n){const t=n.toLowerCase();return"svg"===t?"svg":"math"===t?"math":null}(p)),C=this.componentDef.onPush?288:272,w=IC(0,null,null,1,0,null,null,null,null,null),I=W7(null,w,null,C,null,null,c,h,u,o,null);let H,K;al(I);try{const ie=function Zb(n,t,e,r,s,i){const o=e[1];e[22]=n;const u=f0(o,22,2,"#host",null),h=u.mergedAttrs=t.hostAttrs;null!==h&&(hu(u,h,!0),null!==n&&(pc(s,n,h),null!==u.classes&&R7(s,n,u.classes),null!==u.styles&&lu(s,n,u.styles)));const p=r.createRenderer(n,t),m=W7(e,AC(t),null,t.onPush?32:16,e[22],u,r,p,i||null,null,null);return o.firstCreatePass&&(U6(i7(u,e),o,t.type),qd(o,u),RC(u,e.length,1)),Q7(e,m),e[22]=m}(m,this.componentDef,I,c,h);if(m)if(r)pc(h,m,["ng-version",Nv.full]);else{const{attrs:ye,classes:te}=function uC(n){const t=[],e=[];let r=1,s=2;for(;r<n.length;){let i=n[r];if("string"==typeof i)2===s?""!==i&&t.push(i,n[++r]):8===s&&e.push(i);else{if(!ka(s))break;s=i}r++}return{attrs:t,classes:e}}(this.componentDef.selectors[0]);ye&&pc(h,m,ye),te&&te.length>0&&R7(h,m,te.join(" "))}if(K=gh(w,22),void 0!==e){const ye=K.projection=[];for(let te=0;te<this.ngContentSelectors.length;te++){const ke=e[te];ye.push(null!=ke?Array.from(ke):null)}}H=function jC(n,t,e,r){const s=e[1],i=function iB(n,t,e){const r=Rr();n.firstCreatePass&&(e.providersResolver&&e.providersResolver(e),DC(n,r,t,Tl(n,t,1,null),e),Y7(n,r));const s=Fs(t,n,r.directiveStart,r);Di(s,t);const i=s2(r,t);return i&&Di(i,t),s}(s,e,t);if(n[8]=e[8]=i,null!==r)for(const c of r)c(i,t);if(t.contentQueries){const c=Rr();t.contentQueries(1,i,c.directiveStart)}const o=Rr();return!s.firstCreatePass||null===t.hostBindings&&null===t.hostAttrs||(c3(o.index),X7(e[1],o,0,o.directiveStart,o.directiveEnd,t),zb(t,i)),i}(ie,this.componentDef,I,[d]),j7(w,I,null)}finally{cl()}return new jb(this.componentType,H,n0(K,I),I,K)}}class jb extends class pw{}{constructor(t,e,r,s,i){super(),this.location=r,this._rootLView=s,this._tNode=i,this.instance=e,this.hostView=this.changeDetectorRef=new Wb(s),this.componentType=t}setInput(t,e){const r=this._tNode.inputs;let s;if(null!==r&&(s=r[t])){const i=this._rootLView;ef(i[1],i,s,t,e),xC(i,this._tNode.index)}}get injector(){return new G6(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(t){this.hostView.onDestroy(t)}}function d(){const n=Rr();f3(Re()[1],n)}function l(n){let t=function a(n){return Object.getPrototypeOf(n.prototype).constructor}(n.type),e=!0;const r=[n];for(;t;){let s;if(Es(n))s=t.\u0275cmp||t.\u0275dir;else{if(t.\u0275cmp)throw new Ae(903,!1);s=t.\u0275dir}if(s){if(e){r.push(s);const o=n;o.inputs=g(n.inputs),o.declaredInputs=g(n.declaredInputs),o.outputs=g(n.outputs);const c=s.hostBindings;c&&N(n,c);const u=s.viewQuery,h=s.contentQueries;if(u&&_(n,u),h&&y(n,h),J9(n.inputs,s.inputs),J9(n.declaredInputs,s.declaredInputs),J9(n.outputs,s.outputs),Es(s)&&s.data.animation){const p=n.data;p.animation=(p.animation||[]).concat(s.data.animation)}}const i=s.features;if(i)for(let o=0;o<i.length;o++){const c=i[o];c&&c.ngInherit&&c(n),c===l&&(e=!1)}}t=Object.getPrototypeOf(t)}!function f(n){let t=0,e=null;for(let r=n.length-1;r>=0;r--){const s=n[r];s.hostVars=t+=s.hostVars,s.hostAttrs=$6(s.hostAttrs,e=$6(e,s.hostAttrs))}}(r)}function g(n){return n===Y?{}:n===C1?[]:n}function _(n,t){const e=n.viewQuery;n.viewQuery=e?(r,s)=>{t(r,s),e(r,s)}:t}function y(n,t){const e=n.contentQueries;n.contentQueries=e?(r,s,i)=>{t(r,s,i),e(r,s,i)}:t}function N(n,t){const e=n.hostBindings;n.hostBindings=e?(r,s)=>{t(r,s),e(r,s)}:t}let se=null;function we(){if(!se){const n=er.Symbol;if(n&&n.iterator)se=n.iterator;else{const t=Object.getOwnPropertyNames(Map.prototype);for(let e=0;e<t.length;++e){const r=t[e];"entries"!==r&&"size"!==r&&Map.prototype[r]===Map.prototype.entries&&(se=r)}}}return se}function Ve(n){return!!vt(n)&&(Array.isArray(n)||!(n instanceof Map)&&we()in n)}function vt(n){return null!==n&&("function"==typeof n||"object"==typeof n)}function mn(n,t,e){return n[t]=e}function x1(n,t,e){return!Object.is(n[t],e)&&(n[t]=e,!0)}function g2(n,t,e,r){const s=x1(n,t,e);return x1(n,t+1,r)||s}function D(n,t,e,r){const s=Re();return x1(s,H6(),t)&&(Xn(),Cc(T1(),s,n,t,e,r)),D}function p1(n,t,e,r){return x1(n,H6(),e)?t+rn(e)+r:hn}function Bs(n,t,e,r,s,i){const c=g2(n,dc(),e,s);return Jo(2),c?t+rn(e)+r+rn(s)+i:hn}function sa(n,t,e,r,s,i,o,c){const h=function Da(n,t,e,r,s){const i=g2(n,t,e,r);return x1(n,t+2,s)||i}(n,dc(),e,s,o);return Jo(3),h?t+rn(e)+r+rn(s)+i+rn(o)+c:hn}function pu(n,t,e,r,s,i){const o=Re(),c=p1(o,t,e,r);return c!==hn&&Cc(T1(),o,n,c,s,i),pu}function x(n,t,e,r,s,i,o,c){const u=Re(),h=Xn(),p=n+22,m=h.firstCreatePass?function y4e(n,t,e,r,s,i,o,c,u){const h=t.consts,p=f0(t,n,4,o||null,o3(h,c));wl(t,e,p,o3(h,u)),f3(t,p);const m=p.tViews=IC(2,p,r,s,i,t.directiveRegistry,t.pipeRegistry,null,t.schemas,h);return null!==t.queries&&(t.queries.template(t,p),m.queries=t.queries.embeddedTView(p)),p}(p,h,u,t,e,r,s,i,o):h.data[p];hc(m,!1);const C=u[11].createComment("");au(h,u,C,m),Di(C,u),Q7(u,u[p]=zC(C,u,C,m)),Xo(m)&&Wd(h,u,m),null!=o&&h0(u,m,c)}function Qn(n){return il(function e7(){return cn.lFrame.contextLView}(),22+n)}function T(n,t,e){const r=Re();return x1(r,H6(),t)&&Eo(Xn(),T1(),r,n,t,r[11],e,!1),T}function Yb(n,t,e,r,s){const o=s?"class":"style";ef(n,e,t.inputs[o],o,r)}function b(n,t,e,r){const s=Re(),i=Xn(),o=22+n,c=s[11],u=s[o]=md(c,t,function u3(){return cn.lFrame.currentNamespace}()),h=i.firstCreatePass?function M4e(n,t,e,r,s,i,o){const c=t.consts,h=f0(t,n,2,s,o3(c,i));return wl(t,e,h,o3(c,o)),null!==h.attrs&&hu(h,h.attrs,!1),null!==h.mergedAttrs&&hu(h,h.mergedAttrs,!0),null!==t.queries&&t.queries.elementStart(t,h),h}(o,i,s,0,t,e,r):i.data[o];hc(h,!0);const p=h.mergedAttrs;null!==p&&pc(c,u,p);const m=h.classes;null!==m&&R7(c,u,m);const C=h.styles;return null!==C&&lu(c,u,C),64!=(64&h.flags)&&au(i,s,u,h),0===function bT(){return cn.lFrame.elementDepthCount}()&&Di(u,s),function OT(){cn.lFrame.elementDepthCount++}(),Xo(h)&&(Wd(i,s,h),NC(i,h,s)),null!==r&&h0(s,h),b}function O(){let n=Rr();Zr()?vh():(n=n.parent,hc(n,!1));const t=n;!function NT(){cn.lFrame.elementDepthCount--}();const e=Xn();return e.firstCreatePass&&(f3(e,n),W2(n)&&e.queries.elementEnd(n)),null!=t.classesWithoutHost&&function Ph(n){return 0!=(16&n.flags)}(t)&&Yb(e,t,Re(),t.classesWithoutHost,!0),null!=t.stylesWithoutHost&&function R8(n){return 0!=(32&n.flags)}(t)&&Yb(e,t,Re(),t.stylesWithoutHost,!1),O}function Q(n,t,e,r){return b(n,t,e,r),O(),Q}function un(n,t,e){const r=Re(),s=Xn(),i=n+22,o=s.firstCreatePass?function S4e(n,t,e,r,s){const i=t.consts,o=o3(i,r),c=f0(t,n,8,"ng-container",o);return null!==o&&hu(c,o,!0),wl(t,e,c,o3(i,s)),null!==t.queries&&t.queries.elementStart(t,c),c}(i,s,r,t,e):s.data[i];hc(o,!0);const c=r[i]=r[11].createComment("");return au(s,r,c,o),Di(c,r),Xo(o)&&(Wd(s,r,o),NC(s,o,r)),null!=e&&h0(r,o),un}function fn(){let n=Rr();const t=Xn();return Zr()?vh():(n=n.parent,hc(n,!1)),t.firstCreatePass&&(f3(t,n),W2(n)&&t.queries.elementEnd(n)),fn}function Oe(){return Re()}function Xd(n){return!!n&&"function"==typeof n.then}const Kb=function EB(n){return!!n&&"function"==typeof n.subscribe};function ee(n,t,e,r){const s=Re(),i=Xn(),o=Rr();return function SB(n,t,e,r,s,i,o,c){const u=Xo(r),p=n.firstCreatePass&&BC(n),m=t[8],C=FC(t);let w=!0;if(3&r.type||c){const K=s2(r,t),ie=c?c(K):K,ye=C.length,te=c?$e=>c(Sr($e[r.index])):r.index;let ke=null;if(!c&&u&&(ke=function P4e(n,t,e,r){const s=n.cleanup;if(null!=s)for(let i=0;i<s.length-1;i+=2){const o=s[i];if(o===e&&s[i+1]===r){const c=t[7],u=s[i+2];return c.length>u?c[u]:null}"string"==typeof o&&(i+=2)}return null}(n,t,s,r.index)),null!==ke)(ke.__ngLastListenerFn__||ke).__ngNextListenerFn__=i,ke.__ngLastListenerFn__=i,w=!1;else{i=TB(r,t,m,i,!1);const $e=e.listen(ie,s,i);C.push(i,$e),p&&p.push(s,te,ye,ye+1)}}else i=TB(r,t,m,i,!1);const I=r.outputs;let H;if(w&&null!==I&&(H=I[s])){const K=H.length;if(K)for(let ie=0;ie<K;ie+=2){const Xe=t[H[ie]][H[ie+1]].subscribe(i),Ft=C.length;C.push(i,Xe),p&&p.push(s,r.index,Ft,-(Ft+1))}}}(i,s,s[11],o,n,t,0,r),ee}function PB(n,t,e,r){try{return!1!==e(r)}catch(s){return UC(n,s),!1}}function TB(n,t,e,r,s){return function i(o){if(o===Function)return r;VC(2&n.flags?Ii(n.index,t):t);let u=PB(t,0,r,o),h=i.__ngNextListenerFn__;for(;h;)u=PB(t,0,h,o)&&u,h=h.__ngNextListenerFn__;return s&&!1===u&&(o.preventDefault(),o.returnValue=!1),u}}function v(n=1){return function r7(n){return(cn.lFrame.contextLView=function I8(n,t){for(;n>0;)t=t[15],n--;return t}(n,cn.lFrame.contextLView))[8]}(n)}function T4e(n,t){let e=null;const r=function cC(n){const t=n.attrs;if(null!=t){const e=t.indexOf(5);if(0==(1&e))return t[e+1]}return null}(n);for(let s=0;s<t.length;s++){const i=t[s];if("*"!==i){if(null===r?aC(n,i,!0):lC(r,i))return s}else e=s}return e}function Xb(n,t,e){return y1(n,"",t,"",e),Xb}function y1(n,t,e,r,s){const i=Re(),o=p1(i,t,e,r);return o!==hn&&Eo(Xn(),T1(),i,n,o,i[11],s,!1),y1}function We(n,t,e,r,s,i,o){const c=Re(),u=Bs(c,t,e,r,s,i);return u!==hn&&Eo(Xn(),T1(),c,n,u,c[11],o,!1),We}function j2(n,t,e,r,s,i,o,c,u){const h=Re(),p=sa(h,t,e,r,s,i,o,c);return p!==hn&&Eo(Xn(),T1(),h,n,p,h[11],u,!1),j2}function LB(n,t,e,r,s){const i=n[e+1],o=null===t;let c=r?La(i):vc(i),u=!1;for(;0!==c&&(!1===u||o);){const p=n[c+1];O4e(n[c],t)&&(u=!0,n[c+1]=r?zd(p):Dd(p)),c=r?La(p):vc(p)}u&&(n[e+1]=r?Dd(i):zd(i))}function O4e(n,t){return null===n||null==t||(Array.isArray(n)?n[1]:n)===t||!(!Array.isArray(n)||"string"!=typeof t)&&u2(n,t)>=0}const hi={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function RB(n){return n.substring(hi.key,hi.keyEnd)}function N4e(n){return n.substring(hi.value,hi.valueEnd)}function zB(n,t){const e=hi.textEnd;let r=hi.key=rf(n,t,e);return e===r?-1:(r=hi.keyEnd=function k4e(n,t,e){let r;for(;t<e&&(45===(r=n.charCodeAt(t))||95===r||(-33&r)>=65&&(-33&r)<=90||r>=48&&r<=57);)t++;return t}(n,r,e),r=HB(n,r,e),r=hi.value=rf(n,r,e),r=hi.valueEnd=function L4e(n,t,e){let r=-1,s=-1,i=-1,o=t,c=o;for(;o<e;){const u=n.charCodeAt(o++);if(59===u)return c;34===u||39===u?c=o=FB(n,u,o,e):t===o-4&&85===i&&82===s&&76===r&&40===u?c=o=FB(n,41,o,e):u>32&&(c=o),i=s,s=r,r=-33&u}return c}(n,r,e),HB(n,r,e))}function rf(n,t,e){for(;t<e&&n.charCodeAt(t)<=32;)t++;return t}function HB(n,t,e,r){return(t=rf(n,t,e))<e&&t++,t}function FB(n,t,e,r){let s=-1,i=e;for(;i<r;){const o=n.charCodeAt(i++);if(o==t&&92!==s)return i;s=92==o&&92===s?0:o}throw new Error}function ZC(n,t){return function M3(n,t,e,r){const s=Re(),i=Xn(),o=Jo(2);i.firstUpdatePass&&UB(i,n,o,r),t!==hn&&x1(s,o,t)&&WB(i,i.data[a2()],s,s[11],n,s[o+1]=function U4e(n,t){return null==n||("string"==typeof t?n+=t:"object"==typeof n&&(n=Y1(mo(n)))),n}(t,e),r,o)}(n,t,null,!0),ZC}function _2(n){!function S3(n,t,e,r){const s=Xn(),i=Jo(2);s.firstUpdatePass&&UB(s,null,i,r);const o=Re();if(e!==hn&&x1(o,i,e)){const c=s.data[a2()];if(jB(c,r)&&!$B(s,i)){let u=r?c.classesWithoutHost:c.stylesWithoutHost;null!==u&&(e=C8(u,e||"")),Yb(s,c,o,e,r)}else!function $4e(n,t,e,r,s,i,o,c){s===hn&&(s=C1);let u=0,h=0,p=0<s.length?s[0]:null,m=0<i.length?i[0]:null;for(;null!==p||null!==m;){const C=u<s.length?s[u+1]:void 0,w=h<i.length?i[h+1]:void 0;let H,I=null;p===m?(u+=2,h+=2,C!==w&&(I=m,H=w)):null===m||null!==p&&p<m?(u+=2,I=p):(h+=2,I=m,H=w),null!==I&&WB(n,t,e,r,I,H,o,c),p=u<s.length?s[u]:null,m=h<i.length?i[h]:null}}(s,c,o,o[11],o[i+1],o[i+1]=function B4e(n,t,e){if(null==e||""===e)return C1;const r=[],s=mo(e);if(Array.isArray(s))for(let i=0;i<s.length;i++)n(r,s[i],!0);else if("object"==typeof s)for(const i in s)s.hasOwnProperty(i)&&n(r,i,s[i]);else"string"==typeof s&&t(r,s);return r}(n,t,e),r,i)}}(GB,R4e,n,!1)}function R4e(n,t){for(let e=function I4e(n){return function VB(n){hi.key=0,hi.keyEnd=0,hi.value=0,hi.valueEnd=0,hi.textEnd=n.length}(n),zB(n,rf(n,0,hi.textEnd))}(t);e>=0;e=zB(t,e))GB(n,RB(t),N4e(t))}function $B(n,t){return t>=n.expandoStartIndex}function UB(n,t,e,r){const s=n.data;if(null===s[e+1]){const i=s[a2()],o=$B(n,e);jB(i,r)&&null===t&&!o&&(t=!1),t=function z4e(n,t,e,r){const s=function t7(n){const t=cn.lFrame.currentDirectiveIndex;return-1===t?null:n[t]}(n);let i=r?t.residualClasses:t.residualStyles;if(null===s)0===(r?t.classBindings:t.styleBindings)&&(e=Qd(e=Qb(null,n,t,e,r),t.attrs,r),i=null);else{const o=t.directiveStylingLast;if(-1===o||n[o]!==s)if(e=Qb(s,n,t,e,r),null===i){let u=function V4e(n,t,e){const r=e?t.classBindings:t.styleBindings;if(0!==vc(r))return n[La(r)]}(n,t,r);void 0!==u&&Array.isArray(u)&&(u=Qb(null,n,t,u[1],r),u=Qd(u,t.attrs,r),function H4e(n,t,e,r){n[La(e?t.classBindings:t.styleBindings)]=r}(n,t,r,u))}else i=function F4e(n,t,e){let r;const s=t.directiveEnd;for(let i=1+t.directiveStylingLast;i<s;i++)r=Qd(r,n[i].hostAttrs,e);return Qd(r,t.attrs,e)}(n,t,r)}return void 0!==i&&(r?t.residualClasses=i:t.residualStyles=i),e}(s,i,t,r),function w4e(n,t,e,r,s,i){let o=i?t.classBindings:t.styleBindings,c=La(o),u=vc(o);n[r]=e;let p,h=!1;if(Array.isArray(e)){const m=e;p=m[1],(null===p||u2(m,p)>0)&&(h=!0)}else p=e;if(s)if(0!==u){const C=La(n[c+1]);n[r+1]=F7(C,c),0!==C&&(n[C+1]=Pl(n[C+1],r)),n[c+1]=function GF(n,t){return 131071&n|t<<17}(n[c+1],r)}else n[r+1]=F7(c,0),0!==c&&(n[c+1]=Pl(n[c+1],r)),c=r;else n[r+1]=F7(u,0),0===c?c=r:n[u+1]=Pl(n[u+1],r),u=r;h&&(n[r+1]=Dd(n[r+1])),LB(n,p,r,!0),LB(n,p,r,!1),function b4e(n,t,e,r,s){const i=s?n.residualClasses:n.residualStyles;null!=i&&"string"==typeof t&&u2(i,t)>=0&&(e[r+1]=zd(e[r+1]))}(t,p,n,r,i),o=F7(c,u),i?t.classBindings=o:t.styleBindings=o}(s,i,t,e,o,r)}}function Qb(n,t,e,r,s){let i=null;const o=e.directiveEnd;let c=e.directiveStylingLast;for(-1===c?c=e.directiveStart:c++;c<o&&(i=t[c],r=Qd(r,i.hostAttrs,s),i!==n);)c++;return null!==n&&(e.directiveStylingLast=c),r}function Qd(n,t,e){const r=e?1:2;let s=-1;if(null!==t)for(let i=0;i<t.length;i++){const o=t[i];"number"==typeof o?s=o:s===r&&(Array.isArray(n)||(n=void 0===n?[]:["",n]),l2(n,o,!!e||t[++i]))}return void 0===n?null:n}function GB(n,t,e){l2(n,t,mo(e))}function WB(n,t,e,r,s,i,o,c){if(!(3&t.type))return;const u=n.data,h=u[c+1];YC(function EC(n){return 1==(1&n)}(h)?qB(u,t,e,s,vc(h),o):void 0)||(YC(i)||function Cb(n){return 2==(2&n)}(h)&&(i=qB(u,null,e,s,c,o)),function nC(n,t,e,r,s){if(t)s?n.addClass(e,r):n.removeClass(e,r);else{let i=-1===r.indexOf("-")?void 0:p2.DashCase;null==s?n.removeStyle(e,r,i):("string"==typeof s&&s.endsWith("!important")&&(s=s.slice(0,-10),i|=p2.Important),n.setStyle(e,r,s,i))}}(r,o,b8(a2(),e),s,i))}function qB(n,t,e,r,s,i){const o=null===t;let c;for(;s>0;){const u=n[s],h=Array.isArray(u),p=h?u[1]:u,m=null===p;let C=e[s+1];C===hn&&(C=m?C1:void 0);let w=m?ci(C,r):p===r?C:void 0;if(h&&!YC(w)&&(w=ci(u,r)),YC(w)&&(c=w,o))return c;const I=n[s+1];s=o?La(I):vc(I)}if(null!==t){let u=i?t.residualClasses:t.residualStyles;null!=u&&(c=ci(u,r))}return c}function YC(n){return void 0!==n}function jB(n,t){return 0!=(n.flags&(t?16:32))}function Tt(n,t=""){const e=Re(),r=Xn(),s=n+22,i=r.firstCreatePass?f0(r,s,1,t,null):r.data[s],o=e[s]=gd(e[11],t);au(r,e,o,i),hc(i,!1)}function l1(n){return Z2("",n,""),l1}function Z2(n,t,e){const r=Re(),s=p1(r,n,t,e);return s!==hn&&E3(r,a2(),s),Z2}function KC(n,t,e,r,s){const i=Re(),o=Bs(i,n,t,e,r,s);return o!==hn&&E3(i,a2(),o),KC}function Jb(n,t,e,r,s,i,o){const c=Re(),u=sa(c,n,t,e,r,s,i,o);return u!==hn&&E3(c,a2(),u),Jb}function eO(n,t,e){const r=Re();return x1(r,H6(),t)&&Eo(Xn(),T1(),r,n,t,r[11],e,!0),eO}const gu=void 0;var lle=["en",[["a","p"],["AM","PM"],gu],[["AM","PM"],gu,gu],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],gu,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],gu,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",gu,"{1} 'at' {0}",gu],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function cle(n){const e=Math.floor(Math.abs(n)),r=n.toString().replace(/^[^.]*\.?/,"").length;return 1===e&&0===r?1:5}];let sf={};function Po(n){const t=function fle(n){return n.toLowerCase().replace(/_/g,"-")}(n);let e=f$(t);if(e)return e;const r=t.split("-")[0];if(e=f$(r),e)return e;if("en"===r)return lle;throw new Ae(701,!1)}function f$(n){return n in sf||(sf[n]=er.ng&&er.ng.common&&er.ng.common.locales&&er.ng.common.locales[n]),sf[n]}var _t=(()=>((_t=_t||{})[_t.LocaleId=0]="LocaleId",_t[_t.DayPeriodsFormat=1]="DayPeriodsFormat",_t[_t.DayPeriodsStandalone=2]="DayPeriodsStandalone",_t[_t.DaysFormat=3]="DaysFormat",_t[_t.DaysStandalone=4]="DaysStandalone",_t[_t.MonthsFormat=5]="MonthsFormat",_t[_t.MonthsStandalone=6]="MonthsStandalone",_t[_t.Eras=7]="Eras",_t[_t.FirstDayOfWeek=8]="FirstDayOfWeek",_t[_t.WeekendRange=9]="WeekendRange",_t[_t.DateFormat=10]="DateFormat",_t[_t.TimeFormat=11]="TimeFormat",_t[_t.DateTimeFormat=12]="DateTimeFormat",_t[_t.NumberSymbols=13]="NumberSymbols",_t[_t.NumberFormats=14]="NumberFormats",_t[_t.CurrencyCode=15]="CurrencyCode",_t[_t.CurrencySymbol=16]="CurrencySymbol",_t[_t.CurrencyName=17]="CurrencyName",_t[_t.Currencies=18]="Currencies",_t[_t.Directionality=19]="Directionality",_t[_t.PluralCase=20]="PluralCase",_t[_t.ExtraData=21]="ExtraData",_t))();const hle=["zero","one","two","few","many"],af="en-US",XC={marker:"element"},QC={marker:"ICU"};var us=(()=>((us=us||{})[us.SHIFT=2]="SHIFT",us[us.APPEND_EAGERLY=1]="APPEND_EAGERLY",us[us.COMMENT=2]="COMMENT",us))();let h$=af;function d$(n){(function fo(n,t){null==n&&S1(t,n,null,"!=")})(n,"Expected localeId to be defined"),"string"==typeof n&&(h$=n.toLowerCase().replace(/_/g,"-"))}function p$(n,t,e){const r=t.insertBeforeIndex,s=Array.isArray(r)?r[0]:r;return null===s?Qv(n,0,e):Sr(e[s])}function g$(n,t,e,r,s){const i=t.insertBeforeIndex;if(Array.isArray(i)){let o=r,c=null;if(3&t.type||(c=o,o=s),null!==o&&0==(2&t.flags))for(let u=1;u<i.length;u++)v3(n,o,e[i[u]],c,!1)}}function m$(n,t){if(n.push(t),n.length>1)for(let e=n.length-2;e>=0;e--){const r=n[e];_$(r)||mle(r,t)&&null===_le(r)&&vle(r,t.index)}}function _$(n){return!(64&n.type)}function mle(n,t){return _$(t)||n.index>t.index}function _le(n){const t=n.insertBeforeIndex;return Array.isArray(t)?t[0]:t}function vle(n,t){const e=n.insertBeforeIndex;Array.isArray(e)?e[0]=t:(L7(p$,g$),n.insertBeforeIndex=t)}function Jd(n,t){const e=n.data[t];return null===e||"string"==typeof e?null:e.hasOwnProperty("currentCaseLViewIndex")?e:e.value}function Ele(n,t,e){const r=q7(n,e,64,null,null);return m$(t,r),r}function JC(n,t){const e=t[n.currentCaseLViewIndex];return null===e?e:e<0?~e:e}function v$(n){return n>>>17}function C$(n){return(131070&n)>>>1}let ep=0,tp=0;function E$(n,t,e,r){const s=e[11];let o,i=null;for(let c=0;c<t.length;c++){const u=t[c];if("string"==typeof u){const h=t[++c];null===e[h]&&(e[h]=gd(s,u))}else if("number"==typeof u)switch(1&u){case 0:const h=v$(u);let p,m;if(null===i&&(i=h,o=a0(s,r)),h===i?(p=r,m=o):(p=null,m=Sr(e[h])),null!==m){const H=C$(u);v3(s,m,e[H],p,!1);const ie=Jd(n,H);if(null!==ie&&"object"==typeof ie){const ye=JC(ie,e);null!==ye&&E$(n,ie.create[ye],e,e[ie.anchorIdx])}}break;case 1:const w=t[++c],I=t[++c];jd(s,b8(u>>>1,e),null,null,w,I,null)}else switch(u){case QC:const h=t[++c],p=t[++c];null===e[p]&&Di(e[p]=qw(s,h),e);break;case XC:const m=t[++c],C=t[++c];null===e[C]&&Di(e[C]=md(s,m,null),e)}}}function M$(n,t,e,r,s){for(let i=0;i<e.length;i++){const o=e[i],c=e[++i];if(o&s){let u="";for(let h=i+1;h<=i+c;h++){const p=e[h];if("string"==typeof p)u+=p;else if("number"==typeof p)if(p<0)u+=rn(t[r-p]);else{const m=p>>>2;switch(3&p){case 1:const C=e[++h],w=e[++h],I=n.data[m];"string"==typeof I?jd(t[11],t[m],null,I,C,u,w):Eo(n,I,t,C,u,t[11],w,!1);break;case 0:const H=t[m];null!==H&&Gv(t[11],H,u);break;case 2:wle(n,Jd(n,m),t,u);break;case 3:S$(n,Jd(n,m),r,t)}}}}else{const u=e[i+1];if(u>0&&3==(3&u)){const p=Jd(n,u>>>2);t[p.currentCaseLViewIndex]<0&&S$(n,p,r,t)}}i+=c}}function S$(n,t,e,r){let s=r[t.currentCaseLViewIndex];if(null!==s){let i=ep;s<0&&(s=r[t.currentCaseLViewIndex]=~s,i=-1),M$(n,r,t.update[s],e,i)}}function wle(n,t,e,r){const s=function ble(n,t){let e=n.cases.indexOf(t);if(-1===e)switch(n.type){case 1:{const r=function dle(n,t){const e=function u$(n){return Po(n)[_t.PluralCase]}(t)(parseInt(n,10)),r=hle[e];return void 0!==r?r:"other"}(t,function gle(){return h$}());e=n.cases.indexOf(r),-1===e&&"other"!==r&&(e=n.cases.indexOf("other"));break}case 0:e=n.cases.indexOf("other")}return-1===e?null:e}(t,r);if(JC(t,e)!==s&&(P$(n,t,e),e[t.currentCaseLViewIndex]=null===s?null:~s,null!==s)){const o=e[t.anchorIdx];o&&E$(n,t.create[s],e,o)}}function P$(n,t,e){let r=JC(t,e);if(null!==r){const s=t.remove[r];for(let i=0;i<s.length;i++){const o=s[i];if(o>0){const c=b8(o,e);null!==c&&eC(e[11],c)}else P$(n,Jd(n,~o),e)}}}function Ole(){const n=[];let e,r,t=-1;function i(c,u){t=0;const h=JC(c,u);r=null!==h?c.remove[h]:C1}function o(){if(t<r.length){const c=r[t++];return c>0?e[c]:(n.push(t,r),i(e[1].data[~c],e),o())}return 0===n.length?null:(r=n.pop(),t=n.pop(),o())}return function s(c,u){for(e=u;n.length;)n.pop();return i(c.value,u),o}}const ey=/\ufffd(\d+):?\d*\ufffd/gi,Ale=/\ufffd(\d+)\ufffd/,w$=/^\s*(\ufffd\d+:?\d*\ufffd)\s*,\s*(select|plural)\s*,/,Ile=/\ufffd\/?\*(\d+:\d+)\ufffd/gi,xle=/\ufffd(\/?[#*]\d+):?\d*\ufffd/gi,kle=/\uE500/g;function b$(n,t,e,r,s,i,o){const c=Tl(n,r,1,null);let u=c<<us.SHIFT,h=ol();t===h&&(h=null),null===h&&(u|=us.APPEND_EAGERLY),o&&(u|=us.COMMENT,function $v(n){void 0===fd&&(fd=n())}(Ole)),s.push(u,null===i?"":i);const p=q7(n,c,o?32:1,null===i?"":i,null);m$(e,p);const m=p.index;return hc(p,!1),null!==h&&t!==h&&function yle(n,t){let e=n.insertBeforeIndex;null===e?(L7(p$,g$),e=n.insertBeforeIndex=[null,t]):(function d1(n,t,e){n!=t&&S1(e,n,t,"==")}(Array.isArray(e),!0,"Expecting array here"),e.push(t))}(h,m),p}function Dle(n,t,e,r,s,i,o){const c=o.match(ey),u=b$(n,t,e,i,r,c?null:o,!1);c&&rp(s,o,u.index,null,0,null)}function rp(n,t,e,r,s,i){const o=n.length,c=o+1;n.push(null,null);const u=o+2,h=t.split(ey);let p=0;for(let m=0;m<h.length;m++){const C=h[m];if(1&m){const w=s+parseInt(C,10);n.push(-1-w),p|=O$(w)}else""!==C&&n.push(C)}return n.push(e<<2|(r?1:0)),r&&n.push(r,i),n[o]=p,n[c]=n.length-u,p}function O$(n){return 1<<Math.min(n,31)}function N$(n){let t,i,e="",r=0,s=!1;for(;null!==(t=Ile.exec(n));)s?t[0]===`\ufffd/*${i}\ufffd`&&(r=t.index,s=!1):(e+=n.substring(r,t.index+t[0].length),i=t[1],s=!0);return e+=n.slice(r),e}function A$(n,t,e,r,s,i){let o=0;const c={type:s.type,currentCaseLViewIndex:Tl(n,t,1,null),anchorIdx:i,cases:[],create:[],remove:[],update:[]};(function Gle(n,t,e){n.push(O$(t.mainBinding),2,-1-t.mainBinding,e<<2|2)})(e,s,i),function Cle(n,t,e){const r=n.data[t];null===r?n.data[t]=e:r.value=e}(n,i,c);const u=s.values;for(let h=0;h<u.length;h++){const p=u[h],m=[];for(let C=0;C<p.length;C++){const w=p[C];if("string"!=typeof w){const I=m.push(w)-1;p[C]=`\x3c!--\ufffd${I}\ufffd--\x3e`}}o=$le(n,c,t,e,r,s.cases[h],p.join(""),m)|o}o&&function Wle(n,t,e){n.push(t,1,e<<2|3)}(e,o,i)}function Ble(n){const t=[],e=[];let r=1,s=0;const i=tO(n=n.replace(w$,function(o,c,u){return r="select"===u?0:1,s=parseInt(c.slice(1),10),""}));for(let o=0;o<i.length;){let c=i[o++].trim();1===r&&(c=c.replace(/\s*(?:=)?(\w+)\s*/,"$1")),c.length&&t.push(c);const u=tO(i[o++]);t.length>e.length&&e.push(u)}return{type:r,mainBinding:s,cases:t,values:e}}function tO(n){if(!n)return[];let t=0;const e=[],r=[],s=/[{}]/g;let i;for(s.lastIndex=0;i=s.exec(n);){const c=i.index;if("}"==i[0]){if(e.pop(),0==e.length){const u=n.substring(t,c);w$.test(u)?r.push(Ble(u)):r.push(u),t=c+1}}else{if(0==e.length){const u=n.substring(t,c);r.push(u),t=c+1}e.push("{")}}const o=n.substring(t);return r.push(o),r}function $le(n,t,e,r,s,i,o,c){const u=[],h=[],p=[];t.cases.push(i),t.create.push(u),t.remove.push(h),t.update.push(p);const C=uv(rv()).getInertBodyElement(o),w=vo(C)||C;return w?I$(n,t,e,r,u,h,p,w,s,c,0):0}function I$(n,t,e,r,s,i,o,c,u,h,p){let m=0,C=c.firstChild;for(;C;){const w=Tl(n,e,1,null);switch(C.nodeType){case Node.ELEMENT_NODE:const I=C,H=I.tagName.toLowerCase();if(Y8.hasOwnProperty(H)){nO(s,XC,H,u,w),n.data[w]=H;const te=I.attributes;for(let ke=0;ke<te.length;ke++){const $e=te.item(ke),Xe=$e.name.toLowerCase();$e.value.match(ey)?E7.hasOwnProperty(Xe)&&rp(o,$e.value,w,$e.name,0,y7[Xe]?ra:null):qle(s,w,$e)}m=I$(n,t,e,r,s,i,o,C,w,h,p+1)|m,x$(i,w,p)}break;case Node.TEXT_NODE:const K=C.textContent||"",ie=K.match(ey);nO(s,null,ie?"":K,u,w),x$(i,w,p),ie&&(m=rp(o,K,w,null,0,null)|m);break;case Node.COMMENT_NODE:const ye=Ale.exec(C.textContent||"");if(ye){const ke=h[parseInt(ye[1],10)];nO(s,QC,"",u,w),A$(n,e,r,u,ke,w),Ule(i,w,p)}}C=C.nextSibling}return m}function x$(n,t,e){0===e&&n.push(t)}function Ule(n,t,e){0===e&&(n.push(~t),n.push(t))}function nO(n,t,e,r,s){null!==t&&n.push(t),n.push(e,s,function Mle(n,t,e){return n|t<<17|e<<1}(0,r,s))}function qle(n,t,e){n.push(t<<1|1,e.name,e.value)}function yc(n,t,e=-1){const r=Xn(),s=Re(),i=22+n,o=o3(r.consts,t),c=ol();r.firstCreatePass&&function Rle(n,t,e,r,s,i){const o=ol(),c=[],u=[],h=[[]];s=function Fle(n,t){if(function Hle(n){return-1===n}(t))return N$(n);{const e=n.indexOf(`:${t}\ufffd`)+2+t.toString().length,r=n.search(new RegExp(`\ufffd\\/\\*\\d+:${t}\ufffd`));return N$(n.substring(e,r))}}(s,i);const p=function Lle(n){return n.replace(kle," ")}(s).split(xle);for(let m=0;m<p.length;m++){let C=p[m];if(0==(1&m)){const w=tO(C);for(let I=0;I<w.length;I++){let H=w[I];if(0==(1&I)){const K=H;""!==K&&Dle(n,o,h[0],c,u,e,K)}else{const K=H;if("object"!=typeof K)throw new Error(`Unable to parse ICU expression in "${s}" message.`);A$(n,e,u,t,K,b$(n,o,h[0],e,c,"",!0).index)}}}else{const w=47===C.charCodeAt(0),H=(C.charCodeAt(w?1:0),22+Number.parseInt(C.substring(w?2:1)));if(w)h.shift(),hc(ol(),!1);else{const K=Ele(n,h[0],H);h.unshift([]),hc(K,!0)}}}n.data[r]={create:c,update:u}}(r,null===c?0:c.index,s,i,o,e);const u=r.data[i],p=yd(r,c===s[6]?null:c,s);(function Tle(n,t,e,r){const s=n[11];for(let i=0;i<t.length;i++){const o=t[i++],c=t[i],u=(o&us.COMMENT)===us.COMMENT,h=(o&us.APPEND_EAGERLY)===us.APPEND_EAGERLY,p=o>>>us.SHIFT;let m=n[p];null===m&&(m=n[p]=u?s.createComment(c):gd(s,c)),h&&null!==e&&v3(s,e,m,r,!1)}})(s,u.create,p,c&&8&c.type?s[c.index]:null),o2(!0)}function Ec(){o2(!1)}function _e(n,t,e){yc(n,t,e),Ec()}function k1(n){return function Sle(n){n&&(ep|=1<<Math.min(tp,31)),tp++}(x1(Re(),H6(),n)),k1}function F1(n){!function Ple(n,t,e){if(tp>0){const r=n.data[e];M$(n,t,Array.isArray(r)?r:r.update,dc()-tp-1,ep)}ep=0,tp=0}(Xn(),Re(),n+22)}function rO(n,t,e,r,s){if(n=nn(n),Array.isArray(n))for(let i=0;i<n.length;i++)rO(n[i],t,e,r,s);else{const i=Xn(),o=Re();let c=Cl(n)?n:nn(n.provide),u=w7(n);const h=Rr(),p=1048575&h.providerIndexes,m=h.directiveStart,C=h.providerIndexes>>20;if(Cl(n)||!n.multi){const w=new L8(u,s,J),I=iO(c,t,s?p:p+C,m);-1===I?(U6(i7(h,o),i,c),sO(i,n,t.length),t.push(c),h.directiveStart++,h.directiveEnd++,s&&(h.providerIndexes+=1048576),e.push(w),o.push(w)):(e[I]=w,o[I]=w)}else{const w=iO(c,t,p+C,m),I=iO(c,t,p,p+C),H=w>=0&&e[w],K=I>=0&&e[I];if(s&&!K||!s&&!H){U6(i7(h,o),i,c);const ie=function o6e(n,t,e,r,s){const i=new L8(n,e,J);return i.multi=[],i.index=t,i.componentProviders=0,L$(i,s,r&&!e),i}(s?i6e:s6e,e.length,s,r,u);!s&&K&&(e[I].providerFactory=ie),sO(i,n,t.length,0),t.push(c),h.directiveStart++,h.directiveEnd++,s&&(h.providerIndexes+=1048576),e.push(ie),o.push(ie)}else sO(i,n,w>-1?w:I,L$(e[s?I:w],u,!s&&r));!s&&r&&K&&e[I].componentProviders++}}}function sO(n,t,e,r){const s=Cl(t),i=function fw(n){return!!n.useClass}(t);if(s||i){const u=(i?nn(t.useClass):t).prototype.ngOnDestroy;if(u){const h=n.destroyHooks||(n.destroyHooks=[]);if(!s&&t.multi){const p=h.indexOf(e);-1===p?h.push(e,[r,u]):h[p+1].push(r,u)}else h.push(e,u)}}}function L$(n,t,e){return e&&n.componentProviders++,n.multi.push(t)-1}function iO(n,t,e,r){for(let s=e;s<r;s++)if(t[s]===n)return s;return-1}function s6e(n,t,e,r){return oO(this.multi,[])}function i6e(n,t,e,r){const s=this.multi;let i;if(this.providerFactory){const o=this.providerFactory.componentProviders,c=Fs(e,e[1],this.providerFactory.index,r);i=c.slice(0,o),oO(s,i);for(let u=o;u<c.length;u++)i.push(c[u])}else i=[],oO(s,i);return i}function oO(n,t){for(let e=0;e<n.length;e++)t.push((0,n[e])());return t}function Vr(n,t=[]){return e=>{e.providersResolver=(r,s)=>function r6e(n,t,e){const r=Xn();if(r.firstCreatePass){const s=Es(n);rO(e,r.data,r.blueprint,s,!0),rO(t,r.data,r.blueprint,s,!1)}}(r,s?s(n):n,t)}}class mu{}class R${}class D$ extends mu{constructor(t,e){super(),this._parent=e,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new Kd(this);const r=ho(t);this._bootstrapComponents=xa(r.bootstrap),this._r3Injector=pC(t,e,[{provide:mu,useValue:this},{provide:Ia,useValue:this.componentFactoryResolver}],Y1(t),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(t)}get injector(){return this._r3Injector}destroy(){const t=this._r3Injector;!t.destroyed&&t.destroy(),this.destroyCbs.forEach(e=>e()),this.destroyCbs=null}onDestroy(t){this.destroyCbs.push(t)}}class aO extends R${constructor(t){super(),this.moduleType=t}create(t){return new D$(this.moduleType,t)}}class c6e extends mu{constructor(t,e,r){super(),this.componentFactoryResolver=new Kd(this),this.instance=null;const s=new T7([...t,{provide:mu,useValue:this},{provide:Ia,useValue:this.componentFactoryResolver}],e||f4(),r,new Set(["environment"]));this.injector=s,s.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(t){this.injector.onDestroy(t)}}function ty(n,t,e=null){return new c6e(n,t,e).injector}let l6e=(()=>{class n{constructor(e){this._injector=e,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(e){if(!e.standalone)return null;if(!this.cachedInjectors.has(e.id)){const r=Jh(0,e.type),s=r.length>0?ty([r],this._injector,`Standalone[${e.type.name}]`):null;this.cachedInjectors.set(e.id,s)}return this.cachedInjectors.get(e.id)}ngOnDestroy(){try{for(const e of this.cachedInjectors.values())null!==e&&e.destroy()}finally{this.cachedInjectors.clear()}}}return n.\u0275prov=nt({token:n,providedIn:"environment",factory:()=>new n(De(Aa))}),n})();function z$(n){n.getStandaloneInjector=t=>t.get(l6e).getOrCreateStandaloneInjector(n)}function rr(n,t,e){const r=xi()+n,s=Re();return s[r]===hn?mn(s,r,e?t.call(e):t()):function nr(n,t){return n[t]}(s,r)}function P3(n,t,e,r){return G$(Re(),xi(),n,t,e,r)}function sp(n,t){const e=n[t];return e===hn?void 0:e}function G$(n,t,e,r,s,i){const o=t+e;return x1(n,o,s)?mn(n,o+1,i?r.call(i,s):r(s)):sp(n,o+1)}function Mc(n,t){const e=Xn();let r;const s=n+22;e.firstCreatePass?(r=function w6e(n,t){if(t)for(let e=t.length-1;e>=0;e--){const r=t[e];if(n===r.name)return r}}(t,e.pipeRegistry),e.data[s]=r,r.onDestroy&&(e.destroyHooks||(e.destroyHooks=[])).push(s,r.onDestroy)):r=e.data[s];const i=r.factory||(r.factory=Pa(r.type)),o=qo(J);try{const c=i4(!1),u=i();return i4(c),function E4e(n,t,e,r){e>=n.data.length&&(n.data[e]=null,n.blueprint[e]=null),t[e]=r}(e,Re(),s,u),u}finally{qo(o)}}function T3(n,t,e){const r=n+22,s=Re(),i=il(s,r);return ip(s,r)?G$(s,xi(),t,i.transform,e,i):i.transform(e)}function Y$(n,t,e,r){const s=n+22,i=Re(),o=il(i,s);return ip(i,s)?function W$(n,t,e,r,s,i,o){const c=t+e;return g2(n,c,s,i)?mn(n,c+2,o?r.call(o,s,i):r(s,i)):sp(n,c+2)}(i,xi(),t,o.transform,e,r,o):o.transform(e,r)}function ip(n,t){return n[1].data[t].pure}function lO(n){return t=>{setTimeout(n,void 0,t)}}const mr=class A6e extends F2{constructor(t=!1){super(),this.__isAsync=t}emit(t){super.next(t)}subscribe(t,e,r){let s=t,i=e||(()=>null),o=r;if(t&&"object"==typeof t){const u=t;s=u.next?.bind(u),i=u.error?.bind(u),o=u.complete?.bind(u)}this.__isAsync&&(i=lO(i),s&&(s=lO(s)),o&&(o=lO(o)));const c=super.subscribe({next:s,error:i,complete:o});return t instanceof Z1&&t.add(c),c}};function I6e(){return this._results[we()]()}class uO{constructor(t=!1){this._emitDistinctChangesOnly=t,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const e=we(),r=uO.prototype;r[e]||(r[e]=I6e)}get changes(){return this._changes||(this._changes=new mr)}get(t){return this._results[t]}map(t){return this._results.map(t)}filter(t){return this._results.filter(t)}find(t){return this._results.find(t)}reduce(t,e){return this._results.reduce(t,e)}forEach(t){this._results.forEach(t)}some(t){return this._results.some(t)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(t,e){const r=this;r.dirty=!1;const s=c2(t);(this._changesDetected=!function kh(n,t,e){if(n.length!==t.length)return!1;for(let r=0;r<n.length;r++){let s=n[r],i=t[r];if(e&&(s=e(s),i=e(i)),i!==s)return!1}return!0}(r._results,s,e))&&(r._results=s,r.length=s.length,r.last=s[this.length-1],r.first=s[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}let bl=(()=>{class n{}return n.__NG_ELEMENT_ID__=L6e,n})();const x6e=bl,k6e=class extends x6e{constructor(t,e,r){super(),this._declarationLView=t,this._declarationTContainer=e,this.elementRef=r}createEmbeddedView(t,e){const r=this._declarationTContainer.tViews,s=W7(this._declarationLView,r,t,16,null,r.declTNode,null,null,null,null,e||null);s[17]=this._declarationLView[this._declarationTContainer.index];const o=this._declarationLView[19];return null!==o&&(s[19]=o.createEmbeddedView(r)),j7(r,s,t),new nf(s)}};function L6e(){return ny(Rr(),Re())}function ny(n,t){return 4&n.type?new k6e(t,n,n0(n,t)):null}let za=(()=>{class n{}return n.__NG_ELEMENT_ID__=R6e,n})();function R6e(){return Q$(Rr(),Re())}const D6e=za,K$=class extends D6e{constructor(t,e,r){super(),this._lContainer=t,this._hostTNode=e,this._hostLView=r}get element(){return n0(this._hostTNode,this._hostLView)}get injector(){return new G6(this._hostTNode,this._hostLView)}get parentInjector(){const t=ba(this._hostTNode,this._hostLView);if(wh(t)){const e=fl(t,this._hostLView),r=ul(t);return new G6(e[1].data[r+8],e)}return new G6(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(t){const e=X$(this._lContainer);return null!==e&&e[t]||null}get length(){return this._lContainer.length-10}createEmbeddedView(t,e,r){let s,i;"number"==typeof r?s=r:null!=r&&(s=r.index,i=r.injector);const o=t.createEmbeddedView(e||{},i);return this.insert(o,s),o}createComponent(t,e,r,s,i){const o=t&&!function ki(n){return"function"==typeof n}(t);let c;if(o)c=e;else{const m=e||{};c=m.index,r=m.injector,s=m.projectableNodes,i=m.environmentInjector||m.ngModuleRef}const u=o?t:new du(P1(t)),h=r||this.parentInjector;if(!i&&null==u.ngModule){const C=(o?h:this.parentInjector).get(Aa,null);C&&(i=C)}const p=u.create(h,s,void 0,i);return this.insert(p.hostView,c),p}insert(t,e){const r=t._lView,s=r[1];if(function O8(n){return Mr(n[3])}(r)){const p=this.indexOf(t);if(-1!==p)this.detach(p);else{const m=r[3],C=new K$(m,m[6],m[3]);C.detach(C.indexOf(t))}}const i=this._adjustIndex(e),o=this._lContainer;!function Xw(n,t,e,r){const s=10+r,i=e.length;r>0&&(e[s-1][4]=t),r<i-10?(t[4]=e[s],d3(e,10+r,t)):(e.push(t),t[4]=null),t[3]=e;const o=t[17];null!==o&&e!==o&&function Qw(n,t){const e=n[9];t[16]!==t[3][3][16]&&(n[2]=!0),null===e?n[9]=[t]:e.push(t)}(o,t);const c=t[19];null!==c&&c.insertView(n),t[2]|=64}(s,r,o,i);const c=c0(i,o),u=r[11],h=a0(u,o[7]);return null!==h&&function Zw(n,t,e,r,s,i){r[0]=s,r[6]=t,l0(n,r,e,1,s,i)}(s,o[6],u,r,h,c),t.attachToViewContainerRef(),d3(fO(o),i,t),t}move(t,e){return this.insert(t,e)}indexOf(t){const e=X$(this._lContainer);return null!==e?e.indexOf(t):-1}remove(t){const e=this._adjustIndex(t,-1),r=_d(this._lContainer,e);r&&(Y6(fO(this._lContainer),e),qv(r[1],r))}detach(t){const e=this._adjustIndex(t,-1),r=_d(this._lContainer,e);return r&&null!=Y6(fO(this._lContainer),e)?new nf(r):null}_adjustIndex(t,e=0){return t??this.length+e}};function X$(n){return n[8]}function fO(n){return n[8]||(n[8]=[])}function Q$(n,t){let e;const r=t[n.index];if(Mr(r))e=r;else{let s;if(8&n.type)s=Sr(r);else{const i=t[11];s=i.createComment("");const o=s2(n,t);v3(i,a0(i,o),s,function Kv(n,t){return n.nextSibling(t)}(i,o),!1)}t[n.index]=e=zC(r,t,s,n),Q7(t,e)}return new K$(e,n,t)}class hO{constructor(t){this.queryList=t,this.matches=null}clone(){return new hO(this.queryList)}setDirty(){this.queryList.setDirty()}}class dO{constructor(t=[]){this.queries=t}createEmbeddedView(t){const e=t.queries;if(null!==e){const r=null!==t.contentQueries?t.contentQueries[0]:e.length,s=[];for(let i=0;i<r;i++){const o=e.getByIndex(i);s.push(this.queries[o.indexInDeclarationView].clone())}return new dO(s)}return null}insertView(t){this.dirtyQueriesWithMatches(t)}detachView(t){this.dirtyQueriesWithMatches(t)}dirtyQueriesWithMatches(t){for(let e=0;e<this.queries.length;e++)null!==rU(t,e).matches&&this.queries[e].setDirty()}}class J${constructor(t,e,r=null){this.predicate=t,this.flags=e,this.read=r}}class pO{constructor(t=[]){this.queries=t}elementStart(t,e){for(let r=0;r<this.queries.length;r++)this.queries[r].elementStart(t,e)}elementEnd(t){for(let e=0;e<this.queries.length;e++)this.queries[e].elementEnd(t)}embeddedTView(t){let e=null;for(let r=0;r<this.length;r++){const s=null!==e?e.length:0,i=this.getByIndex(r).embeddedTView(t,s);i&&(i.indexInDeclarationView=r,null!==e?e.push(i):e=[i])}return null!==e?new pO(e):null}template(t,e){for(let r=0;r<this.queries.length;r++)this.queries[r].template(t,e)}getByIndex(t){return this.queries[t]}get length(){return this.queries.length}track(t){this.queries.push(t)}}class gO{constructor(t,e=-1){this.metadata=t,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=e}elementStart(t,e){this.isApplyingToNode(e)&&this.matchTNode(t,e)}elementEnd(t){this._declarationNodeIndex===t.index&&(this._appliesToNextNode=!1)}template(t,e){this.elementStart(t,e)}embeddedTView(t,e){return this.isApplyingToNode(t)?(this.crossesNgTemplate=!0,this.addMatch(-t.index,e),new gO(this.metadata)):null}isApplyingToNode(t){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const e=this._declarationNodeIndex;let r=t.parent;for(;null!==r&&8&r.type&&r.index!==e;)r=r.parent;return e===(null!==r?r.index:-1)}return this._appliesToNextNode}matchTNode(t,e){const r=this.metadata.predicate;if(Array.isArray(r))for(let s=0;s<r.length;s++){const i=r[s];this.matchTNodeWithReadOption(t,e,H6e(e,i)),this.matchTNodeWithReadOption(t,e,Yr(e,t,i,!1,!1))}else r===bl?4&e.type&&this.matchTNodeWithReadOption(t,e,-1):this.matchTNodeWithReadOption(t,e,Yr(e,t,r,!1,!1))}matchTNodeWithReadOption(t,e,r){if(null!==r){const s=this.metadata.read;if(null!==s)if(s===h2||s===za||s===bl&&4&e.type)this.addMatch(e.index,-2);else{const i=Yr(e,t,s,!1,!1);null!==i&&this.addMatch(e.index,i)}else this.addMatch(e.index,r)}}addMatch(t,e){null===this.matches?this.matches=[t,e]:this.matches.push(t,e)}}function H6e(n,t){const e=n.localNames;if(null!==e)for(let r=0;r<e.length;r+=2)if(e[r]===t)return e[r+1];return null}function B6e(n,t,e,r){return-1===e?function F6e(n,t){return 11&n.type?n0(n,t):4&n.type?ny(n,t):null}(t,n):-2===e?function $6e(n,t,e){return e===h2?n0(t,n):e===bl?ny(t,n):e===za?Q$(t,n):void 0}(n,t,r):Fs(n,n[1],e,t)}function eU(n,t,e,r){const s=t[19].queries[r];if(null===s.matches){const i=n.data,o=e.matches,c=[];for(let u=0;u<o.length;u+=2){const h=o[u];c.push(h<0?null:B6e(t,i[h],o[u+1],e.metadata.read))}s.matches=c}return s.matches}function mO(n,t,e,r){const s=n.queries.getByIndex(e),i=s.matches;if(null!==i){const o=eU(n,t,s,e);for(let c=0;c<i.length;c+=2){const u=i[c];if(u>0)r.push(o[c/2]);else{const h=i[c+1],p=t[-u];for(let m=10;m<p.length;m++){const C=p[m];C[17]===C[3]&&mO(C[1],C,h,r)}if(null!==p[9]){const m=p[9];for(let C=0;C<m.length;C++){const w=m[C];mO(w[1],w,h,r)}}}}}return r}function Sc(n){const t=Re(),e=Xn(),r=Eh();N8(r+1);const s=rU(e,r);if(n.dirty&&function k_(n){return 4==(4&n[2])}(t)===(2==(2&s.metadata.flags))){if(null===s.matches)n.reset([]);else{const i=s.crossesNgTemplate?mO(e,t,r,[]):eU(e,t,s,r);n.reset(i,O7),n.notifyOnChanges()}return!0}return!1}function v4(n,t,e){const r=Xn();r.firstCreatePass&&(function nU(n,t,e){null===n.queries&&(n.queries=new pO),n.queries.track(new gO(t,e))}(r,new J$(n,t,e),-1),2==(2&t)&&(r.staticViewQueries=!0)),function tU(n,t,e){const r=new uO(4==(4&e));Lb(n,t,r,r.destroy),null===t[19]&&(t[19]=new dO),t[19].queries.push(new hO(r))}(r,Re(),t)}function Pc(){return function U6e(n,t){return n[19].queries[t].queryList}(Re(),Eh())}function rU(n,t){return n.queries.getByIndex(t)}function r1(n,t){return ny(n,t)}function sy(...n){}const iy=new kt("Application Initializer");let oy=(()=>{class n{constructor(e){this.appInits=e,this.resolve=sy,this.reject=sy,this.initialized=!1,this.done=!1,this.donePromise=new Promise((r,s)=>{this.resolve=r,this.reject=s})}runInitializers(){if(this.initialized)return;const e=[],r=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let s=0;s<this.appInits.length;s++){const i=this.appInits[s]();if(Xd(i))e.push(i);else if(Kb(i)){const o=new Promise((c,u)=>{i.subscribe({complete:c,error:u})});e.push(o)}}Promise.all(e).then(()=>{r()}).catch(s=>{this.reject(s)}),0===e.length&&r(),this.initialized=!0}}return n.\u0275fac=function(e){return new(e||n)(De(iy,8))},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const ap=new kt("AppId",{providedIn:"root",factory:function MU(){return`${MO()}${MO()}${MO()}`}});function MO(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const SU=new kt("Platform Initializer"),cp=new kt("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),PU=new kt("appBootstrapListener"),TU=new kt("AnimationModuleType");let u0e=(()=>{class n{log(e){console.log(e)}warn(e){console.warn(e)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})();const C4=new kt("LocaleId",{providedIn:"root",factory:()=>zr(C4,jt.Optional|jt.SkipSelf)||function f0e(){return typeof $localize<"u"&&$localize.locale||af}()});class d0e{constructor(t,e){this.ngModuleFactory=t,this.componentFactories=e}}let SO=(()=>{class n{compileModuleSync(e){return new aO(e)}compileModuleAsync(e){return Promise.resolve(this.compileModuleSync(e))}compileModuleAndAllComponentsSync(e){const r=this.compileModuleSync(e),i=xa(ho(e).declarations).reduce((o,c)=>{const u=P1(c);return u&&o.push(new du(u)),o},[]);return new d0e(r,i)}compileModuleAndAllComponentsAsync(e){return Promise.resolve(this.compileModuleAndAllComponentsSync(e))}clearCache(){}clearCacheFor(e){}getModuleId(e){}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const m0e=(()=>Promise.resolve(0))();function PO(n){typeof Zone>"u"?m0e.then(()=>{n&&n.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",n)}class Pr{constructor({enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:e=!1,shouldCoalesceRunChangeDetection:r=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new mr(!1),this.onMicrotaskEmpty=new mr(!1),this.onStable=new mr(!1),this.onError=new mr(!1),typeof Zone>"u")throw new Ae(908,!1);Zone.assertZonePatched();const s=this;if(s._nesting=0,s._outer=s._inner=Zone.current,Zone.AsyncStackTaggingZoneSpec){const i=Zone.AsyncStackTaggingZoneSpec;s._inner=s._inner.fork(new i("Angular"))}Zone.TaskTrackingZoneSpec&&(s._inner=s._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(s._inner=s._inner.fork(Zone.longStackTraceZoneSpec)),s.shouldCoalesceEventChangeDetection=!r&&e,s.shouldCoalesceRunChangeDetection=r,s.lastRequestAnimationFrameId=-1,s.nativeRequestAnimationFrame=function _0e(){let n=er.requestAnimationFrame,t=er.cancelAnimationFrame;if(typeof Zone<"u"&&n&&t){const e=n[Zone.__symbol__("OriginalDelegate")];e&&(n=e);const r=t[Zone.__symbol__("OriginalDelegate")];r&&(t=r)}return{nativeRequestAnimationFrame:n,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,function y0e(n){const t=()=>{!function C0e(n){n.isCheckStableRunning||-1!==n.lastRequestAnimationFrameId||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(er,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,wO(n),n.isCheckStableRunning=!0,TO(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),wO(n))}(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(e,r,s,i,o,c)=>{try{return OU(n),e.invokeTask(s,i,o,c)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===i.type||n.shouldCoalesceRunChangeDetection)&&t(),NU(n)}},onInvoke:(e,r,s,i,o,c,u)=>{try{return OU(n),e.invoke(s,i,o,c,u)}finally{n.shouldCoalesceRunChangeDetection&&t(),NU(n)}},onHasTask:(e,r,s,i)=>{e.hasTask(s,i),r===s&&("microTask"==i.change?(n._hasPendingMicrotasks=i.microTask,wO(n),TO(n)):"macroTask"==i.change&&(n.hasPendingMacrotasks=i.macroTask))},onHandleError:(e,r,s,i)=>(e.handleError(s,i),n.runOutsideAngular(()=>n.onError.emit(i)),!1)})}(s)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Pr.isInAngularZone())throw new Ae(909,!1)}static assertNotInAngularZone(){if(Pr.isInAngularZone())throw new Ae(909,!1)}run(t,e,r){return this._inner.run(t,e,r)}runTask(t,e,r,s){const i=this._inner,o=i.scheduleEventTask("NgZoneEvent: "+s,t,v0e,sy,sy);try{return i.runTask(o,e,r)}finally{i.cancelTask(o)}}runGuarded(t,e,r){return this._inner.runGuarded(t,e,r)}runOutsideAngular(t){return this._outer.run(t)}}const v0e={};function TO(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function wO(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&-1!==n.lastRequestAnimationFrameId)}function OU(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function NU(n){n._nesting--,TO(n)}class E0e{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new mr,this.onMicrotaskEmpty=new mr,this.onStable=new mr,this.onError=new mr}run(t,e,r){return t.apply(e,r)}runGuarded(t,e,r){return t.apply(e,r)}runOutsideAngular(t){return t()}runTask(t,e,r,s){return t.apply(e,r)}}const AU=new kt(""),ay=new kt("");let NO,bO=(()=>{class n{constructor(e,r,s){this._ngZone=e,this.registry=r,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,NO||(function M0e(n){NO=n}(s),s.addToWindow(r)),this._watchAngularEvents(),e.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Pr.assertNotInAngularZone(),PO(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())PO(()=>{for(;0!==this._callbacks.length;){let e=this._callbacks.pop();clearTimeout(e.timeoutId),e.doneCb(this._didWork)}this._didWork=!1});else{let e=this.getPendingTasks();this._callbacks=this._callbacks.filter(r=>!r.updateCb||!r.updateCb(e)||(clearTimeout(r.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(e=>({source:e.source,creationLocation:e.creationLocation,data:e.data})):[]}addCallback(e,r,s){let i=-1;r&&r>0&&(i=setTimeout(()=>{this._callbacks=this._callbacks.filter(o=>o.timeoutId!==i),e(this._didWork,this.getPendingTasks())},r)),this._callbacks.push({doneCb:e,timeoutId:i,updateCb:s})}whenStable(e,r,s){if(s&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(e,r,s),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(e){this.registry.registerApplication(e,this)}unregisterApplication(e){this.registry.unregisterApplication(e)}findProviders(e,r,s){return[]}}return n.\u0275fac=function(e){return new(e||n)(De(Pr),De(OO),De(ay))},n.\u0275prov=nt({token:n,factory:n.\u0275fac}),n})(),OO=(()=>{class n{constructor(){this._applications=new Map}registerApplication(e,r){this._applications.set(e,r)}unregisterApplication(e){this._applications.delete(e)}unregisterAllApplications(){this._applications.clear()}getTestability(e){return this._applications.get(e)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(e,r=!0){return NO?.findTestabilityInTree(this,e,r)??null}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})(),g0=null;const IU=new kt("AllowMultipleToken"),AO=new kt("PlatformDestroyListeners");class xU{constructor(t,e){this.name=t,this.token=e}}function LU(n,t,e=[]){const r=`Platform: ${t}`,s=new kt(r);return(i=[])=>{let o=IO();if(!o||o.injector.get(IU,!1)){const c=[...e,...i,{provide:s,useValue:!0}];n?n(c):function T0e(n){if(g0&&!g0.get(IU,!1))throw new Ae(400,!1);g0=n;const t=n.get(DU);(function kU(n){const t=n.get(SU,null);t&&t.forEach(e=>e())})(n)}(function RU(n=[],t){return fi.create({name:t,providers:[{provide:td,useValue:"platform"},{provide:AO,useValue:new Set([()=>g0=null])},...n]})}(c,r))}return function b0e(n){const t=IO();if(!t)throw new Ae(401,!1);return t}()}}function IO(){return g0?.get(DU)??null}let DU=(()=>{class n{constructor(e){this._injector=e,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(e,r){const s=function VU(n,t){let e;return e="noop"===n?new E0e:("zone.js"===n?void 0:n)||new Pr(t),e}(r?.ngZone,function zU(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!(!n||!n.ngZoneEventCoalescing)||!1,shouldCoalesceRunChangeDetection:!(!n||!n.ngZoneRunCoalescing)||!1}}(r)),i=[{provide:Pr,useValue:s}];return s.run(()=>{const o=fi.create({providers:i,parent:this.injector,name:e.moduleType.name}),c=e.create(o),u=c.injector.get(o0,null);if(!u)throw new Ae(402,!1);return s.runOutsideAngular(()=>{const h=s.onError.subscribe({next:p=>{u.handleError(p)}});c.onDestroy(()=>{cy(this._modules,c),h.unsubscribe()})}),function HU(n,t,e){try{const r=e();return Xd(r)?r.catch(s=>{throw t.runOutsideAngular(()=>n.handleError(s)),s}):r}catch(r){throw t.runOutsideAngular(()=>n.handleError(r)),r}}(u,s,()=>{const h=c.injector.get(oy);return h.runInitializers(),h.donePromise.then(()=>(d$(c.injector.get(C4,af)||af),this._moduleDoBootstrap(c),c))})})}bootstrapModule(e,r=[]){const s=FU({},r);return function S0e(n,t,e){const r=new aO(e);return Promise.resolve(r)}(0,0,e).then(i=>this.bootstrapModuleFactory(i,s))}_moduleDoBootstrap(e){const r=e.injector.get(lp);if(e._bootstrapComponents.length>0)e._bootstrapComponents.forEach(s=>r.bootstrap(s));else{if(!e.instance.ngDoBootstrap)throw new Ae(403,!1);e.instance.ngDoBootstrap(r)}this._modules.push(e)}onDestroy(e){this._destroyListeners.push(e)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Ae(404,!1);this._modules.slice().forEach(r=>r.destroy()),this._destroyListeners.forEach(r=>r());const e=this._injector.get(AO,null);e&&(e.forEach(r=>r()),e.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return n.\u0275fac=function(e){return new(e||n)(De(fi))},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})();function FU(n,t){return Array.isArray(t)?t.reduce(FU,n):{...n,...t}}let lp=(()=>{class n{constructor(e,r,s){this._zone=e,this._injector=r,this._exceptionHandler=s,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this._destroyed=!1,this._destroyListeners=[],this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const i=new Er(c=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{c.next(this._stable),c.complete()})}),o=new Er(c=>{let u;this._zone.runOutsideAngular(()=>{u=this._zone.onStable.subscribe(()=>{Pr.assertNotInAngularZone(),PO(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,c.next(!0))})})});const h=this._zone.onUnstable.subscribe(()=>{Pr.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{c.next(!1)}))});return()=>{u.unsubscribe(),h.unsubscribe()}});this.isStable=function __(...n){const t=K3(n),e=function D5(n,t){return"number"==typeof tl(n)?n.pop():t}(n,1/0),r=n;return r.length?1===r.length?uo(r[0]):el(e)(ls(r,t)):uc}(i,o.pipe(function dT(n={}){const{connector:t=(()=>new F2),resetOnError:e=!0,resetOnComplete:r=!0,resetOnRefCountZero:s=!0}=n;return i=>{let o,c,u,h=0,p=!1,m=!1;const C=()=>{c?.unsubscribe(),c=void 0},w=()=>{C(),o=u=void 0,p=m=!1},I=()=>{const H=o;w(),H?.unsubscribe()};return gr((H,K)=>{h++,!m&&!p&&C();const ie=u=u??t();K.add(()=>{h--,0===h&&!m&&!p&&(c=H5(I,s))}),ie.subscribe(K),!o&&h>0&&(o=new ur({next:ye=>ie.next(ye),error:ye=>{m=!0,C(),c=H5(w,e,ye),ie.error(ye)},complete:()=>{p=!0,C(),c=H5(w,r),ie.complete()}}),uo(H).subscribe(o))})(i)}}()))}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(e,r){const s=e instanceof Ov;if(!this._injector.get(oy).done)throw!s&&function sl(n){const t=P1(n)||Ji(n)||e2(n);return null!==t&&t.standalone}(e),new Ae(405,false);let o;o=s?e:this._injector.get(Ia).resolveComponentFactory(e),this.componentTypes.push(o.componentType);const c=function P0e(n){return n.isBoundToModule}(o)?void 0:this._injector.get(mu),h=o.create(fi.NULL,[],r||o.selector,c),p=h.location.nativeElement,m=h.injector.get(AU,null);return m?.registerApplication(p),h.onDestroy(()=>{this.detachView(h.hostView),cy(this.components,h),m?.unregisterApplication(p)}),this._loadComponent(h),h}tick(){if(this._runningTick)throw new Ae(101,!1);try{this._runningTick=!0;for(let e of this._views)e.detectChanges()}catch(e){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(e))}finally{this._runningTick=!1}}attachView(e){const r=e;this._views.push(r),r.attachToAppRef(this)}detachView(e){const r=e;cy(this._views,r),r.detachFromAppRef()}_loadComponent(e){this.attachView(e.hostView),this.tick(),this.components.push(e),this._injector.get(PU,[]).concat(this._bootstrapListeners).forEach(s=>s(e))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(e=>e()),this._views.slice().forEach(e=>e.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(e){return this._destroyListeners.push(e),()=>cy(this._destroyListeners,e)}destroy(){if(this._destroyed)throw new Ae(406,!1);const e=this._injector;e.destroy&&!e.destroyed&&e.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return n.\u0275fac=function(e){return new(e||n)(De(Pr),De(Aa),De(o0))},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function cy(n,t){const e=n.indexOf(t);e>-1&&n.splice(e,1)}let $U=!0,_u=(()=>{class n{}return n.__NG_ELEMENT_ID__=A0e,n})();function A0e(n){return function I0e(n,t,e){if(Ko(n)&&!e){const r=Ii(n.index,t);return new nf(r,r)}return 47&n.type?new nf(t[16],t):null}(Rr(),Re(),16==(16&n))}class jU{constructor(){}supports(t){return Ve(t)}create(t){return new z0e(t)}}const D0e=(n,t)=>t;class z0e{constructor(t){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=t||D0e}forEachItem(t){let e;for(e=this._itHead;null!==e;e=e._next)t(e)}forEachOperation(t){let e=this._itHead,r=this._removalsHead,s=0,i=null;for(;e||r;){const o=!r||e&&e.currentIndex<YU(r,s,i)?e:r,c=YU(o,s,i),u=o.currentIndex;if(o===r)s--,r=r._nextRemoved;else if(e=e._next,null==o.previousIndex)s++;else{i||(i=[]);const h=c-s,p=u-s;if(h!=p){for(let C=0;C<h;C++){const w=C<i.length?i[C]:i[C]=0,I=w+C;p<=I&&I<h&&(i[C]=w+1)}i[o.previousIndex]=p-h}}c!==u&&t(o,c,u)}}forEachPreviousItem(t){let e;for(e=this._previousItHead;null!==e;e=e._nextPrevious)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}forEachMovedItem(t){let e;for(e=this._movesHead;null!==e;e=e._nextMoved)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}forEachIdentityChange(t){let e;for(e=this._identityChangesHead;null!==e;e=e._nextIdentityChange)t(e)}diff(t){if(null==t&&(t=[]),!Ve(t))throw new Ae(900,!1);return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let s,i,o,e=this._itHead,r=!1;if(Array.isArray(t)){this.length=t.length;for(let c=0;c<this.length;c++)i=t[c],o=this._trackByFn(c,i),null!==e&&Object.is(e.trackById,o)?(r&&(e=this._verifyReinsertion(e,i,o,c)),Object.is(e.item,i)||this._addIdentityChange(e,i)):(e=this._mismatch(e,i,o,c),r=!0),e=e._next}else s=0,function st(n,t){if(Array.isArray(n))for(let e=0;e<n.length;e++)t(n[e]);else{const e=n[we()]();let r;for(;!(r=e.next()).done;)t(r.value)}}(t,c=>{o=this._trackByFn(s,c),null!==e&&Object.is(e.trackById,o)?(r&&(e=this._verifyReinsertion(e,c,o,s)),Object.is(e.item,c)||this._addIdentityChange(e,c)):(e=this._mismatch(e,c,o,s),r=!0),e=e._next,s++}),this.length=s;return this._truncate(e),this.collection=t,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let t;for(t=this._previousItHead=this._itHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._additionsHead;null!==t;t=t._nextAdded)t.previousIndex=t.currentIndex;for(this._additionsHead=this._additionsTail=null,t=this._movesHead;null!==t;t=t._nextMoved)t.previousIndex=t.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(t,e,r,s){let i;return null===t?i=this._itTail:(i=t._prev,this._remove(t)),null!==(t=null===this._unlinkedRecords?null:this._unlinkedRecords.get(r,null))?(Object.is(t.item,e)||this._addIdentityChange(t,e),this._reinsertAfter(t,i,s)):null!==(t=null===this._linkedRecords?null:this._linkedRecords.get(r,s))?(Object.is(t.item,e)||this._addIdentityChange(t,e),this._moveAfter(t,i,s)):t=this._addAfter(new V0e(e,r),i,s),t}_verifyReinsertion(t,e,r,s){let i=null===this._unlinkedRecords?null:this._unlinkedRecords.get(r,null);return null!==i?t=this._reinsertAfter(i,t._prev,s):t.currentIndex!=s&&(t.currentIndex=s,this._addToMoves(t,s)),t}_truncate(t){for(;null!==t;){const e=t._next;this._addToRemovals(this._unlink(t)),t=e}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(t,e,r){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(t);const s=t._prevRemoved,i=t._nextRemoved;return null===s?this._removalsHead=i:s._nextRemoved=i,null===i?this._removalsTail=s:i._prevRemoved=s,this._insertAfter(t,e,r),this._addToMoves(t,r),t}_moveAfter(t,e,r){return this._unlink(t),this._insertAfter(t,e,r),this._addToMoves(t,r),t}_addAfter(t,e,r){return this._insertAfter(t,e,r),this._additionsTail=null===this._additionsTail?this._additionsHead=t:this._additionsTail._nextAdded=t,t}_insertAfter(t,e,r){const s=null===e?this._itHead:e._next;return t._next=s,t._prev=e,null===s?this._itTail=t:s._prev=t,null===e?this._itHead=t:e._next=t,null===this._linkedRecords&&(this._linkedRecords=new ZU),this._linkedRecords.put(t),t.currentIndex=r,t}_remove(t){return this._addToRemovals(this._unlink(t))}_unlink(t){null!==this._linkedRecords&&this._linkedRecords.remove(t);const e=t._prev,r=t._next;return null===e?this._itHead=r:e._next=r,null===r?this._itTail=e:r._prev=e,t}_addToMoves(t,e){return t.previousIndex===e||(this._movesTail=null===this._movesTail?this._movesHead=t:this._movesTail._nextMoved=t),t}_addToRemovals(t){return null===this._unlinkedRecords&&(this._unlinkedRecords=new ZU),this._unlinkedRecords.put(t),t.currentIndex=null,t._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=t,t._prevRemoved=null):(t._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=t),t}_addIdentityChange(t,e){return t.item=e,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=t:this._identityChangesTail._nextIdentityChange=t,t}}class V0e{constructor(t,e){this.item=t,this.trackById=e,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class H0e{constructor(){this._head=null,this._tail=null}add(t){null===this._head?(this._head=this._tail=t,t._nextDup=null,t._prevDup=null):(this._tail._nextDup=t,t._prevDup=this._tail,t._nextDup=null,this._tail=t)}get(t,e){let r;for(r=this._head;null!==r;r=r._nextDup)if((null===e||e<=r.currentIndex)&&Object.is(r.trackById,t))return r;return null}remove(t){const e=t._prevDup,r=t._nextDup;return null===e?this._head=r:e._nextDup=r,null===r?this._tail=e:r._prevDup=e,null===this._head}}class ZU{constructor(){this.map=new Map}put(t){const e=t.trackById;let r=this.map.get(e);r||(r=new H0e,this.map.set(e,r)),r.add(t)}get(t,e){const s=this.map.get(t);return s?s.get(t,e):null}remove(t){const e=t.trackById;return this.map.get(e).remove(t)&&this.map.delete(e),t}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function YU(n,t,e){const r=n.previousIndex;if(null===r)return r;let s=0;return e&&r<e.length&&(s=e[r]),r+t+s}class KU{constructor(){}supports(t){return t instanceof Map||vt(t)}create(){return new F0e}}class F0e{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(t){let e;for(e=this._mapHead;null!==e;e=e._next)t(e)}forEachPreviousItem(t){let e;for(e=this._previousMapHead;null!==e;e=e._nextPrevious)t(e)}forEachChangedItem(t){let e;for(e=this._changesHead;null!==e;e=e._nextChanged)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}diff(t){if(t){if(!(t instanceof Map||vt(t)))throw new Ae(900,!1)}else t=new Map;return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let e=this._mapHead;if(this._appendAfter=null,this._forEach(t,(r,s)=>{if(e&&e.key===s)this._maybeAddToChanges(e,r),this._appendAfter=e,e=e._next;else{const i=this._getOrCreateRecordForKey(s,r);e=this._insertBeforeOrAppend(e,i)}}),e){e._prev&&(e._prev._next=null),this._removalsHead=e;for(let r=e;null!==r;r=r._nextRemoved)r===this._mapHead&&(this._mapHead=null),this._records.delete(r.key),r._nextRemoved=r._next,r.previousValue=r.currentValue,r.currentValue=null,r._prev=null,r._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(t,e){if(t){const r=t._prev;return e._next=t,e._prev=r,t._prev=e,r&&(r._next=e),t===this._mapHead&&(this._mapHead=e),this._appendAfter=t,t}return this._appendAfter?(this._appendAfter._next=e,e._prev=this._appendAfter):this._mapHead=e,this._appendAfter=e,null}_getOrCreateRecordForKey(t,e){if(this._records.has(t)){const s=this._records.get(t);this._maybeAddToChanges(s,e);const i=s._prev,o=s._next;return i&&(i._next=o),o&&(o._prev=i),s._next=null,s._prev=null,s}const r=new B0e(t);return this._records.set(t,r),r.currentValue=e,this._addToAdditions(r),r}_reset(){if(this.isDirty){let t;for(this._previousMapHead=this._mapHead,t=this._previousMapHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._changesHead;null!==t;t=t._nextChanged)t.previousValue=t.currentValue;for(t=this._additionsHead;null!=t;t=t._nextAdded)t.previousValue=t.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(t,e){Object.is(e,t.currentValue)||(t.previousValue=t.currentValue,t.currentValue=e,this._addToChanges(t))}_addToAdditions(t){null===this._additionsHead?this._additionsHead=this._additionsTail=t:(this._additionsTail._nextAdded=t,this._additionsTail=t)}_addToChanges(t){null===this._changesHead?this._changesHead=this._changesTail=t:(this._changesTail._nextChanged=t,this._changesTail=t)}_forEach(t,e){t instanceof Map?t.forEach(e):Object.keys(t).forEach(r=>e(t[r],r))}}class B0e{constructor(t){this.key=t,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function XU(){return new fy([new jU])}let fy=(()=>{class n{constructor(e){this.factories=e}static create(e,r){if(null!=r){const s=r.factories.slice();e=e.concat(s)}return new n(e)}static extend(e){return{provide:n,useFactory:r=>n.create(e,r||XU()),deps:[[n,new W8,new ui]]}}find(e){const r=this.factories.find(s=>s.supports(e));if(null!=r)return r;throw new Ae(901,!1)}}return n.\u0275prov=nt({token:n,providedIn:"root",factory:XU}),n})();function QU(){return new up([new KU])}let up=(()=>{class n{constructor(e){this.factories=e}static create(e,r){if(r){const s=r.factories.slice();e=e.concat(s)}return new n(e)}static extend(e){return{provide:n,useFactory:r=>n.create(e,r||QU()),deps:[[n,new W8,new ui]]}}find(e){const r=this.factories.find(s=>s.supports(e));if(r)return r;throw new Ae(901,!1)}}return n.\u0275prov=nt({token:n,providedIn:"root",factory:QU}),n})();const G0e=LU(null,"core",[]);let W0e=(()=>{class n{constructor(e){}}return n.\u0275fac=function(e){return new(e||n)(De(lp))},n.\u0275mod=oi({type:n}),n.\u0275inj=jr({}),n})();function Nl(n){return"boolean"==typeof n?n:null!=n&&"false"!==n}let hy=null;function y4(){return hy}const $s=new kt("DocumentToken");let DO=(()=>{class n{historyGo(e){throw new Error("Not implemented")}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=nt({token:n,factory:function(){return function Y0e(){return De(JU)}()},providedIn:"platform"}),n})();const K0e=new kt("Location Initialized");let JU=(()=>{class n extends DO{constructor(e){super(),this._doc=e,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return y4().getBaseHref(this._doc)}onPopState(e){const r=y4().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",e,!1),()=>r.removeEventListener("popstate",e)}onHashChange(e){const r=y4().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",e,!1),()=>r.removeEventListener("hashchange",e)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(e){this.location.pathname=e}pushState(e,r,s){eG()?this._history.pushState(e,r,s):this.location.hash=s}replaceState(e,r,s){eG()?this._history.replaceState(e,r,s):this.location.hash=s}forward(){this._history.forward()}back(){this._history.back()}historyGo(e=0){this._history.go(e)}getState(){return this._history.state}}return n.\u0275fac=function(e){return new(e||n)(De($s))},n.\u0275prov=nt({token:n,factory:function(){return function X0e(){return new JU(De($s))}()},providedIn:"platform"}),n})();function eG(){return!!window.history.pushState}function zO(n,t){if(0==n.length)return t;if(0==t.length)return n;let e=0;return n.endsWith("/")&&e++,t.startsWith("/")&&e++,2==e?n+t.substring(1):1==e?n+t:n+"/"+t}function tG(n){const t=n.match(/#|\?|$/),e=t&&t.index||n.length;return n.slice(0,e-("/"===n[e-1]?1:0))+n.slice(e)}function Al(n){return n&&"?"!==n[0]?"?"+n:n}let Cu=(()=>{class n{historyGo(e){throw new Error("Not implemented")}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=nt({token:n,factory:function(){return zr(rG)},providedIn:"root"}),n})();const nG=new kt("appBaseHref");let rG=(()=>{class n extends Cu{constructor(e,r){super(),this._platformLocation=e,this._removeListenerFns=[],this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??zr($s).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}prepareExternalUrl(e){return zO(this._baseHref,e)}path(e=!1){const r=this._platformLocation.pathname+Al(this._platformLocation.search),s=this._platformLocation.hash;return s&&e?`${r}${s}`:r}pushState(e,r,s,i){const o=this.prepareExternalUrl(s+Al(i));this._platformLocation.pushState(e,r,o)}replaceState(e,r,s,i){const o=this.prepareExternalUrl(s+Al(i));this._platformLocation.replaceState(e,r,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(e=0){this._platformLocation.historyGo?.(e)}}return n.\u0275fac=function(e){return new(e||n)(De(DO),De(nG,8))},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Q0e=(()=>{class n extends Cu{constructor(e,r){super(),this._platformLocation=e,this._baseHref="",this._removeListenerFns=[],null!=r&&(this._baseHref=r)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}path(e=!1){let r=this._platformLocation.hash;return null==r&&(r="#"),r.length>0?r.substring(1):r}prepareExternalUrl(e){const r=zO(this._baseHref,e);return r.length>0?"#"+r:r}pushState(e,r,s,i){let o=this.prepareExternalUrl(s+Al(i));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.pushState(e,r,o)}replaceState(e,r,s,i){let o=this.prepareExternalUrl(s+Al(i));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.replaceState(e,r,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(e=0){this._platformLocation.historyGo?.(e)}}return n.\u0275fac=function(e){return new(e||n)(De(DO),De(nG,8))},n.\u0275prov=nt({token:n,factory:n.\u0275fac}),n})(),VO=(()=>{class n{constructor(e){this._subject=new mr,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=e;const r=this._locationStrategy.getBaseHref();this._baseHref=tG(sG(r)),this._locationStrategy.onPopState(s=>{this._subject.emit({url:this.path(!0),pop:!0,state:s.state,type:s.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(e=!1){return this.normalize(this._locationStrategy.path(e))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(e,r=""){return this.path()==this.normalize(e+Al(r))}normalize(e){return n.stripTrailingSlash(function e8e(n,t){return n&&t.startsWith(n)?t.substring(n.length):t}(this._baseHref,sG(e)))}prepareExternalUrl(e){return e&&"/"!==e[0]&&(e="/"+e),this._locationStrategy.prepareExternalUrl(e)}go(e,r="",s=null){this._locationStrategy.pushState(s,"",e,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+Al(r)),s)}replaceState(e,r="",s=null){this._locationStrategy.replaceState(s,"",e,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+Al(r)),s)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(e=0){this._locationStrategy.historyGo?.(e)}onUrlChange(e){return this._urlChangeListeners.push(e),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)})),()=>{const r=this._urlChangeListeners.indexOf(e);this._urlChangeListeners.splice(r,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(e="",r){this._urlChangeListeners.forEach(s=>s(e,r))}subscribe(e,r,s){return this._subject.subscribe({next:e,error:r,complete:s})}}return n.normalizeQueryParams=Al,n.joinWithSlash=zO,n.stripTrailingSlash=tG,n.\u0275fac=function(e){return new(e||n)(De(Cu))},n.\u0275prov=nt({token:n,factory:function(){return function J0e(){return new VO(De(Cu))}()},providedIn:"root"}),n})();function sG(n){return n.replace(/\/index.html$/,"")}var oa=(()=>((oa=oa||{})[oa.Decimal=0]="Decimal",oa[oa.Percent=1]="Percent",oa[oa.Currency=2]="Currency",oa[oa.Scientific=3]="Scientific",oa))(),Ss=(()=>((Ss=Ss||{})[Ss.Format=0]="Format",Ss[Ss.Standalone=1]="Standalone",Ss))(),Jn=(()=>((Jn=Jn||{})[Jn.Narrow=0]="Narrow",Jn[Jn.Abbreviated=1]="Abbreviated",Jn[Jn.Wide=2]="Wide",Jn[Jn.Short=3]="Short",Jn))(),Xr=(()=>((Xr=Xr||{})[Xr.Short=0]="Short",Xr[Xr.Medium=1]="Medium",Xr[Xr.Long=2]="Long",Xr[Xr.Full=3]="Full",Xr))(),Jt=(()=>((Jt=Jt||{})[Jt.Decimal=0]="Decimal",Jt[Jt.Group=1]="Group",Jt[Jt.List=2]="List",Jt[Jt.PercentSign=3]="PercentSign",Jt[Jt.PlusSign=4]="PlusSign",Jt[Jt.MinusSign=5]="MinusSign",Jt[Jt.Exponential=6]="Exponential",Jt[Jt.SuperscriptingExponent=7]="SuperscriptingExponent",Jt[Jt.PerMille=8]="PerMille",Jt[Jt.Infinity=9]="Infinity",Jt[Jt.NaN=10]="NaN",Jt[Jt.TimeSeparator=11]="TimeSeparator",Jt[Jt.CurrencyDecimal=12]="CurrencyDecimal",Jt[Jt.CurrencyGroup=13]="CurrencyGroup",Jt))();function dy(n,t){return wc(Po(n)[_t.DateFormat],t)}function py(n,t){return wc(Po(n)[_t.TimeFormat],t)}function gy(n,t){return wc(Po(n)[_t.DateTimeFormat],t)}function Tc(n,t){const e=Po(n),r=e[_t.NumberSymbols][t];if(typeof r>"u"){if(t===Jt.CurrencyDecimal)return e[_t.NumberSymbols][Jt.Decimal];if(t===Jt.CurrencyGroup)return e[_t.NumberSymbols][Jt.Group]}return r}function oG(n){if(!n[_t.ExtraData])throw new Error(`Missing extra locale data for the locale "${n[_t.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function wc(n,t){for(let e=t;e>-1;e--)if(typeof n[e]<"u")return n[e];throw new Error("Locale data API: locale data undefined")}function FO(n){const[t,e]=n.split(":");return{hours:+t,minutes:+e}}const d8e=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,fp={},p8e=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;var di=(()=>((di=di||{})[di.Short=0]="Short",di[di.ShortGMT=1]="ShortGMT",di[di.Long=2]="Long",di[di.Extended=3]="Extended",di))(),ln=(()=>((ln=ln||{})[ln.FullYear=0]="FullYear",ln[ln.Month=1]="Month",ln[ln.Date=2]="Date",ln[ln.Hours=3]="Hours",ln[ln.Minutes=4]="Minutes",ln[ln.Seconds=5]="Seconds",ln[ln.FractionalSeconds=6]="FractionalSeconds",ln[ln.Day=7]="Day",ln))(),Rn=(()=>((Rn=Rn||{})[Rn.DayPeriods=0]="DayPeriods",Rn[Rn.Days=1]="Days",Rn[Rn.Months=2]="Months",Rn[Rn.Eras=3]="Eras",Rn))();function aG(n,t,e,r){let s=function S8e(n){if(uG(n))return n;if("number"==typeof n&&!isNaN(n))return new Date(n);if("string"==typeof n){if(n=n.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(n)){const[s,i=1,o=1]=n.split("-").map(c=>+c);return my(s,i-1,o)}const e=parseFloat(n);if(!isNaN(n-e))return new Date(e);let r;if(r=n.match(d8e))return function P8e(n){const t=new Date(0);let e=0,r=0;const s=n[8]?t.setUTCFullYear:t.setFullYear,i=n[8]?t.setUTCHours:t.setHours;n[9]&&(e=Number(n[9]+n[10]),r=Number(n[9]+n[11])),s.call(t,Number(n[1]),Number(n[2])-1,Number(n[3]));const o=Number(n[4]||0)-e,c=Number(n[5]||0)-r,u=Number(n[6]||0),h=Math.floor(1e3*parseFloat("0."+(n[7]||0)));return i.call(t,o,c,u,h),t}(r)}const t=new Date(n);if(!uG(t))throw new Error(`Unable to convert "${n}" into a date`);return t}(n);t=Il(e,t)||t;let c,o=[];for(;t;){if(c=p8e.exec(t),!c){o.push(t);break}{o=o.concat(c.slice(1));const p=o.pop();if(!p)break;t=p}}let u=s.getTimezoneOffset();r&&(u=lG(r,u),s=function M8e(n,t,e){const r=e?-1:1,s=n.getTimezoneOffset();return function E8e(n,t){return(n=new Date(n.getTime())).setMinutes(n.getMinutes()+t),n}(n,r*(lG(t,s)-s))}(s,r,!0));let h="";return o.forEach(p=>{const m=function y8e(n){if($O[n])return $O[n];let t;switch(n){case"G":case"GG":case"GGG":t=_r(Rn.Eras,Jn.Abbreviated);break;case"GGGG":t=_r(Rn.Eras,Jn.Wide);break;case"GGGGG":t=_r(Rn.Eras,Jn.Narrow);break;case"y":t=Gs(ln.FullYear,1,0,!1,!0);break;case"yy":t=Gs(ln.FullYear,2,0,!0,!0);break;case"yyy":t=Gs(ln.FullYear,3,0,!1,!0);break;case"yyyy":t=Gs(ln.FullYear,4,0,!1,!0);break;case"Y":t=yy(1);break;case"YY":t=yy(2,!0);break;case"YYY":t=yy(3);break;case"YYYY":t=yy(4);break;case"M":case"L":t=Gs(ln.Month,1,1);break;case"MM":case"LL":t=Gs(ln.Month,2,1);break;case"MMM":t=_r(Rn.Months,Jn.Abbreviated);break;case"MMMM":t=_r(Rn.Months,Jn.Wide);break;case"MMMMM":t=_r(Rn.Months,Jn.Narrow);break;case"LLL":t=_r(Rn.Months,Jn.Abbreviated,Ss.Standalone);break;case"LLLL":t=_r(Rn.Months,Jn.Wide,Ss.Standalone);break;case"LLLLL":t=_r(Rn.Months,Jn.Narrow,Ss.Standalone);break;case"w":t=BO(1);break;case"ww":t=BO(2);break;case"W":t=BO(1,!0);break;case"d":t=Gs(ln.Date,1);break;case"dd":t=Gs(ln.Date,2);break;case"c":case"cc":t=Gs(ln.Day,1);break;case"ccc":t=_r(Rn.Days,Jn.Abbreviated,Ss.Standalone);break;case"cccc":t=_r(Rn.Days,Jn.Wide,Ss.Standalone);break;case"ccccc":t=_r(Rn.Days,Jn.Narrow,Ss.Standalone);break;case"cccccc":t=_r(Rn.Days,Jn.Short,Ss.Standalone);break;case"E":case"EE":case"EEE":t=_r(Rn.Days,Jn.Abbreviated);break;case"EEEE":t=_r(Rn.Days,Jn.Wide);break;case"EEEEE":t=_r(Rn.Days,Jn.Narrow);break;case"EEEEEE":t=_r(Rn.Days,Jn.Short);break;case"a":case"aa":case"aaa":t=_r(Rn.DayPeriods,Jn.Abbreviated);break;case"aaaa":t=_r(Rn.DayPeriods,Jn.Wide);break;case"aaaaa":t=_r(Rn.DayPeriods,Jn.Narrow);break;case"b":case"bb":case"bbb":t=_r(Rn.DayPeriods,Jn.Abbreviated,Ss.Standalone,!0);break;case"bbbb":t=_r(Rn.DayPeriods,Jn.Wide,Ss.Standalone,!0);break;case"bbbbb":t=_r(Rn.DayPeriods,Jn.Narrow,Ss.Standalone,!0);break;case"B":case"BB":case"BBB":t=_r(Rn.DayPeriods,Jn.Abbreviated,Ss.Format,!0);break;case"BBBB":t=_r(Rn.DayPeriods,Jn.Wide,Ss.Format,!0);break;case"BBBBB":t=_r(Rn.DayPeriods,Jn.Narrow,Ss.Format,!0);break;case"h":t=Gs(ln.Hours,1,-12);break;case"hh":t=Gs(ln.Hours,2,-12);break;case"H":t=Gs(ln.Hours,1);break;case"HH":t=Gs(ln.Hours,2);break;case"m":t=Gs(ln.Minutes,1);break;case"mm":t=Gs(ln.Minutes,2);break;case"s":t=Gs(ln.Seconds,1);break;case"ss":t=Gs(ln.Seconds,2);break;case"S":t=Gs(ln.FractionalSeconds,1);break;case"SS":t=Gs(ln.FractionalSeconds,2);break;case"SSS":t=Gs(ln.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":t=vy(di.Short);break;case"ZZZZZ":t=vy(di.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":t=vy(di.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":t=vy(di.Long);break;default:return null}return $O[n]=t,t}(p);h+=m?m(s,e,u):"''"===p?"'":p.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),h}function my(n,t,e){const r=new Date(0);return r.setFullYear(n,t,e),r.setHours(0,0,0),r}function Il(n,t){const e=function t8e(n){return Po(n)[_t.LocaleId]}(n);if(fp[e]=fp[e]||{},fp[e][t])return fp[e][t];let r="";switch(t){case"shortDate":r=dy(n,Xr.Short);break;case"mediumDate":r=dy(n,Xr.Medium);break;case"longDate":r=dy(n,Xr.Long);break;case"fullDate":r=dy(n,Xr.Full);break;case"shortTime":r=py(n,Xr.Short);break;case"mediumTime":r=py(n,Xr.Medium);break;case"longTime":r=py(n,Xr.Long);break;case"fullTime":r=py(n,Xr.Full);break;case"short":const s=Il(n,"shortTime"),i=Il(n,"shortDate");r=_y(gy(n,Xr.Short),[s,i]);break;case"medium":const o=Il(n,"mediumTime"),c=Il(n,"mediumDate");r=_y(gy(n,Xr.Medium),[o,c]);break;case"long":const u=Il(n,"longTime"),h=Il(n,"longDate");r=_y(gy(n,Xr.Long),[u,h]);break;case"full":const p=Il(n,"fullTime"),m=Il(n,"fullDate");r=_y(gy(n,Xr.Full),[p,m])}return r&&(fp[e][t]=r),r}function _y(n,t){return t&&(n=n.replace(/\{([^}]+)}/g,function(e,r){return null!=t&&r in t?t[r]:e})),n}function b3(n,t,e="-",r,s){let i="";(n<0||s&&n<=0)&&(s?n=1-n:(n=-n,i=e));let o=String(n);for(;o.length<t;)o="0"+o;return r&&(o=o.slice(o.length-t)),i+o}function Gs(n,t,e=0,r=!1,s=!1){return function(i,o){let c=function m8e(n,t){switch(n){case ln.FullYear:return t.getFullYear();case ln.Month:return t.getMonth();case ln.Date:return t.getDate();case ln.Hours:return t.getHours();case ln.Minutes:return t.getMinutes();case ln.Seconds:return t.getSeconds();case ln.FractionalSeconds:return t.getMilliseconds();case ln.Day:return t.getDay();default:throw new Error(`Unknown DateType value "${n}".`)}}(n,i);if((e>0||c>-e)&&(c+=e),n===ln.Hours)0===c&&-12===e&&(c=12);else if(n===ln.FractionalSeconds)return function g8e(n,t){return b3(n,3).substring(0,t)}(c,t);const u=Tc(o,Jt.MinusSign);return b3(c,t,u,r,s)}}function _r(n,t,e=Ss.Format,r=!1){return function(s,i){return function _8e(n,t,e,r,s,i){switch(e){case Rn.Months:return function s8e(n,t,e){const r=Po(n),i=wc([r[_t.MonthsFormat],r[_t.MonthsStandalone]],t);return wc(i,e)}(t,s,r)[n.getMonth()];case Rn.Days:return function r8e(n,t,e){const r=Po(n),i=wc([r[_t.DaysFormat],r[_t.DaysStandalone]],t);return wc(i,e)}(t,s,r)[n.getDay()];case Rn.DayPeriods:const o=n.getHours(),c=n.getMinutes();if(i){const h=function c8e(n){const t=Po(n);return oG(t),(t[_t.ExtraData][2]||[]).map(r=>"string"==typeof r?FO(r):[FO(r[0]),FO(r[1])])}(t),p=function l8e(n,t,e){const r=Po(n);oG(r);const i=wc([r[_t.ExtraData][0],r[_t.ExtraData][1]],t)||[];return wc(i,e)||[]}(t,s,r),m=h.findIndex(C=>{if(Array.isArray(C)){const[w,I]=C,H=o>=w.hours&&c>=w.minutes,K=o<I.hours||o===I.hours&&c<I.minutes;if(w.hours<I.hours){if(H&&K)return!0}else if(H||K)return!0}else if(C.hours===o&&C.minutes===c)return!0;return!1});if(-1!==m)return p[m]}return function n8e(n,t,e){const r=Po(n),i=wc([r[_t.DayPeriodsFormat],r[_t.DayPeriodsStandalone]],t);return wc(i,e)}(t,s,r)[o<12?0:1];case Rn.Eras:return function i8e(n,t){return wc(Po(n)[_t.Eras],t)}(t,r)[n.getFullYear()<=0?0:1];default:throw new Error(`unexpected translation type ${e}`)}}(s,i,n,t,e,r)}}function vy(n){return function(t,e,r){const s=-1*r,i=Tc(e,Jt.MinusSign),o=s>0?Math.floor(s/60):Math.ceil(s/60);switch(n){case di.Short:return(s>=0?"+":"")+b3(o,2,i)+b3(Math.abs(s%60),2,i);case di.ShortGMT:return"GMT"+(s>=0?"+":"")+b3(o,1,i);case di.Long:return"GMT"+(s>=0?"+":"")+b3(o,2,i)+":"+b3(Math.abs(s%60),2,i);case di.Extended:return 0===r?"Z":(s>=0?"+":"")+b3(o,2,i)+":"+b3(Math.abs(s%60),2,i);default:throw new Error(`Unknown zone width "${n}"`)}}}function cG(n){return my(n.getFullYear(),n.getMonth(),n.getDate()+(4-n.getDay()))}function BO(n,t=!1){return function(e,r){let s;if(t){const i=new Date(e.getFullYear(),e.getMonth(),1).getDay()-1,o=e.getDate();s=1+Math.floor((o+i)/7)}else{const i=cG(e),o=function C8e(n){const t=my(n,0,1).getDay();return my(n,0,1+(t<=4?4:11)-t)}(i.getFullYear()),c=i.getTime()-o.getTime();s=1+Math.round(c/6048e5)}return b3(s,n,Tc(r,Jt.MinusSign))}}function yy(n,t=!1){return function(e,r){return b3(cG(e).getFullYear(),n,Tc(r,Jt.MinusSign),t)}}const $O={};function lG(n,t){n=n.replace(/:/g,"");const e=Date.parse("Jan 01, 1970 00:00:00 "+n)/6e4;return isNaN(e)?t:e}function uG(n){return n instanceof Date&&!isNaN(n.valueOf())}const T8e=/^(\d+)?\.((\d+)(-(\d+))?)?$/;function qO(n){const t=parseInt(n);if(isNaN(t))throw new Error("Invalid integer literal when parsing "+n);return t}function pG(n,t){t=encodeURIComponent(t);for(const e of n.split(";")){const r=e.indexOf("="),[s,i]=-1==r?[e,""]:[e.slice(0,r),e.slice(r+1)];if(s.trim()===t)return decodeURIComponent(i)}return null}let dn=(()=>{class n{constructor(e,r,s,i){this._iterableDiffers=e,this._keyValueDiffers=r,this._ngEl=s,this._renderer=i,this._iterableDiffer=null,this._keyValueDiffer=null,this._initialClasses=[],this._rawClass=null}set klass(e){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof e?e.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}set ngClass(e){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof e?e.split(/\s+/):e,this._rawClass&&(Ve(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}ngDoCheck(){if(this._iterableDiffer){const e=this._iterableDiffer.diff(this._rawClass);e&&this._applyIterableChanges(e)}else if(this._keyValueDiffer){const e=this._keyValueDiffer.diff(this._rawClass);e&&this._applyKeyValueChanges(e)}}_applyKeyValueChanges(e){e.forEachAddedItem(r=>this._toggleClass(r.key,r.currentValue)),e.forEachChangedItem(r=>this._toggleClass(r.key,r.currentValue)),e.forEachRemovedItem(r=>{r.previousValue&&this._toggleClass(r.key,!1)})}_applyIterableChanges(e){e.forEachAddedItem(r=>{if("string"!=typeof r.item)throw new Error(`NgClass can only toggle CSS classes expressed as strings, got ${Y1(r.item)}`);this._toggleClass(r.item,!0)}),e.forEachRemovedItem(r=>this._toggleClass(r.item,!1))}_applyClasses(e){e&&(Array.isArray(e)||e instanceof Set?e.forEach(r=>this._toggleClass(r,!0)):Object.keys(e).forEach(r=>this._toggleClass(r,!!e[r])))}_removeClasses(e){e&&(Array.isArray(e)||e instanceof Set?e.forEach(r=>this._toggleClass(r,!1)):Object.keys(e).forEach(r=>this._toggleClass(r,!1)))}_toggleClass(e,r){(e=e.trim())&&e.split(/\s+/g).forEach(s=>{r?this._renderer.addClass(this._ngEl.nativeElement,s):this._renderer.removeClass(this._ngEl.nativeElement,s)})}}return n.\u0275fac=function(e){return new(e||n)(J(fy),J(up),J(h2),J(yo))},n.\u0275dir=Ut({type:n,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"},standalone:!0}),n})();class V8e{constructor(t,e,r,s){this.$implicit=t,this.ngForOf=e,this.index=r,this.count=s}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let An=(()=>{class n{constructor(e,r,s){this._viewContainer=e,this._template=r,this._differs=s,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(e){this._ngForOf=e,this._ngForOfDirty=!0}set ngForTrackBy(e){this._trackByFn=e}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(e){e&&(this._template=e)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const e=this._ngForOf;!this._differ&&e&&(this._differ=this._differs.find(e).create(this.ngForTrackBy))}if(this._differ){const e=this._differ.diff(this._ngForOf);e&&this._applyChanges(e)}}_applyChanges(e){const r=this._viewContainer;e.forEachOperation((s,i,o)=>{if(null==s.previousIndex)r.createEmbeddedView(this._template,new V8e(s.item,this._ngForOf,-1,-1),null===o?void 0:o);else if(null==o)r.remove(null===i?void 0:i);else if(null!==i){const c=r.get(i);r.move(c,o),_G(c,s)}});for(let s=0,i=r.length;s<i;s++){const c=r.get(s).context;c.index=s,c.count=i,c.ngForOf=this._ngForOf}e.forEachIdentityChange(s=>{_G(r.get(s.currentIndex),s)})}static ngTemplateContextGuard(e,r){return!0}}return n.\u0275fac=function(e){return new(e||n)(J(za),J(bl),J(fy))},n.\u0275dir=Ut({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0}),n})();function _G(n,t){n.context.$implicit=t.item}let en=(()=>{class n{constructor(e,r){this._viewContainer=e,this._context=new F8e,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=r}set ngIf(e){this._context.$implicit=this._context.ngIf=e,this._updateView()}set ngIfThen(e){vG("ngIfThen",e),this._thenTemplateRef=e,this._thenViewRef=null,this._updateView()}set ngIfElse(e){vG("ngIfElse",e),this._elseTemplateRef=e,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(e,r){return!0}}return n.\u0275fac=function(e){return new(e||n)(J(za),J(bl))},n.\u0275dir=Ut({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0}),n})();class F8e{constructor(){this.$implicit=null,this.ngIf=null}}function vG(n,t){if(t&&!t.createEmbeddedView)throw new Error(`${n} must be a TemplateRef, but received '${Y1(t)}'.`)}let EG=(()=>{class n{constructor(e){this._locale=e}transform(e,r,s){if(!function KO(n){return!(null==n||""===n||n!=n)}(e))return null;s=s||this._locale;try{return function I8e(n,t,e){return function GO(n,t,e,r,s,i,o=!1){let c="",u=!1;if(isFinite(n)){let h=function k8e(n){let r,s,i,o,c,t=Math.abs(n)+"",e=0;for((s=t.indexOf("."))>-1&&(t=t.replace(".","")),(i=t.search(/e/i))>0?(s<0&&(s=i),s+=+t.slice(i+1),t=t.substring(0,i)):s<0&&(s=t.length),i=0;"0"===t.charAt(i);i++);if(i===(c=t.length))r=[0],s=1;else{for(c--;"0"===t.charAt(c);)c--;for(s-=i,r=[],o=0;i<=c;i++,o++)r[o]=Number(t.charAt(i))}return s>22&&(r=r.splice(0,21),e=s-1,s=1),{digits:r,exponent:e,integerLen:s}}(n);o&&(h=function x8e(n){if(0===n.digits[0])return n;const t=n.digits.length-n.integerLen;return n.exponent?n.exponent+=2:(0===t?n.digits.push(0,0):1===t&&n.digits.push(0),n.integerLen+=2),n}(h));let p=t.minInt,m=t.minFrac,C=t.maxFrac;if(i){const ye=i.match(T8e);if(null===ye)throw new Error(`${i} is not a valid digit info`);const te=ye[1],ke=ye[3],$e=ye[5];null!=te&&(p=qO(te)),null!=ke&&(m=qO(ke)),null!=$e?C=qO($e):null!=ke&&m>C&&(C=m)}!function L8e(n,t,e){if(t>e)throw new Error(`The minimum number of digits after fraction (${t}) is higher than the maximum (${e}).`);let r=n.digits,s=r.length-n.integerLen;const i=Math.min(Math.max(t,s),e);let o=i+n.integerLen,c=r[o];if(o>0){r.splice(Math.max(n.integerLen,o));for(let m=o;m<r.length;m++)r[m]=0}else{s=Math.max(0,s),n.integerLen=1,r.length=Math.max(1,o=i+1),r[0]=0;for(let m=1;m<o;m++)r[m]=0}if(c>=5)if(o-1<0){for(let m=0;m>o;m--)r.unshift(0),n.integerLen++;r.unshift(1),n.integerLen++}else r[o-1]++;for(;s<Math.max(0,i);s++)r.push(0);let u=0!==i;const h=t+n.integerLen,p=r.reduceRight(function(m,C,w,I){return I[w]=(C+=m)<10?C:C-10,u&&(0===I[w]&&w>=h?I.pop():u=!1),C>=10?1:0},0);p&&(r.unshift(p),n.integerLen++)}(h,m,C);let w=h.digits,I=h.integerLen;const H=h.exponent;let K=[];for(u=w.every(ye=>!ye);I<p;I++)w.unshift(0);for(;I<0;I++)w.unshift(0);I>0?K=w.splice(I,w.length):(K=w,w=[0]);const ie=[];for(w.length>=t.lgSize&&ie.unshift(w.splice(-t.lgSize,w.length).join(""));w.length>t.gSize;)ie.unshift(w.splice(-t.gSize,w.length).join(""));w.length&&ie.unshift(w.join("")),c=ie.join(Tc(e,r)),K.length&&(c+=Tc(e,s)+K.join("")),H&&(c+=Tc(e,Jt.Exponential)+"+"+H)}else c=Tc(e,Jt.Infinity);return c=n<0&&!u?t.negPre+c+t.negSuf:t.posPre+c+t.posSuf,c}(n,function WO(n,t="-"){const e={minInt:1,minFrac:0,maxFrac:0,posPre:"",posSuf:"",negPre:"",negSuf:"",gSize:0,lgSize:0},r=n.split(";"),s=r[0],i=r[1],o=-1!==s.indexOf(".")?s.split("."):[s.substring(0,s.lastIndexOf("0")+1),s.substring(s.lastIndexOf("0")+1)],c=o[0],u=o[1]||"";e.posPre=c.substring(0,c.indexOf("#"));for(let p=0;p<u.length;p++){const m=u.charAt(p);"0"===m?e.minFrac=e.maxFrac=p+1:"#"===m?e.maxFrac=p+1:e.posSuf+=m}const h=c.split(",");if(e.gSize=h[1]?h[1].length:0,e.lgSize=h[2]||h[1]?(h[2]||h[1]).length:0,i){const p=s.length-e.posPre.length-e.posSuf.length,m=i.indexOf("#");e.negPre=i.substring(0,m).replace(/'/g,""),e.negSuf=i.slice(m+p).replace(/'/g,"")}else e.negPre=t+e.posPre,e.negSuf=e.posSuf;return e}(function HO(n,t){return Po(n)[_t.NumberFormats][t]}(t,oa.Decimal),Tc(t,Jt.MinusSign)),t,Jt.Group,Jt.Decimal,e)}(function XO(n){if("string"==typeof n&&!isNaN(Number(n)-parseFloat(n)))return Number(n);if("number"!=typeof n)throw new Error(`${n} is not a number`);return n}(e),s,r)}catch(i){throw function O3(n,t){return new Ae(2100,!1)}()}}}return n.\u0275fac=function(e){return new(e||n)(J(C4,16))},n.\u0275pipe=ai({name:"number",type:n,pure:!0,standalone:!0}),n})();let hue=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=oi({type:n}),n.\u0275inj=jr({}),n})();let mue=(()=>{class n{}return n.\u0275prov=nt({token:n,providedIn:"root",factory:()=>new _ue(De($s),window)}),n})();class _ue{constructor(t,e){this.document=t,this.window=e,this.offset=()=>[0,0]}setOffset(t){this.offset=Array.isArray(t)?()=>t:t}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(t){this.supportsScrolling()&&this.window.scrollTo(t[0],t[1])}scrollToAnchor(t){if(!this.supportsScrolling())return;const e=function vue(n,t){const e=n.getElementById(t)||n.getElementsByName(t)[0];if(e)return e;if("function"==typeof n.createTreeWalker&&n.body&&(n.body.createShadowRoot||n.body.attachShadow)){const r=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT);let s=r.currentNode;for(;s;){const i=s.shadowRoot;if(i){const o=i.getElementById(t)||i.querySelector(`[name="${t}"]`);if(o)return o}s=r.nextNode()}}return null}(this.document,t);e&&(this.scrollToElement(e),e.focus())}setHistoryScrollRestoration(t){if(this.supportScrollRestoration()){const e=this.window.history;e&&e.scrollRestoration&&(e.scrollRestoration=t)}}scrollToElement(t){const e=t.getBoundingClientRect(),r=e.left+this.window.pageXOffset,s=e.top+this.window.pageYOffset,i=this.offset();this.window.scrollTo(r-i[0],s-i[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const t=SG(this.window.history)||SG(Object.getPrototypeOf(this.window.history));return!(!t||!t.writable&&!t.set)}catch{return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}function SG(n){return Object.getOwnPropertyDescriptor(n,"scrollRestoration")}class PG{}class eN extends class Due extends class Z0e{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){!function j0e(n){hy||(hy=n)}(new eN)}onAndCancel(t,e,r){return t.addEventListener(e,r,!1),()=>{t.removeEventListener(e,r,!1)}}dispatchEvent(t,e){t.dispatchEvent(e)}remove(t){t.parentNode&&t.parentNode.removeChild(t)}createElement(t,e){return(e=e||this.getDefaultDocument()).createElement(t)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(t){return t.nodeType===Node.ELEMENT_NODE}isShadowRoot(t){return t instanceof DocumentFragment}getGlobalEventTarget(t,e){return"window"===e?window:"document"===e?t:"body"===e?t.body:null}getBaseHref(t){const e=function zue(){return pp=pp||document.querySelector("base"),pp?pp.getAttribute("href"):null}();return null==e?null:function Vue(n){Sy=Sy||document.createElement("a"),Sy.setAttribute("href",n);const t=Sy.pathname;return"/"===t.charAt(0)?t:`/${t}`}(e)}resetBaseElement(){pp=null}getUserAgent(){return window.navigator.userAgent}getCookie(t){return pG(document.cookie,t)}}let Sy,pp=null;const OG=new kt("TRANSITION_ID"),Fue=[{provide:iy,useFactory:function Hue(n,t,e){return()=>{e.get(oy).donePromise.then(()=>{const r=y4(),s=t.querySelectorAll(`style[ng-transition="${n}"]`);for(let i=0;i<s.length;i++)r.remove(s[i])})}},deps:[OG,$s,fi],multi:!0}];let $ue=(()=>{class n{build(){return new XMLHttpRequest}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=nt({token:n,factory:n.\u0275fac}),n})();const Py=new kt("EventManagerPlugins");let Ty=(()=>{class n{constructor(e,r){this._zone=r,this._eventNameToPlugin=new Map,e.forEach(s=>s.manager=this),this._plugins=e.slice().reverse()}addEventListener(e,r,s){return this._findPluginFor(r).addEventListener(e,r,s)}addGlobalEventListener(e,r,s){return this._findPluginFor(r).addGlobalEventListener(e,r,s)}getZone(){return this._zone}_findPluginFor(e){const r=this._eventNameToPlugin.get(e);if(r)return r;const s=this._plugins;for(let i=0;i<s.length;i++){const o=s[i];if(o.supports(e))return this._eventNameToPlugin.set(e,o),o}throw new Error(`No event manager plugin found for event ${e}`)}}return n.\u0275fac=function(e){return new(e||n)(De(Py),De(Pr))},n.\u0275prov=nt({token:n,factory:n.\u0275fac}),n})();class NG{constructor(t){this._doc=t}addGlobalEventListener(t,e,r){const s=y4().getGlobalEventTarget(this._doc,t);if(!s)throw new Error(`Unsupported event target ${s} for event ${e}`);return this.addEventListener(s,e,r)}}let AG=(()=>{class n{constructor(){this._stylesSet=new Set}addStyles(e){const r=new Set;e.forEach(s=>{this._stylesSet.has(s)||(this._stylesSet.add(s),r.add(s))}),this.onStylesAdded(r)}onStylesAdded(e){}getAllStyles(){return Array.from(this._stylesSet)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=nt({token:n,factory:n.\u0275fac}),n})(),gp=(()=>{class n extends AG{constructor(e){super(),this._doc=e,this._hostNodes=new Map,this._hostNodes.set(e.head,[])}_addStylesToHost(e,r,s){e.forEach(i=>{const o=this._doc.createElement("style");o.textContent=i,s.push(r.appendChild(o))})}addHost(e){const r=[];this._addStylesToHost(this._stylesSet,e,r),this._hostNodes.set(e,r)}removeHost(e){const r=this._hostNodes.get(e);r&&r.forEach(IG),this._hostNodes.delete(e)}onStylesAdded(e){this._hostNodes.forEach((r,s)=>{this._addStylesToHost(e,s,r)})}ngOnDestroy(){this._hostNodes.forEach(e=>e.forEach(IG))}}return n.\u0275fac=function(e){return new(e||n)(De($s))},n.\u0275prov=nt({token:n,factory:n.\u0275fac}),n})();function IG(n){y4().remove(n)}const tN={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},nN=/%COMP%/g;function wy(n,t,e){for(let r=0;r<t.length;r++){let s=t[r];Array.isArray(s)?wy(n,s,e):(s=s.replace(nN,n),e.push(s))}return e}function LG(n){return t=>{if("__ngUnwrap__"===t)return n;!1===n(t)&&(t.preventDefault(),t.returnValue=!1)}}let by=(()=>{class n{constructor(e,r,s){this.eventManager=e,this.sharedStylesHost=r,this.appId=s,this.rendererByCompId=new Map,this.defaultRenderer=new rN(e)}createRenderer(e,r){if(!e||!r)return this.defaultRenderer;switch(r.encapsulation){case z1.Emulated:{let s=this.rendererByCompId.get(r.id);return s||(s=new Zue(this.eventManager,this.sharedStylesHost,r,this.appId),this.rendererByCompId.set(r.id,s)),s.applyToHost(e),s}case 1:case z1.ShadowDom:return new Yue(this.eventManager,this.sharedStylesHost,e,r);default:if(!this.rendererByCompId.has(r.id)){const s=wy(r.id,r.styles,[]);this.sharedStylesHost.addStyles(s),this.rendererByCompId.set(r.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return n.\u0275fac=function(e){return new(e||n)(De(Ty),De(gp),De(ap))},n.\u0275prov=nt({token:n,factory:n.\u0275fac}),n})();class rN{constructor(t){this.eventManager=t,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(t,e){return e?document.createElementNS(tN[e]||e,t):document.createElement(t)}createComment(t){return document.createComment(t)}createText(t){return document.createTextNode(t)}appendChild(t,e){(DG(t)?t.content:t).appendChild(e)}insertBefore(t,e,r){t&&(DG(t)?t.content:t).insertBefore(e,r)}removeChild(t,e){t&&t.removeChild(e)}selectRootElement(t,e){let r="string"==typeof t?document.querySelector(t):t;if(!r)throw new Error(`The selector "${t}" did not match any elements`);return e||(r.textContent=""),r}parentNode(t){return t.parentNode}nextSibling(t){return t.nextSibling}setAttribute(t,e,r,s){if(s){e=s+":"+e;const i=tN[s];i?t.setAttributeNS(i,e,r):t.setAttribute(e,r)}else t.setAttribute(e,r)}removeAttribute(t,e,r){if(r){const s=tN[r];s?t.removeAttributeNS(s,e):t.removeAttribute(`${r}:${e}`)}else t.removeAttribute(e)}addClass(t,e){t.classList.add(e)}removeClass(t,e){t.classList.remove(e)}setStyle(t,e,r,s){s&(p2.DashCase|p2.Important)?t.style.setProperty(e,r,s&p2.Important?"important":""):t.style[e]=r}removeStyle(t,e,r){r&p2.DashCase?t.style.removeProperty(e):t.style[e]=""}setProperty(t,e,r){t[e]=r}setValue(t,e){t.nodeValue=e}listen(t,e,r){return"string"==typeof t?this.eventManager.addGlobalEventListener(t,e,LG(r)):this.eventManager.addEventListener(t,e,LG(r))}}function DG(n){return"TEMPLATE"===n.tagName&&void 0!==n.content}class Zue extends rN{constructor(t,e,r,s){super(t),this.component=r;const i=wy(s+"-"+r.id,r.styles,[]);e.addStyles(i),this.contentAttr=function Wue(n){return"_ngcontent-%COMP%".replace(nN,n)}(s+"-"+r.id),this.hostAttr=function que(n){return"_nghost-%COMP%".replace(nN,n)}(s+"-"+r.id)}applyToHost(t){super.setAttribute(t,this.hostAttr,"")}createElement(t,e){const r=super.createElement(t,e);return super.setAttribute(r,this.contentAttr,""),r}}class Yue extends rN{constructor(t,e,r,s){super(t),this.sharedStylesHost=e,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const i=wy(s.id,s.styles,[]);for(let o=0;o<i.length;o++){const c=document.createElement("style");c.textContent=i[o],this.shadowRoot.appendChild(c)}}nodeOrShadowRoot(t){return t===this.hostEl?this.shadowRoot:t}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(t,e){return super.appendChild(this.nodeOrShadowRoot(t),e)}insertBefore(t,e,r){return super.insertBefore(this.nodeOrShadowRoot(t),e,r)}removeChild(t,e){return super.removeChild(this.nodeOrShadowRoot(t),e)}parentNode(t){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(t)))}}let Kue=(()=>{class n extends NG{constructor(e){super(e)}supports(e){return!0}addEventListener(e,r,s){return e.addEventListener(r,s,!1),()=>this.removeEventListener(e,r,s)}removeEventListener(e,r,s){return e.removeEventListener(r,s)}}return n.\u0275fac=function(e){return new(e||n)(De($s))},n.\u0275prov=nt({token:n,factory:n.\u0275fac}),n})();const zG=["alt","control","meta","shift"],Xue={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Que={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let Jue=(()=>{class n extends NG{constructor(e){super(e)}supports(e){return null!=n.parseEventName(e)}addEventListener(e,r,s){const i=n.parseEventName(r),o=n.eventCallback(i.fullKey,s,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>y4().onAndCancel(e,i.domEventName,o))}static parseEventName(e){const r=e.toLowerCase().split("."),s=r.shift();if(0===r.length||"keydown"!==s&&"keyup"!==s)return null;const i=n._normalizeKey(r.pop());let o="",c=r.indexOf("code");if(c>-1&&(r.splice(c,1),o="code."),zG.forEach(h=>{const p=r.indexOf(h);p>-1&&(r.splice(p,1),o+=h+".")}),o+=i,0!=r.length||0===i.length)return null;const u={};return u.domEventName=s,u.fullKey=o,u}static matchEventFullKeyCode(e,r){let s=Xue[e.key]||e.key,i="";return r.indexOf("code.")>-1&&(s=e.code,i="code."),!(null==s||!s)&&(s=s.toLowerCase()," "===s?s="space":"."===s&&(s="dot"),zG.forEach(o=>{o!==s&&(0,Que[o])(e)&&(i+=o+".")}),i+=s,i===r)}static eventCallback(e,r,s){return i=>{n.matchEventFullKeyCode(i,e)&&s.runGuarded(()=>r(i))}}static _normalizeKey(e){return"esc"===e?"escape":e}}return n.\u0275fac=function(e){return new(e||n)(De($s))},n.\u0275prov=nt({token:n,factory:n.\u0275fac}),n})();const HG=[{provide:cp,useValue:"browser"},{provide:SU,useValue:function e5e(){eN.makeCurrent()},multi:!0},{provide:$s,useFactory:function n5e(){return function KT(n){jh=n}(document),document},deps:[]}],r5e=LU(G0e,"browser",HG),FG=new kt(""),BG=[{provide:ay,useClass:class Bue{addToWindow(t){er.getAngularTestability=(r,s=!0)=>{const i=t.findTestabilityInTree(r,s);if(null==i)throw new Error("Could not find testability for element.");return i},er.getAllAngularTestabilities=()=>t.getAllTestabilities(),er.getAllAngularRootElements=()=>t.getAllRootElements(),er.frameworkStabilizers||(er.frameworkStabilizers=[]),er.frameworkStabilizers.push(r=>{const s=er.getAllAngularTestabilities();let i=s.length,o=!1;const c=function(u){o=o||u,i--,0==i&&r(o)};s.forEach(function(u){u.whenStable(c)})})}findTestabilityInTree(t,e,r){return null==e?null:t.getTestability(e)??(r?y4().isShadowRoot(e)?this.findTestabilityInTree(t,e.host,!0):this.findTestabilityInTree(t,e.parentElement,!0):null)}},deps:[]},{provide:AU,useClass:bO,deps:[Pr,OO,ay]},{provide:bO,useClass:bO,deps:[Pr,OO,ay]}],$G=[{provide:td,useValue:"root"},{provide:o0,useFactory:function t5e(){return new o0},deps:[]},{provide:Py,useClass:Kue,multi:!0,deps:[$s,Pr,cp]},{provide:Py,useClass:Jue,multi:!0,deps:[$s]},{provide:by,useClass:by,deps:[Ty,gp,ap]},{provide:r0,useExisting:by},{provide:AG,useExisting:gp},{provide:gp,useClass:gp,deps:[$s]},{provide:Ty,useClass:Ty,deps:[Py,Pr]},{provide:PG,useClass:$ue,deps:[]},[]];let UG=(()=>{class n{constructor(e){}static withServerTransition(e){return{ngModule:n,providers:[{provide:ap,useValue:e.appId},{provide:OG,useExisting:ap},Fue]}}}return n.\u0275fac=function(e){return new(e||n)(De(FG,12))},n.\u0275mod=oi({type:n}),n.\u0275inj=jr({providers:[...$G,...BG],imports:[hue,W0e]}),n})(),GG=(()=>{class n{constructor(e){this._doc=e}getTitle(){return this._doc.title}setTitle(e){this._doc.title=e||""}}return n.\u0275fac=function(e){return new(e||n)(De($s))},n.\u0275prov=nt({token:n,factory:function(e){let r=null;return r=e?new e:function i5e(){return new GG(De($s))}(),r},providedIn:"root"}),n})();typeof window<"u"&&window;let jG=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=nt({token:n,factory:function(e){let r=null;return r=e?new(e||n):De(ZG),r},providedIn:"root"}),n})(),ZG=(()=>{class n extends jG{constructor(e){super(),this._doc=e}sanitize(e,r){if(null==r)return null;switch(e){case tr.NONE:return r;case tr.HTML:return _o(r,"HTML")?mo(r):Xh(this._doc,String(r)).toString();case tr.STYLE:return _o(r,"Style")?mo(r):r;case tr.SCRIPT:if(_o(r,"Script"))return mo(r);throw new Error("unsafe value used in a script context");case tr.URL:return _o(r,"URL")?mo(r):ra(String(r));case tr.RESOURCE_URL:if(_o(r,"ResourceURL"))return mo(r);throw new Error("unsafe value used in a resource URL context (see https://g.co/ng/security#xss)");default:throw new Error(`Unexpected SecurityContext ${e} (see https://g.co/ng/security#xss)`)}}bypassSecurityTrustHtml(e){return function cv(n){return new JT(n)}(e)}bypassSecurityTrustStyle(e){return function lv(n){return new ew(n)}(e)}bypassSecurityTrustScript(e){return function nw(n){return new tw(n)}(e)}bypassSecurityTrustUrl(e){return function rw(n){return new iv(n)}(e)}bypassSecurityTrustResourceUrl(e){return function sw(n){return new ov(n)}(e)}}return n.\u0275fac=function(e){return new(e||n)(De($s))},n.\u0275prov=nt({token:n,factory:function(e){let r=null;return r=e?new e:function h5e(n){return new ZG(n.get($s))}(De(fi)),r},providedIn:"root"}),n})();const{isArray:d5e}=Array,{getPrototypeOf:p5e,prototype:g5e,keys:m5e}=Object;function YG(n){if(1===n.length){const t=n[0];if(d5e(t))return{args:t,keys:null};if(function _5e(n){return n&&"object"==typeof n&&p5e(n)===g5e}(t)){const e=m5e(t);return{args:e.map(r=>t[r]),keys:e}}}return{args:n,keys:null}}const{isArray:v5e}=Array;function KG(n){return gn(t=>function C5e(n,t){return v5e(t)?n(...t):n(t)}(n,t))}function XG(n,t){return n.reduce((e,r,s)=>(e[r]=t[s],e),{})}let QG=(()=>{class n{constructor(e,r){this._renderer=e,this._elementRef=r,this.onChange=s=>{},this.onTouched=()=>{}}setProperty(e,r){this._renderer.setProperty(this._elementRef.nativeElement,e,r)}registerOnTouched(e){this.onTouched=e}registerOnChange(e){this.onChange=e}setDisabledState(e){this.setProperty("disabled",e)}}return n.\u0275fac=function(e){return new(e||n)(J(yo),J(h2))},n.\u0275dir=Ut({type:n}),n})(),yu=(()=>{class n extends QG{}return n.\u0275fac=function(){let t;return function(r){return(t||(t=Dr(n)))(r||n)}}(),n.\u0275dir=Ut({type:n,features:[l]}),n})();const E4=new kt("NgValueAccessor"),E5e={provide:E4,useExisting:M1(()=>oN),multi:!0};let oN=(()=>{class n extends yu{writeValue(e){this.setProperty("checked",e)}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=Dr(n)))(r||n)}}(),n.\u0275dir=Ut({type:n,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(e,r){1&e&&ee("change",function(i){return r.onChange(i.target.checked)})("blur",function(){return r.onTouched()})},features:[Vr([E5e]),l]}),n})();const M5e={provide:E4,useExisting:M1(()=>M4),multi:!0},P5e=new kt("CompositionEventMode");let M4=(()=>{class n extends QG{constructor(e,r,s){super(e,r),this._compositionMode=s,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function S5e(){const n=y4()?y4().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}())}writeValue(e){this.setProperty("value",e??"")}_handleInput(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}_compositionStart(){this._composing=!0}_compositionEnd(e){this._composing=!1,this._compositionMode&&this.onChange(e)}}return n.\u0275fac=function(e){return new(e||n)(J(yo),J(h2),J(P5e,8))},n.\u0275dir=Ut({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(e,r){1&e&&ee("input",function(i){return r._handleInput(i.target.value)})("blur",function(){return r.onTouched()})("compositionstart",function(){return r._compositionStart()})("compositionend",function(i){return r._compositionEnd(i.target.value)})},features:[Vr([M5e]),l]}),n})();function _0(n){return null==n||("string"==typeof n||Array.isArray(n))&&0===n.length}function JG(n){return null!=n&&"number"==typeof n.length}const K2=new kt("NgValidators"),v0=new kt("NgAsyncValidators"),w5e=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class mp{static min(t){return function eW(n){return t=>{if(_0(t.value)||_0(n))return null;const e=parseFloat(t.value);return!isNaN(e)&&e<n?{min:{min:n,actual:t.value}}:null}}(t)}static max(t){return function tW(n){return t=>{if(_0(t.value)||_0(n))return null;const e=parseFloat(t.value);return!isNaN(e)&&e>n?{max:{max:n,actual:t.value}}:null}}(t)}static required(t){return nW(t)}static requiredTrue(t){return function rW(n){return!0===n.value?null:{required:!0}}(t)}static email(t){return function sW(n){return _0(n.value)||w5e.test(n.value)?null:{email:!0}}(t)}static minLength(t){return function iW(n){return t=>_0(t.value)||!JG(t.value)?null:t.value.length<n?{minlength:{requiredLength:n,actualLength:t.value.length}}:null}(t)}static maxLength(t){return oW(t)}static pattern(t){return function aW(n){if(!n)return Oy;let t,e;return"string"==typeof n?(e="","^"!==n.charAt(0)&&(e+="^"),e+=n,"$"!==n.charAt(n.length-1)&&(e+="$"),t=new RegExp(e)):(e=n.toString(),t=n),r=>{if(_0(r.value))return null;const s=r.value;return t.test(s)?null:{pattern:{requiredPattern:e,actualValue:s}}}}(t)}static nullValidator(t){return null}static compose(t){return dW(t)}static composeAsync(t){return pW(t)}}function nW(n){return _0(n.value)?{required:!0}:null}function oW(n){return t=>JG(t.value)&&t.value.length>n?{maxlength:{requiredLength:n,actualLength:t.value.length}}:null}function Oy(n){return null}function cW(n){return null!=n}function lW(n){return Xd(n)?ls(n):n}function uW(n){let t={};return n.forEach(e=>{t=null!=e?{...t,...e}:t}),0===Object.keys(t).length?null:t}function fW(n,t){return t.map(e=>e(n))}function hW(n){return n.map(t=>function b5e(n){return!n.validate}(t)?t:e=>t.validate(e))}function dW(n){if(!n)return null;const t=n.filter(cW);return 0==t.length?null:function(e){return uW(fW(e,t))}}function aN(n){return null!=n?dW(hW(n)):null}function pW(n){if(!n)return null;const t=n.filter(cW);return 0==t.length?null:function(e){return function y5e(...n){const t=Qt(n),{args:e,keys:r}=YG(n),s=new Er(i=>{const{length:o}=e;if(!o)return void i.complete();const c=new Array(o);let u=o,h=o;for(let p=0;p<o;p++){let m=!1;uo(e[p]).subscribe(cs(i,C=>{m||(m=!0,h--),c[p]=C},()=>u--,void 0,()=>{(!u||!m)&&(h||i.next(r?XG(r,c):c),i.complete())}))}});return t?s.pipe(KG(t)):s}(fW(e,t).map(lW)).pipe(gn(uW))}}function cN(n){return null!=n?pW(hW(n)):null}function gW(n,t){return null===n?[t]:Array.isArray(n)?[...n,t]:[n,t]}function mW(n){return n._rawValidators}function _W(n){return n._rawAsyncValidators}function lN(n){return n?Array.isArray(n)?n:[n]:[]}function Ny(n,t){return Array.isArray(n)?n.includes(t):n===t}function vW(n,t){const e=lN(t);return lN(n).forEach(s=>{Ny(e,s)||e.push(s)}),e}function CW(n,t){return lN(t).filter(e=>!Ny(n,e))}class yW{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(t){this._rawValidators=t||[],this._composedValidatorFn=aN(this._rawValidators)}_setAsyncValidators(t){this._rawAsyncValidators=t||[],this._composedAsyncValidatorFn=cN(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(t){this._onDestroyCallbacks.push(t)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(t=>t()),this._onDestroyCallbacks=[]}reset(t){this.control&&this.control.reset(t)}hasError(t,e){return!!this.control&&this.control.hasError(t,e)}getError(t,e){return this.control?this.control.getError(t,e):null}}class wo extends yW{get formDirective(){return null}get path(){return null}}class C0 extends yW{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class EW{constructor(t){this._cd=t}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let xl=(()=>{class n extends EW{constructor(e){super(e)}}return n.\u0275fac=function(e){return new(e||n)(J(C0,2))},n.\u0275dir=Ut({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(e,r){2&e&&ZC("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)},features:[l]}),n})(),Eu=(()=>{class n extends EW{constructor(e){super(e)}}return n.\u0275fac=function(e){return new(e||n)(J(wo,10))},n.\u0275dir=Ut({type:n,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(e,r){2&e&&ZC("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)("ng-submitted",r.isSubmitted)},features:[l]}),n})();const _p="VALID",Iy="INVALID",uf="PENDING",vp="DISABLED";function dN(n){return(xy(n)?n.validators:n)||null}function SW(n){return Array.isArray(n)?aN(n):n||null}function pN(n,t){return(xy(t)?t.asyncValidators:n)||null}function PW(n){return Array.isArray(n)?cN(n):n||null}function xy(n){return null!=n&&!Array.isArray(n)&&"object"==typeof n}function TW(n,t,e){const r=n.controls;if(!(t?Object.keys(r):r).length)throw new Ae(1e3,"");if(!r[e])throw new Ae(1001,"")}function wW(n,t,e){n._forEachChild((r,s)=>{if(void 0===e[s])throw new Ae(1002,"")})}class ky{constructor(t,e){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._rawValidators=t,this._rawAsyncValidators=e,this._composedValidatorFn=SW(this._rawValidators),this._composedAsyncValidatorFn=PW(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn}set validator(t){this._rawValidators=this._composedValidatorFn=t}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(t){this._rawAsyncValidators=this._composedAsyncValidatorFn=t}get parent(){return this._parent}get valid(){return this.status===_p}get invalid(){return this.status===Iy}get pending(){return this.status==uf}get disabled(){return this.status===vp}get enabled(){return this.status!==vp}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(t){this._rawValidators=t,this._composedValidatorFn=SW(t)}setAsyncValidators(t){this._rawAsyncValidators=t,this._composedAsyncValidatorFn=PW(t)}addValidators(t){this.setValidators(vW(t,this._rawValidators))}addAsyncValidators(t){this.setAsyncValidators(vW(t,this._rawAsyncValidators))}removeValidators(t){this.setValidators(CW(t,this._rawValidators))}removeAsyncValidators(t){this.setAsyncValidators(CW(t,this._rawAsyncValidators))}hasValidator(t){return Ny(this._rawValidators,t)}hasAsyncValidator(t){return Ny(this._rawAsyncValidators,t)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(t={}){this.touched=!0,this._parent&&!t.onlySelf&&this._parent.markAsTouched(t)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(t=>t.markAllAsTouched())}markAsUntouched(t={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(e=>{e.markAsUntouched({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}markAsDirty(t={}){this.pristine=!1,this._parent&&!t.onlySelf&&this._parent.markAsDirty(t)}markAsPristine(t={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(e=>{e.markAsPristine({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}markAsPending(t={}){this.status=uf,!1!==t.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!t.onlySelf&&this._parent.markAsPending(t)}disable(t={}){const e=this._parentMarkedDirty(t.onlySelf);this.status=vp,this.errors=null,this._forEachChild(r=>{r.disable({...t,onlySelf:!0})}),this._updateValue(),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...t,skipPristineCheck:e}),this._onDisabledChange.forEach(r=>r(!0))}enable(t={}){const e=this._parentMarkedDirty(t.onlySelf);this.status=_p,this._forEachChild(r=>{r.enable({...t,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent}),this._updateAncestors({...t,skipPristineCheck:e}),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(t){this._parent&&!t.onlySelf&&(this._parent.updateValueAndValidity(t),t.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(t){this._parent=t}getRawValue(){return this.value}updateValueAndValidity(t={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===_p||this.status===uf)&&this._runAsyncValidator(t.emitEvent)),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!t.onlySelf&&this._parent.updateValueAndValidity(t)}_updateTreeValidity(t={emitEvent:!0}){this._forEachChild(e=>e._updateTreeValidity(t)),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?vp:_p}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(t){if(this.asyncValidator){this.status=uf,this._hasOwnPendingAsyncValidator=!0;const e=lW(this.asyncValidator(this));this._asyncValidationSubscription=e.subscribe(r=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(r,{emitEvent:t})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(t,e={}){this.errors=t,this._updateControlsErrors(!1!==e.emitEvent)}get(t){let e=t;return null==e||(Array.isArray(e)||(e=e.split(".")),0===e.length)?null:e.reduce((r,s)=>r&&r._find(s),this)}getError(t,e){const r=e?this.get(e):this;return r&&r.errors?r.errors[t]:null}hasError(t,e){return!!this.getError(t,e)}get root(){let t=this;for(;t._parent;)t=t._parent;return t}_updateControlsErrors(t){this.status=this._calculateStatus(),t&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(t)}_initObservables(){this.valueChanges=new mr,this.statusChanges=new mr}_calculateStatus(){return this._allControlsDisabled()?vp:this.errors?Iy:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(uf)?uf:this._anyControlsHaveStatus(Iy)?Iy:_p}_anyControlsHaveStatus(t){return this._anyControls(e=>e.status===t)}_anyControlsDirty(){return this._anyControls(t=>t.dirty)}_anyControlsTouched(){return this._anyControls(t=>t.touched)}_updatePristine(t={}){this.pristine=!this._anyControlsDirty(),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}_updateTouched(t={}){this.touched=this._anyControlsTouched(),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}_registerOnCollectionChange(t){this._onCollectionChange=t}_setUpdateStrategy(t){xy(t)&&null!=t.updateOn&&(this._updateOn=t.updateOn)}_parentMarkedDirty(t){return!t&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(t){return null}}class y0 extends ky{constructor(t,e,r){super(dN(e),pN(r,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(t,e){return this.controls[t]?this.controls[t]:(this.controls[t]=e,e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange),e)}addControl(t,e,r={}){this.registerControl(t,e),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}removeControl(t,e={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}setControl(t,e,r={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],e&&this.registerControl(t,e),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}contains(t){return this.controls.hasOwnProperty(t)&&this.controls[t].enabled}setValue(t,e={}){wW(this,0,t),Object.keys(t).forEach(r=>{TW(this,!0,r),this.controls[r].setValue(t[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){null!=t&&(Object.keys(t).forEach(r=>{const s=this.controls[r];s&&s.patchValue(t[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(t={},e={}){this._forEachChild((r,s)=>{r.reset(t[s],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this._reduceChildren({},(t,e,r)=>(t[r]=e.getRawValue(),t))}_syncPendingControls(){let t=this._reduceChildren(!1,(e,r)=>!!r._syncPendingControls()||e);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_forEachChild(t){Object.keys(this.controls).forEach(e=>{const r=this.controls[e];r&&t(r,e)})}_setUpControls(){this._forEachChild(t=>{t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(t){for(const[e,r]of Object.entries(this.controls))if(this.contains(e)&&t(r))return!0;return!1}_reduceValue(){return this._reduceChildren({},(e,r,s)=>((r.enabled||this.disabled)&&(e[s]=r.value),e))}_reduceChildren(t,e){let r=t;return this._forEachChild((s,i)=>{r=e(r,s,i)}),r}_allControlsDisabled(){for(const t of Object.keys(this.controls))if(this.controls[t].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(t){return this.controls.hasOwnProperty(t)?this.controls[t]:null}}class bW extends y0{}function Ly(n,t){return[...t.path,n]}function Cp(n,t){gN(n,t),t.valueAccessor.writeValue(n.value),n.disabled&&t.valueAccessor.setDisabledState?.(!0),function R5e(n,t){t.valueAccessor.registerOnChange(e=>{n._pendingValue=e,n._pendingChange=!0,n._pendingDirty=!0,"change"===n.updateOn&&OW(n,t)})}(n,t),function z5e(n,t){const e=(r,s)=>{t.valueAccessor.writeValue(r),s&&t.viewToModelUpdate(r)};n.registerOnChange(e),t._registerOnDestroy(()=>{n._unregisterOnChange(e)})}(n,t),function D5e(n,t){t.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,"blur"===n.updateOn&&n._pendingChange&&OW(n,t),"submit"!==n.updateOn&&n.markAsTouched()})}(n,t),function L5e(n,t){if(t.valueAccessor.setDisabledState){const e=r=>{t.valueAccessor.setDisabledState(r)};n.registerOnDisabledChange(e),t._registerOnDestroy(()=>{n._unregisterOnDisabledChange(e)})}}(n,t)}function Ry(n,t,e=!0){const r=()=>{};t.valueAccessor&&(t.valueAccessor.registerOnChange(r),t.valueAccessor.registerOnTouched(r)),zy(n,t),n&&(t._invokeOnDestroyCallbacks(),n._registerOnCollectionChange(()=>{}))}function Dy(n,t){n.forEach(e=>{e.registerOnValidatorChange&&e.registerOnValidatorChange(t)})}function gN(n,t){const e=mW(n);null!==t.validator?n.setValidators(gW(e,t.validator)):"function"==typeof e&&n.setValidators([e]);const r=_W(n);null!==t.asyncValidator?n.setAsyncValidators(gW(r,t.asyncValidator)):"function"==typeof r&&n.setAsyncValidators([r]);const s=()=>n.updateValueAndValidity();Dy(t._rawValidators,s),Dy(t._rawAsyncValidators,s)}function zy(n,t){let e=!1;if(null!==n){if(null!==t.validator){const s=mW(n);if(Array.isArray(s)&&s.length>0){const i=s.filter(o=>o!==t.validator);i.length!==s.length&&(e=!0,n.setValidators(i))}}if(null!==t.asyncValidator){const s=_W(n);if(Array.isArray(s)&&s.length>0){const i=s.filter(o=>o!==t.asyncValidator);i.length!==s.length&&(e=!0,n.setAsyncValidators(i))}}}const r=()=>{};return Dy(t._rawValidators,r),Dy(t._rawAsyncValidators,r),e}function OW(n,t){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),t.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function NW(n,t){gN(n,t)}function mN(n,t){if(!n.hasOwnProperty("model"))return!1;const e=n.model;return!!e.isFirstChange()||!Object.is(t,e.currentValue)}function IW(n,t){n._syncPendingControls(),t.forEach(e=>{const r=e.control;"submit"===r.updateOn&&r._pendingChange&&(e.viewToModelUpdate(r._pendingValue),r._pendingChange=!1)})}function _N(n,t){if(!t)return null;let e,r,s;return Array.isArray(t),t.forEach(i=>{i.constructor===M4?e=i:function F5e(n){return Object.getPrototypeOf(n.constructor)===yu}(i)?r=i:s=i}),s||r||e||null}const $5e={provide:wo,useExisting:M1(()=>Ep)},yp=(()=>Promise.resolve())();let Ep=(()=>{class n extends wo{constructor(e,r){super(),this.submitted=!1,this._directives=new Set,this.ngSubmit=new mr,this.form=new y0({},aN(e),cN(r))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(e){yp.then(()=>{const r=this._findContainer(e.path);e.control=r.registerControl(e.name,e.control),Cp(e.control,e),e.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(e)})}getControl(e){return this.form.get(e.path)}removeControl(e){yp.then(()=>{const r=this._findContainer(e.path);r&&r.removeControl(e.name),this._directives.delete(e)})}addFormGroup(e){yp.then(()=>{const r=this._findContainer(e.path),s=new y0({});NW(s,e),r.registerControl(e.name,s),s.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(e){yp.then(()=>{const r=this._findContainer(e.path);r&&r.removeControl(e.name)})}getFormGroup(e){return this.form.get(e.path)}updateModel(e,r){yp.then(()=>{this.form.get(e.path).setValue(r)})}setValue(e){this.control.setValue(e)}onSubmit(e){return this.submitted=!0,IW(this.form,this._directives),this.ngSubmit.emit(e),"dialog"===e?.target?.method}onReset(){this.resetForm()}resetForm(e){this.form.reset(e),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(e){return e.pop(),e.length?this.form.get(e):this.form}}return n.\u0275fac=function(e){return new(e||n)(J(K2,10),J(v0,10))},n.\u0275dir=Ut({type:n,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(e,r){1&e&&ee("submit",function(i){return r.onSubmit(i)})("reset",function(){return r.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Vr([$5e]),l]}),n})();function xW(n,t){const e=n.indexOf(t);e>-1&&n.splice(e,1)}function kW(n){return"object"==typeof n&&null!==n&&2===Object.keys(n).length&&"value"in n&&"disabled"in n}const Va=class extends ky{constructor(t=null,e,r){super(dN(e),pN(r,e)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(t),this._setUpdateStrategy(e),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),xy(e)&&(e.nonNullable||e.initialValueIsDefault)&&(this.defaultValue=kW(t)?t.value:t)}setValue(t,e={}){this.value=this._pendingValue=t,this._onChange.length&&!1!==e.emitModelToViewChange&&this._onChange.forEach(r=>r(this.value,!1!==e.emitViewToModelChange)),this.updateValueAndValidity(e)}patchValue(t,e={}){this.setValue(t,e)}reset(t=this.defaultValue,e={}){this._applyFormState(t),this.markAsPristine(e),this.markAsUntouched(e),this.setValue(this.value,e),this._pendingChange=!1}_updateValue(){}_anyControls(t){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(t){this._onChange.push(t)}_unregisterOnChange(t){xW(this._onChange,t)}registerOnDisabledChange(t){this._onDisabledChange.push(t)}_unregisterOnDisabledChange(t){xW(this._onDisabledChange,t)}_forEachChild(t){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(t){kW(t)?(this.value=this._pendingValue=t.value,t.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=t}},W5e={provide:C0,useExisting:M1(()=>Mp)},DW=(()=>Promise.resolve())();let Mp=(()=>{class n extends C0{constructor(e,r,s,i,o){super(),this._changeDetectorRef=o,this.control=new Va,this._registered=!1,this.update=new mr,this._parent=e,this._setValidators(r),this._setAsyncValidators(s),this.valueAccessor=_N(0,i)}ngOnChanges(e){if(this._checkForErrors(),!this._registered||"name"in e){if(this._registered&&(this._checkName(),this.formDirective)){const r=e.name.previousValue;this.formDirective.removeControl({name:r,path:this._getPath(r)})}this._setUpControl()}"isDisabled"in e&&this._updateDisabled(e),mN(e,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){Cp(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(e){DW.then(()=>{this.control.setValue(e,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(e){const r=e.isDisabled.currentValue,s=0!==r&&Nl(r);DW.then(()=>{s&&!this.control.disabled?this.control.disable():!s&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(e){return this._parent?Ly(e,this._parent):[e]}}return n.\u0275fac=function(e){return new(e||n)(J(wo,9),J(K2,10),J(v0,10),J(E4,10),J(_u,8))},n.\u0275dir=Ut({type:n,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[Vr([W5e]),l,r2]}),n})(),Mu=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=Ut({type:n,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),n})(),VW=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=oi({type:n}),n.\u0275inj=jr({}),n})();const Y5e={provide:E4,useExisting:M1(()=>Vy),multi:!0};let Vy=(()=>{class n extends yu{writeValue(e){this.setProperty("value",parseFloat(e))}registerOnChange(e){this.onChange=r=>{e(""==r?null:parseFloat(r))}}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=Dr(n)))(r||n)}}(),n.\u0275dir=Ut({type:n,selectors:[["input","type","range","formControlName",""],["input","type","range","formControl",""],["input","type","range","ngModel",""]],hostBindings:function(e,r){1&e&&ee("change",function(i){return r.onChange(i.target.value)})("input",function(i){return r.onChange(i.target.value)})("blur",function(){return r.onTouched()})},features:[Vr([Y5e]),l]}),n})();const vN=new kt("NgModelWithFormControlWarning"),K5e={provide:C0,useExisting:M1(()=>CN)};let CN=(()=>{class n extends C0{constructor(e,r,s,i){super(),this._ngModelWarningConfig=i,this.update=new mr,this._ngModelWarningSent=!1,this._setValidators(e),this._setAsyncValidators(r),this.valueAccessor=_N(0,s)}set isDisabled(e){}ngOnChanges(e){if(this._isControlChanged(e)){const r=e.form.previousValue;r&&Ry(r,this,!1),Cp(this.form,this),this.form.updateValueAndValidity({emitEvent:!1})}mN(e,this.viewModel)&&(this.form.setValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.form&&Ry(this.form,this,!1)}get path(){return[]}get control(){return this.form}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}_isControlChanged(e){return e.hasOwnProperty("form")}}return n._ngModelWarningSentOnce=!1,n.\u0275fac=function(e){return new(e||n)(J(K2,10),J(v0,10),J(E4,10),J(vN,8))},n.\u0275dir=Ut({type:n,selectors:[["","formControl",""]],inputs:{form:["formControl","form"],isDisabled:["disabled","isDisabled"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},exportAs:["ngForm"],features:[Vr([K5e]),l,r2]}),n})();const X5e={provide:wo,useExisting:M1(()=>Su)};let Su=(()=>{class n extends wo{constructor(e,r){super(),this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new mr,this._setValidators(e),this._setAsyncValidators(r)}ngOnChanges(e){this._checkFormPresent(),e.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(zy(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(e){const r=this.form.get(e.path);return Cp(r,e),r.updateValueAndValidity({emitEvent:!1}),this.directives.push(e),r}getControl(e){return this.form.get(e.path)}removeControl(e){Ry(e.control||null,e,!1),function B5e(n,t){const e=n.indexOf(t);e>-1&&n.splice(e,1)}(this.directives,e)}addFormGroup(e){this._setUpFormContainer(e)}removeFormGroup(e){this._cleanUpFormContainer(e)}getFormGroup(e){return this.form.get(e.path)}addFormArray(e){this._setUpFormContainer(e)}removeFormArray(e){this._cleanUpFormContainer(e)}getFormArray(e){return this.form.get(e.path)}updateModel(e,r){this.form.get(e.path).setValue(r)}onSubmit(e){return this.submitted=!0,IW(this.form,this.directives),this.ngSubmit.emit(e),"dialog"===e?.target?.method}onReset(){this.resetForm()}resetForm(e){this.form.reset(e),this.submitted=!1}_updateDomValue(){this.directives.forEach(e=>{const r=e.control,s=this.form.get(e.path);r!==s&&(Ry(r||null,e),(n=>n instanceof Va)(s)&&(Cp(s,e),e.control=s))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(e){const r=this.form.get(e.path);NW(r,e),r.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(e){if(this.form){const r=this.form.get(e.path);r&&function V5e(n,t){return zy(n,t)}(r,e)&&r.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){gN(this.form,this),this._oldForm&&zy(this._oldForm,this)}_checkFormPresent(){}}return n.\u0275fac=function(e){return new(e||n)(J(K2,10),J(v0,10))},n.\u0275dir=Ut({type:n,selectors:[["","formGroup",""]],hostBindings:function(e,r){1&e&&ee("submit",function(i){return r.onSubmit(i)})("reset",function(){return r.onReset()})},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Vr([X5e]),l,r2]}),n})();const e7e={provide:C0,useExisting:M1(()=>ff)};let ff=(()=>{class n extends C0{constructor(e,r,s,i,o){super(),this._ngModelWarningConfig=o,this._added=!1,this.update=new mr,this._ngModelWarningSent=!1,this._parent=e,this._setValidators(r),this._setAsyncValidators(s),this.valueAccessor=_N(0,i)}set isDisabled(e){}ngOnChanges(e){this._added||this._setUpControl(),mN(e,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}get path(){return Ly(null==this.name?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this._added=!0}}return n._ngModelWarningSentOnce=!1,n.\u0275fac=function(e){return new(e||n)(J(wo,13),J(K2,10),J(v0,10),J(E4,10),J(vN,8))},n.\u0275dir=Ut({type:n,selectors:[["","formControlName",""]],inputs:{name:["formControlName","name"],isDisabled:["disabled","isDisabled"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},features:[Vr([e7e]),l,r2]}),n})();const t7e={provide:E4,useExisting:M1(()=>Hy),multi:!0};function BW(n,t){return null==n?`${t}`:(t&&"object"==typeof t&&(t="Object"),`${n}: ${t}`.slice(0,50))}let Hy=(()=>{class n extends yu{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(e){this._compareWith=e}writeValue(e){this.value=e;const s=BW(this._getOptionId(e),e);this.setProperty("value",s)}registerOnChange(e){this.onChange=r=>{this.value=this._getOptionValue(r),e(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(e){for(const r of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(r),e))return r;return null}_getOptionValue(e){const r=function n7e(n){return n.split(":")[0]}(e);return this._optionMap.has(r)?this._optionMap.get(r):e}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=Dr(n)))(r||n)}}(),n.\u0275dir=Ut({type:n,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(e,r){1&e&&ee("change",function(i){return r.onChange(i.target.value)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},features:[Vr([t7e]),l]}),n})(),Sp=(()=>{class n{constructor(e,r,s){this._element=e,this._renderer=r,this._select=s,this._select&&(this.id=this._select._registerOption())}set ngValue(e){null!=this._select&&(this._select._optionMap.set(this.id,e),this._setElementValue(BW(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._setElementValue(e),this._select&&this._select.writeValue(this._select.value)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return n.\u0275fac=function(e){return new(e||n)(J(h2),J(yo),J(Hy,9))},n.\u0275dir=Ut({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),n})();const r7e={provide:E4,useExisting:M1(()=>MN),multi:!0};function $W(n,t){return null==n?`${t}`:("string"==typeof t&&(t=`'${t}'`),t&&"object"==typeof t&&(t="Object"),`${n}: ${t}`.slice(0,50))}let MN=(()=>{class n extends yu{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(e){this._compareWith=e}writeValue(e){let r;if(this.value=e,Array.isArray(e)){const s=e.map(i=>this._getOptionId(i));r=(i,o)=>{i._setSelected(s.indexOf(o.toString())>-1)}}else r=(s,i)=>{s._setSelected(!1)};this._optionMap.forEach(r)}registerOnChange(e){this.onChange=r=>{const s=[],i=r.selectedOptions;if(void 0!==i){const o=i;for(let c=0;c<o.length;c++){const h=this._getOptionValue(o[c].value);s.push(h)}}else{const o=r.options;for(let c=0;c<o.length;c++){const u=o[c];if(u.selected){const h=this._getOptionValue(u.value);s.push(h)}}}this.value=s,e(s)}}_registerOption(e){const r=(this._idCounter++).toString();return this._optionMap.set(r,e),r}_getOptionId(e){for(const r of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(r)._value,e))return r;return null}_getOptionValue(e){const r=function s7e(n){return n.split(":")[0]}(e);return this._optionMap.has(r)?this._optionMap.get(r)._value:e}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=Dr(n)))(r||n)}}(),n.\u0275dir=Ut({type:n,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(e,r){1&e&&ee("change",function(i){return r.onChange(i.target)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},features:[Vr([r7e]),l]}),n})(),Pp=(()=>{class n{constructor(e,r,s){this._element=e,this._renderer=r,this._select=s,this._select&&(this.id=this._select._registerOption(this))}set ngValue(e){null!=this._select&&(this._value=e,this._setElementValue($W(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._select?(this._value=e,this._setElementValue($W(this.id,e)),this._select.writeValue(this._select.value)):this._setElementValue(e)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}_setSelected(e){this._renderer.setProperty(this._element.nativeElement,"selected",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return n.\u0275fac=function(e){return new(e||n)(J(h2),J(yo),J(MN,9))},n.\u0275dir=Ut({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),n})();let Pu=(()=>{class n{constructor(){this._validator=Oy}ngOnChanges(e){if(this.inputName in e){const r=this.normalizeInput(e[this.inputName].currentValue);this._enabled=this.enabled(r),this._validator=this._enabled?this.createValidator(r):Oy,this._onChange&&this._onChange()}}validate(e){return this._validator(e)}registerOnValidatorChange(e){this._onChange=e}enabled(e){return null!=e}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=Ut({type:n,features:[r2]}),n})();const a7e={provide:K2,useExisting:M1(()=>Tu),multi:!0};let Tu=(()=>{class n extends Pu{constructor(){super(...arguments),this.inputName="required",this.normalizeInput=Nl,this.createValidator=e=>nW}enabled(e){return e}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=Dr(n)))(r||n)}}(),n.\u0275dir=Ut({type:n,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(e,r){2&e&&D("required",r._enabled?"":null)},inputs:{required:"required"},features:[Vr([a7e]),l]}),n})();const f7e={provide:K2,useExisting:M1(()=>SN),multi:!0};let SN=(()=>{class n extends Pu{constructor(){super(...arguments),this.inputName="maxlength",this.normalizeInput=e=>function UW(n){return"number"==typeof n?n:parseInt(n,10)}(e),this.createValidator=e=>oW(e)}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=Dr(n)))(r||n)}}(),n.\u0275dir=Ut({type:n,selectors:[["","maxlength","","formControlName",""],["","maxlength","","formControl",""],["","maxlength","","ngModel",""]],hostVars:1,hostBindings:function(e,r){2&e&&D("maxlength",r._enabled?r.maxlength:null)},inputs:{maxlength:"maxlength"},features:[Vr([f7e]),l]}),n})(),XW=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=oi({type:n}),n.\u0275inj=jr({imports:[VW]}),n})(),d7e=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=oi({type:n}),n.\u0275inj=jr({imports:[XW]}),n})(),QW=(()=>{class n{static withConfig(e){return{ngModule:n,providers:[{provide:vN,useValue:e.warnOnNgModelWithFormControl}]}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=oi({type:n}),n.\u0275inj=jr({imports:[XW]}),n})();class JW extends ky{constructor(t,e,r){super(dN(e),pN(r,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(t){return this.controls[this._adjustIndex(t)]}push(t,e={}){this.controls.push(t),this._registerControl(t),this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}insert(t,e,r={}){this.controls.splice(t,0,e),this._registerControl(e),this.updateValueAndValidity({emitEvent:r.emitEvent})}removeAt(t,e={}){let r=this._adjustIndex(t);r<0&&(r=0),this.controls[r]&&this.controls[r]._registerOnCollectionChange(()=>{}),this.controls.splice(r,1),this.updateValueAndValidity({emitEvent:e.emitEvent})}setControl(t,e,r={}){let s=this._adjustIndex(t);s<0&&(s=0),this.controls[s]&&this.controls[s]._registerOnCollectionChange(()=>{}),this.controls.splice(s,1),e&&(this.controls.splice(s,0,e),this._registerControl(e)),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(t,e={}){wW(this,0,t),t.forEach((r,s)=>{TW(this,!1,s),this.at(s).setValue(r,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){null!=t&&(t.forEach((r,s)=>{this.at(s)&&this.at(s).patchValue(r,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(t=[],e={}){this._forEachChild((r,s)=>{r.reset(t[s],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this.controls.map(t=>t.getRawValue())}clear(t={}){this.controls.length<1||(this._forEachChild(e=>e._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:t.emitEvent}))}_adjustIndex(t){return t<0?t+this.length:t}_syncPendingControls(){let t=this.controls.reduce((e,r)=>!!r._syncPendingControls()||e,!1);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_forEachChild(t){this.controls.forEach((e,r)=>{t(e,r)})}_updateValue(){this.value=this.controls.filter(t=>t.enabled||this.disabled).map(t=>t.value)}_anyControls(t){return this.controls.some(e=>e.enabled&&t(e))}_setUpControls(){this._forEachChild(t=>this._registerControl(t))}_allControlsDisabled(){for(const t of this.controls)if(t.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(t){t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)}_find(t){return this.at(t)??null}}function eq(n){return!!n&&(void 0!==n.asyncValidators||void 0!==n.validators||void 0!==n.updateOn)}let p7e=(()=>{class n{constructor(){this.useNonNullable=!1}get nonNullable(){const e=new n;return e.useNonNullable=!0,e}group(e,r=null){const s=this._reduceControls(e);let i={};return eq(r)?i=r:null!==r&&(i.validators=r.validator,i.asyncValidators=r.asyncValidator),new y0(s,i)}record(e,r=null){const s=this._reduceControls(e);return new bW(s,r)}control(e,r,s){let i={};return this.useNonNullable?(eq(r)?i=r:(i.validators=r,i.asyncValidators=s),new Va(e,{...i,nonNullable:!0})):new Va(e,r,s)}array(e,r,s){const i=e.map(o=>this._createControl(o));return new JW(i,r,s)}_reduceControls(e){const r={};return Object.keys(e).forEach(s=>{r[s]=this._createControl(e[s])}),r}_createControl(e){return e instanceof Va||e instanceof ky?e:Array.isArray(e)?this.control(e[0],e.length>1?e[1]:null,e.length>2?e[2]:null):this.control(e)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:QW}),n})();function Zt(...n){return ls(n,K3(n))}function E0(n,t){return an(t)?ze(n,t,1):ze(n,1)}function kl(n,t){return gr((e,r)=>{let s=0;e.subscribe(cs(r,i=>n.call(t,i,s++)&&r.next(i)))})}class tq{}class nq{}class Ll{constructor(t){this.normalizedNames=new Map,this.lazyUpdate=null,t?this.lazyInit="string"==typeof t?()=>{this.headers=new Map,t.split("\n").forEach(e=>{const r=e.indexOf(":");if(r>0){const s=e.slice(0,r),i=s.toLowerCase(),o=e.slice(r+1).trim();this.maybeSetNormalizedName(s,i),this.headers.has(i)?this.headers.get(i).push(o):this.headers.set(i,[o])}})}:()=>{this.headers=new Map,Object.keys(t).forEach(e=>{let r=t[e];const s=e.toLowerCase();"string"==typeof r&&(r=[r]),r.length>0&&(this.headers.set(s,r),this.maybeSetNormalizedName(e,s))})}:this.headers=new Map}has(t){return this.init(),this.headers.has(t.toLowerCase())}get(t){this.init();const e=this.headers.get(t.toLowerCase());return e&&e.length>0?e[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(t){return this.init(),this.headers.get(t.toLowerCase())||null}append(t,e){return this.clone({name:t,value:e,op:"a"})}set(t,e){return this.clone({name:t,value:e,op:"s"})}delete(t,e){return this.clone({name:t,value:e,op:"d"})}maybeSetNormalizedName(t,e){this.normalizedNames.has(e)||this.normalizedNames.set(e,t)}init(){this.lazyInit&&(this.lazyInit instanceof Ll?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(t=>this.applyUpdate(t)),this.lazyUpdate=null))}copyFrom(t){t.init(),Array.from(t.headers.keys()).forEach(e=>{this.headers.set(e,t.headers.get(e)),this.normalizedNames.set(e,t.normalizedNames.get(e))})}clone(t){const e=new Ll;return e.lazyInit=this.lazyInit&&this.lazyInit instanceof Ll?this.lazyInit:this,e.lazyUpdate=(this.lazyUpdate||[]).concat([t]),e}applyUpdate(t){const e=t.name.toLowerCase();switch(t.op){case"a":case"s":let r=t.value;if("string"==typeof r&&(r=[r]),0===r.length)return;this.maybeSetNormalizedName(t.name,e);const s=("a"===t.op?this.headers.get(e):void 0)||[];s.push(...r),this.headers.set(e,s);break;case"d":const i=t.value;if(i){let o=this.headers.get(e);if(!o)return;o=o.filter(c=>-1===i.indexOf(c)),0===o.length?(this.headers.delete(e),this.normalizedNames.delete(e)):this.headers.set(e,o)}else this.headers.delete(e),this.normalizedNames.delete(e)}}forEach(t){this.init(),Array.from(this.normalizedNames.keys()).forEach(e=>t(this.normalizedNames.get(e),this.headers.get(e)))}}class g7e{encodeKey(t){return rq(t)}encodeValue(t){return rq(t)}decodeKey(t){return decodeURIComponent(t)}decodeValue(t){return decodeURIComponent(t)}}const _7e=/%(\d[a-f0-9])/gi,v7e={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function rq(n){return encodeURIComponent(n).replace(_7e,(t,e)=>v7e[e]??t)}function Fy(n){return`${n}`}class M0{constructor(t={}){if(this.updates=null,this.cloneFrom=null,this.encoder=t.encoder||new g7e,t.fromString){if(t.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function m7e(n,t){const e=new Map;return n.length>0&&n.replace(/^\?/,"").split("&").forEach(s=>{const i=s.indexOf("="),[o,c]=-1==i?[t.decodeKey(s),""]:[t.decodeKey(s.slice(0,i)),t.decodeValue(s.slice(i+1))],u=e.get(o)||[];u.push(c),e.set(o,u)}),e}(t.fromString,this.encoder)}else t.fromObject?(this.map=new Map,Object.keys(t.fromObject).forEach(e=>{const r=t.fromObject[e],s=Array.isArray(r)?r.map(Fy):[Fy(r)];this.map.set(e,s)})):this.map=null}has(t){return this.init(),this.map.has(t)}get(t){this.init();const e=this.map.get(t);return e?e[0]:null}getAll(t){return this.init(),this.map.get(t)||null}keys(){return this.init(),Array.from(this.map.keys())}append(t,e){return this.clone({param:t,value:e,op:"a"})}appendAll(t){const e=[];return Object.keys(t).forEach(r=>{const s=t[r];Array.isArray(s)?s.forEach(i=>{e.push({param:r,value:i,op:"a"})}):e.push({param:r,value:s,op:"a"})}),this.clone(e)}set(t,e){return this.clone({param:t,value:e,op:"s"})}delete(t,e){return this.clone({param:t,value:e,op:"d"})}toString(){return this.init(),this.keys().map(t=>{const e=this.encoder.encodeKey(t);return this.map.get(t).map(r=>e+"="+this.encoder.encodeValue(r)).join("&")}).filter(t=>""!==t).join("&")}clone(t){const e=new M0({encoder:this.encoder});return e.cloneFrom=this.cloneFrom||this,e.updates=(this.updates||[]).concat(t),e}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(t=>this.map.set(t,this.cloneFrom.map.get(t))),this.updates.forEach(t=>{switch(t.op){case"a":case"s":const e=("a"===t.op?this.map.get(t.param):void 0)||[];e.push(Fy(t.value)),this.map.set(t.param,e);break;case"d":if(void 0===t.value){this.map.delete(t.param);break}{let r=this.map.get(t.param)||[];const s=r.indexOf(Fy(t.value));-1!==s&&r.splice(s,1),r.length>0?this.map.set(t.param,r):this.map.delete(t.param)}}}),this.cloneFrom=this.updates=null)}}class C7e{constructor(){this.map=new Map}set(t,e){return this.map.set(t,e),this}get(t){return this.map.has(t)||this.map.set(t,t.defaultValue()),this.map.get(t)}delete(t){return this.map.delete(t),this}has(t){return this.map.has(t)}keys(){return this.map.keys()}}function sq(n){return typeof ArrayBuffer<"u"&&n instanceof ArrayBuffer}function iq(n){return typeof Blob<"u"&&n instanceof Blob}function oq(n){return typeof FormData<"u"&&n instanceof FormData}class Tp{constructor(t,e,r,s){let i;if(this.url=e,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=t.toUpperCase(),function y7e(n){switch(n){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||s?(this.body=void 0!==r?r:null,i=s):i=r,i&&(this.reportProgress=!!i.reportProgress,this.withCredentials=!!i.withCredentials,i.responseType&&(this.responseType=i.responseType),i.headers&&(this.headers=i.headers),i.context&&(this.context=i.context),i.params&&(this.params=i.params)),this.headers||(this.headers=new Ll),this.context||(this.context=new C7e),this.params){const o=this.params.toString();if(0===o.length)this.urlWithParams=e;else{const c=e.indexOf("?");this.urlWithParams=e+(-1===c?"?":c<e.length-1?"&":"")+o}}else this.params=new M0,this.urlWithParams=e}serializeBody(){return null===this.body?null:sq(this.body)||iq(this.body)||oq(this.body)||function E7e(n){return typeof URLSearchParams<"u"&&n instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof M0?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||oq(this.body)?null:iq(this.body)?this.body.type||null:sq(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof M0?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(t={}){const e=t.method||this.method,r=t.url||this.url,s=t.responseType||this.responseType,i=void 0!==t.body?t.body:this.body,o=void 0!==t.withCredentials?t.withCredentials:this.withCredentials,c=void 0!==t.reportProgress?t.reportProgress:this.reportProgress;let u=t.headers||this.headers,h=t.params||this.params;const p=t.context??this.context;return void 0!==t.setHeaders&&(u=Object.keys(t.setHeaders).reduce((m,C)=>m.set(C,t.setHeaders[C]),u)),t.setParams&&(h=Object.keys(t.setParams).reduce((m,C)=>m.set(C,t.setParams[C]),h)),new Tp(e,r,i,{params:h,headers:u,context:p,reportProgress:c,responseType:s,withCredentials:o})}}var Ws=(()=>((Ws=Ws||{})[Ws.Sent=0]="Sent",Ws[Ws.UploadProgress=1]="UploadProgress",Ws[Ws.ResponseHeader=2]="ResponseHeader",Ws[Ws.DownloadProgress=3]="DownloadProgress",Ws[Ws.Response=4]="Response",Ws[Ws.User=5]="User",Ws))();class PN{constructor(t,e=200,r="OK"){this.headers=t.headers||new Ll,this.status=void 0!==t.status?t.status:e,this.statusText=t.statusText||r,this.url=t.url||null,this.ok=this.status>=200&&this.status<300}}class TN extends PN{constructor(t={}){super(t),this.type=Ws.ResponseHeader}clone(t={}){return new TN({headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}class By extends PN{constructor(t={}){super(t),this.type=Ws.Response,this.body=void 0!==t.body?t.body:null}clone(t={}){return new By({body:void 0!==t.body?t.body:this.body,headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}class aq extends PN{constructor(t){super(t,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${t.url||"(unknown url)"}`:`Http failure response for ${t.url||"(unknown url)"}: ${t.status} ${t.statusText}`,this.error=t.error||null}}function wN(n,t){return{body:t,headers:n.headers,context:n.context,observe:n.observe,params:n.params,reportProgress:n.reportProgress,responseType:n.responseType,withCredentials:n.withCredentials}}let M7e=(()=>{class n{constructor(e){this.handler=e}request(e,r,s={}){let i;if(e instanceof Tp)i=e;else{let u,h;u=s.headers instanceof Ll?s.headers:new Ll(s.headers),s.params&&(h=s.params instanceof M0?s.params:new M0({fromObject:s.params})),i=new Tp(e,r,void 0!==s.body?s.body:null,{headers:u,context:s.context,params:h,reportProgress:s.reportProgress,responseType:s.responseType||"json",withCredentials:s.withCredentials})}const o=Zt(i).pipe(E0(u=>this.handler.handle(u)));if(e instanceof Tp||"events"===s.observe)return o;const c=o.pipe(kl(u=>u instanceof By));switch(s.observe||"body"){case"body":switch(i.responseType){case"arraybuffer":return c.pipe(gn(u=>{if(null!==u.body&&!(u.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return u.body}));case"blob":return c.pipe(gn(u=>{if(null!==u.body&&!(u.body instanceof Blob))throw new Error("Response is not a Blob.");return u.body}));case"text":return c.pipe(gn(u=>{if(null!==u.body&&"string"!=typeof u.body)throw new Error("Response is not a string.");return u.body}));default:return c.pipe(gn(u=>u.body))}case"response":return c;default:throw new Error(`Unreachable: unhandled observe type ${s.observe}}`)}}delete(e,r={}){return this.request("DELETE",e,r)}get(e,r={}){return this.request("GET",e,r)}head(e,r={}){return this.request("HEAD",e,r)}jsonp(e,r){return this.request("JSONP",e,{params:(new M0).append(r,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(e,r={}){return this.request("OPTIONS",e,r)}patch(e,r,s={}){return this.request("PATCH",e,wN(s,r))}post(e,r,s={}){return this.request("POST",e,wN(s,r))}put(e,r,s={}){return this.request("PUT",e,wN(s,r))}}return n.\u0275fac=function(e){return new(e||n)(De(tq))},n.\u0275prov=nt({token:n,factory:n.\u0275fac}),n})();class cq{constructor(t,e){this.next=t,this.interceptor=e}handle(t){return this.interceptor.intercept(t,this.next)}}const lq=new kt("HTTP_INTERCEPTORS");let S7e=(()=>{class n{intercept(e,r){return r.handle(e)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=nt({token:n,factory:n.\u0275fac}),n})();const P7e=/^\)\]\}',?\n/;let uq=(()=>{class n{constructor(e){this.xhrFactory=e}handle(e){if("JSONP"===e.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new Er(r=>{const s=this.xhrFactory.build();if(s.open(e.method,e.urlWithParams),e.withCredentials&&(s.withCredentials=!0),e.headers.forEach((w,I)=>s.setRequestHeader(w,I.join(","))),e.headers.has("Accept")||s.setRequestHeader("Accept","application/json, text/plain, */*"),!e.headers.has("Content-Type")){const w=e.detectContentTypeHeader();null!==w&&s.setRequestHeader("Content-Type",w)}if(e.responseType){const w=e.responseType.toLowerCase();s.responseType="json"!==w?w:"text"}const i=e.serializeBody();let o=null;const c=()=>{if(null!==o)return o;const w=s.statusText||"OK",I=new Ll(s.getAllResponseHeaders()),H=function T7e(n){return"responseURL"in n&&n.responseURL?n.responseURL:/^X-Request-URL:/m.test(n.getAllResponseHeaders())?n.getResponseHeader("X-Request-URL"):null}(s)||e.url;return o=new TN({headers:I,status:s.status,statusText:w,url:H}),o},u=()=>{let{headers:w,status:I,statusText:H,url:K}=c(),ie=null;204!==I&&(ie=typeof s.response>"u"?s.responseText:s.response),0===I&&(I=ie?200:0);let ye=I>=200&&I<300;if("json"===e.responseType&&"string"==typeof ie){const te=ie;ie=ie.replace(P7e,"");try{ie=""!==ie?JSON.parse(ie):null}catch(ke){ie=te,ye&&(ye=!1,ie={error:ke,text:ie})}}ye?(r.next(new By({body:ie,headers:w,status:I,statusText:H,url:K||void 0})),r.complete()):r.error(new aq({error:ie,headers:w,status:I,statusText:H,url:K||void 0}))},h=w=>{const{url:I}=c(),H=new aq({error:w,status:s.status||0,statusText:s.statusText||"Unknown Error",url:I||void 0});r.error(H)};let p=!1;const m=w=>{p||(r.next(c()),p=!0);let I={type:Ws.DownloadProgress,loaded:w.loaded};w.lengthComputable&&(I.total=w.total),"text"===e.responseType&&!!s.responseText&&(I.partialText=s.responseText),r.next(I)},C=w=>{let I={type:Ws.UploadProgress,loaded:w.loaded};w.lengthComputable&&(I.total=w.total),r.next(I)};return s.addEventListener("load",u),s.addEventListener("error",h),s.addEventListener("timeout",h),s.addEventListener("abort",h),e.reportProgress&&(s.addEventListener("progress",m),null!==i&&s.upload&&s.upload.addEventListener("progress",C)),s.send(i),r.next({type:Ws.Sent}),()=>{s.removeEventListener("error",h),s.removeEventListener("abort",h),s.removeEventListener("load",u),s.removeEventListener("timeout",h),e.reportProgress&&(s.removeEventListener("progress",m),null!==i&&s.upload&&s.upload.removeEventListener("progress",C)),s.readyState!==s.DONE&&s.abort()}})}}return n.\u0275fac=function(e){return new(e||n)(De(PG))},n.\u0275prov=nt({token:n,factory:n.\u0275fac}),n})();const bN=new kt("XSRF_COOKIE_NAME"),ON=new kt("XSRF_HEADER_NAME");class fq{}let w7e=(()=>{class n{constructor(e,r,s){this.doc=e,this.platform=r,this.cookieName=s,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const e=this.doc.cookie||"";return e!==this.lastCookieString&&(this.parseCount++,this.lastToken=pG(e,this.cookieName),this.lastCookieString=e),this.lastToken}}return n.\u0275fac=function(e){return new(e||n)(De($s),De(cp),De(bN))},n.\u0275prov=nt({token:n,factory:n.\u0275fac}),n})(),NN=(()=>{class n{constructor(e,r){this.tokenService=e,this.headerName=r}intercept(e,r){const s=e.url.toLowerCase();if("GET"===e.method||"HEAD"===e.method||s.startsWith("http://")||s.startsWith("https://"))return r.handle(e);const i=this.tokenService.getToken();return null!==i&&!e.headers.has(this.headerName)&&(e=e.clone({headers:e.headers.set(this.headerName,i)})),r.handle(e)}}return n.\u0275fac=function(e){return new(e||n)(De(fq),De(ON))},n.\u0275prov=nt({token:n,factory:n.\u0275fac}),n})(),b7e=(()=>{class n{constructor(e,r){this.backend=e,this.injector=r,this.chain=null}handle(e){if(null===this.chain){const r=this.injector.get(lq,[]);this.chain=r.reduceRight((s,i)=>new cq(s,i),this.backend)}return this.chain.handle(e)}}return n.\u0275fac=function(e){return new(e||n)(De(nq),De(fi))},n.\u0275prov=nt({token:n,factory:n.\u0275fac}),n})(),O7e=(()=>{class n{static disable(){return{ngModule:n,providers:[{provide:NN,useClass:S7e}]}}static withOptions(e={}){return{ngModule:n,providers:[e.cookieName?{provide:bN,useValue:e.cookieName}:[],e.headerName?{provide:ON,useValue:e.headerName}:[]]}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=oi({type:n}),n.\u0275inj=jr({providers:[NN,{provide:lq,useExisting:NN,multi:!0},{provide:fq,useClass:w7e},{provide:bN,useValue:"XSRF-TOKEN"},{provide:ON,useValue:"X-XSRF-TOKEN"}]}),n})(),N7e=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=oi({type:n}),n.\u0275inj=jr({providers:[M7e,{provide:tq,useClass:b7e},uq,{provide:nq,useExisting:uq}],imports:[O7e.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]}),n})();class N3 extends F2{constructor(t){super(),this._value=t}get value(){return this.getValue()}_subscribe(t){const e=super._subscribe(t);return!e.closed&&t.next(this._value),e}getValue(){const{hasError:t,thrownError:e,_value:r}=this;if(t)throw e;return this._throwIfClosed(),r}next(t){super.next(this._value=t)}}const $y=as(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function hq(...n){const t=K3(n),e=Qt(n),{args:r,keys:s}=YG(n);if(0===r.length)return ls([],t);const i=new Er(function A7e(n,t,e=X4){return r=>{dq(t,()=>{const{length:s}=n,i=new Array(s);let o=s,c=s;for(let u=0;u<s;u++)dq(t,()=>{const h=ls(n[u],t);let p=!1;h.subscribe(cs(r,m=>{i[u]=m,p||(p=!0,c--),c||r.next(e(i.slice()))},()=>{--o||r.complete()}))},r)},r)}}(r,t,s?o=>XG(s,o):X4));return e?i.pipe(KG(e)):i}function dq(n,t,e){n?Hs(e,n,t):t()}function AN(...n){return function I7e(){return el(1)}()(ls(n,K3(n)))}function pq(n){return new Er(t=>{uo(n()).subscribe(t)})}function wp(n,t){const e=an(n)?n:()=>n,r=s=>s.error(e());return new Er(t?s=>t.schedule(r,0,s):r)}function IN(){return gr((n,t)=>{let e=null;n._refCount++;const r=cs(t,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount)return void(e=null);const s=n._connection,i=e;e=null,s&&(!i||s===i)&&s.unsubscribe(),t.unsubscribe()});n.subscribe(r),r.closed||(e=n.connect())})}class gq extends Er{constructor(t,e){super(),this.source=t,this.subjectFactory=e,this._subject=null,this._refCount=0,this._connection=null,i_(t)&&(this.lift=t.lift)}_subscribe(t){return this.getSubject().subscribe(t)}getSubject(){const t=this._subject;return(!t||t.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:t}=this;this._subject=this._connection=null,t?.unsubscribe()}connect(){let t=this._connection;if(!t){t=this._connection=new Z1;const e=this.getSubject();t.add(this.source.subscribe(cs(e,void 0,()=>{this._teardown(),e.complete()},r=>{this._teardown(),e.error(r)},()=>this._teardown()))),t.closed&&(this._connection=null,t=Z1.EMPTY)}return t}refCount(){return IN()(this)}}function S4(n,t){return gr((e,r)=>{let s=null,i=0,o=!1;const c=()=>o&&!s&&r.complete();e.subscribe(cs(r,u=>{s?.unsubscribe();let h=0;const p=i++;uo(n(u,p)).subscribe(s=cs(r,m=>r.next(t?t(u,m,p,h++):m),()=>{s=null,c()}))},()=>{o=!0,c()}))})}function bp(n){return n<=0?()=>uc:gr((t,e)=>{let r=0;t.subscribe(cs(e,s=>{++r<=n&&(e.next(s),n<=r&&e.complete())}))})}function Uy(n){return gr((t,e)=>{let r=!1;t.subscribe(cs(e,s=>{r=!0,e.next(s)},()=>{r||e.next(n),e.complete()}))})}function mq(n=k7e){return gr((t,e)=>{let r=!1;t.subscribe(cs(e,s=>{r=!0,e.next(s)},()=>r?e.complete():e.error(n())))})}function k7e(){return new $y}function S0(n,t){const e=arguments.length>=2;return r=>r.pipe(n?kl((s,i)=>n(s,i,r)):X4,bp(1),e?Uy(t):mq(()=>new $y))}function v2(n,t,e){const r=an(n)||t||e?{next:n,error:t,complete:e}:n;return r?gr((s,i)=>{var o;null===(o=r.subscribe)||void 0===o||o.call(r);let c=!0;s.subscribe(cs(i,u=>{var h;null===(h=r.next)||void 0===h||h.call(r,u),i.next(u)},()=>{var u;c=!1,null===(u=r.complete)||void 0===u||u.call(r),i.complete()},u=>{var h;c=!1,null===(h=r.error)||void 0===h||h.call(r,u),i.error(u)},()=>{var u,h;c&&(null===(u=r.unsubscribe)||void 0===u||u.call(r)),null===(h=r.finalize)||void 0===h||h.call(r)}))}):X4}function P0(n){return gr((t,e)=>{let i,r=null,s=!1;r=t.subscribe(cs(e,void 0,void 0,o=>{i=uo(n(o,P0(n)(t))),r?(r.unsubscribe(),r=null,i.subscribe(e)):s=!0})),s&&(r.unsubscribe(),r=null,i.subscribe(e))})}function L7e(n,t,e,r,s){return(i,o)=>{let c=e,u=t,h=0;i.subscribe(cs(o,p=>{const m=h++;u=c?n(u,p,m):(c=!0,p),r&&o.next(u)},s&&(()=>{c&&o.next(u),o.complete()})))}}function _q(n,t){return gr(L7e(n,t,arguments.length>=2,!0))}function xN(n){return n<=0?()=>uc:gr((t,e)=>{let r=[];t.subscribe(cs(e,s=>{r.push(s),n<r.length&&r.shift()},()=>{for(const s of r)e.next(s);e.complete()},void 0,()=>{r=null}))})}function vq(n,t){const e=arguments.length>=2;return r=>r.pipe(n?kl((s,i)=>n(s,i,r)):X4,xN(1),e?Uy(t):mq(()=>new $y))}function kN(n){return gr((t,e)=>{try{t.subscribe(e)}finally{e.add(n)}})}const $n="primary",Op=Symbol("RouteTitle");class z7e{constructor(t){this.params=t||{}}has(t){return Object.prototype.hasOwnProperty.call(this.params,t)}get(t){if(this.has(t)){const e=this.params[t];return Array.isArray(e)?e[0]:e}return null}getAll(t){if(this.has(t)){const e=this.params[t];return Array.isArray(e)?e:[e]}return[]}get keys(){return Object.keys(this.params)}}function hf(n){return new z7e(n)}function V7e(n,t,e){const r=e.path.split("/");if(r.length>n.length||"full"===e.pathMatch&&(t.hasChildren()||r.length<n.length))return null;const s={};for(let i=0;i<r.length;i++){const o=r[i],c=n[i];if(o.startsWith(":"))s[o.substring(1)]=c;else if(o!==c.path)return null}return{consumed:n.slice(0,r.length),posParams:s}}function P4(n,t){const e=n?Object.keys(n):void 0,r=t?Object.keys(t):void 0;if(!e||!r||e.length!=r.length)return!1;let s;for(let i=0;i<e.length;i++)if(s=e[i],!Cq(n[s],t[s]))return!1;return!0}function Cq(n,t){if(Array.isArray(n)&&Array.isArray(t)){if(n.length!==t.length)return!1;const e=[...n].sort(),r=[...t].sort();return e.every((s,i)=>r[i]===s)}return n===t}function yq(n){return Array.prototype.concat.apply([],n)}function Eq(n){return n.length>0?n[n.length-1]:null}function C2(n,t){for(const e in n)n.hasOwnProperty(e)&&t(n[e],e)}function T0(n){return Kb(n)?n:Xd(n)?ls(Promise.resolve(n)):Zt(n)}const B7e={exact:function Pq(n,t,e){if(!bu(n.segments,t.segments)||!Gy(n.segments,t.segments,e)||n.numberOfChildren!==t.numberOfChildren)return!1;for(const r in t.children)if(!n.children[r]||!Pq(n.children[r],t.children[r],e))return!1;return!0},subset:Tq},Mq={exact:function $7e(n,t){return P4(n,t)},subset:function U7e(n,t){return Object.keys(t).length<=Object.keys(n).length&&Object.keys(t).every(e=>Cq(n[e],t[e]))},ignored:()=>!0};function Sq(n,t,e){return B7e[e.paths](n.root,t.root,e.matrixParams)&&Mq[e.queryParams](n.queryParams,t.queryParams)&&!("exact"===e.fragment&&n.fragment!==t.fragment)}function Tq(n,t,e){return wq(n,t,t.segments,e)}function wq(n,t,e,r){if(n.segments.length>e.length){const s=n.segments.slice(0,e.length);return!(!bu(s,e)||t.hasChildren()||!Gy(s,e,r))}if(n.segments.length===e.length){if(!bu(n.segments,e)||!Gy(n.segments,e,r))return!1;for(const s in t.children)if(!n.children[s]||!Tq(n.children[s],t.children[s],r))return!1;return!0}{const s=e.slice(0,n.segments.length),i=e.slice(n.segments.length);return!!(bu(n.segments,s)&&Gy(n.segments,s,r)&&n.children[$n])&&wq(n.children[$n],t,i,r)}}function Gy(n,t,e){return t.every((r,s)=>Mq[e](n[s].parameters,r.parameters))}class wu{constructor(t,e,r){this.root=t,this.queryParams=e,this.fragment=r}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=hf(this.queryParams)),this._queryParamMap}toString(){return q7e.serialize(this)}}class jn{constructor(t,e){this.segments=t,this.children=e,this.parent=null,C2(e,(r,s)=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Wy(this)}}class Np{constructor(t,e){this.path=t,this.parameters=e}get parameterMap(){return this._parameterMap||(this._parameterMap=hf(this.parameters)),this._parameterMap}toString(){return Aq(this)}}function bu(n,t){return n.length===t.length&&n.every((e,r)=>e.path===t[r].path)}let bq=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=nt({token:n,factory:function(){return new RN},providedIn:"root"}),n})();class RN{parse(t){const e=new tfe(t);return new wu(e.parseRootSegment(),e.parseQueryParams(),e.parseFragment())}serialize(t){const e=`/${Ap(t.root,!0)}`,r=function Y7e(n){const t=Object.keys(n).map(e=>{const r=n[e];return Array.isArray(r)?r.map(s=>`${qy(e)}=${qy(s)}`).join("&"):`${qy(e)}=${qy(r)}`}).filter(e=>!!e);return t.length?`?${t.join("&")}`:""}(t.queryParams);return`${e}${r}${"string"==typeof t.fragment?`#${function j7e(n){return encodeURI(n)}(t.fragment)}`:""}`}}const q7e=new RN;function Wy(n){return n.segments.map(t=>Aq(t)).join("/")}function Ap(n,t){if(!n.hasChildren())return Wy(n);if(t){const e=n.children[$n]?Ap(n.children[$n],!1):"",r=[];return C2(n.children,(s,i)=>{i!==$n&&r.push(`${i}:${Ap(s,!1)}`)}),r.length>0?`${e}(${r.join("//")})`:e}{const e=function W7e(n,t){let e=[];return C2(n.children,(r,s)=>{s===$n&&(e=e.concat(t(r,s)))}),C2(n.children,(r,s)=>{s!==$n&&(e=e.concat(t(r,s)))}),e}(n,(r,s)=>s===$n?[Ap(n.children[$n],!1)]:[`${s}:${Ap(r,!1)}`]);return 1===Object.keys(n.children).length&&null!=n.children[$n]?`${Wy(n)}/${e[0]}`:`${Wy(n)}/(${e.join("//")})`}}function Oq(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function qy(n){return Oq(n).replace(/%3B/gi,";")}function DN(n){return Oq(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function jy(n){return decodeURIComponent(n)}function Nq(n){return jy(n.replace(/\+/g,"%20"))}function Aq(n){return`${DN(n.path)}${function Z7e(n){return Object.keys(n).map(t=>`;${DN(t)}=${DN(n[t])}`).join("")}(n.parameters)}`}const K7e=/^[^\/()?;=#]+/;function Zy(n){const t=n.match(K7e);return t?t[0]:""}const X7e=/^[^=?&#]+/,J7e=/^[^&#]+/;class tfe{constructor(t){this.url=t,this.remaining=t}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new jn([],{}):new jn([],this.parseChildren())}parseQueryParams(){const t={};if(this.consumeOptional("?"))do{this.parseQueryParam(t)}while(this.consumeOptional("&"));return t}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const t=[];for(this.peekStartsWith("(")||t.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),t.push(this.parseSegment());let e={};this.peekStartsWith("/(")&&(this.capture("/"),e=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(t.length>0||Object.keys(e).length>0)&&(r[$n]=new jn(t,e)),r}parseSegment(){const t=Zy(this.remaining);if(""===t&&this.peekStartsWith(";"))throw new Ae(4009,!1);return this.capture(t),new Np(jy(t),this.parseMatrixParams())}parseMatrixParams(){const t={};for(;this.consumeOptional(";");)this.parseParam(t);return t}parseParam(t){const e=Zy(this.remaining);if(!e)return;this.capture(e);let r="";if(this.consumeOptional("=")){const s=Zy(this.remaining);s&&(r=s,this.capture(r))}t[jy(e)]=jy(r)}parseQueryParam(t){const e=function Q7e(n){const t=n.match(X7e);return t?t[0]:""}(this.remaining);if(!e)return;this.capture(e);let r="";if(this.consumeOptional("=")){const o=function efe(n){const t=n.match(J7e);return t?t[0]:""}(this.remaining);o&&(r=o,this.capture(r))}const s=Nq(e),i=Nq(r);if(t.hasOwnProperty(s)){let o=t[s];Array.isArray(o)||(o=[o],t[s]=o),o.push(i)}else t[s]=i}parseParens(t){const e={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const r=Zy(this.remaining),s=this.remaining[r.length];if("/"!==s&&")"!==s&&";"!==s)throw new Ae(4010,!1);let i;r.indexOf(":")>-1?(i=r.slice(0,r.indexOf(":")),this.capture(i),this.capture(":")):t&&(i=$n);const o=this.parseChildren();e[i]=1===Object.keys(o).length?o[$n]:new jn([],o),this.consumeOptional("//")}return e}peekStartsWith(t){return this.remaining.startsWith(t)}consumeOptional(t){return!!this.peekStartsWith(t)&&(this.remaining=this.remaining.substring(t.length),!0)}capture(t){if(!this.consumeOptional(t))throw new Ae(4011,!1)}}function zN(n){return n.segments.length>0?new jn([],{[$n]:n}):n}function Yy(n){const t={};for(const r of Object.keys(n.children)){const i=Yy(n.children[r]);(i.segments.length>0||i.hasChildren())&&(t[r]=i)}return function nfe(n){if(1===n.numberOfChildren&&n.children[$n]){const t=n.children[$n];return new jn(n.segments.concat(t.segments),t.children)}return n}(new jn(n.segments,t))}function Ou(n){return n instanceof wu}function ife(n,t,e,r,s){if(0===e.length)return df(t.root,t.root,t.root,r,s);const i=function kq(n){if("string"==typeof n[0]&&1===n.length&&"/"===n[0])return new xq(!0,0,n);let t=0,e=!1;const r=n.reduce((s,i,o)=>{if("object"==typeof i&&null!=i){if(i.outlets){const c={};return C2(i.outlets,(u,h)=>{c[h]="string"==typeof u?u.split("/"):u}),[...s,{outlets:c}]}if(i.segmentPath)return[...s,i.segmentPath]}return"string"!=typeof i?[...s,i]:0===o?(i.split("/").forEach((c,u)=>{0==u&&"."===c||(0==u&&""===c?e=!0:".."===c?t++:""!=c&&s.push(c))}),s):[...s,i]},[]);return new xq(e,t,r)}(e);return i.toRoot()?df(t.root,t.root,new jn([],{}),r,s):function o(u){const h=function afe(n,t,e,r){if(n.isAbsolute)return new pf(t.root,!0,0);if(-1===r)return new pf(e,e===t.root,0);return function Lq(n,t,e){let r=n,s=t,i=e;for(;i>s;){if(i-=s,r=r.parent,!r)throw new Ae(4005,!1);s=r.segments.length}return new pf(r,!1,s-i)}(e,r+(Ip(n.commands[0])?0:1),n.numberOfDoubleDots)}(i,t,n.snapshot?._urlSegment,u),p=h.processChildren?kp(h.segmentGroup,h.index,i.commands):HN(h.segmentGroup,h.index,i.commands);return df(t.root,h.segmentGroup,p,r,s)}(n.snapshot?._lastPathIndex)}function Ip(n){return"object"==typeof n&&null!=n&&!n.outlets&&!n.segmentPath}function xp(n){return"object"==typeof n&&null!=n&&n.outlets}function df(n,t,e,r,s){let o,i={};r&&C2(r,(u,h)=>{i[h]=Array.isArray(u)?u.map(p=>`${p}`):`${u}`}),o=n===t?e:Iq(n,t,e);const c=zN(Yy(o));return new wu(c,i,s)}function Iq(n,t,e){const r={};return C2(n.children,(s,i)=>{r[i]=s===t?e:Iq(s,t,e)}),new jn(n.segments,r)}class xq{constructor(t,e,r){if(this.isAbsolute=t,this.numberOfDoubleDots=e,this.commands=r,t&&r.length>0&&Ip(r[0]))throw new Ae(4003,!1);const s=r.find(xp);if(s&&s!==Eq(r))throw new Ae(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class pf{constructor(t,e,r){this.segmentGroup=t,this.processChildren=e,this.index=r}}function HN(n,t,e){if(n||(n=new jn([],{})),0===n.segments.length&&n.hasChildren())return kp(n,t,e);const r=function lfe(n,t,e){let r=0,s=t;const i={match:!1,pathIndex:0,commandIndex:0};for(;s<n.segments.length;){if(r>=e.length)return i;const o=n.segments[s],c=e[r];if(xp(c))break;const u=`${c}`,h=r<e.length-1?e[r+1]:null;if(s>0&&void 0===u)break;if(u&&h&&"object"==typeof h&&void 0===h.outlets){if(!Dq(u,h,o))return i;r+=2}else{if(!Dq(u,{},o))return i;r++}s++}return{match:!0,pathIndex:s,commandIndex:r}}(n,t,e),s=e.slice(r.commandIndex);if(r.match&&r.pathIndex<n.segments.length){const i=new jn(n.segments.slice(0,r.pathIndex),{});return i.children[$n]=new jn(n.segments.slice(r.pathIndex),n.children),kp(i,0,s)}return r.match&&0===s.length?new jn(n.segments,{}):r.match&&!n.hasChildren()?FN(n,t,e):r.match?kp(n,0,s):FN(n,t,e)}function kp(n,t,e){if(0===e.length)return new jn(n.segments,{});{const r=function cfe(n){return xp(n[0])?n[0].outlets:{[$n]:n}}(e),s={};return C2(r,(i,o)=>{"string"==typeof i&&(i=[i]),null!==i&&(s[o]=HN(n.children[o],t,i))}),C2(n.children,(i,o)=>{void 0===r[o]&&(s[o]=i)}),new jn(n.segments,s)}}function FN(n,t,e){const r=n.segments.slice(0,t);let s=0;for(;s<e.length;){const i=e[s];if(xp(i)){const u=ufe(i.outlets);return new jn(r,u)}if(0===s&&Ip(e[0])){r.push(new Np(n.segments[t].path,Rq(e[0]))),s++;continue}const o=xp(i)?i.outlets[$n]:`${i}`,c=s<e.length-1?e[s+1]:null;o&&c&&Ip(c)?(r.push(new Np(o,Rq(c))),s+=2):(r.push(new Np(o,{})),s++)}return new jn(r,{})}function ufe(n){const t={};return C2(n,(e,r)=>{"string"==typeof e&&(e=[e]),null!==e&&(t[r]=FN(new jn([],{}),0,e))}),t}function Rq(n){const t={};return C2(n,(e,r)=>t[r]=`${e}`),t}function Dq(n,t,e){return n==e.path&&P4(t,e.parameters)}class Rl{constructor(t,e){this.id=t,this.url=e}}class BN extends Rl{constructor(t,e,r="imperative",s=null){super(t,e),this.type=0,this.navigationTrigger=r,this.restoredState=s}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class w0 extends Rl{constructor(t,e,r){super(t,e),this.urlAfterRedirects=r,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class Ky extends Rl{constructor(t,e,r,s){super(t,e),this.reason=r,this.code=s,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class zq extends Rl{constructor(t,e,r,s){super(t,e),this.error=r,this.target=s,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class ffe extends Rl{constructor(t,e,r,s){super(t,e),this.urlAfterRedirects=r,this.state=s,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class hfe extends Rl{constructor(t,e,r,s){super(t,e),this.urlAfterRedirects=r,this.state=s,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class dfe extends Rl{constructor(t,e,r,s,i){super(t,e),this.urlAfterRedirects=r,this.state=s,this.shouldActivate=i,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class pfe extends Rl{constructor(t,e,r,s){super(t,e),this.urlAfterRedirects=r,this.state=s,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class gfe extends Rl{constructor(t,e,r,s){super(t,e),this.urlAfterRedirects=r,this.state=s,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class mfe{constructor(t){this.route=t,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class _fe{constructor(t){this.route=t,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class vfe{constructor(t){this.snapshot=t,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Cfe{constructor(t){this.snapshot=t,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class yfe{constructor(t){this.snapshot=t,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Efe{constructor(t){this.snapshot=t,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Vq{constructor(t,e,r){this.routerEvent=t,this.position=e,this.anchor=r,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class Hq{constructor(t){this._root=t}get root(){return this._root.value}parent(t){const e=this.pathFromRoot(t);return e.length>1?e[e.length-2]:null}children(t){const e=$N(t,this._root);return e?e.children.map(r=>r.value):[]}firstChild(t){const e=$N(t,this._root);return e&&e.children.length>0?e.children[0].value:null}siblings(t){const e=UN(t,this._root);return e.length<2?[]:e[e.length-2].children.map(s=>s.value).filter(s=>s!==t)}pathFromRoot(t){return UN(t,this._root).map(e=>e.value)}}function $N(n,t){if(n===t.value)return t;for(const e of t.children){const r=$N(n,e);if(r)return r}return null}function UN(n,t){if(n===t.value)return[t];for(const e of t.children){const r=UN(n,e);if(r.length)return r.unshift(t),r}return[]}class Dl{constructor(t,e){this.value=t,this.children=e}toString(){return`TreeNode(${this.value})`}}function gf(n){const t={};return n&&n.children.forEach(e=>t[e.value.outlet]=e),t}class Fq extends Hq{constructor(t,e){super(t),this.snapshot=e,GN(this,t)}toString(){return this.snapshot.toString()}}function Bq(n,t){const e=function Sfe(n,t){const o=new Xy([],{},{},"",{},$n,t,null,n.root,-1,{});return new Uq("",new Dl(o,[]))}(n,t),r=new N3([new Np("",{})]),s=new N3({}),i=new N3({}),o=new N3({}),c=new N3(""),u=new bo(r,s,o,c,i,$n,t,e.root);return u.snapshot=e.root,new Fq(new Dl(u,[]),e)}class bo{constructor(t,e,r,s,i,o,c,u){this.url=t,this.params=e,this.queryParams=r,this.fragment=s,this.data=i,this.outlet=o,this.component=c,this.title=this.data?.pipe(gn(h=>h[Op]))??Zt(void 0),this._futureSnapshot=u}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(gn(t=>hf(t)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(gn(t=>hf(t)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function $q(n,t="emptyOnly"){const e=n.pathFromRoot;let r=0;if("always"!==t)for(r=e.length-1;r>=1;){const s=e[r],i=e[r-1];if(s.routeConfig&&""===s.routeConfig.path)r--;else{if(i.component)break;r--}}return function Pfe(n){return n.reduce((t,e)=>({params:{...t.params,...e.params},data:{...t.data,...e.data},resolve:{...e.data,...t.resolve,...e.routeConfig?.data,...e._resolvedData}}),{params:{},data:{},resolve:{}})}(e.slice(r))}class Xy{constructor(t,e,r,s,i,o,c,u,h,p,m,C){this.url=t,this.params=e,this.queryParams=r,this.fragment=s,this.data=i,this.outlet=o,this.component=c,this.title=this.data?.[Op],this.routeConfig=u,this._urlSegment=h,this._lastPathIndex=p,this._correctedLastPathIndex=C??p,this._resolve=m}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=hf(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=hf(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(r=>r.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class Uq extends Hq{constructor(t,e){super(e),this.url=t,GN(this,e)}toString(){return Gq(this._root)}}function GN(n,t){t.value._routerState=n,t.children.forEach(e=>GN(n,e))}function Gq(n){const t=n.children.length>0?` { ${n.children.map(Gq).join(", ")} } `:"";return`${n.value}${t}`}function WN(n){if(n.snapshot){const t=n.snapshot,e=n._futureSnapshot;n.snapshot=e,P4(t.queryParams,e.queryParams)||n.queryParams.next(e.queryParams),t.fragment!==e.fragment&&n.fragment.next(e.fragment),P4(t.params,e.params)||n.params.next(e.params),function H7e(n,t){if(n.length!==t.length)return!1;for(let e=0;e<n.length;++e)if(!P4(n[e],t[e]))return!1;return!0}(t.url,e.url)||n.url.next(e.url),P4(t.data,e.data)||n.data.next(e.data)}else n.snapshot=n._futureSnapshot,n.data.next(n._futureSnapshot.data)}function qN(n,t){const e=P4(n.params,t.params)&&function G7e(n,t){return bu(n,t)&&n.every((e,r)=>P4(e.parameters,t[r].parameters))}(n.url,t.url);return e&&!(!n.parent!=!t.parent)&&(!n.parent||qN(n.parent,t.parent))}function Lp(n,t,e){if(e&&n.shouldReuseRoute(t.value,e.value.snapshot)){const r=e.value;r._futureSnapshot=t.value;const s=function wfe(n,t,e){return t.children.map(r=>{for(const s of e.children)if(n.shouldReuseRoute(r.value,s.value.snapshot))return Lp(n,r,s);return Lp(n,r)})}(n,t,e);return new Dl(r,s)}{if(n.shouldAttach(t.value)){const i=n.retrieve(t.value);if(null!==i){const o=i.route;return o.value._futureSnapshot=t.value,o.children=t.children.map(c=>Lp(n,c)),o}}const r=function bfe(n){return new bo(new N3(n.url),new N3(n.params),new N3(n.queryParams),new N3(n.fragment),new N3(n.data),n.outlet,n.component,n)}(t.value),s=t.children.map(i=>Lp(n,i));return new Dl(r,s)}}const jN="ngNavigationCancelingError";function Wq(n,t){const{redirectTo:e,navigationBehaviorOptions:r}=Ou(t)?{redirectTo:t,navigationBehaviorOptions:void 0}:t,s=qq(!1,0,t);return s.url=e,s.navigationBehaviorOptions=r,s}function qq(n,t,e){const r=new Error("NavigationCancelingError: "+(n||""));return r[jN]=!0,r.cancellationCode=t,e&&(r.url=e),r}function jq(n){return Zq(n)&&Ou(n.url)}function Zq(n){return n&&n[jN]}class Ofe{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.injector=null,this.children=new Rp,this.attachRef=null}}let Rp=(()=>{class n{constructor(){this.contexts=new Map}onChildOutletCreated(e,r){const s=this.getOrCreateContext(e);s.outlet=r,this.contexts.set(e,s)}onChildOutletDestroyed(e){const r=this.getContext(e);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){const e=this.contexts;return this.contexts=new Map,e}onOutletReAttached(e){this.contexts=e}getOrCreateContext(e){let r=this.getContext(e);return r||(r=new Ofe,this.contexts.set(e,r)),r}getContext(e){return this.contexts.get(e)||null}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const Qy=!1;let ZN=(()=>{class n{constructor(e,r,s,i,o){this.parentContexts=e,this.location=r,this.changeDetector=i,this.environmentInjector=o,this.activated=null,this._activatedRoute=null,this.activateEvents=new mr,this.deactivateEvents=new mr,this.attachEvents=new mr,this.detachEvents=new mr,this.name=s||$n,e.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.getContext(this.name)?.outlet===this&&this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const e=this.parentContexts.getContext(this.name);e&&e.route&&(e.attachRef?this.attach(e.attachRef,e.route):this.activateWith(e.route,e.injector))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Ae(4012,Qy);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Ae(4012,Qy);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Ae(4012,Qy);this.location.detach();const e=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(e.instance),e}attach(e,r){this.activated=e,this._activatedRoute=r,this.location.insert(e.hostView),this.attachEvents.emit(e.instance)}deactivate(){if(this.activated){const e=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(e)}}activateWith(e,r){if(this.isActivated)throw new Ae(4013,Qy);this._activatedRoute=e;const s=this.location,o=e._futureSnapshot.component,c=this.parentContexts.getOrCreateContext(this.name).children,u=new Nfe(e,c,s.injector);if(r&&function Afe(n){return!!n.resolveComponentFactory}(r)){const h=r.resolveComponentFactory(o);this.activated=s.createComponent(h,s.length,u)}else this.activated=s.createComponent(o,{index:s.length,injector:u,environmentInjector:r??this.environmentInjector});this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return n.\u0275fac=function(e){return new(e||n)(J(Rp),J(za),V8("name"),J(_u),J(Aa))},n.\u0275dir=Ut({type:n,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0}),n})();class Nfe{constructor(t,e,r){this.route=t,this.childContexts=e,this.parent=r}get(t,e){return t===bo?this.route:t===Rp?this.childContexts:this.parent.get(t,e)}}let YN=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=gt({type:n,selectors:[["ng-component"]],standalone:!0,features:[z$],decls:1,vars:0,template:function(e,r){1&e&&Q(0,"router-outlet")},dependencies:[ZN],encapsulation:2}),n})();function Yq(n,t){return n.providers&&!n._injector&&(n._injector=ty(n.providers,t,`Route: ${n.path}`)),n._injector??t}function XN(n){const t=n.children&&n.children.map(XN),e=t?{...n,children:t}:{...n};return!e.component&&!e.loadComponent&&(t||e.loadChildren)&&e.outlet&&e.outlet!==$n&&(e.component=YN),e}function bc(n){return n.outlet||$n}function Kq(n,t){const e=n.filter(r=>bc(r)===t);return e.push(...n.filter(r=>bc(r)!==t)),e}function Dp(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let t=n.parent;t;t=t.parent){const e=t.routeConfig;if(e?._loadedInjector)return e._loadedInjector;if(e?._injector)return e._injector}return null}class Rfe{constructor(t,e,r,s){this.routeReuseStrategy=t,this.futureState=e,this.currState=r,this.forwardEvent=s}activate(t){const e=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(e,r,t),WN(this.futureState.root),this.activateChildRoutes(e,r,t)}deactivateChildRoutes(t,e,r){const s=gf(e);t.children.forEach(i=>{const o=i.value.outlet;this.deactivateRoutes(i,s[o],r),delete s[o]}),C2(s,(i,o)=>{this.deactivateRouteAndItsChildren(i,r)})}deactivateRoutes(t,e,r){const s=t.value,i=e?e.value:null;if(s===i)if(s.component){const o=r.getContext(s.outlet);o&&this.deactivateChildRoutes(t,e,o.children)}else this.deactivateChildRoutes(t,e,r);else i&&this.deactivateRouteAndItsChildren(e,r)}deactivateRouteAndItsChildren(t,e){t.value.component&&this.routeReuseStrategy.shouldDetach(t.value.snapshot)?this.detachAndStoreRouteSubtree(t,e):this.deactivateRouteAndOutlet(t,e)}detachAndStoreRouteSubtree(t,e){const r=e.getContext(t.value.outlet),s=r&&t.value.component?r.children:e,i=gf(t);for(const o of Object.keys(i))this.deactivateRouteAndItsChildren(i[o],s);if(r&&r.outlet){const o=r.outlet.detach(),c=r.children.onOutletDeactivated();this.routeReuseStrategy.store(t.value.snapshot,{componentRef:o,route:t,contexts:c})}}deactivateRouteAndOutlet(t,e){const r=e.getContext(t.value.outlet),s=r&&t.value.component?r.children:e,i=gf(t);for(const o of Object.keys(i))this.deactivateRouteAndItsChildren(i[o],s);r&&r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated(),r.attachRef=null,r.resolver=null,r.route=null)}activateChildRoutes(t,e,r){const s=gf(e);t.children.forEach(i=>{this.activateRoutes(i,s[i.value.outlet],r),this.forwardEvent(new Efe(i.value.snapshot))}),t.children.length&&this.forwardEvent(new Cfe(t.value.snapshot))}activateRoutes(t,e,r){const s=t.value,i=e?e.value:null;if(WN(s),s===i)if(s.component){const o=r.getOrCreateContext(s.outlet);this.activateChildRoutes(t,e,o.children)}else this.activateChildRoutes(t,e,r);else if(s.component){const o=r.getOrCreateContext(s.outlet);if(this.routeReuseStrategy.shouldAttach(s.snapshot)){const c=this.routeReuseStrategy.retrieve(s.snapshot);this.routeReuseStrategy.store(s.snapshot,null),o.children.onOutletReAttached(c.contexts),o.attachRef=c.componentRef,o.route=c.route.value,o.outlet&&o.outlet.attach(c.componentRef,c.route.value),WN(c.route.value),this.activateChildRoutes(t,null,o.children)}else{const c=Dp(s.snapshot),u=c?.get(Ia)??null;o.attachRef=null,o.route=s,o.resolver=u,o.injector=c,o.outlet&&o.outlet.activateWith(s,o.injector),this.activateChildRoutes(t,null,o.children)}}else this.activateChildRoutes(t,null,r)}}class Xq{constructor(t){this.path=t,this.route=this.path[this.path.length-1]}}class Jy{constructor(t,e){this.component=t,this.route=e}}function Dfe(n,t,e){const r=n._root;return zp(r,t?t._root:null,e,[r.value])}function mf(n,t){const e=Symbol(),r=t.get(n,e);return r===e?"function"!=typeof n||function $2(n){return null!==kn(n)}(n)?t.get(n):n:r}function zp(n,t,e,r,s={canDeactivateChecks:[],canActivateChecks:[]}){const i=gf(t);return n.children.forEach(o=>{(function Vfe(n,t,e,r,s={canDeactivateChecks:[],canActivateChecks:[]}){const i=n.value,o=t?t.value:null,c=e?e.getContext(n.value.outlet):null;if(o&&i.routeConfig===o.routeConfig){const u=function Hfe(n,t,e){if("function"==typeof e)return e(n,t);switch(e){case"pathParamsChange":return!bu(n.url,t.url);case"pathParamsOrQueryParamsChange":return!bu(n.url,t.url)||!P4(n.queryParams,t.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!qN(n,t)||!P4(n.queryParams,t.queryParams);default:return!qN(n,t)}}(o,i,i.routeConfig.runGuardsAndResolvers);u?s.canActivateChecks.push(new Xq(r)):(i.data=o.data,i._resolvedData=o._resolvedData),zp(n,t,i.component?c?c.children:null:e,r,s),u&&c&&c.outlet&&c.outlet.isActivated&&s.canDeactivateChecks.push(new Jy(c.outlet.component,o))}else o&&Vp(t,c,s),s.canActivateChecks.push(new Xq(r)),zp(n,null,i.component?c?c.children:null:e,r,s)})(o,i[o.value.outlet],e,r.concat([o.value]),s),delete i[o.value.outlet]}),C2(i,(o,c)=>Vp(o,e.getContext(c),s)),s}function Vp(n,t,e){const r=gf(n),s=n.value;C2(r,(i,o)=>{Vp(i,s.component?t?t.children.getContext(o):null:t,e)}),e.canDeactivateChecks.push(new Jy(s.component&&t&&t.outlet&&t.outlet.isActivated?t.outlet.component:null,s))}function Hp(n){return"function"==typeof n}function QN(n){return n instanceof $y||"EmptyError"===n?.name}const eE=Symbol("INITIAL_VALUE");function _f(){return S4(n=>hq(n.map(t=>t.pipe(bp(1),function x7e(...n){const t=K3(n);return gr((e,r)=>{(t?AN(n,e,t):AN(n,e)).subscribe(r)})}(eE)))).pipe(gn(t=>{for(const e of t)if(!0!==e){if(e===eE)return eE;if(!1===e||e instanceof wu)return e}return!0}),kl(t=>t!==eE),bp(1)))}function Qq(n){return function tT(...n){return s_(n)}(v2(t=>{if(Ou(t))throw Wq(0,t)}),gn(t=>!0===t))}const JN={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function Jq(n,t,e,r,s){const i=eA(n,t,e);return i.matched?function n9e(n,t,e,r){const s=t.canMatch;return s&&0!==s.length?Zt(s.map(o=>{const c=mf(o,n);return T0(function Wfe(n){return n&&Hp(n.canMatch)}(c)?c.canMatch(t,e):n.runInContext(()=>c(t,e)))})).pipe(_f(),Qq()):Zt(!0)}(r=Yq(t,r),t,e).pipe(gn(o=>!0===o?i:{...JN})):Zt(i)}function eA(n,t,e){if(""===t.path)return"full"===t.pathMatch&&(n.hasChildren()||e.length>0)?{...JN}:{matched:!0,consumedSegments:[],remainingSegments:e,parameters:{},positionalParamSegments:{}};const s=(t.matcher||V7e)(e,n,t);if(!s)return{...JN};const i={};C2(s.posParams,(c,u)=>{i[u]=c.path});const o=s.consumed.length>0?{...i,...s.consumed[s.consumed.length-1].parameters}:i;return{matched:!0,consumedSegments:s.consumed,remainingSegments:e.slice(s.consumed.length),parameters:o,positionalParamSegments:s.posParams??{}}}function tE(n,t,e,r,s="corrected"){if(e.length>0&&function i9e(n,t,e){return e.some(r=>nE(n,t,r)&&bc(r)!==$n)}(n,e,r)){const o=new jn(t,function s9e(n,t,e,r){const s={};s[$n]=r,r._sourceSegment=n,r._segmentIndexShift=t.length;for(const i of e)if(""===i.path&&bc(i)!==$n){const o=new jn([],{});o._sourceSegment=n,o._segmentIndexShift=t.length,s[bc(i)]=o}return s}(n,t,r,new jn(e,n.children)));return o._sourceSegment=n,o._segmentIndexShift=t.length,{segmentGroup:o,slicedSegments:[]}}if(0===e.length&&function o9e(n,t,e){return e.some(r=>nE(n,t,r))}(n,e,r)){const o=new jn(n.segments,function r9e(n,t,e,r,s,i){const o={};for(const c of r)if(nE(n,e,c)&&!s[bc(c)]){const u=new jn([],{});u._sourceSegment=n,u._segmentIndexShift="legacy"===i?n.segments.length:t.length,o[bc(c)]=u}return{...s,...o}}(n,t,e,r,n.children,s));return o._sourceSegment=n,o._segmentIndexShift=t.length,{segmentGroup:o,slicedSegments:e}}const i=new jn(n.segments,n.children);return i._sourceSegment=n,i._segmentIndexShift=t.length,{segmentGroup:i,slicedSegments:e}}function nE(n,t,e){return(!(n.hasChildren()||t.length>0)||"full"!==e.pathMatch)&&""===e.path}function ej(n,t,e,r){return!!(bc(n)===r||r!==$n&&nE(t,e,n))&&("**"===n.path||eA(t,n,e).matched)}function tj(n,t,e){return 0===t.length&&!n.children[e]}const rE=!1;class sE{constructor(t){this.segmentGroup=t||null}}class nj{constructor(t){this.urlTree=t}}function Fp(n){return wp(new sE(n))}function rj(n){return wp(new nj(n))}class u9e{constructor(t,e,r,s,i){this.injector=t,this.configLoader=e,this.urlSerializer=r,this.urlTree=s,this.config=i,this.allowRedirects=!0}apply(){const t=tE(this.urlTree.root,[],[],this.config).segmentGroup,e=new jn(t.segments,t.children);return this.expandSegmentGroup(this.injector,this.config,e,$n).pipe(gn(i=>this.createUrlTree(Yy(i),this.urlTree.queryParams,this.urlTree.fragment))).pipe(P0(i=>{if(i instanceof nj)return this.allowRedirects=!1,this.match(i.urlTree);throw i instanceof sE?this.noMatchError(i):i}))}match(t){return this.expandSegmentGroup(this.injector,this.config,t.root,$n).pipe(gn(s=>this.createUrlTree(Yy(s),t.queryParams,t.fragment))).pipe(P0(s=>{throw s instanceof sE?this.noMatchError(s):s}))}noMatchError(t){return new Ae(4002,rE)}createUrlTree(t,e,r){const s=zN(t);return new wu(s,e,r)}expandSegmentGroup(t,e,r,s){return 0===r.segments.length&&r.hasChildren()?this.expandChildren(t,e,r).pipe(gn(i=>new jn([],i))):this.expandSegment(t,r,e,r.segments,s,!0)}expandChildren(t,e,r){const s=[];for(const i of Object.keys(r.children))"primary"===i?s.unshift(i):s.push(i);return ls(s).pipe(E0(i=>{const o=r.children[i],c=Kq(e,i);return this.expandSegmentGroup(t,c,o,i).pipe(gn(u=>({segment:u,outlet:i})))}),_q((i,o)=>(i[o.outlet]=o.segment,i),{}),vq())}expandSegment(t,e,r,s,i,o){return ls(r).pipe(E0(c=>this.expandSegmentAgainstRoute(t,e,r,c,s,i,o).pipe(P0(h=>{if(h instanceof sE)return Zt(null);throw h}))),S0(c=>!!c),P0((c,u)=>{if(QN(c))return tj(e,s,i)?Zt(new jn([],{})):Fp(e);throw c}))}expandSegmentAgainstRoute(t,e,r,s,i,o,c){return ej(s,e,i,o)?void 0===s.redirectTo?this.matchSegmentAgainstRoute(t,e,s,i,o):c&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(t,e,r,s,i,o):Fp(e):Fp(e)}expandSegmentAgainstRouteUsingRedirect(t,e,r,s,i,o){return"**"===s.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(t,r,s,o):this.expandRegularSegmentAgainstRouteUsingRedirect(t,e,r,s,i,o)}expandWildCardWithParamsAgainstRouteUsingRedirect(t,e,r,s){const i=this.applyRedirectCommands([],r.redirectTo,{});return r.redirectTo.startsWith("/")?rj(i):this.lineralizeSegments(r,i).pipe(ze(o=>{const c=new jn(o,{});return this.expandSegment(t,c,e,o,s,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(t,e,r,s,i,o){const{matched:c,consumedSegments:u,remainingSegments:h,positionalParamSegments:p}=eA(e,s,i);if(!c)return Fp(e);const m=this.applyRedirectCommands(u,s.redirectTo,p);return s.redirectTo.startsWith("/")?rj(m):this.lineralizeSegments(s,m).pipe(ze(C=>this.expandSegment(t,e,r,C.concat(h),o,!1)))}matchSegmentAgainstRoute(t,e,r,s,i){return"**"===r.path?(t=Yq(r,t),r.loadChildren?(r._loadedRoutes?Zt({routes:r._loadedRoutes,injector:r._loadedInjector}):this.configLoader.loadChildren(t,r)).pipe(gn(c=>(r._loadedRoutes=c.routes,r._loadedInjector=c.injector,new jn(s,{})))):Zt(new jn(s,{}))):Jq(e,r,s,t).pipe(S4(({matched:o,consumedSegments:c,remainingSegments:u})=>o?this.getChildConfig(t=r._injector??t,r,s).pipe(ze(p=>{const m=p.injector??t,C=p.routes,{segmentGroup:w,slicedSegments:I}=tE(e,c,u,C),H=new jn(w.segments,w.children);if(0===I.length&&H.hasChildren())return this.expandChildren(m,C,H).pipe(gn(te=>new jn(c,te)));if(0===C.length&&0===I.length)return Zt(new jn(c,{}));const K=bc(r)===i;return this.expandSegment(m,H,C,I,K?$n:i,!0).pipe(gn(ye=>new jn(c.concat(ye.segments),ye.children)))})):Fp(e)))}getChildConfig(t,e,r){return e.children?Zt({routes:e.children,injector:t}):e.loadChildren?void 0!==e._loadedRoutes?Zt({routes:e._loadedRoutes,injector:e._loadedInjector}):function t9e(n,t,e,r){const s=t.canLoad;return void 0===s||0===s.length?Zt(!0):Zt(s.map(o=>{const c=mf(o,n);return T0(function Bfe(n){return n&&Hp(n.canLoad)}(c)?c.canLoad(t,e):n.runInContext(()=>c(t,e)))})).pipe(_f(),Qq())}(t,e,r).pipe(ze(s=>s?this.configLoader.loadChildren(t,e).pipe(v2(i=>{e._loadedRoutes=i.routes,e._loadedInjector=i.injector})):function c9e(n){return wp(qq(rE,3))}())):Zt({routes:[],injector:t})}lineralizeSegments(t,e){let r=[],s=e.root;for(;;){if(r=r.concat(s.segments),0===s.numberOfChildren)return Zt(r);if(s.numberOfChildren>1||!s.children[$n])return wp(new Ae(4e3,rE));s=s.children[$n]}}applyRedirectCommands(t,e,r){return this.applyRedirectCreateUrlTree(e,this.urlSerializer.parse(e),t,r)}applyRedirectCreateUrlTree(t,e,r,s){const i=this.createSegmentGroup(t,e.root,r,s);return new wu(i,this.createQueryParams(e.queryParams,this.urlTree.queryParams),e.fragment)}createQueryParams(t,e){const r={};return C2(t,(s,i)=>{if("string"==typeof s&&s.startsWith(":")){const c=s.substring(1);r[i]=e[c]}else r[i]=s}),r}createSegmentGroup(t,e,r,s){const i=this.createSegments(t,e.segments,r,s);let o={};return C2(e.children,(c,u)=>{o[u]=this.createSegmentGroup(t,c,r,s)}),new jn(i,o)}createSegments(t,e,r,s){return e.map(i=>i.path.startsWith(":")?this.findPosParam(t,i,s):this.findOrReturn(i,r))}findPosParam(t,e,r){const s=r[e.path.substring(1)];if(!s)throw new Ae(4001,rE);return s}findOrReturn(t,e){let r=0;for(const s of e){if(s.path===t.path)return e.splice(r),s;r++}return t}}class h9e{}class g9e{constructor(t,e,r,s,i,o,c,u){this.injector=t,this.rootComponentType=e,this.config=r,this.urlTree=s,this.url=i,this.paramsInheritanceStrategy=o,this.relativeLinkResolution=c,this.urlSerializer=u}recognize(){const t=tE(this.urlTree.root,[],[],this.config.filter(e=>void 0===e.redirectTo),this.relativeLinkResolution).segmentGroup;return this.processSegmentGroup(this.injector,this.config,t,$n).pipe(gn(e=>{if(null===e)return null;const r=new Xy([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},$n,this.rootComponentType,null,this.urlTree.root,-1,{}),s=new Dl(r,e),i=new Uq(this.url,s);return this.inheritParamsAndData(i._root),i}))}inheritParamsAndData(t){const e=t.value,r=$q(e,this.paramsInheritanceStrategy);e.params=Object.freeze(r.params),e.data=Object.freeze(r.data),t.children.forEach(s=>this.inheritParamsAndData(s))}processSegmentGroup(t,e,r,s){return 0===r.segments.length&&r.hasChildren()?this.processChildren(t,e,r):this.processSegment(t,e,r,r.segments,s)}processChildren(t,e,r){return ls(Object.keys(r.children)).pipe(E0(s=>{const i=r.children[s],o=Kq(e,s);return this.processSegmentGroup(t,o,i,s)}),_q((s,i)=>s&&i?(s.push(...i),s):null),function R7e(n,t=!1){return gr((e,r)=>{let s=0;e.subscribe(cs(r,i=>{const o=n(i,s++);(o||t)&&r.next(i),!o&&r.complete()}))})}(s=>null!==s),Uy(null),vq(),gn(s=>{if(null===s)return null;const i=sj(s);return function m9e(n){n.sort((t,e)=>t.value.outlet===$n?-1:e.value.outlet===$n?1:t.value.outlet.localeCompare(e.value.outlet))}(i),i}))}processSegment(t,e,r,s,i){return ls(e).pipe(E0(o=>this.processSegmentAgainstRoute(o._injector??t,o,r,s,i)),S0(o=>!!o),P0(o=>{if(QN(o))return tj(r,s,i)?Zt([]):Zt(null);throw o}))}processSegmentAgainstRoute(t,e,r,s,i){if(e.redirectTo||!ej(e,r,s,i))return Zt(null);let o;if("**"===e.path){const c=s.length>0?Eq(s).parameters:{},u=oj(r)+s.length;o=Zt({snapshot:new Xy(s,c,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,cj(e),bc(e),e.component??e._loadedComponent??null,e,ij(r),u,lj(e),u),consumedSegments:[],remainingSegments:[]})}else o=Jq(r,e,s,t).pipe(gn(({matched:c,consumedSegments:u,remainingSegments:h,parameters:p})=>{if(!c)return null;const m=oj(r)+u.length;return{snapshot:new Xy(u,p,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,cj(e),bc(e),e.component??e._loadedComponent??null,e,ij(r),m,lj(e),m),consumedSegments:u,remainingSegments:h}}));return o.pipe(S4(c=>{if(null===c)return Zt(null);const{snapshot:u,consumedSegments:h,remainingSegments:p}=c;t=e._injector??t;const m=e._loadedInjector??t,C=function _9e(n){return n.children?n.children:n.loadChildren?n._loadedRoutes:[]}(e),{segmentGroup:w,slicedSegments:I}=tE(r,h,p,C.filter(K=>void 0===K.redirectTo),this.relativeLinkResolution);if(0===I.length&&w.hasChildren())return this.processChildren(m,C,w).pipe(gn(K=>null===K?null:[new Dl(u,K)]));if(0===C.length&&0===I.length)return Zt([new Dl(u,[])]);const H=bc(e)===i;return this.processSegment(m,C,w,I,H?$n:i).pipe(gn(K=>null===K?null:[new Dl(u,K)]))}))}}function v9e(n){const t=n.value.routeConfig;return t&&""===t.path&&void 0===t.redirectTo}function sj(n){const t=[],e=new Set;for(const r of n){if(!v9e(r)){t.push(r);continue}const s=t.find(i=>r.value.routeConfig===i.value.routeConfig);void 0!==s?(s.children.push(...r.children),e.add(s)):t.push(r)}for(const r of e){const s=sj(r.children);t.push(new Dl(r.value,s))}return t.filter(r=>!e.has(r))}function ij(n){let t=n;for(;t._sourceSegment;)t=t._sourceSegment;return t}function oj(n){let t=n,e=t._segmentIndexShift??0;for(;t._sourceSegment;)t=t._sourceSegment,e+=t._segmentIndexShift??0;return e-1}function cj(n){return n.data||{}}function lj(n){return n.resolve||{}}function uj(n){return"string"==typeof n.title||null===n.title}function tA(n){return S4(t=>{const e=n(t);return e?ls(e).pipe(gn(()=>t)):Zt(t)})}let fj=(()=>{class n{buildTitle(e){let r,s=e.root;for(;void 0!==s;)r=this.getResolvedTitleForRoute(s)??r,s=s.children.find(i=>i.outlet===$n);return r}getResolvedTitleForRoute(e){return e.data[Op]}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=nt({token:n,factory:function(){return zr(hj)},providedIn:"root"}),n})(),hj=(()=>{class n extends fj{constructor(e){super(),this.title=e}updateTitle(e){const r=this.buildTitle(e);void 0!==r&&this.title.setTitle(r)}}return n.\u0275fac=function(e){return new(e||n)(De(GG))},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class w9e{}class O9e extends class b9e{shouldDetach(t){return!1}store(t,e){}shouldAttach(t){return!1}retrieve(t){return null}shouldReuseRoute(t,e){return t.routeConfig===e.routeConfig}}{}const oE=new kt("",{providedIn:"root",factory:()=>({})}),nA=new kt("ROUTES");let rA=(()=>{class n{constructor(e,r){this.injector=e,this.compiler=r,this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap}loadComponent(e){if(this.componentLoaders.get(e))return this.componentLoaders.get(e);if(e._loadedComponent)return Zt(e._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(e);const r=T0(e.loadComponent()).pipe(v2(i=>{this.onLoadEndListener&&this.onLoadEndListener(e),e._loadedComponent=i}),kN(()=>{this.componentLoaders.delete(e)})),s=new gq(r,()=>new F2).pipe(IN());return this.componentLoaders.set(e,s),s}loadChildren(e,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return Zt({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);const i=this.loadModuleFactoryOrRoutes(r.loadChildren).pipe(gn(c=>{this.onLoadEndListener&&this.onLoadEndListener(r);let u,h,p=!1;Array.isArray(c)?h=c:(u=c.create(e).injector,h=yq(u.get(nA,[],jt.Self|jt.Optional)));return{routes:h.map(XN),injector:u}}),kN(()=>{this.childrenLoaders.delete(r)})),o=new gq(i,()=>new F2).pipe(IN());return this.childrenLoaders.set(r,o),o}loadModuleFactoryOrRoutes(e){return T0(e()).pipe(ze(r=>r instanceof R$||Array.isArray(r)?Zt(r):ls(this.compiler.compileModuleAsync(r))))}}return n.\u0275fac=function(e){return new(e||n)(De(fi),De(SO))},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class A9e{}class I9e{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,e){return t}}function x9e(n){throw n}function k9e(n,t,e){return t.parse("/")}const L9e={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},R9e={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};function pj(){const n=zr(bq),t=zr(Rp),e=zr(VO),r=zr(fi),s=zr(SO),i=zr(nA,{optional:!0})??[],o=zr(oE,{optional:!0})??{},c=zr(hj),u=zr(fj,{optional:!0}),h=zr(A9e,{optional:!0}),p=zr(w9e,{optional:!0}),m=new Zn(null,n,t,e,r,s,yq(i));return h&&(m.urlHandlingStrategy=h),p&&(m.routeReuseStrategy=p),m.titleStrategy=u??c,function D9e(n,t){n.errorHandler&&(t.errorHandler=n.errorHandler),n.malformedUriErrorHandler&&(t.malformedUriErrorHandler=n.malformedUriErrorHandler),n.onSameUrlNavigation&&(t.onSameUrlNavigation=n.onSameUrlNavigation),n.paramsInheritanceStrategy&&(t.paramsInheritanceStrategy=n.paramsInheritanceStrategy),n.relativeLinkResolution&&(t.relativeLinkResolution=n.relativeLinkResolution),n.urlUpdateStrategy&&(t.urlUpdateStrategy=n.urlUpdateStrategy),n.canceledNavigationResolution&&(t.canceledNavigationResolution=n.canceledNavigationResolution)}(o,m),m}let Zn=(()=>{class n{constructor(e,r,s,i,o,c,u){this.rootComponentType=e,this.urlSerializer=r,this.rootContexts=s,this.location=i,this.config=u,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new F2,this.errorHandler=x9e,this.malformedUriErrorHandler=k9e,this.navigated=!1,this.lastSuccessfulId=-1,this.afterPreactivation=()=>Zt(void 0),this.urlHandlingStrategy=new I9e,this.routeReuseStrategy=new O9e,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.configLoader=o.get(rA),this.configLoader.onLoadEndListener=C=>this.triggerEvent(new _fe(C)),this.configLoader.onLoadStartListener=C=>this.triggerEvent(new mfe(C)),this.ngModule=o.get(mu),this.console=o.get(u0e);const m=o.get(Pr);this.isNgZoneEnabled=m instanceof Pr&&Pr.isInAngularZone(),this.resetConfig(u),this.currentUrlTree=function F7e(){return new wu(new jn([],{}),{},null)}(),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=Bq(this.currentUrlTree,this.rootComponentType),this.transitions=new N3({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}get browserPageId(){return this.location.getState()?.\u0275routerPageId}setupNavigations(e){const r=this.events;return e.pipe(kl(s=>0!==s.id),gn(s=>({...s,extractedUrl:this.urlHandlingStrategy.extract(s.rawUrl)})),S4(s=>{let i=!1,o=!1;return Zt(s).pipe(v2(c=>{this.currentNavigation={id:c.id,initialUrl:c.rawUrl,extractedUrl:c.extractedUrl,trigger:c.source,extras:c.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),S4(c=>{const u=this.browserUrlTree.toString(),h=!this.navigated||c.extractedUrl.toString()!==u||u!==this.currentUrlTree.toString();if(("reload"===this.onSameUrlNavigation||h)&&this.urlHandlingStrategy.shouldProcessUrl(c.rawUrl))return gj(c.source)&&(this.browserUrlTree=c.extractedUrl),Zt(c).pipe(S4(m=>{const C=this.transitions.getValue();return r.next(new BN(m.id,this.serializeUrl(m.extractedUrl),m.source,m.restoredState)),C!==this.transitions.getValue()?uc:Promise.resolve(m)}),function f9e(n,t,e,r){return S4(s=>function l9e(n,t,e,r,s){return new u9e(n,t,e,r,s).apply()}(n,t,e,s.extractedUrl,r).pipe(gn(i=>({...s,urlAfterRedirects:i}))))}(this.ngModule.injector,this.configLoader,this.urlSerializer,this.config),v2(m=>{this.currentNavigation={...this.currentNavigation,finalUrl:m.urlAfterRedirects},s.urlAfterRedirects=m.urlAfterRedirects}),function y9e(n,t,e,r,s,i){return ze(o=>function p9e(n,t,e,r,s,i,o="emptyOnly",c="legacy"){return new g9e(n,t,e,r,s,o,c,i).recognize().pipe(S4(u=>null===u?function d9e(n){return new Er(t=>t.error(n))}(new h9e):Zt(u)))}(n,t,e,o.urlAfterRedirects,r.serialize(o.urlAfterRedirects),r,s,i).pipe(gn(c=>({...o,targetSnapshot:c}))))}(this.ngModule.injector,this.rootComponentType,this.config,this.urlSerializer,this.paramsInheritanceStrategy,this.relativeLinkResolution),v2(m=>{if(s.targetSnapshot=m.targetSnapshot,"eager"===this.urlUpdateStrategy){if(!m.extras.skipLocationChange){const w=this.urlHandlingStrategy.merge(m.urlAfterRedirects,m.rawUrl);this.setBrowserUrl(w,m)}this.browserUrlTree=m.urlAfterRedirects}const C=new ffe(m.id,this.serializeUrl(m.extractedUrl),this.serializeUrl(m.urlAfterRedirects),m.targetSnapshot);r.next(C)}));if(h&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:C,extractedUrl:w,source:I,restoredState:H,extras:K}=c,ie=new BN(C,this.serializeUrl(w),I,H);r.next(ie);const ye=Bq(w,this.rootComponentType).snapshot;return Zt(s={...c,targetSnapshot:ye,urlAfterRedirects:w,extras:{...K,skipLocationChange:!1,replaceUrl:!1}})}return this.rawUrlTree=c.rawUrl,c.resolve(null),uc}),v2(c=>{const u=new hfe(c.id,this.serializeUrl(c.extractedUrl),this.serializeUrl(c.urlAfterRedirects),c.targetSnapshot);this.triggerEvent(u)}),gn(c=>s={...c,guards:Dfe(c.targetSnapshot,c.currentSnapshot,this.rootContexts)}),function jfe(n,t){return ze(e=>{const{targetSnapshot:r,currentSnapshot:s,guards:{canActivateChecks:i,canDeactivateChecks:o}}=e;return 0===o.length&&0===i.length?Zt({...e,guardsResult:!0}):function Zfe(n,t,e,r){return ls(n).pipe(ze(s=>function e9e(n,t,e,r,s){const i=t&&t.routeConfig?t.routeConfig.canDeactivate:null;return i&&0!==i.length?Zt(i.map(c=>{const u=Dp(t)??s,h=mf(c,u);return T0(function Gfe(n){return n&&Hp(n.canDeactivate)}(h)?h.canDeactivate(n,t,e,r):u.runInContext(()=>h(n,t,e,r))).pipe(S0())})).pipe(_f()):Zt(!0)}(s.component,s.route,e,t,r)),S0(s=>!0!==s,!0))}(o,r,s,n).pipe(ze(c=>c&&function Ffe(n){return"boolean"==typeof n}(c)?function Yfe(n,t,e,r){return ls(t).pipe(E0(s=>AN(function Xfe(n,t){return null!==n&&t&&t(new vfe(n)),Zt(!0)}(s.route.parent,r),function Kfe(n,t){return null!==n&&t&&t(new yfe(n)),Zt(!0)}(s.route,r),function Jfe(n,t,e){const r=t[t.length-1],i=t.slice(0,t.length-1).reverse().map(o=>function zfe(n){const t=n.routeConfig?n.routeConfig.canActivateChild:null;return t&&0!==t.length?{node:n,guards:t}:null}(o)).filter(o=>null!==o).map(o=>pq(()=>Zt(o.guards.map(u=>{const h=Dp(o.node)??e,p=mf(u,h);return T0(function Ufe(n){return n&&Hp(n.canActivateChild)}(p)?p.canActivateChild(r,n):h.runInContext(()=>p(r,n))).pipe(S0())})).pipe(_f())));return Zt(i).pipe(_f())}(n,s.path,e),function Qfe(n,t,e){const r=t.routeConfig?t.routeConfig.canActivate:null;if(!r||0===r.length)return Zt(!0);const s=r.map(i=>pq(()=>{const o=Dp(t)??e,c=mf(i,o);return T0(function $fe(n){return n&&Hp(n.canActivate)}(c)?c.canActivate(t,n):o.runInContext(()=>c(t,n))).pipe(S0())}));return Zt(s).pipe(_f())}(n,s.route,e))),S0(s=>!0!==s,!0))}(r,i,n,t):Zt(c)),gn(c=>({...e,guardsResult:c})))})}(this.ngModule.injector,c=>this.triggerEvent(c)),v2(c=>{if(s.guardsResult=c.guardsResult,Ou(c.guardsResult))throw Wq(0,c.guardsResult);const u=new dfe(c.id,this.serializeUrl(c.extractedUrl),this.serializeUrl(c.urlAfterRedirects),c.targetSnapshot,!!c.guardsResult);this.triggerEvent(u)}),kl(c=>!!c.guardsResult||(this.restoreHistory(c),this.cancelNavigationTransition(c,"",3),!1)),tA(c=>{if(c.guards.canActivateChecks.length)return Zt(c).pipe(v2(u=>{const h=new pfe(u.id,this.serializeUrl(u.extractedUrl),this.serializeUrl(u.urlAfterRedirects),u.targetSnapshot);this.triggerEvent(h)}),S4(u=>{let h=!1;return Zt(u).pipe(function E9e(n,t){return ze(e=>{const{targetSnapshot:r,guards:{canActivateChecks:s}}=e;if(!s.length)return Zt(e);let i=0;return ls(s).pipe(E0(o=>function M9e(n,t,e,r){const s=n.routeConfig,i=n._resolve;return void 0!==s?.title&&!uj(s)&&(i[Op]=s.title),function S9e(n,t,e,r){const s=function P9e(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}(n);if(0===s.length)return Zt({});const i={};return ls(s).pipe(ze(o=>function T9e(n,t,e,r){const s=Dp(t)??r,i=mf(n,s);return T0(i.resolve?i.resolve(t,e):s.runInContext(()=>i(t,e)))}(n[o],t,e,r).pipe(S0(),v2(c=>{i[o]=c}))),xN(1),function D7e(n){return gn(()=>n)}(i),P0(o=>QN(o)?uc:wp(o)))}(i,n,t,r).pipe(gn(o=>(n._resolvedData=o,n.data=$q(n,e).resolve,s&&uj(s)&&(n.data[Op]=s.title),null)))}(o.route,r,n,t)),v2(()=>i++),xN(1),ze(o=>i===s.length?Zt(e):uc))})}(this.paramsInheritanceStrategy,this.ngModule.injector),v2({next:()=>h=!0,complete:()=>{h||(this.restoreHistory(u),this.cancelNavigationTransition(u,"",2))}}))}),v2(u=>{const h=new gfe(u.id,this.serializeUrl(u.extractedUrl),this.serializeUrl(u.urlAfterRedirects),u.targetSnapshot);this.triggerEvent(h)}))}),tA(c=>{const u=h=>{const p=[];h.routeConfig?.loadComponent&&!h.routeConfig._loadedComponent&&p.push(this.configLoader.loadComponent(h.routeConfig).pipe(v2(m=>{h.component=m}),gn(()=>{})));for(const m of h.children)p.push(...u(m));return p};return hq(u(c.targetSnapshot.root)).pipe(Uy(),bp(1))}),tA(()=>this.afterPreactivation()),gn(c=>{const u=function Tfe(n,t,e){const r=Lp(n,t._root,e?e._root:void 0);return new Fq(r,t)}(this.routeReuseStrategy,c.targetSnapshot,c.currentRouterState);return s={...c,targetRouterState:u}}),v2(c=>{this.currentUrlTree=c.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(c.urlAfterRedirects,c.rawUrl),this.routerState=c.targetRouterState,"deferred"===this.urlUpdateStrategy&&(c.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,c),this.browserUrlTree=c.urlAfterRedirects)}),((n,t,e)=>gn(r=>(new Rfe(t,r.targetRouterState,r.currentRouterState,e).activate(n),r)))(this.rootContexts,this.routeReuseStrategy,c=>this.triggerEvent(c)),v2({next(){i=!0},complete(){i=!0}}),kN(()=>{i||o||this.cancelNavigationTransition(s,"",1),this.currentNavigation?.id===s.id&&(this.currentNavigation=null)}),P0(c=>{if(o=!0,Zq(c)){jq(c)||(this.navigated=!0,this.restoreHistory(s,!0));const u=new Ky(s.id,this.serializeUrl(s.extractedUrl),c.message,c.cancellationCode);if(r.next(u),jq(c)){const h=this.urlHandlingStrategy.merge(c.url,this.rawUrlTree),p={skipLocationChange:s.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||gj(s.source)};this.scheduleNavigation(h,"imperative",null,p,{resolve:s.resolve,reject:s.reject,promise:s.promise})}else s.resolve(!1)}else{this.restoreHistory(s,!0);const u=new zq(s.id,this.serializeUrl(s.extractedUrl),c,s.targetSnapshot??void 0);r.next(u);try{s.resolve(this.errorHandler(c))}catch(h){s.reject(h)}}return uc}))}))}resetRootComponentType(e){this.rootComponentType=e,this.routerState.root.component=this.rootComponentType}setTransition(e){this.transitions.next({...this.transitions.value,...e})}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(e=>{const r="popstate"===e.type?"popstate":"hashchange";"popstate"===r&&setTimeout(()=>{const s={replaceUrl:!0},i=e.state?.navigationId?e.state:null;if(i){const c={...i};delete c.navigationId,delete c.\u0275routerPageId,0!==Object.keys(c).length&&(s.state=c)}const o=this.parseUrl(e.url);this.scheduleNavigation(o,r,i,s)},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(e){this.events.next(e)}resetConfig(e){this.config=e.map(XN),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(e,r={}){const{relativeTo:s,queryParams:i,fragment:o,queryParamsHandling:c,preserveFragment:u}=r,h=s||this.routerState.root,p=u?this.currentUrlTree.fragment:o;let m=null;switch(c){case"merge":m={...this.currentUrlTree.queryParams,...i};break;case"preserve":m=this.currentUrlTree.queryParams;break;default:m=i||null}return null!==m&&(m=this.removeEmptyProps(m)),ife(h,this.currentUrlTree,e,m,p??null)}navigateByUrl(e,r={skipLocationChange:!1}){const s=Ou(e)?e:this.parseUrl(e),i=this.urlHandlingStrategy.merge(s,this.rawUrlTree);return this.scheduleNavigation(i,"imperative",null,r)}navigate(e,r={skipLocationChange:!1}){return function z9e(n){for(let t=0;t<n.length;t++){if(null==n[t])throw new Ae(4008,false)}}(e),this.navigateByUrl(this.createUrlTree(e,r),r)}serializeUrl(e){return this.urlSerializer.serialize(e)}parseUrl(e){let r;try{r=this.urlSerializer.parse(e)}catch(s){r=this.malformedUriErrorHandler(s,this.urlSerializer,e)}return r}isActive(e,r){let s;if(s=!0===r?{...L9e}:!1===r?{...R9e}:r,Ou(e))return Sq(this.currentUrlTree,e,s);const i=this.parseUrl(e);return Sq(this.currentUrlTree,i,s)}removeEmptyProps(e){return Object.keys(e).reduce((r,s)=>{const i=e[s];return null!=i&&(r[s]=i),r},{})}processNavigations(){this.navigations.subscribe(e=>{this.navigated=!0,this.lastSuccessfulId=e.id,this.currentPageId=e.targetPageId,this.events.next(new w0(e.id,this.serializeUrl(e.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,this.titleStrategy?.updateTitle(this.routerState.snapshot),e.resolve(!0)},e=>{this.console.warn(`Unhandled Navigation Error: ${e}`)})}scheduleNavigation(e,r,s,i,o){if(this.disposed)return Promise.resolve(!1);let c,u,h;o?(c=o.resolve,u=o.reject,h=o.promise):h=new Promise((C,w)=>{c=C,u=w});const p=++this.navigationId;let m;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(s=this.location.getState()),m=s&&s.\u0275routerPageId?s.\u0275routerPageId:i.replaceUrl||i.skipLocationChange?this.browserPageId??0:(this.browserPageId??0)+1):m=0,this.setTransition({id:p,targetPageId:m,source:r,restoredState:s,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:e,extras:i,resolve:c,reject:u,promise:h,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),h.catch(C=>Promise.reject(C))}setBrowserUrl(e,r){const s=this.urlSerializer.serialize(e),i={...r.extras.state,...this.generateNgRouterState(r.id,r.targetPageId)};this.location.isCurrentPathEqualTo(s)||r.extras.replaceUrl?this.location.replaceState(s,"",i):this.location.go(s,"",i)}restoreHistory(e,r=!1){if("computed"===this.canceledNavigationResolution){const s=this.currentPageId-e.targetPageId;"popstate"!==e.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==this.currentNavigation?.finalUrl||0===s?this.currentUrlTree===this.currentNavigation?.finalUrl&&0===s&&(this.resetState(e),this.browserUrlTree=e.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(s)}else"replace"===this.canceledNavigationResolution&&(r&&this.resetState(e),this.resetUrlToCurrentUrlTree())}resetState(e){this.routerState=e.currentRouterState,this.currentUrlTree=e.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,e.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}cancelNavigationTransition(e,r,s){const i=new Ky(e.id,this.serializeUrl(e.extractedUrl),r,s);this.triggerEvent(i),e.resolve(!1)}generateNgRouterState(e,r){return"computed"===this.canceledNavigationResolution?{navigationId:e,\u0275routerPageId:r}:{navigationId:e}}}return n.\u0275fac=function(e){H7()},n.\u0275prov=nt({token:n,factory:function(){return pj()},providedIn:"root"}),n})();function gj(n){return"imperative"!==n}let Bp=(()=>{class n{constructor(e,r,s,i,o){this.router=e,this.route=r,this.tabIndexAttribute=s,this.renderer=i,this.el=o,this._preserveFragment=!1,this._skipLocationChange=!1,this._replaceUrl=!1,this.commands=null,this.onChanges=new F2,this.setTabIndexIfNotOnNativeEl("0")}set preserveFragment(e){this._preserveFragment=Nl(e)}get preserveFragment(){return this._preserveFragment}set skipLocationChange(e){this._skipLocationChange=Nl(e)}get skipLocationChange(){return this._skipLocationChange}set replaceUrl(e){this._replaceUrl=Nl(e)}get replaceUrl(){return this._replaceUrl}setTabIndexIfNotOnNativeEl(e){if(null!=this.tabIndexAttribute)return;const r=this.renderer,s=this.el.nativeElement;null!==e?r.setAttribute(s,"tabindex",e):r.removeAttribute(s,"tabindex")}ngOnChanges(e){this.onChanges.next(this)}set routerLink(e){null!=e?(this.commands=Array.isArray(e)?e:[e],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(){return null===this.urlTree||this.router.navigateByUrl(this.urlTree,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state}),!0}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}}return n.\u0275fac=function(e){return new(e||n)(J(Zn),J(bo),V8("tabindex"),J(yo),J(h2))},n.\u0275dir=Ut({type:n,selectors:[["","routerLink","",5,"a",5,"area"]],hostBindings:function(e,r){1&e&&ee("click",function(){return r.onClick()})},inputs:{queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",relativeTo:"relativeTo",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",routerLink:"routerLink"},standalone:!0,features:[r2]}),n})(),Nu=(()=>{class n{constructor(e,r,s){this.router=e,this.route=r,this.locationStrategy=s,this._preserveFragment=!1,this._skipLocationChange=!1,this._replaceUrl=!1,this.commands=null,this.href=null,this.onChanges=new F2,this.subscription=e.events.subscribe(i=>{i instanceof w0&&this.updateTargetUrlAndHref()})}set preserveFragment(e){this._preserveFragment=Nl(e)}get preserveFragment(){return this._preserveFragment}set skipLocationChange(e){this._skipLocationChange=Nl(e)}get skipLocationChange(){return this._skipLocationChange}set replaceUrl(e){this._replaceUrl=Nl(e)}get replaceUrl(){return this._replaceUrl}set routerLink(e){this.commands=null!=e?Array.isArray(e)?e:[e]:null}ngOnChanges(e){this.updateTargetUrlAndHref(),this.onChanges.next(this)}ngOnDestroy(){this.subscription.unsubscribe()}onClick(e,r,s,i,o){return!!(0!==e||r||s||i||o||"string"==typeof this.target&&"_self"!=this.target||null===this.urlTree)||(this.router.navigateByUrl(this.urlTree,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state}),!1)}updateTargetUrlAndHref(){this.href=null!==this.urlTree?this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}}return n.\u0275fac=function(e){return new(e||n)(J(Zn),J(bo),J(Cu))},n.\u0275dir=Ut({type:n,selectors:[["a","routerLink",""],["area","routerLink",""]],hostVars:2,hostBindings:function(e,r){1&e&&ee("click",function(i){return r.onClick(i.button,i.ctrlKey,i.shiftKey,i.altKey,i.metaKey)}),2&e&&D("target",r.target)("href",r.href,p3)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",relativeTo:"relativeTo",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",routerLink:"routerLink"},standalone:!0,features:[r2]}),n})();class mj{}let F9e=(()=>{class n{constructor(e,r,s,i,o){this.router=e,this.injector=s,this.preloadingStrategy=i,this.loader=o}setUpPreloading(){this.subscription=this.router.events.pipe(kl(e=>e instanceof w0),E0(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(e,r){const s=[];for(const i of r){i.providers&&!i._injector&&(i._injector=ty(i.providers,e,`Route: ${i.path}`));const o=i._injector??e,c=i._loadedInjector??o;i.loadChildren&&!i._loadedRoutes&&void 0===i.canLoad||i.loadComponent&&!i._loadedComponent?s.push(this.preloadConfig(o,i)):(i.children||i._loadedRoutes)&&s.push(this.processRoutes(c,i.children??i._loadedRoutes))}return ls(s).pipe(el())}preloadConfig(e,r){return this.preloadingStrategy.preload(r,()=>{let s;s=r.loadChildren&&void 0===r.canLoad?this.loader.loadChildren(e,r):Zt(null);const i=s.pipe(ze(o=>null===o?Zt(void 0):(r._loadedRoutes=o.routes,r._loadedInjector=o.injector,this.processRoutes(o.injector??e,o.routes))));return r.loadComponent&&!r._loadedComponent?ls([i,this.loader.loadComponent(r)]).pipe(el()):i})}}return n.\u0275fac=function(e){return new(e||n)(De(Zn),De(SO),De(Aa),De(mj),De(rA))},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const sA=new kt("");let _j=(()=>{class n{constructor(e,r,s={}){this.router=e,this.viewportScroller=r,this.options=s,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},s.scrollPositionRestoration=s.scrollPositionRestoration||"disabled",s.anchorScrolling=s.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(e=>{e instanceof BN?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=e.navigationTrigger,this.restoredId=e.restoredState?e.restoredState.navigationId:0):e instanceof w0&&(this.lastId=e.id,this.scheduleScrollEvent(e,this.router.parseUrl(e.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(e=>{e instanceof Vq&&(e.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(e.position):e.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(e.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(e,r){this.router.triggerEvent(new Vq(e,"popstate"===this.lastSource?this.store[this.restoredId]:null,r))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return n.\u0275fac=function(e){H7()},n.\u0275prov=nt({token:n,factory:n.\u0275fac}),n})();function vf(n,t){return{\u0275kind:n,\u0275providers:t}}function iA(n){return[{provide:nA,multi:!0,useValue:n}]}function Cj(){const n=zr(fi);return t=>{const e=n.get(lp);if(t!==e.components[0])return;const r=n.get(Zn),s=n.get(yj);1===n.get(oA)&&r.initialNavigation(),n.get(Ej,null,jt.Optional)?.setUpPreloading(),n.get(sA,null,jt.Optional)?.init(),r.resetRootComponentType(e.componentTypes[0]),s.next(),s.complete()}}const yj=new kt("",{factory:()=>new F2}),oA=new kt("",{providedIn:"root",factory:()=>1});const Ej=new kt("");function G9e(n){return vf(0,[{provide:Ej,useExisting:F9e},{provide:mj,useExisting:n}])}const Mj=new kt("ROUTER_FORROOT_GUARD"),W9e=[VO,{provide:bq,useClass:RN},{provide:Zn,useFactory:pj},Rp,{provide:bo,useFactory:function vj(n){return n.routerState.root},deps:[Zn]},rA];function q9e(){return new xU("Router",Zn)}let j9e=(()=>{class n{constructor(e){}static forRoot(e,r){return{ngModule:n,providers:[W9e,[],iA(e),{provide:Mj,useFactory:X9e,deps:[[Zn,new ui,new W8]]},{provide:oE,useValue:r||{}},r?.useHash?{provide:Cu,useClass:Q0e}:{provide:Cu,useClass:rG},{provide:sA,useFactory:()=>{const n=zr(Zn),t=zr(mue),e=zr(oE);return e.scrollOffset&&t.setOffset(e.scrollOffset),new _j(n,t,e)}},r?.preloadingStrategy?G9e(r.preloadingStrategy).\u0275providers:[],{provide:xU,multi:!0,useFactory:q9e},r?.initialNavigation?Q9e(r):[],[{provide:Sj,useFactory:Cj},{provide:PU,multi:!0,useExisting:Sj}]]}}static forChild(e){return{ngModule:n,providers:[iA(e)]}}}return n.\u0275fac=function(e){return new(e||n)(De(Mj,8))},n.\u0275mod=oi({type:n}),n.\u0275inj=jr({imports:[YN]}),n})();function X9e(n){return"guarded"}function Q9e(n){return["disabled"===n.initialNavigation?vf(3,[{provide:iy,multi:!0,useFactory:()=>{const t=zr(Zn);return()=>{t.setUpLocationChangeListener()}}},{provide:oA,useValue:2}]).\u0275providers:[],"enabledBlocking"===n.initialNavigation?vf(2,[{provide:oA,useValue:0},{provide:iy,multi:!0,deps:[fi],useFactory:t=>{const e=t.get(K0e,Promise.resolve());let r=!1;return()=>e.then(()=>new Promise(i=>{const o=t.get(Zn),c=t.get(yj);(function s(i){t.get(Zn).events.pipe(kl(c=>c instanceof w0||c instanceof Ky||c instanceof zq),gn(c=>c instanceof w0||c instanceof Ky&&(0===c.code||1===c.code)&&null),kl(c=>null!==c),bp(1)).subscribe(()=>{i()})})(()=>{i(!0),r=!0}),o.afterPreactivation=()=>(i(!0),r||c.closed?Zt(void 0):c),o.initialNavigation()}))}}]).\u0275providers:[]]}const Sj=new kt("");class Pj{}const zl="*";function Tj(n,t=null){return{type:2,steps:n,options:t}}function wj(n){return{type:6,styles:n,offset:null}}function bj(n){Promise.resolve().then(n)}class $p{constructor(t=0,e=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=t+e}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}onStart(t){this._originalOnStartFns.push(t),this._onStartFns.push(t)}onDone(t){this._originalOnDoneFns.push(t),this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){bj(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(t=>t()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(t){this._position=this.totalTime?t*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(r=>r()),e.length=0}}class Oj{constructor(t){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=t;let e=0,r=0,s=0;const i=this.players.length;0==i?bj(()=>this._onFinish()):this.players.forEach(o=>{o.onDone(()=>{++e==i&&this._onFinish()}),o.onDestroy(()=>{++r==i&&this._onDestroy()}),o.onStart(()=>{++s==i&&this._onStart()})}),this.totalTime=this.players.reduce((o,c)=>Math.max(o,c.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this.players.forEach(t=>t.init())}onStart(t){this._onStartFns.push(t)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(t=>t()),this._onStartFns=[])}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(t=>t.play())}pause(){this.players.forEach(t=>t.pause())}restart(){this.players.forEach(t=>t.restart())}finish(){this._onFinish(),this.players.forEach(t=>t.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(t=>t.destroy()),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this.players.forEach(t=>t.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(t){const e=t*this.totalTime;this.players.forEach(r=>{const s=r.totalTime?Math.min(1,e/r.totalTime):1;r.setPosition(s)})}getPosition(){const t=this.players.reduce((e,r)=>null===e||r.totalTime>e.totalTime?r:e,null);return null!=t?t.getPosition():0}beforeDestroy(){this.players.forEach(t=>{t.beforeDestroy&&t.beforeDestroy()})}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(r=>r()),e.length=0}}function Nj(n){return new Ae(3e3,!1)}function Rhe(){return typeof window<"u"&&typeof window.document<"u"}function cA(){return typeof process<"u"&&"[object process]"==={}.toString.call(process)}function b0(n){switch(n.length){case 0:return new $p;case 1:return n[0];default:return new Oj(n)}}function Aj(n,t,e,r,s=new Map,i=new Map){const o=[],c=[];let u=-1,h=null;if(r.forEach(p=>{const m=p.get("offset"),C=m==u,w=C&&h||new Map;p.forEach((I,H)=>{let K=H,ie=I;if("offset"!==H)switch(K=t.normalizePropertyName(K,o),ie){case"!":ie=s.get(H);break;case zl:ie=i.get(H);break;default:ie=t.normalizeStyleValue(H,K,ie,o)}w.set(K,ie)}),C||c.push(w),h=w,u=m}),o.length)throw function She(n){return new Ae(3502,!1)}();return c}function lA(n,t,e,r){switch(t){case"start":n.onStart(()=>r(e&&uA(e,"start",n)));break;case"done":n.onDone(()=>r(e&&uA(e,"done",n)));break;case"destroy":n.onDestroy(()=>r(e&&uA(e,"destroy",n)))}}function uA(n,t,e){const i=fA(n.element,n.triggerName,n.fromState,n.toState,t||n.phaseName,e.totalTime??n.totalTime,!!e.disabled),o=n._data;return null!=o&&(i._data=o),i}function fA(n,t,e,r,s="",i=0,o){return{element:n,triggerName:t,fromState:e,toState:r,phaseName:s,totalTime:i,disabled:!!o}}function Ha(n,t,e){let r=n.get(t);return r||n.set(t,r=e),r}function Ij(n){const t=n.indexOf(":");return[n.substring(1,t),n.slice(t+1)]}let hA=(n,t)=>!1,xj=(n,t,e)=>[],kj=null;function dA(n){const t=n.parentNode||n.host;return t===kj?null:t}(cA()||typeof Element<"u")&&(Rhe()?(kj=(()=>document.documentElement)(),hA=(n,t)=>{for(;t;){if(t===n)return!0;t=dA(t)}return!1}):hA=(n,t)=>n.contains(t),xj=(n,t,e)=>{if(e)return Array.from(n.querySelectorAll(t));const r=n.querySelector(t);return r?[r]:[]});let Au=null,Lj=!1;const Rj=hA,Dj=xj;let zj=(()=>{class n{validateStyleProperty(e){return function zhe(n){Au||(Au=function Vhe(){return typeof document<"u"?document.body:null}()||{},Lj=!!Au.style&&"WebkitAppearance"in Au.style);let t=!0;return Au.style&&!function Dhe(n){return"ebkit"==n.substring(1,6)}(n)&&(t=n in Au.style,!t&&Lj&&(t="Webkit"+n.charAt(0).toUpperCase()+n.slice(1)in Au.style)),t}(e)}matchesElement(e,r){return!1}containsElement(e,r){return Rj(e,r)}getParentElement(e){return dA(e)}query(e,r,s){return Dj(e,r,s)}computeStyle(e,r,s){return s||""}animate(e,r,s,i,o,c=[],u){return new $p(s,i)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=nt({token:n,factory:n.\u0275fac}),n})(),pA=(()=>{class n{}return n.NOOP=new zj,n})();const gA="ng-enter",uE="ng-leave",fE="ng-trigger",hE=".ng-trigger",Hj="ng-animating",mA=".ng-animating";function Vl(n){if("number"==typeof n)return n;const t=n.match(/^(-?[\.\d]+)(m?s)/);return!t||t.length<2?0:_A(parseFloat(t[1]),t[2])}function _A(n,t){return"s"===t?1e3*n:n}function dE(n,t,e){return n.hasOwnProperty("duration")?n:function Bhe(n,t,e){let s,i=0,o="";if("string"==typeof n){const c=n.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===c)return t.push(Nj()),{duration:0,delay:0,easing:""};s=_A(parseFloat(c[1]),c[2]);const u=c[3];null!=u&&(i=_A(parseFloat(u),c[4]));const h=c[5];h&&(o=h)}else s=n;if(!e){let c=!1,u=t.length;s<0&&(t.push(function the(){return new Ae(3100,!1)}()),c=!0),i<0&&(t.push(function nhe(){return new Ae(3101,!1)}()),c=!0),c&&t.splice(u,0,Nj())}return{duration:s,delay:i,easing:o}}(n,t,e)}function Up(n,t={}){return Object.keys(n).forEach(e=>{t[e]=n[e]}),t}function Fj(n){const t=new Map;return Object.keys(n).forEach(e=>{t.set(e,n[e])}),t}function O0(n,t=new Map,e){if(e)for(let[r,s]of e)t.set(r,s);for(let[r,s]of n)t.set(r,s);return t}function $j(n,t,e){return e?t+":"+e+";":""}function Uj(n){let t="";for(let e=0;e<n.style.length;e++){const r=n.style.item(e);t+=$j(0,r,n.style.getPropertyValue(r))}for(const e in n.style)n.style.hasOwnProperty(e)&&!e.startsWith("_")&&(t+=$j(0,Whe(e),n.style[e]));n.setAttribute("style",t)}function T4(n,t,e){n.style&&(t.forEach((r,s)=>{const i=CA(s);e&&!e.has(s)&&e.set(s,n.style[i]),n.style[i]=r}),cA()&&Uj(n))}function Iu(n,t){n.style&&(t.forEach((e,r)=>{const s=CA(r);n.style[s]=""}),cA()&&Uj(n))}function Gp(n){return Array.isArray(n)?1==n.length?n[0]:Tj(n):n}const vA=new RegExp("{{\\s*(.+?)\\s*}}","g");function Gj(n){let t=[];if("string"==typeof n){let e;for(;e=vA.exec(n);)t.push(e[1]);vA.lastIndex=0}return t}function Wp(n,t,e){const r=n.toString(),s=r.replace(vA,(i,o)=>{let c=t[o];return null==c&&(e.push(function she(n){return new Ae(3003,!1)}()),c=""),c.toString()});return s==r?n:s}function pE(n){const t=[];let e=n.next();for(;!e.done;)t.push(e.value),e=n.next();return t}const Ghe=/-+([a-z0-9])/g;function CA(n){return n.replace(Ghe,(...t)=>t[1].toUpperCase())}function Whe(n){return n.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function Fa(n,t,e){switch(t.type){case 7:return n.visitTrigger(t,e);case 0:return n.visitState(t,e);case 1:return n.visitTransition(t,e);case 2:return n.visitSequence(t,e);case 3:return n.visitGroup(t,e);case 4:return n.visitAnimate(t,e);case 5:return n.visitKeyframes(t,e);case 6:return n.visitStyle(t,e);case 8:return n.visitReference(t,e);case 9:return n.visitAnimateChild(t,e);case 10:return n.visitAnimateRef(t,e);case 11:return n.visitQuery(t,e);case 12:return n.visitStagger(t,e);default:throw function ihe(n){return new Ae(3004,!1)}()}}function Wj(n,t){return window.getComputedStyle(n)[t]}function Xhe(n,t){const e=[];return"string"==typeof n?n.split(/\s*,\s*/).forEach(r=>function Qhe(n,t,e){if(":"==n[0]){const u=function Jhe(n,t){switch(n){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(e,r)=>parseFloat(r)>parseFloat(e);case":decrement":return(e,r)=>parseFloat(r)<parseFloat(e);default:return t.push(function Che(n){return new Ae(3016,!1)}()),"* => *"}}(n,e);if("function"==typeof u)return void t.push(u);n=u}const r=n.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==r||r.length<4)return e.push(function vhe(n){return new Ae(3015,!1)}()),t;const s=r[1],i=r[2],o=r[3];t.push(qj(s,o));"<"==i[0]&&!("*"==s&&"*"==o)&&t.push(qj(o,s))}(r,e,t)):e.push(n),e}const vE=new Set(["true","1"]),CE=new Set(["false","0"]);function qj(n,t){const e=vE.has(n)||CE.has(n),r=vE.has(t)||CE.has(t);return(s,i)=>{let o="*"==n||n==s,c="*"==t||t==i;return!o&&e&&"boolean"==typeof s&&(o=s?vE.has(n):CE.has(n)),!c&&r&&"boolean"==typeof i&&(c=i?vE.has(t):CE.has(t)),o&&c}}const ede=new RegExp("s*:selfs*,?","g");function yA(n,t,e,r){return new tde(n).build(t,e,r)}class tde{constructor(t){this._driver=t}build(t,e,r){const s=new sde(e);return this._resetContextStyleTimingState(s),Fa(this,Gp(t),s)}_resetContextStyleTimingState(t){t.currentQuerySelector="",t.collectedStyles=new Map,t.collectedStyles.set("",new Map),t.currentTime=0}visitTrigger(t,e){let r=e.queryCount=0,s=e.depCount=0;const i=[],o=[];return"@"==t.name.charAt(0)&&e.errors.push(function ahe(){return new Ae(3006,!1)}()),t.definitions.forEach(c=>{if(this._resetContextStyleTimingState(e),0==c.type){const u=c,h=u.name;h.toString().split(/\s*,\s*/).forEach(p=>{u.name=p,i.push(this.visitState(u,e))}),u.name=h}else if(1==c.type){const u=this.visitTransition(c,e);r+=u.queryCount,s+=u.depCount,o.push(u)}else e.errors.push(function che(){return new Ae(3007,!1)}())}),{type:7,name:t.name,states:i,transitions:o,queryCount:r,depCount:s,options:null}}visitState(t,e){const r=this.visitStyle(t.styles,e),s=t.options&&t.options.params||null;if(r.containsDynamicStyles){const i=new Set,o=s||{};r.styles.forEach(c=>{c instanceof Map&&c.forEach(u=>{Gj(u).forEach(h=>{o.hasOwnProperty(h)||i.add(h)})})}),i.size&&(pE(i.values()),e.errors.push(function lhe(n,t){return new Ae(3008,!1)}()))}return{type:0,name:t.name,style:r,options:s?{params:s}:null}}visitTransition(t,e){e.queryCount=0,e.depCount=0;const r=Fa(this,Gp(t.animation),e);return{type:1,matchers:Xhe(t.expr,e.errors),animation:r,queryCount:e.queryCount,depCount:e.depCount,options:xu(t.options)}}visitSequence(t,e){return{type:2,steps:t.steps.map(r=>Fa(this,r,e)),options:xu(t.options)}}visitGroup(t,e){const r=e.currentTime;let s=0;const i=t.steps.map(o=>{e.currentTime=r;const c=Fa(this,o,e);return s=Math.max(s,e.currentTime),c});return e.currentTime=s,{type:3,steps:i,options:xu(t.options)}}visitAnimate(t,e){const r=function ode(n,t){if(n.hasOwnProperty("duration"))return n;if("number"==typeof n)return EA(dE(n,t).duration,0,"");const e=n;if(e.split(/\s+/).some(i=>"{"==i.charAt(0)&&"{"==i.charAt(1))){const i=EA(0,0,"");return i.dynamic=!0,i.strValue=e,i}const s=dE(e,t);return EA(s.duration,s.delay,s.easing)}(t.timings,e.errors);e.currentAnimateTimings=r;let s,i=t.styles?t.styles:wj({});if(5==i.type)s=this.visitKeyframes(i,e);else{let o=t.styles,c=!1;if(!o){c=!0;const h={};r.easing&&(h.easing=r.easing),o=wj(h)}e.currentTime+=r.duration+r.delay;const u=this.visitStyle(o,e);u.isEmptyStep=c,s=u}return e.currentAnimateTimings=null,{type:4,timings:r,style:s,options:null}}visitStyle(t,e){const r=this._makeStyleAst(t,e);return this._validateStyleAst(r,e),r}_makeStyleAst(t,e){const r=[],s=Array.isArray(t.styles)?t.styles:[t.styles];for(let c of s)"string"==typeof c?c===zl?r.push(c):e.errors.push(new Ae(3002,!1)):r.push(Fj(c));let i=!1,o=null;return r.forEach(c=>{if(c instanceof Map&&(c.has("easing")&&(o=c.get("easing"),c.delete("easing")),!i))for(let u of c.values())if(u.toString().indexOf("{{")>=0){i=!0;break}}),{type:6,styles:r,easing:o,offset:t.offset,containsDynamicStyles:i,options:null}}_validateStyleAst(t,e){const r=e.currentAnimateTimings;let s=e.currentTime,i=e.currentTime;r&&i>0&&(i-=r.duration+r.delay),t.styles.forEach(o=>{"string"!=typeof o&&o.forEach((c,u)=>{const h=e.collectedStyles.get(e.currentQuerySelector),p=h.get(u);let m=!0;p&&(i!=s&&i>=p.startTime&&s<=p.endTime&&(e.errors.push(function fhe(n,t,e,r,s){return new Ae(3010,!1)}()),m=!1),i=p.startTime),m&&h.set(u,{startTime:i,endTime:s}),e.options&&function Uhe(n,t,e){const r=t.params||{},s=Gj(n);s.length&&s.forEach(i=>{r.hasOwnProperty(i)||e.push(function rhe(n){return new Ae(3001,!1)}())})}(c,e.options,e.errors)})})}visitKeyframes(t,e){const r={type:5,styles:[],options:null};if(!e.currentAnimateTimings)return e.errors.push(function hhe(){return new Ae(3011,!1)}()),r;let i=0;const o=[];let c=!1,u=!1,h=0;const p=t.steps.map(ie=>{const ye=this._makeStyleAst(ie,e);let te=null!=ye.offset?ye.offset:function ide(n){if("string"==typeof n)return null;let t=null;if(Array.isArray(n))n.forEach(e=>{if(e instanceof Map&&e.has("offset")){const r=e;t=parseFloat(r.get("offset")),r.delete("offset")}});else if(n instanceof Map&&n.has("offset")){const e=n;t=parseFloat(e.get("offset")),e.delete("offset")}return t}(ye.styles),ke=0;return null!=te&&(i++,ke=ye.offset=te),u=u||ke<0||ke>1,c=c||ke<h,h=ke,o.push(ke),ye});u&&e.errors.push(function dhe(){return new Ae(3012,!1)}()),c&&e.errors.push(function phe(){return new Ae(3200,!1)}());const m=t.steps.length;let C=0;i>0&&i<m?e.errors.push(function ghe(){return new Ae(3202,!1)}()):0==i&&(C=1/(m-1));const w=m-1,I=e.currentTime,H=e.currentAnimateTimings,K=H.duration;return p.forEach((ie,ye)=>{const te=C>0?ye==w?1:C*ye:o[ye],ke=te*K;e.currentTime=I+H.delay+ke,H.duration=ke,this._validateStyleAst(ie,e),ie.offset=te,r.styles.push(ie)}),r}visitReference(t,e){return{type:8,animation:Fa(this,Gp(t.animation),e),options:xu(t.options)}}visitAnimateChild(t,e){return e.depCount++,{type:9,options:xu(t.options)}}visitAnimateRef(t,e){return{type:10,animation:this.visitReference(t.animation,e),options:xu(t.options)}}visitQuery(t,e){const r=e.currentQuerySelector,s=t.options||{};e.queryCount++,e.currentQuery=t;const[i,o]=function nde(n){const t=!!n.split(/\s*,\s*/).find(e=>":self"==e);return t&&(n=n.replace(ede,"")),n=n.replace(/@\*/g,hE).replace(/@\w+/g,e=>hE+"-"+e.slice(1)).replace(/:animating/g,mA),[n,t]}(t.selector);e.currentQuerySelector=r.length?r+" "+i:i,Ha(e.collectedStyles,e.currentQuerySelector,new Map);const c=Fa(this,Gp(t.animation),e);return e.currentQuery=null,e.currentQuerySelector=r,{type:11,selector:i,limit:s.limit||0,optional:!!s.optional,includeSelf:o,animation:c,originalSelector:t.selector,options:xu(t.options)}}visitStagger(t,e){e.currentQuery||e.errors.push(function mhe(){return new Ae(3013,!1)}());const r="full"===t.timings?{duration:0,delay:0,easing:"full"}:dE(t.timings,e.errors,!0);return{type:12,animation:Fa(this,Gp(t.animation),e),timings:r,options:null}}}class sde{constructor(t){this.errors=t,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function xu(n){return n?(n=Up(n)).params&&(n.params=function rde(n){return n?Up(n):null}(n.params)):n={},n}function EA(n,t,e){return{duration:n,delay:t,easing:e}}function MA(n,t,e,r,s,i,o=null,c=!1){return{type:1,element:n,keyframes:t,preStyleProps:e,postStyleProps:r,duration:s,delay:i,totalTime:s+i,easing:o,subTimeline:c}}class yE{constructor(){this._map=new Map}get(t){return this._map.get(t)||[]}append(t,e){let r=this._map.get(t);r||this._map.set(t,r=[]),r.push(...e)}has(t){return this._map.has(t)}clear(){this._map.clear()}}const lde=new RegExp(":enter","g"),fde=new RegExp(":leave","g");function SA(n,t,e,r,s,i=new Map,o=new Map,c,u,h=[]){return(new hde).buildKeyframes(n,t,e,r,s,i,o,c,u,h)}class hde{buildKeyframes(t,e,r,s,i,o,c,u,h,p=[]){h=h||new yE;const m=new PA(t,e,h,s,i,p,[]);m.options=u;const C=u.delay?Vl(u.delay):0;m.currentTimeline.delayNextStep(C),m.currentTimeline.setStyles([o],null,m.errors,u),Fa(this,r,m);const w=m.timelines.filter(I=>I.containsAnimation());if(w.length&&c.size){let I;for(let H=w.length-1;H>=0;H--){const K=w[H];if(K.element===e){I=K;break}}I&&!I.allowOnlyTimelineStyles()&&I.setStyles([c],null,m.errors,u)}return w.length?w.map(I=>I.buildKeyframes()):[MA(e,[],[],[],0,C,"",!1)]}visitTrigger(t,e){}visitState(t,e){}visitTransition(t,e){}visitAnimateChild(t,e){const r=e.subInstructions.get(e.element);if(r){const s=e.createSubContext(t.options),i=e.currentTimeline.currentTime,o=this._visitSubInstructions(r,s,s.options);i!=o&&e.transformIntoNewTimeline(o)}e.previousNode=t}visitAnimateRef(t,e){const r=e.createSubContext(t.options);r.transformIntoNewTimeline(),this._applyAnimationRefDelays([t.options,t.animation.options],e,r),this.visitReference(t.animation,r),e.transformIntoNewTimeline(r.currentTimeline.currentTime),e.previousNode=t}_applyAnimationRefDelays(t,e,r){for(const s of t){const i=s?.delay;if(i){const o="number"==typeof i?i:Vl(Wp(i,s?.params??{},e.errors));r.delayNextStep(o)}}}_visitSubInstructions(t,e,r){let i=e.currentTimeline.currentTime;const o=null!=r.duration?Vl(r.duration):null,c=null!=r.delay?Vl(r.delay):null;return 0!==o&&t.forEach(u=>{const h=e.appendInstructionToTimeline(u,o,c);i=Math.max(i,h.duration+h.delay)}),i}visitReference(t,e){e.updateOptions(t.options,!0),Fa(this,t.animation,e),e.previousNode=t}visitSequence(t,e){const r=e.subContextCount;let s=e;const i=t.options;if(i&&(i.params||i.delay)&&(s=e.createSubContext(i),s.transformIntoNewTimeline(),null!=i.delay)){6==s.previousNode.type&&(s.currentTimeline.snapshotCurrentStyles(),s.previousNode=EE);const o=Vl(i.delay);s.delayNextStep(o)}t.steps.length&&(t.steps.forEach(o=>Fa(this,o,s)),s.currentTimeline.applyStylesToKeyframe(),s.subContextCount>r&&s.transformIntoNewTimeline()),e.previousNode=t}visitGroup(t,e){const r=[];let s=e.currentTimeline.currentTime;const i=t.options&&t.options.delay?Vl(t.options.delay):0;t.steps.forEach(o=>{const c=e.createSubContext(t.options);i&&c.delayNextStep(i),Fa(this,o,c),s=Math.max(s,c.currentTimeline.currentTime),r.push(c.currentTimeline)}),r.forEach(o=>e.currentTimeline.mergeTimelineCollectedStyles(o)),e.transformIntoNewTimeline(s),e.previousNode=t}_visitTiming(t,e){if(t.dynamic){const r=t.strValue;return dE(e.params?Wp(r,e.params,e.errors):r,e.errors)}return{duration:t.duration,delay:t.delay,easing:t.easing}}visitAnimate(t,e){const r=e.currentAnimateTimings=this._visitTiming(t.timings,e),s=e.currentTimeline;r.delay&&(e.incrementTime(r.delay),s.snapshotCurrentStyles());const i=t.style;5==i.type?this.visitKeyframes(i,e):(e.incrementTime(r.duration),this.visitStyle(i,e),s.applyStylesToKeyframe()),e.currentAnimateTimings=null,e.previousNode=t}visitStyle(t,e){const r=e.currentTimeline,s=e.currentAnimateTimings;!s&&r.hasCurrentStyleProperties()&&r.forwardFrame();const i=s&&s.easing||t.easing;t.isEmptyStep?r.applyEmptyStep(i):r.setStyles(t.styles,i,e.errors,e.options),e.previousNode=t}visitKeyframes(t,e){const r=e.currentAnimateTimings,s=e.currentTimeline.duration,i=r.duration,c=e.createSubContext().currentTimeline;c.easing=r.easing,t.styles.forEach(u=>{c.forwardTime((u.offset||0)*i),c.setStyles(u.styles,u.easing,e.errors,e.options),c.applyStylesToKeyframe()}),e.currentTimeline.mergeTimelineCollectedStyles(c),e.transformIntoNewTimeline(s+i),e.previousNode=t}visitQuery(t,e){const r=e.currentTimeline.currentTime,s=t.options||{},i=s.delay?Vl(s.delay):0;i&&(6===e.previousNode.type||0==r&&e.currentTimeline.hasCurrentStyleProperties())&&(e.currentTimeline.snapshotCurrentStyles(),e.previousNode=EE);let o=r;const c=e.invokeQuery(t.selector,t.originalSelector,t.limit,t.includeSelf,!!s.optional,e.errors);e.currentQueryTotal=c.length;let u=null;c.forEach((h,p)=>{e.currentQueryIndex=p;const m=e.createSubContext(t.options,h);i&&m.delayNextStep(i),h===e.element&&(u=m.currentTimeline),Fa(this,t.animation,m),m.currentTimeline.applyStylesToKeyframe(),o=Math.max(o,m.currentTimeline.currentTime)}),e.currentQueryIndex=0,e.currentQueryTotal=0,e.transformIntoNewTimeline(o),u&&(e.currentTimeline.mergeTimelineCollectedStyles(u),e.currentTimeline.snapshotCurrentStyles()),e.previousNode=t}visitStagger(t,e){const r=e.parentContext,s=e.currentTimeline,i=t.timings,o=Math.abs(i.duration),c=o*(e.currentQueryTotal-1);let u=o*e.currentQueryIndex;switch(i.duration<0?"reverse":i.easing){case"reverse":u=c-u;break;case"full":u=r.currentStaggerTime}const p=e.currentTimeline;u&&p.delayNextStep(u);const m=p.currentTime;Fa(this,t.animation,e),e.previousNode=t,r.currentStaggerTime=s.currentTime-m+(s.startTime-r.currentTimeline.startTime)}}const EE={};class PA{constructor(t,e,r,s,i,o,c,u){this._driver=t,this.element=e,this.subInstructions=r,this._enterClassName=s,this._leaveClassName=i,this.errors=o,this.timelines=c,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=EE,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=u||new ME(this._driver,e,0),c.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(t,e){if(!t)return;const r=t;let s=this.options;null!=r.duration&&(s.duration=Vl(r.duration)),null!=r.delay&&(s.delay=Vl(r.delay));const i=r.params;if(i){let o=s.params;o||(o=this.options.params={}),Object.keys(i).forEach(c=>{(!e||!o.hasOwnProperty(c))&&(o[c]=Wp(i[c],o,this.errors))})}}_copyOptions(){const t={};if(this.options){const e=this.options.params;if(e){const r=t.params={};Object.keys(e).forEach(s=>{r[s]=e[s]})}}return t}createSubContext(t=null,e,r){const s=e||this.element,i=new PA(this._driver,s,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(s,r||0));return i.previousNode=this.previousNode,i.currentAnimateTimings=this.currentAnimateTimings,i.options=this._copyOptions(),i.updateOptions(t),i.currentQueryIndex=this.currentQueryIndex,i.currentQueryTotal=this.currentQueryTotal,i.parentContext=this,this.subContextCount++,i}transformIntoNewTimeline(t){return this.previousNode=EE,this.currentTimeline=this.currentTimeline.fork(this.element,t),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(t,e,r){const s={duration:e??t.duration,delay:this.currentTimeline.currentTime+(r??0)+t.delay,easing:""},i=new dde(this._driver,t.element,t.keyframes,t.preStyleProps,t.postStyleProps,s,t.stretchStartingKeyframe);return this.timelines.push(i),s}incrementTime(t){this.currentTimeline.forwardTime(this.currentTimeline.duration+t)}delayNextStep(t){t>0&&this.currentTimeline.delayNextStep(t)}invokeQuery(t,e,r,s,i,o){let c=[];if(s&&c.push(this.element),t.length>0){t=(t=t.replace(lde,"."+this._enterClassName)).replace(fde,"."+this._leaveClassName);let h=this._driver.query(this.element,t,1!=r);0!==r&&(h=r<0?h.slice(h.length+r,h.length):h.slice(0,r)),c.push(...h)}return!i&&0==c.length&&o.push(function _he(n){return new Ae(3014,!1)}()),c}}class ME{constructor(t,e,r,s){this._driver=t,this.element=e,this.startTime=r,this._elementTimelineStylesLookup=s,this.duration=0,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(e),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(e,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(t){const e=1===this._keyframes.size&&this._pendingStyles.size;this.duration||e?(this.forwardTime(this.currentTime+t),e&&this.snapshotCurrentStyles()):this.startTime+=t}fork(t,e){return this.applyStylesToKeyframe(),new ME(this._driver,t,e||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(t){this.applyStylesToKeyframe(),this.duration=t,this._loadKeyframe()}_updateStyle(t,e){this._localTimelineStyles.set(t,e),this._globalTimelineStyles.set(t,e),this._styleSummary.set(t,{time:this.currentTime,value:e})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(t){t&&this._previousKeyframe.set("easing",t);for(let[e,r]of this._globalTimelineStyles)this._backFill.set(e,r||zl),this._currentKeyframe.set(e,zl);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(t,e,r,s){e&&this._previousKeyframe.set("easing",e);const i=s&&s.params||{},o=function pde(n,t){const e=new Map;let r;return n.forEach(s=>{if("*"===s){r=r||t.keys();for(let i of r)e.set(i,zl)}else O0(s,e)}),e}(t,this._globalTimelineStyles);for(let[c,u]of o){const h=Wp(u,i,r);this._pendingStyles.set(c,h),this._localTimelineStyles.has(c)||this._backFill.set(c,this._globalTimelineStyles.get(c)??zl),this._updateStyle(c,h)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((t,e)=>{this._currentKeyframe.set(e,t)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((t,e)=>{this._currentKeyframe.has(e)||this._currentKeyframe.set(e,t)}))}snapshotCurrentStyles(){for(let[t,e]of this._localTimelineStyles)this._pendingStyles.set(t,e),this._updateStyle(t,e)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const t=[];for(let e in this._currentKeyframe)t.push(e);return t}mergeTimelineCollectedStyles(t){t._styleSummary.forEach((e,r)=>{const s=this._styleSummary.get(r);(!s||e.time>s.time)&&this._updateStyle(r,e.value)})}buildKeyframes(){this.applyStylesToKeyframe();const t=new Set,e=new Set,r=1===this._keyframes.size&&0===this.duration;let s=[];this._keyframes.forEach((c,u)=>{const h=O0(c,new Map,this._backFill);h.forEach((p,m)=>{"!"===p?t.add(m):p===zl&&e.add(m)}),r||h.set("offset",u/this.duration),s.push(h)});const i=t.size?pE(t.values()):[],o=e.size?pE(e.values()):[];if(r){const c=s[0],u=new Map(c);c.set("offset",0),u.set("offset",1),s=[c,u]}return MA(this.element,s,i,o,this.duration,this.startTime,this.easing,!1)}}class dde extends ME{constructor(t,e,r,s,i,o,c=!1){super(t,e,o.delay),this.keyframes=r,this.preStyleProps=s,this.postStyleProps=i,this._stretchStartingKeyframe=c,this.timings={duration:o.duration,delay:o.delay,easing:o.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let t=this.keyframes,{delay:e,duration:r,easing:s}=this.timings;if(this._stretchStartingKeyframe&&e){const i=[],o=r+e,c=e/o,u=O0(t[0]);u.set("offset",0),i.push(u);const h=O0(t[0]);h.set("offset",Yj(c)),i.push(h);const p=t.length-1;for(let m=1;m<=p;m++){let C=O0(t[m]);const w=C.get("offset");C.set("offset",Yj((e+w*r)/o)),i.push(C)}r=o,e=0,s="",t=i}return MA(this.element,t,this.preStyleProps,this.postStyleProps,r,e,s,!0)}}function Yj(n,t=3){const e=Math.pow(10,t-1);return Math.round(n*e)/e}class TA{}const gde=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class mde extends TA{normalizePropertyName(t,e){return CA(t)}normalizeStyleValue(t,e,r,s){let i="";const o=r.toString().trim();if(gde.has(e)&&0!==r&&"0"!==r)if("number"==typeof r)i="px";else{const c=r.match(/^[+-]?[\d\.]+([a-z]*)$/);c&&0==c[1].length&&s.push(function ohe(n,t){return new Ae(3005,!1)}())}return o+i}}function Kj(n,t,e,r,s,i,o,c,u,h,p,m,C){return{type:0,element:n,triggerName:t,isRemovalTransition:s,fromState:e,fromStyles:i,toState:r,toStyles:o,timelines:c,queriedElements:u,preStyleProps:h,postStyleProps:p,totalTime:m,errors:C}}const wA={};class Xj{constructor(t,e,r){this._triggerName=t,this.ast=e,this._stateStyles=r}match(t,e,r,s){return function _de(n,t,e,r,s){return n.some(i=>i(t,e,r,s))}(this.ast.matchers,t,e,r,s)}buildStyles(t,e,r){let s=this._stateStyles.get("*");return void 0!==t&&(s=this._stateStyles.get(t?.toString())||s),s?s.buildStyles(e,r):new Map}build(t,e,r,s,i,o,c,u,h,p){const m=[],C=this.ast.options&&this.ast.options.params||wA,I=this.buildStyles(r,c&&c.params||wA,m),H=u&&u.params||wA,K=this.buildStyles(s,H,m),ie=new Set,ye=new Map,te=new Map,ke="void"===s,$e={params:vde(H,C),delay:this.ast.options?.delay},Xe=p?[]:SA(t,e,this.ast.animation,i,o,I,K,$e,h,m);let Ft=0;if(Xe.forEach(N1=>{Ft=Math.max(N1.duration+N1.delay,Ft)}),m.length)return Kj(e,this._triggerName,r,s,ke,I,K,[],[],ye,te,Ft,m);Xe.forEach(N1=>{const is=N1.element,Kc=Ha(ye,is,new Set);N1.preStyleProps.forEach(H2=>Kc.add(H2));const $o=Ha(te,is,new Set);N1.postStyleProps.forEach(H2=>$o.add(H2)),is!==e&&ie.add(is)});const D1=pE(ie.values());return Kj(e,this._triggerName,r,s,ke,I,K,Xe,D1,ye,te,Ft)}}function vde(n,t){const e=Up(t);for(const r in n)n.hasOwnProperty(r)&&null!=n[r]&&(e[r]=n[r]);return e}class Cde{constructor(t,e,r){this.styles=t,this.defaultParams=e,this.normalizer=r}buildStyles(t,e){const r=new Map,s=Up(this.defaultParams);return Object.keys(t).forEach(i=>{const o=t[i];null!==o&&(s[i]=o)}),this.styles.styles.forEach(i=>{"string"!=typeof i&&i.forEach((o,c)=>{o&&(o=Wp(o,s,e));const u=this.normalizer.normalizePropertyName(c,e);o=this.normalizer.normalizeStyleValue(c,u,o,e),r.set(u,o)})}),r}}class Ede{constructor(t,e,r){this.name=t,this.ast=e,this._normalizer=r,this.transitionFactories=[],this.states=new Map,e.states.forEach(s=>{this.states.set(s.name,new Cde(s.style,s.options&&s.options.params||{},r))}),Qj(this.states,"true","1"),Qj(this.states,"false","0"),e.transitions.forEach(s=>{this.transitionFactories.push(new Xj(t,s,this.states))}),this.fallbackTransition=function Mde(n,t,e){return new Xj(n,{type:1,animation:{type:2,steps:[],options:null},matchers:[(o,c)=>!0],options:null,queryCount:0,depCount:0},t)}(t,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(t,e,r,s){return this.transitionFactories.find(o=>o.match(t,e,r,s))||null}matchStyles(t,e,r){return this.fallbackTransition.buildStyles(t,e,r)}}function Qj(n,t,e){n.has(t)?n.has(e)||n.set(e,n.get(t)):n.has(e)&&n.set(t,n.get(e))}const Sde=new yE;class Pde{constructor(t,e,r){this.bodyNode=t,this._driver=e,this._normalizer=r,this._animations=new Map,this._playersById=new Map,this.players=[]}register(t,e){const r=[],i=yA(this._driver,e,r,[]);if(r.length)throw function Phe(n){return new Ae(3503,!1)}();this._animations.set(t,i)}_buildPlayer(t,e,r){const s=t.element,i=Aj(0,this._normalizer,0,t.keyframes,e,r);return this._driver.animate(s,i,t.duration,t.delay,t.easing,[],!0)}create(t,e,r={}){const s=[],i=this._animations.get(t);let o;const c=new Map;if(i?(o=SA(this._driver,e,i,gA,uE,new Map,new Map,r,Sde,s),o.forEach(p=>{const m=Ha(c,p.element,new Map);p.postStyleProps.forEach(C=>m.set(C,null))})):(s.push(function The(){return new Ae(3300,!1)}()),o=[]),s.length)throw function whe(n){return new Ae(3504,!1)}();c.forEach((p,m)=>{p.forEach((C,w)=>{p.set(w,this._driver.computeStyle(m,w,zl))})});const h=b0(o.map(p=>{const m=c.get(p.element);return this._buildPlayer(p,new Map,m)}));return this._playersById.set(t,h),h.onDestroy(()=>this.destroy(t)),this.players.push(h),h}destroy(t){const e=this._getPlayer(t);e.destroy(),this._playersById.delete(t);const r=this.players.indexOf(e);r>=0&&this.players.splice(r,1)}_getPlayer(t){const e=this._playersById.get(t);if(!e)throw function bhe(n){return new Ae(3301,!1)}();return e}listen(t,e,r,s){const i=fA(e,"","","");return lA(this._getPlayer(t),r,i,s),()=>{}}command(t,e,r,s){if("register"==r)return void this.register(t,s[0]);if("create"==r)return void this.create(t,e,s[0]||{});const i=this._getPlayer(t);switch(r){case"play":i.play();break;case"pause":i.pause();break;case"reset":i.reset();break;case"restart":i.restart();break;case"finish":i.finish();break;case"init":i.init();break;case"setPosition":i.setPosition(parseFloat(s[0]));break;case"destroy":this.destroy(t)}}}const Jj="ng-animate-queued",bA="ng-animate-disabled",Nde=[],eZ={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},Ade={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},Oc="__ng_removed";class OA{constructor(t,e=""){this.namespaceId=e;const r=t&&t.hasOwnProperty("value");if(this.value=function Lde(n){return n??null}(r?t.value:t),r){const i=Up(t);delete i.value,this.options=i}else this.options={};this.options.params||(this.options.params={})}get params(){return this.options.params}absorbOptions(t){const e=t.params;if(e){const r=this.options.params;Object.keys(e).forEach(s=>{null==r[s]&&(r[s]=e[s])})}}}const qp="void",NA=new OA(qp);class Ide{constructor(t,e,r){this.id=t,this.hostElement=e,this._engine=r,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+t,Nc(e,this._hostClassName)}listen(t,e,r,s){if(!this._triggers.has(e))throw function Ohe(n,t){return new Ae(3302,!1)}();if(null==r||0==r.length)throw function Nhe(n){return new Ae(3303,!1)}();if(!function Rde(n){return"start"==n||"done"==n}(r))throw function Ahe(n,t){return new Ae(3400,!1)}();const i=Ha(this._elementListeners,t,[]),o={name:e,phase:r,callback:s};i.push(o);const c=Ha(this._engine.statesByElement,t,new Map);return c.has(e)||(Nc(t,fE),Nc(t,fE+"-"+e),c.set(e,NA)),()=>{this._engine.afterFlush(()=>{const u=i.indexOf(o);u>=0&&i.splice(u,1),this._triggers.has(e)||c.delete(e)})}}register(t,e){return!this._triggers.has(t)&&(this._triggers.set(t,e),!0)}_getTrigger(t){const e=this._triggers.get(t);if(!e)throw function Ihe(n){return new Ae(3401,!1)}();return e}trigger(t,e,r,s=!0){const i=this._getTrigger(e),o=new AA(this.id,e,t);let c=this._engine.statesByElement.get(t);c||(Nc(t,fE),Nc(t,fE+"-"+e),this._engine.statesByElement.set(t,c=new Map));let u=c.get(e);const h=new OA(r,this.id);if(!(r&&r.hasOwnProperty("value"))&&u&&h.absorbOptions(u.options),c.set(e,h),u||(u=NA),h.value!==qp&&u.value===h.value){if(!function Vde(n,t){const e=Object.keys(n),r=Object.keys(t);if(e.length!=r.length)return!1;for(let s=0;s<e.length;s++){const i=e[s];if(!t.hasOwnProperty(i)||n[i]!==t[i])return!1}return!0}(u.params,h.params)){const H=[],K=i.matchStyles(u.value,u.params,H),ie=i.matchStyles(h.value,h.params,H);H.length?this._engine.reportError(H):this._engine.afterFlush(()=>{Iu(t,K),T4(t,ie)})}return}const C=Ha(this._engine.playersByElement,t,[]);C.forEach(H=>{H.namespaceId==this.id&&H.triggerName==e&&H.queued&&H.destroy()});let w=i.matchTransition(u.value,h.value,t,h.params),I=!1;if(!w){if(!s)return;w=i.fallbackTransition,I=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:e,transition:w,fromState:u,toState:h,player:o,isFallbackTransition:I}),I||(Nc(t,Jj),o.onStart(()=>{Cf(t,Jj)})),o.onDone(()=>{let H=this.players.indexOf(o);H>=0&&this.players.splice(H,1);const K=this._engine.playersByElement.get(t);if(K){let ie=K.indexOf(o);ie>=0&&K.splice(ie,1)}}),this.players.push(o),C.push(o),o}deregister(t){this._triggers.delete(t),this._engine.statesByElement.forEach(e=>e.delete(t)),this._elementListeners.forEach((e,r)=>{this._elementListeners.set(r,e.filter(s=>s.name!=t))})}clearElementCache(t){this._engine.statesByElement.delete(t),this._elementListeners.delete(t);const e=this._engine.playersByElement.get(t);e&&(e.forEach(r=>r.destroy()),this._engine.playersByElement.delete(t))}_signalRemovalForInnerTriggers(t,e){const r=this._engine.driver.query(t,hE,!0);r.forEach(s=>{if(s[Oc])return;const i=this._engine.fetchNamespacesByElement(s);i.size?i.forEach(o=>o.triggerLeaveAnimation(s,e,!1,!0)):this.clearElementCache(s)}),this._engine.afterFlushAnimationsDone(()=>r.forEach(s=>this.clearElementCache(s)))}triggerLeaveAnimation(t,e,r,s){const i=this._engine.statesByElement.get(t),o=new Map;if(i){const c=[];if(i.forEach((u,h)=>{if(o.set(h,u.value),this._triggers.has(h)){const p=this.trigger(t,h,qp,s);p&&c.push(p)}}),c.length)return this._engine.markElementAsRemoved(this.id,t,!0,e,o),r&&b0(c).onDone(()=>this._engine.processLeaveNode(t)),!0}return!1}prepareLeaveAnimationListeners(t){const e=this._elementListeners.get(t),r=this._engine.statesByElement.get(t);if(e&&r){const s=new Set;e.forEach(i=>{const o=i.name;if(s.has(o))return;s.add(o);const u=this._triggers.get(o).fallbackTransition,h=r.get(o)||NA,p=new OA(qp),m=new AA(this.id,o,t);this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:o,transition:u,fromState:h,toState:p,player:m,isFallbackTransition:!0})})}}removeNode(t,e){const r=this._engine;if(t.childElementCount&&this._signalRemovalForInnerTriggers(t,e),this.triggerLeaveAnimation(t,e,!0))return;let s=!1;if(r.totalAnimations){const i=r.players.length?r.playersByQueriedElement.get(t):[];if(i&&i.length)s=!0;else{let o=t;for(;o=o.parentNode;)if(r.statesByElement.get(o)){s=!0;break}}}if(this.prepareLeaveAnimationListeners(t),s)r.markElementAsRemoved(this.id,t,!1,e);else{const i=t[Oc];(!i||i===eZ)&&(r.afterFlush(()=>this.clearElementCache(t)),r.destroyInnerAnimations(t),r._onRemovalComplete(t,e))}}insertNode(t,e){Nc(t,this._hostClassName)}drainQueuedTransitions(t){const e=[];return this._queue.forEach(r=>{const s=r.player;if(s.destroyed)return;const i=r.element,o=this._elementListeners.get(i);o&&o.forEach(c=>{if(c.name==r.triggerName){const u=fA(i,r.triggerName,r.fromState.value,r.toState.value);u._data=t,lA(r.player,c.phase,u,c.callback)}}),s.markedForDestroy?this._engine.afterFlush(()=>{s.destroy()}):e.push(r)}),this._queue=[],e.sort((r,s)=>{const i=r.transition.ast.depCount,o=s.transition.ast.depCount;return 0==i||0==o?i-o:this._engine.driver.containsElement(r.element,s.element)?1:-1})}destroy(t){this.players.forEach(e=>e.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,t)}elementContainsData(t){let e=!1;return this._elementListeners.has(t)&&(e=!0),e=!!this._queue.find(r=>r.element===t)||e,e}}class xde{constructor(t,e,r){this.bodyNode=t,this.driver=e,this._normalizer=r,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(s,i)=>{}}_onRemovalComplete(t,e){this.onRemovalComplete(t,e)}get queuedPlayers(){const t=[];return this._namespaceList.forEach(e=>{e.players.forEach(r=>{r.queued&&t.push(r)})}),t}createNamespace(t,e){const r=new Ide(t,e,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,e)?this._balanceNamespaceList(r,e):(this.newHostElements.set(e,r),this.collectEnterElement(e)),this._namespaceLookup[t]=r}_balanceNamespaceList(t,e){const r=this._namespaceList,s=this.namespacesByHostElement;if(r.length-1>=0){let o=!1,c=this.driver.getParentElement(e);for(;c;){const u=s.get(c);if(u){const h=r.indexOf(u);r.splice(h+1,0,t),o=!0;break}c=this.driver.getParentElement(c)}o||r.unshift(t)}else r.push(t);return s.set(e,t),t}register(t,e){let r=this._namespaceLookup[t];return r||(r=this.createNamespace(t,e)),r}registerTrigger(t,e,r){let s=this._namespaceLookup[t];s&&s.register(e,r)&&this.totalAnimations++}destroy(t,e){if(!t)return;const r=this._fetchNamespace(t);this.afterFlush(()=>{this.namespacesByHostElement.delete(r.hostElement),delete this._namespaceLookup[t];const s=this._namespaceList.indexOf(r);s>=0&&this._namespaceList.splice(s,1)}),this.afterFlushAnimationsDone(()=>r.destroy(e))}_fetchNamespace(t){return this._namespaceLookup[t]}fetchNamespacesByElement(t){const e=new Set,r=this.statesByElement.get(t);if(r)for(let s of r.values())if(s.namespaceId){const i=this._fetchNamespace(s.namespaceId);i&&e.add(i)}return e}trigger(t,e,r,s){if(SE(e)){const i=this._fetchNamespace(t);if(i)return i.trigger(e,r,s),!0}return!1}insertNode(t,e,r,s){if(!SE(e))return;const i=e[Oc];if(i&&i.setForRemoval){i.setForRemoval=!1,i.setForMove=!0;const o=this.collectedLeaveElements.indexOf(e);o>=0&&this.collectedLeaveElements.splice(o,1)}if(t){const o=this._fetchNamespace(t);o&&o.insertNode(e,r)}s&&this.collectEnterElement(e)}collectEnterElement(t){this.collectedEnterElements.push(t)}markElementAsDisabled(t,e){e?this.disabledNodes.has(t)||(this.disabledNodes.add(t),Nc(t,bA)):this.disabledNodes.has(t)&&(this.disabledNodes.delete(t),Cf(t,bA))}removeNode(t,e,r,s){if(SE(e)){const i=t?this._fetchNamespace(t):null;if(i?i.removeNode(e,s):this.markElementAsRemoved(t,e,!1,s),r){const o=this.namespacesByHostElement.get(e);o&&o.id!==t&&o.removeNode(e,s)}}else this._onRemovalComplete(e,s)}markElementAsRemoved(t,e,r,s,i){this.collectedLeaveElements.push(e),e[Oc]={namespaceId:t,setForRemoval:s,hasAnimation:r,removedBeforeQueried:!1,previousTriggersValues:i}}listen(t,e,r,s,i){return SE(e)?this._fetchNamespace(t).listen(e,r,s,i):()=>{}}_buildInstruction(t,e,r,s,i){return t.transition.build(this.driver,t.element,t.fromState.value,t.toState.value,r,s,t.fromState.options,t.toState.options,e,i)}destroyInnerAnimations(t){let e=this.driver.query(t,hE,!0);e.forEach(r=>this.destroyActiveAnimationsForElement(r)),0!=this.playersByQueriedElement.size&&(e=this.driver.query(t,mA,!0),e.forEach(r=>this.finishActiveQueriedAnimationOnElement(r)))}destroyActiveAnimationsForElement(t){const e=this.playersByElement.get(t);e&&e.forEach(r=>{r.queued?r.markedForDestroy=!0:r.destroy()})}finishActiveQueriedAnimationOnElement(t){const e=this.playersByQueriedElement.get(t);e&&e.forEach(r=>r.finish())}whenRenderingDone(){return new Promise(t=>{if(this.players.length)return b0(this.players).onDone(()=>t());t()})}processLeaveNode(t){const e=t[Oc];if(e&&e.setForRemoval){if(t[Oc]=eZ,e.namespaceId){this.destroyInnerAnimations(t);const r=this._fetchNamespace(e.namespaceId);r&&r.clearElementCache(t)}this._onRemovalComplete(t,e.setForRemoval)}t.classList?.contains(bA)&&this.markElementAsDisabled(t,!1),this.driver.query(t,".ng-animate-disabled",!0).forEach(r=>{this.markElementAsDisabled(r,!1)})}flush(t=-1){let e=[];if(this.newHostElements.size&&(this.newHostElements.forEach((r,s)=>this._balanceNamespaceList(r,s)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let r=0;r<this.collectedEnterElements.length;r++)Nc(this.collectedEnterElements[r],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const r=[];try{e=this._flushAnimations(r,t)}finally{for(let s=0;s<r.length;s++)r[s]()}}else for(let r=0;r<this.collectedLeaveElements.length;r++)this.processLeaveNode(this.collectedLeaveElements[r]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(r=>r()),this._flushFns=[],this._whenQuietFns.length){const r=this._whenQuietFns;this._whenQuietFns=[],e.length?b0(e).onDone(()=>{r.forEach(s=>s())}):r.forEach(s=>s())}}reportError(t){throw function xhe(n){return new Ae(3402,!1)}()}_flushAnimations(t,e){const r=new yE,s=[],i=new Map,o=[],c=new Map,u=new Map,h=new Map,p=new Set;this.disabledNodes.forEach(Mt=>{p.add(Mt);const Wt=this.driver.query(Mt,".ng-animate-queued",!0);for(let Xt=0;Xt<Wt.length;Xt++)p.add(Wt[Xt])});const m=this.bodyNode,C=Array.from(this.statesByElement.keys()),w=rZ(C,this.collectedEnterElements),I=new Map;let H=0;w.forEach((Mt,Wt)=>{const Xt=gA+H++;I.set(Wt,Xt),Mt.forEach(o1=>Nc(o1,Xt))});const K=[],ie=new Set,ye=new Set;for(let Mt=0;Mt<this.collectedLeaveElements.length;Mt++){const Wt=this.collectedLeaveElements[Mt],Xt=Wt[Oc];Xt&&Xt.setForRemoval&&(K.push(Wt),ie.add(Wt),Xt.hasAnimation?this.driver.query(Wt,".ng-star-inserted",!0).forEach(o1=>ie.add(o1)):ye.add(Wt))}const te=new Map,ke=rZ(C,Array.from(ie));ke.forEach((Mt,Wt)=>{const Xt=uE+H++;te.set(Wt,Xt),Mt.forEach(o1=>Nc(o1,Xt))}),t.push(()=>{w.forEach((Mt,Wt)=>{const Xt=I.get(Wt);Mt.forEach(o1=>Cf(o1,Xt))}),ke.forEach((Mt,Wt)=>{const Xt=te.get(Wt);Mt.forEach(o1=>Cf(o1,Xt))}),K.forEach(Mt=>{this.processLeaveNode(Mt)})});const $e=[],Xe=[];for(let Mt=this._namespaceList.length-1;Mt>=0;Mt--)this._namespaceList[Mt].drainQueuedTransitions(e).forEach(Xt=>{const o1=Xt.player,qt=Xt.element;if($e.push(o1),this.collectedEnterElements.length){const co=qt[Oc];if(co&&co.setForMove){if(co.previousTriggersValues&&co.previousTriggersValues.has(Xt.triggerName)){const N5=co.previousTriggersValues.get(Xt.triggerName),Xc=this.statesByElement.get(Xt.element);if(Xc&&Xc.has(Xt.triggerName)){const eT=Xc.get(Xt.triggerName);eT.value=N5,Xc.set(Xt.triggerName,eT)}}return void o1.destroy()}}const Y4=!m||!this.driver.containsElement(m,qt),ic=te.get(qt),p8=I.get(qt),os=this._buildInstruction(Xt,r,p8,ic,Y4);if(os.errors&&os.errors.length)return void Xe.push(os);if(Y4)return o1.onStart(()=>Iu(qt,os.fromStyles)),o1.onDestroy(()=>T4(qt,os.toStyles)),void s.push(o1);if(Xt.isFallbackTransition)return o1.onStart(()=>Iu(qt,os.fromStyles)),o1.onDestroy(()=>T4(qt,os.toStyles)),void s.push(o1);const f4e=[];os.timelines.forEach(co=>{co.stretchStartingKeyframe=!0,this.disabledNodes.has(co.element)||f4e.push(co)}),os.timelines=f4e,r.append(qt,os.timelines),o.push({instruction:os,player:o1,element:qt}),os.queriedElements.forEach(co=>Ha(c,co,[]).push(o1)),os.preStyleProps.forEach((co,N5)=>{if(co.size){let Xc=u.get(N5);Xc||u.set(N5,Xc=new Set),co.forEach((eT,XH)=>Xc.add(XH))}}),os.postStyleProps.forEach((co,N5)=>{let Xc=h.get(N5);Xc||h.set(N5,Xc=new Set),co.forEach((eT,XH)=>Xc.add(XH))})});if(Xe.length){const Mt=[];Xe.forEach(Wt=>{Mt.push(function khe(n,t){return new Ae(3505,!1)}())}),$e.forEach(Wt=>Wt.destroy()),this.reportError(Mt)}const Ft=new Map,D1=new Map;o.forEach(Mt=>{const Wt=Mt.element;r.has(Wt)&&(D1.set(Wt,Wt),this._beforeAnimationBuild(Mt.player.namespaceId,Mt.instruction,Ft))}),s.forEach(Mt=>{const Wt=Mt.element;this._getPreviousPlayers(Wt,!1,Mt.namespaceId,Mt.triggerName,null).forEach(o1=>{Ha(Ft,Wt,[]).push(o1),o1.destroy()})});const N1=K.filter(Mt=>iZ(Mt,u,h)),is=new Map;nZ(is,this.driver,ye,h,zl).forEach(Mt=>{iZ(Mt,u,h)&&N1.push(Mt)});const $o=new Map;w.forEach((Mt,Wt)=>{nZ($o,this.driver,new Set(Mt),u,"!")}),N1.forEach(Mt=>{const Wt=is.get(Mt),Xt=$o.get(Mt);is.set(Mt,new Map([...Array.from(Wt?.entries()??[]),...Array.from(Xt?.entries()??[])]))});const H2=[],Yn=[],E6={};o.forEach(Mt=>{const{element:Wt,player:Xt,instruction:o1}=Mt;if(r.has(Wt)){if(p.has(Wt))return Xt.onDestroy(()=>T4(Wt,o1.toStyles)),Xt.disabled=!0,Xt.overrideTotalTime(o1.totalTime),void s.push(Xt);let qt=E6;if(D1.size>1){let ic=Wt;const p8=[];for(;ic=ic.parentNode;){const os=D1.get(ic);if(os){qt=os;break}p8.push(ic)}p8.forEach(os=>D1.set(os,qt))}const Y4=this._buildAnimation(Xt.namespaceId,o1,Ft,i,$o,is);if(Xt.setRealPlayer(Y4),qt===E6)H2.push(Xt);else{const ic=this.playersByElement.get(qt);ic&&ic.length&&(Xt.parentPlayer=b0(ic)),s.push(Xt)}}else Iu(Wt,o1.fromStyles),Xt.onDestroy(()=>T4(Wt,o1.toStyles)),Yn.push(Xt),p.has(Wt)&&s.push(Xt)}),Yn.forEach(Mt=>{const Wt=i.get(Mt.element);if(Wt&&Wt.length){const Xt=b0(Wt);Mt.setRealPlayer(Xt)}}),s.forEach(Mt=>{Mt.parentPlayer?Mt.syncPlayerEvents(Mt.parentPlayer):Mt.destroy()});for(let Mt=0;Mt<K.length;Mt++){const Wt=K[Mt],Xt=Wt[Oc];if(Cf(Wt,uE),Xt&&Xt.hasAnimation)continue;let o1=[];if(c.size){let Y4=c.get(Wt);Y4&&Y4.length&&o1.push(...Y4);let ic=this.driver.query(Wt,mA,!0);for(let p8=0;p8<ic.length;p8++){let os=c.get(ic[p8]);os&&os.length&&o1.push(...os)}}const qt=o1.filter(Y4=>!Y4.destroyed);qt.length?Dde(this,Wt,qt):this.processLeaveNode(Wt)}return K.length=0,H2.forEach(Mt=>{this.players.push(Mt),Mt.onDone(()=>{Mt.destroy();const Wt=this.players.indexOf(Mt);this.players.splice(Wt,1)}),Mt.play()}),H2}elementContainsData(t,e){let r=!1;const s=e[Oc];return s&&s.setForRemoval&&(r=!0),this.playersByElement.has(e)&&(r=!0),this.playersByQueriedElement.has(e)&&(r=!0),this.statesByElement.has(e)&&(r=!0),this._fetchNamespace(t).elementContainsData(e)||r}afterFlush(t){this._flushFns.push(t)}afterFlushAnimationsDone(t){this._whenQuietFns.push(t)}_getPreviousPlayers(t,e,r,s,i){let o=[];if(e){const c=this.playersByQueriedElement.get(t);c&&(o=c)}else{const c=this.playersByElement.get(t);if(c){const u=!i||i==qp;c.forEach(h=>{h.queued||!u&&h.triggerName!=s||o.push(h)})}}return(r||s)&&(o=o.filter(c=>!(r&&r!=c.namespaceId||s&&s!=c.triggerName))),o}_beforeAnimationBuild(t,e,r){const i=e.element,o=e.isRemovalTransition?void 0:t,c=e.isRemovalTransition?void 0:e.triggerName;for(const u of e.timelines){const h=u.element,p=h!==i,m=Ha(r,h,[]);this._getPreviousPlayers(h,p,o,c,e.toState).forEach(w=>{const I=w.getRealPlayer();I.beforeDestroy&&I.beforeDestroy(),w.destroy(),m.push(w)})}Iu(i,e.fromStyles)}_buildAnimation(t,e,r,s,i,o){const c=e.triggerName,u=e.element,h=[],p=new Set,m=new Set,C=e.timelines.map(I=>{const H=I.element;p.add(H);const K=H[Oc];if(K&&K.removedBeforeQueried)return new $p(I.duration,I.delay);const ie=H!==u,ye=function zde(n){const t=[];return sZ(n,t),t}((r.get(H)||Nde).map(Ft=>Ft.getRealPlayer())).filter(Ft=>!!Ft.element&&Ft.element===H),te=i.get(H),ke=o.get(H),$e=Aj(0,this._normalizer,0,I.keyframes,te,ke),Xe=this._buildPlayer(I,$e,ye);if(I.subTimeline&&s&&m.add(H),ie){const Ft=new AA(t,c,H);Ft.setRealPlayer(Xe),h.push(Ft)}return Xe});h.forEach(I=>{Ha(this.playersByQueriedElement,I.element,[]).push(I),I.onDone(()=>function kde(n,t,e){let r=n.get(t);if(r){if(r.length){const s=r.indexOf(e);r.splice(s,1)}0==r.length&&n.delete(t)}return r}(this.playersByQueriedElement,I.element,I))}),p.forEach(I=>Nc(I,Hj));const w=b0(C);return w.onDestroy(()=>{p.forEach(I=>Cf(I,Hj)),T4(u,e.toStyles)}),m.forEach(I=>{Ha(s,I,[]).push(w)}),w}_buildPlayer(t,e,r){return e.length>0?this.driver.animate(t.element,e,t.duration,t.delay,t.easing,r):new $p(t.duration,t.delay)}}class AA{constructor(t,e,r){this.namespaceId=t,this.triggerName=e,this.element=r,this._player=new $p,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(t){this._containsRealPlayer||(this._player=t,this._queuedCallbacks.forEach((e,r)=>{e.forEach(s=>lA(t,r,void 0,s))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(t.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(t){this.totalTime=t}syncPlayerEvents(t){const e=this._player;e.triggerCallback&&t.onStart(()=>e.triggerCallback("start")),t.onDone(()=>this.finish()),t.onDestroy(()=>this.destroy())}_queueEvent(t,e){Ha(this._queuedCallbacks,t,[]).push(e)}onDone(t){this.queued&&this._queueEvent("done",t),this._player.onDone(t)}onStart(t){this.queued&&this._queueEvent("start",t),this._player.onStart(t)}onDestroy(t){this.queued&&this._queueEvent("destroy",t),this._player.onDestroy(t)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(t){this.queued||this._player.setPosition(t)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(t){const e=this._player;e.triggerCallback&&e.triggerCallback(t)}}function SE(n){return n&&1===n.nodeType}function tZ(n,t){const e=n.style.display;return n.style.display=t??"none",e}function nZ(n,t,e,r,s){const i=[];e.forEach(u=>i.push(tZ(u)));const o=[];r.forEach((u,h)=>{const p=new Map;u.forEach(m=>{const C=t.computeStyle(h,m,s);p.set(m,C),(!C||0==C.length)&&(h[Oc]=Ade,o.push(h))}),n.set(h,p)});let c=0;return e.forEach(u=>tZ(u,i[c++])),o}function rZ(n,t){const e=new Map;if(n.forEach(c=>e.set(c,[])),0==t.length)return e;const s=new Set(t),i=new Map;function o(c){if(!c)return 1;let u=i.get(c);if(u)return u;const h=c.parentNode;return u=e.has(h)?h:s.has(h)?1:o(h),i.set(c,u),u}return t.forEach(c=>{const u=o(c);1!==u&&e.get(u).push(c)}),e}function Nc(n,t){n.classList?.add(t)}function Cf(n,t){n.classList?.remove(t)}function Dde(n,t,e){b0(e).onDone(()=>n.processLeaveNode(t))}function sZ(n,t){for(let e=0;e<n.length;e++){const r=n[e];r instanceof Oj?sZ(r.players,t):t.push(r)}}function iZ(n,t,e){const r=e.get(n);if(!r)return!1;let s=t.get(n);return s?r.forEach(i=>s.add(i)):t.set(n,r),e.delete(n),!0}class PE{constructor(t,e,r){this.bodyNode=t,this._driver=e,this._normalizer=r,this._triggerCache={},this.onRemovalComplete=(s,i)=>{},this._transitionEngine=new xde(t,e,r),this._timelineEngine=new Pde(t,e,r),this._transitionEngine.onRemovalComplete=(s,i)=>this.onRemovalComplete(s,i)}registerTrigger(t,e,r,s,i){const o=t+"-"+s;let c=this._triggerCache[o];if(!c){const u=[],p=yA(this._driver,i,u,[]);if(u.length)throw function Mhe(n,t){return new Ae(3404,!1)}();c=function yde(n,t,e){return new Ede(n,t,e)}(s,p,this._normalizer),this._triggerCache[o]=c}this._transitionEngine.registerTrigger(e,s,c)}register(t,e){this._transitionEngine.register(t,e)}destroy(t,e){this._transitionEngine.destroy(t,e)}onInsert(t,e,r,s){this._transitionEngine.insertNode(t,e,r,s)}onRemove(t,e,r,s){this._transitionEngine.removeNode(t,e,s||!1,r)}disableAnimations(t,e){this._transitionEngine.markElementAsDisabled(t,e)}process(t,e,r,s){if("@"==r.charAt(0)){const[i,o]=Ij(r);this._timelineEngine.command(i,e,o,s)}else this._transitionEngine.trigger(t,e,r,s)}listen(t,e,r,s,i){if("@"==r.charAt(0)){const[o,c]=Ij(r);return this._timelineEngine.listen(o,e,c,i)}return this._transitionEngine.listen(t,e,r,s,i)}flush(t=-1){this._transitionEngine.flush(t)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}let Fde=(()=>{class n{constructor(e,r,s){this._element=e,this._startStyles=r,this._endStyles=s,this._state=0;let i=n.initialStylesByElement.get(e);i||n.initialStylesByElement.set(e,i=new Map),this._initialStyles=i}start(){this._state<1&&(this._startStyles&&T4(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(T4(this._element,this._initialStyles),this._endStyles&&(T4(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(n.initialStylesByElement.delete(this._element),this._startStyles&&(Iu(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(Iu(this._element,this._endStyles),this._endStyles=null),T4(this._element,this._initialStyles),this._state=3)}}return n.initialStylesByElement=new WeakMap,n})();function IA(n){let t=null;return n.forEach((e,r)=>{(function Bde(n){return"display"===n||"position"===n})(r)&&(t=t||new Map,t.set(r,e))}),t}class oZ{constructor(t,e,r,s){this.element=t,this.keyframes=e,this.options=r,this._specialStyles=s,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=r.duration,this._delay=r.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const t=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,t,this.options),this._finalKeyframe=t.length?t[t.length-1]:new Map,this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(t){const e=[];return t.forEach(r=>{e.push(Object.fromEntries(r))}),e}_triggerWebAnimation(t,e,r){return t.animate(this._convertKeyframesToObject(e),r)}onStart(t){this._originalOnStartFns.push(t),this._onStartFns.push(t)}onDone(t){this._originalOnDoneFns.push(t),this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(t=>t()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}setPosition(t){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=t*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const t=new Map;this.hasStarted()&&this._finalKeyframe.forEach((r,s)=>{"offset"!==s&&t.set(s,this._finished?r:Wj(this.element,s))}),this.currentSnapshot=t}triggerCallback(t){const e="start"===t?this._onStartFns:this._onDoneFns;e.forEach(r=>r()),e.length=0}}class $de{validateStyleProperty(t){return!0}validateAnimatableStyleProperty(t){return!0}matchesElement(t,e){return!1}containsElement(t,e){return Rj(t,e)}getParentElement(t){return dA(t)}query(t,e,r){return Dj(t,e,r)}computeStyle(t,e,r){return window.getComputedStyle(t)[e]}animate(t,e,r,s,i,o=[]){const u={duration:r,delay:s,fill:0==s?"both":"forwards"};i&&(u.easing=i);const h=new Map,p=o.filter(w=>w instanceof oZ);(function qhe(n,t){return 0===n||0===t})(r,s)&&p.forEach(w=>{w.currentSnapshot.forEach((I,H)=>h.set(H,I))});let m=function $he(n){return n.length?n[0]instanceof Map?n:n.map(t=>Fj(t)):[]}(e).map(w=>O0(w));m=function jhe(n,t,e){if(e.size&&t.length){let r=t[0],s=[];if(e.forEach((i,o)=>{r.has(o)||s.push(o),r.set(o,i)}),s.length)for(let i=1;i<t.length;i++){let o=t[i];s.forEach(c=>o.set(c,Wj(n,c)))}}return t}(t,m,h);const C=function Hde(n,t){let e=null,r=null;return Array.isArray(t)&&t.length?(e=IA(t[0]),t.length>1&&(r=IA(t[t.length-1]))):t instanceof Map&&(e=IA(t)),e||r?new Fde(n,e,r):null}(t,m);return new oZ(t,m,u,C)}}let Ude=(()=>{class n extends Pj{constructor(e,r){super(),this._nextAnimationId=0,this._renderer=e.createRenderer(r.body,{id:"0",encapsulation:z1.None,styles:[],data:{animation:[]}})}build(e){const r=this._nextAnimationId.toString();this._nextAnimationId++;const s=Array.isArray(e)?Tj(e):e;return aZ(this._renderer,null,r,"register",[s]),new Gde(r,this._renderer)}}return n.\u0275fac=function(e){return new(e||n)(De(r0),De($s))},n.\u0275prov=nt({token:n,factory:n.\u0275fac}),n})();class Gde extends class ehe{}{constructor(t,e){super(),this._id=t,this._renderer=e}create(t,e){return new Wde(this._id,t,e||{},this._renderer)}}class Wde{constructor(t,e,r,s){this.id=t,this.element=e,this._renderer=s,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",r)}_listen(t,e){return this._renderer.listen(this.element,`@@${this.id}:${t}`,e)}_command(t,...e){return aZ(this._renderer,this.element,this.id,t,e)}onDone(t){this._listen("done",t)}onStart(t){this._listen("start",t)}onDestroy(t){this._listen("destroy",t)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(t){this._command("setPosition",t)}getPosition(){return this._renderer.engine.players[+this.id]?.getPosition()??0}}function aZ(n,t,e,r,s){return n.setProperty(t,`@@${e}:${r}`,s)}const cZ="@.disabled";let qde=(()=>{class n{constructor(e,r,s){this.delegate=e,this.engine=r,this._zone=s,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),r.onRemovalComplete=(i,o)=>{const c=o?.parentNode(i);c&&o.removeChild(c,i)}}createRenderer(e,r){const i=this.delegate.createRenderer(e,r);if(!(e&&r&&r.data&&r.data.animation)){let p=this._rendererCache.get(i);return p||(p=new lZ("",i,this.engine,()=>this._rendererCache.delete(i)),this._rendererCache.set(i,p)),p}const o=r.id,c=r.id+"-"+this._currentId;this._currentId++,this.engine.register(c,e);const u=p=>{Array.isArray(p)?p.forEach(u):this.engine.registerTrigger(o,c,e,p.name,p)};return r.data.animation.forEach(u),new jde(this,c,i,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(e,r,s){e>=0&&e<this._microtaskId?this._zone.run(()=>r(s)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(i=>{const[o,c]=i;o(c)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([r,s]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return n.\u0275fac=function(e){return new(e||n)(De(r0),De(PE),De(Pr))},n.\u0275prov=nt({token:n,factory:n.\u0275fac}),n})();class lZ{constructor(t,e,r,s){this.namespaceId=t,this.delegate=e,this.engine=r,this._onDestroy=s,this.destroyNode=this.delegate.destroyNode?i=>e.destroyNode(i):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy(),this._onDestroy?.()}createElement(t,e){return this.delegate.createElement(t,e)}createComment(t){return this.delegate.createComment(t)}createText(t){return this.delegate.createText(t)}appendChild(t,e){this.delegate.appendChild(t,e),this.engine.onInsert(this.namespaceId,e,t,!1)}insertBefore(t,e,r,s=!0){this.delegate.insertBefore(t,e,r),this.engine.onInsert(this.namespaceId,e,t,s)}removeChild(t,e,r){this.engine.onRemove(this.namespaceId,e,this.delegate,r)}selectRootElement(t,e){return this.delegate.selectRootElement(t,e)}parentNode(t){return this.delegate.parentNode(t)}nextSibling(t){return this.delegate.nextSibling(t)}setAttribute(t,e,r,s){this.delegate.setAttribute(t,e,r,s)}removeAttribute(t,e,r){this.delegate.removeAttribute(t,e,r)}addClass(t,e){this.delegate.addClass(t,e)}removeClass(t,e){this.delegate.removeClass(t,e)}setStyle(t,e,r,s){this.delegate.setStyle(t,e,r,s)}removeStyle(t,e,r){this.delegate.removeStyle(t,e,r)}setProperty(t,e,r){"@"==e.charAt(0)&&e==cZ?this.disableAnimations(t,!!r):this.delegate.setProperty(t,e,r)}setValue(t,e){this.delegate.setValue(t,e)}listen(t,e,r){return this.delegate.listen(t,e,r)}disableAnimations(t,e){this.engine.disableAnimations(t,e)}}class jde extends lZ{constructor(t,e,r,s,i){super(e,r,s,i),this.factory=t,this.namespaceId=e}setProperty(t,e,r){"@"==e.charAt(0)?"."==e.charAt(1)&&e==cZ?this.disableAnimations(t,r=void 0===r||!!r):this.engine.process(this.namespaceId,t,e.slice(1),r):this.delegate.setProperty(t,e,r)}listen(t,e,r){if("@"==e.charAt(0)){const s=function Zde(n){switch(n){case"body":return document.body;case"document":return document;case"window":return window;default:return n}}(t);let i=e.slice(1),o="";return"@"!=i.charAt(0)&&([i,o]=function Yde(n){const t=n.indexOf(".");return[n.substring(0,t),n.slice(t+1)]}(i)),this.engine.listen(this.namespaceId,s,i,o,c=>{this.factory.scheduleListenerCallback(c._data||-1,r,c)})}return this.delegate.listen(t,e,r)}}let Kde=(()=>{class n extends PE{constructor(e,r,s,i){super(e.body,r,s)}ngOnDestroy(){this.flush()}}return n.\u0275fac=function(e){return new(e||n)(De($s),De(pA),De(TA),De(lp))},n.\u0275prov=nt({token:n,factory:n.\u0275fac}),n})();const uZ=[{provide:Pj,useClass:Ude},{provide:TA,useFactory:function Xde(){return new mde}},{provide:PE,useClass:Kde},{provide:r0,useFactory:function Qde(n,t,e){return new qde(n,t,e)},deps:[by,PE,Pr]}],xA=[{provide:pA,useFactory:()=>new $de},{provide:TU,useValue:"BrowserAnimations"},...uZ],fZ=[{provide:pA,useClass:zj},{provide:TU,useValue:"NoopAnimations"},...uZ];let Jde=(()=>{class n{static withConfig(e){return{ngModule:n,providers:e.disableAnimations?fZ:xA}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=oi({type:n}),n.\u0275inj=jr({providers:xA,imports:[UG]}),n})();const Ps=void 0,tpe=["fr",[["AM","PM"],Ps,Ps],Ps,[["D","L","M","M","J","V","S"],["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"],["di","lu","ma","me","je","ve","sa"]],Ps,[["J","F","M","A","M","J","J","A","S","O","N","D"],["janv.","f\xe9vr.","mars","avr.","mai","juin","juil.","ao\xfbt","sept.","oct.","nov.","d\xe9c."],["janvier","f\xe9vrier","mars","avril","mai","juin","juillet","ao\xfbt","septembre","octobre","novembre","d\xe9cembre"]],Ps,[["av. J.-C.","ap. J.-C."],Ps,["avant J\xe9sus-Christ","apr\xe8s J\xe9sus-Christ"]],1,[6,0],["dd/MM/y","d MMM y","d MMMM y","EEEE d MMMM y"],["HH:mm","HH:mm:ss","HH:mm:ss z","HH:mm:ss zzzz"],["{1} {0}","{1}, {0}","{1} '\xe0' {0}",Ps],[",","\u202f",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0\xa0%","#,##0.00\xa0\xa4","#E0"],"EUR","\u20ac","euro",{ARS:["$AR","$"],AUD:["$AU","$"],BEF:["FB"],BMD:["$BM","$"],BND:["$BN","$"],BYN:[Ps,"\u0440."],BZD:["$BZ","$"],CAD:["$CA","$"],CLP:["$CL","$"],CNY:[Ps,"\xa5"],COP:["$CO","$"],CYP:["\xa3CY"],EGP:[Ps,"\xa3E"],FJD:["$FJ","$"],FKP:["\xa3FK","\xa3"],FRF:["F"],GBP:["\xa3GB","\xa3"],GIP:["\xa3GI","\xa3"],HKD:[Ps,"$"],IEP:["\xa3IE"],ILP:["\xa3IL"],ITL:["\u20a4IT"],JPY:[Ps,"\xa5"],KMF:[Ps,"FC"],LBP:["\xa3LB","\xa3L"],MTP:["\xa3MT"],MXN:["$MX","$"],NAD:["$NA","$"],NIO:[Ps,"$C"],NZD:["$NZ","$"],PHP:[Ps,"\u20b1"],RHD:["$RH"],RON:[Ps,"L"],RWF:[Ps,"FR"],SBD:["$SB","$"],SGD:["$SG","$"],SRD:["$SR","$"],TOP:[Ps,"$T"],TTD:["$TT","$"],TWD:[Ps,"NT$"],USD:["$US","$"],UYU:["$UY","$"],WST:["$WS"],XCD:[Ps,"$"],XPF:["FCFP"],ZMW:[Ps,"Kw"]},"ltr",function epe(n){const e=Math.floor(Math.abs(n)),r=n.toString().replace(/^[^.]*\.?/,"").length,s=parseInt(n.toString().replace(/^[^e]*(e([-+]?\d+))?/,"$2"))||0;return 0===e||1===e?1:0===s&&0!==e&&e%1e6==0&&0===r||!(s>=0&&s<=5)?4:5}];function hZ(n,t,e,r,s,i,o){try{var c=n[i](o),u=c.value}catch(h){return void e(h)}c.done?t(u):Promise.resolve(u).then(r,s)}function A(n){return function(){var t=this,e=arguments;return new Promise(function(r,s){var i=n.apply(t,e);function o(u){hZ(i,r,s,o,c,"next",u)}function c(u){hZ(i,r,s,o,c,"throw",u)}o(void 0)})}}const dZ=function(n){const t=[];let e=0;for(let r=0;r<n.length;r++){let s=n.charCodeAt(r);s<128?t[e++]=s:s<2048?(t[e++]=s>>6|192,t[e++]=63&s|128):55296==(64512&s)&&r+1<n.length&&56320==(64512&n.charCodeAt(r+1))?(s=65536+((1023&s)<<10)+(1023&n.charCodeAt(++r)),t[e++]=s>>18|240,t[e++]=s>>12&63|128,t[e++]=s>>6&63|128,t[e++]=63&s|128):(t[e++]=s>>12|224,t[e++]=s>>6&63|128,t[e++]=63&s|128)}return t},LA={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(n,t){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const e=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<n.length;s+=3){const i=n[s],o=s+1<n.length,c=o?n[s+1]:0,u=s+2<n.length,h=u?n[s+2]:0;let C=(15&c)<<2|h>>6,w=63&h;u||(w=64,o||(C=64)),r.push(e[i>>2],e[(3&i)<<4|c>>4],e[C],e[w])}return r.join("")},encodeString(n,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(n):this.encodeByteArray(dZ(n),t)},decodeString(n,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(n):function(n){const t=[];let e=0,r=0;for(;e<n.length;){const s=n[e++];if(s<128)t[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=n[e++];t[r++]=String.fromCharCode((31&s)<<6|63&i)}else if(s>239&&s<365){const u=((7&s)<<18|(63&n[e++])<<12|(63&n[e++])<<6|63&n[e++])-65536;t[r++]=String.fromCharCode(55296+(u>>10)),t[r++]=String.fromCharCode(56320+(1023&u))}else{const i=n[e++],o=n[e++];t[r++]=String.fromCharCode((15&s)<<12|(63&i)<<6|63&o)}}return t.join("")}(this.decodeStringToByteArray(n,t))},decodeStringToByteArray(n,t){this.init_();const e=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<n.length;){const i=e[n.charAt(s++)],c=s<n.length?e[n.charAt(s)]:0;++s;const h=s<n.length?e[n.charAt(s)]:64;++s;const m=s<n.length?e[n.charAt(s)]:64;if(++s,null==i||null==c||null==h||null==m)throw Error();r.push(i<<2|c>>4),64!==h&&(r.push(c<<4&240|h>>2),64!==m&&r.push(h<<6&192|m))}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},wE=function(n){return function(n){const t=dZ(n);return LA.encodeByteArray(t,!0)}(n).replace(/\./g,"")},bE=function(n){try{return LA.decodeString(n,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function zi(){return typeof navigator<"u"&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function RA(){const n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof n&&void 0!==n.id}function ku(){return"object"==typeof indexedDB}function jp(){return new Promise((n,t)=>{try{let e=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),e||self.indexedDB.deleteDatabase(r),n(!0)},s.onupgradeneeded=()=>{e=!1},s.onerror=()=>{var i;t((null===(i=s.error)||void 0===i?void 0:i.message)||"")}}catch(e){t(e)}})}function DA(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}const zA=()=>{try{return function fpe(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if(typeof process>"u"||typeof process.env>"u")return;const n=process.env.__FIREBASE_DEFAULTS__;return n?JSON.parse(n):void 0})()||(()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=n&&bE(n[1]);return t&&JSON.parse(t)})()}catch(n){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`)}},gZ=n=>{var t,e;return null===(e=null===(t=zA())||void 0===t?void 0:t.emulatorHosts)||void 0===e?void 0:e[n]},mZ=n=>{var t;return null===(t=zA())||void 0===t?void 0:t[`_${n}`]};class OE{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}wrapCallback(t){return(e,r)=>{e?this.reject(e):this.resolve(r),"function"==typeof t&&(this.promise.catch(()=>{}),1===t.length?t(e):t(e,r))}}}class Ac extends Error{constructor(t,e,r){super(e),this.code=t,this.customData=r,this.name="FirebaseError",Object.setPrototypeOf(this,Ac.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,w4.prototype.create)}}class w4{constructor(t,e,r){this.service=t,this.serviceName=e,this.errors=r}create(t,...e){const r=e[0]||{},s=`${this.service}/${t}`,i=this.errors[t],o=i?function Cpe(n,t){return n.replace(ype,(e,r)=>{const s=t[r];return null!=s?String(s):`<${r}?>`})}(i,r):"Error";return new Ac(s,`${this.serviceName}: ${o} (${s}).`,r)}}const ype=/\{\$([^}]+)}/g;function AE(n,t){if(n===t)return!0;const e=Object.keys(n),r=Object.keys(t);for(const s of e){if(!r.includes(s))return!1;const i=n[s],o=t[s];if(vZ(i)&&vZ(o)){if(!AE(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!e.includes(s))return!1;return!0}function vZ(n){return null!==n&&"object"==typeof n}function Zp(n){const t=[];for(const[e,r]of Object.entries(n))Array.isArray(r)?r.forEach(s=>{t.push(encodeURIComponent(e)+"="+encodeURIComponent(s))}):t.push(encodeURIComponent(e)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}function Yp(n){const t={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,i]=r.split("=");t[decodeURIComponent(s)]=decodeURIComponent(i)}}),t}function Kp(n){const t=n.indexOf("?");if(!t)return"";const e=n.indexOf("#",t);return n.substring(t,e>0?e:void 0)}class Spe{constructor(t,e){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then(()=>{t(this)}).catch(r=>{this.error(r)})}next(t){this.forEachObserver(e=>{e.next(t)})}error(t){this.forEachObserver(e=>{e.error(t)}),this.close(t)}complete(){this.forEachObserver(t=>{t.complete()}),this.close()}subscribe(t,e,r){let s;if(void 0===t&&void 0===e&&void 0===r)throw new Error("Missing Observer.");s=function Ppe(n,t){if("object"!=typeof n||null===n)return!1;for(const e of t)if(e in n&&"function"==typeof n[e])return!0;return!1}(t,["next","error","complete"])?t:{next:t,error:e,complete:r},void 0===s.next&&(s.next=VA),void 0===s.error&&(s.error=VA),void 0===s.complete&&(s.complete=VA);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(t){void 0===this.observers||void 0===this.observers[t]||(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(t){if(!this.finalized)for(let e=0;e<this.observers.length;e++)this.sendOne(e,t)}sendOne(t,e){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[t])try{e(this.observers[t])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(t){this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function VA(){}function FA(n,t=1e3,e=2){const r=t*Math.pow(e,n),s=Math.round(.5*r*(Math.random()-.5)*2);return Math.min(144e5,r+s)}function Qr(n){return n&&n._delegate?n._delegate:n}class X2{constructor(t,e,r){this.name=t,this.instanceFactory=e,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}const Lu="[DEFAULT]";class Ape{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const r=new OE;if(this.instancesDeferred.set(e,r),this.isInitialized(e)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:e});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(e).promise}getImmediate(t){var e;const r=this.normalizeInstanceIdentifier(t?.identifier),s=null!==(e=t?.optional)&&void 0!==e&&e;if(!this.isInitialized(r)&&!this.shouldAutoInitialize()){if(s)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,this.shouldAutoInitialize()){if(function xpe(n){return"EAGER"===n.instantiationMode}(t))try{this.getOrInitializeService({instanceIdentifier:Lu})}catch{}for(const[e,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(e);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(t=Lu){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}delete(){var t=this;return A(function*(){const e=Array.from(t.instances.values());yield Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])})()}isComponentSet(){return null!=this.component}isInitialized(t=Lu){return this.instances.has(t)}getOptions(t=Lu){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,r=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:e});for(const[i,o]of this.instancesDeferred.entries())r===this.normalizeInstanceIdentifier(i)&&o.resolve(s);return s}onInit(t,e){var r;const s=this.normalizeInstanceIdentifier(e),i=null!==(r=this.onInitCallbacks.get(s))&&void 0!==r?r:new Set;i.add(t),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&t(o,s),()=>{i.delete(t)}}invokeOnInitCallbacks(t,e){const r=this.onInitCallbacks.get(e);if(r)for(const s of r)try{s(t,e)}catch{}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let r=this.instances.get(t);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:(n=t,n===Lu?void 0:n),options:e}),this.instances.set(t,r),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(r,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,r)}catch{}var n;return r||null}normalizeInstanceIdentifier(t=Lu){return this.component?this.component.multipleInstances?t:Lu:t}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class kpe{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new Ape(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}const BA=[];var g1=(()=>{return(n=g1||(g1={}))[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",g1;var n})();const CZ={debug:g1.DEBUG,verbose:g1.VERBOSE,info:g1.INFO,warn:g1.WARN,error:g1.ERROR,silent:g1.SILENT},Lpe=g1.INFO,Rpe={[g1.DEBUG]:"log",[g1.VERBOSE]:"log",[g1.INFO]:"info",[g1.WARN]:"warn",[g1.ERROR]:"error"},Dpe=(n,t,...e)=>{if(t<n.logLevel)return;const r=(new Date).toISOString(),s=Rpe[t];if(!s)throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`);console[s](`[${r}]  ${n.name}:`,...e)};class yf{constructor(t){this.name=t,this._logLevel=Lpe,this._logHandler=Dpe,this._userLogHandler=null,BA.push(this)}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in g1))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel="string"==typeof t?CZ[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,g1.DEBUG,...t),this._logHandler(this,g1.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,g1.VERBOSE,...t),this._logHandler(this,g1.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,g1.INFO,...t),this._logHandler(this,g1.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,g1.WARN,...t),this._logHandler(this,g1.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,g1.ERROR,...t),this._logHandler(this,g1.ERROR,...t)}}let yZ,EZ;const MZ=new WeakMap,$A=new WeakMap,SZ=new WeakMap,UA=new WeakMap,GA=new WeakMap;let WA={get(n,t,e){if(n instanceof IDBTransaction){if("done"===t)return $A.get(n);if("objectStoreNames"===t)return n.objectStoreNames||SZ.get(n);if("store"===t)return e.objectStoreNames[1]?void 0:e.objectStore(e.objectStoreNames[0])}return Hl(n[t])},set:(n,t,e)=>(n[t]=e,!0),has:(n,t)=>n instanceof IDBTransaction&&("done"===t||"store"===t)||t in n};function Gpe(n){return"function"==typeof n?function Upe(n){return n!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function Hpe(){return EZ||(EZ=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(n)?function(...t){return n.apply(qA(this),t),Hl(MZ.get(this))}:function(...t){return Hl(n.apply(qA(this),t))}:function(t,...e){const r=n.call(qA(this),t,...e);return SZ.set(r,t.sort?t.sort():[t]),Hl(r)}}(n):(n instanceof IDBTransaction&&function Bpe(n){if($A.has(n))return;const t=new Promise((e,r)=>{const s=()=>{n.removeEventListener("complete",i),n.removeEventListener("error",o),n.removeEventListener("abort",o)},i=()=>{e(),s()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",i),n.addEventListener("error",o),n.addEventListener("abort",o)});$A.set(n,t)}(n),((n,t)=>t.some(e=>n instanceof e))(n,function Vpe(){return yZ||(yZ=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(n,WA):n)}function Hl(n){if(n instanceof IDBRequest)return function Fpe(n){const t=new Promise((e,r)=>{const s=()=>{n.removeEventListener("success",i),n.removeEventListener("error",o)},i=()=>{e(Hl(n.result)),s()},o=()=>{r(n.error),s()};n.addEventListener("success",i),n.addEventListener("error",o)});return t.then(e=>{e instanceof IDBCursor&&MZ.set(e,n)}).catch(()=>{}),GA.set(t,n),t}(n);if(UA.has(n))return UA.get(n);const t=Gpe(n);return t!==n&&(UA.set(n,t),GA.set(t,n)),t}const qA=n=>GA.get(n);function IE(n,t,{blocked:e,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(n,t),c=Hl(o);return r&&o.addEventListener("upgradeneeded",u=>{r(Hl(o.result),u.oldVersion,u.newVersion,Hl(o.transaction))}),e&&o.addEventListener("blocked",()=>e()),c.then(u=>{i&&u.addEventListener("close",()=>i()),s&&u.addEventListener("versionchange",()=>s())}).catch(()=>{}),c}function jA(n,{blocked:t}={}){const e=indexedDB.deleteDatabase(n);return t&&e.addEventListener("blocked",()=>t()),Hl(e).then(()=>{})}const Wpe=["get","getKey","getAll","getAllKeys","count"],qpe=["put","add","delete","clear"],ZA=new Map;function PZ(n,t){if(!(n instanceof IDBDatabase)||t in n||"string"!=typeof t)return;if(ZA.get(t))return ZA.get(t);const e=t.replace(/FromIndex$/,""),r=t!==e,s=qpe.includes(e);if(!(e in(r?IDBIndex:IDBObjectStore).prototype)||!s&&!Wpe.includes(e))return;const i=function(){var o=A(function*(c,...u){const h=this.transaction(c,s?"readwrite":"readonly");let p=h.store;return r&&(p=p.index(u.shift())),(yield Promise.all([p[e](...u),s&&h.done]))[0]});return function(u){return o.apply(this,arguments)}}();return ZA.set(t,i),i}!function $pe(n){WA=n(WA)}(n=>({...n,get:(t,e,r)=>PZ(t,e)||n.get(t,e,r),has:(t,e)=>!!PZ(t,e)||n.has(t,e)}));class jpe{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(function Zpe(n){return"VERSION"===n.getComponent()?.type}(e)){const r=e.getImmediate();return`${r.library}/${r.version}`}return null}).filter(e=>e).join(" ")}}const YA="@firebase/app",Ru=new yf("@firebase/app"),xE="[DEFAULT]",yge={[YA]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},Du=new Map,kE=new Map;function Ege(n,t){try{n.container.addComponent(t)}catch(e){Ru.debug(`Component ${t.name} failed to register with FirebaseApp ${n.name}`,e)}}function Oo(n){const t=n.name;if(kE.has(t))return Ru.debug(`There were multiple attempts to register component ${t}.`),!1;kE.set(t,n);for(const e of Du.values())Ege(e,n);return!0}function Ef(n,t){const e=n.container.getProvider("heartbeat").getImmediate({optional:!0});return e&&e.triggerHeartbeat(),n.container.getProvider(t)}const Fl=new w4("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class Sge{constructor(t,e,r){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},e),this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new X2("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw Fl.create("app-deleted",{appName:this._name})}}const Mf="9.14.0";function wZ(n,t={}){let e=n;"object"!=typeof t&&(t={name:t});const r=Object.assign({name:xE,automaticDataCollectionEnabled:!1},t),s=r.name;if("string"!=typeof s||!s)throw Fl.create("bad-app-name",{appName:String(s)});if(e||(e=(()=>{var n;return null===(n=zA())||void 0===n?void 0:n.config})()),!e)throw Fl.create("no-options");const i=Du.get(s);if(i){if(AE(e,i.options)&&AE(r,i.config))return i;throw Fl.create("duplicate-app",{appName:s})}const o=new kpe(s);for(const u of kE.values())o.addComponent(u);const c=new Sge(e,r,o);return Du.set(s,c),c}function KA(n=xE){const t=Du.get(n);if(!t&&n===xE)return wZ();if(!t)throw Fl.create("no-app",{appName:n});return t}function bZ(){return Array.from(Du.values())}function fs(n,t,e){var r;let s=null!==(r=yge[n])&&void 0!==r?r:n;e&&(s+=`-${e}`);const i=s.match(/\s|\//),o=t.match(/\s|\//);if(i||o){const c=[`Unable to register library "${s}" with version "${t}":`];return i&&c.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&c.push("and"),o&&c.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void Ru.warn(c.join(" "))}Oo(new X2(`${s}-version`,()=>({library:s,version:t}),"VERSION"))}const Xp="firebase-heartbeat-store";let QA=null;function OZ(){return QA||(QA=IE("firebase-heartbeat-database",1,{upgrade:(n,t)=>{0===t&&n.createObjectStore(Xp)}}).catch(n=>{throw Fl.create("idb-open",{originalErrorMessage:n.message})})),QA}function JA(){return(JA=A(function*(n){var t;try{return(yield OZ()).transaction(Xp).objectStore(Xp).get(AZ(n))}catch(e){if(e instanceof Ac)Ru.warn(e.message);else{const r=Fl.create("idb-get",{originalErrorMessage:null===(t=e)||void 0===t?void 0:t.message});Ru.warn(r.message)}}})).apply(this,arguments)}function NZ(n,t){return eI.apply(this,arguments)}function eI(){return(eI=A(function*(n,t){var e;try{const s=(yield OZ()).transaction(Xp,"readwrite");return yield s.objectStore(Xp).put(t,AZ(n)),s.done}catch(r){if(r instanceof Ac)Ru.warn(r.message);else{const s=Fl.create("idb-set",{originalErrorMessage:null===(e=r)||void 0===e?void 0:e.message});Ru.warn(s.message)}}})).apply(this,arguments)}function AZ(n){return`${n.name}!${n.options.appId}`}class Nge{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new Ige(e),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}triggerHeartbeat(){var t=this;return A(function*(){const r=t.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=IZ();if(null===t._heartbeatsCache&&(t._heartbeatsCache=yield t._heartbeatsCachePromise),t._heartbeatsCache.lastSentHeartbeatDate!==s&&!t._heartbeatsCache.heartbeats.some(i=>i.date===s))return t._heartbeatsCache.heartbeats.push({date:s,agent:r}),t._heartbeatsCache.heartbeats=t._heartbeatsCache.heartbeats.filter(i=>{const o=new Date(i.date).valueOf();return Date.now()-o<=2592e6}),t._storage.overwrite(t._heartbeatsCache)})()}getHeartbeatsHeader(){var t=this;return A(function*(){if(null===t._heartbeatsCache&&(yield t._heartbeatsCachePromise),null===t._heartbeatsCache||0===t._heartbeatsCache.heartbeats.length)return"";const e=IZ(),{heartbeatsToSend:r,unsentEntries:s}=function Age(n,t=1024){const e=[];let r=n.slice();for(const s of n){const i=e.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),xZ(e)>t){i.dates.pop();break}}else if(e.push({agent:s.agent,dates:[s.date]}),xZ(e)>t){e.pop();break}r=r.slice(1)}return{heartbeatsToSend:e,unsentEntries:r}}(t._heartbeatsCache.heartbeats),i=wE(JSON.stringify({version:2,heartbeats:r}));return t._heartbeatsCache.lastSentHeartbeatDate=e,s.length>0?(t._heartbeatsCache.heartbeats=s,yield t._storage.overwrite(t._heartbeatsCache)):(t._heartbeatsCache.heartbeats=[],t._storage.overwrite(t._heartbeatsCache)),i})()}}function IZ(){return(new Date).toISOString().substring(0,10)}class Ige{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return A(function*(){return!!ku()&&jp().then(()=>!0).catch(()=>!1)})()}read(){var t=this;return A(function*(){return(yield t._canUseIndexedDBPromise)&&(yield function wge(n){return JA.apply(this,arguments)}(t.app))||{heartbeats:[]}})()}overwrite(t){var e=this;return A(function*(){var r;if(yield e._canUseIndexedDBPromise){const i=yield e.read();return NZ(e.app,{lastSentHeartbeatDate:null!==(r=t.lastSentHeartbeatDate)&&void 0!==r?r:i.lastSentHeartbeatDate,heartbeats:t.heartbeats})}})()}add(t){var e=this;return A(function*(){var r;if(yield e._canUseIndexedDBPromise){const i=yield e.read();return NZ(e.app,{lastSentHeartbeatDate:null!==(r=t.lastSentHeartbeatDate)&&void 0!==r?r:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...t.heartbeats]})}})()}}function xZ(n){return wE(JSON.stringify({version:2,heartbeats:n})).length}!function xge(n){Oo(new X2("platform-logger",t=>new jpe(t),"PRIVATE")),Oo(new X2("heartbeat",t=>new Nge(t),"PRIVATE")),fs(YA,"0.8.4",n),fs(YA,"0.8.4","esm2017"),fs("fire-js","")}("");var Nt,kge=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Bl={},tI=tI||{},_n=kge||self;function LE(){}function RE(n){var t=typeof n;return"array"==(t="object"!=t?t:n?Array.isArray(n)?"array":t:"null")||"object"==t&&"number"==typeof n.length}function Qp(n){var t=typeof n;return"object"==t&&null!=n||"function"==t}var nI="closure_uid_"+(1e9*Math.random()>>>0),Rge=0;function Dge(n,t,e){return n.call.apply(n.bind,arguments)}function zge(n,t,e){if(!n)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var s=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(s,r),n.apply(t,s)}}return function(){return n.apply(t,arguments)}}function Q2(n,t,e){return(Q2=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Dge:zge).apply(null,arguments)}function DE(n,t){var e=Array.prototype.slice.call(arguments,1);return function(){var r=e.slice();return r.push.apply(r,arguments),n.apply(this,r)}}function y2(n,t){function e(){}e.prototype=t.prototype,n.X=t.prototype,n.prototype=new e,n.prototype.constructor=n,n.Wb=function(r,s,i){for(var o=Array(arguments.length-2),c=2;c<arguments.length;c++)o[c-2]=arguments[c];return t.prototype[s].apply(r,o)}}function N0(){this.s=this.s,this.o=this.o}N0.prototype.s=!1,N0.prototype.na=function(){!this.s&&(this.s=!0,this.M(),0)&&function Lge(n){Object.prototype.hasOwnProperty.call(n,nI)&&n[nI]||(n[nI]=++Rge)}(this)},N0.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const kZ=Array.prototype.indexOf?function(n,t){return Array.prototype.indexOf.call(n,t,void 0)}:function(n,t){if("string"==typeof n)return"string"!=typeof t||1!=t.length?-1:n.indexOf(t,0);for(let e=0;e<n.length;e++)if(e in n&&n[e]===t)return e;return-1};function rI(n){const t=n.length;if(0<t){const e=Array(t);for(let r=0;r<t;r++)e[r]=n[r];return e}return[]}function LZ(n,t){for(let e=1;e<arguments.length;e++){const r=arguments[e];if(RE(r)){const s=n.length||0,i=r.length||0;n.length=s+i;for(let o=0;o<i;o++)n[s+o]=r[o]}else n.push(r)}}function J2(n,t){this.type=n,this.g=this.target=t,this.defaultPrevented=!1}J2.prototype.h=function(){this.defaultPrevented=!0};var Hge=function(){if(!_n.addEventListener||!Object.defineProperty)return!1;var n=!1,t=Object.defineProperty({},"passive",{get:function(){n=!0}});try{_n.addEventListener("test",LE,t),_n.removeEventListener("test",LE,t)}catch{}return n}();function zE(n){return/^[\s\xa0]*$/.test(n)}var RZ=String.prototype.trim?function(n){return n.trim()}:function(n){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(n)[1]};function sI(n,t){return n<t?-1:n>t?1:0}function VE(){var n=_n.navigator;return n&&(n=n.userAgent)?n:""}function b4(n){return-1!=VE().indexOf(n)}function iI(n){return iI[" "](n),n}iI[" "]=LE;var HE,n,Bge=b4("Opera"),Sf=b4("Trident")||b4("MSIE"),DZ=b4("Edge"),oI=DZ||Sf,zZ=b4("Gecko")&&!(-1!=VE().toLowerCase().indexOf("webkit")&&!b4("Edge"))&&!(b4("Trident")||b4("MSIE"))&&!b4("Edge"),$ge=-1!=VE().toLowerCase().indexOf("webkit")&&!b4("Edge");function VZ(){var n=_n.document;return n?n.documentMode:void 0}e:{var aI="",cI=(n=VE(),zZ?/rv:([^\);]+)(\)|;)/.exec(n):DZ?/Edge\/([\d\.]+)/.exec(n):Sf?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(n):$ge?/WebKit\/(\S+)/.exec(n):Bge?/(?:Version)[ \/]?(\S+)/.exec(n):void 0);if(cI&&(aI=cI?cI[1]:""),Sf){var lI=VZ();if(null!=lI&&lI>parseFloat(aI)){HE=String(lI);break e}}HE=aI}var Uge={};var Wge=_n.document&&Sf&&(VZ()||parseInt(HE,10))||void 0;function Jp(n,t){if(J2.call(this,n?n.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,n){var e=this.type=n.type,r=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:null;if(this.target=n.target||n.srcElement,this.g=t,t=n.relatedTarget){if(zZ){e:{try{iI(t.nodeName);var s=!0;break e}catch{}s=!1}s||(t=null)}}else"mouseover"==e?t=n.fromElement:"mouseout"==e&&(t=n.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==n.clientX?n.clientX:n.pageX,this.clientY=void 0!==n.clientY?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0),this.button=n.button,this.key=n.key||"",this.ctrlKey=n.ctrlKey,this.altKey=n.altKey,this.shiftKey=n.shiftKey,this.metaKey=n.metaKey,this.pointerId=n.pointerId||0,this.pointerType="string"==typeof n.pointerType?n.pointerType:qge[n.pointerType]||"",this.state=n.state,this.i=n,n.defaultPrevented&&Jp.X.h.call(this)}}y2(Jp,J2);var qge={2:"touch",3:"pen",4:"mouse"};Jp.prototype.h=function(){Jp.X.h.call(this);var n=this.i;n.preventDefault?n.preventDefault():n.returnValue=!1};var eg="closure_listenable_"+(1e6*Math.random()|0),jge=0;function Zge(n,t,e,r,s){this.listener=n,this.proxy=null,this.src=t,this.type=e,this.capture=!!r,this.ha=s,this.key=++jge,this.ba=this.ea=!1}function FE(n){n.ba=!0,n.listener=null,n.proxy=null,n.src=null,n.ha=null}function fI(n,t,e){for(const r in n)t.call(e,n[r],r,n)}function FZ(n){const t={};for(const e in n)t[e]=n[e];return t}const BZ="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function $Z(n,t){let e,r;for(let s=1;s<arguments.length;s++){for(e in r=arguments[s],r)n[e]=r[e];for(let i=0;i<BZ.length;i++)e=BZ[i],Object.prototype.hasOwnProperty.call(r,e)&&(n[e]=r[e])}}function BE(n){this.src=n,this.g={},this.h=0}function hI(n,t){var e=t.type;if(e in n.g){var i,r=n.g[e],s=kZ(r,t);(i=0<=s)&&Array.prototype.splice.call(r,s,1),i&&(FE(t),0==n.g[e].length&&(delete n.g[e],n.h--))}}function dI(n,t,e,r){for(var s=0;s<n.length;++s){var i=n[s];if(!i.ba&&i.listener==t&&i.capture==!!e&&i.ha==r)return s}return-1}BE.prototype.add=function(n,t,e,r,s){var i=n.toString();(n=this.g[i])||(n=this.g[i]=[],this.h++);var o=dI(n,t,r,s);return-1<o?(t=n[o],e||(t.ea=!1)):((t=new Zge(t,this.src,i,!!r,s)).ea=e,n.push(t)),t};var pI="closure_lm_"+(1e6*Math.random()|0),gI={};function UZ(n,t,e,r,s){if(r&&r.once)return WZ(n,t,e,r,s);if(Array.isArray(t)){for(var i=0;i<t.length;i++)UZ(n,t[i],e,r,s);return null}return e=CI(e),n&&n[eg]?n.N(t,e,Qp(r)?!!r.capture:!!r,s):GZ(n,t,e,!1,r,s)}function GZ(n,t,e,r,s,i){if(!t)throw Error("Invalid event type");var o=Qp(s)?!!s.capture:!!s,c=_I(n);if(c||(n[pI]=c=new BE(n)),(e=c.add(t,e,r,o,i)).proxy)return e;if(r=function Yge(){const t=Kge;return function n(e){return t.call(n.src,n.listener,e)}}(),e.proxy=r,r.src=n,r.listener=e,n.addEventListener)Hge||(s=o),void 0===s&&(s=!1),n.addEventListener(t.toString(),r,s);else if(n.attachEvent)n.attachEvent(jZ(t.toString()),r);else{if(!n.addListener||!n.removeListener)throw Error("addEventListener and attachEvent are unavailable.");n.addListener(r)}return e}function WZ(n,t,e,r,s){if(Array.isArray(t)){for(var i=0;i<t.length;i++)WZ(n,t[i],e,r,s);return null}return e=CI(e),n&&n[eg]?n.O(t,e,Qp(r)?!!r.capture:!!r,s):GZ(n,t,e,!0,r,s)}function qZ(n,t,e,r,s){if(Array.isArray(t))for(var i=0;i<t.length;i++)qZ(n,t[i],e,r,s);else r=Qp(r)?!!r.capture:!!r,e=CI(e),n&&n[eg]?(n=n.i,(t=String(t).toString())in n.g&&-1<(e=dI(i=n.g[t],e,r,s))&&(FE(i[e]),Array.prototype.splice.call(i,e,1),0==i.length&&(delete n.g[t],n.h--))):n&&(n=_I(n))&&(t=n.g[t.toString()],n=-1,t&&(n=dI(t,e,r,s)),(e=-1<n?t[n]:null)&&mI(e))}function mI(n){if("number"!=typeof n&&n&&!n.ba){var t=n.src;if(t&&t[eg])hI(t.i,n);else{var e=n.type,r=n.proxy;t.removeEventListener?t.removeEventListener(e,r,n.capture):t.detachEvent?t.detachEvent(jZ(e),r):t.addListener&&t.removeListener&&t.removeListener(r),(e=_I(t))?(hI(e,n),0==e.h&&(e.src=null,t[pI]=null)):FE(n)}}}function jZ(n){return n in gI?gI[n]:gI[n]="on"+n}function Kge(n,t){if(n.ba)n=!0;else{t=new Jp(t,this);var e=n.listener,r=n.ha||n.src;n.ea&&mI(n),n=e.call(r,t)}return n}function _I(n){return(n=n[pI])instanceof BE?n:null}var vI="__closure_events_fn_"+(1e9*Math.random()>>>0);function CI(n){return"function"==typeof n?n:(n[vI]||(n[vI]=function(t){return n.handleEvent(t)}),n[vI])}function Vi(){N0.call(this),this.i=new BE(this),this.P=this,this.I=null}function E2(n,t){var e,r=n.I;if(r)for(e=[];r;r=r.I)e.push(r);if(n=n.P,r=t.type||t,"string"==typeof t)t=new J2(t,n);else if(t instanceof J2)t.target=t.target||n;else{var s=t;$Z(t=new J2(r,n),s)}if(s=!0,e)for(var i=e.length-1;0<=i;i--){var o=t.g=e[i];s=$E(o,r,!0,t)&&s}if(s=$E(o=t.g=n,r,!0,t)&&s,s=$E(o,r,!1,t)&&s,e)for(i=0;i<e.length;i++)s=$E(o=t.g=e[i],r,!1,t)&&s}function $E(n,t,e,r){if(!(t=n.i.g[String(t)]))return!0;t=t.concat();for(var s=!0,i=0;i<t.length;++i){var o=t[i];if(o&&!o.ba&&o.capture==e){var c=o.listener,u=o.ha||o.src;o.ea&&hI(n.i,o),s=!1!==c.call(u,r)&&s}}return s&&!r.defaultPrevented}y2(Vi,N0),Vi.prototype[eg]=!0,Vi.prototype.removeEventListener=function(n,t,e,r){qZ(this,n,t,e,r)},Vi.prototype.M=function(){if(Vi.X.M.call(this),this.i){var t,n=this.i;for(t in n.g){for(var e=n.g[t],r=0;r<e.length;r++)FE(e[r]);delete n.g[t],n.h--}}this.I=null},Vi.prototype.N=function(n,t,e,r){return this.i.add(String(n),t,!1,e,r)},Vi.prototype.O=function(n,t,e,r){return this.i.add(String(n),t,!0,e,r)};var yI=_n.JSON.stringify;function Xge(){var n=KZ;let t=null;return n.g&&(t=n.g,n.g=n.g.next,n.g||(n.h=null),t.next=null),t}var EI,ZZ=new class{constructor(n,t){this.i=n,this.j=t,this.h=0,this.g=null}get(){let n;return 0<this.h?(this.h--,n=this.g,this.g=n.next,n.next=null):n=this.i(),n}}(()=>new Jge,n=>n.reset());class Jge{constructor(){this.next=this.g=this.h=null}set(t,e){this.h=t,this.g=e,this.next=null}reset(){this.next=this.g=this.h=null}}function eme(n){_n.setTimeout(()=>{throw n},0)}function YZ(n,t){EI||function tme(){var n=_n.Promise.resolve(void 0);EI=function(){n.then(nme)}}(),MI||(EI(),MI=!0),KZ.add(n,t)}var MI=!1,KZ=new class Qge{constructor(){this.h=this.g=null}add(t,e){const r=ZZ.get();r.set(t,e),this.h?this.h.next=r:this.g=r,this.h=r}};function nme(){for(var n;n=Xge();){try{n.h.call(n.g)}catch(e){eme(e)}var t=ZZ;t.j(n),100>t.h&&(t.h++,n.next=t.g,t.g=n)}MI=!1}function UE(n,t){Vi.call(this),this.h=n||1,this.g=t||_n,this.j=Q2(this.lb,this),this.l=Date.now()}function SI(n){n.ca=!1,n.R&&(n.g.clearTimeout(n.R),n.R=null)}function PI(n,t,e){if("function"==typeof n)e&&(n=Q2(n,e));else{if(!n||"function"!=typeof n.handleEvent)throw Error("Invalid listener argument");n=Q2(n.handleEvent,n)}return 2147483647<Number(t)?-1:_n.setTimeout(n,t||0)}function XZ(n){n.g=PI(()=>{n.g=null,n.i&&(n.i=!1,XZ(n))},n.j);const t=n.h;n.h=null,n.m.apply(null,t)}y2(UE,Vi),(Nt=UE.prototype).ca=!1,Nt.R=null,Nt.lb=function(){if(this.ca){var n=Date.now()-this.l;0<n&&n<.8*this.h?this.R=this.g.setTimeout(this.j,this.h-n):(this.R&&(this.g.clearTimeout(this.R),this.R=null),E2(this,"tick"),this.ca&&(SI(this),this.start()))}},Nt.start=function(){this.ca=!0,this.R||(this.R=this.g.setTimeout(this.j,this.h),this.l=Date.now())},Nt.M=function(){UE.X.M.call(this),SI(this),delete this.g};class rme extends N0{constructor(t,e){super(),this.m=t,this.j=e,this.h=null,this.i=!1,this.g=null}l(t){this.h=arguments,this.g?this.i=!0:XZ(this)}M(){super.M(),this.g&&(_n.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function tg(n){N0.call(this),this.h=n,this.g={}}y2(tg,N0);var QZ=[];function JZ(n,t,e,r){Array.isArray(e)||(e&&(QZ[0]=e.toString()),e=QZ);for(var s=0;s<e.length;s++){var i=UZ(t,e[s],r||n.handleEvent,!1,n.h||n);if(!i)break;n.g[i.key]=i}}function eY(n){fI(n.g,function(t,e){this.g.hasOwnProperty(e)&&mI(t)},n),n.g={}}function GE(){this.g=!0}function Pf(n,t,e,r){n.info(function(){return"XMLHTTP TEXT ("+t+"): "+function ame(n,t){if(!n.g)return t;if(!t)return null;try{var e=JSON.parse(t);if(e)for(n=0;n<e.length;n++)if(Array.isArray(e[n])){var r=e[n];if(!(2>r.length)){var s=r[1];if(Array.isArray(s)&&!(1>s.length)){var i=s[0];if("noop"!=i&&"stop"!=i&&"close"!=i)for(var o=1;o<s.length;o++)s[o]=""}}}return yI(e)}catch{return t}}(n,e)+(r?" "+r:"")})}tg.prototype.M=function(){tg.X.M.call(this),eY(this)},tg.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},GE.prototype.Aa=function(){this.g=!1},GE.prototype.info=function(){};var zu={},tY=null;function WE(){return tY=tY||new Vi}function nY(n){J2.call(this,zu.Pa,n)}function ng(n){const t=WE();E2(t,new nY(t))}function rY(n,t){J2.call(this,zu.STAT_EVENT,n),this.stat=t}function No(n){const t=WE();E2(t,new rY(t,n))}function sY(n,t){J2.call(this,zu.Qa,n),this.size=t}function rg(n,t){if("function"!=typeof n)throw Error("Fn must not be null and must be a function");return _n.setTimeout(function(){n()},t)}zu.Pa="serverreachability",y2(nY,J2),zu.STAT_EVENT="statevent",y2(rY,J2),zu.Qa="timingevent",y2(sY,J2);var qE={NO_ERROR:0,mb:1,zb:2,yb:3,tb:4,xb:5,Ab:6,Ma:7,TIMEOUT:8,Db:9},iY={rb:"complete",Nb:"success",Na:"error",Ma:"abort",Fb:"ready",Gb:"readystatechange",TIMEOUT:"timeout",Bb:"incrementaldata",Eb:"progress",ub:"downloadprogress",Vb:"uploadprogress"};function TI(){}function aY(){}TI.prototype.h=null;var OI,sg={OPEN:"a",qb:"b",Na:"c",Cb:"d"};function wI(){J2.call(this,"d")}function bI(){J2.call(this,"c")}function jE(){}function ig(n,t,e,r){this.l=n,this.j=t,this.m=e,this.U=r||1,this.S=new tg(this),this.O=cme,this.T=new UE(n=oI?125:void 0),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.V=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.Y=-1,this.I=!1,this.N=0,this.L=null,this.$=this.J=this.Z=this.P=!1,this.h=new cY}function cY(){this.i=null,this.g="",this.h=!1}y2(wI,J2),y2(bI,J2),y2(jE,TI),jE.prototype.g=function(){return new XMLHttpRequest},jE.prototype.i=function(){return{}},OI=new jE;var cme=45e3,NI={},ZE={};function AI(n,t,e){n.K=1,n.v=QE($l(t)),n.s=e,n.P=!0,lY(n,null)}function lY(n,t){n.F=Date.now(),og(n),n.A=$l(n.v);var e=n.A,r=n.U;Array.isArray(r)||(r=[String(r)]),CY(e.i,"t",r),n.C=0,e=n.l.H,n.h=new cY,n.g=UY(n.l,e?t:null,!n.s),0<n.N&&(n.L=new rme(Q2(n.La,n,n.g),n.N)),JZ(n.S,n.g,"readystatechange",n.ib),t=n.H?FZ(n.H):{},n.s?(n.u||(n.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",n.g.da(n.A,n.u,n.s,t)):(n.u="GET",n.g.da(n.A,n.u,null,t)),ng(),function sme(n,t,e,r,s,i){n.info(function(){if(n.g)if(i)for(var o="",c=i.split("&"),u=0;u<c.length;u++){var h=c[u].split("=");if(1<h.length){var p=h[0];h=h[1];var m=p.split("_");o=2<=m.length&&"type"==m[1]?o+(p+"=")+h+"&":o+(p+"=redacted&")}}else o=null;else o=i;return"XMLHTTP REQ ("+r+") [attempt "+s+"]: "+t+"\n"+e+"\n"+o})}(n.j,n.u,n.A,n.m,n.U,n.s)}function uY(n){return!!n.g&&"GET"==n.u&&2!=n.K&&n.l.Da}function fY(n,t,e){let s,r=!0;for(;!n.I&&n.C<e.length;){if(s=lme(n,e),s==ZE){4==t&&(n.o=4,No(14),r=!1),Pf(n.j,n.m,null,"[Incomplete Response]");break}if(s==NI){n.o=4,No(15),Pf(n.j,n.m,e,"[Invalid Chunk]"),r=!1;break}Pf(n.j,n.m,s,null),II(n,s)}uY(n)&&s!=ZE&&s!=NI&&(n.h.g="",n.C=0),4!=t||0!=e.length||n.h.h||(n.o=1,No(16),r=!1),n.i=n.i&&r,r?0<e.length&&!n.$&&(n.$=!0,(t=n.l).g==n&&t.$&&!t.K&&(t.j.info("Great, no buffering proxy detected. Bytes received: "+e.length),HI(t),t.K=!0,No(11))):(Pf(n.j,n.m,e,"[Invalid Chunked Response]"),Vu(n),ag(n))}function lme(n,t){var e=n.C,r=t.indexOf("\n",e);return-1==r?ZE:(e=Number(t.substring(e,r)),isNaN(e)?NI:(r+=1)+e>t.length?ZE:(t=t.substr(r,e),n.C=r+e,t))}function og(n){n.V=Date.now()+n.O,hY(n,n.O)}function hY(n,t){if(null!=n.B)throw Error("WatchDog timer not null");n.B=rg(Q2(n.gb,n),t)}function YE(n){n.B&&(_n.clearTimeout(n.B),n.B=null)}function ag(n){0==n.l.G||n.I||HY(n.l,n)}function Vu(n){YE(n);var t=n.L;t&&"function"==typeof t.na&&t.na(),n.L=null,SI(n.T),eY(n.S),n.g&&(t=n.g,n.g=null,t.abort(),t.na())}function II(n,t){try{var e=n.l;if(0!=e.G&&(e.g==n||xI(e.h,n)))if(!n.J&&xI(e.h,n)&&3==e.G){try{var r=e.Fa.g.parse(t)}catch{r=null}if(Array.isArray(r)&&3==r.length){var s=r;if(0==s[0]){e:if(!e.u){if(e.g){if(!(e.g.F+3e3<n.F))break e;sM(e),nM(e)}VI(e),No(18)}}else e.Ba=s[1],0<e.Ba-e.T&&37500>s[2]&&e.L&&0==e.A&&!e.v&&(e.v=rg(Q2(e.cb,e),6e3));if(1>=MY(e.h)&&e.ja){try{e.ja()}catch{}e.ja=void 0}}else Fu(e,11)}else if((n.J||e.g==n)&&sM(e),!zE(t))for(s=e.Fa.g.parse(t),t=0;t<s.length;t++){let h=s[t];if(e.T=h[0],h=h[1],2==e.G)if("c"==h[0]){e.I=h[1],e.ka=h[2];const p=h[3];null!=p&&(e.ma=p,e.j.info("VER="+e.ma));const m=h[4];null!=m&&(e.Ca=m,e.j.info("SVER="+e.Ca));const C=h[5];null!=C&&"number"==typeof C&&0<C&&(e.J=r=1.5*C,e.j.info("backChannelRequestTimeoutMs_="+r)),r=e;const w=n.g;if(w){const I=w.g?w.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(I){var i=r.h;i.g||-1==I.indexOf("spdy")&&-1==I.indexOf("quic")&&-1==I.indexOf("h2")||(i.j=i.l,i.g=new Set,i.h&&(kI(i,i.h),i.h=null))}if(r.D){const H=w.g?w.g.getResponseHeader("X-HTTP-Session-Id"):null;H&&(r.za=H,Hr(r.F,r.D,H))}}e.G=3,e.l&&e.l.xa(),e.$&&(e.P=Date.now()-n.F,e.j.info("Handshake RTT: "+e.P+"ms"));var o=n;if((r=e).sa=$Y(r,r.H?r.ka:null,r.V),o.J){SY(r.h,o);var c=o,u=r.J;u&&c.setTimeout(u),c.B&&(YE(c),og(c)),r.g=o}else zY(r);0<e.i.length&&rM(e)}else"stop"!=h[0]&&"close"!=h[0]||Fu(e,7);else 3==e.G&&("stop"==h[0]||"close"==h[0]?"stop"==h[0]?Fu(e,7):zI(e):"noop"!=h[0]&&e.l&&e.l.wa(h),e.A=0)}ng()}catch{}}function dY(n,t){if(n.forEach&&"function"==typeof n.forEach)n.forEach(t,void 0);else if(RE(n)||"string"==typeof n)Array.prototype.forEach.call(n,t,void 0);else for(var e=function fme(n){if(n.oa&&"function"==typeof n.oa)return n.oa();if(!n.W||"function"!=typeof n.W){if(typeof Map<"u"&&n instanceof Map)return Array.from(n.keys());if(!(typeof Set<"u"&&n instanceof Set)){if(RE(n)||"string"==typeof n){var t=[];n=n.length;for(var e=0;e<n;e++)t.push(e);return t}t=[],e=0;for(const r in n)t[e++]=r;return t}}}(n),r=function ume(n){if(n.W&&"function"==typeof n.W)return n.W();if(typeof Map<"u"&&n instanceof Map||typeof Set<"u"&&n instanceof Set)return Array.from(n.values());if("string"==typeof n)return n.split("");if(RE(n)){for(var t=[],e=n.length,r=0;r<e;r++)t.push(n[r]);return t}for(r in t=[],e=0,n)t[e++]=n[r];return t}(n),s=r.length,i=0;i<s;i++)t.call(void 0,r[i],e&&e[i],n)}(Nt=ig.prototype).setTimeout=function(n){this.O=n},Nt.ib=function(n){n=n.target;const t=this.L;t&&3==Ul(n)?t.l():this.La(n)},Nt.La=function(n){try{if(n==this.g)e:{const p=Ul(this.g);var t=this.g.Ea();if(this.g.aa(),!(3>p)&&(3!=p||oI||this.g&&(this.h.h||this.g.fa()||IY(this.g)))){this.I||4!=p||7==t||ng(),YE(this);var e=this.g.aa();this.Y=e;t:if(uY(this)){var r=IY(this.g);n="";var s=r.length,i=4==Ul(this.g);if(!this.h.i){if(typeof TextDecoder>"u"){Vu(this),ag(this);var o="";break t}this.h.i=new _n.TextDecoder}for(t=0;t<s;t++)this.h.h=!0,n+=this.h.i.decode(r[t],{stream:i&&t==s-1});r.splice(0,s),this.h.g+=n,this.C=0,o=this.h.g}else o=this.g.fa();if(this.i=200==e,function ime(n,t,e,r,s,i,o){n.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+s+"]: "+t+"\n"+e+"\n"+i+" "+o})}(this.j,this.u,this.A,this.m,this.U,p,e),this.i){if(this.Z&&!this.J){t:{if(this.g){var c,u=this.g;if((c=u.g?u.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!zE(c)){var h=c;break t}}h=null}if(!(e=h)){this.i=!1,this.o=3,No(12),Vu(this),ag(this);break e}Pf(this.j,this.m,e,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,II(this,e)}this.P?(fY(this,p,o),oI&&this.i&&3==p&&(JZ(this.S,this.T,"tick",this.hb),this.T.start())):(Pf(this.j,this.m,o,null),II(this,o)),4==p&&Vu(this),this.i&&!this.I&&(4==p?HY(this.l,this):(this.i=!1,og(this)))}else 400==e&&0<o.indexOf("Unknown SID")?(this.o=3,No(12)):(this.o=0,No(13)),Vu(this),ag(this)}}}catch{}},Nt.hb=function(){if(this.g){var n=Ul(this.g),t=this.g.fa();this.C<t.length&&(YE(this),fY(this,n,t),this.i&&4!=n&&og(this))}},Nt.cancel=function(){this.I=!0,Vu(this)},Nt.gb=function(){this.B=null;const n=Date.now();0<=n-this.V?(function ome(n,t){n.info(function(){return"TIMEOUT: "+t})}(this.j,this.A),2!=this.K&&(ng(),No(17)),Vu(this),this.o=2,ag(this)):hY(this,this.V-n)};var pY=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Hu(n,t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,n instanceof Hu){this.h=void 0!==t?t:n.h,KE(this,n.j),this.s=n.s,this.g=n.g,XE(this,n.m),this.l=n.l,t=n.i;var e=new ug;e.i=t.i,t.g&&(e.g=new Map(t.g),e.h=t.h),gY(this,e),this.o=n.o}else n&&(e=String(n).match(pY))?(this.h=!!t,KE(this,e[1]||"",!0),this.s=cg(e[2]||""),this.g=cg(e[3]||"",!0),XE(this,e[4]),this.l=cg(e[5]||"",!0),gY(this,e[6]||"",!0),this.o=cg(e[7]||"")):(this.h=!!t,this.i=new ug(null,this.h))}function $l(n){return new Hu(n)}function KE(n,t,e){n.j=e?cg(t,!0):t,n.j&&(n.j=n.j.replace(/:$/,""))}function XE(n,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);n.m=t}else n.m=null}function gY(n,t,e){t instanceof ug?(n.i=t,function vme(n,t){t&&!n.j&&(A0(n),n.i=null,n.g.forEach(function(e,r){var s=r.toLowerCase();r!=s&&(_Y(this,r),CY(this,s,e))},n)),n.j=t}(n.i,n.h)):(e||(t=lg(t,mme)),n.i=new ug(t,n.h))}function Hr(n,t,e){n.i.set(t,e)}function QE(n){return Hr(n,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),n}function cg(n,t){return n?t?decodeURI(n.replace(/%25/g,"%2525")):decodeURIComponent(n):""}function lg(n,t,e){return"string"==typeof n?(n=encodeURI(n).replace(t,dme),e&&(n=n.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n):null}function dme(n){return"%"+((n=n.charCodeAt(0))>>4&15).toString(16)+(15&n).toString(16)}Hu.prototype.toString=function(){var n=[],t=this.j;t&&n.push(lg(t,mY,!0),":");var e=this.g;return(e||"file"==t)&&(n.push("//"),(t=this.s)&&n.push(lg(t,mY,!0),"@"),n.push(encodeURIComponent(String(e)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(e=this.m)&&n.push(":",String(e))),(e=this.l)&&(this.g&&"/"!=e.charAt(0)&&n.push("/"),n.push(lg(e,"/"==e.charAt(0)?gme:pme,!0))),(e=this.i.toString())&&n.push("?",e),(e=this.o)&&n.push("#",lg(e,_me)),n.join("")};var mY=/[#\/\?@]/g,pme=/[#\?:]/g,gme=/[#\?]/g,mme=/[#\?@]/g,_me=/#/g;function ug(n,t){this.h=this.g=null,this.i=n||null,this.j=!!t}function A0(n){n.g||(n.g=new Map,n.h=0,n.i&&function hme(n,t){if(n){n=n.split("&");for(var e=0;e<n.length;e++){var r=n[e].indexOf("="),s=null;if(0<=r){var i=n[e].substring(0,r);s=n[e].substring(r+1)}else i=n[e];t(i,s?decodeURIComponent(s.replace(/\+/g," ")):"")}}}(n.i,function(t,e){n.add(decodeURIComponent(t.replace(/\+/g," ")),e)}))}function _Y(n,t){A0(n),t=Tf(n,t),n.g.has(t)&&(n.i=null,n.h-=n.g.get(t).length,n.g.delete(t))}function vY(n,t){return A0(n),t=Tf(n,t),n.g.has(t)}function CY(n,t,e){_Y(n,t),0<e.length&&(n.i=null,n.g.set(Tf(n,t),rI(e)),n.h+=e.length)}function Tf(n,t){return t=String(t),n.j&&(t=t.toLowerCase()),t}function yY(n){this.l=n||yme,n=_n.PerformanceNavigationTiming?0<(n=_n.performance.getEntriesByType("navigation")).length&&("hq"==n[0].nextHopProtocol||"h2"==n[0].nextHopProtocol):!!(_n.g&&_n.g.Ga&&_n.g.Ga()&&_n.g.Ga().$b),this.j=n?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(Nt=ug.prototype).add=function(n,t){A0(this),this.i=null,n=Tf(this,n);var e=this.g.get(n);return e||this.g.set(n,e=[]),e.push(t),this.h+=1,this},Nt.forEach=function(n,t){A0(this),this.g.forEach(function(e,r){e.forEach(function(s){n.call(t,s,r,this)},this)},this)},Nt.oa=function(){A0(this);const n=Array.from(this.g.values()),t=Array.from(this.g.keys()),e=[];for(let r=0;r<t.length;r++){const s=n[r];for(let i=0;i<s.length;i++)e.push(t[r])}return e},Nt.W=function(n){A0(this);let t=[];if("string"==typeof n)vY(this,n)&&(t=t.concat(this.g.get(Tf(this,n))));else{n=Array.from(this.g.values());for(let e=0;e<n.length;e++)t=t.concat(n[e])}return t},Nt.set=function(n,t){return A0(this),this.i=null,vY(this,n=Tf(this,n))&&(this.h-=this.g.get(n).length),this.g.set(n,[t]),this.h+=1,this},Nt.get=function(n,t){return n&&0<(n=this.W(n)).length?String(n[0]):t},Nt.toString=function(){if(this.i)return this.i;if(!this.g)return"";const n=[],t=Array.from(this.g.keys());for(var e=0;e<t.length;e++){var r=t[e];const i=encodeURIComponent(String(r)),o=this.W(r);for(r=0;r<o.length;r++){var s=i;""!==o[r]&&(s+="="+encodeURIComponent(String(o[r]))),n.push(s)}}return this.i=n.join("&")};var yme=10;function EY(n){return!!n.h||!!n.g&&n.g.size>=n.j}function MY(n){return n.h?1:n.g?n.g.size:0}function xI(n,t){return n.h?n.h==t:!!n.g&&n.g.has(t)}function kI(n,t){n.g?n.g.add(t):n.h=t}function SY(n,t){n.h&&n.h==t?n.h=null:n.g&&n.g.has(t)&&n.g.delete(t)}function PY(n){if(null!=n.h)return n.i.concat(n.h.D);if(null!=n.g&&0!==n.g.size){let t=n.i;for(const e of n.g.values())t=t.concat(e.D);return t}return rI(n.i)}function LI(){}function Eme(){this.g=new LI}function Mme(n,t,e){const r=e||"";try{dY(n,function(s,i){let o=s;Qp(s)&&(o=yI(s)),t.push(r+i+"="+encodeURIComponent(o))})}catch(s){throw t.push(r+"type="+encodeURIComponent("_badmap")),s}}function JE(n,t,e,r,s){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,s(r)}catch{}}function fg(n){this.l=n.ac||null,this.j=n.jb||!1}function eM(n,t){Vi.call(this),this.D=n,this.u=t,this.m=void 0,this.readyState=RI,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}yY.prototype.cancel=function(){if(this.i=PY(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const n of this.g.values())n.cancel();this.g.clear()}},LI.prototype.stringify=function(n){return _n.JSON.stringify(n,void 0)},LI.prototype.parse=function(n){return _n.JSON.parse(n,void 0)},y2(fg,TI),fg.prototype.g=function(){return new eM(this.l,this.j)},fg.prototype.i=function(n){return function(){return n}}({}),y2(eM,Vi);var RI=0;function TY(n){n.j.read().then(n.Ta.bind(n)).catch(n.ga.bind(n))}function hg(n){n.readyState=4,n.l=null,n.j=null,n.A=null,dg(n)}function dg(n){n.onreadystatechange&&n.onreadystatechange.call(n)}(Nt=eM.prototype).open=function(n,t){if(this.readyState!=RI)throw this.abort(),Error("Error reopening a connection");this.C=n,this.B=t,this.readyState=1,dg(this)},Nt.send=function(n){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};n&&(t.body=n),(this.D||_n).fetch(new Request(this.B,t)).then(this.Wa.bind(this),this.ga.bind(this))},Nt.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,hg(this)),this.readyState=RI},Nt.Wa=function(n){if(this.g&&(this.l=n,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=n.headers,this.readyState=2,dg(this)),this.g&&(this.readyState=3,dg(this),this.g)))if("arraybuffer"===this.responseType)n.arrayBuffer().then(this.Ua.bind(this),this.ga.bind(this));else if(typeof _n.ReadableStream<"u"&&"body"in n){if(this.j=n.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;TY(this)}else n.text().then(this.Va.bind(this),this.ga.bind(this))},Nt.Ta=function(n){if(this.g){if(this.u&&n.value)this.response.push(n.value);else if(!this.u){var t=n.value?n.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!n.done}))&&(this.response=this.responseText+=t)}n.done?hg(this):dg(this),3==this.readyState&&TY(this)}},Nt.Va=function(n){this.g&&(this.response=this.responseText=n,hg(this))},Nt.Ua=function(n){this.g&&(this.response=n,hg(this))},Nt.ga=function(){this.g&&hg(this)},Nt.setRequestHeader=function(n,t){this.v.append(n,t)},Nt.getResponseHeader=function(n){return this.h&&this.h.get(n.toLowerCase())||""},Nt.getAllResponseHeaders=function(){if(!this.h)return"";const n=[],t=this.h.entries();for(var e=t.next();!e.done;)n.push((e=e.value)[0]+": "+e[1]),e=t.next();return n.join("\r\n")},Object.defineProperty(eM.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(n){this.m=n?"include":"same-origin"}});var Pme=_n.JSON.parse;function hs(n){Vi.call(this),this.headers=new Map,this.u=n||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=wY,this.K=this.L=!1}y2(hs,Vi);var wY="",Tme=/^https?$/i,wme=["POST","PUT"];function bY(n,t){n.h=!1,n.g&&(n.l=!0,n.g.abort(),n.l=!1),n.j=t,n.m=5,OY(n),tM(n)}function OY(n){n.D||(n.D=!0,E2(n,"complete"),E2(n,"error"))}function NY(n){if(n.h&&typeof tI<"u"&&(!n.C[1]||4!=Ul(n)||2!=n.aa()))if(n.v&&4==Ul(n))PI(n.Ha,0,n);else if(E2(n,"readystatechange"),4==Ul(n)){n.h=!1;try{const c=n.aa();e:switch(c){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var e;if(!(e=t)){var r;if(r=0===c){var s=String(n.H).match(pY)[1]||null;if(!s&&_n.self&&_n.self.location){var i=_n.self.location.protocol;s=i.substr(0,i.length-1)}r=!Tme.test(s?s.toLowerCase():"")}e=r}if(e)E2(n,"complete"),E2(n,"success");else{n.m=6;try{var o=2<Ul(n)?n.g.statusText:""}catch{o=""}n.j=o+" ["+n.aa()+"]",OY(n)}}finally{tM(n)}}}function tM(n,t){if(n.g){AY(n);const e=n.g,r=n.C[0]?LE:null;n.g=null,n.C=null,t||E2(n,"ready");try{e.onreadystatechange=r}catch{}}}function AY(n){n.g&&n.K&&(n.g.ontimeout=null),n.A&&(_n.clearTimeout(n.A),n.A=null)}function Ul(n){return n.g?n.g.readyState:0}function IY(n){try{if(!n.g)return null;if("response"in n.g)return n.g.response;switch(n.J){case wY:case"text":return n.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in n.g)return n.g.mozResponseArrayBuffer}return null}catch{return null}}function xY(n){let t="";return fI(n,function(e,r){t+=r,t+=":",t+=e,t+="\r\n"}),t}function DI(n,t,e){e:{for(r in e){var r=!1;break e}r=!0}r||(e=xY(e),"string"==typeof n?null!=e&&encodeURIComponent(String(e)):Hr(n,t,e))}function pg(n,t,e){return e&&e.internalChannelParams&&e.internalChannelParams[n]||t}function kY(n){this.Ca=0,this.i=[],this.j=new GE,this.ka=this.sa=this.F=this.V=this.g=this.za=this.D=this.ia=this.o=this.S=this.s=null,this.ab=this.U=0,this.Za=pg("failFast",!1,n),this.L=this.v=this.u=this.m=this.l=null,this.Y=!0,this.pa=this.Ba=this.T=-1,this.Z=this.A=this.C=0,this.Xa=pg("baseRetryDelayMs",5e3,n),this.bb=pg("retryDelaySeedMs",1e4,n),this.$a=pg("forwardChannelMaxRetries",2,n),this.ta=pg("forwardChannelRequestTimeoutMs",2e4,n),this.ra=n&&n.xmlHttpFactory||void 0,this.Da=n&&n.Zb||!1,this.J=void 0,this.H=n&&n.supportsCrossDomainXhr||!1,this.I="",this.h=new yY(n&&n.concurrentRequestLimit),this.Fa=new Eme,this.O=n&&n.fastHandshake||!1,this.N=n&&n.encodeInitMessageHeaders||!1,this.O&&this.N&&(this.N=!1),this.Ya=n&&n.Xb||!1,n&&n.Aa&&this.j.Aa(),n&&n.forceLongPolling&&(this.Y=!1),this.$=!this.O&&this.Y&&n&&n.detectBufferingProxy||!1,this.ja=void 0,this.P=0,this.K=!1,this.la=this.B=null}function zI(n){if(LY(n),3==n.G){var t=n.U++,e=$l(n.F);Hr(e,"SID",n.I),Hr(e,"RID",t),Hr(e,"TYPE","terminate"),gg(n,e),(t=new ig(n,n.j,t,void 0)).K=2,t.v=QE($l(e)),e=!1,_n.navigator&&_n.navigator.sendBeacon&&(e=_n.navigator.sendBeacon(t.v.toString(),"")),!e&&_n.Image&&((new Image).src=t.v,e=!0),e||(t.g=UY(t.l,null),t.g.da(t.v)),t.F=Date.now(),og(t)}BY(n)}function nM(n){n.g&&(HI(n),n.g.cancel(),n.g=null)}function LY(n){nM(n),n.u&&(_n.clearTimeout(n.u),n.u=null),sM(n),n.h.cancel(),n.m&&("number"==typeof n.m&&_n.clearTimeout(n.m),n.m=null)}function rM(n){EY(n.h)||n.m||(n.m=!0,YZ(n.Ja,n),n.C=0)}function RY(n,t){var e;e=t?t.m:n.U++;const r=$l(n.F);Hr(r,"SID",n.I),Hr(r,"RID",e),Hr(r,"AID",n.T),gg(n,r),n.o&&n.s&&DI(r,n.o,n.s),e=new ig(n,n.j,e,n.C+1),null===n.o&&(e.H=n.s),t&&(n.i=t.D.concat(n.i)),t=DY(n,e,1e3),e.setTimeout(Math.round(.5*n.ta)+Math.round(.5*n.ta*Math.random())),kI(n.h,e),AI(e,r,t)}function gg(n,t){n.ia&&fI(n.ia,function(e,r){Hr(t,r,e)}),n.l&&dY({},function(e,r){Hr(t,r,e)})}function DY(n,t,e){e=Math.min(n.i.length,e);var r=n.l?Q2(n.l.Ra,n.l,n):null;e:{var s=n.i;let i=-1;for(;;){const o=["count="+e];-1==i?0<e?(i=s[0].h,o.push("ofs="+i)):i=0:o.push("ofs="+i);let c=!0;for(let u=0;u<e;u++){let h=s[u].h;const p=s[u].g;if(h-=i,0>h)i=Math.max(0,s[u].h-100),c=!1;else try{Mme(p,o,"req"+h+"_")}catch{r&&r(p)}}if(c){r=o.join("&");break e}}}return n=n.i.splice(0,e),t.D=n,r}function zY(n){n.g||n.u||(n.Z=1,YZ(n.Ia,n),n.A=0)}function VI(n){return!(n.g||n.u||3<=n.A||(n.Z++,n.u=rg(Q2(n.Ia,n),FY(n,n.A)),n.A++,0))}function HI(n){null!=n.B&&(_n.clearTimeout(n.B),n.B=null)}function VY(n){n.g=new ig(n,n.j,"rpc",n.Z),null===n.o&&(n.g.H=n.s),n.g.N=0;var t=$l(n.sa);Hr(t,"RID","rpc"),Hr(t,"SID",n.I),Hr(t,"CI",n.L?"0":"1"),Hr(t,"AID",n.T),Hr(t,"TYPE","xmlhttp"),gg(n,t),n.o&&n.s&&DI(t,n.o,n.s),n.J&&n.g.setTimeout(n.J);var e=n.g;n=n.ka,e.K=1,e.v=QE($l(t)),e.s=null,e.P=!0,lY(e,n)}function sM(n){null!=n.v&&(_n.clearTimeout(n.v),n.v=null)}function HY(n,t){var e=null;if(n.g==t){sM(n),HI(n),n.g=null;var r=2}else{if(!xI(n.h,t))return;e=t.D,SY(n.h,t),r=1}if(0!=n.G)if(n.pa=t.Y,t.i)if(1==r){e=t.s?t.s.length:0,t=Date.now()-t.F;var s=n.C;E2(r=WE(),new sY(r,e)),rM(n)}else zY(n);else if(3==(s=t.o)||0==s&&0<n.pa||!(1==r&&function Ome(n,t){return!(MY(n.h)>=n.h.j-(n.m?1:0)||(n.m?(n.i=t.D.concat(n.i),0):1==n.G||2==n.G||n.C>=(n.Za?0:n.$a)||(n.m=rg(Q2(n.Ja,n,t),FY(n,n.C)),n.C++,0)))}(n,t)||2==r&&VI(n)))switch(e&&0<e.length&&(t=n.h,t.i=t.i.concat(e)),s){case 1:Fu(n,5);break;case 4:Fu(n,10);break;case 3:Fu(n,6);break;default:Fu(n,2)}}function FY(n,t){let e=n.Xa+Math.floor(Math.random()*n.bb);return n.l||(e*=2),e*t}function Fu(n,t){if(n.j.info("Error code "+t),2==t){var e=null;n.l&&(e=null);var r=Q2(n.kb,n);e||(e=new Hu("//www.google.com/images/cleardot.gif"),_n.location&&"http"==_n.location.protocol||KE(e,"https"),QE(e)),function Sme(n,t){const e=new GE;if(_n.Image){const r=new Image;r.onload=DE(JE,e,r,"TestLoadImage: loaded",!0,t),r.onerror=DE(JE,e,r,"TestLoadImage: error",!1,t),r.onabort=DE(JE,e,r,"TestLoadImage: abort",!1,t),r.ontimeout=DE(JE,e,r,"TestLoadImage: timeout",!1,t),_n.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=n}else t(!1)}(e.toString(),r)}else No(2);n.G=0,n.l&&n.l.va(t),BY(n),LY(n)}function BY(n){if(n.G=0,n.la=[],n.l){const t=PY(n.h);(0!=t.length||0!=n.i.length)&&(LZ(n.la,t),LZ(n.la,n.i),n.h.i.length=0,rI(n.i),n.i.length=0),n.l.ua()}}function $Y(n,t,e){var r=e instanceof Hu?$l(e):new Hu(e,void 0);if(""!=r.g)t&&(r.g=t+"."+r.g),XE(r,r.m);else{var s=_n.location;r=s.protocol,t=t?t+"."+s.hostname:s.hostname,s=+s.port;var i=new Hu(null,void 0);r&&KE(i,r),t&&(i.g=t),s&&XE(i,s),e&&(i.l=e),r=i}return t=n.za,(e=n.D)&&t&&Hr(r,e,t),Hr(r,"VER",n.ma),gg(n,r),r}function UY(n,t,e){if(t&&!n.H)throw Error("Can't create secondary domain capable XhrIo object.");return(t=new hs(e&&n.Da&&!n.ra?new fg({jb:!0}):n.ra)).Ka(n.H),t}function GY(){}function iM(){if(Sf&&!(10<=Number(Wge)))throw Error("Environmental error: no available transport.")}function Ba(n,t){Vi.call(this),this.g=new kY(t),this.l=n,this.h=t&&t.messageUrlParams||null,n=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(n?n["X-Client-Protocol"]="webchannel":n={"X-Client-Protocol":"webchannel"}),this.g.s=n,n=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(n?n["X-WebChannel-Content-Type"]=t.messageContentType:n={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.ya&&(n?n["X-WebChannel-Client-Profile"]=t.ya:n={"X-WebChannel-Client-Profile":t.ya}),this.g.S=n,(n=t&&t.Yb)&&!zE(n)&&(this.g.o=n),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!zE(t)&&(this.g.D=t,null!==(n=this.h)&&t in n&&t in(n=this.h)&&delete n[t]),this.j=new wf(this)}function WY(n){wI.call(this);var t=n.__sm__;if(t){e:{for(const e in t){n=e;break e}n=void 0}(this.i=n)&&(n=this.i,t=null!==t&&n in t?t[n]:void 0),this.data=t}else this.data=n}function qY(){bI.call(this),this.status=1}function wf(n){this.g=n}(Nt=hs.prototype).Ka=function(n){this.L=n},Nt.da=function(n,t,e,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+n);t=t?t.toUpperCase():"GET",this.H=n,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():OI.g(),this.C=function oY(n){return n.h||(n.h=n.i())}(this.u?this.u:OI),this.g.onreadystatechange=Q2(this.Ha,this);try{this.F=!0,this.g.open(t,String(n),!0),this.F=!1}catch(i){return void bY(this,i)}if(n=e||"",e=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var s in r)e.set(s,r[s]);else{if("function"!=typeof r.keys||"function"!=typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const i of r.keys())e.set(i,r.get(i))}r=Array.from(e.keys()).find(i=>"content-type"==i.toLowerCase()),s=_n.FormData&&n instanceof _n.FormData,!(0<=kZ(wme,t))||r||s||e.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[i,o]of e)this.g.setRequestHeader(i,o);this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{AY(this),0<this.B&&((this.K=function bme(n){return Sf&&function Gge(){return function Fge(n){var t=Uge;return Object.prototype.hasOwnProperty.call(t,9)?t[9]:t[9]=n(9)}(function(){let n=0;const t=RZ(String(HE)).split("."),e=RZ("9").split("."),r=Math.max(t.length,e.length);for(let o=0;0==n&&o<r;o++){var s=t[o]||"",i=e[o]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],i=/(\d*)(\D*)(.*)/.exec(i)||["","","",""],0==s[0].length&&0==i[0].length)break;n=sI(0==s[1].length?0:parseInt(s[1],10),0==i[1].length?0:parseInt(i[1],10))||sI(0==s[2].length,0==i[2].length)||sI(s[2],i[2]),s=s[3],i=i[3]}while(0==n)}return 0<=n})}()&&"number"==typeof n.timeout&&void 0!==n.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Q2(this.qa,this)):this.A=PI(this.qa,this.B,this)),this.v=!0,this.g.send(n),this.v=!1}catch(i){bY(this,i)}},Nt.qa=function(){typeof tI<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,E2(this,"timeout"),this.abort(8))},Nt.abort=function(n){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=n||7,E2(this,"complete"),E2(this,"abort"),tM(this))},Nt.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),tM(this,!0)),hs.X.M.call(this)},Nt.Ha=function(){this.s||(this.F||this.v||this.l?NY(this):this.fb())},Nt.fb=function(){NY(this)},Nt.aa=function(){try{return 2<Ul(this)?this.g.status:-1}catch{return-1}},Nt.fa=function(){try{return this.g?this.g.responseText:""}catch{return""}},Nt.Sa=function(n){if(this.g){var t=this.g.responseText;return n&&0==t.indexOf(n)&&(t=t.substring(n.length)),Pme(t)}},Nt.Ea=function(){return this.m},Nt.Oa=function(){return"string"==typeof this.j?this.j:String(this.j)},(Nt=kY.prototype).ma=8,Nt.G=1,Nt.Ja=function(n){if(this.m)if(this.m=null,1==this.G){if(!n){this.U=Math.floor(1e5*Math.random()),n=this.U++;const s=new ig(this,this.j,n,void 0);let i=this.s;if(this.S&&(i?(i=FZ(i),$Z(i,this.S)):i=this.S),null!==this.o||this.N||(s.H=i,i=null),this.O)e:{for(var t=0,e=0;e<this.i.length;e++){var r=this.i[e];if(void 0===(r="__data__"in r.g&&"string"==typeof(r=r.g.__data__)?r.length:void 0))break;if(4096<(t+=r)){t=e;break e}if(4096===t||e===this.i.length-1){t=e+1;break e}}t=1e3}else t=1e3;t=DY(this,s,t),Hr(e=$l(this.F),"RID",n),Hr(e,"CVER",22),this.D&&Hr(e,"X-HTTP-Session-Id",this.D),gg(this,e),i&&(this.N?t="headers="+encodeURIComponent(String(xY(i)))+"&"+t:this.o&&DI(e,this.o,i)),kI(this.h,s),this.Ya&&Hr(e,"TYPE","init"),this.O?(Hr(e,"$req",t),Hr(e,"SID","null"),s.Z=!0,AI(s,e,null)):AI(s,e,t),this.G=2}}else 3==this.G&&(n?RY(this,n):0==this.i.length||EY(this.h)||RY(this))},Nt.Ia=function(){if(this.u=null,VY(this),this.$&&!(this.K||null==this.g||0>=this.P)){var n=2*this.P;this.j.info("BP detection timer enabled: "+n),this.B=rg(Q2(this.eb,this),n)}},Nt.eb=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.L=!1,this.K=!0,No(10),nM(this),VY(this))},Nt.cb=function(){null!=this.v&&(this.v=null,nM(this),VI(this),No(19))},Nt.kb=function(n){n?(this.j.info("Successfully pinged google.com"),No(2)):(this.j.info("Failed to ping google.com"),No(1))},(Nt=GY.prototype).xa=function(){},Nt.wa=function(){},Nt.va=function(){},Nt.ua=function(){},Nt.Ra=function(){},iM.prototype.g=function(n,t){return new Ba(n,t)},y2(Ba,Vi),Ba.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.H=!0);var n=this.g,t=this.l,e=this.h||void 0;No(0),n.V=t,n.ia=e||{},n.L=n.Y,n.F=$Y(n,null,n.V),rM(n)},Ba.prototype.close=function(){zI(this.g)},Ba.prototype.u=function(n){var t=this.g;if("string"==typeof n){var e={};e.__data__=n,n=e}else this.v&&((e={}).__data__=yI(n),n=e);t.i.push(new class{constructor(n,t){this.h=n,this.g=t}}(t.ab++,n)),3==t.G&&rM(t)},Ba.prototype.M=function(){this.g.l=null,delete this.j,zI(this.g),delete this.g,Ba.X.M.call(this)},y2(WY,wI),y2(qY,bI),y2(wf,GY),wf.prototype.xa=function(){E2(this.g,"a")},wf.prototype.wa=function(n){E2(this.g,new WY(n))},wf.prototype.va=function(n){E2(this.g,new qY)},wf.prototype.ua=function(){E2(this.g,"b")},iM.prototype.createWebChannel=iM.prototype.g,Ba.prototype.send=Ba.prototype.u,Ba.prototype.open=Ba.prototype.m,Ba.prototype.close=Ba.prototype.close,qE.NO_ERROR=0,qE.TIMEOUT=8,qE.HTTP_ERROR=6,iY.COMPLETE="complete",aY.EventType=sg,sg.OPEN="a",sg.CLOSE="b",sg.ERROR="c",sg.MESSAGE="d",Vi.prototype.listen=Vi.prototype.N,hs.prototype.listenOnce=hs.prototype.O,hs.prototype.getLastError=hs.prototype.Oa,hs.prototype.getLastErrorCode=hs.prototype.Ea,hs.prototype.getStatus=hs.prototype.aa,hs.prototype.getResponseJson=hs.prototype.Sa,hs.prototype.getResponseText=hs.prototype.fa,hs.prototype.send=hs.prototype.da,hs.prototype.setWithCredentials=hs.prototype.Ka;var Nme=Bl.createWebChannelTransport=function(){return new iM},Ame=Bl.getStatEventTarget=function(){return WE()},FI=Bl.ErrorCode=qE,Ime=Bl.EventType=iY,xme=Bl.Event=zu,jY=Bl.Stat={sb:0,vb:1,wb:2,Pb:3,Ub:4,Rb:5,Sb:6,Qb:7,Ob:8,Tb:9,PROXY:10,NOPROXY:11,Mb:12,Ib:13,Jb:14,Hb:15,Kb:16,Lb:17,ob:18,nb:19,pb:20},kme=Bl.FetchXmlHttpFactory=fg,oM=Bl.WebChannel=aY,Lme=Bl.XhrIo=hs;const ZY="@firebase/firestore";class Hi{constructor(t){this.uid=t}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}Hi.UNAUTHENTICATED=new Hi(null),Hi.GOOGLE_CREDENTIALS=new Hi("google-credentials-uid"),Hi.FIRST_PARTY=new Hi("first-party-uid"),Hi.MOCK_USER=new Hi("mock-user");let bf="9.14.0";const I0=new yf("@firebase/firestore");function BI(){return I0.logLevel}function Ge(n,...t){if(I0.logLevel<=g1.DEBUG){const e=t.map($I);I0.debug(`Firestore (${bf}): ${n}`,...e)}}function Ts(n,...t){if(I0.logLevel<=g1.ERROR){const e=t.map($I);I0.error(`Firestore (${bf}): ${n}`,...e)}}function Of(n,...t){if(I0.logLevel<=g1.WARN){const e=t.map($I);I0.warn(`Firestore (${bf}): ${n}`,...e)}}function $I(n){if("string"==typeof n)return n;try{return JSON.stringify(n)}catch{return n}}function wt(n="Unexpected state"){const t=`FIRESTORE (${bf}) INTERNAL ASSERTION FAILED: `+n;throw Ts(t),new Error(t)}function sn(n,t){n||wt()}function lt(n,t){return n}const be={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Be extends Ac{constructor(t,e){super(t,e),this.code=t,this.message=e,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class pi{constructor(){this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}}class YY{constructor(t,e){this.user=e,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class Rme{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable(()=>e(Hi.UNAUTHENTICATED))}shutdown(){}}class Dme{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,e){this.changeListener=e,t.enqueueRetryable(()=>e(this.token.user))}shutdown(){this.changeListener=null}}class zme{constructor(t){this.t=t,this.currentUser=Hi.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,e){var r=this;let s=this.i;const i=h=>this.i!==s?(s=this.i,e(h)):Promise.resolve();let o=new pi;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new pi,t.enqueueRetryable(()=>i(this.currentUser))};const c=()=>{const h=o;t.enqueueRetryable(A(function*(){yield h.promise,yield i(r.currentUser)}))},u=h=>{Ge("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=h,this.auth.addAuthTokenListener(this.o),c()};this.t.onInit(h=>u(h)),setTimeout(()=>{if(!this.auth){const h=this.t.getImmediate({optional:!0});h?u(h):(Ge("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new pi)}},0),c()}getToken(){const t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then(r=>this.i!==t?(Ge("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(sn("string"==typeof r.accessToken),new YY(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const t=this.auth&&this.auth.getUid();return sn(null===t||"string"==typeof t),new Hi(t)}}class Vme{constructor(t,e,r,s){this.h=t,this.l=e,this.m=r,this.g=s,this.type="FirstParty",this.user=Hi.FIRST_PARTY,this.p=new Map}I(){return this.g?this.g():(sn(!("object"!=typeof this.h||null===this.h||!this.h.auth||!this.h.auth.getAuthHeaderValueForFirstParty)),this.h.auth.getAuthHeaderValueForFirstParty([]))}get headers(){this.p.set("X-Goog-AuthUser",this.l);const t=this.I();return t&&this.p.set("Authorization",t),this.m&&this.p.set("X-Goog-Iam-Authorization-Token",this.m),this.p}}class Hme{constructor(t,e,r,s){this.h=t,this.l=e,this.m=r,this.g=s}getToken(){return Promise.resolve(new Vme(this.h,this.l,this.m,this.g))}start(t,e){t.enqueueRetryable(()=>e(Hi.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class KY{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Fme{constructor(t){this.T=t,this.forceRefresh=!1,this.appCheck=null,this.A=null}start(t,e){const r=i=>{null!=i.error&&Ge("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.A;return this.A=i.token,Ge("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?e(i.token):Promise.resolve()};this.o=i=>{t.enqueueRetryable(()=>r(i))};const s=i=>{Ge("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.appCheck.addTokenListener(this.o)};this.T.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.T.getImmediate({optional:!0});i?s(i):Ge("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then(e=>e?(sn("string"==typeof e.token),this.A=e.token,new KY(e.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function Bme(n){const t=typeof self<"u"&&(self.crypto||self.msCrypto),e=new Uint8Array(n);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(e);else for(let r=0;r<n;r++)e[r]=Math.floor(256*Math.random());return e}class XY{static R(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length;let r="";for(;r.length<20;){const s=Bme(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<e&&(r+=t.charAt(s[i]%t.length))}return r}}function vn(n,t){return n<t?-1:n>t?1:0}function Nf(n,t,e){return n.length===t.length&&n.every((r,s)=>e(r,t[s]))}class Jr{constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new Be(be.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new Be(be.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Be(be.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Be(be.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}static now(){return Jr.fromMillis(Date.now())}static fromDate(t){return Jr.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3),r=Math.floor(1e6*(t-1e3*e));return new Jr(e,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(t){return this.seconds===t.seconds?vn(this.nanoseconds,t.nanoseconds):vn(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class on{constructor(t){this.timestamp=t}static fromTimestamp(t){return new on(t)}static min(){return new on(new Jr(0,0))}static max(){return new on(new Jr(253402300799,999999999))}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class mg{constructor(t,e,r){void 0===e?e=0:e>t.length&&wt(),void 0===r?r=t.length-e:r>t.length-e&&wt(),this.segments=t,this.offset=e,this.len=r}get length(){return this.len}isEqual(t){return 0===mg.comparator(this,t)}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof mg?t.forEach(r=>{e.push(r)}):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return this.construct(this.segments,this.offset+(t=void 0===t?1:t),this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return 0===this.length}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,r=this.limit();e<r;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){const r=Math.min(t.length,e.length);for(let s=0;s<r;s++){const i=t.get(s),o=e.get(s);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0}}class m1 extends mg{construct(t,e,r){return new m1(t,e,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...t){const e=[];for(const r of t){if(r.indexOf("//")>=0)throw new Be(be.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);e.push(...r.split("/").filter(s=>s.length>0))}return new m1(e)}static emptyPath(){return new m1([])}}const $me=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ws extends mg{construct(t,e,r){return new ws(t,e,r)}static isValidIdentifier(t){return $me.test(t)}canonicalString(){return this.toArray().map(t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ws.isValidIdentifier(t)||(t="`"+t+"`"),t)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new ws(["__name__"])}static fromServerFormat(t){const e=[];let r="",s=0;const i=()=>{if(0===r.length)throw new Be(be.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(r),r=""};let o=!1;for(;s<t.length;){const c=t[s];if("\\"===c){if(s+1===t.length)throw new Be(be.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const u=t[s+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Be(be.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=u,s+=2}else"`"===c?(o=!o,s++):"."!==c||o?(r+=c,s++):(i(),s++)}if(i(),o)throw new Be(be.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new ws(e)}static emptyPath(){return new ws([])}}class ot{constructor(t){this.path=t}static fromPath(t){return new ot(m1.fromString(t))}static fromName(t){return new ot(m1.fromString(t).popFirst(5))}static empty(){return new ot(m1.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return null!==t&&0===m1.comparator(this.path,t.path)}toString(){return this.path.toString()}static comparator(t,e){return m1.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new ot(new m1(t.slice()))}}function eK(n){return new $a(n.readTime,n.key,-1)}class $a{constructor(t,e,r){this.readTime=t,this.documentKey=e,this.largestBatchId=r}static min(){return new $a(on.min(),ot.empty(),-1)}static max(){return new $a(on.max(),ot.empty(),-1)}}function GI(n,t){let e=n.readTime.compareTo(t.readTime);return 0!==e?e:(e=ot.comparator(n.documentKey,t.documentKey),0!==e?e:vn(n.largestBatchId,t.largestBatchId))}const tK="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";function x0(n){return WI.apply(this,arguments)}function WI(){return WI=A(function*(n){if(n.code!==be.FAILED_PRECONDITION||n.message!==tK)throw n;Ge("LocalStore","Unexpectedly lost primary lease")}),WI.apply(this,arguments)}class Se{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)},e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)})}catch(t){return this.next(void 0,t)}next(t,e){return this.callbackAttached&&wt(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(e,this.error):this.wrapSuccess(t,this.result):new Se((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(t,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(e,i).next(r,s)}})}toPromise(){return new Promise((t,e)=>{this.next(t,e)})}wrapUserFunction(t){try{const e=t();return e instanceof Se?e:Se.resolve(e)}catch(e){return Se.reject(e)}}wrapSuccess(t,e){return t?this.wrapUserFunction(()=>t(e)):Se.resolve(e)}wrapFailure(t,e){return t?this.wrapUserFunction(()=>t(e)):Se.reject(e)}static resolve(t){return new Se((e,r)=>{e(t)})}static reject(t){return new Se((e,r)=>{r(t)})}static waitFor(t){return new Se((e,r)=>{let s=0,i=0,o=!1;t.forEach(c=>{++s,c.next(()=>{++i,o&&i===s&&e()},u=>r(u))}),o=!0,i===s&&e()})}static or(t){let e=Se.resolve(!1);for(const r of t)e=e.next(s=>s?Se.resolve(s):r());return e}static forEach(t,e){const r=[];return t.forEach((s,i)=>{r.push(e.call(this,s,i))}),this.waitFor(r)}static mapArray(t,e){return new Se((r,s)=>{const i=t.length,o=new Array(i);let c=0;for(let u=0;u<i;u++){const h=u;e(t[h]).next(p=>{o[h]=p,++c,c===i&&r(o)},p=>s(p))}})}static doWhile(t,e){return new Se((r,s)=>{const i=()=>{!0===t()?e().next(()=>{i()},s):r()};i()})}}function k0(n){return"IndexedDbTransactionError"===n.name}class aa{constructor(t,e){this.previousValue=t,e&&(e.sequenceNumberHandler=r=>this.ut(r),this.ct=r=>e.writeSequenceNumber(r))}ut(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.ct&&this.ct(t),t}}function rK(n){let t=0;for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&t++;return t}function Uu(n,t){for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&t(e,n[e])}function sK(n){for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t))return!1;return!0}aa.at=-1;class ds{constructor(t,e){this.comparator=t,this.root=e||M2.EMPTY}insert(t,e){return new ds(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,M2.BLACK,null,null))}remove(t){return new ds(this.comparator,this.root.remove(t,this.comparator).copy(null,null,M2.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){const r=this.comparator(t,e.key);if(0===r)return e.value;r<0?e=e.left:r>0&&(e=e.right)}return null}indexOf(t){let e=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(t,r.key);if(0===s)return e+r.left.size;s<0?r=r.left:(e+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal((e,r)=>(t(e,r),!1))}toString(){const t=[];return this.inorderTraversal((e,r)=>(t.push(`${e}:${r}`),!1)),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new uM(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new uM(this.root,t,this.comparator,!1)}getReverseIterator(){return new uM(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new uM(this.root,t,this.comparator,!0)}}class uM{constructor(t,e,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!t.isEmpty();)if(i=e?r(t.key,e):1,e&&s&&(i*=-1),i<0)t=this.isReverse?t.left:t.right;else{if(0===i){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class M2{constructor(t,e,r,s,i){this.key=t,this.value=e,this.color=r??M2.RED,this.left=s??M2.EMPTY,this.right=i??M2.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,r,s,i){return new M2(t??this.key,e??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,r){let s=this;const i=r(t,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(t,e,r),null):0===i?s.copy(null,e,null,null,null):s.copy(null,null,null,null,s.right.insert(t,e,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return M2.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let r,s=this;if(e(t,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(t,e),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),0===e(t,s.key)){if(s.right.isEmpty())return M2.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(t,e))}return s.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,M2.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,M2.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw wt();const t=this.left.check();if(t!==this.right.check())throw wt();return t+(this.isRed()?0:1)}}M2.EMPTY=null,M2.RED=!0,M2.BLACK=!1,M2.EMPTY=new class{constructor(){this.size=0}get key(){throw wt()}get value(){throw wt()}get color(){throw wt()}get left(){throw wt()}get right(){throw wt()}copy(n,t,e,r,s){return this}insert(n,t,e){return new M2(n,t)}remove(n,t){return this}isEmpty(){return!0}inorderTraversal(n){return!1}reverseTraversal(n){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class sr{constructor(t){this.comparator=t,this.data=new ds(this.comparator)}has(t){return null!==this.data.get(t)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal((e,r)=>(t(e),!1))}forEachInRange(t,e){const r=this.data.getIteratorFrom(t[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,t[1])>=0)return;e(s.key)}}forEachWhile(t,e){let r;for(r=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();r.hasNext();)if(!t(r.getNext().key))return}firstAfterOrEqual(t){const e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new iK(this.data.getIterator())}getIteratorFrom(t){return new iK(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach(r=>{e=e.add(r)}),e}isEqual(t){if(!(t instanceof sr)||this.size!==t.size)return!1;const e=this.data.getIterator(),r=t.data.getIterator();for(;e.hasNext();){const s=e.getNext().key,i=r.getNext().key;if(0!==this.comparator(s,i))return!1}return!0}toArray(){const t=[];return this.forEach(e=>{t.push(e)}),t}toString(){const t=[];return this.forEach(e=>t.push(e)),"SortedSet("+t.toString()+")"}copy(t){const e=new sr(this.comparator);return e.data=t,e}}class iK{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Ua{constructor(t){this.fields=t,t.sort(ws.comparator)}static empty(){return new Ua([])}unionWith(t){let e=new sr(ws.comparator);for(const r of this.fields)e=e.add(r);for(const r of t)e=e.add(r);return new Ua(e.toArray())}covers(t){for(const e of this.fields)if(e.isPrefixOf(t))return!0;return!1}isEqual(t){return Nf(this.fields,t.fields,(e,r)=>e.isEqual(r))}}class gi{constructor(t){this.binaryString=t}static fromBase64String(t){const e=atob(t);return new gi(e)}static fromUint8Array(t){const e=function(r){let s="";for(let i=0;i<r.length;++i)s+=String.fromCharCode(r[i]);return s}(t);return new gi(e)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){return function(t){const e=new Uint8Array(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return vn(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}gi.EMPTY_BYTE_STRING=new gi("");const Kme=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function L0(n){if(sn(!!n),"string"==typeof n){let t=0;const e=Kme.exec(n);if(sn(!!e),e[1]){let s=e[1];s=(s+"000000000").substr(0,9),t=Number(s)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:ps(n.seconds),nanos:ps(n.nanos)}}function ps(n){return"number"==typeof n?n:"string"==typeof n?Number(n):0}function Gu(n){return"string"==typeof n?gi.fromBase64String(n):gi.fromUint8Array(n)}function jI(n){var t,e;return"server_timestamp"===(null===(e=((null===(t=n?.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===e?void 0:e.stringValue)}function oK(n){const t=n.mapValue.fields.__previous_value__;return jI(t)?oK(t):t}function Cg(n){const t=L0(n.mapValue.fields.__local_write_time__.timestampValue);return new Jr(t.seconds,t.nanos)}class Xme{constructor(t,e,r,s,i,o,c,u){this.databaseId=t,this.appId=e,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=c,this.useFetchStreams=u}}class Wu{constructor(t,e){this.projectId=t,this.database=e||"(default)"}static empty(){return new Wu("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(t){return t instanceof Wu&&t.projectId===this.projectId&&t.database===this.database}}function yg(n){return null==n}function Eg(n){return 0===n&&1/n==-1/0}const R0_mapValue={fields:{__type__:{stringValue:"__max__"}}};function qu(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?jI(n)?4:fK(n)?9007199254740991:10:wt()}function O4(n,t){if(n===t)return!0;const e=qu(n);if(e!==qu(t))return!1;switch(e){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===t.booleanValue;case 4:return Cg(n).isEqual(Cg(t));case 3:return function(r,s){if("string"==typeof r.timestampValue&&"string"==typeof s.timestampValue&&r.timestampValue.length===s.timestampValue.length)return r.timestampValue===s.timestampValue;const i=L0(r.timestampValue),o=L0(s.timestampValue);return i.seconds===o.seconds&&i.nanos===o.nanos}(n,t);case 5:return n.stringValue===t.stringValue;case 6:return s=t,Gu(n.bytesValue).isEqual(Gu(s.bytesValue));case 7:return n.referenceValue===t.referenceValue;case 8:return function(r,s){return ps(r.geoPointValue.latitude)===ps(s.geoPointValue.latitude)&&ps(r.geoPointValue.longitude)===ps(s.geoPointValue.longitude)}(n,t);case 2:return function(r,s){if("integerValue"in r&&"integerValue"in s)return ps(r.integerValue)===ps(s.integerValue);if("doubleValue"in r&&"doubleValue"in s){const i=ps(r.doubleValue),o=ps(s.doubleValue);return i===o?Eg(i)===Eg(o):isNaN(i)&&isNaN(o)}return!1}(n,t);case 9:return Nf(n.arrayValue.values||[],t.arrayValue.values||[],O4);case 10:return function(r,s){const i=r.mapValue.fields||{},o=s.mapValue.fields||{};if(rK(i)!==rK(o))return!1;for(const c in i)if(i.hasOwnProperty(c)&&(void 0===o[c]||!O4(i[c],o[c])))return!1;return!0}(n,t);default:return wt()}var s}function Mg(n,t){return void 0!==(n.values||[]).find(e=>O4(e,t))}function D0(n,t){if(n===t)return 0;const e=qu(n),r=qu(t);if(e!==r)return vn(e,r);switch(e){case 0:case 9007199254740991:return 0;case 1:return vn(n.booleanValue,t.booleanValue);case 2:return function(s,i){const o=ps(s.integerValue||s.doubleValue),c=ps(i.integerValue||i.doubleValue);return o<c?-1:o>c?1:o===c?0:isNaN(o)?isNaN(c)?0:-1:1}(n,t);case 3:return cK(n.timestampValue,t.timestampValue);case 4:return cK(Cg(n),Cg(t));case 5:return vn(n.stringValue,t.stringValue);case 6:return function(s,i){const o=Gu(s),c=Gu(i);return o.compareTo(c)}(n.bytesValue,t.bytesValue);case 7:return function(s,i){const o=s.split("/"),c=i.split("/");for(let u=0;u<o.length&&u<c.length;u++){const h=vn(o[u],c[u]);if(0!==h)return h}return vn(o.length,c.length)}(n.referenceValue,t.referenceValue);case 8:return function(s,i){const o=vn(ps(s.latitude),ps(i.latitude));return 0!==o?o:vn(ps(s.longitude),ps(i.longitude))}(n.geoPointValue,t.geoPointValue);case 9:return function(s,i){const o=s.values||[],c=i.values||[];for(let u=0;u<o.length&&u<c.length;++u){const h=D0(o[u],c[u]);if(h)return h}return vn(o.length,c.length)}(n.arrayValue,t.arrayValue);case 10:return function(s,i){if(s===R0_mapValue&&i===R0_mapValue)return 0;if(s===R0_mapValue)return 1;if(i===R0_mapValue)return-1;const o=s.fields||{},c=Object.keys(o),u=i.fields||{},h=Object.keys(u);c.sort(),h.sort();for(let p=0;p<c.length&&p<h.length;++p){const m=vn(c[p],h[p]);if(0!==m)return m;const C=D0(o[c[p]],u[h[p]]);if(0!==C)return C}return vn(c.length,h.length)}(n.mapValue,t.mapValue);default:throw wt()}}function cK(n,t){if("string"==typeof n&&"string"==typeof t&&n.length===t.length)return vn(n,t);const e=L0(n),r=L0(t),s=vn(e.seconds,r.seconds);return 0!==s?s:vn(e.nanos,r.nanos)}function If(n){return ZI(n)}function ZI(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(r){const s=L0(r);return`time(${s.seconds},${s.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?Gu(n.bytesValue).toBase64():"referenceValue"in n?ot.fromName(n.referenceValue).toString():"geoPointValue"in n?`geo(${(t=n.geoPointValue).latitude},${t.longitude})`:"arrayValue"in n?function(r){let s="[",i=!0;for(const o of r.values||[])i?i=!1:s+=",",s+=ZI(o);return s+"]"}(n.arrayValue):"mapValue"in n?function(r){const s=Object.keys(r.fields||{}).sort();let i="{",o=!0;for(const c of s)o?o=!1:i+=",",i+=`${c}:${ZI(r.fields[c])}`;return i+"}"}(n.mapValue):wt();var t}function ju(n,t){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${t.path.canonicalString()}`}}function YI(n){return!!n&&"integerValue"in n}function Sg(n){return!!n&&"arrayValue"in n}function lK(n){return!!n&&"nullValue"in n}function uK(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function hM(n){return!!n&&"mapValue"in n}function Pg(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&"object"==typeof n.timestampValue)return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const t={mapValue:{fields:{}}};return Uu(n.mapValue.fields,(e,r)=>t.mapValue.fields[e]=Pg(r)),t}if(n.arrayValue){const t={arrayValue:{values:[]}};for(let e=0;e<(n.arrayValue.values||[]).length;++e)t.arrayValue.values[e]=Pg(n.arrayValue.values[e]);return t}return Object.assign({},n)}function fK(n){return"__max__"===(((n.mapValue||{}).fields||{}).__type__||{}).stringValue}class S2{constructor(t){this.value=t}static empty(){return new S2({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let e=this.value;for(let r=0;r<t.length-1;++r)if(e=(e.mapValue.fields||{})[t.get(r)],!hM(e))return null;return e=(e.mapValue.fields||{})[t.lastSegment()],e||null}}set(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=Pg(e)}setAll(t){let e=ws.emptyPath(),r={},s=[];t.forEach((o,c)=>{if(!e.isImmediateParentOf(c)){const u=this.getFieldsMap(e);this.applyChanges(u,r,s),r={},s=[],e=c.popLast()}o?r[c.lastSegment()]=Pg(o):s.push(c.lastSegment())});const i=this.getFieldsMap(e);this.applyChanges(i,r,s)}delete(t){const e=this.field(t.popLast());hM(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}isEqual(t){return O4(this.value,t.value)}getFieldsMap(t){let e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(let r=0;r<t.length;++r){let s=e.mapValue.fields[t.get(r)];hM(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},e.mapValue.fields[t.get(r)]=s),e=s}return e.mapValue.fields}applyChanges(t,e,r){Uu(e,(s,i)=>t[s]=i);for(const s of r)delete t[s]}clone(){return new S2(Pg(this.value))}}function pK(n){const t=[];return Uu(n.fields,(e,r)=>{const s=new ws([e]);if(hM(r)){const i=pK(r.mapValue).fields;if(0===i.length)t.push(s);else for(const o of i)t.push(s.child(o))}else t.push(s)}),new Ua(t)}class vr{constructor(t,e,r,s,i,o){this.key=t,this.documentType=e,this.version=r,this.readTime=s,this.data=i,this.documentState=o}static newInvalidDocument(t){return new vr(t,0,on.min(),on.min(),S2.empty(),0)}static newFoundDocument(t,e,r){return new vr(t,1,e,on.min(),r,0)}static newNoDocument(t,e){return new vr(t,2,e,on.min(),S2.empty(),0)}static newUnknownDocument(t,e){return new vr(t,3,e,on.min(),S2.empty(),2)}convertToFoundDocument(t,e){return this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=S2.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=S2.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=on.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(t){return t instanceof vr&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new vr(this.key,this.documentType,this.version,this.readTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class e_e{constructor(t,e=null,r=[],s=[],i=null,o=null,c=null){this.path=t,this.collectionGroup=e,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=c,this.ht=null}}function gK(n,t=null,e=[],r=[],s=null,i=null,o=null){return new e_e(n,t,e,r,s,i,o)}function Zu(n){const t=lt(n);if(null===t.ht){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map(r=>{return(s=r).field.canonicalString()+s.op.toString()+If(s.value);var s}).join(","),e+="|ob:",e+=t.orderBy.map(r=>{return(s=r).field.canonicalString()+s.dir;var s}).join(","),yg(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(r=>If(r)).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(r=>If(r)).join(",")),t.ht=e}return t.ht}function Tg(n,t){if(n.limit!==t.limit||n.orderBy.length!==t.orderBy.length)return!1;for(let s=0;s<n.orderBy.length;s++)if(!l_e(n.orderBy[s],t.orderBy[s]))return!1;if(n.filters.length!==t.filters.length)return!1;for(let s=0;s<n.filters.length;s++)if((e=n.filters[s]).op!==(r=t.filters[s]).op||!e.field.isEqual(r.field)||!O4(e.value,r.value))return!1;var e,r;return n.collectionGroup===t.collectionGroup&&!!n.path.isEqual(t.path)&&!!yK(n.startAt,t.startAt)&&yK(n.endAt,t.endAt)}function dM(n){return ot.isDocumentKey(n.path)&&null===n.collectionGroup&&0===n.filters.length}class P2 extends class{}{constructor(t,e,r){super(),this.field=t,this.op=e,this.value=r}static create(t,e,r){return t.isKeyField()?"in"===e||"not-in"===e?this.lt(t,e,r):new n_e(t,e,r):"array-contains"===e?new i_e(t,r):"in"===e?new o_e(t,r):"not-in"===e?new a_e(t,r):"array-contains-any"===e?new c_e(t,r):new P2(t,e,r)}static lt(t,e,r){return"in"===e?new r_e(t,r):new s_e(t,r)}matches(t){const e=t.data.field(this.field);return"!="===this.op?null!==e&&this.ft(D0(e,this.value)):null!==e&&qu(this.value)===qu(e)&&this.ft(D0(e,this.value))}ft(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return wt()}}dt(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}class n_e extends P2{constructor(t,e,r){super(t,e,r),this.key=ot.fromName(r.referenceValue)}matches(t){const e=ot.comparator(t.key,this.key);return this.ft(e)}}class r_e extends P2{constructor(t,e){super(t,"in",e),this.keys=vK(0,e)}matches(t){return this.keys.some(e=>e.isEqual(t.key))}}class s_e extends P2{constructor(t,e){super(t,"not-in",e),this.keys=vK(0,e)}matches(t){return!this.keys.some(e=>e.isEqual(t.key))}}function vK(n,t){var e;return((null===(e=t.arrayValue)||void 0===e?void 0:e.values)||[]).map(r=>ot.fromName(r.referenceValue))}class i_e extends P2{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.data.field(this.field);return Sg(e)&&Mg(e.arrayValue,this.value)}}class o_e extends P2{constructor(t,e){super(t,"in",e)}matches(t){const e=t.data.field(this.field);return null!==e&&Mg(this.value.arrayValue,e)}}class a_e extends P2{constructor(t,e){super(t,"not-in",e)}matches(t){if(Mg(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.data.field(this.field);return null!==e&&!Mg(this.value.arrayValue,e)}}class c_e extends P2{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.data.field(this.field);return!(!Sg(e)||!e.arrayValue.values)&&e.arrayValue.values.some(r=>Mg(this.value.arrayValue,r))}}class z0{constructor(t,e){this.position=t,this.inclusive=e}}class xf{constructor(t,e="asc"){this.field=t,this.dir=e}}function l_e(n,t){return n.dir===t.dir&&n.field.isEqual(t.field)}function CK(n,t,e){let r=0;for(let s=0;s<n.position.length;s++){const i=t[s],o=n.position[s];if(r=i.field.isKeyField()?ot.comparator(ot.fromName(o.referenceValue),e.key):D0(o,e.data.field(i.field)),"desc"===i.dir&&(r*=-1),0!==r)break}return r}function yK(n,t){if(null===n)return null===t;if(null===t||n.inclusive!==t.inclusive||n.position.length!==t.position.length)return!1;for(let e=0;e<n.position.length;e++)if(!O4(n.position[e],t.position[e]))return!1;return!0}class Gl{constructor(t,e=null,r=[],s=[],i=null,o="F",c=null,u=null){this.path=t,this.collectionGroup=e,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=c,this.endAt=u,this._t=null,this.wt=null}}function kf(n){return new Gl(n)}function MK(n){return 0===n.filters.length&&null===n.limit&&null==n.startAt&&null==n.endAt&&(0===n.explicitOrderBy.length||1===n.explicitOrderBy.length&&n.explicitOrderBy[0].field.isKeyField())}function KI(n){return n.explicitOrderBy.length>0?n.explicitOrderBy[0].field:null}function XI(n){for(const t of n.filters)if(t.dt())return t.field;return null}function QI(n){return null!==n.collectionGroup}function Lf(n){const t=lt(n);if(null===t._t){t._t=[];const e=XI(t),r=KI(t);if(null!==e&&null===r)e.isKeyField()||t._t.push(new xf(e)),t._t.push(new xf(ws.keyField(),"asc"));else{let s=!1;for(const i of t.explicitOrderBy)t._t.push(i),i.field.isKeyField()&&(s=!0);if(!s){const i=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";t._t.push(new xf(ws.keyField(),i))}}}return t._t}function Ao(n){const t=lt(n);if(!t.wt)if("F"===t.limitType)t.wt=gK(t.path,t.collectionGroup,Lf(t),t.filters,t.limit,t.startAt,t.endAt);else{const e=[];for(const i of Lf(t))e.push(new xf(i.field,"desc"===i.dir?"asc":"desc"));const r=t.endAt?new z0(t.endAt.position,t.endAt.inclusive):null,s=t.startAt?new z0(t.startAt.position,t.startAt.inclusive):null;t.wt=gK(t.path,t.collectionGroup,e,t.filters,t.limit,r,s)}return t.wt}function gM(n,t,e){return new Gl(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),t,e,n.startAt,n.endAt)}function wg(n,t){return Tg(Ao(n),Ao(t))&&n.limitType===t.limitType}function SK(n){return`${Zu(Ao(n))}|lt:${n.limitType}`}function JI(n){return`Query(target=${function t_e(n){let t=n.path.canonicalString();return null!==n.collectionGroup&&(t+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(t+=`, filters: [${n.filters.map(e=>{return`${(r=e).field.canonicalString()} ${r.op} ${If(r.value)}`;var r}).join(", ")}]`),yg(n.limit)||(t+=", limit: "+n.limit),n.orderBy.length>0&&(t+=`, orderBy: [${n.orderBy.map(e=>{return`${(r=e).field.canonicalString()} (${r.dir})`;var r}).join(", ")}]`),n.startAt&&(t+=", startAt: ",t+=n.startAt.inclusive?"b:":"a:",t+=n.startAt.position.map(e=>If(e)).join(",")),n.endAt&&(t+=", endAt: ",t+=n.endAt.inclusive?"a:":"b:",t+=n.endAt.position.map(e=>If(e)).join(",")),`Target(${t})`}(Ao(n))}; limitType=${n.limitType})`}function ex(n,t){return t.isFoundDocument()&&function(e,r){const s=r.key.path;return null!==e.collectionGroup?r.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(s):ot.isDocumentKey(e.path)?e.path.isEqual(s):e.path.isImmediateParentOf(s)}(n,t)&&function(e,r){for(const s of e.explicitOrderBy)if(!s.field.isKeyField()&&null===r.data.field(s.field))return!1;return!0}(n,t)&&function(e,r){for(const s of e.filters)if(!s.matches(r))return!1;return!0}(n,t)&&(r=t,!((e=n).startAt&&!function(s,i,o){const c=CK(s,i,o);return s.inclusive?c<=0:c<0}(e.startAt,Lf(e),r)||e.endAt&&!function(s,i,o){const c=CK(s,i,o);return s.inclusive?c>=0:c>0}(e.endAt,Lf(e),r)));var e,r}function TK(n){return(t,e)=>{let r=!1;for(const s of Lf(n)){const i=u_e(s,t,e);if(0!==i)return i;r=r||s.field.isKeyField()}return 0}}function u_e(n,t,e){const r=n.field.isKeyField()?ot.comparator(t.key,e.key):function(s,i,o){const c=i.data.field(s),u=o.data.field(s);return null!==c&&null!==u?D0(c,u):wt()}(n.field,t,e);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return wt()}}function wK(n,t){if(n.gt){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Eg(t)?"-0":t}}function bK(n){return{integerValue:""+n}}function OK(n,t){return function aK(n){return"number"==typeof n&&Number.isInteger(n)&&!Eg(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}(t)?bK(t):wK(n,t)}class mM{constructor(){this._=void 0}}function f_e(n,t,e){return n instanceof Rf?function(r,s){const i={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return s&&(i.fields.__previous_value__=s),{mapValue:i}}(e,t):n instanceof Yu?AK(n,t):n instanceof Ku?IK(n,t):function(r,s){const i=NK(r,s),o=xK(i)+xK(r.yt);return YI(i)&&YI(r.yt)?bK(o):wK(r.It,o)}(n,t)}function h_e(n,t,e){return n instanceof Yu?AK(n,t):n instanceof Ku?IK(n,t):e}function NK(n,t){return n instanceof Df?YI(e=t)||(r=e)&&"doubleValue"in r?t:{integerValue:0}:null;var r,e}class Rf extends mM{}class Yu extends mM{constructor(t){super(),this.elements=t}}function AK(n,t){const e=kK(t);for(const r of n.elements)e.some(s=>O4(s,r))||e.push(r);return{arrayValue:{values:e}}}class Ku extends mM{constructor(t){super(),this.elements=t}}function IK(n,t){let e=kK(t);for(const r of n.elements)e=e.filter(s=>!O4(s,r));return{arrayValue:{values:e}}}class Df extends mM{constructor(t,e){super(),this.It=t,this.yt=e}}function xK(n){return ps(n.integerValue||n.doubleValue)}function kK(n){return Sg(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class bg{constructor(t,e){this.field=t,this.transform=e}}class p_e{constructor(t,e){this.version=t,this.transformResults=e}}class Fr{constructor(t,e){this.updateTime=t,this.exists=e}static none(){return new Fr}static exists(t){return new Fr(void 0,t)}static updateTime(t){return new Fr(t)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function _M(n,t){return void 0!==n.updateTime?t.isFoundDocument()&&t.version.isEqual(n.updateTime):void 0===n.exists||n.exists===t.isFoundDocument()}class vM{}function LK(n,t){if(!n.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return n.isNoDocument()?new Vf(n.key,Fr.none()):new zf(n.key,n.data,Fr.none());{const e=n.data,r=S2.empty();let s=new sr(ws.comparator);for(let i of t.fields)if(!s.has(i)){let o=e.field(i);null===o&&i.length>1&&(i=i.popLast(),o=e.field(i)),null===o?r.delete(i):r.set(i,o),s=s.add(i)}return new Wl(n.key,r,new Ua(s.toArray()),Fr.none())}}function g_e(n,t,e){n instanceof zf?function(r,s,i){const o=r.value.clone(),c=zK(r.fieldTransforms,s,i.transformResults);o.setAll(c),s.convertToFoundDocument(i.version,o).setHasCommittedMutations()}(n,t,e):n instanceof Wl?function(r,s,i){if(!_M(r.precondition,s))return void s.convertToUnknownDocument(i.version);const o=zK(r.fieldTransforms,s,i.transformResults),c=s.data;c.setAll(DK(r)),c.setAll(o),s.convertToFoundDocument(i.version,c).setHasCommittedMutations()}(n,t,e):t.convertToNoDocument(e.version).setHasCommittedMutations()}function Og(n,t,e,r){return n instanceof zf?function(s,i,o,c){if(!_M(s.precondition,i))return o;const u=s.value.clone(),h=VK(s.fieldTransforms,c,i);return u.setAll(h),i.convertToFoundDocument(i.version,u).setHasLocalMutations(),null}(n,t,e,r):n instanceof Wl?function(s,i,o,c){if(!_M(s.precondition,i))return o;const u=VK(s.fieldTransforms,c,i),h=i.data;return h.setAll(DK(s)),h.setAll(u),i.convertToFoundDocument(i.version,h).setHasLocalMutations(),null===o?null:o.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(p=>p.field))}(n,t,e,r):(o=e,_M(n.precondition,i=t)?(i.convertToNoDocument(i.version).setHasLocalMutations(),null):o);var i,o}function m_e(n,t){let e=null;for(const r of n.fieldTransforms){const s=t.data.field(r.field),i=NK(r.transform,s||null);null!=i&&(null===e&&(e=S2.empty()),e.set(r.field,i))}return e||null}function RK(n,t){return n.type===t.type&&!!n.key.isEqual(t.key)&&!!n.precondition.isEqual(t.precondition)&&(r=t.fieldTransforms,!!(void 0===(e=n.fieldTransforms)&&void 0===r||e&&r&&Nf(e,r,(s,i)=>function d_e(n,t){return n.field.isEqual(t.field)&&(r=t.transform,(e=n.transform)instanceof Yu&&r instanceof Yu||e instanceof Ku&&r instanceof Ku?Nf(e.elements,r.elements,O4):e instanceof Df&&r instanceof Df?O4(e.yt,r.yt):e instanceof Rf&&r instanceof Rf);var e,r}(s,i))))&&(0===n.type?n.value.isEqual(t.value):1!==n.type||n.data.isEqual(t.data)&&n.fieldMask.isEqual(t.fieldMask));var e,r}class zf extends vM{constructor(t,e,r,s=[]){super(),this.key=t,this.value=e,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Wl extends vM{constructor(t,e,r,s,i=[]){super(),this.key=t,this.data=e,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function DK(n){const t=new Map;return n.fieldMask.fields.forEach(e=>{if(!e.isEmpty()){const r=n.data.field(e);t.set(e,r)}}),t}function zK(n,t,e){const r=new Map;sn(n.length===e.length);for(let s=0;s<e.length;s++){const i=n[s],o=i.transform,c=t.data.field(i.field);r.set(i.field,h_e(o,c,e[s]))}return r}function VK(n,t,e){const r=new Map;for(const s of n){const i=s.transform,o=e.data.field(s.field);r.set(s.field,f_e(i,o,t))}return r}class Vf extends vM{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class tx extends vM{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class __e{constructor(t){this.count=t}}var qs,_1;function HK(n){switch(n){default:return wt();case be.CANCELLED:case be.UNKNOWN:case be.DEADLINE_EXCEEDED:case be.RESOURCE_EXHAUSTED:case be.INTERNAL:case be.UNAVAILABLE:case be.UNAUTHENTICATED:return!1;case be.INVALID_ARGUMENT:case be.NOT_FOUND:case be.ALREADY_EXISTS:case be.PERMISSION_DENIED:case be.FAILED_PRECONDITION:case be.ABORTED:case be.OUT_OF_RANGE:case be.UNIMPLEMENTED:case be.DATA_LOSS:return!0}}function FK(n){if(void 0===n)return Ts("GRPC error has no .code"),be.UNKNOWN;switch(n){case qs.OK:return be.OK;case qs.CANCELLED:return be.CANCELLED;case qs.UNKNOWN:return be.UNKNOWN;case qs.DEADLINE_EXCEEDED:return be.DEADLINE_EXCEEDED;case qs.RESOURCE_EXHAUSTED:return be.RESOURCE_EXHAUSTED;case qs.INTERNAL:return be.INTERNAL;case qs.UNAVAILABLE:return be.UNAVAILABLE;case qs.UNAUTHENTICATED:return be.UNAUTHENTICATED;case qs.INVALID_ARGUMENT:return be.INVALID_ARGUMENT;case qs.NOT_FOUND:return be.NOT_FOUND;case qs.ALREADY_EXISTS:return be.ALREADY_EXISTS;case qs.PERMISSION_DENIED:return be.PERMISSION_DENIED;case qs.FAILED_PRECONDITION:return be.FAILED_PRECONDITION;case qs.ABORTED:return be.ABORTED;case qs.OUT_OF_RANGE:return be.OUT_OF_RANGE;case qs.UNIMPLEMENTED:return be.UNIMPLEMENTED;case qs.DATA_LOSS:return be.DATA_LOSS;default:return wt()}}(_1=qs||(qs={}))[_1.OK=0]="OK",_1[_1.CANCELLED=1]="CANCELLED",_1[_1.UNKNOWN=2]="UNKNOWN",_1[_1.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",_1[_1.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",_1[_1.NOT_FOUND=5]="NOT_FOUND",_1[_1.ALREADY_EXISTS=6]="ALREADY_EXISTS",_1[_1.PERMISSION_DENIED=7]="PERMISSION_DENIED",_1[_1.UNAUTHENTICATED=16]="UNAUTHENTICATED",_1[_1.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",_1[_1.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",_1[_1.ABORTED=10]="ABORTED",_1[_1.OUT_OF_RANGE=11]="OUT_OF_RANGE",_1[_1.UNIMPLEMENTED=12]="UNIMPLEMENTED",_1[_1.INTERNAL=13]="INTERNAL",_1[_1.UNAVAILABLE=14]="UNAVAILABLE",_1[_1.DATA_LOSS=15]="DATA_LOSS";class V0{constructor(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={},this.innerSize=0}get(t){const e=this.mapKeyFn(t),r=this.inner[e];if(void 0!==r)for(const[s,i]of r)if(this.equalsFn(s,t))return i}has(t){return void 0!==this.get(t)}set(t,e){const r=this.mapKeyFn(t),s=this.inner[r];if(void 0===s)return this.inner[r]=[[t,e]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],t))return void(s[i]=[t,e]);s.push([t,e]),this.innerSize++}delete(t){const e=this.mapKeyFn(t),r=this.inner[e];if(void 0===r)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],t))return 1===r.length?delete this.inner[e]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(t){Uu(this.inner,(e,r)=>{for(const[s,i]of r)t(s,i)})}isEmpty(){return sK(this.inner)}size(){return this.innerSize}}const v_e=new ds(ot.comparator);function ca(){return v_e}const BK=new ds(ot.comparator);function Ng(...n){let t=BK;for(const e of n)t=t.insert(e.key,e);return t}function $K(n){let t=BK;return n.forEach((e,r)=>t=t.insert(e,r.overlayedDocument)),t}function N4(){return Ag()}function UK(){return Ag()}function Ag(){return new V0(n=>n.toString(),(n,t)=>n.isEqual(t))}const C_e=new ds(ot.comparator),y_e=new sr(ot.comparator);function In(...n){let t=y_e;for(const e of n)t=t.add(e);return t}const E_e=new sr(vn);function CM(){return E_e}class Ig{constructor(t,e,r,s,i){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(t,e,r){const s=new Map;return s.set(t,xg.createSynthesizedTargetChangeForCurrentChange(t,e,r)),new Ig(on.min(),s,CM(),ca(),In())}}class xg{constructor(t,e,r,s,i){this.resumeToken=t,this.current=e,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(t,e,r){return new xg(r,e,In(),In(),In())}}class yM{constructor(t,e,r,s){this.Tt=t,this.removedTargetIds=e,this.key=r,this.Et=s}}class GK{constructor(t,e){this.targetId=t,this.At=e}}class WK{constructor(t,e,r=gi.EMPTY_BYTE_STRING,s=null){this.state=t,this.targetIds=e,this.resumeToken=r,this.cause=s}}class qK{constructor(){this.Rt=0,this.bt=ZK(),this.Pt=gi.EMPTY_BYTE_STRING,this.vt=!1,this.Vt=!0}get current(){return this.vt}get resumeToken(){return this.Pt}get St(){return 0!==this.Rt}get Dt(){return this.Vt}Ct(t){t.approximateByteSize()>0&&(this.Vt=!0,this.Pt=t)}xt(){let t=In(),e=In(),r=In();return this.bt.forEach((s,i)=>{switch(i){case 0:t=t.add(s);break;case 2:e=e.add(s);break;case 1:r=r.add(s);break;default:wt()}}),new xg(this.Pt,this.vt,t,e,r)}Nt(){this.Vt=!1,this.bt=ZK()}kt(t,e){this.Vt=!0,this.bt=this.bt.insert(t,e)}Ot(t){this.Vt=!0,this.bt=this.bt.remove(t)}Mt(){this.Rt+=1}Ft(){this.Rt-=1}$t(){this.Vt=!0,this.vt=!0}}class M_e{constructor(t){this.Bt=t,this.Lt=new Map,this.Ut=ca(),this.qt=jK(),this.Kt=new sr(vn)}Gt(t){for(const e of t.Tt)t.Et&&t.Et.isFoundDocument()?this.Qt(e,t.Et):this.jt(e,t.key,t.Et);for(const e of t.removedTargetIds)this.jt(e,t.key,t.Et)}Wt(t){this.forEachTarget(t,e=>{const r=this.zt(e);switch(t.state){case 0:this.Ht(e)&&r.Ct(t.resumeToken);break;case 1:r.Ft(),r.St||r.Nt(),r.Ct(t.resumeToken);break;case 2:r.Ft(),r.St||this.removeTarget(e);break;case 3:this.Ht(e)&&(r.$t(),r.Ct(t.resumeToken));break;case 4:this.Ht(e)&&(this.Jt(e),r.Ct(t.resumeToken));break;default:wt()}})}forEachTarget(t,e){t.targetIds.length>0?t.targetIds.forEach(e):this.Lt.forEach((r,s)=>{this.Ht(s)&&e(s)})}Yt(t){const e=t.targetId,r=t.At.count,s=this.Xt(e);if(s){const i=s.target;if(dM(i))if(0===r){const o=new ot(i.path);this.jt(e,o,vr.newNoDocument(o,on.min()))}else sn(1===r);else this.Zt(e)!==r&&(this.Jt(e),this.Kt=this.Kt.add(e))}}te(t){const e=new Map;this.Lt.forEach((i,o)=>{const c=this.Xt(o);if(c){if(i.current&&dM(c.target)){const u=new ot(c.target.path);null!==this.Ut.get(u)||this.ee(o,u)||this.jt(o,u,vr.newNoDocument(u,t))}i.Dt&&(e.set(o,i.xt()),i.Nt())}});let r=In();this.qt.forEach((i,o)=>{let c=!0;o.forEachWhile(u=>{const h=this.Xt(u);return!h||2===h.purpose||(c=!1,!1)}),c&&(r=r.add(i))}),this.Ut.forEach((i,o)=>o.setReadTime(t));const s=new Ig(t,e,this.Kt,this.Ut,r);return this.Ut=ca(),this.qt=jK(),this.Kt=new sr(vn),s}Qt(t,e){if(!this.Ht(t))return;const r=this.ee(t,e.key)?2:0;this.zt(t).kt(e.key,r),this.Ut=this.Ut.insert(e.key,e),this.qt=this.qt.insert(e.key,this.ne(e.key).add(t))}jt(t,e,r){if(!this.Ht(t))return;const s=this.zt(t);this.ee(t,e)?s.kt(e,1):s.Ot(e),this.qt=this.qt.insert(e,this.ne(e).delete(t)),r&&(this.Ut=this.Ut.insert(e,r))}removeTarget(t){this.Lt.delete(t)}Zt(t){const e=this.zt(t).xt();return this.Bt.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size}Mt(t){this.zt(t).Mt()}zt(t){let e=this.Lt.get(t);return e||(e=new qK,this.Lt.set(t,e)),e}ne(t){let e=this.qt.get(t);return e||(e=new sr(vn),this.qt=this.qt.insert(t,e)),e}Ht(t){const e=null!==this.Xt(t);return e||Ge("WatchChangeAggregator","Detected inactive target",t),e}Xt(t){const e=this.Lt.get(t);return e&&e.St?null:this.Bt.se(t)}Jt(t){this.Lt.set(t,new qK),this.Bt.getRemoteKeysForTarget(t).forEach(e=>{this.jt(t,e,null)})}ee(t,e){return this.Bt.getRemoteKeysForTarget(t).has(e)}}function jK(){return new ds(ot.comparator)}function ZK(){return new ds(ot.comparator)}const S_e={asc:"ASCENDING",desc:"DESCENDING"},P_e={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"};class T_e{constructor(t,e){this.databaseId=t,this.gt=e}}function kg(n,t){return n.gt?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function YK(n,t){return n.gt?t.toBase64():t.toUint8Array()}function w_e(n,t){return kg(n,t.toTimestamp())}function Fi(n){return sn(!!n),on.fromTimestamp(function(t){const e=L0(t);return new Jr(e.seconds,e.nanos)}(n))}function nx(n,t){return(e=n,new m1(["projects",e.projectId,"databases",e.database])).child("documents").child(t).canonicalString();var e}function KK(n){const t=m1.fromString(n);return sn(sX(t)),t}function Lg(n,t){return nx(n.databaseId,t.path)}function A4(n,t){const e=KK(t);if(e.get(1)!==n.databaseId.projectId)throw new Be(be.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+e.get(1)+" vs "+n.databaseId.projectId);if(e.get(3)!==n.databaseId.database)throw new Be(be.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+e.get(3)+" vs "+n.databaseId.database);return new ot(QK(e))}function rx(n,t){return nx(n.databaseId,t)}function Rg(n){return new m1(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function QK(n){return sn(n.length>4&&"documents"===n.get(4)),n.popFirst(5)}function JK(n,t,e){return{name:Lg(n,t),fields:e.value.mapValue.fields}}function tX(n,t){return{documents:[rx(n,t.path)]}}function ix(n,t){const e={structuredQuery:{}},r=t.path;null!==t.collectionGroup?(e.parent=rx(n,r),e.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(e.parent=rx(n,r.popLast()),e.structuredQuery.from=[{collectionId:r.lastSegment()}]);const s=function(u){if(0===u.length)return;const h=u.map(p=>function(m){if("=="===m.op){if(uK(m.value))return{unaryFilter:{field:Hf(m.field),op:"IS_NAN"}};if(lK(m.value))return{unaryFilter:{field:Hf(m.field),op:"IS_NULL"}}}else if("!="===m.op){if(uK(m.value))return{unaryFilter:{field:Hf(m.field),op:"IS_NOT_NAN"}};if(lK(m.value))return{unaryFilter:{field:Hf(m.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Hf(m.field),op:x_e(m.op),value:m.value}}}(p));return 1===h.length?h[0]:{compositeFilter:{op:"AND",filters:h}}}(t.filters);s&&(e.structuredQuery.where=s);const i=function(u){if(0!==u.length)return u.map(h=>{return{field:Hf((p=h).field),direction:I_e(p.dir)};var p})}(t.orderBy);i&&(e.structuredQuery.orderBy=i);const o=(h=t.limit,n.gt||yg(h)?h:{value:h});var h,c,u;return null!==o&&(e.structuredQuery.limit=o),t.startAt&&(e.structuredQuery.startAt={before:(c=t.startAt).inclusive,values:c.position}),t.endAt&&(e.structuredQuery.endAt={before:!(u=t.endAt).inclusive,values:u.position}),e}function nX(n){let t=function XK(n){const t=KK(n);return 4===t.length?m1.emptyPath():QK(t)}(n.parent);const e=n.structuredQuery,r=e.from?e.from.length:0;let s=null;if(r>0){sn(1===r);const p=e.from[0];p.allDescendants?s=p.collectionId:t=t.child(p.collectionId)}let i=[];e.where&&(i=rX(e.where));let o=[];e.orderBy&&(o=e.orderBy.map(p=>{return new xf(Ff((m=p).field),function(C){switch(C){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(m.direction));var m}));let c=null;e.limit&&(c=function(p){let m;return m="object"==typeof p?p.value:p,yg(m)?null:m}(e.limit));let u=null;var p;e.startAt&&(u=new z0((p=e.startAt).values||[],!!p.before));let h=null;return e.endAt&&(h=function(p){return new z0(p.values||[],!p.before)}(e.endAt)),function EK(n,t,e,r,s,i,o,c){return new Gl(n,t,e,r,s,i,o,c)}(t,s,o,i,c,"F",u,h)}function rX(n){return n?void 0!==n.unaryFilter?[L_e(n)]:void 0!==n.fieldFilter?[k_e(n)]:void 0!==n.compositeFilter?n.compositeFilter.filters.map(t=>rX(t)).reduce((t,e)=>t.concat(e)):wt():[]}function I_e(n){return S_e[n]}function x_e(n){return P_e[n]}function Hf(n){return{fieldPath:n.canonicalString()}}function Ff(n){return ws.fromServerFormat(n.fieldPath)}function k_e(n){return P2.create(Ff(n.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return wt()}}(n.fieldFilter.op),n.fieldFilter.value)}function L_e(n){switch(n.unaryFilter.op){case"IS_NAN":const t=Ff(n.unaryFilter.field);return P2.create(t,"==",{doubleValue:NaN});case"IS_NULL":const e=Ff(n.unaryFilter.field);return P2.create(e,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=Ff(n.unaryFilter.field);return P2.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=Ff(n.unaryFilter.field);return P2.create(s,"!=",{nullValue:"NULL_VALUE"});default:return wt()}}function R_e(n){const t=[];return n.fields.forEach(e=>t.push(e.canonicalString())),{fieldPaths:t}}function sX(n){return n.length>=4&&"projects"===n.get(0)&&"databases"===n.get(2)}class ax{constructor(t,e,r,s){this.batchId=t,this.localWriteTime=e,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(t,e){const r=e.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(t.key)&&g_e(i,t,r[s])}}applyToLocalView(t,e){for(const r of this.baseMutations)r.key.isEqual(t.key)&&(e=Og(r,t,e,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(t.key)&&(e=Og(r,t,e,this.localWriteTime));return e}applyToLocalDocumentSet(t,e){const r=UK();return this.mutations.forEach(s=>{const i=t.get(s.key),o=i.overlayedDocument;let c=this.applyToLocalView(o,i.mutatedFields);c=e.has(s.key)?null:c;const u=LK(o,c);null!==u&&r.set(s.key,u),o.isValidDocument()||o.convertToNoDocument(on.min())}),r}keys(){return this.mutations.reduce((t,e)=>t.add(e.key),In())}isEqual(t){return this.batchId===t.batchId&&Nf(this.mutations,t.mutations,(e,r)=>RK(e,r))&&Nf(this.baseMutations,t.baseMutations,(e,r)=>RK(e,r))}}class cx{constructor(t,e,r,s){this.batch=t,this.commitVersion=e,this.mutationResults=r,this.docVersions=s}static from(t,e,r){sn(t.mutations.length===r.length);let s=C_e;const i=t.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new cx(t,e,r,s)}}class lx{constructor(t,e){this.largestBatchId=t,this.mutation=e}getKey(){return this.mutation.key}isEqual(t){return null!==t&&this.mutation===t.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class H0{constructor(t,e,r,s,i=on.min(),o=on.min(),c=gi.EMPTY_BYTE_STRING){this.target=t,this.targetId=e,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=c}withSequenceNumber(t){return new H0(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(t,e){return new H0(this.target,this.targetId,this.purpose,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)}withLastLimboFreeSnapshotVersion(t){return new H0(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken)}}class fX{constructor(t){this.re=t}}function ux(n){const t=nX({parent:n.parent,structuredQuery:n.structuredQuery});return"LAST"===n.limitType?gM(t,t.limit,"L"):t}class e5{constructor(){}ce(t,e){this.ae(t,e),e.he()}ae(t,e){if("nullValue"in t)this.le(e,5);else if("booleanValue"in t)this.le(e,10),e.fe(t.booleanValue?1:0);else if("integerValue"in t)this.le(e,15),e.fe(ps(t.integerValue));else if("doubleValue"in t){const r=ps(t.doubleValue);isNaN(r)?this.le(e,13):(this.le(e,15),Eg(r)?e.fe(0):e.fe(r))}else if("timestampValue"in t){const r=t.timestampValue;this.le(e,20),"string"==typeof r?e.de(r):(e.de(`${r.seconds||""}`),e.fe(r.nanos||0))}else if("stringValue"in t)this._e(t.stringValue,e),this.we(e);else if("bytesValue"in t)this.le(e,30),e.me(Gu(t.bytesValue)),this.we(e);else if("referenceValue"in t)this.ge(t.referenceValue,e);else if("geoPointValue"in t){const r=t.geoPointValue;this.le(e,45),e.fe(r.latitude||0),e.fe(r.longitude||0)}else"mapValue"in t?fK(t)?this.le(e,Number.MAX_SAFE_INTEGER):(this.ye(t.mapValue,e),this.we(e)):"arrayValue"in t?(this.pe(t.arrayValue,e),this.we(e)):wt()}_e(t,e){this.le(e,25),this.Ie(t,e)}Ie(t,e){e.de(t)}ye(t,e){const r=t.fields||{};this.le(e,55);for(const s of Object.keys(r))this._e(s,e),this.ae(r[s],e)}pe(t,e){const r=t.values||[];this.le(e,50);for(const s of r)this.ae(s,e)}ge(t,e){this.le(e,37),ot.fromName(t).path.forEach(r=>{this.le(e,60),this.Ie(r,e)})}le(t,e){t.fe(e)}we(t){t.fe(2)}}e5.Te=new e5;class ave{constructor(){this.Ye=new hx}addToCollectionParentIndex(t,e){return this.Ye.add(e),Se.resolve()}getCollectionParents(t,e){return Se.resolve(this.Ye.getEntries(e))}addFieldIndex(t,e){return Se.resolve()}deleteFieldIndex(t,e){return Se.resolve()}getDocumentsMatchingTarget(t,e){return Se.resolve(null)}getIndexType(t,e){return Se.resolve(0)}getFieldIndexes(t,e){return Se.resolve([])}getNextCollectionGroupToUpdate(t){return Se.resolve(null)}getMinOffset(t,e){return Se.resolve($a.min())}getMinOffsetFromCollectionGroup(t,e){return Se.resolve($a.min())}updateCollectionGroup(t,e,r){return Se.resolve()}updateIndexEntries(t,e){return Se.resolve()}}class hx{constructor(){this.index={}}add(t){const e=t.lastSegment(),r=t.popLast(),s=this.index[e]||new sr(m1.comparator),i=!s.has(r);return this.index[e]=s.add(r),i}has(t){const e=t.lastSegment(),r=t.popLast(),s=this.index[e];return s&&s.has(r)}getEntries(t){return(this.index[t]||new sr(m1.comparator)).toArray()}}new Uint8Array(0);class la{constructor(t,e,r){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=r}static withCacheSize(t){return new la(t,la.DEFAULT_COLLECTION_PERCENTILE,la.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}la.DEFAULT_COLLECTION_PERCENTILE=10,la.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,la.DEFAULT=new la(41943040,la.DEFAULT_COLLECTION_PERCENTILE,la.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),la.DISABLED=new la(-1,0,0);class r5{constructor(t){this.bn=t}next(){return this.bn+=2,this.bn}static Pn(){return new r5(0)}static vn(){return new r5(-1)}}class _ve{constructor(t,e){this.overlayedDocument=t,this.mutatedFields=e}}class xX{constructor(t,e,r,s){this.remoteDocumentCache=t,this.mutationQueue=e,this.documentOverlayCache=r,this.indexManager=s}getDocument(t,e){let r=null;return this.documentOverlayCache.getOverlay(t,e).next(s=>(r=s,this.getBaseDocument(t,e,r))).next(s=>(null!==r&&Og(r.mutation,s,Ua.empty(),Jr.now()),s))}getDocuments(t,e){return this.remoteDocumentCache.getEntries(t,e).next(r=>this.getLocalViewOfDocuments(t,r,In()).next(()=>r))}getLocalViewOfDocuments(t,e,r=In()){const s=N4();return this.populateOverlays(t,s,e).next(()=>this.computeViews(t,e,s,r).next(i=>{let o=Ng();return i.forEach((c,u)=>{o=o.insert(c,u.overlayedDocument)}),o}))}getOverlayedDocuments(t,e){const r=N4();return this.populateOverlays(t,r,e).next(()=>this.computeViews(t,e,r,In()))}populateOverlays(t,e,r){const s=[];return r.forEach(i=>{e.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(t,s).next(i=>{i.forEach((o,c)=>{e.set(o,c)})})}computeViews(t,e,r,s){let i=ca();const o=Ag(),c=Ag();return e.forEach((u,h)=>{const p=r.get(h.key);s.has(h.key)&&(void 0===p||p.mutation instanceof Wl)?i=i.insert(h.key,h):void 0!==p&&(o.set(h.key,p.mutation.getFieldMask()),Og(p.mutation,h,p.mutation.getFieldMask(),Jr.now()))}),this.recalculateAndSaveOverlays(t,i).next(u=>(u.forEach((h,p)=>o.set(h,p)),e.forEach((h,p)=>{var m;return c.set(h,new _ve(p,null!==(m=o.get(h))&&void 0!==m?m:null))}),c))}recalculateAndSaveOverlays(t,e){const r=Ag();let s=new ds((o,c)=>o-c),i=In();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next(o=>{for(const c of o)c.keys().forEach(u=>{const h=e.get(u);if(null===h)return;let p=r.get(u)||Ua.empty();p=c.applyToLocalView(h,p),r.set(u,p);const m=(s.get(c.batchId)||In()).add(u);s=s.insert(c.batchId,m)})}).next(()=>{const o=[],c=s.getReverseIterator();for(;c.hasNext();){const u=c.getNext(),h=u.key,p=u.value,m=UK();p.forEach(C=>{if(!i.has(C)){const w=LK(e.get(C),r.get(C));null!==w&&m.set(C,w),i=i.add(C)}}),o.push(this.documentOverlayCache.saveOverlays(t,h,m))}return Se.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(t,e){return this.remoteDocumentCache.getEntries(t,e).next(r=>this.recalculateAndSaveOverlays(t,r))}getDocumentsMatchingQuery(t,e,r){return ot.isDocumentKey((s=e).path)&&null===s.collectionGroup&&0===s.filters.length?this.getDocumentsMatchingDocumentQuery(t,e.path):QI(e)?this.getDocumentsMatchingCollectionGroupQuery(t,e,r):this.getDocumentsMatchingCollectionQuery(t,e,r);var s}getNextDocuments(t,e,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(t,e,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,e,r.largestBatchId,s-i.size):Se.resolve(N4());let c=-1,u=i;return o.next(h=>Se.forEach(h,(p,m)=>(c<m.largestBatchId&&(c=m.largestBatchId),i.get(p)?Se.resolve():this.getBaseDocument(t,p,m).next(C=>{u=u.insert(p,C)}))).next(()=>this.populateOverlays(t,h,i)).next(()=>this.computeViews(t,u,h,In())).next(p=>({batchId:c,changes:$K(p)})))})}getDocumentsMatchingDocumentQuery(t,e){return this.getDocument(t,new ot(e)).next(r=>{let s=Ng();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(t,e,r){const s=e.collectionGroup;let i=Ng();return this.indexManager.getCollectionParents(t,s).next(o=>Se.forEach(o,c=>{const u=(h=e,p=c.child(s),new Gl(p,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt));var h,p;return this.getDocumentsMatchingCollectionQuery(t,u,r).next(h=>{h.forEach((p,m)=>{i=i.insert(p,m)})})}).next(()=>i))}getDocumentsMatchingCollectionQuery(t,e,r){let s;return this.remoteDocumentCache.getAllFromCollection(t,e.path,r).next(i=>(s=i,this.documentOverlayCache.getOverlaysForCollection(t,e.path,r.largestBatchId))).next(i=>{i.forEach((c,u)=>{const h=u.getKey();null===s.get(h)&&(s=s.insert(h,vr.newInvalidDocument(h)))});let o=Ng();return s.forEach((c,u)=>{const h=i.get(c);void 0!==h&&Og(h.mutation,u,Ua.empty(),Jr.now()),ex(e,u)&&(o=o.insert(c,u))}),o})}getBaseDocument(t,e,r){return null===r||1===r.mutation.type?this.remoteDocumentCache.getEntry(t,e):Se.resolve(vr.newInvalidDocument(e))}}class vve{constructor(t){this.It=t,this.Zn=new Map,this.ts=new Map}getBundleMetadata(t,e){return Se.resolve(this.Zn.get(e))}saveBundleMetadata(t,e){var r;return this.Zn.set(e.id,{id:(r=e).id,version:r.version,createTime:Fi(r.createTime)}),Se.resolve()}getNamedQuery(t,e){return Se.resolve(this.ts.get(e))}saveNamedQuery(t,e){return this.ts.set(e.name,{name:(r=e).name,query:ux(r.bundledQuery),readTime:Fi(r.readTime)}),Se.resolve();var r}}class Cve{constructor(){this.overlays=new ds(ot.comparator),this.es=new Map}getOverlay(t,e){return Se.resolve(this.overlays.get(e))}getOverlays(t,e){const r=N4();return Se.forEach(e,s=>this.getOverlay(t,s).next(i=>{null!==i&&r.set(s,i)})).next(()=>r)}saveOverlays(t,e,r){return r.forEach((s,i)=>{this.ue(t,e,i)}),Se.resolve()}removeOverlaysForBatchId(t,e,r){const s=this.es.get(r);return void 0!==s&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.es.delete(r)),Se.resolve()}getOverlaysForCollection(t,e,r){const s=N4(),i=e.length+1,o=new ot(e.child("")),c=this.overlays.getIteratorFrom(o);for(;c.hasNext();){const u=c.getNext().value,h=u.getKey();if(!e.isPrefixOf(h.path))break;h.path.length===i&&u.largestBatchId>r&&s.set(u.getKey(),u)}return Se.resolve(s)}getOverlaysForCollectionGroup(t,e,r,s){let i=new ds((h,p)=>h-p);const o=this.overlays.getIterator();for(;o.hasNext();){const h=o.getNext().value;if(h.getKey().getCollectionGroup()===e&&h.largestBatchId>r){let p=i.get(h.largestBatchId);null===p&&(p=N4(),i=i.insert(h.largestBatchId,p)),p.set(h.getKey(),h)}}const c=N4(),u=i.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((h,p)=>c.set(h,p)),!(c.size()>=s)););return Se.resolve(c)}ue(t,e,r){const s=this.overlays.get(r.key);if(null!==s){const o=this.es.get(s.largestBatchId).delete(r.key);this.es.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new lx(e,r));let i=this.es.get(e);void 0===i&&(i=In(),this.es.set(e,i)),this.es.set(e,i.add(r.key))}}class dx{constructor(){this.ns=new sr($i.ss),this.rs=new sr($i.os)}isEmpty(){return this.ns.isEmpty()}addReference(t,e){const r=new $i(t,e);this.ns=this.ns.add(r),this.rs=this.rs.add(r)}us(t,e){t.forEach(r=>this.addReference(r,e))}removeReference(t,e){this.cs(new $i(t,e))}hs(t,e){t.forEach(r=>this.removeReference(r,e))}ls(t){const e=new ot(new m1([])),r=new $i(e,t),s=new $i(e,t+1),i=[];return this.rs.forEachInRange([r,s],o=>{this.cs(o),i.push(o.key)}),i}fs(){this.ns.forEach(t=>this.cs(t))}cs(t){this.ns=this.ns.delete(t),this.rs=this.rs.delete(t)}ds(t){const e=new ot(new m1([])),r=new $i(e,t),s=new $i(e,t+1);let i=In();return this.rs.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(t){const e=new $i(t,0),r=this.ns.firstAfterOrEqual(e);return null!==r&&t.isEqual(r.key)}}class $i{constructor(t,e){this.key=t,this._s=e}static ss(t,e){return ot.comparator(t.key,e.key)||vn(t._s,e._s)}static os(t,e){return vn(t._s,e._s)||ot.comparator(t.key,e.key)}}class yve{constructor(t,e){this.indexManager=t,this.referenceDelegate=e,this.mutationQueue=[],this.ws=1,this.gs=new sr($i.ss)}checkEmpty(t){return Se.resolve(0===this.mutationQueue.length)}addMutationBatch(t,e,r,s){const i=this.ws;this.ws++;const o=new ax(i,e,r,s);this.mutationQueue.push(o);for(const c of s)this.gs=this.gs.add(new $i(c.key,i)),this.indexManager.addToCollectionParentIndex(t,c.key.path.popLast());return Se.resolve(o)}lookupMutationBatch(t,e){return Se.resolve(this.ys(e))}getNextMutationBatchAfterBatchId(t,e){const s=this.ps(e+1),i=s<0?0:s;return Se.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return Se.resolve(0===this.mutationQueue.length?-1:this.ws-1)}getAllMutationBatches(t){return Se.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,e){const r=new $i(e,0),s=new $i(e,Number.POSITIVE_INFINITY),i=[];return this.gs.forEachInRange([r,s],o=>{const c=this.ys(o._s);i.push(c)}),Se.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(t,e){let r=new sr(vn);return e.forEach(s=>{const i=new $i(s,0),o=new $i(s,Number.POSITIVE_INFINITY);this.gs.forEachInRange([i,o],c=>{r=r.add(c._s)})}),Se.resolve(this.Is(r))}getAllMutationBatchesAffectingQuery(t,e){const r=e.path,s=r.length+1;let i=r;ot.isDocumentKey(i)||(i=i.child(""));const o=new $i(new ot(i),0);let c=new sr(vn);return this.gs.forEachWhile(u=>{const h=u.key.path;return!!r.isPrefixOf(h)&&(h.length===s&&(c=c.add(u._s)),!0)},o),Se.resolve(this.Is(c))}Is(t){const e=[];return t.forEach(r=>{const s=this.ys(r);null!==s&&e.push(s)}),e}removeMutationBatch(t,e){sn(0===this.Ts(e.batchId,"removed")),this.mutationQueue.shift();let r=this.gs;return Se.forEach(e.mutations,s=>{const i=new $i(s.key,e.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(t,s.key)}).next(()=>{this.gs=r})}An(t){}containsKey(t,e){const r=new $i(e,0),s=this.gs.firstAfterOrEqual(r);return Se.resolve(e.isEqual(s&&s.key))}performConsistencyCheck(t){return Se.resolve()}Ts(t,e){return this.ps(t)}ps(t){return 0===this.mutationQueue.length?0:t-this.mutationQueue[0].batchId}ys(t){const e=this.ps(t);return e<0||e>=this.mutationQueue.length?null:this.mutationQueue[e]}}class Eve{constructor(t){this.Es=t,this.docs=new ds(ot.comparator),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,e){const r=e.key,s=this.docs.get(r),i=s?s.size:0,o=this.Es(e);return this.docs=this.docs.insert(r,{document:e.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(t,r.path.popLast())}removeEntry(t){const e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}getEntry(t,e){const r=this.docs.get(e);return Se.resolve(r?r.document.mutableCopy():vr.newInvalidDocument(e))}getEntries(t,e){let r=ca();return e.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():vr.newInvalidDocument(s))}),Se.resolve(r)}getAllFromCollection(t,e,r){let s=ca();const i=new ot(e.child("")),o=this.docs.getIteratorFrom(i);for(;o.hasNext();){const{key:c,value:{document:u}}=o.getNext();if(!e.isPrefixOf(c.path))break;c.path.length>e.length+1||GI(eK(u),r)<=0||(s=s.insert(u.key,u.mutableCopy()))}return Se.resolve(s)}getAllFromCollectionGroup(t,e,r,s){wt()}As(t,e){return Se.forEach(this.docs,r=>e(r))}newChangeBuffer(t){return new Mve(this)}getSize(t){return Se.resolve(this.size)}}class Mve extends class pve{constructor(){this.changes=new V0(t=>t.toString(),(t,e)=>t.isEqual(e)),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,e){this.assertNotApplied(),this.changes.set(t,vr.newInvalidDocument(t).setReadTime(e))}getEntry(t,e){this.assertNotApplied();const r=this.changes.get(e);return void 0!==r?Se.resolve(r):this.getFromCache(t,e)}getEntries(t,e){return this.getAllFromCache(t,e)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}{constructor(t){super(),this.Yn=t}applyChanges(t){const e=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?e.push(this.Yn.addEntry(t,s)):this.Yn.removeEntry(r)}),Se.waitFor(e)}getFromCache(t,e){return this.Yn.getEntry(t,e)}getAllFromCache(t,e){return this.Yn.getEntries(t,e)}}class Sve{constructor(t){this.persistence=t,this.Rs=new V0(e=>Zu(e),Tg),this.lastRemoteSnapshotVersion=on.min(),this.highestTargetId=0,this.bs=0,this.Ps=new dx,this.targetCount=0,this.vs=r5.Pn()}forEachTarget(t,e){return this.Rs.forEach((r,s)=>e(s)),Se.resolve()}getLastRemoteSnapshotVersion(t){return Se.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return Se.resolve(this.bs)}allocateTargetId(t){return this.highestTargetId=this.vs.next(),Se.resolve(this.highestTargetId)}setTargetsMetadata(t,e,r){return r&&(this.lastRemoteSnapshotVersion=r),e>this.bs&&(this.bs=e),Se.resolve()}Dn(t){this.Rs.set(t.target,t);const e=t.targetId;e>this.highestTargetId&&(this.vs=new r5(e),this.highestTargetId=e),t.sequenceNumber>this.bs&&(this.bs=t.sequenceNumber)}addTargetData(t,e){return this.Dn(e),this.targetCount+=1,Se.resolve()}updateTargetData(t,e){return this.Dn(e),Se.resolve()}removeTargetData(t,e){return this.Rs.delete(e.target),this.Ps.ls(e.targetId),this.targetCount-=1,Se.resolve()}removeTargets(t,e,r){let s=0;const i=[];return this.Rs.forEach((o,c)=>{c.sequenceNumber<=e&&null===r.get(c.targetId)&&(this.Rs.delete(o),i.push(this.removeMatchingKeysForTargetId(t,c.targetId)),s++)}),Se.waitFor(i).next(()=>s)}getTargetCount(t){return Se.resolve(this.targetCount)}getTargetData(t,e){const r=this.Rs.get(e)||null;return Se.resolve(r)}addMatchingKeys(t,e,r){return this.Ps.us(e,r),Se.resolve()}removeMatchingKeys(t,e,r){this.Ps.hs(e,r);const s=this.persistence.referenceDelegate,i=[];return s&&e.forEach(o=>{i.push(s.markPotentiallyOrphaned(t,o))}),Se.waitFor(i)}removeMatchingKeysForTargetId(t,e){return this.Ps.ls(e),Se.resolve()}getMatchingKeysForTargetId(t,e){const r=this.Ps.ds(e);return Se.resolve(r)}containsKey(t,e){return Se.resolve(this.Ps.containsKey(e))}}class kX{constructor(t,e){this.Vs={},this.overlays={},this.Ss=new aa(0),this.Ds=!1,this.Ds=!0,this.referenceDelegate=t(this),this.Cs=new Sve(this),this.indexManager=new ave,this.remoteDocumentCache=new Eve(r=>this.referenceDelegate.xs(r)),this.It=new fX(e),this.Ns=new vve(this.It)}start(){return Promise.resolve()}shutdown(){return this.Ds=!1,Promise.resolve()}get started(){return this.Ds}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let e=this.overlays[t.toKey()];return e||(e=new Cve,this.overlays[t.toKey()]=e),e}getMutationQueue(t,e){let r=this.Vs[t.toKey()];return r||(r=new yve(e,this.referenceDelegate),this.Vs[t.toKey()]=r),r}getTargetCache(){return this.Cs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ns}runTransaction(t,e,r){Ge("MemoryPersistence","Starting transaction:",t);const s=new Pve(this.Ss.next());return this.referenceDelegate.ks(),r(s).next(i=>this.referenceDelegate.Os(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Ms(t,e){return Se.or(Object.values(this.Vs).map(r=>()=>r.containsKey(t,e)))}}class Pve extends class Wme{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(t=>t())}}{constructor(t){super(),this.currentSequenceNumber=t}}class NM{constructor(t){this.persistence=t,this.Fs=new dx,this.$s=null}static Bs(t){return new NM(t)}get Ls(){if(this.$s)return this.$s;throw wt()}addReference(t,e,r){return this.Fs.addReference(r,e),this.Ls.delete(r.toString()),Se.resolve()}removeReference(t,e,r){return this.Fs.removeReference(r,e),this.Ls.add(r.toString()),Se.resolve()}markPotentiallyOrphaned(t,e){return this.Ls.add(e.toString()),Se.resolve()}removeTarget(t,e){this.Fs.ls(e.targetId).forEach(s=>this.Ls.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(t,e.targetId).next(s=>{s.forEach(i=>this.Ls.add(i.toString()))}).next(()=>r.removeTargetData(t,e))}ks(){this.$s=new Set}Os(t){const e=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Se.forEach(this.Ls,r=>{const s=ot.fromPath(r);return this.Us(t,s).next(i=>{i||e.removeEntry(s,on.min())})}).next(()=>(this.$s=null,e.apply(t)))}updateLimboDocument(t,e){return this.Us(t,e).next(r=>{r?this.Ls.delete(e.toString()):this.Ls.add(e.toString())})}xs(t){return 0}Us(t,e){return Se.or([()=>Se.resolve(this.Fs.containsKey(e)),()=>this.persistence.getTargetCache().containsKey(t,e),()=>this.persistence.Ms(t,e)])}}class _x{constructor(t,e,r,s){this.targetId=t,this.fromCache=e,this.Si=r,this.Di=s}static Ci(t,e){let r=In(),s=In();for(const i of e.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new _x(t,e.fromCache,r,s)}}class RX{constructor(){this.xi=!1}initialize(t,e){this.Ni=t,this.indexManager=e,this.xi=!0}getDocumentsMatchingQuery(t,e,r,s){return this.ki(t,e).next(i=>i||this.Oi(t,e,s,r)).next(i=>i||this.Mi(t,e))}ki(t,e){if(MK(e))return Se.resolve(null);let r=Ao(e);return this.indexManager.getIndexType(t,r).next(s=>0===s?null:(null!==e.limit&&1===s&&(e=gM(e,null,"F"),r=Ao(e)),this.indexManager.getDocumentsMatchingTarget(t,r).next(i=>{const o=In(...i);return this.Ni.getDocuments(t,o).next(c=>this.indexManager.getMinOffset(t,r).next(u=>{const h=this.Fi(e,c);return this.$i(e,h,o,u.readTime)?this.ki(t,gM(e,null,"F")):this.Bi(t,h,e,u)}))})))}Oi(t,e,r,s){return MK(e)||s.isEqual(on.min())?this.Mi(t,e):this.Ni.getDocuments(t,r).next(i=>{const o=this.Fi(e,i);return this.$i(e,o,r,s)?this.Mi(t,e):(BI()<=g1.DEBUG&&Ge("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),JI(e)),this.Bi(t,o,e,function JY(n,t){const e=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,s=on.fromTimestamp(1e9===r?new Jr(e+1,0):new Jr(e,r));return new $a(s,ot.empty(),t)}(s,-1)))})}Fi(t,e){let r=new sr(TK(t));return e.forEach((s,i)=>{ex(t,i)&&(r=r.add(i))}),r}$i(t,e,r,s){if(null===t.limit)return!1;if(r.size!==e.size)return!0;const i="F"===t.limitType?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Mi(t,e){return BI()<=g1.DEBUG&&Ge("QueryEngine","Using full collection scan to execute query:",JI(e)),this.Ni.getDocumentsMatchingQuery(t,e,$a.min())}Bi(t,e,r,s){return this.Ni.getDocumentsMatchingQuery(t,r,s).next(i=>(e.forEach(o=>{i=i.insert(o.key,o)}),i))}}class wve{constructor(t,e,r,s){this.persistence=t,this.Li=e,this.It=s,this.Ui=new ds(vn),this.qi=new V0(i=>Zu(i),Tg),this.Ki=new Map,this.Gi=t.getRemoteDocumentCache(),this.Cs=t.getTargetCache(),this.Ns=t.getBundleCache(),this.Qi(r)}Qi(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new xX(this.Gi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Gi.setIndexManager(this.indexManager),this.Li.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",e=>t.collect(e,this.Ui))}}function zX(n,t){return vx.apply(this,arguments)}function vx(){return vx=A(function*(n,t){const e=lt(n);return yield e.persistence.runTransaction("Handle user change","readonly",r=>{let s;return e.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,e.Qi(t),e.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],c=[];let u=In();for(const h of s){o.push(h.batchId);for(const p of h.mutations)u=u.add(p.key)}for(const h of i){c.push(h.batchId);for(const p of h.mutations)u=u.add(p.key)}return e.localDocuments.getDocuments(r,u).next(h=>({ji:h,removedBatchIds:o,addedBatchIds:c}))})})}),vx.apply(this,arguments)}function bve(n,t){const e=lt(n);return e.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=t.batch.keys(),i=e.Gi.newChangeBuffer({trackRemovals:!0});return function(o,c,u,h){const p=u.batch,m=p.keys();let C=Se.resolve();return m.forEach(w=>{C=C.next(()=>h.getEntry(c,w)).next(I=>{const H=u.docVersions.get(w);sn(null!==H),I.version.compareTo(H)<0&&(p.applyToRemoteDocument(I,u),I.isValidDocument()&&(I.setReadTime(u.commitVersion),h.addEntry(I)))})}),C.next(()=>o.mutationQueue.removeMutationBatch(c,p))}(e,r,t,i).next(()=>i.apply(r)).next(()=>e.mutationQueue.performConsistencyCheck(r)).next(()=>e.documentOverlayCache.removeOverlaysForBatchId(r,s,t.batch.batchId)).next(()=>e.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(o){let c=In();for(let u=0;u<o.mutationResults.length;++u)o.mutationResults[u].transformResults.length>0&&(c=c.add(o.batch.mutations[u].key));return c}(t))).next(()=>e.localDocuments.getDocuments(r,s))})}function VX(n){const t=lt(n);return t.persistence.runTransaction("Get last remote snapshot version","readonly",e=>t.Cs.getLastRemoteSnapshotVersion(e))}function Ove(n,t){const e=lt(n),r=t.snapshotVersion;let s=e.Ui;return e.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=e.Gi.newChangeBuffer({trackRemovals:!0});s=e.Ui;const c=[];t.targetChanges.forEach((p,m)=>{const C=s.get(m);if(!C)return;c.push(e.Cs.removeMatchingKeys(i,p.removedDocuments,m).next(()=>e.Cs.addMatchingKeys(i,p.addedDocuments,m)));let w=C.withSequenceNumber(i.currentSequenceNumber);var I,H,K;t.targetMismatches.has(m)?w=w.withResumeToken(gi.EMPTY_BYTE_STRING,on.min()).withLastLimboFreeSnapshotVersion(on.min()):p.resumeToken.approximateByteSize()>0&&(w=w.withResumeToken(p.resumeToken,r)),s=s.insert(m,w),H=w,K=p,(0===(I=C).resumeToken.approximateByteSize()||H.snapshotVersion.toMicroseconds()-I.snapshotVersion.toMicroseconds()>=3e8||K.addedDocuments.size+K.modifiedDocuments.size+K.removedDocuments.size>0)&&c.push(e.Cs.updateTargetData(i,w))});let u=ca(),h=In();if(t.documentUpdates.forEach(p=>{t.resolvedLimboDocuments.has(p)&&c.push(e.persistence.referenceDelegate.updateLimboDocument(i,p))}),c.push(function HX(n,t,e){let r=In(),s=In();return e.forEach(i=>r=r.add(i)),t.getEntries(n,r).next(i=>{let o=ca();return e.forEach((c,u)=>{const h=i.get(c);u.isFoundDocument()!==h.isFoundDocument()&&(s=s.add(c)),u.isNoDocument()&&u.version.isEqual(on.min())?(t.removeEntry(c,u.readTime),o=o.insert(c,u)):!h.isValidDocument()||u.version.compareTo(h.version)>0||0===u.version.compareTo(h.version)&&h.hasPendingWrites?(t.addEntry(u),o=o.insert(c,u)):Ge("LocalStore","Ignoring outdated watch update for ",c,". Current version:",h.version," Watch version:",u.version)}),{Wi:o,zi:s}})}(i,o,t.documentUpdates).next(p=>{u=p.Wi,h=p.zi})),!r.isEqual(on.min())){const p=e.Cs.getLastRemoteSnapshotVersion(i).next(m=>e.Cs.setTargetsMetadata(i,i.currentSequenceNumber,r));c.push(p)}return Se.waitFor(c).next(()=>o.apply(i)).next(()=>e.localDocuments.getLocalViewOfDocuments(i,u,h)).next(()=>u)}).then(i=>(e.Ui=s,i))}function Nve(n,t){const e=lt(n);return e.persistence.runTransaction("Get next mutation batch","readonly",r=>(void 0===t&&(t=-1),e.mutationQueue.getNextMutationBatchAfterBatchId(r,t)))}function Uf(n,t){const e=lt(n);return e.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return e.Cs.getTargetData(r,t).next(i=>i?(s=i,Se.resolve(s)):e.Cs.allocateTargetId(r).next(o=>(s=new H0(t,o,0,r.currentSequenceNumber),e.Cs.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=e.Ui.get(r.targetId);return(null===s||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(e.Ui=e.Ui.insert(r.targetId,r),e.qi.set(t,r.targetId)),r})}function Gf(n,t,e){return Cx.apply(this,arguments)}function Cx(){return Cx=A(function*(n,t,e){const r=lt(n),s=r.Ui.get(t),i=e?"readwrite":"readwrite-primary";try{e||(yield r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s)))}catch(o){if(!k0(o))throw o;Ge("LocalStore",`Failed to update sequence numbers for target ${t}: ${o}`)}r.Ui=r.Ui.remove(t),r.qi.delete(s.target)}),Cx.apply(this,arguments)}function IM(n,t,e){const r=lt(n);let s=on.min(),i=In();return r.persistence.runTransaction("Execute query","readonly",o=>function(c,u,h){const p=lt(c),m=p.qi.get(h);return void 0!==m?Se.resolve(p.Ui.get(m)):p.Cs.getTargetData(u,h)}(r,o,Ao(t)).next(c=>{if(c)return s=c.lastLimboFreeSnapshotVersion,r.Cs.getMatchingKeysForTargetId(o,c.targetId).next(u=>{i=u})}).next(()=>r.Li.getDocumentsMatchingQuery(o,t,e?s:on.min(),e?i:In())).next(c=>(function $X(n,t,e){let r=n.Ki.get(t)||on.min();e.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),n.Ki.set(t,r)}(r,function PK(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}(t),c),{documents:c,Hi:i})))}class Px{constructor(){this.activeTargetIds=CM()}er(t){this.activeTargetIds=this.activeTargetIds.add(t)}nr(t){this.activeTargetIds=this.activeTargetIds.delete(t)}tr(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class WX{constructor(){this.Lr=new Px,this.Ur={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,e,r){}addLocalQueryTarget(t){return this.Lr.er(t),this.Ur[t]||"not-current"}updateQueryState(t,e,r){this.Ur[t]=e}removeLocalQueryTarget(t){this.Lr.nr(t)}isLocalQueryTarget(t){return this.Lr.activeTargetIds.has(t)}clearQueryState(t){delete this.Ur[t]}getAllActiveQueryTargets(){return this.Lr.activeTargetIds}isActiveQueryTarget(t){return this.Lr.activeTargetIds.has(t)}start(){return this.Lr=new Px,Promise.resolve()}handleUserChange(t,e,r){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}class xve{qr(t){}shutdown(){}}class qX{constructor(){this.Kr=()=>this.Gr(),this.Qr=()=>this.jr(),this.Wr=[],this.zr()}qr(t){this.Wr.push(t)}shutdown(){window.removeEventListener("online",this.Kr),window.removeEventListener("offline",this.Qr)}zr(){window.addEventListener("online",this.Kr),window.addEventListener("offline",this.Qr)}Gr(){Ge("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const t of this.Wr)t(0)}jr(){Ge("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const t of this.Wr)t(1)}static C(){return typeof window<"u"&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}const kve={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Lve{constructor(t){this.Hr=t.Hr,this.Jr=t.Jr}Yr(t){this.Xr=t}Zr(t){this.eo=t}onMessage(t){this.no=t}close(){this.Jr()}send(t){this.Hr(t)}so(){this.Xr()}io(t){this.eo(t)}ro(t){this.no(t)}}class Rve extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId,this.oo=(t.ssl?"https":"http")+"://"+t.host,this.uo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}get co(){return!1}ao(t,e,r,s,i){const o=this.ho(t,e);Ge("RestConnection","Sending: ",o,r);const c={};return this.lo(c,s,i),this.fo(t,o,c,r).then(u=>(Ge("RestConnection","Received: ",u),u),u=>{throw Of("RestConnection",`${t} failed with error: `,u,"url: ",o,"request:",r),u})}_o(t,e,r,s,i,o){return this.ao(t,e,r,s,i)}lo(t,e,r){t["X-Goog-Api-Client"]="gl-js/ fire/"+bf,t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e&&e.headers.forEach((s,i)=>t[i]=s),r&&r.headers.forEach((s,i)=>t[i]=s)}ho(t,e){return`${this.oo}/v1/${e}:${kve[t]}`}}{constructor(t){super(t),this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams}fo(t,e,r,s){return new Promise((i,o)=>{const c=new Lme;c.setWithCredentials(!0),c.listenOnce(Ime.COMPLETE,()=>{var h;try{switch(c.getLastErrorCode()){case FI.NO_ERROR:const p=c.getResponseJson();Ge("Connection","XHR received:",JSON.stringify(p)),i(p);break;case FI.TIMEOUT:Ge("Connection",'RPC "'+t+'" timed out'),o(new Be(be.DEADLINE_EXCEEDED,"Request time out"));break;case FI.HTTP_ERROR:const m=c.getStatus();if(Ge("Connection",'RPC "'+t+'" failed with status:',m,"response text:",c.getResponseText()),m>0){let C=c.getResponseJson();Array.isArray(C)&&(C=C[0]);const w=null===(h=C)||void 0===h?void 0:h.error;if(w&&w.status&&w.message){const I=function(H){const K=H.toLowerCase().replace(/_/g,"-");return Object.values(be).indexOf(K)>=0?K:be.UNKNOWN}(w.status);o(new Be(I,w.message))}else o(new Be(be.UNKNOWN,"Server responded with status "+c.getStatus()))}else o(new Be(be.UNAVAILABLE,"Connection failed."));break;default:wt()}}finally{Ge("Connection",'RPC "'+t+'" completed.')}});const u=JSON.stringify(s);c.send(e,"POST",u,r,15)})}wo(t,e,r){const s=[this.oo,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=Nme(),o=Ame(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(c.xmlHttpFactory=new kme({})),this.lo(c.initMessageHeaders,e,r),c.encodeInitMessageHeaders=!0;const u=s.join("");Ge("Connection","Creating WebChannel: "+u,c);const h=i.createWebChannel(u,c);let p=!1,m=!1;const C=new Lve({Hr:I=>{m?Ge("Connection","Not sending because WebChannel is closed:",I):(p||(Ge("Connection","Opening WebChannel transport."),h.open(),p=!0),Ge("Connection","WebChannel sending:",I),h.send(I))},Jr:()=>h.close()}),w=(I,H,K)=>{I.listen(H,ie=>{try{K(ie)}catch(ye){setTimeout(()=>{throw ye},0)}})};return w(h,oM.EventType.OPEN,()=>{m||Ge("Connection","WebChannel transport opened.")}),w(h,oM.EventType.CLOSE,()=>{m||(m=!0,Ge("Connection","WebChannel transport closed"),C.io())}),w(h,oM.EventType.ERROR,I=>{m||(m=!0,Of("Connection","WebChannel transport errored:",I),C.io(new Be(be.UNAVAILABLE,"The operation could not be completed")))}),w(h,oM.EventType.MESSAGE,I=>{var H;if(!m){const K=I.data[0];sn(!!K);const ie=K,ye=ie.error||(null===(H=ie[0])||void 0===H?void 0:H.error);if(ye){Ge("Connection","WebChannel received error:",ye);const te=ye.status;let ke=function(Xe){const Ft=qs[Xe];if(void 0!==Ft)return FK(Ft)}(te),$e=ye.message;void 0===ke&&(ke=be.INTERNAL,$e="Unknown error status: "+te+" with message "+ye.message),m=!0,C.io(new Be(ke,$e)),h.close()}else Ge("Connection","WebChannel received:",K),C.ro(K)}}),w(o,xme.STAT_EVENT,I=>{I.stat===jY.PROXY?Ge("Connection","Detected buffering proxy"):I.stat===jY.NOPROXY&&Ge("Connection","Detected no buffering proxy")}),setTimeout(()=>{C.so()},0),C}}function LM(){return typeof document<"u"?document:null}function Wg(n){return new T_e(n,!0)}class wx{constructor(t,e,r=1e3,s=1.5,i=6e4){this.Hs=t,this.timerId=e,this.mo=r,this.yo=s,this.po=i,this.Io=0,this.To=null,this.Eo=Date.now(),this.reset()}reset(){this.Io=0}Ao(){this.Io=this.po}Ro(t){this.cancel();const e=Math.floor(this.Io+this.bo()),r=Math.max(0,Date.now()-this.Eo),s=Math.max(0,e-r);s>0&&Ge("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Io} ms, delay with jitter: ${e} ms, last attempt: ${r} ms ago)`),this.To=this.Hs.enqueueAfterDelay(this.timerId,s,()=>(this.Eo=Date.now(),t())),this.Io*=this.yo,this.Io<this.mo&&(this.Io=this.mo),this.Io>this.po&&(this.Io=this.po)}Po(){null!==this.To&&(this.To.skipDelay(),this.To=null)}cancel(){null!==this.To&&(this.To.cancel(),this.To=null)}bo(){return(Math.random()-.5)*this.Io}}class ZX{constructor(t,e,r,s,i,o,c,u){this.Hs=t,this.vo=r,this.Vo=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=c,this.listener=u,this.state=0,this.So=0,this.Do=null,this.Co=null,this.stream=null,this.xo=new wx(t,e)}No(){return 1===this.state||5===this.state||this.ko()}ko(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Oo()}stop(){var t=this;return A(function*(){t.No()&&(yield t.close(0))})()}Mo(){this.state=0,this.xo.reset()}Fo(){this.ko()&&null===this.Do&&(this.Do=this.Hs.enqueueAfterDelay(this.vo,6e4,()=>this.$o()))}Bo(t){this.Lo(),this.stream.send(t)}$o(){var t=this;return A(function*(){if(t.ko())return t.close(0)})()}Lo(){this.Do&&(this.Do.cancel(),this.Do=null)}Uo(){this.Co&&(this.Co.cancel(),this.Co=null)}close(t,e){var r=this;return A(function*(){r.Lo(),r.Uo(),r.xo.cancel(),r.So++,4!==t?r.xo.reset():e&&e.code===be.RESOURCE_EXHAUSTED?(Ts(e.toString()),Ts("Using maximum backoff delay to prevent overloading the backend."),r.xo.Ao()):e&&e.code===be.UNAUTHENTICATED&&3!==r.state&&(r.authCredentialsProvider.invalidateToken(),r.appCheckCredentialsProvider.invalidateToken()),null!==r.stream&&(r.qo(),r.stream.close(),r.stream=null),r.state=t,yield r.listener.Zr(e)})()}qo(){}auth(){this.state=1;const t=this.Ko(this.So),e=this.So;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.So===e&&this.Go(r,s)},r=>{t(()=>{const s=new Be(be.UNKNOWN,"Fetching auth token failed: "+r.message);return this.Qo(s)})})}Go(t,e){const r=this.Ko(this.So);this.stream=this.jo(t,e),this.stream.Yr(()=>{r(()=>(this.state=2,this.Co=this.Hs.enqueueAfterDelay(this.Vo,1e4,()=>(this.ko()&&(this.state=3),Promise.resolve())),this.listener.Yr()))}),this.stream.Zr(s=>{r(()=>this.Qo(s))}),this.stream.onMessage(s=>{r(()=>this.onMessage(s))})}Oo(){var t=this;this.state=5,this.xo.Ro(A(function*(){t.state=0,t.start()}))}Qo(t){return Ge("PersistentStream",`close with error: ${t}`),this.stream=null,this.close(4,t)}Ko(t){return e=>{this.Hs.enqueueAndForget(()=>this.So===t?e():(Ge("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Dve extends ZX{constructor(t,e,r,s,i,o){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",e,r,s,o),this.It=i}jo(t,e){return this.connection.wo("Listen",t,e)}onMessage(t){this.xo.reset();const e=function O_e(n,t){let e;if("targetChange"in t){const r="NO_CHANGE"===(u=t.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===u?1:"REMOVE"===u?2:"CURRENT"===u?3:"RESET"===u?4:wt(),s=t.targetChange.targetIds||[],i=function(u,h){return u.gt?(sn(void 0===h||"string"==typeof h),gi.fromBase64String(h||"")):(sn(void 0===h||h instanceof Uint8Array),gi.fromUint8Array(h||new Uint8Array))}(n,t.targetChange.resumeToken),o=t.targetChange.cause,c=o&&function(u){const h=void 0===u.code?be.UNKNOWN:FK(u.code);return new Be(h,u.message||"")}(o);e=new WK(r,s,i,c||null)}else if("documentChange"in t){const r=t.documentChange,s=A4(n,r.document.name),i=Fi(r.document.updateTime),o=new S2({mapValue:{fields:r.document.fields}}),c=vr.newFoundDocument(s,i,o);e=new yM(r.targetIds||[],r.removedTargetIds||[],c.key,c)}else if("documentDelete"in t){const r=t.documentDelete,s=A4(n,r.document),i=r.readTime?Fi(r.readTime):on.min(),o=vr.newNoDocument(s,i);e=new yM([],r.removedTargetIds||[],o.key,o)}else if("documentRemove"in t){const r=t.documentRemove,s=A4(n,r.document);e=new yM([],r.removedTargetIds||[],s,null)}else{if(!("filter"in t))return wt();{const r=t.filter,i=new __e(r.count||0);e=new GK(r.targetId,i)}}var u;return e}(this.It,t),r=function(s){if(!("targetChange"in s))return on.min();const i=s.targetChange;return i.targetIds&&i.targetIds.length?on.min():i.readTime?Fi(i.readTime):on.min()}(t);return this.listener.Wo(e,r)}zo(t){const e={};e.database=Rg(this.It),e.addTarget=function(s,i){let o;const c=i.target;return o=dM(c)?{documents:tX(s,c)}:{query:ix(s,c)},o.targetId=i.targetId,i.resumeToken.approximateByteSize()>0?o.resumeToken=YK(s,i.resumeToken):i.snapshotVersion.compareTo(on.min())>0&&(o.readTime=kg(s,i.snapshotVersion.toTimestamp())),o}(this.It,t);const r=function A_e(n,t){const e=function(r,s){switch(s){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return wt()}}(0,t.purpose);return null==e?null:{"goog-listen-tags":e}}(0,t);r&&(e.labels=r),this.Bo(e)}Ho(t){const e={};e.database=Rg(this.It),e.removeTarget=t,this.Bo(e)}}class zve extends ZX{constructor(t,e,r,s,i,o){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",e,r,s,o),this.It=i,this.Jo=!1}get Yo(){return this.Jo}start(){this.Jo=!1,this.lastStreamToken=void 0,super.start()}qo(){this.Jo&&this.Xo([])}jo(t,e){return this.connection.wo("Write",t,e)}onMessage(t){if(sn(!!t.streamToken),this.lastStreamToken=t.streamToken,this.Jo){this.xo.reset();const e=function N_e(n,t){return n&&n.length>0?(sn(void 0!==t),n.map(e=>function(r,s){let i=Fi(r.updateTime?r.updateTime:s);return i.isEqual(on.min())&&(i=Fi(s)),new p_e(i,r.transformResults||[])}(e,t))):[]}(t.writeResults,t.commitTime),r=Fi(t.commitTime);return this.listener.Zo(r,e)}return sn(!t.writeResults||0===t.writeResults.length),this.Jo=!0,this.listener.tu()}eu(){const t={};t.database=Rg(this.It),this.Bo(t)}Xo(t){const e={streamToken:this.lastStreamToken,writes:t.map(r=>function Dg(n,t){let e;if(t instanceof zf)e={update:JK(n,t.key,t.value)};else if(t instanceof Vf)e={delete:Lg(n,t.key)};else if(t instanceof Wl)e={update:JK(n,t.key,t.data),updateMask:R_e(t.fieldMask)};else{if(!(t instanceof tx))return wt();e={verify:Lg(n,t.key)}}return t.fieldTransforms.length>0&&(e.updateTransforms=t.fieldTransforms.map(r=>function(s,i){const o=i.transform;if(o instanceof Rf)return{fieldPath:i.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof Yu)return{fieldPath:i.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof Ku)return{fieldPath:i.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof Df)return{fieldPath:i.field.canonicalString(),increment:o.yt};throw wt()}(0,r))),t.precondition.isNone||(e.currentDocument=void 0!==(s=t.precondition).updateTime?{updateTime:w_e(n,s.updateTime)}:void 0!==s.exists?{exists:s.exists}:wt()),e;var s}(this.It,r))};this.Bo(e)}}class Vve extends class{}{constructor(t,e,r,s){super(),this.authCredentials=t,this.appCheckCredentials=e,this.connection=r,this.It=s,this.nu=!1}su(){if(this.nu)throw new Be(be.FAILED_PRECONDITION,"The client has already been terminated.")}ao(t,e,r){return this.su(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,i])=>this.connection.ao(t,e,r,s,i)).catch(s=>{throw"FirebaseError"===s.name?(s.code===be.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Be(be.UNKNOWN,s.toString())})}_o(t,e,r,s){return this.su(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection._o(t,e,r,i,o,s)).catch(i=>{throw"FirebaseError"===i.name?(i.code===be.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Be(be.UNKNOWN,i.toString())})}terminate(){this.nu=!0}}class Fve{constructor(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.iu=0,this.ru=null,this.ou=!0}uu(){0===this.iu&&(this.cu("Unknown"),this.ru=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.ru=null,this.au("Backend didn't respond within 10 seconds."),this.cu("Offline"),Promise.resolve())))}hu(t){"Online"===this.state?this.cu("Unknown"):(this.iu++,this.iu>=1&&(this.lu(),this.au(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.cu("Offline")))}set(t){this.lu(),this.iu=0,"Online"===t&&(this.ou=!1),this.cu(t)}cu(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}au(t){const e=`Could not reach Cloud Firestore backend. ${t}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.ou?(Ts(e),this.ou=!1):Ge("OnlineStateTracker",e)}lu(){null!==this.ru&&(this.ru.cancel(),this.ru=null)}}class Bve{constructor(t,e,r,s,i){var o=this;this.localStore=t,this.datastore=e,this.asyncQueue=r,this.remoteSyncer={},this.fu=[],this.du=new Map,this._u=new Set,this.wu=[],this.mu=i,this.mu.qr(c=>{r.enqueueAndForget(A(function*(){var u;ql(o)&&(Ge("RemoteStore","Restarting streams for network reachability change."),yield(u=A(function*(h){const p=lt(h);p._u.add(4),yield Wf(p),p.gu.set("Unknown"),p._u.delete(4),yield qg(p)}),function(h){return u.apply(this,arguments)})(o))}))}),this.gu=new Fve(r,s)}}function qg(n){return Ox.apply(this,arguments)}function Ox(){return Ox=A(function*(n){if(ql(n))for(const t of n.wu)yield t(!0)}),Ox.apply(this,arguments)}function Wf(n){return Nx.apply(this,arguments)}function Nx(){return Nx=A(function*(n){for(const t of n.wu)yield t(!1)}),Nx.apply(this,arguments)}function RM(n,t){const e=lt(n);e.du.has(t.targetId)||(e.du.set(t.targetId,t),xx(e)?Ix(e):jf(e).ko()&&Ax(e,t))}function jg(n,t){const e=lt(n),r=jf(e);e.du.delete(t),r.ko()&&YX(e,t),0===e.du.size&&(r.ko()?r.Fo():ql(e)&&e.gu.set("Unknown"))}function Ax(n,t){n.yu.Mt(t.targetId),jf(n).zo(t)}function YX(n,t){n.yu.Mt(t),jf(n).Ho(t)}function Ix(n){n.yu=new M_e({getRemoteKeysForTarget:t=>n.remoteSyncer.getRemoteKeysForTarget(t),se:t=>n.du.get(t)||null}),jf(n).start(),n.gu.uu()}function xx(n){return ql(n)&&!jf(n).No()&&n.du.size>0}function ql(n){return 0===lt(n)._u.size}function KX(n){n.yu=void 0}function $ve(n){return kx.apply(this,arguments)}function kx(){return kx=A(function*(n){n.du.forEach((t,e)=>{Ax(n,t)})}),kx.apply(this,arguments)}function Uve(n,t){return Lx.apply(this,arguments)}function Lx(){return Lx=A(function*(n,t){KX(n),xx(n)?(n.gu.hu(t),Ix(n)):n.gu.set("Unknown")}),Lx.apply(this,arguments)}function Gve(n,t,e){return Rx.apply(this,arguments)}function Rx(){return Rx=A(function*(n,t,e){if(n.gu.set("Online"),t instanceof WK&&2===t.state&&t.cause)try{yield(r=A(function*(s,i){const o=i.cause;for(const c of i.targetIds)s.du.has(c)&&(yield s.remoteSyncer.rejectListen(c,o),s.du.delete(c),s.yu.removeTarget(c))}),function(s,i){return r.apply(this,arguments)})(n,t)}catch(r){Ge("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),r),yield DM(n,r)}else if(t instanceof yM?n.yu.Gt(t):t instanceof GK?n.yu.Yt(t):n.yu.Wt(t),!e.isEqual(on.min()))try{const r=yield VX(n.localStore);e.compareTo(r)>=0&&(yield function(s,i){const o=s.yu.te(i);return o.targetChanges.forEach((c,u)=>{if(c.resumeToken.approximateByteSize()>0){const h=s.du.get(u);h&&s.du.set(u,h.withResumeToken(c.resumeToken,i))}}),o.targetMismatches.forEach(c=>{const u=s.du.get(c);if(!u)return;s.du.set(c,u.withResumeToken(gi.EMPTY_BYTE_STRING,u.snapshotVersion)),YX(s,c);const h=new H0(u.target,c,1,u.sequenceNumber);Ax(s,h)}),s.remoteSyncer.applyRemoteEvent(o)}(n,e))}catch(r){Ge("RemoteStore","Failed to raise snapshot:",r),yield DM(n,r)}var r}),Rx.apply(this,arguments)}function DM(n,t,e){return Dx.apply(this,arguments)}function Dx(){return Dx=A(function*(n,t,e){if(!k0(t))throw t;n._u.add(1),yield Wf(n),n.gu.set("Offline"),e||(e=()=>VX(n.localStore)),n.asyncQueue.enqueueRetryable(A(function*(){Ge("RemoteStore","Retrying IndexedDB access"),yield e(),n._u.delete(1),yield qg(n)}))}),Dx.apply(this,arguments)}function XX(n,t){return t().catch(e=>DM(n,e,t))}function qf(n){return zx.apply(this,arguments)}function zx(){return zx=A(function*(n){const t=lt(n),e=$0(t);let r=t.fu.length>0?t.fu[t.fu.length-1].batchId:-1;for(;Wve(t);)try{const s=yield Nve(t.localStore,r);if(null===s){0===t.fu.length&&e.Fo();break}r=s.batchId,qve(t,s)}catch(s){yield DM(t,s)}QX(t)&&JX(t)}),zx.apply(this,arguments)}function Wve(n){return ql(n)&&n.fu.length<10}function qve(n,t){n.fu.push(t);const e=$0(n);e.ko()&&e.Yo&&e.Xo(t.mutations)}function QX(n){return ql(n)&&!$0(n).No()&&n.fu.length>0}function JX(n){$0(n).start()}function jve(n){return Vx.apply(this,arguments)}function Vx(){return Vx=A(function*(n){$0(n).eu()}),Vx.apply(this,arguments)}function Zve(n){return Hx.apply(this,arguments)}function Hx(){return Hx=A(function*(n){const t=$0(n);for(const e of n.fu)t.Xo(e.mutations)}),Hx.apply(this,arguments)}function Yve(n,t,e){return Fx.apply(this,arguments)}function Fx(){return Fx=A(function*(n,t,e){const r=n.fu.shift(),s=cx.from(r,t,e);yield XX(n,()=>n.remoteSyncer.applySuccessfulWrite(s)),yield qf(n)}),Fx.apply(this,arguments)}function Kve(n,t){return Bx.apply(this,arguments)}function Bx(){return Bx=A(function*(n,t){var e;t&&$0(n).Yo&&(yield(e=A(function*(r,s){if(HK(i=s.code)&&i!==be.ABORTED){const o=r.fu.shift();$0(r).Mo(),yield XX(r,()=>r.remoteSyncer.rejectFailedWrite(o.batchId,s)),yield qf(r)}var i}),function(r,s){return e.apply(this,arguments)})(n,t)),QX(n)&&JX(n)}),Bx.apply(this,arguments)}function eQ(n,t){return $x.apply(this,arguments)}function $x(){return $x=A(function*(n,t){const e=lt(n);e.asyncQueue.verifyOperationInProgress(),Ge("RemoteStore","RemoteStore received new credentials");const r=ql(e);e._u.add(3),yield Wf(e),r&&e.gu.set("Unknown"),yield e.remoteSyncer.handleCredentialChange(t),e._u.delete(3),yield qg(e)}),$x.apply(this,arguments)}function Gx(){return Gx=A(function*(n,t){const e=lt(n);t?(e._u.delete(2),yield qg(e)):t||(e._u.add(2),yield Wf(e),e.gu.set("Unknown"))}),Gx.apply(this,arguments)}function jf(n){return n.pu||(n.pu=function(t,e,r){const s=lt(t);return s.su(),new Dve(e,s.connection,s.authCredentials,s.appCheckCredentials,s.It,r)}(n.datastore,n.asyncQueue,{Yr:$ve.bind(null,n),Zr:Uve.bind(null,n),Wo:Gve.bind(null,n)}),n.wu.push(function(){var t=A(function*(e){e?(n.pu.Mo(),xx(n)?Ix(n):n.gu.set("Unknown")):(yield n.pu.stop(),KX(n))});return function(e){return t.apply(this,arguments)}}())),n.pu}function $0(n){return n.Iu||(n.Iu=function(t,e,r){const s=lt(t);return s.su(),new zve(e,s.connection,s.authCredentials,s.appCheckCredentials,s.It,r)}(n.datastore,n.asyncQueue,{Yr:jve.bind(null,n),Zr:Kve.bind(null,n),tu:Zve.bind(null,n),Zo:Yve.bind(null,n)}),n.wu.push(function(){var t=A(function*(e){e?(n.Iu.Mo(),yield qf(n)):(yield n.Iu.stop(),n.fu.length>0&&(Ge("RemoteStore",`Stopping write stream with ${n.fu.length} pending writes`),n.fu=[]))});return function(e){return t.apply(this,arguments)}}())),n.Iu}class Wx{constructor(t,e,r,s,i){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new pi,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}static createAndSchedule(t,e,r,s,i){const o=Date.now()+r,c=new Wx(t,e,o,s,i);return c.start(r),c}start(t){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Be(be.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(t=>this.deferred.resolve(t))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Zf(n,t){if(Ts("AsyncQueue",`${t}: ${n}`),k0(n))return new Be(be.UNAVAILABLE,`${t}: ${n}`);throw n}class Yf{constructor(t){this.comparator=t?(e,r)=>t(e,r)||ot.comparator(e.key,r.key):(e,r)=>ot.comparator(e.key,r.key),this.keyedMap=Ng(),this.sortedSet=new ds(this.comparator)}static emptySet(t){return new Yf(t.comparator)}has(t){return null!=this.keyedMap.get(t)}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal((e,r)=>(t(e),!1))}add(t){const e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))}delete(t){const e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this}isEqual(t){if(!(t instanceof Yf)||this.size!==t.size)return!1;const e=this.sortedSet.getIterator(),r=t.sortedSet.getIterator();for(;e.hasNext();){const s=e.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const t=[];return this.forEach(e=>{t.push(e.toString())}),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"}copy(t,e){const r=new Yf;return r.comparator=this.comparator,r.keyedMap=t,r.sortedSet=e,r}}class tQ{constructor(){this.Tu=new ds(ot.comparator)}track(t){const e=t.doc.key,r=this.Tu.get(e);r?0!==t.type&&3===r.type?this.Tu=this.Tu.insert(e,t):3===t.type&&1!==r.type?this.Tu=this.Tu.insert(e,{type:r.type,doc:t.doc}):2===t.type&&2===r.type?this.Tu=this.Tu.insert(e,{type:2,doc:t.doc}):2===t.type&&0===r.type?this.Tu=this.Tu.insert(e,{type:0,doc:t.doc}):1===t.type&&0===r.type?this.Tu=this.Tu.remove(e):1===t.type&&2===r.type?this.Tu=this.Tu.insert(e,{type:1,doc:r.doc}):0===t.type&&1===r.type?this.Tu=this.Tu.insert(e,{type:2,doc:t.doc}):wt():this.Tu=this.Tu.insert(e,t)}Eu(){const t=[];return this.Tu.inorderTraversal((e,r)=>{t.push(r)}),t}}class Kf{constructor(t,e,r,s,i,o,c,u,h){this.query=t,this.docs=e,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=c,this.excludesMetadataChanges=u,this.hasCachedResults=h}static fromInitialDocuments(t,e,r,s,i){const o=[];return e.forEach(c=>{o.push({type:0,doc:c})}),new Kf(t,e,Yf.emptySet(e),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&wg(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const e=this.docChanges,r=t.docChanges;if(e.length!==r.length)return!1;for(let s=0;s<e.length;s++)if(e[s].type!==r[s].type||!e[s].doc.isEqual(r[s].doc))return!1;return!0}}class Xve{constructor(){this.Au=void 0,this.listeners=[]}}class Qve{constructor(){this.queries=new V0(t=>SK(t),wg),this.onlineState="Unknown",this.Ru=new Set}}function qx(n,t){return jx.apply(this,arguments)}function jx(){return jx=A(function*(n,t){const e=lt(n),r=t.query;let s=!1,i=e.queries.get(r);if(i||(s=!0,i=new Xve),s)try{i.Au=yield e.onListen(r)}catch(o){const c=Zf(o,`Initialization of query '${JI(t.query)}' failed`);return void t.onError(c)}e.queries.set(r,i),i.listeners.push(t),t.bu(e.onlineState),i.Au&&t.Pu(i.Au)&&Kx(e)}),jx.apply(this,arguments)}function Zx(n,t){return Yx.apply(this,arguments)}function Yx(){return Yx=A(function*(n,t){const e=lt(n),r=t.query;let s=!1;const i=e.queries.get(r);if(i){const o=i.listeners.indexOf(t);o>=0&&(i.listeners.splice(o,1),s=0===i.listeners.length)}if(s)return e.queries.delete(r),e.onUnlisten(r)}),Yx.apply(this,arguments)}function Jve(n,t){const e=lt(n);let r=!1;for(const s of t){const o=e.queries.get(s.query);if(o){for(const c of o.listeners)c.Pu(s)&&(r=!0);o.Au=s}}r&&Kx(e)}function eCe(n,t,e){const r=lt(n),s=r.queries.get(t);if(s)for(const i of s.listeners)i.onError(e);r.queries.delete(t)}function Kx(n){n.Ru.forEach(t=>{t.next()})}class Xx{constructor(t,e,r){this.query=t,this.vu=e,this.Vu=!1,this.Su=null,this.onlineState="Unknown",this.options=r||{}}Pu(t){if(!this.options.includeMetadataChanges){const r=[];for(const s of t.docChanges)3!==s.type&&r.push(s);t=new Kf(t.query,t.docs,t.oldDocs,r,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let e=!1;return this.Vu?this.Du(t)&&(this.vu.next(t),e=!0):this.Cu(t,this.onlineState)&&(this.xu(t),e=!0),this.Su=t,e}onError(t){this.vu.error(t)}bu(t){this.onlineState=t;let e=!1;return this.Su&&!this.Vu&&this.Cu(this.Su,t)&&(this.xu(this.Su),e=!0),e}Cu(t,e){return!t.fromCache||(!this.options.Nu||!("Offline"!==e))&&(!t.docs.isEmpty()||t.hasCachedResults||"Offline"===e)}Du(t){return t.docChanges.length>0||!!(t.syncStateChanged||this.Su&&this.Su.hasPendingWrites!==t.hasPendingWrites)&&!0===this.options.includeMetadataChanges}xu(t){t=Kf.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.Vu=!0,this.vu.next(t)}}class sQ{constructor(t){this.key=t}}class iQ{constructor(t){this.key=t}}class oQ{constructor(t,e){this.query=t,this.Uu=e,this.qu=null,this.hasCachedResults=!1,this.current=!1,this.Ku=In(),this.mutatedKeys=In(),this.Gu=TK(t),this.Qu=new Yf(this.Gu)}get ju(){return this.Uu}Wu(t,e){const r=e?e.zu:new tQ,s=e?e.Qu:this.Qu;let i=e?e.mutatedKeys:this.mutatedKeys,o=s,c=!1;const u="F"===this.query.limitType&&s.size===this.query.limit?s.last():null,h="L"===this.query.limitType&&s.size===this.query.limit?s.first():null;if(t.inorderTraversal((p,m)=>{const C=s.get(p),w=ex(this.query,m)?m:null,I=!!C&&this.mutatedKeys.has(C.key),H=!!w&&(w.hasLocalMutations||this.mutatedKeys.has(w.key)&&w.hasCommittedMutations);let K=!1;C&&w?C.data.isEqual(w.data)?I!==H&&(r.track({type:3,doc:w}),K=!0):this.Hu(C,w)||(r.track({type:2,doc:w}),K=!0,(u&&this.Gu(w,u)>0||h&&this.Gu(w,h)<0)&&(c=!0)):!C&&w?(r.track({type:0,doc:w}),K=!0):C&&!w&&(r.track({type:1,doc:C}),K=!0,(u||h)&&(c=!0)),K&&(w?(o=o.add(w),i=H?i.add(p):i.delete(p)):(o=o.delete(p),i=i.delete(p)))}),null!==this.query.limit)for(;o.size>this.query.limit;){const p="F"===this.query.limitType?o.last():o.first();o=o.delete(p.key),i=i.delete(p.key),r.track({type:1,doc:p})}return{Qu:o,zu:r,$i:c,mutatedKeys:i}}Hu(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations}applyChanges(t,e,r){const s=this.Qu;this.Qu=t.Qu,this.mutatedKeys=t.mutatedKeys;const i=t.zu.Eu();i.sort((h,p)=>function(m,C){const w=I=>{switch(I){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return wt()}};return w(m)-w(C)}(h.type,p.type)||this.Gu(h.doc,p.doc)),this.Ju(r);const o=e?this.Yu():[],c=0===this.Ku.size&&this.current?1:0,u=c!==this.qu;return this.qu=c,0!==i.length||u?{snapshot:new Kf(this.query,t.Qu,s,i,t.mutatedKeys,0===c,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),Xu:o}:{Xu:o}}bu(t){return this.current&&"Offline"===t?(this.current=!1,this.applyChanges({Qu:this.Qu,zu:new tQ,mutatedKeys:this.mutatedKeys,$i:!1},!1)):{Xu:[]}}Zu(t){return!this.Uu.has(t)&&!!this.Qu.has(t)&&!this.Qu.get(t).hasLocalMutations}Ju(t){t&&(t.addedDocuments.forEach(e=>this.Uu=this.Uu.add(e)),t.modifiedDocuments.forEach(e=>{}),t.removedDocuments.forEach(e=>this.Uu=this.Uu.delete(e)),this.current=t.current)}Yu(){if(!this.current)return[];const t=this.Ku;this.Ku=In(),this.Qu.forEach(r=>{this.Zu(r.key)&&(this.Ku=this.Ku.add(r.key))});const e=[];return t.forEach(r=>{this.Ku.has(r)||e.push(new iQ(r))}),this.Ku.forEach(r=>{t.has(r)||e.push(new sQ(r))}),e}tc(t){this.Uu=t.Hi,this.Ku=In();const e=this.Wu(t.documents);return this.applyChanges(e,!0)}ec(){return Kf.fromInitialDocuments(this.query,this.Qu,this.mutatedKeys,0===this.qu,this.hasCachedResults)}}class rCe{constructor(t,e,r){this.query=t,this.targetId=e,this.view=r}}class sCe{constructor(t){this.key=t,this.nc=!1}}class iCe{constructor(t,e,r,s,i,o){this.localStore=t,this.remoteStore=e,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.sc={},this.ic=new V0(c=>SK(c),wg),this.rc=new Map,this.oc=new Set,this.uc=new ds(ot.comparator),this.cc=new Map,this.ac=new dx,this.hc={},this.lc=new Map,this.fc=r5.vn(),this.onlineState="Unknown",this.dc=void 0}get isPrimaryClient(){return!0===this.dc}}function oCe(n,t){return Qx.apply(this,arguments)}function Qx(){return Qx=A(function*(n,t){const e=Ek(n);let r,s;const i=e.ic.get(t);if(i)r=i.targetId,e.sharedClientState.addLocalQueryTarget(r),s=i.view.ec();else{const o=yield Uf(e.localStore,Ao(t));e.isPrimaryClient&&RM(e.remoteStore,o);const c=e.sharedClientState.addLocalQueryTarget(o.targetId);r=o.targetId,s=yield Jx(e,t,r,"current"===c,o.resumeToken)}return s}),Qx.apply(this,arguments)}function Jx(n,t,e,r,s){return ek.apply(this,arguments)}function ek(){return ek=A(function*(n,t,e,r,s){n._c=(m,C,w)=>{return(I=A(function*(H,K,ie,ye){let te=K.view.Wu(ie);te.$i&&(te=yield IM(H.localStore,K.query,!1).then(({documents:Xe})=>K.view.Wu(Xe,te)));const ke=ye&&ye.targetChanges.get(K.targetId),$e=K.view.applyChanges(te,H.isPrimaryClient,ke);return uk(H,K.targetId,$e.Xu),$e.snapshot}),function(H,K,ie,ye){return I.apply(this,arguments)})(n,m,C,w);var I};const i=yield IM(n.localStore,t,!0),o=new oQ(t,i.Hi),c=o.Wu(i.documents),u=xg.createSynthesizedTargetChangeForCurrentChange(e,r&&"Offline"!==n.onlineState,s),h=o.applyChanges(c,n.isPrimaryClient,u);uk(n,e,h.Xu);const p=new rCe(t,e,o);return n.ic.set(t,p),n.rc.has(e)?n.rc.get(e).push(t):n.rc.set(e,[t]),h.snapshot}),ek.apply(this,arguments)}function aCe(n,t){return tk.apply(this,arguments)}function tk(){return tk=A(function*(n,t){const e=lt(n),r=e.ic.get(t),s=e.rc.get(r.targetId);if(s.length>1)return e.rc.set(r.targetId,s.filter(i=>!wg(i,t))),void e.ic.delete(t);e.isPrimaryClient?(e.sharedClientState.removeLocalQueryTarget(r.targetId),e.sharedClientState.isActiveQueryTarget(r.targetId)||(yield Gf(e.localStore,r.targetId,!1).then(()=>{e.sharedClientState.clearQueryState(r.targetId),jg(e.remoteStore,r.targetId),Xf(e,r.targetId)}).catch(x0))):(Xf(e,r.targetId),yield Gf(e.localStore,r.targetId,!0))}),tk.apply(this,arguments)}function nk(){return nk=A(function*(n,t,e){const r=Mk(n);try{const s=yield function(i,o){const c=lt(i),u=Jr.now(),h=o.reduce((C,w)=>C.add(w.key),In());let p,m;return c.persistence.runTransaction("Locally write mutations","readwrite",C=>{let w=ca(),I=In();return c.Gi.getEntries(C,h).next(H=>{w=H,w.forEach((K,ie)=>{ie.isValidDocument()||(I=I.add(K))})}).next(()=>c.localDocuments.getOverlayedDocuments(C,w)).next(H=>{p=H;const K=[];for(const ie of o){const ye=m_e(ie,p.get(ie.key).overlayedDocument);null!=ye&&K.push(new Wl(ie.key,ye,pK(ye.value.mapValue),Fr.exists(!0)))}return c.mutationQueue.addMutationBatch(C,u,K,o)}).next(H=>{m=H;const K=H.applyToLocalDocumentSet(p,I);return c.documentOverlayCache.saveOverlays(C,H.batchId,K)})}).then(()=>({batchId:m.batchId,changes:$K(p)}))}(r.localStore,t);r.sharedClientState.addPendingMutation(s.batchId),function(i,o,c){let u=i.hc[i.currentUser.toKey()];u||(u=new ds(vn)),u=u.insert(o,c),i.hc[i.currentUser.toKey()]=u}(r,s.batchId,e),yield jl(r,s.changes),yield qf(r.remoteStore)}catch(s){const i=Zf(s,"Failed to persist write");e.reject(i)}}),nk.apply(this,arguments)}function aQ(n,t){return rk.apply(this,arguments)}function rk(){return rk=A(function*(n,t){const e=lt(n);try{const r=yield Ove(e.localStore,t);t.targetChanges.forEach((s,i)=>{const o=e.cc.get(i);o&&(sn(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.nc=!0:s.modifiedDocuments.size>0?sn(o.nc):s.removedDocuments.size>0&&(sn(o.nc),o.nc=!1))}),yield jl(e,r,t)}catch(r){yield x0(r)}}),rk.apply(this,arguments)}function cQ(n,t,e){const r=lt(n);if(r.isPrimaryClient&&0===e||!r.isPrimaryClient&&1===e){const s=[];r.ic.forEach((i,o)=>{const c=o.view.bu(t);c.snapshot&&s.push(c.snapshot)}),function(i,o){const c=lt(i);c.onlineState=o;let u=!1;c.queries.forEach((h,p)=>{for(const m of p.listeners)m.bu(o)&&(u=!0)}),u&&Kx(c)}(r.eventManager,t),s.length&&r.sc.Wo(s),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}function lCe(n,t,e){return sk.apply(this,arguments)}function sk(){return sk=A(function*(n,t,e){const r=lt(n);r.sharedClientState.updateQueryState(t,"rejected",e);const s=r.cc.get(t),i=s&&s.key;if(i){let o=new ds(ot.comparator);o=o.insert(i,vr.newNoDocument(i,on.min()));const c=In().add(i),u=new Ig(on.min(),new Map,new sr(vn),o,c);yield aQ(r,u),r.uc=r.uc.remove(i),r.cc.delete(t),fk(r)}else yield Gf(r.localStore,t,!1).then(()=>Xf(r,t,e)).catch(x0)}),sk.apply(this,arguments)}function uCe(n,t){return ik.apply(this,arguments)}function ik(){return ik=A(function*(n,t){const e=lt(n),r=t.batch.batchId;try{const s=yield bve(e.localStore,t);lk(e,r,null),ck(e,r),e.sharedClientState.updateMutationState(r,"acknowledged"),yield jl(e,s)}catch(s){yield x0(s)}}),ik.apply(this,arguments)}function fCe(n,t,e){return ok.apply(this,arguments)}function ok(){return ok=A(function*(n,t,e){const r=lt(n);try{const s=yield function(i,o){const c=lt(i);return c.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let h;return c.mutationQueue.lookupMutationBatch(u,o).next(p=>(sn(null!==p),h=p.keys(),c.mutationQueue.removeMutationBatch(u,p))).next(()=>c.mutationQueue.performConsistencyCheck(u)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(u,h,o)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,h)).next(()=>c.localDocuments.getDocuments(u,h))})}(r.localStore,t);lk(r,t,e),ck(r,t),r.sharedClientState.updateMutationState(t,"rejected",e),yield jl(r,s)}catch(s){yield x0(s)}}),ok.apply(this,arguments)}function ck(n,t){(n.lc.get(t)||[]).forEach(e=>{e.resolve()}),n.lc.delete(t)}function lk(n,t,e){const r=lt(n);let s=r.hc[r.currentUser.toKey()];if(s){const i=s.get(t);i&&(e?i.reject(e):i.resolve(),s=s.remove(t)),r.hc[r.currentUser.toKey()]=s}}function Xf(n,t,e=null){n.sharedClientState.removeLocalQueryTarget(t);for(const r of n.rc.get(t))n.ic.delete(r),e&&n.sc.wc(r,e);n.rc.delete(t),n.isPrimaryClient&&n.ac.ls(t).forEach(r=>{n.ac.containsKey(r)||lQ(n,r)})}function lQ(n,t){n.oc.delete(t.path.canonicalString());const e=n.uc.get(t);null!==e&&(jg(n.remoteStore,e),n.uc=n.uc.remove(t),n.cc.delete(e),fk(n))}function uk(n,t,e){for(const r of e)r instanceof sQ?(n.ac.addReference(r.key,t),dCe(n,r)):r instanceof iQ?(Ge("SyncEngine","Document no longer in limbo: "+r.key),n.ac.removeReference(r.key,t),n.ac.containsKey(r.key)||lQ(n,r.key)):wt()}function dCe(n,t){const e=t.key,r=e.path.canonicalString();n.uc.get(e)||n.oc.has(r)||(Ge("SyncEngine","New document in limbo: "+e),n.oc.add(r),fk(n))}function fk(n){for(;n.oc.size>0&&n.uc.size<n.maxConcurrentLimboResolutions;){const t=n.oc.values().next().value;n.oc.delete(t);const e=new ot(m1.fromString(t)),r=n.fc.next();n.cc.set(r,new sCe(e)),n.uc=n.uc.insert(e,r),RM(n.remoteStore,new H0(Ao(kf(e.path)),r,2,aa.at))}}function jl(n,t,e){return hk.apply(this,arguments)}function hk(){return hk=A(function*(n,t,e){const r=lt(n),s=[],i=[],o=[];var c;r.ic.isEmpty()||(r.ic.forEach((c,u)=>{o.push(r._c(u,t,e).then(h=>{if((h||e)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(u.targetId,h?.fromCache?"not-current":"current"),h){s.push(h);const p=_x.Ci(u.targetId,h);i.push(p)}}))}),yield Promise.all(o),r.sc.Wo(s),yield(c=A(function*(u,h){const p=lt(u);try{yield p.persistence.runTransaction("notifyLocalViewChanges","readwrite",m=>Se.forEach(h,C=>Se.forEach(C.Si,w=>p.persistence.referenceDelegate.addReference(m,C.targetId,w)).next(()=>Se.forEach(C.Di,w=>p.persistence.referenceDelegate.removeReference(m,C.targetId,w)))))}catch(m){if(!k0(m))throw m;Ge("LocalStore","Failed to update sequence numbers: "+m)}for(const m of h){const C=m.targetId;if(!m.fromCache){const w=p.Ui.get(C),H=w.withLastLimboFreeSnapshotVersion(w.snapshotVersion);p.Ui=p.Ui.insert(C,H)}}}),function(u,h){return c.apply(this,arguments)})(r.localStore,i))}),hk.apply(this,arguments)}function pCe(n,t){return dk.apply(this,arguments)}function dk(){return dk=A(function*(n,t){const e=lt(n);if(!e.currentUser.isEqual(t)){Ge("SyncEngine","User change. New user:",t.toKey());const r=yield zX(e.localStore,t);e.currentUser=t,(s=e).lc.forEach(o=>{o.forEach(c=>{c.reject(new Be(be.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),s.lc.clear(),e.sharedClientState.handleUserChange(t,r.removedBatchIds,r.addedBatchIds),yield jl(e,r.ji)}var s}),dk.apply(this,arguments)}function gCe(n,t){const e=lt(n),r=e.cc.get(t);if(r&&r.nc)return In().add(r.key);{let s=In();const i=e.rc.get(t);if(!i)return s;for(const o of i){const c=e.ic.get(o);s=s.unionWith(c.view.ju)}return s}}function Ek(n){const t=lt(n);return t.remoteStore.remoteSyncer.applyRemoteEvent=aQ.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=gCe.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=lCe.bind(null,t),t.sc.Wo=Jve.bind(null,t.eventManager),t.sc.wc=eCe.bind(null,t.eventManager),t}function Mk(n){const t=lt(n);return t.remoteStore.remoteSyncer.applySuccessfulWrite=uCe.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=fCe.bind(null,t),t}class PCe{constructor(){this.synchronizeTabs=!1}initialize(t){var e=this;return A(function*(){e.It=Wg(t.databaseInfo.databaseId),e.sharedClientState=e.gc(t),e.persistence=e.yc(t),yield e.persistence.start(),e.localStore=e.Ic(t),e.gcScheduler=e.Tc(t,e.localStore),e.indexBackfillerScheduler=e.Ec(t,e.localStore)})()}Tc(t,e){return null}Ec(t,e){return null}Ic(t){return function DX(n,t,e,r){return new wve(n,t,e,r)}(this.persistence,new RX,t.initialUser,this.It)}yc(t){return new kX(NM.Bs,this.It)}gc(t){return new WX}terminate(){var t=this;return A(function*(){t.gcScheduler&&t.gcScheduler.stop(),yield t.sharedClientState.shutdown(),yield t.persistence.shutdown()})()}}class Sk{initialize(t,e){var r=this;return A(function*(){r.localStore||(r.localStore=t.localStore,r.sharedClientState=t.sharedClientState,r.datastore=r.createDatastore(e),r.remoteStore=r.createRemoteStore(e),r.eventManager=r.createEventManager(e),r.syncEngine=r.createSyncEngine(e,!t.synchronizeTabs),r.sharedClientState.onlineStateHandler=s=>cQ(r.syncEngine,s,1),r.remoteStore.remoteSyncer.handleCredentialChange=pCe.bind(null,r.syncEngine),yield function Ux(n,t){return Gx.apply(this,arguments)}(r.remoteStore,r.syncEngine.isPrimaryClient))})()}createEventManager(t){return new Qve}createDatastore(t){const e=Wg(t.databaseInfo.databaseId),r=new Rve(t.databaseInfo);return new Vve(t.authCredentials,t.appCheckCredentials,r,e)}createRemoteStore(t){return e=this.localStore,r=this.datastore,s=t.asyncQueue,i=c=>cQ(this.syncEngine,c,0),o=qX.C()?new qX:new xve,new Bve(e,r,s,i,o);var e,r,s,i,o}createSyncEngine(t,e){return function(r,s,i,o,c,u,h){const p=new iCe(r,s,i,o,c,u);return h&&(p.dc=!0),p}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)}terminate(){return(t=A(function*(e){const r=lt(e);Ge("RemoteStore","RemoteStore shutting down."),r._u.add(5),yield Wf(r),r.mu.shutdown(),r.gu.set("Unknown")}),function(e){return t.apply(this,arguments)})(this.remoteStore);var t}}function Pk(n,t,e){if(!e)throw new Be(be.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${t}.`)}function hQ(n){if(!ot.isDocumentKey(n))throw new Be(be.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function dQ(n){if(ot.isDocumentKey(n))throw new Be(be.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function zM(n){if(void 0===n)return"undefined";if(null===n)return"null";if("string"==typeof n)return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if("number"==typeof n||"boolean"==typeof n)return""+n;if("object"==typeof n){if(n instanceof Array)return"an array";{const t=(e=n).constructor?e.constructor.name:null;return t?`a custom ${t} object`:"an object"}}var e;return"function"==typeof n?"a function":wt()}function u1(n,t){if("_delegate"in n&&(n=n._delegate),!(n instanceof t)){if(t.name===n.constructor.name)throw new Be(be.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const e=zM(n);throw new Be(be.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${e}`)}}return n}const gQ=new Map;class mQ{constructor(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Be(be.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Be(be.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.useFetchStreams=!!t.useFetchStreams,function bCe(n,t,e,r){if(!0===t&&!0===r)throw new Be(be.INVALID_ARGUMENT,`${n} and ${e} cannot be used together.`)}("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class Zg{constructor(t,e,r,s){this._authCredentials=t,this._appCheckCredentials=e,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new mQ({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new Be(be.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(t){if(this._settingsFrozen)throw new Be(be.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new mQ(t),void 0!==t.credentials&&(this._authCredentials=function(e){if(!e)return new Rme;switch(e.type){case"gapi":return new Hme(e.client,e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new Be(be.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const e=gQ.get(t);e&&(Ge("ComponentProvider","Removing Datastore"),gQ.delete(t),e.terminate())}(this),Promise.resolve()}}function _Q(n,t,e,r={}){var s;const i=(n=u1(n,Zg))._getSettings();if("firestore.googleapis.com"!==i.host&&i.host!==t&&Of("Host has been set in both settings() and useEmulator(), emulator host will be used"),n._setSettings(Object.assign(Object.assign({},i),{host:`${t}:${e}`,ssl:!1})),r.mockUserToken){let o,c;if("string"==typeof r.mockUserToken)o=r.mockUserToken,c=Hi.MOCK_USER;else{o=function _pe(n,t){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r=t||"demo-project",s=n.iat||0,i=n.sub||n.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},n);return[wE(JSON.stringify({alg:"none",type:"JWT"})),wE(JSON.stringify(o)),""].join(".")}(r.mockUserToken,null===(s=n._app)||void 0===s?void 0:s.options.projectId);const u=r.mockUserToken.sub||r.mockUserToken.user_id;if(!u)throw new Be(be.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new Hi(u)}n._authCredentials=new Dme(new YY(o,c))}}class bs{constructor(t,e,r){this.converter=e,this._key=r,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new x4(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new bs(this.firestore,t,this._key)}}class eo{constructor(t,e,r){this.converter=e,this._query=r,this.type="query",this.firestore=t}withConverter(t){return new eo(this.firestore,t,this._query)}}class x4 extends eo{constructor(t,e,r){super(t,e,kf(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new bs(this.firestore,null,new ot(t))}withConverter(t){return new x4(this.firestore,t,this._path)}}function OCe(n,t,...e){if(n=Qr(n),Pk("collection","path",t),n instanceof Zg){const r=m1.fromString(t,...e);return dQ(r),new x4(n,null,r)}{if(!(n instanceof bs||n instanceof x4))throw new Be(be.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(m1.fromString(t,...e));return dQ(r),new x4(n.firestore,null,r)}}function vQ(n,t,...e){if(n=Qr(n),1===arguments.length&&(t=XY.R()),Pk("doc","path",t),n instanceof Zg){const r=m1.fromString(t,...e);return hQ(r),new bs(n,null,new ot(r))}{if(!(n instanceof bs||n instanceof x4))throw new Be(be.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(m1.fromString(t,...e));return hQ(r),new bs(n.firestore,n instanceof x4?n.converter:null,new ot(r))}}class VM{constructor(t){this.observer=t,this.muted=!1}next(t){this.observer.next&&this.Rc(this.observer.next,t)}error(t){this.observer.error?this.Rc(this.observer.error,t):Ts("Uncaught Error in snapshot listener:",t.toString())}bc(){this.muted=!0}Rc(t,e){this.muted||setTimeout(()=>{this.muted||t(e)},0)}}class LCe{constructor(t,e,r,s){var i=this;this.authCredentials=t,this.appCheckCredentials=e,this.asyncQueue=r,this.databaseInfo=s,this.user=Hi.UNAUTHENTICATED,this.clientId=XY.R(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,function(){var o=A(function*(c){Ge("FirestoreClient","Received user=",c.uid),yield i.authCredentialListener(c),i.user=c});return function(c){return o.apply(this,arguments)}}()),this.appCheckCredentials.start(r,o=>(Ge("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}getConfiguration(){var t=this;return A(function*(){return{asyncQueue:t.asyncQueue,databaseInfo:t.databaseInfo,clientId:t.clientId,authCredentials:t.authCredentials,appCheckCredentials:t.appCheckCredentials,initialUser:t.user,maxConcurrentLimboResolutions:100}})()}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Be(be.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){var t=this;this.asyncQueue.enterRestrictedMode();const e=new pi;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(A(function*(){try{t.onlineComponents&&(yield t.onlineComponents.terminate()),t.offlineComponents&&(yield t.offlineComponents.terminate()),t.authCredentials.shutdown(),t.appCheckCredentials.shutdown(),e.resolve()}catch(r){const s=Zf(r,"Failed to shutdown persistence");e.reject(s)}})),e.promise}}function EQ(n,t){return Tk.apply(this,arguments)}function Tk(){return Tk=A(function*(n,t){n.asyncQueue.verifyOperationInProgress(),Ge("FirestoreClient","Initializing OfflineComponentProvider");const e=yield n.getConfiguration();yield t.initialize(e);let r=e.initialUser;n.setCredentialChangeListener(function(){var s=A(function*(i){r.isEqual(i)||(yield zX(t.localStore,i),r=i)});return function(i){return s.apply(this,arguments)}}()),t.persistence.setDatabaseDeletedListener(()=>n.terminate()),n.offlineComponents=t}),Tk.apply(this,arguments)}function MQ(n,t){return wk.apply(this,arguments)}function wk(){return wk=A(function*(n,t){n.asyncQueue.verifyOperationInProgress();const e=yield bk(n);Ge("FirestoreClient","Initializing OnlineComponentProvider");const r=yield n.getConfiguration();yield t.initialize(e,r),n.setCredentialChangeListener(s=>eQ(t.remoteStore,s)),n.setAppCheckTokenChangeListener((s,i)=>eQ(t.remoteStore,i)),n.onlineComponents=t}),wk.apply(this,arguments)}function bk(n){return Ok.apply(this,arguments)}function Ok(){return Ok=A(function*(n){return n.offlineComponents||(Ge("FirestoreClient","Using default OfflineComponentProvider"),yield EQ(n,new PCe)),n.offlineComponents}),Ok.apply(this,arguments)}function HM(n){return Nk.apply(this,arguments)}function Nk(){return Nk=A(function*(n){return n.onlineComponents||(Ge("FirestoreClient","Using default OnlineComponentProvider"),yield MQ(n,new Sk)),n.onlineComponents}),Nk.apply(this,arguments)}function Qf(n){return xk.apply(this,arguments)}function xk(){return xk=A(function*(n){const t=yield HM(n),e=t.eventManager;return e.onListen=oCe.bind(null,t.syncEngine),e.onUnlisten=aCe.bind(null,t.syncEngine),e}),xk.apply(this,arguments)}class $Ce{constructor(){this.Bc=Promise.resolve(),this.Lc=[],this.Uc=!1,this.qc=[],this.Kc=null,this.Gc=!1,this.Qc=!1,this.jc=[],this.xo=new wx(this,"async_queue_retry"),this.Wc=()=>{const e=LM();e&&Ge("AsyncQueue","Visibility state changed to "+e.visibilityState),this.xo.Po()};const t=LM();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Wc)}get isShuttingDown(){return this.Uc}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.zc(),this.Hc(t)}enterRestrictedMode(t){if(!this.Uc){this.Uc=!0,this.Qc=t||!1;const e=LM();e&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this.Wc)}}enqueue(t){if(this.zc(),this.Uc)return new Promise(()=>{});const e=new pi;return this.Hc(()=>this.Uc&&this.Qc?Promise.resolve():(t().then(e.resolve,e.reject),e.promise)).then(()=>e.promise)}enqueueRetryable(t){this.enqueueAndForget(()=>(this.Lc.push(t),this.Jc()))}Jc(){var t=this;return A(function*(){if(0!==t.Lc.length){try{yield t.Lc[0](),t.Lc.shift(),t.xo.reset()}catch(e){if(!k0(e))throw e;Ge("AsyncQueue","Operation failed with retryable error: "+e)}t.Lc.length>0&&t.xo.Ro(()=>t.Jc())}})()}Hc(t){const e=this.Bc.then(()=>(this.Gc=!0,t().catch(r=>{throw this.Kc=r,this.Gc=!1,Ts("INTERNAL UNHANDLED ERROR: ",function(i){let o=i.message||"";return i.stack&&(o=i.stack.includes(i.message)?i.stack:i.message+"\n"+i.stack),o}(r)),r}).then(r=>(this.Gc=!1,r))));return this.Bc=e,e}enqueueAfterDelay(t,e,r){this.zc(),this.jc.indexOf(t)>-1&&(e=0);const s=Wx.createAndSchedule(this,t,e,r,i=>this.Yc(i));return this.qc.push(s),s}zc(){this.Kc&&wt()}verifyOperationInProgress(){}Xc(){var t=this;return A(function*(){let e;do{e=t.Bc,yield e}while(e!==t.Bc)})()}Zc(t){for(const e of this.qc)if(e.timerId===t)return!0;return!1}ta(t){return this.Xc().then(()=>{this.qc.sort((e,r)=>e.targetTimeMs-r.targetTimeMs);for(const e of this.qc)if(e.skipDelay(),"all"!==t&&e.timerId===t)break;return this.Xc()})}ea(t){this.jc.push(t)}Yc(t){const e=this.qc.indexOf(t);this.qc.splice(e,1)}}function kk(n){return function(t,e){if("object"!=typeof t||null===t)return!1;const r=t;for(const s of["next","error","complete"])if(s in r&&"function"==typeof r[s])return!0;return!1}(n)}class Tr extends Zg{constructor(t,e,r,s){super(t,e,r,s),this.type="firestore",this._queue=new $Ce,this._persistenceKey=s?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||bQ(this),this._firestoreClient.terminate()}}function GCe(n,t){const r="string"==typeof n?n:t||"(default)",s=Ef("object"==typeof n?n:KA(),"firestore").getImmediate({identifier:r});if(!s._initialized){const i=(n=>{const t=gZ("firestore");if(!t)return;const e=t.lastIndexOf(":");if(e<=0||e+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const r=parseInt(t.substring(e+1),10);return"["===t[0]?[t.substring(1,e-1),r]:[t.substring(0,e),r]})();i&&_Q(s,...i)}return s}function js(n){return n._firestoreClient||bQ(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function bQ(n){var t;const e=n._freezeSettings(),r=(i=(null===(t=n._app)||void 0===t?void 0:t.options.appId)||"",new Xme(n._databaseId,i,n._persistenceKey,(c=e).host,c.ssl,c.experimentalForceLongPolling,c.experimentalAutoDetectLongPolling,c.useFetchStreams));var i,c;n._firestoreClient=new LCe(n._authCredentials,n._appCheckCredentials,n._queue,r)}class i5{constructor(t){this._byteString=t}static fromBase64String(t){try{return new i5(gi.fromBase64String(t))}catch(e){throw new Be(be.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(t){return new i5(gi.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}}class Jf{constructor(...t){for(let e=0;e<t.length;++e)if(0===t[e].length)throw new Be(be.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ws(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}class BM{constructor(t){this._methodName=t}}class Lk{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new Be(be.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new Be(be.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(t){return vn(this._lat,t._lat)||vn(this._long,t._long)}}const WCe=/^__.*__$/;class qCe{constructor(t,e,r){this.data=t,this.fieldMask=e,this.fieldTransforms=r}toMutation(t,e){return null!==this.fieldMask?new Wl(t,this.data,this.fieldMask,e,this.fieldTransforms):new zf(t,this.data,e,this.fieldTransforms)}}class AQ{constructor(t,e,r){this.data=t,this.fieldMask=e,this.fieldTransforms=r}toMutation(t,e){return new Wl(t,this.data,this.fieldMask,e,this.fieldTransforms)}}function IQ(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw wt()}}class $M{constructor(t,e,r,s,i,o){this.settings=t,this.databaseId=e,this.It=r,this.ignoreUndefinedProperties=s,void 0===i&&this.na(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get sa(){return this.settings.sa}ia(t){return new $M(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.It,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ra(t){var e;const r=null===(e=this.path)||void 0===e?void 0:e.child(t),s=this.ia({path:r,oa:!1});return s.ua(t),s}ca(t){var e;const r=null===(e=this.path)||void 0===e?void 0:e.child(t),s=this.ia({path:r,oa:!1});return s.na(),s}aa(t){return this.ia({path:void 0,oa:!0})}ha(t){return GM(t,this.settings.methodName,this.settings.la||!1,this.path,this.settings.fa)}contains(t){return void 0!==this.fieldMask.find(e=>t.isPrefixOf(e))||void 0!==this.fieldTransforms.find(e=>t.isPrefixOf(e.field))}na(){if(this.path)for(let t=0;t<this.path.length;t++)this.ua(this.path.get(t))}ua(t){if(0===t.length)throw this.ha("Document fields must not be empty");if(IQ(this.sa)&&WCe.test(t))throw this.ha('Document fields cannot begin and end with "__"')}}class jCe{constructor(t,e,r){this.databaseId=t,this.ignoreUndefinedProperties=e,this.It=r||Wg(t)}da(t,e,r,s=!1){return new $M({sa:t,methodName:e,fa:r,path:ws.emptyPath(),oa:!1,la:s},this.databaseId,this.It,this.ignoreUndefinedProperties)}}function e9(n){const t=n._freezeSettings(),e=Wg(n._databaseId);return new jCe(n._databaseId,!!t.ignoreUndefinedProperties,e)}function Rk(n,t,e,r,s,i={}){const o=n.da(i.merge||i.mergeFields?2:0,t,e,s);zk("Data must be an object, but it was:",o,r);const c=DQ(r,o);let u,h;if(i.merge)u=new Ua(o.fieldMask),h=o.fieldTransforms;else if(i.mergeFields){const p=[];for(const m of i.mergeFields){const C=Vk(t,m,e);if(!o.contains(C))throw new Be(be.INVALID_ARGUMENT,`Field '${C}' is specified in your field mask but missing from your input data.`);VQ(p,C)||p.push(C)}u=new Ua(p),h=o.fieldTransforms.filter(m=>u.covers(m.field))}else u=null,h=o.fieldTransforms;return new qCe(new S2(c),u,h)}class Yg extends BM{_toFieldTransform(t){if(2!==t.sa)throw t.ha(1===t.sa?`${this._methodName}() can only appear at the top level of your update data`:`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return t.fieldMask.push(t.path),null}isEqual(t){return t instanceof Yg}}class Dk extends BM{_toFieldTransform(t){return new bg(t.path,new Rf)}isEqual(t){return t instanceof Dk}}function o5(n,t){if(zQ(n=Qr(n)))return zk("Unsupported field value:",t,n),DQ(n,t);if(n instanceof BM)return function(e,r){if(!IQ(r.sa))throw r.ha(`${e._methodName}() can only be used with update() and set()`);if(!r.path)throw r.ha(`${e._methodName}() is not currently supported inside arrays`);const s=e._toFieldTransform(r);s&&r.fieldTransforms.push(s)}(n,t),null;if(void 0===n&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),n instanceof Array){if(t.settings.oa&&4!==t.sa)throw t.ha("Nested arrays are not supported");return function(e,r){const s=[];let i=0;for(const o of e){let c=o5(o,r.aa(i));null==c&&(c={nullValue:"NULL_VALUE"}),s.push(c),i++}return{arrayValue:{values:s}}}(n,t)}return function(e,r){if(null===(e=Qr(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return OK(r.It,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const s=Jr.fromDate(e);return{timestampValue:kg(r.It,s)}}if(e instanceof Jr){const s=new Jr(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:kg(r.It,s)}}if(e instanceof Lk)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof i5)return{bytesValue:YK(r.It,e._byteString)};if(e instanceof bs){const s=r.databaseId,i=e.firestore._databaseId;if(!i.isEqual(s))throw r.ha(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:nx(e.firestore._databaseId||r.databaseId,e._key.path)}}throw r.ha(`Unsupported field value: ${zM(e)}`)}(n,t)}function DQ(n,t){const e={};return sK(n)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Uu(n,(r,s)=>{const i=o5(s,t.ra(r));null!=i&&(e[r]=i)}),{mapValue:{fields:e}}}function zQ(n){return!("object"!=typeof n||null===n||n instanceof Array||n instanceof Date||n instanceof Jr||n instanceof Lk||n instanceof i5||n instanceof bs||n instanceof BM)}function zk(n,t,e){if(!zQ(e)||"object"!=typeof(r=e)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r)){const r=zM(e);throw t.ha("an object"===r?n+" a custom object":n+" "+r)}var r}function Vk(n,t,e){if((t=Qr(t))instanceof Jf)return t._internalPath;if("string"==typeof t)return UM(n,t);throw GM("Field path arguments must be of type string or ",n,!1,void 0,e)}const XCe=new RegExp("[~\\*/\\[\\]]");function UM(n,t,e){if(t.search(XCe)>=0)throw GM(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,e);try{return new Jf(...t.split("."))._internalPath}catch{throw GM(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,e)}}function GM(n,t,e,r,s){const i=r&&!r.isEmpty(),o=void 0!==s;let c=`Function ${t}() called with invalid data`;e&&(c+=" (via `toFirestore()`)"),c+=". ";let u="";return(i||o)&&(u+=" (found",i&&(u+=` in field ${r}`),o&&(u+=` in document ${s}`),u+=")"),new Be(be.INVALID_ARGUMENT,c+n+u)}function VQ(n,t){return n.some(e=>e.isEqual(t))}class Hk{constructor(t,e,r,s,i){this._firestore=t,this._userDataWriter=e,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new bs(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const t=new QCe(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const e=this._document.data.field(WM("DocumentSnapshot.get",t));if(null!==e)return this._userDataWriter.convertValue(e)}}}class QCe extends Hk{data(){return super.data()}}function WM(n,t){return"string"==typeof t?UM(n,t):t instanceof Jf?t._internalPath:t._delegate._internalPath}function HQ(n){if("L"===n.limitType&&0===n.explicitOrderBy.length)throw new Be(be.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Fk{}function JCe(n,...t){for(const e of t)n=e._apply(n);return n}class eye extends Fk{constructor(t,e,r){super(),this.ma=t,this.ga=e,this.ya=r,this.type="where"}_apply(t){const e=e9(t.firestore),r=function(s,i,o,c,u,h,p){let m;if(u.isKeyField()){if("array-contains"===h||"array-contains-any"===h)throw new Be(be.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if("in"===h||"not-in"===h){WQ(p,h);const w=[];for(const I of p)w.push(GQ(c,s,I));m={arrayValue:{values:w}}}else m=GQ(c,s,p)}else"in"!==h&&"not-in"!==h&&"array-contains-any"!==h||WQ(p,h),m=function RQ(n,t,e,r=!1){return o5(e,n.da(r?4:3,t))}(o,"where",p,"in"===h||"not-in"===h);const C=P2.create(u,h,m);return function(w,I){if(I.dt()){const K=XI(w);if(null!==K&&!K.isEqual(I.field))throw new Be(be.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${K.toString()}' and '${I.field.toString()}'`);const ie=KI(w);null!==ie&&qQ(0,I.field,ie)}const H=function(K,ie){for(const ye of K.filters)if(ie.indexOf(ye.op)>=0)return ye.op;return null}(w,function(K){switch(K){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(I.op));if(null!==H)throw new Be(be.INVALID_ARGUMENT,H===I.op?`Invalid query. You cannot use more than one '${I.op.toString()}' filter.`:`Invalid query. You cannot use '${I.op.toString()}' filters with '${H.toString()}' filters.`)}(s,C),C}(t._query,0,e,t.firestore._databaseId,this.ma,this.ga,this.ya);return new eo(t.firestore,t.converter,function(s,i){const o=s.filters.concat([i]);return new Gl(s.path,s.collectionGroup,s.explicitOrderBy.slice(),o,s.limit,s.limitType,s.startAt,s.endAt)}(t._query,r))}}function tye(n,t,e){const r=t,s=WM("where",n);return new eye(s,r,e)}class nye extends Fk{constructor(t,e){super(),this.ma=t,this.pa=e,this.type="orderBy"}_apply(t){const e=function(r,s,i){if(null!==r.startAt)throw new Be(be.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==r.endAt)throw new Be(be.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const o=new xf(s,i);return function(c,u){if(null===KI(c)){const h=XI(c);null!==h&&qQ(0,h,u.field)}}(r,o),o}(t._query,this.ma,this.pa);return new eo(t.firestore,t.converter,function(r,s){const i=r.explicitOrderBy.concat([s]);return new Gl(r.path,r.collectionGroup,i,r.filters.slice(),r.limit,r.limitType,r.startAt,r.endAt)}(t._query,e))}}function rye(n,t="asc"){const e=t,r=WM("orderBy",n);return new nye(r,e)}class FQ extends Fk{constructor(t,e,r){super(),this.type=t,this.Ia=e,this.Ta=r}_apply(t){return new eo(t.firestore,t.converter,gM(t._query,this.Ia,this.Ta))}}function sye(n){return function pQ(n,t){if(t<=0)throw new Be(be.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${t}.`)}("limit",n),new FQ("limit",n,"F")}function GQ(n,t,e){if("string"==typeof(e=Qr(e))){if(""===e)throw new Be(be.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!QI(t)&&-1!==e.indexOf("/"))throw new Be(be.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${e}' contains a '/' character.`);const r=t.path.child(m1.fromString(e));if(!ot.isDocumentKey(r))throw new Be(be.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return ju(n,new ot(r))}if(e instanceof bs)return ju(n,e._key);throw new Be(be.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${zM(e)}.`)}function WQ(n,t){if(!Array.isArray(n)||0===n.length)throw new Be(be.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`);if(n.length>10)throw new Be(be.INVALID_ARGUMENT,`Invalid Query. '${t.toString()}' filters support a maximum of 10 elements in the value array.`)}function qQ(n,t,e){if(!e.isEqual(t))throw new Be(be.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${t.toString()}' and so you must also use '${t.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${e.toString()}' instead.`)}function Bk(n,t,e){let r;return r=n?e&&(e.merge||e.mergeFields)?n.toFirestore(t,e):n.toFirestore(t):t,r}class a5{constructor(t,e){this.hasPendingWrites=t,this.fromCache=e}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class t9 extends Hk{constructor(t,e,r,s,i,o){super(t,e,r,s,o),this._firestore=t,this._firestoreImpl=t,this.metadata=i}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const e=new qM(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,e={}){if(this._document){const r=this._document.data.field(WM("DocumentSnapshot.get",t));if(null!==r)return this._userDataWriter.convertValue(r,e.serverTimestamps)}}}class qM extends t9{data(t={}){return super.data(t)}}class n9{constructor(t,e,r,s){this._firestore=t,this._userDataWriter=e,this._snapshot=s,this.metadata=new a5(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const t=[];return this.forEach(e=>t.push(e)),t}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(t,e){this._snapshot.docs.forEach(r=>{t.call(e,new qM(this._firestore,this._userDataWriter,r.key,r,new a5(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(t={}){const e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new Be(be.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(r,s){if(r._snapshot.oldDocs.isEmpty()){let i=0;return r._snapshot.docChanges.map(o=>({type:"added",doc:new qM(r._firestore,r._userDataWriter,o.doc.key,o.doc,new a5(r._snapshot.mutatedKeys.has(o.doc.key),r._snapshot.fromCache),r.query.converter),oldIndex:-1,newIndex:i++}))}{let i=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(o=>s||3!==o.type).map(o=>{const c=new qM(r._firestore,r._userDataWriter,o.doc.key,o.doc,new a5(r._snapshot.mutatedKeys.has(o.doc.key),r._snapshot.fromCache),r.query.converter);let u=-1,h=-1;return 0!==o.type&&(u=i.indexOf(o.doc.key),i=i.delete(o.doc.key)),1!==o.type&&(i=i.add(o.doc),h=i.indexOf(o.doc.key)),{type:oye(o.type),doc:c,oldIndex:u,newIndex:h}})}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}}function oye(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return wt()}}function aye(n){n=u1(n,bs);const t=u1(n.firestore,Tr);return function TQ(n,t,e={}){const r=new pi;return n.asyncQueue.enqueueAndForget(A(function*(){return function(s,i,o,c,u){const h=new VM({next:m=>{i.enqueueAndForget(()=>Zx(s,p));const C=m.docs.has(o);!C&&m.fromCache?u.reject(new Be(be.UNAVAILABLE,"Failed to get document because the client is offline.")):C&&m.fromCache&&c&&"server"===c.source?u.reject(new Be(be.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(m)},error:m=>u.reject(m)}),p=new Xx(kf(o.path),h,{includeMetadataChanges:!0,Nu:!0});return qx(s,p)}(yield Qf(n),n.asyncQueue,t,e,r)})),r.promise}(js(t),n._key).then(e=>$k(t,n,e))}class U0 extends class iye{convertValue(t,e="none"){switch(qu(t)){case 0:return null;case 1:return t.booleanValue;case 2:return ps(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(Gu(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 10:return this.convertObject(t.mapValue,e);default:throw wt()}}convertObject(t,e){const r={};return Uu(t.fields,(s,i)=>{r[s]=this.convertValue(i,e)}),r}convertGeoPoint(t){return new Lk(ps(t.latitude),ps(t.longitude))}convertArray(t,e){return(t.values||[]).map(r=>this.convertValue(r,e))}convertServerTimestamp(t,e){switch(e){case"previous":const r=oK(t);return null==r?null:this.convertValue(r,e);case"estimate":return this.convertTimestamp(Cg(t));default:return null}}convertTimestamp(t){const e=L0(t);return new Jr(e.seconds,e.nanos)}convertDocumentKey(t,e){const r=m1.fromString(t);sn(sX(r));const s=new Wu(r.get(1),r.get(3)),i=new ot(r.popFirst(5));return s.isEqual(e)||Ts(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${e.projectId}/${e.database}) instead.`),i}}{constructor(t){super(),this.firestore=t}convertBytes(t){return new i5(t)}convertReference(t){const e=this.convertDocumentKey(t,this.firestore._databaseId);return new bs(this.firestore,null,e)}}function cye(n){n=u1(n,eo);const t=u1(n.firestore,Tr),e=js(t),r=new U0(t);return HQ(n._query),function wQ(n,t,e={}){const r=new pi;return n.asyncQueue.enqueueAndForget(A(function*(){return function(s,i,o,c,u){const h=new VM({next:m=>{i.enqueueAndForget(()=>Zx(s,p)),m.fromCache&&"server"===c.source?u.reject(new Be(be.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(m)},error:m=>u.reject(m)}),p=new Xx(o,h,{includeMetadataChanges:!0,Nu:!0});return qx(s,p)}(yield Qf(n),n.asyncQueue,t,e,r)})),r.promise}(e,n._query).then(s=>new n9(t,r,n,s))}function lye(n,t,e){n=u1(n,bs);const r=u1(n.firestore,Tr),s=Bk(n.converter,t,e);return Kg(r,[Rk(e9(r),"setDoc",n._key,s,null!==n.converter,e).toMutation(n._key,Fr.none())])}function uye(n,t,e,...r){n=u1(n,bs);const s=u1(n.firestore,Tr),i=e9(s);let o;return o="string"==typeof(t=Qr(t))||t instanceof Jf?function LQ(n,t,e,r,s,i){const o=n.da(1,t,e),c=[Vk(t,r,e)],u=[s];if(i.length%2!=0)throw new Be(be.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let C=0;C<i.length;C+=2)c.push(Vk(t,i[C])),u.push(i[C+1]);const h=[],p=S2.empty();for(let C=c.length-1;C>=0;--C)if(!VQ(h,c[C])){const w=c[C];let I=u[C];I=Qr(I);const H=o.ca(w);if(I instanceof Yg)h.push(w);else{const K=o5(I,H);null!=K&&(h.push(w),p.set(w,K))}}const m=new Ua(h);return new AQ(p,m,o.fieldTransforms)}(i,"updateDoc",n._key,t,e,r):function kQ(n,t,e,r){const s=n.da(1,t,e);zk("Data must be an object, but it was:",s,r);const i=[],o=S2.empty();Uu(r,(u,h)=>{const p=UM(t,u,e);h=Qr(h);const m=s.ca(p);if(h instanceof Yg)i.push(p);else{const C=o5(h,m);null!=C&&(i.push(p),o.set(p,C))}});const c=new Ua(i);return new AQ(o,c,s.fieldTransforms)}(i,"updateDoc",n._key,t),Kg(s,[o.toMutation(n._key,Fr.exists(!0))])}function fye(n){return Kg(u1(n.firestore,Tr),[new Vf(n._key,Fr.none())])}function hye(n,t){const e=u1(n.firestore,Tr),r=vQ(n),s=Bk(n.converter,t);return Kg(e,[Rk(e9(n.firestore),"addDoc",r._key,s,null!==n.converter,{}).toMutation(r._key,Fr.exists(!1))]).then(()=>r)}function dye(n,...t){var e,r,s;n=Qr(n);let i={includeMetadataChanges:!1},o=0;"object"!=typeof t[o]||kk(t[o])||(i=t[o],o++);const c={includeMetadataChanges:i.includeMetadataChanges};if(kk(t[o])){const m=t[o];t[o]=null===(e=m.next)||void 0===e?void 0:e.bind(m),t[o+1]=null===(r=m.error)||void 0===r?void 0:r.bind(m),t[o+2]=null===(s=m.complete)||void 0===s?void 0:s.bind(m)}let u,h,p;if(n instanceof bs)h=u1(n.firestore,Tr),p=kf(n._key.path),u={next:m=>{t[o]&&t[o]($k(h,n,m))},error:t[o+1],complete:t[o+2]};else{const m=u1(n,eo);h=u1(m.firestore,Tr),p=m._query;const C=new U0(h);u={next:w=>{t[o]&&t[o](new n9(h,C,m,w))},error:t[o+1],complete:t[o+2]},HQ(n._query)}return function(m,C,w,I){const H=new VM(I),K=new Xx(C,H,w);return m.asyncQueue.enqueueAndForget(A(function*(){return qx(yield Qf(m),K)})),()=>{H.bc(),m.asyncQueue.enqueueAndForget(A(function*(){return Zx(yield Qf(m),K)}))}}(js(h),p,c,u)}function Kg(n,t){return function(e,r){const s=new pi;return e.asyncQueue.enqueueAndForget(A(function*(){return function cCe(n,t,e){return nk.apply(this,arguments)}(yield function Ik(n){return HM(n).then(t=>t.syncEngine)}(e),r,s)})),s.promise}(js(n),t)}function $k(n,t,e){const r=e.docs.get(t._key),s=new U0(n);return new t9(n,s,t._key,r,new a5(e.hasPendingWrites,e.fromCache),t.converter)}function G0(){return new Dk("serverTimestamp")}function ZQ(n,t){if(null!=n&&null!=t&&"object"==typeof n){if(null!=n.equals)return n.equals(t);{const e=n,r=t;for(const s of Object.keys(e)){if(!(s in r))return!1;if(!1===ZQ(e[s],r[s]))return!1}return!0}}return n===t}function Uk(n){return null==n||function _ye(n){return"object"==typeof n&&null!=n&&null!=n.equals}(n)||function Obe(n){return"string"==typeof n||"number"==typeof n||"boolean"==typeof n||null===n}(n)||function vye(n){if("object"==typeof n){for(const t in n)if(null!=n[t]&&!1===Uk(n[t]))return!1;return null!=n&&n.constructor.prototype===Object.prototype}return!1}(n)}function Ga(n,t){if(Uk(n)&&Uk(t))return ZQ(n,t);throw new Error(`Comparing non comparable objects: ${n.constructor.name} and ${t.constructor.name}`)}function ve(n,t,e){if(!1===n)throw void 0!==e&&console.log(e),Os.logError("Assertion failure",t),new Error(`Assertion failure: ${t}`)}!function(n,t=!0){bf="9.14.0",Oo(new X2("firestore",(e,{instanceIdentifier:r,options:s})=>{const i=e.getProvider("app").getImmediate(),o=new Tr(new zme(e.getProvider("auth-internal")),new Fme(e.getProvider("app-check-internal")),function(c,u){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new Be(be.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Wu(c.options.projectId,u)}(i,r),i);return s=Object.assign({useFetchStreams:t},s),o._setSettings(s),o},"PUBLIC").setMultipleInstances(!0)),fs(ZY,"3.7.3",n),fs(ZY,"3.7.3","esm2017")}();class k4{}class mi extends k4{static tuple(t,e,r){return new class extends mi{encodeMove(s){const i=e(s),o={};return Object.keys(i).forEach(c=>{o[c]=t[c].encode(i[c])}),o}decodeMove(s){const i={};return Object.keys(t).reverse().forEach(o=>{ve(null!=s[o],"Invalid encoded value"),i[o]=t[o].decode(s[o])}),r(Object.values(i))}}}static disjunction(t,e,r){return new class extends mi{encodeMove(s){return r(s)?{type:"T",encoded:t.encode(s)}:{type:"U",encoded:e.encode(s)}}decodeMove(s){const i=Me.getNonNullable(s).type,o=Me.getNonNullable(s).encoded;return"T"===i?t.decode(o):e.decode(o)}}}static disjunction3(t,e,r,s,i){return new class extends mi{encodeMove(o){return s(o)?{type:"T",encoded:t.encode(o)}:i(o)?{type:"U",encoded:e.encode(o)}:{type:"V",encoded:r.encode(o)}}decodeMove(o){const c=Me.getNonNullable(o).type,u=Me.getNonNullable(o).encoded;return"T"===c?t.decode(u):"U"===c?e.decode(u):r.decode(u)}}}encode(t){return this.encodeMove(t)}decode(t){return ve(!1===Array.isArray(t),"MoveEncoder.decode called with an array"),this.decodeMove(t)}}class Cn extends mi{static ofN(t,e,r){return new class extends Cn{maxValue(){return t}encodeNumber(s){return e(s)}decodeNumber(s){return r(s)}}}static tuple(t,e,r){return new class extends Cn{maxValue(){let s=0;return Object.keys(t).forEach(i=>{s=s*t[i].shift()+t[i].maxValue()}),s}encodeNumber(s){const i=e(s);let o=0;return Object.keys(i).forEach(c=>{o=o*t[c].shift()+t[c].encode(i[c])}),o}decodeNumber(s){const i={};let o=s;return Object.keys(t).reverse().forEach(c=>{const u=o%t[c].shift();o=(o-u)/t[c].shift(),i[c]=t[c].decode(u)}),r(Object.values(i))}}}static disjunction(t,e,r){return new class extends Cn{maxValue(){return Math.max(2*t.maxValue(),2*e.maxValue()+1)}encodeNumber(s){return r(s)?2*t.encodeNumber(s):2*e.encodeNumber(s)+1}decodeNumber(s){return s%2==0?t.decodeNumber(s/2):e.decodeNumber((s-1)/2)}}}static numberEncoder(t){return new class extends Cn{maxValue(){return t}encodeNumber(e){if(e>t)throw new Error("Cannot encode number bigger than the max with numberEncoder");return e}decodeNumber(e){if(e>t)throw new Error("Cannot decode number bigger than the max with numberEncoder");return e}}}shift(){return this.maxValue()+1}encodeMove(t){return this.encodeNumber(t)}decodeMove(t){return ve("number"==typeof t,"Invalid encoded number"),this.decodeNumber(t)}}Cn.booleanEncoder=new class extends Cn{maxValue(){return 1}encodeNumber(n){return n?1:0}decodeNumber(n){if(0===n)return!1;if(1===n)return!0;throw new Error("Invalid encoded boolean")}};class P{constructor(t){this.value=t}static of(t){return new P(t)}static ofNullable(t){return null==t?P.empty():P.of(t)}static empty(){return new P(null)}static getEncoder(t){return new class extends k4{encode(e){return e.isPresent()?t.encode(e.get()):null}decode(e){return null===e?P.empty():P.of(t.decode(e))}}}static getNumberEncoder(t){return new class extends Cn{maxValue(){return t.maxValue()+1}encodeNumber(e){return e.isPresent()?t.encodeNumber(e.get()):t.maxValue()+1}decodeNumber(e){return e===this.maxValue()?P.empty():P.of(t.decodeNumber(e))}}}isPresent(){return null!=this.value}isAbsent(){return null==this.value}get(){if(this.isPresent())return this.value;throw new Error("Value is absent")}getOrElse(t){return this.isPresent()?this.value:t}equals(t){return this.isAbsent()?t.isAbsent():!t.isAbsent()&&Ga(this.value,t.value)}equalsValue(t){return this.equals(P.of(t))}toString(){return this.isAbsent()?"MGPOptional.empty()":`MGPOptional.of(${this.value})`}map(t){return this.isPresent()?P.of(t(this.get())):P.empty()}}class U{static success(t){return new Cye(t)}static failure(t){return new yye(t)}constructor(){}equals(t){return this.isFailure()?t.isFailure()&&this.getReason()===t.getReason():!t.isFailure()&&Ga(this.get(),t.get())}}class Cye extends U{constructor(t){super(),this.value=t}isSuccess(){return!0}isFailure(){return!1}get(){return this.value}getReason(){throw new Error("Cannot get failure reason from a success")}getReasonOr(t){return t}toOptional(){return P.of(this.value)}toString(){return`MGPFallible.success(${this.value})`}}class yye extends U{constructor(t){super(),this.reason=t}isSuccess(){return!1}isFailure(){return!0}get(){throw new Error("Value is absent from failure, with the following reason: "+this.reason)}getReason(){return this.reason}getReasonOr(t){return this.getReason()}toOptional(){return P.empty()}toString(){return`MGPFallible.failure(${this.reason})`}}class G{constructor(t){this.reason=t}static ofFallible(t){return t.isSuccess()?G.SUCCESS:G.failure(t.getReason())}static failure(t){return new G(t)}isFailure(){return!1===this.isSuccess()}isSuccess(){return null==this.reason}getReason(){if(this.isSuccess())throw new Error("MGPValidation: Cannot extract failure reason from success.");return this.reason}toFallible(t){return this.isSuccess()?U.success(t):U.failure(this.getReason())}toFailedFallible(){if(this.isSuccess())throw new Error("MGPValidation: cannot convert into failed fallible.");return U.failure(this.getReason())}}G.SUCCESS=new G(null),fs("firebase","9.14.0","app");const YQ="@firebase/installations",Gk="0.5.16",XQ=`w:${Gk}`,QQ="FIS_v2",Zl=new w4("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function JQ(n){return n instanceof Ac&&n.code.includes("request-failed")}function Wk({projectId:n}){return`https://firebaseinstallations.googleapis.com/v1/projects/${n}/installations`}function eJ(n){return{token:n.token,requestStatus:2,expiresIn:Oye(n.expiresIn),creationTime:Date.now()}}function qk(n,t){return jk.apply(this,arguments)}function jk(){return jk=A(function*(n,t){const r=(yield t.json()).error;return Zl.create("request-failed",{requestName:n,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})}),jk.apply(this,arguments)}function tJ({apiKey:n}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n})}function nJ(n,{refreshToken:t}){const e=tJ(n);return e.append("Authorization",function Nye(n){return`${QQ} ${n}`}(t)),e}function Zk(n){return Yk.apply(this,arguments)}function Yk(){return Yk=A(function*(n){const t=yield n();return t.status>=500&&t.status<600?n():t}),Yk.apply(this,arguments)}function Oye(n){return Number(n.replace("s","000"))}function Aye(n,t){return Kk.apply(this,arguments)}function Kk(){return Kk=A(function*({appConfig:n,heartbeatServiceProvider:t},{fid:e}){const r=Wk(n),s=tJ(n),i=t.getImmediate({optional:!0});if(i){const h=yield i.getHeartbeatsHeader();h&&s.append("x-firebase-client",h)}const c={method:"POST",headers:s,body:JSON.stringify({fid:e,authVersion:QQ,appId:n.appId,sdkVersion:XQ})},u=yield Zk(()=>fetch(r,c));if(u.ok){const h=yield u.json();return{fid:h.fid||e,registrationStatus:2,refreshToken:h.refreshToken,authToken:eJ(h.authToken)}}throw yield qk("Create Installation",u)}),Kk.apply(this,arguments)}function rJ(n){return new Promise(t=>{setTimeout(t,n)})}const xye=/^[cdef][\w-]{21}$/;function kye(){try{const n=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(n),n[0]=112+n[0]%16;const e=function Lye(n){return function Iye(n){return btoa(String.fromCharCode(...n)).replace(/\+/g,"-").replace(/\//g,"_")}(n).substr(0,22)}(n);return xye.test(e)?e:""}catch{return""}}function r9(n){return`${n.appName}!${n.appId}`}const s9=new Map;function sJ(n,t){const e=r9(n);iJ(e,t),function zye(n,t){const e=function oJ(){return!c5&&"BroadcastChannel"in self&&(c5=new BroadcastChannel("[Firebase] FID Change"),c5.onmessage=n=>{iJ(n.data.key,n.data.fid)}),c5}();e&&e.postMessage({key:n,fid:t}),function aJ(){0===s9.size&&c5&&(c5.close(),c5=null)}()}(e,t)}function iJ(n,t){const e=s9.get(n);if(e)for(const r of e)r(t)}let c5=null;const l5="firebase-installations-store";let Qk=null;function Jk(){return Qk||(Qk=IE("firebase-installations-database",1,{upgrade:(n,t)=>{0===t&&n.createObjectStore(l5)}})),Qk}function ZM(n,t){return eL.apply(this,arguments)}function eL(){return eL=A(function*(n,t){const e=r9(n),s=(yield Jk()).transaction(l5,"readwrite"),i=s.objectStore(l5),o=yield i.get(e);return yield i.put(t,e),yield s.done,(!o||o.fid!==t.fid)&&sJ(n,t.fid),t}),eL.apply(this,arguments)}function tL(n){return nL.apply(this,arguments)}function nL(){return nL=A(function*(n){const t=r9(n),r=(yield Jk()).transaction(l5,"readwrite");yield r.objectStore(l5).delete(t),yield r.done}),nL.apply(this,arguments)}function Xg(n,t){return rL.apply(this,arguments)}function rL(){return rL=A(function*(n,t){const e=r9(n),s=(yield Jk()).transaction(l5,"readwrite"),i=s.objectStore(l5),o=yield i.get(e),c=t(o);return void 0===c?yield i.delete(e):yield i.put(c,e),yield s.done,c&&(!o||o.fid!==c.fid)&&sJ(n,c.fid),c}),rL.apply(this,arguments)}function sL(n){return iL.apply(this,arguments)}function iL(){return iL=A(function*(n){let t;const e=yield Xg(n.appConfig,r=>{const s=Fye(r),i=Bye(n,s);return t=i.registrationPromise,i.installationEntry});return""===e.fid?{installationEntry:yield t}:{installationEntry:e,registrationPromise:t}}),iL.apply(this,arguments)}function Fye(n){return lJ(n||{fid:kye(),registrationStatus:0})}function Bye(n,t){if(0===t.registrationStatus){if(!navigator.onLine)return{installationEntry:t,registrationPromise:Promise.reject(Zl.create("app-offline"))};const e={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},r=function $ye(n,t){return oL.apply(this,arguments)}(n,e);return{installationEntry:e,registrationPromise:r}}return 1===t.registrationStatus?{installationEntry:t,registrationPromise:Uye(n)}:{installationEntry:t}}function oL(){return oL=A(function*(n,t){try{const e=yield Aye(n,t);return ZM(n.appConfig,e)}catch(e){throw JQ(e)&&409===e.customData.serverCode?yield tL(n.appConfig):yield ZM(n.appConfig,{fid:t.fid,registrationStatus:0}),e}}),oL.apply(this,arguments)}function Uye(n){return aL.apply(this,arguments)}function aL(){return aL=A(function*(n){let t=yield cJ(n.appConfig);for(;1===t.registrationStatus;)yield rJ(100),t=yield cJ(n.appConfig);if(0===t.registrationStatus){const{installationEntry:e,registrationPromise:r}=yield sL(n);return r||e}return t}),aL.apply(this,arguments)}function cJ(n){return Xg(n,t=>{if(!t)throw Zl.create("installation-not-found");return lJ(t)})}function lJ(n){return function Gye(n){return 1===n.registrationStatus&&n.registrationTime+1e4<Date.now()}(n)?{fid:n.fid,registrationStatus:0}:n}function Wye(n,t){return cL.apply(this,arguments)}function cL(){return cL=A(function*({appConfig:n,heartbeatServiceProvider:t},e){const r=qye(n,e),s=nJ(n,e),i=t.getImmediate({optional:!0});if(i){const h=yield i.getHeartbeatsHeader();h&&s.append("x-firebase-client",h)}const c={method:"POST",headers:s,body:JSON.stringify({installation:{sdkVersion:XQ,appId:n.appId}})},u=yield Zk(()=>fetch(r,c));if(u.ok)return eJ(yield u.json());throw yield qk("Generate Auth Token",u)}),cL.apply(this,arguments)}function qye(n,{fid:t}){return`${Wk(n)}/${t}/authTokens:generate`}function lL(n){return uL.apply(this,arguments)}function uL(){return uL=A(function*(n,t=!1){let e;const r=yield Xg(n.appConfig,i=>{if(!fJ(i))throw Zl.create("not-registered");const o=i.authToken;if(!t&&Yye(o))return i;if(1===o.requestStatus)return e=jye(n,t),i;{if(!navigator.onLine)throw Zl.create("app-offline");const c=Xye(i);return e=Zye(n,c),c}});return e?yield e:r.authToken}),uL.apply(this,arguments)}function jye(n,t){return fL.apply(this,arguments)}function fL(){return fL=A(function*(n,t){let e=yield uJ(n.appConfig);for(;1===e.authToken.requestStatus;)yield rJ(100),e=yield uJ(n.appConfig);const r=e.authToken;return 0===r.requestStatus?lL(n,t):r}),fL.apply(this,arguments)}function uJ(n){return Xg(n,t=>{if(!fJ(t))throw Zl.create("not-registered");return function Qye(n){return 1===n.requestStatus&&n.requestTime+1e4<Date.now()}(t.authToken)?Object.assign(Object.assign({},t),{authToken:{requestStatus:0}}):t})}function Zye(n,t){return hL.apply(this,arguments)}function hL(){return hL=A(function*(n,t){try{const e=yield Wye(n,t),r=Object.assign(Object.assign({},t),{authToken:e});return yield ZM(n.appConfig,r),e}catch(e){if(!JQ(e)||401!==e.customData.serverCode&&404!==e.customData.serverCode){const r=Object.assign(Object.assign({},t),{authToken:{requestStatus:0}});yield ZM(n.appConfig,r)}else yield tL(n.appConfig);throw e}}),hL.apply(this,arguments)}function fJ(n){return void 0!==n&&2===n.registrationStatus}function Yye(n){return 2===n.requestStatus&&!function Kye(n){const t=Date.now();return t<n.creationTime||n.creationTime+n.expiresIn<t+36e5}(n)}function Xye(n){const t={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},n),{authToken:t})}function dL(){return dL=A(function*(n){const t=n,{installationEntry:e,registrationPromise:r}=yield sL(t);return r?r.catch(console.error):lL(t).catch(console.error),e.fid}),dL.apply(this,arguments)}function pL(){return pL=A(function*(n,t=!1){const e=n;return yield tEe(e),(yield lL(e,t)).token}),pL.apply(this,arguments)}function tEe(n){return gL.apply(this,arguments)}function gL(){return gL=A(function*(n){const{registrationPromise:t}=yield sL(n);t&&(yield t)}),gL.apply(this,arguments)}function vL(n){return Zl.create("missing-app-config-values",{valueName:n})}const hJ="installations",oEe=n=>{const t=n.getProvider("app").getImmediate(),e=function sEe(n){if(!n||!n.options)throw vL("App Configuration");if(!n.name)throw vL("App Name");const t=["projectId","apiKey","appId"];for(const e of t)if(!n.options[e])throw vL(e);return{appName:n.name,projectId:n.options.projectId,apiKey:n.options.apiKey,appId:n.options.appId}}(t);return{app:t,appConfig:e,heartbeatServiceProvider:Ef(t,"heartbeat"),_delete:()=>Promise.resolve()}},aEe=n=>{const e=Ef(n.getProvider("app").getImmediate(),hJ).getImmediate();return{getId:()=>function Jye(n){return dL.apply(this,arguments)}(e),getToken:s=>function eEe(n){return pL.apply(this,arguments)}(e,s)}};(function cEe(){Oo(new X2(hJ,oEe,"PUBLIC")),Oo(new X2("installations-internal",aEe,"PRIVATE"))})(),fs(YQ,Gk),fs(YQ,Gk,"esm2017");const CL="@firebase/remote-config",ua=new w4("remoteconfig","Remote Config",{"registration-window":"Undefined window object. This SDK only supports usage in a browser environment.","registration-project-id":"Undefined project identifier. Check Firebase app initialization.","registration-api-key":"Undefined API key. Check Firebase app initialization.","registration-app-id":"Undefined app identifier. Check Firebase app initialization.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}.","fetch-client-network":"Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-timeout":'The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',"fetch-throttle":'The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',"fetch-client-parse":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","indexed-db-unavailable":"Indexed DB is not supported by current browser"});class CEe{constructor(t,e,r,s){this.client=t,this.storage=e,this.storageCache=r,this.logger=s}isCachedDataFresh(t,e){if(!e)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;const r=Date.now()-e,s=r<=t;return this.logger.debug(`Config fetch cache check. Cache age millis: ${r}. Cache max age millis (minimumFetchIntervalMillis setting): ${t}. Is cache hit: ${s}.`),s}fetch(t){var e=this;return A(function*(){const[r,s]=yield Promise.all([e.storage.getLastSuccessfulFetchTimestampMillis(),e.storage.getLastSuccessfulFetchResponse()]);if(s&&e.isCachedDataFresh(t.cacheMaxAgeMillis,r))return s;t.eTag=s&&s.eTag;const i=yield e.client.fetch(t),o=[e.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())];return 200===i.status&&o.push(e.storage.setLastSuccessfulFetchResponse(i)),yield Promise.all(o),i})()}}function yEe(n=navigator){return n.languages&&n.languages[0]||n.language}class EEe{constructor(t,e,r,s,i,o){this.firebaseInstallations=t,this.sdkVersion=e,this.namespace=r,this.projectId=s,this.apiKey=i,this.appId=o}fetch(t){var e=this;return A(function*(){var r,s,i;const[o,c]=yield Promise.all([e.firebaseInstallations.getId(),e.firebaseInstallations.getToken()]),h=`${window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com"}/v1/projects/${e.projectId}/namespaces/${e.namespace}:fetch?key=${e.apiKey}`,p={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":t.eTag||"*"},m={sdk_version:e.sdkVersion,app_instance_id:o,app_instance_id_token:c,app_id:e.appId,language_code:yEe()},C={method:"POST",headers:p,body:JSON.stringify(m)},w=fetch(h,C),I=new Promise((ke,$e)=>{t.signal.addEventListener(()=>{const Xe=new Error("The operation was aborted.");Xe.name="AbortError",$e(Xe)})});let H;try{yield Promise.race([w,I]),H=yield w}catch(ke){let $e="fetch-client-network";throw"AbortError"===(null===(r=ke)||void 0===r?void 0:r.name)&&($e="fetch-timeout"),ua.create($e,{originalErrorMessage:null===(s=ke)||void 0===s?void 0:s.message})}let K=H.status;const ie=H.headers.get("ETag")||void 0;let ye,te;if(200===H.status){let ke;try{ke=yield H.json()}catch($e){throw ua.create("fetch-client-parse",{originalErrorMessage:null===(i=$e)||void 0===i?void 0:i.message})}ye=ke.entries,te=ke.state}if("INSTANCE_STATE_UNSPECIFIED"===te?K=500:"NO_CHANGE"===te?K=304:("NO_TEMPLATE"===te||"EMPTY_CONFIG"===te)&&(ye={}),304!==K&&200!==K)throw ua.create("fetch-status",{httpStatus:K});return{status:K,eTag:ie,config:ye}})()}}class PEe{constructor(t,e){this.client=t,this.storage=e}fetch(t){var e=this;return A(function*(){const r=(yield e.storage.getThrottleMetadata())||{backoffCount:0,throttleEndTimeMillis:Date.now()};return e.attemptFetch(t,r)})()}attemptFetch(t,{throttleEndTimeMillis:e,backoffCount:r}){var s=this;return A(function*(){yield function MEe(n,t){return new Promise((e,r)=>{const s=Math.max(t-Date.now(),0),i=setTimeout(e,s);n.addEventListener(()=>{clearTimeout(i),r(ua.create("fetch-throttle",{throttleEndTimeMillis:t}))})})}(t.signal,e);try{const i=yield s.client.fetch(t);return yield s.storage.deleteThrottleMetadata(),i}catch(i){if(!function SEe(n){if(!(n instanceof Ac&&n.customData))return!1;const t=Number(n.customData.httpStatus);return 429===t||500===t||503===t||504===t}(i))throw i;const o={throttleEndTimeMillis:Date.now()+FA(r),backoffCount:r+1};return yield s.storage.setThrottleMetadata(o),s.attemptFetch(t,o)}})()}}class bEe{constructor(t,e,r,s,i){this.app=t,this._client=e,this._storageCache=r,this._storage=s,this._logger=i,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:6e4,minimumFetchIntervalMillis:432e5},this.defaultConfig={}}get fetchTimeMillis(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1}get lastFetchStatus(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"}}function KM(n,t){var e;const r=n.target.error||void 0;return ua.create(t,{originalErrorMessage:r&&(null===(e=r)||void 0===e?void 0:e.message)})}const u5="app_namespace_store";class IEe{constructor(t,e,r,s=function AEe(){return new Promise((n,t)=>{var e;try{const r=indexedDB.open("firebase_remote_config",1);r.onerror=s=>{t(KM(s,"storage-open"))},r.onsuccess=s=>{n(s.target.result)},r.onupgradeneeded=s=>{0===s.oldVersion&&s.target.result.createObjectStore(u5,{keyPath:"compositeKey"})}}catch(r){t(ua.create("storage-open",{originalErrorMessage:null===(e=r)||void 0===e?void 0:e.message}))}})}()){this.appId=t,this.appName=e,this.namespace=r,this.openDbPromise=s}getLastFetchStatus(){return this.get("last_fetch_status")}setLastFetchStatus(t){return this.set("last_fetch_status",t)}getLastSuccessfulFetchTimestampMillis(){return this.get("last_successful_fetch_timestamp_millis")}setLastSuccessfulFetchTimestampMillis(t){return this.set("last_successful_fetch_timestamp_millis",t)}getLastSuccessfulFetchResponse(){return this.get("last_successful_fetch_response")}setLastSuccessfulFetchResponse(t){return this.set("last_successful_fetch_response",t)}getActiveConfig(){return this.get("active_config")}setActiveConfig(t){return this.set("active_config",t)}getActiveConfigEtag(){return this.get("active_config_etag")}setActiveConfigEtag(t){return this.set("active_config_etag",t)}getThrottleMetadata(){return this.get("throttle_metadata")}setThrottleMetadata(t){return this.set("throttle_metadata",t)}deleteThrottleMetadata(){return this.delete("throttle_metadata")}get(t){var e=this;return A(function*(){const r=yield e.openDbPromise;return new Promise((s,i)=>{var o;const u=r.transaction([u5],"readonly").objectStore(u5),h=e.createCompositeKey(t);try{const p=u.get(h);p.onerror=m=>{i(KM(m,"storage-get"))},p.onsuccess=m=>{const C=m.target.result;s(C?C.value:void 0)}}catch(p){i(ua.create("storage-get",{originalErrorMessage:null===(o=p)||void 0===o?void 0:o.message}))}})})()}set(t,e){var r=this;return A(function*(){const s=yield r.openDbPromise;return new Promise((i,o)=>{var c;const h=s.transaction([u5],"readwrite").objectStore(u5),p=r.createCompositeKey(t);try{const m=h.put({compositeKey:p,value:e});m.onerror=C=>{o(KM(C,"storage-set"))},m.onsuccess=()=>{i()}}catch(m){o(ua.create("storage-set",{originalErrorMessage:null===(c=m)||void 0===c?void 0:c.message}))}})})()}delete(t){var e=this;return A(function*(){const r=yield e.openDbPromise;return new Promise((s,i)=>{var o;const u=r.transaction([u5],"readwrite").objectStore(u5),h=e.createCompositeKey(t);try{const p=u.delete(h);p.onerror=m=>{i(KM(m,"storage-delete"))},p.onsuccess=()=>{s()}}catch(p){i(ua.create("storage-delete",{originalErrorMessage:null===(o=p)||void 0===o?void 0:o.message}))}})})()}createCompositeKey(t){return[this.appId,this.appName,this.namespace,t].join()}}class xEe{constructor(t){this.storage=t}getLastFetchStatus(){return this.lastFetchStatus}getLastSuccessfulFetchTimestampMillis(){return this.lastSuccessfulFetchTimestampMillis}getActiveConfig(){return this.activeConfig}loadFromStorage(){var t=this;return A(function*(){const e=t.storage.getLastFetchStatus(),r=t.storage.getLastSuccessfulFetchTimestampMillis(),s=t.storage.getActiveConfig(),i=yield e;i&&(t.lastFetchStatus=i);const o=yield r;o&&(t.lastSuccessfulFetchTimestampMillis=o);const c=yield s;c&&(t.activeConfig=c)})()}setLastFetchStatus(t){return this.lastFetchStatus=t,this.storage.setLastFetchStatus(t)}setLastSuccessfulFetchTimestampMillis(t){return this.lastSuccessfulFetchTimestampMillis=t,this.storage.setLastSuccessfulFetchTimestampMillis(t)}setActiveConfig(t){return this.activeConfig=t,this.storage.setActiveConfig(t)}}function LEe(){return PL.apply(this,arguments)}function PL(){return(PL=A(function*(){if(!ku())return!1;try{return yield jp()}catch{return!1}})).apply(this,arguments)}!function kEe(){Oo(new X2("remote-config",function n(t,{instanceIdentifier:e}){const r=t.getProvider("app").getImmediate(),s=t.getProvider("installations-internal").getImmediate();if(typeof window>"u")throw ua.create("registration-window");if(!ku())throw ua.create("indexed-db-unavailable");const{projectId:i,apiKey:o,appId:c}=r.options;if(!i)throw ua.create("registration-project-id");if(!o)throw ua.create("registration-api-key");if(!c)throw ua.create("registration-app-id");const u=new IEe(c,r.name,e=e||"firebase"),h=new xEe(u),p=new yf(CL);p.logLevel=g1.ERROR;const m=new EEe(s,Mf,e,i,o,c),C=new PEe(m,u),w=new CEe(C,u,h,p),I=new bEe(r,w,h,u,p);return function mEe(n){const t=Qr(n);t._initializePromise||(t._initializePromise=t._storageCache.loadFromStorage().then(()=>{t._isInitializationComplete=!0}))}(I),I},"PUBLIC").setMultipleInstances(!0)),fs(CL,"0.3.15"),fs(CL,"0.3.15","esm2017")}();const REe="/firebase-messaging-sw.js",DEe="/firebase-cloud-messaging-push-scope",mJ="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",_J="google.c.a.c_id",VEe="google.c.a.c_l",HEe="google.c.a.ts",FEe="google.c.a.e";var i9=(()=>(function(n){n.PUSH_RECEIVED="push-received",n.NOTIFICATION_CLICKED="notification-clicked"}(i9||(i9={})),i9))();function Yl(n){const t=new Uint8Array(n);return btoa(String.fromCharCode(...t)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function BEe(n){const e=(n+"=".repeat((4-n.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),r=atob(e),s=new Uint8Array(r.length);for(let i=0;i<r.length;++i)s[i]=r.charCodeAt(i);return s}const TL="fcm_token_details_db",vJ="fcm_token_object_Store";function UEe(n){return wL.apply(this,arguments)}function wL(){return wL=A(function*(n){if("databases"in indexedDB&&!(yield indexedDB.databases()).map(i=>i.name).includes(TL))return null;let t=null;return(yield IE(TL,5,{upgrade:(r=A(function*(s,i,o,c){var u;if(i<2||!s.objectStoreNames.contains(vJ))return;const h=c.objectStore(vJ),p=yield h.index("fcmSenderId").get(n);if(yield h.clear(),p)if(2===i){const m=p;if(!m.auth||!m.p256dh||!m.endpoint)return;t={token:m.fcmToken,createTime:null!==(u=m.createTime)&&void 0!==u?u:Date.now(),subscriptionOptions:{auth:m.auth,p256dh:m.p256dh,endpoint:m.endpoint,swScope:m.swScope,vapidKey:"string"==typeof m.vapidKey?m.vapidKey:Yl(m.vapidKey)}}}else if(3===i){const m=p;t={token:m.fcmToken,createTime:m.createTime,subscriptionOptions:{auth:Yl(m.auth),p256dh:Yl(m.p256dh),endpoint:m.endpoint,swScope:m.swScope,vapidKey:Yl(m.vapidKey)}}}else if(4===i){const m=p;t={token:m.fcmToken,createTime:m.createTime,subscriptionOptions:{auth:Yl(m.auth),p256dh:Yl(m.p256dh),endpoint:m.endpoint,swScope:m.swScope,vapidKey:Yl(m.vapidKey)}}}}),function(i,o,c,u){return r.apply(this,arguments)})})).close(),yield jA(TL),yield jA("fcm_vapid_details_db"),yield jA("undefined"),GEe(t)?t:null;var r}),wL.apply(this,arguments)}function GEe(n){if(!n||!n.subscriptionOptions)return!1;const{subscriptionOptions:t}=n;return"number"==typeof n.createTime&&n.createTime>0&&"string"==typeof n.token&&n.token.length>0&&"string"==typeof t.auth&&t.auth.length>0&&"string"==typeof t.p256dh&&t.p256dh.length>0&&"string"==typeof t.endpoint&&t.endpoint.length>0&&"string"==typeof t.swScope&&t.swScope.length>0&&"string"==typeof t.vapidKey&&t.vapidKey.length>0}const f5="firebase-messaging-store";let bL=null;function OL(){return bL||(bL=IE("firebase-messaging-database",1,{upgrade:(n,t)=>{0===t&&n.createObjectStore(f5)}})),bL}function CJ(n){return NL.apply(this,arguments)}function NL(){return NL=A(function*(n){const t=kL(n),r=yield(yield OL()).transaction(f5).objectStore(f5).get(t);if(r)return r;{const s=yield UEe(n.appConfig.senderId);if(s)return yield AL(n,s),s}}),NL.apply(this,arguments)}function AL(n,t){return IL.apply(this,arguments)}function IL(){return IL=A(function*(n,t){const e=kL(n),s=(yield OL()).transaction(f5,"readwrite");return yield s.objectStore(f5).put(t,e),yield s.done,t}),IL.apply(this,arguments)}function jEe(n){return xL.apply(this,arguments)}function xL(){return xL=A(function*(n){const t=kL(n),r=(yield OL()).transaction(f5,"readwrite");yield r.objectStore(f5).delete(t),yield r.done}),xL.apply(this,arguments)}function kL({appConfig:n}){return n.appId}const T2=new w4("messaging","Messaging",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."});function YEe(n,t){return LL.apply(this,arguments)}function LL(){return LL=A(function*(n,t){var e;const r=yield VL(n),s=EJ(t),i={method:"POST",headers:r,body:JSON.stringify(s)};let o;try{o=yield(yield fetch(zL(n.appConfig),i)).json()}catch(c){throw T2.create("token-subscribe-failed",{errorInfo:null===(e=c)||void 0===e?void 0:e.toString()})}if(o.error)throw T2.create("token-subscribe-failed",{errorInfo:o.error.message});if(!o.token)throw T2.create("token-subscribe-no-token");return o.token}),LL.apply(this,arguments)}function KEe(n,t){return RL.apply(this,arguments)}function RL(){return RL=A(function*(n,t){var e;const r=yield VL(n),s=EJ(t.subscriptionOptions),i={method:"PATCH",headers:r,body:JSON.stringify(s)};let o;try{o=yield(yield fetch(`${zL(n.appConfig)}/${t.token}`,i)).json()}catch(c){throw T2.create("token-update-failed",{errorInfo:null===(e=c)||void 0===e?void 0:e.toString()})}if(o.error)throw T2.create("token-update-failed",{errorInfo:o.error.message});if(!o.token)throw T2.create("token-update-no-token");return o.token}),RL.apply(this,arguments)}function yJ(n,t){return DL.apply(this,arguments)}function DL(){return DL=A(function*(n,t){var e;const s={method:"DELETE",headers:yield VL(n)};try{const o=yield(yield fetch(`${zL(n.appConfig)}/${t}`,s)).json();if(o.error)throw T2.create("token-unsubscribe-failed",{errorInfo:o.error.message})}catch(i){throw T2.create("token-unsubscribe-failed",{errorInfo:null===(e=i)||void 0===e?void 0:e.toString()})}}),DL.apply(this,arguments)}function zL({projectId:n}){return`https://fcmregistrations.googleapis.com/v1/projects/${n}/registrations`}function VL(n){return HL.apply(this,arguments)}function HL(){return HL=A(function*({appConfig:n,installations:t}){const e=yield t.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n.apiKey,"x-goog-firebase-installations-auth":`FIS ${e}`})}),HL.apply(this,arguments)}function EJ({p256dh:n,auth:t,endpoint:e,vapidKey:r}){const s={web:{endpoint:e,auth:t,p256dh:n}};return r!==mJ&&(s.web.applicationPubKey=r),s}function QEe(n){return FL.apply(this,arguments)}function FL(){return FL=A(function*(n){const t=yield eMe(n.swRegistration,n.vapidKey),e={vapidKey:n.vapidKey,swScope:n.swRegistration.scope,endpoint:t.endpoint,auth:Yl(t.getKey("auth")),p256dh:Yl(t.getKey("p256dh"))},r=yield CJ(n.firebaseDependencies);if(r){if(tMe(r.subscriptionOptions,e))return Date.now()>=r.createTime+6048e5?JEe(n,{token:r.token,createTime:Date.now(),subscriptionOptions:e}):r.token;try{yield yJ(n.firebaseDependencies,r.token)}catch(s){console.warn(s)}return SJ(n.firebaseDependencies,e)}return SJ(n.firebaseDependencies,e)}),FL.apply(this,arguments)}function MJ(n){return BL.apply(this,arguments)}function BL(){return BL=A(function*(n){const t=yield CJ(n.firebaseDependencies);t&&(yield yJ(n.firebaseDependencies,t.token),yield jEe(n.firebaseDependencies));const e=yield n.swRegistration.pushManager.getSubscription();return!e||e.unsubscribe()}),BL.apply(this,arguments)}function JEe(n,t){return $L.apply(this,arguments)}function $L(){return $L=A(function*(n,t){try{const e=yield KEe(n.firebaseDependencies,t),r=Object.assign(Object.assign({},t),{token:e,createTime:Date.now()});return yield AL(n.firebaseDependencies,r),e}catch(e){throw yield MJ(n),e}}),$L.apply(this,arguments)}function SJ(n,t){return UL.apply(this,arguments)}function UL(){return UL=A(function*(n,t){const r={token:yield YEe(n,t),createTime:Date.now(),subscriptionOptions:t};return yield AL(n,r),r.token}),UL.apply(this,arguments)}function eMe(n,t){return GL.apply(this,arguments)}function GL(){return GL=A(function*(n,t){return(yield n.pushManager.getSubscription())||n.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:BEe(t)})}),GL.apply(this,arguments)}function tMe(n,t){return t.vapidKey===n.vapidKey&&t.endpoint===n.endpoint&&t.auth===n.auth&&t.p256dh===n.p256dh}function PJ(n){const t={from:n.from,collapseKey:n.collapse_key,messageId:n.fcmMessageId};return function nMe(n,t){if(!t.notification)return;n.notification={};const e=t.notification.title;e&&(n.notification.title=e);const r=t.notification.body;r&&(n.notification.body=r);const s=t.notification.image;s&&(n.notification.image=s);const i=t.notification.icon;i&&(n.notification.icon=i)}(t,n),function rMe(n,t){!t.data||(n.data=t.data)}(t,n),function sMe(n,t){var e,r,s,i,o;if(!(t.fcmOptions||null!==(e=t.notification)&&void 0!==e&&e.click_action))return;n.fcmOptions={};const c=null!==(s=null===(r=t.fcmOptions)||void 0===r?void 0:r.link)&&void 0!==s?s:null===(i=t.notification)||void 0===i?void 0:i.click_action;c&&(n.fcmOptions.link=c);const u=null===(o=t.fcmOptions)||void 0===o?void 0:o.analytics_label;u&&(n.fcmOptions.analyticsLabel=u)}(t,n),t}function iMe(n){return"object"==typeof n&&!!n&&_J in n}function TJ(n,t){const e=[];for(let r=0;r<n.length;r++)e.push(n.charAt(r)),r<t.length&&e.push(t.charAt(r));return e.join("")}function WL(n){return T2.create("missing-app-config-values",{valueName:n})}TJ("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),TJ("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");class aMe{constructor(t,e,r){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const s=function oMe(n){if(!n||!n.options)throw WL("App Configuration Object");if(!n.name)throw WL("App Name");const t=["projectId","apiKey","appId","messagingSenderId"],{options:e}=n;for(const r of t)if(!e[r])throw WL(r);return{appName:n.name,projectId:e.projectId,apiKey:e.apiKey,appId:e.appId,senderId:e.messagingSenderId}}(t);this.firebaseDependencies={app:t,appConfig:s,installations:e,analyticsProvider:r}}_delete(){return Promise.resolve()}}function wJ(n){return qL.apply(this,arguments)}function qL(){return qL=A(function*(n){var t;try{n.swRegistration=yield navigator.serviceWorker.register(REe,{scope:DEe}),n.swRegistration.update().catch(()=>{})}catch(e){throw T2.create("failed-service-worker-registration",{browserErrorMessage:null===(t=e)||void 0===t?void 0:t.message})}}),qL.apply(this,arguments)}function cMe(n,t){return jL.apply(this,arguments)}function jL(){return jL=A(function*(n,t){if(!t&&!n.swRegistration&&(yield wJ(n)),t||!n.swRegistration){if(!(t instanceof ServiceWorkerRegistration))throw T2.create("invalid-sw-registration");n.swRegistration=t}}),jL.apply(this,arguments)}function lMe(n,t){return ZL.apply(this,arguments)}function ZL(){return ZL=A(function*(n,t){t?n.vapidKey=t:n.vapidKey||(n.vapidKey=mJ)}),ZL.apply(this,arguments)}function YL(){return YL=A(function*(n,t){if(!navigator)throw T2.create("only-available-in-window");if("default"===Notification.permission&&(yield Notification.requestPermission()),"granted"!==Notification.permission)throw T2.create("permission-blocked");return yield lMe(n,t?.vapidKey),yield cMe(n,t?.serviceWorkerRegistration),QEe(n)}),YL.apply(this,arguments)}function uMe(n,t,e){return KL.apply(this,arguments)}function KL(){return KL=A(function*(n,t,e){const r=fMe(t);(yield n.firebaseDependencies.analyticsProvider.get()).logEvent(r,{message_id:e[_J],message_name:e[VEe],message_time:e[HEe],message_device_time:Math.floor(Date.now()/1e3)})}),KL.apply(this,arguments)}function fMe(n){switch(n){case i9.NOTIFICATION_CLICKED:return"notification_open";case i9.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}function XL(){return XL=A(function*(n,t){const e=t.data;if(!e.isFirebaseMessaging)return;n.onMessageHandler&&e.messageType===i9.PUSH_RECEIVED&&("function"==typeof n.onMessageHandler?n.onMessageHandler(PJ(e)):n.onMessageHandler.next(PJ(e)));const r=e.data;iMe(r)&&"1"===r[FEe]&&(yield uMe(n,e.messageType,r))}),XL.apply(this,arguments)}const OJ="@firebase/messaging",dMe=n=>{const t=new aMe(n.getProvider("app").getImmediate(),n.getProvider("installations-internal").getImmediate(),n.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",e=>function hMe(n,t){return XL.apply(this,arguments)}(t,e)),t},pMe=n=>{const t=n.getProvider("messaging").getImmediate();return{getToken:r=>function bJ(n,t){return YL.apply(this,arguments)}(t,r)}};function AJ(){return QL.apply(this,arguments)}function QL(){return(QL=A(function*(){try{yield jp()}catch{return!1}return typeof window<"u"&&ku()&&DA()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")})).apply(this,arguments)}!function gMe(){Oo(new X2("messaging",dMe,"PUBLIC")),Oo(new X2("messaging-internal",pMe,"PRIVATE")),fs(OJ,"0.11.0"),fs(OJ,"0.11.0","esm2017")}();const XM="analytics",vMe="firebase_id",EMe="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",IJ="https://www.googletagmanager.com/gtag/js",w2=new yf("@firebase/analytics");function xJ(n){return Promise.all(n.map(t=>t.catch(e=>e)))}function MMe(n,t){const e=document.createElement("script");e.src=`${IJ}?l=${n}&id=${t}`,e.async=!0,document.head.appendChild(e)}function PMe(n,t,e,r,s,i){return tR.apply(this,arguments)}function tR(){return tR=A(function*(n,t,e,r,s,i){const o=r[s];try{if(o)yield t[o];else{const u=(yield xJ(e)).find(h=>h.measurementId===s);u&&(yield t[u.appId])}}catch(c){w2.error(c)}n("config",s,i)}),tR.apply(this,arguments)}function TMe(n,t,e,r,s){return nR.apply(this,arguments)}function nR(){return nR=A(function*(n,t,e,r,s){try{let i=[];if(s&&s.send_to){let o=s.send_to;Array.isArray(o)||(o=[o]);const c=yield xJ(e);for(const u of o){const h=c.find(m=>m.measurementId===u),p=h&&t[h.appId];if(!p){i=[];break}i.push(p)}}0===i.length&&(i=Object.values(t)),yield Promise.all(i),n("event",r,s||{})}catch(i){w2.error(i)}}),nR.apply(this,arguments)}function OMe(n){const t=window.document.getElementsByTagName("script");for(const e of Object.values(t))if(e.src&&e.src.includes(IJ)&&e.src.includes(n))return e;return null}const Wa=new w4("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.'}),kJ=new class xMe{constructor(t={},e=1e3){this.throttleMetadata=t,this.intervalMillis=e}getThrottleMetadata(t){return this.throttleMetadata[t]}setThrottleMetadata(t,e){this.throttleMetadata[t]=e}deleteThrottleMetadata(t){delete this.throttleMetadata[t]}};function kMe(n){return new Headers({Accept:"application/json","x-goog-api-key":n})}function LMe(n){return rR.apply(this,arguments)}function rR(){return rR=A(function*(n){var t;const{appId:e,apiKey:r}=n,s={method:"GET",headers:kMe(r)},i=EMe.replace("{app-id}",e),o=yield fetch(i,s);if(200!==o.status&&304!==o.status){let c="";try{const u=yield o.json();null!==(t=u.error)&&void 0!==t&&t.message&&(c=u.error.message)}catch{}throw Wa.create("config-fetch-failed",{httpStatus:o.status,responseMessage:c})}return o.json()}),rR.apply(this,arguments)}function RMe(n){return sR.apply(this,arguments)}function sR(){return sR=A(function*(n,t=kJ,e){const{appId:r,apiKey:s,measurementId:i}=n.options;if(!r)throw Wa.create("no-app-id");if(!s){if(i)return{measurementId:i,appId:r};throw Wa.create("no-api-key")}const o=t.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},c=new VMe;return setTimeout(A(function*(){c.abort()}),void 0!==e?e:6e4),LJ({appId:r,apiKey:s,measurementId:i},o,c,t)}),sR.apply(this,arguments)}function LJ(n,t,e){return iR.apply(this,arguments)}function iR(){return iR=A(function*(n,{throttleEndTimeMillis:t,backoffCount:e},r,s=kJ){var i,o;const{appId:c,measurementId:u}=n;try{yield DMe(r,t)}catch(h){if(u)return w2.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${u} provided in the "measurementId" field in the local Firebase config. [${null===(i=h)||void 0===i?void 0:i.message}]`),{appId:c,measurementId:u};throw h}try{const h=yield LMe(n);return s.deleteThrottleMetadata(c),h}catch(h){const p=h;if(!zMe(p)){if(s.deleteThrottleMetadata(c),u)return w2.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${u} provided in the "measurementId" field in the local Firebase config. [${p?.message}]`),{appId:c,measurementId:u};throw h}const m=503===Number(null===(o=p?.customData)||void 0===o?void 0:o.httpStatus)?FA(e,s.intervalMillis,30):FA(e,s.intervalMillis),C={throttleEndTimeMillis:Date.now()+m,backoffCount:e+1};return s.setThrottleMetadata(c,C),w2.debug(`Calling attemptFetch again in ${m} millis`),LJ(n,C,r,s)}}),iR.apply(this,arguments)}function DMe(n,t){return new Promise((e,r)=>{const s=Math.max(t-Date.now(),0),i=setTimeout(e,s);n.addEventListener(()=>{clearTimeout(i),r(Wa.create("fetch-throttle",{throttleEndTimeMillis:t}))})})}function zMe(n){if(!(n instanceof Ac&&n.customData))return!1;const t=Number(n.customData.httpStatus);return 429===t||500===t||503===t||504===t}class VMe{constructor(){this.listeners=[]}addEventListener(t){this.listeners.push(t)}abort(){this.listeners.forEach(t=>t())}}let oR,hR;function aR(){return aR=A(function*(n,t,e,r,s){if(s&&s.global)n("event",e,r);else{const i=yield t;n("event",e,Object.assign(Object.assign({},r),{send_to:i}))}}),aR.apply(this,arguments)}function RJ(n){hR=n}function DJ(n){oR=n}function GMe(){return dR.apply(this,arguments)}function dR(){return dR=A(function*(){var n;if(!ku())return w2.warn(Wa.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{yield jp()}catch(t){return w2.warn(Wa.create("indexeddb-unavailable",{errorInfo:null===(n=t)||void 0===n?void 0:n.toString()}).message),!1}return!0}),dR.apply(this,arguments)}function pR(){return pR=A(function*(n,t,e,r,s,i,o){var c;const u=RMe(n);u.then(w=>{e[w.measurementId]=w.appId,n.options.measurementId&&w.measurementId!==n.options.measurementId&&w2.warn(`The measurement ID in the local Firebase config (${n.options.measurementId}) does not match the measurement ID fetched from the server (${w.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(w=>w2.error(w)),t.push(u);const h=GMe().then(w=>{if(w)return r.getId()}),[p,m]=yield Promise.all([u,h]);OMe(i)||MMe(i,p.measurementId),hR&&(s("consent","default",hR),RJ(void 0)),s("js",new Date);const C=null!==(c=o?.config)&&void 0!==c?c:{};return C.origin="firebase",C.update=!0,null!=m&&(C[vMe]=m),s("config",p.measurementId,C),oR&&(s("set",oR),DJ(void 0)),p.measurementId}),pR.apply(this,arguments)}class qMe{constructor(t){this.app=t}_delete(){return delete Kl[this.app.options.appId],Promise.resolve()}}let Kl={},zJ=[];const VJ={};let FJ,Xl,QM="dataLayer",gR=!1;function ZMe(n,t,e){!function jMe(){const n=[];if(RA()&&n.push("This is a browser extension environment."),DA()||n.push("Cookies are not available."),n.length>0){const t=n.map((r,s)=>`(${s+1}) ${r}`).join(" "),e=Wa.create("invalid-analytics-context",{errorInfo:t});w2.warn(e.message)}}();const r=n.options.appId;if(!r)throw Wa.create("no-app-id");if(!n.options.apiKey){if(!n.options.measurementId)throw Wa.create("no-api-key");w2.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${n.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=Kl[r])throw Wa.create("already-exists",{id:r});if(!gR){!function SMe(n){let t=[];Array.isArray(window[n])?t=window[n]:window[n]=t}(QM);const{wrappedGtag:i,gtagCore:o}=function bMe(n,t,e,r,s){let i=function(...o){window[r].push(arguments)};return window[s]&&"function"==typeof window[s]&&(i=window[s]),window[s]=function wMe(n,t,e,r){function i(){return(i=A(function*(o,c,u){try{"event"===o?yield TMe(n,t,e,c,u):"config"===o?yield PMe(n,t,e,r,c,u):"consent"===o?n("consent","update",u):n("set",c)}catch(h){w2.error(h)}})).apply(this,arguments)}return function s(o,c,u){return i.apply(this,arguments)}}(i,n,t,e),{gtagCore:i,wrappedGtag:window[s]}}(Kl,zJ,VJ,QM,"gtag");Xl=i,FJ=o,gR=!0}return Kl[r]=function WMe(n,t,e,r,s,i,o){return pR.apply(this,arguments)}(n,zJ,VJ,t,FJ,QM,e),new qMe(n)}function KMe(){return mR.apply(this,arguments)}function mR(){return(mR=A(function*(){if(RA()||!DA()||!ku())return!1;try{return yield jp()}catch{return!1}})).apply(this,arguments)}const BJ="@firebase/analytics";!function QMe(){Oo(new X2(XM,(t,{options:e})=>ZMe(t.getProvider("app").getImmediate(),t.getProvider("installations-internal").getImmediate(),e),"PUBLIC")),Oo(new X2("analytics-internal",function n(t){try{const e=t.getProvider(XM).getImmediate();return{logEvent:(r,s,i)=>function XMe(n,t,e,r){n=Qr(n),function HMe(n,t,e,r,s){return aR.apply(this,arguments)}(Xl,Kl[n.app.options.appId],t,e,r).catch(s=>w2.error(s))}(e,r,s,i)}}catch(e){throw Wa.create("interop-component-reg-failed",{reason:e})}},"PRIVATE")),fs(BJ,"0.8.4"),fs(BJ,"0.8.4","esm2017")}();class JMe extends Z1{constructor(t,e){super()}schedule(t,e=0){return this}}const JM={setInterval(n,t,...e){const{delegate:r}=JM;return r?.setInterval?r.setInterval(n,t,...e):setInterval(n,t,...e)},clearInterval(n){const{delegate:t}=JM;return(t?.clearInterval||clearInterval)(n)},delegate:void 0};class UJ extends JMe{constructor(t,e){super(t,e),this.scheduler=t,this.work=e,this.pending=!1}schedule(t,e=0){var r;if(this.closed)return this;this.state=t;const s=this.id,i=this.scheduler;return null!=s&&(this.id=this.recycleAsyncId(i,s,e)),this.pending=!0,this.delay=e,this.id=null!==(r=this.id)&&void 0!==r?r:this.requestAsyncId(i,this.id,e),this}requestAsyncId(t,e,r=0){return JM.setInterval(t.flush.bind(t,this),r)}recycleAsyncId(t,e,r=0){if(null!=r&&this.delay===r&&!1===this.pending)return e;null!=e&&JM.clearInterval(e)}execute(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const r=this._execute(t,e);if(r)return r;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(t,e){let s,r=!1;try{this.work(t)}catch(i){r=!0,s=i||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),s}unsubscribe(){if(!this.closed){const{id:t,scheduler:e}=this,{actions:r}=e;this.work=this.state=this.scheduler=null,this.pending=!1,Qc(r,this),null!=t&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null,super.unsubscribe()}}}const _R={now:()=>(_R.delegate||Date).now(),delegate:void 0};class Qg{constructor(t,e=Qg.now){this.schedulerActionCtor=t,this.now=e}schedule(t,e=0,r){return new this.schedulerActionCtor(this,t).schedule(r,e)}}Qg.now=_R.now;class GJ extends Qg{constructor(t,e=Qg.now){super(t,e),this.actions=[],this._active=!1}flush(t){const{actions:e}=this;if(this._active)return void e.push(t);let r;this._active=!0;do{if(r=t.execute(t.state,t.delay))break}while(t=e.shift());if(this._active=!1,r){for(;t=e.shift();)t.unsubscribe();throw r}}}const nSe=new class tSe extends GJ{}(class eSe extends UJ{constructor(t,e){super(t,e),this.scheduler=t,this.work=e}schedule(t,e=0){return e>0?super.schedule(t,e):(this.delay=e,this.state=t,this.scheduler.flush(this),this)}execute(t,e){return e>0||this.closed?super.execute(t,e):this._execute(t,e)}requestAsyncId(t,e,r=0){return null!=r&&r>0||null==r&&this.delay>0?super.requestAsyncId(t,e,r):(t.flush(this),0)}}),rSe=new GJ(UJ),eS=new s0("7.4.1"),vR="__angularfire_symbol__analyticsIsSupportedValue",CR="__angularfire_symbol__analyticsIsSupported",yR="__angularfire_symbol__remoteConfigIsSupportedValue",ER="__angularfire_symbol__remoteConfigIsSupported",MR="__angularfire_symbol__messagingIsSupportedValue",SR="__angularfire_symbol__messagingIsSupported";function TR(n,t,e){if(t){if(1===t.length)return t[0];const i=t.filter(o=>o.app===e);if(1===i.length)return i[0]}return e.container.getProvider(n).getImmediate({optional:!0})}globalThis[CR]||(globalThis[CR]=KMe().then(n=>globalThis[vR]=n).catch(()=>globalThis[vR]=!1)),globalThis[SR]||(globalThis[SR]=AJ().then(n=>globalThis[MR]=n).catch(()=>globalThis[MR]=!1)),globalThis[ER]||(globalThis[ER]=LEe().then(n=>globalThis[yR]=n).catch(()=>globalThis[yR]=!1));const wR=(n,t)=>{const e=t?[t]:bZ(),r=[];return e.forEach(s=>{s.container.getProvider(n).instances.forEach(o=>{r.includes(o)||r.push(o)})}),r};function o9(){}class WJ{constructor(t,e=nSe){this.zone=t,this.delegate=e}now(){return this.delegate.now()}schedule(t,e,r){const s=this.zone;return this.delegate.schedule(function(o){s.runGuarded(()=>{t.apply(this,[o])})},e,r)}}class sSe{constructor(t){this.zone=t,this.task=null}call(t,e){const r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",o9,{},o9,o9)),e.pipe(v2({next:r,complete:r,error:r})).subscribe(t).add(r)}unscheduleTask(){setTimeout(()=>{null!=this.task&&"scheduled"===this.task.state&&(this.task.invoke(),this.task=null)},10)}}let bR=(()=>{class n{constructor(e){this.ngZone=e,this.outsideAngular=e.runOutsideAngular(()=>new WJ(Zone.current)),this.insideAngular=e.run(()=>new WJ(Zone.current,rSe)),globalThis.\u0275AngularFireScheduler||(globalThis.\u0275AngularFireScheduler=this)}}return n.\u0275fac=function(e){return new(e||n)(De(Pr))},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function h5(){const n=globalThis.\u0275AngularFireScheduler;if(!n)throw new Error("Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using\nprovideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).");return n}function iSe(n){return h5().ngZone.runOutsideAngular(()=>n())}function d5(n){return h5().ngZone.run(()=>n())}function oSe(n){return h5(),function aSe(n){return function(e){return(e=e.lift(new sSe(n.ngZone))).pipe(fc(n.outsideAngular),nl(n.insideAngular))}}(h5())(n)}const cSe=(n,t)=>function(){const r=arguments;return t&&setTimeout(()=>{"scheduled"===t.state&&t.invoke()},10),d5(()=>n.apply(void 0,r))},wr=(n,t)=>function(){let e;const r=arguments;for(let i=0;i<arguments.length;i++)"function"==typeof r[i]&&(t&&(e||(e=d5(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",o9,{},o9,o9)))),r[i]=cSe(r[i],e));const s=iSe(()=>n.apply(this,r));if(!t){if(s instanceof Er){const i=h5();return s.pipe(fc(i.outsideAngular),nl(i.insideAngular))}return d5(()=>s)}return s instanceof Er?s.pipe(oSe):s instanceof Promise?d5(()=>new Promise((i,o)=>s.then(c=>d5(()=>i(c)),c=>d5(()=>o(c))))):"function"==typeof s&&e?function(){return setTimeout(()=>{e&&"scheduled"===e.state&&e.invoke()},10),s.apply(this,arguments)}:d5(()=>s)};class a9{constructor(t){return t}}class OR{constructor(){return bZ()}}const NR=new kt("angularfire2._apps"),uSe={provide:a9,useFactory:function lSe(n){return n&&1===n.length?n[0]:new a9(KA())},deps:[[new ui,NR]]},fSe={provide:OR,deps:[[new ui,NR]]};function hSe(n){return(t,e)=>{const r=t.runOutsideAngular(()=>n(e));return new a9(r)}}let dSe=(()=>{class n{constructor(e){fs("angularfire",eS.full,"core"),fs("angularfire",eS.full,"app"),fs("angular",Nv.full,e.toString())}}return n.\u0275fac=function(e){return new(e||n)(De(cp))},n.\u0275mod=oi({type:n}),n.\u0275inj=jr({providers:[uSe,fSe]}),n})();const gSe=wr(wZ,!0),AR=new Map,qJ={activated:!1,tokenObservers:[]},mSe={initialized:!1,enabled:!1};function b2(n){return AR.get(n)||Object.assign({},qJ)}function tS(){return mSe}class MSe{constructor(t,e,r,s,i){if(this.operation=t,this.retryPolicy=e,this.getWaitDuration=r,this.lowerBound=s,this.upperBound=i,this.pending=null,this.nextErrorWaitInterval=s,s>i)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(t){var e=this;return A(function*(){e.stop();try{e.pending=new OE,yield function SSe(n){return new Promise(t=>{setTimeout(t,n)})}(e.getNextRun(t)),e.pending.resolve(),yield e.pending.promise,e.pending=new OE,yield e.operation(),e.pending.resolve(),yield e.pending.promise,e.process(!0).catch(()=>{})}catch(r){e.retryPolicy(r)?e.process(!1).catch(()=>{}):e.stop()}})()}getNextRun(t){if(t)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{const e=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),e}}}const xo=new w4("appCheck","AppCheck",{"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"});function ZJ(n){if(!b2(n).activated)throw xo.create("use-before-activation",{appName:n.name})}function kR(n,t){return LR.apply(this,arguments)}function LR(){return LR=A(function*({url:n,body:t},e){var r,s;const i={"Content-Type":"application/json"},o=e.getImmediate({optional:!0});if(o){const w=yield o.getHeartbeatsHeader();w&&(i["X-Firebase-Client"]=w)}const c={method:"POST",body:JSON.stringify(t),headers:i};let u,h;try{u=yield fetch(n,c)}catch(w){throw xo.create("fetch-network-error",{originalErrorMessage:null===(r=w)||void 0===r?void 0:r.message})}if(200!==u.status)throw xo.create("fetch-status-error",{httpStatus:u.status});try{h=yield u.json()}catch(w){throw xo.create("fetch-parse-error",{originalErrorMessage:null===(s=w)||void 0===s?void 0:s.message})}const p=h.ttl.match(/^([\d.]+)(s)$/);if(!p||!p[2]||isNaN(Number(p[1])))throw xo.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${h.ttl}`});const m=1e3*Number(p[1]),C=Date.now();return{token:h.token,expireTimeMillis:C+m,issuedAtTimeMillis:C}}),LR.apply(this,arguments)}function bSe(n,t){const{projectId:e,appId:r,apiKey:s}=n.options;return{url:`https://content-firebaseappcheck.googleapis.com/v1/projects/${e}/apps/${r}:exchangeDebugToken?key=${s}`,body:{debug_token:t}}}const Jg="firebase-app-check-store";let sS=null;function KJ(){return sS||(sS=new Promise((n,t)=>{var e;try{const r=indexedDB.open("firebase-app-check-database",1);r.onsuccess=s=>{n(s.target.result)},r.onerror=s=>{var i;t(xo.create("storage-open",{originalErrorMessage:null===(i=s.target.error)||void 0===i?void 0:i.message}))},r.onupgradeneeded=s=>{0===s.oldVersion&&s.target.result.createObjectStore(Jg,{keyPath:"compositeKey"})}}catch(r){t(xo.create("storage-open",{originalErrorMessage:null===(e=r)||void 0===e?void 0:e.message}))}}),sS)}function RR(){return RR=A(function*(n,t){const r=(yield KJ()).transaction(Jg,"readwrite"),i=r.objectStore(Jg).put({compositeKey:n,value:t});return new Promise((o,c)=>{i.onsuccess=u=>{o()},r.onerror=u=>{var h;c(xo.create("storage-set",{originalErrorMessage:null===(h=u.target.error)||void 0===h?void 0:h.message}))}})}),RR.apply(this,arguments)}const em=new yf("@firebase/app-check");function VR(n,t){return ku()?function ISe(n,t){return function XJ(n,t){return RR.apply(this,arguments)}(function JJ(n){return`${n.options.appId}-${n.name}`}(n),t)}(n,t).catch(e=>{em.warn(`Failed to write token to IndexedDB. Error: ${e}`)}):Promise.resolve()}function eee(){return tS().enabled}function tee(){return FR.apply(this,arguments)}function FR(){return FR=A(function*(){const n=tS();if(n.enabled&&n.token)return n.token.promise;throw Error("\n            Can't get debug token in production mode.\n        ")}),FR.apply(this,arguments)}const zSe={error:"UNKNOWN_ERROR"};function VSe(n){return LA.encodeString(JSON.stringify(n),!1)}function iS(n){return BR.apply(this,arguments)}function BR(){return BR=A(function*(n,t=!1){const e=n.app;ZJ(e);const r=b2(e);let i,s=r.token;if(s&&!c9(s)&&(r.token=void 0,s=void 0),!s){const u=yield r.cachedTokenPromise;u&&(c9(u)?s=u:yield VR(e,void 0))}if(!t&&s&&c9(s))return{token:s.token};let c,o=!1;if(eee()){r.exchangeTokenPromise||(r.exchangeTokenPromise=kR(bSe(e,yield tee()),n.heartbeatServiceProvider).finally(()=>{r.exchangeTokenPromise=void 0}),o=!0);const u=yield r.exchangeTokenPromise;return yield VR(e,u),r.token=u,{token:u.token}}try{r.exchangeTokenPromise||(r.exchangeTokenPromise=r.provider.getToken().finally(()=>{r.exchangeTokenPromise=void 0}),o=!0),s=yield b2(e).exchangeTokenPromise}catch(u){"appCheck/throttled"===u.code?em.warn(u.message):em.error(u),i=u}return s?i?c=c9(s)?{token:s.token,internalError:i}:see(i):(c={token:s.token},r.token=s,yield VR(e,s)):c=see(i),o&&ree(e,c),c}),BR.apply(this,arguments)}function UR(n,t){const e=b2(n),r=e.tokenObservers.filter(s=>s.next!==t);0===r.length&&e.tokenRefresher&&e.tokenRefresher.isRunning()&&e.tokenRefresher.stop(),e.tokenObservers=r}function nee(n){const{app:t}=n,e=b2(t);let r=e.tokenRefresher;r||(r=function HSe(n){const{app:t}=n;return new MSe(A(function*(){let r;if(r=b2(t).token?yield iS(n,!0):yield iS(n),r.error)throw r.error;if(r.internalError)throw r.internalError}),()=>!0,()=>{const e=b2(t);if(e.token){let r=e.token.issuedAtTimeMillis+.5*(e.token.expireTimeMillis-e.token.issuedAtTimeMillis)+3e5;return r=Math.min(r,e.token.expireTimeMillis-3e5),Math.max(0,r-Date.now())}return 0},3e4,96e4)}(n),e.tokenRefresher=r),!r.isRunning()&&e.isTokenAutoRefreshEnabled&&r.start()}function ree(n,t){const e=b2(n).tokenObservers;for(const r of e)try{"EXTERNAL"===r.type&&null!=t.error?r.error(t.error):r.next(t)}catch{}}function c9(n){return n.expireTimeMillis-Date.now()>0}function see(n){return{token:VSe(zSe),error:n}}class FSe{constructor(t,e){this.app=t,this.heartbeatServiceProvider=e}_delete(){const{tokenObservers:t}=b2(this.app);for(const e of t)UR(this.app,e.next);return Promise.resolve()}}const hee="app-check-internal";!function ePe(){Oo(new X2("app-check",n=>function BSe(n,t){return new FSe(n,t)}(n.getProvider("app").getImmediate(),n.getProvider("heartbeat")),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((n,t,e)=>{n.getProvider(hee).initialize()})),Oo(new X2(hee,n=>function $Se(n){return{getToken:t=>iS(n,t),addTokenListener:t=>function $R(n,t,e,r){const{app:s}=n,i=b2(s);if(i.tokenObservers=[...i.tokenObservers,{next:e,error:r,type:t}],i.token&&c9(i.token)){const c=i.token;Promise.resolve().then(()=>{e({token:c.token}),nee(n)}).catch(()=>{})}i.cachedTokenPromise.then(()=>nee(n))}(n,"INTERNAL",t),removeTokenListener:t=>UR(n.app,t)}}(n.getProvider("app-check").getImmediate()),"PUBLIC").setInstantiationMode("EXPLICIT")),fs("@firebase/app-check","0.5.17")}();class jR{constructor(){return wR("app-check")}}typeof window<"u"&&window;const iPe=function pee(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},gee=new w4("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),mee=new yf("@firebase/auth");function aS(n,...t){mee.logLevel<=g1.ERROR&&mee.error(`Auth (${Mf}): ${n}`,...t)}function fa(n,...t){throw YR(n,...t)}function qa(n,...t){return YR(n,...t)}function _ee(n,t,e){const r=Object.assign(Object.assign({},iPe()),{[t]:e});return new w4("auth","Firebase",r).create(t,{appName:n.name})}function l9(n,t,e){if(!(t instanceof e))throw e.name!==t.constructor.name&&fa(n,"argument-error"),_ee(n,"argument-error",`Type of ${t.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function YR(n,...t){if("string"!=typeof n){const e=t[0],r=[...t.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(e,...r)}return gee.create(n,...t)}function et(n,t,...e){if(!n)throw YR(t,...e)}function L4(n){const t="INTERNAL ASSERTION FAILED: "+n;throw aS(t),new Error(t)}function Ql(n,t){n||L4(t)}const vee=new Map;function Jl(n){Ql(n instanceof Function,"Expected a class definition");let t=vee.get(n);return t?(Ql(t instanceof n,"Instance stored in cache mismatched with class"),t):(t=new n,vee.set(n,t),t)}function tm(){var n;return typeof self<"u"&&(null===(n=self.location)||void 0===n?void 0:n.href)||""}function Cee(){var n;return typeof self<"u"&&(null===(n=self.location)||void 0===n?void 0:n.protocol)||null}class nm{constructor(t,e){this.shortDelay=t,this.longDelay=e,Ql(e>t,"Short delay should be less than long delay!"),this.isMobile=function ape(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(zi())}()||function lpe(){return"object"==typeof navigator&&"ReactNative"===navigator.product}()}get(){return function cPe(){return!(typeof navigator<"u"&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(function KR(){return"http:"===Cee()||"https:"===Cee()}()||RA()||"connection"in navigator))||navigator.onLine}()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function XR(n,t){Ql(n.emulator,"Emulator should always be set here");const{url:e}=n.emulator;return t?`${e}${t.startsWith("/")?t.slice(1):t}`:e}class yee{static initialize(t,e,r){this.fetchImpl=t,e&&(this.headersImpl=e),r&&(this.responseImpl=r)}static fetch(){return this.fetchImpl?this.fetchImpl:typeof self<"u"&&"fetch"in self?self.fetch:void L4("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:typeof self<"u"&&"Headers"in self?self.Headers:void L4("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:typeof self<"u"&&"Response"in self?self.Response:void L4("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const uPe={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error"},fPe=new nm(3e4,6e4);function _i(n,t){return n.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:n.tenantId}):t}function Ui(n,t,e,r){return QR.apply(this,arguments)}function QR(){return QR=A(function*(n,t,e,r,s={}){return Eee(n,s,A(function*(){let i={},o={};r&&("GET"===t?o=r:i={body:JSON.stringify(r)});const c=Zp(Object.assign({key:n.config.apiKey},o)).slice(1),u=yield n._getAdditionalHeaders();return u["Content-Type"]="application/json",n.languageCode&&(u["X-Firebase-Locale"]=n.languageCode),yee.fetch()(Mee(n,n.config.apiHost,e,c),Object.assign({method:t,headers:u,referrerPolicy:"no-referrer"},i))}))}),QR.apply(this,arguments)}function Eee(n,t,e){return JR.apply(this,arguments)}function JR(){return JR=A(function*(n,t,e){n._canInitEmulator=!1;const r=Object.assign(Object.assign({},uPe),t);try{const s=new hPe(n),i=yield Promise.race([e(),s.promise]);s.clearNetworkTimeout();const o=yield i.json();if("needConfirmation"in o)throw rm(n,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const c=i.ok?o.errorMessage:o.error.message,[u,h]=c.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===u)throw rm(n,"credential-already-in-use",o);if("EMAIL_EXISTS"===u)throw rm(n,"email-already-in-use",o);if("USER_DISABLED"===u)throw rm(n,"user-disabled",o);const p=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw _ee(n,p,h);fa(n,p)}}catch(s){if(s instanceof Ac)throw s;fa(n,"network-request-failed")}}),JR.apply(this,arguments)}function e6(n,t,e,r){return eD.apply(this,arguments)}function eD(){return eD=A(function*(n,t,e,r,s={}){const i=yield Ui(n,t,e,r,s);return"mfaPendingCredential"in i&&fa(n,"multi-factor-auth-required",{_serverResponse:i}),i}),eD.apply(this,arguments)}function Mee(n,t,e,r){const s=`${t}${e}?${r}`;return n.config.emulator?XR(n.config,s):`${n.config.apiScheme}://${s}`}class hPe{constructor(t){this.auth=t,this.timer=null,this.promise=new Promise((e,r)=>{this.timer=setTimeout(()=>r(qa(this.auth,"network-request-failed")),fPe.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function rm(n,t,e){const r={appName:n.name};e.email&&(r.email=e.email),e.phoneNumber&&(r.phoneNumber=e.phoneNumber);const s=qa(n,t,r);return s.customData._tokenResponse=e,s}function tD(){return tD=A(function*(n,t){return Ui(n,"POST","/v1/accounts:delete",t)}),tD.apply(this,arguments)}function gPe(n,t){return rD.apply(this,arguments)}function rD(){return rD=A(function*(n,t){return Ui(n,"POST","/v1/accounts:lookup",t)}),rD.apply(this,arguments)}function sm(n){if(n)try{const t=new Date(Number(n));if(!isNaN(t.getTime()))return t.toUTCString()}catch{}}function sD(){return sD=A(function*(n,t=!1){const e=Qr(n),r=yield e.getIdToken(t),s=cS(r);et(s&&s.exp&&s.auth_time&&s.iat,e.auth,"internal-error");const i="object"==typeof s.firebase?s.firebase:void 0,o=i?.sign_in_provider;return{claims:s,token:r,authTime:sm(iD(s.auth_time)),issuedAtTime:sm(iD(s.iat)),expirationTime:sm(iD(s.exp)),signInProvider:o||null,signInSecondFactor:i?.sign_in_second_factor||null}}),sD.apply(this,arguments)}function iD(n){return 1e3*Number(n)}function cS(n){var t;const[e,r,s]=n.split(".");if(void 0===e||void 0===r||void 0===s)return aS("JWT malformed, contained fewer than 3 sections"),null;try{const i=bE(r);return i?JSON.parse(i):(aS("Failed to decode base64 JWT payload"),null)}catch(i){return aS("Caught error parsing JWT payload as JSON",null===(t=i)||void 0===t?void 0:t.toString()),null}}function t6(n,t){return oD.apply(this,arguments)}function oD(){return oD=A(function*(n,t,e=!1){if(e)return t;try{return yield t}catch(r){throw r instanceof Ac&&vPe(r)&&n.auth.currentUser===n&&(yield n.auth.signOut()),r}}),oD.apply(this,arguments)}function vPe({code:n}){return"auth/user-disabled"===n||"auth/user-token-expired"===n}class CPe{constructor(t){this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){!this.isRunning||(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(t){var e;if(t){const r=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),r}{this.errorBackoff=3e4;const s=(null!==(e=this.user.stsTokenManager.expirationTime)&&void 0!==e?e:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(t=!1){var e=this;if(!this.isRunning)return;const r=this.getInterval(t);this.timerId=setTimeout(A(function*(){yield e.iteration()}),r)}iteration(){var t=this;return A(function*(){var e;try{yield t.user.getIdToken(!0)}catch(r){return void("auth/network-request-failed"===(null===(e=r)||void 0===e?void 0:e.code)&&t.schedule(!0))}t.schedule()})()}}class See{constructor(t,e){this.createdAt=t,this.lastLoginAt=e,this._initializeTime()}_initializeTime(){this.lastSignInTime=sm(this.lastLoginAt),this.creationTime=sm(this.createdAt)}_copy(t){this.createdAt=t.createdAt,this.lastLoginAt=t.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}function im(n){return aD.apply(this,arguments)}function aD(){return aD=A(function*(n){var t;const e=n.auth,r=yield n.getIdToken(),s=yield t6(n,gPe(e,{idToken:r}));et(s?.users.length,e,"internal-error");const i=s.users[0];n._notifyReloadListener(i);const o=null!==(t=i.providerUserInfo)&&void 0!==t&&t.length?MPe(i.providerUserInfo):[],c=EPe(n.providerData,o),p=!!n.isAnonymous&&!(n.email&&i.passwordHash||c?.length),m={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:c,metadata:new See(i.createdAt,i.lastLoginAt),isAnonymous:p};Object.assign(n,m)}),aD.apply(this,arguments)}function cD(){return cD=A(function*(n){const t=Qr(n);yield im(t),yield t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}),cD.apply(this,arguments)}function EPe(n,t){return[...n.filter(r=>!t.some(s=>s.providerId===r.providerId)),...t]}function MPe(n){return n.map(t=>{var{providerId:e}=t,r=R5(t,["providerId"]);return{providerId:e,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}function lD(){return lD=A(function*(n,t){const e=yield Eee(n,{},A(function*(){const r=Zp({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:s,apiKey:i}=n.config,o=Mee(n,s,"/v1/token",`key=${i}`),c=yield n._getAdditionalHeaders();return c["Content-Type"]="application/x-www-form-urlencoded",yee.fetch()(o,{method:"POST",headers:c,body:r})}));return{accessToken:e.access_token,expiresIn:e.expires_in,refreshToken:e.refresh_token}}),lD.apply(this,arguments)}class om{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(t){et(t.idToken,"internal-error"),et(typeof t.idToken<"u","internal-error"),et(typeof t.refreshToken<"u","internal-error");const e="expiresIn"in t&&typeof t.expiresIn<"u"?Number(t.expiresIn):function _Pe(n){const t=cS(n);return et(t,"internal-error"),et(typeof t.exp<"u","internal-error"),et(typeof t.iat<"u","internal-error"),Number(t.exp)-Number(t.iat)}(t.idToken);this.updateTokensAndExpiration(t.idToken,t.refreshToken,e)}getToken(t,e=!1){var r=this;return A(function*(){return et(!r.accessToken||r.refreshToken,t,"user-token-expired"),e||!r.accessToken||r.isExpired?r.refreshToken?(yield r.refresh(t,r.refreshToken),r.accessToken):null:r.accessToken})()}clearRefreshToken(){this.refreshToken=null}refresh(t,e){var r=this;return A(function*(){const{accessToken:s,refreshToken:i,expiresIn:o}=yield function SPe(n,t){return lD.apply(this,arguments)}(t,e);r.updateTokensAndExpiration(s,i,Number(o))})()}updateTokensAndExpiration(t,e,r){this.refreshToken=e||null,this.accessToken=t||null,this.expirationTime=Date.now()+1e3*r}static fromJSON(t,e){const{refreshToken:r,accessToken:s,expirationTime:i}=e,o=new om;return r&&(et("string"==typeof r,"internal-error",{appName:t}),o.refreshToken=r),s&&(et("string"==typeof s,"internal-error",{appName:t}),o.accessToken=s),i&&(et("number"==typeof i,"internal-error",{appName:t}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(t){this.accessToken=t.accessToken,this.refreshToken=t.refreshToken,this.expirationTime=t.expirationTime}_clone(){return Object.assign(new om,this.toJSON())}_performRefresh(){return L4("not implemented")}}function W0(n,t){et("string"==typeof n||typeof n>"u","internal-error",{appName:t})}class p5{constructor(t){var{uid:e,auth:r,stsTokenManager:s}=t,i=R5(t,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new CPe(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new See(i.createdAt||void 0,i.lastLoginAt||void 0)}getIdToken(t){var e=this;return A(function*(){const r=yield t6(e,e.stsTokenManager.getToken(e.auth,t));return et(r,e.auth,"internal-error"),e.accessToken!==r&&(e.accessToken=r,yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)),r})()}getIdTokenResult(t){return function mPe(n){return sD.apply(this,arguments)}(this,t)}reload(){return function yPe(n){return cD.apply(this,arguments)}(this)}_assign(t){this!==t&&(et(this.uid===t.uid,this.auth,"internal-error"),this.displayName=t.displayName,this.photoURL=t.photoURL,this.email=t.email,this.emailVerified=t.emailVerified,this.phoneNumber=t.phoneNumber,this.isAnonymous=t.isAnonymous,this.tenantId=t.tenantId,this.providerData=t.providerData.map(e=>Object.assign({},e)),this.metadata._copy(t.metadata),this.stsTokenManager._assign(t.stsTokenManager))}_clone(t){return new p5(Object.assign(Object.assign({},this),{auth:t,stsTokenManager:this.stsTokenManager._clone()}))}_onReload(t){et(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=t,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(t){this.reloadListener?this.reloadListener(t):this.reloadUserInfo=t}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(t,e=!1){var r=this;return A(function*(){let s=!1;t.idToken&&t.idToken!==r.stsTokenManager.accessToken&&(r.stsTokenManager.updateFromServerResponse(t),s=!0),e&&(yield im(r)),yield r.auth._persistUserIfCurrent(r),s&&r.auth._notifyListenersIfCurrent(r)})()}delete(){var t=this;return A(function*(){const e=yield t.getIdToken();return yield t6(t,function dPe(n,t){return tD.apply(this,arguments)}(t.auth,{idToken:e})),t.stsTokenManager.clearRefreshToken(),t.auth.signOut()})()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(t=>Object.assign({},t)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(t,e){var r,s,i,o,c,u,h,p;const m=null!==(r=e.displayName)&&void 0!==r?r:void 0,C=null!==(s=e.email)&&void 0!==s?s:void 0,w=null!==(i=e.phoneNumber)&&void 0!==i?i:void 0,I=null!==(o=e.photoURL)&&void 0!==o?o:void 0,H=null!==(c=e.tenantId)&&void 0!==c?c:void 0,K=null!==(u=e._redirectEventId)&&void 0!==u?u:void 0,ie=null!==(h=e.createdAt)&&void 0!==h?h:void 0,ye=null!==(p=e.lastLoginAt)&&void 0!==p?p:void 0,{uid:te,emailVerified:ke,isAnonymous:$e,providerData:Xe,stsTokenManager:Ft}=e;et(te&&Ft,t,"internal-error");const D1=om.fromJSON(this.name,Ft);et("string"==typeof te,t,"internal-error"),W0(m,t.name),W0(C,t.name),et("boolean"==typeof ke,t,"internal-error"),et("boolean"==typeof $e,t,"internal-error"),W0(w,t.name),W0(I,t.name),W0(H,t.name),W0(K,t.name),W0(ie,t.name),W0(ye,t.name);const N1=new p5({uid:te,auth:t,email:C,emailVerified:ke,displayName:m,isAnonymous:$e,photoURL:I,phoneNumber:w,tenantId:H,stsTokenManager:D1,createdAt:ie,lastLoginAt:ye});return Xe&&Array.isArray(Xe)&&(N1.providerData=Xe.map(is=>Object.assign({},is))),K&&(N1._redirectEventId=K),N1}static _fromIdTokenResponse(t,e,r=!1){return A(function*(){const s=new om;s.updateFromServerResponse(e);const i=new p5({uid:e.localId,auth:t,stsTokenManager:s,isAnonymous:r});return yield im(i),i})()}}const Pee=(()=>{class n{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return A(function*(){return!0})()}_set(e,r){var s=this;return A(function*(){s.storage[e]=r})()}_get(e){var r=this;return A(function*(){const s=r.storage[e];return void 0===s?null:s})()}_remove(e){var r=this;return A(function*(){delete r.storage[e]})()}_addListener(e,r){}_removeListener(e,r){}}return n.type="NONE",n})();function lS(n,t,e){return`firebase:${n}:${t}:${e}`}class u9{constructor(t,e,r){this.persistence=t,this.auth=e,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=lS(this.userKey,s.apiKey,i),this.fullPersistenceKey=lS("persistence",s.apiKey,i),this.boundEventHandler=e._onStorageEvent.bind(e),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(t){return this.persistence._set(this.fullUserKey,t.toJSON())}getCurrentUser(){var t=this;return A(function*(){const e=yield t.persistence._get(t.fullUserKey);return e?p5._fromJSON(t.auth,e):null})()}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(t){var e=this;return A(function*(){if(e.persistence===t)return;const r=yield e.getCurrentUser();return yield e.removeCurrentUser(),e.persistence=t,r?e.setCurrentUser(r):void 0})()}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(t,e,r="authUser"){return A(function*(){if(!e.length)return new u9(Jl(Pee),t,r);const s=(yield Promise.all(e.map(function(){var h=A(function*(p){if(yield p._isAvailable())return p});return function(p){return h.apply(this,arguments)}}()))).filter(h=>h);let i=s[0]||Jl(Pee);const o=lS(r,t.config.apiKey,t.name);let c=null;for(const h of e)try{const p=yield h._get(o);if(p){const m=p5._fromJSON(t,p);h!==i&&(c=m),i=h;break}}catch{}const u=s.filter(h=>h._shouldAllowMigration);return i._shouldAllowMigration&&u.length?(i=u[0],c&&(yield i._set(o,c.toJSON())),yield Promise.all(e.map(function(){var h=A(function*(p){if(p!==i)try{yield p._remove(o)}catch{}});return function(p){return h.apply(this,arguments)}}())),new u9(i,t,r)):new u9(i,t,r)})()}}function Tee(n){const t=n.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(Oee(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(wee(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(Aee(t))return"Blackberry";if(Iee(t))return"Webos";if(uD(t))return"Safari";if((t.includes("chrome/")||bee(t))&&!t.includes("edge/"))return"Chrome";if(Nee(t))return"Android";{const r=n.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if(2===r?.length)return r[1]}return"Other"}function wee(n=zi()){return/firefox\//i.test(n)}function uD(n=zi()){const t=n.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function bee(n=zi()){return/crios\//i.test(n)}function Oee(n=zi()){return/iemobile/i.test(n)}function Nee(n=zi()){return/android/i.test(n)}function Aee(n=zi()){return/blackberry/i.test(n)}function Iee(n=zi()){return/webos/i.test(n)}function uS(n=zi()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function xee(n=zi()){return uS(n)||Nee(n)||Iee(n)||Aee(n)||/windows phone/i.test(n)||Oee(n)}function kee(n,t=[]){let e;switch(n){case"Browser":e=Tee(zi());break;case"Worker":e=`${Tee(zi())}-${n}`;break;default:e=n}const r=t.length?t.join(","):"FirebaseCore-web";return`${e}/JsCore/${Mf}/${r}`}class bPe{constructor(t){this.auth=t,this.queue=[]}pushCallback(t,e){const r=i=>new Promise((o,c)=>{try{o(t(i))}catch(u){c(u)}});r.onAbort=e,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}runMiddleware(t){var e=this;return A(function*(){var r;if(e.auth.currentUser===t)return;const s=[];try{for(const i of e.queue)yield i(t),i.onAbort&&s.push(i.onAbort)}catch(i){s.reverse();for(const o of s)try{o()}catch{}throw e.auth._errorFactory.create("login-blocked",{originalMessage:null===(r=i)||void 0===r?void 0:r.message})}})()}}class OPe{constructor(t,e,r){this.app=t,this.heartbeatServiceProvider=e,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Lee(this),this.idTokenSubscription=new Lee(this),this.beforeStateQueue=new bPe(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=gee,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=r.sdkClientVersion}_initializeWithPersistence(t,e){var r=this;return e&&(this._popupRedirectResolver=Jl(e)),this._initializationPromise=this.queue(A(function*(){var s,i;if(!r._deleted&&(r.persistenceManager=yield u9.create(r,t),!r._deleted)){if(null!==(s=r._popupRedirectResolver)&&void 0!==s&&s._shouldInitProactively)try{yield r._popupRedirectResolver._initialize(r)}catch{}yield r.initializeCurrentUser(e),r.lastNotifiedUid=(null===(i=r.currentUser)||void 0===i?void 0:i.uid)||null,!r._deleted&&(r._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){var t=this;return A(function*(){if(t._deleted)return;const e=yield t.assertedPersistence.getCurrentUser();if(t.currentUser||e){if(t.currentUser&&e&&t.currentUser.uid===e.uid)return t._currentUser._assign(e),void(yield t.currentUser.getIdToken());yield t._updateCurrentUser(e,!0)}})()}initializeCurrentUser(t){var e=this;return A(function*(){var r;const s=yield e.assertedPersistence.getCurrentUser();let i=s,o=!1;if(t&&e.config.authDomain){yield e.getOrInitRedirectPersistenceManager();const c=null===(r=e.redirectUser)||void 0===r?void 0:r._redirectEventId,u=i?._redirectEventId,h=yield e.tryRedirectSignIn(t);(!c||c===u)&&h?.user&&(i=h.user,o=!0)}if(!i)return e.directlySetCurrentUser(null);if(!i._redirectEventId){if(o)try{yield e.beforeStateQueue.runMiddleware(i)}catch(c){i=s,e._popupRedirectResolver._overrideRedirectResult(e,()=>Promise.reject(c))}return i?e.reloadAndSetCurrentUserOrClear(i):e.directlySetCurrentUser(null)}return et(e._popupRedirectResolver,e,"argument-error"),yield e.getOrInitRedirectPersistenceManager(),e.redirectUser&&e.redirectUser._redirectEventId===i._redirectEventId?e.directlySetCurrentUser(i):e.reloadAndSetCurrentUserOrClear(i)})()}tryRedirectSignIn(t){var e=this;return A(function*(){let r=null;try{r=yield e._popupRedirectResolver._completeRedirectFn(e,t,!0)}catch{yield e._setRedirectUser(null)}return r})()}reloadAndSetCurrentUserOrClear(t){var e=this;return A(function*(){var r;try{yield im(t)}catch(s){if("auth/network-request-failed"!==(null===(r=s)||void 0===r?void 0:r.code))return e.directlySetCurrentUser(null)}return e.directlySetCurrentUser(t)})()}useDeviceLanguage(){this.languageCode=function lPe(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}()}_delete(){var t=this;return A(function*(){t._deleted=!0})()}updateCurrentUser(t){var e=this;return A(function*(){const r=t?Qr(t):null;return r&&et(r.auth.config.apiKey===e.config.apiKey,e,"invalid-user-token"),e._updateCurrentUser(r&&r._clone(e))})()}_updateCurrentUser(t,e=!1){var r=this;return A(function*(){if(!r._deleted)return t&&et(r.tenantId===t.tenantId,r,"tenant-id-mismatch"),e||(yield r.beforeStateQueue.runMiddleware(t)),r.queue(A(function*(){yield r.directlySetCurrentUser(t),r.notifyAuthListeners()}))})()}signOut(){var t=this;return A(function*(){return yield t.beforeStateQueue.runMiddleware(null),(t.redirectPersistenceManager||t._popupRedirectResolver)&&(yield t._setRedirectUser(null)),t._updateCurrentUser(null,!0)})()}setPersistence(t){var e=this;return this.queue(A(function*(){yield e.assertedPersistence.setPersistence(Jl(t))}))}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(t){this._errorFactory=new w4("auth","Firebase",t())}onAuthStateChanged(t,e,r){return this.registerStateListener(this.authStateSubscription,t,e,r)}beforeAuthStateChanged(t,e){return this.beforeStateQueue.pushCallback(t,e)}onIdTokenChanged(t,e,r){return this.registerStateListener(this.idTokenSubscription,t,e,r)}toJSON(){var t;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(t=this._currentUser)||void 0===t?void 0:t.toJSON()}}_setRedirectUser(t,e){var r=this;return A(function*(){const s=yield r.getOrInitRedirectPersistenceManager(e);return null===t?s.removeCurrentUser():s.setCurrentUser(t)})()}getOrInitRedirectPersistenceManager(t){var e=this;return A(function*(){if(!e.redirectPersistenceManager){const r=t&&Jl(t)||e._popupRedirectResolver;et(r,e,"argument-error"),e.redirectPersistenceManager=yield u9.create(e,[Jl(r._redirectPersistence)],"redirectUser"),e.redirectUser=yield e.redirectPersistenceManager.getCurrentUser()}return e.redirectPersistenceManager})()}_redirectUserForId(t){var e=this;return A(function*(){var r,s;return e._isInitialized&&(yield e.queue(A(function*(){}))),(null===(r=e._currentUser)||void 0===r?void 0:r._redirectEventId)===t?e._currentUser:(null===(s=e.redirectUser)||void 0===s?void 0:s._redirectEventId)===t?e.redirectUser:null})()}_persistUserIfCurrent(t){var e=this;return A(function*(){if(t===e.currentUser)return e.queue(A(function*(){return e.directlySetCurrentUser(t)}))})()}_notifyListenersIfCurrent(t){t===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t,e;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=null!==(e=null===(t=this.currentUser)||void 0===t?void 0:t.uid)&&void 0!==e?e:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(t,e,r,s){if(this._deleted)return()=>{};const i="function"==typeof e?e:e.next.bind(e),o=this._isInitialized?Promise.resolve():this._initializationPromise;return et(o,this,"internal-error"),o.then(()=>i(this.currentUser)),"function"==typeof e?t.addObserver(e,r,s):t.addObserver(e)}directlySetCurrentUser(t){var e=this;return A(function*(){e.currentUser&&e.currentUser!==t&&e._currentUser._stopProactiveRefresh(),t&&e.isProactiveRefreshEnabled&&t._startProactiveRefresh(),e.currentUser=t,t?yield e.assertedPersistence.setCurrentUser(t):yield e.assertedPersistence.removeCurrentUser()})()}queue(t){return this.operations=this.operations.then(t,t),this.operations}get assertedPersistence(){return et(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(t){!t||this.frameworks.includes(t)||(this.frameworks.push(t),this.frameworks.sort(),this.clientVersion=kee(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){var t=this;return A(function*(){var e;const r={"X-Client-Version":t.clientVersion};t.app.options.appId&&(r["X-Firebase-gmpid"]=t.app.options.appId);const s=yield null===(e=t.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader();return s&&(r["X-Firebase-Client"]=s),r})()}}function ha(n){return Qr(n)}class Lee{constructor(t){this.auth=t,this.observer=null,this.addObserver=function Mpe(n,t){const e=new Spe(n,t);return e.subscribe.bind(e)}(e=>this.observer=e)}get next(){return et(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function Ree(n,t,e){const r=ha(n);et(r._canInitEmulator,r,"emulator-config-failed"),et(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");const s=!!e?.disableWarnings,i=Dee(t),{host:o,port:c}=function NPe(n){const t=Dee(n),e=/(\/\/)?([^?#/]+)/.exec(n.substr(t.length));if(!e)return{host:"",port:null};const r=e[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:zee(r.substr(i.length+1))}}{const[i,o]=r.split(":");return{host:i,port:zee(o)}}}(t);r.config.emulator={url:`${i}//${o}${null===c?"":`:${c}`}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:c,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})}),s||function APe(){function n(){const t=document.createElement("p"),e=t.style;t.innerText="Running in emulator mode. Do not use with production credentials.",e.position="fixed",e.width="100%",e.backgroundColor="#ffffff",e.border=".1em solid #000000",e.color="#b50000",e.bottom="0px",e.left="0px",e.margin="0px",e.zIndex="10000",e.textAlign="center",t.classList.add("firebase-emulator-warning"),document.body.appendChild(t)}typeof console<"u"&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",n):n())}()}function Dee(n){const t=n.indexOf(":");return t<0?"":n.substr(0,t+1)}function zee(n){if(!n)return null;const t=Number(n);return isNaN(t)?null:t}class fD{constructor(t,e){this.providerId=t,this.signInMethod=e}toJSON(){return L4("not implemented")}_getIdTokenResponse(t){return L4("not implemented")}_linkToIdToken(t,e){return L4("not implemented")}_getReauthenticationResolver(t){return L4("not implemented")}}function dD(){return dD=A(function*(n,t){return Ui(n,"POST","/v1/accounts:update",t)}),dD.apply(this,arguments)}function gD(){return gD=A(function*(n,t){return e6(n,"POST","/v1/accounts:signInWithPassword",_i(n,t))}),gD.apply(this,arguments)}function fS(n,t){return mD.apply(this,arguments)}function mD(){return mD=A(function*(n,t){return Ui(n,"POST","/v1/accounts:sendOobCode",_i(n,t))}),mD.apply(this,arguments)}function kPe(n,t){return _D.apply(this,arguments)}function _D(){return _D=A(function*(n,t){return fS(n,t)}),_D.apply(this,arguments)}function LPe(n,t){return vD.apply(this,arguments)}function vD(){return vD=A(function*(n,t){return fS(n,t)}),vD.apply(this,arguments)}function ED(){return ED=A(function*(n,t){return e6(n,"POST","/v1/accounts:signInWithEmailLink",_i(n,t))}),ED.apply(this,arguments)}function MD(){return MD=A(function*(n,t){return e6(n,"POST","/v1/accounts:signInWithEmailLink",_i(n,t))}),MD.apply(this,arguments)}class am extends fD{constructor(t,e,r,s=null){super("password",r),this._email=t,this._password=e,this._tenantId=s}static _fromEmailAndPassword(t,e){return new am(t,e,"password")}static _fromEmailAndCode(t,e,r=null){return new am(t,e,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(t){const e="string"==typeof t?JSON.parse(t):t;if(e?.email&&e?.password){if("password"===e.signInMethod)return this._fromEmailAndPassword(e.email,e.password);if("emailLink"===e.signInMethod)return this._fromEmailAndCode(e.email,e.password,e.tenantId)}return null}_getIdTokenResponse(t){var e=this;return A(function*(){switch(e.signInMethod){case"password":return function xPe(n,t){return gD.apply(this,arguments)}(t,{returnSecureToken:!0,email:e._email,password:e._password});case"emailLink":return function zPe(n,t){return ED.apply(this,arguments)}(t,{email:e._email,oobCode:e._password});default:fa(t,"internal-error")}})()}_linkToIdToken(t,e){var r=this;return A(function*(){switch(r.signInMethod){case"password":return function Hee(n,t){return dD.apply(this,arguments)}(t,{idToken:e,returnSecureToken:!0,email:r._email,password:r._password});case"emailLink":return function VPe(n,t){return MD.apply(this,arguments)}(t,{idToken:e,email:r._email,oobCode:r._password});default:fa(t,"internal-error")}})()}_getReauthenticationResolver(t){return this._getIdTokenResponse(t)}}function n6(n,t){return SD.apply(this,arguments)}function SD(){return SD=A(function*(n,t){return e6(n,"POST","/v1/accounts:signInWithIdp",_i(n,t))}),SD.apply(this,arguments)}class f9 extends fD{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(t){const e=new f9(t.providerId,t.signInMethod);return t.idToken||t.accessToken?(t.idToken&&(e.idToken=t.idToken),t.accessToken&&(e.accessToken=t.accessToken),t.nonce&&!t.pendingToken&&(e.nonce=t.nonce),t.pendingToken&&(e.pendingToken=t.pendingToken)):t.oauthToken&&t.oauthTokenSecret?(e.accessToken=t.oauthToken,e.secret=t.oauthTokenSecret):fa("argument-error"),e}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(t){const e="string"==typeof t?JSON.parse(t):t,{providerId:r,signInMethod:s}=e,i=R5(e,["providerId","signInMethod"]);if(!r||!s)return null;const o=new f9(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(t){return n6(t,this.buildRequest())}_linkToIdToken(t,e){const r=this.buildRequest();return r.idToken=e,n6(t,r)}_getReauthenticationResolver(t){const e=this.buildRequest();return e.autoCreate=!1,n6(t,e)}buildRequest(){const t={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)t.pendingToken=this.pendingToken;else{const e={};this.idToken&&(e.id_token=this.idToken),this.accessToken&&(e.access_token=this.accessToken),this.secret&&(e.oauth_token_secret=this.secret),e.providerId=this.providerId,this.nonce&&!this.pendingToken&&(e.nonce=this.nonce),t.postBody=Zp(e)}return t}}class lm{constructor(t){var e,r,s,i,o,c;const u=Yp(Kp(t)),h=null!==(e=u.apiKey)&&void 0!==e?e:null,p=null!==(r=u.oobCode)&&void 0!==r?r:null,m=function WPe(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(s=u.mode)&&void 0!==s?s:null);et(h&&p&&m,"argument-error"),this.apiKey=h,this.operation=m,this.code=p,this.continueUrl=null!==(i=u.continueUrl)&&void 0!==i?i:null,this.languageCode=null!==(o=u.languageCode)&&void 0!==o?o:null,this.tenantId=null!==(c=u.tenantId)&&void 0!==c?c:null}static parseLink(t){const e=function qPe(n){const t=Yp(Kp(n)).link,e=t?Yp(Kp(t)).deep_link_id:null,r=Yp(Kp(n)).deep_link_id;return(r?Yp(Kp(r)).link:null)||r||e||t||n}(t);try{return new lm(e)}catch{return null}}}let Fee=(()=>{class n{constructor(){this.providerId=n.PROVIDER_ID}static credential(e,r){return am._fromEmailAndPassword(e,r)}static credentialWithLink(e,r){const s=lm.parseLink(r);return et(s,"argument-error"),am._fromEmailAndCode(e,s.code,s.tenantId)}}return n.PROVIDER_ID="password",n.EMAIL_PASSWORD_SIGN_IN_METHOD="password",n.EMAIL_LINK_SIGN_IN_METHOD="emailLink",n})();class q0{constructor(t){this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(t){this.defaultLanguageCode=t}setCustomParameters(t){return this.customParameters=t,this}getCustomParameters(){return this.customParameters}}class Bee extends q0{constructor(){super(...arguments),this.scopes=[]}addScope(t){return this.scopes.includes(t)||this.scopes.push(t),this}getScopes(){return[...this.scopes]}}let jPe=(()=>{class n extends Bee{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return f9._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return n.credentialFromTaggedObject(e)}static credentialFromError(e){return n.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:s}=e;if(!r&&!s)return null;try{return n.credential(r,s)}catch{return null}}}return n.GOOGLE_SIGN_IN_METHOD="google.com",n.PROVIDER_ID="google.com",n})();function $ee(n,t){return ND.apply(this,arguments)}function ND(){return ND=A(function*(n,t){return e6(n,"POST","/v1/accounts:signUp",_i(n,t))}),ND.apply(this,arguments)}class Ic{constructor(t){this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}static _fromIdTokenResponse(t,e,r,s=!1){return A(function*(){const i=yield p5._fromIdTokenResponse(t,r,s),o=Uee(r);return new Ic({user:i,providerId:o,_tokenResponse:r,operationType:e})})()}static _forOperation(t,e,r){return A(function*(){yield t._updateTokensIfNecessary(r,!0);const s=Uee(r);return new Ic({user:t,providerId:s,_tokenResponse:r,operationType:e})})()}}function Uee(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class dS extends Ac{constructor(t,e,r,s){var i;super(e.code,e.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,dS.prototype),this.customData={appName:t.name,tenantId:null!==(i=t.tenantId)&&void 0!==i?i:void 0,_serverResponse:e.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(t,e,r,s){return new dS(t,e,r,s)}}function Gee(n,t,e,r){return("reauthenticate"===t?e._getReauthenticationResolver(n):e._getIdTokenResponse(n)).catch(i=>{throw"auth/multi-factor-auth-required"===i.code?dS._fromErrorAndOperation(n,i,t,r):i})}function xD(n,t){return kD.apply(this,arguments)}function kD(){return kD=A(function*(n,t,e=!1){const r=yield t6(n,t._linkToIdToken(n.auth,yield n.getIdToken()),e);return Ic._forOperation(n,"link",r)}),kD.apply(this,arguments)}function RD(){return RD=A(function*(n,t,e=!1){var r;const{auth:s}=n,i="reauthenticate";try{const o=yield t6(n,Gee(s,i,t,n),e);et(o.idToken,s,"internal-error");const c=cS(o.idToken);et(c,s,"internal-error");const{sub:u}=c;return et(n.uid===u,s,"user-mismatch"),Ic._forOperation(n,i,o)}catch(o){throw"auth/user-not-found"===(null===(r=o)||void 0===r?void 0:r.code)&&fa(s,"user-mismatch"),o}}),RD.apply(this,arguments)}function jee(n,t){return DD.apply(this,arguments)}function DD(){return DD=A(function*(n,t,e=!1){const r="signIn",s=yield Gee(n,r,t),i=yield Ic._fromIdTokenResponse(n,r,s);return e||(yield n._updateCurrentUser(i.user)),i}),DD.apply(this,arguments)}function VD(){return VD=A(function*(n,t){return jee(ha(n),t)}),VD.apply(this,arguments)}function gS(n,t,e){var r;et((null===(r=e.url)||void 0===r?void 0:r.length)>0,n,"invalid-continue-uri"),et(typeof e.dynamicLinkDomain>"u"||e.dynamicLinkDomain.length>0,n,"invalid-dynamic-link-domain"),t.continueUrl=e.url,t.dynamicLinkDomain=e.dynamicLinkDomain,t.canHandleCodeInApp=e.handleCodeInApp,e.iOS&&(et(e.iOS.bundleId.length>0,n,"missing-ios-bundle-id"),t.iOSBundleId=e.iOS.bundleId),e.android&&(et(e.android.packageName.length>0,n,"missing-android-pkg-name"),t.androidInstallApp=e.android.installApp,t.androidMinimumVersionCode=e.android.minimumVersion,t.androidPackageName=e.android.packageName)}function JPe(n,t,e){return WD.apply(this,arguments)}function WD(){return WD=A(function*(n,t,e){const r=Qr(n),s={requestType:"PASSWORD_RESET",email:t};e&&gS(r,s,e),yield LPe(r,s)}),WD.apply(this,arguments)}function tTe(n,t,e){return KD.apply(this,arguments)}function KD(){return KD=A(function*(n,t,e){const r=ha(n),s=yield $ee(r,{returnSecureToken:!0,email:t,password:e}),i=yield Ic._fromIdTokenResponse(r,"signIn",s);return yield r._updateCurrentUser(i.user),i}),KD.apply(this,arguments)}function nTe(n,t,e){return function zD(n,t){return VD.apply(this,arguments)}(Qr(n),Fee.credential(t,e))}function sTe(n,t){return tz.apply(this,arguments)}function tz(){return tz=A(function*(n,t){const e=Qr(n),s={requestType:"VERIFY_EMAIL",idToken:yield n.getIdToken()};t&&gS(e.auth,s,t);const{email:i}=yield kPe(e.auth,s);i!==n.email&&(yield n.reload())}),tz.apply(this,arguments)}function iTe(n,t){return rz.apply(this,arguments)}function rz(){return rz=A(function*(n,t){return Ui(n,"POST","/v1/accounts:update",t)}),rz.apply(this,arguments)}function oTe(n,t){return sz.apply(this,arguments)}function sz(){return sz=A(function*(n,{displayName:t,photoURL:e}){if(void 0===t&&void 0===e)return;const r=Qr(n),i={idToken:yield r.getIdToken(),displayName:t,photoUrl:e,returnSecureToken:!0},o=yield t6(r,iTe(r.auth,i));r.displayName=o.displayName||null,r.photoURL=o.photoUrl||null;const c=r.providerData.find(({providerId:u})=>"password"===u);c&&(c.displayName=r.displayName,c.photoURL=r.photoURL),yield r._updateTokensIfNecessary(o)}),sz.apply(this,arguments)}function pTe(n,t,e,r){return Qr(n).onAuthStateChanged(t,e,r)}const mS="__sak";class Yee{constructor(t,e){this.storageRetriever=t,this.type=e}_isAvailable(){try{return this.storage?(this.storage.setItem(mS,"1"),this.storage.removeItem(mS),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(t,e){return this.storage.setItem(t,JSON.stringify(e)),Promise.resolve()}_get(t){const e=this.storage.getItem(t);return Promise.resolve(e?JSON.parse(e):null)}_remove(t){return this.storage.removeItem(t),Promise.resolve()}get storage(){return this.storageRetriever()}}const ETe=(()=>{class n extends Yee{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function vTe(){const n=zi();return uD(n)||uS(n)}()&&function wPe(){try{return!(!window||window===window.top)}catch{return!1}}(),this.fallbackToPolling=xee(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const s=this.storage.getItem(r),i=this.localCache[r];s!==i&&e(r,i,s)}}onStorageEvent(e,r=!1){if(!e.key)return void this.forAllChangedKeys((c,u,h)=>{this.notifyListeners(c,h)});const s=e.key;if(r?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const c=this.storage.getItem(s);if(e.newValue!==c)null!==e.newValue?this.storage.setItem(s,e.newValue):this.storage.removeItem(s);else if(this.localCache[s]===e.newValue&&!r)return}const i=()=>{const c=this.storage.getItem(s);!r&&this.localCache[s]===c||this.notifyListeners(s,c)},o=this.storage.getItem(s);!function TPe(){return function upe(){const n=zi();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}()&&10===document.documentMode}()||o===e.newValue||e.newValue===e.oldValue?i():setTimeout(i,10)}notifyListeners(e,r){this.localCache[e]=r;const s=this.listeners[e];if(s)for(const i of Array.from(s))i(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,s)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:s}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}_set(e,r){var s=()=>super._set,i=this;return A(function*(){yield s().call(i,e,r),i.localCache[e]=JSON.stringify(r)})()}_get(e){var r=()=>super._get,s=this;return A(function*(){const i=yield r().call(s,e);return s.localCache[e]=JSON.stringify(i),i})()}_remove(e){var r=()=>super._remove,s=this;return A(function*(){yield r().call(s,e),delete s.localCache[e]})()}}return n.type="LOCAL",n})(),Kee=(()=>{class n extends Yee{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}return n.type="SESSION",n})();let STe=(()=>{class n{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(i=>i.isListeningto(e));if(r)return r;const s=new n(e);return this.receivers.push(s),s}isListeningto(e){return this.eventTarget===e}handleEvent(e){var r=this;return A(function*(){const s=e,{eventId:i,eventType:o,data:c}=s.data,u=r.handlersMap[o];if(!u?.size)return;s.ports[0].postMessage({status:"ack",eventId:i,eventType:o});const h=Array.from(u).map(function(){var m=A(function*(C){return C(s.origin,c)});return function(C){return m.apply(this,arguments)}}()),p=yield function MTe(n){return Promise.all(n.map(function(){var t=A(function*(e){try{return{fulfilled:!0,value:yield e}}catch(r){return{fulfilled:!1,reason:r}}});return function(e){return t.apply(this,arguments)}}()))}(h);s.ports[0].postMessage({status:"done",eventId:i,eventType:o,response:p})})()}_subscribe(e,r){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||0===this.handlersMap[e].size)&&delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}return n.receivers=[],n})();function _S(n="",t=10){let e="";for(let r=0;r<t;r++)e+=Math.floor(10*Math.random());return n+e}class PTe{constructor(t){this.target=t,this.handlers=new Set}removeMessageHandler(t){t.messageChannel&&(t.messageChannel.port1.removeEventListener("message",t.onMessage),t.messageChannel.port1.close()),this.handlers.delete(t)}_send(t,e,r=50){var s=this;return A(function*(){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let o,c;return new Promise((u,h)=>{const p=_S("",20);i.port1.start();const m=setTimeout(()=>{h(new Error("unsupported_event"))},r);c={messageChannel:i,onMessage(C){const w=C;if(w.data.eventId===p)switch(w.data.status){case"ack":clearTimeout(m),o=setTimeout(()=>{h(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),u(w.data.response);break;default:clearTimeout(m),clearTimeout(o),h(new Error("invalid_response"))}}},s.handlers.add(c),i.port1.addEventListener("message",c.onMessage),s.target.postMessage({eventType:t,eventId:p,data:e},[i.port2])}).finally(()=>{c&&s.removeMessageHandler(c)})})()}}function vi(){return window}function fz(){return typeof vi().WorkerGlobalScope<"u"&&"function"==typeof vi().importScripts}function hz(){return(hz=A(function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})).apply(this,arguments)}const Xee="firebaseLocalStorageDb",vS="firebaseLocalStorage",Qee="fbase_key";class fm{constructor(t){this.request=t}toPromise(){return new Promise((t,e)=>{this.request.addEventListener("success",()=>{t(this.request.result)}),this.request.addEventListener("error",()=>{e(this.request.error)})})}}function CS(n,t){return n.transaction([vS],t?"readwrite":"readonly").objectStore(vS)}function dz(){const n=indexedDB.open(Xee,1);return new Promise((t,e)=>{n.addEventListener("error",()=>{e(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(vS,{keyPath:Qee})}catch(s){e(s)}}),n.addEventListener("success",A(function*(){const r=n.result;r.objectStoreNames.contains(vS)?t(r):(r.close(),yield function ATe(){const n=indexedDB.deleteDatabase(Xee);return new fm(n).toPromise()}(),t(yield dz()))}))})}function Jee(n,t,e){return pz.apply(this,arguments)}function pz(){return pz=A(function*(n,t,e){const r=CS(n,!0).put({[Qee]:t,value:e});return new fm(r).toPromise()}),pz.apply(this,arguments)}function gz(){return gz=A(function*(n,t){const e=CS(n,!1).get(t),r=yield new fm(e).toPromise();return void 0===r?null:r.value}),gz.apply(this,arguments)}function ete(n,t){const e=CS(n,!0).delete(t);return new fm(e).toPromise()}const LTe=(()=>{class n{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){var e=this;return A(function*(){return e.db||(e.db=yield dz()),e.db})()}_withRetries(e){var r=this;return A(function*(){let s=0;for(;;)try{const i=yield r._openDb();return yield e(i)}catch(i){if(s++>3)throw i;r.db&&(r.db.close(),r.db=void 0)}})()}initializeServiceWorkerMessaging(){var e=this;return A(function*(){return fz()?e.initializeReceiver():e.initializeSender()})()}initializeReceiver(){var e=this;return A(function*(){e.receiver=STe._getInstance(function OTe(){return fz()?self:null}()),e.receiver._subscribe("keyChanged",function(){var r=A(function*(s,i){return{keyProcessed:(yield e._poll()).includes(i.key)}});return function(s,i){return r.apply(this,arguments)}}()),e.receiver._subscribe("ping",function(){var r=A(function*(s,i){return["keyChanged"]});return function(s,i){return r.apply(this,arguments)}}())})()}initializeSender(){var e=this;return A(function*(){var r,s;if(e.activeServiceWorker=yield function wTe(){return hz.apply(this,arguments)}(),!e.activeServiceWorker)return;e.sender=new PTe(e.activeServiceWorker);const i=yield e.sender._send("ping",{},800);!i||(null===(r=i[0])||void 0===r?void 0:r.fulfilled)&&(null===(s=i[0])||void 0===s?void 0:s.value.includes("keyChanged"))&&(e.serviceWorkerReceiverAvailable=!0)})()}notifyServiceWorker(e){var r=this;return A(function*(){if(r.sender&&r.activeServiceWorker&&function bTe(){var n;return(null===(n=navigator?.serviceWorker)||void 0===n?void 0:n.controller)||null}()===r.activeServiceWorker)try{yield r.sender._send("keyChanged",{key:e},r.serviceWorkerReceiverAvailable?800:50)}catch{}})()}_isAvailable(){return A(function*(){try{if(!indexedDB)return!1;const e=yield dz();return yield Jee(e,mS,"1"),yield ete(e,mS),!0}catch{}return!1})()}_withPendingWrite(e){var r=this;return A(function*(){r.pendingWrites++;try{yield e()}finally{r.pendingWrites--}})()}_set(e,r){var s=this;return A(function*(){return s._withPendingWrite(A(function*(){return yield s._withRetries(i=>Jee(i,e,r)),s.localCache[e]=r,s.notifyServiceWorker(e)}))})()}_get(e){var r=this;return A(function*(){const s=yield r._withRetries(i=>function ITe(n,t){return gz.apply(this,arguments)}(i,e));return r.localCache[e]=s,s})()}_remove(e){var r=this;return A(function*(){return r._withPendingWrite(A(function*(){return yield r._withRetries(s=>ete(s,e)),delete r.localCache[e],r.notifyServiceWorker(e)}))})()}_poll(){var e=this;return A(function*(){const r=yield e._withRetries(o=>{const c=CS(o,!1).getAll();return new fm(c).toPromise()});if(!r)return[];if(0!==e.pendingWrites)return[];const s=[],i=new Set;for(const{fbase_key:o,value:c}of r)i.add(o),JSON.stringify(e.localCache[o])!==JSON.stringify(c)&&(e.notifyListeners(o,c),s.push(o));for(const o of Object.keys(e.localCache))e.localCache[o]&&!i.has(o)&&(e.notifyListeners(o,null),s.push(o));return s})()}notifyListeners(e,r){this.localCache[e]=r;const s=this.listeners[e];if(s)for(const i of Array.from(s))i(r)}startPolling(){var e=this;this.stopPolling(),this.pollTimer=setInterval(A(function*(){return e._poll()}),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}return n.type="LOCAL",n})();function nte(n){return`__${n}${Math.floor(1e6*Math.random())}`}function m5(n,t){return t?Jl(t):(et(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}nte("rcb"),new nm(3e4,6e4);class Tz extends fD{constructor(t){super("custom","custom"),this.params=t}_getIdTokenResponse(t){return n6(t,this._buildIdpRequest())}_linkToIdToken(t,e){return n6(t,this._buildIdpRequest(e))}_getReauthenticationResolver(t){return n6(t,this._buildIdpRequest())}_buildIdpRequest(t){const e={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return t&&(e.idToken=t),e}}function XTe(n){return jee(n.auth,new Tz(n),n.bypassAuthState)}function QTe(n){const{auth:t,user:e}=n;return et(e,t,"internal-error"),function qee(n,t){return RD.apply(this,arguments)}(e,new Tz(n),n.bypassAuthState)}function JTe(n){return wz.apply(this,arguments)}function wz(){return wz=A(function*(n){const{auth:t,user:e}=n;return et(e,t,"internal-error"),xD(e,new Tz(n),n.bypassAuthState)}),wz.apply(this,arguments)}class ste{constructor(t,e,r,s,i=!1){this.auth=t,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(e)?e:[e]}execute(){var t=this;return new Promise(function(){var e=A(function*(r,s){t.pendingPromise={resolve:r,reject:s};try{t.eventManager=yield t.resolver._initialize(t.auth),yield t.onExecution(),t.eventManager.registerConsumer(t)}catch(i){t.reject(i)}});return function(r,s){return e.apply(this,arguments)}}())}onAuthEvent(t){var e=this;return A(function*(){const{urlResponse:r,sessionId:s,postBody:i,tenantId:o,error:c,type:u}=t;if(c)return void e.reject(c);const h={auth:e.auth,requestUri:r,sessionId:s,tenantId:o||void 0,postBody:i||void 0,user:e.user,bypassAuthState:e.bypassAuthState};try{e.resolve(yield e.getIdpTask(u)(h))}catch(p){e.reject(p)}})()}onError(t){this.reject(t)}getIdpTask(t){switch(t){case"signInViaPopup":case"signInViaRedirect":return XTe;case"linkViaPopup":case"linkViaRedirect":return JTe;case"reauthViaPopup":case"reauthViaRedirect":return QTe;default:fa(this.auth,"internal-error")}}resolve(t){Ql(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(t),this.unregisterAndCleanUp()}reject(t){Ql(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(t),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const ewe=new nm(2e3,1e4);function twe(n,t,e){return bz.apply(this,arguments)}function bz(){return bz=A(function*(n,t,e){const r=ha(n);l9(n,t,q0);const s=m5(r,e);return new Az(r,"signInViaPopup",t,s).executeNotNull()}),bz.apply(this,arguments)}let Az=(()=>{class n extends ste{constructor(e,r,s,i,o){super(e,r,i,o),this.provider=s,this.authWindow=null,this.pollId=null,n.currentPopupAction&&n.currentPopupAction.cancel(),n.currentPopupAction=this}executeNotNull(){var e=this;return A(function*(){const r=yield e.execute();return et(r,e.auth,"internal-error"),r})()}onExecution(){var e=this;return A(function*(){Ql(1===e.filter.length,"Popup operations only handle one event");const r=_S();e.authWindow=yield e.resolver._openPopup(e.auth,e.provider,e.filter[0],r),e.authWindow.associatedEvent=r,e.resolver._originValidation(e.auth).catch(s=>{e.reject(s)}),e.resolver._isIframeWebStorageSupported(e.auth,s=>{s||e.reject(qa(e.auth,"web-storage-unsupported"))}),e.pollUserCancellation()})()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(qa(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,n.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,s;this.pollId=null!==(s=null===(r=this.authWindow)||void 0===r?void 0:r.window)&&void 0!==s&&s.closed?window.setTimeout(()=>{this.pollId=null,this.reject(qa(this.auth,"popup-closed-by-user"))},2e3):window.setTimeout(e,ewe.get())};e()}}return n.currentPopupAction=null,n})();const hm=new Map;class rwe extends ste{constructor(t,e,r=!1){super(t,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],e,void 0,r),this.eventId=null}execute(){var t=()=>super.execute,e=this;return A(function*(){let r=hm.get(e.auth._key());if(!r){try{const i=(yield function swe(n,t){return Iz.apply(this,arguments)}(e.resolver,e.auth))?yield t().call(e):null;r=()=>Promise.resolve(i)}catch(s){r=()=>Promise.reject(s)}hm.set(e.auth._key(),r)}return e.bypassAuthState||hm.set(e.auth._key(),()=>Promise.resolve(null)),r()})()}onAuthEvent(t){var e=()=>super.onAuthEvent,r=this;return A(function*(){if("signInViaRedirect"===t.type)return e().call(r,t);if("unknown"!==t.type){if(t.eventId){const s=yield r.auth._redirectUserForId(t.eventId);if(s)return r.user=s,e().call(r,t);r.resolve(null)}}else r.resolve(null)})()}onExecution(){return A(function*(){})()}cleanUp(){}}function Iz(){return Iz=A(function*(n,t){const e=ote(t),r=ite(n);if(!(yield r._isAvailable()))return!1;const s="true"===(yield r._get(e));return yield r._remove(e),s}),Iz.apply(this,arguments)}function iwe(n,t){hm.set(n._key(),t)}function ite(n){return Jl(n._redirectPersistence)}function ote(n){return lS("pendingRedirect",n.config.apiKey,n.name)}function ate(n,t){return Vz.apply(this,arguments)}function Vz(){return Vz=A(function*(n,t,e=!1){const r=ha(n),s=m5(r,t),o=yield new rwe(r,s,e).execute();return o&&!e&&(delete o.user._redirectEventId,yield r._persistUserIfCurrent(o.user),yield r._setRedirectUser(null,t)),o}),Vz.apply(this,arguments)}class uwe{constructor(t){this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(t){this.consumers.add(t),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,t)&&(this.sendToConsumer(this.queuedRedirectEvent,t),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(t){this.consumers.delete(t)}onEvent(t){if(this.hasEventBeenHandled(t))return!1;let e=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(t,r)&&(e=!0,this.sendToConsumer(t,r),this.saveEventToCache(t))}),this.hasHandledPotentialRedirect||!function fwe(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return ute(n);default:return!1}}(t)||(this.hasHandledPotentialRedirect=!0,e||(this.queuedRedirectEvent=t,e=!0)),e}sendToConsumer(t,e){var r;if(t.error&&!ute(t)){const s=(null===(r=t.error.code)||void 0===r?void 0:r.split("auth/")[1])||"internal-error";e.onError(qa(this.auth,s))}else e.onAuthEvent(t)}isEventForConsumer(t,e){const r=null===e.eventId||!!t.eventId&&t.eventId===e.eventId;return e.filter.includes(t.type)&&r}hasEventBeenHandled(t){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(lte(t))}saveEventToCache(t){this.cachedEventUids.add(lte(t)),this.lastProcessedEventTime=Date.now()}}function lte(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(t=>t).join("-")}function ute({type:n,error:t}){return"unknown"===n&&"auth/no-auth-event"===t?.code}function hwe(n){return Fz.apply(this,arguments)}function Fz(){return Fz=A(function*(n,t={}){return Ui(n,"GET","/v1/projects",t)}),Fz.apply(this,arguments)}const dwe=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,pwe=/^https?/;function Bz(){return Bz=A(function*(n){if(n.config.emulator)return;const{authorizedDomains:t}=yield hwe(n);for(const e of t)try{if(mwe(e))return}catch{}fa(n,"unauthorized-domain")}),Bz.apply(this,arguments)}function mwe(n){const t=tm(),{protocol:e,hostname:r}=new URL(t);if(n.startsWith("chrome-extension://")){const o=new URL(n);return""===o.hostname&&""===r?"chrome-extension:"===e&&n.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===e&&o.hostname===r}if(!pwe.test(e))return!1;if(dwe.test(n))return r===n;const s=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}const _we=new nm(3e4,6e4);function fte(){const n=vi().___jsl;if(n?.H)for(const t of Object.keys(n.H))if(n.H[t].r=n.H[t].r||[],n.H[t].L=n.H[t].L||[],n.H[t].r=[...n.H[t].L],n.CP)for(let e=0;e<n.CP.length;e++)n.CP[e]=null}let ES=null;function Cwe(n){return ES=ES||function vwe(n){return new Promise((t,e)=>{var r,s,i;function o(){fte(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{fte(),e(qa(n,"network-request-failed"))},timeout:_we.get()})}if(null!==(s=null===(r=vi().gapi)||void 0===r?void 0:r.iframes)&&void 0!==s&&s.Iframe)t(gapi.iframes.getContext());else{if(null===(i=vi().gapi)||void 0===i||!i.load){const c=nte("iframefcb");return vi()[c]=()=>{gapi.load?o():e(qa(n,"network-request-failed"))},function tte(n){return new Promise((t,e)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=t,r.onerror=s=>{const i=qa("internal-error");i.customData=s,e(i)},r.type="text/javascript",r.charset="UTF-8",function VTe(){var n,t;return null!==(t=null===(n=document.getElementsByTagName("head"))||void 0===n?void 0:n[0])&&void 0!==t?t:document}().appendChild(r)})}(`https://apis.google.com/js/api.js?onload=${c}`).catch(u=>e(u))}o()}}).catch(t=>{throw ES=null,t})}(n),ES}const ywe=new nm(5e3,15e3),Swe={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Pwe=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Twe(n){const t=n.config;et(t.authDomain,n,"auth-domain-config-required");const e=t.emulator?XR(t,"emulator/auth/iframe"):`https://${n.config.authDomain}/__/auth/iframe`,r={apiKey:t.apiKey,appName:n.name,v:Mf},s=Pwe.get(n.config.apiHost);s&&(r.eid=s);const i=n._getFrameworks();return i.length&&(r.fw=i.join(",")),`${e}?${Zp(r).slice(1)}`}function $z(){return $z=A(function*(n){const t=yield Cwe(n),e=vi().gapi;return et(e,n,"internal-error"),t.open({where:document.body,url:Twe(n),messageHandlersFilter:e.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Swe,dontclear:!0},r=>new Promise(function(){var s=A(function*(i,o){yield r.restyle({setHideOnLeave:!1});const c=qa(n,"network-request-failed"),u=vi().setTimeout(()=>{o(c)},ywe.get());function h(){vi().clearTimeout(u),i(r)}r.ping(h).then(h,()=>{o(c)})});return function(i,o){return s.apply(this,arguments)}}()))}),$z.apply(this,arguments)}const bwe={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class hte{constructor(t){this.window=t,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function dte(n,t,e,r,s,i){et(n.config.authDomain,n,"auth-domain-config-required"),et(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:e,redirectUrl:r,v:Mf,eventId:s};if(t instanceof q0){t.setDefaultLanguage(n.languageCode),o.providerId=t.providerId||"",function Epe(n){for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t))return!1;return!0}(t.getCustomParameters())||(o.customParameters=JSON.stringify(t.getCustomParameters()));for(const[u,h]of Object.entries(i||{}))o[u]=h}if(t instanceof Bee){const u=t.getScopes().filter(h=>""!==h);u.length>0&&(o.scopes=u.join(","))}n.tenantId&&(o.tid=n.tenantId);const c=o;for(const u of Object.keys(c))void 0===c[u]&&delete c[u];return`${function Dwe({config:n}){return n.emulator?XR(n,"emulator/auth/handler"):`https://${n.authDomain}/__/auth/handler`}(n)}?${Zp(c).slice(1)}`}const Uz="webStorageSupport",Vwe=class zwe{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Kee,this._completeRedirectFn=ate,this._overrideRedirectResult=iwe}_openPopup(t,e,r,s){var i=this;return A(function*(){var o;Ql(null===(o=i.eventManagers[t._key()])||void 0===o?void 0:o.manager,"_initialize() not called before _openPopup()");const c=dte(t,e,r,tm(),s);return function xwe(n,t,e,r=500,s=600){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let c="";const u=Object.assign(Object.assign({},bwe),{width:r.toString(),height:s.toString(),top:i,left:o}),h=zi().toLowerCase();e&&(c=bee(h)?"_blank":e),wee(h)&&(t=t||"http://localhost",u.scrollbars="yes");const p=Object.entries(u).reduce((C,[w,I])=>`${C}${w}=${I},`,"");if(function PPe(n=zi()){var t;return uS(n)&&!(null===(t=window.navigator)||void 0===t||!t.standalone)}(h)&&"_self"!==c)return function kwe(n,t){const e=document.createElement("a");e.href=n,e.target=t;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),e.dispatchEvent(r)}(t||"",c),new hte(null);const m=window.open(t||"",c,p);et(m,n,"popup-blocked");try{m.focus()}catch{}return new hte(m)}(t,c,_S())})()}_openRedirect(t,e,r,s){var i=this;return A(function*(){return yield i._originValidation(t),function TTe(n){vi().location.href=n}(dte(t,e,r,tm(),s)),new Promise(()=>{})})()}_initialize(t){const e=t._key();if(this.eventManagers[e]){const{manager:s,promise:i}=this.eventManagers[e];return s?Promise.resolve(s):(Ql(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(t);return this.eventManagers[e]={promise:r},r.catch(()=>{delete this.eventManagers[e]}),r}initAndGetManager(t){var e=this;return A(function*(){const r=yield function wwe(n){return $z.apply(this,arguments)}(t),s=new uwe(t);return r.register("authEvent",i=>(et(i?.authEvent,t,"invalid-auth-event"),{status:s.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),e.eventManagers[t._key()]={manager:s},e.iframes[t._key()]=r,s})()}_isIframeWebStorageSupported(t,e){this.iframes[t._key()].send(Uz,{type:Uz},s=>{var i;const o=null===(i=s?.[0])||void 0===i?void 0:i[Uz];void 0!==o&&e(!!o),fa(t,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(t){const e=t._key();return this.originValidationPromises[e]||(this.originValidationPromises[e]=function gwe(n){return Bz.apply(this,arguments)}(t)),this.originValidationPromises[e]}get _shouldInitProactively(){return xee()||uD()||uS()}};var gte="@firebase/auth";class Hwe{constructor(t){this.auth=t,this.internalListeners=new Map}getUid(){var t;return this.assertAuthConfigured(),(null===(t=this.auth.currentUser)||void 0===t?void 0:t.uid)||null}getToken(t){var e=this;return A(function*(){return e.assertAuthConfigured(),yield e.auth._initializationPromise,e.auth.currentUser?{accessToken:yield e.auth.currentUser.getIdToken(t)}:null})()}addAuthTokenListener(t){if(this.assertAuthConfigured(),this.internalListeners.has(t))return;const e=this.auth.onIdTokenChanged(r=>{var s;t((null===(s=r)||void 0===s?void 0:s.stsTokenManager.accessToken)||null)});this.internalListeners.set(t,e),this.updateProactiveRefresh()}removeAuthTokenListener(t){this.assertAuthConfigured();const e=this.internalListeners.get(t);!e||(this.internalListeners.delete(t),e(),this.updateProactiveRefresh())}assertAuthConfigured(){et(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const Uwe=mZ("authIdTokenMaxAge")||300;let _te=null;const Gwe=n=>function(){var t=A(function*(e){const r=e&&(yield e.getIdTokenResult()),s=r&&((new Date).getTime()-Date.parse(r.issuedAtTime))/1e3;if(s&&s>Uwe)return;const i=r?.token;_te!==i&&(_te=i,yield fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))});return function(e){return t.apply(this,arguments)}}();function Wwe(n=KA()){const t=Ef(n,"auth");if(t.isInitialized())return t.getImmediate();const e=function oPe(n,t){const e=Ef(n,"auth");if(e.isInitialized()){const s=e.getImmediate();if(AE(e.getOptions(),t??{}))return s;fa(s,"already-initialized")}return e.initialize({options:t})}(n,{popupRedirectResolver:Vwe,persistence:[LTe,ETe,Kee]}),r=mZ("authTokenSyncURL");if(r){const i=Gwe(r);(function dTe(n,t,e){Qr(n).beforeAuthStateChanged(t,e)})(e,i,()=>i(e.currentUser)),function hTe(n,t,e,r){Qr(n).onIdTokenChanged(t,e,r)}(e,o=>i(o))}const s=gZ("auth");return s&&Ree(e,`http://${s}`),e}!function Bwe(n){Oo(new X2("auth",(t,{options:e})=>{const r=t.getProvider("app").getImmediate(),s=t.getProvider("heartbeat"),{apiKey:i,authDomain:o}=r.options;return((c,u)=>{et(i&&!i.includes(":"),"invalid-api-key",{appName:c.name}),et(!o?.includes(":"),"argument-error",{appName:c.name});const h={apiKey:i,authDomain:o,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:kee(n)},p=new OPe(c,u,h);return function aPe(n,t){const e=t?.persistence||[],r=(Array.isArray(e)?e:[e]).map(Jl);t?.errorMap&&n._updateErrorMap(t.errorMap),n._initializeWithPersistence(r,t?.popupRedirectResolver)}(p,e),p})(r,s)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,e,r)=>{t.getProvider("auth-internal").initialize()})),Oo(new X2("auth-internal",t=>{const e=ha(t.getProvider("auth").getImmediate());return new Hwe(e)},"PRIVATE").setInstantiationMode("EXPLICIT")),fs(gte,"0.20.11",function Fwe(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(n)),fs(gte,"0.20.11","esm2017")}("Browser");class MS{constructor(t){return t}}class Cte{constructor(){return wR("auth")}}const Gz=new kt("angularfire2.auth-instances");function jwe(n){return(t,e)=>{const r=t.runOutsideAngular(()=>n(e));return new MS(r)}}const Zwe={provide:Cte,deps:[[new ui,Gz]]},Ywe={provide:MS,useFactory:function qwe(n,t){const e=TR("auth",n,t);return e&&new MS(e)},deps:[[new ui,Gz],a9]};let Kwe=(()=>{class n{constructor(){fs("angularfire",eS.full,"auth")}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=oi({type:n}),n.\u0275inj=jr({providers:[Ywe,Zwe]}),n})();const Jwe=wr(tTe,!0),ebe=wr(Wwe,!0),tbe=wr(pTe,!0),nbe=wr(sTe,!0),rbe=wr(JPe,!0),sbe=wr(nTe,!0),ibe=wr(twe,!0),obe=wr(oTe,!0);class j0{constructor(t){return t}}const Wz=new kt("angularfire2.firestore-instances");function lbe(n){return(t,e)=>{const r=t.runOutsideAngular(()=>n(e));return new j0(r)}}const ube={provide:class abe{constructor(){return wR("firestore")}},deps:[[new ui,Wz]]},fbe={provide:j0,useFactory:function cbe(n,t){const e=TR("firestore",n,t);return e&&new j0(e)},deps:[[new ui,Wz],a9]};let hbe=(()=>{class n{constructor(){fs("angularfire",eS.full,"fst")}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=oi({type:n}),n.\u0275inj=jr({providers:[fbe,ube]}),n})();const pbe=wr(hye,!0),gbe=wr(OCe,!0),_be=wr(fye,!0),dm=wr(vQ,!0),vbe=wr(aye,!0),Cbe=wr(cye,!0),ybe=wr(GCe,!0),Ebe=wr(sye,!0),Ete=wr(dye,!0),Mbe=wr(rye,!0),SS=wr(JCe,!0),Sbe=wr(lye,!0),Pbe=wr(uye,!0),Tbe=wr(tye,!0);let pm=(()=>{class n{constructor(e,r){this.collectionName=e,this.firestore=r,this.subDAOs={};this.collection=gbe(r,this.collectionName).withConverter({fromFirestore:i=>i.data(),toFirestore:i=>i})}create(e){var r=this;return A(function*(){return X(n.VERBOSE,{called:r.collectionName+".create",newElement:e}),(yield pbe(r.collection,e)).id})()}read(e){var r=this;return A(function*(){X(n.VERBOSE,{called:r.collectionName+".read",id:e});const s=yield vbe(dm(r.collection,e));return s.exists()?P.of(Me.getNonNullable(s.data())):P.empty()})()}exists(e){var r=this;return A(function*(){return X(n.VERBOSE,{called:r.collectionName+".exists",id:e}),(yield r.read(e)).isPresent()})()}update(e,r){var s=this;return A(function*(){return X(n.VERBOSE,{called:s.collectionName+".update",id:e,update:r}),Pbe(dm(s.collection,e),r)})()}delete(e){return X(n.VERBOSE,{called:this.collectionName+".delete",id:e}),_be(dm(this.collection,e))}set(e,r){return X(n.VERBOSE,{called:this.collectionName+".set",id:e,element:r}),Sbe(dm(this.collection,e),r)}subscribeToChanges(e,r){return new Z1(Ete(dm(this.collection,e),s=>{r(P.ofNullable(s.data()))}))}findWhere(e,r,s){var i=this;return A(function*(){const o=i.constructQuery(e,r,s);return(yield Cbe(o)).docs.map(u=>({id:u.id,data:u.data()}))})()}observingWhere(e,r,s){X(n.VERBOSE,{called:this.collectionName+".observingWhere"});const i=this.constructQuery(e,s);return new Z1(Ete(i,o=>{const c=[],u=[],h=[];o.docChanges().forEach(p=>{const m={id:p.doc.id,data:p.doc.data()};switch(p.type){case"added":c.push(m);break;case"modified":u.push(m);break;case"removed":h.push(m)}}),c.length>0&&(X(n.VERBOSE,"firebase gave us "+c.length+" NEW "+this.collectionName),r.onDocumentCreated(c)),u.length>0&&(X(n.VERBOSE,"firebase gave us "+u.length+" MODIFIED "+this.collectionName),r.onDocumentModified(u)),h.length>0&&(X(n.VERBOSE,"firebase gave us "+h.length+" DELETED "+this.collectionName),r.onDocumentDeleted(h))}))}constructQuery(e,r,s){let i=SS(this.collection);null!=r&&(i=SS(i,Mbe(r))),null!=s&&(i=SS(i,Ebe(s)));for(const o of e)i=SS(i,Tbe(o[0],o[1],o[2]));return i}subCollectionDAO(e,r){const s=`${this.collection.path}/${e}/${r}`;if(s in this.subDAOs)return this.subDAOs[s];{const i=new class extends n{constructor(o){super(s,o)}}(this.firestore);return this.subDAOs[s]=i,i}}}return n.VERBOSE=!1,n})(),wbe=(()=>{class n extends pm{constructor(e){super("errors",e)}}return n.\u0275fac=function(e){return new(e||n)(De(j0))},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var bbe=oc(2486);let Pn=(()=>{class n{infoMessage(e){this.message(e,"is-info")}gameMessage(e){this.message(e,"is-warning")}criticalMessage(e){this.message(e,"is-danger")}message(e,r){(0,bbe.toast)({message:e,duration:3e3,position:"top-center",closeOnClick:!0,type:r,dismissible:!0})}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class Os{constructor(t,e,r){this.errorDAO=t,this.router=e,this.messageDisplayer=r,Os.setSingletonInstance(this)}static setSingletonInstance(t){Os.singleton=P.of(t)}static logErrorAndFail(t,e,r){throw Os.logError(t,e,r),new Error(`${t}: ${e} (extra data: ${JSON.stringify(r)})`)}static logError(t,e,r){if(this.singleton.isAbsent())throw new Error(`${t}: ${e} (extra data: ${JSON.stringify(r)})`);return this.singleton.get().logError(t,e,r),G.failure(t+": "+e)}findErrors(t,e,r,s){return this.errorDAO.findWhere(void 0===s?[["component","==",t],["route","==",e],["message","==",r]]:[["component","==",t],["route","==",e],["message","==",r],["data","==",s]])}logError(t,e,r){var s=this;return A(function*(){s.messageDisplayer.criticalMessage($localize`An unexpected error was encountered. We have logged it and will try to fix its cause as soon as possible.`);const i=s.router.url,o=yield s.findErrors(t,i,e,r);if(0===o.length){const c={component:t,route:i,message:e,firstEncounter:G0(),lastEncounter:G0(),occurences:1};null!=r&&(c.data=r),yield s.errorDAO.create(c)}else{const c=o[0].id,u=o[0].data;yield s.errorDAO.update(c,{lastEncounter:G0(),occurences:u.occurences+1})}})()}}Os.singleton=P.empty(),Os.\u0275fac=function(t){return new(t||Os)(De(wbe),De(Zn),De(Pn))},Os.\u0275prov=nt({token:Os,factory:Os.\u0275fac,providedIn:"root"});class Me{static expectToBe(t,e,r){if(t!==e)throw void 0!==r?new Error(r):new Error(`A default switch case did not observe the correct value, expected ${e}, but got ${t} instead.`)}static expectToBeMultiple(t,e){let r=!1;for(const s of e)if(t===s){r=!0;break}if(!1===r)throw new Error(`A default switch case did not observe the correct value, expected a value among ${e}, but got ${t} instead.`)}static getNonNullable(t){if(null==t)throw new Error("Expected value not to be null or undefined, but it was.");return t}static assert(t,e){if(!1===t)throw Os.logError("Assertion failure",e),new Error(`Assertion failure: ${e}`)}static identity(t){return t}}function X(n,t){n&&console.log(t)}let Nbe=(()=>{class n extends pm{constructor(e){super("chats",e),X(n.VERBOSE,"ChatDAO.constructor")}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(De(j0))},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Mte=(()=>{class n{}return n.CANNOT_SEND_MESSAGE=()=>$localize`You're not allowed to send a message here.`,n.FORBIDDEN_MESSAGE=()=>$localize`This message is forbidden.`,n})(),PS=(()=>{class n{constructor(e){this.chatDAO=e,X(n.VERBOSE,"ChatService.constructor")}addMessage(e,r){var s=this;return A(function*(){return s.chatDAO.subCollectionDAO(e,"messages").create(r)})()}getLastMessages(e,r){var s=this;return A(function*(){return s.chatDAO.subCollectionDAO(e,"messages").findWhere([],"postedTime",r)})()}subscribeToMessages(e,r){return this.chatDAO.subCollectionDAO(e,"messages").observingWhere([],r,"postedTime")}deleteChat(e){var r=this;return A(function*(){return X(n.VERBOSE,"ChatService.deleteChat "+e),r.chatDAO.delete(e)})()}createNewChat(e){var r=this;return A(function*(){return r.chatDAO.set(e,{})})()}sendMessage(e,r,s,i){var o=this;return A(function*(){if(!1===o.userCanSendMessage(r.name,e))return G.failure(Mte.CANNOT_SEND_MESSAGE());if(o.isForbiddenMessage(s))return G.failure(Mte.FORBIDDEN_MESSAGE());const c={content:s,sender:r,postedTime:G0(),currentTurn:i};return yield o.addMessage(e,c),G.SUCCESS})()}userCanSendMessage(e,r){return""!==e}isForbiddenMessage(e){return""===e}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(De(Nbe))},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),TS=(()=>{class n extends pm{constructor(e){super(n.COLLECTION_NAME,e),X(n.VERBOSE,"UserDAO.constructor")}}return n.VERBOSE=!1,n.COLLECTION_NAME="users",n.\u0275fac=function(e){return new(e||n)(De(j0))},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),gm=(()=>{class n{constructor(e){this.userDAO=e}usernameIsAvailable(e){var r=this;return A(function*(){return 0===(yield r.userDAO.findWhere([["username","==",e]])).length})()}setUsername(e,r){var s=this;return A(function*(){yield s.userDAO.update(e,{username:r})})()}markAsVerified(e){var r=this;return A(function*(){yield r.userDAO.update(e,{verified:!0})})()}observeUser(e,r){return this.userDAO.subscribeToChanges(e,r)}getUserLastUpdateTime(e){var r=this;return A(function*(){const s=yield r.userDAO.read(e);if(s.isAbsent())return P.empty();{const i=s.get().lastUpdateTime;return ve(null!=i,"should not receive a lastUpdateTime equal to null"),P.of(i)}})()}updatePresenceToken(e){return this.userDAO.update(e,{lastUpdateTime:G0()})}}return n.\u0275fac=function(e){return new(e||n)(De(TS))},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class Ste extends F2{constructor(t=1/0,e=1/0,r=_R){super(),this._bufferSize=t,this._windowTime=e,this._timestampProvider=r,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=e===1/0,this._bufferSize=Math.max(1,t),this._windowTime=Math.max(1,e)}next(t){const{isStopped:e,_buffer:r,_infiniteTimeWindow:s,_timestampProvider:i,_windowTime:o}=this;e||(r.push(t),!s&&r.push(i.now()+o)),this._trimBuffer(),super.next(t)}_subscribe(t){this._throwIfClosed(),this._trimBuffer();const e=this._innerSubscribe(t),{_infiniteTimeWindow:r,_buffer:s}=this,i=s.slice();for(let o=0;o<i.length&&!t.closed;o+=r?1:2)t.next(i[o]);return this._checkFinalizedStatuses(t),e}_trimBuffer(){const{_bufferSize:t,_timestampProvider:e,_buffer:r,_infiniteTimeWindow:s}=this,i=(s?1:2)*t;if(t<1/0&&i<r.length&&r.splice(0,r.length-i),!s){const o=e.now();let c=0;for(let u=1;u<r.length&&r[u]<=o;u+=2)c=u;c&&r.splice(0,c+1)}}}let mm=(()=>{class n{}return n.YOU_ARE_ALREADY_PLAYING=()=>$localize`You are already playing in another game.`,n.YOU_ARE_ALREADY_CREATING=()=>$localize`You are already the creator of another game.`,n.YOU_ARE_ALREADY_CHOSEN_OPPONENT=()=>$localize`You are already the chosen opponent in another game.`,n.YOU_ARE_ALREADY_CANDIDATE=()=>$localize`You are already candidate in another game.`,n.YOU_ARE_ALREADY_OBSERVING=()=>$localize`You are already observing another game.`,n})();class Z0{static createUserWithEmailAndPassword(t,e,r){return Jwe(t,e,r)}static sendEmailVerification(t){return nbe(t)}static sendPasswordResetEmail(t,e){return rbe(t,e)}static signInWithEmailAndPassword(t,e,r){return A(function*(){return(yield sbe(t,e,r)).user})()}static signInWithPopup(t,e){return A(function*(){return(yield ibe(t,e)).user})()}static updateProfile(t,e){return obe(t,e)}}class _5{constructor(t,e,r,s){this.id=t,this.email=e,this.username=r,this.verified=s}isConnected(){return this.email.isPresent()}toMinimalUser(){return{id:this.id,name:this.username.get()}}equals(t){return this.id===t.id&&this.email.equals(t.email)&&this.username.equals(t.username)&&this.verified===t.verified}}_5.NOT_CONNECTED=new _5("",P.empty(),P.empty(),!1);let Ns=(()=>{class n{constructor(e,r,s){var i=this;this.userDAO=e,this.userService=r,this.auth=s,this.user=P.empty(),this.userSubscription=new Z1,X(n.VERBOSE,"ConnectedUserService constructor"),this.userRS=new Ste(1),this.userObs=this.userRS.asObservable(),this.authSubscription=new Z1(tbe(this.auth,function(){var o=A(function*(c){null==c?(X(n.VERBOSE,"User is not connected"),i.userSubscription.unsubscribe(),i.userRS.next(_5.NOT_CONNECTED),i.user=P.empty()):(ve(i.user.isAbsent(),"ConnectedUserService received a double update for an user, this is unexpected"),i.userSubscription=i.userDAO.subscribeToChanges(c.uid,u=>{if(u.isPresent()){const h=u.get(),p=h.username;X(n.VERBOSE,`User ${p} is connected, and the verified status is ${i.emailVerified(c)}`);const m=!0===i.emailVerified(c)&&null!=p;if(!0===m&&!1===h.verified)return i.userService.markAsVerified(c.uid);const C=new _5(c.uid,P.ofNullable(c.email),P.ofNullable(p),m);!1===i.user.equalsValue(C)&&(i.user=P.of(C),i.userRS.next(C))}}))});return function(c){return o.apply(this,arguments)}}()))}emailVerified(e){return e.emailVerified}sendPasswordResetEmail(e){var r=this;return A(function*(){try{return yield Z0.sendPasswordResetEmail(r.auth,e),G.SUCCESS}catch(s){return G.failure(r.mapFirebaseError(s))}})()}doRegister(e,r,s){var i=this;return A(function*(){return X(n.VERBOSE,"ConnectedUserService.doRegister("+r+")"),(yield i.userService.usernameIsAvailable(e))?i.registerAfterUsernameCheck(e,r,s):U.failure($localize`This username is already in use.`)})()}registerAfterUsernameCheck(e,r,s){var i=this;return A(function*(){try{const o=yield Z0.createUserWithEmailAndPassword(i.auth,r,s);yield Z0.signInWithEmailAndPassword(i.auth,r,s);const c=Me.getNonNullable(o.user);return yield i.createUser(c.uid,e),U.success(c)}catch(o){return U.failure(i.mapFirebaseError(o))}})()}mapFirebaseError(e){switch(e.code){case"auth/email-already-in-use":return $localize`This email address is already in use.`;case"auth/invalid-email":return $localize`This email address is invalid.`;case"auth/user-not-found":case"auth/wrong-password":return $localize`You have entered invalid credentials.`;case"auth/invalid-credential":return $localize`The credential is invalid or has expired, please try again.`;case"auth/weak-password":return $localize`Your password is too weak, please use a stronger password.`;case"auth/too-many-requests":return $localize`There has been too many requests from your device. You are temporarily blocked due to unusual activity. Try again later.`;case"auth/popup-closed-by-user":return $localize`You closed the authentication popup without finalizing your log in.`;case"auth/popup-blocked":return $localize`The authentication popup was blocked. Try again after disabling popup blocking.`;default:return Os.logError("ConnectedUserService","Unsupported firebase error",{errorCode:e.code,errorMessage:e.message}),e.message}}sendEmailVerification(){var e=this;return A(function*(){X(n.VERBOSE,"ConnectedUserService.sendEmailVerification()");const r=P.ofNullable(e.auth.currentUser);if(!r.isPresent())return Os.logError("ConnectedUserService","Unlogged users cannot request for email verification");if(e.emailVerified(r.get()))return Os.logError("ConnectedUserService","Verified users should not ask email verification after being verified");try{return yield Z0.sendEmailVerification(r.get()),G.SUCCESS}catch(s){return G.failure(e.mapFirebaseError(s))}})()}doEmailLogin(e,r){var s=this;return A(function*(){X(n.VERBOSE,"ConnectedUserService.doEmailLogin("+e+")");try{return yield Z0.signInWithEmailAndPassword(s.auth,e,r),G.SUCCESS}catch(i){return G.failure(s.mapFirebaseError(i))}})()}createUser(e,r){var s=this;return A(function*(){null==r?yield s.userDAO.set(e,{verified:!1}):yield s.userDAO.set(e,{username:r,verified:!1})})()}doGoogleLogin(){var e=this;return A(function*(){return G.ofFallible(yield e.registerOrLoginWithGoogle())})()}registerOrLoginWithGoogle(){var e=this;return A(function*(){try{const r=new jPe;r.addScope("profile"),r.addScope("email");const s=yield Z0.signInWithPopup(e.auth,r);return!1===(yield e.userDAO.exists(s.uid))&&(yield e.createUser(s.uid)),U.success(s)}catch(r){return U.failure(e.mapFirebaseError(r))}})()}disconnect(){var e=this;return A(function*(){return P.ofNullable(e.auth.currentUser).isPresent()?(yield e.auth.signOut(),G.SUCCESS):G.failure("Cannot disconnect a non-connected user")})()}subscribeToUser(e){return this.userObs.subscribe(e)}setUsername(e){var r=this;return A(function*(){if(""===e)return G.failure($localize`Your username may not be empty.`);try{if(!1===(yield r.userService.usernameIsAvailable(e)))return G.failure($localize`This username is already in use, please select a different one.`);const i=Me.getNonNullable(r.auth.currentUser);return yield Z0.updateProfile(i,{displayName:e}),yield r.userService.setUsername(i.uid,e),yield r.userService.markAsVerified(i.uid),yield r.reloadUser(),G.SUCCESS}catch(s){return G.failure(r.mapFirebaseError(s))}})()}setPicture(e){var r=this;return A(function*(){try{const s=Me.getNonNullable(r.auth.currentUser);return yield Z0.updateProfile(s,{photoURL:e}),G.SUCCESS}catch(s){return G.failure(r.mapFirebaseError(s))}})()}reloadUser(){var e=this;return A(function*(){const r=Me.getNonNullable(e.auth.currentUser);yield r.getIdToken(!0),yield r.reload()})()}sendPresenceToken(){return ve(this.user.isPresent(),"Should not call sendPresenceToken when not connected"),this.userService.updatePresenceToken(this.user.get().id)}ngOnDestroy(){this.userSubscription.unsubscribe(),this.authSubscription.unsubscribe()}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(De(TS),De(gm),De(MS))},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class Dn{constructor(t){this.value=t}}Dn.HARD_DRAW=new Dn(0),Dn.RESIGN=new Dn(1),Dn.ESCAPE=new Dn(2),Dn.VICTORY=new Dn(3),Dn.TIMEOUT=new Dn(4),Dn.UNACHIEVED=new Dn(5),Dn.AGREED_DRAW_BY_ZERO=new Dn(6),Dn.AGREED_DRAW_BY_ONE=new Dn(7);class wS{constructor(t,e){this.id=t,this.data=e}getTurn(){return this.data.turn}isHardDraw(){return this.data.result===Dn.HARD_DRAW.value}isAgreedDraw(){return this.data.result===Dn.AGREED_DRAW_BY_ZERO.value||this.data.result===Dn.AGREED_DRAW_BY_ONE.value}getDrawAccepter(){return this.data.result===Dn.AGREED_DRAW_BY_ZERO.value?this.data.playerZero:(ve(this.data.result===Dn.AGREED_DRAW_BY_ONE.value,"should not access getDrawAccepter when no draw accepted!"),Me.getNonNullable(this.data.playerOne))}isWin(){return this.data.result===Dn.VICTORY.value}isTimeout(){return this.data.result===Dn.TIMEOUT.value}isResign(){return this.data.result===Dn.RESIGN.value}getWinner(){return P.ofNullable(this.data.winner)}getLoser(){return P.ofNullable(this.data.loser)}setWinnerAndLoser(t,e){return new wS(this.id,{...this.data,winner:t,loser:e})}}class Zs{constructor(t){this.value=t}static of(t){switch(t){case"CREATOR":return Zs.CREATOR;case"RANDOM":return Zs.RANDOM;default:return ve("CHOSEN_PLAYER"===t,"Invalid value for FirstPlayer: "+t+"."),Zs.CHOSEN_PLAYER}}}Zs.CREATOR=new Zs("CREATOR"),Zs.RANDOM=new Zs("RANDOM"),Zs.CHOSEN_PLAYER=new Zs("CHOSEN_PLAYER");class br{constructor(t){this.value=t}static of(t){switch(t){case"STANDARD":return br.STANDARD;case"BLITZ":return br.BLITZ;case"CUSTOM":return br.CUSTOM;default:throw new Error("Invalid part type: "+t+".")}}}br.STANDARD=new br("STANDARD"),br.BLITZ=new br("BLITZ"),br.CUSTOM=new br("CUSTOM"),br.NORMAL_MOVE_DURATION=120,br.NORMAL_PART_DURATION=1800,br.BLITZ_MOVE_DURATION=30,br.BLITZ_PART_DURATION=900;class Ys{constructor(t){this.value=t}}Ys.PART_CREATED=new Ys(0),Ys.CONFIG_PROPOSED=new Ys(2),Ys.PART_STARTED=new Ys(3),Ys.PART_FINISHED=new Ys(4);class qz{constructor(){this.value=2}isPlayer(){return!1}toString(){return"PLAYER_NONE"}equals(t){return this===t}}qz.NONE=new qz;class z{constructor(t){this.value=t}static of(t){return 0===t?z.ZERO:(Me.expectToBe(t,1),z.ONE)}static fromTurn(t){return t%2==0?z.ZERO:z.ONE}isPlayer(){return!0}toString(){return this===z.ZERO?"PLAYER_ZERO":(Me.expectToBe(this,z.ONE,"Player should not be something else than Player.ZERO and Player.ONE"),"PLAYER_ONE")}equals(t){return this===t}getScoreModifier(){return 0===this.value?-1:1}getPreVictory(){return this.getVictoryValue()-this.getScoreModifier()}getDefeatValue(){return this===z.ZERO?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER}getVictoryValue(){return this===z.ZERO?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER}getOpponent(){return this===z.ZERO?z.ONE:(Me.expectToBe(this,z.ONE),z.ZERO)}}var pe;z.numberEncoder=Cn.ofN(2,n=>n.value,n=>2===n?pe.NONE:z.of(n)),z.ZERO=new z(0),z.ONE=new z(1),z.PLAYERS=[z.ZERO,z.ONE],function(n){n.ZERO=z.ZERO,n.ONE=z.ONE,n.NONE=qz.NONE}(pe||(pe={}));class Br{static rematchAccepted(t,e){return Pte("RematchAccepted",{typeGame:t,partId:e})}static getPlayer(t){return z.of(Me.getNonNullable(t.data).player)}static getTypeGame(t){return Me.getNonNullable(t.data).typeGame}static getPartId(t){return Me.getNonNullable(t.data).partId}}function Pte(n,t){return{code:n,data:t}}function Y0(n){return t=>Pte(n,{player:t.value})}Br.drawProposed=Y0("DrawProposed"),Br.drawRefused=Y0("DrawRefused"),Br.takeBackAsked=Y0("TakeBackAsked"),Br.takeBackRefused=Y0("TakeBackRefused"),Br.takeBackAccepted=Y0("TakeBackAccepted"),Br.rematchProposed=Y0("RematchProposed"),Br.addTurnTime=Y0("AddTurnTime"),Br.addGlobalTime=Y0("AddGlobalTime");class Tte{static toComparableObjectSet(t){const e=[];return t.forEach(r=>{e.some(s=>s.equals(r))||e.push(r)}),e}static toComparableSet(t){const e=[];return t.forEach(r=>{e.some(s=>Ga(s,r))||e.push(r)}),e}}class Dt{constructor(t){this.values=void 0===t?[]:Tte.toComparableSet(t)}equals(t){if(t.size()!==this.size())return!1;for(const e of this)if(!1===t.contains(e))return!1;return!0}toString(){let t="";for(const e of this)t+=null==e?"null, ":e.toString()+", ";return"["+t.slice(0,-2)+"]"}add(t){return!this.contains(t)&&(this.values.push(t),!0)}remove(t){for(let e=0;e<this.values.length;e++)if(Ga(this.values[e],t))return this.values.splice(e,1),!0;return!1}addAll(t){for(const e of t)this.add(e)}union(t){const e=new Dt(this.toList());return e.addAll(t),e}contains(t){for(const e of this.values)if(Ga(e,t))return!0;return!1}size(){return this.values.length}toList(){const t=[];for(const e of this)t.push(e);return t}getAnyElement(){return this.size()>0?P.of(this.values[0]):P.empty()}isEmpty(){return 0===this.values.length}hasElements(){return!1===this.isEmpty()}map(t){const e=[];for(const r of this.values)e.push(t(r));return new Dt(e)}flatMap(t){const e=new Dt;for(const r of this)e.addAll(t(r));return e}filter(t){const e=new Dt;for(const r of this)t(r)&&e.add(r);return e}findAnyCommonElement(t){for(const e of t)if(this.contains(e))return P.of(e);return P.empty()}intersection(t){const e=new Dt;for(const r of t)this.contains(r)&&e.add(r);return e}[Symbol.iterator](){return this.values.values()}}class Vn{constructor(t=[],e=!1){this.map=t,this.isImmutable=e}static from(t){const e=Object.keys(t),r=new Vn;for(const s of e)r.set(s,t[s]);return r}makeImmutable(){this.isImmutable=!0}get(t){for(const e of this.map)if(Ga(e.key,t))return P.of(e.value);return P.empty()}forEach(t){for(let e=0;e<this.map.length;e++)t(this.getByIndex(e))}getByIndex(t){return this.map[t]}putAll(t){this.checkImmutability("putAll");for(const e of t.map)this.put(e.key,e.value)}checkImmutability(t){if(this.isImmutable)throw new Error("Cannot call "+t+" on immutable map!")}put(t,e){this.checkImmutability("put");for(const r of this.map)if(Ga(r.key,t)){const s=r.value;return r.value=e,P.of(s)}return this.map.push({key:t,value:e}),P.empty()}containsKey(t){return this.map.some(e=>Ga(e.key,t))}size(){return this.map.length}listKeys(){return this.map.map(t=>t.key)}getKeySet(){return new Dt(this.listKeys())}filter(t){const e=new Vn;for(const r of this.map)t(r.key,r.value)&&e.set(r.key,r.value);return e}replace(t,e){if(this.checkImmutability("replace"),this.get(t).isAbsent())throw new Error("No Value to replace for key "+t.toString()+"!");return this.put(t,e),e}set(t,e){if(this.checkImmutability("set"),this.containsKey(t))throw new Error("Key "+t.toString()+" already exist in Map!");this.map.push({key:t,value:e})}delete(t){this.checkImmutability("delete");for(let e=0;e<this.map.length;e++)if(Ga(this.map[e].key,t)){const s=this.map[e].value,i=this.map.slice(0,e),o=this.map.slice(e+1);return this.map=i.concat(o),s}throw new Error('No Value to delete for key "'+t.toString()+'"!')}getCopy(){const t=new this.constructor;for(const e of this.listKeys())t.set(e,this.get(e).get());return t}equals(t){const e=this.getKeySet(),r=t.getKeySet();if(!1===e.equals(r))return!1;for(const s of e){const i=this.get(s).get(),o=t.get(s);if(ve(o.isPresent(),"value is absent in a map even though its key is present!"),!1===Ga(i,o.get()))return!1}return!0}}class h9 extends Vn{reverse(){const t=new h9;for(const e of this.listKeys()){const r=this.get(e).get();if(t.containsKey(r))t.get(r).get().add(e);else{const s=new Dt;s.add(e),t.set(r,s)}}return t}}class Ke{static mapBiArray(t,e){const r=[];let s=0;for(;s<t.length;){r[s]=[];let i=0;for(;i<t[s].length;)r[s][i]=e(t[s][i]),i++;s++}return r}static create3DTable(t,e,r,s){const i=[];for(let o=0;o<t;o++)i.push(Ke.createTable(e,r,s));return i}static createTable(t,e,r){const s=[];for(let i=0;i<e;i++)s.push(Ke.createArray(t,r));return s}static createArray(t,e){const r=[];for(let s=0;s<t;s++)r.push(e);return r}static copyBiArray(t){const e=[];let r=0;for(;r<t.length;)e[r]=Ke.copyImmutableArray(t[r]),r++;return e}static copyImmutableArray(t){const e=[];let r=0;for(;r<t.length;)e[r]=t[r],r++;return e}static sortByDescending(t,e){t.sort((r,s)=>{const i=e(r),o=e(s);return i<o?1:i>o?-1:0})}static compareArray(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(!1===Ga(t[r],e[r]))return!1;return!0}static compareTable(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(!1===Ke.compareArray(t[r],e[r]))return!1;return!0}static isPrefix(t,e){return!(t.length>e.length)&&Ke.compareArray(t,e.slice(0,t.length))}static range(t){const e=[];for(let r=0;r<t;r++)e.push(r);return e}static smallerFirst(t,e){return t-e}}class wte{constructor(){this.content=new Vn}get(t){const e=this.content.get(t.y);return e.isAbsent()?P.empty():e.get().get(t.x)}set(t,e){const r=this.content.get(t.y);let s;r.isPresent()?s=r.get():(s=new Vn,this.content.set(t.y,s)),s.set(t.x,e)}[Symbol.iterator](){const t=[],e=this.content.getKeySet().toList();e.sort(Ke.smallerFirst);for(const r of e){const s=this.content.get(r).get(),i=s.getKeySet().toList();i.sort(Ke.smallerFirst);for(const o of i){const c=s.get(o).get();t.push({x:o,y:r,content:c})}}return t.values()}}let bte=(()=>{class n extends pm{constructor(e){super("parts",e),X(n.VERBOSE,"PartDAO.constructor")}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(De(j0))},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class bS{constructor(t,e,r){this.onDocumentCreated=t,this.onDocumentModified=e,this.onDocumentDeleted=r}}let Abe=(()=>{class n extends pm{constructor(e){super("config-room",e),X(n.VERBOSE,"ConfigRoomDAO.constructor")}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(De(j0))},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),jz=(()=>{class n{constructor(e,r){this.configRoomDAO=e,this.connectedUserService=r,X(n.VERBOSE,"ConfigRoomService.constructor")}addCandidate(e,r){return this.configRoomDAO.subCollectionDAO(e,"candidates").set(r.id,r)}removeCandidate(e,r){return this.configRoomDAO.subCollectionDAO(e,"candidates").delete(r.id)}subscribeToChanges(e,r){return this.configRoomDAO.subscribeToChanges(e,r)}subscribeToCandidates(e,r){let s=[];const i=new bS(c=>{for(const u of c)s.push(u.data);r(s)},c=>{for(const u of c)s=s.map(h=>h.id===u.data.id?u.data:h);r(s)},c=>{for(const u of c)s=s.filter(h=>h.id!==u.data.id);r(s)});return this.configRoomDAO.subCollectionDAO(e,"candidates").observingWhere([],i)}createInitialConfigRoom(e){var r=this;return A(function*(){X(n.VERBOSE,"ConfigRoomService.createInitialConfigRoom("+e+")");const s=r.connectedUserService.user.get().toMinimalUser();return r.configRoomDAO.set(e,{chosenOpponent:null,firstPlayer:Zs.RANDOM.value,partType:br.STANDARD.value,partStatus:Ys.PART_CREATED.value,maximalMoveDuration:br.NORMAL_MOVE_DURATION,totalPartDuration:br.NORMAL_PART_DURATION,creator:s})})()}joinGame(e){var r=this;return A(function*(){X(n.VERBOSE,"ConfigRoomService.joinGame("+e+")");const s=r.connectedUserService.user.get().toMinimalUser(),i=yield r.configRoomDAO.read(e);return i.isAbsent()?G.failure(n.GAME_DOES_NOT_EXIST()):(i.get().creator.id!==s.id&&(yield r.addCandidate(e,s)),G.SUCCESS)})()}cancelJoining(e){var r=this;return A(function*(){X(n.VERBOSE,`ConfigRoomService.cancelJoining(${e})`);const s=r.connectedUserService.user.get().toMinimalUser(),i=yield r.configRoomDAO.read(e);if(!i.isAbsent()){const o=i.get(),c=[r.removeCandidate(e,s)];o.chosenOpponent?.id===s.id&&c.push(r.configRoomDAO.update(e,{chosenOpponent:null,partStatus:Ys.PART_CREATED.value})),yield Promise.all(c)}})()}deleteConfigRoom(e,r){var s=this;return A(function*(){X(n.VERBOSE,`ConfigRoomService.deleteConfigRoom(${e}`),yield Promise.all(r.map(i=>s.removeCandidate(e,i))),yield s.configRoomDAO.delete(e)})()}proposeConfig(e,r,s,i,o,c){var u=this;return A(function*(){return X(n.VERBOSE,{configRoomService_proposeConfig:{configRoomId:e,maximalMoveDuration:i,firstPlayer:o,totalPartDuration:c}}),u.configRoomDAO.update(e,{partStatus:Ys.CONFIG_PROPOSED.value,chosenOpponent:r,partType:s.value,maximalMoveDuration:i,totalPartDuration:c,firstPlayer:o.value})})()}setChosenOpponent(e,r){return X(n.VERBOSE,`ConfigRoomService.setChosenOpponent(${e}, ${r.name})`),this.configRoomDAO.update(e,{chosenOpponent:r})}reviewConfig(e){var r=this;return A(function*(){return X(n.VERBOSE,`ConfigRoomService.reviewConfig(${e})`),r.configRoomDAO.update(e,{partStatus:Ys.PART_CREATED.value})})()}reviewConfigAndRemoveChosenOpponent(e){var r=this;return A(function*(){return X(n.VERBOSE,`ConfigRoomService.reviewConfigAndRemoveChosenOpponent(${e})`),r.configRoomDAO.update(e,{partStatus:Ys.PART_CREATED.value,chosenOpponent:null})})()}acceptConfig(e){return X(n.VERBOSE,`ConfigRoomService.acceptConfig(${e}`),this.configRoomDAO.update(e,{partStatus:Ys.PART_STARTED.value})}createConfigRoom(e,r){var s=this;return A(function*(){return X(n.VERBOSE,`ConfigRoomService.create(${e}`+JSON.stringify(r)+")"),s.configRoomDAO.set(e,r)})()}readConfigRoomById(e){var r=this;return A(function*(){return X(n.VERBOSE,`ConfigRoomService.readConfigRoomById(${e})`),(yield r.configRoomDAO.read(e)).get()})()}}return n.VERBOSE=!1,n.GAME_DOES_NOT_EXIST=()=>$localize`Game does not exist`,n.\u0275fac=function(e){return new(e||n)(De(Abe),De(Ns))},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),OS=(()=>{class n{constructor(e,r,s,i){this.partDAO=e,this.connectedUserService=r,this.configRoomService=s,this.chatService=i,X(n.VERBOSE,"GameService.constructor")}updateAndBumpIndex(e,r,s,i){var o=this;return A(function*(){return i={...i,lastUpdate:{index:s+1,player:r.value}},o.partDAO.update(e,i)})()}getPartValidity(e,r){var s=this;return A(function*(){const i=yield s.partDAO.read(e);return i.isAbsent()?G.failure("NONEXISTENT_PART"):i.get().typeGame===r?G.SUCCESS:G.failure("WRONG_GAME_TYPE")})()}createUnstartedPart(e){X(n.VERBOSE,"GameService.createPart("+e+")");const r=this.connectedUserService.user.get().toMinimalUser();return this.partDAO.create({lastUpdate:{index:0,player:0},typeGame:e,playerZero:r,turn:-1,result:Dn.UNACHIEVED.value,listMoves:[]})}createChat(e){return X(n.VERBOSE,"GameService.createChat("+e+")"),this.chatService.createNewChat(e)}createPartConfigRoomAndChat(e){var r=this;return A(function*(){X(n.VERBOSE,`GameService.createGame(${e})`);const s=yield r.createUnstartedPart(e);return yield r.configRoomService.createInitialConfigRoom(s),yield r.createChat(s),s})()}startGameWithConfig(e,r,s,i){X(n.VERBOSE,"GameService.startGameWithConfig("+e+", "+JSON.stringify(i));const o=this.getStartingConfig(i);return this.updateAndBumpIndex(e,r,s,o)}getStartingConfig(e){let s,i,r=Zs.of(e.firstPlayer);return r===Zs.RANDOM&&(r=Math.random()<.5?Zs.CREATOR:Zs.CHOSEN_PLAYER),r===Zs.CREATOR?(s=e.creator,i=Me.getNonNullable(e.chosenOpponent)):(s=Me.getNonNullable(e.chosenOpponent),i=e.creator),{playerZero:s,playerOne:i,turn:0,beginning:G0(),remainingMsForZero:1e3*e.totalPartDuration,remainingMsForOne:1e3*e.totalPartDuration}}deletePart(e){return X(n.VERBOSE,"GameService.deletePart("+e+")"),this.partDAO.delete(e)}acceptConfig(e,r){var s=this;return A(function*(){return X(n.VERBOSE,{gameService_acceptConfig:{partId:e,configRoom:r}}),yield s.configRoomService.acceptConfig(e),s.startGameWithConfig(e,z.ONE,0,r)})()}subscribeToChanges(e,r){return this.partDAO.subscribeToChanges(e,r)}resign(e,r,s,i,o){return this.updateAndBumpIndex(e,s,r,{winner:i,loser:o,result:Dn.RESIGN.value,request:null})}notifyTimeout(e,r,s,i,o){return this.updateAndBumpIndex(e,r,s,{winner:i,loser:o,result:Dn.TIMEOUT.value,request:null})}sendRequest(e,r,s,i){return this.updateAndBumpIndex(e,r,s,{request:i})}proposeDraw(e,r,s){return this.sendRequest(e,s,r,Br.drawProposed(s))}acceptDraw(e,r,s){return this.updateAndBumpIndex(e,s,r,{result:(s===z.ZERO?Dn.AGREED_DRAW_BY_ZERO:Dn.AGREED_DRAW_BY_ONE).value,request:null})}refuseDraw(e,r,s){return this.sendRequest(e,s,r,Br.drawRefused(s))}proposeRematch(e,r,s){return this.sendRequest(e,s,r,Br.rematchProposed(s))}acceptRematch(e,r,s){var i=this;return A(function*(){X(n.VERBOSE,{called:"GameService.acceptRematch(",partDocument:e});const o=Me.getNonNullable(e.data),c=yield i.configRoomService.readConfigRoomById(e.id);let u;const h=i.connectedUserService.user.get().toMinimalUser();let p;o.playerZero.id===h.id?(p=Me.getNonNullable(o.playerOne),u=Zs.CHOSEN_PLAYER):(p=o.playerZero,u=Zs.CREATOR);const m={...c,firstPlayer:u.value,creator:h,chosenOpponent:p,partStatus:Ys.PART_STARTED.value},C=i.getStartingConfig(m),w={lastUpdate:{index:0,player:s.value},typeGame:o.typeGame,result:Dn.UNACHIEVED.value,listMoves:[],...C},I=yield i.partDAO.create(w);return yield i.configRoomService.createConfigRoom(I,m),yield i.createChat(I),i.sendRequest(e.id,s,r,Br.rematchAccepted(o.typeGame,I))})()}askTakeBack(e,r,s){return this.sendRequest(e,s,r,Br.takeBackAsked(s))}acceptTakeBack(e,r,s,i){var o=this;return A(function*(){ve(Br.getPlayer(Me.getNonNullable(r.data.request))!==s,"Illegal to accept your own request");const u=Br.takeBackAccepted(s);let h=r.data.listMoves.slice(0,r.data.listMoves.length-1);h.length%2===s.value&&(h=h.slice(0,h.length-1));const p={request:u,listMoves:h,turn:h.length,lastUpdateTime:G0(),remainingMsForZero:Me.getNonNullable(r.data.remainingMsForZero)-i[0],remainingMsForOne:Me.getNonNullable(r.data.remainingMsForOne)-i[1]},m=r.data.lastUpdate.index;return yield o.updateAndBumpIndex(e,s,m,p)})()}refuseTakeBack(e,r,s){const i=Br.takeBackRefused(s);return this.updateAndBumpIndex(e,s,r,{request:i})}addGlobalTime(e,r,s,i){var o=this;return A(function*(){let c={request:Br.addGlobalTime(i.getOpponent())};return c=i===z.ZERO?{...c,remainingMsForOne:Me.getNonNullable(s.remainingMsForOne)+3e5}:{...c,remainingMsForZero:Me.getNonNullable(s.remainingMsForZero)+3e5},yield o.updateAndBumpIndex(e,i,r,c)})()}addTurnTime(e,r,s){var i=this;return A(function*(){const o={request:Br.addTurnTime(e.getOpponent())};return yield i.updateAndBumpIndex(s,e,r,o)})()}updateDBBoard(e,r,s,i,o,c,u,h){var p=this;return A(function*(){X(n.VERBOSE,{gameService_updateDBBoard:{partId:e,encodedMove:s,scores:o,msToSubstract:i,notifyDraw:c,winner:u,loser:h}});const m=(yield p.partDAO.read(e)).get(),C=m.lastUpdate.index,w=m.turn+1,I=Ke.copyImmutableArray(m.listMoves);I[I.length]=s;let H={listMoves:I,turn:w,request:null,lastUpdateTime:G0()};return H=p.updateScore(H,o),H=p.substractMs(H,m,i),null!=u?H={...H,winner:u,loser:h,result:Dn.VICTORY.value}:!0===c&&(H={...H,result:Dn.HARD_DRAW.value}),yield p.updateAndBumpIndex(e,r,C,H)})()}updateScore(e,r){return void 0!==r?{...e,scorePlayerZero:r[0],scorePlayerOne:r[1]}:e}substractMs(e,r,s){return s[0]>0?{...e,remainingMsForZero:Me.getNonNullable(r.remainingMsForZero)-s[0]}:s[1]>0?{...e,remainingMsForOne:Me.getNonNullable(r.remainingMsForOne)-s[1]}:e}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(De(bte),De(Ns),De(jz),De(PS))},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var Xte={prefix:"fab",iconName:"facebook",icon:[512,512,[62e3],"f09a","M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"]},rne={prefix:"fab",iconName:"github",icon:[496,512,[],"f09b","M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"]},sne={prefix:"fab",iconName:"twitter",icon:[512,512,[],"f099","M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"]};class _m{static getNavigatorLanguage(){return navigator.language}static getLocale(){const r=(localStorage.getItem("locale")??_m.getNavigatorLanguage()??"fr").slice(0,2).toLowerCase();return["en","fr"].some(s=>s===r)?r:"fr"}}let lne=(()=>{class n{changeTheme(e){localStorage.setItem("theme",e)}getTheme(){return P.ofNullable(localStorage.getItem("theme"))}changeLanguage(e){localStorage.setItem("locale",e.toLowerCase())}getLanguage(){return _m.getLocale()}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),NS=(()=>{class n{constructor(e,r){this.document=e,this.userSettingsService=r,this.availableThemes=["dark","light"];const s=this.getStoredTheme();s.isPresent()?this.loadTheme(s.get()):window.matchMedia("(prefers-color-scheme: dark)").matches?this.loadTheme("dark"):window.matchMedia("(prefers-color-scheme: light)").matches?this.loadTheme("light"):this.loadTheme("dark")}getStoredTheme(){const e=this.userSettingsService.getTheme();if(e.isPresent()){const r=e.get();if(this.availableThemes.some(s=>s===r))return P.of(r)}return P.empty()}loadTheme(e){this.loadStyle(e+".css"),this.theme=e}loadStyle(e){const r=this.document.getElementsByTagName("head")[0],s=this.document.getElementById("theme");if(null!=s)s.href=e;else{const i=this.document.createElement("link");i.id="theme",i.rel="stylesheet",i.href=`${e}`,r.appendChild(i)}}getTheme(){return this.theme}}return n.\u0275fac=function(e){return new(e||n)(De($s),De(lne))},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function une(n,t){var e=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);t&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable})),e.push.apply(e,r)}return e}function St(n){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?arguments[t]:{};t%2?une(Object(e),!0).forEach(function(r){Ci(n,r,e[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):une(Object(e)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(e,r))})}return n}function AS(n){return(AS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(n)}function fne(n,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,r.key,r)}}function Ci(n,t,e){return t in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}function Yz(n,t){return function hDe(n){if(Array.isArray(n))return n}(n)||function pDe(n,t){var e=null==n?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(null!=e){var o,c,r=[],s=!0,i=!1;try{for(e=e.call(n);!(s=(o=e.next()).done)&&(r.push(o.value),!t||r.length!==t);s=!0);}catch(u){i=!0,c=u}finally{try{!s&&null!=e.return&&e.return()}finally{if(i)throw c}}return r}}(n,t)||hne(n,t)||function mDe(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Cm(n){return function fDe(n){if(Array.isArray(n))return Kz(n)}(n)||function dDe(n){if(typeof Symbol<"u"&&null!=n[Symbol.iterator]||null!=n["@@iterator"])return Array.from(n)}(n)||hne(n)||function gDe(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function hne(n,t){if(n){if("string"==typeof n)return Kz(n,t);var e=Object.prototype.toString.call(n).slice(8,-1);if("Object"===e&&n.constructor&&(e=n.constructor.name),"Map"===e||"Set"===e)return Array.from(n);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Kz(n,t)}}function Kz(n,t){(null==t||t>n.length)&&(t=n.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=n[e];return r}var dne=function(){},Xz={},pne={},gne=null,mne={mark:dne,measure:dne};try{typeof window<"u"&&(Xz=window),typeof document<"u"&&(pne=document),typeof MutationObserver<"u"&&(gne=MutationObserver),typeof performance<"u"&&(mne=performance)}catch{}var kS,LS,RS,DS,zS,_ne=(Xz.navigator||{}).userAgent,vne=void 0===_ne?"":_ne,K0=Xz,Or=pne,Cne=gne,xS=mne,r6=!!Or.documentElement&&!!Or.head&&"function"==typeof Or.addEventListener&&"function"==typeof Or.createElement,yne=~vne.indexOf("MSIE")||~vne.indexOf("Trident/"),s6="___FONT_AWESOME___",Mne="svg-inline--fa",v5="data-fa-i2svg",Jz="data-fa-pseudo-element",eV="data-prefix",tV="data-icon",Sne="fontawesome-i2svg",yDe=["HTML","HEAD","STYLE","SCRIPT"],Pne=function(){try{return!0}catch{return!1}}(),Nr="classic",gs="sharp",nV=[Nr,gs];function ym(n){return new Proxy(n,{get:function(e,r){return r in e?e[r]:e[Nr]}})}var Em=ym((Ci(kS={},Nr,{fa:"solid",fas:"solid","fa-solid":"solid",far:"regular","fa-regular":"regular",fal:"light","fa-light":"light",fat:"thin","fa-thin":"thin",fad:"duotone","fa-duotone":"duotone",fab:"brands","fa-brands":"brands",fak:"kit","fa-kit":"kit"}),Ci(kS,gs,{fa:"solid",fass:"solid","fa-solid":"solid"}),kS)),Mm=ym((Ci(LS={},Nr,{solid:"fas",regular:"far",light:"fal",thin:"fat",duotone:"fad",brands:"fab",kit:"fak"}),Ci(LS,gs,{solid:"fass"}),LS)),Sm=ym((Ci(RS={},Nr,{fab:"fa-brands",fad:"fa-duotone",fak:"fa-kit",fal:"fa-light",far:"fa-regular",fas:"fa-solid",fat:"fa-thin"}),Ci(RS,gs,{fass:"fa-solid"}),RS)),EDe=ym((Ci(DS={},Nr,{"fa-brands":"fab","fa-duotone":"fad","fa-kit":"fak","fa-light":"fal","fa-regular":"far","fa-solid":"fas","fa-thin":"fat"}),Ci(DS,gs,{"fa-solid":"fass"}),DS)),MDe=/fa(s|r|l|t|d|b|k|ss)?[\-\ ]/,Tne="fa-layers-text",SDe=/Font ?Awesome ?([56 ]*)(Solid|Regular|Light|Thin|Duotone|Brands|Free|Pro|Sharp|Kit)?.*/i,PDe=ym((Ci(zS={},Nr,{900:"fas",400:"far",normal:"far",300:"fal",100:"fat"}),Ci(zS,gs,{900:"fass"}),zS)),wne=[1,2,3,4,5,6,7,8,9,10],TDe=wne.concat([11,12,13,14,15,16,17,18,19,20]),wDe=["class","data-prefix","data-icon","data-fa-transform","data-fa-mask"],Pm=new Set;Object.keys(Mm[Nr]).map(Pm.add.bind(Pm)),Object.keys(Mm[gs]).map(Pm.add.bind(Pm));var bDe=[].concat(nV,Cm(Pm),["2xs","xs","sm","lg","xl","2xl","beat","border","fade","beat-fade","bounce","flip-both","flip-horizontal","flip-vertical","flip","fw","inverse","layers-counter","layers-text","layers","li","pull-left","pull-right","pulse","rotate-180","rotate-270","rotate-90","rotate-by","shake","spin-pulse","spin-reverse","spin","stack-1x","stack-2x","stack","ul","duotone-group","swap-opacity","primary","secondary"]).concat(wne.map(function(n){return"".concat(n,"x")})).concat(TDe.map(function(n){return"w-".concat(n)})),Tm=K0.FontAwesomeConfig||{};Or&&"function"==typeof Or.querySelector&&[["data-family-prefix","familyPrefix"],["data-css-prefix","cssPrefix"],["data-family-default","familyDefault"],["data-style-default","styleDefault"],["data-replacement-class","replacementClass"],["data-auto-replace-svg","autoReplaceSvg"],["data-auto-add-css","autoAddCss"],["data-auto-a11y","autoA11y"],["data-search-pseudo-elements","searchPseudoElements"],["data-observe-mutations","observeMutations"],["data-mutate-approach","mutateApproach"],["data-keep-original-source","keepOriginalSource"],["data-measure-performance","measurePerformance"],["data-show-missing-icons","showMissingIcons"]].forEach(function(n){var t=Yz(n,2),r=t[1],s=function NDe(n){return""===n||"false"!==n&&("true"===n||n)}(function ODe(n){var t=Or.querySelector("script["+n+"]");if(t)return t.getAttribute(n)}(t[0]));null!=s&&(Tm[r]=s)});var bne={styleDefault:"solid",familyDefault:"classic",cssPrefix:"fa",replacementClass:Mne,autoReplaceSvg:!0,autoAddCss:!0,autoA11y:!0,searchPseudoElements:!1,observeMutations:!0,mutateApproach:"async",keepOriginalSource:!0,measurePerformance:!1,showMissingIcons:!0};Tm.familyPrefix&&(Tm.cssPrefix=Tm.familyPrefix);var d9=St(St({},bne),Tm);d9.autoReplaceSvg||(d9.observeMutations=!1);var At={};Object.keys(bne).forEach(function(n){Object.defineProperty(At,n,{enumerable:!0,set:function(e){d9[n]=e,wm.forEach(function(r){return r(At)})},get:function(){return d9[n]}})}),Object.defineProperty(At,"familyPrefix",{enumerable:!0,set:function(t){d9.cssPrefix=t,wm.forEach(function(e){return e(At)})},get:function(){return d9.cssPrefix}}),K0.FontAwesomeConfig=At;var wm=[],R4={size:16,x:0,y:0,rotate:0,flipX:!1,flipY:!1};function bm(){for(var n=12,t="";n-- >0;)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[62*Math.random()|0];return t}function p9(n){for(var t=[],e=(n||[]).length>>>0;e--;)t[e]=n[e];return t}function rV(n){return n.classList?p9(n.classList):(n.getAttribute("class")||"").split(" ").filter(function(t){return t})}function One(n){return"".concat(n).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function VS(n){return Object.keys(n||{}).reduce(function(t,e){return t+"".concat(e,": ").concat(n[e].trim(),";")},"")}function sV(n){return n.size!==R4.size||n.x!==R4.x||n.y!==R4.y||n.rotate!==R4.rotate||n.flipX||n.flipY}function Nne(){var n="fa",t=Mne,e=At.cssPrefix,r=At.replacementClass,s=':root, :host {\n  --fa-font-solid: normal 900 1em/1 "Font Awesome 6 Solid";\n  --fa-font-regular: normal 400 1em/1 "Font Awesome 6 Regular";\n  --fa-font-light: normal 300 1em/1 "Font Awesome 6 Light";\n  --fa-font-thin: normal 100 1em/1 "Font Awesome 6 Thin";\n  --fa-font-duotone: normal 900 1em/1 "Font Awesome 6 Duotone";\n  --fa-font-sharp-solid: normal 900 1em/1 "Font Awesome 6 Sharp";\n  --fa-font-brands: normal 400 1em/1 "Font Awesome 6 Brands";\n}\n\nsvg:not(:root).svg-inline--fa, svg:not(:host).svg-inline--fa {\n  overflow: visible;\n  box-sizing: content-box;\n}\n\n.svg-inline--fa {\n  display: var(--fa-display, inline-block);\n  height: 1em;\n  overflow: visible;\n  vertical-align: -0.125em;\n}\n.svg-inline--fa.fa-2xs {\n  vertical-align: 0.1em;\n}\n.svg-inline--fa.fa-xs {\n  vertical-align: 0em;\n}\n.svg-inline--fa.fa-sm {\n  vertical-align: -0.0714285705em;\n}\n.svg-inline--fa.fa-lg {\n  vertical-align: -0.2em;\n}\n.svg-inline--fa.fa-xl {\n  vertical-align: -0.25em;\n}\n.svg-inline--fa.fa-2xl {\n  vertical-align: -0.3125em;\n}\n.svg-inline--fa.fa-pull-left {\n  margin-right: var(--fa-pull-margin, 0.3em);\n  width: auto;\n}\n.svg-inline--fa.fa-pull-right {\n  margin-left: var(--fa-pull-margin, 0.3em);\n  width: auto;\n}\n.svg-inline--fa.fa-li {\n  width: var(--fa-li-width, 2em);\n  top: 0.25em;\n}\n.svg-inline--fa.fa-fw {\n  width: var(--fa-fw-width, 1.25em);\n}\n\n.fa-layers svg.svg-inline--fa {\n  bottom: 0;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n}\n\n.fa-layers-counter, .fa-layers-text {\n  display: inline-block;\n  position: absolute;\n  text-align: center;\n}\n\n.fa-layers {\n  display: inline-block;\n  height: 1em;\n  position: relative;\n  text-align: center;\n  vertical-align: -0.125em;\n  width: 1em;\n}\n.fa-layers svg.svg-inline--fa {\n  -webkit-transform-origin: center center;\n          transform-origin: center center;\n}\n\n.fa-layers-text {\n  left: 50%;\n  top: 50%;\n  -webkit-transform: translate(-50%, -50%);\n          transform: translate(-50%, -50%);\n  -webkit-transform-origin: center center;\n          transform-origin: center center;\n}\n\n.fa-layers-counter {\n  background-color: var(--fa-counter-background-color, #ff253a);\n  border-radius: var(--fa-counter-border-radius, 1em);\n  box-sizing: border-box;\n  color: var(--fa-inverse, #fff);\n  line-height: var(--fa-counter-line-height, 1);\n  max-width: var(--fa-counter-max-width, 5em);\n  min-width: var(--fa-counter-min-width, 1.5em);\n  overflow: hidden;\n  padding: var(--fa-counter-padding, 0.25em 0.5em);\n  right: var(--fa-right, 0);\n  text-overflow: ellipsis;\n  top: var(--fa-top, 0);\n  -webkit-transform: scale(var(--fa-counter-scale, 0.25));\n          transform: scale(var(--fa-counter-scale, 0.25));\n  -webkit-transform-origin: top right;\n          transform-origin: top right;\n}\n\n.fa-layers-bottom-right {\n  bottom: var(--fa-bottom, 0);\n  right: var(--fa-right, 0);\n  top: auto;\n  -webkit-transform: scale(var(--fa-layers-scale, 0.25));\n          transform: scale(var(--fa-layers-scale, 0.25));\n  -webkit-transform-origin: bottom right;\n          transform-origin: bottom right;\n}\n\n.fa-layers-bottom-left {\n  bottom: var(--fa-bottom, 0);\n  left: var(--fa-left, 0);\n  right: auto;\n  top: auto;\n  -webkit-transform: scale(var(--fa-layers-scale, 0.25));\n          transform: scale(var(--fa-layers-scale, 0.25));\n  -webkit-transform-origin: bottom left;\n          transform-origin: bottom left;\n}\n\n.fa-layers-top-right {\n  top: var(--fa-top, 0);\n  right: var(--fa-right, 0);\n  -webkit-transform: scale(var(--fa-layers-scale, 0.25));\n          transform: scale(var(--fa-layers-scale, 0.25));\n  -webkit-transform-origin: top right;\n          transform-origin: top right;\n}\n\n.fa-layers-top-left {\n  left: var(--fa-left, 0);\n  right: auto;\n  top: var(--fa-top, 0);\n  -webkit-transform: scale(var(--fa-layers-scale, 0.25));\n          transform: scale(var(--fa-layers-scale, 0.25));\n  -webkit-transform-origin: top left;\n          transform-origin: top left;\n}\n\n.fa-1x {\n  font-size: 1em;\n}\n\n.fa-2x {\n  font-size: 2em;\n}\n\n.fa-3x {\n  font-size: 3em;\n}\n\n.fa-4x {\n  font-size: 4em;\n}\n\n.fa-5x {\n  font-size: 5em;\n}\n\n.fa-6x {\n  font-size: 6em;\n}\n\n.fa-7x {\n  font-size: 7em;\n}\n\n.fa-8x {\n  font-size: 8em;\n}\n\n.fa-9x {\n  font-size: 9em;\n}\n\n.fa-10x {\n  font-size: 10em;\n}\n\n.fa-2xs {\n  font-size: 0.625em;\n  line-height: 0.1em;\n  vertical-align: 0.225em;\n}\n\n.fa-xs {\n  font-size: 0.75em;\n  line-height: 0.0833333337em;\n  vertical-align: 0.125em;\n}\n\n.fa-sm {\n  font-size: 0.875em;\n  line-height: 0.0714285718em;\n  vertical-align: 0.0535714295em;\n}\n\n.fa-lg {\n  font-size: 1.25em;\n  line-height: 0.05em;\n  vertical-align: -0.075em;\n}\n\n.fa-xl {\n  font-size: 1.5em;\n  line-height: 0.0416666682em;\n  vertical-align: -0.125em;\n}\n\n.fa-2xl {\n  font-size: 2em;\n  line-height: 0.03125em;\n  vertical-align: -0.1875em;\n}\n\n.fa-fw {\n  text-align: center;\n  width: 1.25em;\n}\n\n.fa-ul {\n  list-style-type: none;\n  margin-left: var(--fa-li-margin, 2.5em);\n  padding-left: 0;\n}\n.fa-ul > li {\n  position: relative;\n}\n\n.fa-li {\n  left: calc(var(--fa-li-width, 2em) * -1);\n  position: absolute;\n  text-align: center;\n  width: var(--fa-li-width, 2em);\n  line-height: inherit;\n}\n\n.fa-border {\n  border-color: var(--fa-border-color, #eee);\n  border-radius: var(--fa-border-radius, 0.1em);\n  border-style: var(--fa-border-style, solid);\n  border-width: var(--fa-border-width, 0.08em);\n  padding: var(--fa-border-padding, 0.2em 0.25em 0.15em);\n}\n\n.fa-pull-left {\n  float: left;\n  margin-right: var(--fa-pull-margin, 0.3em);\n}\n\n.fa-pull-right {\n  float: right;\n  margin-left: var(--fa-pull-margin, 0.3em);\n}\n\n.fa-beat {\n  -webkit-animation-name: fa-beat;\n          animation-name: fa-beat;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, ease-in-out);\n          animation-timing-function: var(--fa-animation-timing, ease-in-out);\n}\n\n.fa-bounce {\n  -webkit-animation-name: fa-bounce;\n          animation-name: fa-bounce;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.28, 0.84, 0.42, 1));\n          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.28, 0.84, 0.42, 1));\n}\n\n.fa-fade {\n  -webkit-animation-name: fa-fade;\n          animation-name: fa-fade;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));\n          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));\n}\n\n.fa-beat-fade {\n  -webkit-animation-name: fa-beat-fade;\n          animation-name: fa-beat-fade;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));\n          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));\n}\n\n.fa-flip {\n  -webkit-animation-name: fa-flip;\n          animation-name: fa-flip;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, ease-in-out);\n          animation-timing-function: var(--fa-animation-timing, ease-in-out);\n}\n\n.fa-shake {\n  -webkit-animation-name: fa-shake;\n          animation-name: fa-shake;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, linear);\n          animation-timing-function: var(--fa-animation-timing, linear);\n}\n\n.fa-spin {\n  -webkit-animation-name: fa-spin;\n          animation-name: fa-spin;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 2s);\n          animation-duration: var(--fa-animation-duration, 2s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, linear);\n          animation-timing-function: var(--fa-animation-timing, linear);\n}\n\n.fa-spin-reverse {\n  --fa-animation-direction: reverse;\n}\n\n.fa-pulse,\n.fa-spin-pulse {\n  -webkit-animation-name: fa-spin;\n          animation-name: fa-spin;\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, steps(8));\n          animation-timing-function: var(--fa-animation-timing, steps(8));\n}\n\n@media (prefers-reduced-motion: reduce) {\n  .fa-beat,\n.fa-bounce,\n.fa-fade,\n.fa-beat-fade,\n.fa-flip,\n.fa-pulse,\n.fa-shake,\n.fa-spin,\n.fa-spin-pulse {\n    -webkit-animation-delay: -1ms;\n            animation-delay: -1ms;\n    -webkit-animation-duration: 1ms;\n            animation-duration: 1ms;\n    -webkit-animation-iteration-count: 1;\n            animation-iteration-count: 1;\n    transition-delay: 0s;\n    transition-duration: 0s;\n  }\n}\n@-webkit-keyframes fa-beat {\n  0%, 90% {\n    -webkit-transform: scale(1);\n            transform: scale(1);\n  }\n  45% {\n    -webkit-transform: scale(var(--fa-beat-scale, 1.25));\n            transform: scale(var(--fa-beat-scale, 1.25));\n  }\n}\n@keyframes fa-beat {\n  0%, 90% {\n    -webkit-transform: scale(1);\n            transform: scale(1);\n  }\n  45% {\n    -webkit-transform: scale(var(--fa-beat-scale, 1.25));\n            transform: scale(var(--fa-beat-scale, 1.25));\n  }\n}\n@-webkit-keyframes fa-bounce {\n  0% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n  10% {\n    -webkit-transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);\n            transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);\n  }\n  30% {\n    -webkit-transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));\n            transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));\n  }\n  50% {\n    -webkit-transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);\n            transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);\n  }\n  57% {\n    -webkit-transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));\n            transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));\n  }\n  64% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n  100% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n}\n@keyframes fa-bounce {\n  0% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n  10% {\n    -webkit-transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);\n            transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);\n  }\n  30% {\n    -webkit-transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));\n            transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));\n  }\n  50% {\n    -webkit-transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);\n            transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);\n  }\n  57% {\n    -webkit-transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));\n            transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));\n  }\n  64% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n  100% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n}\n@-webkit-keyframes fa-fade {\n  50% {\n    opacity: var(--fa-fade-opacity, 0.4);\n  }\n}\n@keyframes fa-fade {\n  50% {\n    opacity: var(--fa-fade-opacity, 0.4);\n  }\n}\n@-webkit-keyframes fa-beat-fade {\n  0%, 100% {\n    opacity: var(--fa-beat-fade-opacity, 0.4);\n    -webkit-transform: scale(1);\n            transform: scale(1);\n  }\n  50% {\n    opacity: 1;\n    -webkit-transform: scale(var(--fa-beat-fade-scale, 1.125));\n            transform: scale(var(--fa-beat-fade-scale, 1.125));\n  }\n}\n@keyframes fa-beat-fade {\n  0%, 100% {\n    opacity: var(--fa-beat-fade-opacity, 0.4);\n    -webkit-transform: scale(1);\n            transform: scale(1);\n  }\n  50% {\n    opacity: 1;\n    -webkit-transform: scale(var(--fa-beat-fade-scale, 1.125));\n            transform: scale(var(--fa-beat-fade-scale, 1.125));\n  }\n}\n@-webkit-keyframes fa-flip {\n  50% {\n    -webkit-transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));\n            transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));\n  }\n}\n@keyframes fa-flip {\n  50% {\n    -webkit-transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));\n            transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));\n  }\n}\n@-webkit-keyframes fa-shake {\n  0% {\n    -webkit-transform: rotate(-15deg);\n            transform: rotate(-15deg);\n  }\n  4% {\n    -webkit-transform: rotate(15deg);\n            transform: rotate(15deg);\n  }\n  8%, 24% {\n    -webkit-transform: rotate(-18deg);\n            transform: rotate(-18deg);\n  }\n  12%, 28% {\n    -webkit-transform: rotate(18deg);\n            transform: rotate(18deg);\n  }\n  16% {\n    -webkit-transform: rotate(-22deg);\n            transform: rotate(-22deg);\n  }\n  20% {\n    -webkit-transform: rotate(22deg);\n            transform: rotate(22deg);\n  }\n  32% {\n    -webkit-transform: rotate(-12deg);\n            transform: rotate(-12deg);\n  }\n  36% {\n    -webkit-transform: rotate(12deg);\n            transform: rotate(12deg);\n  }\n  40%, 100% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n}\n@keyframes fa-shake {\n  0% {\n    -webkit-transform: rotate(-15deg);\n            transform: rotate(-15deg);\n  }\n  4% {\n    -webkit-transform: rotate(15deg);\n            transform: rotate(15deg);\n  }\n  8%, 24% {\n    -webkit-transform: rotate(-18deg);\n            transform: rotate(-18deg);\n  }\n  12%, 28% {\n    -webkit-transform: rotate(18deg);\n            transform: rotate(18deg);\n  }\n  16% {\n    -webkit-transform: rotate(-22deg);\n            transform: rotate(-22deg);\n  }\n  20% {\n    -webkit-transform: rotate(22deg);\n            transform: rotate(22deg);\n  }\n  32% {\n    -webkit-transform: rotate(-12deg);\n            transform: rotate(-12deg);\n  }\n  36% {\n    -webkit-transform: rotate(12deg);\n            transform: rotate(12deg);\n  }\n  40%, 100% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n}\n@-webkit-keyframes fa-spin {\n  0% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n            transform: rotate(360deg);\n  }\n}\n@keyframes fa-spin {\n  0% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n            transform: rotate(360deg);\n  }\n}\n.fa-rotate-90 {\n  -webkit-transform: rotate(90deg);\n          transform: rotate(90deg);\n}\n\n.fa-rotate-180 {\n  -webkit-transform: rotate(180deg);\n          transform: rotate(180deg);\n}\n\n.fa-rotate-270 {\n  -webkit-transform: rotate(270deg);\n          transform: rotate(270deg);\n}\n\n.fa-flip-horizontal {\n  -webkit-transform: scale(-1, 1);\n          transform: scale(-1, 1);\n}\n\n.fa-flip-vertical {\n  -webkit-transform: scale(1, -1);\n          transform: scale(1, -1);\n}\n\n.fa-flip-both,\n.fa-flip-horizontal.fa-flip-vertical {\n  -webkit-transform: scale(-1, -1);\n          transform: scale(-1, -1);\n}\n\n.fa-rotate-by {\n  -webkit-transform: rotate(var(--fa-rotate-angle, none));\n          transform: rotate(var(--fa-rotate-angle, none));\n}\n\n.fa-stack {\n  display: inline-block;\n  vertical-align: middle;\n  height: 2em;\n  position: relative;\n  width: 2.5em;\n}\n\n.fa-stack-1x,\n.fa-stack-2x {\n  bottom: 0;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n  z-index: var(--fa-stack-z-index, auto);\n}\n\n.svg-inline--fa.fa-stack-1x {\n  height: 1em;\n  width: 1.25em;\n}\n.svg-inline--fa.fa-stack-2x {\n  height: 2em;\n  width: 2.5em;\n}\n\n.fa-inverse {\n  color: var(--fa-inverse, #fff);\n}\n\n.sr-only,\n.fa-sr-only {\n  position: absolute;\n  width: 1px;\n  height: 1px;\n  padding: 0;\n  margin: -1px;\n  overflow: hidden;\n  clip: rect(0, 0, 0, 0);\n  white-space: nowrap;\n  border-width: 0;\n}\n\n.sr-only-focusable:not(:focus),\n.fa-sr-only-focusable:not(:focus) {\n  position: absolute;\n  width: 1px;\n  height: 1px;\n  padding: 0;\n  margin: -1px;\n  overflow: hidden;\n  clip: rect(0, 0, 0, 0);\n  white-space: nowrap;\n  border-width: 0;\n}\n\n.svg-inline--fa .fa-primary {\n  fill: var(--fa-primary-color, currentColor);\n  opacity: var(--fa-primary-opacity, 1);\n}\n\n.svg-inline--fa .fa-secondary {\n  fill: var(--fa-secondary-color, currentColor);\n  opacity: var(--fa-secondary-opacity, 0.4);\n}\n\n.svg-inline--fa.fa-swap-opacity .fa-primary {\n  opacity: var(--fa-secondary-opacity, 0.4);\n}\n\n.svg-inline--fa.fa-swap-opacity .fa-secondary {\n  opacity: var(--fa-primary-opacity, 1);\n}\n\n.svg-inline--fa mask .fa-primary,\n.svg-inline--fa mask .fa-secondary {\n  fill: black;\n}\n\n.fad.fa-inverse,\n.fa-duotone.fa-inverse {\n  color: var(--fa-inverse, #fff);\n}';if(e!==n||r!==t){var i=new RegExp("\\.".concat(n,"\\-"),"g"),o=new RegExp("\\--".concat(n,"\\-"),"g"),c=new RegExp("\\.".concat(t),"g");s=s.replace(i,".".concat(e,"-")).replace(o,"--".concat(e,"-")).replace(c,".".concat(r))}return s}var Ane=!1;function iV(){At.autoAddCss&&!Ane&&(function xDe(n){if(n&&r6){var t=Or.createElement("style");t.setAttribute("type","text/css"),t.innerHTML=n;for(var e=Or.head.childNodes,r=null,s=e.length-1;s>-1;s--){var i=e[s],o=(i.tagName||"").toUpperCase();["STYLE","LINK"].indexOf(o)>-1&&(r=i)}Or.head.insertBefore(t,r)}}(Nne()),Ane=!0)}var VDe={mixout:function(){return{dom:{css:Nne,insertCss:iV}}},hooks:function(){return{beforeDOMElementCreation:function(){iV()},beforeI2svg:function(){iV()}}}},i6=K0||{};i6[s6]||(i6[s6]={}),i6[s6].styles||(i6[s6].styles={}),i6[s6].hooks||(i6[s6].hooks={}),i6[s6].shims||(i6[s6].shims=[]);var I3=i6[s6],Ine=[],HS=!1;function FDe(n){!r6||(HS?setTimeout(n,0):Ine.push(n))}function Om(n){var t=n.tag,e=n.attributes,r=void 0===e?{}:e,s=n.children,i=void 0===s?[]:s;return"string"==typeof n?One(n):"<".concat(t," ").concat(function LDe(n){return Object.keys(n||{}).reduce(function(t,e){return t+"".concat(e,'="').concat(One(n[e]),'" ')},"").trim()}(r),">").concat(i.map(Om).join(""),"</").concat(t,">")}function xne(n,t,e){if(n&&n[t]&&n[t][e])return{prefix:t,iconName:e,icon:n[t][e]}}r6&&((HS=(Or.documentElement.doScroll?/^loaded|^c/:/^loaded|^i|^c/).test(Or.readyState))||Or.addEventListener("DOMContentLoaded",function n(){Or.removeEventListener("DOMContentLoaded",n),HS=1,Ine.map(function(t){return t()})}));var oV=function(t,e,r,s){var u,h,p,i=Object.keys(t),o=i.length,c=void 0!==s?function(t,e){return function(r,s,i,o){return t.call(e,r,s,i,o)}}(e,s):e;for(void 0===r?(u=1,p=t[i[0]]):(u=0,p=r);u<o;u++)p=c(p,t[h=i[u]],h,t);return p};function aV(n){var t=function $De(n){for(var t=[],e=0,r=n.length;e<r;){var s=n.charCodeAt(e++);if(s>=55296&&s<=56319&&e<r){var i=n.charCodeAt(e++);56320==(64512&i)?t.push(((1023&s)<<10)+(1023&i)+65536):(t.push(s),e--)}else t.push(s)}return t}(n);return 1===t.length?t[0].toString(16):null}function kne(n){return Object.keys(n).reduce(function(t,e){var r=n[e];return r.icon?t[r.iconName]=r.icon:t[e]=r,t},{})}function cV(n,t){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=e.skipHooks,s=void 0!==r&&r,i=kne(t);"function"!=typeof I3.hooks.addPack||s?I3.styles[n]=St(St({},I3.styles[n]||{}),i):I3.hooks.addPack(n,kne(t)),"fas"===n&&cV("fa",t)}var FS,BS,$S,g9=I3.styles,GDe=I3.shims,WDe=(Ci(FS={},Nr,Object.values(Sm[Nr])),Ci(FS,gs,Object.values(Sm[gs])),FS),lV=null,Lne={},Rne={},Dne={},zne={},Vne={},qDe=(Ci(BS={},Nr,Object.keys(Em[Nr])),Ci(BS,gs,Object.keys(Em[gs])),BS);function ZDe(n,t){var e=t.split("-"),r=e[0],s=e.slice(1).join("-");return r!==n||""===s||function jDe(n){return~bDe.indexOf(n)}(s)?null:s}var Hne=function(){var t=function(i){return oV(g9,function(o,c,u){return o[u]=oV(c,i,{}),o},{})};Lne=t(function(s,i,o){return i[3]&&(s[i[3]]=o),i[2]&&i[2].filter(function(u){return"number"==typeof u}).forEach(function(u){s[u.toString(16)]=o}),s}),Rne=t(function(s,i,o){return s[o]=o,i[2]&&i[2].filter(function(u){return"string"==typeof u}).forEach(function(u){s[u]=o}),s}),Vne=t(function(s,i,o){var c=i[2];return s[o]=o,c.forEach(function(u){s[u]=o}),s});var e="far"in g9||At.autoFetchSvg,r=oV(GDe,function(s,i){var o=i[0],c=i[1],u=i[2];return"far"===c&&!e&&(c="fas"),"string"==typeof o&&(s.names[o]={prefix:c,iconName:u}),"number"==typeof o&&(s.unicodes[o.toString(16)]={prefix:c,iconName:u}),s},{names:{},unicodes:{}});Dne=r.names,zne=r.unicodes,lV=US(At.styleDefault,{family:At.familyDefault})};function uV(n,t){return(Lne[n]||{})[t]}function y5(n,t){return(Vne[n]||{})[t]}function Fne(n){return Dne[n]||{prefix:null,iconName:null}}function Q0(){return lV}function US(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},e=t.family,r=void 0===e?Nr:e,s=Em[r][n],i=Mm[r][n]||Mm[r][s],o=n in I3.styles?n:null;return i||o||null}(function IDe(n){wm.push(n)})(function(n){lV=US(n.styleDefault,{family:At.familyDefault})}),Hne();var Bne=(Ci($S={},Nr,Object.keys(Sm[Nr])),Ci($S,gs,Object.keys(Sm[gs])),$S);function GS(n){var t,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.skipLookups,s=void 0!==r&&r,i=(Ci(t={},Nr,"".concat(At.cssPrefix,"-").concat(Nr)),Ci(t,gs,"".concat(At.cssPrefix,"-").concat(gs)),t),o=null,c=Nr;(n.includes(i[Nr])||n.some(function(h){return Bne[Nr].includes(h)}))&&(c=Nr),(n.includes(i[gs])||n.some(function(h){return Bne[gs].includes(h)}))&&(c=gs);var u=n.reduce(function(h,p){var m=ZDe(At.cssPrefix,p);if(g9[p]?(p=WDe[c].includes(p)?EDe[c][p]:p,o=p,h.prefix=p):qDe[c].indexOf(p)>-1?(o=p,h.prefix=US(p,{family:c})):m?h.iconName=m:p!==At.replacementClass&&p!==i[Nr]&&p!==i[gs]&&h.rest.push(p),!s&&h.prefix&&h.iconName){var C="fa"===o?Fne(h.iconName):{},w=y5(h.prefix,h.iconName);C.prefix&&(o=null),h.iconName=C.iconName||w||h.iconName,h.prefix=C.prefix||h.prefix,"far"===h.prefix&&!g9.far&&g9.fas&&!At.autoFetchSvg&&(h.prefix="fas")}return h},{prefix:null,iconName:null,rest:[]});return(n.includes("fa-brands")||n.includes("fab"))&&(u.prefix="fab"),(n.includes("fa-duotone")||n.includes("fad"))&&(u.prefix="fad"),!u.prefix&&c===gs&&(g9.fass||At.autoFetchSvg)&&(u.prefix="fass",u.iconName=y5(u.prefix,u.iconName)||u.iconName),("fa"===u.prefix||"fa"===o)&&(u.prefix=Q0()||"fas"),u}var XDe=function(){function n(){(function cDe(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")})(this,n),this.definitions={}}return function lDe(n,t,e){t&&fne(n.prototype,t),e&&fne(n,e),Object.defineProperty(n,"prototype",{writable:!1})}(n,[{key:"add",value:function(){for(var e=this,r=arguments.length,s=new Array(r),i=0;i<r;i++)s[i]=arguments[i];var o=s.reduce(this._pullDefinitions,{});Object.keys(o).forEach(function(c){e.definitions[c]=St(St({},e.definitions[c]||{}),o[c]),cV(c,o[c]);var u=Sm[Nr][c];u&&cV(u,o[c]),Hne()})}},{key:"reset",value:function(){this.definitions={}}},{key:"_pullDefinitions",value:function(e,r){var s=r.prefix&&r.iconName&&r.icon?{0:r}:r;return Object.keys(s).map(function(i){var o=s[i],c=o.prefix,u=o.iconName,h=o.icon,p=h[2];e[c]||(e[c]={}),p.length>0&&p.forEach(function(m){"string"==typeof m&&(e[c][m]=h)}),e[c][u]=h}),e}}]),n}(),$ne=[],m9={},_9={},QDe=Object.keys(_9);function hV(n,t){for(var e=arguments.length,r=new Array(e>2?e-2:0),s=2;s<e;s++)r[s-2]=arguments[s];var i=m9[n]||[];return i.forEach(function(o){t=o.apply(null,[t].concat(r))}),t}function E5(n){for(var t=arguments.length,e=new Array(t>1?t-1:0),r=1;r<t;r++)e[r-1]=arguments[r];var s=m9[n]||[];s.forEach(function(i){i.apply(null,e)})}function o6(){var n=arguments[0],t=Array.prototype.slice.call(arguments,1);return _9[n]?_9[n].apply(null,t):void 0}function dV(n){"fa"===n.prefix&&(n.prefix="fas");var t=n.iconName,e=n.prefix||Q0();if(t)return t=y5(e,t)||t,xne(Une.definitions,e,t)||xne(I3.styles,e,t)}var Une=new XDe,tze={i2svg:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return r6?(E5("beforeI2svg",t),o6("pseudoElements2svg",t),o6("i2svg",t)):Promise.reject("Operation requires a DOM of some kind.")},watch:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.autoReplaceSvgRoot;!1===At.autoReplaceSvg&&(At.autoReplaceSvg=!0),At.observeMutations=!0,FDe(function(){rze({autoReplaceSvgRoot:e}),E5("watch",t)})}},ja={noAuto:function(){At.autoReplaceSvg=!1,At.observeMutations=!1,E5("noAuto")},config:At,dom:tze,parse:{icon:function(t){if(null===t)return null;if("object"===AS(t)&&t.prefix&&t.iconName)return{prefix:t.prefix,iconName:y5(t.prefix,t.iconName)||t.iconName};if(Array.isArray(t)&&2===t.length){var e=0===t[1].indexOf("fa-")?t[1].slice(3):t[1],r=US(t[0]);return{prefix:r,iconName:y5(r,e)||e}}if("string"==typeof t&&(t.indexOf("".concat(At.cssPrefix,"-"))>-1||t.match(MDe))){var s=GS(t.split(" "),{skipLookups:!0});return{prefix:s.prefix||Q0(),iconName:y5(s.prefix,s.iconName)||s.iconName}}if("string"==typeof t){var i=Q0();return{prefix:i,iconName:y5(i,t)||t}}}},library:Une,findIconDefinition:dV,toHtml:Om},rze=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.autoReplaceSvgRoot,r=void 0===e?Or:e;(Object.keys(I3.styles).length>0||At.autoFetchSvg)&&r6&&At.autoReplaceSvg&&ja.dom.i2svg({node:r})};function WS(n,t){return Object.defineProperty(n,"abstract",{get:t}),Object.defineProperty(n,"html",{get:function(){return n.abstract.map(function(r){return Om(r)})}}),Object.defineProperty(n,"node",{get:function(){if(r6){var r=Or.createElement("div");return r.innerHTML=n.html,r.children}}}),n}function pV(n){var t=n.icons,e=t.main,r=t.mask,s=n.prefix,i=n.iconName,o=n.transform,c=n.symbol,u=n.title,h=n.maskId,p=n.titleId,m=n.extra,C=n.watchable,w=void 0!==C&&C,I=r.found?r:e,H=I.width,K=I.height,ie="fak"===s,ye=[At.replacementClass,i?"".concat(At.cssPrefix,"-").concat(i):""].filter(function(N1){return-1===m.classes.indexOf(N1)}).filter(function(N1){return""!==N1||!!N1}).concat(m.classes).join(" "),te={children:[],attributes:St(St({},m.attributes),{},{"data-prefix":s,"data-icon":i,class:ye,role:m.attributes.role||"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 ".concat(H," ").concat(K)})},ke=ie&&!~m.classes.indexOf("fa-fw")?{width:"".concat(H/K*16*.0625,"em")}:{};w&&(te.attributes[v5]=""),u&&(te.children.push({tag:"title",attributes:{id:te.attributes["aria-labelledby"]||"title-".concat(p||bm())},children:[u]}),delete te.attributes.title);var $e=St(St({},te),{},{prefix:s,iconName:i,main:e,mask:r,maskId:h,transform:o,symbol:c,styles:St(St({},ke),m.styles)}),Xe=r.found&&e.found?o6("generateAbstractMask",$e)||{children:[],attributes:{}}:o6("generateAbstractIcon",$e)||{children:[],attributes:{}},D1=Xe.attributes;return $e.children=Xe.children,$e.attributes=D1,c?function ize(n){var e=n.iconName,r=n.children,s=n.attributes,i=n.symbol,o=!0===i?"".concat(n.prefix,"-").concat(At.cssPrefix,"-").concat(e):i;return[{tag:"svg",attributes:{style:"display: none;"},children:[{tag:"symbol",attributes:St(St({},s),{},{id:o}),children:r}]}]}($e):function sze(n){var t=n.children,e=n.main,r=n.mask,s=n.attributes,i=n.styles,o=n.transform;if(sV(o)&&e.found&&!r.found){var h={x:e.width/e.height/2,y:.5};s.style=VS(St(St({},i),{},{"transform-origin":"".concat(h.x+o.x/16,"em ").concat(h.y+o.y/16,"em")}))}return[{tag:"svg",attributes:s,children:t}]}($e)}function Gne(n){var t=n.content,e=n.width,r=n.height,s=n.transform,i=n.title,o=n.extra,c=n.watchable,u=void 0!==c&&c,h=St(St(St({},o.attributes),i?{title:i}:{}),{},{class:o.classes.join(" ")});u&&(h[v5]="");var p=St({},o.styles);sV(s)&&(p.transform=function DDe(n){var t=n.transform,e=n.width,s=n.height,i=void 0===s?16:s,o=n.startCentered,c=void 0!==o&&o,u="";return u+=c&&yne?"translate(".concat(t.x/16-(void 0===e?16:e)/2,"em, ").concat(t.y/16-i/2,"em) "):c?"translate(calc(-50% + ".concat(t.x/16,"em), calc(-50% + ").concat(t.y/16,"em)) "):"translate(".concat(t.x/16,"em, ").concat(t.y/16,"em) "),(u+="scale(".concat(t.size/16*(t.flipX?-1:1),", ").concat(t.size/16*(t.flipY?-1:1),") "))+"rotate(".concat(t.rotate,"deg) ")}({transform:s,startCentered:!0,width:e,height:r}),p["-webkit-transform"]=p.transform);var m=VS(p);m.length>0&&(h.style=m);var C=[];return C.push({tag:"span",attributes:h,children:[t]}),i&&C.push({tag:"span",attributes:{class:"sr-only"},children:[i]}),C}function oze(n){var t=n.content,e=n.title,r=n.extra,s=St(St(St({},r.attributes),e?{title:e}:{}),{},{class:r.classes.join(" ")}),i=VS(r.styles);i.length>0&&(s.style=i);var o=[];return o.push({tag:"span",attributes:s,children:[t]}),e&&o.push({tag:"span",attributes:{class:"sr-only"},children:[e]}),o}var gV=I3.styles;function mV(n){var t=n[0],e=n[1],i=Yz(n.slice(4),1)[0];return{found:!0,width:t,height:e,icon:Array.isArray(i)?{tag:"g",attributes:{class:"".concat(At.cssPrefix,"-").concat("duotone-group")},children:[{tag:"path",attributes:{class:"".concat(At.cssPrefix,"-").concat("secondary"),fill:"currentColor",d:i[0]}},{tag:"path",attributes:{class:"".concat(At.cssPrefix,"-").concat("primary"),fill:"currentColor",d:i[1]}}]}:{tag:"path",attributes:{fill:"currentColor",d:i}}}}var aze={found:!1,width:512,height:512};function _V(n,t){var e=t;return"fa"===t&&null!==At.styleDefault&&(t=Q0()),new Promise(function(r,s){if(o6("missingIconAbstract"),"fa"===e){var o=Fne(n)||{};n=o.iconName||n,t=o.prefix||t}if(n&&t&&gV[t]&&gV[t][n])return r(mV(gV[t][n]));(function cze(n,t){!Pne&&!At.showMissingIcons&&n&&console.error('Icon with name "'.concat(n,'" and prefix "').concat(t,'" is missing.'))})(n,t),r(St(St({},aze),{},{icon:At.showMissingIcons&&n&&o6("missingIconAbstract")||{}}))})}var Wne=function(){},vV=At.measurePerformance&&xS&&xS.mark&&xS.measure?xS:{mark:Wne,measure:Wne},Nm='FA "6.2.1"',CV_begin=function(t){return vV.mark("".concat(Nm," ").concat(t," begins")),function(){return function(t){vV.mark("".concat(Nm," ").concat(t," ends")),vV.measure("".concat(Nm," ").concat(t),"".concat(Nm," ").concat(t," begins"),"".concat(Nm," ").concat(t," ends"))}(t)}},qS=function(){};function jne(n){return"string"==typeof(n.getAttribute?n.getAttribute(v5):null)}function dze(n){return Or.createElementNS("http://www.w3.org/2000/svg",n)}function pze(n){return Or.createElement(n)}function Zne(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},e=t.ceFn,r=void 0===e?"svg"===n.tag?dze:pze:e;if("string"==typeof n)return Or.createTextNode(n);var s=r(n.tag);Object.keys(n.attributes||[]).forEach(function(o){s.setAttribute(o,n.attributes[o])});var i=n.children||[];return i.forEach(function(o){s.appendChild(Zne(o,{ceFn:r}))}),s}var jS={replace:function(t){var e=t[0];if(e.parentNode)if(t[1].forEach(function(s){e.parentNode.insertBefore(Zne(s),e)}),null===e.getAttribute(v5)&&At.keepOriginalSource){var r=Or.createComment(function gze(n){var t=" ".concat(n.outerHTML," ");return"".concat(t,"Font Awesome fontawesome.com ")}(e));e.parentNode.replaceChild(r,e)}else e.remove()},nest:function(t){var e=t[0],r=t[1];if(~rV(e).indexOf(At.replacementClass))return jS.replace(t);var s=new RegExp("".concat(At.cssPrefix,"-.*"));if(delete r[0].attributes.id,r[0].attributes.class){var i=r[0].attributes.class.split(" ").reduce(function(c,u){return u===At.replacementClass||u.match(s)?c.toSvg.push(u):c.toNode.push(u),c},{toNode:[],toSvg:[]});r[0].attributes.class=i.toSvg.join(" "),0===i.toNode.length?e.removeAttribute("class"):e.setAttribute("class",i.toNode.join(" "))}var o=r.map(function(c){return Om(c)}).join("\n");e.setAttribute(v5,""),e.innerHTML=o}};function Yne(n){n()}function Kne(n,t){var e="function"==typeof t?t:qS;if(0===n.length)e();else{var r=Yne;"async"===At.mutateApproach&&(r=K0.requestAnimationFrame||Yne),r(function(){var s=function hze(){return!0===At.autoReplaceSvg?jS.replace:jS[At.autoReplaceSvg]||jS.replace}(),i=CV_begin("mutate");n.map(s),i(),e()})}}var yV=!1;function Xne(){yV=!0}function EV(){yV=!1}var ZS=null;function Qne(n){if(Cne&&At.observeMutations){var t=n.treeCallback,e=void 0===t?qS:t,r=n.nodeCallback,s=void 0===r?qS:r,i=n.pseudoElementsCallback,o=void 0===i?qS:i,c=n.observeMutationsRoot,u=void 0===c?Or:c;ZS=new Cne(function(h){if(!yV){var p=Q0();p9(h).forEach(function(m){if("childList"===m.type&&m.addedNodes.length>0&&!jne(m.addedNodes[0])&&(At.searchPseudoElements&&o(m.target),e(m.target)),"attributes"===m.type&&m.target.parentNode&&At.searchPseudoElements&&o(m.target.parentNode),"attributes"===m.type&&jne(m.target)&&~wDe.indexOf(m.attributeName))if("class"===m.attributeName&&function uze(n){var t=n.getAttribute?n.getAttribute(eV):null,e=n.getAttribute?n.getAttribute(tV):null;return t&&e}(m.target)){var C=GS(rV(m.target)),I=C.iconName;m.target.setAttribute(eV,C.prefix||p),I&&m.target.setAttribute(tV,I)}else(function fze(n){return n&&n.classList&&n.classList.contains&&n.classList.contains(At.replacementClass)})(m.target)&&s(m.target)})}}),r6&&ZS.observe(u,{childList:!0,attributes:!0,characterData:!0,subtree:!0})}}function _ze(n){var t=n.getAttribute("style"),e=[];return t&&(e=t.split(";").reduce(function(r,s){var i=s.split(":"),o=i[0],c=i.slice(1);return o&&c.length>0&&(r[o]=c.join(":").trim()),r},{})),e}function vze(n){var t=n.getAttribute("data-prefix"),e=n.getAttribute("data-icon"),r=void 0!==n.innerText?n.innerText.trim():"",s=GS(rV(n));return s.prefix||(s.prefix=Q0()),t&&e&&(s.prefix=t,s.iconName=e),s.iconName&&s.prefix||(s.prefix&&r.length>0&&(s.iconName=function YDe(n,t){return(Rne[n]||{})[t]}(s.prefix,n.innerText)||uV(s.prefix,aV(n.innerText))),!s.iconName&&At.autoFetchSvg&&n.firstChild&&n.firstChild.nodeType===Node.TEXT_NODE&&(s.iconName=n.firstChild.data)),s}function Cze(n){var t=p9(n.attributes).reduce(function(s,i){return"class"!==s.name&&"style"!==s.name&&(s[i.name]=i.value),s},{}),e=n.getAttribute("title"),r=n.getAttribute("data-fa-title-id");return At.autoA11y&&(e?t["aria-labelledby"]="".concat(At.replacementClass,"-title-").concat(r||bm()):(t["aria-hidden"]="true",t.focusable="false")),t}function Jne(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{styleParser:!0},e=vze(n),r=e.iconName,s=e.prefix,i=e.rest,o=Cze(n),c=hV("parseNodeAttributes",{},n),u=t.styleParser?_ze(n):[];return St({iconName:r,title:n.getAttribute("title"),titleId:n.getAttribute("data-fa-title-id"),prefix:s,transform:R4,mask:{iconName:null,prefix:null,rest:[]},maskId:null,symbol:!1,extra:{classes:i,styles:u,attributes:o}},c)}var Eze=I3.styles;function e1e(n){var t="nest"===At.autoReplaceSvg?Jne(n,{styleParser:!1}):Jne(n);return~t.extra.classes.indexOf(Tne)?o6("generateLayersText",n,t):o6("generateSvgReplacementMutation",n,t)}var J0=new Set;function t1e(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!r6)return Promise.resolve();var e=Or.documentElement.classList,r=function(m){return e.add("".concat(Sne,"-").concat(m))},s=function(m){return e.remove("".concat(Sne,"-").concat(m))},i=At.autoFetchSvg?J0:nV.map(function(p){return"fa-".concat(p)}).concat(Object.keys(Eze));i.includes("fa")||i.push("fa");var o=[".".concat(Tne,":not([").concat(v5,"])")].concat(i.map(function(p){return".".concat(p,":not([").concat(v5,"])")})).join(", ");if(0===o.length)return Promise.resolve();var c=[];try{c=p9(n.querySelectorAll(o))}catch{}if(!(c.length>0))return Promise.resolve();r("pending"),s("complete");var u=CV_begin("onTree"),h=c.reduce(function(p,m){try{var C=e1e(m);C&&p.push(C)}catch(w){Pne||"MissingIcon"===w.name&&console.error(w)}return p},[]);return new Promise(function(p,m){Promise.all(h).then(function(C){Kne(C,function(){r("active"),r("complete"),s("pending"),"function"==typeof t&&t(),u(),p()})}).catch(function(C){u(),m(C)})})}function Mze(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;e1e(n).then(function(e){e&&Kne([e],t)})}function Sze(n){return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=(t||{}).icon?t:dV(t||{}),s=e.mask;return s&&(s=(s||{}).icon?s:dV(s||{})),n(r,St(St({},e),{},{mask:s}))}}nV.map(function(n){J0.add("fa-".concat(n))}),Object.keys(Em[Nr]).map(J0.add.bind(J0)),Object.keys(Em[gs]).map(J0.add.bind(J0)),J0=Cm(J0);var Pze=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.transform,s=void 0===r?R4:r,i=e.symbol,o=void 0!==i&&i,c=e.mask,u=void 0===c?null:c,h=e.maskId,p=void 0===h?null:h,m=e.title,C=void 0===m?null:m,w=e.titleId,I=void 0===w?null:w,H=e.classes,K=void 0===H?[]:H,ie=e.attributes,ye=void 0===ie?{}:ie,te=e.styles,ke=void 0===te?{}:te;if(t){var $e=t.prefix,Xe=t.iconName,Ft=t.icon;return WS(St({type:"icon"},t),function(){return E5("beforeDOMElementCreation",{iconDefinition:t,params:e}),At.autoA11y&&(C?ye["aria-labelledby"]="".concat(At.replacementClass,"-title-").concat(I||bm()):(ye["aria-hidden"]="true",ye.focusable="false")),pV({icons:{main:mV(Ft),mask:u?mV(u.icon):{found:!1,width:null,height:null,icon:{}}},prefix:$e,iconName:Xe,transform:St(St({},R4),s),symbol:o,title:C,maskId:p,titleId:I,extra:{attributes:ye,styles:ke,classes:K}})})}},Tze={mixout:function(){return{icon:Sze(Pze)}},hooks:function(){return{mutationObserverCallbacks:function(e){return e.treeCallback=t1e,e.nodeCallback=Mze,e}}},provides:function(t){t.i2svg=function(e){var r=e.node,i=e.callback;return t1e(void 0===r?Or:r,void 0===i?function(){}:i)},t.generateSvgReplacementMutation=function(e,r){var s=r.iconName,i=r.title,o=r.titleId,c=r.prefix,u=r.transform,h=r.symbol,p=r.mask,m=r.maskId,C=r.extra;return new Promise(function(w,I){Promise.all([_V(s,c),p.iconName?_V(p.iconName,p.prefix):Promise.resolve({found:!1,width:512,height:512,icon:{}})]).then(function(H){var K=Yz(H,2);w([e,pV({icons:{main:K[0],mask:K[1]},prefix:c,iconName:s,transform:u,symbol:h,maskId:m,title:i,titleId:o,extra:C,watchable:!0})])}).catch(I)})},t.generateAbstractIcon=function(e){var h,r=e.children,s=e.attributes,i=e.main,o=e.transform,u=VS(e.styles);return u.length>0&&(s.style=u),sV(o)&&(h=o6("generateAbstractTransformGrouping",{main:i,transform:o,containerWidth:i.width,iconWidth:i.width})),r.push(h||i.icon),{children:r,attributes:s}}}},wze={mixout:function(){return{layer:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=r.classes,i=void 0===s?[]:s;return WS({type:"layer"},function(){E5("beforeDOMElementCreation",{assembler:e,params:r});var o=[];return e(function(c){Array.isArray(c)?c.map(function(u){o=o.concat(u.abstract)}):o=o.concat(c.abstract)}),[{tag:"span",attributes:{class:["".concat(At.cssPrefix,"-layers")].concat(Cm(i)).join(" ")},children:o}]})}}}},bze={mixout:function(){return{counter:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=r.title,i=void 0===s?null:s,o=r.classes,c=void 0===o?[]:o,u=r.attributes,h=void 0===u?{}:u,p=r.styles,m=void 0===p?{}:p;return WS({type:"counter",content:e},function(){return E5("beforeDOMElementCreation",{content:e,params:r}),oze({content:e.toString(),title:i,extra:{attributes:h,styles:m,classes:["".concat(At.cssPrefix,"-layers-counter")].concat(Cm(c))}})})}}}},Oze={mixout:function(){return{text:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=r.transform,i=void 0===s?R4:s,o=r.title,c=void 0===o?null:o,u=r.classes,h=void 0===u?[]:u,p=r.attributes,m=void 0===p?{}:p,C=r.styles,w=void 0===C?{}:C;return WS({type:"text",content:e},function(){return E5("beforeDOMElementCreation",{content:e,params:r}),Gne({content:e,transform:St(St({},R4),i),title:c,extra:{attributes:m,styles:w,classes:["".concat(At.cssPrefix,"-layers-text")].concat(Cm(h))}})})}}},provides:function(t){t.generateLayersText=function(e,r){var s=r.title,i=r.transform,o=r.extra,c=null,u=null;if(yne){var h=parseInt(getComputedStyle(e).fontSize,10),p=e.getBoundingClientRect();c=p.width/h,u=p.height/h}return At.autoA11y&&!s&&(o.attributes["aria-hidden"]="true"),Promise.resolve([e,Gne({content:e.innerHTML,width:c,height:u,transform:i,title:s,extra:o,watchable:!0})])}}},Nze=new RegExp('"',"ug"),n1e=[1105920,1112319];function r1e(n,t){var e="".concat("data-fa-pseudo-element-pending").concat(t.replace(":","-"));return new Promise(function(r,s){if(null!==n.getAttribute(e))return r();var o=p9(n.children).filter(function(Ft){return Ft.getAttribute(Jz)===t})[0],c=K0.getComputedStyle(n,t),u=c.getPropertyValue("font-family").match(SDe),h=c.getPropertyValue("font-weight"),p=c.getPropertyValue("content");if(o&&!u)return n.removeChild(o),r();if(u&&"none"!==p&&""!==p){var m=c.getPropertyValue("content"),C=~["Sharp"].indexOf(u[2])?gs:Nr,w=~["Solid","Regular","Light","Thin","Duotone","Brands","Kit"].indexOf(u[2])?Mm[C][u[2].toLowerCase()]:PDe[C][h],I=function Aze(n){var t=n.replace(Nze,""),e=function UDe(n,t){var s,e=n.length,r=n.charCodeAt(t);return r>=55296&&r<=56319&&e>t+1&&(s=n.charCodeAt(t+1))>=56320&&s<=57343?1024*(r-55296)+s-56320+65536:r}(t,0),r=e>=n1e[0]&&e<=n1e[1],s=2===t.length&&t[0]===t[1];return{value:aV(s?t[0]:t),isSecondary:r||s}}(m),H=I.value,K=I.isSecondary,ie=u[0].startsWith("FontAwesome"),ye=uV(w,H),te=ye;if(ie){var ke=function KDe(n){var t=zne[n],e=uV("fas",n);return t||(e?{prefix:"fas",iconName:e}:null)||{prefix:null,iconName:null}}(H);ke.iconName&&ke.prefix&&(ye=ke.iconName,w=ke.prefix)}if(!ye||K||o&&o.getAttribute(eV)===w&&o.getAttribute(tV)===te)r();else{n.setAttribute(e,te),o&&n.removeChild(o);var $e=function yze(){return{iconName:null,title:null,titleId:null,prefix:null,transform:R4,symbol:!1,mask:{iconName:null,prefix:null,rest:[]},maskId:null,extra:{classes:[],styles:{},attributes:{}}}}(),Xe=$e.extra;Xe.attributes[Jz]=t,_V(ye,w).then(function(Ft){var D1=pV(St(St({},$e),{},{icons:{main:Ft,mask:{prefix:null,iconName:null,rest:[]}},prefix:w,iconName:te,extra:Xe,watchable:!0})),N1=Or.createElement("svg");"::before"===t?n.insertBefore(N1,n.firstChild):n.appendChild(N1),N1.outerHTML=D1.map(function(is){return Om(is)}).join("\n"),n.removeAttribute(e),r()}).catch(s)}}else r()})}function Ize(n){return Promise.all([r1e(n,"::before"),r1e(n,"::after")])}function xze(n){return!(n.parentNode===document.head||~yDe.indexOf(n.tagName.toUpperCase())||n.getAttribute(Jz)||n.parentNode&&"svg"===n.parentNode.tagName)}function s1e(n){if(r6)return new Promise(function(t,e){var r=p9(n.querySelectorAll("*")).filter(xze).map(Ize),s=CV_begin("searchPseudoElements");Xne(),Promise.all(r).then(function(){s(),EV(),t()}).catch(function(){s(),EV(),e()})})}var i1e=!1,o1e=function(t){return t.toLowerCase().split(" ").reduce(function(r,s){var i=s.toLowerCase().split("-"),o=i[0],c=i.slice(1).join("-");if(o&&"h"===c)return r.flipX=!0,r;if(o&&"v"===c)return r.flipY=!0,r;if(c=parseFloat(c),isNaN(c))return r;switch(o){case"grow":r.size=r.size+c;break;case"shrink":r.size=r.size-c;break;case"left":r.x=r.x-c;break;case"right":r.x=r.x+c;break;case"up":r.y=r.y-c;break;case"down":r.y=r.y+c;break;case"rotate":r.rotate=r.rotate+c}return r},{size:16,x:0,y:0,flipX:!1,flipY:!1,rotate:0})},MV={x:0,y:0,width:"100%",height:"100%"};function a1e(n){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return n.attributes&&(n.attributes.fill||t)&&(n.attributes.fill="black"),n}function Dze(n){return"g"===n.tag?n.children:[n]}var zze={hooks:function(){return{parseNodeAttributes:function(e,r){var s=r.getAttribute("data-fa-mask"),i=s?GS(s.split(" ").map(function(o){return o.trim()})):{prefix:null,iconName:null,rest:[]};return i.prefix||(i.prefix=Q0()),e.mask=i,e.maskId=r.getAttribute("data-fa-mask-id"),e}}},provides:function(t){t.generateAbstractMask=function(e){var r=e.children,s=e.attributes,i=e.main,o=e.mask,c=e.maskId,p=i.icon,C=o.icon,w=function RDe(n){var t=n.transform,r=n.iconWidth,s={transform:"translate(".concat(n.containerWidth/2," 256)")},i="translate(".concat(32*t.x,", ").concat(32*t.y,") "),o="scale(".concat(t.size/16*(t.flipX?-1:1),", ").concat(t.size/16*(t.flipY?-1:1),") "),c="rotate(".concat(t.rotate," 0 0)");return{outer:s,inner:{transform:"".concat(i," ").concat(o," ").concat(c)},path:{transform:"translate(".concat(r/2*-1," -256)")}}}({transform:e.transform,containerWidth:o.width,iconWidth:i.width}),I={tag:"rect",attributes:St(St({},MV),{},{fill:"white"})},H=p.children?{children:p.children.map(a1e)}:{},K={tag:"g",attributes:St({},w.inner),children:[a1e(St({tag:p.tag,attributes:St(St({},p.attributes),w.path)},H))]},ie={tag:"g",attributes:St({},w.outer),children:[K]},ye="mask-".concat(c||bm()),te="clip-".concat(c||bm()),ke={tag:"mask",attributes:St(St({},MV),{},{id:ye,maskUnits:"userSpaceOnUse",maskContentUnits:"userSpaceOnUse"}),children:[I,ie]},$e={tag:"defs",children:[{tag:"clipPath",attributes:{id:te},children:Dze(C)},ke]};return r.push($e,{tag:"rect",attributes:St({fill:"currentColor","clip-path":"url(#".concat(te,")"),mask:"url(#".concat(ye,")")},MV)}),{children:r,attributes:s}}}};!function JDe(n,t){var e=t.mixoutsTo;$ne=n,m9={},Object.keys(_9).forEach(function(r){-1===QDe.indexOf(r)&&delete _9[r]}),$ne.forEach(function(r){var s=r.mixout?r.mixout():{};if(Object.keys(s).forEach(function(o){"function"==typeof s[o]&&(e[o]=s[o]),"object"===AS(s[o])&&Object.keys(s[o]).forEach(function(c){e[o]||(e[o]={}),e[o][c]=s[o][c]})}),r.hooks){var i=r.hooks();Object.keys(i).forEach(function(o){m9[o]||(m9[o]=[]),m9[o].push(i[o])})}r.provides&&r.provides(_9)})}([VDe,Tze,wze,bze,Oze,{hooks:function(){return{mutationObserverCallbacks:function(e){return e.pseudoElementsCallback=s1e,e}}},provides:function(t){t.pseudoElements2svg=function(e){var r=e.node;At.searchPseudoElements&&s1e(void 0===r?Or:r)}}},{mixout:function(){return{dom:{unwatch:function(){Xne(),i1e=!0}}}},hooks:function(){return{bootstrap:function(){Qne(hV("mutationObserverCallbacks",{}))},noAuto:function(){!function mze(){!ZS||ZS.disconnect()}()},watch:function(e){var r=e.observeMutationsRoot;i1e?EV():Qne(hV("mutationObserverCallbacks",{observeMutationsRoot:r}))}}}},{mixout:function(){return{parse:{transform:function(e){return o1e(e)}}}},hooks:function(){return{parseNodeAttributes:function(e,r){var s=r.getAttribute("data-fa-transform");return s&&(e.transform=o1e(s)),e}}},provides:function(t){t.generateAbstractTransformGrouping=function(e){var r=e.main,s=e.transform,o=e.iconWidth,c={transform:"translate(".concat(e.containerWidth/2," 256)")},u="translate(".concat(32*s.x,", ").concat(32*s.y,") "),h="scale(".concat(s.size/16*(s.flipX?-1:1),", ").concat(s.size/16*(s.flipY?-1:1),") "),p="rotate(".concat(s.rotate," 0 0)"),w={outer:c,inner:{transform:"".concat(u," ").concat(h," ").concat(p)},path:{transform:"translate(".concat(o/2*-1," -256)")}};return{tag:"g",attributes:St({},w.outer),children:[{tag:"g",attributes:St({},w.inner),children:[{tag:r.icon.tag,children:r.icon.children,attributes:St(St({},r.icon.attributes),w.path)}]}]}}}},zze,{provides:function(t){var e=!1;K0.matchMedia&&(e=K0.matchMedia("(prefers-reduced-motion: reduce)").matches),t.missingIconAbstract=function(){var r=[],s={fill:"currentColor"},i={attributeType:"XML",repeatCount:"indefinite",dur:"2s"};r.push({tag:"path",attributes:St(St({},s),{},{d:"M156.5,447.7l-12.6,29.5c-18.7-9.5-35.9-21.2-51.5-34.9l22.7-22.7C127.6,430.5,141.5,440,156.5,447.7z M40.6,272H8.5 c1.4,21.2,5.4,41.7,11.7,61.1L50,321.2C45.1,305.5,41.8,289,40.6,272z M40.6,240c1.4-18.8,5.2-37,11.1-54.1l-29.5-12.6 C14.7,194.3,10,216.7,8.5,240H40.6z M64.3,156.5c7.8-14.9,17.2-28.8,28.1-41.5L69.7,92.3c-13.7,15.6-25.5,32.8-34.9,51.5 L64.3,156.5z M397,419.6c-13.9,12-29.4,22.3-46.1,30.4l11.9,29.8c20.7-9.9,39.8-22.6,56.9-37.6L397,419.6z M115,92.4 c13.9-12,29.4-22.3,46.1-30.4l-11.9-29.8c-20.7,9.9-39.8,22.6-56.8,37.6L115,92.4z M447.7,355.5c-7.8,14.9-17.2,28.8-28.1,41.5 l22.7,22.7c13.7-15.6,25.5-32.9,34.9-51.5L447.7,355.5z M471.4,272c-1.4,18.8-5.2,37-11.1,54.1l29.5,12.6 c7.5-21.1,12.2-43.5,13.6-66.8H471.4z M321.2,462c-15.7,5-32.2,8.2-49.2,9.4v32.1c21.2-1.4,41.7-5.4,61.1-11.7L321.2,462z M240,471.4c-18.8-1.4-37-5.2-54.1-11.1l-12.6,29.5c21.1,7.5,43.5,12.2,66.8,13.6V471.4z M462,190.8c5,15.7,8.2,32.2,9.4,49.2h32.1 c-1.4-21.2-5.4-41.7-11.7-61.1L462,190.8z M92.4,397c-12-13.9-22.3-29.4-30.4-46.1l-29.8,11.9c9.9,20.7,22.6,39.8,37.6,56.9 L92.4,397z M272,40.6c18.8,1.4,36.9,5.2,54.1,11.1l12.6-29.5C317.7,14.7,295.3,10,272,8.5V40.6z M190.8,50 c15.7-5,32.2-8.2,49.2-9.4V8.5c-21.2,1.4-41.7,5.4-61.1,11.7L190.8,50z M442.3,92.3L419.6,115c12,13.9,22.3,29.4,30.5,46.1 l29.8-11.9C470,128.5,457.3,109.4,442.3,92.3z M397,92.4l22.7-22.7c-15.6-13.7-32.8-25.5-51.5-34.9l-12.6,29.5 C370.4,72.1,384.4,81.5,397,92.4z"})});var o=St(St({},i),{},{attributeName:"opacity"}),c={tag:"circle",attributes:St(St({},s),{},{cx:"256",cy:"364",r:"28"}),children:[]};return e||c.children.push({tag:"animate",attributes:St(St({},i),{},{attributeName:"r",values:"28;14;28;28;14;28;"})},{tag:"animate",attributes:St(St({},o),{},{values:"1;0;1;1;0;1;"})}),r.push(c),r.push({tag:"path",attributes:St(St({},s),{},{opacity:"1",d:"M263.7,312h-16c-6.6,0-12-5.4-12-12c0-71,77.4-63.9,77.4-107.8c0-20-17.8-40.2-57.4-40.2c-29.1,0-44.3,9.6-59.2,28.7 c-3.9,5-11.1,6-16.2,2.4l-13.1-9.2c-5.6-3.9-6.9-11.8-2.6-17.2c21.2-27.2,46.4-44.7,91.2-44.7c52.3,0,97.4,29.8,97.4,80.2 c0,67.6-77.4,63.5-77.4,107.8C275.7,306.6,270.3,312,263.7,312z"}),children:e?[]:[{tag:"animate",attributes:St(St({},o),{},{values:"1;0;0;0;0;1;"})}]}),e||r.push({tag:"path",attributes:St(St({},s),{},{opacity:"0",d:"M232.5,134.5l7,168c0.3,6.4,5.6,11.5,12,11.5h9c6.4,0,11.7-5.1,12-11.5l7-168c0.3-6.8-5.2-12.5-12-12.5h-23 C237.7,122,232.2,127.7,232.5,134.5z"}),children:[{tag:"animate",attributes:St(St({},o),{},{values:"0;0;1;1;0;0;"})}]}),{tag:"g",attributes:{class:"missing"},children:r}}}},{hooks:function(){return{parseNodeAttributes:function(e,r){var s=r.getAttribute("data-fa-symbol");return e.symbol=null!==s&&(""===s||s),e}}}}],{mixoutsTo:ja});var Bze=ja.parse,$ze=ja.icon;const Uze=["*"],qze=n=>{const t={"fa-spin":n.spin,"fa-pulse":n.pulse,"fa-fw":n.fixedWidth,"fa-border":n.border,"fa-inverse":n.inverse,"fa-layers-counter":n.counter,"fa-flip-horizontal":"horizontal"===n.flip||"both"===n.flip,"fa-flip-vertical":"vertical"===n.flip||"both"===n.flip,[`fa-${n.size}`]:null!==n.size,[`fa-rotate-${n.rotate}`]:null!==n.rotate,[`fa-pull-${n.pull}`]:null!==n.pull,[`fa-stack-${n.stackItemSize}`]:null!=n.stackItemSize};return Object.keys(t).map(e=>t[e]?e:null).filter(e=>e)};let Yze=(()=>{class n{constructor(){this.defaultPrefix="fas",this.fallbackIcon=null}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Kze=(()=>{class n{constructor(){this.definitions={}}addIcons(...e){for(const r of e){r.prefix in this.definitions||(this.definitions[r.prefix]={}),this.definitions[r.prefix][r.iconName]=r;for(const s of r.icon[2])"string"==typeof s&&(this.definitions[r.prefix][s]=r)}}addIconPacks(...e){for(const r of e){const s=Object.keys(r).map(i=>r[i]);this.addIcons(...s)}}getIconDefinition(e,r){return e in this.definitions&&r in this.definitions[e]?this.definitions[e][r]:null}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Xze=(()=>{class n{constructor(){this.stackItemSize="1x"}ngOnChanges(e){if("size"in e)throw new Error('fa-icon is not allowed to customize size when used inside fa-stack. Set size on the enclosing fa-stack instead: <fa-stack size="4x">...</fa-stack>.')}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=Ut({type:n,selectors:[["fa-icon","stackItemSize",""],["fa-duotone-icon","stackItemSize",""]],inputs:{stackItemSize:"stackItemSize",size:"size"},features:[r2]}),n})(),Qze=(()=>{class n{constructor(e,r){this.renderer=e,this.elementRef=r}ngOnInit(){this.renderer.addClass(this.elementRef.nativeElement,"fa-stack")}ngOnChanges(e){"size"in e&&(null!=e.size.currentValue&&this.renderer.addClass(this.elementRef.nativeElement,`fa-${e.size.currentValue}`),null!=e.size.previousValue&&this.renderer.removeClass(this.elementRef.nativeElement,`fa-${e.size.previousValue}`))}}return n.\u0275fac=function(e){return new(e||n)(J(yo),J(h2))},n.\u0275cmp=gt({type:n,selectors:[["fa-stack"]],inputs:{size:"size"},features:[r2],ngContentSelectors:Uze,decls:1,vars:0,template:function(e,r){1&e&&(function wB(n){const t=Re()[16][6];if(!t.projection){const r=t.projection=gl(n?n.length:1,null),s=r.slice();let i=t.child;for(;null!==i;){const o=n?T4e(i,n):0;null!==o&&(s[o]?s[o].projectionNext=i:r[o]=i,s[o]=i),i=i.next}}}(),function bB(n,t=0,e){const r=Re(),s=Xn(),i=f0(s,22+n,16,null,e||null);null===i.projection&&(i.projection=t),vh(),64!=(64&i.flags)&&function eb(n,t,e){tC(t[11],0,t,e,jv(n,e,t),Xv(e.parent||t[6],e,t))}(s,r,i)}(0))},encapsulation:2}),n})(),v9=(()=>{class n{constructor(e,r,s,i,o){this.sanitizer=e,this.config=r,this.iconLibrary=s,this.stackItem=i,this.classes=[],null!=o&&null==i&&console.error('FontAwesome: fa-icon and fa-duotone-icon elements must specify stackItemSize attribute when wrapped into fa-stack. Example: <fa-icon stackItemSize="2x"></fa-icon>.')}ngOnChanges(e){if(null==this.icon&&null==this.config.fallbackIcon)return(()=>{throw new Error("Property `icon` is required for `fa-icon`/`fa-duotone-icon` components.")})();let r=null;if(r=this.icon??this.config.fallbackIcon,e){const s=this.findIconDefinition(r);if(null!=s){const i=this.buildParams();this.renderIcon(s,i)}}}render(){this.ngOnChanges({})}findIconDefinition(e){const r=((n,t)=>(n=>void 0!==n.prefix&&void 0!==n.iconName)(n)?n:Array.isArray(n)&&2===n.length?{prefix:n[0],iconName:n[1]}:"string"==typeof n?{prefix:t,iconName:n}:void 0)(e,this.config.defaultPrefix);return"icon"in r?r:this.iconLibrary.getIconDefinition(r.prefix,r.iconName)??((n=>{throw new Error(`Could not find icon with iconName=${n.iconName} and prefix=${n.prefix} in the icon library.`)})(r),null)}buildParams(){const e={flip:this.flip,spin:this.spin,pulse:this.pulse,border:this.border,inverse:this.inverse,size:this.size||null,pull:this.pull||null,rotate:this.rotate||null,fixedWidth:"boolean"==typeof this.fixedWidth?this.fixedWidth:this.config.fixedWidth,stackItemSize:null!=this.stackItem?this.stackItem.stackItemSize:null},r="string"==typeof this.transform?Bze.transform(this.transform):this.transform;return{title:this.title,transform:r,classes:[...qze(e),...this.classes],mask:null!=this.mask?this.findIconDefinition(this.mask):null,styles:null!=this.styles?this.styles:{},symbol:this.symbol,attributes:{role:this.a11yRole}}}renderIcon(e,r){const s=$ze(e,r);this.renderedIconHTML=this.sanitizer.bypassSecurityTrustHtml(s.html.join("\n"))}}return n.\u0275fac=function(e){return new(e||n)(J(jG),J(Yze),J(Kze),J(Xze,8),J(Qze,8))},n.\u0275cmp=gt({type:n,selectors:[["fa-icon"]],hostAttrs:[1,"ng-fa-icon"],hostVars:2,hostBindings:function(e,r){2&e&&(eO("innerHTML",r.renderedIconHTML,X8),D("title",r.title))},inputs:{icon:"icon",title:"title",spin:"spin",pulse:"pulse",mask:"mask",styles:"styles",flip:"flip",size:"size",pull:"pull",border:"border",inverse:"inverse",symbol:"symbol",rotate:"rotate",fixedWidth:"fixedWidth",classes:"classes",transform:"transform",a11yRole:"a11yRole"},features:[r2],decls:0,vars:0,template:function(e,r){},encapsulation:2}),n})(),Jze=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=oi({type:n}),n.\u0275inj=jr({}),n})();var wV={prefix:"fas",iconName:"reply",icon:[512,512,[61714,"mail-reply"],"f3e5","M205 34.8c11.5 5.1 19 16.6 19 29.2v64H336c97.2 0 176 78.8 176 176c0 113.3-81.5 163.9-100.2 174.1c-2.5 1.4-5.3 1.9-8.1 1.9c-10.9 0-19.7-8.9-19.7-19.7c0-7.5 4.3-14.4 9.8-19.5c9.4-8.8 22.2-26.4 22.2-56.7c0-53-43-96-96-96H224v64c0 12.6-7.4 24.1-19 29.2s-25 3-34.4-5.4l-160-144C3.9 225.7 0 217.1 0 208s3.9-17.7 10.6-23.8l160-144c9.4-8.5 22.9-10.6 34.4-5.4z"]},BV={prefix:"fas",iconName:"eye",icon:[576,512,[128065],"f06e","M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144s64.5-144 144-144s144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64c-11.5 0-22.3-3-31.6-8.4c-.2 2.8-.4 5.5-.4 8.4c0 53 43 96 96 96s96-43 96-96s-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6z"]},Y2e={prefix:"fas",iconName:"gear",icon:[512,512,[9881,"cog"],"f013","M495.9 166.6c3.2 8.7 .5 18.4-6.4 24.6l-43.3 39.4c1.1 8.3 1.7 16.8 1.7 25.4s-.6 17.1-1.7 25.4l43.3 39.4c6.9 6.2 9.6 15.9 6.4 24.6c-4.4 11.9-9.7 23.3-15.8 34.3l-4.7 8.1c-6.6 11-14 21.4-22.1 31.2c-5.9 7.2-15.7 9.6-24.5 6.8l-55.7-17.7c-13.4 10.3-28.2 18.9-44 25.4l-12.5 57.1c-2 9.1-9 16.3-18.2 17.8c-13.8 2.3-28 3.5-42.5 3.5s-28.7-1.2-42.5-3.5c-9.2-1.5-16.2-8.7-18.2-17.8l-12.5-57.1c-15.8-6.5-30.6-15.1-44-25.4L83.1 425.9c-8.8 2.8-18.6 .3-24.5-6.8c-8.1-9.8-15.5-20.2-22.1-31.2l-4.7-8.1c-6.1-11-11.4-22.4-15.8-34.3c-3.2-8.7-.5-18.4 6.4-24.6l43.3-39.4C64.6 273.1 64 264.6 64 256s.6-17.1 1.7-25.4L22.4 191.2c-6.9-6.2-9.6-15.9-6.4-24.6c4.4-11.9 9.7-23.3 15.8-34.3l4.7-8.1c6.6-11 14-21.4 22.1-31.2c5.9-7.2 15.7-9.6 24.5-6.8l55.7 17.7c13.4-10.3 28.2-18.9 44-25.4l12.5-57.1c2-9.1 9-16.3 18.2-17.8C227.3 1.2 241.5 0 256 0s28.7 1.2 42.5 3.5c9.2 1.5 16.2 8.7 18.2 17.8l12.5 57.1c15.8 6.5 30.6 15.1 44 25.4l55.7-17.7c8.8-2.8 18.6-.3 24.5 6.8c8.1 9.8 15.5 20.2 22.1 31.2l4.7 8.1c6.1 11 11.4 22.4 15.8 34.3zM256 336c44.2 0 80-35.8 80-80s-35.8-80-80-80s-80 35.8-80 80s35.8 80 80 80z"]},ooe={prefix:"fas",iconName:"network-wired",icon:[640,512,[],"f6ff","M256 64H384v64H256V64zM240 0c-26.5 0-48 21.5-48 48v96c0 26.5 21.5 48 48 48h48v32H32c-17.7 0-32 14.3-32 32s14.3 32 32 32h96v32H80c-26.5 0-48 21.5-48 48v96c0 26.5 21.5 48 48 48H240c26.5 0 48-21.5 48-48V368c0-26.5-21.5-48-48-48H192V288H448v32H400c-26.5 0-48 21.5-48 48v96c0 26.5 21.5 48 48 48H560c26.5 0 48-21.5 48-48V368c0-26.5-21.5-48-48-48H512V288h96c17.7 0 32-14.3 32-32s-14.3-32-32-32H352V192h48c26.5 0 48-21.5 48-48V48c0-26.5-21.5-48-48-48H240zM96 448V384H224v64H96zm320-64H544v64H416V384z"]},wae={prefix:"fas",iconName:"spinner",icon:[512,512,[],"f110","M304 48c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zm0 416c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zM48 304c26.5 0 48-21.5 48-48s-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48zm464-48c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zM142.9 437c18.7-18.7 18.7-49.1 0-67.9s-49.1-18.7-67.9 0s-18.7 49.1 0 67.9s49.1 18.7 67.9 0zm0-294.2c18.7-18.7 18.7-49.1 0-67.9S93.7 56.2 75 75s-18.7 49.1 0 67.9s49.1 18.7 67.9 0zM369.1 437c18.7 18.7 49.1 18.7 67.9 0s18.7-49.1 0-67.9s-49.1-18.7-67.9 0s-18.7 49.1 0 67.9z"]},uH={prefix:"fas",iconName:"desktop",icon:[576,512,[128421,61704,"desktop-alt"],"f390","M64 0C28.7 0 0 28.7 0 64V352c0 35.3 28.7 64 64 64H240l-10.7 32H160c-17.7 0-32 14.3-32 32s14.3 32 32 32H416c17.7 0 32-14.3 32-32s-14.3-32-32-32H346.7L336 416H512c35.3 0 64-28.7 64-64V64c0-35.3-28.7-64-64-64H64zM512 64V288H64V64H512z"]},cce={prefix:"fas",iconName:"book-open",icon:[576,512,[128214,128366],"f518","M249.6 471.5c10.8 3.8 22.4-4.1 22.4-15.5V78.6c0-4.2-1.6-8.4-5-11C247.4 52 202.4 32 144 32C87.5 32 35.1 48.6 9 59.9c-5.6 2.4-9 8-9 14V454.1c0 11.9 12.8 20.2 24.1 16.5C55.6 460.1 105.5 448 144 448c33.9 0 79 14 105.6 23.5zm76.8 0C353 462 398.1 448 432 448c38.5 0 88.4 12.1 119.9 22.6c11.3 3.8 24.1-4.6 24.1-16.5V73.9c0-6.1-3.4-11.6-9-14C540.9 48.6 488.5 32 432 32c-58.4 0-103.4 20-123 35.6c-3.3 2.6-5 6.8-5 11V456c0 11.4 11.7 19.3 22.4 15.5z"]};class O2{constructor(t,e){this.userDAO=t,this.connectedUserService=e,this.userSubscription=new Z1,this.observedPartLoading=!0,this.observedPart=P.empty(),this.observedPartRS=new Ste(1),this.observedPartObs=this.observedPartRS.asObservable(),this.authSubscription=this.connectedUserService.subscribeToUser(r=>{this.onUserUpdate(r)})}onUserUpdate(t){t===_5.NOT_CONNECTED?(this.authSubscription.unsubscribe(),this.observedPartRS.next(P.empty())):this.userSubscription=this.userDAO.subscribeToChanges(t.id,e=>{ve(e.isPresent(),"When observing part service, user was expected to already have a document!");const r=e.get();this.updateObservedPartWithDoc(r.observedPart)})}updateObservedPartWithDoc(t){const e=this.observedPart,r=null==t&&e.isAbsent(),s=null!=t&&e.equalsValue(t);(!1===r&&!1===s||this.observedPartLoading)&&(this.observedPartLoading=!1,this.observedPart=P.ofNullable(t),this.observedPartRS.next(this.observedPart))}updateObservedPart(t){if(ve(this.connectedUserService.user.isPresent(),"Should not call updateObservedPart when not connected"),this.observedPart.isPresent()){const r={...this.observedPart.get(),...t};return this.userDAO.update(this.connectedUserService.user.get().id,{observedPart:r})}{const r=Object.keys({id:"id",role:"Candidate",typeGame:"P4"});for(const s of r)ve(null!=t[s],"field "+s+" should be set before updating observedPart");return this.userDAO.update(this.connectedUserService.user.get().id,{observedPart:t})}}removeObservedPart(){return ve(this.connectedUserService.user.isPresent(),"Should not call removeObservedPart when not connected"),this.userDAO.update(this.connectedUserService.user.get().id,{observedPart:null})}subscribeToObservedPart(t){return this.observedPartObs.subscribe(t)}canUserCreate(){if(this.observedPart.isAbsent())return G.SUCCESS;{const t=O2.roleToMessage.get(this.observedPart.get().role).get()();return G.failure(t)}}canUserJoin(t,e){if(this.observedPart.isAbsent()||this.observedPart.get().id===t)return G.SUCCESS;if(e&&"Observer"===this.observedPart.get().role)return G.SUCCESS;{const r=O2.roleToMessage.get(this.observedPart.get().role).get()();return G.failure(r)}}ngOnDestroy(){this.userSubscription.unsubscribe(),this.authSubscription.unsubscribe()}}function M3t(n,t){if(1&n&&(un(0),_e(1,31),fn()),2&n){const e=v(2);S(1),k1(e.observedPart.get().typeGame)(null==e.observedPart.get().opponent?null:e.observedPart.get().opponent.name),F1(1)}}function S3t(n,t){if(1&n&&(un(0),_e(1,33),fn()),2&n){const e=v(3);S(1),k1(e.observedPart.get().typeGame)(null==e.observedPart.get().opponent?null:e.observedPart.get().opponent.name),F1(1)}}function P3t(n,t){if(1&n&&(un(0),_e(1,34),fn()),2&n){const e=v(3);S(1),k1(e.observedPart.get().typeGame),F1(1)}}function T3t(n,t){if(1&n&&(x(0,S3t,2,2,"ng-container",27),x(1,P3t,2,1,"ng-template",null,32,r1)),2&n){const e=Qn(2);T("ngIf",v(2).observedPart.get().opponent)("ngIfElse",e)}}function w3t(n,t){if(1&n){const e=Oe();b(0,"a",29),ee("click",function(){return he(e),le(v().navigateToPart())}),x(1,M3t,2,2,"ng-container",27),x(2,T3t,3,2,"ng-template",null,30,r1),O()}if(2&n){const e=Qn(3),r=v();S(1),T("ngIf","Observer"===r.observedPart.get().role||"Candidate"===r.observedPart.get().role)("ngIfElse",e)}}function b3t(n,t){if(1&n&&(un(0),Q(1,"fa-icon",35),fn()),2&n){const e=v();S(1),T("icon",e.faSpinner)}}function O3t(n,t){if(1&n){const e=Oe();un(0),b(1,"div",10)(2,"a",37),Tt(3),O(),b(4,"div",13)(5,"a",38),ee("click",function(){return he(e),le(v(2).logout())}),_e(6,39),O()()(),fn()}if(2&n){const e=v(2);S(3),l1(e.username.get())}}O2.roleToMessage=new Vn([{key:"Candidate",value:mm.YOU_ARE_ALREADY_CANDIDATE},{key:"ChosenOpponent",value:mm.YOU_ARE_ALREADY_CHOSEN_OPPONENT},{key:"Creator",value:mm.YOU_ARE_ALREADY_CREATING},{key:"Player",value:mm.YOU_ARE_ALREADY_PLAYING},{key:"Observer",value:mm.YOU_ARE_ALREADY_OBSERVING}]),O2.\u0275fac=function(t){return new(t||O2)(De(TS),De(Ns))},O2.\u0275prov=nt({token:O2,factory:O2.\u0275fac,providedIn:"root"});const N3t=function(){return["/register"]},A3t=function(){return["/login"]};function I3t(n,t){1&n&&(b(0,"div",40)(1,"a",41)(2,"strong"),_e(3,42),O()(),b(4,"a",43),_e(5,44),O()()),2&n&&(S(1),T("routerLink",rr(2,N3t)),S(3),T("routerLink",rr(3,A3t)))}function x3t(n,t){if(1&n&&(x(0,O3t,7,1,"ng-container",27),x(1,I3t,6,4,"ng-template",null,36,r1)),2&n){const e=Qn(2);T("ngIf",v().username.isPresent())("ngIfElse",e)}}const Dce=function(){return["/"]},k3t=function(){return["/play"]},L3t=function(){return["/lobby"]},R3t=function(){return["/local"]},D3t=function(){return["/tutorial"]},z3t=function(){return["/settings"]};let V3t=(()=>{class n{constructor(e,r,s,i){this.router=e,this.connectedUserService=r,this.observedPartService=s,this.userService=i,this.loading=!0,this.username=P.empty(),this.faCog=Y2e,this.faSpinner=wae,this.showMenu=!1,this.observedPart=P.empty()}ngOnInit(){this.userSubscription=this.connectedUserService.subscribeToUser(e=>{this.loading=!1,this.username=e.username.isPresent()?e.username:e.email}),this.observedPartSubscription=this.observedPartService.subscribeToObservedPart(e=>{this.observedPart=e})}logout(){var e=this;return A(function*(){yield e.connectedUserService.disconnect(),yield e.router.navigate(["/"])})()}navigateToPart(){var e=this;return A(function*(){return e.router.navigate(["/play",e.observedPart.get().typeGame,e.observedPart.get().id])})()}ngOnDestroy(){this.userSubscription.unsubscribe(),this.observedPartSubscription.unsubscribe()}}return n.\u0275fac=function(e){return new(e||n)(J(Zn),J(Ns),J(O2),J(gm))},n.\u0275cmp=gt({type:n,selectors:[["app-header"]],decls:36,vars:20,consts:function(){let t,e,r,s,i,o,c,u,h,p,m,C,w,I;return t=$localize`Home`,e=$localize`Play online`,r=$localize`Create a game`,s=$localize`Join a game`,i=$localize`Play offline`,o=$localize`Create a game`,c=$localize`Learn the rules`,u=$localize`Settings`,h=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: by ${"\ufffd1\ufffd"}:INTERPOLATION_1:`,p=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: against ${"\ufffd1\ufffd"}:INTERPOLATION_1:`,m=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: (waiting for opponent)`,C=$localize`Log out`,w=$localize`Register`,I=$localize`Log in`,[["role","navigation","aria-label","main navigation",1,"navbar","is-primary"],[1,"navbar-brand"],[1,"navbar-item",3,"routerLink"],["id","logo","src","assets/images/logo.png","width","28","height","28"],["role","button","aria-label","menu","aria-expanded","false","data-target","menu",1,"navbar-burger",3,"ngClass","click"],["aria-hidden","true"],["id","menu",1,"navbar-menu",3,"ngClass","click"],[1,"navbar-start"],["id","home",1,"navbar-item",3,"routerLink"],t,[1,"navbar-item","has-dropdown","is-hoverable"],[1,"navbar-link"],e,[1,"navbar-dropdown"],r,s,["id","playOffline",1,"navbar-link"],i,["id","playLocally",1,"navbar-item",3,"routerLink"],o,["id","tutorial",1,"navbar-item",3,"routerLink"],c,[1,"navbar-end"],["id","observedPartLink","class","navbar-item",3,"click",4,"ngIf"],["data-tooltip",u,1,"navbar-item",3,"routerLink"],[3,"icon"],[1,"navbar-item"],[4,"ngIf","ngIfElse"],["showUsernameOrLogin",""],["id","observedPartLink",1,"navbar-item",3,"click"],["activeUser",""],h,["waitingForOpponent",""],p,m,[1,"navbar-item","fa-spin",3,"icon"],["connect",""],["id","connectedUserName",1,"navbar-link"],["id","logout",1,"navbar-item",3,"click"],C,[1,"buttons"],["id","register",1,"button","is-primary",3,"routerLink"],w,["id","login",1,"button","is-light",3,"routerLink"],I]},template:function(e,r){if(1&e&&(b(0,"nav",0)(1,"div",1)(2,"a",2),Q(3,"img",3),O(),b(4,"a",4),ee("click",function(){return r.showMenu=!r.showMenu}),Q(5,"span",5)(6,"span",5)(7,"span",5),O()(),b(8,"div",6),ee("click",function(){return r.showMenu=!r.showMenu}),b(9,"div",7)(10,"a",8),_e(11,9),O(),b(12,"div",10)(13,"a",11),_e(14,12),O(),b(15,"div",13)(16,"a",2),_e(17,14),O(),b(18,"a",2),_e(19,15),O()()(),b(20,"div",10)(21,"a",16),_e(22,17),O(),b(23,"div",13)(24,"a",18),_e(25,19),O(),b(26,"a",20),_e(27,21),O()()()(),b(28,"div",22),x(29,w3t,4,2,"a",23),b(30,"a",24),Q(31,"fa-icon",25),O(),b(32,"div",26),x(33,b3t,2,1,"ng-container",27),x(34,x3t,3,2,"ng-template",null,28,r1),O()()()()),2&e){const s=Qn(35);S(2),T("routerLink",rr(13,Dce)),S(2),T("ngClass",r.showMenu?"is-active":""),S(4),T("ngClass",r.showMenu?"is-active":""),S(2),T("routerLink",rr(14,Dce)),S(6),T("routerLink",rr(15,k3t)),S(2),T("routerLink",rr(16,L3t)),S(6),T("routerLink",rr(17,R3t)),S(2),T("routerLink",rr(18,D3t)),S(3),T("ngIf",r.observedPart.isPresent()),S(1),T("routerLink",rr(19,z3t)),S(1),T("icon",r.faCog),S(2),T("ngIf",r.loading)("ngIfElse",s)}},dependencies:[dn,en,Nu,v9],encapsulation:2}),n})(),H3t=(()=>{class n{constructor(e,r){this._themeService=e,this._errorLoggerService=r,this.faTwitter=sne,this.faFacebook=Xte,this.faGithub=rne}}return n.\u0275fac=function(e){return new(e||n)(J(NS),J(Os))},n.\u0275cmp=gt({type:n,selectors:[["app-root"]],decls:18,vars:3,consts:function(){let t;return t=$localize`If you like ${"\ufffd#8\ufffd"}:START_TAG_STRONG:EveryBoard${"\ufffd/#8\ufffd"}:CLOSE_TAG_STRONG:, follow us!`,[[1,"container","mt-2"],[1,"footer"],[1,"content","has-text-centered"],t,["href","https://github.com/EveryBoard/EveryBoard"],[3,"icon"],["href","https://twitter.com/EveryBoardGames"],["href","https://facebook.com/EveryBoard"]]},template:function(e,r){1&e&&(Q(0,"app-header"),b(1,"main",0),Q(2,"router-outlet"),O(),b(3,"footer",1)(4,"div",2)(5,"p")(6,"span"),yc(7,3),Q(8,"strong"),Ec(),O(),Tt(9," \xa0 "),b(10,"a",4),Q(11,"fa-icon",5),O(),Tt(12,"\xa0 "),b(13,"a",6),Q(14,"fa-icon",5),O(),Tt(15,"\xa0 "),b(16,"a",7),Q(17,"fa-icon",5),O()()()()),2&e&&(S(11),T("icon",r.faGithub),S(3),T("icon",r.faTwitter),S(3),T("icon",r.faFacebook))},dependencies:[ZN,v9,V3t],encapsulation:2}),n})();class Gi{}class bn{constructor(t){this.x=t}static from(t){switch(t){case 0:return bn.ZERO;case 1:return bn.ONE;case 2:return bn.TWO;default:return ve(3===t,"Invalid Apagos Coord "+t),bn.THREE}}equals(t){return this.x===t.x}}bn.ZERO=new bn(0),bn.ONE=new bn(1),bn.TWO=new bn(2),bn.THREE=new bn(3);let C9=(()=>{class n{}return n.PIECE_SHOULD_MOVE_DOWNWARD=()=>$localize`Pieces should only move downward!`,n.CANNOT_LAND_ON_A_FULL_SQUARE=()=>$localize`That square is already full, you cannot put a piece in it!`,n.NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE=()=>$localize`You have no pieces in that square, select one that contains at least one of your pieces!`,n.NO_PIECE_REMAINING_TO_DROP=()=>$localize`There are no remaining pieces of that color to drop!`,n.NO_POSSIBLE_TRANSFER_REMAINS=()=>$localize`There is no possible transfer from that square!`,n})();class B1 extends Gi{constructor(t,e,r){super(),this.landing=t,this.piece=e,this.starting=r}static drop(t,e){return Me.getNonNullable(B1.ALL_MOVES.find(s=>s.landing.equals(t)&&s.piece.equalsValue(e)&&s.starting.equals(P.empty())))}static transfer(t,e){if(t.x<=e.x)return U.failure(C9.PIECE_SHOULD_MOVE_DOWNWARD());const r=Me.getNonNullable(B1.ALL_MOVES.find(s=>s.landing.equals(e)&&s.piece.equals(P.empty())&&s.starting.equals(P.of(t))));return U.success(r)}isDrop(){return this.piece.isPresent()}toString(){return this.isDrop()?"ApagosMove.drop("+this.piece.get().toString()+" on "+this.landing.x+")":"ApagosMove.slideDown("+this.starting.get().x+" > "+this.landing.x+")"}equals(t){return!1!==this.starting.equals(t.starting)&&!1!==this.landing.equals(t.landing)&&this.piece.equals(t.piece)}}B1.ALL_MOVES=[new B1(bn.ZERO,P.of(z.ZERO),P.empty()),new B1(bn.ONE,P.of(z.ZERO),P.empty()),new B1(bn.TWO,P.of(z.ZERO),P.empty()),new B1(bn.THREE,P.of(z.ZERO),P.empty()),new B1(bn.ZERO,P.of(z.ONE),P.empty()),new B1(bn.ONE,P.of(z.ONE),P.empty()),new B1(bn.TWO,P.of(z.ONE),P.empty()),new B1(bn.THREE,P.of(z.ONE),P.empty()),new B1(bn.TWO,P.empty(),P.of(bn.THREE)),new B1(bn.ONE,P.empty(),P.of(bn.THREE)),new B1(bn.ZERO,P.empty(),P.of(bn.THREE)),new B1(bn.ONE,P.empty(),P.of(bn.TWO)),new B1(bn.ZERO,P.empty(),P.of(bn.TWO)),new B1(bn.ZERO,P.empty(),P.of(bn.ONE))],B1.encoder=new class extends Cn{maxValue(){return B1.ALL_MOVES.length}encodeNumber(n){const t=B1.ALL_MOVES.findIndex(e=>e.equals(n));return ve(t>=0,n.toString()+" is not part of possibles moves of Apagos!"),t}decodeNumber(n){return ve(n<B1.ALL_MOVES.length,n+" is not a valid encoded number for ApagosMove decoder"),B1.ALL_MOVES[n]}};class fP{constructor(t){this.turn=t}getCurrentPlayer(){return z.fromTurn(this.turn)}getCurrentOpponent(){return this.turn%2==1?z.ZERO:z.ONE}}class Rm{constructor(t){this.containing=t}static from(t,e,r){if(t+e>r)return U.failure("invalid starting space");const s=new Vn([{key:z.ZERO,value:t},{key:z.ONE,value:e},{key:pe.NONE,value:r}]);s.makeImmutable();const i=new Rm(s);return U.success(i)}isFull(){return this.count(z.ZERO)+this.count(z.ONE)>=this.count(pe.NONE)}count(t){return this.containing.get(t).get()}addPiece(t){let e=this.count(z.ZERO),r=this.count(z.ONE);const s=this.count(pe.NONE);return t===z.ZERO?e++:r++,Rm.from(e,r,s).get()}substractPiece(t){let e=this.count(z.ZERO),r=this.count(z.ONE);const s=this.count(pe.NONE);return t===z.ZERO?e--:r--,Rm.from(e,r,s).get()}getDominatingPlayer(){const t=this.count(z.ZERO),e=this.count(z.ONE);return t>e?z.ZERO:e>t?z.ONE:pe.NONE}equals(t){return this.containing.equals(t.containing)}}let e8=(()=>{class n extends fP{constructor(e,r,s){super(e),this.board=r,this.remaining=s,this.remaining.makeImmutable()}static getInitialState(){return n.fromRepresentation(0,[[0,0,0,0],[0,0,0,0],[7,5,3,1]],this.PIECES_PER_PLAYER,this.PIECES_PER_PLAYER)}static fromRepresentation(e,r,s,i){const o=[];for(let u=0;u<4;u++){const C=Rm.from(r[0][u],r[1][u],r[2][u]).get();o.push(C)}const c=new Vn;return c.set(z.ZERO,s),c.set(z.ONE,i),new n(e,o,c)}getPieceAt(e){return this.board[e.x]}updateAt(e,r){const s=[];for(let o=0;o<4;o++)s.push(e.x===o?r:this.board[o]);const i=this.getRemainingCopy();return new n(this.turn,s,i)}getRemainingCopy(){return this.remaining.getCopy()}getRemaining(e){return this.remaining.get(e).get()}equals(e){return this.turn===e.turn&&Ke.compareArray(e.board,this.board)&&this.remaining.equals(e.remaining)}}return n.PIECES_PER_PLAYER=10,n})();class ce{constructor(t,e,r){this.title=t,this.instruction=e,this.state=r,this.previousMove=P.empty(),this.previousState=P.empty()}static fromMove(t,e,r,s,i,o){return new F3t(t,e,r,s,i,o)}static forClick(t,e,r,s,i,o){return new $3t(t,e,r,s,i,o)}static anyMove(t,e,r,s,i){return new B3t(t,e,r,s,i)}static fromPredicate(t,e,r,s,i,o){return new U3t(t,e,r,s,i,o)}static informational(t,e,r){return new G3t(t,e,r)}isMove(){return!1}isAnyMove(){return!1}isClick(){return!1}isPredicate(){return!1}isInformation(){return!1}hasSolution(){return!1}withPreviousMove(t){return this.previousMove=P.of(t),this}withPreviousState(t){return this.previousState=P.of(t),this}}class hP extends ce{constructor(t,e,r,s){super(t,e,r),this.successMessage=s}hasSolution(){return!0}getSuccessMessage(){return this.successMessage}}class F3t extends hP{constructor(t,e,r,s,i,o){super(t,e,r,i),this.acceptedMoves=s,this.failureMessage=o,ve(s.length>0,"TutorialStepMove: At least one accepted move should be provided, otherwise use TutorialStepInformational")}isMove(){return!0}getSolution(){return this.acceptedMoves[0]}getFailureMessage(){return this.failureMessage}}class B3t extends hP{constructor(t,e,r,s,i){super(t,e,r,i),this.solutionMove=s}getSolution(){return this.solutionMove}isAnyMove(){return!0}}class $3t extends hP{constructor(t,e,r,s,i,o){super(t,e,r,i),this.acceptedClicks=s,this.failureMessage=o}isClick(){return!0}getSolution(){return this.acceptedClicks[0]}getFailureMessage(){return this.failureMessage}}class U3t extends hP{constructor(t,e,r,s,i,o){super(t,e,r,o),this.solutionMove=s,this.predicate=i}getSolution(){return this.solutionMove}isPredicate(){return!0}}class G3t extends ce{isInformation(){return!0}}class K1{}class zce extends K1{constructor(){super(...arguments),this.tutorial=[ce.informational($localize`Initial board and object of the game`,$localize`At Apagos, there are 4 squares, each of them has a fixed number of holes for pieces. Each player starts with 10 pieces. Dark pieces belong to the first player, light pieces belong to the second one. The game ends when no one can play. The player owning the most pieces in the rightmost square wins!`,e8.getInitialState()),ce.anyMove($localize`Drop`,$localize`There are two kinds of moves. One is the drop. To do one, you must click on a visible arrow, being of your color or the opponent's. If the chosen square is one of the 3 leftmost ones, it will exchange position with the square on its right.<br/><br/>You're playing Light. Drop a piece on one of those three squares.`,e8.fromRepresentation(1,[[0,0,0,1],[0,0,0,0],[7,5,3,1]],9,10),B1.drop(bn.ZERO,z.ZERO),$localize`Congratulations!`),ce.fromPredicate($localize`Transfer`,$localize`The other kind of move is the transfer.<ol><li>Choose one of your pieces on the board by clicking on the square in which it is.</li><li>Choose its landing square by clicking on one of the arrow to finish the transfer.</li></ol>It can only be done with your pieces, from a higher square to a lower one.<br/><br/>You're playing Dark, do a transfer!`,e8.fromRepresentation(2,[[0,0,1,0],[0,1,0,0],[7,5,3,1]],9,9),B1.transfer(bn.TWO,bn.ZERO).get(),(t,e,r)=>t.isDrop()?G.failure($localize`This move is a drop, please do a transfer!`):G.SUCCESS,$localize`Congratulations!`),ce.fromPredicate($localize`Victory`,$localize`When you put a last piece into a square, the games end. In this configuration you can win.<br/><br/>You're playing Light, do the winning move!`,e8.fromRepresentation(3,[[1,0,3,4],[2,1,3,1],[3,1,7,5]],2,3),B1.drop(bn.TWO,z.ONE),(t,e,r)=>t.isDrop()?t.piece.equalsValue(z.ONE)?G.SUCCESS:G.failure($localize`You actively made your opponent win!`):G.failure($localize`Wrong choice, your opponent will win in the next turn no matter which piece is dropped!`),$localize`Congratulations!`)]}}var yn=(()=>(function(n){n.VICTORY="VICTORY",n.PRE_VICTORY="PRE_VICTORY",n.DEFAULT="DEFAULT"}(yn||(yn={})),yn))();let dP=(()=>{class n{}return n.createdNodes=0,n.minimaxTime=0,n})();class $1{constructor(t,e=P.empty(),r=P.empty(),s){if(this.gameState=t,this.mother=e,this.move=r,this.minimaxCreator=s,this.childs=P.empty(),this.hopedValue=new Vn,this.ownValue=new Vn,this.possibleMoves=new Vn,this.ownValue=new Vn,null!=s){const i=s.getBoardValue(this);this.ownValue.set(s.name,i),this.hopedValue.set(s.name,i.value)}dP.createdNodes++,X($1.VERBOSE,"creating "+this.myToString())}static getScoreStatus(t){return t===Number.MAX_SAFE_INTEGER||t===Number.MIN_SAFE_INTEGER?(X($1.VERBOSE||!1,"VICTORY"),yn.VICTORY):t===Number.MIN_SAFE_INTEGER+1?(X($1.VERBOSE||!1,"PRE_VICTORY_MIN"),yn.PRE_VICTORY):t===Number.MAX_SAFE_INTEGER-1?(X($1.VERBOSE||!1,"PRE_VICTORY_MAX"),yn.PRE_VICTORY):(X($1.VERBOSE||!1,"DEFAULT"),yn.DEFAULT)}findBestMove(t,e,r=!1,s=!0){const i=(new Date).getTime();let o=this.alphaBeta(t,Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,e,r,s);for(;o.gameState.turn>this.gameState.turn+1;)o=o.mother.get(),t--;return dP.minimaxTime+=(new Date).getTime()-i,o.move.get()}alphaBeta(t,e,r,s,i,o){if(t<1)return X($1.VERBOSE||!1,"isLeaf-Calculation : "+this.myToString()+" at depth "+t),this;if(s.ruler.getGameStatus(this).isEndGame)return X($1.VERBOSE||!1,"isLeaf-EndGame("+$1.ruler.getGameStatus(this).winner.toString()+") : "+this.myToString()+" at depth "+t),this;const u=this.getPossibleMoves(s);ve(u.size()>0,"Minimax "+s.name+" should give move, received none!"),this.childs.isAbsent()&&(this.childs=P.of([]));const h=this.getBestChilds(u,t,e,r,s,i,o),p=this.getBestChildAmongst(h,i),m=p.hopedValue.get(s.toString()).get();return this.hopedValue.put(s.toString(),m),p}getPossibleMoves(t){const e=this.possibleMoves.get(t.name);if(e.isAbsent()){const r=t.getListMoves(this);return this.possibleMoves.set(t.name,new Dt(r)),new Dt(r)}return e.get()}getBestChilds(t,e,r,s,i,o,c){let u=[];const h=this.gameState.getCurrentPlayer();let p=h===z.ZERO?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER;const m=h===z.ZERO?(C,w)=>C<w:(C,w)=>w<C;for(const C of t){const I=this.getOrCreateChild(C,i).alphaBeta(e-1,r,s,i,o,c),H=I.getHopedValue(i);if(m(H,p)||0===u.length?(p=H,u=[I]):H===p&&u.push(I),c&&m(p,h===z.ZERO?r:s))break;h===z.ZERO?s=Math.min(p,s):r=Math.max(p,r)}return u}getBestChildAmongst(t,e){return e?t[Math.floor(Math.random()*t.length)]:t[0]}getOrCreateChild(t,e){let r=this.getSonByMove(t);if(r.isAbsent()){const s=e.ruler.isLegal(t,this.gameState),i=t.toString();ve(s.isSuccess(),'The minimax "'+e.name+'" has proposed an illegal move ('+i+"), this should not happen.");const o=e.ruler.applyLegalMove(t,this.gameState,s.get());r=P.of(new $1(o,P.of(this),P.of(t),e)),this.childs.get().push(r.get())}return r.get()}getSonByMove(t){ve(this.childs.isPresent(),"Cannot get son of uncalculated node");for(const e of this.childs.get())if(e.move.isPresent()&&e.move.equalsValue(t))return P.of(e);return P.empty()}getHopedValue(t){return this.hopedValue.get(t.name).get()}getOwnValue(t){const e=this.ownValue.get(t.name);if(e.isAbsent()){const r=t.getBoardValue(this);return this.ownValue.set(t.name,r),r}return e.get()}myToString(){let t="",e=this;if(e.mother.isAbsent())return"NodeInitial: "+e.gameState.turn;for(;e.mother.isPresent();)t=(e.move.isAbsent()?" ":" > "+e.move.get().toString()+"> ")+e.gameState.turn+" "+t,e=e.mother.get();return"Node: "+t}hasMoves(){return this.childs.isPresent()}countDescendants(){if(this.childs.isAbsent())return 0;let t=this.childs.get().length;for(const e of this.childs.get())t+=e.countDescendants();return t}}$1.VERBOSE=!1,$1.minimaxes=new Vn;class Ct{constructor(t){this.value=t}static fromWinner(t){return t.isPlayer()?new Ct(t.getVictoryValue()):new Ct(0)}static from(t,e){return t*=z.ZERO.getScoreModifier(),e*=z.ONE.getScoreModifier(),new Ct(t+e)}toString(){return""+this.value}}class xe{constructor(t,e){this.isEndGame=t,this.winner=e}static getVictory(t){return t===z.ZERO?xe.ZERO_WON:xe.ONE_WON}static getDefeat(t){return t===z.ZERO?xe.ONE_WON:xe.ZERO_WON}toBoardValue(){return this.winner.isPlayer()?new Ct(this.winner.getVictoryValue()):new Ct(0)}}xe.ZERO_WON=new xe(!0,z.ZERO),xe.ONE_WON=new xe(!0,z.ONE),xe.DRAW=new xe(!0,pe.NONE),xe.ONGOING=new xe(!1,pe.NONE);class U1{constructor(t){this.stateType=t,this.setInitialBoard()}choose(t){X(!1,"Rules.choose: "+t.toString()+" was proposed");const r=this.isLegal(t,this.node.gameState);if(this.node.hasMoves()){X(!1,"Rules.choose: current node has moves");const o=this.node.getSonByMove(t);if(o.isPresent())return ve(r.isSuccess(),"Rules.choose: Move is illegal: "+r.getReasonOr("")),X(!1,"Rules.choose: and this proposed move is found in the list, so it is legal"),this.node=o.get(),!0}if(X(!1,"Rules.choose: current node has no moves or is pruned, let's verify ourselves"),r.isFailure())return X(!1,"Rules.choose: Move is illegal: "+r.getReason()),!1;X(!1,"Rules.choose: Move is legal, let's apply it");const s=this.applyLegalMove(t,this.node.gameState,r.get()),i=new $1(s,P.of(this.node),P.of(t));return this.node=i,!0}setInitialBoard(){const t=this.stateType.getInitialState();$1.ruler=this,this.node=new $1(t)}applyMoves(t,e,r){let s=0;for(const i of t){const o=r(i),c=this.isLegal(o,e);ve(c.isSuccess(),"Can't create state from invalid moves ("+s+"): "+c.toString()+"."),e=this.applyLegalMove(o,e,c.get()),s++}return e}}class D4 extends U1{constructor(){super(e8)}static get(){return D4.singleton.isAbsent()&&(D4.singleton=P.of(new D4)),D4.singleton.get()}applyLegalMove(t,e,r){return t.isDrop()?this.applyLegalDrop(t,e):this.applyLegalTransfer(t,e)}applyLegalDrop(t,e){const r=e.getRemainingCopy(),s=r.get(t.piece.get()).get();r.put(t.piece.get(),s-1);const i=new e8(e.turn+1,e.board,r),o=t.piece.get(),c=i.getPieceAt(t.landing).addPiece(o);if(t.landing===bn.THREE)return i.updateAt(t.landing,c);{const u=bn.from(t.landing.x+1),h=i.getPieceAt(u);return i.updateAt(t.landing,h).updateAt(u,c)}}applyLegalTransfer(t,e){const r=e.getCurrentPlayer(),s=t.starting.get(),i=e.getPieceAt(s).substractPiece(r),o=e.getPieceAt(t.landing).addPiece(r);let c=e.updateAt(s,i);return c=c.updateAt(t.landing,o),new e8(c.turn+1,c.board,c.remaining)}isLegal(t,e){return e.getPieceAt(t.landing).isFull()?U.failure(C9.CANNOT_LAND_ON_A_FULL_SQUARE()):t.isDrop()?this.isLegalDrop(t,e):this.isLegalSlideDown(t,e)}isLegalDrop(t,e){return e.getRemaining(t.piece.get())<=0?U.failure(C9.NO_PIECE_REMAINING_TO_DROP()):U.success(void 0)}isLegalSlideDown(t,e){const r=e.getCurrentPlayer();return 0===e.getPieceAt(t.starting.get()).count(r)?U.failure(C9.NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE()):U.success(void 0)}getGameStatus(t){const e=t.gameState;for(let s=0;s<4;s++)if(!1===e.getPieceAt(bn.from(s)).isFull())return xe.ONGOING;const r=e.getPieceAt(bn.THREE).getDominatingPlayer();return ve(r.isPlayer(),"winner can only be a player if the game is finished"),xe.getVictory(r)}}D4.singleton=P.empty();class Gt{constructor(t,e){this.x=t,this.y=e}equals(t){return this.x===t.x&&this.y===t.y}isDiagonalOfLength(t){return Math.abs(this.x)===t&&Math.abs(this.y)===t}toMinimalVector(){const t=Math.abs(this.x),e=Math.abs(this.y),r=Math.max(t,e);let s=1,i=2;for(;i<=r;)this.x%i==0&&this.y%i==0&&(s=i),i++;return new Gt(this.x/s,this.y/s)}}class vH extends Gt{isDown(){return 1===this.y}isUp(){return-1===this.y}isLeft(){return-1===this.x}isRight(){return 1===this.x}toInt(){return 0===this.x&&-1===this.y?0:1===this.x&&0===this.y?1:0===this.x&&1===this.y?2:-1===this.x&&0===this.y?3:-1===this.x&&-1===this.y?4:1===this.x&&-1===this.y?5:-1===this.x&&1===this.y?6:7}toString(){return 0===this.x&&-1===this.y?"UP":1===this.x&&0===this.y?"RIGHT":0===this.x&&1===this.y?"DOWN":-1===this.x&&0===this.y?"LEFT":-1===this.x&&-1===this.y?"UP_LEFT":1===this.x&&-1===this.y?"UP_RIGHT":-1===this.x&&1===this.y?"DOWN_LEFT":"DOWN_RIGHT"}}class CH{of(t,e){for(const r of this.all)if(r.x===t&&r.y===e)return U.success(r);return U.failure("Invalid x and y in direction construction")}fromDelta(t,e){return 0===t&&0===e?U.failure("Empty delta for direction"):Math.abs(t)===Math.abs(e)||0===t||0===e?this.of(Math.sign(t),Math.sign(e)):U.failure(j3t.DIRECTION_MUST_BE_LINEAR())}fromMove(t,e){return this.fromDelta(e.x-t.x,e.y-t.y)}fromString(t){switch(t){case"UP":return this.of(0,-1);case"RIGHT":return this.of(1,0);case"DOWN":return this.of(0,1);case"LEFT":return this.of(-1,0);case"UP_LEFT":return this.of(-1,-1);case"UP_RIGHT":return this.of(1,-1);case"DOWN_LEFT":return this.of(-1,1);case"DOWN_RIGHT":return this.of(1,1);default:return U.failure(`Invalid direction string ${t}`)}}fromInt(t){switch(t){case 0:return this.of(0,-1);case 1:return this.of(1,0);case 2:return this.of(0,1);case 3:return this.of(-1,0);case 4:return this.of(-1,-1);case 5:return this.of(1,-1);case 6:return this.of(-1,1);case 7:return this.of(1,1);default:return U.failure(`Invalid int direction: ${t}`)}}}class Ne extends vH{constructor(t,e){super(t,e)}isDiagonal(){return 0!==this.x&&0!==this.y}getOpposite(){return Ne.factory.of(-this.x,-this.y).get()}}Ne.UP=new Ne(0,-1),Ne.UP_RIGHT=new Ne(1,-1),Ne.RIGHT=new Ne(1,0),Ne.DOWN_RIGHT=new Ne(1,1),Ne.DOWN=new Ne(0,1),Ne.DOWN_LEFT=new Ne(-1,1),Ne.LEFT=new Ne(-1,0),Ne.UP_LEFT=new Ne(-1,-1),Ne.factory=new class extends CH{constructor(){super(...arguments),this.all=[Ne.UP,Ne.UP_RIGHT,Ne.RIGHT,Ne.DOWN_RIGHT,Ne.DOWN,Ne.DOWN_LEFT,Ne.LEFT,Ne.UP_LEFT]}},Ne.DIRECTIONS=Ne.factory.all,Ne.DIAGONALS=[Ne.UP_RIGHT,Ne.DOWN_RIGHT,Ne.DOWN_LEFT,Ne.UP_LEFT],Ne.ORTHOGONALS=[Ne.UP,Ne.RIGHT,Ne.DOWN,Ne.LEFT],Ne.encoder=new class W3t extends k4{encode(t){return t.toString()}decode(t){return ve("string"==typeof t,"Invalid encoded direction"),Ne.factory.fromString(t).get()}};class Fe extends vH{constructor(t,e){super(t,e)}getOpposite(){return Fe.factory.of(-this.x,-this.y).get()}rotateClockwise(){return Fe.factory.of(-this.y,this.x).get()}}Fe.UP=new Fe(0,-1),Fe.RIGHT=new Fe(1,0),Fe.DOWN=new Fe(0,1),Fe.LEFT=new Fe(-1,0),Fe.factory=new class extends CH{constructor(){super(...arguments),this.all=[Fe.UP,Fe.RIGHT,Fe.DOWN,Fe.LEFT]}of(n,t){return 0===n&&-1===t?U.success(Fe.UP):1===n&&0===t?U.success(Fe.RIGHT):0===n&&1===t?U.success(Fe.DOWN):-1===n&&0===t?U.success(Fe.LEFT):U.failure("Invalid orthogonal from x and y")}},Fe.ORTHOGONALS=Fe.factory.all,Fe.encoder=new class q3t extends k4{encode(t){return t.toString()}decode(t){return ve("string"==typeof t,"Invalid encoded orthogonal"),Fe.factory.fromString(t).get()}};class Vce extends Cn{maxValue(){return 3}encodeNumber(t){return t===Fe.UP?0:t===Fe.RIGHT?1:t===Fe.DOWN?2:3}decodeNumber(t){switch(t){case 0:return Fe.UP;case 1:return Fe.RIGHT;case 2:return Fe.DOWN;default:return Me.expectToBe(t,3,`Encoded orthogonal should be 3 for LEFT but got ${t} instead`),Fe.LEFT}}}let j3t=(()=>{class n{}return n.DIRECTION_MUST_BE_LINEAR=()=>$localize`You must move in a straight line! You can only move orthogonally or diagonally!`,n})(),yH=(()=>{class n{}return n.OUT_OF_RANGE=t=>`The coordinate ${t.toString()} is not on the board`,n})();class M extends Gt{constructor(t,e){super(t,e),this.x=t,this.y=e}static numberEncoder(t,e){return Cn.tuple([Cn.numberEncoder(t),Cn.numberEncoder(e)],r=>[r.x,r.y],r=>new M(r[0],r[1]))}getNext(t,e){return new M(this.x+(e=e??1)*t.x,this.y+e*t.y)}getPrevious(t,e){return this.getNext(t,-(e=e??1))}getLeft(t){return new M(this.x+t.y,this.y+-t.x)}getRight(t){return new M(this.x+-t.y,this.y+t.x)}isInRange(t,e){return!(this.x<0||this.y<0||this.x>=t||this.y>=e)}isNotInRange(t,e){return this.x<0||this.y<0||this.x>=t||this.y>=e}getDirectionToward(t){return Ne.factory.fromMove(this,t)}getOrthogonalDistance(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}getDistance(t){if(!t.isAlignedWith(this))throw new Error("Cannot calculate distance with non aligned coords.");const e=Math.abs(t.x-this.x),r=Math.abs(t.y-this.y);return Math.max(e,r)}isHexagonallyAlignedWith(t){const e=this.x-t.x,r=this.y-t.y;return e!==r&&(e===-r||e*r==0)}isAlignedWith(t){const e=Math.abs(this.x-t.x),r=Math.abs(this.y-t.y);return e===r||e*r==0}getVectorToward(t){return new Gt(t.x-this.x,t.y-this.y)}toVector(){return new Gt(this.x,this.y)}getCoordsToward(t){if(t.equals(this))return[];if(!t.isAlignedWith(this))return[];const e=this.getDirectionToward(t).get();let r=this.getNext(e,1);const s=[];for(;!1===r.equals(t);)s.push(r),r=r.getNext(e,1);return s}getUntil(t){const e=[],r=this.getDirectionToward(t).get();let s=this.getNext(r);for(;!1===s.equals(t);)e.push(s),s=s.getNext(r);return e}equals(t){return this===t||t.x===this.x&&t.y===this.y}compareTo(t){return t.y===this.y?t.x===this.x?0:this.x<t.x?-1:1:this.y<t.y?-1:1}toString(){return"("+this.x+", "+this.y+")"}toSVGPoint(){return this.x+","+this.y}}M.encoder=new class extends k4{encode(n){return{x:n.x,y:n.y}}decode(n){const t=n;return ve(null!=t.x&&"number"==typeof t.x&&null!=t.y&&"number"==typeof t.y,"Invalid encoded coord"),new M(t.x,t.y)}};class Hce{constructor(){this.ArrayUtils=Ke}getPlayerClass(t){switch(t){case z.ZERO:return"player0-fill";case z.ONE:return"player1-fill";default:return Me.expectToBe(t,pe.NONE),""}}}let t8=(()=>{class n extends Hce{constructor(e){super(),this.messageDisplayer=e,this.Player=z,this.SPACE_SIZE=100,this.STROKE_WIDTH=8,this.SMALL_STROKE_WIDTH=2,this.scores=P.empty(),this.imagesLocation="assets/images/",this.hasAsymetricBoard=!1,this.rotation=""}message(e){this.messageDisplayer.gameMessage(e)}cancelMove(e){return this.cancelMoveAttempt(),this.cancelMoveOnWrapper(e),null==e?G.SUCCESS:(this.messageDisplayer.gameMessage(e),G.failure(e))}cancelMoveAttempt(){}pass(){var e=this;return A(function*(){return Os.logError("GameComponent","pass() called on a game that does not redefine it",{gameName:e.constructor.name})})()}getTurn(){return this.rules.node.gameState.turn}getCurrentPlayer(){return this.rules.node.gameState.getCurrentPlayer()}getState(){return this.rules.node.gameState}getPreviousState(){return this.rules.node.mother.get().gameState}showLastMove(){}}return n.\u0275fac=function(e){return new(e||n)(J(Pn))},n.\u0275cmp=gt({type:n,selectors:[["ng-component"]],features:[l],decls:0,vars:0,template:function(e,r){},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})(),y9=(()=>{class n extends t8{getHexaPointsAtXY(e,r){const s=new M(e,r);return this.getHexaPointsAt(s)}getHexaPointsAt(e){return this.hexaLayout.getHexaPointsAt(e)}getCenterAtXY(e,r){const s=new M(e,r);return this.getCenterAt(s)}getCenterAt(e){return this.hexaLayout.getCenterAt(e)}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=Dr(n)))(r||n)}}(),n.\u0275cmp=gt({type:n,selectors:[["ng-component"]],features:[l],decls:0,vars:0,template:function(e,r){},encapsulation:2}),n})();class Ie{constructor(t){this.value=t}static from(t){switch(t){case Ie.ZERO.value:return Ie.ZERO;case Ie.ONE.value:return Ie.ONE;case Ie.EMPTY.value:return Ie.EMPTY;case Ie.UNREACHABLE.value:return Ie.UNREACHABLE;default:throw new Error("FourStatePiece has no value matching "+t)}}static ofPlayer(t){return t===z.ZERO?Ie.ZERO:(Me.expectToBe(t,z.ONE),Ie.ONE)}equals(t){return this===t}is(t){return this.value===t.value}isPlayer(){return this===Ie.ZERO||this===Ie.ONE}}Ie.ZERO=new Ie(z.ZERO.value),Ie.ONE=new Ie(z.ONE.value),Ie.EMPTY=new Ie(pe.NONE.value),Ie.UNREACHABLE=new Ie(3);class Le extends vH{constructor(t,e){super(t,e)}static getAngle(t){switch(t){case Le.UP:return 0;case Le.UP_RIGHT:return 60;case Le.RIGHT:return 120;case Le.DOWN:return 180;case Le.DOWN_LEFT:return 240;default:return Me.expectToBe(t,Le.LEFT),300}}getOpposite(){return Le.factory.of(-this.x,-this.y).get()}}Le.UP=new Le(0,-1),Le.LEFT=new Le(-1,0),Le.UP_RIGHT=new Le(1,-1),Le.DOWN_LEFT=new Le(-1,1),Le.RIGHT=new Le(1,0),Le.DOWN=new Le(0,1),Le.factory=new class extends CH{constructor(){super(...arguments),this.all=[Le.UP,Le.UP_RIGHT,Le.RIGHT,Le.DOWN,Le.DOWN_LEFT,Le.LEFT]}},Le.encoder=new class Z3t extends Cn{maxValue(){return 5}encodeNumber(t){switch(t){case Le.UP:return 0;case Le.UP_RIGHT:return 1;case Le.RIGHT:return 2;case Le.DOWN:return 3;case Le.DOWN_LEFT:return 4;default:return 5}}decodeNumber(t){return ve(0<=t&&t<=5,"Invalid encoded number for HexaDirection "+t),Le.factory.all[t]}};class Fce{}class pP extends Fce{constructor(){super(),this.startAngle=.5,this.conversionMatrix=[Math.sqrt(3),Math.sqrt(3)/2,0,1.5],this.inverseConversionMatrix=[Math.sqrt(3)/3,-1/3,0,2/3]}}pP.INSTANCE=new pP;class As extends Fce{constructor(){super(),this.startAngle=0,this.conversionMatrix=[1.5,0,Math.sqrt(3)/2,Math.sqrt(3)],this.inverseConversionMatrix=[2/3,0,-1/3,Math.sqrt(3)/3]}isOnBorder(t,e){return this.isOnTopRightBorder(t,e)||this.isOnRightBorder(t,e)||this.isOnBottomRightBorder(t,e)||this.isOnBottomLeftBorder(t,e)||this.isOnLeftBorder(t,e)||this.isOnTopLeftBorder(t,e)}isOnTopRightBorder(t,e){return 0===e.y}isOnRightBorder(t,e){return e.x===t.width-1}isOnLeftBorder(t,e){return 0===e.x}isOnBottomLeftBorder(t,e){return e.y===t.height-1}isOnTopLeftBorder(t,e){return null!=t.excludedSpaces[e.y]?e.x===t.excludedSpaces[e.y]:e.y===t.excludedSpaces.length&&0===e.x}isOnBottomRightBorder(t,e){return null!=t.excludedSpaces[t.height-1-e.y]?t.width-1-e.x===t.excludedSpaces[t.height-1-e.y]:t.height-1-e.y===t.excludedSpaces.length&&e.x===t.width-1}getAllBorders(t){const e=[];return t.forEachCoord((r,s)=>{this.isOnBorder(t,r)&&e.push(r)}),e}isTopCorner(t,e){return this.isOnTopLeftBorder(t,e)&&this.isOnTopRightBorder(t,e)}isTopLeftCorner(t,e){return this.isOnTopLeftBorder(t,e)&&this.isOnLeftBorder(t,e)}isTopRightCorner(t,e){return this.isOnTopRightBorder(t,e)&&this.isOnRightBorder(t,e)}isBottomCorner(t,e){return this.isOnBottomLeftBorder(t,e)&&this.isOnBottomRightBorder(t,e)}isBottomLeftCorner(t,e){return this.isOnBottomLeftBorder(t,e)&&this.isOnLeftBorder(t,e)}isBottomRightCorner(t,e){return this.isOnBottomRightBorder(t,e)&&this.isOnRightBorder(t,e)}}As.INSTANCE=new As;class E9{constructor(t,e,r){this.size=t,this.origin=e,this.orientation=r}getCenterAt(t){const e=this.orientation.conversionMatrix;return new M(this.size*(e[0]*t.x+e[1]*t.y)+this.origin.x,this.size*(e[2]*t.x+e[3]*t.y)+this.origin.y)}getCornerOffset(t){const e=2*Math.PI*(this.orientation.startAngle+t)/6;return new M(this.size*Math.cos(e),this.size*Math.sin(e))}getHexaPointsListAt(t){const e=this.getCenterAt(t),r=[];for(let s=0;s<6;s+=1){const i=this.getCornerOffset(s);r.push(new M(e.x+i.x,e.y+i.y))}return r}getHexaPointsAt(t){return this.getHexaPointsListAt(t).map(r=>r.toSVGPoint()).join(" ")}getIsoPoints(t,e){Me.assert(this.orientation===As.INSTANCE,"HexaLayout.getIsoPoints can only be used with flat orientation");const r=this.getCenterAt(t),s=this.getCornerOffset(0),i=this.getCornerOffset(1),o=this.getCornerOffset(2),c=this.getCornerOffset(3);return[[new M(r.x+c.x,r.y+c.y),new M(r.x+c.x,r.y+c.y+e),new M(r.x+o.x,r.y+o.y+e),new M(r.x+o.x,r.y+o.y)],[new M(r.x+s.x,r.y+s.y),new M(r.x+s.x,r.y+s.y+e),new M(r.x+i.x,r.y+i.y+e),new M(r.x+o.x,r.y+o.y+e),new M(r.x+o.x,r.y+o.y),new M(r.x+i.x,r.y+i.y)],[new M(r.x+c.x,r.y+c.y),new M(r.x+c.x,r.y+c.y+e),new M(r.x+o.x,r.y+o.y+e),new M(r.x+i.x,r.y+i.y+e),new M(r.x+s.x,r.y+s.y+e),new M(r.x+s.x,r.y+s.y),new M(r.x+i.x,r.y+i.y),new M(r.x+o.x,r.y+o.y)]]}}let tt=(()=>{class n{}return n.CANNOT_CHOOSE_OPPONENT_PIECE=()=>$localize`You cannot pick a piece of the opponent.`,n.MUST_CLICK_ON_EMPTY_SPACE=()=>$localize`You must click on an empty space.`,n.MUST_CLICK_ON_EMPTY_SQUARE=()=>$localize`You must click on an empty square.`,n.SHOULD_LAND_ON_EMPTY_OR_OPPONENT_SPACE=()=>$localize`Your landing space should be empty or contain a piece of the opponent.`,n.CANNOT_SELF_CAPTURE=()=>$localize`You cannot capture your own pieces.`,n.MUST_CHOOSE_PLAYER_PIECE=()=>$localize`You must pick one of your pieces.`,n.CANNOT_PASS=()=>$localize`You cannot pass your turn.`,n.MUST_LAND_ON_EMPTY_SPACE=()=>$localize`You must drop your piece on an empty space.`,n.MUST_PASS=()=>$localize`You must pass your turn.`,n.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY=()=>$localize`You have selected an empty space, you must select one of your own pieces.`,n.MOVE_CANNOT_BE_STATIC=()=>$localize`You must choose different starting and ending coordinates.`,n.SOMETHING_IN_THE_WAY=()=>$localize`There is a piece between the piece you chose and its landing space.`,n})();class G1{constructor(t,e){this.ruler=t,this.name=e}toString(){return this.name}}class es extends fP{constructor(t,e){super(e),this.board=t}getPieceAt(t){if(this.isOnBoard(t))return this.board[t.y][t.x];throw new Error("Accessing coord not on board "+t+".")}tryToGetPieceAt(t){return this.isOnBoard(t)?P.of(this.board[t.y][t.x]):P.empty()}isOnBoard(t){return t.isInRange(this.board[0].length,this.board.length)}getPieceAtXY(t,e){return this.getPieceAt(new M(t,e))}forEachCoord(t){for(const{coord:e,content:r}of this.getCoordsAndContents())t(e,r)}getCoordsAndContents(){const t=[];for(let e=0;e<this.board.length;e++)for(let r=0;r<this.board[e].length;r++){const s=new M(r,e);this.isOnBoard(s)&&t.push({coord:s,content:this.getPieceAt(s)})}return t}getCopiedBoard(){return Ke.copyBiArray(this.board)}toMap(){const t=[];for(let e=0;e<this.board.length;e++)for(let r=0;r<this.board[0].length;r++){const s=new M(r,e);t.push({key:s,value:this.getPieceAt(s)})}return t}[Symbol.iterator](){const t=[];for(const e of this.board)t.push(...e);return t.values()}}class a6 extends es{static getInitialState(){const t=Ie.EMPTY,e=Ie.UNREACHABLE,r=Ie.ZERO,s=Ie.ONE;return new a6([[e,e,e,e,s,s,s,s,s],[e,e,e,s,s,s,s,s,s],[e,e,t,t,s,s,s,t,t],[e,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,e],[t,t,r,r,r,t,t,e,e],[r,r,r,r,r,r,e,e,e],[r,r,r,r,r,e,e,e,e]],0)}isInBoard(t){return t.isInRange(9,9)&&this.getPieceAt(t)!==Ie.UNREACHABLE}isPiece(t){return this.getPieceAt(t).isPlayer()}getScores(){const t=[14,14];for(let e=0;e<9;e++)for(let r=0;r<9;r++)this.getPieceAtXY(r,e)===Ie.ZERO&&(t[1]=t[1]-1),this.getPieceAtXY(r,e)===Ie.ONE&&(t[0]=t[0]-1);return t}}class xc extends Gi{constructor(t,e){super(),this.coord=new M(t,e)}}class Bce{static getEncoder(t,e,r){return new class extends Cn{constructor(){super(...arguments),this.shiftX=e}maxValue(){return(t-1)*this.shiftX+(e-1)}encodeNumber(s){return s.coord.x*this.shiftX+s.coord.y}decodeNumber(s){const i=s%e;s/=e;const c=new M((s-=s%1)%t,i);return r(c)}}}}class yi extends xc{constructor(t,e,r){if(super(t.x,t.y),this.dir=e,this.lastPiece=r,t.isNotInRange(9,9))throw new Error("Coord "+t.toString()+" out of range, invalid move!")}static fromSingleCoord(t,e){try{return U.success(new yi(t,e,P.empty()))}catch(r){return U.failure(r.message)}}static fromDoubleCoord(t,e,r){const s=[t,e];Ke.sortByDescending(s,yi.sortCoord);const i=s[1].getDirectionToward(s[0]).get(),o=Le.factory.fromDelta(i.x,i.y);if(o.isFailure())return U.failure("Invalid direction");const c=o.get();return s[1].getDistance(s[0])>2?U.failure("Distance between first coord and last coord is too great"):c.equals(r)?yi.fromSingleCoord(s[1],r):c.getOpposite().equals(r)?yi.fromSingleCoord(s[0],r):U.success(new yi(s[1],r,P.of(s[0])))}static sortCoord(t){return 9*t.y+t.x}toString(){return this.isSingleCoord()?"AbaloneMove("+this.coord.x+", "+this.coord.y+", "+this.dir.toString()+")":"AbaloneMove("+this.coord.toString()+" > "+this.lastPiece.get().toString()+", "+this.dir.toString()+")"}isSingleCoord(){return this.lastPiece.isAbsent()}equals(t){return t.coord.equals(this.coord)&&t.dir.equals(this.dir)&&t.lastPiece.equals(this.lastPiece)}}yi.encoder=new class extends Cn{maxValue(){return 104831}encodeNumber(n){const t=9*n.coord.x*8+8*n.coord.y+n.dir.toInt();if(n.isSingleCoord())return t;{const e=n.lastPiece.get();return 9*e.x*2*9*9*8+2*e.y*9*9*8+648+t}}decodeNumber(n){const t=n%8;n=(n-t)/8;const r=Le.factory.fromInt(t).get(),s=n%9,i=(n=(n-s)/9)%9;n=(n-i)/9;const o=new M(i,s);if(0===n)return yi.fromSingleCoord(o,r).get();{const c=(n=(n-1)/2)%9,u=(n=(n-c)/9)%9;n=(n-u)/9;const h=new M(u,c);return yi.fromDoubleCoord(o,h,r).get()}}};let n8=(()=>{class n{}return n.CANNOT_MOVE_MORE_THAN_THREE_PIECES=()=>$localize`You cannot move more than 3 of your pieces!`,n.NOT_ENOUGH_PIECE_TO_PUSH=()=>$localize`You don't have enough pieces to push that group!`,n.CANNOT_PUSH_YOUR_OWN_PIECES=()=>$localize`You cannot push this piece because it is blocked by one of yours!`,n.MUST_ONLY_TRANSLATE_YOUR_PIECES=()=>$localize`This line contains pieces of your opponent or empty spaces, which is forbidden.`,n.TRANSLATION_IMPOSSIBLE=()=>$localize`This move is impossible, some landing spaces are occupied.`,n.LINE_AND_COORD_NOT_ALIGNED=()=>$localize`This space is not aligned with the current line.`,n})();class x3 extends U1{static isLegal(t,e){const r=this.getFirstPieceValidity(t,e);return r.isFailure()?r.toFailedFallible():t.isSingleCoord()?x3.isLegalPush(t,e):x3.isLegalSideStep(t,e)}static getFirstPieceValidity(t,e){const r=e.getPieceAt(t.coord);return!1===e.isPiece(t.coord)?G.failure(tt.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):r===Ie.ofPlayer(e.getCurrentOpponent())?G.failure(tt.CANNOT_CHOOSE_OPPONENT_PIECE()):G.SUCCESS}static isLegalPush(t,e){let r=1,s=t.coord.getNext(t.dir);const i=Ie.ofPlayer(e.getCurrentPlayer()),o=Ie.EMPTY,c=e.getCopiedBoard();for(c[t.coord.y][t.coord.x]=o;r<=3&&e.isOnBoard(s)&&e.getPieceAt(s)===i;)r++,s=s.getNext(t.dir);return r>3?U.failure(n8.CANNOT_MOVE_MORE_THAN_THREE_PIECES()):!1===e.isInBoard(s)||(c[s.y][s.x]=i,e.getPieceAt(s)===o)?U.success(c):x3.isLegalRealPush(s,t,e,r,c)}static isLegalRealPush(t,e,r,s,i){let o=0;const c=Ie.ofPlayer(r.getCurrentOpponent()),u=Ie.ofPlayer(r.getCurrentPlayer());for(;o<s&&r.isOnBoard(t)&&r.getPieceAt(t)===c;)o++,t=t.getNext(e.dir);return o>=s?U.failure(n8.NOT_ENOUGH_PIECE_TO_PUSH()):t.isInRange(9,9)&&(r.getPieceAt(t)===Ie.EMPTY&&(i[t.y][t.x]=c),r.getPieceAt(t)===u)?U.failure(n8.CANNOT_PUSH_YOUR_OWN_PIECES()):U.success(i)}static isLegalSideStep(t,e){let r=t.lastPiece.get();const s=t.coord.getDirectionToward(r).get();r=r.getNext(s);let i=t.coord;const o=Ie.ofPlayer(e.getCurrentPlayer()),c=e.getCopiedBoard();for(;!1===i.equals(r)&&i.isInRange(9,9);){if(e.getPieceAt(i)!==o)return U.failure(n8.MUST_ONLY_TRANSLATE_YOUR_PIECES());const u=i.getNext(t.dir);if(c[i.y][i.x]=Ie.EMPTY,u.isInRange(9,9)){if(e.isPiece(u))return U.failure(n8.TRANSLATION_IMPOSSIBLE());e.getPieceAt(u)===Ie.EMPTY&&(c[u.y][u.x]=o)}i=i.getNext(s)}return U.success(c)}static getGameStatus(t){const e=t.gameState.getScores();return e[0]>5?xe.ZERO_WON:e[1]>5?xe.ONE_WON:xe.ONGOING}applyLegalMove(t,e,r){return new a6(r,e.turn+1)}isLegal(t,e){return x3.isLegal(t,e)}getGameStatus(t){return x3.getGameStatus(t)}}class Y3t extends G1{getListMoves(t){const e=[],r=t.gameState,s=r.getCurrentPlayer();for(let i=0;i<9;i++)for(let o=0;o<9;o++){const c=new M(o,i);if(!1!==r.getPieceAt(c).is(s))for(const u of Le.factory.all){const h=yi.fromSingleCoord(c,u).get();if(this.isAcceptablePush(h,r)){e.push(h);for(const p of Le.factory.all)for(let m=1;m<=2&&!p.equals(u);m++){const C=c.getNext(p,m);if(!C.isInRange(9,9))break;{const w=yi.fromDoubleCoord(c,C,u).get();x3.isLegal(w,r).isSuccess()&&e.push(w)}}}}}return new Dt(e).toList()}isAcceptablePush(t,e){const r=e.getScores(),s=x3.isLegal(t,e);if(s.isSuccess()){const i=e.getCurrentOpponent().value;return!(new a6(s.get(),e.turn+1).getScores()[i]>r[i])}return!1}getBoardValue(t){const e=x3.getGameStatus(t);if(e.isEndGame)return e.toBoardValue();const r=t.gameState.getScores();return new Ct(r[1]-r[0])}}const On=Ie.EMPTY,Ks=Ie.UNREACHABLE,kc=Ie.ZERO,M9=Ie.ONE;class $ce extends K1{constructor(){super(...arguments),this.tutorial=[ce.informational($localize`Initial board and object of the game`,$localize`At Abalone, the goal of the game is to be the first player to push 6 opponent's pieces out of the board. Let us see how!`,a6.getInitialState()),ce.anyMove($localize`Moving a piece`,$localize`At each turn, move one, two, or three pieces either along their line, or on their side.
        For your moves you can therefore choose between up to 6 directions.
        The pieces you move must be aligned and consecutive, and the move should land on an empty space (except to push, we will see that later).
        To make a move, click on one of your pieces, then click on an arrow to choose the move direction.<br/><br/>
        You're playing Dark, make any move!`,a6.getInitialState(),yi.fromSingleCoord(new M(2,6),Le.UP).get(),$localize`Congratulations!`),ce.fromMove($localize`Pushing`,$localize`To push one opponent piece, you must move at least two of your pieces.
        To push two opponent pieces, you must move three of your pieces.
        If one of your pieces is in the way, it will be impossible to push.
        You cannot move more than three pieces.<br/><br/>
        Only one push towards the right is possible here, find it. (You're playing Dark).`,new a6([[Ks,Ks,Ks,Ks,On,kc,kc,M9,M9],[Ks,Ks,Ks,On,On,On,On,On,On],[Ks,Ks,On,kc,kc,kc,M9,kc,On],[Ks,On,On,On,On,On,On,On,On],[On,On,On,On,kc,kc,kc,M9,M9],[On,On,On,On,On,On,On,On,Ks],[On,On,On,On,kc,M9,On,Ks,Ks],[On,On,On,kc,On,On,Ks,Ks,Ks],[On,On,kc,On,On,Ks,Ks,Ks,Ks]],0),[yi.fromSingleCoord(new M(4,4),Le.RIGHT).get()],$localize`Congratulations! You know everything you need to start a game!`,$localize`Failed. Try again.`)]}}function K3t(n,t){if(1&n){const e=Oe();F(),b(0,"circle",6),ee("click",function(){he(e);const s=v(2).index,i=v().index;return le(v().onPieceClick(s,i))}),O()}if(2&n){const e=v(2).index,r=v().index,s=v();We("id","piece_",e,"_",r,""),T("ngClass",s.getPieceClasses(e,r)),D("cx",s.getCenterAtXY(e,r).x)("cy",s.getCenterAtXY(e,r).y)("r",.5*s.SPACE_SIZE)}}function X3t(n,t){if(1&n){const e=Oe();F(),b(0,"g")(1,"polygon",4),ee("click",function(){he(e);const s=v().index,i=v().index;return le(v().onSpaceClick(s,i))}),O(),x(2,K3t,1,6,"circle",5),O()}if(2&n){const e=v(),r=e.index,s=e.$implicit,i=v().index,o=v();S(1),We("id","space_",r,"_",i,""),T("ngClass",o.getSquareClasses(r,i)),D("points",o.getHexaPointsAtXY(r,i)),S(1),T("ngIf",o.isPiece(s))}}function Q3t(n,t){if(1&n&&(F(),b(0,"g"),x(1,X3t,3,5,"g",3),O()),2&n){const e=t.$implicit,r=v(2);S(1),T("ngIf",r.isBoard(e))}}function J3t(n,t){if(1&n&&(F(),b(0,"g"),x(1,Q3t,2,1,"g",1),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e)}}function e4t(n,t){1&n&&(F(),b(0,"marker",7),Q(1,"polygon",8),O()),2&n&&y1("id","arrowhead_",t.$implicit.dir.toString(),"")}function t4t(n,t){if(1&n){const e=Oe();F(),b(0,"g"),Q(1,"line",9),b(2,"line",10),ee("click",function(){const i=he(e).$implicit;return le(v().chooseDirection(i.dir))}),O(),b(3,"polygon",11),ee("click",function(){const i=he(e).$implicit;return le(v().chooseDirection(i.dir))}),O()()}if(2&n){const e=t.$implicit;S(1),y1("id","line_start_",e.dir.toString(),""),D("x1",e.startCenter.x)("y1",e.startCenter.y)("x2",e.middle.x)("y2",e.middle.y),S(1),y1("id","line_end_",e.dir.toString(),""),D("x1",e.middle.x)("y1",e.middle.y)("x2",e.landingCenter.x)("y2",e.landingCenter.y),S(1),y1("id","direction_",e.dir.toString(),""),D("transform",e.transformation)}}class n4t{constructor(t,e,r,s,i,o){this.startCenter=t,this.middle=e,this.landingCenter=r,this.landing=s,this.dir=i,this.transformation=o}}let r4t=(()=>{class n extends y9{constructor(e){super(e),this.moveds=[],this.directions=[],this.selecteds=[],this.rules=new x3(a6),this.availableMinimaxes=[new Y3t(this.rules,"Dummy")],this.encoder=yi.encoder,this.tutorial=(new $ce).tutorial,this.scores=P.of([0,0]),this.SPACE_SIZE=30,this.hexaLayout=new E9(this.SPACE_SIZE,new M(-8*this.SPACE_SIZE,2*this.SPACE_SIZE),pP.INSTANCE),this.updateBoard()}updateBoard(){this.cancelMoveAttempt(),this.hidePreviousMove(),this.rules.node.move.isPresent()&&this.showPreviousMove(),this.hexaBoard=this.getState().getCopiedBoard(),this.scores=P.of(this.getState().getScores())}hidePreviousMove(){this.moveds=[]}cancelMoveAttempt(){this.directions=[],this.selecteds=[]}showPreviousMove(){const e=this.rules.node.move.get();e.isSingleCoord()?this.showPushingMove(e):this.showSideStepMove(e)}showPushingMove(e){const r=this.rules.node.mother.get().gameState;let s=e.coord;for(this.moveds=[s],s=s.getNext(e.dir);s.isInRange(9,9)&&r.isPiece(s);)this.moveds.push(s),s=s.getNext(e.dir);s.isInRange(9,9)&&this.moveds.push(s)}showSideStepMove(e){let r=e.lastPiece.get();const s=e.coord.getDirectionToward(r).get();r=r.getNext(s);let i=e.coord;for(;!1===i.equals(r);)this.moveds.push(i),this.moveds.push(i.getNext(e.dir)),i=i.getNext(s)}onPieceClick(e,r){var s=this;return A(function*(){const i=s.canUserPlay("#piece_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());const o=s.getState().getCurrentOpponent();return s.hexaBoard[r][e].is(o)?s.opponentClick(e,r):0===s.selecteds.length?s.firstClick(e,r):1===s.selecteds.length?s.secondClick(e,r):s.thirdClick(e,r)})()}opponentClick(e,r){var s=this;return A(function*(){return(yield s.tryChoosingDirection(e,r)).isSuccess()?G.SUCCESS:s.cancelMove(tt.CANNOT_CHOOSE_OPPONENT_PIECE())})()}firstClick(e,r){var s=this;return A(function*(){return s.selecteds=[new M(e,r)],s.showPossibleDirections(),G.SUCCESS})()}showPossibleDirections(){this.directions=[],this.showDirection(1===this.selecteds.length)}showDirection(e){const r=this.getState(),s=Ie.ofPlayer(r.getCurrentPlayer()),i=this.selecteds[0],o=this.selecteds[this.selecteds.length-1];for(const c of Le.factory.all){let h,u=i.getNext(c,1);if(r.isOnBoard(u)&&r.getPieceAt(u)===s){if(e)continue;if(u=o.getNext(c,1),r.isOnBoard(u)&&r.getPieceAt(u)===s)continue}if(h=e?yi.fromSingleCoord(i,c).get():yi.fromDoubleCoord(i,o,c).get(),this.rules.isLegal(h,r).isSuccess()){const m=this.getCenterAt(i),C=this.getCenterAt(u),w=this.getMiddleOfArrow(c,u,C),I=C.x+" "+C.y,H=Le.getAngle(c)+150,te=new n4t(m,w,C,u,c,"rotate("+H+" "+I+") translate("+I+")");this.directions.push(te)}}}getMiddleOfArrow(e,r,s){const i=r.getPrevious(e),o=this.getCenterAt(i);return new M(o.x+(s.x-o.x)/2,o.y+(s.y-o.y)/2)}isBoard(e){return e!==Ie.UNREACHABLE}isPiece(e){return e!==Ie.EMPTY}secondClick(e,r){var s=this;return A(function*(){const i=s.selecteds[0],o=new M(e,r);if(o.equals(i))return s.cancelMoveAttempt(),G.SUCCESS;if(!1===o.isHexagonallyAlignedWith(i))return s.cancelMoveAttempt(),s.firstClick(e,r);const c=o.getDistance(i);if(c>2)return s.cancelMove(n8.CANNOT_MOVE_MORE_THAN_THREE_PIECES());const u=i.getDirectionToward(o).get();s.selecteds=[i];for(let h=0;h<c;h++)s.selecteds.push(i.getNext(u,h+1));if(3===s.selecteds.length){const h=s.selecteds[1],p=s.getState().getCurrentPlayer();if(!1===s.hexaBoard[h.y][h.x].is(p))return s.cancelMoveAttempt(),s.firstClick(e,r)}return s.showPossibleDirections(),G.SUCCESS})()}thirdClick(e,r){var s=this;return A(function*(){const i=new M(e,r),o=s.selecteds[0];if(i.equals(o))return s.deselectExtremity(!0);const c=s.selecteds[s.selecteds.length-1];return i.equals(c)?s.deselectExtremity(!1):3===s.selecteds.length&&i.equals(s.selecteds[1])?(s.cancelMoveAttempt(),G.SUCCESS):s.tryExtension(i,o,c)})()}tryExtension(e,r,s){var i=this;return A(function*(){const o=Ne.factory.fromMove(r,e);if(o.isSuccess()){const u=Ne.factory.fromMove(s,e);if(o.equals(u)){const h=r.getDistance(e),p=s.getDistance(e);return 2===Math.max(h,p)?(i.selecteds.push(e),Ke.sortByDescending(i.selecteds,yi.sortCoord),i.showPossibleDirections(),G.SUCCESS):i.cancelMove(n8.CANNOT_MOVE_MORE_THAN_THREE_PIECES())}}const c=i.cancelMove(n8.LINE_AND_COORD_NOT_ALIGNED());return yield i.firstClick(e.x,e.y),c})()}deselectExtremity(e){var r=this;return A(function*(){return r.selecteds=r.selecteds.slice(e?1:0,e?void 0:-1),r.showPossibleDirections(),G.SUCCESS})()}chooseDirection(e){var r=this;return A(function*(){const s=r.canUserPlay("#direction_"+e.toString());return s.isFailure()?r.cancelMove(s.getReason()):r._chooseDirection(e)})()}_chooseDirection(e){var r=this;return A(function*(){const s=r.getState();let i;const o=r.selecteds[0];return i=1===r.selecteds.length?yi.fromSingleCoord(o,e).get():yi.fromDoubleCoord(o,r.selecteds[r.selecteds.length-1],e).get(),r.chooseMove(i,s,r.scores.get())})()}onSpaceClick(e,r){var s=this;return A(function*(){const i=s.canUserPlay("#space_"+e+"_"+r);return i.isFailure()?s.cancelMove(i.getReason()):s.tryChoosingDirection(e,r)})()}tryChoosingDirection(e,r){var s=this;return A(function*(){const i=new M(e,r);for(const o of s.directions)if(o.landing.equals(i))return s._chooseDirection(o.dir);return G.failure("not a direction")})()}getSquareClasses(e,r){const s=new M(e,r),i=[];return this.moveds.some(o=>o.equals(s))&&i.push("moved-fill"),i}getPieceClasses(e,r){const s=new M(e,r),i=z.of(this.hexaBoard[r][e].value),o=[this.getPlayerClass(i)];return this.selecteds.some(c=>c.equals(s))&&o.push("selected-stroke"),o}}return n.\u0275fac=function(e){return new(e||n)(J(Pn))},n.\u0275cmp=gt({type:n,selectors:[["app-abalone"]],features:[l],decls:5,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-165 0 470 500","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto",3,"id",4,"ngFor","ngForOf"],[4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass","click"],["class","base",3,"id","ngClass","click",4,"ngIf"],[1,"base",3,"id","ngClass","click"],["markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto",3,"id"],["points","0 0, 10 3.5, 0 7"],[1,"arrow",3,"id"],[1,"arrow",3,"id","click"],["points","-10 -5, 10 -5, 0 15, -10 -5",1,"arrow",3,"id","click"]],template:function(e,r){1&e&&(F(),b(0,"svg",0),x(1,J3t,2,1,"g",1),b(2,"defs"),x(3,e4t,2,1,"marker",2),O(),x(4,t4t,4,12,"g",1),O()),2&e&&(S(1),T("ngForOf",r.hexaBoard),S(2),T("ngForOf",r.directions),S(1),T("ngForOf",r.directions))},dependencies:[dn,An,en],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class s4t extends G1{getListMoves(t){const e=t.gameState;return B1.ALL_MOVES.filter(function r(s){return D4.get().isLegal(s,e).isSuccess()})}getBoardValue(t){const e=D4.get().getGameStatus(t);if(e.isEndGame)return Ct.fromWinner(e.winner);const r=t.gameState.board[3].getDominatingPlayer();return r.isPlayer()?new Ct(r.getScoreModifier()):new Ct(0)}}function i4t(n,t){if(1&n&&(F(),Q(0,"circle",5)),2&n){const e=t.$implicit,r=v();D("cx",r.getRemainingPieceCx(e))("cy",r.PIECE_RADIUS)("r",r.PIECE_RADIUS-5)}}function o4t(n,t){if(1&n&&(F(),Q(0,"circle",6)),2&n){const e=t.$implicit,r=v();D("cx",r.BOARD_WIDTH-r.getRemainingPieceCx(e))("cy",r.BOARD_HEIGHT-r.PIECE_RADIUS)("r",r.PIECE_RADIUS-5)}}function a4t(n,t){if(1&n){const e=Oe();F(),b(0,"polygon",9),ee("click",function(){he(e);const s=v().index,i=v();return le(i.onArrowClick(s,i.PlayerOrNone.ZERO))}),O()}if(2&n){const e=v().index,r=v();y1("id","dropArrow_zero_",e,""),T("ngClass",r.getArrowClasses(e,r.PlayerOrNone.ZERO)),D("points",r.ARROW_COORD)("transform","translate("+r.SPACE_SIZE/2+" "+-r.SPACE_SIZE/2+")")}}function c4t(n,t){if(1&n){const e=Oe();F(),b(0,"polygon",9),ee("click",function(){he(e);const s=v().index,i=v();return le(i.onArrowClick(s,i.PlayerOrNone.ONE))}),O()}if(2&n){const e=v().index,r=v();y1("id","dropArrow_one_",e,""),T("ngClass",r.getArrowClasses(e,r.PlayerOrNone.ONE)),D("points",r.ARROW_COORD)("transform","translate(0 "+-r.SPACE_SIZE/2+")")}}function l4t(n,t){if(1&n){const e=Oe();F(),un(0),b(1,"circle",10),ee("click",function(){he(e);const s=v().index;return le(v().onSquareClick(s))}),O(),fn()}if(2&n){const e=t.$implicit,r=v(),s=r.index,i=r.$implicit,o=v();S(1),j2("id","square_",s,"_piece_",e,"_out_of_",i.count(o.PlayerOrNone.NONE),""),T("ngClass",o.getPieceClasses(s,e,i)),D("cx",o.getCircleCenter(s,e,i).x)("cy",o.getCircleCenter(s,e,i).y)}}function u4t(n,t){if(1&n){const e=Oe();F(),b(0,"g"),x(1,a4t,1,4,"polygon",7),x(2,c4t,1,4,"polygon",7),b(3,"rect",8),ee("click",function(){const i=he(e).index;return le(v().onSquareClick(i))}),O(),x(4,l4t,2,6,"ng-container",4),O()}if(2&n){const e=t.$implicit,r=t.index,s=v();D("transform",s.getBlockTransform(r)),S(1),T("ngIf",s.canDisplayArrow(r,s.PlayerOrNone.ZERO)),S(1),T("ngIf",s.canDisplayArrow(r,s.PlayerOrNone.ONE)),S(1),y1("id","square_",r,""),T("ngClass",s.getSquareClasses(r)),D("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),S(1),T("ngForOf",s.ArrayUtils.range(e.count(s.PlayerOrNone.NONE)))}}let f4t=(()=>{class n extends t8{constructor(e){super(e),this.PlayerOrNone=pe,this.BOARD_WIDTH=4*this.SPACE_SIZE,this.BOARD_HEIGHT=4.5*this.SPACE_SIZE,this.ARROW_COORD=n.getArrowCoord(),this.PIECES_PER_PLAYER=e8.PIECES_PER_PLAYER,this.selectedPiece=P.empty(),this.leftPiece=P.empty(),this.droppedPiece=P.empty(),this.displayableArrow=[],this.rules=D4.get(),this.hasAsymetricBoard=!0,this.availableMinimaxes=[new s4t(this.rules,"ApagosDummyMinimax")],this.encoder=B1.encoder,this.tutorial=(new zce).tutorial,this.PIECE_RADIUS=2*this.SPACE_SIZE/(this.PIECES_PER_PLAYER+.5),this.updateBoard()}static getArrowCoord(){return"12.5,0 37.5,0 37.5,25 50,25 25,50 0,25 12.5,25"}cancelMoveAttempt(){this.selectedPiece=P.empty(),this.showPossibleDrops()}updateBoard(){const e=this.getState();this.board=e.board,this.remainingZero=e.remaining.get(z.ZERO).get(),this.remainingOne=e.remaining.get(z.ONE).get(),this.hideLastMove(),this.rules.node.move.isPresent()&&this.showLastMove(),this.showPossibleDrops()}hideLastMove(){this.movedSquare=[],this.droppedPiece=P.empty(),this.leftPiece=P.empty(),this.selectedPiece=P.empty()}showLastMove(){const e=this.rules.node.move.get();e.isDrop()?this.showLastDrop(e):this.showLastTransfer(e)}showLastDrop(e){const r=e.piece.get();let s=e.landing.x;this.movedSquare=[s],3!==e.landing.x&&(s+=1,this.movedSquare.push(s));const o=this.getLowestPlayerPiece(this.board[s],r);this.droppedPiece=P.of({square:s,piece:o})}getLowestPlayerPiece(e,r){const s=e.count(r);return r===z.ZERO?s-1:e.count(pe.NONE)-s}showLastTransfer(e){const r=this.rules.node.mother.get().gameState,s=r.getCurrentPlayer(),i=e.starting.get().x,c=this.getLowestPlayerPiece(r.board[i],s);this.leftPiece=P.of({square:i,piece:c});const u=e.landing.x,p=this.getLowestPlayerPiece(this.board[u],s);this.droppedPiece=P.of({square:u,piece:p})}showPossibleDrops(){this.displayableArrow=[];const e=this.getState();for(let r=0;r<4;r++)!1===e.board[r].isFull()&&(e.remaining.get(z.ZERO).get()>0&&this.displayableArrow.push({x:r,player:z.ZERO}),e.remaining.get(z.ONE).get()>0&&this.displayableArrow.push({x:r,player:z.ONE}))}getCircleCenter(e,r,s){const i=this.SPACE_SIZE/2,o=this.SPACE_SIZE/2;if(1===s.count(pe.NONE))return new M(i,o);const c=s.count(pe.NONE),u=2*r*Math.PI/c-Math.PI/2,h=.3*this.SPACE_SIZE,p=h*Math.cos(u),m=h*Math.sin(u);return new M(i+p,o+m)}canDisplayArrow(e,r){return this.displayableArrow.some(s=>s.x===e&&s.player.equals(r))}getArrowClasses(e,r){return[this.getPlayerClass(r)]}getBlockTransform(e){return"translate("+e*this.SPACE_SIZE+", "+((3-e)*this.SPACE_SIZE+.5*this.SPACE_SIZE)+")"}getSquareClasses(e){const r=["base"];return this.selectedPiece.isPresent()&&this.selectedPiece.get().square===e?r.push("selected-stroke"):this.movedSquare.includes(e)&&r.push("last-move-stroke"),r}onArrowClick(e,r){var s=this;return A(function*(){const o=s.canUserPlay("#dropArrow_"+(r===z.ZERO?"zero":"one")+"_"+e);if(o.isFailure())return s.cancelMove(o.getReason());const c=bn.from(e);let u;if(s.selectedPiece.isPresent()){const p=s.selectedPiece.get().square;u=B1.transfer(bn.from(p),c).get()}else u=B1.drop(c,r);const h=s.getState();return s.chooseMove(u,h)})()}getPieceClasses(e,r,s){const i={square:e,piece:r},o=[];let c=s.count(z.ZERO),u=s.count(z.ONE);if(this.selectedPiece.equalsValue(i))o.push("selected-stroke");else if(this.droppedPiece.equalsValue(i))o.push("last-move-stroke");else if(this.leftPiece.isPresent()&&this.leftPiece.get().square===e){if(this.leftPiece.get().piece===r)return o.push("captured-stroke"),o;this.getState().getCurrentOpponent()===z.ZERO?c++:u++}const h=s.count(pe.NONE)-(u+c),p=this.getPieceColor(r,c,h);return""!==p&&o.push(p),o}getPieceColor(e,r,s){return e<r?"player0-fill":e>=r+s?"player1-fill":""}onSquareClick(e){var r=this;return A(function*(){const s=r.canUserPlay("#square_"+e);if(s.isFailure())return r.cancelMove(s.getReason());if(r.selectedPiece.isPresent()&&r.selectedPiece.get().square===e)return r.cancelMoveAttempt(),G.SUCCESS;const i=r.getState().getCurrentPlayer(),o=r.board[e];return o.count(i)<=0?r.cancelMove(C9.NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE()):(r.selectedPiece=P.of({square:e,piece:r.getLowestPlayerPiece(o,i)}),0===r.showAndGetPossibleTranfers().length?r.cancelMove(C9.NO_POSSIBLE_TRANSFER_REMAINS()):G.SUCCESS)})()}showAndGetPossibleTranfers(){this.displayableArrow=[];let e=this.selectedPiece.get().square-1;const r=this.getState().getCurrentPlayer();for(;0<=e;)!1===this.board[e].isFull()&&this.displayableArrow.push({x:e,player:r}),e--;return this.displayableArrow}getRemainingPieceCx(e){return(e+.5)*this.PIECE_RADIUS*1.5}}return n.\u0275fac=function(e){return new(e||n)(J(Pn))},n.\u0275cmp=gt({type:n,selectors:[["app-apagos"]],features:[l],decls:6,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["class","base mid-stroke player1-fill",4,"ngFor","ngForOf"],["class","base mid-stroke player0-fill",4,"ngFor","ngForOf"],["id","board"],[4,"ngFor","ngForOf"],[1,"base","mid-stroke","player1-fill"],[1,"base","mid-stroke","player0-fill"],["class","base mid-stroke",3,"id","ngClass","click",4,"ngIf"],["x","0","y","0",1,"base","mid-stroke",3,"id","ngClass","click"],[1,"base","mid-stroke",3,"id","ngClass","click"],["r","10",1,"base","mid-stroke",3,"id","ngClass","click"]],template:function(e,r){1&e&&(F(),b(0,"svg",0)(1,"g"),x(2,i4t,1,3,"circle",1),x(3,o4t,1,3,"circle",2),O(),b(4,"g",3),x(5,u4t,5,8,"g",4),O()()),2&e&&(D("viewBox",-r.STROKE_WIDTH/2+" "+-r.STROKE_WIDTH/2+" "+(r.BOARD_WIDTH+r.STROKE_WIDTH)+" "+(r.BOARD_HEIGHT+r.STROKE_WIDTH)),S(1),D("transform","rotate("+180*r.role.value+" "+r.BOARD_WIDTH/2+" "+r.BOARD_HEIGHT/2+")"),S(1),T("ngForOf",r.ArrayUtils.range(r.remainingOne)),S(1),T("ngForOf",r.ArrayUtils.range(r.remainingZero)),S(2),T("ngForOf",r.board))},dependencies:[dn,An,en],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})(),to=(()=>{class n extends t8{getViewBox(){return-.5*this.STROKE_WIDTH+" "+-.5*this.STROKE_WIDTH+" "+(this.board.length*this.SPACE_SIZE+this.STROKE_WIDTH)+" "+(this.board[0].length*this.SPACE_SIZE+this.STROKE_WIDTH)}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=Dr(n)))(r||n)}}(),n.\u0275cmp=gt({type:n,selectors:[["ng-component"]],features:[l],decls:0,vars:0,template:function(e,r){},encapsulation:2}),n})();class no extends es{constructor(t,e,r){super(t,e),this.captured=r}static getInitialState(){const t=Ke.createTable(6,2,4);return new no(t,0,[0,0])}getCapturedCopy(){return[this.captured[0],this.captured[1]]}}let EH=(()=>{class n{}return n.CANNOT_DISTRIBUTE_FROM_OPPONENT_HOME=()=>$localize`You cannot distribute from the opponent's home.`,n.MUST_CHOOSE_NON_EMPTY_HOUSE=()=>$localize`You should choose a non-empty house to distribute.`,n.SHOULD_DISTRIBUTE=()=>$localize`You should distribute but you do not.`,n})(),z4=(()=>{class n extends U1{applyLegalMove(e,r,s){X(n.VERBOSE,{called:"AwaleRules.applyLegalMove",move:e,state:r});const i=e.x,o=r.getCurrentPlayer(),u=r.getCurrentOpponent().value,h=r.getCopiedBoard(),p=n.distribute(i,u,h),m=p[p.length-1];return m.y===u?new no(h,r.turn+1,r.captured):this.applyPotentialCapture(o,m,h,r)}applyPotentialCapture(e,r,s,i){const o=i.getCurrentOpponent(),c=[i.captured[0],i.captured[1]],u=n.captureIfLegal(r.x,r.y,e,s);c[e.value]+=u.capturedSum;const h=u.resultingBoard;if(n.mustMansoon(e,h)){const p=n.mansoon(o,h);return c[o.value]+=p.capturedSum,new no(p.resultingBoard,i.turn+1,c)}return new no(h,i.turn+1,c)}static mustMansoon(e,r){return n.isStarving(e,r)&&!1===n.canDistribute(e.getOpponent(),r)}static mansoon(e,r){const s=Ke.copyBiArray(r);let i=0;const o=[[0,0,0,0,0,0],[0,0,0,0,0,0]];let c=0;const u=e.getOpponent().value;do{i+=s[u][c],o[u][c]=s[u][c],s[u][c]=0,c++}while(c<6);return{capturedSum:i,captureMap:o,resultingBoard:s}}static isLegal(e,r){const s=r.getCurrentOpponent(),i=s.value,o=e.x;if(0===r.getPieceAtXY(o,i))return U.failure(EH.MUST_CHOOSE_NON_EMPTY_HOUSE());const c=n.isStarving(s,r.board),u=!1===n.doesDistribute(o,i,r.board);return c&&u?U.failure(EH.SHOULD_DISTRIBUTE()):U.success(void 0)}isLegal(e,r){return n.isLegal(e,r)}static doesDistribute(e,r,s){return 0===r?s[r][e]>5-e:s[r][e]>e}static canDistribute(e,r){for(let s=0;s<6;s++)if(n.doesDistribute(s,e.getOpponent().value,r))return!0;return!1}static isStarving(e,r){let s=0;const i=e.getOpponent().value;do{if(r[i][s++]>0)return!1}while(s<6);return!0}static distribute(e,r,s){const i=e,o=r;let c=s[r][e];const u=[];for(s[r][e]=0;c>0;)0===r?5===e?r=1:e++:0===e?r=0:e--,(e!==i||r!==o)&&(s[r][e]+=1,u.push(new M(e,r)),c--);return u}static capture(e,r,s,i){const o=Ke.copyBiArray(i);ve(r!==s.getOpponent().value,"AwaleRules.capture cannot capture the players house");let u=o[r][e],h=0;const p=[[0,0,0,0,0,0],[0,0,0,0,0,0]];if(u<2||u>3)return{capturedSum:0,captureMap:p,resultingBoard:o};let m=-1,C=-1;s===z.ONE&&(m=1,C=6);do{p[r][e]=u,h+=u,o[r][e]=0,u=o[r][e+=m]}while(e!==C&&(2===u||3===u));return{capturedSum:h,captureMap:p,resultingBoard:o}}static captureIfLegal(e,r,s,i){const o=Ke.copyBiArray(i),c=n.capture(e,r,s,i),u=n.isStarving(s.getOpponent(),c.resultingBoard);return c.capturedSum>0&&u?{capturedSum:0,resultingBoard:o,captureMap:[[0,0,0,0,0,0],[0,0,0,0,0,0]]}:c}static getGameStatus(e){const r=e.gameState;return r.captured[0]>24?xe.ZERO_WON:r.captured[1]>24?xe.ONE_WON:24===r.captured[0]&&24===r.captured[1]?xe.DRAW:xe.ONGOING}getGameStatus(e){return n.getGameStatus(e)}}return n.VERBOSE=!1,n})();class v1 extends Gi{constructor(t){super(),this.x=t}static from(t){switch(t){case 0:return v1.ZERO;case 1:return v1.ONE;case 2:return v1.TWO;case 3:return v1.THREE;case 4:return v1.FOUR;default:return ve(5===t,"Invalid x for AwaleMove: "+t),v1.FIVE}}equals(t){return t===this||t.x===this.x}toString(){return"AwaleMove("+this.x+")"}}v1.ZERO=new v1(0),v1.ONE=new v1(1),v1.TWO=new v1(2),v1.THREE=new v1(3),v1.FOUR=new v1(4),v1.FIVE=new v1(5),v1.encoder=new class extends Cn{maxValue(){return 5}encodeNumber(n){return n.x}decodeNumber(n){return v1.from(n)}};class h4t extends G1{getListMoves(t){const e=[],r=t.gameState,i=(r.turn+1)%2;let o,c=0;do{0!==r.getPieceAtXY(c,i)&&(o=v1.from(c),z4.isLegal(o,r).isSuccess()&&(o=v1.from(c),e.push(o))),c++}while(c<6);return this.orderMoves(t,e)}orderMoves(t,e){const r=t.gameState.getCurrentPlayer(),s=t.gameState.getCurrentOpponent().value,i=r.value;return Ke.sortByDescending(e,o=>{const c=t.gameState.getCopiedBoard(),u=c[s][o.x],h=z4.distribute(o.x,s,c),p=h[h.length-1];let m,C=0;return p.y===s?(m=0,u<=6&&(C=10)):m=z4.captureIfLegal(p.x,i,r,c).capturedSum,100*m+C-u}),e}getBoardValue(t){const e=z4.getGameStatus(t);if(e.isEndGame)return Ct.fromWinner(e.winner);const s=t.gameState.getCapturedCopy();return new Ct(s[1]-s[0])}}class Uce extends K1{constructor(){super(...arguments),this.tutorial=[ce.anyMove($localize`Sowing`,$localize`Awal is a game of distribution (sowing) and capture. Its goal is to capture the most seeds.
         Let's see how seeds are sown. The spaces in Awal are called the houses.
         As you're playing Dark, the 6 houses on the bottom are yours.<br/><br>
         Click on any of the bottom houses to sow the seeds it contains: they will be sown clockwise, one seed per house.`,no.getInitialState(),v1.ZERO,$localize`Look at the 4 houses that follow clockwise the one you picked, they now contain 5 seeds.
        This is how seeds are sown:
        one by one from the house next to the one they come from, clockwise.`),ce.anyMove($localize`Big sowing`,$localize`When there are enough seeds to make a full turn, something else happens.<br/><br/>
        You're playing Dark.
        Sow the house that contains 12 seeds.`,new no([[0,0,0,0,0,0],[0,12,0,0,0,0]],0,[0,0]),v1.ONE,$localize`See, the house that you sowed has not been refilled, and the sowing immediately continued to the next house (which therefore contains two seeds).`),ce.fromMove($localize`Simple capture`,$localize`After sowing, if the last seed falls in an opponent's house and if there is now two or three seeds in this house, the player captures these two or three seeds.<br/><br/>You're playing Dark, do a capture!`,new no([[0,1,0,0,1,0],[2,0,0,0,1,0]],0,[0,0]),[v1.ZERO],$localize`Well done! This was a simple capture, now let us see how to make multiple captures.`,$localize`Failed. Try again and sow from the leftmost house.`),ce.fromMove($localize`Multiple captures`,$localize`By sowing from your leftmost house, you will end in the opponent's second leftmost house, which contains now 3, so this will be a capture. But now, the house right before it contains 2, which is also capturable, so, that house will get captured as well!<br/><br/>You're playing Dark, do a capture!`,new no([[2,1,0,0,1,0],[2,0,0,0,1,0]],0,[0,0]),[v1.ZERO],$localize`Nice, you win 3 points from the first house, and 2 from the second!`,$localize`Failed. Try again.`),ce.fromMove($localize`Interrupted capture`,$localize`By clicking on your leftmost house, you end up on the 3rd house, which is capturable.<br/><br/>You're playing Dark, do a capture!`,new no([[1,0,1,0,0,1],[3,0,0,0,1,0]],0,[0,0]),[v1.ZERO],$localize`Notice that because the second house was not capturable, the capture was interrupted and you have not captured the first house.`,$localize`Failed. Try again.`),ce.fromMove($localize`Capture on the other side only`,$localize`You're playing Dark. Try to capture the two leftmost houses of the opponent.`,new no([[2,2,0,0,1,0],[1,3,0,0,0,0]],0,[0,0]),[v1.ONE],$localize`Congratulations! Notice that the capture was interrupted when entering your territory: you cannot capture your own houses!`,$localize`You have only captured one house, try again!`),ce.fromMove($localize`Do not starve`,$localize`You have a very nice capture that seems possible: it seems that you can capture all the opponent's seeds!<br/><br/>
        You're playing Dark. Try it.`,new no([[1,1,1,1,1,0],[5,0,0,1,0,0]],0,[0,0]),[v1.ZERO],$localize`Sadly, you cannot capture here, otherwise the opponent could not play after you.
        When this happens, the move can be made, but no capture takes place!`,$localize`Failed. Try again.`),ce.anyMove($localize`Feeding is mandatory`,$localize`You cannot let another player starve, meaning that if your opponent has no seeds anymore and if you can give them at least one, you have to do it.<br/><br/>You're playing Dark. Give a seed to your opponent!`,new no([[0,0,0,0,0,0],[0,1,2,4,4,5]],0,[0,0]),v1.THREE,$localize`Congratulations! Note that you can choose to give your opponent the least number of seeds if it is better for you.
        It is often a good way to have easy captures!`),ce.anyMove($localize`End of the game`,$localize`A game is won as soon as one player has captured 25 seeds, as that player has more than half of all the seeds.<br/><br/>You're playing Dark, sow the leftmost house.`,new no([[4,4,3,2,1,0],[1,0,0,0,0,0]],0,[0,0]),v1.ZERO,$localize`Also, as soon as on player cannot play, the other player captures all the seeds in its own side.
         Here, it was the first player's turn, and the second player has taken all the remaining seeds.`)]}}function d4t(n,t){if(1&n){const e=Oe();F(),b(0,"text",7),ee("click",function(){he(e);const s=v().index,i=v().index;return le(v().onClick(s,i))}),Tt(1),O()}if(2&n){const e=v().index,r=v().index,s=v();We("id","captured_",e,"_",r,""),D("x",65+100*e)("y",81+120*r)("transform",s.getPieceRotation(e,r)),S(1),Z2(" ",-s.captured[r][e]," ")}}function p4t(n,t){if(1&n){const e=Oe();F(),b(0,"g")(1,"circle",4),ee("click",function(){const i=he(e).index,o=v().index;return le(v().onClick(i,o))}),O(),b(2,"text",5),ee("click",function(){const i=he(e).index,o=v().index;return le(v().onClick(i,o))}),Tt(3),O(),x(4,d4t,2,6,"text",6),O()}if(2&n){const e=t.$implicit,r=t.index,s=v().index,i=v();S(1),We("id","click_",r,"_",s,""),T("ngClass",i.getSpaceClasses(r,s)),D("cx",i.getPieceCx(r))("cy",i.getPieceCy(s)),S(1),We("id","number_",r,"__",s,""),D("x",50+100*r)("y",66+120*s)("transform",i.getPieceRotation(r,s)),S(1),Z2(" ",e," "),S(1),T("ngIf",i.captured[s][r]>0)}}function g4t(n,t){if(1&n&&(F(),b(0,"g"),x(1,p4t,5,12,"g",2),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e)}}let m4t=(()=>{class n extends to{constructor(e){super(e),this.last=P.empty(),this.captured=[[0,0,0,0,0,0],[0,0,0,0,0,0]],this.filledCoords=[],this.hasAsymetricBoard=!0,this.scores=P.of([0,0]),this.rules=new z4(no),this.availableMinimaxes=[new h4t(this.rules,"AwaleMinimax")],this.encoder=v1.encoder,this.tutorial=(new Uce).tutorial,this.updateBoard()}updateBoard(){const e=this.getState();this.scores=P.of(e.getCapturedCopy()),this.hidePreviousMove();const r=this.rules.node.move;if(this.board=e.getCopiedBoard(),r.isPresent()){const s=e.getCurrentPlayer().value;this.last=P.of(new M(r.get().x,s)),this.showPreviousMove()}else this.last=P.empty()}hidePreviousMove(){this.captured=[[0,0,0,0,0,0],[0,0,0,0,0,0]],this.filledCoords=[]}showPreviousMove(){const e=this.rules.node.move.get(),r=this.rules.node.mother.get().gameState,s=Ke.copyBiArray(r.board),i=r.getCurrentOpponent().value;this.filledCoords=z4.distribute(e.x,i,s);const o=this.filledCoords[this.filledCoords.length-1];if(o.y!==i){const c=z4.captureIfLegal(o.x,o.y,r.getCurrentPlayer(),s);this.captured=c.captureMap;const u=this.getState().getCurrentPlayer();z4.mustMansoon(u.getOpponent(),c.resultingBoard)&&(this.captured=z4.mansoon(u,c.resultingBoard).captureMap)}}onClick(e,r){var s=this;return A(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());if(r===s.getState().getCurrentPlayer().value)return s.cancelMove(EH.CANNOT_DISTRIBUTE_FROM_OPPONENT_HOME());s.last=P.empty();const o=v1.from(e);return s.chooseMove(o,s.getState())})()}getSpaceClasses(e,r){const s=new M(e,r),i="player"+(r+1)%2+"-fill";return this.captured[r][e]>0?["captured-fill","moved-stroke"]:this.last.equalsValue(s)?["moved-stroke","last-move-stroke",i]:this.filledCoords.some(o=>o.equals(s))?["moved-stroke",i]:[i]}getPieceCx(e){return 50+100*e}getPieceCy(e){return 50+120*e}getPieceRotation(e,r){return"rotate("+180*this.role.value+" "+this.getPieceCx(e)+" "+this.getPieceCy(r)+")"}}return n.\u0275fac=function(e){return new(e||n)(J(Pn))},n.\u0275cmp=gt({type:n,selectors:[["app-awale-component"]],features:[l],decls:4,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-45 -20 700 260","preserveAspectRatio","xMidYMid meet"],["x","-40","y","-15","ry","115","rx","115","width","680","height","250","fill","blue",1,"base"],[4,"ngFor","ngForOf"],["x1","-40","y1","110","x2","640","y2","110",1,"base"],["r","46",1,"base",3,"id","ngClass","click"],[1,"text-big","text-center",3,"id","click"],["class","text-20 text-center",3,"id","click",4,"ngIf"],[1,"text-20","text-center",3,"id","click"]],template:function(e,r){1&e&&(F(),b(0,"svg",0),Q(1,"rect",1),x(2,g4t,2,1,"g",2),Q(3,"line",3),O()),2&e&&(D("transform",r.rotation),S(2),T("ngForOf",r.board))},dependencies:[dn,An,en],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class Lc extends Gi{constructor(t,e){super(),this.first=t,this.second=e}static getEncoder(t){return new class extends mi{encodeMove(e){return{first:M.encoder.encode(e.first),second:M.encoder.encode(e.second)}}decodeMove(e){ve(null!=Me.getNonNullable(e).first,"Encoded MoveWithTwoCoords should contain a first coord"),ve(null!=Me.getNonNullable(e).second,"Encoded MoveWithTwoCoords should contain a second coord");const r=M.encoder.decode(Me.getNonNullable(e).first),s=M.encoder.decode(Me.getNonNullable(e).second);return t(r,s).get()}}}getFirst(){return this.first}getSecond(){return this.second}}class r8 extends Lc{constructor(t,e){if(super(t,e),t.equals(e))throw new Error(tt.MOVE_CANNOT_BE_STATIC())}length(){return this.getStart().getDistance(this.getEnd())}getDirection(){return Ne.factory.fromMove(this.getStart(),this.getEnd())}getStart(){return this.getFirst()}getEnd(){return this.getSecond()}}let gP=(()=>{class n{}return n.LANDING_ON_OCCUPIED_SQUARE=()=>$localize`You cannot land on an occupied square.`,n.THRONE_IS_LEFT_FOR_GOOD=()=>$localize`Once you left the central throne, you cannot return to it.`,n.SOLDIERS_CANNOT_SIT_ON_THRONE=()=>$localize`Soldiers cannot sit on the throne.`,n.MOVE_MUST_BE_ORTHOGONAL=()=>$localize`Tafl moves must be orthogonal.`,n})();class MH extends r8{constructor(t,e){if(super(t,e),t.isNotInRange(this.getMaximalDistance(),this.getMaximalDistance()))throw new Error("Starting coord of TaflMove must be on the board, not at "+t.toString()+".");if(e.isNotInRange(this.getMaximalDistance(),this.getMaximalDistance()))throw new Error("Landing coord of TaflMove must be on the board, not at "+e.toString()+".");const r=t.getDirectionToward(e);if(r.isFailure()||r.get().isDiagonal())throw new Error(gP.MOVE_MUST_BE_ORTHOGONAL())}equals(t){return t===this||!1!==t.getStart().equals(this.getStart())&&t.getEnd().equals(this.getEnd())}toString(){return"TaflMove("+this.getStart()+"->"+this.getEnd()+")"}}class ko extends MH{static of(t,e){return new ko(t,e)}static from(t,e){try{const r=new ko(t,e);return U.success(r)}catch(r){return U.failure(r.message)}}getMaximalDistance(){return 7}}ko.encoder=Lc.getEncoder(ko.from);const _4t={CASTLE_IS_LEFT_FOR_GOOD:!0,BORDER_CAN_SURROUND_KING:!1,CENTRAL_THRONE_CAN_SURROUND_KING:!0,KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED:!0,WIDTH:7,INVADER:z.ZERO};class En{constructor(t,e){this.owner=t,this.king=e}isKing(){return this.king}getOwner(){return this.owner}}En.UNOCCUPIED=new En(pe.NONE,!1),En.PLAYER_ONE_KING=new En(pe.ONE,!0),En.INVADERS=new En(pe.ZERO,!1),En.DEFENDERS=new En(pe.ONE,!1);class X1{constructor(t){this.value=t}}X1.NONE=new X1("NONE"),X1.OPPONENT=new X1("OPPONENT"),X1.PLAYER=new X1("PLAYER");class SH extends es{isCentralThrone(t){return t.equals(this.getCentralThrone())}getCentralThrone(){const t=(this.board.length-1)/2;return new M(t,t)}getRelativeOwner(t,e){const r=this.getAbsoluteOwner(e);let s;return s=r===pe.NONE?X1.NONE:t===r?X1.PLAYER:X1.OPPONENT,s}getAbsoluteOwner(t){return this.getPieceAt(t).getOwner()}}class k3 extends SH{static getInitialState(){const t=En.UNOCCUPIED,e=En.INVADERS,r=En.DEFENDERS;return new k3([[t,t,t,e,t,t,t],[t,t,t,e,t,t,t],[t,t,t,r,t,t,t],[e,e,r,En.PLAYER_ONE_KING,r,e,e],[t,t,t,r,t,t,t],[t,t,t,e,t,t,t],[t,t,t,e,t,t,t]],0)}from(t,e){return new k3(t,e)}}let PH=(()=>{class n extends U1{constructor(e,r,s){super(e),this.config=r,this.generateMove=s}isLegal(e,r){X(n.VERBOSE,{tablutRules_isLegal:{move:e,state:r}});const s=r.getCurrentPlayer(),i=this.getMoveValidity(s,e,r);return i.isFailure()?U.failure(i.getReason()):U.success(void 0)}getMoveValidity(e,r,s){const i=s.getRelativeOwner(e,r.getStart());if(i===X1.NONE)return G.failure(tt.MUST_CHOOSE_PLAYER_PIECE());if(i===X1.OPPONENT)return G.failure(tt.CANNOT_CHOOSE_OPPONENT_PIECE());if(s.getRelativeOwner(e,r.getEnd())!==X1.NONE)return G.failure(gP.LANDING_ON_OCCUPIED_SQUARE());if(this.isThrone(s,r.getEnd())){if(!s.getPieceAt(r.getStart()).isKing())return G.failure(gP.SOLDIERS_CANNOT_SIT_ON_THRONE());if(s.isCentralThrone(r.getEnd())&&this.config.CASTLE_IS_LEFT_FOR_GOOD)return G.failure(gP.THRONE_IS_LEFT_FOR_GOOD())}const c=r.getStart().getDirectionToward(r.getEnd()).get(),u=r.getStart().getOrthogonalDistance(r.getEnd());let h=r.getStart().getNext(c);for(let p=1;p<u;p++){if(s.getPieceAt(h)!==En.UNOCCUPIED)return G.failure(tt.SOMETHING_IN_THE_WAY());h=h.getNext(c)}return G.SUCCESS}isThrone(e,r){return!!this.isExternalThrone(r)||e.isCentralThrone(r)}isExternalThrone(e){const r=this.config.WIDTH-1;return!(0!==e.x&&e.x!==r||0!==e.y&&e.y!==r)}tryCapture(e,r,s,i){const o=r.getNext(s);return o.isInRange(this.config.WIDTH,this.config.WIDTH)&&i.getRelativeOwner(e,o)===X1.OPPONENT?i.getPieceAt(o).isKing()?this.captureKing(e,r,s,i):this.capturePawn(e,r,s,i):P.empty()}captureKing(e,r,s,i){const o=r.getNext(s),{backCoord:c,back:u,backInRange:h,left:p,leftCoord:m,right:C,rightCoord:w}=this.getSurroundings(o,s,e,i);return!1===h?this.captureKingAgainstTheWall(p,C,o):u===X1.NONE&&this.isThrone(i,c)?this.captureKingAgainstThrone(c,o,p,C):u===X1.PLAYER?this.captureKingWithAtLeastASandwich(i,o,p,m,C,w):P.empty()}getSurroundings(e,r,s,i){const o=e.getNext(r),c=o.isInRange(this.config.WIDTH,this.config.WIDTH),u=c?i.getRelativeOwner(s,o):X1.NONE,h=e.getLeft(r),m=h.isInRange(this.config.WIDTH,this.config.WIDTH)?i.getRelativeOwner(s,h):X1.NONE,C=e.getRight(r),I=C.isInRange(this.config.WIDTH,this.config.WIDTH)?i.getRelativeOwner(s,C):X1.NONE;return{backCoord:o,back:u,backInRange:c,leftCoord:h,left:m,rightCoord:C,right:I}}captureKingAgainstTheWall(e,r,s){let o=e===X1.PLAYER?1:0;return o+=r===X1.PLAYER?1:0,2===o&&this.config.BORDER_CAN_SURROUND_KING?(X(n.VERBOSE||!1,"king captured by 3 invaders against 1 border"),P.of(s)):P.empty()}captureKingAgainstThrone(e,r,s,i){if(this.isExternalThrone(e)){if(this.config.KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED)return P.of(r)}else{const c=i===X1.PLAYER,u=s===X1.PLAYER||c;if(this.config.CENTRAL_THRONE_CAN_SURROUND_KING&&u)return P.of(r)}return P.empty()}capturePawn(e,r,s,i){const c=r.getNext(s),u=c.getNext(s);let h=X1.NONE;return u.isInRange(this.config.WIDTH,this.config.WIDTH)&&(h=i.getRelativeOwner(e,u)),h===X1.NONE?!1===this.isThrone(i,u)?(X(n.VERBOSE||!1,"cannot capture a pawn without an ally; "+c+"threatened by "+e+"'s pawn in "+r+" coming from this direction ("+s.x+", "+s.y+")cannot capture a pawn without an ally behind"),P.empty()):(X(n.VERBOSE||!1,"pawn captured by 1 opponent and 1 throne; "+c+"threatened by "+e+"'s pawn in "+r+" coming from this direction ("+s.x+", "+s.y+")"),P.of(c)):h===X1.PLAYER?(X(n.VERBOSE||!1,"pawn captured by 2 opponents; "+c+"threatened by "+e+"'s pawn in "+r+" coming from this direction ("+s.x+", "+s.y+")"),P.of(c)):(X(n.VERBOSE||!1,"no captures; "+c+"threatened by "+e+"'s pawn in "+r+" coming from this direction ("+s.x+", "+s.y+")"),P.empty())}captureKingWithAtLeastASandwich(e,r,s,i,o,c){if(!1===this.kingTouchCentralThrone(e,r)&&this.config.KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED)return P.of(r);const h=this.config.CENTRAL_THRONE_CAN_SURROUND_KING,p=this.isThrone(e,i),m=s===X1.PLAYER||p&&h,C=this.isThrone(e,c);return m&&(o===X1.PLAYER||C&&h)?(X(n.VERBOSE||!1,"king captured by 4 invaders"),P.of(r)):P.empty()}kingTouchCentralThrone(e,r){const s=e.getCentralThrone();return r.getOrthogonalDistance(s)<=1}applyLegalMove(e,r){X(n.VERBOSE,{TablutRules_applyLegalMove:{move:e,state:r}});const s=r.turn,i=r.getCopiedBoard(),o=r.getCurrentPlayer(),c=e.getStart(),u=e.getEnd();i[u.y][u.x]=i[c.y][c.x],i[c.y][c.x]=En.UNOCCUPIED;for(const h of Fe.ORTHOGONALS){const p=this.tryCapture(o,e.getEnd(),h,r);p.isPresent()&&(i[p.get().y][p.get().x]=En.UNOCCUPIED)}return r.from(i,s+1)}getGameStatus(e){const s=this.getWinner(e.gameState);return s.isPresent()?xe.getVictory(s.get()):xe.ONGOING}getWinner(e){const s=this.getKingCoord(e);if(s.isAbsent())return X(!1,"The king is dead, victory to invader"),P.of(this.getInvader());const i=s.get();return this.isExternalThrone(i)?(X(!1,"The king escape, victory to defender"),P.of(this.getDefender())):this.isPlayerImmobilized(z.ZERO,e)?(X(!1,"Zero has no move, victory to one"),P.of(z.ONE)):this.isPlayerImmobilized(z.ONE,e)?(X(!1,"One has no move, victory to zero"),P.of(z.ZERO)):(X(!1,"no victory"),P.empty())}getKingCoord(e){X(n.VERBOSE,{TablutRules_getKingCoord:{state:e,con:this.config}});for(let r=0;r<this.config.WIDTH;r++)for(let s=0;s<this.config.WIDTH;s++)if(e.getPieceAtXY(s,r).isKing())return P.of(new M(s,r));return P.empty()}getInvader(){return this.config.INVADER}getDefender(){return this.config.INVADER.getOpponent()}isPlayerImmobilized(e,r){return 0===this.getPlayerListMoves(e,r).length}getPlayerListMoves(e,r){const i=[],o=this.getPlayerListPawns(e,r);X(n.VERBOSE||!1,{TablutRules_getPlayerListMoves:{player:e,state:r}});for(const c of o){const u=this.getPossibleDestinations(c,r);for(const h of u){const p=this.generateMove(c,h);i.push(p)}}return i}getPlayerListPawns(e,r){const s=[];for(let i=0;i<this.config.WIDTH;i++)for(let o=0;o<this.config.WIDTH;o++){const c=new M(o,i);r.getAbsoluteOwner(c)===e&&s.push(c)}return s}getPossibleDestinations(e,r){const s=[];let i;for(const o of Fe.ORTHOGONALS){i=e.getNext(o,1);let c=!1;for(;i.isInRange(this.config.WIDTH,this.config.WIDTH)&&!1===c;)r.getAbsoluteOwner(i)===pe.NONE?this.isExternalThrone(i)?r.getPieceAt(e).isKing()&&s.push(i):r.isCentralThrone(i)?r.getPieceAt(e).isKing()&&!1===this.config.CASTLE_IS_LEFT_FOR_GOOD&&s.push(i):s.push(i):c=!0,i=i.getNext(o,1)}return s}}return n.VERBOSE=!1,n})();class M5 extends PH{constructor(){super(k3,_4t,ko.of)}static get(){return null==M5.singleton&&(M5.singleton=new M5),$1.ruler=this.singleton,M5.singleton}}class TH extends to{constructor(t,e,r){super(t),this.VERBOSE=e,this.generateMove=r,this.viewInfo={pieceClasses:[]},this.EMPTY=En.UNOCCUPIED,this.capturedCoords=[],this.chosen=P.empty(),this.lastMove=P.empty()}getViewBox(){const t=-this.STROKE_WIDTH,e=this.rules.config.WIDTH*this.SPACE_SIZE+2*this.STROKE_WIDTH;return t+" "+t+" "+e+" "+e}updateBoard(){X(this.VERBOSE,"taflComponent.updateBoard"),this.lastMove=this.rules.node.move,this.board=this.getState().getCopiedBoard(),this.capturedCoords=[],this.lastMove.isPresent()&&this.showPreviousMove(),this.updateViewInfo()}showPreviousMove(){const t=this.rules.node.mother.get().gameState,e=this.getState().getCurrentOpponent();for(const r of Fe.ORTHOGONALS){const s=this.lastMove.get().getEnd().getNext(r,1);if(s.isInRange(this.rules.config.WIDTH,this.rules.config.WIDTH)){const o=t.getRelativeOwner(e,s)===X1.OPPONENT,u=this.getState().getPieceAt(s)===En.UNOCCUPIED;o&&u&&this.capturedCoords.push(s)}}}updateViewInfo(){const t=[];for(let e=0;e<this.board.length;e++){const r=[];for(let s=0;s<this.board[0].length;s++){let i=[];i=this.board[e][s].getOwner()===pe.NONE?[""]:this.getPieceClasses(s,e),r.push(i)}t.push(r)}this.viewInfo={pieceClasses:t}}onClick(t,e){var r=this;return A(function*(){X(r.VERBOSE,"TaflComponent.onClick("+t+", "+e+")");const s=r.canUserPlay("#click_"+t+"_"+e);if(s.isFailure())return r.cancelMove(s.getReason());const i=new M(t,e);return r.chosen.equalsValue(i)?(r.cancelMoveAttempt(),G.SUCCESS):r.chosen.isAbsent()||r.pieceBelongToCurrentPlayer(i)?r.choosePiece(i):r.chooseDestination(t,e)})()}chooseDestination(t,e){var r=this;return A(function*(){X(r.VERBOSE,"TaflComponent.chooseDestination");const s=r.chosen.get(),i=new M(t,e),o=r.generateMove(s,i);return o.isSuccess()?yield r.chooseMove(o.get(),r.getState()):r.cancelMove(o.getReason())})()}choosePiece(t){return X(this.VERBOSE,"TaflComponent.choosePiece"),this.board[t.y][t.x]===En.UNOCCUPIED?this.cancelMove(tt.MUST_CHOOSE_PLAYER_PIECE()):this.pieceBelongToCurrentPlayer(t)?(this.chosen=P.of(t),this.updateViewInfo(),X(this.VERBOSE,"selected piece = ("+t.x+", "+t.y+")"),G.SUCCESS):this.cancelMove(tt.CANNOT_CHOOSE_OPPONENT_PIECE())}pieceBelongToCurrentPlayer(t){const e=this.getState(),r=e.getCurrentPlayer();return e.getRelativeOwner(r,t)===X1.PLAYER}cancelMoveAttempt(){this.chosen=P.empty(),this.updateViewInfo()}isThrone(t,e){const r=this.getState();return this.rules.isThrone(r,new M(t,e))}isCentralThrone(t,e){return this.getState().isCentralThrone(new M(t,e))}getPieceClasses(t,e){const r=[],s=new M(t,e),i=this.getState().getAbsoluteOwner(s);return r.push(this.getPlayerClass(i)),this.chosen.equalsValue(s)&&r.push("selected-stroke"),r}getRectClasses(t,e){const r=[],s=new M(t,e);if(this.capturedCoords.some(i=>i.equals(s)))r.push("captured-fill");else if(this.lastMove.isPresent()){const i=this.lastMove.get().getStart(),o=this.lastMove.get().getEnd();(s.equals(i)||s.equals(o))&&r.push("moved-fill")}return r}getClickables(){const t=[];for(let e=0;e<this.board.length;e++)for(let r=0;r<this.board[e].length;r++){const s=new M(r,e);this.isClickable(s)&&t.push(s)}return t}isClickable(t){return this.pieceBelongToCurrentPlayer(t)}isInvader(t,e){return this.board[e][t]===En.INVADERS}isKing(t,e){return this.board[e][t].isKing()}}class mP extends G1{getListMoves(t){X(!1,{TaflMinimax_getListMoves:{node:t}});const r=t.gameState,s=r.getCurrentPlayer(),i=this.ruler.getPlayerListMoves(s,r);return this.orderMoves(r,i)}orderMoves(t,e){const r=this.ruler.getKingCoord(t).get();return t.getCurrentPlayer()===this.ruler.config.INVADER?Ke.sortByDescending(e,s=>-s.getEnd().getOrthogonalDistance(r)):Ke.sortByDescending(e,s=>s.getStart().equals(r)?this.ruler.isExternalThrone(s.getEnd())?2:1:0),e}getBoardValue(t){const e=t.gameState,r=this.ruler.getWinner(e);if(r.isPresent())return new Ct(r.get().getVictoryValue());const s=this.ruler.getPlayerListPawns(z.ZERO,e).length,i=this.ruler.getPlayerListPawns(z.ONE,e).length;return Ct.from(s*[1,2][this.ruler.config.INVADER.value],i*[2,1][this.ruler.config.INVADER.value])}}class _P{constructor(t,e){this.directThreats=t,this.mover=e}equals(t){return t.directThreats.equals(this.directThreats)&&t.mover.equals(this.mover)}}class Gce extends _P{constructor(t,e){super(new Dt([t]),e),this.directThreat=t,this.mover=e}}class v4t extends Dt{constructor(t){if(super(),this.valueMap=[],this.values=[],void 0!==t)for(const e of t)this.add(e)}add(t){const e=this.toFields(t);let r=this.valueMap;for(const i of e[0])void 0===r[i]&&(r[i]=[]),r=r[i];const s=e[1];return void 0===r[s]&&(r[s]=!0,this.values.push(t),!0)}contains(t){const e=this.toFields(t);let r=this.valueMap;for(const i of e[0]){if(void 0===r[i])return!1;r=r[i]}return void 0!==r[e[1]]}[Symbol.iterator](){return this.values.values()}}class Ar extends v4t{toFields(t){return[[t.y],t.x]}}class vP extends mP{constructor(t,e){super(t,e),this.width=this.ruler.config.WIDTH,this.maxInfluence=16*(2*this.width-2),this.scoreByThreatenedPiece=16*this.maxInfluence+1,this.scoreBySafePiece=16*this.scoreByThreatenedPiece+1}getBoardValue(t){const e=this.ruler.getGameStatus(t);if(e.isEndGame)return e.toBoardValue();const r=t.gameState,s=En.UNOCCUPIED;let i=0;const o=this.getPiecesMap(r),c=this.getThreatMap(r,o),u=this.filterThreatMap(c,r);for(const h of z.PLAYERS)for(const p of o.get(h).get())if(u.get(p).isPresent())i+=h.getScoreModifier()*this.scoreByThreatenedPiece;else{i+=h.getScoreModifier()*this.scoreBySafePiece;let m=0;for(const C of Fe.ORTHOGONALS){let w=p.getNext(C,1);for(;w.isInRange(this.width,this.width)&&r.getPieceAt(w)===s;)m++,w=w.getNext(C,1)}i+=m*h.getScoreModifier()}return new Ct(i)}getPiecesMap(t){const e=En.UNOCCUPIED,r=[],s=[];for(let o=0;o<this.width;o++)for(let c=0;c<this.width;c++){const u=new M(c,o);t.getPieceAt(u)!==e&&(t.getAbsoluteOwner(u)===z.ZERO?r.push(u):s.push(u))}return new Vn([{key:z.ZERO,value:new Ar(r)},{key:z.ONE,value:new Ar(s)}])}getThreatMap(t,e){const r=new Vn;for(const s of z.PLAYERS)for(const i of e.get(s).get()){const o=this.getThreats(i,t);this.isThreatReal(i,t,o)&&r.set(i,new Dt(o))}return r}getThreats(t,e){const r=e.getAbsoluteOwner(t);ve(r.isPlayer(),"TaflPieceAndInfluenceMinimax.getThreats should be called with an occupied coordinate");const s=r.getOpponent(),i=[];for(const o of Fe.ORTHOGONALS){const c=t.getPrevious(o,1);if(this.isAThreat(c,e,s)){const u=[];for(const h of Fe.ORTHOGONALS){if(h===o.getOpposite())continue;let p=t.getNext(o,1);for(;p.isInRange(this.width,this.width)&&e.getPieceAt(p)===En.UNOCCUPIED;)p=p.getNext(h);p.isInRange(this.width,this.width)&&e.getAbsoluteOwner(p)===s&&!1===t.getNext(o,1).equals(p)&&u.push(p)}i.push(new Gce(c,new Ar(u)))}}return i}isAThreat(t,e,r){return!(t.isNotInRange(this.width,this.width)||e.getAbsoluteOwner(t)!==r&&(!this.ruler.isThrone(e,t)||r!==z.ONE&&e.getPieceAt(t)!==En.UNOCCUPIED))}isThreatReal(t,e,r){if(0===r.length)return!1;if(e.getPieceAt(t).isKing())return 3===r.length;for(const s of r)if(s.mover.size()>0)return!0;return!1}filterThreatMap(t,e){const r=new Vn,s=t.listKeys(),i=s.filter(c=>e.getAbsoluteOwner(c)===e.getCurrentPlayer()),o=new Ar(s.filter(c=>e.getAbsoluteOwner(c)===e.getCurrentOpponent()));for(const c of i){const u=t.get(c).get(),h=[];for(const p of u)if(!1===o.contains(p.directThreat)){const m=[];for(const C of p.mover)!1===o.contains(C)&&m.push(C);m.length>0&&h.push(new Gce(p.directThreat,new Ar(m)))}h.length>0&&r.set(c,new Dt(h))}for(const c of o){const u=t.get(c).get();r.set(c,u)}return r}}class CP extends vP{getBoardValue(t){const e=this.ruler.getGameStatus(t);if(e.isEndGame)return e.toBoardValue();const r=t.gameState,i=this.getControlScoreAndPieceScores(this.ruler.config.WIDTH,r);let o=i.controlScore;o+=i.safeScore*this.getScoreBySafePiece(r);const c=this.getScoreByThreatenedPiece(r);return o+=i.threatenedScore*c,ve(i.controlScore<=c,"Control Score should be below "+c+", got "+i.controlScore),ve(i.threatenedScore<=16,"Threatened Score should be below 16, got "+i.threatenedScore),ve(i.safeScore<=16,"Safe Score should be below 16, got "+i.threatenedScore),new Ct(o)}getControlScoreAndPieceScores(t,e){const r=this.getPiecesMap(e),s=this.getThreatMap(e,r),i=this.filterThreatMap(s,e),o={safeScore:0,threatenedScore:0,controlScore:0};for(const c of z.PLAYERS){const u=new Ar;for(const h of r.get(c).get())if(i.get(h).isPresent())o.threatenedScore+=c.getScoreModifier();else{o.safeScore+=c.getScoreModifier();for(const p of Fe.ORTHOGONALS){let m=h.getNext(p,1);for(;m.isInRange(t,t)&&e.getPieceAt(m)===En.UNOCCUPIED;)u.add(m),m=m.getNext(p,1)}}for(const h of u){const p=this.getControlledPieceValue(h.x,h.y,t);o.controlScore+=c.getScoreModifier()*p}}return o}getControlledPieceValue(t,e,r){let s=1;return(0===t||t===r-1)&&(s*=r),(0===e||e===r-1)&&(s*=r),s}getScoreByThreatenedPiece(t){const e=t.board.length,r=e-2;return 4*e*e+4*r*e+r*r}getScoreBySafePiece(t){return 16*this.getScoreByThreatenedPiece(t)+1}}class wH extends CP{getBoardValue(t){const e=this.ruler.getGameStatus(t);if(e.isEndGame)return e.toBoardValue();const r=t.gameState,i=this.getControlScoreAndPieceScores(this.ruler.config.WIDTH,r),o=r.getPieceAt(this.ruler.getKingCoord(r).get()).getOwner(),c=this.getStepForEscape(r)*o.getScoreModifier();if(-1===c)return new Ct(o.getOpponent().getPreVictory());const u=this.getScoreByThreatenedPiece(r);return ve(i.controlScore<=u,"Control Score should be bellow "+u+", got "+i.controlScore),ve(i.threatenedScore<=16,"Threatened Score should be bellow 16, got "+i.threatenedScore),ve(i.safeScore<=16,"Safe Score should be bellow 16, got "+i.threatenedScore),new Ct(-1*c*(u+1)*17*17+i.safeScore*(u+1)*17+i.threatenedScore*(u+1)+i.controlScore)}getStepForEscape(t){const e=this.ruler.getKingCoord(t).get();return this._getStepForEscape(t,1,[e],[]).getOrElse(-1)}_getStepForEscape(t,e,r,s){const i=this.getNextGen(t,r,s);return 0===i.length?P.empty():i.some(o=>this.ruler.isExternalThrone(o))?P.of(e):(e++,s.push(...i),this._getStepForEscape(t,e,i,s))}getNextGen(t,e,r){const s=[];for(const i of e)for(const o of Fe.ORTHOGONALS){let c=i.getNext(o,1);for(;c.isInRange(this.ruler.config.WIDTH,this.ruler.config.WIDTH)&&t.getPieceAt(c)===En.UNOCCUPIED;)r.every(u=>!1===u.equals(c))&&s.push(c),c=c.getNext(o,1)}return s}}const ne=En.UNOCCUPIED,Q1=En.INVADERS,da=En.DEFENDERS,Dm=En.PLAYER_ONE_KING;class Wce extends K1{constructor(){super(...arguments),this.tutorial=[ce.informational($localize`Goal of the game`,$localize`Brandhub is the Irish version of the Tafl, Tafl being a family of viking strategy game. The goal of the game is different for each player. The attacker plays first. Their pieces (dark) are close to the edges. Their goal is to capture the king, which is in the center of the board. The defender plays second. Their pieces (light) are in the middle. Their goal is to move the king on one of the 4 thrones in the corners. Note that the square in which the king starts, in the center of the board, is also a throne.`,k3.getInitialState()),ce.anyMove($localize`Moving`,$localize`All pieces move the same way. Similarly to a rook in chess, a piece can move: <ol><li>By as many squares as you want.</li><li>Without going over another piece or stopping on another piece.</li><li>Horizontally or vertically.</li><li>Only the king can land on a corner throne.</li><li>Once the king left his central throne, no piece can land on it, but all can pass over it.</li></ol>To move a piece, click on it and then on its landing square.<br/><br/>You're playing Dark, do the first move.`,k3.getInitialState(),ko.of(new M(3,1),new M(1,1)),$localize`Congratulations!`),ce.fromMove($localize`Capturing a soldier (1/2)`,$localize`All pieces, attackers and defenders, except the king, are soldiers. To capture them, they have to be sandwiched between two of your pieces. By getting too close, an attacker's soldier is in danger.<br/><br/>You're playing Light. Capture the soldier.`,new k3([[ne,ne,ne,Q1,ne,ne,ne],[ne,ne,ne,Q1,ne,ne,ne],[Q1,ne,ne,da,ne,ne,ne],[ne,ne,da,Dm,da,Q1,Q1],[ne,ne,Q1,ne,ne,ne,ne],[ne,ne,ne,da,ne,Q1,ne],[ne,ne,ne,Q1,ne,ne,ne]],1),[ko.of(new M(3,5),new M(2,5))],$localize`Congratulations, that will teach him a lesson!`,$localize`Failed, you missed an opportunity to capture a piece of the opponent.`),ce.fromMove($localize`Capturing a soldier (2/2)`,$localize`A second way to capture a soldier is to sandwich it against an empty throne. The king has moved and endangered one of its soldiers.<br/><br/>You're playing Dark. Capture the soldier.`,new k3([[ne,ne,ne,Q1,ne,ne,ne],[ne,ne,Q1,ne,ne,ne,ne],[ne,ne,ne,da,ne,ne,ne],[Q1,da,ne,ne,da,Q1,Q1],[ne,da,ne,ne,ne,ne,ne],[ne,Q1,ne,Dm,ne,Q1,ne],[ne,ne,ne,Q1,ne,ne,ne]],12),[ko.of(new M(2,1),new M(3,1)),ko.of(new M(3,0),new M(3,1))],$localize`Congratulations, one less defender. But keep an eye on the king, it is the most important.`,$localize`Failed, you did not do the expected move.`),ce.fromMove($localize`Capturing the king on his throne`,$localize`To capture the king when he sits on his throne, the four squares neighbor to the king (horizontally and vertically) must be occupied by your soldiers.<br/><br/>You're playing Dark. Capture the king.`,new k3([[ne,ne,ne,ne,ne,ne,ne],[ne,ne,ne,da,ne,ne,ne],[ne,ne,ne,Q1,ne,ne,ne],[ne,Q1,ne,Dm,Q1,ne,ne],[ne,ne,ne,Q1,ne,ne,ne],[ne,da,ne,ne,ne,ne,ne],[ne,ne,ne,ne,ne,ne,ne]],72),[ko.of(new M(1,3),new M(2,3))],$localize`Congratulations, you won!`,$localize`Failed, you let the king run away.`),ce.fromMove($localize`Capturing the king next to his throne`,$localize`Another way to capture the king is to use three soldier plus the central throne to surround the king on four sides.<br/><br/>You're playing Dark. Capture the king.`,new k3([[ne,ne,Q1,ne,ne,ne,ne],[ne,ne,ne,Q1,ne,ne,ne],[ne,ne,ne,Dm,Q1,ne,ne],[ne,Q1,da,ne,da,ne,ne],[ne,ne,ne,Q1,ne,ne,ne],[ne,ne,ne,ne,ne,ne,ne],[ne,ne,ne,ne,ne,ne,ne]],72),[ko.of(new M(2,0),new M(2,2))],$localize`The king is dead, long live the king. Congratulations, you won.`,$localize`Failed. Try again.`),ce.fromMove($localize`Capturing the king far from his throne`,$localize`When the king is not on his central throne nor next to it, he can be captured like a soldier.<br/><br/>You're playing Dark. Capture the king.`,new k3([[ne,ne,ne,ne,ne,ne,ne],[ne,ne,ne,ne,ne,ne,ne],[ne,Q1,ne,Q1,ne,ne,ne],[Q1,ne,ne,ne,da,ne,ne],[ne,ne,ne,da,ne,ne,ne],[ne,ne,ne,ne,ne,ne,ne],[ne,Dm,ne,Q1,ne,ne,ne]],72),[ko.of(new M(3,6),new M(2,6))],$localize`The king is dead, long live the king. Congratulations, you won.`,$localize`Failed. Try again.`)]}}function C4t(n,t){1&n&&(F(),Q(0,"polygon",8))}function y4t(n,t){1&n&&(F(),Q(0,"rect",9))}function E4t(n,t){if(1&n&&(F(),b(0,"g"),x(1,C4t,1,0,"polygon",6),x(2,y4t,1,0,"ng-template",null,7,r1),O()),2&n){const e=Qn(3),r=v().index,s=v().index,i=v();S(1),T("ngIf",i.isCentralThrone(r,s))("ngIfElse",e)}}function M4t(n,t){if(1&n&&(F(),b(0,"g"),Q(1,"line",13)(2,"line",13)(3,"line",13)(4,"line",13)(5,"line",13),O()),2&n){const e=v(2).index,r=v().index,s=v();S(1),T("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.5*s.SPACE_SIZE)("y1",.04*s.SPACE_SIZE)("x2",.5*s.SPACE_SIZE)("y2",.96*s.SPACE_SIZE),S(1),T("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.5*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.1*s.SPACE_SIZE)("y2",.6*s.SPACE_SIZE),S(1),T("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.5*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.9*s.SPACE_SIZE)("y2",.6*s.SPACE_SIZE),S(1),T("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.5*s.SPACE_SIZE)("y1",.4*s.SPACE_SIZE)("x2",.15*s.SPACE_SIZE)("y2",.75*s.SPACE_SIZE),S(1),T("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.5*s.SPACE_SIZE)("y1",.4*s.SPACE_SIZE)("x2",.85*s.SPACE_SIZE)("y2",.75*s.SPACE_SIZE)}}function S4t(n,t){if(1&n&&(F(),Q(0,"polyline",16)),2&n){const e=v(3).index,r=v().index;T("ngClass",v().viewInfo.pieceClasses[r][e])}}function P4t(n,t){if(1&n&&(F(),Q(0,"line",13)(1,"line",13)(2,"line",13)(3,"line",13)),2&n){const e=v(3).index,r=v().index,s=v();T("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.5*s.SPACE_SIZE)("y1",.04*s.SPACE_SIZE)("x2",.5*s.SPACE_SIZE)("y2",.96*s.SPACE_SIZE),S(1),T("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.04*s.SPACE_SIZE)("y1",.5*s.SPACE_SIZE)("x2",.96*s.SPACE_SIZE)("y2",.5*s.SPACE_SIZE),S(1),T("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.2*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.8*s.SPACE_SIZE)("y2",.8*s.SPACE_SIZE),S(1),T("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.8*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.2*s.SPACE_SIZE)("y2",.8*s.SPACE_SIZE)}}function T4t(n,t){if(1&n&&(F(),x(0,S4t,1,1,"polyline",14),x(1,P4t,4,20,"ng-template",null,15,r1)),2&n){const e=Qn(2),r=v(2).index,s=v().index;T("ngIf",v().isKing(r,s))("ngIfElse",e)}}function w4t(n,t){if(1&n&&(F(),b(0,"g"),Q(1,"circle",10),x(2,M4t,6,25,"g",11),x(3,T4t,3,2,"ng-template",null,12,r1),O()),2&n){const e=Qn(4),r=v().index,s=v().index,i=v();S(1),We("id","piece_",r,"_",s,""),T("ngClass",i.viewInfo.pieceClasses[s][r]),D("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)("cx",.5*i.SPACE_SIZE)("cy",.5*i.SPACE_SIZE),S(1),T("ngIf",i.isInvader(r,s))("ngIfElse",e)}}function b4t(n,t){if(1&n){const e=Oe();F(),b(0,"g",3),ee("click",function(){const i=he(e).index,o=v().index;return le(v().onClick(i,o))}),Q(1,"rect",4),x(2,E4t,4,2,"g",5),x(3,w4t,5,8,"g",5),O()}if(2&n){const e=t.index,r=v().index,s=v();We("id","click_",e,"_",r,""),D("transform","translate("+s.SPACE_SIZE*e+", "+s.SPACE_SIZE*r+")"),S(1),T("ngClass",s.getRectClasses(e,r)),D("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),S(1),T("ngIf",s.board[r][e]===s.EMPTY&&s.isThrone(e,r)),S(1),T("ngIf",s.board[r][e]!==s.EMPTY)}}function O4t(n,t){if(1&n&&(F(),b(0,"g"),x(1,b4t,4,8,"g",2),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e)}}function N4t(n,t){if(1&n){const e=Oe();F(),b(0,"g")(1,"rect",17),ee("click",function(){const i=he(e).$implicit;return le(v().onClick(i.x,i.y))}),O()()}if(2&n){const e=t.$implicit,r=v();S(1),We("id","click_",e.x,"_",e.y,""),D("x",r.SPACE_SIZE*e.x)("y",r.SPACE_SIZE*e.y)("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)}}let A4t=(()=>{class n extends TH{constructor(e){super(e,!1,ko.from),this.rules=M5.get(),this.availableMinimaxes=[new mP(this.rules,"DummyBot"),new vP(this.rules,"Piece > Influence"),new CP(this.rules,"Piece > Control"),new wH(this.rules,"Escape > Piece > Control")],this.encoder=ko.encoder,this.tutorial=(new Wce).tutorial}ngOnInit(){this.updateBoard()}}return n.\u0275fac=function(e){return new(e||n)(J(Pn))},n.\u0275cmp=gt({type:n,selectors:[["app-brandhub"]],features:[l],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["x","0","y","0",1,"base",3,"ngClass"],[4,"ngIf"],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60","class","base",4,"ngIf","ngIfElse"],["cornerThrone",""],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60",1,"base"],["x","15","y","15","width","70","height","70",1,"base"],[1,"base",3,"id","ngClass"],[4,"ngIf","ngIfElse"],["defender",""],[1,"base",3,"ngClass"],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85","class","base no-fill",3,"ngClass",4,"ngIf","ngIfElse"],["soldierDefender",""],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85",1,"base","no-fill",3,"ngClass"],[1,"no-fill","mid-stroke","clickable-stroke",3,"id","click"]],template:function(e,r){1&e&&(F(),b(0,"svg",0),x(1,O4t,2,1,"g",1),x(2,N4t,2,6,"g",1),O()),2&e&&(D("viewBox",r.getViewBox()),S(1),T("ngForOf",r.board),S(1),T("ngForOf",r.getClickables()))},dependencies:[dn,An,en],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})(),pa=(()=>{class n extends es{static getInitialState(){const e=Ke.createTable(n.WIDTH,n.WIDTH,pe.NONE);return new n(e,0)}}return n.WIDTH=19,n})();class Rc extends xc{constructor(t,e){super(t,e)}static isInRange(t){return t.isInRange(pa.WIDTH,pa.WIDTH)}static from(t){return Me.assert(Rc.isInRange(t),"FIRST_COORD_IS_OUT_OF_RANGE"),new Rc(t.x,t.y)}equals(t){return this.coord.equals(t.coord)}toString(){return"ConnectSixFirstMove("+this.coord.x+", "+this.coord.y+")"}}Rc.encoder=Bce.getEncoder(pa.WIDTH,pa.WIDTH,Rc.from);class c6 extends Lc{static from(t,e){return Me.assert(t.isInRange(pa.WIDTH,pa.WIDTH),"FIRST_COORD_IS_OUT_OF_RANGE"),Me.assert(e.isInRange(pa.WIDTH,pa.WIDTH),"SECOND_COORD_IS_OUT_OF_RANGE"),Me.assert(!1===t.equals(e),"COORDS_SHOULD_BE_DIFFERENT"),U.success(new c6(t,e))}toString(){return"ConnectSixDrops("+this.getFirst().toString()+", "+this.getSecond().toString()+")"}equals(t){const e=this.getFirst(),r=t.getFirst(),s=this.getSecond(),i=t.getSecond();return!(!e.equals(r)||!s.equals(i))||!(!e.equals(i)||!s.equals(r))}}c6.encoder=Lc.getEncoder(c6.from);const I4t=mi.disjunction(Rc.encoder,c6.encoder,n=>n instanceof Rc);class yP{constructor(t,e,r){this.isInRange=t,this.getOwner=e,this.N=r}getSquareScore(t,e){const r=t.getPieceAt(e),s=this.getOwner(r,t);ve(s.isPlayer(),"getSquareScore should not be called with PlayerOrNone.NONE piece");const i=new Vn,o=new Vn;for(const u of Ne.DIRECTIONS){const h=this.getNumberOfFreeSpacesAndAllies(t,e,u,s);i.set(u,h[0]),o.set(u,h[1])}return this.getScoreFromDirectionAlliesAndFreeSpaces(o,i)*s.getScoreModifier()}getScoreFromDirectionAlliesAndFreeSpaces(t,e){let r=0;for(const s of[Ne.UP,Ne.UP_RIGHT,Ne.RIGHT,Ne.DOWN_RIGHT]){if(t.get(s).get()+t.get(s.getOpposite()).get()+1>=this.N)return Number.MAX_SAFE_INTEGER;const p=e.get(s).get()+e.get(s.getOpposite()).get();p+1>=this.N&&(r+=2+p-this.N)}return r}getNumberOfFreeSpacesAndAllies(t,e,r,s){let i=0,o=0,c=!0,u=new M(e.x+r.x,e.y+r.y),h=1;const p=s.getOpponent();for(;this.isInRange(u)&&h<this.N;){const m=t.getPieceAt(u);if(this.getOwner(m,t)===p)return[i,o];this.getOwner(m,t)===s&&c?o++:c=!1,m!==p&&m!==s&&i++,u=u.getNext(r),h++}return[i,o]}getVictoriousCoord(t){const e=[];for(const r of t.getCoordsAndContents())if(this.getOwner(r.content,t).isPlayer()){const s=r.coord,i=this.getSquareScore(t,s);$1.getScoreStatus(i)===yn.VICTORY&&(i===z.ZERO.getVictoryValue()||i===z.ONE.getVictoryValue())&&e.push(s)}return e}}class Dc extends U1{constructor(){super(pa)}static get(){return Dc.singleton.isAbsent()&&(Dc.singleton=P.of(new Dc)),Dc.singleton.get()}static getVictoriousCoords(t){return Dc.CONNECT_SIX_HELPER.getVictoriousCoord(t)}applyLegalMove(t,e){return t instanceof c6?this.applyLegalDrops(t,e):this.applyLegalFirstMove(t,e)}applyLegalDrops(t,e){const r=e.getCurrentPlayer(),s=t.getFirst(),i=t.getSecond(),o=e.getCopiedBoard();return o[s.y][s.x]=r,o[i.y][i.x]=r,new pa(o,e.turn+1)}applyLegalFirstMove(t,e){const r=e.getCurrentPlayer(),s=e.getCopiedBoard();return s[t.coord.y][t.coord.x]=r,new pa(s,e.turn+1)}isLegal(t,e){return 0===e.turn?(Me.assert(t instanceof Rc,"First move should be instance of ConnectSixFirstMove"),U.success(void 0)):(Me.assert(t instanceof c6,"non-firsts moves should be instance of ConnectSixDrops"),this.isLegalDrops(t,e))}isLegalDrops(t,e){return e.getPieceAt(t.getFirst()).isPlayer()||e.getPieceAt(t.getSecond()).isPlayer()?U.failure(tt.MUST_CLICK_ON_EMPTY_SQUARE()):U.success(void 0)}getGameStatus(t){const e=t.gameState;return Dc.CONNECT_SIX_HELPER.getVictoriousCoord(e).length>0?xe.getVictory(e.getCurrentOpponent()):181===e.turn?xe.DRAW:xe.ONGOING}}Dc.singleton=P.empty(),Dc.CONNECT_SIX_HELPER=new yP(Rc.isInRange,Me.identity,6);const $=pe.NONE,N2=pe.ZERO,Wi=pe.ONE;class qce extends K1{constructor(){super(...arguments),this.tutorial=[ce.informational($localize`Initial board and object of the game`,$localize`Connect Six is played on a 19x19 board, on which stones are put on the intersections. The aim of the game is to align 6 of your pieces.`,pa.getInitialState()),ce.anyMove($localize`First turn`,$localize`On the first turn, the first player plays only one piece.<br/><br/>You're playing Dark, place your first piece by clicking on an intersection.`,pa.getInitialState(),Rc.from(new M(9,9)),$localize`Congratulations!`),ce.anyMove($localize`Next turns`,$localize`On all following turns, the players play two pieces.<br/><br/>You're playing Light, do the winning move.`,new pa([[$,$,$,$,$,$,$,$,$,$,$,$,$,$,$,$,$,$,$],[$,$,$,$,$,$,$,$,$,$,$,$,$,$,$,$,$,$,$],[$,$,$,$,$,$,$,$,$,$,$,$,$,$,$,$,$,$,$],[$,$,$,$,$,$,$,$,$,$,$,$,$,$,$,$,$,$,$],[$,$,$,$,$,$,Wi,$,$,$,$,$,$,$,$,$,$,$,$],[$,$,$,$,$,$,$,N2,$,Wi,N2,$,$,$,$,$,$,$,$],[$,$,$,$,$,$,$,$,N2,N2,$,$,Wi,$,$,$,$,$,$],[$,$,$,$,$,$,$,Wi,N2,N2,N2,N2,Wi,$,$,$,$,$,$],[$,$,$,$,$,$,Wi,N2,N2,N2,N2,Wi,$,$,$,$,$,$,$],[$,$,$,$,$,$,Wi,$,Wi,N2,Wi,Wi,$,$,$,$,$,$,$],[$,$,$,$,$,$,$,$,N2,Wi,N2,$,$,$,$,$,$,$,$],[$,$,$,$,$,$,$,Wi,$,Wi,$,N2,$,$,$,$,$,$,$],[$,$,$,$,$,$,$,$,$,Wi,Wi,$,Wi,$,$,$,$,$,$],[$,$,$,$,$,$,$,$,$,Wi,$,$,$,$,$,$,$,$,$],[$,$,$,$,$,$,$,$,$,N2,$,$,$,$,$,$,$,$,$],[$,$,$,$,$,$,$,$,$,$,$,$,$,$,$,$,$,$,$],[$,$,$,$,$,$,$,$,$,$,$,$,$,$,$,$,$,$,$],[$,$,$,$,$,$,$,$,$,$,$,$,$,$,$,$,$,$,$],[$,$,$,$,$,$,$,$,$,$,$,$,$,$,$,$,$,$,$]],20),c6.from(new M(4,11),new M(5,10)).get(),$localize`Congratulations!`)]}}function x4t(n,t){if(1&n&&(F(),Q(0,"circle",8)),2&n){const e=v().index,r=v().index,s=v();We("id","piece_",e,"_",r,""),T("ngClass",s.getSpaceClass(e,r)),D("cx",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*e)("cy",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*r)("r",.22*s.SPACE_SIZE)}}function k4t(n,t){if(1&n&&(F(),Q(0,"rect",9)(1,"line",10)(2,"line",10)),2&n){const e=v().index,r=v().index,s=v();D("width",.5*s.SPACE_SIZE)("height",.5*s.SPACE_SIZE)("x",.5*s.SPACE_SIZE*e)("y",.5*s.SPACE_SIZE*r),S(1),D("x1",.5*s.SPACE_SIZE*e)("y1",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*r)("x2",.5*s.SPACE_SIZE+.5*s.SPACE_SIZE*e)("y2",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*r),S(1),D("x1",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*e)("y1",.5*s.SPACE_SIZE*r)("x2",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*e)("y2",.5*s.SPACE_SIZE+.5*s.SPACE_SIZE*r)}}function L4t(n,t){if(1&n){const e=Oe();F(),b(0,"g",5),ee("click",function(){const i=he(e).index,o=v().index;return le(v().onClick(i,o))}),x(1,x4t,1,6,"circle",6),x(2,k4t,3,12,"ng-template",null,7,r1),O()}if(2&n){const e=t.$implicit,r=t.index,s=Qn(3);We("id","click_",r,"_",v().index,""),S(1),T("ngIf",e.isPlayer())("ngIfElse",s)}}function R4t(n,t){if(1&n&&(F(),b(0,"g"),x(1,L4t,4,4,"g",4),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e)}}function D4t(n,t){if(1&n){const e=Oe();F(),b(0,"circle",11),ee("click",function(){he(e);const s=v();return le(s.onClick(s.droppedCoord.get().x,s.droppedCoord.get().y))}),O()}if(2&n){const e=v();T("ngClass",e.getSpaceClass(e.droppedCoord.get().x,e.droppedCoord.get().y)),D("cx",.25*e.SPACE_SIZE+.5*e.SPACE_SIZE*e.droppedCoord.get().x)("cy",.25*e.SPACE_SIZE+.5*e.SPACE_SIZE*e.droppedCoord.get().y)("r",.22*e.SPACE_SIZE)}}let z4t=(()=>{class n extends to{constructor(e){super(e),this.droppedCoord=P.empty(),this.lastMoved=[],this.victoryCoords=[],this.rules=Dc.get(),this.availableMinimaxes=[],this.encoder=I4t,this.tutorial=(new qce).tutorial}updateBoard(){const e=this.getState();this.board=e.getCopiedBoard(),this.victoryCoords=Dc.getVictoriousCoords(e),this.rules.node.move.isPresent()&&this.showLastMove()}showLastMove(){const e=this.rules.node.move.get();this.lastMoved=e instanceof Rc?[e.coord]:[e.getFirst(),e.getSecond()]}onClick(e,r){var s=this;return A(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());const o=new M(e,r);if(0===s.getState().turn)return s.chooseMove(Rc.from(o),s.getState());if(s.getState().getPieceAt(o).isPlayer())return s.cancelMove(tt.MUST_CLICK_ON_EMPTY_SQUARE());if(s.droppedCoord.isPresent()){if(s.droppedCoord.equalsValue(o))return s.droppedCoord=P.empty(),G.SUCCESS;{const c=c6.from(s.droppedCoord.get(),o).get();return s.chooseMove(c,s.getState())}}return s.droppedCoord=P.of(o),G.SUCCESS})()}getSpaceClass(e,r){const s=new M(e,r),i=this.getState().getPieceAt(s),o=[];return this.droppedCoord.equalsValue(s)?(o.push(this.getPlayerClass(this.getState().getCurrentPlayer())),o.push("highlighted-stroke")):(o.push(this.getPlayerClass(i)),this.victoryCoords.some(c=>c.equals(s))&&o.push("victory-stroke"),this.lastMoved.some(c=>c.equals(s))&&o.push("last-move-stroke")),o}cancelMoveAttempt(){this.droppedCoord=P.empty()}}return n.\u0275fac=function(e){return new(e||n)(J(Pn))},n.\u0275cmp=gt({type:n,selectors:[["app-connect-six"]],features:[l],decls:4,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["x","0","y","0",1,"base","mid-small-stroke"],[4,"ngFor","ngForOf"],["id","dropped","class","base mid-stroke moved-stroke",3,"ngClass","click",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["class","base mid-stroke",3,"id","ngClass",4,"ngIf","ngIfElse"],["empty",""],[1,"base","mid-stroke",3,"id","ngClass"],["fill-opacity","0",1,"base","no-stroke"],[1,"base","mid-stroke"],["id","dropped",1,"base","mid-stroke","moved-stroke",3,"ngClass","click"]],template:function(e,r){1&e&&(F(),b(0,"svg",0),Q(1,"rect",1),x(2,R4t,2,1,"g",2),x(3,D4t,1,4,"circle",3),O()),2&e&&(D("viewBox","0 -3 "+r.board.length*r.SPACE_SIZE*.5+" "+(6+r.board.length*r.SPACE_SIZE*.5)),S(1),D("width",r.board.length*r.SPACE_SIZE*.5)("height",r.board.length*r.SPACE_SIZE*.5),S(1),T("ngForOf",r.board),S(1),T("ngIf",r.droppedCoord.isPresent()))},dependencies:[dn,An,en],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})(),l6=(()=>{class n{}return n.SIMPLE_MOVE_SHOULD_BE_OF_ONE_STEP=()=>$localize`Your piece should land on a neighboring square.`,n.CANNOT_DROP_AFTER_TURN_40=()=>$localize`You cannot drop a piece during the moving phase.`,n.CANNOT_MOVE_BEFORE_TURN_40=()=>$localize`You cannot move a piece before both players have dropped all of their pieces.`,n.MUST_JUMP_OVER_PIECES=()=>$localize`A jump must be made over a piece, not over an empty square.`,n.MUST_DROP_IN_CENTRAL_ZONE=()=>$localize`A drop must occur in the central zone of the board.`,n.INVALID_JUMP=()=>$localize`A jump must land two squares from its original position, and be done in a straight line in any direction.`,n.SAME_LOCATION_VISITED_IN_JUMP=()=>$localize`You are visiting the same location twice in a move, you are not allowed to do so.`,n})();class zt extends es{static getInitialState(){const t=Ke.createTable(zt.WIDTH,zt.HEIGHT,pe.NONE);return new zt(t,0)}isShelter(t){return 0===t.x||t.x===zt.WIDTH-1?zt.SHELTERS_INDICES.some(e=>t.y===e):(0===t.y||t.y===zt.HEIGHT-1)&&zt.SHELTERS_INDICES.some(e=>t.x===e)}isCentralZone(t){return t.x>=zt.CENTRAL_ZONE_TOP_LEFT.x&&t.x<=zt.CENTRAL_ZONE_BOTTOM_RIGHT.x&&t.y>=zt.CENTRAL_ZONE_TOP_LEFT.y&&t.y<=zt.CENTRAL_ZONE_BOTTOM_RIGHT.y}isDropPhase(){return this.turn<40}getSidePieces(){return this.turn%2==0?[20-this.turn/2,20-this.turn/2]:[20-(this.turn-1)/2-1,20-(this.turn-1)/2]}}zt.WIDTH=17,zt.HEIGHT=17,zt.CENTRAL_ZONE_TOP_LEFT=new M(4,6),zt.CENTRAL_ZONE_BOTTOM_RIGHT=new M(12,10),zt.SHELTERS_INDICES=[0,1,3,5,7,8,9,11,13,15,16],zt.ALL_SHELTERS=new Dt(zt.SHELTERS_INDICES.flatMap(n=>[new M(n,0),new M(n,zt.HEIGHT-1),new M(0,n),new M(zt.WIDTH-1,n)])).toList();class s8 extends xc{constructor(t){super(t.x,t.y)}static of(t){return t.isInRange(zt.WIDTH,zt.HEIGHT)?U.success(new s8(t)):U.failure("Move out of board")}toString(){return`ConspirateursMoveDrop(${this.coord.toString()})`}equals(t){return!!t.isDrop()&&this.coord.equals(t.coord)}isDrop(){return!0}isSimple(){return!1}isJump(){return!1}}s8.encoder=Bce.getEncoder(zt.WIDTH,zt.HEIGHT,n=>s8.of(n).get());class i8 extends r8{constructor(t,e){super(t,e)}static from(t,e){return t.isInRange(zt.WIDTH,zt.HEIGHT)&&e.isInRange(zt.WIDTH,zt.HEIGHT)?t.isAlignedWith(e)&&1===t.getDistance(e)?U.success(new i8(t,e)):U.failure(l6.SIMPLE_MOVE_SHOULD_BE_OF_ONE_STEP()):U.failure("Move out of board")}toString(){return`ConspirateursMoveSimple(${this.getStart().toString()} -> ${this.getEnd().toString()})`}equals(t){return!(!t.isSimple()||t!==this&&(!1===t.getStart().equals(this.getStart())||!1===t.getEnd().equals(this.getEnd())))}isDrop(){return!1}isSimple(){return!0}isJump(){return!1}}i8.encoder=Lc.getEncoder(i8.from);class L3 extends Gi{constructor(t){super(),this.coords=t}static of(t){if(t.length<2)return U.failure("ConspirateursMoveJump requires at least one jump, so two coords");for(const r of t)if(r.isNotInRange(zt.WIDTH,zt.HEIGHT))return U.failure("Move out of board");for(let r=1;r<t.length;r++)if(t[r-1].getDirectionToward(t[r]).isFailure()||2!==t[r-1].getDistance(t[r]))return U.failure(l6.INVALID_JUMP());return new Ar(t).size()===t.length?U.success(new L3(t)):U.failure(l6.SAME_LOCATION_VISITED_IN_JUMP())}addJump(t){const e=Ke.copyImmutableArray(this.coords);return e.push(t),L3.of(e)}getStartingCoord(){return this.coords[0]}getEndingCoord(){return this.coords[this.coords.length-1]}getLandingCoords(){return this.coords.slice(1)}getJumpedOverCoords(){const t=[];for(let e=1;e<this.coords.length;e++){const r=this.coords[e-1].getDirectionToward(this.coords[e]).get();t.push(this.coords[e-1].getNext(r,1))}return t}toString(){return`ConspirateursMoveJump(${this.coords.map(e=>e.toString()).reduce((e,r)=>e+" -> "+r)})`}equals(t){return!(t.isSimple()||t.isDrop()||t!==this&&(!1===this.getStartingCoord().equals(t.getStartingCoord())||!1===this.getEndingCoord().equals(t.getEndingCoord())))}isDrop(){return!1}isSimple(){return!1}isJump(){return!0}}L3.encoder=new class extends mi{constructor(){super(...arguments),this.coordEncoder=M.numberEncoder(zt.WIDTH,zt.HEIGHT)}encodeMove(n){return{coords:n.coords.map(this.coordEncoder.encodeNumber)}}decodeMove(n){ve(null!=Me.getNonNullable(n).coords,"Encoded ConspirateursMoveJump should contain coords");const e=Me.getNonNullable(n).coords.map(this.coordEncoder.decodeNumber);return L3.of(e).get()}};const V4t=mi.disjunction3(s8.encoder,i8.encoder,L3.encoder,n=>n.isDrop(),n=>n.isSimple()),E=pe.NONE,It=pe.ZERO,Ot=pe.ONE;class jce extends K1{constructor(){super(...arguments),this.tutorial=[ce.informational($localize`Board and aim of the game`,$localize`Conspirateurs is played on a 17x17 board. The goal of the game is to place all of your pieces in shelters, which are the special squares on the edge of the board. Note the central zone in the middle of the board, where each player will put their pieces initially.`,zt.getInitialState()),ce.anyMove($localize`Initial phase`,$localize`In the initial phase of the game, each player drop their 20 pieces, one per turn consecutively, in the central zone of the board. This phase does not allow any other kind of move.<br/><br/>You're playing Dark, drop one of your piece in the central zone.`,zt.getInitialState(),s8.of(new M(7,7)).get(),$localize`Congratulations!`),ce.fromPredicate($localize`Simple move`,$localize`Once all pieces have been placed, there are two kind of moves that can be performed. The first is a simple move in any direction, orthogonally or diagonally, of a single step.<br/><br/>You're playing Dark. Click on one of your piece and perform such a move.`,new zt([[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,It,It,Ot,Ot,It,It,Ot,It,Ot,E,E,E,E],[E,E,E,E,It,Ot,It,Ot,It,It,It,It,Ot,E,E,E,E],[E,E,E,E,It,Ot,E,E,E,E,E,Ot,It,E,E,E,E],[E,E,E,E,Ot,It,It,Ot,Ot,Ot,It,It,It,E,E,E,E],[E,E,E,E,Ot,It,Ot,Ot,Ot,Ot,Ot,Ot,It,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E]],40),i8.from(new M(4,6),new M(3,5)).get(),(t,e,r)=>t.isSimple()?G.SUCCESS:G.failure($localize`You have made a jump, not a simple move. Try again!`),$localize`Congratulations!`),ce.fromPredicate($localize`Jumps`,$localize`The other type of move is a jump. A piece can jump over a neighboring piece in any direction, as long as it lands directly on the square after that piece, along the same direction.<br/><br/>You're playing Dark. Perform a jump by clicking on one of your piece that can perform a jump, and then on the target square. You may need to click a second time on the target square to confirm your jump, in case your piece is still highlighted (we will see shortly why this is useful).`,new zt([[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,It,It,Ot,Ot,It,It,Ot,It,Ot,E,E,E,E],[E,E,E,E,It,Ot,It,Ot,It,It,It,It,Ot,E,E,E,E],[E,E,E,E,It,Ot,E,E,E,E,E,Ot,It,E,E,E,E],[E,E,E,E,Ot,It,It,Ot,Ot,Ot,It,It,It,E,E,E,E],[E,E,E,E,Ot,It,Ot,Ot,Ot,Ot,Ot,Ot,It,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E]],40),L3.of([new M(6,7),new M(6,5)]).get(),(t,e,r)=>t.isJump()?G.SUCCESS:G.failure($localize`You have not performed a jump. Try again!`),$localize`Congratulations!`),ce.fromMove($localize`Chaining jumps in a single move`,$localize`Jumps can be chained when possible. You can decide whether to continue a jump or to stop it at any time. To finish your jump, click a second time on your current location. Otherwise, simply keep clicking on your next location. Once no more destination is possible, your move will end without you needing to click the piece a second time.<br/><br/>You're playing Dark and you can perform a triple jump! Do it.`,new zt([[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,Ot,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,Ot,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,Ot,E,E,E,E,E,E,E,E,E],[E,E,E,E,It,It,E,Ot,It,It,Ot,It,Ot,E,E,E,E],[E,E,E,E,It,E,It,Ot,It,It,It,It,Ot,E,E,E,E],[E,E,E,E,It,Ot,E,E,E,E,E,Ot,It,E,E,E,E],[E,E,E,E,Ot,It,It,Ot,Ot,Ot,It,It,It,E,E,E,E],[E,E,E,E,Ot,It,Ot,Ot,Ot,Ot,Ot,Ot,It,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E]],40),[L3.of([new M(8,6),new M(6,4),new M(6,2),new M(6,0)]).get()],$localize`Congratulations! You now know everything to play the game. Remember: to win, you have to place all of your pieces in shelters before your opponent does.`,$localize`You have not performed a triple jump. Try again!`)]}}class Za extends U1{constructor(){super(zt)}static get(){return Za.singleton.isAbsent()&&(Za.singleton=P.of(new Za)),Za.singleton.get()}applyLegalMove(t,e,r){const s=e.getCopiedBoard();if(t.isDrop())s[t.coord.y][t.coord.x]=e.getCurrentPlayer();else if(t.isSimple())s[t.getStart().y][t.getStart().x]=pe.NONE,s[t.getEnd().y][t.getEnd().x]=e.getCurrentPlayer();else{const i=t.getStartingCoord(),o=t.getEndingCoord();s[i.y][i.x]=pe.NONE,s[o.y][o.x]=e.getCurrentPlayer()}return new zt(s,e.turn+1)}isLegal(t,e){return t.isDrop()?this.dropLegality(t,e):t.isSimple()?this.simpleMoveLegality(t,e):this.jumpLegality(t,e)}dropLegality(t,e){return e.turn>=40?U.failure(l6.CANNOT_DROP_AFTER_TURN_40()):e.getPieceAt(t.coord).isPlayer()?U.failure(tt.MUST_LAND_ON_EMPTY_SPACE()):!1===e.isCentralZone(t.coord)?U.failure(l6.MUST_DROP_IN_CENTRAL_ZONE()):U.success(void 0)}simpleMoveLegality(t,e){return e.turn<40?U.failure(l6.CANNOT_MOVE_BEFORE_TURN_40()):e.getPieceAt(t.getStart())!==e.getCurrentPlayer()?U.failure(tt.MUST_CHOOSE_PLAYER_PIECE()):e.getPieceAt(t.getEnd()).isPlayer()?U.failure(tt.MUST_LAND_ON_EMPTY_SPACE()):U.success(void 0)}jumpLegality(t,e){if(e.turn<40)return U.failure(l6.CANNOT_MOVE_BEFORE_TURN_40());if(e.getPieceAt(t.getStartingCoord())!==e.getCurrentPlayer())return U.failure(tt.MUST_CHOOSE_PLAYER_PIECE());for(const r of t.getJumpedOverCoords())if(e.getPieceAt(r)===pe.NONE)return U.failure(l6.MUST_JUMP_OVER_PIECES());for(const r of t.getLandingCoords())if(e.getPieceAt(r).isPlayer())return U.failure(tt.MUST_LAND_ON_EMPTY_SPACE());return U.success(void 0)}jumpTargetsFrom(t){const e=[new M(t.x+2,t.y),new M(t.x-2,t.y),new M(t.x,t.y+2),new M(t.x,t.y-2),new M(t.x+2,t.y+2),new M(t.x+2,t.y-2),new M(t.x-2,t.y+2),new M(t.x-2,t.y-2)],r=[];for(const s of e)L3.of([t,s]).isSuccess()&&r.push(s);return r}nextJumps(t,e){const r=t.getEndingCoord(),s=[];for(const i of this.jumpTargetsFrom(r)){const o=t.addJump(i);o.isSuccess()&&this.jumpLegality(o.get(),e).isSuccess()&&s.push(o.get())}return s}jumpHasPossibleNextTargets(t,e){return this.nextJumps(t,e).length>0}getGameStatus(t){const e=t.gameState,r=[0,0];for(const s of zt.ALL_SHELTERS){const i=e.getPieceAt(s);if(i.isPlayer()&&(r[i.value]+=1,20===r[i.value]))return xe.getVictory(i)}return xe.ONGOING}}Za.singleton=P.empty();let zm=(()=>{class n{}return n.NO_MORE_PIECES_OF_THIS_TYPE=()=>$localize`You do not have any pieces of this type anymore.`,n.SPACE_IS_FULL=()=>$localize`You cannot play here: this space is already full.`,n.TARGET_STACK_TOO_HIGH=()=>$localize`You cannot add more pieces to the target stack, as it will contain more than 4 pieces.`,n.MUST_SHIFT_TO_NEIGHBOR=()=>$localize`To perform a shift, you must move the pieces to a neighboring space.`,n.MUST_SELECT_PIECE_FIRST=()=>$localize`You must first select either a piece from the side, or a stack of pieces to shift on the board.`,n})();class Mn{constructor(t,e){this.owner=t,this.otherPieceType=e}static of(t,e){return t===z.ZERO?e?Mn.ZERO_SECOND:Mn.ZERO_FIRST:t===z.ONE?e?Mn.ONE_SECOND:Mn.ONE_FIRST:Mn.EMPTY}toString(){return`DiamPiece(${this.owner}, ${this.otherPieceType})`}}Mn.encoder=Cn.tuple([z.numberEncoder,Cn.booleanEncoder],n=>[n.owner,n.otherPieceType],n=>Mn.of(n[0],n[1])),Mn.EMPTY=new Mn(pe.NONE,!1),Mn.ZERO_FIRST=new Mn(z.ZERO,!1),Mn.ZERO_SECOND=new Mn(z.ZERO,!0),Mn.ONE_FIRST=new Mn(z.ONE,!1),Mn.ONE_SECOND=new Mn(z.ONE,!0),Mn.PLAYER_PIECES=[Mn.ZERO_FIRST,Mn.ZERO_SECOND,Mn.ONE_FIRST,Mn.ONE_SECOND];class o8 extends Gi{constructor(t,e){if(super(),this.target=t,this.piece=e,e===Mn.EMPTY)throw new Error("Cannot drop an empty piece")}isDrop(){return!0}getTarget(){return this.target}equals(t){return t instanceof o8&&!(this.target!==t.target||this.piece!==t.piece)}toString(){return`DiamMoveDrop(${this.target}, ${this.piece})`}}o8.encoder=Cn.tuple([Cn.numberEncoder(7),Mn.encoder],n=>[n.target,n.piece],n=>new o8(n[0],n[1]));class A2 extends Gi{constructor(t,e){super(),this.start=t,this.moveDirection=e}static fromRepresentation(t,e){return new A2(new M(t.x,3-t.y),e)}isDrop(){return!1}getTarget(){return"clockwise"===this.moveDirection?(this.start.x+1)%8:(this.start.x+7)%8}equals(t){return t instanceof A2&&!(!1===this.start.equals(t.start)||this.moveDirection!==t.moveDirection)}toString(){return`DiamMoveShift(${this.start}, ${this.moveDirection})`}}A2.encoder=Cn.tuple([M.numberEncoder(8,4),Cn.booleanEncoder],n=>[n.start,"clockwise"===n.moveDirection],n=>new A2(n[0],n[1]?"clockwise":"counterclockwise"));const H4t=Cn.disjunction(o8.encoder,A2.encoder,n=>n.isDrop());let $r=(()=>{class n extends es{constructor(e,r,s){super(e,s),this.remainingPieces=r}static getInitialState(){const e=Mn.EMPTY;return new n([[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e]],[4,4,4,4],0)}static fromRepresentation(e,r){const s=e.reverse(),i=[4,4,4,4];for(let o=0;o<n.HEIGHT;o++)for(let c=0;c<n.WIDTH;c++){const u=s[o][c];s[o][c]!==Mn.EMPTY&&i[n.pieceIndex(u)]--}return ve(i.every(o=>o>=0),"Invalid DiamState representation uses too many pieces"),new n(s,i,r)}static pieceIndex(e){switch(e){case Mn.ZERO_FIRST:return 0;case Mn.ZERO_SECOND:return 1;case Mn.ONE_FIRST:return 2;default:return Me.expectToBe(e,Mn.ONE_SECOND),3}}getRemainingPiecesOf(e){return this.remainingPieces[n.pieceIndex(e)]}getStackHeight(e){let r=0;for(let s=0;s<n.HEIGHT&&this.getPieceAtXY(e,s)!==Mn.EMPTY;s++)r++;return r}}return n.WIDTH=8,n.HEIGHT=4,n})();class R3 extends U1{constructor(){super($r)}static get(){return R3.singleton.isAbsent()&&(R3.singleton=P.of(new R3)),R3.singleton.get()}applyLegalMove(t,e,r){return t.isDrop()?this.applyLegalDrop(t,e):this.applyLegalShift(t,e)}applyLegalDrop(t,e){const r=Ke.copyBiArray(e.board);r[e.getStackHeight(t.target)][t.target]=t.piece;const s=Ke.copyImmutableArray(e.remainingPieces);return s[$r.pieceIndex(t.piece)]-=1,new $r(r,s,e.turn+1)}applyLegalShift(t,e){const r=Ke.copyBiArray(e.board),s=t.getTarget();let i=e.getStackHeight(s),o=t.start.y;for(;o<$r.HEIGHT&&e.getPieceAtXY(t.start.x,o)!==Mn.EMPTY;)r[i][s]=e.getPieceAtXY(t.start.x,o),r[o][t.start.x]=Mn.EMPTY,i++,o++;return new $r(r,e.remainingPieces,e.turn+1)}isLegal(t,e){return t.isDrop()?this.isDropLegal(t,e):this.isShiftLegal(t,e)}isDropLegal(t,e){return t.piece.owner!==e.getCurrentPlayer()?U.failure(tt.MUST_CHOOSE_PLAYER_PIECE()):0===e.getRemainingPiecesOf(t.piece)?U.failure(zm.NO_MORE_PIECES_OF_THIS_TYPE()):this.dropHeightValidity(t,e)}dropHeightValidity(t,e){return e.getStackHeight(t.target)===$r.HEIGHT?U.failure(zm.SPACE_IS_FULL()):U.success(void 0)}isShiftLegal(t,e){return e.getPieceAt(t.start).owner!==e.getCurrentPlayer()?U.failure(tt.MUST_CHOOSE_PLAYER_PIECE()):this.shiftHeightValidity(t,e)}shiftHeightValidity(t,e){const r=e.getStackHeight(t.start.x)-t.start.y;return e.getStackHeight(t.getTarget())+r>$r.HEIGHT?U.failure(zm.TARGET_STACK_TOO_HIGH()):U.success(void 0)}getGameStatus(t){const e=this.findHighestAlignment(t.gameState);if(e.isPresent()){const r=t.gameState.getPieceAt(e.get());return ve(r.owner.isPlayer(),"highest alignment is owned by a player"),xe.getVictory(r.owner)}return xe.ONGOING}findHighestAlignment(t){for(let e=0;e<$r.WIDTH/2;e++)for(let r=$r.HEIGHT-1;r>0;r--){const s=t.getPieceAtXY(e,r),i=t.getPieceAtXY(e+$r.WIDTH/2,r);if(s!==Mn.EMPTY&&s===i)return P.of(new M(e,r))}return P.empty()}pieceCanMove(t,e){return!!this.isShiftLegal(new A2(e,"clockwise"),t).isSuccess()||!!this.isShiftLegal(new A2(e,"counterclockwise"),t).isSuccess()}}R3.singleton=P.empty();const rt=Mn.EMPTY,S9=Mn.ZERO_FIRST,Zce=Mn.ZERO_SECOND,EP=Mn.ONE_FIRST,bH=Mn.ONE_SECOND;class Yce{constructor(){this.tutorial=[ce.informational($localize`Initial board and player pieces`,$localize`Diam's board is a circular board made of 8 spaces. Each player has 8 pieces: 4 of one color, and 4 of another color. Initially, the board is empty. All the remaining pieces are displayed next to the board: Dark's pieces are on the left, Light's pieces are on the right.`,$r.getInitialState()),ce.fromMove($localize`Goal of the game`,$localize`At Diam, the goal is to align two of your pieces, having exactly the same color, on diametrically opposed spaces, on top of at least another piece. Note here that Dark does not win because the dark pieces are not on top of any other piece. You're playing Light. Here, you can win by dropping one of your pieces on the leftmost space. You can do it by clicking on the corresponding piece next to the board, and then on the space in which you want to drop your piece.<br/><br/>You're playing Light, win the game!`,$r.fromRepresentation([[rt,rt,rt,rt,rt,rt,rt,rt],[rt,rt,rt,rt,rt,rt,rt,rt],[rt,rt,rt,rt,EP,rt,rt,rt],[S9,rt,rt,rt,S9,rt,rt,rt]],3),[new o8(0,Mn.ONE_FIRST)],$localize`Congratulations, you won!`,$localize`Failed, you should drop your piece on the leftmost space, using the piece of the same color of the other piece you already have on the board.`),ce.fromMove($localize`Types of move`,$localize`You can perform two types of move: either dropping one of your piece like you did in the previous step, or you can shift one of your pieces on the board to a neighboring space. You can pick any of your piece on the board, even if there are pieces on top of it. Only one condition applies: there can never be more than 4 pieces in a space. When you pick a piece with other pieces on top of it, all the other pieces move with yours.<br/><br/>You're playing Dark, try to move one of your piece that is already on the board.`,$r.fromRepresentation([[rt,rt,rt,rt,rt,rt,rt,rt],[rt,rt,rt,rt,bH,rt,rt,rt],[rt,rt,rt,rt,S9,rt,rt,rt],[EP,rt,rt,rt,Zce,rt,rt,rt]],4),[A2.fromRepresentation(new M(4,3),"counterclockwise"),A2.fromRepresentation(new M(4,3),"clockwise"),A2.fromRepresentation(new M(4,2),"counterclockwise"),A2.fromRepresentation(new M(4,2),"clockwise")],$localize`Congratulations!`,$localize`Failed, try to move one of your piece that is already on the board.`),ce.fromMove($localize`Special case`,$localize`It can happen that, in a single turn, both players reach an alignment. If it is the case, only the player with the highest alignment wins.<br/><br/>Here, playing Dark, you can win by performing such a move, do it!`,$r.fromRepresentation([[rt,rt,rt,rt,S9,rt,rt,rt],[rt,rt,rt,rt,bH,rt,rt,S9],[rt,rt,rt,rt,S9,rt,rt,bH],[rt,EP,rt,rt,Zce,rt,rt,EP]],8),[A2.fromRepresentation(new M(4,2),"counterclockwise")],$localize`Congratulations!`,$localize`Failed, try to shift a stack of pieces to the left.`)]}}let Kce=(()=>{class n extends t8{constructor(){super(...arguments),this.SPACE_SIZE=50}getTriangleCornerCoords(e,r){return(e+r)%2==1?this.getDownwardCoordinate(e,r):this.getUpwardCoordinate(e,r)}getTriangleCoordinate(e,r){return this.getTriangleCornerCoords(e,r).map(o=>o.x+","+o.y).reduce((o,c)=>o+","+c)}getDownwardCoordinate(e,r){const i=.5*this.SPACE_SIZE*(e+1),o=.5*this.SPACE_SIZE*(e+2),c=this.SPACE_SIZE*r,u=this.SPACE_SIZE*(r+1),h=new M(.5*this.SPACE_SIZE*e,c);return[h,new M(i,u),new M(o,c),h]}getUpwardCoordinate(e,r){const i=.5*this.SPACE_SIZE*(e+1),o=.5*this.SPACE_SIZE*(e+2),c=this.SPACE_SIZE*r,u=this.SPACE_SIZE*(r+1),h=new M(.5*this.SPACE_SIZE*e,u);return[h,new M(i,c),new M(o,u),h]}getPyramidCoordinate(e,r){return(e+r)%2==1?this.getDownwardPyramidCoordinate(e,r):this.getUpwardPyramidCoordinate(e,r)}getDownwardPyramidCoordinate(e,r){const s=this.SPACE_SIZE*e/2,i=this.SPACE_SIZE*r,o=s+", "+i,c=s+this.SPACE_SIZE+", "+i,u=s+this.SPACE_SIZE/2+", "+(i+this.SPACE_SIZE),h=s+this.SPACE_SIZE/2+", "+(i+this.SPACE_SIZE/2);return o+","+u+","+h+","+o+","+h+","+c+","+o+","+c+","+u+","+h+","+c}getUpwardPyramidCoordinate(e,r){const s=this.SPACE_SIZE*e/2,i=(r+1)*this.SPACE_SIZE,o=s+", "+i,c=s+this.SPACE_SIZE+", "+i,u=s+this.SPACE_SIZE/2+", "+(i-this.SPACE_SIZE),h=s+this.SPACE_SIZE/2+", "+(i-this.SPACE_SIZE/2);return o+","+u+","+h+","+o+","+h+","+c+","+o+","+c+","+u+","+h+","+c}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=Dr(n)))(r||n)}}(),n.\u0275cmp=gt({type:n,selectors:[["ng-component"]],features:[l],decls:0,vars:0,template:function(e,r){},encapsulation:2}),n})(),Vm=(()=>{class n{}return n.INVALID_DISTANCE=()=>$localize`Your piece must land on one of the closest six triangles with the same color as the triangle on which the piece is.`,n.NOT_ENOUGH_TILES_TO_EXCHANGE=()=>$localize`You do not have enough tiles to exchange in order to capture this piece. Pick one of your piece and move it.`,n.FIRST_CLICK_SHOULD_NOT_BE_NULL=()=>$localize`Your first click must be on the piece that you want to move, or on a piece of your opponent that you want to exchange against two tiles.`,n.CANNOT_CAPTURE_FROM_EMPTY=()=>$localize`You cannot capture from an empty space.`,n})();class ir{constructor(t,e){this.direction=t,this.str=e}static fromCoords(t,e){const r=t.getVectorToward(e),s=ir.STEPS.findIndex(i=>i.direction.equals(r));if(-1===s)throw new Error(Vm.INVALID_DISTANCE());return ir.STEPS[s]}toInt(){return ir.STEPS.findIndex(t=>t.direction.equals(this.direction))}equals(t){return this===t}toString(){return this.str}}ir.LEFT=new ir(new Gt(-2,0),"LEFT"),ir.UP_LEFT=new ir(Ne.UP_LEFT,"UP_LEFT"),ir.UP_RIGHT=new ir(Ne.UP_RIGHT,"UP_RIGHT"),ir.RIGHT=new ir(new Gt(2,0),"RIGHT"),ir.DOWN_LEFT=new ir(Ne.DOWN_LEFT,"DOWN_LEFT"),ir.DOWN_RIGHT=new ir(Ne.DOWN_RIGHT,"DOWN_RIGHT"),ir.STEPS=[ir.LEFT,ir.UP_LEFT,ir.UP_RIGHT,ir.RIGHT,ir.DOWN_LEFT,ir.DOWN_RIGHT];class Is extends Gi{constructor(t,e,r,s){super(),this.start=t,this.step=e,this.landingCoord=r,this.capture=s}static fromMovement(t,e){if(t.isNotInRange(15,10))throw new Error("Starting coord cannot be out of range (width: 15, height: 10).");const r=new M(t.x+e.direction.x,t.y+e.direction.y);if(r.isNotInRange(15,10))throw new Error("Landing coord cannot be out of range (width: 15, height: 10).");return new Is(P.of(t),P.of(e),P.of(r),P.empty())}static fromTilesExchange(t){if(t.isNotInRange(15,10))throw new Error("Captured coord cannot be out of range (width: 15, height: 10).");return new Is(P.empty(),P.empty(),P.empty(),P.of(t))}static fromCoordToCoord(t,e){const r=ir.fromCoords(t,e);return Is.fromMovement(t,r)}isTileExchange(){return this.capture.isPresent()}toString(){return this.isTileExchange()?"CoerceoMove("+this.capture.get().toString()+")":"CoerceoMove("+this.start.get().toString()+" > "+this.step.get().toString()+" > "+this.landingCoord.get().toString()+")"}equals(t){return!(!this.capture.equals(t.capture)||!this.start.equals(t.start)||!this.step.equals(t.step))}}Is.encoder=new class extends Cn{maxValue(){return 1035}encodeNumber(n){if(n.isTileExchange()){const t=n.capture.get().y;return 10*n.capture.get().x+t}{const t=n.start.get().y,e=n.start.get().x;return 150*(n.step.get().toInt()+1)+10*e+t}}decodeNumber(n){if(n%1!=0)throw new Error("EncodedMove must be an integer.");const t=n%10,e=(n=(n-t)/10)%15;return 0==(n=(n-e)/15)?Is.fromTilesExchange(new M(e,t)):Is.fromMovement(new M(e,t),ir.STEPS[n-1])}};class zc{static getNeighbors(t){let e;const r=new M(t.x-1,t.y),s=new M(t.x+1,t.y);return e=(t.x+t.y)%2==1?[r,s,new M(t.x,t.y-1)]:[r,s,new M(t.x,t.y+1)],e}static getFakeNeighbors(t){return new M(t.x,(t.x+t.y)%2==1?t.y+1:t.y-1)}static getCommonNeighbor(t,e){const r=zc.getNeighbors(t),s=zc.getNeighbors(e);let i=0;for(;i<r.length;){const o=r[i];let c=0;for(;c<s.length;){if(o.equals(s[c]))return P.of(o);c++}i++}return P.empty()}static isSpaceDark(t){return(t.x+t.y)%2==0}}class S5 extends es{static getEmptyNeighbors(t,e,r){const s=[];for(const i of zc.getNeighbors(e))i.isInRange(t[0].length,t.length)&&t[i.y][i.x]===r&&s.push(i);return s}getEmptyNeighbors(t,e){return S5.getEmptyNeighbors(this.board,t,e)}}class w1 extends S5{constructor(t,e,r,s){super(t,e),this.tiles=r,this.captures=s}static getTilesUpperLeftCoord(t){const e=t.x-t.x%3;let r=t.y;return r-=e%2==0?t.y%2:(t.y+1)%2,new M(e,r)}static getPresentNeighborEntrances(t){return[new M(t.x+1,t.y-1),new M(t.x+3,t.y+0),new M(t.x+3,t.y+1),new M(t.x+1,t.y+2),new M(t.x-1,t.y+1),new M(t.x-1,t.y+0)].filter(w1.isInRange)}static getInitialState(){const t=Ie.EMPTY,e=Ie.UNREACHABLE,r=Ie.ZERO,s=Ie.ONE;return new w1([[e,e,e,e,e,e,r,t,r,e,e,e,e,e,e],[e,e,e,t,t,r,t,t,t,r,t,t,e,e,e],[t,s,t,s,t,t,r,t,r,t,t,s,t,s,t],[s,t,t,t,s,t,t,t,t,t,s,t,t,t,s],[t,s,t,s,t,t,t,t,t,t,t,s,t,s,t],[t,r,t,r,t,t,t,t,t,t,t,r,t,r,t],[r,t,t,t,r,t,t,t,t,t,r,t,t,t,r],[t,r,t,r,t,t,s,t,s,t,t,r,t,r,t],[e,e,e,t,t,s,t,t,t,s,t,t,e,e,e],[e,e,e,e,e,e,s,t,s,e,e,e,e,e,e]],0,[0,0],[0,0])}applyLegalMovement(t){X(w1.VERBOSE,{coerceoState_applyLegalMovement:{object:this,move:t}});const e=t.start.get(),r=t.landingCoord.get(),s=this.getCopiedBoard();return s[r.y][r.x]=Ie.ofPlayer(this.getCurrentPlayer()),s[e.y][e.x]=Ie.EMPTY,new w1(s,this.turn,this.tiles,this.captures)}doMovementCaptures(t){X(w1.VERBOSE,{coerceoState_doMovementCaptures:{object:this,move:t}});const e=this.getCapturedNeighbors(t.landingCoord.get());let r=this;for(const s of e)r=r.capture(s);return r}getCapturedNeighbors(t){const e=this.getCurrentOpponent();return zc.getNeighbors(t).filter(s=>!s.isNotInRange(15,10)&&!!this.getPieceAt(s).is(e)&&this.isSurrounded(s))}isSurrounded(t){return 0===this.getEmptyNeighbors(t,Ie.EMPTY).length}capture(t){X(w1.VERBOSE,{coerceoState_captureIfNeeded:{object:this,coord:t}});const e=this.getCopiedBoard(),r=[this.captures[0],this.captures[1]];return X(w1.VERBOSE,t.toString()+" has been captured"),e[t.y][t.x]=Ie.EMPTY,r[this.getCurrentPlayer().value]+=1,new w1(e,this.turn,this.tiles,r)}removeTilesIfNeeded(t,e){X(w1.VERBOSE,{coerceoState_removeTilesIfNeeded:{object:this,piece:t,countTiles:e}});let r=this;const s=w1.getTilesUpperLeftCoord(t);if(this.isTileEmpty(s)&&this.isDeconnectable(s)){r=this.deconnectTile(s,e);const i=w1.getPresentNeighborEntrances(s);for(const o of i){const c=r.getPieceAt(o);c===Ie.EMPTY?r=r.removeTilesIfNeeded(o,e):c.is(this.getCurrentOpponent())&&r.isSurrounded(o)&&(r=r.capture(o))}}return r}isTileEmpty(t){ve(this.getPieceAt(t)!==Ie.UNREACHABLE,"Should not call isTileEmpty on removed tile");for(let e=0;e<2;e++)for(let r=0;r<3;r++){const s=t.getNext(new Gt(r,e),1);if(this.getPieceAt(s)!==Ie.EMPTY)return!1}return!0}isDeconnectable(t){const e=this.getPresentNeighborTilesRelativeIndexes(t);if(e.length>3)return!1;let r=0;for(let s=1;s<e.length;s++)!1===this.areNeighbor(e[s-1],e[s])&&(r+=1);return!1===this.areNeighbor(e[0],e[e.length-1])&&(r+=1),r<=1}areNeighbor(t,e){return t+1===e||0===t&&5===e}getPresentNeighborTilesRelativeIndexes(t){const e=[];let r=P.empty();for(let s=0;s<6;s++){const o=t.getNext(w1.NEIGHBORS_TILES_DIRECTIONS[s],1);o.isInRange(15,10)&&this.getPieceAt(o)!==Ie.UNREACHABLE&&(r.isAbsent()&&(r=P.of(s)),e.push(s-r.get()))}return e}deconnectTile(t,e){X(w1.VERBOSE,{coerceoState_deconnectTile:{object:this,tileUpperLeft:t,countTiles:e}});const r=this.getCopiedBoard(),s=t.x,i=t.y;for(let c=0;c<2;c++)for(let u=0;u<3;u++)r[i+c][s+u]=Ie.UNREACHABLE;const o=[this.tiles[0],this.tiles[1]];return e&&(o[this.getCurrentPlayer().value]+=1),new w1(r,this.turn,o,this.captures)}getLegalLandings(t){const e=[];for(const r of ir.STEPS){const s=t.getNext(r.direction,1);this.isOnBoard(s)&&this.getPieceAt(s)===Ie.EMPTY&&e.push(s)}return e}getPiecesByFreedom(){const t=[[0,0,0,0],[0,0,0,0]];for(let e=0;e<10;e++)for(let r=0;r<15;r++){const s=this.board[e][r];if(s.isPlayer()){const i=this.getEmptyNeighbors(new M(r,e),Ie.EMPTY).length;t[s.value][i]=t[s.value][i]+1}}return t}}w1.VERBOSE=!1,w1.NEIGHBORS_TILES_DIRECTIONS=[new Gt(0,-2),new Gt(3,-1),new Gt(3,1),new Gt(0,2),new Gt(-3,1),new Gt(-3,-1)],w1.isInRange=n=>n.isInRange(15,10);let MP=(()=>{class n extends U1{applyLegalMove(e,r,s){return e.isTileExchange()?this.applyLegalTileExchange(e,r):this.applyLegalMovement(e,r)}applyLegalTileExchange(e,r){const s=r.getCopiedBoard(),i=e.capture.get();s[i.y][i.x]=Ie.EMPTY;const o=[r.captures[0],r.captures[1]];o[r.getCurrentPlayer().value]+=1;const c=[r.tiles[0],r.tiles[1]];c[r.getCurrentPlayer().value]-=2;const u=new w1(s,r.turn,c,o),h=u.removeTilesIfNeeded(i,!1),p=new w1(h.getCopiedBoard(),h.turn+1,h.tiles,h.captures);return X(n.VERBOSE,{coerceoRules_applyLegalTileExchange:{a_initialState:r,afterCapture:u,afterTileRemoval:h,resultingState:p}}),p}applyLegalMovement(e,r){const s=r.applyLegalMovement(e),i=s.removeTilesIfNeeded(e.start.get(),!0),o=i.doMovementCaptures(e),c=new w1(o.board,r.turn+1,o.tiles,o.captures);return X(n.VERBOSE,{ab_state:r,afterMovement:s,afterTilesRemoved:i,afterCaptures:o,resultingState:c}),c}isLegal(e,r){return e.isTileExchange()?this.isLegalTileExchange(e,r):this.isLegalMovement(e,r)}isLegalTileExchange(e,r){if(r.tiles[r.getCurrentPlayer().value]<2)return U.failure(Vm.NOT_ENOUGH_TILES_TO_EXCHANGE());const s=r.getPieceAt(e.capture.get());return s===Ie.UNREACHABLE||s===Ie.EMPTY?U.failure(Vm.CANNOT_CAPTURE_FROM_EMPTY()):s.is(r.getCurrentPlayer())?U.failure(tt.CANNOT_SELF_CAPTURE()):U.success(void 0)}isLegalMovement(e,r){if(r.getPieceAt(e.start.get())===Ie.UNREACHABLE){const o="Cannot start with a coord outside the board "+e.start.get().toString()+".";return U.failure(o)}if(r.getPieceAt(e.landingCoord.get())===Ie.UNREACHABLE){const o="Cannot end with a coord outside the board "+e.landingCoord.get().toString()+".";return U.failure(o)}const s=r.getPieceAt(e.start.get());return s===Ie.EMPTY?U.failure(tt.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):s.is(r.getCurrentOpponent())?U.failure(tt.CANNOT_CHOOSE_OPPONENT_PIECE()):r.getPieceAt(e.landingCoord.get()).is(r.getCurrentPlayer())?U.failure(tt.MUST_LAND_ON_EMPTY_SPACE()):U.success(void 0)}static getGameStatus(e){const r=e.gameState;return r.captures[0]>=18?xe.ZERO_WON:r.captures[1]>=18?xe.ONE_WON:xe.ONGOING}getGameStatus(e){return n.getGameStatus(e)}}return n.VERBOSE=!1,n})();class Xce extends G1{getListMoves(t){let e=this.getListExchanges(t);return e=e.concat(this.getListMovement(t)),this.putCaptureFirst(t,e)}getListExchanges(t){const e=[],r=t.gameState,s=r.getCurrentPlayer().value,i=Ie.ofPlayer(r.getCurrentOpponent());if(r.tiles[s]<2)return e;for(let o=0;o<10;o++)for(let c=0;c<15;c++){const u=new M(c,o);if(r.getPieceAt(u)===i){const h=Is.fromTilesExchange(u);e.push(h)}}return e}getListMovement(t){const e=[],r=t.gameState,s=r.getCurrentPlayer();for(let i=0;i<10;i++)for(let o=0;o<15;o++){const c=new M(o,i);if(r.getPieceAt(c).is(s)){const u=r.getLegalLandings(c);for(const h of u){const p=Is.fromCoordToCoord(c,h);e.push(p)}}}return e}getBoardValue(t){const e=MP.getGameStatus(t);if(e.isEndGame)return Ct.fromWinner(e.winner);const r=t.gameState,s=r.getPiecesByFreedom(),i=this.getPiecesScore(s);return new Ct(2*r.captures[1]+i[1]-(2*r.captures[0]+i[0]))}getPiecesScore(t){return[this.getPlayerPiecesScore(t[0]),this.getPlayerPiecesScore(t[1])]}getPlayerPiecesScore(t){return 3*t[0]+1*t[1]+3*t[2]+3*t[3]}putCaptureFirst(t,e){return Ke.sortByDescending(e,r=>this.moveCapturesList(t,r).length),e}moveCapturesList(t,e){return e.isTileExchange()?[e.capture.get()]:t.gameState.applyLegalMovement(e).removeTilesIfNeeded(e.start.get(),!0).getCapturedNeighbors(e.landingCoord.get())}}let F4t=(()=>{class n extends Xce{getBoardValue(e){const r=MP.getGameStatus(e);if(r.isEndGame)return Ct.fromWinner(r.winner);const s=e.gameState,i=this.getPiecesMap(s),o=this.getThreatMap(s,i),c=this.filterThreatMap(o,s);let u=0;for(const h of z.PLAYERS)for(const p of i.get(h).get())c.get(p).isPresent()?u+=h.getScoreModifier()*n.SCORE_BY_THREATENED_PIECE:u+=h.getScoreModifier()*n.SCORE_BY_SAFE_PIECE;return u+=s.tiles[1]-s.tiles[0],new Ct(u)}getPiecesMap(e){const r=new Vn,s=[],i=[];for(let o=0;o<10;o++)for(let c=0;c<15;c++){const u=new M(c,o),h=e.getPieceAt(u);h===Ie.ZERO?s.push(u):h===Ie.ONE&&i.push(u)}return r.set(z.ZERO,new Ar(s)),r.set(z.ONE,new Ar(i)),r}getThreatMap(e,r){const s=new Vn;for(const i of z.PLAYERS)for(const o of r.get(i).get()){const c=this.getThreat(o,e);c.isPresent()&&s.set(o,c.get())}return s}getThreat(e,r){const i=z.of(r.getPieceAt(e).value).getOpponent();let o=P.empty(),c=P.empty(),u=[];const h=zc.getNeighbors(e).filter(p=>p.isInRange(15,10));for(const p of h){const m=r.getPieceAt(p);if(m.is(i))u.push(p),this.tileCouldBeRemovedThisTurn(p,r,i)&&(c=P.of(p));else if(m===Ie.EMPTY){if(o.isPresent())return P.empty();o=P.of(p)}}if(o.isPresent()){const p=[];for(const m of ir.STEPS){const C=o.get().getNext(m.direction,1);C.isInRange(15,10)&&r.getPieceAt(C).is(i)&&!1===u.some(w=>w.equals(C))&&p.push(C)}if(p.length>0)return P.of(new _P(new Ar(u),new Ar(p)))}if(c.isPresent()){u=u.filter(m=>m.equals(c.get()));const p=new Ar(u);return P.of(new _P(p,new Ar([c.get()])))}return P.empty()}tileCouldBeRemovedThisTurn(e,r,s){const i=s.getOpponent();if(!1===r.isDeconnectable(e))return!1;let c=P.empty();const u=w1.getTilesUpperLeftCoord(e);for(let h=0;h<2;h++)for(let p=0;p<3;p++){const m=u.getNext(new Gt(p,h),1);if(r.getPieceAt(m).is(s)){if(!this.pieceCouldLeaveTheTile(m,r))return!1;c=P.of(m)}else if(r.getPieceAt(m).is(i))return!1}return c.isPresent()}pieceCouldLeaveTheTile(e,r){const s=w1.getTilesUpperLeftCoord(e);for(const i of ir.STEPS){const o=e.getNext(i.direction,1),c=w1.getTilesUpperLeftCoord(o);if(!1===s.equals(c)&&r.getPieceAt(o)===Ie.EMPTY)return!0}return!1}filterThreatMap(e,r){const s=new Vn,i=e.listKeys(),o=i.filter(u=>r.getPieceAt(u).is(r.getCurrentPlayer())),c=new Ar(i.filter(u=>r.getPieceAt(u).is(r.getCurrentOpponent())));for(const u of o){const h=e.get(u).get();let p=P.empty();for(const m of h.directThreats)if(!1===c.contains(m)){const C=[];for(const w of h.mover)!1===c.contains(w)&&C.push(w);C.length>0&&(p=P.of(new _P(h.directThreats,new Ar(C))))}p.isPresent()&&s.set(u,p.get())}for(const u of c){const h=e.get(u).get();s.set(u,h)}return s}}return n.SCORE_BY_THREATENED_PIECE=1e3,n.SCORE_BY_SAFE_PIECE=1e6,n})();const de=Ie.EMPTY,B=Ie.UNREACHABLE,W1=Ie.ZERO,e1=Ie.ONE;class Qce extends K1{constructor(){super(...arguments),this.tutorial=[ce.informational($localize`Board and goal of the game`,$localize`Coerceo is played on a board like this, composed of hexagonal tiles, each comprising 6 triangles.
         The triangles are the spaces on which pieces move during the game.
         The tiles can be removed from the board (you will see how later).
         The dark pieces belong to the first player and can only move on the dark spaces,
         while the light pieces belong to the second player and can only move on the light spaces.
         The goal of the game is to capture all of the opponent's pieces.`,w1.getInitialState()),ce.anyMove($localize`Move`,$localize`To move a piece, you need to:
        <ol>
          <li>Click on one of your pieces.</li>
          <li>Click on one of the triangular space highlighted in yellow.</li>
        </ol>
        You can pass through the opponent's pieces.<br/><br/>
        You're playing first, hence you're playing Dark.
        Perform any move.`,w1.getInitialState(),Is.fromCoordToCoord(new M(3,5),new M(5,5)),$localize`Congratulations! Let's see captures now.`),ce.fromMove($localize`Capture`,$localize`Every piece has three neighboring triangular spaces (2 on the sides).
        When all neighboring spaces except one are occupied, and one opponent moves to that last free space, your piece is captured!
        However, it is possible to place a piece between 3 of the opponent's pieces (or 2 on the side) without being captured.<br/><br/>
        You're playing Light, make a capture.`,new w1([[B,B,B,B,B,B,W1,de,W1,B,B,B,B,B,B],[B,B,B,W1,de,de,de,de,de,W1,de,de,B,B,B],[de,e1,de,e1,W1,e1,de,de,W1,de,de,e1,de,e1,de],[e1,de,de,de,de,de,de,de,de,de,e1,de,de,de,e1],[de,e1,de,e1,de,de,de,de,de,de,de,e1,de,e1,de],[de,W1,de,W1,de,de,de,de,de,de,de,W1,de,W1,de],[W1,de,de,de,W1,de,de,de,de,de,W1,de,de,de,W1],[de,W1,de,W1,de,de,e1,de,e1,de,de,W1,de,W1,de],[B,B,B,de,de,e1,de,de,de,e1,de,de,B,B,B],[B,B,B,B,B,B,e1,de,e1,B,B,B,B,B,B]],3,[0,0],[0,0]),[Is.fromCoordToCoord(new M(5,2),new M(4,1)),Is.fromCoordToCoord(new M(3,4),new M(4,3))],$localize`Congratulations!`,$localize`Failed, you have not captured any piece.`),ce.fromMove($localize`Gain a tile`,$localize`When a tile is empty, it can become removable from the board.
        For it to be removable, at least three of its sides must be free, and these should be neighboring sides.
        Note that if one empty tile, neighboring a tile that was just removed, also becomes removable, it will be removed too.
        For example, here, the topmost dark piece will not disconnect its tile when leaving it.
        But, by leaving the bottom left tile, two tiles will be removed.<br/><br/>
        You're playing Dark, perform a move that lets you gain two tiles.`,new w1([[B,B,B,B,B,B,de,de,de,B,B,B,B,B,B],[B,B,B,B,B,B,e1,de,de,B,B,B,B,B,B],[de,de,de,B,B,B,de,de,de,B,B,B,B,B,B],[de,de,e1,de,de,de,de,W1,de,B,B,B,B,B,B],[de,de,de,e1,de,de,de,de,de,B,B,B,B,B,B],[de,de,de,de,de,de,de,de,de,de,de,W1,B,B,B],[de,de,W1,de,de,e1,de,de,de,de,W1,de,de,de,W1],[de,de,de,de,de,de,e1,de,e1,de,de,W1,de,W1,de],[B,B,B,de,de,e1,de,de,de,e1,de,de,B,B,B],[B,B,B,B,B,B,e1,de,e1,B,B,B,B,B,B]],2,[0,0],[0,0]),[Is.fromCoordToCoord(new M(2,6),new M(4,6)),Is.fromCoordToCoord(new M(2,6),new M(3,5)),Is.fromCoordToCoord(new M(2,6),new M(3,7))],$localize`Congratulations!`,$localize`Failed, you have not gained the two tiles that you could, try again!`),ce.fromMove($localize`Exchanging a tile`,$localize`When you have a tile, you can see it on the left of the board.
        As soon as you have two, you can click on an opponent's piece to capture it immediately instead of moving one of your pieces.
        This will cost you two tiles.
        If any tiles are removed during that turn, nobody will get them.<br/><br/>
        You're playing Light, gain some time and capture the last piece to win directly!`,new w1([[B,B,B,B,B,B,B,B,B,B,B,B,B,B,B],[B,B,B,B,B,B,B,B,B,B,B,B,B,B,B],[B,B,B,B,B,B,B,B,B,B,B,B,B,B,B],[B,B,B,B,B,B,B,B,B,B,B,B,B,B,B],[B,B,B,B,B,B,B,B,B,B,B,B,B,B,B],[B,B,B,de,de,W1,B,B,B,B,B,B,B,B,B],[B,B,B,de,de,de,de,de,de,B,B,B,B,B,B],[B,B,B,de,de,de,e1,de,e1,B,B,B,B,B,B],[B,B,B,de,de,e1,de,de,de,B,B,B,B,B,B],[B,B,B,B,B,B,e1,de,e1,B,B,B,B,B,B]],1,[0,2],[0,0]),[Is.fromTilesExchange(new M(5,5))],$localize`Congratulations!`,$localize`It's nice to move a piece, but you could have had the opponent's piece immediately by clicking on it!`),ce.fromMove($localize`Special capture`,$localize`When a tile is removed from the board during your turn, some of the opponent's pieces may have lost their last free neighboring space, they will therefore be captured!
        If this happens to one of your piece during your turn, it will however stay on the board.<br/><br/>
        A move that demonstrates both of these things can be done on this board by Light. Try it!`,new w1([[B,B,B,B,B,B,B,B,B,B,B,B,B,B,B],[B,B,B,B,B,B,B,B,B,B,B,B,B,B,B],[B,B,B,B,B,B,B,B,B,B,B,B,B,B,B],[B,B,B,B,B,B,B,B,B,B,B,B,B,B,B],[B,B,B,B,B,B,de,de,W1,B,B,B,B,B,B],[B,B,B,de,de,W1,de,de,de,B,B,B,B,B,B],[B,B,B,de,W1,e1,de,e1,de,B,B,B,B,B,B],[B,B,B,de,e1,W1,de,de,de,B,B,B,B,B,B],[B,B,B,de,de,e1,B,B,B,B,B,B,B,B,B],[B,B,B,B,B,B,B,B,B,B,B,B,B,B,B]],1,[0,0],[0,0]),[Is.fromCoordToCoord(new M(7,6),new M(6,5)),Is.fromCoordToCoord(new M(7,6),new M(8,5))],$localize`Congratulations! See, your piece no longer had any empty neighboring space after you have gained the tile, but it stayed on the board as it was your turn.
        However, the opponent's piece has disappeared because the tile's capture has removed its last empty neighboring space.`,$localize`Failed. Try again.`)]}}function B4t(n,t){if(1&n&&(F(),Q(0,"polygon",11)),2&n){const e=v().index,r=v().index,s=v();T("ngClass",s.getPyramidClass(e,r)),D("points",s.getPyramidCoordinate(e,r))}}function $4t(n,t){if(1&n&&(F(),Q(0,"polygon",13)),2&n){const e=v(2).index,r=v().index,s=v();T("ngClass",s.getEmptyClass(e,r)),D("points",s.getTriangleCoordinate(e,r))}}function U4t(n,t){if(1&n&&(F(),x(0,$4t,1,2,"polygon",12)),2&n){const e=v().index,r=v().index;T("ngIf",v().isEmptySpace(e,r))}}function G4t(n,t){if(1&n&&(F(),Q(0,"polygon",14)),2&n){const e=v().index,r=v().index,s=v();We("id","dark_line_",e,"_",r,""),D("points",s.getLineCoordinate(e,r))}}function W4t(n,t){if(1&n&&(F(),Q(0,"polygon",15)),2&n){const e=v().index,r=v().index,s=v();We("id","dark_line_",e,"_",r,""),D("points",s.getLineCoordinate(e,r))}}function q4t(n,t){if(1&n){const e=Oe();F(),b(0,"g",6),ee("click",function(){const i=he(e).index,o=v().index;return le(v().onClick(i,o))}),x(1,B4t,1,2,"polygon",7),x(2,U4t,1,1,"ng-template",null,8,r1),x(4,G4t,1,3,"polygon",9),x(5,W4t,1,3,"polygon",10),O()}if(2&n){const e=t.$implicit,r=t.index,s=Qn(3),i=v().index,o=v();We("id","click_",r,"_",i,""),S(1),T("ngIf",o.isPyramid(r,i))("ngIfElse",s),S(3),T("ngIf",e!==o.NONE),S(1),T("ngIf",e!==o.NONE)}}function j4t(n,t){if(1&n&&(F(),b(0,"g"),x(1,q4t,6,6,"g",5),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e)}}function Z4t(n,t){if(1&n&&(F(),Q(0,"polygon",16)),2&n){const e=t.$implicit;D("points",v().getTriangleCoordinate(e.x,e.y))}}function Y4t(n,t){if(1&n&&(F(),Q(0,"polygon",17)),2&n){const e=v();D("points",e.getTriangleCoordinate(e.lastStart.get().x,e.lastStart.get().y))}}function K4t(n,t){if(1&n&&(F(),Q(0,"polygon",17)),2&n){const e=v();D("points",e.getTriangleCoordinate(e.lastEnd.get().x,e.lastEnd.get().y))}}function X4t(n,t){if(1&n&&(F(),Q(0,"polygon",18)),2&n){const e=v();We("id","selected_",e.chosenCoord.get().x,"_",e.chosenCoord.get().y,""),D("points",e.getTriangleCoordinate(e.chosenCoord.get().x,e.chosenCoord.get().y))}}const Q4t=function(n){return["base",n]};function J4t(n,t){if(1&n&&(F(),b(0,"g",20),Q(1,"polygon",21),b(2,"text",22),Tt(3),O()()),2&n){const e=v().$implicit,r=v();T("id","tilesCount"+e),S(1),T("ngClass",P3(8,Q4t,"player"+e+"-fill")),D("points",r.getTilesCountCoordinate(0===e?0:4.5,0===e?0:6))("stroke",r.lastTurnWasTilesExchange(e)?"yellow":"black"),S(1),D("x",r.SPACE_SIZE/2+r.SPACE_SIZE*(0==e?0:6.4))("y",16+r.SPACE_SIZE/2+r.SPACE_SIZE*(0===e?0:8.5))("font-size",r.SPACE_SIZE/2),S(1),l1(r.tiles[e])}}function elt(n,t){if(1&n&&(F(),b(0,"g"),x(1,J4t,4,10,"g",19),O()),2&n){const e=t.$implicit,r=v();S(1),T("ngIf",r.mustShowTilesOf(e))}}const tlt=function(){return[0,1]};let nlt=(()=>{class n extends Kce{constructor(e){super(e),this.tiles=[0,0],this.NONE=Ie.UNREACHABLE,this.chosenCoord=P.empty(),this.lastStart=P.empty(),this.lastEnd=P.empty(),this.possibleLandings=[],this.scores=P.of([0,0]),this.rules=new MP(w1),this.availableMinimaxes=[new Xce(this.rules,"Normal"),new F4t(this.rules,"Piece > Threat > Tiles")],this.encoder=Is.encoder,this.tutorial=(new Qce).tutorial,this.SPACE_SIZE=70,this.updateBoard()}updateBoard(){this.chosenCoord=P.empty(),this.state=this.getState(),this.scores=P.of(this.state.captures),this.tiles=this.state.tiles;const e=this.rules.node.move;e.isPresent()?(this.lastStart=e.get().start,this.lastEnd=e.get().landingCoord):(this.lastStart=P.empty(),this.lastEnd=P.empty()),this.board=this.getState().board}showHighlight(){this.possibleLandings=this.state.getLegalLandings(this.chosenCoord.get())}cancelMoveAttempt(){this.chosenCoord=P.empty(),this.possibleLandings=[]}onClick(e,r){var s=this;return A(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());const o=new M(e,r),c=s.state.getCurrentPlayer();return s.chosenCoord.equalsValue(o)?(s.cancelMoveAttempt(),G.SUCCESS):s.chosenCoord.isAbsent()||s.state.getPieceAt(o).is(c)?s.firstClick(o):s.secondClick(o)})()}firstClick(e){var r=this;return A(function*(){const s=r.state.getPieceAt(e);if(s.is(r.state.getCurrentOpponent())){const i=Is.fromTilesExchange(e);return r.chooseMove(i,r.state,r.state.captures)}return s.is(r.state.getCurrentPlayer())?(r.chosenCoord=P.of(e),r.showHighlight(),G.SUCCESS):r.cancelMove(Vm.FIRST_CLICK_SHOULD_NOT_BE_NULL())})()}secondClick(e){var r=this;return A(function*(){if(r.possibleLandings.some(s=>s.equals(e))){const s=Is.fromCoordToCoord(r.chosenCoord.get(),e);return r.chooseMove(s,r.state,r.state.captures)}return r.cancelMove(Vm.INVALID_DISTANCE())})()}isPyramid(e,r){return this.board[r][e].isPlayer()||this.wasOpponent(e,r)}wasOpponent(e,r){const s=this.rules.node.mother;return s.isPresent()&&s.get().gameState.getPieceAtXY(e,r).is(s.get().gameState.getCurrentOpponent())}getPyramidClass(e,r){const s=this.board[r][e];return s===Ie.ZERO?this.getPlayerClass(z.ZERO):s===Ie.ONE?this.getPlayerClass(z.ONE):"captured-fill"}isEmptySpace(e,r){return this.board[r][e]===Ie.EMPTY||this.wasRemoved(e,r)}wasRemoved(e,r){const i=this.rules.node.mother;if(this.board[r][e]===Ie.UNREACHABLE&&i.isPresent()){const o=i.get().gameState.getPieceAtXY(e,r);return o===Ie.EMPTY||o.is(i.get().gameState.getCurrentPlayer())}return!1}getEmptyClass(e,r){return this.board[r][e]===Ie.EMPTY?(e+r)%2==1?"background":"background2":"captured-alternate-fill"}getTilesCountCoordinate(e,r){const s=100*e,i=100*r,o=s+25;return o+", "+i+", "+(s+75)+", "+i+", "+(s+100)+", "+(i+50)+", "+(s+75)+", "+(i+100)+", "+(s+25)+", "+(i+100)+", "+(s+0)+", "+(i+50)+", "+o+", "+i}getLineCoordinate(e,r){const s=this.getTriangleCornerCoords(e,r);return e%3==0?s[0].x+","+s[0].y+","+s[1].x+","+s[1].y:e%3==1?s[0].x+","+s[0].y+","+s[2].x+","+s[2].y:s[1].x+","+s[1].y+","+s[2].x+","+s[2].y}mustShowTilesOf(e){return this.tiles[e]>0||this.lastTurnWasTilesExchange(e)}lastTurnWasTilesExchange(e){return!this.rules.node.mother.isAbsent()&&this.rules.node.mother.get().gameState.tiles[e]>this.tiles[e]}}return n.\u0275fac=function(e){return new(e||n)(J(Pn))},n.\u0275cmp=gt({type:n,selectors:[["app-coerceo"]],features:[l],decls:7,vars:8,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base no-fill selectable-stroke",4,"ngFor","ngForOf"],["class","base no-fill last-move-stroke",4,"ngIf"],["class","base no-fill selected-stroke",3,"id",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["class","base mid-stroke","stroke-linecap","round",3,"ngClass",4,"ngIf","ngIfElse"],["emptySpace",""],["class","base",3,"id",4,"ngIf"],["class","white-stroke",3,"id",4,"ngIf"],["stroke-linecap","round",1,"base","mid-stroke",3,"ngClass"],["class","base small-stroke","stroke-linecap","round",3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base","small-stroke",3,"ngClass"],[1,"base",3,"id"],[1,"white-stroke",3,"id"],[1,"base","no-fill","selectable-stroke"],[1,"base","no-fill","last-move-stroke"],[1,"base","no-fill","selected-stroke",3,"id"],[3,"id",4,"ngIf"],[3,"id"],["stroke-linecap","round",3,"ngClass"],["id","playerZeroTilesCount",1,"text-giant"]],template:function(e,r){1&e&&(F(),b(0,"svg",0),x(1,j4t,2,1,"g",1),x(2,Z4t,1,1,"polygon",2),x(3,Y4t,1,1,"polygon",3),x(4,K4t,1,1,"polygon",3),x(5,X4t,1,3,"polygon",4),x(6,elt,2,1,"g",1),O()),2&e&&(D("viewBox","-5 -5 "+(10+8*r.SPACE_SIZE)+" "+(10+10*r.SPACE_SIZE)),S(1),T("ngForOf",r.board),S(1),T("ngForOf",r.possibleLandings),S(1),T("ngIf",r.lastStart.isPresent()),S(1),T("ngIf",r.lastEnd.isPresent()),S(1),T("ngIf",r.chosenCoord.isPresent()),S(1),T("ngForOf",rr(7,tlt)))},dependencies:[dn,An,en],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class rlt extends G1{getListMoves(t){return this.sortByNumberOfJump(t.gameState.turn<40?this.getListMovesDrop(t.gameState):this.getListMovesAfterDrop(t.gameState))}sortByNumberOfJump(t){return t.sort((e,r)=>{const s=e.isDrop()?1:e.isSimple()?2:e.coords.length;return(r.isDrop()?1:r.isSimple()?2:r.coords.length)-s})}getListMovesDrop(t){const e=[],r=zt.CENTRAL_ZONE_TOP_LEFT,s=zt.CENTRAL_ZONE_BOTTOM_RIGHT;for(let i=r.y;i<=s.y;i++)for(let o=r.x;o<=s.x;o++)t.getPieceAtXY(o,i)===pe.NONE&&e.push(s8.of(new M(o,i)).get());return e}getListMovesAfterDrop(t){let e=[];const r=t.getCurrentPlayer();for(let s=0;s<zt.HEIGHT;s++)for(let i=0;i<zt.WIDTH;i++){const o=new M(i,s);t.getPieceAt(o)===r&&(e=e.concat(this.getListSimpleMoves(t,o)),e=e.concat(this.getListJumps(t,o)))}return e}getListSimpleMoves(t,e){const r=[],s=[new M(e.x+1,e.y),new M(e.x-1,e.y),new M(e.x,e.y+1),new M(e.x,e.y-1),new M(e.x+1,e.y+1),new M(e.x+1,e.y-1),new M(e.x-1,e.y+1),new M(e.x-1,e.y-1)];for(const i of s){const o=i8.from(e,i);o.isSuccess()&&Za.get().simpleMoveLegality(o.get(),t).isSuccess()&&r.push(o.get())}return r}getListJumps(t,e){const r=new Dt;for(const s of Za.get().jumpTargetsFrom(e)){const i=L3.of([e,s]).get();Za.get().jumpLegality(i,t).isSuccess()&&(r.add(i),r.addAll(this.getListJumpStartingFrom(t,i)))}return r.toList()}getListJumpStartingFrom(t,e){const r=Za.get().nextJumps(e,t),s=new Dt(r);for(const i of r)s.addAll(this.getListJumpStartingFrom(t,i));return s}getBoardValue(t){const e=t.gameState;let r=0;const s=new Vn([{key:z.ZERO,value:0},{key:z.ONE,value:0}]);for(let i=0;i<zt.HEIGHT;i++)for(let o=0;o<zt.WIDTH;o++){const c=new M(o,i),u=e.getPieceAt(c);if(u.isPlayer())if(e.isShelter(c)){if(r+=20*u.getScoreModifier(),s.replace(u,s.get(u).get()+1),20===s.get(u).get())return new Ct(u.getVictoryValue())}else{let h=100;for(const p of zt.ALL_SHELTERS)if(e.getPieceAt(p)===pe.NONE){const m=c.getOrthogonalDistance(p);h=Math.min(h,m)}r-=u.getScoreModifier()*h}}return new Ct(r)}}function slt(n,t){if(1&n){const e=Oe();F(),b(0,"rect",9),ee("click",function(){he(e);const s=v().$implicit;return le(v(2).onClick(s.coord))}),O()}if(2&n){const e=v().$implicit,r=v(2);D("x",1.5*r.STROKE_WIDTH+r.SPACE_SIZE*e.coord.x+r.STROKE_WIDTH)("y",1.5*r.STROKE_WIDTH+r.SPACE_SIZE*e.coord.y+r.STROKE_WIDTH)("width",r.SPACE_SIZE-3*r.STROKE_WIDTH)("height",r.SPACE_SIZE-3*r.STROKE_WIDTH)}}function ilt(n,t){if(1&n){const e=Oe();F(),b(0,"circle",6),ee("click",function(){he(e);const s=v().$implicit;return le(v(2).onClick(s.coord))}),O()}if(2&n){const e=v(),r=e.index,s=e.$implicit,i=v().index,o=v();We("id","piece_",r,"_",i,""),T("ngClass",s.pieceClasses),D("r",o.PIECE_RADIUS)("cx",o.SPACE_SIZE*r+o.STROKE_WIDTH+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*i+o.STROKE_WIDTH+o.SPACE_SIZE/2)}}function olt(n,t){if(1&n){const e=Oe();F(),b(0,"g")(1,"rect",6),ee("click",function(){const i=he(e).$implicit;return le(v(2).onClick(i.coord))}),O(),x(2,slt,1,4,"rect",7),x(3,ilt,1,6,"circle",8),O()}if(2&n){const e=t.$implicit,r=t.index,s=v().index,i=v();S(1),We("id","click_",r,"_",s,""),T("ngClass",e.squareClasses),D("x",i.SPACE_SIZE*r+i.STROKE_WIDTH)("y",i.SPACE_SIZE*s+i.STROKE_WIDTH)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),S(1),T("ngIf",e.isShelter),S(1),T("ngIf",e.hasPiece)}}function alt(n,t){if(1&n&&(F(),b(0,"g"),x(1,olt,4,9,"g",1),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e)}}function clt(n,t){if(1&n){const e=Oe();F(),b(0,"g")(1,"rect",10),ee("click",function(){const i=he(e).$implicit;return le(v().onClick(i))}),O()()}if(2&n){const e=t.$implicit,r=v();S(1),T("ngClass",r.viewInfo.boardInfo[e.y][e.x].shelterClasses),D("x",r.SPACE_SIZE*e.x+r.STROKE_WIDTH)("y",r.SPACE_SIZE*e.y+r.STROKE_WIDTH)("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)}}function llt(n,t){if(1&n&&(F(),Q(0,"circle",11)),2&n){const e=t.$implicit,r=v();y1("id","sidePiece_0_",e,""),D("cx",-r.PIECE_RADIUS)("cy",1670-e*r.PIECE_RADIUS)("r",r.PIECE_RADIUS-5)}}function ult(n,t){if(1&n&&(F(),Q(0,"circle",12)),2&n){const e=t.$implicit,r=v();y1("id","sidePiece_1_",e,""),D("cx",1715+r.PIECE_RADIUS)("cy",1670-e*r.PIECE_RADIUS)("r",r.PIECE_RADIUS-5)}}function flt(n,t){if(1&n&&(F(),Q(0,"rect",13)),2&n){const e=v();D("x",e.SPACE_SIZE*e.CENTRAL_ZONE_START.x+e.STROKE_WIDTH)("y",e.SPACE_SIZE*e.CENTRAL_ZONE_START.y+e.STROKE_WIDTH)("width",e.CENTRAL_ZONE_SIZE.x*e.SPACE_SIZE)("height",e.CENTRAL_ZONE_SIZE.y*e.SPACE_SIZE)}}let hlt=(()=>{class n extends t8{constructor(e){super(e),this.ALL_SHELTERS=zt.ALL_SHELTERS,this.CENTRAL_ZONE_START=zt.CENTRAL_ZONE_TOP_LEFT,this.CENTRAL_ZONE_SIZE=new Gt(zt.CENTRAL_ZONE_BOTTOM_RIGHT.x-zt.CENTRAL_ZONE_TOP_LEFT.x+1,zt.CENTRAL_ZONE_BOTTOM_RIGHT.y-zt.CENTRAL_ZONE_TOP_LEFT.y+1),this.viewInfo={dropPhase:!0,boardInfo:[],victory:[],lastMoveArrow:"",sidePieces:[20,20]},this.selected=P.empty(),this.jumpInConstruction=P.empty(),this.PIECE_RADIUS=this.SPACE_SIZE/2-this.STROKE_WIDTH,this.rules=Za.get(),this.availableMinimaxes=[new rlt(this.rules,"ConspirateursMinimax")],this.encoder=V4t,this.tutorial=(new jce).tutorial}ngOnInit(){this.updateBoard()}updateBoard(){this.updateViewInfo(),this.rules.node.move.isPresent()&&this.showLastMove()}updateViewInfo(){const e=this.getState();this.viewInfo.dropPhase=e.isDropPhase(),this.viewInfo.boardInfo=[],this.viewInfo.lastMoveArrow="";for(let r=0;r<zt.HEIGHT;r++){this.viewInfo.boardInfo.push([]);for(let s=0;s<zt.WIDTH;s++){const i=new M(s,r),o=e.getPieceAt(i),c={coord:i,squareClasses:[],shelterClasses:[],pieceClasses:[this.getPlayerClass(o)],hasPiece:o.isPlayer(),isShelter:!1,isOccupiedShelter:!1};this.viewInfo.boardInfo[r].push(c)}}this.viewInfo.sidePieces=e.getSidePieces(),this.updateOccupiedShelters(),this.updateSelected(),this.updateVictory()}updateOccupiedShelters(){for(const e of zt.ALL_SHELTERS){const r=this.viewInfo.boardInfo[e.y][e.x];r.isShelter=!0,r.hasPiece&&r.shelterClasses.push("selectable-stroke")}}updateSelected(){if(this.selected.isPresent())if(this.jumpInConstruction.isPresent()){const e=this.jumpInConstruction.get(),r=e.getStartingCoord(),s=e.getEndingCoord();this.viewInfo.boardInfo[r.y][r.x].hasPiece=!1,this.viewInfo.boardInfo[s.y][s.x].pieceClasses=[this.getPlayerClass(this.getCurrentPlayer()),"selected-stroke"],this.viewInfo.boardInfo[s.y][s.x].hasPiece=!0;for(const i of e.coords)this.viewInfo.boardInfo[i.y][i.x].squareClasses.push("moved-fill")}else{const e=this.selected.get();this.viewInfo.boardInfo[e.y][e.x].pieceClasses.push("selected-stroke")}}updateVictory(){const e=this.getState(),r=Za.get().getGameStatus(this.rules.node);if(!0===r.isEndGame)for(const s of zt.ALL_SHELTERS)e.getPieceAt(s)===r.winner&&this.viewInfo.boardInfo[s.y][s.x].squareClasses.push("victory-fill")}showLastMove(){const e=this.rules.node.move.get();if(e.isDrop())this.viewInfo.boardInfo[e.coord.y][e.coord.x].squareClasses.push("moved-fill");else if(e.isSimple())this.viewInfo.boardInfo[e.getStart().y][e.getStart().x].squareClasses.push("moved-fill"),this.viewInfo.boardInfo[e.getEnd().y][e.getEnd().x].squareClasses.push("moved-fill");else{this.viewInfo.lastMoveArrow="";for(const r of e.coords)this.viewInfo.boardInfo[r.y][r.x].squareClasses.push("moved-fill"),this.viewInfo.lastMoveArrow+=r.x*this.SPACE_SIZE+this.SPACE_SIZE/2+this.STROKE_WIDTH,this.viewInfo.lastMoveArrow+=" ",this.viewInfo.lastMoveArrow+=r.y*this.SPACE_SIZE+this.SPACE_SIZE/2+this.STROKE_WIDTH,this.viewInfo.lastMoveArrow+=" "}}cancelMoveAttempt(){this.jumpInConstruction=P.empty(),this.selected=P.empty(),this.updateBoard()}onClick(e){var r=this;return A(function*(){const s=r.canUserPlay("#click_"+e.x+"_"+e.y);if(s.isFailure())return r.cancelMove(s.getReason());const i=r.getState();if(i.getPieceAt(e)===r.getCurrentPlayer())return r.selected.equalsValue(e)?r.cancelMoveAttempt():(r.selected=P.of(e),r.jumpInConstruction=P.empty()),r.updateViewInfo(),G.SUCCESS;if(r.jumpInConstruction.isPresent())return r.constructJump(e);if(r.selected.isPresent())return r.selectNextCoord(e);if(i.isDropPhase()){const o=s8.of(e);return ve(o.isSuccess(),"ConspirateursMove should be valid by construction"),r.chooseMove(o.get(),i)}return r.cancelMove(tt.MUST_CHOOSE_PLAYER_PIECE())})()}constructJump(e){var r=this;return A(function*(){const s=r.jumpInConstruction.get(),i=r.getState();if(e.equals(s.getEndingCoord()))return r.chooseMove(s,i);{const o=s.addJump(e);if(o.isFailure())return r.cancelMove(o.getReason());const c=r.rules.jumpLegality(o.get(),i);return c.isFailure()?r.cancelMove(c.getReason()):r.updateJump(o.get())}})()}updateJump(e){var r=this;return A(function*(){const s=r.getState();return r.rules.jumpHasPossibleNextTargets(e,s)?(r.jumpInConstruction=P.of(e),r.updateViewInfo(),G.SUCCESS):r.chooseMove(e,s)})()}selectNextCoord(e){var r=this;return A(function*(){const s=r.selected.get(),i=i8.from(s,e);if(i.isSuccess())return r.chooseMove(i.get(),r.getState());{const o=L3.of([s,e]);return o.isFailure()?r.cancelMove(o.getReason()):r.updateJump(o.get())}})()}}return n.\u0275fac=function(e){return new(e||n)(J(Pn))},n.\u0275cmp=gt({type:n,selectors:[["app-conspirateurs"]],features:[l],decls:7,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-100 0 1915 1715","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base mid-stroke player0-fill",3,"id",4,"ngFor","ngForOf"],["class","base mid-stroke player1-fill",3,"id",4,"ngFor","ngForOf"],["class","base no-fill selectable-stroke mid-stroke",4,"ngIf"],["id","lastJump",1,"base","no-fill"],[1,"base",3,"id","ngClass","click"],["class","base no-fill mid-stroke",3,"click",4,"ngIf"],["class","base",3,"id","ngClass","click",4,"ngIf"],[1,"base","no-fill","mid-stroke",3,"click"],[1,"base","no-fill","mid-stroke",3,"ngClass","click"],[1,"base","mid-stroke","player0-fill",3,"id"],[1,"base","mid-stroke","player1-fill",3,"id"],[1,"base","no-fill","selectable-stroke","mid-stroke"]],template:function(e,r){1&e&&(F(),b(0,"svg",0),x(1,alt,2,1,"g",1),x(2,clt,2,5,"g",1),x(3,llt,1,4,"circle",2),x(4,ult,1,4,"circle",3),x(5,flt,1,4,"rect",4),Q(6,"polyline",5),O()),2&e&&(S(1),T("ngForOf",r.viewInfo.boardInfo),S(1),T("ngForOf",r.ALL_SHELTERS),S(1),T("ngForOf",r.ArrayUtils.range(r.viewInfo.sidePieces[0])),S(1),T("ngForOf",r.ArrayUtils.range(r.viewInfo.sidePieces[1])),S(1),T("ngIf",r.viewInfo.dropPhase),S(1),D("points",r.viewInfo.lastMoveArrow))},dependencies:[dn,An,en],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class dlt extends G1{getListMoves(t){const e=t.gameState,r=this.getListDrops(e),s=this.getListShifts(e);return r.concat(s)}getListShifts(t){const e=[],r=this.getShiftSources(t);for(const s of r)for(const i of[new A2(s,"clockwise"),new A2(s,"counterclockwise")])R3.get().shiftHeightValidity(i,t).isSuccess()&&e.push(i);return e}getListDrops(t){const e=this.getRemainingPiecesForCurrentPlayer(t),r=[];for(let s=0;s<$r.WIDTH;s++)for(const i of e){const o=new o8(s,i);R3.get().dropHeightValidity(o,t).isSuccess()&&r.push(o)}return r}getRemainingPiecesForCurrentPlayer(t){const e=[];for(const r of Mn.PLAYER_PIECES)this.currentPlayerCanDropPiece(t,r)&&e.push(r);return e}currentPlayerCanDropPiece(t,e){return t.getCurrentPlayer()===e.owner&&t.getRemainingPiecesOf(e)>0}getShiftSources(t){const e=[],r=t.getCurrentPlayer();for(let s=0;s<$r.HEIGHT;s++)for(let i=0;i<$r.WIDTH;i++)t.getPieceAtXY(i,s).owner===r&&e.push(new M(i,s));return e}getBoardValue(t){const e=R3.get().getGameStatus(t);return e.isEndGame?e.toBoardValue():new Ct(0)}}function plt(n,t){if(1&n){const e=Oe();F(),b(0,"g",6)(1,"path",7),ee("click",function(){const i=he(e).$implicit;return le(v().onSpaceClick(i))}),O(),b(2,"path",8),ee("click",function(){const i=he(e).$implicit;return le(v().onSpaceClick(i))}),O()()}if(2&n){const e=t.$implicit,r=v();y1("id","board_space_",e,""),S(1),y1("id","click_",e,""),T("ngClass",r.viewInfo.boardInfo[e].spaceClasses),D("d",r.BOARD_PATHS[e]),S(1),T("ngClass",r.viewInfo.boardInfo[e].spaceClasses),D("d",r.DECORATION_PATHS[e])}}function glt(n,t){if(1&n){const e=Oe();F(),b(0,"g",10),ee("click",function(){const i=he(e).$implicit,o=v().$implicit;return le(v().onPieceInGameClick(o,i.y))}),Q(1,"use",11)(2,"use",12),O()}if(2&n){const e=t.$implicit;We("id","click_",v().$implicit,"_",e.y,""),T("ngClass",e.foregroundClasses),S(1),T("ngClass",e.backgroundClasses),D("x",e.drawPosition.x)("y",e.drawPosition.y),S(1),D("x",e.drawPosition.x)("y",e.drawPosition.y)}}function mlt(n,t){if(1&n&&(F(),b(0,"g"),x(1,glt,3,8,"g",9),O()),2&n){const e=t.$implicit,r=v();S(1),T("ngForOf",r.viewInfo.boardInfo[e].pieces)}}function _lt(n,t){if(1&n){const e=Oe();F(),b(0,"g",14),ee("click",function(){const s=he(e),i=s.$implicit,o=s.index;return le(v(2).onRemainingPieceClick(i.actualPiece,o))}),Q(1,"use",11)(2,"use",12),O()}if(2&n){const e=t.$implicit,r=t.index;j2("id","piece_",e.actualPiece.owner.toString(),"_",e.actualPiece.otherPieceType?1:0,"_",r,""),T("ngClass",e.foregroundClasses),S(1),T("ngClass",e.backgroundClasses),D("x",e.drawPosition.x)("y",e.drawPosition.y),S(1),D("x",e.drawPosition.x)("y",e.drawPosition.y)}}function vlt(n,t){if(1&n&&(F(),b(0,"g"),x(1,_lt,3,9,"g",13),O()),2&n){const e=t.$implicit,r=v();S(1),T("ngForOf",r.viewInfo.remainingPieces.get(e).get())}}const Clt=function(){return[0,1,2,3,4,5,6,7]},ylt=function(){return[2,1,3,0,4,7,5,6]};class D3 extends t8{constructor(t){super(t),this.BOARD_PATHS=["M 2.8324855,277.57643 164.46619,228.81694 170.57257,148.42756 32.571357,104.19835 Z","M 170.57257,148.42237 246.4213,96.276913 195.13813,2.0233391 32.571357,104.19315 Z","m 195.14159,2.0268021 205.0898,0.010821 -52.1686,94.2453509 -101.64149,-0.0057 z","M 348.06279,96.281239 400.23529,2.0330788 564.39307,104.19207 424.66384,148.41891 Z","m 424.66384,148.42237 7.27882,80.37683 164.9712,48.72701 -32.52079,-173.33068 z","m 431.94266,228.80481 -75.73854,62.15055 79.06197,135.86929 161.64688,-149.29953 z","m 356.20412,290.9506 79.06197,135.86929 -268.2864,0.0433 74.14082,-135.90175 z","M 241.12051,290.96379 166.97969,426.86556 2.8324855,277.57708 164.46619,228.81759 Z"],this.DECORATION_PATHS=["m 170.57257,148.42302 v 40.08918 l -6.11049,80.38634 v -40.09025 z","m 170.57646,188.51696 v -40.08918 l 75.8509,-52.140047 v 40.086147 z","m 246.42323,96.285785 v 40.086155 l 101.63847,-0.003 0.001,-40.082256 z","m 424.66037,148.42345 v 40.08377 l -76.60213,-52.14178 10e-4,-40.082033 z","m 424.66037,148.42193 v 40.08377 l 7.27884,80.37445 v -40.08377 z","m 435.26609,466.90582 v -40.08615 l 161.64688,-149.2995 8.9e-4,40.08701 z","m 166.97969,426.86815 v 40.08638 l 268.28379,-0.0433 v -40.08031 z","m 2.8324855,277.57297 v 40.08636 L 166.97969,466.94782 v -40.08636 z"],this.selected=P.empty(),this.viewInfo={boardInfo:[],remainingPieces:new Vn([{key:z.ZERO,value:[]},{key:z.ONE,value:[]}])},this.rules=R3.get(),this.availableMinimaxes=[new dlt(this.rules,"DiamDummyMinimax")],this.encoder=H4t,this.tutorial=(new Yce).tutorial}ngOnInit(){this.updateBoard()}onSpaceClick(t){var e=this;return A(function*(){const r=e.canUserPlay("#click_"+t);return r.isFailure()?e.cancelMove(r.getReason()):e.onSpaceClickAfterCheck(t)})()}onSpaceClickAfterCheck(t){var e=this;return A(function*(){if(e.selected.isPresent()){const r=e.selected.get();let s;if("pieceFromReserve"===r.type)s=new o8(t,r.piece);else if((r.position.x+1)%$r.WIDTH===t)s=new A2(r.position,"clockwise");else{if((r.position.x+($r.WIDTH-1))%$r.WIDTH!==t)return e.cancelMove(zm.MUST_SHIFT_TO_NEIGHBOR());s=new A2(r.position,"counterclockwise")}return e.chooseMove(s,e.getState())}return e.cancelMove(zm.MUST_SELECT_PIECE_FIRST())})()}onPieceInGameClick(t,e){var r=this;return A(function*(){const s=r.canUserPlay("#click_"+t+"_"+e);if(s.isFailure())return r.cancelMove(s.getReason());const i=new M(t,e);return r.getState().getPieceAt(i).owner===r.getCurrentPlayer()?(r.isSelected(null,i)?r.cancelMoveAttempt():r.selected=P.of({type:"pieceFromBoard",position:i}),r.updateViewInfo(),G.SUCCESS):r.selected.isPresent()?r.onSpaceClickAfterCheck(t):r.cancelMove(tt.MUST_CHOOSE_PLAYER_PIECE())})()}onRemainingPieceClick(t,e){var r=this;return A(function*(){const s=r.canUserPlay(r.getPieceId(t,e));return s.isFailure()?r.cancelMove(s.getReason()):t.owner===r.getCurrentPlayer()?(r.selected=r.isSelected(t)?P.empty():P.of({type:"pieceFromReserve",piece:t}),r.updateViewInfo(),G.SUCCESS):r.cancelMove(tt.MUST_CHOOSE_PLAYER_PIECE())})()}getPieceId(t,e){return"#piece_"+t.owner.toString()+"_"+(t.otherPieceType?1:0)+"_"+e}isSelected(t,e){return!this.selected.isAbsent()&&(null==t&&"pieceFromBoard"===this.selected.get().type?this.selected.get().position.equals(e):this.selected.get().piece===t)}updateBoard(){this.updateViewInfo(),this.rules.node.move.isPresent()&&this.showLastMove()}getLastMovedFromDrop(t,e){const r=this.getDrawPositionRemainingPiece(t.piece,e.getRemainingPiecesOf(t.piece)-1),s=t.getTarget(),i=e.getStackHeight(t.getTarget()),o=this.getDrawPositionOnBoard(s,i),c=new M(s,i);return[{start:P.empty(),end:c,startDrawPosition:r,endDrawPosition:o}]}getLastMovedFromShift(t,e){const r=t.start.x,s=t.getTarget();let i=e.getStackHeight(s);const o=[];for(let c=t.start.y;c<$r.HEIGHT&&e.getPieceAtXY(r,c)!==Mn.EMPTY;c++,i++)o.push({start:P.of(new M(r,c)),end:new M(s,i),startDrawPosition:this.getDrawPositionOnBoard(r,c),endDrawPosition:this.getDrawPositionOnBoard(s,i)});return o}updateViewInfo(){this.updateBoardInfo(),this.updateRemainingPiecesInfo()}updateBoardInfo(){for(let t=0;t<$r.WIDTH;t++)this.viewInfo.boardInfo[t]={x:t,spaceClasses:[],pieces:this.getPieces(t)}}showLastMove(){this.showLastMoveOnSpaces(),this.showLastMoveOnPieces()}showLastMoveOnSpaces(){const t=this.rules.node.move;ve(t.isPresent(),"showLastMoveOnSpaces called without a last move");const e=t.get();for(let r=0;r<$r.WIDTH;r++){const s=[];e.isDrop()?e.getTarget()===r&&s.push("moved-fill"):(e.getTarget()===r||e.start.x===r)&&s.push("moved-fill"),this.viewInfo.boardInfo[r].spaceClasses=s}}showLastMoveOnPieces(){const t=this.rules.node.move;ve(t.isPresent(),"showLastMoveOnPieces called without a last move");const e=t.get(),r=this.getPreviousState();let s=[];s=e.isDrop()?this.getLastMovedFromDrop(e,r):this.getLastMovedFromShift(e,r);for(const i of s)this.viewInfo.boardInfo[i.end.x].pieces[i.end.y].foregroundClasses.push("last-move-stroke")}updateRemainingPiecesInfo(){const t=this.getCurrentPlayer();this.viewInfo.remainingPieces=new Vn([{key:z.ZERO,value:[]},{key:z.ONE,value:[]}]);const e=this.isPlayerTurn();for(const r of Mn.PLAYER_PIECES){const s=this.getState().getRemainingPiecesOf(r);for(let i=0;i<s;i++){const o=[];this.isTopPieceOfReserveAndSelected(i,s,r)&&o.push("selected-stroke"),e&&i===s-1&&r.owner===t&&o.push("clickable-stroke-hover");const c=this.viewInfo.remainingPieces.get(r.owner).get(),u=[];u.push(r.otherPieceType?"player"+r.owner.value+"-alternate-fill":"player"+r.owner.value+"-fill"),c.push({backgroundClasses:u,foregroundClasses:o,y:i,drawPosition:this.getDrawPositionRemainingPiece(r,i),actualPiece:r}),this.viewInfo.remainingPieces.put(r.owner,c)}}}isTopPieceOfReserveAndSelected(t,e,r){if(this.selected.isPresent()){const s=this.selected.get();return"pieceFromReserve"===s.type&&s.piece===r&&t===e-1}return!1}getDrawPositionRemainingPiece(t,e){let r,s;return r=t.owner===z.ZERO?-100:600,s=t.otherPieceType?100:450,new M(r,s).getNext(new Gt(0,-e*D3.PIECE_HEIGHT))}getPieces(t){const e=this.rules.findHighestAlignment(this.getState()),r=this.isPlayerTurn(),s=[];for(let i=0;i<$r.HEIGHT;i++){const o=this.getState().getPieceAtXY(t,i),c=new M(t,i);if(o!==Mn.EMPTY){const u=[];this.pieceFromBoardIsSelected(t,i)&&u.push("selected-stroke"),this.isVictory(t,i,e)&&u.push("victory-stroke"),r&&this.rules.pieceCanMove(this.getState(),c)&&u.push("clickable-stroke-hover"),s.push({backgroundClasses:["player"+o.owner.value+(o.otherPieceType?"-alternate-fill":"-fill")],foregroundClasses:u,y:i,drawPosition:this.getDrawPositionOnBoard(t,i),actualPiece:o})}}return s}pieceFromBoardIsSelected(t,e){if(this.selected.isPresent()){const r=this.selected.get();return"pieceFromBoard"===r.type&&r.position.x===t&&r.position.y===e}return!1}isVictory(t,e,r){if(r.isPresent()){const s=r.get();return s.x%4==t%4&&s.y===e}return!1}getDrawPositionOnBoard(t,e){return D3.CENTER[t].getNext(new Gt(0,-e*D3.PIECE_HEIGHT))}cancelMoveAttempt(){this.selected=P.empty(),this.updateBoard()}}D3.CENTER=[new M(40,160),new M(100,50),new M(255,2),new M(400,50),new M(460,160),new M(400,270),new M(255,320),new M(100,270)],D3.PIECE_HEIGHT=36,D3.\u0275fac=function(t){return new(t||D3)(J(Pn))},D3.\u0275cmp=gt({type:D3,selectors:[["app-diam"]],features:[l],decls:8,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-110 -120 800 710","preserveAspectRatio","xMidYMid meet"],["id","piece"],["d","M 0 15 v 35 A 40 15, 0, 0, 0, 80 50 v -35 A 40 15, 0, 0, 0, 0 15 Z"],["cx","40","cy","15","rx","40","ry","15"],[3,"id",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],[3,"id"],[1,"base","mid-stroke",3,"id","ngClass","click"],[1,"base","mid-stroke","high-brightness",3,"ngClass","click"],["pointer-events","fill","class","base-no-fill no-fill mid-small-stroke",3,"id","ngClass","click",4,"ngFor","ngForOf"],["pointer-events","fill",1,"base-no-fill","no-fill","mid-small-stroke",3,"id","ngClass","click"],[0,"xlink","href","#piece",1,"base","mid-stroke",3,"ngClass"],[0,"xlink","href","#piece"],["class","base-no-fill no-fill mid-small-stroke",3,"id","ngClass","click",4,"ngFor","ngForOf"],[1,"base-no-fill","no-fill","mid-small-stroke",3,"id","ngClass","click"]],template:function(t,e){1&t&&(F(),b(0,"svg",0)(1,"defs")(2,"g",1),Q(3,"path",2)(4,"ellipse",3),O()(),x(5,plt,3,6,"g",4),x(6,mlt,2,1,"g",5),x(7,vlt,2,1,"g",5),O()),2&t&&(S(5),T("ngForOf",rr(3,Clt)),S(1),T("ngForOf",rr(4,ylt)),S(1),T("ngForOf",e.Player.PLAYERS))},dependencies:[dn,An],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});class Ya{constructor(t,e){this.offset=t,this.constant=e}static fromTwoCoords(t,e){const r=t.x,s=e.x,i=t.y,o=e.y,c=r+i,u=s+o;return r===s&&i!==o&&c!==u?P.of(Ya.constantQ(r)):r!==s&&i===o&&c!==u?P.of(Ya.constantR(i)):r!==s&&i!==o&&c===u?P.of(Ya.constantS(c)):P.empty()}static constantQ(t){return new Ya(t,"q")}static constantR(t){return new Ya(t,"r")}static constantS(t){return new Ya(t,"s")}static areOnSameLine(t){if(t.length<2)return!0;const e=Ya.fromTwoCoords(t[0],t[1]);if(e.isAbsent())return!1;const r=e.get();for(const s of t.slice(2))if(!1===r.contains(s))return!1;return!0}toString(){return`Line(${this.constant}, ${this.offset})`}equals(t){return this===t||!(this.offset!==t.offset||this.constant!==t.constant)}contains(t){switch(this.constant){case"q":return t.x===this.offset;case"r":return t.y===this.offset;case"s":return t.x+t.y===this.offset}}getDirection(){switch(this.constant){case"q":return Le.DOWN;case"r":return Le.RIGHT;case"s":return Le.DOWN_LEFT}}}class OH extends es{constructor(t,e,r,s,i,o){super(e,t),this.board=e,this.width=r,this.height=s,this.excludedSpaces=i,this.empty=o,ve(this.excludedSpaces.length<this.height/2+1,"Invalid excluded spaces specification for HexagonalGameState.")}setAt(t,e){if(this.isOnBoard(t))return this.setAtUnsafe(t,e);throw new Error("Setting coord not on board: "+t+".")}equalsT(t,e){if(this===t)return!0;if(this.width!==t.width||this.height!==t.height||!1===e(this.empty,t.empty)||this.excludedSpaces.length!==t.excludedSpaces.length)return!1;for(let r=0;r<this.excludedSpaces.length;r++)if(this.excludedSpaces[r]!==t.excludedSpaces[r])return!1;for(const r of this.allCoords())if(!1===e(this.getPieceAt(r),t.getPieceAt(r)))return!1;return!0}allCoords(){const t=[];return this.forEachCoord(e=>{t.push(e)}),t}allLines(){const t=[];for(let e=0;e<this.width;e++)t.push(Ya.constantQ(e));for(let e=0;e<this.height;e++)t.push(Ya.constantR(e));for(let e=this.excludedSpaces.length;e<this.height+this.excludedSpaces.length;e++)t.push(Ya.constantS(e));return t}getEntranceOnLine(t){let e,r;switch(t.constant){case"q":return r=null!=this.excludedSpaces[t.offset]?this.excludedSpaces[t.offset]:0,this.findEntranceFrom(t,new M(t.offset,r));case"r":return e=null!=this.excludedSpaces[t.offset]?this.excludedSpaces[t.offset]:0,this.findEntranceFrom(t,new M(e,t.offset));case"s":return this.findEntranceFrom(t,t.offset<this.width?new M(t.offset,0):new M(this.width-1,t.offset-this.width+1))}}findEntranceFrom(t,e){const r=t.getDirection();let s=e;for(let o=0;o<Math.max(this.width,this.height);o++){if(this.isOnBoard(s))return s;s=s.getNext(r)}const i=Os.logError("HexagonalGameState.findEntranceFrom","could not find a board entrance, board must be invalid",{start:e.toString(),line:t.toString()});throw new Error(i.getReason())}}class I2{static getNeighbors(t,e=1){const r=[];for(const s of Le.factory.all)r.push(t.getNext(s,e));return r}static areNeighbors(t,e){for(const r of Le.factory.all)if(t.getNext(r).equals(e))return!0;return!1}}class t1{constructor(t,e,r){this.owner=t,this.size=e,this.source=r}static append(t,e){return new t1(t.owner,t.size+e.size,t.source||e.source)}getValue(){return t1.encoder.encodeNumber(this)}getOwner(){return this.owner}belongsTo(t){return this.owner===t}containsSource(){return this.source}isEmpty(){return 0===this.size}hasPieces(){return!1===this.isEmpty()}getSize(){return this.size}toString(){return"DvonnPieceStack("+this.owner.toString()+", "+this.size+", "+this.source+")"}}t1.sizeEncoder=Cn.numberEncoder(49),t1.encoder=Cn.tuple([Cn.booleanEncoder,z.numberEncoder,t1.sizeEncoder],n=>[n.source,n.owner,n.size],n=>new t1(n[1],n[2],n[0])),t1.MAX_SIZE=49,t1.EMPTY=new t1(pe.NONE,0,!1),t1.UNREACHABLE=new t1(pe.NONE,-1,!1),t1.PLAYER_ZERO=new t1(z.ZERO,1,!1),t1.PLAYER_ONE=new t1(z.ONE,1,!1),t1.SOURCE=new t1(pe.NONE,1,!0);let Ka=(()=>{class n extends OH{constructor(e,r,s){super(r,e,n.WIDTH,n.HEIGHT,n.EXCLUDED_SPACES,t1.EMPTY),this.alreadyPassed=s}static balancedBoard(){const e=t1.UNREACHABLE,r=t1.PLAYER_ZERO,s=t1.PLAYER_ONE,i=t1.SOURCE;return[[e,e,r,s,s,s,r,r,s,i,s],[e,s,s,r,r,r,s,s,r,s,s],[s,s,s,s,r,i,s,r,r,r,r],[r,r,s,r,r,s,s,s,r,r,e],[r,i,r,s,s,r,r,r,s,e,e]]}static isOnBoard(e){return!e.isNotInRange(n.WIDTH,n.HEIGHT)&&n.balancedBoard()[e.y][e.x]!==t1.UNREACHABLE}static getInitialState(){return new n(n.balancedBoard(),0,!1)}getAllPieces(){const e=[];for(let r=0;r<n.HEIGHT;r++)for(let s=0;s<n.WIDTH;s++){const i=new M(s,r);this.isOnBoard(i)&&this.getPieceAt(i).hasPieces()&&e.push(i)}return e}numberOfNeighbors(e){return I2.getNeighbors(e,1).filter(i=>this.isOnBoard(i)&&this.getPieceAt(i).hasPieces()).length}setAtUnsafe(e,r){const s=Ke.copyBiArray(this.board);return s[e.y][e.x]=r,new n(s,this.turn,this.alreadyPassed)}isOnBoard(e){return!e.isNotInRange(this.width,this.height)&&this.board[e.y][e.x]!==t1.UNREACHABLE}}return n.WIDTH=11,n.HEIGHT=5,n.EXCLUDED_SPACES=[2,1],n})();class Ir extends r8{constructor(t,e){super(t,e)}static from(t,e){return-1===t.x&&-1===t.y&&-2===e.x&&-2===e.y?U.success(Ir.PASS):Ka.isOnBoard(t)?Ka.isOnBoard(e)?t.y===e.y||t.x===e.x||t.x+t.y===e.x+e.y?U.success(new Ir(t,e)):U.failure("Invalid move"):U.failure("End coord of DvonnMove must be on the board, not at "+t.toString()):U.failure("Starting coord of DvonnMove must be on the board, not at "+t.toString())}static of(t,e){const r=Ir.from(t,e);if(r.isSuccess())return r.get();throw new Error(r.getReason())}toString(){return this===Ir.PASS?"DvonnMove.PASS":"DvonnMove("+this.getStart()+"->"+this.getEnd()+")"}length(){return this.getStart().y===this.getEnd().y?Math.abs(this.getStart().x-this.getEnd().x):(this.getStart(),this.getEnd(),Math.abs(this.getStart().y-this.getEnd().y))}equals(t){return t===this||!!t.getStart().equals(this.getStart())&&t.getEnd().equals(this.getEnd())}}Ir.PASS=new Ir(new M(-1,-1),new M(-2,-2)),Ir.encoder=Lc.getEncoder(Ir.from);const me=t1.EMPTY,Ur=t1.UNREACHABLE,a8=t1.SOURCE,P9=t1.PLAYER_ZERO,T9=t1.PLAYER_ONE,Elt=new t1(z.ZERO,2,!1),NH=new t1(z.ONE,2,!1),Jce=new t1(z.ZERO,4,!1),Mlt=new t1(z.ONE,4,!1);class e3e extends K1{constructor(){super(...arguments),this.tutorial=[ce.anyMove($localize`Moving`,$localize`At Dvonn, each hexagonal space contains a stack of pieces.
        If no number is indicated on a stack, it means that it only contains one piece.
        The number written on a stack indicates the number of pieces within that stack, hence the number of points its owner gets.
        The owner of a stack is the one that has a piece at the top of the stack.
        Only the owner of a stack can move it.
        A stack cannot be moved if it is surrounded by 6 other stacks.
        A stack is moved by as many spaces as there are pieces within, in a straight line, and it should land on an occupied space.
        This line cannot move along the vertex of two neighboring spaces, as would a vertical move.
        Therefore, there are six possible directions.
        The player with dark pieces starts.<br/><br/>
        You're playing Dark, click on a stack and move it by one space.`,Ka.getInitialState(),Ir.of(new M(2,0),new M(3,0)),$localize`Congratulations!`),ce.fromPredicate($localize`Disconnection`,$localize`Pieces with a lightning strike are called "sources".
        When a stack is not directly nor indirectly connected to a source, it is removed from the board.<br/><br/>
        You're playing Dark, try to disconnect the stack of 4 pieces from your opponent. There are two ways of doing that, one is better than the other: try to find that one!`,new Ka([[Ur,Ur,T9,a8,me,me,me,me,me,me,me],[Ur,me,P9,me,me,me,me,me,me,me,me],[me,me,Mlt,me,me,me,me,T9,a8,me,me],[me,me,me,me,me,me,me,me,me,me,Ur],[me,me,me,me,me,me,me,me,me,Ur,Ur]],0,!1),Ir.of(new M(2,1),new M(2,0)),(t,e,r)=>t.getEnd().equals(new M(3,0))?G.failure($localize`You have successfully disconnected the stack of 4 pieces of your opponent, but on the next move your opponent will be able to move on your new stack, and to win the game! There exists a better outcome of this situation, try to find it.`):(ve(t.getEnd().equals(new M(2,0)),"player made an impossible move"),G.SUCCESS),$localize`Nice, you have disconnected 4 pieces of your opponent, and your new stack cannot be reached by your opponent!
        Your opponent therefore lost 5 points: 4 from the disconnected stack, and one from the stack on which you moved.
        Disconnected stacks will not be visible at the next turn.`),ce.fromPredicate($localize`Moving on a source`,$localize`You are allowed to move your stacks on any other stack.
        This means that you can take control of a source by moving one of your stack on top of it.
        This way, you know that this stack may never be disconnected, as it contains a source.<br/><br/>
        You're playing Dark and you can take control of a source, do it!`,new Ka([[Ur,Ur,a8,T9,me,me,me,me,me,me,me],[Ur,P9,P9,me,me,me,me,me,me,me,me],[me,T9,P9,T9,me,me,P9,NH,a8,me,me],[me,me,T9,me,me,me,me,me,me,me,Ur],[me,me,me,me,me,me,me,me,me,Ur,Ur]],0,!1),Ir.of(new M(2,1),new M(2,0)),(t,e,r)=>t.getEnd().equals(new M(2,0))?G.SUCCESS:G.failure($localize`You have not taken possession of a source, try again.`),$localize`Congratulations! However, note that your opponent could later take possession of one of your stack that contains a source, so watch out when you take control of sources!`),ce.informational($localize`Passing`,$localize`It can happen that you have no possible move to make.
        If this is the case, and if your opponent can still move, you must pass your turn.<br/><br/>
        This is a situation that occurs here for Dark.`,new Ka([[Ur,Ur,a8,me,me,me,me,me,me,me,me],[Ur,me,Elt,me,me,me,me,me,me,me,me],[me,me,NH,me,me,me,me,NH,a8,Jce,me],[me,me,me,me,me,me,me,me,me,me,Ur],[me,me,me,me,me,me,me,me,me,Ur,Ur]],0,!1)),ce.fromMove($localize`End of the game`,$localize`When no more move is possible for both players, the game ends and the player with the most points wins.<br/><br/>You're playing Dark, make your last move.`,new Ka([[Ur,Ur,a8,me,me,me,me,me,me,me,me],[Ur,me,P9,me,me,me,me,me,me,me,me],[me,me,me,me,me,me,me,me,a8,Jce,me],[me,me,me,me,me,me,me,me,me,me,Ur],[me,me,me,me,me,me,me,me,me,Ur,Ur]],0,!1),[Ir.of(new M(2,1),new M(2,0))],$localize`Congratulations, you won 6 - 0!`,$localize`Bad idea, by moving on the source you would have won a point.`)]}}let w9=(()=>{class n{}return n.NOT_PLAYER_PIECE=()=>$localize`You must select a piece or a stack of your color.`,n.EMPTY_STACK=()=>$localize`You must select a stack.`,n.TOO_MANY_NEIGHBORS=()=>$localize`This stack cannot be moved because all 6 of its neighbors are occupied. You must select a stack with strictly less than 6 neighbors.`,n.CANT_REACH_TARGET=()=>$localize`This stack cannot move because it could never land on another piece.`,n.INVALID_MOVE_LENGTH=()=>$localize`A stack must always be moved by as many spaces as there are pieces in the stack.`,n.EMPTY_TARGET_STACK=()=>$localize`The stack must land on an occupied space.`,n})();class Ei extends U1{static getGameStatus(t){const e=t.gameState,r=Ei.getScores(e);return 0===Ei.getMovablePieces(e).length?r[0]>r[1]?xe.ZERO_WON:r[0]<r[1]?xe.ONE_WON:xe.DRAW:xe.ONGOING}static getMovablePieces(t){return Ei.getFreePieces(t).filter(e=>Ei.pieceHasTarget(t,e))}static getFreePieces(t){return t.getAllPieces().filter(e=>t.getPieceAt(e).belongsTo(t.getCurrentPlayer())&&t.numberOfNeighbors(e)<6)}static pieceHasTarget(t,e){const r=t.getPieceAt(e).getSize();return void 0!==I2.getNeighbors(e,r).find(i=>t.isOnBoard(i)&&!t.getPieceAt(i).isEmpty())}static pieceTargets(t,e){const r=t.getPieceAt(e).getSize();return I2.getNeighbors(e,r).filter(i=>t.isOnBoard(i)&&t.getPieceAt(i).hasPieces())}static getScores(t){let e=0,r=0;return t.getAllPieces().map(s=>{const i=t.getPieceAt(s);i.belongsTo(z.ZERO)?e+=i.getSize():i.belongsTo(z.ONE)&&(r+=i.getSize())}),[e,r]}isMovablePiece(t,e){ve(t.isOnBoard(e),"piece is not on the board");const r=t.getPieceAt(e);return r.getSize()<1?G.failure(w9.EMPTY_STACK()):r.belongsTo(t.getCurrentPlayer())?t.numberOfNeighbors(e)>=6?G.failure(w9.TOO_MANY_NEIGHBORS()):Ei.pieceHasTarget(t,e)?G.SUCCESS:G.failure(w9.CANT_REACH_TARGET()):G.failure(w9.NOT_PLAYER_PIECE())}canOnlyPass(t){return 0===Ei.getMovablePieces(t).length}sourceCoords(t){return t.getAllPieces().filter(e=>t.getPieceAt(e).containsSource())}markPiecesConnectedTo(t,e,r){I2.getNeighbors(e,1).forEach(s=>{t.isOnBoard(s)&&!r[s.y][s.x]&&!t.getPieceAt(s).isEmpty()&&(r[s.y][s.x]=!0,this.markPiecesConnectedTo(t,s,r))})}removeDisconnectedPieces(t){const e=Ke.createTable(Ka.WIDTH,Ka.HEIGHT,!1);this.sourceCoords(t).forEach(s=>{e[s.y][s.x]=!0,this.markPiecesConnectedTo(t,s,e)});let r=t;return r.getAllPieces().forEach(s=>{e[s.y][s.x]||(r=r.setAt(s,t1.EMPTY))}),r}applyLegalMove(t,e,r){if(t===Ir.PASS)return new Ka(e.board,e.turn+1,!0);{const s=e.getPieceAt(t.getStart()),i=e.getPieceAt(t.getEnd()),o=e.setAt(t.getStart(),t1.EMPTY).setAt(t.getEnd(),t1.append(s,i));return this.removeDisconnectedPieces(new Ka(o.board,e.turn+1,!1))}}isLegal(t,e){if(0===Ei.getMovablePieces(e).length)return t!==Ir.PASS||e.alreadyPassed?U.failure(tt.MUST_PASS()):U.success(void 0);if(t===Ir.PASS)return U.failure(tt.CANNOT_PASS());const r=this.isMovablePiece(e,t.getStart());if(r.isFailure())return r.toFailedFallible();const s=e.getPieceAt(t.getStart());return t.length()!==s.getSize()?U.failure(w9.INVALID_MOVE_LENGTH()):e.getPieceAt(t.getEnd()).isEmpty()?U.failure(w9.EMPTY_TARGET_STACK()):U.success(void 0)}getGameStatus(t){return Ei.getGameStatus(t)}}class t3e extends G1{getListMoves(t){const e=t.move,r=t.gameState,s=[];return Ei.getMovablePieces(r).forEach(i=>Ei.pieceTargets(r,i).forEach(o=>{const c=Ir.of(i,o);s.push(c)})),0===s.length&&!1===e.equalsValue(Ir.PASS)&&s.push(Ir.PASS),s}getBoardValue(t){const e=t.gameState,r=Ei.getScores(e);return 0===Ei.getMovablePieces(e).length?new Ct(r[0]>r[1]?Number.MIN_SAFE_INTEGER:r[0]<r[1]?Number.MAX_SAFE_INTEGER:0):new Ct(r[0]-r[1])}}class Slt extends t3e{getListMoves(t){const e=t.gameState,r=super.getListMoves(t),s=e.getCurrentPlayer().getOpponent();return Ke.sortByDescending(r,i=>{ve(i!==Ir.PASS,"Cannot sort with DvonnMove.PASS");const o=e.getPieceAt(i.getEnd());return o.belongsTo(s)?o.getSize():0}),r}getBoardValue(t){const e=Ei.getGameStatus(t);if(e.isEndGame)return e.toBoardValue();const r=t.gameState,s=Ei.getScores(r),i=r.getAllPieces(),o=i.length,c=i.filter(m=>r.getPieceAt(m).belongsTo(z.ZERO)).length,u=i.filter(m=>r.getPieceAt(m).belongsTo(z.ONE)).length;return new Ct((u*s[1]-c*s[0])/o)}}function Plt(n,t){if(1&n&&(F(),Q(0,"circle",10)),2&n){const e=v().$implicit,r=v().$implicit,s=v();T("ngClass",s.getPieceClasses(e)),D("cx",s.getCenterAt(r).x)("cy",s.getCenterAt(r).y)("r",s.SPACE_SIZE)}}function Tlt(n,t){if(1&n&&(F(),Q(0,"polygon",11)),2&n){const e=v().$implicit,r=v().$implicit,s=v();D("transform",1===e.getSize()?"translate("+(s.getCenterAt(r).x-18)+" "+(s.getCenterAt(r).y-16)+") scale(0.10)":"translate("+(s.getCenterAt(r).x-3)+" "+(s.getCenterAt(r).y-12)+") scale(0.07)")}}function wlt(n,t){if(1&n){const e=Oe();F(),b(0,"text",12),ee("click",function(){he(e);const s=v(2).$implicit;return le(v().onClick(s.x,s.y))}),Tt(1),O()}if(2&n){const e=v().$implicit,r=v().$implicit,s=v();D("x",e.containsSource()?s.getCenterAt(r).x-7:s.getCenterAt(r).x)("y",s.getCenterAt(r).y),S(1),l1(e.getSize())}}function blt(n,t){if(1&n){const e=Oe();F(),b(0,"g",5),ee("click",function(){he(e);const s=v().$implicit;return le(v().onClick(s.x,s.y))}),Q(1,"polygon",6),x(2,Plt,1,4,"circle",7),x(3,Tlt,1,1,"polygon",8),x(4,wlt,2,3,"text",9),O()}if(2&n){const e=t.$implicit,r=v().$implicit,s=v();We("id","click_",r.x,"_",r.y,""),S(1),D("points",s.getHexaPointsAt(r)),S(1),T("ngIf",e.getSize()>0),S(1),T("ngIf",e.containsSource()),S(1),T("ngIf",e.getSize()>1)}}const Olt=function(n){return[n]};function Nlt(n,t){if(1&n&&(F(),b(0,"g"),x(1,blt,5,6,"g",4),O()),2&n){const e=t.$implicit,r=v();S(1),T("ngForOf",P3(1,Olt,r.state.getPieceAt(e)))}}function Alt(n,t){if(1&n&&(F(),b(0,"text",16),Tt(1),O()),2&n){const e=v().$implicit,r=v();D("x",r.getCenterAt(e.coord).x)("y",r.getCenterAt(e.coord).y),S(1),l1(e.spaceContent.getSize())}}function Ilt(n,t){if(1&n&&(F(),b(0,"g"),Q(1,"polygon",13)(2,"circle",14),x(3,Alt,2,3,"text",15),O()),2&n){const e=t.$implicit,r=v();S(1),D("points",r.getHexaPointsAt(e.coord)),S(1),We("id","captured_",e.coord.x,"_",e.coord.y,""),T("ngClass",r.getPieceClasses(e.spaceContent)),D("cx",r.getCenterAt(e.coord).x)("cy",r.getCenterAt(e.coord).y)("r",r.SPACE_SIZE),S(1),T("ngIf",e.spaceContent.getSize()>1)}}function xlt(n,t){if(1&n&&(F(),un(0),Q(1,"polygon",17)(2,"polygon",17),fn()),2&n){const e=v();S(1),D("points",e.getHexaPointsAt(e.lastMove.get().getStart())),S(1),D("points",e.getHexaPointsAt(e.lastMove.get().getEnd()))}}function klt(n,t){if(1&n&&(F(),Q(0,"polygon",18)),2&n){const e=v();D("points",e.getHexaPointsAt(e.chosen.get()))}}let Llt=(()=>{class n extends y9{constructor(e){super(e),this.lastMove=P.empty(),this.chosen=P.empty(),this.disconnecteds=[],this.rules=new Ei(Ka),this.availableMinimaxes=[new t3e(this.rules,"DvonnMinimax"),new Slt(this.rules,"DvonnMinimaxMaximizeStacks")],this.encoder=Ir.encoder,this.tutorial=(new e3e).tutorial,this.SPACE_SIZE=30,this.canPass=!1,this.scores=P.of(Ei.getScores(this.getState())),this.hexaLayout=new E9(1.5*this.SPACE_SIZE,new M(-this.SPACE_SIZE,2*this.SPACE_SIZE),pP.INSTANCE),this.state=this.getState(),this.hexaBoard=this.getState().board}hideLastMove(){this.lastMove=P.empty()}updateBoard(){this.cancelMoveAttempt(),this.state=this.getState(),this.lastMove=this.rules.node.move,this.disconnecteds=[],this.lastMove.isPresent()?this.calculateDisconnecteds():this.hideLastMove(),this.canPass=this.rules.canOnlyPass(this.state),this.scores=P.of(Ei.getScores(this.state))}calculateDisconnecteds(){const e=this.rules.node.mother.get().gameState,r=this.getState();for(let s=0;s<r.board.length;s++)for(let i=0;i<r.board[s].length;i++){const o=new M(i,s);if(!0===r.isOnBoard(o)&&!1===o.equals(this.lastMove.get().getStart())){const c=r.getPieceAt(o),u=e.getPieceAt(o);if(c.isEmpty()&&!u.isEmpty()){const p={coord:new M(i,s),spaceContent:u};this.disconnecteds.push(p)}}}}cancelMoveAttempt(){this.chosen=P.empty()}pass(){var e=this;return A(function*(){return ve(e.canPass,"DvonnComponent: pass() can only be called if canPass is true"),yield e.chooseMove(Ir.PASS,e.getState())})()}onClick(e,r){var s=this;return A(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);return i.isFailure()?s.cancelMove(i.getReason()):s.chosen.isAbsent()?s.choosePiece(e,r):s.chosen.equalsValue(new M(e,r))?(s.cancelMoveAttempt(),G.SUCCESS):yield s.chooseDestination(e,r)})()}choosePiece(e,r){const s=new M(e,r),i=this.rules.isMovablePiece(this.getState(),s);return i.isSuccess()?(this.chosen=P.of(s),G.SUCCESS):this.cancelMove(i.getReason())}chooseDestination(e,r){var s=this;return A(function*(){const i=s.chosen.get(),o=new M(e,r),c=Ir.of(i,o);return s.chooseMove(c,s.getState())})()}getPieceClasses(e){if(e.containsSource()&&1===e.getSize())return["nonplayer-fill","dashed-stroke"];const r=this.getPlayerClass(e.getOwner());return e.containsSource()?[r,"nonplayer-stroke","dashed-stroke"]:[r]}}return n.\u0275fac=function(e){return new(e||n)(J(Pn))},n.\u0275cmp=gt({type:n,selectors:[["app-dvonn"]],features:[l],decls:5,vars:4,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","0 0 875 380","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf"],["class","base no-fill selected-stroke",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base","mid-stroke"],["class","base mid-stroke",3,"ngClass",4,"ngIf"],["class","nonplayer-light-fill","points","157.055,0 90.798,196.319 164.417,196.319 88.344,400 289.571,159.509 218.405,159.509 311.656,0",4,"ngIf"],["class","text-center text-medium","dy","13",3,"click",4,"ngIf"],[1,"base","mid-stroke",3,"ngClass"],["points","157.055,0 90.798,196.319 164.417,196.319 88.344,400 289.571,159.509 218.405,159.509 311.656,0",1,"nonplayer-light-fill"],["dy","13",1,"text-center","text-medium",3,"click"],[1,"base","mid-stroke","captured-fill"],[1,"base","mid-stroke","semi-transparent",3,"id","ngClass"],["class","text-center text-big","dy","17",4,"ngIf"],["dy","17",1,"text-center","text-big"],[1,"base","no-fill","last-move-stroke"],[1,"base","no-fill","selected-stroke"]],template:function(e,r){1&e&&(F(),b(0,"svg",0),x(1,Nlt,2,3,"g",1),x(2,Ilt,4,8,"g",1),x(3,xlt,3,2,"ng-container",2),x(4,klt,1,1,"polygon",3),O()),2&e&&(S(1),T("ngForOf",r.state.allCoords()),S(1),T("ngForOf",r.disconnecteds),S(1),T("ngIf",r.lastMove.isPresent()),S(1),T("ngIf",r.chosen.isPresent()))},dependencies:[dn,An,en],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();var or=(()=>(function(n){n[n.NONE=0]="NONE",n[n.SMALL=1]="SMALL",n[n.MEDIUM=2]="MEDIUM",n[n.BIG=3]="BIG"}(or||(or={})),or))();class Qe{constructor(t){this.value=t}static of(t){switch(t){case 0:return this.SMALL_DARK;case 1:return this.SMALL_LIGHT;case 2:return this.MEDIUM_DARK;case 3:return this.MEDIUM_LIGHT;case 4:return this.BIG_DARK;case 5:return this.BIG_LIGHT;case 6:return this.NONE;default:throw new Error("Invalid value "+t+" for EncapsulePiece")}}static ofSizeAndPlayer(t,e){return e===z.ZERO&&t===or.BIG?Qe.BIG_DARK:e===z.ZERO&&t===or.MEDIUM?Qe.MEDIUM_DARK:e===z.ZERO&&t===or.SMALL?Qe.SMALL_DARK:e===z.ONE&&t===or.BIG?Qe.BIG_LIGHT:e===z.ONE&&t===or.MEDIUM?Qe.MEDIUM_LIGHT:e===z.ONE&&t===or.SMALL?Qe.SMALL_LIGHT:Qe.NONE}getPlayer(){switch(this){case Qe.SMALL_DARK:case Qe.MEDIUM_DARK:case Qe.BIG_DARK:return z.ZERO;case Qe.SMALL_LIGHT:case Qe.MEDIUM_LIGHT:case Qe.BIG_LIGHT:return z.ONE;default:return pe.NONE}}getSize(){switch(this){case Qe.BIG_DARK:case Qe.BIG_LIGHT:return or.BIG;case Qe.MEDIUM_DARK:case Qe.MEDIUM_LIGHT:return or.MEDIUM;case Qe.SMALL_DARK:case Qe.SMALL_LIGHT:return or.SMALL;default:return Me.expectToBe(this,Qe.NONE),or.NONE}}belongsTo(t){return this.getPlayer()===t}equals(t){return this===t}toString(){switch(this){case Qe.BIG_DARK:return"BIG_DARK";case Qe.BIG_LIGHT:return"BIG_LIGHT";case Qe.MEDIUM_DARK:return"MEDIUM_DARK";case Qe.MEDIUM_LIGHT:return"MEDIUM_LIGHT";case Qe.SMALL_DARK:return"SMALL_DARK";case Qe.SMALL_LIGHT:return"SMALL_LIGHT";default:return Me.expectToBe(this,Qe.NONE),"EMPTY"}}}Qe.SMALL_DARK=new Qe(0),Qe.SMALL_LIGHT=new Qe(1),Qe.MEDIUM_DARK=new Qe(2),Qe.MEDIUM_LIGHT=new Qe(3),Qe.BIG_DARK=new Qe(4),Qe.BIG_LIGHT=new Qe(5),Qe.NONE=new Qe(6);class u6 extends es{constructor(t,e,r){super(t,e),this.remainingPieces=r}static getInitialState(){const e=new ts(pe.NONE,pe.NONE,pe.NONE).encode(),r=Ke.createTable(3,3,e),s=Ke.mapBiArray(r,ts.decode);return new u6(s,0,[Qe.BIG_DARK,Qe.BIG_DARK,Qe.BIG_LIGHT,Qe.BIG_LIGHT,Qe.MEDIUM_DARK,Qe.MEDIUM_DARK,Qe.MEDIUM_LIGHT,Qe.MEDIUM_LIGHT,Qe.SMALL_DARK,Qe.SMALL_DARK,Qe.SMALL_LIGHT,Qe.SMALL_LIGHT])}getRemainingPieces(){return Ke.copyImmutableArray(this.remainingPieces)}getRemainingPiecesOfPlayer(t){return this.getRemainingPieces().filter(e=>e.getPlayer()===t)}pieceBelongsToCurrentPlayer(t){return t.belongsTo(this.getCurrentPlayer())}isDroppable(t){return this.pieceBelongsToCurrentPlayer(t)&&this.isInRemainingPieces(t)}isInRemainingPieces(t){return this.remainingPieces.some(e=>e===t)}getPlayerRemainingPieces(){return this.remainingPieces.filter(t=>this.pieceBelongsToCurrentPlayer(t))}}class ts{constructor(t,e,r){this.small=t,this.medium=e,this.big=r}static decode(t){ve(t%1==0,"EncapsuleSpace must be encoded as integer: "+t),ve(t>=0,"To small representation for EncapsuleSpace: "+t),ve(t<=26,"To big representation for EncapsuleSpace: "+t);const e=z.numberEncoder.decodeNumber(t%3);t-=e.value;const r=z.numberEncoder.decodeNumber((t/=3)%3);t-=r.value;const s=z.numberEncoder.decodeNumber(t/=3);return new ts(e,r,s)}isEmpty(){return this.small===pe.NONE&&this.medium===pe.NONE&&this.big===pe.NONE}toList(){const t=[];return this.small.isPlayer()&&t.push(Qe.ofSizeAndPlayer(or.SMALL,this.small)),this.medium.isPlayer()&&t.push(Qe.ofSizeAndPlayer(or.MEDIUM,this.medium)),this.big.isPlayer()&&t.push(Qe.ofSizeAndPlayer(or.BIG,this.big)),t}toOrderedPieceNames(){const t=Qe.ofSizeAndPlayer(or.SMALL,this.small),e=Qe.ofSizeAndPlayer(or.MEDIUM,this.medium),r=Qe.ofSizeAndPlayer(or.BIG,this.big);return[t.toString(),e.toString(),r.toString()]}getBiggest(){return this.big===z.ZERO?Qe.BIG_DARK:this.big===z.ONE?Qe.BIG_LIGHT:this.medium===z.ZERO?Qe.MEDIUM_DARK:this.medium===z.ONE?Qe.MEDIUM_LIGHT:this.small===z.ZERO?Qe.SMALL_DARK:this.small===z.ONE?Qe.SMALL_LIGHT:Qe.NONE}tryToSuperposePiece(t){const e=this.getBiggest().getSize();if(t===Qe.NONE)throw new Error("Cannot move EMPTY on a space");return t.getSize()>e?P.of(this.put(t)):P.empty()}removeBiggest(){const t=this.getBiggest();if(t===Qe.NONE)throw new Error("Cannot removed piece from empty space");let e;const r=t.getSize();switch(r){case or.BIG:e=new ts(this.small,this.medium,pe.NONE);break;case or.MEDIUM:e=new ts(this.small,pe.NONE,pe.NONE);break;default:Me.expectToBe(r,or.SMALL),e=new ts(pe.NONE,pe.NONE,pe.NONE)}return{removedSpace:e,removedPiece:t}}put(t){if(t===Qe.NONE)throw new Error("Cannot put NONE on space");const e=t.getPlayer(),r=t.getSize();switch(r){case or.BIG:return new ts(this.small,this.medium,e);case or.MEDIUM:return ve(this.big===pe.NONE,"Cannot put a piece on top of a bigger one"),new ts(this.small,e,this.big);default:return Me.expectToBe(r,or.SMALL),ve(this.big===pe.NONE,"Cannot put a piece on top of a bigger one"),ve(this.medium===pe.NONE,"Cannot put a piece on top of a bigger one"),new ts(e,this.medium,this.big)}}encode(){return this.small.value+3*this.medium.value+9*this.big.value}belongsTo(t){return this.getBiggest().getPlayer()===t}toString(){const t=this.toOrderedPieceNames();return"("+t[0]+", "+t[1]+", "+t[2]+")"}}ts.EMPTY=new ts(pe.NONE,pe.NONE,pe.NONE);let Hm=(()=>{class n{}return n.PIECE_OUT_OF_STOCK=()=>$localize`You do not have pieces of this type anymore.`,n.INVALID_PLACEMENT=()=>$localize`You must put your piece on an empty square or on a smaller piece.`,n.NOT_DROPPABLE=()=>$localize`You must pick your piece among the remaining ones.`,n.INVALID_PIECE_SELECTED=()=>$localize`You must pick one of your remaining pieces or one piece on the board that is the biggest of its square.`,n.END_YOUR_MOVE=()=>$localize`You are performing a move, you must select a landing square.`,n})();class Vc extends U1{static isVictory(t){const e=t.getCopiedBoard();for(const r of Vc.LINES){const i=Vc.isVictoriousLine([e[r[0].y][r[0].x],e[r[1].y][r[1].x],e[r[2].y][r[2].x]]);if(i.isPresent())return i}return P.empty()}static isVictoriousLine(t){const r=t.map(s=>s.getBiggest()).map(s=>s.getPlayer());return r[0]===pe.NONE?P.empty():r[0]===r[1]&&r[1]===r[2]?P.of(r[0]):P.empty()}static isLegal(t,e){let s;if(X(!1,t.toString()),t.isDropping()){if(s=t.piece.get(),!1===e.pieceBelongsToCurrentPlayer(s))return U.failure(tt.MUST_CHOOSE_PLAYER_PIECE());if(!1===e.isInRemainingPieces(s))return U.failure(Hm.PIECE_OUT_OF_STOCK())}else{const c=t.startingCoord.get();if(s=e.getPieceAt(c).getBiggest(),!1===e.pieceBelongsToCurrentPlayer(s))return U.failure(tt.MUST_CHOOSE_PLAYER_PIECE())}const o=e.getPieceAt(t.landingCoord).tryToSuperposePiece(s);return o.isPresent()?U.success(o.get()):U.failure(Hm.INVALID_PLACEMENT())}isLegal(t,e){return Vc.isLegal(t,e)}applyLegalMove(t,e,r){const s=e.getCopiedBoard();let i=e.getRemainingPieces();const o=e.turn+1;let c;if(s[t.landingCoord.y][t.landingCoord.x]=ts.decode(r.encode()),t.isDropping()){c=t.piece.get();const h=i.indexOf(c);i=i.slice(0,h).concat(i.slice(h+1))}else{const h=t.startingCoord.get(),p=s[h.y][h.x].encode(),C=ts.decode(p).removeBiggest();s[h.y][h.x]=ts.decode(C.removedSpace.encode()),c=C.removedPiece}return new u6(s,o,i)}static getGameStatus(t){const r=Vc.isVictory(t.gameState);return r.isPresent()?xe.getVictory(r.get()):xe.ONGOING}getGameStatus(t){return Vc.getGameStatus(t)}}Vc.LINES=[[new M(0,0),new M(0,1),new M(0,2)],[new M(1,0),new M(1,1),new M(1,2)],[new M(2,0),new M(2,1),new M(2,2)],[new M(0,0),new M(1,0),new M(2,0)],[new M(0,1),new M(1,1),new M(2,1)],[new M(0,2),new M(1,2),new M(2,2)],[new M(0,0),new M(1,1),new M(2,2)],[new M(0,2),new M(1,1),new M(2,0)]];class Xs extends Gi{constructor(t,e,r){super(),this.startingCoord=t,this.landingCoord=e,this.piece=r}static fromMove(t,e){if(t.equals(e))throw new Error("Starting coord and landing coord must be separate coords");return new Xs(P.of(t),e,P.empty())}static fromDrop(t,e){return new Xs(P.empty(),e,P.of(t))}isDropping(){return this.startingCoord.isAbsent()}equals(t){return this===t||!1!==t.landingCoord.equals(this.landingCoord)&&!1!==this.startingCoord.equals(t.startingCoord)&&this.piece.equals(t.piece)}toString(){return this.isDropping()?"EncapsuleMove("+this.piece.get().toString()+" -> "+this.landingCoord+")":"EncapsuleMove("+this.startingCoord.get()+"->"+this.landingCoord+")"}}Xs.encoder=new class extends Cn{maxValue(){return 161}encodeNumber(n){const t=n.landingCoord.x,e=n.landingCoord.y;if(n.isDropping())return 18*n.piece.get().value+6*t+2*e+0;{const s=n.startingCoord.get().y;return 54*n.startingCoord.get().x+18*s+6*t+2*e+1}}decodeNumber(n){const t=n%2;n-=t;const e=(n/=2)%3;n-=e;const r=(n/=3)%3;n-=r,n/=3;const s=new M(r,e);if(0===t){const i=Qe.of(n);return Xs.fromDrop(i,s)}{const i=n%3;n-=i;const c=new M((n/=3)%3,i);return Xs.fromMove(c,s)}}};class Rlt extends G1{getBoardValue(t){return Vc.getGameStatus(t).toBoardValue()}getListMoves(t){const e=[],r=t.gameState,s=r.getCopiedBoard(),i=r.getCurrentPlayer(),o=Tte.toComparableObjectSet(r.getPlayerRemainingPieces());for(let c=0;c<3;c++)for(let u=0;u<3;u++){const h=new M(u,c);for(const p of o){const m=Xs.fromDrop(p,h);Vc.isLegal(m,r).isSuccess()&&e.push(m)}if(s[c][u].belongsTo(i))for(let p=0;p<3;p++)for(let m=0;m<3;m++){const C=new M(m,p);if(!C.equals(h)){const w=Xs.fromMove(h,C);Vc.isLegal(w,r).isSuccess()&&e.push(w)}}}return e}}const Lo=new ts(pe.NONE,pe.NONE,pe.NONE),n3e=new ts(z.ZERO,pe.NONE,pe.NONE),Dlt=new ts(pe.NONE,z.ZERO,pe.NONE),zlt=new ts(pe.NONE,pe.NONE,z.ZERO),r3e=new ts(z.ONE,pe.NONE,pe.NONE),SP=new ts(pe.NONE,pe.NONE,z.ONE),Vlt=new ts(z.ONE,z.ZERO,pe.NONE),Hlt=new ts(z.ZERO,z.ZERO,pe.NONE);class s3e extends K1{constructor(){super(...arguments),this.tutorial=[ce.informational($localize`Goal of the game`,$localize`The goal of Encapsule is to align three of your pieces.
        Here, we have a victory of the dark player.`,new u6([[n3e,r3e,SP],[Lo,Dlt,Lo],[Lo,Lo,zlt]],0,[Qe.SMALL_DARK,Qe.MEDIUM_DARK,Qe.BIG_DARK,Qe.SMALL_LIGHT,Qe.MEDIUM_LIGHT,Qe.MEDIUM_LIGHT,Qe.BIG_LIGHT])),ce.anyMove($localize`Putting a piece`,$localize`This is the initial board.<br/><br/>
        You're playing Dark. Pick one of your piece on the side of the board and put it on the board.`,u6.getInitialState(),Xs.fromDrop(Qe.SMALL_DARK,new M(1,1)),$localize`Congratulations!`),ce.fromMove($localize`Moving`,$localize`Another possible action is to move one of your pieces that is already on the board.<br/><br/>
        You're playing Dark, click on your piece already on the board and then on any empty square of the board.`,new u6([[n3e,SP,Lo],[Lo,Lo,Lo],[Lo,Lo,Lo]],0,[]),[Xs.fromMove(new M(0,0),new M(2,0)),Xs.fromMove(new M(0,0),new M(0,1)),Xs.fromMove(new M(0,0),new M(1,1)),Xs.fromMove(new M(0,0),new M(2,1)),Xs.fromMove(new M(0,0),new M(0,2)),Xs.fromMove(new M(0,0),new M(1,2)),Xs.fromMove(new M(0,0),new M(2,2))],$localize`Congratulations!`,$localize`Failed. Try again.`),ce.fromPredicate($localize`Particularity`,$localize`At Encapsule, pieces encapsulate each other.
        It is therefore possible to have up to three pieces per square!
        However, only the biggest piece of each square counts:
        you cannot win with a piece that is "hidden" by a bigger piece.
        Similarly, you cannot move a piece if it is encapsulated by a bigger piece.
        Finally, you cannot encapsulate a piece with a smaller piece.
        Here, Dark can win now in various ways.<br/><br/>
        You're playing Dark, try to win by making a move, and not by putting a new piece on the board.`,new u6([[Vlt,Lo,r3e],[Hlt,SP,SP],[Lo,Lo,Lo]],0,[Qe.MEDIUM_DARK,Qe.BIG_DARK,Qe.MEDIUM_LIGHT,Qe.MEDIUM_LIGHT]),Xs.fromMove(new M(0,1),new M(0,2)),(t,e,r)=>{if(t.landingCoord.equals(new M(0,2))){if(t.isDropping())return G.failure($localize`You won, but the exercise is to win while moving a piece!`);if(t.startingCoord.equalsValue(new M(0,1)))return G.SUCCESS}return G.failure($localize`Failed. Try again.`)},$localize`Congratulations!`)]}}function Flt(n,t){if(1&n){const e=Oe();F(),b(0,"g")(1,"circle",5),ee("click",function(){const s=he(e),i=s.$implicit,o=s.index,c=v().$implicit;return le(v().onPieceClick(c.value,i,o))}),O()()}if(2&n){const e=t.$implicit,r=t.index,s=v().$implicit,i=v();S(1),j2("id","piece_",s.value,"_",e.toString(),"_",r,""),T("ngClass",i.getSidePieceClasses(e,r)),D("transform","rotate("+180*(i.role.value+s.value)+" "+i.CENTER+" "+i.CENTER+")")("r",i.getPieceRadius(e))("cx",i.getRemainingPieceCenterCoord(s,r).x)("cy",i.getRemainingPieceCenterCoord(s,r).y)}}function Blt(n,t){if(1&n&&(F(),b(0,"g",null,4),x(2,Flt,2,8,"g",1),O()),2&n){const e=t.$implicit,r=v();S(2),T("ngForOf",r.getRemainingPieces(e))}}function $lt(n,t){if(1&n){const e=Oe();F(),b(0,"circle",8),ee("click",function(){he(e);const s=v().index,i=v().index;return le(v().onBoardClick(s,i))}),O()}if(2&n){const e=t.$implicit,r=v().index,s=v().index,i=v();T("ngClass",i.getPieceClasses(e)),D("r",i.getPieceRadius(e))("cx",i.getPieceCenter(r))("cy",i.getPieceCenter(s))}}function Ult(n,t){if(1&n){const e=Oe();F(),b(0,"g")(1,"rect",6),ee("click",function(){const i=he(e).index,o=v().index;return le(v().onBoardClick(i,o))}),O(),x(2,$lt,1,4,"circle",7),O()}if(2&n){const e=t.$implicit,r=t.index,s=v().index,i=v();S(1),We("id","click_",r,"_",s,""),T("ngClass",i.getRectClasses(r,s)),D("x",i.SPACE_SIZE*r+i.STROKE_WIDTH)("y",i.SPACE_SIZE*s+i.STROKE_WIDTH)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),S(1),T("ngForOf",i.getListPieces(e))}}function Glt(n,t){if(1&n&&(F(),b(0,"g"),x(1,Ult,3,8,"g",1),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e)}}function Wlt(n,t){if(1&n){const e=Oe();F(),b(0,"rect",9),ee("click",function(){he(e);const s=v();return le(s.onBoardClick(s.chosenCoord.get().x,s.chosenCoord.get().y))}),O()}if(2&n){const e=v();We("id","chosenCoord_",e.chosenCoord.get().x,"_",e.chosenCoord.get().y,""),D("x",e.SPACE_SIZE*e.chosenCoord.get().x+e.STROKE_WIDTH)("y",e.SPACE_SIZE*e.chosenCoord.get().y+e.STROKE_WIDTH)("width",e.SPACE_SIZE)("height",e.SPACE_SIZE)}}let qlt=(()=>{class n extends to{constructor(e){super(e),this.CENTER=this.getPieceCenter(1),this.UPLEFT=-(this.SPACE_SIZE+.5*this.STROKE_WIDTH),this.WIDTH=5*this.SPACE_SIZE+3*this.STROKE_WIDTH,this.lastLandingCoord=P.empty(),this.lastStartingCoord=P.empty(),this.chosenCoord=P.empty(),this.chosenPiece=P.empty(),this.remainingPieceCenterCoords=new Vn,this.rules=new Vc(u6),this.availableMinimaxes=[new Rlt(this.rules,"EncapsuleMinimax")],this.encoder=Xs.encoder,this.tutorial=(new s3e).tutorial,this.updateBoard()}updateBoard(){const e=this.getState();this.board=e.getCopiedBoard();const r=this.rules.node.move;this.calculateLeftPieceCoords(),r.isPresent()?(this.lastLandingCoord=P.of(r.get().landingCoord),this.lastStartingCoord=r.get().startingCoord):(this.lastLandingCoord=P.empty(),this.lastStartingCoord=P.empty())}getListPieces(e){return e.toList()}getRemainingPieces(e){return this.getState().getRemainingPiecesOfPlayer(e)}onBoardClick(e,r){var s=this;return A(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());const o=new M(e,r),c=s.getState();if(s.chosenCoord.isAbsent()){if(s.chosenCoord=P.of(o),s.chosenPiece.isPresent()){const u=Xs.fromDrop(s.chosenPiece.get(),o);return s.chooseMove(u,s.getState())}return!1===c.getPieceAt(o).belongsTo(c.getCurrentPlayer())?s.cancelMove(Hm.INVALID_PIECE_SELECTED()):G.SUCCESS}if(s.chosenCoord.equalsValue(o))return s.cancelMoveAttempt(),G.SUCCESS;{const u=Xs.fromMove(s.chosenCoord.get(),o);return s.chooseMove(u,s.getState())}})()}cancelMoveAttempt(){this.chosenCoord=P.empty(),this.chosenPiece=P.empty(),this.chosenPieceIndex=P.empty()}onPieceClick(e,r,s){var i=this;return A(function*(){const o="#piece_"+e+"_"+r.toString()+"_"+s,c=i.canUserPlay(o);return c.isFailure()?i.cancelMove(c.getReason()):!1===i.getState().isDroppable(r)?i.cancelMove(Hm.NOT_DROPPABLE()):i.chosenCoord.isAbsent()?(i.chosenPiece.equalsValue(r)&&i.chosenPieceIndex.equalsValue(s)?(i.chosenPiece=P.empty(),i.chosenPieceIndex=P.empty()):(i.chosenPiece=P.of(r),i.chosenPieceIndex=P.of(s)),G.SUCCESS):i.cancelMove(Hm.END_YOUR_MOVE())})()}getRectClasses(e,r){return this.isSelected(e,r)?"moved-fill":""}isSelected(e,r){const s=new M(e,r);return!(!this.lastStartingCoord.equalsValue(s)&&!this.lastLandingCoord.equalsValue(s))}getPieceClasses(e){return[this.getPieceStrokeClass(e)]}getPieceCenter(e){return this.SPACE_SIZE*e+this.STROKE_WIDTH+this.SPACE_SIZE/2}getPieceStrokeClass(e){const r=e.getPlayer();return ve(r.isPlayer(),"EncapsuleComponent.getPieceStrokeClass should only be called with actual pieces!"),"player"+r.value+"-stroke"}getPieceRadius(e){switch(e.getSize()){case or.BIG:return this.SPACE_SIZE/2-1*this.STROKE_WIDTH;case or.MEDIUM:return this.SPACE_SIZE/2-2*this.STROKE_WIDTH-3;default:return Me.expectToBe(e.getSize(),or.SMALL),this.SPACE_SIZE/2-3*this.STROKE_WIDTH-6}}getSidePieceClasses(e,r){const s=this.getPieceClasses(e);return this.isSelectedPiece(e)&&this.chosenPieceIndex.equalsValue(r)&&s.push("selected-stroke"),s}isSelectedPiece(e){return this.chosenPiece.equalsValue(e)}calculateLeftPieceCoords(){this.remainingPieceCenterCoords=new Vn;for(const e of z.PLAYERS){const r=[],s=this.getRemainingPieces(e);for(let i=0;i<s.length;i++){let o,c=0,u=0;i<=2?(o=new M(2-i,3),u=this.STROKE_WIDTH):(o=new M(-1,5-i),c=-this.STROKE_WIDTH);const h=this.getPieceCenter(o.x),p=this.getPieceCenter(o.y);r.push(new M(h+c,p+u))}this.remainingPieceCenterCoords.set(e,r)}}getRemainingPieceCenterCoord(e,r){return this.remainingPieceCenterCoords.get(e).get()[r]}}return n.\u0275fac=function(e){return new(e||n)(J(Pn))},n.\u0275cmp=gt({type:n,selectors:[["app-encapsule"]],features:[l],decls:6,vars:4,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["boardDiv",""],["class","base no-fill selected-stroke","pointer-events","fill",3,"id","click",4,"ngIf"],["remainingPieces",""],["pointer-events","fill",1,"base","no-fill",3,"id","ngClass","click"],[1,"base",3,"id","ngClass","click"],["class","base no-fill",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"base","no-fill",3,"ngClass","click"],["pointer-events","fill",1,"base","no-fill","selected-stroke",3,"id","click"]],template:function(e,r){1&e&&(F(),b(0,"svg",0),x(1,Blt,3,1,"g",1),b(2,"g",null,2),x(4,Glt,2,1,"g",1),x(5,Wlt,1,6,"rect",3),O()()),2&e&&(D("viewBox",r.UPLEFT+" "+r.UPLEFT+" "+r.WIDTH+" "+r.WIDTH),S(1),T("ngForOf",r.Player.PLAYERS),S(3),T("ngForOf",r.board),S(1),T("ngIf",r.chosenCoord.isPresent()))},dependencies:[dn,An,en],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class Hc extends xc{constructor(t,e,r,s,i){if(super(t,e),this.movedPieces=r,this.stepSize=s,this.direction=i,this.coord.isNotInRange(14,12))throw new Error("Illegal coord outside of board "+this.coord.toString()+".");if(r<1)throw new Error("Must select minimum one piece (got "+r+").");if(s<1)throw new Error("Step size must be minimum one (got "+s+").");if(s>r)throw new Error("Cannot move a phalanx further than its size (got step size "+s+" for "+r+" pieces).")}toString(){return"EpaminondasMove("+this.coord.toString()+", m:"+this.movedPieces+", s:"+this.stepSize+", "+this.direction.toString()+")"}equals(t){return this===t||!(!this.coord.equals(t.coord)||this.movedPieces!==t.movedPieces||this.stepSize!==t.stepSize)&&this.direction.equals(t.direction)}}Hc.encoder=new class extends Cn{maxValue(){return 122303}encodeNumber(n){const t=n.direction.toInt();return 8*n.coord.x*7*13*12+8*n.coord.y*7*13+8*(n.movedPieces-1)*7+8*(n.stepSize-1)+t}decodeNumber(n){if(n%1!=0)throw new Error("EncodedMove must be an integer.");const t=n%8;n-=t;const e=(n/=8)%7;n-=e;const r=(n/=7)%13;n-=r;const s=(n/=13)%12;n-=s;const i=n/=12,o=Ne.factory.fromInt(t);return new Hc(i,s,r+1,e+1,o.get())}};class z3 extends es{static getInitialState(){const t=pe.NONE,e=pe.ZERO,r=pe.ONE;return new z3([[r,r,r,r,r,r,r,r,r,r,r,r,r,r],[r,r,r,r,r,r,r,r,r,r,r,r,r,r],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e]],0)}count(t,e){let r=0;for(let s=0;s<14;s++)this.board[e][s]===t&&r++;return r}doesOwnPiece(t){for(let e=0;e<12;e++)for(let r=0;r<14;r++)if(this.board[e][r]===t)return!0;return!1}}let Fc=(()=>{class n{}return n.PHALANX_IS_LEAVING_BOARD=()=>$localize`The move distance of your phalanx puts it out of the board.`,n.SOMETHING_IN_PHALANX_WAY=()=>$localize`There is something in the way of your phalanx.`,n.PHALANX_SHOULD_BE_GREATER_TO_CAPTURE=()=>$localize`Your phalanx must be bigger than the one you are capturing.`,n.SQUARE_NOT_ALIGNED_WITH_SELECTED=()=>$localize`This square is not aligned with the selected piece.`,n.SINGLE_PIECE_MUST_MOVE_BY_ONE=()=>$localize`A single piece can only move by one square.`,n.SINGLE_PIECE_CANNOT_CAPTURE=()=>$localize`A single piece cannot make a capture.`,n.SQUARE_NOT_ALIGNED_WITH_PHALANX=()=>$localize`This square is not aligned with the direction of the phalanx.`,n.PHALANX_CANNOT_CONTAIN_PIECES_OUTSIDE_BOARD=()=>$localize`A phalanx can't contain pieces outside of the board.`,n.PHALANX_CANNOT_CONTAIN_EMPTY_SQUARE=()=>$localize`A phalanx cannot contain an empty square.`,n.PHALANX_CANNOT_CONTAIN_OPPONENT_PIECE=()=>$localize`A phalanx cannot contain a piece of the opponent.`,n})();class c8 extends U1{static isLegal(t,e){const r=this.getPhalanxValidity(e,t);if(r.isFailure())return U.failure(r.getReason());const s=this.getLandingStatus(e,t);if(s.isFailure())return s;const i=Ke.copyBiArray(s.get()),o=e.getCurrentOpponent(),c=c8.getCaptureValidity(e,i,t,o);return c.isFailure()?c:U.success(c.get())}static getPhalanxValidity(t,e){let r=e.coord,s=0;const i=t.getCurrentOpponent();for(;s<e.movedPieces;){if(r.isNotInRange(14,12))return G.failure(Fc.PHALANX_CANNOT_CONTAIN_PIECES_OUTSIDE_BOARD());const o=t.getPieceAt(r);if(o===pe.NONE)return G.failure(Fc.PHALANX_CANNOT_CONTAIN_EMPTY_SQUARE());if(o===i)return G.failure(Fc.PHALANX_CANNOT_CONTAIN_OPPONENT_PIECE());r=r.getNext(e.direction,1),s++}return G.SUCCESS}static getLandingStatus(t,e){const r=t.getCopiedBoard(),s=t.getCurrentPlayer();let i=e.coord,o=e.coord.getNext(e.direction,e.movedPieces),c=0;for(;c+1<e.stepSize;){if(r[i.y][i.x]=pe.NONE,r[o.y][o.x]=s,o.isNotInRange(14,12))return U.failure(Fc.PHALANX_IS_LEAVING_BOARD());if(t.getPieceAt(o).isPlayer())return U.failure(Fc.SOMETHING_IN_PHALANX_WAY());c++,o=o.getNext(e.direction,1),i=i.getNext(e.direction,1)}return o.isNotInRange(14,12)?U.failure(Fc.PHALANX_IS_LEAVING_BOARD()):t.getPieceAt(o)===s?U.failure(tt.SHOULD_LAND_ON_EMPTY_OR_OPPONENT_SPACE()):(r[i.y][i.x]=pe.NONE,r[o.y][o.x]=s,U.success(r))}static getCaptureValidity(t,e,r,s){let i=r.coord.getNext(r.direction,r.movedPieces+r.stepSize-1),o=0;for(;i.isInRange(14,12)&&t.getPieceAt(i)===s;){if(o>0&&(e[i.y][i.x]=pe.NONE),o++,o>=r.movedPieces)return U.failure(Fc.PHALANX_SHOULD_BE_GREATER_TO_CAPTURE());i=i.getNext(r.direction,1)}return U.success(e)}isLegal(t,e){return c8.isLegal(t,e)}applyLegalMove(t,e,r){return new z3(r,e.turn+1)}getGameStatus(t){const e=t.gameState,r=e.count(z.ZERO,0),s=e.count(z.ONE,11);if(e.turn%2==0){if(r>s)return xe.ZERO_WON}else if(s>r)return xe.ONE_WON;return!1===e.doesOwnPiece(z.ZERO)?xe.ONE_WON:!1===e.doesOwnPiece(z.ONE)?xe.ZERO_WON:xe.ONGOING}}class Fm extends G1{static getListMoves(t){const e=t.gameState.getCurrentPlayer(),r=t.gameState.getCurrentOpponent(),s=pe.NONE;let i=[];const o=t.gameState;let c;for(let u=0;u<12;u++)for(let h=0;h<14;h++){const p=new M(h,u);if(o.getPieceAt(p)===e)for(const m of Ne.DIRECTIONS){let C=1,w=p.getNext(m,1);for(;w.isInRange(14,12)&&o.getPieceAt(w)===e;)C+=1,w=w.getNext(m,1);let I=1;for(;w.isInRange(14,12)&&I<=C&&o.getPieceAt(w)===s;)c=new Hc(h,u,C,I,m),i=this.addMove(i,c,o),I++,w=w.getNext(m,1);w.isInRange(14,12)&&I<=C&&o.getPieceAt(w)===r&&(c=new Hc(h,u,C,I,m),i=this.addMove(i,c,o))}}return i}static addMove(t,e,r){return c8.isLegal(e,r).isSuccess()&&t.push(e),t}getListMoves(t){const e=Fm.getListMoves(t);return Ke.sortByDescending(e,r=>r.stepSize),e}getBoardValue(t){const e=this.ruler.getGameStatus(t);return e.isEndGame?e.toBoardValue():new Ct(this.getPieceCountPlusRowDomination(t.gameState))}getPieceCountPlusRowDomination(t){let o=0;for(let c=0;c<12;c++){let u=0;const h=[0,0];for(let p=0;p<14;p++){const m=new M(p,c),C=t.getPieceAt(m);if(C.isPlayer()){const w=C.getScoreModifier();o+=2002*w,h[C.value]=w,u+=w;for(const I of[Ne.UP_LEFT,Ne.UP,Ne.UP_RIGHT]){let H=m.getNext(I,1);for(;H.isInRange(14,12)&&t.getPieceAt(H)===C;)o+=1*w,H=H.getNext(I,1)}}}0!==u&&(o+=Math.abs(u)/u*2),o+=1*h.reduce((p,m)=>p+m)}return o}}class jlt extends G1{getListMoves(t){const e=Fm.getListMoves(t);return this.orderMovesByPhalanxSizeAndFilter(e,t.gameState)}orderMovesByPhalanxSizeAndFilter(t,e){return Ke.sortByDescending(t,r=>r.movedPieces),t.length>40?t.filter(s=>!!this.moveIsCapture(s,e)||s.movedPieces*Math.random()>1):t}moveIsCapture(t,e){const r=t.coord.getNext(t.direction,t.movedPieces+t.stepSize-1);return e.board[r.y][r.x]===e.getCurrentOpponent()}getBoardValue(t){const e=this.ruler.getGameStatus(t);return e.isEndGame?e.toBoardValue():new Ct(this.getPieceCountThenSupportThenAdvancement(t.gameState))}getPieceCountThenSupportThenAdvancement(t){let o=0;for(let c=0;c<12;c++)for(let u=0;u<14;u++){const h=new M(u,c),p=t.getPieceAt(h);if(p.isPlayer()){let m,C;p===z.ZERO?(m=12-c,C=[Ne.UP_LEFT,Ne.UP,Ne.UP_RIGHT]):(m=c+1,C=[Ne.DOWN_LEFT,Ne.DOWN,Ne.DOWN_RIGHT]);const w=p.getScoreModifier();o+=m*w,o+=149629*w;for(const I of C){let H=h.getNext(I,1);for(;H.isInRange(14,12)&&t.getPieceAt(H)===p;)o+=337*w,H=H.getNext(I,1)}}}return o}}class Zlt extends Fm{constructor(){super(...arguments),this.DOMINANCE_FACTOR=20,this.DEFENSE_FACTOR=5,this.TERRITORY_FACTOR=2,this.OFFENSE_FACTOR=10,this.CENTER_FACTOR=5,this.MOBILITY_FACTOR=.12}getDominance(t){let e=0;for(let r=0;r<12;r++)for(let s=0;s<14;s++){const i=t.getPieceAt(new M(s,r));i.isPlayer()&&(e+=i.getScoreModifier())}return e*this.DOMINANCE_FACTOR}getDefense(t){let e=0;for(let r=0;r<14;r++)t.getPieceAt(new M(r,11))===z.ZERO&&(e+=z.ZERO.getScoreModifier()),t.getPieceAt(new M(r,0))===z.ONE&&(e+=z.ONE.getScoreModifier());return e*this.DEFENSE_FACTOR}getTerritory(t){let e=0;for(let r=0;r<12;r++)for(let s=0;s<14;s++){const i=t.getPieceAt(new M(s,r));if(i.isPlayer()){for(let o=-1;o<=1;o++)for(let c=-1;c<=1;c++){const u=new M(s+o,r+c);if(u.isInRange(14,12)){const h=t.getPieceAt(u);(h===i||h===pe.NONE)&&(e+=1*i.getScoreModifier())}}e-=i.getScoreModifier()}}return e*this.TERRITORY_FACTOR}getOffense(t){let e=0;for(let r=0;r<14;r++)t.getPieceAt(new M(r,0))===z.ZERO&&(e+=z.ZERO.getScoreModifier()),t.getPieceAt(new M(r,11))===z.ONE&&(e+=z.ONE.getScoreModifier());return e*this.OFFENSE_FACTOR}getCenter(t){let e=0;for(let r=0;r<12;r++)for(let s=0;s<14;s++){const i=t.getPieceAt(new M(s,r));i.isPlayer()&&(e+=i.getScoreModifier()*Math.sqrt((s-6.5)*(s-6.5)))}return e*this.CENTER_FACTOR}getMobility(t){let e=0,r=0,s=0;for(let i=0;i<12;i++)for(let o=0;o<14;o++){const c=new M(o,i),u=t.getPieceAt(c);if(u.isPlayer())for(const h of Ne.DIRECTIONS){let p=1,m=c.getNext(h,1);for(;m.isInRange(14,12)&&t.getPieceAt(m)===u;)p+=1,m=m.getNext(h,1);let C=1;for(;m.isInRange(14,12)&&C<=p&&t.getPieceAt(m)===pe.NONE;)C++,m=m.getNext(h,1);e+=C*C*u.getScoreModifier(),u===z.ZERO?r=Math.max(r,C):u===z.ONE&&(s=Math.max(s,C))}}return(e+r*z.ZERO.getScoreModifier()+s*z.ONE.getScoreModifier())*this.MOBILITY_FACTOR}getBoardValue(t){const e=t.gameState,r=this.ruler.getGameStatus(t);if(r.isEndGame)return r.toBoardValue();const s=this.getDominance(e),i=this.getDefense(e),o=this.getTerritory(e),c=this.getCenter(e),u=this.getOffense(e),h=this.getMobility(e);return new Ct(s+i+o+c+u+h)}}const k=pe.NONE,xr=pe.ZERO,q1=pe.ONE;class i3e extends K1{constructor(){super(...arguments),this.tutorial=[ce.informational($localize`Initial board`,$localize`This is the initial board of Epaminondas.
        The top line is the starting line of Light.
        The bottom line is the starting line of Dark.`,z3.getInitialState()),ce.informational($localize`Goal of the game (1/2)`,$localize`After multiple moves, if at the beginning of its turn, a player has more pieces on the opponent's starting line
        than the number of pieces the opponent has on the player's starting line, the player wins.
        Here, it's Dark's turn to play: Dark has therefore won.`,new z3([[k,k,k,k,k,xr,k,k,q1,q1,q1,q1,q1,q1],[k,k,k,k,k,xr,k,k,k,k,k,k,q1,q1],[k,k,k,k,k,k,k,k,k,k,k,k,k,k],[k,k,k,k,k,k,k,k,k,k,k,k,k,k],[k,k,k,k,k,k,k,k,k,k,k,k,k,k],[k,k,k,k,k,k,k,k,k,k,k,k,k,k],[k,k,k,k,k,k,k,k,k,k,k,k,k,k],[k,k,k,k,k,k,k,k,k,k,k,k,k,k],[k,k,k,k,k,k,k,q1,k,k,k,k,k,k],[k,k,k,k,k,k,k,k,k,k,k,k,k,k],[k,k,k,k,k,k,k,k,k,k,k,k,k,k],[k,k,k,k,k,k,k,xr,xr,xr,xr,k,k,k]],0)),ce.informational($localize`Goal of the game (2/2)`,$localize`Here, it is Light's turn.
        Light wins because they have two pieces on Dark's starting line, and Dark only has one on Light's starting line.`,new z3([[k,k,k,k,k,xr,k,k,k,k,q1,q1,q1,q1],[k,k,k,k,k,xr,k,k,k,k,k,k,k,k],[k,k,k,k,k,k,k,k,k,k,k,k,k,k],[k,k,k,k,k,k,k,k,k,k,k,k,k,k],[k,k,k,k,k,k,k,k,k,k,k,k,k,k],[k,k,k,k,k,k,k,k,k,k,k,k,k,k],[k,k,k,k,k,k,k,k,k,k,k,k,k,k],[k,k,k,k,k,k,k,k,k,k,k,k,k,k],[k,k,k,k,k,k,k,q1,k,k,k,k,k,k],[k,k,k,k,k,k,k,k,k,k,k,k,k,k],[k,k,k,k,k,k,k,k,k,k,k,k,k,k],[k,k,q1,q1,k,k,k,xr,xr,k,xr,xr,xr,xr]],1)),ce.fromPredicate($localize`Moving a piece`,$localize`Here is the starting board. Dark plays first.
        Let's start with moving a single piece:
        <ol>
            <li>Click on a piece.</li>
            <li>Click on a empty neighboring square.</li>
        </ol><br/>You're playing Dark, move a piece.`,z3.getInitialState(),new Hc(0,10,1,1,Ne.UP),(t,e,r)=>1===t.movedPieces?G.SUCCESS:G.failure($localize`Congratulations, you are in advance. But this is not the exercise here, try again.`),$localize`This is how you move a single piece.`),ce.fromPredicate($localize`Moving a phalanx`,$localize`Let us now see how to move multiple pieces along a line, which is called a phalanx:
        <ol>
            <li>Click on the first piece of the phalanx.</li>
            <li>Click on the last piece of the phalanx.</li>
            <li>Click on one of the squares highlighted in yellow; you can move your phalanx up to a distance equal to its length.</li>
        </ol><br/>
        You're playing Dark, Move a phalanx!`,z3.getInitialState(),new Hc(0,11,2,1,Ne.UP),(t,e,r)=>t.movedPieces>1?G.SUCCESS:G.failure($localize`Failed! You moved only one piece.`),$localize`Congratulations!
        The moved pieces can be horizontally, vertically, or diagonally aligned.
        The move should be made along this axis, forward or backwards.
        There can be no opponent nor holes in the phalanx.`),ce.fromMove($localize`Capture`,$localize`In order to capture pieces of the opponent:
        <ol>
            <li>It must be aligned with the phalanx you are moving.</li>
            <li>It must be strictly shorter than your phalanx.</li>
            <li>The first piece of your phalanx should land on the first piece of the opponent's phalanx that you want to capture.</li>
        </ol><br/>
        You're playing Dark, capture a phalanx.`,new z3([[k,k,k,k,k,k,k,k,q1,q1,q1,q1,q1,q1],[k,k,k,k,k,k,q1,k,k,k,k,k,k,k],[k,k,k,k,k,q1,k,k,k,k,k,k,k,k],[k,k,q1,k,q1,k,k,k,k,k,k,k,k,k],[k,k,q1,q1,k,k,k,k,k,k,k,k,k,k],[k,k,q1,k,k,k,k,k,k,k,k,k,k,k],[k,k,k,k,k,k,k,k,k,k,k,k,k,k],[k,k,xr,k,k,k,k,k,k,k,k,k,k,k],[k,k,xr,k,k,k,k,q1,k,k,k,k,k,k],[k,k,xr,k,k,k,k,k,k,k,k,k,k,k],[k,k,xr,k,k,k,k,k,k,k,k,k,k,k],[k,k,k,k,k,k,k,xr,xr,xr,xr,xr,xr,xr]],0),[new Hc(2,10,4,2,Ne.UP)],$localize`Congratulations, you made it!
        Note that the diagonal phalanx was not aligned with your phalanx, hence even if it is longer, this does not prevent you from capturing some of its pieces on another alignment.`,$localize`Failed, you have not captured the phalanx.`)]}}function Ylt(n,t){if(1&n){const e=Oe();F(),b(0,"circle",4),ee("click",function(){he(e);const s=v().index,i=v().index;return le(v().onClick(s,i))}),O()}if(2&n){const e=v().index,r=v().index,s=v();T("ngClass",s.getPieceClasses(e,r)),D("cx",s.SPACE_SIZE*e+s.STROKE_WIDTH+s.SPACE_SIZE/2)("cy",s.SPACE_SIZE*r+s.STROKE_WIDTH+s.SPACE_SIZE/2)("r",s.SPACE_SIZE/2-s.STROKE_WIDTH)}}function Klt(n,t){if(1&n){const e=Oe();F(),b(0,"g")(1,"rect",2),ee("click",function(){const i=he(e).index,o=v().index;return le(v().onClick(i,o))}),O(),x(2,Ylt,1,4,"circle",3),O()}if(2&n){const e=t.index,r=v().index,s=v();S(1),We("id","click_",e,"_",r,""),T("ngClass",s.getRectClasses(e,r)),D("x",s.SPACE_SIZE*e+s.STROKE_WIDTH)("y",s.SPACE_SIZE*r+s.STROKE_WIDTH)("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),S(1),T("ngIf",s.board[r][e]!==s.NONE)}}function Xlt(n,t){if(1&n&&(F(),b(0,"g"),x(1,Klt,3,8,"g",1),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e)}}function Qlt(n,t){if(1&n){const e=Oe();F(),b(0,"g")(1,"rect",5),ee("click",function(){const i=he(e).$implicit;return le(v().onClick(i.x,i.y))}),O()()}if(2&n){const e=t.$implicit,r=v();S(1),D("x",r.SPACE_SIZE*e.x+r.STROKE_WIDTH)("y",r.SPACE_SIZE*e.y+r.STROKE_WIDTH)("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)}}let Jlt=(()=>{class n extends to{constructor(e){super(e),this.NONE=pe.NONE,this.firstPiece=P.empty(),this.validExtensions=[],this.phalanxValidLandings=[],this.lastPiece=P.empty(),this.phalanxDirection=P.empty(),this.phalanxMiddles=[],this.moveds=[],this.capturedCoords=[],this.hasAsymetricBoard=!0,this.rules=new c8(z3),this.availableMinimaxes=[new Fm(this.rules,"Normal"),new jlt(this.rules,"Positional"),new Zlt(this.rules,"Attack")],this.encoder=Hc.encoder,this.tutorial=(new i3e).tutorial,this.updateBoard()}updateBoard(){this.firstPiece=P.empty(),this.lastPiece=P.empty(),this.hidePreviousMove(),this.rules.node.move.isPresent()&&this.showPreviousMove(),this.board=this.getState().getCopiedBoard()}showPreviousMove(){const e=this.rules.node.move.get();let r=e.coord;this.moveds=[r];for(let o=1;o<e.stepSize+e.movedPieces;o++)r=r.getNext(e.direction,1),this.moveds.push(r);const s=this.rules.node.mother.get(),i=s.gameState.getCurrentOpponent();for(;r.isInRange(14,12)&&s.gameState.getPieceAt(r)===i;)this.capturedCoords.push(r),r=r.getNext(e.direction,1)}onClick(e,r){var s=this;return A(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);return i.isFailure()?s.cancelMove(i.getReason()):s.firstPiece.isAbsent()?s.firstClick(e,r):s.lastPiece.isAbsent()?s.secondClick(e,r):s.thirdClick(e,r)})()}firstClick(e,r){var s=this;return A(function*(){const i=s.getState().getCurrentOpponent(),o=s.getState().getCurrentPlayer();switch(s.board[r][e]){case o:return s.firstPiece=P.of(new M(e,r)),s.validExtensions=s.getValidExtensions(o),s.phalanxValidLandings=s.getPhalanxValidLandings(),G.SUCCESS;case i:return s.cancelMove(tt.CANNOT_CHOOSE_OPPONENT_PIECE());default:return Me.expectToBe(s.board[r][e],pe.NONE),s.cancelMove(tt.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY())}})()}hidePreviousMove(){this.capturedCoords=[],this.moveds=[]}getValidExtensions(e){return this.lastPiece.isPresent()?this.getPhalanxValidExtensions(e):this.getFirstPieceExtensions(e)}getFirstPieceExtensions(e){const r=[];for(const s of Ne.DIRECTIONS){let i=this.firstPiece.get().getNext(s,1);for(;i.isInRange(14,12)&&this.board[i.y][i.x]===e;)r.push(i),i=i.getNext(s,1)}return r}getPhalanxValidExtensions(e){let r=Ne.factory.fromMove(this.firstPiece.get(),this.lastPiece.get()).get();const s=this.lastPiece.get().getNext(r,1),i=this.getExtensionsToward(s,r,e);r=r.getOpposite();const o=this.firstPiece.get().getNext(r,1),c=this.getExtensionsToward(o,r,e);return i.concat(c)}getExtensionsToward(e,r,s){const i=[];for(;e.isInRange(14,12)&&this.board[e.y][e.x]===s;)i.push(e),e=e.getNext(r,1);return i}getPhalanxValidLandings(){if(this.lastPiece.isPresent()){const e=this.firstPiece.get(),r=this.lastPiece.get(),s=Math.abs(e.x-r.x),i=Math.abs(e.y-r.y),o=Math.max(s,i)+1;let c=Ne.factory.fromMove(e,r).get();const u=r.getNext(c,1),h=this.getLandingsToward(u,c,o);c=c.getOpposite();const p=e.getNext(c,1);return this.getLandingsToward(p,c,o).concat(h)}return this.getNeighboringEmptySpaces()}getNeighboringEmptySpaces(){const e=[];for(const r of Ne.DIRECTIONS){const s=this.firstPiece.get().getNext(r,1);s.isInRange(14,12)&&this.board[s.y][s.x]===pe.NONE&&e.push(s)}return e}getLandingsToward(e,r,s){const i=this.getState().getCurrentPlayer(),o=this.getState().getCurrentOpponent(),c=[];for(;e.isInRange(14,12)&&c.length<s&&this.board[e.y][e.x]!==i;){if(this.board[e.y][e.x]===o)return this.getPhalanxLength(e,r,o)<s&&c.push(e),c;c.push(e),e=e.getNext(r,1)}return c}getPhalanxLength(e,r,s){let i=0;for(;e.isInRange(14,12)&&this.board[e.y][e.x]===s;)i++,e=e.getNext(r,1);return i}cancelMoveAttempt(){this.firstPiece=P.empty(),this.validExtensions=[],this.phalanxValidLandings=[],this.lastPiece=P.empty(),this.phalanxMiddles=[],this.hidePreviousMove()}secondClick(e,r){var s=this;return A(function*(){const i=new M(e,r),o=s.firstPiece.get();if(i.equals(o))return s.cancelMoveAttempt(),G.SUCCESS;const c=s.getState().getCurrentOpponent(),u=s.getState().getCurrentPlayer();if(!i.isAlignedWith(o))return s.cancelMove(Fc.SQUARE_NOT_ALIGNED_WITH_SELECTED());const h=i.getDistance(o),p=o.getDirectionToward(i).get();switch(s.board[r][e]){case pe.NONE:return 1===h?s.tryMove(new Hc(o.x,o.y,1,1,p)):s.cancelMove(Fc.SINGLE_PIECE_MUST_MOVE_BY_ONE());case c:return s.cancelMove(Fc.SINGLE_PIECE_CANNOT_CAPTURE());default:Me.expectToBe(s.board[r][e],u);const m=new Hc(o.x,o.y,h,1,p),C=s.getState(),w=c8.getPhalanxValidity(C,m);return w.isFailure()?s.cancelMove(w.getReason()):(s.lastPiece=P.of(i),s.validExtensions=s.getValidExtensions(u),s.phalanxValidLandings=s.getPhalanxValidLandings(),s.phalanxMiddles=o.getCoordsToward(i),s.phalanxDirection=P.of(p),G.SUCCESS)}})()}thirdClick(e,r){var s=this;return A(function*(){const i=s.getState().getCurrentPlayer(),o=new M(e,r);if(s.firstPiece.equalsValue(o))return s.moveFirstPiece(i);if(s.lastPiece.equalsValue(o))return s.moveLastPiece(i);const c=s.firstPiece.get(),u=s.lastPiece.get();if(!o.isAlignedWith(c))return s.cancelMove(Fc.SQUARE_NOT_ALIGNED_WITH_PHALANX());let h=Ne.factory.fromMove(c,u).get();const p=Ne.factory.fromMove(c,o).get();if(h===p.getOpposite()&&(s.firstPiece=P.of(u),s.lastPiece=P.of(c),h=p),h!==p)return s.cancelMove(Fc.SQUARE_NOT_ALIGNED_WITH_PHALANX());if(s.board[r][e]===i)return s.thirdClickOnPlayerPiece(o,h,i);{const m=s.firstPiece.get().getDistance(s.lastPiece.get())+1,C=s.lastPiece.get().getDistance(o),w=new Hc(s.firstPiece.get().x,s.firstPiece.get().y,m,C,h);return s.tryMove(w)}})()}thirdClickOnPlayerPiece(e,r,s){var i=this;return A(function*(){i.lastPiece=P.of(e);const o=i.firstPiece.get().getDistance(e)+1,c=new Hc(i.firstPiece.get().x,i.firstPiece.get().y,o,1,r),u=c8.getPhalanxValidity(i.rules.node.gameState,c);return u.isFailure()?i.cancelMove(u.getReason()):(i.phalanxMiddles=i.firstPiece.get().getCoordsToward(i.lastPiece.get()),i.validExtensions=i.getValidExtensions(s),i.phalanxValidLandings=i.getPhalanxValidLandings(),G.SUCCESS)})()}moveFirstPiece(e){var r=this;return A(function*(){return r.firstPiece=P.of(r.firstPiece.get().getNext(r.phalanxDirection.get(),1)),r.firstPiece.equals(r.lastPiece)?yield r.moveOnlyPiece(e):(r.phalanxMiddles=r.phalanxMiddles.slice(1),r.validExtensions=r.getPhalanxValidExtensions(e)),r.phalanxValidLandings=r.getPhalanxValidLandings(),G.SUCCESS})()}moveLastPiece(e){var r=this;return A(function*(){return r.lastPiece=P.of(r.lastPiece.get().getPrevious(r.phalanxDirection.get(),1)),r.firstPiece.equals(r.lastPiece)?r.moveOnlyPiece(e):(r.phalanxMiddles=r.firstPiece.get().getCoordsToward(r.lastPiece.get()),r.validExtensions=r.getPhalanxValidExtensions(e),r.phalanxValidLandings=r.getPhalanxValidLandings(),G.SUCCESS)})()}moveOnlyPiece(e){var r=this;return A(function*(){return r.lastPiece=P.empty(),r.validExtensions=r.getFirstPieceExtensions(e),r.phalanxDirection=P.empty(),r.phalanxMiddles=[],r.phalanxValidLandings=r.getPhalanxValidLandings(),G.SUCCESS})()}tryMove(e){const r=this.getState();return this.cancelMove(),this.chooseMove(e,r)}getPieceClasses(e,r){const s=this.getPlayerClass(this.board[r][e]);return this.getPieceStrokeClasses(e,r).concat([s])}getPieceStrokeClasses(e,r){const s=new M(e,r);return this.firstPiece.isAbsent()?[]:this.firstPiece.equalsValue(s)||this.lastPiece.equalsValue(s)||this.phalanxMiddles.some(i=>i.equals(s))?["selected-stroke"]:[]}getRectClasses(e,r){const s=new M(e,r);return this.capturedCoords.some(i=>i.equals(s))?["captured-fill"]:this.moveds.some(i=>i.equals(s))?["moved-fill"]:[]}getHighlightedCoords(){return this.firstPiece.isPresent()?this.phalanxValidLandings.concat(this.validExtensions):this.getCurrentPlayerPieces()}getCurrentPlayerPieces(){const e=[],s=this.getState().getCurrentPlayer();for(let i=0;i<this.board.length;i++)for(let o=0;o<this.board[i].length;o++)this.board[i][o]===s&&e.push(new M(o,i));return e}}return n.\u0275fac=function(e){return new(e||n)(J(Pn))},n.\u0275cmp=gt({type:n,selectors:[["app-epaminondas"]],features:[l],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","0 0 1410 1210","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass","click",4,"ngIf"],[1,"base",3,"ngClass","click"],[1,"no-fill","mid-stroke","clickable-stroke",3,"click"]],template:function(e,r){1&e&&(F(),b(0,"svg",0),x(1,Xlt,2,1,"g",1),x(2,Qlt,2,4,"g",1),O()),2&e&&(D("transform",r.rotation),S(1),T("ngForOf",r.board),S(1),T("ngForOf",r.getHighlightedCoords()))},dependencies:[dn,An,en],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class Mi{constructor(t){if(t.length<4)throw new Error("Cannot create a GipfCapture with less than 4 captured pieces");if(!1===Ya.areOnSameLine(t))throw new Error("Cannot create a GipfCapture with pieces that are not on the same line");this.capturedSpaces=Ke.copyImmutableArray(t).sort((r,s)=>{if(r.x===s.x){if(r.y===s.y)throw new Error("Cannot create a GipfCapture with duplicate coords");return r.y>s.y?1:-1}return r.x>s.x?1:-1});let e=P.empty();for(const r of this.capturedSpaces){if(e.isPresent()&&1!==e.get().getDistance(r))throw new Error("Cannot create a GipfCapture with non-consecutive coords");e=P.of(r)}}toString(){let t="";for(const e of this.capturedSpaces)""!==t&&(t+=","),t+=e.toString();return t}size(){return this.capturedSpaces.length}forEach(t){this.capturedSpaces.forEach(t)}contains(t){for(let e=0;e<this.capturedSpaces.length;e++)if(this.capturedSpaces[e].equals(t))return!0;return!1}intersectsWith(t){return this.capturedSpaces.some(e=>t.contains(e))}getLine(){return Ya.fromTwoCoords(this.capturedSpaces[0],this.capturedSpaces[1]).get()}equals(t){if(this===t)return!0;if(this.capturedSpaces.length!==t.capturedSpaces.length)return!1;for(let e=0;e<this.capturedSpaces.length;e++)if(!this.capturedSpaces[e].equals(t.capturedSpaces[e]))return!1;return!0}}Mi.encoder=new class extends k4{encode(n){return n.capturedSpaces.map(t=>M.encoder.encode(t))}decode(n){return new Mi(n.map(M.encoder.decode))}};class Xa{constructor(t,e){this.coord=t,this.direction=e}toString(){return this.direction.isPresent()?this.coord.toString()+"@"+this.direction.get().toString():this.coord.toString()}equals(t){return!!this.coord.equals(t.coord)&&this.direction.equals(t.direction)}}Xa.encoder=new class extends k4{constructor(){super(...arguments),this.optionalDirectionEncoder=P.getEncoder(Le.encoder)}encode(n){return{coord:M.encoder.encode(n.coord),direction:this.optionalDirectionEncoder.encode(n.direction)}}decode(n){const t=n;return ve(null!=t.coord,"Invalid encoded GipfPlacement"),new Xa(M.encoder.decode(t.coord),this.optionalDirectionEncoder.decode(t.direction))}};class ga extends Gi{constructor(t,e,r){super(),this.placement=t,this.initialCaptures=e,this.finalCaptures=r}toString(){return"GipfMove(["+this.capturesToString(this.initialCaptures)+"], "+this.placement.toString()+", ["+this.capturesToString(this.finalCaptures)+"])"}capturesToString(t){let e="";for(const r of t)""!==e&&(e+=","),e+="["+r.toString()+"]";return e}equals(t){return this===t||!(!1===this.placement.equals(t.placement)||!1===Ke.compareArray(this.initialCaptures,t.initialCaptures)||!1===Ke.compareArray(this.finalCaptures,t.finalCaptures))}encode(){return ga.encoder.encode(this)}decode(t){return ga.encoder.decode(t)}}ga.encoder=new class extends mi{encodeMove(n){const t={placement:Xa.encoder.encode(n.placement)};return n.initialCaptures.map((e,r)=>{t["initialCapture"+r]=Mi.encoder.encode(e)}),n.finalCaptures.map((e,r)=>{t["finalCapture"+r]=Mi.encoder.encode(e)}),t}decodeMove(n){const t=n;return ve(null!=t.placement,"Invalid encoded GipfMove"),new ga(Xa.encoder.decode(t.placement),this.decodeArray(t,"initialCapture",Mi.encoder.decode),this.decodeArray(t,"finalCapture",Mi.encoder.decode))}decodeArray(n,t,e){const r=[];for(let s=0;null!=n[t+s];s++)r.push(e(n[t+s]));return r}};class Qa extends OH{constructor(t,e,r,s){super(e,t,7,7,[3,2,1],Ie.EMPTY),this.sidePieces=r,this.capturedPieces=s}static getInitialState(){const t=Ie.EMPTY,e=Ie.UNREACHABLE,r=Ie.ZERO,s=Ie.ONE;return new Qa([[e,e,e,s,t,t,r],[e,e,t,t,t,t,t],[e,t,t,t,t,t,t],[r,t,t,t,t,t,s],[t,t,t,t,t,t,e],[t,t,t,t,t,e,e],[s,t,t,r,e,e,e]],0,[12,12],[0,0])}equals(t){return this.turn===t.turn&&this.sidePieces[0]===t.sidePieces[0]&&this.sidePieces[1]===t.sidePieces[1]&&this.capturedPieces[0]===t.capturedPieces[0]&&this.capturedPieces[1]===t.capturedPieces[1]&&Ke.compareTable(this.board,t.board)}getNumberOfPiecesToPlace(t){return this.sidePieces[t.value]}getNumberOfPiecesCaptured(t){return this.capturedPieces[t.value]}setAtUnsafe(t,e){const r=Ke.copyBiArray(this.board);return r[t.y][t.x]=e,new Qa(r,this.turn,this.sidePieces,this.capturedPieces)}isOnBoard(t){return!t.isNotInRange(this.width,this.height)&&this.board[t.y][t.x]!==Ie.UNREACHABLE}}let Bc=(()=>{class n{}return n.CAPTURE_MUST_BE_ALIGNED=()=>$localize`You can only capture when 4 or more of your pieces are aligned, and it is not the case.`,n.INVALID_CAPTURED_PIECES=()=>$localize`You must select a valid capture that contains 4 pieces or more.`,n.MISSING_CAPTURES=()=>$localize`There are still possible captures to be done.`,n.PLACEMENT_NOT_ON_BORDER=()=>$localize`Pieces must be inserted in spaces on the edge of the board.`,n.INVALID_PLACEMENT_DIRECTION=()=>$localize`You must select a valid placement direction.`,n.PLACEMENT_WITHOUT_DIRECTION=()=>$localize`You must select a placement with a direction alongside the insertion space.`,n.PLACEMENT_ON_COMPLETE_LINE=()=>$localize`You cannot place a piece on a complete line.`,n.AMBIGUOUS_CAPTURE_COORD=()=>$localize`This piece belongs to two captures. Please select another piece in the capture you'd like to make.`,n.NO_DIRECTIONS_AVAILABLE=()=>$localize`You cannot insert a piece here, as all lines are full. Select another space.`,n})();class Un extends U1{applyLegalMove(t,e,r){return new Qa(r.board,r.turn+1,r.sidePieces,r.capturedPieces)}static applyCaptures(t,e){let r=e;return t.forEach(s=>{r=Un.applyCapture(s,r)}),r}static applyCapture(t,e){const r=e.getCurrentPlayer();let s=e;const i=[e.sidePieces[0],e.sidePieces[1]],o=[e.capturedPieces[0],e.capturedPieces[1]];return t.forEach(c=>{const u=e.getPieceAt(c);s=s.setAt(c,Ie.EMPTY),u.is(r)?i[r.value]+=1:o[r.value]+=1}),new Qa(s.board,e.turn,i,o)}static getPlacements(t){const e=[];return As.INSTANCE.getAllBorders(t).forEach(r=>{t.getPieceAt(r)===Ie.EMPTY?e.push(new Xa(r,P.empty())):Un.getAllDirectionsForEntrance(t,r).forEach(s=>{!1===Un.isLineComplete(t,r,s)&&e.push(new Xa(r,P.of(s)))})}),e}static isLineComplete(t,e,r){return Un.nextGapInLine(t,e,r).isAbsent()}static nextGapInLine(t,e,r){for(let s=e;t.isOnBoard(s);s=s.getNext(r))if(t.getPieceAt(s)===Ie.EMPTY)return P.of(s);return P.empty()}static applyPlacement(t,e){const r=e.getCurrentPlayer();let s=e,i=Ie.ofPlayer(e.getCurrentPlayer());if(t.direction.isAbsent()){const c=t.coord;if(e.getPieceAt(c)!==Ie.EMPTY)throw new Error("Apply placement called without direction while the coord is occupied");s=s.setAt(c,i)}else for(let c=t.coord;s.isOnBoard(c)&&i!==Ie.EMPTY;c=c.getNext(t.direction.get())){const u=e.getPieceAt(c);s=s.setAt(c,i),i=u}const o=[e.sidePieces[0],e.sidePieces[1]];return o[r.value]-=1,new Qa(s.board,e.turn,o,e.capturedPieces)}getPiecesMoved(t,e,r){const s=Un.applyCaptures(e,t);if(r.direction.isAbsent())return[r.coord];{const i=r.direction.get(),o=[];o.push(r.coord);let c=r.coord.getNext(i);for(;s.isOnBoard(c)&&s.getPieceAt(c)!==Ie.EMPTY;)o.push(c),c=c.getNext(i);return ve(s.isOnBoard(c)&&s.getPieceAt(c)===Ie.EMPTY,"getPiecesMoved called with an invalid placement performed on a full line"),o.push(c),o}}static getAllDirectionsForEntrance(t,e){if(As.INSTANCE.isTopLeftCorner(t,e))return[Le.RIGHT,Le.DOWN,Le.UP_RIGHT];if(As.INSTANCE.isTopCorner(t,e))return[Le.DOWN,Le.DOWN_LEFT,Le.RIGHT];if(As.INSTANCE.isTopRightCorner(t,e))return[Le.DOWN_LEFT,Le.DOWN,Le.LEFT];if(As.INSTANCE.isBottomLeftCorner(t,e))return[Le.UP_RIGHT,Le.UP,Le.RIGHT];if(As.INSTANCE.isBottomCorner(t,e))return[Le.UP,Le.LEFT,Le.UP_RIGHT];if(As.INSTANCE.isBottomRightCorner(t,e))return[Le.LEFT,Le.UP,Le.DOWN_LEFT];if(As.INSTANCE.isOnTopLeftBorder(t,e))return[Le.RIGHT,Le.DOWN];if(As.INSTANCE.isOnLeftBorder(t,e))return[Le.UP_RIGHT,Le.RIGHT];if(As.INSTANCE.isOnBottomLeftBorder(t,e))return[Le.UP,Le.UP_RIGHT];if(As.INSTANCE.isOnBottomRightBorder(t,e))return[Le.LEFT,Le.UP];if(As.INSTANCE.isOnRightBorder(t,e))return[Le.LEFT,Le.DOWN_LEFT];if(As.INSTANCE.isOnTopRightBorder(t,e))return[Le.DOWN_LEFT,Le.DOWN];throw new Error("not a border")}isLegal(t,e){const r=this.capturesValidity(e,t.initialCaptures);if(r.isFailure())return r.toFailedFallible();const s=Un.applyCaptures(t.initialCaptures,e),i=this.noMoreCapturesValidity(s);if(i.isFailure())return i.toFailedFallible();const o=this.placementValidity(s,t.placement);if(o.isFailure())return o.toFailedFallible();const c=Un.applyPlacement(t.placement,s),u=this.capturesValidity(c,t.finalCaptures);if(u.isFailure())return u.toFailedFallible();const h=Un.applyCaptures(t.finalCaptures,c),p=this.noMoreCapturesValidity(h);return p.isFailure()?p.toFailedFallible():U.success(h)}capturesValidity(t,e){let r=t;for(const s of e){const i=this.captureValidity(r,s);if(i.isFailure())return i;r=Un.applyCapture(s,r)}return G.SUCCESS}captureValidity(t,e){const r=t.getCurrentPlayer(),s=Un.getLinePortionWithFourPiecesOfPlayer(t,r,e.getLine());if(s.isAbsent())return G.failure(Bc.CAPTURE_MUST_BE_ALIGNED());const i=s.get();return Un.getCapturable(t,i).equals(e)?G.SUCCESS:G.failure(Bc.INVALID_CAPTURED_PIECES())}static getLinePortionsWithFourPiecesOfPlayer(t,e){const r=[];return t.allLines().forEach(s=>{const i=Un.getLinePortionWithFourPiecesOfPlayer(t,e,s);i.isPresent()&&r.push(i.get())}),r}static getLinePortionWithFourPiecesOfPlayer(t,e,r){let s=0;const i=t.getEntranceOnLine(r),o=r.getDirection();let c=i;for(let u=i;t.isOnBoard(u);u=u.getNext(o))if(t.getPieceAt(u).is(e)?(0===s&&(c=u),s+=1):s=0,4===s)return P.of({0:c,1:u,2:o});return P.empty()}noMoreCapturesValidity(t){const e=t.getCurrentPlayer();return 0===Un.getLinePortionsWithFourPiecesOfPlayer(t,e).length?G.SUCCESS:G.failure(Bc.MISSING_CAPTURES())}placementValidity(t,e){const r=this.placementCoordValidity(t,e.coord);if(r.isFailure())return r;if(t.getPieceAt(e.coord)!==Ie.EMPTY){if(e.direction.isAbsent())return G.failure(Bc.PLACEMENT_WITHOUT_DIRECTION());if(Un.isLineComplete(t,e.coord,e.direction.get()))return G.failure(Bc.PLACEMENT_ON_COMPLETE_LINE());for(const s of Un.getAllDirectionsForEntrance(t,e.coord))if(s===e.direction.get())return G.SUCCESS;return G.failure(Bc.INVALID_PLACEMENT_DIRECTION())}return G.SUCCESS}placementCoordValidity(t,e){return As.INSTANCE.isOnBorder(t,e)?G.SUCCESS:G.failure(Bc.PLACEMENT_NOT_ON_BORDER())}static getCapturable(t,e){const r=[],s=e[0],i=e[1],o=e[2],c=o.getOpposite();let u=s.getNext(c);for(;t.isOnBoard(u)&&t.getPieceAt(u)!==Ie.EMPTY;)r.push(u),u=u.getNext(c);for(let h=s;!h.equals(i);h=h.getNext(o))r.push(h);for(let h=i;t.isOnBoard(h)&&t.getPieceAt(h)!==Ie.EMPTY;h=h.getNext(o))r.push(h);return new Mi(r)}static getPossibleCaptures(t){const e=t.getCurrentPlayer(),r=[];return Un.getLinePortionsWithFourPiecesOfPlayer(t,e).forEach(s=>{r.push(Un.getCapturable(t,s))}),r}static getPlayerScore(t,e){const r=t.getNumberOfPiecesToPlace(e);if(0===r&&0===Un.getPossibleCaptures(t).length)return P.empty();const s=t.getNumberOfPiecesCaptured(e);return P.of(r+3*s)}static isGameOver(t){const e=Un.getPlayerScore(t,z.ZERO),r=Un.getPlayerScore(t,z.ONE);return e.isAbsent()||r.isAbsent()}getGameStatus(t){const e=t.gameState,r=Un.getPlayerScore(e,z.ZERO),s=Un.getPlayerScore(e,z.ONE);return r.isAbsent()?xe.ONE_WON:s.isAbsent()?xe.ZERO_WON:xe.ONGOING}}class Bm extends G1{static getPossibleCaptureCombinationsFromPossibleCaptures(t){const e=Bm.computeIntersections(t);let r=[[]];return t.forEach((s,i)=>{if(0===e[i].length)r.forEach(o=>{o.push(i)});else{const o=[],c=e[i].some(u=>u>i);for(const u of r)!0===u.some(p=>e[i].some(m=>p===m))?o.push(Ke.copyImmutableArray(u)):c?(o.push(Ke.copyImmutableArray(u)),u.push(i),o.push(Ke.copyImmutableArray(u))):(u.push(i),o.push(Ke.copyImmutableArray(u)));r=o}}),r.map(s=>s.map(i=>t[i]))}static computeIntersections(t){const e=[];return t.forEach((r,s)=>{e.push([]),t.forEach((i,o)=>{s!==o&&r.intersectsWith(i)&&e[s].push(o)})}),e}getBoardValue(t){const e=t.gameState,r=Un.getPlayerScore(e,z.ZERO),s=Un.getPlayerScore(e,z.ONE);return r.isAbsent()?new Ct(z.ONE.getVictoryValue()):s.isAbsent()?new Ct(z.ZERO.getVictoryValue()):new Ct(r.get()-s.get())}getListMoves(t){return this.getListMoveFromState(t.gameState)}getListMoveFromState(t){const e=[];return Un.isGameOver(t)||this.getPossibleCaptureCombinations(t).forEach(r=>{const s=Un.applyCaptures(r,t);Un.getPlacements(s).forEach(i=>{const o=Un.applyPlacement(i,s);this.getPossibleCaptureCombinations(o).forEach(c=>{const u=new ga(i,r,c);e.push(u)})})}),e}getPossibleCaptureCombinations(t){const e=Un.getPossibleCaptures(t);return Bm.getPossibleCaptureCombinationsFromPossibleCaptures(e)}}class o3e{constructor(t,e,r,s,i,o){this.source=t,this.destination=e,this.x1=r,this.y1=s,this.x2=i,this.y2=o}}const s1=Ie.UNREACHABLE,ht=Ie.EMPTY,kr=Ie.ZERO,V4=Ie.ONE;class a3e extends K1{constructor(){super(...arguments),this.tutorial=[ce.informational($localize`Goal of the game`,$localize`The goal of Gipf is to capture the opponent's piece so that the opponent can no longer play.
        This is the initial board.
        Each player has 12 pieces on the side and 3 pieces on the board.
        When, at its turn, a player has no more pieces on the side, that player cannot play anymore and loses the game.
        The first player plays with the dark pieces, the second player plays with the light pieces.`,Qa.getInitialState()),ce.anyMove($localize`Pushing`,$localize`Pieces can only enter the board through the edges. To insert a new piece:
        <ol>
            <li>Click on a space on the edge of the board.</li>
            <li>If that space was already occupied, click on the arrow that indicates the direction in which you want to push the piece(s) already on the corresponding line.</li>
        </ol>
        You cannot push when a line is full.<br/><br/>
        You're playing Dark, insert a piece.`,Qa.getInitialState(),new ga(new Xa(new M(3,0),P.of(Le.DOWN)),[],[]),$localize`Congratulations!`),ce.fromMove($localize`Capture (1/3)`,$localize`To capture, you must align 4 of your own pieces, which will be the first 4 captured pieces.
        There are multiple important aspects of a capture:
        <ol>
            <li>When 4 pieces are captured, all pieces that are directly aligned with these 4 pieces are also captured.</li>
            <li>As soon as there is an empty space on the line, the capture stops.</li>
            <li>Your own pieces that are captured go back to your stock.
                Your opponent's pieces however are really captured and do not go back to your opponent's stock.</li>
            <li>If you create a line of 4 of your opponent's pieces, it will be at the beginning of your opponent's turn that your opponent can capture them.
                This means that a turn happens in three phases:
                <ol type="A">
                    <li>Pick the capture(s) resulting from the last move of your opponent (by clicking on it).</li>
                    <li>Make your insertion.</li>
                    <li>Pick the capture(s) resulting from your move (by clicking on it).</li>
                </ol>
            </li>
        </ol><br/>
        You're playing Dark, you can make a capture, do it.`,new Qa([[s1,s1,s1,kr,V4,ht,ht],[s1,s1,ht,ht,ht,ht,ht],[s1,ht,ht,ht,ht,ht,ht],[kr,kr,kr,ht,ht,ht,ht],[V4,ht,ht,ht,ht,ht,s1],[ht,ht,ht,V4,ht,s1,s1],[ht,ht,ht,V4,s1,s1,s1]],42,[8,8],[0,0]),[new ga(new Xa(new M(0,3),P.of(Le.RIGHT)),[],[new Mi([new M(0,3),new M(1,3),new M(2,3),new M(3,3)])])],$localize`Congratulations, you have gotten 4 of your pieces back. This is not the most useful capture.
        Let's now see how captures can really be useful.`,$localize`Failed. Try again.`),ce.fromMove($localize`Capture (2/3)`,$localize`Here, there are three different ways for Dark to capture.
        <ol>
          <li>One way does not capture any of your opponent's pieces.</li>
          <li>Another way captures one of your opponent's pieces.</li>
          <li>The last way captures two of your opponent's pieces.</li>
        </ol>
        <br/>
        You're playing Dark, capture the most pieces from your opponent.`,new Qa([[s1,s1,s1,ht,ht,ht,ht],[s1,s1,ht,V4,ht,ht,ht],[s1,ht,ht,kr,ht,ht,ht],[kr,kr,kr,V4,ht,ht,ht],[ht,ht,ht,kr,ht,ht,s1],[ht,ht,ht,kr,ht,s1,s1],[ht,ht,ht,V4,s1,s1,s1]],42,[8,4],[2,3]),[new ga(new Xa(new M(0,3),P.of(Le.RIGHT)),[],[new Mi([new M(3,1),new M(3,2),new M(3,3),new M(3,4),new M(3,5),new M(3,6)])])],$localize`Congratulations, you have gotten back 4 of your pieces and captured 2 of the opponent's.
        The most you can get is 3 per capture.`,$localize`Failed, the best capture was taking 2 of your opponent's pieces`),ce.fromMove($localize`Capture (3/3)`,$localize`Here, you must capture at the beginning of your turn.
        This is due to a move of your opponent at the previous turn
        (even though this is a fictitious board for pedagogical purpose).
        After your capture, by performing the right move you can even capture two more of your opponent's pieces!
        Keep it mind that the most useful in a capture is to take your opponent's pieces.<br/><br/>
        You're playing Dark, capture the most pieces from your opponent.`,new Qa([[s1,s1,s1,kr,ht,ht,kr],[s1,s1,ht,kr,ht,ht,kr],[s1,kr,kr,ht,kr,V4,kr],[ht,ht,ht,kr,ht,ht,kr],[ht,ht,ht,kr,ht,ht,s1],[kr,kr,kr,V4,V4,s1,s1],[ht,ht,ht,kr,s1,s1,s1]],42,[3,4],[2,3]),[new ga(new Xa(new M(3,6),P.of(Le.UP)),[new Mi([new M(6,0),new M(6,1),new M(6,2),new M(6,3)])],[new Mi([new M(0,5),new M(1,5),new M(2,5),new M(3,5),new M(4,5)]),new Mi([new M(1,2),new M(2,2),new M(3,2),new M(4,2),new M(5,2)])]),new ga(new Xa(new M(4,6),P.of(Le.UP)),[new Mi([new M(6,0),new M(6,1),new M(6,2),new M(6,3)])],[new Mi([new M(0,5),new M(1,5),new M(2,5),new M(3,5),new M(4,5)]),new Mi([new M(3,0),new M(3,1),new M(3,2),new M(3,3),new M(3,4)])]),new ga(new Xa(new M(3,6),P.of(Le.UP)),[new Mi([new M(6,0),new M(6,1),new M(6,2),new M(6,3)])],[new Mi([new M(1,2),new M(2,2),new M(3,2),new M(4,2),new M(5,2)]),new Mi([new M(0,5),new M(1,5),new M(2,5),new M(3,5),new M(4,5)])])],$localize`Congratulations, you have gotten 12 of your pieces back and captured 2 of your opponent's pieces.`,$localize`Failed, the best capture takes 2 of your opponent's pieces.`)]}}function e6t(n,t){if(1&n&&(F(),Q(0,"circle",13)),2&n){const e=v().$implicit,r=v();T("ngClass",r.getPieceClass(e)),D("cx",r.getCenterAt(e).x)("cy",r.getCenterAt(e).y)("r",r.SPACE_SIZE)}}function t6t(n,t){if(1&n){const e=Oe();F(),b(0,"g",10),ee("click",function(){const i=he(e).$implicit;return le(v().onClick(i))}),Q(1,"polygon",11),x(2,e6t,1,4,"circle",12),O()}if(2&n){const e=t.$implicit,r=v();We("id","click_",e.x,"_",e.y,""),S(1),We("id","space_",e.x,"_",e.y,""),T("ngClass",r.getSpaceClass(e)),D("points",r.getHexaPointsAt(e)),S(1),T("ngIf",r.isPiece(e))}}function n6t(n,t){if(1&n){const e=Oe();F(),b(0,"polygon",16),ee("click",function(){const i=he(e).$implicit;return le(v(2).onClick(i))}),O()}if(2&n){const e=t.$implicit;D("points",v(2).getHexaPointsAt(e))}}function r6t(n,t){if(1&n&&(F(),b(0,"g",14),x(1,n6t,1,1,"polygon",15),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e.capturedSpaces)}}function s6t(n,t){if(1&n){const e=Oe();F(),b(0,"line",17),ee("click",function(){const i=he(e).$implicit;return le(v().onClick(i.destination))}),O()}if(2&n){const e=t.$implicit;D("x1",e.x1)("y1",e.y1)("x2",e.x2)("y2",e.y2)}}function i6t(n,t){if(1&n&&(F(),b(0,"g"),Q(1,"circle",18),O()),2&n){const e=t.$implicit,r=v().$implicit,s=v();S(1),We("id","piece_",r.value,"_",e,""),T("ngClass",s.getPlayerClass(r)),D("cx",s.getRemainingPieceCx(r,e))("cy",s.getRemainingPieceCy(r))("r",.5*s.SPACE_SIZE)}}function o6t(n,t){if(1&n&&(F(),b(0,"g"),x(1,i6t,2,6,"g",8),O()),2&n){const e=t.$implicit,r=v();S(1),T("ngForOf",r.getPlayerSidePieces(e))}}function a6t(n,t){if(1&n&&(F(),Q(0,"line",19)),2&n){const e=v();D("x1",e.inserted.get().x1)("y1",e.inserted.get().y1)("x2",e.inserted.get().x2)("y2",e.inserted.get().y2)}}let c6t=(()=>{class n extends y9{constructor(e){super(e),this.inserted=P.empty(),this.arrows=[],this.captured=[],this.moved=[],this.hexagonWidth=this.SPACE_SIZE,this.sharedHexagonX=Math.cos(30)*this.hexagonWidth*.5,this.boardWidth=this.hexagonWidth+6*(this.hexagonWidth-this.sharedHexagonX)+3*this.STROKE_WIDTH/2,this.boardHeight=7*this.hexagonWidth+4.5*this.STROKE_WIDTH,this.movePhase=n.PHASE_PLACEMENT_COORD,this.possibleCaptures=[],this.initialCaptures=[],this.placement=P.empty(),this.placementEntrance=P.empty(),this.finalCaptures=[],this.hasAsymetricBoard=!0,this.scores=P.of([0,0]),this.rules=new Un(Qa),this.availableMinimaxes=[new Bm(this.rules,"GipfMinimax")],this.encoder=ga.encoder,this.tutorial=(new a3e).tutorial,this.SPACE_SIZE=40,this.constructedState=this.getState(),this.hexaLayout=new E9(1.5*this.SPACE_SIZE,new M(this.hexagonWidth/2+3*this.STROKE_WIDTH/4,-this.hexagonWidth),As.INSTANCE)}updateBoard(){this.showLastMove(),this.cancelMoveAttempt()}showLastMove(){this.inserted=P.empty();const e=this.rules.node.move;if(e.isPresent()&&e.get().placement.direction.isPresent()){const r=e.get().placement;this.inserted=P.of(this.arrowTowards(r.coord,r.direction.get()))}this.cancelMoveAttempt()}arrowTowards(e,r){const s=e.getNext(r.getOpposite()),i=this.getCenterAt(e),o=this.getCenterAt(s);return new o3e(s,e,o.x,o.y,i.x,i.y)}markCapture(e){e.forEach(r=>{this.captured.push(r)})}getAllCoords(){return this.constructedState.allCoords()}getPlayerSidePieces(e){const r=this.constructedState.getNumberOfPiecesToPlace(e),s=[];for(let i=0;i<r;i+=1)s.push(i);return s}isPiece(e){return this.getPiece(e)!==Ie.EMPTY}getPiece(e){return this.constructedState.getPieceAt(e)}onClick(e){var r=this;return A(function*(){const s=r.canUserPlay("#click_"+e.x+"_"+e.y);if(s.isFailure())return r.cancelMove(s.getReason());switch(r.movePhase){case n.PHASE_INITIAL_CAPTURE:case n.PHASE_FINAL_CAPTURE:return r.selectCapture(e);case n.PHASE_PLACEMENT_COORD:return r.selectPlacementCoord(e);default:return Me.expectToBe(r.movePhase,n.PHASE_PLACEMENT_DIRECTION),r.selectPlacementDirectionOrPlacementCoord(e)}})()}selectCapture(e){var r=this;return A(function*(){const s=[];if(r.possibleCaptures.forEach(o=>{o.contains(e)&&s.push(o)}),s.length>1)return r.cancelMove(Bc.AMBIGUOUS_CAPTURE_COORD());if(0===s.length)return r.cancelMove(Bc.MISSING_CAPTURES());const i=s[0];return r.constructedState=Un.applyCapture(i,r.constructedState),r.markCapture(i),r.possibleCaptures=Un.getPossibleCaptures(r.constructedState),r.movePhase===n.PHASE_INITIAL_CAPTURE?(r.initialCaptures.push(i),0===r.possibleCaptures.length?r.moveToPlacementPhase():G.SUCCESS):(Me.expectToBe(r.movePhase,n.PHASE_FINAL_CAPTURE),r.finalCaptures.push(i),0===r.possibleCaptures.length?r.tryMove(r.initialCaptures,r.placement.get(),r.finalCaptures):G.SUCCESS)})()}moveToPlacementPhase(){return this.movePhase=n.PHASE_PLACEMENT_COORD,G.SUCCESS}moveToInitialCaptureOrPlacementPhase(){return this.possibleCaptures=Un.getPossibleCaptures(this.constructedState),this.movePhase=0===this.possibleCaptures.length?n.PHASE_PLACEMENT_COORD:n.PHASE_INITIAL_CAPTURE,G.SUCCESS}moveToFinalCapturePhaseOrTryMove(){var e=this;return A(function*(){return e.possibleCaptures=Un.getPossibleCaptures(e.constructedState),0===e.possibleCaptures.length?e.tryMove(e.initialCaptures,e.placement.get(),e.finalCaptures):(e.movePhase=n.PHASE_FINAL_CAPTURE,G.SUCCESS)})()}computeArrows(e){this.arrows=[];for(const r of Un.getAllDirectionsForEntrance(this.constructedState,e))if(!1===Un.isLineComplete(this.constructedState,e,r)){const s=e.getNext(r),i=this.getCenterAt(e),o=this.getCenterAt(s);this.arrows.push(new o3e(e,s,i.x,i.y,o.x,o.y))}}selectPlacementCoord(e){var r=this;return A(function*(){const s=r.rules.placementCoordValidity(r.constructedState,e);return s.isFailure()?r.cancelMove(s.getReason()):r.placementEntrance.equalsValue(e)?(r.cancelMoveAttempt(),G.SUCCESS):(r.placementEntrance=P.of(e),r.constructedState.getPieceAt(e)===Ie.EMPTY?r.selectPlacementDirection(P.empty()):(r.movePhase=n.PHASE_PLACEMENT_DIRECTION,r.computeArrows(e),0===r.arrows.length&&r.cancelMove(Bc.NO_DIRECTIONS_AVAILABLE()),G.SUCCESS))})()}selectPlacementDirection(e){var r=this;return A(function*(){r.placement=P.of(new Xa(r.placementEntrance.get(),e));const s=r.rules.placementValidity(r.constructedState,r.placement.get());return s.isFailure()?r.cancelMove(s.getReason()):(r.arrows=[],r.constructedState=Un.applyPlacement(r.placement.get(),r.constructedState),r.moveToFinalCapturePhaseOrTryMove())})()}selectPlacementDirectionOrPlacementCoord(e){var r=this;return A(function*(){const s=r.placementEntrance.get();if(!1===s.isAlignedWith(e)||1!==s.getDistance(e))return r.selectPlacementCoord(e);const i=Le.factory.fromMove(s,e);return r.selectPlacementDirection(i.toOptional())})()}tryMove(e,r,s){var i=this;return A(function*(){const o=new ga(r,e,s);return yield i.chooseMove(o,i.getState(),i.scores.get())})()}cancelMoveAttempt(){this.constructedState=this.getState(),this.captured=[],this.moved=[];const e=this.rules.node.move;if(e.isPresent()){const r=e.get(),s=this.rules.node.mother.get().gameState;r.initialCaptures.forEach(i=>this.markCapture(i)),r.finalCaptures.forEach(i=>this.markCapture(i)),this.moved=this.rules.getPiecesMoved(s,r.initialCaptures,r.placement)}this.initialCaptures=[],this.finalCaptures=[],this.placementEntrance=P.empty(),this.placement=P.empty(),this.arrows=[],this.moveToInitialCaptureOrPlacementPhase()}getSpaceClass(e){return this.captured.some(r=>r.equals(e))?"captured-fill":this.moved.some(r=>r.equals(e))?"moved-fill":""}getPieceClass(e){const r=this.getPiece(e);return this.getPlayerClass(z.of(r.value))}getRemainingPieceCy(e){return e===z.ONE?25:this.boardHeight-25}getRemainingPieceCx(e,r){const s=20+r*this.SPACE_SIZE*.5;return e===z.ONE?s:this.boardWidth-(15+s)}}return n.PHASE_INITIAL_CAPTURE=0,n.PHASE_PLACEMENT_COORD=1,n.PHASE_PLACEMENT_DIRECTION=2,n.PHASE_FINAL_CAPTURE=3,n.\u0275fac=function(e){return new(e||n)(J(Pn))},n.\u0275cmp=gt({type:n,selectors:[["app-gipf"]],features:[l],decls:11,vars:7,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["id","arrowhead","markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto"],["points","0 0, 10 3.5, 0 7"],["id","arrowhead-moved","markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto"],["points","0 0, 10 3.5, 0 7",1,"moved-fill","moved-stroke"],[3,"id","click",4,"ngFor","ngForOf"],["pointer-events","fill","class","capturable-stroke",4,"ngFor","ngForOf"],["class","arrow","marker-end","url(#arrowhead)",3,"click",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],["class","arrow moved-stroke","marker-end","url(#arrowhead-moved)",4,"ngIf"],[3,"id","click"],["stroke-linecap","round",1,"base",3,"id","ngClass"],["class","base",3,"ngClass",4,"ngIf"],[1,"base",3,"ngClass"],["pointer-events","fill",1,"capturable-stroke"],["class","no-fill","stroke-linecap","round",3,"click",4,"ngFor","ngForOf"],["stroke-linecap","round",1,"no-fill",3,"click"],["marker-end","url(#arrowhead)",1,"arrow",3,"click"],[1,"base","small-stroke",3,"id","ngClass"],["marker-end","url(#arrowhead-moved)",1,"arrow","moved-stroke"]],template:function(e,r){1&e&&(F(),b(0,"svg",0)(1,"defs")(2,"marker",1),Q(3,"polygon",2),O(),b(4,"marker",3),Q(5,"polygon",4),O()(),x(6,t6t,3,7,"g",5),x(7,r6t,2,1,"g",6),x(8,s6t,1,4,"line",7),x(9,o6t,2,1,"g",8),x(10,a6t,1,4,"line",9),O()),2&e&&(D("viewBox",-r.STROKE_WIDTH+" 0 "+r.boardWidth+" "+r.boardHeight)("transform",r.rotation),S(6),T("ngForOf",r.getAllCoords()),S(1),T("ngForOf",r.possibleCaptures),S(1),T("ngForOf",r.arrows),S(1),T("ngForOf",r.Player.PLAYERS),S(1),T("ngIf",r.inserted.isPresent()))},dependencies:[dn,An,en],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class J1 extends xc{equals(t){return this===t||this.coord.equals(t.coord)}toString(){return this===J1.PASS?"GoMove.PASS":this===J1.ACCEPT?"GoMove.ACCEPT":"GoMove("+this.coord.x+", "+this.coord.y+")"}}J1.PASS=new J1(-1,0),J1.ACCEPT=new J1(-2,0),J1.PASS_NUMBER=-1,J1.ACCEPT_NUMBER=-2,J1.encoder=new class extends Cn{maxValue(){return 360}encodeNumber(n){return 19*n.coord.y+n.coord.x}decodeNumber(n){if(n===J1.PASS_NUMBER)return J1.PASS;const t=n%19;return new J1(t,(n-t)/19)}};class Ue{constructor(t,e){this.player=t,this.type=e}equals(t){return t===this}toString(){switch(this){case Ue.DARK:return"GoPiece.DARK";case Ue.LIGHT:return"GoPiece.LIGHT";case Ue.EMPTY:return"GoPiece.EMPTY";case Ue.DEAD_DARK:return"GoPiece.DEAD_DARK";case Ue.DEAD_LIGHT:return"GoPiece.DEAD_LIGHT";case Ue.DARK_TERRITORY:return"GoPiece.DARK_TERRITORY";default:return ve(this===Ue.LIGHT_TERRITORY,"Unexisting GoPiece"),"GoPiece.LIGHT_TERRITORY"}}static pieceBelongTo(t,e){return e===t.player&&"territory"!==t.type}static ofPlayer(t){return t===z.ZERO?Ue.DARK:Ue.LIGHT}isOccupied(){return[Ue.DARK,Ue.LIGHT,Ue.DEAD_DARK,Ue.DEAD_LIGHT].includes(this)}isEmpty(){return[Ue.DARK_TERRITORY,Ue.LIGHT_TERRITORY,Ue.EMPTY].includes(this)}isDead(){return[Ue.DEAD_DARK,Ue.DEAD_LIGHT].includes(this)}isTerritory(){return[Ue.DARK_TERRITORY,Ue.LIGHT_TERRITORY].includes(this)}getOwner(){return this.player}nonTerritory(){return ve(this.isEmpty(),'Usually not false, if false, cover by test and return "this"'),Ue.EMPTY}}Ue.DARK=new Ue(z.ZERO,"alive"),Ue.LIGHT=new Ue(z.ONE,"alive"),Ue.EMPTY=new Ue(pe.NONE,"empty"),Ue.DEAD_DARK=new Ue(z.ZERO,"dead"),Ue.DEAD_LIGHT=new Ue(z.ONE,"dead"),Ue.DARK_TERRITORY=new Ue(pe.NONE,"territory"),Ue.LIGHT_TERRITORY=new Ue(pe.NONE,"territory");var Hn=(()=>(function(n){n.PLAYING="PLAYING",n.PASSED="PASSED",n.COUNTING="COUNTING",n.ACCEPT="ACCEPT",n.FINISHED="FINISHED"}(Hn||(Hn={})),Hn))();let xs=(()=>{class n extends es{constructor(e,r,s,i,o){super(e,s),this.captured=r,this.koCoord=i,this.phase=o}static getInitialState(){const e=n.getStartingBoard();return new n(e,[0,0],0,P.empty(),Hn.PLAYING)}getCapturedCopy(){return[this.captured[0],this.captured[1]]}static getStartingBoard(){return Ke.createTable(n.WIDTH,n.HEIGHT,Ue.EMPTY)}copy(){return new n(this.getCopiedBoard(),this.getCapturedCopy(),this.turn,this.koCoord,this.phase)}isDead(e){return this.getPieceAt(e).isDead()}isTerritory(e){return this.getPieceAt(e).isTerritory()}}return n.WIDTH=13,n.HEIGHT=13,n})();const at=Ue.LIGHT,Je=Ue.DARK,AH=Ue.DEAD_LIGHT,b9=Ue.LIGHT_TERRITORY,$c=Ue.DARK_TERRITORY,Ce=Ue.EMPTY;class c3e extends K1{constructor(){super(...arguments),this.tutorial=[ce.informational($localize`Preliminary information`,$localize`The game of Go is played on a board called a Goban, and the stones are placed on the intersections.
        The traditional board is made of 19x19 intersections, but on this website we have the 13x13 board.
        (For shorter parts, 9x9 and 5x5 boards exist, but are not yet available here).
        For this tutorial, we will use a smaller board for pedagogical purposes.`,xs.getInitialState()),ce.informational($localize`Goal of the game`,$localize`The goal of the game is to have the most points at the end of the game.
        We call "territories" the intersections that are empty and isolated from the rest of the Goban by the stones of a single player.
        Here, Dark has 9 territories on the left, and Light has 8 on the right.
        The top part belongs to no one.
        Each player's score at the end of the game is the sum of that player's territories and captures.`,new xs([[Ce,Je,Ce,Ce,at,at],[Ce,Je,Ce,Ce,at,Ce],[Ce,Je,Je,at,at,Ce],[Ce,Ce,Je,at,Ce,Ce],[Ce,Ce,Je,at,Ce,Ce],[Ce,Ce,Je,at,Ce,Ce]],[0,0],0,P.empty(),Hn.PLAYING)),ce.fromMove($localize`Simple capture`,$localize`An isolated stone, like the one in the middle here, has 4 neighboring intersections (not 8, because we do not count diagonals).
        It is said of a group which has exactly 2 free neighboring squares, that this group has two liberties.
        If Dark plays on the last liberty of the light stone, this stone is removed from the Goban (captured) and Dark earns one point.<br/><br/>
        You're playing Dark. The light piece on the board only has one liberty left, play there.`,new xs([[Ce,Ce,Ce,Ce,Ce],[Ce,Ce,Je,Ce,Ce],[Ce,Je,at,Ce,Ce],[Ce,Ce,Je,Ce,Ce],[Ce,Ce,Ce,Ce,Ce]],[0,0],0,P.empty(),Hn.PLAYING),[new J1(3,2)],$localize`Congratulations, you have earned one point.`,$localize`Failed, try again by playing on one of the intersections directly next to the light stone.`),ce.fromMove($localize`Capturing multiple stones`,$localize`Stones that are connected horizontally or vertically must be captured at the same time, and are not capturable in isolation.<br/><br/>
        You're playing Dark. The light group here only has one liberty left, capture it.`,new xs([[Ce,Je,Ce,Ce,Ce],[Je,at,Ce,Ce,Ce],[Je,at,at,Je,Ce],[Ce,Je,Je,Ce,Ce],[Ce,Ce,Ce,Ce,Ce]],[0,0],0,P.empty(),Hn.PLAYING),[new J1(2,1)],$localize`Congratulations, you have earned three points and formed a territory.`,$localize`Failed, you have not captured the group. Play on the last liberty of that group.`),ce.informational($localize`Suicide`,$localize`In Go, suicide is forbidden.
        If putting a piece on an intersection removes the last liberty of your group and does not capture any stone, playing on that intersection would be a suicide and is therefore forbidden.
        Here, the top left intersection is a suicide for Light.
        On the bottom right, it would be a suicide for Dark, and on the bottom left it is not a suicide for any player.`,new xs([[Ce,Je,Ce,Ce,Ce],[Je,Ce,Ce,Ce,Ce],[Je,Ce,Ce,Ce,at],[at,Je,Ce,at,Ce],[Ce,at,Ce,at,Je]],[0,0],0,P.empty(),Hn.PLAYING)),ce.informational($localize`Life and death (death)`,$localize`From the capture rule follows the life and death notion:
        dead stones are stones that are definitely capturable (without losing anything else).
        Alive stones are stones that can never be captured.
        From the capture rule, Dark can play inside Light's territory and make a capture.
        In this case, we say that Light has only one eye (its last liberty) and that Light is dead (even if not yet captured).
        At the end of the game, the dead stones will count as captures, and the intersections they occupy as territories.`,new xs([[Ce,Ce,Ce,Ce,Ce],[Je,Je,Je,Ce,Ce],[at,at,Je,Ce,Ce],[Ce,at,Je,Ce,Ce],[at,at,Je,Ce,Ce]],[0,0],0,P.empty(),Hn.PLAYING)),ce.informational($localize`Life and death (eyes)`,$localize`Here, Light cannot play on the top left, nor on the bottom left.
        Light will never be able to capture Dark.
        We say that Dark has two eyes (the eye on the top left, and the one on the bottom left) and that Dark is alive.`,new xs([[Ce,Je,at,Ce,Ce],[at,Je,at,Ce,Ce],[Je,Je,at,Ce,Ce],[at,Je,at,Ce,Ce],[Ce,Je,at,Ce,Ce]],[0,0],0,P.empty(),Hn.PLAYING)),ce.informational($localize`Seki`,$localize`If Dark plays on the middle line, Light will play on the opposite intersection and capture Dark.
        Similarly, if Light plays on the middle line, Dark will capture Light.
        In other words, there is no point in playing on the middle line.
        In that case, we say that stones in the middle are alive by Seki, and that both intersections in the middle are neutral.`,new xs([[Ce,at,Je,Ce,at,Je,Ce],[Ce,at,Je,Je,at,Je,Ce],[Ce,at,Je,Je,at,Je,Ce],[Ce,at,Je,Je,at,Je,Ce],[Ce,at,Je,at,at,Je,Ce],[Ce,at,Je,at,at,Je,Ce],[Ce,at,Je,Ce,at,Je,Ce]],[0,0],0,P.empty(),Hn.PLAYING)),ce.fromMove($localize`Ko`,$localize`A player, by putting a stone, cannot go back to an identical state of the Goban as before, in order to avoid an endless game.<br/><br/>
        You're playing Dark, capture the light stone.`,new xs([[Ce,Ce,Ce,Ce,Ce,Ce,Ce],[Ce,Ce,Ce,Ce,Ce,Ce,Ce],[Ce,Ce,Ce,Je,at,Ce,Ce],[Ce,Ce,Je,at,Ce,at,Ce],[Ce,Ce,Ce,Je,at,Ce,Ce],[Ce,Ce,Ce,Ce,Ce,Ce,Ce],[Ce,Ce,Ce,Ce,Ce,Ce,Ce]],[0,0],0,P.empty(),Hn.PLAYING),[new J1(4,3)],$localize`Now, if Light tries to recapture the stone that Dark has just put on the Goban, this one would go back to its previous state, opening the door for an endless game.
        This intersection is therefore marked with a red square, to remind the players that this intersection is forbidden.
        This rule is called the Ko.
        The trick for Light is to try to create a big enough threat so that Dark must answer immediately, and does not have the time to protect its last stone, so that Light can capture it right after.`,$localize`Failed. Try again.`),ce.fromMove($localize`End of the game`,$localize`When a player feels that there is no advantage to putting a new stone, that player can pass a turn.
        The game phase stops when both players pass consecutively, and we move on to the counting phase.
        The dead groups are then marked by clicking on them.
        Every intersection in a player's territory earns that player a point.
        The winner is the one with most points.<br/><br/>
        You're playing Dark. A last stone is dead, mark it.`,new xs([[at,Je,Je,Je,Je,Je,$c,$c,$c],[at,at,at,at,Je,Je,Je,$c,$c],[at,b9,at,at,Je,AH,AH,Je,$c],[Je,at,at,at,at,Je,$c,$c,$c],[Ce,at,b9,at,Je,Je,AH,Je,$c],[at,b9,at,at,Je,Je,Je,Je,Je],[at,at,Je,Je,Je,at,at,Je,at],[Je,Je,Je,at,at,at,b9,at,at],[$c,$c,Je,Je,Je,at,at,b9,b9]],[0,0],0,P.empty(),Hn.COUNTING),[new J1(0,3)],$localize`Congratulations, Dark has 15 territories and 3 light stones still present, called prisoners at the end of the game.
        The intersections where the prisoners are count as Dark's territory
        Light has 8 territories and 1 prisoner.
        The end result is therefore 18 - 9 for Dark.`,$localize`Failed, try again.`)]}}let l8=(()=>{class n{constructor(e){this.color=e}selfContains(e){return this.getCoords().some(s=>s.equals(e))}static insertAsEntryPoint(e,r){return 0===e.length?[r]:r.compareTo(e[0])<0?[r].concat(e):e.concat([r])}}return n.VERBOSE=!1,n})();class f6t extends l8{constructor(t,e,r,s,i,o){super(t),this.emptyCoords=e,this.darkCoords=r,this.lightCoords=s,this.deadDarkCoords=i,this.deadLightCoords=o}getCoords(){return this.color===Ue.DARK?this.darkCoords:this.color===Ue.LIGHT?this.lightCoords:this.color===Ue.DEAD_DARK?this.deadDarkCoords:this.color===Ue.DEAD_LIGHT?this.deadLightCoords:this.emptyCoords}contains(t){return this.darkCoords.concat(this.lightCoords.concat(this.emptyCoords.concat(this.deadDarkCoords.concat(this.deadLightCoords)))).some(r=>r.equals(t))}addPawn(t,e){switch(ve(!1===this.contains(t),"This group already contains "+t.toString()),e){case Ue.DARK:this.darkCoords=l8.insertAsEntryPoint(this.darkCoords,t);break;case Ue.LIGHT:this.lightCoords=l8.insertAsEntryPoint(this.lightCoords,t);break;case Ue.DEAD_DARK:this.deadDarkCoords=l8.insertAsEntryPoint(this.deadDarkCoords,t);break;case Ue.DEAD_LIGHT:this.deadLightCoords=l8.insertAsEntryPoint(this.deadLightCoords,t);break;default:Me.expectToBeMultiple(e,[Ue.EMPTY,Ue.DARK_TERRITORY,Ue.LIGHT_TERRITORY]),this.emptyCoords=l8.insertAsEntryPoint(this.emptyCoords,t)}}isMonoWrapped(){return(this.darkCoords.length+this.deadLightCoords.length===0?0:1)+(this.lightCoords.length+this.deadDarkCoords.length===0?0:1)==1}getWrapper(){const t=new Vn;t.set(Ue.EMPTY,this.emptyCoords.length),t.set(Ue.DARK,this.darkCoords.length+this.deadLightCoords.length),t.set(Ue.LIGHT,this.lightCoords.length+this.deadDarkCoords.length),t.put(this.color.nonTerritory(),0);const e=t.filter((r,s)=>s>0);if(1===e.size())return e.getByIndex(0).key;throw new Error("Can't call getWrapper on non-mono-wrapped group")}getNeighborsEntryPoints(){const t=[];return this.color!==Ue.EMPTY&&this.emptyCoords.length>0&&t.push(this.emptyCoords[0]),this.color!==Ue.DARK&&this.darkCoords.length>0&&t.push(this.darkCoords[0]),this.color!==Ue.LIGHT&&this.lightCoords.length>0&&t.push(this.lightCoords[0]),this.color!==Ue.DEAD_DARK&&this.deadDarkCoords.length>0&&t.push(this.deadDarkCoords[0]),this.color!==Ue.DEAD_LIGHT&&this.deadLightCoords.length>0&&t.push(this.deadLightCoords[0]),t}}class $m extends class u6t{getGroupDatas(t,e){X(l8.VERBOSE,"GroupDatas.getGroupDatas("+t+", "+e+")");const s=this.getNewInstance(e[t.y][t.x]);return this._getGroupDatas(t,e,s)}_getGroupDatas(t,e,r){X(l8.VERBOSE,{GroupDatas_getGroupDatas:{groupDatas:r,coord:t}});const s=e[t.y][t.x];if(r.addPawn(t,s),s===r.color)for(const i of this.getDirections()){const o=t.getNext(i);o.isInRange(e[0].length,e.length)&&(r.contains(o)||(r=this._getGroupDatas(o,e,r)))}return r}}{getNewInstance(t){return new f6t(t,[],[],[],[],[])}getDirections(){return Fe.ORTHOGONALS}}let Um=(()=>{class n{}return n.ILLEGAL_KO=()=>$localize`This move is a ko, you must play somewhere else before you can play in this intersection again.`,n.CANNOT_PASS_AFTER_PASSED_PHASE=()=>$localize`We are in the counting phase, you must mark stones as dead or alive or accept the current board by passing your turn.`,n.CANNOT_ACCEPT_BEFORE_COUNTING_PHASE=()=>$localize`You cannot accept before the counting phase.`,n.OCCUPIED_INTERSECTION=()=>$localize`This intersection is already occupied.`,n.CANNOT_COMMIT_SUICIDE=()=>$localize`You cannot commit suicide.`,n})(),V3=(()=>{class n extends U1{static isLegal(e,r){if(X(n.VERBOSE||!1,{isLegal:{move:e,state:r}}),n.isPass(e)){const i=r.phase===Hn.PLAYING,o=r.phase===Hn.PASSED;return X(n.VERBOSE||!1,"GoRules.isLegal at "+r.phase+(i||o?" forbid":" allowed")+" passing on "+r.getCopiedBoard()),i||o?U.success([]):U.failure(Um.CANNOT_PASS_AFTER_PASSED_PHASE())}if(n.isAccept(e)){const o=r.phase===Hn.ACCEPT;return r.phase===Hn.COUNTING||o?U.success([]):U.failure(Um.CANNOT_ACCEPT_BEFORE_COUNTING_PHASE())}return n.isOccupied(e.coord,r.getCopiedBoard())?(X(n.VERBOSE||!1,"GoRules.isLegal: move is marking"),n.isLegalDeadMarking(e,r)?U.success([]):U.failure(Um.OCCUPIED_INTERSECTION())):(X(n.VERBOSE||!1,"GoRules.isLegal: move is normal stuff: "+e.toString()),n.isLegalNormalMove(e,r))}static getNewKo(e,r,s){if(1===s.length){const i=s[0],o=e.coord,c=r[o.y][o.x],h=(new $m).getGroupDatas(o,r),p=h.emptyCoords,m=Ue.pieceBelongTo(c,z.ZERO)?h.darkCoords:h.lightCoords;if(1===p.length&&p[0].equals(i)&&1===m.length)return P.of(i)}return P.empty()}static markTerritoryAndCount(e){X(n.VERBOSE,{markTerritoryAndCount:{state:e}});const r=e.getCopiedBoard(),s=n.getTerritoryLikeGroup(e),i=e.getCapturedCopy();for(const o of s){const c=o.getWrapper();if(c===Ue.LIGHT){i[1]+=o.emptyCoords.length;for(const u of o.getCoords())r[u.y][u.x]=Ue.LIGHT_TERRITORY}else{ve(c===Ue.DARK,"territory should be wrapped by dark or light, not by "+c.toString()),i[0]+=o.emptyCoords.length;for(const u of o.getCoords())r[u.y][u.x]=Ue.DARK_TERRITORY}}return new xs(r,i,e.turn,e.koCoord,e.phase)}static removeAndSubstractTerritory(e){const r=e.getCopiedBoard(),s=e.getCapturedCopy();let i;for(let o=0;o<e.board.length;o++)for(let c=0;c<e.board[0].length;c++)i=r[o][c],i===Ue.DARK_TERRITORY?(r[o][c]=Ue.EMPTY,s[0]=s[0]-1):i===Ue.LIGHT_TERRITORY&&(r[o][c]=Ue.EMPTY,s[1]=s[1]-1);return new xs(r,s,e.turn,e.koCoord,e.phase)}static getEmptyZones(e){return n.getGroupsDatasWhere(e.getCopiedBoard(),r=>r.isEmpty())}static getGroupsDatasWhere(e,r){const s=[];let i,o,c;const u=new $m;for(let h=0;h<e.length;h++)for(let p=0;p<e[0].length;p++)i=new M(p,h),c=e[h][p],r(c)&&(s.some(m=>m.selfContains(i))||(o=u.getGroupDatas(i,e),s.push(o)));return s}static addDeadToScore(e){const r=e.getCapturedCopy();let o,s=r[1],i=r[0];for(let c=0;c<e.board.length;c++)for(let u=0;u<e.board[0].length;u++)o=e.getPieceAtXY(u,c),o===Ue.DEAD_DARK?s++:o===Ue.DEAD_LIGHT&&i++;return[i,s]}static switchAliveness(e,r){const s=r.getCopiedBoard();ve(s[e.y][e.x].isOccupied(),"Can't switch emptyness aliveness");const c=(new $m).getGroupDatas(e,s),u=r.getCapturedCopy();switch(c.color){case Ue.DEAD_DARK:u[1]-=2*c.deadDarkCoords.length;for(const h of c.deadDarkCoords)s[h.y][h.x]=Ue.DARK;break;case Ue.DEAD_LIGHT:u[0]-=2*c.deadLightCoords.length;for(const h of c.deadLightCoords)s[h.y][h.x]=Ue.LIGHT;break;case Ue.LIGHT:u[0]+=2*c.lightCoords.length;for(const h of c.lightCoords)s[h.y][h.x]=Ue.DEAD_LIGHT;break;default:Me.expectToBe(c.color,Ue.DARK),u[1]+=2*c.darkCoords.length;for(const h of c.darkCoords)s[h.y][h.x]=Ue.DEAD_DARK}return new xs(s,u,r.turn,r.koCoord,r.phase)}static getGameStatus(e){const r=e.gameState;return r.phase===Hn.FINISHED?r.captured[0]>r.captured[1]?xe.ZERO_WON:r.captured[1]>r.captured[0]?xe.ONE_WON:xe.DRAW:xe.ONGOING}static isPass(e){return e.equals(J1.PASS)}static isAccept(e){return e.equals(J1.ACCEPT)}static isLegalDeadMarking(e,r){return n.isOccupied(e.coord,r.getCopiedBoard())&&(r.phase===Hn.COUNTING||r.phase===Hn.ACCEPT)}static isLegalNormalMove(e,r){const s=r.getCopiedBoard();if(n.isKo(e,r))return U.failure(Um.ILLEGAL_KO());[Hn.COUNTING,Hn.ACCEPT].includes(r.phase)&&(r=n.resurrectStones(r));const i=n.getCaptureState(e,r);if(u3e.isCapturing(i))return U.success(i.capturedCoords);{s[e.coord.y][e.coord.x]=r.turn%2==0?Ue.DARK:Ue.LIGHT;const u=0===(new $m).getGroupDatas(e.coord,s).emptyCoords.length;return s[e.coord.y][e.coord.x]=Ue.EMPTY,u?U.failure(Um.CANNOT_COMMIT_SUICIDE()):U.success([])}}static isOccupied(e,r){return r[e.y][e.x].isOccupied()}static isKo(e,r){return!!r.koCoord.isPresent()&&e.coord.equals(r.koCoord.get())}static getCaptureState(e,r){X(n.VERBOSE||!1,{getCaptureState:{move:e,state:r}});const i=new u3e;let o;for(const c of Fe.ORTHOGONALS)o=n.getCapturedInDirection(e.coord,c,r),o.length>0&&i.capturedCoords.every(u=>!o[0].equals(u))&&(i.capturedCoords=i.capturedCoords.concat(o));return i}static getCapturedInDirection(e,r,s){const o=s.getCopiedBoard(),c=e.getNext(r);if(c.isInRange(s.board[0].length,s.board.length)&&o[c.y][c.x]===(s.turn%2==0?Ue.LIGHT:Ue.DARK)){X(n.VERBOSE||!1,"a group could be captured");const p=(new $m).getGroupDatas(c,o);if(n.isCapturableGroup(p,s.koCoord))return X(n.VERBOSE||!1,{neightbooringGroupCoord:p.getCoords(),message:"is capturable"}),p.getCoords()}return[]}static isCapturableGroup(e,r){return!(!e.color.isOccupied()||1!==e.emptyCoords.length)&&!1===r.equalsValue(e.emptyCoords[0])}static getTerritoryLikeGroup(e){return n.getEmptyZones(e).filter(s=>s.isMonoWrapped())}static applyPass(e){const r=e.getCopiedBoard(),s=e.getCapturedCopy(),i=e.turn;let o,c;return e.phase===Hn.PASSED?(o=Hn.COUNTING,c=new xs(r,s,i+1,P.empty(),o),c=n.markTerritoryAndCount(c)):(ve(e.phase===Hn.PLAYING,"Cannot pass in counting phase!"),o=Hn.PASSED,c=new xs(r,s,i+1,P.empty(),o)),c}static applyLegalAccept(e){const r=e.getCopiedBoard();let s;return s=e.phase===Hn.COUNTING?Hn.ACCEPT:Hn.FINISHED,new xs(r,e.getCapturedCopy(),e.turn+1,P.empty(),s)}static applyNormalLegalMove(e,r,s){let i;X(n.VERBOSE,{applyNormalLegal:{currentState:r,legalMove:e,status}}),i=[Hn.COUNTING,Hn.ACCEPT].includes(r.phase)?n.resurrectStones(r):r.copy();const o=e.coord.x,c=e.coord.y,u=i.getCopiedBoard(),h=i.turn,p=Ue.ofPlayer(i.getCurrentPlayer()),m=h+1;u[c][o]=p;for(const I of s)u[I.y][I.x]=Ue.EMPTY;const C=n.getNewKo(e,u,s),w=i.getCapturedCopy();return w[p.player.value]+=s.length,new xs(u,w,m,C,Hn.PLAYING)}static resurrectStones(e){for(let r=0;r<e.board.length;r++)for(let s=0;s<e.board[0].length;s++)e.getPieceAtXY(s,r).isDead()&&(e=n.switchAliveness(new M(s,r),e));return n.removeAndSubstractTerritory(e)}static applyDeadMarkingMove(e,r){X(n.VERBOSE,{applyDeadMarkingMove:{legalMove:e,state:r}});const s=n.removeAndSubstractTerritory(r),i=n.switchAliveness(e.coord,s),o=new xs(i.getCopiedBoard(),i.getCapturedCopy(),i.turn+1,P.empty(),Hn.COUNTING);return n.markTerritoryAndCount(o)}isLegal(e,r){return n.isLegal(e,r)}applyLegalMove(e,r,s){return X(n.VERBOSE,{applyLegalMove:{legalMove:e,state:r,status:s}}),n.isPass(e)?(X(n.VERBOSE,"GoRules.applyLegalMove: isPass"),n.applyPass(r)):n.isAccept(e)?(X(n.VERBOSE,"GoRules.applyLegalMove: isAccept"),n.applyLegalAccept(r)):n.isLegalDeadMarking(e,r)?(X(n.VERBOSE,"GoRules.applyLegalMove: isDeadMarking"),n.applyDeadMarkingMove(e,r)):(X(n.VERBOSE,"GoRules.applyLegalMove: else it is normal move"),n.applyNormalLegalMove(e,r,s))}getGameStatus(e){return n.getGameStatus(e)}}return n.VERBOSE=!1,n})();class u3e{constructor(){this.capturedCoords=[]}static isCapturing(t){return t.capturedCoords.length>0}}class h6t extends G1{getListMoves(t){X(V3.VERBOSE||!1,"GoRules.getListMoves");const r=t.gameState,s=this.getPlayingMovesList(r);if(r.phase===Hn.PLAYING||r.phase===Hn.PASSED)return s.push(J1.PASS),s;{X(V3.VERBOSE||!1,"GoRules.getListMoves in counting phase");const i=this.getCountingMovesList(r);return 0===i.length?[J1.ACCEPT]:i}}getPlayingMovesList(t){const e=[];let r;for(let s=0;s<t.board.length;s++)for(let i=0;i<t.board[0].length;i++)r=new J1(i,s),t.getPieceAt(r.coord)===Ue.EMPTY&&V3.isLegal(r,t).isSuccess()&&e.push(r);return e}getCountingMovesList(t){const e=[],r=this.getCorrectBoard(t).getCopiedBoard(),s=V3.getGroupsDatasWhere(r,i=>i!==Ue.EMPTY);for(const i of s){const o=i.getCoords()[0],c=r[o.y][o.x];if(t.getPieceAt(o)!==c){const h=new J1(o.x,o.y);return e.push(h),e}}return e}getCorrectBoard(t){const r=this.mapBoard(t.getCopiedBoard(),o=>o===Ue.DARK?Ue.DEAD_DARK:o===Ue.LIGHT?Ue.DEAD_LIGHT:o.isTerritory()?Ue.EMPTY:o),s=new xs(r,t.getCapturedCopy(),t.turn,t.koCoord,t.phase),i=V3.getTerritoryLikeGroup(s);return this.setAliveUniqueWrapper(s,i)}mapBoard(t,e){const r=[];for(let s=0;s<t.length;s++){r[s]=[];for(let i=0;i<t[0].length;i++)r[s][i]=e(t[s][i])}return r}setAliveUniqueWrapper(t,e){let s,r=t.copy();for(const i of e){s=i.deadDarkCoords.concat(i.deadLightCoords);for(const o of s)r.isDead(o)&&(r=V3.switchAliveness(o,r))}return r}getBoardValue(t){const e=t.gameState,r=V3.getGameStatus(t);if(r.isEndGame)return r.toBoardValue();X(V3.VERBOSE||!1,"GoRules.getBoardValue");const i=V3.markTerritoryAndCount(e),o=i.getCapturedCopy(),c=this.getDeadStones(i);return new Ct(o[1]+2*c[0]-(o[0]+2*c[1]))}getDeadStones(t){const e=[0,0];for(let r=0;r<t.board.length;r++)for(let s=0;s<t.board[0].length;s++){const i=t.getPieceAtXY(s,r);"dead"===i.type&&(e[i.player.value]=e[i.player.value]+1)}return e}}function d6t(n,t){if(1&n&&(F(),Q(0,"circle",10)),2&n){const e=v(2).index,r=v().index,s=v();D("cx",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*e)("cy",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*r)("r",.22*s.SPACE_SIZE)}}function p6t(n,t){if(1&n){const e=Oe();F(),b(0,"line",11),ee("click",function(){he(e);const s=v(2).index,i=v().index;return le(v().onClick(s,i))}),O()}if(2&n){const e=v(2).index,r=v().index,s=v();D("x1",.5*s.SPACE_SIZE*e)("y1",.5*s.SPACE_SIZE*r)("x2",.5*s.SPACE_SIZE+.5*s.SPACE_SIZE*e)("y2",.5*s.SPACE_SIZE+.5*s.SPACE_SIZE*r)}}function g6t(n,t){if(1&n){const e=Oe();F(),b(0,"g")(1,"circle",7),ee("click",function(){he(e);const s=v().index,i=v().index;return le(v().onClick(s,i))}),O(),x(2,d6t,1,3,"circle",8),x(3,p6t,1,4,"line",9),O()}if(2&n){const e=v().index,r=v().index,s=v();S(1),T("ngClass",s.getSpaceClass(e,r)),D("cx",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*e)("cy",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*r)("r",.22*s.SPACE_SIZE),S(1),T("ngIf",s.isLastSpace(e,r)),S(1),T("ngIf",s.isDead(e,r))}}function m6t(n,t){if(1&n){const e=Oe();F(),b(0,"circle",15),ee("click",function(){he(e);const s=v(2).index,i=v().index;return le(v().onClick(s,i))}),O()}if(2&n){const e=v(2),r=e.index,s=e.$implicit,i=v().index,o=v();D("cx",.25*o.SPACE_SIZE+.5*o.SPACE_SIZE*r)("cy",.25*o.SPACE_SIZE+.5*o.SPACE_SIZE*i)("r",.1*o.SPACE_SIZE)("class",s===o.GoPiece.LIGHT_TERRITORY?"player1-fill":"player0-fill")}}function _6t(n,t){if(1&n){const e=Oe();F(),b(0,"rect",12),ee("click",function(){he(e);const s=v().index,i=v().index;return le(v().onClick(s,i))}),O(),b(1,"line",13),ee("click",function(){he(e);const s=v().index,i=v().index;return le(v().onClick(s,i))}),O(),b(2,"line",13),ee("click",function(){he(e);const s=v().index,i=v().index;return le(v().onClick(s,i))}),O(),x(3,m6t,1,4,"circle",14)}if(2&n){const e=v().index,r=v().index,s=v();We("id","click_",e,"_",r,""),D("width",.5*s.SPACE_SIZE)("height",.5*s.SPACE_SIZE)("x",.5*s.SPACE_SIZE*e)("y",.5*s.SPACE_SIZE*r),S(1),D("x1",.5*s.SPACE_SIZE*e)("y1",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*r)("x2",.5*s.SPACE_SIZE+.5*s.SPACE_SIZE*e)("y2",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*r),S(1),D("x1",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*e)("y1",.5*s.SPACE_SIZE*r)("x2",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*e)("y2",.5*s.SPACE_SIZE+.5*s.SPACE_SIZE*r),S(1),T("ngIf",s.isTerritory(e,r))}}function v6t(n,t){if(1&n&&(F(),b(0,"g"),x(1,g6t,4,6,"g",5),x(2,_6t,4,15,"ng-template",null,6,r1),O()),2&n){const e=t.index,r=Qn(3),s=v().index,i=v();S(1),T("ngIf",i.spaceIsFull(e,s))("ngIfElse",r)}}function C6t(n,t){if(1&n&&(F(),b(0,"g"),x(1,v6t,4,2,"g",2),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e)}}function y6t(n,t){if(1&n&&(F(),Q(0,"rect",16)),2&n){const e=v();D("width",.25*e.SPACE_SIZE)("height",.25*e.SPACE_SIZE)("x",.125*e.SPACE_SIZE+.5*e.SPACE_SIZE*e.ko.get().x)("y",.125*e.SPACE_SIZE+.5*e.SPACE_SIZE*e.ko.get().y)}}function E6t(n,t){if(1&n){const e=Oe();F(),b(0,"circle",17),ee("click",function(){const i=he(e).$implicit;return le(v().onClick(i.x,i.y))}),O()}if(2&n){const e=t.$implicit,r=v();D("cx",.25*r.SPACE_SIZE+.5*r.SPACE_SIZE*e.x)("cy",.25*r.SPACE_SIZE+.5*r.SPACE_SIZE*e.y)("r",.07*r.SPACE_SIZE)}}let M6t=(()=>{class n extends to{constructor(e){super(e),this.ko=P.empty(),this.last=P.empty(),this.captures=[],this.GoPiece=Ue,this.scores=P.of([0,0]),this.rules=new V3(xs),this.availableMinimaxes=[new h6t(this.rules,"GoMinimax")],this.encoder=J1.encoder,this.tutorial=(new c3e).tutorial,this.canPass=!0,this.updateBoard()}onClick(e,r){var s=this;return A(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());s.last=P.empty();const o=new J1(e,r);return s.chooseMove(o,s.getState(),s.scores.get())})()}updateBoard(){X(n.VERBOSE,"updateBoard");const e=this.getState(),r=this.rules.node.move,s=e.phase;this.board=e.getCopiedBoard(),this.scores=P.of(e.getCapturedCopy()),this.ko=e.koCoord,r.isPresent()?this.showCaptures():this.captures=[],this.last=r.map(i=>i.coord),this.canPass=s!==Hn.FINISHED}showCaptures(){const e=this.rules.node.mother.get().gameState;this.captures=[];for(let r=0;r<this.board.length;r++)for(let s=0;s<this.board[0].length;s++){const i=new M(s,r),o=e.getPieceAt(i).isOccupied(),c=this.board[r][s]===Ue.EMPTY,u=!1===this.ko.equalsValue(i);o&&c&&u&&this.captures.push(i)}}pass(){var e=this;return A(function*(){const r=e.getState().phase;return r===Hn.PLAYING||r===Hn.PASSED?e.onClick(J1.PASS.coord.x,J1.PASS.coord.y):(ve(r===Hn.COUNTING||r===Hn.ACCEPT,"GoComponent: pass() must be called only in playing, passed, counting, or accept phases"),e.onClick(J1.ACCEPT.coord.x,J1.ACCEPT.coord.y))})()}getSpaceClass(e,r){const s=this.getState().getPieceAtXY(e,r);return this.getPlayerClass(s.getOwner())}spaceIsFull(e,r){return this.getState().getPieceAtXY(e,r)!==Ue.EMPTY&&!this.isTerritory(e,r)}isLastSpace(e,r){if(this.last.isPresent()){const s=this.last.get();return e===s.x&&r===s.y}return!1}isDead(e,r){return this.getState().isDead(new M(e,r))}isTerritory(e,r){return this.getState().isTerritory(new M(e,r))}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(J(Pn))},n.\u0275cmp=gt({type:n,selectors:[["app-go"]],features:[l],decls:5,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["x","0","y","0",1,"base","mid-small-stroke"],[4,"ngFor","ngForOf"],["class","captured-stroke mid-stroke no-fill",4,"ngIf"],["class","captured-fill",3,"click",4,"ngFor","ngForOf"],[4,"ngIf","ngIfElse"],["empty",""],[1,"base","mid-stroke",3,"ngClass","click"],["class","base no-fill mid-stroke last-move-stroke",4,"ngIf"],["class","base no-fill captured-stroke",3,"click",4,"ngIf"],[1,"base","no-fill","mid-stroke","last-move-stroke"],[1,"base","no-fill","captured-stroke",3,"click"],["fill-opacity","0",1,"base","no-stroke",3,"id","click"],[1,"base","mid-stroke",3,"click"],[3,"click",4,"ngIf"],[3,"click"],[1,"captured-stroke","mid-stroke","no-fill"],[1,"captured-fill",3,"click"]],template:function(e,r){1&e&&(F(),b(0,"svg",0),Q(1,"rect",1),x(2,C6t,2,1,"g",2),x(3,y6t,1,4,"rect",3),x(4,E6t,1,3,"circle",4),O()),2&e&&(D("viewBox","0 -3 "+r.board.length*r.SPACE_SIZE*.5+" "+(6+r.board.length*r.SPACE_SIZE*.5)),S(1),D("width",r.board.length*r.SPACE_SIZE*.5)("height",r.board.length*r.SPACE_SIZE*.5),S(1),T("ngForOf",r.board),S(1),T("ngIf",r.ko.isPresent()),S(1),T("ngForOf",r.captures))},dependencies:[dn,An,en],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class f6{constructor(t,e,r,s){this.left=t,this.up=e,this.width=r,this.height=s}static fromLimits(t,e,r,s){return new f6(t,r,e-t,s-r)}static fromHexa(t,e,r){const s=t.flatMap(p=>e.getHexaPointsListAt(p)),i=f6.getLimits(s);return new f6(i.minX-r/2,i.minY-r/2,r+i.maxX-i.minX,r+i.maxY-i.minY)}static getLimits(t){let e=Number.MIN_SAFE_INTEGER,r=Number.MIN_SAFE_INTEGER,s=Number.MAX_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER;for(const o of t)s=Math.min(s,o.x),i=Math.min(i,o.y),e=Math.max(e,o.x),r=Math.max(r,o.y);return{minX:s,minY:i,maxX:e,maxY:r}}center(){return new M(this.left+this.width/2,this.up+this.height/2)}bottom(){return this.up+this.height}right(){return this.left+this.width}expand(t,e,r,s){return new f6(this.left-t,this.up-r,this.width+t+e,this.height+r+s)}containingAtLeast(t){const e=Math.min(this.left,t.left),r=Math.max(this.right(),t.right()),s=Math.min(this.up,t.up),i=Math.max(this.bottom(),t.bottom());return f6.fromLimits(e,r,s,i)}toSVGString(){return`${this.left} ${this.up} ${this.width} ${this.height}`}}let ns=(()=>{class n{}return n.CANNOT_DROP_PIECE_YOU_DONT_HAVE=()=>"You cannot drop a piece that you do not have in your reserve.",n.QUEEN_BEE_CAN_ONLY_MOVE_TO_DIRECT_NEIGHBORS=()=>$localize`The queen bee can only move to one of its direct neighbors.`,n.BEETLE_CAN_ONLY_MOVE_TO_DIRECT_NEIGHBORS=()=>$localize`The beetle can only move to one of its direct neighbors.`,n.GRASSHOPPER_MUST_MOVE_IN_STRAIGHT_LINE=()=>$localize`The grasshopper must move in a straight line.`,n.GRASSHOPPER_MUST_JUMP_OVER_PIECES=()=>$localize`The grasshopper must jump over other pieces, without any empty spaces.`,n.SPIDER_MUST_MOVE_ON_NEIGHBORING_SPACES=()=>$localize`The spider must move on neighboring spaces.`,n.SPIDER_CAN_ONLY_MOVE_WITH_DIRECT_CONTACT=()=>$localize`The spider can only move around pieces that are in direct contact with it.`,n.SPIDER_CANNOT_BACKTRACK=()=>$localize`The spider cannot go twice through the same space in the same move.`,n.QUEEN_BEE_MUST_BE_ON_BOARD_BEFORE_MOVE=()=>$localize`The queen bee must be placed on the board before moving a piece.`,n.THIS_PIECE_CANNOT_CLIMB=()=>$localize`Only the beetle is allowed to climb over other pieces.`,n.CANNOT_DISCONNECT_HIVE=()=>$localize`You are not allowed to split the hive.`,n.MUST_BE_ABLE_TO_SLIDE=()=>$localize`This piece must be able to slide to its destination.`,n.MUST_PLACE_QUEEN_BEE_LATEST_AT_FOURTH_TURN=()=>$localize`You must place your queen bee at this turn!`,n.CANNOT_DROP_NEXT_TO_OPPONENT=()=>$localize`You cannot drop a piece next to one of your opponent's stack.`,n.MUST_DROP_ON_EMPTY_SPACE=()=>$localize`You must always drop your piece on an empty space.`,n.MUST_BE_CONNECTED_TO_HIVE=()=>$localize`The piece you are dropping must be connected to the hive.`,n})();class Qs{constructor(t,e){this.owner=t,this.kind=e}toString(){return`${this.kind}_${this.owner.toString()}`}equals(t){return this.owner===t.owner&&this.kind===t.kind}}Qs.encoder=new class extends k4{encode(n){return{owner:n.owner.value,kind:n.kind}}decode(n){ve(null!==Me.getNonNullable(n).kind,"invalid encoded HivePiece"),ve(null!==Me.getNonNullable(n).owner,"invalid encoded HivePiece");const t=Me.getNonNullable(n).kind,e=z.of(Me.getNonNullable(n).owner);return new Qs(e,t)}};class H4{constructor(t){this.pieces=t}equals(t){return this.size()===t.size()&&Ke.compareArray(this.pieces,t.pieces)}isEmpty(){return 0===this.pieces.length}hasPieces(){return!1===this.isEmpty()}add(t){return new H4([t,...this.pieces])}topPiece(){return Me.assert(this.hasPieces(),"HivePieceStack: cannot get top piece of an empty stack"),this.pieces[0]}removeTopPiece(){const t=[...this.pieces];return t.shift(),new H4(t)}size(){return this.pieces.length}}H4.EMPTY=new H4([]);class Ja extends xc{constructor(t,e,r){super(e,r),this.piece=t}static from(t,e){return new Ja(t,e.x,e.y)}toString(){return`HiveDrop(${this.piece.toString()}, ${this.coord.toString()})`}equals(t){return t instanceof Ja&&this.piece.equals(t.piece)&&this.coord.equals(t.coord)}}Ja.encoder=mi.tuple([Qs.encoder,M.encoder],n=>[n.piece,n.coord],n=>new Ja(n[0],n[1].x,n[1].y));class x2 extends r8{constructor(t,e){super(t,e)}static from(t,e){return t.equals(e)?U.failure(tt.MOVE_CANNOT_BE_STATIC()):U.success(new x2(t,e))}toString(){return`HiveMoveCoordToCoord(${this.getStart().toString()} -> ${this.getEnd().toString()})`}equals(t){return!(t instanceof Uc)&&t instanceof x2&&this.getStart().equals(t.getStart())&&this.getEnd().equals(t.getEnd())}}x2.encoder=Lc.getEncoder(x2.from);class Uc extends x2{constructor(t){super(t[0],t[3]),this.coords=t}static fromCoords(t){return new Uc(t)}toString(){return`HiveMoveSpider(${this.coords.map(e=>e.toString()).join(", ")})`}equals(t){return t instanceof Uc&&this.getStart().equals(t.getStart())&&this.getEnd().equals(t.getEnd())}}Uc.encoder=mi.tuple([M.encoder,M.encoder,M.encoder,M.encoder],n=>n.coords,n=>new Uc(n));class IH extends Gi{toString(){return"HiveMovePass"}equals(t){return t instanceof IH}}var Si;!function(n){n.PASS=new IH,n.drop=function t(s,i){return Ja.from(s,i)},n.move=function e(s,i){return x2.from(s,i)},n.spiderMove=function r(s){return Uc.fromCoords(s)},n.encoder=new class extends mi{encodeMove(s){return s instanceof Ja?{moveType:"Drop",encoded:Ja.encoder.encode(s)}:s instanceof Uc?{moveType:"Spider",encoded:Uc.encoder.encode(s)}:s instanceof x2?{moveType:"CoordToCoord",encoded:x2.encoder.encode(s)}:{moveType:"Pass"}}decodeMove(s){const i=Me.getNonNullable(s).moveType,o=Me.getNonNullable(s).encoded;return"Drop"===i?Ja.encoder.decode(o):"Spider"===i?Uc.encoder.decode(o):"CoordToCoord"===i?x2.encoder.decode(o):n.PASS}}}(Si||(Si={}));class Gc{static from(t){return Gc.INSTANCES.isAbsent()&&(Gc.INSTANCES=P.of({QueenBee:PP.get(),Beetle:TP.get(),Grasshopper:wP.get(),Spider:Gm.get(),SoldierAnt:bP.get()})),Gc.INSTANCES.get()[t.kind]}checkEmptyDestination(t,e){return e.getAt(t.getEnd()).hasPieces()?U.failure(ns.THIS_PIECE_CANNOT_CLIMB()):U.success(void 0)}canSlideBetweenNeighbors(t,e,r){const s=new Dt(I2.getNeighbors(e)),i=new Dt(I2.getNeighbors(r)),o=s.intersection(i);for(const c of o)if(t.getAt(c).isEmpty())return!0;return!1}}Gc.INSTANCES=P.empty();class PP extends Gc{static get(){return this.INSTANCE.isAbsent()&&(this.INSTANCE=P.of(new PP)),this.INSTANCE.get()}moveValidity(t,e){return!1===I2.areNeighbors(t.getStart(),t.getEnd())?U.failure(ns.QUEEN_BEE_CAN_ONLY_MOVE_TO_DIRECT_NEIGHBORS()):!1===this.canSlideBetweenNeighbors(e,t.getStart(),t.getEnd())?U.failure(ns.MUST_BE_ABLE_TO_SLIDE()):this.checkEmptyDestination(t,e)}getPotentialMoves(t,e){const r=[];for(const s of I2.getNeighbors(t))e.getAt(s).isEmpty()&&r.push(x2.from(t,s).get());return r}}PP.INSTANCE=P.empty();class TP extends Gc{static get(){return this.INSTANCE.isAbsent()&&(this.INSTANCE=P.of(new TP)),this.INSTANCE.get()}moveValidity(t,e){return!1===I2.areNeighbors(t.getStart(),t.getEnd())?U.failure(ns.BEETLE_CAN_ONLY_MOVE_TO_DIRECT_NEIGHBORS()):U.success(void 0)}getPotentialMoves(t,e){const r=[];for(const s of I2.getNeighbors(t))r.push(x2.from(t,s).get());return r}}TP.INSTANCE=P.empty();class wP extends Gc{static get(){return this.INSTANCE.isAbsent()&&(this.INSTANCE=P.of(new wP)),this.INSTANCE.get()}moveValidity(t,e){if(Le.factory.fromMove(t.getStart(),t.getEnd()).isFailure())return U.failure(ns.GRASSHOPPER_MUST_MOVE_IN_STRAIGHT_LINE());const s=t.getStart().getCoordsToward(t.getEnd());if(0===s.length)return U.failure(ns.GRASSHOPPER_MUST_JUMP_OVER_PIECES());for(const i of s)if(e.getAt(i).isEmpty())return U.failure(ns.GRASSHOPPER_MUST_JUMP_OVER_PIECES());return this.checkEmptyDestination(t,e)}getPotentialMoves(t,e){const r=[];for(const s of Le.factory.all){const i=t.getNext(s);if(e.getAt(i).hasPieces()){let o=i;for(;e.getAt(o).hasPieces();)o=o.getNext(s);r.push(x2.from(t,o).get())}}return r}}wP.INSTANCE=P.empty();class Gm extends Gc{static get(){return this.INSTANCE.isAbsent()&&(this.INSTANCE=P.of(new Gm)),this.INSTANCE.get()}prefixLegality(t,e){const r=new Dt,s=e.update().setAt(t[0],H4.EMPTY).increaseTurnAndFinalizeUpdate();t=t.map(i=>i.getNext(s.offset));for(let i=1;i<t.length;i++){if(s.getAt(t[i]).hasPieces())return U.failure(ns.THIS_PIECE_CANNOT_CLIMB());if(!1===I2.areNeighbors(t[i-1],t[i]))return U.failure(ns.SPIDER_MUST_MOVE_ON_NEIGHBORING_SPACES());if(!1===s.haveCommonNeighbor(t[i],t[i-1]))return U.failure(ns.SPIDER_CAN_ONLY_MOVE_WITH_DIRECT_CONTACT());if(!1===this.canSlideBetweenNeighbors(s,t[i-1],t[i]))return U.failure(ns.MUST_BE_ABLE_TO_SLIDE());if(r.contains(t[i]))return U.failure(ns.SPIDER_CANNOT_BACKTRACK());r.add(t[i])}return U.success(void 0)}moveValidity(t,e){Me.assert(t instanceof Uc,"HiveSpiderRules: move should be a spider move");const s=this.prefixLegality(t.coords,e);return s.isFailure()?s:this.checkEmptyDestination(t,e)}getPotentialMoves(t,e){const r=e.update().setAt(t,H4.EMPTY).increaseTurnAndFinalizeUpdate();let s=[[t=t.getNext(r.offset)]];for(let c=0;c<3;c++)s=s.flatMap(u=>this.nextMoveStep(r,u));return new Dt(s.map(function i(c){return c=c.map(u=>u.getPrevious(r.offset)),Uc.fromCoords(c)})).toList()}nextMoveStep(t,e){const r=e[e.length-1];return new Dt(I2.getNeighbors(r)).filter(function s(o){return!t.getAt(o).hasPieces()&&void 0===e.find(c=>o.equals(c))&&t.haveCommonNeighbor(o,r)}).toList().map(o=>[...e,o])}}Gm.INSTANCE=P.empty();class bP extends Gc{static get(){return this.INSTANCE.isAbsent()&&(this.INSTANCE=P.of(new bP)),this.INSTANCE.get()}pathExists(t,e,r){const s=new Dt,i=[e];for(;i.length>0;){const o=i.pop();if(!s.contains(o)){if(s.add(o),o.equals(r))return!0;for(const c of I2.getNeighbors(o)){const u=t.getAt(c).isEmpty(),h=t.getOccupiedNeighbors(c).size()>0,p=this.canSlideBetweenNeighbors(t,o,c);u&&h&&p&&i.push(c)}}}return!1}moveValidity(t,e){return!1===this.pathExists(e,t.getStart(),t.getEnd())?U.failure(ns.MUST_BE_ABLE_TO_SLIDE()):this.checkEmptyDestination(t,e)}getPotentialMoves(t,e){const r=new Dt;for(const s of e.occupiedSpaces())if(!s.equals(t))for(const i of e.emptyNeighbors(s))r.add(x2.from(t,i).get());return r.toList()}}bP.INSTANCE=P.empty();class f3e extends fP{constructor(t,e,r){super(e),this.pieces=t;const s=this.computeScale();this.pieces=s.pieces,this.width=s.width,this.height=s.height,this.offset=r??s.offset,this.pieces.makeImmutable()}getPieces(){return this.pieces}getPieceCoords(){return this.pieces.listKeys()}computeScale(){let t=Number.MAX_SAFE_INTEGER,e=Number.MIN_SAFE_INTEGER,r=Number.MAX_SAFE_INTEGER,s=Number.MIN_SAFE_INTEGER;for(const c of this.pieces.listKeys())t=Math.min(c.x,t),e=Math.max(c.x,e),r=Math.min(c.y,r),s=Math.max(c.y,s);let i=new h9;const o=new Gt(-t,-r);if(0===t&&0===r)i=this.pieces;else for(const c of this.pieces.listKeys()){const u=this.pieces.delete(c),h=c.getNext(o);i.set(h,u)}return{width:e+1-t,height:s+1-r,pieces:i,offset:o}}isOnBoard(t){return this.pieces.containsKey(t)}getOccupiedNeighbors(t){return new Dt(I2.getNeighbors(t)).filter(r=>this.pieces.get(r).isPresent())}getGroups(){const t=new Dt,e=new Dt;return this.pieces.forEach(r=>{if(!1===t.contains(r.key)){const s=new Dt,i=new Dt([r.key]);for(;i.hasElements();){const o=i.getAnyElement().get();i.remove(o),t.add(o),s.add(o),i.addAll(this.getOccupiedNeighbors(o).filter(c=>!1===t.contains(c)))}e.add(s)}}),e}}class OP{constructor(t){this.pieces=t}static getInitial(){const t=new Vn;for(const e of z.PLAYERS)t.set(new Qs(e,"QueenBee"),1),t.set(new Qs(e,"Beetle"),2),t.set(new Qs(e,"Spider"),2),t.set(new Qs(e,"Grasshopper"),3),t.set(new Qs(e,"SoldierAnt"),3);return t.makeImmutable(),new OP(t)}equals(t){return this.pieces.equals(t.pieces)}getQuantity(t){return this.pieces.get(t).get()}hasRemaining(t){return this.getQuantity(t)>0}getAny(t){for(const e of this.pieces.listKeys())if(e.owner===t&&this.hasRemaining(e))return P.of(e);return P.empty()}remove(t){const e=this.pieces.get(t).get();Me.assert(e>0,"HiveRemainingPieces cannot remove a non-remainingPiece");const r=this.pieces.getCopy();return r.replace(t,e-1),new OP(r)}toListOfStacks(){const t=[];return this.pieces.forEach(e=>{const r=[];for(let s=0;s<e.value;s++)r.push(e.key);t.push(new H4(r))}),t}getPlayerPieces(t){const e=[];return this.pieces.forEach(r=>{r.key.owner===t&&r.value>0&&e.push(r.key)}),e}}class Wm{constructor(t,e,r,s){this.pieces=t,this.remainingPieces=e,this.queenBees=r,this.turn=s}static of(t){return new Wm(t.pieces,t.remainingPieces,t.queenBees,t.turn)}setAt(t,e){const r=this.queenBees.getCopy();for(const i of z.PLAYERS)r.get(i).equalsValue(t)&&r.delete(i);for(const i of e.pieces)"QueenBee"===i.kind&&r.put(i.owner,t);const s=this.pieces.getCopy();return e.isEmpty()?s.delete(t):s.put(t,e),new Wm(s,this.remainingPieces,r,this.turn)}removeRemainingPiece(t){return new Wm(this.pieces,this.remainingPieces.remove(t),this.queenBees,this.turn)}increaseTurnAndFinalizeUpdate(){return new k2(this.pieces,this.remainingPieces,this.queenBees,this.turn+1)}}class k2 extends f3e{constructor(t,e,r,s,i){super(t,s,i),this.remainingPieces=e,this.queenBees=r,this.queenBees=r.getCopy();for(const o of r.listKeys()){const u=r.get(o).get().getNext(this.offset);this.queenBees.replace(o,u)}this.queenBees.makeImmutable()}static getInitialState(){return k2.fromRepresentation([],0)}static fromRepresentation(t,e){const r=new h9;let s=OP.getInitial();const i=new Vn;for(let o=0;o<t.length;o++)for(let c=0;c<t[0].length;c++)if(t[o][c].length>0){r.set(new M(c,o),new H4(t[o][c]));const u=P.ofNullable(t[o][c].find(h=>"QueenBee"===h.kind));u.isPresent()&&i.set(u.get().owner,new M(c,o));for(const h of t[o][c])s=s.remove(h)}return new k2(r,s,i,e)}update(){return Wm.of(this)}equals(t){return this.pieces.equals(t.pieces)&&this.remainingPieces.equals(t.remainingPieces)&&this.queenBees.equals(t.queenBees)&&this.turn===t.turn}getAt(t){return this.isOnBoard(t)?this.pieces.get(t).get():H4.EMPTY}queenBeeLocation(t){return this.queenBees.get(t)}hasQueenBeeOnBoard(t){return this.queenBeeLocation(t).isPresent()}numberOfNeighbors(t){let e=0;for(const r of Le.factory.all){const s=t.getNext(r);this.getAt(s).hasPieces()&&(e+=1)}return e}isDisconnected(){return this.getGroups().size()>1}occupiedSpaces(){return this.pieces.listKeys()}emptyNeighbors(t){const e=[];for(const r of I2.getNeighbors(t))this.getAt(r).isEmpty()&&e.push(r);return e}haveCommonNeighbor(t,e){const r=this.getOccupiedNeighbors(t),s=this.getOccupiedNeighbors(e);return r.findAnyCommonElement(s).isPresent()}}class Pi extends U1{constructor(){super(k2)}static get(){return Pi.singleton.isAbsent()&&(Pi.singleton=P.of(new Pi)),Pi.singleton.get()}applyLegalMove(t,e,r){return t instanceof Ja?this.applyLegalDrop(t,e):t instanceof x2?this.applyLegalMoveCoordToCoord(t,e):e.update().increaseTurnAndFinalizeUpdate()}applyLegalDrop(t,e){const r=e.getAt(t.coord);return e.update().setAt(t.coord,r.add(t.piece)).removeRemainingPiece(t.piece).increaseTurnAndFinalizeUpdate()}applyLegalMoveCoordToCoord(t,e){const r=e.getAt(t.getStart()),s=e.getAt(t.getEnd());return e.update().setAt(t.getStart(),r.removeTopPiece()).setAt(t.getEnd(),s.add(r.topPiece())).increaseTurnAndFinalizeUpdate()}isLegal(t,e){return t instanceof Ja?this.isLegalDrop(t,e):t instanceof x2?this.isLegalMoveCoordToCoord(t,e):this.shouldPass(e)?U.success(void 0):U.failure(tt.CANNOT_PASS())}isLegalMoveCoordToCoord(t,e){if(!1===e.queenBeeLocation(e.getCurrentPlayer()).isPresent())return U.failure(ns.QUEEN_BEE_MUST_BE_ON_BOARD_BEFORE_MOVE());const r=e.getAt(t.getStart());if(r.isEmpty())return U.failure(tt.MUST_CHOOSE_PLAYER_PIECE());const s=r.topPiece();if(s.owner===e.getCurrentOpponent())return U.failure(tt.MUST_CHOOSE_PLAYER_PIECE());const i=Gc.from(s).moveValidity(t,e);if(i.isFailure())return i;const o=e.update().setAt(t.getStart(),r.removeTopPiece()).increaseTurnAndFinalizeUpdate();if(o.isDisconnected())return U.failure(ns.CANNOT_DISCONNECT_HIVE());const c=t.getEnd().getNext(o.offset);return 0===o.numberOfNeighbors(c)?U.failure(ns.CANNOT_DISCONNECT_HIVE()):U.success(void 0)}mustPlaceQueenBee(t){return t.turn>=6&&!1===t.hasQueenBeeOnBoard(t.getCurrentPlayer())}isLegalDrop(t,e){const r=e.getCurrentPlayer();if(t.piece.owner===r.getOpponent())return U.failure(tt.MUST_CHOOSE_PLAYER_PIECE());if(!1===e.remainingPieces.hasRemaining(t.piece))return U.failure(ns.CANNOT_DROP_PIECE_YOU_DONT_HAVE());if("QueenBee"!==t.piece.kind&&this.mustPlaceQueenBee(e))return U.failure(ns.MUST_PLACE_QUEEN_BEE_LATEST_AT_FOURTH_TURN());const s=this.checkNeighborValidity(t,e);return s.isFailure()?s:e.getAt(t.coord).hasPieces()?U.failure(ns.MUST_DROP_ON_EMPTY_SPACE()):U.success(void 0)}checkNeighborValidity(t,e){const r=e.getCurrentPlayer();let s=!1;for(const i of I2.getNeighbors(t.coord)){const o=e.getAt(i);if(o.hasPieces()&&(s=!0,1!==e.turn&&o.topPiece().owner===r.getOpponent()))return U.failure(ns.CANNOT_DROP_NEXT_TO_OPPONENT())}return 0!==e.turn&&!1===s?U.failure(ns.MUST_BE_CONNECTED_TO_HIVE()):U.success(void 0)}getPossibleDropLocations(t){const e=t.getCurrentPlayer();if(0===t.turn)return new Dt([new M(0,0)]);if(1===t.turn)return new Dt(I2.getNeighbors(new M(0,0)));const r=t.remainingPieces.getAny(e);if(r.isAbsent())return new Dt;const s=r.get(),i=new Dt;for(const o of t.occupiedSpaces())if(t.getAt(o).topPiece().owner===e)for(const c of t.emptyNeighbors(o)){const u=Ja.from(s,c);this.isLegalDrop(u,t).isSuccess()&&i.add(c)}return i}getPossibleMovesFrom(t,e){const r=t.getCurrentPlayer(),s=new Dt,i=t.getAt(e).topPiece();if(i.owner===r)for(const o of Gc.from(i).getPotentialMoves(e,t))this.isLegalMoveCoordToCoord(o,t).isSuccess()&&s.add(o);return s}getPossibleMovesOnBoard(t){const e=new Dt;for(const r of t.occupiedSpaces())e.addAll(this.getPossibleMovesFrom(t,r));return e}shouldPass(t){return 0===this.getPossibleDropLocations(t).size()&&0===this.getPossibleMovesOnBoard(t).size()}getGameStatus(t){const e=t.gameState,r=[0,0];for(const s of z.PLAYERS){const i=e.queenBeeLocation(s);i.isPresent()&&(r[s.value]=e.numberOfNeighbors(i.get()))}return 6===r[0]&&6===r[1]?xe.DRAW:6===r[0]?xe.getVictory(z.ONE):6===r[1]?xe.getVictory(z.ZERO):xe.ONGOING}}Pi.singleton=P.empty();class P6t extends G1{getListMoves(t){const e=this.getListDrops(t.gameState),r=this.getListOfOnBoardMoves(t.gameState),s=e.concat(r);return 0===s.length?[Si.PASS]:s}getListOfOnBoardMoves(t){return Pi.get().getPossibleMovesOnBoard(t).toList()}getListDrops(t){const e=[],r=t.getCurrentPlayer(),s=new Qs(r,"QueenBee");for(const i of Pi.get().getPossibleDropLocations(t))if(Pi.get().mustPlaceQueenBee(t))e.push(Si.drop(s,i));else for(const o of t.remainingPieces.getPlayerPieces(t.getCurrentPlayer()))e.push(Si.drop(o,i));return e}getBoardValue(t){const e=Pi.get().getGameStatus(t);if(e!==xe.ONGOING)return e.toBoardValue();const r=this.queenBeeMobility(t.gameState,z.ZERO),s=this.queenBeeMobility(t.gameState,z.ONE);return Ct.from(r,s)}queenBeeMobility(t,e){const r=t.queenBeeLocation(e);return r.isPresent()?Pi.get().getPossibleMovesFrom(t,r.get()).size():0}}const F4=new Qs(z.ZERO,"QueenBee"),P5=new Qs(z.ZERO,"Beetle"),O9=new Qs(z.ZERO,"Grasshopper"),NP=new Qs(z.ZERO,"Spider"),AP=new Qs(z.ZERO,"SoldierAnt"),T5=new Qs(z.ONE,"QueenBee"),ec=new Qs(z.ONE,"Beetle"),xH=new Qs(z.ONE,"Grasshopper"),kH=new Qs(z.ONE,"Spider"),qm=new Qs(z.ONE,"SoldierAnt");class h3e extends K1{constructor(){super(...arguments),this.tutorial=[ce.informational($localize`Hive`,$localize`Hive is a game without a board, where pieces are placed on the side of each other, in a contiguous block called the hive. Each player has 11 pieces, representing various insects.`,k2.fromRepresentation([[[T5],[ec],[kH],[O9]],[[O9],[],[AP],[]],[[AP],[],[],[]]],8)),ce.informational($localize`Object of the game`,$localize`The object of the game at Hive is to surround the opponent's queen. Once the queen is surrounded by 6 pieces, no matter the owner of these pieces, the game ends. The player with a queen that is not surrounded wins. In case both queens are fully surrounded at the same turn, it is a draw. Here, Dark won.`,k2.fromRepresentation([[[],[ec],[NP]],[[qm],[T5],[F4]],[[O9],[P5],[]]],7)),ce.anyMove($localize`Placing the first and second piece`,$localize`There are two types of actions: drops and moves. Initially, the board is empty, so we will have to put (drop) pieces on the board. For the first piece dropped on the board, there is no placement restriction: you can choose any piece and put in on the board. The second piece, put by Light, will need to be put in a neighboring space of the first piece. To drop a piece on the board, select the piece of your choice in your remaining pieces (below the board), and then click on the space you want to drop it on.<br/><br/>You're playing Dark and starting the game, put any piece on the board.`,k2.getInitialState(),Si.drop(P5,new M(0,0)),$localize`Congratulations!`),ce.anyMove($localize`Placing pieces after the second turn`,$localize`After the second turn, you are still allowed to place pieces any time you want, as long as you respect two conditions: <ol><li>your piece must be connected to the hive, and</li><li>the space on which you drop your piece must not touch a stack of the opponent.</li></ol><br/><br/>You're playing Dark, drop a piece on the board.`,k2.fromRepresentation([[[ec],[O9]]],2),Si.drop(F4,new M(2,0)),$localize`Congratulations!`),ce.fromMove($localize`Moving pieces: the queen bee`,$localize`Once you have placed you queen bee on the board, you can move your pieces. You must place your queen bee on the board as your fourth piece at the latest. Each creature moves in a different way, and moves should respect two restrictions:<ol><li>the hive must always remain fully connected, and</li><li>pieces should be able to physically slide to their destination (except for the beetle and grasshopper as we will see later).</li></ol>The queen bee can move to any of its empty neighbors. To move a piece, click on it and then click on its destination. The possible destinations are highlighted.<br/><br/>You are playing Dark, move your queen bee.`,k2.fromRepresentation([[[],[NP],[xH],[T5],[ec]],[[ec],[F4],[P5],[],[]]],4),[Si.move(new M(1,1),new M(0,2)).get(),Si.move(new M(1,1),new M(1,2)).get()],$localize`Congratulations!`,$localize`Failed. Try again.`),ce.fromMove($localize`Moving the beetle`,$localize`The beetle moves like the queen bee, but it is allowed to climb on top of other pieces! Therefore, it need not adhere to the sliding restriction. Note that you are not allowed to drop the beetle on top of another piece in the drop phase, this can only be achieved when moving a beetle already on the board. A piece with a beetle on top is not allowed to move. A stack is considered to be of the player who has the beetle of the top.<br/><br/>You're playing Dark, block your opponent's queen by moving on top of it!`,k2.fromRepresentation([[[F4],[T5],[P5]],[[ec],[],[]]],6),[Si.move(new M(2,0),new M(1,0)).get()],$localize`Congratulations!`,$localize`Failed. Try again.`),ce.forClick($localize`Inspecting stacks`,$localize`When pieces are stacked together, you are allowed to inspect the stack to see which pieces are under the beetle. This works with opponent-controlled stacks too. To do so, you can simply click on any stack to see their composition.<br/><br/>You're playing Dark and your opponent has a beetle on top of one of your piece, click on it.`,k2.fromRepresentation([[[ec,F4],[T5],[P5]]],2),["#piece_0_0"],$localize`Congratulations!`,$localize`Failed. Try again.`),ce.fromMove($localize`Moving the grasshopper`,$localize`The grasshopper jumps over one or more pieces in a straight line, and stops at the first empty space encountered. It cannot jump over empty spaces, and can only move through jumps. Because it jumps, it does not adhere to the sliding restriction.<br/><br/>You're playing Dark. Jump over three pieces with your grasshopper!`,k2.fromRepresentation([[[O9],[F4],[ec],[qm]],[[xH],[],[],[]]],6),[Si.move(new M(0,0),new M(4,0)).get()],$localize`Congratulations!`,$localize`Failed. Try again.`),ce.fromPredicate($localize`Moving the soldier ant`,$localize`The soldier ant is a powerful piece: it can move anywhere in the hive as long as it respects the sliding and the one hive restrictions!<br/><br/>You're playing Dark. Your queen bee is stuck, move your soldier ant to free up your queen!`,k2.fromRepresentation([[[],[AP],[T5]],[[],[F4],[ec]],[[qm],[kH],[]]],6),Si.move(new M(1,0),new M(3,1)).get(),(t,e,r)=>t.equals(Si.move(new M(1,0),new M(0,1)).get())?G.failure($localize`You have not freed your queen, try again!`):G.SUCCESS,$localize`Congratulations!`),ce.anyMove($localize`Moving the spider`,$localize`Finally, the spider can move exactly 3 spaces at a time. It is not allowed to go twice through the same space in a move. As the spider crawls around other pieces, it can only move around pieces that are in direct contact with it. This means that the spider is not allowed to temporarily split the hive. For example, here, Dark's spider cannot go on the left as its first move. To do a spider move, select a spider and click on the three spaces that compose the move.<br/><br/>You're playing Dark, move your spider!`,k2.fromRepresentation([[[],[NP],[kH],[ec]],[[],[],[],[P5]],[[ec],[],[],[qm]],[[AP],[],[O9],[]],[[F4],[xH],[],[]]],6),Si.spiderMove([new M(1,0),new M(1,1),new M(2,1),new M(2,2)]),$localize`Congratulations!`),ce.informational($localize`Restrictions`,$localize`Let us clarify the two restrictions during moves.<ol><li>All pieces of the hive should always be connected in a way that there is a single hive. It can be the case that your piece disconnects from the hive when you slide it, but after the move there should be only one hive.</li><li>Except grasshoppers and beetles, all moves should be done by sliding the piece without disturbing the rest of the hive.</li></ol>Observe here how the queen bee is stuck, as it is not possible to slide it without moving one of the other pieces. Moreover, moving it would split the hive in two.`,k2.fromRepresentation([[[],[NP],[]],[[],[F4],[ec]],[[qm],[],[]]],6)),ce.informational($localize`Passing your turn`,$localize`Finally, it is possible that you are not able to do any move: when it is the case, you must pass your turn. Here, Dark must pass: the queen bee cannot move without disconnecting the hive, the beetle is stuck beneath another beetle, and a dropped piece would be in contact with an opponent's piece.`,k2.fromRepresentation([[[ec,P5],[F4],[T5]]],4))]}}const T6t=["app-hive-piece",""];function w6t(n,t){1&n&&(F(),Q(0,"path",9))}function b6t(n,t){1&n&&(F(),Q(0,"path",10))}function O6t(n,t){1&n&&(F(),Q(0,"path",11))}function N6t(n,t){1&n&&(F(),Q(0,"path",12))}function A6t(n,t){1&n&&(F(),Q(0,"path",13))}let I6t=(()=>{class n extends Hce{constructor(){super(...arguments),this.hexaPoints="",this.pieceClass="",this.isoPointsLight="",this.isoPointsDark="",this.isoPointsStroke="",this.layerTransform="",this.hexaCenter=new M(0,0)}ngAfterContentChecked(){const e=new M(this.x,this.y);this.pieceClass=this.getPlayerClass(this.piece.owner),this.hexaPoints=this.hexaLayout.getHexaPointsAt(e),this.hexaCenter=this.hexaLayout.getCenterAt(e);const s=this.hexaLayout.getIsoPoints(e,this.pieceHeight).map(i=>i.map(o=>o.toSVGPoint()).join(" "));this.isoPointsLight=s[0],this.isoPointsDark=s[1],this.isoPointsStroke=s[2],this.layerTransform=`translate(0 -${(this.layer+1)*this.pieceHeight})`}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=Dr(n)))(r||n)}}(),n.\u0275cmp=gt({type:n,selectors:[["","app-hive-piece",""]],inputs:{piece:"piece",x:"x",y:"y",hexaLayout:"hexaLayout",layer:"layer",pieceHeight:"pieceHeight"},features:[l],attrs:T6t,decls:11,vars:14,consts:[[1,"base","no-stroke","lighter",3,"ngClass"],[1,"base","no-stroke","darker",3,"ngClass"],[1,"base","no-fill","small-stroke"],[1,"base","small-stroke",3,"ngClass"],["d","M 15.3841 1.25408 C 22.8728 -1.82428 29.9895 -8.66692 29.9895 -11.9438 C 29.9895 -12.8799 29.4656 -13.6136 28.5873 -13.906 C 27.8046 -14.1664 24.6195 -14.3188 14.4763 -7.04548 C 14.3844 -7.97908 13.9844 -8.82172 13.3836 -9.47812 C 13.4167 -9.58096 13.4394 -9.6886 13.4394 -9.80284 C 13.4394 -13.1571 9.49688 -15.9237 3.91664 -16.864 C 3.97556 -18.4007 4.88768 -22.8456 12.8845 -26.8437 C 13.4073 -27.1052 13.6191 -27.7406 13.3578 -28.2634 C 13.0953 -28.7862 12.4609 -28.9971 11.938 -28.7367 C 3.34424 -24.4397 1.97336 -19.361 1.81856 -17.1244 C 1.12448 -17.1802 0.41168 -17.2094 -0.31564 -17.2094 C -1.40548 -17.2094 -2.46052 -17.1422 -3.47128 -17.0189 C -3.59032 -19.1981 -4.86616 -24.371 -13.5975 -28.7366 C -14.1203 -28.997 -14.7548 -28.7861 -15.0172 -28.2633 C -15.2787 -27.7404 -15.0668 -27.1049 -14.5439 -26.8436 C -6.16912 -22.6568 -5.56468 -17.9801 -5.57296 -16.6665 C -10.6046 -15.5753 -14.0706 -12.9474 -14.0706 -9.8026 C -14.0706 -9.68836 -14.048 -9.58072 -14.0146 -9.47788 C -14.6715 -8.76052 -15.0833 -7.81948 -15.121 -6.78208 C -25.5504 -14.3201 -28.8038 -14.17 -29.5978 -13.9058 C -30.4761 -13.6134 -31 -12.8799 -31 -11.9438 C -31 -8.63464 -23.7414 -1.68868 -16.1718 1.3442 C -23.7414 4.3772 -31 11.3233 -31 14.6323 C -31 15.5684 -30.4761 16.3021 -29.5968 16.5955 C -29.4222 16.6533 -29.1701 16.7371 -28.7516 16.7371 C -27.2727 16.7371 -23.7153 15.6854 -14.1678 8.74748 C -13.8431 9.143 -13.5125 9.47624 -13.0664 9.73316 C -12.821 16.1545 -7.58992 21.3656 -1.50604 21.892 L -1.50604 27.23 C -1.50604 27.8149 -1.03276 28.288 -0.448 28.288 C 0.13688 28.288 0.61004 27.8148 0.61004 27.23 L 0.61004 21.892 C 6.95852 21.3656 12.0572 16.1545 12.3026 9.73316 C 12.7614 9.46892 13.1995 9.12296 13.5294 8.71304 C 23.1112 15.6825 26.6942 16.738 28.1769 16.738 C 28.5964 16.738 28.8579 16.6533 29.0335 16.5944 C 29.9118 16.302 30.4398 15.5684 30.4398 14.6322 C 30.44 11.2893 23.0366 4.23644 15.3841 1.25408 Z M -28.8921 -11.9096 C -27.3192 -12.3306 -20.102 -7.90708 -13.9077 -3.24676 C -14.6109 -2.53432 -15.059 -1.57444 -15.1169 -0.51196 C -23.053 -3.54004 -29.0001 -10.3224 -28.8921 -11.9096 Z M -15.1288 6.06848 C -15.1288 6.31232 -15.1035 6.55004 -15.0636 6.78248 C -22.932 12.527 -27.6682 14.8687 -28.8932 14.593 C -28.9924 12.9306 -22.5395 5.64788 -14.1152 2.8394 C -14.0278 2.81048 -13.9496 2.76812 -13.8756 2.72 C -13.8144 2.78096 -13.7488 2.837 -13.6838 2.89412 C -14.5674 3.67016 -15.1288 4.80368 -15.1288 6.06848 Z M 27.8827 -11.9055 C 27.9772 -10.3347 22.2198 -3.74764 14.4784 -0.65668 C 14.3818 -1.74316 13.8714 -2.71012 13.1071 -3.40516 C 19.2103 -7.978 26.2028 -12.271 27.8827 -11.9055 Z M -0.31564 -15.0932 C 5.65928 -15.0932 10.0551 -12.9976 11.0895 -10.7981 C 10.8201 -10.8519 10.5422 -10.9012 10.257 -10.9012 L -10.8881 -10.9012 C -11.1731 -10.9012 -11.4513 -10.8519 -11.7207 -10.7981 C -10.6866 -12.9976 -6.29056 -15.0932 -0.31564 -15.0932 Z M -0.31564 19.7833 C -5.79256 19.7833 -10.3106 15.551 -10.8432 10.2606 L 10.2122 10.2606 C 9.67952 15.5509 5.16128 19.7833 -0.31564 19.7833 Z M 10.257 8.14436 L -10.8881 8.14436 C -12.0599 8.14436 -13.0126 7.1948 -13.0126 6.02816 C -13.0126 4.86152 -12.0599 3.91196 -10.8881 3.91196 L 10.257 3.91196 C 11.4286 3.91196 12.3813 4.86152 12.3813 6.02816 C 12.3813 7.1948 11.4286 8.14436 10.257 8.14436 Z M 10.257 1.79588 L -10.8881 1.79588 C -12.0599 1.79588 -13.0126 0.84632 -13.0126 -0.32032 C -13.0126 -1.48696 -12.0599 -2.43652 -10.8881 -2.43652 L 10.257 -2.43652 C 11.4286 -2.43652 12.3813 -1.48696 12.3813 -0.32032 C 12.3813 0.84632 11.4286 1.79588 10.257 1.79588 Z M 10.257 -4.5526 L -10.8881 -4.5526 C -12.0599 -4.5526 -13.0126 -5.50216 -13.0126 -6.6688 C -13.0126 -7.83544 -12.0599 -8.785 -10.8881 -8.785 L 10.257 -8.785 C 11.4286 -8.785 12.3813 -7.83544 12.3813 -6.6688 C 12.3813 -5.50216 11.4286 -4.5526 10.257 -4.5526 Z M 28.3363 14.5982 C 27.2038 14.8942 22.4127 12.5611 14.4402 6.73292 C 14.4745 6.51596 14.4975 6.29504 14.4975 6.06848 C 14.4975 4.8038 13.9364 3.67028 13.0527 2.89424 C 13.1287 2.82764 13.2044 2.7602 13.2751 2.68832 C 13.3609 2.75036 13.4539 2.80436 13.5592 2.8394 C 21.9908 5.651 28.4488 12.945 28.3363 14.5982 Z",4,"ngIf"],["d","M 27.079 1.30667 L 15.7412 -4.79822 L 15.7412 -7.89145 C 15.7412 -8.39311 15.335 -8.80033 14.8324 -8.80033 L 12.1056 -8.80033 L 12.1056 -9.70918 C 12.1056 -10.4088 12.0442 -11.0941 11.927 -11.7605 L 17.9173 -14.3278 C 18.2517 -14.4705 18.4681 -14.7995 18.4681 -15.1622 L 18.4681 -25.1602 L 23.9215 -25.1602 C 24.4242 -25.1602 24.8304 -25.5674 24.8304 -26.0691 C 24.8304 -26.5718 24.4242 -26.978 23.9215 -26.978 L 17.5592 -26.978 C 17.0566 -26.978 16.6503 -26.5718 16.6503 -26.0691 L 16.6503 -15.7621 L 11.4679 -13.5404 C 10.6322 -15.9716 9.02444 -18.0467 6.93872 -19.4717 C 7.86471 -20.1312 8.47025 -21.2128 8.47025 -22.4339 C 8.47025 -24.439 6.83966 -26.0695 4.83465 -26.0695 C 4.33202 -26.0695 3.92577 -25.6623 3.92577 -25.1607 C 3.92577 -24.659 4.33202 -24.2518 4.83465 -24.2518 C 5.83716 -24.2518 6.65252 -23.4366 6.65252 -22.4339 C 6.65252 -21.4314 5.83726 -20.6161 4.83465 -20.6161 L 4.83336 -20.616 C 3.43401 -21.2012 1.89916 -21.525 0.290076 -21.525 C -1.31901 -21.525 -2.85386 -21.2012 -4.25324 -20.616 L -4.2545 -20.6161 C -5.257 -20.6161 -6.07236 -21.4313 -6.07236 -22.4339 C -6.07236 -23.4365 -5.25711 -24.2518 -4.2545 -24.2518 C -3.75186 -24.2518 -3.34563 -24.659 -3.34563 -25.1607 C -3.34563 -25.6623 -3.75186 -26.0695 -4.2545 -26.0695 C -6.25961 -26.0695 -7.89009 -24.4389 -7.89009 -22.4339 C -7.89009 -21.2127 -7.28459 -20.1312 -6.35856 -19.4717 C -8.44428 -18.0467 -10.0521 -15.9716 -10.8877 -13.5404 L -16.0702 -15.7621 L -16.0702 -26.0691 C -16.0702 -26.5718 -16.4764 -26.978 -16.979 -26.978 L -23.3419 -26.978 C -23.8445 -26.978 -24.2508 -26.5718 -24.2508 -26.0691 C -24.2508 -25.5674 -23.8445 -25.1602 -23.3419 -25.1602 L -17.8884 -25.1602 L -17.8884 -15.1622 C -17.8884 -14.7995 -17.6721 -14.4705 -17.3377 -14.3278 L -11.3474 -11.7605 C -11.4646 -11.0941 -11.526 -10.4086 -11.526 -9.70917 L -11.526 -8.80033 L -14.2527 -8.80033 C -14.7554 -8.80033 -15.1616 -8.3931 -15.1616 -7.89145 L -15.1616 -4.79822 L -26.4994 1.30667 C -26.9411 1.54388 -27.1074 2.09561 -26.8693 2.53732 C -26.7047 2.84269 -26.3912 3.01546 -26.0677 3.01546 C -25.9223 3.01546 -25.775 2.98095 -25.6378 2.90639 L -15.1617 -2.73463 L -15.1617 5.31601 L -20.2889 9.58867 C -20.6025 9.85047 -20.7034 10.2904 -20.5334 10.663 L -16.1815 20.2374 L -19.5862 26.1962 C -19.8362 26.6316 -19.6845 27.1869 -19.2482 27.4359 C -19.1064 27.5177 -18.951 27.5559 -18.7983 27.5559 C -18.4819 27.5559 -18.1757 27.3913 -18.0085 27.0978 L -14.3729 20.7354 C -14.2283 20.4818 -14.2138 20.1747 -14.3347 19.9084 L -18.5921 10.5411 L -15.1618 7.68295 L -15.1618 8.46881 C -15.1618 16.989 -8.23053 23.9203 0.28965 23.9203 C 8.80982 23.9203 15.7411 16.989 15.7411 8.46881 L 15.7411 7.68295 L 19.1714 10.5411 L 14.9141 19.9084 C 14.7932 20.1747 14.8078 20.4819 14.9522 20.7354 L 18.5878 27.0978 C 18.755 27.3913 19.0614 27.5559 19.3776 27.5559 C 19.5303 27.5559 19.6857 27.5177 19.8275 27.4359 C 20.2638 27.1869 20.4155 26.6316 20.1656 26.1962 L 16.7608 20.2374 L 21.1127 10.663 C 21.2827 10.2903 21.1817 9.85037 20.8681 9.58867 L 15.741 5.31601 L 15.741 -2.73463 L 26.2171 2.90639 C 26.3544 2.98095 26.5016 3.01546 26.647 3.01546 C 26.9705 3.01546 27.2841 2.8428 27.4486 2.53732 C 27.687 2.09561 27.5207 1.54398 27.079 1.30667 Z M -9.70827 -9.70928 C -9.70827 -15.2218 -5.22281 -19.7073 0.289757 -19.7073 C 5.80234 -19.7073 10.2878 -15.2219 10.2878 -9.70928 L 10.2878 -8.80044 L -9.70827 -8.80044 Z M -10.6171 -6.98257 L 11.1966 -6.98257 L 13.9234 -6.98257 L 13.9234 -4.26531 C 13.9233 -4.25796 13.9233 -4.25065 13.9234 -4.24316 L 13.9234 -3.87835 L 0.289757 3.79022 L -13.3439 -3.87835 L -13.3439 -4.24316 C -13.3438 -4.25051 -13.3438 -4.25786 -13.3439 -4.26531 L -13.3439 -6.98257 Z M -13.3439 8.46892 L -13.3439 5.74091 L -13.3439 5.73461 L -13.3439 -1.79295 L -0.619115 5.36501 L -0.619115 22.0715 C -7.71446 21.6021 -13.3439 15.681 -13.3439 8.46892 Z M 1.19863 22.0715 L 1.19863 5.36501 L 13.9234 -1.79295 L 13.9234 5.73471 L 13.9234 5.7408 L 13.9234 8.46902 C 13.9234 15.681 8.29409 21.6021 1.19863 22.0715 Z",4,"ngIf"],["d","M 23.1993 15.5733 C 21.3366 14.109 18.3446 11.7414 17.7296 11.2169 C 12.9652 2.64827 6.39655 -0.814228 5.07856 -1.44294 C 5.33756 -1.88486 5.4918 -2.35409 5.4918 -2.83719 C 5.4918 -3.30048 5.3294 -3.93486 5.04265 -5.01624 C 4.8512 -5.73792 4.63024 -6.57068 4.49294 -7.31486 C 4.59374 -7.31187 4.69419 -7.30891 4.79464 -7.30891 C 8.94543 -7.30891 12.7535 -9.75455 12.9341 -9.87229 C 13.1714 -10.0271 13.3373 -10.2703 13.3943 -10.5478 C 13.451 -10.8255 13.3949 -11.1144 13.2379 -11.3502 L 11.5052 -13.9494 C 13.7039 -15.6498 16.0931 -16.5487 16.1187 -16.5583 C 16.6686 -16.7613 16.9498 -17.3717 16.7467 -17.9216 C 16.5433 -18.4713 15.9332 -18.7522 15.3835 -18.5494 C 15.2491 -18.4996 12.0538 -17.304 9.38881 -14.9538 C 8.99075 -14.6026 8.91323 -14.0109 9.20786 -13.5691 L 10.8409 -11.1198 C 9.64329 -10.4953 7.44869 -9.53254 5.16354 -9.43858 C 5.21814 -9.64602 5.24334 -9.83818 5.25069 -10.0066 C 5.28989 -10.9199 4.88588 -11.8072 4.04914 -12.6442 C 3.74954 -12.9441 3.51227 -13.3816 3.26136 -13.8449 C 2.98206 -14.3609 2.65176 -14.9693 2.15511 -15.4578 C 2.8653 -18.087 7.91209 -26.8789 12.9465 -30.2572 C 13.4331 -30.5838 13.5628 -31.2431 13.2359 -31.7297 C 12.909 -32.2165 12.2501 -32.3464 11.7633 -32.0197 C 6.51594 -28.4984 1.39127 -19.8963 0.213976 -16.338 C 0.113176 -16.3457 0.00992607 -16.351 -0.0975239 -16.351 C -0.204974 -16.351 -0.308574 -16.3457 -0.409374 -16.338 C -1.58669 -19.8963 -6.71146 -28.4984 -11.9586 -32.0197 C -12.4453 -32.3465 -13.1048 -32.2168 -13.4313 -31.7297 C -13.7575 -31.2431 -13.6283 -30.5836 -13.1415 -30.2572 C -8.10712 -26.8789 -3.0603 -18.087 -2.35008 -15.4578 C -2.8469 -14.9693 -3.17709 -14.3609 -3.45639 -13.8449 C -3.70734 -13.3816 -3.94429 -12.9441 -4.24417 -12.6442 C -5.08116 -11.8072 -5.48531 -10.9199 -5.44569 -10.0066 C -5.43869 -9.83861 -5.41034 -9.64675 -5.35889 -9.43985 C -7.63784 -9.53621 -9.83525 -10.4982 -11.0349 -11.1215 L -9.4031 -13.5691 C -9.1084 -14.0109 -9.18575 -14.6025 -9.58405 -14.9538 C -12.249 -17.304 -15.4439 -18.4998 -15.5787 -18.5494 C -16.1283 -18.7529 -16.7389 -18.4714 -16.9419 -17.9216 C -17.1453 -17.3717 -16.8639 -16.7614 -16.3139 -16.5583 C -16.2894 -16.5485 -13.9065 -15.6578 -11.7003 -13.9495 L -13.4331 -11.3502 C -13.5903 -11.1144 -13.6466 -10.8255 -13.5896 -10.5478 C -13.5325 -10.2702 -13.3666 -10.027 -13.1294 -9.87229 C -12.9485 -9.75455 -9.14095 -7.30891 -4.98985 -7.30891 C -4.8894 -7.30891 -4.7886 -7.31201 -4.68815 -7.31486 C -4.82535 -6.57068 -5.04669 -5.73792 -5.23789 -5.01624 C -5.52454 -3.93472 -5.68701 -3.30048 -5.68701 -2.8372 C -5.68701 -2.35409 -5.53301 -1.885 -5.27377 -1.44294 C -6.59176 -0.814515 -13.1606 2.64715 -17.9248 11.2169 C -18.5398 11.7414 -21.5318 14.109 -23.3946 15.5733 C -23.8553 15.9355 -23.9353 16.6027 -23.5731 17.0635 C -23.3638 17.3299 -23.0524 17.4689 -22.7381 17.4689 C -22.5085 17.4689 -22.2773 17.3949 -22.0829 17.2419 C -16.329 12.7187 -16.2836 12.636 -16.1484 12.3905 C -12.7212 6.15479 -8.19525 2.75469 -5.81882 1.2894 L -6.09532 2.62182 C -6.25842 3.40845 -6.37112 4.19975 -6.43447 4.99303 C -6.63957 5.8207 -7.95109 11.2654 -7.95109 15.2755 L -7.95109 28.8035 C -7.95109 30.0442 -6.94176 31.0534 -5.6958 31.0534 C -4.54097 31.0534 -3.57917 30.1874 -3.45818 29.0391 L -3.23488 26.9188 L -2.46904 31.3227 C -2.26779 32.4787 -1.27065 33.3177 -0.0974189 33.3177 C 1.07582 33.3177 2.07325 32.4787 2.27422 31.3229 L 3.04019 26.9189 L 3.26349 29.0391 C 3.38389 30.1876 4.34632 31.0536 5.50647 31.0536 C 6.74711 31.0536 7.75644 30.0442 7.75644 28.8036 L 7.75644 15.2757 C 7.75644 11.2658 6.4452 5.82155 6.23979 4.99331 C 6.17609 4.20003 6.06374 3.40873 5.90029 2.62196 L 5.62274 1.2836 C 7.99413 2.73998 12.5115 6.12819 15.9537 12.391 C 16.0888 12.6363 16.1339 12.719 21.888 17.2422 C 22.0826 17.395 22.3137 17.4692 22.5432 17.4692 C 22.8578 17.4692 23.1687 17.3302 23.3782 17.0637 C 23.7406 16.6029 23.6603 15.9355 23.1997 15.5733 Z M -0.0974189 -0.50221 C -1.23145 -0.50221 -3.5643 -2.07335 -3.5643 -2.83621 C -3.5608 -3.05937 -3.34415 -3.87585 -3.18616 -4.47201 C -2.94361 -5.38656 -2.65811 -6.46286 -2.51829 -7.43599 L 2.32336 -7.43599 C 2.46301 -6.46286 2.74857 -5.38656 2.99126 -4.47201 C 3.14946 -3.87585 3.36587 -3.0595 3.3694 -2.83706 C 3.36958 -2.07335 1.03665 -0.50221 -0.0973489 -0.50221 Z M -2.74316 -11.143 C -2.22485 -11.6614 -1.88748 -12.2843 -1.58991 -12.834 C -1.01925 -13.8877 -0.777679 -14.2284 -0.0976289 -14.2284 C 0.582456 -14.2284 0.824166 -13.8878 1.39474 -12.834 C 1.69259 -12.2843 2.02964 -11.6614 2.54799 -11.143 C 2.93554 -10.7554 3.14232 -10.3845 3.1299 -10.0984 C 3.1229 -9.90554 3.00985 -9.71847 2.8709 -9.55872 L -3.06667 -9.55872 C -3.20527 -9.71849 -3.31727 -9.90557 -3.32532 -10.0984 C -3.33582 -10.3844 -3.13072 -10.7553 -2.74341 -11.143 Z M -5.5692 28.8171 C -5.5762 28.882 -5.63045 28.931 -5.7015 28.931 C -5.7715 28.931 -5.8289 28.8738 -5.8289 28.8036 L -5.8289 15.2757 C -5.8289 14.5074 -5.7743 13.6716 -5.6868 12.8224 L -4.56484 19.2736 Z M 0.182861 30.9593 C 0.158361 31.0959 0.0411111 31.1951 -0.0974889 31.1951 C -0.236439 31.1951 -0.354039 31.0959 -0.377839 30.9592 L -4.12024 9.4401 C -4.36139 8.05221 -4.42929 6.65441 -4.32604 5.26327 C -4.32334 5.23737 -4.32254 5.21161 -4.32254 5.18602 C -4.26619 4.47255 -4.16574 3.76092 -4.01909 3.05339 L -3.46252 0.371859 C -2.71761 0.872219 -1.89235 1.25047 -1.1611 1.45324 L -1.1611 19.804 C -1.1611 20.3903 -0.685909 20.8653 -0.0997989 20.8653 C 0.486346 20.8653 0.961506 20.3903 0.961506 19.804 L 0.961506 1.4531 C 1.6928 1.25045 2.51806 0.872079 3.26293 0.371716 L 3.8195 3.05325 C 3.96615 3.76078 4.06695 4.47241 4.12295 5.18588 C 4.12407 5.21178 4.12617 5.2374 4.12645 5.26313 C 4.2297 6.65413 4.1618 8.05193 3.92065 9.43996 Z M 5.63355 28.8035 C 5.63355 28.8737 5.57615 28.9309 5.50055 28.9309 C 5.4351 28.9309 5.38085 28.8819 5.3742 28.8168 L 4.36967 19.2735 L 5.49166 12.8221 C 5.57951 13.6713 5.63376 14.5072 5.63376 15.2754 Z",4,"ngIf"],["d","M 26.2796 -9.91591 C 26.0694 -10.4424 25.4717 -10.6985 24.9452 -10.488 L 13.9952 -6.10798 C 13.8372 -6.04429 13.6972 -5.94331 13.588 -5.8123 L 8.42091 0.388326 L 4.52341 0.388326 L 8.59528 -4.49777 C 8.68702 -4.60766 8.75434 -4.73537 8.79361 -4.87289 L 13.1189 -20.0116 L 20.6616 -29.7097 C 21.0095 -30.1573 20.9295 -30.8021 20.4821 -31.1502 C 20.0347 -31.498 19.3896 -31.4175 19.0416 -30.9702 L 11.3767 -21.1152 C 11.2958 -21.0115 11.2364 -20.8935 11.1998 -20.7668 L 6.87935 -5.64532 L 3.30485 -1.35594 C 3.18605 -2.00651 2.8709 -2.58958 2.42256 -3.04056 L 3.25011 -4.69564 C 3.50388 -5.20275 3.29829 -5.81939 2.79124 -6.07303 C 2.28436 -6.3268 1.66762 -6.12088 1.41399 -5.6137 L 0.587006 -3.95974 C 0.441806 -3.97954 0.292976 -3.99472 0.142034 -3.99472 C -0.00910632 -3.99472 -0.157276 -3.98812 -0.302971 -3.95974 L -1.12991 -5.6137 C -1.38335 -6.12068 -2.00005 -6.32611 -2.50716 -6.07303 C -3.01427 -5.81926 -3.21983 -5.20292 -2.96599 -4.69564 L -2.13845 -3.04056 C -2.58676 -2.58938 -2.90151 -2.00667 -3.02074 -1.35594 L -6.5952 -5.64532 L -10.9158 -20.7666 C -10.9547 -20.8928 -11.0118 -21.0109 -11.0926 -21.1151 L -18.7576 -30.97 C -19.1055 -31.4177 -19.7506 -31.4983 -20.198 -31.15 C -20.6454 -30.802 -20.7262 -30.157 -20.3785 -29.7096 L -12.8358 -20.0115 L -8.51046 -4.87279 C -8.47152 -4.73518 -8.40354 -4.6078 -8.31213 -4.49768 L -4.24022 0.388425 L -8.13769 0.388425 L -13.3048 -5.81223 C -13.4137 -5.94324 -13.554 -6.04521 -13.7121 -6.10791 L -24.6622 -10.4879 C -25.1888 -10.6981 -25.7861 -10.4401 -25.9966 -9.91598 C -26.2072 -9.38953 -25.9488 -8.7922 -25.4248 -8.58156 L -14.7158 -4.29806 L -9.4072 2.07245 C -9.21217 2.30642 -8.92325 2.44211 -8.61853 2.44211 L -4.49492 2.44211 L -10.118 4.85187 C -10.2909 4.92612 -10.4398 5.04591 -10.5486 5.199 L -16.0236 12.8639 C -16.0985 12.9686 -16.153 13.0867 -16.1843 13.2114 L -17.2793 17.5914 C -17.4169 18.1415 -17.0823 18.6989 -16.5324 18.8364 C -16.4489 18.8562 -16.365 18.8714 -16.2825 18.8714 C -15.8228 18.8714 -15.4041 18.5596 -15.2875 18.0936 L -14.2397 13.9027 L -9.04496 6.63014 L -3.91861 4.43304 C -4.18822 4.70496 -4.4401 4.99859 -4.67127 5.31067 L -10.4723 11.6784 C -10.5927 11.811 -10.6762 11.9724 -10.7155 12.1472 L -12.9055 22.0021 C -12.9286 22.117 -12.9404 22.2354 -12.9253 22.3524 L -11.8303 31.1123 C -11.7653 31.6316 -11.3231 32.0116 -10.8129 32.0116 C -10.7697 32.0116 -10.7275 32.009 -10.6842 32.005 C -10.1217 31.9347 -9.72255 31.4215 -9.79287 30.8589 L -10.8659 22.2755 L -8.77373 12.8608 L -6.36268 10.2144 C -6.34288 13.6592 -3.66998 19.968 0.138371 19.968 C 3.94677 19.968 6.62264 13.6592 6.6395 10.2144 L 9.05055 12.8608 L 11.1426 22.2755 L 10.0697 30.8589 C 9.99943 31.4215 10.3981 31.9346 10.961 32.005 C 11.0042 32.0083 11.0468 32.0116 11.0897 32.0116 C 11.6 32.0116 12.0421 31.6318 12.1071 31.1123 L 13.2021 22.3524 C 13.2186 22.2352 13.2087 22.1171 13.1856 22.0021 L 10.9956 12.1472 C 10.9566 11.9726 10.8728 11.8106 10.7524 11.6784 L 4.95135 5.31067 C 4.72002 4.99849 4.46804 4.70499 4.19869 4.43304 L 9.32498 6.63014 L 14.5198 13.9027 L 15.5676 18.0936 C 15.6841 18.5601 16.1027 18.8714 16.5626 18.8714 C 16.6451 18.8714 16.729 18.8648 16.8124 18.8364 C 17.3625 18.6988 17.6969 18.1415 17.5594 17.5914 L 16.4644 13.2114 C 16.4294 13.0867 16.3789 12.9686 16.3037 12.8639 L 10.8287 5.199 C 10.7198 5.04621 10.5707 4.92609 10.3981 4.85187 L 4.77501 2.44211 L 8.89863 2.44211 C 9.20289 2.44211 9.49223 2.30681 9.68729 2.07245 L 14.9959 -4.29806 L 25.7048 -8.58156 C 26.2309 -8.7921 26.4871 -9.38969 26.2765 -9.91604 Z M 3.32851 6.55639 C 3.33511 6.56299 3.34831 6.57949 3.35491 6.59533 C 3.44038 6.71413 3.52189 6.83623 3.6001 6.9615 L -3.31728 6.9615 C -3.2394 6.83643 -3.15723 6.71433 -3.07209 6.59533 C -3.06549 6.58873 -3.05229 6.57223 -3.04569 6.55639 C -2.22788 5.4365 -1.08892 4.63183 0.141308 4.63183 C 1.37151 4.63183 2.51044 5.43634 3.32825 6.55639 Z M -4.30682 10.1751 C -4.30682 9.7961 -4.25897 9.40383 -4.16987 9.01166 L 4.45319 9.01166 C 4.54229 9.4036 4.59014 9.79583 4.59014 10.1751 C 4.59014 10.5284 4.5512 10.9222 4.47728 11.3385 L -4.19435 11.3385 C -4.26695 10.9222 -4.30655 10.5285 -4.30655 10.1751 Z M 1.30499 -0.774814 L 1.30499 2.50003 L 1.30499 2.50663 L 1.30499 2.71651 C 0.928325 2.62543 0.540278 2.57461 0.141572 2.57461 C -0.257068 2.57461 -0.645313 2.62543 -1.02187 2.71651 L -1.02187 2.50663 L -1.02187 2.50003 L -1.02187 -0.774814 C -1.02187 -1.4163 -0.499981 -1.93823 0.141572 -1.93823 C 0.783092 -1.93823 1.30499 -1.41623 1.30499 -0.774814 Z M 0.141572 17.9085 C -1.29768 17.9085 -2.79123 15.6796 -3.62943 13.3916 L 3.91268 13.3916 C 3.07435 15.6796 1.58077 17.9085 0.141572 17.9085 Z",4,"ngIf"],["d","M 21.8842 2.21077 L 18.0181 2.21077 L 13.0729 -0.756106 C 12.911 -0.853707 12.7271 -0.904573 12.5381 -0.904573 L 6.18206 -0.904573 C 6.26409 -1.2402 6.30742 -1.58751 6.30742 -1.94298 C 6.30742 -2.35345 6.24815 -2.75236 6.13972 -3.13557 L 10.6647 -4.04062 C 10.9348 -4.09355 11.1726 -4.25344 11.3252 -4.48199 L 15.2411 -10.3555 L 20.0108 -11.3098 C 20.2808 -11.3628 20.5186 -11.5227 20.6712 -11.7512 L 22.7482 -14.8665 C 23.067 -15.3442 22.9382 -15.9892 22.4605 -16.3069 C 21.9817 -16.6267 21.3378 -16.4959 21.0201 -16.0192 L 19.181 -13.2611 L 14.4113 -12.3067 C 14.1413 -12.2538 13.9035 -12.0939 13.7509 -11.8653 L 9.83492 -5.99184 L 5.07504 -5.03946 C 4.8146 -5.33056 4.51767 -5.59756 4.1913 -5.83727 C 6.07121 -6.88908 7.3457 -8.89921 7.3457 -11.2028 L 7.3457 -13.4521 C 7.3457 -13.6801 7.33217 -13.9049 7.30798 -14.1266 C 7.3256 -14.1905 7.33742 -14.257 7.34266 -14.3255 C 7.34788 -14.3889 7.864 -20.6352 11.4996 -20.6352 C 17.0843 -20.6352 17.7053 -29.5377 17.7282 -29.9168 C 17.7635 -30.489 17.3284 -30.9813 16.7572 -31.0175 C 16.1861 -31.057 15.6907 -30.6188 15.6554 -30.0456 C 15.6502 -29.9729 15.0967 -22.7121 11.4996 -22.7121 C 8.14265 -22.7121 6.5767 -19.8132 5.85813 -17.4544 C 5.37949 -18.0105 4.80424 -18.4808 4.15721 -18.8374 C 4.84539 -19.5678 5.26657 -20.5387 5.26462 -21.5875 C 5.28337 -21.8035 5.40896 -23.7278 4.30508 -24.9262 C 3.76306 -25.516 3.01841 -25.8275 2.15341 -25.8275 C 1.57915 -25.8275 1.11501 -25.3623 1.11501 -24.7892 C 1.11501 -24.216 1.57915 -23.7508 2.15341 -23.7508 C 2.51691 -23.7508 2.67681 -23.6282 2.77551 -23.5223 C 3.19194 -23.0727 3.21786 -22.0716 3.19194 -21.6739 C 3.19194 -20.5286 2.2605 -19.597 1.11501 -19.597 L -0.96193 -19.597 C -2.1073 -19.597 -3.03886 -20.5284 -3.043 -21.7601 C -3.07306 -22.135 -3.01185 -23.0986 -2.6245 -23.5203 C -2.52581 -23.6272 -2.3659 -23.7508 -2.00034 -23.7508 C -1.42607 -23.7508 -0.96193 -24.216 -0.96193 -24.7892 C -0.96193 -25.3623 -1.42607 -25.8275 -2.00034 -25.8275 C -2.86533 -25.8275 -3.60997 -25.516 -4.15199 -24.9262 C -5.25588 -23.7279 -5.13015 -21.8035 -5.11569 -21.6738 C -5.11569 -20.5799 -4.69026 -19.5842 -3.99683 -18.8416 C -4.6468 -18.4846 -5.22446 -18.0128 -5.70491 -17.4546 C -6.42352 -19.8137 -7.98933 -22.7127 -11.3464 -22.7127 C -14.9311 -22.7127 -15.4971 -29.9735 -15.5022 -30.0462 C -15.5386 -30.6193 -16.0442 -31.0587 -16.605 -31.0172 C -17.1761 -30.9808 -17.6102 -30.4887 -17.5749 -29.9164 C -17.552 -29.5374 -16.931 -20.6359 -11.3463 -20.6359 C -7.72626 -20.6359 -7.19456 -14.3876 -7.18935 -14.3253 C -7.18397 -14.257 -7.17219 -14.1909 -7.15466 -14.1274 C -7.17899 -13.9057 -7.19248 -13.6806 -7.19248 -13.4525 L -7.19248 -11.2032 C -7.19248 -8.8997 -5.91799 -6.88944 -4.03808 -5.83763 C -4.36448 -5.59792 -4.66142 -5.33105 -4.92182 -5.03983 L -9.68174 -5.99221 L -13.5977 -11.8657 C -13.7503 -12.0941 -13.9881 -12.254 -14.2581 -12.3071 L -19.0278 -13.2614 L -20.8669 -16.0196 C -21.1846 -16.4963 -21.8295 -16.6271 -22.3073 -16.3073 C -22.7849 -15.9895 -22.9138 -15.3447 -22.5949 -14.8669 L -20.518 -11.7516 C -20.3654 -11.5231 -20.1275 -11.3633 -19.8576 -11.3102 L -15.0879 -10.3559 L -11.172 -4.48236 C -11.0194 -4.25393 -10.7816 -4.09401 -10.5116 -4.04098 L -5.98653 -3.13594 C -6.09507 -2.75272 -6.1542 -2.35382 -6.1542 -1.94335 C -6.1542 -1.58776 -6.11087 -1.24057 -6.02887 -0.904939 L -12.3849 -0.904939 C -12.5739 -0.904939 -12.7576 -0.85407 -12.9197 -0.756472 L -17.8648 2.21041 L -21.7311 2.21041 C -22.3053 2.21041 -22.7695 2.67564 -22.7695 3.24881 C -22.7695 3.82199 -22.3053 4.28723 -21.7311 4.28723 L -17.5773 4.28723 C -17.3883 4.28723 -17.2045 4.23634 -17.0425 4.13876 L -12.0973 1.17188 L -5.11579 1.17188 C -5.04949 1.17188 -4.98475 1.16506 -4.92182 1.15314 C -4.41144 1.72375 -3.76306 2.20335 -3.01939 2.55979 C -3.67679 3.29481 -4.07738 4.26409 -4.07738 5.32574 L -4.07738 5.72187 L -13.8876 10.627 C -14.1752 10.7713 -14.3787 11.0381 -14.441 11.3529 L -17.495 26.6212 L -20.3882 29.5143 C -20.7943 29.9204 -20.7943 30.5767 -20.3882 30.9827 C -20.1857 31.1852 -19.9198 31.2869 -19.654 31.2869 C -19.3881 31.2869 -19.1223 31.1852 -18.9198 30.9827 L -15.8045 27.8673 C -15.6591 27.7219 -15.5614 27.5381 -15.5209 27.3366 L -12.5043 12.2584 L -4.07728 8.04487 L -4.07728 8.44097 C -4.07728 9.47136 -3.69953 10.4145 -3.07635 11.1411 C -6.09774 12.3855 -8.23116 15.3606 -8.23116 18.8254 L -8.23116 22.9792 C -8.23116 27.5598 -4.50417 31.2868 0.0764775 31.2868 C 4.65712 31.2868 8.38411 27.5598 8.38411 22.9792 L 8.38411 18.8254 C 8.38411 15.3604 6.25083 12.3854 3.2293 11.1411 C 3.85249 10.4145 4.23024 9.47136 4.23024 8.44097 L 4.23024 8.04487 L 12.6572 12.2584 L 15.6739 27.3366 C 15.7144 27.538 15.812 27.7219 15.9574 27.8673 L 19.0728 30.9827 C 19.2753 31.1852 19.5412 31.2869 19.807 31.2869 C 20.0728 31.2869 20.3386 31.1852 20.5411 30.9827 C 20.9471 30.5767 20.9471 29.9203 20.5411 29.5143 L 17.648 26.6212 L 14.5939 11.3529 C 14.5315 11.0381 14.328 10.7713 14.0404 10.627 L 4.23024 5.72187 L 4.23024 5.32574 C 4.23024 4.26409 3.82962 3.29481 3.17223 2.55979 C 3.91601 2.20335 4.56426 1.72388 5.07464 1.15314 C 5.13757 1.16506 5.20219 1.17188 5.26865 1.17188 L 12.2502 1.17188 L 17.1953 4.13876 C 17.3573 4.23634 17.5411 4.28723 17.7301 4.28723 L 21.8839 4.28723 C 22.4581 4.28723 22.9223 3.82199 22.9223 3.24881 C 22.9223 2.67564 22.4585 2.21077 21.8842 2.21077 Z M -1.04894 -7.13526 C -3.29089 -7.13526 -5.11556 -8.9598 -5.11556 -11.2028 L -5.11556 -13.4521 C -5.11556 -15.6952 -3.29101 -17.5197 -1.04894 -17.5197 L 1.20238 -17.5197 C 3.44434 -17.5197 5.26901 -15.6952 5.26901 -13.4521 L 5.26901 -11.2028 C 5.26901 -8.9598 3.44444 -7.13526 1.20238 -7.13526 Z M 6.30752 18.8259 L 6.30752 22.9796 C 6.30752 26.4159 3.51308 29.2103 0.0768428 29.2103 C -3.3594 29.2103 -6.15384 26.4159 -6.15384 22.9796 L -6.15384 18.8259 C -6.15384 15.3896 -3.3594 12.5952 0.0768428 12.5952 C 3.51308 12.5952 6.30752 15.3896 6.30752 18.8259 Z M 2.15366 5.3261 L 2.15366 6.39593 L 2.15366 6.39956 L 2.15366 8.44147 C 2.15366 9.58683 1.22222 10.5184 0.076721 10.5184 C -1.06878 10.5184 -2.00022 9.58696 -2.00022 8.44147 L -2.00022 6.39956 L -2.00022 6.39593 L -2.00022 5.3261 C -2.00022 4.18074 -1.06878 3.24918 0.076721 3.24918 C 1.22222 3.24918 2.15366 4.18074 2.15366 5.3261 Z M 0.0768428 1.17236 C -2.21403 1.17236 -4.07692 -0.225404 -4.07692 -1.94298 C -4.07692 -3.66056 -2.21391 -5.05834 0.0768428 -5.05834 C 2.36759 -5.05834 4.2306 -3.66056 4.2306 -1.94298 C 4.2306 -0.225404 2.36759 1.17236 0.0768428 1.17236 Z",4,"ngIf"],["d","M 15.3841 1.25408 C 22.8728 -1.82428 29.9895 -8.66692 29.9895 -11.9438 C 29.9895 -12.8799 29.4656 -13.6136 28.5873 -13.906 C 27.8046 -14.1664 24.6195 -14.3188 14.4763 -7.04548 C 14.3844 -7.97908 13.9844 -8.82172 13.3836 -9.47812 C 13.4167 -9.58096 13.4394 -9.6886 13.4394 -9.80284 C 13.4394 -13.1571 9.49688 -15.9237 3.91664 -16.864 C 3.97556 -18.4007 4.88768 -22.8456 12.8845 -26.8437 C 13.4073 -27.1052 13.6191 -27.7406 13.3578 -28.2634 C 13.0953 -28.7862 12.4609 -28.9971 11.938 -28.7367 C 3.34424 -24.4397 1.97336 -19.361 1.81856 -17.1244 C 1.12448 -17.1802 0.41168 -17.2094 -0.31564 -17.2094 C -1.40548 -17.2094 -2.46052 -17.1422 -3.47128 -17.0189 C -3.59032 -19.1981 -4.86616 -24.371 -13.5975 -28.7366 C -14.1203 -28.997 -14.7548 -28.7861 -15.0172 -28.2633 C -15.2787 -27.7404 -15.0668 -27.1049 -14.5439 -26.8436 C -6.16912 -22.6568 -5.56468 -17.9801 -5.57296 -16.6665 C -10.6046 -15.5753 -14.0706 -12.9474 -14.0706 -9.8026 C -14.0706 -9.68836 -14.048 -9.58072 -14.0146 -9.47788 C -14.6715 -8.76052 -15.0833 -7.81948 -15.121 -6.78208 C -25.5504 -14.3201 -28.8038 -14.17 -29.5978 -13.9058 C -30.4761 -13.6134 -31 -12.8799 -31 -11.9438 C -31 -8.63464 -23.7414 -1.68868 -16.1718 1.3442 C -23.7414 4.3772 -31 11.3233 -31 14.6323 C -31 15.5684 -30.4761 16.3021 -29.5968 16.5955 C -29.4222 16.6533 -29.1701 16.7371 -28.7516 16.7371 C -27.2727 16.7371 -23.7153 15.6854 -14.1678 8.74748 C -13.8431 9.143 -13.5125 9.47624 -13.0664 9.73316 C -12.821 16.1545 -7.58992 21.3656 -1.50604 21.892 L -1.50604 27.23 C -1.50604 27.8149 -1.03276 28.288 -0.448 28.288 C 0.13688 28.288 0.61004 27.8148 0.61004 27.23 L 0.61004 21.892 C 6.95852 21.3656 12.0572 16.1545 12.3026 9.73316 C 12.7614 9.46892 13.1995 9.12296 13.5294 8.71304 C 23.1112 15.6825 26.6942 16.738 28.1769 16.738 C 28.5964 16.738 28.8579 16.6533 29.0335 16.5944 C 29.9118 16.302 30.4398 15.5684 30.4398 14.6322 C 30.44 11.2893 23.0366 4.23644 15.3841 1.25408 Z M -28.8921 -11.9096 C -27.3192 -12.3306 -20.102 -7.90708 -13.9077 -3.24676 C -14.6109 -2.53432 -15.059 -1.57444 -15.1169 -0.51196 C -23.053 -3.54004 -29.0001 -10.3224 -28.8921 -11.9096 Z M -15.1288 6.06848 C -15.1288 6.31232 -15.1035 6.55004 -15.0636 6.78248 C -22.932 12.527 -27.6682 14.8687 -28.8932 14.593 C -28.9924 12.9306 -22.5395 5.64788 -14.1152 2.8394 C -14.0278 2.81048 -13.9496 2.76812 -13.8756 2.72 C -13.8144 2.78096 -13.7488 2.837 -13.6838 2.89412 C -14.5674 3.67016 -15.1288 4.80368 -15.1288 6.06848 Z M 27.8827 -11.9055 C 27.9772 -10.3347 22.2198 -3.74764 14.4784 -0.65668 C 14.3818 -1.74316 13.8714 -2.71012 13.1071 -3.40516 C 19.2103 -7.978 26.2028 -12.271 27.8827 -11.9055 Z M -0.31564 -15.0932 C 5.65928 -15.0932 10.0551 -12.9976 11.0895 -10.7981 C 10.8201 -10.8519 10.5422 -10.9012 10.257 -10.9012 L -10.8881 -10.9012 C -11.1731 -10.9012 -11.4513 -10.8519 -11.7207 -10.7981 C -10.6866 -12.9976 -6.29056 -15.0932 -0.31564 -15.0932 Z M -0.31564 19.7833 C -5.79256 19.7833 -10.3106 15.551 -10.8432 10.2606 L 10.2122 10.2606 C 9.67952 15.5509 5.16128 19.7833 -0.31564 19.7833 Z M 10.257 8.14436 L -10.8881 8.14436 C -12.0599 8.14436 -13.0126 7.1948 -13.0126 6.02816 C -13.0126 4.86152 -12.0599 3.91196 -10.8881 3.91196 L 10.257 3.91196 C 11.4286 3.91196 12.3813 4.86152 12.3813 6.02816 C 12.3813 7.1948 11.4286 8.14436 10.257 8.14436 Z M 10.257 1.79588 L -10.8881 1.79588 C -12.0599 1.79588 -13.0126 0.84632 -13.0126 -0.32032 C -13.0126 -1.48696 -12.0599 -2.43652 -10.8881 -2.43652 L 10.257 -2.43652 C 11.4286 -2.43652 12.3813 -1.48696 12.3813 -0.32032 C 12.3813 0.84632 11.4286 1.79588 10.257 1.79588 Z M 10.257 -4.5526 L -10.8881 -4.5526 C -12.0599 -4.5526 -13.0126 -5.50216 -13.0126 -6.6688 C -13.0126 -7.83544 -12.0599 -8.785 -10.8881 -8.785 L 10.257 -8.785 C 11.4286 -8.785 12.3813 -7.83544 12.3813 -6.6688 C 12.3813 -5.50216 11.4286 -4.5526 10.257 -4.5526 Z M 28.3363 14.5982 C 27.2038 14.8942 22.4127 12.5611 14.4402 6.73292 C 14.4745 6.51596 14.4975 6.29504 14.4975 6.06848 C 14.4975 4.8038 13.9364 3.67028 13.0527 2.89424 C 13.1287 2.82764 13.2044 2.7602 13.2751 2.68832 C 13.3609 2.75036 13.4539 2.80436 13.5592 2.8394 C 21.9908 5.651 28.4488 12.945 28.3363 14.5982 Z"],["d","M 27.079 1.30667 L 15.7412 -4.79822 L 15.7412 -7.89145 C 15.7412 -8.39311 15.335 -8.80033 14.8324 -8.80033 L 12.1056 -8.80033 L 12.1056 -9.70918 C 12.1056 -10.4088 12.0442 -11.0941 11.927 -11.7605 L 17.9173 -14.3278 C 18.2517 -14.4705 18.4681 -14.7995 18.4681 -15.1622 L 18.4681 -25.1602 L 23.9215 -25.1602 C 24.4242 -25.1602 24.8304 -25.5674 24.8304 -26.0691 C 24.8304 -26.5718 24.4242 -26.978 23.9215 -26.978 L 17.5592 -26.978 C 17.0566 -26.978 16.6503 -26.5718 16.6503 -26.0691 L 16.6503 -15.7621 L 11.4679 -13.5404 C 10.6322 -15.9716 9.02444 -18.0467 6.93872 -19.4717 C 7.86471 -20.1312 8.47025 -21.2128 8.47025 -22.4339 C 8.47025 -24.439 6.83966 -26.0695 4.83465 -26.0695 C 4.33202 -26.0695 3.92577 -25.6623 3.92577 -25.1607 C 3.92577 -24.659 4.33202 -24.2518 4.83465 -24.2518 C 5.83716 -24.2518 6.65252 -23.4366 6.65252 -22.4339 C 6.65252 -21.4314 5.83726 -20.6161 4.83465 -20.6161 L 4.83336 -20.616 C 3.43401 -21.2012 1.89916 -21.525 0.290076 -21.525 C -1.31901 -21.525 -2.85386 -21.2012 -4.25324 -20.616 L -4.2545 -20.6161 C -5.257 -20.6161 -6.07236 -21.4313 -6.07236 -22.4339 C -6.07236 -23.4365 -5.25711 -24.2518 -4.2545 -24.2518 C -3.75186 -24.2518 -3.34563 -24.659 -3.34563 -25.1607 C -3.34563 -25.6623 -3.75186 -26.0695 -4.2545 -26.0695 C -6.25961 -26.0695 -7.89009 -24.4389 -7.89009 -22.4339 C -7.89009 -21.2127 -7.28459 -20.1312 -6.35856 -19.4717 C -8.44428 -18.0467 -10.0521 -15.9716 -10.8877 -13.5404 L -16.0702 -15.7621 L -16.0702 -26.0691 C -16.0702 -26.5718 -16.4764 -26.978 -16.979 -26.978 L -23.3419 -26.978 C -23.8445 -26.978 -24.2508 -26.5718 -24.2508 -26.0691 C -24.2508 -25.5674 -23.8445 -25.1602 -23.3419 -25.1602 L -17.8884 -25.1602 L -17.8884 -15.1622 C -17.8884 -14.7995 -17.6721 -14.4705 -17.3377 -14.3278 L -11.3474 -11.7605 C -11.4646 -11.0941 -11.526 -10.4086 -11.526 -9.70917 L -11.526 -8.80033 L -14.2527 -8.80033 C -14.7554 -8.80033 -15.1616 -8.3931 -15.1616 -7.89145 L -15.1616 -4.79822 L -26.4994 1.30667 C -26.9411 1.54388 -27.1074 2.09561 -26.8693 2.53732 C -26.7047 2.84269 -26.3912 3.01546 -26.0677 3.01546 C -25.9223 3.01546 -25.775 2.98095 -25.6378 2.90639 L -15.1617 -2.73463 L -15.1617 5.31601 L -20.2889 9.58867 C -20.6025 9.85047 -20.7034 10.2904 -20.5334 10.663 L -16.1815 20.2374 L -19.5862 26.1962 C -19.8362 26.6316 -19.6845 27.1869 -19.2482 27.4359 C -19.1064 27.5177 -18.951 27.5559 -18.7983 27.5559 C -18.4819 27.5559 -18.1757 27.3913 -18.0085 27.0978 L -14.3729 20.7354 C -14.2283 20.4818 -14.2138 20.1747 -14.3347 19.9084 L -18.5921 10.5411 L -15.1618 7.68295 L -15.1618 8.46881 C -15.1618 16.989 -8.23053 23.9203 0.28965 23.9203 C 8.80982 23.9203 15.7411 16.989 15.7411 8.46881 L 15.7411 7.68295 L 19.1714 10.5411 L 14.9141 19.9084 C 14.7932 20.1747 14.8078 20.4819 14.9522 20.7354 L 18.5878 27.0978 C 18.755 27.3913 19.0614 27.5559 19.3776 27.5559 C 19.5303 27.5559 19.6857 27.5177 19.8275 27.4359 C 20.2638 27.1869 20.4155 26.6316 20.1656 26.1962 L 16.7608 20.2374 L 21.1127 10.663 C 21.2827 10.2903 21.1817 9.85037 20.8681 9.58867 L 15.741 5.31601 L 15.741 -2.73463 L 26.2171 2.90639 C 26.3544 2.98095 26.5016 3.01546 26.647 3.01546 C 26.9705 3.01546 27.2841 2.8428 27.4486 2.53732 C 27.687 2.09561 27.5207 1.54398 27.079 1.30667 Z M -9.70827 -9.70928 C -9.70827 -15.2218 -5.22281 -19.7073 0.289757 -19.7073 C 5.80234 -19.7073 10.2878 -15.2219 10.2878 -9.70928 L 10.2878 -8.80044 L -9.70827 -8.80044 Z M -10.6171 -6.98257 L 11.1966 -6.98257 L 13.9234 -6.98257 L 13.9234 -4.26531 C 13.9233 -4.25796 13.9233 -4.25065 13.9234 -4.24316 L 13.9234 -3.87835 L 0.289757 3.79022 L -13.3439 -3.87835 L -13.3439 -4.24316 C -13.3438 -4.25051 -13.3438 -4.25786 -13.3439 -4.26531 L -13.3439 -6.98257 Z M -13.3439 8.46892 L -13.3439 5.74091 L -13.3439 5.73461 L -13.3439 -1.79295 L -0.619115 5.36501 L -0.619115 22.0715 C -7.71446 21.6021 -13.3439 15.681 -13.3439 8.46892 Z M 1.19863 22.0715 L 1.19863 5.36501 L 13.9234 -1.79295 L 13.9234 5.73471 L 13.9234 5.7408 L 13.9234 8.46902 C 13.9234 15.681 8.29409 21.6021 1.19863 22.0715 Z"],["d","M 23.1993 15.5733 C 21.3366 14.109 18.3446 11.7414 17.7296 11.2169 C 12.9652 2.64827 6.39655 -0.814228 5.07856 -1.44294 C 5.33756 -1.88486 5.4918 -2.35409 5.4918 -2.83719 C 5.4918 -3.30048 5.3294 -3.93486 5.04265 -5.01624 C 4.8512 -5.73792 4.63024 -6.57068 4.49294 -7.31486 C 4.59374 -7.31187 4.69419 -7.30891 4.79464 -7.30891 C 8.94543 -7.30891 12.7535 -9.75455 12.9341 -9.87229 C 13.1714 -10.0271 13.3373 -10.2703 13.3943 -10.5478 C 13.451 -10.8255 13.3949 -11.1144 13.2379 -11.3502 L 11.5052 -13.9494 C 13.7039 -15.6498 16.0931 -16.5487 16.1187 -16.5583 C 16.6686 -16.7613 16.9498 -17.3717 16.7467 -17.9216 C 16.5433 -18.4713 15.9332 -18.7522 15.3835 -18.5494 C 15.2491 -18.4996 12.0538 -17.304 9.38881 -14.9538 C 8.99075 -14.6026 8.91323 -14.0109 9.20786 -13.5691 L 10.8409 -11.1198 C 9.64329 -10.4953 7.44869 -9.53254 5.16354 -9.43858 C 5.21814 -9.64602 5.24334 -9.83818 5.25069 -10.0066 C 5.28989 -10.9199 4.88588 -11.8072 4.04914 -12.6442 C 3.74954 -12.9441 3.51227 -13.3816 3.26136 -13.8449 C 2.98206 -14.3609 2.65176 -14.9693 2.15511 -15.4578 C 2.8653 -18.087 7.91209 -26.8789 12.9465 -30.2572 C 13.4331 -30.5838 13.5628 -31.2431 13.2359 -31.7297 C 12.909 -32.2165 12.2501 -32.3464 11.7633 -32.0197 C 6.51594 -28.4984 1.39127 -19.8963 0.213976 -16.338 C 0.113176 -16.3457 0.00992607 -16.351 -0.0975239 -16.351 C -0.204974 -16.351 -0.308574 -16.3457 -0.409374 -16.338 C -1.58669 -19.8963 -6.71146 -28.4984 -11.9586 -32.0197 C -12.4453 -32.3465 -13.1048 -32.2168 -13.4313 -31.7297 C -13.7575 -31.2431 -13.6283 -30.5836 -13.1415 -30.2572 C -8.10712 -26.8789 -3.0603 -18.087 -2.35008 -15.4578 C -2.8469 -14.9693 -3.17709 -14.3609 -3.45639 -13.8449 C -3.70734 -13.3816 -3.94429 -12.9441 -4.24417 -12.6442 C -5.08116 -11.8072 -5.48531 -10.9199 -5.44569 -10.0066 C -5.43869 -9.83861 -5.41034 -9.64675 -5.35889 -9.43985 C -7.63784 -9.53621 -9.83525 -10.4982 -11.0349 -11.1215 L -9.4031 -13.5691 C -9.1084 -14.0109 -9.18575 -14.6025 -9.58405 -14.9538 C -12.249 -17.304 -15.4439 -18.4998 -15.5787 -18.5494 C -16.1283 -18.7529 -16.7389 -18.4714 -16.9419 -17.9216 C -17.1453 -17.3717 -16.8639 -16.7614 -16.3139 -16.5583 C -16.2894 -16.5485 -13.9065 -15.6578 -11.7003 -13.9495 L -13.4331 -11.3502 C -13.5903 -11.1144 -13.6466 -10.8255 -13.5896 -10.5478 C -13.5325 -10.2702 -13.3666 -10.027 -13.1294 -9.87229 C -12.9485 -9.75455 -9.14095 -7.30891 -4.98985 -7.30891 C -4.8894 -7.30891 -4.7886 -7.31201 -4.68815 -7.31486 C -4.82535 -6.57068 -5.04669 -5.73792 -5.23789 -5.01624 C -5.52454 -3.93472 -5.68701 -3.30048 -5.68701 -2.8372 C -5.68701 -2.35409 -5.53301 -1.885 -5.27377 -1.44294 C -6.59176 -0.814515 -13.1606 2.64715 -17.9248 11.2169 C -18.5398 11.7414 -21.5318 14.109 -23.3946 15.5733 C -23.8553 15.9355 -23.9353 16.6027 -23.5731 17.0635 C -23.3638 17.3299 -23.0524 17.4689 -22.7381 17.4689 C -22.5085 17.4689 -22.2773 17.3949 -22.0829 17.2419 C -16.329 12.7187 -16.2836 12.636 -16.1484 12.3905 C -12.7212 6.15479 -8.19525 2.75469 -5.81882 1.2894 L -6.09532 2.62182 C -6.25842 3.40845 -6.37112 4.19975 -6.43447 4.99303 C -6.63957 5.8207 -7.95109 11.2654 -7.95109 15.2755 L -7.95109 28.8035 C -7.95109 30.0442 -6.94176 31.0534 -5.6958 31.0534 C -4.54097 31.0534 -3.57917 30.1874 -3.45818 29.0391 L -3.23488 26.9188 L -2.46904 31.3227 C -2.26779 32.4787 -1.27065 33.3177 -0.0974189 33.3177 C 1.07582 33.3177 2.07325 32.4787 2.27422 31.3229 L 3.04019 26.9189 L 3.26349 29.0391 C 3.38389 30.1876 4.34632 31.0536 5.50647 31.0536 C 6.74711 31.0536 7.75644 30.0442 7.75644 28.8036 L 7.75644 15.2757 C 7.75644 11.2658 6.4452 5.82155 6.23979 4.99331 C 6.17609 4.20003 6.06374 3.40873 5.90029 2.62196 L 5.62274 1.2836 C 7.99413 2.73998 12.5115 6.12819 15.9537 12.391 C 16.0888 12.6363 16.1339 12.719 21.888 17.2422 C 22.0826 17.395 22.3137 17.4692 22.5432 17.4692 C 22.8578 17.4692 23.1687 17.3302 23.3782 17.0637 C 23.7406 16.6029 23.6603 15.9355 23.1997 15.5733 Z M -0.0974189 -0.50221 C -1.23145 -0.50221 -3.5643 -2.07335 -3.5643 -2.83621 C -3.5608 -3.05937 -3.34415 -3.87585 -3.18616 -4.47201 C -2.94361 -5.38656 -2.65811 -6.46286 -2.51829 -7.43599 L 2.32336 -7.43599 C 2.46301 -6.46286 2.74857 -5.38656 2.99126 -4.47201 C 3.14946 -3.87585 3.36587 -3.0595 3.3694 -2.83706 C 3.36958 -2.07335 1.03665 -0.50221 -0.0973489 -0.50221 Z M -2.74316 -11.143 C -2.22485 -11.6614 -1.88748 -12.2843 -1.58991 -12.834 C -1.01925 -13.8877 -0.777679 -14.2284 -0.0976289 -14.2284 C 0.582456 -14.2284 0.824166 -13.8878 1.39474 -12.834 C 1.69259 -12.2843 2.02964 -11.6614 2.54799 -11.143 C 2.93554 -10.7554 3.14232 -10.3845 3.1299 -10.0984 C 3.1229 -9.90554 3.00985 -9.71847 2.8709 -9.55872 L -3.06667 -9.55872 C -3.20527 -9.71849 -3.31727 -9.90557 -3.32532 -10.0984 C -3.33582 -10.3844 -3.13072 -10.7553 -2.74341 -11.143 Z M -5.5692 28.8171 C -5.5762 28.882 -5.63045 28.931 -5.7015 28.931 C -5.7715 28.931 -5.8289 28.8738 -5.8289 28.8036 L -5.8289 15.2757 C -5.8289 14.5074 -5.7743 13.6716 -5.6868 12.8224 L -4.56484 19.2736 Z M 0.182861 30.9593 C 0.158361 31.0959 0.0411111 31.1951 -0.0974889 31.1951 C -0.236439 31.1951 -0.354039 31.0959 -0.377839 30.9592 L -4.12024 9.4401 C -4.36139 8.05221 -4.42929 6.65441 -4.32604 5.26327 C -4.32334 5.23737 -4.32254 5.21161 -4.32254 5.18602 C -4.26619 4.47255 -4.16574 3.76092 -4.01909 3.05339 L -3.46252 0.371859 C -2.71761 0.872219 -1.89235 1.25047 -1.1611 1.45324 L -1.1611 19.804 C -1.1611 20.3903 -0.685909 20.8653 -0.0997989 20.8653 C 0.486346 20.8653 0.961506 20.3903 0.961506 19.804 L 0.961506 1.4531 C 1.6928 1.25045 2.51806 0.872079 3.26293 0.371716 L 3.8195 3.05325 C 3.96615 3.76078 4.06695 4.47241 4.12295 5.18588 C 4.12407 5.21178 4.12617 5.2374 4.12645 5.26313 C 4.2297 6.65413 4.1618 8.05193 3.92065 9.43996 Z M 5.63355 28.8035 C 5.63355 28.8737 5.57615 28.9309 5.50055 28.9309 C 5.4351 28.9309 5.38085 28.8819 5.3742 28.8168 L 4.36967 19.2735 L 5.49166 12.8221 C 5.57951 13.6713 5.63376 14.5072 5.63376 15.2754 Z"],["d","M 26.2796 -9.91591 C 26.0694 -10.4424 25.4717 -10.6985 24.9452 -10.488 L 13.9952 -6.10798 C 13.8372 -6.04429 13.6972 -5.94331 13.588 -5.8123 L 8.42091 0.388326 L 4.52341 0.388326 L 8.59528 -4.49777 C 8.68702 -4.60766 8.75434 -4.73537 8.79361 -4.87289 L 13.1189 -20.0116 L 20.6616 -29.7097 C 21.0095 -30.1573 20.9295 -30.8021 20.4821 -31.1502 C 20.0347 -31.498 19.3896 -31.4175 19.0416 -30.9702 L 11.3767 -21.1152 C 11.2958 -21.0115 11.2364 -20.8935 11.1998 -20.7668 L 6.87935 -5.64532 L 3.30485 -1.35594 C 3.18605 -2.00651 2.8709 -2.58958 2.42256 -3.04056 L 3.25011 -4.69564 C 3.50388 -5.20275 3.29829 -5.81939 2.79124 -6.07303 C 2.28436 -6.3268 1.66762 -6.12088 1.41399 -5.6137 L 0.587006 -3.95974 C 0.441806 -3.97954 0.292976 -3.99472 0.142034 -3.99472 C -0.00910632 -3.99472 -0.157276 -3.98812 -0.302971 -3.95974 L -1.12991 -5.6137 C -1.38335 -6.12068 -2.00005 -6.32611 -2.50716 -6.07303 C -3.01427 -5.81926 -3.21983 -5.20292 -2.96599 -4.69564 L -2.13845 -3.04056 C -2.58676 -2.58938 -2.90151 -2.00667 -3.02074 -1.35594 L -6.5952 -5.64532 L -10.9158 -20.7666 C -10.9547 -20.8928 -11.0118 -21.0109 -11.0926 -21.1151 L -18.7576 -30.97 C -19.1055 -31.4177 -19.7506 -31.4983 -20.198 -31.15 C -20.6454 -30.802 -20.7262 -30.157 -20.3785 -29.7096 L -12.8358 -20.0115 L -8.51046 -4.87279 C -8.47152 -4.73518 -8.40354 -4.6078 -8.31213 -4.49768 L -4.24022 0.388425 L -8.13769 0.388425 L -13.3048 -5.81223 C -13.4137 -5.94324 -13.554 -6.04521 -13.7121 -6.10791 L -24.6622 -10.4879 C -25.1888 -10.6981 -25.7861 -10.4401 -25.9966 -9.91598 C -26.2072 -9.38953 -25.9488 -8.7922 -25.4248 -8.58156 L -14.7158 -4.29806 L -9.4072 2.07245 C -9.21217 2.30642 -8.92325 2.44211 -8.61853 2.44211 L -4.49492 2.44211 L -10.118 4.85187 C -10.2909 4.92612 -10.4398 5.04591 -10.5486 5.199 L -16.0236 12.8639 C -16.0985 12.9686 -16.153 13.0867 -16.1843 13.2114 L -17.2793 17.5914 C -17.4169 18.1415 -17.0823 18.6989 -16.5324 18.8364 C -16.4489 18.8562 -16.365 18.8714 -16.2825 18.8714 C -15.8228 18.8714 -15.4041 18.5596 -15.2875 18.0936 L -14.2397 13.9027 L -9.04496 6.63014 L -3.91861 4.43304 C -4.18822 4.70496 -4.4401 4.99859 -4.67127 5.31067 L -10.4723 11.6784 C -10.5927 11.811 -10.6762 11.9724 -10.7155 12.1472 L -12.9055 22.0021 C -12.9286 22.117 -12.9404 22.2354 -12.9253 22.3524 L -11.8303 31.1123 C -11.7653 31.6316 -11.3231 32.0116 -10.8129 32.0116 C -10.7697 32.0116 -10.7275 32.009 -10.6842 32.005 C -10.1217 31.9347 -9.72255 31.4215 -9.79287 30.8589 L -10.8659 22.2755 L -8.77373 12.8608 L -6.36268 10.2144 C -6.34288 13.6592 -3.66998 19.968 0.138371 19.968 C 3.94677 19.968 6.62264 13.6592 6.6395 10.2144 L 9.05055 12.8608 L 11.1426 22.2755 L 10.0697 30.8589 C 9.99943 31.4215 10.3981 31.9346 10.961 32.005 C 11.0042 32.0083 11.0468 32.0116 11.0897 32.0116 C 11.6 32.0116 12.0421 31.6318 12.1071 31.1123 L 13.2021 22.3524 C 13.2186 22.2352 13.2087 22.1171 13.1856 22.0021 L 10.9956 12.1472 C 10.9566 11.9726 10.8728 11.8106 10.7524 11.6784 L 4.95135 5.31067 C 4.72002 4.99849 4.46804 4.70499 4.19869 4.43304 L 9.32498 6.63014 L 14.5198 13.9027 L 15.5676 18.0936 C 15.6841 18.5601 16.1027 18.8714 16.5626 18.8714 C 16.6451 18.8714 16.729 18.8648 16.8124 18.8364 C 17.3625 18.6988 17.6969 18.1415 17.5594 17.5914 L 16.4644 13.2114 C 16.4294 13.0867 16.3789 12.9686 16.3037 12.8639 L 10.8287 5.199 C 10.7198 5.04621 10.5707 4.92609 10.3981 4.85187 L 4.77501 2.44211 L 8.89863 2.44211 C 9.20289 2.44211 9.49223 2.30681 9.68729 2.07245 L 14.9959 -4.29806 L 25.7048 -8.58156 C 26.2309 -8.7921 26.4871 -9.38969 26.2765 -9.91604 Z M 3.32851 6.55639 C 3.33511 6.56299 3.34831 6.57949 3.35491 6.59533 C 3.44038 6.71413 3.52189 6.83623 3.6001 6.9615 L -3.31728 6.9615 C -3.2394 6.83643 -3.15723 6.71433 -3.07209 6.59533 C -3.06549 6.58873 -3.05229 6.57223 -3.04569 6.55639 C -2.22788 5.4365 -1.08892 4.63183 0.141308 4.63183 C 1.37151 4.63183 2.51044 5.43634 3.32825 6.55639 Z M -4.30682 10.1751 C -4.30682 9.7961 -4.25897 9.40383 -4.16987 9.01166 L 4.45319 9.01166 C 4.54229 9.4036 4.59014 9.79583 4.59014 10.1751 C 4.59014 10.5284 4.5512 10.9222 4.47728 11.3385 L -4.19435 11.3385 C -4.26695 10.9222 -4.30655 10.5285 -4.30655 10.1751 Z M 1.30499 -0.774814 L 1.30499 2.50003 L 1.30499 2.50663 L 1.30499 2.71651 C 0.928325 2.62543 0.540278 2.57461 0.141572 2.57461 C -0.257068 2.57461 -0.645313 2.62543 -1.02187 2.71651 L -1.02187 2.50663 L -1.02187 2.50003 L -1.02187 -0.774814 C -1.02187 -1.4163 -0.499981 -1.93823 0.141572 -1.93823 C 0.783092 -1.93823 1.30499 -1.41623 1.30499 -0.774814 Z M 0.141572 17.9085 C -1.29768 17.9085 -2.79123 15.6796 -3.62943 13.3916 L 3.91268 13.3916 C 3.07435 15.6796 1.58077 17.9085 0.141572 17.9085 Z"],["d","M 21.8842 2.21077 L 18.0181 2.21077 L 13.0729 -0.756106 C 12.911 -0.853707 12.7271 -0.904573 12.5381 -0.904573 L 6.18206 -0.904573 C 6.26409 -1.2402 6.30742 -1.58751 6.30742 -1.94298 C 6.30742 -2.35345 6.24815 -2.75236 6.13972 -3.13557 L 10.6647 -4.04062 C 10.9348 -4.09355 11.1726 -4.25344 11.3252 -4.48199 L 15.2411 -10.3555 L 20.0108 -11.3098 C 20.2808 -11.3628 20.5186 -11.5227 20.6712 -11.7512 L 22.7482 -14.8665 C 23.067 -15.3442 22.9382 -15.9892 22.4605 -16.3069 C 21.9817 -16.6267 21.3378 -16.4959 21.0201 -16.0192 L 19.181 -13.2611 L 14.4113 -12.3067 C 14.1413 -12.2538 13.9035 -12.0939 13.7509 -11.8653 L 9.83492 -5.99184 L 5.07504 -5.03946 C 4.8146 -5.33056 4.51767 -5.59756 4.1913 -5.83727 C 6.07121 -6.88908 7.3457 -8.89921 7.3457 -11.2028 L 7.3457 -13.4521 C 7.3457 -13.6801 7.33217 -13.9049 7.30798 -14.1266 C 7.3256 -14.1905 7.33742 -14.257 7.34266 -14.3255 C 7.34788 -14.3889 7.864 -20.6352 11.4996 -20.6352 C 17.0843 -20.6352 17.7053 -29.5377 17.7282 -29.9168 C 17.7635 -30.489 17.3284 -30.9813 16.7572 -31.0175 C 16.1861 -31.057 15.6907 -30.6188 15.6554 -30.0456 C 15.6502 -29.9729 15.0967 -22.7121 11.4996 -22.7121 C 8.14265 -22.7121 6.5767 -19.8132 5.85813 -17.4544 C 5.37949 -18.0105 4.80424 -18.4808 4.15721 -18.8374 C 4.84539 -19.5678 5.26657 -20.5387 5.26462 -21.5875 C 5.28337 -21.8035 5.40896 -23.7278 4.30508 -24.9262 C 3.76306 -25.516 3.01841 -25.8275 2.15341 -25.8275 C 1.57915 -25.8275 1.11501 -25.3623 1.11501 -24.7892 C 1.11501 -24.216 1.57915 -23.7508 2.15341 -23.7508 C 2.51691 -23.7508 2.67681 -23.6282 2.77551 -23.5223 C 3.19194 -23.0727 3.21786 -22.0716 3.19194 -21.6739 C 3.19194 -20.5286 2.2605 -19.597 1.11501 -19.597 L -0.96193 -19.597 C -2.1073 -19.597 -3.03886 -20.5284 -3.043 -21.7601 C -3.07306 -22.135 -3.01185 -23.0986 -2.6245 -23.5203 C -2.52581 -23.6272 -2.3659 -23.7508 -2.00034 -23.7508 C -1.42607 -23.7508 -0.96193 -24.216 -0.96193 -24.7892 C -0.96193 -25.3623 -1.42607 -25.8275 -2.00034 -25.8275 C -2.86533 -25.8275 -3.60997 -25.516 -4.15199 -24.9262 C -5.25588 -23.7279 -5.13015 -21.8035 -5.11569 -21.6738 C -5.11569 -20.5799 -4.69026 -19.5842 -3.99683 -18.8416 C -4.6468 -18.4846 -5.22446 -18.0128 -5.70491 -17.4546 C -6.42352 -19.8137 -7.98933 -22.7127 -11.3464 -22.7127 C -14.9311 -22.7127 -15.4971 -29.9735 -15.5022 -30.0462 C -15.5386 -30.6193 -16.0442 -31.0587 -16.605 -31.0172 C -17.1761 -30.9808 -17.6102 -30.4887 -17.5749 -29.9164 C -17.552 -29.5374 -16.931 -20.6359 -11.3463 -20.6359 C -7.72626 -20.6359 -7.19456 -14.3876 -7.18935 -14.3253 C -7.18397 -14.257 -7.17219 -14.1909 -7.15466 -14.1274 C -7.17899 -13.9057 -7.19248 -13.6806 -7.19248 -13.4525 L -7.19248 -11.2032 C -7.19248 -8.8997 -5.91799 -6.88944 -4.03808 -5.83763 C -4.36448 -5.59792 -4.66142 -5.33105 -4.92182 -5.03983 L -9.68174 -5.99221 L -13.5977 -11.8657 C -13.7503 -12.0941 -13.9881 -12.254 -14.2581 -12.3071 L -19.0278 -13.2614 L -20.8669 -16.0196 C -21.1846 -16.4963 -21.8295 -16.6271 -22.3073 -16.3073 C -22.7849 -15.9895 -22.9138 -15.3447 -22.5949 -14.8669 L -20.518 -11.7516 C -20.3654 -11.5231 -20.1275 -11.3633 -19.8576 -11.3102 L -15.0879 -10.3559 L -11.172 -4.48236 C -11.0194 -4.25393 -10.7816 -4.09401 -10.5116 -4.04098 L -5.98653 -3.13594 C -6.09507 -2.75272 -6.1542 -2.35382 -6.1542 -1.94335 C -6.1542 -1.58776 -6.11087 -1.24057 -6.02887 -0.904939 L -12.3849 -0.904939 C -12.5739 -0.904939 -12.7576 -0.85407 -12.9197 -0.756472 L -17.8648 2.21041 L -21.7311 2.21041 C -22.3053 2.21041 -22.7695 2.67564 -22.7695 3.24881 C -22.7695 3.82199 -22.3053 4.28723 -21.7311 4.28723 L -17.5773 4.28723 C -17.3883 4.28723 -17.2045 4.23634 -17.0425 4.13876 L -12.0973 1.17188 L -5.11579 1.17188 C -5.04949 1.17188 -4.98475 1.16506 -4.92182 1.15314 C -4.41144 1.72375 -3.76306 2.20335 -3.01939 2.55979 C -3.67679 3.29481 -4.07738 4.26409 -4.07738 5.32574 L -4.07738 5.72187 L -13.8876 10.627 C -14.1752 10.7713 -14.3787 11.0381 -14.441 11.3529 L -17.495 26.6212 L -20.3882 29.5143 C -20.7943 29.9204 -20.7943 30.5767 -20.3882 30.9827 C -20.1857 31.1852 -19.9198 31.2869 -19.654 31.2869 C -19.3881 31.2869 -19.1223 31.1852 -18.9198 30.9827 L -15.8045 27.8673 C -15.6591 27.7219 -15.5614 27.5381 -15.5209 27.3366 L -12.5043 12.2584 L -4.07728 8.04487 L -4.07728 8.44097 C -4.07728 9.47136 -3.69953 10.4145 -3.07635 11.1411 C -6.09774 12.3855 -8.23116 15.3606 -8.23116 18.8254 L -8.23116 22.9792 C -8.23116 27.5598 -4.50417 31.2868 0.0764775 31.2868 C 4.65712 31.2868 8.38411 27.5598 8.38411 22.9792 L 8.38411 18.8254 C 8.38411 15.3604 6.25083 12.3854 3.2293 11.1411 C 3.85249 10.4145 4.23024 9.47136 4.23024 8.44097 L 4.23024 8.04487 L 12.6572 12.2584 L 15.6739 27.3366 C 15.7144 27.538 15.812 27.7219 15.9574 27.8673 L 19.0728 30.9827 C 19.2753 31.1852 19.5412 31.2869 19.807 31.2869 C 20.0728 31.2869 20.3386 31.1852 20.5411 30.9827 C 20.9471 30.5767 20.9471 29.9203 20.5411 29.5143 L 17.648 26.6212 L 14.5939 11.3529 C 14.5315 11.0381 14.328 10.7713 14.0404 10.627 L 4.23024 5.72187 L 4.23024 5.32574 C 4.23024 4.26409 3.82962 3.29481 3.17223 2.55979 C 3.91601 2.20335 4.56426 1.72388 5.07464 1.15314 C 5.13757 1.16506 5.20219 1.17188 5.26865 1.17188 L 12.2502 1.17188 L 17.1953 4.13876 C 17.3573 4.23634 17.5411 4.28723 17.7301 4.28723 L 21.8839 4.28723 C 22.4581 4.28723 22.9223 3.82199 22.9223 3.24881 C 22.9223 2.67564 22.4585 2.21077 21.8842 2.21077 Z M -1.04894 -7.13526 C -3.29089 -7.13526 -5.11556 -8.9598 -5.11556 -11.2028 L -5.11556 -13.4521 C -5.11556 -15.6952 -3.29101 -17.5197 -1.04894 -17.5197 L 1.20238 -17.5197 C 3.44434 -17.5197 5.26901 -15.6952 5.26901 -13.4521 L 5.26901 -11.2028 C 5.26901 -8.9598 3.44444 -7.13526 1.20238 -7.13526 Z M 6.30752 18.8259 L 6.30752 22.9796 C 6.30752 26.4159 3.51308 29.2103 0.0768428 29.2103 C -3.3594 29.2103 -6.15384 26.4159 -6.15384 22.9796 L -6.15384 18.8259 C -6.15384 15.3896 -3.3594 12.5952 0.0768428 12.5952 C 3.51308 12.5952 6.30752 15.3896 6.30752 18.8259 Z M 2.15366 5.3261 L 2.15366 6.39593 L 2.15366 6.39956 L 2.15366 8.44147 C 2.15366 9.58683 1.22222 10.5184 0.076721 10.5184 C -1.06878 10.5184 -2.00022 9.58696 -2.00022 8.44147 L -2.00022 6.39956 L -2.00022 6.39593 L -2.00022 5.3261 C -2.00022 4.18074 -1.06878 3.24918 0.076721 3.24918 C 1.22222 3.24918 2.15366 4.18074 2.15366 5.3261 Z M 0.0768428 1.17236 C -2.21403 1.17236 -4.07692 -0.225404 -4.07692 -1.94298 C -4.07692 -3.66056 -2.21391 -5.05834 0.0768428 -5.05834 C 2.36759 -5.05834 4.2306 -3.66056 4.2306 -1.94298 C 4.2306 -0.225404 2.36759 1.17236 0.0768428 1.17236 Z"]],template:function(e,r){1&e&&(F(),b(0,"g"),Q(1,"polygon",0)(2,"polygon",1)(3,"polygon",2)(4,"polygon",3),b(5,"g"),x(6,w6t,1,0,"path",4),x(7,b6t,1,0,"path",5),x(8,O6t,1,0,"path",6),x(9,N6t,1,0,"path",7),x(10,A6t,1,0,"path",8),O()()),2&e&&(D("transform",r.layerTransform),S(1),T("ngClass",r.pieceClass),D("points",r.isoPointsLight),S(1),T("ngClass",r.pieceClass),D("points",r.isoPointsDark),S(1),D("points",r.isoPointsStroke),S(1),T("ngClass",r.pieceClass),D("points",r.hexaPoints),S(1),D("transform","translate("+r.hexaCenter.x+" "+r.hexaCenter.y+")"),S(1),T("ngIf","QueenBee"===r.piece.kind),S(1),T("ngIf","Beetle"===r.piece.kind),S(1),T("ngIf","Grasshopper"===r.piece.kind),S(1),T("ngIf","Spider"===r.piece.kind),S(1),T("ngIf","SoldierAnt"===r.piece.kind))},dependencies:[dn,en],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();function x6t(n,t){if(1&n){const e=Oe();F(),b(0,"g")(1,"polygon",4),ee("click",function(){const i=he(e).$implicit;return le(v().selectSpace(i.x,i.y))}),O()()}if(2&n){const e=t.$implicit,r=v();S(1),We("id","space_",e.x,"_",e.y,""),T("ngClass",e.content.spaceClasses),D("points",r.getHexaPointsAtXY(e.x,e.y))}}function k6t(n,t){if(1&n){const e=Oe();F(),b(0,"polygon",6),ee("click",function(){he(e);const s=v().$implicit;return le(v().selectSpace(s.x,s.y))}),O()}if(2&n){const e=v().$implicit,r=v();We("id","stroke_",e.x,"_",e.y,""),T("ngClass",e.content.strokeClasses),D("points",r.getHexaPointsAtXY(e.x,e.y))}}function L6t(n,t){if(1&n&&(F(),b(0,"g"),x(1,k6t,1,4,"polygon",5),O()),2&n){const e=t.$implicit;S(1),T("ngIf",e.content.strokeClasses.length>0)}}function R6t(n,t){if(1&n){const e=Oe();F(),b(0,"polygon",8),ee("click",function(){he(e);const s=v().$implicit;return le(v().selectSpace(s.x,s.y))}),O()}if(2&n){const e=v().$implicit,r=v();We("id","stroke_",e.x,"_",e.y,""),D("points",r.getHexaPointsAtXY(e.x,e.y))}}function D6t(n,t){if(1&n&&(F(),b(0,"g"),x(1,R6t,1,3,"polygon",7),O()),2&n){const e=t.$implicit;S(1),T("ngIf",e.content.selected)}}function z6t(n,t){if(1&n){const e=Oe();F(),b(0,"g")(1,"g",9),ee("click",function(){const i=he(e).$implicit;return le(v(2).selectStack(i.x,i.y))}),O()()}if(2&n){const e=t.$implicit,r=v().index,s=v();S(1),We("id","piece_",e.x,"_",e.y,""),T("piece",e.content.piece)("x",e.x)("y",e.y)("pieceHeight",s.PIECE_HEIGHT)("hexaLayout",s.hexaLayout)("layer",r)}}function V6t(n,t){if(1&n){const e=Oe();F(),b(0,"polygon",6),ee("click",function(){he(e);const s=v().$implicit;return le(v(2).selectStack(s.x,s.y))}),O()}if(2&n){const e=v().$implicit,r=v().index,s=v();We("id","stroke_",e.x,"_",e.y,""),T("ngClass",e.content.strokeClasses),D("transform","translate(0 "+-(r+1)*s.PIECE_HEIGHT+")")("points",s.getHexaPointsAtXY(e.x,e.y))}}function H6t(n,t){if(1&n&&(F(),b(0,"g"),x(1,V6t,1,5,"polygon",5),O()),2&n){const e=t.$implicit;S(1),T("ngIf",e.content.strokeClasses.length>0)}}function F6t(n,t){if(1&n&&(F(),b(0,"g"),x(1,z6t,2,8,"g",1),x(2,H6t,2,1,"g",1),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e),S(1),T("ngForOf",e)}}function B6t(n,t){if(1&n){const e=Oe();F(),b(0,"g")(1,"g",10),ee("click",function(){const i=he(e).$implicit;return le(v(2).selectRemaining(i))}),O()()}if(2&n){const e=t.$implicit,r=t.index,s=v(2);S(1),y1("id","remainingPiece_",e.toString(),""),T("piece",e)("pieceHeight",s.PIECE_HEIGHT)("x",0)("y",0)("layer",r)("hexaLayout",s.hexaLayout),D("transform",s.getRemainingPieceTransform(e))}}function $6t(n,t){if(1&n&&(F(),b(0,"g"),x(1,B6t,2,8,"g",1),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e.pieces)}}function U6t(n,t){if(1&n&&(F(),Q(0,"polygon",11)),2&n){const e=v();D("transform",e.getRemainingPieceHighlightTransform(e.selectedRemaining.get()))("points",e.getHexaPointsAt(e.ORIGIN))}}function G6t(n,t){if(1&n&&(F(),Q(0,"g",13)),2&n){const e=t.$implicit,r=t.index,s=v(2);y1("id","inspectedStack_",r,""),T("piece",e)("pieceHeight",s.PIECE_HEIGHT)("x",0)("y",0)("hexaLayout",s.hexaLayout)("layer",6*r),D("transform",s.inspectedStackTransform)}}function W6t(n,t){if(1&n&&(F(),b(0,"g"),x(1,G6t,1,8,"g",12),O()),2&n){const e=v();S(1),T("ngForOf",e.inspectedStack.get().pieces.slice().reverse())}}class d3e extends wte{constructor(){super(...arguments),this.highlighted=[]}initialize(t){this.set(t,{spaceClasses:[],strokeClasses:[],selected:!1})}highlightFill(t,e){this.highlighted.push(t),this.get(t).map(r=>r.spaceClasses.push(e))}highlightStroke(t,e){this.highlighted.push(t),this.get(t).map(r=>r.strokeClasses.push(e))}select(t){this.highlighted.push(t),this.get(t).map(e=>e.selected=!0)}clearHighlights(){for(const t of this.highlighted)this.get(t).map(e=>{e.strokeClasses=[],e.spaceClasses=[],e.selected=!1});this.highlighted=[]}}class q6t extends wte{constructor(){super(...arguments),this.highlighted=[]}initialize(t,e){this.set(t,{piece:e,strokeClasses:[]})}highlight(t,e){this.highlighted.push(t),this.get(t).map(r=>r.strokeClasses.push(e))}clearHighlights(){for(const t of this.highlighted)this.get(t).map(e=>{e.strokeClasses=[]});this.highlighted=[]}}let j6t=(()=>{class n extends y9{constructor(e){super(e),this.ORIGIN=new M(0,0),this.remainingStacks=[],this.layers=[],this.ground=new d3e,this.inspectedStack=P.empty(),this.inspectedStackCoord=P.empty(),this.selectedRemaining=P.empty(),this.selectedStart=P.empty(),this.selectedSpiderCoords=[],this.rules=Pi.get(),this.availableMinimaxes=[new P6t(this.rules,"HiveMinimax")],this.encoder=Si.encoder,this.tutorial=(new h3e).tutorial,this.SPACE_SIZE=30,this.PIECE_HEIGHT=this.SPACE_SIZE/3,this.hexaLayout=new E9(1.5*this.SPACE_SIZE,new M(2*this.SPACE_SIZE,0),As.INSTANCE),this.canPass=!1,this.updateBoard()}updateBoard(){this.cancelMoveAttempt(),this.layers=[];for(const r of this.getState().occupiedSpaces()){const s=this.getState().getAt(r),i=r.x,o=r.y;for(let c=0;c<s.size();c++){c in this.layers||(this.layers[c]=new q6t);const u=s.pieces[s.size()-1-c];this.layers[c].initialize(new M(i,o),u)}}this.ground=this.getGround(),this.computeViewBox(),this.remainingStacks=this.getState().remainingPieces.toListOfStacks(),this.canPass=Pi.get().shouldPass(this.getState());const e=Pi.get().getGameStatus(this.rules.node);switch(e){case xe.ONGOING:break;case xe.DRAW:this.highlight(this.getState().queenBeeLocation(z.ZERO).get(),"victory-stroke"),this.highlight(this.getState().queenBeeLocation(z.ONE).get(),"victory-stroke");break;default:const s=e.winner.getOpponent();this.highlight(this.getState().queenBeeLocation(s).get(),"victory-stroke")}this.rules.node.move.isPresent()&&this.showLastMove()}highlight(e,r){const s=this.getState().getAt(e).size();s-1 in this.layers&&this.layers[s-1].highlight(e,r)}pass(){var e=this;return A(function*(){return Me.assert(e.canPass,"DvonnComponent: pass() can only be called if canPass is true"),yield e.chooseMove(Si.PASS,e.getState())})()}computeViewBox(){const e=this.getPieceCoords().union(this.getAllNeighbors()).toList();e.push(new M(0,0)),this.boardViewBox=f6.fromHexa(e,this.hexaLayout,this.STROKE_WIDTH);const r=new f6(this.getRemainingPieceTransformAsCoord(new Qs(z.ZERO,"QueenBee")).x,0,4*this.SPACE_SIZE*5,0),s=5*this.SPACE_SIZE;let i=0;this.getState().remainingPieces.getAny(z.ZERO).isPresent()&&(i=s);let o=0;this.getState().remainingPieces.getAny(z.ONE).isPresent()&&(o=s);const c=this.boardViewBox.containingAtLeast(r).expand(0,0,i,o);if(this.inspectedStack.isPresent()){const u=new M(c.right()+this.SPACE_SIZE,c.center().y),h=this.inspectedStack.get().size();this.inspectedStackTransform=`translate(${u.x} ${u.y+3*(h-1)*this.PIECE_HEIGHT})`,this.viewBox=c.expand(0,5*this.SPACE_SIZE,0,0).toSVGString()}else this.viewBox=c.toSVGString()}getPieceCoords(){return this.getState().pieces.getKeySet()}getGround(){const e=new d3e;for(const r of this.getAllNeighbors())e.initialize(r);return e}getAllNeighbors(){const e=new Dt;for(const r of this.getPieceCoords())e.addAll(new Dt(this.getState().emptyNeighbors(r)));return e.isEmpty()&&e.add(new M(0,0)),e}clearHighlights(){for(const e of this.layers)e.clearHighlights();this.ground.clearHighlights()}cancelMoveAttempt(){this.clearHighlights(),this.selectedStart=P.empty(),this.selectedRemaining=P.empty(),this.selectedSpiderCoords=[],this.inspectedStack=P.empty(),this.rules.node.move.isPresent()&&this.showLastMove(),this.computeViewBox()}showLastMove(){for(const e of this.getLastMoveCoords())this.highlight(e,"last-move-stroke"),this.ground.highlightStroke(e,"last-move-stroke"),this.ground.highlightFill(e,"moved-fill")}getLastMoveCoords(){const e=this.rules.node.move.get();let r=[];e instanceof Ja?r=[e.coord]:e instanceof x2&&(r=[e.getStart(),e.getEnd()]);const s=this.getState().offset;return r.map(i=>i.getNext(s))}getRemainingPieceTransformAsCoord(e){const r=this.getRemainingPieceShift(e),s=this.boardViewBox.center().x+r*this.SPACE_SIZE*4;let i;return i=e.owner===this.role?this.boardViewBox.bottom()+3*this.SPACE_SIZE:this.boardViewBox.up-2*this.SPACE_SIZE,new M(s,i)}getRemainingPieceTransform(e){const r=this.getRemainingPieceTransformAsCoord(e);return`translate(${r.x} ${r.y})`}getRemainingPieceHighlightTransform(e){const r=this.getRemainingPieceTransformAsCoord(e),s=this.getState().remainingPieces.getQuantity(e);return`translate(${r.x} ${r.y-this.PIECE_HEIGHT*s})`}getRemainingPieceShift(e){switch(e.kind){case"QueenBee":return-2.5;case"Beetle":return-1.5;case"Grasshopper":return-.5;case"Spider":return.5;default:return Me.expectToBe(e.kind,"SoldierAnt"),1.5}}selectRemaining(e){var r=this;return A(function*(){const s=r.canUserPlay(`#remainingPiece_${e.toString()}`);if(s.isFailure())return r.cancelMove(s.getReason());if(e.owner===r.getCurrentPlayer().getOpponent())return r.cancelMove(tt.MUST_CHOOSE_PLAYER_PIECE());if("QueenBee"!==e.kind&&Pi.get().mustPlaceQueenBee(r.getState()))return r.cancelMove(ns.MUST_PLACE_QUEEN_BEE_LATEST_AT_FOURTH_TURN());if(r.selectedRemaining.equalsValue(e))r.cancelMoveAttempt();else{r.cancelMoveAttempt(),r.selectedRemaining=P.of(e),r.clearHighlights();const i=Pi.get().getPossibleDropLocations(r.getState()).toList();for(const o of i)r.ground.highlightStroke(o,"clickable-stroke")}return G.SUCCESS})()}selectStack(e,r){return this.select(new M(e,r),"piece")}selectSpace(e,r){return this.select(new M(e,r),"space")}select(e,r){var s=this;return A(function*(){const i=s.canUserPlay(`#${r}_${e.x}_${e.y}`);if(i.isFailure())return s.cancelMove(i.getReason());const o=s.getState(),c=o.getAt(e);if(s.selectedRemaining.isPresent()){const u=Si.drop(s.selectedRemaining.get(),e);return s.chooseMove(u,o)}if(s.selectedStart.isPresent()){const u=o.getAt(s.selectedStart.get()).topPiece();return s.selectedStart.equalsValue(e)?s.cancelMove():s.selectTarget(e,u)}return 0===c.size()?s.cancelMove():s.selectStart(e,c)})()}selectTarget(e,r){var s=this;return A(function*(){if("Spider"===r.kind)return s.selectNextSpiderSpace(e);{const i=Si.move(s.selectedStart.get(),e);return ve(i.isSuccess(),"Hive: the only forbidden moves are static moves"),s.chooseMove(i.get(),s.getState())}})()}selectStart(e,r){var s=this;return A(function*(){const i=s.getState(),o=r.topPiece();return o.owner===i.getCurrentPlayer().getOpponent()?1===r.size()?s.cancelMove(tt.MUST_CHOOSE_PLAYER_PIECE()):s.inspectedStack.isPresent()?(s.cancelMoveAttempt(),s.clearHighlights(),G.SUCCESS):(s.highlight(e,"selected-stroke"),s.inspectedStack=P.of(r),s.inspectedStackCoord=P.of(e),s.computeViewBox(),G.SUCCESS):(s.cancelMoveAttempt(),s.clearHighlights(),"QueenBee"!==o.kind&&Pi.get().mustPlaceQueenBee(i)?s.cancelMove(ns.MUST_PLACE_QUEEN_BEE_LATEST_AT_FOURTH_TURN()):(s.selectedStart=P.of(e),s.highlight(e,"selected-stroke"),"Spider"===o.kind&&s.selectedSpiderCoords.push(s.selectedStart.get()),r.size()>1&&(s.inspectedStack=P.of(r),s.inspectedStackCoord=P.of(e),s.computeViewBox()),s.highlightNextPossibleCoords(e),G.SUCCESS))})()}highlightNextPossibleCoords(e){for(const r of this.getNextPossibleCoords(e))this.highlight(r,"clickable-stroke"),this.ground.highlightStroke(r,"clickable-stroke")}getNextPossibleCoords(e){const r=this.getState(),s=r.getAt(e).topPiece(),i=Pi.get().getPossibleMovesFrom(r,e);return"Spider"===s.kind?i.filter(c=>Ke.isPrefix(this.selectedSpiderCoords,c.coords)).map(c=>c.coords[this.selectedSpiderCoords.length]).toList():i.map(o=>o.getEnd()).toList()}selectNextSpiderSpace(e){var r=this;return A(function*(){if(r.selectedSpiderCoords.push(e),4===r.selectedSpiderCoords.length){const i=Si.spiderMove(r.selectedSpiderCoords);return r.chooseMove(i,r.getState())}const s=Gm.get().prefixLegality(r.selectedSpiderCoords,r.getState());if(s.isFailure())return r.cancelMove(s.getReason());r.clearHighlights(),r.highlight(r.selectedStart.get(),"selected-stroke");for(const i of r.selectedSpiderCoords)r.ground.select(i);return r.highlightNextPossibleCoords(r.selectedStart.get()),G.SUCCESS})()}}return n.\u0275fac=function(e){return new(e||n)(J(Pn))},n.\u0275cmp=gt({type:n,selectors:[["app-hive"]],features:[l],decls:8,vars:8,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["id","remaining_highlight","class","base no-fill small-stroke selected-stroke",4,"ngIf"],[4,"ngIf"],[1,"base","mid-stroke",3,"id","ngClass","click"],["class","base no-fill small-stroke",3,"id","ngClass","click",4,"ngIf"],[1,"base","no-fill","small-stroke",3,"id","ngClass","click"],["class","base no-fill small-stroke","ngClass","selected-stroke",3,"id","click",4,"ngIf"],["ngClass","selected-stroke",1,"base","no-fill","small-stroke",3,"id","click"],["app-hive-piece","",3,"id","piece","x","y","pieceHeight","hexaLayout","layer","click"],["app-hive-piece","",3,"id","piece","pieceHeight","x","y","layer","hexaLayout","click"],["id","remaining_highlight",1,"base","no-fill","small-stroke","selected-stroke"],["app-hive-piece","",3,"id","piece","pieceHeight","x","y","hexaLayout","layer",4,"ngFor","ngForOf"],["app-hive-piece","",3,"id","piece","pieceHeight","x","y","hexaLayout","layer"]],template:function(e,r){1&e&&(F(),b(0,"svg",0),x(1,x6t,2,4,"g",1),x(2,L6t,2,1,"g",1),x(3,D6t,2,1,"g",1),x(4,F6t,3,2,"g",1),x(5,$6t,2,1,"g",1),x(6,U6t,1,2,"polygon",2),x(7,W6t,2,1,"g",3),O()),2&e&&(D("viewBox",r.viewBox),S(1),T("ngForOf",r.ground),S(1),T("ngForOf",r.ground),S(1),T("ngForOf",r.ground),S(1),T("ngForOf",r.layers),S(1),T("ngForOf",r.remainingStacks),S(1),T("ngIf",r.selectedRemaining.isPresent()),S(1),T("ngIf",r.inspectedStack.isPresent()))},dependencies:[dn,An,en,I6t],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();const Z6t={CASTLE_IS_LEFT_FOR_GOOD:!1,BORDER_CAN_SURROUND_KING:!0,CENTRAL_THRONE_CAN_SURROUND_KING:!1,KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED:!1,WIDTH:11,INVADER:z.ZERO};class H3 extends SH{static getInitialState(){const t=En.UNOCCUPIED,e=En.INVADERS,r=En.DEFENDERS;return new H3([[t,t,t,e,e,e,e,e,t,t,t],[t,t,t,t,t,e,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t],[e,t,t,t,t,r,t,t,t,t,e],[e,t,t,t,r,r,r,t,t,t,e],[e,e,t,r,r,En.PLAYER_ONE_KING,r,r,t,e,e],[e,t,t,t,r,r,r,t,t,t,e],[e,t,t,t,t,r,t,t,t,t,e],[t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,e,t,t,t,t,t],[t,t,t,e,e,e,e,e,t,t,t]],0)}from(t,e){return new H3(t,e)}}class Ro extends MH{static of(t,e){return new Ro(t,e)}static from(t,e){try{const r=new Ro(t,e);return U.success(r)}catch(r){return U.failure(r.message)}}getMaximalDistance(){return 11}}Ro.encoder=Lc.getEncoder(Ro.from);class w5 extends PH{constructor(){super(H3,Z6t,Ro.of)}static get(){return null==w5.singleton&&(w5.singleton=new w5),$1.ruler=this.singleton,w5.singleton}}const R=En.UNOCCUPIED,Yt=En.INVADERS,rs=En.DEFENDERS,IP=En.PLAYER_ONE_KING;class p3e extends K1{constructor(){super(...arguments),this.tutorial=[ce.informational($localize`Goal of the game`,$localize`Hnefatafl is a strategy game that was played by the vikings, it's part of a larger family of games called Tafl. The goal of the game is different for each player. The attacker plays first. Their pieces (dark) are close to the edges. Their goal is to capture the king, which is in the center of the board. The defender plays second. Their pieces (light) are in the middle. Their goal is to move the king on one of the 4 thrones in the corners. Note that the square in which the king starts, in the center of the board, is also a throne.`,H3.getInitialState()),ce.anyMove($localize`Moving`,$localize`All pieces move the same way. Similarly to a rook in chess, a piece can move:<ol><li>By as many squares as you want.</li><li>Without going over another piece or stopping on another piece.</li><li>Horizontally or vertically.</li><li>Only the king can land on a throne.</li></ol>To move a piece, click on it and then on its landing square.<br/><br/>You're playing Dark, do the first move.`,H3.getInitialState(),Ro.of(new M(5,1),new M(1,1)),$localize`Congratulations!`),ce.fromMove($localize`Capturing a soldier (1/2)`,$localize`All pieces, attackers and defenders, except the king, are soldiers. To capture them, they have to be sandwiched between two of your pieces. By getting too close, an attacker's soldier is in danger.<br/><br/>You're playing Light. Capture the soldier.`,new H3([[R,R,R,R,Yt,Yt,Yt,Yt,R,R,R],[R,R,R,R,R,Yt,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R],[Yt,R,R,R,R,rs,R,R,R,R,Yt],[Yt,R,R,Yt,rs,rs,rs,R,R,R,Yt],[Yt,Yt,R,rs,rs,IP,rs,rs,R,Yt,Yt],[Yt,R,R,R,rs,rs,rs,R,R,R,Yt],[Yt,R,R,R,R,rs,R,R,R,R,Yt],[R,R,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,Yt,R,R,R,R,R],[R,R,R,Yt,Yt,Yt,Yt,Yt,R,R,R]],1),[Ro.of(new M(5,3),new M(3,3))],$localize`Congratulations, that will teach him a lesson!`,$localize`Failed, you missed an opportunity to capture a piece of the opponent.`).withPreviousMove(Ro.of(new M(3,0),new M(3,4))).withPreviousState(H3.getInitialState()),ce.fromMove($localize`Capturing a soldier (2/2)`,$localize`A second way to capture a soldier is to sandwich it against an empty throne. The king has moved and endangered one of its soldiers.<br/><br/>You're playing Dark. Capture the soldier.`,new H3([[R,R,R,Yt,Yt,Yt,Yt,Yt,R,R,R],[R,rs,R,R,R,Yt,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,rs,R,R,R,R,Yt],[Yt,R,R,R,R,rs,rs,R,R,R,Yt],[Yt,Yt,IP,R,rs,R,rs,rs,R,R,Yt],[R,R,Yt,R,R,rs,rs,R,R,R,Yt],[Yt,R,R,R,R,rs,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R],[R,Yt,R,R,R,R,R,R,R,R,R],[R,R,R,Yt,Yt,Yt,Yt,R,Yt,R,R]],12),[Ro.of(new M(3,0),new M(3,5)),Ro.of(new M(3,10),new M(3,5))],$localize`Congratulations, one less defender. But keep an eye on the king, it is the most important.`,$localize`Failed, you did not do the expected move.`),ce.fromMove($localize`Capturing the king (1/2)`,$localize`To capture the king, two soldiers are not enough. For the first solution, the four squares neighbor to the king (horizontally and vertically) must be occupied by your soldiers. This also works if the king is on the throne.<br/><br/>You're playing Dark, capture the king.`,new H3([[R,R,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R],[R,Yt,R,R,R,R,R,R,R,R,R],[Yt,IP,R,Yt,R,R,R,R,R,R,R],[R,Yt,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R]],72),[Ro.of(new M(3,4),new M(2,4))],$localize`Congratulations, you won!`,$localize`Failed, you let the king run away.`),ce.fromMove($localize`Capturing the king (2/2)`,$localize`Another way to capture the king is to immobilize it against an edge of the board. Note that the king cannot be captured next to a throne.<br/><br/>You're playing Dark, capture the king.`,new H3([[R,R,Yt,IP,Yt,R,R,R,R,R,R],[R,R,R,R,R,R,rs,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R],[R,R,R,Yt,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R]],72),[Ro.of(new M(3,3),new M(3,1))],$localize`The king is dead, long live the king. Congratulations, you won.`,$localize`Failed. Try again.`)]}}function Y6t(n,t){1&n&&(F(),Q(0,"polygon",8))}function K6t(n,t){1&n&&(F(),Q(0,"rect",9))}function X6t(n,t){if(1&n&&(F(),b(0,"g"),x(1,Y6t,1,0,"polygon",6),x(2,K6t,1,0,"ng-template",null,7,r1),O()),2&n){const e=Qn(3),r=v().index,s=v().index,i=v();S(1),T("ngIf",i.isCentralThrone(r,s))("ngIfElse",e)}}function Q6t(n,t){if(1&n&&(F(),b(0,"g"),Q(1,"line",13)(2,"line",13)(3,"line",13)(4,"line",13)(5,"line",13),O()),2&n){const e=v(2).index,r=v().index,s=v();S(1),T("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.5*s.SPACE_SIZE)("y1",.04*s.SPACE_SIZE)("x2",.5*s.SPACE_SIZE)("y2",.96*s.SPACE_SIZE),S(1),T("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.5*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.1*s.SPACE_SIZE)("y2",.6*s.SPACE_SIZE),S(1),T("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.5*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.9*s.SPACE_SIZE)("y2",.6*s.SPACE_SIZE),S(1),T("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.5*s.SPACE_SIZE)("y1",.4*s.SPACE_SIZE)("x2",.15*s.SPACE_SIZE)("y2",.75*s.SPACE_SIZE),S(1),T("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.5*s.SPACE_SIZE)("y1",.4*s.SPACE_SIZE)("x2",.85*s.SPACE_SIZE)("y2",.75*s.SPACE_SIZE)}}function J6t(n,t){if(1&n&&(F(),Q(0,"polyline",16)),2&n){const e=v(3).index,r=v().index;T("ngClass",v().viewInfo.pieceClasses[r][e])}}function e0t(n,t){if(1&n&&(F(),Q(0,"line",13)(1,"line",13)(2,"line",13)(3,"line",13)),2&n){const e=v(3).index,r=v().index,s=v();T("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.5*s.SPACE_SIZE)("y1",.04*s.SPACE_SIZE)("x2",.5*s.SPACE_SIZE)("y2",.96*s.SPACE_SIZE),S(1),T("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.04*s.SPACE_SIZE)("y1",.5*s.SPACE_SIZE)("x2",.96*s.SPACE_SIZE)("y2",.5*s.SPACE_SIZE),S(1),T("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.2*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.8*s.SPACE_SIZE)("y2",.8*s.SPACE_SIZE),S(1),T("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.8*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.2*s.SPACE_SIZE)("y2",.8*s.SPACE_SIZE)}}function t0t(n,t){if(1&n&&(F(),x(0,J6t,1,1,"polyline",14),x(1,e0t,4,20,"ng-template",null,15,r1)),2&n){const e=Qn(2),r=v(2).index,s=v().index;T("ngIf",v().isKing(r,s))("ngIfElse",e)}}function n0t(n,t){if(1&n&&(F(),b(0,"g"),Q(1,"circle",10),x(2,Q6t,6,25,"g",11),x(3,t0t,3,2,"ng-template",null,12,r1),O()),2&n){const e=Qn(4),r=v().index,s=v().index,i=v();S(1),We("id","piece_",r,"_",s,""),T("ngClass",i.viewInfo.pieceClasses[s][r]),D("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)("cx",.5*i.SPACE_SIZE)("cy",.5*i.SPACE_SIZE),S(1),T("ngIf",i.isInvader(r,s))("ngIfElse",e)}}function r0t(n,t){if(1&n){const e=Oe();F(),b(0,"g",3),ee("click",function(){const i=he(e).index,o=v().index;return le(v().onClick(i,o))}),Q(1,"rect",4),x(2,X6t,4,2,"g",5),x(3,n0t,5,8,"g",5),O()}if(2&n){const e=t.index,r=v().index,s=v();We("id","click_",e,"_",r,""),D("transform","translate("+s.SPACE_SIZE*e+", "+s.SPACE_SIZE*r+")"),S(1),T("ngClass",s.getRectClasses(e,r)),D("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),S(1),T("ngIf",s.board[r][e]===s.EMPTY&&s.isThrone(e,r)),S(1),T("ngIf",s.board[r][e]!==s.EMPTY)}}function s0t(n,t){if(1&n&&(F(),b(0,"g"),x(1,r0t,4,8,"g",2),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e)}}function i0t(n,t){if(1&n){const e=Oe();F(),b(0,"g")(1,"rect",17),ee("click",function(){const i=he(e).$implicit;return le(v().onClick(i.x,i.y))}),O()()}if(2&n){const e=t.$implicit,r=v();S(1),We("id","click_",e.x,"_",e.y,""),D("x",r.SPACE_SIZE*e.x)("y",r.SPACE_SIZE*e.y)("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)}}let o0t=(()=>{class n extends TH{constructor(e){super(e,!1,Ro.from),this.rules=w5.get(),this.availableMinimaxes=[new mP(this.rules,"DummyBot"),new vP(this.rules,"Piece > Influence"),new CP(this.rules,"Piece > Control"),new wH(this.rules,"Escape > Piece > Control")],this.encoder=Ro.encoder,this.tutorial=(new p3e).tutorial}ngOnInit(){this.updateBoard()}}return n.\u0275fac=function(e){return new(e||n)(J(Pn))},n.\u0275cmp=gt({type:n,selectors:[["app-hnefatafl"]],features:[l],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["x","0","y","0",1,"base",3,"ngClass"],[4,"ngIf"],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60","class","base",4,"ngIf","ngIfElse"],["cornerThrone",""],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60",1,"base"],["x","15","y","15","width","70","height","70",1,"base"],[1,"base",3,"id","ngClass"],[4,"ngIf","ngIfElse"],["defender",""],[1,"base",3,"ngClass"],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85","class","base no-fill",3,"ngClass",4,"ngIf","ngIfElse"],["soldierDefender",""],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85",1,"base","no-fill",3,"ngClass"],[1,"no-fill","mid-stroke","clickable-stroke",3,"id","click"]],template:function(e,r){1&e&&(F(),b(0,"svg",0),x(1,s0t,2,1,"g",1),x(2,i0t,2,6,"g",1),O()),2&e&&(D("viewBox",r.getViewBox()),S(1),T("ngForOf",r.board),S(1),T("ngForOf",r.getClickables()))},dependencies:[dn,An,en],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class Sn{constructor(t,e,r){this.value=t,this.name=e,this.rgb=r}static of(t){switch(t){case 0:return Sn.ANY;case 1:return Sn.ORANGE;case 2:return Sn.BLUE;case 3:return Sn.PURPLE;case 4:return Sn.PINK;case 5:return Sn.YELLOW;case 6:return Sn.RED;case 7:return Sn.GREEN;default:return Me.expectToBe(t,8,"Invalid value "+t+" for KamisadoColor"),Sn.BROWN}}}Sn.ANY=new Sn(0,"any","#000"),Sn.ORANGE=new Sn(1,"orange","#d67421"),Sn.BLUE=new Sn(2,"blue","#006bac"),Sn.PURPLE=new Sn(3,"purple","#6f3787"),Sn.PINK=new Sn(4,"pink","#d2719e"),Sn.YELLOW=new Sn(5,"yellow","#e2c200"),Sn.RED=new Sn(6,"red","#d23339"),Sn.GREEN=new Sn(7,"green","#009157"),Sn.BROWN=new Sn(8,"brown","#562500");class Fn{constructor(t,e){this.player=t,this.color=e}static of(t,e){return new Fn(t,Sn.of(e))}static createPlayerColors(t){return{ORANGE:new Fn(t,Sn.ORANGE),BLUE:new Fn(t,Sn.BLUE),PURPLE:new Fn(t,Sn.PURPLE),PINK:new Fn(t,Sn.PINK),YELLOW:new Fn(t,Sn.YELLOW),RED:new Fn(t,Sn.RED),GREEN:new Fn(t,Sn.GREEN),BROWN:new Fn(t,Sn.BROWN)}}equals(t){return t.player===this.player&&t.color===this.color}isEmpty(){return this.player.equals(pe.NONE)}belongsTo(t){return this.player===t}}Fn.EMPTY=new Fn(pe.NONE,Sn.ANY),Fn.ZERO=Fn.createPlayerColors(z.ZERO),Fn.ONE=Fn.createPlayerColors(z.ONE);class Ti{static getColorAt(t,e){return Ti.COLORS[e][t]}static getInitialBoard(){const t=Fn.EMPTY;return[[1,2,3,4,5,6,7,8].map(e=>Fn.of(z.ONE,e)),[t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t],[8,7,6,5,4,3,2,1].map(e=>Fn.of(z.ZERO,e))]}static isEmptyAt(t,e){return t[e.y][e.x].equals(Fn.EMPTY)}static allPieceCoords(t){const e=[];for(let r=0;r<t.length;r++)for(let s=0;s<t[r].length;s++){const i=new M(s,r);Ti.isEmptyAt(t,i)||e.push(i)}return e}}Ti.INITIAL=Ti.getInitialBoard(),Ti.SIZE=8,Ti.COLORS=Ke.mapBiArray([[1,2,3,4,5,6,7,8],[6,1,4,7,2,5,8,3],[7,4,1,6,3,8,5,2],[4,3,2,1,8,7,6,5],[5,6,7,8,1,2,3,4],[2,5,8,3,6,1,4,7],[3,8,5,2,7,4,1,6],[8,7,6,5,4,3,2,1]],Sn.of);class LH extends Gi{constructor(){super()}isPieceMove(){return!1}length(){return 0}equals(t){return this===t}toString(){return"KamisadoMove(PASS)"}}LH.PASS=new LH;class RH extends r8{constructor(t,e){super(t,e)}static of(t,e){if(t.isNotInRange(Ti.SIZE,Ti.SIZE))throw new Error("Starting coord of KamisadoMove must be on the board, not at "+t.toString());if(e.isNotInRange(Ti.SIZE,Ti.SIZE))throw new Error("End coord of KamisadoMove must be on the board, not at "+e.toString());return new RH(t,e)}isPieceMove(){return!0}equals(t){return t===this||!!t.isPieceMove()&&!1!==t.getStart().equals(this.getStart())&&t.getEnd().equals(this.getEnd())}toString(){return"KamisadoMove("+this.getStart()+"->"+this.getEnd()+")"}}var Do;!function(n){n.PASS=LH.PASS,n.of=function t(e,r){return RH.of(e,r)},n.encoder=new class extends Cn{maxValue(){return 34952}encodeNumber(e){return e.isPieceMove()?4096*e.getStart().x+256*e.getStart().y+16*e.getEnd().x+e.getEnd().y:0}decodeNumber(e){if(0===e)return n.PASS;const r=e%16,s=(e=e/16|0)%16,i=(e=e/16|0)%16;return n.of(new M((e=e/16|0)%16,i),new M(s,r))}}}(Do||(Do={}));class F3 extends es{constructor(t,e,r,s,i){super(Ke.copyBiArray(i),t),this.colorToPlay=e,this.coordToPlay=r,this.alreadyPassed=s}static getInitialState(){return new F3(0,Sn.ANY,P.empty(),!1,Ti.INITIAL)}}let jm=(()=>{class n{}return n.NOT_RIGHT_COLOR=()=>$localize`This piece is not of the color you have to play.`,n.DIRECTION_NOT_ALLOWED=()=>$localize`You can only move forward, orthogonally or diagonally.`,n.MOVE_BLOCKED=()=>$localize`This move is blocked by another piece.`,n.PLAY_WITH_SELECTED_PIECE=()=>$localize`You must play with the selected piece.`,n})();class zo extends U1{static getColorMatchingPiece(t){return t.coordToPlay.isPresent()?[t.coordToPlay.get()]:[new M(0,7),new M(1,7),new M(2,7),new M(3,7),new M(4,7),new M(5,7),new M(6,7),new M(7,7)]}static getMovablePieces(t){return zo.getColorMatchingPiece(t).filter(e=>{for(const r of this.playerDirections(t.getCurrentPlayer())){const s=e.getNext(r);if(t.isOnBoard(s)&&Ti.isEmptyAt(t.board,s))return!0}return!1})}static playerDirections(t){return t===z.ONE?[Ne.DOWN,Ne.DOWN_LEFT,Ne.DOWN_RIGHT]:[Ne.UP,Ne.UP_LEFT,Ne.UP_RIGHT]}static directionAllowedForPlayer(t,e){return e===z.ZERO?t.y<0:t.y>0}static getListMovesFromState(t){const e=zo.getMovablePieces(t);return 0===e.length?(ve(!1===t.alreadyPassed,"getListMovesFromState should not be called once game is ended."),[Do.PASS]):zo.getListMovesFromNonBlockedState(t,e)}static getListMovesFromNonBlockedState(t,e){const r=[],s=t.getCurrentPlayer();for(const i of e)for(const o of zo.playerDirections(s))for(let c=1;c<Ti.SIZE;c++){const u=i.getNext(o,c);if(!t.isOnBoard(u)||!Ti.isEmptyAt(t.board,u))break;{const h=Do.of(i,u);r.push(h)}}return r}static mustPass(t){return 0===this.getMovablePieces(t).length}static getFurthestPiecePositions(t){let e=7,r=0;return Ti.allPieceCoords(t.board).forEach(s=>{const i=t.getPieceAt(s);ve(i!==Fn.EMPTY,"allPieceCoords failed to filter KamisadoPiece.EMPTY"),i.player===z.ONE?r=Math.max(r,s.y):e=Math.min(e,s.y)}),[e,r]}static isLegal(t,e){if(t.isPieceMove()){const r=t.getStart(),s=t.getEnd(),i=e.colorToPlay,o=e.getPieceAt(r);if(!o.belongsTo(e.getCurrentPlayer()))return U.failure(tt.MUST_CHOOSE_PLAYER_PIECE());if(i!==Sn.ANY&&o.color!==i)return U.failure(jm.NOT_RIGHT_COLOR());if(!e.getPieceAt(s).isEmpty())return U.failure(tt.MUST_CLICK_ON_EMPTY_SPACE());const u=Ne.factory.fromMove(r,s);if(u.isFailure())return U.failure(jm.DIRECTION_NOT_ALLOWED());const h=u.get();if(!zo.directionAllowedForPlayer(h,e.getCurrentPlayer()))return U.failure(jm.DIRECTION_NOT_ALLOWED());let p=r;for(;!p.equals(s);)if(p=p.getNext(h),!e.getPieceAt(p).isEmpty())return U.failure(jm.MOVE_BLOCKED());return U.success(void 0)}return this.isLegalPass(e)}static isLegalPass(t){return this.mustPass(t)&&!t.alreadyPassed?U.success(void 0):U.failure(tt.CANNOT_PASS())}nextCoordToPlay(t,e){return P.ofNullable(Ti.allPieceCoords(t.board).find(r=>{const s=t.getPieceAt(r);return s.player===t.getCurrentOpponent()&&s.color===e}))}applyLegalMove(t,e,r){if(t.isPieceMove()){const s=t.getStart(),i=t.getEnd(),o=e.getCopiedBoard();o[i.y][i.x]=o[s.y][s.x],o[s.y][s.x]=Fn.EMPTY;const c=Ti.getColorAt(i.x,i.y),u=this.nextCoordToPlay(e,c);return new F3(e.turn+1,c,u,!1,o)}{const s=this.nextCoordToPlay(e,e.colorToPlay);return new F3(e.turn+1,e.colorToPlay,s,!0,e.board)}}isLegal(t,e){return zo.isLegal(t,e)}getGameStatus(t){const e=t.gameState,r=e.getCurrentPlayer();if(zo.mustPass(e)&&e.alreadyPassed)return xe.getDefeat(r);const[s,i]=zo.getFurthestPiecePositions(e);return 7===i?xe.ONE_WON:0===s?xe.ZERO_WON:xe.ONGOING}}class a0t extends G1{getListMoves(t){const e=zo.getListMovesFromState(t.gameState);return Ke.sortByDescending(e,r=>r.length()),e}getBoardValue(t){const e=t.gameState,r=e.getCurrentPlayer();if(zo.mustPass(e)&&e.alreadyPassed)return new Ct(r.getDefeatValue());const[s,i]=zo.getFurthestPiecePositions(e);return new Ct(7===i?z.ONE.getVictoryValue():0===s?z.ZERO.getVictoryValue():i-(7-s))}}const oe=Fn.EMPTY,xP=Fn.ZERO.ORANGE,kP=Fn.ONE.ORANGE,LP=Fn.ZERO.BLUE,RP=Fn.ONE.BLUE,DH=Fn.ZERO.PURPLE,Zm=Fn.ONE.PURPLE,DP=Fn.ZERO.PINK,zP=Fn.ONE.PINK,VP=Fn.ZERO.YELLOW,HP=Fn.ONE.YELLOW,FP=Fn.ZERO.RED,BP=Fn.ONE.RED,$P=Fn.ZERO.GREEN,UP=Fn.ONE.GREEN,GP=Fn.ZERO.BROWN,WP=Fn.ONE.BROWN;class g3e extends K1{constructor(){super(...arguments),this.tutorial=[ce.informational($localize`Goal of the game`,$localize`At Kamisado, there are two ways to win the game:
        either by moving one of your pieces on the opponent's starting line,
        or by forcing the opponent to make a move that blocks the entire game.
        Here, Dark wins because its brown piece is on Light's starting line, on the top left.`,new F3(5,Sn.ORANGE,P.empty(),!1,[[GP,RP,Zm,zP,HP,BP,UP,WP],[oe,oe,oe,oe,oe,oe,oe,oe],[oe,oe,oe,oe,oe,oe,oe,oe],[oe,oe,oe,oe,oe,oe,oe,oe],[oe,oe,oe,kP,oe,oe,oe,oe],[oe,oe,oe,oe,oe,oe,oe,oe],[oe,oe,oe,oe,oe,oe,oe,oe],[oe,$P,FP,VP,DP,DH,LP,xP]])).withPreviousMove(Do.of(new M(0,7),new M(0,0))),ce.anyMove($localize`Initial board and initial move`,$localize`Here is the initial board.
        At Kamisado, pieces can only move forward, vertically or diagonally.
        You're playing first, with dark pieces, you can make your first move.<br/><br/>
        You're playing Dark, click on the piece of your choice and click on a landing square.`,F3.getInitialState(),Do.of(new M(7,7),new M(3,3)),$localize`Perfect! Note that each of your piece has a different color.`),ce.fromMove($localize`Moving`,$localize`Let us now consider the move of Light, after the blue piece has been moved by Dark.
        All moves after the initial move must be made from the piece that corresponds to the color
        of the square upon which the last move ended.
        Here, the last move ended on the pink square, hence the pink piece must move.
        It is already selected, you do not have to click on it.<br/><br/>
        You're playing Light, move your piece on a blue square.`,new F3(1,Sn.PINK,P.of(new M(3,0)),!1,[[kP,RP,Zm,zP,HP,BP,UP,WP],[oe,oe,oe,oe,oe,oe,oe,oe],[oe,oe,oe,oe,oe,oe,oe,oe],[oe,oe,oe,oe,oe,oe,oe,oe],[oe,oe,oe,oe,oe,oe,oe,oe],[oe,oe,oe,oe,oe,oe,LP,oe],[oe,oe,oe,oe,oe,oe,oe,oe],[GP,$P,FP,VP,DP,DH,oe,xP]]),[Do.of(new M(3,0),new M(3,6)),Do.of(new M(3,0),new M(4,1))],$localize`Congratulations!`,$localize`You have not moved your pink piece on a blue square!`).withPreviousMove(Do.of(new M(6,7),new M(6,5))),ce.informational($localize`Stuck situation`,$localize`Dark moved to another pink square, hence you have to move your pink piece again.
        However, your pink piece is stuck! In this case, you must pass your turn.
        Dark will now have to play by moving its pink piece.`,new F3(1,Sn.PINK,P.of(new M(3,6)),!1,[[kP,RP,Zm,oe,HP,BP,UP,WP],[oe,oe,oe,oe,oe,oe,oe,oe],[oe,oe,oe,oe,oe,oe,oe,oe],[oe,oe,oe,oe,oe,oe,oe,oe],[oe,oe,oe,oe,oe,oe,oe,LP],[oe,oe,oe,oe,oe,oe,oe,oe],[oe,oe,oe,zP,oe,oe,oe,oe],[GP,$P,FP,VP,DP,DH,oe,xP]])).withPreviousMove(Do.of(new M(6,5),new M(7,4))),ce.fromMove($localize`Victory by blocking`,$localize`At any time, if a player blocks the entire game, that player loses.
        In other words, if a player forces its opponent to move a piece that the opponent cannot move,
        and the player cannot move its own piece of the same color, then that player loses.
        Here, you're playing Dark and you can force your opponent to create such a situation, hence you can force your opponent to lose!<br/><br/>
        You're playing Dark, analyze the board and make the winning move.`,new F3(2,Sn.RED,P.of(new M(2,4)),!1,[[oe,RP,Zm,oe,oe,BP,oe,oe],[oe,oe,oe,HP,oe,oe,oe,oe],[oe,oe,oe,zP,oe,Zm,oe,oe],[oe,oe,oe,VP,oe,oe,oe,oe],[oe,oe,FP,oe,oe,oe,oe,oe],[oe,oe,oe,oe,oe,oe,UP,oe],[kP,oe,oe,oe,oe,DP,oe,WP],[GP,$P,oe,oe,oe,oe,LP,xP]]),[Do.of(new M(2,4),new M(0,2))],$localize`Perfect!
         Your opponent must move its green piece on the orange square, forcing you to play with your orange piece.
         Your orange piece will be stuck and you will have to pass your turn.
         Your opponent will have to pass its turn too because its orange piece is also stuck: the game is completely stuck.
         In this case, the last player to have moved a piece loses.
         Here, your opponent will have moved its green piece last, you therefore win!`,$localize`Failed. Try again.`).withPreviousMove(Do.of(new M(4,0),new M(3,1)))]}}function c0t(n,t){if(1&n&&(F(),Q(0,"circle",8)),2&n){const e=v(),r=e.$implicit,s=e.index,i=v().index,o=v();T("ngClass",o.piecePlayerClass(r)),D("cx",o.SPACE_SIZE/2+s*o.SPACE_SIZE)("cy",o.SPACE_SIZE/2+i*o.SPACE_SIZE)("r",o.SPACE_SIZE/2-o.STROKE_WIDTH)}}function l0t(n,t){if(1&n&&(F(),Q(0,"rect",9)),2&n){const e=v(),r=e.index,s=e.$implicit,i=v().index,o=v();D("x",o.SPACE_SIZE/2+r*o.SPACE_SIZE-o.SPACE_SIZE/8)("y",o.SPACE_SIZE/2+i*o.SPACE_SIZE-o.SPACE_SIZE/8)("rx",o.isPlayerZero(s)?o.SPACE_SIZE:0)("ry",o.isPlayerZero(s)?o.SPACE_SIZE:0)("width",o.SPACE_SIZE/4)("height",o.SPACE_SIZE/4)("fill",o.pieceColor(s))}}function u0t(n,t){if(1&n){const e=Oe();F(),b(0,"g")(1,"g",4),ee("click",function(){const i=he(e).index,o=v().index;return le(v().onClick(i,o))}),Q(2,"rect",5),x(3,c0t,1,4,"circle",6),x(4,l0t,1,7,"rect",7),O()()}if(2&n){const e=t.$implicit,r=t.index,s=v().index,i=v();S(1),We("id","click_",r,"_",s,""),S(1),D("x",r*i.SPACE_SIZE)("y",s*i.SPACE_SIZE)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)("fill",i.backgroundColor(r,s)),S(1),T("ngIf",e!==i.UNOCCUPIED),S(1),T("ngIf",e!==i.UNOCCUPIED)}}function f0t(n,t){if(1&n&&(F(),b(0,"g"),x(1,u0t,5,9,"g",1),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e)}}function h0t(n,t){if(1&n&&(F(),b(0,"g"),Q(1,"rect",10)(2,"rect",10),O()),2&n){const e=v();S(1),D("x",e.lastPieceMove.get().getStart().x*e.SPACE_SIZE)("y",e.lastPieceMove.get().getStart().y*e.SPACE_SIZE)("width",e.SPACE_SIZE)("height",e.SPACE_SIZE),S(1),D("x",e.lastPieceMove.get().getEnd().x*e.SPACE_SIZE)("y",e.lastPieceMove.get().getEnd().y*e.SPACE_SIZE)("width",e.SPACE_SIZE)("height",e.SPACE_SIZE)}}function d0t(n,t){if(1&n&&(F(),Q(0,"circle",11)),2&n){const e=v();D("cx",e.SPACE_SIZE/2+e.chosen.get().x*e.SPACE_SIZE)("cy",e.SPACE_SIZE/2+e.chosen.get().y*e.SPACE_SIZE)("r",e.SPACE_SIZE/2-e.STROKE_WIDTH)}}let p0t=(()=>{class n extends to{constructor(e){super(e),this.UNOCCUPIED=Fn.EMPTY,this.lastMove=P.empty(),this.lastPieceMove=P.empty(),this.chosen=P.empty(),this.chosenAutomatically=!1,this.hasAsymetricBoard=!0,this.rules=new zo(F3),this.availableMinimaxes=[new a0t(this.rules,"KamisadoMinimax")],this.encoder=Do.encoder,this.tutorial=(new g3e).tutorial,this.canPass=!1,this.updateBoard()}backgroundColor(e,r){return Ti.getColorAt(e,r).rgb}isPlayerZero(e){return e.player===z.ZERO}pieceColor(e){return e.color.rgb}piecePlayerClass(e){return this.getPlayerClass(e.player)}updateBoard(){const e=this.getState();if(this.board=e.getCopiedBoard(),this.lastMove=this.rules.node.move,this.lastPieceMove=P.empty(),this.lastMove.isPresent()){const s=this.lastMove.get();s.isPieceMove()&&(this.lastPieceMove=P.of(s))}this.canPass=zo.mustPass(e);const r=this.rules.getGameStatus(this.rules.node)!==xe.ONGOING;this.canPass||e.coordToPlay.isAbsent()||r?(this.chosenAutomatically=!1,this.chosen=P.empty()):(this.chosenAutomatically=!0,this.chosen=e.coordToPlay)}pass(){var e=this;return A(function*(){return ve(e.canPass,"KamisadoComponent: pass() must be called only if canPass is true"),e.chooseMove(Do.PASS,e.getState())})()}onClick(e,r){var s=this;return A(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());const o=new M(e,r);if(s.canPass)return s.cancelMove(tt.MUST_PASS());if(s.chosen.isAbsent())return s.choosePiece(e,r);if(!1===s.chosenAutomatically&&s.chosen.equalsValue(o))return s.cancelMoveAttempt(),G.SUCCESS;{const c=s.getState().getPieceAtXY(e,r),u=s.getState().getCurrentPlayer();return c.belongsTo(u)?s.chosenAutomatically?s.cancelMove(jm.PLAY_WITH_SELECTED_PIECE()):(s.chosen=P.of(o),G.SUCCESS):yield s.chooseDestination(e,r)}})()}choosePiece(e,r){const s=this.getState().getPieceAtXY(e,r),i=this.getState().getCurrentOpponent();return s.belongsTo(i)?this.cancelMove(tt.CANNOT_CHOOSE_OPPONENT_PIECE()):(this.chosen=P.of(new M(e,r)),G.SUCCESS)}chooseDestination(e,r){var s=this;return A(function*(){const i=s.chosen.get(),o=new M(e,r),c=Do.of(i,o);return s.chooseMove(c,s.getState())})()}cancelMoveAttempt(){this.chosenAutomatically||(this.chosen=P.empty())}}return n.\u0275fac=function(e){return new(e||n)(J(Pn))},n.\u0275cmp=gt({type:n,selectors:[["app-kamisado"]],features:[l],decls:4,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf"],["id","selectedPiece","class","base mid-stroke no-fill selected-stroke",4,"ngIf"],[3,"id","click"],["fill-opacity","0.7",1,"base-no-fill"],["class","base-no-fill",3,"ngClass",4,"ngIf"],["class","no-stroke",4,"ngIf"],[1,"base-no-fill",3,"ngClass"],[1,"no-stroke"],[1,"base","no-fill","mid-stroke","last-move-stroke"],["id","selectedPiece",1,"base","mid-stroke","no-fill","selected-stroke"]],template:function(e,r){1&e&&(F(),b(0,"svg",0),x(1,f0t,2,1,"g",1),x(2,h0t,3,8,"g",2),x(3,d0t,1,3,"circle",3),O()),2&e&&(D("viewBox",r.getViewBox())("transform",r.rotation),S(1),T("ngForOf",r.board),S(1),T("ngIf",r.lastPieceMove.isPresent()),S(1),T("ngIf",r.chosen.isPresent()))},dependencies:[dn,An,en],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})(),m3e=(()=>{class n extends to{getParallelogramCoords(e){const r=e.parallelogramHeight,s=r*e.horizontalWidthRatio,i=r*e.offsetRatio,o=s,u=s-i,h=r,p=-i,m=r;return[new M(0,0),new M(o,0),new M(u,h),new M(p,m)]}getCoordTranslate(e,r,s,i){const o=i.parallelogramHeight;return new M(e*(o*i.horizontalWidthRatio)+i.offsetRatio*o*(i.abstractBoardSize-r),r*o-i.pieceHeightRatio*o*s)}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=Dr(n)))(r||n)}}(),n.\u0275cmp=gt({type:n,selectors:[["ng-component"]],features:[l],decls:0,vars:0,template:function(e,r){},encapsulation:2}),n})(),h6=(()=>{class n{}return n.CANNOT_GO_BACKWARD=()=>$localize`You cannot go backward with normal pieces!`,n.CANNOT_CAPTURE_EMPTY_SPACE=()=>$localize`You cannot capture an empty square, nor jump over it!`,n.CANNOT_SKIP_CAPTURE=()=>$localize`You must capture when it is possible!`,n.MUST_FINISH_CAPTURING=()=>$localize`You must finish this capture!`,n.THIS_PIECE_CANNOT_MOVE=()=>$localize`This piece cannot move!`,n.CAPTURE_STEPS_MUST_BE_DOUBLE_DIAGONAL=()=>$localize`A capture should be a double diagonal step. Look at the green indicators to help you!`,n.MOVE_STEPS_MUST_BE_SINGLE_DIAGONAL=()=>$localize`You must move in a single diagonal step!`,n.CANNOT_CAPTURE_TWICE_THE_SAME_COORD=()=>$localize`You cannot jump over the same square several times!`,n})();class ks{constructor(t,e){this.player=t,this.isOfficer=e}static getPlayerOfficer(t){return t===z.ZERO?ks.ZERO_OFFICER:ks.ONE_OFFICER}toString(){switch(this){case ks.ZERO:return"u";case ks.ONE:return"v";case ks.ZERO_OFFICER:return"O";default:return Me.expectToBe(this,ks.ONE_OFFICER),"X"}}equals(t){return this===t}}ks.ZERO=new ks(z.ZERO,!1),ks.ONE=new ks(z.ONE,!1),ks.ZERO_OFFICER=new ks(z.ZERO,!0),ks.ONE_OFFICER=new ks(z.ONE,!0);class Vo{constructor(t){this.pieces=t}isEmpty(){return 0===this.pieces.length}isCommandedBy(t){return!this.isEmpty()&&this.getCommander().player===t}getCommander(){return this.pieces[0]}getPiecesUnderCommander(){return new Vo(this.pieces.slice(1))}capturePiece(t){return new Vo(this.pieces.concat(t))}addStackBelow(t){let e=this;for(const r of t.pieces)e=e.capturePiece(r);return e}getStackSize(){return this.pieces.length}promoteCommander(){let t=this.getCommander();if(t.isOfficer)return this;{t=ks.getPlayerOfficer(t.player);const e=this.getPiecesUnderCommander();return new Vo([t]).addStackBelow(e)}}get(t){return this.pieces[t]}toString(t){let e=t-this.getStackSize(),r="";for(;e>0;)r+="_",e--;for(const s of this.pieces)r+=s.toString();return r}}Vo.EMPTY=new Vo([]);let ar=(()=>{class n extends es{static getInitialState(){const e=new Vo([ks.ZERO]),r=new Vo([ks.ONE]),s=Vo.EMPTY;return new n([[r,s,r,s,r,s,r],[s,r,s,r,s,r,s],[r,s,r,s,r,s,r],[s,s,s,s,s,s,s],[e,s,e,s,e,s,e],[s,e,s,e,s,e,s],[e,s,e,s,e,s,e]],0)}static from(e,r){return new n(e,r)}static isNotOnBoard(e){return e.isNotInRange(n.SIZE,n.SIZE)}static isOnBoard(e){return e.isInRange(n.SIZE,n.SIZE)}getStacksOf(e){const r=[];for(let s=0;s<n.SIZE;s++)for(let i=0;i<n.SIZE;i++)this.getPieceAtXY(i,s).isCommandedBy(e)&&r.push(new M(i,s));return r}set(e,r){const s=this.getCopiedBoard();return s[e.y][e.x]=r,new n(s,this.turn)}remove(e){return this.set(e,Vo.EMPTY)}incrementTurn(){return new n(this.getCopiedBoard(),this.turn+1)}getFinishLineOf(e){return e===z.ZERO?0:n.SIZE-1}toString(){let e=1;for(let s=0;s<n.SIZE;s++)for(let i=0;i<n.SIZE;i++){const o=this.getPieceAtXY(i,s).getStackSize();e=Math.max(e,o)}const r=[];for(let s=0;s<n.SIZE;s++){const i=[];for(let o=0;o<n.SIZE;o++)i.push(this.getPieceAtXY(o,s).toString(e));r.push(i.join(" "))}return r.join("\n")}}return n.SIZE=7,n})();class g0t extends Dt{equals(t){if(t.size()!==this.size())return!1;for(let e=0;e<this.size();e++)if(!1===Ga(t.get(e),this.get(e)))return!1;return!0}get(t){return Me.assert(t<this.values.length,"MGPUniqueList: index out of bounds: "+t),this.values[t]}getFromEnd(t){return Me.assert(t<this.values.length,"MGPUniqueList: index (from end) out of bounds: "+t),this.get(this.values.length-1-t)}}class Js extends Gi{constructor(t,e){super(),this.isStep=e,this.coords=new g0t(t)}static fromCapture(t){const e=Js.getSteppedOverCoords(t);return e.isSuccess()?U.success(new Js(t,!1)):U.failure(e.getReason())}static getSteppedOverCoords(t){let e=P.empty();const r=new Dt;for(const s of t){if(ar.isNotOnBoard(s))return U.failure(yH.OUT_OF_RANGE(s));if(e.isPresent()){const i=e.get();if(!1===i.getVectorToward(s).isDiagonalOfLength(2))return U.failure(h6.CAPTURE_STEPS_MUST_BE_DOUBLE_DIAGONAL());const c=i.getCoordsToward(s)[0];if(r.contains(c))return U.failure(h6.CANNOT_CAPTURE_TWICE_THE_SAME_COORD());r.add(c)}e=P.of(s)}return U.success(r)}static fromStep(t,e){return ar.isNotOnBoard(t)?U.failure(yH.OUT_OF_RANGE(t)):ar.isNotOnBoard(e)?U.failure(yH.OUT_OF_RANGE(e)):!1===t.getVectorToward(e).isDiagonalOfLength(1)?U.failure(h6.MOVE_STEPS_MUST_BE_SINGLE_DIAGONAL()):U.success(new Js([t,e],!0))}toString(){return"LascaMove("+this.coords.toList().map(r=>r.toString()).join(", ")+")"}getRelation(t){const e=this.coords.size(),r=t.coords.size(),s=Math.min(e,r);for(let i=0;i<s;i++)if(!1===this.coords.toList()[i].equals(t.coords.toList()[i]))return"INEQUALITY";return e===r?"EQUALITY":"PREFIX"}equals(t){return"EQUALITY"===this.getRelation(t)}isPrefix(t){return"PREFIX"===this.getRelation(t)}getStartingCoord(){return this.coords.get(0)}getEndingCoord(){return this.coords.getFromEnd(0)}getCapturedCoords(){return Js.getSteppedOverCoords(this.coords.toList())}concatenate(t){const e=this.getEndingCoord(),r=t.coords.toList()[0];ve(e.equals(r),"should not concatenate non-touching move");const s=this.coords.toList(),i=Ke.copyImmutableArray(s),o=t.coords.toList(),c=Ke.copyImmutableArray(o).slice(1);return Js.fromCapture(i.concat(c)).get()}}Js.encoder=new class extends mi{encodeMove(n){return{coords:n.coords.toList().map(t=>M.encoder.encode(t)),isStep:n.isStep}}decodeMove(n){const t=n;ve(null!=t.coords,"Encoded LascaMove should have a coords field"),ve(null!=t.isStep,"Encoded LascaMove should have a isStep field");const r=Me.getNonNullable(t.coords).map(s=>M.encoder.decode(s));return new Js(r,t.isStep)}};class B4 extends U1{static get(){return this.singleton.isAbsent()&&(this.singleton=P.of(new B4(ar))),this.singleton.get()}getCaptures(t){const e=t.getCurrentPlayer();return this.getCapturesOf(t,e)}getCapturesOf(t,e){const r=[],s=t.getStacksOf(e);for(const i of s)r.push(...this.getPieceCaptures(t,i));return r}getPieceCaptures(t,e){let r=[];const o=t.getPieceAt(e).getCommander().player.getOpponent(),c=this.getPieceDirections(t,e),u=t.getPieceAt(e);for(const h of c){const p=e.getNext(h,1);if(ar.isOnBoard(p)&&t.getPieceAt(p).isCommandedBy(o)){const m=p.getNext(h,1);if(ar.isOnBoard(m)&&t.getPieceAt(m).isEmpty()){const C=t.remove(e).remove(p).set(m,u),w=Js.fromCapture([e,m]).get(),I=this.getPieceCaptures(C,m);if(0===I.length)r=r.concat(w);else{const H=I.map(K=>w.concatenate(K));r=r.concat(H)}}}}return r}getPieceDirections(t,e){const i=t.getPieceAt(e).getCommander().player.getScoreModifier(),o=[Ne.factory.fromDelta(-1,i).get(),Ne.factory.fromDelta(1,i).get()];return t.getPieceAt(e).getCommander().isOfficer&&o.push(Ne.factory.fromDelta(-1,-i).get(),Ne.factory.fromDelta(1,-i).get()),o}getSteps(t){const e=t.getCurrentPlayer();return this.getStepsOf(t,e)}getStepsOf(t,e){const r=[],s=t.getStacksOf(e);for(const i of s)r.push(...this.getPieceSteps(t,i));return r}getPieceSteps(t,e){const r=[],s=this.getPieceDirections(t,e);for(const i of s){const o=e.getNext(i,1);if(ar.isOnBoard(o)&&t.getPieceAt(o).isEmpty()){const c=Js.fromStep(e,o).get();r.push(c)}}return r}applyLegalMove(t,e){const r=t.getStartingCoord(),s=t.getEndingCoord();let i=e.getPieceAt(r),o=e.remove(r);if(!1===t.isStep)for(const c of t.getCapturedCoords().get()){const u=e.getPieceAt(c),h=u.getCommander();i=i.capturePiece(h);const p=u.getPiecesUnderCommander();o=o.set(c,p)}if(o=o.set(s,i),s.y===e.getFinishLineOf(e.getCurrentPlayer())){const c=i.promoteCommander();o=o.set(s,c)}return o.incrementTurn()}isLegal(t,e){const r=t.getStartingCoord();if(e.getPieceAt(r).isEmpty())return U.failure(tt.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());const s=e.getPieceAt(r),i=e.getCurrentOpponent();if(s.isCommandedBy(i))return U.failure(tt.CANNOT_CHOOSE_OPPONENT_PIECE());const o=t.coords.get(1);if(!1===s.getCommander().isOfficer&&r.getDirectionToward(o).get().y===i.getScoreModifier())return U.failure(h6.CANNOT_GO_BACKWARD());if(!1===e.getPieceAt(o).isEmpty())return U.failure(tt.MUST_LAND_ON_EMPTY_SPACE());const c=this.getCaptures(e);return t.isStep?c.length>0?U.failure(h6.CANNOT_SKIP_CAPTURE()):U.success(void 0):this.isLegalCapture(t,e,c)}isLegalCapture(t,e,r){const s=e.getCurrentPlayer(),i=t.getCapturedCoords().get();for(const o of i){const c=e.getPieceAt(o);if(c.isCommandedBy(s))return U.failure(tt.CANNOT_SELF_CAPTURE());if(c.isEmpty())return U.failure(h6.CANNOT_CAPTURE_EMPTY_SPACE())}return r.some(o=>o.equals(t))?U.success(void 0):U.failure(h6.MUST_FINISH_CAPTURING())}getGameStatus(t){const e=t.gameState;return this.getCaptures(e).length>0||this.getSteps(e).length>0?xe.ONGOING:xe.getVictory(e.getCurrentOpponent())}}B4.singleton=P.empty();class Ym extends G1{constructor(t){super(B4.get(),t)}static getListMoves(t){const e=B4.get().getCaptures(t.gameState);return e.length>0?e:B4.get().getSteps(t.gameState)}getListMoves(t){return Ym.getListMoves(t)}getBoardValue(t){const e=this.ruler.getGameStatus(t);if(e.isEndGame)return e.toBoardValue();const r=t.gameState,s=this.getNumberOfMobileCoords(r,z.ZERO),i=this.getNumberOfMobileCoords(r,z.ONE);return Ct.from(s,i)}getNumberOfMobileCoords(t,e){const s=this.getCapturesAndSteps(t,e).map(o=>o.getStartingCoord());return new Dt(s).size()}getCapturesAndSteps(t,e){const r=B4.get().getCapturesOf(t,e),s=B4.get().getStepsOf(t,e);return r.concat(s)}}class m0t extends Ym{constructor(){super("Lasca Control And Domination Minimax")}getBoardValue(t){const e=this.ruler.getGameStatus(t);if(e.isEndGame)return e.toBoardValue();const r=12*super.getBoardValue(t).value;let s=0;for(let i=0;i<ar.SIZE;i++)for(let o=0;o<ar.SIZE;o++){const c=t.gameState.getPieceAtXY(o,i);if(c.getStackSize()>0){const u=c.getStackSize();let h=0;const p=c.getCommander().player;for(;h<u&&c.get(h).player===p;)h++;s+=h*p.getScoreModifier()}}return new Ct(r+s)}}const _3e=ks.ZERO,zH=ks.ONE,Ls=new Vo([_3e]),Cr=new Vo([zH]),_0t=new Vo([_3e,zH]),v0t=new Vo([ks.ZERO_OFFICER,zH]),re=Vo.EMPTY;class v3e extends K1{constructor(){super(...arguments),this.tutorial=[ce.informational($localize`Lasca: origins`,$localize`Lasca is a game based on draughts created in 1911 by Emanuel Lasker, chess world champion. It's played on a 7x7 board, each player has 11 pieces.`,ar.getInitialState()),ce.informational($localize`Goal of the game`,$localize`The goal of Lasca is, like for draughts, to render the opponent unable to move, either by capturing all his pieces, either by blocking them.`,ar.getInitialState()),ce.anyMove($localize`Steps`,$localize`A simple step is made by one diagonal move forward, left or right. Click on the chosen piece, then on its landing square.<br/><br/>You are playing Dark, do the first move.`,ar.getInitialState(),Js.fromStep(new M(4,4),new M(3,3)).get(),$localize`Congratulations!`),ce.anyMove($localize`Capture`,$localize`A capture happens when you jump diagonally over an opponent piece to land right behind it. You have to capture when you can. It is the case here, so click on the piece that must capture, and then on its landing square.<br/><br/>You're playing Dark, go ahead.`,ar.from([[Cr,re,re,re,Cr,re,Cr],[re,re,re,Cr,re,Cr,re],[re,re,Cr,re,Cr,re,Cr],[re,Cr,re,re,re,re,re],[Ls,re,Ls,re,Ls,re,Ls],[re,Ls,re,Ls,re,Ls,re],[Ls,re,Ls,re,Ls,re,Ls]],2),Js.fromCapture([new M(2,4),new M(0,2)]).get(),$localize`Congratulations, notice that the captured piece was not removed from the board, but put below the capturing pieces.`),ce.anyMove($localize`Multiple captures`,$localize`If, after the beginning of your capture, the piece that you just moved can capture another piece, it has to capture until it can no longer capture. To do so, you must then click again on the next landing square. Note that, you cannot jump twice over the same stack.<br/><br/>You are playing Dark, a double capture is possible, go ahead.`,ar.from([[re,re,re,re,re,re,re],[re,re,re,re,re,re,re],[Cr,re,re,re,Cr,re,Cr],[re,Cr,re,Cr,re,Cr,re],[re,re,Cr,re,Cr,re,Cr],[re,Cr,re,re,re,re,re],[re,re,Ls,re,Ls,re,Ls]],2),Js.fromCapture([new M(2,6),new M(0,4),new M(2,2)]).get(),$localize`Congratulations!`),ce.informational($localize`Minority capture is allowed`,$localize`If you have several capture choices, you are allowed to choose any of them. For example if one choice is to capture one piece, and the other choice is to capture two pieces, you can choose either.`,ar.from([[re,re,re,re,re,re,re],[re,re,re,re,re,Cr,re],[re,re,re,re,re,re,re],[re,Cr,re,Cr,re,re,re],[re,re,Ls,re,re,re,re],[re,re,re,re,re,re,re],[re,re,re,re,re,re,re]],2)),ce.fromMove($localize`Promotion`,$localize`When a stack reaches the last line, its commander becomes an officer, and gains the ability to go backward, which is illegal for the other pieces! One of your piece could be promoted now.<br/><br/>You're playing Dark. Do it.`,ar.from([[re,re,re,re,re,re,Cr],[re,re,re,_0t,re,Cr,re],[re,re,re,re,re,re,re],[re,re,re,re,re,re,re],[re,re,re,re,re,re,re],[re,re,re,re,re,re,re],[re,re,Ls,re,Ls,re,Ls]],2),[Js.fromStep(new M(3,1),new M(2,0)).get(),Js.fromStep(new M(3,1),new M(4,0)).get()],$localize`Congratulations!`,$localize`You did not choose the correct stack, and got no promotion.`),ce.fromMove($localize`Officer move`,$localize`Officers can move and capture backward as well as forward.<br/><br/>You're playing Dark, move your officier!`,ar.from([[re,re,re,re,v0t,re,Cr],[re,re,re,re,re,re,re],[re,re,re,re,Cr,re,re],[re,re,re,re,re,re,re],[re,re,re,re,re,re,re],[re,re,re,re,re,re,re],[re,re,Ls,re,Ls,re,Ls]],2),[Js.fromStep(new M(4,0),new M(3,1)).get(),Js.fromStep(new M(4,0),new M(5,1)).get()],$localize`Congratulations!`,$localize`You did not move your officer.`)]}}function C0t(n,t){if(1&n&&(F(),Q(0,"circle",13)),2&n){const e=v(),r=e.index,s=e.$implicit,i=v().index,o=v().index,c=v();j2("id","square_",i,"_",o,"_piece_",r,"_officer_symbol"),T("ngClass",s.classes),D("cx",.4*c.SPACE_SIZE)("cy",.575*c.SPACE_SIZE)("r",.045*c.SPACE_SIZE)}}function y0t(n,t){if(1&n&&(F(),b(0,"g",10),Q(1,"use",11),x(2,C0t,1,7,"circle",12),O()),2&n){const e=t.$implicit,r=t.index,s=v().index,i=v().index;D("transform",v().getPieceTranslate(r)),S(1),j2("id","square_",s,"_",i,"_piece_",r,""),T("ngClass",e.classes),S(1),T("ngIf",e.isOfficer)}}function E0t(n,t){if(1&n){const e=Oe();F(),b(0,"g")(1,"g",7),ee("click",function(){const i=he(e).index,o=v().index;return le(v().onClick(i,o))}),Q(2,"polygon",8),x(3,y0t,3,6,"g",9),O()()}if(2&n){const e=t.$implicit,r=t.index,s=v().index,i=v();S(1),We("id","coord_",r,"_",s,""),D("transform",i.getTranslate(r,s,0)),S(1),We("id","square_",r,"_",s,""),T("ngClass",e.squareClasses),D("points",i.getParallelogramPoints()),S(1),T("ngForOf",e.pieceInfos)}}function M0t(n,t){if(1&n&&(F(),b(0,"g"),x(1,E0t,4,8,"g",4),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e)}}let S0t=(()=>{class n extends m3e{constructor(e){super(e),this.THICKNESS=40,this.mode={horizontalWidthRatio:1.2,offsetRatio:.4,pieceHeightRatio:1,parallelogramHeight:100,abstractBoardSize:ar.SIZE},this.LEFT=0,this.UP=-this.SPACE_SIZE,this.basicWidth=this.mode.abstractBoardSize*this.mode.parallelogramHeight,this.WIDTH=this.basicWidth*(this.mode.horizontalWidthRatio+this.mode.offsetRatio),this.HEIGHT=this.basicWidth+this.THICKNESS+this.STROKE_WIDTH-this.UP,this.CX=this.WIDTH/2,this.CY=(this.HEIGHT+this.UP)/2,this.adaptedBoard={isAlreadySwitched:!1,spaceInfo:[]},this.lastMove=P.empty(),this.currentMoveClicks=[],this.capturedCoords=[],this.legalMoves=[],this.hasAsymetricBoard=!0,this.rules=B4.get(),this.availableMinimaxes=[new Ym("Lasca Control Minimax"),new m0t],this.encoder=Js.encoder,this.tutorial=(new v3e).tutorial,this.canPass=!1,this.updateBoard()}updateBoard(){this.lastMove=this.rules.node.move;const e=this.getState();this.board=e.getCopiedBoard(),this.legalMoves=Ym.getListMoves(this.rules.node),this.createAdaptedBoardFrom(e),this.showLastMove(),this.rotateAdaptedBoardIfNeeded()}createAdaptedBoardFrom(e){this.adaptedBoard={isAlreadySwitched:!1,spaceInfo:[]};for(let i=0;i<ar.SIZE;i++){const o=[];for(let c=0;c<ar.SIZE;c++){const u=this.getSpaceInfo(e,c,i);o.push(u)}this.adaptedBoard.spaceInfo.push(o)}const s=P.ofNullable(this.currentMoveClicks[this.currentMoveClicks.length-1]);if(s.isPresent()){const i=s.get();for(const o of this.getSpaceInfoAt(i).pieceInfos)o.classes.push("selected-stroke");this.showPossibleLandings(i,e)}for(const i of this.capturedCoords)this.getSpaceInfoAt(i).squareClasses.push("captured-fill");for(const i of this.currentMoveClicks)this.getSpaceInfoAt(i).squareClasses.push("moved-fill")}getSpaceInfo(e,r,s){const i=e.getPieceAtXY(r,s),o=[];for(let c=i.getStackSize()-1;c>=0;c--){const u=i.get(c);o.push({classes:[this.getPlayerClass(u.player)],isOfficer:u.isOfficer})}return{pieceInfos:o,squareClasses:[]}}showLastMove(){this.lastMove.isPresent()&&(this.showLastCapture(),this.showSteppedOnCoord()),this.showPossibleMoves()}showLastCapture(){if(!1===this.lastMove.get().isStep){const e=this.lastMove.get().getCapturedCoords();Me.assert(e.isSuccess(),"Last move is a capture yet has illegal jumps !?");for(const r of e.get())this.getSpaceInfoAt(r).squareClasses.push("captured-fill")}}showSteppedOnCoord(){const e=this.lastMove.get();for(const r of e.coords)this.getSpaceInfoAt(r).squareClasses.push("moved-fill")}showPossibleMoves(){for(const e of this.legalMoves){const r=e.getStartingCoord();this.getSpaceInfoAt(r).squareClasses.push("selectable-fill")}}getSpaceInfoAt(e){if(this.role===z.ONE&&this.adaptedBoard.isAlreadySwitched){const r=ar.SIZE-1,s=new M(r-e.x,r-e.y);return this.adaptedBoard.spaceInfo[s.y][s.x]}return this.adaptedBoard.spaceInfo[e.y][e.x]}rotateAdaptedBoardIfNeeded(){if(this.role===z.ONE){const e=[];for(let r=0;r<ar.SIZE;r++){e[ar.SIZE-1-r]=[];for(let s=0;s<ar.SIZE;s++)e[ar.SIZE-1-r][ar.SIZE-1-s]=this.getSpaceInfoAt(new M(s,r))}this.adaptedBoard={isAlreadySwitched:!0,spaceInfo:e}}}hideLastMove(){this.createAdaptedBoardFrom(this.getState()),this.rotateAdaptedBoardIfNeeded()}onClick(e,r){var s=this;return A(function*(){s.role===z.ONE&&(e=ar.SIZE-1-e,r=ar.SIZE-1-r);const i=s.canUserPlay("#coord_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());const o=new M(e,r),c=s.getState().getPieceAt(o),u=s.getState().getCurrentOpponent();return c.isCommandedBy(u)?s.cancelMove(tt.CANNOT_CHOOSE_OPPONENT_PIECE()):0===s.currentMoveClicks.length?s.trySelectingPiece(o):s.moveClick(o)})()}cancelMoveAttempt(){this.currentMoveClicks=[],this.capturedCoords=[],this.createAdaptedBoardFrom(this.getState()),this.showLastMove(),this.rotateAdaptedBoardIfNeeded()}moveClick(e){var r=this;return A(function*(){if(e.equals(r.currentMoveClicks[0]))return r.cancelMoveAttempt(),G.SUCCESS;const s=r.getState().getPieceAt(e),i=r.getState().getCurrentPlayer();if(s.isCommandedBy(i))return r.cancelMoveAttempt(),r.trySelectingPiece(e);if(1===r.currentMoveClicks.length&&r.currentMoveClicks[0].getVectorToward(e).isDiagonalOfLength(1)){const c=Js.fromStep(r.currentMoveClicks[0],e).get();return r.chooseMove(c,r.getState())}return r.capture(e)})()}capture(e){var r=this;return A(function*(){const i=r.currentMoveClicks[r.currentMoveClicks.length-1],o=i.getVectorToward(e);if(o.isDiagonalOfLength(2)){const c=new M(i.x+o.x/2,i.y+o.y/2);r.capturedCoords.push(c),r.currentMoveClicks.push(e);const u=Js.fromCapture(r.currentMoveClicks).get();return r.legalMoves.some(h=>h.isPrefix(u))?r.applyPartialCapture():r.chooseMove(u,r.getState())}return r.cancelMove(h6.CAPTURE_STEPS_MUST_BE_DOUBLE_DIAGONAL())})()}applyPartialCapture(){let e=this.getState().remove(this.currentMoveClicks[0]),r=this.getState().getPieceAt(this.currentMoveClicks[0]);for(const i of this.capturedCoords){const o=this.getState().getPieceAt(i),c=o.getCommander(),u=o.getPiecesUnderCommander();e=e.set(i,u),r=r.capturePiece(c)}return e=e.set(this.currentMoveClicks[this.currentMoveClicks.length-1],r),this.createAdaptedBoardFrom(e),this.rotateAdaptedBoardIfNeeded(),G.SUCCESS}trySelectingPiece(e){var r=this;return A(function*(){return r.getState().getPieceAt(e).isEmpty()?r.cancelMove(tt.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):r.selectPiece(e)})()}selectPiece(e){return this.capturedCoords=[],this.legalMoves.some(r=>r.getStartingCoord().equals(e))?(this.currentMoveClicks=[e],this.hideLastMove(),G.SUCCESS):this.cancelMove(h6.THIS_PIECE_CANNOT_MOVE())}showPossibleLandings(e,r){const s=this.rules.getPieceCaptures(r,e);if(0===s.length){const i=this.rules.getPieceSteps(r,e);for(const o of i)this.getSpaceInfoAt(o.getEndingCoord()).squareClasses.push("selectable-fill")}else{const i=s.map(o=>o.coords.get(1));for(const o of i)this.getSpaceInfoAt(o).squareClasses.push("capturable-fill")}}getTranslate(e,r,s){const i=this.getCoordTranslate(e,r,s,this.mode);return"translate("+i.x+" "+i.y+")"}getParallelogramPoints(){return this.getParallelogramCoordsForLasca().map(r=>r.x+", "+r.y).join(" ")}getParallelogramCoordsForLasca(){return this.getParallelogramCoords(this.mode)}getParallelogramCenter(){const e=this.getParallelogramCoordsForLasca();return this.getParallelogramCenterOf(e[0],e[1],e[2],e[3])}getParallelogramCenterOf(e,r,s,i){const o=Math.max(e.x,r.x,s.x,i.x),c=Math.max(e.y,r.y,s.y,i.y),u=Math.min(e.x,r.x,s.x,i.x),h=Math.min(e.y,r.y,s.y,i.y);return new M((o-u)/2,(c-h)/2)}getRightEdge(){const e=this.basicWidth*this.mode.horizontalWidthRatio,r=this.basicWidth*this.mode.offsetRatio;return[r+e,0,r+e,this.THICKNESS,e,this.basicWidth+this.THICKNESS,e,this.basicWidth].join(" ")}getPieceTranslate(e){return"translate(0 "+(this.getParallelogramCenter().y-32.5-e*(.15*this.SPACE_SIZE))+")"}}return n.\u0275fac=function(e){return new(e||n)(J(Pn))},n.\u0275cmp=gt({type:n,selectors:[["app-lasca"]],features:[l],decls:8,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["id","piece"],["d","M 0 25 v 15 a 40 25, 0, 0, 0, 80 0 v -15 a 40 25, 0, 0, 0, -80 0 Z"],["cx","40","cy","25","rx","40","ry","25"],[4,"ngFor","ngForOf"],["x","0",1,"base"],[1,"base"],[3,"id","click"],[1,"base",3,"id","ngClass"],["pointer-events","fill","class","base mid-small-stroke",4,"ngFor","ngForOf"],["pointer-events","fill",1,"base","mid-small-stroke"],[0,"xlink","href","#piece",1,"base","mid-stroke",3,"id","ngClass"],[3,"id","ngClass",4,"ngIf"],[3,"id","ngClass"]],template:function(e,r){1&e&&(F(),b(0,"svg",0)(1,"defs")(2,"g",1),Q(3,"path",2)(4,"ellipse",3),O()(),x(5,M0t,2,1,"g",4),Q(6,"rect",5)(7,"polygon",6),O()),2&e&&(D("viewBox",r.LEFT+" "+r.UP+" "+r.WIDTH+" "+r.HEIGHT),S(5),T("ngForOf",r.adaptedBoard.spaceInfo),S(1),D("y",r.basicWidth)("width",r.basicWidth*r.mode.horizontalWidthRatio)("height",r.THICKNESS),S(1),D("points",r.getRightEdge()))},dependencies:[dn,An,en],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})(),ei=(()=>{class n extends es{static getInitialState(){const e=pe.NONE,r=pe.ZERO,s=pe.ONE;return new n([[e,r,r,r,r,r,r,e],[s,e,e,e,e,e,e,s],[s,e,e,e,e,e,e,s],[s,e,e,e,e,e,e,s],[s,e,e,e,e,e,e,s],[s,e,e,e,e,e,e,s],[s,e,e,e,e,e,e,s],[e,r,r,r,r,r,r,e]],0)}static isOnBoard(e){return e.isInRange(n.SIZE,n.SIZE)}}return n.SIZE=8,n})();class qi extends r8{constructor(t,e,r){super(t,e),this.direction=r,this.direction=Ne.factory.fromMove(t,e).get()}static from(t,e){const r=Ne.factory.fromMove(t,e);return r.isFailure()?U.failure(r.getReason()):t.isNotInRange(ei.SIZE,ei.SIZE)?U.failure("start coord is not in range"):e.isNotInRange(ei.SIZE,ei.SIZE)?U.failure("end coord is not in range"):U.success(new qi(t,e,r.get()))}equals(t){return t===this||!!t.getStart().equals(this.getStart())&&t.getEnd().equals(this.getEnd())}toString(){return"LinesOfActionMove("+this.getStart()+"->"+this.getEnd()+")"}encode(){return qi.encoder.encode(this)}decode(t){return qi.encoder.decode(t)}}qi.encoder=Lc.getEncoder(qi.from);let VH=(()=>{class n{}return n.INVALID_MOVE_LENGTH=()=>$localize`Your move should have a length equal to the number of pieces that exist on the same line.`,n.CANNOT_JUMP_OVER_OPPONENT=()=>$localize`You cannot jump over the opponent's pieces.`,n.PIECE_CANNOT_MOVE=()=>$localize`This piece has no possible move, select another one.`,n})();class ro extends U1{static getListMovesFromState(t){const e=[];if(ro.getVictory(t).isPresent())return e;for(let r=0;r<ei.SIZE;r++)for(let s=0;s<ei.SIZE;s++){const i=new M(s,r);if(t.getPieceAt(i).isPlayer())for(const c of ro.possibleTargets(t,i)){const u=qi.from(i,c).get();e.push(u)}}return e}static getNumberOfGroups(t){const e=Ke.createTable(ei.SIZE,ei.SIZE,-1),r=[0,0];let s=0;for(let i=0;i<ei.SIZE;i++)for(let o=0;o<ei.SIZE;o++)if(-1===e[i][o]){const c=t.getPieceAt(new M(o,i));c.isPlayer()&&(s+=1,ro.markGroupStartingAt(t,e,new M(o,i),s),r[c.value]+=1)}return r}static markGroupStartingAt(t,e,r,s){const i=[r],o=t.getPieceAt(r);for(;i.length>0;){const c=Me.getNonNullable(i.pop());if(-1===e[c.y][c.x]){const u=t.getPieceAt(c);if(u===o){e[c.y][c.x]=s;for(const h of Ne.DIRECTIONS){const p=c.getNext(h);t.isOnBoard(p)&&i.push(p)}}else u===pe.NONE&&(e[c.y][c.x]=0)}}}applyLegalMove(t,e,r){const s=e.getCopiedBoard();return s[t.getStart().y][t.getStart().x]=pe.NONE,s[t.getEnd().y][t.getEnd().x]=e.getCurrentPlayer(),new ei(s,e.turn+1)}static isLegal(t,e){return e.getPieceAt(t.getStart())!==e.getCurrentPlayer()?U.failure(tt.MUST_CHOOSE_PLAYER_PIECE()):t.length()!==this.numberOfPiecesOnLine(e,t.getStart(),t.direction)?U.failure(VH.INVALID_MOVE_LENGTH()):t.getStart().getCoordsToward(t.getEnd()).some(r=>e.getPieceAt(r)===e.getCurrentOpponent())?U.failure(VH.CANNOT_JUMP_OVER_OPPONENT()):e.getPieceAt(t.getEnd())===e.getCurrentPlayer()?U.failure(tt.SHOULD_LAND_ON_EMPTY_OR_OPPONENT_SPACE()):U.success(void 0)}isLegal(t,e){return ro.isLegal(t,e)}static numberOfPiecesOnLine(t,e,r){let s=0;for(const i of ro.getLineCoords(e,r))t.getPieceAt(i).isPlayer()&&(s+=1);return s}static getLineCoords(t,e){const r=ro.getEntranceAndForwardDirection(t,e);let s=r[0];const i=r[1],o=[];for(;ei.isOnBoard(s);)o.push(s),s=s.getNext(i);return o}static getEntranceAndForwardDirection(t,e){switch(e){case Ne.UP:case Ne.DOWN:return[new M(t.x,0),Ne.DOWN];case Ne.LEFT:case Ne.RIGHT:return[new M(0,t.y),Ne.RIGHT];case Ne.UP_RIGHT:case Ne.DOWN_LEFT:return[new M(Math.max(0,t.x+t.y-7),Math.min(7,t.x+t.y)),Ne.UP_RIGHT];default:return Me.expectToBeMultiple(e,[Ne.UP_LEFT,Ne.DOWN_RIGHT]),[new M(t.x-Math.min(t.x,t.y),t.y-Math.min(t.x,t.y)),Ne.DOWN_RIGHT]}}static getVictory(t){const[e,r]=ro.getNumberOfGroups(t);return 1===e&&1===r?P.of(pe.NONE):1===e?P.of(z.ZERO):1===r?P.of(z.ONE):P.empty()}static possibleTargets(t,e){const r=[];for(const s of Ne.DIRECTIONS){const i=ro.numberOfPiecesOnLine(t,e,s),o=e.getNext(s,i);if(t.isOnBoard(o)){const c=qi.from(e,o).get();ro.isLegal(c,t).isSuccess()&&r.push(o)}}return r}getGameStatus(t){const e=t.gameState,[r,s]=ro.getNumberOfGroups(e);return 1===r&&s>1?xe.ZERO_WON:r>1&&1===s?xe.ONE_WON:xe.ONGOING}}class P0t extends G1{getListMoves(t){return ro.getListMovesFromState(t.gameState)}getBoardValue(t){const e=t.gameState,[r,s]=ro.getNumberOfGroups(e);return 1===r&&s>1?new Ct(z.ZERO.getVictoryValue()):r>1&&1===s?new Ct(z.ONE.getVictoryValue()):Ct.from(100/r,100/s)}}const Z=pe.NONE,dr=pe.ZERO,cr=pe.ONE;class C3e{constructor(){this.tutorial=[ce.informational($localize`Goal of the game`,$localize`At Lines of Actions, the goal is to group your pieces contiguously, orthogonally and/or diagonally.
        Here, Dark wins the game:
        Dark's pieces are forming a single group, while Light's pieces form three groups.`,new ei([[Z,Z,Z,Z,Z,Z,Z,Z],[cr,Z,Z,Z,dr,Z,Z,cr],[Z,Z,dr,dr,cr,Z,Z,Z],[Z,Z,Z,dr,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z,Z]],0)),ce.anyMove($localize`Initial board and initial move`,$localize`Here is the initial board.
         Moves can be made orthogonally or diagonally.
         The length of a move is equal to the number of pieces that are on the line of the move.
         Note that there is a helping indicator to let you know where a piece can land when you select it.<br/><br/>
         You're playing Dark, make the first move!`,ei.getInitialState(),qi.from(new M(1,7),new M(1,5)).get(),$localize`Congratulations!`),ce.fromMove($localize`Jumping`,$localize`During a move, it is possible to jump above your own pieces.
        But it is forbidden to jump over the opponent's pieces.<br/><br/>
        You're playing Dark, make a jump over one of your pieces on the following board.`,new ei([[Z,Z,Z,Z,Z,Z,Z,Z],[Z,Z,cr,dr,dr,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z,cr],[Z,Z,Z,Z,Z,Z,Z,dr]],0),[qi.from(new M(3,1),new M(6,1)).get()],$localize`Congratulations!`,$localize`Failed. You did not jump over one of your pieces.`),ce.fromMove($localize`Moving`,$localize`Here is a different board. Pick the dark piece in the middle (line 4, column 4)
        and observe its possible moves.
        <ul>
            <li>Horizontally, this piece can move only of one square because it is the only piece on this line.</li>
            <li>Vertically, this piece can move of three squares because there are in total three pieces on that vertical line.
                But it can only go up, as below it the landing square is occupied by one of your pieces.</li>
            <li>Diagonally, only one move is possible: on the diagonal that contains three pieces,
                only in the direction where it does not jump over one of the opponent's pieces.
                On the other diagonal, there are too many pieces to end the move on the board.</li>
        </ul><br/>
        You're playing Dark, make one of these moves.`,new ei([[Z,Z,Z,Z,Z,Z,cr,Z],[Z,Z,Z,Z,Z,dr,Z,Z],[Z,Z,Z,Z,cr,Z,Z,Z],[Z,Z,Z,dr,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z,cr],[Z,Z,Z,Z,Z,cr,Z,cr],[Z,Z,Z,dr,Z,Z,cr,cr],[Z,Z,Z,dr,Z,Z,Z,Z]],0),[qi.from(new M(3,3),new M(3,0)).get(),qi.from(new M(3,3),new M(0,0)).get(),qi.from(new M(3,3),new M(2,3)).get(),qi.from(new M(3,3),new M(4,3)).get()],$localize`Congratulations!`,$localize`Failed. This was not one of the expected moves.`),ce.fromPredicate($localize`Capturing`,$localize`If a move ends on an opponent's piece, it is captured and removed from the board.
        However, a move cannot end on one of the player's pieces.
        Watch out, having less pieces at Lines of Action makes a victory easier, as there are less pieces to regroup!
        If a player has only one piece, that player wins the game.<br/><br/>
        On the following board, try to capture one piece with Dark.`,new ei([[Z,dr,Z,dr,dr,dr,dr,Z],[cr,Z,Z,Z,Z,Z,Z,cr],[Z,Z,dr,Z,cr,Z,Z,Z],[cr,Z,Z,Z,Z,Z,Z,cr],[cr,Z,Z,Z,Z,Z,Z,cr],[cr,Z,Z,Z,Z,Z,Z,cr],[cr,Z,Z,Z,Z,Z,Z,cr],[Z,dr,dr,dr,dr,dr,dr,Z]],0),qi.from(new M(2,2),new M(4,2)).get(),(t,e,r)=>e.getPieceAt(t.getEnd())===pe.ONE?G.SUCCESS:G.failure($localize`Failed. Try again.`),$localize`Congratulations!`),ce.fromMove($localize`Tie`,$localize`In the special case where a move ends up connecting all pieces of both player, simultaneously,
        then the game ends up with a tie.<br/><br/>
        You're playing Dark, force the tie in one move.`,new ei([[Z,Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z,Z],[dr,Z,Z,dr,cr,dr,Z,Z],[Z,Z,Z,dr,Z,Z,Z,cr],[Z,Z,Z,Z,Z,Z,Z,cr],[Z,Z,Z,Z,Z,Z,Z,cr],[Z,Z,Z,Z,Z,Z,Z,cr],[Z,Z,Z,Z,Z,Z,Z,Z]],0),[qi.from(new M(0,2),new M(4,2)).get()],$localize`Congratulations!`,$localize`Failed. Try again.`)]}}function T0t(n,t){if(1&n&&(F(),Q(0,"circle",6)),2&n){const e=v().index,r=v().index,s=v();We("id","piece_",e,"_",r,""),T("ngClass",s.getPieceClasses(e,r)),D("cx",s.SPACE_SIZE/2+e*s.SPACE_SIZE)("cy",s.SPACE_SIZE/2+r*s.SPACE_SIZE)("r",s.SPACE_SIZE/2-s.STROKE_WIDTH)}}function w0t(n,t){if(1&n){const e=Oe();F(),b(0,"g")(1,"g",3),ee("click",function(){const i=he(e).index,o=v().index;return le(v().onClick(i,o))}),Q(2,"rect",4),x(3,T0t,1,6,"circle",5),O()()}if(2&n){const e=t.$implicit,r=t.index,s=v().index,i=v();S(1),We("id","click_",r,"_",s,""),S(1),T("ngClass",i.getSquareClasses(r,s)),D("x",r*i.SPACE_SIZE)("y",s*i.SPACE_SIZE)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),S(1),T("ngIf",e!==i.EMPTY)}}function b0t(n,t){if(1&n&&(F(),b(0,"g"),x(1,w0t,4,8,"g",1),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e)}}function O0t(n,t){if(1&n){const e=Oe();F(),b(0,"rect",7),ee("click",function(){const i=he(e).$implicit;return le(v().onClick(i.x,i.y))}),O()}if(2&n){const e=t.$implicit,r=v();D("x",e.x*r.SPACE_SIZE+(r.SPACE_SIZE/2-r.INDICATOR_SIZE/2))("y",e.y*r.SPACE_SIZE+(r.SPACE_SIZE/2-r.INDICATOR_SIZE/2))("width",r.INDICATOR_SIZE)("height",r.INDICATOR_SIZE)}}let N0t=(()=>{class n extends to{constructor(e){super(e),this.INDICATOR_SIZE=20,this.EMPTY=pe.NONE,this.targets=[],this.selected=P.empty(),this.lastMove=P.empty(),this.captured=P.empty(),this.rules=new ro(ei),this.availableMinimaxes=[new P0t(this.rules,"LinesOfActionMinimax")],this.encoder=qi.encoder,this.tutorial=(new C3e).tutorial,this.updateBoard()}onClick(e,r){var s=this;return A(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());const o=new M(e,r);if(s.selected.equalsValue(o))return s.cancelMoveAttempt(),G.SUCCESS;const c=s.getState().getCurrentPlayer();return s.selected.isAbsent()||s.getState().getPieceAt(o)===c?s.select(o):s.concludeMove(o)})()}concludeMove(e){var r=this;return A(function*(){const s=qi.from(r.selected.get(),e);return s.isSuccess()?r.chooseMove(s.get(),r.rules.node.gameState):r.cancelMove(s.getReason())})()}select(e){var r=this;return A(function*(){return r.getState().getPieceAt(e)!==r.getState().getCurrentPlayer()?r.cancelMove(tt.MUST_CHOOSE_PLAYER_PIECE()):(r.selected=P.of(e),r.targets=ro.possibleTargets(r.getState(),r.selected.get()),0===r.targets.length?r.cancelMove(VH.PIECE_CANNOT_MOVE()):G.SUCCESS)})()}updateBoard(){if(this.cancelMoveAttempt(),this.board=this.getState().board,this.lastMove=this.rules.node.move,this.lastMove.isPresent()){const e=this.lastMove.get();this.captured=this.getPreviousState().getPieceAt(e.getEnd()).isPlayer()?P.of(e.getEnd()):P.empty()}}cancelMoveAttempt(){this.selected=P.empty(),this.targets=[]}getSquareClasses(e,r){const s=new M(e,r);if(this.lastMove.isPresent()){const i=this.lastMove.get().getStart(),o=this.lastMove.get().getEnd();if(this.captured.isPresent()&&s.equals(this.captured.get()))return["captured-fill"];if(s.equals(i)||s.equals(o))return["moved-fill"]}return[]}getPieceClasses(e,r){const s=this.board[r][e],i=new M(e,r),o=[this.getPlayerClass(s)];return this.selected.isPresent()&&this.selected.get().equals(i)&&o.push("selected-stroke"),o}}return n.\u0275fac=function(e){return new(e||n)(J(Pn))},n.\u0275cmp=gt({type:n,selectors:[["app-linesofaction"]],features:[l],decls:3,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","0 -4 800 808","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","indicator",3,"click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base",3,"ngClass"],["class","base",3,"id","ngClass",4,"ngIf"],[1,"base",3,"id","ngClass"],[1,"indicator",3,"click"]],template:function(e,r){1&e&&(F(),b(0,"svg",0),x(1,b0t,2,1,"g",1),x(2,O0t,1,4,"rect",2),O()),2&e&&(S(1),T("ngForOf",r.board),S(1),T("ngForOf",r.targets))},dependencies:[dn,An,en],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class $4 extends xc{constructor(t,e,r,s={top:0,bottom:0,left:0,right:0}){super(t.x,t.y),this.direction=e,this.orientation=r,this.captures=s}toString(){return`LodestoneMove(${this.coord.toString()}, ${this.direction}, ${this.orientation}, { top: ${this.captures.top}, bottom: ${this.captures.bottom}, left: ${this.captures.left}, right: ${this.captures.right} })`}equals(t){return this===t||!(!1===this.coord.equals(t.coord)||this.orientation!==t.orientation||this.direction!==t.direction||this.captures.top!==t.captures.top||this.captures.bottom!==t.captures.bottom||this.captures.left!==t.captures.left||this.captures.right!==t.captures.right)}}$4.encoder=new class extends mi{encodeMove(n){return{coord:M.encoder.encode(n.coord),direction:n.direction,orientation:n.orientation,captures:n.captures}}decodeMove(n){const t=n;return ve(null!=t.coord,"Invalid encoded LodestoneMove"),ve(null!=t.direction,"Invalid encoded LodestoneMove"),ve(null!=t.orientation,"Invalid encoded LodestoneMove"),ve(null!=t.captures,"Invalid encoded LodestoneMove"),new $4(M.encoder.decode(t.coord),t.direction,t.orientation,t.captures)}};class so{constructor(t){this.unreachable=t}isLodestone(){return!1}isPlayerPiece(){return!1}isEmpty(){return!0}isUnreachable(){return this.unreachable}equals(t){return this===t}}so.UNREACHABLE=new so(!0),so.EMPTY=new so(!1);class Wc{constructor(t){this.owner=t}static of(t){return t===z.ZERO?Wc.ZERO:Wc.ONE}isLodestone(){return!1}isPlayerPiece(){return!0}isEmpty(){return!1}isUnreachable(){return!1}equals(t){return this===t}}Wc.ZERO=new Wc(z.ZERO),Wc.ONE=new Wc(z.ONE);class Ho{constructor(t,e,r){this.owner=t,this.direction=e,this.orientation=r}static of(t,e){return Ho.LODESTONES[t.value][e.direction][e.orientation]}isLodestone(){return!0}isPlayerPiece(){return!1}isEmpty(){return!1}isUnreachable(){return!1}equals(t){return this===t}}Ho.LODESTONES={0:{push:{diagonal:new Ho(z.ZERO,"push","diagonal"),orthogonal:new Ho(z.ZERO,"push","orthogonal")},pull:{diagonal:new Ho(z.ZERO,"pull","diagonal"),orthogonal:new Ho(z.ZERO,"pull","orthogonal")}},1:{push:{diagonal:new Ho(z.ONE,"push","diagonal"),orthogonal:new Ho(z.ONE,"push","orthogonal")},pull:{diagonal:new Ho(z.ONE,"pull","diagonal"),orthogonal:new Ho(z.ONE,"pull","orthogonal")}}};class yr{constructor(t,e){this.width=t,this.pieces=e}remainingSpaces(){return 5===this.width?8-this.pieces.length:3-this.pieces.length}addCaptured(t,e){if(this.pieces.length+e>=this.width)return 5===this.width?yr.EMPTY_3.addCaptured(t,e+this.pieces.length-5):(ve(this.pieces.length+e===3,"should never put more pieces than the plate can support"),P.empty());{const r=Ke.copyImmutableArray(this.pieces);for(let s=0;s<e;s++)r.push(Wc.of(t));return P.of(new yr(this.width,r))}}getPieceAt(t){return t<this.pieces.length?this.pieces[t]:so.EMPTY}}yr.POSITIONS=["top","bottom","left","right"],yr.EMPTY_5=new yr(5,[]),yr.EMPTY_3=new yr(3,[]);let lr=(()=>{class n extends es{constructor(e,r,s,i){super(e,r),this.lodestones=s,this.pressurePlates=i}static getInitialState(){const e=so.EMPTY,r=Wc.ZERO,s=Wc.ONE;return new n([[e,e,r,s,r,s,e,e],[e,r,s,r,s,r,s,e],[r,s,r,s,r,s,r,s],[s,r,s,e,e,r,s,r],[r,s,r,e,e,s,r,s],[s,r,s,r,s,r,s,r],[e,s,r,s,r,s,r,e],[e,e,s,r,s,r,e,e]],0,new Vn,{top:P.of(yr.EMPTY_5),bottom:P.of(yr.EMPTY_5),left:P.of(yr.EMPTY_5),right:P.of(yr.EMPTY_5)})}withBoard(e){return new n(e,this.turn,this.lodestones,this.pressurePlates)}remainingSpaces(){const e=this.remainingSpacesDetails();return e.top+e.bottom+e.left+e.right}remainingSpacesDetails(){const e={top:0,bottom:0,left:0,right:0};for(const r of yr.POSITIONS){const s=this.pressurePlates[r];s.isPresent()&&(e[r]=s.get().remainingSpaces())}return e}numberOfPieces(){const e=[0,0];for(let r=0;r<n.SIZE;r++)for(let s=0;s<n.SIZE;s++){const i=this.getPieceAtXY(s,r);i.isPlayerPiece()&&(e[i.owner.value]+=1)}return e}getScores(){const e=this.numberOfPieces();return[24-e[1],24-e[0]]}nextLodestoneDirection(){const e=this.getCurrentPlayer(),r=this.lodestones.get(e);if(!r.isPresent())return P.empty();{const s=this.getPieceAt(r.get());switch(ve(s.isLodestone(),"Piece must be lodestone (invariant from LodestoneState)"+r.get()),s.direction){case"push":return P.of("pull");case"pull":return P.of("push")}}}}return n.SIZE=8,n})();const qe=so.UNREACHABLE,fe=so.EMPTY,ms=Wc.ZERO,io=Wc.ONE,Km=Ho.of(z.ONE,{direction:"push",orientation:"orthogonal"}),HH={top:P.of(yr.EMPTY_5),bottom:P.of(yr.EMPTY_5),left:P.of(yr.EMPTY_5),right:P.of(yr.EMPTY_5)};class y3e extends K1{constructor(){super(...arguments),this.tutorial=[ce.informational($localize`Board and aim of the game`,$localize`Lodestone is played on a 8x8 board, which contains so-called <i>pressure plates</i> along the board, that will contain captured pieces. The initial board is shown here. The aim of the game is to be the only player with pieces remaining on the board. To do so, you will have to either push your opponent's pieces off the board, or to crush them with your pieces. You will do it by using a lodestone.`,lr.getInitialState()),ce.forClick($localize`Selecting a lodestone`,$localize`To perform a move, you have to place your lodestone on the board. Your lodestone has two sides: <ul><li>its <i>repelling</i> side with which it will repel the opponent's pieces (indicated by the outward triangles of your opponent's color on the lodestone), and</li><li>its <i>attracting</i> side with which it will attract your pieces (indicated by the inward triangles of your color on the lodestone).</li></ul>Your lodestone can be placed to move pieces orthogonally or diagonally. All available lodestone sides and orientation are shown below the board.<br/><br/>You're playing Dark. Select the lodestone that repels your opponent's pieces diagonally.`,lr.getInitialState(),["#lodestone_push_diagonal"],$localize`Congratulations!`,$localize`This is not the right lodestone, try again.`),ce.informational($localize`The repelling lodestone`,$localize`Upon placing a lodestone on the board, it will move all pieces it acts upon (according to its direction and orientation) simultaneously. Let us first see how the repelling lodestone acts on the pieces. All the opponent's pieces aligned with the lodestone, as indicated by the triangles' orientations, will be pushed one square away from the lodestone. An opponent's piece will be blocked in case it encounters on its way either one of your piece, a lodestone, or another blocked piece. Finally, if an opponent's piece falls out of the board, it is captured.`,lr.getInitialState()),ce.informational($localize`The attracting lodestone`,$localize`When the lodestone is on its attracting side it will pull your pieces one square towards it. In case one of your pieces encounters a lodestone on its way or another blocked piece, it is blocked. However, if it encounter an opponent's piece, it will capture it.`,lr.getInitialState()),ce.informational($localize`Flipping the lodestone`,$localize`Note that, after every move, you must flip your lodestone: if it was on its repelling side, you must use it on its attracting side, and vice versa. Also, you are allowed to place your lodestone on the same location as it was on your previous turn.`,lr.getInitialState()),ce.fromPredicate($localize`Capturing`,$localize`To summarize, it is possible to capture the opponent's pieces in two ways:<ul><li>with a repelling lodestone, by pushing your opponent's pieces out of the board, or</li><li>with an attracting lodestone, by moving your pieces on your opponent's pieces.</li></ul>Once a lodestone is placed and the pieces have been moved and/or captured, in case any of the opponent's pieces have been captured, you have to place them on the <i>pressure plates</i> that lie around the board. To do so, click on an empty space of the pressure plate of your choice for each capture. You can cancel this by clicking again on a piece you just put on a pressure plate.<br/><br/>You're playing Dark. Try to perform a move that captures at least one of your opponent's piece, and place your capture(s) on pressure plates.`,lr.getInitialState(),new $4(new M(0,6),"pull","orthogonal",{top:2,bottom:1,left:1,right:1}),(t,e,r)=>32===r.remainingSpaces()?G.failure($localize`You have not captured any of the opponent's pieces, try again!`):G.SUCCESS,$localize`Congratulations!`),ce.fromPredicate($localize`Crumbling a first pressure plate`,$localize`When a pressure plate is full, it will crumble and take a full row or column of the board with it! All pieces that are on the crumbled squares are considered lost, but will not have to be placed on pressure plates. You have here a board with a pressure plate that only requires one more piece to crumble.<br/><br/>You're playing Dark. Perform a move that captures at least one piece, and fill that pressure plate to make it crumble.`,new lr([[fe,fe,fe,fe,io,fe,fe,fe],[fe,fe,ms,fe,fe,io,fe,fe],[fe,fe,Km,fe,fe,fe,fe,ms],[fe,fe,fe,fe,io,fe,fe,ms],[fe,fe,fe,fe,fe,ms,fe,fe],[fe,fe,fe,fe,fe,fe,fe,fe],[fe,fe,fe,fe,fe,fe,fe,fe],[fe,fe,fe,fe,fe,fe,fe,fe]],0,new Vn([{key:z.ONE,value:new M(2,2)}]),{...HH,top:yr.EMPTY_5.addCaptured(z.ONE,4)}),new $4(new M(6,2),"push","diagonal",{top:1,bottom:0,left:0,right:0}),(t,e,r)=>5===r.pressurePlates.top.get().width?G.failure($localize`You must capture and place your capture on the top pressure plate to make it crumble!`):G.SUCCESS,$localize`Congratulations!`),ce.fromPredicate($localize`Crumbling a second pressure plate`,$localize`Once a pressure plate has crumbled, a shorter pressure plate takes it place. It is the case here, where only 3 spots are available on the top pressure plate.<br/><br/>You're playing Dark. Perform a move that captures enough pieces to fill the top pressure plate, and make it crumble.`,new lr([[qe,qe,qe,qe,qe,qe,qe,qe],[fe,fe,fe,fe,fe,fe,fe,fe],[fe,fe,fe,fe,fe,fe,fe,ms],[fe,fe,fe,fe,fe,ms,fe,ms],[fe,Km,fe,fe,io,fe,fe,fe],[fe,fe,fe,fe,fe,fe,fe,fe],[fe,fe,fe,fe,io,fe,fe,fe],[fe,fe,fe,fe,fe,fe,fe,fe]],0,new Vn([{key:z.ONE,value:new M(1,4)}]),{...HH,top:yr.EMPTY_3.addCaptured(z.ONE,2)}),new $4(new M(3,5),"pull","diagonal",{top:1,bottom:0,left:0,right:0}),(t,e,r)=>r.pressurePlates.top.isPresent()?G.failure($localize`You must capture and place your capture on the top pressure plate to make it crumble a second time!`):G.SUCCESS,$localize`Congratulations!`),ce.informational($localize`Minimal board`,$localize`After a pressure plate has crumbled for a second time, there is no more pressure plate available on that side. In case all pressure plates have crumbled, the board is reduced to a 4x4 board.`,new lr([[qe,qe,qe,qe,qe,qe,qe,qe],[qe,qe,qe,qe,qe,qe,qe,qe],[qe,qe,ms,io,fe,fe,qe,qe],[qe,qe,Km,io,fe,fe,qe,qe],[qe,qe,fe,ms,ms,fe,qe,qe],[qe,qe,ms,fe,fe,fe,qe,qe],[qe,qe,qe,qe,qe,qe,qe,qe],[qe,qe,qe,qe,qe,qe,qe,qe]],0,new Vn([{key:z.ONE,value:new M(2,3)}]),{top:P.empty(),bottom:P.empty(),left:P.empty(),right:P.empty()})),ce.fromMove($localize`Making the lodestone fall`,$localize`If, at any point during the game, your lodestone is situated on a square that crumbles with a pressure plate, you will be allowed to select any lodestone side on your next turn.<br/><br/>In this board, playing Dark, you can place your lodestone and make a pressure plate crumble so that your lodestone falls too, allowing to choose more freely its side on your next turn. Do it!`,new lr([[fe,fe,fe,fe,fe,fe,fe,fe],[fe,fe,fe,fe,fe,io,fe,fe],[fe,fe,fe,Km,fe,fe,ms,fe],[fe,fe,ms,ms,io,fe,fe,ms],[fe,fe,fe,fe,fe,ms,fe,fe],[fe,fe,ms,fe,fe,fe,fe,fe],[fe,fe,io,fe,fe,fe,fe,fe],[fe,fe,fe,fe,fe,fe,fe,fe]],0,new Vn([{key:z.ONE,value:new M(3,2)}]),{...HH,top:yr.EMPTY_5.addCaptured(z.ONE,4)}),[new $4(new M(4,0),"pull","diagonal",{top:1,bottom:0,left:0,right:0})],$localize`Congratulations! At your next turn, you will be allowed to place your lodestone on any side.`,$localize`Failed, try again.`),ce.fromMove($localize`End of the game`,$localize`In order to win, you must take out all of your opponent's pieces.<br/><br/>Here, you can win in a single move, do it!`,new lr([[qe,qe,qe,qe,qe,qe,qe,qe],[qe,qe,qe,qe,qe,qe,qe,qe],[qe,io,ms,io,fe,fe,qe,qe],[qe,io,Km,fe,io,fe,qe,qe],[qe,fe,fe,ms,ms,fe,qe,qe],[qe,io,ms,fe,io,fe,qe,qe],[qe,fe,fe,fe,ms,fe,qe,qe],[qe,qe,qe,qe,qe,qe,qe,qe]],0,new Vn([{key:z.ONE,value:new M(2,3)}]),{top:P.empty(),bottom:yr.EMPTY_3.addCaptured(z.ZERO,2),left:P.of(yr.EMPTY_3),right:P.empty()}),[new $4(new M(4,2),"pull","orthogonal",{top:0,bottom:0,left:3,right:0})],$localize`Congratulations, you won!`,$localize`This is not the winning move. Try again.`)]}}let N9=(()=>{class n{}return n.MUST_FLIP_LODESTONE=()=>$localize`You must flip your lodestone before putting it back on the board.`,n.MUST_PLACE_CAPTURES_ON_PRESSURE_PLATES=()=>$localize`As long as there are pressure plates, you must place all the pieces that you have captured on them.`,n.TARGET_IS_CRUMBLED=()=>$localize`You must place your lodestone on a non-crumbled square!`,n.TOO_MANY_CAPTURES_ON_SAME_PRESSURE_PLATE=()=>$localize`You placed too many captures on the same pressure plate, which has not enough space left.`,n.MUST_PLACE_CAPTURES=()=>$localize`You must place your captures on the pressure plates, on the side of the board.`,n.NO_CAPTURES_TO_PLACE_YET=()=>$localize`You cannot place any capture now, you must first place your lodestone on the board!`,n})();class L2 extends U1{constructor(){super(lr)}static get(){return L2.singleton.isAbsent()&&(L2.singleton=P.of(new L2)),L2.singleton.get()}applyLegalMove(t,e,r){const s=e.getCurrentPlayer(),i=s.getOpponent(),o=Ke.copyBiArray(r.board),c=e.lodestones.getCopy();c.put(s,t.coord);const u={...e.pressurePlates};return this.updatePressurePlates(o,u,c,i,t.captures),new lr(o,e.turn+1,c,u)}updatePressurePlates(t,e,r,s,i){for(const o of yr.POSITIONS)e[o]=this.updatePressurePlate(t,o,e[o],r,s,i[o])}updatePressurePlate(t,e,r,s,i,o){if(r.isPresent()){const c=r.get().addCaptured(i,o),u=L2.THREATENED_COORD_RANGE.get(e).get();return c.isAbsent()?(this.removePressurePlate(t,u.startForBigPlate,u.direction,s),this.removePressurePlate(t,u.startForSmallPlate,u.direction,s)):c.get().width<r.get().width&&this.removePressurePlate(t,u.startForBigPlate,u.direction,s),c}return r}removePressurePlate(t,e,r,s){for(let i=e;i.isInRange(lr.SIZE,lr.SIZE);i=i.getNext(r)){for(const o of z.PLAYERS)s.get(o).equalsValue(i)&&s.delete(o);t[i.y][i.x]=so.UNREACHABLE}}isLegal(t,e){const r=this.isLegalWithoutCaptures(e,t.coord,t.direction);if(r.isFailure())return U.failure(r.getReason());const s=this.applyMoveWithoutPlacingCaptures(e,t.coord,t);if(t.captures.top+t.captures.bottom+t.captures.left+t.captures.right!==Math.min(s.captures.length,e.remainingSpaces()))return U.failure(N9.MUST_PLACE_CAPTURES_ON_PRESSURE_PLATES());for(const c of yr.POSITIONS){const u=e.pressurePlates[c];if(u.isPresent()&&u.get().remainingSpaces()<t.captures[c])return U.failure(N9.TOO_MANY_CAPTURES_ON_SAME_PRESSURE_PLATE())}return U.success(s)}applyMoveWithoutPlacingCaptures(t,e,r){let s;const i=Ke.copyBiArray(t.board),o=t.lodestones.get(t.getCurrentPlayer());if(o.isPresent()){const c=o.get();i[c.y][c.x]=so.EMPTY}return s="pull"===r.direction?this.applyPull(t,i,e,r.orientation):this.applyPush(t,i,e,r.orientation),s.board[e.y][e.x]=Ho.of(t.getCurrentPlayer(),r),s.moved.push(e),s}applyPull(t,e,r,s){const i=t.getCurrentPlayer(),o=i.getOpponent(),c=[],u=[],h="diagonal"===s?Ne.DIAGONALS:Ne.ORTHOGONALS;for(const p of h)for(let m=r.getNext(p);t.isOnBoard(m);m=m.getNext(p)){const C=e[m.y][m.x],w=m.getNext(p);if(t.isOnBoard(w)){const I=e[w.y][w.x];I.isPlayerPiece()&&I.owner===i&&(C.isEmpty()?(u.push(m),e[m.y][m.x]=I,u.push(w),e[w.y][w.x]=so.EMPTY):C.isPlayerPiece()&&C.owner===o&&(c.push(m),e[m.y][m.x]=I,u.push(w),e[w.y][w.x]=so.EMPTY))}}return{board:e,captures:c,moved:u}}applyPush(t,e,r,s){const o=t.getCurrentPlayer().getOpponent(),c=[],u=[],h="diagonal"===s?Ne.DIAGONALS:Ne.ORTHOGONALS;for(const p of h)for(let C=r.getNext(p,lr.SIZE);!1===C.equals(r);C=C.getPrevious(p))if(t.isOnBoard(C)){const w=e[C.y][C.x];if(w.isPlayerPiece()&&w.owner===o){const I=C.getNext(p);if(t.isOnBoard(I)){const H=e[I.y][I.x];H.isUnreachable()?(c.push(C),e[C.y][C.x]=so.EMPTY):H.isEmpty()&&(u.push(I),e[I.y][I.x]=w,u.push(C),e[C.y][C.x]=so.EMPTY)}else c.push(C),e[C.y][C.x]=so.EMPTY}}return{board:e,captures:c,moved:u}}isLegalWithoutCaptures(t,e,r){const s=this.isTargetLegal(t,e);if(s.isFailure())return s;const i=t.nextLodestoneDirection();return!1===(i.isAbsent()||i.equalsValue(r))?G.failure(N9.MUST_FLIP_LODESTONE()):G.SUCCESS}isTargetLegal(t,e){const r=t.getPieceAt(e);if(r.isUnreachable())return G.failure(N9.TARGET_IS_CRUMBLED());if(r.isPlayerPiece())return G.failure(tt.MUST_CLICK_ON_EMPTY_SQUARE());const s=t.getCurrentPlayer();return r.isLodestone()&&r.owner!==s?G.failure(tt.MUST_CLICK_ON_EMPTY_SQUARE()):G.SUCCESS}getGameStatus(t){const r=t.gameState.numberOfPieces();return 0===r[0]&&0===r[1]?xe.DRAW:0===r[0]?xe.ONE_WON:0===r[1]?xe.ZERO_WON:xe.ONGOING}}L2.THREATENED_COORD_RANGE=Vn.from({top:{startForBigPlate:new M(0,0),startForSmallPlate:new M(0,1),direction:Ne.RIGHT},bottom:{startForBigPlate:new M(0,lr.SIZE-1),startForSmallPlate:new M(0,lr.SIZE-2),direction:Ne.RIGHT},left:{startForBigPlate:new M(0,0),startForSmallPlate:new M(1,0),direction:Ne.DOWN},right:{startForBigPlate:new M(lr.SIZE-1,0),startForSmallPlate:new M(lr.SIZE-2,0),direction:Ne.DOWN}}),L2.singleton=P.empty();class A0t extends G1{getListMoves(t){const e=t.gameState;return this.flatMapEmptyCoords(e,r=>{const s=[];for(const i of this.nextDirection(e)){const o=["diagonal","orthogonal"];for(const c of o){const p=L2.get().applyMoveWithoutPlacingCaptures(e,r,{direction:i,orientation:c}).captures.length;for(const m of this.captureCombinations(e,p))s.push(new $4(r,i,c,m))}}return s})}captureCombinations(t,e){if(0===e)return new Dt([{top:0,bottom:0,left:0,right:0}]);{const r=new Dt,s=t.remainingSpacesDetails(),i=this.captureCombinations(t,e-1);for(const o of i)o.top+1<=s.top&&r.add({...o,top:o.top+1}),o.bottom+1<=s.bottom&&r.add({...o,bottom:o.bottom+1}),o.left+1<=s.left&&r.add({...o,left:o.left+1}),o.right+1<=s.right&&r.add({...o,right:o.right+1});return 0===r.size()?i:r}}flatMapEmptyCoords(t,e){let r=[];for(let s=0;s<lr.SIZE;s++)for(let i=0;i<lr.SIZE;i++){const o=new M(i,s),c=t.getPieceAt(o);(c.isEmpty()&&!1===c.isUnreachable()||c.isLodestone()&&c.owner===t.getCurrentPlayer())&&(r=r.concat(e(o)))}return r}nextDirection(t){const e=t.nextLodestoneDirection();return e.isPresent()?[e.get()]:["push","pull"]}getBoardValue(t){const e=t.gameState.getScores();let r;return r=24===e[0]&&24!==e[1]?z.ZERO.getVictoryValue():24!==e[0]&&24===e[1]?z.ONE.getVictoryValue():Ct.from(e[0],e[1]).value,new Ct(r)}}function I0t(n,t){if(1&n&&(F(),Q(0,"circle",10)),2&n){const e=v(2),r=e.index,s=e.$implicit,i=v().index,o=v();We("id","piece_",r,"_",i,""),T("ngClass",s.pieceClasses),D("r",o.PIECE_RADIUS)("cx",o.SPACE_SIZE*r+o.STROKE_WIDTH+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*i+o.STROKE_WIDTH+o.SPACE_SIZE/2)}}function x0t(n,t){if(1&n&&(F(),Q(0,"polygon",15)),2&n){const e=v().$implicit,r=v(3).$implicit,s=v(2);pu("transform","rotate(",90*e,")"),T("ngClass",r.lodestone.movingClass),D("points",s.TRIANGLE_OUT)}}function k0t(n,t){if(1&n&&(F(),Q(0,"polygon",15)),2&n){const e=v().$implicit,r=v(3).$implicit,s=v(2);pu("transform","rotate(",90*e,")"),T("ngClass",r.lodestone.movingClass),D("points",s.TRIANGLE_IN)}}function L0t(n,t){if(1&n&&(F(),b(0,"g"),x(1,x0t,1,3,"polygon",14),x(2,k0t,1,3,"polygon",14),O()),2&n){const e=v(3).$implicit;S(1),T("ngIf","push"===e.lodestone.direction),S(1),T("ngIf","pull"===e.lodestone.direction)}}const E3e=function(){return[0,1,2,3]};function R0t(n,t){if(1&n&&(F(),b(0,"g",11),Q(1,"circle",12)(2,"circle",13),b(3,"g"),x(4,L0t,3,2,"g",1),O()()),2&n){const e=v(2),r=e.index,s=e.$implicit,i=v().index,o=v();D("transform",o.getSquareTransform(r,i)),S(1),T("ngClass",s.lodestone.selectedClass),D("r",o.PIECE_RADIUS),S(1),T("ngClass",s.lodestone.pieceClasses),D("r",o.PIECE_RADIUS/4),S(1),pu("transform","rotate(","diagonal"===s.lodestone.orientation?45:0,")"),S(1),T("ngForOf",rr(7,E3e))}}function D0t(n,t){if(1&n){const e=Oe();F(),b(0,"g",6),ee("click",function(){he(e);const s=v().$implicit;return le(v(2).selectCoord(s.coord))}),Q(1,"rect",7),x(2,I0t,1,6,"circle",8),x(3,R0t,5,8,"g",9),O()}if(2&n){const e=v(),r=e.index,s=e.$implicit,i=v().index,o=v();We("id","square_",r,"_",i,""),S(1),T("ngClass",s.squareClasses),D("x",o.SPACE_SIZE*r+o.STROKE_WIDTH)("y",o.SPACE_SIZE*i+o.STROKE_WIDTH)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),S(1),T("ngIf",s.hasPiece),S(1),T("ngIf",s.lodestone)}}function z0t(n,t){if(1&n&&(F(),b(0,"g"),x(1,D0t,4,9,"g",5),O()),2&n){const e=t.$implicit;S(1),T("ngIf",!1===e.crumbled)}}function V0t(n,t){if(1&n&&(F(),b(0,"g"),x(1,z0t,2,1,"g",1),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e)}}function H0t(n,t){if(1&n&&(F(),b(0,"g",16),Q(1,"circle",17),O()),2&n){const e=t.$implicit,r=t.index,s=v();y1("id","capture_",r,""),D("transform",s.getCaptureTransform(r)),S(1),T("ngClass",e.pieceClasses),D("r",s.PIECE_RADIUS)}}function F0t(n,t){if(1&n&&(F(),b(0,"g"),Q(1,"polygon",15),O()),2&n){const e=t.$implicit,r=v().$implicit,s=v();S(1),pu("transform","rotate(",90*e,")"),T("ngClass",r.movingClass),D("points","push"===r.direction?s.TRIANGLE_OUT:s.TRIANGLE_IN)}}function B0t(n,t){if(1&n){const e=Oe();F(),b(0,"g",6),ee("click",function(){const i=he(e).$implicit;return le(v().selectLodestone(i))}),Q(1,"circle",12)(2,"circle",13),b(3,"g"),x(4,F0t,2,3,"g",1),O()()}if(2&n){const e=t.$implicit,r=t.index,s=v();We("id","lodestone_",e.direction,"_",e.orientation,""),D("transform",s.getAvailableLodestoneTransform(r)),S(1),T("ngClass",e.selectedClass),D("r",s.PIECE_RADIUS),S(1),T("ngClass",e.pieceClasses),D("r",s.PIECE_RADIUS/4),S(1),pu("transform","rotate(","diagonal"===e.orientation?45:0,")"),S(1),T("ngForOf",rr(9,E3e))}}function $0t(n,t){if(1&n&&(F(),Q(0,"circle",10)),2&n){const e=v(),r=e.index,s=e.$implicit,i=v().$implicit,o=v();We("id","platePiece_",i.position,"_",r,""),T("ngClass",s.pieceClasses),D("r",o.PIECE_RADIUS)("cx",o.SPACE_SIZE*s.coord.x+o.STROKE_WIDTH+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*s.coord.y+o.STROKE_WIDTH+o.SPACE_SIZE/2)}}function U0t(n,t){if(1&n){const e=Oe();F(),b(0,"g")(1,"g",6),ee("click",function(){const s=he(e),i=s.$implicit,o=s.index,c=v().$implicit;return le(v().onPressurePlateClick(i.temporary,c.position,o))}),Q(2,"rect",18),x(3,$0t,1,6,"circle",8),O()()}if(2&n){const e=t.$implicit,r=t.index,s=v().$implicit,i=v();D("transform",i.getPressurePlateTransform(s.position)),S(1),We("id","plate_",s.position,"_",r,""),S(1),We("id","plateSquare_",s.position,"_",r,""),T("ngClass",e.squareClasses),D("x",i.SPACE_SIZE*e.coord.x+i.STROKE_WIDTH)("y",i.SPACE_SIZE*e.coord.y+i.STROKE_WIDTH)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),S(1),T("ngIf",e.hasPiece)}}function G0t(n,t){if(1&n&&(F(),b(0,"g",16),x(1,U0t,4,11,"g",1),O()),2&n){const e=t.$implicit;y1("id","pressurePlate_",e.position,""),S(1),T("ngForOf",e.coords)}}function W0t(n,t){if(1&n&&(F(),Q(0,"rect",19)),2&n){const e=v();We("id","selection_",e.viewInfo.selected.get().x,"_",e.viewInfo.selected.get().y,""),D("x",e.SPACE_SIZE*e.viewInfo.selected.get().x+e.STROKE_WIDTH)("y",e.SPACE_SIZE*e.viewInfo.selected.get().y+e.STROKE_WIDTH)("width",e.SPACE_SIZE)("height",e.SPACE_SIZE)}}class R2 extends t8{constructor(t){super(t),this.viewInfo={availableLodestones:[],capturesToPlace:[],boardInfo:[],currentPlayerClass:"",opponentClass:"",pressurePlates:[],selected:P.empty(),pressurePlateShift:{top:new Gt(0,0),left:new Gt(0,0),right:new Gt(0,0),bottom:new Gt(0,0)}},this.stateAfterPlacingLodestone=P.empty(),this.lastInfos=P.empty(),this.capturesToPlace=0,this.selectedCoord=P.empty(),this.selectedLodestone=P.empty(),this.captures={top:0,bottom:0,left:0,right:0},this.rules=L2.get(),this.tutorial=(new y3e).tutorial,this.availableMinimaxes=[new A0t(this.rules,"LodestoneDummyMinimax")],this.encoder=$4.encoder,this.PIECE_RADIUS=.5*(this.SPACE_SIZE-2*this.STROKE_WIDTH);const e=.8*this.PIECE_RADIUS,r=.3*this.PIECE_RADIUS,s=.2*this.PIECE_RADIUS;this.TRIANGLE_OUT=`${e},0 ${r},${s} ${r},-${s}`,this.TRIANGLE_IN=`${r},0 ${e},${r} ${e},-${r}`,this.displayedState=this.getState(),this.scores=P.of([0,0])}ngOnInit(){this.updateBoard()}selectCoord(t){var e=this;return A(function*(){const r=e.canUserPlay("#square_"+t.x+"_"+t.y);if(r.isFailure())return e.cancelMove(r.getReason());if(e.capturesToPlace>0)return e.cancelMove(N9.MUST_PLACE_CAPTURES());const s=L2.get().isTargetLegal(e.getState(),t);return s.isFailure()?e.cancelMove(s.getReason()):e.selectedCoord.equalsValue(t)?(e.cancelMoveAttempt(),G.SUCCESS):(e.selectedCoord=P.of(t),e.selectedLodestone.isPresent()?e.putLodestone():(e.updateViewInfo(),G.SUCCESS))})()}selectLodestone(t){var e=this;return A(function*(){const r=e.canUserPlay("#lodestone_"+t.direction+"_"+t.orientation);if(r.isFailure())return e.cancelMove(r.getReason());ve(0===e.capturesToPlace,"should not be able to click on a lodestone when captures need to be placed");const s=e.getCurrentPlayer(),i=Ho.of(s,t);return e.selectedLodestone.equalsValue(i)?(e.cancelMoveAttempt(),G.SUCCESS):(e.selectedLodestone=P.of(i),e.selectedCoord.isPresent()?e.putLodestone():(e.updateViewInfo(),G.SUCCESS))})()}putLodestone(){var t=this;return A(function*(){ve(t.selectedCoord.isPresent(),"coord should have been selected"),ve(t.selectedLodestone.isPresent(),"lodestone should have been selected");const e=t.selectedCoord.get(),r=t.selectedLodestone.get(),s=t.getState();ve(L2.get().isLegalWithoutCaptures(s,e,r.direction).isSuccess(),"Lodestone component should only allow creation of legal moves");const o=L2.get().applyMoveWithoutPlacingCaptures(s,e,r);return t.lastInfos=P.of(o),t.capturesToPlace=Math.min(o.captures.length,s.remainingSpaces()),0===t.capturesToPlace?t.applyMove():(t.displayedState=t.displayedState.withBoard(o.board),t.stateAfterPlacingLodestone=P.of(t.displayedState),t.updateViewInfo(),G.SUCCESS)})()}applyMove(){var t=this;return A(function*(){ve(t.selectedCoord.isPresent(),"coord should have been selected"),ve(t.selectedLodestone.isPresent(),"lodestone should have been selected");const e=t.selectedCoord.get(),r=t.selectedLodestone.get(),s=new $4(e,r.direction,r.orientation,t.captures);return t.chooseMove(s,t.getState())})()}onPressurePlateClick(t,e,r){return t?this.deselectPressurePlate(e,r):this.selectPressurePlate(e,r)}selectPressurePlate(t,e){var r=this;return A(function*(){const s=r.canUserPlay("#plate_"+t+"_"+e);if(s.isFailure())return r.cancelMove(s.getReason());if(0===r.capturesToPlace)return r.cancelMove(N9.NO_CAPTURES_TO_PLACE_YET());r.capturesToPlace--,r.captures[t]++;const i=r.stateAfterPlacingLodestone.get(),o=r.getCurrentPlayer().getOpponent(),c=Ke.copyBiArray(i.board),u={...i.pressurePlates},h=i.lodestones.getCopy();return L2.get().updatePressurePlates(c,u,h,o,r.captures),r.displayedState=new lr(c,i.turn,h,u),0===r.capturesToPlace?r.applyMove():(r.updateViewInfo(),r.showPressurePlateDifferences(r.getState(),r.displayedState,!0),G.SUCCESS)})()}deselectPressurePlate(t,e){var r=this;return A(function*(){const s=r.canUserPlay("#plate_"+t+"_"+e);if(s.isFailure())return r.cancelMove(s.getReason());r.capturesToPlace++,r.captures[t]--;const i=r.stateAfterPlacingLodestone.get(),o=r.getCurrentPlayer().getOpponent(),c=Ke.copyBiArray(i.board),u={...i.pressurePlates},h=i.lodestones.getCopy();return L2.get().updatePressurePlates(c,u,h,o,r.captures),r.displayedState=new lr(c,i.turn,h,u),r.updateViewInfo(),r.showPressurePlateDifferences(r.getState(),r.displayedState,!0),G.SUCCESS})()}updateBoard(){this.cancelMoveAttempt(),this.rules.node.move.isPresent()&&this.showLastMove(),this.scores=P.of(this.getState().getScores())}cancelMoveAttempt(){this.displayedState=this.getState(),this.stateAfterPlacingLodestone=P.empty(),this.lastInfos=P.empty();const t=this.displayedState.lodestones.get(this.getCurrentPlayer());if(t.isPresent()){const e=Ke.copyBiArray(this.displayedState.board);e[t.get().y][t.get().x]=so.EMPTY,this.displayedState=this.displayedState.withBoard(e)}this.selectedCoord=P.empty(),this.selectedLodestone=P.empty(),this.capturesToPlace=0,this.captures={top:0,bottom:0,left:0,right:0},this.updateViewInfo()}updateViewInfo(){const e=this.getState().getCurrentPlayer();this.viewInfo.currentPlayerClass=this.getPlayerClass(e),this.viewInfo.opponentClass=this.getPlayerClass(e.getOpponent()),this.showBoard(),this.showAvailableLodestones(),this.showCapturesToPlace(),this.showPressurePlates(),this.computePressurePlateShift(),this.lastInfos.isPresent()&&this.showMovedAndCaptured(this.lastInfos.get())}showBoard(){this.viewInfo.boardInfo=[];for(let t=0;t<lr.SIZE;t++){this.viewInfo.boardInfo.push([]);for(let e=0;e<lr.SIZE;e++){const r=new M(e,t);this.viewInfo.boardInfo[t].push(this.getSquareInfo(r))}}this.viewInfo.selected=this.selectedCoord.isPresent()&&!1===this.displayedState.getPieceAt(this.selectedCoord.get()).isUnreachable()?this.selectedCoord:P.empty()}getSquareInfo(t){const e=this.displayedState.getPieceAt(t),r={coord:t,squareClasses:[],crumbled:e.isUnreachable(),hasPiece:e.isPlayerPiece(),pieceClasses:[]};return e.isPlayerPiece()&&(r.pieceClasses=[this.getPlayerClass(e.owner)]),e.isLodestone()&&(r.lodestone={direction:e.direction,pieceClasses:[this.getPlayerClass(e.owner)],selectedClass:"",movingClass:"",orientation:e.orientation},r.lodestone.movingClass=this.getPlayerClass("push"===e.direction?e.owner.getOpponent():e.owner)),r}showAvailableLodestones(){if(this.capturesToPlace>0)this.viewInfo.availableLodestones=[];else{const t=this.getState().getCurrentPlayer(),e=this.getState().nextLodestoneDirection();if(e.isPresent()){const r=e.get();this.viewInfo.availableLodestones=[this.nextLodestone(t,{direction:r,orientation:"orthogonal"}),this.nextLodestone(t,{direction:r,orientation:"diagonal"})]}else this.viewInfo.availableLodestones=[this.nextLodestone(t,{direction:"push",orientation:"orthogonal"}),this.nextLodestone(t,{direction:"push",orientation:"diagonal"}),this.nextLodestone(t,{direction:"pull",orientation:"orthogonal"}),this.nextLodestone(t,{direction:"pull",orientation:"diagonal"})]}}showCapturesToPlace(){const t=this.getCurrentPlayer().getOpponent();this.viewInfo.capturesToPlace=[];for(let e=0;e<this.capturesToPlace;e++)this.viewInfo.capturesToPlace.push({pieceClasses:[this.getPlayerClass(t)]})}nextLodestone(t,e){const r=Ho.of(t,e),s={direction:r.direction,orientation:r.orientation,pieceClasses:[this.getPlayerClass(r.owner)],movingClass:"",selectedClass:""};return s.movingClass=this.getPlayerClass("push"===r.direction?r.owner.getOpponent():r.owner),this.selectedLodestone.equalsValue(r)&&(s.selectedClass="selected-stroke"),s}showPressurePlates(){this.viewInfo.pressurePlates=[];for(const t of yr.POSITIONS){const e=[],r=this.displayedState.pressurePlates[t];if(r.isPresent()){const s=R2.PRESSURE_PLATES_POSITIONS.get(t).get(),i=r.get().width;let o=5===i?s.startForBigPlate:s.startForSmallPlate;for(let c=0;c<i;c++){o=o.getNext(s.direction);const u=r.get().getPieceAt(c);let h="";u.isPlayerPiece()&&(h=this.getPlayerClass(u.owner)),e.push({coord:o,hasPiece:u.isPlayerPiece(),pieceClasses:[h],squareClasses:[],temporary:!1})}}this.viewInfo.pressurePlates.push({position:t,coords:e})}}showLastMove(){const t=this.rules.node.mother.get().gameState,e=this.rules.node.move.get();this.lastInfos=P.of(L2.get().applyMoveWithoutPlacingCaptures(t,e.coord,e)),this.updateViewInfo();const r=this.getState();this.showPressurePlateDifferences(t,r,!1)}showPressurePlateDifferences(t,e,r){for(const s of yr.POSITIONS)this.showPressurePlateDifference(t.pressurePlates[s],e.pressurePlates[s],s,r)}showPressurePlateDifference(t,e,r,s){if(t.isPresent()&&e.isPresent()){const i=t.get(),o=e.get(),c=Me.getNonNullable(this.viewInfo.pressurePlates.find(u=>u.position===r));if(i.width===o.width)for(let u=0;u<o.width;u++){const h=i.getPieceAt(u),p=o.getPieceAt(u);!1===h.equals(p)&&(c.coords[u].squareClasses.push("moved-fill"),c.coords[u].temporary=s,s&&c.coords[u].pieceClasses.push("semi-transparent"))}else for(const u of c.coords)u.squareClasses.push("moved-fill")}}showMovedAndCaptured(t){for(const e of t.moved)this.viewInfo.boardInfo[e.y][e.x].squareClasses.push("moved-fill");for(const e of t.captures)this.viewInfo.boardInfo[e.y][e.x].squareClasses.push("captured-fill")}computePressurePlateShift(){const t=this.displayedState,e=this.getPressurePlateShift(t.pressurePlates.left),r=this.getPressurePlateShift(t.pressurePlates.right),s=this.getPressurePlateShift(t.pressurePlates.top),i=this.getPressurePlateShift(t.pressurePlates.bottom);this.viewInfo.pressurePlateShift.top=new Gt(.5*(e-r),0),this.viewInfo.pressurePlateShift.bottom=new Gt(.5*(e-r),0),this.viewInfo.pressurePlateShift.left=new Gt(0,.5*(s-i)),this.viewInfo.pressurePlateShift.right=new Gt(0,.5*(s-i))}getPressurePlateShift(t){return t.isAbsent()?2:3===t.get().width?1:0}getSquareTransform(t,e){return`translate(${t*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2}, ${e*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2})`}getCaptureTransform(t){return`translate(${(t+(lr.SIZE/2-this.viewInfo.capturesToPlace.length/2))*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2+this.viewInfo.pressurePlateShift.top.x*this.SPACE_SIZE}, ${-2*this.SPACE_SIZE-30+this.STROKE_WIDTH+this.SPACE_SIZE/2})`}getAvailableLodestoneTransform(t){return`translate(${(t+(lr.SIZE/2-this.viewInfo.availableLodestones.length/2))*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2+this.viewInfo.pressurePlateShift.top.x*this.SPACE_SIZE}, ${30+9*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2})`}getPressurePlateTransform(t){return`translate(${this.viewInfo.pressurePlateShift[t].x*this.SPACE_SIZE}, ${this.viewInfo.pressurePlateShift[t].y*this.SPACE_SIZE})`}}R2.PRESSURE_PLATE_EXTRA_SHIFT=.2,R2.PRESSURE_PLATES_POSITIONS=Vn.from({top:{startForBigPlate:new M(.5,-1-R2.PRESSURE_PLATE_EXTRA_SHIFT),startForSmallPlate:new M(1.5,0-R2.PRESSURE_PLATE_EXTRA_SHIFT),direction:Ne.RIGHT},bottom:{startForBigPlate:new M(.5,8+R2.PRESSURE_PLATE_EXTRA_SHIFT),startForSmallPlate:new M(1.5,7+R2.PRESSURE_PLATE_EXTRA_SHIFT),direction:Ne.RIGHT},left:{startForBigPlate:new M(-1-R2.PRESSURE_PLATE_EXTRA_SHIFT,.5),startForSmallPlate:new M(0-R2.PRESSURE_PLATE_EXTRA_SHIFT,1.5),direction:Ne.DOWN},right:{startForBigPlate:new M(8+R2.PRESSURE_PLATE_EXTRA_SHIFT,.5),startForSmallPlate:new M(7+R2.PRESSURE_PLATE_EXTRA_SHIFT,1.5),direction:Ne.DOWN}}),R2.\u0275fac=function(t){return new(t||R2)(J(Pn))},R2.\u0275cmp=gt({type:R2,selectors:[["app-lodestone"]],features:[l],decls:6,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-100 -220 1016 1256","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id",4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],["class","base no-fill selected-stroke",3,"id",4,"ngIf"],[3,"id","click",4,"ngIf"],[3,"id","click"],[1,"base",3,"ngClass"],["class","base",3,"id","ngClass",4,"ngIf"],["class","lodestone",4,"ngIf"],[1,"base",3,"id","ngClass"],[1,"lodestone"],["cx","0","cy","0",1,"base","black-fill","outside",3,"ngClass"],["cx","0","cy","0",1,"base","no-stroke",3,"ngClass"],["class","base no-stroke",3,"ngClass",4,"ngIf"],[1,"base","no-stroke",3,"ngClass"],[3,"id"],["cx","0","cy","0",1,"base",3,"ngClass"],["rx","20","ry","20",1,"base",3,"id","ngClass"],[1,"base","no-fill","selected-stroke",3,"id"]],template:function(t,e){1&t&&(F(),b(0,"svg",0),x(1,V0t,2,1,"g",1),x(2,H0t,2,4,"g",2),x(3,B0t,5,10,"g",3),x(4,G0t,2,2,"g",2),x(5,W0t,1,6,"rect",4),O()),2&t&&(S(1),T("ngForOf",e.viewInfo.boardInfo),S(1),T("ngForOf",e.viewInfo.capturesToPlace),S(1),T("ngForOf",e.viewInfo.availableLodestones),S(1),T("ngForOf",e.viewInfo.pressurePlates),S(1),T("ngIf",e.viewInfo.selected.isPresent()))},dependencies:[dn,An,en],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});let qP=(()=>{class n{}return n.START_COORD_OUT_OF_RANGE=()=>$localize`Start coord cannot be out of range`,n.END_COORD_OUT_OF_RANGE=()=>$localize`End coord cannot be out of range`,n.PAWN_MUST_MOVE_ONE_DIAGONAL_STEP=()=>$localize`Pawns must move one step diagonally.`,n.DRONE_MUST_DO_TWO_ORTHOGONAL_STEPS=()=>$localize`Drones must move one or two steps in any direction.`,n})();class _s extends r8{constructor(t,e,r){super(t,e),this.calledTheClock=r}static from(t,e,r=!1){if(t.isNotInRange(4,8))return U.failure(qP.START_COORD_OUT_OF_RANGE());if(e.isNotInRange(4,8))return U.failure(qP.END_COORD_OUT_OF_RANGE());if(e.equals(t))return U.failure(tt.MOVE_CANNOT_BE_STATIC());const s=Ne.factory.fromDelta(e.x-t.x,e.y-t.y);return s.isFailure()?U.failure(s.getReason()):U.success(new _s(t,e,r))}toString(){const t=this.calledTheClock?", CALL_THE_CLOCK":"";return"MartianChessMove(("+this.getStart().x+", "+this.getStart().y+") -> ("+this.getEnd().x+", "+this.getEnd().y+")"+t+")"}equals(t){return!1!==this.getStart().equals(t.getStart())&&!1!==this.getEnd().equals(t.getEnd())&&this.calledTheClock===t.calledTheClock}isValidForPawn(){return this.getStart().getVectorToward(this.getEnd()).isDiagonalOfLength(1)}isValidForDrone(){return this.getStart().getDistance(this.getEnd())<=2}isUndoneBy(t){if(t.isAbsent())return!1;const e=t.get();return e.getEnd().equals(this.getStart())&&e.getStart().equals(this.getEnd())}}_s.encoder=Cn.tuple([M.numberEncoder(4,8),M.numberEncoder(4,8),Cn.booleanEncoder],n=>[n.getStart(),n.getEnd(),n.calledTheClock],n=>_s.from(n[0],n[1],n[2]).get());class Vt{constructor(t){this.value=t}static tryMerge(t,e){ve(t!==Vt.EMPTY&&e!==Vt.EMPTY,"tryMerge cannot be called with empty pieces");const s=t.value+e.value;return 2===s||3===s?P.of(Vt.from(s)):P.empty()}static from(t){return t===Vt.DRONE.value?Vt.DRONE:(Me.expectToBe(t,Vt.QUEEN.value),Vt.QUEEN)}getValue(){return this.value}equals(t){return this.getValue()===t.getValue()}}Vt.EMPTY=new Vt(0),Vt.PAWN=new Vt(1),Vt.DRONE=new Vt(2),Vt.QUEEN=new Vt(3);class b5{constructor(t){this.captures=t,t.makeImmutable()}static from(t){const e=new Vn;for(const r of t)b5.addToMap(e,r);return new b5(e)}static addToMap(t,e){const r=t.get(e);r.isPresent()?t.replace(e,r.get()+1):t.set(e,1)}toValue(){let t=0;return this.captures.forEach(e=>{t+=e.key.getValue()*e.value}),t}add(t){const e=this.captures.getCopy();return b5.addToMap(e,t),new b5(e)}}class Rs extends es{constructor(t,e,r=P.empty(),s=P.empty(),i){super(t,e),this.lastMove=r,this.countDown=s,null==i&&(i=new Vn([{key:z.ZERO,value:b5.from([])},{key:z.ONE,value:b5.from([])}])),i.makeImmutable(),this.captured=i}static getInitialState(){const t=Vt.EMPTY,e=Vt.PAWN,r=Vt.DRONE,s=Vt.QUEEN;return new Rs([[s,s,r,t],[s,r,e,t],[r,e,e,t],[t,t,t,t],[t,t,t,t],[t,e,e,r],[t,e,r,s],[t,r,s,s]],0,P.empty())}getPlayerTerritory(t){return t===z.ZERO?Rs.PLAYER_ZERO_TERRITORY:Rs.PLAYER_ONE_TERRITORY}isTherePieceOnPlayerSide(t){const e=this.getCurrentPlayer(),r=this.getPlayerTerritory(e);for(const s of r)for(let i=0;i<4;i++)if(this.getPieceAtXY(i,s)===t)return!0;return!1}getScoreOf(t){return this.captured.get(t).get().toValue()}getEmptyTerritory(){return this.isTerritoryEmpty(z.ZERO)?P.of(z.ZERO):this.isTerritoryEmpty(z.ONE)?P.of(z.ONE):P.empty()}isTerritoryEmpty(t){const e=this.getPlayerTerritory(t);for(const r of e)for(let s=0;s<4;s++)if(this.getPieceAtXY(s,r)!==Vt.EMPTY)return!1;return!0}isInOpponentTerritory(t){const e=this.getCurrentOpponent();return this.getPlayerTerritory(e).contains(t.y)}isInPlayerTerritory(t){const e=this.getCurrentPlayer();return this.getPlayerTerritory(e).contains(t.y)}getCapturesOf(t){const e=this.captured.get(t).get();return[e.captures.get(Vt.PAWN).getOrElse(0),e.captures.get(Vt.DRONE).getOrElse(0),e.captures.get(Vt.QUEEN).getOrElse(0)]}}Rs.PLAYER_ZERO_TERRITORY=new Dt([4,5,6,7]),Rs.PLAYER_ONE_TERRITORY=new Dt([0,1,2,3]);let M3e=(()=>{class n{}return n.YOU_DID_NOT_CAPTURE_ANY_PIECE=()=>$localize`Failed, you did not capture any piece.`,n})();const ae=Vt.EMPTY,D2=Vt.PAWN,d6=Vt.DRONE,u8=Vt.QUEEN,S3e=()=>$localize`This is not a field promotion!`;class P3e extends K1{constructor(){super(...arguments),this.tutorial=[ce.informational($localize`Goal of the game`,$localize`At Martian Chess, the goal is to have the most points at the end of the game. Each piece is assigned a value, you win this value when capturing the piece. The board is divided in two by a line called the canal. There is one side for each player. You do not own pieces, but you control the ones on your side of the canal. Pieces are colored to help you: they will change color when crossing the canal.`,Rs.getInitialState()),ce.informational($localize`The pieces`,$localize`The pieces are dark on the side of the first player, the light ones on the side of the second one. There are 3 kind of pieces: <ul><li>The Queens: represented as circles with 3 dots.</li><li>The Drones: represented as circles with 2 dots.</li><li>The Pawns: represented as circles with one dot.</li></ul>`,Rs.getInitialState()),ce.fromPredicate($localize`Moving pawns`,$localize`Pawns are worth one point. They can move one step diagonally.<br/><br/>You're playing Dark, move a pawn.`,Rs.getInitialState(),_s.from(new M(2,5),new M(1,4)).get(),(t,e,r)=>r.getPieceAt(t.getEnd())===Vt.PAWN?G.SUCCESS:G.failure($localize`This is not a pawn!`),$localize`Congratulations!`),ce.fromPredicate($localize`Moving drones`,$localize`Drones are worth two points. They can move one or two steps in any direction, in a straight line, without jumping over other pieces.<br/><br/>You're playing Dark, move a drone.`,Rs.getInitialState(),_s.from(new M(1,7),new M(0,7)).get(),(t,e,r)=>r.getPieceAt(t.getEnd())===Vt.DRONE?G.SUCCESS:G.failure($localize`This is not a drone!`),$localize`Congratulations!`),ce.fromPredicate($localize`Moving queens`,$localize`Queens are worth three points. They can move any number of steps in any direction, in a straight line, without jumping over other pieces.<br/><br/>You're playing Dark, move a queen.`,new Rs([[d6,D2,ae,ae],[u8,ae,ae,ae],[ae,ae,ae,ae],[ae,ae,u8,ae],[ae,ae,ae,ae],[ae,ae,ae,ae],[ae,ae,ae,ae],[u8,d6,D2,ae]],1),_s.from(new M(2,3),new M(2,7)).get(),(t,e,r)=>r.getPieceAt(t.getEnd())===Vt.QUEEN?G.SUCCESS:G.failure($localize`This is not a queen!`),$localize`Congratulations!`),ce.fromMove($localize`Capture`,$localize`When a piece crosses the canal and lands on another piece, you capture it and gain the value of that captured piece. However, you lose control of your piece as it crosses the canal!<br/><br/>A capture is possible for Dark, do it.`,new Rs([[d6,D2,D2,ae],[ae,ae,ae,ae],[u8,ae,ae,ae],[ae,ae,ae,ae],[ae,ae,D2,ae],[ae,ae,ae,ae],[ae,ae,ae,ae],[ae,d6,D2,ae]],1),[_s.from(new M(0,2),new M(2,4)).get()],$localize`Congratulations! By capturing that pawn, you won one point.`,M3e.YOU_DID_NOT_CAPTURE_ANY_PIECE()),ce.fromMove($localize`Field Promotion (1/2)`,$localize`It is sometimes possible to perform what is called a field promotion. If you are out of one type of piece, you can merge two pieces to add their value and get a new piece. For example, if you have no drones, you can merge two pawns into a drone. To merge two pawns, move one of your pawns on another.<br/><br/>Such a move is possible for Dark. Do it.`,new Rs([[ae,ae,ae,u8],[ae,D2,ae,ae],[ae,ae,D2,ae],[ae,ae,ae,ae],[ae,ae,ae,ae],[ae,ae,ae,u8],[ae,ae,d6,ae],[ae,D2,ae,ae]],1),[_s.from(new M(1,1),new M(2,2)).get(),_s.from(new M(2,2),new M(1,1)).get()],$localize`Congratulations!`,S3e()),ce.fromPredicate($localize`Field Promotion (2/2)`,$localize`The other kind of field promotion is to merge a drone and a pawn to obtain a queen.<br/><br/>Such a move is possible for Light. Do it.`,new Rs([[D2,ae,ae,ae],[ae,ae,ae,ae],[ae,ae,ae,ae],[ae,ae,ae,ae],[ae,ae,ae,ae],[ae,ae,ae,ae],[ae,ae,d6,ae],[ae,D2,ae,ae]],0),_s.from(new M(1,7),new M(2,6)).get(),(t,e,r)=>r.getPieceAt(t.getEnd())===Vt.QUEEN?G.SUCCESS:G.failure(S3e()),$localize`Congratulations!`),ce.fromPredicate($localize`Call the clock`,$localize`When the game seems to be going nowhere, you can "call the clock" during your turn. To do so, click on the clock symbol on the right, then perform your move. Once the clock is called, seven more turn will be played.<br/><br/>You're playing Dark. Call the clock and perform a move.`,Rs.getInitialState(),_s.from(new M(1,5),new M(0,4),!0).get(),(t,e,r)=>t.calledTheClock?G.SUCCESS:G.failure($localize`You did not call the clock!`),$localize`Congratulations!`),ce.fromMove($localize`Restarting the clock`,$localize`If the clock has been called, whenever a capture is done the countdown restarts.<br/><br/>You're playing Dark, do a capture to restart the countdown.`,new Rs([[ae,ae,ae,ae],[ae,D2,ae,ae],[ae,ae,ae,ae],[ae,ae,ae,ae],[ae,ae,ae,ae],[ae,ae,ae,D2],[ae,ae,d6,ae],[ae,D2,ae,ae]],15,P.empty(),P.of(1)),[_s.from(new M(1,1),new M(2,2)).get()],$localize`Congratulations!`,$localize`This is not a capture, the game is now over, please retry!`),ce.anyMove($localize`End game (by clock)`,$localize`When seven turns have passed after the clock has been called, the player with the most points win. If both player have the same number of points, it is a tie.<br/><br/>You're playing Dark, do the last move.`,new Rs([[ae,ae,ae,u8],[ae,D2,ae,ae],[ae,ae,ae,ae],[ae,ae,ae,ae],[ae,ae,ae,ae],[d6,ae,ae,ae],[ae,ae,ae,ae],[ae,d6,ae,ae]],15,P.empty(),P.of(1)),_s.from(new M(1,1),new M(2,2)).get(),$localize`Congratulations!`),ce.fromPredicate($localize`End by emptyness`,$localize`When a player's last piece is moved into the opponent territory, the game ends. If both players have the same number of points, the last player win!<br/><br/>Light player can win this way, do it!`,new Rs([[ae,ae,ae,u8],[ae,D2,ae,ae],[ae,ae,ae,ae],[ae,ae,ae,ae],[ae,ae,D2,ae],[ae,ae,ae,ae],[ae,ae,ae,ae],[ae,ae,ae,ae]],0),_s.from(new M(2,4),new M(1,3)).get(),(t,e,r)=>3===t.getEnd().y?G.SUCCESS:G.failure($localize`Your piece is still in you territory!`),$localize`Congratulations!`)]}}let jP=(()=>{class n{}return n.MUST_CHOOSE_PIECE_FROM_YOUR_TERRITORY=()=>$localize`You must pick a piece from your side of the board in order to move it.`,n.CANNOT_CAPTURE_YOUR_OWN_PIECE_NOR_PROMOTE_IT=()=>$localize`This is not a valid promotion nor a valid capture.`,n.CANNOT_UNDO_LAST_MOVE=()=>$localize`You cannot perform a move that is the reverse of the previous one.`,n})();class A9 extends U1{applyLegalMove(t,e,r){const s=e.getCopiedBoard();s[t.getStart().y][t.getStart().x]=Vt.EMPTY;const i=r.finalPiece;s[t.getEnd().y][t.getEnd().x]=i;const o=r.score;let c=e.countDown;if(c.isPresent())if(this.isCapture(t,e))c=A9.STARTING_COUNT_DOWN;else{const h=e.countDown.get();c=P.of(h-1)}return t.calledTheClock&&(c=A9.STARTING_COUNT_DOWN),new Rs(s,e.turn+1,P.of(t),c,o)}isLegal(t,e){this.assertNonDoubleClockCall(t,e);const r=this.isLegalMove(t,e);if(r.isFailure())return U.failure(r.getReason());if(t.isUndoneBy(e.lastMove))return U.failure(jP.CANNOT_UNDO_LAST_MOVE());if(this.isFieldPromotion(t,e))return this.isLegalFieldPromotion(t,e);const s=e.getPieceAt(t.getStart()),i=e.captured.getCopy();if(this.isCapture(t,e)){const c=e.getCurrentPlayer();let u=i.get(c).get();const h=e.getPieceAt(t.getEnd());u=u.add(h),i.replace(c,u),i.makeImmutable()}return U.success({finalPiece:s,score:i})}assertNonDoubleClockCall(t,e){ve(!1===(e.countDown.isPresent()&&t.calledTheClock),"Should not call the clock twice")}isCapture(t,e){const r=e.isInOpponentTerritory(t.getEnd()),s=e.getPieceAt(t.getEnd())!==Vt.EMPTY;return r&&s}isFieldPromotion(t,e){const r=e.isInPlayerTerritory(t.getEnd()),s=e.getPieceAt(t.getEnd())!==Vt.EMPTY;return r&&s}isLegalFieldPromotion(t,e){const r=this.getPromotedPiece(t,e);if(r.isAbsent())return U.failure(jP.CANNOT_CAPTURE_YOUR_OWN_PIECE_NOR_PROMOTE_IT());const s=r.get();if(e.isTherePieceOnPlayerSide(s))return U.failure(jP.CANNOT_CAPTURE_YOUR_OWN_PIECE_NOR_PROMOTE_IT());{const i={finalPiece:s,score:e.captured.getCopy()};return U.success(i)}}isLegalMove(t,e){if(!1===e.isInPlayerTerritory(t.getStart()))return U.failure(jP.MUST_CHOOSE_PIECE_FROM_YOUR_TERRITORY());const s=e.getPieceAt(t.getStart());if(s===Vt.EMPTY)return U.failure(tt.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(s===Vt.PAWN)return t.isValidForPawn()?U.success(void 0):U.failure(qP.PAWN_MUST_MOVE_ONE_DIAGONAL_STEP());if(s===Vt.DRONE&&!1===t.isValidForDrone())return U.failure(qP.DRONE_MUST_DO_TWO_ORTHOGONAL_STEPS());for(const i of t.getStart().getUntil(t.getEnd()))if(e.getPieceAt(i)!==Vt.EMPTY)return U.failure(tt.SOMETHING_IN_THE_WAY());return U.success(void 0)}getPromotedPiece(t,e){const r=e.getPieceAt(t.getStart()),s=e.getPieceAt(t.getEnd());return Vt.tryMerge(r,s)}getGameStatus(t){const e=t.gameState;if(e.countDown.equalsValue(0))return this.getGameStatusScoreVictoryOr(e,xe.DRAW);if(e.getEmptyTerritory().isPresent()){const s=e.getCurrentOpponent(),i=xe.getVictory(s);return this.getGameStatusScoreVictoryOr(e,i)}return xe.ONGOING}getGameStatusScoreVictoryOr(t,e){const r=t.getScoreOf(z.ZERO),s=t.getScoreOf(z.ONE);return r>s?xe.ZERO_WON:s>r?xe.ONE_WON:e}}A9.STARTING_COUNT_DOWN=P.of(7);class q0t extends G1{constructor(t,e){super(t,e),this.ruler=t}getListMoves(t){const e=t.gameState,r=e.getCurrentPlayer(),s=e.getPlayerTerritory(r);let i=[];for(const o of s)for(let c=0;c<4;c++)switch(e.getPieceAtXY(c,o)){case Vt.PAWN:i=i.concat(this.getMovesForPawnAt(e,c,o));break;case Vt.DRONE:i=i.concat(this.getMovesForDroneAt(e,c,o));break;case Vt.QUEEN:i=i.concat(this.getMovesForQueenAt(e,c,o))}return i}getMovesForPawnAt(t,e,r){const s=new M(e,r),i=[];for(const o of Ne.DIAGONALS){const c=s.getNext(o);c.isInRange(4,8)&&i.push(c)}return this.addLegalMoves(t,s,i)}addLegalMoves(t,e,r){const s=[],i=t.getPieceAt(e),o=!1===t.isTherePieceOnPlayerSide(Vt.DRONE),c=!1===t.isTherePieceOnPlayerSide(Vt.QUEEN),u=t.lastMove;for(const h of r){const p=t.getPieceAt(h);if(p===Vt.EMPTY)this.add(s,_s.from(e,h).get(),u);else if(t.isInPlayerTerritory(h)){const m=Vt.tryMerge(p,i);if(m.isPresent()){const C=m.get(),w=_s.from(e,h).get();(C===Vt.DRONE&&o||C===Vt.QUEEN&&c)&&this.add(s,w,u)}}else this.add(s,_s.from(e,h).get(),u)}return s}add(t,e,r){!1===e.isUndoneBy(r)&&t.push(e)}getMovesForDroneAt(t,e,r){const s=new M(e,r),i=this.getLandingCoordsForLinearMove(s,t,2);return this.addLegalMoves(t,s,i)}getLandingCoordsForLinearMove(t,e,r){const s=[];for(const i of Ne.DIRECTIONS){let o=1,c=t.getNext(i,o),u=e.tryToGetPieceAt(c),h=u.equalsValue(Vt.EMPTY);for(;h;)s.push(c),o++,c=t.getNext(i,o),u=e.tryToGetPieceAt(c),h=u.equalsValue(Vt.EMPTY)&&o<r;u.isPresent()&&s.push(c)}return s}getMovesForQueenAt(t,e,r){const s=new M(e,r),i=this.getLandingCoordsForQueen(s,t);return this.addLegalMoves(t,s,i)}getLandingCoordsForQueen(t,e){return this.getLandingCoordsForLinearMove(t,e,8)}getBoardValue(t){const e=this.ruler.getGameStatus(t);let r;if(e.isEndGame)r=e.toBoardValue().value;else{const s=t.gameState.getScoreOf(z.ZERO);r=t.gameState.getScoreOf(z.ONE)-s}return new Ct(r)}}function j0t(n,t){if(1&n&&(F(),Q(0,"g",19)),2&n){const e=v(2).index,r=v().index,s=v();_2(s.style),We("mainShapeId","pawn_",e,"_",r,""),T("pieceClasses",s.getPieceClasses(e,r))}}function Z0t(n,t){if(1&n&&(F(),Q(0,"g",20)),2&n){const e=v(2).index,r=v().index,s=v();_2(s.style),We("mainShapeId","drone_",e,"_",r,""),T("pieceClasses",s.getPieceClasses(e,r))}}function Y0t(n,t){if(1&n&&(F(),Q(0,"g",21)),2&n){const e=v(2).index,r=v().index,s=v();_2(s.style),We("mainShapeId","queen_",e,"_",r,""),T("pieceClasses",s.getPieceClasses(e,r))}}function K0t(n,t){if(1&n&&(F(),b(0,"g"),x(1,j0t,1,5,"g",16),x(2,Z0t,1,5,"g",17),x(3,Y0t,1,5,"g",18),O()),2&n){const e=v(),r=e.index,s=e.$implicit,i=v().index,o=v();D("transform",o.getPieceLocation(r,i)),S(1),T("ngIf",s===o.pieces.PAWN),S(1),T("ngIf",s===o.pieces.DRONE),S(1),T("ngIf",s===o.pieces.QUEEN)}}function X0t(n,t){if(1&n){const e=Oe();F(),b(0,"g",14),ee("click",function(){const i=he(e).index,o=v().index;return le(v().onClick(i,o))}),Q(1,"rect",15),x(2,K0t,4,4,"g",13),O()}if(2&n){const e=t.$implicit,r=t.index,s=v().index,i=v();We("id","click_",r,"_",s,""),D("transform",i.getPieceTranslation(s)),S(1),We("id","square_",r,"_",s,""),T("ngClass",i.getSquareClasses(r,s)),D("x",r*i.SPACE_SIZE)("y",s*i.SPACE_SIZE)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),S(1),T("ngIf",e!==i.pieces.EMPTY)}}function Q0t(n,t){if(1&n){const e=Oe();F(),b(0,"g")(1,"rect",22),ee("click",function(){const i=he(e).$implicit;return le(v(3).onClick(i.x,i.y))}),O()()}if(2&n){const e=t.$implicit,r=v(3);S(1),We("id","indicator_",e.x,"_",e.y,""),D("transform",r.getPieceTranslation(e.y))("x",e.x*r.SPACE_SIZE+(r.SPACE_SIZE/2-r.INDICATOR_SIZE/2))("y",e.y*r.SPACE_SIZE+(r.SPACE_SIZE/2-r.INDICATOR_SIZE/2))("width",r.INDICATOR_SIZE)("height",r.INDICATOR_SIZE)}}function J0t(n,t){if(1&n&&(F(),b(0,"g"),x(1,Q0t,2,7,"g",1),O()),2&n){const e=v(2);S(1),T("ngForOf",e.selectedPieceInfo.get().legalLandings)}}function e8t(n,t){if(1&n&&(F(),b(0,"g"),x(1,X0t,3,11,"g",12),x(2,J0t,2,1,"g",13),O()),2&n){const e=t.$implicit,r=v();S(1),T("ngForOf",e),S(1),T("ngIf",r.selectedPieceInfo.isPresent())}}function t8t(n,t){if(1&n&&(F(),b(0,"text",23),Tt(1),O()),2&n){const e=v();T("ngClass","player"+e.getCurrentPlayer().value)("ngClass",e.getClockCircleClasses()),D("x",.5*e.SPACE_SIZE)("y",.5*e.SPACE_SIZE),S(1),l1(e.countDown.get())}}function n8t(n,t){if(1&n&&(F(),Q(0,"polyline",24)),2&n){const e=v();T("ngClass",e.getClockCircleClasses()),D("points",e.clockNeedlesPoints)}}const ZP=function(n){return[n]};function r8t(n,t){if(1&n){const e=Oe();F(),un(0),b(1,"g",27),ee("click",function(){const i=he(e).index;return le(v(2).chooseStyle(i))}),O(),fn()}if(2&n){const e=t.$implicit,r=t.index,s=v(2);S(1),_2(e.style),T("id",e.name)("pieceClasses",P3(5,ZP,"player"+s.getCurrentPlayer().value+"-fill")),D("transform","translate(0, "+-(r+1)*s.SPACE_SIZE+")")}}function s8t(n,t){if(1&n&&(F(),b(0,"g",25),Q(1,"rect",26),x(2,r8t,2,7,"ng-container",1),O()),2&n){const e=v();S(1),D("x",0)("y",-e.listOfStyles.length*e.SPACE_SIZE)("width",1*e.SPACE_SIZE)("height",e.listOfStyles.length*e.SPACE_SIZE),S(1),T("ngForOf",e.listOfStyles)}}function i8t(n,t){if(1&n&&(F(),b(0,"text",33),Tt(1),O()),2&n){const e=v(2).$implicit,r=v().$implicit,s=v();T("ngClass",s.getPlayerClass(r)),D("x",s.SPACE_SIZE/2)("y",s.SPACE_SIZE/2),S(1),l1(e+" x ")}}function o8t(n,t){if(1&n&&(F(),Q(0,"g",34)),2&n){const e=v(3).$implicit,r=v();_2(r.style),T("pieceClasses",P3(3,ZP,r.getPlayerClass(e)))}}function a8t(n,t){if(1&n&&(F(),Q(0,"g",35)),2&n){const e=v(3).$implicit,r=v();_2(r.style),T("pieceClasses",P3(3,ZP,r.getPlayerClass(e)))}}function c8t(n,t){if(1&n&&(F(),Q(0,"g",36)),2&n){const e=v(3).$implicit,r=v();_2(r.style),T("pieceClasses",P3(3,ZP,r.getPlayerClass(e)))}}function l8t(n,t){if(1&n&&(F(),b(0,"g"),x(1,i8t,2,4,"text",29),b(2,"g",28),x(3,o8t,1,5,"g",30),x(4,a8t,1,5,"g",31),x(5,c8t,1,5,"g",32),O()()),2&n){const e=v(),r=e.index,s=e.$implicit,i=v().$implicit,o=v();D("transform","translate(0, "+2*r*o.SPACE_SIZE+")"),S(1),T("ngIf",s>1),S(1),We("id","piece_",r,"_player_",i.value,""),D("transform","translate("+o.SPACE_SIZE+", 0)"),S(1),T("ngIf",0===r),S(1),T("ngIf",1===r),S(1),T("ngIf",2===r)}}function u8t(n,t){if(1&n&&(F(),b(0,"g"),x(1,l8t,6,8,"g",13),O()),2&n){const e=t.$implicit;S(1),T("ngIf",e>0)}}function f8t(n,t){if(1&n&&(F(),b(0,"g")(1,"g",28),x(2,u8t,2,1,"g",1),O()()),2&n){const e=t.$implicit,r=v();S(1),y1("id","capture_of_player_",e.value,""),D("transform",r.getCapturesTransformation(e)),S(1),T("ngForOf",r.state.getCapturesOf(e))}}let Fo=(()=>{class n extends to{constructor(e){super(e),this.INDICATOR_SIZE=20,this.HORIZONTAL_CENTER=2*n.SPACE_SIZE,this.VERTICAL_CENTER=4*n.SPACE_SIZE+n.STROKE_WIDTH,this.LEFT=n.SPACE_SIZE/-4+n.STROKE_WIDTH/-2,this.UP=-n.STROKE_WIDTH/2,this.WIDTH=6.5*n.SPACE_SIZE+n.STROKE_WIDTH,this.HEIGHT=8*n.SPACE_SIZE+3*n.STROKE_WIDTH,this.MartianChessComponent=n,this.style={shape:"Circle",points:"Horizontal Points"},this.pieces=Vt,this.selectedPieceInfo=P.empty(),this.countDown=P.empty(),this.callTheClock=!1,this.displayModePanel=!1,this.listOfStyles=[{name:"Star",style:{shape:"Star",points:"Dots"}},{name:"Polygon",style:{shape:"Polygon",points:"Concentric Circles"}},{name:"Simple",style:{shape:"Circle",points:"Horizontal Points"}},{name:"Circely",style:{shape:"Circle",points:"Concentric Circles"}}],this.hasAsymetricBoard=!0,this.rules=new A9(Rs),this.availableMinimaxes=[new q0t(this.rules,"Martian Chess Dummy Minimax")],this.SPACE_SIZE=n.SPACE_SIZE,this.configCogTransformation=this.getConfigCogTransformation(),this.configViewTranslation=this.getConfigViewTranslation(),this.clockNeedlesPoints=this.getClockNeedlesPoints(),this.encoder=_s.encoder,this.tutorial=(new P3e).tutorial,this.scores=P.of([0,0]),this.updateBoard()}static getRegularPolygon(e,r=0){const s=n.getRegularPolygonCoords(e,r);return n.mapCoordsToString(s)}static getNPointedStar(e,r){const s=this.getNPointedStarCoords(e,r);return n.mapCoordsToString(s)}static getNPointedStarCoords(e,r){const s=[],i=.5*n.SPACE_SIZE,o=.5*n.SPACE_SIZE;e*=2;for(let c=0;c<e;c++){const h=(c*(360/e)+r)/180*Math.PI,p=c%2==0?n.SPACE_SIZE/2:n.SPACE_SIZE/6,m=i+.8*p*Math.cos(h),C=o+.8*p*Math.sin(h);s.push(new M(m,C))}return s}static getRegularPolygonCoords(e,r=0){const s=[],i=.5*n.SPACE_SIZE,o=.5*n.SPACE_SIZE;for(let c=0;c<e;c++){const h=(c*(360/e)-90)/180*Math.PI,p=.5*n.SPACE_SIZE,m=i+.8*p*Math.cos(h),C=o+.8*p*Math.sin(h)+r;s.push(new M(m,C))}return s}static mapCoordsToString(e){let r="";for(const s of e)r+=s.x+", "+s.y+" ";return r}static getRadius(e){return this.SPACE_SIZE*e/10}getConfigViewTranslation(){return"translate("+(5.25*this.SPACE_SIZE+0)+", "+(7*this.SPACE_SIZE+0+2*this.STROKE_WIDTH)+")"}getConfigCogTransformation(){const e=this.STROKE_WIDTH,s=(this.SPACE_SIZE-e)/40;return"translate("+1*e+", "+1*e+") scale("+s+" "+s+")"}getClockNeedlesPoints(){const e=.5*this.SPACE_SIZE;return e+" "+.1*this.SPACE_SIZE+", "+e+" "+e+", "+.75*this.SPACE_SIZE+" "+e}updateBoard(){this.state=this.getState(),this.board=this.state.board;const e=this.state.getScoreOf(z.ZERO),r=this.state.getScoreOf(z.ONE);this.countDown=this.state.countDown,this.scores=P.of([e,r])}getPieceLocation(e,r){return"translate("+this.SPACE_SIZE*e+", "+this.SPACE_SIZE*r+")"}getPieceClasses(e,r){const s=new M(e,r),i=[];return i.push(r>3?"player0-fill":"player1-fill"),this.selectedPieceInfo.isPresent()&&this.selectedPieceInfo.get().selectedPiece.equals(s)&&i.push("selected-stroke"),this.rules.node.move.isPresent()&&this.rules.node.move.get().getEnd().equals(s)&&this.rules.node.mother.get().gameState.getPieceAt(s)!==Vt.EMPTY&&this.getState().isInOpponentTerritory(new M(0,r))&&i.push("last-move-stroke"),i}onClick(e,r){var s=this;return A(function*(){s.displayModePanel=!1;const i=s.canUserPlay("#click_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());const o=new M(e,r);return s.selectedPieceInfo.isPresent()?s.secondClick(o):s.firstClick(o)})()}firstClick(e){var r=this;return A(function*(){return r.isOneOfUsersPieces(e)?r.selectAsFirstPiece(e):(r.cancelMoveAttempt(),G.SUCCESS)})()}selectAsFirstPiece(e){var r=this;return A(function*(){const s=r.getLegalLandings(e);return r.selectedPieceInfo=P.of({selectedPiece:e,legalLandings:s}),G.SUCCESS})()}getLegalLandings(e){const r=this.state.getPieceAt(e);let s;return s=r===Vt.PAWN?Ne.DIAGONALS.map(i=>e.getNext(i)):this.getValidLinearLandingSquareUntil(e,r===Vt.DRONE?2:8),s.filter(i=>{const o=_s.from(e,i);return!!o.isSuccess()&&this.rules.isLegal(o.get(),this.getState()).isSuccess()})}getValidLinearLandingSquareUntil(e,r){return Ne.DIRECTIONS.flatMap(s=>{const i=[];let o=e.getNext(s),c=1;for(;o.isInRange(4,8)&&c<=r&&(i.push(o),this.getState().getPieceAt(o)===Vt.EMPTY);)o=o.getNext(s),c++;return i})}secondClick(e){var r=this;return A(function*(){const s=r.selectedPieceInfo.get();if(s.selectedPiece.equals(e))return r.cancelMoveAttempt(),G.SUCCESS;if(s.legalLandings.some(i=>i.equals(e))){const i=_s.from(s.selectedPiece,e,r.callTheClock);ve(i.isSuccess(),"MartianChessComponent or Rules did a mistake thinking this would have been a legal move!");const o=r.getState();return r.chooseMove(i.get(),o)}if(r.isOneOfUsersPieces(e))return r.selectAsFirstPiece(e);{const i=_s.from(s.selectedPiece,e,r.callTheClock);return i.isSuccess()?r.chooseMove(i.get(),r.getState()):r.cancelMove(i.getReason())}})()}isOneOfUsersPieces(e){return this.state.getPieceAt(e)!==Vt.EMPTY&&this.state.isInPlayerTerritory(e)}cancelMoveAttempt(){this.selectedPieceInfo=P.empty(),this.callTheClock=!1}onClockClick(){var e=this;return A(function*(){const r=e.canUserPlay("#clockOrCountDownView");return r.isFailure()?e.cancelMove(r.getReason()):(e.getState().countDown.isAbsent()&&(e.callTheClock=!e.callTheClock),G.SUCCESS)})()}getClockCircleClasses(){const e=["base"];return this.callTheClock&&e.push("selected-stroke"),this.getCurrentPlayer()===z.ZERO?e.push("player0-stroke"):e.push("player1-stroke"),e}getSquareClasses(e,r){const s=new M(e,r),i=["base"];if(this.rules.node.move.isPresent()){const o=this.rules.node,c=o.move.get();c.getStart().equals(s)?i.push("moved-fill"):c.getEnd().equals(s)&&(o.mother.get().gameState.getPieceAt(s)===Vt.EMPTY||o.gameState.isInOpponentTerritory(new M(0,r))?i.push("moved-fill"):i.push("captured-fill"))}return i}onModeCogClick(){this.displayModePanel=!this.displayModePanel}chooseStyle(e){this.style=this.listOfStyles[e].style,this.displayModePanel=!1}getPieceTranslation(e){return"translate(0, "+(e<=3?0:2*this.STROKE_WIDTH)+")"}getBoardTransformation(){return"translate("+this.SPACE_SIZE+", 0) rotate("+180*this.role.value+" "+this.HORIZONTAL_CENTER+" "+this.VERTICAL_CENTER+")"}getCapturesTransformation(e){let i=this.SPACE_SIZE/2;return e===this.role&&(i+=10*this.SPACE_SIZE+4*this.STROKE_WIDTH),"scale(0.5, 0.5) translate("+-this.SPACE_SIZE/2+", "+i+")"}}return n.SPACE_SIZE=100,n.STROKE_WIDTH=8,n.\u0275fac=function(e){return new(e||n)(J(Pn))},n.\u0275cmp=gt({type:n,selectors:[["app-martian-chess"]],features:[l],decls:15,vars:19,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["id","clockOrCountDownView",3,"click"],["x","0","y","0",1,"transparent"],["id","clockOrCountDownCircle",3,"ngClass"],["id","countDownText","class","text-giant text-center",3,"ngClass",4,"ngIf"],["class","base","stroke-linecap","round",3,"ngClass",4,"ngIf"],["id","modeCogView"],["id","modeCog",3,"click"],["d","M35.497,15.111h-1.656c-0.282-0.924-0.653-1.807-1.102-2.646l1.176-1.175c1.364-1.366,1.366-3.582,0-4.949l-1.258-1.258 c-0.656-0.656-1.548-1.025-2.476-1.025l0,0c-0.93,0-1.818,0.369-2.477,1.025l-1.176,1.175c-0.838-0.446-1.721-0.817-2.645-1.102 V3.501c0-1.934-1.566-3.5-3.5-3.5h-1.778c-1.934,0-3.5,1.566-3.5,3.5v1.655c-0.923,0.282-1.807,0.653-2.645,1.102l-1.174-1.175 c-1.367-1.367-3.584-1.367-4.951,0L5.081,6.34c-1.367,1.366-1.367,3.583,0,4.949l1.174,1.175c-0.446,0.84-0.818,1.723-1.102,2.646 H3.5c-1.934,0-3.5,1.566-3.5,3.5v1.778c0,1.932,1.566,3.5,3.5,3.5h1.654c0.283,0.922,0.654,1.807,1.102,2.645l-1.175,1.176 c-1.366,1.365-1.366,3.582-0.001,4.949l1.258,1.258c0.656,0.654,1.547,1.023,2.475,1.023h0.001c0.929,0,1.818-0.369,2.475-1.023 l1.176-1.176c0.837,0.447,1.722,0.818,2.644,1.102v1.656c0,1.932,1.566,3.5,3.5,3.5h1.778c1.934,0,3.5-1.568,3.5-3.5v-1.656 c0.924-0.283,1.807-0.654,2.645-1.102l1.177,1.176c0.655,0.656,1.547,1.023,2.476,1.023c0.93,0,1.817-0.369,2.477-1.023 l1.256-1.258c1.366-1.367,1.365-3.582,0-4.949l-1.176-1.174c0.447-0.84,0.818-1.725,1.102-2.646h1.656c1.934,0,3.5-1.568,3.5-3.5 v-1.777C38.997,16.679,37.43,15.111,35.497,15.111z M19.499,27.499c-4.41,0-8-3.588-8-8c0-4.411,3.59-8,8-8c4.412,0,8,3.589,8,8 C27.499,23.911,23.911,27.499,19.499,27.499z",3,"ngClass"],["id","modePanel",4,"ngIf"],["id","captures"],[3,"id","click",4,"ngFor","ngForOf"],[4,"ngIf"],[3,"id","click"],[3,"id","ngClass"],["app-martian-chess-pawn","",3,"mainShapeId","pieceClasses","style",4,"ngIf"],["app-martian-chess-drone","",3,"pieceClasses","mainShapeId","style",4,"ngIf"],["app-martian-chess-queen","",3,"mainShapeId","pieceClasses","style",4,"ngIf"],["app-martian-chess-pawn","",3,"mainShapeId","pieceClasses"],["app-martian-chess-drone","",3,"pieceClasses","mainShapeId"],["app-martian-chess-queen","",3,"mainShapeId","pieceClasses"],[1,"indicator",3,"id","click"],["id","countDownText",1,"text-giant","text-center",3,"ngClass"],["stroke-linecap","round",1,"base",3,"ngClass"],["id","modePanel"],["stroke-width","8",1,"base"],["app-martian-chess-queen","",3,"id","pieceClasses","click"],[3,"id"],["class","text-giant text-center",3,"ngClass",4,"ngIf"],["app-martian-chess-pawn","",3,"pieceClasses","style",4,"ngIf"],["app-martian-chess-drone","",3,"pieceClasses","style",4,"ngIf"],["app-martian-chess-queen","",3,"pieceClasses","style",4,"ngIf"],[1,"text-giant","text-center",3,"ngClass"],["app-martian-chess-pawn","",3,"pieceClasses"],["app-martian-chess-drone","",3,"pieceClasses"],["app-martian-chess-queen","",3,"pieceClasses"]],template:function(e,r){1&e&&(F(),b(0,"svg",0)(1,"g"),x(2,e8t,3,2,"g",1),O(),b(3,"g",2),ee("click",function(){return r.onClockClick()}),Q(4,"rect",3)(5,"circle",4),x(6,t8t,2,5,"text",5),x(7,n8t,1,2,"polyline",6),O(),b(8,"g",7)(9,"g",8),ee("click",function(){return r.onModeCogClick()}),Q(10,"rect",3)(11,"path",9),O(),x(12,s8t,3,5,"g",10),O(),b(13,"g",11),x(14,f8t,3,3,"g",1),O()()),2&e&&(D("viewBox",r.LEFT+" "+r.UP+" "+r.WIDTH+" "+r.HEIGHT),S(1),D("transform",r.getBoardTransformation()),S(1),T("ngForOf",r.board),S(1),D("transform","translate("+5.25*r.SPACE_SIZE+", 0)"),S(1),D("width",r.SPACE_SIZE)("height",r.SPACE_SIZE),S(1),T("ngClass",r.getClockCircleClasses()),D("cx",.5*r.SPACE_SIZE)("cy",.5*r.SPACE_SIZE)("r",.4*r.SPACE_SIZE),S(1),T("ngIf",r.countDown.isPresent()),S(1),T("ngIf",r.countDown.isAbsent()),S(1),D("transform",r.configViewTranslation),S(2),D("width",r.SPACE_SIZE)("height",r.SPACE_SIZE),S(1),T("ngClass",r.getPlayerClass(r.getCurrentPlayer())),D("transform",r.configCogTransformation),S(1),T("ngIf",r.displayModePanel),S(2),T("ngForOf",r.Player.PLAYERS))},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class p6 extends es{static getInitialState(){const t=Ke.createTable(7,6,pe.NONE);return new p6(t,0)}}class L1 extends Gi{constructor(t){super(),this.x=t}static of(t){switch(t){case 0:return L1.ZERO;case 1:return L1.ONE;case 2:return L1.TWO;case 3:return L1.THREE;case 4:return L1.FOUR;case 5:return L1.FIVE;case 6:return L1.SIX;default:throw new Error("Invalid P4Move")}}equals(t){return this===t}toString(){return"P4Move("+this.x+")"}}L1.ZERO=new L1(0),L1.ONE=new L1(1),L1.TWO=new L1(2),L1.THREE=new L1(3),L1.FOUR=new L1(4),L1.FIVE=new L1(5),L1.SIX=new L1(6),L1.encoder=new class extends Cn{maxValue(){return 6}encodeNumber(n){return n.x}decodeNumber(n){return L1.of(n)}};let h8t=(()=>{class n{}return n.COLUMN_IS_FULL=()=>$localize`Please put your piece in an incomplete column.`,n})();class Gr extends U1{static isInRange(t){return t.isInRange(7,6)}static getVictoriousCoords(t){return Gr.P4_HELPER.getVictoriousCoord(t)}static getBoardValueFromScratch(t){X(Gr.VERBOSE,{P4Rules_getBoardValueFromScratch:{state:t}});let e=0;for(let r=0;r<7;r++)for(let s=5;-1!==s&&t.board[s][r].isPlayer();s--){const i=Gr.getSquareScore(t,new M(r,s));if($1.getScoreStatus(i)!==yn.DEFAULT)return X(Gr.VERBOSE,{preVictoryOrVictory:{state:t,squareScore:i,coord:{x:r,y:s}}}),new Ct(i);e+=i}return new Ct(e)}static getLowestUnoccupiedSpace(t,e){let r=0;for(;r<6&&t[r][e]===pe.NONE;)r++;return r-1}static getSquareScore(t,e){return X(Gr.VERBOSE,"getSquareScore(board, "+e.x+", "+e.y+") called"),X(Gr.VERBOSE,t.board),Gr.P4_HELPER.getSquareScore(t,e)}static getListMoves(t){X(Gr.VERBOSE,{context:"P4Rules.getListMoves",node:t});const e=t.gameState,r=[];for(let s=0;s<7;s++)if(e.getPieceAtXY(s,0)===pe.NONE){const i=L1.of(s);r.push(i)}return r}static getBoardValue(t){return X(Gr.VERBOSE,{text:"P4Rules.getBoardValue called",board:t.getCopiedBoard()}),Gr.getBoardValueFromScratch(t)}applyLegalMove(t,e,r){const s=t.x,i=e.getCopiedBoard(),o=Gr.getLowestUnoccupiedSpace(i,s),c=e.turn;return i[o][s]=e.getCurrentPlayer(),new p6(i,c+1)}isLegal(t,e){return X(Gr.VERBOSE,{context:"P4Rules.isLegal",move:t.toString(),state:e}),e.getPieceAtXY(t.x,0).isPlayer()?U.failure(h8t.COLUMN_IS_FULL()):U.success(void 0)}getGameStatus(t){const e=t.gameState;return Gr.P4_HELPER.getVictoriousCoord(e).length>0?xe.getVictory(e.getCurrentOpponent()):42===e.turn?xe.DRAW:xe.ONGOING}}Gr.VERBOSE=!1,Gr.P4_HELPER=new yP(Gr.isInRange,Me.identity,4);class d8t extends G1{getListMoves(t){return Gr.getListMoves(t).sort((e,r)=>Math.abs(e.x-3)-Math.abs(r.x-3))}getBoardValue(t){const e=t.gameState;return X(Gr.VERBOSE,{text:"P4Rules instance methods getBoardValue called",board:e.getCopiedBoard()}),Gr.getBoardValue(e)}}const Et=pe.NONE,g6=pe.ZERO,I9=pe.ONE;class T3e extends K1{constructor(){super(...arguments),this.tutorial=[ce.informational($localize`Goal of the game`,$localize`The board at Four in a Row is made of 7 columns and 6 rows, and it is initially empty.
        The first player plays Dark, the second plays Light.
        The goal is to be the first to align 4 of its pieces (horizontally, vertically, or diagonally).`,p6.getInitialState()),ce.anyMove($localize`Dropping a piece`,$localize`Click on any space in any column.`,p6.getInitialState(),L1.THREE,$localize`As you can see, the piece falls at the bottom of the column.`),ce.fromMove($localize`Victory`,$localize`You're playing Dark.
        Place your piece so that you create a horizontal alignment of 4 of your pieces.`,new p6([[Et,Et,Et,Et,Et,Et,Et],[Et,Et,Et,Et,Et,Et,Et],[Et,Et,Et,Et,Et,Et,Et],[Et,Et,Et,I9,Et,Et,Et],[Et,Et,Et,I9,Et,Et,Et],[Et,Et,g6,g6,g6,I9,Et]],0),[L1.of(1)],$localize`You won!`,$localize`Failed, you have not aligned 4 pieces and missed an opportunity to win.`),ce.fromMove($localize`Other victory`,$localize`You can also align 4 pieces diagonally or vertically.`,new p6([[Et,Et,Et,Et,Et,Et,Et],[Et,Et,Et,Et,Et,Et,Et],[Et,Et,Et,Et,Et,Et,Et],[Et,Et,Et,g6,I9,Et,Et],[Et,Et,g6,g6,I9,Et,Et],[Et,g6,I9,g6,g6,Et,Et]],0),[L1.of(3),L1.of(4)],$localize`You won!`,$localize`Failed, you have not aligned 4 pieces and missed an opportunity to win.`)]}}function p8t(n,t){if(1&n&&(F(),Q(0,"circle",8)),2&n){const e=v().index,r=v().index,s=v();T("ngClass",s.getSquareFillClass(e,r)),D("cx",s.SPACE_SIZE*e+s.SPACE_SIZE/2)("cy",s.SPACE_SIZE*r+s.SPACE_SIZE/2)("r",s.SPACE_SIZE/2-s.STROKE_WIDTH)}}function g8t(n,t){if(1&n){const e=Oe();F(),b(0,"g",5),ee("click",function(){const i=he(e).index;return le(v(2).onClick(i))}),Q(1,"rect",6),x(2,p8t,1,4,"circle",7),O()}if(2&n){const e=t.$implicit,r=t.index,s=v().index,i=v();y1("id","click_",r,""),S(1),D("x",i.SPACE_SIZE*r)("y",i.SPACE_SIZE*s)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),S(1),T("ngIf",e!==i.EMPTY)}}function m8t(n,t){if(1&n&&(F(),b(0,"g"),x(1,g8t,3,6,"g",4),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e)}}function _8t(n,t){if(1&n&&(F(),Q(0,"rect",9)),2&n){const e=v();D("x",e.SPACE_SIZE*e.last.get().x)("y",e.SPACE_SIZE*e.last.get().y)("width",e.SPACE_SIZE)("height",e.SPACE_SIZE)}}function v8t(n,t){if(1&n&&(F(),Q(0,"rect",10)),2&n){const e=t.$implicit,r=v();We("id","victory_coord_",e.x,"_",e.y,""),D("x",r.SPACE_SIZE*e.x)("y",r.SPACE_SIZE*e.y)("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)}}let C8t=(()=>{class n extends to{constructor(e){super(e),this.EMPTY=pe.NONE,this.victoryCoords=[],this.rules=new Gr(p6),this.availableMinimaxes=[new d8t(this.rules,"P4Minimax")],this.encoder=L1.encoder,this.tutorial=(new T3e).tutorial,this.updateBoard()}onClick(e){var r=this;return A(function*(){const s=r.canUserPlay("#click_"+e);if(s.isFailure())return r.cancelMove(s.getReason());const i=L1.of(e);return yield r.chooseMove(i,r.getState())})()}updateBoard(){const e=this.getState(),r=this.rules.node.move;this.victoryCoords=Gr.getVictoriousCoords(e),this.board=e.board,r.isPresent()?this.showLastMove():this.hideLastMove()}showLastMove(){const e=this.getState(),r=this.rules.node.move,s=Gr.getLowestUnoccupiedSpace(e.board,r.get().x)+1;this.last=P.of(new M(r.get().x,s))}hideLastMove(){this.last=P.empty()}getSquareFillClass(e,r){return[this.getPlayerClass(this.board[r][e])]}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(J(Pn))},n.\u0275cmp=gt({type:n,selectors:[["app-p4"]],features:[l],decls:4,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-4 -4 708 608","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base no-fill last-move-stroke mid-stroke",4,"ngIf"],["class","base no-fill victory-stroke mid-stroke",3,"id",4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base"],["class","base","pointer-events","fill",3,"ngClass",4,"ngIf"],["pointer-events","fill",1,"base",3,"ngClass"],[1,"base","no-fill","last-move-stroke","mid-stroke"],[1,"base","no-fill","victory-stroke","mid-stroke",3,"id"]],template:function(e,r){1&e&&(F(),b(0,"svg",0),x(1,m8t,2,1,"g",1),x(2,_8t,1,4,"rect",2),x(3,v8t,1,6,"rect",3),O()),2&e&&(S(1),T("ngForOf",r.board),S(1),T("ngIf",r.last.isPresent()),S(1),T("ngForOf",r.victoryCoords))},dependencies:[dn,An,en],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class Ds extends xc{constructor(t,e,r,s=!1){if(super(t,e),this.blockTurned=r,this.turnedClockwise=s,this.coord.isNotInRange(6,6))throw new Error("The board is a 6 cas wide square, invalid coord: "+this.coord.toString())}static withRotation(t,e,r,s){if(r<0||3<r)throw new Error("This block do not exist: "+r);return new Ds(t,e,P.of(r),s)}static rotationless(t,e){return new Ds(t,e,P.empty())}toString(){return this.blockTurned.isPresent()?"PentagoMove("+this.coord.toString()+", "+this.blockTurned.get()+", "+(this.turnedClockwise?"CLOCKWISE":"ANTI-CLOCKWISE")+")":"PentagoMove"+this.coord.toString()}equals(t){return!1!==this.coord.equals(t.coord)&&!1!==this.blockTurned.equals(t.blockTurned)&&this.turnedClockwise===t.turnedClockwise}}Ds.encoder=new class extends mi{encodeMove(n){const t={coord:M.encoder.encode(n.coord)};return n.blockTurned.isPresent()&&(t.blockTurned=n.blockTurned.get(),t.turnedClockwise=n.turnedClockwise),t}decodeMove(n){const t=n,e=M.encoder.decode(t.coord),r=P.ofNullable(t.blockTurned);if(r.isPresent()){const s=t.turnedClockwise;return Ds.withRotation(e.x,e.y,r.get(),s)}return Ds.rotationless(e.x,e.y)}};let w3e=(()=>{class n{}return n.CANNOT_ROTATE_NEUTRAL_BLOCK=()=>$localize`If the quadrant to turn is neutral, please just use move without rotation.`,n.MUST_CHOOSE_BLOCK_TO_ROTATE=()=>$localize`No quadrant is neutral, you must pick a quadrant to rotate.`,n})();class z2 extends es{constructor(t,e){super(t,e),this.neutralBlocks=this.getBlocksNeutralities()}static getInitialState(){const t=Ke.createTable(6,6,pe.NONE);return new z2(t,0)}getBlocksNeutralities(){const t=[];for(let e=0;e<4;e++)this.getBlockNeutrality(e)&&t.push(e);return t}getBlockNeutrality(t){const e=z2.getBlockCenter(t),r=this.getPieceAt(e.getNext(Ne.UP,1)),s=this.getPieceAt(e.getNext(Ne.UP_LEFT,1));return this.getPieceAt(e.getNext(Ne.RIGHT,1))===r&&this.getPieceAt(e.getNext(Ne.DOWN,1))===r&&this.getPieceAt(e.getNext(Ne.LEFT,1))===r&&this.getPieceAt(e.getNext(Ne.UP_RIGHT,1))===s&&this.getPieceAt(e.getNext(Ne.DOWN_RIGHT,1))===s&&this.getPieceAt(e.getNext(Ne.DOWN_LEFT,1))===s}static getBlockCenter(t){return new M(1+(t%2==0?0:3),1+(t<2?0:3))}applyLegalDrop(t){const e=this.getCopiedBoard();return e[t.coord.y][t.coord.x]=this.getCurrentPlayer(),new z2(e,this.turn)}applyLegalMove(t){const e=this.applyLegalDrop(t),r=e.getCopiedBoard();if(t.blockTurned.isPresent()){const i=z2.getBlockCenter(t.blockTurned.get()).toVector();if(t.turnedClockwise)for(const o of z2.ROTATION_MAP){const c=o[0].getNext(i),u=o[1].getNext(i),h=e.getPieceAt(c);r[u.y][u.x]=h}else for(const o of z2.ROTATION_MAP){const c=o[1].getNext(i),u=o[0].getNext(i),h=e.getPieceAt(c);r[u.y][u.x]=h}}return new z2(r,this.turn+1)}blockIsNeutral(t){return this.neutralBlocks.includes(t)}}z2.ROTATION_MAP=[[new M(-1,-1),new M(1,-1)],[new M(0,-1),new M(1,0)],[new M(1,-1),new M(1,1)],[new M(1,0),new M(0,1)],[new M(1,1),new M(-1,1)],[new M(0,1),new M(-1,0)],[new M(-1,1),new M(-1,-1)],[new M(-1,0),new M(0,-1)]];class B3 extends U1{static get(){return B3.singleton.isAbsent()&&(B3.singleton=P.of(new B3(z2))),B3.singleton.get()}applyLegalMove(t,e,r){return e.applyLegalMove(t)}isLegal(t,e){if(e.getPieceAt(t.coord).isPlayer())return U.failure(tt.MUST_LAND_ON_EMPTY_SPACE());const r=e.applyLegalDrop(t);if(0===r.neutralBlocks.length){if(t.blockTurned.isAbsent())return U.failure(w3e.MUST_CHOOSE_BLOCK_TO_ROTATE())}else if(t.blockTurned.isPresent()){const s=t.blockTurned.get();if(r.neutralBlocks.includes(s))return U.failure(w3e.CANNOT_ROTATE_NEUTRAL_BLOCK())}return U.success(void 0)}getVictoryCoords(t){let e=[];for(const r of B3.VICTORY_SOURCE){const s=t.getPieceAt(r[0]),i=[r[0]];if(s.isPlayer()){let o=r[0].getNext(r[1]),c=!0;for(let u=0;u<3&&c;u++)t.getPieceAt(o)!==s?c=!1:(i.push(o),o=o.getNext(r[1]));if(c&&(t.getPieceAt(o)===s&&(i.push(o),e=e.concat(i)),r[2])){const u=r[0].getPrevious(r[1],1);t.getPieceAt(u)===s&&(i.push(u),e=e.concat(i))}}}return e}getGameStatus(t){const e=t.gameState,r=this.getVictoryCoords(e),s=[!1,!1];for(let i=0;i<r.length;i+=5)s[e.getPieceAt(r[i]).value]=!0;return!0===s[0]?!0===s[1]?xe.DRAW:xe.ZERO_WON:!0===s[1]?xe.ONE_WON:36===e.turn?xe.DRAW:xe.ONGOING}}B3.singleton=P.empty(),B3.VICTORY_SOURCE=[[new M(1,0),new Gt(1,1),!1],[new M(0,1),new Gt(1,1),!1],[new M(4,0),new Gt(-1,1),!1],[new M(5,1),new Gt(-1,1),!1],[new M(1,1),new Gt(1,1),!0],[new M(4,1),new Gt(-1,1),!0],[new M(0,1),new Gt(0,1),!0],[new M(1,1),new Gt(0,1),!0],[new M(2,1),new Gt(0,1),!0],[new M(3,1),new Gt(0,1),!0],[new M(4,1),new Gt(0,1),!0],[new M(5,1),new Gt(0,1),!0],[new M(1,0),new Gt(1,0),!0],[new M(1,1),new Gt(1,0),!0],[new M(1,2),new Gt(1,0),!0],[new M(1,3),new Gt(1,0),!0],[new M(1,4),new Gt(1,0),!0],[new M(1,5),new Gt(1,0),!0]];class YP extends G1{getListMoves(t){const e=[],r=t.gameState.neutralBlocks;if(0===t.gameState.turn)return YP.FIRST_TURN_MOVES;const s=this.getLegalDrops(t.gameState);for(const i of s){const o=Ds.rotationless(i.x,i.y),c=t.gameState.applyLegalDrop(o),u=this.getLegalRotations(c,r);for(const p of u)e.push(Ds.withRotation(i.x,i.y,p[0],p[1]));0===c.neutralBlocks.length==0&&e.push(o)}return e}getLegalDrops(t){const e=[];for(let r=0;r<6;r++)for(let s=0;s<6;s++){const i=new M(s,r);t.getPieceAt(i)===pe.NONE&&e.push(i)}return e}getLegalRotations(t,e){const r=0===t.neutralBlocks.length,s=[];for(let i=0;i<4;i++)!1===t.blockIsNeutral(i)&&(e.includes(i)?r&&s.push([i,!0]):s.push([i,!0],[i,!1]));return s}getBoardValue(t){return B3.get().getGameStatus(t).toBoardValue()}}YP.FIRST_TURN_MOVES=[Ds.rotationless(0,0),Ds.rotationless(1,0),Ds.rotationless(2,0),Ds.rotationless(0,1),Ds.rotationless(1,1),Ds.rotationless(0,2)];const Ye=pe.NONE,U4=pe.ZERO,m6=pe.ONE;class b3e{constructor(){this.tutorial=[ce.informational($localize`Initial board`,$localize`The initial Pentago board is made of 6x6 spaces, subdivided in 4 quadrants, which can each rotate.`,z2.getInitialState()),ce.informational($localize`Goal of the game`,$localize`The goal at Pentago is to align 5 of your pieces. In the following board, Dark wins.`,new z2([[U4,Ye,Ye,U4,m6,Ye],[U4,m6,Ye,Ye,Ye,Ye],[U4,Ye,m6,Ye,Ye,Ye],[U4,Ye,Ye,Ye,Ye,m6],[U4,Ye,Ye,Ye,m6,Ye],[Ye,Ye,Ye,Ye,Ye,Ye]],10)).withPreviousMove(Ds.withRotation(0,0,0,!1)),ce.fromPredicate($localize`Simple move`,$localize`At their turn, players put a piece on the board and possibly rotate one quadrant.
        As long as there are neutral quadrants, i.e., quadrants that would not change after being rotated, a player may skip rotating a quadrant.
        To do this, you have to click on the crossed circle that appears at the center of the board when it is possible.<br/><br/>
        You're playing dark, do a simple move.`,new z2([[Ye,Ye,Ye,Ye,Ye,Ye],[Ye,U4,Ye,Ye,m6,Ye],[Ye,Ye,Ye,Ye,Ye,Ye],[Ye,Ye,Ye,Ye,Ye,Ye],[Ye,m6,Ye,Ye,U4,Ye],[Ye,Ye,Ye,Ye,Ye,Ye]],10),Ds.rotationless(2,2),(t,e,r)=>t.blockTurned.isPresent()?G.failure($localize`You have made a move with a rotation. This tutorial step is about moves without rotations!`):G.SUCCESS,$localize`Congratulations!`),ce.fromPredicate($localize`Move with rotation`,$localize`After putting a piece, arrows will appear on non-neutral quadrants.<br/><br/>
        You're playing Dark, place a piece on a quadrant and do a rotation!`,new z2([[Ye,Ye,Ye,Ye,Ye,Ye],[Ye,U4,Ye,Ye,m6,Ye],[Ye,Ye,Ye,Ye,Ye,Ye],[Ye,Ye,Ye,Ye,Ye,Ye],[Ye,m6,Ye,Ye,U4,Ye],[Ye,Ye,Ye,Ye,Ye,Ye]],10),Ds.withRotation(0,0,0,!0),(t,e,r)=>t.blockTurned.isPresent()?G.SUCCESS:G.failure($localize`You made a move without rotation, try again!`),$localize`Congratulations! Note that if all quadrants are neutral after you have put your piece, there will be no rotation.`)]}}function y8t(n,t){if(1&n){const e=Oe();F(),un(0),b(1,"circle",9),ee("click",function(){const i=he(e).$implicit,o=v().$implicit,c=v().index,u=v().index;return le(v().onClick(3*c+i,3*u+o))}),O(),fn()}if(2&n){const e=t.$implicit,r=v().$implicit,s=v(),i=s.index,o=s.$implicit,c=v(),u=c.index,h=c.$implicit,p=v();S(1),We("id","click_",3*i+e,"_",3*u+r,""),T("ngClass",p.getSquareClasses(3*i+e,3*u+r)),D("cx",o+2*p.STROKE_WIDTH+(e+.5)*p.SPACE_SIZE)("cy",h+2*p.STROKE_WIDTH+(r+.5)*p.SPACE_SIZE)("r",(p.SPACE_SIZE-p.STROKE_WIDTH)/2)}}const O3e=function(){return[0,1,2]};function E8t(n,t){1&n&&(F(),un(0),x(1,y8t,2,6,"ng-container",3),fn()),2&n&&(S(1),T("ngForOf",rr(1,O3e)))}function M8t(n,t){if(1&n&&(F(),un(0),Q(1,"rect",8),x(2,E8t,2,2,"ng-container",3),fn()),2&n){const e=t.$implicit,r=t.index,s=v(),i=s.index,o=s.$implicit,c=v();S(1),T("ngClass",c.getBlockClasses(r,i)),D("x",c.STROKE_WIDTH+e)("y",c.STROKE_WIDTH+o)("rx",3*c.STROKE_WIDTH)("ry",3*c.STROKE_WIDTH)("width",c.BLOCK_WIDTH)("height",c.BLOCK_WIDTH),S(1),T("ngForOf",rr(8,O3e))}}const N3e=function(n){return[0,n]};function S8t(n,t){if(1&n&&(F(),un(0),x(1,M8t,3,9,"ng-container",3),fn()),2&n){const e=v();S(1),T("ngForOf",P3(1,N3e,e.BLOCK_SEPARATION))}}function P8t(n,t){if(1&n&&(F(),Q(0,"circle",10)),2&n){const e=v();We("id","currentDrop_",e.currentDrop.get().x,"_",e.currentDrop.get().y,""),T("ngClass",e.getPlayerClass(e.getCurrentPlayer())),D("cx",e.getCenter(e.currentDrop.get().x))("cy",e.getCenter(e.currentDrop.get().y))("r",(e.SPACE_SIZE-e.STROKE_WIDTH)/2)}}function T8t(n,t){if(1&n){const e=Oe();F(),b(0,"path",11),ee("click",function(){const i=he(e).$implicit;return le(v().rotate(i))}),O()}if(2&n){const e=t.$implicit,r=v();We("id","rotate_",e[1],"_",e[2]?"clockwise":"counterclockwise",""),D("d",e[0])("stroke-width",2*r.STROKE_WIDTH)}}function w8t(n,t){if(1&n&&(F(),Q(0,"circle",12)),2&n){const e=t.$implicit,r=v();We("id","victoryCoord_",e.x,"_",e.y,""),T("ngClass",r.getSquareClasses(e.x,e.y)),D("cx",r.getCenter(e.x))("cy",r.getCenter(e.y))("r",(r.SPACE_SIZE-r.STROKE_WIDTH)/2)("stroke-width",r.STROKE_WIDTH)}}function b8t(n,t){if(1&n){const e=Oe();F(),b(0,"g",13),ee("click",function(){return he(e),le(v().skipRotation())}),Q(1,"circle",14)(2,"line",15),O()}if(2&n){const e=v();S(1),D("cx",e.BLOCK_SEPARATION)("cy",e.BLOCK_SEPARATION)("r",.75*e.SPACE_SIZE)("stroke-width",2*e.STROKE_WIDTH),S(1),D("x1",e.BLOCK_SEPARATION-e.DIAGONAL_BAR_OFFSET)("y1",e.BLOCK_SEPARATION+e.DIAGONAL_BAR_OFFSET)("x2",e.BLOCK_SEPARATION+e.DIAGONAL_BAR_OFFSET)("y2",e.BLOCK_SEPARATION-e.DIAGONAL_BAR_OFFSET)("stroke-width",2*e.STROKE_WIDTH)}}let O8t=(()=>{class n extends to{constructor(e){super(e),this.arrows=[],this.victoryCoords=[],this.rules=B3.get(),this.availableMinimaxes=[new YP(this.rules,"PentagoMinimax")],this.encoder=Ds.encoder,this.tutorial=(new b3e).tutorial,this.BLOCK_WIDTH=3*this.SPACE_SIZE+2*this.STROKE_WIDTH,this.BLOCK_SEPARATION=this.BLOCK_WIDTH+2*this.STROKE_WIDTH,this.DIAGONAL_BAR_OFFSET=.75*Math.cos(Math.PI/4)*this.SPACE_SIZE,this.ARROWS=this.generateArrowsCoord(),this.updateBoard()}updateBoard(){this.board=this.getState().getCopiedBoard(),this.victoryCoords=this.rules.getVictoryCoords(this.getState()),this.showLastMove()}showLastMove(){const e=this.rules.node.move;if(this.cancelMoveAttempt(),e.isAbsent())this.hidePreviousMove();else{const r=e.get();this.movedBlock=r.blockTurned;const s=new M(r.coord.x%3-1,r.coord.y%3-1);if(r.blockTurned.isPresent()&&!1===s.equals(new M(0,0))&&this.coordBelongToBlock(r)){let i;i=r.turnedClockwise?Me.getNonNullable(z2.ROTATION_MAP.find(h=>h[0].equals(s)))[1]:Me.getNonNullable(z2.ROTATION_MAP.find(h=>h[1].equals(s)))[0];const o=r.blockTurned.get();i=i.getNext(new Gt(o%2==0?1:4,o<2?1:4),1),this.lastDrop=P.of(i)}else this.lastDrop=P.of(r.coord)}}coordBelongToBlock(e){return e.blockTurned.equalsValue(2*(e.coord.y<3?0:1)+(e.coord.x<3?0:1))}hidePreviousMove(){this.lastDrop=P.empty(),this.movedBlock=P.empty(),this.victoryCoords=[]}generateArrowsCoord(){const e=2*this.BLOCK_SEPARATION,r=this.SPACE_SIZE,s=.5*this.SPACE_SIZE;return[["M "+s+" 0 q "+r+" -"+r+" "+2*r+" 0",0,!0],["M 0 "+s+" q -"+r+" "+r+" 0 "+2*r,0,!1],["M "+e+" "+s+" q "+r+" "+r+" 0 "+2*r,1,!0],["M "+(e-s)+" 0 q -"+r+" -"+r+" -"+2*r+" 0",1,!1],["M 0 "+(e-s)+" q -"+r+" -"+r+" 0 -"+2*r,2,!0],["M "+s+" "+e+" q "+r+" "+r+" "+2*r+" 0",2,!1],["M "+(e-s)+" "+e+" q -"+r+" "+r+" -"+2*r+" 0",3,!0],["M "+e+" "+(e-s)+" q "+r+" -"+r+" 0 -"+2*r,3,!1]]}cancelMoveAttempt(){this.arrows=[],this.currentDrop=P.empty(),this.canSkipRotation=!1}onClick(e,r){var s=this;return A(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());if(s.board[r][e].isPlayer())return s.cancelMove(tt.MUST_LAND_ON_EMPTY_SPACE());const o=Ds.rotationless(e,r),c=s.getState(),u=c.applyLegalDrop(o);if(4===u.neutralBlocks.length)return s.chooseMove(o,c);const h=s.rules.getGameStatus(s.rules.node);return s.canSkipRotation=u.neutralBlocks.length>0&&!1===h.isEndGame,s.currentDrop=P.of(new M(e,r)),s.displayArrows(u.neutralBlocks),G.SUCCESS})()}getCenter(e){return(e<3?0:this.BLOCK_SEPARATION)+2*this.STROKE_WIDTH+(e%3+.5)*this.SPACE_SIZE}displayArrows(e){this.arrows=[];for(let r=0;r<4;r++)if(!1===e.includes(r)){const s=this.ARROWS.filter(i=>i[1]===r);this.arrows=this.arrows.concat(s)}}getBlockClasses(e,r){return this.movedBlock.equalsValue(e+2*r)?["moved-fill"]:[]}getSquareClasses(e,r){const s=[],i=this.getPlayerClass(this.board[r][e]);return s.push(i),this.lastDrop.equalsValue(new M(e,r))&&s.push("last-move-stroke"),s}rotate(e){var r=this;return A(function*(){const i=r.canUserPlay("#rotate_"+e[1]+"_"+(e[2]?"clockwise":"counterclockwise"));if(i.isFailure())return r.cancelMove(i.getReason());const o=r.currentDrop.get(),c=Ds.withRotation(o.x,o.y,e[1],e[2]);return r.chooseMove(c,r.getState())})()}skipRotation(){var e=this;return A(function*(){const r=e.canUserPlay("#skipRotation");if(r.isFailure())return e.cancelMove(r.getReason());const s=e.currentDrop.get(),i=Ds.rotationless(s.x,s.y);return e.chooseMove(i,e.getState())})()}}return n.\u0275fac=function(e){return new(e||n)(J(Pn))},n.\u0275cmp=gt({type:n,selectors:[["app-pentago"]],features:[l],decls:9,vars:7,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-60 -60 780 780"],["id","arrowhead","markerWidth","5","markerHeight","3.5","refX","2.5","refY","1.75","orient","auto","fill","blue"],["points","0 0, 5 1.75, 0 3.5"],[4,"ngFor","ngForOf"],["class","base","pointer-events","fill",3,"id","ngClass",4,"ngIf"],["class","no-fill","stroke","blue","marker-end","url(#arrowhead)",3,"id","click",4,"ngFor","ngForOf"],["class","base victory-stroke",3,"id","ngClass",4,"ngFor","ngForOf"],["id","skipRotation",3,"click",4,"ngIf"],[1,"base","no-fill",3,"ngClass"],["pointer-events","fill",1,"base",3,"id","ngClass","click"],["pointer-events","fill",1,"base",3,"id","ngClass"],["stroke","blue","marker-end","url(#arrowhead)",1,"no-fill",3,"id","click"],[1,"base","victory-stroke",3,"id","ngClass"],["id","skipRotation",3,"click"],["stroke","red",1,"background"],["stroke","red"]],template:function(e,r){1&e&&(F(),b(0,"svg",0)(1,"defs")(2,"marker",1),Q(3,"polygon",2),O()(),x(4,S8t,2,3,"ng-container",3),x(5,P8t,1,6,"circle",4),x(6,T8t,1,4,"path",5),x(7,w8t,1,7,"circle",6),x(8,b8t,3,9,"g",7),O()),2&e&&(S(4),T("ngForOf",P3(5,N3e,r.BLOCK_SEPARATION)),S(1),T("ngIf",r.currentDrop.isPresent()),S(1),T("ngForOf",r.arrows),S(1),T("ngForOf",r.victoryCoords),S(1),T("ngIf",r.canSkipRotation))},dependencies:[dn,An,en],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class G4 extends M{constructor(t,e,r){super(t,e),this.z=r}static getEncoder(t){return new class extends k4{encode(e){return{x:e.x,y:e.y,z:e.z}}decode(e){const r=e;return ve(null!=r.x&&"number"==typeof r.x&&null!=r.y&&"number"==typeof r.y,"Invalid encoded Coord3D"),t(r.x,r.y,r.z)}}}static of(t,e,r){return new G4(t,e,r)}toString(){return"Coord3D"+this.toShortString()}toShortString(){return"("+this.x+", "+this.y+", "+this.z+")"}equals(t){return this===t||t.x===this.x&&t.y===this.y&&t.z===this.z}isHigherThan(t){return this.z>t.z}}G4.encoder=G4.getEncoder(G4.of),G4.optionalEncoder=P.getEncoder(G4.encoder);class Tn extends G4{constructor(t,e,r){if(super(t,e,r),t<0||t>3)throw new Error(`PylosCoord: Invalid X: ${t}.`);if(e<0||e>3)throw new Error(`PylosCoord: Invalid Y: ${e}.`);if(r<0||r>3)throw new Error(`PylosCoord: Invalid Z: ${r}.`);const s=4-r;if(this.isNotInRange(s,s))throw new Error(this.toString()+" is not in range.")}static from(t,e,r){return new Tn(t,e,r)}toString(){return"PylosCoord"+this.toShortString()}getLowerPieces(){if(0===this.z)throw new Error("PylosCoord: floor pieces don't have lower pieces.");const t=this.z-1;return[new Tn(this.x,this.y,t),new Tn(this.x+1,this.y,t),new Tn(this.x,this.y+1,t),new Tn(this.x+1,this.y+1,t)]}getHigherCoords(){if(3===this.z)throw new Error("Top piece don't have lower pieces.");const t=this.z+1,e=new M(this.x-1,this.y-1),r=new M(this.x,this.y-1),s=new M(this.x-1,this.y),i=new M(this.x,this.y),o=4-t;return[e,r,s,i].filter(c=>c.isInRange(o,o)).map(c=>new Tn(c.x,c.y,t))}getNextValid(t){const e=new M(this.x,this.y).getNext(t),r=4-this.z;return e.isNotInRange(r,r)?P.empty():P.of(new Tn(e.x,e.y,this.z))}}Tn.encoder=G4.getEncoder(Tn.from),Tn.optionalEncoder=P.getEncoder(Tn.encoder);let f8=(()=>{class n{}return n.MUST_MOVE_UPWARD=()=>$localize`You must move your pieces upward.`,n.SHOULD_HAVE_SUPPORTING_PIECES=()=>$localize`Your piece must land on the board or on 4 other pieces.`,n.CANNOT_MOVE_SUPPORTING_PIECE=()=>$localize`You cannot move a supporting piece.`,n.CANNOT_CAPTURE=()=>$localize`You cannot capture.`,n.INVALID_FIRST_CAPTURE=()=>$localize`Your first capture is invalid.`,n.INVALID_SECOND_CAPTURE=()=>$localize`Your second capture is invalid.`,n})(),A3e=(()=>{class n{}return n.MUST_CAPTURE_MAXIMUM_TWO_PIECES=()=>$localize`You must capture one or two pieces, not more.`,n})();class vs extends Gi{constructor(t,e,r,s){super(),this.startingCoord=t,this.landingCoord=e,this.firstCapture=r,this.secondCapture=s}static fromClimb(t,e,r){const s=P.of(t),i=vs.checkCaptures(r),o=new vs(s,e,i.firstCapture,i.secondCapture);if(!1===e.isHigherThan(t))throw new Error(f8.MUST_MOVE_UPWARD());return o}static checkCaptures(t){let e=P.empty(),r=P.empty();if(t.length>0&&(e=P.of(t[0]),t.length>1)){if(t[1].equals(t[0]))throw new Error("PylosMove: should not capture twice same piece.");if(r=P.of(t[1]),t[1].isHigherThan(t[0])&&(e=P.of(t[1]),r=P.of(t[0])),t.length>2)throw new Error(A3e.MUST_CAPTURE_MAXIMUM_TWO_PIECES())}return{firstCapture:e,secondCapture:r}}static fromDrop(t,e){const r=P.empty(),s=vs.checkCaptures(e);return new vs(r,t,s.firstCapture,s.secondCapture)}static changeCapture(t,e){const r=vs.checkCaptures(e);return new vs(t.startingCoord,t.landingCoord,r.firstCapture,r.secondCapture)}isClimb(){return this.startingCoord.isPresent()}toString(){const t=this.startingCoord.isAbsent()?"-":this.startingCoord.get().toShortString(),e=this.firstCapture.isAbsent()?"-":this.firstCapture.get().toShortString(),r=this.secondCapture.isAbsent()?"-":this.secondCapture.get().toShortString();return"PylosMove("+t+", "+this.landingCoord.toShortString()+", "+e+", "+r+")"}equals(t){return t===this||!!(this.startingCoord.equals(t.startingCoord)&&this.landingCoord.equals(t.landingCoord)&&this.firstCapture.equals(t.firstCapture)&&this.secondCapture.equals(t.secondCapture))}}vs.encoder=new class extends mi{encodeMove(n){return{firstCapture:Tn.optionalEncoder.encode(n.firstCapture),landingCoord:Tn.encoder.encode(n.landingCoord),secondCapture:Tn.optionalEncoder.encode(n.secondCapture),startingCoord:Tn.optionalEncoder.encode(n.startingCoord)}}decodeMove(n){const e=n.firstCapture,r=n.landingCoord,s=n.secondCapture;return new vs(Tn.optionalEncoder.decode(n.startingCoord),Tn.encoder.decode(r),Tn.optionalEncoder.decode(e),Tn.optionalEncoder.decode(s))}};class qc extends fP{constructor(t,e){super(e),this.boards=t}static getInitialState(){const t=Ke.createTable(4,4,pe.NONE),e=Ke.createTable(3,3,pe.NONE),r=Ke.createTable(2,2,pe.NONE);return new qc([t,e,r,[[pe.NONE]]],0)}static getLevelRange(t){switch(t){case 0:return[0,1,2,3];case 1:return[0,1,2];default:return Me.expectToBe(t,2),[0,1]}}getPieceAt(t){return this.boards[t.z][t.y][t.x]}applyLegalMove(t,e=!0){const r=[];let s;return r.push({coord:t.landingCoord,value:this.getCurrentPlayer()}),t.startingCoord.isPresent()&&r.push({coord:t.startingCoord.get(),value:pe.NONE}),t.firstCapture.isPresent()&&r.push({coord:t.firstCapture.get(),value:pe.NONE}),t.secondCapture.isPresent()&&r.push({coord:t.secondCapture.get(),value:pe.NONE}),s=e?this.turn+1:this.turn,this.setBoardAtCoords(r,s)}setBoardAtCoords(t,e){const r=[Ke.copyBiArray(this.boards[0]),Ke.copyBiArray(this.boards[1]),Ke.copyBiArray(this.boards[2]),Ke.copyBiArray(this.boards[3])];for(const s of t){const i=s.coord;r[i.z][i.y][i.x]=s.value}return new qc(r,e)}isLandable(t){if(this.getPieceAt(t).isPlayer())return!1;if(0===t.z)return!0;const e=t.getLowerPieces();for(const r of e)if(this.getPieceAt(r)===pe.NONE)return!1;return!0}isSupporting(t){if(3===t.z)return!1;const e=t.getHigherCoords();for(const r of e)if(this.getPieceAt(r).isPlayer())return!0;return!1}getPiecesRepartition(){const t={};t[pe.NONE.value]=0,t[z.ZERO.value]=0,t[z.ONE.value]=0;for(let e=0;e<3;e++)for(let r=0;r<4-e;r++)for(let s=0;s<4-e;s++){const i=new Tn(s,r,e),o=this.getPieceAt(i);t[o.value]=1+t[o.value]}return t}removePieceAt(t){return this.setBoardAtCoords([{coord:t,value:pe.NONE}],this.turn)}dropCurrentPlayersPieceAt(t){const e={coord:t,value:this.getCurrentPlayer()};return this.setBoardAtCoords([e],this.turn)}getFreeToMoves(){const t=[],e=this.getCurrentPlayer();for(let r=0;r<=2;r++){const s=qc.getLevelRange(r);for(const i of s)for(const o of s){const c=new Tn(o,i,r);this.getPieceAt(c).equals(e)&&!1===this.isSupporting(c)&&t.push(c)}}return t}}class Bo extends U1{static getStateInfo(t){const e=[],r=[];for(let s=0;s<3;s++)for(let i=0;i<4-s;i++)for(let o=0;o<4-s;o++){const c=new Tn(o,i,s);t.getPieceAt(c)===t.getCurrentPlayer()&&!1===t.isSupporting(c)&&e.push(c),t.isLandable(c)&&r.push(c)}return{freeToMove:e,landable:r}}static getClimbingMoves(t){const e=[];for(const r of t.freeToMove)for(const s of t.landable)if(s.isHigherThan(r)&&!1===s.getLowerPieces().some(i=>r.equals(i))){const i=vs.fromClimb(r,s,[]);e.push(i)}return e}static getDropMoves(t){const e=[];for(const r of t.landable){const s=vs.fromDrop(r,[]);e.push(s)}return e}static canCapture(t,e){const r=t.getCurrentPlayer();for(const s of[Fe.UP,Fe.DOWN]){const i=e.getNextValid(s);if(i.isPresent()&&t.getPieceAt(i.get())===r)for(const o of[Fe.LEFT,Fe.RIGHT]){const c=i.get().getNextValid(o);if(c.isPresent()&&t.getPieceAt(c.get())===r){const u=s.getOpposite(),h=c.get().getNextValid(u).get();if(t.getPieceAt(h)===r)return!0}}}return!1}static getPossibleCaptures(t){const e=new Dt,r=t.getFreeToMoves();for(const s of r){e.add(new Dt([s]));const o=t.removePieceAt(s).getFreeToMoves();for(const c of o){const u=new Dt([s,c]);e.add(u)}}return e}static applyLegalMove(t,e,r){return e.applyLegalMove(t)}static isValidCapture(t,e,r){const s=t.getCurrentPlayer();return!(!r.equals(e.landingCoord)&&t.getPieceAt(r)!==s)&&0===r.getHigherCoords().filter(o=>t.getPieceAt(o).isPlayer()&&!1===o.equals(e.firstCapture.get())).length}static getGameStatus(t){const r=t.gameState.getPiecesRepartition();return 15===r[z.ZERO.value]?xe.ONE_WON:15===r[z.ONE.value]?xe.ZERO_WON:xe.ONGOING}applyLegalMove(t,e,r){return Bo.applyLegalMove(t,e,r)}isLegal(t,e){const r=this.isLegalStartingCoord(t,e);if(r.isFailure())return U.failure(r.getReason());const s=r.get(),i=this.isLegalLandingCoord(t,s);if(i.isFailure())return U.failure(i.getReason());const o=i.get(),c=this.isLegalCaptures(t,o);return c.isFailure()?c:U.success(void 0)}isLegalStartingCoord(t,e){const r=e.getCurrentOpponent();if(t.startingCoord.isPresent()){const s=t.startingCoord.get(),i=e.getPieceAt(s);if(i===r)return U.failure(tt.CANNOT_CHOOSE_OPPONENT_PIECE());if(i===pe.NONE)return U.failure(tt.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(0===s.getHigherCoords().filter(c=>e.getPieceAt(c).isPlayer()).length){const c=e.removePieceAt(t.startingCoord.get());return U.success(c)}return U.failure(f8.CANNOT_MOVE_SUPPORTING_PIECE())}return U.success(e)}isLegalLandingCoord(t,e){return e.getPieceAt(t.landingCoord).isPlayer()?U.failure(tt.MUST_LAND_ON_EMPTY_SPACE()):e.isLandable(t.landingCoord)?U.success(e.dropCurrentPlayersPieceAt(t.landingCoord)):U.failure(f8.SHOULD_HAVE_SUPPORTING_PIECES())}isLegalCaptures(t,e){if(t.firstCapture.isAbsent())return U.success(void 0);if(!1===Bo.canCapture(e,t.landingCoord))return U.failure(f8.CANNOT_CAPTURE());if(Bo.isValidCapture(e,t,t.firstCapture.get())){const r=e.removePieceAt(t.firstCapture.get());return t.secondCapture.isAbsent()||Bo.isValidCapture(r,t,t.secondCapture.get())?U.success(void 0):U.failure(f8.INVALID_SECOND_CAPTURE())}return U.failure(f8.INVALID_FIRST_CAPTURE())}getGameStatus(t){return Bo.getGameStatus(t)}}class Xm extends G1{static getListMoves(t){const e=t.gameState,r=[],s=Bo.getStateInfo(e),i=Bo.getClimbingMoves(s),o=Bo.getDropMoves(s),c=i.concat(o);for(const u of c){const h=e.applyLegalMove(u,!1);let p=new Dt;Bo.canCapture(h,u.landingCoord)?p=Bo.getPossibleCaptures(h):r.push(u);for(const m of p){const C=vs.changeCapture(u,m.toList());r.push(C)}}return r}getListMoves(t){return Xm.getListMoves(t)}getBoardValue(t){const e=Bo.getGameStatus(t);if(e.isEndGame)return e.toBoardValue();{const r=t.gameState.getPiecesRepartition();return new Ct(r[z.ZERO.value]-r[z.ONE.value])}}}class x9 extends Xm{static countStoneUsed(t){let e=t.isClimb()?0:1;return t.firstCapture.isPresent()&&(e-=1,t.secondCapture.isPresent()&&(e-=1)),e}static sumMoveEmplacementByValue(t){let e=t.landingCoord.z;return t.startingCoord.isPresent()&&(e+=3-t.startingCoord.get().z),t.firstCapture.isPresent()&&(e+=3-t.firstCapture.get().z,t.secondCapture.isPresent()&&(e+=3-t.secondCapture.get().z)),e}getListMoves(t){const e=Xm.getListMoves(t);return this.orderMoves(e)}orderMoves(t){return t.sort((e,r)=>{const s=12*x9.countStoneUsed(e),i=12*x9.countStoneUsed(r);return s+x9.sumMoveEmplacementByValue(e)-(i+x9.sumMoveEmplacementByValue(r))})}}const it=pe.NONE,_6=pe.ZERO,I3e=pe.ONE;class x3e extends K1{constructor(){super(...arguments),this.tutorial=[ce.informational($localize`Goal of the game`,$localize`At Pylos, the goal is to be the last to play.
        To do this, you have to save up your pieces.
        As soon as a player puts its last piece, that player loses the game immediately.
        Here is what the initial board looks like, it is a board of 4 x 4 squares.
        This board will become a pyramid, little by little.
        It will be filled by the pieces of your stock. Each player has 15 pieces.`,qc.getInitialState()),ce.anyMove($localize`Dropping a piece`,$localize`When it is your turn, you can always drop one of your piece on an empty square.
        The gray squares are where you can drop your pieces.<br/><br/>
        Click on one of the squares to drop a piece there.`,qc.getInitialState(),vs.fromDrop(new Tn(1,1,0),[]),$localize`There you go, as simple as that.`),ce.fromMove($localize`Climbing`,$localize`When 4 pieces form a square, it is possible to put a fifth piece on top.
        However, when that happens, you can save a piece by climbing instead of dropping a piece.
        To climb:
        <ol>
            <li>Click on one of your free pieces, which should be lower than the landing square.</li>
            <li>Click on an empty landing square, higher than your selected piece.</li>
        </ol><br/>
        You're playing Dark, go ahead and climb!`,new qc([[[_6,I3e,it,it],[I3e,_6,it,it],[it,it,it,it],[it,it,it,_6]],[[it,it,it],[it,it,it],[it,it,it]],[[it,it],[it,it]],[[it]]],0),[vs.fromClimb(new Tn(3,3,0),new Tn(0,0,1),[])],$localize`Congratulations!<br/>
        Some important notes:
        <ol>
            <li>You cannot move a piece that is directly below another one.</li>
            <li>Of course, you cannot move the opponent's pieces.</li>
            <li>You can only climb when the landing square is higher than the starting square.</li>
        </ol>`,$localize`Failed. Try again.`),ce.fromMove($localize`Square (1/2)`,$localize`When the piece you just moved or dropped is the fourth one of a square of your color,
        you can choose anywhere on the board one or two of your pieces.
        These pieces will be removed from the board, allowing you to save up one or two pieces.
        A chosen piece must not be directly below another piece.
        A chosen piece can be the piece you just placed.<br/><br/>
        You're playing Dark. Form a square, click on one of the four pieces, then click on the V symbol on the bottom right to finalize your move.`,new qc([[[_6,_6,it,it],[it,_6,it,it],[it,it,it,it],[it,it,it,it]],[[it,it,it],[it,it,it],[it,it,it]],[[it,it],[it,it]],[[it]]],0),[vs.fromDrop(new Tn(0,1,0),[new Tn(0,0,0)]),vs.fromDrop(new Tn(0,1,0),[new Tn(0,1,0)]),vs.fromDrop(new Tn(0,1,0),[new Tn(1,0,0)]),vs.fromDrop(new Tn(0,1,0),[new Tn(1,1,0)])],$localize`Congratulations, you have saved up one piece. Note, you can cancel your selection by clicking again on the piece.`,$localize`Failed. Try again.`),ce.fromPredicate($localize`Square (2/2)`,$localize`You're playing Dark.<br/><br/>
        Do like in the previous step, but this time click on two different pieces before validating.`,new qc([[[_6,_6,it,it],[it,_6,it,it],[it,it,it,it],[it,it,it,it]],[[it,it,it],[it,it,it],[it,it,it]],[[it,it],[it,it]],[[it]]],0),vs.fromDrop(new Tn(0,1,0),[new Tn(0,0,0),new Tn(1,0,0)]),(t,e,r)=>t.secondCapture.isPresent()?G.SUCCESS:t.firstCapture.isPresent()?G.failure($localize`Failed, you only captured one piece.`):G.failure(M3e.YOU_DID_NOT_CAPTURE_ANY_PIECE()),$localize`Congratulations, you have saved up two pieces.`)]}}function N8t(n,t){if(1&n&&(F(),Q(0,"circle",8)),2&n){const e=t.$implicit,r=v().$implicit,s=v();We("id","piece_",r.value,"_",e,""),T("ngClass",s.getPlayerClass(r)),D("cx",s.SPACE_SIZE/4+e/15*(s.boardWidth-s.SPACE_SIZE/4))("cy",s.getPiecesCyForPlayer(r))("r",s.SPACE_SIZE/4-s.STROKE_WIDTH)}}function A8t(n,t){if(1&n&&(F(),b(0,"g"),x(1,N8t,1,6,"circle",7),O()),2&n){const e=t.$implicit,r=v();S(1),T("ngForOf",r.getPlayerSidePieces(e))}}function I8t(n,t){if(1&n){const e=Oe();F(),b(0,"circle",12),ee("click",function(){he(e);const s=v(2).$implicit,i=v().$implicit,o=v().$implicit;return le(v().onPieceClick(s,i,o))}),O()}if(2&n){const e=v(2).$implicit,r=v().$implicit,s=v().$implicit,i=v();j2("id","piece_",e,"_",r,"_",s,""),T("ngClass",i.getPieceClasses(e,r,s)),D("r",i.getPieceRadius(s)-i.STROKE_WIDTH)("cx",i.getPieceCx(e,r,s))("cy",i.getPieceCy(e,r,s))}}function x8t(n,t){if(1&n){const e=Oe();F(),b(0,"rect",12),ee("click",function(){he(e);const s=v(3).$implicit,i=v().$implicit,o=v().$implicit;return le(v().onDrop(s,i,o))}),O()}if(2&n){const e=v(3).$implicit,r=v().$implicit,s=v().$implicit,i=v();j2("id","drop_",e,"_",r,"_",s,""),T("ngClass",i.getSquareClasses(e,r,s)),D("width",2*i.getPieceRadius(s))("height",2*i.getPieceRadius(s))("x",i.getPieceCx(e,r,s)-i.getPieceRadius(s))("y",i.getPieceCy(e,r,s)-i.getPieceRadius(s))}}function k8t(n,t){if(1&n&&(F(),x(0,x8t,1,8,"rect",13)),2&n){const e=v(2).$implicit,r=v().$implicit,s=v().$implicit;T("ngIf",v().mustDisplayLandingCoord(e,r,s))}}function L8t(n,t){if(1&n&&(F(),un(0),x(1,I8t,1,7,"circle",10),x(2,k8t,1,1,"ng-template",null,11,r1),fn()),2&n){const e=Qn(3),r=v().$implicit,s=v().$implicit,i=v().$implicit,o=v();S(1),T("ngIf",o.isOccupied(r,s,i))("ngIfElse",e)}}function R8t(n,t){if(1&n&&(F(),b(0,"g"),x(1,L8t,4,2,"ng-container",9),O()),2&n){const e=t.$implicit,r=v().$implicit,s=v().$implicit,i=v();S(1),T("ngIf",i.mustDraw(e,r,s))}}function D8t(n,t){if(1&n&&(F(),b(0,"g"),x(1,R8t,2,1,"g",1),O()),2&n){const e=v().$implicit,r=v();S(1),T("ngForOf",r.getLevelRange(e))}}function z8t(n,t){if(1&n&&(F(),b(0,"g"),x(1,D8t,2,1,"g",1),O()),2&n){const e=t.$implicit,r=v();S(1),T("ngForOf",r.getLevelRange(e))}}function V8t(n,t){if(1&n&&(F(),Q(0,"rect",14)),2&n){const e=v();j2("id","highCapture_",e.highCapture.get().x,"_",e.highCapture.get().y,"_",e.highCapture.get().z,""),D("width",2*e.getPieceRadius(e.highCapture.get().z))("height",2*e.getPieceRadius(e.highCapture.get().z))("x",e.getPieceCxByCoord(e.highCapture.get())-e.getPieceRadius(e.highCapture.get().z))("y",e.getPieceCyByCoord(e.highCapture.get())-e.getPieceRadius(e.highCapture.get().z))}}function H8t(n,t){if(1&n){const e=Oe();F(),b(0,"g",15),ee("click",function(){return he(e),le(v().validateCapture())}),Q(1,"circle",16)(2,"polygon",17),O()}if(2&n){const e=v();D("transform","translate("+4*e.SPACE_SIZE+" "+4*e.SPACE_SIZE+")"),S(1),T("ngClass",e.getCaptureValidationButtonClasses()),D("cx",e.STROKE_WIDTH/2)("cy",e.STROKE_WIDTH/2)("r",e.SPACE_SIZE/2)}}function F8t(n,t){if(1&n){const e=Oe();F(),b(0,"g",18),ee("click",function(){const i=he(e).$implicit;return le(v().onPieceClick(i.x,i.y,i.z))}),Q(1,"line",19)(2,"line",19),O()}if(2&n){const e=t.$implicit,r=v();j2("id","capturable_",e.x,"_",e.y,"_",e.z,""),D("transform","translate("+r.getPieceCxByCoord(e)+" "+r.getPieceCyByCoord(e)+")"),S(1),D("x1",-.25*r.getPieceRadius(e.z))("y1",-.25*r.getPieceRadius(e.z))("x2",.25*r.getPieceRadius(e.z))("y2",.25*r.getPieceRadius(e.z)),S(1),D("x1",.25*r.getPieceRadius(e.z))("y1",-.25*r.getPieceRadius(e.z))("x2",-.25*r.getPieceRadius(e.z))("y2",.25*r.getPieceRadius(e.z))}}const B8t=function(){return[0,1,2]};let $8t=(()=>{class n extends t8{constructor(e){super(e),this.boardWidth=4*this.SPACE_SIZE+this.STROKE_WIDTH,this.pieceRowHeight=this.SPACE_SIZE/2,this.boardHeight=this.boardWidth+2*this.pieceRowHeight,this.lastLandingCoord=P.empty(),this.lastStartingCoord=P.empty(),this.lastFirstCapture=P.empty(),this.lastSecondCapture=P.empty(),this.highCapture=P.empty(),this.capturables=[],this.chosenStartingCoord=P.empty(),this.chosenLandingCoord=P.empty(),this.chosenFirstCapture=P.empty(),this.chosenSecondCapture=P.empty(),this.lastMove=P.empty(),this.remainingPieces={0:15,1:15},this.hasAsymetricBoard=!0,this.rules=new Bo(qc),this.availableMinimaxes=[new Xm(this.rules,"PylosMinimax"),new x9(this.rules,"PylosOrderedMinimax")],this.encoder=vs.encoder,this.tutorial=(new x3e).tutorial,this.updateBoard()}getPiecesCyForPlayer(e){return e===z.ONE?this.pieceRowHeight/2:this.boardWidth+1.5*this.pieceRowHeight}getLevelRange(e){return qc.getLevelRange(e)}mustDraw(e,r,s){const i=new Tn(e,r,s);return!!(this.constructedState.getPieceAt(i).isPlayer()||this.justClimbed(i)||this.isCaptured(i))||this.chosenLandingCoord.isAbsent()&&this.constructedState.isLandable(i)}isCaptured(e){return this.chosenFirstCapture.equalsValue(e)||this.chosenSecondCapture.equalsValue(e)}onPieceClick(e,r,s){var i=this;return A(function*(){const o=i.canUserPlay("#piece_"+e+"_"+r+"_"+s);if(o.isFailure())return i.cancelMove(o.getReason());const c=new Tn(e,r,s);return i.state.getPieceAt(c)===i.state.getCurrentOpponent()?i.cancelMove(tt.CANNOT_CHOOSE_OPPONENT_PIECE()):i.chosenStartingCoord.equalsValue(c)?(i.cancelMoveAttempt(),G.SUCCESS):i.chosenLandingCoord.isPresent()?i.isSupporting(c,i.constructedState)?i.cancelMove(f8.CANNOT_MOVE_SUPPORTING_PIECE()):i.onCaptureClick(c):i.isSupporting(c,i.getState())?i.cancelMove(f8.CANNOT_MOVE_SUPPORTING_PIECE()):i.onClimbClick(c)})()}isSupporting(e,r){return r.isSupporting(e)}onClimbClick(e){var r=this;return A(function*(){return r.chosenStartingCoord=P.of(e),r.constructedState=r.constructedState.removePieceAt(e),G.SUCCESS})()}onCaptureClick(e){var r=this;return A(function*(){return r.chosenFirstCapture.equalsValue(e)?(r.chosenFirstCapture=P.empty(),r.constructedState=r.constructedState.dropCurrentPlayersPieceAt(e),r.updateCapturableList(),G.SUCCESS):r.chosenSecondCapture.equalsValue(e)?(r.chosenSecondCapture=P.empty(),r.constructedState=r.constructedState.dropCurrentPlayersPieceAt(e),r.updateCapturableList(),G.SUCCESS):r.chosenFirstCapture.isAbsent()?(r.chosenFirstCapture=P.of(e),r.constructedState=r.constructedState.removePieceAt(e),r.updateCapturableList(),G.SUCCESS):r.chosenSecondCapture.isAbsent()?(r.chosenSecondCapture=P.of(e),r.constructedState=r.constructedState.removePieceAt(e),r.updateCapturableList(),G.SUCCESS):r.cancelMove(A3e.MUST_CAPTURE_MAXIMUM_TWO_PIECES())})()}updateCapturableList(){this.capturables=this.constructedState.getFreeToMoves()}getCaptureValidationButtonClasses(){return this.chosenFirstCapture.isPresent()||this.chosenSecondCapture.isPresent()?"":"semi-transparent"}validateCapture(){var e=this;return A(function*(){const r=e.canUserPlay("#capture_validation");return r.isFailure()?e.cancelMove(r.getReason()):e.chosenFirstCapture.isAbsent()&&e.chosenSecondCapture.isAbsent()?G.SUCCESS:e.chosenFirstCapture.isPresent()&&e.chosenSecondCapture.isAbsent()?e.concludeMoveWithCapture([e.chosenFirstCapture.get()]):e.chosenFirstCapture.isAbsent()&&e.chosenSecondCapture.isPresent()?e.concludeMoveWithCapture([e.chosenSecondCapture.get()]):e.concludeMoveWithCapture([e.chosenFirstCapture.get(),e.chosenSecondCapture.get()])})()}concludeMoveWithCapture(e){var r=this;return A(function*(){let s;return s=r.chosenStartingCoord.isAbsent()?vs.fromDrop(r.chosenLandingCoord.get(),e):vs.fromClimb(r.chosenStartingCoord.get(),r.chosenLandingCoord.get(),e),r.tryMove(s,r.state)})()}tryMove(e,r){var s=this;return A(function*(){return s.cancelMove(),s.chooseMove(e,r)})()}cancelMoveAttempt(){this.constructedState=this.state,this.chosenStartingCoord=P.empty(),this.chosenLandingCoord=P.empty(),this.chosenFirstCapture=P.empty(),this.chosenSecondCapture=P.empty(),this.capturables=[]}onDrop(e,r,s){var i=this;return A(function*(){const o=i.canUserPlay("#drop_"+e+"_"+r+"_"+s);if(o.isFailure())return i.cancelMove(o.getReason());const c=new Tn(e,r,s);return Bo.canCapture(i.constructedState,c)?(i.chosenLandingCoord=P.of(c),i.constructedState=i.constructedState.dropCurrentPlayersPieceAt(c),i.updateCapturableList(),G.SUCCESS):(i.chosenLandingCoord=P.of(c),i.concludeMoveWithCapture([]))})()}getSquareClasses(e,r,s){const i=new Tn(e,r,s);if(this.lastMove.isPresent()){const o=this.lastMove.get();if(o.firstCapture.equalsValue(i)||o.secondCapture.equalsValue(i))return["captured-fill"];if(i.equals(o.landingCoord)||o.startingCoord.equalsValue(i))return["moved-fill"]}else if(this.justClimbed(i))return["moved-fill"];return[]}justClimbed(e){return this.chosenLandingCoord.isPresent()&&this.chosenStartingCoord.equalsValue(e)}getPieceRadius(e){return this.SPACE_SIZE*(.45+.025*e)}getPieceCx(e,r,s){return this.SPACE_SIZE/2+.5*s*this.SPACE_SIZE+e*this.SPACE_SIZE}getPieceCy(e,r,s){return this.SPACE_SIZE/2+.5*s*this.SPACE_SIZE+r*this.SPACE_SIZE}getPieceCxByCoord(e){return this.getPieceCx(e.x,e.y,e.z)}getPieceCyByCoord(e){return this.getPieceCy(e.x,e.y,e.z)}isOccupied(e,r,s){const i=new Tn(e,r,s);if(this.justClimbed(i))return!1;const o=this.getState().getPieceAt(i).isPlayer(),c=this.chosenLandingCoord.equalsValue(i);return o||c}getPieceClasses(e,r,s){const i=new Tn(e,r,s),o=[this.getPieceFillClass(i)];return(this.lastLandingCoord.equalsValue(i)||this.lastStartingCoord.equalsValue(i))&&o.push("last-move-stroke"),(this.chosenStartingCoord.equalsValue(i)||this.chosenLandingCoord.equalsValue(i))&&o.push("selected-stroke"),this.isCaptured(i)&&o.push("pre-captured-fill"),o}getPieceFillClass(e){return this.chosenLandingCoord.equalsValue(e)?this.getPlayerClass(this.state.getCurrentPlayer()):this.getPlayerClass(this.state.getPieceAt(e))}getPlayerSidePieces(e){const r=this.remainingPieces[e.value],s=[];for(let i=0;i<r;i++)s.push(i);return s}updateBoard(){this.state=this.getState(),this.constructedState=this.state,this.lastMove=this.rules.node.move;const e=this.state.getPiecesRepartition();this.remainingPieces={0:15-e[0],1:15-e[1]},this.highCapture=P.empty(),this.cancelMoveAttempt(),this.lastMove.isPresent()?this.showLastMove():this.hideLastMove()}showLastMove(){const e=this.lastMove.get();this.lastLandingCoord=P.of(e.landingCoord),this.lastStartingCoord=e.startingCoord,this.lastFirstCapture=e.firstCapture,this.lastSecondCapture=e.secondCapture,this.lastFirstCapture.isPresent()&&!1===this.mustDrawCoord(this.lastFirstCapture.get())&&(this.highCapture=this.lastFirstCapture)}hideLastMove(){this.lastStartingCoord=P.empty(),this.lastLandingCoord=P.empty(),this.lastFirstCapture=P.empty(),this.lastSecondCapture=P.empty()}mustDrawCoord(e){return this.mustDraw(e.x,e.y,e.z)}mustDisplayLandingCoord(e,r,s){return!this.chosenStartingCoord.isPresent()||!!this.chosenStartingCoord.get().equals(new Tn(e,r,s))||this.chosenStartingCoord.get().z<s}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(J(Pn))},n.\u0275cmp=gt({type:n,selectors:[["app-pylos"]],features:[l],decls:10,vars:11,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["boardInItself",""],["x","0","y","0",1,"base","small-stroke"],["class","base captured-fill small-stroke",3,"id",4,"ngIf"],["id","capture_validation",3,"click",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],["class","base small-stroke",3,"id","ngClass",4,"ngFor","ngForOf"],[1,"base","small-stroke",3,"id","ngClass"],[4,"ngIf"],["class","base small-stroke",3,"id","ngClass","click",4,"ngIf","ngIfElse"],["onlyRect",""],[1,"base","small-stroke",3,"id","ngClass","click"],["class","base small-stroke",3,"id","ngClass","click",4,"ngIf"],[1,"base","captured-fill","small-stroke",3,"id"],["id","capture_validation",3,"click"],["fill","red",1,"base-no-fill","small-stroke",3,"ngClass"],["points","-32.5,-2.5 -32.5,12.5 -10,35 -2.5,35 35,-21.25 25,-21.275 -5,25 -32.5,-2.5","fill","green",1,"base-no-fill","small-stroke"],[3,"id","click"],["stroke-width","8","stroke","red"]],template:function(e,r){1&e&&(F(),b(0,"svg",0)(1,"g"),x(2,A8t,2,1,"g",1),O(),b(3,"g",null,2),Q(5,"rect",3),x(6,z8t,2,1,"g",1),x(7,V8t,1,7,"rect",4),x(8,H8t,3,5,"g",5),x(9,F8t,3,12,"g",6),O()()),2&e&&(D("viewBox","0 0 "+r.boardWidth+" "+r.boardHeight),S(1),D("transform","rotate("+180*r.role.value+" "+r.boardWidth/2+" "+r.boardHeight/2+")"),S(1),T("ngForOf",r.Player.PLAYERS),S(1),D("transform","translate("+r.STROKE_WIDTH/2+" "+(r.STROKE_WIDTH/2+r.pieceRowHeight)+")"),S(2),D("width",4*r.SPACE_SIZE)("height",4*r.SPACE_SIZE),S(1),T("ngForOf",rr(10,B8t)),S(1),T("ngIf",r.highCapture.isPresent()),S(1),T("ngIf",r.chosenLandingCoord.isPresent()),S(1),T("ngForOf",r.capturables))},dependencies:[dn,An,en],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class Ze{constructor(t){this.value=t}static fromInt(t){if(0<=t&&t<=15)return Ze.pieces[t];if(16===t)return Ze.EMPTY;throw new Error("Invalid piece ("+t+")")}equals(t){return this===t}toString(){return"QuartoPiece("+this.value+")"}isRectangle(){return this.value%4<2}}Ze.AAAA=new Ze(0),Ze.AAAB=new Ze(1),Ze.AABA=new Ze(2),Ze.AABB=new Ze(3),Ze.ABAA=new Ze(4),Ze.ABAB=new Ze(5),Ze.ABBA=new Ze(6),Ze.ABBB=new Ze(7),Ze.BAAA=new Ze(8),Ze.BAAB=new Ze(9),Ze.BABA=new Ze(10),Ze.BABB=new Ze(11),Ze.BBAA=new Ze(12),Ze.BBAB=new Ze(13),Ze.BBBA=new Ze(14),Ze.BBBB=new Ze(15),Ze.EMPTY=new Ze(16),Ze.pieces=[Ze.AAAA,Ze.AAAB,Ze.AABA,Ze.AABB,Ze.ABAA,Ze.ABAB,Ze.ABBA,Ze.ABBB,Ze.BAAA,Ze.BAAB,Ze.BABA,Ze.BABB,Ze.BBAA,Ze.BBAB,Ze.BBBA,Ze.BBBB];class W4 extends xc{constructor(t,e,r){super(t,e),this.piece=r}toString(){return"QuartoMove("+this.coord.x+", "+this.coord.y+", "+this.piece.value+")"}equals(t){return this===t||!!t.coord.equals(this.coord)&&this.piece===t.piece}}W4.encoder=new class extends Cn{maxValue(){return 496}encodeNumber(n){return 128*n.coord.x+32*n.coord.y+n.piece.value}decodeNumber(n){const t=n%32;n-=t;const e=(n/=32)%4;return n-=e,new W4(n/=4,e,Ze.fromInt(t))}};class jc extends es{constructor(t,e,r){super(t,e),this.pieceInHand=r}static getInitialState(){const t=Ke.createTable(4,4,Ze.EMPTY);return new jc(t,0,Ze.AAAA)}static isGivable(t,e,r){return t!==r&&!1===jc.isAlreadyOnBoard(t,e)}static isAlreadyOnBoard(t,e){for(let r=0;r<4;r++)for(let s=0;s<4;s++)if(e[r][s]===t)return!0;return!1}getRemainingPieces(){const t=Ze.pieces,e=[];for(const r of t)jc.isGivable(r,this.board,this.pieceInHand)&&e.push(r);return e}}let FH=(()=>{class n{}return n.MUST_GIVE_A_PIECE=()=>$localize`You must give a piece.`,n.PIECE_ALREADY_ON_BOARD=()=>$localize`That piece is already on the board.`,n.CANNOT_GIVE_PIECE_IN_HAND=()=>$localize`You cannot give the piece that was in your hands.`,n})();class Qm{constructor(t){this.subCriterion=[P.empty(),P.empty(),P.empty(),P.empty()],this.subCriterion[0]=P.of(8==(8&t.value)),this.subCriterion[1]=P.of(4==(4&t.value)),this.subCriterion[2]=P.of(2==(2&t.value)),this.subCriterion[3]=P.of(1==(1&t.value))}mergeWith(t){let e=4;for(let r=0;r<4;r++)!1===this.subCriterion[r].equals(t.subCriterion[r])&&(this.subCriterion[r]=P.empty()),this.subCriterion[r].isAbsent()&&e--;return e>0}mergeWithQuartoPiece(t){const e=new Qm(t);return this.mergeWith(e)}areAllAbsent(){for(let t=0;t<4;t++)if(this.subCriterion[t].isPresent())return!1;return!0}match(t){for(let e=0;e<4;e++)if(this.subCriterion[e].equals(t.subCriterion[e]))return!0;return!1}matchPiece(t){return this.match(new Qm(t))}toString(){return"Criterion{"+this.subCriterion.map(t=>t.isPresent()?t.get()?"1":"0":"x").join(" ")+"}"}}class q4{constructor(t,e){this.initialCoord=t,this.direction=e}allCoords(){const t=[];for(let e=0;e<4;e++)t.push(this.initialCoord.getNext(this.direction,e));return t}}class ti extends U1{static isOccupied(t){return t!==Ze.EMPTY}static isLegal(t,e){const r=t.coord.x,s=t.coord.y,i=t.piece,o=e.getCopiedBoard(),c=e.pieceInHand;return ti.isOccupied(o[s][r])?G.failure(tt.MUST_LAND_ON_EMPTY_SPACE()):i===Ze.EMPTY?15===e.turn?G.SUCCESS:G.failure(FH.MUST_GIVE_A_PIECE()):jc.isAlreadyOnBoard(i,o)?G.failure(FH.PIECE_ALREADY_ON_BOARD()):c===i?G.failure(FH.CANNOT_GIVE_PIECE_IN_HAND()):G.SUCCESS}isLegal(t,e){return ti.isLegal(t,e).toFallible(void 0)}applyLegalMove(t,e){const r=e.getCopiedBoard();return r[t.coord.y][t.coord.x]=e.pieceInHand,new jc(r,e.turn+1,t.piece)}static updateBoardStatus(t,e,r){return r.score===yn.PRE_VICTORY?this.isThereAVictoriousLine(t,e)?{score:yn.VICTORY,sensitiveSquares:new Ar}:r:this.searchForVictoryOrPreVictoryInLine(t,e,r)}static isThereAVictoriousLine(t,e){let r=t.initialCoord,s=e.getPieceAt(r);const i=new Qm(s);for(let o=0;o<3&&!1!==ti.isOccupied(s)&&!i.areAllAbsent();o++)r=r.getNext(t.direction,1),s=e.getPieceAt(r),i.mergeWithQuartoPiece(s);return!(!ti.isOccupied(s)||i.areAllAbsent())}static searchForVictoryOrPreVictoryInLine(t,e,r){const s=ti.getLineInfos(t,e,r);if(s.boardStatus.isPresent())return s.boardStatus.get();const i=s.commonCriterion,o=s.sensitiveCoord;if(i.isPresent()&&!1===i.get().areAllAbsent()){if(o.isAbsent())return{score:yn.VICTORY,sensitiveSquares:new Ar};{i.get().matchPiece(e.pieceInHand)&&(r.score=yn.PRE_VICTORY);const c=o.get();r.sensitiveSquares.add(c)}}return r}static getLineInfos(t,e,r){let s=P.empty(),i=P.empty(),o=t.initialCoord;for(let c=0;c<4;c++){const u=e.getPieceAt(o);if(u===Ze.EMPTY){if(!s.isAbsent())return{sensitiveCoord:P.of(o),commonCriterion:i,boardStatus:P.of(r)};s=P.of(o)}else i.isAbsent()?(i=P.of(new Qm(u)),X(ti.VERBOSE,"set commonCrit to "+i.toString())):(i.get().mergeWithQuartoPiece(u),X(ti.VERBOSE,"update commonCrit: "+i.toString()));o=o.getNext(t.direction,1)}return{commonCriterion:i,sensitiveCoord:s,boardStatus:P.empty()}}static scoreToGameStatus(t,e){const r=z.of(e%2);return t===yn.VICTORY?xe.getDefeat(r):16===e?xe.DRAW:xe.ONGOING}getGameStatus(t){const e=t.gameState;let r={score:yn.DEFAULT,sensitiveSquares:new Ar};for(const s of ti.lines)if(r=ti.updateBoardStatus(s,e,r),r.score===yn.VICTORY)return ti.scoreToGameStatus(r.score,e.turn);return ti.scoreToGameStatus(r.score,e.turn)}getVictoriousCoords(t){for(const e of ti.lines)if(ti.isThereAVictoriousLine(e,t))return e.allCoords();return[]}}ti.VERBOSE=!1,ti.lines=[new q4(new M(0,0),Ne.DOWN),new q4(new M(1,0),Ne.DOWN),new q4(new M(2,0),Ne.DOWN),new q4(new M(3,0),Ne.DOWN),new q4(new M(0,0),Ne.RIGHT),new q4(new M(0,1),Ne.RIGHT),new q4(new M(0,2),Ne.RIGHT),new q4(new M(0,3),Ne.RIGHT),new q4(new M(0,0),Ne.DOWN_RIGHT),new q4(new M(0,3),Ne.UP_RIGHT)];class BH extends G1{static scoreToBoardValue(t,e){if(t===yn.DEFAULT)return new Ct(0);{const r=z.of(e%2);return new Ct(t===yn.PRE_VICTORY?r.getPreVictory():r.getDefeatValue())}}getListMoves(t){const e=[],r=t.gameState,s=r.getCopiedBoard(),i=r.getRemainingPieces(),o=r.pieceInHand;let c;for(let u=0;u<4;u++)for(let h=0;h<4;h++)if(s[u][h]===Ze.EMPTY){if(c=r.getCopiedBoard(),c[u][h]=o,15===r.turn){const p=new W4(h,u,Ze.EMPTY);return e.push(p),e}for(const p of i){const m=new W4(h,u,p);e.push(m)}}return e}getBoardValue(t){const e=t.gameState;let r={score:yn.DEFAULT,sensitiveSquares:new Ar};for(const s of ti.lines)if(r=ti.updateBoardStatus(s,e,r),r.score===yn.VICTORY)break;return BH.scoreToBoardValue(r.score,e.turn)}}const U8t=Ze.AABA,G8t=Ze.AABB,k3e=Ze.ABAA,W8t=Ze.ABAB,q8t=Ze.ABBA,L3e=Ze.BAAA,j8t=Ze.BAAB,Z8t=Ze.BABB,R3e=Ze.BBAA,Y8t=Ze.BBAB,$H=Ze.BBBA,K8t=Ze.BBBB,R1=Ze.EMPTY;class D3e extends K1{constructor(){super(...arguments),this.tutorial=[ce.informational($localize`Goal of the game`,$localize`Quarto is an alignment game.
        The goal is to align four pieces that have at least one common aspect:
        <ul>
          <li>their color (light or dark),</li>
          <li>their size (big or small),</li>
          <li>their pattern (empty or dotted),</li>
          <li>their shape (round or square).</li>
        </ul>
        Here, we have a board with a victory by an alignment of dark pieces.
        Note that the pieces are not owned by any player.`,new jc([[$H,R3e,k3e,U8t],[R1,R1,R1,R1],[R1,R1,R1,R1],[R1,R1,R1,R1]],7,Ze.ABAB)),ce.anyMove($localize`Placement`,$localize`Every placement occurs in two steps: placing the piece you have in hand (in the small square) on a square of the board,
        and picking a piece that the opponent will have to place, by clicking on one of the pieces inside the dotted square.
        If you prefer, the order of these two steps can be reversed.
        Keep in mind that the second click confirms the move.<br/><br/>
        Make a move.`,new jc([[$H,G8t,q8t,R1],[R1,R1,R1,R1],[R1,L3e,R1,R1],[R1,R1,R1,R1]],7,Ze.ABAA),new W4(2,2,Ze.BAAB),$localize`Perfect!`),ce.fromMove($localize`Situation`,$localize`We have here a tricky situation.<br/><br/>
        Analyze the board and play your move, carefully paying attention not to let the opponent win on the next move.`,new jc([[K8t,$H,Y8t,R1],[k3e,Z8t,R3e,R1],[W8t,L3e,j8t,R1],[R1,R1,R1,R1]],7,Ze.AABA),[new W4(3,3,Ze.AABB)],$localize`Well done!`,$localize`Failed! Your opponent can either align:<ul><li>the squares horizontally on the third line or vertically on the third column,</li><li>small pieces horizontally on the first line or vertically on the second or third column,</li><li>empty pieces horizontally on the first line or vertically on the first column,</li><li>clear pieces diagonally.</li></ul>`)]}}function X8t(n,t){if(1&n&&(F(),Q(0,"rect",12)),2&n){const e=v(2),r=e.$implicit,s=e.index,i=v().index,o=v();T("ngClass",o.getPieceClasses(r.value)),D("x",o.SPACE_SIZE*s+(o.SPACE_SIZE/2-o.getPieceSize(r.value)))("y",o.SPACE_SIZE*i+(o.SPACE_SIZE/2-o.getPieceSize(r.value)))("width",2*o.getPieceSize(r.value))("height",2*o.getPieceSize(r.value))}}function Q8t(n,t){if(1&n&&(F(),Q(0,"circle",12)),2&n){const e=v(2),r=e.$implicit,s=e.index,i=v().index,o=v();T("ngClass",o.getPieceClasses(r.value)),D("cx",o.SPACE_SIZE*s+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*i+o.SPACE_SIZE/2)("r",o.getPieceSize(r.value))}}function J8t(n,t){if(1&n&&(F(),Q(0,"circle")),2&n){const e=v(2).index,r=v().index,s=v();D("cx",s.SPACE_SIZE*e+s.SPACE_SIZE/2)("cy",s.SPACE_SIZE*r+s.SPACE_SIZE/2)("r",10)}}function eut(n,t){if(1&n&&(F(),b(0,"g"),x(1,X8t,1,5,"rect",10),x(2,Q8t,1,4,"ng-template",null,11,r1),x(4,J8t,1,3,"circle",7),O()),2&n){const e=Qn(3),r=v().$implicit,s=v(2);S(1),T("ngIf",r.isRectangle())("ngIfElse",e),S(3),T("ngIf",s.pieceHasDot(r.value))}}function tut(n,t){if(1&n){const e=Oe();F(),b(0,"g")(1,"rect",9),ee("click",function(){const i=he(e).index,o=v().index;return le(v().chooseCoord(i,o))}),O(),x(2,eut,5,3,"g",7),O()}if(2&n){const e=t.$implicit,r=t.index,s=v().index,i=v();S(1),We("id","chooseCoord_",r,"_",s,""),T("ngClass",i.getSquareClasses(r,s)),D("x",i.SPACE_SIZE*r)("y",i.SPACE_SIZE*s)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),S(1),T("ngIf",e!==i.EMPTY)}}function nut(n,t){if(1&n&&(F(),b(0,"g",null,8),x(2,tut,3,8,"g",2),O()),2&n){const e=t.$implicit;S(2),T("ngForOf",e)}}function rut(n,t){if(1&n&&(F(),Q(0,"rect",17)),2&n){const e=v(2);T("ngClass",e.getPieceClasses(e.pieceInHand.value)),D("x",e.SPACE_SIZE/2-e.getPieceSize(e.pieceInHand.value))("y",e.SPACE_SIZE/2-e.getPieceSize(e.pieceInHand.value))("width",2*e.getPieceSize(e.pieceInHand.value))("height",2*e.getPieceSize(e.pieceInHand.value))}}function sut(n,t){if(1&n&&(F(),Q(0,"circle",12)),2&n){const e=v(2);T("ngClass",e.getPieceClasses(e.pieceInHand.value)),D("cx",e.SPACE_SIZE/2)("cy",e.SPACE_SIZE/2)("r",e.getPieceSize(e.pieceInHand.value))}}function iut(n,t){if(1&n&&(F(),Q(0,"circle")),2&n){const e=v(2);D("cx",e.SPACE_SIZE/2)("cy",e.SPACE_SIZE/2)("r",10)}}function out(n,t){if(1&n){const e=Oe();F(),b(0,"g",13,14),ee("click",function(){return he(e),le(v().deselectDroppedPiece())}),Q(2,"rect",15),x(3,rut,1,5,"rect",16),x(4,sut,1,4,"ng-template",null,11,r1),x(6,iut,1,3,"circle",7),O()}if(2&n){const e=Qn(5),r=v();We("id","droppedPiece_",r.chosen.get().x,"_",r.chosen.get().y,""),D("transform","translate("+r.chosen.get().x*r.SPACE_SIZE+" "+r.chosen.get().y*r.SPACE_SIZE+")"),S(2),D("width",r.SPACE_SIZE)("height",r.SPACE_SIZE),S(1),T("ngIf",r.pieceInHand.isRectangle())("ngIfElse",e),S(3),T("ngIf",r.pieceHasDot(r.pieceInHand.value))}}function aut(n,t){if(1&n&&(F(),b(0,"g",null,18),Q(2,"rect",19),O()),2&n){const e=t.$implicit,r=v();S(2),D("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)("transform","translate("+e.x*r.SPACE_SIZE+" "+e.y*r.SPACE_SIZE+")")}}function cut(n,t){if(1&n&&(F(),Q(0,"rect",12)),2&n){const e=v(2);T("ngClass",e.getPieceClasses(e.pieceInHand.value)),D("x",0)("y",.75*e.SPACE_SIZE)("transform","translate("+-e.getPieceSize(e.pieceInHand.value)+", "+-e.getPieceSize(e.pieceInHand.value)+")")("width",2*e.getPieceSize(e.pieceInHand.value))("height",2*e.getPieceSize(e.pieceInHand.value))}}function lut(n,t){if(1&n&&(F(),Q(0,"circle",21)),2&n){const e=v(2);T("ngClass",e.getPieceClasses(e.pieceInHand.value)),D("cy",.75*e.SPACE_SIZE)("r",e.getPieceSize(e.pieceInHand.value))}}function uut(n,t){1&n&&(F(),Q(0,"circle",22)),2&n&&D("cy",.75*v(2).SPACE_SIZE)("r",10)}function fut(n,t){if(1&n&&(F(),b(0,"g"),x(1,cut,1,6,"rect",10),x(2,lut,1,3,"ng-template",null,11,r1),x(4,uut,1,2,"circle",20),O()),2&n){const e=Qn(3),r=v();S(1),T("ngIf",r.pieceInHand.isRectangle())("ngIfElse",e),S(3),T("ngIf",r.pieceHasDot(r.pieceInHand.value))}}function hut(n,t){if(1&n&&(F(),Q(0,"rect",27)),2&n){const e=v(2).index,r=v().index,s=v();y1("id","chosenPiece_",4*r+e,""),D("x",s.SPACE_SIZE*e)("y",s.SPACE_SIZE*r)("width",s.SPACE_SIZE)("height",s.SPACE_SIZE)}}function dut(n,t){if(1&n&&(F(),Q(0,"rect",12)),2&n){const e=v(2).index,r=v().index,s=v();T("ngClass",s.getPieceClasses(4*r+e)),D("x",s.SPACE_SIZE*e+s.SPACE_SIZE/2-s.getPieceSize(4*r+e))("y",s.SPACE_SIZE*r+s.SPACE_SIZE/2-s.getPieceSize(4*r+e))("width",2*s.getPieceSize(4*r+e))("height",2*s.getPieceSize(4*r+e))}}function put(n,t){if(1&n&&(F(),Q(0,"circle",12)),2&n){const e=v(2).index,r=v().index,s=v();T("ngClass",s.getPieceClasses(4*r+e)),D("cx",s.SPACE_SIZE*e+s.SPACE_SIZE/2)("cy",s.SPACE_SIZE*r+s.SPACE_SIZE/2)("r",s.getPieceSize(4*r+e))}}function gut(n,t){if(1&n&&(F(),Q(0,"circle")),2&n){const e=v(2).index,r=v().index,s=v();D("cx",s.SPACE_SIZE*e+s.SPACE_SIZE/2)("cy",s.SPACE_SIZE*r+s.SPACE_SIZE/2)("r",10)}}function mut(n,t){if(1&n){const e=Oe();F(),b(0,"g",13),ee("click",function(){he(e);const s=v().index,i=v().index;return le(v().choosePiece(4*i+s))}),x(1,hut,1,5,"rect",26),x(2,dut,1,5,"rect",10),x(3,put,1,4,"ng-template",null,11,r1),x(5,gut,1,3,"circle",7),O()}if(2&n){const e=Qn(4),r=v().index,s=v().index,i=v();y1("id","choosePiece_",4*s+r,""),S(1),T("ngIf",i.pieceToGive.equalsValue(i.QuartoPiece.fromInt(4*s+r))),S(1),T("ngIf",(4*s+r)%4<2)("ngIfElse",e),S(3),T("ngIf",i.pieceHasDot(4*s+r))}}function _ut(n,t){if(1&n&&(F(),b(0,"g"),x(1,mut,6,5,"g",3),O()),2&n){const e=t.index,r=v().index,s=v();S(1),T("ngIf",s.isRemaining(4*r+e))}}function vut(n,t){if(1&n&&(F(),b(0,"g",null,23),Q(2,"rect",24,25),x(4,_ut,2,1,"g",2),O()),2&n){const e=t.$implicit,r=v();D("transform","translate(0 "+6.5*r.SPACE_SIZE+")"),S(2),D("x",-.125*r.SPACE_SIZE)("y",-.125*r.SPACE_SIZE)("width",4.25*r.SPACE_SIZE)("height",4.25*r.SPACE_SIZE),S(2),T("ngForOf",e)}}let Cut=(()=>{class n extends to{constructor(e){super(e),this.EMPTY=Ze.EMPTY,this.QuartoPiece=Ze,this.chosen=P.empty(),this.lastMove=P.empty(),this.pieceInHand=Ze.EMPTY,this.pieceToGive=P.empty(),this.victoriousCoords=[],this.rules=new ti(jc),this.availableMinimaxes=[new BH(this.rules,"QuartoMinimax")],this.encoder=W4.encoder,this.tutorial=(new D3e).tutorial,this.pieceInHand=this.getState().pieceInHand,this.updateBoard()}updateBoard(){const e=this.getState(),r=this.rules.node.move;this.board=e.getCopiedBoard(),this.chosen=P.empty(),this.pieceInHand=e.pieceInHand,this.victoriousCoords=this.rules.getVictoriousCoords(e),this.lastMove=r.map(s=>s.coord)}chooseCoord(e,r){var s=this;return A(function*(){const i=s.canUserPlay("#chooseCoord_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());if(s.hideLastMove(),s.board[r][e]===Ze.EMPTY){if(s.showPieceInHandOnBoard(e,r),15===s.getState().turn){const o=new W4(e,r,Ze.EMPTY);return s.chooseMove(o,s.getState())}if(s.pieceToGive.isAbsent())return G.SUCCESS;{const o=new W4(e,r,s.pieceToGive.get());return s.chooseMove(o,s.getState())}}return s.cancelMove(tt.MUST_CLICK_ON_EMPTY_SPACE())})()}choosePiece(e){var r=this;return A(function*(){const s=r.canUserPlay("#choosePiece_"+e);if(s.isFailure())return r.cancelMove(s.getReason());if(r.hideLastMove(),r.pieceToGive.equalsValue(Ze.fromInt(e)))return r.cancelMoveAttempt(),G.SUCCESS;if(r.pieceToGive=P.of(Ze.fromInt(e)),r.chosen.isAbsent())return G.SUCCESS;{const i=r.chosen.get(),o=new W4(i.x,i.y,r.pieceToGive.get());return r.chooseMove(o,r.rules.node.gameState)}})()}hideLastMove(){this.lastMove=P.empty()}cancelMoveAttempt(){this.hideLastMove(),this.pieceToGive=P.empty(),this.chosen=P.empty()}deselectDroppedPiece(){const e=this.chosen.getOrElse(new M(404,404)),s=this.canUserPlay("#droppedPiece_"+e.x+"_"+e.y);return s.isFailure()?this.cancelMove(s.getReason()):(this.cancelMoveAttempt(),G.SUCCESS)}showPieceInHandOnBoard(e,r){this.chosen=P.of(new M(e,r))}isRemaining(e){return jc.isGivable(Ze.fromInt(e),this.board,this.pieceInHand)}getSquareClasses(e,r){const s=new M(e,r);return this.lastMove.equalsValue(s)?["moved-fill"]:[]}getPieceClasses(e){const r=[];return r.push(e%2==0?"player0-fill":"player1-fill"),r}getPieceSize(e){return e<8?40:25}pieceHasDot(e){return e!==Ze.EMPTY.value&&e%8<4}}return n.\u0275fac=function(e){return new(e||n)(J(Pn))},n.\u0275cmp=gt({type:n,selectors:[["app-quarto"]],features:[l],decls:11,vars:10,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["transform","translate(5 5)"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngIf"],["pieceInHandDiv",""],["x","0","y","0",1,"base","no-fill"],["rectangleInWhichThePieceInHandIsWaiting",""],[4,"ngIf"],["boardDiv",""],[1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass",4,"ngIf","ngIfElse"],["circle",""],[1,"base",3,"ngClass"],[3,"id","click"],["droppedPiece",""],["id","selected","x","0","y","0",1,"base","selected","mid-stroke"],["x","0","y","0","class","base",3,"ngClass",4,"ngIf","ngIfElse"],["x","0","y","0",1,"base",3,"ngClass"],["victoriousCoordsDiv",""],["id","victory","x","0","y","0",1,"base","no-fill","victory-stroke"],["cx","0",4,"ngIf"],["cx","0",1,"base",3,"ngClass"],["cx","0"],["remainingPiece",""],["stroke-dasharray","10, 10",1,"base","no-fill"],["rectangleInWhichTheRemainingPiecesAre",""],["class","base selected-stroke",3,"id",4,"ngIf"],[1,"base","selected-stroke",3,"id"]],template:function(e,r){1&e&&(F(),b(0,"svg",0)(1,"g",1),x(2,nut,3,1,"g",2),x(3,out,7,8,"g",3),x(4,aut,3,3,"g",2),b(5,"g",null,4),Q(7,"rect",5,6),x(9,fut,5,3,"g",7),O(),x(10,vut,5,6,"g",2),O()()),2&e&&(D("viewBox","0 0 "+4.25*r.SPACE_SIZE+" "+10.75*r.SPACE_SIZE),S(2),T("ngForOf",r.board),S(1),T("ngIf",r.chosen.isPresent()),S(1),T("ngForOf",r.victoriousCoords),S(1),D("transform","translate("+2*r.SPACE_SIZE+", "+4.5*r.SPACE_SIZE+")"),S(2),D("width",1.5*r.SPACE_SIZE)("height",1.5*r.SPACE_SIZE)("transform","translate("+-.75*r.SPACE_SIZE+", 0)"),S(2),T("ngIf",r.chosen.isAbsent()),S(1),T("ngForOf",r.board))},dependencies:[dn,An,en],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})(),yut=(()=>{class n{}return n.NO_INSIDE_CLICK=()=>$localize`You must pick a space from the edge of the board.`,n})();class tc extends xc{constructor(t,e,r){super(t,e),this.direction=r;const s=tc.isValidCoord(this.coord);if(s.isFailure())throw new Error(s.getReason());if(0===t&&r===Fe.LEFT)throw new Error("Invalid direction: pawn on the left side can't be moved to the left.");if(4===t&&r===Fe.RIGHT)throw new Error("Invalid direction: pawn on the right side can't be moved to the right.");if(0===e&&r===Fe.UP)throw new Error("Invalid direction: pawn on the top side can't be moved up.");if(4===e&&r===Fe.DOWN)throw new Error("Invalid direction: pawn on the bottom side can't be moved down.")}static isInRange(t){return t.isInRange(5,5)}static isValidCoord(t){return!1===tc.isInRange(t)?G.failure("Invalid coord for QuixoMove: "+t.toString()+" is outside the board."):0!==t.x&&4!==t.x&&0!==t.y&&4!==t.y?G.failure(yut.NO_INSIDE_CLICK()):G.SUCCESS}toString(){return"QuixoMove("+this.coord.x+", "+this.coord.y+", "+this.direction.toString()+")"}equals(t){return t===this||!!t.coord.equals(this.coord)&&t.direction===this.direction}}tc.encoder=new class extends Cn{maxValue(){return 128}encodeNumber(n){const t=n.direction.toInt();return 20*n.coord.x+4*n.coord.y+t}decodeNumber(n){const t=Fe.factory.fromInt(n%4).get();n-=n%4;const e=(n/=4)%5;return n-=n%5,new tc(n/=5,e,t)}};class h8 extends es{static getInitialState(){const t=Ke.createTable(5,5,pe.NONE);return new h8(t,0)}applyLegalMove(t){const e=this.getCopiedBoard(),r=this.turn+1;let s=t.coord,i=t.coord.getNext(t.direction);for(;tc.isInRange(i);)e[s.y][s.x]=e[i.y][i.x],s=s.getNext(t.direction),i=i.getNext(t.direction);return e[s.y][s.x]=this.getCurrentPlayer(),new h8(e,r)}}class ma extends U1{static getVerticalCoords(t){const e=t.gameState.getCurrentOpponent(),r=[];for(let s=0;s<5;s++)t.gameState.getPieceAtXY(0,s)!==e&&r.push(new M(0,s)),t.gameState.getPieceAtXY(4,s)!==e&&r.push(new M(4,s));return r}static getHorizontalCenterCoords(t){const e=t.gameState.getCurrentOpponent(),r=[];for(let s=1;s<4;s++)t.gameState.getPieceAtXY(s,0)!==e&&r.push(new M(s,0)),t.gameState.getPieceAtXY(s,4)!==e&&r.push(new M(s,4));return r}static getPossibleDirections(t){const e=[];return 0!==t.x&&e.push(Fe.LEFT),0!==t.y&&e.push(Fe.UP),4!==t.x&&e.push(Fe.RIGHT),4!==t.y&&e.push(Fe.DOWN),e}static getLinesSums(t){const e={};e[z.ZERO.value]={columns:[0,0,0,0,0],rows:[0,0,0,0,0],diagonals:[0,0]},e[z.ONE.value]={columns:[0,0,0,0,0],rows:[0,0,0,0,0],diagonals:[0,0]};for(let r=0;r<5;r++)for(let s=0;s<5;s++){const i=t.getPieceAtXY(s,r);if(i.isPlayer()){const o=i.value;e[o].columns[s]=e[o].columns[s]+1,e[o].rows[r]=e[o].rows[r]+1,s===r&&(e[o].diagonals[0]=e[o].diagonals[0]+1),s+r===4&&(e[o].diagonals[1]=e[o].diagonals[1]+1)}}return e}static getVictoriousCoords(t){return ma.QUIXO_HELPER.getVictoriousCoord(t)}static getFullestLine(t){const e=t.columns.concat(t.rows.concat(t.diagonals));return Math.max(...e)}applyLegalMove(t,e,r){return ma.applyLegalMove(t,e,r)}static applyLegalMove(t,e,r){return e.applyLegalMove(t)}isLegal(t,e){return e.getPieceAt(t.coord)===e.getCurrentOpponent()?U.failure(tt.CANNOT_CHOOSE_OPPONENT_PIECE()):U.success(void 0)}getGameStatus(t){const e=t.gameState,s=ma.QUIXO_HELPER.getVictoriousCoord(e).map(o=>e.getPieceAt(o)),i=new Dt(s);return 0===i.size()?xe.ONGOING:1===i.size()?xe.getVictory(i.getAnyElement().get()):xe.getVictory(e.getCurrentPlayer())}}ma.QUIXO_HELPER=new yP(tc.isInRange,Me.identity,5);class Eut extends G1{getListMoves(t){const e=[],r=ma.getVerticalCoords(t),i=ma.getHorizontalCenterCoords(t).concat(r);for(const o of i){const c=ma.getPossibleDirections(o);for(const u of c){const h=new tc(o.x,o.y,u);e.push(h)}}return e}getBoardValue(t){const e=t.gameState,r=ma.getLinesSums(e),s=ma.getFullestLine(r[z.ZERO.value]),i=ma.getFullestLine(r[z.ONE.value]),o=e.getCurrentPlayer();return new Ct(5===s&&(o===z.ZERO||i<5)?z.ZERO.getVictoryValue():5===i?z.ONE.getVictoryValue():i-s)}}const pr=pe.NONE,Zc=pe.ZERO,$3=pe.ONE;class z3e extends K1{constructor(){super(...arguments),this.tutorial=[ce.informational($localize`Goal of the game.`,$localize`At Quixo, the goal is to align 5 of your pieces.
        The first player plays with dark pieces, the second with light pieces.
        The board is made of 25 spaces spread over a 5x5 square.
        Every piece has a neutral side, a light side, and a dark side.`,h8.getInitialState()),ce.fromMove($localize`What a move looks like (without animation)`,$localize`When it is your turn:
        <ol>
            <li>Click on one of your pieces or on a neutral one. You cannot choose a piece of the opponent.
                You can only choose a piece from the edge of the board.</li>
            <li>Pick a direction in which you want to send the piece (by clicking on the arrow).</li>
        </ol>
        You have to imagine that the piece you picked has been moved to the other side of the board, in the chosen direction.
        Once on the other side, all pieces will move by one space in the opposing direction.
        Afterwards, if the piece was neutral, it will become yours and takes your color.<br/><br/>
        For example, take the bottom right neutral piece, and move it to the left (you're playing Light).`,new h8([[pr,pr,pr,pr,pr],[pr,pr,pr,pr,pr],[pr,pr,pr,pr,pr],[pr,pr,pr,pr,pr],[Zc,Zc,Zc,Zc,pr]],1),[new tc(4,4,Fe.LEFT)],$localize`See how the four dark pieces have been moved one space to the right.
        The neutral piece has been move 4 pieces to the left and has become light.`,$localize`Failed. Try again.`),ce.fromMove($localize`Victory`,$localize`You already know everything you need in order to play, but there is one last particularity.
        If you create a line of 5 of your pieces, you win.
        If you create a line of 5 of your opponent's pieces, you lose.
        If you create both, you lose too!<br/><br/>
        You can win with this board, try it.
        You're playing Light.`,new h8([[pr,$3,pr,$3,$3],[pr,Zc,Zc,pr,Zc],[$3,$3,$3,Zc,$3],[Zc,pr,Zc,$3,$3],[$3,Zc,pr,$3,Zc]],31),[new tc(3,0,Fe.DOWN)],$localize`Congratulations, you won!`,$localize`Failed. Try again.`)]}}function Mut(n,t){if(1&n){const e=Oe();F(),b(0,"g")(1,"circle",4),ee("click",function(){const i=he(e).index,o=v().index;return le(v().onBoardClick(i,o))}),O()()}if(2&n){const e=t.index,r=v().index,s=v();S(1),We("id","click_",e,"_",r,""),T("ngClass",s.getPieceClasses(e,r)),D("r",.45*s.SPACE_SIZE)("cx",(e+.5)*s.SPACE_SIZE)("cy",(r+.5)*s.SPACE_SIZE)}}function Sut(n,t){if(1&n&&(F(),b(0,"g"),x(1,Mut,2,6,"g",2),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e)}}function Put(n,t){if(1&n){const e=Oe();F(),b(0,"use",6),ee("click",function(){const i=he(e).$implicit;return le(v(2).chooseDirection(i))}),O()}if(2&n){const e=t.$implicit,r=v(2);y1("id","chooseDirection_",e,""),D("transform",r.getArrowTransform(e))}}function Tut(n,t){if(1&n&&(F(),b(0,"g"),x(1,Put,1,2,"use",5),O()),2&n){const e=v();S(1),T("ngForOf",e.getPossiblesDirections())}}let wut=(()=>{class n extends to{constructor(e){super(e),this.lastMoveCoord=P.empty(),this.chosenCoord=P.empty(),this.victoriousCoords=[],this.rules=new ma(h8),this.availableMinimaxes=[new Eut(this.rules,"QuixoMinimax")],this.encoder=tc.encoder,this.tutorial=(new z3e).tutorial,this.updateBoard()}updateBoard(){this.state=this.getState(),this.board=this.state.board,this.lastMoveCoord=this.rules.node.move.map(e=>e.coord),this.victoriousCoords=ma.getVictoriousCoords(this.state)}cancelMoveAttempt(){this.chosenCoord=P.empty()}getPieceClasses(e,r){const s=new M(e,r),o=[];return o.push(this.getPlayerClass(this.board[r][e])),this.chosenCoord.equalsValue(s)?o.push("selected-stroke"):this.lastMoveCoord.equalsValue(s)&&o.push("last-move-stroke"),this.victoriousCoords.some(c=>c.equals(s))&&o.push("victory-stroke"),o}onBoardClick(e,r){const s=this.canUserPlay("#click_"+e+"_"+r);if(s.isFailure())return this.cancelMove(s.getReason());const i=new M(e,r),o=tc.isValidCoord(i);return o.isFailure()?this.cancelMove(o.getReason()):this.board[r][e]===this.state.getCurrentOpponent()?this.cancelMove(tt.CANNOT_CHOOSE_OPPONENT_PIECE()):(this.chosenCoord.equalsValue(i)?this.cancelMoveAttempt():this.chosenCoord=P.of(i),G.SUCCESS)}getPossiblesDirections(){const e=[],r=this.chosenCoord.get();return 4!==r.x&&e.push(Fe.RIGHT),0!==r.x&&e.push(Fe.LEFT),4!==r.y&&e.push(Fe.DOWN),0!==r.y&&e.push(Fe.UP),e}chooseDirection(e){var r=this;return A(function*(){const s=r.canUserPlay("#chooseDirection_"+e.toString());return s.isFailure()?r.cancelMove(s.getReason()):(r.chosenDirection=e,yield r.tryMove())})()}tryMove(){var e=this;return A(function*(){const r=e.chosenCoord.get(),s=new tc(r.x,r.y,e.chosenDirection);return e.cancelMove(),e.chooseMove(s,e.getState())})()}getArrowTransform(e){return class S6t{static getArrowTransform(t,e,r){let s,i,o;switch(r){case Fe.UP:s=1,i=0,o=-90;break;case Fe.DOWN:s=1,i=2,o=90;break;case Fe.LEFT:s=0,i=1,o=180;break;default:Me.expectToBe(r,Fe.RIGHT),s=2,i=1,o=0}return["scale("+t/300+")",`translate(${100*s} ${100*i})`,"rotate("+o+" 50 50)"].join(" ")}}.getArrowTransform(5*this.SPACE_SIZE,new M(0,0),e)}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(J(Pn))},n.\u0275cmp=gt({type:n,selectors:[["app-quixo"]],features:[l],decls:5,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["id","triangle","points","0 0, 100 50, 0 100"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"base",3,"id","ngClass","click"],[0,"xlink","href","#triangle","class","semi-transparent",3,"id","click",4,"ngFor","ngForOf"],[0,"xlink","href","#triangle",1,"semi-transparent",3,"id","click"]],template:function(e,r){1&e&&(F(),b(0,"svg",0)(1,"defs"),Q(2,"polygon",1),O(),x(3,Sut,2,1,"g",2),x(4,Tut,2,1,"g",3),O()),2&e&&(D("viewBox","0 0 "+5*r.SPACE_SIZE+" "+5*r.SPACE_SIZE),S(3),T("ngForOf",r.board),S(1),T("ngIf",r.chosenCoord.isPresent()))},dependencies:[dn,An,en],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})(),j1=(()=>{class n extends es{static getInitialState(){const e=Ke.createTable(n.BOARD_WIDTH,n.BOARD_HEIGHT,pe.NONE);return e[3][3]=z.ZERO,e[4][4]=z.ZERO,e[3][4]=z.ONE,e[4][3]=z.ONE,new n(e,0)}static getNeighboringPawnLike(e,r,s,i){let o;const c=[];for(let u=-1;u<2;u++)for(let h=-1;h<2;h++)o=new M(s+h,i+u),o.isInRange(this.BOARD_WIDTH,this.BOARD_HEIGHT)&&e[o.y][o.x]===r&&c.push(o);return c}countScore(){const e=[0,0];for(let r=0;r<n.BOARD_HEIGHT;r++)for(let s=0;s<n.BOARD_WIDTH;s++){const i=this.board[r][s];i.isPlayer()&&(e[i.value]+=1)}return e}}return n.BOARD_WIDTH=8,n.BOARD_HEIGHT=8,n})();class ji extends xc{equals(t){return t===this||t.coord.equals(this.coord)}toString(){return"ReversiMove("+this.coord.x+", "+this.coord.y+")"}}ji.encoder=new class extends Cn{maxValue(){return(j1.BOARD_HEIGHT-1)*j1.BOARD_WIDTH+(j1.BOARD_WIDTH-1)}encodeNumber(n){return n.coord.y*j1.BOARD_WIDTH+n.coord.x}decodeNumber(n){const t=n%j1.BOARD_WIDTH;return new ji(t,(n-t)/j1.BOARD_WIDTH)}},ji.PASS=new ji(-1,-1),ji.PASS_NUMBER=ji.encoder.encodeNumber(ji.PASS);let but=(()=>{class n{}return n.NO_ELEMENT_SWITCHED=()=>$localize`Your move should switch at least one piece.`,n})();class V3e{constructor(t,e){this.move=t,this.switched=e}}let Jm=(()=>{class n extends U1{static getGameStatus(e){const r=e.gameState;if(!1===n.isGameEnded(r))return xe.ONGOING;const i=r.countScore(),o=i[1]-i[0];return o<0?xe.ZERO_WON:o>0?xe.ONE_WON:xe.DRAW}applyLegalMove(e,r,s){const i=r.turn,o=r.getCurrentPlayer(),c=r.getCopiedBoard();if(e.equals(ji.PASS))return new j1(c,i+1);for(const h of s)c[h.y][h.x]=o;return c[e.coord.y][e.coord.x]=o,new j1(c,i+1)}static getAllSwitcheds(e,r,s){const i=[],o=r.getOpponent();for(const c of Ne.DIRECTIONS){const u=e.coord.getNext(c);if(u.isInRange(j1.BOARD_WIDTH,j1.BOARD_HEIGHT)&&s[u.y][u.x]===o){const h=n.getSandwicheds(r,c,u,s);for(const p of h)i.push(p)}}return i}static getSandwicheds(e,r,s,i){const o=[s];let c=s.getNext(r);for(;c.isInRange(j1.BOARD_WIDTH,j1.BOARD_HEIGHT);){const u=i[c.y][c.x];if(u===e)return o;if(u===pe.NONE)return[];o.push(c),c=c.getNext(r)}return[]}static isGameEnded(e){return this.playerCanOnlyPass(e)&&this.nextPlayerCantOnlyPass(e)}getGameStatus(e){return n.getGameStatus(e)}static playerCanOnlyPass(e){const r=this.getListMoves(e);return 1===r.length&&r[0].move.equals(ji.PASS)}static nextPlayerCantOnlyPass(e){const r=e.getCopiedBoard(),i=new j1(r,e.turn+1);return this.playerCanOnlyPass(i)}static getListMoves(e){const r=[];let s;const i=e.getCurrentPlayer(),o=e.getCurrentOpponent();for(let c=0;c<8;c++)for(let u=0;u<8;u++)if(e.getPieceAtXY(u,c)===pe.NONE&&(s=e.getCopiedBoard(),j1.getNeighboringPawnLike(s,o,u,c).length>0)){const p=new ji(u,c),m=n.getAllSwitcheds(p,i,s);if(m.length>0){for(const C of m)ve(i!==e.getPieceAt(C),C+"was already switched!"),s[C.y][C.x]=i;s[c][u]=i,r.push(new V3e(p,m.length))}}return 0===r.length&&r.push(new V3e(ji.PASS,0)),r}isLegal(e,r){if(e.equals(ji.PASS))return n.playerCanOnlyPass(r)?U.success([]):U.failure(tt.MUST_PASS());if(r.getPieceAt(e.coord).isPlayer())return X(n.VERBOSE,"ReversiRules.isLegal: you cannot play on a busy space"),U.failure(tt.MUST_CLICK_ON_EMPTY_SPACE());const s=r.getCopiedBoard(),i=n.getAllSwitcheds(e,r.getCurrentPlayer(),s);return X(n.VERBOSE,"ReversiRules.isLegal: "+i.length+" element(s) switched"),0===i.length?U.failure(but.NO_ELEMENT_SWITCHED()):U.success(i)}}return n.VERBOSE=!1,n})();class KP extends G1{getBoardValue(t){const e=Jm.getGameStatus(t);if(e.isEndGame)return Ct.fromWinner(e.winner);const s=t.gameState.getCopiedBoard();let i=0,o=0;for(let c=0;c<j1.BOARD_HEIGHT;c++)for(let u=0;u<j1.BOARD_WIDTH;u++){const m=(0===u||u===j1.BOARD_WIDTH-1?4:1)*(0===c||c===j1.BOARD_HEIGHT-1?4:1);s[c][u]===z.ZERO&&(i+=m),s[c][u]===z.ONE&&(o+=m)}return Ct.from(i,o)}getListMoves(t){const e=Jm.getListMoves(t.gameState);return Ke.sortByDescending(e,r=>KP.bestCoords.some(s=>r.move.coord.equals(s))?100:r.switched),e.map(r=>r.move)}}KP.bestCoords=[new M(0,0),new M(0,j1.BOARD_HEIGHT-1),new M(j1.BOARD_WIDTH-1,0),new M(j1.BOARD_WIDTH-1,j1.BOARD_HEIGHT-1)];const Ht=pe.NONE,Bt=pe.ZERO,ut=pe.ONE;class H3e extends K1{constructor(){super(...arguments),this.tutorial=[ce.informational($localize`Goal of the game`,$localize`At Reversi, the pieces are double sided: one dark side for the first player, one light side for the second player.
        When one piece is flipped, its owner changes.
        The player owning the most pieces at the end of the game wins.
        Here, Dark has 28 points and Light has 36, hence Light wins.`,new j1([[Bt,Bt,Bt,Bt,Bt,Bt,Bt,Bt],[Bt,ut,ut,ut,ut,ut,ut,Bt],[Bt,ut,ut,ut,ut,ut,ut,Bt],[Bt,ut,ut,ut,ut,ut,ut,Bt],[Bt,ut,ut,ut,ut,ut,ut,Bt],[Bt,ut,ut,ut,ut,ut,ut,Bt],[Bt,ut,ut,ut,ut,ut,ut,Bt],[Bt,Bt,Bt,Bt,Bt,Bt,Bt,Bt]],60)),ce.anyMove($localize`Capture (1/2)`,$localize`At the beginning of the game, pieces are placed as shown here.
        For a move to be legal, it must sandwich at least one piece of the opponent between the piece you're putting and another of your pieces.<br/><br/>
        Do any move by clicking to put your piece
        Dark plays first.`,j1.getInitialState(),new ji(2,4),$localize`Congratulations!`),ce.fromMove($localize`Capture (2/2)`,$localize`A move can also capture a bigger line, and more than one line at a time<br/><br/>
        You're playing light here. Play on the bottom left to see a capture.`,new j1([[Ht,Ht,Ht,Ht,Ht,Ht,Ht,Ht],[Ht,Ht,Ht,Ht,Ht,Ht,Ht,Ht],[Ht,Ht,Ht,Ht,Ht,Ht,Ht,Ht],[Ht,Ht,Ht,Ht,ut,Ht,Ht,Ht],[Ht,Ht,Ht,Bt,Ht,Ht,Ht,Ht],[Ht,Ht,Bt,Ht,Ht,Ht,Ht,Ht],[Bt,Bt,Ht,Ht,Ht,Ht,Ht,Ht],[Ht,Bt,ut,Bt,ut,Bt,Ht,Ht]],1),[new ji(0,7)],$localize`Congratulations!`,$localize`Lower and more to the left, please.`),ce.informational($localize`Passing a turn`,$localize`If, during its turn, a player has no move that would allow that player to flip a piece, that player must pass
        Moreover, if the next player could not play neither, the game ends before the board is full, and points are counted in the usual way.`,new j1([[ut,Bt,Bt,Bt,Bt,Bt,ut,Bt],[Bt,ut,ut,ut,ut,ut,ut,Bt],[Bt,ut,ut,ut,ut,ut,ut,Bt],[Bt,ut,ut,ut,ut,ut,ut,Bt],[Bt,ut,ut,ut,ut,ut,ut,Bt],[Bt,ut,ut,ut,ut,ut,ut,Bt],[ut,ut,ut,ut,ut,ut,Ht,Ht],[Bt,Bt,Bt,Bt,Bt,Bt,Ht,Ht]],60))]}}function Out(n,t){if(1&n&&(F(),Q(0,"circle",4)),2&n){const e=v().index,r=v().index,s=v();T("ngClass",s.getPieceClass(e,r)),D("r",s.SPACE_SIZE/2-s.STROKE_WIDTH)("cx",s.SPACE_SIZE*e+s.SPACE_SIZE/2)("cy",s.SPACE_SIZE*r+s.SPACE_SIZE/2)}}function Nut(n,t){if(1&n){const e=Oe();F(),b(0,"g")(1,"rect",2),ee("click",function(){const i=he(e).index,o=v().index;return le(v().onClick(i,o))}),O(),x(2,Out,1,4,"circle",3),O()}if(2&n){const e=t.index,r=v().index,s=v();S(1),We("id","click_",e,"_",r,""),T("ngClass",s.getRectClasses(e,r)),D("x",s.SPACE_SIZE*e)("y",s.SPACE_SIZE*r)("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),S(1),T("ngIf",s.board[r][e]!==s.EMPTY)}}function Aut(n,t){if(1&n&&(F(),b(0,"g"),x(1,Nut,3,8,"g",1),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e)}}let Iut=(()=>{class n extends to{constructor(e){super(e),this.EMPTY=pe.NONE,this.lastMove=new M(-2,-2),this.capturedCoords=[],this.scores=P.of([2,2]),this.rules=new Jm(j1),this.availableMinimaxes=[new KP(this.rules,"ReversiMinimax")],this.encoder=ji.encoder,this.tutorial=(new H3e).tutorial,this.canPass=!1,this.updateBoard()}onClick(e,r){var s=this;return A(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());const o=new ji(e,r);return yield s.chooseMove(o,s.getState(),s.scores.get())})()}updateBoard(){const e=this.getState();this.board=e.getCopiedBoard(),this.capturedCoords=[],this.rules.node.move.isPresent()?this.showPreviousMove():this.lastMove=new M(-2,-2),this.scores=P.of(e.countScore()),this.canPass=Jm.playerCanOnlyPass(e)}showPreviousMove(){this.lastMove=this.rules.node.move.get().coord;const e=this.getState().getCurrentPlayer(),r=this.getState().getCurrentOpponent();for(const s of Ne.DIRECTIONS){let i=this.lastMove.getNext(s,1);for(;i.isInRange(j1.BOARD_WIDTH,j1.BOARD_HEIGHT)&&this.getState().getPieceAt(i)===r&&this.rules.node.mother.get().gameState.getPieceAt(i)===e;)this.capturedCoords.push(i),i=i.getNext(s,1)}}getRectClasses(e,r){const s=new M(e,r);return this.capturedCoords.some(i=>i.equals(s))?["captured-fill"]:s.equals(this.lastMove)?["moved-fill"]:[]}getPieceClass(e,r){return this.getPlayerClass(this.board[r][e])}pass(){var e=this;return A(function*(){return ve(e.canPass,"ReversiComponent: pass() can only be called if canPass is true"),e.onClick(ji.PASS.coord.x,ji.PASS.coord.y)})()}}return n.\u0275fac=function(e){return new(e||n)(J(Pn))},n.\u0275cmp=gt({type:n,selectors:[["app-reversi"]],features:[l],decls:2,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass",4,"ngIf"],[1,"base",3,"ngClass"]],template:function(e,r){1&e&&(F(),b(0,"svg",0),x(1,Aut,2,1,"g",1),O()),2&e&&(D("viewBox","0 -4 "+8*r.SPACE_SIZE+" "+(10+8*r.SPACE_SIZE)),S(1),T("ngForOf",r.board))},dependencies:[dn,An,en],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})(),wi=(()=>{class n extends S5{static getInitialState(){const e=Ie.UNREACHABLE,r=Ie.ZERO,s=Ie.ONE,i=Ie.EMPTY;return new n([[e,e,r,s,i,i,i,r,s,e,e],[e,i,i,i,i,i,i,i,i,i,e],[s,i,i,i,i,i,i,i,i,i,r],[r,i,i,i,i,i,i,i,i,i,s],[e,i,i,i,i,i,i,i,i,i,e],[e,e,s,r,i,i,i,s,r,e,e]],0)}}return n.HEIGHT=6,n.WIDTH=11,n})(),k9=(()=>{class n{}return n.CAN_ONLY_REBOUND_ON_BLACK=()=>$localize`You can only rebound on dark spaces.`,n.CAN_ONLY_REBOUND_ON_EMPTY_SPACE=()=>$localize`You can only rebound on empty spaces.`,n.MUST_CHOOSE_PYRAMID_FIRST=()=>$localize`You must pick one of your pyramids first.`,n.MUST_CHOOSE_OWN_PYRAMID=()=>$localize`You must pick one of your pyramids.`,n.THOSE_TWO_SPACES_ARE_NOT_NEIGHBORS=()=>$localize`Those two spaces are not neighbors.`,n.THOSE_TWO_SPACES_HAVE_NO_COMMON_NEIGHBOR=()=>$localize`Those two spaces have no intermediary neighbor.`,n})();class U3 extends r8{constructor(t,e){super(t,e)}static checkDistanceAndLocation(t,e){const r=t.getOrthogonalDistance(e);if(0===r)return G.failure(tt.MOVE_CANNOT_BE_STATIC());if(1===r){const s=zc.getFakeNeighbors(t);if(e.equals(s))return G.failure(k9.THOSE_TWO_SPACES_ARE_NOT_NEIGHBORS())}else{if(2!==r)return G.failure($localize`You can move one or two spaces, not ${r}.`);if(zc.isSpaceDark(t))return G.failure(k9.CAN_ONLY_REBOUND_ON_BLACK());if(t.x===e.x)return G.failure(k9.THOSE_TWO_SPACES_HAVE_NO_COMMON_NEIGHBOR())}return G.SUCCESS}static from(t,e){if(!t.isInRange(wi.WIDTH,wi.HEIGHT))throw new Error("Move must start inside the board not at "+t.toString()+".");if(!e.isInRange(wi.WIDTH,wi.HEIGHT))throw new Error("Move must end inside the board not at "+e.toString()+".");const r=U3.checkDistanceAndLocation(t,e);return r.isFailure()?r.toFailedFallible():U.success(new U3(t,e))}isSimpleStep(){return Math.abs(this.getStart().x-this.getEnd().x)+Math.abs(this.getStart().y-this.getEnd().y)===1}equals(t){return t===this||!!t.getStart().equals(this.getStart())&&t.getEnd().equals(this.getEnd())}toString(){return"SaharaMove("+this.getStart()+"->"+this.getEnd()+")"}}U3.encoder=new class extends Cn{maxValue(){return 396*wi.WIDTH+66*wi.HEIGHT+6*wi.WIDTH+wi.HEIGHT}encodeNumber(n){const t=n.getEnd().y,e=n.getEnd().x,r=n.getStart().y;return 396*n.getStart().x+66*r+6*e+t}decodeNumber(n){const t=n%6;n-=t;const e=(n/=6)%11;n-=e;const r=(n/=11)%6;return n-=r,U3.from(new M(n/=6,r),new M(e,t)).get()}};let L9=(()=>{class n extends U1{static getStartingCoords(e,r){const s=[];for(let i=0;i<wi.HEIGHT;i++)for(let o=0;o<wi.WIDTH;o++)e[i][o].is(r)&&s.push(new M(o,i));return s}static getBoardValuesFor(e,r){const s=n.getStartingCoords(e,r),i=[];for(const o of s){const c=S5.getEmptyNeighbors(e,o,Ie.EMPTY).length;if(0===c)return[0];i.push(c)}return i.sort((o,c)=>o-c)}applyLegalMove(e,r,s){X(n.VERBOSE,"Legal move "+e.toString()+" applied");const i=r.getCopiedBoard();return i[e.getEnd().y][e.getEnd().x]=i[e.getStart().y][e.getStart().x],i[e.getStart().y][e.getStart().x]=Ie.EMPTY,new wi(i,r.turn+1)}isLegal(e,r){if(r.getPieceAt(e.getStart()).value!==r.getCurrentPlayer().value)return U.failure(tt.CANNOT_CHOOSE_OPPONENT_PIECE());if(r.getPieceAt(e.getEnd())!==Ie.EMPTY)return U.failure(tt.MUST_LAND_ON_EMPTY_SPACE());const o=zc.getCommonNeighbor(e.getStart(),e.getEnd());return o.isPresent()?r.getPieceAt(o.get())===Ie.EMPTY?U.success(void 0):U.failure(k9.CAN_ONLY_REBOUND_ON_EMPTY_SPACE()):U.success(void 0)}getGameStatus(e){const r=e.gameState.getCopiedBoard(),s=n.getBoardValuesFor(r,z.ZERO),i=n.getBoardValuesFor(r,z.ONE);return n.getGameStatusFromFreedoms(s,i)}getLandingCoords(e,r){const s=o=>o.isInRange(wi.WIDTH,wi.HEIGHT)&&e[o.y][o.x]===Ie.EMPTY,i=new Dt(zc.getNeighbors(r).filter(s));if(!0===zc.isSpaceDark(r))return i.toList();{const o=new Dt(i.toList());for(const c of i){const u=zc.getNeighbors(c).filter(s);for(const h of u)o.add(h)}return o.toList()}}static getGameStatusFromFreedoms(e,r){return 0===e[0]?xe.ONE_WON:0===r[0]?xe.ZERO_WON:xe.ONGOING}}return n.VERBOSE=!1,n})();class xut extends G1{getListMoves(t){const e=[],r=t.gameState.getCopiedBoard(),s=t.gameState.getCurrentPlayer(),i=L9.getStartingCoords(r,s);for(const o of i){const c=S5.getEmptyNeighbors(r,o,Ie.EMPTY);for(const u of c){const h=U3.from(o,u).get();if(r[u.y][u.x]=r[o.y][o.x],r[o.y][o.x]=Ie.EMPTY,e.push(h),(u.y+u.x)%2==0){const m=S5.getEmptyNeighbors(r,u,Ie.EMPTY);for(const C of m)if(!C.equals(o)){const w=U3.from(o,C).get();r[C.y][C.x]=r[u.y][u.x],r[u.y][u.x]=Ie.EMPTY,e.push(w),r[u.y][u.x]=r[C.y][C.x],r[C.y][C.x]=Ie.EMPTY}}r[o.y][o.x]=r[u.y][u.x],r[u.y][u.x]=Ie.EMPTY}}return e}getBoardValue(t){const r=t.gameState.getCopiedBoard(),s=L9.getBoardValuesFor(r,z.ZERO),i=L9.getBoardValuesFor(r,z.ONE),o=L9.getGameStatusFromFreedoms(s,i);if(o.isEndGame)return Ct.fromWinner(o.winner);let c=0;for(;c<6&&s[c]===i[c];)c++;return new Ct(i[c%6]-s[c%6])}}const Yc=Ie.UNREACHABLE,R9=Ie.ZERO,D9=Ie.ONE,xn=Ie.EMPTY;class F3e extends K1{constructor(){super(...arguments),this.tutorial=[ce.informational($localize`Initial board`,$localize`Shr is played on a board where each space is a triangle.
        Each player has six pyramids.`,wi.getInitialState()),ce.informational($localize`Goal of the game`,$localize`At Shr, the goal of the game is to immobilize one of the opponent's pyramids.
        To do so, you have to occupy all neighboring space of that pyramid.
        Here, Light has lost because its leftmost pyramid is immobilized.`,new wi([[Yc,Yc,xn,xn,D9,xn,xn,R9,D9,Yc,Yc],[Yc,xn,xn,xn,xn,xn,xn,xn,xn,xn,Yc],[D9,R9,xn,xn,xn,xn,xn,xn,xn,xn,R9],[R9,xn,xn,xn,xn,xn,xn,xn,xn,xn,D9],[Yc,xn,xn,xn,xn,xn,xn,xn,xn,xn,Yc],[Yc,Yc,D9,R9,xn,xn,xn,D9,R9,Yc,Yc]],3)),ce.fromPredicate($localize`Simple step`,$localize`To immobilize your opponent, you have to move your pyramids.
        When a pyramid shares its vertices with light spaces, it can move on these spaces (we call this a simple step).
        To perform a move:
        <ol>
            <li>Click on one of your pyramids.</li>
            <li>Click on one of its two or three neighboring spaces in order to move your pyramid there.</li>
        </ol><br/>
        You're playing Dark, do any simple step.`,wi.getInitialState(),U3.from(new M(2,0),new M(2,1)).get(),(t,e,r)=>t.isSimpleStep()?G.SUCCESS:G.failure($localize`You have made a double step, which is good but it is the next exercise!`),$localize`Congratulations!`),ce.fromPredicate($localize`Double step`,$localize`When a pyramid shares its vertices with dark spaces, it can move one or two steps.
        To do so:
        <ol>
            <li>Click on the pyramid to move.</li>
            <li>Click on one of the 6 destinations that you can reach in two steps:
                 the 6 neighboring light spaces of the 3 dark spaces that are neighbors of your pyramid.
        </ol><br/>
        You're playing Dark, do a double step.`,wi.getInitialState(),U3.from(new M(7,0),new M(5,0)).get(),(t,e,r)=>t.isSimpleStep()?G.failure($localize`Failed! You have made a single step.`):G.SUCCESS,$localize`Congratulations!`)]}}function kut(n,t){if(1&n&&(F(),b(0,"g"),Q(1,"polygon",7),O()),2&n){const e=v().index,r=v().index,s=v();S(1),T("ngClass",s.getPlayerClassFor(e,r)),D("points",s.getPyramidCoordinate(e,r))}}function Lut(n,t){if(1&n&&(F(),Q(0,"polygon",10)),2&n){const e=v(2).index,r=v().index;D("points",v().getTriangleCoordinate(e,r))}}function Rut(n,t){if(1&n&&(F(),Q(0,"polygon",11)),2&n){const e=v(2).index,r=v().index;D("points",v().getTriangleCoordinate(e,r))}}function Dut(n,t){if(1&n&&(F(),b(0,"g"),x(1,Lut,1,1,"polygon",8),x(2,Rut,1,1,"polygon",9),O()),2&n){const e=v().index,r=v().index;S(1),T("ngIf",(e+r)%2==1),S(1),T("ngIf",(e+r)%2==0)}}function zut(n,t){if(1&n){const e=Oe();F(),b(0,"g",5),ee("click",function(){const i=he(e).index,o=v().index;return le(v().onClick(i,o))}),x(1,kut,2,2,"g",6),x(2,Dut,3,2,"g",6),O()}if(2&n){const e=t.$implicit;We("id","click_",t.index,"_",v().index,""),S(1),T("ngIf",e.isPlayer()),S(1),T("ngIf",2===e.value)}}function Vut(n,t){if(1&n&&(F(),b(0,"g"),x(1,zut,3,4,"g",4),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e)}}function Hut(n,t){if(1&n&&(F(),Q(0,"polygon",14)),2&n){const e=t.$implicit,r=v(2);We("id","possible_landing_",e.x,"_",e.y,""),D("points",r.getTriangleCoordinate(e.x,e.y))}}function Fut(n,t){if(1&n&&(F(),Q(0,"polygon",14)),2&n){const e=v(2);We("id","chosen_coord_",e.chosenCoord.get().x,"_",e.chosenCoord.get().y,""),D("points",e.getTriangleCoordinate(e.chosenCoord.get().x,e.chosenCoord.get().y))}}function But(n,t){if(1&n&&(F(),un(0),x(1,Hut,1,3,"polygon",12),x(2,Fut,1,3,"polygon",13),fn()),2&n){const e=v();S(1),T("ngForOf",e.possibleLandings),S(1),T("ngIf",e.chosenCoord.isPresent())}}function $ut(n,t){if(1&n&&(F(),un(0),Q(1,"polygon",15)(2,"polygon",15),fn()),2&n){const e=v(2);S(1),D("points",e.getTriangleCoordinate(e.lastCoord.get().x,e.lastCoord.get().y)),S(1),D("points",e.getTriangleCoordinate(e.lastMoved.get().x,e.lastMoved.get().y))}}function Uut(n,t){1&n&&(F(),x(0,$ut,3,2,"ng-container",6)),2&n&&T("ngIf",v().lastMoved.isPresent())}let Gut=(()=>{class n extends Kce{constructor(e){super(e),this.lastCoord=P.empty(),this.lastMoved=P.empty(),this.chosenCoord=P.empty(),this.possibleLandings=[],this.rules=new L9(wi),this.availableMinimaxes=[new xut(this.rules,"SaharaMinimax")],this.encoder=U3.encoder,this.tutorial=(new F3e).tutorial,this.updateBoard()}cancelMoveAttempt(){this.possibleLandings=[],this.chosenCoord=P.empty()}onClick(e,r){var s=this;return A(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());const o=s.getState().getCurrentPlayer(),c=Ie.ofPlayer(o);return s.chosenCoord.equalsValue(new M(e,r))?(s.cancelMoveAttempt(),G.SUCCESS):s.chosenCoord.isAbsent()||s.board[r][e]===c?s.choosePiece(e,r):s.chooseLandingCoord(e,r)})()}choosePiece(e,r){if(this.board[r][e]===Ie.EMPTY)return this.cancelMove(k9.MUST_CHOOSE_PYRAMID_FIRST());if(this.board[r][e].is(z.fromTurn(this.getTurn()))){const s=new M(e,r);return this.selectPiece(s),G.SUCCESS}return this.cancelMove(k9.MUST_CHOOSE_OWN_PYRAMID())}selectPiece(e){this.chosenCoord=P.of(e),this.possibleLandings=this.rules.getLandingCoords(this.board,e)}chooseLandingCoord(e,r){var s=this;return A(function*(){const i=new M(e,r),o=U3.from(s.chosenCoord.get(),i);return o.isFailure()?s.cancelMove(o.getReason()):yield s.chooseMove(o.get(),s.getState())})()}updateBoard(){const e=this.rules.node.move;this.lastCoord=e.map(r=>r.getStart()),this.lastMoved=e.map(r=>r.getEnd()),this.board=this.getState().board}getPlayerClassFor(e,r){return this.getPlayerClass(z.of(this.board[r][e].value))}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(J(Pn))},n.\u0275cmp=gt({type:n,selectors:[["app-sahara"]],features:[l],decls:5,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-4 -4 300 308","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf","ngIfElse"],["lastMove",""],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[4,"ngIf"],[1,"base","small-stroke",3,"ngClass"],["class","base small-stroke",4,"ngIf"],["class","base small-stroke background2",4,"ngIf"],[1,"base","small-stroke"],[1,"base","small-stroke","background2"],["class","base no-fill small-stroke selected-stroke",3,"id",4,"ngFor","ngForOf"],["class","base no-fill small-stroke selected-stroke",3,"id",4,"ngIf"],[1,"base","no-fill","small-stroke","selected-stroke",3,"id"],[1,"base","no-fill","small-stroke","moved-stroke"]],template:function(e,r){if(1&e&&(F(),b(0,"svg",0),x(1,Vut,2,1,"g",1),x(2,But,3,2,"ng-container",2),x(3,Uut,1,1,"ng-template",null,3,r1),O()),2&e){const s=Qn(4);S(1),T("ngForOf",r.board),S(1),T("ngIf",r.chosenCoord.isPresent())("ngIfElse",s)}},dependencies:[dn,An,en],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class _a extends xc{constructor(t,e,r,s){super(t,e),this.x=t,this.y=e,this.direction=r,this.landingOrientation=s}static of(t,e,r,s){const i=new _a(t,e,r,s),o=i.coord.isNotInRange(5,5);if(i.isRotation()){if(o)return U.failure("Cannot rotate piece outside the board: "+i.toString())}else if(i.coord.getNext(i.direction.get()).isNotInRange(5,5)){if(o)return U.failure("SiamMove should end or start on the board: "+i.toString());if(i.direction.get()!==i.landingOrientation)return U.failure("SiamMove should have moveDirection and landingOrientation matching when a piece goes out of the board: "+i.toString())}return U.success(i)}isRotation(){return this.direction.isAbsent()}equals(t){return this===t||!(!this.coord.equals(t.coord)||!1===this.direction.equals(t.direction))&&this.landingOrientation===t.landingOrientation}toString(){const t=this.direction.isAbsent()?"-":this.direction.get().toString();return"SiamMove("+this.coord.x+", "+this.coord.y+", "+t+", "+this.landingOrientation+")"}isInsertion(){return-1===this.coord.x||5===this.coord.x||-1===this.coord.y||5===this.coord.y}}_a.encoder=Cn.tuple([Cn.numberEncoder(6),Cn.numberEncoder(6),P.getNumberEncoder(new Vce),new Vce],n=>[n.x+1,n.y+1,n.direction,n.landingOrientation],n=>_a.of(n[0]-1,n[1]-1,n[2],n[3]).get());class mt{constructor(t){this.value=t}static decode(t){switch(t){case 0:return mt.EMPTY;case 1:return mt.LIGHT_UP;case 2:return mt.LIGHT_RIGHT;case 3:return mt.LIGHT_DOWN;case 4:return mt.LIGHT_LEFT;case 5:return mt.DARK_UP;case 6:return mt.DARK_RIGHT;case 7:return mt.DARK_DOWN;case 8:return mt.DARK_LEFT;case 9:return mt.MOUNTAIN}}belongTo(t){return t===z.ZERO?1<=this.value&&this.value<=4:5<=this.value&&this.value<=8}isEmptyOrMountain(){return 0===this.value||9===this.value}isPiece(){return!this.isEmptyOrMountain()}getOwner(){return 1<=this.value&&this.value<=4?z.ZERO:5<=this.value&&this.value<=8?z.ONE:pe.NONE}getOptionalDirection(){switch(this.value){case 0:return P.empty();case 1:case 5:return P.of(Fe.UP);case 2:case 6:return P.of(Fe.RIGHT);case 3:case 7:return P.of(Fe.DOWN);case 4:case 8:return P.of(Fe.LEFT);default:return Me.expectToBe(this.value,9),P.empty()}}static of(t,e){return e===z.ZERO?t===Fe.UP?mt.LIGHT_UP:t===Fe.RIGHT?mt.LIGHT_RIGHT:t===Fe.DOWN?mt.LIGHT_DOWN:mt.LIGHT_LEFT:t===Fe.UP?mt.DARK_UP:t===Fe.RIGHT?mt.DARK_RIGHT:t===Fe.DOWN?mt.DARK_DOWN:mt.DARK_LEFT}getDirection(){return this.getOptionalDirection().get()}toString(){switch(this.value){case 0:return"EMPTY";case 1:return"LIGHT_UP";case 2:return"LIGHT_RIGHT";case 3:return"LIGHT_DOWN";case 4:return"LIGHT_LEFT";case 5:return"DARK_UP";case 6:return"DARK_RIGHT";case 7:return"DARK_DOWN";case 8:return"DARK_LEFT";default:return Me.expectToBe(this.value,9),"MOUNTAIN"}}}mt.EMPTY=new mt(0),mt.LIGHT_UP=new mt(1),mt.LIGHT_RIGHT=new mt(2),mt.LIGHT_DOWN=new mt(3),mt.LIGHT_LEFT=new mt(4),mt.DARK_UP=new mt(5),mt.DARK_RIGHT=new mt(6),mt.DARK_DOWN=new mt(7),mt.DARK_LEFT=new mt(8),mt.MOUNTAIN=new mt(9);class G3 extends es{static getInitialState(){const t=Ke.createTable(5,5,mt.EMPTY);return t[2][1]=mt.MOUNTAIN,t[2][2]=mt.MOUNTAIN,t[2][3]=mt.MOUNTAIN,new G3(t,0)}countCurrentPlayerPawn(){return this.countPlayersPawn()[this.getCurrentPlayer().value]}countPlayersPawn(){const t=[0,0];for(let e=0;e<5;e++)for(let r=0;r<5;r++)this.board[e][r]!==mt.EMPTY&&t[this.getPieceAtXY(r,e).getOwner().value]++;return t}}let z9=(()=>{class n{}return n.NO_REMAINING_PIECE_TO_INSERT=()=>$localize`You cannot insert a piece, all your pieces are already on the board.`,n.NOT_ENOUGH_FORCE_TO_PUSH=()=>$localize`You do not have enough strength to push.`,n.MUST_MOVE_OR_ROTATE=()=>$localize`You must move or rotate your piece.`,n.ILLEGAL_PUSH=()=>$localize`Your push is invalid: it is either not straight, is not pushing anything, or is leaving the board.`,n.MUST_SELECT_VALID_DESTINATION=()=>$localize`You must select a valid destination (highlighted on the board) for your piece`,n.MUST_SELECT_ORIENTATION=()=>$localize`You should select the orientation of your piece by clicking on one of the arrows.`,n})();class B3e{constructor(t,e){this.resultingBoard=t,this.moved=e}}class b1 extends U1{constructor(){super(G3)}static get(){return b1.singleton.isAbsent()&&(b1.singleton=P.of(new b1)),b1.singleton.get()}isLegal(t,e){if(X(b1.VERBOSE,{SiamRules_isLegal:{move:t,state:e}}),!t.isInsertion()&&!e.getPieceAt(t.coord).belongTo(e.getCurrentPlayer()))return U.failure(tt.MUST_CHOOSE_PLAYER_PIECE());if(t.isRotation())return X(b1.VERBOSE,"Move is rotation"),this.isLegalRotation(t,e);{let r;if(t.isInsertion()){X(b1.VERBOSE,"Move is insertion");const s=this.isLegalInsertion(t.coord,e);if(s.legal.isFailure())return U.failure(s.legal.getReason());r=s.insertedPiece}else X(b1.VERBOSE,"Move is forward"),r=e.getPieceAt(t.coord);return this.isLegalForwarding(t,e,r)}}isLegalInsertion(t,e){const r=e.countCurrentPlayerPawn(),s=e.getCurrentPlayer(),i=r<5?G.SUCCESS:G.failure(z9.NO_REMAINING_PIECE_TO_INSERT());return{insertedPiece:this.getInsertedPiece(t,s),legal:i}}getInsertedPiece(t,e){return mt.of(-1===t.x?Fe.RIGHT:-1===t.y?Fe.DOWN:5===t.x?Fe.LEFT:Fe.UP,e)}isLegalForwarding(t,e,r){X(b1.VERBOSE,{isLegalForwarding:{move:t.toString(),state:e,firstPiece:r}}),ve(r!==mt.MOUNTAIN&&r!==mt.EMPTY,"forwarding must be done with player piece");const s=[];let i=mt.of(t.landingOrientation,e.getCurrentPlayer());const o=t.direction.get();let c=t.coord.getNext(o);if(c.isInRange(5,5)&&e.getPieceAt(c)!==mt.EMPTY&&!1===this.isStraight(r,t))return X(b1.VERBOSE,"Illegal push because not straight or not pushing anything or leaving the board"),U.failure(z9.ILLEGAL_PUSH());let u=P.of(o);const h=o.getOpposite();let p=0;const m=e.getCopiedBoard();t.coord.isInRange(5,5)&&(m[t.coord.y][t.coord.x]=mt.EMPTY,s.push(t.coord));let C=c.isInRange(5,5)&&i!==mt.EMPTY;for(;C;){u.equalsValue(o)?p++:u.equalsValue(h)&&p--,X(b1.VERBOSE,{totalForce:p,movingPiece:i,landingCoord:c});const w=m[c.y][c.x];w===mt.MOUNTAIN&&(p-=.9),m[c.y][c.x]=i,s.push(c),i=w,c=c.getNext(o),u=i.getOptionalDirection(),C=c.isInRange(5,5)&&i!==mt.EMPTY&&p>0}return c.isNotInRange(5,5)&&(X(b1.VERBOSE,"This movement would push "+i+" outside the board"),u.equalsValue(o)?p++:u.equalsValue(h)&&p--),p<=0?(X(b1.VERBOSE,"This move is an illegal push: "+m),U.failure(z9.NOT_ENOUGH_FORCE_TO_PUSH())):(X(b1.VERBOSE,"This move is a legal push: "+m),U.success(new B3e(m,s)))}isStraight(t,e){const r=t.getDirection();return e.direction.equalsValue(r)&&r===e.landingOrientation}isLegalRotation(t,e){X(b1.VERBOSE,{isLegalRotation:{rotation:t,state:e}});const r=t.coord,s=e.getPieceAt(r),i=e.getCurrentPlayer();if(s.getDirection()===t.landingOrientation)return U.failure(z9.MUST_MOVE_OR_ROTATE());const o=e.getCopiedBoard();return o[r.y][r.x]=mt.of(t.landingOrientation,i),U.success(new B3e(o,[r]))}applyLegalMove(t,e,r){const s=Ke.copyBiArray(r.resultingBoard);return new G3(s,e.turn+1)}getBoardValueInfo(t,e){const r=this.getMountainsRowsAndColumns(e),s=r.rows,i=r.columns,o=this.getWinner(e,t,r.nbMountain);if(o.isPlayer())return o===z.ZERO?{shortestZero:0,shortestOne:Number.POSITIVE_INFINITY,boardValue:Number.MIN_SAFE_INTEGER}:{shortestZero:Number.POSITIVE_INFINITY,shortestOne:0,boardValue:Number.MAX_SAFE_INTEGER};{const c=this.getPushers(e,i,s);let u=Number.MAX_SAFE_INTEGER,h=Number.MAX_SAFE_INTEGER;const p=e.getCurrentPlayer();for(const C of c)C.coord.isInRange(5,5)?e.getPieceAt(C.coord).belongTo(z.ZERO)?u=Math.min(u,C.distance):h=Math.min(h,C.distance):p===z.ZERO?u=Math.min(u,C.distance):h=Math.min(h,C.distance);return{shortestZero:u,shortestOne:h,boardValue:this.getScoreFromShortestDistances(u,h,p)}}}getScoreFromShortestDistances(t,e,r){t===Number.MAX_SAFE_INTEGER&&(t=6),e===Number.MAX_SAFE_INTEGER&&(e=6);const s=6-t,i=6-e;return s===i?r.getScoreModifier():s>i?-10*(s+1)+(i+1):10*(i+1)-(s+1)}getMountainsRowsAndColumns(t){const e=[],r=[];let s=0;for(let i=0;i<5;i++)for(let o=0;o<5;o++)t.getPieceAtXY(o,i)===mt.MOUNTAIN&&(e.includes(i)||e.push(i),r.includes(o)||r.push(o),s++);return{rows:e,columns:r,nbMountain:s}}getWinner(t,e,r){return 2===r?this.getPusher(t,e.get()):pe.NONE}getPusher(t,e){const r=e.coord;let s;s=r.isInRange(5,5)?t.getPieceAt(r.getNext(e.landingOrientation)):this.getInsertedPiece(r,t.getCurrentOpponent());const i=s.getDirection(),o=this.getPusherCoord(t,i,r),c=t.getPieceAt(o).getOwner();return X(b1.VERBOSE,r.toString()+" belong to "+t.getCurrentOpponent().value+", "+o.toString()+" belong to "+c.value+", "+c.value+" win"),c}getPusherCoord(t,e,r){let s=r.getNext(e),i=r;for(;s.isInRange(5,5);){r=s,s=s.getNext(e);const o=t.getPieceAt(r);o!==mt.MOUNTAIN&&o.getDirection()===e&&(i=r)}return i}getPushers(t,e,r){X(b1.VERBOSE,{getPushers:{state:t,mountainsColumn:e,mountainsRow:r}});let s=[];const i=[];for(const o of e){let c=Fe.DOWN,u=new M(o,4);i.push({direction:c,fallingCoord:u}),c=Fe.UP,u=new M(o,0),i.push({direction:c,fallingCoord:u})}for(const o of r){let c=Fe.LEFT,u=new M(0,o);i.push({direction:c,fallingCoord:u}),c=Fe.RIGHT,u=new M(4,o),i.push({direction:c,fallingCoord:u})}for(const o of i)s=this.addPotentialDirectionPusher(t,o.fallingCoord,o.direction,s);return s}addPotentialDirectionPusher(t,e,r,s){const i=this.getLineClosestPusher(t,e,r);if(i.isAbsent())return s;const o=i.get(),c=o.distance;return X(b1.VERBOSE,"new closest challenger"),s.push({coord:o.coord,distance:c}),s}getLineClosestPusher(t,e,r){X(b1.VERBOSE,{getDirectionClosestPusher:{state:t,fallingCoord:e,direction:r.toString()}});const s=r.getOpposite();let i=1,o=t.getPieceAt(e),c=e,u=P.empty(),h=!1,p=!1,m=0;for(;c.isInRange(5,5)&&!1===h;){const C=t.getPieceAt(c);if(C.isEmptyOrMountain())C===mt.MOUNTAIN?(m+=.9,p=!0):i++;else{const w=C.getDirection();w===r?p&&(m-=1,m<=0&&(h=!0,c=c.getNext(r))):w===s?(m+=1,p||i++):p?(u=P.of(c),o!==mt.EMPTY&&i++):i++}o=C,c=c.getPrevious(r)}if(!1===h&&u.isPresent())for(i++,m-=1;!1===c.equals(u.get());)c=c.getNext(r),i--;return c.isNotInRange(5,5)&&(m-=1,5===t.countCurrentPlayerPawn())||m>0?P.empty():P.of({distance:i,coord:c})}getInsertions(t){let e=[];for(let r=1;r<4;r++)e=e.concat(this.getInsertionsAt(t,0,r)),e=e.concat(this.getInsertionsAt(t,4,r)),e=e.concat(this.getInsertionsAt(t,r,0)),e=e.concat(this.getInsertionsAt(t,r,4));return e=e.concat(this.getInsertionsAt(t,0,0)),e=e.concat(this.getInsertionsAt(t,0,4)),e=e.concat(this.getInsertionsAt(t,4,0)),e=e.concat(this.getInsertionsAt(t,4,4)),e}getInsertionsAt(t,e,r){const s=[];for(const i of Fe.ORTHOGONALS){const o=new M(e,r).getPrevious(i);if(o.isNotInRange(5,5))for(const c of Fe.ORTHOGONALS){const u=_a.of(o.x,o.y,P.of(i),c);ve(u.isSuccess(),"SiamRules.getInsertionsAt should only construct valid insertions"),this.isLegal(u.get(),t).isSuccess()&&s.push(u.get())}}return s}getMovesFrom(t,e,r,s){const i=new M(r,s);let o=this.getRotationMovesAt(i,e);for(const c of Fe.ORTHOGONALS){const u=i.getNext(c);o=o.concat(this.getForwardMovesBetween(t,i,u))}return o}getMovesBetween(t,e,r,s){return r.equals(s)?this.getRotationMovesAt(r,e):Fe.factory.fromMove(r,s).isSuccess()&&1===r.getDistance(s)?this.getForwardMovesBetween(t,r,s):[]}getRotationMovesAt(t,e){const r=[],s=e.getDirection();for(const i of Fe.ORTHOGONALS)if(i!==s){const o=_a.of(t.x,t.y,P.empty(),i).get();r.push(o)}return r}getForwardMovesBetween(t,e,r){const s=[];let i;const o=Fe.factory.fromMove(e,r).get(),c=t.getPieceAt(e);i=r.isInRange(5,5)?Fe.ORTHOGONALS:[o];for(const u of i){const h=_a.of(e.x,e.y,P.of(o),u).get();this.isLegalForwarding(h,t,c).isSuccess()&&s.push(h)}return s}getGameStatus(t){const e=this.getMountainsRowsAndColumns(t.gameState),r=this.getWinner(t.gameState,t.move,e.nbMountain);return r.isPlayer()?xe.getVictory(r):xe.ONGOING}}b1.singleton=P.empty(),b1.VERBOSE=!1;class Wut extends G1{getBoardValue(t){return new Ct(b1.get().getBoardValueInfo(t.move,t.gameState).boardValue)}getListMoves(t){let e=[];const r=t.gameState.getCurrentPlayer();for(let s=0;s<5;s++)for(let i=0;i<5;i++){const o=t.gameState.getPieceAtXY(i,s);o.belongTo(r)&&(e=e.concat(b1.get().getMovesFrom(t.gameState,o,i,s)))}if(t.gameState.countCurrentPlayerPawn()<5)for(const s of b1.get().getInsertions(t.gameState))if(s.direction.get().getOpposite()!==s.landingOrientation){if(this.isOnBorder(s)&&s.direction.get()!==s.landingOrientation)continue;e.push(s)}return X(b1.VERBOSE,{getListMovesResult:e}),e}isOnBorder(t){return 0===t.coord.x||4===t.coord.x||0===t.coord.y||4===t.coord.y}}const je=mt.EMPTY,nc=mt.MOUNTAIN,UH=mt.LIGHT_UP,GH=mt.LIGHT_LEFT,V9=mt.LIGHT_RIGHT,qut=mt.LIGHT_DOWN,jut=mt.DARK_UP,$3e=mt.DARK_LEFT,U3e=mt.DARK_RIGHT,Zut=mt.DARK_DOWN;class G3e extends K1{constructor(){super(...arguments),this.tutorial=[ce.informational($localize`Goal of the game`,$localize`The goal at Siam is to be the first to push a mountain out of the board.
        The initial board contains three mountains, and no pieces are initially on the board.
        During its turn, a player can do one of the following actions:
        <ol>
            <li>Put a new piece on the board.</li>
            <li>Change the orientation of one of its piece</li>
            <li>Move one of its piece and optionally reorient it.</li>
            <li>Take one of its pieces out of the board.</li>
        </ol>`,G3.getInitialState()),ce.anyMove($localize`Inserting a piece`,$localize`Each player has 5 pieces in total.
        As long as you have remaining pieces next to the board, you can insert new pieces. To do so:
        <ol>
            <li>Click on one of your pieces from your reserve, next to board.</li>
            <li>Click on one of the highlighted squares to select a landing for your piece.</li>
            <li>Select an orientation for your piece by clicking on one of the arrows that appear on top of the board.</li>
        </ol><br/>
        You're playing Dark, insert a piece on the board.`,G3.getInitialState(),_a.of(2,-1,P.of(Fe.DOWN),Fe.DOWN).get(),$localize`Congratulations!`),ce.fromMove($localize`Moving a piece`,$localize`We will distinguish here "moving" and "pushing".
        A move is made from a piece's square to an empty neighboring square, horizontally or vertically.
        You can also move a piece out of the board.
        To move a piece:
        <ol>
            <li>Click on it.</li>
            <li>Click on the square on which you want the piece to move.
                You can also click a second time on your piece to change its orientation without moving it.</li>
            <li>Select the orientation of your piece by clicking one one of the arrows that appear on top of the board.</li>
        </ol><br/>
        You're playing Dark. Try to move your piece that is already on the board one square upwards and to orient it to the left.`,new G3([[je,je,je,je,je],[je,je,je,je,je],[je,nc,nc,nc,je],[je,je,je,je,je],[je,je,UH,je,je]],0),[_a.of(2,4,P.of(Fe.UP),Fe.LEFT).get()],$localize`Congratulations, you made a side-slip!`,$localize`Failed. Try again.`),ce.fromMove($localize`Moving a piece out of the board`,$localize`To move a piece out of the board, you do not have to pick an orientation after the move.<br/><br/>
        You're playing Dark, get that piece out of the board!`,new G3([[je,je,je,je,je],[je,je,je,je,je],[je,nc,nc,nc,je],[je,je,je,je,je],[je,je,UH,je,je]],0),[_a.of(2,4,P.of(Fe.DOWN),Fe.DOWN).get()],$localize`Congratulations, even if in this context it was not a useful move.`,$localize`Failed, the piece is still on the board.`),ce.fromMove($localize`Pushing (1/2)`,$localize`When the landing square of your move is occupied, we use the term "push".
        In order to push player pieces, the following conditions must hold:
        <ol>
            <li>Your piece must already be oriented in the direction of the push.</li>
            <li>Along the line that you are pushing, the number of pieces (yours or your opponent's) that are oriented in the same way as the push should be strictly greater than the number of pieces oriented in the opposite way.</li>
        </ol>
        Look closely at the board. On the first row, you cannot push as there is exactly one piece in the opposite direction.
        On the second row, you can push because there are two pieces against one.<br/><br/>
        You're playing Dark. Vertically, you can push using your piece in the center, as there is no resistance on that axis. Do it.`,new G3([[je,V9,$3e,je,je],[V9,U3e,GH,je,je],[je,je,UH,je,je],[je,je,je,je,je],[je,je,je,je,je]],0),[_a.of(2,2,P.of(Fe.UP),Fe.UP).get()],$localize`Congratulations!`,$localize`Failed. Try again.`),ce.fromMove($localize`Pushing (2/2)`,$localize`To be able to push a mountain, you need at least one pusher per mountain. Each resistant (pieces in the opposite way) cancel the force of one pusher.
        In short, if there is no mountain, you need strictly more pushers than resistants. If there is a mountain, you need at least as much pushers than there are resistants and mountains.
        On the following board, as Dark, you can push the mountain on the first row.
        On the second and third row, because of the resisting forces, you cannot push.
        On the fourth row, you can push as there is one more pusher than resistant pieces.<br/><br/>
        You're playing Dark, push on the fourth row it.`,new G3([[je,je,V9,nc,je],[je,je,V9,nc,GH],[je,V9,nc,nc,je],[je,V9,U3e,$3e,nc],[je,je,je,je,je]],0),[_a.of(1,3,P.of(Fe.RIGHT),Fe.RIGHT).get()],$localize`Congratulations! Note that this move made you lose the game, you will see why in the next step.`,$localize`Failed. Try again.`),ce.fromMove($localize`Victory`,$localize`The game ends when a mountain is pushed out of the board.
        If you pushed it and nobody is in front of you, you're the winner.
        However, if you were pushing an opponent oriented in the same direction as you, your opponent will win because that piece is closer to the mountain.
        However, if that opponent is closer to the mountain but not oriented towards it, victory will be yours.<br/><br/>
        Here, playing Dark, you can push a mountain off the board and either win, or lose. Choose correctly!`,new G3([[je,je,je,je,je],[je,je,je,je,je],[nc,jut,GH,je,qut],[je,je,je,je,Zut],[je,je,je,je,nc]],0),[_a.of(2,2,P.of(Fe.LEFT),Fe.LEFT).get()],$localize`Congratulations, you won!`,$localize`Failed, you lost.`)]}}function Yut(n,t){if(1&n){const e=Oe();F(),b(0,"use",11),ee("click",function(){he(e);const s=v().index,i=v().index;return le(v().clickSquare(s,i))}),O()}if(2&n){const e=v(),r=e.index,s=e.$implicit,i=v().index,o=v();We("id","piece_",r,"_",i,""),T("ngClass",o.getPieceClasses(r,i,s)),D("transform",o.getPieceTransform(r,i))}}function Kut(n,t){if(1&n){const e=Oe();F(),b(0,"use",12),ee("click",function(){he(e);const s=v().index,i=v().index;return le(v().clickSquare(s,i))}),O()}if(2&n){const e=v().index,r=v().index,s=v();D("transform","translate("+(e+1)*s.SPACE_SIZE+" "+(r+1)*s.SPACE_SIZE+")")}}function Xut(n,t){if(1&n){const e=Oe();F(),b(0,"g")(1,"rect",8),ee("click",function(){const i=he(e).index,o=v().index;return le(v().clickSquare(i,o))}),O(),x(2,Yut,1,4,"use",9),x(3,Kut,1,1,"use",10),O()}if(2&n){const e=t.$implicit,r=t.index,s=v().index,i=v();S(1),We("id","square_",r,"_",s,""),T("ngClass",i.getSquareClasses(r,s)),D("x",i.SPACE_SIZE*(r+1))("y",i.SPACE_SIZE*(s+1))("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),S(1),T("ngIf",e.isPiece()),S(1),T("ngIf",i.isMountain(e))}}function Qut(n,t){if(1&n&&(F(),b(0,"g"),x(1,Xut,4,9,"g",4),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e)}}function Jut(n,t){if(1&n){const e=Oe();F(),b(0,"rect",15),ee("click",function(){he(e);const s=v().$implicit;return le(v().clickSquare(s.x,s.y))}),O()}if(2&n){const e=v().$implicit,r=v();We("id","square_",e.x,"_",e.y,""),T("ngClass",r.getSquareClasses(e.x,e.y)),D("x",r.SPACE_SIZE*(e.x+1))("y",r.SPACE_SIZE*(e.y+1))("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)}}function e5t(n,t){if(1&n){const e=Oe();F(),b(0,"g"),x(1,Jut,1,7,"rect",13),b(2,"rect",14),ee("click",function(){const i=he(e).$implicit;return le(v().clickSquare(i.x,i.y))}),O()()}if(2&n){const e=t.$implicit,r=v();S(1),T("ngIf",!1===e.isInRange(5,5)),S(1),D("x",r.SPACE_SIZE*(e.x+1))("y",r.SPACE_SIZE*(e.y+1))("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)}}function t5t(n,t){if(1&n){const e=Oe();F(),b(0,"rect",16),ee("click",function(){he(e);const s=v();return le(s.clickSquare(s.selectedLanding.get().x,s.selectedLanding.get().y))}),O()}if(2&n){const e=v();D("x",e.SPACE_SIZE*(e.selectedLanding.get().x+1))("y",e.SPACE_SIZE*(e.selectedLanding.get().y+1))("width",e.SPACE_SIZE)("height",e.SPACE_SIZE)}}function n5t(n,t){if(1&n){const e=Oe();F(),b(0,"rect",16),ee("click",function(){he(e);const s=v();return le(s.clickSquare(s.selectedPiece.get().x,s.selectedPiece.get().y))}),O()}if(2&n){const e=v();D("x",e.SPACE_SIZE*(e.selectedPiece.get().x+1))("y",e.SPACE_SIZE*(e.selectedPiece.get().y+1))("width",e.SPACE_SIZE)("height",e.SPACE_SIZE)}}function r5t(n,t){if(1&n&&(F(),Q(0,"use",19)),2&n){const e=t.$implicit,r=v().$implicit,s=v();We("id","remainingPieces_",r.value,"_",e,""),T("ngClass",s.getRemainingPieceClasses(r,e)),D("transform",s.getRemainingPieceTransform(e,r))}}function s5t(n,t){if(1&n){const e=Oe();F(),b(0,"g",17),ee("click",function(){const i=he(e).$implicit;return le(v().selectPieceForInsertion(i))}),x(1,r5t,1,4,"use",18),O()}if(2&n){const e=t.$implicit,r=v();y1("id","remainingPieces_",e.value,""),S(1),T("ngForOf",r.ArrayUtils.range(r.playerPieces(e)))}}function i5t(n,t){if(1&n){const e=Oe();F(),b(0,"use",22),ee("click",function(){he(e);const s=v().$implicit;return le(v().clickSquare(s.source.get().coord.x,s.source.get().coord.y))}),O()}if(2&n){const e=v().$implicit,r=v();T("ngClass",r.getPieceClasses(e.source.get().coord.x,e.source.get().coord.y,e.source.get().piece)),D("transform",r.getPieceTransform(e.source.get().coord.x,e.source.get().coord.y))}}function o5t(n,t){if(1&n){const e=Oe();F(),b(0,"g")(1,"use",20),ee("click",function(){const i=he(e).$implicit;return le(v().clickArrow(i))}),O(),x(2,i5t,1,2,"use",21),O()}if(2&n){const e=t.$implicit,r=v();S(1),j2("id","indicator_",e.target.x,"_",e.target.y,"_",e.direction.toString(),""),D("transform",r.getIndicatorTransform(e)),S(1),T("ngIf",e.source.isPresent())}}function a5t(n,t){if(1&n){const e=Oe();F(),b(0,"use",23),ee("click",function(){const i=he(e).$implicit;return le(v().selectOrientation(i))}),O()}if(2&n){const e=t.$implicit,r=v();y1("id","orientation_",e.landingOrientation,""),T("ngClass",r.getCurrentPlayerClass()),D("transform",r.getOrientationTransform(e.landingOrientation))}}let c5t=(()=>{class n extends to{constructor(e){super(e),this.lastMove=P.empty(),this.movedPieces=[],this.selectedPiece=P.empty(),this.selectedLanding=P.empty(),this.orientations=[],this.clickableCoords=new Dt,this.indicatorArrows=[],this.insertingPiece=!1,this.rules=b1.get(),this.availableMinimaxes=[new Wut(this.rules,"SiamMinimax")],this.encoder=_a.encoder,this.tutorial=(new G3e).tutorial,this.updateBoard()}updateBoard(){X(n.VERBOSE,"updateBoard");const e=this.getState();if(this.board=e.board,this.lastMove=this.rules.node.move,this.lastMove.isPresent()){const r=this.rules.node.mother.get().gameState;this.movedPieces=this.rules.isLegal(this.lastMove.get(),r).get().moved}else this.movedPieces=[]}cancelMoveAttempt(){this.insertingPiece=!1,this.selectedPiece=P.empty(),this.selectedLanding=P.empty(),this.orientations=[],this.clickableCoords=new Dt,this.indicatorArrows=[]}selectPieceForInsertion(e){var r=this;return A(function*(){const s=r.canUserPlay("#remainingPieces_"+e.value);if(s.isFailure())return r.cancelMove(s.getReason());if(e!==r.getCurrentPlayer())return r.cancelMove(tt.MUST_CHOOSE_PLAYER_PIECE());if(r.insertingPiece)return r.cancelMoveAttempt(),G.SUCCESS;r.cancelMoveAttempt();for(const i of b1.get().getInsertions(r.getState())){const o=i.coord.getNext(i.direction.get());if(r.board[o.y][o.x]!==mt.EMPTY){const c={source:P.empty(),target:o,direction:i.direction.get(),move:i};r.indicatorArrows.push(c)}r.clickableCoords.add(o)}return r.insertingPiece=!0,G.SUCCESS})()}selectOrientation(e){var r=this;return A(function*(){const s=r.canUserPlay("#orientation_"+e.landingOrientation.toString());return s.isFailure()?r.cancelMove(s.getReason()):r.chooseMove(e,r.getState())})()}clickSquare(e,r,s=!1){var i=this;return A(function*(){if(X(n.VERBOSE,"SiamComponent.clickSquare("+e+", "+r+")"),!1===s){const c=i.canUserPlay("#square_"+e+"_"+r);if(c.isFailure())return i.cancelMove(c.getReason())}const o=new M(e,r);if(i.insertingPiece)return i.insertPiece(o);if(i.selectedLanding.isPresent())return i.cancelMoveAttempt(),G.SUCCESS;if(i.selectedPiece.isPresent()){i.selectedLanding=P.of(o);const c=b1.get().getMovesBetween(i.getState(),i.getState().getPieceAt(i.selectedPiece.get()),i.selectedPiece.get(),o);return 0===c.length?i.changeMoveDestinationClick(o):i.performMoveOrShowOrientationArrows(c)}{ve(i.getState().isOnBoard(o),"SiamComponent: user clicked outside of board when it should not be possible");const c=i.board[r][e];return c.getOwner()!==i.getCurrentPlayer()?i.cancelMove(tt.MUST_CHOOSE_PLAYER_PIECE()):i.selectPiece(o,c)}})()}insertPiece(e){var r=this;return A(function*(){if(r.selectedLanding.isPresent())return r.cancelMove(z9.MUST_SELECT_ORIENTATION()),G.SUCCESS;r.selectedLanding=P.of(e);const s=b1.get().getInsertionsAt(r.getState(),e.x,e.y);return 0===s.length?r.changeMoveDestinationClick(e):r.performMoveOrShowOrientationArrows(s)})()}changeMoveDestinationClick(e){var r=this;return A(function*(){return r.cancelMoveAttempt(),r.getState().getPieceAt(e).getOwner()===r.getCurrentPlayer()?r.clickSquare(e.x,e.y,!0):r.cancelMove(z9.MUST_SELECT_VALID_DESTINATION())})()}performMoveOrShowOrientationArrows(e){var r=this;return A(function*(){return ve(e.length>0,"SiamComponent.performMoveOrShowOrientationArrows expects at least one move"),1===e.length?(r.cancelMove(),r.chooseMove(e[0],r.getState())):(r.clickableCoords=new Dt,r.indicatorArrows=[],r.orientations=e,G.SUCCESS)})()}selectPiece(e,r){this.cancelMoveAttempt();const s=this.getState();this.selectedPiece=P.of(e);const i=b1.get().getMovesFrom(s,r,e.x,e.y);for(const o of i)if(o.direction.isPresent()){const c=o.coord.getNext(o.direction.get());if(this.clickableCoords.add(c),s.isOnBoard(c)&&s.getPieceAt(c)!==mt.EMPTY){const u={source:P.of({coord:e,piece:r}),target:c,direction:o.direction.get(),move:o};this.indicatorArrows.push(u)}}else this.clickableCoords.add(o.coord);return G.SUCCESS}clickArrow(e){var r=this;return A(function*(){const s=r.canUserPlay("#indicator_"+e.target.x+"_"+e.target.y+"_"+e.move.landingOrientation);return s.isFailure()?r.cancelMove(s.getReason()):r.chooseMove(e.move,r.getState())})()}isMountain(e){return e===mt.MOUNTAIN}getArrowTransform(e,r,s){const o=`rotate(${90*(s.toInt()-2)} ${this.SPACE_SIZE/2} ${this.SPACE_SIZE/2})`;return["translate("+e*this.SPACE_SIZE+", "+r*this.SPACE_SIZE+")",o].join(" ")}getPieceTransform(e,r){return this.getArrowTransform(e+1,r+1,this.board[r][e].getDirection())}getIndicatorTransform(e){const r=e.target.getPrevious(e.direction,.5);return this.getArrowTransform(r.x+1,r.y+1,e.direction)}getRemainingPieceTransform(e,r){const s=this.playerPieces(r);let u,h,c=2;return r===z.ONE?(c+=(s-e+(5-s)/2)/3,u=-1,h=Fe.RIGHT):(c+=(e+1+(5-s)/2)/3,u=7,h=Fe.LEFT),this.getArrowTransform(c,u,h)}getOrientationTransform(e){const r=`translate(0, ${this.SPACE_SIZE/1.6})`,i=`rotate(${90*(e.toInt()-2)} ${this.SPACE_SIZE/2} ${this.SPACE_SIZE/2})`;return[`translate(${2.27*this.SPACE_SIZE}, ${2.27*this.SPACE_SIZE})`,"scale(2.43)",i,r].join(" ")}getPieceClasses(e,r,s){const i=new M(e,r),o=[this.getPlayerClass(s.getOwner())];return this.selectedPiece.equalsValue(i)&&o.push("selected-stroke"),o}getSquareClasses(e,r){const s=new M(e,r);return this.movedPieces.some(i=>i.equals(s))?["moved-fill"]:[]}getRemainingPieceClasses(e,r){const s=[this.getPlayerClass(e)];return this.insertingPiece&&this.getCurrentPlayer()===e&&r===this.playerPieces(e)-1&&s.push("selected-stroke"),s}getCurrentPlayerClass(){return this.getPlayerClass(this.getCurrentPlayer())}playerPieces(e){return 5-this.getState().countPlayersPawn()[e.value]}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(J(Pn))},n.\u0275cmp=gt({type:n,selectors:[["app-siam"]],features:[l],decls:12,vars:7,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","0 -100 700 900","preserveAspectRatio","xMidYMid meet"],["id","triangle","points","0 -6, 10 0, 0 6"],["id","arrow","points","30 7, 30 50, 10 50, 50 90, 90 50, 70 50, 70 7"],["id","mountain","points","5 95, 16 68, 24 76, 48 28, 64 60, 72 44, 95 95, 5 95"],[4,"ngFor","ngForOf"],["class","base no-fill small-stroke selected-stroke",3,"click",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],["class","base mid-stroke semi-transparent",0,"xlink","href","#arrow",3,"id","ngClass","click",4,"ngFor","ngForOf"],[1,"base",3,"id","ngClass","click"],["class","base mid-stroke",0,"xlink","href","#arrow",3,"id","ngClass","click",4,"ngIf"],[0,"xlink","href","#mountain","class","nonplayer-fill",3,"click",4,"ngIf"],[0,"xlink","href","#arrow",1,"base","mid-stroke",3,"id","ngClass","click"],[0,"xlink","href","#mountain",1,"nonplayer-fill",3,"click"],["class","base semi-transparent",3,"id","ngClass","click",4,"ngIf"],[1,"base","no-fill","small-stroke","clickable-stroke",3,"click"],[1,"base","semi-transparent",3,"id","ngClass","click"],[1,"base","no-fill","small-stroke","selected-stroke",3,"click"],[3,"id","click"],["class","base mid-stroke",0,"xlink","href","#arrow",3,"id","ngClass",4,"ngFor","ngForOf"],[0,"xlink","href","#arrow",1,"base","mid-stroke",3,"id","ngClass"],[0,"xlink","href","#arrow",1,"base","mid-stroke","indicator-fill",3,"id","click"],["class","base mid-stroke",0,"xlink","href","#arrow",3,"ngClass","click",4,"ngIf"],[0,"xlink","href","#arrow",1,"base","mid-stroke",3,"ngClass","click"],[0,"xlink","href","#arrow",1,"base","mid-stroke","semi-transparent",3,"id","ngClass","click"]],template:function(e,r){1&e&&(F(),b(0,"svg",0)(1,"defs"),Q(2,"polygon",1)(3,"polygon",2)(4,"polygon",3),O(),x(5,Qut,2,1,"g",4),x(6,e5t,3,5,"g",4),x(7,t5t,1,4,"rect",5),x(8,n5t,1,4,"rect",5),x(9,s5t,2,2,"g",6),x(10,o5t,3,5,"g",4),x(11,a5t,1,3,"use",7),O()),2&e&&(S(5),T("ngForOf",r.board),S(1),T("ngForOf",r.clickableCoords),S(1),T("ngIf",r.selectedLanding.isPresent()),S(1),T("ngIf",r.selectedPiece.isPresent()),S(1),T("ngForOf",r.Player.PLAYERS),S(1),T("ngForOf",r.indicatorArrows),S(1),T("ngForOf",r.orientations))},dependencies:[dn,An,en],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})(),W3=(()=>{class n{}return n.NO_MOVEMENT_BEFORE_TURN_40=()=>$localize`You cannot move yet. Pick a space where you will put a new piece.`,n.MUST_CUT=()=>$localize`Several groups are of the same size, you must pick the one to keep.`,n.CANNOT_CHOOSE_TO_KEEP=()=>$localize`You cannot choose which part to keep when one is smaller than the other.`,n.CAN_NO_LONGER_DROP=()=>$localize`You cannot put new pieces anymore. Pick a piece to move.`,n.MUST_CAPTURE_BIGGEST_GROUPS=()=>$localize`You must choose one of the biggest groups to keep it.`,n.CANNOT_KEEP_EMPTY_COORD=()=>$localize`You cannot pick an empty space. Pick one of the biggest groups.`,n.MUST_DROP_NEXT_TO_OTHER_PIECE=()=>$localize`You must put this piece next to another piece.`,n})();class Zi extends f3e{static getInitialState(){return Zi.fromRepresentation([[z.ZERO.value],[z.ONE.value]],0)}static fromRepresentation(t,e,r){const s=new h9;for(let i=0;i<t.length;i++)for(let o=0;o<t[0].length;o++)t[i][o]!==pe.NONE.value&&s.set(new M(o,i),z.of(t[i][o]));return new Zi(s,e,r)}movePiece(t){const e=this.pieces.getCopy();return e.delete(t.start.get()),e.set(t.landing,this.getCurrentPlayer()),new Zi(e,this.turn)}toRepresentation(){const t=Ke.createTable(this.width,this.height,pe.NONE.value);for(const e of this.pieces.listKeys()){const r=this.getPieceAt(e).value;t[e.y][e.x]=r}return t}isIllegalLandingZone(t,e){return this.pieces.containsKey(t)?G.failure(tt.MUST_LAND_ON_EMPTY_SPACE()):this.isCoordConnected(t,e)?G.SUCCESS:G.failure(W3.MUST_DROP_NEXT_TO_OTHER_PIECE())}isCoordConnected(t,e){for(const r of Le.factory.all){const s=t.getNext(r,1);if(this.pieces.containsKey(s)&&!1===e.equalsValue(s))return!0}return!1}getPieceAt(t){return this.isOnBoard(t)?this.pieces.get(t).get():pe.NONE}applyLegalDrop(t){const e=this.pieces.getCopy();return e.put(t,this.getCurrentPlayer()),new Zi(e,this.turn+1)}applyLegalDeplacement(t,e){const r=this.movePiece(t);if(e.size()>0){const s=new h9;for(const i of e)s.set(i,r.getPieceAt(i));return new Zi(s,this.turn+1)}return new Zi(r.pieces,this.turn+1,r.offset)}countPieces(){const t=this.pieces.reverse(),e=t.get(z.ZERO).getOrElse(new Ar),r=t.get(z.ONE).getOrElse(new Ar);return[e.size(),r.size()]}switchPiece(t){const e=this.pieces.getCopy(),r=this.getPieceAt(t);if(r.isPlayer())return e.replace(t,r.getOpponent()),new Zi(e,this.turn,this.offset);Os.logErrorAndFail("SixState","Cannot switch piece if there is no piece!",{coord:t.toString()})}equals(t){return this.turn===t.turn&&this.pieces.equals(t.pieces)}}class Wr extends Gi{constructor(t,e,r){if(super(),this.start=t,this.landing=e,this.keep=r,t.equalsValue(e))throw new Error("Deplacement cannot be static!");if(t.isPresent()&&t.equals(r))throw new Error("Cannot keep starting coord, since it will always be empty after move!")}static fromDrop(t){return new Wr(P.empty(),t,P.empty())}static fromMovement(t,e){return new Wr(P.of(t),e,P.empty())}static fromCut(t,e,r){return new Wr(P.of(t),e,P.of(r))}isDrop(){return this.start.isAbsent()}isCut(){return this.keep.isPresent()}toString(){return this.isDrop()?"SixMove("+this.landing.toString()+")":this.isCut()?"SixMove("+this.start.get().toString()+" > "+this.landing+", keep: "+this.keep.get().toString()+")":"SixMove("+this.start.get().toString()+" > "+this.landing+")"}equals(t){return!1!==this.landing.equals(t.landing)&&!1!==this.start.equals(t.start)&&this.keep.equals(t.keep)}}Wr.encoder=new class extends mi{encodeMove(n){return{start:n.start.isPresent()?M.encoder.encode(n.start.get()):null,landing:M.encoder.encode(n.landing),keep:n.keep.isPresent()?M.encoder.encode(n.keep.get()):null}}decodeMove(n){const t=n;if("object"!=typeof n)throw new Error("Invalid encodedMove of type "+typeof n+"!");const e=M.encoder.decode(t.landing);if(null==t.start)return Wr.fromDrop(e);const r=M.encoder.decode(t.start);if(null==t.keep)return Wr.fromMovement(r,e);{const s=M.encoder.decode(t.keep);return Wr.fromCut(r,e,s)}}};class q3 extends U1{constructor(){super(...arguments),this.VERBOSE=!1}applyLegalMove(t,e,r){return e.turn<40?e.applyLegalDrop(t.landing):e.applyLegalDeplacement(t,r)}isLegal(t,e){X(this.VERBOSE,{called:"SixRules.isLegal",move:t,state:e});const r=e.isIllegalLandingZone(t.landing,t.start);return r.isFailure()?r.toFailedFallible():e.turn<40?this.isLegalDrop(t,e):q3.isLegalPhaseTwoMove(t,e)}static getLegalLandings(t){const e=new Ar;for(const r of t.getPieceCoords())for(const s of Le.factory.all){const i=r.getNext(s,1);t.getPieceAt(i)===pe.NONE&&e.add(i)}return e.toList()}isLegalDrop(t,e){return!1===t.isDrop()?U.failure(W3.NO_MOVEMENT_BEFORE_TURN_40()):U.success(new Dt(e.getPieceCoords()))}static isLegalPhaseTwoMove(t,e){if(t.isDrop())return U.failure(W3.CAN_NO_LONGER_DROP());switch(e.getPieceAt(t.start.get())){case pe.NONE:return U.failure(tt.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());case e.getCurrentOpponent():return U.failure(tt.CANNOT_CHOOSE_OPPONENT_PIECE())}const r=e.movePiece(t),s=r.getGroups();if(q3.isSplit(s)){const i=this.getBiggerGroups(s);if(1===i.size())return t.keep.isPresent()?U.failure(W3.CANNOT_CHOOSE_TO_KEEP()):U.success(i.getAnyElement().get());{const o=t.keep.map(c=>c.getNext(r.offset));return this.moveKeepBiggerGroup(o,i,r)}}return U.success(new Ar)}static isSplit(t){return t.size()>1}static getBiggerGroups(t){let e=0,r=new Dt;for(const s of t){const i=s.size();i>e?(e=i,r=new Dt([s])):i===e&&r.add(s)}return r}static moveKeepBiggerGroup(t,e,r){if(t.isAbsent())return U.failure(W3.MUST_CUT());if(r.getPieces().get(t.get()).isAbsent())return U.failure(W3.CANNOT_KEEP_EMPTY_COORD());const s=t.get();for(const i of e)if(i.contains(s))return U.success(i);return U.failure(W3.MUST_CAPTURE_BIGGEST_GROUPS())}getGameStatus(t){const e=t.gameState,r=e.getCurrentOpponent();let s=[];if(t.move.isPresent()&&(s=this.getShapeVictory(t.move.get(),e)),6===s.length)return xe.getVictory(r);if(e.turn>39){const i=e.countPieces(),o=i[0],c=i[1];return o<6&&c<6?o<c?xe.ONE_WON:c<o?xe.ZERO_WON:xe.DRAW:o<6?xe.getDefeat(z.ZERO):c<6?xe.getDefeat(z.ONE):xe.ONGOING}return xe.ONGOING}startSearchingVictorySources(){X(this.VERBOSE,"SixRules.startSearchingVictorySources()"),this.currentVictorySource={typeSource:"LINE",index:-1}}getShapeVictory(t,e){for(this.startSearchingVictorySources();this.hasNextVictorySource();){this.getNextVictorySource();const r=this.searchVictoryOnly(this.currentVictorySource,t,e);if(6===r.length)return r}return[]}hasNextVictorySource(){return"CIRCLE"!==this.currentVictorySource.typeSource||5!==this.currentVictorySource.index}getNextVictorySource(){if(5===this.currentVictorySource.index){let e;switch(this.currentVictorySource.typeSource){case"LINE":e="TRIANGLE_CORNER";break;case"TRIANGLE_CORNER":e="TRIANGLE_EDGE";break;default:e="CIRCLE"}this.currentVictorySource={typeSource:e,index:0}}else{let e=1;"LINE"===this.currentVictorySource.typeSource&&(e=2),this.currentVictorySource={typeSource:this.currentVictorySource.typeSource,index:this.currentVictorySource.index+e}}return this.currentVictorySource}searchVictoryOnly(t,e,r){const s=e.landing.getNext(r.offset,1);switch(X(this.VERBOSE,{called:"SixRules.searchVictoryOnly",victorySource:t,move:e,state:r}),t.typeSource){case"LINE":return this.searchVictoryOnlyForLine(t.index,s,r);case"CIRCLE":return this.searchVictoryOnlyForCircle(t.index,s,r);case"TRIANGLE_CORNER":return this.searchVictoryOnlyForTriangleCorner(t.index,s,r);default:return this.searchVictoryOnlyForTriangleEdge(t.index,s,r)}}searchVictoryOnlyForCircle(t,e,r){X(this.VERBOSE,{called:"SixRules.searchVictoryOnlyForCircle",index:t,lastDrop:e,state:r});const s=r.getCurrentOpponent(),o=[e];let c=e.getNext(Le.factory.all[t],1);for(;o.length<6;){if(r.getPieceAt(c)!==s)return[];const h=(t+o.length)%6;o.push(c),c=c.getNext(Le.factory.all[h],1)}return o}searchVictoryOnlyForLine(t,e,r){const s=r.getCurrentOpponent();let i=Le.factory.all[t],o=e.getNext(i,1);const c=[e];let u=!1;for(;c.length<6;){if(r.getPieceAt(o)===s)c.push(o);else{if(u)return[];u=!0,i=i.getOpposite(),o=o.getNext(i,c.length)}o=o.getNext(i,1)}return c}searchVictoryOnlyForTriangleCorner(t,e,r){X(this.VERBOSE,{called:"SixRules.searchVictoryTriangleCornerOnly",index:t,lastDrop:e,state:r});const s=r.getCurrentOpponent();let i=Le.factory.all[t];const o=[e];let c=e.getNext(i,1);for(;o.length<6;){if(r.getPieceAt(c)!==s)return[];o.length%2==0&&(i=Le.factory.all[(t+o.length)%6]),o.push(c),c=c.getNext(i,1)}return o}searchVictoryOnlyForTriangleEdge(t,e,r){X(this.VERBOSE,{called:"SixRules.searchVictoryTriangleEdgeOnly",index:t,lastDrop:e,state:r});const s=r.getCurrentOpponent();let i=Le.factory.all[t];const o=[e];let c=e.getNext(i,1);for(;o.length<6;){if(r.getPieceAt(c)!==s)return[];o.push(c),o.length%2==0&&(i=Le.factory.all[(t+o.length)%6]),c=c.getNext(i,1)}return o}}class l5t extends G1{calculateBoardValue(t,e){this.startSearchingVictorySources();let r={status:yn.DEFAULT,victory:P.empty(),preVictory:P.empty(),sum:0};for(;this.hasNextVictorySource();){const s=this.getNextVictorySource();let i;if(i=r.status===yn.PRE_VICTORY?this.searchVictoryOnly(s,t,e):this.getBoardInfo(s,t,e,r),i.status===yn.VICTORY)return i;r={status:i.status,victory:P.empty(),preVictory:i.preVictory,sum:r.sum+i.sum}}return r}}class v6 extends Ct{constructor(t,e){super(t),this.value=t,this.preVictory=e}}class d8 extends l5t{constructor(){super(...arguments),this.VERBOSE=!1}static get(){if(d8.singleton.isAbsent()){const t=new q3(Zi);d8.singleton=P.of(new d8(t,"SixMinimax"))}return d8.singleton.get()}getListMoves(t){const e=d8.get(),r=t.getOwnValue(e);if(r.preVictory.isPresent())return t.gameState.turn<40?this.createForcedDrop(r):this.createForcedDeplacement(t,r);const s=q3.getLegalLandings(t.gameState);return t.gameState.turn<40?this.getListDrop(s):this.getListDeplacement(t.gameState,s)}createForcedDrop(t){X(this.VERBOSE,{called:"SixMinimax.createForceDrop",unheritance:t});const e=[],r=Wr.fromDrop(t.preVictory.get());return e.push(r),e}createForcedDeplacement(t,e){X(this.VERBOSE,{called:"SixRules.createForcedDeplacement",node:t});const r=this.getSafelyMovablePieceOrFirstOne(t),s=[e.preVictory.get()];return this.getDeplacementFrom(t.gameState,r,s)}getDeplacementFrom(t,e,r){const s=[];for(const i of e)for(const o of r){const c=Wr.fromMovement(i,o);if(t.isCoordConnected(o,P.of(i))){const h=t.movePiece(c).getGroups();if(q3.isSplit(h))for(const p of h){const m=p.getAnyElement().get(),C=Wr.fromCut(i,o,m);s.push(C)}else s.push(c)}}return s}getSafelyMovablePieceOrFirstOne(t){const e=t.gameState,r=e.getPieces().reverse(),s=e.getCurrentPlayer(),i=r.get(s).get(),o=i.getAnyElement().get(),c=[];for(const u of i)!1===this.isPieceBlockingAVictory(e,u)&&c.push(u);return new Ar(0===c.length?[o]:c)}isPieceBlockingAVictory(t,e){const r=t.switchPiece(e),s=Wr.fromDrop(e);for(this.startSearchingVictorySources();this.hasNextVictorySource();)if(this.currentVictorySource=this.getNextVictorySource(),this.searchVictoryOnly(this.currentVictorySource,s,r).status===yn.VICTORY)return!0;return!1}getListDrop(t){const e=[];for(const r of t){const s=Wr.fromDrop(r);e.push(s)}return e}getListDeplacement(t,e){const r=t.getCurrentPlayer(),s=t.getPieces().reverse().get(r).get();return this.getDeplacementFrom(t,s,e)}getBoardValue(t){const e=t.move,r=t.gameState,s=r.getCurrentOpponent(),i=s.getVictoryValue();let o={status:yn.DEFAULT,victory:P.empty(),preVictory:P.empty(),sum:0};e.isPresent()&&(o=this.calculateBoardValue(e.get(),r));let c=P.empty();if(o.status===yn.DEFAULT&&o.preVictory.isPresent()&&(c=P.of(o.preVictory.get())),o.status===yn.VICTORY)return new v6(i,P.empty());if(r.turn>39){const u=r.countPieces(),h=u[0],p=u[1];return h<6&&p<6?new v6(h<p?z.ONE.getVictoryValue():p<h?z.ZERO.getVictoryValue():0,P.empty()):h<6?new v6(z.ZERO.getDefeatValue(),P.empty()):p<6?new v6(z.ONE.getDefeatValue(),P.empty()):new v6(h-p,c)}return new v6(o.status===yn.PRE_VICTORY?s.getPreVictory():o.sum*s.getScoreModifier(),c)}startSearchingVictorySources(){X(this.VERBOSE,"SixRules.startSearchingVictorySources()"),this.currentVictorySource={typeSource:"LINE",index:-1}}hasNextVictorySource(){return"CIRCLE"!==this.currentVictorySource.typeSource||5!==this.currentVictorySource.index}getNextVictorySource(){if(5===this.currentVictorySource.index){let e;switch(this.currentVictorySource.typeSource){case"LINE":e="TRIANGLE_CORNER";break;case"TRIANGLE_CORNER":e="TRIANGLE_EDGE";break;default:e="CIRCLE"}this.currentVictorySource={typeSource:e,index:0}}else{let e=1;"LINE"===this.currentVictorySource.typeSource&&(e=2),this.currentVictorySource={typeSource:this.currentVictorySource.typeSource,index:this.currentVictorySource.index+e}}return this.currentVictorySource}searchVictoryOnly(t,e,r){const s=e.landing.getNext(r.offset,1);switch(X(this.VERBOSE,{called:"SixRules.searchVictoryOnly",victorySource:t,move:e,state:r}),t.typeSource){case"LINE":return this.searchVictoryOnlyForLine(t.index,s,r);case"CIRCLE":return this.searchVictoryOnlyForCircle(t.index,s,r);case"TRIANGLE_CORNER":return this.searchVictoryOnlyForTriangleCorner(t.index,s,r);default:return this.searchVictoryOnlyForTriangleEdge(t.index,s,r)}}searchVictoryOnlyForCircle(t,e,r){X(this.VERBOSE,{called:"SixRules.searchVictoryOnlyForCircle",index:t,lastDrop:e,state:r});const s=r.getCurrentOpponent(),o=[e];let c=e.getNext(Le.factory.all[t],1);for(;o.length<6;){if(r.getPieceAt(c)!==s)return{status:yn.PRE_VICTORY,victory:P.empty(),preVictory:P.empty(),sum:0};const h=(t+o.length)%6;o.push(c),c=c.getNext(Le.factory.all[h],1)}return{status:yn.VICTORY,victory:P.of(o),preVictory:P.empty(),sum:0}}searchVictoryOnlyForLine(t,e,r){const s=r.getCurrentOpponent();let i=Le.factory.all[t],o=e.getNext(i,1);const c=[e];let u=!1;for(;c.length<6;){if(r.getPieceAt(o)===s)c.push(o);else{if(u)return{status:yn.PRE_VICTORY,victory:P.empty(),preVictory:P.empty(),sum:0};u=!0,i=i.getOpposite(),o=o.getNext(i,c.length-1)}o=o.getNext(i,1)}return{status:yn.VICTORY,victory:P.of(c),preVictory:P.empty(),sum:0}}searchVictoryOnlyForTriangleCorner(t,e,r){X(this.VERBOSE,{called:"SixRules.searchVictoryTriangleCornerOnly",index:t,lastDrop:e,state:r});const s=r.getCurrentOpponent();let i=Le.factory.all[t];const o=[e];let c=e.getNext(i,1);for(;o.length<6;){if(r.getPieceAt(c)!==s)return{status:yn.PRE_VICTORY,victory:P.empty(),preVictory:P.empty(),sum:0};o.length%2==0&&(i=Le.factory.all[(t+o.length)%6]),o.push(c),c=c.getNext(i,1)}return{status:yn.VICTORY,victory:P.of(o),preVictory:P.empty(),sum:0}}searchVictoryOnlyForTriangleEdge(t,e,r){X(this.VERBOSE,{called:"SixRules.searchVictoryTriangleEdgeOnly",index:t,lastDrop:e,state:r});const s=r.getCurrentOpponent();let i=Le.factory.all[t];const o=[e];let c=e.getNext(i,1);for(;o.length<6;){if(r.getPieceAt(c)!==s)return{status:yn.PRE_VICTORY,victory:P.empty(),preVictory:P.empty(),sum:0};o.push(c),o.length%2==0&&(i=Le.factory.all[(t+o.length)%6]),c=c.getNext(i,1)}return{status:yn.VICTORY,victory:P.of(o),preVictory:P.empty(),sum:0}}getBoardInfo(t,e,r,s){X(this.VERBOSE,{called:"SixRules.getBoardInfo",victorySource:t,move:e,state:r,boardInfo:s});const i=e.landing.getNext(r.offset,1);switch(t.typeSource){case"CIRCLE":return this.getBoardInfoForCircle(t.index,i,r,s);case"LINE":return this.getBoardInfoForLine(t.index,i,r,s);case"TRIANGLE_CORNER":return this.getBoardInfoForTriangleCorner(t.index,i,r,s);default:return this.getBoardInfoForTriangleEdge(t.index,i,r,s)}}getBoardInfoForCircle(t,e,r,s){X(this.VERBOSE,{called:"SixMinimaw.getBoardInfoForCircle",index:t,lastDrop:e,state:r,boardInfo:s});const i=r.getCurrentPlayer(),c=[e];let u=e.getNext(Le.factory.all[t],1),h=0,p=P.empty();for(;c.length<6;){const m=r.getPieceAt(u);if(m===i)return s;const C=(t+c.length)%6;c.push(u);const w=Le.factory.all[C];m===pe.NONE?(h+=.16,p=P.of(u)):h++,u=u.getNext(w,1)}return this.getBoardInfoResult(h,p,c,s)}getBoardInfoResult(t,e,r,s){let i=s.preVictory;if(4.16===t){if(X(this.VERBOSE,"5+1 found!"),i.isPresent()&&!1===i.equals(e))return{status:yn.PRE_VICTORY,victory:P.empty(),preVictory:P.empty(),sum:0};i=e}else if(5===t)return{status:yn.VICTORY,victory:P.of(r),preVictory:P.empty(),sum:0};return{status:s.status,victory:P.empty(),preVictory:i,sum:s.sum+t}}getBoardInfoForLine(t,e,r,s){X(this.VERBOSE,{called:"SixRules.getBoardInfoForLine",index:t,lastDrop:e,state:r,boardInfo:s});const i=Le.factory.all[t];let o=e.getPrevious(i,5),c=[],u=[],h=P.empty();for(let H=0;H<6;H++){const K=this.updateEncounterAndReturnLastEmpty(r,o,u);K.isPresent()&&(h=K),c.push(o),o=o.getNext(i,1)}let p=s.status,m=s.preVictory,C=0,w=0;for(;C<6;){const H=u.reduce((ie,ye)=>ie+ye);if(6===H)return{status:yn.VICTORY,victory:P.of(c),preVictory:P.empty(),sum:0};5.16===H&&p===yn.DEFAULT&&(m.isPresent()?(ve(!1===m.equals(h),"Impossible to have point aligned with differents line to a same point"),p=yn.PRE_VICTORY):m=h),w=Math.max(w,H),c=c.slice(1,6),c.push(o),u=u.slice(1,6);const K=this.updateEncounterAndReturnLastEmpty(r,o,u);K.isPresent()&&(h=K),C++,o=o.getNext(i,1)}const I={status:p,victory:P.of(c),preVictory:m,sum:w};return this.getBoardInfoResult(w,h,c,I)}updateEncounterAndReturnLastEmpty(t,e,r){const s=t.getCurrentPlayer();switch(t.getPieceAt(e)){case s:return r.push(-7),P.empty();case pe.NONE:return r.push(.16),P.of(e);default:return r.push(1),P.empty()}}getBoardInfoForTriangleCorner(t,e,r,s){X(this.VERBOSE,{called:"SixRules.getBoardInfoForTriangleCorner",index:t,lastDrop:e,state:r,boardInfo:s});const i=r.getCurrentPlayer();let o=Le.factory.all[t];const c=[e];let u=e.getNext(o,1),h=0,p=P.empty();for(;c.length<6;){const m=r.getPieceAt(u);if(m===i)return s;m===pe.NONE?(h+=.16,p=P.of(u)):h++,c.length%2==0&&(o=Le.factory.all[(t+c.length)%6]),c.push(u),u=u.getNext(o,1)}return this.getBoardInfoResult(h,p,c,s)}getBoardInfoForTriangleEdge(t,e,r,s){X(this.VERBOSE,{called:"SixRules.getBoardInfoForTriangleEdge",index:t,lastDrop:e,state:r,boardInfo:s});const i=r.getCurrentPlayer();let o=Le.factory.all[t];const c=[e];let u=e.getNext(o,1),h=0,p=P.empty();for(;c.length<6;){const m=r.getPieceAt(u);if(m===i)return s;m===pe.NONE?(h+=.16,p=P.of(u)):h++,c.push(u),c.length%2==0&&(o=Le.factory.all[(t+c.length)%6]),u=u.getNext(o,1)}return this.getBoardInfoResult(h,p,c,s)}}d8.singleton=P.empty();const Pe=pe.NONE.value,$t=z.ZERO.value,Kt=z.ONE.value;let WH=(()=>{class n{}return n.MOVEMENT_NOT_DISCONNECTING=()=>$localize`This move does not disconnect your opponent's pieces. Try again with another piece.`,n.MOVEMENT_SELF_DISCONNECTING=()=>$localize`You lost one of your pieces during this move. There is a way to disconnect an opponent's piece without losing any of yours, try again!`,n})();class W3e extends K1{constructor(){super(...arguments),this.tutorial=[ce.informational($localize`Six`,$localize`Six is a game without board, where pieces are placed on the side of each other, in a contiguous block.
        Each player has 21 pieces, with one for each player already on the board.
        The goal of the game is to form one of the three winning shapes with your pieces.`,Zi.getInitialState()),ce.fromMove($localize`Victory (line)`,$localize`On this board, by putting your piece at the right place, you can align six of your pieces and win the game<br/><br/>
        Find the victory. You're playing Dark.`,Zi.fromRepresentation([[$t,Kt,Kt,Kt,Kt,$t],[Pe,$t,Kt,Pe,$t,Pe],[Kt,Kt,$t,Pe,Pe,Pe],[Pe,Pe,$t,Pe,Pe,Pe],[Pe,$t,Pe,Pe,Pe,Pe],[$t,Pe,Pe,Pe,Pe,Pe]],0),[Wr.fromDrop(new M(3,2))],$localize`Congratulations!`,$localize`Failed. Try again.`),ce.fromMove($localize`Victory (circle)`,$localize`On this board, by putting your piece at the right place, you can form a circle with six of your pieces and win the game.<br/><br/>
        Find the victory. You're playing Dark.`,Zi.fromRepresentation([[Pe,Pe,Pe,Kt,Pe,Pe],[Pe,Pe,Kt,Kt,$t,$t],[Pe,Kt,Pe,$t,Kt,Pe],[Kt,$t,$t,$t,$t,Kt]],0),[Wr.fromDrop(new M(5,2))],$localize`Congratulations! Note that if a piece is inside the circle, it does not change anything.`,$localize`Failed. Try again.`),ce.fromMove($localize`Victory (triangle)`,$localize`On this board, by putting your piece at the right place, you can form a triangle with six of your pieces and win the game.<br/><br/>
        Find the victory. You're playing Dark.`,Zi.fromRepresentation([[Pe,Pe,Pe,Kt,Pe,Pe],[Pe,$t,Kt,$t,$t,$t],[Pe,$t,Pe,$t,$t,Pe],[Kt,Kt,Kt,Pe,Kt,Pe]],0),[Wr.fromDrop(new M(3,3))],$localize`Congratulations!`,$localize`Failed. Try again.`),ce.fromPredicate($localize`Second phase`,$localize`After 40 turns, your pieces have all been placed and we move on to the second phase of the game.
        You now have to move your pieces, paying attention not to remove a piece that was preventing the opponent's victory.
        From now on, if after move, on or more pieces are disconnected from the largest group of pieces, these will be taken out of the game.<br/><br/>
        You're playing Dark. Make a move that disconnects one of your opponent's pieces.`,Zi.fromRepresentation([[Pe,Pe,Pe,Pe,Pe,Pe,Pe,Kt,Pe],[Pe,Pe,Pe,Pe,Pe,Pe,$t,Pe,Pe],[Pe,Pe,Pe,Pe,$t,$t,$t,Pe,Pe],[Pe,Pe,Pe,Pe,Kt,Kt,Pe,Kt,$t],[Pe,$t,Kt,Kt,$t,$t,Kt,Pe,Pe],[$t,$t,$t,$t,Kt,Kt,Kt,$t,Pe],[Kt,Kt,$t,Pe,Kt,Kt,$t,Pe,Pe],[Pe,$t,Pe,$t,$t,Pe,Pe,Pe,Pe],[Kt,Kt,Kt,Kt,Pe,Pe,Pe,Pe,Pe],[Pe,$t,Pe,Kt,Pe,Pe,Pe,Pe,Pe]],40),Wr.fromMovement(new M(6,1),new M(5,1)),(t,e,r)=>{const s=r.countPieces();return 19===s[0]?18===s[1]?G.SUCCESS:G.failure(WH.MOVEMENT_NOT_DISCONNECTING()):G.failure(WH.MOVEMENT_SELF_DISCONNECTING())},$localize`Congratulations, your opponent now has one piece less and you're closer to victory!`),ce.fromPredicate($localize`Victory by disconnection`,$localize`During the second phase of the game, on top of normal victories (line, circle, triangle), you can win by disconnection.
        If at any time, at least one player does not have enough pieces to win (less than 6), the game ends.
        The one with the most pieces wins. In case they both have the same number of pieces, it's a draw.<br/><br/>
        Here, you're playing Dark and you can win. Do it!`,Zi.fromRepresentation([[Pe,Pe,Pe,Pe,Pe,Kt],[Pe,Pe,Pe,Pe,$t,Kt],[Pe,Pe,Pe,Kt,$t,$t],[Pe,Pe,$t,Pe,Kt,$t],[Kt,Kt,Pe,Pe,Pe,$t],[$t,Kt,Pe,Pe,Pe,Pe],[$t,Pe,Pe,Pe,Pe,Pe]],40),Wr.fromMovement(new M(2,3),new M(3,3)),(t,e,r)=>t.start.equalsValue(new M(2,3))?G.SUCCESS:G.failure(WH.MOVEMENT_NOT_DISCONNECTING()),$localize`Congratulations, you won!`),ce.fromPredicate($localize`Special disconnection`,$localize`During a disconnection, two or more groups could have the same size,
        in which case you will have to click on the group you wish to keep.<br/><br/>
        You're playing Dark, play such a move!`,Zi.fromRepresentation([[Pe,Pe,Pe,Pe,Pe,Kt],[Pe,Pe,Pe,Pe,$t,Kt],[Pe,Pe,Pe,Kt,$t,$t],[$t,Pe,$t,Pe,Pe,Kt],[Kt,Kt,Pe,Pe,Pe,Pe],[$t,$t,Pe,Pe,Pe,Pe],[$t,Pe,Pe,Pe,Pe,Pe]],40),Wr.fromCut(new M(2,3),new M(2,5),new M(2,5)),(t,e,r)=>t.keep.isAbsent()?G.failure($localize`This move has not cut the board in two equal halves.`):r.getPieceAt(t.landing.getNext(r.offset))===pe.NONE?G.failure($localize`Failed. You did cut the board in two but you kept the half where you're in minority. Therefore, you lost! Try again.`):G.SUCCESS,$localize`Congratulations, you won!`)]}}function u5t(n,t){if(1&n){const e=Oe();F(),b(0,"polygon",10),ee("click",function(){const i=he(e).$implicit;return le(v().onPieceClick(i))}),O()}if(2&n){const e=t.$implicit,r=v();We("id","piece_",e.x,"_",e.y,""),T("ngClass",r.getPieceClass(e)),D("points",r.getHexaPointsAt(e))}}function f5t(n,t){if(1&n){const e=Oe();F(),b(0,"polygon",11),ee("click",function(){const i=he(e).$implicit;return le(v().onNeighborClick(i))}),O()}if(2&n){const e=t.$implicit,r=v();We("id","neighbor_",e.x,"_",e.y,""),D("points",r.getHexaPointsAt(e))}}function h5t(n,t){if(1&n){const e=Oe();F(),b(0,"polygon",10),ee("click",function(){he(e);const s=v();return le(s.onPieceClick(s.chosenLanding.get()))}),O()}if(2&n){const e=v();We("id","chosenLanding_",e.chosenLanding.get().x,"_",e.chosenLanding.get().y,""),T("ngClass",e.getPlayerClass(e.state.getCurrentPlayer())),D("points",e.getHexaPointsAt(e.chosenLanding.get()))}}function d5t(n,t){if(1&n&&(F(),Q(0,"polygon",12)),2&n){const e=t.$implicit,r=v();We("id","disconnected_",e.x,"_",e.y,""),D("points",r.getHexaPointsAt(e))}}function p5t(n,t){if(1&n){const e=Oe();F(),b(0,"polygon",13),ee("click",function(){he(e);const s=v();return le(s.onNeighborClick(s.leftCoord.get()))}),O()}if(2&n){const e=v();We("id","leftCoord_",e.leftCoord.get().x,"_",e.leftCoord.get().y,""),D("points",e.getHexaPointsAt(e.leftCoord.get()))}}function g5t(n,t){if(1&n){const e=Oe();F(),b(0,"polygon",14),ee("click",function(){he(e);const s=v();return le(s.onPieceClick(s.lastDrop.get()))}),O()}if(2&n){const e=v();We("id","lastDrop_",e.lastDrop.get().x,"_",e.lastDrop.get().y,""),D("points",e.getHexaPointsAt(e.lastDrop.get()))}}function m5t(n,t){if(1&n){const e=Oe();F(),b(0,"polygon",15),ee("click",function(){he(e);const s=v();return le(s.onPieceClick(s.selectedPiece.get()))}),O()}if(2&n){const e=v();We("id","selectedPiece_",e.selectedPiece.get().x,"_",e.selectedPiece.get().y,""),T("ngClass",e.getSelectedPieceClass()),D("points",e.getHexaPointsAt(e.selectedPiece.get()))}}function _5t(n,t){if(1&n&&(F(),Q(0,"polygon",16)),2&n){const e=t.$implicit,r=v();We("id","victoryCoord_",e.x,"_",e.y,""),D("points",r.getHexaPointsAt(e))}}function v5t(n,t){if(1&n){const e=Oe();F(),b(0,"polygon",19),ee("click",function(){const i=he(e).$implicit;return le(v(2).onPieceClick(i))}),O()}if(2&n){const e=t.$implicit,r=v(2);We("id","cuttable_",e.x,"_",e.y,""),D("points",r.getHexaPointsAt(e))}}function C5t(n,t){if(1&n&&(F(),b(0,"g",17),x(1,v5t,1,3,"polygon",18),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e)}}let y5t=(()=>{class n extends y9{constructor(e){super(e),this.disconnecteds=[],this.cuttableGroups=[],this.leftCoord=P.empty(),this.lastDrop=P.empty(),this.selectedPiece=P.empty(),this.chosenLanding=P.empty(),this.nextClickShouldSelectGroup=!1,this.rules=new q3(Zi),this.availableMinimaxes=[new d8(this.rules,"SixMinimax")],this.encoder=Wr.encoder,this.tutorial=(new W3e).tutorial,this.SPACE_SIZE=30,this.hexaLayout=new E9(1.5*this.SPACE_SIZE,new M(2*this.SPACE_SIZE,0),As.INSTANCE),this.updateBoard()}cancelMoveAttempt(){this.selectedPiece=P.empty(),this.chosenLanding=P.empty(),this.cuttableGroups=[],this.nextClickShouldSelectGroup=!1,this.updateBoard()}updateBoard(){this.state=this.rules.node.gameState,this.rules.node.move.isPresent()?this.showLastMove():(this.leftCoord=P.empty(),this.lastDrop=P.empty(),this.victoryCoords=[],this.disconnecteds=[]),this.pieces=this.state.getPieceCoords(),this.neighbors=this.getEmptyNeighbors(),this.viewBox=this.getViewBox()}getViewBox(){const e=this.pieces.concat(this.disconnecteds).concat(this.neighbors);return f6.fromHexa(e,this.hexaLayout,this.STROKE_WIDTH).toSVGString()}showLastMove(){const e=this.rules.node.move.get();this.lastDrop=P.of(e.landing.getNext(this.state.offset)),this.leftCoord=!1===e.isDrop()?P.of(e.start.get().getNext(this.state.offset,1)):P.empty();const r=this.getState();this.rules.getGameStatus(this.rules.node).isEndGame&&(this.victoryCoords=this.rules.getShapeVictory(e,r)),this.disconnecteds=this.getDisconnected()}getDisconnected(){const e=this.rules.node.mother.get().gameState.getPieceCoords(),r=this.getState().getPieceCoords(),s=[];for(const o of e)!1===this.rules.node.move.get().start.equalsValue(o)&&!1===r.some(u=>u.equals(o.getNext(this.state.offset,1)))&&s.push(o.getNext(this.state.offset,1));const i=this.lastDrop.get();return!1===this.pieces.some(o=>o.equals(i))&&!1===r.some(o=>o.equals(i))&&s.push(i),s}getEmptyNeighbors(){let e=q3.getLegalLandings(this.state);if(this.chosenLanding.isPresent()){const r=this.chosenLanding.get();e=e.filter(s=>!1===s.equals(r))}return e}getPieceClass(e){const r=this.getState().getPieceAt(e);return this.getPlayerClass(r)}onPieceClick(e){var r=this;return A(function*(){const s=r.canUserPlay("#piece_"+e.x+"_"+e.y);if(s.isFailure())return r.cancelMove(s.getReason());if(r.state.turn<40)return r.cancelMove(W3.NO_MOVEMENT_BEFORE_TURN_40());if(r.chosenLanding.isAbsent())return r.state.getPieceAt(e)===r.state.getCurrentOpponent()?r.cancelMove(tt.CANNOT_CHOOSE_OPPONENT_PIECE()):(r.selectedPiece=r.selectedPiece.equalsValue(e)?P.empty():P.of(e),G.SUCCESS);{const i=Wr.fromCut(r.selectedPiece.get(),r.chosenLanding.get(),e);return r.chooseMove(i,r.state)}})()}onNeighborClick(e){var r=this;return A(function*(){const s=r.canUserPlay("#neighbor_"+e.x+"_"+e.y);if(s.isFailure())return r.cancelMove(s.getReason());if(r.nextClickShouldSelectGroup)return r.cancelMove(W3.MUST_CUT());if(r.state.turn<40)return r.chooseMove(Wr.fromDrop(e),r.state);if(r.selectedPiece.isAbsent())return r.cancelMove(W3.CAN_NO_LONGER_DROP());{const i=Wr.fromMovement(r.selectedPiece.get(),e),o=q3.isLegalPhaseTwoMove(i,r.state);return r.neededCutting(o)?(r.chosenLanding=P.of(e),r.moveVirtuallyPiece(),r.showCuttable(),r.nextClickShouldSelectGroup=!0,G.SUCCESS):r.chooseMove(i,r.state)}})()}neededCutting(e){return e.isFailure()&&e.getReason()===W3.MUST_CUT()}moveVirtuallyPiece(){const e=this.selectedPiece.get();this.pieces=this.pieces.filter(r=>!1===r.equals(e)),this.neighbors=this.getEmptyNeighbors()}showCuttable(){const e=Wr.fromMovement(this.selectedPiece.get(),this.chosenLanding.get()),s=this.state.movePiece(e).getGroups(),i=q3.getBiggerGroups(s);this.cuttableGroups=[];for(const o of i)this.cuttableGroups.push(o.toList())}getSelectedPieceClass(){return this.chosenLanding.isPresent()?"moved-fill":"selected-stroke"}}return n.\u0275fac=function(e){return new(e||n)(J(Pn))},n.\u0275cmp=gt({type:n,selectors:[["app-six"]],features:[l],decls:10,vars:10,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["class","base round",3,"id","ngClass","click",4,"ngFor","ngForOf"],["class","base round",3,"id","click",4,"ngFor","ngForOf"],["class","base round",3,"id","ngClass","click",4,"ngIf"],["class","base round captured-fill",3,"id",4,"ngFor","ngForOf"],["class","base round moved-fill mid-stroke",3,"id","click",4,"ngIf"],["class","base no-fill round last-move-stroke mid-stroke",3,"id","click",4,"ngIf"],["class","base no-fill round",3,"id","ngClass","click",4,"ngIf"],["class","base no-fill round victory-stroke mid-stroke",3,"id",4,"ngFor","ngForOf"],["pointer-events","fill","class","capturable-stroke",4,"ngFor","ngForOf"],[1,"base","round",3,"id","ngClass","click"],[1,"base","round",3,"id","click"],[1,"base","round","captured-fill",3,"id"],[1,"base","round","moved-fill","mid-stroke",3,"id","click"],[1,"base","no-fill","round","last-move-stroke","mid-stroke",3,"id","click"],[1,"base","no-fill","round",3,"id","ngClass","click"],[1,"base","no-fill","round","victory-stroke","mid-stroke",3,"id"],["pointer-events","fill",1,"capturable-stroke"],["class","no-fill","stroke-linecap","round",3,"id","click",4,"ngFor","ngForOf"],["stroke-linecap","round",1,"no-fill",3,"id","click"]],template:function(e,r){1&e&&(F(),b(0,"svg",0),x(1,u5t,1,4,"polygon",1),x(2,f5t,1,3,"polygon",2),x(3,h5t,1,4,"polygon",3),x(4,d5t,1,3,"polygon",4),x(5,p5t,1,3,"polygon",5),x(6,g5t,1,3,"polygon",6),x(7,m5t,1,4,"polygon",7),x(8,_5t,1,3,"polygon",8),x(9,C5t,2,1,"g",9),O()),2&e&&(D("viewBox",r.viewBox),S(1),T("ngForOf",r.pieces),S(1),T("ngForOf",r.neighbors),S(1),T("ngIf",r.chosenLanding.isPresent()),S(1),T("ngForOf",r.disconnecteds),S(1),T("ngIf",r.leftCoord.isPresent()),S(1),T("ngIf",r.lastDrop.isPresent()),S(1),T("ngIf",r.selectedPiece.isPresent()),S(1),T("ngForOf",r.victoryCoords),S(1),T("ngForOf",r.cuttableGroups))},dependencies:[dn,An,en],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class va extends MH{static of(t,e){return new va(t,e)}static from(t,e){try{const r=new va(t,e);return U.success(r)}catch(r){return U.failure(r.message)}}getMaximalDistance(){return 9}}va.encoder=Lc.getEncoder(va.from);const E5t={CASTLE_IS_LEFT_FOR_GOOD:!1,BORDER_CAN_SURROUND_KING:!0,CENTRAL_THRONE_CAN_SURROUND_KING:!1,KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED:!1,WIDTH:9,INVADER:z.ZERO};class j4 extends SH{static getInitialState(){const t=En.UNOCCUPIED,e=En.INVADERS,r=En.DEFENDERS;return new j4([[t,t,t,e,e,e,t,t,t],[t,t,t,t,e,t,t,t,t],[t,t,t,t,r,t,t,t,t],[e,t,t,t,r,t,t,t,e],[e,e,r,r,En.PLAYER_ONE_KING,r,r,e,e],[e,t,t,t,r,t,t,t,e],[t,t,t,t,r,t,t,t,t],[t,t,t,t,e,t,t,t,t],[t,t,t,e,e,e,t,t,t]],0)}from(t,e){return new j4(t,e)}}class O5 extends PH{constructor(){super(j4,E5t,va.of)}static get(){return null==O5.singleton&&(O5.singleton=new O5),$1.ruler=this.singleton,O5.singleton}}const j=En.UNOCCUPIED,i1=En.INVADERS,oo=En.DEFENDERS,XP=En.PLAYER_ONE_KING;class q3e extends K1{constructor(){super(...arguments),this.tutorial=[ce.informational($localize`Goal of the game`,$localize`Tablut is the lapland version of the Tafl, Tafl being a family of viking strategy game. The goal of the game is different for each player. The attacker plays first. Its pieces (dark) are close to the edges. Its goal is to capture the king, which is in the center of the board. The defender plays second. Its pieces (light) are in the middle. Its goal is to move the king on one of the 4 thrones in the corners. Note that the square in which the king starts, in the center of the board, is also a throne.`,j4.getInitialState()),ce.anyMove($localize`Moving`,$localize`All pieces move the same way. Similarly to a rook in chess, a piece can move:<ol><li>By as many squares as you want.</li><li>Without going over another piece or stopping on another piece.</li><li>Horizontally or vertically.</li><li>Only the king can land on a throne.</li></ol>To move a piece, click on it and then on its landing square.<br/><br/>You're playing Dark, do the first move.`,j4.getInitialState(),va.of(new M(4,1),new M(1,1)),$localize`Congratulations!`),ce.fromMove($localize`Capturing a soldier (1/2)`,$localize`All pieces, attackers and defenders, except the king, are soldiers. To capture them, they have to be sandwiched between two of your pieces. By getting too close, an attacker's soldier is in danger.<br/><br/>You're playing Light. Capture the soldier.`,new j4([[j,j,j,i1,i1,i1,j,j,j],[j,j,j,j,i1,j,j,j,j],[j,j,j,j,oo,j,j,j,j],[j,j,j,i1,oo,j,j,j,i1],[i1,i1,oo,oo,XP,oo,oo,i1,i1],[j,j,j,j,oo,j,j,j,i1],[j,j,j,j,oo,j,j,j,j],[j,j,j,j,i1,j,j,j,j],[j,j,j,i1,i1,i1,j,j,j]],1),[va.of(new M(2,4),new M(2,3)),va.of(new M(4,2),new M(3,2))],$localize`Congratulations, that will teach him a lesson!`,$localize`Failed, you missed an opportunity to capture a piece of the opponent.`),ce.fromMove($localize`Capturing a soldier (2/2)`,$localize`A second way to capture a soldier is to sandwich it against an empty throne. The king has moved and endangered one of its soldiers.<br/><br/>You're playing Dark. Capture the soldier.`,new j4([[j,j,j,i1,i1,i1,j,j,j],[j,j,j,j,i1,j,j,j,j],[j,j,j,j,oo,j,j,j,j],[j,j,oo,j,XP,j,oo,j,i1],[i1,i1,j,oo,j,oo,oo,i1,i1],[j,j,j,j,oo,j,j,j,i1],[j,j,j,j,oo,j,j,j,j],[j,j,j,j,i1,j,j,j,j],[j,j,j,i1,i1,i1,j,j,j]],12),[va.of(new M(1,4),new M(2,4))],$localize`Congratulations, one less defender. But keep an eye on the king, it is the most important.`,$localize`Failed, you did not do the expected move.`),ce.fromMove($localize`Capturing the king (1/2)`,$localize`To capture the king, two soldiers are not enough. For the first solution, the four squares neighbor to the king (horizontally and vertically) must be occupied by your soldiers. This also works if the king is on the throne.<br/><br/>You're playing Dark, capture the king.`,new j4([[j,j,j,j,j,j,j,j,j],[j,j,j,j,j,j,j,j,j],[j,j,j,j,j,j,j,j,j],[j,i1,j,j,j,j,j,j,j],[i1,XP,j,i1,j,j,j,j,j],[j,i1,j,j,j,j,j,j,j],[j,j,j,j,j,j,j,j,j],[j,j,j,j,j,j,j,j,j],[j,j,j,j,j,j,j,j,j]],72),[va.of(new M(3,4),new M(2,4))],$localize`Congratulations, you won!`,$localize`Failed, you let the king run away.`),ce.fromMove($localize`Capturing the king (2/2)`,$localize`Another way to capture the king is to immobilize it against an edge of the board. Note that the king cannot be captured next to a throne.<br/><br/>You're playing Dark, capture the king.`,new j4([[j,j,i1,XP,i1,j,j,j,j],[j,j,j,j,j,j,j,j,j],[j,j,j,j,j,j,j,j,j],[j,j,j,i1,j,j,j,j,j],[j,j,j,j,j,j,j,j,j],[j,j,j,j,j,j,j,j,j],[j,j,j,j,j,j,j,j,j],[j,j,j,j,j,j,j,j,j],[j,j,j,j,j,j,j,j,j]],72),[va.of(new M(3,3),new M(3,1))],$localize`The king is dead, long live the king. Congratulations, you won.`,$localize`Failed. Try again.`)]}}function M5t(n,t){1&n&&(F(),Q(0,"polygon",8))}function S5t(n,t){1&n&&(F(),Q(0,"rect",9))}function P5t(n,t){if(1&n&&(F(),b(0,"g"),x(1,M5t,1,0,"polygon",6),x(2,S5t,1,0,"ng-template",null,7,r1),O()),2&n){const e=Qn(3),r=v().index,s=v().index,i=v();S(1),T("ngIf",i.isCentralThrone(r,s))("ngIfElse",e)}}function T5t(n,t){if(1&n&&(F(),b(0,"g"),Q(1,"line",13)(2,"line",13)(3,"line",13)(4,"line",13)(5,"line",13),O()),2&n){const e=v(2).index,r=v().index,s=v();S(1),T("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.5*s.SPACE_SIZE)("y1",.04*s.SPACE_SIZE)("x2",.5*s.SPACE_SIZE)("y2",.96*s.SPACE_SIZE),S(1),T("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.5*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.1*s.SPACE_SIZE)("y2",.6*s.SPACE_SIZE),S(1),T("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.5*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.9*s.SPACE_SIZE)("y2",.6*s.SPACE_SIZE),S(1),T("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.5*s.SPACE_SIZE)("y1",.4*s.SPACE_SIZE)("x2",.15*s.SPACE_SIZE)("y2",.75*s.SPACE_SIZE),S(1),T("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.5*s.SPACE_SIZE)("y1",.4*s.SPACE_SIZE)("x2",.85*s.SPACE_SIZE)("y2",.75*s.SPACE_SIZE)}}function w5t(n,t){if(1&n&&(F(),Q(0,"polyline",16)),2&n){const e=v(3).index,r=v().index;T("ngClass",v().viewInfo.pieceClasses[r][e])}}function b5t(n,t){if(1&n&&(F(),Q(0,"line",13)(1,"line",13)(2,"line",13)(3,"line",13)),2&n){const e=v(3).index,r=v().index,s=v();T("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.5*s.SPACE_SIZE)("y1",.04*s.SPACE_SIZE)("x2",.5*s.SPACE_SIZE)("y2",.96*s.SPACE_SIZE),S(1),T("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.04*s.SPACE_SIZE)("y1",.5*s.SPACE_SIZE)("x2",.96*s.SPACE_SIZE)("y2",.5*s.SPACE_SIZE),S(1),T("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.2*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.8*s.SPACE_SIZE)("y2",.8*s.SPACE_SIZE),S(1),T("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.8*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.2*s.SPACE_SIZE)("y2",.8*s.SPACE_SIZE)}}function O5t(n,t){if(1&n&&(F(),x(0,w5t,1,1,"polyline",14),x(1,b5t,4,20,"ng-template",null,15,r1)),2&n){const e=Qn(2),r=v(2).index,s=v().index;T("ngIf",v().isKing(r,s))("ngIfElse",e)}}function N5t(n,t){if(1&n&&(F(),b(0,"g"),Q(1,"circle",10),x(2,T5t,6,25,"g",11),x(3,O5t,3,2,"ng-template",null,12,r1),O()),2&n){const e=Qn(4),r=v().index,s=v().index,i=v();S(1),We("id","piece_",r,"_",s,""),T("ngClass",i.viewInfo.pieceClasses[s][r]),D("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)("cx",.5*i.SPACE_SIZE)("cy",.5*i.SPACE_SIZE),S(1),T("ngIf",i.isInvader(r,s))("ngIfElse",e)}}function A5t(n,t){if(1&n){const e=Oe();F(),b(0,"g",3),ee("click",function(){const i=he(e).index,o=v().index;return le(v().onClick(i,o))}),Q(1,"rect",4),x(2,P5t,4,2,"g",5),x(3,N5t,5,8,"g",5),O()}if(2&n){const e=t.index,r=v().index,s=v();We("id","click_",e,"_",r,""),D("transform","translate("+s.SPACE_SIZE*e+", "+s.SPACE_SIZE*r+")"),S(1),T("ngClass",s.getRectClasses(e,r)),D("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),S(1),T("ngIf",s.board[r][e]===s.EMPTY&&s.isThrone(e,r)),S(1),T("ngIf",s.board[r][e]!==s.EMPTY)}}function I5t(n,t){if(1&n&&(F(),b(0,"g"),x(1,A5t,4,8,"g",2),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e)}}function x5t(n,t){if(1&n){const e=Oe();F(),b(0,"g")(1,"rect",17),ee("click",function(){const i=he(e).$implicit;return le(v().onClick(i.x,i.y))}),O()()}if(2&n){const e=t.$implicit,r=v();S(1),We("id","click_",e.x,"_",e.y,""),D("x",r.SPACE_SIZE*e.x)("y",r.SPACE_SIZE*e.y)("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)}}let k5t=(()=>{class n extends TH{constructor(e){super(e,!1,va.from),this.rules=O5.get(),this.availableMinimaxes=[new mP(this.rules,"DummyBot"),new vP(this.rules,"Piece > Influence"),new CP(this.rules,"Piece > Control"),new wH(this.rules,"Escape > Piece > Control")],this.encoder=va.encoder,this.tutorial=(new q3e).tutorial,this.updateBoard()}}return n.\u0275fac=function(e){return new(e||n)(J(Pn))},n.\u0275cmp=gt({type:n,selectors:[["app-tablut"]],features:[l],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["x","0","y","0",1,"base",3,"ngClass"],[4,"ngIf"],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60","class","base",4,"ngIf","ngIfElse"],["cornerThrone",""],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60",1,"base"],["x","15","y","15","width","70","height","70",1,"base"],[1,"base",3,"id","ngClass"],[4,"ngIf","ngIfElse"],["defender",""],[1,"base",3,"ngClass"],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85","class","base no-fill",3,"ngClass",4,"ngIf","ngIfElse"],["soldierDefender",""],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85",1,"base","no-fill",3,"ngClass"],[1,"no-fill","mid-stroke","clickable-stroke",3,"id","click"]],template:function(e,r){1&e&&(F(),b(0,"svg",0),x(1,I5t,2,1,"g",1),x(2,x5t,2,6,"g",1),O()),2&e&&(D("viewBox",r.getViewBox()),S(1),T("ngForOf",r.board),S(1),T("ngForOf",r.getClickables()))},dependencies:[dn,An,en],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class V2{constructor(t,e){this.owner=t,this.tileId=e}toString(){return`TrexoPiece(${this.owner.toString()}, ${this.tileId})`}}class zs{constructor(t){this.pieces=t}static from(t){let e=-1;for(const r of t)ve(e<r.tileId,"TrexoPieceStack: dropped turn should be ascending"),e=r.tileId;return new zs(t)}getHeight(){return this.pieces.length}getOwner(){const t=this.pieces.length;return 0===t?pe.NONE:this.pieces[t-1].owner}getUpperTileId(){const t=this.pieces.length;return 0===t?-1:this.pieces[t-1].tileId}add(t){return zs.from(this.pieces.concat(t))}getPieceAt(t){return ve(t<this.pieces.length,"no element "+t+"in piece!"),this.pieces[t]}isGround(){return-1===this.getUpperTileId()}toString(){return"["+this.pieces.map(t=>"("+t.toString()+")").join(" ")+"]"}}zs.EMPTY=zs.from([]);let ss=(()=>{class n extends es{static getInitialState(){const e=Ke.createTable(n.SIZE,n.SIZE,zs.EMPTY);return new n(e,0)}static from(e,r){ve(e.length===n.SIZE,"Invalid board dimensions");for(const s of e)ve(s.length===n.SIZE,"Invalid board dimensions");return U.success(new n(e,r))}drop(e,r){const s=this.getCopiedBoard(),i=new V2(r,this.turn);return s[e.y][e.x]=s[e.y][e.x].add(i),new n(s,this.turn)}incrementTurn(){return new n(this.getCopiedBoard(),this.turn+1)}toString(){return this.board.map(e=>"["+e.map(r=>"TrexoPieceStack.from("+r.toString()+")").join(", ")+"]").join("\n,")}getPieceAtXYZ(e,r,s){return this.getPieceAtXY(e,r).getPieceAt(s)}}return n.SIZE=10,n})(),QP=(()=>{class n{}return n.NON_NEIGHBORING_SPACES=()=>$localize`Those two spaces are not neighbors!`,n.NO_WAY_TO_DROP_IT_HERE=()=>$localize`There is no way to put a piece there!`,n.CANNOT_DROP_ON_ONLY_ONE_PIECE=()=>$localize`You cannot drop on only one piece!`,n.CANNOT_DROP_PIECE_ON_UNEVEN_GROUNDS=()=>$localize`You cannot drop a piece on uneven grounds!`,n})();class Ca extends Lc{constructor(t,e){super(t,e)}static from(t,e){return ve(t.isInRange(ss.SIZE,ss.SIZE),`${t.toString()} is out of the TrexoBoard!`),ve(e.isInRange(ss.SIZE,ss.SIZE),`${e.toString()} is out of the TrexoBoard!`),1===t.getOrthogonalDistance(e)?U.success(new Ca(t,e)):U.failure(QP.NON_NEIGHBORING_SPACES())}toString(){return this.getFirst().toString()+" && "+this.getSecond().toString()}equals(t){return this.getFirst().equals(t.getFirst())&&this.getSecond().equals(t.getSecond())}getZero(){return this.getFirst()}getOne(){return this.getSecond()}}Ca.encoder=Lc.getEncoder(Ca.from);class Yi extends U1{constructor(){super(ss)}static getOwner(t){return t.getOwner()}static isInRange(t){return t.isInRange(ss.SIZE,ss.SIZE)}static get(){return Yi.instance.isAbsent()&&(Yi.instance=P.of(new Yi)),Yi.instance.get()}applyLegalMove(t,e){return e.drop(t.getZero(),z.ZERO).drop(t.getOne(),z.ONE).incrementTurn()}isLegal(t,e){return this.isUnevenGround(t,e)?U.failure(QP.CANNOT_DROP_PIECE_ON_UNEVEN_GROUNDS()):this.landsOnOnlyOnePiece(t,e)?U.failure(QP.CANNOT_DROP_ON_ONLY_ONE_PIECE()):U.success(void 0)}isUnevenGround(t,e){const r=e.getPieceAt(t.getZero()),s=e.getPieceAt(t.getOne());return r.getHeight()!==s.getHeight()}landsOnOnlyOnePiece(t,e){const r=e.getPieceAt(t.getZero()),s=e.getPieceAt(t.getOne());return(-1!==r.getUpperTileId()||-1!==s.getUpperTileId())&&r.getUpperTileId()===s.getUpperTileId()}static getSquareScore(t,e){return Yi.TREXO_HELPER.getSquareScore(t,e)}static getVictoriousCoords(t){const e=[],r=[],s=t.getCurrentOpponent();for(const i of t.toMap()){const o=i.key,c=t.getPieceAt(o).getOwner();if(c.isPlayer()){const u=Yi.getSquareScore(t,o);$1.getScoreStatus(u)===yn.VICTORY&&(c===s?e.push(o):r.push(o))}}return r.length>0?r:e}getGameStatus(t){const e=t.gameState,r=e.getCurrentOpponent();let s=!1;for(const i of e.toMap()){const o=i.key,c=e.getPieceAt(o).getOwner();if(c.isPlayer()){const u=Yi.getSquareScore(e,o);if($1.getScoreStatus(u)===yn.VICTORY){if(c!==r)return xe.getDefeat(r);s=!0}}}return s?xe.getVictory(r):xe.ONGOING}getLegalMoves(t){const e=[];for(const r of t.toMap()){const s=r.key;if(s.x+1<ss.SIZE){const i=new M(s.x+1,s.y);e.push(...this.getPossiblesMoves(t,s,i))}if(s.y+1<ss.SIZE){const i=new M(s.x,s.y+1);e.push(...this.getPossiblesMoves(t,s,i))}}return e}getPossiblesMoves(t,e,r){const s=t.getPieceAt(e),i=t.getPieceAt(r);let o;o=!s.isGround()&&s.getUpperTileId()===i.getUpperTileId();const c=s.getHeight()!==i.getHeight();return o||c?[]:[Ca.from(e,r).get(),Ca.from(r,e).get()]}}Yi.instance=P.empty(),Yi.TREXO_HELPER=new yP(Yi.isInRange,Yi.getOwner,5);class L5t extends G1{getListMoves(t){return Yi.get().getLegalMoves(t.gameState)}getBoardValue(t){let e=0;const r=t.gameState,s=r.getCurrentOpponent();let i=!1;for(const o of r.toMap()){const c=r.getPieceAt(o.key).getOwner();if(c.isPlayer()){const u=Yi.getSquareScore(r,o.key);if($1.getScoreStatus(u)===yn.VICTORY){if(c!==s)return new Ct(s.getDefeatValue());i=!0}else e+=u}}return new Ct(i?s.getVictoryValue():e)}}const ue=zs.EMPTY,j3e=zs.from([new V2(z.ONE,0)]),R5t=zs.from([new V2(z.ZERO,0)]),D5t=zs.from([new V2(z.ONE,1)]),Z3e=zs.from([new V2(z.ZERO,1)]),z5t=zs.from([new V2(z.ZERO,2)]),V5t=zs.from([new V2(z.ONE,2)]),H5t=zs.from([new V2(z.ZERO,0),new V2(z.ZERO,3)]),F5t=zs.from([new V2(z.ONE,1),new V2(z.ONE,3)]),B5t=zs.from([new V2(z.ZERO,4)]),$5t=zs.from([new V2(z.ONE,4)]),U5t=zs.from([new V2(z.ZERO,5)]),G5t=zs.from([new V2(z.ONE,5)]),W5t=zs.from([new V2(z.ONE,6)]),q5t=zs.from([new V2(z.ZERO,6)]);class Y3e extends K1{constructor(){super(...arguments),this.tutorial=[ce.informational($localize`Goal of the game`,$localize`At Trexo, the goal of the game is to align 5 pieces of your color in a vertical, horizontal or diagonal line. However, the players play with tiles that are constituted of two pieces, one from each player!`,ss.getInitialState()),ce.anyMove($localize`Dropping a tile`,$localize`When you drop a tile, it needs to be on even ground, and it cannot be right on top of another tile. In others words, it needs to be either on the floor, or on two tiles at the same height. To drop a tile, just click on the square where you want to put the opponent side of the tile, then on the neighboring square where you want to put your piece.<br/><br/>You're playing Dark, put a tile on the board.`,ss.getInitialState(),Ca.from(new M(4,4),new M(3,4)).get(),$localize`Congratulations!`),ce.fromMove($localize`Dropping a piece over other pieces`,$localize`You can put a tile on other tiles. For that you must respect two rules:<br/><ul><li>The two pieces must be at the same height.</li><li>You cannot drop your piece on only one other piece.</li></ul><br/>You're playing Dark, do such a move!`,new ss([[ue,ue,ue,j3e,R5t,Z3e,D5t,ue,ue,ue],[ue,ue,ue,ue,ue,ue,ue,ue,ue,ue],[ue,ue,ue,ue,ue,ue,ue,ue,ue,ue],[ue,ue,ue,ue,ue,ue,ue,ue,ue,ue],[ue,ue,ue,ue,ue,ue,ue,ue,ue,ue],[ue,ue,ue,ue,ue,ue,ue,ue,ue,ue],[ue,ue,ue,ue,ue,ue,ue,ue,ue,ue],[ue,ue,ue,ue,ue,ue,ue,ue,ue,ue],[ue,ue,ue,ue,ue,ue,ue,ue,ue,ue],[ue,ue,ue,ue,ue,ue,ue,ue,ue,ue]],7),[Ca.from(new M(4,0),new M(5,0)).get(),Ca.from(new M(5,0),new M(4,0)).get()],$localize`Congratulations!`,$localize`Failed, you put that piece on the floor level, please put it on top of two pieces.`),ce.fromPredicate($localize`Victory`,$localize`To win at Trexo, you need to align 5 of your pieces. Only the piece on top counts, the hidden piece are no longer threats, and a victory can include pieces on differents heights. Since you have to put the piece of your opponent first, if you create a victory for them, you lose, even if you aligned 5 of your pieces too.<br/><br/>You're playing Light, win.`,new ss([[ue,ue,ue,ue,ue,ue,ue,ue,ue,ue],[ue,ue,ue,U5t,ue,ue,ue,ue,ue,ue],[ue,ue,ue,G5t,ue,ue,ue,ue,ue,ue],[ue,ue,ue,ue,j3e,ue,ue,B5t,$5t,ue],[ue,ue,ue,ue,H5t,F5t,Z3e,ue,ue,ue],[ue,ue,ue,ue,ue,z5t,W5t,q5t,ue,ue],[ue,ue,ue,ue,ue,V5t,ue,ue,ue,ue],[ue,ue,ue,ue,ue,ue,ue,ue,ue,ue],[ue,ue,ue,ue,ue,ue,ue,ue,ue,ue],[ue,ue,ue,ue,ue,ue,ue,ue,ue,ue]],7),Ca.from(new M(2,0),new M(2,1)).get(),(t,e,r)=>Yi.TREXO_HELPER.getSquareScore(r,t.getOne())===Number.MAX_SAFE_INTEGER?G.SUCCESS:G.failure($localize`Failed. Try again.`),$localize`Congratulations, you won!`)]}}function j5t(n,t){if(1&n){const e=Oe();F(),b(0,"g")(1,"polygon",5),ee("click",function(){const i=he(e).index,o=v().index;return le(v().onClick(i,o))}),O()()}if(2&n){const e=t.index,r=v().index,s=v();S(1),We("id","space_",e,"_",r,""),T("ngClass",s.getSpaceClasses(e,r)),D("points",s.getParallelogramPoints())("transform",s.getTranslate(e,r,0))}}function Z5t(n,t){if(1&n&&(F(),b(0,"g"),x(1,j5t,2,5,"g",1),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e)}}function Y5t(n,t){if(1&n){const e=Oe();F(),b(0,"g",8),ee("click",function(){he(e);const s=v().index,i=v().index;return le(v(2).onClick(s,i))}),O()}if(2&n){const e=v(),r=e.index,s=e.$implicit,i=v().index,o=v().index,c=v();j2("id","half_tile_",r,"_",i,"_",o,""),T("mode",c.mode)("coord",c.Coord3D.of(r,i,o))("mustDisplayHeight","2D"===c.chosenMode)("move",s.move.get())("pieceClasses",c.getPieceClasses(r,i,o)),D("transform",c.getTranslate(r,i,o+1))}}const K3e=function(n){return[n]};function K5t(n,t){if(1&n){const e=Oe();F(),b(0,"g",9),ee("click",function(){he(e);const s=v().index,i=v().index;return le(v(2).onClick(s,i))}),O()}if(2&n){const e=v().index,r=v().index,s=v().index,i=v();j2("id","dropped_piece_",e,"_",r,"_",s,""),T("mode",i.mode)("coord",i.Coord3D.of(e,r,s))("pieceClasses",P3(7,K3e,i.currentOpponentClass)),D("transform",i.getTranslate(e,r,s+1))}}function X5t(n,t){if(1&n&&(F(),b(0,"g"),x(1,Y5t,1,9,"g",6),x(2,K5t,1,9,"g",7),O()),2&n){const e=t.$implicit;S(1),T("ngIf",e.move.isPresent()),S(1),T("ngIf",e.isDroppedPiece)}}function Q5t(n,t){if(1&n&&(F(),b(0,"g"),x(1,X5t,3,2,"g",1),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e)}}function J5t(n,t){if(1&n&&(F(),b(0,"g"),x(1,Q5t,2,1,"g",1),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e)}}const e7t=function(){return["player0-fill"]};function t7t(n,t){if(1&n){const e=Oe();F(),b(0,"g",10),ee("click",function(){return he(e),le(v().switchToMode("3D"))}),O()}if(2&n){const e=v();T("mode",e.TrexoComponent.modeMap["3D"])("coord",e.Coord3D.of(10.5,8.5,0))("pieceClasses",rr(4,e7t)),D("transform",e.get3DSwitcherTransform())}}function n7t(n,t){if(1&n){const e=Oe();F(),b(0,"g",11),ee("click",function(){return he(e),le(v().switchToMode("2D"))}),O()}if(2&n){const e=v();T("mode",e.TrexoComponent.modeMap["2D"])("coord",e.Coord3D.of(12,9,0))("pieceClasses",P3(4,K3e,e.currentPlayerClass)),D("transform",e.getTranslate(12,9,0))}}class f1 extends m3e{constructor(t){super(t),this.TrexoComponent=f1,this.left=-this.STROKE_WIDTH/2,this.Coord3D=G4,this.up=0,this.chosenMode="3D",this.victoryCoords=[],this.droppedPiece=P.empty(),this.possibleNextClicks=[],this.possibleMoves=[],this.pieceOnBoard=[],this.currentOpponentClass="player1",this.currentPlayerClass="player0",this.rules=Yi.get(),this.availableMinimaxes=[new L5t(this.rules,"TrexoMinimax")],this.encoder=Ca.encoder,this.tutorial=(new Y3e).tutorial,f1.STROKE_WIDTH=this.STROKE_WIDTH,this.switchToMode("3D"),this.updateBoard()}switchToMode(t){this.chosenMode=t,this.width=this.getViewBoxWidth(),this.up=this.getViewBoxUp(),this.height=this.getViewBoxHeight(),this.mode=f1.modeMap[t]}getViewBoxWidth(){const t=f1.modeMap["3D"],e=ss.SIZE;return"2D"===this.chosenMode?(e+1)*this.SPACE_SIZE+2*this.STROKE_WIDTH:e*(this.SPACE_SIZE*(t.horizontalWidthRatio+t.offsetRatio))+this.STROKE_WIDTH}getViewBoxHeight(){const e=ss.SIZE*this.SPACE_SIZE;return"2D"===this.chosenMode?e:this.STROKE_WIDTH+e+this.getHigherStackHeight()}getViewBoxUp(){if("2D"===this.chosenMode)return 0;{const t=this.getHigherStackHeight();return-(this.STROKE_WIDTH/2+t)}}getHigherStackHeight(){return(this.pieceOnBoard.length+1)*f1.modeMap[this.chosenMode].pieceHeightRatio*this.SPACE_SIZE}updateBoard(){const t=this.getState();this.board=t.getCopiedBoard(),this.currentOpponentClass=this.getPlayerClass(t.getCurrentOpponent()),this.currentPlayerClass=this.getPlayerClass(t.getCurrentPlayer()),this.possibleMoves=this.rules.getLegalMoves(t),this.victoryCoords=Yi.getVictoriousCoords(t),this.pieceOnBoard=this.get3DBoard(),this.height=this.getViewBoxHeight(),this.up=this.getViewBoxUp()}get3DBoard(){const t=Ke.create3DTable(1,ss.SIZE,ss.SIZE,f1.INITIAL_PIECE_ON_BOARD);let e=1;for(let r=0;r<=e;r++)for(const s of this.getState().toMap()){const i=s.key,o=s.value.getHeight();if(e=Math.max(e,o),r<o){const c=this.extractMoveFromState(i.x,i.y,r);this.addMoveToArray(r,c,t)}}return t}extractMoveFromState(t,e,r){const s=this.getState().getPieceAtXYZ(t,e,r),i=new M(t,e);let o=new M(-2,-2);for(const c of Ne.ORTHOGONALS){const u=i.getNext(c);if(u.isInRange(ss.SIZE,ss.SIZE)){const h=this.getState().getPieceAt(u);h.getHeight()>r&&h.getPieceAt(r).tileId===s.tileId&&(o=u)}}return s.owner===z.ZERO?Ca.from(i,o).get():Ca.from(o,i).get()}addMoveToArray(t,e,r){for(;r.length<=t;)r.push(Ke.createTable(ss.SIZE,ss.SIZE,f1.INITIAL_PIECE_ON_BOARD));r[t][e.getZero().y][e.getZero().x]={isDroppedPiece:!1,isPossibleClick:!1,move:P.of(e)},r[t][e.getOne().y][e.getOne().x]={isDroppedPiece:!1,isPossibleClick:!1,move:P.of(e)}}onClick(t,e){var r=this;return A(function*(){const s=r.canUserPlay("#space_"+t+"_"+e);if(s.isFailure())return r.cancelMove(s.getReason());const i=new M(t,e);if(r.droppedPiece.isPresent()){const o=r.droppedPiece.get();if(r.droppedPiece.equalsValue(i))return r.cancelMoveAttempt(),G.SUCCESS;if(r.possibleNextClicks.some(c=>c.equals(i))){const c=r.getState().getCurrentPlayer()===z.ZERO,p=Ca.from(c?i:o,c?o:i).get();return r.chooseMove(p,r.getState())}r.deselectPiece()}return r.selectPiece(i)})()}deselectPiece(){const t=this.getState().getPieceAt(this.droppedPiece.get()).getHeight(),e=this.droppedPiece.get().y,r=this.droppedPiece.get().x;this.pieceOnBoard[t][e][r]=f1.INITIAL_PIECE_ON_BOARD;for(const s of this.possibleNextClicks)this.pieceOnBoard[t][s.y][s.x].isPossibleClick=!1}selectPiece(t){if(this.possibleMoves.some(e=>e.getZero().equals(t))){const e=this.getState().getPieceAt(t).getHeight();return e>=this.pieceOnBoard.length&&this.pieceOnBoard.push(Ke.createTable(ss.SIZE,ss.SIZE,f1.INITIAL_PIECE_ON_BOARD)),this.showDroppedPieceAndIndicators(t,e),G.SUCCESS}return this.cancelMove(QP.NO_WAY_TO_DROP_IT_HERE())}showDroppedPieceAndIndicators(t,e){this.droppedPiece=P.of(t),this.possibleNextClicks=this.getPossibleNextClicks(t);for(const r of this.possibleNextClicks)this.pieceOnBoard[e][r.y][r.x]={isDroppedPiece:!1,isPossibleClick:!0,move:P.empty()};this.pieceOnBoard[e][t.y][t.x]={isDroppedPiece:!0,isPossibleClick:!1,move:P.empty()}}getPossibleNextClicks(t){return this.possibleMoves.filter(r=>r.getZero().equals(t)).map(r=>r.getOne())}cancelMoveAttempt(){this.droppedPiece=P.empty(),this.possibleNextClicks=[],this.updateBoard()}getPieceClasses(t,e,r){const s=new M(t,e),i=this.getState().getPieceAtXYZ(t,e,r).owner;let o=[this.getPlayerClass(i)];o=o.concat(this.getSpaceClasses(t,e));for(const c of this.victoryCoords)if(c.equals(s)){o.push("victory-stroke");break}if(this.rules.node.move.isPresent()){const c=this.rules.node.move.get();(c.getZero().equals(s)||c.getOne().equals(s))&&o.push("last-move-stroke")}return o}getSpaceClasses(t,e){for(const r of this.pieceOnBoard)if(r[e][t].isPossibleClick)return["darker"];return[]}getTranslate(t,e,r){const i=this.getCoordTranslate(t,e,r,f1.modeMap[this.chosenMode]);return"translate("+i.x+" "+i.y+")"}getParallelogramPoints(){return this.getParallelogramCoordsForTrexo().map(e=>e.x+" "+e.y).join(" ")}getParallelogramCoordsForTrexo(){return this.getParallelogramCoords(f1.modeMap[this.chosenMode])}get3DSwitcherTransform(){const t=f1.modeMap["3D"],e=t.horizontalWidthRatio+t.offsetRatio;return"translate("+(10+t.offsetRatio)*t.parallelogramHeight+", "+(9+(1-1/e)/2)*t.parallelogramHeight+") scale("+1/e+")"}}f1.VERBOSE=!1,f1.INITIAL_PIECE_ON_BOARD={isDroppedPiece:!1,isPossibleClick:!1,move:P.empty()},f1.modeMap={"2D":{offsetRatio:0,horizontalWidthRatio:1,pieceHeightRatio:0,parallelogramHeight:100,abstractBoardSize:10},"3D":{offsetRatio:.4,horizontalWidthRatio:1.2,pieceHeightRatio:.2,parallelogramHeight:100,abstractBoardSize:10}},f1.\u0275fac=function(t){return new(t||f1)(J(Pn))},f1.\u0275cmp=gt({type:f1,selectors:[["app-trexo"]],features:[l],decls:8,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%"],[4,"ngFor","ngForOf"],["switchModeIndicator",""],["id","switchTo3D","mgp-trexo-half-piece","",3,"mode","coord","pieceClasses","click",4,"ngIf","ngIfElse"],["switchTo2D",""],[1,"base",3,"id","ngClass","click"],["mgp-trexo-half-piece","",3,"id","mode","coord","mustDisplayHeight","move","pieceClasses","click",4,"ngIf"],["mgp-trexo-half-piece","",3,"mode","id","coord","pieceClasses","click",4,"ngIf"],["mgp-trexo-half-piece","",3,"id","mode","coord","mustDisplayHeight","move","pieceClasses","click"],["mgp-trexo-half-piece","",3,"mode","id","coord","pieceClasses","click"],["id","switchTo3D","mgp-trexo-half-piece","",3,"mode","coord","pieceClasses","click"],["mgp-trexo-half-piece","","id","switchTo2D",3,"mode","coord","pieceClasses","click"]],template:function(t,e){if(1&t&&(F(),b(0,"svg",0),x(1,Z5t,2,1,"g",1),x(2,J5t,2,1,"g",1),b(3,"g",null,2),x(5,t7t,1,5,"g",3),x(6,n7t,1,6,"ng-template",null,4,r1),O()()),2&t){const r=Qn(7);D("viewBox",e.left+" "+e.up+" "+e.width+" "+e.height),S(1),T("ngForOf",e.board),S(1),T("ngForOf",e.pieceOnBoard),S(3),T("ngIf","2D"===e.chosenMode)("ngIfElse",r)}},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});class Lr{}Lr.PLACEMENT_AFTER_INITIAL_PHASE=()=>$localize`You cannot put a new ring after the tenth turn.`,Lr.NO_MARKERS_IN_INITIAL_PHASE=()=>$localize`You cannot put a marker in a ring before placing all of your rings.`,Lr.MISSING_CAPTURES=Bc.MISSING_CAPTURES,Lr.MOVE_DIRECTION_INVALID=()=>$localize`The direction of your move is invalid: a move is made along a straight line.`,Lr.CAN_ONLY_CAPTURE_YOUR_MARKERS=()=>$localize`You can only capture your own markers.`,Lr.SHOULD_SELECT_PLAYER_RING=()=>$localize`You must pick one of your own rings to move.`,Lr.SHOULD_END_MOVE_ON_EMPTY_SPACE=()=>$localize`Your ring must land on an empty space.`,Lr.MOVE_SHOULD_NOT_PASS_ABOVE_RING=()=>$localize`A ring can only jump over markers or empty spaces, not over another ring.`,Lr.MOVE_SHOULD_END_AT_FIRST_EMPTY_SPACE_AFTER_MARKERS=()=>$localize`Your ring must land on the first empty space after a group of markers.`,Lr.AMBIGUOUS_CAPTURE_COORD=Bc.AMBIGUOUS_CAPTURE_COORD,Lr.CAPTURE_SHOULD_TAKE_RING=()=>$localize`When you capture markers, you must take one of your ring as well by clicking on it.`;class bt{constructor(t,e){this.player=t,this.isRing=e}static of(t,e){return t===pe.NONE?bt.EMPTY:e?bt.RINGS[t.value]:bt.MARKERS[t.value]}equals(t){return this===t}flip(){return ve(!1===this.isRing,"cannot flip a ring (it should never happen)"),ve(this.player.isPlayer(),"cannot flip a non-player piece"),bt.of(this.player.getOpponent(),this.isRing)}toString(){switch(this){case bt.UNREACHABLE:return"NONE";case bt.EMPTY:return"EMPTY";case bt.MARKER_ZERO:return"MARKER_ZERO";case bt.MARKER_ONE:return"MARKER_ONE";case bt.RING_ZERO:return"RING_ZERO";default:return Me.expectToBe(this,bt.RING_ONE),"RING_ONE"}}}bt.encoder=Cn.tuple([z.numberEncoder,Cn.booleanEncoder],n=>[n.player,n.isRing],n=>bt.of(n[0],n[1])),bt.UNREACHABLE=new bt(pe.NONE,!1),bt.EMPTY=new bt(pe.NONE,!1),bt.MARKER_ZERO=new bt(z.ZERO,!1),bt.MARKER_ONE=new bt(z.ONE,!1),bt.MARKERS=[bt.MARKER_ZERO,bt.MARKER_ONE],bt.RING_ZERO=new bt(z.ZERO,!0),bt.RING_ONE=new bt(z.ONE,!0),bt.RINGS=[bt.RING_ZERO,bt.RING_ONE];let rc=(()=>{class n extends OH{constructor(e,r,s){super(s,e,n.SIZE,n.SIZE,[6,4,3,2,1],bt.EMPTY),this.sideRings=r}static getInitialState(){const e=bt.EMPTY,r=bt.UNREACHABLE;return new n([[r,r,r,r,r,r,e,e,e,e,r],[r,r,r,r,e,e,e,e,e,e,e],[r,r,r,e,e,e,e,e,e,e,e],[r,r,e,e,e,e,e,e,e,e,e],[r,e,e,e,e,e,e,e,e,e,e],[r,e,e,e,e,e,e,e,e,e,r],[e,e,e,e,e,e,e,e,e,e,r],[e,e,e,e,e,e,e,e,e,r,r],[e,e,e,e,e,e,e,e,r,r,r],[e,e,e,e,e,e,e,r,r,r,r],[r,e,e,e,e,r,r,r,r,r,r]],[5,5],0)}isInitialPlacementPhase(){return this.turn<10}countScores(){return this.turn<10?[0,0]:this.sideRings}equals(e){return this===e||this.turn===e.turn&&this.sideRings[0]===e.sideRings[0]&&this.sideRings[1]===e.sideRings[1]&&Ke.compareTable(this.board,e.board)}getRingCoords(e){const r=[];return this.forEachCoord((s,i)=>{i.isRing&&i.player===e&&r.push(s)}),r}isOnBoard(e){return!e.isNotInRange(this.width,this.height)&&this.board[e.y][e.x]!==bt.UNREACHABLE}setAtUnsafe(e,r){const s=Ke.copyBiArray(this.board);return s[e.y][e.x]=r,new n(s,this.sideRings,this.turn)}}return n.SIZE=11,n})();class ya extends Mi{constructor(t,e){if(super(t),5!==t.length)throw new Error("YinshCapture must capture exactly 5 pieces");this.ringTaken=P.ofNullable(e)}static of(t,e,r){const s=[],i=Le.factory.fromMove(t,e).get();for(let o=t;!1===o.equals(e);o=o.getNext(i))s.push(o);return s.push(e),new ya(s,r)}setRingTaken(t){return new ya(this.capturedSpaces,t)}equals(t){return!(!1===super.equals(t)||!1===this.ringTaken.equals(t.ringTaken))}}ya.encoder=new class extends k4{encode(n){return{captured:n.capturedSpaces.map(t=>M.encoder.encode(t)),ringTaken:M.encoder.encode(n.ringTaken.get())}}decode(n){const t=n;return ve(null!=t.captured&&null!=t.ringTaken,"Invalid encoded YinshCapture"),new ya(t.captured.map(e=>M.encoder.decode(e)),M.encoder.decode(t.ringTaken))}};class sc extends Gi{constructor(t,e,r,s){super(),this.initialCaptures=t,this.start=e,this.end=r,this.finalCaptures=s}isInitialPlacement(){return this.end.isAbsent()}equals(t){return this===t||!(!1===this.start.equals(t.start)||!1===this.end.equals(t.end)||!1===Ke.compareArray(this.initialCaptures,t.initialCaptures)||!1===Ke.compareArray(this.finalCaptures,t.finalCaptures))}toString(){return"YinshMove(["+this.capturesToString(this.initialCaptures)+"], "+this.start.toString()+", "+this.end.toString()+", ["+this.capturesToString(this.finalCaptures)+"])"}capturesToString(t){let e="";for(const r of t)""!==e&&(e+=","),e+="["+r.toString()+"]";return e}}sc.coordOptionalEncoder=P.getEncoder(M.encoder),sc.encoder=new class extends mi{encodeMove(n){const t={moveStart:M.encoder.encode(n.start),moveEnd:sc.coordOptionalEncoder.encode(n.end)};return n.initialCaptures.map((e,r)=>{t["initialCapture"+r]=ya.encoder.encode(e)}),n.finalCaptures.map((e,r)=>{t["finalCapture"+r]=ya.encoder.encode(e)}),t}decodeMove(n){const t=n;return ve(null!=t.moveStart,"Invalid encoded YinshMove"),new sc(this.decodeArray(t,"initialCapture",ya.encoder.decode),M.encoder.decode(t.moveStart),sc.coordOptionalEncoder.decode(t.moveEnd),this.decodeArray(t,"finalCapture",ya.encoder.decode))}decodeArray(n,t,e){const r=[];for(let s=0;null!=n[t+s];s++)r.push(e(n[t+s]));return r}};class s7t extends G1{getBoardValue(t){const e=this.ruler.getGameStatus(t);return e.isEndGame?Ct.fromWinner(e.winner):Ct.from(t.gameState.sideRings[0],t.gameState.sideRings[1])}getListMoves(t){const e=[],r=t.gameState;if(r.isInitialPlacementPhase())for(const{coord:s,content:i}of r.getCoordsAndContents())i===bt.EMPTY&&e.push(new sc([],s,P.empty(),[]));else{const s=this.ruler;this.getPossibleCaptureCombinations(r).forEach(i=>{const o=s.applyCaptures(i,r);this.getRingMoves(o).forEach(c=>{const u=s.applyRingMoveAndFlip(c.start,c.end,o);this.getPossibleCaptureCombinations(u).forEach(h=>{const p=new sc(i,c.start,P.of(c.end),h);e.push(p)})})})}return e}getPossibleCaptureCombinations(t){const r=this.ruler.getPossibleCaptures(t),s=this.getRingCoords(t);return Bm.getPossibleCaptureCombinationsFromPossibleCaptures(r).map(i=>class r7t{static getCombinations(t,e){return ve(t.length>=e,"cannot compute combinations for less elements than needed"),this.getSubsetsOfSize(t,e).map(r=>this.getPermutations(r)).reduce((r,s)=>r.concat(s))}static getPermutations(t){const e=t.length,r=[t.slice()],s=new Array(e).fill(0);let i=1;for(;i<e;)if(s[i]<i){const o=i%2&&s[i],c=t[i];t[i]=t[o],t[o]=c,++s[i],i=1,r.push(t.slice())}else s[i]=0,++i;return r}static getSubsetsOfSize(t,e){return function r(s,i){if(i>=t.length||s<1)return[[]];{const o=[];for(;i<=t.length-s;){const c=t[i];for(const u of r(s-1,i+1))u.push(c),o.push(u);++i}return o}}(e,0)}}.getCombinations(s,i.length).map(o=>i.map((c,u)=>new ya(c.capturedSpaces,o[u])))).reduce((i,o)=>i.concat(o),[])}getRingMoves(t){const e=this.ruler,r=[];for(const s of this.getRingCoords(t))for(const i of e.getRingTargets(t,s))r.push({start:s,end:i});return r}getRingCoords(t){const e=t.getCurrentPlayer().value,r=[];return t.forEachCoord((s,i)=>{i===bt.RINGS[e]&&r.push(s)}),r}}class X3e extends U1{applyLegalMove(t,e,r){return new rc(r.board,r.sideRings,r.turn+1)}applyCaptures(t,e){let r=e;return t.forEach(s=>{r=this.applyCapture(s,r)}),r}applyCapture(t,e){const r=this.applyCaptureWithoutTakingRing(e,t);return this.takeRing(new rc(r,e.sideRings,e.turn),t.ringTaken.get())}takeRing(t,e){const r=t.getCurrentPlayer().value,s=t.setAt(e,bt.EMPTY).board,i=[t.sideRings[0],t.sideRings[1]];return i[r]+=1,new rc(s,i,t.turn)}applyCaptureWithoutTakingRing(t,e){return e.forEach(r=>{t=t.setAt(r,bt.EMPTY)}),t.board}ringSelectionValidity(t,e){const r=t.getCurrentPlayer().value;return t.getPieceAt(e)===bt.RINGS[r]?G.SUCCESS:G.failure(Lr.CAPTURE_SHOULD_TAKE_RING())}applyRingMoveAndFlip(t,e,r){const s=r.getCurrentPlayer().value;let i=r.setAt(t,bt.MARKERS[s]);i=i.setAt(e,bt.RINGS[s]);const o=Le.factory.fromMove(t,e).get();for(let c=t.getNext(o);!1===c.equals(e);c=c.getNext(o)){const u=i.getPieceAt(c);u!==bt.EMPTY&&(i=i.setAt(c,u.flip()))}return i}isLegal(t,e){if(t.isInitialPlacement())return this.initialPlacementValidity(e,t.start);if(e.isInitialPlacementPhase())return U.failure(Lr.NO_MARKERS_IN_INITIAL_PHASE());const r=this.capturesValidity(e,t.initialCaptures);if(r.isFailure())return r.toFailedFallible();const s=this.applyCaptures(t.initialCaptures,e),i=this.moveValidity(s,t.start,t.end.get());if(i.isFailure())return i.toFailedFallible();const o=this.applyRingMoveAndFlip(t.start,t.end.get(),s),c=this.capturesValidity(o,t.finalCaptures);if(c.isFailure())return c.toFailedFallible();const u=this.applyCaptures(t.finalCaptures,o),h=this.noMoreCapturesValidity(u);return h.isFailure()?h.toFailedFallible():U.success(u)}initialPlacementValidity(t,e){if(!0!==t.isInitialPlacementPhase())return U.failure(Lr.PLACEMENT_AFTER_INITIAL_PHASE());if(t.getPieceAt(e)!==bt.EMPTY)return U.failure(tt.MUST_CLICK_ON_EMPTY_SPACE());const r=t.getCurrentPlayer(),s=[t.sideRings[0],t.sideRings[1]];s[r.value]-=1;const i=t.setAt(e,bt.of(r,!0)).board,o=new rc(i,s,t.turn);return U.success(o)}moveStartValidity(t,e){const r=t.getCurrentPlayer().value;return t.getPieceAt(e)!==bt.RINGS[r]?G.failure(Lr.SHOULD_SELECT_PLAYER_RING()):G.SUCCESS}moveValidity(t,e,r){const s=this.moveStartValidity(t,e);if(s.isFailure())return s;if(t.getPieceAt(r)!==bt.EMPTY)return G.failure(Lr.SHOULD_END_MOVE_ON_EMPTY_SPACE());const i=Le.factory.fromMove(e,r);if(i.isFailure())return G.failure(Lr.MOVE_DIRECTION_INVALID());const o=i.get();let c=!1;for(let u=e.getNext(o);!1===u.equals(r);u=u.getNext(o)){const h=t.getPieceAt(u);if(h===bt.EMPTY){if(c)return G.failure(Lr.MOVE_SHOULD_END_AT_FIRST_EMPTY_SPACE_AFTER_MARKERS())}else{if(h.isRing)return G.failure(Lr.MOVE_SHOULD_NOT_PASS_ABOVE_RING());c=!0}}return G.SUCCESS}capturesValidity(t,e){let r=t;for(const s of e){const i=this.captureValidity(r,s);if(i.isFailure())return i;r=this.applyCapture(s,r)}return G.SUCCESS}captureValidity(t,e){const r=t.getCurrentPlayer().value;for(const s of e.capturedSpaces)if(t.getPieceAt(s)!==bt.MARKERS[r])return G.failure(Lr.CAN_ONLY_CAPTURE_YOUR_MARKERS());return t.getPieceAt(e.ringTaken.get())!==bt.RINGS[r]?G.failure(Lr.CAPTURE_SHOULD_TAKE_RING()):G.SUCCESS}noMoreCapturesValidity(t){const e=t.getCurrentPlayer();return 0===this.getLinePortionsWithAtLeastFivePiecesOfPlayer(t,e).length?G.SUCCESS:G.failure(Lr.MISSING_CAPTURES())}getLinePortionsWithAtLeastFivePiecesOfPlayer(t,e){const r=[];return t.allLines().forEach(s=>{const i=this.getLinePortionWithAtLeastFivePiecesOfPlayer(t,e,s);i.isPresent()&&r.push(i.get())}),r}getLinePortionWithAtLeastFivePiecesOfPlayer(t,e,r){let s=0;const i=t.getEntranceOnLine(r),o=r.getDirection();let u,c=i;for(u=i;t.isOnBoard(u);u=u.getNext(o)){const h=t.getPieceAt(u);if(h.player===e&&!1===h.isRing)0===s&&(c=u),s+=1;else{if(s>=5)break;s=0}}return s>=5?P.of({start:c,end:u,dir:o}):P.empty()}getPossibleCaptures(t){const e=t.getCurrentPlayer(),r=[];return this.getLinePortionsWithAtLeastFivePiecesOfPlayer(t,e).forEach(s=>{for(let i=s.start;i.getDistance(s.end)>=5;i=i.getNext(s.dir))r.push(ya.of(i,i.getNext(s.dir,4)))}),r}getRingTargets(t,e){const r=[];for(const s of Le.factory.all){let i=!1;for(let o=e.getNext(s);t.isOnBoard(o);o=o.getNext(s)){const c=t.getPieceAt(o);if(c===bt.EMPTY){if(r.push(o),i)break}else{if(c.isRing)break;i=!0}}}return r}getGameStatus(t){return t.gameState.isInitialPlacementPhase()?xe.ONGOING:t.gameState.sideRings[0]>=3?xe.ZERO_WON:t.gameState.sideRings[1]>=3?xe.ONE_WON:xe.ONGOING}}const q=bt.EMPTY,Te=bt.UNREACHABLE,Ki=bt.MARKER_ZERO,ao=bt.RING_ZERO,Z4=bt.MARKER_ONE,bi=bt.RING_ONE;let Q3e=(()=>{class n{}return n.MUST_ALIGN_FIVE=()=>$localize`Failed! You need to align 5 markers of your color in order to get them, and to get a ring at the same time.`,n.MUST_CAPTURE_TWO=()=>$localize`Failed! You can capture two rings in total, by capturing two times 5 of your markers. Try again.`,n})();class J3e extends K1{constructor(){super(...arguments),this.tutorial=[ce.informational($localize`Goal of the game`,$localize`The goal at Yinsh is to capture three rings in total.
        The rings taken are shown on the top left for the dark player,
        and on the bottom right for the light player. Here, Dark won the game.
        Note that on the board you have two types of pieces for each player:
        rings (empty circles) and markers (full circles).`,new rc([[Te,Te,Te,Te,Te,Te,q,q,q,q,Te],[Te,Te,Te,Te,q,q,q,q,q,q,q],[Te,Te,Te,Ki,bi,q,q,q,q,q,q],[Te,Te,q,Ki,q,bi,q,Z4,q,q,q],[Te,q,ao,Z4,q,q,bi,Ki,q,q,q],[Te,q,q,Ki,Z4,q,q,q,q,q,Te],[q,q,q,Ki,q,q,q,bi,q,q,Te],[q,q,q,Z4,Ki,ao,q,q,q,Te,Te],[q,q,q,q,q,q,q,q,Te,Te,Te],[q,q,q,q,q,q,q,Te,Te,Te,Te],[Te,q,q,q,q,Te,Te,Te,Te,Te,Te]],[3,1],20)),ce.anyMove($localize`Initial board and placement phase`,$localize`The initial board is empty.
        At the beginning of the game, each player puts one of its ring on the board at their turn.
        This phase stops when all rings have been placed on the board.<br/><br/>
        You're playing Dark, put one of your ring on the board by clicking the space where you want to place it.`,new rc(rc.getInitialState().board,[5,5],0),new sc([],new M(5,5),P.empty(),[]),$localize`Congratulations!`),ce.anyMove($localize`Putting a marker`,$localize`Once the initial phase is done and all rings are on the board, you need to place markers on the board.
        To do so, put a marker in a ring by clicking on that ring.
        Then, the ring must be moved in a straight line, in any direction.
        A ring cannot pass through other rings during its move.
        If it goes over a group of markers, your move must stop at the first empty space after that group.
        All markers in the group are then flipped and their color change.<br/><br/>
        You're playing Dark, do a move.`,new rc([[Te,Te,Te,Te,Te,Te,q,q,q,q,Te],[Te,Te,Te,Te,q,q,q,q,q,q,q],[Te,Te,Te,bi,q,q,q,q,q,q,q],[Te,Te,bi,q,q,bi,q,q,q,q,q],[Te,q,ao,Z4,q,q,bi,q,q,q,q],[Te,q,q,Z4,q,q,q,q,q,q,Te],[q,q,q,q,ao,q,q,bi,q,q,Te],[q,q,q,q,q,ao,q,q,q,Te,Te],[q,q,q,ao,q,q,q,Te,Te,Te,Te],[q,q,q,q,q,q,q,Te,Te,Te,Te],[Te,q,q,q,q,Te,Te,Te,Te,Te,Te]],[0,0],20),new sc([],new M(2,4),P.of(new M(4,4)),[]),$localize`Congratulations!`),ce.fromPredicate($localize`Getting a ring by aligning 5 markers`,$localize`Finally, the last mechanic you need is to be able to get a ring from the board in order to gain points.
        To do so, you need to align 5 markers of your color.
        You can then get these markers by clicking on them, and then get one of your ring by clicking on it.
        You will then have one more point.
        You must capture when you can.<br/><br/>
        You're playing Dark, perform a capture!`,new rc([[Te,Te,Te,Te,Te,Te,q,q,q,q,Te],[Te,Te,Te,Te,q,q,q,q,q,q,q],[Te,Te,Te,bi,q,q,q,q,q,q,q],[Te,Te,bi,q,q,bi,q,q,q,q,q],[Te,q,Ki,Ki,ao,Z4,Z4,q,q,q,q],[Te,q,q,bi,q,q,q,q,q,q,Te],[q,q,q,q,ao,q,q,bi,q,q,Te],[q,q,q,q,q,ao,q,q,q,Te,Te],[q,q,q,ao,q,q,q,ao,Te,Te,Te],[q,q,q,q,q,q,q,Te,Te,Te,Te],[Te,q,q,q,q,Te,Te,Te,Te,Te,Te]],[0,0],20),new sc([],new M(4,4),P.of(new M(7,4)),[ya.of(new M(2,4),new M(6,4),new M(7,4))]),(t,e,r)=>1===r.sideRings[z.ZERO.value]?G.SUCCESS:G.failure(Q3e.MUST_ALIGN_FIVE()),$localize`Congratulations!`),ce.fromPredicate($localize`Compound captures`,$localize`During a turn, you could have to choose between multiple captures,
        or you could even capture multiple times!
        During the capture selection, if you see that the marker you clicked belongs to two captures, you have to click on a second marker to avoid any ambiguity.<br/><br/>
        Here, playing Dark, you can capture two rings, do it!`,new rc([[Te,Te,Te,Te,Te,Te,q,q,q,q,Te],[Te,Te,Te,Te,ao,q,q,bi,bi,ao,q],[Te,Te,Te,ao,q,q,Z4,bi,q,ao,q],[Te,Te,q,ao,q,q,q,q,q,bi,q],[Te,q,q,q,q,Ki,q,q,bi,q,q],[Te,q,q,q,Ki,Ki,q,Z4,q,q,Te],[q,q,q,Ki,q,Ki,q,q,q,q,Te],[q,q,Ki,q,q,Ki,q,q,q,Te,Te],[q,Ki,q,q,q,Ki,q,q,Te,Te,Te],[q,q,q,q,q,Ki,q,Te,Te,Te,Te],[Te,q,q,q,q,Te,Te,Te,Te,Te,Te]],[0,0],10),new sc([ya.of(new M(5,4),new M(1,8),new M(3,2)),ya.of(new M(5,9),new M(5,5),new M(3,3))],new M(4,1),P.of(new M(4,2)),[]),(t,e,r)=>2===r.sideRings[z.ZERO.value]?G.SUCCESS:G.failure(Q3e.MUST_CAPTURE_TWO()),$localize`Congratulations!`)]}}function i7t(n,t){if(1&n&&(F(),Q(0,"circle",12)),2&n){const e=v(2).$implicit,r=v(2);D("cx",e.center.x)("cy",e.center.y)("r",r.viewInfo.ringOuterSize)}}function o7t(n,t){if(1&n&&(F(),Q(0,"circle",13)),2&n){const e=v(2),r=e.index,s=e.$implicit,i=v().index,o=v();We("id","ring_",r,"_",i,""),T("ngClass",s.ringClasses),D("cx",s.center.x)("cy",s.center.y)("r",o.viewInfo.ringMidSize)}}function a7t(n,t){if(1&n&&(F(),Q(0,"circle",12)),2&n){const e=v(2).$implicit,r=v(2);D("cx",e.center.x)("cy",e.center.y)("r",r.viewInfo.ringInnerSize)}}function c7t(n,t){if(1&n&&(F(),Q(0,"circle",14)),2&n){const e=v(2),r=e.index,s=e.$implicit,i=v().index,o=v();We("id","marker_",r,"_",i,""),T("ngClass",s.markerClasses),D("cx",s.center.x)("cy",s.center.y)("r",o.viewInfo.markerSize)}}function l7t(n,t){if(1&n){const e=Oe();F(),b(0,"g",6),ee("click",function(){he(e);const s=v().$implicit;return le(v(2).onClick(s.coord))}),Q(1,"polygon",7),b(2,"g",8),x(3,i7t,1,3,"circle",9),x(4,o7t,1,6,"circle",10),x(5,a7t,1,3,"circle",9),x(6,c7t,1,6,"circle",11),O()()}if(2&n){const e=v(),r=e.index,s=e.$implicit,i=v().index;We("id","click_",r,"_",i,""),S(1),We("id","space_",r,"_",i,""),T("ngClass",s.spaceClasses),D("points",s.coordinates),S(1),We("id","pieceGroup_",r,"_",i,""),T("ngClass",s.removedClass),S(1),T("ngIf",s.isRing),S(1),T("ngIf",s.isRing),S(1),T("ngIf",s.isRing),S(1),T("ngIf",s.isMarker)}}function u7t(n,t){if(1&n&&(F(),b(0,"g"),x(1,l7t,7,13,"g",5),O()),2&n){const e=t.$implicit;S(1),T("ngIf",null!=e)}}function f7t(n,t){if(1&n&&(F(),b(0,"g"),x(1,u7t,2,1,"g",1),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e)}}function h7t(n,t){if(1&n){const e=Oe();F(),b(0,"polygon",15),ee("click",function(){const i=he(e).$implicit;return le(v().onClick(i))}),O()}if(2&n){const e=t.$implicit,r=v();We("id","selected_",e.x,"_",e.y,""),D("points",r.viewInfo.spaceInfo[e.y][e.x].coordinates)}}function d7t(n,t){if(1&n){const e=Oe();F(),b(0,"polygon",17),ee("click",function(){const i=he(e).$implicit;return le(v(2).onClick(i))}),O()}if(2&n){const e=t.$implicit,r=v(2);We("id","selectable_",e.x,"_",e.y,""),D("points",r.viewInfo.spaceInfo[e.y][e.x].coordinates)}}function p7t(n,t){if(1&n&&(F(),b(0,"g"),x(1,d7t,1,3,"polygon",16),O()),2&n){const e=v();S(1),T("ngForOf",e.viewInfo.selectableCoords)}}function g7t(n,t){if(1&n){const e=Oe();F(),b(0,"rect",18),ee("click",function(){const i=he(e).$implicit;return le(v().onClick(i))}),O()}if(2&n){const e=t.$implicit,r=v();We("id","indicator_",e.x,"_",e.y,""),D("x",r.viewInfo.spaceInfo[e.y][e.x].center.x-r.viewInfo.indicatorSize/2)("y",r.viewInfo.spaceInfo[e.y][e.x].center.y-r.viewInfo.indicatorSize/2)("width",r.viewInfo.indicatorSize)("height",r.viewInfo.indicatorSize)}}function m7t(n,t){if(1&n&&(F(),b(0,"g"),Q(1,"circle",19)(2,"circle",12)(3,"circle",20),O()),2&n){const e=t.index,r=v().$implicit,s=v();S(1),We("id","player_",r.value,"_sideRing_",e+1,""),D("cx",(0===r.value?15:1050)+1.2*(0===r.value?1:-1)*s.viewInfo.ringOuterSize*(e+1))("cy",0===r.value?300:1260)("r",s.viewInfo.ringOuterSize),S(1),D("cx",(0===r.value?15:1050)+1.2*(0===r.value?1:-1)*s.viewInfo.ringOuterSize*(e+1))("cy",0===r.value?300:1260)("r",s.viewInfo.ringInnerSize),S(1),T("ngClass",s.viewInfo.sideRingClass[r.value]),D("cx",(0===r.value?15:1050)+1.2*(0===r.value?1:-1)*s.viewInfo.ringOuterSize*(e+1))("cy",0===r.value?300:1260)("r",s.viewInfo.ringMidSize)}}const _7t=function(){return[]};function v7t(n,t){if(1&n&&(F(),b(0,"g"),x(1,m7t,4,12,"g",1),O()),2&n){const e=t.$implicit,r=v();D("transform","rotate("+180*(r.role.value+1)+" 532.5 780)"),S(1),T("ngForOf",rr(2,_7t).constructor(r.viewInfo.sideRings[e.value]))}}class Oi extends y9{constructor(t){super(t),this.movePhase="MOVE_START",this.moveStart=P.empty(),this.moveEnd=P.empty(),this.currentlyMoved=[],this.currentCapture=P.empty(),this.initialCaptures=[],this.finalCaptures=[],this.possibleCaptures=[],this.viewInfo={spaceInfo:[],selectableCoords:[],selectedCoords:[],targets:[],markerSize:Oi.MARKER_SIZE,ringOuterSize:Oi.RING_OUTER_SIZE,ringMidSize:Oi.RING_MID_SIZE,ringInnerSize:Oi.RING_INNER_SIZE,indicatorSize:Oi.INDICATOR_SIZE,sideRings:[5,5],sideRingClass:["player0-stroke","player1-stroke"]},this.scores=P.of([0,0]),this.rules=new X3e(rc),this.availableMinimaxes=[new s7t(this.rules,"YinshMinimax")],this.encoder=sc.encoder,this.tutorial=(new J3e).tutorial,this.hexaLayout=new E9(1.5*Oi.RING_OUTER_SIZE,new M(2*Oi.RING_OUTER_SIZE,0),As.INSTANCE),this.constructedState=this.getState(),this.constructedState.allCoords().forEach(e=>{null==this.viewInfo.spaceInfo[e.y]&&(this.viewInfo.spaceInfo[e.y]=[]),this.viewInfo.spaceInfo[e.y][e.x]={coord:e,coordinates:this.getHexaPointsAt(e),center:this.getCenterAt(e),spaceClasses:[],markerClasses:[],ringClasses:[],isMarker:!1,isRing:!1,removedClass:""}})}updateBoard(){this.cancelMoveAttempt();const t=this.getState();this.scores=P.of(t.countScores())}updateViewInfo(){this.constructedState.allCoords().forEach(t=>{this.viewInfo.spaceInfo[t.y][t.x].spaceClasses=this.getSpaceClasses(t);const e=this.constructedState.getPieceAt(t);this.viewInfo.spaceInfo[t.y][t.x].removedClass="",this.setRingInfo(t,e),this.setMarkerInfo(t,e)});for(const t of z.PLAYERS)this.viewInfo.sideRings[t.value]=this.constructedState.sideRings[t.value];switch(this.showCurrentMoveCaptures(),this.showLastMove(),this.viewInfo.targets=[],this.viewInfo.selectableCoords=[],this.movePhase){case"INITIAL_CAPTURE_SELECT_FIRST":case"INITIAL_CAPTURE_SELECT_LAST":case"FINAL_CAPTURE_SELECT_FIRST":case"FINAL_CAPTURE_SELECT_LAST":this.viewInfo.selectableCoords=[];for(const t of this.possibleCaptures)for(const e of t.capturedSpaces)this.viewInfo.selectableCoords.push(e);break;case"INITIAL_CAPTURE_SELECT_RING":case"FINAL_CAPTURE_SELECT_RING":this.viewInfo.selectableCoords=this.constructedState.getRingCoords(this.constructedState.getCurrentPlayer());break;case"MOVE_START":!1===this.getState().isInitialPlacementPhase()&&(this.viewInfo.selectableCoords=this.constructedState.getRingCoords(this.constructedState.getCurrentPlayer()));break;case"MOVE_END":this.viewInfo.targets=this.rules.getRingTargets(this.constructedState,this.moveStart.get())}}showCurrentMoveCaptures(){this.currentCapture.isPresent()&&this.markCurrentCapture(this.currentCapture.get());for(const t of this.initialCaptures)this.markCurrentCapture(t);for(const t of this.finalCaptures)this.markCurrentCapture(t)}getSpaceClasses(t){return this.currentlyMoved.some(e=>e.equals(t))?["moved-fill"]:[]}setRingInfo(t,e){e.isRing?(this.viewInfo.spaceInfo[t.y][t.x].isRing=!0,this.viewInfo.spaceInfo[t.y][t.x].ringClasses=["player"+e.player.value+"-stroke"]):(this.viewInfo.spaceInfo[t.y][t.x].isRing=!1,this.viewInfo.spaceInfo[t.y][t.x].ringClasses=[])}setMarkerInfo(t,e){if(this.viewInfo.spaceInfo[t.y][t.x].isMarker=!1,this.viewInfo.spaceInfo[t.y][t.x].markerClasses=[],e!==bt.EMPTY&&(!e.isRing||this.moveStart.equalsValue(t))){const s=this.getPlayerClass(e.player);this.viewInfo.spaceInfo[t.y][t.x].isMarker=!0,this.viewInfo.spaceInfo[t.y][t.x].markerClasses=[s]}}cancelMoveAttempt(){this.constructedState=this.getState(),this.possibleCaptures=[],this.initialCaptures=[],this.finalCaptures=[],this.viewInfo.selectedCoords=[],this.currentCapture=P.empty(),this.moveStart=P.empty(),this.moveEnd=P.empty(),this.currentlyMoved=[],this.moveToInitialCaptureOrMovePhase()}showLastMove(){const t=this.rules.node.move;if(t.isPresent()){const e=t.get();if(e.isInitialPlacement())this.viewInfo.spaceInfo[e.start.y][e.start.x].spaceClasses=["moved-fill"];else{for(const s of this.coordsBetween(e.start,e.end.get()))this.viewInfo.spaceInfo[s.y][s.x].spaceClasses=["moved-fill"];const r=this.currentCapture.isAbsent()&&0===this.initialCaptures.length&&this.moveStart.isAbsent();e.initialCaptures.forEach(s=>this.showLastMoveCapture(s,r)),e.finalCaptures.forEach(s=>this.showLastMoveCapture(s,r))}}}coordsBetween(t,e){const r=[],s=Le.factory.fromMove(t,e).get();for(let i=t;!i.equals(e);i=i.getNext(s))this.constructedState.getPieceAt(i)!==bt.EMPTY&&r.push(i),r.push(e);return r}showLastMoveCapture(t,e){for(const r of t.capturedSpaces)this.viewInfo.spaceInfo[r.y][r.x].spaceClasses=["captured-fill"],e&&this.markRemovedMarker(r,this.getState().getCurrentPlayer().getOpponent());this.viewInfo.spaceInfo[t.ringTaken.get().y][t.ringTaken.get().x].spaceClasses=["captured-fill"],e&&this.markRemovedRing(t.ringTaken.get(),this.getState().getCurrentPlayer().getOpponent())}moveToInitialCaptureOrMovePhase(){return this.possibleCaptures=this.rules.getPossibleCaptures(this.constructedState),this.movePhase=0===this.possibleCaptures.length?"MOVE_START":"INITIAL_CAPTURE_SELECT_FIRST",this.updateViewInfo(),G.SUCCESS}onClick(t){var e=this;return A(function*(){const r=e.canUserPlay("#click_"+t.x+"_"+t.y);if(r.isFailure())return e.cancelMove(r.getReason());switch(e.movePhase){case"INITIAL_CAPTURE_SELECT_FIRST":case"FINAL_CAPTURE_SELECT_FIRST":return e.selectCaptureFirstCoord(t);case"INITIAL_CAPTURE_SELECT_LAST":case"FINAL_CAPTURE_SELECT_LAST":return e.selectCaptureLastCoord(t);case"INITIAL_CAPTURE_SELECT_RING":case"FINAL_CAPTURE_SELECT_RING":return e.selectRing(t);case"MOVE_START":return e.selectMoveStart(t);case"MOVE_END":return e.selectMoveEnd(t)}})()}selectCaptureFirstCoord(t){var e=this;return A(function*(){const r=[];if(e.possibleCaptures.forEach(s=>{s.contains(t)&&r.push(s)}),r.length>1)e.viewInfo.selectedCoords.push(t),e.moveToCaptureSelectLast(r);else{if(0===r.length)return e.cancelMove(Lr.MISSING_CAPTURES());e.selectCapture(r[0])}return G.SUCCESS})()}moveToCaptureSelectLast(t){this.viewInfo.selectableCoords=[],this.possibleCaptures=t;for(const e of t)for(const r of e.capturedSpaces)this.viewInfo.selectableCoords.push(r);"INITIAL_CAPTURE_SELECT_FIRST"===this.movePhase?this.movePhase="INITIAL_CAPTURE_SELECT_LAST":(Me.expectToBe(this.movePhase,"FINAL_CAPTURE_SELECT_FIRST","moveToCaptureSelectLast did not expect to be called in movePhase"+this.movePhase),this.movePhase="FINAL_CAPTURE_SELECT_LAST")}selectCaptureLastCoord(t){var e=this;return A(function*(){const r=[];return e.possibleCaptures.forEach(s=>{s.contains(t)&&r.push(s)}),r.length>1?e.cancelMove(Lr.AMBIGUOUS_CAPTURE_COORD()):0===r.length?e.cancelMove(Lr.MISSING_CAPTURES()):e.selectCapture(r[0])})()}selectCapture(t){return this.currentCapture=P.of(t),this.constructedState=new rc(this.rules.applyCaptureWithoutTakingRing(this.constructedState,t),this.constructedState.sideRings,this.constructedState.turn),"INITIAL_CAPTURE_SELECT_FIRST"===this.movePhase||"INITIAL_CAPTURE_SELECT_LAST"===this.movePhase?this.movePhase="INITIAL_CAPTURE_SELECT_RING":(ve("FINAL_CAPTURE_SELECT_FIRST"===this.movePhase||"FINAL_CAPTURE_SELECT_LAST"===this.movePhase,"selectCapture did not expect to be called in movePhase "+this.movePhase),this.movePhase="FINAL_CAPTURE_SELECT_RING"),this.updateViewInfo(),G.SUCCESS}markCurrentCapture(t){for(const e of t.capturedSpaces)this.viewInfo.selectedCoords.push(e),this.markRemovedMarker(e,this.getState().getCurrentPlayer());t.ringTaken.isPresent()&&(this.viewInfo.selectedCoords.push(t.ringTaken.get()),this.markRemovedRing(t.ringTaken.get(),this.getState().getCurrentPlayer()))}markRemovedMarker(t,e){this.viewInfo.spaceInfo[t.y][t.x].removedClass="semi-transparent",this.setMarkerInfo(t,bt.MARKERS[e.value])}markRemovedRing(t,e){this.viewInfo.spaceInfo[t.y][t.x].removedClass="semi-transparent",this.setRingInfo(t,bt.RINGS[e.value])}selectRing(t){var e=this;return A(function*(){const r=e.rules.ringSelectionValidity(e.constructedState,t);if(r.isFailure())return e.cancelMove(r.getReason());e.constructedState=e.rules.takeRing(e.constructedState,t);const s=e.currentCapture.get().setRingTaken(t);return"INITIAL_CAPTURE_SELECT_RING"===(e.currentCapture=P.empty(),e.possibleCaptures=e.rules.getPossibleCaptures(e.constructedState),e.movePhase)?(e.initialCaptures.push(s),0===e.possibleCaptures.length?e.moveToMovePhase():(e.movePhase="INITIAL_CAPTURE_SELECT_FIRST",e.updateViewInfo(),G.SUCCESS)):(Me.expectToBe(e.movePhase,"FINAL_CAPTURE_SELECT_RING"),e.finalCaptures.push(s),0===e.possibleCaptures.length?e.tryMove():(e.movePhase="FINAL_CAPTURE_SELECT_FIRST",e.updateViewInfo(),G.SUCCESS))})()}moveToMovePhase(){return this.movePhase="MOVE_START",this.updateViewInfo(),G.SUCCESS}tryMove(){var t=this;return A(function*(){const e=new sc(t.initialCaptures,t.moveStart.get(),t.moveEnd,t.finalCaptures);return yield t.chooseMove(e,t.getState(),t.scores.get())})()}selectMoveStart(t){var e=this;return A(function*(){if(e.constructedState.isInitialPlacementPhase()){const r=e.rules.initialPlacementValidity(e.constructedState,t);return r.isFailure()?e.cancelMove(r.getReason()):(e.moveStart=P.of(t),e.tryMove())}{const r=e.rules.moveStartValidity(e.constructedState,t);if(r.isFailure())return e.cancelMove(r.getReason());e.moveStart=P.of(t),e.movePhase="MOVE_END",e.updateViewInfo()}return G.SUCCESS})()}selectMoveEnd(t){var e=this;return A(function*(){if(e.moveStart.equalsValue(t))return e.cancelMoveAttempt(),G.SUCCESS;const r=bt.RINGS[e.getState().getCurrentPlayer().value];if(e.constructedState.getPieceAt(t)===r)return e.cancelMoveAttempt(),e.selectMoveStart(t);const s=e.rules.moveValidity(e.constructedState,e.moveStart.get(),t);return s.isFailure()?e.cancelMove(s.getReason()):(e.moveEnd=P.of(t),e.currentlyMoved=e.coordsBetween(e.moveStart.get(),t),e.constructedState=e.rules.applyRingMoveAndFlip(e.moveStart.get(),t,e.constructedState),e.updateViewInfo(),e.moveToFinalCapturePhaseOrTryMove())})()}moveToFinalCapturePhaseOrTryMove(){var t=this;return A(function*(){return t.possibleCaptures=t.rules.getPossibleCaptures(t.constructedState),0===t.possibleCaptures.length?t.tryMove():(t.movePhase="FINAL_CAPTURE_SELECT_FIRST",t.updateViewInfo(),G.SUCCESS)})()}}function C7t(n,t){if(1&n&&(b(0,"option",5),Tt(1),O()),2&n){const e=t.$implicit;T("value",e.urlName),S(1),l1(e.name)}}Oi.RING_OUTER_SIZE=40,Oi.RING_MID_SIZE=34,Oi.RING_INNER_SIZE=28,Oi.MARKER_SIZE=Oi.RING_INNER_SIZE,Oi.INDICATOR_SIZE=10,Oi.\u0275fac=function(t){return new(t||Oi)(J(Pn))},Oi.\u0275cmp=gt({type:Oi,selectors:[["app-yinsh"]],features:[l],decls:6,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","0 250 1065 1060","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base no-fill selected-stroke","pointer-events","fill","stroke-linecap","round",3,"id","click",4,"ngFor","ngForOf"],[4,"ngIf"],["class","indicator",3,"id","click",4,"ngFor","ngForOf"],[3,"id","click",4,"ngIf"],[3,"id","click"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[3,"id","ngClass"],["class","base no-fill mid-stroke",4,"ngIf"],["class","base no-fill",3,"id","ngClass",4,"ngIf"],["class","base mid-stroke",3,"id","ngClass",4,"ngIf"],[1,"base","no-fill","mid-stroke"],[1,"base","no-fill",3,"id","ngClass"],[1,"base","mid-stroke",3,"id","ngClass"],["pointer-events","fill","stroke-linecap","round",1,"base","no-fill","selected-stroke",3,"id","click"],["class","base no-fill capturable-stroke","pointer-events","fill","stroke-linecap","round",3,"id","click",4,"ngFor","ngForOf"],["pointer-events","fill","stroke-linecap","round",1,"base","no-fill","capturable-stroke",3,"id","click"],[1,"indicator",3,"id","click"],[1,"base","no-fill","mid-stroke",3,"id"],[1,"base","no-fill",3,"ngClass"]],template:function(t,e){1&t&&(F(),b(0,"svg",0),x(1,f7t,2,1,"g",1),x(2,h7t,1,3,"polygon",2),x(3,p7t,2,1,"g",3),x(4,g7t,1,6,"rect",4),x(5,v7t,2,3,"g",1),O()),2&t&&(S(1),T("ngForOf",e.viewInfo.spaceInfo),S(1),T("ngForOf",e.viewInfo.selectedCoords),S(1),T("ngIf",e.isPlayerTurn()),S(1),T("ngForOf",e.viewInfo.targets),S(1),T("ngForOf",e.Player.PLAYERS))},dependencies:[dn,An,en],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});let O1=(()=>{class n{}return n.ABALONE=()=>$localize`Use simple mechanics to push 6 of the opponent's pieces out of the board!`,n.APAGOS=()=>$localize`Very simple game, but, will you be able to win everytime?`,n.AWALE=()=>$localize`The international version of the famous African strategy game!`,n.BRANDHUB=()=>$localize`The Irish version of the Tafl game family! Invaders must capture the king, defender must make him escape!`,n.COERCEO=()=>$localize`Get rid of all of your opponent's pieces on a board that shrinks little by little!`,n.CONNECT_SIX=()=>$localize`Put two pieces on the board at each turn, and be the first to align six pieces!`,n.CONSPIRATEURS=()=>$localize`Hide all of your pieces before your opponent does, or risk to be discovered!`,n.DIAM=()=>$localize`Drop your pieces and move them around to align two pieces of the same color across the board to win!`,n.DVONN=()=>$localize`Stack your pieces and control as many stacks as you can to win!`,n.ENCAPSULE=()=>$localize`An enhanced tic-tac-toe where piece can encapsule other and prevent them to win.`,n.EPAMINONDAS=()=>$localize`An antiquity-war inspired game. Be the first to pierce your opponent's lines!`,n.GIPF=()=>$localize`A hexagonal game of alignment. Insert your pieces on the board to capture your opponent's pieces!`,n.GO=()=>$localize`The oldest strategy game still practiced widely. A territory control game.`,n.HIVE=()=>$localize`You are in charge of a hive full of insects. Use the abilities of your insects to block the opponent's queen in order to win!`,n.HNEFATAFL=()=>$localize`The Viking board game! Invaders must capture the king, defender must make him escape!`,n.KAMISADO=()=>$localize`Your goal is simple: reach the last line. But the piece you move depends on your opponent's last move!`,n.LASCA=()=>$localize`Similar to checkers, capture opponent's pieces, free your own, and immobilize your opponent to win the game!`,n.LINES_OF_ACTION=()=>$localize`Regroup your pieces to win. But your possible moves will often change!`,n.LODESTONE=()=>$localize`Push and crush your opponent's pieces using magnetic forces!`,n.MARTIAN_CHESS=()=>$localize`Win points by capturing pieces, but you only control pieces on your side of the board!`,n.P4=()=>$localize`The classical 4 in a row game!`,n.PENTAGO=()=>$localize`Drop a piece, then rotate a quadrant. The first player to align 5 pieces wins!`,n.PYLOS=()=>$localize`Overlay your pieces and use two game mechanics to conserve your pieces. First player to run out of pieces loses!`,n.QUARTO=()=>$localize`Create a winning alignment. The problem: you don't pick the piece that you're placing on the board!`,n.QUIXO=()=>$localize`Align 5 of your pieces on a board where pieces slide!`,n.REVERSI=()=>$localize`Sandwich your opponent's pieces to dominate the board!`,n.SAHARA=()=>$localize`Immobilize one of your opponent's pyramids before your opponent does!`,n.SIAM=()=>$localize`Be the first to push a mountain out of the board!`,n.SIX=()=>$localize`Put your hexagonal pieces next to another one, and create one of the 3 victorious shapes to win!`,n.TABLUT=()=>$localize`Lapland version of the Tafl game family! Invaders must capture the king, defender must make him escape!`,n.TREXO=()=>$localize`Align 5 pieces of your color in a row, but beware, the pieces can be put on top of other pieces!`,n.YINSH=()=>$localize`Align your pieces to score points, but beware, pieces can flip!`,n})(),H9=(()=>{class n{constructor(e,r,s,i,o,c,u,h=!0){this.name=e,this.urlName=r,this.component=s,this.tutorial=i,this.rules=o,this.creationDate=c,this.description=u,this.display=h}}return n.ALL_GAMES=()=>[new n($localize`Four in a Row`,"P4",C8t,new T3e,new Gr(p6),new Date("2018-08-28"),O1.P4()),new n($localize`Awal`,"Awale",m4t,new Uce,new z4(no),new Date("2018-11-29"),O1.AWALE()),new n($localize`Quarto`,"Quarto",Cut,new D3e,new ti(jc),new Date("2018-12-09"),O1.QUARTO()),new n($localize`Tablut`,"Tablut",k5t,new q3e,O5.get(),new Date("2018-12-27"),O1.TABLUT()),new n($localize`Reversi`,"Reversi",Iut,new H3e,new Jm(j1),new Date("2019-01-16"),O1.REVERSI()),new n($localize`Go`,"Go",M6t,new c3e,new V3(xs),new Date("2019-12-21"),O1.GO()),new n($localize`Encapsule`,"Encapsule",qlt,new s3e,new Vc(u6),new Date("2019-12-30"),O1.ENCAPSULE()),new n($localize`Siam`,"Siam",c5t,new G3e,b1.get(),new Date("2020-01-11"),O1.SIAM()),new n($localize`Sahara`,"Sahara",Gut,new F3e,new L9(wi),new Date("2020-02-29"),O1.SAHARA()),new n($localize`Pylos`,"Pylos",$8t,new x3e,new Bo(qc),new Date("2020-10-02"),O1.PYLOS()),new n($localize`Kamisado`,"Kamisado",p0t,new g3e,new zo(F3),new Date("2020-10-03"),O1.KAMISADO()),new n($localize`Quixo`,"Quixo",wut,new z3e,new ma(h8),new Date("2020-10-15"),O1.QUIXO()),new n($localize`Dvonn`,"Dvonn",Llt,new e3e,new Ei(Ka),new Date("2020-10-21"),O1.DVONN()),new n($localize`Epaminondas`,"Epaminondas",Jlt,new i3e,new c8(z3),new Date("2021-01-16"),O1.EPAMINONDAS()),new n($localize`Gipf`,"Gipf",c6t,new a3e,new Un(Qa),new Date("2021-02-22"),O1.GIPF()),new n($localize`Coerceo`,"Coerceo",nlt,new Qce,new MP(w1),new Date("2021-03-21"),O1.COERCEO()),new n($localize`Six`,"Six",y5t,new W3e,new q3(Zi),new Date("2021-04-08"),O1.SIX()),new n($localize`Lines of Action`,"LinesOfAction",N0t,new C3e,new ro(ei),new Date("2021-04-28"),O1.LINES_OF_ACTION()),new n($localize`Pentago`,"Pentago",O8t,new b3e,new B3(z2),new Date("2021-05-23"),O1.PENTAGO()),new n($localize`Abalone`,"Abalone",r4t,new $ce,new x3(a6),new Date("2021-07-13"),O1.ABALONE()),new n($localize`Yinsh`,"Yinsh",Oi,new J3e,new X3e(rc),new Date("2021-07-31"),O1.YINSH()),new n($localize`Apagos`,"Apagos",f4t,new zce,D4.get(),new Date("2021-11-04"),O1.APAGOS()),new n($localize`Diam`,"Diam",D3,new Yce,R3.get(),new Date("2021-11-30"),O1.DIAM()),new n($localize`Brandhub`,"Brandhub",A4t,new Wce,M5.get(),new Date("2021-12-07"),O1.BRANDHUB()),new n($localize`Conspirateurs`,"Conspirateurs",hlt,new jce,Za.get(),new Date("2021-12-30"),O1.CONSPIRATEURS()),new n($localize`Lodestone`,"Lodestone",R2,new y3e,L2.get(),new Date("2022-06-24"),O1.LODESTONE()),new n($localize`Martian Chess`,"MartianChess",Fo,new P3e,new A9(Rs),new Date("2022-07-01"),O1.MARTIAN_CHESS()),new n($localize`Hnefatafl`,"Hnefatafl",o0t,new p3e,w5.get(),new Date("2022-09-21"),O1.HNEFATAFL()),new n($localize`Hive`,"Hive",j6t,new h3e,Pi.get(),new Date("2023-04-02"),O1.HIVE()),new n($localize`Trexo`,"Trexo",f1,new Y3e,Yi.get(),new Date("2023-04-23"),O1.TREXO()),new n($localize`Lasca`,"Lasca",S0t,new v3e,B4.get(),new Date("2023-05-11"),O1.LASCA()),new n($localize`Connect Six`,"ConnectSix",z4t,new qce,Dc.get(),new Date("2023-05-13"),O1.CONNECT_SIX())].sort((t,e)=>t.name.localeCompare(e.name)),n})(),qH=(()=>{class n{constructor(){this.games=H9.ALL_GAMES(),this.pickGame=new mr}onChange(e){this.pickGame.emit(e.target.value)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=gt({type:n,selectors:[["app-pick-game"]],outputs:{pickGame:"pickGame"},decls:5,vars:1,consts:function(){let t;return t=$localize`Pick a game`,[[1,"select","is-primary","is-fullwidth"],["id","gameType",3,"change"],["value","","selected",""],t,[3,"value",4,"ngFor","ngForOf"],[3,"value"]]},template:function(e,r){1&e&&(b(0,"div",0)(1,"select",1),ee("change",function(i){return r.onChange(i)}),b(2,"option",2),_e(3,3),O(),x(4,C7t,2,2,"option",4),O()()),2&e&&(S(4),T("ngForOf",r.games))},dependencies:[An,Sp,Pp],encapsulation:2}),n})();function y7t(n,t){if(1&n){const e=Oe();b(0,"div",26)(1,"div",27),ee("click",function(){return he(e),le(v().closeInfo())}),O(),b(2,"div",28)(3,"header",29)(4,"p",30),Tt(5),O(),b(6,"button",31),ee("click",function(){return he(e),le(v().closeInfo())}),O()(),b(7,"section",32)(8,"div",6)(9,"div",33)(10,"p",34),Q(11,"img",35),O()(),b(12,"div",7)(13,"div",13),Tt(14),O()()(),b(15,"div",6)(16,"div",33)(17,"a",36),ee("click",function(){he(e);const s=v();return le(s.createGame(s.gameInfoDetails.get().urlName))}),Q(18,"fa-icon",37),Tt(19,"\xa0"),b(20,"span"),_e(21,38),O()()(),b(22,"div",33)(23,"a",36),ee("click",function(){he(e);const s=v();return le(s.createLocalGame(s.gameInfoDetails.get().urlName))}),Q(24,"fa-icon",37),Tt(25,"\xa0"),b(26,"span"),_e(27,39),O()()(),b(28,"div",33)(29,"a",36),ee("click",function(){he(e);const s=v();return le(s.createTutorial(s.gameInfoDetails.get().urlName))}),Q(30,"fa-icon",37),Tt(31,"\xa0"),b(32,"span"),_e(33,40),O()()()()()()()}if(2&n){const e=v();S(5),l1(e.gameInfoDetails.get().name),S(6),We("src","assets/images/",e.theme,"/",e.gameInfoDetails.get().urlName,".png",p3),S(3),Z2(" ",e.gameInfoDetails.get().description," "),S(4),T("icon",e.iconOnlineGame),S(6),T("icon",e.iconLocalGame),S(6),T("icon",e.iconTutorial)}}function E7t(n,t){if(1&n){const e=Oe();b(0,"div",8)(1,"div",9)(2,"p",10),Tt(3),O()(),b(4,"div",42)(5,"figure",34)(6,"img",43),ee("click",function(){const i=he(e).$implicit;return le(v(2).openInfo(i))}),O(),b(7,"figcaption",44),ee("click",function(){const i=he(e).$implicit;return le(v(2).openInfo(i))}),b(8,"div",45),Tt(9,"?"),O()(),b(10,"figcaption",46)(11,"a",47),ee("click",function(){const i=he(e).$implicit;return le(v(2).createGame(i.urlName))}),Q(12,"fa-icon",37),O(),b(13,"a",48),ee("click",function(){const i=he(e).$implicit;return le(v(2).createLocalGame(i.urlName))}),Q(14,"fa-icon",37),O(),b(15,"a",49),ee("click",function(){const i=he(e).$implicit;return le(v(2).createTutorial(i.urlName))}),Q(16,"fa-icon",37),O()()()(),b(17,"div",50),Tt(18),O()()}if(2&n){const e=t.$implicit,r=v(2);S(3),l1(e.name),S(3),y1("id","image_",e.urlName,""),We("src","assets/images/",r.theme,"/",e.urlName,".png",p3),S(5),y1("id","playOnline_",e.urlName,""),S(1),T("icon",r.iconOnlineGame),S(1),y1("id","playLocally_",e.urlName,""),S(1),T("icon",r.iconLocalGame),S(1),y1("id","startTutorial_",e.urlName,""),S(1),T("icon",r.iconTutorial),S(2),Z2(" ",e.description," ")}}function M7t(n,t){if(1&n&&(b(0,"div",7),x(1,E7t,19,11,"div",41),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e)}}let S7t=(()=>{class n{constructor(e,r,s,i){this.router=e,this.messageDisplayer=r,this.observedPartService=s,this.numberOfColumns=5,this.games=[],this.iconOnlineGame=ooe,this.iconLocalGame=uH,this.iconTutorial=cce,this.gameInfoDetails=P.empty(),this.theme=i.getTheme();const o=H9.ALL_GAMES();let c=0;for(let u=0;u<o.length;u++)u<this.numberOfColumns&&this.games.push([]),this.games[c].push(o[u]),c=(c+1)%this.numberOfColumns}createGame(e){var r=this;return A(function*(){const s=r.observedPartService.canUserCreate();return s.isSuccess()?r.router.navigate(null==e?["/play"]:["/play",e]):(r.messageDisplayer.criticalMessage(s.getReason()),!1)})()}createLocalGame(e){var r=this;return A(function*(){return r.router.navigate(["/local",e])})()}createTutorial(e){return this.router.navigate(["/tutorial",e])}openInfo(e){this.gameInfoDetails=P.of(e)}closeInfo(){this.gameInfoDetails=P.empty()}}return n.\u0275fac=function(e){return new(e||n)(J(Zn),J(Pn),J(O2),J(NS))},n.\u0275cmp=gt({type:n,selectors:[["app-welcome"]],decls:33,vars:2,consts:function(){let t,e,r,s,i,o,c,u,h,p,m,C,w,I;return t=$localize`EveryBoard`,e=$localize`EveryBoard is a website to play and learn the rules of various abstract strategy games with perfect information.${"\ufffd#6\ufffd\ufffd/#6\ufffd"}:LINE_BREAK: Such games are games that do not include any randomness, agility, or hidden information. These games are played by two players, turn by turn.`,r=$localize`Play online`,s=$localize`Create an online game`,i=$localize`See the game list`,o=$localize`Play offline`,c=$localize`Play`,u=$localize`Learn`,h=$localize`Play online`,p=$localize`Play offline`,m=$localize`Learn the rules`,C=$localize`Play online`,w=$localize`Play offline`,I=$localize`Learn the rules`,[[1,"hero"],[1,"hero-body"],[1,"title"],t,[1,"subtitle"],e,[1,"columns"],[1,"column"],[1,"card"],[1,"card-header"],[1,"card-header-title"],r,[1,"card-content"],[1,"content"],["id","createOnlineGame",1,"button","is-medium","is-fullwidth","is-primary","mb-1",3,"click"],s,["id","seeGameList","routerLink","/lobby",1,"button","is-medium","is-fullwidth","is-primary"],i,o,[1,"content","has-text-centered"],["routerLink","/local",1,"button","is-medium","is-fullwidth","is-primary","mb-1"],c,["routerLink","/tutorial",1,"button","is-medium","is-fullwidth","is-primary"],u,["id","gameInfoModal","class","modal is-active",4,"ngIf"],["class","column",4,"ngFor","ngForOf"],["id","gameInfoModal",1,"modal","is-active"],["id","modalBackground",1,"modal-background",3,"click"],[1,"modal-card"],[1,"modal-card-head","is-primary"],[1,"modal-card-title"],["id","closeInfo","aria-label","close",1,"delete",3,"click"],[1,"modal-card-body"],[1,"column","is-one-third"],[1,"image"],[3,"src"],[1,"button","is-fullwidth",3,"click"],[3,"icon"],h,p,m,["class","card",4,"ngFor","ngForOf"],[1,"card-image","game-card"],[1,"is-clickable",3,"id","src","click"],[1,"has-text-centered","is-overlay","game-image-text","is-clickable",3,"click"],[1,"is-size-1","has-text-weight-bold"],[1,"has-text-centered","is-overlay","game-image-buttons"],["data-tooltip",C,1,"button",3,"id","click"],["data-tooltip",w,1,"button",3,"id","click"],["data-tooltip",I,1,"button",3,"id","click"],[1,"card-content","is-hidden"]]},template:function(e,r){1&e&&(b(0,"section",0)(1,"div",1)(2,"p",2),_e(3,3),O(),b(4,"p",4),yc(5,5),Q(6,"br"),Ec(),O()(),b(7,"div",6)(8,"div",7)(9,"div",8)(10,"header",9)(11,"p",10),_e(12,11),O()(),b(13,"div",12)(14,"div",13)(15,"button",14),ee("click",function(){return r.createGame()}),_e(16,15),O(),b(17,"button",16),_e(18,17),O()()()()(),b(19,"div",7)(20,"div",8)(21,"header",9)(22,"p",10),_e(23,18),O()(),b(24,"div",12)(25,"div",19)(26,"button",20),_e(27,21),O(),b(28,"button",22),_e(29,23),O()()()()()(),x(30,y7t,34,7,"div",24),b(31,"div",6),x(32,M7t,2,1,"div",25),O()()),2&e&&(S(30),T("ngIf",r.gameInfoDetails.isPresent()),S(2),T("ngForOf",r.games))},dependencies:[An,en,Bp,v9],encapsulation:2}),n})();const P7t=["board"];let F9=(()=>{class n{static NO_MATCHING_GAME(e){return $localize`This game (${e}) does not exist.`}}return n.NOT_YOUR_TURN=()=>$localize`It is not your turn!`,n.NO_CLONING_FEATURE=()=>$localize`You cannot clone a game. This feature might be implemented later.`,n})(),JP=(()=>{class n{constructor(e,r,s,i,o){this.componentFactoryResolver=e,this.actRoute=r,this.connectedUserService=s,this.router=i,this.messageDisplayer=o,this.boardRef=null,this.players=[P.empty(),P.empty()],this.role=pe.NONE,this.endGame=!1,this.Player=z,X(n.VERBOSE,"GameWrapper.constructed: "+(null!=this.boardRef))}getMatchingComponent(e){return X(n.VERBOSE,"GameWrapper.getMatchingComponent"),P.ofNullable(H9.ALL_GAMES().find(s=>s.urlName===e)).map(s=>s.component)}afterViewInit(){var e=this;return A(function*(){X(n.VERBOSE,"GameWrapper.afterViewInit");const r=yield e.createGameComponent();return r&&(e.gameComponent.rules.setInitialBoard(),e.gameComponent.updateBoard()),r})()}getGameName(){return Me.getNonNullable(this.actRoute.snapshot.paramMap.get("compo"))}createGameComponent(){var e=this;return A(function*(){X(n.VERBOSE,{m:"GameWrapper.createGameComponent",that:e});const r=e.getGameName(),s=e.getMatchingComponent(r);if(s.isAbsent())return yield e.router.navigate(["/notFound",F9.NO_MATCHING_GAME(r)],{skipLocationChange:!0}),!1;ve(null!=e.boardRef,"Board element should be present");const i=e.componentFactoryResolver.resolveComponentFactory(s.get()),o=Me.getNonNullable(e.boardRef).createComponent(i);return e.gameComponent=o.instance,e.gameComponent.chooseMove=(c,u,h)=>e.receiveValidMove(c,u,h),e.gameComponent.canUserPlay=c=>e.onUserClick(c),e.gameComponent.isPlayerTurn=()=>e.isPlayerTurn(),e.gameComponent.cancelMoveOnWrapper=c=>{e.onCancelMove(c)},e.setRole(e.role),e.canPass=e.gameComponent.canPass,!0})()}setRole(e){this.role=e,this.gameComponent.role=this.role,this.gameComponent.hasAsymetricBoard&&(this.gameComponent.rotation="rotate("+180*this.role.value+")"),this.gameComponent.updateBoard()}receiveValidMove(e,r,s){var i=this;return A(function*(){if(X(n.VERBOSE||!1,{gameWrapper_receiveValidMove_AKA_chooseMove:{move:e,state:r,scores:s}}),!i.isPlayerTurn())return G.failure(F9.NOT_YOUR_TURN());if(i.endGame)return G.failure($localize`The game has ended.`);const c=i.gameComponent.rules.isLegal(e,r);return c.isFailure()?(i.gameComponent.cancelMove(c.getReason()),G.ofFallible(c)):(i.gameComponent.cancelMoveAttempt(),yield i.onLegalUserMove(e,s),X(n.VERBOSE||!1,"GameWrapper.receiveValidMove says: valid move legal"),G.SUCCESS)})()}onUserClick(e){if(this.role===pe.NONE){const r=F9.NO_CLONING_FEATURE();return G.failure(r)}return this.isPlayerTurn()?G.SUCCESS:G.failure(F9.NOT_YOUR_TURN())}isPlayerTurn(){if(this.role===pe.NONE||null==this.gameComponent)return!1;const e=this.gameComponent.getTurn(),r=e%2,s=this.getPlayer();return X(n.VERBOSE,{isPlayerTurn:{turn:e,players:this.players,player:s,observer:this.role,areYouPlayer:this.players[r].isPresent()&&Ga(this.players[r].get(),s),isThereAPlayer:this.players[r]}}),!this.players[r].isPresent()||this.players[r].equalsValue(s)}getBoardHighlight(){return this.endGame?["endgame-bg"]:this.isPlayerTurn()?["player"+this.gameComponent.getTurn()%2+"-bg"]:[]}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(J(Ia),J(bo),J(Ns),J(Zn),J(Pn))},n.\u0275cmp=gt({type:n,selectors:[["ng-component"]],viewQuery:function(e,r){if(1&e&&v4(P7t,5,za),2&e){let s;Sc(s=Pc())&&(r.boardRef=s.first)}},decls:0,vars:0,template:function(e,r){},encapsulation:2}),n})();const T7t=["board"];let w7t=(()=>{class n extends JP{constructor(e,r,s,i,o,c){super(e,r,s,i,o),this.cdr=c,this.boardRef=null}getGameName(){return this.demoNodeInfo.name}ngAfterViewInit(){var e=this;return A(function*(){setTimeout(A(function*(){yield e.afterViewInit(),e.gameComponent.rules.node=e.demoNodeInfo.node,e.setRole(e.gameComponent.getCurrentPlayer()),e.gameComponent.updateBoard(),e.cdr.detectChanges(),e.demoNodeInfo.click.isPresent()&&(Me.getNonNullable(document.querySelector(e.demoNodeInfo.click.get())).dispatchEvent(new Event("click")),e.cdr.detectChanges())}),1)})()}onLegalUserMove(e,r){return A(function*(){})()}getPlayer(){return"no-player"}onCancelMove(e){}}return n.\u0275fac=function(e){return new(e||n)(J(Ia),J(bo),J(Ns),J(Zn),J(Pn),J(_u))},n.\u0275cmp=gt({type:n,selectors:[["app-demo-card"]],viewQuery:function(e,r){if(1&e&&v4(T7t,5,za),2&e){let s;Sc(s=Pc())&&(r.boardRef=s.first)}},inputs:{demoNodeInfo:"demoNodeInfo"},features:[l],decls:2,vars:0,consts:[["board",""]],template:function(e,r){1&e&&Q(0,"div",null,0)},encapsulation:2}),n})();function b7t(n,t){if(1&n&&(b(0,"div",17)(1,"figure",18),Q(2,"app-demo-card",19),O()()),2&n){const e=v().$implicit;S(2),T("demoNodeInfo",e)}}function O7t(n,t){if(1&n&&(b(0,"div",20)(1,"figure",21),Q(2,"app-demo-card",19),O()()),2&n){const e=v().$implicit;S(2),T("demoNodeInfo",e)}}function N7t(n,t){if(1&n&&(b(0,"div",12)(1,"div",13)(2,"p",14),Tt(3),O()(),x(4,b7t,3,1,"div",15),x(5,O7t,3,1,"ng-template",null,16,r1),O()),2&n){const e=t.$implicit,r=Qn(6),s=v(2);S(3),l1(e.name),S(1),T("ngIf",s.squared.value)("ngIfElse",r)}}function A7t(n,t){if(1&n&&(b(0,"div",10),x(1,N7t,7,3,"div",11),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e)}}let I7t=(()=>{class n{constructor(){this.numberOfColumns=new Va(5),this.squared=new Va(!0),this.columns=[],this.fillColumns(this.numberOfColumns.value),this.numberOfColumns.valueChanges.subscribe(e=>{this.fillColumns(e)})}fillColumns(e){const r=H9.ALL_GAMES();let s=0,i=0;this.columns=[];for(const o of r){const c=[],u=o.rules,h=o.tutorial.tutorial;for(const p of h){const m=this.getNodeFromStep(p,u);c.push(m)}for(const p of c)i<e&&this.columns.push([]),this.columns[s].push({name:o.urlName,node:p.node,click:p.click}),i++,s=(s+1)%e}}getNodeFromStep(e,r){if(e.hasSolution()){const s=e.getSolution();if("string"==typeof s)return{node:new $1(e.state),click:P.of(s)};{const i=s;return{node:new $1(r.applyLegalMove(i,e.state,r.isLegal(i,e.state).get()),P.of(new $1(e.state)),P.of(i)),click:P.empty()}}}return{node:new $1(e.state),click:P.empty()}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=gt({type:n,selectors:[["app-demo-page"]],decls:17,vars:4,consts:function(){let t,e;return t=$localize`Number of columns: `,e=$localize`Squared`,[[1,"field"],["for","numberOfColumns",1,"label"],t,[1,"control"],["step","1","min","1","max","10","name","maximalMoveDuration","type","range",1,"slider","is-circle","is-primary",3,"formControl"],[1,"checkbox"],["type","checkbox",3,"formControl"],e,[1,"columns"],["class","column",4,"ngFor","ngForOf"],[1,"column"],["class","card",4,"ngFor","ngForOf"],[1,"card"],[1,"card-header"],[1,"card-header-title"],["class","card-image game-card","style","height: 200px;",4,"ngIf","ngIfElse"],["nonSquared",""],[1,"card-image","game-card",2,"height","200px"],[1,"image",2,"height","100%"],[3,"demoNodeInfo"],[1,"card-image","game-card"],[1,"image"]]},template:function(e,r){1&e&&(b(0,"form")(1,"div",0)(2,"label",1),un(3),_e(4,2),fn(),b(5,"output"),Tt(6),O()(),b(7,"div",3),Q(8,"input",4),O()(),b(9,"div",0)(10,"label",5),Q(11,"input",6),Tt(12," \xa0"),un(13),_e(14,7),fn(),O()()(),b(15,"div",8),x(16,A7t,2,1,"div",9),O()),2&e&&(S(6),l1(r.numberOfColumns.value),S(2),T("formControl",r.numberOfColumns),S(3),T("formControl",r.squared),S(5),T("ngForOf",r.columns))},dependencies:[An,en,Mu,M4,Vy,oN,xl,Eu,CN,Ep,w7t],encapsulation:2}),n})(),jH=(()=>{class n{constructor(e){this.element=e}ngAfterViewInit(){this.element.nativeElement.focus()}}return n.\u0275fac=function(e){return new(e||n)(J(h2))},n.\u0275dir=Ut({type:n,selectors:[["","autofocus",""]]}),n})(),e4e=(()=>{class n{constructor(e){this.shown=!1,this.input=e.nativeElement.parentNode.previousSibling,e.nativeElement.addEventListener("click",r=>{this.toggle()})}toggle(){this.shown=!this.shown,this.input.setAttribute("type",this.shown?"text":"password"),this.input.focus()}}return n.\u0275fac=function(e){return new(e||n)(J(h2))},n.\u0275dir=Ut({type:n,selectors:[["","toggleVisibility",""]]}),n})();function x7t(n,t){if(1&n&&(b(0,"div",29)(1,"div",30),_e(2,31),O(),b(3,"div",32),Tt(4),O()()),2&n){const e=v();S(4),l1(e.errorMessage)}}const k7t=function(){return["/register"]},L7t=function(){return["/reset-password"]};let R7t=(()=>{class n{constructor(e,r){this.router=e,this.connectedUserService=r,this.faEye=BV,this.loginForm=new y0({email:new Va,password:new Va})}ngOnInit(){var e=this;this.userSubscription=this.connectedUserService.subscribeToUser(function(){var r=A(function*(s){s!==_5.NOT_CONNECTED&&(yield e.redirect())});return function(s){return r.apply(this,arguments)}}())}loginWithEmail(e){var r=this;return A(function*(){const s=yield r.connectedUserService.doEmailLogin(e.email,e.password);s.isFailure()&&(r.errorMessage=s.getReason())})()}loginWithGoogle(){var e=this;return A(function*(){const r=yield e.connectedUserService.doGoogleLogin();r.isFailure()&&(e.errorMessage=r.getReason())})()}redirect(){var e=this;return A(function*(){return e.router.navigate(["/lobby"])})()}canLogin(){return!(""===(this.loginForm.value.email??"")||""===(this.loginForm.value.password??""))}ngOnDestroy(){this.userSubscription.unsubscribe()}}return n.\u0275fac=function(e){return new(e||n)(J(Zn),J(Ns))},n.\u0275cmp=gt({type:n,selectors:[["app-login"]],decls:49,vars:8,consts:function(){let t,e,r,s,i,o,c,u,h,p,m,C;return t=$localize`Log in`,e=$localize`Email`,r=$localize`Email`,s=$localize`Password`,i=$localize`Password`,o=$localize`Log in`,c=$localize`Log in with Google`,u=$localize`No account?`,h=$localize`Register`,p=$localize`Forgot your password?`,m=$localize`Reset your password`,C=$localize`Connection error`,[[1,"box"],[1,"title"],t,[3,"formGroup"],[1,"field","is-horizontal"],[1,"field-label"],["for","email",1,"label"],e,[1,"field-body"],[1,"field"],[1,"control"],["id","email","type","text","placeholder",r,"formControlName","email","name","email","type","email","autofocus","","required","",1,"input"],["for","password",1,"label"],s,[1,"control","has-icons-right","is-expanded"],["id","password","type","password","placeholder",i,"formControlName","password","name","password","required","",1,"input"],[1,"icon","is-small","is-right"],["toggleVisibility","",1,"clickable-icon",3,"icon"],["id","loginButton",1,"button","is-primary","is-fullwidth",3,"disabled","click"],o,["id","googleButton","type","submit",1,"button","is-fullwidth",3,"click"],c,["class","message is-danger","role","alert",4,"ngIf"],[1,"help","level-right"],u,[3,"routerLink"],h,p,m,["role","alert",1,"message","is-danger"],[1,"message-header"],C,["id","errorMessage",1,"message-body"]]},template:function(e,r){1&e&&(b(0,"div",0)(1,"p",1),_e(2,2),O(),b(3,"form",3)(4,"div",4)(5,"div",5)(6,"label",6),_e(7,7),O()(),b(8,"div",8)(9,"div",9)(10,"div",10),Q(11,"input",11),O()()()(),b(12,"div",4)(13,"div",5)(14,"label",12),_e(15,13),O()(),b(16,"div",8)(17,"div",9)(18,"div",14),Q(19,"input",15),b(20,"span",16),Q(21,"fa-icon",17),O()()()()(),b(22,"div",4),Q(23,"div",5),b(24,"div",8)(25,"div",9)(26,"div",10)(27,"button",18),ee("click",function(){return r.loginWithEmail(r.loginForm.value)}),_e(28,19),O()()()()(),b(29,"div",4),Q(30,"div",5),b(31,"div",8)(32,"div",9)(33,"div",10)(34,"button",20),ee("click",function(){return r.loginWithGoogle()}),_e(35,21),O()()()()(),x(36,x7t,5,1,"div",22),b(37,"p",23),un(38),_e(39,24),fn(),Tt(40,"\xa0 "),b(41,"a",25),_e(42,26),O()(),b(43,"p",23),un(44),_e(45,27),fn(),Tt(46,"\xa0 "),b(47,"a",25),_e(48,28),O()()()()),2&e&&(S(3),T("formGroup",r.loginForm),S(18),T("icon",r.faEye),S(6),T("disabled",!r.canLogin()),S(9),T("ngIf",r.errorMessage),S(5),T("routerLink",rr(6,k7t)),S(6),T("routerLink",rr(7,L7t)))},dependencies:[en,Nu,Mu,M4,xl,Eu,Tu,Su,ff,v9,jH,e4e],encapsulation:2}),n})(),D7t=(()=>{class n{constructor(e){this.partDAO=e}subscribeToActiveParts(e){let r=[];const c=new bS(u=>{r=r.concat(...u),e(r)},u=>{const h=r;for(const p of u)h.forEach(m=>{m.id===p.id&&(m.data=p.data)});r=h,e(r)},u=>{const h=[];for(const p of r)u.some(m=>m.id===p.id)||h.push(p);r=h,e(r)});return this.partDAO.observingWhere([["result","==",Dn.UNACHIEVED.value]],c)}}return n.\u0275fac=function(e){return new(e||n)(De(bte))},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"any"}),n})(),z7t=(()=>{class n{constructor(e){this.userDAO=e}subscribeToActiveUsers(e){X(n.VERBOSE,"ActiveUsersService.subscribeToActiveUsers");let r=[];const c=new bS(u=>{X(n.VERBOSE,"our DAO gave us "+u.length+" new user(s)"),r=this.sort(r.concat(...u)),e(r)},u=>{let h=r;X(n.VERBOSE,"our DAO updated "+u.length+" user(s)");for(const p of u)h.forEach(m=>{m.id===p.id&&(m.data=p.data)}),h=this.sort(h);r=h,e(r)},u=>{r=r.filter(h=>!u.some(p=>p.id===h.id)),e(r)});return this.userDAO.observingWhere([["state","==","online"],["verified","==",!0]],c)}sort(e){return e.sort((r,s)=>{const i=Me.getNonNullable(r.data).lastUpdateTime,o=Me.getNonNullable(i).seconds,c=Me.getNonNullable(s.data).lastUpdateTime;return o-Me.getNonNullable(c).seconds})}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(De(TS))},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),t4e=(()=>{class n{transform(e){return aG(1e3*e.seconds,"HH:mm:ss","en-US")}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275pipe=ai({name:"firebaseDate",type:n,pure:!0}),n})();const V7t=["chatDiv"];function H7t(n,t){1&n&&(un(0),_e(1,5),fn())}function F7t(n,t){1&n&&_e(0,6),2&n&&(k1(v().unreadMessagesText),F1(0))}function B7t(n,t){if(1&n){const e=Oe();b(0,"button",11),ee("click",function(){return he(e),le(v(2).scrollToBottom())}),Tt(1),O()}if(2&n){const e=v(2);S(1),Z2("",e.unreadMessagesText," \u2193")}}function $7t(n,t){if(1&n&&(b(0,"p"),Tt(1),Mc(2,"firebaseDate"),b(3,"b",12),Tt(4),O(),b(5,"span",13),Tt(6),O()()),2&n){const e=t.$implicit;S(1),Z2(" [",T3(2,3,e.postedTime),"] "),S(3),Z2("",e.sender.name," : "),S(2),l1(e.content)}}function U7t(n,t){if(1&n){const e=Oe();b(0,"div"),x(1,B7t,2,1,"button",7),b(2,"div",8,9),ee("scroll",function(){return he(e),le(v().updateCurrentScrollPosition())}),x(4,$7t,7,5,"p",10),O()()}if(2&n){const e=v();S(1),T("ngIf",e.showUnreadMessagesButton),S(3),T("ngForOf",e.chat)}}const G7t=function(){return{standalone:!0}};function W7t(n,t){if(1&n){const e=Oe();b(0,"form",14),ee("onSubmit",function(){return he(e),le(v().sendMessage())}),b(1,"div",15)(2,"div",16)(3,"input",17,18),ee("ngModelChange",function(s){return he(e),le(v().userMessage=s)}),O(),b(5,"p",19),Tt(6),O()(),b(7,"div",20)(8,"button",21),ee("click",function(){return he(e),le(v().sendMessage())}),Q(9,"fa-icon",22),O()()(),b(10,"div",23)(11,"p")(12,"strong"),_e(13,24),O()()()()}if(2&n){const e=Qn(4),r=v();S(3),T("ngModel",r.userMessage)("ngModelOptions",rr(4,G7t)),S(3),Z2("",e.value.length,"/128"),S(3),T("icon",r.faReply)}}let n4e=(()=>{class n{constructor(e,r){this.chatService=e,this.connectedUserService=r,this.userMessage="",this.connected=!1,this.chat=[],this.readMessages=0,this.unreadMessagesText="",this.showUnreadMessagesButton=!1,this.visible=!0,this.faReply=wV,this.isNearBottom=!0,this.notYetScrolled=!0,X(n.VERBOSE,"ChatComponent constructor")}ngOnInit(){X(n.VERBOSE,`ChatComponent.ngOnInit for chat ${this.chatId}`),ve(null!=this.chatId&&""!==this.chatId,"No chat to join mentionned"),this.loadChatContent()}ngAfterViewChecked(){this.scrollToBottomIfNeeded()}loadChatContent(){const e=s=>{this.updateMessages(s.flatMap(i=>null==i.data.postedTime?[]:[i.data]))},r=new bS(e,e,()=>{});this.chatSubscription=this.chatService.subscribeToMessages(this.chatId,r)}updateMessages(e){this.chat=this.chat.concat(e);const r=this.chat.length;!0===this.visible&&!0===this.isNearBottom?(this.readMessages=r,this.updateUnreadMessagesText(0),this.scrollToBottom()):this.updateUnreadMessagesText(r-this.readMessages)}updateUnreadMessagesText(e){this.showUnreadMessagesButton=!(!this.visible||!1!==this.isNearBottom),0===e?(this.unreadMessagesText=$localize`no new message`,this.showUnreadMessagesButton=!1):this.unreadMessagesText=1===e?$localize`1 new message`:$localize`${e} new messages`}scrollToBottomIfNeeded(){this.visible&&(this.isNearBottom||this.notYetScrolled)&&this.scrollToBottom()}updateCurrentScrollPosition(){this.isNearBottom=this.chatDiv.nativeElement.scrollTop+this.chatDiv.nativeElement.offsetHeight>this.chatDiv.nativeElement.scrollHeight-10}scrollToBottom(){null!=this.chatDiv&&(this.updateUnreadMessagesText(0),this.scrollTo(this.chatDiv.nativeElement.scrollHeight),this.notYetScrolled=!1)}scrollTo(e){this.chatDiv.nativeElement.scroll({top:e,left:0,behavior:"smooth"})}sendMessage(){var e=this;return A(function*(){const r=e.userMessage;e.userMessage="";const s=e.connectedUserService.user.get().toMinimalUser();yield e.chatService.sendMessage(e.chatId,s,r,e.turn)})()}ngOnDestroy(){this.chatSubscription.unsubscribe()}switchChatVisibility(){!0===this.visible?this.visible=!1:(this.visible=!0,this.updateUnreadMessagesText(0),this.scrollToBottom(),this.readMessages=this.chat.length)}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(J(PS),J(Ns))},n.\u0275cmp=gt({type:n,selectors:[["app-chat"]],viewQuery:function(e,r){if(1&e&&v4(V7t,5),2&e){let s;Sc(s=Pc())&&(r.chatDiv=s.first)}},inputs:{chatId:"chatId",turn:"turn"},decls:7,vars:4,consts:function(){let t,e,r,s;return t=$localize`Hide chat`,e=$localize`Show chat (${"\ufffd0\ufffd"}:INTERPOLATION:)`,r=$localize`Type your message here`,s=$localize`Be polite`,[["id","switchChatVisibilityButton",1,"button","is-primary","is-light","is-fullwidth",3,"click"],[4,"ngIf","ngIfElse"],["showChat",""],[4,"ngIf"],["id","chatForm",3,"onSubmit",4,"ngIf"],t,e,["id","scrollToBottomIndicator","class","notification button is-info is-light is-fullwidth",3,"click",4,"ngIf"],["id","chatDiv",1,"is-fullwidth","block",2,"overflow-y","scroll","max-height","50vh",3,"scroll"],["chatDiv",""],[4,"ngFor","ngForOf"],["id","scrollToBottomIndicator",1,"notification","button","is-info","is-light","is-fullwidth",3,"click"],[1,"chat-sender"],[1,"chat-message"],["id","chatForm",3,"onSubmit"],[1,"field","has-addons","is-fullwidth"],[1,"control","is-expanded"],["id","message","type","text","placeholder",r,"maxlength","128","value","",1,"input",3,"ngModel","ngModelOptions","ngModelChange"],["message",""],[1,"help"],[1,"control"],["type","submit","id","send",1,"button","is-primary",3,"click"],[1,"clickable-icon",3,"icon"],[1,"content","is-small"],s]},template:function(e,r){if(1&e&&(b(0,"div")(1,"button",0),ee("click",function(){return r.switchChatVisibility()}),x(2,H7t,2,0,"ng-container",1),x(3,F7t,1,1,"ng-template",null,2,r1),O(),x(5,U7t,5,2,"div",3),x(6,W7t,14,5,"form",4),O()),2&e){const s=Qn(4);S(2),T("ngIf",r.visible)("ngIfElse",s),S(3),T("ngIf",r.visible),S(1),T("ngIf",r.visible)}},dependencies:[An,en,Mu,M4,xl,Eu,SN,Mp,Ep,v9,t4e],encapsulation:2}),n})(),r4e=(()=>{class n{constructor(e,r,s){this.router=e,this.observedPartService=r,this.messageDisplayer=s}pickGame(e){this.selectedGame=e}navigateToOnlineGameCreation(){var e=this;return A(function*(){const r=e.observedPartService.canUserCreate();r.isSuccess()?yield e.router.navigate(["/play",e.selectedGame]):e.messageDisplayer.criticalMessage(r.getReason())})()}}return n.\u0275fac=function(e){return new(e||n)(J(Zn),J(O2),J(Pn))},n.\u0275cmp=gt({type:n,selectors:[["app-online-game-selection"]],decls:3,vars:1,consts:function(){let t;return t=$localize`Create an online game`,[[3,"pickGame"],["id","launchGame",1,"button","is-primary","is-fullwidth",3,"disabled","click"],t]},template:function(e,r){1&e&&(b(0,"app-pick-game",0),ee("pickGame",function(i){return r.pickGame(i)}),O(),b(1,"button",1),ee("click",function(){return r.navigateToOnlineGameCreation()}),_e(2,2),O()),2&e&&(S(1),T("disabled",!r.selectedGame))},dependencies:[qH],encapsulation:2}),n})();function q7t(n,t){if(1&n&&(un(0),Tt(1),fn()),2&n){const e=v().$implicit;S(1),l1(e.data.playerOne.name)}}function j7t(n,t){1&n&&(un(0),_e(1,26),fn())}function Z7t(n,t){if(1&n){const e=Oe();b(0,"tr",22),ee("click",function(){const i=he(e).$implicit;return le(v(2).joinGame(i))}),b(1,"td",23),Tt(2),O(),b(3,"td",23),Tt(4),O(),b(5,"td",23),x(6,q7t,2,1,"ng-container",24),x(7,j7t,2,0,"ng-template",null,25,r1),O(),b(9,"td",23),Tt(10),O()()}if(2&n){const e=t.$implicit,r=t.index,s=Qn(8);y1("id","part_",r,""),S(2),l1(e.data.typeGame),S(2),l1(e.data.playerZero.name),S(2),T("ngIf",e.data.playerOne)("ngIfElse",s),S(4),l1(e.data.turn)}}function Y7t(n,t){if(1&n&&(b(0,"div",13)(1,"div",14)(2,"table",15)(3,"thead")(4,"tr")(5,"th",16),_e(6,17),O(),b(7,"th",16),_e(8,18),O(),b(9,"th",16),_e(10,19),O(),b(11,"th",16),_e(12,20),O()()(),b(13,"tbody"),x(14,Z7t,11,6,"tr",21),O()()()()),2&n){const e=v();S(14),T("ngForOf",e.activeParts)}}function K7t(n,t){1&n&&(b(0,"div",27),Q(1,"app-online-game-selection",28),O())}function X7t(n,t){if(1&n&&(b(0,"li",39),Tt(1),Mc(2,"firebaseDate"),O()),2&n){const e=v().$implicit;Xb("id",e.data.username),S(1),KC("",e.data.username,": ",T3(2,3,e.data.lastUpdateTime),"")}}function Q7t(n,t){if(1&n&&(un(0),x(1,X7t,3,5,"li",38),fn()),2&n){const e=t.$implicit;S(1),T("ngIf",e.data.lastUpdateTime)}}function J7t(n,t){if(1&n&&(b(0,"div",29)(1,"div",30)(2,"div",31),Q(3,"app-chat",32),O()(),b(4,"div",33)(5,"div",34)(6,"p"),_e(7,35),O(),b(8,"ul",36),x(9,Q7t,2,1,"ng-container",37),O()()()()),2&n){const e=v();S(3),T("turn",-1),S(6),T("ngForOf",e.activeUsers)}}let eft=(()=>{class n{constructor(e,r,s,i,o){this.router=e,this.messageDisplayer=r,this.activePartsService=s,this.activeUsersService=i,this.observedPartService=o,this.activeUsers=[],this.activeParts=[],this.currentTab="games",this.createTabClasses=[]}ngOnInit(){X(n.VERBOSE,"lobbyComponent.ngOnInit"),this.activeUsersSubscription=this.activeUsersService.subscribeToActiveUsers(e=>{this.activeUsers=e}),this.activePartsSubscription=this.activePartsService.subscribeToActiveParts(e=>{this.activeParts=e}),this.observedPartService.subscribeToObservedPart(e=>{this.createTabClasses=[],e.isPresent()&&(this.createTabClasses=["disabled-tab"])})}ngOnDestroy(){X(n.VERBOSE,"lobbyComponent.ngOnDestroy"),this.activeUsersSubscription.unsubscribe(),this.activePartsSubscription.unsubscribe()}joinGame(e){var r=this;return A(function*(){const s=e.id,i=e.data.typeGame,c=r.observedPartService.canUserJoin(s,null!=e.data.beginning);c.isSuccess()?yield r.router.navigate(["/play",i,s]):r.messageDisplayer.criticalMessage(c.getReason())})()}selectTab(e){if("create"===e){const r=this.observedPartService.canUserCreate();r.isSuccess()?this.currentTab=e:this.messageDisplayer.criticalMessage(r.getReason())}else this.currentTab=e}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(J(Zn),J(Pn),J(D7t),J(z7t),J(O2))},n.\u0275cmp=gt({type:n,selectors:[["app-lobby"]],decls:14,vars:4,consts:function(){let t,e,r,s,i,o,c,u,h;return t=$localize`Games`,e=$localize`Create`,r=$localize`Chat`,s=$localize`Game`,i=$localize`First player`,o=$localize`Second player`,c=$localize`Turn`,u=$localize`Waiting for opponent`,h=$localize`Connected users:`,[[1,"tabs","is-toggle","is-fullwidth"],["ngClass","if (currentTab === 'games') 'is-active'"],["id","tab-games",3,"click"],t,["ngClass","if (currentTab === 'create') 'is-active'"],["id","tab-create",3,"ngClass","click"],e,["ngClass","if (currentTab === 'chat') 'is-active'"],["id","tab-chat",3,"click"],r,["id","actualGames","class","box",4,"ngIf"],["id","gameCreator","class","box",4,"ngIf"],["id","chatTab","class","columns",4,"ngIf"],["id","actualGames",1,"box"],[1,"table-container"],[1,"table","is-fullwidth","is-hoverable","is-striped"],["scope","col",1,"th"],s,i,o,c,[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"td"],[4,"ngIf","ngIfElse"],["waitingForOpponent",""],u,["id","gameCreator",1,"box"],["id","online-game-selection"],["id","chatTab",1,"columns"],["id","chatContainerDiv",1,"column","is-12"],["id","chat",1,"box"],["chatId","server",3,"turn"],[1,"column","is-3","is-hidden"],["id","onlineUsers",1,"box"],h,["id","activeUsersList"],[4,"ngFor","ngForOf"],[3,"id",4,"ngIf"],[3,"id"]]},template:function(e,r){1&e&&(b(0,"div",0)(1,"ul")(2,"li",1)(3,"a",2),ee("click",function(){return r.selectTab("games")}),_e(4,3),O()(),b(5,"li",4)(6,"a",5),ee("click",function(){return r.selectTab("create")}),_e(7,6),O()(),b(8,"li",7)(9,"a",8),ee("click",function(){return r.selectTab("chat")}),_e(10,9),O()()()(),x(11,Y7t,15,1,"div",10),x(12,K7t,2,0,"div",11),x(13,J7t,10,2,"div",12)),2&e&&(S(6),T("ngClass",r.createTabClasses),S(5),T("ngIf","games"===r.currentTab),S(1),T("ngIf","create"===r.currentTab),S(1),T("ngIf","chat"===r.currentTab))},dependencies:[dn,An,en,n4e,r4e,t4e],encapsulation:2}),n})(),s4e=(()=>{class n{constructor(e){this.route=e,this.message=e.snapshot.paramMap.get("message")??$localize`This page does not exist.`}}return n.\u0275fac=function(e){return new(e||n)(J(bo))},n.\u0275cmp=gt({type:n,selectors:[["app-not-found"]],decls:5,vars:1,consts:function(){let t;return t=$localize`Not found`,[[1,"message","is-danger"],[1,"message-header"],t,[1,"message-body"]]},template:function(e,r){1&e&&(b(0,"div",0)(1,"div",1),_e(2,2),O(),b(3,"div",3),Tt(4),O()()),2&e&&(S(4),l1(r.message))},encapsulation:2}),n})();class B9{constructor(t,e,r){this.added=t,this.modified=e,this.removed=r}static from(t,e){const r=new B9({},{},{});if(null==t)return r.added={...e},r;if(null==e)return r.removed={...t},r;const s=Object.keys(t),i=Object.keys(e),o=s.filter(h=>!1===i.includes(h)),c=s.filter(h=>i.includes(h)),u=i.filter(h=>!1===s.includes(h));return r.addNewKeys(u,e),r.addCommonKeys(c,e,t),r.addRemovedKeys(o,t),r}static differs(t,e){return B9.from(t,e).countChanges()>0}addNewKeys(t,e){for(const r of t)null!=e[r]&&(this.added[r]=e[r])}addCommonKeys(t,e,r){for(const s of t)this.addCommonKey(s,r[s],e[s])}addCommonKey(t,e,r){if(null==r)null!=e&&(this.removed[t]=e);else if(null==e)this.added[t]=r;else if(["string","boolean","number"].includes(typeof e))e!==r&&(this.modified[t]=r);else if(Array.isArray(e)){if(!Array.isArray(r))throw new Error("Thing should not change type");e.length===r.length?this.addCommonKeyList(t,e,r):this.modified[t]=r}else{ve("object"==typeof e,`ObjectDifference: expected JSON, but got a ${typeof e} in ${t}`),ve("object"==typeof r,`ObjectDifference: expected JSON, but got a ${typeof r} in ${t}`);const o=B9.from(e,r);o.countChanges()>0&&(this.modified[t]=o)}}addCommonKeyList(t,e,r){let s=!0;for(let i=0;s&&i<e.length;i++)typeof e[i]==typeof r[i]&&"object"==typeof e[i]?B9.differs(e[i],r[i])&&(s=!1,this.modified[t]=r):e[i]!==r[i]&&(s=!1,this.modified[t]=r)}addRemovedKeys(t,e){for(const r of t)this.removed[r]=e[r]}countChanges(){const t=Object.keys(this.removed).length,e=Object.keys(this.modified).length;return Object.keys(this.added).length+e+t}isPresent(t){return null!=this.added[t]?{state:"added",present:!0}:null!=this.modified[t]?{state:"modified",present:!0}:null!=this.removed[t]?{state:"removed",present:!0}:{state:null,present:!1}}isFullyCreated(){return 0===Object.keys(this.modified).length&&0===Object.keys(this.removed).length}addedOrModified(t){const e=this.isPresent(t);return!0===e.present&&"removed"!==e.state}}function i4e(n){return 1e3*n.seconds+n.nanoseconds/1e6}function o4e(n,t){return i4e(t)-i4e(n)}function e_(n){return gr((t,e)=>{uo(n).subscribe(cs(e,()=>e.complete(),lo)),!e.closed&&t.subscribe(e)})}let tft=(()=>{class n{transform(e){const r=e%60,s=(e-r)%3600/60,i=(e-60*s-r)/3600,o=[];if(i>1?o.push($localize`${i} hours`):1===i&&o.push($localize`1 hour`),s>1?o.push($localize`${s} minutes`):1===s&&o.push($localize`1 minute`),r>1?o.push($localize`${r} seconds`):1===r&&o.push($localize`1 second`),0===o.length)return $localize`0 seconds`;if(1===o.length)return o[0];{const c=o.slice(0,-1).join(", "),u=o.slice(-1)[0];return $localize`${c} and ${u}`}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275pipe=ai({name:"humanDuration",type:n,pure:!0}),n})();function nft(n,t){if(1&n&&(un(0),Tt(1),fn()),2&n){const e=v(3);S(1),l1(e.viewInfo.chosenOpponent)}}function rft(n,t){1&n&&_e(0,44)}function sft(n,t){if(1&n&&(b(0,"div",45)(1,"div",8)(2,"label",46),un(3),_e(4,47),fn(),b(5,"output"),Tt(6),Mc(7,"humanDuration"),O()(),b(8,"div",37),Q(9,"input",48),O()(),b(10,"div",8)(11,"label",49),yc(12,50),Q(13,"output"),Mc(14,"humanDuration"),Ec(),O(),b(15,"div",37),Q(16,"input",51),O()()()),2&n){const e=v(3);S(6),l1(T3(7,2,e.viewInfo.maximalMoveDuration||0)),S(8),k1(T3(14,4,e.viewInfo.totalPartDuration||0)),F1(12)}}function ift(n,t){1&n&&(b(0,"div"),yc(1,52),Q(2,"br"),Ec(),O())}function oft(n,t){1&n&&(b(0,"button",64),_e(1,65),O())}function aft(n,t){if(1&n){const e=Oe();b(0,"tr",60),ee("click",function(){const i=he(e).$implicit;return le(v(4).selectOpponent(i))}),b(1,"td",61),Tt(2),O(),b(3,"td",62),x(4,oft,2,0,"button",63),O()()}if(2&n){const e=t.$implicit,r=v(4);y1("id","presenceOf_",e,""),T("ngClass",r.viewInfo.candidateClasses[e]),S(1),T("id",r.viewInfo.chosenOpponent===e?"selected_"+e:"candidate_"+e),S(1),l1(e),S(2),T("ngIf",r.viewInfo.chosenOpponent!==e)}}function cft(n,t){if(1&n&&(un(0),_e(1,53),fn(),b(2,"div",54)(3,"table",55)(4,"thead")(5,"tr")(6,"th",56),_e(7,57),O(),b(8,"th",56),_e(9,58),O()()(),b(10,"tbody"),x(11,aft,5,5,"tr",59),O()()()),2&n){const e=v(3);S(11),T("ngForOf",e.viewInfo.candidates)}}function lft(n,t){if(1&n){const e=Oe();b(0,"button",66),ee("click",function(){return he(e),le(v(3).changeConfig())}),_e(1,67),O()}}function uft(n,t){if(1&n){const e=Oe();b(0,"div")(1,"h1",4),_e(2,5),O(),b(3,"form",6)(4,"fieldset",7)(5,"div",8)(6,"label",9),_e(7,10),O(),b(8,"div",11)(9,"button",12),ee("click",function(){return he(e),le(v(2).selectFirstPlayer("RANDOM"))}),_e(10,13),O(),b(11,"button",14),ee("click",function(){return he(e),le(v(2).selectFirstPlayer("CREATOR"))}),_e(12,15),O(),b(13,"button",16),ee("click",function(){return he(e),le(v(2).selectFirstPlayer("CHOSEN_PLAYER"))}),x(14,nft,2,1,"ng-container",17),x(15,rft,1,0,"ng-template",null,18,r1),O()()(),b(17,"div",8)(18,"label",9),_e(19,19),O(),b(20,"div",11)(21,"div",20),ee("click",function(){return he(e),le(v(2).selectPartType("STANDARD"))}),b(22,"div",21)(23,"span"),_e(24,22),O()(),b(25,"div",23)(26,"div",24)(27,"div",25)(28,"p"),un(29),_e(30,26),fn(),b(31,"strong"),Tt(32),Mc(33,"humanDuration"),O(),Q(34,"br"),un(35),yc(36,27),Q(37,"strong"),Mc(38,"humanDuration"),Ec(),fn(),O()()()()(),b(39,"div",28),ee("click",function(){return he(e),le(v(2).selectPartType("BLITZ"))}),b(40,"div",21)(41,"span"),_e(42,29),O()(),b(43,"div",23)(44,"div",24)(45,"div",25)(46,"p"),un(47),_e(48,30),fn(),b(49,"strong"),Tt(50),Mc(51,"humanDuration"),O(),Q(52,"br"),un(53),yc(54,31),Q(55,"strong"),Mc(56,"humanDuration"),Ec(),fn(),O()()()()(),b(57,"button",32),ee("click",function(){return he(e),le(v(2).selectPartType("CUSTOM"))}),_e(58,33),O()()(),x(59,sft,17,6,"div",34),b(60,"div",8)(61,"label",35),_e(62,36),O(),b(63,"div",37),x(64,ift,3,0,"div",17),x(65,cft,12,1,"ng-template",null,38,r1),O()()(),b(67,"div",8)(68,"div",11)(69,"button",39),ee("click",function(){return he(e),le(v(2).proposeConfig())}),_e(70,40),O(),x(71,lft,2,0,"button",41),b(72,"button",42),ee("click",function(){return he(e),le(v(2).cancelGameCreation())}),_e(73,43),O()()()()()}if(2&n){const e=Qn(16),r=Qn(66),s=v(2);S(3),T("formGroup",s.configFormGroup),S(1),T("disabled",!s.viewInfo.canEditConfig),S(5),T("ngClass",s.viewInfo.firstPlayerClasses.RANDOM),S(2),T("ngClass",s.viewInfo.firstPlayerClasses.CREATOR),S(2),T("ngClass",s.viewInfo.firstPlayerClasses.CHOSEN_PLAYER),S(1),T("ngIf",s.viewInfo.chosenOpponent)("ngIfElse",e),S(7),T("ngClass",s.viewInfo.partTypeClasses.STANDARD),S(11),l1(T3(33,19,s.partType.NORMAL_MOVE_DURATION)),S(6),k1(T3(38,21,s.partType.NORMAL_PART_DURATION)),F1(36),S(1),T("ngClass",s.viewInfo.partTypeClasses.BLITZ),S(11),l1(T3(51,23,s.partType.BLITZ_MOVE_DURATION)),S(6),k1(T3(56,25,s.partType.BLITZ_PART_DURATION)),F1(54),S(1),T("ngClass",s.viewInfo.partTypeClasses.CUSTOM),S(2),T("ngIf",s.viewInfo.showCustomTime),S(5),T("ngIf",0===s.viewInfo.candidates.length)("ngIfElse",r),S(5),T("disabled",!s.viewInfo.canProposeConfig),S(2),T("ngIf",s.viewInfo.canReviewConfig)}}function fft(n,t){if(1&n&&(b(0,"div",74)(1,"p"),yc(2,75),Q(3,"br"),Ec(),O()()),2&n){const e=v(3);S(3),k1(e.viewInfo.creator),F1(2)}}function hft(n,t){if(1&n&&(b(0,"span"),_e(1,81),O()),2&n){const e=v(4);S(1),k1(e.viewInfo.creator),F1(1)}}function dft(n,t){1&n&&(b(0,"span"),_e(1,82),O())}function pft(n,t){1&n&&(b(0,"span"),_e(1,83),O())}function gft(n,t){if(1&n){const e=Oe();b(0,"div",74)(1,"p"),_e(2,76),O(),b(3,"ul")(4,"li"),x(5,hft,2,1,"span",2),x(6,dft,2,0,"span",2),x(7,pft,2,0,"span",2),O(),b(8,"li"),yc(9,77),Q(10,"strong"),Mc(11,"humanDuration"),Ec(),O(),b(12,"li"),yc(13,78),Q(14,"strong"),Mc(15,"humanDuration"),Ec(),O()(),b(16,"button",79),ee("click",function(){return he(e),le(v(3).acceptConfig())}),_e(17,80),O()()}if(2&n){const e=v(3);S(2),k1(e.viewInfo.creator)(e.viewInfo.partTypeName),F1(2),S(3),T("ngIf","CREATOR"===e.viewInfo.firstPlayer),S(1),T("ngIf","CHOSEN_PLAYER"===e.viewInfo.firstPlayer),S(1),T("ngIf","RANDOM"===e.viewInfo.firstPlayer),S(4),k1(T3(11,7,e.viewInfo.maximalMoveDuration||0)),F1(9),S(4),k1(T3(15,9,e.viewInfo.totalPartDuration||0)),F1(13)}}function mft(n,t){if(1&n&&(b(0,"div")(1,"div",68)(2,"div",69)(3,"p"),_e(4,70),O()(),b(5,"div",71),x(6,fft,4,1,"div",72),x(7,gft,18,11,"ng-template",null,73,r1),O()()()),2&n){const e=Qn(8),r=v(2);S(6),T("ngIf",r.viewInfo.creatorIsModifyingConfig)("ngIfElse",e)}}function _ft(n,t){if(1&n&&(un(0),_e(1,86),fn()),2&n){const e=v(3);S(1),k1(e.viewInfo.creator),F1(1)}}function vft(n,t){if(1&n&&_e(0,87),2&n){const e=v(3);k1(e.viewInfo.creator)(e.viewInfo.chosenOpponent),F1(0)}}function Cft(n,t){if(1&n&&(b(0,"div",68)(1,"div",69)(2,"p"),_e(3,84),O()(),b(4,"div",71)(5,"p"),x(6,_ft,2,1,"ng-container",17),x(7,vft,1,2,"ng-template",null,85,r1),O()()()),2&n){const e=Qn(8),r=v(2);S(6),T("ngIf",r.viewInfo.creatorIsModifyingConfig)("ngIfElse",e)}}function yft(n,t){if(1&n&&(b(0,"div",1),x(1,uft,74,27,"div",2),x(2,mft,9,2,"div",2),x(3,Cft,9,2,"div",3),O()),2&n){const e=v();S(1),T("ngIf",e.viewInfo.userIsCreator),S(1),T("ngIf",e.viewInfo.userIsChosenOpponent),S(1),T("ngIf",e.viewInfo.userIsObserver)}}class h1{constructor(t,e,r,s,i,o,c,u,h,p){this.router=t,this.actRoute=e,this.connectedUserService=r,this.observedPartService=s,this.gameService=i,this.configRoomService=o,this.chatService=c,this.userService=u,this.formBuilder=h,this.messageDisplayer=p,this.partType=br,this.gameStartNotification=new mr,this.gameStarted=!1,this.viewInfo={userIsCreator:!1,userIsChosenOpponent:!1,userIsObserver:!1,partType:"STANDARD",partTypeClasses:{STANDARD:["is-selected","is-primary"],BLITZ:[],CUSTOM:[]},firstPlayer:"RANDOM",firstPlayerClasses:{CREATOR:[],RANDOM:["is-selected","is-primary"],CHOSEN_PLAYER:[]},candidateClasses:{},candidates:[]},this.currentConfigRoom=null,this.candidates=[],this.ngUnsubscribe=new F2,this.allUserInterval=P.empty(),this.ownTokenInterval=P.empty(),this.selfSubscription=new Z1,this.configRoomSubscription=new Z1,this.candidatesSubscription=new Z1,this.allDocDeleted=!1,X(h1.VERBOSE,"PartCreationComponent constructed")}ngOnInit(){var t=this;return A(function*(){X(h1.VERBOSE,"PartCreationComponent.ngOnInit"),t.checkInputs(),t.createForms();const e=yield t.configRoomService.joinGame(t.partId);if(e.isFailure()){const r=e.getReason();t.messageDisplayer.criticalMessage(r)}else yield t.startSendingPresenceTokens(),t.subscribeToConfigRoomDoc(),t.subscribeToFormElements(),X(h1.VERBOSE,"PartCreationComponent.ngOnInit asynchronouseries finisheds")})()}checkInputs(){const t=this.connectedUserService.user;ve(t.isPresent(),"PartCreationComponent should not be called without connected user"),ve(t.get()!==_5.NOT_CONNECTED,"PartCreationComponent should not be created with an empty userName"),ve(""!==this.partId,"PartCreationComponent should not be created with an empty partId")}createForms(){this.configFormGroup=this.formBuilder.group({firstPlayer:[Zs.RANDOM.value,mp.required],maximalMoveDuration:[br.NORMAL_MOVE_DURATION,mp.required],partType:["STANDARD",mp.required],totalPartDuration:[br.NORMAL_PART_DURATION,mp.required],chosenOpponent:["",mp.required]})}updateUserDocWithObservedPart(t){X(h1.VERBOSE,"updateUserDocWithObservedPart of '"+this.partId+"'");const e=this.getUserRoleInPart(t),r={id:this.partId,opponent:this.getOpponent(),typeGame:Me.getNonNullable(this.actRoute.snapshot.paramMap.get("compo")),role:e};return this.observedPartService.updateObservedPart(r)}getUserRoleInPart(t){const e=this.connectedUserService.user.get().id;return e===t.creator.id?"Creator":e===t.chosenOpponent?.id?"ChosenOpponent":"Candidate"}getOpponent(){let t=null;return t=this.connectedUserService.user.get().id===this.currentConfigRoom?.creator.id?this.currentConfigRoom.chosenOpponent:Me.getNonNullable(this.currentConfigRoom?.creator),t}subscribeToConfigRoomDoc(){var t=this;const e=function(){var s=A(function*(i){yield t.onCurrentConfigRoomUpdate(i)});return function(o){return s.apply(this,arguments)}}(),r=function(){var s=A(function*(i){yield t.onCandidatesUpdate(i)});return function(o){return s.apply(this,arguments)}}();this.configRoomSubscription=this.configRoomService.subscribeToChanges(this.partId,e),this.candidatesSubscription=this.configRoomService.subscribeToCandidates(this.partId,r)}getForm(t){return Me.getNonNullable(this.configFormGroup.get(t))}subscribeToFormElements(){this.getForm("chosenOpponent").valueChanges.pipe(e_(this.ngUnsubscribe)).subscribe(t=>{void 0!==this.viewInfo.chosenOpponent&&(this.viewInfo.candidateClasses[this.viewInfo.chosenOpponent]=[]),this.viewInfo.candidateClasses[t]=["is-selected"],this.viewInfo.chosenOpponent=t;const e=Me.getNonNullable(this.currentConfigRoom).partStatus;this.viewInfo.canProposeConfig=e!==Ys.CONFIG_PROPOSED.value&&""!==t}),this.getForm("partType").valueChanges.pipe(e_(this.ngUnsubscribe)).subscribe(t=>{this.viewInfo.partTypeClasses[this.viewInfo.partType]=[],this.viewInfo.partTypeClasses[t]=["is-primary","is-selected"],this.viewInfo.partType=t,this.viewInfo.showCustomTime="CUSTOM"===t}),this.getForm("maximalMoveDuration").valueChanges.pipe(e_(this.ngUnsubscribe)).subscribe(t=>{this.viewInfo.maximalMoveDuration=t}),this.getForm("totalPartDuration").valueChanges.pipe(e_(this.ngUnsubscribe)).subscribe(t=>{this.viewInfo.totalPartDuration=t}),this.getForm("firstPlayer").valueChanges.pipe(e_(this.ngUnsubscribe)).subscribe(t=>{this.viewInfo.firstPlayerClasses[this.viewInfo.firstPlayer]=[],this.viewInfo.firstPlayerClasses[t]=["is-primary","is-selected"],this.viewInfo.firstPlayer=t})}updateViewInfo(){const t=Me.getNonNullable(this.currentConfigRoom),e=this.connectedUserService.user.get();switch(this.viewInfo.canReviewConfig=t.partStatus===Ys.CONFIG_PROPOSED.value,this.viewInfo.canEditConfig=t.partStatus!==Ys.CONFIG_PROPOSED.value,this.viewInfo.userIsCreator=this.userIsCreator(t),this.viewInfo.userIsChosenOpponent=e.id===t.chosenOpponent?.id,this.viewInfo.userIsObserver=!1===this.viewInfo.userIsChosenOpponent&&!1===this.viewInfo.userIsCreator,this.viewInfo.creatorIsModifyingConfig=t.partStatus!==Ys.CONFIG_PROPOSED.value,this.viewInfo.showCustomTime="CUSTOM"===this.getForm("partType").value,this.viewInfo.creator=t.creator.name,this.viewInfo.candidates=this.candidates.map(r=>r.name),this.userIsCreator(t)?this.setDataForCreator(t):(this.viewInfo.maximalMoveDuration=t.maximalMoveDuration,this.viewInfo.totalPartDuration=t.totalPartDuration,this.viewInfo.partType=t.partType,this.viewInfo.chosenOpponent=t.chosenOpponent?.name,this.viewInfo.firstPlayer=t.firstPlayer),t.partType){case"CUSTOM":this.viewInfo.partTypeName=$localize`custom`;break;case"BLITZ":this.viewInfo.partTypeName=$localize`blitz`;break;case"STANDARD":this.viewInfo.partTypeName=$localize`standard`}}setDataForCreator(t){this.viewInfo.maximalMoveDuration=this.viewInfo.maximalMoveDuration??t.maximalMoveDuration,this.viewInfo.totalPartDuration=this.viewInfo.totalPartDuration??t.totalPartDuration;let e=this.viewInfo.chosenOpponent;null==e||""===e?e=t.chosenOpponent?.name??"":!1===this.candidates.some(s=>s.name===e)&&(e=""),this.getForm("chosenOpponent").setValue(e)}selectFirstPlayer(t){this.getForm("firstPlayer").setValue(t)}selectPartType(t){"STANDARD"===t?(this.getForm("maximalMoveDuration").setValue(br.NORMAL_MOVE_DURATION),this.getForm("totalPartDuration").setValue(br.NORMAL_PART_DURATION)):"BLITZ"===t&&(this.getForm("maximalMoveDuration").setValue(br.BLITZ_MOVE_DURATION),this.getForm("totalPartDuration").setValue(br.BLITZ_PART_DURATION)),this.getForm("partType").setValue(t)}selectOpponent(t){var e=this;return A(function*(){X(h1.VERBOSE,"PartCreationComponent.setChosenOpponent("+t+")");const r=e.getUserFromName(t);yield Promise.all([e.observedPartService.updateObservedPart({opponent:r}),e.configRoomService.setChosenOpponent(e.partId,r)])})()}getUserFromName(t){const e=this.candidates.find(r=>r.name===t);return Me.getNonNullable(e)}changeConfig(){var t=this;return A(function*(){return t.configRoomService.reviewConfig(t.partId)})()}proposeConfig(){var t=this;return A(function*(){const e=t.getForm("chosenOpponent").value,r=t.getForm("partType").value,s=t.getForm("maximalMoveDuration").value,i=t.getForm("firstPlayer").value,o=t.getForm("totalPartDuration").value,c=t.getUserFromName(e);return t.configRoomService.proposeConfig(t.partId,c,br.of(r),s,Zs.of(i),o)})()}cancelGameCreation(){var t=this;return A(function*(){t.allDocDeleted=!0,yield t.observedPartService.removeObservedPart(),X(h1.VERBOSE,"PartCreationComponent.cancelGameCreation"),yield t.chatService.deleteChat(t.partId),X(h1.VERBOSE,"PartCreationComponent.cancelGameCreation: chat deleted"),yield t.gameService.deletePart(t.partId),X(h1.VERBOSE,"PartCreationComponent.cancelGameCreation: chat and part deleted"),yield t.configRoomService.deleteConfigRoom(t.partId,t.candidates),X(h1.VERBOSE,"PartCreationComponent.cancelGameCreation: chat, part, and configRoom deleted")})()}onCurrentConfigRoomUpdate(t){var e=this;return A(function*(){if(X(h1.VERBOSE,{PartCreationComponent_onCurrentConfigRoomUpdate:{before:JSON.stringify(e.currentConfigRoom),then:JSON.stringify(t)}}),t.isAbsent())return X(h1.VERBOSE,"PartCreationComponent.onCurrentConfigRoomUpdate: LAST UPDATE : the game is cancelled"),e.onGameCancelled();{const r=t.get();if(e.chosenOpponentJustLeft(r)&&e.userIsCreator(r)){const i=Me.getNonNullable(e.currentConfigRoom),o=Me.getNonNullable(i.chosenOpponent).name;e.messageDisplayer.infoMessage($localize`${o} left the game, please pick another opponent.`),yield e.observedPartService.updateObservedPart({opponent:null})}let s=!1;e.userJustChosenAsOpponent(r)&&(yield e.updateUserDocWithObservedPart(r),s=!0),e.currentConfigRoom=r,e.allUserInterval.isAbsent()&&(ve(!1===s,"Expected observedPartUpdate to be false at first call of onCurrentConfigRoomUpdate"),yield e.updateUserDocWithObservedPart(e.currentConfigRoom),yield e.observeNeededPlayers()),e.updateViewInfo(),e.isGameStarted(e.currentConfigRoom)&&(X(h1.VERBOSE,"PartCreationComponent.onCurrentConfigRoomUpdate: the game has started"),e.onGameStarted())}})()}onCandidatesUpdate(t){var e=this;return A(function*(){e.candidates=t,e.updateViewInfo()})()}userJustChosenAsOpponent(t){if(this.isGameStarted(t))return!1;const e=this.connectedUserService.user.get().id;return this.currentConfigRoom?.chosenOpponent?.id!==e&&t.chosenOpponent?.id===e}chosenOpponentJustLeft(t){return null!=this.currentConfigRoom&&(null!=this.currentConfigRoom.chosenOpponent&&null==t.chosenOpponent)}onGameCancelled(){var t=this;return A(function*(){X(h1.VERBOSE,"PartCreationComponent.onGameCancelled"),t.messageDisplayer.infoMessage($localize`The game has been canceled!`),yield t.router.navigate(["/lobby"])})()}isGameStarted(t){return ve(null!=t,"configRoom should not be null (isGameStarted)"),Me.getNonNullable(t).partStatus===Ys.PART_STARTED.value}onGameStarted(){const t=Me.getNonNullable(this.currentConfigRoom);X(h1.VERBOSE,{partCreationComponent_onGameStarted:{configRoom:t}}),this.gameStartNotification.emit(t),this.gameStarted=!0,X(h1.VERBOSE,"PartCreationComponent.onGameStarted finished")}observeNeededPlayers(){var t=this;return A(function*(){const e=Me.getNonNullable(t.currentConfigRoom);X(h1.VERBOSE,{PartCreationComponent_observeNeededPlayers:{configRoom:e}}),ve(t.allUserInterval.isAbsent(),"Cannot observe players multiple times"),t.allUserInterval=P.of(window.setInterval(A(function*(){const r=t.lastToken;t.userIsCreator(e)?yield t.checkCandidatesTokensFreshness(r):yield t.checkCreatorTokenFreshness(r)}),h1.TOKEN_INTERVAL))})()}userIsCreator(t){return this.connectedUserService.user.get().id===t.creator.id}checkCreatorTokenFreshness(t){var e=this;return A(function*(){const r=Me.getNonNullable(e.currentConfigRoom);(yield e.didUserTimeout(r.creator.id,t))&&(yield e.destroyDocIfPartDidNotStart())})()}destroyDocIfPartDidNotStart(){var t=this;return A(function*(){ve(!1===t.isGameStarted(t.currentConfigRoom),"Should not try to cancelGameCreation when part started!"),ve(!1===t.allDocDeleted,"Should not delete doc twice"),yield t.cancelGameCreation()})()}checkCandidatesTokensFreshness(t){var e=this;return A(function*(){for(const r of e.candidates)(yield e.didUserTimeout(r.id,t))&&(yield e.removeCandidateFromLobby(r))})()}didUserTimeout(t,e){var r=this;return A(function*(){const s=yield r.userService.getUserLastUpdateTime(t);return s.isAbsent()?(Os.logError("PartCreationComponent","found no user while observing "+t+" !"),!0):o4e(s.get(),e)>h1.TOKEN_TIMEOUT})()}removeCandidateFromLobby(t){var e=this;return A(function*(){const r=Me.getNonNullable(e.currentConfigRoom);return t.id===r.chosenOpponent?.id&&(yield e.configRoomService.reviewConfigAndRemoveChosenOpponent(e.partId)),e.configRoomService.removeCandidate(e.partId,t)})()}startSendingPresenceTokens(){var t=this;return A(function*(){yield t.connectedUserService.sendPresenceToken(),ve(t.ownTokenInterval.isAbsent(),"should not start sending presence tokens twice"),t.ownTokenInterval=P.of(window.setInterval(()=>{t.connectedUserService.sendPresenceToken()},h1.TOKEN_INTERVAL));const e=t.connectedUserService.user.get().id;t.selfSubscription=t.userService.observeUser(e,r=>{ve(r.isPresent(),"connected user should exist");const s=r.get();null!=s.lastUpdateTime&&(t.lastToken=s.lastUpdateTime)})})()}stopSendingPresenceTokensAndObservingUsersIfNeeded(){this.ownTokenInterval.isPresent()&&(window.clearInterval(this.ownTokenInterval.get()),this.ownTokenInterval=P.empty()),this.allUserInterval.isPresent()&&window.clearInterval(this.allUserInterval.get()),this.selfSubscription.unsubscribe()}acceptConfig(){return X(h1.VERBOSE,"PartCreationComponent.acceptConfig"),this.gameService.acceptConfig(this.partId,Me.getNonNullable(this.currentConfigRoom))}ngOnDestroy(){var t=this;return A(function*(){X(h1.VERBOSE,"PartCreationComponent.ngOnDestroy"),t.ngUnsubscribe.next(),t.ngUnsubscribe.complete(),t.configRoomSubscription.unsubscribe(),t.candidatesSubscription.unsubscribe(),t.stopSendingPresenceTokensAndObservingUsersIfNeeded();const e=t.connectedUserService.user.get();!0!==t.gameStarted&&(null===t.currentConfigRoom?X(h1.VERBOSE,"PartCreationComponent.ngOnDestroy: there is no part here"):!0===t.allDocDeleted?X(h1.VERBOSE,"PartCreationComponent.ngOnDestroy: part has already been deleted"):e.id===t.currentConfigRoom.creator.id?(X(h1.VERBOSE,"PartCreationComponent.ngOnDestroy: you(creator) about to cancel creation."),yield t.cancelGameCreation()):(X(h1.VERBOSE,"PartCreationComponent.ngOnDestroy: you are about to cancel game joining"),yield t.observedPartService.removeObservedPart(),yield t.configRoomService.cancelJoining(t.partId)))})()}}function Eft(n,t){if(1&n){const e=Oe();b(0,"button",3),ee("click",function(){return he(e),le(v().addTime())}),_e(1,4),O()}if(2&n){const e=v();S(1),k1(e.timeToAdd),F1(1)}}h1.VERBOSE=!1,h1.TOKEN_INTERVAL=5e3,h1.TOKEN_TIMEOUT=2*h1.TOKEN_INTERVAL,h1.\u0275fac=function(t){return new(t||h1)(J(Zn),J(bo),J(Ns),J(O2),J(OS),J(jz),J(PS),J(gm),J(p7e),J(Pn))},h1.\u0275cmp=gt({type:h1,selectors:[["app-part-creation"]],inputs:{partId:"partId"},outputs:{gameStartNotification:"gameStartNotification"},decls:1,vars:1,consts:function(){let n,t,e,r,s,i,o,c,u,h,p,m,C,w,I,H,K,ie,ye,te,ke,$e,Xe,Ft,D1,N1,is,Kc,$o,H2,Yn,E6,Mt,Wt,Xt,o1;return n=$localize`Game creation`,t=$localize`First player`,e=$localize`Random`,r=$localize`You`,s=$localize`Game type`,i=$localize`Standard`,o=$localize`Maximal turn duration: `,c=$localize`Maximal game duration: ${"\ufffd#37\ufffd"}:START_TAG_STRONG:${"\ufffd0\ufffd"}:INTERPOLATION: per player${"\ufffd/#37\ufffd"}:CLOSE_TAG_STRONG:`,u=$localize`Blitz`,h=$localize`Maximal turn duration: `,p=$localize`Maximal game duration: ${"\ufffd#55\ufffd"}:START_TAG_STRONG:${"\ufffd0\ufffd"}:INTERPOLATION: per player${"\ufffd/#55\ufffd"}:CLOSE_TAG_STRONG:`,m=$localize`Custom`,C=$localize`Opponents`,w=$localize`Propose configuration`,I=$localize`Cancel game`,H=$localize`The opponent`,K=$localize`Maximal turn duration: `,ie=$localize`Maximal game duration: ${"\ufffd#13\ufffd"}:START_TAG_OUTPUT:${"\ufffd0\ufffd"}:INTERPOLATION: per player${"\ufffd/#13\ufffd"}:CLOSE_TAG_OUTPUT:`,ye=$localize`Potential opponents that join the game will appear here.${"\ufffd#2\ufffd\ufffd/#2\ufffd"}:LINE_BREAK:Wait for an opponent to join, so that you can pick one.`,te=$localize`Click on the opponent against which you would like to play.`,ke=$localize`Name`,$e=$localize`Actions`,Xe=$localize`Pick`,Ft=$localize`Change configuration`,D1=$localize`Configuration proposal`,N1=$localize`You have been selected as the opponent.${"\ufffd#3\ufffd\ufffd/#3\ufffd"}:LINE_BREAK: ${"\ufffd0\ufffd"}:INTERPOLATION: is modifying the configuration.`,is=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: proposes to play a ${"\ufffd1\ufffd"}:INTERPOLATION_1: game`,Kc=$localize`a turn lasts at most ${"\ufffd#10\ufffd"}:START_TAG_STRONG:${"\ufffd0\ufffd"}:INTERPOLATION: ${"\ufffd/#10\ufffd"}:CLOSE_TAG_STRONG:`,$o=$localize`the game lasts at most ${"\ufffd#14\ufffd"}:START_TAG_STRONG:${"\ufffd0\ufffd"}:INTERPOLATION: per player${"\ufffd/#14\ufffd"}:CLOSE_TAG_STRONG:`,H2=$localize`Accept and start`,Yn=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: plays first`,E6=$localize`you play first`,Mt=$localize`the first player is selected randomly`,Wt=$localize`One moment...`,Xt=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: is configuring the game.`,o1=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: has proposed a configuration to ${"\ufffd1\ufffd"}:INTERPOLATION_1:.`,[["class","box",4,"ngIf"],[1,"box"],[4,"ngIf"],["class","message is-primary",4,"ngIf"],[1,"title"],n,[3,"formGroup"],[3,"disabled"],[1,"field"],["for","firstPlayer",1,"label"],t,[1,"buttons","has-addons"],["id","firstPlayerRandom",1,"button",3,"ngClass","click"],e,["id","firstPlayerCreator",1,"button",3,"ngClass","click"],r,["id","firstPlayerOpponent",1,"button",3,"ngClass","click"],[4,"ngIf","ngIfElse"],["opponentWithoutName",""],s,["id","partTypeStandard",1,"button","dropdown","is-hoverable",3,"ngClass","click"],[1,"dropdown-trigger"],i,["role","menu",1,"dropdown-menu"],[1,"dropdown-content"],[1,"dropdown-item"],o,c,["id","partTypeBlitz",1,"button","dropdown","is-hoverable",3,"ngClass","click"],u,h,p,["id","partTypeCustom",1,"button",3,"ngClass","click"],m,["id","customTime",4,"ngIf"],[1,"label"],C,[1,"control"],["chooseOpponent",""],["id","proposeConfig",1,"button","is-primary",3,"disabled","click"],w,["class","button","id","reviewConfig",3,"click",4,"ngIf"],["id","cancel",1,"button",3,"click"],I,H,["id","customTime"],["for","maximalMoveDuration",1,"label"],K,["step","10","min","10","max","300","name","maximalMoveDuration","formControlName","maximalMoveDuration","type","range",1,"slider","is-circle","is-primary"],["for","totalPartDuration",1,"label"],ie,["step","10","min","10","max","3600","name","totalPartDuration","formControlName","totalPartDuration","type","range",1,"slider","is-circle","is-primary"],ye,te,["id","chooseOpponent",1,"table-container"],[1,"table","is-fullwidth","is-hoverable","is-striped"],["scope","col",1,"th"],ke,$e,[3,"id","ngClass","click",4,"ngFor","ngForOf"],[3,"id","ngClass","click"],[1,"td",3,"id"],[1,"td"],["class","button is-primary",4,"ngIf"],[1,"button","is-primary"],Xe,["id","reviewConfig",1,"button",3,"click"],Ft,[1,"message","is-primary"],[1,"message-header"],D1,[1,"message-body"],["class","content",4,"ngIf","ngIfElse"],["configProposal",""],[1,"content"],N1,is,Kc,$o,["id","acceptConfig",1,"button","is-primary",3,"click"],H2,Yn,E6,Mt,Wt,["proposalSent",""],Xt,o1]},template:function(t,e){1&t&&x(0,yft,4,3,"div",0),2&t&&T("ngIf",e.viewInfo)},dependencies:[dn,An,en,Mu,M4,Vy,xl,Eu,Su,ff,tft],encapsulation:2});let Mft=(()=>{class n{constructor(){this.timeoutHandleGlobal=null,this.timeoutHandleSec=null,this.isPaused=!0,this.isSet=!1,this.started=!1,this.outOfTimeAction=new mr,this.addTimeToOpponent=new mr,this.cssClasses=n.SAFE_TIME}ngOnInit(){X(n.VERBOSE,"CountDownComponent.ngOnInit ("+this.debugName+")")}setDuration(e){X(n.VERBOSE,this.debugName+".set("+e+"ms)"),Me.assert(!1===this.started,"Should not set a chrono that has already been started ("+this.debugName+")!"),this.isSet=!0,this.changeDuration(e)}changeDuration(e){let r=!1;!1===this.isPaused&&(this.pause(),r=!0),this.remainingMs=e,this.displayDuration(),r&&this.resume()}displayDuration(){this.displayedSec=this.remainingMs%6e4,this.displayedMinute=(this.remainingMs-this.displayedSec)/6e4,this.displayedSec=Math.floor(this.displayedSec/1e3)}start(){X(n.VERBOSE,this.debugName+".start("+this.remainingMs+"ms);"),Me.assert(this.isSet,"Should not start a chrono that has not been set!"),Me.assert(!1===this.started,"Should not start chrono that has already been started ("+this.debugName+")"),this.started=!0,this.resume()}resume(){X(n.VERBOSE,this.debugName+".resume("+this.remainingMs+"ms)"),Me.assert(this.isPaused&&this.started,"Should only resume chrono that are started and paused!"),this.startTime=Date.now();const e=this.remainingMs;this.isPaused=!1,this.timeoutHandleGlobal=window.setTimeout(()=>{this.onEndReached()},e),this.countSeconds()}onEndReached(){X(n.VERBOSE,this.debugName+".onEndReached"),this.isPaused=!0,this.started=!1,this.clearTimeouts(),this.changeDuration(0),this.outOfTimeAction.emit()}countSeconds(){this.timeoutHandleSec=window.setTimeout(()=>{this.updateShownTime()},1e3)}isIdle(){return!1===this.started||this.isPaused}pause(){X(n.VERBOSE,this.debugName+".pause("+this.remainingMs+"ms)"),Me.assert(this.started,"Should not pause not started chrono ("+this.debugName+")"),Me.assert(!1===this.isPaused,"Should not pause already paused chrono ("+this.debugName+")"),this.clearTimeouts(),this.isPaused=!0,this.updateShownTime()}stop(){X(n.VERBOSE,this.debugName+".stop("+this.remainingMs+"ms)"),Me.assert(this.started,"Should only stop chrono that are started!"),this.pause(),this.started=!1,this.isSet=!1}isStarted(){return this.started}getTimeClass(){return!1===this.active?n.PASSIVE_STYLE:this.remainingMs<this.dangerTimeLimit?this.remainingMs%2e3<1e3?n.DANGER_TIME_ODD:n.DANGER_TIME_EVEN:n.SAFE_TIME}updateShownTime(){const e=Date.now();this.remainingMs-=e-this.startTime,this.displayDuration(),this.cssClasses=this.getTimeClass(),this.startTime=e,!1===this.isPaused&&this.countSeconds()}clearTimeouts(){X(n.VERBOSE,this.debugName+".clearTimeouts"),null!=this.timeoutHandleSec&&(window.clearTimeout(this.timeoutHandleSec),this.timeoutHandleSec=null),null!=this.timeoutHandleGlobal&&(window.clearTimeout(this.timeoutHandleGlobal),this.timeoutHandleGlobal=null)}addTime(){this.addTimeToOpponent.emit()}ngOnDestroy(){this.clearTimeouts()}}return n.VERBOSE=!1,n.DANGER_TIME_EVEN="has-background-danger has-text-white",n.DANGER_TIME_ODD="has-background-warning has-text-white",n.PASSIVE_STYLE="has-text-passive is-italic",n.SAFE_TIME="",n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=gt({type:n,selectors:[["app-count-down"]],inputs:{debugName:"debugName",timeToAdd:"timeToAdd",dangerTimeLimit:"dangerTimeLimit",active:"active",canAddTime:"canAddTime"},outputs:{outOfTimeAction:"outOfTimeAction",addTimeToOpponent:"addTimeToOpponent"},decls:5,vars:7,consts:function(){let t;return t=$localize`Add ${"\ufffd0\ufffd"}:INTERPOLATION:`,[[3,"ngClass"],["id","remainingTime"],["id","addTimeButton","class","button is-small is-fullwidth",3,"click",4,"ngIf"],["id","addTimeButton",1,"button","is-small","is-fullwidth",3,"click"],t]},template:function(e,r){1&e&&(b(0,"div",0)(1,"p",1),Tt(2),Mc(3,"number"),O(),x(4,Eft,2,1,"button",2),O()),2&e&&(T("ngClass",r.getTimeClass()),S(2),KC("",r.displayedMinute,":",Y$(3,4,r.displayedSec,"2.0-0"),""),S(2),T("ngIf",r.canAddTime))},dependencies:[dn,en,EG],encapsulation:2}),n})();const Sft=["partCreation"],Pft=["chatComponent"],Tft=["chronoZeroGlobal"],wft=["chronoOneGlobal"],bft=["chronoZeroTurn"],Oft=["chronoOneTurn"];function Nft(n,t){if(1&n){const e=Oe();b(0,"app-part-creation",5,6),ee("gameStartNotification",function(s){return he(e),le(v().startGame(s))}),O()}2&n&&T("partId",v().currentPartId)}function Aft(n,t){1&n&&(un(0),b(1,"span",41),_e(2,42),O(),fn())}function Ift(n,t){if(1&n&&(b(0,"span",43),_e(1,44),O()),2&n){const e=v(4);S(1),k1(null==e.currentPlayer?null:e.currentPlayer.name),F1(1)}}function xft(n,t){if(1&n&&(b(0,"p",38),x(1,Aft,3,0,"ng-container",39),x(2,Ift,2,1,"ng-template",null,40,r1),O()),2&n){const e=Qn(3),r=v(3);S(1),T("ngIf",(null==r.currentPlayer?null:r.currentPlayer.name)===r.getPlayer().name)("ngIfElse",e)}}function kft(n,t){if(1&n&&(b(0,"div",34)(1,"p",35),_e(2,36),O(),x(3,xft,4,2,"p",37),O()),2&n){const e=v(2);S(2),k1(e.currentPart.getTurn()+1),F1(2),S(1),T("ngIf",!1===e.endGame)}}function Lft(n,t){if(1&n&&(b(0,"p",45),Tt(1),O()),2&n){const e=v(2);T("ngClass",e.getPlayerNameClass(e.Player.ZERO)),S(1),l1(e.players[0].get().name)}}function Rft(n,t){if(1&n&&(b(0,"p",46),_e(1,47),O()),2&n){const e=v(2);S(1),k1(e.gameComponent.scores.get()[0]),F1(1)}}function Dft(n,t){if(1&n&&(b(0,"p",48),Tt(1),O()),2&n){const e=v(2);T("ngClass",e.getPlayerNameClass(e.Player.ONE)),S(1),l1(e.players[1].get().name)}}function zft(n,t){if(1&n&&(b(0,"p",49),_e(1,50),O()),2&n){const e=v(2);S(1),k1(e.gameComponent.scores.get()[1]),F1(1)}}function Vft(n,t){if(1&n){const e=Oe();b(0,"button",59),ee("click",function(){return he(e),le(v(3).resign())}),_e(1,60),O()}}function Hft(n,t){if(1&n){const e=Oe();b(0,"button",61),ee("click",function(){return he(e),le(v(3).proposeDraw())}),_e(1,62),O()}}function Fft(n,t){if(1&n){const e=Oe();b(0,"button",63),ee("click",function(){return he(e),le(v(3).acceptDraw())}),_e(1,64),O()}}function Bft(n,t){if(1&n){const e=Oe();b(0,"button",65),ee("click",function(){return he(e),le(v(3).refuseDraw())}),_e(1,66),O()}}function $ft(n,t){if(1&n){const e=Oe();b(0,"button",67),ee("click",function(){return he(e),le(v(3).gameComponent.pass())}),_e(1,68),O()}}function Uft(n,t){if(1&n){const e=Oe();b(0,"button",69),ee("click",function(){return he(e),le(v(3).acceptTakeBack())}),_e(1,70),O()}}function Gft(n,t){if(1&n){const e=Oe();b(0,"button",71),ee("click",function(){return he(e),le(v(3).refuseTakeBack())}),_e(1,72),O()}}function Wft(n,t){if(1&n){const e=Oe();b(0,"button",73),ee("click",function(){return he(e),le(v(3).askTakeBack())}),_e(1,74),O()}}function qft(n,t){if(1&n&&(un(0),x(1,Vft,2,0,"button",51),x(2,Hft,2,0,"button",52),x(3,Fft,2,0,"button",53),x(4,Bft,2,0,"button",54),x(5,$ft,2,0,"button",55),x(6,Uft,2,0,"button",56),x(7,Gft,2,0,"button",57),x(8,Wft,2,0,"button",58),fn()),2&n){const e=v(2);S(1),T("ngIf",e.canResign()),S(1),T("ngIf",e.canProposeDraw()),S(1),T("ngIf",!1===e.endGame&&e.isOpponentWaitingForDrawResponse()),S(1),T("ngIf",!1===e.endGame&&e.isOpponentWaitingForDrawResponse()),S(1),T("ngIf",!1===e.endGame&&e.isPlaying()&&e.gameComponent.canPass&&(null==e.currentPlayer?null:e.currentPlayer.name)===e.getPlayer().name),S(1),T("ngIf",!1===e.endGame&&e.isOpponentWaitingForTakeBackResponse()),S(1),T("ngIf",!1===e.endGame&&e.isOpponentWaitingForTakeBackResponse()),S(1),T("ngIf",!1===e.endGame&&!1===e.isOpponentWaitingForTakeBackResponse()&&e.canAskTakeBack())}}function jft(n,t){1&n&&(b(0,"div")(1,"p",76),_e(2,77),O()())}function Zft(n,t){1&n&&(b(0,"p",81),_e(1,82),O())}function Yft(n,t){1&n&&(b(0,"p",83),_e(1,84),O())}function Kft(n,t){1&n&&(b(0,"p",85),_e(1,86),O())}function Xft(n,t){if(1&n&&(b(0,"div"),x(1,Zft,2,0,"p",78),x(2,Yft,2,0,"p",79),x(3,Kft,2,0,"p",80),O()),2&n){const e=v(3);S(1),T("ngIf",e.currentPart.getDrawAccepter().name===e.getPlayer().name),S(1),T("ngIf",e.currentPart.getDrawAccepter().name!==e.getPlayer().name&&e.isPlaying()),S(1),T("ngIf",!1===e.isPlaying())}}function Qft(n,t){1&n&&(b(0,"p",90),_e(1,91),O())}function Jft(n,t){1&n&&(b(0,"p",92),_e(1,93),O())}function e9t(n,t){if(1&n&&(b(0,"p",94),_e(1,95),O()),2&n){const e=v(4);S(1),k1(e.currentPart.getWinner().get().name),F1(1)}}function t9t(n,t){if(1&n&&(b(0,"div"),x(1,Qft,2,0,"p",87),x(2,Jft,2,0,"p",88),x(3,e9t,2,1,"p",89),O()),2&n){const e=v(3);S(1),T("ngIf",e.currentPart.getWinner().get().name===e.getPlayer().name),S(1),T("ngIf",e.currentPart.getWinner().get().name!==e.getPlayer().name&&e.isPlaying()),S(1),T("ngIf",!1===e.isPlaying())}}function n9t(n,t){if(1&n&&(b(0,"p",90),_e(1,96),O()),2&n){const e=v(4);S(1),k1(e.currentPart.getLoser().get().name),F1(1)}}function r9t(n,t){1&n&&(b(0,"p",94),_e(1,97),O())}function s9t(n,t){if(1&n&&(b(0,"p",94),_e(1,98),O()),2&n){const e=v(4);S(1),k1(e.currentPart.getLoser().get().name),F1(1)}}function i9t(n,t){if(1&n&&(b(0,"div"),x(1,n9t,2,1,"p",87),x(2,r9t,2,0,"p",89),x(3,s9t,2,1,"p",89),O()),2&n){const e=v(3);S(1),T("ngIf",e.currentPart.getWinner().get().name===e.getPlayer().name),S(1),T("ngIf",e.currentPart.getWinner().get().name!==e.getPlayer().name&&e.isPlaying()),S(1),T("ngIf",!1===e.isPlaying())}}function o9t(n,t){1&n&&(b(0,"p",100),_e(1,101),O())}function a9t(n,t){if(1&n&&(b(0,"p",100),_e(1,102),O()),2&n){const e=v(4);S(1),k1(e.currentPart.getLoser().get().name),F1(1)}}function c9t(n,t){if(1&n&&(b(0,"div"),x(1,o9t,2,0,"p",99),x(2,a9t,2,1,"p",99),O()),2&n){const e=v(3);S(1),T("ngIf",e.currentPart.getWinner().get().name!==e.getPlayer().name&&e.isPlaying()),S(1),T("ngIf",!1===e.isPlaying()||e.currentPart.getWinner().get().name===e.getPlayer().name)}}function l9t(n,t){if(1&n&&(b(0,"div",75),Q(1,"hr"),x(2,jft,3,0,"div",26),x(3,Xft,4,3,"div",26),x(4,t9t,4,3,"div",26),x(5,i9t,4,3,"div",26),x(6,c9t,3,2,"div",26),O()),2&n){const e=v(2);S(2),T("ngIf",e.currentPart.isHardDraw()),S(1),T("ngIf",e.currentPart.isAgreedDraw()),S(1),T("ngIf",e.currentPart.isWin()),S(1),T("ngIf",e.currentPart.isTimeout()),S(1),T("ngIf",e.currentPart.isResign())}}function u9t(n,t){1&n&&(b(0,"button",103),_e(1,104),O())}function f9t(n,t){if(1&n){const e=Oe();b(0,"button",105),ee("click",function(){return he(e),le(v(2).proposeRematch())}),_e(1,106),O()}}function h9t(n,t){if(1&n){const e=Oe();b(0,"button",107),ee("click",function(){return he(e),le(v(2).acceptRematch())}),_e(1,108),O()}}function d9t(n,t){if(1&n){const e=Oe();b(0,"div",7)(1,"div",8)(2,"div",9),x(3,kft,4,2,"div",10),b(4,"div",11),x(5,Lft,2,2,"p",12),x(6,Rft,2,1,"p",13),b(7,"app-count-down",14,15),ee("outOfTimeAction",function(){he(e);const s=v();return le(s.reachedOutOfTime(s.Player.ZERO))})("addTimeToOpponent",function(){return he(e),le(v().addGlobalTime())}),O(),b(9,"app-count-down",16,17),ee("outOfTimeAction",function(){he(e);const s=v();return le(s.reachedOutOfTime(s.Player.ZERO))})("addTimeToOpponent",function(){return he(e),le(v().addTurnTime())}),O()(),b(11,"p",18),_e(12,19),O(),b(13,"div",11),x(14,Dft,2,2,"p",20),x(15,zft,2,1,"p",21),b(16,"app-count-down",22,23),ee("outOfTimeAction",function(){he(e);const s=v();return le(s.reachedOutOfTime(s.Player.ONE))})("addTimeToOpponent",function(){return he(e),le(v().addGlobalTime())}),O(),b(18,"app-count-down",24,25),ee("outOfTimeAction",function(){he(e);const s=v();return le(s.reachedOutOfTime(s.Player.ONE))})("addTimeToOpponent",function(){return he(e),le(v().addTurnTime())}),O()(),Q(20,"hr"),x(21,qft,9,8,"ng-container",26),x(22,l9t,7,5,"div",27),x(23,u9t,2,0,"button",28),x(24,f9t,2,0,"button",29),x(25,h9t,2,0,"button",30),O()(),b(26,"div",31)(27,"div",32),Q(28,"div",null,33),O()()()}if(2&n){const e=v();S(3),T("ngIf",null!==e.currentPart),S(2),T("ngIf",e.players[0].isPresent()),S(1),T("ngIf",null!==e.currentPart&&e.gameComponent&&e.gameComponent.scores.isPresent()),S(1),T("dangerTimeLimit",6e4)("active",null!==e.currentPart&&e.currentPart.getTurn()%2==0)("canAddTime",e.role===e.Player.ONE&&!1===e.endGame)("timeToAdd",e.globalTimeMessage),S(2),T("dangerTimeLimit",15e3)("active",null!==e.currentPart&&e.currentPart.getTurn()%2==0)("canAddTime",e.role===e.Player.ONE&&!1===e.endGame)("timeToAdd",e.turnTimeMessage),S(5),T("ngIf",e.players[1].isPresent()),S(1),T("ngIf",null!==e.currentPart&&e.gameComponent&&e.gameComponent.scores.isPresent()),S(1),T("dangerTimeLimit",6e4)("active",null!==e.currentPart&&e.currentPart.getTurn()%2==1)("canAddTime",e.role===e.Player.ZERO&&!1===e.endGame)("timeToAdd",e.globalTimeMessage),S(2),T("dangerTimeLimit",15e3)("active",null!==e.currentPart&&e.currentPart.getTurn()%2==1)("canAddTime",e.role===e.Player.ZERO&&!1===e.endGame)("timeToAdd",e.turnTimeMessage),S(3),T("ngIf",e.isPlaying()),S(1),T("ngIf",e.endGame&&null!==e.currentPart),S(1),T("ngIf",e.endGame),S(1),T("ngIf",e.endGame&&e.isPlaying()&&!1===e.rematchProposed),S(1),T("ngIf",e.endGame&&e.isPlaying()&&e.rematchProposed&&e.opponentProposedRematch),S(1),T("ngClass",e.getBoardHighlight())}}let p9t=(()=>{class n{}return n.NO_MATCHING_PART=()=>$localize`The game you tried to join does not exist.`,n})();class Gn{constructor(t){this.value=t}}Gn.PRE_START_DOC=new Gn("PRE_START_DOC"),Gn.STARTING_DOC=new Gn("STARTING_DOC"),Gn.DUPLICATE=new Gn("DUPLICATE"),Gn.MOVE_WITHOUT_TIME=new Gn("MOVE_WITHOUT_TIME"),Gn.MOVE=new Gn("MOVE"),Gn.REQUEST=new Gn("REQUEST"),Gn.END_GAME=new Gn("END_GAME"),Gn.END_GAME_WITHOUT_TIME=new Gn("END_GAME_WITHOUT_TIME"),Gn.ACCEPT_TAKE_BACK_WITHOUT_TIME=new Gn("ACCEPT_TAKE_BACK_WITHOUT_TIME");let g9t=(()=>{class n extends JP{constructor(e,r,s,i,o,c,u,h){super(e,r,s,i,o),this.observedPartService=c,this.userService=u,this.gameService=h,this.currentPart=null,this.gameStarted=!1,this.opponent=null,this.currentPlayer=null,this.rematchProposed=!1,this.opponentProposedRematch=!1,this.userLinkedToThisPart=!0,this.observedPart=P.empty(),this.hasUserPlayed=[!1,!1],this.msToSubstract=[0,0],this.opponentSubscription=new Z1,this.partSubscription=new Z1,this.observedPartSubscription=new Z1,this.OFFLINE_FONT_COLOR={color:"lightgrey"},this.globalTimeMessage=$localize`5 minutes`,this.turnTimeMessage=$localize`30 seconds`,this.onCurrentUpdateOngoing=!1,X(n.VERBOSE,"OnlineGameWrapperComponent constructed")}extractPartIdFromURL(){return Me.getNonNullable(this.actRoute.snapshot.paramMap.get("id"))}extractGameNameFromURL(){return Me.getNonNullable(this.actRoute.snapshot.paramMap.get("compo"))}isPlaying(){return this.role.isPlayer()}getPlayer(){return this.authUser.toMinimalUser()}isPlayer(e){return this.role===e}redirectIfPartOrGameIsInvalid(){var e=this;return A(function*(){const r=e.extractGameNameFromURL();if(H9.ALL_GAMES().some(i=>i.urlName===r)){if((yield e.gameService.getPartValidity(e.currentPartId,r)).isFailure()){e.routerEventsSubscription.unsubscribe();const o=p9t.NO_MATCHING_PART();yield e.router.navigate(["/notFound",o],{skipLocationChange:!0})}}else{e.routerEventsSubscription.unsubscribe();const i=F9.NO_MATCHING_GAME(r);yield e.router.navigate(["/notFound",i],{skipLocationChange:!0})}})()}setCurrentPartIdOrRedirect(){return this.currentPartId=this.extractPartIdFromURL(),this.redirectIfPartOrGameIsInvalid()}ngOnInit(){var e=this;return A(function*(){X(n.VERBOSE,"OnlineGameWrapperComponent.ngOnInit"),e.routerEventsSubscription=e.router.events.subscribe(function(){var r=A(function*(s){s instanceof w0&&(yield e.setCurrentPartIdOrRedirect())});return function(s){return r.apply(this,arguments)}}()),e.userSubscription=e.connectedUserService.subscribeToUser(r=>{e.authUser=r}),yield e.setCurrentPartIdOrRedirect(),e.observedPartSubscription=e.observedPartService.subscribeToObservedPart(function(){var r=A(function*(s){yield e.onObservedPartUpdate(s)});return function(s){return r.apply(this,arguments)}}()),X(n.VERBOSE,"OnlineGameWrapperComponent.ngOnInit done")})()}onObservedPartUpdate(e){var r=this;return A(function*(){if(X(n.VERBOSE,"OnlineGameWrapperComponent.onObservedPartUpdate called"),e.isPresent()){const s=e.get();"Observer"===s.role||s.id===r.currentPartId?r.observedPart=e:(r.userLinkedToThisPart=!1,yield r.router.navigate(["/lobby"]))}else r.observedPart=P.empty()})()}getObservedPart(){return this.observedPart}startGame(e){var r=this;return A(function*(){X(n.VERBOSE,"OnlineGameWrapperComponent.startGame"),ve(!1===r.gameStarted,"Should not start already started game"),r.configRoom=e,r.gameStarted=!0,window.setTimeout(A(function*(){ve(yield r.afterViewInit(),"Game should be created successfully, otherwise part-creation would have redirected"),r.startPart()}),2)})()}startPart(){var e=this;X(n.VERBOSE,"OnlineGameWrapperComponent.startPart"),this.partSubscription=this.gameService.subscribeToChanges(this.currentPartId,function(){var r=A(function*(s){ve(s.isPresent(),"OnlineGameWrapper observed a part being deleted, this should not happen"),yield e.onCurrentPartUpdate(s.get())});return function(s){return r.apply(this,arguments)}}())}onCurrentPartUpdate(e,r=5){var s=this;return A(function*(){const i=new wS(s.currentPartId,e);if(X(n.VERBOSE,{OnlineGameWrapperComponent_onCurrentPartUpdate:{before:s.currentPart,then:e,before_part_turn:i.data.turn,before_state_turn:s.gameComponent.rules.node.gameState.turn,nbPlayedMoves:i.data.listMoves.length}}),s.onCurrentUpdateOngoing)return ve((r-=1)>0,"Update took more than 5sec to be handled by the component!"),void window.setTimeout(A(function*(){yield s.onCurrentPartUpdate(e,r)}),1e3);s.onCurrentUpdateOngoing=!0;const o=s.getUpdateTypes(i),c=e.turn;o.includes(Gn.REQUEST)?X(n.VERBOSE,"UpdateType: Request("+Me.getNonNullable(i.data.request).code+") ("+c+")"):X(n.VERBOSE,"UpdateType: "+o.map(h=>h.value)+"("+c+")");const u=s.currentPart;s.currentPart=i;for(const h of o)yield s.applyUpdate(h,i,u);s.onCurrentUpdateOngoing=!1})()}applyUpdate(e,r,s){var i=this;return A(function*(){switch(e){case Gn.REQUEST:return yield i.onRequest(Me.getNonNullable(r.data.request),s);case Gn.ACCEPT_TAKE_BACK_WITHOUT_TIME:return void(i.currentPart=s);case Gn.DUPLICATE:return;case Gn.END_GAME_WITHOUT_TIME:return void(i.currentPart=s);case Gn.END_GAME:return i.applyEndGame();case Gn.MOVE_WITHOUT_TIME:const o=Me.getNonNullable(i.currentPart),c=Me.getNonNullable(s);return void(o.data={...o.data,turn:o.data.turn-1,lastUpdate:c.data.lastUpdate,lastUpdateTime:c.data.lastUpdateTime,listMoves:o.data.listMoves.slice(0,o.data.listMoves.length-1)});case Gn.MOVE:return i.msToSubstract=i.getLastUpdateTime(s,r),i.doNewMoves(r);case Gn.PRE_START_DOC:return;default:return ve(e===Gn.STARTING_DOC,"Unexpected update type "+e),i.startCountDown(r)}})()}startCountDown(e){var r=this;return A(function*(){r.setChronos(),yield r.setPlayersDatas(e),r.startCountDownFor(0===e.data.listMoves.length?z.ZERO:z.fromTurn(e.data.turn-1))})()}getUpdateTypes(e){const r=null!=this.currentPart?this.currentPart.data:null,s=B9.from(r,e.data),i=[];if(X(n.VERBOSE,{currentPartDoc:r,update:e,diff:s}),0===s.countChanges()&&i.push(Gn.DUPLICATE),s.isFullyCreated()&&s.isPresent("beginning").present&&i.push(Gn.STARTING_DOC),e.data.request){const c=null!=s.removed.lastUpdateTime;i.push("TakeBackAccepted"===e.data.request.code&&c?Gn.ACCEPT_TAKE_BACK_WITHOUT_TIME:Gn.REQUEST)}if(null==r?"added"===s.isPresent("listMoves").state&&e.data.turn>0&&i.push(this.getMoveUpdateType(e,s)):this.turnHasIncreased(r.turn,e.data.turn,e.data.listMoves)&&i.push(this.getMoveUpdateType(e,s)),null==e.data.beginning&&i.push(Gn.PRE_START_DOC),s.isPresent("result").present&&e.data.result!==Dn.UNACHIEVED.value){const c=null!=s.modified.turn,u=!1===s.addedOrModified("lastUpdateTime");i.push(c&&u?Gn.END_GAME_WITHOUT_TIME:Gn.END_GAME)}return i}getMoveUpdateType(e,r){return 1===e.data.turn?null==e.data.lastUpdateTime?Gn.MOVE_WITHOUT_TIME:Gn.MOVE:null==r.modified.lastUpdateTime&&null==r.added.lastUpdateTime?Gn.MOVE_WITHOUT_TIME:Gn.MOVE}turnHasIncreased(e,r,s){return ve(s.length===r,"ListMoves size and newTurn do not match, it is impossible!"),e<r}getLastUpdateTime(e,r){if(null==e)return[0,0];const s=this.getMoreRecentTime(e),i=this.getMoreRecentTime(r);ve(null!=s,"oldTime should not be null"),ve(null!=i,"updateTime should not be null");const o=z.fromTurn(e.data.turn);return this.getTimeUsedForLastTurn(Me.getNonNullable(s),Me.getNonNullable(i),o)}getMoreRecentTime(e){return e.data.lastUpdateTime??e.data.beginning}getTimeUsedForLastTurn(e,r,s){const i=o4e(e,r),o=[0,0];return o[s.value]=i,o}setChronos(){X(n.VERBOSE,"onlineGameWrapperComponent.setChronos()"),this.chronoZeroGlobal.setDuration(1e3*this.configRoom.totalPartDuration),this.chronoOneGlobal.setDuration(1e3*this.configRoom.totalPartDuration),this.chronoZeroTurn.setDuration(1e3*this.configRoom.maximalMoveDuration),this.chronoOneTurn.setDuration(1e3*this.configRoom.maximalMoveDuration)}didUserPlay(e){return this.hasUserPlayed[e.value]}doNewMoves(e){X(n.VERBOSE,"OnlineGameWrapperComponent.doNewMoves"+JSON.stringify(e)),this.switchPlayer();const r=Ke.copyImmutableArray(e.data.listMoves),s=this.gameComponent.rules;for(;this.gameComponent.getTurn()<r.length;){const i=this.gameComponent.getTurn(),o=this.gameComponent.encoder.decode(r[i]),c=s.isLegal(o,this.gameComponent.getState()),u=JSON.stringify(r),h="We received an incorrect db move: "+o.toString()+" in "+u+" at turn "+i+'because "'+c.getReasonOr("")+'"';ve(c.isSuccess(),h,r),s.choose(o)}this.currentPlayer=this.players[this.gameComponent.getTurn()%2].get(),this.gameComponent.updateBoard()}switchPlayer(){X(n.VERBOSE,"OnlineGameWrapperComponent.switchPlayer");const e=Me.getNonNullable(this.currentPart),r=z.fromTurn(e.data.turn);this.currentPlayer=this.players[this.gameComponent.getTurn()%2].get();const s=r.getOpponent();this.pauseCountDownsFor(s),this.didUserPlay(r)?(X(n.VERBOSE,"OnlineGameWrapperComponent.onCurrentPartUpdate: changing current player"),this.resumeCountDownFor(r)):this.startCountDownFor(r)}resetChronoFor(e){this.pauseCountDownsFor(e),this.resumeCountDownFor(e)}applyEndGame(){var e=this;return A(function*(){yield e.observedPartService.removeObservedPart();const r=Me.getNonNullable(e.currentPart),s=z.fromTurn(r.data.turn);if(e.endGame=!0,!1===[Dn.VICTORY,Dn.HARD_DRAW].some(c=>c.value===r.data.result)){ve(!0===[Dn.RESIGN,Dn.TIMEOUT,Dn.HARD_DRAW,Dn.AGREED_DRAW_BY_ZERO,Dn.AGREED_DRAW_BY_ONE].some(p=>p.value===r.data.result),"Unknown type of end game ("+r.data.result+")");const h="endGame is true and winner is "+r.getWinner().getOrElse({id:"fake",name:"no one"}).name;X(n.VERBOSE,h)}e.stopCountdownsFor(s)})()}notifyDraw(e,r){return this.endGame=!0,this.gameService.updateDBBoard(this.currentPartId,this.role,e,[0,0],r,!0)}notifyTimeoutVictory(e,r,s,i){var o=this;return A(function*(){o.endGame=!0;const c=Me.getNonNullable(o.currentPart).setWinnerAndLoser(e,i);o.currentPart=c,yield o.gameService.notifyTimeout(o.currentPartId,r,s,e,i)})()}notifyVictory(e,r){X(n.VERBOSE,"OnlineGameWrapperComponent.notifyVictory");const s=this.gameComponent.rules.getGameStatus(this.gameComponent.rules.node),i=Me.getNonNullable(this.currentPart),o=this.players[0].get(),c=this.players[1].get();return s===xe.ONE_WON?this.currentPart=i.setWinnerAndLoser(c,o):(ve(s===xe.ZERO_WON,"impossible to get a victory without winner!"),this.currentPart=i.setWinnerAndLoser(o,c)),this.endGame=!0,this.gameService.updateDBBoard(this.currentPartId,this.role,e,[0,0],r,!1,this.currentPart.getWinner().get(),this.currentPart.getLoser().get())}canAskTakeBack(){ve(this.isPlaying(),"Non playing should not call canAskTakeBack"),ve(null!=this.currentPart,"should not call canAskTakeBack when currentPart is not defined yet");const e=Me.getNonNullable(this.currentPart);return!(e.data.turn<=this.role.value||e.data.request&&"TakeBackRefused"===e.data.request.code&&this.role.isPlayer()&&e.data.request.data.player===this.role.getOpponent().value)&&this.getTakeBackRequester()===pe.NONE}isOpponentWaitingForTakeBackResponse(){const e=this.getTakeBackRequester();return!!e.isPlayer()&&e!==this.role}getTakeBackRequester(){const r=Me.getNonNullable(this.currentPart).data.request;return r&&"TakeBackAsked"===r.code?Br.getPlayer(r):pe.NONE}canProposeDraw(){ve(this.isPlaying(),"Non playing should not call canProposeDraw");const e=Me.getNonNullable(this.currentPart);return!(this.endGame||e.data.request&&"DrawRefused"===e.data.request.code&&this.role.isPlayer()&&Br.getPlayer(e.data.request)===this.role.getOpponent()||this.isOpponentWaitingForDrawResponse())&&this.getDrawRequester()===pe.NONE}isOpponentWaitingForDrawResponse(){const e=this.getDrawRequester();return e!==pe.NONE&&e!==this.role}getDrawRequester(){const r=Me.getNonNullable(this.currentPart).data.request;return r&&"DrawProposed"===r.code?Br.getPlayer(r):pe.NONE}onRequest(e,r){var s=this;return A(function*(){switch(X(n.VERBOSE,{called:"OnlineGameWrapper.onRequest(",request:e,oldPart:r}),e.code){case"TakeBackAsked":case"TakeBackRefused":case"DrawProposed":case"DrawRefused":break;case"TakeBackAccepted":s.takeBackTo(Me.getNonNullable(s.currentPart).data.turn);break;case"RematchProposed":s.rematchProposed=!0;const i=Br.getPlayer(e).getOpponent();s.isPlayer(i)&&(X(n.VERBOSE,"ton adversaire te propose une revanche"),s.opponentProposedRematch=!0);break;case"RematchAccepted":yield s.router.navigate(["/nextGameLoading"]),yield s.router.navigate(["/play",Br.getTypeGame(e),Br.getPartId(e)]);break;case"AddTurnTime":const o=3e4,c=z.of(e.data.player);s.addTurnTimeTo(c,o);break;default:Me.expectToBe(e.code,"AddGlobalTime","Unknown RequestType : "+e.code+" for "+JSON.stringify(e));const u=3e5,h=z.of(e.data.player);s.addGlobalTimeTo(h,u)}})()}takeBackTo(e){if(X(n.VERBOSE,"OnlineGameWrapperComponent.takeBackTo"),this.gameComponent.rules.node=this.gameComponent.rules.node.mother.get(),this.gameComponent.getTurn()===e)this.switchPlayer();else{this.gameComponent.rules.node=this.gameComponent.rules.node.mother.get();const r=z.fromTurn(e);this.resetChronoFor(r)}this.gameComponent.updateBoard()}setPlayersDatas(e){var r=this;return A(function*(){X(n.VERBOSE,{OnlineGameWrapper_setPlayersDatas:e}),r.players=[P.of(e.data.playerZero),P.ofNullable(e.data.playerOne)],ve(null!=e.data.playerOne,"should not setPlayersDatas when players data is not received"),r.currentPlayer=r.players[e.data.turn%2].get();const s=yield r.setRealObserverRole();if(s.isPresent()){const i=o=>{ve(o.isPresent(),"opponent was deleted, what sorcery is this"),r.opponent=s.get()};r.opponentSubscription=r.userService.observeUser(s.get().id,i)}})()}setRealObserverRole(){var e=this;return A(function*(){let r=P.empty();return e.players[0].equalsValue(e.getPlayer())?(e.setRole(z.ZERO),r=e.players[1]):e.players[1].equalsValue(e.getPlayer())?(e.setRole(z.ONE),r=e.players[0]):e.setRole(pe.NONE),yield e.observedPartService.updateObservedPart({...e.observedPart.get(),role:e.role===pe.NONE?"Observer":"Player"}),r})()}onLegalUserMove(e,r){var s=this;return A(function*(){if(X(n.VERBOSE,"dans OnlineGameWrapperComponent.onLegalUserMove"),!s.isOpponentWaitingForTakeBackResponse())return s.updateDBBoard(e,s.msToSubstract,r);s.gameComponent.message("You must answer to take back request")})()}updateDBBoard(e,r,s){var i=this;return A(function*(){const o=i.gameComponent.encoder.encodeMove(e);X(n.VERBOSE,"OnlineGameWrapperComponent.updateDBBoard("+e.toString()+", "+s+")"),i.gameComponent.rules.choose(e);const c=i.gameComponent.rules.getGameStatus(i.gameComponent.rules.node);return c.isEndGame?c===xe.DRAW?i.notifyDraw(o,s):i.notifyVictory(o,s):i.gameService.updateDBBoard(i.currentPartId,i.role,o,r,s)})()}resign(){var e=this;return A(function*(){X(n.VERBOSE,"OnlineGameWrapperComponent.resign");const r=e.getLastIndex(),s=e.role,i=e.getPlayer(),o=e.players[(e.role.value+1)%2].get();yield e.gameService.resign(e.currentPartId,r,s,o,i)})()}getLastIndex(){return Me.getNonNullable(this.currentPart).data.lastUpdate.index}reachedOutOfTime(e){var r=this;return A(function*(){X(n.VERBOSE,"OnlineGameWrapperComponent.reachedOutOfTime("+e+")");const s=r.getLastIndex(),i=r.role;if(r.stopCountdownsFor(e),!1===r.isPlaying())return;const o=Me.getNonNullable(r.opponent);e===r.role?yield r.notifyTimeoutVictory(o,i,s,r.authUser.toMinimalUser()):(ve(!1===r.endGame,"time might be better handled in the future"),r.opponentIsOffline()&&(yield r.notifyTimeoutVictory(r.authUser.toMinimalUser(),i,e.value,o),r.endGame=!0))})()}acceptRematch(){var e=this;return A(function*(){ve(e.isPlaying(),"Non playing should not call acceptRematch");const r=new wS(e.currentPartId,Me.getNonNullable(e.currentPart).data);return yield e.gameService.acceptRematch(r,e.getLastIndex(),e.role),!0})()}proposeRematch(){var e=this;return A(function*(){return ve(e.isPlaying(),"Non playing should not call proposeRematch"),yield e.gameService.proposeRematch(e.currentPartId,e.getLastIndex(),e.role),!0})()}proposeDraw(){return ve(this.isPlaying(),"Non playing should not call proposeDraw"),this.gameService.proposeDraw(this.currentPartId,this.getLastIndex(),this.role)}acceptDraw(){return ve(this.isPlaying(),"Non playing should not call acceptDraw"),this.gameService.acceptDraw(this.currentPartId,this.getLastIndex(),this.role)}refuseDraw(){return ve(this.isPlaying(),"Non playing should not call refuseDraw"),this.gameService.refuseDraw(this.currentPartId,this.getLastIndex(),this.role)}askTakeBack(){return ve(this.isPlaying(),"Non playing should not call askTakeBack"),this.gameService.askTakeBack(this.currentPartId,this.getLastIndex(),this.role)}acceptTakeBack(){var e=this;return A(function*(){ve(e.isPlaying(),"Non playing should not call acceptTakeBack");const r=e.role;yield e.gameService.acceptTakeBack(e.currentPartId,Me.getNonNullable(e.currentPart),r,e.msToSubstract),e.msToSubstract=[0,0]})()}refuseTakeBack(){return ve(this.isPlaying(),"Non playing should not call refuseTakeBack"),this.gameService.refuseTakeBack(this.currentPartId,this.getLastIndex(),this.role)}startCountDownFor(e){X(n.VERBOSE,"dans OnlineGameWrapperComponent.startCountDownFor("+e.toString()+") (turn "+Me.getNonNullable(this.currentPart).data.turn+")"),this.hasUserPlayed[e.value]=!0,e===z.ZERO?(this.chronoZeroGlobal.start(),this.chronoZeroTurn.start()):(this.chronoOneGlobal.start(),this.chronoOneTurn.start())}resumeCountDownFor(e,r=!0){let s;X(n.VERBOSE,"dans OnlineGameWrapperComponent.resumeCountDownFor("+e.toString()+") (turn "+Me.getNonNullable(this.currentPart).data.turn+")"),e===z.ZERO?(this.chronoZeroGlobal.changeDuration(Me.getNonNullable(this.currentPart?.data.remainingMsForZero)),this.chronoZeroGlobal.resume(),s=this.chronoZeroTurn):(this.chronoOneGlobal.changeDuration(Me.getNonNullable(this.currentPart?.data.remainingMsForOne)),this.chronoOneGlobal.resume(),s=this.chronoOneTurn),r?(s.setDuration(1e3*this.configRoom.maximalMoveDuration),s.start()):s.resume()}pauseCountDownsFor(e,r=!0){let s;X(n.VERBOSE,"dans OnlineGameWrapperComponent.pauseCountDownFor("+e.value+") (turn "+this.currentPart?.data.turn+")"),e===z.ZERO?(this.chronoZeroGlobal.pause(),s=this.chronoZeroTurn):(this.chronoOneGlobal.pause(),s=this.chronoOneTurn),r?s.stop():s.pause()}stopCountdownsFor(e){X(n.VERBOSE,"cdc::stopCountDownsFor("+e.toString()+") (turn "+this.currentPart?.data.turn+")"),e===z.ZERO?(this.chronoZeroGlobal.isStarted()&&this.chronoZeroGlobal.stop(),this.chronoZeroTurn.isStarted()&&this.chronoZeroTurn.stop()):(this.chronoOneGlobal.isStarted()&&this.chronoOneGlobal.stop(),this.chronoOneTurn.isStarted()&&this.chronoOneTurn.stop())}getPlayerNameClass(e){return this.opponentIsOffline()?"has-text-grey-light":e===z.ZERO?"has-text-white":"has-text-black"}opponentIsOffline(){return!1}canResign(){return ve(this.isPlaying(),"Non playing should not call canResign"),!0!==this.endGame&&null!=this.opponent}addGlobalTime(){const e=this.role,r=this.getLastIndex();return this.gameService.addGlobalTime(this.currentPartId,r,Me.getNonNullable(this.currentPart).data,e)}addTurnTime(){return this.gameService.addTurnTime(this.role,this.getLastIndex(),this.currentPartId)}addTurnTimeTo(e,r){const s=z.fromTurn(Me.getNonNullable(this.currentPart).getTurn());this.pauseCountDownsFor(s,!1),e===z.ZERO?this.chronoZeroTurn.changeDuration(this.chronoZeroTurn.remainingMs+r):this.chronoOneTurn.changeDuration(this.chronoOneTurn.remainingMs+r),this.resumeCountDownFor(s,!1)}addGlobalTimeTo(e,r){e===z.ZERO?this.chronoZeroGlobal.changeDuration(this.chronoZeroGlobal.remainingMs+r):this.chronoOneGlobal.changeDuration(this.chronoOneGlobal.remainingMs+r)}onCancelMove(e){this.gameComponent.showLastMove()}ngOnDestroy(){var e=this;return A(function*(){X(n.VERBOSE,"OnlineGameWrapperComponent.ngOnDestroy"),e.routerEventsSubscription.unsubscribe(),e.userSubscription.unsubscribe(),e.observedPartSubscription.unsubscribe(),!1===e.isPlaying()&&e.userLinkedToThisPart&&(yield e.observedPartService.removeObservedPart()),!0===e.gameStarted&&(e.opponentSubscription.unsubscribe(),e.partSubscription.unsubscribe()),X(n.VERBOSE,"OnlineGameWrapperComponent.ngOnDestroy finished")})()}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(J(Ia),J(bo),J(Ns),J(Zn),J(Pn),J(O2),J(gm),J(OS))},n.\u0275cmp=gt({type:n,selectors:[["app-online-game-wrapper"]],viewQuery:function(e,r){if(1&e&&(v4(Sft,5),v4(Pft,5),v4(Tft,5),v4(wft,5),v4(bft,5),v4(Oft,5)),2&e){let s;Sc(s=Pc())&&(r.partCreation=s.first),Sc(s=Pc())&&(r.chatComponent=s.first),Sc(s=Pc())&&(r.chronoZeroGlobal=s.first),Sc(s=Pc())&&(r.chronoOneGlobal=s.first),Sc(s=Pc())&&(r.chronoZeroTurn=s.first),Sc(s=Pc())&&(r.chronoOneTurn=s.first)}},features:[l],decls:5,vars:4,consts:function(){let t,e,r,s,i,o,c,u,h,p,m,C,w,I,H,K,ie,ye,te,ke,$e,Xe,Ft,D1,N1,is,Kc,$o,H2;return t=$localize`vs.`,e=$localize`Turn n${"\ufffd0\ufffd"}:INTERPOLATION:`,r=$localize`It is your turn.`,s=$localize`It is ${"\ufffd0\ufffd"}:INTERPOLATION:'s turn.`,i=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: points`,o=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: points`,c=$localize`Resign`,u=$localize`Propose a draw`,h=$localize`Accept draw`,p=$localize`Reject draw`,m=$localize`Pass a turn`,C=$localize`Accept take back`,w=$localize`Reject take back`,I=$localize`Ask to take back one move`,H=$localize`Draw`,K=$localize`You agreed to draw.`,ie=$localize`Your draw proposal has been accepted.`,ye=$localize`Players agreed to draw.`,te=$localize`You won.`,ke=$localize`You lost.`,$e=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: won.`,Xe=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: has reached their time limit. You won.`,Ft=$localize`You reached your time limit.`,D1=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: has reached their time limit.`,N1=$localize`You resigned.`,is=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: has resigned.`,Kc=$localize`Go back to the game list`,$o=$localize`Propose to play again`,H2=$localize`Accept to play again`,[["id","partCreation",3,"partId","gameStartNotification",4,"ngIf"],["id","game","class","tile is-ancestor",4,"ngIf"],[1,"block","mt-2"],["id","chat",1,"box"],[3,"chatId","turn"],["id","partCreation",3,"partId","gameStartNotification"],["partCreation",""],["id","game",1,"tile","is-ancestor"],[1,"tile","is-parent"],[1,"tile","is-child","box","has-text-centered"],["class","block","id","turnIndicator",4,"ngIf"],[1,"block"],["id","playerZeroIndicator","class","player0-bg",3,"ngClass",4,"ngIf"],["id","scoreZeroIndicator",4,"ngIf"],["debugName","ZERO Global",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoZeroGlobal",""],["debugName","ZERO Turn",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoZeroTurn",""],[1,"is-size-3"],t,["id","playerOneIndicator","class","player1-bg",3,"ngClass",4,"ngIf"],["id","scoreOneIndicator",4,"ngIf"],["debugName","ONE Global",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoOneGlobal",""],["debugName","ONE Turn",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoOneTurn",""],[4,"ngIf"],["class","block","id","winnerIndicator",4,"ngIf"],["class","button is-primary is-fullwidth mb-1","id","backToServerButton","routerLink","/lobby",4,"ngIf"],["id","proposeRematchButton","class","button is-fullwidth mb-1",3,"click",4,"ngIf"],["class","button is-fullwidth is-warning","id","acceptRematchButton",3,"click",4,"ngIf"],["id","board-tile",1,"tile","is-9","is-parent","rounded-div",3,"ngClass"],["id","board",1,"tile","is-child","box"],["board",""],["id","turnIndicator",1,"block"],[1,"subtitle"],e,["class","subtitle","id","currentPlayerIndicator",4,"ngIf"],["id","currentPlayerIndicator",1,"subtitle"],[4,"ngIf","ngIfElse"],["opponentsTurn",""],["id","playerTurn"],r,["id","opponentTurn"],s,["id","playerZeroIndicator",1,"player0-bg",3,"ngClass"],["id","scoreZeroIndicator"],i,["id","playerOneIndicator",1,"player1-bg",3,"ngClass"],["id","scoreOneIndicator"],o,["class","button is-fullwidth mb-1","id","resignButton",3,"click",4,"ngIf"],["class","button is-fullwidth mb-1","id","proposeDrawButton",3,"click",4,"ngIf"],["class","button is-warning is-fullwidth mb-1","id","acceptDrawButton",3,"click",4,"ngIf"],["class","button is-warning is-fullwidth mb-1","id","refuseDrawButton",3,"click",4,"ngIf"],["class","button is-fullwidth mb-1","id","passButton",3,"click",4,"ngIf"],["class","button is-warning is-fullwidth mb-1","id","acceptTakeBackButton",3,"click",4,"ngIf"],["class","button is-warning is-fullwidth mb-1","color","warn","id","refuseTakeBackButton",3,"click",4,"ngIf"],["class","button is-fullwidth","id","askTakeBackButton",3,"click",4,"ngIf"],["id","resignButton",1,"button","is-fullwidth","mb-1",3,"click"],c,["id","proposeDrawButton",1,"button","is-fullwidth","mb-1",3,"click"],u,["id","acceptDrawButton",1,"button","is-warning","is-fullwidth","mb-1",3,"click"],h,["id","refuseDrawButton",1,"button","is-warning","is-fullwidth","mb-1",3,"click"],p,["id","passButton",1,"button","is-fullwidth","mb-1",3,"click"],m,["id","acceptTakeBackButton",1,"button","is-warning","is-fullwidth","mb-1",3,"click"],C,["color","warn","id","refuseTakeBackButton",1,"button","is-warning","is-fullwidth","mb-1",3,"click"],w,["id","askTakeBackButton",1,"button","is-fullwidth",3,"click"],I,["id","winnerIndicator",1,"block"],["id","hardDrawIndicator",1,"title"],H,["class","title","id","youAgreedToDrawIndicator",4,"ngIf"],["class","title","id","yourOpponentAgreedToDrawIndicator",4,"ngIf"],["class","title","id","playersAgreedToDraw",4,"ngIf"],["id","youAgreedToDrawIndicator",1,"title"],K,["id","yourOpponentAgreedToDrawIndicator",1,"title"],ie,["id","playersAgreedToDraw",1,"title"],ye,["class","title","id","youWonIndicator",4,"ngIf"],["class","title","id","youLostIndicator",4,"ngIf"],["class","title",4,"ngIf"],["id","youWonIndicator",1,"title"],te,["id","youLostIndicator",1,"title"],ke,[1,"title"],$e,Xe,Ft,D1,["class","title","id","resignIndicator",4,"ngIf"],["id","resignIndicator",1,"title"],N1,is,["id","backToServerButton","routerLink","/lobby",1,"button","is-primary","is-fullwidth","mb-1"],Kc,["id","proposeRematchButton",1,"button","is-fullwidth","mb-1",3,"click"],$o,["id","acceptRematchButton",1,"button","is-fullwidth","is-warning",3,"click"],H2]},template:function(e,r){1&e&&(x(0,Nft,2,1,"app-part-creation",0),x(1,d9t,30,27,"div",1),b(2,"div",2)(3,"div",3),Q(4,"app-chat",4),O()()),2&e&&(T("ngIf",!1===r.gameStarted),S(1),T("ngIf",r.gameStarted),S(3),T("chatId",r.currentPartId)("turn",null==r.currentPart?null:r.currentPart.getTurn()))},dependencies:[dn,en,Bp,n4e,h1,Mft],encapsulation:2}),n})();function m9t(n,t){if(1&n&&(b(0,"option",26),Tt(1),O()),2&n){const e=t.$implicit;T("value",e.name),S(1),l1(e.name)}}function _9t(n,t){if(1&n&&(b(0,"option",26),_e(1,30),O()),2&n){const e=t.$implicit;T("value",e),S(1),k1(e),F1(1)}}const v9t=function(){return[1,2,3,4,5,6,7,8,9,10,11,12]};function C9t(n,t){if(1&n){const e=Oe();b(0,"select",27),ee("ngModelChange",function(s){return he(e),le(v(2).aiDepths[0]=s)})("change",function(){he(e);const s=v(2);return le(s.updatePlayer(s.Player.ZERO))}),b(1,"option",28),_e(2,29),O(),x(3,_9t,2,2,"option",17),O()}2&n&&(T("ngModel",v(2).aiDepths[0]),S(3),T("ngForOf",rr(2,v9t)))}function y9t(n,t){if(1&n&&(b(0,"p",31),_e(1,32),O()),2&n){const e=v(2);S(1),k1(e.gameComponent.scores.get()[0]),F1(1)}}function E9t(n,t){if(1&n&&(b(0,"option",26),Tt(1),O()),2&n){const e=t.$implicit;T("value",e.name),S(1),l1(e.name)}}function M9t(n,t){if(1&n&&(b(0,"option",26),_e(1,35),O()),2&n){const e=t.$implicit;T("value",e),S(1),k1(e),F1(1)}}const S9t=function(){return[1,2,3,4,5,6,7,8,9,10]};function P9t(n,t){if(1&n){const e=Oe();b(0,"select",33),ee("ngModelChange",function(s){return he(e),le(v(2).aiDepths[1]=s)})("change",function(){he(e);const s=v(2);return le(s.updatePlayer(s.Player.ONE))}),b(1,"option",28),_e(2,34),O(),x(3,M9t,2,2,"option",17),O()}2&n&&(T("ngModel",v(2).aiDepths[1]),S(3),T("ngForOf",rr(2,S9t)))}function T9t(n,t){if(1&n&&(b(0,"p",36),_e(1,37),O()),2&n){const e=v(2);S(1),k1(e.gameComponent.scores.get()[1]),F1(1)}}function w9t(n,t){if(1&n&&(b(0,"h4",41),Tt(1),O()),2&n){const e=v(3);S(1),l1(e.winnerMessage.get())}}function b9t(n,t){1&n&&(b(0,"h4",42),_e(1,43),O())}function O9t(n,t){if(1&n&&(b(0,"div",38),x(1,w9t,2,1,"h4",39),x(2,b9t,2,0,"h4",40),O()),2&n){const e=v(2);S(1),T("ngIf",e.winnerMessage.isPresent()),S(1),T("ngIf",e.winnerMessage.isAbsent())}}function N9t(n,t){if(1&n){const e=Oe();b(0,"div",7)(1,"div",8)(2,"p",9),_e(3,10),O()(),b(4,"div",11)(5,"div",12)(6,"div",13)(7,"select",14),ee("change",function(){he(e);const s=v();return le(s.updatePlayer(s.Player.ZERO))})("ngModelChange",function(s){return he(e),le(v().playerSelection[0]=s)}),b(8,"option",15),_e(9,16),O(),x(10,m9t,2,2,"option",17),O()(),b(11,"div",13),x(12,C9t,4,3,"select",18),O(),x(13,y9t,2,1,"p",19),O(),b(14,"div",20)(15,"div",13)(16,"select",21),ee("change",function(){he(e);const s=v();return le(s.updatePlayer(s.Player.ONE))})("ngModelChange",function(s){return he(e),le(v().playerSelection[1]=s)}),b(17,"option",15),_e(18,22),O(),x(19,E9t,2,2,"option",17),O()(),b(20,"div",13),x(21,P9t,4,3,"select",23),O(),x(22,T9t,2,1,"p",24),O()(),x(23,O9t,3,2,"div",25),O()}if(2&n){const e=v();S(3),k1(e.gameComponent.getTurn()+1),F1(3),S(4),T("ngModel",e.playerSelection[0]),S(3),T("ngForOf",e.gameComponent.availableMinimaxes),S(2),T("ngIf",!1===e.players[0].equalsValue("human")),S(1),T("ngIf",e.gameComponent.scores.isPresent()),S(3),T("ngModel",e.playerSelection[1]),S(3),T("ngForOf",e.gameComponent.availableMinimaxes),S(2),T("ngIf",!1===e.players[1].equalsValue("human")),S(1),T("ngIf",e.gameComponent.scores.isPresent()),S(1),T("ngIf",e.endGame)}}function A9t(n,t){if(1&n){const e=Oe();b(0,"button",50),ee("click",function(){return he(e),le(v(2).gameComponent.pass())}),_e(1,51),O()}}function I9t(n,t){if(1&n){const e=Oe();b(0,"button",52),ee("click",function(){return he(e),le(v(2).takeBack())}),_e(1,53),O()}}function x9t(n,t){if(1&n&&(un(0),Tt(1),Q(2,"br"),fn()),2&n){const e=t.$implicit,r=v(3);S(1),Z2(" ",e.name+": "+e.getBoardValue(r.gameComponent.rules.node)," ")}}function k9t(n,t){if(1&n&&(b(0,"div",54),x(1,x9t,3,1,"ng-container",55),Tt(2),Q(3,"br"),Tt(4),Q(5,"br"),O()),2&n){const e=v(2);S(1),T("ngForOf",e.gameComponent.availableMinimaxes),S(1),Z2(" Created ",e.getCreatedNodes()," nodes."),S(2),Z2(" Minimax time: ",e.getMinimaxTime(),"ms.")}}function L9t(n,t){if(1&n){const e=Oe();b(0,"div",44),x(1,A9t,2,0,"button",45),x(2,I9t,2,0,"button",46),b(3,"button",47),ee("click",function(){return he(e),le(v().restartGame())}),_e(4,48),O(),x(5,k9t,6,3,"div",49),O()}if(2&n){const e=v();S(1),T("ngIf",!1===e.endGame&&e.gameComponent.canPass),S(1),T("ngIf",e.canTakeBack()),S(3),T("ngIf",e.gameComponent.rules.node.move.isPresent()&&e.displayAIMetrics)}}let R9t=(()=>{class n extends JP{constructor(e,r,s,i,o,c){super(e,r,s,i,o),this.cdr=c,this.aiDepths=["0","0"],this.playerSelection=["human","human"],this.winnerMessage=P.empty(),this.botTimeOut=1e3,this.displayAIMetrics=!1,this.players=[P.of(this.playerSelection[0]),P.of(this.playerSelection[1])],this.role=z.ZERO,X(n.VERBOSE,"LocalGameWrapper.constructor")}getCreatedNodes(){return dP.createdNodes}getMinimaxTime(){return dP.minimaxTime}ngAfterViewInit(){var e=this;setTimeout(A(function*(){(yield e.afterViewInit())&&(e.restartGame(),e.cdr.detectChanges())}),1)}updatePlayer(e){this.players[e.value]=P.of(this.playerSelection[e.value]),this.setRole("human"===this.playerSelection[1]&&"human"!==this.playerSelection[0]?z.ONE:z.ZERO),this.proposeAIToPlay()}onLegalUserMove(e){var r=this;return A(function*(){X(n.VERBOSE,"LocalGameWrapperComponent.onLegalUserMove"),r.gameComponent.rules.choose(e),r.updateBoard(),r.proposeAIToPlay()})()}updateBoard(){this.gameComponent.updateBoard();const e=this.gameComponent.rules.getGameStatus(this.gameComponent.rules.node);if(!0===e.isEndGame&&(this.endGame=!0,e.winner.isPlayer())){const r=$localize`Player ${e.winner.value+1}`,i=e.winner.getOpponent().value;this.winnerMessage=this.players[e.winner.value].equalsValue("human")?this.players[i].equalsValue("human")?P.of($localize`${r} won`):P.of($localize`You won`):this.players[i].equalsValue("human")?P.of($localize`You lost`):P.of($localize`${this.players[e.winner.value].get()} (${r}) won`)}}proposeAIToPlay(){var e=this;const r=this.getPlayingAI();r.isPresent()&&window.setTimeout(A(function*(){yield e.doAIMove(r.get())}),this.botTimeOut)}getPlayingAI(){if(this.gameComponent.rules.getGameStatus(this.gameComponent.rules.node).isEndGame)return P.empty();const e=this.gameComponent.getTurn()%2;return"0"===this.aiDepths[e]?P.empty():P.ofNullable(this.gameComponent.availableMinimaxes.find(r=>this.players[e].equalsValue(r.name)))}doAIMove(e){var r=this;return A(function*(){const s=r.gameComponent.rules;ve(s.getGameStatus(s.node)===xe.ONGOING,"AI should not try to play when game is over!");const c=Number.parseInt(r.aiDepths[s.node.gameState.turn%2%2]),u=s.node.findBestMove(c,e,!0);return s.choose(u)?(r.updateBoard(),r.cdr.detectChanges(),r.proposeAIToPlay(),G.SUCCESS):(r.messageDisplayer.criticalMessage($localize`The AI chose an illegal move! This is an unexpected situation that we logged, we will try to solve this as soon as possible. In the meantime, consider that you won!`),Os.logError("LocalGameWrapper","AI chose illegal move",{name:e.name,move:u.toString()}))})()}canTakeBack(){return this.gameComponent.getTurn()>0}takeBack(){this.gameComponent.rules.node=this.gameComponent.rules.node.mother.get(),this.isAITurn()&&(this.gameComponent.rules.node=this.gameComponent.rules.node.mother.get()),this.gameComponent.updateBoard()}isAITurn(){return this.getPlayingAI().isPresent()}restartGame(){this.gameComponent.rules.setInitialBoard(),this.gameComponent.updateBoard(),this.endGame=!1,this.winnerMessage=P.empty(),this.proposeAIToPlay()}getPlayer(){return"human"}onCancelMove(e){this.gameComponent.rules.node.move.isPresent()&&this.gameComponent.showLastMove()}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(J(Ia),J(bo),J(Ns),J(Zn),J(Pn),J(_u))},n.\u0275cmp=gt({type:n,selectors:[["app-local-game-wrapper"]],features:[l],decls:8,vars:3,consts:function(){let t,e,r,s,i,o,c,u,h,p,m,C,w;return t=$localize`Turn n${"\ufffd0\ufffd"}:INTERPOLATION:`,e=$localize`Human`,r=$localize`Human`,s=$localize`Pick the level`,i=$localize`Level ${"\ufffd0\ufffd"}:INTERPOLATION:`,o=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: points`,c=$localize`Pick the level`,u=$localize`Level ${"\ufffd0\ufffd"}:INTERPOLATION:`,h=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: points`,p=$localize`Draw`,m=$localize`Start a new game`,C=$localize`Pass a turn`,w=$localize`Take back move`,[[1,"tile","is-ancestor"],[1,"tile","is-3","is-vertical","is-parent"],["class","tile is-child box has-text-centered","id","info",4,"ngIf"],["class","tile is-child box is-vcentered",4,"ngIf"],[1,"tile","is-parent","is-9","is-vcentered",3,"ngClass"],["id","board",1,"tile","is-child","box"],["board",""],["id","info",1,"tile","is-child","box","has-text-centered"],["id","turnIndicator",1,"block"],[1,"subtitle"],t,["id","playerSelector",1,"columns"],[1,"column","is-6","is-vcentered"],[1,"select"],["id","playerZeroSelect",3,"ngModel","change","ngModelChange"],["selected","","value","human"],e,[3,"value",4,"ngFor","ngForOf"],["id","aiZeroDepthSelect",3,"ngModel","ngModelChange","change",4,"ngIf"],["id","scoreOne","class","block",4,"ngIf"],[1,"column","is-6"],["id","playerOneSelect",3,"ngModel","change","ngModelChange"],r,["id","aiOneDepthSelect",3,"ngModel","ngModelChange","change",4,"ngIf"],["id","scoreZero","class","block",4,"ngIf"],["id","gameResult","class","block",4,"ngIf"],[3,"value"],["id","aiZeroDepthSelect",3,"ngModel","ngModelChange","change"],["selected","","value","0"],s,i,["id","scoreOne",1,"block"],o,["id","aiOneDepthSelect",3,"ngModel","ngModelChange","change"],c,u,["id","scoreZero",1,"block"],h,["id","gameResult",1,"block"],["id","winner",4,"ngIf"],["id","draw",4,"ngIf"],["id","winner"],["id","draw"],p,[1,"tile","is-child","box","is-vcentered"],["id","passButton","class","button is-primary is-fullwidth mb-1",3,"click",4,"ngIf"],["id","takeBack","class","button is-fullwidth mb-1",3,"click",4,"ngIf"],["id","restartButton",1,"button","is-fullwidth",3,"click"],m,["id","AIMetrics",4,"ngIf"],["id","passButton",1,"button","is-primary","is-fullwidth","mb-1",3,"click"],C,["id","takeBack",1,"button","is-fullwidth","mb-1",3,"click"],w,["id","AIMetrics"],[4,"ngFor","ngForOf"]]},template:function(e,r){1&e&&(b(0,"div",0)(1,"div",1),x(2,N9t,24,10,"div",2),x(3,L9t,6,3,"div",3),O(),b(4,"div",4)(5,"div",5),Q(6,"div",null,6),O()()()),2&e&&(S(2),T("ngIf",r.gameComponent),S(1),T("ngIf",r.gameComponent),S(1),T("ngClass",r.getBoardHighlight()))},dependencies:[dn,An,en,Sp,Pp,Hy,xl,Mp],encapsulation:2,changeDetection:0}),n})(),a4e=(()=>{class n{}return n.STEP_FINISHED=()=>$localize`Step finished!`,n.INFORMATIONAL_STEP=()=>$localize`This step is not expecting any move from your part.`,n})();function D9t(n,t){if(1&n&&(b(0,"div",21)(1,"div",22),_e(2,23),O(),Q(3,"div",24),O()),2&n){const e=v();S(3),T("innerHTML",e.currentReason.get(),X8)}}function z9t(n,t){if(1&n){const e=Oe();b(0,"button",25),ee("click",function(){return he(e),le(v().retry())}),_e(1,26),O()}}function V9t(n,t){1&n&&(un(0),_e(1,31),fn())}function H9t(n,t){1&n&&(un(0),_e(1,32),fn())}function F9t(n,t){if(1&n&&x(0,H9t,2,0,"ng-container",28),2&n){v();const e=Qn(5),r=v();T("ngIf",r.stepFinished&&r.stepFinished[r.stepIndex])("ngIfElse",e)}}function B9t(n,t){1&n&&(un(0),_e(1,33),fn())}function $9t(n,t){if(1&n){const e=Oe();b(0,"button",27),ee("click",function(){return he(e),le(v().next())}),x(1,V9t,2,0,"ng-container",28),x(2,F9t,1,2,"ng-template",null,29,r1),x(4,B9t,2,0,"ng-template",null,30,r1),O()}if(2&n){const e=Qn(3),r=v();S(1),T("ngIf",r.steps[r.stepIndex]&&r.steps[r.stepIndex].isInformation())("ngIfElse",e)}}function U9t(n,t){if(1&n){const e=Oe();b(0,"button",34),ee("click",function(){return he(e),le(v().start())}),_e(1,35),O()}}function G9t(n,t){if(1&n){const e=Oe();b(0,"button",36),ee("click",function(){return he(e),le(v().playLocally())}),_e(1,37),O()}}function W9t(n,t){if(1&n){const e=Oe();b(0,"button",38),ee("click",function(){return he(e),le(v().createGame())}),_e(1,39),O()}}function q9t(n,t){if(1&n){const e=Oe();b(0,"button",40),ee("click",function(){return he(e),le(v().showSolution())}),_e(1,41),O()}}function j9t(n,t){if(1&n&&(un(0),b(1,"option",43),Tt(2),O(),fn()),2&n){const e=v(),r=e.index,s=e.$implicit;S(1),y1("id","step_",r,""),T("value",r),S(1),l1(s.title)}}function Z9t(n,t){1&n&&(un(0),Tt(1,"v "),fn())}function Y9t(n,t){1&n&&Tt(0,"x ")}function K9t(n,t){if(1&n&&(b(0,"option",44),x(1,Z9t,2,0,"ng-container",28),x(2,Y9t,1,0,"ng-template",null,45,r1),b(4,"span",46),Tt(5),O()()),2&n){const e=Qn(3),r=v(),s=r.index,i=r.$implicit,o=v();T("value",s),S(1),T("ngIf",o.stepFinished[s])("ngIfElse",e),S(3),y1("id","step_",s,""),S(1),l1(i.title)}}function X9t(n,t){if(1&n&&(un(0),x(1,j9t,3,3,"ng-container",28),x(2,K9t,6,5,"ng-template",null,42,r1),fn()),2&n){const e=t.index,r=Qn(3),s=v();S(1),T("ngIf",e===s.stepIndex)("ngIfElse",r)}}let Q9t=(()=>{class n extends JP{constructor(e,r,s,i,o,c){super(e,r,c,s,i),this.cdr=o,this.connectedUserService=c,this.COMPLETED_TUTORIAL_MESSAGE=$localize`Congratulations, you completed the tutorial.`,this.steps=[],this.successfulSteps=0,this.stepIndex=-1,this.currentMessage="",this.currentReason=P.empty(),this.moveAttemptMade=!1,this.stepFinished=[],this.tutorialOver=!1,X(n.VERBOSE,"TutorialGameWrapperComponent.constructor"),this.role=z.ZERO}getNumberOfSteps(){return this.steps.length}getCurrentStepTitle(){return this.steps.length>0?this.steps[this.stepIndex].title:""}ngAfterViewInit(){var e=this;return A(function*(){X(n.VERBOSE,"TutorialGameWrapperComponent.ngAfterViewInit"),(yield e.afterViewInit())&&e.start()})()}start(){this.startTutorial(this.gameComponent.tutorial)}startTutorial(e){X(n.VERBOSE,{tutorialGameWrapperComponent_startTutorial:{tutorial:e}}),this.steps=e,this.tutorialOver=!1,this.stepFinished=this.getCompletionArray(),this.successfulSteps=0,this.showStep(0)}getCompletionArray(){return this.steps.map(()=>!1)}changeStep(e){this.showStep(Number.parseInt(e.target.value,10))}showStep(e){X(n.VERBOSE,"tutorialGameWrapperComponent.showStep("+e+")"),this.moveAttemptMade=!1,this.stepFinished[e]=!1,this.updateSuccessCount(),this.stepIndex=e;const r=this.steps[this.stepIndex];let s;if(this.currentMessage=r.instruction,this.currentReason=P.empty(),r.previousState.isPresent()){const i=new $1(r.previousState.get());s=P.of(i)}else s=P.empty();this.gameComponent.rules.node=new $1(r.state,s,r.previousMove),this.gameComponent.updateBoard(),this.setRole(this.gameComponent.getCurrentPlayer()),this.cdr.detectChanges()}onLegalUserMove(e){var r=this;return A(function*(){X(n.VERBOSE,{tutorialGameWrapper_onLegalUserMove:{move:e}});const s=r.steps[r.stepIndex];if(ve(r.gameComponent.rules.choose(e),"It should be impossible to call onLegalUserMove with an illegal move"),X(n.VERBOSE,"tutorialGameWrapper.onLegalUserMove: legal move"),r.gameComponent.updateBoard(),r.moveAttemptMade=!0,s.isPredicate()){const o=r.gameComponent.getPreviousState(),c=r.gameComponent.getState(),u=Me.getNonNullable(s.predicate)(e,o,c);u.isSuccess()?r.showStepSuccess(s.getSuccessMessage()):r.currentReason=P.of(u.getReason())}else if(s.isAnyMove())X(n.VERBOSE,"tutorialGameWrapper.onLegalUserMove: awaited move!"),r.showStepSuccess(s.getSuccessMessage());else{ve(s.isMove(),"cannot reach here with a click step");const o=s;o.acceptedMoves.some(c=>c.equals(e))?(X(n.VERBOSE,"tutorialGameWrapper.onLegalUserMove: awaited move!"),r.showStepSuccess(o.getSuccessMessage())):(X(n.VERBOSE,"tutorialGameWrapper.onLegalUserMove: not the move that was awaited."),r.currentReason=P.of(o.getFailureMessage()))}r.cdr.detectChanges()})()}retry(){X(n.VERBOSE,"tutorialGameWrapper.retry"),this.moveAttemptMade=!1,this.showStep(this.stepIndex)}onUserClick(e){if(X(n.VERBOSE,"tutorialGameWrapper.onUserClick("+e+")"),this.currentReason=P.empty(),this.stepFinished[this.stepIndex]||this.moveAttemptMade)return G.failure(a4e.STEP_FINISHED());const r=this.steps[this.stepIndex];return r.isClick()?(this.gameComponent.updateBoard(),this.moveAttemptMade=!0,Me.getNonNullable(r.acceptedClicks).some(s=>s===e)?this.showStepSuccess(r.getSuccessMessage()):this.currentMessage=r.getFailureMessage(),G.SUCCESS):r.isMove()||r.isPredicate()||r.isAnyMove()?(window.setTimeout(()=>{this.cdr.detectChanges()},10),G.SUCCESS):G.failure(a4e.INFORMATIONAL_STEP())}onCancelMove(e){X(n.VERBOSE,"tutorialGameWrapperComponent.onCancelMove("+e+")"),void 0!==e&&(this.currentReason=P.of(e)),this.cdr.detectChanges()}showStepSuccess(e){X(n.VERBOSE,"tutorialGameWrapperComponent.showStepSuccess()"),this.currentMessage=e,this.stepFinished[this.stepIndex]=!0,this.updateSuccessCount()}updateSuccessCount(){let e=0;for(const r of this.stepFinished)r&&e++;this.successfulSteps=e}next(){if(this.steps[this.stepIndex].isInformation()&&(this.stepFinished[this.stepIndex]=!0,this.updateSuccessCount()),this.stepFinished.length===this.successfulSteps)this.currentMessage=this.COMPLETED_TUTORIAL_MESSAGE,this.tutorialOver=!0;else{let e=(this.stepIndex+1)%this.steps.length;for(;!0===this.stepFinished[e];)e=(e+1)%this.steps.length;this.showStep(e)}}showSolution(){var e=this;return A(function*(){X(n.VERBOSE,"tutorialGameWrapper.showSolution()");const r=e.steps[e.stepIndex];ve(r.hasSolution(),"step must have solution");const s=r,i=s.getSolution();i instanceof Gi?(e.showStep(e.stepIndex),e.gameComponent.rules.choose(i),e.gameComponent.updateBoard()):(e.showStep(e.stepIndex),window.document.querySelector(i).dispatchEvent(new Event("click"))),e.currentMessage=s.getSuccessMessage(),e.moveAttemptMade=!0,e.cdr.detectChanges()})()}playLocally(){var e=this;return A(function*(){const r=Me.getNonNullable(e.actRoute.snapshot.paramMap.get("compo"));yield e.router.navigate(["/local",r])})()}createGame(){var e=this;return A(function*(){const r=Me.getNonNullable(e.actRoute.snapshot.paramMap.get("compo"));yield e.router.navigate(["/play",r])})()}getPlayer(){return"tutorial-player"}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(J(Ia),J(bo),J(Zn),J(Pn),J(_u),J(Ns))},n.\u0275cmp=gt({type:n,selectors:[["app-tutorial-game-wrapper"]],features:[l],decls:23,vars:15,consts:function(){let t,e,r,s,i,o,c,u,h;return t=$localize`Failure`,e=$localize`Try again`,r=$localize`Ok`,s=$localize`Continue`,i=$localize`Skip`,o=$localize`Try again`,c=$localize`Play locally`,u=$localize`Create an online game`,h=$localize`See solution`,[[1,"tile","is-ancestor"],[1,"tile","is-5","is-vertical","is-parent"],["id","infos",1,"tile","is-child","box"],[1,"progress","is-primary"],[1,"content","is-medium"],[1,"title"],["id","currentMessage",3,"innerHTML"],["class","message is-danger","role","alert",4,"ngIf"],[1,"block"],["id","retryButton","class","button mr-3",3,"click",4,"ngIf"],["id","nextButton","class","button is-primary mr-3 mb-1",3,"click",4,"ngIf"],["id","restartButton","class","button",3,"click",4,"ngIf"],["id","playLocallyButton","class","button",3,"click",4,"ngIf"],["id","playOnlineButton","class","button",3,"click",4,"ngIf"],["id","showSolutionButton","class","button",3,"click",4,"ngIf"],[1,"select"],["id","steps",3,"change"],[4,"ngFor","ngForOf"],[1,"tile","is-parent","is-7","is-vcentered",3,"ngClass"],["id","board",1,"tile","is-child","box"],["board",""],["role","alert",1,"message","is-danger"],[1,"message-header"],t,["id","currentReason",1,"message-body",3,"innerHTML"],["id","retryButton",1,"button","mr-3",3,"click"],e,["id","nextButton",1,"button","is-primary","mr-3","mb-1",3,"click"],[4,"ngIf","ngIfElse"],["notInfo",""],["notFinished",""],r,s,i,["id","restartButton",1,"button",3,"click"],o,["id","playLocallyButton",1,"button",3,"click"],c,["id","playOnlineButton",1,"button",3,"click"],u,["id","showSolutionButton",1,"button",3,"click"],h,["otherstep",""],["selected","",3,"id","value"],[3,"value"],["notdone",""],[3,"id"]]},template:function(e,r){1&e&&(b(0,"div",0)(1,"div",1)(2,"div",2),Q(3,"progress",3),b(4,"div",4)(5,"p",5),Tt(6),O(),Q(7,"p",6),O(),x(8,D9t,4,1,"div",7),b(9,"div",8),x(10,z9t,2,0,"button",9),x(11,$9t,6,2,"button",10),x(12,U9t,2,0,"button",11),x(13,G9t,2,0,"button",12),x(14,W9t,2,0,"button",13),x(15,q9t,2,0,"button",14),b(16,"div",15)(17,"select",16),ee("change",function(i){return r.changeStep(i)}),x(18,X9t,4,2,"ng-container",17),O()()()()(),b(19,"div",18)(20,"div",19),Q(21,"div",null,20),O()()()),2&e&&(S(3),D("value",r.successfulSteps)("max",r.getNumberOfSteps()),S(3),Jb("",r.getCurrentStepTitle()," [",r.stepIndex+1,"/",r.getNumberOfSteps(),"]"),S(1),T("innerHTML",r.currentMessage,X8),S(1),T("ngIf",r.currentReason.isPresent()),S(2),T("ngIf",!1===r.tutorialOver&&(r.stepFinished&&!0===r.stepFinished[r.stepIndex]||r.moveAttemptMade)),S(1),T("ngIf",!1===r.tutorialOver),S(1),T("ngIf",r.tutorialOver),S(1),T("ngIf",r.tutorialOver),S(1),T("ngIf",r.tutorialOver),S(1),T("ngIf",r.moveAttemptMade&&!1===r.stepFinished[r.stepIndex]),S(3),T("ngForOf",r.steps),S(1),T("ngClass",r.getBoardHighlight()))},dependencies:[dn,An,en,Sp,Pp],encapsulation:2,changeDetection:0}),n})();function J9t(n,t){if(1&n&&(b(0,"div",35)(1,"div",36),_e(2,37),O(),b(3,"div",38),Tt(4),O()()),2&n){const e=v();S(4),l1(e.errorMessage)}}const eht=function(){return["/login"]};let tht=(()=>{class n{constructor(e,r){this.connectedUserService=e,this.router=r,this.faEye=BV,this.registrationForm=new y0({email:new Va,username:new Va,password:new Va})}registerWithEmail(){var e=this;return A(function*(){const r=e.registrationForm.value.username,s=e.registrationForm.value.email,i=e.registrationForm.value.password;if(null==r||null==s||null==i)e.errorMessage=$localize`There are missing fields in the registration form, please check that you filled in all fields.`;else{const o=yield e.connectedUserService.doRegister(r,s,i);if(o.isSuccess()){const c=yield e.connectedUserService.sendEmailVerification();c.isSuccess()?yield e.router.navigate(["/verify-account"]):e.errorMessage=c.getReason()}else e.errorMessage=o.getReason()}})()}registerWithGoogle(){var e=this;return A(function*(){const r=yield e.connectedUserService.doGoogleLogin();r.isSuccess()?yield e.router.navigate(["/verify-account"]):e.errorMessage=r.getReason()})()}getPasswordHelpClass(){const e=this.registrationForm.value.password;return null==e||""===e?"":e.length<6?"is-danger":"is-success"}canRegister(){const e=this.registrationForm.value.password??"";return!(""===(this.registrationForm.value.email??"")||""===(this.registrationForm.value.username??"")||""===e||e.length<6)}}return n.\u0275fac=function(e){return new(e||n)(J(Ns),J(Zn))},n.\u0275cmp=gt({type:n,selectors:[["app-register"]],decls:56,vars:7,consts:function(){let t,e,r,s,i,o,c,u,h,p,m,C,w,I;return t=$localize`Registering`,e=$localize`Email`,r=$localize`Email`,s=$localize`A confirmation email will be sent to validate your account.`,i=$localize`Username`,o=$localize`Username`,c=$localize`Password`,u=$localize`Password`,h=$localize`The password should be at least 6 characters long`,p=$localize`Register`,m=$localize`Register with Google`,C=$localize`Have an account?`,w=$localize`Log in`,I=$localize`Registration error`,[[1,"box"],[1,"title"],t,[3,"formGroup"],[1,"field","is-horizontal"],[1,"field-label"],["for","email",1,"label"],e,[1,"field-body"],[1,"field"],[1,"control"],["id","email","formControlName","email","name","email","placeholder",r,"type","email","autofocus","","required","",1,"input"],[1,"help"],s,["for","username",1,"label"],i,["id","username","formControlName","username","name","username","placeholder",o,"type","text","required","",1,"input"],["for","password",1,"label"],c,[1,"control","has-icons-right","is-expanded"],["id","password","formControlName","password","name","password","placeholder",u,"type","password","required","",1,"input"],[1,"icon","is-small","is-right"],["toggleVisibility","",1,"clickable-icon",3,"icon"],["id","passwordHelp",1,"help",3,"ngClass"],h,["id","registerButton",1,"button","is-primary","is-fullwidth",3,"disabled","click"],p,[1,"field-body","is-fullwidth"],["class","message is-danger is-fullwidth","role","alert",4,"ngIf"],["id","googleButton","type","submit",1,"button","is-fullwidth",3,"click"],m,[1,"help","level-right"],C,[3,"routerLink"],w,["role","alert",1,"message","is-danger","is-fullwidth"],[1,"message-header"],I,["id","errorMessage",1,"message-body"]]},template:function(e,r){1&e&&(b(0,"div",0)(1,"p",1),_e(2,2),O(),b(3,"form",3)(4,"div",4)(5,"div",5)(6,"label",6),_e(7,7),O()(),b(8,"div",8)(9,"div",9)(10,"div",10),Q(11,"input",11),b(12,"p",12),_e(13,13),O()()()()(),b(14,"div",4)(15,"div",5)(16,"label",14),_e(17,15),O()(),b(18,"div",8)(19,"div",9)(20,"div",10),Q(21,"input",16),O()()()(),b(22,"div",4)(23,"div",5)(24,"label",17),_e(25,18),O()(),b(26,"div",8)(27,"div",9)(28,"div",19),Q(29,"input",20),b(30,"span",21),Q(31,"fa-icon",22),O(),b(32,"p",23),_e(33,24),O()()()()(),b(34,"div",4),Q(35,"div",5),b(36,"div",8)(37,"div",9)(38,"div",10)(39,"button",25),ee("click",function(){return r.registerWithEmail()}),_e(40,26),O()()()()(),b(41,"div",4),Q(42,"div",5),b(43,"div",27),x(44,J9t,5,1,"div",28),O()(),b(45,"div",4),Q(46,"div",5),b(47,"div",8)(48,"button",29),ee("click",function(){return r.registerWithGoogle()}),_e(49,30),O()()(),b(50,"p",31),un(51),_e(52,32),fn(),Tt(53,"\xa0 "),b(54,"a",33),_e(55,34),O()()()()),2&e&&(S(3),T("formGroup",r.registrationForm),S(28),T("icon",r.faEye),S(1),T("ngClass",r.getPasswordHelpClass()),S(7),T("disabled",!r.canRegister()),S(5),T("ngIf",r.errorMessage),S(10),T("routerLink",rr(6,eht)))},dependencies:[dn,en,Nu,Mu,M4,xl,Eu,Tu,Su,ff,v9,jH,e4e],encapsulation:2}),n})(),nht=(()=>{class n{constructor(e){this.router=e}pickGame(e){this.selectedGame=e}playLocally(){var e=this;return A(function*(){yield e.router.navigate(["local/"+e.selectedGame])})()}}return n.\u0275fac=function(e){return new(e||n)(J(Zn))},n.\u0275cmp=gt({type:n,selectors:[["app-local-game-creation"]],decls:3,vars:1,consts:function(){let t;return t=$localize`Play offline`,[[3,"pickGame"],["id","launchGame",1,"button","is-primary","is-fullwidth",3,"disabled","click"],t]},template:function(e,r){1&e&&(b(0,"app-pick-game",0),ee("pickGame",function(i){return r.pickGame(i)}),O(),b(1,"button",1),ee("click",function(){return r.playLocally()}),_e(2,2),O()),2&e&&(S(1),T("disabled",!r.selectedGame))},dependencies:[qH],encapsulation:2}),n})(),rht=(()=>{class n{constructor(e){this.router=e}pickGame(e){this.selectedGame=e}launchTutorial(){var e=this;return A(function*(){yield e.router.navigate(["/tutorial/",e.selectedGame])})()}}return n.\u0275fac=function(e){return new(e||n)(J(Zn))},n.\u0275cmp=gt({type:n,selectors:[["app-tutorial-game-creation"]],decls:3,vars:1,consts:function(){let t;return t=$localize`Learn the rules`,[[3,"pickGame"],["id","launchTutorial",1,"button","is-primary","is-fullwidth",3,"disabled","click"],t]},template:function(e,r){1&e&&(b(0,"app-pick-game",0),ee("pickGame",function(i){return r.pickGame(i)}),O(),b(1,"button",1),ee("click",function(){return r.launchTutorial()}),_e(2,2),O()),2&e&&(S(1),T("disabled",!r.selectedGame))},dependencies:[qH],encapsulation:2}),n})(),sht=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=gt({type:n,selectors:[["app-next-game-loading"]],decls:2,vars:0,consts:function(){let t;return t=$localize`The replay game is loading, please wait, it should not take long.`,[t]},template:function(e,r){1&e&&(b(0,"p"),_e(1,0),O())},encapsulation:2}),n})();function oht(n,t){if(1&n&&(F(),Q(0,"polygon",4)),2&n){const e=v();T("id",e.mainShapeId)("ngClass",e.pieceClasses),D("points",e.MartianChessQueenComponent.HEPTAGON)}}function aht(n,t){if(1&n&&(F(),Q(0,"polygon",4)),2&n){const e=v();T("id",e.mainShapeId)("ngClass",e.pieceClasses),D("points",e.MartianChessQueenComponent.EIGHT_POINTED_STAR)}}function cht(n,t){if(1&n&&(F(),Q(0,"circle",5)),2&n){const e=v();T("id",e.mainShapeId)("ngClass",e.pieceClasses),D("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",.5*e.MartianChessComponent.SPACE_SIZE-e.MartianChessComponent.STROKE_WIDTH)}}function lht(n,t){if(1&n&&(un(0),F(),Q(1,"circle",6)(2,"circle",6)(3,"circle",6),fn()),2&n){const e=v();S(1),D("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",e.MartianChessComponent.getRadius(3)),S(1),D("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",e.MartianChessComponent.getRadius(2)),S(1),D("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",e.MartianChessComponent.getRadius(1))}}function uht(n,t){if(1&n&&(F(),b(0,"g"),Q(1,"circle",7)(2,"circle",7)(3,"circle",7),O()),2&n){const e=v();S(1),D("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.45*e.MartianChessComponent.SPACE_SIZE)("r",.2/3*e.MartianChessComponent.SPACE_SIZE),S(1),D("cx",.45*e.MartianChessComponent.SPACE_SIZE)("cy",.55*e.MartianChessComponent.SPACE_SIZE)("r",.2/3*e.MartianChessComponent.SPACE_SIZE),S(1),D("cx",.55*e.MartianChessComponent.SPACE_SIZE)("cy",.55*e.MartianChessComponent.SPACE_SIZE)("r",.2/3*e.MartianChessComponent.SPACE_SIZE)}}function fht(n,t){if(1&n&&(F(),b(0,"g",8),Q(1,"circle",9)(2,"circle",9)(3,"circle",9),O()),2&n){const e=v();T("ngClass",e.pieceClasses),S(1),D("cx",.5*e.MartianChessComponent.SPACE_SIZE-3*e.horizontalDotsRadius)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",1.5*e.horizontalDotsRadius),S(1),D("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",1.5*e.horizontalDotsRadius),S(1),D("cx",.5*e.MartianChessComponent.SPACE_SIZE+3*e.horizontalDotsRadius)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",1.5*e.horizontalDotsRadius)}}class C6{constructor(){this.MartianChessQueenComponent=C6,this.MartianChessComponent=Fo,this.horizontalDotsRadius=Fo.SPACE_SIZE/15}}function dht(n,t){if(1&n&&(F(),Q(0,"polygon",4)),2&n){const e=v();T("id",e.mainShapeId)("ngClass",e.pieceClasses),D("points",e.MartianChessDroneComponent.PENTAGON)}}function pht(n,t){if(1&n&&(F(),Q(0,"polygon",4)),2&n){const e=v();T("id",e.mainShapeId)("ngClass",e.pieceClasses),D("points",e.MartianChessDroneComponent.FOUR_POINTED_STAR_VERTICAL)}}function ght(n,t){if(1&n&&(F(),Q(0,"circle",5)),2&n){const e=v();T("id",e.mainShapeId)("ngClass",e.pieceClasses),D("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",.5*e.MartianChessComponent.SPACE_SIZE-e.MartianChessComponent.STROKE_WIDTH)}}function mht(n,t){if(1&n&&(un(0),F(),Q(1,"circle",6)(2,"circle",6),fn()),2&n){const e=v();S(1),D("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",e.MartianChessComponent.getRadius(2)),S(1),D("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",e.MartianChessComponent.getRadius(1))}}function _ht(n,t){if(1&n&&(F(),b(0,"g",7),Q(1,"circle",8)(2,"circle",8),O()),2&n){const e=v();T("ngClass",e.pieceClasses),S(1),D("cx",.4*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",.2/3*e.MartianChessComponent.SPACE_SIZE),S(1),D("cx",.6*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",.2/3*e.MartianChessComponent.SPACE_SIZE)}}function vht(n,t){if(1&n&&(F(),b(0,"g",7),Q(1,"circle",9)(2,"circle",9),O()),2&n){const e=v();T("ngClass",e.pieceClasses),S(1),D("cx",.5*e.MartianChessComponent.SPACE_SIZE-2*e.horizontalDotsRadius)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",1.5*e.horizontalDotsRadius),S(1),D("cx",.5*e.MartianChessComponent.SPACE_SIZE+2*e.horizontalDotsRadius)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",1.5*e.horizontalDotsRadius)}}C6.HEPTAGON=Fo.getRegularPolygon(7),C6.EIGHT_POINTED_STAR=Fo.getNPointedStar(8,0),C6.\u0275fac=function(t){return new(t||C6)},C6.\u0275cmp=gt({type:C6,selectors:[["","app-martian-chess-queen",""]],inputs:{mainShapeId:"mainShapeId",pieceClasses:"pieceClasses",style:"style"},attrs:["app-martian-chess-queen",""],decls:6,vars:6,consts:[["class","base","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["class","base",3,"id","ngClass",4,"ngIf"],[4,"ngIf"],[3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[1,"base",3,"id","ngClass"],[1,"base","no-fill","mid-stroke"],[1,"base","mid-stroke"],[3,"ngClass"],[1,"base-no-stroke"]],template:function(t,e){1&t&&(x(0,oht,1,3,"polygon",0),x(1,aht,1,3,"polygon",0),x(2,cht,1,5,"circle",1),x(3,lht,4,9,"ng-container",2),x(4,uht,4,9,"g",2),x(5,fht,4,10,"g",3)),2&t&&(T("ngIf","Polygon"===e.style.shape),S(1),T("ngIf","Star"===e.style.shape),S(1),T("ngIf","Circle"===e.style.shape),S(1),T("ngIf","Concentric Circles"===e.style.points),S(1),T("ngIf","Dots"===e.style.points),S(1),T("ngIf","Horizontal Points"===e.style.points))},dependencies:[dn,en],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});class y6{constructor(){this.MartianChessComponent=Fo,this.MartianChessDroneComponent=y6,this.horizontalDotsRadius=Fo.SPACE_SIZE/15}}function yht(n,t){if(1&n&&(F(),Q(0,"polygon",5)),2&n){const e=v();T("id",e.mainShapeId)("ngClass",e.pieceClasses),D("points",e.MartianChessPawnComponent.TRIANGLE)}}function Eht(n,t){if(1&n&&(F(),Q(0,"polygon",5)),2&n){const e=v();T("id",e.mainShapeId)("ngClass",e.pieceClasses),D("points",e.MartianChessPawnComponent.FOUR_POINTED_STAR_DIAGONAL)}}function Mht(n,t){if(1&n&&(F(),Q(0,"circle",6)),2&n){const e=v();T("id",e.mainShapeId)("ngClass",e.pieceClasses),D("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",.5*e.MartianChessComponent.SPACE_SIZE-e.MartianChessComponent.STROKE_WIDTH)}}function Sht(n,t){if(1&n&&(F(),Q(0,"circle",7)),2&n){const e=v();D("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE+e.getConcreteTriangleYOffset())("r",e.MartianChessComponent.getRadius(1))}}function Pht(n,t){if(1&n&&(F(),Q(0,"circle",8)),2&n){const e=v();D("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",.2/3*e.MartianChessComponent.SPACE_SIZE)}}function Tht(n,t){if(1&n&&(F(),b(0,"g",9),Q(1,"circle",10),O()),2&n){const e=v();T("ngClass",e.pieceClasses),S(1),D("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",1.5*e.horizontalDotsRadius)}}y6.FOUR_POINTED_STAR_VERTICAL=Fo.getNPointedStar(4,0),y6.PENTAGON=Fo.getRegularPolygon(5),y6.\u0275fac=function(t){return new(t||y6)},y6.\u0275cmp=gt({type:y6,selectors:[["","app-martian-chess-drone",""]],inputs:{mainShapeId:"mainShapeId",pieceClasses:"pieceClasses",style:"style"},attrs:["app-martian-chess-drone",""],decls:6,vars:6,consts:[["class","base","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["class","base",3,"id","ngClass",4,"ngIf"],[4,"ngIf"],[3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[1,"base",3,"id","ngClass"],[1,"base","no-fill","mid-stroke"],[3,"ngClass"],[1,"base","mid-stroke"],[1,"base-no-stroke"]],template:function(t,e){1&t&&(x(0,dht,1,3,"polygon",0),x(1,pht,1,3,"polygon",0),x(2,ght,1,5,"circle",1),x(3,mht,3,6,"ng-container",2),x(4,_ht,3,7,"g",3),x(5,vht,3,7,"g",3)),2&t&&(T("ngIf","Polygon"===e.style.shape),S(1),T("ngIf","Star"===e.style.shape),S(1),T("ngIf","Circle"===e.style.shape),S(1),T("ngIf","Concentric Circles"===e.style.points),S(1),T("ngIf","Dots"===e.style.points),S(1),T("ngIf","Horizontal Points"===e.style.points))},dependencies:[dn,en],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});class Ea{constructor(){this.MartianChessComponent=Fo,this.MartianChessPawnComponent=Ea,this.horizontalDotsRadius=Fo.SPACE_SIZE/15}static getTriangle(){return Fo.getRegularPolygon(3,Ea.TRIANGLE_Y_OFFSET)}static yOffsetForVerticalCentering(){const e=Fo.getRegularPolygonCoords(3).map(u=>u.y);return(e.reduce((u,h)=>Math.min(u,h))+(100-e.reduce((u,h)=>Math.max(u,h))))/4}getConcreteTriangleYOffset(){return"Polygon"===this.style.shape?Ea.TRIANGLE_Y_OFFSET:0}}function bht(n,t){if(1&n&&(F(),Q(0,"text",8)),2&n){const e=v();j2("id","height_",e.coord.x,"_",e.coord.y,"_",e.coord.z,""),T("innerHTML",e.coord.z,X8)}}function Oht(n,t){if(1&n&&(F(),Q(0,"polyline",9)),2&n){const e=v();T("ngClass",e.pieceClasses),D("points",e.getUpperHorizontalLine())}}function Nht(n,t){if(1&n&&(F(),b(0,"g"),Q(1,"polyline",10)(2,"polyline",11),O()),2&n){const e=v();S(1),T("ngClass",e.pieceClasses),D("points",e.getMiddleHorizontalLine()),S(1),T("ngClass",e.pieceClasses),D("points",e.getLowerHorizontalLine())}}function Aht(n,t){if(1&n&&(F(),Q(0,"polyline",12)),2&n){const e=v();T("ngClass",e.pieceClasses),D("points",e.getLeftDiagonalLine())}}function Iht(n,t){if(1&n&&(F(),b(0,"g"),Q(1,"polyline",13)(2,"polyline",14),O()),2&n){const e=v();S(1),T("ngClass",e.pieceClasses),D("points",e.getMiddleDiagonalLine()),S(1),T("ngClass",e.pieceClasses),D("points",e.getRighterDiagonalLine())}}function xht(n,t){if(1&n&&(F(),Q(0,"polyline",15)),2&n){const e=v();T("ngClass",e.pieceClasses),D("points",e.getLeftVerticalLine())}}function kht(n,t){if(1&n&&(F(),Q(0,"polyline",16)),2&n){const e=v();T("ngClass",e.pieceClasses),D("points",e.getMiddleVerticalLine())}}function Lht(n,t){if(1&n&&(F(),Q(0,"polyline",17)),2&n){const e=v();T("ngClass",e.pieceClasses),D("points",e.getRighterVerticalLine())}}Ea.FOUR_POINTED_STAR_DIAGONAL=Fo.getNPointedStar(4,45),Ea.TRIANGLE_Y_OFFSET=Ea.yOffsetForVerticalCentering(),Ea.TRIANGLE=Ea.getTriangle(),Ea.\u0275fac=function(t){return new(t||Ea)},Ea.\u0275cmp=gt({type:Ea,selectors:[["","app-martian-chess-pawn",""]],inputs:{mainShapeId:"mainShapeId",pieceClasses:"pieceClasses",style:"style"},attrs:["app-martian-chess-pawn",""],decls:6,vars:6,consts:[["class","base","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["class","base",3,"id","ngClass",4,"ngIf"],["class","base no-fill mid-stroke",4,"ngIf"],["class","base mid-stroke",4,"ngIf"],[3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[1,"base",3,"id","ngClass"],[1,"base","no-fill","mid-stroke"],[1,"base","mid-stroke"],[3,"ngClass"],[1,"base-no-stroke"]],template:function(t,e){1&t&&(x(0,yht,1,3,"polygon",0),x(1,Eht,1,3,"polygon",0),x(2,Mht,1,5,"circle",1),x(3,Sht,1,3,"circle",2),x(4,Pht,1,3,"circle",3),x(5,Tht,2,4,"g",4)),2&t&&(T("ngIf","Polygon"===e.style.shape),S(1),T("ngIf","Star"===e.style.shape),S(1),T("ngIf","Circle"===e.style.shape),S(1),T("ngIf","Concentric Circles"===e.style.points),S(1),T("ngIf","Dots"===e.style.points),S(1),T("ngIf","Horizontal Points"===e.style.points))},dependencies:[dn,en],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});class $9{mustForceStrokeDisplay(){return void 0===this.move||this.pieceClasses.some(t=>"victory-stroke"===t)||this.pieceClasses.some(t=>"last-move-stroke"===t)}get3DIsoSquarePoints(){const t=this.getParallelogramPoints();return this.mapCoordToPoints([t[0],t[1],t[4],t[6],t[5],t[2],t[0]])}getParallelogramPoints(){const t=this.mode.parallelogramHeight*this.mode.horizontalWidthRatio,e=this.mode.parallelogramHeight,r=this.mode.offsetRatio*this.mode.parallelogramHeight,s=this.mode.parallelogramHeight*this.mode.pieceHeightRatio,i=t,c=t-r,u=e,h=-r,p=e;return[new M(0,0),new M(i,0),new M(h,p),new M(c,u),new M(i,0+s),new M(h,p+s),new M(c,u+s)]}mapCoordToPoints(t){return t.map(e=>e.x+" "+e.y).join(" ")}getUpperHorizontalLineCoords(){const t=this.getParallelogramPoints(),e=t[0],r=t[1],i=new Gt(-1*this.mode.offsetRatio*f1.STROKE_WIDTH,f1.STROKE_WIDTH),o=e.getNext(i),c=r.getNext(i);return[e,r,c,o]}getUpperHorizontalLine(){const t=this.getUpperHorizontalLineCoords();return this.mapCoordToPoints(t)}getMiddleHorizontalCoords(){const t=this.getParallelogramPoints(),e=t[2],r=t[3],i=new Gt(-1*this.mode.offsetRatio*f1.STROKE_WIDTH,f1.STROKE_WIDTH);return[e.getNext(i,-1),r.getNext(i,-1),r,e]}getMiddleHorizontalLine(){const t=this.getMiddleHorizontalCoords();return this.mapCoordToPoints(t)}getLowerHorizontalLine(){const t=this.getParallelogramPoints(),e=t[5],r=t[6],s=new Gt(0,f1.STROKE_WIDTH),i=e.getNext(s,-1),o=r.getNext(s,-1);return this.mapCoordToPoints([i,o,r,e])}getLeftDiagonalLine(){const t=this.getParallelogramPoints(),e=t[0],r=t[2],i=new Gt(f1.STROKE_WIDTH,0),o=e.getNext(i,1),c=r.getNext(i,1);return this.mapCoordToPoints([e,o,c,r])}getMiddleDiagonalLine(){const t=this.getParallelogramPoints(),e=t[1],r=t[3],i=new Gt(f1.STROKE_WIDTH,0),o=e.getNext(i,-1),c=r.getNext(i,-1);return this.mapCoordToPoints([o,e,r,c])}getRighterDiagonalLine(){const t=this.getParallelogramPoints(),e=t[4],r=t[6],i=new Gt(0,f1.STROKE_WIDTH),o=e.getNext(i,-1),c=r.getNext(i,-1);return this.mapCoordToPoints([o,e,r,c])}getLeftVerticalLine(){const t=this.getParallelogramPoints(),e=t[2],r=t[5],i=new Gt(f1.STROKE_WIDTH,0),o=e.getNext(i,1),c=r.getNext(i,1);return this.mapCoordToPoints([e,o,c,r])}getMiddleVerticalLine(){const t=this.getParallelogramPoints(),e=t[3],r=t[6],i=new Gt(f1.STROKE_WIDTH,0),o=e.getNext(i,-1),c=r.getNext(i,-1);return this.mapCoordToPoints([o,e,r,c])}getRighterVerticalLine(){const t=this.getParallelogramPoints(),e=t[1],r=t[4],o=new Gt(f1.STROKE_WIDTH,-f1.STROKE_WIDTH/this.mode.offsetRatio),c=e.getNext(o,-1),u=r.getNext(o,-1);return this.mapCoordToPoints([c,e,r,u])}getOtherCoord(){ve(null!=this.move,"Move should be set before calling getOtherCoord");const t=this.move;return t.getZero().equals(this.coord)?t.getOne():t.getZero()}isLeftHalf(){if(null==this.move)return!1;{const t=this.getOtherCoord();return this.coord.x===t.x-1}}isRightHalf(){if(null==this.move)return!1;{const t=this.getOtherCoord();return this.coord.x===t.x+1}}isTopHalf(){if(null==this.move)return!1;{const t=this.getOtherCoord();return this.coord.y===t.y-1}}isBottomHalf(){if(null==this.move)return!1;{const t=this.getOtherCoord();return this.coord.y===t.y+1}}}$9.STROKE_OFFSET=f1.STROKE_WIDTH/2,$9.\u0275fac=function(t){return new(t||$9)},$9.\u0275cmp=gt({type:$9,selectors:[["","mgp-trexo-half-piece",""]],inputs:{coord:"coord",move:"move",pieceClasses:"pieceClasses",mode:"mode",mustDisplayHeight:"mustDisplayHeight"},attrs:["mgp-trexo-half-piece",""],decls:9,vars:13,consts:[[3,"id","ngClass"],["x","50","y","66","class","text-big text-center",3,"id","innerHTML",4,"ngIf"],["id","line_0_to_1","class","base manual-stroke",3,"ngClass",4,"ngIf"],[4,"ngIf"],["id","line_0_to_2","class","base manual-stroke",3,"ngClass",4,"ngIf"],["id","line_2_to_5","class","base manual-stroke",3,"ngClass",4,"ngIf"],["id","line_3_to_6","class","base manual-stroke",3,"ngClass",4,"ngIf"],["id","line_1_to_4","class","base manual-stroke",3,"ngClass",4,"ngIf"],["x","50","y","66",1,"text-big","text-center",3,"id","innerHTML"],["id","line_0_to_1",1,"base","manual-stroke",3,"ngClass"],["id","line_2_to_3",1,"base","manual-stroke",3,"ngClass"],["id","line_5_to_6",1,"base","manual-stroke",3,"ngClass"],["id","line_0_to_2",1,"base","manual-stroke",3,"ngClass"],["id","line_1_to_3",1,"base","manual-stroke",3,"ngClass"],["id","line_4_to_6",1,"base","manual-stroke",3,"ngClass"],["id","line_2_to_5",1,"base","manual-stroke",3,"ngClass"],["id","line_3_to_6",1,"base","manual-stroke",3,"ngClass"],["id","line_1_to_4",1,"base","manual-stroke",3,"ngClass"]],template:function(t,e){1&t&&(F(),Q(0,"polyline",0),x(1,bht,1,4,"text",1),x(2,Oht,1,2,"polyline",2),x(3,Nht,3,4,"g",3),x(4,Aht,1,2,"polyline",4),x(5,Iht,3,4,"g",3),x(6,xht,1,2,"polyline",5),x(7,kht,1,2,"polyline",6),x(8,Lht,1,2,"polyline",7)),2&t&&(j2("id","tile_",e.coord.x,"_",e.coord.y,"_",e.coord.z,""),T("ngClass",e.pieceClasses),D("points",e.get3DIsoSquarePoints()),S(1),T("ngIf",e.mustDisplayHeight),S(1),T("ngIf",!1===e.isBottomHalf()||e.mustForceStrokeDisplay()),S(1),T("ngIf",!1===e.isTopHalf()||e.mustForceStrokeDisplay()),S(1),T("ngIf",!1===e.isRightHalf()||e.mustForceStrokeDisplay()),S(1),T("ngIf",!1===e.isLeftHalf()||e.mustForceStrokeDisplay()),S(1),T("ngIf",e.isBottomHalf()||e.isLeftHalf()||e.mustForceStrokeDisplay()),S(1),T("ngIf",e.isBottomHalf()||e.isRightHalf()||e.mustForceStrokeDisplay()),S(1),T("ngIf",e.isTopHalf()||e.isRightHalf()||e.mustForceStrokeDisplay()))},dependencies:[dn,en],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});const t__firebaseConfig={apiKey:"AIzaSyCgOzdBWz58aFnjCFGzH_KiLMtA8PXaQhc",authDomain:"everyboard-dev.firebaseapp.com",projectId:"everyboard-dev",storageBucket:"everyboard-dev.appspot.com",messagingSenderId:"579824736515"};let ZH=(()=>{class n{constructor(e){this.connectedUserService=e}canActivate(){var e=this;return A(function*(){const r=yield new Promise(s=>{e.userSubscription=e.connectedUserService.subscribeToUser(function(){var i=A(function*(o){return s(yield e.evaluateUserPermission(o))});return function(o){return i.apply(this,arguments)}}())});return e.userSubscription.unsubscribe(),r})()}}return n.\u0275fac=function(e){return new(e||n)(De(Ns))},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),n_=(()=>{class n extends ZH{constructor(e,r){super(e),this.router=r}static evaluateUserPermission(e,r){return A(function*(){return!1===r.isConnected()?e.parseUrl("/login"):!1!==r.verified||e.parseUrl("/verify-account")})()}evaluateUserPermission(e){var r=this;return A(function*(){return n.evaluateUserPermission(r.router,e)})()}}return n.\u0275fac=function(e){return new(e||n)(De(Ns),De(Zn))},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),YH=(()=>{class n{constructor(e,r){this.observedPartService=e,this.router=r,this.observedPartSubscription=P.empty()}canActivate(e){var r=this;return A(function*(){const s=yield new Promise(i=>{const o=r.observedPartService.subscribeToObservedPart(c=>{if(c.isAbsent())return i(!0);const u=c.get();return i(e.params.id===u.id||r.router.parseUrl("/play/"+u.typeGame+"/"+u.id))});r.observedPartSubscription=P.of(o)});return r.observedPartSubscription.get().unsubscribe(),r.observedPartSubscription=P.empty(),s})()}}return n.\u0275fac=function(e){return new(e||n)(De(O2),De(Zn))},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Rht=(()=>{class n extends ZH{constructor(e,r){super(e),this.router=r}evaluateUserPermission(e){var r=this;return A(function*(){return!1===e.isConnected()?r.router.parseUrl("/login"):!e.verified||r.router.parseUrl("/")})()}}return n.\u0275fac=function(e){return new(e||n)(De(Ns),De(Zn))},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),c4e=(()=>{class n extends ZH{constructor(e,r){super(e),this.router=r}evaluateUserPermission(e){var r=this;return A(function*(){return!1===e.isConnected()||r.router.parseUrl("/")})()}}return n.\u0275fac=function(e){return new(e||n)(De(Ns),De(Zn))},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function Dht(n,t){1&n&&(b(0,"p",20),_e(1,21),O())}function zht(n,t){if(1&n){const e=Oe();b(0,"div",7)(1,"p",8),_e(2,9),O(),b(3,"div",10)(4,"p",11),_e(5,12),O(),b(6,"button",13),ee("click",function(){return he(e),le(v().finalizeEmailVerification())}),_e(7,14),O()(),b(8,"div",15)(9,"p",11),_e(10,16),O(),b(11,"button",17),ee("click",function(){return he(e),le(v().sendEmailVerification())}),_e(12,18),O()(),x(13,Dht,2,0,"p",19),O()}if(2&n){const e=v();S(2),k1(e.emailAddress),F1(2),S(11),T("ngIf",e.success)}}function Vht(n,t){if(1&n){const e=Oe();b(0,"div",24)(1,"div",8),_e(2,25),O(),b(3,"form",26)(4,"div",27)(5,"div",28),Q(6,"input",29),O(),b(7,"div",28)(8,"button",30),ee("click",function(){he(e);const s=v(2);return le(s.pickUsername(s.usernameForm.value))}),_e(9,31),O()()()()()}if(2&n){const e=v(2);S(3),T("formGroup",e.usernameForm)}}const Hht=function(){return["/lobby"]};function Fht(n,t){1&n&&(b(0,"div",32),yc(1,33),Q(2,"a",34),Ec(),O()),2&n&&(S(2),T("routerLink",rr(1,Hht)))}function Bht(n,t){if(1&n&&(un(0),x(1,Vht,10,1,"div",22),x(2,Fht,3,2,"div",23),fn()),2&n){const e=v();S(1),T("ngIf",!e.success),S(1),T("ngIf",e.success)}}function $ht(n,t){if(1&n&&(b(0,"div",35)(1,"div",36),Tt(2),O()()),2&n){const e=v();S(2),l1(e.errorMessage)}}let Uht=(()=>{class n{constructor(e,r){this.connectedUserService=e,this.router=r,this.verificationType=null,this.success=!1,this.triedToFinalize=!1,this.usernameForm=new y0({username:new Va})}ngOnInit(){var e=this;return A(function*(){e.userSubscription=e.connectedUserService.subscribeToUser(function(){var r=A(function*(s){e.emailAddress=s.email.get(),s.username.isAbsent()?e.verificationType="enter-username":(e.verificationType="send-email",!0===e.triedToFinalize&&!1===s.verified&&(e.errorMessage=$localize`You have not verified your email! Click on the link in the verification email.`),!0===s.verified&&(yield e.router.navigate(["/lobby"])))});return function(s){return r.apply(this,arguments)}}())})()}pickUsername(e){var r=this;return A(function*(){const s=yield r.connectedUserService.setUsername(e.username);s.isSuccess()?r.success=!0:r.errorMessage=s.getReason()})()}sendEmailVerification(){var e=this;return A(function*(){const r=yield e.connectedUserService.sendEmailVerification();r.isSuccess()?e.success=!0:e.errorMessage=r.getReason()})()}finalizeEmailVerification(){var e=this;return A(function*(){e.triedToFinalize=!0,yield e.connectedUserService.reloadUser(),window.open(window.location.href,"_self")})()}ngOnDestroy(){null!=this.userSubscription&&null!=this.userSubscription.unsubscribe&&this.userSubscription.unsubscribe()}}return n.\u0275fac=function(e){return new(e||n)(J(Ns),J(Zn))},n.\u0275cmp=gt({type:n,selectors:[["app-verify-account"]],decls:7,vars:3,consts:function(){let t,e,r,s,i,o,c,u,h,p,m;return t=$localize`Account verification`,e=$localize`In order to finalize your account, you must click on the link that you should have received on your email address (${"\ufffd0\ufffd"}:INTERPOLATION:). The email could be in your spam folder.`,r=$localize`Once you have verified your email, click on the following button:`,s=$localize`Finalize email verification`,i=$localize`If you have not received the verification email, click on the following button:`,o=$localize`Send verification email again`,c=$localize`The email has been sent`,u=$localize`In order to finalize your account, you must choose a username.`,h=$localize`Username`,p=$localize`Pick username`,m=$localize`Your account has now been finalized, you can go back to the ${"\ufffd#2\ufffd"}:START_LINK:list of games${"\ufffd/#2\ufffd"}:CLOSE_LINK:.`,[[1,"box"],[1,"message","is-info"],[1,"message-header"],t,["class","message-body","id","verificationEmail",4,"ngIf"],[4,"ngIf"],["class","message is-danger",4,"ngIf"],["id","verificationEmail",1,"message-body"],[1,"block"],e,[1,"block","level-left"],[1,"level-item"],r,["id","finalizeVerification",1,"button","is-primary","level-item","is-small",3,"click"],s,[1,"level-left"],i,["id","sendEmail",1,"button","is-warning","level-item","is-small",3,"click"],o,["id","success","class","help is-success",4,"ngIf"],["id","success",1,"help","is-success"],c,["id","askUsername","class","message-body",4,"ngIf"],["id","success","class","message-body",4,"ngIf"],["id","askUsername",1,"message-body"],u,[3,"formGroup"],[1,"field","has-addons"],[1,"control"],["id","username","type","text","placeholder",h,"name","username","required","","formControlName","username",1,"input"],["id","pickUsername",1,"button","is-info",3,"click"],p,["id","success",1,"message-body"],m,[3,"routerLink"],[1,"message","is-danger"],["id","errorMessage",1,"message-body"]]},template:function(e,r){1&e&&(b(0,"div",0)(1,"div",1)(2,"div",2),_e(3,3),O(),x(4,zht,14,2,"div",4),x(5,Bht,3,2,"ng-container",5),O(),x(6,$ht,3,1,"div",6),O()),2&e&&(S(4),T("ngIf","send-email"===r.verificationType),S(1),T("ngIf","enter-username"===r.verificationType),S(1),T("ngIf",r.errorMessage))},dependencies:[en,Nu,Mu,M4,xl,Eu,Tu,Su,ff],encapsulation:2}),n})();function Ght(n,t){1&n&&(b(0,"p",12),_e(1,13),O())}function Wht(n,t){if(1&n&&(b(0,"div",14)(1,"div",15),_e(2,16),O(),b(3,"div",17),Tt(4),O()()),2&n){const e=v();S(4),l1(e.errorMessage.get())}}const qht=function(){return{standalone:!0}};let jht=(()=>{class n{constructor(e){this.connectedUserService=e,this.success=!1,this.errorMessage=P.empty(),this.email=""}resetPassword(){var e=this;return A(function*(){ve(""!==e.email,"No email was entered, but it should not be possible to submit the form then!"),e.errorMessage=P.empty(),e.success=!1;const r=yield e.connectedUserService.sendPasswordResetEmail(e.email);r.isSuccess()?e.success=!0:e.errorMessage=P.of(r.getReason())})()}}return n.\u0275fac=function(e){return new(e||n)(J(Ns))},n.\u0275cmp=gt({type:n,selectors:[["app-reset-password"]],decls:12,vars:6,consts:function(){let t,e,r,s,i,o;return t=$localize`Password reset`,e=$localize`Email`,r=$localize`An email will be sent with instruction to reset your password.`,s=$localize`Reset password`,i=$localize`The email has been sent, please follow the instructions from that email.`,o=$localize`Error`,[[1,"box"],[1,"title"],t,[1,"field"],[1,"control"],["id","email","name","email","placeholder",e,"type","email","autofocus","","required","",1,"input",3,"ngModel","ngModelOptions","ngModelChange"],[1,"help"],r,["id","successMessage","class","help is-success",4,"ngIf"],["id","resetPasswordButton",1,"button","is-primary","is-fullwidth","block",3,"disabled","click"],s,["class","message is-danger is-fullwidth","role","alert",4,"ngIf"],["id","successMessage",1,"help","is-success"],i,["role","alert",1,"message","is-danger","is-fullwidth"],[1,"message-header"],o,["id","errorMessage",1,"message-body"]]},template:function(e,r){1&e&&(b(0,"div",0)(1,"p",1),_e(2,2),O(),b(3,"div",3)(4,"div",4)(5,"input",5),ee("ngModelChange",function(i){return r.email=i}),O(),b(6,"p",6),_e(7,7),O(),x(8,Ght,2,0,"p",8),O()(),b(9,"button",9),ee("click",function(){return r.resetPassword()}),_e(10,10),O(),x(11,Wht,5,1,"div",11),O()),2&e&&(S(5),T("ngModel",r.email)("ngModelOptions",rr(5,qht)),S(3),T("ngIf",r.success),S(1),T("disabled",""===r.email),S(2),T("ngIf",r.errorMessage.isPresent()))},dependencies:[en,M4,xl,Tu,Mp,jH],encapsulation:2}),n})();function Zht(n,t){if(1&n&&(b(0,"option",13),Tt(1),O()),2&n){const e=t.$implicit,r=v();T("value",e.value)("selected",e.value===r.currentTheme),S(1),Z2(" ",e.name," ")}}function Yht(n,t){if(1&n&&(b(0,"option",13),Tt(1),O()),2&n){const e=t.$implicit,r=v();T("value",e.value)("selected",e.value===r.currentLanguage),S(1),Z2(" ",e.name," ")}}let Kht=(()=>{class n{constructor(e,r){this.userSettingsService=e,this.availableLanguages=[{value:"fr",name:"Fran\xe7ais"},{value:"en",name:"English"}],this.availableThemes=[{value:"light",name:$localize`Light`},{value:"dark",name:$localize`Dark`}],this.currentTheme=r.getTheme(),this.currentLanguage=this.userSettingsService.getLanguage()}changeLanguage(e){this.userSettingsService.changeLanguage(e.target.value),this.reload()}changeTheme(e){this.userSettingsService.changeTheme(e.target.value),this.reload()}reload(){window.open(window.location.href,"_self")}}return n.\u0275fac=function(e){return new(e||n)(J(lne),J(NS))},n.\u0275cmp=gt({type:n,selectors:[["app-settings"]],decls:17,vars:2,consts:function(){let t,e,r;return t=$localize`User settings`,e=$localize`Theme`,r=$localize`Language`,[[1,"box"],[1,"title"],t,[1,"field"],["for","theme",1,"label"],e,[1,"control"],[1,"select"],["id","theme",3,"change"],[3,"value","selected",4,"ngFor","ngForOf"],["for","language",1,"label"],r,["id","language",3,"change"],[3,"value","selected"]]},template:function(e,r){1&e&&(b(0,"div",0)(1,"p",1),_e(2,2),O(),b(3,"div",3)(4,"label",4),_e(5,5),O(),b(6,"div",6)(7,"div",7)(8,"select",8),ee("change",function(i){return r.changeTheme(i)}),x(9,Zht,2,3,"option",9),O()()()(),b(10,"div",3)(11,"label",10),_e(12,11),O(),b(13,"div",6)(14,"div",7)(15,"select",12),ee("change",function(i){return r.changeLanguage(i)}),x(16,Yht,2,3,"option",9),O()()()()()),2&e&&(S(9),T("ngForOf",r.availableThemes),S(7),T("ngForOf",r.availableLanguages))},dependencies:[An,Sp,Pp],encapsulation:2}),n})(),Xht=(()=>{class n{constructor(e,r,s,i,o,c){this.route=e,this.router=r,this.connectedUserService=s,this.observedPartService=i,this.messageDisplayer=o,this.gameService=c}ngOnInit(){var e=this;return A(function*(){yield e.createGameAndRedirectOrShowError(e.extractGameFromURL())})()}extractGameFromURL(){return Me.getNonNullable(this.route.snapshot.paramMap.get("compo"))}createGameAndRedirectOrShowError(e){var r=this;return A(function*(){if(ve(r.connectedUserService.user.get().isConnected(),"User must be connected and have a username to reach this page"),!1===r.gameExists(e))return yield r.router.navigate(["/notFound",F9.NO_MATCHING_GAME(e)],{skipLocationChange:!0}),!1;const i=r.observedPartService.canUserCreate();if(i.isSuccess()){const o=yield r.gameService.createPartConfigRoomAndChat(e);return yield r.router.navigate(["/play",e,o]),!0}return r.messageDisplayer.infoMessage(i.getReason()),yield r.router.navigate(["/lobby"]),!1})()}gameExists(e){return P.ofNullable(H9.ALL_GAMES().find(s=>s.urlName===e)).isPresent()}}return n.\u0275fac=function(e){return new(e||n)(J(bo),J(Zn),J(Ns),J(O2),J(Pn),J(OS))},n.\u0275cmp=gt({type:n,selectors:[["app-online-game-creation"]],decls:2,vars:0,consts:function(){let t;return t=$localize`Creating online game, please wait, it should not take long.`,[t]},template:function(e,r){1&e&&(b(0,"p"),_e(1,0),O())},encapsulation:2}),n})();!function D8e(n,t,e){(function ule(n,t,e){"string"!=typeof t&&(e=t,t=n[_t.LocaleId]),t=t.toLowerCase().replace(/_/g,"-"),sf[t]=n,e&&(sf[t][_t.ExtraData]=e)})(n,t,e)}(tpe);const Qht=[{path:"login",component:R7t},{path:"lobby",component:eft,canActivate:[n_]},{path:"settings",component:Kht},{path:"register",component:tht,canActivate:[c4e]},{path:"reset-password",component:jht,canActivate:[c4e]},{path:"notFound/:message",component:s4e},{path:"nextGameLoading",component:sht,canActivate:[n_]},{path:"verify-account",component:Uht,canActivate:[Rht]},{path:"play",component:r4e,canActivate:[n_,YH]},{path:"play/:compo",component:Xht,canActivate:[n_,YH]},{path:"play/:compo/:id",component:g9t,canActivate:[n_,YH]},{path:"local",component:nht},{path:"local/:compo",component:R9t},{path:"tutorial",component:rht},{path:"tutorial/:compo",component:Q9t},{path:"",component:S7t},{path:"demo",component:I7t},{path:"**",component:s4e}];class KH{static app(){return function pSe(n,...t){return{ngModule:dSe,providers:[{provide:NR,useFactory:hSe(n),multi:!0,deps:[Pr,fi,bR,...t]}]}}(()=>gSe(t__firebaseConfig))}static firestore(){return function dbe(n,...t){return{ngModule:hbe,providers:[{provide:Wz,useFactory:lbe(n),multi:!0,deps:[Pr,fi,bR,OR,[new ui,Cte],[new ui,jR],...t]}]}}(()=>{const t=ybe();t.toJSON();return t})}static auth(){return function Xwe(n,...t){return{ngModule:Kwe,providers:[{provide:Gz,useFactory:jwe(n),multi:!0,deps:[Pr,fi,bR,OR,[new ui,jR],...t]}]}}(()=>{const t=ebe();return t})}}let Jht=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=oi({type:n,bootstrap:[H3t]}),n.\u0275inj=jr({providers:[Ns,OS,jz,gm,PS,NS,{provide:C4,useValue:_m.getLocale()}],imports:[KH.app(),KH.firestore(),KH.auth(),UG,N7e,j9e.forRoot(Qht,{useHash:!1}),QW,d7e,Jde,Jze]}),n})();P8(Fo,function(){return[dn,An,en,C6,y6,Ea]},[]),P8(f1,function(){return[dn,An,en,$9]},[]);var edt=oc(7742);function l4e(){(function N0e(){$U=!1})(),r5e().bootstrapModule(Jht).catch(n=>console.error(n))}const u4e=_m.getLocale();"en"!==u4e?fetch("/assets/"+u4e+".json").then(n=>n.ok?n.json():{locale:"en",translations:{}}).then(n=>{(0,edt.XJ)(n.translations),$localize.locale=n.locale,l4e()}).catch(function(n){console.log(n)}):l4e()},2486:function(U9,A5){!function(oc){"use strict";function an(dt,ct){var tn=Object.keys(dt);if(Object.getOwnPropertySymbols){var a1=Object.getOwnPropertySymbols(dt);ct&&(a1=a1.filter(function(Vs){return Object.getOwnPropertyDescriptor(dt,Vs).enumerable})),tn.push.apply(tn,a1)}return tn}function as(dt){for(var ct,tn=1;tn<arguments.length;tn++)ct=arguments[tn]??{},tn%2?an(Object(ct),!0).forEach(function(a1){g8(dt,a1,ct[a1])}):Object.getOwnPropertyDescriptors?Object.defineProperties(dt,Object.getOwnPropertyDescriptors(ct)):an(Object(ct)).forEach(function(a1){Object.defineProperty(dt,a1,Object.getOwnPropertyDescriptor(ct,a1))});return dt}function j3(dt,ct){if(!(dt instanceof ct))throw new TypeError("Cannot call a class as a function")}function Qc(dt,ct){for(var tn,a1=0;a1<ct.length;a1++)(tn=ct[a1]).enumerable=tn.enumerable||!1,tn.configurable=!0,"value"in tn&&(tn.writable=!0),Object.defineProperty(dt,tn.key,tn)}function Z1(dt,ct,tn){return ct&&Qc(dt.prototype,ct),tn&&Qc(dt,tn),dt}function g8(dt,ct,tn){return ct in dt?Object.defineProperty(dt,ct,{value:tn,enumerable:!0,configurable:!0,writable:!0}):dt[ct]=tn,dt}function Jc(){var dt;return null!==(dt=K4)&&void 0!==dt?dt:document}var Z3={duration:2e3,position:"top-right",closeOnClick:!0,opacity:1,single:!1,offsetTop:0,offsetBottom:0,offsetLeft:0,offsetRight:0,extraClasses:""},lo=as({},Z3),ni={},K4=null,G9=function(dt,ct,tn,a1,Vs){return"top-left"===dt?"left:".concat(a1,";top:").concat(ct,";text-align:left;align-items:flex-start;"):"top-right"===dt?"right:".concat(Vs,";top:").concat(ct,";text-align:right;align-items:flex-end;"):"top-center"===dt?"top:".concat(ct,";left:0;right:0;text-align:center;align-items:center;"):"bottom-left"===dt?"left:".concat(a1,";bottom:").concat(tn,";text-align:left;align-items:flex-start;"):"bottom-right"===dt?"right:".concat(Vs,";bottom:").concat(tn,";text-align:right;align-items:flex-end;"):"bottom-center"===dt?"bottom:".concat(tn,";left:0;right:0;text-align:center;align-items:center;"):"center"===dt?"top:0;left:0;right:0;bottom:0;flex-flow:column;justify-content:center;align-items:center;":void 0},m8=function(){function dt(ct){var tn=this;j3(this,dt),this.element=Jc().createElement("div"),this.opacity=ct.opacity,this.type=ct.type,this.animate=ct.animate,this.dismissible=ct.dismissible,this.closeOnClick=ct.closeOnClick,this.message=ct.message,this.duration=ct.duration,this.pauseOnHover=ct.pauseOnHover,this.offsetTop=ct.offsetTop,this.offsetBottom=ct.offsetBottom,this.offsetLeft=ct.offsetLeft,this.offsetRight=ct.offsetRight,this.extraClasses=ct.extraClasses;var a1="width:auto;pointer-events:auto;display:inline-flex;white-space:pre-wrap;opacity:".concat(this.opacity,";"),Vs=["notification",this.extraClasses];if(this.type&&Vs.push(this.type),this.animate&&this.animate.in){var Nn="animate__".concat(this.animate.in),ur=this.animate.speed?"animate__".concat(this.animate.speed):"animate__faster";Vs.push("animate__animated ".concat(Nn," ").concat(ur)),this.onAnimationEnd(function(){return tn.element.classList.remove(Nn)})}if(this.element.className=Vs.join(" "),this.dismissible){var Y3=Jc().createElement("button");Y3.className="delete",Y3.addEventListener("click",function(){tn.destroy()}),this.element.insertAdjacentElement("afterbegin",Y3)}else a1+="padding: 1.25rem 1.5rem";this.closeOnClick&&this.element.addEventListener("click",function(){tn.destroy()}),this.element.setAttribute("style",a1),"string"==typeof this.message?this.element.insertAdjacentHTML("beforeend",this.message):this.element.appendChild(this.message);var I5=new t3(function(){tn.destroy()},this.duration);this.pauseOnHover&&(this.element.addEventListener("mouseover",function(){I5.pause()}),this.element.addEventListener("mouseout",function(){I5.resume()}))}return Z1(dt,[{key:"destroy",value:function(){var ct=this;this.animate&&this.animate.out?(this.element.classList.add("animate__".concat(this.animate.out)),this.onAnimationEnd(function(){ct.removeParent(ct.element.parentNode),ct.element.remove(),delete ni.position})):(this.removeParent(this.element.parentNode),this.element.remove(),delete ni.position)}},{key:"removeParent",value:function(ct){ct&&1>=ct.children.length&&ct.remove()}},{key:"onAnimationEnd",value:function(){var ct=0<arguments.length&&void 0!==arguments[0]?arguments[0]:function(){},tn={animation:"animationend",OAnimation:"oAnimationEnd",MozAnimation:"mozAnimationEnd",WebkitAnimation:"webkitAnimationEnd"};for(var a1 in tn)if(void 0!==this.element.style[a1]){this.element.addEventListener(tn[a1],function(){return ct()});break}}}]),dt}(),t3=function(){function dt(ct,tn){j3(this,dt),this.remaining=tn,this.callback=ct,this.resume()}return Z1(dt,[{key:"pause",value:function(){typeof document>"u"||(window.clearTimeout(this.timer),this.remaining-=new Date-this.start)}},{key:"resume",value:function(){typeof document>"u"||(this.start=new Date,window.clearTimeout(this.timer),this.timer=window.setTimeout(this.callback,this.remaining))}}]),dt}();oc.resetDefaults=function(){lo=as({},Z3)},oc.setDefaults=function(dt){lo=as(as({},Z3),dt)},oc.setDoc=function ac(dt){for(var ct in ni)ni[ct].remove();ni={},K4=dt},oc.toast=function e3(dt){if(!dt.message)throw new Error("message is required");var ct=as(as({},lo),dt),tn=new m8(ct),a1=function pn(dt,ct,tn,a1,Vs,Nn){if(ni.position)return ni.position;var ur=Jc().createElement("div");return ur.setAttribute("style","width:100%;z-index:99999;position:fixed;pointer-events:none;display:flex;flex-direction:column;padding:15px;"+G9(ct,tn,a1,Vs,Nn)),dt.appendChild(ur),ni.position=ur,ur}(ct.appendTo||Jc().body,ct.position||lo.position,ct.offsetTop||lo.offsetTop,ct.offsetBottom||lo.offsetBottom,ct.offsetLeft||lo.offsetLeft,ct.offsetRight||lo.offsetRight);if(ct.single)for(var Vs=a1.lastElementChild;Vs;)a1.removeChild(Vs),Vs=a1.lastElementChild;a1.appendChild(tn.element)},Object.defineProperty(oc,"__esModule",{value:!0})}(A5)},7742:(U9,A5,oc)=>{"use strict";oc.d(A5,{XJ:()=>du,pQ:()=>qC,Q:()=>jb});class gn{constructor(a){this.digits=a}static zero(){return new gn([0])}static one(){return new gn([1])}clone(){return new gn(this.digits.slice())}add(a){const l=this.clone();return l.addToSelf(a),l}addToSelf(a){const l=Math.max(this.digits.length,a.digits.length);let f=0;for(let g=0;g<l;g++){let _=f;g<this.digits.length&&(_+=this.digits[g]),g<a.digits.length&&(_+=a.digits[g]),_>=10?(this.digits[g]=_-10,f=1):(this.digits[g]=_,f=0)}f>0&&(this.digits[l]=1)}toString(){let a="";for(let l=this.digits.length-1;l>=0;l--)a+=this.digits[l];return a}}class L5{constructor(a){this.powerOfTwos=[a]}getValue(){return this.powerOfTwos[0]}multiplyBy(a){const l=gn.zero();return this.multiplyByAndAddTo(a,l),l}multiplyByAndAddTo(a,l){for(let f=0;0!==a;a>>>=1,f++)if(1&a){const g=this.getMultipliedByPowerOfTwo(f);l.addToSelf(g)}}getMultipliedByPowerOfTwo(a){for(let l=this.powerOfTwos.length;l<=a;l++){const f=this.powerOfTwos[l-1];this.powerOfTwos[l]=f.add(f)}return this.powerOfTwos[a]}}class JH{constructor(a){this.base=a,this.exponents=[new L5(gn.one())]}toThePowerOf(a){for(let l=this.exponents.length;l<=a;l++){const f=this.exponents[l-1].multiplyBy(this.base);this.exponents[l]=new L5(f)}return this.exponents[a]}}function l_(d){const a=function F2(d){let a=[];for(let l=0;l<d.length;l++){let f=d.charCodeAt(l);if(f>=55296&&f<=56319&&d.length>l+1){const g=d.charCodeAt(l+1);g>=56320&&g<=57343&&(l++,f=(f-55296<<10)+g-56320+65536)}f<=127?a.push(f):f<=2047?a.push(f>>6&31|192,63&f|128):f<=65535?a.push(f>>12|224,f>>6&63|128,63&f|128):f<=2097151&&a.push(f>>18&7|240,f>>12&63|128,f>>6&63|128,63&f|128)}return a}(d);let l=aT(a,0),f=aT(a,102072);return 0==l&&(0==f||1==f)&&(l^=319790063,f^=-1801410264),[l,f]}function aT(d,a){let g,l=2654435769,f=2654435769;const _=d.length;for(g=0;g+12<=_;g+=12){l=Xi(l,M6(d,g,qr.Little)),f=Xi(f,M6(d,g+4,qr.Little));const y=cT(l,f,a=Xi(a,M6(d,g+8,qr.Little)));l=y[0],f=y[1],a=y[2]}return l=Xi(l,M6(d,g,qr.Little)),f=Xi(f,M6(d,g+4,qr.Little)),a=Xi(a,_),cT(l,f,a=Xi(a,M6(d,g+8,qr.Little)<<8))[2]}function cT(d,a,l){return d=ri(d,a),d=ri(d,l),d^=l>>>13,a=ri(a,l),a=ri(a,d),a^=d<<8,l=ri(l,d),l=ri(l,a),l^=a>>>13,d=ri(d,a),d=ri(d,l),d^=l>>>12,a=ri(a,l),a=ri(a,d),a^=d<<16,l=ri(l,d),l=ri(l,a),l^=a>>>5,d=ri(d,a),d=ri(d,l),d^=l>>>3,a=ri(a,l),a=ri(a,d),a^=d<<10,l=ri(l,d),l=ri(l,a),[d,a,l^=a>>>15]}var qr=(()=>((qr=qr||{})[qr.Little=0]="Little",qr[qr.Big=1]="Big",qr))();function Xi(d,a){return lT(d,a)[1]}function lT(d,a){const l=(65535&d)+(65535&a),f=(d>>>16)+(a>>>16)+(l>>>16);return[f>>>16,f<<16|65535&l]}function ri(d,a){const l=(65535&d)-(65535&a);return(d>>16)-(a>>16)+(l>>16)<<16|65535&l}function f_(d,a){return a>=d.length?0:d[a]}function M6(d,a,l){let f=0;if(l===qr.Big)for(let g=0;g<4;g++)f+=f_(d,a+g)<<24-8*g;else for(let g=0;g<4;g++)f+=f_(d,a+g)<<8*g;return f}const K9=new JH(256);function BC(d,a,l,f,g=[]){const _={},y={},N={},L=function $C(d,a){const{text:l,block:f}=ef(d,a);if(void 0===f)return{text:l};{const[g,..._]=f.split("\u241f"),[y,N]=g.split("@@",2);let[L,V]=y.split("|",2);return void 0===V&&(V=L,L=void 0),""===V&&(V=void 0),{text:l,meaning:L,description:V,customId:N,legacyIds:_}}}(d[0],d.raw[0]),V=[L.text],W=[];let se=L.text;for(let Ve=1;Ve<d.length;Ve++){const{messagePart:yt,placeholderName:st=E3(Ve),associatedMessageId:vt}=UC(d[Ve],d.raw[Ve]);se+=`{$${st}}${yt}`,void 0!==a&&(_[st]=a[Ve-1],y[st]=g[Ve-1]),W.push(st),void 0!==vt&&(N[st]=vt),V.push(yt)}const we=L.customId||function u_(d,a=""){let l=l_(d);if(a){const _=l_(a);l=function uT(d,a){const l=d[0],g=a[0],y=lT(d[1],a[1]),N=y[0],L=y[1];return[Xi(Xi(l,g),N),L]}(function nF(d,a){const l=d[0],f=d[1];return[l<<a|f>>>32-a,f<<a|l>>>32-a]}(l,1),_)}return function p_(d,a){const l=K9.toThePowerOf(0).multiplyBy(a);return K9.toThePowerOf(4).multiplyByAndAddTo(d,l),l.toString()}(2147483647&l[0],l[1])}(se,L.meaning||""),He=L.legacyIds?L.legacyIds.filter(Ve=>Ve!==we):[];return{id:we,legacyIds:He,substitutions:_,substitutionLocations:y,text:se,customId:L.customId,meaning:L.meaning||"",description:L.description||"",messageParts:V,messagePartLocations:f,placeholderNames:W,associatedMessageIds:N,location:l}}function UC(d,a){const{text:l,block:f}=ef(d,a);if(void 0===f)return{messagePart:l};{const[g,_]=f.split("@@");return{messagePart:l,placeholderName:g,associatedMessageId:_}}}function ef(d,a){if(":"!==a.charAt(0))return{text:d};{const l=hu(d,a);return{block:d.substring(1,l),text:d.substring(l+1)}}}function E3(d){return 1===d?"PH":"PH_"+(d-1)}function hu(d,a){for(let l=1,f=1;l<d.length;l++,f++)if("\\"===a[f])f++;else if(":"===d[l])return l;throw new Error(`Unterminated $localize metadata block in "${a}".`)}class tf extends Error{constructor(a){super(`No translation found for ${WC(a)}.`),this.parsedMessage=a,this.type="MissingTranslationError"}}function GC(d,a){return Object.defineProperty(d,"raw",{value:a}),d}function WC(d){const a=d.meaning&&` - "${d.meaning}"`,l=d.legacyIds&&d.legacyIds.length>0?` [${d.legacyIds.map(f=>`"${f}"`).join(", ")}]`:"";return`"${d.id}"${l} ("${d.text}"${a})`}function du(d){$localize.translate||($localize.translate=fB),$localize.TRANSLATIONS||($localize.TRANSLATIONS={}),Object.keys(d).forEach(a=>{$localize.TRANSLATIONS[a]=function Kd(d){const a=d.split(/{\$([^}]*)}/),l=[a[0]],f=[];for(let _=1;_<a.length-1;_+=2)f.push(a[_]),l.push(`${a[_+1]}`);const g=l.map(_=>":"===_.charAt(0)?"\\"+_:_);return{text:d,messageParts:GC(l,g),placeholderNames:f}}(d[a])})}function fB(d,a){try{return function Wb(d,a,l){const f=BC(a,l);let g=d[f.id];if(void 0!==f.legacyIds)for(let _=0;_<f.legacyIds.length&&void 0===g;_++)g=d[f.legacyIds[_]];if(void 0===g)throw new tf(f);return[g.messageParts,g.placeholderNames.map(_=>{if(f.substitutions.hasOwnProperty(_))return f.substitutions[_];throw new Error(`There is a placeholder name mismatch with the translation provided for the message ${WC(f)}.\nThe translation contains a placeholder with name ${_}, which does not exist in the message.`)})]}($localize.TRANSLATIONS,d,a)}catch(l){return console.warn(l.message),[d,a]}}const jb=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),qC=function(d,...a){if(qC.translate){const f=qC.translate(d,a);d=f[0],a=f[1]}let l=jC(d[0],d.raw[0]);for(let f=1;f<d.length;f++)l+=a[f-1]+jC(d[f],d.raw[f]);return l};function jC(d,a){return":"===a.charAt(0)?d.substring(hu(d,a)+1):d}}},U9=>{U9(U9.s=583)}]);