(self.webpackChunkeveryboard=self.webpackChunkeveryboard||[]).push([[179],{2824:(qd,D5,lc)=>{"use strict";function cn(n){return"function"==typeof n}function cs(n){const e=n(r=>{Error.call(r),r.stack=(new Error).stack});return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e}const Z3=cs(n=>function(e){n(this),this.message=e?`${e.length} errors occurred during unsubscription:\n${e.map((r,s)=>`${s+1}) ${r.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=e});function Jc(n,t){if(n){const e=n.indexOf(t);0<=e&&n.splice(e,1)}}class q1{constructor(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let t;if(!this.closed){this.closed=!0;const{_parentage:e}=this;if(e)if(this._parentage=null,Array.isArray(e))for(const i of e)i.remove(this);else e.remove(this);const{initialTeardown:r}=this;if(cn(r))try{r()}catch(i){t=i instanceof Z3?i.errors:[i]}const{_finalizers:s}=this;if(s){this._finalizers=null;for(const i of s)try{mn(i)}catch(o){t=t??[],o instanceof Z3?t=[...t,...o.errors]:t.push(o)}}if(t)throw new Z3(t)}}add(t){var e;if(t&&t!==this)if(this.closed)mn(t);else{if(t instanceof q1){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(e=this._finalizers)&&void 0!==e?e:[]).push(t)}}_hasParent(t){const{_parentage:e}=this;return e===t||Array.isArray(e)&&e.includes(t)}_addParent(t){const{_parentage:e}=this;this._parentage=Array.isArray(e)?(e.push(t),e):e?[e,t]:t}_removeParent(t){const{_parentage:e}=this;e===t?this._parentage=null:Array.isArray(e)&&Jc(e,t)}remove(t){const{_finalizers:e}=this;e&&Jc(e,t),t instanceof q1&&t._removeParent(this)}}q1.EMPTY=(()=>{const n=new q1;return n.closed=!0,n})();const y8=q1.EMPTY;function e3(n){return n instanceof q1||n&&"closed"in n&&cn(n.remove)&&cn(n.add)&&cn(n.unsubscribe)}function mn(n){cn(n)?n():n.unsubscribe()}const uc={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},t3={setTimeout(n,t,...e){const{delegate:r}=t3;return r?.setTimeout?r.setTimeout(n,t,...e):setTimeout(n,t,...e)},clearTimeout(n){const{delegate:t}=t3;return(t?.clearTimeout||clearTimeout)(n)},delegate:void 0};function Y3(n){t3.setTimeout(()=>{const{onUnhandledError:t}=uc;if(!t)throw n;t(n)})}function lo(){}const ni=E8("C",void 0,void 0);function E8(n,t,e){return{kind:n,value:t,error:e}}let n3=null;function gt(n){if(uc.useDeprecatedSynchronousErrorHandling){const t=!n3;if(t&&(n3={errorThrown:!1,error:null}),n(),t){const{errorThrown:e,error:r}=n3;if(n3=null,e)throw r}}else n()}class nn extends q1{constructor(t){super(),this.isStopped=!1,t?(this.destination=t,e3(t)&&t.add(this)):this.destination=V5}static create(t,e,r){return new ir(t,e,r)}next(t){this.isStopped?Zd(function jd(n){return E8("N",n,void 0)}(t),this):this._next(t)}error(t){this.isStopped?Zd(function Q4(n){return E8("E",void 0,n)}(t),this):(this.isStopped=!0,this._error(t))}complete(){this.isStopped?Zd(ni,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(t){this.destination.next(t)}_error(t){try{this.destination.error(t)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const o1=Function.prototype.bind;function Vs(n,t){return o1.call(n,t)}class Nn{constructor(t){this.partialObserver=t}next(t){const{partialObserver:e}=this;if(e.next)try{e.next(t)}catch(r){K3(r)}}error(t){const{partialObserver:e}=this;if(e.error)try{e.error(t)}catch(r){K3(r)}else K3(t)}complete(){const{partialObserver:t}=this;if(t.complete)try{t.complete()}catch(e){K3(e)}}}class ir extends nn{constructor(t,e,r){let s;if(super(),cn(t)||!t)s={next:t??void 0,error:e??void 0,complete:r??void 0};else{let i;this&&uc.useDeprecatedNextContext?(i=Object.create(t),i.unsubscribe=()=>this.unsubscribe(),s={next:t.next&&Vs(t.next,i),error:t.error&&Vs(t.error,i),complete:t.complete&&Vs(t.complete,i)}):s=t}this.destination=new Nn(s)}}function K3(n){uc.useDeprecatedSynchronousErrorHandling?function lt(n){uc.useDeprecatedSynchronousErrorHandling&&n3&&(n3.errorThrown=!0,n3.error=n)}(n):Y3(n)}function Zd(n,t){const{onStoppedNotification:e}=uc;e&&t3.setTimeout(()=>e(n,t))}const V5={closed:!0,next:lo,error:function z5(n){throw n},complete:lo},l_="function"==typeof Symbol&&Symbol.observable||"@@observable";function J4(n){return n}function u_(n){return 0===n.length?J4:1===n.length?n[0]:function(e){return n.reduce((r,s)=>s(r),e)}}let Cr=(()=>{class n{constructor(e){e&&(this._subscribe=e)}lift(e){const r=new n;return r.source=this,r.operator=e,r}subscribe(e,r,s){const i=function H5(n){return n&&n instanceof nn||function cT(n){return n&&cn(n.next)&&cn(n.error)&&cn(n.complete)}(n)&&e3(n)}(e)?e:new ir(e,r,s);return gt(()=>{const{operator:o,source:c}=this;i.add(o?o.call(i,c):c?this._subscribe(i):this._trySubscribe(i))}),i}_trySubscribe(e){try{return this._subscribe(e)}catch(r){e.error(r)}}forEach(e,r){return new(r=Yd(r))((s,i)=>{const o=new ir({next:c=>{try{e(c)}catch(u){i(u),o.unsubscribe()}},error:i,complete:s});this.subscribe(o)})}_subscribe(e){var r;return null===(r=this.source)||void 0===r?void 0:r.subscribe(e)}[l_](){return this}pipe(...e){return u_(e)(this)}toPromise(e){return new(e=Yd(e))((r,s)=>{let i;this.subscribe(o=>i=o,o=>s(o),()=>r(i))})}}return n.create=t=>new n(t),n})();function Yd(n){var t;return null!==(t=n??uc.Promise)&&void 0!==t?t:Promise}const sF=cs(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let F2=(()=>{class n extends Cr{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(e){const r=new Kd(this,this);return r.operator=e,r}_throwIfClosed(){if(this.closed)throw new sF}next(e){gt(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const r of this.currentObservers)r.next(e)}})}error(e){gt(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=e;const{observers:r}=this;for(;r.length;)r.shift().error(e)}})}complete(){gt(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:e}=this;for(;e.length;)e.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0}_trySubscribe(e){return this._throwIfClosed(),super._trySubscribe(e)}_subscribe(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)}_innerSubscribe(e){const{hasError:r,isStopped:s,observers:i}=this;return r||s?y8:(this.currentObservers=null,i.push(e),new q1(()=>{this.currentObservers=null,Jc(i,e)}))}_checkFinalizedStatuses(e){const{hasError:r,thrownError:s,isStopped:i}=this;r?e.error(s):i&&e.complete()}asObservable(){const e=new Cr;return e.source=this,e}}return n.create=(t,e)=>new Kd(t,e),n})();class Kd extends F2{constructor(t,e){super(),this.destination=t,this.source=e}next(t){var e,r;null===(r=null===(e=this.destination)||void 0===e?void 0:e.next)||void 0===r||r.call(e,t)}error(t){var e,r;null===(r=null===(e=this.destination)||void 0===e?void 0:e.error)||void 0===r||r.call(e,t)}complete(){var t,e;null===(e=null===(t=this.destination)||void 0===t?void 0:t.complete)||void 0===e||e.call(t)}_subscribe(t){var e,r;return null!==(r=null===(e=this.source)||void 0===e?void 0:e.subscribe(t))&&void 0!==r?r:y8}}function f_(n){return cn(n?.lift)}function fr(n){return t=>{if(f_(t))return t.lift(function(e){try{return n(e,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function ls(n,t,e,r,s){return new lT(n,t,e,r,s)}class lT extends nn{constructor(t,e,r,s,i,o){super(t),this.onFinalize=i,this.shouldUnsubscribe=o,this._next=e?function(c){try{e(c)}catch(u){t.error(u)}}:super._next,this._error=s?function(c){try{s(c)}catch(u){t.error(u)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(c){t.error(c)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:e}=this;super.unsubscribe(),!e&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}}}function _n(n,t){return fr((e,r)=>{let s=0;e.subscribe(ls(r,i=>{r.next(n.call(t,i,s++))}))})}function B5(n,t){var e={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(e[r]=n[r]);if(null!=n&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(r=Object.getOwnPropertySymbols(n);s<r.length;s++)t.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(e[r[s]]=n[r[s]])}return e}function Zr(n){return this instanceof Zr?(this.v=n,this):new Zr(n)}function Ki(n,t,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s,r=e.apply(n,t||[]),i=[];return s={},o("next"),o("throw"),o("return"),s[Symbol.asyncIterator]=function(){return this},s;function o(y){r[y]&&(s[y]=function(b){return new Promise(function(k,$){i.push([y,b,k,$])>1||c(y,b)})})}function c(y,b){try{!function u(y){y.value instanceof Zr?Promise.resolve(y.value.v).then(d,g):m(i[0][2],y)}(r[y](b))}catch(k){m(i[0][3],k)}}function d(y){c("next",y)}function g(y){c("throw",y)}function m(y,b){y(b),i.shift(),i.length&&c(i[0][0],i[0][1])}}function mT(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,t=n[Symbol.asyncIterator];return t?t.call(n):(n=function p_(n){var t="function"==typeof Symbol&&Symbol.iterator,e=t&&n[t],r=0;if(e)return e.call(n);if(n&&"number"==typeof n.length)return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(n),e={},r("next"),r("throw"),r("return"),e[Symbol.asyncIterator]=function(){return this},e);function r(i){e[i]=n[i]&&function(o){return new Promise(function(c,u){!function s(i,o,c,u){Promise.resolve(u).then(function(d){i({value:d,done:c})},o)}(c,u,(o=n[i](o)).done,o.value)})}}}const v_=n=>n&&"number"==typeof n.length&&"function"!=typeof n;function C_(n){return cn(n?.then)}function Jd(n){return cn(n[l_])}function y_(n){return Symbol.asyncIterator&&cn(n?.[Symbol.asyncIterator])}function fc(n){return new TypeError(`You provided ${null!==n&&"object"==typeof n?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const A1=function M8(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function dc(n){return cn(n?.[A1])}function Sa(n){return Ki(this,arguments,function*(){const e=n.getReader();try{for(;;){const{value:r,done:s}=yield Zr(e.read());if(s)return yield Zr(void 0);yield yield Zr(r)}}finally{e.releaseLock()}})}function E_(n){return cn(n?.getReader)}function uo(n){if(n instanceof Cr)return n;if(null!=n){if(Jd(n))return function el(n){return new Cr(t=>{const e=n[l_]();if(cn(e.subscribe))return e.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(n);if(v_(n))return function Xi(n){return new Cr(t=>{for(let e=0;e<n.length&&!t.closed;e++)t.next(n[e]);t.complete()})}(n);if(C_(n))return function M_(n){return new Cr(t=>{n.then(e=>{t.closed||(t.next(e),t.complete())},e=>t.error(e)).then(null,Y3)})}(n);if(y_(n))return tl(n);if(dc(n))return function _T(n){return new Cr(t=>{for(const e of n)if(t.next(e),t.closed)return;t.complete()})}(n);if(E_(n))return function eh(n){return tl(Sa(n))}(n)}throw fc(n)}function tl(n){return new Cr(t=>{(function vT(n,t){var e,r,s,i;return function dT(n,t,e,r){return new(e||(e=Promise))(function(i,o){function c(g){try{d(r.next(g))}catch(m){o(m)}}function u(g){try{d(r.throw(g))}catch(m){o(m)}}function d(g){g.done?i(g.value):function s(i){return i instanceof e?i:new e(function(o){o(i)})}(g.value).then(c,u)}d((r=r.apply(n,t||[])).next())})}(this,void 0,void 0,function*(){try{for(e=mT(n);!(r=yield e.next()).done;)if(t.next(r.value),t.closed)return}catch(o){s={error:o}}finally{try{r&&!r.done&&(i=e.return)&&(yield i.call(e))}finally{if(s)throw s.error}}t.complete()})})(n,t).catch(e=>t.error(e))})}function Hs(n,t,e,r=0,s=!1){const i=t.schedule(function(){e(),s?n.add(this.schedule(null,r)):this.unsubscribe()},r);if(n.add(i),!s)return i}function He(n,t,e=1/0){return cn(t)?He((r,s)=>_n((i,o)=>t(r,i,s,o))(uo(n(r,s))),e):("number"==typeof t&&(e=t),fr((r,s)=>function Go(n,t,e,r,s,i,o,c){const u=[];let d=0,g=0,m=!1;const y=()=>{m&&!u.length&&!d&&t.complete()},b=$=>d<r?k($):u.push($),k=$=>{i&&t.next($),d++;let K=!1;uo(e($,g++)).subscribe(ls(t,oe=>{s?.(oe),i?b(oe):t.next(oe)},()=>{K=!0},void 0,()=>{if(K)try{for(d--;u.length&&d<r;){const oe=u.shift();o?Hs(t,o,()=>k(oe)):k(oe)}y()}catch(oe){t.error(oe)}}))};return n.subscribe(ls(t,b,()=>{m=!0,y()})),()=>{c?.()}}(r,s,n,e)))}function nl(n=1/0){return He(J4,n)}const hc=new Cr(n=>n.complete());function rl(n){return n[n.length-1]}function en(n){return cn(rl(n))?n.pop():void 0}function X3(n){return function O6(n){return n&&cn(n.schedule)}(rl(n))?n.pop():void 0}function sl(n,t=0){return fr((e,r)=>{e.subscribe(ls(r,s=>Hs(r,n,()=>r.next(s),t),()=>Hs(r,n,()=>r.complete(),t),s=>Hs(r,n,()=>r.error(s),t)))})}function pc(n,t=0){return fr((e,r)=>{r.add(n.schedule(()=>e.subscribe(r),t))})}function G5(n,t){if(!n)throw new Error("Iterable cannot be null");return new Cr(e=>{Hs(e,t,()=>{const r=n[Symbol.asyncIterator]();Hs(e,t,()=>{r.next().then(s=>{s.done?e.complete():e.next(s.value)})},0,!0)})})}function us(n,t){return t?function S8(n,t){if(null!=n){if(Jd(n))return function U5(n,t){return uo(n).pipe(pc(t),sl(t))}(n,t);if(v_(n))return function qo(n,t){return new Cr(e=>{let r=0;return t.schedule(function(){r===n.length?e.complete():(e.next(n[r++]),e.closed||this.schedule())})})}(n,t);if(C_(n))return function A6(n,t){return uo(n).pipe(pc(t),sl(t))}(n,t);if(y_(n))return G5(n,t);if(dc(n))return function th(n,t){return new Cr(e=>{let r;return Hs(e,t,()=>{r=n[A1](),Hs(e,t,()=>{let s,i;try{({value:s,done:i}=r.next())}catch(o){return void e.error(o)}i?e.complete():e.next(s)},0,!0)}),()=>cn(r?.return)&&r.return()})}(n,t);if(E_(n))return function N6(n,t){return G5(Sa(n),t)}(n,t)}throw fc(n)}(n,t):uo(n)}function W5(n,t,...e){if(!0===t)return void n();if(!1===t)return;const r=new ir({next:()=>{r.unsubscribe(),n()}});return uo(t(...e)).subscribe(r)}function M1(n){for(let t in n)if(n[t]===M1)return t;throw Error("Could not find renamed property on target object.")}function nh(n,t){for(const e in t)t.hasOwnProperty(e)&&!n.hasOwnProperty(e)&&(n[e]=t[e])}function j1(n){if("string"==typeof n)return n;if(Array.isArray(n))return"["+n.map(j1).join(", ")+"]";if(null==n)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;const t=n.toString();if(null==t)return""+t;const e=t.indexOf("\n");return-1===e?t:t.substring(0,e)}function P8(n,t){return null==n||""===n?null===t?"":t:null==t||""===t?n:n+" "+t}const P_=M1({__forward_ref__:M1});function S1(n){return n.__forward_ref__=S1,n.toString=function(){return j1(this())},n}function rn(n){return I6(n)?n():n}function I6(n){return"function"==typeof n&&n.hasOwnProperty(P_)&&n.__forward_ref__===S1}class Ie extends Error{constructor(t,e){super(function r3(n,t){return`NG0${Math.abs(n)}${t?": "+t.trim():""}`}(t,e)),this.code=t}}function sn(n){return"string"==typeof n?n:null==n?"":String(n)}function k6(n,t){throw new Ie(-201,!1)}function P1(n,t,e,r){throw new Error(`ASSERTION ERROR: ${n}`+(null==r?"":` [Expected=> ${e} ${r} ${t} <=Actual]`))}function rt(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function Yr(n){return{providers:n.providers||[],imports:n.imports||[]}}function kn(n){return O_(n,L6)||O_(n,oh)}function O_(n,t){return n.hasOwnProperty(t)?n[t]:null}function b8(n){return n&&(n.hasOwnProperty(Ee)||n.hasOwnProperty(ah))?n[Ee]:null}const L6=M1({\u0275prov:M1}),Ee=M1({\u0275inj:M1}),oh=M1({ngInjectableDef:M1}),ah=M1({ngInjectorDef:M1});var Zt=(()=>((Zt=Zt||{})[Zt.Default=0]="Default",Zt[Zt.Host=1]="Host",Zt[Zt.Self=2]="Self",Zt[Zt.SkipSelf=4]="SkipSelf",Zt[Zt.Optional=8]="Optional",Zt))();let ch;function jo(n){const t=ch;return ch=n,t}function lh(n,t,e){const r=kn(n);return r&&"root"==r.providedIn?void 0===r.value?r.value=r.factory():r.value:e&Zt.Optional?null:void 0!==t?t:void k6(j1(n))}function e4(n){return{toString:n}.toString()}var U2=(()=>((U2=U2||{})[U2.OnPush=0]="OnPush",U2[U2.Default=1]="Default",U2))(),V1=(()=>{return(n=V1||(V1={}))[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",V1;var n})();const K1=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),Y={},C1=[],Y5=M1({\u0275cmp:M1}),uh=M1({\u0275dir:M1}),fh=M1({\u0275pipe:M1}),O8=M1({\u0275mod:M1}),s3=M1({\u0275fac:M1}),i3=M1({__NG_ELEMENT_ID__:M1});let PT=0;function dt(n){return e4(()=>{const e=!0===n.standalone,r={},s={type:n.type,providersResolver:null,decls:n.decls,vars:n.vars,factory:null,template:n.template||null,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:r,inputs:null,outputs:null,exportAs:n.exportAs||null,onPush:n.changeDetection===U2.OnPush,directiveDefs:null,pipeDefs:null,standalone:e,dependencies:e&&n.dependencies||null,getStandaloneInjector:null,selectors:n.selectors||C1,viewQuery:n.viewQuery||null,features:n.features||null,data:n.data||{},encapsulation:n.encapsulation||V1.Emulated,id:"c"+PT++,styles:n.styles||C1,_:null,setInput:null,schemas:n.schemas||null,tView:null},i=n.dependencies,o=n.features;return s.inputs=hh(n.inputs,r),s.outputs=hh(n.outputs),o&&o.forEach(c=>c(s)),s.directiveDefs=i?()=>("function"==typeof i?i():i).map(dh).filter(K5):null,s.pipeDefs=i?()=>("function"==typeof i?i():i).map(Ji).filter(K5):null,s})}function A8(n,t,e){const r=n.\u0275cmp;r.directiveDefs=()=>("function"==typeof t?t():t).map(dh),r.pipeDefs=()=>("function"==typeof e?e():e).map(Ji)}function dh(n){return T1(n)||Qi(n)}function K5(n){return null!==n}function oi(n){return e4(()=>({type:n.type,bootstrap:n.bootstrap||C1,declarations:n.declarations||C1,imports:n.imports||C1,exports:n.exports||C1,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function hh(n,t){if(null==n)return Y;const e={};for(const r in n)if(n.hasOwnProperty(r)){let s=n[r],i=s;Array.isArray(s)&&(i=s[1],s=s[0]),e[s]=r,t&&(t[s]=i)}return e}const Gt=dt;function ai(n){return{type:n.type,name:n.name,factory:null,pure:!1!==n.pure,standalone:!0===n.standalone,onDestroy:n.type.prototype.ngOnDestroy||null}}function T1(n){return n[Y5]||null}function Qi(n){return n[uh]||null}function Ji(n){return n[fh]||null}function ho(n,t){const e=n[O8]||null;if(!e&&!0===t)throw new Error(`Type ${j1(n)} does not have '\u0275mod' property.`);return e}function po(n){return Array.isArray(n)&&"object"==typeof n[1]}function yr(n){return Array.isArray(n)&&!0===n[1]}function W2(n){return 0!=(8&n.flags)}function Xo(n){return 2==(2&n.flags)}function Qo(n){return 1==(1&n.flags)}function Ms(n){return null!==n.template}function H6(n){return 0!=(256&n[2])}function Ta(n,t){return n.hasOwnProperty(s3)?n[s3]:null}class bT{constructor(t,e,r){this.previousValue=t,this.currentValue=e,this.firstChange=r}isFirstChange(){return this.firstChange}}function n2(){return L_}function L_(n){return n.type.prototype.ngOnChanges&&(n.setInput=R_),OT}function OT(){const n=n7(this),t=n?.current;if(t){const e=n.previous;if(e===Y)n.previous=t;else for(let r in t)e[r]=t[r];n.current=null,this.ngOnChanges(t)}}function R_(n,t,e,r){const s=n7(n)||function AT(n,t){return n[D_]=t}(n,{previous:Y,current:null}),i=s.current||(s.current={}),o=s.previous,c=this.declaredInputs[e],u=o[c];i[c]=new bT(u&&u.currentValue,t,o===Y),n[r]=t}n2.ngInherit=!0;const D_="__ngSimpleChanges__";function n7(n){return n[D_]||null}function Er(n){for(;Array.isArray(n);)n=n[0];return n}function x8(n,t){return Er(t[n])}function r2(n,t){return Er(t[n.index])}function vh(n,t){return n.data[t]}function al(n,t){return n[t]}function bi(n,t){const e=t[n];return po(e)?e:e[0]}function $6(n){return 64==(64&n[2])}function a3(n,t){return null==t?null:n[t]}function F_(n){n[18]=0}function Ch(n,t){n[5]+=t;let e=n,r=n[3];for(;null!==r&&(1===t&&1===e[5]||-1===t&&0===e[5]);)r[5]+=t,e=r,r=r[3]}const ln={lFrame:wh(null),bindingsEnabled:!0};function yh(){return ln.bindingsEnabled}function ze(){return ln.lFrame.lView}function Jn(){return ln.lFrame.tView}function ue(n){return ln.lFrame.contextLView=n,n[8]}function ce(n){return ln.lFrame.contextLView=null,n}function Rr(){let n=B_();for(;null!==n&&64===n.type;)n=n.parent;return n}function B_(){return ln.lFrame.currentTNode}function cl(){const n=ln.lFrame,t=n.currentTNode;return n.isParent?t:t.parent}function gc(n,t){const e=ln.lFrame;e.currentTNode=n,e.isParent=t}function Kr(){return ln.lFrame.isParent}function Eh(){ln.lFrame.isParent=!1}function Oi(){const n=ln.lFrame;let t=n.bindingRootIndex;return-1===t&&(t=n.bindingRootIndex=n.tView.bindingStartIndex),t}function mc(){return ln.lFrame.bindingIndex}function G6(){return ln.lFrame.bindingIndex++}function ea(n){const t=ln.lFrame,e=t.bindingIndex;return t.bindingIndex=t.bindingIndex+n,e}function s2(n){ln.lFrame.inI18n=n}function HT(n,t){const e=ln.lFrame;e.bindingIndex=e.bindingRootIndex=n,c3(t)}function c3(n){ln.lFrame.currentDirectiveIndex=n}function Ph(){return ln.lFrame.currentQueryIndex}function L8(n){ln.lFrame.currentQueryIndex=n}function U_(n){const t=n[1];return 2===t.type?t.declTNode:1===t.type?n[6]:null}function c7(n,t,e){if(e&Zt.SkipSelf){let s=t,i=n;for(;!(s=s.parent,null!==s||e&Zt.Host||(s=U_(i),null===s||(i=i[15],10&s.type))););if(null===s)return!1;t=s,n=i}const r=ln.lFrame=Th();return r.currentTNode=t,r.lView=n,!0}function ll(n){const t=Th(),e=n[1];ln.lFrame=t,t.currentTNode=e.firstChild,t.lView=n,t.tView=e,t.contextLView=n,t.bindingIndex=e.bindingStartIndex,t.inI18n=!1}function Th(){const n=ln.lFrame,t=null===n?null:n.child;return null===t?wh(n):t}function wh(n){const t={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=t),t}function G_(){const n=ln.lFrame;return ln.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const R8=G_;function ul(){const n=G_();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function o2(){return ln.lFrame.selectedIndex}function l3(n){ln.lFrame.selectedIndex=n}function w1(){const n=ln.lFrame;return vh(n.tView,n.selectedIndex)}function F(){ln.lFrame.currentNamespace="svg"}function d3(n,t){for(let e=t.directiveStart,r=t.directiveEnd;e<r;e++){const i=n.data[e].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:c,ngAfterViewInit:u,ngAfterViewChecked:d,ngOnDestroy:g}=i;o&&(n.contentHooks||(n.contentHooks=[])).push(-e,o),c&&((n.contentHooks||(n.contentHooks=[])).push(e,c),(n.contentCheckHooks||(n.contentCheckHooks=[])).push(e,c)),u&&(n.viewHooks||(n.viewHooks=[])).push(-e,u),d&&((n.viewHooks||(n.viewHooks=[])).push(e,d),(n.viewCheckHooks||(n.viewCheckHooks=[])).push(e,d)),null!=g&&(n.destroyHooks||(n.destroyHooks=[])).push(e,g)}}function wa(n,t,e){W_(n,t,3,e)}function z8(n,t,e,r){(3&n[2])===e&&W_(n,t,e,r)}function V8(n,t){let e=n[2];(3&e)===t&&(e&=2047,e+=1,n[2]=e)}function W_(n,t,e,r){const i=r??-1,o=t.length-1;let c=0;for(let u=void 0!==r?65535&n[18]:0;u<o;u++)if("number"==typeof t[u+1]){if(c=t[u],null!=r&&c>=r)break}else t[u]<0&&(n[18]+=65536),(c<i||-1==i)&&(q_(n,e,t,u),n[18]=(4294901760&n[18])+u+2),u++}function q_(n,t,e,r){const s=e[r]<0,i=e[r+1],c=n[s?-e[r]:e[r]];if(s){if(n[2]>>11<n[18]>>16&&(3&n[2])===t){n[2]+=2048;try{i.call(c)}finally{}}}else try{i.call(c)}finally{}}class H8{constructor(t,e,r){this.factory=t,this.resolving=!1,this.canSeeViewProviders=e,this.injectImpl=r}}function _c(n,t,e){let r=0;for(;r<e.length;){const s=e[r];if("number"==typeof s){if(0!==s)break;r++;const i=e[r++],o=e[r++],c=e[r++];n.setAttribute(t,o,c,i)}else{const i=s,o=e[++r];Y_(i)?n.setProperty(t,i,o):n.setAttribute(t,i,o),r++}}return r}function Z_(n){return 3===n||4===n||6===n}function Y_(n){return 64===n.charCodeAt(0)}function j6(n,t){if(null!==t&&0!==t.length)if(null===n||0===n.length)n=t.slice();else{let e=-1;for(let r=0;r<t.length;r++){const s=t[r];"number"==typeof s?e=s:0===e||Oh(n,e,s,null,-1===e||2===e?t[++r]:null)}}return n}function Oh(n,t,e,r,s){let i=0,o=n.length;if(-1===t)o=-1;else for(;i<n.length;){const c=n[i++];if("number"==typeof c){if(c===t){o=-1;break}if(c>t){o=i-1;break}}}for(;i<n.length;){const c=n[i];if("number"==typeof c)break;if(c===e){if(null===r)return void(null!==s&&(n[i+1]=s));if(r===n[i+1])return void(n[i+2]=s)}i++,null!==r&&i++,null!==s&&i++}-1!==o&&(n.splice(o,0,t),i=o+1),n.splice(i++,0,e),null!==r&&n.splice(i++,0,r),null!==s&&n.splice(i++,0,s)}function Ah(n){return-1!==n}function dl(n){return 32767&n}function hl(n,t){let e=function K_(n){return n>>16}(n),r=t;for(;e>0;)r=r[15],e--;return r}let u7=!0;function o4(n){const t=u7;return u7=n,t}let X_=0;const h3={};function f7(n,t){const e=B8(n,t);if(-1!==e)return e;const r=t[1];r.firstCreatePass&&(n.injectorIndex=t.length,Ih(r.data,n),Ih(t,null),Ih(r.blueprint,null));const s=Oa(n,t),i=n.injectorIndex;if(Ah(s)){const o=dl(s),c=hl(s,t),u=c[1].data;for(let d=0;d<8;d++)t[i+d]=c[o+d]|u[o+d]}return t[i+8]=s,i}function Ih(n,t){n.push(0,0,0,0,0,0,0,0,t)}function B8(n,t){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===t[n.injectorIndex+8]?-1:n.injectorIndex}function Oa(n,t){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let e=0,r=null,s=t;for(;null!==s;){if(r=ev(s),null===r)return-1;if(e++,s=s[15],-1!==r.injectorIndex)return r.injectorIndex|e<<16}return-1}function Z6(n,t,e){!function MF(n,t,e){let r;"string"==typeof e?r=e.charCodeAt(0)||0:e.hasOwnProperty(i3)&&(r=e[i3]),null==r&&(r=e[i3]=X_++);const s=255&r;t.data[n+(s>>5)]|=1<<s}(n,t,e)}function xh(n,t,e){if(e&Zt.Optional||void 0!==n)return n;k6()}function kh(n,t,e,r){if(e&Zt.Optional&&void 0===r&&(r=null),0==(e&(Zt.Self|Zt.Host))){const s=n[9],i=jo(void 0);try{return s?s.get(t,r,e&Zt.Optional):lh(t,r,e&Zt.Optional)}finally{jo(i)}}return xh(r,0,e)}function d7(n,t,e,r=Zt.Default,s){if(null!==n){if(1024&t[2]){const o=function h7(n,t,e,r,s){let i=n,o=t;for(;null!==i&&null!==o&&1024&o[2]&&!(256&o[2]);){const c=a4(i,o,e,r|Zt.Self,h3);if(c!==h3)return c;let u=i.parent;if(!u){const d=o[21];if(d){const g=d.get(e,h3,r);if(g!==h3)return g}u=ev(o),o=o[15]}i=u}return s}(n,t,e,r,h3);if(o!==h3)return o}const i=a4(n,t,e,r,h3);if(i!==h3)return i}return kh(t,e,r,s)}function a4(n,t,e,r,s){const i=function $8(n){if("string"==typeof n)return n.charCodeAt(0)||0;const t=n.hasOwnProperty(i3)?n[i3]:void 0;return"number"==typeof t?t>=0?255&t:K6:t}(e);if("function"==typeof i){if(!c7(t,n,r))return r&Zt.Host?xh(s,0,r):kh(t,e,r,s);try{const o=i(r);if(null!=o||r&Zt.Optional)return o;k6()}finally{R8()}}else if("number"==typeof i){let o=null,c=B8(n,t),u=-1,d=r&Zt.Host?t[16][6]:null;for((-1===c||r&Zt.SkipSelf)&&(u=-1===c?Oa(n,t):t[c+8],-1!==u&&J_(r,!1)?(o=t[1],c=dl(u),t=hl(u,t)):c=-1);-1!==c;){const g=t[1];if(Q_(i,c,g.data)){const m=Lh(c,t,e,o,r,d);if(m!==h3)return m}u=t[c+8],-1!==u&&J_(r,t[1].data[c+8]===d)&&Q_(i,c,t)?(o=g,c=dl(u),t=hl(u,t)):c=-1}}return s}function Lh(n,t,e,r,s,i){const o=t[1],c=o.data[n+8],g=Xr(c,o,e,null==r?Xo(c)&&u7:r!=o&&0!=(3&c.type),s&Zt.Host&&i===c);return null!==g?Fs(t,o,g,c):h3}function Xr(n,t,e,r,s){const i=n.providerIndexes,o=t.data,c=1048575&i,u=n.directiveStart,g=i>>20,y=s?c+g:n.directiveEnd;for(let b=r?c:c+g;b<y;b++){const k=o[b];if(b<u&&e===k||b>=u&&k.type===e)return b}if(s){const b=o[u];if(b&&Ms(b)&&b.type===e)return u}return null}function Fs(n,t,e,r){let s=n[e];const i=t.data;if(function FT(n){return n instanceof H8}(s)){const o=s;o.resolving&&function T8(n,t){const e=t?`. Dependency path: ${t.join(" > ")} > ${n}`:"";throw new Ie(-200,`Circular dependency in DI detected for ${n}${e}`)}(function Dt(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():sn(n)}(i[e]));const c=o4(o.canSeeViewProviders);o.resolving=!0;const u=o.injectImpl?jo(o.injectImpl):null;c7(n,r,Zt.Default);try{s=n[e]=o.factory(void 0,i,n,r),t.firstCreatePass&&e>=r.directiveStart&&function q6(n,t,e){const{ngOnChanges:r,ngOnInit:s,ngDoCheck:i}=t.type.prototype;if(r){const o=L_(t);(e.preOrderHooks||(e.preOrderHooks=[])).push(n,o),(e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(n,o)}s&&(e.preOrderHooks||(e.preOrderHooks=[])).push(0-n,s),i&&((e.preOrderHooks||(e.preOrderHooks=[])).push(n,i),(e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(n,i))}(e,i[e],t)}finally{null!==u&&jo(u),o4(c),o.resolving=!1,R8()}}return s}function Q_(n,t,e){return!!(e[t+(n>>5)]&1<<n)}function J_(n,t){return!(n&Zt.Self||n&Zt.Host&&t)}class Y6{constructor(t,e){this._tNode=t,this._lView=e}get(t,e,r){return d7(this._tNode,this._lView,t,r,e)}}function K6(){return new Y6(Rr(),ze())}function Mr(n){return e4(()=>{const t=n.prototype.constructor,e=t[s3]||Rh(t),r=Object.prototype;let s=Object.getPrototypeOf(n.prototype).constructor;for(;s&&s!==r;){const i=s[s3]||Rh(s);if(i&&i!==e)return i;s=Object.getPrototypeOf(s)}return i=>new i})}function Rh(n){return I6(n)?()=>{const t=Rh(rn(n));return t&&t()}:Ta(n)}function ev(n){const t=n[1],e=t.type;return 2===e?t.declTNode:1===e?n[6]:null}function U8(n){return function $T(n,t){if("class"===t)return n.classes;if("style"===t)return n.styles;const e=n.attrs;if(e){const r=e.length;let s=0;for(;s<r;){const i=e[s];if(Z_(i))break;if(0===i)s+=2;else if("number"==typeof i)for(s++;s<r&&"string"==typeof e[s];)s++;else{if(i===t)return e[s+1];s+=2}}}return null}(Rr(),n)}const X6="__parameters__";function ml(n,t,e){return e4(()=>{const r=function p7(n){return function(...e){if(n){const r=n(...e);for(const s in r)this[s]=r[s]}}}(t);function s(...i){if(this instanceof s)return r.apply(this,i),this;const o=new s(...i);return c.annotation=o,c;function c(u,d,g){const m=u.hasOwnProperty(X6)?u[X6]:Object.defineProperty(u,X6,{value:[]})[X6];for(;m.length<=g;)m.push(null);return(m[g]=m[g]||[]).push(o),u}}return e&&(s.prototype=Object.create(e.prototype)),s.prototype.ngMetadataName=n,s.annotationCls=s,s})}class Lt{constructor(t,e){this._desc=t,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof e?this.__NG_ELEMENT_ID__=e:void 0!==e&&(this.\u0275prov=rt({token:this,providedIn:e.providedIn||"root",factory:e.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}function a2(n,t){void 0===t&&(t=n);for(let e=0;e<n.length;e++){let r=n[e];Array.isArray(r)?(t===n&&(t=n.slice(0,e)),a2(r,t)):t!==n&&t.push(r)}return t}function Aa(n,t){n.forEach(e=>Array.isArray(e)?Aa(e,t):t(e))}function p3(n,t,e){t>=n.length?n.push(e):n.splice(t,0,e)}function e0(n,t){return t>=n.length-1?n.pop():n.splice(t,1)[0]}function _l(n,t){const e=[];for(let r=0;r<n;r++)e.push(t);return e}function c2(n,t,e){let r=l2(n,t);return r>=0?n[1|r]=e:(r=~r,function zh(n,t,e,r){let s=n.length;if(s==t)n.push(e,r);else if(1===s)n.push(r,n[0]),n[0]=e;else{for(s--,n.push(n[s-1],n[s]);s>t;)n[s]=n[s-2],s--;n[t]=e,n[t+1]=r}}(n,r,t,e)),r}function ci(n,t){const e=l2(n,t);if(e>=0)return n[1|e]}function l2(n,t){return function _7(n,t,e){let r=0,s=n.length>>e;for(;s!==r;){const i=r+(s-r>>1),o=n[i<<e];if(t===o)return i<<e;o>t?s=i:r=i+1}return~(s<<e)}(n,t,1)}const j8={},Z8="__NG_DI_FLAG__",li="ngTempTokenPath",qT=/\n/gm,y7="__source";let Y8;function n0(n){const t=Y8;return Y8=n,t}function jT(n,t=Zt.Default){if(void 0===Y8)throw new Ie(-203,!1);return null===Y8?lh(n,void 0,t):Y8.get(n,t&Zt.Optional?null:void 0,t)}function Ve(n,t=Zt.Default){return(function fF(){return ch}()||jT)(rn(n),t)}function Dr(n,t=Zt.Default){return"number"!=typeof t&&(t=0|(t.optional&&8)|(t.host&&1)|(t.self&&2)|(t.skipSelf&&4)),Ve(n,t)}function $h(n){const t=[];for(let e=0;e<n.length;e++){const r=rn(n[e]);if(Array.isArray(r)){if(0===r.length)throw new Ie(900,!1);let s,i=Zt.Default;for(let o=0;o<r.length;o++){const c=r[o],u=av(c);"number"==typeof u?-1===u?s=c.token:i|=u:s=c}t.push(Ve(s,i))}else t.push(Ve(r))}return t}function vl(n,t){return n[Z8]=t,n.prototype[Z8]=t,n}function av(n){return n[Z8]}const ui=vl(ml("Optional"),8),K8=vl(ml("SkipSelf"),4);let Kh,M7,S7;function lv(){return void 0!==Kh?Kh:typeof document<"u"?document:void 0}function u4(n){return function Xh(){if(void 0===M7&&(M7=null,K1.trustedTypes))try{M7=K1.trustedTypes.createPolicy("angular",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return M7}()?.createHTML(n)||n}function P7(n){return function Qh(){if(void 0===S7&&(S7=null,K1.trustedTypes))try{S7=K1.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return S7}()?.createHTML(n)||n}class f4{constructor(t){this.changingThisBreaksApplicationSecurity=t}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}class iw extends f4{getTypeName(){return"HTML"}}class ow extends f4{getTypeName(){return"Style"}}class aw extends f4{getTypeName(){return"Script"}}class fv extends f4{getTypeName(){return"URL"}}class dv extends f4{getTypeName(){return"ResourceURL"}}function mo(n){return n instanceof f4?n.changingThisBreaksApplicationSecurity:n}function _o(n,t){const e=function hv(n){return n instanceof f4&&n.getTypeName()||null}(n);if(null!=e&&e!==t){if("ResourceURL"===e&&"URL"===t)return!0;throw new Error(`Required a safe ${t}, got a ${e} (see https://g.co/ng/security#xss)`)}return e===t}function mv(n){const t=new Rt(n);return function fw(){try{return!!(new window.DOMParser).parseFromString(u4(""),"text/html")}catch{return!1}}()?new _v(t):t}class _v{constructor(t){this.inertDocumentHelper=t}getInertBodyElement(t){t="<body><remove></remove>"+t;try{const e=(new window.DOMParser).parseFromString(u4(t),"text/html").body;return null===e?this.inertDocumentHelper.getInertBodyElement(t):(e.removeChild(e.firstChild),e)}catch{return null}}}class Rt{constructor(t){if(this.defaultDoc=t,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),null==this.inertDocument.body){const e=this.inertDocument.createElement("html");this.inertDocument.appendChild(e);const r=this.inertDocument.createElement("body");e.appendChild(r)}}getInertBodyElement(t){const e=this.inertDocument.createElement("template");if("content"in e)return e.innerHTML=u4(t),e;const r=this.inertDocument.createElement("body");return r.innerHTML=u4(t),this.defaultDoc.documentMode&&this.stripCustomNsAttrs(r),r}stripCustomNsAttrs(t){const e=t.attributes;for(let s=e.length-1;0<s;s--){const o=e.item(s).name;("xmlns:ns1"===o||0===o.indexOf("ns1:"))&&t.removeAttribute(o)}let r=t.firstChild;for(;r;)r.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(r),r=r.nextSibling}}const vv=/^(?:(?:https?|mailto|data|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi;function sa(n){return(n=String(n)).match(vv)?n:"unsafe:"+n}function Cc(n){const t={};for(const e of n.split(","))t[e]=!0;return t}function J8(...n){const t={};for(const e of n)for(const r in e)e.hasOwnProperty(r)&&(t[r]=!0);return t}const Cv=Cc("area,br,col,hr,img,wbr"),yv=Cc("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),T7=Cc("rp,rt"),eu=J8(Cv,J8(yv,Cc("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),J8(T7,Cc("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),J8(T7,yv)),w7=Cc("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),b7=J8(w7,Cc("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),Cc("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),dw=Cc("script,style,template");class hw{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(t){let e=t.firstChild,r=!0;for(;e;)if(e.nodeType===Node.ELEMENT_NODE?r=this.startElement(e):e.nodeType===Node.TEXT_NODE?this.chars(e.nodeValue):this.sanitizedSomething=!0,r&&e.firstChild)e=e.firstChild;else for(;e;){e.nodeType===Node.ELEMENT_NODE&&this.endElement(e);let s=this.checkClobberedElement(e,e.nextSibling);if(s){e=s;break}e=this.checkClobberedElement(e,e.parentNode)}return this.buf.join("")}startElement(t){const e=t.nodeName.toLowerCase();if(!eu.hasOwnProperty(e))return this.sanitizedSomething=!0,!dw.hasOwnProperty(e);this.buf.push("<"),this.buf.push(e);const r=t.attributes;for(let s=0;s<r.length;s++){const i=r.item(s),o=i.name,c=o.toLowerCase();if(!b7.hasOwnProperty(c)){this.sanitizedSomething=!0;continue}let u=i.value;w7[c]&&(u=sa(u)),this.buf.push(" ",o,'="',Mv(u),'"')}return this.buf.push(">"),!0}endElement(t){const e=t.nodeName.toLowerCase();eu.hasOwnProperty(e)&&!Cv.hasOwnProperty(e)&&(this.buf.push("</"),this.buf.push(e),this.buf.push(">"))}chars(t){this.buf.push(Mv(t))}checkClobberedElement(t,e){if(e&&(t.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${t.outerHTML}`);return e}}const pw=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,gw=/([^\#-~ |!])/g;function Mv(n){return n.replace(/&/g,"&amp;").replace(pw,function(t){return"&#"+(1024*(t.charCodeAt(0)-55296)+(t.charCodeAt(1)-56320)+65536)+";"}).replace(gw,function(t){return"&#"+t.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let O7;function e9(n,t){let e=null;try{O7=O7||mv(n);let r=t?String(t):"";e=O7.getInertBodyElement(r);let s=5,i=r;do{if(0===s)throw new Error("Failed to sanitize html because the input is unstable");s--,r=i,i=e.innerHTML,e=O7.getInertBodyElement(r)}while(r!==i);return u4((new hw).sanitizeChildren(vo(e)||e))}finally{if(e){const r=vo(e)||e;for(;r.firstChild;)r.removeChild(r.firstChild)}}}function vo(n){return"content"in n&&function tu(n){return n.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===n.nodeName}(n)?n.content:null}var X1=(()=>((X1=X1||{})[X1.NONE=0]="NONE",X1[X1.HTML=1]="HTML",X1[X1.STYLE=2]="STYLE",X1[X1.SCRIPT=3]="SCRIPT",X1[X1.URL=4]="URL",X1[X1.RESOURCE_URL=5]="RESOURCE_URL",X1))();function nu(n){const t=a0();return t?P7(t.sanitize(X1.HTML,n)||""):_o(n,"HTML")?P7(mo(n)):e9(lv(),sn(n))}function g3(n){const t=a0();return t?t.sanitize(X1.URL,n)||"":_o(n,"URL")?mo(n):sa(sn(n))}function a0(){const n=ze();return n&&n[12]}const ou=new Lt("ENVIRONMENT_INITIALIZER"),Pv=new Lt("INJECTOR",-1),Tv=new Lt("INJECTOR_DEF_TYPES");class wv{get(t,e=j8){if(e===j8){const r=new Error(`NullInjectorError: No provider for ${j1(t)}!`);throw r.name="NullInjectorError",r}return e}}function au(...n){return{\u0275providers:n9(0,n)}}function n9(n,...t){const e=[],r=new Set;let s;return Aa(t,i=>{const o=i;m3(o,e,[],r)&&(s||(s=[]),s.push(o))}),void 0!==s&&bv(s,e),e}function bv(n,t){for(let e=0;e<n.length;e++){const{providers:s}=n[e];Aa(s,i=>{t.push(i)})}}function m3(n,t,e,r){if(!(n=rn(n)))return!1;let s=null,i=b8(n);const o=!i&&T1(n);if(i||o){if(o&&!o.standalone)return!1;s=n}else{const u=n.ngModule;if(i=b8(u),!i)return!1;s=u}const c=r.has(s);if(o){if(c)return!1;if(r.add(s),o.dependencies){const u="function"==typeof o.dependencies?o.dependencies():o.dependencies;for(const d of u)m3(d,t,e,r)}}else{if(!i)return!1;{if(null!=i.imports&&!c){let d;r.add(s);try{Aa(i.imports,g=>{m3(g,t,e,r)&&(d||(d=[]),d.push(g))})}finally{}void 0!==d&&bv(d,t)}if(!c){const d=Ta(s)||(()=>new s);t.push({provide:s,useFactory:d,deps:C1},{provide:Tv,useValue:s,multi:!0},{provide:ou,useValue:()=>Ve(s),multi:!0})}const u=i.providers;null==u||c||Aa(u,g=>{t.push(g)})}}return s!==n&&void 0!==n.providers}const mw=M1({provide:String,useValue:M1});function u2(n){return null!==n&&"object"==typeof n&&mw in n}function El(n){return"function"==typeof n}const s9=new Lt("Set Injector scope."),N7={},Nv={};let i9;function d4(){return void 0===i9&&(i9=new wv),i9}class Ia{}class I7 extends Ia{constructor(t,e,r,s){super(),this.parent=e,this.source=r,this.scopes=s,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,k7(t,o=>this.processProvider(o)),this.records.set(Pv,Ml(void 0,this)),s.has("environment")&&this.records.set(Ia,Ml(void 0,this));const i=this.records.get(s9);null!=i&&"string"==typeof i.value&&this.scopes.add(i.value),this.injectorDefTypes=new Set(this.get(Tv.multi,C1,Zt.Self))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const t of this._ngOnDestroyHooks)t.ngOnDestroy();for(const t of this._onDestroyHooks)t()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),this._onDestroyHooks.length=0}}onDestroy(t){this._onDestroyHooks.push(t)}runInContext(t){this.assertNotDestroyed();const e=n0(this),r=jo(void 0);try{return t()}finally{n0(e),jo(r)}}get(t,e=j8,r=Zt.Default){this.assertNotDestroyed();const s=n0(this),i=jo(void 0);try{if(!(r&Zt.SkipSelf)){let c=this.records.get(t);if(void 0===c){const u=function kv(n){return"function"==typeof n||"object"==typeof n&&n instanceof Lt}(t)&&kn(t);c=u&&this.injectableDefInScope(u)?Ml(Co(t),N7):null,this.records.set(t,c)}if(null!=c)return this.hydrate(t,c)}return(r&Zt.Self?d4():this.parent).get(t,e=r&Zt.Optional&&e===j8?null:e)}catch(o){if("NullInjectorError"===o.name){if((o[li]=o[li]||[]).unshift(j1(t)),s)throw o;return function ZT(n,t,e,r){const s=n[li];throw t[y7]&&s.unshift(t[y7]),n.message=function jn(n,t,e,r=null){n=n&&"\n"===n.charAt(0)&&"\u0275"==n.charAt(1)?n.slice(2):n;let s=j1(t);if(Array.isArray(t))s=t.map(j1).join(" -> ");else if("object"==typeof t){let i=[];for(let o in t)if(t.hasOwnProperty(o)){let c=t[o];i.push(o+":"+("string"==typeof c?JSON.stringify(c):j1(c)))}s=`{${i.join(", ")}}`}return`${e}${r?"("+r+")":""}[${s}]: ${n.replace(qT,"\n  ")}`}("\n"+n.message,s,e,r),n.ngTokenPath=s,n[li]=null,n}(o,t,"R3InjectorError",this.source)}throw o}finally{jo(i),n0(s)}}resolveInjectorInitializers(){const t=n0(this),e=jo(void 0);try{const r=this.get(ou.multi,C1,Zt.Self);for(const s of r)s()}finally{n0(t),jo(e)}}toString(){const t=[],e=this.records;for(const r of e.keys())t.push(j1(r));return`R3Injector[${t.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Ie(205,!1)}processProvider(t){let e=El(t=rn(t))?t:rn(t&&t.provide);const r=function vw(n){return u2(n)?Ml(void 0,n.useValue):Ml(x7(n),N7)}(t);if(El(t)||!0!==t.multi)this.records.get(e);else{let s=this.records.get(e);s||(s=Ml(void 0,N7,!0),s.factory=()=>$h(s.multi),this.records.set(e,s)),e=t,s.multi.push(t)}this.records.set(e,r)}hydrate(t,e){return e.value===N7&&(e.value=Nv,e.value=e.factory()),"object"==typeof e.value&&e.value&&function xv(n){return null!==n&&"object"==typeof n&&"function"==typeof n.ngOnDestroy}(e.value)&&this._ngOnDestroyHooks.add(e.value),e.value}injectableDefInScope(t){if(!t.providedIn)return!1;const e=rn(t.providedIn);return"string"==typeof e?"any"===e||this.scopes.has(e):this.injectorDefTypes.has(e)}}function Co(n){const t=kn(n),e=null!==t?t.factory:Ta(n);if(null!==e)return e;if(n instanceof Lt)throw new Ie(204,!1);if(n instanceof Function)return function cu(n){const t=n.length;if(t>0)throw _l(t,"?"),new Ie(204,!1);const e=function A_(n){const t=n&&(n[L6]||n[oh]);if(t){const e=function ii(n){if(n.hasOwnProperty("name"))return n.name;const t=(""+n).match(/^function\s*([^\s(]+)/);return null===t?"":t[1]}(n);return console.warn(`DEPRECATED: DI is instantiating a token "${e}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${e}" class.`),t}return null}(n);return null!==e?()=>e.factory(n):()=>new n}(n);throw new Ie(204,!1)}function x7(n,t,e){let r;if(El(n)){const s=rn(n);return Ta(s)||Co(s)}if(u2(n))r=()=>rn(n.useValue);else if(function Av(n){return!(!n||!n.useFactory)}(n))r=()=>n.useFactory(...$h(n.deps||[]));else if(function r9(n){return!(!n||!n.useExisting)}(n))r=()=>Ve(rn(n.useExisting));else{const s=rn(n&&(n.useClass||n.provide));if(!function Iv(n){return!!n.deps}(n))return Ta(s)||Co(s);r=()=>new s(...$h(n.deps))}return r}function Ml(n,t,e=!1){return{factory:n,value:t,multi:e?[]:void 0}}function Cw(n){return!!n.\u0275providers}function k7(n,t){for(const e of n)Array.isArray(e)?k7(e,t):Cw(e)?k7(e.\u0275providers,t):t(e)}class Lv{}class Sw{resolveComponentFactory(t){throw function Ew(n){const t=Error(`No component factory found for ${j1(n)}. Did you add it to @NgModule.entryComponents?`);return t.ngComponent=n,t}(t)}}let xa=(()=>{class n{}return n.NULL=new Sw,n})();function LF(){return c0(Rr(),ze())}function c0(n,t){return new f2(r2(n,t))}let f2=(()=>{class n{constructor(e){this.nativeElement=e}}return n.__NG_ELEMENT_ID__=LF,n})();function L7(n){return n instanceof f2?n.nativeElement:n}class l0{}let yo=(()=>{class n{}return n.__NG_ELEMENT_ID__=()=>function Pw(){const n=ze(),e=bi(Rr().index,n);return(po(e)?e:n)[11]}(),n})(),RF=(()=>{class n{}return n.\u0275prov=rt({token:n,providedIn:"root",factory:()=>null}),n})();class u0{constructor(t){this.full=t,this.major=t.split(".")[0],this.minor=t.split(".")[1],this.patch=t.split(".").slice(2).join(".")}}const Rv=new u0("14.2.10"),c9={};function u9(n){return n.ngOriginalError}class f0{constructor(){this._console=console}handleError(t){const e=this._findOriginalError(t);this._console.error("ERROR",t),e&&this._console.error("ORIGINAL ERROR",e)}_findOriginalError(t){let e=t&&u9(t);for(;e&&u9(e);)e=u9(e);return e||null}}const kw=/^>|^->|<!--|-->|--!>|<!-$/g,Lw=/(<|>)/;const f9=new Map;let Hv=0;const V7="__ngContext__";function xi(n,t){po(t)?(n[V7]=t[20],function Fw(n){f9.set(n[20],n)}(t)):n[V7]=t}function ka(n){return n instanceof Function?n():n}var h2=(()=>((h2=h2||{})[h2.Important=1]="Important",h2[h2.DashCase=2]="DashCase",h2))();let p9;function g9(n,t){return p9(n,t)}function fu(n){const t=n[3];return yr(t)?t[3]:t}function m9(n){return yc(n[13])}function _9(n){return yc(n[4])}function yc(n){for(;null!==n&&!yr(n);)n=n[4];return n}function Sl(n,t,e,r,s){if(null!=r){let i,o=!1;yr(r)?i=r:po(r)&&(o=!0,r=r[0]);const c=Er(r);0===n&&null!==e?null==s?eC(t,e,c):C3(t,e,c,s||null,!0):1===n&&null!==e?C3(t,e,c,s||null,!0):2===n?oC(t,c,o):3===n&&t.destroyNode(c),null!=i&&function ab(n,t,e,r,s){const i=e[7];i!==Er(e)&&Sl(t,n,r,i,s);for(let c=10;c<e.length;c++){const u=e[c];p0(u[1],u,n,t,r,i)}}(t,n,i,e,s)}}function v9(n,t){return n.createText(t)}function Kv(n,t,e){n.setValue(t,e)}function Qw(n,t){return n.createComment(function Vv(n){return n.replace(kw,t=>t.replace(Lw,"\u200b$1\u200b"))}(t))}function C9(n,t,e){return n.createElement(t,e)}function Xv(n,t){const e=n[9],r=e.indexOf(t),s=t[3];512&t[2]&&(t[2]&=-513,Ch(s,-1)),e.splice(r,1)}function y9(n,t){if(n.length<=10)return;const e=10+t,r=n[e];if(r){const s=r[17];null!==s&&s!==n&&Xv(s,r),t>0&&(n[e-1][4]=r[4]);const i=e0(n,10+t);!function Jw(n,t){p0(n,t,t[11],2,null,null),t[0]=null,t[6]=null}(r[1],r);const o=i[19];null!==o&&o.detachView(i[1]),r[3]=null,r[4]=null,r[2]&=-65}return r}function Qv(n,t){if(!(128&t[2])){const e=t[11];e.destroyNode&&p0(n,t,e,3,null,null),function nb(n){let t=n[13];if(!t)return E9(n[1],n);for(;t;){let e=null;if(po(t))e=t[13];else{const r=t[10];r&&(e=r)}if(!e){for(;t&&!t[4]&&t!==n;)po(t)&&E9(t[1],t),t=t[3];null===t&&(t=n),po(t)&&E9(t[1],t),e=t&&t[4]}t=e}}(t)}}function E9(n,t){if(!(128&t[2])){t[2]&=-65,t[2]|=128,function ib(n,t){let e;if(null!=n&&null!=(e=n.destroyHooks))for(let r=0;r<e.length;r+=2){const s=t[e[r]];if(!(s instanceof H8)){const i=e[r+1];if(Array.isArray(i))for(let o=0;o<i.length;o+=2){const c=s[i[o]],u=i[o+1];try{u.call(c)}finally{}}else try{i.call(s)}finally{}}}}(n,t),function M9(n,t){const e=n.cleanup,r=t[7];let s=-1;if(null!==e)for(let i=0;i<e.length-1;i+=2)if("string"==typeof e[i]){const o=e[i+1],c="function"==typeof o?o(t):Er(t[o]),u=r[s=e[i+2]],d=e[i+3];"boolean"==typeof d?c.removeEventListener(e[i],u,d):d>=0?r[s=d]():r[s=-d].unsubscribe(),i+=2}else{const o=r[s=e[i+1]];e[i].call(o)}if(null!==r){for(let i=s+1;i<r.length;i++)(0,r[i])();t[7]=null}}(n,t),1===t[1].type&&t[11].destroy();const e=t[17];if(null!==e&&yr(t[3])){e!==t[3]&&Xv(e,t);const r=t[19];null!==r&&r.detachView(n)}!function Bw(n){f9.delete(n[20])}(t)}}function Jv(n,t,e){return S9(n,t.parent,e)}function S9(n,t,e){let r=t;for(;null!==r&&40&r.type;)r=(t=r).parent;if(null===r)return e[0];if(2&r.flags){const s=n.data[r.directiveStart].encapsulation;if(s===V1.None||s===V1.Emulated)return null}return r2(r,e)}function C3(n,t,e,r,s){n.insertBefore(t,e,r,s)}function eC(n,t,e){n.appendChild(t,e)}function y3(n,t,e,r,s){null!==r?C3(n,t,e,r,s):eC(n,t,e)}function d0(n,t){return n.parentNode(t)}function rC(n,t,e){return iC(n,t,e)}function sC(n,t,e){return 40&n.type?r2(n,e):null}let P9,iC=sC;function F7(n,t){iC=n,P9=t}function du(n,t,e,r){const s=Jv(n,r,t),i=t[11],c=rC(r.parent||t[6],r,t);if(null!=s)if(Array.isArray(e))for(let u=0;u<e.length;u++)y3(i,s,e[u],c,!1);else y3(i,s,e,c,!1);void 0!==P9&&P9(i,r,t,e,s)}function hu(n,t){if(null!==t){const e=t.type;if(3&e)return r2(t,n);if(4&e)return h0(-1,n[t.index]);if(8&e){const r=t.child;if(null!==r)return hu(n,r);{const s=n[t.index];return yr(s)?h0(-1,s):Er(s)}}if(32&e)return g9(t,n)()||Er(n[t.index]);{const r=Pl(n,t);return null!==r?Array.isArray(r)?r[0]:hu(fu(n[16]),r):hu(n,t.next)}}return null}function Pl(n,t){return null!==t?n[16][6].projection[t.projection]:null}function h0(n,t){const e=10+n+1;if(e<t.length){const r=t[e],s=r[1].firstChild;if(null!==s)return hu(r,s)}return t[7]}function oC(n,t,e){const r=d0(n,t);r&&function tC(n,t,e,r){n.removeChild(t,e,r)}(n,r,t,e)}function T9(n,t,e,r,s,i,o){for(;null!=e;){const c=r[e.index],u=e.type;if(o&&0===t&&(c&&xi(Er(c),r),e.flags|=4),64!=(64&e.flags))if(8&u)T9(n,t,e.child,r,s,i,!1),Sl(t,n,s,c,i);else if(32&u){const d=g9(e,r);let g;for(;g=d();)Sl(t,n,s,g,i);Sl(t,n,s,c,i)}else 16&u?aC(n,t,r,e,s,i):Sl(t,n,s,c,i);e=o?e.projectionNext:e.next}}function p0(n,t,e,r,s,i){T9(e,r,n.firstChild,t,s,i,!1)}function aC(n,t,e,r,s,i){const o=e[16],u=o[6].projection[r.projection];if(Array.isArray(u))for(let d=0;d<u.length;d++)Sl(t,n,s,u[d],i);else T9(n,t,u,o[3],s,i,!0)}function pu(n,t,e){n.setAttribute(t,"style",e)}function B7(n,t,e){""===e?n.removeAttribute(t,"class"):n.setAttribute(t,"class",e)}function lC(n,t,e){let r=n.length;for(;;){const s=n.indexOf(t,e);if(-1===s)return s;if(0===s||n.charCodeAt(s-1)<=32){const i=t.length;if(s+i===r||n.charCodeAt(s+i)<=32)return s}e=s+1}}const uC="ng-template";function w9(n,t,e){let r=0;for(;r<n.length;){let s=n[r++];if(e&&"class"===s){if(s=n[r],-1!==lC(s.toLowerCase(),t,0))return!0}else if(1===s){for(;r<n.length&&"string"==typeof(s=n[r++]);)if(s.toLowerCase()===t)return!0;return!1}}return!1}function gu(n){return 4===n.type&&n.value!==uC}function fC(n,t,e){return t===(4!==n.type||e?n.value:uC)}function cb(n,t,e){let r=4;const s=n.attrs||[],i=function lb(n){for(let t=0;t<n.length;t++)if(Z_(n[t]))return t;return n.length}(s);let o=!1;for(let c=0;c<t.length;c++){const u=t[c];if("number"!=typeof u){if(!o)if(4&r){if(r=2|1&r,""!==u&&!fC(n,u,e)||""===u&&1===t.length){if(La(r))return!1;o=!0}}else{const d=8&r?u:t[++c];if(8&r&&null!==n.attrs){if(!w9(n.attrs,d,e)){if(La(r))return!1;o=!0}continue}const m=dC(8&r?"class":u,s,gu(n),e);if(-1===m){if(La(r))return!1;o=!0;continue}if(""!==d){let y;y=m>i?"":s[m+1].toLowerCase();const b=8&r?y:null;if(b&&-1!==lC(b,d,0)||2&r&&d!==y){if(La(r))return!1;o=!0}}}}else{if(!o&&!La(r)&&!La(u))return!1;if(o&&La(u))continue;o=!1,r=u|1&r}}return La(r)||o}function La(n){return 0==(1&n)}function dC(n,t,e,r){if(null===t)return-1;let s=0;if(r||!e){let i=!1;for(;s<t.length;){const o=t[s];if(o===n)return s;if(3===o||6===o)i=!0;else{if(1===o||2===o){let c=t[++s];for(;"string"==typeof c;)c=t[++s];continue}if(4===o)break;if(0===o){s+=4;continue}}s+=i?1:2}return-1}return function ub(n,t){let e=n.indexOf(4);if(e>-1)for(e++;e<n.length;){const r=n[e];if("number"==typeof r)return-1;if(r===t)return e;e++}return-1}(t,n)}function hC(n,t,e=!1){for(let r=0;r<t.length;r++)if(cb(n,t[r],e))return!0;return!1}function gC(n,t){e:for(let e=0;e<t.length;e++){const r=t[e];if(n.length===r.length){for(let s=0;s<n.length;s++)if(n[s]!==r[s])continue e;return!0}}return!1}function b9(n,t){return n?":not("+t.trim()+")":t}function fb(n){let t=n[0],e=1,r=2,s="",i=!1;for(;e<n.length;){let o=n[e];if("string"==typeof o)if(2&r){const c=n[++e];s+="["+o+(c.length>0?'="'+c+'"':"")+"]"}else 8&r?s+="."+o:4&r&&(s+=" "+o);else""!==s&&!La(o)&&(t+=b9(i,s),s=""),r=o,i=i||!La(r);e++}return""!==s&&(t+=b9(i,s)),t}const hn={};function P(n){_C(Jn(),ze(),o2()+n,!1)}function _C(n,t,e,r){if(!r)if(3==(3&t[2])){const i=n.preOrderCheckHooks;null!==i&&wa(t,i,e)}else{const i=n.preOrderHooks;null!==i&&z8(t,i,0,e)}l3(e)}function I9(n,t=null,e=null,r){const s=yC(n,t,e,r);return s.resolveInjectorInitializers(),s}function yC(n,t=null,e=null,r,s=new Set){const i=[e||C1,au(n)];return r=r||("object"==typeof n?void 0:j1(n)),new I7(i,t||d4(),r||null,s)}let fi=(()=>{class n{static create(e,r){if(Array.isArray(e))return I9({name:""},r,e,"");{const s=e.name??"";return I9({name:s},e.parent,e.providers,s)}}}return n.THROW_IF_NOT_FOUND=j8,n.NULL=new wv,n.\u0275prov=rt({token:n,providedIn:"any",factory:()=>Ve(Pv)}),n.__NG_ELEMENT_ID__=-1,n})();function J(n,t=Zt.Default){const e=ze();return null===e?Ve(n,t):d7(Rr(),e,rn(n),t)}function W7(){throw new Error("invalid")}function q7(n,t){return n<<17|t<<2}function Ra(n){return n>>17&32767}function H9(n){return 2|n}function Ec(n){return(131068&n)>>2}function wl(n,t){return-131069&n|t<<2}function F9(n){return 1|n}function kC(n,t){const e=n.contentQueries;if(null!==e)for(let r=0;r<e.length;r+=2){const s=e[r],i=e[r+1];if(-1!==i){const o=n.data[i];L8(s),o.contentQueries(2,t[i],i)}}}function X7(n,t,e,r,s,i,o,c,u,d,g){const m=t.blueprint.slice();return m[0]=s,m[2]=76|r,(null!==g||n&&1024&n[2])&&(m[2]|=1024),F_(m),m[3]=m[15]=n,m[8]=e,m[10]=o||n&&n[10],m[11]=c||n&&n[11],m[12]=u||n&&n[12]||null,m[9]=d||n&&n[9]||null,m[6]=i,m[20]=function ar(){return Hv++}(),m[21]=g,m[16]=2==t.type?n[16]:m,m}function m0(n,t,e,r,s){let i=n.data[t];if(null===i)i=Q7(n,t,e,r,s),function ta(){return ln.lFrame.inI18n}()&&(i.flags|=64);else if(64&i.type){i.type=e,i.value=r,i.attrs=s;const o=cl();i.injectorIndex=null===o?-1:o.injectorIndex}return gc(i,!0),i}function Q7(n,t,e,r,s){const i=B_(),o=Kr(),u=n.data[t]=function cB(n,t,e,r,s,i){return{type:e,index:r,insertBeforeIndex:null,injectorIndex:t?t.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:s,attrs:i,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:t,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?i:i&&i.parent,e,t,r,s);return null===n.firstChild&&(n.firstChild=u),null!==i&&(o?null==i.child&&null!==u.parent&&(i.child=u):null===i.next&&(i.next=u)),u}function bl(n,t,e,r){if(0===e)return-1;const s=t.length;for(let i=0;i<e;i++)t.push(r),n.blueprint.push(r),n.data.push(null);return s}function J7(n,t,e){ll(t);try{const r=n.viewQuery;null!==r&&Q9(1,r,e);const s=n.template;null!==s&&LC(n,t,s,1,e),n.firstCreatePass&&(n.firstCreatePass=!1),n.staticContentQueries&&kC(n,t),n.staticViewQueries&&Q9(2,n.viewQuery,e);const i=n.components;null!==i&&function zb(n,t){for(let e=0;e<t.length;e++)gB(n,t[e])}(t,i)}catch(r){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),r}finally{t[2]&=-5,ul()}}function ef(n,t,e,r){const s=t[2];if(128!=(128&s)){ll(t);try{F_(t),function $_(n){return ln.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==e&&LC(n,t,e,2,r);const o=3==(3&s);if(o){const d=n.preOrderCheckHooks;null!==d&&wa(t,d,null)}else{const d=n.preOrderHooks;null!==d&&z8(t,d,0,null),V8(t,0)}if(function pB(n){for(let t=m9(n);null!==t;t=_9(t)){if(!t[2])continue;const e=t[9];for(let r=0;r<e.length;r++){const s=e[r],i=s[3];0==(512&s[2])&&Ch(i,1),s[2]|=512}}}(t),function jb(n){for(let t=m9(n);null!==t;t=_9(t))for(let e=10;e<t.length;e++){const r=t[e],s=r[1];$6(r)&&ef(s,r,s.template,r[8])}}(t),null!==n.contentQueries&&kC(n,t),o){const d=n.contentCheckHooks;null!==d&&wa(t,d)}else{const d=n.contentHooks;null!==d&&z8(t,d,1),V8(t,1)}!function j9(n,t){const e=n.hostBindingOpCodes;if(null!==e)try{for(let r=0;r<e.length;r++){const s=e[r];if(s<0)l3(~s);else{const i=s,o=e[++r],c=e[++r];HT(o,i),c(2,t[i])}}}finally{l3(-1)}}(n,t);const c=n.components;null!==c&&function Db(n,t){for(let e=0;e<t.length;e++)Zb(n,t[e])}(t,c);const u=n.viewQuery;if(null!==u&&Q9(2,u,r),o){const d=n.viewCheckHooks;null!==d&&wa(t,d)}else{const d=n.viewHooks;null!==d&&z8(t,d,2),V8(t,2)}!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),t[2]&=-41,512&t[2]&&(t[2]&=-513,Ch(t[3],-1))}finally{ul()}}}function LC(n,t,e,r,s){const i=o2(),o=2&r;try{l3(-1),o&&t.length>22&&_C(n,t,22,!1),e(r,s)}finally{l3(i)}}function RC(n,t,e){if(W2(t)){const s=t.directiveEnd;for(let i=t.directiveStart;i<s;i++){const o=n.data[i];o.contentQueries&&o.contentQueries(1,e[i],i)}}}function Z9(n,t,e){!yh()||(function HC(n,t,e,r){const s=e.directiveStart,i=e.directiveEnd;n.firstCreatePass||f7(e,t),xi(r,t);const o=e.initialInputs;for(let c=s;c<i;c++){const u=n.data[c],d=Ms(u);d&&Wb(t,e,u);const g=Fs(t,n,c,e);xi(g,t),null!==o&&hB(0,c-s,g,u,0,o),d&&(bi(e.index,t)[8]=g)}}(n,t,e,r2(e,t)),128==(128&e.flags)&&function $b(n,t,e){const r=e.directiveStart,s=e.directiveEnd,i=e.index,o=function Sh(){return ln.lFrame.currentDirectiveIndex}();try{l3(i);for(let c=r;c<s;c++){const u=n.data[c],d=t[c];c3(c),(null!==u.hostBindings||0!==u.hostVars||null!==u.hostAttrs)&&Ub(u,d)}}finally{l3(-1),c3(o)}}(n,t,e))}function _0(n,t,e=r2){const r=t.localNames;if(null!==r){let s=t.index+1;for(let i=0;i<r.length;i+=2){const o=r[i+1],c=-1===o?e(t,n):n[o];n[s++]=c}}}function DC(n){const t=n.tView;return null===t||t.incompleteFirstPass?n.tView=zC(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts):t}function zC(n,t,e,r,s,i,o,c,u,d){const g=22+r,m=g+s,y=function Vb(n,t){const e=[];for(let r=0;r<t;r++)e.push(r<n?null:hn);return e}(g,m),b="function"==typeof d?d():d;return y[1]={type:n,blueprint:y,template:e,queries:null,viewQuery:c,declTNode:t,data:y.slice().fill(null,g),bindingStartIndex:g,expandoStartIndex:m,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof i?i():i,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:u,consts:b,incompleteFirstPass:!1}}function Fb(n,t,e,r){const s=qC(t);null===e?s.push(r):(s.push(e),n.firstCreatePass&&jC(n).push(r,s.length-1))}function v0(n,t,e){for(let r in n)if(n.hasOwnProperty(r)){const s=n[r];(e=null===e?{}:e).hasOwnProperty(r)?e[r].push(t,s):e[r]=[t,s]}return e}function tf(n,t){const r=t.directiveEnd,s=n.data,i=t.attrs,o=[];let c=null,u=null;for(let d=t.directiveStart;d<r;d++){const g=s[d],m=g.inputs,y=null===i||gu(t)?null:qb(m,i);o.push(y),c=v0(m,d,c),u=v0(g.outputs,d,u)}null!==c&&(c.hasOwnProperty("class")&&(t.flags|=16),c.hasOwnProperty("style")&&(t.flags|=32)),t.initialInputs=o,t.inputs=c,t.outputs=u}function Eo(n,t,e,r,s,i,o,c){const u=r2(t,e);let g,d=t.inputs;!c&&null!=d&&(g=d[r])?(cf(n,e,g,r,s),Xo(t)&&VC(e,t.index)):3&t.type&&(r=function nf(n){return"class"===n?"className":"for"===n?"htmlFor":"formaction"===n?"formAction":"innerHtml"===n?"innerHTML":"readonly"===n?"readOnly":"tabindex"===n?"tabIndex":n}(r),s=null!=o?o(s,t.value||"",r):s,i.setProperty(u,r,s))}function VC(n,t){const e=bi(t,n);16&e[2]||(e[2]|=32)}function Ol(n,t,e,r){let s=!1;if(yh()){const i=function FC(n,t,e){const r=n.directiveRegistry;let s=null;if(r)for(let i=0;i<r.length;i++){const o=r[i];hC(e,o.selectors,!1)&&(s||(s=[]),Z6(f7(e,t),n,o.type),Ms(o)?(Y9(n,e),s.unshift(o)):s.push(o))}return s}(n,t,e),o=null===r?null:{"":-1};if(null!==i){s=!0,BC(e,n.data.length,i.length);for(let g=0;g<i.length;g++){const m=i[g];m.providersResolver&&m.providersResolver(m)}let c=!1,u=!1,d=bl(n,t,i.length,null);for(let g=0;g<i.length;g++){const m=i[g];e.mergedAttrs=j6(e.mergedAttrs,m.hostAttrs),$C(n,e,t,d,m),dB(d,m,o),null!==m.contentQueries&&(e.flags|=8),(null!==m.hostBindings||null!==m.hostAttrs||0!==m.hostVars)&&(e.flags|=128);const y=m.type.prototype;!c&&(y.ngOnChanges||y.ngOnInit||y.ngDoCheck)&&((n.preOrderHooks||(n.preOrderHooks=[])).push(e.index),c=!0),!u&&(y.ngOnChanges||y.ngDoCheck)&&((n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(e.index),u=!0),d++}tf(n,e)}o&&function Gb(n,t,e){if(t){const r=n.localNames=[];for(let s=0;s<t.length;s+=2){const i=e[t[s+1]];if(null==i)throw new Ie(-301,!1);r.push(t[s],i)}}}(e,r,o)}return e.mergedAttrs=j6(e.mergedAttrs,e.attrs),s}function rf(n,t,e,r,s,i){const o=i.hostBindings;if(o){let c=n.hostBindingOpCodes;null===c&&(c=n.hostBindingOpCodes=[]);const u=~t.index;(function Bb(n){let t=n.length;for(;t>0;){const e=n[--t];if("number"==typeof e&&e<0)return e}return 0})(c)!=u&&c.push(u),c.push(r,s,o)}}function Ub(n,t){null!==n.hostBindings&&n.hostBindings(1,t)}function Y9(n,t){t.flags|=2,(n.components||(n.components=[])).push(t.index)}function dB(n,t,e){if(e){if(t.exportAs)for(let r=0;r<t.exportAs.length;r++)e[t.exportAs[r]]=n;Ms(t)&&(e[""]=n)}}function BC(n,t,e){n.flags|=1,n.directiveStart=t,n.directiveEnd=t+e,n.providerIndexes=t}function $C(n,t,e,r,s){n.data[r]=s;const i=s.factory||(s.factory=Ta(s.type)),o=new H8(i,Ms(s),J);n.blueprint[r]=o,e[r]=o,rf(n,t,0,r,bl(n,e,s.hostVars,hn),s)}function Wb(n,t,e){const r=r2(t,n),s=DC(e),i=n[10],o=sf(n,X7(n,s,null,e.onPush?32:16,r,t,i,i.createRenderer(r,e),null,null,null));n[t.index]=o}function Mc(n,t,e,r,s,i){const o=r2(n,t);K9(t[11],o,i,n.value,e,r,s)}function K9(n,t,e,r,s,i,o){if(null==i)n.removeAttribute(t,s,e);else{const c=null==o?sn(i):o(i,r||"",s);n.setAttribute(t,s,c,e)}}function hB(n,t,e,r,s,i){const o=i[t];if(null!==o){const c=r.setInput;for(let u=0;u<o.length;){const d=o[u++],g=o[u++],m=o[u++];null!==c?r.setInput(e,m,d,g):e[g]=m}}}function qb(n,t){let e=null,r=0;for(;r<t.length;){const s=t[r];if(0!==s)if(5!==s){if("number"==typeof s)break;n.hasOwnProperty(s)&&(null===e&&(e=[]),e.push(s,n[s],t[r+1])),r+=2}else r+=2;else r+=4}return e}function UC(n,t,e,r){return new Array(n,!0,!1,t,null,0,r,e,null,null)}function Zb(n,t){const e=bi(t,n);if($6(e)){const r=e[1];48&e[2]?ef(r,e,r.template,e[8]):e[5]>0&&X9(e)}}function X9(n){for(let r=m9(n);null!==r;r=_9(r))for(let s=10;s<r.length;s++){const i=r[s];if($6(i))if(512&i[2]){const o=i[1];ef(o,i,o.template,i[8])}else i[5]>0&&X9(i)}const e=n[1].components;if(null!==e)for(let r=0;r<e.length;r++){const s=bi(e[r],n);$6(s)&&s[5]>0&&X9(s)}}function gB(n,t){const e=bi(t,n),r=e[1];(function Yb(n,t){for(let e=t.length;e<n.blueprint.length;e++)t.push(n.blueprint[e])})(r,e),J7(r,e,e[8])}function sf(n,t){return n[13]?n[14][4]=t:n[13]=t,n[14]=t,t}function GC(n){for(;n;){n[2]|=32;const t=fu(n);if(H6(n)&&!t)return n;n=t}return null}function af(n,t,e,r=!0){const s=t[10];s.begin&&s.begin();try{ef(n,t,n.template,e)}catch(o){throw r&&YC(t,o),o}finally{s.end&&s.end()}}function Q9(n,t,e){L8(0),t(n,e)}function qC(n){return n[7]||(n[7]=[])}function jC(n){return n.cleanup||(n.cleanup=[])}function YC(n,t){const e=n[9],r=e?e.get(f0,null):null;r&&r.handleError(t)}function cf(n,t,e,r,s){for(let i=0;i<e.length;){const o=e[i++],c=e[i++],u=t[o],d=n.data[o];null!==d.setInput?d.setInput(u,s,r,c):u[c]=s}}function M3(n,t,e){const r=x8(t,n);Kv(n[11],r,e)}function _u(n,t,e){let r=e?n.styles:null,s=e?n.classes:null,i=0;if(null!==t)for(let o=0;o<t.length;o++){const c=t[o];"number"==typeof c?i=c:1==i?s=P8(s,c):2==i&&(r=P8(r,c+": "+t[++o]+";"))}e?n.styles=r:n.stylesWithoutHost=r,e?n.classes=s:n.classesWithoutHost=s}function lf(n,t,e,r,s=!1){for(;null!==e;){const i=t[e.index];if(null!==i&&r.push(Er(i)),yr(i))for(let c=10;c<i.length;c++){const u=i[c],d=u[1].firstChild;null!==d&&lf(u[1],u,d,r)}const o=e.type;if(8&o)lf(n,t,e.child,r);else if(32&o){const c=g9(e,t);let u;for(;u=c();)r.push(u)}else if(16&o){const c=Pl(t,e);if(Array.isArray(c))r.push(...c);else{const u=fu(t[16]);lf(u[1],u,c,r,!0)}}e=s?e.projectionNext:e.next}return r}class uf{constructor(t,e){this._lView=t,this._cdRefInjectingView=e,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const t=this._lView,e=t[1];return lf(e,t,e.firstChild,[])}get context(){return this._lView[8]}set context(t){this._lView[8]=t}get destroyed(){return 128==(128&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const t=this._lView[3];if(yr(t)){const e=t[8],r=e?e.indexOf(this):-1;r>-1&&(y9(t,r),e0(e,r))}this._attachedToViewContainer=!1}Qv(this._lView[1],this._lView)}onDestroy(t){Fb(this._lView[1],this._lView,null,t)}markForCheck(){GC(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-65}reattach(){this._lView[2]|=64}detectChanges(){af(this._lView[1],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new Ie(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function tb(n,t){p0(n,t,t[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(t){if(this._attachedToViewContainer)throw new Ie(902,!1);this._appRef=t}}class Xb extends uf{constructor(t){super(t),this._view=t}detectChanges(){const t=this._view;af(t[1],t,t[8],!1)}checkNoChanges(){}get context(){return null}}class J9 extends xa{constructor(t){super(),this.ngModule=t}resolveComponentFactory(t){const e=T1(t);return new vu(e,this.ngModule)}}function Qb(n){const t=[];for(let e in n)n.hasOwnProperty(e)&&t.push({propName:n[e],templateName:e});return t}class XC{constructor(t,e){this.injector=t,this.parentInjector=e}get(t,e,r){const s=this.injector.get(t,c9,r);return s!==c9||e===c9?s:this.parentInjector.get(t,e,r)}}class vu extends Lv{constructor(t,e){super(),this.componentDef=t,this.ngModule=e,this.componentType=t.type,this.selector=function db(n){return n.map(fb).join(",")}(t.selectors),this.ngContentSelectors=t.ngContentSelectors?t.ngContentSelectors:[],this.isBoundToModule=!!e}get inputs(){return Qb(this.componentDef.inputs)}get outputs(){return Qb(this.componentDef.outputs)}create(t,e,r,s){let i=(s=s||this.ngModule)instanceof Ia?s:s?.injector;i&&null!==this.componentDef.getStandaloneInjector&&(i=this.componentDef.getStandaloneInjector(i)||i);const o=i?new XC(t,i):t,c=o.get(l0,null);if(null===c)throw new Ie(407,!1);const u=o.get(RF,null),d=c.createRenderer(null,this.componentDef),g=this.componentDef.selectors[0][0]||"div",m=r?function Hb(n,t,e){return n.selectRootElement(t,e===V1.ShadowDom)}(d,r,this.componentDef.encapsulation):C9(d,g,function KC(n){const t=n.toLowerCase();return"svg"===t?"svg":"math"===t?"math":null}(g)),y=this.componentDef.onPush?288:272,b=zC(0,null,null,1,0,null,null,null,null,null),k=X7(null,b,null,y,null,null,c,d,u,o,null);let $,K;ll(k);try{const oe=function eO(n,t,e,r,s,i){const o=e[1];e[22]=n;const u=m0(o,22,2,"#host",null),d=u.mergedAttrs=t.hostAttrs;null!==d&&(_u(u,d,!0),null!==n&&(_c(s,n,d),null!==u.classes&&B7(s,n,u.classes),null!==u.styles&&pu(s,n,u.styles)));const g=r.createRenderer(n,t),m=X7(e,DC(t),null,t.onPush?32:16,e[22],u,r,g,i||null,null,null);return o.firstCreatePass&&(Z6(f7(u,e),o,t.type),Y9(o,u),BC(u,e.length,1)),sf(e,m),e[22]=m}(m,this.componentDef,k,c,d);if(m)if(r)_c(d,m,["ng-version",Rv.full]);else{const{attrs:ye,classes:te}=function mC(n){const t=[],e=[];let r=1,s=2;for(;r<n.length;){let i=n[r];if("string"==typeof i)2===s?""!==i&&t.push(i,n[++r]):8===s&&e.push(i);else{if(!La(s))break;s=i}r++}return{attrs:t,classes:e}}(this.componentDef.selectors[0]);ye&&_c(d,m,ye),te&&te.length>0&&B7(d,m,te.join(" "))}if(K=vh(b,22),void 0!==e){const ye=K.projection=[];for(let te=0;te<this.ngContentSelectors.length;te++){const Le=e[te];ye.push(null!=Le?Array.from(Le):null)}}$=function JC(n,t,e,r){const s=e[1],i=function fB(n,t,e){const r=Rr();n.firstCreatePass&&(e.providersResolver&&e.providersResolver(e),$C(n,r,t,bl(n,t,1,null),e),tf(n,r));const s=Fs(t,n,r.directiveStart,r);xi(s,t);const i=r2(r,t);return i&&xi(i,t),s}(s,e,t);if(n[8]=e[8]=i,null!==r)for(const c of r)c(i,t);if(t.contentQueries){const c=Rr();t.contentQueries(1,i,c.directiveStart)}const o=Rr();return!s.firstCreatePass||null===t.hostBindings&&null===t.hostAttrs||(l3(o.index),rf(e[1],o,0,o.directiveStart,o.directiveEnd,t),Ub(t,i)),i}(oe,this.componentDef,k,[h]),J7(b,k,null)}finally{ul()}return new Jb(this.componentType,$,c0(K,k),k,K)}}class Jb extends class yw{}{constructor(t,e,r,s,i){super(),this.location=r,this._rootLView=s,this._tNode=i,this.instance=e,this.hostView=this.changeDetectorRef=new Xb(s),this.componentType=t}setInput(t,e){const r=this._tNode.inputs;let s;if(null!==r&&(s=r[t])){const i=this._rootLView;cf(i[1],i,s,t,e),VC(i,this._tNode.index)}}get injector(){return new Y6(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(t){this.hostView.onDestroy(t)}}function h(){const n=Rr();d3(ze()[1],n)}function l(n){let t=function a(n){return Object.getPrototypeOf(n.prototype).constructor}(n.type),e=!0;const r=[n];for(;t;){let s;if(Ms(n))s=t.\u0275cmp||t.\u0275dir;else{if(t.\u0275cmp)throw new Ie(903,!1);s=t.\u0275dir}if(s){if(e){r.push(s);const o=n;o.inputs=p(n.inputs),o.declaredInputs=p(n.declaredInputs),o.outputs=p(n.outputs);const c=s.hostBindings;c&&N(n,c);const u=s.viewQuery,d=s.contentQueries;if(u&&_(n,u),d&&E(n,d),nh(n.inputs,s.inputs),nh(n.declaredInputs,s.declaredInputs),nh(n.outputs,s.outputs),Ms(s)&&s.data.animation){const g=n.data;g.animation=(g.animation||[]).concat(s.data.animation)}}const i=s.features;if(i)for(let o=0;o<i.length;o++){const c=i[o];c&&c.ngInherit&&c(n),c===l&&(e=!1)}}t=Object.getPrototypeOf(t)}!function f(n){let t=0,e=null;for(let r=n.length-1;r>=0;r--){const s=n[r];s.hostVars=t+=s.hostVars,s.hostAttrs=j6(s.hostAttrs,e=j6(e,s.hostAttrs))}}(r)}function p(n){return n===Y?{}:n===C1?[]:n}function _(n,t){const e=n.viewQuery;n.viewQuery=e?(r,s)=>{t(r,s),e(r,s)}:t}function E(n,t){const e=n.contentQueries;n.contentQueries=e?(r,s,i)=>{t(r,s,i),e(r,s,i)}:t}function N(n,t){const e=n.hostBindings;n.hostBindings=e?(r,s)=>{t(r,s),e(r,s)}:t}let se=null;function be(){if(!se){const n=K1.Symbol;if(n&&n.iterator)se=n.iterator;else{const t=Object.getOwnPropertyNames(Map.prototype);for(let e=0;e<t.length;++e){const r=t[e];"entries"!==r&&"size"!==r&&Map.prototype[r]===Map.prototype.entries&&(se=r)}}}return se}function Fe(n){return!!Ct(n)&&(Array.isArray(n)||!(n instanceof Map)&&be()in n)}function Ct(n){return null!==n&&("function"==typeof n||"object"==typeof n)}function vn(n,t,e){return n[t]=e}function I1(n,t,e){return!Object.is(n[t],e)&&(n[t]=e,!0)}function p2(n,t,e,r){const s=I1(n,t,e);return I1(n,t+1,r)||s}function z(n,t,e,r){const s=ze();return I1(s,G6(),t)&&(Jn(),Mc(w1(),s,n,t,e,r)),z}function h1(n,t,e,r){return I1(n,G6(),e)?t+sn(e)+r:hn}function Bs(n,t,e,r,s,i){const c=p2(n,mc(),e,s);return ea(2),c?t+sn(e)+r+sn(s)+i:hn}function ia(n,t,e,r,s,i,o,c){const d=function za(n,t,e,r,s){const i=p2(n,t,e,r);return I1(n,t+2,s)||i}(n,mc(),e,s,o);return ea(3),d?t+sn(e)+r+sn(s)+i+sn(o)+c:hn}function Cu(n,t,e,r,s,i){const o=ze(),c=h1(o,t,e,r);return c!==hn&&Mc(w1(),o,n,c,s,i),Cu}function x(n,t,e,r,s,i,o,c){const u=ze(),d=Jn(),g=n+22,m=d.firstCreatePass?function w4e(n,t,e,r,s,i,o,c,u){const d=t.consts,g=m0(t,n,4,o||null,a3(d,c));Ol(t,e,g,a3(d,u)),d3(t,g);const m=g.tViews=zC(2,g,r,s,i,t.directiveRegistry,t.pipeRegistry,null,t.schemas,d);return null!==t.queries&&(t.queries.template(t,g),m.queries=t.queries.embeddedTView(g)),g}(g,d,u,t,e,r,s,i,o):d.data[g];gc(m,!1);const y=u[11].createComment("");du(d,u,y,m),xi(y,u),sf(u,u[g]=UC(y,u,y,m)),Qo(m)&&Z9(d,u,m),null!=o&&_0(u,m,c)}function Bn(n){return al(function o7(){return ln.lFrame.contextLView}(),22+n)}function w(n,t,e){const r=ze();return I1(r,G6(),t)&&Eo(Jn(),w1(),r,n,t,r[11],e,!1),w}function tO(n,t,e,r,s){const o=s?"class":"style";cf(n,e,t.inputs[o],o,r)}function O(n,t,e,r){const s=ze(),i=Jn(),o=22+n,c=s[11],u=s[o]=C9(c,t,function f3(){return ln.lFrame.currentNamespace}()),d=i.firstCreatePass?function O4e(n,t,e,r,s,i,o){const c=t.consts,d=m0(t,n,2,s,a3(c,i));return Ol(t,e,d,a3(c,o)),null!==d.attrs&&_u(d,d.attrs,!1),null!==d.mergedAttrs&&_u(d,d.mergedAttrs,!0),null!==t.queries&&t.queries.elementStart(t,d),d}(o,i,s,0,t,e,r):i.data[o];gc(d,!0);const g=d.mergedAttrs;null!==g&&_c(c,u,g);const m=d.classes;null!==m&&B7(c,u,m);const y=d.styles;return null!==y&&pu(c,u,y),64!=(64&d.flags)&&du(i,s,u,d),0===function kT(){return ln.lFrame.elementDepthCount}()&&xi(u,s),function LT(){ln.lFrame.elementDepthCount++}(),Qo(d)&&(Z9(i,s,d),RC(i,d,s)),null!==r&&_0(s,d),O}function A(){let n=Rr();Kr()?Eh():(n=n.parent,gc(n,!1));const t=n;!function RT(){ln.lFrame.elementDepthCount--}();const e=Jn();return e.firstCreatePass&&(d3(e,n),W2(n)&&e.queries.elementEnd(n)),null!=t.classesWithoutHost&&function bh(n){return 0!=(16&n.flags)}(t)&&tO(e,t,ze(),t.classesWithoutHost,!0),null!=t.stylesWithoutHost&&function F8(n){return 0!=(32&n.flags)}(t)&&tO(e,t,ze(),t.stylesWithoutHost,!1),A}function X(n,t,e,r){return O(n,t,e,r),A(),X}function pn(n,t,e){const r=ze(),s=Jn(),i=n+22,o=s.firstCreatePass?function A4e(n,t,e,r,s){const i=t.consts,o=a3(i,r),c=m0(t,n,8,"ng-container",o);return null!==o&&_u(c,o,!0),Ol(t,e,c,a3(i,s)),null!==t.queries&&t.queries.elementStart(t,c),c}(i,s,r,t,e):s.data[i];gc(o,!0);const c=r[i]=r[11].createComment("");return du(s,r,c,o),xi(c,r),Qo(o)&&(Z9(s,r,o),RC(s,o,r)),null!=e&&_0(r,o),pn}function gn(){let n=Rr();const t=Jn();return Kr()?Eh():(n=n.parent,gc(n,!1)),t.firstCreatePass&&(d3(t,n),W2(n)&&t.queries.elementEnd(n)),gn}function Oe(){return ze()}function ep(n){return!!n&&"function"==typeof n.then}const nO=function bB(n){return!!n&&"function"==typeof n.subscribe};function ee(n,t,e,r){const s=ze(),i=Jn(),o=Rr();return function AB(n,t,e,r,s,i,o,c){const u=Qo(r),g=n.firstCreatePass&&jC(n),m=t[8],y=qC(t);let b=!0;if(3&r.type||c){const K=r2(r,t),oe=c?c(K):K,ye=y.length,te=c?Ge=>c(Er(Ge[r.index])):r.index;let Le=null;if(!c&&u&&(Le=function N4e(n,t,e,r){const s=n.cleanup;if(null!=s)for(let i=0;i<s.length-1;i+=2){const o=s[i];if(o===e&&s[i+1]===r){const c=t[7],u=s[i+2];return c.length>u?c[u]:null}"string"==typeof o&&(i+=2)}return null}(n,t,s,r.index)),null!==Le)(Le.__ngLastListenerFn__||Le).__ngNextListenerFn__=i,Le.__ngLastListenerFn__=i,b=!1;else{i=IB(r,t,m,i,!1);const Ge=e.listen(oe,s,i);y.push(i,Ge),g&&g.push(s,te,ye,ye+1)}}else i=IB(r,t,m,i,!1);const k=r.outputs;let $;if(b&&null!==k&&($=k[s])){const K=$.length;if(K)for(let oe=0;oe<K;oe+=2){const Qe=t[$[oe]][$[oe+1]].subscribe(i),Ft=y.length;y.push(i,Qe),g&&g.push(s,r.index,Ft,-(Ft+1))}}}(i,s,s[11],o,n,t,0,r),ee}function NB(n,t,e,r){try{return!1!==e(r)}catch(s){return YC(n,s),!1}}function IB(n,t,e,r,s){return function i(o){if(o===Function)return r;GC(2&n.flags?bi(n.index,t):t);let u=NB(t,0,r,o),d=i.__ngNextListenerFn__;for(;d;)u=NB(t,0,d,o)&&u,d=d.__ngNextListenerFn__;return s&&!1===u&&(o.preventDefault(),o.returnValue=!1),u}}function C(n=1){return function l7(n){return(ln.lFrame.contextLView=function D8(n,t){for(;n>0;)t=t[15],n--;return t}(n,ln.lFrame.contextLView))[8]}(n)}function I4e(n,t){let e=null;const r=function pC(n){const t=n.attrs;if(null!=t){const e=t.indexOf(5);if(0==(1&e))return t[e+1]}return null}(n);for(let s=0;s<t.length;s++){const i=t[s];if("*"!==i){if(null===r?hC(n,i,!0):gC(r,i))return s}else e=s}return e}function rO(n,t,e){return y1(n,"",t,"",e),rO}function y1(n,t,e,r,s){const i=ze(),o=h1(i,t,e,r);return o!==hn&&Eo(Jn(),w1(),i,n,o,i[11],s,!1),y1}function De(n,t,e,r,s,i,o){const c=ze(),u=Bs(c,t,e,r,s,i);return u!==hn&&Eo(Jn(),w1(),c,n,u,c[11],o,!1),De}function j2(n,t,e,r,s,i,o,c,u){const d=ze(),g=ia(d,t,e,r,s,i,o,c);return g!==hn&&Eo(Jn(),w1(),d,n,g,d[11],u,!1),j2}function FB(n,t,e,r,s){const i=n[e+1],o=null===t;let c=r?Ra(i):Ec(i),u=!1;for(;0!==c&&(!1===u||o);){const g=n[c+1];L4e(n[c],t)&&(u=!0,n[c+1]=r?F9(g):H9(g)),c=r?Ra(g):Ec(g)}u&&(n[e+1]=r?H9(i):F9(i))}function L4e(n,t){return null===n||null==t||(Array.isArray(n)?n[1]:n)===t||!(!Array.isArray(n)||"string"!=typeof t)&&l2(n,t)>=0}const di={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function BB(n){return n.substring(di.key,di.keyEnd)}function R4e(n){return n.substring(di.value,di.valueEnd)}function UB(n,t){const e=di.textEnd;let r=di.key=ff(n,t,e);return e===r?-1:(r=di.keyEnd=function H4e(n,t,e){let r;for(;t<e&&(45===(r=n.charCodeAt(t))||95===r||(-33&r)>=65&&(-33&r)<=90||r>=48&&r<=57);)t++;return t}(n,r,e),r=WB(n,r,e),r=di.value=ff(n,r,e),r=di.valueEnd=function F4e(n,t,e){let r=-1,s=-1,i=-1,o=t,c=o;for(;o<e;){const u=n.charCodeAt(o++);if(59===u)return c;34===u||39===u?c=o=qB(n,u,o,e):t===o-4&&85===i&&82===s&&76===r&&40===u?c=o=qB(n,41,o,e):u>32&&(c=o),i=s,s=r,r=-33&u}return c}(n,r,e),WB(n,r,e))}function ff(n,t,e){for(;t<e&&n.charCodeAt(t)<=32;)t++;return t}function WB(n,t,e,r){return(t=ff(n,t,e))<e&&t++,t}function qB(n,t,e,r){let s=-1,i=e;for(;i<r;){const o=n.charCodeAt(i++);if(o==t&&92!==s)return i;s=92==o&&92===s?0:o}throw new Error}function ey(n,t){return function S3(n,t,e,r){const s=ze(),i=Jn(),o=ea(2);i.firstUpdatePass&&YB(i,n,o,r),t!==hn&&I1(s,o,t)&&XB(i,i.data[o2()],s,s[11],n,s[o+1]=function Y4e(n,t){return null==n||("string"==typeof t?n+=t:"object"==typeof n&&(n=j1(mo(n)))),n}(t,e),r,o)}(n,t,null,!0),ey}function m2(n){!function P3(n,t,e,r){const s=Jn(),i=ea(2);s.firstUpdatePass&&YB(s,null,i,r);const o=ze();if(e!==hn&&I1(o,i,e)){const c=s.data[o2()];if(JB(c,r)&&!ZB(s,i)){let u=r?c.classesWithoutHost:c.stylesWithoutHost;null!==u&&(e=P8(u,e||"")),tO(s,c,o,e,r)}else!function Z4e(n,t,e,r,s,i,o,c){s===hn&&(s=C1);let u=0,d=0,g=0<s.length?s[0]:null,m=0<i.length?i[0]:null;for(;null!==g||null!==m;){const y=u<s.length?s[u+1]:void 0,b=d<i.length?i[d+1]:void 0;let $,k=null;g===m?(u+=2,d+=2,y!==b&&(k=m,$=b)):null===m||null!==g&&g<m?(u+=2,k=g):(d+=2,k=m,$=b),null!==k&&XB(n,t,e,r,k,$,o,c),g=u<s.length?s[u]:null,m=d<i.length?i[d]:null}}(s,c,o,o[11],o[i+1],o[i+1]=function j4e(n,t,e){if(null==e||""===e)return C1;const r=[],s=mo(e);if(Array.isArray(s))for(let i=0;i<s.length;i++)n(r,s[i],!0);else if("object"==typeof s)for(const i in s)s.hasOwnProperty(i)&&n(r,i,s[i]);else"string"==typeof s&&t(r,s);return r}(n,t,e),r,i)}}(KB,B4e,n,!1)}function B4e(n,t){for(let e=function z4e(n){return function GB(n){di.key=0,di.keyEnd=0,di.value=0,di.valueEnd=0,di.textEnd=n.length}(n),UB(n,ff(n,0,di.textEnd))}(t);e>=0;e=UB(t,e))KB(n,BB(t),R4e(t))}function ZB(n,t){return t>=n.expandoStartIndex}function YB(n,t,e,r){const s=n.data;if(null===s[e+1]){const i=s[o2()],o=ZB(n,e);JB(i,r)&&null===t&&!o&&(t=!1),t=function U4e(n,t,e,r){const s=function a7(n){const t=ln.lFrame.currentDirectiveIndex;return-1===t?null:n[t]}(n);let i=r?t.residualClasses:t.residualStyles;if(null===s)0===(r?t.classBindings:t.styleBindings)&&(e=tp(e=sO(null,n,t,e,r),t.attrs,r),i=null);else{const o=t.directiveStylingLast;if(-1===o||n[o]!==s)if(e=sO(s,n,t,e,r),null===i){let u=function G4e(n,t,e){const r=e?t.classBindings:t.styleBindings;if(0!==Ec(r))return n[Ra(r)]}(n,t,r);void 0!==u&&Array.isArray(u)&&(u=sO(null,n,t,u[1],r),u=tp(u,t.attrs,r),function W4e(n,t,e,r){n[Ra(e?t.classBindings:t.styleBindings)]=r}(n,t,r,u))}else i=function q4e(n,t,e){let r;const s=t.directiveEnd;for(let i=1+t.directiveStylingLast;i<s;i++)r=tp(r,n[i].hostAttrs,e);return tp(r,t.attrs,e)}(n,t,r)}return void 0!==i&&(r?t.residualClasses=i:t.residualStyles=i),e}(s,i,t,r),function x4e(n,t,e,r,s,i){let o=i?t.classBindings:t.styleBindings,c=Ra(o),u=Ec(o);n[r]=e;let g,d=!1;if(Array.isArray(e)){const m=e;g=m[1],(null===g||l2(m,g)>0)&&(d=!0)}else g=e;if(s)if(0!==u){const y=Ra(n[c+1]);n[r+1]=q7(y,c),0!==y&&(n[y+1]=wl(n[y+1],r)),n[c+1]=function KF(n,t){return 131071&n|t<<17}(n[c+1],r)}else n[r+1]=q7(c,0),0!==c&&(n[c+1]=wl(n[c+1],r)),c=r;else n[r+1]=q7(u,0),0===c?c=r:n[u+1]=wl(n[u+1],r),u=r;d&&(n[r+1]=H9(n[r+1])),FB(n,g,r,!0),FB(n,g,r,!1),function k4e(n,t,e,r,s){const i=s?n.residualClasses:n.residualStyles;null!=i&&"string"==typeof t&&l2(i,t)>=0&&(e[r+1]=F9(e[r+1]))}(t,g,n,r,i),o=q7(c,u),i?t.classBindings=o:t.styleBindings=o}(s,i,t,e,o,r)}}function sO(n,t,e,r,s){let i=null;const o=e.directiveEnd;let c=e.directiveStylingLast;for(-1===c?c=e.directiveStart:c++;c<o&&(i=t[c],r=tp(r,i.hostAttrs,s),i!==n);)c++;return null!==n&&(e.directiveStylingLast=c),r}function tp(n,t,e){const r=e?1:2;let s=-1;if(null!==t)for(let i=0;i<t.length;i++){const o=t[i];"number"==typeof o?s=o:s===r&&(Array.isArray(n)||(n=void 0===n?[]:["",n]),c2(n,o,!!e||t[++i]))}return void 0===n?null:n}function KB(n,t,e){c2(n,t,mo(e))}function XB(n,t,e,r,s,i,o,c){if(!(3&t.type))return;const u=n.data,d=u[c+1];ty(function bC(n){return 1==(1&n)}(d)?QB(u,t,e,s,Ec(d),o):void 0)||(ty(i)||function Tb(n){return 2==(2&n)}(d)&&(i=QB(u,null,e,s,c,o)),function cC(n,t,e,r,s){if(t)s?n.addClass(e,r):n.removeClass(e,r);else{let i=-1===r.indexOf("-")?void 0:h2.DashCase;null==s?n.removeStyle(e,r,i):("string"==typeof s&&s.endsWith("!important")&&(s=s.slice(0,-10),i|=h2.Important),n.setStyle(e,r,s,i))}}(r,o,x8(o2(),e),s,i))}function QB(n,t,e,r,s,i){const o=null===t;let c;for(;s>0;){const u=n[s],d=Array.isArray(u),g=d?u[1]:u,m=null===g;let y=e[s+1];y===hn&&(y=m?C1:void 0);let b=m?ci(y,r):g===r?y:void 0;if(d&&!ty(b)&&(b=ci(u,r)),ty(b)&&(c=b,o))return c;const k=n[s+1];s=o?Ra(k):Ec(k)}if(null!==t){let u=i?t.residualClasses:t.residualStyles;null!=u&&(c=ci(u,r))}return c}function ty(n){return void 0!==n}function JB(n,t){return 0!=(n.flags&(t?16:32))}function Tt(n,t=""){const e=ze(),r=Jn(),s=n+22,i=r.firstCreatePass?m0(r,s,1,t,null):r.data[s],o=e[s]=v9(e[11],t);du(r,e,o,i),gc(i,!1)}function c1(n){return Z2("",n,""),c1}function Z2(n,t,e){const r=ze(),s=h1(r,n,t,e);return s!==hn&&M3(r,o2(),s),Z2}function ny(n,t,e,r,s){const i=ze(),o=Bs(i,n,t,e,r,s);return o!==hn&&M3(i,o2(),o),ny}function iO(n,t,e,r,s,i,o){const c=ze(),u=ia(c,n,t,e,r,s,i,o);return u!==hn&&M3(c,o2(),u),iO}function oO(n,t,e){const r=ze();return I1(r,G6(),t)&&Eo(Jn(),w1(),r,n,t,r[11],e,!0),oO}const yu=void 0;var gle=["en",[["a","p"],["AM","PM"],yu],[["AM","PM"],yu,yu],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],yu,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],yu,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",yu,"{1} 'at' {0}",yu],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function ple(n){const e=Math.floor(Math.abs(n)),r=n.toString().replace(/^[^.]*\.?/,"").length;return 1===e&&0===r?1:5}];let df={};function Po(n){const t=function _le(n){return n.toLowerCase().replace(/_/g,"-")}(n);let e=_$(t);if(e)return e;const r=t.split("-")[0];if(e=_$(r),e)return e;if("en"===r)return gle;throw new Ie(701,!1)}function _$(n){return n in df||(df[n]=K1.ng&&K1.ng.common&&K1.ng.common.locales&&K1.ng.common.locales[n]),df[n]}var vt=(()=>((vt=vt||{})[vt.LocaleId=0]="LocaleId",vt[vt.DayPeriodsFormat=1]="DayPeriodsFormat",vt[vt.DayPeriodsStandalone=2]="DayPeriodsStandalone",vt[vt.DaysFormat=3]="DaysFormat",vt[vt.DaysStandalone=4]="DaysStandalone",vt[vt.MonthsFormat=5]="MonthsFormat",vt[vt.MonthsStandalone=6]="MonthsStandalone",vt[vt.Eras=7]="Eras",vt[vt.FirstDayOfWeek=8]="FirstDayOfWeek",vt[vt.WeekendRange=9]="WeekendRange",vt[vt.DateFormat=10]="DateFormat",vt[vt.TimeFormat=11]="TimeFormat",vt[vt.DateTimeFormat=12]="DateTimeFormat",vt[vt.NumberSymbols=13]="NumberSymbols",vt[vt.NumberFormats=14]="NumberFormats",vt[vt.CurrencyCode=15]="CurrencyCode",vt[vt.CurrencySymbol=16]="CurrencySymbol",vt[vt.CurrencyName=17]="CurrencyName",vt[vt.Currencies=18]="Currencies",vt[vt.Directionality=19]="Directionality",vt[vt.PluralCase=20]="PluralCase",vt[vt.ExtraData=21]="ExtraData",vt))();const vle=["zero","one","two","few","many"],hf="en-US",ry={marker:"element"},sy={marker:"ICU"};var fs=(()=>((fs=fs||{})[fs.SHIFT=2]="SHIFT",fs[fs.APPEND_EAGERLY=1]="APPEND_EAGERLY",fs[fs.COMMENT=2]="COMMENT",fs))();let v$=hf;function C$(n){(function fo(n,t){null==n&&P1(t,n,null,"!=")})(n,"Expected localeId to be defined"),"string"==typeof n&&(v$=n.toLowerCase().replace(/_/g,"-"))}function y$(n,t,e){const r=t.insertBeforeIndex,s=Array.isArray(r)?r[0]:r;return null===s?sC(n,0,e):Er(e[s])}function E$(n,t,e,r,s){const i=t.insertBeforeIndex;if(Array.isArray(i)){let o=r,c=null;if(3&t.type||(c=o,o=s),null!==o&&0==(2&t.flags))for(let u=1;u<i.length;u++)C3(n,o,e[i[u]],c,!1)}}function M$(n,t){if(n.push(t),n.length>1)for(let e=n.length-2;e>=0;e--){const r=n[e];S$(r)||Mle(r,t)&&null===Sle(r)&&Ple(r,t.index)}}function S$(n){return!(64&n.type)}function Mle(n,t){return S$(t)||n.index>t.index}function Sle(n){const t=n.insertBeforeIndex;return Array.isArray(t)?t[0]:t}function Ple(n,t){const e=n.insertBeforeIndex;Array.isArray(e)?e[0]=t:(F7(y$,E$),n.insertBeforeIndex=t)}function np(n,t){const e=n.data[t];return null===e||"string"==typeof e?null:e.hasOwnProperty("currentCaseLViewIndex")?e:e.value}function ble(n,t,e){const r=Q7(n,e,64,null,null);return M$(t,r),r}function iy(n,t){const e=t[n.currentCaseLViewIndex];return null===e?e:e<0?~e:e}function P$(n){return n>>>17}function T$(n){return(131070&n)>>>1}let rp=0,sp=0;function b$(n,t,e,r){const s=e[11];let o,i=null;for(let c=0;c<t.length;c++){const u=t[c];if("string"==typeof u){const d=t[++c];null===e[d]&&(e[d]=v9(s,u))}else if("number"==typeof u)switch(1&u){case 0:const d=P$(u);let g,m;if(null===i&&(i=d,o=d0(s,r)),d===i?(g=r,m=o):(g=null,m=Er(e[d])),null!==m){const $=T$(u);C3(s,m,e[$],g,!1);const oe=np(n,$);if(null!==oe&&"object"==typeof oe){const ye=iy(oe,e);null!==ye&&b$(n,oe.create[ye],e,e[oe.anchorIdx])}}break;case 1:const b=t[++c],k=t[++c];K9(s,x8(u>>>1,e),null,null,b,k,null)}else switch(u){case sy:const d=t[++c],g=t[++c];null===e[g]&&xi(e[g]=Qw(s,d),e);break;case ry:const m=t[++c],y=t[++c];null===e[y]&&xi(e[y]=C9(s,m,null),e)}}}function O$(n,t,e,r,s){for(let i=0;i<e.length;i++){const o=e[i],c=e[++i];if(o&s){let u="";for(let d=i+1;d<=i+c;d++){const g=e[d];if("string"==typeof g)u+=g;else if("number"==typeof g)if(g<0)u+=sn(t[r-g]);else{const m=g>>>2;switch(3&g){case 1:const y=e[++d],b=e[++d],k=n.data[m];"string"==typeof k?K9(t[11],t[m],null,k,y,u,b):Eo(n,k,t,y,u,t[11],b,!1);break;case 0:const $=t[m];null!==$&&Kv(t[11],$,u);break;case 2:xle(n,np(n,m),t,u);break;case 3:A$(n,np(n,m),r,t)}}}}else{const u=e[i+1];if(u>0&&3==(3&u)){const g=np(n,u>>>2);t[g.currentCaseLViewIndex]<0&&A$(n,g,r,t)}}i+=c}}function A$(n,t,e,r){let s=r[t.currentCaseLViewIndex];if(null!==s){let i=rp;s<0&&(s=r[t.currentCaseLViewIndex]=~s,i=-1),O$(n,r,t.update[s],e,i)}}function xle(n,t,e,r){const s=function kle(n,t){let e=n.cases.indexOf(t);if(-1===e)switch(n.type){case 1:{const r=function Cle(n,t){const e=function m$(n){return Po(n)[vt.PluralCase]}(t)(parseInt(n,10)),r=vle[e];return void 0!==r?r:"other"}(t,function Ele(){return v$}());e=n.cases.indexOf(r),-1===e&&"other"!==r&&(e=n.cases.indexOf("other"));break}case 0:e=n.cases.indexOf("other")}return-1===e?null:e}(t,r);if(iy(t,e)!==s&&(N$(n,t,e),e[t.currentCaseLViewIndex]=null===s?null:~s,null!==s)){const o=e[t.anchorIdx];o&&b$(n,t.create[s],e,o)}}function N$(n,t,e){let r=iy(t,e);if(null!==r){const s=t.remove[r];for(let i=0;i<s.length;i++){const o=s[i];if(o>0){const c=x8(o,e);null!==c&&oC(e[11],c)}else N$(n,np(n,~o),e)}}}function Lle(){const n=[];let e,r,t=-1;function i(c,u){t=0;const d=iy(c,u);r=null!==d?c.remove[d]:C1}function o(){if(t<r.length){const c=r[t++];return c>0?e[c]:(n.push(t,r),i(e[1].data[~c],e),o())}return 0===n.length?null:(r=n.pop(),t=n.pop(),o())}return function s(c,u){for(e=u;n.length;)n.pop();return i(c.value,u),o}}const oy=/\ufffd(\d+):?\d*\ufffd/gi,Dle=/\ufffd(\d+)\ufffd/,x$=/^\s*(\ufffd\d+:?\d*\ufffd)\s*,\s*(select|plural)\s*,/,zle=/\ufffd\/?\*(\d+:\d+)\ufffd/gi,Vle=/\ufffd(\/?[#*]\d+):?\d*\ufffd/gi,Hle=/\uE500/g;function k$(n,t,e,r,s,i,o){const c=bl(n,r,1,null);let u=c<<fs.SHIFT,d=cl();t===d&&(d=null),null===d&&(u|=fs.APPEND_EAGERLY),o&&(u|=fs.COMMENT,function Zv(n){void 0===p9&&(p9=n())}(Lle)),s.push(u,null===i?"":i);const g=Q7(n,c,o?32:1,null===i?"":i,null);M$(e,g);const m=g.index;return gc(g,!1),null!==d&&t!==d&&function wle(n,t){let e=n.insertBeforeIndex;null===e?(F7(y$,E$),e=n.insertBeforeIndex=[null,t]):(function d1(n,t,e){n!=t&&P1(e,n,t,"==")}(Array.isArray(e),!0,"Expecting array here"),e.push(t))}(d,m),g}function $le(n,t,e,r,s,i,o){const c=o.match(oy),u=k$(n,t,e,i,r,c?null:o,!1);c&&op(s,o,u.index,null,0,null)}function op(n,t,e,r,s,i){const o=n.length,c=o+1;n.push(null,null);const u=o+2,d=t.split(oy);let g=0;for(let m=0;m<d.length;m++){const y=d[m];if(1&m){const b=s+parseInt(y,10);n.push(-1-b),g|=L$(b)}else""!==y&&n.push(y)}return n.push(e<<2|(r?1:0)),r&&n.push(r,i),n[o]=g,n[c]=n.length-u,g}function L$(n){return 1<<Math.min(n,31)}function R$(n){let t,i,e="",r=0,s=!1;for(;null!==(t=zle.exec(n));)s?t[0]===`\ufffd/*${i}\ufffd`&&(r=t.index,s=!1):(e+=n.substring(r,t.index+t[0].length),i=t[1],s=!0);return e+=n.slice(r),e}function D$(n,t,e,r,s,i){let o=0;const c={type:s.type,currentCaseLViewIndex:bl(n,t,1,null),anchorIdx:i,cases:[],create:[],remove:[],update:[]};(function Kle(n,t,e){n.push(L$(t.mainBinding),2,-1-t.mainBinding,e<<2|2)})(e,s,i),function Tle(n,t,e){const r=n.data[t];null===r?n.data[t]=e:r.value=e}(n,i,c);const u=s.values;for(let d=0;d<u.length;d++){const g=u[d],m=[];for(let y=0;y<g.length;y++){const b=g[y];if("string"!=typeof b){const k=m.push(b)-1;g[y]=`\x3c!--\ufffd${k}\ufffd--\x3e`}}o=Zle(n,c,t,e,r,s.cases[d],g.join(""),m)|o}o&&function Xle(n,t,e){n.push(t,1,e<<2|3)}(e,o,i)}function jle(n){const t=[],e=[];let r=1,s=0;const i=aO(n=n.replace(x$,function(o,c,u){return r="select"===u?0:1,s=parseInt(c.slice(1),10),""}));for(let o=0;o<i.length;){let c=i[o++].trim();1===r&&(c=c.replace(/\s*(?:=)?(\w+)\s*/,"$1")),c.length&&t.push(c);const u=aO(i[o++]);t.length>e.length&&e.push(u)}return{type:r,mainBinding:s,cases:t,values:e}}function aO(n){if(!n)return[];let t=0;const e=[],r=[],s=/[{}]/g;let i;for(s.lastIndex=0;i=s.exec(n);){const c=i.index;if("}"==i[0]){if(e.pop(),0==e.length){const u=n.substring(t,c);x$.test(u)?r.push(jle(u)):r.push(u),t=c+1}}else{if(0==e.length){const u=n.substring(t,c);r.push(u),t=c+1}e.push("{")}}const o=n.substring(t);return r.push(o),r}function Zle(n,t,e,r,s,i,o,c){const u=[],d=[],g=[];t.cases.push(i),t.create.push(u),t.remove.push(d),t.update.push(g);const y=mv(lv()).getInertBodyElement(o),b=vo(y)||y;return b?z$(n,t,e,r,u,d,g,b,s,c,0):0}function z$(n,t,e,r,s,i,o,c,u,d,g){let m=0,y=c.firstChild;for(;y;){const b=bl(n,e,1,null);switch(y.nodeType){case Node.ELEMENT_NODE:const k=y,$=k.tagName.toLowerCase();if(eu.hasOwnProperty($)){cO(s,ry,$,u,b),n.data[b]=$;const te=k.attributes;for(let Le=0;Le<te.length;Le++){const Ge=te.item(Le),Qe=Ge.name.toLowerCase();Ge.value.match(oy)?b7.hasOwnProperty(Qe)&&op(o,Ge.value,b,Ge.name,0,w7[Qe]?sa:null):Qle(s,b,Ge)}m=z$(n,t,e,r,s,i,o,y,b,d,g+1)|m,V$(i,b,g)}break;case Node.TEXT_NODE:const K=y.textContent||"",oe=K.match(oy);cO(s,null,oe?"":K,u,b),V$(i,b,g),oe&&(m=op(o,K,b,null,0,null)|m);break;case Node.COMMENT_NODE:const ye=Dle.exec(y.textContent||"");if(ye){const Le=d[parseInt(ye[1],10)];cO(s,sy,"",u,b),D$(n,e,r,u,Le,b),Yle(i,b,g)}}y=y.nextSibling}return m}function V$(n,t,e){0===e&&n.push(t)}function Yle(n,t,e){0===e&&(n.push(~t),n.push(t))}function cO(n,t,e,r,s){null!==t&&n.push(t),n.push(e,s,function Ole(n,t,e){return n|t<<17|e<<1}(0,r,s))}function Qle(n,t,e){n.push(t<<1|1,e.name,e.value)}function Sc(n,t,e=-1){const r=Jn(),s=ze(),i=22+n,o=a3(r.consts,t),c=cl();r.firstCreatePass&&function Ble(n,t,e,r,s,i){const o=cl(),c=[],u=[],d=[[]];s=function qle(n,t){if(function Wle(n){return-1===n}(t))return R$(n);{const e=n.indexOf(`:${t}\ufffd`)+2+t.toString().length,r=n.search(new RegExp(`\ufffd\\/\\*\\d+:${t}\ufffd`));return R$(n.substring(e,r))}}(s,i);const g=function Fle(n){return n.replace(Hle," ")}(s).split(Vle);for(let m=0;m<g.length;m++){let y=g[m];if(0==(1&m)){const b=aO(y);for(let k=0;k<b.length;k++){let $=b[k];if(0==(1&k)){const K=$;""!==K&&$le(n,o,d[0],c,u,e,K)}else{const K=$;if("object"!=typeof K)throw new Error(`Unable to parse ICU expression in "${s}" message.`);D$(n,e,u,t,K,k$(n,o,d[0],e,c,"",!0).index)}}}else{const b=47===y.charCodeAt(0),$=(y.charCodeAt(b?1:0),22+Number.parseInt(y.substring(b?2:1)));if(b)d.shift(),gc(cl(),!1);else{const K=ble(n,d[0],$);d.unshift([]),gc(K,!0)}}}n.data[r]={create:c,update:u}}(r,null===c?0:c.index,s,i,o,e);const u=r.data[i],g=S9(r,c===s[6]?null:c,s);(function Ile(n,t,e,r){const s=n[11];for(let i=0;i<t.length;i++){const o=t[i++],c=t[i],u=(o&fs.COMMENT)===fs.COMMENT,d=(o&fs.APPEND_EAGERLY)===fs.APPEND_EAGERLY,g=o>>>fs.SHIFT;let m=n[g];null===m&&(m=n[g]=u?s.createComment(c):v9(s,c)),d&&null!==e&&C3(s,e,m,r,!1)}})(s,u.create,g,c&&8&c.type?s[c.index]:null),s2(!0)}function Pc(){s2(!1)}function ve(n,t,e){Sc(n,t,e),Pc()}function x1(n){return function Ale(n){n&&(rp|=1<<Math.min(sp,31)),sp++}(I1(ze(),G6(),n)),x1}function B1(n){!function Nle(n,t,e){if(sp>0){const r=n.data[e];O$(n,t,Array.isArray(r)?r:r.update,mc()-sp-1,rp)}rp=0,sp=0}(Jn(),ze(),n+22)}function lO(n,t,e,r,s){if(n=rn(n),Array.isArray(n))for(let i=0;i<n.length;i++)lO(n[i],t,e,r,s);else{const i=Jn(),o=ze();let c=El(n)?n:rn(n.provide),u=x7(n);const d=Rr(),g=1048575&d.providerIndexes,m=d.directiveStart,y=d.providerIndexes>>20;if(El(n)||!n.multi){const b=new H8(u,s,J),k=fO(c,t,s?g:g+y,m);-1===k?(Z6(f7(d,o),i,c),uO(i,n,t.length),t.push(c),d.directiveStart++,d.directiveEnd++,s&&(d.providerIndexes+=1048576),e.push(b),o.push(b)):(e[k]=b,o[k]=b)}else{const b=fO(c,t,g+y,m),k=fO(c,t,g,g+y),$=b>=0&&e[b],K=k>=0&&e[k];if(s&&!K||!s&&!$){Z6(f7(d,o),i,c);const oe=function d6e(n,t,e,r,s){const i=new H8(n,e,J);return i.multi=[],i.index=t,i.componentProviders=0,F$(i,s,r&&!e),i}(s?f6e:u6e,e.length,s,r,u);!s&&K&&(e[k].providerFactory=oe),uO(i,n,t.length,0),t.push(c),d.directiveStart++,d.directiveEnd++,s&&(d.providerIndexes+=1048576),e.push(oe),o.push(oe)}else uO(i,n,b>-1?b:k,F$(e[s?k:b],u,!s&&r));!s&&r&&K&&e[k].componentProviders++}}}function uO(n,t,e,r){const s=El(t),i=function _w(n){return!!n.useClass}(t);if(s||i){const u=(i?rn(t.useClass):t).prototype.ngOnDestroy;if(u){const d=n.destroyHooks||(n.destroyHooks=[]);if(!s&&t.multi){const g=d.indexOf(e);-1===g?d.push(e,[r,u]):d[g+1].push(r,u)}else d.push(e,u)}}}function F$(n,t,e){return e&&n.componentProviders++,n.multi.push(t)-1}function fO(n,t,e,r){for(let s=e;s<r;s++)if(t[s]===n)return s;return-1}function u6e(n,t,e,r){return dO(this.multi,[])}function f6e(n,t,e,r){const s=this.multi;let i;if(this.providerFactory){const o=this.providerFactory.componentProviders,c=Fs(e,e[1],this.providerFactory.index,r);i=c.slice(0,o),dO(s,i);for(let u=o;u<c.length;u++)i.push(c[u])}else i=[],dO(s,i);return i}function dO(n,t){for(let e=0;e<n.length;e++)t.push((0,n[e])());return t}function zr(n,t=[]){return e=>{e.providersResolver=(r,s)=>function l6e(n,t,e){const r=Jn();if(r.firstCreatePass){const s=Ms(n);lO(e,r.data,r.blueprint,s,!0),lO(t,r.data,r.blueprint,s,!1)}}(r,s?s(n):n,t)}}class Eu{}class B${}class $$ extends Eu{constructor(t,e){super(),this._parent=e,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new J9(this);const r=ho(t);this._bootstrapComponents=ka(r.bootstrap),this._r3Injector=yC(t,e,[{provide:Eu,useValue:this},{provide:xa,useValue:this.componentFactoryResolver}],j1(t),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(t)}get injector(){return this._r3Injector}destroy(){const t=this._r3Injector;!t.destroyed&&t.destroy(),this.destroyCbs.forEach(e=>e()),this.destroyCbs=null}onDestroy(t){this.destroyCbs.push(t)}}class hO extends B${constructor(t){super(),this.moduleType=t}create(t){return new $$(this.moduleType,t)}}class p6e extends Eu{constructor(t,e,r){super(),this.componentFactoryResolver=new J9(this),this.instance=null;const s=new I7([...t,{provide:Eu,useValue:this},{provide:xa,useValue:this.componentFactoryResolver}],e||d4(),r,new Set(["environment"]));this.injector=s,s.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(t){this.injector.onDestroy(t)}}function ay(n,t,e=null){return new p6e(n,t,e).injector}let g6e=(()=>{class n{constructor(e){this._injector=e,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(e){if(!e.standalone)return null;if(!this.cachedInjectors.has(e.id)){const r=n9(0,e.type),s=r.length>0?ay([r],this._injector,`Standalone[${e.type.name}]`):null;this.cachedInjectors.set(e.id,s)}return this.cachedInjectors.get(e.id)}ngOnDestroy(){try{for(const e of this.cachedInjectors.values())null!==e&&e.destroy()}finally{this.cachedInjectors.clear()}}}return n.\u0275prov=rt({token:n,providedIn:"environment",factory:()=>new n(Ve(Ia))}),n})();function U$(n){n.getStandaloneInjector=t=>t.get(g6e).getOrCreateStandaloneInjector(n)}function J1(n,t,e){const r=Oi()+n,s=ze();return s[r]===hn?vn(s,r,e?t.call(e):t()):function Q1(n,t){return n[t]}(s,r)}function T3(n,t,e,r){return K$(ze(),Oi(),n,t,e,r)}function ap(n,t){const e=n[t];return e===hn?void 0:e}function K$(n,t,e,r,s,i){const o=t+e;return I1(n,o,s)?vn(n,o+1,i?r.call(i,s):r(s)):ap(n,o+1)}function Tc(n,t){const e=Jn();let r;const s=n+22;e.firstCreatePass?(r=function x6e(n,t){if(t)for(let e=t.length-1;e>=0;e--){const r=t[e];if(n===r.name)return r}}(t,e.pipeRegistry),e.data[s]=r,r.onDestroy&&(e.destroyHooks||(e.destroyHooks=[])).push(s,r.onDestroy)):r=e.data[s];const i=r.factory||(r.factory=Ta(r.type)),o=jo(J);try{const c=o4(!1),u=i();return o4(c),function b4e(n,t,e,r){e>=n.data.length&&(n.data[e]=null,n.blueprint[e]=null),t[e]=r}(e,ze(),s,u),u}finally{jo(o)}}function w3(n,t,e){const r=n+22,s=ze(),i=al(s,r);return cp(s,r)?K$(s,Oi(),t,i.transform,e,i):i.transform(e)}function tU(n,t,e,r){const s=n+22,i=ze(),o=al(i,s);return cp(i,s)?function X$(n,t,e,r,s,i,o){const c=t+e;return p2(n,c,s,i)?vn(n,c+2,o?r.call(o,s,i):r(s,i)):ap(n,c+2)}(i,Oi(),t,o.transform,e,r,o):o.transform(e,r)}function cp(n,t){return n[1].data[t].pure}function gO(n){return t=>{setTimeout(n,void 0,t)}}const dr=class D6e extends F2{constructor(t=!1){super(),this.__isAsync=t}emit(t){super.next(t)}subscribe(t,e,r){let s=t,i=e||(()=>null),o=r;if(t&&"object"==typeof t){const u=t;s=u.next?.bind(u),i=u.error?.bind(u),o=u.complete?.bind(u)}this.__isAsync&&(i=gO(i),s&&(s=gO(s)),o&&(o=gO(o)));const c=super.subscribe({next:s,error:i,complete:o});return t instanceof q1&&t.add(c),c}};function z6e(){return this._results[be()]()}class mO{constructor(t=!1){this._emitDistinctChangesOnly=t,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const e=be(),r=mO.prototype;r[e]||(r[e]=z6e)}get changes(){return this._changes||(this._changes=new dr)}get(t){return this._results[t]}map(t){return this._results.map(t)}filter(t){return this._results.filter(t)}find(t){return this._results.find(t)}reduce(t,e){return this._results.reduce(t,e)}forEach(t){this._results.forEach(t)}some(t){return this._results.some(t)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(t,e){const r=this;r.dirty=!1;const s=a2(t);(this._changesDetected=!function Dh(n,t,e){if(n.length!==t.length)return!1;for(let r=0;r<n.length;r++){let s=n[r],i=t[r];if(e&&(s=e(s),i=e(i)),i!==s)return!1}return!0}(r._results,s,e))&&(r._results=s,r.length=s.length,r.last=s[this.length-1],r.first=s[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}let Al=(()=>{class n{}return n.__NG_ELEMENT_ID__=F6e,n})();const V6e=Al,H6e=class extends V6e{constructor(t,e,r){super(),this._declarationLView=t,this._declarationTContainer=e,this.elementRef=r}createEmbeddedView(t,e){const r=this._declarationTContainer.tViews,s=X7(this._declarationLView,r,t,16,null,r.declTNode,null,null,null,null,e||null);s[17]=this._declarationLView[this._declarationTContainer.index];const o=this._declarationLView[19];return null!==o&&(s[19]=o.createEmbeddedView(r)),J7(r,s,t),new uf(s)}};function F6e(){return cy(Rr(),ze())}function cy(n,t){return 4&n.type?new H6e(t,n,c0(n,t)):null}let Va=(()=>{class n{}return n.__NG_ELEMENT_ID__=B6e,n})();function B6e(){return sU(Rr(),ze())}const $6e=Va,nU=class extends $6e{constructor(t,e,r){super(),this._lContainer=t,this._hostTNode=e,this._hostLView=r}get element(){return c0(this._hostTNode,this._hostLView)}get injector(){return new Y6(this._hostTNode,this._hostLView)}get parentInjector(){const t=Oa(this._hostTNode,this._hostLView);if(Ah(t)){const e=hl(t,this._hostLView),r=dl(t);return new Y6(e[1].data[r+8],e)}return new Y6(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(t){const e=rU(this._lContainer);return null!==e&&e[t]||null}get length(){return this._lContainer.length-10}createEmbeddedView(t,e,r){let s,i;"number"==typeof r?s=r:null!=r&&(s=r.index,i=r.injector);const o=t.createEmbeddedView(e||{},i);return this.insert(o,s),o}createComponent(t,e,r,s,i){const o=t&&!function Ai(n){return"function"==typeof n}(t);let c;if(o)c=e;else{const m=e||{};c=m.index,r=m.injector,s=m.projectableNodes,i=m.environmentInjector||m.ngModuleRef}const u=o?t:new vu(T1(t)),d=r||this.parentInjector;if(!i&&null==u.ngModule){const y=(o?d:this.parentInjector).get(Ia,null);y&&(i=y)}const g=u.create(d,s,void 0,i);return this.insert(g.hostView,c),g}insert(t,e){const r=t._lView,s=r[1];if(function k8(n){return yr(n[3])}(r)){const g=this.indexOf(t);if(-1!==g)this.detach(g);else{const m=r[3],y=new nU(m,m[6],m[3]);y.detach(y.indexOf(t))}}const i=this._adjustIndex(e),o=this._lContainer;!function rb(n,t,e,r){const s=10+r,i=e.length;r>0&&(e[s-1][4]=t),r<i-10?(t[4]=e[s],p3(e,10+r,t)):(e.push(t),t[4]=null),t[3]=e;const o=t[17];null!==o&&e!==o&&function sb(n,t){const e=n[9];t[16]!==t[3][3][16]&&(n[2]=!0),null===e?n[9]=[t]:e.push(t)}(o,t);const c=t[19];null!==c&&c.insertView(n),t[2]|=64}(s,r,o,i);const c=h0(i,o),u=r[11],d=d0(u,o[7]);return null!==d&&function eb(n,t,e,r,s,i){r[0]=s,r[6]=t,p0(n,r,e,1,s,i)}(s,o[6],u,r,d,c),t.attachToViewContainerRef(),p3(_O(o),i,t),t}move(t,e){return this.insert(t,e)}indexOf(t){const e=rU(this._lContainer);return null!==e?e.indexOf(t):-1}remove(t){const e=this._adjustIndex(t,-1),r=y9(this._lContainer,e);r&&(e0(_O(this._lContainer),e),Qv(r[1],r))}detach(t){const e=this._adjustIndex(t,-1),r=y9(this._lContainer,e);return r&&null!=e0(_O(this._lContainer),e)?new uf(r):null}_adjustIndex(t,e=0){return t??this.length+e}};function rU(n){return n[8]}function _O(n){return n[8]||(n[8]=[])}function sU(n,t){let e;const r=t[n.index];if(yr(r))e=r;else{let s;if(8&n.type)s=Er(r);else{const i=t[11];s=i.createComment("");const o=r2(n,t);C3(i,d0(i,o),s,function nC(n,t){return n.nextSibling(t)}(i,o),!1)}t[n.index]=e=UC(r,t,s,n),sf(t,e)}return new nU(e,n,t)}class vO{constructor(t){this.queryList=t,this.matches=null}clone(){return new vO(this.queryList)}setDirty(){this.queryList.setDirty()}}class CO{constructor(t=[]){this.queries=t}createEmbeddedView(t){const e=t.queries;if(null!==e){const r=null!==t.contentQueries?t.contentQueries[0]:e.length,s=[];for(let i=0;i<r;i++){const o=e.getByIndex(i);s.push(this.queries[o.indexInDeclarationView].clone())}return new CO(s)}return null}insertView(t){this.dirtyQueriesWithMatches(t)}detachView(t){this.dirtyQueriesWithMatches(t)}dirtyQueriesWithMatches(t){for(let e=0;e<this.queries.length;e++)null!==lU(t,e).matches&&this.queries[e].setDirty()}}class iU{constructor(t,e,r=null){this.predicate=t,this.flags=e,this.read=r}}class yO{constructor(t=[]){this.queries=t}elementStart(t,e){for(let r=0;r<this.queries.length;r++)this.queries[r].elementStart(t,e)}elementEnd(t){for(let e=0;e<this.queries.length;e++)this.queries[e].elementEnd(t)}embeddedTView(t){let e=null;for(let r=0;r<this.length;r++){const s=null!==e?e.length:0,i=this.getByIndex(r).embeddedTView(t,s);i&&(i.indexInDeclarationView=r,null!==e?e.push(i):e=[i])}return null!==e?new yO(e):null}template(t,e){for(let r=0;r<this.queries.length;r++)this.queries[r].template(t,e)}getByIndex(t){return this.queries[t]}get length(){return this.queries.length}track(t){this.queries.push(t)}}class EO{constructor(t,e=-1){this.metadata=t,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=e}elementStart(t,e){this.isApplyingToNode(e)&&this.matchTNode(t,e)}elementEnd(t){this._declarationNodeIndex===t.index&&(this._appliesToNextNode=!1)}template(t,e){this.elementStart(t,e)}embeddedTView(t,e){return this.isApplyingToNode(t)?(this.crossesNgTemplate=!0,this.addMatch(-t.index,e),new EO(this.metadata)):null}isApplyingToNode(t){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const e=this._declarationNodeIndex;let r=t.parent;for(;null!==r&&8&r.type&&r.index!==e;)r=r.parent;return e===(null!==r?r.index:-1)}return this._appliesToNextNode}matchTNode(t,e){const r=this.metadata.predicate;if(Array.isArray(r))for(let s=0;s<r.length;s++){const i=r[s];this.matchTNodeWithReadOption(t,e,W6e(e,i)),this.matchTNodeWithReadOption(t,e,Xr(e,t,i,!1,!1))}else r===Al?4&e.type&&this.matchTNodeWithReadOption(t,e,-1):this.matchTNodeWithReadOption(t,e,Xr(e,t,r,!1,!1))}matchTNodeWithReadOption(t,e,r){if(null!==r){const s=this.metadata.read;if(null!==s)if(s===f2||s===Va||s===Al&&4&e.type)this.addMatch(e.index,-2);else{const i=Xr(e,t,s,!1,!1);null!==i&&this.addMatch(e.index,i)}else this.addMatch(e.index,r)}}addMatch(t,e){null===this.matches?this.matches=[t,e]:this.matches.push(t,e)}}function W6e(n,t){const e=n.localNames;if(null!==e)for(let r=0;r<e.length;r+=2)if(e[r]===t)return e[r+1];return null}function j6e(n,t,e,r){return-1===e?function q6e(n,t){return 11&n.type?c0(n,t):4&n.type?cy(n,t):null}(t,n):-2===e?function Z6e(n,t,e){return e===f2?c0(t,n):e===Al?cy(t,n):e===Va?sU(t,n):void 0}(n,t,r):Fs(n,n[1],e,t)}function oU(n,t,e,r){const s=t[19].queries[r];if(null===s.matches){const i=n.data,o=e.matches,c=[];for(let u=0;u<o.length;u+=2){const d=o[u];c.push(d<0?null:j6e(t,i[d],o[u+1],e.metadata.read))}s.matches=c}return s.matches}function MO(n,t,e,r){const s=n.queries.getByIndex(e),i=s.matches;if(null!==i){const o=oU(n,t,s,e);for(let c=0;c<i.length;c+=2){const u=i[c];if(u>0)r.push(o[c/2]);else{const d=i[c+1],g=t[-u];for(let m=10;m<g.length;m++){const y=g[m];y[17]===y[3]&&MO(y[1],y,d,r)}if(null!==g[9]){const m=g[9];for(let y=0;y<m.length;y++){const b=m[y];MO(b[1],b,d,r)}}}}}return r}function wc(n){const t=ze(),e=Jn(),r=Ph();L8(r+1);const s=lU(e,r);if(n.dirty&&function H_(n){return 4==(4&n[2])}(t)===(2==(2&s.metadata.flags))){if(null===s.matches)n.reset([]);else{const i=s.crossesNgTemplate?MO(e,t,r,[]):oU(e,t,s,r);n.reset(i,L7),n.notifyOnChanges()}return!0}return!1}function C4(n,t,e){const r=Jn();r.firstCreatePass&&(function cU(n,t,e){null===n.queries&&(n.queries=new yO),n.queries.track(new EO(t,e))}(r,new iU(n,t,e),-1),2==(2&t)&&(r.staticViewQueries=!0)),function aU(n,t,e){const r=new mO(4==(4&e));Fb(n,t,r,r.destroy),null===t[19]&&(t[19]=new CO),t[19].queries.push(new vO(r))}(r,ze(),t)}function bc(){return function Y6e(n,t){return n[19].queries[t].queryList}(ze(),Ph())}function lU(n,t){return n.queries.getByIndex(t)}function Zn(n,t){return cy(n,t)}function uy(...n){}const fy=new Lt("Application Initializer");let dy=(()=>{class n{constructor(e){this.appInits=e,this.resolve=uy,this.reject=uy,this.initialized=!1,this.done=!1,this.donePromise=new Promise((r,s)=>{this.resolve=r,this.reject=s})}runInitializers(){if(this.initialized)return;const e=[],r=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let s=0;s<this.appInits.length;s++){const i=this.appInits[s]();if(ep(i))e.push(i);else if(nO(i)){const o=new Promise((c,u)=>{i.subscribe({complete:c,error:u})});e.push(o)}}Promise.all(e).then(()=>{r()}).catch(s=>{this.reject(s)}),0===e.length&&r(),this.initialized=!0}}return n.\u0275fac=function(e){return new(e||n)(Ve(fy,8))},n.\u0275prov=rt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const up=new Lt("AppId",{providedIn:"root",factory:function OU(){return`${OO()}${OO()}${OO()}`}});function OO(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const AU=new Lt("Platform Initializer"),fp=new Lt("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),NU=new Lt("appBootstrapListener"),IU=new Lt("AnimationModuleType");let m0e=(()=>{class n{log(e){console.log(e)}warn(e){console.warn(e)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=rt({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})();const y4=new Lt("LocaleId",{providedIn:"root",factory:()=>Dr(y4,Zt.Optional|Zt.SkipSelf)||function _0e(){return typeof $localize<"u"&&$localize.locale||hf}()});class C0e{constructor(t,e){this.ngModuleFactory=t,this.componentFactories=e}}let AO=(()=>{class n{compileModuleSync(e){return new hO(e)}compileModuleAsync(e){return Promise.resolve(this.compileModuleSync(e))}compileModuleAndAllComponentsSync(e){const r=this.compileModuleSync(e),i=ka(ho(e).declarations).reduce((o,c)=>{const u=T1(c);return u&&o.push(new vu(u)),o},[]);return new C0e(r,i)}compileModuleAndAllComponentsAsync(e){return Promise.resolve(this.compileModuleAndAllComponentsSync(e))}clearCache(){}clearCacheFor(e){}getModuleId(e){}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=rt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const M0e=(()=>Promise.resolve(0))();function NO(n){typeof Zone>"u"?M0e.then(()=>{n&&n.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",n)}class Sr{constructor({enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:e=!1,shouldCoalesceRunChangeDetection:r=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new dr(!1),this.onMicrotaskEmpty=new dr(!1),this.onStable=new dr(!1),this.onError=new dr(!1),typeof Zone>"u")throw new Ie(908,!1);Zone.assertZonePatched();const s=this;if(s._nesting=0,s._outer=s._inner=Zone.current,Zone.AsyncStackTaggingZoneSpec){const i=Zone.AsyncStackTaggingZoneSpec;s._inner=s._inner.fork(new i("Angular"))}Zone.TaskTrackingZoneSpec&&(s._inner=s._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(s._inner=s._inner.fork(Zone.longStackTraceZoneSpec)),s.shouldCoalesceEventChangeDetection=!r&&e,s.shouldCoalesceRunChangeDetection=r,s.lastRequestAnimationFrameId=-1,s.nativeRequestAnimationFrame=function S0e(){let n=K1.requestAnimationFrame,t=K1.cancelAnimationFrame;if(typeof Zone<"u"&&n&&t){const e=n[Zone.__symbol__("OriginalDelegate")];e&&(n=e);const r=t[Zone.__symbol__("OriginalDelegate")];r&&(t=r)}return{nativeRequestAnimationFrame:n,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,function w0e(n){const t=()=>{!function T0e(n){n.isCheckStableRunning||-1!==n.lastRequestAnimationFrameId||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(K1,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,xO(n),n.isCheckStableRunning=!0,IO(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),xO(n))}(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(e,r,s,i,o,c)=>{try{return LU(n),e.invokeTask(s,i,o,c)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===i.type||n.shouldCoalesceRunChangeDetection)&&t(),RU(n)}},onInvoke:(e,r,s,i,o,c,u)=>{try{return LU(n),e.invoke(s,i,o,c,u)}finally{n.shouldCoalesceRunChangeDetection&&t(),RU(n)}},onHasTask:(e,r,s,i)=>{e.hasTask(s,i),r===s&&("microTask"==i.change?(n._hasPendingMicrotasks=i.microTask,xO(n),IO(n)):"macroTask"==i.change&&(n.hasPendingMacrotasks=i.macroTask))},onHandleError:(e,r,s,i)=>(e.handleError(s,i),n.runOutsideAngular(()=>n.onError.emit(i)),!1)})}(s)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Sr.isInAngularZone())throw new Ie(909,!1)}static assertNotInAngularZone(){if(Sr.isInAngularZone())throw new Ie(909,!1)}run(t,e,r){return this._inner.run(t,e,r)}runTask(t,e,r,s){const i=this._inner,o=i.scheduleEventTask("NgZoneEvent: "+s,t,P0e,uy,uy);try{return i.runTask(o,e,r)}finally{i.cancelTask(o)}}runGuarded(t,e,r){return this._inner.runGuarded(t,e,r)}runOutsideAngular(t){return this._outer.run(t)}}const P0e={};function IO(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function xO(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&-1!==n.lastRequestAnimationFrameId)}function LU(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function RU(n){n._nesting--,IO(n)}class b0e{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new dr,this.onMicrotaskEmpty=new dr,this.onStable=new dr,this.onError=new dr}run(t,e,r){return t.apply(e,r)}runGuarded(t,e,r){return t.apply(e,r)}runOutsideAngular(t){return t()}runTask(t,e,r,s){return t.apply(e,r)}}const DU=new Lt(""),hy=new Lt("");let RO,kO=(()=>{class n{constructor(e,r,s){this._ngZone=e,this.registry=r,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,RO||(function O0e(n){RO=n}(s),s.addToWindow(r)),this._watchAngularEvents(),e.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Sr.assertNotInAngularZone(),NO(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())NO(()=>{for(;0!==this._callbacks.length;){let e=this._callbacks.pop();clearTimeout(e.timeoutId),e.doneCb(this._didWork)}this._didWork=!1});else{let e=this.getPendingTasks();this._callbacks=this._callbacks.filter(r=>!r.updateCb||!r.updateCb(e)||(clearTimeout(r.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(e=>({source:e.source,creationLocation:e.creationLocation,data:e.data})):[]}addCallback(e,r,s){let i=-1;r&&r>0&&(i=setTimeout(()=>{this._callbacks=this._callbacks.filter(o=>o.timeoutId!==i),e(this._didWork,this.getPendingTasks())},r)),this._callbacks.push({doneCb:e,timeoutId:i,updateCb:s})}whenStable(e,r,s){if(s&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(e,r,s),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(e){this.registry.registerApplication(e,this)}unregisterApplication(e){this.registry.unregisterApplication(e)}findProviders(e,r,s){return[]}}return n.\u0275fac=function(e){return new(e||n)(Ve(Sr),Ve(LO),Ve(hy))},n.\u0275prov=rt({token:n,factory:n.\u0275fac}),n})(),LO=(()=>{class n{constructor(){this._applications=new Map}registerApplication(e,r){this._applications.set(e,r)}unregisterApplication(e){this._applications.delete(e)}unregisterAllApplications(){this._applications.clear()}getTestability(e){return this._applications.get(e)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(e,r=!0){return RO?.findTestabilityInTree(this,e,r)??null}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=rt({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})(),y0=null;const zU=new Lt("AllowMultipleToken"),DO=new Lt("PlatformDestroyListeners");class VU{constructor(t,e){this.name=t,this.token=e}}function FU(n,t,e=[]){const r=`Platform: ${t}`,s=new Lt(r);return(i=[])=>{let o=zO();if(!o||o.injector.get(zU,!1)){const c=[...e,...i,{provide:s,useValue:!0}];n?n(c):function I0e(n){if(y0&&!y0.get(zU,!1))throw new Ie(400,!1);y0=n;const t=n.get($U);(function HU(n){const t=n.get(AU,null);t&&t.forEach(e=>e())})(n)}(function BU(n=[],t){return fi.create({name:t,providers:[{provide:s9,useValue:"platform"},{provide:DO,useValue:new Set([()=>y0=null])},...n]})}(c,r))}return function k0e(n){const t=zO();if(!t)throw new Ie(401,!1);return t}()}}function zO(){return y0?.get($U)??null}let $U=(()=>{class n{constructor(e){this._injector=e,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(e,r){const s=function GU(n,t){let e;return e="noop"===n?new b0e:("zone.js"===n?void 0:n)||new Sr(t),e}(r?.ngZone,function UU(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!(!n||!n.ngZoneEventCoalescing)||!1,shouldCoalesceRunChangeDetection:!(!n||!n.ngZoneRunCoalescing)||!1}}(r)),i=[{provide:Sr,useValue:s}];return s.run(()=>{const o=fi.create({providers:i,parent:this.injector,name:e.moduleType.name}),c=e.create(o),u=c.injector.get(f0,null);if(!u)throw new Ie(402,!1);return s.runOutsideAngular(()=>{const d=s.onError.subscribe({next:g=>{u.handleError(g)}});c.onDestroy(()=>{py(this._modules,c),d.unsubscribe()})}),function WU(n,t,e){try{const r=e();return ep(r)?r.catch(s=>{throw t.runOutsideAngular(()=>n.handleError(s)),s}):r}catch(r){throw t.runOutsideAngular(()=>n.handleError(r)),r}}(u,s,()=>{const d=c.injector.get(dy);return d.runInitializers(),d.donePromise.then(()=>(C$(c.injector.get(y4,hf)||hf),this._moduleDoBootstrap(c),c))})})}bootstrapModule(e,r=[]){const s=qU({},r);return function A0e(n,t,e){const r=new hO(e);return Promise.resolve(r)}(0,0,e).then(i=>this.bootstrapModuleFactory(i,s))}_moduleDoBootstrap(e){const r=e.injector.get(dp);if(e._bootstrapComponents.length>0)e._bootstrapComponents.forEach(s=>r.bootstrap(s));else{if(!e.instance.ngDoBootstrap)throw new Ie(403,!1);e.instance.ngDoBootstrap(r)}this._modules.push(e)}onDestroy(e){this._destroyListeners.push(e)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Ie(404,!1);this._modules.slice().forEach(r=>r.destroy()),this._destroyListeners.forEach(r=>r());const e=this._injector.get(DO,null);e&&(e.forEach(r=>r()),e.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return n.\u0275fac=function(e){return new(e||n)(Ve(fi))},n.\u0275prov=rt({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})();function qU(n,t){return Array.isArray(t)?t.reduce(qU,n):{...n,...t}}let dp=(()=>{class n{constructor(e,r,s){this._zone=e,this._injector=r,this._exceptionHandler=s,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this._destroyed=!1,this._destroyListeners=[],this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const i=new Cr(c=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{c.next(this._stable),c.complete()})}),o=new Cr(c=>{let u;this._zone.runOutsideAngular(()=>{u=this._zone.onStable.subscribe(()=>{Sr.assertNotInAngularZone(),NO(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,c.next(!0))})})});const d=this._zone.onUnstable.subscribe(()=>{Sr.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{c.next(!1)}))});return()=>{u.unsubscribe(),d.unsubscribe()}});this.isStable=function S_(...n){const t=X3(n),e=function $5(n,t){return"number"==typeof rl(n)?n.pop():t}(n,1/0),r=n;return r.length?1===r.length?uo(r[0]):nl(e)(us(r,t)):hc}(i,o.pipe(function CT(n={}){const{connector:t=(()=>new F2),resetOnError:e=!0,resetOnComplete:r=!0,resetOnRefCountZero:s=!0}=n;return i=>{let o,c,u,d=0,g=!1,m=!1;const y=()=>{c?.unsubscribe(),c=void 0},b=()=>{y(),o=u=void 0,g=m=!1},k=()=>{const $=o;b(),$?.unsubscribe()};return fr(($,K)=>{d++,!m&&!g&&y();const oe=u=u??t();K.add(()=>{d--,0===d&&!m&&!g&&(c=W5(k,s))}),oe.subscribe(K),!o&&d>0&&(o=new ir({next:ye=>oe.next(ye),error:ye=>{m=!0,y(),c=W5(b,e,ye),oe.error(ye)},complete:()=>{g=!0,y(),c=W5(b,r),oe.complete()}}),uo($).subscribe(o))})(i)}}()))}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(e,r){const s=e instanceof Lv;if(!this._injector.get(dy).done)throw!s&&function ol(n){const t=T1(n)||Qi(n)||Ji(n);return null!==t&&t.standalone}(e),new Ie(405,false);let o;o=s?e:this._injector.get(xa).resolveComponentFactory(e),this.componentTypes.push(o.componentType);const c=function N0e(n){return n.isBoundToModule}(o)?void 0:this._injector.get(Eu),d=o.create(fi.NULL,[],r||o.selector,c),g=d.location.nativeElement,m=d.injector.get(DU,null);return m?.registerApplication(g),d.onDestroy(()=>{this.detachView(d.hostView),py(this.components,d),m?.unregisterApplication(g)}),this._loadComponent(d),d}tick(){if(this._runningTick)throw new Ie(101,!1);try{this._runningTick=!0;for(let e of this._views)e.detectChanges()}catch(e){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(e))}finally{this._runningTick=!1}}attachView(e){const r=e;this._views.push(r),r.attachToAppRef(this)}detachView(e){const r=e;py(this._views,r),r.detachFromAppRef()}_loadComponent(e){this.attachView(e.hostView),this.tick(),this.components.push(e),this._injector.get(NU,[]).concat(this._bootstrapListeners).forEach(s=>s(e))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(e=>e()),this._views.slice().forEach(e=>e.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(e){return this._destroyListeners.push(e),()=>py(this._destroyListeners,e)}destroy(){if(this._destroyed)throw new Ie(406,!1);const e=this._injector;e.destroy&&!e.destroyed&&e.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return n.\u0275fac=function(e){return new(e||n)(Ve(Sr),Ve(Ia),Ve(f0))},n.\u0275prov=rt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function py(n,t){const e=n.indexOf(t);e>-1&&n.splice(e,1)}let ZU=!0,Mu=(()=>{class n{}return n.__NG_ELEMENT_ID__=D0e,n})();function D0e(n){return function z0e(n,t,e){if(Xo(n)&&!e){const r=bi(n.index,t);return new uf(r,r)}return 47&n.type?new uf(t[16],t):null}(Rr(),ze(),16==(16&n))}class JU{constructor(){}supports(t){return Fe(t)}create(t){return new U0e(t)}}const $0e=(n,t)=>t;class U0e{constructor(t){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=t||$0e}forEachItem(t){let e;for(e=this._itHead;null!==e;e=e._next)t(e)}forEachOperation(t){let e=this._itHead,r=this._removalsHead,s=0,i=null;for(;e||r;){const o=!r||e&&e.currentIndex<tG(r,s,i)?e:r,c=tG(o,s,i),u=o.currentIndex;if(o===r)s--,r=r._nextRemoved;else if(e=e._next,null==o.previousIndex)s++;else{i||(i=[]);const d=c-s,g=u-s;if(d!=g){for(let y=0;y<d;y++){const b=y<i.length?i[y]:i[y]=0,k=b+y;g<=k&&k<d&&(i[y]=b+1)}i[o.previousIndex]=g-d}}c!==u&&t(o,c,u)}}forEachPreviousItem(t){let e;for(e=this._previousItHead;null!==e;e=e._nextPrevious)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}forEachMovedItem(t){let e;for(e=this._movesHead;null!==e;e=e._nextMoved)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}forEachIdentityChange(t){let e;for(e=this._identityChangesHead;null!==e;e=e._nextIdentityChange)t(e)}diff(t){if(null==t&&(t=[]),!Fe(t))throw new Ie(900,!1);return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let s,i,o,e=this._itHead,r=!1;if(Array.isArray(t)){this.length=t.length;for(let c=0;c<this.length;c++)i=t[c],o=this._trackByFn(c,i),null!==e&&Object.is(e.trackById,o)?(r&&(e=this._verifyReinsertion(e,i,o,c)),Object.is(e.item,i)||this._addIdentityChange(e,i)):(e=this._mismatch(e,i,o,c),r=!0),e=e._next}else s=0,function it(n,t){if(Array.isArray(n))for(let e=0;e<n.length;e++)t(n[e]);else{const e=n[be()]();let r;for(;!(r=e.next()).done;)t(r.value)}}(t,c=>{o=this._trackByFn(s,c),null!==e&&Object.is(e.trackById,o)?(r&&(e=this._verifyReinsertion(e,c,o,s)),Object.is(e.item,c)||this._addIdentityChange(e,c)):(e=this._mismatch(e,c,o,s),r=!0),e=e._next,s++}),this.length=s;return this._truncate(e),this.collection=t,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let t;for(t=this._previousItHead=this._itHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._additionsHead;null!==t;t=t._nextAdded)t.previousIndex=t.currentIndex;for(this._additionsHead=this._additionsTail=null,t=this._movesHead;null!==t;t=t._nextMoved)t.previousIndex=t.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(t,e,r,s){let i;return null===t?i=this._itTail:(i=t._prev,this._remove(t)),null!==(t=null===this._unlinkedRecords?null:this._unlinkedRecords.get(r,null))?(Object.is(t.item,e)||this._addIdentityChange(t,e),this._reinsertAfter(t,i,s)):null!==(t=null===this._linkedRecords?null:this._linkedRecords.get(r,s))?(Object.is(t.item,e)||this._addIdentityChange(t,e),this._moveAfter(t,i,s)):t=this._addAfter(new G0e(e,r),i,s),t}_verifyReinsertion(t,e,r,s){let i=null===this._unlinkedRecords?null:this._unlinkedRecords.get(r,null);return null!==i?t=this._reinsertAfter(i,t._prev,s):t.currentIndex!=s&&(t.currentIndex=s,this._addToMoves(t,s)),t}_truncate(t){for(;null!==t;){const e=t._next;this._addToRemovals(this._unlink(t)),t=e}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(t,e,r){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(t);const s=t._prevRemoved,i=t._nextRemoved;return null===s?this._removalsHead=i:s._nextRemoved=i,null===i?this._removalsTail=s:i._prevRemoved=s,this._insertAfter(t,e,r),this._addToMoves(t,r),t}_moveAfter(t,e,r){return this._unlink(t),this._insertAfter(t,e,r),this._addToMoves(t,r),t}_addAfter(t,e,r){return this._insertAfter(t,e,r),this._additionsTail=null===this._additionsTail?this._additionsHead=t:this._additionsTail._nextAdded=t,t}_insertAfter(t,e,r){const s=null===e?this._itHead:e._next;return t._next=s,t._prev=e,null===s?this._itTail=t:s._prev=t,null===e?this._itHead=t:e._next=t,null===this._linkedRecords&&(this._linkedRecords=new eG),this._linkedRecords.put(t),t.currentIndex=r,t}_remove(t){return this._addToRemovals(this._unlink(t))}_unlink(t){null!==this._linkedRecords&&this._linkedRecords.remove(t);const e=t._prev,r=t._next;return null===e?this._itHead=r:e._next=r,null===r?this._itTail=e:r._prev=e,t}_addToMoves(t,e){return t.previousIndex===e||(this._movesTail=null===this._movesTail?this._movesHead=t:this._movesTail._nextMoved=t),t}_addToRemovals(t){return null===this._unlinkedRecords&&(this._unlinkedRecords=new eG),this._unlinkedRecords.put(t),t.currentIndex=null,t._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=t,t._prevRemoved=null):(t._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=t),t}_addIdentityChange(t,e){return t.item=e,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=t:this._identityChangesTail._nextIdentityChange=t,t}}class G0e{constructor(t,e){this.item=t,this.trackById=e,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class W0e{constructor(){this._head=null,this._tail=null}add(t){null===this._head?(this._head=this._tail=t,t._nextDup=null,t._prevDup=null):(this._tail._nextDup=t,t._prevDup=this._tail,t._nextDup=null,this._tail=t)}get(t,e){let r;for(r=this._head;null!==r;r=r._nextDup)if((null===e||e<=r.currentIndex)&&Object.is(r.trackById,t))return r;return null}remove(t){const e=t._prevDup,r=t._nextDup;return null===e?this._head=r:e._nextDup=r,null===r?this._tail=e:r._prevDup=e,null===this._head}}class eG{constructor(){this.map=new Map}put(t){const e=t.trackById;let r=this.map.get(e);r||(r=new W0e,this.map.set(e,r)),r.add(t)}get(t,e){const s=this.map.get(t);return s?s.get(t,e):null}remove(t){const e=t.trackById;return this.map.get(e).remove(t)&&this.map.delete(e),t}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function tG(n,t,e){const r=n.previousIndex;if(null===r)return r;let s=0;return e&&r<e.length&&(s=e[r]),r+t+s}class nG{constructor(){}supports(t){return t instanceof Map||Ct(t)}create(){return new q0e}}class q0e{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(t){let e;for(e=this._mapHead;null!==e;e=e._next)t(e)}forEachPreviousItem(t){let e;for(e=this._previousMapHead;null!==e;e=e._nextPrevious)t(e)}forEachChangedItem(t){let e;for(e=this._changesHead;null!==e;e=e._nextChanged)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}diff(t){if(t){if(!(t instanceof Map||Ct(t)))throw new Ie(900,!1)}else t=new Map;return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let e=this._mapHead;if(this._appendAfter=null,this._forEach(t,(r,s)=>{if(e&&e.key===s)this._maybeAddToChanges(e,r),this._appendAfter=e,e=e._next;else{const i=this._getOrCreateRecordForKey(s,r);e=this._insertBeforeOrAppend(e,i)}}),e){e._prev&&(e._prev._next=null),this._removalsHead=e;for(let r=e;null!==r;r=r._nextRemoved)r===this._mapHead&&(this._mapHead=null),this._records.delete(r.key),r._nextRemoved=r._next,r.previousValue=r.currentValue,r.currentValue=null,r._prev=null,r._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(t,e){if(t){const r=t._prev;return e._next=t,e._prev=r,t._prev=e,r&&(r._next=e),t===this._mapHead&&(this._mapHead=e),this._appendAfter=t,t}return this._appendAfter?(this._appendAfter._next=e,e._prev=this._appendAfter):this._mapHead=e,this._appendAfter=e,null}_getOrCreateRecordForKey(t,e){if(this._records.has(t)){const s=this._records.get(t);this._maybeAddToChanges(s,e);const i=s._prev,o=s._next;return i&&(i._next=o),o&&(o._prev=i),s._next=null,s._prev=null,s}const r=new j0e(t);return this._records.set(t,r),r.currentValue=e,this._addToAdditions(r),r}_reset(){if(this.isDirty){let t;for(this._previousMapHead=this._mapHead,t=this._previousMapHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._changesHead;null!==t;t=t._nextChanged)t.previousValue=t.currentValue;for(t=this._additionsHead;null!=t;t=t._nextAdded)t.previousValue=t.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(t,e){Object.is(e,t.currentValue)||(t.previousValue=t.currentValue,t.currentValue=e,this._addToChanges(t))}_addToAdditions(t){null===this._additionsHead?this._additionsHead=this._additionsTail=t:(this._additionsTail._nextAdded=t,this._additionsTail=t)}_addToChanges(t){null===this._changesHead?this._changesHead=this._changesTail=t:(this._changesTail._nextChanged=t,this._changesTail=t)}_forEach(t,e){t instanceof Map?t.forEach(e):Object.keys(t).forEach(r=>e(t[r],r))}}class j0e{constructor(t){this.key=t,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function rG(){return new _y([new JU])}let _y=(()=>{class n{constructor(e){this.factories=e}static create(e,r){if(null!=r){const s=r.factories.slice();e=e.concat(s)}return new n(e)}static extend(e){return{provide:n,useFactory:r=>n.create(e,r||rG()),deps:[[n,new K8,new ui]]}}find(e){const r=this.factories.find(s=>s.supports(e));if(null!=r)return r;throw new Ie(901,!1)}}return n.\u0275prov=rt({token:n,providedIn:"root",factory:rG}),n})();function sG(){return new hp([new nG])}let hp=(()=>{class n{constructor(e){this.factories=e}static create(e,r){if(r){const s=r.factories.slice();e=e.concat(s)}return new n(e)}static extend(e){return{provide:n,useFactory:r=>n.create(e,r||sG()),deps:[[n,new K8,new ui]]}}find(e){const r=this.factories.find(s=>s.supports(e));if(r)return r;throw new Ie(901,!1)}}return n.\u0275prov=rt({token:n,providedIn:"root",factory:sG}),n})();const K0e=FU(null,"core",[]);let X0e=(()=>{class n{constructor(e){}}return n.\u0275fac=function(e){return new(e||n)(Ve(dp))},n.\u0275mod=oi({type:n}),n.\u0275inj=Yr({}),n})();function Il(n){return"boolean"==typeof n?n:null!=n&&"false"!==n}let vy=null;function E4(){return vy}const $s=new Lt("DocumentToken");let $O=(()=>{class n{historyGo(e){throw new Error("Not implemented")}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=rt({token:n,factory:function(){return function t8e(){return Ve(iG)}()},providedIn:"platform"}),n})();const n8e=new Lt("Location Initialized");let iG=(()=>{class n extends $O{constructor(e){super(),this._doc=e,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return E4().getBaseHref(this._doc)}onPopState(e){const r=E4().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",e,!1),()=>r.removeEventListener("popstate",e)}onHashChange(e){const r=E4().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",e,!1),()=>r.removeEventListener("hashchange",e)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(e){this.location.pathname=e}pushState(e,r,s){oG()?this._history.pushState(e,r,s):this.location.hash=s}replaceState(e,r,s){oG()?this._history.replaceState(e,r,s):this.location.hash=s}forward(){this._history.forward()}back(){this._history.back()}historyGo(e=0){this._history.go(e)}getState(){return this._history.state}}return n.\u0275fac=function(e){return new(e||n)(Ve($s))},n.\u0275prov=rt({token:n,factory:function(){return function r8e(){return new iG(Ve($s))}()},providedIn:"platform"}),n})();function oG(){return!!window.history.pushState}function UO(n,t){if(0==n.length)return t;if(0==t.length)return n;let e=0;return n.endsWith("/")&&e++,t.startsWith("/")&&e++,2==e?n+t.substring(1):1==e?n+t:n+"/"+t}function aG(n){const t=n.match(/#|\?|$/),e=t&&t.index||n.length;return n.slice(0,e-("/"===n[e-1]?1:0))+n.slice(e)}function xl(n){return n&&"?"!==n[0]?"?"+n:n}let Pu=(()=>{class n{historyGo(e){throw new Error("Not implemented")}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=rt({token:n,factory:function(){return Dr(lG)},providedIn:"root"}),n})();const cG=new Lt("appBaseHref");let lG=(()=>{class n extends Pu{constructor(e,r){super(),this._platformLocation=e,this._removeListenerFns=[],this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??Dr($s).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}prepareExternalUrl(e){return UO(this._baseHref,e)}path(e=!1){const r=this._platformLocation.pathname+xl(this._platformLocation.search),s=this._platformLocation.hash;return s&&e?`${r}${s}`:r}pushState(e,r,s,i){const o=this.prepareExternalUrl(s+xl(i));this._platformLocation.pushState(e,r,o)}replaceState(e,r,s,i){const o=this.prepareExternalUrl(s+xl(i));this._platformLocation.replaceState(e,r,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(e=0){this._platformLocation.historyGo?.(e)}}return n.\u0275fac=function(e){return new(e||n)(Ve($O),Ve(cG,8))},n.\u0275prov=rt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),s8e=(()=>{class n extends Pu{constructor(e,r){super(),this._platformLocation=e,this._baseHref="",this._removeListenerFns=[],null!=r&&(this._baseHref=r)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}path(e=!1){let r=this._platformLocation.hash;return null==r&&(r="#"),r.length>0?r.substring(1):r}prepareExternalUrl(e){const r=UO(this._baseHref,e);return r.length>0?"#"+r:r}pushState(e,r,s,i){let o=this.prepareExternalUrl(s+xl(i));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.pushState(e,r,o)}replaceState(e,r,s,i){let o=this.prepareExternalUrl(s+xl(i));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.replaceState(e,r,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(e=0){this._platformLocation.historyGo?.(e)}}return n.\u0275fac=function(e){return new(e||n)(Ve($O),Ve(cG,8))},n.\u0275prov=rt({token:n,factory:n.\u0275fac}),n})(),GO=(()=>{class n{constructor(e){this._subject=new dr,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=e;const r=this._locationStrategy.getBaseHref();this._baseHref=aG(uG(r)),this._locationStrategy.onPopState(s=>{this._subject.emit({url:this.path(!0),pop:!0,state:s.state,type:s.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(e=!1){return this.normalize(this._locationStrategy.path(e))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(e,r=""){return this.path()==this.normalize(e+xl(r))}normalize(e){return n.stripTrailingSlash(function o8e(n,t){return n&&t.startsWith(n)?t.substring(n.length):t}(this._baseHref,uG(e)))}prepareExternalUrl(e){return e&&"/"!==e[0]&&(e="/"+e),this._locationStrategy.prepareExternalUrl(e)}go(e,r="",s=null){this._locationStrategy.pushState(s,"",e,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+xl(r)),s)}replaceState(e,r="",s=null){this._locationStrategy.replaceState(s,"",e,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+xl(r)),s)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(e=0){this._locationStrategy.historyGo?.(e)}onUrlChange(e){return this._urlChangeListeners.push(e),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)})),()=>{const r=this._urlChangeListeners.indexOf(e);this._urlChangeListeners.splice(r,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(e="",r){this._urlChangeListeners.forEach(s=>s(e,r))}subscribe(e,r,s){return this._subject.subscribe({next:e,error:r,complete:s})}}return n.normalizeQueryParams=xl,n.joinWithSlash=UO,n.stripTrailingSlash=aG,n.\u0275fac=function(e){return new(e||n)(Ve(Pu))},n.\u0275prov=rt({token:n,factory:function(){return function i8e(){return new GO(Ve(Pu))}()},providedIn:"root"}),n})();function uG(n){return n.replace(/\/index.html$/,"")}var aa=(()=>((aa=aa||{})[aa.Decimal=0]="Decimal",aa[aa.Percent=1]="Percent",aa[aa.Currency=2]="Currency",aa[aa.Scientific=3]="Scientific",aa))(),Ps=(()=>((Ps=Ps||{})[Ps.Format=0]="Format",Ps[Ps.Standalone=1]="Standalone",Ps))(),e1=(()=>((e1=e1||{})[e1.Narrow=0]="Narrow",e1[e1.Abbreviated=1]="Abbreviated",e1[e1.Wide=2]="Wide",e1[e1.Short=3]="Short",e1))(),Jr=(()=>((Jr=Jr||{})[Jr.Short=0]="Short",Jr[Jr.Medium=1]="Medium",Jr[Jr.Long=2]="Long",Jr[Jr.Full=3]="Full",Jr))(),tn=(()=>((tn=tn||{})[tn.Decimal=0]="Decimal",tn[tn.Group=1]="Group",tn[tn.List=2]="List",tn[tn.PercentSign=3]="PercentSign",tn[tn.PlusSign=4]="PlusSign",tn[tn.MinusSign=5]="MinusSign",tn[tn.Exponential=6]="Exponential",tn[tn.SuperscriptingExponent=7]="SuperscriptingExponent",tn[tn.PerMille=8]="PerMille",tn[tn.Infinity=9]="Infinity",tn[tn.NaN=10]="NaN",tn[tn.TimeSeparator=11]="TimeSeparator",tn[tn.CurrencyDecimal=12]="CurrencyDecimal",tn[tn.CurrencyGroup=13]="CurrencyGroup",tn))();function Cy(n,t){return Ac(Po(n)[vt.DateFormat],t)}function yy(n,t){return Ac(Po(n)[vt.TimeFormat],t)}function Ey(n,t){return Ac(Po(n)[vt.DateTimeFormat],t)}function Oc(n,t){const e=Po(n),r=e[vt.NumberSymbols][t];if(typeof r>"u"){if(t===tn.CurrencyDecimal)return e[vt.NumberSymbols][tn.Decimal];if(t===tn.CurrencyGroup)return e[vt.NumberSymbols][tn.Group]}return r}function dG(n){if(!n[vt.ExtraData])throw new Error(`Missing extra locale data for the locale "${n[vt.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function Ac(n,t){for(let e=t;e>-1;e--)if(typeof n[e]<"u")return n[e];throw new Error("Locale data API: locale data undefined")}function qO(n){const[t,e]=n.split(":");return{hours:+t,minutes:+e}}const C8e=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,pp={},y8e=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;var hi=(()=>((hi=hi||{})[hi.Short=0]="Short",hi[hi.ShortGMT=1]="ShortGMT",hi[hi.Long=2]="Long",hi[hi.Extended=3]="Extended",hi))(),un=(()=>((un=un||{})[un.FullYear=0]="FullYear",un[un.Month=1]="Month",un[un.Date=2]="Date",un[un.Hours=3]="Hours",un[un.Minutes=4]="Minutes",un[un.Seconds=5]="Seconds",un[un.FractionalSeconds=6]="FractionalSeconds",un[un.Day=7]="Day",un))(),Rn=(()=>((Rn=Rn||{})[Rn.DayPeriods=0]="DayPeriods",Rn[Rn.Days=1]="Days",Rn[Rn.Months=2]="Months",Rn[Rn.Eras=3]="Eras",Rn))();function hG(n,t,e,r){let s=function A8e(n){if(mG(n))return n;if("number"==typeof n&&!isNaN(n))return new Date(n);if("string"==typeof n){if(n=n.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(n)){const[s,i=1,o=1]=n.split("-").map(c=>+c);return My(s,i-1,o)}const e=parseFloat(n);if(!isNaN(n-e))return new Date(e);let r;if(r=n.match(C8e))return function N8e(n){const t=new Date(0);let e=0,r=0;const s=n[8]?t.setUTCFullYear:t.setFullYear,i=n[8]?t.setUTCHours:t.setHours;n[9]&&(e=Number(n[9]+n[10]),r=Number(n[9]+n[11])),s.call(t,Number(n[1]),Number(n[2])-1,Number(n[3]));const o=Number(n[4]||0)-e,c=Number(n[5]||0)-r,u=Number(n[6]||0),d=Math.floor(1e3*parseFloat("0."+(n[7]||0)));return i.call(t,o,c,u,d),t}(r)}const t=new Date(n);if(!mG(t))throw new Error(`Unable to convert "${n}" into a date`);return t}(n);t=kl(e,t)||t;let c,o=[];for(;t;){if(c=y8e.exec(t),!c){o.push(t);break}{o=o.concat(c.slice(1));const g=o.pop();if(!g)break;t=g}}let u=s.getTimezoneOffset();r&&(u=gG(r,u),s=function O8e(n,t,e){const r=e?-1:1,s=n.getTimezoneOffset();return function b8e(n,t){return(n=new Date(n.getTime())).setMinutes(n.getMinutes()+t),n}(n,r*(gG(t,s)-s))}(s,r,!0));let d="";return o.forEach(g=>{const m=function w8e(n){if(ZO[n])return ZO[n];let t;switch(n){case"G":case"GG":case"GGG":t=hr(Rn.Eras,e1.Abbreviated);break;case"GGGG":t=hr(Rn.Eras,e1.Wide);break;case"GGGGG":t=hr(Rn.Eras,e1.Narrow);break;case"y":t=Gs(un.FullYear,1,0,!1,!0);break;case"yy":t=Gs(un.FullYear,2,0,!0,!0);break;case"yyy":t=Gs(un.FullYear,3,0,!1,!0);break;case"yyyy":t=Gs(un.FullYear,4,0,!1,!0);break;case"Y":t=wy(1);break;case"YY":t=wy(2,!0);break;case"YYY":t=wy(3);break;case"YYYY":t=wy(4);break;case"M":case"L":t=Gs(un.Month,1,1);break;case"MM":case"LL":t=Gs(un.Month,2,1);break;case"MMM":t=hr(Rn.Months,e1.Abbreviated);break;case"MMMM":t=hr(Rn.Months,e1.Wide);break;case"MMMMM":t=hr(Rn.Months,e1.Narrow);break;case"LLL":t=hr(Rn.Months,e1.Abbreviated,Ps.Standalone);break;case"LLLL":t=hr(Rn.Months,e1.Wide,Ps.Standalone);break;case"LLLLL":t=hr(Rn.Months,e1.Narrow,Ps.Standalone);break;case"w":t=jO(1);break;case"ww":t=jO(2);break;case"W":t=jO(1,!0);break;case"d":t=Gs(un.Date,1);break;case"dd":t=Gs(un.Date,2);break;case"c":case"cc":t=Gs(un.Day,1);break;case"ccc":t=hr(Rn.Days,e1.Abbreviated,Ps.Standalone);break;case"cccc":t=hr(Rn.Days,e1.Wide,Ps.Standalone);break;case"ccccc":t=hr(Rn.Days,e1.Narrow,Ps.Standalone);break;case"cccccc":t=hr(Rn.Days,e1.Short,Ps.Standalone);break;case"E":case"EE":case"EEE":t=hr(Rn.Days,e1.Abbreviated);break;case"EEEE":t=hr(Rn.Days,e1.Wide);break;case"EEEEE":t=hr(Rn.Days,e1.Narrow);break;case"EEEEEE":t=hr(Rn.Days,e1.Short);break;case"a":case"aa":case"aaa":t=hr(Rn.DayPeriods,e1.Abbreviated);break;case"aaaa":t=hr(Rn.DayPeriods,e1.Wide);break;case"aaaaa":t=hr(Rn.DayPeriods,e1.Narrow);break;case"b":case"bb":case"bbb":t=hr(Rn.DayPeriods,e1.Abbreviated,Ps.Standalone,!0);break;case"bbbb":t=hr(Rn.DayPeriods,e1.Wide,Ps.Standalone,!0);break;case"bbbbb":t=hr(Rn.DayPeriods,e1.Narrow,Ps.Standalone,!0);break;case"B":case"BB":case"BBB":t=hr(Rn.DayPeriods,e1.Abbreviated,Ps.Format,!0);break;case"BBBB":t=hr(Rn.DayPeriods,e1.Wide,Ps.Format,!0);break;case"BBBBB":t=hr(Rn.DayPeriods,e1.Narrow,Ps.Format,!0);break;case"h":t=Gs(un.Hours,1,-12);break;case"hh":t=Gs(un.Hours,2,-12);break;case"H":t=Gs(un.Hours,1);break;case"HH":t=Gs(un.Hours,2);break;case"m":t=Gs(un.Minutes,1);break;case"mm":t=Gs(un.Minutes,2);break;case"s":t=Gs(un.Seconds,1);break;case"ss":t=Gs(un.Seconds,2);break;case"S":t=Gs(un.FractionalSeconds,1);break;case"SS":t=Gs(un.FractionalSeconds,2);break;case"SSS":t=Gs(un.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":t=Py(hi.Short);break;case"ZZZZZ":t=Py(hi.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":t=Py(hi.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":t=Py(hi.Long);break;default:return null}return ZO[n]=t,t}(g);d+=m?m(s,e,u):"''"===g?"'":g.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),d}function My(n,t,e){const r=new Date(0);return r.setFullYear(n,t,e),r.setHours(0,0,0),r}function kl(n,t){const e=function a8e(n){return Po(n)[vt.LocaleId]}(n);if(pp[e]=pp[e]||{},pp[e][t])return pp[e][t];let r="";switch(t){case"shortDate":r=Cy(n,Jr.Short);break;case"mediumDate":r=Cy(n,Jr.Medium);break;case"longDate":r=Cy(n,Jr.Long);break;case"fullDate":r=Cy(n,Jr.Full);break;case"shortTime":r=yy(n,Jr.Short);break;case"mediumTime":r=yy(n,Jr.Medium);break;case"longTime":r=yy(n,Jr.Long);break;case"fullTime":r=yy(n,Jr.Full);break;case"short":const s=kl(n,"shortTime"),i=kl(n,"shortDate");r=Sy(Ey(n,Jr.Short),[s,i]);break;case"medium":const o=kl(n,"mediumTime"),c=kl(n,"mediumDate");r=Sy(Ey(n,Jr.Medium),[o,c]);break;case"long":const u=kl(n,"longTime"),d=kl(n,"longDate");r=Sy(Ey(n,Jr.Long),[u,d]);break;case"full":const g=kl(n,"fullTime"),m=kl(n,"fullDate");r=Sy(Ey(n,Jr.Full),[g,m])}return r&&(pp[e][t]=r),r}function Sy(n,t){return t&&(n=n.replace(/\{([^}]+)}/g,function(e,r){return null!=t&&r in t?t[r]:e})),n}function O3(n,t,e="-",r,s){let i="";(n<0||s&&n<=0)&&(s?n=1-n:(n=-n,i=e));let o=String(n);for(;o.length<t;)o="0"+o;return r&&(o=o.slice(o.length-t)),i+o}function Gs(n,t,e=0,r=!1,s=!1){return function(i,o){let c=function M8e(n,t){switch(n){case un.FullYear:return t.getFullYear();case un.Month:return t.getMonth();case un.Date:return t.getDate();case un.Hours:return t.getHours();case un.Minutes:return t.getMinutes();case un.Seconds:return t.getSeconds();case un.FractionalSeconds:return t.getMilliseconds();case un.Day:return t.getDay();default:throw new Error(`Unknown DateType value "${n}".`)}}(n,i);if((e>0||c>-e)&&(c+=e),n===un.Hours)0===c&&-12===e&&(c=12);else if(n===un.FractionalSeconds)return function E8e(n,t){return O3(n,3).substring(0,t)}(c,t);const u=Oc(o,tn.MinusSign);return O3(c,t,u,r,s)}}function hr(n,t,e=Ps.Format,r=!1){return function(s,i){return function S8e(n,t,e,r,s,i){switch(e){case Rn.Months:return function u8e(n,t,e){const r=Po(n),i=Ac([r[vt.MonthsFormat],r[vt.MonthsStandalone]],t);return Ac(i,e)}(t,s,r)[n.getMonth()];case Rn.Days:return function l8e(n,t,e){const r=Po(n),i=Ac([r[vt.DaysFormat],r[vt.DaysStandalone]],t);return Ac(i,e)}(t,s,r)[n.getDay()];case Rn.DayPeriods:const o=n.getHours(),c=n.getMinutes();if(i){const d=function p8e(n){const t=Po(n);return dG(t),(t[vt.ExtraData][2]||[]).map(r=>"string"==typeof r?qO(r):[qO(r[0]),qO(r[1])])}(t),g=function g8e(n,t,e){const r=Po(n);dG(r);const i=Ac([r[vt.ExtraData][0],r[vt.ExtraData][1]],t)||[];return Ac(i,e)||[]}(t,s,r),m=d.findIndex(y=>{if(Array.isArray(y)){const[b,k]=y,$=o>=b.hours&&c>=b.minutes,K=o<k.hours||o===k.hours&&c<k.minutes;if(b.hours<k.hours){if($&&K)return!0}else if($||K)return!0}else if(y.hours===o&&y.minutes===c)return!0;return!1});if(-1!==m)return g[m]}return function c8e(n,t,e){const r=Po(n),i=Ac([r[vt.DayPeriodsFormat],r[vt.DayPeriodsStandalone]],t);return Ac(i,e)}(t,s,r)[o<12?0:1];case Rn.Eras:return function f8e(n,t){return Ac(Po(n)[vt.Eras],t)}(t,r)[n.getFullYear()<=0?0:1];default:throw new Error(`unexpected translation type ${e}`)}}(s,i,n,t,e,r)}}function Py(n){return function(t,e,r){const s=-1*r,i=Oc(e,tn.MinusSign),o=s>0?Math.floor(s/60):Math.ceil(s/60);switch(n){case hi.Short:return(s>=0?"+":"")+O3(o,2,i)+O3(Math.abs(s%60),2,i);case hi.ShortGMT:return"GMT"+(s>=0?"+":"")+O3(o,1,i);case hi.Long:return"GMT"+(s>=0?"+":"")+O3(o,2,i)+":"+O3(Math.abs(s%60),2,i);case hi.Extended:return 0===r?"Z":(s>=0?"+":"")+O3(o,2,i)+":"+O3(Math.abs(s%60),2,i);default:throw new Error(`Unknown zone width "${n}"`)}}}function pG(n){return My(n.getFullYear(),n.getMonth(),n.getDate()+(4-n.getDay()))}function jO(n,t=!1){return function(e,r){let s;if(t){const i=new Date(e.getFullYear(),e.getMonth(),1).getDay()-1,o=e.getDate();s=1+Math.floor((o+i)/7)}else{const i=pG(e),o=function T8e(n){const t=My(n,0,1).getDay();return My(n,0,1+(t<=4?4:11)-t)}(i.getFullYear()),c=i.getTime()-o.getTime();s=1+Math.round(c/6048e5)}return O3(s,n,Oc(r,tn.MinusSign))}}function wy(n,t=!1){return function(e,r){return O3(pG(e).getFullYear(),n,Oc(r,tn.MinusSign),t)}}const ZO={};function gG(n,t){n=n.replace(/:/g,"");const e=Date.parse("Jan 01, 1970 00:00:00 "+n)/6e4;return isNaN(e)?t:e}function mG(n){return n instanceof Date&&!isNaN(n.valueOf())}const I8e=/^(\d+)?\.((\d+)(-(\d+))?)?$/;function QO(n){const t=parseInt(n);if(isNaN(t))throw new Error("Invalid integer literal when parsing "+n);return t}function yG(n,t){t=encodeURIComponent(t);for(const e of n.split(";")){const r=e.indexOf("="),[s,i]=-1==r?[e,""]:[e.slice(0,r),e.slice(r+1)];if(s.trim()===t)return decodeURIComponent(i)}return null}let fn=(()=>{class n{constructor(e,r,s,i){this._iterableDiffers=e,this._keyValueDiffers=r,this._ngEl=s,this._renderer=i,this._iterableDiffer=null,this._keyValueDiffer=null,this._initialClasses=[],this._rawClass=null}set klass(e){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof e?e.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}set ngClass(e){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof e?e.split(/\s+/):e,this._rawClass&&(Fe(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}ngDoCheck(){if(this._iterableDiffer){const e=this._iterableDiffer.diff(this._rawClass);e&&this._applyIterableChanges(e)}else if(this._keyValueDiffer){const e=this._keyValueDiffer.diff(this._rawClass);e&&this._applyKeyValueChanges(e)}}_applyKeyValueChanges(e){e.forEachAddedItem(r=>this._toggleClass(r.key,r.currentValue)),e.forEachChangedItem(r=>this._toggleClass(r.key,r.currentValue)),e.forEachRemovedItem(r=>{r.previousValue&&this._toggleClass(r.key,!1)})}_applyIterableChanges(e){e.forEachAddedItem(r=>{if("string"!=typeof r.item)throw new Error(`NgClass can only toggle CSS classes expressed as strings, got ${j1(r.item)}`);this._toggleClass(r.item,!0)}),e.forEachRemovedItem(r=>this._toggleClass(r.item,!1))}_applyClasses(e){e&&(Array.isArray(e)||e instanceof Set?e.forEach(r=>this._toggleClass(r,!0)):Object.keys(e).forEach(r=>this._toggleClass(r,!!e[r])))}_removeClasses(e){e&&(Array.isArray(e)||e instanceof Set?e.forEach(r=>this._toggleClass(r,!1)):Object.keys(e).forEach(r=>this._toggleClass(r,!1)))}_toggleClass(e,r){(e=e.trim())&&e.split(/\s+/g).forEach(s=>{r?this._renderer.addClass(this._ngEl.nativeElement,s):this._renderer.removeClass(this._ngEl.nativeElement,s)})}}return n.\u0275fac=function(e){return new(e||n)(J(_y),J(hp),J(f2),J(yo))},n.\u0275dir=Gt({type:n,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"},standalone:!0}),n})();class G8e{constructor(t,e,r,s){this.$implicit=t,this.ngForOf=e,this.index=r,this.count=s}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let On=(()=>{class n{constructor(e,r,s){this._viewContainer=e,this._template=r,this._differs=s,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(e){this._ngForOf=e,this._ngForOfDirty=!0}set ngForTrackBy(e){this._trackByFn=e}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(e){e&&(this._template=e)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const e=this._ngForOf;!this._differ&&e&&(this._differ=this._differs.find(e).create(this.ngForTrackBy))}if(this._differ){const e=this._differ.diff(this._ngForOf);e&&this._applyChanges(e)}}_applyChanges(e){const r=this._viewContainer;e.forEachOperation((s,i,o)=>{if(null==s.previousIndex)r.createEmbeddedView(this._template,new G8e(s.item,this._ngForOf,-1,-1),null===o?void 0:o);else if(null==o)r.remove(null===i?void 0:i);else if(null!==i){const c=r.get(i);r.move(c,o),SG(c,s)}});for(let s=0,i=r.length;s<i;s++){const c=r.get(s).context;c.index=s,c.count=i,c.ngForOf=this._ngForOf}e.forEachIdentityChange(s=>{SG(r.get(s.currentIndex),s)})}static ngTemplateContextGuard(e,r){return!0}}return n.\u0275fac=function(e){return new(e||n)(J(Va),J(Al),J(_y))},n.\u0275dir=Gt({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0}),n})();function SG(n,t){n.context.$implicit=t.item}let Kt=(()=>{class n{constructor(e,r){this._viewContainer=e,this._context=new q8e,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=r}set ngIf(e){this._context.$implicit=this._context.ngIf=e,this._updateView()}set ngIfThen(e){PG("ngIfThen",e),this._thenTemplateRef=e,this._thenViewRef=null,this._updateView()}set ngIfElse(e){PG("ngIfElse",e),this._elseTemplateRef=e,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(e,r){return!0}}return n.\u0275fac=function(e){return new(e||n)(J(Va),J(Al))},n.\u0275dir=Gt({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0}),n})();class q8e{constructor(){this.$implicit=null,this.ngIf=null}}function PG(n,t){if(t&&!t.createEmbeddedView)throw new Error(`${n} must be a TemplateRef, but received '${j1(t)}'.`)}let bG=(()=>{class n{constructor(e){this._locale=e}transform(e,r,s){if(!function nA(n){return!(null==n||""===n||n!=n)}(e))return null;s=s||this._locale;try{return function z8e(n,t,e){return function KO(n,t,e,r,s,i,o=!1){let c="",u=!1;if(isFinite(n)){let d=function H8e(n){let r,s,i,o,c,t=Math.abs(n)+"",e=0;for((s=t.indexOf("."))>-1&&(t=t.replace(".","")),(i=t.search(/e/i))>0?(s<0&&(s=i),s+=+t.slice(i+1),t=t.substring(0,i)):s<0&&(s=t.length),i=0;"0"===t.charAt(i);i++);if(i===(c=t.length))r=[0],s=1;else{for(c--;"0"===t.charAt(c);)c--;for(s-=i,r=[],o=0;i<=c;i++,o++)r[o]=Number(t.charAt(i))}return s>22&&(r=r.splice(0,21),e=s-1,s=1),{digits:r,exponent:e,integerLen:s}}(n);o&&(d=function V8e(n){if(0===n.digits[0])return n;const t=n.digits.length-n.integerLen;return n.exponent?n.exponent+=2:(0===t?n.digits.push(0,0):1===t&&n.digits.push(0),n.integerLen+=2),n}(d));let g=t.minInt,m=t.minFrac,y=t.maxFrac;if(i){const ye=i.match(I8e);if(null===ye)throw new Error(`${i} is not a valid digit info`);const te=ye[1],Le=ye[3],Ge=ye[5];null!=te&&(g=QO(te)),null!=Le&&(m=QO(Le)),null!=Ge?y=QO(Ge):null!=Le&&m>y&&(y=m)}!function F8e(n,t,e){if(t>e)throw new Error(`The minimum number of digits after fraction (${t}) is higher than the maximum (${e}).`);let r=n.digits,s=r.length-n.integerLen;const i=Math.min(Math.max(t,s),e);let o=i+n.integerLen,c=r[o];if(o>0){r.splice(Math.max(n.integerLen,o));for(let m=o;m<r.length;m++)r[m]=0}else{s=Math.max(0,s),n.integerLen=1,r.length=Math.max(1,o=i+1),r[0]=0;for(let m=1;m<o;m++)r[m]=0}if(c>=5)if(o-1<0){for(let m=0;m>o;m--)r.unshift(0),n.integerLen++;r.unshift(1),n.integerLen++}else r[o-1]++;for(;s<Math.max(0,i);s++)r.push(0);let u=0!==i;const d=t+n.integerLen,g=r.reduceRight(function(m,y,b,k){return k[b]=(y+=m)<10?y:y-10,u&&(0===k[b]&&b>=d?k.pop():u=!1),y>=10?1:0},0);g&&(r.unshift(g),n.integerLen++)}(d,m,y);let b=d.digits,k=d.integerLen;const $=d.exponent;let K=[];for(u=b.every(ye=>!ye);k<g;k++)b.unshift(0);for(;k<0;k++)b.unshift(0);k>0?K=b.splice(k,b.length):(K=b,b=[0]);const oe=[];for(b.length>=t.lgSize&&oe.unshift(b.splice(-t.lgSize,b.length).join(""));b.length>t.gSize;)oe.unshift(b.splice(-t.gSize,b.length).join(""));b.length&&oe.unshift(b.join("")),c=oe.join(Oc(e,r)),K.length&&(c+=Oc(e,s)+K.join("")),$&&(c+=Oc(e,tn.Exponential)+"+"+$)}else c=Oc(e,tn.Infinity);return c=n<0&&!u?t.negPre+c+t.negSuf:t.posPre+c+t.posSuf,c}(n,function XO(n,t="-"){const e={minInt:1,minFrac:0,maxFrac:0,posPre:"",posSuf:"",negPre:"",negSuf:"",gSize:0,lgSize:0},r=n.split(";"),s=r[0],i=r[1],o=-1!==s.indexOf(".")?s.split("."):[s.substring(0,s.lastIndexOf("0")+1),s.substring(s.lastIndexOf("0")+1)],c=o[0],u=o[1]||"";e.posPre=c.substring(0,c.indexOf("#"));for(let g=0;g<u.length;g++){const m=u.charAt(g);"0"===m?e.minFrac=e.maxFrac=g+1:"#"===m?e.maxFrac=g+1:e.posSuf+=m}const d=c.split(",");if(e.gSize=d[1]?d[1].length:0,e.lgSize=d[2]||d[1]?(d[2]||d[1]).length:0,i){const g=s.length-e.posPre.length-e.posSuf.length,m=i.indexOf("#");e.negPre=i.substring(0,m).replace(/'/g,""),e.negSuf=i.slice(m+g).replace(/'/g,"")}else e.negPre=t+e.posPre,e.negSuf=e.posSuf;return e}(function WO(n,t){return Po(n)[vt.NumberFormats][t]}(t,aa.Decimal),Oc(t,tn.MinusSign)),t,tn.Group,tn.Decimal,e)}(function rA(n){if("string"==typeof n&&!isNaN(Number(n)-parseFloat(n)))return Number(n);if("number"!=typeof n)throw new Error(`${n} is not a number`);return n}(e),s,r)}catch(i){throw function A3(n,t){return new Ie(2100,!1)}()}}}return n.\u0275fac=function(e){return new(e||n)(J(y4,16))},n.\u0275pipe=ai({name:"number",type:n,pure:!0,standalone:!0}),n})();let vue=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=oi({type:n}),n.\u0275inj=Yr({}),n})();let Mue=(()=>{class n{}return n.\u0275prov=rt({token:n,providedIn:"root",factory:()=>new Sue(Ve($s),window)}),n})();class Sue{constructor(t,e){this.document=t,this.window=e,this.offset=()=>[0,0]}setOffset(t){this.offset=Array.isArray(t)?()=>t:t}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(t){this.supportsScrolling()&&this.window.scrollTo(t[0],t[1])}scrollToAnchor(t){if(!this.supportsScrolling())return;const e=function Pue(n,t){const e=n.getElementById(t)||n.getElementsByName(t)[0];if(e)return e;if("function"==typeof n.createTreeWalker&&n.body&&(n.body.createShadowRoot||n.body.attachShadow)){const r=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT);let s=r.currentNode;for(;s;){const i=s.shadowRoot;if(i){const o=i.getElementById(t)||i.querySelector(`[name="${t}"]`);if(o)return o}s=r.nextNode()}}return null}(this.document,t);e&&(this.scrollToElement(e),e.focus())}setHistoryScrollRestoration(t){if(this.supportScrollRestoration()){const e=this.window.history;e&&e.scrollRestoration&&(e.scrollRestoration=t)}}scrollToElement(t){const e=t.getBoundingClientRect(),r=e.left+this.window.pageXOffset,s=e.top+this.window.pageYOffset,i=this.offset();this.window.scrollTo(r-i[0],s-i[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const t=AG(this.window.history)||AG(Object.getPrototypeOf(this.window.history));return!(!t||!t.writable&&!t.set)}catch{return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}function AG(n){return Object.getOwnPropertyDescriptor(n,"scrollRestoration")}class NG{}class oA extends class $ue extends class e8e{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){!function J0e(n){vy||(vy=n)}(new oA)}onAndCancel(t,e,r){return t.addEventListener(e,r,!1),()=>{t.removeEventListener(e,r,!1)}}dispatchEvent(t,e){t.dispatchEvent(e)}remove(t){t.parentNode&&t.parentNode.removeChild(t)}createElement(t,e){return(e=e||this.getDefaultDocument()).createElement(t)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(t){return t.nodeType===Node.ELEMENT_NODE}isShadowRoot(t){return t instanceof DocumentFragment}getGlobalEventTarget(t,e){return"window"===e?window:"document"===e?t:"body"===e?t.body:null}getBaseHref(t){const e=function Uue(){return _p=_p||document.querySelector("base"),_p?_p.getAttribute("href"):null}();return null==e?null:function Gue(n){Ay=Ay||document.createElement("a"),Ay.setAttribute("href",n);const t=Ay.pathname;return"/"===t.charAt(0)?t:`/${t}`}(e)}resetBaseElement(){_p=null}getUserAgent(){return window.navigator.userAgent}getCookie(t){return yG(document.cookie,t)}}let Ay,_p=null;const LG=new Lt("TRANSITION_ID"),que=[{provide:fy,useFactory:function Wue(n,t,e){return()=>{e.get(dy).donePromise.then(()=>{const r=E4(),s=t.querySelectorAll(`style[ng-transition="${n}"]`);for(let i=0;i<s.length;i++)r.remove(s[i])})}},deps:[LG,$s,fi],multi:!0}];let Zue=(()=>{class n{build(){return new XMLHttpRequest}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=rt({token:n,factory:n.\u0275fac}),n})();const Ny=new Lt("EventManagerPlugins");let Iy=(()=>{class n{constructor(e,r){this._zone=r,this._eventNameToPlugin=new Map,e.forEach(s=>s.manager=this),this._plugins=e.slice().reverse()}addEventListener(e,r,s){return this._findPluginFor(r).addEventListener(e,r,s)}addGlobalEventListener(e,r,s){return this._findPluginFor(r).addGlobalEventListener(e,r,s)}getZone(){return this._zone}_findPluginFor(e){const r=this._eventNameToPlugin.get(e);if(r)return r;const s=this._plugins;for(let i=0;i<s.length;i++){const o=s[i];if(o.supports(e))return this._eventNameToPlugin.set(e,o),o}throw new Error(`No event manager plugin found for event ${e}`)}}return n.\u0275fac=function(e){return new(e||n)(Ve(Ny),Ve(Sr))},n.\u0275prov=rt({token:n,factory:n.\u0275fac}),n})();class RG{constructor(t){this._doc=t}addGlobalEventListener(t,e,r){const s=E4().getGlobalEventTarget(this._doc,t);if(!s)throw new Error(`Unsupported event target ${s} for event ${e}`);return this.addEventListener(s,e,r)}}let DG=(()=>{class n{constructor(){this._stylesSet=new Set}addStyles(e){const r=new Set;e.forEach(s=>{this._stylesSet.has(s)||(this._stylesSet.add(s),r.add(s))}),this.onStylesAdded(r)}onStylesAdded(e){}getAllStyles(){return Array.from(this._stylesSet)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=rt({token:n,factory:n.\u0275fac}),n})(),vp=(()=>{class n extends DG{constructor(e){super(),this._doc=e,this._hostNodes=new Map,this._hostNodes.set(e.head,[])}_addStylesToHost(e,r,s){e.forEach(i=>{const o=this._doc.createElement("style");o.textContent=i,s.push(r.appendChild(o))})}addHost(e){const r=[];this._addStylesToHost(this._stylesSet,e,r),this._hostNodes.set(e,r)}removeHost(e){const r=this._hostNodes.get(e);r&&r.forEach(zG),this._hostNodes.delete(e)}onStylesAdded(e){this._hostNodes.forEach((r,s)=>{this._addStylesToHost(e,s,r)})}ngOnDestroy(){this._hostNodes.forEach(e=>e.forEach(zG))}}return n.\u0275fac=function(e){return new(e||n)(Ve($s))},n.\u0275prov=rt({token:n,factory:n.\u0275fac}),n})();function zG(n){E4().remove(n)}const aA={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},cA=/%COMP%/g;function xy(n,t,e){for(let r=0;r<t.length;r++){let s=t[r];Array.isArray(s)?xy(n,s,e):(s=s.replace(cA,n),e.push(s))}return e}function FG(n){return t=>{if("__ngUnwrap__"===t)return n;!1===n(t)&&(t.preventDefault(),t.returnValue=!1)}}let ky=(()=>{class n{constructor(e,r,s){this.eventManager=e,this.sharedStylesHost=r,this.appId=s,this.rendererByCompId=new Map,this.defaultRenderer=new lA(e)}createRenderer(e,r){if(!e||!r)return this.defaultRenderer;switch(r.encapsulation){case V1.Emulated:{let s=this.rendererByCompId.get(r.id);return s||(s=new e5e(this.eventManager,this.sharedStylesHost,r,this.appId),this.rendererByCompId.set(r.id,s)),s.applyToHost(e),s}case 1:case V1.ShadowDom:return new t5e(this.eventManager,this.sharedStylesHost,e,r);default:if(!this.rendererByCompId.has(r.id)){const s=xy(r.id,r.styles,[]);this.sharedStylesHost.addStyles(s),this.rendererByCompId.set(r.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return n.\u0275fac=function(e){return new(e||n)(Ve(Iy),Ve(vp),Ve(up))},n.\u0275prov=rt({token:n,factory:n.\u0275fac}),n})();class lA{constructor(t){this.eventManager=t,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(t,e){return e?document.createElementNS(aA[e]||e,t):document.createElement(t)}createComment(t){return document.createComment(t)}createText(t){return document.createTextNode(t)}appendChild(t,e){($G(t)?t.content:t).appendChild(e)}insertBefore(t,e,r){t&&($G(t)?t.content:t).insertBefore(e,r)}removeChild(t,e){t&&t.removeChild(e)}selectRootElement(t,e){let r="string"==typeof t?document.querySelector(t):t;if(!r)throw new Error(`The selector "${t}" did not match any elements`);return e||(r.textContent=""),r}parentNode(t){return t.parentNode}nextSibling(t){return t.nextSibling}setAttribute(t,e,r,s){if(s){e=s+":"+e;const i=aA[s];i?t.setAttributeNS(i,e,r):t.setAttribute(e,r)}else t.setAttribute(e,r)}removeAttribute(t,e,r){if(r){const s=aA[r];s?t.removeAttributeNS(s,e):t.removeAttribute(`${r}:${e}`)}else t.removeAttribute(e)}addClass(t,e){t.classList.add(e)}removeClass(t,e){t.classList.remove(e)}setStyle(t,e,r,s){s&(h2.DashCase|h2.Important)?t.style.setProperty(e,r,s&h2.Important?"important":""):t.style[e]=r}removeStyle(t,e,r){r&h2.DashCase?t.style.removeProperty(e):t.style[e]=""}setProperty(t,e,r){t[e]=r}setValue(t,e){t.nodeValue=e}listen(t,e,r){return"string"==typeof t?this.eventManager.addGlobalEventListener(t,e,FG(r)):this.eventManager.addEventListener(t,e,FG(r))}}function $G(n){return"TEMPLATE"===n.tagName&&void 0!==n.content}class e5e extends lA{constructor(t,e,r,s){super(t),this.component=r;const i=xy(s+"-"+r.id,r.styles,[]);e.addStyles(i),this.contentAttr=function Xue(n){return"_ngcontent-%COMP%".replace(cA,n)}(s+"-"+r.id),this.hostAttr=function Que(n){return"_nghost-%COMP%".replace(cA,n)}(s+"-"+r.id)}applyToHost(t){super.setAttribute(t,this.hostAttr,"")}createElement(t,e){const r=super.createElement(t,e);return super.setAttribute(r,this.contentAttr,""),r}}class t5e extends lA{constructor(t,e,r,s){super(t),this.sharedStylesHost=e,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const i=xy(s.id,s.styles,[]);for(let o=0;o<i.length;o++){const c=document.createElement("style");c.textContent=i[o],this.shadowRoot.appendChild(c)}}nodeOrShadowRoot(t){return t===this.hostEl?this.shadowRoot:t}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(t,e){return super.appendChild(this.nodeOrShadowRoot(t),e)}insertBefore(t,e,r){return super.insertBefore(this.nodeOrShadowRoot(t),e,r)}removeChild(t,e){return super.removeChild(this.nodeOrShadowRoot(t),e)}parentNode(t){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(t)))}}let n5e=(()=>{class n extends RG{constructor(e){super(e)}supports(e){return!0}addEventListener(e,r,s){return e.addEventListener(r,s,!1),()=>this.removeEventListener(e,r,s)}removeEventListener(e,r,s){return e.removeEventListener(r,s)}}return n.\u0275fac=function(e){return new(e||n)(Ve($s))},n.\u0275prov=rt({token:n,factory:n.\u0275fac}),n})();const UG=["alt","control","meta","shift"],r5e={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},s5e={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let i5e=(()=>{class n extends RG{constructor(e){super(e)}supports(e){return null!=n.parseEventName(e)}addEventListener(e,r,s){const i=n.parseEventName(r),o=n.eventCallback(i.fullKey,s,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>E4().onAndCancel(e,i.domEventName,o))}static parseEventName(e){const r=e.toLowerCase().split("."),s=r.shift();if(0===r.length||"keydown"!==s&&"keyup"!==s)return null;const i=n._normalizeKey(r.pop());let o="",c=r.indexOf("code");if(c>-1&&(r.splice(c,1),o="code."),UG.forEach(d=>{const g=r.indexOf(d);g>-1&&(r.splice(g,1),o+=d+".")}),o+=i,0!=r.length||0===i.length)return null;const u={};return u.domEventName=s,u.fullKey=o,u}static matchEventFullKeyCode(e,r){let s=r5e[e.key]||e.key,i="";return r.indexOf("code.")>-1&&(s=e.code,i="code."),!(null==s||!s)&&(s=s.toLowerCase()," "===s?s="space":"."===s&&(s="dot"),UG.forEach(o=>{o!==s&&(0,s5e[o])(e)&&(i+=o+".")}),i+=s,i===r)}static eventCallback(e,r,s){return i=>{n.matchEventFullKeyCode(i,e)&&s.runGuarded(()=>r(i))}}static _normalizeKey(e){return"esc"===e?"escape":e}}return n.\u0275fac=function(e){return new(e||n)(Ve($s))},n.\u0275prov=rt({token:n,factory:n.\u0275fac}),n})();const WG=[{provide:fp,useValue:"browser"},{provide:AU,useValue:function o5e(){oA.makeCurrent()},multi:!0},{provide:$s,useFactory:function c5e(){return function nw(n){Kh=n}(document),document},deps:[]}],l5e=FU(K0e,"browser",WG),qG=new Lt(""),jG=[{provide:hy,useClass:class jue{addToWindow(t){K1.getAngularTestability=(r,s=!0)=>{const i=t.findTestabilityInTree(r,s);if(null==i)throw new Error("Could not find testability for element.");return i},K1.getAllAngularTestabilities=()=>t.getAllTestabilities(),K1.getAllAngularRootElements=()=>t.getAllRootElements(),K1.frameworkStabilizers||(K1.frameworkStabilizers=[]),K1.frameworkStabilizers.push(r=>{const s=K1.getAllAngularTestabilities();let i=s.length,o=!1;const c=function(u){o=o||u,i--,0==i&&r(o)};s.forEach(function(u){u.whenStable(c)})})}findTestabilityInTree(t,e,r){return null==e?null:t.getTestability(e)??(r?E4().isShadowRoot(e)?this.findTestabilityInTree(t,e.host,!0):this.findTestabilityInTree(t,e.parentElement,!0):null)}},deps:[]},{provide:DU,useClass:kO,deps:[Sr,LO,hy]},{provide:kO,useClass:kO,deps:[Sr,LO,hy]}],ZG=[{provide:s9,useValue:"root"},{provide:f0,useFactory:function a5e(){return new f0},deps:[]},{provide:Ny,useClass:n5e,multi:!0,deps:[$s,Sr,fp]},{provide:Ny,useClass:i5e,multi:!0,deps:[$s]},{provide:ky,useClass:ky,deps:[Iy,vp,up]},{provide:l0,useExisting:ky},{provide:DG,useExisting:vp},{provide:vp,useClass:vp,deps:[$s]},{provide:Iy,useClass:Iy,deps:[Ny,Sr]},{provide:NG,useClass:Zue,deps:[]},[]];let YG=(()=>{class n{constructor(e){}static withServerTransition(e){return{ngModule:n,providers:[{provide:up,useValue:e.appId},{provide:LG,useExisting:up},que]}}}return n.\u0275fac=function(e){return new(e||n)(Ve(qG,12))},n.\u0275mod=oi({type:n}),n.\u0275inj=Yr({providers:[...ZG,...jG],imports:[vue,X0e]}),n})(),KG=(()=>{class n{constructor(e){this._doc=e}getTitle(){return this._doc.title}setTitle(e){this._doc.title=e||""}}return n.\u0275fac=function(e){return new(e||n)(Ve($s))},n.\u0275prov=rt({token:n,factory:function(e){let r=null;return r=e?new e:function f5e(){return new KG(Ve($s))}(),r},providedIn:"root"}),n})();typeof window<"u"&&window;let JG=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=rt({token:n,factory:function(e){let r=null;return r=e?new(e||n):Ve(eW),r},providedIn:"root"}),n})(),eW=(()=>{class n extends JG{constructor(e){super(),this._doc=e}sanitize(e,r){if(null==r)return null;switch(e){case X1.NONE:return r;case X1.HTML:return _o(r,"HTML")?mo(r):e9(this._doc,String(r)).toString();case X1.STYLE:return _o(r,"Style")?mo(r):r;case X1.SCRIPT:if(_o(r,"Script"))return mo(r);throw new Error("unsafe value used in a script context");case X1.URL:return _o(r,"URL")?mo(r):sa(String(r));case X1.RESOURCE_URL:if(_o(r,"ResourceURL"))return mo(r);throw new Error("unsafe value used in a resource URL context (see https://g.co/ng/security#xss)");default:throw new Error(`Unexpected SecurityContext ${e} (see https://g.co/ng/security#xss)`)}}bypassSecurityTrustHtml(e){return function pv(n){return new iw(n)}(e)}bypassSecurityTrustStyle(e){return function gv(n){return new ow(n)}(e)}bypassSecurityTrustScript(e){return function cw(n){return new aw(n)}(e)}bypassSecurityTrustUrl(e){return function lw(n){return new fv(n)}(e)}bypassSecurityTrustResourceUrl(e){return function uw(n){return new dv(n)}(e)}}return n.\u0275fac=function(e){return new(e||n)(Ve($s))},n.\u0275prov=rt({token:n,factory:function(e){let r=null;return r=e?new e:function v5e(n){return new eW(n.get($s))}(Ve(fi)),r},providedIn:"root"}),n})();const{isArray:C5e}=Array,{getPrototypeOf:y5e,prototype:E5e,keys:M5e}=Object;function tW(n){if(1===n.length){const t=n[0];if(C5e(t))return{args:t,keys:null};if(function S5e(n){return n&&"object"==typeof n&&y5e(n)===E5e}(t)){const e=M5e(t);return{args:e.map(r=>t[r]),keys:e}}}return{args:n,keys:null}}const{isArray:P5e}=Array;function nW(n){return _n(t=>function T5e(n,t){return P5e(t)?n(...t):n(t)}(n,t))}function rW(n,t){return n.reduce((e,r,s)=>(e[r]=t[s],e),{})}let sW=(()=>{class n{constructor(e,r){this._renderer=e,this._elementRef=r,this.onChange=s=>{},this.onTouched=()=>{}}setProperty(e,r){this._renderer.setProperty(this._elementRef.nativeElement,e,r)}registerOnTouched(e){this.onTouched=e}registerOnChange(e){this.onChange=e}setDisabledState(e){this.setProperty("disabled",e)}}return n.\u0275fac=function(e){return new(e||n)(J(yo),J(f2))},n.\u0275dir=Gt({type:n}),n})(),Tu=(()=>{class n extends sW{}return n.\u0275fac=function(){let t;return function(r){return(t||(t=Mr(n)))(r||n)}}(),n.\u0275dir=Gt({type:n,features:[l]}),n})();const M4=new Lt("NgValueAccessor"),b5e={provide:M4,useExisting:S1(()=>dA),multi:!0};let dA=(()=>{class n extends Tu{writeValue(e){this.setProperty("checked",e)}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=Mr(n)))(r||n)}}(),n.\u0275dir=Gt({type:n,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(e,r){1&e&&ee("change",function(i){return r.onChange(i.target.checked)})("blur",function(){return r.onTouched()})},features:[zr([b5e]),l]}),n})();const O5e={provide:M4,useExisting:S1(()=>S4),multi:!0},N5e=new Lt("CompositionEventMode");let S4=(()=>{class n extends sW{constructor(e,r,s){super(e,r),this._compositionMode=s,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function A5e(){const n=E4()?E4().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}())}writeValue(e){this.setProperty("value",e??"")}_handleInput(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}_compositionStart(){this._composing=!0}_compositionEnd(e){this._composing=!1,this._compositionMode&&this.onChange(e)}}return n.\u0275fac=function(e){return new(e||n)(J(yo),J(f2),J(N5e,8))},n.\u0275dir=Gt({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(e,r){1&e&&ee("input",function(i){return r._handleInput(i.target.value)})("blur",function(){return r.onTouched()})("compositionstart",function(){return r._compositionStart()})("compositionend",function(i){return r._compositionEnd(i.target.value)})},features:[zr([O5e]),l]}),n})();function M0(n){return null==n||("string"==typeof n||Array.isArray(n))&&0===n.length}function iW(n){return null!=n&&"number"==typeof n.length}const K2=new Lt("NgValidators"),S0=new Lt("NgAsyncValidators"),x5e=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class Cp{static min(t){return function oW(n){return t=>{if(M0(t.value)||M0(n))return null;const e=parseFloat(t.value);return!isNaN(e)&&e<n?{min:{min:n,actual:t.value}}:null}}(t)}static max(t){return function aW(n){return t=>{if(M0(t.value)||M0(n))return null;const e=parseFloat(t.value);return!isNaN(e)&&e>n?{max:{max:n,actual:t.value}}:null}}(t)}static required(t){return cW(t)}static requiredTrue(t){return function lW(n){return!0===n.value?null:{required:!0}}(t)}static email(t){return function uW(n){return M0(n.value)||x5e.test(n.value)?null:{email:!0}}(t)}static minLength(t){return function fW(n){return t=>M0(t.value)||!iW(t.value)?null:t.value.length<n?{minlength:{requiredLength:n,actualLength:t.value.length}}:null}(t)}static maxLength(t){return dW(t)}static pattern(t){return function hW(n){if(!n)return Ly;let t,e;return"string"==typeof n?(e="","^"!==n.charAt(0)&&(e+="^"),e+=n,"$"!==n.charAt(n.length-1)&&(e+="$"),t=new RegExp(e)):(e=n.toString(),t=n),r=>{if(M0(r.value))return null;const s=r.value;return t.test(s)?null:{pattern:{requiredPattern:e,actualValue:s}}}}(t)}static nullValidator(t){return null}static compose(t){return CW(t)}static composeAsync(t){return yW(t)}}function cW(n){return M0(n.value)?{required:!0}:null}function dW(n){return t=>iW(t.value)&&t.value.length>n?{maxlength:{requiredLength:n,actualLength:t.value.length}}:null}function Ly(n){return null}function pW(n){return null!=n}function gW(n){return ep(n)?us(n):n}function mW(n){let t={};return n.forEach(e=>{t=null!=e?{...t,...e}:t}),0===Object.keys(t).length?null:t}function _W(n,t){return t.map(e=>e(n))}function vW(n){return n.map(t=>function k5e(n){return!n.validate}(t)?t:e=>t.validate(e))}function CW(n){if(!n)return null;const t=n.filter(pW);return 0==t.length?null:function(e){return mW(_W(e,t))}}function hA(n){return null!=n?CW(vW(n)):null}function yW(n){if(!n)return null;const t=n.filter(pW);return 0==t.length?null:function(e){return function w5e(...n){const t=en(n),{args:e,keys:r}=tW(n),s=new Cr(i=>{const{length:o}=e;if(!o)return void i.complete();const c=new Array(o);let u=o,d=o;for(let g=0;g<o;g++){let m=!1;uo(e[g]).subscribe(ls(i,y=>{m||(m=!0,d--),c[g]=y},()=>u--,void 0,()=>{(!u||!m)&&(d||i.next(r?rW(r,c):c),i.complete())}))}});return t?s.pipe(nW(t)):s}(_W(e,t).map(gW)).pipe(_n(mW))}}function pA(n){return null!=n?yW(vW(n)):null}function EW(n,t){return null===n?[t]:Array.isArray(n)?[...n,t]:[n,t]}function MW(n){return n._rawValidators}function SW(n){return n._rawAsyncValidators}function gA(n){return n?Array.isArray(n)?n:[n]:[]}function Ry(n,t){return Array.isArray(n)?n.includes(t):n===t}function PW(n,t){const e=gA(t);return gA(n).forEach(s=>{Ry(e,s)||e.push(s)}),e}function TW(n,t){return gA(t).filter(e=>!Ry(n,e))}class wW{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(t){this._rawValidators=t||[],this._composedValidatorFn=hA(this._rawValidators)}_setAsyncValidators(t){this._rawAsyncValidators=t||[],this._composedAsyncValidatorFn=pA(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(t){this._onDestroyCallbacks.push(t)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(t=>t()),this._onDestroyCallbacks=[]}reset(t){this.control&&this.control.reset(t)}hasError(t,e){return!!this.control&&this.control.hasError(t,e)}getError(t,e){return this.control?this.control.getError(t,e):null}}class wo extends wW{get formDirective(){return null}get path(){return null}}class P0 extends wW{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class bW{constructor(t){this._cd=t}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let Ll=(()=>{class n extends bW{constructor(e){super(e)}}return n.\u0275fac=function(e){return new(e||n)(J(P0,2))},n.\u0275dir=Gt({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(e,r){2&e&&ey("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)},features:[l]}),n})(),wu=(()=>{class n extends bW{constructor(e){super(e)}}return n.\u0275fac=function(e){return new(e||n)(J(wo,10))},n.\u0275dir=Gt({type:n,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(e,r){2&e&&ey("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)("ng-submitted",r.isSubmitted)},features:[l]}),n})();const yp="VALID",zy="INVALID",mf="PENDING",Ep="DISABLED";function CA(n){return(Vy(n)?n.validators:n)||null}function AW(n){return Array.isArray(n)?hA(n):n||null}function yA(n,t){return(Vy(t)?t.asyncValidators:n)||null}function NW(n){return Array.isArray(n)?pA(n):n||null}function Vy(n){return null!=n&&!Array.isArray(n)&&"object"==typeof n}function IW(n,t,e){const r=n.controls;if(!(t?Object.keys(r):r).length)throw new Ie(1e3,"");if(!r[e])throw new Ie(1001,"")}function xW(n,t,e){n._forEachChild((r,s)=>{if(void 0===e[s])throw new Ie(1002,"")})}class Hy{constructor(t,e){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._rawValidators=t,this._rawAsyncValidators=e,this._composedValidatorFn=AW(this._rawValidators),this._composedAsyncValidatorFn=NW(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn}set validator(t){this._rawValidators=this._composedValidatorFn=t}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(t){this._rawAsyncValidators=this._composedAsyncValidatorFn=t}get parent(){return this._parent}get valid(){return this.status===yp}get invalid(){return this.status===zy}get pending(){return this.status==mf}get disabled(){return this.status===Ep}get enabled(){return this.status!==Ep}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(t){this._rawValidators=t,this._composedValidatorFn=AW(t)}setAsyncValidators(t){this._rawAsyncValidators=t,this._composedAsyncValidatorFn=NW(t)}addValidators(t){this.setValidators(PW(t,this._rawValidators))}addAsyncValidators(t){this.setAsyncValidators(PW(t,this._rawAsyncValidators))}removeValidators(t){this.setValidators(TW(t,this._rawValidators))}removeAsyncValidators(t){this.setAsyncValidators(TW(t,this._rawAsyncValidators))}hasValidator(t){return Ry(this._rawValidators,t)}hasAsyncValidator(t){return Ry(this._rawAsyncValidators,t)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(t={}){this.touched=!0,this._parent&&!t.onlySelf&&this._parent.markAsTouched(t)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(t=>t.markAllAsTouched())}markAsUntouched(t={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(e=>{e.markAsUntouched({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}markAsDirty(t={}){this.pristine=!1,this._parent&&!t.onlySelf&&this._parent.markAsDirty(t)}markAsPristine(t={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(e=>{e.markAsPristine({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}markAsPending(t={}){this.status=mf,!1!==t.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!t.onlySelf&&this._parent.markAsPending(t)}disable(t={}){const e=this._parentMarkedDirty(t.onlySelf);this.status=Ep,this.errors=null,this._forEachChild(r=>{r.disable({...t,onlySelf:!0})}),this._updateValue(),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...t,skipPristineCheck:e}),this._onDisabledChange.forEach(r=>r(!0))}enable(t={}){const e=this._parentMarkedDirty(t.onlySelf);this.status=yp,this._forEachChild(r=>{r.enable({...t,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent}),this._updateAncestors({...t,skipPristineCheck:e}),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(t){this._parent&&!t.onlySelf&&(this._parent.updateValueAndValidity(t),t.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(t){this._parent=t}getRawValue(){return this.value}updateValueAndValidity(t={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===yp||this.status===mf)&&this._runAsyncValidator(t.emitEvent)),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!t.onlySelf&&this._parent.updateValueAndValidity(t)}_updateTreeValidity(t={emitEvent:!0}){this._forEachChild(e=>e._updateTreeValidity(t)),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Ep:yp}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(t){if(this.asyncValidator){this.status=mf,this._hasOwnPendingAsyncValidator=!0;const e=gW(this.asyncValidator(this));this._asyncValidationSubscription=e.subscribe(r=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(r,{emitEvent:t})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(t,e={}){this.errors=t,this._updateControlsErrors(!1!==e.emitEvent)}get(t){let e=t;return null==e||(Array.isArray(e)||(e=e.split(".")),0===e.length)?null:e.reduce((r,s)=>r&&r._find(s),this)}getError(t,e){const r=e?this.get(e):this;return r&&r.errors?r.errors[t]:null}hasError(t,e){return!!this.getError(t,e)}get root(){let t=this;for(;t._parent;)t=t._parent;return t}_updateControlsErrors(t){this.status=this._calculateStatus(),t&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(t)}_initObservables(){this.valueChanges=new dr,this.statusChanges=new dr}_calculateStatus(){return this._allControlsDisabled()?Ep:this.errors?zy:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(mf)?mf:this._anyControlsHaveStatus(zy)?zy:yp}_anyControlsHaveStatus(t){return this._anyControls(e=>e.status===t)}_anyControlsDirty(){return this._anyControls(t=>t.dirty)}_anyControlsTouched(){return this._anyControls(t=>t.touched)}_updatePristine(t={}){this.pristine=!this._anyControlsDirty(),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}_updateTouched(t={}){this.touched=this._anyControlsTouched(),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}_registerOnCollectionChange(t){this._onCollectionChange=t}_setUpdateStrategy(t){Vy(t)&&null!=t.updateOn&&(this._updateOn=t.updateOn)}_parentMarkedDirty(t){return!t&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(t){return null}}class T0 extends Hy{constructor(t,e,r){super(CA(e),yA(r,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(t,e){return this.controls[t]?this.controls[t]:(this.controls[t]=e,e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange),e)}addControl(t,e,r={}){this.registerControl(t,e),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}removeControl(t,e={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}setControl(t,e,r={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],e&&this.registerControl(t,e),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}contains(t){return this.controls.hasOwnProperty(t)&&this.controls[t].enabled}setValue(t,e={}){xW(this,0,t),Object.keys(t).forEach(r=>{IW(this,!0,r),this.controls[r].setValue(t[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){null!=t&&(Object.keys(t).forEach(r=>{const s=this.controls[r];s&&s.patchValue(t[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(t={},e={}){this._forEachChild((r,s)=>{r.reset(t[s],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this._reduceChildren({},(t,e,r)=>(t[r]=e.getRawValue(),t))}_syncPendingControls(){let t=this._reduceChildren(!1,(e,r)=>!!r._syncPendingControls()||e);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_forEachChild(t){Object.keys(this.controls).forEach(e=>{const r=this.controls[e];r&&t(r,e)})}_setUpControls(){this._forEachChild(t=>{t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(t){for(const[e,r]of Object.entries(this.controls))if(this.contains(e)&&t(r))return!0;return!1}_reduceValue(){return this._reduceChildren({},(e,r,s)=>((r.enabled||this.disabled)&&(e[s]=r.value),e))}_reduceChildren(t,e){let r=t;return this._forEachChild((s,i)=>{r=e(r,s,i)}),r}_allControlsDisabled(){for(const t of Object.keys(this.controls))if(this.controls[t].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(t){return this.controls.hasOwnProperty(t)?this.controls[t]:null}}class kW extends T0{}function Fy(n,t){return[...t.path,n]}function Mp(n,t){EA(n,t),t.valueAccessor.writeValue(n.value),n.disabled&&t.valueAccessor.setDisabledState?.(!0),function B5e(n,t){t.valueAccessor.registerOnChange(e=>{n._pendingValue=e,n._pendingChange=!0,n._pendingDirty=!0,"change"===n.updateOn&&LW(n,t)})}(n,t),function U5e(n,t){const e=(r,s)=>{t.valueAccessor.writeValue(r),s&&t.viewToModelUpdate(r)};n.registerOnChange(e),t._registerOnDestroy(()=>{n._unregisterOnChange(e)})}(n,t),function $5e(n,t){t.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,"blur"===n.updateOn&&n._pendingChange&&LW(n,t),"submit"!==n.updateOn&&n.markAsTouched()})}(n,t),function F5e(n,t){if(t.valueAccessor.setDisabledState){const e=r=>{t.valueAccessor.setDisabledState(r)};n.registerOnDisabledChange(e),t._registerOnDestroy(()=>{n._unregisterOnDisabledChange(e)})}}(n,t)}function By(n,t,e=!0){const r=()=>{};t.valueAccessor&&(t.valueAccessor.registerOnChange(r),t.valueAccessor.registerOnTouched(r)),Uy(n,t),n&&(t._invokeOnDestroyCallbacks(),n._registerOnCollectionChange(()=>{}))}function $y(n,t){n.forEach(e=>{e.registerOnValidatorChange&&e.registerOnValidatorChange(t)})}function EA(n,t){const e=MW(n);null!==t.validator?n.setValidators(EW(e,t.validator)):"function"==typeof e&&n.setValidators([e]);const r=SW(n);null!==t.asyncValidator?n.setAsyncValidators(EW(r,t.asyncValidator)):"function"==typeof r&&n.setAsyncValidators([r]);const s=()=>n.updateValueAndValidity();$y(t._rawValidators,s),$y(t._rawAsyncValidators,s)}function Uy(n,t){let e=!1;if(null!==n){if(null!==t.validator){const s=MW(n);if(Array.isArray(s)&&s.length>0){const i=s.filter(o=>o!==t.validator);i.length!==s.length&&(e=!0,n.setValidators(i))}}if(null!==t.asyncValidator){const s=SW(n);if(Array.isArray(s)&&s.length>0){const i=s.filter(o=>o!==t.asyncValidator);i.length!==s.length&&(e=!0,n.setAsyncValidators(i))}}}const r=()=>{};return $y(t._rawValidators,r),$y(t._rawAsyncValidators,r),e}function LW(n,t){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),t.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function RW(n,t){EA(n,t)}function MA(n,t){if(!n.hasOwnProperty("model"))return!1;const e=n.model;return!!e.isFirstChange()||!Object.is(t,e.currentValue)}function zW(n,t){n._syncPendingControls(),t.forEach(e=>{const r=e.control;"submit"===r.updateOn&&r._pendingChange&&(e.viewToModelUpdate(r._pendingValue),r._pendingChange=!1)})}function SA(n,t){if(!t)return null;let e,r,s;return Array.isArray(t),t.forEach(i=>{i.constructor===S4?e=i:function q5e(n){return Object.getPrototypeOf(n.constructor)===Tu}(i)?r=i:s=i}),s||r||e||null}const Z5e={provide:wo,useExisting:S1(()=>Pp)},Sp=(()=>Promise.resolve())();let Pp=(()=>{class n extends wo{constructor(e,r){super(),this.submitted=!1,this._directives=new Set,this.ngSubmit=new dr,this.form=new T0({},hA(e),pA(r))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(e){Sp.then(()=>{const r=this._findContainer(e.path);e.control=r.registerControl(e.name,e.control),Mp(e.control,e),e.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(e)})}getControl(e){return this.form.get(e.path)}removeControl(e){Sp.then(()=>{const r=this._findContainer(e.path);r&&r.removeControl(e.name),this._directives.delete(e)})}addFormGroup(e){Sp.then(()=>{const r=this._findContainer(e.path),s=new T0({});RW(s,e),r.registerControl(e.name,s),s.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(e){Sp.then(()=>{const r=this._findContainer(e.path);r&&r.removeControl(e.name)})}getFormGroup(e){return this.form.get(e.path)}updateModel(e,r){Sp.then(()=>{this.form.get(e.path).setValue(r)})}setValue(e){this.control.setValue(e)}onSubmit(e){return this.submitted=!0,zW(this.form,this._directives),this.ngSubmit.emit(e),"dialog"===e?.target?.method}onReset(){this.resetForm()}resetForm(e){this.form.reset(e),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(e){return e.pop(),e.length?this.form.get(e):this.form}}return n.\u0275fac=function(e){return new(e||n)(J(K2,10),J(S0,10))},n.\u0275dir=Gt({type:n,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(e,r){1&e&&ee("submit",function(i){return r.onSubmit(i)})("reset",function(){return r.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[zr([Z5e]),l]}),n})();function VW(n,t){const e=n.indexOf(t);e>-1&&n.splice(e,1)}function HW(n){return"object"==typeof n&&null!==n&&2===Object.keys(n).length&&"value"in n&&"disabled"in n}const Ha=class extends Hy{constructor(t=null,e,r){super(CA(e),yA(r,e)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(t),this._setUpdateStrategy(e),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),Vy(e)&&(e.nonNullable||e.initialValueIsDefault)&&(this.defaultValue=HW(t)?t.value:t)}setValue(t,e={}){this.value=this._pendingValue=t,this._onChange.length&&!1!==e.emitModelToViewChange&&this._onChange.forEach(r=>r(this.value,!1!==e.emitViewToModelChange)),this.updateValueAndValidity(e)}patchValue(t,e={}){this.setValue(t,e)}reset(t=this.defaultValue,e={}){this._applyFormState(t),this.markAsPristine(e),this.markAsUntouched(e),this.setValue(this.value,e),this._pendingChange=!1}_updateValue(){}_anyControls(t){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(t){this._onChange.push(t)}_unregisterOnChange(t){VW(this._onChange,t)}registerOnDisabledChange(t){this._onDisabledChange.push(t)}_unregisterOnDisabledChange(t){VW(this._onDisabledChange,t)}_forEachChild(t){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(t){HW(t)?(this.value=this._pendingValue=t.value,t.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=t}},X5e={provide:P0,useExisting:S1(()=>Tp)},$W=(()=>Promise.resolve())();let Tp=(()=>{class n extends P0{constructor(e,r,s,i,o){super(),this._changeDetectorRef=o,this.control=new Ha,this._registered=!1,this.update=new dr,this._parent=e,this._setValidators(r),this._setAsyncValidators(s),this.valueAccessor=SA(0,i)}ngOnChanges(e){if(this._checkForErrors(),!this._registered||"name"in e){if(this._registered&&(this._checkName(),this.formDirective)){const r=e.name.previousValue;this.formDirective.removeControl({name:r,path:this._getPath(r)})}this._setUpControl()}"isDisabled"in e&&this._updateDisabled(e),MA(e,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){Mp(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(e){$W.then(()=>{this.control.setValue(e,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(e){const r=e.isDisabled.currentValue,s=0!==r&&Il(r);$W.then(()=>{s&&!this.control.disabled?this.control.disable():!s&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(e){return this._parent?Fy(e,this._parent):[e]}}return n.\u0275fac=function(e){return new(e||n)(J(wo,9),J(K2,10),J(S0,10),J(M4,10),J(Mu,8))},n.\u0275dir=Gt({type:n,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[zr([X5e]),l,n2]}),n})(),bu=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=Gt({type:n,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),n})(),GW=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=oi({type:n}),n.\u0275inj=Yr({}),n})();const t7e={provide:M4,useExisting:S1(()=>Gy),multi:!0};let Gy=(()=>{class n extends Tu{writeValue(e){this.setProperty("value",parseFloat(e))}registerOnChange(e){this.onChange=r=>{e(""==r?null:parseFloat(r))}}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=Mr(n)))(r||n)}}(),n.\u0275dir=Gt({type:n,selectors:[["input","type","range","formControlName",""],["input","type","range","formControl",""],["input","type","range","ngModel",""]],hostBindings:function(e,r){1&e&&ee("change",function(i){return r.onChange(i.target.value)})("input",function(i){return r.onChange(i.target.value)})("blur",function(){return r.onTouched()})},features:[zr([t7e]),l]}),n})();const PA=new Lt("NgModelWithFormControlWarning"),n7e={provide:P0,useExisting:S1(()=>TA)};let TA=(()=>{class n extends P0{constructor(e,r,s,i){super(),this._ngModelWarningConfig=i,this.update=new dr,this._ngModelWarningSent=!1,this._setValidators(e),this._setAsyncValidators(r),this.valueAccessor=SA(0,s)}set isDisabled(e){}ngOnChanges(e){if(this._isControlChanged(e)){const r=e.form.previousValue;r&&By(r,this,!1),Mp(this.form,this),this.form.updateValueAndValidity({emitEvent:!1})}MA(e,this.viewModel)&&(this.form.setValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.form&&By(this.form,this,!1)}get path(){return[]}get control(){return this.form}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}_isControlChanged(e){return e.hasOwnProperty("form")}}return n._ngModelWarningSentOnce=!1,n.\u0275fac=function(e){return new(e||n)(J(K2,10),J(S0,10),J(M4,10),J(PA,8))},n.\u0275dir=Gt({type:n,selectors:[["","formControl",""]],inputs:{form:["formControl","form"],isDisabled:["disabled","isDisabled"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},exportAs:["ngForm"],features:[zr([n7e]),l,n2]}),n})();const r7e={provide:wo,useExisting:S1(()=>Ou)};let Ou=(()=>{class n extends wo{constructor(e,r){super(),this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new dr,this._setValidators(e),this._setAsyncValidators(r)}ngOnChanges(e){this._checkFormPresent(),e.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(Uy(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(e){const r=this.form.get(e.path);return Mp(r,e),r.updateValueAndValidity({emitEvent:!1}),this.directives.push(e),r}getControl(e){return this.form.get(e.path)}removeControl(e){By(e.control||null,e,!1),function j5e(n,t){const e=n.indexOf(t);e>-1&&n.splice(e,1)}(this.directives,e)}addFormGroup(e){this._setUpFormContainer(e)}removeFormGroup(e){this._cleanUpFormContainer(e)}getFormGroup(e){return this.form.get(e.path)}addFormArray(e){this._setUpFormContainer(e)}removeFormArray(e){this._cleanUpFormContainer(e)}getFormArray(e){return this.form.get(e.path)}updateModel(e,r){this.form.get(e.path).setValue(r)}onSubmit(e){return this.submitted=!0,zW(this.form,this.directives),this.ngSubmit.emit(e),"dialog"===e?.target?.method}onReset(){this.resetForm()}resetForm(e){this.form.reset(e),this.submitted=!1}_updateDomValue(){this.directives.forEach(e=>{const r=e.control,s=this.form.get(e.path);r!==s&&(By(r||null,e),(n=>n instanceof Ha)(s)&&(Mp(s,e),e.control=s))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(e){const r=this.form.get(e.path);RW(r,e),r.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(e){if(this.form){const r=this.form.get(e.path);r&&function G5e(n,t){return Uy(n,t)}(r,e)&&r.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){EA(this.form,this),this._oldForm&&Uy(this._oldForm,this)}_checkFormPresent(){}}return n.\u0275fac=function(e){return new(e||n)(J(K2,10),J(S0,10))},n.\u0275dir=Gt({type:n,selectors:[["","formGroup",""]],hostBindings:function(e,r){1&e&&ee("submit",function(i){return r.onSubmit(i)})("reset",function(){return r.onReset()})},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[zr([r7e]),l,n2]}),n})();const o7e={provide:P0,useExisting:S1(()=>_f)};let _f=(()=>{class n extends P0{constructor(e,r,s,i,o){super(),this._ngModelWarningConfig=o,this._added=!1,this.update=new dr,this._ngModelWarningSent=!1,this._parent=e,this._setValidators(r),this._setAsyncValidators(s),this.valueAccessor=SA(0,i)}set isDisabled(e){}ngOnChanges(e){this._added||this._setUpControl(),MA(e,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}get path(){return Fy(null==this.name?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this._added=!0}}return n._ngModelWarningSentOnce=!1,n.\u0275fac=function(e){return new(e||n)(J(wo,13),J(K2,10),J(S0,10),J(M4,10),J(PA,8))},n.\u0275dir=Gt({type:n,selectors:[["","formControlName",""]],inputs:{name:["formControlName","name"],isDisabled:["disabled","isDisabled"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},features:[zr([o7e]),l,n2]}),n})();const a7e={provide:M4,useExisting:S1(()=>Wy),multi:!0};function jW(n,t){return null==n?`${t}`:(t&&"object"==typeof t&&(t="Object"),`${n}: ${t}`.slice(0,50))}let Wy=(()=>{class n extends Tu{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(e){this._compareWith=e}writeValue(e){this.value=e;const s=jW(this._getOptionId(e),e);this.setProperty("value",s)}registerOnChange(e){this.onChange=r=>{this.value=this._getOptionValue(r),e(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(e){for(const r of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(r),e))return r;return null}_getOptionValue(e){const r=function c7e(n){return n.split(":")[0]}(e);return this._optionMap.has(r)?this._optionMap.get(r):e}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=Mr(n)))(r||n)}}(),n.\u0275dir=Gt({type:n,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(e,r){1&e&&ee("change",function(i){return r.onChange(i.target.value)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},features:[zr([a7e]),l]}),n})(),wp=(()=>{class n{constructor(e,r,s){this._element=e,this._renderer=r,this._select=s,this._select&&(this.id=this._select._registerOption())}set ngValue(e){null!=this._select&&(this._select._optionMap.set(this.id,e),this._setElementValue(jW(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._setElementValue(e),this._select&&this._select.writeValue(this._select.value)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return n.\u0275fac=function(e){return new(e||n)(J(f2),J(yo),J(Wy,9))},n.\u0275dir=Gt({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),n})();const l7e={provide:M4,useExisting:S1(()=>OA),multi:!0};function ZW(n,t){return null==n?`${t}`:("string"==typeof t&&(t=`'${t}'`),t&&"object"==typeof t&&(t="Object"),`${n}: ${t}`.slice(0,50))}let OA=(()=>{class n extends Tu{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(e){this._compareWith=e}writeValue(e){let r;if(this.value=e,Array.isArray(e)){const s=e.map(i=>this._getOptionId(i));r=(i,o)=>{i._setSelected(s.indexOf(o.toString())>-1)}}else r=(s,i)=>{s._setSelected(!1)};this._optionMap.forEach(r)}registerOnChange(e){this.onChange=r=>{const s=[],i=r.selectedOptions;if(void 0!==i){const o=i;for(let c=0;c<o.length;c++){const d=this._getOptionValue(o[c].value);s.push(d)}}else{const o=r.options;for(let c=0;c<o.length;c++){const u=o[c];if(u.selected){const d=this._getOptionValue(u.value);s.push(d)}}}this.value=s,e(s)}}_registerOption(e){const r=(this._idCounter++).toString();return this._optionMap.set(r,e),r}_getOptionId(e){for(const r of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(r)._value,e))return r;return null}_getOptionValue(e){const r=function u7e(n){return n.split(":")[0]}(e);return this._optionMap.has(r)?this._optionMap.get(r)._value:e}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=Mr(n)))(r||n)}}(),n.\u0275dir=Gt({type:n,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(e,r){1&e&&ee("change",function(i){return r.onChange(i.target)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},features:[zr([l7e]),l]}),n})(),bp=(()=>{class n{constructor(e,r,s){this._element=e,this._renderer=r,this._select=s,this._select&&(this.id=this._select._registerOption(this))}set ngValue(e){null!=this._select&&(this._value=e,this._setElementValue(ZW(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._select?(this._value=e,this._setElementValue(ZW(this.id,e)),this._select.writeValue(this._select.value)):this._setElementValue(e)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}_setSelected(e){this._renderer.setProperty(this._element.nativeElement,"selected",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return n.\u0275fac=function(e){return new(e||n)(J(f2),J(yo),J(OA,9))},n.\u0275dir=Gt({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),n})();let Au=(()=>{class n{constructor(){this._validator=Ly}ngOnChanges(e){if(this.inputName in e){const r=this.normalizeInput(e[this.inputName].currentValue);this._enabled=this.enabled(r),this._validator=this._enabled?this.createValidator(r):Ly,this._onChange&&this._onChange()}}validate(e){return this._validator(e)}registerOnValidatorChange(e){this._onChange=e}enabled(e){return null!=e}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=Gt({type:n,features:[n2]}),n})();const h7e={provide:K2,useExisting:S1(()=>Nu),multi:!0};let Nu=(()=>{class n extends Au{constructor(){super(...arguments),this.inputName="required",this.normalizeInput=Il,this.createValidator=e=>cW}enabled(e){return e}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=Mr(n)))(r||n)}}(),n.\u0275dir=Gt({type:n,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(e,r){2&e&&z("required",r._enabled?"":null)},inputs:{required:"required"},features:[zr([h7e]),l]}),n})();const _7e={provide:K2,useExisting:S1(()=>AA),multi:!0};let AA=(()=>{class n extends Au{constructor(){super(...arguments),this.inputName="maxlength",this.normalizeInput=e=>function YW(n){return"number"==typeof n?n:parseInt(n,10)}(e),this.createValidator=e=>dW(e)}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=Mr(n)))(r||n)}}(),n.\u0275dir=Gt({type:n,selectors:[["","maxlength","","formControlName",""],["","maxlength","","formControl",""],["","maxlength","","ngModel",""]],hostVars:1,hostBindings:function(e,r){2&e&&z("maxlength",r._enabled?r.maxlength:null)},inputs:{maxlength:"maxlength"},features:[zr([_7e]),l]}),n})(),rq=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=oi({type:n}),n.\u0275inj=Yr({imports:[GW]}),n})(),C7e=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=oi({type:n}),n.\u0275inj=Yr({imports:[rq]}),n})(),sq=(()=>{class n{static withConfig(e){return{ngModule:n,providers:[{provide:PA,useValue:e.warnOnNgModelWithFormControl}]}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=oi({type:n}),n.\u0275inj=Yr({imports:[rq]}),n})();class iq extends Hy{constructor(t,e,r){super(CA(e),yA(r,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(t){return this.controls[this._adjustIndex(t)]}push(t,e={}){this.controls.push(t),this._registerControl(t),this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}insert(t,e,r={}){this.controls.splice(t,0,e),this._registerControl(e),this.updateValueAndValidity({emitEvent:r.emitEvent})}removeAt(t,e={}){let r=this._adjustIndex(t);r<0&&(r=0),this.controls[r]&&this.controls[r]._registerOnCollectionChange(()=>{}),this.controls.splice(r,1),this.updateValueAndValidity({emitEvent:e.emitEvent})}setControl(t,e,r={}){let s=this._adjustIndex(t);s<0&&(s=0),this.controls[s]&&this.controls[s]._registerOnCollectionChange(()=>{}),this.controls.splice(s,1),e&&(this.controls.splice(s,0,e),this._registerControl(e)),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(t,e={}){xW(this,0,t),t.forEach((r,s)=>{IW(this,!1,s),this.at(s).setValue(r,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){null!=t&&(t.forEach((r,s)=>{this.at(s)&&this.at(s).patchValue(r,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(t=[],e={}){this._forEachChild((r,s)=>{r.reset(t[s],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this.controls.map(t=>t.getRawValue())}clear(t={}){this.controls.length<1||(this._forEachChild(e=>e._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:t.emitEvent}))}_adjustIndex(t){return t<0?t+this.length:t}_syncPendingControls(){let t=this.controls.reduce((e,r)=>!!r._syncPendingControls()||e,!1);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_forEachChild(t){this.controls.forEach((e,r)=>{t(e,r)})}_updateValue(){this.value=this.controls.filter(t=>t.enabled||this.disabled).map(t=>t.value)}_anyControls(t){return this.controls.some(e=>e.enabled&&t(e))}_setUpControls(){this._forEachChild(t=>this._registerControl(t))}_allControlsDisabled(){for(const t of this.controls)if(t.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(t){t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)}_find(t){return this.at(t)??null}}function oq(n){return!!n&&(void 0!==n.asyncValidators||void 0!==n.validators||void 0!==n.updateOn)}let y7e=(()=>{class n{constructor(){this.useNonNullable=!1}get nonNullable(){const e=new n;return e.useNonNullable=!0,e}group(e,r=null){const s=this._reduceControls(e);let i={};return oq(r)?i=r:null!==r&&(i.validators=r.validator,i.asyncValidators=r.asyncValidator),new T0(s,i)}record(e,r=null){const s=this._reduceControls(e);return new kW(s,r)}control(e,r,s){let i={};return this.useNonNullable?(oq(r)?i=r:(i.validators=r,i.asyncValidators=s),new Ha(e,{...i,nonNullable:!0})):new Ha(e,r,s)}array(e,r,s){const i=e.map(o=>this._createControl(o));return new iq(i,r,s)}_reduceControls(e){const r={};return Object.keys(e).forEach(s=>{r[s]=this._createControl(e[s])}),r}_createControl(e){return e instanceof Ha||e instanceof Hy?e:Array.isArray(e)?this.control(e[0],e.length>1?e[1]:null,e.length>2?e[2]:null):this.control(e)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=rt({token:n,factory:n.\u0275fac,providedIn:sq}),n})();function Yt(...n){return us(n,X3(n))}function w0(n,t){return cn(t)?He(n,t,1):He(n,1)}function Rl(n,t){return fr((e,r)=>{let s=0;e.subscribe(ls(r,i=>n.call(t,i,s++)&&r.next(i)))})}class aq{}class cq{}class Dl{constructor(t){this.normalizedNames=new Map,this.lazyUpdate=null,t?this.lazyInit="string"==typeof t?()=>{this.headers=new Map,t.split("\n").forEach(e=>{const r=e.indexOf(":");if(r>0){const s=e.slice(0,r),i=s.toLowerCase(),o=e.slice(r+1).trim();this.maybeSetNormalizedName(s,i),this.headers.has(i)?this.headers.get(i).push(o):this.headers.set(i,[o])}})}:()=>{this.headers=new Map,Object.keys(t).forEach(e=>{let r=t[e];const s=e.toLowerCase();"string"==typeof r&&(r=[r]),r.length>0&&(this.headers.set(s,r),this.maybeSetNormalizedName(e,s))})}:this.headers=new Map}has(t){return this.init(),this.headers.has(t.toLowerCase())}get(t){this.init();const e=this.headers.get(t.toLowerCase());return e&&e.length>0?e[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(t){return this.init(),this.headers.get(t.toLowerCase())||null}append(t,e){return this.clone({name:t,value:e,op:"a"})}set(t,e){return this.clone({name:t,value:e,op:"s"})}delete(t,e){return this.clone({name:t,value:e,op:"d"})}maybeSetNormalizedName(t,e){this.normalizedNames.has(e)||this.normalizedNames.set(e,t)}init(){this.lazyInit&&(this.lazyInit instanceof Dl?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(t=>this.applyUpdate(t)),this.lazyUpdate=null))}copyFrom(t){t.init(),Array.from(t.headers.keys()).forEach(e=>{this.headers.set(e,t.headers.get(e)),this.normalizedNames.set(e,t.normalizedNames.get(e))})}clone(t){const e=new Dl;return e.lazyInit=this.lazyInit&&this.lazyInit instanceof Dl?this.lazyInit:this,e.lazyUpdate=(this.lazyUpdate||[]).concat([t]),e}applyUpdate(t){const e=t.name.toLowerCase();switch(t.op){case"a":case"s":let r=t.value;if("string"==typeof r&&(r=[r]),0===r.length)return;this.maybeSetNormalizedName(t.name,e);const s=("a"===t.op?this.headers.get(e):void 0)||[];s.push(...r),this.headers.set(e,s);break;case"d":const i=t.value;if(i){let o=this.headers.get(e);if(!o)return;o=o.filter(c=>-1===i.indexOf(c)),0===o.length?(this.headers.delete(e),this.normalizedNames.delete(e)):this.headers.set(e,o)}else this.headers.delete(e),this.normalizedNames.delete(e)}}forEach(t){this.init(),Array.from(this.normalizedNames.keys()).forEach(e=>t(this.normalizedNames.get(e),this.headers.get(e)))}}class E7e{encodeKey(t){return lq(t)}encodeValue(t){return lq(t)}decodeKey(t){return decodeURIComponent(t)}decodeValue(t){return decodeURIComponent(t)}}const S7e=/%(\d[a-f0-9])/gi,P7e={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function lq(n){return encodeURIComponent(n).replace(S7e,(t,e)=>P7e[e]??t)}function qy(n){return`${n}`}class b0{constructor(t={}){if(this.updates=null,this.cloneFrom=null,this.encoder=t.encoder||new E7e,t.fromString){if(t.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function M7e(n,t){const e=new Map;return n.length>0&&n.replace(/^\?/,"").split("&").forEach(s=>{const i=s.indexOf("="),[o,c]=-1==i?[t.decodeKey(s),""]:[t.decodeKey(s.slice(0,i)),t.decodeValue(s.slice(i+1))],u=e.get(o)||[];u.push(c),e.set(o,u)}),e}(t.fromString,this.encoder)}else t.fromObject?(this.map=new Map,Object.keys(t.fromObject).forEach(e=>{const r=t.fromObject[e],s=Array.isArray(r)?r.map(qy):[qy(r)];this.map.set(e,s)})):this.map=null}has(t){return this.init(),this.map.has(t)}get(t){this.init();const e=this.map.get(t);return e?e[0]:null}getAll(t){return this.init(),this.map.get(t)||null}keys(){return this.init(),Array.from(this.map.keys())}append(t,e){return this.clone({param:t,value:e,op:"a"})}appendAll(t){const e=[];return Object.keys(t).forEach(r=>{const s=t[r];Array.isArray(s)?s.forEach(i=>{e.push({param:r,value:i,op:"a"})}):e.push({param:r,value:s,op:"a"})}),this.clone(e)}set(t,e){return this.clone({param:t,value:e,op:"s"})}delete(t,e){return this.clone({param:t,value:e,op:"d"})}toString(){return this.init(),this.keys().map(t=>{const e=this.encoder.encodeKey(t);return this.map.get(t).map(r=>e+"="+this.encoder.encodeValue(r)).join("&")}).filter(t=>""!==t).join("&")}clone(t){const e=new b0({encoder:this.encoder});return e.cloneFrom=this.cloneFrom||this,e.updates=(this.updates||[]).concat(t),e}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(t=>this.map.set(t,this.cloneFrom.map.get(t))),this.updates.forEach(t=>{switch(t.op){case"a":case"s":const e=("a"===t.op?this.map.get(t.param):void 0)||[];e.push(qy(t.value)),this.map.set(t.param,e);break;case"d":if(void 0===t.value){this.map.delete(t.param);break}{let r=this.map.get(t.param)||[];const s=r.indexOf(qy(t.value));-1!==s&&r.splice(s,1),r.length>0?this.map.set(t.param,r):this.map.delete(t.param)}}}),this.cloneFrom=this.updates=null)}}class T7e{constructor(){this.map=new Map}set(t,e){return this.map.set(t,e),this}get(t){return this.map.has(t)||this.map.set(t,t.defaultValue()),this.map.get(t)}delete(t){return this.map.delete(t),this}has(t){return this.map.has(t)}keys(){return this.map.keys()}}function uq(n){return typeof ArrayBuffer<"u"&&n instanceof ArrayBuffer}function fq(n){return typeof Blob<"u"&&n instanceof Blob}function dq(n){return typeof FormData<"u"&&n instanceof FormData}class Op{constructor(t,e,r,s){let i;if(this.url=e,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=t.toUpperCase(),function w7e(n){switch(n){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||s?(this.body=void 0!==r?r:null,i=s):i=r,i&&(this.reportProgress=!!i.reportProgress,this.withCredentials=!!i.withCredentials,i.responseType&&(this.responseType=i.responseType),i.headers&&(this.headers=i.headers),i.context&&(this.context=i.context),i.params&&(this.params=i.params)),this.headers||(this.headers=new Dl),this.context||(this.context=new T7e),this.params){const o=this.params.toString();if(0===o.length)this.urlWithParams=e;else{const c=e.indexOf("?");this.urlWithParams=e+(-1===c?"?":c<e.length-1?"&":"")+o}}else this.params=new b0,this.urlWithParams=e}serializeBody(){return null===this.body?null:uq(this.body)||fq(this.body)||dq(this.body)||function b7e(n){return typeof URLSearchParams<"u"&&n instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof b0?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||dq(this.body)?null:fq(this.body)?this.body.type||null:uq(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof b0?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(t={}){const e=t.method||this.method,r=t.url||this.url,s=t.responseType||this.responseType,i=void 0!==t.body?t.body:this.body,o=void 0!==t.withCredentials?t.withCredentials:this.withCredentials,c=void 0!==t.reportProgress?t.reportProgress:this.reportProgress;let u=t.headers||this.headers,d=t.params||this.params;const g=t.context??this.context;return void 0!==t.setHeaders&&(u=Object.keys(t.setHeaders).reduce((m,y)=>m.set(y,t.setHeaders[y]),u)),t.setParams&&(d=Object.keys(t.setParams).reduce((m,y)=>m.set(y,t.setParams[y]),d)),new Op(e,r,i,{params:d,headers:u,context:g,reportProgress:c,responseType:s,withCredentials:o})}}var Ws=(()=>((Ws=Ws||{})[Ws.Sent=0]="Sent",Ws[Ws.UploadProgress=1]="UploadProgress",Ws[Ws.ResponseHeader=2]="ResponseHeader",Ws[Ws.DownloadProgress=3]="DownloadProgress",Ws[Ws.Response=4]="Response",Ws[Ws.User=5]="User",Ws))();class NA{constructor(t,e=200,r="OK"){this.headers=t.headers||new Dl,this.status=void 0!==t.status?t.status:e,this.statusText=t.statusText||r,this.url=t.url||null,this.ok=this.status>=200&&this.status<300}}class IA extends NA{constructor(t={}){super(t),this.type=Ws.ResponseHeader}clone(t={}){return new IA({headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}class jy extends NA{constructor(t={}){super(t),this.type=Ws.Response,this.body=void 0!==t.body?t.body:null}clone(t={}){return new jy({body:void 0!==t.body?t.body:this.body,headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}class hq extends NA{constructor(t){super(t,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${t.url||"(unknown url)"}`:`Http failure response for ${t.url||"(unknown url)"}: ${t.status} ${t.statusText}`,this.error=t.error||null}}function xA(n,t){return{body:t,headers:n.headers,context:n.context,observe:n.observe,params:n.params,reportProgress:n.reportProgress,responseType:n.responseType,withCredentials:n.withCredentials}}let O7e=(()=>{class n{constructor(e){this.handler=e}request(e,r,s={}){let i;if(e instanceof Op)i=e;else{let u,d;u=s.headers instanceof Dl?s.headers:new Dl(s.headers),s.params&&(d=s.params instanceof b0?s.params:new b0({fromObject:s.params})),i=new Op(e,r,void 0!==s.body?s.body:null,{headers:u,context:s.context,params:d,reportProgress:s.reportProgress,responseType:s.responseType||"json",withCredentials:s.withCredentials})}const o=Yt(i).pipe(w0(u=>this.handler.handle(u)));if(e instanceof Op||"events"===s.observe)return o;const c=o.pipe(Rl(u=>u instanceof jy));switch(s.observe||"body"){case"body":switch(i.responseType){case"arraybuffer":return c.pipe(_n(u=>{if(null!==u.body&&!(u.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return u.body}));case"blob":return c.pipe(_n(u=>{if(null!==u.body&&!(u.body instanceof Blob))throw new Error("Response is not a Blob.");return u.body}));case"text":return c.pipe(_n(u=>{if(null!==u.body&&"string"!=typeof u.body)throw new Error("Response is not a string.");return u.body}));default:return c.pipe(_n(u=>u.body))}case"response":return c;default:throw new Error(`Unreachable: unhandled observe type ${s.observe}}`)}}delete(e,r={}){return this.request("DELETE",e,r)}get(e,r={}){return this.request("GET",e,r)}head(e,r={}){return this.request("HEAD",e,r)}jsonp(e,r){return this.request("JSONP",e,{params:(new b0).append(r,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(e,r={}){return this.request("OPTIONS",e,r)}patch(e,r,s={}){return this.request("PATCH",e,xA(s,r))}post(e,r,s={}){return this.request("POST",e,xA(s,r))}put(e,r,s={}){return this.request("PUT",e,xA(s,r))}}return n.\u0275fac=function(e){return new(e||n)(Ve(aq))},n.\u0275prov=rt({token:n,factory:n.\u0275fac}),n})();class pq{constructor(t,e){this.next=t,this.interceptor=e}handle(t){return this.interceptor.intercept(t,this.next)}}const gq=new Lt("HTTP_INTERCEPTORS");let A7e=(()=>{class n{intercept(e,r){return r.handle(e)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=rt({token:n,factory:n.\u0275fac}),n})();const N7e=/^\)\]\}',?\n/;let mq=(()=>{class n{constructor(e){this.xhrFactory=e}handle(e){if("JSONP"===e.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new Cr(r=>{const s=this.xhrFactory.build();if(s.open(e.method,e.urlWithParams),e.withCredentials&&(s.withCredentials=!0),e.headers.forEach((b,k)=>s.setRequestHeader(b,k.join(","))),e.headers.has("Accept")||s.setRequestHeader("Accept","application/json, text/plain, */*"),!e.headers.has("Content-Type")){const b=e.detectContentTypeHeader();null!==b&&s.setRequestHeader("Content-Type",b)}if(e.responseType){const b=e.responseType.toLowerCase();s.responseType="json"!==b?b:"text"}const i=e.serializeBody();let o=null;const c=()=>{if(null!==o)return o;const b=s.statusText||"OK",k=new Dl(s.getAllResponseHeaders()),$=function I7e(n){return"responseURL"in n&&n.responseURL?n.responseURL:/^X-Request-URL:/m.test(n.getAllResponseHeaders())?n.getResponseHeader("X-Request-URL"):null}(s)||e.url;return o=new IA({headers:k,status:s.status,statusText:b,url:$}),o},u=()=>{let{headers:b,status:k,statusText:$,url:K}=c(),oe=null;204!==k&&(oe=typeof s.response>"u"?s.responseText:s.response),0===k&&(k=oe?200:0);let ye=k>=200&&k<300;if("json"===e.responseType&&"string"==typeof oe){const te=oe;oe=oe.replace(N7e,"");try{oe=""!==oe?JSON.parse(oe):null}catch(Le){oe=te,ye&&(ye=!1,oe={error:Le,text:oe})}}ye?(r.next(new jy({body:oe,headers:b,status:k,statusText:$,url:K||void 0})),r.complete()):r.error(new hq({error:oe,headers:b,status:k,statusText:$,url:K||void 0}))},d=b=>{const{url:k}=c(),$=new hq({error:b,status:s.status||0,statusText:s.statusText||"Unknown Error",url:k||void 0});r.error($)};let g=!1;const m=b=>{g||(r.next(c()),g=!0);let k={type:Ws.DownloadProgress,loaded:b.loaded};b.lengthComputable&&(k.total=b.total),"text"===e.responseType&&!!s.responseText&&(k.partialText=s.responseText),r.next(k)},y=b=>{let k={type:Ws.UploadProgress,loaded:b.loaded};b.lengthComputable&&(k.total=b.total),r.next(k)};return s.addEventListener("load",u),s.addEventListener("error",d),s.addEventListener("timeout",d),s.addEventListener("abort",d),e.reportProgress&&(s.addEventListener("progress",m),null!==i&&s.upload&&s.upload.addEventListener("progress",y)),s.send(i),r.next({type:Ws.Sent}),()=>{s.removeEventListener("error",d),s.removeEventListener("abort",d),s.removeEventListener("load",u),s.removeEventListener("timeout",d),e.reportProgress&&(s.removeEventListener("progress",m),null!==i&&s.upload&&s.upload.removeEventListener("progress",y)),s.readyState!==s.DONE&&s.abort()}})}}return n.\u0275fac=function(e){return new(e||n)(Ve(NG))},n.\u0275prov=rt({token:n,factory:n.\u0275fac}),n})();const kA=new Lt("XSRF_COOKIE_NAME"),LA=new Lt("XSRF_HEADER_NAME");class _q{}let x7e=(()=>{class n{constructor(e,r,s){this.doc=e,this.platform=r,this.cookieName=s,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const e=this.doc.cookie||"";return e!==this.lastCookieString&&(this.parseCount++,this.lastToken=yG(e,this.cookieName),this.lastCookieString=e),this.lastToken}}return n.\u0275fac=function(e){return new(e||n)(Ve($s),Ve(fp),Ve(kA))},n.\u0275prov=rt({token:n,factory:n.\u0275fac}),n})(),RA=(()=>{class n{constructor(e,r){this.tokenService=e,this.headerName=r}intercept(e,r){const s=e.url.toLowerCase();if("GET"===e.method||"HEAD"===e.method||s.startsWith("http://")||s.startsWith("https://"))return r.handle(e);const i=this.tokenService.getToken();return null!==i&&!e.headers.has(this.headerName)&&(e=e.clone({headers:e.headers.set(this.headerName,i)})),r.handle(e)}}return n.\u0275fac=function(e){return new(e||n)(Ve(_q),Ve(LA))},n.\u0275prov=rt({token:n,factory:n.\u0275fac}),n})(),k7e=(()=>{class n{constructor(e,r){this.backend=e,this.injector=r,this.chain=null}handle(e){if(null===this.chain){const r=this.injector.get(gq,[]);this.chain=r.reduceRight((s,i)=>new pq(s,i),this.backend)}return this.chain.handle(e)}}return n.\u0275fac=function(e){return new(e||n)(Ve(cq),Ve(fi))},n.\u0275prov=rt({token:n,factory:n.\u0275fac}),n})(),L7e=(()=>{class n{static disable(){return{ngModule:n,providers:[{provide:RA,useClass:A7e}]}}static withOptions(e={}){return{ngModule:n,providers:[e.cookieName?{provide:kA,useValue:e.cookieName}:[],e.headerName?{provide:LA,useValue:e.headerName}:[]]}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=oi({type:n}),n.\u0275inj=Yr({providers:[RA,{provide:gq,useExisting:RA,multi:!0},{provide:_q,useClass:x7e},{provide:kA,useValue:"XSRF-TOKEN"},{provide:LA,useValue:"X-XSRF-TOKEN"}]}),n})(),R7e=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=oi({type:n}),n.\u0275inj=Yr({providers:[O7e,{provide:aq,useClass:k7e},mq,{provide:cq,useExisting:mq}],imports:[L7e.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]}),n})();class N3 extends F2{constructor(t){super(),this._value=t}get value(){return this.getValue()}_subscribe(t){const e=super._subscribe(t);return!e.closed&&t.next(this._value),e}getValue(){const{hasError:t,thrownError:e,_value:r}=this;if(t)throw e;return this._throwIfClosed(),r}next(t){super.next(this._value=t)}}const Zy=cs(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function vq(...n){const t=X3(n),e=en(n),{args:r,keys:s}=tW(n);if(0===r.length)return us([],t);const i=new Cr(function D7e(n,t,e=J4){return r=>{Cq(t,()=>{const{length:s}=n,i=new Array(s);let o=s,c=s;for(let u=0;u<s;u++)Cq(t,()=>{const d=us(n[u],t);let g=!1;d.subscribe(ls(r,m=>{i[u]=m,g||(g=!0,c--),c||r.next(e(i.slice()))},()=>{--o||r.complete()}))},r)},r)}}(r,t,s?o=>rW(s,o):J4));return e?i.pipe(nW(e)):i}function Cq(n,t,e){n?Hs(e,n,t):t()}function DA(...n){return function z7e(){return nl(1)}()(us(n,X3(n)))}function yq(n){return new Cr(t=>{uo(n()).subscribe(t)})}function Ap(n,t){const e=cn(n)?n:()=>n,r=s=>s.error(e());return new Cr(t?s=>t.schedule(r,0,s):r)}function zA(){return fr((n,t)=>{let e=null;n._refCount++;const r=ls(t,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount)return void(e=null);const s=n._connection,i=e;e=null,s&&(!i||s===i)&&s.unsubscribe(),t.unsubscribe()});n.subscribe(r),r.closed||(e=n.connect())})}class Eq extends Cr{constructor(t,e){super(),this.source=t,this.subjectFactory=e,this._subject=null,this._refCount=0,this._connection=null,f_(t)&&(this.lift=t.lift)}_subscribe(t){return this.getSubject().subscribe(t)}getSubject(){const t=this._subject;return(!t||t.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:t}=this;this._subject=this._connection=null,t?.unsubscribe()}connect(){let t=this._connection;if(!t){t=this._connection=new q1;const e=this.getSubject();t.add(this.source.subscribe(ls(e,void 0,()=>{this._teardown(),e.complete()},r=>{this._teardown(),e.error(r)},()=>this._teardown()))),t.closed&&(this._connection=null,t=q1.EMPTY)}return t}refCount(){return zA()(this)}}function P4(n,t){return fr((e,r)=>{let s=null,i=0,o=!1;const c=()=>o&&!s&&r.complete();e.subscribe(ls(r,u=>{s?.unsubscribe();let d=0;const g=i++;uo(n(u,g)).subscribe(s=ls(r,m=>r.next(t?t(u,m,g,d++):m),()=>{s=null,c()}))},()=>{o=!0,c()}))})}function Np(n){return n<=0?()=>hc:fr((t,e)=>{let r=0;t.subscribe(ls(e,s=>{++r<=n&&(e.next(s),n<=r&&e.complete())}))})}function Yy(n){return fr((t,e)=>{let r=!1;t.subscribe(ls(e,s=>{r=!0,e.next(s)},()=>{r||e.next(n),e.complete()}))})}function Mq(n=H7e){return fr((t,e)=>{let r=!1;t.subscribe(ls(e,s=>{r=!0,e.next(s)},()=>r?e.complete():e.error(n())))})}function H7e(){return new Zy}function O0(n,t){const e=arguments.length>=2;return r=>r.pipe(n?Rl((s,i)=>n(s,i,r)):J4,Np(1),e?Yy(t):Mq(()=>new Zy))}function _2(n,t,e){const r=cn(n)||t||e?{next:n,error:t,complete:e}:n;return r?fr((s,i)=>{var o;null===(o=r.subscribe)||void 0===o||o.call(r);let c=!0;s.subscribe(ls(i,u=>{var d;null===(d=r.next)||void 0===d||d.call(r,u),i.next(u)},()=>{var u;c=!1,null===(u=r.complete)||void 0===u||u.call(r),i.complete()},u=>{var d;c=!1,null===(d=r.error)||void 0===d||d.call(r,u),i.error(u)},()=>{var u,d;c&&(null===(u=r.unsubscribe)||void 0===u||u.call(r)),null===(d=r.finalize)||void 0===d||d.call(r)}))}):J4}function A0(n){return fr((t,e)=>{let i,r=null,s=!1;r=t.subscribe(ls(e,void 0,void 0,o=>{i=uo(n(o,A0(n)(t))),r?(r.unsubscribe(),r=null,i.subscribe(e)):s=!0})),s&&(r.unsubscribe(),r=null,i.subscribe(e))})}function F7e(n,t,e,r,s){return(i,o)=>{let c=e,u=t,d=0;i.subscribe(ls(o,g=>{const m=d++;u=c?n(u,g,m):(c=!0,g),r&&o.next(u)},s&&(()=>{c&&o.next(u),o.complete()})))}}function Sq(n,t){return fr(F7e(n,t,arguments.length>=2,!0))}function VA(n){return n<=0?()=>hc:fr((t,e)=>{let r=[];t.subscribe(ls(e,s=>{r.push(s),n<r.length&&r.shift()},()=>{for(const s of r)e.next(s);e.complete()},void 0,()=>{r=null}))})}function Pq(n,t){const e=arguments.length>=2;return r=>r.pipe(n?Rl((s,i)=>n(s,i,r)):J4,VA(1),e?Yy(t):Mq(()=>new Zy))}function HA(n){return fr((t,e)=>{try{t.subscribe(e)}finally{e.add(n)}})}const $n="primary",Ip=Symbol("RouteTitle");class U7e{constructor(t){this.params=t||{}}has(t){return Object.prototype.hasOwnProperty.call(this.params,t)}get(t){if(this.has(t)){const e=this.params[t];return Array.isArray(e)?e[0]:e}return null}getAll(t){if(this.has(t)){const e=this.params[t];return Array.isArray(e)?e:[e]}return[]}get keys(){return Object.keys(this.params)}}function vf(n){return new U7e(n)}function G7e(n,t,e){const r=e.path.split("/");if(r.length>n.length||"full"===e.pathMatch&&(t.hasChildren()||r.length<n.length))return null;const s={};for(let i=0;i<r.length;i++){const o=r[i],c=n[i];if(o.startsWith(":"))s[o.substring(1)]=c;else if(o!==c.path)return null}return{consumed:n.slice(0,r.length),posParams:s}}function T4(n,t){const e=n?Object.keys(n):void 0,r=t?Object.keys(t):void 0;if(!e||!r||e.length!=r.length)return!1;let s;for(let i=0;i<e.length;i++)if(s=e[i],!Tq(n[s],t[s]))return!1;return!0}function Tq(n,t){if(Array.isArray(n)&&Array.isArray(t)){if(n.length!==t.length)return!1;const e=[...n].sort(),r=[...t].sort();return e.every((s,i)=>r[i]===s)}return n===t}function wq(n){return Array.prototype.concat.apply([],n)}function bq(n){return n.length>0?n[n.length-1]:null}function v2(n,t){for(const e in n)n.hasOwnProperty(e)&&t(n[e],e)}function N0(n){return nO(n)?n:ep(n)?us(Promise.resolve(n)):Yt(n)}const j7e={exact:function Nq(n,t,e){if(!xu(n.segments,t.segments)||!Ky(n.segments,t.segments,e)||n.numberOfChildren!==t.numberOfChildren)return!1;for(const r in t.children)if(!n.children[r]||!Nq(n.children[r],t.children[r],e))return!1;return!0},subset:Iq},Oq={exact:function Z7e(n,t){return T4(n,t)},subset:function Y7e(n,t){return Object.keys(t).length<=Object.keys(n).length&&Object.keys(t).every(e=>Tq(n[e],t[e]))},ignored:()=>!0};function Aq(n,t,e){return j7e[e.paths](n.root,t.root,e.matrixParams)&&Oq[e.queryParams](n.queryParams,t.queryParams)&&!("exact"===e.fragment&&n.fragment!==t.fragment)}function Iq(n,t,e){return xq(n,t,t.segments,e)}function xq(n,t,e,r){if(n.segments.length>e.length){const s=n.segments.slice(0,e.length);return!(!xu(s,e)||t.hasChildren()||!Ky(s,e,r))}if(n.segments.length===e.length){if(!xu(n.segments,e)||!Ky(n.segments,e,r))return!1;for(const s in t.children)if(!n.children[s]||!Iq(n.children[s],t.children[s],r))return!1;return!0}{const s=e.slice(0,n.segments.length),i=e.slice(n.segments.length);return!!(xu(n.segments,s)&&Ky(n.segments,s,r)&&n.children[$n])&&xq(n.children[$n],t,i,r)}}function Ky(n,t,e){return t.every((r,s)=>Oq[e](n[s].parameters,r.parameters))}class Iu{constructor(t,e,r){this.root=t,this.queryParams=e,this.fragment=r}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=vf(this.queryParams)),this._queryParamMap}toString(){return Q7e.serialize(this)}}class Yn{constructor(t,e){this.segments=t,this.children=e,this.parent=null,v2(e,(r,s)=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Xy(this)}}class xp{constructor(t,e){this.path=t,this.parameters=e}get parameterMap(){return this._parameterMap||(this._parameterMap=vf(this.parameters)),this._parameterMap}toString(){return Dq(this)}}function xu(n,t){return n.length===t.length&&n.every((e,r)=>e.path===t[r].path)}let kq=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=rt({token:n,factory:function(){return new BA},providedIn:"root"}),n})();class BA{parse(t){const e=new afe(t);return new Iu(e.parseRootSegment(),e.parseQueryParams(),e.parseFragment())}serialize(t){const e=`/${kp(t.root,!0)}`,r=function tfe(n){const t=Object.keys(n).map(e=>{const r=n[e];return Array.isArray(r)?r.map(s=>`${Qy(e)}=${Qy(s)}`).join("&"):`${Qy(e)}=${Qy(r)}`}).filter(e=>!!e);return t.length?`?${t.join("&")}`:""}(t.queryParams);return`${e}${r}${"string"==typeof t.fragment?`#${function J7e(n){return encodeURI(n)}(t.fragment)}`:""}`}}const Q7e=new BA;function Xy(n){return n.segments.map(t=>Dq(t)).join("/")}function kp(n,t){if(!n.hasChildren())return Xy(n);if(t){const e=n.children[$n]?kp(n.children[$n],!1):"",r=[];return v2(n.children,(s,i)=>{i!==$n&&r.push(`${i}:${kp(s,!1)}`)}),r.length>0?`${e}(${r.join("//")})`:e}{const e=function X7e(n,t){let e=[];return v2(n.children,(r,s)=>{s===$n&&(e=e.concat(t(r,s)))}),v2(n.children,(r,s)=>{s!==$n&&(e=e.concat(t(r,s)))}),e}(n,(r,s)=>s===$n?[kp(n.children[$n],!1)]:[`${s}:${kp(r,!1)}`]);return 1===Object.keys(n.children).length&&null!=n.children[$n]?`${Xy(n)}/${e[0]}`:`${Xy(n)}/(${e.join("//")})`}}function Lq(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Qy(n){return Lq(n).replace(/%3B/gi,";")}function $A(n){return Lq(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Jy(n){return decodeURIComponent(n)}function Rq(n){return Jy(n.replace(/\+/g,"%20"))}function Dq(n){return`${$A(n.path)}${function efe(n){return Object.keys(n).map(t=>`;${$A(t)}=${$A(n[t])}`).join("")}(n.parameters)}`}const nfe=/^[^\/()?;=#]+/;function eE(n){const t=n.match(nfe);return t?t[0]:""}const rfe=/^[^=?&#]+/,ife=/^[^&#]+/;class afe{constructor(t){this.url=t,this.remaining=t}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new Yn([],{}):new Yn([],this.parseChildren())}parseQueryParams(){const t={};if(this.consumeOptional("?"))do{this.parseQueryParam(t)}while(this.consumeOptional("&"));return t}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const t=[];for(this.peekStartsWith("(")||t.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),t.push(this.parseSegment());let e={};this.peekStartsWith("/(")&&(this.capture("/"),e=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(t.length>0||Object.keys(e).length>0)&&(r[$n]=new Yn(t,e)),r}parseSegment(){const t=eE(this.remaining);if(""===t&&this.peekStartsWith(";"))throw new Ie(4009,!1);return this.capture(t),new xp(Jy(t),this.parseMatrixParams())}parseMatrixParams(){const t={};for(;this.consumeOptional(";");)this.parseParam(t);return t}parseParam(t){const e=eE(this.remaining);if(!e)return;this.capture(e);let r="";if(this.consumeOptional("=")){const s=eE(this.remaining);s&&(r=s,this.capture(r))}t[Jy(e)]=Jy(r)}parseQueryParam(t){const e=function sfe(n){const t=n.match(rfe);return t?t[0]:""}(this.remaining);if(!e)return;this.capture(e);let r="";if(this.consumeOptional("=")){const o=function ofe(n){const t=n.match(ife);return t?t[0]:""}(this.remaining);o&&(r=o,this.capture(r))}const s=Rq(e),i=Rq(r);if(t.hasOwnProperty(s)){let o=t[s];Array.isArray(o)||(o=[o],t[s]=o),o.push(i)}else t[s]=i}parseParens(t){const e={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const r=eE(this.remaining),s=this.remaining[r.length];if("/"!==s&&")"!==s&&";"!==s)throw new Ie(4010,!1);let i;r.indexOf(":")>-1?(i=r.slice(0,r.indexOf(":")),this.capture(i),this.capture(":")):t&&(i=$n);const o=this.parseChildren();e[i]=1===Object.keys(o).length?o[$n]:new Yn([],o),this.consumeOptional("//")}return e}peekStartsWith(t){return this.remaining.startsWith(t)}consumeOptional(t){return!!this.peekStartsWith(t)&&(this.remaining=this.remaining.substring(t.length),!0)}capture(t){if(!this.consumeOptional(t))throw new Ie(4011,!1)}}function UA(n){return n.segments.length>0?new Yn([],{[$n]:n}):n}function tE(n){const t={};for(const r of Object.keys(n.children)){const i=tE(n.children[r]);(i.segments.length>0||i.hasChildren())&&(t[r]=i)}return function cfe(n){if(1===n.numberOfChildren&&n.children[$n]){const t=n.children[$n];return new Yn(n.segments.concat(t.segments),t.children)}return n}(new Yn(n.segments,t))}function ku(n){return n instanceof Iu}function ffe(n,t,e,r,s){if(0===e.length)return Cf(t.root,t.root,t.root,r,s);const i=function Hq(n){if("string"==typeof n[0]&&1===n.length&&"/"===n[0])return new Vq(!0,0,n);let t=0,e=!1;const r=n.reduce((s,i,o)=>{if("object"==typeof i&&null!=i){if(i.outlets){const c={};return v2(i.outlets,(u,d)=>{c[d]="string"==typeof u?u.split("/"):u}),[...s,{outlets:c}]}if(i.segmentPath)return[...s,i.segmentPath]}return"string"!=typeof i?[...s,i]:0===o?(i.split("/").forEach((c,u)=>{0==u&&"."===c||(0==u&&""===c?e=!0:".."===c?t++:""!=c&&s.push(c))}),s):[...s,i]},[]);return new Vq(e,t,r)}(e);return i.toRoot()?Cf(t.root,t.root,new Yn([],{}),r,s):function o(u){const d=function hfe(n,t,e,r){if(n.isAbsolute)return new yf(t.root,!0,0);if(-1===r)return new yf(e,e===t.root,0);return function Fq(n,t,e){let r=n,s=t,i=e;for(;i>s;){if(i-=s,r=r.parent,!r)throw new Ie(4005,!1);s=r.segments.length}return new yf(r,!1,s-i)}(e,r+(Lp(n.commands[0])?0:1),n.numberOfDoubleDots)}(i,t,n.snapshot?._urlSegment,u),g=d.processChildren?Dp(d.segmentGroup,d.index,i.commands):WA(d.segmentGroup,d.index,i.commands);return Cf(t.root,d.segmentGroup,g,r,s)}(n.snapshot?._lastPathIndex)}function Lp(n){return"object"==typeof n&&null!=n&&!n.outlets&&!n.segmentPath}function Rp(n){return"object"==typeof n&&null!=n&&n.outlets}function Cf(n,t,e,r,s){let o,i={};r&&v2(r,(u,d)=>{i[d]=Array.isArray(u)?u.map(g=>`${g}`):`${u}`}),o=n===t?e:zq(n,t,e);const c=UA(tE(o));return new Iu(c,i,s)}function zq(n,t,e){const r={};return v2(n.children,(s,i)=>{r[i]=s===t?e:zq(s,t,e)}),new Yn(n.segments,r)}class Vq{constructor(t,e,r){if(this.isAbsolute=t,this.numberOfDoubleDots=e,this.commands=r,t&&r.length>0&&Lp(r[0]))throw new Ie(4003,!1);const s=r.find(Rp);if(s&&s!==bq(r))throw new Ie(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class yf{constructor(t,e,r){this.segmentGroup=t,this.processChildren=e,this.index=r}}function WA(n,t,e){if(n||(n=new Yn([],{})),0===n.segments.length&&n.hasChildren())return Dp(n,t,e);const r=function gfe(n,t,e){let r=0,s=t;const i={match:!1,pathIndex:0,commandIndex:0};for(;s<n.segments.length;){if(r>=e.length)return i;const o=n.segments[s],c=e[r];if(Rp(c))break;const u=`${c}`,d=r<e.length-1?e[r+1]:null;if(s>0&&void 0===u)break;if(u&&d&&"object"==typeof d&&void 0===d.outlets){if(!$q(u,d,o))return i;r+=2}else{if(!$q(u,{},o))return i;r++}s++}return{match:!0,pathIndex:s,commandIndex:r}}(n,t,e),s=e.slice(r.commandIndex);if(r.match&&r.pathIndex<n.segments.length){const i=new Yn(n.segments.slice(0,r.pathIndex),{});return i.children[$n]=new Yn(n.segments.slice(r.pathIndex),n.children),Dp(i,0,s)}return r.match&&0===s.length?new Yn(n.segments,{}):r.match&&!n.hasChildren()?qA(n,t,e):r.match?Dp(n,0,s):qA(n,t,e)}function Dp(n,t,e){if(0===e.length)return new Yn(n.segments,{});{const r=function pfe(n){return Rp(n[0])?n[0].outlets:{[$n]:n}}(e),s={};return v2(r,(i,o)=>{"string"==typeof i&&(i=[i]),null!==i&&(s[o]=WA(n.children[o],t,i))}),v2(n.children,(i,o)=>{void 0===r[o]&&(s[o]=i)}),new Yn(n.segments,s)}}function qA(n,t,e){const r=n.segments.slice(0,t);let s=0;for(;s<e.length;){const i=e[s];if(Rp(i)){const u=mfe(i.outlets);return new Yn(r,u)}if(0===s&&Lp(e[0])){r.push(new xp(n.segments[t].path,Bq(e[0]))),s++;continue}const o=Rp(i)?i.outlets[$n]:`${i}`,c=s<e.length-1?e[s+1]:null;o&&c&&Lp(c)?(r.push(new xp(o,Bq(c))),s+=2):(r.push(new xp(o,{})),s++)}return new Yn(r,{})}function mfe(n){const t={};return v2(n,(e,r)=>{"string"==typeof e&&(e=[e]),null!==e&&(t[r]=qA(new Yn([],{}),0,e))}),t}function Bq(n){const t={};return v2(n,(e,r)=>t[r]=`${e}`),t}function $q(n,t,e){return n==e.path&&T4(t,e.parameters)}class zl{constructor(t,e){this.id=t,this.url=e}}class jA extends zl{constructor(t,e,r="imperative",s=null){super(t,e),this.type=0,this.navigationTrigger=r,this.restoredState=s}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class I0 extends zl{constructor(t,e,r){super(t,e),this.urlAfterRedirects=r,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class nE extends zl{constructor(t,e,r,s){super(t,e),this.reason=r,this.code=s,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class Uq extends zl{constructor(t,e,r,s){super(t,e),this.error=r,this.target=s,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class _fe extends zl{constructor(t,e,r,s){super(t,e),this.urlAfterRedirects=r,this.state=s,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class vfe extends zl{constructor(t,e,r,s){super(t,e),this.urlAfterRedirects=r,this.state=s,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Cfe extends zl{constructor(t,e,r,s,i){super(t,e),this.urlAfterRedirects=r,this.state=s,this.shouldActivate=i,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class yfe extends zl{constructor(t,e,r,s){super(t,e),this.urlAfterRedirects=r,this.state=s,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Efe extends zl{constructor(t,e,r,s){super(t,e),this.urlAfterRedirects=r,this.state=s,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Mfe{constructor(t){this.route=t,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class Sfe{constructor(t){this.route=t,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class Pfe{constructor(t){this.snapshot=t,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Tfe{constructor(t){this.snapshot=t,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class wfe{constructor(t){this.snapshot=t,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class bfe{constructor(t){this.snapshot=t,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Gq{constructor(t,e,r){this.routerEvent=t,this.position=e,this.anchor=r,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class Wq{constructor(t){this._root=t}get root(){return this._root.value}parent(t){const e=this.pathFromRoot(t);return e.length>1?e[e.length-2]:null}children(t){const e=ZA(t,this._root);return e?e.children.map(r=>r.value):[]}firstChild(t){const e=ZA(t,this._root);return e&&e.children.length>0?e.children[0].value:null}siblings(t){const e=YA(t,this._root);return e.length<2?[]:e[e.length-2].children.map(s=>s.value).filter(s=>s!==t)}pathFromRoot(t){return YA(t,this._root).map(e=>e.value)}}function ZA(n,t){if(n===t.value)return t;for(const e of t.children){const r=ZA(n,e);if(r)return r}return null}function YA(n,t){if(n===t.value)return[t];for(const e of t.children){const r=YA(n,e);if(r.length)return r.unshift(t),r}return[]}class Vl{constructor(t,e){this.value=t,this.children=e}toString(){return`TreeNode(${this.value})`}}function Ef(n){const t={};return n&&n.children.forEach(e=>t[e.value.outlet]=e),t}class qq extends Wq{constructor(t,e){super(t),this.snapshot=e,KA(this,t)}toString(){return this.snapshot.toString()}}function jq(n,t){const e=function Afe(n,t){const o=new rE([],{},{},"",{},$n,t,null,n.root,-1,{});return new Yq("",new Vl(o,[]))}(n,t),r=new N3([new xp("",{})]),s=new N3({}),i=new N3({}),o=new N3({}),c=new N3(""),u=new bo(r,s,o,c,i,$n,t,e.root);return u.snapshot=e.root,new qq(new Vl(u,[]),e)}class bo{constructor(t,e,r,s,i,o,c,u){this.url=t,this.params=e,this.queryParams=r,this.fragment=s,this.data=i,this.outlet=o,this.component=c,this.title=this.data?.pipe(_n(d=>d[Ip]))??Yt(void 0),this._futureSnapshot=u}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(_n(t=>vf(t)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(_n(t=>vf(t)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function Zq(n,t="emptyOnly"){const e=n.pathFromRoot;let r=0;if("always"!==t)for(r=e.length-1;r>=1;){const s=e[r],i=e[r-1];if(s.routeConfig&&""===s.routeConfig.path)r--;else{if(i.component)break;r--}}return function Nfe(n){return n.reduce((t,e)=>({params:{...t.params,...e.params},data:{...t.data,...e.data},resolve:{...e.data,...t.resolve,...e.routeConfig?.data,...e._resolvedData}}),{params:{},data:{},resolve:{}})}(e.slice(r))}class rE{constructor(t,e,r,s,i,o,c,u,d,g,m,y){this.url=t,this.params=e,this.queryParams=r,this.fragment=s,this.data=i,this.outlet=o,this.component=c,this.title=this.data?.[Ip],this.routeConfig=u,this._urlSegment=d,this._lastPathIndex=g,this._correctedLastPathIndex=y??g,this._resolve=m}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=vf(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=vf(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(r=>r.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class Yq extends Wq{constructor(t,e){super(e),this.url=t,KA(this,e)}toString(){return Kq(this._root)}}function KA(n,t){t.value._routerState=n,t.children.forEach(e=>KA(n,e))}function Kq(n){const t=n.children.length>0?` { ${n.children.map(Kq).join(", ")} } `:"";return`${n.value}${t}`}function XA(n){if(n.snapshot){const t=n.snapshot,e=n._futureSnapshot;n.snapshot=e,T4(t.queryParams,e.queryParams)||n.queryParams.next(e.queryParams),t.fragment!==e.fragment&&n.fragment.next(e.fragment),T4(t.params,e.params)||n.params.next(e.params),function W7e(n,t){if(n.length!==t.length)return!1;for(let e=0;e<n.length;++e)if(!T4(n[e],t[e]))return!1;return!0}(t.url,e.url)||n.url.next(e.url),T4(t.data,e.data)||n.data.next(e.data)}else n.snapshot=n._futureSnapshot,n.data.next(n._futureSnapshot.data)}function QA(n,t){const e=T4(n.params,t.params)&&function K7e(n,t){return xu(n,t)&&n.every((e,r)=>T4(e.parameters,t[r].parameters))}(n.url,t.url);return e&&!(!n.parent!=!t.parent)&&(!n.parent||QA(n.parent,t.parent))}function zp(n,t,e){if(e&&n.shouldReuseRoute(t.value,e.value.snapshot)){const r=e.value;r._futureSnapshot=t.value;const s=function xfe(n,t,e){return t.children.map(r=>{for(const s of e.children)if(n.shouldReuseRoute(r.value,s.value.snapshot))return zp(n,r,s);return zp(n,r)})}(n,t,e);return new Vl(r,s)}{if(n.shouldAttach(t.value)){const i=n.retrieve(t.value);if(null!==i){const o=i.route;return o.value._futureSnapshot=t.value,o.children=t.children.map(c=>zp(n,c)),o}}const r=function kfe(n){return new bo(new N3(n.url),new N3(n.params),new N3(n.queryParams),new N3(n.fragment),new N3(n.data),n.outlet,n.component,n)}(t.value),s=t.children.map(i=>zp(n,i));return new Vl(r,s)}}const JA="ngNavigationCancelingError";function Xq(n,t){const{redirectTo:e,navigationBehaviorOptions:r}=ku(t)?{redirectTo:t,navigationBehaviorOptions:void 0}:t,s=Qq(!1,0,t);return s.url=e,s.navigationBehaviorOptions=r,s}function Qq(n,t,e){const r=new Error("NavigationCancelingError: "+(n||""));return r[JA]=!0,r.cancellationCode=t,e&&(r.url=e),r}function Jq(n){return ej(n)&&ku(n.url)}function ej(n){return n&&n[JA]}class Lfe{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.injector=null,this.children=new Vp,this.attachRef=null}}let Vp=(()=>{class n{constructor(){this.contexts=new Map}onChildOutletCreated(e,r){const s=this.getOrCreateContext(e);s.outlet=r,this.contexts.set(e,s)}onChildOutletDestroyed(e){const r=this.getContext(e);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){const e=this.contexts;return this.contexts=new Map,e}onOutletReAttached(e){this.contexts=e}getOrCreateContext(e){let r=this.getContext(e);return r||(r=new Lfe,this.contexts.set(e,r)),r}getContext(e){return this.contexts.get(e)||null}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=rt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const sE=!1;let eN=(()=>{class n{constructor(e,r,s,i,o){this.parentContexts=e,this.location=r,this.changeDetector=i,this.environmentInjector=o,this.activated=null,this._activatedRoute=null,this.activateEvents=new dr,this.deactivateEvents=new dr,this.attachEvents=new dr,this.detachEvents=new dr,this.name=s||$n,e.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.getContext(this.name)?.outlet===this&&this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const e=this.parentContexts.getContext(this.name);e&&e.route&&(e.attachRef?this.attach(e.attachRef,e.route):this.activateWith(e.route,e.injector))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Ie(4012,sE);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Ie(4012,sE);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Ie(4012,sE);this.location.detach();const e=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(e.instance),e}attach(e,r){this.activated=e,this._activatedRoute=r,this.location.insert(e.hostView),this.attachEvents.emit(e.instance)}deactivate(){if(this.activated){const e=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(e)}}activateWith(e,r){if(this.isActivated)throw new Ie(4013,sE);this._activatedRoute=e;const s=this.location,o=e._futureSnapshot.component,c=this.parentContexts.getOrCreateContext(this.name).children,u=new Rfe(e,c,s.injector);if(r&&function Dfe(n){return!!n.resolveComponentFactory}(r)){const d=r.resolveComponentFactory(o);this.activated=s.createComponent(d,s.length,u)}else this.activated=s.createComponent(o,{index:s.length,injector:u,environmentInjector:r??this.environmentInjector});this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return n.\u0275fac=function(e){return new(e||n)(J(Vp),J(Va),U8("name"),J(Mu),J(Ia))},n.\u0275dir=Gt({type:n,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0}),n})();class Rfe{constructor(t,e,r){this.route=t,this.childContexts=e,this.parent=r}get(t,e){return t===bo?this.route:t===Vp?this.childContexts:this.parent.get(t,e)}}let tN=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=dt({type:n,selectors:[["ng-component"]],standalone:!0,features:[U$],decls:1,vars:0,template:function(e,r){1&e&&X(0,"router-outlet")},dependencies:[eN],encapsulation:2}),n})();function tj(n,t){return n.providers&&!n._injector&&(n._injector=ay(n.providers,t,`Route: ${n.path}`)),n._injector??t}function rN(n){const t=n.children&&n.children.map(rN),e=t?{...n,children:t}:{...n};return!e.component&&!e.loadComponent&&(t||e.loadChildren)&&e.outlet&&e.outlet!==$n&&(e.component=tN),e}function Nc(n){return n.outlet||$n}function nj(n,t){const e=n.filter(r=>Nc(r)===t);return e.push(...n.filter(r=>Nc(r)!==t)),e}function Hp(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let t=n.parent;t;t=t.parent){const e=t.routeConfig;if(e?._loadedInjector)return e._loadedInjector;if(e?._injector)return e._injector}return null}class Bfe{constructor(t,e,r,s){this.routeReuseStrategy=t,this.futureState=e,this.currState=r,this.forwardEvent=s}activate(t){const e=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(e,r,t),XA(this.futureState.root),this.activateChildRoutes(e,r,t)}deactivateChildRoutes(t,e,r){const s=Ef(e);t.children.forEach(i=>{const o=i.value.outlet;this.deactivateRoutes(i,s[o],r),delete s[o]}),v2(s,(i,o)=>{this.deactivateRouteAndItsChildren(i,r)})}deactivateRoutes(t,e,r){const s=t.value,i=e?e.value:null;if(s===i)if(s.component){const o=r.getContext(s.outlet);o&&this.deactivateChildRoutes(t,e,o.children)}else this.deactivateChildRoutes(t,e,r);else i&&this.deactivateRouteAndItsChildren(e,r)}deactivateRouteAndItsChildren(t,e){t.value.component&&this.routeReuseStrategy.shouldDetach(t.value.snapshot)?this.detachAndStoreRouteSubtree(t,e):this.deactivateRouteAndOutlet(t,e)}detachAndStoreRouteSubtree(t,e){const r=e.getContext(t.value.outlet),s=r&&t.value.component?r.children:e,i=Ef(t);for(const o of Object.keys(i))this.deactivateRouteAndItsChildren(i[o],s);if(r&&r.outlet){const o=r.outlet.detach(),c=r.children.onOutletDeactivated();this.routeReuseStrategy.store(t.value.snapshot,{componentRef:o,route:t,contexts:c})}}deactivateRouteAndOutlet(t,e){const r=e.getContext(t.value.outlet),s=r&&t.value.component?r.children:e,i=Ef(t);for(const o of Object.keys(i))this.deactivateRouteAndItsChildren(i[o],s);r&&r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated(),r.attachRef=null,r.resolver=null,r.route=null)}activateChildRoutes(t,e,r){const s=Ef(e);t.children.forEach(i=>{this.activateRoutes(i,s[i.value.outlet],r),this.forwardEvent(new bfe(i.value.snapshot))}),t.children.length&&this.forwardEvent(new Tfe(t.value.snapshot))}activateRoutes(t,e,r){const s=t.value,i=e?e.value:null;if(XA(s),s===i)if(s.component){const o=r.getOrCreateContext(s.outlet);this.activateChildRoutes(t,e,o.children)}else this.activateChildRoutes(t,e,r);else if(s.component){const o=r.getOrCreateContext(s.outlet);if(this.routeReuseStrategy.shouldAttach(s.snapshot)){const c=this.routeReuseStrategy.retrieve(s.snapshot);this.routeReuseStrategy.store(s.snapshot,null),o.children.onOutletReAttached(c.contexts),o.attachRef=c.componentRef,o.route=c.route.value,o.outlet&&o.outlet.attach(c.componentRef,c.route.value),XA(c.route.value),this.activateChildRoutes(t,null,o.children)}else{const c=Hp(s.snapshot),u=c?.get(xa)??null;o.attachRef=null,o.route=s,o.resolver=u,o.injector=c,o.outlet&&o.outlet.activateWith(s,o.injector),this.activateChildRoutes(t,null,o.children)}}else this.activateChildRoutes(t,null,r)}}class rj{constructor(t){this.path=t,this.route=this.path[this.path.length-1]}}class iE{constructor(t,e){this.component=t,this.route=e}}function $fe(n,t,e){const r=n._root;return Fp(r,t?t._root:null,e,[r.value])}function Mf(n,t){const e=Symbol(),r=t.get(n,e);return r===e?"function"!=typeof n||function $2(n){return null!==kn(n)}(n)?t.get(n):n:r}function Fp(n,t,e,r,s={canDeactivateChecks:[],canActivateChecks:[]}){const i=Ef(t);return n.children.forEach(o=>{(function Gfe(n,t,e,r,s={canDeactivateChecks:[],canActivateChecks:[]}){const i=n.value,o=t?t.value:null,c=e?e.getContext(n.value.outlet):null;if(o&&i.routeConfig===o.routeConfig){const u=function Wfe(n,t,e){if("function"==typeof e)return e(n,t);switch(e){case"pathParamsChange":return!xu(n.url,t.url);case"pathParamsOrQueryParamsChange":return!xu(n.url,t.url)||!T4(n.queryParams,t.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!QA(n,t)||!T4(n.queryParams,t.queryParams);default:return!QA(n,t)}}(o,i,i.routeConfig.runGuardsAndResolvers);u?s.canActivateChecks.push(new rj(r)):(i.data=o.data,i._resolvedData=o._resolvedData),Fp(n,t,i.component?c?c.children:null:e,r,s),u&&c&&c.outlet&&c.outlet.isActivated&&s.canDeactivateChecks.push(new iE(c.outlet.component,o))}else o&&Bp(t,c,s),s.canActivateChecks.push(new rj(r)),Fp(n,null,i.component?c?c.children:null:e,r,s)})(o,i[o.value.outlet],e,r.concat([o.value]),s),delete i[o.value.outlet]}),v2(i,(o,c)=>Bp(o,e.getContext(c),s)),s}function Bp(n,t,e){const r=Ef(n),s=n.value;v2(r,(i,o)=>{Bp(i,s.component?t?t.children.getContext(o):null:t,e)}),e.canDeactivateChecks.push(new iE(s.component&&t&&t.outlet&&t.outlet.isActivated?t.outlet.component:null,s))}function $p(n){return"function"==typeof n}function sN(n){return n instanceof Zy||"EmptyError"===n?.name}const oE=Symbol("INITIAL_VALUE");function Sf(){return P4(n=>vq(n.map(t=>t.pipe(Np(1),function V7e(...n){const t=X3(n);return fr((e,r)=>{(t?DA(n,e,t):DA(n,e)).subscribe(r)})}(oE)))).pipe(_n(t=>{for(const e of t)if(!0!==e){if(e===oE)return oE;if(!1===e||e instanceof Iu)return e}return!0}),Rl(t=>t!==oE),Np(1)))}function sj(n){return function aT(...n){return u_(n)}(_2(t=>{if(ku(t))throw Xq(0,t)}),_n(t=>!0===t))}const iN={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function ij(n,t,e,r,s){const i=oN(n,t,e);return i.matched?function cde(n,t,e,r){const s=t.canMatch;return s&&0!==s.length?Yt(s.map(o=>{const c=Mf(o,n);return N0(function Xfe(n){return n&&$p(n.canMatch)}(c)?c.canMatch(t,e):n.runInContext(()=>c(t,e)))})).pipe(Sf(),sj()):Yt(!0)}(r=tj(t,r),t,e).pipe(_n(o=>!0===o?i:{...iN})):Yt(i)}function oN(n,t,e){if(""===t.path)return"full"===t.pathMatch&&(n.hasChildren()||e.length>0)?{...iN}:{matched:!0,consumedSegments:[],remainingSegments:e,parameters:{},positionalParamSegments:{}};const s=(t.matcher||G7e)(e,n,t);if(!s)return{...iN};const i={};v2(s.posParams,(c,u)=>{i[u]=c.path});const o=s.consumed.length>0?{...i,...s.consumed[s.consumed.length-1].parameters}:i;return{matched:!0,consumedSegments:s.consumed,remainingSegments:e.slice(s.consumed.length),parameters:o,positionalParamSegments:s.posParams??{}}}function aE(n,t,e,r,s="corrected"){if(e.length>0&&function fde(n,t,e){return e.some(r=>cE(n,t,r)&&Nc(r)!==$n)}(n,e,r)){const o=new Yn(t,function ude(n,t,e,r){const s={};s[$n]=r,r._sourceSegment=n,r._segmentIndexShift=t.length;for(const i of e)if(""===i.path&&Nc(i)!==$n){const o=new Yn([],{});o._sourceSegment=n,o._segmentIndexShift=t.length,s[Nc(i)]=o}return s}(n,t,r,new Yn(e,n.children)));return o._sourceSegment=n,o._segmentIndexShift=t.length,{segmentGroup:o,slicedSegments:[]}}if(0===e.length&&function dde(n,t,e){return e.some(r=>cE(n,t,r))}(n,e,r)){const o=new Yn(n.segments,function lde(n,t,e,r,s,i){const o={};for(const c of r)if(cE(n,e,c)&&!s[Nc(c)]){const u=new Yn([],{});u._sourceSegment=n,u._segmentIndexShift="legacy"===i?n.segments.length:t.length,o[Nc(c)]=u}return{...s,...o}}(n,t,e,r,n.children,s));return o._sourceSegment=n,o._segmentIndexShift=t.length,{segmentGroup:o,slicedSegments:e}}const i=new Yn(n.segments,n.children);return i._sourceSegment=n,i._segmentIndexShift=t.length,{segmentGroup:i,slicedSegments:e}}function cE(n,t,e){return(!(n.hasChildren()||t.length>0)||"full"!==e.pathMatch)&&""===e.path}function oj(n,t,e,r){return!!(Nc(n)===r||r!==$n&&cE(t,e,n))&&("**"===n.path||oN(t,n,e).matched)}function aj(n,t,e){return 0===t.length&&!n.children[e]}const lE=!1;class uE{constructor(t){this.segmentGroup=t||null}}class cj{constructor(t){this.urlTree=t}}function Up(n){return Ap(new uE(n))}function lj(n){return Ap(new cj(n))}class mde{constructor(t,e,r,s,i){this.injector=t,this.configLoader=e,this.urlSerializer=r,this.urlTree=s,this.config=i,this.allowRedirects=!0}apply(){const t=aE(this.urlTree.root,[],[],this.config).segmentGroup,e=new Yn(t.segments,t.children);return this.expandSegmentGroup(this.injector,this.config,e,$n).pipe(_n(i=>this.createUrlTree(tE(i),this.urlTree.queryParams,this.urlTree.fragment))).pipe(A0(i=>{if(i instanceof cj)return this.allowRedirects=!1,this.match(i.urlTree);throw i instanceof uE?this.noMatchError(i):i}))}match(t){return this.expandSegmentGroup(this.injector,this.config,t.root,$n).pipe(_n(s=>this.createUrlTree(tE(s),t.queryParams,t.fragment))).pipe(A0(s=>{throw s instanceof uE?this.noMatchError(s):s}))}noMatchError(t){return new Ie(4002,lE)}createUrlTree(t,e,r){const s=UA(t);return new Iu(s,e,r)}expandSegmentGroup(t,e,r,s){return 0===r.segments.length&&r.hasChildren()?this.expandChildren(t,e,r).pipe(_n(i=>new Yn([],i))):this.expandSegment(t,r,e,r.segments,s,!0)}expandChildren(t,e,r){const s=[];for(const i of Object.keys(r.children))"primary"===i?s.unshift(i):s.push(i);return us(s).pipe(w0(i=>{const o=r.children[i],c=nj(e,i);return this.expandSegmentGroup(t,c,o,i).pipe(_n(u=>({segment:u,outlet:i})))}),Sq((i,o)=>(i[o.outlet]=o.segment,i),{}),Pq())}expandSegment(t,e,r,s,i,o){return us(r).pipe(w0(c=>this.expandSegmentAgainstRoute(t,e,r,c,s,i,o).pipe(A0(d=>{if(d instanceof uE)return Yt(null);throw d}))),O0(c=>!!c),A0((c,u)=>{if(sN(c))return aj(e,s,i)?Yt(new Yn([],{})):Up(e);throw c}))}expandSegmentAgainstRoute(t,e,r,s,i,o,c){return oj(s,e,i,o)?void 0===s.redirectTo?this.matchSegmentAgainstRoute(t,e,s,i,o):c&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(t,e,r,s,i,o):Up(e):Up(e)}expandSegmentAgainstRouteUsingRedirect(t,e,r,s,i,o){return"**"===s.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(t,r,s,o):this.expandRegularSegmentAgainstRouteUsingRedirect(t,e,r,s,i,o)}expandWildCardWithParamsAgainstRouteUsingRedirect(t,e,r,s){const i=this.applyRedirectCommands([],r.redirectTo,{});return r.redirectTo.startsWith("/")?lj(i):this.lineralizeSegments(r,i).pipe(He(o=>{const c=new Yn(o,{});return this.expandSegment(t,c,e,o,s,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(t,e,r,s,i,o){const{matched:c,consumedSegments:u,remainingSegments:d,positionalParamSegments:g}=oN(e,s,i);if(!c)return Up(e);const m=this.applyRedirectCommands(u,s.redirectTo,g);return s.redirectTo.startsWith("/")?lj(m):this.lineralizeSegments(s,m).pipe(He(y=>this.expandSegment(t,e,r,y.concat(d),o,!1)))}matchSegmentAgainstRoute(t,e,r,s,i){return"**"===r.path?(t=tj(r,t),r.loadChildren?(r._loadedRoutes?Yt({routes:r._loadedRoutes,injector:r._loadedInjector}):this.configLoader.loadChildren(t,r)).pipe(_n(c=>(r._loadedRoutes=c.routes,r._loadedInjector=c.injector,new Yn(s,{})))):Yt(new Yn(s,{}))):ij(e,r,s,t).pipe(P4(({matched:o,consumedSegments:c,remainingSegments:u})=>o?this.getChildConfig(t=r._injector??t,r,s).pipe(He(g=>{const m=g.injector??t,y=g.routes,{segmentGroup:b,slicedSegments:k}=aE(e,c,u,y),$=new Yn(b.segments,b.children);if(0===k.length&&$.hasChildren())return this.expandChildren(m,y,$).pipe(_n(te=>new Yn(c,te)));if(0===y.length&&0===k.length)return Yt(new Yn(c,{}));const K=Nc(r)===i;return this.expandSegment(m,$,y,k,K?$n:i,!0).pipe(_n(ye=>new Yn(c.concat(ye.segments),ye.children)))})):Up(e)))}getChildConfig(t,e,r){return e.children?Yt({routes:e.children,injector:t}):e.loadChildren?void 0!==e._loadedRoutes?Yt({routes:e._loadedRoutes,injector:e._loadedInjector}):function ade(n,t,e,r){const s=t.canLoad;return void 0===s||0===s.length?Yt(!0):Yt(s.map(o=>{const c=Mf(o,n);return N0(function jfe(n){return n&&$p(n.canLoad)}(c)?c.canLoad(t,e):n.runInContext(()=>c(t,e)))})).pipe(Sf(),sj())}(t,e,r).pipe(He(s=>s?this.configLoader.loadChildren(t,e).pipe(_2(i=>{e._loadedRoutes=i.routes,e._loadedInjector=i.injector})):function pde(n){return Ap(Qq(lE,3))}())):Yt({routes:[],injector:t})}lineralizeSegments(t,e){let r=[],s=e.root;for(;;){if(r=r.concat(s.segments),0===s.numberOfChildren)return Yt(r);if(s.numberOfChildren>1||!s.children[$n])return Ap(new Ie(4e3,lE));s=s.children[$n]}}applyRedirectCommands(t,e,r){return this.applyRedirectCreateUrlTree(e,this.urlSerializer.parse(e),t,r)}applyRedirectCreateUrlTree(t,e,r,s){const i=this.createSegmentGroup(t,e.root,r,s);return new Iu(i,this.createQueryParams(e.queryParams,this.urlTree.queryParams),e.fragment)}createQueryParams(t,e){const r={};return v2(t,(s,i)=>{if("string"==typeof s&&s.startsWith(":")){const c=s.substring(1);r[i]=e[c]}else r[i]=s}),r}createSegmentGroup(t,e,r,s){const i=this.createSegments(t,e.segments,r,s);let o={};return v2(e.children,(c,u)=>{o[u]=this.createSegmentGroup(t,c,r,s)}),new Yn(i,o)}createSegments(t,e,r,s){return e.map(i=>i.path.startsWith(":")?this.findPosParam(t,i,s):this.findOrReturn(i,r))}findPosParam(t,e,r){const s=r[e.path.substring(1)];if(!s)throw new Ie(4001,lE);return s}findOrReturn(t,e){let r=0;for(const s of e){if(s.path===t.path)return e.splice(r),s;r++}return t}}class vde{}class Ede{constructor(t,e,r,s,i,o,c,u){this.injector=t,this.rootComponentType=e,this.config=r,this.urlTree=s,this.url=i,this.paramsInheritanceStrategy=o,this.relativeLinkResolution=c,this.urlSerializer=u}recognize(){const t=aE(this.urlTree.root,[],[],this.config.filter(e=>void 0===e.redirectTo),this.relativeLinkResolution).segmentGroup;return this.processSegmentGroup(this.injector,this.config,t,$n).pipe(_n(e=>{if(null===e)return null;const r=new rE([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},$n,this.rootComponentType,null,this.urlTree.root,-1,{}),s=new Vl(r,e),i=new Yq(this.url,s);return this.inheritParamsAndData(i._root),i}))}inheritParamsAndData(t){const e=t.value,r=Zq(e,this.paramsInheritanceStrategy);e.params=Object.freeze(r.params),e.data=Object.freeze(r.data),t.children.forEach(s=>this.inheritParamsAndData(s))}processSegmentGroup(t,e,r,s){return 0===r.segments.length&&r.hasChildren()?this.processChildren(t,e,r):this.processSegment(t,e,r,r.segments,s)}processChildren(t,e,r){return us(Object.keys(r.children)).pipe(w0(s=>{const i=r.children[s],o=nj(e,s);return this.processSegmentGroup(t,o,i,s)}),Sq((s,i)=>s&&i?(s.push(...i),s):null),function B7e(n,t=!1){return fr((e,r)=>{let s=0;e.subscribe(ls(r,i=>{const o=n(i,s++);(o||t)&&r.next(i),!o&&r.complete()}))})}(s=>null!==s),Yy(null),Pq(),_n(s=>{if(null===s)return null;const i=uj(s);return function Mde(n){n.sort((t,e)=>t.value.outlet===$n?-1:e.value.outlet===$n?1:t.value.outlet.localeCompare(e.value.outlet))}(i),i}))}processSegment(t,e,r,s,i){return us(e).pipe(w0(o=>this.processSegmentAgainstRoute(o._injector??t,o,r,s,i)),O0(o=>!!o),A0(o=>{if(sN(o))return aj(r,s,i)?Yt([]):Yt(null);throw o}))}processSegmentAgainstRoute(t,e,r,s,i){if(e.redirectTo||!oj(e,r,s,i))return Yt(null);let o;if("**"===e.path){const c=s.length>0?bq(s).parameters:{},u=dj(r)+s.length;o=Yt({snapshot:new rE(s,c,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,pj(e),Nc(e),e.component??e._loadedComponent??null,e,fj(r),u,gj(e),u),consumedSegments:[],remainingSegments:[]})}else o=ij(r,e,s,t).pipe(_n(({matched:c,consumedSegments:u,remainingSegments:d,parameters:g})=>{if(!c)return null;const m=dj(r)+u.length;return{snapshot:new rE(u,g,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,pj(e),Nc(e),e.component??e._loadedComponent??null,e,fj(r),m,gj(e),m),consumedSegments:u,remainingSegments:d}}));return o.pipe(P4(c=>{if(null===c)return Yt(null);const{snapshot:u,consumedSegments:d,remainingSegments:g}=c;t=e._injector??t;const m=e._loadedInjector??t,y=function Sde(n){return n.children?n.children:n.loadChildren?n._loadedRoutes:[]}(e),{segmentGroup:b,slicedSegments:k}=aE(r,d,g,y.filter(K=>void 0===K.redirectTo),this.relativeLinkResolution);if(0===k.length&&b.hasChildren())return this.processChildren(m,y,b).pipe(_n(K=>null===K?null:[new Vl(u,K)]));if(0===y.length&&0===k.length)return Yt([new Vl(u,[])]);const $=Nc(e)===i;return this.processSegment(m,y,b,k,$?$n:i).pipe(_n(K=>null===K?null:[new Vl(u,K)]))}))}}function Pde(n){const t=n.value.routeConfig;return t&&""===t.path&&void 0===t.redirectTo}function uj(n){const t=[],e=new Set;for(const r of n){if(!Pde(r)){t.push(r);continue}const s=t.find(i=>r.value.routeConfig===i.value.routeConfig);void 0!==s?(s.children.push(...r.children),e.add(s)):t.push(r)}for(const r of e){const s=uj(r.children);t.push(new Vl(r.value,s))}return t.filter(r=>!e.has(r))}function fj(n){let t=n;for(;t._sourceSegment;)t=t._sourceSegment;return t}function dj(n){let t=n,e=t._segmentIndexShift??0;for(;t._sourceSegment;)t=t._sourceSegment,e+=t._segmentIndexShift??0;return e-1}function pj(n){return n.data||{}}function gj(n){return n.resolve||{}}function mj(n){return"string"==typeof n.title||null===n.title}function aN(n){return P4(t=>{const e=n(t);return e?us(e).pipe(_n(()=>t)):Yt(t)})}let _j=(()=>{class n{buildTitle(e){let r,s=e.root;for(;void 0!==s;)r=this.getResolvedTitleForRoute(s)??r,s=s.children.find(i=>i.outlet===$n);return r}getResolvedTitleForRoute(e){return e.data[Ip]}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=rt({token:n,factory:function(){return Dr(vj)},providedIn:"root"}),n})(),vj=(()=>{class n extends _j{constructor(e){super(),this.title=e}updateTitle(e){const r=this.buildTitle(e);void 0!==r&&this.title.setTitle(r)}}return n.\u0275fac=function(e){return new(e||n)(Ve(KG))},n.\u0275prov=rt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class xde{}class Lde extends class kde{shouldDetach(t){return!1}store(t,e){}shouldAttach(t){return!1}retrieve(t){return null}shouldReuseRoute(t,e){return t.routeConfig===e.routeConfig}}{}const dE=new Lt("",{providedIn:"root",factory:()=>({})}),cN=new Lt("ROUTES");let lN=(()=>{class n{constructor(e,r){this.injector=e,this.compiler=r,this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap}loadComponent(e){if(this.componentLoaders.get(e))return this.componentLoaders.get(e);if(e._loadedComponent)return Yt(e._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(e);const r=N0(e.loadComponent()).pipe(_2(i=>{this.onLoadEndListener&&this.onLoadEndListener(e),e._loadedComponent=i}),HA(()=>{this.componentLoaders.delete(e)})),s=new Eq(r,()=>new F2).pipe(zA());return this.componentLoaders.set(e,s),s}loadChildren(e,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return Yt({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);const i=this.loadModuleFactoryOrRoutes(r.loadChildren).pipe(_n(c=>{this.onLoadEndListener&&this.onLoadEndListener(r);let u,d,g=!1;Array.isArray(c)?d=c:(u=c.create(e).injector,d=wq(u.get(cN,[],Zt.Self|Zt.Optional)));return{routes:d.map(rN),injector:u}}),HA(()=>{this.childrenLoaders.delete(r)})),o=new Eq(i,()=>new F2).pipe(zA());return this.childrenLoaders.set(r,o),o}loadModuleFactoryOrRoutes(e){return N0(e()).pipe(He(r=>r instanceof B$||Array.isArray(r)?Yt(r):us(this.compiler.compileModuleAsync(r))))}}return n.\u0275fac=function(e){return new(e||n)(Ve(fi),Ve(AO))},n.\u0275prov=rt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class Dde{}class zde{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,e){return t}}function Vde(n){throw n}function Hde(n,t,e){return t.parse("/")}const Fde={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},Bde={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};function yj(){const n=Dr(kq),t=Dr(Vp),e=Dr(GO),r=Dr(fi),s=Dr(AO),i=Dr(cN,{optional:!0})??[],o=Dr(dE,{optional:!0})??{},c=Dr(vj),u=Dr(_j,{optional:!0}),d=Dr(Dde,{optional:!0}),g=Dr(xde,{optional:!0}),m=new Kn(null,n,t,e,r,s,wq(i));return d&&(m.urlHandlingStrategy=d),g&&(m.routeReuseStrategy=g),m.titleStrategy=u??c,function $de(n,t){n.errorHandler&&(t.errorHandler=n.errorHandler),n.malformedUriErrorHandler&&(t.malformedUriErrorHandler=n.malformedUriErrorHandler),n.onSameUrlNavigation&&(t.onSameUrlNavigation=n.onSameUrlNavigation),n.paramsInheritanceStrategy&&(t.paramsInheritanceStrategy=n.paramsInheritanceStrategy),n.relativeLinkResolution&&(t.relativeLinkResolution=n.relativeLinkResolution),n.urlUpdateStrategy&&(t.urlUpdateStrategy=n.urlUpdateStrategy),n.canceledNavigationResolution&&(t.canceledNavigationResolution=n.canceledNavigationResolution)}(o,m),m}let Kn=(()=>{class n{constructor(e,r,s,i,o,c,u){this.rootComponentType=e,this.urlSerializer=r,this.rootContexts=s,this.location=i,this.config=u,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new F2,this.errorHandler=Vde,this.malformedUriErrorHandler=Hde,this.navigated=!1,this.lastSuccessfulId=-1,this.afterPreactivation=()=>Yt(void 0),this.urlHandlingStrategy=new zde,this.routeReuseStrategy=new Lde,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.configLoader=o.get(lN),this.configLoader.onLoadEndListener=y=>this.triggerEvent(new Sfe(y)),this.configLoader.onLoadStartListener=y=>this.triggerEvent(new Mfe(y)),this.ngModule=o.get(Eu),this.console=o.get(m0e);const m=o.get(Sr);this.isNgZoneEnabled=m instanceof Sr&&Sr.isInAngularZone(),this.resetConfig(u),this.currentUrlTree=function q7e(){return new Iu(new Yn([],{}),{},null)}(),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=jq(this.currentUrlTree,this.rootComponentType),this.transitions=new N3({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}get browserPageId(){return this.location.getState()?.\u0275routerPageId}setupNavigations(e){const r=this.events;return e.pipe(Rl(s=>0!==s.id),_n(s=>({...s,extractedUrl:this.urlHandlingStrategy.extract(s.rawUrl)})),P4(s=>{let i=!1,o=!1;return Yt(s).pipe(_2(c=>{this.currentNavigation={id:c.id,initialUrl:c.rawUrl,extractedUrl:c.extractedUrl,trigger:c.source,extras:c.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),P4(c=>{const u=this.browserUrlTree.toString(),d=!this.navigated||c.extractedUrl.toString()!==u||u!==this.currentUrlTree.toString();if(("reload"===this.onSameUrlNavigation||d)&&this.urlHandlingStrategy.shouldProcessUrl(c.rawUrl))return Ej(c.source)&&(this.browserUrlTree=c.extractedUrl),Yt(c).pipe(P4(m=>{const y=this.transitions.getValue();return r.next(new jA(m.id,this.serializeUrl(m.extractedUrl),m.source,m.restoredState)),y!==this.transitions.getValue()?hc:Promise.resolve(m)}),function _de(n,t,e,r){return P4(s=>function gde(n,t,e,r,s){return new mde(n,t,e,r,s).apply()}(n,t,e,s.extractedUrl,r).pipe(_n(i=>({...s,urlAfterRedirects:i}))))}(this.ngModule.injector,this.configLoader,this.urlSerializer,this.config),_2(m=>{this.currentNavigation={...this.currentNavigation,finalUrl:m.urlAfterRedirects},s.urlAfterRedirects=m.urlAfterRedirects}),function wde(n,t,e,r,s,i){return He(o=>function yde(n,t,e,r,s,i,o="emptyOnly",c="legacy"){return new Ede(n,t,e,r,s,o,c,i).recognize().pipe(P4(u=>null===u?function Cde(n){return new Cr(t=>t.error(n))}(new vde):Yt(u)))}(n,t,e,o.urlAfterRedirects,r.serialize(o.urlAfterRedirects),r,s,i).pipe(_n(c=>({...o,targetSnapshot:c}))))}(this.ngModule.injector,this.rootComponentType,this.config,this.urlSerializer,this.paramsInheritanceStrategy,this.relativeLinkResolution),_2(m=>{if(s.targetSnapshot=m.targetSnapshot,"eager"===this.urlUpdateStrategy){if(!m.extras.skipLocationChange){const b=this.urlHandlingStrategy.merge(m.urlAfterRedirects,m.rawUrl);this.setBrowserUrl(b,m)}this.browserUrlTree=m.urlAfterRedirects}const y=new _fe(m.id,this.serializeUrl(m.extractedUrl),this.serializeUrl(m.urlAfterRedirects),m.targetSnapshot);r.next(y)}));if(d&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:y,extractedUrl:b,source:k,restoredState:$,extras:K}=c,oe=new jA(y,this.serializeUrl(b),k,$);r.next(oe);const ye=jq(b,this.rootComponentType).snapshot;return Yt(s={...c,targetSnapshot:ye,urlAfterRedirects:b,extras:{...K,skipLocationChange:!1,replaceUrl:!1}})}return this.rawUrlTree=c.rawUrl,c.resolve(null),hc}),_2(c=>{const u=new vfe(c.id,this.serializeUrl(c.extractedUrl),this.serializeUrl(c.urlAfterRedirects),c.targetSnapshot);this.triggerEvent(u)}),_n(c=>s={...c,guards:$fe(c.targetSnapshot,c.currentSnapshot,this.rootContexts)}),function Jfe(n,t){return He(e=>{const{targetSnapshot:r,currentSnapshot:s,guards:{canActivateChecks:i,canDeactivateChecks:o}}=e;return 0===o.length&&0===i.length?Yt({...e,guardsResult:!0}):function ede(n,t,e,r){return us(n).pipe(He(s=>function ode(n,t,e,r,s){const i=t&&t.routeConfig?t.routeConfig.canDeactivate:null;return i&&0!==i.length?Yt(i.map(c=>{const u=Hp(t)??s,d=Mf(c,u);return N0(function Kfe(n){return n&&$p(n.canDeactivate)}(d)?d.canDeactivate(n,t,e,r):u.runInContext(()=>d(n,t,e,r))).pipe(O0())})).pipe(Sf()):Yt(!0)}(s.component,s.route,e,t,r)),O0(s=>!0!==s,!0))}(o,r,s,n).pipe(He(c=>c&&function qfe(n){return"boolean"==typeof n}(c)?function tde(n,t,e,r){return us(t).pipe(w0(s=>DA(function rde(n,t){return null!==n&&t&&t(new Pfe(n)),Yt(!0)}(s.route.parent,r),function nde(n,t){return null!==n&&t&&t(new wfe(n)),Yt(!0)}(s.route,r),function ide(n,t,e){const r=t[t.length-1],i=t.slice(0,t.length-1).reverse().map(o=>function Ufe(n){const t=n.routeConfig?n.routeConfig.canActivateChild:null;return t&&0!==t.length?{node:n,guards:t}:null}(o)).filter(o=>null!==o).map(o=>yq(()=>Yt(o.guards.map(u=>{const d=Hp(o.node)??e,g=Mf(u,d);return N0(function Yfe(n){return n&&$p(n.canActivateChild)}(g)?g.canActivateChild(r,n):d.runInContext(()=>g(r,n))).pipe(O0())})).pipe(Sf())));return Yt(i).pipe(Sf())}(n,s.path,e),function sde(n,t,e){const r=t.routeConfig?t.routeConfig.canActivate:null;if(!r||0===r.length)return Yt(!0);const s=r.map(i=>yq(()=>{const o=Hp(t)??e,c=Mf(i,o);return N0(function Zfe(n){return n&&$p(n.canActivate)}(c)?c.canActivate(t,n):o.runInContext(()=>c(t,n))).pipe(O0())}));return Yt(s).pipe(Sf())}(n,s.route,e))),O0(s=>!0!==s,!0))}(r,i,n,t):Yt(c)),_n(c=>({...e,guardsResult:c})))})}(this.ngModule.injector,c=>this.triggerEvent(c)),_2(c=>{if(s.guardsResult=c.guardsResult,ku(c.guardsResult))throw Xq(0,c.guardsResult);const u=new Cfe(c.id,this.serializeUrl(c.extractedUrl),this.serializeUrl(c.urlAfterRedirects),c.targetSnapshot,!!c.guardsResult);this.triggerEvent(u)}),Rl(c=>!!c.guardsResult||(this.restoreHistory(c),this.cancelNavigationTransition(c,"",3),!1)),aN(c=>{if(c.guards.canActivateChecks.length)return Yt(c).pipe(_2(u=>{const d=new yfe(u.id,this.serializeUrl(u.extractedUrl),this.serializeUrl(u.urlAfterRedirects),u.targetSnapshot);this.triggerEvent(d)}),P4(u=>{let d=!1;return Yt(u).pipe(function bde(n,t){return He(e=>{const{targetSnapshot:r,guards:{canActivateChecks:s}}=e;if(!s.length)return Yt(e);let i=0;return us(s).pipe(w0(o=>function Ode(n,t,e,r){const s=n.routeConfig,i=n._resolve;return void 0!==s?.title&&!mj(s)&&(i[Ip]=s.title),function Ade(n,t,e,r){const s=function Nde(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}(n);if(0===s.length)return Yt({});const i={};return us(s).pipe(He(o=>function Ide(n,t,e,r){const s=Hp(t)??r,i=Mf(n,s);return N0(i.resolve?i.resolve(t,e):s.runInContext(()=>i(t,e)))}(n[o],t,e,r).pipe(O0(),_2(c=>{i[o]=c}))),VA(1),function $7e(n){return _n(()=>n)}(i),A0(o=>sN(o)?hc:Ap(o)))}(i,n,t,r).pipe(_n(o=>(n._resolvedData=o,n.data=Zq(n,e).resolve,s&&mj(s)&&(n.data[Ip]=s.title),null)))}(o.route,r,n,t)),_2(()=>i++),VA(1),He(o=>i===s.length?Yt(e):hc))})}(this.paramsInheritanceStrategy,this.ngModule.injector),_2({next:()=>d=!0,complete:()=>{d||(this.restoreHistory(u),this.cancelNavigationTransition(u,"",2))}}))}),_2(u=>{const d=new Efe(u.id,this.serializeUrl(u.extractedUrl),this.serializeUrl(u.urlAfterRedirects),u.targetSnapshot);this.triggerEvent(d)}))}),aN(c=>{const u=d=>{const g=[];d.routeConfig?.loadComponent&&!d.routeConfig._loadedComponent&&g.push(this.configLoader.loadComponent(d.routeConfig).pipe(_2(m=>{d.component=m}),_n(()=>{})));for(const m of d.children)g.push(...u(m));return g};return vq(u(c.targetSnapshot.root)).pipe(Yy(),Np(1))}),aN(()=>this.afterPreactivation()),_n(c=>{const u=function Ife(n,t,e){const r=zp(n,t._root,e?e._root:void 0);return new qq(r,t)}(this.routeReuseStrategy,c.targetSnapshot,c.currentRouterState);return s={...c,targetRouterState:u}}),_2(c=>{this.currentUrlTree=c.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(c.urlAfterRedirects,c.rawUrl),this.routerState=c.targetRouterState,"deferred"===this.urlUpdateStrategy&&(c.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,c),this.browserUrlTree=c.urlAfterRedirects)}),((n,t,e)=>_n(r=>(new Bfe(t,r.targetRouterState,r.currentRouterState,e).activate(n),r)))(this.rootContexts,this.routeReuseStrategy,c=>this.triggerEvent(c)),_2({next(){i=!0},complete(){i=!0}}),HA(()=>{i||o||this.cancelNavigationTransition(s,"",1),this.currentNavigation?.id===s.id&&(this.currentNavigation=null)}),A0(c=>{if(o=!0,ej(c)){Jq(c)||(this.navigated=!0,this.restoreHistory(s,!0));const u=new nE(s.id,this.serializeUrl(s.extractedUrl),c.message,c.cancellationCode);if(r.next(u),Jq(c)){const d=this.urlHandlingStrategy.merge(c.url,this.rawUrlTree),g={skipLocationChange:s.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||Ej(s.source)};this.scheduleNavigation(d,"imperative",null,g,{resolve:s.resolve,reject:s.reject,promise:s.promise})}else s.resolve(!1)}else{this.restoreHistory(s,!0);const u=new Uq(s.id,this.serializeUrl(s.extractedUrl),c,s.targetSnapshot??void 0);r.next(u);try{s.resolve(this.errorHandler(c))}catch(d){s.reject(d)}}return hc}))}))}resetRootComponentType(e){this.rootComponentType=e,this.routerState.root.component=this.rootComponentType}setTransition(e){this.transitions.next({...this.transitions.value,...e})}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(e=>{const r="popstate"===e.type?"popstate":"hashchange";"popstate"===r&&setTimeout(()=>{const s={replaceUrl:!0},i=e.state?.navigationId?e.state:null;if(i){const c={...i};delete c.navigationId,delete c.\u0275routerPageId,0!==Object.keys(c).length&&(s.state=c)}const o=this.parseUrl(e.url);this.scheduleNavigation(o,r,i,s)},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(e){this.events.next(e)}resetConfig(e){this.config=e.map(rN),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(e,r={}){const{relativeTo:s,queryParams:i,fragment:o,queryParamsHandling:c,preserveFragment:u}=r,d=s||this.routerState.root,g=u?this.currentUrlTree.fragment:o;let m=null;switch(c){case"merge":m={...this.currentUrlTree.queryParams,...i};break;case"preserve":m=this.currentUrlTree.queryParams;break;default:m=i||null}return null!==m&&(m=this.removeEmptyProps(m)),ffe(d,this.currentUrlTree,e,m,g??null)}navigateByUrl(e,r={skipLocationChange:!1}){const s=ku(e)?e:this.parseUrl(e),i=this.urlHandlingStrategy.merge(s,this.rawUrlTree);return this.scheduleNavigation(i,"imperative",null,r)}navigate(e,r={skipLocationChange:!1}){return function Ude(n){for(let t=0;t<n.length;t++){if(null==n[t])throw new Ie(4008,false)}}(e),this.navigateByUrl(this.createUrlTree(e,r),r)}serializeUrl(e){return this.urlSerializer.serialize(e)}parseUrl(e){let r;try{r=this.urlSerializer.parse(e)}catch(s){r=this.malformedUriErrorHandler(s,this.urlSerializer,e)}return r}isActive(e,r){let s;if(s=!0===r?{...Fde}:!1===r?{...Bde}:r,ku(e))return Aq(this.currentUrlTree,e,s);const i=this.parseUrl(e);return Aq(this.currentUrlTree,i,s)}removeEmptyProps(e){return Object.keys(e).reduce((r,s)=>{const i=e[s];return null!=i&&(r[s]=i),r},{})}processNavigations(){this.navigations.subscribe(e=>{this.navigated=!0,this.lastSuccessfulId=e.id,this.currentPageId=e.targetPageId,this.events.next(new I0(e.id,this.serializeUrl(e.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,this.titleStrategy?.updateTitle(this.routerState.snapshot),e.resolve(!0)},e=>{this.console.warn(`Unhandled Navigation Error: ${e}`)})}scheduleNavigation(e,r,s,i,o){if(this.disposed)return Promise.resolve(!1);let c,u,d;o?(c=o.resolve,u=o.reject,d=o.promise):d=new Promise((y,b)=>{c=y,u=b});const g=++this.navigationId;let m;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(s=this.location.getState()),m=s&&s.\u0275routerPageId?s.\u0275routerPageId:i.replaceUrl||i.skipLocationChange?this.browserPageId??0:(this.browserPageId??0)+1):m=0,this.setTransition({id:g,targetPageId:m,source:r,restoredState:s,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:e,extras:i,resolve:c,reject:u,promise:d,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),d.catch(y=>Promise.reject(y))}setBrowserUrl(e,r){const s=this.urlSerializer.serialize(e),i={...r.extras.state,...this.generateNgRouterState(r.id,r.targetPageId)};this.location.isCurrentPathEqualTo(s)||r.extras.replaceUrl?this.location.replaceState(s,"",i):this.location.go(s,"",i)}restoreHistory(e,r=!1){if("computed"===this.canceledNavigationResolution){const s=this.currentPageId-e.targetPageId;"popstate"!==e.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==this.currentNavigation?.finalUrl||0===s?this.currentUrlTree===this.currentNavigation?.finalUrl&&0===s&&(this.resetState(e),this.browserUrlTree=e.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(s)}else"replace"===this.canceledNavigationResolution&&(r&&this.resetState(e),this.resetUrlToCurrentUrlTree())}resetState(e){this.routerState=e.currentRouterState,this.currentUrlTree=e.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,e.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}cancelNavigationTransition(e,r,s){const i=new nE(e.id,this.serializeUrl(e.extractedUrl),r,s);this.triggerEvent(i),e.resolve(!1)}generateNgRouterState(e,r){return"computed"===this.canceledNavigationResolution?{navigationId:e,\u0275routerPageId:r}:{navigationId:e}}}return n.\u0275fac=function(e){W7()},n.\u0275prov=rt({token:n,factory:function(){return yj()},providedIn:"root"}),n})();function Ej(n){return"imperative"!==n}let Gp=(()=>{class n{constructor(e,r,s,i,o){this.router=e,this.route=r,this.tabIndexAttribute=s,this.renderer=i,this.el=o,this._preserveFragment=!1,this._skipLocationChange=!1,this._replaceUrl=!1,this.commands=null,this.onChanges=new F2,this.setTabIndexIfNotOnNativeEl("0")}set preserveFragment(e){this._preserveFragment=Il(e)}get preserveFragment(){return this._preserveFragment}set skipLocationChange(e){this._skipLocationChange=Il(e)}get skipLocationChange(){return this._skipLocationChange}set replaceUrl(e){this._replaceUrl=Il(e)}get replaceUrl(){return this._replaceUrl}setTabIndexIfNotOnNativeEl(e){if(null!=this.tabIndexAttribute)return;const r=this.renderer,s=this.el.nativeElement;null!==e?r.setAttribute(s,"tabindex",e):r.removeAttribute(s,"tabindex")}ngOnChanges(e){this.onChanges.next(this)}set routerLink(e){null!=e?(this.commands=Array.isArray(e)?e:[e],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(){return null===this.urlTree||this.router.navigateByUrl(this.urlTree,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state}),!0}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}}return n.\u0275fac=function(e){return new(e||n)(J(Kn),J(bo),U8("tabindex"),J(yo),J(f2))},n.\u0275dir=Gt({type:n,selectors:[["","routerLink","",5,"a",5,"area"]],hostBindings:function(e,r){1&e&&ee("click",function(){return r.onClick()})},inputs:{queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",relativeTo:"relativeTo",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",routerLink:"routerLink"},standalone:!0,features:[n2]}),n})(),Lu=(()=>{class n{constructor(e,r,s){this.router=e,this.route=r,this.locationStrategy=s,this._preserveFragment=!1,this._skipLocationChange=!1,this._replaceUrl=!1,this.commands=null,this.href=null,this.onChanges=new F2,this.subscription=e.events.subscribe(i=>{i instanceof I0&&this.updateTargetUrlAndHref()})}set preserveFragment(e){this._preserveFragment=Il(e)}get preserveFragment(){return this._preserveFragment}set skipLocationChange(e){this._skipLocationChange=Il(e)}get skipLocationChange(){return this._skipLocationChange}set replaceUrl(e){this._replaceUrl=Il(e)}get replaceUrl(){return this._replaceUrl}set routerLink(e){this.commands=null!=e?Array.isArray(e)?e:[e]:null}ngOnChanges(e){this.updateTargetUrlAndHref(),this.onChanges.next(this)}ngOnDestroy(){this.subscription.unsubscribe()}onClick(e,r,s,i,o){return!!(0!==e||r||s||i||o||"string"==typeof this.target&&"_self"!=this.target||null===this.urlTree)||(this.router.navigateByUrl(this.urlTree,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state}),!1)}updateTargetUrlAndHref(){this.href=null!==this.urlTree?this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}}return n.\u0275fac=function(e){return new(e||n)(J(Kn),J(bo),J(Pu))},n.\u0275dir=Gt({type:n,selectors:[["a","routerLink",""],["area","routerLink",""]],hostVars:2,hostBindings:function(e,r){1&e&&ee("click",function(i){return r.onClick(i.button,i.ctrlKey,i.shiftKey,i.altKey,i.metaKey)}),2&e&&z("target",r.target)("href",r.href,g3)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",relativeTo:"relativeTo",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",routerLink:"routerLink"},standalone:!0,features:[n2]}),n})();class Mj{}let qde=(()=>{class n{constructor(e,r,s,i,o){this.router=e,this.injector=s,this.preloadingStrategy=i,this.loader=o}setUpPreloading(){this.subscription=this.router.events.pipe(Rl(e=>e instanceof I0),w0(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(e,r){const s=[];for(const i of r){i.providers&&!i._injector&&(i._injector=ay(i.providers,e,`Route: ${i.path}`));const o=i._injector??e,c=i._loadedInjector??o;i.loadChildren&&!i._loadedRoutes&&void 0===i.canLoad||i.loadComponent&&!i._loadedComponent?s.push(this.preloadConfig(o,i)):(i.children||i._loadedRoutes)&&s.push(this.processRoutes(c,i.children??i._loadedRoutes))}return us(s).pipe(nl())}preloadConfig(e,r){return this.preloadingStrategy.preload(r,()=>{let s;s=r.loadChildren&&void 0===r.canLoad?this.loader.loadChildren(e,r):Yt(null);const i=s.pipe(He(o=>null===o?Yt(void 0):(r._loadedRoutes=o.routes,r._loadedInjector=o.injector,this.processRoutes(o.injector??e,o.routes))));return r.loadComponent&&!r._loadedComponent?us([i,this.loader.loadComponent(r)]).pipe(nl()):i})}}return n.\u0275fac=function(e){return new(e||n)(Ve(Kn),Ve(AO),Ve(Ia),Ve(Mj),Ve(lN))},n.\u0275prov=rt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const uN=new Lt("");let Sj=(()=>{class n{constructor(e,r,s={}){this.router=e,this.viewportScroller=r,this.options=s,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},s.scrollPositionRestoration=s.scrollPositionRestoration||"disabled",s.anchorScrolling=s.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(e=>{e instanceof jA?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=e.navigationTrigger,this.restoredId=e.restoredState?e.restoredState.navigationId:0):e instanceof I0&&(this.lastId=e.id,this.scheduleScrollEvent(e,this.router.parseUrl(e.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(e=>{e instanceof Gq&&(e.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(e.position):e.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(e.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(e,r){this.router.triggerEvent(new Gq(e,"popstate"===this.lastSource?this.store[this.restoredId]:null,r))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return n.\u0275fac=function(e){W7()},n.\u0275prov=rt({token:n,factory:n.\u0275fac}),n})();function Pf(n,t){return{\u0275kind:n,\u0275providers:t}}function fN(n){return[{provide:cN,multi:!0,useValue:n}]}function Tj(){const n=Dr(fi);return t=>{const e=n.get(dp);if(t!==e.components[0])return;const r=n.get(Kn),s=n.get(wj);1===n.get(dN)&&r.initialNavigation(),n.get(bj,null,Zt.Optional)?.setUpPreloading(),n.get(uN,null,Zt.Optional)?.init(),r.resetRootComponentType(e.componentTypes[0]),s.next(),s.complete()}}const wj=new Lt("",{factory:()=>new F2}),dN=new Lt("",{providedIn:"root",factory:()=>1});const bj=new Lt("");function Kde(n){return Pf(0,[{provide:bj,useExisting:qde},{provide:Mj,useExisting:n}])}const Oj=new Lt("ROUTER_FORROOT_GUARD"),Xde=[GO,{provide:kq,useClass:BA},{provide:Kn,useFactory:yj},Vp,{provide:bo,useFactory:function Pj(n){return n.routerState.root},deps:[Kn]},lN];function Qde(){return new VU("Router",Kn)}let Jde=(()=>{class n{constructor(e){}static forRoot(e,r){return{ngModule:n,providers:[Xde,[],fN(e),{provide:Oj,useFactory:rhe,deps:[[Kn,new ui,new K8]]},{provide:dE,useValue:r||{}},r?.useHash?{provide:Pu,useClass:s8e}:{provide:Pu,useClass:lG},{provide:uN,useFactory:()=>{const n=Dr(Kn),t=Dr(Mue),e=Dr(dE);return e.scrollOffset&&t.setOffset(e.scrollOffset),new Sj(n,t,e)}},r?.preloadingStrategy?Kde(r.preloadingStrategy).\u0275providers:[],{provide:VU,multi:!0,useFactory:Qde},r?.initialNavigation?she(r):[],[{provide:Aj,useFactory:Tj},{provide:NU,multi:!0,useExisting:Aj}]]}}static forChild(e){return{ngModule:n,providers:[fN(e)]}}}return n.\u0275fac=function(e){return new(e||n)(Ve(Oj,8))},n.\u0275mod=oi({type:n}),n.\u0275inj=Yr({imports:[tN]}),n})();function rhe(n){return"guarded"}function she(n){return["disabled"===n.initialNavigation?Pf(3,[{provide:fy,multi:!0,useFactory:()=>{const t=Dr(Kn);return()=>{t.setUpLocationChangeListener()}}},{provide:dN,useValue:2}]).\u0275providers:[],"enabledBlocking"===n.initialNavigation?Pf(2,[{provide:dN,useValue:0},{provide:fy,multi:!0,deps:[fi],useFactory:t=>{const e=t.get(n8e,Promise.resolve());let r=!1;return()=>e.then(()=>new Promise(i=>{const o=t.get(Kn),c=t.get(wj);(function s(i){t.get(Kn).events.pipe(Rl(c=>c instanceof I0||c instanceof nE||c instanceof Uq),_n(c=>c instanceof I0||c instanceof nE&&(0===c.code||1===c.code)&&null),Rl(c=>null!==c),Np(1)).subscribe(()=>{i()})})(()=>{i(!0),r=!0}),o.afterPreactivation=()=>(i(!0),r||c.closed?Yt(void 0):c),o.initialNavigation()}))}}]).\u0275providers:[]]}const Aj=new Lt("");class Nj{}const Hl="*";function Ij(n,t=null){return{type:2,steps:n,options:t}}function xj(n){return{type:6,styles:n,offset:null}}function kj(n){Promise.resolve().then(n)}class Wp{constructor(t=0,e=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=t+e}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}onStart(t){this._originalOnStartFns.push(t),this._onStartFns.push(t)}onDone(t){this._originalOnDoneFns.push(t),this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){kj(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(t=>t()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(t){this._position=this.totalTime?t*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(r=>r()),e.length=0}}class Lj{constructor(t){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=t;let e=0,r=0,s=0;const i=this.players.length;0==i?kj(()=>this._onFinish()):this.players.forEach(o=>{o.onDone(()=>{++e==i&&this._onFinish()}),o.onDestroy(()=>{++r==i&&this._onDestroy()}),o.onStart(()=>{++s==i&&this._onStart()})}),this.totalTime=this.players.reduce((o,c)=>Math.max(o,c.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this.players.forEach(t=>t.init())}onStart(t){this._onStartFns.push(t)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(t=>t()),this._onStartFns=[])}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(t=>t.play())}pause(){this.players.forEach(t=>t.pause())}restart(){this.players.forEach(t=>t.restart())}finish(){this._onFinish(),this.players.forEach(t=>t.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(t=>t.destroy()),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this.players.forEach(t=>t.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(t){const e=t*this.totalTime;this.players.forEach(r=>{const s=r.totalTime?Math.min(1,e/r.totalTime):1;r.setPosition(s)})}getPosition(){const t=this.players.reduce((e,r)=>null===e||r.totalTime>e.totalTime?r:e,null);return null!=t?t.getPosition():0}beforeDestroy(){this.players.forEach(t=>{t.beforeDestroy&&t.beforeDestroy()})}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(r=>r()),e.length=0}}function Rj(n){return new Ie(3e3,!1)}function Bhe(){return typeof window<"u"&&typeof window.document<"u"}function pN(){return typeof process<"u"&&"[object process]"==={}.toString.call(process)}function x0(n){switch(n.length){case 0:return new Wp;case 1:return n[0];default:return new Lj(n)}}function Dj(n,t,e,r,s=new Map,i=new Map){const o=[],c=[];let u=-1,d=null;if(r.forEach(g=>{const m=g.get("offset"),y=m==u,b=y&&d||new Map;g.forEach((k,$)=>{let K=$,oe=k;if("offset"!==$)switch(K=t.normalizePropertyName(K,o),oe){case"!":oe=s.get($);break;case Hl:oe=i.get($);break;default:oe=t.normalizeStyleValue($,K,oe,o)}b.set(K,oe)}),y||c.push(b),d=b,u=m}),o.length)throw function Ahe(n){return new Ie(3502,!1)}();return c}function gN(n,t,e,r){switch(t){case"start":n.onStart(()=>r(e&&mN(e,"start",n)));break;case"done":n.onDone(()=>r(e&&mN(e,"done",n)));break;case"destroy":n.onDestroy(()=>r(e&&mN(e,"destroy",n)))}}function mN(n,t,e){const i=_N(n.element,n.triggerName,n.fromState,n.toState,t||n.phaseName,e.totalTime??n.totalTime,!!e.disabled),o=n._data;return null!=o&&(i._data=o),i}function _N(n,t,e,r,s="",i=0,o){return{element:n,triggerName:t,fromState:e,toState:r,phaseName:s,totalTime:i,disabled:!!o}}function Fa(n,t,e){let r=n.get(t);return r||n.set(t,r=e),r}function zj(n){const t=n.indexOf(":");return[n.substring(1,t),n.slice(t+1)]}let vN=(n,t)=>!1,Vj=(n,t,e)=>[],Hj=null;function CN(n){const t=n.parentNode||n.host;return t===Hj?null:t}(pN()||typeof Element<"u")&&(Bhe()?(Hj=(()=>document.documentElement)(),vN=(n,t)=>{for(;t;){if(t===n)return!0;t=CN(t)}return!1}):vN=(n,t)=>n.contains(t),Vj=(n,t,e)=>{if(e)return Array.from(n.querySelectorAll(t));const r=n.querySelector(t);return r?[r]:[]});let Ru=null,Fj=!1;const Bj=vN,$j=Vj;let Uj=(()=>{class n{validateStyleProperty(e){return function Uhe(n){Ru||(Ru=function Ghe(){return typeof document<"u"?document.body:null}()||{},Fj=!!Ru.style&&"WebkitAppearance"in Ru.style);let t=!0;return Ru.style&&!function $he(n){return"ebkit"==n.substring(1,6)}(n)&&(t=n in Ru.style,!t&&Fj&&(t="Webkit"+n.charAt(0).toUpperCase()+n.slice(1)in Ru.style)),t}(e)}matchesElement(e,r){return!1}containsElement(e,r){return Bj(e,r)}getParentElement(e){return CN(e)}query(e,r,s){return $j(e,r,s)}computeStyle(e,r,s){return s||""}animate(e,r,s,i,o,c=[],u){return new Wp(s,i)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=rt({token:n,factory:n.\u0275fac}),n})(),yN=(()=>{class n{}return n.NOOP=new Uj,n})();const EN="ng-enter",mE="ng-leave",_E="ng-trigger",vE=".ng-trigger",Wj="ng-animating",MN=".ng-animating";function Fl(n){if("number"==typeof n)return n;const t=n.match(/^(-?[\.\d]+)(m?s)/);return!t||t.length<2?0:SN(parseFloat(t[1]),t[2])}function SN(n,t){return"s"===t?1e3*n:n}function CE(n,t,e){return n.hasOwnProperty("duration")?n:function jhe(n,t,e){let s,i=0,o="";if("string"==typeof n){const c=n.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===c)return t.push(Rj()),{duration:0,delay:0,easing:""};s=SN(parseFloat(c[1]),c[2]);const u=c[3];null!=u&&(i=SN(parseFloat(u),c[4]));const d=c[5];d&&(o=d)}else s=n;if(!e){let c=!1,u=t.length;s<0&&(t.push(function ahe(){return new Ie(3100,!1)}()),c=!0),i<0&&(t.push(function che(){return new Ie(3101,!1)}()),c=!0),c&&t.splice(u,0,Rj())}return{duration:s,delay:i,easing:o}}(n,t,e)}function qp(n,t={}){return Object.keys(n).forEach(e=>{t[e]=n[e]}),t}function qj(n){const t=new Map;return Object.keys(n).forEach(e=>{t.set(e,n[e])}),t}function k0(n,t=new Map,e){if(e)for(let[r,s]of e)t.set(r,s);for(let[r,s]of n)t.set(r,s);return t}function Zj(n,t,e){return e?t+":"+e+";":""}function Yj(n){let t="";for(let e=0;e<n.style.length;e++){const r=n.style.item(e);t+=Zj(0,r,n.style.getPropertyValue(r))}for(const e in n.style)n.style.hasOwnProperty(e)&&!e.startsWith("_")&&(t+=Zj(0,Xhe(e),n.style[e]));n.setAttribute("style",t)}function w4(n,t,e){n.style&&(t.forEach((r,s)=>{const i=TN(s);e&&!e.has(s)&&e.set(s,n.style[i]),n.style[i]=r}),pN()&&Yj(n))}function Du(n,t){n.style&&(t.forEach((e,r)=>{const s=TN(r);n.style[s]=""}),pN()&&Yj(n))}function jp(n){return Array.isArray(n)?1==n.length?n[0]:Ij(n):n}const PN=new RegExp("{{\\s*(.+?)\\s*}}","g");function Kj(n){let t=[];if("string"==typeof n){let e;for(;e=PN.exec(n);)t.push(e[1]);PN.lastIndex=0}return t}function Zp(n,t,e){const r=n.toString(),s=r.replace(PN,(i,o)=>{let c=t[o];return null==c&&(e.push(function uhe(n){return new Ie(3003,!1)}()),c=""),c.toString()});return s==r?n:s}function yE(n){const t=[];let e=n.next();for(;!e.done;)t.push(e.value),e=n.next();return t}const Khe=/-+([a-z0-9])/g;function TN(n){return n.replace(Khe,(...t)=>t[1].toUpperCase())}function Xhe(n){return n.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function Ba(n,t,e){switch(t.type){case 7:return n.visitTrigger(t,e);case 0:return n.visitState(t,e);case 1:return n.visitTransition(t,e);case 2:return n.visitSequence(t,e);case 3:return n.visitGroup(t,e);case 4:return n.visitAnimate(t,e);case 5:return n.visitKeyframes(t,e);case 6:return n.visitStyle(t,e);case 8:return n.visitReference(t,e);case 9:return n.visitAnimateChild(t,e);case 10:return n.visitAnimateRef(t,e);case 11:return n.visitQuery(t,e);case 12:return n.visitStagger(t,e);default:throw function fhe(n){return new Ie(3004,!1)}()}}function Xj(n,t){return window.getComputedStyle(n)[t]}function r9e(n,t){const e=[];return"string"==typeof n?n.split(/\s*,\s*/).forEach(r=>function s9e(n,t,e){if(":"==n[0]){const u=function i9e(n,t){switch(n){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(e,r)=>parseFloat(r)>parseFloat(e);case":decrement":return(e,r)=>parseFloat(r)<parseFloat(e);default:return t.push(function The(n){return new Ie(3016,!1)}()),"* => *"}}(n,e);if("function"==typeof u)return void t.push(u);n=u}const r=n.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==r||r.length<4)return e.push(function Phe(n){return new Ie(3015,!1)}()),t;const s=r[1],i=r[2],o=r[3];t.push(Qj(s,o));"<"==i[0]&&!("*"==s&&"*"==o)&&t.push(Qj(o,s))}(r,e,t)):e.push(n),e}const PE=new Set(["true","1"]),TE=new Set(["false","0"]);function Qj(n,t){const e=PE.has(n)||TE.has(n),r=PE.has(t)||TE.has(t);return(s,i)=>{let o="*"==n||n==s,c="*"==t||t==i;return!o&&e&&"boolean"==typeof s&&(o=s?PE.has(n):TE.has(n)),!c&&r&&"boolean"==typeof i&&(c=i?PE.has(t):TE.has(t)),o&&c}}const o9e=new RegExp("s*:selfs*,?","g");function wN(n,t,e,r){return new a9e(n).build(t,e,r)}class a9e{constructor(t){this._driver=t}build(t,e,r){const s=new u9e(e);return this._resetContextStyleTimingState(s),Ba(this,jp(t),s)}_resetContextStyleTimingState(t){t.currentQuerySelector="",t.collectedStyles=new Map,t.collectedStyles.set("",new Map),t.currentTime=0}visitTrigger(t,e){let r=e.queryCount=0,s=e.depCount=0;const i=[],o=[];return"@"==t.name.charAt(0)&&e.errors.push(function hhe(){return new Ie(3006,!1)}()),t.definitions.forEach(c=>{if(this._resetContextStyleTimingState(e),0==c.type){const u=c,d=u.name;d.toString().split(/\s*,\s*/).forEach(g=>{u.name=g,i.push(this.visitState(u,e))}),u.name=d}else if(1==c.type){const u=this.visitTransition(c,e);r+=u.queryCount,s+=u.depCount,o.push(u)}else e.errors.push(function phe(){return new Ie(3007,!1)}())}),{type:7,name:t.name,states:i,transitions:o,queryCount:r,depCount:s,options:null}}visitState(t,e){const r=this.visitStyle(t.styles,e),s=t.options&&t.options.params||null;if(r.containsDynamicStyles){const i=new Set,o=s||{};r.styles.forEach(c=>{c instanceof Map&&c.forEach(u=>{Kj(u).forEach(d=>{o.hasOwnProperty(d)||i.add(d)})})}),i.size&&(yE(i.values()),e.errors.push(function ghe(n,t){return new Ie(3008,!1)}()))}return{type:0,name:t.name,style:r,options:s?{params:s}:null}}visitTransition(t,e){e.queryCount=0,e.depCount=0;const r=Ba(this,jp(t.animation),e);return{type:1,matchers:r9e(t.expr,e.errors),animation:r,queryCount:e.queryCount,depCount:e.depCount,options:zu(t.options)}}visitSequence(t,e){return{type:2,steps:t.steps.map(r=>Ba(this,r,e)),options:zu(t.options)}}visitGroup(t,e){const r=e.currentTime;let s=0;const i=t.steps.map(o=>{e.currentTime=r;const c=Ba(this,o,e);return s=Math.max(s,e.currentTime),c});return e.currentTime=s,{type:3,steps:i,options:zu(t.options)}}visitAnimate(t,e){const r=function d9e(n,t){if(n.hasOwnProperty("duration"))return n;if("number"==typeof n)return bN(CE(n,t).duration,0,"");const e=n;if(e.split(/\s+/).some(i=>"{"==i.charAt(0)&&"{"==i.charAt(1))){const i=bN(0,0,"");return i.dynamic=!0,i.strValue=e,i}const s=CE(e,t);return bN(s.duration,s.delay,s.easing)}(t.timings,e.errors);e.currentAnimateTimings=r;let s,i=t.styles?t.styles:xj({});if(5==i.type)s=this.visitKeyframes(i,e);else{let o=t.styles,c=!1;if(!o){c=!0;const d={};r.easing&&(d.easing=r.easing),o=xj(d)}e.currentTime+=r.duration+r.delay;const u=this.visitStyle(o,e);u.isEmptyStep=c,s=u}return e.currentAnimateTimings=null,{type:4,timings:r,style:s,options:null}}visitStyle(t,e){const r=this._makeStyleAst(t,e);return this._validateStyleAst(r,e),r}_makeStyleAst(t,e){const r=[],s=Array.isArray(t.styles)?t.styles:[t.styles];for(let c of s)"string"==typeof c?c===Hl?r.push(c):e.errors.push(new Ie(3002,!1)):r.push(qj(c));let i=!1,o=null;return r.forEach(c=>{if(c instanceof Map&&(c.has("easing")&&(o=c.get("easing"),c.delete("easing")),!i))for(let u of c.values())if(u.toString().indexOf("{{")>=0){i=!0;break}}),{type:6,styles:r,easing:o,offset:t.offset,containsDynamicStyles:i,options:null}}_validateStyleAst(t,e){const r=e.currentAnimateTimings;let s=e.currentTime,i=e.currentTime;r&&i>0&&(i-=r.duration+r.delay),t.styles.forEach(o=>{"string"!=typeof o&&o.forEach((c,u)=>{const d=e.collectedStyles.get(e.currentQuerySelector),g=d.get(u);let m=!0;g&&(i!=s&&i>=g.startTime&&s<=g.endTime&&(e.errors.push(function _he(n,t,e,r,s){return new Ie(3010,!1)}()),m=!1),i=g.startTime),m&&d.set(u,{startTime:i,endTime:s}),e.options&&function Yhe(n,t,e){const r=t.params||{},s=Kj(n);s.length&&s.forEach(i=>{r.hasOwnProperty(i)||e.push(function lhe(n){return new Ie(3001,!1)}())})}(c,e.options,e.errors)})})}visitKeyframes(t,e){const r={type:5,styles:[],options:null};if(!e.currentAnimateTimings)return e.errors.push(function vhe(){return new Ie(3011,!1)}()),r;let i=0;const o=[];let c=!1,u=!1,d=0;const g=t.steps.map(oe=>{const ye=this._makeStyleAst(oe,e);let te=null!=ye.offset?ye.offset:function f9e(n){if("string"==typeof n)return null;let t=null;if(Array.isArray(n))n.forEach(e=>{if(e instanceof Map&&e.has("offset")){const r=e;t=parseFloat(r.get("offset")),r.delete("offset")}});else if(n instanceof Map&&n.has("offset")){const e=n;t=parseFloat(e.get("offset")),e.delete("offset")}return t}(ye.styles),Le=0;return null!=te&&(i++,Le=ye.offset=te),u=u||Le<0||Le>1,c=c||Le<d,d=Le,o.push(Le),ye});u&&e.errors.push(function Che(){return new Ie(3012,!1)}()),c&&e.errors.push(function yhe(){return new Ie(3200,!1)}());const m=t.steps.length;let y=0;i>0&&i<m?e.errors.push(function Ehe(){return new Ie(3202,!1)}()):0==i&&(y=1/(m-1));const b=m-1,k=e.currentTime,$=e.currentAnimateTimings,K=$.duration;return g.forEach((oe,ye)=>{const te=y>0?ye==b?1:y*ye:o[ye],Le=te*K;e.currentTime=k+$.delay+Le,$.duration=Le,this._validateStyleAst(oe,e),oe.offset=te,r.styles.push(oe)}),r}visitReference(t,e){return{type:8,animation:Ba(this,jp(t.animation),e),options:zu(t.options)}}visitAnimateChild(t,e){return e.depCount++,{type:9,options:zu(t.options)}}visitAnimateRef(t,e){return{type:10,animation:this.visitReference(t.animation,e),options:zu(t.options)}}visitQuery(t,e){const r=e.currentQuerySelector,s=t.options||{};e.queryCount++,e.currentQuery=t;const[i,o]=function c9e(n){const t=!!n.split(/\s*,\s*/).find(e=>":self"==e);return t&&(n=n.replace(o9e,"")),n=n.replace(/@\*/g,vE).replace(/@\w+/g,e=>vE+"-"+e.slice(1)).replace(/:animating/g,MN),[n,t]}(t.selector);e.currentQuerySelector=r.length?r+" "+i:i,Fa(e.collectedStyles,e.currentQuerySelector,new Map);const c=Ba(this,jp(t.animation),e);return e.currentQuery=null,e.currentQuerySelector=r,{type:11,selector:i,limit:s.limit||0,optional:!!s.optional,includeSelf:o,animation:c,originalSelector:t.selector,options:zu(t.options)}}visitStagger(t,e){e.currentQuery||e.errors.push(function Mhe(){return new Ie(3013,!1)}());const r="full"===t.timings?{duration:0,delay:0,easing:"full"}:CE(t.timings,e.errors,!0);return{type:12,animation:Ba(this,jp(t.animation),e),timings:r,options:null}}}class u9e{constructor(t){this.errors=t,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function zu(n){return n?(n=qp(n)).params&&(n.params=function l9e(n){return n?qp(n):null}(n.params)):n={},n}function bN(n,t,e){return{duration:n,delay:t,easing:e}}function ON(n,t,e,r,s,i,o=null,c=!1){return{type:1,element:n,keyframes:t,preStyleProps:e,postStyleProps:r,duration:s,delay:i,totalTime:s+i,easing:o,subTimeline:c}}class wE{constructor(){this._map=new Map}get(t){return this._map.get(t)||[]}append(t,e){let r=this._map.get(t);r||this._map.set(t,r=[]),r.push(...e)}has(t){return this._map.has(t)}clear(){this._map.clear()}}const g9e=new RegExp(":enter","g"),_9e=new RegExp(":leave","g");function AN(n,t,e,r,s,i=new Map,o=new Map,c,u,d=[]){return(new v9e).buildKeyframes(n,t,e,r,s,i,o,c,u,d)}class v9e{buildKeyframes(t,e,r,s,i,o,c,u,d,g=[]){d=d||new wE;const m=new NN(t,e,d,s,i,g,[]);m.options=u;const y=u.delay?Fl(u.delay):0;m.currentTimeline.delayNextStep(y),m.currentTimeline.setStyles([o],null,m.errors,u),Ba(this,r,m);const b=m.timelines.filter(k=>k.containsAnimation());if(b.length&&c.size){let k;for(let $=b.length-1;$>=0;$--){const K=b[$];if(K.element===e){k=K;break}}k&&!k.allowOnlyTimelineStyles()&&k.setStyles([c],null,m.errors,u)}return b.length?b.map(k=>k.buildKeyframes()):[ON(e,[],[],[],0,y,"",!1)]}visitTrigger(t,e){}visitState(t,e){}visitTransition(t,e){}visitAnimateChild(t,e){const r=e.subInstructions.get(e.element);if(r){const s=e.createSubContext(t.options),i=e.currentTimeline.currentTime,o=this._visitSubInstructions(r,s,s.options);i!=o&&e.transformIntoNewTimeline(o)}e.previousNode=t}visitAnimateRef(t,e){const r=e.createSubContext(t.options);r.transformIntoNewTimeline(),this._applyAnimationRefDelays([t.options,t.animation.options],e,r),this.visitReference(t.animation,r),e.transformIntoNewTimeline(r.currentTimeline.currentTime),e.previousNode=t}_applyAnimationRefDelays(t,e,r){for(const s of t){const i=s?.delay;if(i){const o="number"==typeof i?i:Fl(Zp(i,s?.params??{},e.errors));r.delayNextStep(o)}}}_visitSubInstructions(t,e,r){let i=e.currentTimeline.currentTime;const o=null!=r.duration?Fl(r.duration):null,c=null!=r.delay?Fl(r.delay):null;return 0!==o&&t.forEach(u=>{const d=e.appendInstructionToTimeline(u,o,c);i=Math.max(i,d.duration+d.delay)}),i}visitReference(t,e){e.updateOptions(t.options,!0),Ba(this,t.animation,e),e.previousNode=t}visitSequence(t,e){const r=e.subContextCount;let s=e;const i=t.options;if(i&&(i.params||i.delay)&&(s=e.createSubContext(i),s.transformIntoNewTimeline(),null!=i.delay)){6==s.previousNode.type&&(s.currentTimeline.snapshotCurrentStyles(),s.previousNode=bE);const o=Fl(i.delay);s.delayNextStep(o)}t.steps.length&&(t.steps.forEach(o=>Ba(this,o,s)),s.currentTimeline.applyStylesToKeyframe(),s.subContextCount>r&&s.transformIntoNewTimeline()),e.previousNode=t}visitGroup(t,e){const r=[];let s=e.currentTimeline.currentTime;const i=t.options&&t.options.delay?Fl(t.options.delay):0;t.steps.forEach(o=>{const c=e.createSubContext(t.options);i&&c.delayNextStep(i),Ba(this,o,c),s=Math.max(s,c.currentTimeline.currentTime),r.push(c.currentTimeline)}),r.forEach(o=>e.currentTimeline.mergeTimelineCollectedStyles(o)),e.transformIntoNewTimeline(s),e.previousNode=t}_visitTiming(t,e){if(t.dynamic){const r=t.strValue;return CE(e.params?Zp(r,e.params,e.errors):r,e.errors)}return{duration:t.duration,delay:t.delay,easing:t.easing}}visitAnimate(t,e){const r=e.currentAnimateTimings=this._visitTiming(t.timings,e),s=e.currentTimeline;r.delay&&(e.incrementTime(r.delay),s.snapshotCurrentStyles());const i=t.style;5==i.type?this.visitKeyframes(i,e):(e.incrementTime(r.duration),this.visitStyle(i,e),s.applyStylesToKeyframe()),e.currentAnimateTimings=null,e.previousNode=t}visitStyle(t,e){const r=e.currentTimeline,s=e.currentAnimateTimings;!s&&r.hasCurrentStyleProperties()&&r.forwardFrame();const i=s&&s.easing||t.easing;t.isEmptyStep?r.applyEmptyStep(i):r.setStyles(t.styles,i,e.errors,e.options),e.previousNode=t}visitKeyframes(t,e){const r=e.currentAnimateTimings,s=e.currentTimeline.duration,i=r.duration,c=e.createSubContext().currentTimeline;c.easing=r.easing,t.styles.forEach(u=>{c.forwardTime((u.offset||0)*i),c.setStyles(u.styles,u.easing,e.errors,e.options),c.applyStylesToKeyframe()}),e.currentTimeline.mergeTimelineCollectedStyles(c),e.transformIntoNewTimeline(s+i),e.previousNode=t}visitQuery(t,e){const r=e.currentTimeline.currentTime,s=t.options||{},i=s.delay?Fl(s.delay):0;i&&(6===e.previousNode.type||0==r&&e.currentTimeline.hasCurrentStyleProperties())&&(e.currentTimeline.snapshotCurrentStyles(),e.previousNode=bE);let o=r;const c=e.invokeQuery(t.selector,t.originalSelector,t.limit,t.includeSelf,!!s.optional,e.errors);e.currentQueryTotal=c.length;let u=null;c.forEach((d,g)=>{e.currentQueryIndex=g;const m=e.createSubContext(t.options,d);i&&m.delayNextStep(i),d===e.element&&(u=m.currentTimeline),Ba(this,t.animation,m),m.currentTimeline.applyStylesToKeyframe(),o=Math.max(o,m.currentTimeline.currentTime)}),e.currentQueryIndex=0,e.currentQueryTotal=0,e.transformIntoNewTimeline(o),u&&(e.currentTimeline.mergeTimelineCollectedStyles(u),e.currentTimeline.snapshotCurrentStyles()),e.previousNode=t}visitStagger(t,e){const r=e.parentContext,s=e.currentTimeline,i=t.timings,o=Math.abs(i.duration),c=o*(e.currentQueryTotal-1);let u=o*e.currentQueryIndex;switch(i.duration<0?"reverse":i.easing){case"reverse":u=c-u;break;case"full":u=r.currentStaggerTime}const g=e.currentTimeline;u&&g.delayNextStep(u);const m=g.currentTime;Ba(this,t.animation,e),e.previousNode=t,r.currentStaggerTime=s.currentTime-m+(s.startTime-r.currentTimeline.startTime)}}const bE={};class NN{constructor(t,e,r,s,i,o,c,u){this._driver=t,this.element=e,this.subInstructions=r,this._enterClassName=s,this._leaveClassName=i,this.errors=o,this.timelines=c,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=bE,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=u||new OE(this._driver,e,0),c.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(t,e){if(!t)return;const r=t;let s=this.options;null!=r.duration&&(s.duration=Fl(r.duration)),null!=r.delay&&(s.delay=Fl(r.delay));const i=r.params;if(i){let o=s.params;o||(o=this.options.params={}),Object.keys(i).forEach(c=>{(!e||!o.hasOwnProperty(c))&&(o[c]=Zp(i[c],o,this.errors))})}}_copyOptions(){const t={};if(this.options){const e=this.options.params;if(e){const r=t.params={};Object.keys(e).forEach(s=>{r[s]=e[s]})}}return t}createSubContext(t=null,e,r){const s=e||this.element,i=new NN(this._driver,s,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(s,r||0));return i.previousNode=this.previousNode,i.currentAnimateTimings=this.currentAnimateTimings,i.options=this._copyOptions(),i.updateOptions(t),i.currentQueryIndex=this.currentQueryIndex,i.currentQueryTotal=this.currentQueryTotal,i.parentContext=this,this.subContextCount++,i}transformIntoNewTimeline(t){return this.previousNode=bE,this.currentTimeline=this.currentTimeline.fork(this.element,t),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(t,e,r){const s={duration:e??t.duration,delay:this.currentTimeline.currentTime+(r??0)+t.delay,easing:""},i=new C9e(this._driver,t.element,t.keyframes,t.preStyleProps,t.postStyleProps,s,t.stretchStartingKeyframe);return this.timelines.push(i),s}incrementTime(t){this.currentTimeline.forwardTime(this.currentTimeline.duration+t)}delayNextStep(t){t>0&&this.currentTimeline.delayNextStep(t)}invokeQuery(t,e,r,s,i,o){let c=[];if(s&&c.push(this.element),t.length>0){t=(t=t.replace(g9e,"."+this._enterClassName)).replace(_9e,"."+this._leaveClassName);let d=this._driver.query(this.element,t,1!=r);0!==r&&(d=r<0?d.slice(d.length+r,d.length):d.slice(0,r)),c.push(...d)}return!i&&0==c.length&&o.push(function She(n){return new Ie(3014,!1)}()),c}}class OE{constructor(t,e,r,s){this._driver=t,this.element=e,this.startTime=r,this._elementTimelineStylesLookup=s,this.duration=0,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(e),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(e,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(t){const e=1===this._keyframes.size&&this._pendingStyles.size;this.duration||e?(this.forwardTime(this.currentTime+t),e&&this.snapshotCurrentStyles()):this.startTime+=t}fork(t,e){return this.applyStylesToKeyframe(),new OE(this._driver,t,e||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(t){this.applyStylesToKeyframe(),this.duration=t,this._loadKeyframe()}_updateStyle(t,e){this._localTimelineStyles.set(t,e),this._globalTimelineStyles.set(t,e),this._styleSummary.set(t,{time:this.currentTime,value:e})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(t){t&&this._previousKeyframe.set("easing",t);for(let[e,r]of this._globalTimelineStyles)this._backFill.set(e,r||Hl),this._currentKeyframe.set(e,Hl);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(t,e,r,s){e&&this._previousKeyframe.set("easing",e);const i=s&&s.params||{},o=function y9e(n,t){const e=new Map;let r;return n.forEach(s=>{if("*"===s){r=r||t.keys();for(let i of r)e.set(i,Hl)}else k0(s,e)}),e}(t,this._globalTimelineStyles);for(let[c,u]of o){const d=Zp(u,i,r);this._pendingStyles.set(c,d),this._localTimelineStyles.has(c)||this._backFill.set(c,this._globalTimelineStyles.get(c)??Hl),this._updateStyle(c,d)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((t,e)=>{this._currentKeyframe.set(e,t)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((t,e)=>{this._currentKeyframe.has(e)||this._currentKeyframe.set(e,t)}))}snapshotCurrentStyles(){for(let[t,e]of this._localTimelineStyles)this._pendingStyles.set(t,e),this._updateStyle(t,e)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const t=[];for(let e in this._currentKeyframe)t.push(e);return t}mergeTimelineCollectedStyles(t){t._styleSummary.forEach((e,r)=>{const s=this._styleSummary.get(r);(!s||e.time>s.time)&&this._updateStyle(r,e.value)})}buildKeyframes(){this.applyStylesToKeyframe();const t=new Set,e=new Set,r=1===this._keyframes.size&&0===this.duration;let s=[];this._keyframes.forEach((c,u)=>{const d=k0(c,new Map,this._backFill);d.forEach((g,m)=>{"!"===g?t.add(m):g===Hl&&e.add(m)}),r||d.set("offset",u/this.duration),s.push(d)});const i=t.size?yE(t.values()):[],o=e.size?yE(e.values()):[];if(r){const c=s[0],u=new Map(c);c.set("offset",0),u.set("offset",1),s=[c,u]}return ON(this.element,s,i,o,this.duration,this.startTime,this.easing,!1)}}class C9e extends OE{constructor(t,e,r,s,i,o,c=!1){super(t,e,o.delay),this.keyframes=r,this.preStyleProps=s,this.postStyleProps=i,this._stretchStartingKeyframe=c,this.timings={duration:o.duration,delay:o.delay,easing:o.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let t=this.keyframes,{delay:e,duration:r,easing:s}=this.timings;if(this._stretchStartingKeyframe&&e){const i=[],o=r+e,c=e/o,u=k0(t[0]);u.set("offset",0),i.push(u);const d=k0(t[0]);d.set("offset",tZ(c)),i.push(d);const g=t.length-1;for(let m=1;m<=g;m++){let y=k0(t[m]);const b=y.get("offset");y.set("offset",tZ((e+b*r)/o)),i.push(y)}r=o,e=0,s="",t=i}return ON(this.element,t,this.preStyleProps,this.postStyleProps,r,e,s,!0)}}function tZ(n,t=3){const e=Math.pow(10,t-1);return Math.round(n*e)/e}class IN{}const E9e=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class M9e extends IN{normalizePropertyName(t,e){return TN(t)}normalizeStyleValue(t,e,r,s){let i="";const o=r.toString().trim();if(E9e.has(e)&&0!==r&&"0"!==r)if("number"==typeof r)i="px";else{const c=r.match(/^[+-]?[\d\.]+([a-z]*)$/);c&&0==c[1].length&&s.push(function dhe(n,t){return new Ie(3005,!1)}())}return o+i}}function nZ(n,t,e,r,s,i,o,c,u,d,g,m,y){return{type:0,element:n,triggerName:t,isRemovalTransition:s,fromState:e,fromStyles:i,toState:r,toStyles:o,timelines:c,queriedElements:u,preStyleProps:d,postStyleProps:g,totalTime:m,errors:y}}const xN={};class rZ{constructor(t,e,r){this._triggerName=t,this.ast=e,this._stateStyles=r}match(t,e,r,s){return function S9e(n,t,e,r,s){return n.some(i=>i(t,e,r,s))}(this.ast.matchers,t,e,r,s)}buildStyles(t,e,r){let s=this._stateStyles.get("*");return void 0!==t&&(s=this._stateStyles.get(t?.toString())||s),s?s.buildStyles(e,r):new Map}build(t,e,r,s,i,o,c,u,d,g){const m=[],y=this.ast.options&&this.ast.options.params||xN,k=this.buildStyles(r,c&&c.params||xN,m),$=u&&u.params||xN,K=this.buildStyles(s,$,m),oe=new Set,ye=new Map,te=new Map,Le="void"===s,Ge={params:P9e($,y),delay:this.ast.options?.delay},Qe=g?[]:AN(t,e,this.ast.animation,i,o,k,K,Ge,d,m);let Ft=0;if(Qe.forEach(O1=>{Ft=Math.max(O1.duration+O1.delay,Ft)}),m.length)return nZ(e,this._triggerName,r,s,Le,k,K,[],[],ye,te,Ft,m);Qe.forEach(O1=>{const os=O1.element,Xc=Fa(ye,os,new Set);O1.preStyleProps.forEach(H2=>Xc.add(H2));const Uo=Fa(te,os,new Set);O1.postStyleProps.forEach(H2=>Uo.add(H2)),os!==e&&oe.add(os)});const z1=yE(oe.values());return nZ(e,this._triggerName,r,s,Le,k,K,Qe,z1,ye,te,Ft)}}function P9e(n,t){const e=qp(t);for(const r in n)n.hasOwnProperty(r)&&null!=n[r]&&(e[r]=n[r]);return e}class T9e{constructor(t,e,r){this.styles=t,this.defaultParams=e,this.normalizer=r}buildStyles(t,e){const r=new Map,s=qp(this.defaultParams);return Object.keys(t).forEach(i=>{const o=t[i];null!==o&&(s[i]=o)}),this.styles.styles.forEach(i=>{"string"!=typeof i&&i.forEach((o,c)=>{o&&(o=Zp(o,s,e));const u=this.normalizer.normalizePropertyName(c,e);o=this.normalizer.normalizeStyleValue(c,u,o,e),r.set(u,o)})}),r}}class b9e{constructor(t,e,r){this.name=t,this.ast=e,this._normalizer=r,this.transitionFactories=[],this.states=new Map,e.states.forEach(s=>{this.states.set(s.name,new T9e(s.style,s.options&&s.options.params||{},r))}),sZ(this.states,"true","1"),sZ(this.states,"false","0"),e.transitions.forEach(s=>{this.transitionFactories.push(new rZ(t,s,this.states))}),this.fallbackTransition=function O9e(n,t,e){return new rZ(n,{type:1,animation:{type:2,steps:[],options:null},matchers:[(o,c)=>!0],options:null,queryCount:0,depCount:0},t)}(t,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(t,e,r,s){return this.transitionFactories.find(o=>o.match(t,e,r,s))||null}matchStyles(t,e,r){return this.fallbackTransition.buildStyles(t,e,r)}}function sZ(n,t,e){n.has(t)?n.has(e)||n.set(e,n.get(t)):n.has(e)&&n.set(t,n.get(e))}const A9e=new wE;class N9e{constructor(t,e,r){this.bodyNode=t,this._driver=e,this._normalizer=r,this._animations=new Map,this._playersById=new Map,this.players=[]}register(t,e){const r=[],i=wN(this._driver,e,r,[]);if(r.length)throw function Nhe(n){return new Ie(3503,!1)}();this._animations.set(t,i)}_buildPlayer(t,e,r){const s=t.element,i=Dj(0,this._normalizer,0,t.keyframes,e,r);return this._driver.animate(s,i,t.duration,t.delay,t.easing,[],!0)}create(t,e,r={}){const s=[],i=this._animations.get(t);let o;const c=new Map;if(i?(o=AN(this._driver,e,i,EN,mE,new Map,new Map,r,A9e,s),o.forEach(g=>{const m=Fa(c,g.element,new Map);g.postStyleProps.forEach(y=>m.set(y,null))})):(s.push(function Ihe(){return new Ie(3300,!1)}()),o=[]),s.length)throw function xhe(n){return new Ie(3504,!1)}();c.forEach((g,m)=>{g.forEach((y,b)=>{g.set(b,this._driver.computeStyle(m,b,Hl))})});const d=x0(o.map(g=>{const m=c.get(g.element);return this._buildPlayer(g,new Map,m)}));return this._playersById.set(t,d),d.onDestroy(()=>this.destroy(t)),this.players.push(d),d}destroy(t){const e=this._getPlayer(t);e.destroy(),this._playersById.delete(t);const r=this.players.indexOf(e);r>=0&&this.players.splice(r,1)}_getPlayer(t){const e=this._playersById.get(t);if(!e)throw function khe(n){return new Ie(3301,!1)}();return e}listen(t,e,r,s){const i=_N(e,"","","");return gN(this._getPlayer(t),r,i,s),()=>{}}command(t,e,r,s){if("register"==r)return void this.register(t,s[0]);if("create"==r)return void this.create(t,e,s[0]||{});const i=this._getPlayer(t);switch(r){case"play":i.play();break;case"pause":i.pause();break;case"reset":i.reset();break;case"restart":i.restart();break;case"finish":i.finish();break;case"init":i.init();break;case"setPosition":i.setPosition(parseFloat(s[0]));break;case"destroy":this.destroy(t)}}}const iZ="ng-animate-queued",kN="ng-animate-disabled",R9e=[],oZ={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},D9e={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},Ic="__ng_removed";class LN{constructor(t,e=""){this.namespaceId=e;const r=t&&t.hasOwnProperty("value");if(this.value=function F9e(n){return n??null}(r?t.value:t),r){const i=qp(t);delete i.value,this.options=i}else this.options={};this.options.params||(this.options.params={})}get params(){return this.options.params}absorbOptions(t){const e=t.params;if(e){const r=this.options.params;Object.keys(e).forEach(s=>{null==r[s]&&(r[s]=e[s])})}}}const Yp="void",RN=new LN(Yp);class z9e{constructor(t,e,r){this.id=t,this.hostElement=e,this._engine=r,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+t,xc(e,this._hostClassName)}listen(t,e,r,s){if(!this._triggers.has(e))throw function Lhe(n,t){return new Ie(3302,!1)}();if(null==r||0==r.length)throw function Rhe(n){return new Ie(3303,!1)}();if(!function B9e(n){return"start"==n||"done"==n}(r))throw function Dhe(n,t){return new Ie(3400,!1)}();const i=Fa(this._elementListeners,t,[]),o={name:e,phase:r,callback:s};i.push(o);const c=Fa(this._engine.statesByElement,t,new Map);return c.has(e)||(xc(t,_E),xc(t,_E+"-"+e),c.set(e,RN)),()=>{this._engine.afterFlush(()=>{const u=i.indexOf(o);u>=0&&i.splice(u,1),this._triggers.has(e)||c.delete(e)})}}register(t,e){return!this._triggers.has(t)&&(this._triggers.set(t,e),!0)}_getTrigger(t){const e=this._triggers.get(t);if(!e)throw function zhe(n){return new Ie(3401,!1)}();return e}trigger(t,e,r,s=!0){const i=this._getTrigger(e),o=new DN(this.id,e,t);let c=this._engine.statesByElement.get(t);c||(xc(t,_E),xc(t,_E+"-"+e),this._engine.statesByElement.set(t,c=new Map));let u=c.get(e);const d=new LN(r,this.id);if(!(r&&r.hasOwnProperty("value"))&&u&&d.absorbOptions(u.options),c.set(e,d),u||(u=RN),d.value!==Yp&&u.value===d.value){if(!function G9e(n,t){const e=Object.keys(n),r=Object.keys(t);if(e.length!=r.length)return!1;for(let s=0;s<e.length;s++){const i=e[s];if(!t.hasOwnProperty(i)||n[i]!==t[i])return!1}return!0}(u.params,d.params)){const $=[],K=i.matchStyles(u.value,u.params,$),oe=i.matchStyles(d.value,d.params,$);$.length?this._engine.reportError($):this._engine.afterFlush(()=>{Du(t,K),w4(t,oe)})}return}const y=Fa(this._engine.playersByElement,t,[]);y.forEach($=>{$.namespaceId==this.id&&$.triggerName==e&&$.queued&&$.destroy()});let b=i.matchTransition(u.value,d.value,t,d.params),k=!1;if(!b){if(!s)return;b=i.fallbackTransition,k=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:e,transition:b,fromState:u,toState:d,player:o,isFallbackTransition:k}),k||(xc(t,iZ),o.onStart(()=>{Tf(t,iZ)})),o.onDone(()=>{let $=this.players.indexOf(o);$>=0&&this.players.splice($,1);const K=this._engine.playersByElement.get(t);if(K){let oe=K.indexOf(o);oe>=0&&K.splice(oe,1)}}),this.players.push(o),y.push(o),o}deregister(t){this._triggers.delete(t),this._engine.statesByElement.forEach(e=>e.delete(t)),this._elementListeners.forEach((e,r)=>{this._elementListeners.set(r,e.filter(s=>s.name!=t))})}clearElementCache(t){this._engine.statesByElement.delete(t),this._elementListeners.delete(t);const e=this._engine.playersByElement.get(t);e&&(e.forEach(r=>r.destroy()),this._engine.playersByElement.delete(t))}_signalRemovalForInnerTriggers(t,e){const r=this._engine.driver.query(t,vE,!0);r.forEach(s=>{if(s[Ic])return;const i=this._engine.fetchNamespacesByElement(s);i.size?i.forEach(o=>o.triggerLeaveAnimation(s,e,!1,!0)):this.clearElementCache(s)}),this._engine.afterFlushAnimationsDone(()=>r.forEach(s=>this.clearElementCache(s)))}triggerLeaveAnimation(t,e,r,s){const i=this._engine.statesByElement.get(t),o=new Map;if(i){const c=[];if(i.forEach((u,d)=>{if(o.set(d,u.value),this._triggers.has(d)){const g=this.trigger(t,d,Yp,s);g&&c.push(g)}}),c.length)return this._engine.markElementAsRemoved(this.id,t,!0,e,o),r&&x0(c).onDone(()=>this._engine.processLeaveNode(t)),!0}return!1}prepareLeaveAnimationListeners(t){const e=this._elementListeners.get(t),r=this._engine.statesByElement.get(t);if(e&&r){const s=new Set;e.forEach(i=>{const o=i.name;if(s.has(o))return;s.add(o);const u=this._triggers.get(o).fallbackTransition,d=r.get(o)||RN,g=new LN(Yp),m=new DN(this.id,o,t);this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:o,transition:u,fromState:d,toState:g,player:m,isFallbackTransition:!0})})}}removeNode(t,e){const r=this._engine;if(t.childElementCount&&this._signalRemovalForInnerTriggers(t,e),this.triggerLeaveAnimation(t,e,!0))return;let s=!1;if(r.totalAnimations){const i=r.players.length?r.playersByQueriedElement.get(t):[];if(i&&i.length)s=!0;else{let o=t;for(;o=o.parentNode;)if(r.statesByElement.get(o)){s=!0;break}}}if(this.prepareLeaveAnimationListeners(t),s)r.markElementAsRemoved(this.id,t,!1,e);else{const i=t[Ic];(!i||i===oZ)&&(r.afterFlush(()=>this.clearElementCache(t)),r.destroyInnerAnimations(t),r._onRemovalComplete(t,e))}}insertNode(t,e){xc(t,this._hostClassName)}drainQueuedTransitions(t){const e=[];return this._queue.forEach(r=>{const s=r.player;if(s.destroyed)return;const i=r.element,o=this._elementListeners.get(i);o&&o.forEach(c=>{if(c.name==r.triggerName){const u=_N(i,r.triggerName,r.fromState.value,r.toState.value);u._data=t,gN(r.player,c.phase,u,c.callback)}}),s.markedForDestroy?this._engine.afterFlush(()=>{s.destroy()}):e.push(r)}),this._queue=[],e.sort((r,s)=>{const i=r.transition.ast.depCount,o=s.transition.ast.depCount;return 0==i||0==o?i-o:this._engine.driver.containsElement(r.element,s.element)?1:-1})}destroy(t){this.players.forEach(e=>e.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,t)}elementContainsData(t){let e=!1;return this._elementListeners.has(t)&&(e=!0),e=!!this._queue.find(r=>r.element===t)||e,e}}class V9e{constructor(t,e,r){this.bodyNode=t,this.driver=e,this._normalizer=r,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(s,i)=>{}}_onRemovalComplete(t,e){this.onRemovalComplete(t,e)}get queuedPlayers(){const t=[];return this._namespaceList.forEach(e=>{e.players.forEach(r=>{r.queued&&t.push(r)})}),t}createNamespace(t,e){const r=new z9e(t,e,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,e)?this._balanceNamespaceList(r,e):(this.newHostElements.set(e,r),this.collectEnterElement(e)),this._namespaceLookup[t]=r}_balanceNamespaceList(t,e){const r=this._namespaceList,s=this.namespacesByHostElement;if(r.length-1>=0){let o=!1,c=this.driver.getParentElement(e);for(;c;){const u=s.get(c);if(u){const d=r.indexOf(u);r.splice(d+1,0,t),o=!0;break}c=this.driver.getParentElement(c)}o||r.unshift(t)}else r.push(t);return s.set(e,t),t}register(t,e){let r=this._namespaceLookup[t];return r||(r=this.createNamespace(t,e)),r}registerTrigger(t,e,r){let s=this._namespaceLookup[t];s&&s.register(e,r)&&this.totalAnimations++}destroy(t,e){if(!t)return;const r=this._fetchNamespace(t);this.afterFlush(()=>{this.namespacesByHostElement.delete(r.hostElement),delete this._namespaceLookup[t];const s=this._namespaceList.indexOf(r);s>=0&&this._namespaceList.splice(s,1)}),this.afterFlushAnimationsDone(()=>r.destroy(e))}_fetchNamespace(t){return this._namespaceLookup[t]}fetchNamespacesByElement(t){const e=new Set,r=this.statesByElement.get(t);if(r)for(let s of r.values())if(s.namespaceId){const i=this._fetchNamespace(s.namespaceId);i&&e.add(i)}return e}trigger(t,e,r,s){if(AE(e)){const i=this._fetchNamespace(t);if(i)return i.trigger(e,r,s),!0}return!1}insertNode(t,e,r,s){if(!AE(e))return;const i=e[Ic];if(i&&i.setForRemoval){i.setForRemoval=!1,i.setForMove=!0;const o=this.collectedLeaveElements.indexOf(e);o>=0&&this.collectedLeaveElements.splice(o,1)}if(t){const o=this._fetchNamespace(t);o&&o.insertNode(e,r)}s&&this.collectEnterElement(e)}collectEnterElement(t){this.collectedEnterElements.push(t)}markElementAsDisabled(t,e){e?this.disabledNodes.has(t)||(this.disabledNodes.add(t),xc(t,kN)):this.disabledNodes.has(t)&&(this.disabledNodes.delete(t),Tf(t,kN))}removeNode(t,e,r,s){if(AE(e)){const i=t?this._fetchNamespace(t):null;if(i?i.removeNode(e,s):this.markElementAsRemoved(t,e,!1,s),r){const o=this.namespacesByHostElement.get(e);o&&o.id!==t&&o.removeNode(e,s)}}else this._onRemovalComplete(e,s)}markElementAsRemoved(t,e,r,s,i){this.collectedLeaveElements.push(e),e[Ic]={namespaceId:t,setForRemoval:s,hasAnimation:r,removedBeforeQueried:!1,previousTriggersValues:i}}listen(t,e,r,s,i){return AE(e)?this._fetchNamespace(t).listen(e,r,s,i):()=>{}}_buildInstruction(t,e,r,s,i){return t.transition.build(this.driver,t.element,t.fromState.value,t.toState.value,r,s,t.fromState.options,t.toState.options,e,i)}destroyInnerAnimations(t){let e=this.driver.query(t,vE,!0);e.forEach(r=>this.destroyActiveAnimationsForElement(r)),0!=this.playersByQueriedElement.size&&(e=this.driver.query(t,MN,!0),e.forEach(r=>this.finishActiveQueriedAnimationOnElement(r)))}destroyActiveAnimationsForElement(t){const e=this.playersByElement.get(t);e&&e.forEach(r=>{r.queued?r.markedForDestroy=!0:r.destroy()})}finishActiveQueriedAnimationOnElement(t){const e=this.playersByQueriedElement.get(t);e&&e.forEach(r=>r.finish())}whenRenderingDone(){return new Promise(t=>{if(this.players.length)return x0(this.players).onDone(()=>t());t()})}processLeaveNode(t){const e=t[Ic];if(e&&e.setForRemoval){if(t[Ic]=oZ,e.namespaceId){this.destroyInnerAnimations(t);const r=this._fetchNamespace(e.namespaceId);r&&r.clearElementCache(t)}this._onRemovalComplete(t,e.setForRemoval)}t.classList?.contains(kN)&&this.markElementAsDisabled(t,!1),this.driver.query(t,".ng-animate-disabled",!0).forEach(r=>{this.markElementAsDisabled(r,!1)})}flush(t=-1){let e=[];if(this.newHostElements.size&&(this.newHostElements.forEach((r,s)=>this._balanceNamespaceList(r,s)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let r=0;r<this.collectedEnterElements.length;r++)xc(this.collectedEnterElements[r],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const r=[];try{e=this._flushAnimations(r,t)}finally{for(let s=0;s<r.length;s++)r[s]()}}else for(let r=0;r<this.collectedLeaveElements.length;r++)this.processLeaveNode(this.collectedLeaveElements[r]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(r=>r()),this._flushFns=[],this._whenQuietFns.length){const r=this._whenQuietFns;this._whenQuietFns=[],e.length?x0(e).onDone(()=>{r.forEach(s=>s())}):r.forEach(s=>s())}}reportError(t){throw function Vhe(n){return new Ie(3402,!1)}()}_flushAnimations(t,e){const r=new wE,s=[],i=new Map,o=[],c=new Map,u=new Map,d=new Map,g=new Set;this.disabledNodes.forEach(Mt=>{g.add(Mt);const Wt=this.driver.query(Mt,".ng-animate-queued",!0);for(let Jt=0;Jt<Wt.length;Jt++)g.add(Wt[Jt])});const m=this.bodyNode,y=Array.from(this.statesByElement.keys()),b=lZ(y,this.collectedEnterElements),k=new Map;let $=0;b.forEach((Mt,Wt)=>{const Jt=EN+$++;k.set(Wt,Jt),Mt.forEach(i1=>xc(i1,Jt))});const K=[],oe=new Set,ye=new Set;for(let Mt=0;Mt<this.collectedLeaveElements.length;Mt++){const Wt=this.collectedLeaveElements[Mt],Jt=Wt[Ic];Jt&&Jt.setForRemoval&&(K.push(Wt),oe.add(Wt),Jt.hasAnimation?this.driver.query(Wt,".ng-star-inserted",!0).forEach(i1=>oe.add(i1)):ye.add(Wt))}const te=new Map,Le=lZ(y,Array.from(oe));Le.forEach((Mt,Wt)=>{const Jt=mE+$++;te.set(Wt,Jt),Mt.forEach(i1=>xc(i1,Jt))}),t.push(()=>{b.forEach((Mt,Wt)=>{const Jt=k.get(Wt);Mt.forEach(i1=>Tf(i1,Jt))}),Le.forEach((Mt,Wt)=>{const Jt=te.get(Wt);Mt.forEach(i1=>Tf(i1,Jt))}),K.forEach(Mt=>{this.processLeaveNode(Mt)})});const Ge=[],Qe=[];for(let Mt=this._namespaceList.length-1;Mt>=0;Mt--)this._namespaceList[Mt].drainQueuedTransitions(e).forEach(Jt=>{const i1=Jt.player,jt=Jt.element;if(Ge.push(i1),this.collectedEnterElements.length){const co=jt[Ic];if(co&&co.setForMove){if(co.previousTriggersValues&&co.previousTriggersValues.has(Jt.triggerName)){const R5=co.previousTriggersValues.get(Jt.triggerName),Qc=this.statesByElement.get(Jt.element);if(Qc&&Qc.has(Jt.triggerName)){const oT=Qc.get(Jt.triggerName);oT.value=R5,Qc.set(Jt.triggerName,oT)}}return void i1.destroy()}}const X4=!m||!this.driver.containsElement(m,jt),cc=te.get(jt),C8=k.get(jt),as=this._buildInstruction(Jt,r,C8,cc,X4);if(as.errors&&as.errors.length)return void Qe.push(as);if(X4)return i1.onStart(()=>Du(jt,as.fromStyles)),i1.onDestroy(()=>w4(jt,as.toStyles)),void s.push(i1);if(Jt.isFallbackTransition)return i1.onStart(()=>Du(jt,as.fromStyles)),i1.onDestroy(()=>w4(jt,as.toStyles)),void s.push(i1);const _4e=[];as.timelines.forEach(co=>{co.stretchStartingKeyframe=!0,this.disabledNodes.has(co.element)||_4e.push(co)}),as.timelines=_4e,r.append(jt,as.timelines),o.push({instruction:as,player:i1,element:jt}),as.queriedElements.forEach(co=>Fa(c,co,[]).push(i1)),as.preStyleProps.forEach((co,R5)=>{if(co.size){let Qc=u.get(R5);Qc||u.set(R5,Qc=new Set),co.forEach((oT,rF)=>Qc.add(rF))}}),as.postStyleProps.forEach((co,R5)=>{let Qc=d.get(R5);Qc||d.set(R5,Qc=new Set),co.forEach((oT,rF)=>Qc.add(rF))})});if(Qe.length){const Mt=[];Qe.forEach(Wt=>{Mt.push(function Hhe(n,t){return new Ie(3505,!1)}())}),Ge.forEach(Wt=>Wt.destroy()),this.reportError(Mt)}const Ft=new Map,z1=new Map;o.forEach(Mt=>{const Wt=Mt.element;r.has(Wt)&&(z1.set(Wt,Wt),this._beforeAnimationBuild(Mt.player.namespaceId,Mt.instruction,Ft))}),s.forEach(Mt=>{const Wt=Mt.element;this._getPreviousPlayers(Wt,!1,Mt.namespaceId,Mt.triggerName,null).forEach(i1=>{Fa(Ft,Wt,[]).push(i1),i1.destroy()})});const O1=K.filter(Mt=>fZ(Mt,u,d)),os=new Map;cZ(os,this.driver,ye,d,Hl).forEach(Mt=>{fZ(Mt,u,d)&&O1.push(Mt)});const Uo=new Map;b.forEach((Mt,Wt)=>{cZ(Uo,this.driver,new Set(Mt),u,"!")}),O1.forEach(Mt=>{const Wt=os.get(Mt),Jt=Uo.get(Mt);os.set(Mt,new Map([...Array.from(Wt?.entries()??[]),...Array.from(Jt?.entries()??[])]))});const H2=[],Xn=[],w6={};o.forEach(Mt=>{const{element:Wt,player:Jt,instruction:i1}=Mt;if(r.has(Wt)){if(g.has(Wt))return Jt.onDestroy(()=>w4(Wt,i1.toStyles)),Jt.disabled=!0,Jt.overrideTotalTime(i1.totalTime),void s.push(Jt);let jt=w6;if(z1.size>1){let cc=Wt;const C8=[];for(;cc=cc.parentNode;){const as=z1.get(cc);if(as){jt=as;break}C8.push(cc)}C8.forEach(as=>z1.set(as,jt))}const X4=this._buildAnimation(Jt.namespaceId,i1,Ft,i,Uo,os);if(Jt.setRealPlayer(X4),jt===w6)H2.push(Jt);else{const cc=this.playersByElement.get(jt);cc&&cc.length&&(Jt.parentPlayer=x0(cc)),s.push(Jt)}}else Du(Wt,i1.fromStyles),Jt.onDestroy(()=>w4(Wt,i1.toStyles)),Xn.push(Jt),g.has(Wt)&&s.push(Jt)}),Xn.forEach(Mt=>{const Wt=i.get(Mt.element);if(Wt&&Wt.length){const Jt=x0(Wt);Mt.setRealPlayer(Jt)}}),s.forEach(Mt=>{Mt.parentPlayer?Mt.syncPlayerEvents(Mt.parentPlayer):Mt.destroy()});for(let Mt=0;Mt<K.length;Mt++){const Wt=K[Mt],Jt=Wt[Ic];if(Tf(Wt,mE),Jt&&Jt.hasAnimation)continue;let i1=[];if(c.size){let X4=c.get(Wt);X4&&X4.length&&i1.push(...X4);let cc=this.driver.query(Wt,MN,!0);for(let C8=0;C8<cc.length;C8++){let as=c.get(cc[C8]);as&&as.length&&i1.push(...as)}}const jt=i1.filter(X4=>!X4.destroyed);jt.length?$9e(this,Wt,jt):this.processLeaveNode(Wt)}return K.length=0,H2.forEach(Mt=>{this.players.push(Mt),Mt.onDone(()=>{Mt.destroy();const Wt=this.players.indexOf(Mt);this.players.splice(Wt,1)}),Mt.play()}),H2}elementContainsData(t,e){let r=!1;const s=e[Ic];return s&&s.setForRemoval&&(r=!0),this.playersByElement.has(e)&&(r=!0),this.playersByQueriedElement.has(e)&&(r=!0),this.statesByElement.has(e)&&(r=!0),this._fetchNamespace(t).elementContainsData(e)||r}afterFlush(t){this._flushFns.push(t)}afterFlushAnimationsDone(t){this._whenQuietFns.push(t)}_getPreviousPlayers(t,e,r,s,i){let o=[];if(e){const c=this.playersByQueriedElement.get(t);c&&(o=c)}else{const c=this.playersByElement.get(t);if(c){const u=!i||i==Yp;c.forEach(d=>{d.queued||!u&&d.triggerName!=s||o.push(d)})}}return(r||s)&&(o=o.filter(c=>!(r&&r!=c.namespaceId||s&&s!=c.triggerName))),o}_beforeAnimationBuild(t,e,r){const i=e.element,o=e.isRemovalTransition?void 0:t,c=e.isRemovalTransition?void 0:e.triggerName;for(const u of e.timelines){const d=u.element,g=d!==i,m=Fa(r,d,[]);this._getPreviousPlayers(d,g,o,c,e.toState).forEach(b=>{const k=b.getRealPlayer();k.beforeDestroy&&k.beforeDestroy(),b.destroy(),m.push(b)})}Du(i,e.fromStyles)}_buildAnimation(t,e,r,s,i,o){const c=e.triggerName,u=e.element,d=[],g=new Set,m=new Set,y=e.timelines.map(k=>{const $=k.element;g.add($);const K=$[Ic];if(K&&K.removedBeforeQueried)return new Wp(k.duration,k.delay);const oe=$!==u,ye=function U9e(n){const t=[];return uZ(n,t),t}((r.get($)||R9e).map(Ft=>Ft.getRealPlayer())).filter(Ft=>!!Ft.element&&Ft.element===$),te=i.get($),Le=o.get($),Ge=Dj(0,this._normalizer,0,k.keyframes,te,Le),Qe=this._buildPlayer(k,Ge,ye);if(k.subTimeline&&s&&m.add($),oe){const Ft=new DN(t,c,$);Ft.setRealPlayer(Qe),d.push(Ft)}return Qe});d.forEach(k=>{Fa(this.playersByQueriedElement,k.element,[]).push(k),k.onDone(()=>function H9e(n,t,e){let r=n.get(t);if(r){if(r.length){const s=r.indexOf(e);r.splice(s,1)}0==r.length&&n.delete(t)}return r}(this.playersByQueriedElement,k.element,k))}),g.forEach(k=>xc(k,Wj));const b=x0(y);return b.onDestroy(()=>{g.forEach(k=>Tf(k,Wj)),w4(u,e.toStyles)}),m.forEach(k=>{Fa(s,k,[]).push(b)}),b}_buildPlayer(t,e,r){return e.length>0?this.driver.animate(t.element,e,t.duration,t.delay,t.easing,r):new Wp(t.duration,t.delay)}}class DN{constructor(t,e,r){this.namespaceId=t,this.triggerName=e,this.element=r,this._player=new Wp,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(t){this._containsRealPlayer||(this._player=t,this._queuedCallbacks.forEach((e,r)=>{e.forEach(s=>gN(t,r,void 0,s))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(t.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(t){this.totalTime=t}syncPlayerEvents(t){const e=this._player;e.triggerCallback&&t.onStart(()=>e.triggerCallback("start")),t.onDone(()=>this.finish()),t.onDestroy(()=>this.destroy())}_queueEvent(t,e){Fa(this._queuedCallbacks,t,[]).push(e)}onDone(t){this.queued&&this._queueEvent("done",t),this._player.onDone(t)}onStart(t){this.queued&&this._queueEvent("start",t),this._player.onStart(t)}onDestroy(t){this.queued&&this._queueEvent("destroy",t),this._player.onDestroy(t)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(t){this.queued||this._player.setPosition(t)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(t){const e=this._player;e.triggerCallback&&e.triggerCallback(t)}}function AE(n){return n&&1===n.nodeType}function aZ(n,t){const e=n.style.display;return n.style.display=t??"none",e}function cZ(n,t,e,r,s){const i=[];e.forEach(u=>i.push(aZ(u)));const o=[];r.forEach((u,d)=>{const g=new Map;u.forEach(m=>{const y=t.computeStyle(d,m,s);g.set(m,y),(!y||0==y.length)&&(d[Ic]=D9e,o.push(d))}),n.set(d,g)});let c=0;return e.forEach(u=>aZ(u,i[c++])),o}function lZ(n,t){const e=new Map;if(n.forEach(c=>e.set(c,[])),0==t.length)return e;const s=new Set(t),i=new Map;function o(c){if(!c)return 1;let u=i.get(c);if(u)return u;const d=c.parentNode;return u=e.has(d)?d:s.has(d)?1:o(d),i.set(c,u),u}return t.forEach(c=>{const u=o(c);1!==u&&e.get(u).push(c)}),e}function xc(n,t){n.classList?.add(t)}function Tf(n,t){n.classList?.remove(t)}function $9e(n,t,e){x0(e).onDone(()=>n.processLeaveNode(t))}function uZ(n,t){for(let e=0;e<n.length;e++){const r=n[e];r instanceof Lj?uZ(r.players,t):t.push(r)}}function fZ(n,t,e){const r=e.get(n);if(!r)return!1;let s=t.get(n);return s?r.forEach(i=>s.add(i)):t.set(n,r),e.delete(n),!0}class NE{constructor(t,e,r){this.bodyNode=t,this._driver=e,this._normalizer=r,this._triggerCache={},this.onRemovalComplete=(s,i)=>{},this._transitionEngine=new V9e(t,e,r),this._timelineEngine=new N9e(t,e,r),this._transitionEngine.onRemovalComplete=(s,i)=>this.onRemovalComplete(s,i)}registerTrigger(t,e,r,s,i){const o=t+"-"+s;let c=this._triggerCache[o];if(!c){const u=[],g=wN(this._driver,i,u,[]);if(u.length)throw function Ohe(n,t){return new Ie(3404,!1)}();c=function w9e(n,t,e){return new b9e(n,t,e)}(s,g,this._normalizer),this._triggerCache[o]=c}this._transitionEngine.registerTrigger(e,s,c)}register(t,e){this._transitionEngine.register(t,e)}destroy(t,e){this._transitionEngine.destroy(t,e)}onInsert(t,e,r,s){this._transitionEngine.insertNode(t,e,r,s)}onRemove(t,e,r,s){this._transitionEngine.removeNode(t,e,s||!1,r)}disableAnimations(t,e){this._transitionEngine.markElementAsDisabled(t,e)}process(t,e,r,s){if("@"==r.charAt(0)){const[i,o]=zj(r);this._timelineEngine.command(i,e,o,s)}else this._transitionEngine.trigger(t,e,r,s)}listen(t,e,r,s,i){if("@"==r.charAt(0)){const[o,c]=zj(r);return this._timelineEngine.listen(o,e,c,i)}return this._transitionEngine.listen(t,e,r,s,i)}flush(t=-1){this._transitionEngine.flush(t)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}let q9e=(()=>{class n{constructor(e,r,s){this._element=e,this._startStyles=r,this._endStyles=s,this._state=0;let i=n.initialStylesByElement.get(e);i||n.initialStylesByElement.set(e,i=new Map),this._initialStyles=i}start(){this._state<1&&(this._startStyles&&w4(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(w4(this._element,this._initialStyles),this._endStyles&&(w4(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(n.initialStylesByElement.delete(this._element),this._startStyles&&(Du(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(Du(this._element,this._endStyles),this._endStyles=null),w4(this._element,this._initialStyles),this._state=3)}}return n.initialStylesByElement=new WeakMap,n})();function zN(n){let t=null;return n.forEach((e,r)=>{(function j9e(n){return"display"===n||"position"===n})(r)&&(t=t||new Map,t.set(r,e))}),t}class dZ{constructor(t,e,r,s){this.element=t,this.keyframes=e,this.options=r,this._specialStyles=s,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=r.duration,this._delay=r.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const t=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,t,this.options),this._finalKeyframe=t.length?t[t.length-1]:new Map,this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(t){const e=[];return t.forEach(r=>{e.push(Object.fromEntries(r))}),e}_triggerWebAnimation(t,e,r){return t.animate(this._convertKeyframesToObject(e),r)}onStart(t){this._originalOnStartFns.push(t),this._onStartFns.push(t)}onDone(t){this._originalOnDoneFns.push(t),this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(t=>t()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}setPosition(t){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=t*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const t=new Map;this.hasStarted()&&this._finalKeyframe.forEach((r,s)=>{"offset"!==s&&t.set(s,this._finished?r:Xj(this.element,s))}),this.currentSnapshot=t}triggerCallback(t){const e="start"===t?this._onStartFns:this._onDoneFns;e.forEach(r=>r()),e.length=0}}class Z9e{validateStyleProperty(t){return!0}validateAnimatableStyleProperty(t){return!0}matchesElement(t,e){return!1}containsElement(t,e){return Bj(t,e)}getParentElement(t){return CN(t)}query(t,e,r){return $j(t,e,r)}computeStyle(t,e,r){return window.getComputedStyle(t)[e]}animate(t,e,r,s,i,o=[]){const u={duration:r,delay:s,fill:0==s?"both":"forwards"};i&&(u.easing=i);const d=new Map,g=o.filter(b=>b instanceof dZ);(function Qhe(n,t){return 0===n||0===t})(r,s)&&g.forEach(b=>{b.currentSnapshot.forEach((k,$)=>d.set($,k))});let m=function Zhe(n){return n.length?n[0]instanceof Map?n:n.map(t=>qj(t)):[]}(e).map(b=>k0(b));m=function Jhe(n,t,e){if(e.size&&t.length){let r=t[0],s=[];if(e.forEach((i,o)=>{r.has(o)||s.push(o),r.set(o,i)}),s.length)for(let i=1;i<t.length;i++){let o=t[i];s.forEach(c=>o.set(c,Xj(n,c)))}}return t}(t,m,d);const y=function W9e(n,t){let e=null,r=null;return Array.isArray(t)&&t.length?(e=zN(t[0]),t.length>1&&(r=zN(t[t.length-1]))):t instanceof Map&&(e=zN(t)),e||r?new q9e(n,e,r):null}(t,m);return new dZ(t,m,u,y)}}let Y9e=(()=>{class n extends Nj{constructor(e,r){super(),this._nextAnimationId=0,this._renderer=e.createRenderer(r.body,{id:"0",encapsulation:V1.None,styles:[],data:{animation:[]}})}build(e){const r=this._nextAnimationId.toString();this._nextAnimationId++;const s=Array.isArray(e)?Ij(e):e;return hZ(this._renderer,null,r,"register",[s]),new K9e(r,this._renderer)}}return n.\u0275fac=function(e){return new(e||n)(Ve(l0),Ve($s))},n.\u0275prov=rt({token:n,factory:n.\u0275fac}),n})();class K9e extends class ohe{}{constructor(t,e){super(),this._id=t,this._renderer=e}create(t,e){return new X9e(this._id,t,e||{},this._renderer)}}class X9e{constructor(t,e,r,s){this.id=t,this.element=e,this._renderer=s,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",r)}_listen(t,e){return this._renderer.listen(this.element,`@@${this.id}:${t}`,e)}_command(t,...e){return hZ(this._renderer,this.element,this.id,t,e)}onDone(t){this._listen("done",t)}onStart(t){this._listen("start",t)}onDestroy(t){this._listen("destroy",t)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(t){this._command("setPosition",t)}getPosition(){return this._renderer.engine.players[+this.id]?.getPosition()??0}}function hZ(n,t,e,r,s){return n.setProperty(t,`@@${e}:${r}`,s)}const pZ="@.disabled";let Q9e=(()=>{class n{constructor(e,r,s){this.delegate=e,this.engine=r,this._zone=s,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),r.onRemovalComplete=(i,o)=>{const c=o?.parentNode(i);c&&o.removeChild(c,i)}}createRenderer(e,r){const i=this.delegate.createRenderer(e,r);if(!(e&&r&&r.data&&r.data.animation)){let g=this._rendererCache.get(i);return g||(g=new gZ("",i,this.engine,()=>this._rendererCache.delete(i)),this._rendererCache.set(i,g)),g}const o=r.id,c=r.id+"-"+this._currentId;this._currentId++,this.engine.register(c,e);const u=g=>{Array.isArray(g)?g.forEach(u):this.engine.registerTrigger(o,c,e,g.name,g)};return r.data.animation.forEach(u),new J9e(this,c,i,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(e,r,s){e>=0&&e<this._microtaskId?this._zone.run(()=>r(s)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(i=>{const[o,c]=i;o(c)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([r,s]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return n.\u0275fac=function(e){return new(e||n)(Ve(l0),Ve(NE),Ve(Sr))},n.\u0275prov=rt({token:n,factory:n.\u0275fac}),n})();class gZ{constructor(t,e,r,s){this.namespaceId=t,this.delegate=e,this.engine=r,this._onDestroy=s,this.destroyNode=this.delegate.destroyNode?i=>e.destroyNode(i):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy(),this._onDestroy?.()}createElement(t,e){return this.delegate.createElement(t,e)}createComment(t){return this.delegate.createComment(t)}createText(t){return this.delegate.createText(t)}appendChild(t,e){this.delegate.appendChild(t,e),this.engine.onInsert(this.namespaceId,e,t,!1)}insertBefore(t,e,r,s=!0){this.delegate.insertBefore(t,e,r),this.engine.onInsert(this.namespaceId,e,t,s)}removeChild(t,e,r){this.engine.onRemove(this.namespaceId,e,this.delegate,r)}selectRootElement(t,e){return this.delegate.selectRootElement(t,e)}parentNode(t){return this.delegate.parentNode(t)}nextSibling(t){return this.delegate.nextSibling(t)}setAttribute(t,e,r,s){this.delegate.setAttribute(t,e,r,s)}removeAttribute(t,e,r){this.delegate.removeAttribute(t,e,r)}addClass(t,e){this.delegate.addClass(t,e)}removeClass(t,e){this.delegate.removeClass(t,e)}setStyle(t,e,r,s){this.delegate.setStyle(t,e,r,s)}removeStyle(t,e,r){this.delegate.removeStyle(t,e,r)}setProperty(t,e,r){"@"==e.charAt(0)&&e==pZ?this.disableAnimations(t,!!r):this.delegate.setProperty(t,e,r)}setValue(t,e){this.delegate.setValue(t,e)}listen(t,e,r){return this.delegate.listen(t,e,r)}disableAnimations(t,e){this.engine.disableAnimations(t,e)}}class J9e extends gZ{constructor(t,e,r,s,i){super(e,r,s,i),this.factory=t,this.namespaceId=e}setProperty(t,e,r){"@"==e.charAt(0)?"."==e.charAt(1)&&e==pZ?this.disableAnimations(t,r=void 0===r||!!r):this.engine.process(this.namespaceId,t,e.slice(1),r):this.delegate.setProperty(t,e,r)}listen(t,e,r){if("@"==e.charAt(0)){const s=function epe(n){switch(n){case"body":return document.body;case"document":return document;case"window":return window;default:return n}}(t);let i=e.slice(1),o="";return"@"!=i.charAt(0)&&([i,o]=function tpe(n){const t=n.indexOf(".");return[n.substring(0,t),n.slice(t+1)]}(i)),this.engine.listen(this.namespaceId,s,i,o,c=>{this.factory.scheduleListenerCallback(c._data||-1,r,c)})}return this.delegate.listen(t,e,r)}}let npe=(()=>{class n extends NE{constructor(e,r,s,i){super(e.body,r,s)}ngOnDestroy(){this.flush()}}return n.\u0275fac=function(e){return new(e||n)(Ve($s),Ve(yN),Ve(IN),Ve(dp))},n.\u0275prov=rt({token:n,factory:n.\u0275fac}),n})();const mZ=[{provide:Nj,useClass:Y9e},{provide:IN,useFactory:function rpe(){return new M9e}},{provide:NE,useClass:npe},{provide:l0,useFactory:function spe(n,t,e){return new Q9e(n,t,e)},deps:[ky,NE,Sr]}],VN=[{provide:yN,useFactory:()=>new Z9e},{provide:IU,useValue:"BrowserAnimations"},...mZ],_Z=[{provide:yN,useClass:Uj},{provide:IU,useValue:"NoopAnimations"},...mZ];let ipe=(()=>{class n{static withConfig(e){return{ngModule:n,providers:e.disableAnimations?_Z:VN}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=oi({type:n}),n.\u0275inj=Yr({providers:VN,imports:[YG]}),n})();const Ts=void 0,ape=["fr",[["AM","PM"],Ts,Ts],Ts,[["D","L","M","M","J","V","S"],["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"],["di","lu","ma","me","je","ve","sa"]],Ts,[["J","F","M","A","M","J","J","A","S","O","N","D"],["janv.","f\xe9vr.","mars","avr.","mai","juin","juil.","ao\xfbt","sept.","oct.","nov.","d\xe9c."],["janvier","f\xe9vrier","mars","avril","mai","juin","juillet","ao\xfbt","septembre","octobre","novembre","d\xe9cembre"]],Ts,[["av. J.-C.","ap. J.-C."],Ts,["avant J\xe9sus-Christ","apr\xe8s J\xe9sus-Christ"]],1,[6,0],["dd/MM/y","d MMM y","d MMMM y","EEEE d MMMM y"],["HH:mm","HH:mm:ss","HH:mm:ss z","HH:mm:ss zzzz"],["{1} {0}","{1}, {0}","{1} '\xe0' {0}",Ts],[",","\u202f",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0\xa0%","#,##0.00\xa0\xa4","#E0"],"EUR","\u20ac","euro",{ARS:["$AR","$"],AUD:["$AU","$"],BEF:["FB"],BMD:["$BM","$"],BND:["$BN","$"],BYN:[Ts,"\u0440."],BZD:["$BZ","$"],CAD:["$CA","$"],CLP:["$CL","$"],CNY:[Ts,"\xa5"],COP:["$CO","$"],CYP:["\xa3CY"],EGP:[Ts,"\xa3E"],FJD:["$FJ","$"],FKP:["\xa3FK","\xa3"],FRF:["F"],GBP:["\xa3GB","\xa3"],GIP:["\xa3GI","\xa3"],HKD:[Ts,"$"],IEP:["\xa3IE"],ILP:["\xa3IL"],ITL:["\u20a4IT"],JPY:[Ts,"\xa5"],KMF:[Ts,"FC"],LBP:["\xa3LB","\xa3L"],MTP:["\xa3MT"],MXN:["$MX","$"],NAD:["$NA","$"],NIO:[Ts,"$C"],NZD:["$NZ","$"],PHP:[Ts,"\u20b1"],RHD:["$RH"],RON:[Ts,"L"],RWF:[Ts,"FR"],SBD:["$SB","$"],SGD:["$SG","$"],SRD:["$SR","$"],TOP:[Ts,"$T"],TTD:["$TT","$"],TWD:[Ts,"NT$"],USD:["$US","$"],UYU:["$UY","$"],WST:["$WS"],XCD:[Ts,"$"],XPF:["FCFP"],ZMW:[Ts,"Kw"]},"ltr",function ope(n){const e=Math.floor(Math.abs(n)),r=n.toString().replace(/^[^.]*\.?/,"").length,s=parseInt(n.toString().replace(/^[^e]*(e([-+]?\d+))?/,"$2"))||0;return 0===e||1===e?1:0===s&&0!==e&&e%1e6==0&&0===r||!(s>=0&&s<=5)?4:5}];function vZ(n,t,e,r,s,i,o){try{var c=n[i](o),u=c.value}catch(d){return void e(d)}c.done?t(u):Promise.resolve(u).then(r,s)}function I(n){return function(){var t=this,e=arguments;return new Promise(function(r,s){var i=n.apply(t,e);function o(u){vZ(i,r,s,o,c,"next",u)}function c(u){vZ(i,r,s,o,c,"throw",u)}o(void 0)})}}const CZ=function(n){const t=[];let e=0;for(let r=0;r<n.length;r++){let s=n.charCodeAt(r);s<128?t[e++]=s:s<2048?(t[e++]=s>>6|192,t[e++]=63&s|128):55296==(64512&s)&&r+1<n.length&&56320==(64512&n.charCodeAt(r+1))?(s=65536+((1023&s)<<10)+(1023&n.charCodeAt(++r)),t[e++]=s>>18|240,t[e++]=s>>12&63|128,t[e++]=s>>6&63|128,t[e++]=63&s|128):(t[e++]=s>>12|224,t[e++]=s>>6&63|128,t[e++]=63&s|128)}return t},FN={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(n,t){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const e=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<n.length;s+=3){const i=n[s],o=s+1<n.length,c=o?n[s+1]:0,u=s+2<n.length,d=u?n[s+2]:0;let y=(15&c)<<2|d>>6,b=63&d;u||(b=64,o||(y=64)),r.push(e[i>>2],e[(3&i)<<4|c>>4],e[y],e[b])}return r.join("")},encodeString(n,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(n):this.encodeByteArray(CZ(n),t)},decodeString(n,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(n):function(n){const t=[];let e=0,r=0;for(;e<n.length;){const s=n[e++];if(s<128)t[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=n[e++];t[r++]=String.fromCharCode((31&s)<<6|63&i)}else if(s>239&&s<365){const u=((7&s)<<18|(63&n[e++])<<12|(63&n[e++])<<6|63&n[e++])-65536;t[r++]=String.fromCharCode(55296+(u>>10)),t[r++]=String.fromCharCode(56320+(1023&u))}else{const i=n[e++],o=n[e++];t[r++]=String.fromCharCode((15&s)<<12|(63&i)<<6|63&o)}}return t.join("")}(this.decodeStringToByteArray(n,t))},decodeStringToByteArray(n,t){this.init_();const e=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<n.length;){const i=e[n.charAt(s++)],c=s<n.length?e[n.charAt(s)]:0;++s;const d=s<n.length?e[n.charAt(s)]:64;++s;const m=s<n.length?e[n.charAt(s)]:64;if(++s,null==i||null==c||null==d||null==m)throw Error();r.push(i<<2|c>>4),64!==d&&(r.push(c<<4&240|d>>2),64!==m&&r.push(d<<6&192|m))}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},xE=function(n){return function(n){const t=CZ(n);return FN.encodeByteArray(t,!0)}(n).replace(/\./g,"")},kE=function(n){try{return FN.decodeString(n,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function ki(){return typeof navigator<"u"&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function BN(){const n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof n&&void 0!==n.id}function Vu(){return"object"==typeof indexedDB}function Kp(){return new Promise((n,t)=>{try{let e=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),e||self.indexedDB.deleteDatabase(r),n(!0)},s.onupgradeneeded=()=>{e=!1},s.onerror=()=>{var i;t((null===(i=s.error)||void 0===i?void 0:i.message)||"")}}catch(e){t(e)}})}function $N(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}const UN=()=>{try{return function _pe(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if(typeof process>"u"||typeof process.env>"u")return;const n=process.env.__FIREBASE_DEFAULTS__;return n?JSON.parse(n):void 0})()||(()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=n&&kE(n[1]);return t&&JSON.parse(t)})()}catch(n){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`)}},EZ=n=>{var t,e;return null===(e=null===(t=UN())||void 0===t?void 0:t.emulatorHosts)||void 0===e?void 0:e[n]},MZ=n=>{var t;return null===(t=UN())||void 0===t?void 0:t[`_${n}`]};class LE{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}wrapCallback(t){return(e,r)=>{e?this.reject(e):this.resolve(r),"function"==typeof t&&(this.promise.catch(()=>{}),1===t.length?t(e):t(e,r))}}}class kc extends Error{constructor(t,e,r){super(e),this.code=t,this.customData=r,this.name="FirebaseError",Object.setPrototypeOf(this,kc.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,b4.prototype.create)}}class b4{constructor(t,e,r){this.service=t,this.serviceName=e,this.errors=r}create(t,...e){const r=e[0]||{},s=`${this.service}/${t}`,i=this.errors[t],o=i?function Tpe(n,t){return n.replace(wpe,(e,r)=>{const s=t[r];return null!=s?String(s):`<${r}?>`})}(i,r):"Error";return new kc(s,`${this.serviceName}: ${o} (${s}).`,r)}}const wpe=/\{\$([^}]+)}/g;function DE(n,t){if(n===t)return!0;const e=Object.keys(n),r=Object.keys(t);for(const s of e){if(!r.includes(s))return!1;const i=n[s],o=t[s];if(PZ(i)&&PZ(o)){if(!DE(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!e.includes(s))return!1;return!0}function PZ(n){return null!==n&&"object"==typeof n}function Xp(n){const t=[];for(const[e,r]of Object.entries(n))Array.isArray(r)?r.forEach(s=>{t.push(encodeURIComponent(e)+"="+encodeURIComponent(s))}):t.push(encodeURIComponent(e)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}function Qp(n){const t={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,i]=r.split("=");t[decodeURIComponent(s)]=decodeURIComponent(i)}}),t}function Jp(n){const t=n.indexOf("?");if(!t)return"";const e=n.indexOf("#",t);return n.substring(t,e>0?e:void 0)}class Ape{constructor(t,e){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then(()=>{t(this)}).catch(r=>{this.error(r)})}next(t){this.forEachObserver(e=>{e.next(t)})}error(t){this.forEachObserver(e=>{e.error(t)}),this.close(t)}complete(){this.forEachObserver(t=>{t.complete()}),this.close()}subscribe(t,e,r){let s;if(void 0===t&&void 0===e&&void 0===r)throw new Error("Missing Observer.");s=function Npe(n,t){if("object"!=typeof n||null===n)return!1;for(const e of t)if(e in n&&"function"==typeof n[e])return!0;return!1}(t,["next","error","complete"])?t:{next:t,error:e,complete:r},void 0===s.next&&(s.next=GN),void 0===s.error&&(s.error=GN),void 0===s.complete&&(s.complete=GN);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(t){void 0===this.observers||void 0===this.observers[t]||(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(t){if(!this.finalized)for(let e=0;e<this.observers.length;e++)this.sendOne(e,t)}sendOne(t,e){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[t])try{e(this.observers[t])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(t){this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function GN(){}function qN(n,t=1e3,e=2){const r=t*Math.pow(e,n),s=Math.round(.5*r*(Math.random()-.5)*2);return Math.min(144e5,r+s)}function es(n){return n&&n._delegate?n._delegate:n}class X2{constructor(t,e,r){this.name=t,this.instanceFactory=e,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}const Hu="[DEFAULT]";class Dpe{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const r=new LE;if(this.instancesDeferred.set(e,r),this.isInitialized(e)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:e});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(e).promise}getImmediate(t){var e;const r=this.normalizeInstanceIdentifier(t?.identifier),s=null!==(e=t?.optional)&&void 0!==e&&e;if(!this.isInitialized(r)&&!this.shouldAutoInitialize()){if(s)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,this.shouldAutoInitialize()){if(function Vpe(n){return"EAGER"===n.instantiationMode}(t))try{this.getOrInitializeService({instanceIdentifier:Hu})}catch{}for(const[e,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(e);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(t=Hu){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}delete(){var t=this;return I(function*(){const e=Array.from(t.instances.values());yield Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])})()}isComponentSet(){return null!=this.component}isInitialized(t=Hu){return this.instances.has(t)}getOptions(t=Hu){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,r=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:e});for(const[i,o]of this.instancesDeferred.entries())r===this.normalizeInstanceIdentifier(i)&&o.resolve(s);return s}onInit(t,e){var r;const s=this.normalizeInstanceIdentifier(e),i=null!==(r=this.onInitCallbacks.get(s))&&void 0!==r?r:new Set;i.add(t),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&t(o,s),()=>{i.delete(t)}}invokeOnInitCallbacks(t,e){const r=this.onInitCallbacks.get(e);if(r)for(const s of r)try{s(t,e)}catch{}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let r=this.instances.get(t);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:(n=t,n===Hu?void 0:n),options:e}),this.instances.set(t,r),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(r,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,r)}catch{}var n;return r||null}normalizeInstanceIdentifier(t=Hu){return this.component?this.component.multipleInstances?t:Hu:t}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class Hpe{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new Dpe(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}const jN=[];var p1=(()=>{return(n=p1||(p1={}))[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",p1;var n})();const TZ={debug:p1.DEBUG,verbose:p1.VERBOSE,info:p1.INFO,warn:p1.WARN,error:p1.ERROR,silent:p1.SILENT},Fpe=p1.INFO,Bpe={[p1.DEBUG]:"log",[p1.VERBOSE]:"log",[p1.INFO]:"info",[p1.WARN]:"warn",[p1.ERROR]:"error"},$pe=(n,t,...e)=>{if(t<n.logLevel)return;const r=(new Date).toISOString(),s=Bpe[t];if(!s)throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`);console[s](`[${r}]  ${n.name}:`,...e)};class wf{constructor(t){this.name=t,this._logLevel=Fpe,this._logHandler=$pe,this._userLogHandler=null,jN.push(this)}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in p1))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel="string"==typeof t?TZ[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,p1.DEBUG,...t),this._logHandler(this,p1.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,p1.VERBOSE,...t),this._logHandler(this,p1.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,p1.INFO,...t),this._logHandler(this,p1.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,p1.WARN,...t),this._logHandler(this,p1.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,p1.ERROR,...t),this._logHandler(this,p1.ERROR,...t)}}let wZ,bZ;const OZ=new WeakMap,ZN=new WeakMap,AZ=new WeakMap,YN=new WeakMap,KN=new WeakMap;let XN={get(n,t,e){if(n instanceof IDBTransaction){if("done"===t)return ZN.get(n);if("objectStoreNames"===t)return n.objectStoreNames||AZ.get(n);if("store"===t)return e.objectStoreNames[1]?void 0:e.objectStore(e.objectStoreNames[0])}return Bl(n[t])},set:(n,t,e)=>(n[t]=e,!0),has:(n,t)=>n instanceof IDBTransaction&&("done"===t||"store"===t)||t in n};function Kpe(n){return"function"==typeof n?function Ype(n){return n!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function Wpe(){return bZ||(bZ=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(n)?function(...t){return n.apply(QN(this),t),Bl(OZ.get(this))}:function(...t){return Bl(n.apply(QN(this),t))}:function(t,...e){const r=n.call(QN(this),t,...e);return AZ.set(r,t.sort?t.sort():[t]),Bl(r)}}(n):(n instanceof IDBTransaction&&function jpe(n){if(ZN.has(n))return;const t=new Promise((e,r)=>{const s=()=>{n.removeEventListener("complete",i),n.removeEventListener("error",o),n.removeEventListener("abort",o)},i=()=>{e(),s()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",i),n.addEventListener("error",o),n.addEventListener("abort",o)});ZN.set(n,t)}(n),((n,t)=>t.some(e=>n instanceof e))(n,function Gpe(){return wZ||(wZ=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(n,XN):n)}function Bl(n){if(n instanceof IDBRequest)return function qpe(n){const t=new Promise((e,r)=>{const s=()=>{n.removeEventListener("success",i),n.removeEventListener("error",o)},i=()=>{e(Bl(n.result)),s()},o=()=>{r(n.error),s()};n.addEventListener("success",i),n.addEventListener("error",o)});return t.then(e=>{e instanceof IDBCursor&&OZ.set(e,n)}).catch(()=>{}),KN.set(t,n),t}(n);if(YN.has(n))return YN.get(n);const t=Kpe(n);return t!==n&&(YN.set(n,t),KN.set(t,n)),t}const QN=n=>KN.get(n);function zE(n,t,{blocked:e,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(n,t),c=Bl(o);return r&&o.addEventListener("upgradeneeded",u=>{r(Bl(o.result),u.oldVersion,u.newVersion,Bl(o.transaction))}),e&&o.addEventListener("blocked",()=>e()),c.then(u=>{i&&u.addEventListener("close",()=>i()),s&&u.addEventListener("versionchange",()=>s())}).catch(()=>{}),c}function JN(n,{blocked:t}={}){const e=indexedDB.deleteDatabase(n);return t&&e.addEventListener("blocked",()=>t()),Bl(e).then(()=>{})}const Xpe=["get","getKey","getAll","getAllKeys","count"],Qpe=["put","add","delete","clear"],eI=new Map;function NZ(n,t){if(!(n instanceof IDBDatabase)||t in n||"string"!=typeof t)return;if(eI.get(t))return eI.get(t);const e=t.replace(/FromIndex$/,""),r=t!==e,s=Qpe.includes(e);if(!(e in(r?IDBIndex:IDBObjectStore).prototype)||!s&&!Xpe.includes(e))return;const i=function(){var o=I(function*(c,...u){const d=this.transaction(c,s?"readwrite":"readonly");let g=d.store;return r&&(g=g.index(u.shift())),(yield Promise.all([g[e](...u),s&&d.done]))[0]});return function(u){return o.apply(this,arguments)}}();return eI.set(t,i),i}!function Zpe(n){XN=n(XN)}(n=>({...n,get:(t,e,r)=>NZ(t,e)||n.get(t,e,r),has:(t,e)=>!!NZ(t,e)||n.has(t,e)}));class Jpe{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(function ege(n){return"VERSION"===n.getComponent()?.type}(e)){const r=e.getImmediate();return`${r.library}/${r.version}`}return null}).filter(e=>e).join(" ")}}const tI="@firebase/app",Fu=new wf("@firebase/app"),VE="[DEFAULT]",wge={[tI]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},Bu=new Map,HE=new Map;function bge(n,t){try{n.container.addComponent(t)}catch(e){Fu.debug(`Component ${t.name} failed to register with FirebaseApp ${n.name}`,e)}}function Oo(n){const t=n.name;if(HE.has(t))return Fu.debug(`There were multiple attempts to register component ${t}.`),!1;HE.set(t,n);for(const e of Bu.values())bge(e,n);return!0}function bf(n,t){const e=n.container.getProvider("heartbeat").getImmediate({optional:!0});return e&&e.triggerHeartbeat(),n.container.getProvider(t)}const $l=new b4("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class Age{constructor(t,e,r){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},e),this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new X2("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw $l.create("app-deleted",{appName:this._name})}}const Of="9.14.0";function xZ(n,t={}){let e=n;"object"!=typeof t&&(t={name:t});const r=Object.assign({name:VE,automaticDataCollectionEnabled:!1},t),s=r.name;if("string"!=typeof s||!s)throw $l.create("bad-app-name",{appName:String(s)});if(e||(e=(()=>{var n;return null===(n=UN())||void 0===n?void 0:n.config})()),!e)throw $l.create("no-options");const i=Bu.get(s);if(i){if(DE(e,i.options)&&DE(r,i.config))return i;throw $l.create("duplicate-app",{appName:s})}const o=new Hpe(s);for(const u of HE.values())o.addComponent(u);const c=new Age(e,r,o);return Bu.set(s,c),c}function nI(n=VE){const t=Bu.get(n);if(!t&&n===VE)return xZ();if(!t)throw $l.create("no-app",{appName:n});return t}function kZ(){return Array.from(Bu.values())}function ds(n,t,e){var r;let s=null!==(r=wge[n])&&void 0!==r?r:n;e&&(s+=`-${e}`);const i=s.match(/\s|\//),o=t.match(/\s|\//);if(i||o){const c=[`Unable to register library "${s}" with version "${t}":`];return i&&c.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&c.push("and"),o&&c.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void Fu.warn(c.join(" "))}Oo(new X2(`${s}-version`,()=>({library:s,version:t}),"VERSION"))}const eg="firebase-heartbeat-store";let sI=null;function LZ(){return sI||(sI=zE("firebase-heartbeat-database",1,{upgrade:(n,t)=>{0===t&&n.createObjectStore(eg)}}).catch(n=>{throw $l.create("idb-open",{originalErrorMessage:n.message})})),sI}function iI(){return(iI=I(function*(n){var t;try{return(yield LZ()).transaction(eg).objectStore(eg).get(DZ(n))}catch(e){if(e instanceof kc)Fu.warn(e.message);else{const r=$l.create("idb-get",{originalErrorMessage:null===(t=e)||void 0===t?void 0:t.message});Fu.warn(r.message)}}})).apply(this,arguments)}function RZ(n,t){return oI.apply(this,arguments)}function oI(){return(oI=I(function*(n,t){var e;try{const s=(yield LZ()).transaction(eg,"readwrite");return yield s.objectStore(eg).put(t,DZ(n)),s.done}catch(r){if(r instanceof kc)Fu.warn(r.message);else{const s=$l.create("idb-set",{originalErrorMessage:null===(e=r)||void 0===e?void 0:e.message});Fu.warn(s.message)}}})).apply(this,arguments)}function DZ(n){return`${n.name}!${n.options.appId}`}class Rge{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new zge(e),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}triggerHeartbeat(){var t=this;return I(function*(){const r=t.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=zZ();if(null===t._heartbeatsCache&&(t._heartbeatsCache=yield t._heartbeatsCachePromise),t._heartbeatsCache.lastSentHeartbeatDate!==s&&!t._heartbeatsCache.heartbeats.some(i=>i.date===s))return t._heartbeatsCache.heartbeats.push({date:s,agent:r}),t._heartbeatsCache.heartbeats=t._heartbeatsCache.heartbeats.filter(i=>{const o=new Date(i.date).valueOf();return Date.now()-o<=2592e6}),t._storage.overwrite(t._heartbeatsCache)})()}getHeartbeatsHeader(){var t=this;return I(function*(){if(null===t._heartbeatsCache&&(yield t._heartbeatsCachePromise),null===t._heartbeatsCache||0===t._heartbeatsCache.heartbeats.length)return"";const e=zZ(),{heartbeatsToSend:r,unsentEntries:s}=function Dge(n,t=1024){const e=[];let r=n.slice();for(const s of n){const i=e.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),VZ(e)>t){i.dates.pop();break}}else if(e.push({agent:s.agent,dates:[s.date]}),VZ(e)>t){e.pop();break}r=r.slice(1)}return{heartbeatsToSend:e,unsentEntries:r}}(t._heartbeatsCache.heartbeats),i=xE(JSON.stringify({version:2,heartbeats:r}));return t._heartbeatsCache.lastSentHeartbeatDate=e,s.length>0?(t._heartbeatsCache.heartbeats=s,yield t._storage.overwrite(t._heartbeatsCache)):(t._heartbeatsCache.heartbeats=[],t._storage.overwrite(t._heartbeatsCache)),i})()}}function zZ(){return(new Date).toISOString().substring(0,10)}class zge{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return I(function*(){return!!Vu()&&Kp().then(()=>!0).catch(()=>!1)})()}read(){var t=this;return I(function*(){return(yield t._canUseIndexedDBPromise)&&(yield function xge(n){return iI.apply(this,arguments)}(t.app))||{heartbeats:[]}})()}overwrite(t){var e=this;return I(function*(){var r;if(yield e._canUseIndexedDBPromise){const i=yield e.read();return RZ(e.app,{lastSentHeartbeatDate:null!==(r=t.lastSentHeartbeatDate)&&void 0!==r?r:i.lastSentHeartbeatDate,heartbeats:t.heartbeats})}})()}add(t){var e=this;return I(function*(){var r;if(yield e._canUseIndexedDBPromise){const i=yield e.read();return RZ(e.app,{lastSentHeartbeatDate:null!==(r=t.lastSentHeartbeatDate)&&void 0!==r?r:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...t.heartbeats]})}})()}}function VZ(n){return xE(JSON.stringify({version:2,heartbeats:n})).length}!function Vge(n){Oo(new X2("platform-logger",t=>new Jpe(t),"PRIVATE")),Oo(new X2("heartbeat",t=>new Rge(t),"PRIVATE")),ds(tI,"0.8.4",n),ds(tI,"0.8.4","esm2017"),ds("fire-js","")}("");var At,Hge=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Ul={},aI=aI||{},Cn=Hge||self;function FE(){}function BE(n){var t=typeof n;return"array"==(t="object"!=t?t:n?Array.isArray(n)?"array":t:"null")||"object"==t&&"number"==typeof n.length}function tg(n){var t=typeof n;return"object"==t&&null!=n||"function"==t}var cI="closure_uid_"+(1e9*Math.random()>>>0),Bge=0;function $ge(n,t,e){return n.call.apply(n.bind,arguments)}function Uge(n,t,e){if(!n)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var s=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(s,r),n.apply(t,s)}}return function(){return n.apply(t,arguments)}}function Q2(n,t,e){return(Q2=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?$ge:Uge).apply(null,arguments)}function $E(n,t){var e=Array.prototype.slice.call(arguments,1);return function(){var r=e.slice();return r.push.apply(r,arguments),n.apply(this,r)}}function C2(n,t){function e(){}e.prototype=t.prototype,n.X=t.prototype,n.prototype=new e,n.prototype.constructor=n,n.Wb=function(r,s,i){for(var o=Array(arguments.length-2),c=2;c<arguments.length;c++)o[c-2]=arguments[c];return t.prototype[s].apply(r,o)}}function L0(){this.s=this.s,this.o=this.o}L0.prototype.s=!1,L0.prototype.na=function(){!this.s&&(this.s=!0,this.M(),0)&&function Fge(n){Object.prototype.hasOwnProperty.call(n,cI)&&n[cI]||(n[cI]=++Bge)}(this)},L0.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const HZ=Array.prototype.indexOf?function(n,t){return Array.prototype.indexOf.call(n,t,void 0)}:function(n,t){if("string"==typeof n)return"string"!=typeof t||1!=t.length?-1:n.indexOf(t,0);for(let e=0;e<n.length;e++)if(e in n&&n[e]===t)return e;return-1};function lI(n){const t=n.length;if(0<t){const e=Array(t);for(let r=0;r<t;r++)e[r]=n[r];return e}return[]}function FZ(n,t){for(let e=1;e<arguments.length;e++){const r=arguments[e];if(BE(r)){const s=n.length||0,i=r.length||0;n.length=s+i;for(let o=0;o<i;o++)n[s+o]=r[o]}else n.push(r)}}function J2(n,t){this.type=n,this.g=this.target=t,this.defaultPrevented=!1}J2.prototype.h=function(){this.defaultPrevented=!0};var Wge=function(){if(!Cn.addEventListener||!Object.defineProperty)return!1;var n=!1,t=Object.defineProperty({},"passive",{get:function(){n=!0}});try{Cn.addEventListener("test",FE,t),Cn.removeEventListener("test",FE,t)}catch{}return n}();function UE(n){return/^[\s\xa0]*$/.test(n)}var BZ=String.prototype.trim?function(n){return n.trim()}:function(n){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(n)[1]};function uI(n,t){return n<t?-1:n>t?1:0}function GE(){var n=Cn.navigator;return n&&(n=n.userAgent)?n:""}function O4(n){return-1!=GE().indexOf(n)}function fI(n){return fI[" "](n),n}fI[" "]=FE;var WE,n,jge=O4("Opera"),Af=O4("Trident")||O4("MSIE"),$Z=O4("Edge"),dI=$Z||Af,UZ=O4("Gecko")&&!(-1!=GE().toLowerCase().indexOf("webkit")&&!O4("Edge"))&&!(O4("Trident")||O4("MSIE"))&&!O4("Edge"),Zge=-1!=GE().toLowerCase().indexOf("webkit")&&!O4("Edge");function GZ(){var n=Cn.document;return n?n.documentMode:void 0}e:{var hI="",pI=(n=GE(),UZ?/rv:([^\);]+)(\)|;)/.exec(n):$Z?/Edge\/([\d\.]+)/.exec(n):Af?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(n):Zge?/WebKit\/(\S+)/.exec(n):jge?/(?:Version)[ \/]?(\S+)/.exec(n):void 0);if(pI&&(hI=pI?pI[1]:""),Af){var gI=GZ();if(null!=gI&&gI>parseFloat(hI)){WE=String(gI);break e}}WE=hI}var Yge={};var Xge=Cn.document&&Af&&(GZ()||parseInt(WE,10))||void 0;function ng(n,t){if(J2.call(this,n?n.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,n){var e=this.type=n.type,r=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:null;if(this.target=n.target||n.srcElement,this.g=t,t=n.relatedTarget){if(UZ){e:{try{fI(t.nodeName);var s=!0;break e}catch{}s=!1}s||(t=null)}}else"mouseover"==e?t=n.fromElement:"mouseout"==e&&(t=n.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==n.clientX?n.clientX:n.pageX,this.clientY=void 0!==n.clientY?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0),this.button=n.button,this.key=n.key||"",this.ctrlKey=n.ctrlKey,this.altKey=n.altKey,this.shiftKey=n.shiftKey,this.metaKey=n.metaKey,this.pointerId=n.pointerId||0,this.pointerType="string"==typeof n.pointerType?n.pointerType:Qge[n.pointerType]||"",this.state=n.state,this.i=n,n.defaultPrevented&&ng.X.h.call(this)}}C2(ng,J2);var Qge={2:"touch",3:"pen",4:"mouse"};ng.prototype.h=function(){ng.X.h.call(this);var n=this.i;n.preventDefault?n.preventDefault():n.returnValue=!1};var rg="closure_listenable_"+(1e6*Math.random()|0),Jge=0;function eme(n,t,e,r,s){this.listener=n,this.proxy=null,this.src=t,this.type=e,this.capture=!!r,this.ha=s,this.key=++Jge,this.ba=this.ea=!1}function qE(n){n.ba=!0,n.listener=null,n.proxy=null,n.src=null,n.ha=null}function _I(n,t,e){for(const r in n)t.call(e,n[r],r,n)}function qZ(n){const t={};for(const e in n)t[e]=n[e];return t}const jZ="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ZZ(n,t){let e,r;for(let s=1;s<arguments.length;s++){for(e in r=arguments[s],r)n[e]=r[e];for(let i=0;i<jZ.length;i++)e=jZ[i],Object.prototype.hasOwnProperty.call(r,e)&&(n[e]=r[e])}}function jE(n){this.src=n,this.g={},this.h=0}function vI(n,t){var e=t.type;if(e in n.g){var i,r=n.g[e],s=HZ(r,t);(i=0<=s)&&Array.prototype.splice.call(r,s,1),i&&(qE(t),0==n.g[e].length&&(delete n.g[e],n.h--))}}function CI(n,t,e,r){for(var s=0;s<n.length;++s){var i=n[s];if(!i.ba&&i.listener==t&&i.capture==!!e&&i.ha==r)return s}return-1}jE.prototype.add=function(n,t,e,r,s){var i=n.toString();(n=this.g[i])||(n=this.g[i]=[],this.h++);var o=CI(n,t,r,s);return-1<o?(t=n[o],e||(t.ea=!1)):((t=new eme(t,this.src,i,!!r,s)).ea=e,n.push(t)),t};var yI="closure_lm_"+(1e6*Math.random()|0),EI={};function YZ(n,t,e,r,s){if(r&&r.once)return XZ(n,t,e,r,s);if(Array.isArray(t)){for(var i=0;i<t.length;i++)YZ(n,t[i],e,r,s);return null}return e=TI(e),n&&n[rg]?n.N(t,e,tg(r)?!!r.capture:!!r,s):KZ(n,t,e,!1,r,s)}function KZ(n,t,e,r,s,i){if(!t)throw Error("Invalid event type");var o=tg(s)?!!s.capture:!!s,c=SI(n);if(c||(n[yI]=c=new jE(n)),(e=c.add(t,e,r,o,i)).proxy)return e;if(r=function tme(){const t=nme;return function n(e){return t.call(n.src,n.listener,e)}}(),e.proxy=r,r.src=n,r.listener=e,n.addEventListener)Wge||(s=o),void 0===s&&(s=!1),n.addEventListener(t.toString(),r,s);else if(n.attachEvent)n.attachEvent(JZ(t.toString()),r);else{if(!n.addListener||!n.removeListener)throw Error("addEventListener and attachEvent are unavailable.");n.addListener(r)}return e}function XZ(n,t,e,r,s){if(Array.isArray(t)){for(var i=0;i<t.length;i++)XZ(n,t[i],e,r,s);return null}return e=TI(e),n&&n[rg]?n.O(t,e,tg(r)?!!r.capture:!!r,s):KZ(n,t,e,!0,r,s)}function QZ(n,t,e,r,s){if(Array.isArray(t))for(var i=0;i<t.length;i++)QZ(n,t[i],e,r,s);else r=tg(r)?!!r.capture:!!r,e=TI(e),n&&n[rg]?(n=n.i,(t=String(t).toString())in n.g&&-1<(e=CI(i=n.g[t],e,r,s))&&(qE(i[e]),Array.prototype.splice.call(i,e,1),0==i.length&&(delete n.g[t],n.h--))):n&&(n=SI(n))&&(t=n.g[t.toString()],n=-1,t&&(n=CI(t,e,r,s)),(e=-1<n?t[n]:null)&&MI(e))}function MI(n){if("number"!=typeof n&&n&&!n.ba){var t=n.src;if(t&&t[rg])vI(t.i,n);else{var e=n.type,r=n.proxy;t.removeEventListener?t.removeEventListener(e,r,n.capture):t.detachEvent?t.detachEvent(JZ(e),r):t.addListener&&t.removeListener&&t.removeListener(r),(e=SI(t))?(vI(e,n),0==e.h&&(e.src=null,t[yI]=null)):qE(n)}}}function JZ(n){return n in EI?EI[n]:EI[n]="on"+n}function nme(n,t){if(n.ba)n=!0;else{t=new ng(t,this);var e=n.listener,r=n.ha||n.src;n.ea&&MI(n),n=e.call(r,t)}return n}function SI(n){return(n=n[yI])instanceof jE?n:null}var PI="__closure_events_fn_"+(1e9*Math.random()>>>0);function TI(n){return"function"==typeof n?n:(n[PI]||(n[PI]=function(t){return n.handleEvent(t)}),n[PI])}function Li(){L0.call(this),this.i=new jE(this),this.P=this,this.I=null}function y2(n,t){var e,r=n.I;if(r)for(e=[];r;r=r.I)e.push(r);if(n=n.P,r=t.type||t,"string"==typeof t)t=new J2(t,n);else if(t instanceof J2)t.target=t.target||n;else{var s=t;ZZ(t=new J2(r,n),s)}if(s=!0,e)for(var i=e.length-1;0<=i;i--){var o=t.g=e[i];s=ZE(o,r,!0,t)&&s}if(s=ZE(o=t.g=n,r,!0,t)&&s,s=ZE(o,r,!1,t)&&s,e)for(i=0;i<e.length;i++)s=ZE(o=t.g=e[i],r,!1,t)&&s}function ZE(n,t,e,r){if(!(t=n.i.g[String(t)]))return!0;t=t.concat();for(var s=!0,i=0;i<t.length;++i){var o=t[i];if(o&&!o.ba&&o.capture==e){var c=o.listener,u=o.ha||o.src;o.ea&&vI(n.i,o),s=!1!==c.call(u,r)&&s}}return s&&!r.defaultPrevented}C2(Li,L0),Li.prototype[rg]=!0,Li.prototype.removeEventListener=function(n,t,e,r){QZ(this,n,t,e,r)},Li.prototype.M=function(){if(Li.X.M.call(this),this.i){var t,n=this.i;for(t in n.g){for(var e=n.g[t],r=0;r<e.length;r++)qE(e[r]);delete n.g[t],n.h--}}this.I=null},Li.prototype.N=function(n,t,e,r){return this.i.add(String(n),t,!1,e,r)},Li.prototype.O=function(n,t,e,r){return this.i.add(String(n),t,!0,e,r)};var wI=Cn.JSON.stringify;function rme(){var n=nY;let t=null;return n.g&&(t=n.g,n.g=n.g.next,n.g||(n.h=null),t.next=null),t}var bI,eY=new class{constructor(n,t){this.i=n,this.j=t,this.h=0,this.g=null}get(){let n;return 0<this.h?(this.h--,n=this.g,this.g=n.next,n.next=null):n=this.i(),n}}(()=>new ime,n=>n.reset());class ime{constructor(){this.next=this.g=this.h=null}set(t,e){this.h=t,this.g=e,this.next=null}reset(){this.next=this.g=this.h=null}}function ome(n){Cn.setTimeout(()=>{throw n},0)}function tY(n,t){bI||function ame(){var n=Cn.Promise.resolve(void 0);bI=function(){n.then(cme)}}(),OI||(bI(),OI=!0),nY.add(n,t)}var OI=!1,nY=new class sme{constructor(){this.h=this.g=null}add(t,e){const r=eY.get();r.set(t,e),this.h?this.h.next=r:this.g=r,this.h=r}};function cme(){for(var n;n=rme();){try{n.h.call(n.g)}catch(e){ome(e)}var t=eY;t.j(n),100>t.h&&(t.h++,n.next=t.g,t.g=n)}OI=!1}function YE(n,t){Li.call(this),this.h=n||1,this.g=t||Cn,this.j=Q2(this.lb,this),this.l=Date.now()}function AI(n){n.ca=!1,n.R&&(n.g.clearTimeout(n.R),n.R=null)}function NI(n,t,e){if("function"==typeof n)e&&(n=Q2(n,e));else{if(!n||"function"!=typeof n.handleEvent)throw Error("Invalid listener argument");n=Q2(n.handleEvent,n)}return 2147483647<Number(t)?-1:Cn.setTimeout(n,t||0)}function rY(n){n.g=NI(()=>{n.g=null,n.i&&(n.i=!1,rY(n))},n.j);const t=n.h;n.h=null,n.m.apply(null,t)}C2(YE,Li),(At=YE.prototype).ca=!1,At.R=null,At.lb=function(){if(this.ca){var n=Date.now()-this.l;0<n&&n<.8*this.h?this.R=this.g.setTimeout(this.j,this.h-n):(this.R&&(this.g.clearTimeout(this.R),this.R=null),y2(this,"tick"),this.ca&&(AI(this),this.start()))}},At.start=function(){this.ca=!0,this.R||(this.R=this.g.setTimeout(this.j,this.h),this.l=Date.now())},At.M=function(){YE.X.M.call(this),AI(this),delete this.g};class lme extends L0{constructor(t,e){super(),this.m=t,this.j=e,this.h=null,this.i=!1,this.g=null}l(t){this.h=arguments,this.g?this.i=!0:rY(this)}M(){super.M(),this.g&&(Cn.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function sg(n){L0.call(this),this.h=n,this.g={}}C2(sg,L0);var sY=[];function iY(n,t,e,r){Array.isArray(e)||(e&&(sY[0]=e.toString()),e=sY);for(var s=0;s<e.length;s++){var i=YZ(t,e[s],r||n.handleEvent,!1,n.h||n);if(!i)break;n.g[i.key]=i}}function oY(n){_I(n.g,function(t,e){this.g.hasOwnProperty(e)&&MI(t)},n),n.g={}}function KE(){this.g=!0}function Nf(n,t,e,r){n.info(function(){return"XMLHTTP TEXT ("+t+"): "+function hme(n,t){if(!n.g)return t;if(!t)return null;try{var e=JSON.parse(t);if(e)for(n=0;n<e.length;n++)if(Array.isArray(e[n])){var r=e[n];if(!(2>r.length)){var s=r[1];if(Array.isArray(s)&&!(1>s.length)){var i=s[0];if("noop"!=i&&"stop"!=i&&"close"!=i)for(var o=1;o<s.length;o++)s[o]=""}}}return wI(e)}catch{return t}}(n,e)+(r?" "+r:"")})}sg.prototype.M=function(){sg.X.M.call(this),oY(this)},sg.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},KE.prototype.Aa=function(){this.g=!1},KE.prototype.info=function(){};var $u={},aY=null;function XE(){return aY=aY||new Li}function cY(n){J2.call(this,$u.Pa,n)}function ig(n){const t=XE();y2(t,new cY(t))}function lY(n,t){J2.call(this,$u.STAT_EVENT,n),this.stat=t}function Ao(n){const t=XE();y2(t,new lY(t,n))}function uY(n,t){J2.call(this,$u.Qa,n),this.size=t}function og(n,t){if("function"!=typeof n)throw Error("Fn must not be null and must be a function");return Cn.setTimeout(function(){n()},t)}$u.Pa="serverreachability",C2(cY,J2),$u.STAT_EVENT="statevent",C2(lY,J2),$u.Qa="timingevent",C2(uY,J2);var QE={NO_ERROR:0,mb:1,zb:2,yb:3,tb:4,xb:5,Ab:6,Ma:7,TIMEOUT:8,Db:9},fY={rb:"complete",Nb:"success",Na:"error",Ma:"abort",Fb:"ready",Gb:"readystatechange",TIMEOUT:"timeout",Bb:"incrementaldata",Eb:"progress",ub:"downloadprogress",Vb:"uploadprogress"};function II(){}function hY(){}II.prototype.h=null;var LI,ag={OPEN:"a",qb:"b",Na:"c",Cb:"d"};function xI(){J2.call(this,"d")}function kI(){J2.call(this,"c")}function JE(){}function cg(n,t,e,r){this.l=n,this.j=t,this.m=e,this.U=r||1,this.S=new sg(this),this.O=pme,this.T=new YE(n=dI?125:void 0),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.V=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.Y=-1,this.I=!1,this.N=0,this.L=null,this.$=this.J=this.Z=this.P=!1,this.h=new pY}function pY(){this.i=null,this.g="",this.h=!1}C2(xI,J2),C2(kI,J2),C2(JE,II),JE.prototype.g=function(){return new XMLHttpRequest},JE.prototype.i=function(){return{}},LI=new JE;var pme=45e3,RI={},eM={};function DI(n,t,e){n.K=1,n.v=sM(Gl(t)),n.s=e,n.P=!0,gY(n,null)}function gY(n,t){n.F=Date.now(),lg(n),n.A=Gl(n.v);var e=n.A,r=n.U;Array.isArray(r)||(r=[String(r)]),TY(e.i,"t",r),n.C=0,e=n.l.H,n.h=new pY,n.g=YY(n.l,e?t:null,!n.s),0<n.N&&(n.L=new lme(Q2(n.La,n,n.g),n.N)),iY(n.S,n.g,"readystatechange",n.ib),t=n.H?qZ(n.H):{},n.s?(n.u||(n.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",n.g.da(n.A,n.u,n.s,t)):(n.u="GET",n.g.da(n.A,n.u,null,t)),ig(),function ume(n,t,e,r,s,i){n.info(function(){if(n.g)if(i)for(var o="",c=i.split("&"),u=0;u<c.length;u++){var d=c[u].split("=");if(1<d.length){var g=d[0];d=d[1];var m=g.split("_");o=2<=m.length&&"type"==m[1]?o+(g+"=")+d+"&":o+(g+"=redacted&")}}else o=null;else o=i;return"XMLHTTP REQ ("+r+") [attempt "+s+"]: "+t+"\n"+e+"\n"+o})}(n.j,n.u,n.A,n.m,n.U,n.s)}function mY(n){return!!n.g&&"GET"==n.u&&2!=n.K&&n.l.Da}function _Y(n,t,e){let s,r=!0;for(;!n.I&&n.C<e.length;){if(s=gme(n,e),s==eM){4==t&&(n.o=4,Ao(14),r=!1),Nf(n.j,n.m,null,"[Incomplete Response]");break}if(s==RI){n.o=4,Ao(15),Nf(n.j,n.m,e,"[Invalid Chunk]"),r=!1;break}Nf(n.j,n.m,s,null),zI(n,s)}mY(n)&&s!=eM&&s!=RI&&(n.h.g="",n.C=0),4!=t||0!=e.length||n.h.h||(n.o=1,Ao(16),r=!1),n.i=n.i&&r,r?0<e.length&&!n.$&&(n.$=!0,(t=n.l).g==n&&t.$&&!t.K&&(t.j.info("Great, no buffering proxy detected. Bytes received: "+e.length),WI(t),t.K=!0,Ao(11))):(Nf(n.j,n.m,e,"[Invalid Chunked Response]"),Uu(n),ug(n))}function gme(n,t){var e=n.C,r=t.indexOf("\n",e);return-1==r?eM:(e=Number(t.substring(e,r)),isNaN(e)?RI:(r+=1)+e>t.length?eM:(t=t.substr(r,e),n.C=r+e,t))}function lg(n){n.V=Date.now()+n.O,vY(n,n.O)}function vY(n,t){if(null!=n.B)throw Error("WatchDog timer not null");n.B=og(Q2(n.gb,n),t)}function tM(n){n.B&&(Cn.clearTimeout(n.B),n.B=null)}function ug(n){0==n.l.G||n.I||WY(n.l,n)}function Uu(n){tM(n);var t=n.L;t&&"function"==typeof t.na&&t.na(),n.L=null,AI(n.T),oY(n.S),n.g&&(t=n.g,n.g=null,t.abort(),t.na())}function zI(n,t){try{var e=n.l;if(0!=e.G&&(e.g==n||VI(e.h,n)))if(!n.J&&VI(e.h,n)&&3==e.G){try{var r=e.Fa.g.parse(t)}catch{r=null}if(Array.isArray(r)&&3==r.length){var s=r;if(0==s[0]){e:if(!e.u){if(e.g){if(!(e.g.F+3e3<n.F))break e;uM(e),cM(e)}GI(e),Ao(18)}}else e.Ba=s[1],0<e.Ba-e.T&&37500>s[2]&&e.L&&0==e.A&&!e.v&&(e.v=og(Q2(e.cb,e),6e3));if(1>=OY(e.h)&&e.ja){try{e.ja()}catch{}e.ja=void 0}}else Wu(e,11)}else if((n.J||e.g==n)&&uM(e),!UE(t))for(s=e.Fa.g.parse(t),t=0;t<s.length;t++){let d=s[t];if(e.T=d[0],d=d[1],2==e.G)if("c"==d[0]){e.I=d[1],e.ka=d[2];const g=d[3];null!=g&&(e.ma=g,e.j.info("VER="+e.ma));const m=d[4];null!=m&&(e.Ca=m,e.j.info("SVER="+e.Ca));const y=d[5];null!=y&&"number"==typeof y&&0<y&&(e.J=r=1.5*y,e.j.info("backChannelRequestTimeoutMs_="+r)),r=e;const b=n.g;if(b){const k=b.g?b.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(k){var i=r.h;i.g||-1==k.indexOf("spdy")&&-1==k.indexOf("quic")&&-1==k.indexOf("h2")||(i.j=i.l,i.g=new Set,i.h&&(HI(i,i.h),i.h=null))}if(r.D){const $=b.g?b.g.getResponseHeader("X-HTTP-Session-Id"):null;$&&(r.za=$,Vr(r.F,r.D,$))}}e.G=3,e.l&&e.l.xa(),e.$&&(e.P=Date.now()-n.F,e.j.info("Handshake RTT: "+e.P+"ms"));var o=n;if((r=e).sa=ZY(r,r.H?r.ka:null,r.V),o.J){AY(r.h,o);var c=o,u=r.J;u&&c.setTimeout(u),c.B&&(tM(c),lg(c)),r.g=o}else UY(r);0<e.i.length&&lM(e)}else"stop"!=d[0]&&"close"!=d[0]||Wu(e,7);else 3==e.G&&("stop"==d[0]||"close"==d[0]?"stop"==d[0]?Wu(e,7):UI(e):"noop"!=d[0]&&e.l&&e.l.wa(d),e.A=0)}ig()}catch{}}function CY(n,t){if(n.forEach&&"function"==typeof n.forEach)n.forEach(t,void 0);else if(BE(n)||"string"==typeof n)Array.prototype.forEach.call(n,t,void 0);else for(var e=function _me(n){if(n.oa&&"function"==typeof n.oa)return n.oa();if(!n.W||"function"!=typeof n.W){if(typeof Map<"u"&&n instanceof Map)return Array.from(n.keys());if(!(typeof Set<"u"&&n instanceof Set)){if(BE(n)||"string"==typeof n){var t=[];n=n.length;for(var e=0;e<n;e++)t.push(e);return t}t=[],e=0;for(const r in n)t[e++]=r;return t}}}(n),r=function mme(n){if(n.W&&"function"==typeof n.W)return n.W();if(typeof Map<"u"&&n instanceof Map||typeof Set<"u"&&n instanceof Set)return Array.from(n.values());if("string"==typeof n)return n.split("");if(BE(n)){for(var t=[],e=n.length,r=0;r<e;r++)t.push(n[r]);return t}for(r in t=[],e=0,n)t[e++]=n[r];return t}(n),s=r.length,i=0;i<s;i++)t.call(void 0,r[i],e&&e[i],n)}(At=cg.prototype).setTimeout=function(n){this.O=n},At.ib=function(n){n=n.target;const t=this.L;t&&3==Wl(n)?t.l():this.La(n)},At.La=function(n){try{if(n==this.g)e:{const g=Wl(this.g);var t=this.g.Ea();if(this.g.aa(),!(3>g)&&(3!=g||dI||this.g&&(this.h.h||this.g.fa()||zY(this.g)))){this.I||4!=g||7==t||ig(),tM(this);var e=this.g.aa();this.Y=e;t:if(mY(this)){var r=zY(this.g);n="";var s=r.length,i=4==Wl(this.g);if(!this.h.i){if(typeof TextDecoder>"u"){Uu(this),ug(this);var o="";break t}this.h.i=new Cn.TextDecoder}for(t=0;t<s;t++)this.h.h=!0,n+=this.h.i.decode(r[t],{stream:i&&t==s-1});r.splice(0,s),this.h.g+=n,this.C=0,o=this.h.g}else o=this.g.fa();if(this.i=200==e,function fme(n,t,e,r,s,i,o){n.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+s+"]: "+t+"\n"+e+"\n"+i+" "+o})}(this.j,this.u,this.A,this.m,this.U,g,e),this.i){if(this.Z&&!this.J){t:{if(this.g){var c,u=this.g;if((c=u.g?u.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!UE(c)){var d=c;break t}}d=null}if(!(e=d)){this.i=!1,this.o=3,Ao(12),Uu(this),ug(this);break e}Nf(this.j,this.m,e,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,zI(this,e)}this.P?(_Y(this,g,o),dI&&this.i&&3==g&&(iY(this.S,this.T,"tick",this.hb),this.T.start())):(Nf(this.j,this.m,o,null),zI(this,o)),4==g&&Uu(this),this.i&&!this.I&&(4==g?WY(this.l,this):(this.i=!1,lg(this)))}else 400==e&&0<o.indexOf("Unknown SID")?(this.o=3,Ao(12)):(this.o=0,Ao(13)),Uu(this),ug(this)}}}catch{}},At.hb=function(){if(this.g){var n=Wl(this.g),t=this.g.fa();this.C<t.length&&(tM(this),_Y(this,n,t),this.i&&4!=n&&lg(this))}},At.cancel=function(){this.I=!0,Uu(this)},At.gb=function(){this.B=null;const n=Date.now();0<=n-this.V?(function dme(n,t){n.info(function(){return"TIMEOUT: "+t})}(this.j,this.A),2!=this.K&&(ig(),Ao(17)),Uu(this),this.o=2,ug(this)):vY(this,this.V-n)};var yY=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Gu(n,t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,n instanceof Gu){this.h=void 0!==t?t:n.h,nM(this,n.j),this.s=n.s,this.g=n.g,rM(this,n.m),this.l=n.l,t=n.i;var e=new hg;e.i=t.i,t.g&&(e.g=new Map(t.g),e.h=t.h),EY(this,e),this.o=n.o}else n&&(e=String(n).match(yY))?(this.h=!!t,nM(this,e[1]||"",!0),this.s=fg(e[2]||""),this.g=fg(e[3]||"",!0),rM(this,e[4]),this.l=fg(e[5]||"",!0),EY(this,e[6]||"",!0),this.o=fg(e[7]||"")):(this.h=!!t,this.i=new hg(null,this.h))}function Gl(n){return new Gu(n)}function nM(n,t,e){n.j=e?fg(t,!0):t,n.j&&(n.j=n.j.replace(/:$/,""))}function rM(n,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);n.m=t}else n.m=null}function EY(n,t,e){t instanceof hg?(n.i=t,function Pme(n,t){t&&!n.j&&(R0(n),n.i=null,n.g.forEach(function(e,r){var s=r.toLowerCase();r!=s&&(SY(this,r),TY(this,s,e))},n)),n.j=t}(n.i,n.h)):(e||(t=dg(t,Mme)),n.i=new hg(t,n.h))}function Vr(n,t,e){n.i.set(t,e)}function sM(n){return Vr(n,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),n}function fg(n,t){return n?t?decodeURI(n.replace(/%25/g,"%2525")):decodeURIComponent(n):""}function dg(n,t,e){return"string"==typeof n?(n=encodeURI(n).replace(t,Cme),e&&(n=n.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n):null}function Cme(n){return"%"+((n=n.charCodeAt(0))>>4&15).toString(16)+(15&n).toString(16)}Gu.prototype.toString=function(){var n=[],t=this.j;t&&n.push(dg(t,MY,!0),":");var e=this.g;return(e||"file"==t)&&(n.push("//"),(t=this.s)&&n.push(dg(t,MY,!0),"@"),n.push(encodeURIComponent(String(e)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(e=this.m)&&n.push(":",String(e))),(e=this.l)&&(this.g&&"/"!=e.charAt(0)&&n.push("/"),n.push(dg(e,"/"==e.charAt(0)?Eme:yme,!0))),(e=this.i.toString())&&n.push("?",e),(e=this.o)&&n.push("#",dg(e,Sme)),n.join("")};var MY=/[#\/\?@]/g,yme=/[#\?:]/g,Eme=/[#\?]/g,Mme=/[#\?@]/g,Sme=/#/g;function hg(n,t){this.h=this.g=null,this.i=n||null,this.j=!!t}function R0(n){n.g||(n.g=new Map,n.h=0,n.i&&function vme(n,t){if(n){n=n.split("&");for(var e=0;e<n.length;e++){var r=n[e].indexOf("="),s=null;if(0<=r){var i=n[e].substring(0,r);s=n[e].substring(r+1)}else i=n[e];t(i,s?decodeURIComponent(s.replace(/\+/g," ")):"")}}}(n.i,function(t,e){n.add(decodeURIComponent(t.replace(/\+/g," ")),e)}))}function SY(n,t){R0(n),t=If(n,t),n.g.has(t)&&(n.i=null,n.h-=n.g.get(t).length,n.g.delete(t))}function PY(n,t){return R0(n),t=If(n,t),n.g.has(t)}function TY(n,t,e){SY(n,t),0<e.length&&(n.i=null,n.g.set(If(n,t),lI(e)),n.h+=e.length)}function If(n,t){return t=String(t),n.j&&(t=t.toLowerCase()),t}function wY(n){this.l=n||wme,n=Cn.PerformanceNavigationTiming?0<(n=Cn.performance.getEntriesByType("navigation")).length&&("hq"==n[0].nextHopProtocol||"h2"==n[0].nextHopProtocol):!!(Cn.g&&Cn.g.Ga&&Cn.g.Ga()&&Cn.g.Ga().$b),this.j=n?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(At=hg.prototype).add=function(n,t){R0(this),this.i=null,n=If(this,n);var e=this.g.get(n);return e||this.g.set(n,e=[]),e.push(t),this.h+=1,this},At.forEach=function(n,t){R0(this),this.g.forEach(function(e,r){e.forEach(function(s){n.call(t,s,r,this)},this)},this)},At.oa=function(){R0(this);const n=Array.from(this.g.values()),t=Array.from(this.g.keys()),e=[];for(let r=0;r<t.length;r++){const s=n[r];for(let i=0;i<s.length;i++)e.push(t[r])}return e},At.W=function(n){R0(this);let t=[];if("string"==typeof n)PY(this,n)&&(t=t.concat(this.g.get(If(this,n))));else{n=Array.from(this.g.values());for(let e=0;e<n.length;e++)t=t.concat(n[e])}return t},At.set=function(n,t){return R0(this),this.i=null,PY(this,n=If(this,n))&&(this.h-=this.g.get(n).length),this.g.set(n,[t]),this.h+=1,this},At.get=function(n,t){return n&&0<(n=this.W(n)).length?String(n[0]):t},At.toString=function(){if(this.i)return this.i;if(!this.g)return"";const n=[],t=Array.from(this.g.keys());for(var e=0;e<t.length;e++){var r=t[e];const i=encodeURIComponent(String(r)),o=this.W(r);for(r=0;r<o.length;r++){var s=i;""!==o[r]&&(s+="="+encodeURIComponent(String(o[r]))),n.push(s)}}return this.i=n.join("&")};var wme=10;function bY(n){return!!n.h||!!n.g&&n.g.size>=n.j}function OY(n){return n.h?1:n.g?n.g.size:0}function VI(n,t){return n.h?n.h==t:!!n.g&&n.g.has(t)}function HI(n,t){n.g?n.g.add(t):n.h=t}function AY(n,t){n.h&&n.h==t?n.h=null:n.g&&n.g.has(t)&&n.g.delete(t)}function NY(n){if(null!=n.h)return n.i.concat(n.h.D);if(null!=n.g&&0!==n.g.size){let t=n.i;for(const e of n.g.values())t=t.concat(e.D);return t}return lI(n.i)}function FI(){}function bme(){this.g=new FI}function Ome(n,t,e){const r=e||"";try{CY(n,function(s,i){let o=s;tg(s)&&(o=wI(s)),t.push(r+i+"="+encodeURIComponent(o))})}catch(s){throw t.push(r+"type="+encodeURIComponent("_badmap")),s}}function iM(n,t,e,r,s){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,s(r)}catch{}}function pg(n){this.l=n.ac||null,this.j=n.jb||!1}function oM(n,t){Li.call(this),this.D=n,this.u=t,this.m=void 0,this.readyState=BI,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}wY.prototype.cancel=function(){if(this.i=NY(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const n of this.g.values())n.cancel();this.g.clear()}},FI.prototype.stringify=function(n){return Cn.JSON.stringify(n,void 0)},FI.prototype.parse=function(n){return Cn.JSON.parse(n,void 0)},C2(pg,II),pg.prototype.g=function(){return new oM(this.l,this.j)},pg.prototype.i=function(n){return function(){return n}}({}),C2(oM,Li);var BI=0;function IY(n){n.j.read().then(n.Ta.bind(n)).catch(n.ga.bind(n))}function gg(n){n.readyState=4,n.l=null,n.j=null,n.A=null,mg(n)}function mg(n){n.onreadystatechange&&n.onreadystatechange.call(n)}(At=oM.prototype).open=function(n,t){if(this.readyState!=BI)throw this.abort(),Error("Error reopening a connection");this.C=n,this.B=t,this.readyState=1,mg(this)},At.send=function(n){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};n&&(t.body=n),(this.D||Cn).fetch(new Request(this.B,t)).then(this.Wa.bind(this),this.ga.bind(this))},At.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,gg(this)),this.readyState=BI},At.Wa=function(n){if(this.g&&(this.l=n,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=n.headers,this.readyState=2,mg(this)),this.g&&(this.readyState=3,mg(this),this.g)))if("arraybuffer"===this.responseType)n.arrayBuffer().then(this.Ua.bind(this),this.ga.bind(this));else if(typeof Cn.ReadableStream<"u"&&"body"in n){if(this.j=n.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;IY(this)}else n.text().then(this.Va.bind(this),this.ga.bind(this))},At.Ta=function(n){if(this.g){if(this.u&&n.value)this.response.push(n.value);else if(!this.u){var t=n.value?n.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!n.done}))&&(this.response=this.responseText+=t)}n.done?gg(this):mg(this),3==this.readyState&&IY(this)}},At.Va=function(n){this.g&&(this.response=this.responseText=n,gg(this))},At.Ua=function(n){this.g&&(this.response=n,gg(this))},At.ga=function(){this.g&&gg(this)},At.setRequestHeader=function(n,t){this.v.append(n,t)},At.getResponseHeader=function(n){return this.h&&this.h.get(n.toLowerCase())||""},At.getAllResponseHeaders=function(){if(!this.h)return"";const n=[],t=this.h.entries();for(var e=t.next();!e.done;)n.push((e=e.value)[0]+": "+e[1]),e=t.next();return n.join("\r\n")},Object.defineProperty(oM.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(n){this.m=n?"include":"same-origin"}});var Nme=Cn.JSON.parse;function hs(n){Li.call(this),this.headers=new Map,this.u=n||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=xY,this.K=this.L=!1}C2(hs,Li);var xY="",Ime=/^https?$/i,xme=["POST","PUT"];function kY(n,t){n.h=!1,n.g&&(n.l=!0,n.g.abort(),n.l=!1),n.j=t,n.m=5,LY(n),aM(n)}function LY(n){n.D||(n.D=!0,y2(n,"complete"),y2(n,"error"))}function RY(n){if(n.h&&typeof aI<"u"&&(!n.C[1]||4!=Wl(n)||2!=n.aa()))if(n.v&&4==Wl(n))NI(n.Ha,0,n);else if(y2(n,"readystatechange"),4==Wl(n)){n.h=!1;try{const c=n.aa();e:switch(c){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var e;if(!(e=t)){var r;if(r=0===c){var s=String(n.H).match(yY)[1]||null;if(!s&&Cn.self&&Cn.self.location){var i=Cn.self.location.protocol;s=i.substr(0,i.length-1)}r=!Ime.test(s?s.toLowerCase():"")}e=r}if(e)y2(n,"complete"),y2(n,"success");else{n.m=6;try{var o=2<Wl(n)?n.g.statusText:""}catch{o=""}n.j=o+" ["+n.aa()+"]",LY(n)}}finally{aM(n)}}}function aM(n,t){if(n.g){DY(n);const e=n.g,r=n.C[0]?FE:null;n.g=null,n.C=null,t||y2(n,"ready");try{e.onreadystatechange=r}catch{}}}function DY(n){n.g&&n.K&&(n.g.ontimeout=null),n.A&&(Cn.clearTimeout(n.A),n.A=null)}function Wl(n){return n.g?n.g.readyState:0}function zY(n){try{if(!n.g)return null;if("response"in n.g)return n.g.response;switch(n.J){case xY:case"text":return n.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in n.g)return n.g.mozResponseArrayBuffer}return null}catch{return null}}function VY(n){let t="";return _I(n,function(e,r){t+=r,t+=":",t+=e,t+="\r\n"}),t}function $I(n,t,e){e:{for(r in e){var r=!1;break e}r=!0}r||(e=VY(e),"string"==typeof n?null!=e&&encodeURIComponent(String(e)):Vr(n,t,e))}function _g(n,t,e){return e&&e.internalChannelParams&&e.internalChannelParams[n]||t}function HY(n){this.Ca=0,this.i=[],this.j=new KE,this.ka=this.sa=this.F=this.V=this.g=this.za=this.D=this.ia=this.o=this.S=this.s=null,this.ab=this.U=0,this.Za=_g("failFast",!1,n),this.L=this.v=this.u=this.m=this.l=null,this.Y=!0,this.pa=this.Ba=this.T=-1,this.Z=this.A=this.C=0,this.Xa=_g("baseRetryDelayMs",5e3,n),this.bb=_g("retryDelaySeedMs",1e4,n),this.$a=_g("forwardChannelMaxRetries",2,n),this.ta=_g("forwardChannelRequestTimeoutMs",2e4,n),this.ra=n&&n.xmlHttpFactory||void 0,this.Da=n&&n.Zb||!1,this.J=void 0,this.H=n&&n.supportsCrossDomainXhr||!1,this.I="",this.h=new wY(n&&n.concurrentRequestLimit),this.Fa=new bme,this.O=n&&n.fastHandshake||!1,this.N=n&&n.encodeInitMessageHeaders||!1,this.O&&this.N&&(this.N=!1),this.Ya=n&&n.Xb||!1,n&&n.Aa&&this.j.Aa(),n&&n.forceLongPolling&&(this.Y=!1),this.$=!this.O&&this.Y&&n&&n.detectBufferingProxy||!1,this.ja=void 0,this.P=0,this.K=!1,this.la=this.B=null}function UI(n){if(FY(n),3==n.G){var t=n.U++,e=Gl(n.F);Vr(e,"SID",n.I),Vr(e,"RID",t),Vr(e,"TYPE","terminate"),vg(n,e),(t=new cg(n,n.j,t,void 0)).K=2,t.v=sM(Gl(e)),e=!1,Cn.navigator&&Cn.navigator.sendBeacon&&(e=Cn.navigator.sendBeacon(t.v.toString(),"")),!e&&Cn.Image&&((new Image).src=t.v,e=!0),e||(t.g=YY(t.l,null),t.g.da(t.v)),t.F=Date.now(),lg(t)}jY(n)}function cM(n){n.g&&(WI(n),n.g.cancel(),n.g=null)}function FY(n){cM(n),n.u&&(Cn.clearTimeout(n.u),n.u=null),uM(n),n.h.cancel(),n.m&&("number"==typeof n.m&&Cn.clearTimeout(n.m),n.m=null)}function lM(n){bY(n.h)||n.m||(n.m=!0,tY(n.Ja,n),n.C=0)}function BY(n,t){var e;e=t?t.m:n.U++;const r=Gl(n.F);Vr(r,"SID",n.I),Vr(r,"RID",e),Vr(r,"AID",n.T),vg(n,r),n.o&&n.s&&$I(r,n.o,n.s),e=new cg(n,n.j,e,n.C+1),null===n.o&&(e.H=n.s),t&&(n.i=t.D.concat(n.i)),t=$Y(n,e,1e3),e.setTimeout(Math.round(.5*n.ta)+Math.round(.5*n.ta*Math.random())),HI(n.h,e),DI(e,r,t)}function vg(n,t){n.ia&&_I(n.ia,function(e,r){Vr(t,r,e)}),n.l&&CY({},function(e,r){Vr(t,r,e)})}function $Y(n,t,e){e=Math.min(n.i.length,e);var r=n.l?Q2(n.l.Ra,n.l,n):null;e:{var s=n.i;let i=-1;for(;;){const o=["count="+e];-1==i?0<e?(i=s[0].h,o.push("ofs="+i)):i=0:o.push("ofs="+i);let c=!0;for(let u=0;u<e;u++){let d=s[u].h;const g=s[u].g;if(d-=i,0>d)i=Math.max(0,s[u].h-100),c=!1;else try{Ome(g,o,"req"+d+"_")}catch{r&&r(g)}}if(c){r=o.join("&");break e}}}return n=n.i.splice(0,e),t.D=n,r}function UY(n){n.g||n.u||(n.Z=1,tY(n.Ia,n),n.A=0)}function GI(n){return!(n.g||n.u||3<=n.A||(n.Z++,n.u=og(Q2(n.Ia,n),qY(n,n.A)),n.A++,0))}function WI(n){null!=n.B&&(Cn.clearTimeout(n.B),n.B=null)}function GY(n){n.g=new cg(n,n.j,"rpc",n.Z),null===n.o&&(n.g.H=n.s),n.g.N=0;var t=Gl(n.sa);Vr(t,"RID","rpc"),Vr(t,"SID",n.I),Vr(t,"CI",n.L?"0":"1"),Vr(t,"AID",n.T),Vr(t,"TYPE","xmlhttp"),vg(n,t),n.o&&n.s&&$I(t,n.o,n.s),n.J&&n.g.setTimeout(n.J);var e=n.g;n=n.ka,e.K=1,e.v=sM(Gl(t)),e.s=null,e.P=!0,gY(e,n)}function uM(n){null!=n.v&&(Cn.clearTimeout(n.v),n.v=null)}function WY(n,t){var e=null;if(n.g==t){uM(n),WI(n),n.g=null;var r=2}else{if(!VI(n.h,t))return;e=t.D,AY(n.h,t),r=1}if(0!=n.G)if(n.pa=t.Y,t.i)if(1==r){e=t.s?t.s.length:0,t=Date.now()-t.F;var s=n.C;y2(r=XE(),new uY(r,e)),lM(n)}else UY(n);else if(3==(s=t.o)||0==s&&0<n.pa||!(1==r&&function Lme(n,t){return!(OY(n.h)>=n.h.j-(n.m?1:0)||(n.m?(n.i=t.D.concat(n.i),0):1==n.G||2==n.G||n.C>=(n.Za?0:n.$a)||(n.m=og(Q2(n.Ja,n,t),qY(n,n.C)),n.C++,0)))}(n,t)||2==r&&GI(n)))switch(e&&0<e.length&&(t=n.h,t.i=t.i.concat(e)),s){case 1:Wu(n,5);break;case 4:Wu(n,10);break;case 3:Wu(n,6);break;default:Wu(n,2)}}function qY(n,t){let e=n.Xa+Math.floor(Math.random()*n.bb);return n.l||(e*=2),e*t}function Wu(n,t){if(n.j.info("Error code "+t),2==t){var e=null;n.l&&(e=null);var r=Q2(n.kb,n);e||(e=new Gu("//www.google.com/images/cleardot.gif"),Cn.location&&"http"==Cn.location.protocol||nM(e,"https"),sM(e)),function Ame(n,t){const e=new KE;if(Cn.Image){const r=new Image;r.onload=$E(iM,e,r,"TestLoadImage: loaded",!0,t),r.onerror=$E(iM,e,r,"TestLoadImage: error",!1,t),r.onabort=$E(iM,e,r,"TestLoadImage: abort",!1,t),r.ontimeout=$E(iM,e,r,"TestLoadImage: timeout",!1,t),Cn.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=n}else t(!1)}(e.toString(),r)}else Ao(2);n.G=0,n.l&&n.l.va(t),jY(n),FY(n)}function jY(n){if(n.G=0,n.la=[],n.l){const t=NY(n.h);(0!=t.length||0!=n.i.length)&&(FZ(n.la,t),FZ(n.la,n.i),n.h.i.length=0,lI(n.i),n.i.length=0),n.l.ua()}}function ZY(n,t,e){var r=e instanceof Gu?Gl(e):new Gu(e,void 0);if(""!=r.g)t&&(r.g=t+"."+r.g),rM(r,r.m);else{var s=Cn.location;r=s.protocol,t=t?t+"."+s.hostname:s.hostname,s=+s.port;var i=new Gu(null,void 0);r&&nM(i,r),t&&(i.g=t),s&&rM(i,s),e&&(i.l=e),r=i}return t=n.za,(e=n.D)&&t&&Vr(r,e,t),Vr(r,"VER",n.ma),vg(n,r),r}function YY(n,t,e){if(t&&!n.H)throw Error("Can't create secondary domain capable XhrIo object.");return(t=new hs(e&&n.Da&&!n.ra?new pg({jb:!0}):n.ra)).Ka(n.H),t}function KY(){}function fM(){if(Af&&!(10<=Number(Xge)))throw Error("Environmental error: no available transport.")}function $a(n,t){Li.call(this),this.g=new HY(t),this.l=n,this.h=t&&t.messageUrlParams||null,n=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(n?n["X-Client-Protocol"]="webchannel":n={"X-Client-Protocol":"webchannel"}),this.g.s=n,n=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(n?n["X-WebChannel-Content-Type"]=t.messageContentType:n={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.ya&&(n?n["X-WebChannel-Client-Profile"]=t.ya:n={"X-WebChannel-Client-Profile":t.ya}),this.g.S=n,(n=t&&t.Yb)&&!UE(n)&&(this.g.o=n),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!UE(t)&&(this.g.D=t,null!==(n=this.h)&&t in n&&t in(n=this.h)&&delete n[t]),this.j=new xf(this)}function XY(n){xI.call(this);var t=n.__sm__;if(t){e:{for(const e in t){n=e;break e}n=void 0}(this.i=n)&&(n=this.i,t=null!==t&&n in t?t[n]:void 0),this.data=t}else this.data=n}function QY(){kI.call(this),this.status=1}function xf(n){this.g=n}(At=hs.prototype).Ka=function(n){this.L=n},At.da=function(n,t,e,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+n);t=t?t.toUpperCase():"GET",this.H=n,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():LI.g(),this.C=function dY(n){return n.h||(n.h=n.i())}(this.u?this.u:LI),this.g.onreadystatechange=Q2(this.Ha,this);try{this.F=!0,this.g.open(t,String(n),!0),this.F=!1}catch(i){return void kY(this,i)}if(n=e||"",e=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var s in r)e.set(s,r[s]);else{if("function"!=typeof r.keys||"function"!=typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const i of r.keys())e.set(i,r.get(i))}r=Array.from(e.keys()).find(i=>"content-type"==i.toLowerCase()),s=Cn.FormData&&n instanceof Cn.FormData,!(0<=HZ(xme,t))||r||s||e.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[i,o]of e)this.g.setRequestHeader(i,o);this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{DY(this),0<this.B&&((this.K=function kme(n){return Af&&function Kge(){return function qge(n){var t=Yge;return Object.prototype.hasOwnProperty.call(t,9)?t[9]:t[9]=n(9)}(function(){let n=0;const t=BZ(String(WE)).split("."),e=BZ("9").split("."),r=Math.max(t.length,e.length);for(let o=0;0==n&&o<r;o++){var s=t[o]||"",i=e[o]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],i=/(\d*)(\D*)(.*)/.exec(i)||["","","",""],0==s[0].length&&0==i[0].length)break;n=uI(0==s[1].length?0:parseInt(s[1],10),0==i[1].length?0:parseInt(i[1],10))||uI(0==s[2].length,0==i[2].length)||uI(s[2],i[2]),s=s[3],i=i[3]}while(0==n)}return 0<=n})}()&&"number"==typeof n.timeout&&void 0!==n.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Q2(this.qa,this)):this.A=NI(this.qa,this.B,this)),this.v=!0,this.g.send(n),this.v=!1}catch(i){kY(this,i)}},At.qa=function(){typeof aI<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,y2(this,"timeout"),this.abort(8))},At.abort=function(n){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=n||7,y2(this,"complete"),y2(this,"abort"),aM(this))},At.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),aM(this,!0)),hs.X.M.call(this)},At.Ha=function(){this.s||(this.F||this.v||this.l?RY(this):this.fb())},At.fb=function(){RY(this)},At.aa=function(){try{return 2<Wl(this)?this.g.status:-1}catch{return-1}},At.fa=function(){try{return this.g?this.g.responseText:""}catch{return""}},At.Sa=function(n){if(this.g){var t=this.g.responseText;return n&&0==t.indexOf(n)&&(t=t.substring(n.length)),Nme(t)}},At.Ea=function(){return this.m},At.Oa=function(){return"string"==typeof this.j?this.j:String(this.j)},(At=HY.prototype).ma=8,At.G=1,At.Ja=function(n){if(this.m)if(this.m=null,1==this.G){if(!n){this.U=Math.floor(1e5*Math.random()),n=this.U++;const s=new cg(this,this.j,n,void 0);let i=this.s;if(this.S&&(i?(i=qZ(i),ZZ(i,this.S)):i=this.S),null!==this.o||this.N||(s.H=i,i=null),this.O)e:{for(var t=0,e=0;e<this.i.length;e++){var r=this.i[e];if(void 0===(r="__data__"in r.g&&"string"==typeof(r=r.g.__data__)?r.length:void 0))break;if(4096<(t+=r)){t=e;break e}if(4096===t||e===this.i.length-1){t=e+1;break e}}t=1e3}else t=1e3;t=$Y(this,s,t),Vr(e=Gl(this.F),"RID",n),Vr(e,"CVER",22),this.D&&Vr(e,"X-HTTP-Session-Id",this.D),vg(this,e),i&&(this.N?t="headers="+encodeURIComponent(String(VY(i)))+"&"+t:this.o&&$I(e,this.o,i)),HI(this.h,s),this.Ya&&Vr(e,"TYPE","init"),this.O?(Vr(e,"$req",t),Vr(e,"SID","null"),s.Z=!0,DI(s,e,null)):DI(s,e,t),this.G=2}}else 3==this.G&&(n?BY(this,n):0==this.i.length||bY(this.h)||BY(this))},At.Ia=function(){if(this.u=null,GY(this),this.$&&!(this.K||null==this.g||0>=this.P)){var n=2*this.P;this.j.info("BP detection timer enabled: "+n),this.B=og(Q2(this.eb,this),n)}},At.eb=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.L=!1,this.K=!0,Ao(10),cM(this),GY(this))},At.cb=function(){null!=this.v&&(this.v=null,cM(this),GI(this),Ao(19))},At.kb=function(n){n?(this.j.info("Successfully pinged google.com"),Ao(2)):(this.j.info("Failed to ping google.com"),Ao(1))},(At=KY.prototype).xa=function(){},At.wa=function(){},At.va=function(){},At.ua=function(){},At.Ra=function(){},fM.prototype.g=function(n,t){return new $a(n,t)},C2($a,Li),$a.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.H=!0);var n=this.g,t=this.l,e=this.h||void 0;Ao(0),n.V=t,n.ia=e||{},n.L=n.Y,n.F=ZY(n,null,n.V),lM(n)},$a.prototype.close=function(){UI(this.g)},$a.prototype.u=function(n){var t=this.g;if("string"==typeof n){var e={};e.__data__=n,n=e}else this.v&&((e={}).__data__=wI(n),n=e);t.i.push(new class{constructor(n,t){this.h=n,this.g=t}}(t.ab++,n)),3==t.G&&lM(t)},$a.prototype.M=function(){this.g.l=null,delete this.j,UI(this.g),delete this.g,$a.X.M.call(this)},C2(XY,xI),C2(QY,kI),C2(xf,KY),xf.prototype.xa=function(){y2(this.g,"a")},xf.prototype.wa=function(n){y2(this.g,new XY(n))},xf.prototype.va=function(n){y2(this.g,new QY)},xf.prototype.ua=function(){y2(this.g,"b")},fM.prototype.createWebChannel=fM.prototype.g,$a.prototype.send=$a.prototype.u,$a.prototype.open=$a.prototype.m,$a.prototype.close=$a.prototype.close,QE.NO_ERROR=0,QE.TIMEOUT=8,QE.HTTP_ERROR=6,fY.COMPLETE="complete",hY.EventType=ag,ag.OPEN="a",ag.CLOSE="b",ag.ERROR="c",ag.MESSAGE="d",Li.prototype.listen=Li.prototype.N,hs.prototype.listenOnce=hs.prototype.O,hs.prototype.getLastError=hs.prototype.Oa,hs.prototype.getLastErrorCode=hs.prototype.Ea,hs.prototype.getStatus=hs.prototype.aa,hs.prototype.getResponseJson=hs.prototype.Sa,hs.prototype.getResponseText=hs.prototype.fa,hs.prototype.send=hs.prototype.da,hs.prototype.setWithCredentials=hs.prototype.Ka;var Rme=Ul.createWebChannelTransport=function(){return new fM},Dme=Ul.getStatEventTarget=function(){return XE()},qI=Ul.ErrorCode=QE,zme=Ul.EventType=fY,Vme=Ul.Event=$u,JY=Ul.Stat={sb:0,vb:1,wb:2,Pb:3,Ub:4,Rb:5,Sb:6,Qb:7,Ob:8,Tb:9,PROXY:10,NOPROXY:11,Mb:12,Ib:13,Jb:14,Hb:15,Kb:16,Lb:17,ob:18,nb:19,pb:20},Hme=Ul.FetchXmlHttpFactory=pg,dM=Ul.WebChannel=hY,Fme=Ul.XhrIo=hs;const eK="@firebase/firestore";class Ri{constructor(t){this.uid=t}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}Ri.UNAUTHENTICATED=new Ri(null),Ri.GOOGLE_CREDENTIALS=new Ri("google-credentials-uid"),Ri.FIRST_PARTY=new Ri("first-party-uid"),Ri.MOCK_USER=new Ri("mock-user");let kf="9.14.0";const D0=new wf("@firebase/firestore");function jI(){return D0.logLevel}function qe(n,...t){if(D0.logLevel<=p1.DEBUG){const e=t.map(ZI);D0.debug(`Firestore (${kf}): ${n}`,...e)}}function ws(n,...t){if(D0.logLevel<=p1.ERROR){const e=t.map(ZI);D0.error(`Firestore (${kf}): ${n}`,...e)}}function Lf(n,...t){if(D0.logLevel<=p1.WARN){const e=t.map(ZI);D0.warn(`Firestore (${kf}): ${n}`,...e)}}function ZI(n){if("string"==typeof n)return n;try{return JSON.stringify(n)}catch{return n}}function wt(n="Unexpected state"){const t=`FIRESTORE (${kf}) INTERNAL ASSERTION FAILED: `+n;throw ws(t),new Error(t)}function on(n,t){n||wt()}function ut(n,t){return n}const Ae={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ue extends kc{constructor(t,e){super(t,e),this.code=t,this.message=e,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class pi{constructor(){this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}}class tK{constructor(t,e){this.user=e,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class Bme{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable(()=>e(Ri.UNAUTHENTICATED))}shutdown(){}}class $me{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,e){this.changeListener=e,t.enqueueRetryable(()=>e(this.token.user))}shutdown(){this.changeListener=null}}class Ume{constructor(t){this.t=t,this.currentUser=Ri.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,e){var r=this;let s=this.i;const i=d=>this.i!==s?(s=this.i,e(d)):Promise.resolve();let o=new pi;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new pi,t.enqueueRetryable(()=>i(this.currentUser))};const c=()=>{const d=o;t.enqueueRetryable(I(function*(){yield d.promise,yield i(r.currentUser)}))},u=d=>{qe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=d,this.auth.addAuthTokenListener(this.o),c()};this.t.onInit(d=>u(d)),setTimeout(()=>{if(!this.auth){const d=this.t.getImmediate({optional:!0});d?u(d):(qe("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new pi)}},0),c()}getToken(){const t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then(r=>this.i!==t?(qe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(on("string"==typeof r.accessToken),new tK(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const t=this.auth&&this.auth.getUid();return on(null===t||"string"==typeof t),new Ri(t)}}class Gme{constructor(t,e,r,s){this.h=t,this.l=e,this.m=r,this.g=s,this.type="FirstParty",this.user=Ri.FIRST_PARTY,this.p=new Map}I(){return this.g?this.g():(on(!("object"!=typeof this.h||null===this.h||!this.h.auth||!this.h.auth.getAuthHeaderValueForFirstParty)),this.h.auth.getAuthHeaderValueForFirstParty([]))}get headers(){this.p.set("X-Goog-AuthUser",this.l);const t=this.I();return t&&this.p.set("Authorization",t),this.m&&this.p.set("X-Goog-Iam-Authorization-Token",this.m),this.p}}class Wme{constructor(t,e,r,s){this.h=t,this.l=e,this.m=r,this.g=s}getToken(){return Promise.resolve(new Gme(this.h,this.l,this.m,this.g))}start(t,e){t.enqueueRetryable(()=>e(Ri.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class nK{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class qme{constructor(t){this.T=t,this.forceRefresh=!1,this.appCheck=null,this.A=null}start(t,e){const r=i=>{null!=i.error&&qe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.A;return this.A=i.token,qe("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?e(i.token):Promise.resolve()};this.o=i=>{t.enqueueRetryable(()=>r(i))};const s=i=>{qe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.appCheck.addTokenListener(this.o)};this.T.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.T.getImmediate({optional:!0});i?s(i):qe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then(e=>e?(on("string"==typeof e.token),this.A=e.token,new nK(e.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function jme(n){const t=typeof self<"u"&&(self.crypto||self.msCrypto),e=new Uint8Array(n);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(e);else for(let r=0;r<n;r++)e[r]=Math.floor(256*Math.random());return e}class rK{static R(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length;let r="";for(;r.length<20;){const s=jme(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<e&&(r+=t.charAt(s[i]%t.length))}return r}}function yn(n,t){return n<t?-1:n>t?1:0}function Rf(n,t,e){return n.length===t.length&&n.every((r,s)=>e(r,t[s]))}class ts{constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new Ue(Ae.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new Ue(Ae.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Ue(Ae.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Ue(Ae.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}static now(){return ts.fromMillis(Date.now())}static fromDate(t){return ts.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3),r=Math.floor(1e6*(t-1e3*e));return new ts(e,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(t){return this.seconds===t.seconds?yn(this.nanoseconds,t.nanoseconds):yn(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class an{constructor(t){this.timestamp=t}static fromTimestamp(t){return new an(t)}static min(){return new an(new ts(0,0))}static max(){return new an(new ts(253402300799,999999999))}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class Cg{constructor(t,e,r){void 0===e?e=0:e>t.length&&wt(),void 0===r?r=t.length-e:r>t.length-e&&wt(),this.segments=t,this.offset=e,this.len=r}get length(){return this.len}isEqual(t){return 0===Cg.comparator(this,t)}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof Cg?t.forEach(r=>{e.push(r)}):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return this.construct(this.segments,this.offset+(t=void 0===t?1:t),this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return 0===this.length}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,r=this.limit();e<r;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){const r=Math.min(t.length,e.length);for(let s=0;s<r;s++){const i=t.get(s),o=e.get(s);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0}}class g1 extends Cg{construct(t,e,r){return new g1(t,e,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...t){const e=[];for(const r of t){if(r.indexOf("//")>=0)throw new Ue(Ae.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);e.push(...r.split("/").filter(s=>s.length>0))}return new g1(e)}static emptyPath(){return new g1([])}}const Zme=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class bs extends Cg{construct(t,e,r){return new bs(t,e,r)}static isValidIdentifier(t){return Zme.test(t)}canonicalString(){return this.toArray().map(t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),bs.isValidIdentifier(t)||(t="`"+t+"`"),t)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new bs(["__name__"])}static fromServerFormat(t){const e=[];let r="",s=0;const i=()=>{if(0===r.length)throw new Ue(Ae.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(r),r=""};let o=!1;for(;s<t.length;){const c=t[s];if("\\"===c){if(s+1===t.length)throw new Ue(Ae.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const u=t[s+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Ue(Ae.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=u,s+=2}else"`"===c?(o=!o,s++):"."!==c||o?(r+=c,s++):(i(),s++)}if(i(),o)throw new Ue(Ae.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new bs(e)}static emptyPath(){return new bs([])}}class at{constructor(t){this.path=t}static fromPath(t){return new at(g1.fromString(t))}static fromName(t){return new at(g1.fromString(t).popFirst(5))}static empty(){return new at(g1.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return null!==t&&0===g1.comparator(this.path,t.path)}toString(){return this.path.toString()}static comparator(t,e){return g1.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new at(new g1(t.slice()))}}function oK(n){return new Ua(n.readTime,n.key,-1)}class Ua{constructor(t,e,r){this.readTime=t,this.documentKey=e,this.largestBatchId=r}static min(){return new Ua(an.min(),at.empty(),-1)}static max(){return new Ua(an.max(),at.empty(),-1)}}function KI(n,t){let e=n.readTime.compareTo(t.readTime);return 0!==e?e:(e=at.comparator(n.documentKey,t.documentKey),0!==e?e:yn(n.largestBatchId,t.largestBatchId))}const aK="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";function z0(n){return XI.apply(this,arguments)}function XI(){return XI=I(function*(n){if(n.code!==Ae.FAILED_PRECONDITION||n.message!==aK)throw n;qe("LocalStore","Unexpectedly lost primary lease")}),XI.apply(this,arguments)}class Se{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)},e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)})}catch(t){return this.next(void 0,t)}next(t,e){return this.callbackAttached&&wt(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(e,this.error):this.wrapSuccess(t,this.result):new Se((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(t,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(e,i).next(r,s)}})}toPromise(){return new Promise((t,e)=>{this.next(t,e)})}wrapUserFunction(t){try{const e=t();return e instanceof Se?e:Se.resolve(e)}catch(e){return Se.reject(e)}}wrapSuccess(t,e){return t?this.wrapUserFunction(()=>t(e)):Se.resolve(e)}wrapFailure(t,e){return t?this.wrapUserFunction(()=>t(e)):Se.reject(e)}static resolve(t){return new Se((e,r)=>{e(t)})}static reject(t){return new Se((e,r)=>{r(t)})}static waitFor(t){return new Se((e,r)=>{let s=0,i=0,o=!1;t.forEach(c=>{++s,c.next(()=>{++i,o&&i===s&&e()},u=>r(u))}),o=!0,i===s&&e()})}static or(t){let e=Se.resolve(!1);for(const r of t)e=e.next(s=>s?Se.resolve(s):r());return e}static forEach(t,e){const r=[];return t.forEach((s,i)=>{r.push(e.call(this,s,i))}),this.waitFor(r)}static mapArray(t,e){return new Se((r,s)=>{const i=t.length,o=new Array(i);let c=0;for(let u=0;u<i;u++){const d=u;e(t[d]).next(g=>{o[d]=g,++c,c===i&&r(o)},g=>s(g))}})}static doWhile(t,e){return new Se((r,s)=>{const i=()=>{!0===t()?e().next(()=>{i()},s):r()};i()})}}function V0(n){return"IndexedDbTransactionError"===n.name}class ca{constructor(t,e){this.previousValue=t,e&&(e.sequenceNumberHandler=r=>this.ut(r),this.ct=r=>e.writeSequenceNumber(r))}ut(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.ct&&this.ct(t),t}}function lK(n){let t=0;for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&t++;return t}function Zu(n,t){for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&t(e,n[e])}function uK(n){for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t))return!1;return!0}ca.at=-1;class ps{constructor(t,e){this.comparator=t,this.root=e||E2.EMPTY}insert(t,e){return new ps(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,E2.BLACK,null,null))}remove(t){return new ps(this.comparator,this.root.remove(t,this.comparator).copy(null,null,E2.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){const r=this.comparator(t,e.key);if(0===r)return e.value;r<0?e=e.left:r>0&&(e=e.right)}return null}indexOf(t){let e=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(t,r.key);if(0===s)return e+r.left.size;s<0?r=r.left:(e+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal((e,r)=>(t(e,r),!1))}toString(){const t=[];return this.inorderTraversal((e,r)=>(t.push(`${e}:${r}`),!1)),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new mM(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new mM(this.root,t,this.comparator,!1)}getReverseIterator(){return new mM(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new mM(this.root,t,this.comparator,!0)}}class mM{constructor(t,e,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!t.isEmpty();)if(i=e?r(t.key,e):1,e&&s&&(i*=-1),i<0)t=this.isReverse?t.left:t.right;else{if(0===i){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class E2{constructor(t,e,r,s,i){this.key=t,this.value=e,this.color=r??E2.RED,this.left=s??E2.EMPTY,this.right=i??E2.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,r,s,i){return new E2(t??this.key,e??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,r){let s=this;const i=r(t,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(t,e,r),null):0===i?s.copy(null,e,null,null,null):s.copy(null,null,null,null,s.right.insert(t,e,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return E2.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let r,s=this;if(e(t,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(t,e),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),0===e(t,s.key)){if(s.right.isEmpty())return E2.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(t,e))}return s.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,E2.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,E2.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw wt();const t=this.left.check();if(t!==this.right.check())throw wt();return t+(this.isRed()?0:1)}}E2.EMPTY=null,E2.RED=!0,E2.BLACK=!1,E2.EMPTY=new class{constructor(){this.size=0}get key(){throw wt()}get value(){throw wt()}get color(){throw wt()}get left(){throw wt()}get right(){throw wt()}copy(n,t,e,r,s){return this}insert(n,t,e){return new E2(n,t)}remove(n,t){return this}isEmpty(){return!0}inorderTraversal(n){return!1}reverseTraversal(n){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class er{constructor(t){this.comparator=t,this.data=new ps(this.comparator)}has(t){return null!==this.data.get(t)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal((e,r)=>(t(e),!1))}forEachInRange(t,e){const r=this.data.getIteratorFrom(t[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,t[1])>=0)return;e(s.key)}}forEachWhile(t,e){let r;for(r=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();r.hasNext();)if(!t(r.getNext().key))return}firstAfterOrEqual(t){const e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new fK(this.data.getIterator())}getIteratorFrom(t){return new fK(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach(r=>{e=e.add(r)}),e}isEqual(t){if(!(t instanceof er)||this.size!==t.size)return!1;const e=this.data.getIterator(),r=t.data.getIterator();for(;e.hasNext();){const s=e.getNext().key,i=r.getNext().key;if(0!==this.comparator(s,i))return!1}return!0}toArray(){const t=[];return this.forEach(e=>{t.push(e)}),t}toString(){const t=[];return this.forEach(e=>t.push(e)),"SortedSet("+t.toString()+")"}copy(t){const e=new er(this.comparator);return e.data=t,e}}class fK{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Ga{constructor(t){this.fields=t,t.sort(bs.comparator)}static empty(){return new Ga([])}unionWith(t){let e=new er(bs.comparator);for(const r of this.fields)e=e.add(r);for(const r of t)e=e.add(r);return new Ga(e.toArray())}covers(t){for(const e of this.fields)if(e.isPrefixOf(t))return!0;return!1}isEqual(t){return Rf(this.fields,t.fields,(e,r)=>e.isEqual(r))}}class gi{constructor(t){this.binaryString=t}static fromBase64String(t){const e=atob(t);return new gi(e)}static fromUint8Array(t){const e=function(r){let s="";for(let i=0;i<r.length;++i)s+=String.fromCharCode(r[i]);return s}(t);return new gi(e)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){return function(t){const e=new Uint8Array(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return yn(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}gi.EMPTY_BYTE_STRING=new gi("");const n_e=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function H0(n){if(on(!!n),"string"==typeof n){let t=0;const e=n_e.exec(n);if(on(!!e),e[1]){let s=e[1];s=(s+"000000000").substr(0,9),t=Number(s)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:gs(n.seconds),nanos:gs(n.nanos)}}function gs(n){return"number"==typeof n?n:"string"==typeof n?Number(n):0}function Yu(n){return"string"==typeof n?gi.fromBase64String(n):gi.fromUint8Array(n)}function JI(n){var t,e;return"server_timestamp"===(null===(e=((null===(t=n?.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===e?void 0:e.stringValue)}function dK(n){const t=n.mapValue.fields.__previous_value__;return JI(t)?dK(t):t}function Mg(n){const t=H0(n.mapValue.fields.__local_write_time__.timestampValue);return new ts(t.seconds,t.nanos)}class r_e{constructor(t,e,r,s,i,o,c,u){this.databaseId=t,this.appId=e,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=c,this.useFetchStreams=u}}class Ku{constructor(t,e){this.projectId=t,this.database=e||"(default)"}static empty(){return new Ku("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(t){return t instanceof Ku&&t.projectId===this.projectId&&t.database===this.database}}function Sg(n){return null==n}function Pg(n){return 0===n&&1/n==-1/0}const F0_mapValue={fields:{__type__:{stringValue:"__max__"}}};function Xu(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?JI(n)?4:_K(n)?9007199254740991:10:wt()}function A4(n,t){if(n===t)return!0;const e=Xu(n);if(e!==Xu(t))return!1;switch(e){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===t.booleanValue;case 4:return Mg(n).isEqual(Mg(t));case 3:return function(r,s){if("string"==typeof r.timestampValue&&"string"==typeof s.timestampValue&&r.timestampValue.length===s.timestampValue.length)return r.timestampValue===s.timestampValue;const i=H0(r.timestampValue),o=H0(s.timestampValue);return i.seconds===o.seconds&&i.nanos===o.nanos}(n,t);case 5:return n.stringValue===t.stringValue;case 6:return s=t,Yu(n.bytesValue).isEqual(Yu(s.bytesValue));case 7:return n.referenceValue===t.referenceValue;case 8:return function(r,s){return gs(r.geoPointValue.latitude)===gs(s.geoPointValue.latitude)&&gs(r.geoPointValue.longitude)===gs(s.geoPointValue.longitude)}(n,t);case 2:return function(r,s){if("integerValue"in r&&"integerValue"in s)return gs(r.integerValue)===gs(s.integerValue);if("doubleValue"in r&&"doubleValue"in s){const i=gs(r.doubleValue),o=gs(s.doubleValue);return i===o?Pg(i)===Pg(o):isNaN(i)&&isNaN(o)}return!1}(n,t);case 9:return Rf(n.arrayValue.values||[],t.arrayValue.values||[],A4);case 10:return function(r,s){const i=r.mapValue.fields||{},o=s.mapValue.fields||{};if(lK(i)!==lK(o))return!1;for(const c in i)if(i.hasOwnProperty(c)&&(void 0===o[c]||!A4(i[c],o[c])))return!1;return!0}(n,t);default:return wt()}var s}function Tg(n,t){return void 0!==(n.values||[]).find(e=>A4(e,t))}function B0(n,t){if(n===t)return 0;const e=Xu(n),r=Xu(t);if(e!==r)return yn(e,r);switch(e){case 0:case 9007199254740991:return 0;case 1:return yn(n.booleanValue,t.booleanValue);case 2:return function(s,i){const o=gs(s.integerValue||s.doubleValue),c=gs(i.integerValue||i.doubleValue);return o<c?-1:o>c?1:o===c?0:isNaN(o)?isNaN(c)?0:-1:1}(n,t);case 3:return pK(n.timestampValue,t.timestampValue);case 4:return pK(Mg(n),Mg(t));case 5:return yn(n.stringValue,t.stringValue);case 6:return function(s,i){const o=Yu(s),c=Yu(i);return o.compareTo(c)}(n.bytesValue,t.bytesValue);case 7:return function(s,i){const o=s.split("/"),c=i.split("/");for(let u=0;u<o.length&&u<c.length;u++){const d=yn(o[u],c[u]);if(0!==d)return d}return yn(o.length,c.length)}(n.referenceValue,t.referenceValue);case 8:return function(s,i){const o=yn(gs(s.latitude),gs(i.latitude));return 0!==o?o:yn(gs(s.longitude),gs(i.longitude))}(n.geoPointValue,t.geoPointValue);case 9:return function(s,i){const o=s.values||[],c=i.values||[];for(let u=0;u<o.length&&u<c.length;++u){const d=B0(o[u],c[u]);if(d)return d}return yn(o.length,c.length)}(n.arrayValue,t.arrayValue);case 10:return function(s,i){if(s===F0_mapValue&&i===F0_mapValue)return 0;if(s===F0_mapValue)return 1;if(i===F0_mapValue)return-1;const o=s.fields||{},c=Object.keys(o),u=i.fields||{},d=Object.keys(u);c.sort(),d.sort();for(let g=0;g<c.length&&g<d.length;++g){const m=yn(c[g],d[g]);if(0!==m)return m;const y=B0(o[c[g]],u[d[g]]);if(0!==y)return y}return yn(c.length,d.length)}(n.mapValue,t.mapValue);default:throw wt()}}function pK(n,t){if("string"==typeof n&&"string"==typeof t&&n.length===t.length)return yn(n,t);const e=H0(n),r=H0(t),s=yn(e.seconds,r.seconds);return 0!==s?s:yn(e.nanos,r.nanos)}function zf(n){return ex(n)}function ex(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(r){const s=H0(r);return`time(${s.seconds},${s.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?Yu(n.bytesValue).toBase64():"referenceValue"in n?at.fromName(n.referenceValue).toString():"geoPointValue"in n?`geo(${(t=n.geoPointValue).latitude},${t.longitude})`:"arrayValue"in n?function(r){let s="[",i=!0;for(const o of r.values||[])i?i=!1:s+=",",s+=ex(o);return s+"]"}(n.arrayValue):"mapValue"in n?function(r){const s=Object.keys(r.fields||{}).sort();let i="{",o=!0;for(const c of s)o?o=!1:i+=",",i+=`${c}:${ex(r.fields[c])}`;return i+"}"}(n.mapValue):wt();var t}function Qu(n,t){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${t.path.canonicalString()}`}}function tx(n){return!!n&&"integerValue"in n}function wg(n){return!!n&&"arrayValue"in n}function gK(n){return!!n&&"nullValue"in n}function mK(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function vM(n){return!!n&&"mapValue"in n}function bg(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&"object"==typeof n.timestampValue)return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const t={mapValue:{fields:{}}};return Zu(n.mapValue.fields,(e,r)=>t.mapValue.fields[e]=bg(r)),t}if(n.arrayValue){const t={arrayValue:{values:[]}};for(let e=0;e<(n.arrayValue.values||[]).length;++e)t.arrayValue.values[e]=bg(n.arrayValue.values[e]);return t}return Object.assign({},n)}function _K(n){return"__max__"===(((n.mapValue||{}).fields||{}).__type__||{}).stringValue}class M2{constructor(t){this.value=t}static empty(){return new M2({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let e=this.value;for(let r=0;r<t.length-1;++r)if(e=(e.mapValue.fields||{})[t.get(r)],!vM(e))return null;return e=(e.mapValue.fields||{})[t.lastSegment()],e||null}}set(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=bg(e)}setAll(t){let e=bs.emptyPath(),r={},s=[];t.forEach((o,c)=>{if(!e.isImmediateParentOf(c)){const u=this.getFieldsMap(e);this.applyChanges(u,r,s),r={},s=[],e=c.popLast()}o?r[c.lastSegment()]=bg(o):s.push(c.lastSegment())});const i=this.getFieldsMap(e);this.applyChanges(i,r,s)}delete(t){const e=this.field(t.popLast());vM(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}isEqual(t){return A4(this.value,t.value)}getFieldsMap(t){let e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(let r=0;r<t.length;++r){let s=e.mapValue.fields[t.get(r)];vM(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},e.mapValue.fields[t.get(r)]=s),e=s}return e.mapValue.fields}applyChanges(t,e,r){Zu(e,(s,i)=>t[s]=i);for(const s of r)delete t[s]}clone(){return new M2(bg(this.value))}}function yK(n){const t=[];return Zu(n.fields,(e,r)=>{const s=new bs([e]);if(vM(r)){const i=yK(r.mapValue).fields;if(0===i.length)t.push(s);else for(const o of i)t.push(s.child(o))}else t.push(s)}),new Ga(t)}class pr{constructor(t,e,r,s,i,o){this.key=t,this.documentType=e,this.version=r,this.readTime=s,this.data=i,this.documentState=o}static newInvalidDocument(t){return new pr(t,0,an.min(),an.min(),M2.empty(),0)}static newFoundDocument(t,e,r){return new pr(t,1,e,an.min(),r,0)}static newNoDocument(t,e){return new pr(t,2,e,an.min(),M2.empty(),0)}static newUnknownDocument(t,e){return new pr(t,3,e,an.min(),M2.empty(),2)}convertToFoundDocument(t,e){return this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=M2.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=M2.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=an.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(t){return t instanceof pr&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new pr(this.key,this.documentType,this.version,this.readTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class o_e{constructor(t,e=null,r=[],s=[],i=null,o=null,c=null){this.path=t,this.collectionGroup=e,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=c,this.ht=null}}function EK(n,t=null,e=[],r=[],s=null,i=null,o=null){return new o_e(n,t,e,r,s,i,o)}function Ju(n){const t=ut(n);if(null===t.ht){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map(r=>{return(s=r).field.canonicalString()+s.op.toString()+zf(s.value);var s}).join(","),e+="|ob:",e+=t.orderBy.map(r=>{return(s=r).field.canonicalString()+s.dir;var s}).join(","),Sg(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(r=>zf(r)).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(r=>zf(r)).join(",")),t.ht=e}return t.ht}function Og(n,t){if(n.limit!==t.limit||n.orderBy.length!==t.orderBy.length)return!1;for(let s=0;s<n.orderBy.length;s++)if(!g_e(n.orderBy[s],t.orderBy[s]))return!1;if(n.filters.length!==t.filters.length)return!1;for(let s=0;s<n.filters.length;s++)if((e=n.filters[s]).op!==(r=t.filters[s]).op||!e.field.isEqual(r.field)||!A4(e.value,r.value))return!1;var e,r;return n.collectionGroup===t.collectionGroup&&!!n.path.isEqual(t.path)&&!!wK(n.startAt,t.startAt)&&wK(n.endAt,t.endAt)}function CM(n){return at.isDocumentKey(n.path)&&null===n.collectionGroup&&0===n.filters.length}class S2 extends class{}{constructor(t,e,r){super(),this.field=t,this.op=e,this.value=r}static create(t,e,r){return t.isKeyField()?"in"===e||"not-in"===e?this.lt(t,e,r):new c_e(t,e,r):"array-contains"===e?new f_e(t,r):"in"===e?new d_e(t,r):"not-in"===e?new h_e(t,r):"array-contains-any"===e?new p_e(t,r):new S2(t,e,r)}static lt(t,e,r){return"in"===e?new l_e(t,r):new u_e(t,r)}matches(t){const e=t.data.field(this.field);return"!="===this.op?null!==e&&this.ft(B0(e,this.value)):null!==e&&Xu(this.value)===Xu(e)&&this.ft(B0(e,this.value))}ft(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return wt()}}dt(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}class c_e extends S2{constructor(t,e,r){super(t,e,r),this.key=at.fromName(r.referenceValue)}matches(t){const e=at.comparator(t.key,this.key);return this.ft(e)}}class l_e extends S2{constructor(t,e){super(t,"in",e),this.keys=PK(0,e)}matches(t){return this.keys.some(e=>e.isEqual(t.key))}}class u_e extends S2{constructor(t,e){super(t,"not-in",e),this.keys=PK(0,e)}matches(t){return!this.keys.some(e=>e.isEqual(t.key))}}function PK(n,t){var e;return((null===(e=t.arrayValue)||void 0===e?void 0:e.values)||[]).map(r=>at.fromName(r.referenceValue))}class f_e extends S2{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.data.field(this.field);return wg(e)&&Tg(e.arrayValue,this.value)}}class d_e extends S2{constructor(t,e){super(t,"in",e)}matches(t){const e=t.data.field(this.field);return null!==e&&Tg(this.value.arrayValue,e)}}class h_e extends S2{constructor(t,e){super(t,"not-in",e)}matches(t){if(Tg(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.data.field(this.field);return null!==e&&!Tg(this.value.arrayValue,e)}}class p_e extends S2{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.data.field(this.field);return!(!wg(e)||!e.arrayValue.values)&&e.arrayValue.values.some(r=>Tg(this.value.arrayValue,r))}}class $0{constructor(t,e){this.position=t,this.inclusive=e}}class Vf{constructor(t,e="asc"){this.field=t,this.dir=e}}function g_e(n,t){return n.dir===t.dir&&n.field.isEqual(t.field)}function TK(n,t,e){let r=0;for(let s=0;s<n.position.length;s++){const i=t[s],o=n.position[s];if(r=i.field.isKeyField()?at.comparator(at.fromName(o.referenceValue),e.key):B0(o,e.data.field(i.field)),"desc"===i.dir&&(r*=-1),0!==r)break}return r}function wK(n,t){if(null===n)return null===t;if(null===t||n.inclusive!==t.inclusive||n.position.length!==t.position.length)return!1;for(let e=0;e<n.position.length;e++)if(!A4(n.position[e],t.position[e]))return!1;return!0}class ql{constructor(t,e=null,r=[],s=[],i=null,o="F",c=null,u=null){this.path=t,this.collectionGroup=e,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=c,this.endAt=u,this._t=null,this.wt=null}}function Hf(n){return new ql(n)}function OK(n){return 0===n.filters.length&&null===n.limit&&null==n.startAt&&null==n.endAt&&(0===n.explicitOrderBy.length||1===n.explicitOrderBy.length&&n.explicitOrderBy[0].field.isKeyField())}function nx(n){return n.explicitOrderBy.length>0?n.explicitOrderBy[0].field:null}function rx(n){for(const t of n.filters)if(t.dt())return t.field;return null}function sx(n){return null!==n.collectionGroup}function Ff(n){const t=ut(n);if(null===t._t){t._t=[];const e=rx(t),r=nx(t);if(null!==e&&null===r)e.isKeyField()||t._t.push(new Vf(e)),t._t.push(new Vf(bs.keyField(),"asc"));else{let s=!1;for(const i of t.explicitOrderBy)t._t.push(i),i.field.isKeyField()&&(s=!0);if(!s){const i=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";t._t.push(new Vf(bs.keyField(),i))}}}return t._t}function No(n){const t=ut(n);if(!t.wt)if("F"===t.limitType)t.wt=EK(t.path,t.collectionGroup,Ff(t),t.filters,t.limit,t.startAt,t.endAt);else{const e=[];for(const i of Ff(t))e.push(new Vf(i.field,"desc"===i.dir?"asc":"desc"));const r=t.endAt?new $0(t.endAt.position,t.endAt.inclusive):null,s=t.startAt?new $0(t.startAt.position,t.startAt.inclusive):null;t.wt=EK(t.path,t.collectionGroup,e,t.filters,t.limit,r,s)}return t.wt}function EM(n,t,e){return new ql(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),t,e,n.startAt,n.endAt)}function Ag(n,t){return Og(No(n),No(t))&&n.limitType===t.limitType}function AK(n){return`${Ju(No(n))}|lt:${n.limitType}`}function ix(n){return`Query(target=${function a_e(n){let t=n.path.canonicalString();return null!==n.collectionGroup&&(t+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(t+=`, filters: [${n.filters.map(e=>{return`${(r=e).field.canonicalString()} ${r.op} ${zf(r.value)}`;var r}).join(", ")}]`),Sg(n.limit)||(t+=", limit: "+n.limit),n.orderBy.length>0&&(t+=`, orderBy: [${n.orderBy.map(e=>{return`${(r=e).field.canonicalString()} (${r.dir})`;var r}).join(", ")}]`),n.startAt&&(t+=", startAt: ",t+=n.startAt.inclusive?"b:":"a:",t+=n.startAt.position.map(e=>zf(e)).join(",")),n.endAt&&(t+=", endAt: ",t+=n.endAt.inclusive?"a:":"b:",t+=n.endAt.position.map(e=>zf(e)).join(",")),`Target(${t})`}(No(n))}; limitType=${n.limitType})`}function ox(n,t){return t.isFoundDocument()&&function(e,r){const s=r.key.path;return null!==e.collectionGroup?r.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(s):at.isDocumentKey(e.path)?e.path.isEqual(s):e.path.isImmediateParentOf(s)}(n,t)&&function(e,r){for(const s of e.explicitOrderBy)if(!s.field.isKeyField()&&null===r.data.field(s.field))return!1;return!0}(n,t)&&function(e,r){for(const s of e.filters)if(!s.matches(r))return!1;return!0}(n,t)&&(r=t,!((e=n).startAt&&!function(s,i,o){const c=TK(s,i,o);return s.inclusive?c<=0:c<0}(e.startAt,Ff(e),r)||e.endAt&&!function(s,i,o){const c=TK(s,i,o);return s.inclusive?c>=0:c>0}(e.endAt,Ff(e),r)));var e,r}function IK(n){return(t,e)=>{let r=!1;for(const s of Ff(n)){const i=m_e(s,t,e);if(0!==i)return i;r=r||s.field.isKeyField()}return 0}}function m_e(n,t,e){const r=n.field.isKeyField()?at.comparator(t.key,e.key):function(s,i,o){const c=i.data.field(s),u=o.data.field(s);return null!==c&&null!==u?B0(c,u):wt()}(n.field,t,e);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return wt()}}function xK(n,t){if(n.gt){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Pg(t)?"-0":t}}function kK(n){return{integerValue:""+n}}function LK(n,t){return function hK(n){return"number"==typeof n&&Number.isInteger(n)&&!Pg(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}(t)?kK(t):xK(n,t)}class MM{constructor(){this._=void 0}}function __e(n,t,e){return n instanceof Bf?function(r,s){const i={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return s&&(i.fields.__previous_value__=s),{mapValue:i}}(e,t):n instanceof e5?DK(n,t):n instanceof t5?zK(n,t):function(r,s){const i=RK(r,s),o=VK(i)+VK(r.yt);return tx(i)&&tx(r.yt)?kK(o):xK(r.It,o)}(n,t)}function v_e(n,t,e){return n instanceof e5?DK(n,t):n instanceof t5?zK(n,t):e}function RK(n,t){return n instanceof $f?tx(e=t)||(r=e)&&"doubleValue"in r?t:{integerValue:0}:null;var r,e}class Bf extends MM{}class e5 extends MM{constructor(t){super(),this.elements=t}}function DK(n,t){const e=HK(t);for(const r of n.elements)e.some(s=>A4(s,r))||e.push(r);return{arrayValue:{values:e}}}class t5 extends MM{constructor(t){super(),this.elements=t}}function zK(n,t){let e=HK(t);for(const r of n.elements)e=e.filter(s=>!A4(s,r));return{arrayValue:{values:e}}}class $f extends MM{constructor(t,e){super(),this.It=t,this.yt=e}}function VK(n){return gs(n.integerValue||n.doubleValue)}function HK(n){return wg(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class Ng{constructor(t,e){this.field=t,this.transform=e}}class y_e{constructor(t,e){this.version=t,this.transformResults=e}}class Hr{constructor(t,e){this.updateTime=t,this.exists=e}static none(){return new Hr}static exists(t){return new Hr(void 0,t)}static updateTime(t){return new Hr(t)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function SM(n,t){return void 0!==n.updateTime?t.isFoundDocument()&&t.version.isEqual(n.updateTime):void 0===n.exists||n.exists===t.isFoundDocument()}class PM{}function FK(n,t){if(!n.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return n.isNoDocument()?new Gf(n.key,Hr.none()):new Uf(n.key,n.data,Hr.none());{const e=n.data,r=M2.empty();let s=new er(bs.comparator);for(let i of t.fields)if(!s.has(i)){let o=e.field(i);null===o&&i.length>1&&(i=i.popLast(),o=e.field(i)),null===o?r.delete(i):r.set(i,o),s=s.add(i)}return new jl(n.key,r,new Ga(s.toArray()),Hr.none())}}function E_e(n,t,e){n instanceof Uf?function(r,s,i){const o=r.value.clone(),c=UK(r.fieldTransforms,s,i.transformResults);o.setAll(c),s.convertToFoundDocument(i.version,o).setHasCommittedMutations()}(n,t,e):n instanceof jl?function(r,s,i){if(!SM(r.precondition,s))return void s.convertToUnknownDocument(i.version);const o=UK(r.fieldTransforms,s,i.transformResults),c=s.data;c.setAll($K(r)),c.setAll(o),s.convertToFoundDocument(i.version,c).setHasCommittedMutations()}(n,t,e):t.convertToNoDocument(e.version).setHasCommittedMutations()}function Ig(n,t,e,r){return n instanceof Uf?function(s,i,o,c){if(!SM(s.precondition,i))return o;const u=s.value.clone(),d=GK(s.fieldTransforms,c,i);return u.setAll(d),i.convertToFoundDocument(i.version,u).setHasLocalMutations(),null}(n,t,e,r):n instanceof jl?function(s,i,o,c){if(!SM(s.precondition,i))return o;const u=GK(s.fieldTransforms,c,i),d=i.data;return d.setAll($K(s)),d.setAll(u),i.convertToFoundDocument(i.version,d).setHasLocalMutations(),null===o?null:o.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(g=>g.field))}(n,t,e,r):(o=e,SM(n.precondition,i=t)?(i.convertToNoDocument(i.version).setHasLocalMutations(),null):o);var i,o}function M_e(n,t){let e=null;for(const r of n.fieldTransforms){const s=t.data.field(r.field),i=RK(r.transform,s||null);null!=i&&(null===e&&(e=M2.empty()),e.set(r.field,i))}return e||null}function BK(n,t){return n.type===t.type&&!!n.key.isEqual(t.key)&&!!n.precondition.isEqual(t.precondition)&&(r=t.fieldTransforms,!!(void 0===(e=n.fieldTransforms)&&void 0===r||e&&r&&Rf(e,r,(s,i)=>function C_e(n,t){return n.field.isEqual(t.field)&&(r=t.transform,(e=n.transform)instanceof e5&&r instanceof e5||e instanceof t5&&r instanceof t5?Rf(e.elements,r.elements,A4):e instanceof $f&&r instanceof $f?A4(e.yt,r.yt):e instanceof Bf&&r instanceof Bf);var e,r}(s,i))))&&(0===n.type?n.value.isEqual(t.value):1!==n.type||n.data.isEqual(t.data)&&n.fieldMask.isEqual(t.fieldMask));var e,r}class Uf extends PM{constructor(t,e,r,s=[]){super(),this.key=t,this.value=e,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class jl extends PM{constructor(t,e,r,s,i=[]){super(),this.key=t,this.data=e,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function $K(n){const t=new Map;return n.fieldMask.fields.forEach(e=>{if(!e.isEmpty()){const r=n.data.field(e);t.set(e,r)}}),t}function UK(n,t,e){const r=new Map;on(n.length===e.length);for(let s=0;s<e.length;s++){const i=n[s],o=i.transform,c=t.data.field(i.field);r.set(i.field,v_e(o,c,e[s]))}return r}function GK(n,t,e){const r=new Map;for(const s of n){const i=s.transform,o=e.data.field(s.field);r.set(s.field,__e(i,o,t))}return r}class Gf extends PM{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class ax extends PM{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class S_e{constructor(t){this.count=t}}var qs,m1;function WK(n){switch(n){default:return wt();case Ae.CANCELLED:case Ae.UNKNOWN:case Ae.DEADLINE_EXCEEDED:case Ae.RESOURCE_EXHAUSTED:case Ae.INTERNAL:case Ae.UNAVAILABLE:case Ae.UNAUTHENTICATED:return!1;case Ae.INVALID_ARGUMENT:case Ae.NOT_FOUND:case Ae.ALREADY_EXISTS:case Ae.PERMISSION_DENIED:case Ae.FAILED_PRECONDITION:case Ae.ABORTED:case Ae.OUT_OF_RANGE:case Ae.UNIMPLEMENTED:case Ae.DATA_LOSS:return!0}}function qK(n){if(void 0===n)return ws("GRPC error has no .code"),Ae.UNKNOWN;switch(n){case qs.OK:return Ae.OK;case qs.CANCELLED:return Ae.CANCELLED;case qs.UNKNOWN:return Ae.UNKNOWN;case qs.DEADLINE_EXCEEDED:return Ae.DEADLINE_EXCEEDED;case qs.RESOURCE_EXHAUSTED:return Ae.RESOURCE_EXHAUSTED;case qs.INTERNAL:return Ae.INTERNAL;case qs.UNAVAILABLE:return Ae.UNAVAILABLE;case qs.UNAUTHENTICATED:return Ae.UNAUTHENTICATED;case qs.INVALID_ARGUMENT:return Ae.INVALID_ARGUMENT;case qs.NOT_FOUND:return Ae.NOT_FOUND;case qs.ALREADY_EXISTS:return Ae.ALREADY_EXISTS;case qs.PERMISSION_DENIED:return Ae.PERMISSION_DENIED;case qs.FAILED_PRECONDITION:return Ae.FAILED_PRECONDITION;case qs.ABORTED:return Ae.ABORTED;case qs.OUT_OF_RANGE:return Ae.OUT_OF_RANGE;case qs.UNIMPLEMENTED:return Ae.UNIMPLEMENTED;case qs.DATA_LOSS:return Ae.DATA_LOSS;default:return wt()}}(m1=qs||(qs={}))[m1.OK=0]="OK",m1[m1.CANCELLED=1]="CANCELLED",m1[m1.UNKNOWN=2]="UNKNOWN",m1[m1.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",m1[m1.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",m1[m1.NOT_FOUND=5]="NOT_FOUND",m1[m1.ALREADY_EXISTS=6]="ALREADY_EXISTS",m1[m1.PERMISSION_DENIED=7]="PERMISSION_DENIED",m1[m1.UNAUTHENTICATED=16]="UNAUTHENTICATED",m1[m1.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",m1[m1.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",m1[m1.ABORTED=10]="ABORTED",m1[m1.OUT_OF_RANGE=11]="OUT_OF_RANGE",m1[m1.UNIMPLEMENTED=12]="UNIMPLEMENTED",m1[m1.INTERNAL=13]="INTERNAL",m1[m1.UNAVAILABLE=14]="UNAVAILABLE",m1[m1.DATA_LOSS=15]="DATA_LOSS";class U0{constructor(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={},this.innerSize=0}get(t){const e=this.mapKeyFn(t),r=this.inner[e];if(void 0!==r)for(const[s,i]of r)if(this.equalsFn(s,t))return i}has(t){return void 0!==this.get(t)}set(t,e){const r=this.mapKeyFn(t),s=this.inner[r];if(void 0===s)return this.inner[r]=[[t,e]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],t))return void(s[i]=[t,e]);s.push([t,e]),this.innerSize++}delete(t){const e=this.mapKeyFn(t),r=this.inner[e];if(void 0===r)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],t))return 1===r.length?delete this.inner[e]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(t){Zu(this.inner,(e,r)=>{for(const[s,i]of r)t(s,i)})}isEmpty(){return uK(this.inner)}size(){return this.innerSize}}const P_e=new ps(at.comparator);function la(){return P_e}const jK=new ps(at.comparator);function xg(...n){let t=jK;for(const e of n)t=t.insert(e.key,e);return t}function ZK(n){let t=jK;return n.forEach((e,r)=>t=t.insert(e,r.overlayedDocument)),t}function N4(){return kg()}function YK(){return kg()}function kg(){return new U0(n=>n.toString(),(n,t)=>n.isEqual(t))}const T_e=new ps(at.comparator),w_e=new er(at.comparator);function In(...n){let t=w_e;for(const e of n)t=t.add(e);return t}const b_e=new er(yn);function TM(){return b_e}class Lg{constructor(t,e,r,s,i){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(t,e,r){const s=new Map;return s.set(t,Rg.createSynthesizedTargetChangeForCurrentChange(t,e,r)),new Lg(an.min(),s,TM(),la(),In())}}class Rg{constructor(t,e,r,s,i){this.resumeToken=t,this.current=e,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(t,e,r){return new Rg(r,e,In(),In(),In())}}class wM{constructor(t,e,r,s){this.Tt=t,this.removedTargetIds=e,this.key=r,this.Et=s}}class KK{constructor(t,e){this.targetId=t,this.At=e}}class XK{constructor(t,e,r=gi.EMPTY_BYTE_STRING,s=null){this.state=t,this.targetIds=e,this.resumeToken=r,this.cause=s}}class QK{constructor(){this.Rt=0,this.bt=eX(),this.Pt=gi.EMPTY_BYTE_STRING,this.vt=!1,this.Vt=!0}get current(){return this.vt}get resumeToken(){return this.Pt}get St(){return 0!==this.Rt}get Dt(){return this.Vt}Ct(t){t.approximateByteSize()>0&&(this.Vt=!0,this.Pt=t)}xt(){let t=In(),e=In(),r=In();return this.bt.forEach((s,i)=>{switch(i){case 0:t=t.add(s);break;case 2:e=e.add(s);break;case 1:r=r.add(s);break;default:wt()}}),new Rg(this.Pt,this.vt,t,e,r)}Nt(){this.Vt=!1,this.bt=eX()}kt(t,e){this.Vt=!0,this.bt=this.bt.insert(t,e)}Ot(t){this.Vt=!0,this.bt=this.bt.remove(t)}Mt(){this.Rt+=1}Ft(){this.Rt-=1}$t(){this.Vt=!0,this.vt=!0}}class O_e{constructor(t){this.Bt=t,this.Lt=new Map,this.Ut=la(),this.qt=JK(),this.Kt=new er(yn)}Gt(t){for(const e of t.Tt)t.Et&&t.Et.isFoundDocument()?this.Qt(e,t.Et):this.jt(e,t.key,t.Et);for(const e of t.removedTargetIds)this.jt(e,t.key,t.Et)}Wt(t){this.forEachTarget(t,e=>{const r=this.zt(e);switch(t.state){case 0:this.Ht(e)&&r.Ct(t.resumeToken);break;case 1:r.Ft(),r.St||r.Nt(),r.Ct(t.resumeToken);break;case 2:r.Ft(),r.St||this.removeTarget(e);break;case 3:this.Ht(e)&&(r.$t(),r.Ct(t.resumeToken));break;case 4:this.Ht(e)&&(this.Jt(e),r.Ct(t.resumeToken));break;default:wt()}})}forEachTarget(t,e){t.targetIds.length>0?t.targetIds.forEach(e):this.Lt.forEach((r,s)=>{this.Ht(s)&&e(s)})}Yt(t){const e=t.targetId,r=t.At.count,s=this.Xt(e);if(s){const i=s.target;if(CM(i))if(0===r){const o=new at(i.path);this.jt(e,o,pr.newNoDocument(o,an.min()))}else on(1===r);else this.Zt(e)!==r&&(this.Jt(e),this.Kt=this.Kt.add(e))}}te(t){const e=new Map;this.Lt.forEach((i,o)=>{const c=this.Xt(o);if(c){if(i.current&&CM(c.target)){const u=new at(c.target.path);null!==this.Ut.get(u)||this.ee(o,u)||this.jt(o,u,pr.newNoDocument(u,t))}i.Dt&&(e.set(o,i.xt()),i.Nt())}});let r=In();this.qt.forEach((i,o)=>{let c=!0;o.forEachWhile(u=>{const d=this.Xt(u);return!d||2===d.purpose||(c=!1,!1)}),c&&(r=r.add(i))}),this.Ut.forEach((i,o)=>o.setReadTime(t));const s=new Lg(t,e,this.Kt,this.Ut,r);return this.Ut=la(),this.qt=JK(),this.Kt=new er(yn),s}Qt(t,e){if(!this.Ht(t))return;const r=this.ee(t,e.key)?2:0;this.zt(t).kt(e.key,r),this.Ut=this.Ut.insert(e.key,e),this.qt=this.qt.insert(e.key,this.ne(e.key).add(t))}jt(t,e,r){if(!this.Ht(t))return;const s=this.zt(t);this.ee(t,e)?s.kt(e,1):s.Ot(e),this.qt=this.qt.insert(e,this.ne(e).delete(t)),r&&(this.Ut=this.Ut.insert(e,r))}removeTarget(t){this.Lt.delete(t)}Zt(t){const e=this.zt(t).xt();return this.Bt.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size}Mt(t){this.zt(t).Mt()}zt(t){let e=this.Lt.get(t);return e||(e=new QK,this.Lt.set(t,e)),e}ne(t){let e=this.qt.get(t);return e||(e=new er(yn),this.qt=this.qt.insert(t,e)),e}Ht(t){const e=null!==this.Xt(t);return e||qe("WatchChangeAggregator","Detected inactive target",t),e}Xt(t){const e=this.Lt.get(t);return e&&e.St?null:this.Bt.se(t)}Jt(t){this.Lt.set(t,new QK),this.Bt.getRemoteKeysForTarget(t).forEach(e=>{this.jt(t,e,null)})}ee(t,e){return this.Bt.getRemoteKeysForTarget(t).has(e)}}function JK(){return new ps(at.comparator)}function eX(){return new ps(at.comparator)}const A_e={asc:"ASCENDING",desc:"DESCENDING"},N_e={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"};class I_e{constructor(t,e){this.databaseId=t,this.gt=e}}function Dg(n,t){return n.gt?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function tX(n,t){return n.gt?t.toBase64():t.toUint8Array()}function x_e(n,t){return Dg(n,t.toTimestamp())}function Di(n){return on(!!n),an.fromTimestamp(function(t){const e=H0(t);return new ts(e.seconds,e.nanos)}(n))}function cx(n,t){return(e=n,new g1(["projects",e.projectId,"databases",e.database])).child("documents").child(t).canonicalString();var e}function nX(n){const t=g1.fromString(n);return on(uX(t)),t}function zg(n,t){return cx(n.databaseId,t.path)}function I4(n,t){const e=nX(t);if(e.get(1)!==n.databaseId.projectId)throw new Ue(Ae.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+e.get(1)+" vs "+n.databaseId.projectId);if(e.get(3)!==n.databaseId.database)throw new Ue(Ae.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+e.get(3)+" vs "+n.databaseId.database);return new at(sX(e))}function lx(n,t){return cx(n.databaseId,t)}function Vg(n){return new g1(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function sX(n){return on(n.length>4&&"documents"===n.get(4)),n.popFirst(5)}function iX(n,t,e){return{name:zg(n,t),fields:e.value.mapValue.fields}}function aX(n,t){return{documents:[lx(n,t.path)]}}function fx(n,t){const e={structuredQuery:{}},r=t.path;null!==t.collectionGroup?(e.parent=lx(n,r),e.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(e.parent=lx(n,r.popLast()),e.structuredQuery.from=[{collectionId:r.lastSegment()}]);const s=function(u){if(0===u.length)return;const d=u.map(g=>function(m){if("=="===m.op){if(mK(m.value))return{unaryFilter:{field:Wf(m.field),op:"IS_NAN"}};if(gK(m.value))return{unaryFilter:{field:Wf(m.field),op:"IS_NULL"}}}else if("!="===m.op){if(mK(m.value))return{unaryFilter:{field:Wf(m.field),op:"IS_NOT_NAN"}};if(gK(m.value))return{unaryFilter:{field:Wf(m.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Wf(m.field),op:V_e(m.op),value:m.value}}}(g));return 1===d.length?d[0]:{compositeFilter:{op:"AND",filters:d}}}(t.filters);s&&(e.structuredQuery.where=s);const i=function(u){if(0!==u.length)return u.map(d=>{return{field:Wf((g=d).field),direction:z_e(g.dir)};var g})}(t.orderBy);i&&(e.structuredQuery.orderBy=i);const o=(d=t.limit,n.gt||Sg(d)?d:{value:d});var d,c,u;return null!==o&&(e.structuredQuery.limit=o),t.startAt&&(e.structuredQuery.startAt={before:(c=t.startAt).inclusive,values:c.position}),t.endAt&&(e.structuredQuery.endAt={before:!(u=t.endAt).inclusive,values:u.position}),e}function cX(n){let t=function rX(n){const t=nX(n);return 4===t.length?g1.emptyPath():sX(t)}(n.parent);const e=n.structuredQuery,r=e.from?e.from.length:0;let s=null;if(r>0){on(1===r);const g=e.from[0];g.allDescendants?s=g.collectionId:t=t.child(g.collectionId)}let i=[];e.where&&(i=lX(e.where));let o=[];e.orderBy&&(o=e.orderBy.map(g=>{return new Vf(qf((m=g).field),function(y){switch(y){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(m.direction));var m}));let c=null;e.limit&&(c=function(g){let m;return m="object"==typeof g?g.value:g,Sg(m)?null:m}(e.limit));let u=null;var g;e.startAt&&(u=new $0((g=e.startAt).values||[],!!g.before));let d=null;return e.endAt&&(d=function(g){return new $0(g.values||[],!g.before)}(e.endAt)),function bK(n,t,e,r,s,i,o,c){return new ql(n,t,e,r,s,i,o,c)}(t,s,o,i,c,"F",u,d)}function lX(n){return n?void 0!==n.unaryFilter?[F_e(n)]:void 0!==n.fieldFilter?[H_e(n)]:void 0!==n.compositeFilter?n.compositeFilter.filters.map(t=>lX(t)).reduce((t,e)=>t.concat(e)):wt():[]}function z_e(n){return A_e[n]}function V_e(n){return N_e[n]}function Wf(n){return{fieldPath:n.canonicalString()}}function qf(n){return bs.fromServerFormat(n.fieldPath)}function H_e(n){return S2.create(qf(n.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return wt()}}(n.fieldFilter.op),n.fieldFilter.value)}function F_e(n){switch(n.unaryFilter.op){case"IS_NAN":const t=qf(n.unaryFilter.field);return S2.create(t,"==",{doubleValue:NaN});case"IS_NULL":const e=qf(n.unaryFilter.field);return S2.create(e,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=qf(n.unaryFilter.field);return S2.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=qf(n.unaryFilter.field);return S2.create(s,"!=",{nullValue:"NULL_VALUE"});default:return wt()}}function B_e(n){const t=[];return n.fields.forEach(e=>t.push(e.canonicalString())),{fieldPaths:t}}function uX(n){return n.length>=4&&"projects"===n.get(0)&&"databases"===n.get(2)}class hx{constructor(t,e,r,s){this.batchId=t,this.localWriteTime=e,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(t,e){const r=e.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(t.key)&&E_e(i,t,r[s])}}applyToLocalView(t,e){for(const r of this.baseMutations)r.key.isEqual(t.key)&&(e=Ig(r,t,e,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(t.key)&&(e=Ig(r,t,e,this.localWriteTime));return e}applyToLocalDocumentSet(t,e){const r=YK();return this.mutations.forEach(s=>{const i=t.get(s.key),o=i.overlayedDocument;let c=this.applyToLocalView(o,i.mutatedFields);c=e.has(s.key)?null:c;const u=FK(o,c);null!==u&&r.set(s.key,u),o.isValidDocument()||o.convertToNoDocument(an.min())}),r}keys(){return this.mutations.reduce((t,e)=>t.add(e.key),In())}isEqual(t){return this.batchId===t.batchId&&Rf(this.mutations,t.mutations,(e,r)=>BK(e,r))&&Rf(this.baseMutations,t.baseMutations,(e,r)=>BK(e,r))}}class px{constructor(t,e,r,s){this.batch=t,this.commitVersion=e,this.mutationResults=r,this.docVersions=s}static from(t,e,r){on(t.mutations.length===r.length);let s=T_e;const i=t.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new px(t,e,r,s)}}class gx{constructor(t,e){this.largestBatchId=t,this.mutation=e}getKey(){return this.mutation.key}isEqual(t){return null!==t&&this.mutation===t.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class G0{constructor(t,e,r,s,i=an.min(),o=an.min(),c=gi.EMPTY_BYTE_STRING){this.target=t,this.targetId=e,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=c}withSequenceNumber(t){return new G0(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(t,e){return new G0(this.target,this.targetId,this.purpose,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)}withLastLimboFreeSnapshotVersion(t){return new G0(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken)}}class _X{constructor(t){this.re=t}}function mx(n){const t=cX({parent:n.parent,structuredQuery:n.structuredQuery});return"LAST"===n.limitType?EM(t,t.limit,"L"):t}class i5{constructor(){}ce(t,e){this.ae(t,e),e.he()}ae(t,e){if("nullValue"in t)this.le(e,5);else if("booleanValue"in t)this.le(e,10),e.fe(t.booleanValue?1:0);else if("integerValue"in t)this.le(e,15),e.fe(gs(t.integerValue));else if("doubleValue"in t){const r=gs(t.doubleValue);isNaN(r)?this.le(e,13):(this.le(e,15),Pg(r)?e.fe(0):e.fe(r))}else if("timestampValue"in t){const r=t.timestampValue;this.le(e,20),"string"==typeof r?e.de(r):(e.de(`${r.seconds||""}`),e.fe(r.nanos||0))}else if("stringValue"in t)this._e(t.stringValue,e),this.we(e);else if("bytesValue"in t)this.le(e,30),e.me(Yu(t.bytesValue)),this.we(e);else if("referenceValue"in t)this.ge(t.referenceValue,e);else if("geoPointValue"in t){const r=t.geoPointValue;this.le(e,45),e.fe(r.latitude||0),e.fe(r.longitude||0)}else"mapValue"in t?_K(t)?this.le(e,Number.MAX_SAFE_INTEGER):(this.ye(t.mapValue,e),this.we(e)):"arrayValue"in t?(this.pe(t.arrayValue,e),this.we(e)):wt()}_e(t,e){this.le(e,25),this.Ie(t,e)}Ie(t,e){e.de(t)}ye(t,e){const r=t.fields||{};this.le(e,55);for(const s of Object.keys(r))this._e(s,e),this.ae(r[s],e)}pe(t,e){const r=t.values||[];this.le(e,50);for(const s of r)this.ae(s,e)}ge(t,e){this.le(e,37),at.fromName(t).path.forEach(r=>{this.le(e,60),this.Ie(r,e)})}le(t,e){t.fe(e)}we(t){t.fe(2)}}i5.Te=new i5;class hve{constructor(){this.Ye=new vx}addToCollectionParentIndex(t,e){return this.Ye.add(e),Se.resolve()}getCollectionParents(t,e){return Se.resolve(this.Ye.getEntries(e))}addFieldIndex(t,e){return Se.resolve()}deleteFieldIndex(t,e){return Se.resolve()}getDocumentsMatchingTarget(t,e){return Se.resolve(null)}getIndexType(t,e){return Se.resolve(0)}getFieldIndexes(t,e){return Se.resolve([])}getNextCollectionGroupToUpdate(t){return Se.resolve(null)}getMinOffset(t,e){return Se.resolve(Ua.min())}getMinOffsetFromCollectionGroup(t,e){return Se.resolve(Ua.min())}updateCollectionGroup(t,e,r){return Se.resolve()}updateIndexEntries(t,e){return Se.resolve()}}class vx{constructor(){this.index={}}add(t){const e=t.lastSegment(),r=t.popLast(),s=this.index[e]||new er(g1.comparator),i=!s.has(r);return this.index[e]=s.add(r),i}has(t){const e=t.lastSegment(),r=t.popLast(),s=this.index[e];return s&&s.has(r)}getEntries(t){return(this.index[t]||new er(g1.comparator)).toArray()}}new Uint8Array(0);class ua{constructor(t,e,r){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=r}static withCacheSize(t){return new ua(t,ua.DEFAULT_COLLECTION_PERCENTILE,ua.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}ua.DEFAULT_COLLECTION_PERCENTILE=10,ua.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ua.DEFAULT=new ua(41943040,ua.DEFAULT_COLLECTION_PERCENTILE,ua.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ua.DISABLED=new ua(-1,0,0);class c5{constructor(t){this.bn=t}next(){return this.bn+=2,this.bn}static Pn(){return new c5(0)}static vn(){return new c5(-1)}}class Sve{constructor(t,e){this.overlayedDocument=t,this.mutatedFields=e}}class VX{constructor(t,e,r,s){this.remoteDocumentCache=t,this.mutationQueue=e,this.documentOverlayCache=r,this.indexManager=s}getDocument(t,e){let r=null;return this.documentOverlayCache.getOverlay(t,e).next(s=>(r=s,this.getBaseDocument(t,e,r))).next(s=>(null!==r&&Ig(r.mutation,s,Ga.empty(),ts.now()),s))}getDocuments(t,e){return this.remoteDocumentCache.getEntries(t,e).next(r=>this.getLocalViewOfDocuments(t,r,In()).next(()=>r))}getLocalViewOfDocuments(t,e,r=In()){const s=N4();return this.populateOverlays(t,s,e).next(()=>this.computeViews(t,e,s,r).next(i=>{let o=xg();return i.forEach((c,u)=>{o=o.insert(c,u.overlayedDocument)}),o}))}getOverlayedDocuments(t,e){const r=N4();return this.populateOverlays(t,r,e).next(()=>this.computeViews(t,e,r,In()))}populateOverlays(t,e,r){const s=[];return r.forEach(i=>{e.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(t,s).next(i=>{i.forEach((o,c)=>{e.set(o,c)})})}computeViews(t,e,r,s){let i=la();const o=kg(),c=kg();return e.forEach((u,d)=>{const g=r.get(d.key);s.has(d.key)&&(void 0===g||g.mutation instanceof jl)?i=i.insert(d.key,d):void 0!==g&&(o.set(d.key,g.mutation.getFieldMask()),Ig(g.mutation,d,g.mutation.getFieldMask(),ts.now()))}),this.recalculateAndSaveOverlays(t,i).next(u=>(u.forEach((d,g)=>o.set(d,g)),e.forEach((d,g)=>{var m;return c.set(d,new Sve(g,null!==(m=o.get(d))&&void 0!==m?m:null))}),c))}recalculateAndSaveOverlays(t,e){const r=kg();let s=new ps((o,c)=>o-c),i=In();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next(o=>{for(const c of o)c.keys().forEach(u=>{const d=e.get(u);if(null===d)return;let g=r.get(u)||Ga.empty();g=c.applyToLocalView(d,g),r.set(u,g);const m=(s.get(c.batchId)||In()).add(u);s=s.insert(c.batchId,m)})}).next(()=>{const o=[],c=s.getReverseIterator();for(;c.hasNext();){const u=c.getNext(),d=u.key,g=u.value,m=YK();g.forEach(y=>{if(!i.has(y)){const b=FK(e.get(y),r.get(y));null!==b&&m.set(y,b),i=i.add(y)}}),o.push(this.documentOverlayCache.saveOverlays(t,d,m))}return Se.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(t,e){return this.remoteDocumentCache.getEntries(t,e).next(r=>this.recalculateAndSaveOverlays(t,r))}getDocumentsMatchingQuery(t,e,r){return at.isDocumentKey((s=e).path)&&null===s.collectionGroup&&0===s.filters.length?this.getDocumentsMatchingDocumentQuery(t,e.path):sx(e)?this.getDocumentsMatchingCollectionGroupQuery(t,e,r):this.getDocumentsMatchingCollectionQuery(t,e,r);var s}getNextDocuments(t,e,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(t,e,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,e,r.largestBatchId,s-i.size):Se.resolve(N4());let c=-1,u=i;return o.next(d=>Se.forEach(d,(g,m)=>(c<m.largestBatchId&&(c=m.largestBatchId),i.get(g)?Se.resolve():this.getBaseDocument(t,g,m).next(y=>{u=u.insert(g,y)}))).next(()=>this.populateOverlays(t,d,i)).next(()=>this.computeViews(t,u,d,In())).next(g=>({batchId:c,changes:ZK(g)})))})}getDocumentsMatchingDocumentQuery(t,e){return this.getDocument(t,new at(e)).next(r=>{let s=xg();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(t,e,r){const s=e.collectionGroup;let i=xg();return this.indexManager.getCollectionParents(t,s).next(o=>Se.forEach(o,c=>{const u=(d=e,g=c.child(s),new ql(g,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt));var d,g;return this.getDocumentsMatchingCollectionQuery(t,u,r).next(d=>{d.forEach((g,m)=>{i=i.insert(g,m)})})}).next(()=>i))}getDocumentsMatchingCollectionQuery(t,e,r){let s;return this.remoteDocumentCache.getAllFromCollection(t,e.path,r).next(i=>(s=i,this.documentOverlayCache.getOverlaysForCollection(t,e.path,r.largestBatchId))).next(i=>{i.forEach((c,u)=>{const d=u.getKey();null===s.get(d)&&(s=s.insert(d,pr.newInvalidDocument(d)))});let o=xg();return s.forEach((c,u)=>{const d=i.get(c);void 0!==d&&Ig(d.mutation,u,Ga.empty(),ts.now()),ox(e,u)&&(o=o.insert(c,u))}),o})}getBaseDocument(t,e,r){return null===r||1===r.mutation.type?this.remoteDocumentCache.getEntry(t,e):Se.resolve(pr.newInvalidDocument(e))}}class Pve{constructor(t){this.It=t,this.Zn=new Map,this.ts=new Map}getBundleMetadata(t,e){return Se.resolve(this.Zn.get(e))}saveBundleMetadata(t,e){var r;return this.Zn.set(e.id,{id:(r=e).id,version:r.version,createTime:Di(r.createTime)}),Se.resolve()}getNamedQuery(t,e){return Se.resolve(this.ts.get(e))}saveNamedQuery(t,e){return this.ts.set(e.name,{name:(r=e).name,query:mx(r.bundledQuery),readTime:Di(r.readTime)}),Se.resolve();var r}}class Tve{constructor(){this.overlays=new ps(at.comparator),this.es=new Map}getOverlay(t,e){return Se.resolve(this.overlays.get(e))}getOverlays(t,e){const r=N4();return Se.forEach(e,s=>this.getOverlay(t,s).next(i=>{null!==i&&r.set(s,i)})).next(()=>r)}saveOverlays(t,e,r){return r.forEach((s,i)=>{this.ue(t,e,i)}),Se.resolve()}removeOverlaysForBatchId(t,e,r){const s=this.es.get(r);return void 0!==s&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.es.delete(r)),Se.resolve()}getOverlaysForCollection(t,e,r){const s=N4(),i=e.length+1,o=new at(e.child("")),c=this.overlays.getIteratorFrom(o);for(;c.hasNext();){const u=c.getNext().value,d=u.getKey();if(!e.isPrefixOf(d.path))break;d.path.length===i&&u.largestBatchId>r&&s.set(u.getKey(),u)}return Se.resolve(s)}getOverlaysForCollectionGroup(t,e,r,s){let i=new ps((d,g)=>d-g);const o=this.overlays.getIterator();for(;o.hasNext();){const d=o.getNext().value;if(d.getKey().getCollectionGroup()===e&&d.largestBatchId>r){let g=i.get(d.largestBatchId);null===g&&(g=N4(),i=i.insert(d.largestBatchId,g)),g.set(d.getKey(),d)}}const c=N4(),u=i.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((d,g)=>c.set(d,g)),!(c.size()>=s)););return Se.resolve(c)}ue(t,e,r){const s=this.overlays.get(r.key);if(null!==s){const o=this.es.get(s.largestBatchId).delete(r.key);this.es.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new gx(e,r));let i=this.es.get(e);void 0===i&&(i=In(),this.es.set(e,i)),this.es.set(e,i.add(r.key))}}class Cx{constructor(){this.ns=new er(Vi.ss),this.rs=new er(Vi.os)}isEmpty(){return this.ns.isEmpty()}addReference(t,e){const r=new Vi(t,e);this.ns=this.ns.add(r),this.rs=this.rs.add(r)}us(t,e){t.forEach(r=>this.addReference(r,e))}removeReference(t,e){this.cs(new Vi(t,e))}hs(t,e){t.forEach(r=>this.removeReference(r,e))}ls(t){const e=new at(new g1([])),r=new Vi(e,t),s=new Vi(e,t+1),i=[];return this.rs.forEachInRange([r,s],o=>{this.cs(o),i.push(o.key)}),i}fs(){this.ns.forEach(t=>this.cs(t))}cs(t){this.ns=this.ns.delete(t),this.rs=this.rs.delete(t)}ds(t){const e=new at(new g1([])),r=new Vi(e,t),s=new Vi(e,t+1);let i=In();return this.rs.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(t){const e=new Vi(t,0),r=this.ns.firstAfterOrEqual(e);return null!==r&&t.isEqual(r.key)}}class Vi{constructor(t,e){this.key=t,this._s=e}static ss(t,e){return at.comparator(t.key,e.key)||yn(t._s,e._s)}static os(t,e){return yn(t._s,e._s)||at.comparator(t.key,e.key)}}class wve{constructor(t,e){this.indexManager=t,this.referenceDelegate=e,this.mutationQueue=[],this.ws=1,this.gs=new er(Vi.ss)}checkEmpty(t){return Se.resolve(0===this.mutationQueue.length)}addMutationBatch(t,e,r,s){const i=this.ws;this.ws++;const o=new hx(i,e,r,s);this.mutationQueue.push(o);for(const c of s)this.gs=this.gs.add(new Vi(c.key,i)),this.indexManager.addToCollectionParentIndex(t,c.key.path.popLast());return Se.resolve(o)}lookupMutationBatch(t,e){return Se.resolve(this.ys(e))}getNextMutationBatchAfterBatchId(t,e){const s=this.ps(e+1),i=s<0?0:s;return Se.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return Se.resolve(0===this.mutationQueue.length?-1:this.ws-1)}getAllMutationBatches(t){return Se.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,e){const r=new Vi(e,0),s=new Vi(e,Number.POSITIVE_INFINITY),i=[];return this.gs.forEachInRange([r,s],o=>{const c=this.ys(o._s);i.push(c)}),Se.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(t,e){let r=new er(yn);return e.forEach(s=>{const i=new Vi(s,0),o=new Vi(s,Number.POSITIVE_INFINITY);this.gs.forEachInRange([i,o],c=>{r=r.add(c._s)})}),Se.resolve(this.Is(r))}getAllMutationBatchesAffectingQuery(t,e){const r=e.path,s=r.length+1;let i=r;at.isDocumentKey(i)||(i=i.child(""));const o=new Vi(new at(i),0);let c=new er(yn);return this.gs.forEachWhile(u=>{const d=u.key.path;return!!r.isPrefixOf(d)&&(d.length===s&&(c=c.add(u._s)),!0)},o),Se.resolve(this.Is(c))}Is(t){const e=[];return t.forEach(r=>{const s=this.ys(r);null!==s&&e.push(s)}),e}removeMutationBatch(t,e){on(0===this.Ts(e.batchId,"removed")),this.mutationQueue.shift();let r=this.gs;return Se.forEach(e.mutations,s=>{const i=new Vi(s.key,e.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(t,s.key)}).next(()=>{this.gs=r})}An(t){}containsKey(t,e){const r=new Vi(e,0),s=this.gs.firstAfterOrEqual(r);return Se.resolve(e.isEqual(s&&s.key))}performConsistencyCheck(t){return Se.resolve()}Ts(t,e){return this.ps(t)}ps(t){return 0===this.mutationQueue.length?0:t-this.mutationQueue[0].batchId}ys(t){const e=this.ps(t);return e<0||e>=this.mutationQueue.length?null:this.mutationQueue[e]}}class bve{constructor(t){this.Es=t,this.docs=new ps(at.comparator),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,e){const r=e.key,s=this.docs.get(r),i=s?s.size:0,o=this.Es(e);return this.docs=this.docs.insert(r,{document:e.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(t,r.path.popLast())}removeEntry(t){const e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}getEntry(t,e){const r=this.docs.get(e);return Se.resolve(r?r.document.mutableCopy():pr.newInvalidDocument(e))}getEntries(t,e){let r=la();return e.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():pr.newInvalidDocument(s))}),Se.resolve(r)}getAllFromCollection(t,e,r){let s=la();const i=new at(e.child("")),o=this.docs.getIteratorFrom(i);for(;o.hasNext();){const{key:c,value:{document:u}}=o.getNext();if(!e.isPrefixOf(c.path))break;c.path.length>e.length+1||KI(oK(u),r)<=0||(s=s.insert(u.key,u.mutableCopy()))}return Se.resolve(s)}getAllFromCollectionGroup(t,e,r,s){wt()}As(t,e){return Se.forEach(this.docs,r=>e(r))}newChangeBuffer(t){return new Ove(this)}getSize(t){return Se.resolve(this.size)}}class Ove extends class yve{constructor(){this.changes=new U0(t=>t.toString(),(t,e)=>t.isEqual(e)),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,e){this.assertNotApplied(),this.changes.set(t,pr.newInvalidDocument(t).setReadTime(e))}getEntry(t,e){this.assertNotApplied();const r=this.changes.get(e);return void 0!==r?Se.resolve(r):this.getFromCache(t,e)}getEntries(t,e){return this.getAllFromCache(t,e)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}{constructor(t){super(),this.Yn=t}applyChanges(t){const e=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?e.push(this.Yn.addEntry(t,s)):this.Yn.removeEntry(r)}),Se.waitFor(e)}getFromCache(t,e){return this.Yn.getEntry(t,e)}getAllFromCache(t,e){return this.Yn.getEntries(t,e)}}class Ave{constructor(t){this.persistence=t,this.Rs=new U0(e=>Ju(e),Og),this.lastRemoteSnapshotVersion=an.min(),this.highestTargetId=0,this.bs=0,this.Ps=new Cx,this.targetCount=0,this.vs=c5.Pn()}forEachTarget(t,e){return this.Rs.forEach((r,s)=>e(s)),Se.resolve()}getLastRemoteSnapshotVersion(t){return Se.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return Se.resolve(this.bs)}allocateTargetId(t){return this.highestTargetId=this.vs.next(),Se.resolve(this.highestTargetId)}setTargetsMetadata(t,e,r){return r&&(this.lastRemoteSnapshotVersion=r),e>this.bs&&(this.bs=e),Se.resolve()}Dn(t){this.Rs.set(t.target,t);const e=t.targetId;e>this.highestTargetId&&(this.vs=new c5(e),this.highestTargetId=e),t.sequenceNumber>this.bs&&(this.bs=t.sequenceNumber)}addTargetData(t,e){return this.Dn(e),this.targetCount+=1,Se.resolve()}updateTargetData(t,e){return this.Dn(e),Se.resolve()}removeTargetData(t,e){return this.Rs.delete(e.target),this.Ps.ls(e.targetId),this.targetCount-=1,Se.resolve()}removeTargets(t,e,r){let s=0;const i=[];return this.Rs.forEach((o,c)=>{c.sequenceNumber<=e&&null===r.get(c.targetId)&&(this.Rs.delete(o),i.push(this.removeMatchingKeysForTargetId(t,c.targetId)),s++)}),Se.waitFor(i).next(()=>s)}getTargetCount(t){return Se.resolve(this.targetCount)}getTargetData(t,e){const r=this.Rs.get(e)||null;return Se.resolve(r)}addMatchingKeys(t,e,r){return this.Ps.us(e,r),Se.resolve()}removeMatchingKeys(t,e,r){this.Ps.hs(e,r);const s=this.persistence.referenceDelegate,i=[];return s&&e.forEach(o=>{i.push(s.markPotentiallyOrphaned(t,o))}),Se.waitFor(i)}removeMatchingKeysForTargetId(t,e){return this.Ps.ls(e),Se.resolve()}getMatchingKeysForTargetId(t,e){const r=this.Ps.ds(e);return Se.resolve(r)}containsKey(t,e){return Se.resolve(this.Ps.containsKey(e))}}class HX{constructor(t,e){this.Vs={},this.overlays={},this.Ss=new ca(0),this.Ds=!1,this.Ds=!0,this.referenceDelegate=t(this),this.Cs=new Ave(this),this.indexManager=new hve,this.remoteDocumentCache=new bve(r=>this.referenceDelegate.xs(r)),this.It=new _X(e),this.Ns=new Pve(this.It)}start(){return Promise.resolve()}shutdown(){return this.Ds=!1,Promise.resolve()}get started(){return this.Ds}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let e=this.overlays[t.toKey()];return e||(e=new Tve,this.overlays[t.toKey()]=e),e}getMutationQueue(t,e){let r=this.Vs[t.toKey()];return r||(r=new wve(e,this.referenceDelegate),this.Vs[t.toKey()]=r),r}getTargetCache(){return this.Cs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ns}runTransaction(t,e,r){qe("MemoryPersistence","Starting transaction:",t);const s=new Nve(this.Ss.next());return this.referenceDelegate.ks(),r(s).next(i=>this.referenceDelegate.Os(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Ms(t,e){return Se.or(Object.values(this.Vs).map(r=>()=>r.containsKey(t,e)))}}class Nve extends class Xme{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(t=>t())}}{constructor(t){super(),this.currentSequenceNumber=t}}class RM{constructor(t){this.persistence=t,this.Fs=new Cx,this.$s=null}static Bs(t){return new RM(t)}get Ls(){if(this.$s)return this.$s;throw wt()}addReference(t,e,r){return this.Fs.addReference(r,e),this.Ls.delete(r.toString()),Se.resolve()}removeReference(t,e,r){return this.Fs.removeReference(r,e),this.Ls.add(r.toString()),Se.resolve()}markPotentiallyOrphaned(t,e){return this.Ls.add(e.toString()),Se.resolve()}removeTarget(t,e){this.Fs.ls(e.targetId).forEach(s=>this.Ls.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(t,e.targetId).next(s=>{s.forEach(i=>this.Ls.add(i.toString()))}).next(()=>r.removeTargetData(t,e))}ks(){this.$s=new Set}Os(t){const e=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Se.forEach(this.Ls,r=>{const s=at.fromPath(r);return this.Us(t,s).next(i=>{i||e.removeEntry(s,an.min())})}).next(()=>(this.$s=null,e.apply(t)))}updateLimboDocument(t,e){return this.Us(t,e).next(r=>{r?this.Ls.delete(e.toString()):this.Ls.add(e.toString())})}xs(t){return 0}Us(t,e){return Se.or([()=>Se.resolve(this.Fs.containsKey(e)),()=>this.persistence.getTargetCache().containsKey(t,e),()=>this.persistence.Ms(t,e)])}}class Sx{constructor(t,e,r,s){this.targetId=t,this.fromCache=e,this.Si=r,this.Di=s}static Ci(t,e){let r=In(),s=In();for(const i of e.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new Sx(t,e.fromCache,r,s)}}class BX{constructor(){this.xi=!1}initialize(t,e){this.Ni=t,this.indexManager=e,this.xi=!0}getDocumentsMatchingQuery(t,e,r,s){return this.ki(t,e).next(i=>i||this.Oi(t,e,s,r)).next(i=>i||this.Mi(t,e))}ki(t,e){if(OK(e))return Se.resolve(null);let r=No(e);return this.indexManager.getIndexType(t,r).next(s=>0===s?null:(null!==e.limit&&1===s&&(e=EM(e,null,"F"),r=No(e)),this.indexManager.getDocumentsMatchingTarget(t,r).next(i=>{const o=In(...i);return this.Ni.getDocuments(t,o).next(c=>this.indexManager.getMinOffset(t,r).next(u=>{const d=this.Fi(e,c);return this.$i(e,d,o,u.readTime)?this.ki(t,EM(e,null,"F")):this.Bi(t,d,e,u)}))})))}Oi(t,e,r,s){return OK(e)||s.isEqual(an.min())?this.Mi(t,e):this.Ni.getDocuments(t,r).next(i=>{const o=this.Fi(e,i);return this.$i(e,o,r,s)?this.Mi(t,e):(jI()<=p1.DEBUG&&qe("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),ix(e)),this.Bi(t,o,e,function iK(n,t){const e=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,s=an.fromTimestamp(1e9===r?new ts(e+1,0):new ts(e,r));return new Ua(s,at.empty(),t)}(s,-1)))})}Fi(t,e){let r=new er(IK(t));return e.forEach((s,i)=>{ox(t,i)&&(r=r.add(i))}),r}$i(t,e,r,s){if(null===t.limit)return!1;if(r.size!==e.size)return!0;const i="F"===t.limitType?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Mi(t,e){return jI()<=p1.DEBUG&&qe("QueryEngine","Using full collection scan to execute query:",ix(e)),this.Ni.getDocumentsMatchingQuery(t,e,Ua.min())}Bi(t,e,r,s){return this.Ni.getDocumentsMatchingQuery(t,r,s).next(i=>(e.forEach(o=>{i=i.insert(o.key,o)}),i))}}class xve{constructor(t,e,r,s){this.persistence=t,this.Li=e,this.It=s,this.Ui=new ps(yn),this.qi=new U0(i=>Ju(i),Og),this.Ki=new Map,this.Gi=t.getRemoteDocumentCache(),this.Cs=t.getTargetCache(),this.Ns=t.getBundleCache(),this.Qi(r)}Qi(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new VX(this.Gi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Gi.setIndexManager(this.indexManager),this.Li.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",e=>t.collect(e,this.Ui))}}function UX(n,t){return Px.apply(this,arguments)}function Px(){return Px=I(function*(n,t){const e=ut(n);return yield e.persistence.runTransaction("Handle user change","readonly",r=>{let s;return e.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,e.Qi(t),e.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],c=[];let u=In();for(const d of s){o.push(d.batchId);for(const g of d.mutations)u=u.add(g.key)}for(const d of i){c.push(d.batchId);for(const g of d.mutations)u=u.add(g.key)}return e.localDocuments.getDocuments(r,u).next(d=>({ji:d,removedBatchIds:o,addedBatchIds:c}))})})}),Px.apply(this,arguments)}function kve(n,t){const e=ut(n);return e.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=t.batch.keys(),i=e.Gi.newChangeBuffer({trackRemovals:!0});return function(o,c,u,d){const g=u.batch,m=g.keys();let y=Se.resolve();return m.forEach(b=>{y=y.next(()=>d.getEntry(c,b)).next(k=>{const $=u.docVersions.get(b);on(null!==$),k.version.compareTo($)<0&&(g.applyToRemoteDocument(k,u),k.isValidDocument()&&(k.setReadTime(u.commitVersion),d.addEntry(k)))})}),y.next(()=>o.mutationQueue.removeMutationBatch(c,g))}(e,r,t,i).next(()=>i.apply(r)).next(()=>e.mutationQueue.performConsistencyCheck(r)).next(()=>e.documentOverlayCache.removeOverlaysForBatchId(r,s,t.batch.batchId)).next(()=>e.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(o){let c=In();for(let u=0;u<o.mutationResults.length;++u)o.mutationResults[u].transformResults.length>0&&(c=c.add(o.batch.mutations[u].key));return c}(t))).next(()=>e.localDocuments.getDocuments(r,s))})}function GX(n){const t=ut(n);return t.persistence.runTransaction("Get last remote snapshot version","readonly",e=>t.Cs.getLastRemoteSnapshotVersion(e))}function Lve(n,t){const e=ut(n),r=t.snapshotVersion;let s=e.Ui;return e.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=e.Gi.newChangeBuffer({trackRemovals:!0});s=e.Ui;const c=[];t.targetChanges.forEach((g,m)=>{const y=s.get(m);if(!y)return;c.push(e.Cs.removeMatchingKeys(i,g.removedDocuments,m).next(()=>e.Cs.addMatchingKeys(i,g.addedDocuments,m)));let b=y.withSequenceNumber(i.currentSequenceNumber);var k,$,K;t.targetMismatches.has(m)?b=b.withResumeToken(gi.EMPTY_BYTE_STRING,an.min()).withLastLimboFreeSnapshotVersion(an.min()):g.resumeToken.approximateByteSize()>0&&(b=b.withResumeToken(g.resumeToken,r)),s=s.insert(m,b),$=b,K=g,(0===(k=y).resumeToken.approximateByteSize()||$.snapshotVersion.toMicroseconds()-k.snapshotVersion.toMicroseconds()>=3e8||K.addedDocuments.size+K.modifiedDocuments.size+K.removedDocuments.size>0)&&c.push(e.Cs.updateTargetData(i,b))});let u=la(),d=In();if(t.documentUpdates.forEach(g=>{t.resolvedLimboDocuments.has(g)&&c.push(e.persistence.referenceDelegate.updateLimboDocument(i,g))}),c.push(function WX(n,t,e){let r=In(),s=In();return e.forEach(i=>r=r.add(i)),t.getEntries(n,r).next(i=>{let o=la();return e.forEach((c,u)=>{const d=i.get(c);u.isFoundDocument()!==d.isFoundDocument()&&(s=s.add(c)),u.isNoDocument()&&u.version.isEqual(an.min())?(t.removeEntry(c,u.readTime),o=o.insert(c,u)):!d.isValidDocument()||u.version.compareTo(d.version)>0||0===u.version.compareTo(d.version)&&d.hasPendingWrites?(t.addEntry(u),o=o.insert(c,u)):qe("LocalStore","Ignoring outdated watch update for ",c,". Current version:",d.version," Watch version:",u.version)}),{Wi:o,zi:s}})}(i,o,t.documentUpdates).next(g=>{u=g.Wi,d=g.zi})),!r.isEqual(an.min())){const g=e.Cs.getLastRemoteSnapshotVersion(i).next(m=>e.Cs.setTargetsMetadata(i,i.currentSequenceNumber,r));c.push(g)}return Se.waitFor(c).next(()=>o.apply(i)).next(()=>e.localDocuments.getLocalViewOfDocuments(i,u,d)).next(()=>u)}).then(i=>(e.Ui=s,i))}function Rve(n,t){const e=ut(n);return e.persistence.runTransaction("Get next mutation batch","readonly",r=>(void 0===t&&(t=-1),e.mutationQueue.getNextMutationBatchAfterBatchId(r,t)))}function Yf(n,t){const e=ut(n);return e.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return e.Cs.getTargetData(r,t).next(i=>i?(s=i,Se.resolve(s)):e.Cs.allocateTargetId(r).next(o=>(s=new G0(t,o,0,r.currentSequenceNumber),e.Cs.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=e.Ui.get(r.targetId);return(null===s||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(e.Ui=e.Ui.insert(r.targetId,r),e.qi.set(t,r.targetId)),r})}function Kf(n,t,e){return Tx.apply(this,arguments)}function Tx(){return Tx=I(function*(n,t,e){const r=ut(n),s=r.Ui.get(t),i=e?"readwrite":"readwrite-primary";try{e||(yield r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s)))}catch(o){if(!V0(o))throw o;qe("LocalStore",`Failed to update sequence numbers for target ${t}: ${o}`)}r.Ui=r.Ui.remove(t),r.qi.delete(s.target)}),Tx.apply(this,arguments)}function zM(n,t,e){const r=ut(n);let s=an.min(),i=In();return r.persistence.runTransaction("Execute query","readonly",o=>function(c,u,d){const g=ut(c),m=g.qi.get(d);return void 0!==m?Se.resolve(g.Ui.get(m)):g.Cs.getTargetData(u,d)}(r,o,No(t)).next(c=>{if(c)return s=c.lastLimboFreeSnapshotVersion,r.Cs.getMatchingKeysForTargetId(o,c.targetId).next(u=>{i=u})}).next(()=>r.Li.getDocumentsMatchingQuery(o,t,e?s:an.min(),e?i:In())).next(c=>(function ZX(n,t,e){let r=n.Ki.get(t)||an.min();e.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),n.Ki.set(t,r)}(r,function NK(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}(t),c),{documents:c,Hi:i})))}class Nx{constructor(){this.activeTargetIds=TM()}er(t){this.activeTargetIds=this.activeTargetIds.add(t)}nr(t){this.activeTargetIds=this.activeTargetIds.delete(t)}tr(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class XX{constructor(){this.Lr=new Nx,this.Ur={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,e,r){}addLocalQueryTarget(t){return this.Lr.er(t),this.Ur[t]||"not-current"}updateQueryState(t,e,r){this.Ur[t]=e}removeLocalQueryTarget(t){this.Lr.nr(t)}isLocalQueryTarget(t){return this.Lr.activeTargetIds.has(t)}clearQueryState(t){delete this.Ur[t]}getAllActiveQueryTargets(){return this.Lr.activeTargetIds}isActiveQueryTarget(t){return this.Lr.activeTargetIds.has(t)}start(){return this.Lr=new Nx,Promise.resolve()}handleUserChange(t,e,r){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}class Vve{qr(t){}shutdown(){}}class QX{constructor(){this.Kr=()=>this.Gr(),this.Qr=()=>this.jr(),this.Wr=[],this.zr()}qr(t){this.Wr.push(t)}shutdown(){window.removeEventListener("online",this.Kr),window.removeEventListener("offline",this.Qr)}zr(){window.addEventListener("online",this.Kr),window.addEventListener("offline",this.Qr)}Gr(){qe("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const t of this.Wr)t(0)}jr(){qe("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const t of this.Wr)t(1)}static C(){return typeof window<"u"&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}const Hve={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Fve{constructor(t){this.Hr=t.Hr,this.Jr=t.Jr}Yr(t){this.Xr=t}Zr(t){this.eo=t}onMessage(t){this.no=t}close(){this.Jr()}send(t){this.Hr(t)}so(){this.Xr()}io(t){this.eo(t)}ro(t){this.no(t)}}class Bve extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId,this.oo=(t.ssl?"https":"http")+"://"+t.host,this.uo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}get co(){return!1}ao(t,e,r,s,i){const o=this.ho(t,e);qe("RestConnection","Sending: ",o,r);const c={};return this.lo(c,s,i),this.fo(t,o,c,r).then(u=>(qe("RestConnection","Received: ",u),u),u=>{throw Lf("RestConnection",`${t} failed with error: `,u,"url: ",o,"request:",r),u})}_o(t,e,r,s,i,o){return this.ao(t,e,r,s,i)}lo(t,e,r){t["X-Goog-Api-Client"]="gl-js/ fire/"+kf,t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e&&e.headers.forEach((s,i)=>t[i]=s),r&&r.headers.forEach((s,i)=>t[i]=s)}ho(t,e){return`${this.oo}/v1/${e}:${Hve[t]}`}}{constructor(t){super(t),this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams}fo(t,e,r,s){return new Promise((i,o)=>{const c=new Fme;c.setWithCredentials(!0),c.listenOnce(zme.COMPLETE,()=>{var d;try{switch(c.getLastErrorCode()){case qI.NO_ERROR:const g=c.getResponseJson();qe("Connection","XHR received:",JSON.stringify(g)),i(g);break;case qI.TIMEOUT:qe("Connection",'RPC "'+t+'" timed out'),o(new Ue(Ae.DEADLINE_EXCEEDED,"Request time out"));break;case qI.HTTP_ERROR:const m=c.getStatus();if(qe("Connection",'RPC "'+t+'" failed with status:',m,"response text:",c.getResponseText()),m>0){let y=c.getResponseJson();Array.isArray(y)&&(y=y[0]);const b=null===(d=y)||void 0===d?void 0:d.error;if(b&&b.status&&b.message){const k=function($){const K=$.toLowerCase().replace(/_/g,"-");return Object.values(Ae).indexOf(K)>=0?K:Ae.UNKNOWN}(b.status);o(new Ue(k,b.message))}else o(new Ue(Ae.UNKNOWN,"Server responded with status "+c.getStatus()))}else o(new Ue(Ae.UNAVAILABLE,"Connection failed."));break;default:wt()}}finally{qe("Connection",'RPC "'+t+'" completed.')}});const u=JSON.stringify(s);c.send(e,"POST",u,r,15)})}wo(t,e,r){const s=[this.oo,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=Rme(),o=Dme(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(c.xmlHttpFactory=new Hme({})),this.lo(c.initMessageHeaders,e,r),c.encodeInitMessageHeaders=!0;const u=s.join("");qe("Connection","Creating WebChannel: "+u,c);const d=i.createWebChannel(u,c);let g=!1,m=!1;const y=new Fve({Hr:k=>{m?qe("Connection","Not sending because WebChannel is closed:",k):(g||(qe("Connection","Opening WebChannel transport."),d.open(),g=!0),qe("Connection","WebChannel sending:",k),d.send(k))},Jr:()=>d.close()}),b=(k,$,K)=>{k.listen($,oe=>{try{K(oe)}catch(ye){setTimeout(()=>{throw ye},0)}})};return b(d,dM.EventType.OPEN,()=>{m||qe("Connection","WebChannel transport opened.")}),b(d,dM.EventType.CLOSE,()=>{m||(m=!0,qe("Connection","WebChannel transport closed"),y.io())}),b(d,dM.EventType.ERROR,k=>{m||(m=!0,Lf("Connection","WebChannel transport errored:",k),y.io(new Ue(Ae.UNAVAILABLE,"The operation could not be completed")))}),b(d,dM.EventType.MESSAGE,k=>{var $;if(!m){const K=k.data[0];on(!!K);const oe=K,ye=oe.error||(null===($=oe[0])||void 0===$?void 0:$.error);if(ye){qe("Connection","WebChannel received error:",ye);const te=ye.status;let Le=function(Qe){const Ft=qs[Qe];if(void 0!==Ft)return qK(Ft)}(te),Ge=ye.message;void 0===Le&&(Le=Ae.INTERNAL,Ge="Unknown error status: "+te+" with message "+ye.message),m=!0,y.io(new Ue(Le,Ge)),d.close()}else qe("Connection","WebChannel received:",K),y.ro(K)}}),b(o,Vme.STAT_EVENT,k=>{k.stat===JY.PROXY?qe("Connection","Detected buffering proxy"):k.stat===JY.NOPROXY&&qe("Connection","Detected no buffering proxy")}),setTimeout(()=>{y.so()},0),y}}function FM(){return typeof document<"u"?document:null}function Zg(n){return new I_e(n,!0)}class xx{constructor(t,e,r=1e3,s=1.5,i=6e4){this.Hs=t,this.timerId=e,this.mo=r,this.yo=s,this.po=i,this.Io=0,this.To=null,this.Eo=Date.now(),this.reset()}reset(){this.Io=0}Ao(){this.Io=this.po}Ro(t){this.cancel();const e=Math.floor(this.Io+this.bo()),r=Math.max(0,Date.now()-this.Eo),s=Math.max(0,e-r);s>0&&qe("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Io} ms, delay with jitter: ${e} ms, last attempt: ${r} ms ago)`),this.To=this.Hs.enqueueAfterDelay(this.timerId,s,()=>(this.Eo=Date.now(),t())),this.Io*=this.yo,this.Io<this.mo&&(this.Io=this.mo),this.Io>this.po&&(this.Io=this.po)}Po(){null!==this.To&&(this.To.skipDelay(),this.To=null)}cancel(){null!==this.To&&(this.To.cancel(),this.To=null)}bo(){return(Math.random()-.5)*this.Io}}class eQ{constructor(t,e,r,s,i,o,c,u){this.Hs=t,this.vo=r,this.Vo=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=c,this.listener=u,this.state=0,this.So=0,this.Do=null,this.Co=null,this.stream=null,this.xo=new xx(t,e)}No(){return 1===this.state||5===this.state||this.ko()}ko(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Oo()}stop(){var t=this;return I(function*(){t.No()&&(yield t.close(0))})()}Mo(){this.state=0,this.xo.reset()}Fo(){this.ko()&&null===this.Do&&(this.Do=this.Hs.enqueueAfterDelay(this.vo,6e4,()=>this.$o()))}Bo(t){this.Lo(),this.stream.send(t)}$o(){var t=this;return I(function*(){if(t.ko())return t.close(0)})()}Lo(){this.Do&&(this.Do.cancel(),this.Do=null)}Uo(){this.Co&&(this.Co.cancel(),this.Co=null)}close(t,e){var r=this;return I(function*(){r.Lo(),r.Uo(),r.xo.cancel(),r.So++,4!==t?r.xo.reset():e&&e.code===Ae.RESOURCE_EXHAUSTED?(ws(e.toString()),ws("Using maximum backoff delay to prevent overloading the backend."),r.xo.Ao()):e&&e.code===Ae.UNAUTHENTICATED&&3!==r.state&&(r.authCredentialsProvider.invalidateToken(),r.appCheckCredentialsProvider.invalidateToken()),null!==r.stream&&(r.qo(),r.stream.close(),r.stream=null),r.state=t,yield r.listener.Zr(e)})()}qo(){}auth(){this.state=1;const t=this.Ko(this.So),e=this.So;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.So===e&&this.Go(r,s)},r=>{t(()=>{const s=new Ue(Ae.UNKNOWN,"Fetching auth token failed: "+r.message);return this.Qo(s)})})}Go(t,e){const r=this.Ko(this.So);this.stream=this.jo(t,e),this.stream.Yr(()=>{r(()=>(this.state=2,this.Co=this.Hs.enqueueAfterDelay(this.Vo,1e4,()=>(this.ko()&&(this.state=3),Promise.resolve())),this.listener.Yr()))}),this.stream.Zr(s=>{r(()=>this.Qo(s))}),this.stream.onMessage(s=>{r(()=>this.onMessage(s))})}Oo(){var t=this;this.state=5,this.xo.Ro(I(function*(){t.state=0,t.start()}))}Qo(t){return qe("PersistentStream",`close with error: ${t}`),this.stream=null,this.close(4,t)}Ko(t){return e=>{this.Hs.enqueueAndForget(()=>this.So===t?e():(qe("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class $ve extends eQ{constructor(t,e,r,s,i,o){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",e,r,s,o),this.It=i}jo(t,e){return this.connection.wo("Listen",t,e)}onMessage(t){this.xo.reset();const e=function L_e(n,t){let e;if("targetChange"in t){const r="NO_CHANGE"===(u=t.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===u?1:"REMOVE"===u?2:"CURRENT"===u?3:"RESET"===u?4:wt(),s=t.targetChange.targetIds||[],i=function(u,d){return u.gt?(on(void 0===d||"string"==typeof d),gi.fromBase64String(d||"")):(on(void 0===d||d instanceof Uint8Array),gi.fromUint8Array(d||new Uint8Array))}(n,t.targetChange.resumeToken),o=t.targetChange.cause,c=o&&function(u){const d=void 0===u.code?Ae.UNKNOWN:qK(u.code);return new Ue(d,u.message||"")}(o);e=new XK(r,s,i,c||null)}else if("documentChange"in t){const r=t.documentChange,s=I4(n,r.document.name),i=Di(r.document.updateTime),o=new M2({mapValue:{fields:r.document.fields}}),c=pr.newFoundDocument(s,i,o);e=new wM(r.targetIds||[],r.removedTargetIds||[],c.key,c)}else if("documentDelete"in t){const r=t.documentDelete,s=I4(n,r.document),i=r.readTime?Di(r.readTime):an.min(),o=pr.newNoDocument(s,i);e=new wM([],r.removedTargetIds||[],o.key,o)}else if("documentRemove"in t){const r=t.documentRemove,s=I4(n,r.document);e=new wM([],r.removedTargetIds||[],s,null)}else{if(!("filter"in t))return wt();{const r=t.filter,i=new S_e(r.count||0);e=new KK(r.targetId,i)}}var u;return e}(this.It,t),r=function(s){if(!("targetChange"in s))return an.min();const i=s.targetChange;return i.targetIds&&i.targetIds.length?an.min():i.readTime?Di(i.readTime):an.min()}(t);return this.listener.Wo(e,r)}zo(t){const e={};e.database=Vg(this.It),e.addTarget=function(s,i){let o;const c=i.target;return o=CM(c)?{documents:aX(s,c)}:{query:fx(s,c)},o.targetId=i.targetId,i.resumeToken.approximateByteSize()>0?o.resumeToken=tX(s,i.resumeToken):i.snapshotVersion.compareTo(an.min())>0&&(o.readTime=Dg(s,i.snapshotVersion.toTimestamp())),o}(this.It,t);const r=function D_e(n,t){const e=function(r,s){switch(s){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return wt()}}(0,t.purpose);return null==e?null:{"goog-listen-tags":e}}(0,t);r&&(e.labels=r),this.Bo(e)}Ho(t){const e={};e.database=Vg(this.It),e.removeTarget=t,this.Bo(e)}}class Uve extends eQ{constructor(t,e,r,s,i,o){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",e,r,s,o),this.It=i,this.Jo=!1}get Yo(){return this.Jo}start(){this.Jo=!1,this.lastStreamToken=void 0,super.start()}qo(){this.Jo&&this.Xo([])}jo(t,e){return this.connection.wo("Write",t,e)}onMessage(t){if(on(!!t.streamToken),this.lastStreamToken=t.streamToken,this.Jo){this.xo.reset();const e=function R_e(n,t){return n&&n.length>0?(on(void 0!==t),n.map(e=>function(r,s){let i=Di(r.updateTime?r.updateTime:s);return i.isEqual(an.min())&&(i=Di(s)),new y_e(i,r.transformResults||[])}(e,t))):[]}(t.writeResults,t.commitTime),r=Di(t.commitTime);return this.listener.Zo(r,e)}return on(!t.writeResults||0===t.writeResults.length),this.Jo=!0,this.listener.tu()}eu(){const t={};t.database=Vg(this.It),this.Bo(t)}Xo(t){const e={streamToken:this.lastStreamToken,writes:t.map(r=>function Hg(n,t){let e;if(t instanceof Uf)e={update:iX(n,t.key,t.value)};else if(t instanceof Gf)e={delete:zg(n,t.key)};else if(t instanceof jl)e={update:iX(n,t.key,t.data),updateMask:B_e(t.fieldMask)};else{if(!(t instanceof ax))return wt();e={verify:zg(n,t.key)}}return t.fieldTransforms.length>0&&(e.updateTransforms=t.fieldTransforms.map(r=>function(s,i){const o=i.transform;if(o instanceof Bf)return{fieldPath:i.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof e5)return{fieldPath:i.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof t5)return{fieldPath:i.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof $f)return{fieldPath:i.field.canonicalString(),increment:o.yt};throw wt()}(0,r))),t.precondition.isNone||(e.currentDocument=void 0!==(s=t.precondition).updateTime?{updateTime:x_e(n,s.updateTime)}:void 0!==s.exists?{exists:s.exists}:wt()),e;var s}(this.It,r))};this.Bo(e)}}class Gve extends class{}{constructor(t,e,r,s){super(),this.authCredentials=t,this.appCheckCredentials=e,this.connection=r,this.It=s,this.nu=!1}su(){if(this.nu)throw new Ue(Ae.FAILED_PRECONDITION,"The client has already been terminated.")}ao(t,e,r){return this.su(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,i])=>this.connection.ao(t,e,r,s,i)).catch(s=>{throw"FirebaseError"===s.name?(s.code===Ae.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Ue(Ae.UNKNOWN,s.toString())})}_o(t,e,r,s){return this.su(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection._o(t,e,r,i,o,s)).catch(i=>{throw"FirebaseError"===i.name?(i.code===Ae.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Ue(Ae.UNKNOWN,i.toString())})}terminate(){this.nu=!0}}class qve{constructor(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.iu=0,this.ru=null,this.ou=!0}uu(){0===this.iu&&(this.cu("Unknown"),this.ru=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.ru=null,this.au("Backend didn't respond within 10 seconds."),this.cu("Offline"),Promise.resolve())))}hu(t){"Online"===this.state?this.cu("Unknown"):(this.iu++,this.iu>=1&&(this.lu(),this.au(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.cu("Offline")))}set(t){this.lu(),this.iu=0,"Online"===t&&(this.ou=!1),this.cu(t)}cu(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}au(t){const e=`Could not reach Cloud Firestore backend. ${t}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.ou?(ws(e),this.ou=!1):qe("OnlineStateTracker",e)}lu(){null!==this.ru&&(this.ru.cancel(),this.ru=null)}}class jve{constructor(t,e,r,s,i){var o=this;this.localStore=t,this.datastore=e,this.asyncQueue=r,this.remoteSyncer={},this.fu=[],this.du=new Map,this._u=new Set,this.wu=[],this.mu=i,this.mu.qr(c=>{r.enqueueAndForget(I(function*(){var u;Zl(o)&&(qe("RemoteStore","Restarting streams for network reachability change."),yield(u=I(function*(d){const g=ut(d);g._u.add(4),yield Xf(g),g.gu.set("Unknown"),g._u.delete(4),yield Yg(g)}),function(d){return u.apply(this,arguments)})(o))}))}),this.gu=new qve(r,s)}}function Yg(n){return Lx.apply(this,arguments)}function Lx(){return Lx=I(function*(n){if(Zl(n))for(const t of n.wu)yield t(!0)}),Lx.apply(this,arguments)}function Xf(n){return Rx.apply(this,arguments)}function Rx(){return Rx=I(function*(n){for(const t of n.wu)yield t(!1)}),Rx.apply(this,arguments)}function BM(n,t){const e=ut(n);e.du.has(t.targetId)||(e.du.set(t.targetId,t),Vx(e)?zx(e):Jf(e).ko()&&Dx(e,t))}function Kg(n,t){const e=ut(n),r=Jf(e);e.du.delete(t),r.ko()&&tQ(e,t),0===e.du.size&&(r.ko()?r.Fo():Zl(e)&&e.gu.set("Unknown"))}function Dx(n,t){n.yu.Mt(t.targetId),Jf(n).zo(t)}function tQ(n,t){n.yu.Mt(t),Jf(n).Ho(t)}function zx(n){n.yu=new O_e({getRemoteKeysForTarget:t=>n.remoteSyncer.getRemoteKeysForTarget(t),se:t=>n.du.get(t)||null}),Jf(n).start(),n.gu.uu()}function Vx(n){return Zl(n)&&!Jf(n).No()&&n.du.size>0}function Zl(n){return 0===ut(n)._u.size}function nQ(n){n.yu=void 0}function Zve(n){return Hx.apply(this,arguments)}function Hx(){return Hx=I(function*(n){n.du.forEach((t,e)=>{Dx(n,t)})}),Hx.apply(this,arguments)}function Yve(n,t){return Fx.apply(this,arguments)}function Fx(){return Fx=I(function*(n,t){nQ(n),Vx(n)?(n.gu.hu(t),zx(n)):n.gu.set("Unknown")}),Fx.apply(this,arguments)}function Kve(n,t,e){return Bx.apply(this,arguments)}function Bx(){return Bx=I(function*(n,t,e){if(n.gu.set("Online"),t instanceof XK&&2===t.state&&t.cause)try{yield(r=I(function*(s,i){const o=i.cause;for(const c of i.targetIds)s.du.has(c)&&(yield s.remoteSyncer.rejectListen(c,o),s.du.delete(c),s.yu.removeTarget(c))}),function(s,i){return r.apply(this,arguments)})(n,t)}catch(r){qe("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),r),yield $M(n,r)}else if(t instanceof wM?n.yu.Gt(t):t instanceof KK?n.yu.Yt(t):n.yu.Wt(t),!e.isEqual(an.min()))try{const r=yield GX(n.localStore);e.compareTo(r)>=0&&(yield function(s,i){const o=s.yu.te(i);return o.targetChanges.forEach((c,u)=>{if(c.resumeToken.approximateByteSize()>0){const d=s.du.get(u);d&&s.du.set(u,d.withResumeToken(c.resumeToken,i))}}),o.targetMismatches.forEach(c=>{const u=s.du.get(c);if(!u)return;s.du.set(c,u.withResumeToken(gi.EMPTY_BYTE_STRING,u.snapshotVersion)),tQ(s,c);const d=new G0(u.target,c,1,u.sequenceNumber);Dx(s,d)}),s.remoteSyncer.applyRemoteEvent(o)}(n,e))}catch(r){qe("RemoteStore","Failed to raise snapshot:",r),yield $M(n,r)}var r}),Bx.apply(this,arguments)}function $M(n,t,e){return $x.apply(this,arguments)}function $x(){return $x=I(function*(n,t,e){if(!V0(t))throw t;n._u.add(1),yield Xf(n),n.gu.set("Offline"),e||(e=()=>GX(n.localStore)),n.asyncQueue.enqueueRetryable(I(function*(){qe("RemoteStore","Retrying IndexedDB access"),yield e(),n._u.delete(1),yield Yg(n)}))}),$x.apply(this,arguments)}function rQ(n,t){return t().catch(e=>$M(n,e,t))}function Qf(n){return Ux.apply(this,arguments)}function Ux(){return Ux=I(function*(n){const t=ut(n),e=j0(t);let r=t.fu.length>0?t.fu[t.fu.length-1].batchId:-1;for(;Xve(t);)try{const s=yield Rve(t.localStore,r);if(null===s){0===t.fu.length&&e.Fo();break}r=s.batchId,Qve(t,s)}catch(s){yield $M(t,s)}sQ(t)&&iQ(t)}),Ux.apply(this,arguments)}function Xve(n){return Zl(n)&&n.fu.length<10}function Qve(n,t){n.fu.push(t);const e=j0(n);e.ko()&&e.Yo&&e.Xo(t.mutations)}function sQ(n){return Zl(n)&&!j0(n).No()&&n.fu.length>0}function iQ(n){j0(n).start()}function Jve(n){return Gx.apply(this,arguments)}function Gx(){return Gx=I(function*(n){j0(n).eu()}),Gx.apply(this,arguments)}function eCe(n){return Wx.apply(this,arguments)}function Wx(){return Wx=I(function*(n){const t=j0(n);for(const e of n.fu)t.Xo(e.mutations)}),Wx.apply(this,arguments)}function tCe(n,t,e){return qx.apply(this,arguments)}function qx(){return qx=I(function*(n,t,e){const r=n.fu.shift(),s=px.from(r,t,e);yield rQ(n,()=>n.remoteSyncer.applySuccessfulWrite(s)),yield Qf(n)}),qx.apply(this,arguments)}function nCe(n,t){return jx.apply(this,arguments)}function jx(){return jx=I(function*(n,t){var e;t&&j0(n).Yo&&(yield(e=I(function*(r,s){if(WK(i=s.code)&&i!==Ae.ABORTED){const o=r.fu.shift();j0(r).Mo(),yield rQ(r,()=>r.remoteSyncer.rejectFailedWrite(o.batchId,s)),yield Qf(r)}var i}),function(r,s){return e.apply(this,arguments)})(n,t)),sQ(n)&&iQ(n)}),jx.apply(this,arguments)}function oQ(n,t){return Zx.apply(this,arguments)}function Zx(){return Zx=I(function*(n,t){const e=ut(n);e.asyncQueue.verifyOperationInProgress(),qe("RemoteStore","RemoteStore received new credentials");const r=Zl(e);e._u.add(3),yield Xf(e),r&&e.gu.set("Unknown"),yield e.remoteSyncer.handleCredentialChange(t),e._u.delete(3),yield Yg(e)}),Zx.apply(this,arguments)}function Kx(){return Kx=I(function*(n,t){const e=ut(n);t?(e._u.delete(2),yield Yg(e)):t||(e._u.add(2),yield Xf(e),e.gu.set("Unknown"))}),Kx.apply(this,arguments)}function Jf(n){return n.pu||(n.pu=function(t,e,r){const s=ut(t);return s.su(),new $ve(e,s.connection,s.authCredentials,s.appCheckCredentials,s.It,r)}(n.datastore,n.asyncQueue,{Yr:Zve.bind(null,n),Zr:Yve.bind(null,n),Wo:Kve.bind(null,n)}),n.wu.push(function(){var t=I(function*(e){e?(n.pu.Mo(),Vx(n)?zx(n):n.gu.set("Unknown")):(yield n.pu.stop(),nQ(n))});return function(e){return t.apply(this,arguments)}}())),n.pu}function j0(n){return n.Iu||(n.Iu=function(t,e,r){const s=ut(t);return s.su(),new Uve(e,s.connection,s.authCredentials,s.appCheckCredentials,s.It,r)}(n.datastore,n.asyncQueue,{Yr:Jve.bind(null,n),Zr:nCe.bind(null,n),tu:eCe.bind(null,n),Zo:tCe.bind(null,n)}),n.wu.push(function(){var t=I(function*(e){e?(n.Iu.Mo(),yield Qf(n)):(yield n.Iu.stop(),n.fu.length>0&&(qe("RemoteStore",`Stopping write stream with ${n.fu.length} pending writes`),n.fu=[]))});return function(e){return t.apply(this,arguments)}}())),n.Iu}class Xx{constructor(t,e,r,s,i){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new pi,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}static createAndSchedule(t,e,r,s,i){const o=Date.now()+r,c=new Xx(t,e,o,s,i);return c.start(r),c}start(t){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Ue(Ae.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(t=>this.deferred.resolve(t))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function ed(n,t){if(ws("AsyncQueue",`${t}: ${n}`),V0(n))return new Ue(Ae.UNAVAILABLE,`${t}: ${n}`);throw n}class td{constructor(t){this.comparator=t?(e,r)=>t(e,r)||at.comparator(e.key,r.key):(e,r)=>at.comparator(e.key,r.key),this.keyedMap=xg(),this.sortedSet=new ps(this.comparator)}static emptySet(t){return new td(t.comparator)}has(t){return null!=this.keyedMap.get(t)}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal((e,r)=>(t(e),!1))}add(t){const e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))}delete(t){const e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this}isEqual(t){if(!(t instanceof td)||this.size!==t.size)return!1;const e=this.sortedSet.getIterator(),r=t.sortedSet.getIterator();for(;e.hasNext();){const s=e.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const t=[];return this.forEach(e=>{t.push(e.toString())}),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"}copy(t,e){const r=new td;return r.comparator=this.comparator,r.keyedMap=t,r.sortedSet=e,r}}class aQ{constructor(){this.Tu=new ps(at.comparator)}track(t){const e=t.doc.key,r=this.Tu.get(e);r?0!==t.type&&3===r.type?this.Tu=this.Tu.insert(e,t):3===t.type&&1!==r.type?this.Tu=this.Tu.insert(e,{type:r.type,doc:t.doc}):2===t.type&&2===r.type?this.Tu=this.Tu.insert(e,{type:2,doc:t.doc}):2===t.type&&0===r.type?this.Tu=this.Tu.insert(e,{type:0,doc:t.doc}):1===t.type&&0===r.type?this.Tu=this.Tu.remove(e):1===t.type&&2===r.type?this.Tu=this.Tu.insert(e,{type:1,doc:r.doc}):0===t.type&&1===r.type?this.Tu=this.Tu.insert(e,{type:2,doc:t.doc}):wt():this.Tu=this.Tu.insert(e,t)}Eu(){const t=[];return this.Tu.inorderTraversal((e,r)=>{t.push(r)}),t}}class nd{constructor(t,e,r,s,i,o,c,u,d){this.query=t,this.docs=e,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=c,this.excludesMetadataChanges=u,this.hasCachedResults=d}static fromInitialDocuments(t,e,r,s,i){const o=[];return e.forEach(c=>{o.push({type:0,doc:c})}),new nd(t,e,td.emptySet(e),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&Ag(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const e=this.docChanges,r=t.docChanges;if(e.length!==r.length)return!1;for(let s=0;s<e.length;s++)if(e[s].type!==r[s].type||!e[s].doc.isEqual(r[s].doc))return!1;return!0}}class rCe{constructor(){this.Au=void 0,this.listeners=[]}}class sCe{constructor(){this.queries=new U0(t=>AK(t),Ag),this.onlineState="Unknown",this.Ru=new Set}}function Qx(n,t){return Jx.apply(this,arguments)}function Jx(){return Jx=I(function*(n,t){const e=ut(n),r=t.query;let s=!1,i=e.queries.get(r);if(i||(s=!0,i=new rCe),s)try{i.Au=yield e.onListen(r)}catch(o){const c=ed(o,`Initialization of query '${ix(t.query)}' failed`);return void t.onError(c)}e.queries.set(r,i),i.listeners.push(t),t.bu(e.onlineState),i.Au&&t.Pu(i.Au)&&nk(e)}),Jx.apply(this,arguments)}function ek(n,t){return tk.apply(this,arguments)}function tk(){return tk=I(function*(n,t){const e=ut(n),r=t.query;let s=!1;const i=e.queries.get(r);if(i){const o=i.listeners.indexOf(t);o>=0&&(i.listeners.splice(o,1),s=0===i.listeners.length)}if(s)return e.queries.delete(r),e.onUnlisten(r)}),tk.apply(this,arguments)}function iCe(n,t){const e=ut(n);let r=!1;for(const s of t){const o=e.queries.get(s.query);if(o){for(const c of o.listeners)c.Pu(s)&&(r=!0);o.Au=s}}r&&nk(e)}function oCe(n,t,e){const r=ut(n),s=r.queries.get(t);if(s)for(const i of s.listeners)i.onError(e);r.queries.delete(t)}function nk(n){n.Ru.forEach(t=>{t.next()})}class rk{constructor(t,e,r){this.query=t,this.vu=e,this.Vu=!1,this.Su=null,this.onlineState="Unknown",this.options=r||{}}Pu(t){if(!this.options.includeMetadataChanges){const r=[];for(const s of t.docChanges)3!==s.type&&r.push(s);t=new nd(t.query,t.docs,t.oldDocs,r,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let e=!1;return this.Vu?this.Du(t)&&(this.vu.next(t),e=!0):this.Cu(t,this.onlineState)&&(this.xu(t),e=!0),this.Su=t,e}onError(t){this.vu.error(t)}bu(t){this.onlineState=t;let e=!1;return this.Su&&!this.Vu&&this.Cu(this.Su,t)&&(this.xu(this.Su),e=!0),e}Cu(t,e){return!t.fromCache||(!this.options.Nu||!("Offline"!==e))&&(!t.docs.isEmpty()||t.hasCachedResults||"Offline"===e)}Du(t){return t.docChanges.length>0||!!(t.syncStateChanged||this.Su&&this.Su.hasPendingWrites!==t.hasPendingWrites)&&!0===this.options.includeMetadataChanges}xu(t){t=nd.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.Vu=!0,this.vu.next(t)}}class uQ{constructor(t){this.key=t}}class fQ{constructor(t){this.key=t}}class dQ{constructor(t,e){this.query=t,this.Uu=e,this.qu=null,this.hasCachedResults=!1,this.current=!1,this.Ku=In(),this.mutatedKeys=In(),this.Gu=IK(t),this.Qu=new td(this.Gu)}get ju(){return this.Uu}Wu(t,e){const r=e?e.zu:new aQ,s=e?e.Qu:this.Qu;let i=e?e.mutatedKeys:this.mutatedKeys,o=s,c=!1;const u="F"===this.query.limitType&&s.size===this.query.limit?s.last():null,d="L"===this.query.limitType&&s.size===this.query.limit?s.first():null;if(t.inorderTraversal((g,m)=>{const y=s.get(g),b=ox(this.query,m)?m:null,k=!!y&&this.mutatedKeys.has(y.key),$=!!b&&(b.hasLocalMutations||this.mutatedKeys.has(b.key)&&b.hasCommittedMutations);let K=!1;y&&b?y.data.isEqual(b.data)?k!==$&&(r.track({type:3,doc:b}),K=!0):this.Hu(y,b)||(r.track({type:2,doc:b}),K=!0,(u&&this.Gu(b,u)>0||d&&this.Gu(b,d)<0)&&(c=!0)):!y&&b?(r.track({type:0,doc:b}),K=!0):y&&!b&&(r.track({type:1,doc:y}),K=!0,(u||d)&&(c=!0)),K&&(b?(o=o.add(b),i=$?i.add(g):i.delete(g)):(o=o.delete(g),i=i.delete(g)))}),null!==this.query.limit)for(;o.size>this.query.limit;){const g="F"===this.query.limitType?o.last():o.first();o=o.delete(g.key),i=i.delete(g.key),r.track({type:1,doc:g})}return{Qu:o,zu:r,$i:c,mutatedKeys:i}}Hu(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations}applyChanges(t,e,r){const s=this.Qu;this.Qu=t.Qu,this.mutatedKeys=t.mutatedKeys;const i=t.zu.Eu();i.sort((d,g)=>function(m,y){const b=k=>{switch(k){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return wt()}};return b(m)-b(y)}(d.type,g.type)||this.Gu(d.doc,g.doc)),this.Ju(r);const o=e?this.Yu():[],c=0===this.Ku.size&&this.current?1:0,u=c!==this.qu;return this.qu=c,0!==i.length||u?{snapshot:new nd(this.query,t.Qu,s,i,t.mutatedKeys,0===c,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),Xu:o}:{Xu:o}}bu(t){return this.current&&"Offline"===t?(this.current=!1,this.applyChanges({Qu:this.Qu,zu:new aQ,mutatedKeys:this.mutatedKeys,$i:!1},!1)):{Xu:[]}}Zu(t){return!this.Uu.has(t)&&!!this.Qu.has(t)&&!this.Qu.get(t).hasLocalMutations}Ju(t){t&&(t.addedDocuments.forEach(e=>this.Uu=this.Uu.add(e)),t.modifiedDocuments.forEach(e=>{}),t.removedDocuments.forEach(e=>this.Uu=this.Uu.delete(e)),this.current=t.current)}Yu(){if(!this.current)return[];const t=this.Ku;this.Ku=In(),this.Qu.forEach(r=>{this.Zu(r.key)&&(this.Ku=this.Ku.add(r.key))});const e=[];return t.forEach(r=>{this.Ku.has(r)||e.push(new fQ(r))}),this.Ku.forEach(r=>{t.has(r)||e.push(new uQ(r))}),e}tc(t){this.Uu=t.Hi,this.Ku=In();const e=this.Wu(t.documents);return this.applyChanges(e,!0)}ec(){return nd.fromInitialDocuments(this.query,this.Qu,this.mutatedKeys,0===this.qu,this.hasCachedResults)}}class lCe{constructor(t,e,r){this.query=t,this.targetId=e,this.view=r}}class uCe{constructor(t){this.key=t,this.nc=!1}}class fCe{constructor(t,e,r,s,i,o){this.localStore=t,this.remoteStore=e,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.sc={},this.ic=new U0(c=>AK(c),Ag),this.rc=new Map,this.oc=new Set,this.uc=new ps(at.comparator),this.cc=new Map,this.ac=new Cx,this.hc={},this.lc=new Map,this.fc=c5.vn(),this.onlineState="Unknown",this.dc=void 0}get isPrimaryClient(){return!0===this.dc}}function dCe(n,t){return sk.apply(this,arguments)}function sk(){return sk=I(function*(n,t){const e=bk(n);let r,s;const i=e.ic.get(t);if(i)r=i.targetId,e.sharedClientState.addLocalQueryTarget(r),s=i.view.ec();else{const o=yield Yf(e.localStore,No(t));e.isPrimaryClient&&BM(e.remoteStore,o);const c=e.sharedClientState.addLocalQueryTarget(o.targetId);r=o.targetId,s=yield ik(e,t,r,"current"===c,o.resumeToken)}return s}),sk.apply(this,arguments)}function ik(n,t,e,r,s){return ok.apply(this,arguments)}function ok(){return ok=I(function*(n,t,e,r,s){n._c=(m,y,b)=>{return(k=I(function*($,K,oe,ye){let te=K.view.Wu(oe);te.$i&&(te=yield zM($.localStore,K.query,!1).then(({documents:Qe})=>K.view.Wu(Qe,te)));const Le=ye&&ye.targetChanges.get(K.targetId),Ge=K.view.applyChanges(te,$.isPrimaryClient,Le);return mk($,K.targetId,Ge.Xu),Ge.snapshot}),function($,K,oe,ye){return k.apply(this,arguments)})(n,m,y,b);var k};const i=yield zM(n.localStore,t,!0),o=new dQ(t,i.Hi),c=o.Wu(i.documents),u=Rg.createSynthesizedTargetChangeForCurrentChange(e,r&&"Offline"!==n.onlineState,s),d=o.applyChanges(c,n.isPrimaryClient,u);mk(n,e,d.Xu);const g=new lCe(t,e,o);return n.ic.set(t,g),n.rc.has(e)?n.rc.get(e).push(t):n.rc.set(e,[t]),d.snapshot}),ok.apply(this,arguments)}function hCe(n,t){return ak.apply(this,arguments)}function ak(){return ak=I(function*(n,t){const e=ut(n),r=e.ic.get(t),s=e.rc.get(r.targetId);if(s.length>1)return e.rc.set(r.targetId,s.filter(i=>!Ag(i,t))),void e.ic.delete(t);e.isPrimaryClient?(e.sharedClientState.removeLocalQueryTarget(r.targetId),e.sharedClientState.isActiveQueryTarget(r.targetId)||(yield Kf(e.localStore,r.targetId,!1).then(()=>{e.sharedClientState.clearQueryState(r.targetId),Kg(e.remoteStore,r.targetId),rd(e,r.targetId)}).catch(z0))):(rd(e,r.targetId),yield Kf(e.localStore,r.targetId,!0))}),ak.apply(this,arguments)}function ck(){return ck=I(function*(n,t,e){const r=Ok(n);try{const s=yield function(i,o){const c=ut(i),u=ts.now(),d=o.reduce((y,b)=>y.add(b.key),In());let g,m;return c.persistence.runTransaction("Locally write mutations","readwrite",y=>{let b=la(),k=In();return c.Gi.getEntries(y,d).next($=>{b=$,b.forEach((K,oe)=>{oe.isValidDocument()||(k=k.add(K))})}).next(()=>c.localDocuments.getOverlayedDocuments(y,b)).next($=>{g=$;const K=[];for(const oe of o){const ye=M_e(oe,g.get(oe.key).overlayedDocument);null!=ye&&K.push(new jl(oe.key,ye,yK(ye.value.mapValue),Hr.exists(!0)))}return c.mutationQueue.addMutationBatch(y,u,K,o)}).next($=>{m=$;const K=$.applyToLocalDocumentSet(g,k);return c.documentOverlayCache.saveOverlays(y,$.batchId,K)})}).then(()=>({batchId:m.batchId,changes:ZK(g)}))}(r.localStore,t);r.sharedClientState.addPendingMutation(s.batchId),function(i,o,c){let u=i.hc[i.currentUser.toKey()];u||(u=new ps(yn)),u=u.insert(o,c),i.hc[i.currentUser.toKey()]=u}(r,s.batchId,e),yield Yl(r,s.changes),yield Qf(r.remoteStore)}catch(s){const i=ed(s,"Failed to persist write");e.reject(i)}}),ck.apply(this,arguments)}function hQ(n,t){return lk.apply(this,arguments)}function lk(){return lk=I(function*(n,t){const e=ut(n);try{const r=yield Lve(e.localStore,t);t.targetChanges.forEach((s,i)=>{const o=e.cc.get(i);o&&(on(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.nc=!0:s.modifiedDocuments.size>0?on(o.nc):s.removedDocuments.size>0&&(on(o.nc),o.nc=!1))}),yield Yl(e,r,t)}catch(r){yield z0(r)}}),lk.apply(this,arguments)}function pQ(n,t,e){const r=ut(n);if(r.isPrimaryClient&&0===e||!r.isPrimaryClient&&1===e){const s=[];r.ic.forEach((i,o)=>{const c=o.view.bu(t);c.snapshot&&s.push(c.snapshot)}),function(i,o){const c=ut(i);c.onlineState=o;let u=!1;c.queries.forEach((d,g)=>{for(const m of g.listeners)m.bu(o)&&(u=!0)}),u&&nk(c)}(r.eventManager,t),s.length&&r.sc.Wo(s),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}function gCe(n,t,e){return uk.apply(this,arguments)}function uk(){return uk=I(function*(n,t,e){const r=ut(n);r.sharedClientState.updateQueryState(t,"rejected",e);const s=r.cc.get(t),i=s&&s.key;if(i){let o=new ps(at.comparator);o=o.insert(i,pr.newNoDocument(i,an.min()));const c=In().add(i),u=new Lg(an.min(),new Map,new er(yn),o,c);yield hQ(r,u),r.uc=r.uc.remove(i),r.cc.delete(t),_k(r)}else yield Kf(r.localStore,t,!1).then(()=>rd(r,t,e)).catch(z0)}),uk.apply(this,arguments)}function mCe(n,t){return fk.apply(this,arguments)}function fk(){return fk=I(function*(n,t){const e=ut(n),r=t.batch.batchId;try{const s=yield kve(e.localStore,t);gk(e,r,null),pk(e,r),e.sharedClientState.updateMutationState(r,"acknowledged"),yield Yl(e,s)}catch(s){yield z0(s)}}),fk.apply(this,arguments)}function _Ce(n,t,e){return dk.apply(this,arguments)}function dk(){return dk=I(function*(n,t,e){const r=ut(n);try{const s=yield function(i,o){const c=ut(i);return c.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let d;return c.mutationQueue.lookupMutationBatch(u,o).next(g=>(on(null!==g),d=g.keys(),c.mutationQueue.removeMutationBatch(u,g))).next(()=>c.mutationQueue.performConsistencyCheck(u)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(u,d,o)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,d)).next(()=>c.localDocuments.getDocuments(u,d))})}(r.localStore,t);gk(r,t,e),pk(r,t),r.sharedClientState.updateMutationState(t,"rejected",e),yield Yl(r,s)}catch(s){yield z0(s)}}),dk.apply(this,arguments)}function pk(n,t){(n.lc.get(t)||[]).forEach(e=>{e.resolve()}),n.lc.delete(t)}function gk(n,t,e){const r=ut(n);let s=r.hc[r.currentUser.toKey()];if(s){const i=s.get(t);i&&(e?i.reject(e):i.resolve(),s=s.remove(t)),r.hc[r.currentUser.toKey()]=s}}function rd(n,t,e=null){n.sharedClientState.removeLocalQueryTarget(t);for(const r of n.rc.get(t))n.ic.delete(r),e&&n.sc.wc(r,e);n.rc.delete(t),n.isPrimaryClient&&n.ac.ls(t).forEach(r=>{n.ac.containsKey(r)||gQ(n,r)})}function gQ(n,t){n.oc.delete(t.path.canonicalString());const e=n.uc.get(t);null!==e&&(Kg(n.remoteStore,e),n.uc=n.uc.remove(t),n.cc.delete(e),_k(n))}function mk(n,t,e){for(const r of e)r instanceof uQ?(n.ac.addReference(r.key,t),CCe(n,r)):r instanceof fQ?(qe("SyncEngine","Document no longer in limbo: "+r.key),n.ac.removeReference(r.key,t),n.ac.containsKey(r.key)||gQ(n,r.key)):wt()}function CCe(n,t){const e=t.key,r=e.path.canonicalString();n.uc.get(e)||n.oc.has(r)||(qe("SyncEngine","New document in limbo: "+e),n.oc.add(r),_k(n))}function _k(n){for(;n.oc.size>0&&n.uc.size<n.maxConcurrentLimboResolutions;){const t=n.oc.values().next().value;n.oc.delete(t);const e=new at(g1.fromString(t)),r=n.fc.next();n.cc.set(r,new uCe(e)),n.uc=n.uc.insert(e,r),BM(n.remoteStore,new G0(No(Hf(e.path)),r,2,ca.at))}}function Yl(n,t,e){return vk.apply(this,arguments)}function vk(){return vk=I(function*(n,t,e){const r=ut(n),s=[],i=[],o=[];var c;r.ic.isEmpty()||(r.ic.forEach((c,u)=>{o.push(r._c(u,t,e).then(d=>{if((d||e)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(u.targetId,d?.fromCache?"not-current":"current"),d){s.push(d);const g=Sx.Ci(u.targetId,d);i.push(g)}}))}),yield Promise.all(o),r.sc.Wo(s),yield(c=I(function*(u,d){const g=ut(u);try{yield g.persistence.runTransaction("notifyLocalViewChanges","readwrite",m=>Se.forEach(d,y=>Se.forEach(y.Si,b=>g.persistence.referenceDelegate.addReference(m,y.targetId,b)).next(()=>Se.forEach(y.Di,b=>g.persistence.referenceDelegate.removeReference(m,y.targetId,b)))))}catch(m){if(!V0(m))throw m;qe("LocalStore","Failed to update sequence numbers: "+m)}for(const m of d){const y=m.targetId;if(!m.fromCache){const b=g.Ui.get(y),$=b.withLastLimboFreeSnapshotVersion(b.snapshotVersion);g.Ui=g.Ui.insert(y,$)}}}),function(u,d){return c.apply(this,arguments)})(r.localStore,i))}),vk.apply(this,arguments)}function yCe(n,t){return Ck.apply(this,arguments)}function Ck(){return Ck=I(function*(n,t){const e=ut(n);if(!e.currentUser.isEqual(t)){qe("SyncEngine","User change. New user:",t.toKey());const r=yield UX(e.localStore,t);e.currentUser=t,(s=e).lc.forEach(o=>{o.forEach(c=>{c.reject(new Ue(Ae.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),s.lc.clear(),e.sharedClientState.handleUserChange(t,r.removedBatchIds,r.addedBatchIds),yield Yl(e,r.ji)}var s}),Ck.apply(this,arguments)}function ECe(n,t){const e=ut(n),r=e.cc.get(t);if(r&&r.nc)return In().add(r.key);{let s=In();const i=e.rc.get(t);if(!i)return s;for(const o of i){const c=e.ic.get(o);s=s.unionWith(c.view.ju)}return s}}function bk(n){const t=ut(n);return t.remoteStore.remoteSyncer.applyRemoteEvent=hQ.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=ECe.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=gCe.bind(null,t),t.sc.Wo=iCe.bind(null,t.eventManager),t.sc.wc=oCe.bind(null,t.eventManager),t}function Ok(n){const t=ut(n);return t.remoteStore.remoteSyncer.applySuccessfulWrite=mCe.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=_Ce.bind(null,t),t}class NCe{constructor(){this.synchronizeTabs=!1}initialize(t){var e=this;return I(function*(){e.It=Zg(t.databaseInfo.databaseId),e.sharedClientState=e.gc(t),e.persistence=e.yc(t),yield e.persistence.start(),e.localStore=e.Ic(t),e.gcScheduler=e.Tc(t,e.localStore),e.indexBackfillerScheduler=e.Ec(t,e.localStore)})()}Tc(t,e){return null}Ec(t,e){return null}Ic(t){return function $X(n,t,e,r){return new xve(n,t,e,r)}(this.persistence,new BX,t.initialUser,this.It)}yc(t){return new HX(RM.Bs,this.It)}gc(t){return new XX}terminate(){var t=this;return I(function*(){t.gcScheduler&&t.gcScheduler.stop(),yield t.sharedClientState.shutdown(),yield t.persistence.shutdown()})()}}class Ak{initialize(t,e){var r=this;return I(function*(){r.localStore||(r.localStore=t.localStore,r.sharedClientState=t.sharedClientState,r.datastore=r.createDatastore(e),r.remoteStore=r.createRemoteStore(e),r.eventManager=r.createEventManager(e),r.syncEngine=r.createSyncEngine(e,!t.synchronizeTabs),r.sharedClientState.onlineStateHandler=s=>pQ(r.syncEngine,s,1),r.remoteStore.remoteSyncer.handleCredentialChange=yCe.bind(null,r.syncEngine),yield function Yx(n,t){return Kx.apply(this,arguments)}(r.remoteStore,r.syncEngine.isPrimaryClient))})()}createEventManager(t){return new sCe}createDatastore(t){const e=Zg(t.databaseInfo.databaseId),r=new Bve(t.databaseInfo);return new Gve(t.authCredentials,t.appCheckCredentials,r,e)}createRemoteStore(t){return e=this.localStore,r=this.datastore,s=t.asyncQueue,i=c=>pQ(this.syncEngine,c,0),o=QX.C()?new QX:new Vve,new jve(e,r,s,i,o);var e,r,s,i,o}createSyncEngine(t,e){return function(r,s,i,o,c,u,d){const g=new fCe(r,s,i,o,c,u);return d&&(g.dc=!0),g}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)}terminate(){return(t=I(function*(e){const r=ut(e);qe("RemoteStore","RemoteStore shutting down."),r._u.add(5),yield Xf(r),r.mu.shutdown(),r.gu.set("Unknown")}),function(e){return t.apply(this,arguments)})(this.remoteStore);var t}}function Nk(n,t,e){if(!e)throw new Ue(Ae.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${t}.`)}function vQ(n){if(!at.isDocumentKey(n))throw new Ue(Ae.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function CQ(n){if(at.isDocumentKey(n))throw new Ue(Ae.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function UM(n){if(void 0===n)return"undefined";if(null===n)return"null";if("string"==typeof n)return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if("number"==typeof n||"boolean"==typeof n)return""+n;if("object"==typeof n){if(n instanceof Array)return"an array";{const t=(e=n).constructor?e.constructor.name:null;return t?`a custom ${t} object`:"an object"}}var e;return"function"==typeof n?"a function":wt()}function l1(n,t){if("_delegate"in n&&(n=n._delegate),!(n instanceof t)){if(t.name===n.constructor.name)throw new Ue(Ae.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const e=UM(n);throw new Ue(Ae.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${e}`)}}return n}const EQ=new Map;class MQ{constructor(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Ue(Ae.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Ue(Ae.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.useFetchStreams=!!t.useFetchStreams,function kCe(n,t,e,r){if(!0===t&&!0===r)throw new Ue(Ae.INVALID_ARGUMENT,`${n} and ${e} cannot be used together.`)}("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class Xg{constructor(t,e,r,s){this._authCredentials=t,this._appCheckCredentials=e,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new MQ({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new Ue(Ae.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(t){if(this._settingsFrozen)throw new Ue(Ae.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new MQ(t),void 0!==t.credentials&&(this._authCredentials=function(e){if(!e)return new Bme;switch(e.type){case"gapi":return new Wme(e.client,e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new Ue(Ae.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const e=EQ.get(t);e&&(qe("ComponentProvider","Removing Datastore"),EQ.delete(t),e.terminate())}(this),Promise.resolve()}}function SQ(n,t,e,r={}){var s;const i=(n=l1(n,Xg))._getSettings();if("firestore.googleapis.com"!==i.host&&i.host!==t&&Lf("Host has been set in both settings() and useEmulator(), emulator host will be used"),n._setSettings(Object.assign(Object.assign({},i),{host:`${t}:${e}`,ssl:!1})),r.mockUserToken){let o,c;if("string"==typeof r.mockUserToken)o=r.mockUserToken,c=Ri.MOCK_USER;else{o=function Spe(n,t){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r=t||"demo-project",s=n.iat||0,i=n.sub||n.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},n);return[xE(JSON.stringify({alg:"none",type:"JWT"})),xE(JSON.stringify(o)),""].join(".")}(r.mockUserToken,null===(s=n._app)||void 0===s?void 0:s.options.projectId);const u=r.mockUserToken.sub||r.mockUserToken.user_id;if(!u)throw new Ue(Ae.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new Ri(u)}n._authCredentials=new $me(new tK(o,c))}}class Os{constructor(t,e,r){this.converter=e,this._key=r,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new k4(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new Os(this.firestore,t,this._key)}}class eo{constructor(t,e,r){this.converter=e,this._query=r,this.type="query",this.firestore=t}withConverter(t){return new eo(this.firestore,t,this._query)}}class k4 extends eo{constructor(t,e,r){super(t,e,Hf(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new Os(this.firestore,null,new at(t))}withConverter(t){return new k4(this.firestore,t,this._path)}}function LCe(n,t,...e){if(n=es(n),Nk("collection","path",t),n instanceof Xg){const r=g1.fromString(t,...e);return CQ(r),new k4(n,null,r)}{if(!(n instanceof Os||n instanceof k4))throw new Ue(Ae.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(g1.fromString(t,...e));return CQ(r),new k4(n.firestore,null,r)}}function PQ(n,t,...e){if(n=es(n),1===arguments.length&&(t=rK.R()),Nk("doc","path",t),n instanceof Xg){const r=g1.fromString(t,...e);return vQ(r),new Os(n,null,new at(r))}{if(!(n instanceof Os||n instanceof k4))throw new Ue(Ae.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(g1.fromString(t,...e));return vQ(r),new Os(n.firestore,n instanceof k4?n.converter:null,new at(r))}}class GM{constructor(t){this.observer=t,this.muted=!1}next(t){this.observer.next&&this.Rc(this.observer.next,t)}error(t){this.observer.error?this.Rc(this.observer.error,t):ws("Uncaught Error in snapshot listener:",t.toString())}bc(){this.muted=!0}Rc(t,e){this.muted||setTimeout(()=>{this.muted||t(e)},0)}}class FCe{constructor(t,e,r,s){var i=this;this.authCredentials=t,this.appCheckCredentials=e,this.asyncQueue=r,this.databaseInfo=s,this.user=Ri.UNAUTHENTICATED,this.clientId=rK.R(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,function(){var o=I(function*(c){qe("FirestoreClient","Received user=",c.uid),yield i.authCredentialListener(c),i.user=c});return function(c){return o.apply(this,arguments)}}()),this.appCheckCredentials.start(r,o=>(qe("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}getConfiguration(){var t=this;return I(function*(){return{asyncQueue:t.asyncQueue,databaseInfo:t.databaseInfo,clientId:t.clientId,authCredentials:t.authCredentials,appCheckCredentials:t.appCheckCredentials,initialUser:t.user,maxConcurrentLimboResolutions:100}})()}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Ue(Ae.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){var t=this;this.asyncQueue.enterRestrictedMode();const e=new pi;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(I(function*(){try{t.onlineComponents&&(yield t.onlineComponents.terminate()),t.offlineComponents&&(yield t.offlineComponents.terminate()),t.authCredentials.shutdown(),t.appCheckCredentials.shutdown(),e.resolve()}catch(r){const s=ed(r,"Failed to shutdown persistence");e.reject(s)}})),e.promise}}function bQ(n,t){return Ik.apply(this,arguments)}function Ik(){return Ik=I(function*(n,t){n.asyncQueue.verifyOperationInProgress(),qe("FirestoreClient","Initializing OfflineComponentProvider");const e=yield n.getConfiguration();yield t.initialize(e);let r=e.initialUser;n.setCredentialChangeListener(function(){var s=I(function*(i){r.isEqual(i)||(yield UX(t.localStore,i),r=i)});return function(i){return s.apply(this,arguments)}}()),t.persistence.setDatabaseDeletedListener(()=>n.terminate()),n.offlineComponents=t}),Ik.apply(this,arguments)}function OQ(n,t){return xk.apply(this,arguments)}function xk(){return xk=I(function*(n,t){n.asyncQueue.verifyOperationInProgress();const e=yield kk(n);qe("FirestoreClient","Initializing OnlineComponentProvider");const r=yield n.getConfiguration();yield t.initialize(e,r),n.setCredentialChangeListener(s=>oQ(t.remoteStore,s)),n.setAppCheckTokenChangeListener((s,i)=>oQ(t.remoteStore,i)),n.onlineComponents=t}),xk.apply(this,arguments)}function kk(n){return Lk.apply(this,arguments)}function Lk(){return Lk=I(function*(n){return n.offlineComponents||(qe("FirestoreClient","Using default OfflineComponentProvider"),yield bQ(n,new NCe)),n.offlineComponents}),Lk.apply(this,arguments)}function WM(n){return Rk.apply(this,arguments)}function Rk(){return Rk=I(function*(n){return n.onlineComponents||(qe("FirestoreClient","Using default OnlineComponentProvider"),yield OQ(n,new Ak)),n.onlineComponents}),Rk.apply(this,arguments)}function sd(n){return Vk.apply(this,arguments)}function Vk(){return Vk=I(function*(n){const t=yield WM(n),e=t.eventManager;return e.onListen=dCe.bind(null,t.syncEngine),e.onUnlisten=hCe.bind(null,t.syncEngine),e}),Vk.apply(this,arguments)}class ZCe{constructor(){this.Bc=Promise.resolve(),this.Lc=[],this.Uc=!1,this.qc=[],this.Kc=null,this.Gc=!1,this.Qc=!1,this.jc=[],this.xo=new xx(this,"async_queue_retry"),this.Wc=()=>{const e=FM();e&&qe("AsyncQueue","Visibility state changed to "+e.visibilityState),this.xo.Po()};const t=FM();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Wc)}get isShuttingDown(){return this.Uc}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.zc(),this.Hc(t)}enterRestrictedMode(t){if(!this.Uc){this.Uc=!0,this.Qc=t||!1;const e=FM();e&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this.Wc)}}enqueue(t){if(this.zc(),this.Uc)return new Promise(()=>{});const e=new pi;return this.Hc(()=>this.Uc&&this.Qc?Promise.resolve():(t().then(e.resolve,e.reject),e.promise)).then(()=>e.promise)}enqueueRetryable(t){this.enqueueAndForget(()=>(this.Lc.push(t),this.Jc()))}Jc(){var t=this;return I(function*(){if(0!==t.Lc.length){try{yield t.Lc[0](),t.Lc.shift(),t.xo.reset()}catch(e){if(!V0(e))throw e;qe("AsyncQueue","Operation failed with retryable error: "+e)}t.Lc.length>0&&t.xo.Ro(()=>t.Jc())}})()}Hc(t){const e=this.Bc.then(()=>(this.Gc=!0,t().catch(r=>{throw this.Kc=r,this.Gc=!1,ws("INTERNAL UNHANDLED ERROR: ",function(i){let o=i.message||"";return i.stack&&(o=i.stack.includes(i.message)?i.stack:i.message+"\n"+i.stack),o}(r)),r}).then(r=>(this.Gc=!1,r))));return this.Bc=e,e}enqueueAfterDelay(t,e,r){this.zc(),this.jc.indexOf(t)>-1&&(e=0);const s=Xx.createAndSchedule(this,t,e,r,i=>this.Yc(i));return this.qc.push(s),s}zc(){this.Kc&&wt()}verifyOperationInProgress(){}Xc(){var t=this;return I(function*(){let e;do{e=t.Bc,yield e}while(e!==t.Bc)})()}Zc(t){for(const e of this.qc)if(e.timerId===t)return!0;return!1}ta(t){return this.Xc().then(()=>{this.qc.sort((e,r)=>e.targetTimeMs-r.targetTimeMs);for(const e of this.qc)if(e.skipDelay(),"all"!==t&&e.timerId===t)break;return this.Xc()})}ea(t){this.jc.push(t)}Yc(t){const e=this.qc.indexOf(t);this.qc.splice(e,1)}}function Hk(n){return function(t,e){if("object"!=typeof t||null===t)return!1;const r=t;for(const s of["next","error","complete"])if(s in r&&"function"==typeof r[s])return!0;return!1}(n)}class Pr extends Xg{constructor(t,e,r,s){super(t,e,r,s),this.type="firestore",this._queue=new ZCe,this._persistenceKey=s?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||kQ(this),this._firestoreClient.terminate()}}function KCe(n,t){const r="string"==typeof n?n:t||"(default)",s=bf("object"==typeof n?n:nI(),"firestore").getImmediate({identifier:r});if(!s._initialized){const i=(n=>{const t=EZ("firestore");if(!t)return;const e=t.lastIndexOf(":");if(e<=0||e+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const r=parseInt(t.substring(e+1),10);return"["===t[0]?[t.substring(1,e-1),r]:[t.substring(0,e),r]})();i&&SQ(s,...i)}return s}function js(n){return n._firestoreClient||kQ(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function kQ(n){var t;const e=n._freezeSettings(),r=(i=(null===(t=n._app)||void 0===t?void 0:t.options.appId)||"",new r_e(n._databaseId,i,n._persistenceKey,(c=e).host,c.ssl,c.experimentalForceLongPolling,c.experimentalAutoDetectLongPolling,c.useFetchStreams));var i,c;n._firestoreClient=new FCe(n._authCredentials,n._appCheckCredentials,n._queue,r)}class u5{constructor(t){this._byteString=t}static fromBase64String(t){try{return new u5(gi.fromBase64String(t))}catch(e){throw new Ue(Ae.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(t){return new u5(gi.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}}class id{constructor(...t){for(let e=0;e<t.length;++e)if(0===t[e].length)throw new Ue(Ae.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new bs(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}class jM{constructor(t){this._methodName=t}}class Fk{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new Ue(Ae.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new Ue(Ae.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(t){return yn(this._lat,t._lat)||yn(this._long,t._long)}}const XCe=/^__.*__$/;class QCe{constructor(t,e,r){this.data=t,this.fieldMask=e,this.fieldTransforms=r}toMutation(t,e){return null!==this.fieldMask?new jl(t,this.data,this.fieldMask,e,this.fieldTransforms):new Uf(t,this.data,e,this.fieldTransforms)}}class DQ{constructor(t,e,r){this.data=t,this.fieldMask=e,this.fieldTransforms=r}toMutation(t,e){return new jl(t,this.data,this.fieldMask,e,this.fieldTransforms)}}function zQ(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw wt()}}class ZM{constructor(t,e,r,s,i,o){this.settings=t,this.databaseId=e,this.It=r,this.ignoreUndefinedProperties=s,void 0===i&&this.na(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get sa(){return this.settings.sa}ia(t){return new ZM(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.It,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ra(t){var e;const r=null===(e=this.path)||void 0===e?void 0:e.child(t),s=this.ia({path:r,oa:!1});return s.ua(t),s}ca(t){var e;const r=null===(e=this.path)||void 0===e?void 0:e.child(t),s=this.ia({path:r,oa:!1});return s.na(),s}aa(t){return this.ia({path:void 0,oa:!0})}ha(t){return KM(t,this.settings.methodName,this.settings.la||!1,this.path,this.settings.fa)}contains(t){return void 0!==this.fieldMask.find(e=>t.isPrefixOf(e))||void 0!==this.fieldTransforms.find(e=>t.isPrefixOf(e.field))}na(){if(this.path)for(let t=0;t<this.path.length;t++)this.ua(this.path.get(t))}ua(t){if(0===t.length)throw this.ha("Document fields must not be empty");if(zQ(this.sa)&&XCe.test(t))throw this.ha('Document fields cannot begin and end with "__"')}}class JCe{constructor(t,e,r){this.databaseId=t,this.ignoreUndefinedProperties=e,this.It=r||Zg(t)}da(t,e,r,s=!1){return new ZM({sa:t,methodName:e,fa:r,path:bs.emptyPath(),oa:!1,la:s},this.databaseId,this.It,this.ignoreUndefinedProperties)}}function od(n){const t=n._freezeSettings(),e=Zg(n._databaseId);return new JCe(n._databaseId,!!t.ignoreUndefinedProperties,e)}function Bk(n,t,e,r,s,i={}){const o=n.da(i.merge||i.mergeFields?2:0,t,e,s);Uk("Data must be an object, but it was:",o,r);const c=$Q(r,o);let u,d;if(i.merge)u=new Ga(o.fieldMask),d=o.fieldTransforms;else if(i.mergeFields){const g=[];for(const m of i.mergeFields){const y=Gk(t,m,e);if(!o.contains(y))throw new Ue(Ae.INVALID_ARGUMENT,`Field '${y}' is specified in your field mask but missing from your input data.`);GQ(g,y)||g.push(y)}u=new Ga(g),d=o.fieldTransforms.filter(m=>u.covers(m.field))}else u=null,d=o.fieldTransforms;return new QCe(new M2(c),u,d)}class Qg extends jM{_toFieldTransform(t){if(2!==t.sa)throw t.ha(1===t.sa?`${this._methodName}() can only appear at the top level of your update data`:`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return t.fieldMask.push(t.path),null}isEqual(t){return t instanceof Qg}}class $k extends jM{_toFieldTransform(t){return new Ng(t.path,new Bf)}isEqual(t){return t instanceof $k}}function f5(n,t){if(UQ(n=es(n)))return Uk("Unsupported field value:",t,n),$Q(n,t);if(n instanceof jM)return function(e,r){if(!zQ(r.sa))throw r.ha(`${e._methodName}() can only be used with update() and set()`);if(!r.path)throw r.ha(`${e._methodName}() is not currently supported inside arrays`);const s=e._toFieldTransform(r);s&&r.fieldTransforms.push(s)}(n,t),null;if(void 0===n&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),n instanceof Array){if(t.settings.oa&&4!==t.sa)throw t.ha("Nested arrays are not supported");return function(e,r){const s=[];let i=0;for(const o of e){let c=f5(o,r.aa(i));null==c&&(c={nullValue:"NULL_VALUE"}),s.push(c),i++}return{arrayValue:{values:s}}}(n,t)}return function(e,r){if(null===(e=es(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return LK(r.It,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const s=ts.fromDate(e);return{timestampValue:Dg(r.It,s)}}if(e instanceof ts){const s=new ts(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:Dg(r.It,s)}}if(e instanceof Fk)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof u5)return{bytesValue:tX(r.It,e._byteString)};if(e instanceof Os){const s=r.databaseId,i=e.firestore._databaseId;if(!i.isEqual(s))throw r.ha(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:cx(e.firestore._databaseId||r.databaseId,e._key.path)}}throw r.ha(`Unsupported field value: ${UM(e)}`)}(n,t)}function $Q(n,t){const e={};return uK(n)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Zu(n,(r,s)=>{const i=f5(s,t.ra(r));null!=i&&(e[r]=i)}),{mapValue:{fields:e}}}function UQ(n){return!("object"!=typeof n||null===n||n instanceof Array||n instanceof Date||n instanceof ts||n instanceof Fk||n instanceof u5||n instanceof Os||n instanceof jM)}function Uk(n,t,e){if(!UQ(e)||"object"!=typeof(r=e)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r)){const r=UM(e);throw t.ha("an object"===r?n+" a custom object":n+" "+r)}var r}function Gk(n,t,e){if((t=es(t))instanceof id)return t._internalPath;if("string"==typeof t)return YM(n,t);throw KM("Field path arguments must be of type string or ",n,!1,void 0,e)}const rye=new RegExp("[~\\*/\\[\\]]");function YM(n,t,e){if(t.search(rye)>=0)throw KM(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,e);try{return new id(...t.split("."))._internalPath}catch{throw KM(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,e)}}function KM(n,t,e,r,s){const i=r&&!r.isEmpty(),o=void 0!==s;let c=`Function ${t}() called with invalid data`;e&&(c+=" (via `toFirestore()`)"),c+=". ";let u="";return(i||o)&&(u+=" (found",i&&(u+=` in field ${r}`),o&&(u+=` in document ${s}`),u+=")"),new Ue(Ae.INVALID_ARGUMENT,c+n+u)}function GQ(n,t){return n.some(e=>e.isEqual(t))}class Wk{constructor(t,e,r,s,i){this._firestore=t,this._userDataWriter=e,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Os(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const t=new sye(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const e=this._document.data.field(XM("DocumentSnapshot.get",t));if(null!==e)return this._userDataWriter.convertValue(e)}}}class sye extends Wk{data(){return super.data()}}function XM(n,t){return"string"==typeof t?YM(n,t):t instanceof id?t._internalPath:t._delegate._internalPath}function WQ(n){if("L"===n.limitType&&0===n.explicitOrderBy.length)throw new Ue(Ae.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class qk{}function iye(n,...t){for(const e of t)n=e._apply(n);return n}class oye extends qk{constructor(t,e,r){super(),this.ma=t,this.ga=e,this.ya=r,this.type="where"}_apply(t){const e=od(t.firestore),r=function(s,i,o,c,u,d,g){let m;if(u.isKeyField()){if("array-contains"===d||"array-contains-any"===d)throw new Ue(Ae.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if("in"===d||"not-in"===d){XQ(g,d);const b=[];for(const k of g)b.push(KQ(c,s,k));m={arrayValue:{values:b}}}else m=KQ(c,s,g)}else"in"!==d&&"not-in"!==d&&"array-contains-any"!==d||XQ(g,d),m=function BQ(n,t,e,r=!1){return f5(e,n.da(r?4:3,t))}(o,"where",g,"in"===d||"not-in"===d);const y=S2.create(u,d,m);return function(b,k){if(k.dt()){const K=rx(b);if(null!==K&&!K.isEqual(k.field))throw new Ue(Ae.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${K.toString()}' and '${k.field.toString()}'`);const oe=nx(b);null!==oe&&QQ(0,k.field,oe)}const $=function(K,oe){for(const ye of K.filters)if(oe.indexOf(ye.op)>=0)return ye.op;return null}(b,function(K){switch(K){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(k.op));if(null!==$)throw new Ue(Ae.INVALID_ARGUMENT,$===k.op?`Invalid query. You cannot use more than one '${k.op.toString()}' filter.`:`Invalid query. You cannot use '${k.op.toString()}' filters with '${$.toString()}' filters.`)}(s,y),y}(t._query,0,e,t.firestore._databaseId,this.ma,this.ga,this.ya);return new eo(t.firestore,t.converter,function(s,i){const o=s.filters.concat([i]);return new ql(s.path,s.collectionGroup,s.explicitOrderBy.slice(),o,s.limit,s.limitType,s.startAt,s.endAt)}(t._query,r))}}function aye(n,t,e){const r=t,s=XM("where",n);return new oye(s,r,e)}class cye extends qk{constructor(t,e){super(),this.ma=t,this.pa=e,this.type="orderBy"}_apply(t){const e=function(r,s,i){if(null!==r.startAt)throw new Ue(Ae.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==r.endAt)throw new Ue(Ae.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const o=new Vf(s,i);return function(c,u){if(null===nx(c)){const d=rx(c);null!==d&&QQ(0,d,u.field)}}(r,o),o}(t._query,this.ma,this.pa);return new eo(t.firestore,t.converter,function(r,s){const i=r.explicitOrderBy.concat([s]);return new ql(r.path,r.collectionGroup,i,r.filters.slice(),r.limit,r.limitType,r.startAt,r.endAt)}(t._query,e))}}function lye(n,t="asc"){const e=t,r=XM("orderBy",n);return new cye(r,e)}class qQ extends qk{constructor(t,e,r){super(),this.type=t,this.Ia=e,this.Ta=r}_apply(t){return new eo(t.firestore,t.converter,EM(t._query,this.Ia,this.Ta))}}function uye(n){return function yQ(n,t){if(t<=0)throw new Ue(Ae.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${t}.`)}("limit",n),new qQ("limit",n,"F")}function KQ(n,t,e){if("string"==typeof(e=es(e))){if(""===e)throw new Ue(Ae.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!sx(t)&&-1!==e.indexOf("/"))throw new Ue(Ae.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${e}' contains a '/' character.`);const r=t.path.child(g1.fromString(e));if(!at.isDocumentKey(r))throw new Ue(Ae.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Qu(n,new at(r))}if(e instanceof Os)return Qu(n,e._key);throw new Ue(Ae.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${UM(e)}.`)}function XQ(n,t){if(!Array.isArray(n)||0===n.length)throw new Ue(Ae.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`);if(n.length>10)throw new Ue(Ae.INVALID_ARGUMENT,`Invalid Query. '${t.toString()}' filters support a maximum of 10 elements in the value array.`)}function QQ(n,t,e){if(!e.isEqual(t))throw new Ue(Ae.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${t.toString()}' and so you must also use '${t.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${e.toString()}' instead.`)}function jk(n,t,e){let r;return r=n?e&&(e.merge||e.mergeFields)?n.toFirestore(t,e):n.toFirestore(t):t,r}class d5{constructor(t,e){this.hasPendingWrites=t,this.fromCache=e}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class ad extends Wk{constructor(t,e,r,s,i,o){super(t,e,r,s,o),this._firestore=t,this._firestoreImpl=t,this.metadata=i}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const e=new QM(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,e={}){if(this._document){const r=this._document.data.field(XM("DocumentSnapshot.get",t));if(null!==r)return this._userDataWriter.convertValue(r,e.serverTimestamps)}}}class QM extends ad{data(t={}){return super.data(t)}}class cd{constructor(t,e,r,s){this._firestore=t,this._userDataWriter=e,this._snapshot=s,this.metadata=new d5(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const t=[];return this.forEach(e=>t.push(e)),t}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(t,e){this._snapshot.docs.forEach(r=>{t.call(e,new QM(this._firestore,this._userDataWriter,r.key,r,new d5(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(t={}){const e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new Ue(Ae.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(r,s){if(r._snapshot.oldDocs.isEmpty()){let i=0;return r._snapshot.docChanges.map(o=>({type:"added",doc:new QM(r._firestore,r._userDataWriter,o.doc.key,o.doc,new d5(r._snapshot.mutatedKeys.has(o.doc.key),r._snapshot.fromCache),r.query.converter),oldIndex:-1,newIndex:i++}))}{let i=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(o=>s||3!==o.type).map(o=>{const c=new QM(r._firestore,r._userDataWriter,o.doc.key,o.doc,new d5(r._snapshot.mutatedKeys.has(o.doc.key),r._snapshot.fromCache),r.query.converter);let u=-1,d=-1;return 0!==o.type&&(u=i.indexOf(o.doc.key),i=i.delete(o.doc.key)),1!==o.type&&(i=i.add(o.doc),d=i.indexOf(o.doc.key)),{type:dye(o.type),doc:c,oldIndex:u,newIndex:d}})}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}}function dye(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return wt()}}function hye(n){n=l1(n,Os);const t=l1(n.firestore,Pr);return function IQ(n,t,e={}){const r=new pi;return n.asyncQueue.enqueueAndForget(I(function*(){return function(s,i,o,c,u){const d=new GM({next:m=>{i.enqueueAndForget(()=>ek(s,g));const y=m.docs.has(o);!y&&m.fromCache?u.reject(new Ue(Ae.UNAVAILABLE,"Failed to get document because the client is offline.")):y&&m.fromCache&&c&&"server"===c.source?u.reject(new Ue(Ae.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(m)},error:m=>u.reject(m)}),g=new rk(Hf(o.path),d,{includeMetadataChanges:!0,Nu:!0});return Qx(s,g)}(yield sd(n),n.asyncQueue,t,e,r)})),r.promise}(js(t),n._key).then(e=>Zk(t,n,e))}class Z0 extends class fye{convertValue(t,e="none"){switch(Xu(t)){case 0:return null;case 1:return t.booleanValue;case 2:return gs(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(Yu(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 10:return this.convertObject(t.mapValue,e);default:throw wt()}}convertObject(t,e){const r={};return Zu(t.fields,(s,i)=>{r[s]=this.convertValue(i,e)}),r}convertGeoPoint(t){return new Fk(gs(t.latitude),gs(t.longitude))}convertArray(t,e){return(t.values||[]).map(r=>this.convertValue(r,e))}convertServerTimestamp(t,e){switch(e){case"previous":const r=dK(t);return null==r?null:this.convertValue(r,e);case"estimate":return this.convertTimestamp(Mg(t));default:return null}}convertTimestamp(t){const e=H0(t);return new ts(e.seconds,e.nanos)}convertDocumentKey(t,e){const r=g1.fromString(t);on(uX(r));const s=new Ku(r.get(1),r.get(3)),i=new at(r.popFirst(5));return s.isEqual(e)||ws(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${e.projectId}/${e.database}) instead.`),i}}{constructor(t){super(),this.firestore=t}convertBytes(t){return new u5(t)}convertReference(t){const e=this.convertDocumentKey(t,this.firestore._databaseId);return new Os(this.firestore,null,e)}}function pye(n){n=l1(n,eo);const t=l1(n.firestore,Pr),e=js(t),r=new Z0(t);return WQ(n._query),function xQ(n,t,e={}){const r=new pi;return n.asyncQueue.enqueueAndForget(I(function*(){return function(s,i,o,c,u){const d=new GM({next:m=>{i.enqueueAndForget(()=>ek(s,g)),m.fromCache&&"server"===c.source?u.reject(new Ue(Ae.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(m)},error:m=>u.reject(m)}),g=new rk(o,d,{includeMetadataChanges:!0,Nu:!0});return Qx(s,g)}(yield sd(n),n.asyncQueue,t,e,r)})),r.promise}(e,n._query).then(s=>new cd(t,r,n,s))}function gye(n,t,e){n=l1(n,Os);const r=l1(n.firestore,Pr),s=jk(n.converter,t,e);return Jg(r,[Bk(od(r),"setDoc",n._key,s,null!==n.converter,e).toMutation(n._key,Hr.none())])}function mye(n,t,e,...r){n=l1(n,Os);const s=l1(n.firestore,Pr),i=od(s);let o;return o="string"==typeof(t=es(t))||t instanceof id?function FQ(n,t,e,r,s,i){const o=n.da(1,t,e),c=[Gk(t,r,e)],u=[s];if(i.length%2!=0)throw new Ue(Ae.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let y=0;y<i.length;y+=2)c.push(Gk(t,i[y])),u.push(i[y+1]);const d=[],g=M2.empty();for(let y=c.length-1;y>=0;--y)if(!GQ(d,c[y])){const b=c[y];let k=u[y];k=es(k);const $=o.ca(b);if(k instanceof Qg)d.push(b);else{const K=f5(k,$);null!=K&&(d.push(b),g.set(b,K))}}const m=new Ga(d);return new DQ(g,m,o.fieldTransforms)}(i,"updateDoc",n._key,t,e,r):function HQ(n,t,e,r){const s=n.da(1,t,e);Uk("Data must be an object, but it was:",s,r);const i=[],o=M2.empty();Zu(r,(u,d)=>{const g=YM(t,u,e);d=es(d);const m=s.ca(g);if(d instanceof Qg)i.push(g);else{const y=f5(d,m);null!=y&&(i.push(g),o.set(g,y))}});const c=new Ga(i);return new DQ(o,c,s.fieldTransforms)}(i,"updateDoc",n._key,t),Jg(s,[o.toMutation(n._key,Hr.exists(!0))])}function _ye(n){return Jg(l1(n.firestore,Pr),[new Gf(n._key,Hr.none())])}function vye(n,t){const e=l1(n.firestore,Pr),r=PQ(n),s=jk(n.converter,t);return Jg(e,[Bk(od(n.firestore),"addDoc",r._key,s,null!==n.converter,{}).toMutation(r._key,Hr.exists(!1))]).then(()=>r)}function Cye(n,...t){var e,r,s;n=es(n);let i={includeMetadataChanges:!1},o=0;"object"!=typeof t[o]||Hk(t[o])||(i=t[o],o++);const c={includeMetadataChanges:i.includeMetadataChanges};if(Hk(t[o])){const m=t[o];t[o]=null===(e=m.next)||void 0===e?void 0:e.bind(m),t[o+1]=null===(r=m.error)||void 0===r?void 0:r.bind(m),t[o+2]=null===(s=m.complete)||void 0===s?void 0:s.bind(m)}let u,d,g;if(n instanceof Os)d=l1(n.firestore,Pr),g=Hf(n._key.path),u={next:m=>{t[o]&&t[o](Zk(d,n,m))},error:t[o+1],complete:t[o+2]};else{const m=l1(n,eo);d=l1(m.firestore,Pr),g=m._query;const y=new Z0(d);u={next:b=>{t[o]&&t[o](new cd(d,y,m,b))},error:t[o+1],complete:t[o+2]},WQ(n._query)}return function(m,y,b,k){const $=new GM(k),K=new rk(y,$,b);return m.asyncQueue.enqueueAndForget(I(function*(){return Qx(yield sd(m),K)})),()=>{$.bc(),m.asyncQueue.enqueueAndForget(I(function*(){return ek(yield sd(m),K)}))}}(js(d),g,c,u)}function Jg(n,t){return function(e,r){const s=new pi;return e.asyncQueue.enqueueAndForget(I(function*(){return function pCe(n,t,e){return ck.apply(this,arguments)}(yield function zk(n){return WM(n).then(t=>t.syncEngine)}(e),r,s)})),s.promise}(js(n),t)}function Zk(n,t,e){const r=e.docs.get(t._key),s=new Z0(n);return new ad(n,s,t._key,r,new d5(e.hasPendingWrites,e.fromCache),t.converter)}function Y0(){return new $k("serverTimestamp")}function eJ(n,t){if(null!=n&&null!=t&&"object"==typeof n){if(null!=n.equals)return n.equals(t);{const e=n,r=t;for(const s of Object.keys(e)){if(!(s in r))return!1;if(!1===eJ(e[s],r[s]))return!1}return!0}}return n===t}function Yk(n){return null==n||function Sye(n){return"object"==typeof n&&null!=n&&null!=n.equals}(n)||function Lbe(n){return"string"==typeof n||"number"==typeof n||"boolean"==typeof n||null===n}(n)||function Pye(n){if("object"==typeof n){for(const t in n)if(null!=n[t]&&!1===Yk(n[t]))return!1;return null!=n&&n.constructor.prototype===Object.prototype}return!1}(n)}function Wa(n,t){if(Yk(n)&&Yk(t))return eJ(n,t);throw new Error(`Comparing non comparable objects: ${n.constructor.name} and ${t.constructor.name}`)}function Pe(n,t,e){if(!1===n)throw void 0!==e&&console.log(e),As.logError("Assertion failure",t),new Error(`Assertion failure: ${t}`)}!function(n,t=!0){kf="9.14.0",Oo(new X2("firestore",(e,{instanceIdentifier:r,options:s})=>{const i=e.getProvider("app").getImmediate(),o=new Pr(new Ume(e.getProvider("auth-internal")),new qme(e.getProvider("app-check-internal")),function(c,u){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new Ue(Ae.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ku(c.options.projectId,u)}(i,r),i);return s=Object.assign({useFetchStreams:t},s),o._setSettings(s),o},"PUBLIC").setMultipleInstances(!0)),ds(eK,"3.7.3",n),ds(eK,"3.7.3","esm2017")}();class L4{}class Nt extends L4{static fromFunctions(t,e){return new class extends Nt{encodeMove(r){return t(r)}decodeMove(r){return e(r)}}}static identity(){function t(e){return e}return Nt.fromFunctions(t,t)}static constant(t,e){return new class extends Nt{encodeMove(r){return t}decodeMove(r){return e}}}static tuple(t,e,r){return new class extends Nt{encodeMove(s){const i=e(s),o={};return Object.keys(i).forEach(c=>{o[c]=t[c].encode(i[c])}),o}decodeMove(s){const i={};return Object.keys(t).reverse().forEach(o=>{i[o]=t[o].decode(s[o])}),r(Object.values(i))}}}static disjunction(t,e,r){return new class extends Nt{encodeMove(s){return r(s)?{type:"T",encoded:t.encode(s)}:{type:"U",encoded:e.encode(s)}}decodeMove(s){const i=Me.getNonNullable(s).type,o=Me.getNonNullable(s).encoded;return"T"===i?t.decode(o):e.decode(o)}}}static disjunction3(t,e,r,s,i){return new class extends Nt{encodeMove(o){return s(o)?{type:"T",encoded:t.encode(o)}:i(o)?{type:"U",encoded:e.encode(o)}:{type:"V",encoded:r.encode(o)}}decodeMove(o){const c=Me.getNonNullable(o).type,u=Me.getNonNullable(o).encoded;return"T"===c?t.decode(u):"U"===c?e.decode(u):r.decode(u)}}}encode(t){return this.encodeMove(t)}decode(t){return Pe(!1===Array.isArray(t),"MoveEncoder.decode called with an array"),this.decodeMove(t)}}class T{constructor(t){this.value=t}static of(t){return new T(t)}static ofNullable(t){return null==t?T.empty():T.of(t)}static empty(){return new T(null)}static getEncoder(t){return new class extends L4{encode(e){return e.isPresent()?t.encode(e.get()):null}decode(e){return null===e?T.empty():T.of(t.decode(e))}}}isPresent(){return null!=this.value}isAbsent(){return null==this.value}get(){if(this.isPresent())return this.value;throw new Error("Value is absent")}getOrElse(t){return this.isPresent()?this.value:t}equals(t){return this.isAbsent()?t.isAbsent():!t.isAbsent()&&Wa(this.value,t.value)}equalsValue(t){return this.equals(T.of(t))}toString(){return this.isAbsent()?"MGPOptional.empty()":`MGPOptional.of(${this.value})`}map(t){return this.isPresent()?T.of(t(this.get())):T.empty()}}class _e{static success(t){return new Tye(t)}static failure(t){return new wye(t)}constructor(){}equals(t){return this.isFailure()?t.isFailure()&&this.getReason()===t.getReason():!t.isFailure()&&Wa(this.get(),t.get())}}class Tye extends _e{constructor(t){super(),this.value=t}isSuccess(){return!0}isFailure(){return!1}get(){return this.value}getReason(){throw new Error("Cannot get failure reason from a success")}getReasonOr(t){return t}toOptional(){return T.of(this.value)}toString(){return`MGPFallible.success(${this.value})`}}class wye extends _e{constructor(t){super(),this.reason=t}isSuccess(){return!1}isFailure(){return!0}get(){throw new Error("Value is absent from failure, with the following reason: "+this.reason)}getReason(){return this.reason}getReasonOr(t){return this.getReason()}toOptional(){return T.empty()}toString(){return`MGPFallible.failure(${this.reason})`}toOtherFallible(){return _e.failure(this.reason)}}var R;!function(n){n.SUCCESS=_e.success(void 0),n.ofFallible=function t(r){return r.isSuccess()?n.SUCCESS:n.failure(r.getReason())},n.failure=function e(r){return _e.failure(r)}}(R||(R={})),ds("firebase","9.14.0","app");const tJ="@firebase/installations",Kk="0.5.16",rJ=`w:${Kk}`,sJ="FIS_v2",Kl=new b4("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function iJ(n){return n instanceof kc&&n.code.includes("request-failed")}function Xk({projectId:n}){return`https://firebaseinstallations.googleapis.com/v1/projects/${n}/installations`}function oJ(n){return{token:n.token,requestStatus:2,expiresIn:Lye(n.expiresIn),creationTime:Date.now()}}function Qk(n,t){return Jk.apply(this,arguments)}function Jk(){return Jk=I(function*(n,t){const r=(yield t.json()).error;return Kl.create("request-failed",{requestName:n,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})}),Jk.apply(this,arguments)}function aJ({apiKey:n}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n})}function cJ(n,{refreshToken:t}){const e=aJ(n);return e.append("Authorization",function Rye(n){return`${sJ} ${n}`}(t)),e}function eL(n){return tL.apply(this,arguments)}function tL(){return tL=I(function*(n){const t=yield n();return t.status>=500&&t.status<600?n():t}),tL.apply(this,arguments)}function Lye(n){return Number(n.replace("s","000"))}function Dye(n,t){return nL.apply(this,arguments)}function nL(){return nL=I(function*({appConfig:n,heartbeatServiceProvider:t},{fid:e}){const r=Xk(n),s=aJ(n),i=t.getImmediate({optional:!0});if(i){const d=yield i.getHeartbeatsHeader();d&&s.append("x-firebase-client",d)}const c={method:"POST",headers:s,body:JSON.stringify({fid:e,authVersion:sJ,appId:n.appId,sdkVersion:rJ})},u=yield eL(()=>fetch(r,c));if(u.ok){const d=yield u.json();return{fid:d.fid||e,registrationStatus:2,refreshToken:d.refreshToken,authToken:oJ(d.authToken)}}throw yield Qk("Create Installation",u)}),nL.apply(this,arguments)}function lJ(n){return new Promise(t=>{setTimeout(t,n)})}const Vye=/^[cdef][\w-]{21}$/;function Hye(){try{const n=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(n),n[0]=112+n[0]%16;const e=function Fye(n){return function zye(n){return btoa(String.fromCharCode(...n)).replace(/\+/g,"-").replace(/\//g,"_")}(n).substr(0,22)}(n);return Vye.test(e)?e:""}catch{return""}}function ld(n){return`${n.appName}!${n.appId}`}const ud=new Map;function uJ(n,t){const e=ld(n);fJ(e,t),function Uye(n,t){const e=function dJ(){return!h5&&"BroadcastChannel"in self&&(h5=new BroadcastChannel("[Firebase] FID Change"),h5.onmessage=n=>{fJ(n.data.key,n.data.fid)}),h5}();e&&e.postMessage({key:n,fid:t}),function hJ(){0===ud.size&&h5&&(h5.close(),h5=null)}()}(e,t)}function fJ(n,t){const e=ud.get(n);if(e)for(const r of e)r(t)}let h5=null;const p5="firebase-installations-store";let sL=null;function iL(){return sL||(sL=zE("firebase-installations-database",1,{upgrade:(n,t)=>{0===t&&n.createObjectStore(p5)}})),sL}function eS(n,t){return oL.apply(this,arguments)}function oL(){return oL=I(function*(n,t){const e=ld(n),s=(yield iL()).transaction(p5,"readwrite"),i=s.objectStore(p5),o=yield i.get(e);return yield i.put(t,e),yield s.done,(!o||o.fid!==t.fid)&&uJ(n,t.fid),t}),oL.apply(this,arguments)}function aL(n){return cL.apply(this,arguments)}function cL(){return cL=I(function*(n){const t=ld(n),r=(yield iL()).transaction(p5,"readwrite");yield r.objectStore(p5).delete(t),yield r.done}),cL.apply(this,arguments)}function em(n,t){return lL.apply(this,arguments)}function lL(){return lL=I(function*(n,t){const e=ld(n),s=(yield iL()).transaction(p5,"readwrite"),i=s.objectStore(p5),o=yield i.get(e),c=t(o);return void 0===c?yield i.delete(e):yield i.put(c,e),yield s.done,c&&(!o||o.fid!==c.fid)&&uJ(n,c.fid),c}),lL.apply(this,arguments)}function uL(n){return fL.apply(this,arguments)}function fL(){return fL=I(function*(n){let t;const e=yield em(n.appConfig,r=>{const s=qye(r),i=jye(n,s);return t=i.registrationPromise,i.installationEntry});return""===e.fid?{installationEntry:yield t}:{installationEntry:e,registrationPromise:t}}),fL.apply(this,arguments)}function qye(n){return gJ(n||{fid:Hye(),registrationStatus:0})}function jye(n,t){if(0===t.registrationStatus){if(!navigator.onLine)return{installationEntry:t,registrationPromise:Promise.reject(Kl.create("app-offline"))};const e={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},r=function Zye(n,t){return dL.apply(this,arguments)}(n,e);return{installationEntry:e,registrationPromise:r}}return 1===t.registrationStatus?{installationEntry:t,registrationPromise:Yye(n)}:{installationEntry:t}}function dL(){return dL=I(function*(n,t){try{const e=yield Dye(n,t);return eS(n.appConfig,e)}catch(e){throw iJ(e)&&409===e.customData.serverCode?yield aL(n.appConfig):yield eS(n.appConfig,{fid:t.fid,registrationStatus:0}),e}}),dL.apply(this,arguments)}function Yye(n){return hL.apply(this,arguments)}function hL(){return hL=I(function*(n){let t=yield pJ(n.appConfig);for(;1===t.registrationStatus;)yield lJ(100),t=yield pJ(n.appConfig);if(0===t.registrationStatus){const{installationEntry:e,registrationPromise:r}=yield uL(n);return r||e}return t}),hL.apply(this,arguments)}function pJ(n){return em(n,t=>{if(!t)throw Kl.create("installation-not-found");return gJ(t)})}function gJ(n){return function Kye(n){return 1===n.registrationStatus&&n.registrationTime+1e4<Date.now()}(n)?{fid:n.fid,registrationStatus:0}:n}function Xye(n,t){return pL.apply(this,arguments)}function pL(){return pL=I(function*({appConfig:n,heartbeatServiceProvider:t},e){const r=Qye(n,e),s=cJ(n,e),i=t.getImmediate({optional:!0});if(i){const d=yield i.getHeartbeatsHeader();d&&s.append("x-firebase-client",d)}const c={method:"POST",headers:s,body:JSON.stringify({installation:{sdkVersion:rJ,appId:n.appId}})},u=yield eL(()=>fetch(r,c));if(u.ok)return oJ(yield u.json());throw yield Qk("Generate Auth Token",u)}),pL.apply(this,arguments)}function Qye(n,{fid:t}){return`${Xk(n)}/${t}/authTokens:generate`}function gL(n){return mL.apply(this,arguments)}function mL(){return mL=I(function*(n,t=!1){let e;const r=yield em(n.appConfig,i=>{if(!_J(i))throw Kl.create("not-registered");const o=i.authToken;if(!t&&tEe(o))return i;if(1===o.requestStatus)return e=Jye(n,t),i;{if(!navigator.onLine)throw Kl.create("app-offline");const c=rEe(i);return e=eEe(n,c),c}});return e?yield e:r.authToken}),mL.apply(this,arguments)}function Jye(n,t){return _L.apply(this,arguments)}function _L(){return _L=I(function*(n,t){let e=yield mJ(n.appConfig);for(;1===e.authToken.requestStatus;)yield lJ(100),e=yield mJ(n.appConfig);const r=e.authToken;return 0===r.requestStatus?gL(n,t):r}),_L.apply(this,arguments)}function mJ(n){return em(n,t=>{if(!_J(t))throw Kl.create("not-registered");return function sEe(n){return 1===n.requestStatus&&n.requestTime+1e4<Date.now()}(t.authToken)?Object.assign(Object.assign({},t),{authToken:{requestStatus:0}}):t})}function eEe(n,t){return vL.apply(this,arguments)}function vL(){return vL=I(function*(n,t){try{const e=yield Xye(n,t),r=Object.assign(Object.assign({},t),{authToken:e});return yield eS(n.appConfig,r),e}catch(e){if(!iJ(e)||401!==e.customData.serverCode&&404!==e.customData.serverCode){const r=Object.assign(Object.assign({},t),{authToken:{requestStatus:0}});yield eS(n.appConfig,r)}else yield aL(n.appConfig);throw e}}),vL.apply(this,arguments)}function _J(n){return void 0!==n&&2===n.registrationStatus}function tEe(n){return 2===n.requestStatus&&!function nEe(n){const t=Date.now();return t<n.creationTime||n.creationTime+n.expiresIn<t+36e5}(n)}function rEe(n){const t={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},n),{authToken:t})}function CL(){return CL=I(function*(n){const t=n,{installationEntry:e,registrationPromise:r}=yield uL(t);return r?r.catch(console.error):gL(t).catch(console.error),e.fid}),CL.apply(this,arguments)}function yL(){return yL=I(function*(n,t=!1){const e=n;return yield aEe(e),(yield gL(e,t)).token}),yL.apply(this,arguments)}function aEe(n){return EL.apply(this,arguments)}function EL(){return EL=I(function*(n){const{registrationPromise:t}=yield uL(n);t&&(yield t)}),EL.apply(this,arguments)}function PL(n){return Kl.create("missing-app-config-values",{valueName:n})}const vJ="installations",dEe=n=>{const t=n.getProvider("app").getImmediate(),e=function uEe(n){if(!n||!n.options)throw PL("App Configuration");if(!n.name)throw PL("App Name");const t=["projectId","apiKey","appId"];for(const e of t)if(!n.options[e])throw PL(e);return{appName:n.name,projectId:n.options.projectId,apiKey:n.options.apiKey,appId:n.options.appId}}(t);return{app:t,appConfig:e,heartbeatServiceProvider:bf(t,"heartbeat"),_delete:()=>Promise.resolve()}},hEe=n=>{const e=bf(n.getProvider("app").getImmediate(),vJ).getImmediate();return{getId:()=>function iEe(n){return CL.apply(this,arguments)}(e),getToken:s=>function oEe(n){return yL.apply(this,arguments)}(e,s)}};(function pEe(){Oo(new X2(vJ,dEe,"PUBLIC")),Oo(new X2("installations-internal",hEe,"PRIVATE"))})(),ds(tJ,Kk),ds(tJ,Kk,"esm2017");const TL="@firebase/remote-config",fa=new b4("remoteconfig","Remote Config",{"registration-window":"Undefined window object. This SDK only supports usage in a browser environment.","registration-project-id":"Undefined project identifier. Check Firebase app initialization.","registration-api-key":"Undefined API key. Check Firebase app initialization.","registration-app-id":"Undefined app identifier. Check Firebase app initialization.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}.","fetch-client-network":"Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-timeout":'The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',"fetch-throttle":'The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',"fetch-client-parse":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","indexed-db-unavailable":"Indexed DB is not supported by current browser"});class TEe{constructor(t,e,r,s){this.client=t,this.storage=e,this.storageCache=r,this.logger=s}isCachedDataFresh(t,e){if(!e)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;const r=Date.now()-e,s=r<=t;return this.logger.debug(`Config fetch cache check. Cache age millis: ${r}. Cache max age millis (minimumFetchIntervalMillis setting): ${t}. Is cache hit: ${s}.`),s}fetch(t){var e=this;return I(function*(){const[r,s]=yield Promise.all([e.storage.getLastSuccessfulFetchTimestampMillis(),e.storage.getLastSuccessfulFetchResponse()]);if(s&&e.isCachedDataFresh(t.cacheMaxAgeMillis,r))return s;t.eTag=s&&s.eTag;const i=yield e.client.fetch(t),o=[e.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())];return 200===i.status&&o.push(e.storage.setLastSuccessfulFetchResponse(i)),yield Promise.all(o),i})()}}function wEe(n=navigator){return n.languages&&n.languages[0]||n.language}class bEe{constructor(t,e,r,s,i,o){this.firebaseInstallations=t,this.sdkVersion=e,this.namespace=r,this.projectId=s,this.apiKey=i,this.appId=o}fetch(t){var e=this;return I(function*(){var r,s,i;const[o,c]=yield Promise.all([e.firebaseInstallations.getId(),e.firebaseInstallations.getToken()]),d=`${window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com"}/v1/projects/${e.projectId}/namespaces/${e.namespace}:fetch?key=${e.apiKey}`,g={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":t.eTag||"*"},m={sdk_version:e.sdkVersion,app_instance_id:o,app_instance_id_token:c,app_id:e.appId,language_code:wEe()},y={method:"POST",headers:g,body:JSON.stringify(m)},b=fetch(d,y),k=new Promise((Le,Ge)=>{t.signal.addEventListener(()=>{const Qe=new Error("The operation was aborted.");Qe.name="AbortError",Ge(Qe)})});let $;try{yield Promise.race([b,k]),$=yield b}catch(Le){let Ge="fetch-client-network";throw"AbortError"===(null===(r=Le)||void 0===r?void 0:r.name)&&(Ge="fetch-timeout"),fa.create(Ge,{originalErrorMessage:null===(s=Le)||void 0===s?void 0:s.message})}let K=$.status;const oe=$.headers.get("ETag")||void 0;let ye,te;if(200===$.status){let Le;try{Le=yield $.json()}catch(Ge){throw fa.create("fetch-client-parse",{originalErrorMessage:null===(i=Ge)||void 0===i?void 0:i.message})}ye=Le.entries,te=Le.state}if("INSTANCE_STATE_UNSPECIFIED"===te?K=500:"NO_CHANGE"===te?K=304:("NO_TEMPLATE"===te||"EMPTY_CONFIG"===te)&&(ye={}),304!==K&&200!==K)throw fa.create("fetch-status",{httpStatus:K});return{status:K,eTag:oe,config:ye}})()}}class NEe{constructor(t,e){this.client=t,this.storage=e}fetch(t){var e=this;return I(function*(){const r=(yield e.storage.getThrottleMetadata())||{backoffCount:0,throttleEndTimeMillis:Date.now()};return e.attemptFetch(t,r)})()}attemptFetch(t,{throttleEndTimeMillis:e,backoffCount:r}){var s=this;return I(function*(){yield function OEe(n,t){return new Promise((e,r)=>{const s=Math.max(t-Date.now(),0),i=setTimeout(e,s);n.addEventListener(()=>{clearTimeout(i),r(fa.create("fetch-throttle",{throttleEndTimeMillis:t}))})})}(t.signal,e);try{const i=yield s.client.fetch(t);return yield s.storage.deleteThrottleMetadata(),i}catch(i){if(!function AEe(n){if(!(n instanceof kc&&n.customData))return!1;const t=Number(n.customData.httpStatus);return 429===t||500===t||503===t||504===t}(i))throw i;const o={throttleEndTimeMillis:Date.now()+qN(r),backoffCount:r+1};return yield s.storage.setThrottleMetadata(o),s.attemptFetch(t,o)}})()}}class kEe{constructor(t,e,r,s,i){this.app=t,this._client=e,this._storageCache=r,this._storage=s,this._logger=i,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:6e4,minimumFetchIntervalMillis:432e5},this.defaultConfig={}}get fetchTimeMillis(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1}get lastFetchStatus(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"}}function nS(n,t){var e;const r=n.target.error||void 0;return fa.create(t,{originalErrorMessage:r&&(null===(e=r)||void 0===e?void 0:e.message)})}const g5="app_namespace_store";class zEe{constructor(t,e,r,s=function DEe(){return new Promise((n,t)=>{var e;try{const r=indexedDB.open("firebase_remote_config",1);r.onerror=s=>{t(nS(s,"storage-open"))},r.onsuccess=s=>{n(s.target.result)},r.onupgradeneeded=s=>{0===s.oldVersion&&s.target.result.createObjectStore(g5,{keyPath:"compositeKey"})}}catch(r){t(fa.create("storage-open",{originalErrorMessage:null===(e=r)||void 0===e?void 0:e.message}))}})}()){this.appId=t,this.appName=e,this.namespace=r,this.openDbPromise=s}getLastFetchStatus(){return this.get("last_fetch_status")}setLastFetchStatus(t){return this.set("last_fetch_status",t)}getLastSuccessfulFetchTimestampMillis(){return this.get("last_successful_fetch_timestamp_millis")}setLastSuccessfulFetchTimestampMillis(t){return this.set("last_successful_fetch_timestamp_millis",t)}getLastSuccessfulFetchResponse(){return this.get("last_successful_fetch_response")}setLastSuccessfulFetchResponse(t){return this.set("last_successful_fetch_response",t)}getActiveConfig(){return this.get("active_config")}setActiveConfig(t){return this.set("active_config",t)}getActiveConfigEtag(){return this.get("active_config_etag")}setActiveConfigEtag(t){return this.set("active_config_etag",t)}getThrottleMetadata(){return this.get("throttle_metadata")}setThrottleMetadata(t){return this.set("throttle_metadata",t)}deleteThrottleMetadata(){return this.delete("throttle_metadata")}get(t){var e=this;return I(function*(){const r=yield e.openDbPromise;return new Promise((s,i)=>{var o;const u=r.transaction([g5],"readonly").objectStore(g5),d=e.createCompositeKey(t);try{const g=u.get(d);g.onerror=m=>{i(nS(m,"storage-get"))},g.onsuccess=m=>{const y=m.target.result;s(y?y.value:void 0)}}catch(g){i(fa.create("storage-get",{originalErrorMessage:null===(o=g)||void 0===o?void 0:o.message}))}})})()}set(t,e){var r=this;return I(function*(){const s=yield r.openDbPromise;return new Promise((i,o)=>{var c;const d=s.transaction([g5],"readwrite").objectStore(g5),g=r.createCompositeKey(t);try{const m=d.put({compositeKey:g,value:e});m.onerror=y=>{o(nS(y,"storage-set"))},m.onsuccess=()=>{i()}}catch(m){o(fa.create("storage-set",{originalErrorMessage:null===(c=m)||void 0===c?void 0:c.message}))}})})()}delete(t){var e=this;return I(function*(){const r=yield e.openDbPromise;return new Promise((s,i)=>{var o;const u=r.transaction([g5],"readwrite").objectStore(g5),d=e.createCompositeKey(t);try{const g=u.delete(d);g.onerror=m=>{i(nS(m,"storage-delete"))},g.onsuccess=()=>{s()}}catch(g){i(fa.create("storage-delete",{originalErrorMessage:null===(o=g)||void 0===o?void 0:o.message}))}})})()}createCompositeKey(t){return[this.appId,this.appName,this.namespace,t].join()}}class VEe{constructor(t){this.storage=t}getLastFetchStatus(){return this.lastFetchStatus}getLastSuccessfulFetchTimestampMillis(){return this.lastSuccessfulFetchTimestampMillis}getActiveConfig(){return this.activeConfig}loadFromStorage(){var t=this;return I(function*(){const e=t.storage.getLastFetchStatus(),r=t.storage.getLastSuccessfulFetchTimestampMillis(),s=t.storage.getActiveConfig(),i=yield e;i&&(t.lastFetchStatus=i);const o=yield r;o&&(t.lastSuccessfulFetchTimestampMillis=o);const c=yield s;c&&(t.activeConfig=c)})()}setLastFetchStatus(t){return this.lastFetchStatus=t,this.storage.setLastFetchStatus(t)}setLastSuccessfulFetchTimestampMillis(t){return this.lastSuccessfulFetchTimestampMillis=t,this.storage.setLastSuccessfulFetchTimestampMillis(t)}setActiveConfig(t){return this.activeConfig=t,this.storage.setActiveConfig(t)}}function FEe(){return NL.apply(this,arguments)}function NL(){return(NL=I(function*(){if(!Vu())return!1;try{return yield Kp()}catch{return!1}})).apply(this,arguments)}!function HEe(){Oo(new X2("remote-config",function n(t,{instanceIdentifier:e}){const r=t.getProvider("app").getImmediate(),s=t.getProvider("installations-internal").getImmediate();if(typeof window>"u")throw fa.create("registration-window");if(!Vu())throw fa.create("indexed-db-unavailable");const{projectId:i,apiKey:o,appId:c}=r.options;if(!i)throw fa.create("registration-project-id");if(!o)throw fa.create("registration-api-key");if(!c)throw fa.create("registration-app-id");const u=new zEe(c,r.name,e=e||"firebase"),d=new VEe(u),g=new wf(TL);g.logLevel=p1.ERROR;const m=new bEe(s,Of,e,i,o,c),y=new NEe(m,u),b=new TEe(y,u,d,g),k=new kEe(r,b,d,u,g);return function MEe(n){const t=es(n);t._initializePromise||(t._initializePromise=t._storageCache.loadFromStorage().then(()=>{t._isInitializationComplete=!0}))}(k),k},"PUBLIC").setMultipleInstances(!0)),ds(TL,"0.3.15"),ds(TL,"0.3.15","esm2017")}();const BEe="/firebase-messaging-sw.js",$Ee="/firebase-cloud-messaging-push-scope",MJ="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",SJ="google.c.a.c_id",GEe="google.c.a.c_l",WEe="google.c.a.ts",qEe="google.c.a.e";var fd=(()=>(function(n){n.PUSH_RECEIVED="push-received",n.NOTIFICATION_CLICKED="notification-clicked"}(fd||(fd={})),fd))();function Xl(n){const t=new Uint8Array(n);return btoa(String.fromCharCode(...t)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function jEe(n){const e=(n+"=".repeat((4-n.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),r=atob(e),s=new Uint8Array(r.length);for(let i=0;i<r.length;++i)s[i]=r.charCodeAt(i);return s}const IL="fcm_token_details_db",PJ="fcm_token_object_Store";function YEe(n){return xL.apply(this,arguments)}function xL(){return xL=I(function*(n){if("databases"in indexedDB&&!(yield indexedDB.databases()).map(i=>i.name).includes(IL))return null;let t=null;return(yield zE(IL,5,{upgrade:(r=I(function*(s,i,o,c){var u;if(i<2||!s.objectStoreNames.contains(PJ))return;const d=c.objectStore(PJ),g=yield d.index("fcmSenderId").get(n);if(yield d.clear(),g)if(2===i){const m=g;if(!m.auth||!m.p256dh||!m.endpoint)return;t={token:m.fcmToken,createTime:null!==(u=m.createTime)&&void 0!==u?u:Date.now(),subscriptionOptions:{auth:m.auth,p256dh:m.p256dh,endpoint:m.endpoint,swScope:m.swScope,vapidKey:"string"==typeof m.vapidKey?m.vapidKey:Xl(m.vapidKey)}}}else if(3===i){const m=g;t={token:m.fcmToken,createTime:m.createTime,subscriptionOptions:{auth:Xl(m.auth),p256dh:Xl(m.p256dh),endpoint:m.endpoint,swScope:m.swScope,vapidKey:Xl(m.vapidKey)}}}else if(4===i){const m=g;t={token:m.fcmToken,createTime:m.createTime,subscriptionOptions:{auth:Xl(m.auth),p256dh:Xl(m.p256dh),endpoint:m.endpoint,swScope:m.swScope,vapidKey:Xl(m.vapidKey)}}}}),function(i,o,c,u){return r.apply(this,arguments)})})).close(),yield JN(IL),yield JN("fcm_vapid_details_db"),yield JN("undefined"),KEe(t)?t:null;var r}),xL.apply(this,arguments)}function KEe(n){if(!n||!n.subscriptionOptions)return!1;const{subscriptionOptions:t}=n;return"number"==typeof n.createTime&&n.createTime>0&&"string"==typeof n.token&&n.token.length>0&&"string"==typeof t.auth&&t.auth.length>0&&"string"==typeof t.p256dh&&t.p256dh.length>0&&"string"==typeof t.endpoint&&t.endpoint.length>0&&"string"==typeof t.swScope&&t.swScope.length>0&&"string"==typeof t.vapidKey&&t.vapidKey.length>0}const m5="firebase-messaging-store";let kL=null;function LL(){return kL||(kL=zE("firebase-messaging-database",1,{upgrade:(n,t)=>{0===t&&n.createObjectStore(m5)}})),kL}function TJ(n){return RL.apply(this,arguments)}function RL(){return RL=I(function*(n){const t=HL(n),r=yield(yield LL()).transaction(m5).objectStore(m5).get(t);if(r)return r;{const s=yield YEe(n.appConfig.senderId);if(s)return yield DL(n,s),s}}),RL.apply(this,arguments)}function DL(n,t){return zL.apply(this,arguments)}function zL(){return zL=I(function*(n,t){const e=HL(n),s=(yield LL()).transaction(m5,"readwrite");return yield s.objectStore(m5).put(t,e),yield s.done,t}),zL.apply(this,arguments)}function JEe(n){return VL.apply(this,arguments)}function VL(){return VL=I(function*(n){const t=HL(n),r=(yield LL()).transaction(m5,"readwrite");yield r.objectStore(m5).delete(t),yield r.done}),VL.apply(this,arguments)}function HL({appConfig:n}){return n.appId}const P2=new b4("messaging","Messaging",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."});function tMe(n,t){return FL.apply(this,arguments)}function FL(){return FL=I(function*(n,t){var e;const r=yield GL(n),s=bJ(t),i={method:"POST",headers:r,body:JSON.stringify(s)};let o;try{o=yield(yield fetch(UL(n.appConfig),i)).json()}catch(c){throw P2.create("token-subscribe-failed",{errorInfo:null===(e=c)||void 0===e?void 0:e.toString()})}if(o.error)throw P2.create("token-subscribe-failed",{errorInfo:o.error.message});if(!o.token)throw P2.create("token-subscribe-no-token");return o.token}),FL.apply(this,arguments)}function nMe(n,t){return BL.apply(this,arguments)}function BL(){return BL=I(function*(n,t){var e;const r=yield GL(n),s=bJ(t.subscriptionOptions),i={method:"PATCH",headers:r,body:JSON.stringify(s)};let o;try{o=yield(yield fetch(`${UL(n.appConfig)}/${t.token}`,i)).json()}catch(c){throw P2.create("token-update-failed",{errorInfo:null===(e=c)||void 0===e?void 0:e.toString()})}if(o.error)throw P2.create("token-update-failed",{errorInfo:o.error.message});if(!o.token)throw P2.create("token-update-no-token");return o.token}),BL.apply(this,arguments)}function wJ(n,t){return $L.apply(this,arguments)}function $L(){return $L=I(function*(n,t){var e;const s={method:"DELETE",headers:yield GL(n)};try{const o=yield(yield fetch(`${UL(n.appConfig)}/${t}`,s)).json();if(o.error)throw P2.create("token-unsubscribe-failed",{errorInfo:o.error.message})}catch(i){throw P2.create("token-unsubscribe-failed",{errorInfo:null===(e=i)||void 0===e?void 0:e.toString()})}}),$L.apply(this,arguments)}function UL({projectId:n}){return`https://fcmregistrations.googleapis.com/v1/projects/${n}/registrations`}function GL(n){return WL.apply(this,arguments)}function WL(){return WL=I(function*({appConfig:n,installations:t}){const e=yield t.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n.apiKey,"x-goog-firebase-installations-auth":`FIS ${e}`})}),WL.apply(this,arguments)}function bJ({p256dh:n,auth:t,endpoint:e,vapidKey:r}){const s={web:{endpoint:e,auth:t,p256dh:n}};return r!==MJ&&(s.web.applicationPubKey=r),s}function sMe(n){return qL.apply(this,arguments)}function qL(){return qL=I(function*(n){const t=yield oMe(n.swRegistration,n.vapidKey),e={vapidKey:n.vapidKey,swScope:n.swRegistration.scope,endpoint:t.endpoint,auth:Xl(t.getKey("auth")),p256dh:Xl(t.getKey("p256dh"))},r=yield TJ(n.firebaseDependencies);if(r){if(aMe(r.subscriptionOptions,e))return Date.now()>=r.createTime+6048e5?iMe(n,{token:r.token,createTime:Date.now(),subscriptionOptions:e}):r.token;try{yield wJ(n.firebaseDependencies,r.token)}catch(s){console.warn(s)}return AJ(n.firebaseDependencies,e)}return AJ(n.firebaseDependencies,e)}),qL.apply(this,arguments)}function OJ(n){return jL.apply(this,arguments)}function jL(){return jL=I(function*(n){const t=yield TJ(n.firebaseDependencies);t&&(yield wJ(n.firebaseDependencies,t.token),yield JEe(n.firebaseDependencies));const e=yield n.swRegistration.pushManager.getSubscription();return!e||e.unsubscribe()}),jL.apply(this,arguments)}function iMe(n,t){return ZL.apply(this,arguments)}function ZL(){return ZL=I(function*(n,t){try{const e=yield nMe(n.firebaseDependencies,t),r=Object.assign(Object.assign({},t),{token:e,createTime:Date.now()});return yield DL(n.firebaseDependencies,r),e}catch(e){throw yield OJ(n),e}}),ZL.apply(this,arguments)}function AJ(n,t){return YL.apply(this,arguments)}function YL(){return YL=I(function*(n,t){const r={token:yield tMe(n,t),createTime:Date.now(),subscriptionOptions:t};return yield DL(n,r),r.token}),YL.apply(this,arguments)}function oMe(n,t){return KL.apply(this,arguments)}function KL(){return KL=I(function*(n,t){return(yield n.pushManager.getSubscription())||n.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:jEe(t)})}),KL.apply(this,arguments)}function aMe(n,t){return t.vapidKey===n.vapidKey&&t.endpoint===n.endpoint&&t.auth===n.auth&&t.p256dh===n.p256dh}function NJ(n){const t={from:n.from,collapseKey:n.collapse_key,messageId:n.fcmMessageId};return function cMe(n,t){if(!t.notification)return;n.notification={};const e=t.notification.title;e&&(n.notification.title=e);const r=t.notification.body;r&&(n.notification.body=r);const s=t.notification.image;s&&(n.notification.image=s);const i=t.notification.icon;i&&(n.notification.icon=i)}(t,n),function lMe(n,t){!t.data||(n.data=t.data)}(t,n),function uMe(n,t){var e,r,s,i,o;if(!(t.fcmOptions||null!==(e=t.notification)&&void 0!==e&&e.click_action))return;n.fcmOptions={};const c=null!==(s=null===(r=t.fcmOptions)||void 0===r?void 0:r.link)&&void 0!==s?s:null===(i=t.notification)||void 0===i?void 0:i.click_action;c&&(n.fcmOptions.link=c);const u=null===(o=t.fcmOptions)||void 0===o?void 0:o.analytics_label;u&&(n.fcmOptions.analyticsLabel=u)}(t,n),t}function fMe(n){return"object"==typeof n&&!!n&&SJ in n}function IJ(n,t){const e=[];for(let r=0;r<n.length;r++)e.push(n.charAt(r)),r<t.length&&e.push(t.charAt(r));return e.join("")}function XL(n){return P2.create("missing-app-config-values",{valueName:n})}IJ("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),IJ("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");class hMe{constructor(t,e,r){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const s=function dMe(n){if(!n||!n.options)throw XL("App Configuration Object");if(!n.name)throw XL("App Name");const t=["projectId","apiKey","appId","messagingSenderId"],{options:e}=n;for(const r of t)if(!e[r])throw XL(r);return{appName:n.name,projectId:e.projectId,apiKey:e.apiKey,appId:e.appId,senderId:e.messagingSenderId}}(t);this.firebaseDependencies={app:t,appConfig:s,installations:e,analyticsProvider:r}}_delete(){return Promise.resolve()}}function xJ(n){return QL.apply(this,arguments)}function QL(){return QL=I(function*(n){var t;try{n.swRegistration=yield navigator.serviceWorker.register(BEe,{scope:$Ee}),n.swRegistration.update().catch(()=>{})}catch(e){throw P2.create("failed-service-worker-registration",{browserErrorMessage:null===(t=e)||void 0===t?void 0:t.message})}}),QL.apply(this,arguments)}function pMe(n,t){return JL.apply(this,arguments)}function JL(){return JL=I(function*(n,t){if(!t&&!n.swRegistration&&(yield xJ(n)),t||!n.swRegistration){if(!(t instanceof ServiceWorkerRegistration))throw P2.create("invalid-sw-registration");n.swRegistration=t}}),JL.apply(this,arguments)}function gMe(n,t){return eR.apply(this,arguments)}function eR(){return eR=I(function*(n,t){t?n.vapidKey=t:n.vapidKey||(n.vapidKey=MJ)}),eR.apply(this,arguments)}function tR(){return tR=I(function*(n,t){if(!navigator)throw P2.create("only-available-in-window");if("default"===Notification.permission&&(yield Notification.requestPermission()),"granted"!==Notification.permission)throw P2.create("permission-blocked");return yield gMe(n,t?.vapidKey),yield pMe(n,t?.serviceWorkerRegistration),sMe(n)}),tR.apply(this,arguments)}function mMe(n,t,e){return nR.apply(this,arguments)}function nR(){return nR=I(function*(n,t,e){const r=_Me(t);(yield n.firebaseDependencies.analyticsProvider.get()).logEvent(r,{message_id:e[SJ],message_name:e[GEe],message_time:e[WEe],message_device_time:Math.floor(Date.now()/1e3)})}),nR.apply(this,arguments)}function _Me(n){switch(n){case fd.NOTIFICATION_CLICKED:return"notification_open";case fd.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}function rR(){return rR=I(function*(n,t){const e=t.data;if(!e.isFirebaseMessaging)return;n.onMessageHandler&&e.messageType===fd.PUSH_RECEIVED&&("function"==typeof n.onMessageHandler?n.onMessageHandler(NJ(e)):n.onMessageHandler.next(NJ(e)));const r=e.data;fMe(r)&&"1"===r[qEe]&&(yield mMe(n,e.messageType,r))}),rR.apply(this,arguments)}const LJ="@firebase/messaging",CMe=n=>{const t=new hMe(n.getProvider("app").getImmediate(),n.getProvider("installations-internal").getImmediate(),n.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",e=>function vMe(n,t){return rR.apply(this,arguments)}(t,e)),t},yMe=n=>{const t=n.getProvider("messaging").getImmediate();return{getToken:r=>function kJ(n,t){return tR.apply(this,arguments)}(t,r)}};function DJ(){return sR.apply(this,arguments)}function sR(){return(sR=I(function*(){try{yield Kp()}catch{return!1}return typeof window<"u"&&Vu()&&$N()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")})).apply(this,arguments)}!function EMe(){Oo(new X2("messaging",CMe,"PUBLIC")),Oo(new X2("messaging-internal",yMe,"PRIVATE")),ds(LJ,"0.11.0"),ds(LJ,"0.11.0","esm2017")}();const rS="analytics",PMe="firebase_id",bMe="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",zJ="https://www.googletagmanager.com/gtag/js",T2=new wf("@firebase/analytics");function VJ(n){return Promise.all(n.map(t=>t.catch(e=>e)))}function OMe(n,t){const e=document.createElement("script");e.src=`${zJ}?l=${n}&id=${t}`,e.async=!0,document.head.appendChild(e)}function NMe(n,t,e,r,s,i){return aR.apply(this,arguments)}function aR(){return aR=I(function*(n,t,e,r,s,i){const o=r[s];try{if(o)yield t[o];else{const u=(yield VJ(e)).find(d=>d.measurementId===s);u&&(yield t[u.appId])}}catch(c){T2.error(c)}n("config",s,i)}),aR.apply(this,arguments)}function IMe(n,t,e,r,s){return cR.apply(this,arguments)}function cR(){return cR=I(function*(n,t,e,r,s){try{let i=[];if(s&&s.send_to){let o=s.send_to;Array.isArray(o)||(o=[o]);const c=yield VJ(e);for(const u of o){const d=c.find(m=>m.measurementId===u),g=d&&t[d.appId];if(!g){i=[];break}i.push(g)}}0===i.length&&(i=Object.values(t)),yield Promise.all(i),n("event",r,s||{})}catch(i){T2.error(i)}}),cR.apply(this,arguments)}function LMe(n){const t=window.document.getElementsByTagName("script");for(const e of Object.values(t))if(e.src&&e.src.includes(zJ)&&e.src.includes(n))return e;return null}const qa=new b4("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.'}),HJ=new class VMe{constructor(t={},e=1e3){this.throttleMetadata=t,this.intervalMillis=e}getThrottleMetadata(t){return this.throttleMetadata[t]}setThrottleMetadata(t,e){this.throttleMetadata[t]=e}deleteThrottleMetadata(t){delete this.throttleMetadata[t]}};function HMe(n){return new Headers({Accept:"application/json","x-goog-api-key":n})}function FMe(n){return lR.apply(this,arguments)}function lR(){return lR=I(function*(n){var t;const{appId:e,apiKey:r}=n,s={method:"GET",headers:HMe(r)},i=bMe.replace("{app-id}",e),o=yield fetch(i,s);if(200!==o.status&&304!==o.status){let c="";try{const u=yield o.json();null!==(t=u.error)&&void 0!==t&&t.message&&(c=u.error.message)}catch{}throw qa.create("config-fetch-failed",{httpStatus:o.status,responseMessage:c})}return o.json()}),lR.apply(this,arguments)}function BMe(n){return uR.apply(this,arguments)}function uR(){return uR=I(function*(n,t=HJ,e){const{appId:r,apiKey:s,measurementId:i}=n.options;if(!r)throw qa.create("no-app-id");if(!s){if(i)return{measurementId:i,appId:r};throw qa.create("no-api-key")}const o=t.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},c=new GMe;return setTimeout(I(function*(){c.abort()}),void 0!==e?e:6e4),FJ({appId:r,apiKey:s,measurementId:i},o,c,t)}),uR.apply(this,arguments)}function FJ(n,t,e){return fR.apply(this,arguments)}function fR(){return fR=I(function*(n,{throttleEndTimeMillis:t,backoffCount:e},r,s=HJ){var i,o;const{appId:c,measurementId:u}=n;try{yield $Me(r,t)}catch(d){if(u)return T2.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${u} provided in the "measurementId" field in the local Firebase config. [${null===(i=d)||void 0===i?void 0:i.message}]`),{appId:c,measurementId:u};throw d}try{const d=yield FMe(n);return s.deleteThrottleMetadata(c),d}catch(d){const g=d;if(!UMe(g)){if(s.deleteThrottleMetadata(c),u)return T2.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${u} provided in the "measurementId" field in the local Firebase config. [${g?.message}]`),{appId:c,measurementId:u};throw d}const m=503===Number(null===(o=g?.customData)||void 0===o?void 0:o.httpStatus)?qN(e,s.intervalMillis,30):qN(e,s.intervalMillis),y={throttleEndTimeMillis:Date.now()+m,backoffCount:e+1};return s.setThrottleMetadata(c,y),T2.debug(`Calling attemptFetch again in ${m} millis`),FJ(n,y,r,s)}}),fR.apply(this,arguments)}function $Me(n,t){return new Promise((e,r)=>{const s=Math.max(t-Date.now(),0),i=setTimeout(e,s);n.addEventListener(()=>{clearTimeout(i),r(qa.create("fetch-throttle",{throttleEndTimeMillis:t}))})})}function UMe(n){if(!(n instanceof kc&&n.customData))return!1;const t=Number(n.customData.httpStatus);return 429===t||500===t||503===t||504===t}class GMe{constructor(){this.listeners=[]}addEventListener(t){this.listeners.push(t)}abort(){this.listeners.forEach(t=>t())}}let dR,vR;function hR(){return hR=I(function*(n,t,e,r,s){if(s&&s.global)n("event",e,r);else{const i=yield t;n("event",e,Object.assign(Object.assign({},r),{send_to:i}))}}),hR.apply(this,arguments)}function BJ(n){vR=n}function $J(n){dR=n}function KMe(){return CR.apply(this,arguments)}function CR(){return CR=I(function*(){var n;if(!Vu())return T2.warn(qa.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{yield Kp()}catch(t){return T2.warn(qa.create("indexeddb-unavailable",{errorInfo:null===(n=t)||void 0===n?void 0:n.toString()}).message),!1}return!0}),CR.apply(this,arguments)}function yR(){return yR=I(function*(n,t,e,r,s,i,o){var c;const u=BMe(n);u.then(b=>{e[b.measurementId]=b.appId,n.options.measurementId&&b.measurementId!==n.options.measurementId&&T2.warn(`The measurement ID in the local Firebase config (${n.options.measurementId}) does not match the measurement ID fetched from the server (${b.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(b=>T2.error(b)),t.push(u);const d=KMe().then(b=>{if(b)return r.getId()}),[g,m]=yield Promise.all([u,d]);LMe(i)||OMe(i,g.measurementId),vR&&(s("consent","default",vR),BJ(void 0)),s("js",new Date);const y=null!==(c=o?.config)&&void 0!==c?c:{};return y.origin="firebase",y.update=!0,null!=m&&(y[PMe]=m),s("config",g.measurementId,y),dR&&(s("set",dR),$J(void 0)),g.measurementId}),yR.apply(this,arguments)}class QMe{constructor(t){this.app=t}_delete(){return delete Ql[this.app.options.appId],Promise.resolve()}}let Ql={},UJ=[];const GJ={};let qJ,Jl,sS="dataLayer",ER=!1;function eSe(n,t,e){!function JMe(){const n=[];if(BN()&&n.push("This is a browser extension environment."),$N()||n.push("Cookies are not available."),n.length>0){const t=n.map((r,s)=>`(${s+1}) ${r}`).join(" "),e=qa.create("invalid-analytics-context",{errorInfo:t});T2.warn(e.message)}}();const r=n.options.appId;if(!r)throw qa.create("no-app-id");if(!n.options.apiKey){if(!n.options.measurementId)throw qa.create("no-api-key");T2.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${n.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=Ql[r])throw qa.create("already-exists",{id:r});if(!ER){!function AMe(n){let t=[];Array.isArray(window[n])?t=window[n]:window[n]=t}(sS);const{wrappedGtag:i,gtagCore:o}=function kMe(n,t,e,r,s){let i=function(...o){window[r].push(arguments)};return window[s]&&"function"==typeof window[s]&&(i=window[s]),window[s]=function xMe(n,t,e,r){function i(){return(i=I(function*(o,c,u){try{"event"===o?yield IMe(n,t,e,c,u):"config"===o?yield NMe(n,t,e,r,c,u):"consent"===o?n("consent","update",u):n("set",c)}catch(d){T2.error(d)}})).apply(this,arguments)}return function s(o,c,u){return i.apply(this,arguments)}}(i,n,t,e),{gtagCore:i,wrappedGtag:window[s]}}(Ql,UJ,GJ,sS,"gtag");Jl=i,qJ=o,ER=!0}return Ql[r]=function XMe(n,t,e,r,s,i,o){return yR.apply(this,arguments)}(n,UJ,GJ,t,qJ,sS,e),new QMe(n)}function nSe(){return MR.apply(this,arguments)}function MR(){return(MR=I(function*(){if(BN()||!$N()||!Vu())return!1;try{return yield Kp()}catch{return!1}})).apply(this,arguments)}const jJ="@firebase/analytics";!function sSe(){Oo(new X2(rS,(t,{options:e})=>eSe(t.getProvider("app").getImmediate(),t.getProvider("installations-internal").getImmediate(),e),"PUBLIC")),Oo(new X2("analytics-internal",function n(t){try{const e=t.getProvider(rS).getImmediate();return{logEvent:(r,s,i)=>function rSe(n,t,e,r){n=es(n),function WMe(n,t,e,r,s){return hR.apply(this,arguments)}(Jl,Ql[n.app.options.appId],t,e,r).catch(s=>T2.error(s))}(e,r,s,i)}}catch(e){throw qa.create("interop-component-reg-failed",{reason:e})}},"PRIVATE")),ds(jJ,"0.8.4"),ds(jJ,"0.8.4","esm2017")}();class iSe extends q1{constructor(t,e){super()}schedule(t,e=0){return this}}const iS={setInterval(n,t,...e){const{delegate:r}=iS;return r?.setInterval?r.setInterval(n,t,...e):setInterval(n,t,...e)},clearInterval(n){const{delegate:t}=iS;return(t?.clearInterval||clearInterval)(n)},delegate:void 0};class YJ extends iSe{constructor(t,e){super(t,e),this.scheduler=t,this.work=e,this.pending=!1}schedule(t,e=0){var r;if(this.closed)return this;this.state=t;const s=this.id,i=this.scheduler;return null!=s&&(this.id=this.recycleAsyncId(i,s,e)),this.pending=!0,this.delay=e,this.id=null!==(r=this.id)&&void 0!==r?r:this.requestAsyncId(i,this.id,e),this}requestAsyncId(t,e,r=0){return iS.setInterval(t.flush.bind(t,this),r)}recycleAsyncId(t,e,r=0){if(null!=r&&this.delay===r&&!1===this.pending)return e;null!=e&&iS.clearInterval(e)}execute(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const r=this._execute(t,e);if(r)return r;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(t,e){let s,r=!1;try{this.work(t)}catch(i){r=!0,s=i||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),s}unsubscribe(){if(!this.closed){const{id:t,scheduler:e}=this,{actions:r}=e;this.work=this.state=this.scheduler=null,this.pending=!1,Jc(r,this),null!=t&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null,super.unsubscribe()}}}const SR={now:()=>(SR.delegate||Date).now(),delegate:void 0};class tm{constructor(t,e=tm.now){this.schedulerActionCtor=t,this.now=e}schedule(t,e=0,r){return new this.schedulerActionCtor(this,t).schedule(r,e)}}tm.now=SR.now;class KJ extends tm{constructor(t,e=tm.now){super(t,e),this.actions=[],this._active=!1}flush(t){const{actions:e}=this;if(this._active)return void e.push(t);let r;this._active=!0;do{if(r=t.execute(t.state,t.delay))break}while(t=e.shift());if(this._active=!1,r){for(;t=e.shift();)t.unsubscribe();throw r}}}const cSe=new class aSe extends KJ{}(class oSe extends YJ{constructor(t,e){super(t,e),this.scheduler=t,this.work=e}schedule(t,e=0){return e>0?super.schedule(t,e):(this.delay=e,this.state=t,this.scheduler.flush(this),this)}execute(t,e){return e>0||this.closed?super.execute(t,e):this._execute(t,e)}requestAsyncId(t,e,r=0){return null!=r&&r>0||null==r&&this.delay>0?super.requestAsyncId(t,e,r):(t.flush(this),0)}}),lSe=new KJ(YJ),oS=new u0("7.4.1"),PR="__angularfire_symbol__analyticsIsSupportedValue",TR="__angularfire_symbol__analyticsIsSupported",wR="__angularfire_symbol__remoteConfigIsSupportedValue",bR="__angularfire_symbol__remoteConfigIsSupported",OR="__angularfire_symbol__messagingIsSupportedValue",AR="__angularfire_symbol__messagingIsSupported";function IR(n,t,e){if(t){if(1===t.length)return t[0];const i=t.filter(o=>o.app===e);if(1===i.length)return i[0]}return e.container.getProvider(n).getImmediate({optional:!0})}globalThis[TR]||(globalThis[TR]=nSe().then(n=>globalThis[PR]=n).catch(()=>globalThis[PR]=!1)),globalThis[AR]||(globalThis[AR]=DJ().then(n=>globalThis[OR]=n).catch(()=>globalThis[OR]=!1)),globalThis[bR]||(globalThis[bR]=FEe().then(n=>globalThis[wR]=n).catch(()=>globalThis[wR]=!1));const xR=(n,t)=>{const e=t?[t]:kZ(),r=[];return e.forEach(s=>{s.container.getProvider(n).instances.forEach(o=>{r.includes(o)||r.push(o)})}),r};function dd(){}class XJ{constructor(t,e=cSe){this.zone=t,this.delegate=e}now(){return this.delegate.now()}schedule(t,e,r){const s=this.zone;return this.delegate.schedule(function(o){s.runGuarded(()=>{t.apply(this,[o])})},e,r)}}class uSe{constructor(t){this.zone=t,this.task=null}call(t,e){const r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",dd,{},dd,dd)),e.pipe(_2({next:r,complete:r,error:r})).subscribe(t).add(r)}unscheduleTask(){setTimeout(()=>{null!=this.task&&"scheduled"===this.task.state&&(this.task.invoke(),this.task=null)},10)}}let kR=(()=>{class n{constructor(e){this.ngZone=e,this.outsideAngular=e.runOutsideAngular(()=>new XJ(Zone.current)),this.insideAngular=e.run(()=>new XJ(Zone.current,lSe)),globalThis.\u0275AngularFireScheduler||(globalThis.\u0275AngularFireScheduler=this)}}return n.\u0275fac=function(e){return new(e||n)(Ve(Sr))},n.\u0275prov=rt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function _5(){const n=globalThis.\u0275AngularFireScheduler;if(!n)throw new Error("Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using\nprovideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).");return n}function fSe(n){return _5().ngZone.runOutsideAngular(()=>n())}function v5(n){return _5().ngZone.run(()=>n())}function dSe(n){return _5(),function hSe(n){return function(e){return(e=e.lift(new uSe(n.ngZone))).pipe(pc(n.outsideAngular),sl(n.insideAngular))}}(_5())(n)}const pSe=(n,t)=>function(){const r=arguments;return t&&setTimeout(()=>{"scheduled"===t.state&&t.invoke()},10),v5(()=>n.apply(void 0,r))},Tr=(n,t)=>function(){let e;const r=arguments;for(let i=0;i<arguments.length;i++)"function"==typeof r[i]&&(t&&(e||(e=v5(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",dd,{},dd,dd)))),r[i]=pSe(r[i],e));const s=fSe(()=>n.apply(this,r));if(!t){if(s instanceof Cr){const i=_5();return s.pipe(pc(i.outsideAngular),sl(i.insideAngular))}return v5(()=>s)}return s instanceof Cr?s.pipe(dSe):s instanceof Promise?v5(()=>new Promise((i,o)=>s.then(c=>v5(()=>i(c)),c=>v5(()=>o(c))))):"function"==typeof s&&e?function(){return setTimeout(()=>{e&&"scheduled"===e.state&&e.invoke()},10),s.apply(this,arguments)}:v5(()=>s)};class hd{constructor(t){return t}}class LR{constructor(){return kZ()}}const RR=new Lt("angularfire2._apps"),mSe={provide:hd,useFactory:function gSe(n){return n&&1===n.length?n[0]:new hd(nI())},deps:[[new ui,RR]]},_Se={provide:LR,deps:[[new ui,RR]]};function vSe(n){return(t,e)=>{const r=t.runOutsideAngular(()=>n(e));return new hd(r)}}let CSe=(()=>{class n{constructor(e){ds("angularfire",oS.full,"core"),ds("angularfire",oS.full,"app"),ds("angular",Rv.full,e.toString())}}return n.\u0275fac=function(e){return new(e||n)(Ve(fp))},n.\u0275mod=oi({type:n}),n.\u0275inj=Yr({providers:[mSe,_Se]}),n})();const ESe=Tr(xZ,!0),DR=new Map,QJ={activated:!1,tokenObservers:[]},MSe={initialized:!1,enabled:!1};function w2(n){return DR.get(n)||Object.assign({},QJ)}function aS(){return MSe}class OSe{constructor(t,e,r,s,i){if(this.operation=t,this.retryPolicy=e,this.getWaitDuration=r,this.lowerBound=s,this.upperBound=i,this.pending=null,this.nextErrorWaitInterval=s,s>i)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(t){var e=this;return I(function*(){e.stop();try{e.pending=new LE,yield function ASe(n){return new Promise(t=>{setTimeout(t,n)})}(e.getNextRun(t)),e.pending.resolve(),yield e.pending.promise,e.pending=new LE,yield e.operation(),e.pending.resolve(),yield e.pending.promise,e.process(!0).catch(()=>{})}catch(r){e.retryPolicy(r)?e.process(!1).catch(()=>{}):e.stop()}})()}getNextRun(t){if(t)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{const e=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),e}}}const xo=new b4("appCheck","AppCheck",{"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"});function eee(n){if(!w2(n).activated)throw xo.create("use-before-activation",{appName:n.name})}function HR(n,t){return FR.apply(this,arguments)}function FR(){return FR=I(function*({url:n,body:t},e){var r,s;const i={"Content-Type":"application/json"},o=e.getImmediate({optional:!0});if(o){const b=yield o.getHeartbeatsHeader();b&&(i["X-Firebase-Client"]=b)}const c={method:"POST",body:JSON.stringify(t),headers:i};let u,d;try{u=yield fetch(n,c)}catch(b){throw xo.create("fetch-network-error",{originalErrorMessage:null===(r=b)||void 0===r?void 0:r.message})}if(200!==u.status)throw xo.create("fetch-status-error",{httpStatus:u.status});try{d=yield u.json()}catch(b){throw xo.create("fetch-parse-error",{originalErrorMessage:null===(s=b)||void 0===s?void 0:s.message})}const g=d.ttl.match(/^([\d.]+)(s)$/);if(!g||!g[2]||isNaN(Number(g[1])))throw xo.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${d.ttl}`});const m=1e3*Number(g[1]),y=Date.now();return{token:d.token,expireTimeMillis:y+m,issuedAtTimeMillis:y}}),FR.apply(this,arguments)}function kSe(n,t){const{projectId:e,appId:r,apiKey:s}=n.options;return{url:`https://content-firebaseappcheck.googleapis.com/v1/projects/${e}/apps/${r}:exchangeDebugToken?key=${s}`,body:{debug_token:t}}}const nm="firebase-app-check-store";let uS=null;function nee(){return uS||(uS=new Promise((n,t)=>{var e;try{const r=indexedDB.open("firebase-app-check-database",1);r.onsuccess=s=>{n(s.target.result)},r.onerror=s=>{var i;t(xo.create("storage-open",{originalErrorMessage:null===(i=s.target.error)||void 0===i?void 0:i.message}))},r.onupgradeneeded=s=>{0===s.oldVersion&&s.target.result.createObjectStore(nm,{keyPath:"compositeKey"})}}catch(r){t(xo.create("storage-open",{originalErrorMessage:null===(e=r)||void 0===e?void 0:e.message}))}}),uS)}function BR(){return BR=I(function*(n,t){const r=(yield nee()).transaction(nm,"readwrite"),i=r.objectStore(nm).put({compositeKey:n,value:t});return new Promise((o,c)=>{i.onsuccess=u=>{o()},r.onerror=u=>{var d;c(xo.create("storage-set",{originalErrorMessage:null===(d=u.target.error)||void 0===d?void 0:d.message}))}})}),BR.apply(this,arguments)}const rm=new wf("@firebase/app-check");function GR(n,t){return Vu()?function zSe(n,t){return function ree(n,t){return BR.apply(this,arguments)}(function iee(n){return`${n.options.appId}-${n.name}`}(n),t)}(n,t).catch(e=>{rm.warn(`Failed to write token to IndexedDB. Error: ${e}`)}):Promise.resolve()}function oee(){return aS().enabled}function aee(){return qR.apply(this,arguments)}function qR(){return qR=I(function*(){const n=aS();if(n.enabled&&n.token)return n.token.promise;throw Error("\n            Can't get debug token in production mode.\n        ")}),qR.apply(this,arguments)}const USe={error:"UNKNOWN_ERROR"};function GSe(n){return FN.encodeString(JSON.stringify(n),!1)}function fS(n){return jR.apply(this,arguments)}function jR(){return jR=I(function*(n,t=!1){const e=n.app;eee(e);const r=w2(e);let i,s=r.token;if(s&&!pd(s)&&(r.token=void 0,s=void 0),!s){const u=yield r.cachedTokenPromise;u&&(pd(u)?s=u:yield GR(e,void 0))}if(!t&&s&&pd(s))return{token:s.token};let c,o=!1;if(oee()){r.exchangeTokenPromise||(r.exchangeTokenPromise=HR(kSe(e,yield aee()),n.heartbeatServiceProvider).finally(()=>{r.exchangeTokenPromise=void 0}),o=!0);const u=yield r.exchangeTokenPromise;return yield GR(e,u),r.token=u,{token:u.token}}try{r.exchangeTokenPromise||(r.exchangeTokenPromise=r.provider.getToken().finally(()=>{r.exchangeTokenPromise=void 0}),o=!0),s=yield w2(e).exchangeTokenPromise}catch(u){"appCheck/throttled"===u.code?rm.warn(u.message):rm.error(u),i=u}return s?i?c=pd(s)?{token:s.token,internalError:i}:uee(i):(c={token:s.token},r.token=s,yield GR(e,s)):c=uee(i),o&&lee(e,c),c}),jR.apply(this,arguments)}function YR(n,t){const e=w2(n),r=e.tokenObservers.filter(s=>s.next!==t);0===r.length&&e.tokenRefresher&&e.tokenRefresher.isRunning()&&e.tokenRefresher.stop(),e.tokenObservers=r}function cee(n){const{app:t}=n,e=w2(t);let r=e.tokenRefresher;r||(r=function WSe(n){const{app:t}=n;return new OSe(I(function*(){let r;if(r=w2(t).token?yield fS(n,!0):yield fS(n),r.error)throw r.error;if(r.internalError)throw r.internalError}),()=>!0,()=>{const e=w2(t);if(e.token){let r=e.token.issuedAtTimeMillis+.5*(e.token.expireTimeMillis-e.token.issuedAtTimeMillis)+3e5;return r=Math.min(r,e.token.expireTimeMillis-3e5),Math.max(0,r-Date.now())}return 0},3e4,96e4)}(n),e.tokenRefresher=r),!r.isRunning()&&e.isTokenAutoRefreshEnabled&&r.start()}function lee(n,t){const e=w2(n).tokenObservers;for(const r of e)try{"EXTERNAL"===r.type&&null!=t.error?r.error(t.error):r.next(t)}catch{}}function pd(n){return n.expireTimeMillis-Date.now()>0}function uee(n){return{token:GSe(USe),error:n}}class qSe{constructor(t,e){this.app=t,this.heartbeatServiceProvider=e}_delete(){const{tokenObservers:t}=w2(this.app);for(const e of t)YR(this.app,e.next);return Promise.resolve()}}const vee="app-check-internal";!function oPe(){Oo(new X2("app-check",n=>function jSe(n,t){return new qSe(n,t)}(n.getProvider("app").getImmediate(),n.getProvider("heartbeat")),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((n,t,e)=>{n.getProvider(vee).initialize()})),Oo(new X2(vee,n=>function ZSe(n){return{getToken:t=>fS(n,t),addTokenListener:t=>function ZR(n,t,e,r){const{app:s}=n,i=w2(s);if(i.tokenObservers=[...i.tokenObservers,{next:e,error:r,type:t}],i.token&&pd(i.token)){const c=i.token;Promise.resolve().then(()=>{e({token:c.token}),cee(n)}).catch(()=>{})}i.cachedTokenPromise.then(()=>cee(n))}(n,"INTERNAL",t),removeTokenListener:t=>YR(n.app,t)}}(n.getProvider("app-check").getImmediate()),"PUBLIC").setInstantiationMode("EXPLICIT")),ds("@firebase/app-check","0.5.17")}();class JR{constructor(){return xR("app-check")}}typeof window<"u"&&window;const fPe=function yee(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},Eee=new b4("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),Mee=new wf("@firebase/auth");function hS(n,...t){Mee.logLevel<=p1.ERROR&&Mee.error(`Auth (${Of}): ${n}`,...t)}function da(n,...t){throw tD(n,...t)}function ja(n,...t){return tD(n,...t)}function See(n,t,e){const r=Object.assign(Object.assign({},fPe()),{[t]:e});return new b4("auth","Firebase",r).create(t,{appName:n.name})}function gd(n,t,e){if(!(t instanceof e))throw e.name!==t.constructor.name&&da(n,"argument-error"),See(n,"argument-error",`Type of ${t.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function tD(n,...t){if("string"!=typeof n){const e=t[0],r=[...t.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(e,...r)}return Eee.create(n,...t)}function nt(n,t,...e){if(!n)throw tD(t,...e)}function R4(n){const t="INTERNAL ASSERTION FAILED: "+n;throw hS(t),new Error(t)}function e6(n,t){n||R4(t)}const Pee=new Map;function t6(n){e6(n instanceof Function,"Expected a class definition");let t=Pee.get(n);return t?(e6(t instanceof n,"Instance stored in cache mismatched with class"),t):(t=new n,Pee.set(n,t),t)}function sm(){var n;return typeof self<"u"&&(null===(n=self.location)||void 0===n?void 0:n.href)||""}function Tee(){var n;return typeof self<"u"&&(null===(n=self.location)||void 0===n?void 0:n.protocol)||null}class im{constructor(t,e){this.shortDelay=t,this.longDelay=e,e6(e>t,"Short delay should be less than long delay!"),this.isMobile=function hpe(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(ki())}()||function gpe(){return"object"==typeof navigator&&"ReactNative"===navigator.product}()}get(){return function pPe(){return!(typeof navigator<"u"&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(function nD(){return"http:"===Tee()||"https:"===Tee()}()||BN()||"connection"in navigator))||navigator.onLine}()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function rD(n,t){e6(n.emulator,"Emulator should always be set here");const{url:e}=n.emulator;return t?`${e}${t.startsWith("/")?t.slice(1):t}`:e}class wee{static initialize(t,e,r){this.fetchImpl=t,e&&(this.headersImpl=e),r&&(this.responseImpl=r)}static fetch(){return this.fetchImpl?this.fetchImpl:typeof self<"u"&&"fetch"in self?self.fetch:void R4("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:typeof self<"u"&&"Headers"in self?self.Headers:void R4("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:typeof self<"u"&&"Response"in self?self.Response:void R4("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const mPe={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error"},_Pe=new im(3e4,6e4);function mi(n,t){return n.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:n.tenantId}):t}function Hi(n,t,e,r){return sD.apply(this,arguments)}function sD(){return sD=I(function*(n,t,e,r,s={}){return bee(n,s,I(function*(){let i={},o={};r&&("GET"===t?o=r:i={body:JSON.stringify(r)});const c=Xp(Object.assign({key:n.config.apiKey},o)).slice(1),u=yield n._getAdditionalHeaders();return u["Content-Type"]="application/json",n.languageCode&&(u["X-Firebase-Locale"]=n.languageCode),wee.fetch()(Oee(n,n.config.apiHost,e,c),Object.assign({method:t,headers:u,referrerPolicy:"no-referrer"},i))}))}),sD.apply(this,arguments)}function bee(n,t,e){return iD.apply(this,arguments)}function iD(){return iD=I(function*(n,t,e){n._canInitEmulator=!1;const r=Object.assign(Object.assign({},mPe),t);try{const s=new vPe(n),i=yield Promise.race([e(),s.promise]);s.clearNetworkTimeout();const o=yield i.json();if("needConfirmation"in o)throw om(n,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const c=i.ok?o.errorMessage:o.error.message,[u,d]=c.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===u)throw om(n,"credential-already-in-use",o);if("EMAIL_EXISTS"===u)throw om(n,"email-already-in-use",o);if("USER_DISABLED"===u)throw om(n,"user-disabled",o);const g=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw See(n,g,d);da(n,g)}}catch(s){if(s instanceof kc)throw s;da(n,"network-request-failed")}}),iD.apply(this,arguments)}function n6(n,t,e,r){return oD.apply(this,arguments)}function oD(){return oD=I(function*(n,t,e,r,s={}){const i=yield Hi(n,t,e,r,s);return"mfaPendingCredential"in i&&da(n,"multi-factor-auth-required",{_serverResponse:i}),i}),oD.apply(this,arguments)}function Oee(n,t,e,r){const s=`${t}${e}?${r}`;return n.config.emulator?rD(n.config,s):`${n.config.apiScheme}://${s}`}class vPe{constructor(t){this.auth=t,this.timer=null,this.promise=new Promise((e,r)=>{this.timer=setTimeout(()=>r(ja(this.auth,"network-request-failed")),_Pe.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function om(n,t,e){const r={appName:n.name};e.email&&(r.email=e.email),e.phoneNumber&&(r.phoneNumber=e.phoneNumber);const s=ja(n,t,r);return s.customData._tokenResponse=e,s}function aD(){return aD=I(function*(n,t){return Hi(n,"POST","/v1/accounts:delete",t)}),aD.apply(this,arguments)}function EPe(n,t){return lD.apply(this,arguments)}function lD(){return lD=I(function*(n,t){return Hi(n,"POST","/v1/accounts:lookup",t)}),lD.apply(this,arguments)}function am(n){if(n)try{const t=new Date(Number(n));if(!isNaN(t.getTime()))return t.toUTCString()}catch{}}function uD(){return uD=I(function*(n,t=!1){const e=es(n),r=yield e.getIdToken(t),s=pS(r);nt(s&&s.exp&&s.auth_time&&s.iat,e.auth,"internal-error");const i="object"==typeof s.firebase?s.firebase:void 0,o=i?.sign_in_provider;return{claims:s,token:r,authTime:am(fD(s.auth_time)),issuedAtTime:am(fD(s.iat)),expirationTime:am(fD(s.exp)),signInProvider:o||null,signInSecondFactor:i?.sign_in_second_factor||null}}),uD.apply(this,arguments)}function fD(n){return 1e3*Number(n)}function pS(n){var t;const[e,r,s]=n.split(".");if(void 0===e||void 0===r||void 0===s)return hS("JWT malformed, contained fewer than 3 sections"),null;try{const i=kE(r);return i?JSON.parse(i):(hS("Failed to decode base64 JWT payload"),null)}catch(i){return hS("Caught error parsing JWT payload as JSON",null===(t=i)||void 0===t?void 0:t.toString()),null}}function r6(n,t){return dD.apply(this,arguments)}function dD(){return dD=I(function*(n,t,e=!1){if(e)return t;try{return yield t}catch(r){throw r instanceof kc&&PPe(r)&&n.auth.currentUser===n&&(yield n.auth.signOut()),r}}),dD.apply(this,arguments)}function PPe({code:n}){return"auth/user-disabled"===n||"auth/user-token-expired"===n}class TPe{constructor(t){this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){!this.isRunning||(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(t){var e;if(t){const r=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),r}{this.errorBackoff=3e4;const s=(null!==(e=this.user.stsTokenManager.expirationTime)&&void 0!==e?e:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(t=!1){var e=this;if(!this.isRunning)return;const r=this.getInterval(t);this.timerId=setTimeout(I(function*(){yield e.iteration()}),r)}iteration(){var t=this;return I(function*(){var e;try{yield t.user.getIdToken(!0)}catch(r){return void("auth/network-request-failed"===(null===(e=r)||void 0===e?void 0:e.code)&&t.schedule(!0))}t.schedule()})()}}class Aee{constructor(t,e){this.createdAt=t,this.lastLoginAt=e,this._initializeTime()}_initializeTime(){this.lastSignInTime=am(this.lastLoginAt),this.creationTime=am(this.createdAt)}_copy(t){this.createdAt=t.createdAt,this.lastLoginAt=t.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}function cm(n){return hD.apply(this,arguments)}function hD(){return hD=I(function*(n){var t;const e=n.auth,r=yield n.getIdToken(),s=yield r6(n,EPe(e,{idToken:r}));nt(s?.users.length,e,"internal-error");const i=s.users[0];n._notifyReloadListener(i);const o=null!==(t=i.providerUserInfo)&&void 0!==t&&t.length?OPe(i.providerUserInfo):[],c=bPe(n.providerData,o),g=!!n.isAnonymous&&!(n.email&&i.passwordHash||c?.length),m={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:c,metadata:new Aee(i.createdAt,i.lastLoginAt),isAnonymous:g};Object.assign(n,m)}),hD.apply(this,arguments)}function pD(){return pD=I(function*(n){const t=es(n);yield cm(t),yield t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}),pD.apply(this,arguments)}function bPe(n,t){return[...n.filter(r=>!t.some(s=>s.providerId===r.providerId)),...t]}function OPe(n){return n.map(t=>{var{providerId:e}=t,r=B5(t,["providerId"]);return{providerId:e,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}function gD(){return gD=I(function*(n,t){const e=yield bee(n,{},I(function*(){const r=Xp({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:s,apiKey:i}=n.config,o=Oee(n,s,"/v1/token",`key=${i}`),c=yield n._getAdditionalHeaders();return c["Content-Type"]="application/x-www-form-urlencoded",wee.fetch()(o,{method:"POST",headers:c,body:r})}));return{accessToken:e.access_token,expiresIn:e.expires_in,refreshToken:e.refresh_token}}),gD.apply(this,arguments)}class lm{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(t){nt(t.idToken,"internal-error"),nt(typeof t.idToken<"u","internal-error"),nt(typeof t.refreshToken<"u","internal-error");const e="expiresIn"in t&&typeof t.expiresIn<"u"?Number(t.expiresIn):function SPe(n){const t=pS(n);return nt(t,"internal-error"),nt(typeof t.exp<"u","internal-error"),nt(typeof t.iat<"u","internal-error"),Number(t.exp)-Number(t.iat)}(t.idToken);this.updateTokensAndExpiration(t.idToken,t.refreshToken,e)}getToken(t,e=!1){var r=this;return I(function*(){return nt(!r.accessToken||r.refreshToken,t,"user-token-expired"),e||!r.accessToken||r.isExpired?r.refreshToken?(yield r.refresh(t,r.refreshToken),r.accessToken):null:r.accessToken})()}clearRefreshToken(){this.refreshToken=null}refresh(t,e){var r=this;return I(function*(){const{accessToken:s,refreshToken:i,expiresIn:o}=yield function APe(n,t){return gD.apply(this,arguments)}(t,e);r.updateTokensAndExpiration(s,i,Number(o))})()}updateTokensAndExpiration(t,e,r){this.refreshToken=e||null,this.accessToken=t||null,this.expirationTime=Date.now()+1e3*r}static fromJSON(t,e){const{refreshToken:r,accessToken:s,expirationTime:i}=e,o=new lm;return r&&(nt("string"==typeof r,"internal-error",{appName:t}),o.refreshToken=r),s&&(nt("string"==typeof s,"internal-error",{appName:t}),o.accessToken=s),i&&(nt("number"==typeof i,"internal-error",{appName:t}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(t){this.accessToken=t.accessToken,this.refreshToken=t.refreshToken,this.expirationTime=t.expirationTime}_clone(){return Object.assign(new lm,this.toJSON())}_performRefresh(){return R4("not implemented")}}function K0(n,t){nt("string"==typeof n||typeof n>"u","internal-error",{appName:t})}class C5{constructor(t){var{uid:e,auth:r,stsTokenManager:s}=t,i=B5(t,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new TPe(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Aee(i.createdAt||void 0,i.lastLoginAt||void 0)}getIdToken(t){var e=this;return I(function*(){const r=yield r6(e,e.stsTokenManager.getToken(e.auth,t));return nt(r,e.auth,"internal-error"),e.accessToken!==r&&(e.accessToken=r,yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)),r})()}getIdTokenResult(t){return function MPe(n){return uD.apply(this,arguments)}(this,t)}reload(){return function wPe(n){return pD.apply(this,arguments)}(this)}_assign(t){this!==t&&(nt(this.uid===t.uid,this.auth,"internal-error"),this.displayName=t.displayName,this.photoURL=t.photoURL,this.email=t.email,this.emailVerified=t.emailVerified,this.phoneNumber=t.phoneNumber,this.isAnonymous=t.isAnonymous,this.tenantId=t.tenantId,this.providerData=t.providerData.map(e=>Object.assign({},e)),this.metadata._copy(t.metadata),this.stsTokenManager._assign(t.stsTokenManager))}_clone(t){return new C5(Object.assign(Object.assign({},this),{auth:t,stsTokenManager:this.stsTokenManager._clone()}))}_onReload(t){nt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=t,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(t){this.reloadListener?this.reloadListener(t):this.reloadUserInfo=t}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(t,e=!1){var r=this;return I(function*(){let s=!1;t.idToken&&t.idToken!==r.stsTokenManager.accessToken&&(r.stsTokenManager.updateFromServerResponse(t),s=!0),e&&(yield cm(r)),yield r.auth._persistUserIfCurrent(r),s&&r.auth._notifyListenersIfCurrent(r)})()}delete(){var t=this;return I(function*(){const e=yield t.getIdToken();return yield r6(t,function CPe(n,t){return aD.apply(this,arguments)}(t.auth,{idToken:e})),t.stsTokenManager.clearRefreshToken(),t.auth.signOut()})()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(t=>Object.assign({},t)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(t,e){var r,s,i,o,c,u,d,g;const m=null!==(r=e.displayName)&&void 0!==r?r:void 0,y=null!==(s=e.email)&&void 0!==s?s:void 0,b=null!==(i=e.phoneNumber)&&void 0!==i?i:void 0,k=null!==(o=e.photoURL)&&void 0!==o?o:void 0,$=null!==(c=e.tenantId)&&void 0!==c?c:void 0,K=null!==(u=e._redirectEventId)&&void 0!==u?u:void 0,oe=null!==(d=e.createdAt)&&void 0!==d?d:void 0,ye=null!==(g=e.lastLoginAt)&&void 0!==g?g:void 0,{uid:te,emailVerified:Le,isAnonymous:Ge,providerData:Qe,stsTokenManager:Ft}=e;nt(te&&Ft,t,"internal-error");const z1=lm.fromJSON(this.name,Ft);nt("string"==typeof te,t,"internal-error"),K0(m,t.name),K0(y,t.name),nt("boolean"==typeof Le,t,"internal-error"),nt("boolean"==typeof Ge,t,"internal-error"),K0(b,t.name),K0(k,t.name),K0($,t.name),K0(K,t.name),K0(oe,t.name),K0(ye,t.name);const O1=new C5({uid:te,auth:t,email:y,emailVerified:Le,displayName:m,isAnonymous:Ge,photoURL:k,phoneNumber:b,tenantId:$,stsTokenManager:z1,createdAt:oe,lastLoginAt:ye});return Qe&&Array.isArray(Qe)&&(O1.providerData=Qe.map(os=>Object.assign({},os))),K&&(O1._redirectEventId=K),O1}static _fromIdTokenResponse(t,e,r=!1){return I(function*(){const s=new lm;s.updateFromServerResponse(e);const i=new C5({uid:e.localId,auth:t,stsTokenManager:s,isAnonymous:r});return yield cm(i),i})()}}const Nee=(()=>{class n{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return I(function*(){return!0})()}_set(e,r){var s=this;return I(function*(){s.storage[e]=r})()}_get(e){var r=this;return I(function*(){const s=r.storage[e];return void 0===s?null:s})()}_remove(e){var r=this;return I(function*(){delete r.storage[e]})()}_addListener(e,r){}_removeListener(e,r){}}return n.type="NONE",n})();function gS(n,t,e){return`firebase:${n}:${t}:${e}`}class md{constructor(t,e,r){this.persistence=t,this.auth=e,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=gS(this.userKey,s.apiKey,i),this.fullPersistenceKey=gS("persistence",s.apiKey,i),this.boundEventHandler=e._onStorageEvent.bind(e),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(t){return this.persistence._set(this.fullUserKey,t.toJSON())}getCurrentUser(){var t=this;return I(function*(){const e=yield t.persistence._get(t.fullUserKey);return e?C5._fromJSON(t.auth,e):null})()}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(t){var e=this;return I(function*(){if(e.persistence===t)return;const r=yield e.getCurrentUser();return yield e.removeCurrentUser(),e.persistence=t,r?e.setCurrentUser(r):void 0})()}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(t,e,r="authUser"){return I(function*(){if(!e.length)return new md(t6(Nee),t,r);const s=(yield Promise.all(e.map(function(){var d=I(function*(g){if(yield g._isAvailable())return g});return function(g){return d.apply(this,arguments)}}()))).filter(d=>d);let i=s[0]||t6(Nee);const o=gS(r,t.config.apiKey,t.name);let c=null;for(const d of e)try{const g=yield d._get(o);if(g){const m=C5._fromJSON(t,g);d!==i&&(c=m),i=d;break}}catch{}const u=s.filter(d=>d._shouldAllowMigration);return i._shouldAllowMigration&&u.length?(i=u[0],c&&(yield i._set(o,c.toJSON())),yield Promise.all(e.map(function(){var d=I(function*(g){if(g!==i)try{yield g._remove(o)}catch{}});return function(g){return d.apply(this,arguments)}}())),new md(i,t,r)):new md(i,t,r)})()}}function Iee(n){const t=n.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(Lee(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(xee(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(Dee(t))return"Blackberry";if(zee(t))return"Webos";if(mD(t))return"Safari";if((t.includes("chrome/")||kee(t))&&!t.includes("edge/"))return"Chrome";if(Ree(t))return"Android";{const r=n.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if(2===r?.length)return r[1]}return"Other"}function xee(n=ki()){return/firefox\//i.test(n)}function mD(n=ki()){const t=n.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function kee(n=ki()){return/crios\//i.test(n)}function Lee(n=ki()){return/iemobile/i.test(n)}function Ree(n=ki()){return/android/i.test(n)}function Dee(n=ki()){return/blackberry/i.test(n)}function zee(n=ki()){return/webos/i.test(n)}function mS(n=ki()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function Vee(n=ki()){return mS(n)||Ree(n)||zee(n)||Dee(n)||/windows phone/i.test(n)||Lee(n)}function Hee(n,t=[]){let e;switch(n){case"Browser":e=Iee(ki());break;case"Worker":e=`${Iee(ki())}-${n}`;break;default:e=n}const r=t.length?t.join(","):"FirebaseCore-web";return`${e}/JsCore/${Of}/${r}`}class kPe{constructor(t){this.auth=t,this.queue=[]}pushCallback(t,e){const r=i=>new Promise((o,c)=>{try{o(t(i))}catch(u){c(u)}});r.onAbort=e,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}runMiddleware(t){var e=this;return I(function*(){var r;if(e.auth.currentUser===t)return;const s=[];try{for(const i of e.queue)yield i(t),i.onAbort&&s.push(i.onAbort)}catch(i){s.reverse();for(const o of s)try{o()}catch{}throw e.auth._errorFactory.create("login-blocked",{originalMessage:null===(r=i)||void 0===r?void 0:r.message})}})()}}class LPe{constructor(t,e,r){this.app=t,this.heartbeatServiceProvider=e,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Fee(this),this.idTokenSubscription=new Fee(this),this.beforeStateQueue=new kPe(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Eee,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=r.sdkClientVersion}_initializeWithPersistence(t,e){var r=this;return e&&(this._popupRedirectResolver=t6(e)),this._initializationPromise=this.queue(I(function*(){var s,i;if(!r._deleted&&(r.persistenceManager=yield md.create(r,t),!r._deleted)){if(null!==(s=r._popupRedirectResolver)&&void 0!==s&&s._shouldInitProactively)try{yield r._popupRedirectResolver._initialize(r)}catch{}yield r.initializeCurrentUser(e),r.lastNotifiedUid=(null===(i=r.currentUser)||void 0===i?void 0:i.uid)||null,!r._deleted&&(r._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){var t=this;return I(function*(){if(t._deleted)return;const e=yield t.assertedPersistence.getCurrentUser();if(t.currentUser||e){if(t.currentUser&&e&&t.currentUser.uid===e.uid)return t._currentUser._assign(e),void(yield t.currentUser.getIdToken());yield t._updateCurrentUser(e,!0)}})()}initializeCurrentUser(t){var e=this;return I(function*(){var r;const s=yield e.assertedPersistence.getCurrentUser();let i=s,o=!1;if(t&&e.config.authDomain){yield e.getOrInitRedirectPersistenceManager();const c=null===(r=e.redirectUser)||void 0===r?void 0:r._redirectEventId,u=i?._redirectEventId,d=yield e.tryRedirectSignIn(t);(!c||c===u)&&d?.user&&(i=d.user,o=!0)}if(!i)return e.directlySetCurrentUser(null);if(!i._redirectEventId){if(o)try{yield e.beforeStateQueue.runMiddleware(i)}catch(c){i=s,e._popupRedirectResolver._overrideRedirectResult(e,()=>Promise.reject(c))}return i?e.reloadAndSetCurrentUserOrClear(i):e.directlySetCurrentUser(null)}return nt(e._popupRedirectResolver,e,"argument-error"),yield e.getOrInitRedirectPersistenceManager(),e.redirectUser&&e.redirectUser._redirectEventId===i._redirectEventId?e.directlySetCurrentUser(i):e.reloadAndSetCurrentUserOrClear(i)})()}tryRedirectSignIn(t){var e=this;return I(function*(){let r=null;try{r=yield e._popupRedirectResolver._completeRedirectFn(e,t,!0)}catch{yield e._setRedirectUser(null)}return r})()}reloadAndSetCurrentUserOrClear(t){var e=this;return I(function*(){var r;try{yield cm(t)}catch(s){if("auth/network-request-failed"!==(null===(r=s)||void 0===r?void 0:r.code))return e.directlySetCurrentUser(null)}return e.directlySetCurrentUser(t)})()}useDeviceLanguage(){this.languageCode=function gPe(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}()}_delete(){var t=this;return I(function*(){t._deleted=!0})()}updateCurrentUser(t){var e=this;return I(function*(){const r=t?es(t):null;return r&&nt(r.auth.config.apiKey===e.config.apiKey,e,"invalid-user-token"),e._updateCurrentUser(r&&r._clone(e))})()}_updateCurrentUser(t,e=!1){var r=this;return I(function*(){if(!r._deleted)return t&&nt(r.tenantId===t.tenantId,r,"tenant-id-mismatch"),e||(yield r.beforeStateQueue.runMiddleware(t)),r.queue(I(function*(){yield r.directlySetCurrentUser(t),r.notifyAuthListeners()}))})()}signOut(){var t=this;return I(function*(){return yield t.beforeStateQueue.runMiddleware(null),(t.redirectPersistenceManager||t._popupRedirectResolver)&&(yield t._setRedirectUser(null)),t._updateCurrentUser(null,!0)})()}setPersistence(t){var e=this;return this.queue(I(function*(){yield e.assertedPersistence.setPersistence(t6(t))}))}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(t){this._errorFactory=new b4("auth","Firebase",t())}onAuthStateChanged(t,e,r){return this.registerStateListener(this.authStateSubscription,t,e,r)}beforeAuthStateChanged(t,e){return this.beforeStateQueue.pushCallback(t,e)}onIdTokenChanged(t,e,r){return this.registerStateListener(this.idTokenSubscription,t,e,r)}toJSON(){var t;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(t=this._currentUser)||void 0===t?void 0:t.toJSON()}}_setRedirectUser(t,e){var r=this;return I(function*(){const s=yield r.getOrInitRedirectPersistenceManager(e);return null===t?s.removeCurrentUser():s.setCurrentUser(t)})()}getOrInitRedirectPersistenceManager(t){var e=this;return I(function*(){if(!e.redirectPersistenceManager){const r=t&&t6(t)||e._popupRedirectResolver;nt(r,e,"argument-error"),e.redirectPersistenceManager=yield md.create(e,[t6(r._redirectPersistence)],"redirectUser"),e.redirectUser=yield e.redirectPersistenceManager.getCurrentUser()}return e.redirectPersistenceManager})()}_redirectUserForId(t){var e=this;return I(function*(){var r,s;return e._isInitialized&&(yield e.queue(I(function*(){}))),(null===(r=e._currentUser)||void 0===r?void 0:r._redirectEventId)===t?e._currentUser:(null===(s=e.redirectUser)||void 0===s?void 0:s._redirectEventId)===t?e.redirectUser:null})()}_persistUserIfCurrent(t){var e=this;return I(function*(){if(t===e.currentUser)return e.queue(I(function*(){return e.directlySetCurrentUser(t)}))})()}_notifyListenersIfCurrent(t){t===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t,e;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=null!==(e=null===(t=this.currentUser)||void 0===t?void 0:t.uid)&&void 0!==e?e:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(t,e,r,s){if(this._deleted)return()=>{};const i="function"==typeof e?e:e.next.bind(e),o=this._isInitialized?Promise.resolve():this._initializationPromise;return nt(o,this,"internal-error"),o.then(()=>i(this.currentUser)),"function"==typeof e?t.addObserver(e,r,s):t.addObserver(e)}directlySetCurrentUser(t){var e=this;return I(function*(){e.currentUser&&e.currentUser!==t&&e._currentUser._stopProactiveRefresh(),t&&e.isProactiveRefreshEnabled&&t._startProactiveRefresh(),e.currentUser=t,t?yield e.assertedPersistence.setCurrentUser(t):yield e.assertedPersistence.removeCurrentUser()})()}queue(t){return this.operations=this.operations.then(t,t),this.operations}get assertedPersistence(){return nt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(t){!t||this.frameworks.includes(t)||(this.frameworks.push(t),this.frameworks.sort(),this.clientVersion=Hee(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){var t=this;return I(function*(){var e;const r={"X-Client-Version":t.clientVersion};t.app.options.appId&&(r["X-Firebase-gmpid"]=t.app.options.appId);const s=yield null===(e=t.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader();return s&&(r["X-Firebase-Client"]=s),r})()}}function ha(n){return es(n)}class Fee{constructor(t){this.auth=t,this.observer=null,this.addObserver=function Ope(n,t){const e=new Ape(n,t);return e.subscribe.bind(e)}(e=>this.observer=e)}get next(){return nt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function Bee(n,t,e){const r=ha(n);nt(r._canInitEmulator,r,"emulator-config-failed"),nt(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");const s=!!e?.disableWarnings,i=$ee(t),{host:o,port:c}=function RPe(n){const t=$ee(n),e=/(\/\/)?([^?#/]+)/.exec(n.substr(t.length));if(!e)return{host:"",port:null};const r=e[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:Uee(r.substr(i.length+1))}}{const[i,o]=r.split(":");return{host:i,port:Uee(o)}}}(t);r.config.emulator={url:`${i}//${o}${null===c?"":`:${c}`}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:c,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})}),s||function DPe(){function n(){const t=document.createElement("p"),e=t.style;t.innerText="Running in emulator mode. Do not use with production credentials.",e.position="fixed",e.width="100%",e.backgroundColor="#ffffff",e.border=".1em solid #000000",e.color="#b50000",e.bottom="0px",e.left="0px",e.margin="0px",e.zIndex="10000",e.textAlign="center",t.classList.add("firebase-emulator-warning"),document.body.appendChild(t)}typeof console<"u"&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",n):n())}()}function $ee(n){const t=n.indexOf(":");return t<0?"":n.substr(0,t+1)}function Uee(n){if(!n)return null;const t=Number(n);return isNaN(t)?null:t}class _D{constructor(t,e){this.providerId=t,this.signInMethod=e}toJSON(){return R4("not implemented")}_getIdTokenResponse(t){return R4("not implemented")}_linkToIdToken(t,e){return R4("not implemented")}_getReauthenticationResolver(t){return R4("not implemented")}}function CD(){return CD=I(function*(n,t){return Hi(n,"POST","/v1/accounts:update",t)}),CD.apply(this,arguments)}function ED(){return ED=I(function*(n,t){return n6(n,"POST","/v1/accounts:signInWithPassword",mi(n,t))}),ED.apply(this,arguments)}function _S(n,t){return MD.apply(this,arguments)}function MD(){return MD=I(function*(n,t){return Hi(n,"POST","/v1/accounts:sendOobCode",mi(n,t))}),MD.apply(this,arguments)}function HPe(n,t){return SD.apply(this,arguments)}function SD(){return SD=I(function*(n,t){return _S(n,t)}),SD.apply(this,arguments)}function FPe(n,t){return PD.apply(this,arguments)}function PD(){return PD=I(function*(n,t){return _S(n,t)}),PD.apply(this,arguments)}function bD(){return bD=I(function*(n,t){return n6(n,"POST","/v1/accounts:signInWithEmailLink",mi(n,t))}),bD.apply(this,arguments)}function OD(){return OD=I(function*(n,t){return n6(n,"POST","/v1/accounts:signInWithEmailLink",mi(n,t))}),OD.apply(this,arguments)}class um extends _D{constructor(t,e,r,s=null){super("password",r),this._email=t,this._password=e,this._tenantId=s}static _fromEmailAndPassword(t,e){return new um(t,e,"password")}static _fromEmailAndCode(t,e,r=null){return new um(t,e,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(t){const e="string"==typeof t?JSON.parse(t):t;if(e?.email&&e?.password){if("password"===e.signInMethod)return this._fromEmailAndPassword(e.email,e.password);if("emailLink"===e.signInMethod)return this._fromEmailAndCode(e.email,e.password,e.tenantId)}return null}_getIdTokenResponse(t){var e=this;return I(function*(){switch(e.signInMethod){case"password":return function VPe(n,t){return ED.apply(this,arguments)}(t,{returnSecureToken:!0,email:e._email,password:e._password});case"emailLink":return function UPe(n,t){return bD.apply(this,arguments)}(t,{email:e._email,oobCode:e._password});default:da(t,"internal-error")}})()}_linkToIdToken(t,e){var r=this;return I(function*(){switch(r.signInMethod){case"password":return function Wee(n,t){return CD.apply(this,arguments)}(t,{idToken:e,returnSecureToken:!0,email:r._email,password:r._password});case"emailLink":return function GPe(n,t){return OD.apply(this,arguments)}(t,{idToken:e,email:r._email,oobCode:r._password});default:da(t,"internal-error")}})()}_getReauthenticationResolver(t){return this._getIdTokenResponse(t)}}function s6(n,t){return AD.apply(this,arguments)}function AD(){return AD=I(function*(n,t){return n6(n,"POST","/v1/accounts:signInWithIdp",mi(n,t))}),AD.apply(this,arguments)}class _d extends _D{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(t){const e=new _d(t.providerId,t.signInMethod);return t.idToken||t.accessToken?(t.idToken&&(e.idToken=t.idToken),t.accessToken&&(e.accessToken=t.accessToken),t.nonce&&!t.pendingToken&&(e.nonce=t.nonce),t.pendingToken&&(e.pendingToken=t.pendingToken)):t.oauthToken&&t.oauthTokenSecret?(e.accessToken=t.oauthToken,e.secret=t.oauthTokenSecret):da("argument-error"),e}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(t){const e="string"==typeof t?JSON.parse(t):t,{providerId:r,signInMethod:s}=e,i=B5(e,["providerId","signInMethod"]);if(!r||!s)return null;const o=new _d(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(t){return s6(t,this.buildRequest())}_linkToIdToken(t,e){const r=this.buildRequest();return r.idToken=e,s6(t,r)}_getReauthenticationResolver(t){const e=this.buildRequest();return e.autoCreate=!1,s6(t,e)}buildRequest(){const t={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)t.pendingToken=this.pendingToken;else{const e={};this.idToken&&(e.id_token=this.idToken),this.accessToken&&(e.access_token=this.accessToken),this.secret&&(e.oauth_token_secret=this.secret),e.providerId=this.providerId,this.nonce&&!this.pendingToken&&(e.nonce=this.nonce),t.postBody=Xp(e)}return t}}class dm{constructor(t){var e,r,s,i,o,c;const u=Qp(Jp(t)),d=null!==(e=u.apiKey)&&void 0!==e?e:null,g=null!==(r=u.oobCode)&&void 0!==r?r:null,m=function XPe(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(s=u.mode)&&void 0!==s?s:null);nt(d&&g&&m,"argument-error"),this.apiKey=d,this.operation=m,this.code=g,this.continueUrl=null!==(i=u.continueUrl)&&void 0!==i?i:null,this.languageCode=null!==(o=u.languageCode)&&void 0!==o?o:null,this.tenantId=null!==(c=u.tenantId)&&void 0!==c?c:null}static parseLink(t){const e=function QPe(n){const t=Qp(Jp(n)).link,e=t?Qp(Jp(t)).deep_link_id:null,r=Qp(Jp(n)).deep_link_id;return(r?Qp(Jp(r)).link:null)||r||e||t||n}(t);try{return new dm(e)}catch{return null}}}let qee=(()=>{class n{constructor(){this.providerId=n.PROVIDER_ID}static credential(e,r){return um._fromEmailAndPassword(e,r)}static credentialWithLink(e,r){const s=dm.parseLink(r);return nt(s,"argument-error"),um._fromEmailAndCode(e,s.code,s.tenantId)}}return n.PROVIDER_ID="password",n.EMAIL_PASSWORD_SIGN_IN_METHOD="password",n.EMAIL_LINK_SIGN_IN_METHOD="emailLink",n})();class X0{constructor(t){this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(t){this.defaultLanguageCode=t}setCustomParameters(t){return this.customParameters=t,this}getCustomParameters(){return this.customParameters}}class jee extends X0{constructor(){super(...arguments),this.scopes=[]}addScope(t){return this.scopes.includes(t)||this.scopes.push(t),this}getScopes(){return[...this.scopes]}}let JPe=(()=>{class n extends jee{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return _d._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return n.credentialFromTaggedObject(e)}static credentialFromError(e){return n.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:s}=e;if(!r&&!s)return null;try{return n.credential(r,s)}catch{return null}}}return n.GOOGLE_SIGN_IN_METHOD="google.com",n.PROVIDER_ID="google.com",n})();function Zee(n,t){return RD.apply(this,arguments)}function RD(){return RD=I(function*(n,t){return n6(n,"POST","/v1/accounts:signUp",mi(n,t))}),RD.apply(this,arguments)}class Lc{constructor(t){this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}static _fromIdTokenResponse(t,e,r,s=!1){return I(function*(){const i=yield C5._fromIdTokenResponse(t,r,s),o=Yee(r);return new Lc({user:i,providerId:o,_tokenResponse:r,operationType:e})})()}static _forOperation(t,e,r){return I(function*(){yield t._updateTokensIfNecessary(r,!0);const s=Yee(r);return new Lc({user:t,providerId:s,_tokenResponse:r,operationType:e})})()}}function Yee(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class CS extends kc{constructor(t,e,r,s){var i;super(e.code,e.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,CS.prototype),this.customData={appName:t.name,tenantId:null!==(i=t.tenantId)&&void 0!==i?i:void 0,_serverResponse:e.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(t,e,r,s){return new CS(t,e,r,s)}}function Kee(n,t,e,r){return("reauthenticate"===t?e._getReauthenticationResolver(n):e._getIdTokenResponse(n)).catch(i=>{throw"auth/multi-factor-auth-required"===i.code?CS._fromErrorAndOperation(n,i,t,r):i})}function VD(n,t){return HD.apply(this,arguments)}function HD(){return HD=I(function*(n,t,e=!1){const r=yield r6(n,t._linkToIdToken(n.auth,yield n.getIdToken()),e);return Lc._forOperation(n,"link",r)}),HD.apply(this,arguments)}function BD(){return BD=I(function*(n,t,e=!1){var r;const{auth:s}=n,i="reauthenticate";try{const o=yield r6(n,Kee(s,i,t,n),e);nt(o.idToken,s,"internal-error");const c=pS(o.idToken);nt(c,s,"internal-error");const{sub:u}=c;return nt(n.uid===u,s,"user-mismatch"),Lc._forOperation(n,i,o)}catch(o){throw"auth/user-not-found"===(null===(r=o)||void 0===r?void 0:r.code)&&da(s,"user-mismatch"),o}}),BD.apply(this,arguments)}function Jee(n,t){return $D.apply(this,arguments)}function $D(){return $D=I(function*(n,t,e=!1){const r="signIn",s=yield Kee(n,r,t),i=yield Lc._fromIdTokenResponse(n,r,s);return e||(yield n._updateCurrentUser(i.user)),i}),$D.apply(this,arguments)}function GD(){return GD=I(function*(n,t){return Jee(ha(n),t)}),GD.apply(this,arguments)}function ES(n,t,e){var r;nt((null===(r=e.url)||void 0===r?void 0:r.length)>0,n,"invalid-continue-uri"),nt(typeof e.dynamicLinkDomain>"u"||e.dynamicLinkDomain.length>0,n,"invalid-dynamic-link-domain"),t.continueUrl=e.url,t.dynamicLinkDomain=e.dynamicLinkDomain,t.canHandleCodeInApp=e.handleCodeInApp,e.iOS&&(nt(e.iOS.bundleId.length>0,n,"missing-ios-bundle-id"),t.iOSBundleId=e.iOS.bundleId),e.android&&(nt(e.android.packageName.length>0,n,"missing-android-pkg-name"),t.androidInstallApp=e.android.installApp,t.androidMinimumVersionCode=e.android.minimumVersion,t.androidPackageName=e.android.packageName)}function iTe(n,t,e){return XD.apply(this,arguments)}function XD(){return XD=I(function*(n,t,e){const r=es(n),s={requestType:"PASSWORD_RESET",email:t};e&&ES(r,s,e),yield FPe(r,s)}),XD.apply(this,arguments)}function aTe(n,t,e){return nz.apply(this,arguments)}function nz(){return nz=I(function*(n,t,e){const r=ha(n),s=yield Zee(r,{returnSecureToken:!0,email:t,password:e}),i=yield Lc._fromIdTokenResponse(r,"signIn",s);return yield r._updateCurrentUser(i.user),i}),nz.apply(this,arguments)}function cTe(n,t,e){return function UD(n,t){return GD.apply(this,arguments)}(es(n),qee.credential(t,e))}function uTe(n,t){return az.apply(this,arguments)}function az(){return az=I(function*(n,t){const e=es(n),s={requestType:"VERIFY_EMAIL",idToken:yield n.getIdToken()};t&&ES(e.auth,s,t);const{email:i}=yield HPe(e.auth,s);i!==n.email&&(yield n.reload())}),az.apply(this,arguments)}function fTe(n,t){return lz.apply(this,arguments)}function lz(){return lz=I(function*(n,t){return Hi(n,"POST","/v1/accounts:update",t)}),lz.apply(this,arguments)}function dTe(n,t){return uz.apply(this,arguments)}function uz(){return uz=I(function*(n,{displayName:t,photoURL:e}){if(void 0===t&&void 0===e)return;const r=es(n),i={idToken:yield r.getIdToken(),displayName:t,photoUrl:e,returnSecureToken:!0},o=yield r6(r,fTe(r.auth,i));r.displayName=o.displayName||null,r.photoURL=o.photoUrl||null;const c=r.providerData.find(({providerId:u})=>"password"===u);c&&(c.displayName=r.displayName,c.photoURL=r.photoURL),yield r._updateTokensIfNecessary(o)}),uz.apply(this,arguments)}function yTe(n,t,e,r){return es(n).onAuthStateChanged(t,e,r)}const MS="__sak";class tte{constructor(t,e){this.storageRetriever=t,this.type=e}_isAvailable(){try{return this.storage?(this.storage.setItem(MS,"1"),this.storage.removeItem(MS),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(t,e){return this.storage.setItem(t,JSON.stringify(e)),Promise.resolve()}_get(t){const e=this.storage.getItem(t);return Promise.resolve(e?JSON.parse(e):null)}_remove(t){return this.storage.removeItem(t),Promise.resolve()}get storage(){return this.storageRetriever()}}const bTe=(()=>{class n extends tte{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function PTe(){const n=ki();return mD(n)||mS(n)}()&&function xPe(){try{return!(!window||window===window.top)}catch{return!1}}(),this.fallbackToPolling=Vee(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const s=this.storage.getItem(r),i=this.localCache[r];s!==i&&e(r,i,s)}}onStorageEvent(e,r=!1){if(!e.key)return void this.forAllChangedKeys((c,u,d)=>{this.notifyListeners(c,d)});const s=e.key;if(r?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const c=this.storage.getItem(s);if(e.newValue!==c)null!==e.newValue?this.storage.setItem(s,e.newValue):this.storage.removeItem(s);else if(this.localCache[s]===e.newValue&&!r)return}const i=()=>{const c=this.storage.getItem(s);!r&&this.localCache[s]===c||this.notifyListeners(s,c)},o=this.storage.getItem(s);!function IPe(){return function mpe(){const n=ki();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}()&&10===document.documentMode}()||o===e.newValue||e.newValue===e.oldValue?i():setTimeout(i,10)}notifyListeners(e,r){this.localCache[e]=r;const s=this.listeners[e];if(s)for(const i of Array.from(s))i(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,s)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:s}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}_set(e,r){var s=()=>super._set,i=this;return I(function*(){yield s().call(i,e,r),i.localCache[e]=JSON.stringify(r)})()}_get(e){var r=()=>super._get,s=this;return I(function*(){const i=yield r().call(s,e);return s.localCache[e]=JSON.stringify(i),i})()}_remove(e){var r=()=>super._remove,s=this;return I(function*(){yield r().call(s,e),delete s.localCache[e]})()}}return n.type="LOCAL",n})(),nte=(()=>{class n extends tte{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}return n.type="SESSION",n})();let ATe=(()=>{class n{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(i=>i.isListeningto(e));if(r)return r;const s=new n(e);return this.receivers.push(s),s}isListeningto(e){return this.eventTarget===e}handleEvent(e){var r=this;return I(function*(){const s=e,{eventId:i,eventType:o,data:c}=s.data,u=r.handlersMap[o];if(!u?.size)return;s.ports[0].postMessage({status:"ack",eventId:i,eventType:o});const d=Array.from(u).map(function(){var m=I(function*(y){return y(s.origin,c)});return function(y){return m.apply(this,arguments)}}()),g=yield function OTe(n){return Promise.all(n.map(function(){var t=I(function*(e){try{return{fulfilled:!0,value:yield e}}catch(r){return{fulfilled:!1,reason:r}}});return function(e){return t.apply(this,arguments)}}()))}(d);s.ports[0].postMessage({status:"done",eventId:i,eventType:o,response:g})})()}_subscribe(e,r){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||0===this.handlersMap[e].size)&&delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}return n.receivers=[],n})();function SS(n="",t=10){let e="";for(let r=0;r<t;r++)e+=Math.floor(10*Math.random());return n+e}class NTe{constructor(t){this.target=t,this.handlers=new Set}removeMessageHandler(t){t.messageChannel&&(t.messageChannel.port1.removeEventListener("message",t.onMessage),t.messageChannel.port1.close()),this.handlers.delete(t)}_send(t,e,r=50){var s=this;return I(function*(){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let o,c;return new Promise((u,d)=>{const g=SS("",20);i.port1.start();const m=setTimeout(()=>{d(new Error("unsupported_event"))},r);c={messageChannel:i,onMessage(y){const b=y;if(b.data.eventId===g)switch(b.data.status){case"ack":clearTimeout(m),o=setTimeout(()=>{d(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),u(b.data.response);break;default:clearTimeout(m),clearTimeout(o),d(new Error("invalid_response"))}}},s.handlers.add(c),i.port1.addEventListener("message",c.onMessage),s.target.postMessage({eventType:t,eventId:g,data:e},[i.port2])}).finally(()=>{c&&s.removeMessageHandler(c)})})()}}function _i(){return window}function _z(){return typeof _i().WorkerGlobalScope<"u"&&"function"==typeof _i().importScripts}function vz(){return(vz=I(function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})).apply(this,arguments)}const rte="firebaseLocalStorageDb",PS="firebaseLocalStorage",ste="fbase_key";class pm{constructor(t){this.request=t}toPromise(){return new Promise((t,e)=>{this.request.addEventListener("success",()=>{t(this.request.result)}),this.request.addEventListener("error",()=>{e(this.request.error)})})}}function TS(n,t){return n.transaction([PS],t?"readwrite":"readonly").objectStore(PS)}function Cz(){const n=indexedDB.open(rte,1);return new Promise((t,e)=>{n.addEventListener("error",()=>{e(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(PS,{keyPath:ste})}catch(s){e(s)}}),n.addEventListener("success",I(function*(){const r=n.result;r.objectStoreNames.contains(PS)?t(r):(r.close(),yield function DTe(){const n=indexedDB.deleteDatabase(rte);return new pm(n).toPromise()}(),t(yield Cz()))}))})}function ite(n,t,e){return yz.apply(this,arguments)}function yz(){return yz=I(function*(n,t,e){const r=TS(n,!0).put({[ste]:t,value:e});return new pm(r).toPromise()}),yz.apply(this,arguments)}function Ez(){return Ez=I(function*(n,t){const e=TS(n,!1).get(t),r=yield new pm(e).toPromise();return void 0===r?null:r.value}),Ez.apply(this,arguments)}function ote(n,t){const e=TS(n,!0).delete(t);return new pm(e).toPromise()}const FTe=(()=>{class n{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){var e=this;return I(function*(){return e.db||(e.db=yield Cz()),e.db})()}_withRetries(e){var r=this;return I(function*(){let s=0;for(;;)try{const i=yield r._openDb();return yield e(i)}catch(i){if(s++>3)throw i;r.db&&(r.db.close(),r.db=void 0)}})()}initializeServiceWorkerMessaging(){var e=this;return I(function*(){return _z()?e.initializeReceiver():e.initializeSender()})()}initializeReceiver(){var e=this;return I(function*(){e.receiver=ATe._getInstance(function LTe(){return _z()?self:null}()),e.receiver._subscribe("keyChanged",function(){var r=I(function*(s,i){return{keyProcessed:(yield e._poll()).includes(i.key)}});return function(s,i){return r.apply(this,arguments)}}()),e.receiver._subscribe("ping",function(){var r=I(function*(s,i){return["keyChanged"]});return function(s,i){return r.apply(this,arguments)}}())})()}initializeSender(){var e=this;return I(function*(){var r,s;if(e.activeServiceWorker=yield function xTe(){return vz.apply(this,arguments)}(),!e.activeServiceWorker)return;e.sender=new NTe(e.activeServiceWorker);const i=yield e.sender._send("ping",{},800);!i||(null===(r=i[0])||void 0===r?void 0:r.fulfilled)&&(null===(s=i[0])||void 0===s?void 0:s.value.includes("keyChanged"))&&(e.serviceWorkerReceiverAvailable=!0)})()}notifyServiceWorker(e){var r=this;return I(function*(){if(r.sender&&r.activeServiceWorker&&function kTe(){var n;return(null===(n=navigator?.serviceWorker)||void 0===n?void 0:n.controller)||null}()===r.activeServiceWorker)try{yield r.sender._send("keyChanged",{key:e},r.serviceWorkerReceiverAvailable?800:50)}catch{}})()}_isAvailable(){return I(function*(){try{if(!indexedDB)return!1;const e=yield Cz();return yield ite(e,MS,"1"),yield ote(e,MS),!0}catch{}return!1})()}_withPendingWrite(e){var r=this;return I(function*(){r.pendingWrites++;try{yield e()}finally{r.pendingWrites--}})()}_set(e,r){var s=this;return I(function*(){return s._withPendingWrite(I(function*(){return yield s._withRetries(i=>ite(i,e,r)),s.localCache[e]=r,s.notifyServiceWorker(e)}))})()}_get(e){var r=this;return I(function*(){const s=yield r._withRetries(i=>function zTe(n,t){return Ez.apply(this,arguments)}(i,e));return r.localCache[e]=s,s})()}_remove(e){var r=this;return I(function*(){return r._withPendingWrite(I(function*(){return yield r._withRetries(s=>ote(s,e)),delete r.localCache[e],r.notifyServiceWorker(e)}))})()}_poll(){var e=this;return I(function*(){const r=yield e._withRetries(o=>{const c=TS(o,!1).getAll();return new pm(c).toPromise()});if(!r)return[];if(0!==e.pendingWrites)return[];const s=[],i=new Set;for(const{fbase_key:o,value:c}of r)i.add(o),JSON.stringify(e.localCache[o])!==JSON.stringify(c)&&(e.notifyListeners(o,c),s.push(o));for(const o of Object.keys(e.localCache))e.localCache[o]&&!i.has(o)&&(e.notifyListeners(o,null),s.push(o));return s})()}notifyListeners(e,r){this.localCache[e]=r;const s=this.listeners[e];if(s)for(const i of Array.from(s))i(r)}startPolling(){var e=this;this.stopPolling(),this.pollTimer=setInterval(I(function*(){return e._poll()}),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}return n.type="LOCAL",n})();function cte(n){return`__${n}${Math.floor(1e6*Math.random())}`}function E5(n,t){return t?t6(t):(nt(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}cte("rcb"),new im(3e4,6e4);class Iz extends _D{constructor(t){super("custom","custom"),this.params=t}_getIdTokenResponse(t){return s6(t,this._buildIdpRequest())}_linkToIdToken(t,e){return s6(t,this._buildIdpRequest(e))}_getReauthenticationResolver(t){return s6(t,this._buildIdpRequest())}_buildIdpRequest(t){const e={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return t&&(e.idToken=t),e}}function rwe(n){return Jee(n.auth,new Iz(n),n.bypassAuthState)}function swe(n){const{auth:t,user:e}=n;return nt(e,t,"internal-error"),function Qee(n,t){return BD.apply(this,arguments)}(e,new Iz(n),n.bypassAuthState)}function iwe(n){return xz.apply(this,arguments)}function xz(){return xz=I(function*(n){const{auth:t,user:e}=n;return nt(e,t,"internal-error"),VD(e,new Iz(n),n.bypassAuthState)}),xz.apply(this,arguments)}class ute{constructor(t,e,r,s,i=!1){this.auth=t,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(e)?e:[e]}execute(){var t=this;return new Promise(function(){var e=I(function*(r,s){t.pendingPromise={resolve:r,reject:s};try{t.eventManager=yield t.resolver._initialize(t.auth),yield t.onExecution(),t.eventManager.registerConsumer(t)}catch(i){t.reject(i)}});return function(r,s){return e.apply(this,arguments)}}())}onAuthEvent(t){var e=this;return I(function*(){const{urlResponse:r,sessionId:s,postBody:i,tenantId:o,error:c,type:u}=t;if(c)return void e.reject(c);const d={auth:e.auth,requestUri:r,sessionId:s,tenantId:o||void 0,postBody:i||void 0,user:e.user,bypassAuthState:e.bypassAuthState};try{e.resolve(yield e.getIdpTask(u)(d))}catch(g){e.reject(g)}})()}onError(t){this.reject(t)}getIdpTask(t){switch(t){case"signInViaPopup":case"signInViaRedirect":return rwe;case"linkViaPopup":case"linkViaRedirect":return iwe;case"reauthViaPopup":case"reauthViaRedirect":return swe;default:da(this.auth,"internal-error")}}resolve(t){e6(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(t),this.unregisterAndCleanUp()}reject(t){e6(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(t),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const owe=new im(2e3,1e4);function awe(n,t,e){return kz.apply(this,arguments)}function kz(){return kz=I(function*(n,t,e){const r=ha(n);gd(n,t,X0);const s=E5(r,e);return new Dz(r,"signInViaPopup",t,s).executeNotNull()}),kz.apply(this,arguments)}let Dz=(()=>{class n extends ute{constructor(e,r,s,i,o){super(e,r,i,o),this.provider=s,this.authWindow=null,this.pollId=null,n.currentPopupAction&&n.currentPopupAction.cancel(),n.currentPopupAction=this}executeNotNull(){var e=this;return I(function*(){const r=yield e.execute();return nt(r,e.auth,"internal-error"),r})()}onExecution(){var e=this;return I(function*(){e6(1===e.filter.length,"Popup operations only handle one event");const r=SS();e.authWindow=yield e.resolver._openPopup(e.auth,e.provider,e.filter[0],r),e.authWindow.associatedEvent=r,e.resolver._originValidation(e.auth).catch(s=>{e.reject(s)}),e.resolver._isIframeWebStorageSupported(e.auth,s=>{s||e.reject(ja(e.auth,"web-storage-unsupported"))}),e.pollUserCancellation()})()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(ja(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,n.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,s;this.pollId=null!==(s=null===(r=this.authWindow)||void 0===r?void 0:r.window)&&void 0!==s&&s.closed?window.setTimeout(()=>{this.pollId=null,this.reject(ja(this.auth,"popup-closed-by-user"))},2e3):window.setTimeout(e,owe.get())};e()}}return n.currentPopupAction=null,n})();const gm=new Map;class lwe extends ute{constructor(t,e,r=!1){super(t,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],e,void 0,r),this.eventId=null}execute(){var t=()=>super.execute,e=this;return I(function*(){let r=gm.get(e.auth._key());if(!r){try{const i=(yield function uwe(n,t){return zz.apply(this,arguments)}(e.resolver,e.auth))?yield t().call(e):null;r=()=>Promise.resolve(i)}catch(s){r=()=>Promise.reject(s)}gm.set(e.auth._key(),r)}return e.bypassAuthState||gm.set(e.auth._key(),()=>Promise.resolve(null)),r()})()}onAuthEvent(t){var e=()=>super.onAuthEvent,r=this;return I(function*(){if("signInViaRedirect"===t.type)return e().call(r,t);if("unknown"!==t.type){if(t.eventId){const s=yield r.auth._redirectUserForId(t.eventId);if(s)return r.user=s,e().call(r,t);r.resolve(null)}}else r.resolve(null)})()}onExecution(){return I(function*(){})()}cleanUp(){}}function zz(){return zz=I(function*(n,t){const e=dte(t),r=fte(n);if(!(yield r._isAvailable()))return!1;const s="true"===(yield r._get(e));return yield r._remove(e),s}),zz.apply(this,arguments)}function fwe(n,t){gm.set(n._key(),t)}function fte(n){return t6(n._redirectPersistence)}function dte(n){return gS("pendingRedirect",n.config.apiKey,n.name)}function hte(n,t){return Gz.apply(this,arguments)}function Gz(){return Gz=I(function*(n,t,e=!1){const r=ha(n),s=E5(r,t),o=yield new lwe(r,s,e).execute();return o&&!e&&(delete o.user._redirectEventId,yield r._persistUserIfCurrent(o.user),yield r._setRedirectUser(null,t)),o}),Gz.apply(this,arguments)}class mwe{constructor(t){this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(t){this.consumers.add(t),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,t)&&(this.sendToConsumer(this.queuedRedirectEvent,t),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(t){this.consumers.delete(t)}onEvent(t){if(this.hasEventBeenHandled(t))return!1;let e=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(t,r)&&(e=!0,this.sendToConsumer(t,r),this.saveEventToCache(t))}),this.hasHandledPotentialRedirect||!function _we(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return mte(n);default:return!1}}(t)||(this.hasHandledPotentialRedirect=!0,e||(this.queuedRedirectEvent=t,e=!0)),e}sendToConsumer(t,e){var r;if(t.error&&!mte(t)){const s=(null===(r=t.error.code)||void 0===r?void 0:r.split("auth/")[1])||"internal-error";e.onError(ja(this.auth,s))}else e.onAuthEvent(t)}isEventForConsumer(t,e){const r=null===e.eventId||!!t.eventId&&t.eventId===e.eventId;return e.filter.includes(t.type)&&r}hasEventBeenHandled(t){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(gte(t))}saveEventToCache(t){this.cachedEventUids.add(gte(t)),this.lastProcessedEventTime=Date.now()}}function gte(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(t=>t).join("-")}function mte({type:n,error:t}){return"unknown"===n&&"auth/no-auth-event"===t?.code}function vwe(n){return qz.apply(this,arguments)}function qz(){return qz=I(function*(n,t={}){return Hi(n,"GET","/v1/projects",t)}),qz.apply(this,arguments)}const Cwe=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,ywe=/^https?/;function jz(){return jz=I(function*(n){if(n.config.emulator)return;const{authorizedDomains:t}=yield vwe(n);for(const e of t)try{if(Mwe(e))return}catch{}da(n,"unauthorized-domain")}),jz.apply(this,arguments)}function Mwe(n){const t=sm(),{protocol:e,hostname:r}=new URL(t);if(n.startsWith("chrome-extension://")){const o=new URL(n);return""===o.hostname&&""===r?"chrome-extension:"===e&&n.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===e&&o.hostname===r}if(!ywe.test(e))return!1;if(Cwe.test(n))return r===n;const s=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}const Swe=new im(3e4,6e4);function _te(){const n=_i().___jsl;if(n?.H)for(const t of Object.keys(n.H))if(n.H[t].r=n.H[t].r||[],n.H[t].L=n.H[t].L||[],n.H[t].r=[...n.H[t].L],n.CP)for(let e=0;e<n.CP.length;e++)n.CP[e]=null}let bS=null;function Twe(n){return bS=bS||function Pwe(n){return new Promise((t,e)=>{var r,s,i;function o(){_te(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{_te(),e(ja(n,"network-request-failed"))},timeout:Swe.get()})}if(null!==(s=null===(r=_i().gapi)||void 0===r?void 0:r.iframes)&&void 0!==s&&s.Iframe)t(gapi.iframes.getContext());else{if(null===(i=_i().gapi)||void 0===i||!i.load){const c=cte("iframefcb");return _i()[c]=()=>{gapi.load?o():e(ja(n,"network-request-failed"))},function ate(n){return new Promise((t,e)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=t,r.onerror=s=>{const i=ja("internal-error");i.customData=s,e(i)},r.type="text/javascript",r.charset="UTF-8",function GTe(){var n,t;return null!==(t=null===(n=document.getElementsByTagName("head"))||void 0===n?void 0:n[0])&&void 0!==t?t:document}().appendChild(r)})}(`https://apis.google.com/js/api.js?onload=${c}`).catch(u=>e(u))}o()}}).catch(t=>{throw bS=null,t})}(n),bS}const wwe=new im(5e3,15e3),Awe={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Nwe=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Iwe(n){const t=n.config;nt(t.authDomain,n,"auth-domain-config-required");const e=t.emulator?rD(t,"emulator/auth/iframe"):`https://${n.config.authDomain}/__/auth/iframe`,r={apiKey:t.apiKey,appName:n.name,v:Of},s=Nwe.get(n.config.apiHost);s&&(r.eid=s);const i=n._getFrameworks();return i.length&&(r.fw=i.join(",")),`${e}?${Xp(r).slice(1)}`}function Zz(){return Zz=I(function*(n){const t=yield Twe(n),e=_i().gapi;return nt(e,n,"internal-error"),t.open({where:document.body,url:Iwe(n),messageHandlersFilter:e.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Awe,dontclear:!0},r=>new Promise(function(){var s=I(function*(i,o){yield r.restyle({setHideOnLeave:!1});const c=ja(n,"network-request-failed"),u=_i().setTimeout(()=>{o(c)},wwe.get());function d(){_i().clearTimeout(u),i(r)}r.ping(d).then(d,()=>{o(c)})});return function(i,o){return s.apply(this,arguments)}}()))}),Zz.apply(this,arguments)}const kwe={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class vte{constructor(t){this.window=t,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function Cte(n,t,e,r,s,i){nt(n.config.authDomain,n,"auth-domain-config-required"),nt(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:e,redirectUrl:r,v:Of,eventId:s};if(t instanceof X0){t.setDefaultLanguage(n.languageCode),o.providerId=t.providerId||"",function bpe(n){for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t))return!1;return!0}(t.getCustomParameters())||(o.customParameters=JSON.stringify(t.getCustomParameters()));for(const[u,d]of Object.entries(i||{}))o[u]=d}if(t instanceof jee){const u=t.getScopes().filter(d=>""!==d);u.length>0&&(o.scopes=u.join(","))}n.tenantId&&(o.tid=n.tenantId);const c=o;for(const u of Object.keys(c))void 0===c[u]&&delete c[u];return`${function $we({config:n}){return n.emulator?rD(n,"emulator/auth/handler"):`https://${n.authDomain}/__/auth/handler`}(n)}?${Xp(c).slice(1)}`}const Yz="webStorageSupport",Gwe=class Uwe{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=nte,this._completeRedirectFn=hte,this._overrideRedirectResult=fwe}_openPopup(t,e,r,s){var i=this;return I(function*(){var o;e6(null===(o=i.eventManagers[t._key()])||void 0===o?void 0:o.manager,"_initialize() not called before _openPopup()");const c=Cte(t,e,r,sm(),s);return function Vwe(n,t,e,r=500,s=600){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let c="";const u=Object.assign(Object.assign({},kwe),{width:r.toString(),height:s.toString(),top:i,left:o}),d=ki().toLowerCase();e&&(c=kee(d)?"_blank":e),xee(d)&&(t=t||"http://localhost",u.scrollbars="yes");const g=Object.entries(u).reduce((y,[b,k])=>`${y}${b}=${k},`,"");if(function NPe(n=ki()){var t;return mS(n)&&!(null===(t=window.navigator)||void 0===t||!t.standalone)}(d)&&"_self"!==c)return function Hwe(n,t){const e=document.createElement("a");e.href=n,e.target=t;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),e.dispatchEvent(r)}(t||"",c),new vte(null);const m=window.open(t||"",c,g);nt(m,n,"popup-blocked");try{m.focus()}catch{}return new vte(m)}(t,c,SS())})()}_openRedirect(t,e,r,s){var i=this;return I(function*(){return yield i._originValidation(t),function ITe(n){_i().location.href=n}(Cte(t,e,r,sm(),s)),new Promise(()=>{})})()}_initialize(t){const e=t._key();if(this.eventManagers[e]){const{manager:s,promise:i}=this.eventManagers[e];return s?Promise.resolve(s):(e6(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(t);return this.eventManagers[e]={promise:r},r.catch(()=>{delete this.eventManagers[e]}),r}initAndGetManager(t){var e=this;return I(function*(){const r=yield function xwe(n){return Zz.apply(this,arguments)}(t),s=new mwe(t);return r.register("authEvent",i=>(nt(i?.authEvent,t,"invalid-auth-event"),{status:s.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),e.eventManagers[t._key()]={manager:s},e.iframes[t._key()]=r,s})()}_isIframeWebStorageSupported(t,e){this.iframes[t._key()].send(Yz,{type:Yz},s=>{var i;const o=null===(i=s?.[0])||void 0===i?void 0:i[Yz];void 0!==o&&e(!!o),da(t,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(t){const e=t._key();return this.originValidationPromises[e]||(this.originValidationPromises[e]=function Ewe(n){return jz.apply(this,arguments)}(t)),this.originValidationPromises[e]}get _shouldInitProactively(){return Vee()||mD()||mS()}};var Ete="@firebase/auth";class Wwe{constructor(t){this.auth=t,this.internalListeners=new Map}getUid(){var t;return this.assertAuthConfigured(),(null===(t=this.auth.currentUser)||void 0===t?void 0:t.uid)||null}getToken(t){var e=this;return I(function*(){return e.assertAuthConfigured(),yield e.auth._initializationPromise,e.auth.currentUser?{accessToken:yield e.auth.currentUser.getIdToken(t)}:null})()}addAuthTokenListener(t){if(this.assertAuthConfigured(),this.internalListeners.has(t))return;const e=this.auth.onIdTokenChanged(r=>{var s;t((null===(s=r)||void 0===s?void 0:s.stsTokenManager.accessToken)||null)});this.internalListeners.set(t,e),this.updateProactiveRefresh()}removeAuthTokenListener(t){this.assertAuthConfigured();const e=this.internalListeners.get(t);!e||(this.internalListeners.delete(t),e(),this.updateProactiveRefresh())}assertAuthConfigured(){nt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const Ywe=MZ("authIdTokenMaxAge")||300;let Ste=null;const Kwe=n=>function(){var t=I(function*(e){const r=e&&(yield e.getIdTokenResult()),s=r&&((new Date).getTime()-Date.parse(r.issuedAtTime))/1e3;if(s&&s>Ywe)return;const i=r?.token;Ste!==i&&(Ste=i,yield fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))});return function(e){return t.apply(this,arguments)}}();function Xwe(n=nI()){const t=bf(n,"auth");if(t.isInitialized())return t.getImmediate();const e=function dPe(n,t){const e=bf(n,"auth");if(e.isInitialized()){const s=e.getImmediate();if(DE(e.getOptions(),t??{}))return s;da(s,"already-initialized")}return e.initialize({options:t})}(n,{popupRedirectResolver:Gwe,persistence:[FTe,bTe,nte]}),r=MZ("authTokenSyncURL");if(r){const i=Kwe(r);(function CTe(n,t,e){es(n).beforeAuthStateChanged(t,e)})(e,i,()=>i(e.currentUser)),function vTe(n,t,e,r){es(n).onIdTokenChanged(t,e,r)}(e,o=>i(o))}const s=EZ("auth");return s&&Bee(e,`http://${s}`),e}!function jwe(n){Oo(new X2("auth",(t,{options:e})=>{const r=t.getProvider("app").getImmediate(),s=t.getProvider("heartbeat"),{apiKey:i,authDomain:o}=r.options;return((c,u)=>{nt(i&&!i.includes(":"),"invalid-api-key",{appName:c.name}),nt(!o?.includes(":"),"argument-error",{appName:c.name});const d={apiKey:i,authDomain:o,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Hee(n)},g=new LPe(c,u,d);return function hPe(n,t){const e=t?.persistence||[],r=(Array.isArray(e)?e:[e]).map(t6);t?.errorMap&&n._updateErrorMap(t.errorMap),n._initializeWithPersistence(r,t?.popupRedirectResolver)}(g,e),g})(r,s)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,e,r)=>{t.getProvider("auth-internal").initialize()})),Oo(new X2("auth-internal",t=>{const e=ha(t.getProvider("auth").getImmediate());return new Wwe(e)},"PRIVATE").setInstantiationMode("EXPLICIT")),ds(Ete,"0.20.11",function qwe(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(n)),ds(Ete,"0.20.11","esm2017")}("Browser");class OS{constructor(t){return t}}class Tte{constructor(){return xR("auth")}}const Kz=new Lt("angularfire2.auth-instances");function Jwe(n){return(t,e)=>{const r=t.runOutsideAngular(()=>n(e));return new OS(r)}}const ebe={provide:Tte,deps:[[new ui,Kz]]},tbe={provide:OS,useFactory:function Qwe(n,t){const e=IR("auth",n,t);return e&&new OS(e)},deps:[[new ui,Kz],hd]};let nbe=(()=>{class n{constructor(){ds("angularfire",oS.full,"auth")}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=oi({type:n}),n.\u0275inj=Yr({providers:[tbe,ebe]}),n})();const ibe=Tr(aTe,!0),obe=Tr(Xwe,!0),abe=Tr(yTe,!0),cbe=Tr(uTe,!0),lbe=Tr(iTe,!0),ube=Tr(cTe,!0),fbe=Tr(awe,!0),dbe=Tr(dTe,!0);class Q0{constructor(t){return t}}const Xz=new Lt("angularfire2.firestore-instances");function gbe(n){return(t,e)=>{const r=t.runOutsideAngular(()=>n(e));return new Q0(r)}}const mbe={provide:class hbe{constructor(){return xR("firestore")}},deps:[[new ui,Xz]]},_be={provide:Q0,useFactory:function pbe(n,t){const e=IR("firestore",n,t);return e&&new Q0(e)},deps:[[new ui,Xz],hd]};let vbe=(()=>{class n{constructor(){ds("angularfire",oS.full,"fst")}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=oi({type:n}),n.\u0275inj=Yr({providers:[_be,mbe]}),n})();const ybe=Tr(vye,!0),Ebe=Tr(LCe,!0),Sbe=Tr(_ye,!0),mm=Tr(PQ,!0),Pbe=Tr(hye,!0),Tbe=Tr(pye,!0),wbe=Tr(KCe,!0),bbe=Tr(uye,!0),bte=Tr(Cye,!0),Obe=Tr(lye,!0),AS=Tr(iye,!0),Abe=Tr(gye,!0),Nbe=Tr(mye,!0),Ibe=Tr(aye,!0);let _m=(()=>{class n{constructor(e,r){this.collectionName=e,this.firestore=r,this.subDAOs={};this.collection=Ebe(r,this.collectionName).withConverter({fromFirestore:i=>i.data(),toFirestore:i=>i})}create(e){var r=this;return I(function*(){return Q(n.VERBOSE,{called:r.collectionName+".create",newElement:e}),(yield ybe(r.collection,e)).id})()}read(e){var r=this;return I(function*(){Q(n.VERBOSE,{called:r.collectionName+".read",id:e});const s=yield Pbe(mm(r.collection,e));return s.exists()?T.of(Me.getNonNullable(s.data())):T.empty()})()}exists(e){var r=this;return I(function*(){return Q(n.VERBOSE,{called:r.collectionName+".exists",id:e}),(yield r.read(e)).isPresent()})()}update(e,r){var s=this;return I(function*(){return Q(n.VERBOSE,{called:s.collectionName+".update",id:e,update:r}),Nbe(mm(s.collection,e),r)})()}delete(e){return Q(n.VERBOSE,{called:this.collectionName+".delete",id:e}),Sbe(mm(this.collection,e))}set(e,r){return Q(n.VERBOSE,{called:this.collectionName+".set",id:e,element:r}),Abe(mm(this.collection,e),r)}subscribeToChanges(e,r){return new q1(bte(mm(this.collection,e),s=>{r(T.ofNullable(s.data()))}))}findWhere(e,r,s){var i=this;return I(function*(){const o=i.constructQuery(e,r,s);return(yield Tbe(o)).docs.map(u=>({id:u.id,data:u.data()}))})()}observingWhere(e,r,s){Q(n.VERBOSE,{called:this.collectionName+".observingWhere"});const i=this.constructQuery(e,s);return new q1(bte(i,o=>{const c=[],u=[],d=[];o.docChanges().forEach(g=>{const m={id:g.doc.id,data:g.doc.data()};switch(g.type){case"added":c.push(m);break;case"modified":u.push(m);break;case"removed":d.push(m)}}),c.length>0&&(Q(n.VERBOSE,"firebase gave us "+c.length+" NEW "+this.collectionName),r.onDocumentCreated(c)),u.length>0&&(Q(n.VERBOSE,"firebase gave us "+u.length+" MODIFIED "+this.collectionName),r.onDocumentModified(u)),d.length>0&&(Q(n.VERBOSE,"firebase gave us "+d.length+" DELETED "+this.collectionName),r.onDocumentDeleted(d))}))}constructQuery(e,r,s){let i=AS(this.collection);null!=r&&(i=AS(i,Obe(r))),null!=s&&(i=AS(i,bbe(s)));for(const o of e)i=AS(i,Ibe(o[0],o[1],o[2]));return i}subCollectionDAO(e,r){const s=`${this.collection.path}/${e}/${r}`;if(s in this.subDAOs)return this.subDAOs[s];{const i=new class extends n{constructor(o){super(s,o)}}(this.firestore);return this.subDAOs[s]=i,i}}}return n.VERBOSE=!1,n})(),xbe=(()=>{class n extends _m{constructor(e){super("errors",e)}}return n.\u0275fac=function(e){return new(e||n)(Ve(Q0))},n.\u0275prov=rt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var kbe=lc(2486);let En=(()=>{class n{infoMessage(e){this.message(e,"is-info")}gameMessage(e){this.message(e,"is-warning")}criticalMessage(e){this.message(e,"is-danger")}message(e,r){(0,kbe.toast)({message:e,duration:3e3,position:"top-center",closeOnClick:!0,type:r,dismissible:!0})}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=rt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class As{constructor(t,e,r){this.errorDAO=t,this.router=e,this.messageDisplayer=r,As.setSingletonInstance(this)}static setSingletonInstance(t){As.singleton=T.of(t)}static logErrorAndFail(t,e,r){throw As.logError(t,e,r),new Error(`${t}: ${e} (extra data: ${JSON.stringify(r)})`)}static logError(t,e,r){if(this.singleton.isAbsent())throw new Error(`${t}: ${e} (extra data: ${JSON.stringify(r)})`);return this.singleton.get().logError(t,e,r),R.failure(t+": "+e)}findErrors(t,e,r,s){return this.errorDAO.findWhere(void 0===s?[["component","==",t],["route","==",e],["message","==",r]]:[["component","==",t],["route","==",e],["message","==",r],["data","==",s]])}logError(t,e,r){var s=this;return I(function*(){s.messageDisplayer.criticalMessage($localize`An unexpected error was encountered. We have logged it and will try to fix its cause as soon as possible.`);const i=s.router.url,o=yield s.findErrors(t,i,e,r);if(0===o.length){const c={component:t,route:i,message:e,firstEncounter:Y0(),lastEncounter:Y0(),occurences:1};null!=r&&(c.data=r),yield s.errorDAO.create(c)}else{const c=o[0].id,u=o[0].data;yield s.errorDAO.update(c,{lastEncounter:Y0(),occurences:u.occurences+1})}})()}}As.singleton=T.empty(),As.\u0275fac=function(t){return new(t||As)(Ve(xbe),Ve(Kn),Ve(En))},As.\u0275prov=rt({token:As,factory:As.\u0275fac,providedIn:"root"});class Me{static expectToBe(t,e,r){if(t!==e)throw void 0!==r?new Error(r):new Error(`A default switch case did not observe the correct value, expected ${e}, but got ${t} instead.`)}static expectToBeMultiple(t,e){let r=!1;for(const s of e)if(t===s){r=!0;break}if(!1===r)throw new Error(`A default switch case did not observe the correct value, expected a value among ${e}, but got ${t} instead.`)}static getNonNullable(t){if(null==t)throw new Error("Expected value not to be null or undefined, but it was.");return t}static assert(t,e){if(!1===t)throw As.logError("Assertion failure",e),new Error(`Assertion failure: ${e}`)}static identity(t){return t}}function Q(n,t){n&&console.log(t)}let Rbe=(()=>{class n extends _m{constructor(e){super("chats",e),Q(n.VERBOSE,"ChatDAO.constructor")}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Ve(Q0))},n.\u0275prov=rt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Ote=(()=>{class n{}return n.CANNOT_SEND_MESSAGE=()=>$localize`You're not allowed to send a message here.`,n.FORBIDDEN_MESSAGE=()=>$localize`This message is forbidden.`,n})(),NS=(()=>{class n{constructor(e){this.chatDAO=e,Q(n.VERBOSE,"ChatService.constructor")}addMessage(e,r){var s=this;return I(function*(){return s.chatDAO.subCollectionDAO(e,"messages").create(r)})()}getLastMessages(e,r){var s=this;return I(function*(){return s.chatDAO.subCollectionDAO(e,"messages").findWhere([],"postedTime",r)})()}subscribeToMessages(e,r){return this.chatDAO.subCollectionDAO(e,"messages").observingWhere([],r,"postedTime")}deleteChat(e){var r=this;return I(function*(){return Q(n.VERBOSE,"ChatService.deleteChat "+e),r.chatDAO.delete(e)})()}createNewChat(e){var r=this;return I(function*(){return r.chatDAO.set(e,{})})()}sendMessage(e,r,s,i){var o=this;return I(function*(){if(!1===o.userCanSendMessage(r.name,e))return R.failure(Ote.CANNOT_SEND_MESSAGE());if(o.isForbiddenMessage(s))return R.failure(Ote.FORBIDDEN_MESSAGE());const c={content:s,sender:r,postedTime:Y0(),currentTurn:i};return yield o.addMessage(e,c),R.SUCCESS})()}userCanSendMessage(e,r){return""!==e}isForbiddenMessage(e){return""===e}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Ve(Rbe))},n.\u0275prov=rt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),IS=(()=>{class n extends _m{constructor(e){super(n.COLLECTION_NAME,e),Q(n.VERBOSE,"UserDAO.constructor")}}return n.VERBOSE=!1,n.COLLECTION_NAME="users",n.\u0275fac=function(e){return new(e||n)(Ve(Q0))},n.\u0275prov=rt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),vm=(()=>{class n{constructor(e){this.userDAO=e}usernameIsAvailable(e){var r=this;return I(function*(){return 0===(yield r.userDAO.findWhere([["username","==",e]])).length})()}setUsername(e,r){var s=this;return I(function*(){yield s.userDAO.update(e,{username:r})})()}markAsVerified(e){var r=this;return I(function*(){yield r.userDAO.update(e,{verified:!0})})()}observeUser(e,r){return this.userDAO.subscribeToChanges(e,r)}getUserLastUpdateTime(e){var r=this;return I(function*(){const s=yield r.userDAO.read(e);if(s.isAbsent())return T.empty();{const i=s.get().lastUpdateTime;return Pe(null!=i,"should not receive a lastUpdateTime equal to null"),T.of(i)}})()}updatePresenceToken(e){return this.userDAO.update(e,{lastUpdateTime:Y0()})}}return n.\u0275fac=function(e){return new(e||n)(Ve(IS))},n.\u0275prov=rt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class Ate extends F2{constructor(t=1/0,e=1/0,r=SR){super(),this._bufferSize=t,this._windowTime=e,this._timestampProvider=r,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=e===1/0,this._bufferSize=Math.max(1,t),this._windowTime=Math.max(1,e)}next(t){const{isStopped:e,_buffer:r,_infiniteTimeWindow:s,_timestampProvider:i,_windowTime:o}=this;e||(r.push(t),!s&&r.push(i.now()+o)),this._trimBuffer(),super.next(t)}_subscribe(t){this._throwIfClosed(),this._trimBuffer();const e=this._innerSubscribe(t),{_infiniteTimeWindow:r,_buffer:s}=this,i=s.slice();for(let o=0;o<i.length&&!t.closed;o+=r?1:2)t.next(i[o]);return this._checkFinalizedStatuses(t),e}_trimBuffer(){const{_bufferSize:t,_timestampProvider:e,_buffer:r,_infiniteTimeWindow:s}=this,i=(s?1:2)*t;if(t<1/0&&i<r.length&&r.splice(0,r.length-i),!s){const o=e.now();let c=0;for(let u=1;u<r.length&&r[u]<=o;u+=2)c=u;c&&r.splice(0,c+1)}}}let Cm=(()=>{class n{}return n.YOU_ARE_ALREADY_PLAYING=()=>$localize`You are already playing in another game.`,n.YOU_ARE_ALREADY_CREATING=()=>$localize`You are already the creator of another game.`,n.YOU_ARE_ALREADY_CHOSEN_OPPONENT=()=>$localize`You are already the chosen opponent in another game.`,n.YOU_ARE_ALREADY_CANDIDATE=()=>$localize`You are already candidate in another game.`,n.YOU_ARE_ALREADY_OBSERVING=()=>$localize`You are already observing another game.`,n})();class J0{static createUserWithEmailAndPassword(t,e,r){return ibe(t,e,r)}static sendEmailVerification(t){return cbe(t)}static sendPasswordResetEmail(t,e){return lbe(t,e)}static signInWithEmailAndPassword(t,e,r){return I(function*(){return(yield ube(t,e,r)).user})()}static signInWithPopup(t,e){return I(function*(){return(yield fbe(t,e)).user})()}static updateProfile(t,e){return dbe(t,e)}}class M5{constructor(t,e,r,s){this.id=t,this.email=e,this.username=r,this.verified=s}isConnected(){return this.email.isPresent()}toMinimalUser(){return{id:this.id,name:this.username.get()}}equals(t){return this.id===t.id&&this.email.equals(t.email)&&this.username.equals(t.username)&&this.verified===t.verified}}M5.NOT_CONNECTED=new M5("",T.empty(),T.empty(),!1);let Ns=(()=>{class n{constructor(e,r,s){var i=this;this.userDAO=e,this.userService=r,this.auth=s,this.user=T.empty(),this.userSubscription=new q1,Q(n.VERBOSE,"ConnectedUserService constructor"),this.userRS=new Ate(1),this.userObs=this.userRS.asObservable(),this.authSubscription=new q1(abe(this.auth,function(){var o=I(function*(c){null==c?(Q(n.VERBOSE,"User is not connected"),i.userSubscription.unsubscribe(),i.userRS.next(M5.NOT_CONNECTED),i.user=T.empty()):(Pe(i.user.isAbsent(),"ConnectedUserService received a double update for an user, this is unexpected"),i.userSubscription=i.userDAO.subscribeToChanges(c.uid,u=>{if(u.isPresent()){const d=u.get(),g=d.username;Q(n.VERBOSE,`User ${g} is connected, and the verified status is ${i.emailVerified(c)}`);const m=!0===i.emailVerified(c)&&null!=g;if(!0===m&&!1===d.verified)return i.userService.markAsVerified(c.uid);const y=new M5(c.uid,T.ofNullable(c.email),T.ofNullable(g),m);!1===i.user.equalsValue(y)&&(i.user=T.of(y),i.userRS.next(y))}}))});return function(c){return o.apply(this,arguments)}}()))}emailVerified(e){return e.emailVerified}sendPasswordResetEmail(e){var r=this;return I(function*(){try{return yield J0.sendPasswordResetEmail(r.auth,e),R.SUCCESS}catch(s){return R.failure(r.mapFirebaseError(s))}})()}doRegister(e,r,s){var i=this;return I(function*(){return Q(n.VERBOSE,"ConnectedUserService.doRegister("+r+")"),(yield i.userService.usernameIsAvailable(e))?i.registerAfterUsernameCheck(e,r,s):_e.failure($localize`This username is already in use.`)})()}registerAfterUsernameCheck(e,r,s){var i=this;return I(function*(){try{const o=yield J0.createUserWithEmailAndPassword(i.auth,r,s);yield J0.signInWithEmailAndPassword(i.auth,r,s);const c=Me.getNonNullable(o.user);return yield i.createUser(c.uid,e),_e.success(c)}catch(o){return _e.failure(i.mapFirebaseError(o))}})()}mapFirebaseError(e){switch(e.code){case"auth/email-already-in-use":return $localize`This email address is already in use.`;case"auth/invalid-email":return $localize`This email address is invalid.`;case"auth/user-not-found":case"auth/wrong-password":return $localize`You have entered invalid credentials.`;case"auth/invalid-credential":return $localize`The credential is invalid or has expired, please try again.`;case"auth/weak-password":return $localize`Your password is too weak, please use a stronger password.`;case"auth/too-many-requests":return $localize`There has been too many requests from your device. You are temporarily blocked due to unusual activity. Try again later.`;case"auth/popup-closed-by-user":return $localize`You closed the authentication popup without finalizing your log in.`;case"auth/popup-blocked":return $localize`The authentication popup was blocked. Try again after disabling popup blocking.`;default:return As.logError("ConnectedUserService","Unsupported firebase error",{errorCode:e.code,errorMessage:e.message}),e.message}}sendEmailVerification(){var e=this;return I(function*(){Q(n.VERBOSE,"ConnectedUserService.sendEmailVerification()");const r=T.ofNullable(e.auth.currentUser);if(!r.isPresent())return As.logError("ConnectedUserService","Unlogged users cannot request for email verification");if(e.emailVerified(r.get()))return As.logError("ConnectedUserService","Verified users should not ask email verification after being verified");try{return yield J0.sendEmailVerification(r.get()),R.SUCCESS}catch(s){return R.failure(e.mapFirebaseError(s))}})()}doEmailLogin(e,r){var s=this;return I(function*(){Q(n.VERBOSE,"ConnectedUserService.doEmailLogin("+e+")");try{return yield J0.signInWithEmailAndPassword(s.auth,e,r),R.SUCCESS}catch(i){return R.failure(s.mapFirebaseError(i))}})()}createUser(e,r){var s=this;return I(function*(){null==r?yield s.userDAO.set(e,{verified:!1}):yield s.userDAO.set(e,{username:r,verified:!1})})()}doGoogleLogin(){var e=this;return I(function*(){return R.ofFallible(yield e.registerOrLoginWithGoogle())})()}registerOrLoginWithGoogle(){var e=this;return I(function*(){try{const r=new JPe;r.addScope("profile"),r.addScope("email");const s=yield J0.signInWithPopup(e.auth,r);return!1===(yield e.userDAO.exists(s.uid))&&(yield e.createUser(s.uid)),_e.success(s)}catch(r){return _e.failure(e.mapFirebaseError(r))}})()}disconnect(){var e=this;return I(function*(){return T.ofNullable(e.auth.currentUser).isPresent()?(yield e.auth.signOut(),R.SUCCESS):R.failure("Cannot disconnect a non-connected user")})()}subscribeToUser(e){return this.userObs.subscribe(e)}setUsername(e){var r=this;return I(function*(){if(""===e)return R.failure($localize`Your username may not be empty.`);try{if(!1===(yield r.userService.usernameIsAvailable(e)))return R.failure($localize`This username is already in use, please select a different one.`);const i=Me.getNonNullable(r.auth.currentUser);return yield J0.updateProfile(i,{displayName:e}),yield r.userService.setUsername(i.uid,e),yield r.userService.markAsVerified(i.uid),yield r.reloadUser(),R.SUCCESS}catch(s){return R.failure(r.mapFirebaseError(s))}})()}setPicture(e){var r=this;return I(function*(){try{const s=Me.getNonNullable(r.auth.currentUser);return yield J0.updateProfile(s,{photoURL:e}),R.SUCCESS}catch(s){return R.failure(r.mapFirebaseError(s))}})()}reloadUser(){var e=this;return I(function*(){const r=Me.getNonNullable(e.auth.currentUser);yield r.getIdToken(!0),yield r.reload()})()}sendPresenceToken(){return Pe(this.user.isPresent(),"Should not call sendPresenceToken when not connected"),this.userService.updatePresenceToken(this.user.get().id)}ngOnDestroy(){this.userSubscription.unsubscribe(),this.authSubscription.unsubscribe()}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Ve(IS),Ve(vm),Ve(OS))},n.\u0275prov=rt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class Dn{constructor(t){this.value=t}}Dn.HARD_DRAW=new Dn(0),Dn.RESIGN=new Dn(1),Dn.ESCAPE=new Dn(2),Dn.VICTORY=new Dn(3),Dn.TIMEOUT=new Dn(4),Dn.UNACHIEVED=new Dn(5),Dn.AGREED_DRAW_BY_ZERO=new Dn(6),Dn.AGREED_DRAW_BY_ONE=new Dn(7);class xS{constructor(t,e){this.id=t,this.data=e}getTurn(){return this.data.turn}isHardDraw(){return this.data.result===Dn.HARD_DRAW.value}isAgreedDraw(){return this.data.result===Dn.AGREED_DRAW_BY_ZERO.value||this.data.result===Dn.AGREED_DRAW_BY_ONE.value}getDrawAccepter(){return this.data.result===Dn.AGREED_DRAW_BY_ZERO.value?this.data.playerZero:(Pe(this.data.result===Dn.AGREED_DRAW_BY_ONE.value,"should not access getDrawAccepter when no draw accepted!"),Me.getNonNullable(this.data.playerOne))}isWin(){return this.data.result===Dn.VICTORY.value}isTimeout(){return this.data.result===Dn.TIMEOUT.value}isResign(){return this.data.result===Dn.RESIGN.value}getWinner(){return T.ofNullable(this.data.winner)}getLoser(){return T.ofNullable(this.data.loser)}setWinnerAndLoser(t,e){return new xS(this.id,{...this.data,winner:t,loser:e})}}class Zs{constructor(t){this.value=t}static of(t){switch(t){case"CREATOR":return Zs.CREATOR;case"RANDOM":return Zs.RANDOM;default:return Pe("CHOSEN_PLAYER"===t,"Invalid value for FirstPlayer: "+t+"."),Zs.CHOSEN_PLAYER}}}Zs.CREATOR=new Zs("CREATOR"),Zs.RANDOM=new Zs("RANDOM"),Zs.CHOSEN_PLAYER=new Zs("CHOSEN_PLAYER");class wr{constructor(t){this.value=t}static of(t){switch(t){case"STANDARD":return wr.STANDARD;case"BLITZ":return wr.BLITZ;case"CUSTOM":return wr.CUSTOM;default:throw new Error("Invalid part type: "+t+".")}}}wr.STANDARD=new wr("STANDARD"),wr.BLITZ=new wr("BLITZ"),wr.CUSTOM=new wr("CUSTOM"),wr.NORMAL_MOVE_DURATION=120,wr.NORMAL_PART_DURATION=1800,wr.BLITZ_MOVE_DURATION=30,wr.BLITZ_PART_DURATION=900;class Ys{constructor(t){this.value=t}}Ys.PART_CREATED=new Ys(0),Ys.CONFIG_PROPOSED=new Ys(2),Ys.PART_STARTED=new Ys(3),Ys.PART_FINISHED=new Ys(4);class Qz{constructor(){this.value=2}isPlayer(){return!1}toString(){return"PLAYER_NONE"}equals(t){return this===t}}Qz.NONE=new Qz;class B{constructor(t){this.value=t}static of(t){return 0===t?B.ZERO:(Me.expectToBe(t,1),B.ONE)}static fromTurn(t){return t%2==0?B.ZERO:B.ONE}isPlayer(){return!0}toString(){return this===B.ZERO?"PLAYER_ZERO":(Me.expectToBe(this,B.ONE,"Player should not be something else than Player.ZERO and Player.ONE"),"PLAYER_ONE")}equals(t){return this===t}getScoreModifier(){return 0===this.value?-1:1}getPreVictory(){return this.getVictoryValue()-this.getScoreModifier()}getDefeatValue(){return this===B.ZERO?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER}getVictoryValue(){return this===B.ZERO?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER}getOpponent(){return this===B.ZERO?B.ONE:(Me.expectToBe(this,B.ONE),B.ZERO)}}var he;B.encoder=new class extends Nt{encodeMove(n){return n.value}decodeMove(n){return Me.assert(0===n||1===n,"Invalid encoded player: "+n),B.of(n)}},B.ZERO=new B(0),B.ONE=new B(1),B.PLAYERS=[B.ZERO,B.ONE],function(n){n.ZERO=B.ZERO,n.ONE=B.ONE,n.NONE=Qz.NONE,n.encoder=new class extends Nt{encodeMove(t){return t.value}decodeMove(t){return 2===t?n.NONE:(Me.assert(0===t||1===t,"Invalid encoded player: "+t),B.of(t))}}}(he||(he={}));class Fr{static rematchAccepted(t,e){return Nte("RematchAccepted",{typeGame:t,partId:e})}static getPlayer(t){return B.of(Me.getNonNullable(t.data).player)}static getTypeGame(t){return Me.getNonNullable(t.data).typeGame}static getPartId(t){return Me.getNonNullable(t.data).partId}}function Nte(n,t){return{code:n,data:t}}function e8(n){return t=>Nte(n,{player:t.value})}Fr.drawProposed=e8("DrawProposed"),Fr.drawRefused=e8("DrawRefused"),Fr.takeBackAsked=e8("TakeBackAsked"),Fr.takeBackRefused=e8("TakeBackRefused"),Fr.takeBackAccepted=e8("TakeBackAccepted"),Fr.rematchProposed=e8("RematchProposed"),Fr.addTurnTime=e8("AddTurnTime"),Fr.addGlobalTime=e8("AddGlobalTime");class Ite{static toComparableObjectSet(t){const e=[];return t.forEach(r=>{e.some(s=>s.equals(r))||e.push(r)}),e}static toComparableSet(t){const e=[];return t.forEach(r=>{e.some(s=>Wa(s,r))||e.push(r)}),e}}class zt{constructor(t){this.values=void 0===t?[]:Ite.toComparableSet(t)}equals(t){if(t.size()!==this.size())return!1;for(const e of this)if(!1===t.contains(e))return!1;return!0}toString(){let t="";for(const e of this)t+=null==e?"null, ":e.toString()+", ";return"["+t.slice(0,-2)+"]"}add(t){return!this.contains(t)&&(this.values.push(t),!0)}remove(t){for(let e=0;e<this.values.length;e++)if(Wa(this.values[e],t))return this.values.splice(e,1),!0;return!1}addAll(t){for(const e of t)this.add(e)}union(t){const e=new zt(this.toList());return e.addAll(t),e}contains(t){for(const e of this.values)if(Wa(e,t))return!0;return!1}size(){return this.values.length}toList(){const t=[];for(const e of this)t.push(e);return t}getAnyElement(){return this.size()>0?T.of(this.values[0]):T.empty()}isEmpty(){return 0===this.values.length}hasElements(){return!1===this.isEmpty()}map(t){const e=[];for(const r of this.values)e.push(t(r));return new zt(e)}flatMap(t){const e=new zt;for(const r of this)e.addAll(t(r));return e}filter(t){const e=new zt;for(const r of this)t(r)&&e.add(r);return e}findAnyCommonElement(t){for(const e of t)if(this.contains(e))return T.of(e);return T.empty()}intersection(t){const e=new zt;for(const r of t)this.contains(r)&&e.add(r);return e}[Symbol.iterator](){return this.values.values()}}class Un{constructor(t=[],e=!1){this.map=t,this.isImmutable=e}static from(t){const e=Object.keys(t),r=new Un;for(const s of e)r.set(s,t[s]);return r}makeImmutable(){this.isImmutable=!0}get(t){for(const e of this.map)if(Wa(e.key,t))return T.of(e.value);return T.empty()}getAnyPair(){return this.size()>0?T.of(this.map[0]):T.empty()}forEach(t){for(const e of this.map)t(e)}putAll(t){this.checkImmutability("putAll");for(const e of t.map)this.put(e.key,e.value)}checkImmutability(t){if(this.isImmutable)throw new Error("Cannot call "+t+" on immutable map!")}put(t,e){this.checkImmutability("put");for(const r of this.map)if(Wa(r.key,t)){const s=r.value;return r.value=e,T.of(s)}return this.map.push({key:t,value:e}),T.empty()}containsKey(t){return this.map.some(e=>Wa(e.key,t))}size(){return this.map.length}listKeys(){return this.map.map(t=>t.key)}getKeySet(){return new zt(this.listKeys())}filter(t){const e=new Un;for(const r of this.map)t(r.key,r.value)&&e.set(r.key,r.value);return e}replace(t,e){if(this.checkImmutability("replace"),this.get(t).isAbsent())throw new Error("No Value to replace for key "+t.toString()+"!");return this.put(t,e),e}set(t,e){if(this.checkImmutability("set"),this.containsKey(t))throw new Error("Key "+t.toString()+" already exist in Map!");this.map.push({key:t,value:e})}delete(t){this.checkImmutability("delete");for(let e=0;e<this.map.length;e++)if(Wa(this.map[e].key,t)){const s=this.map[e].value,i=this.map.slice(0,e),o=this.map.slice(e+1);return this.map=i.concat(o),s}throw new Error('No Value to delete for key "'+t.toString()+'"!')}getCopy(){const t=new this.constructor;for(const e of this.listKeys())t.set(e,this.get(e).get());return t}equals(t){const e=this.getKeySet(),r=t.getKeySet();if(!1===e.equals(r))return!1;for(const s of e){const i=this.get(s).get(),o=t.get(s);if(Pe(o.isPresent(),"value is absent in a map even though its key is present!"),!1===Wa(i,o.get()))return!1}return!0}}class ym extends Un{reverse(){const t=new ym;for(const e of this.listKeys()){const r=this.get(e).get();if(t.containsKey(r))t.get(r).get().add(e);else{const s=new zt;s.add(e),t.set(r,s)}}return t}}class Xe{static mapBiArray(t,e){const r=[];let s=0;for(;s<t.length;){r[s]=[];let i=0;for(;i<t[s].length;)r[s][i]=e(t[s][i]),i++;s++}return r}static create3DTable(t,e,r,s){const i=[];for(let o=0;o<t;o++)i.push(Xe.createTable(e,r,s));return i}static createTable(t,e,r){const s=[];for(let i=0;i<e;i++)s.push(Xe.createArray(t,r));return s}static createArray(t,e){const r=[];for(let s=0;s<t;s++)r.push(e);return r}static copyBiArray(t){const e=[];let r=0;for(;r<t.length;)e[r]=Xe.copyImmutableArray(t[r]),r++;return e}static copyImmutableArray(t){const e=[];let r=0;for(;r<t.length;)e[r]=t[r],r++;return e}static sortByDescending(t,e){t.sort((r,s)=>{const i=e(r),o=e(s);return i<o?1:i>o?-1:0})}static compareArray(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(!1===Wa(t[r],e[r]))return!1;return!0}static compareTable(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(!1===Xe.compareArray(t[r],e[r]))return!1;return!0}static isPrefix(t,e){return!(t.length>e.length)&&Xe.compareArray(t,e.slice(0,t.length))}static range(t){const e=[];for(let r=0;r<t;r++)e.push(r);return e}static smallerFirst(t,e){return t-e}}class xte{constructor(){this.content=new Un}get(t){const e=this.content.get(t.y);return e.isAbsent()?T.empty():e.get().get(t.x)}set(t,e){const r=this.content.get(t.y);let s;r.isPresent()?s=r.get():(s=new Un,this.content.set(t.y,s)),s.set(t.x,e)}[Symbol.iterator](){const t=[],e=this.content.getKeySet().toList();e.sort(Xe.smallerFirst);for(const r of e){const s=this.content.get(r).get(),i=s.getKeySet().toList();i.sort(Xe.smallerFirst);for(const o of i){const c=s.get(o).get();t.push({x:o,y:r,content:c})}}return t.values()}}let kte=(()=>{class n extends _m{constructor(e){super("parts",e),Q(n.VERBOSE,"PartDAO.constructor")}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Ve(Q0))},n.\u0275prov=rt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class kS{constructor(t,e,r){this.onDocumentCreated=t,this.onDocumentModified=e,this.onDocumentDeleted=r}}let Dbe=(()=>{class n extends _m{constructor(e){super("config-room",e),Q(n.VERBOSE,"ConfigRoomDAO.constructor")}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Ve(Q0))},n.\u0275prov=rt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Jz=(()=>{class n{constructor(e,r){this.configRoomDAO=e,this.connectedUserService=r,Q(n.VERBOSE,"ConfigRoomService.constructor")}addCandidate(e,r){return this.configRoomDAO.subCollectionDAO(e,"candidates").set(r.id,r)}removeCandidate(e,r){return this.configRoomDAO.subCollectionDAO(e,"candidates").delete(r.id)}subscribeToChanges(e,r){return this.configRoomDAO.subscribeToChanges(e,r)}subscribeToCandidates(e,r){let s=[];const i=new kS(c=>{for(const u of c)s.push(u.data);r(s)},c=>{for(const u of c)s=s.map(d=>d.id===u.data.id?u.data:d);r(s)},c=>{for(const u of c)s=s.filter(d=>d.id!==u.data.id);r(s)});return this.configRoomDAO.subCollectionDAO(e,"candidates").observingWhere([],i)}createInitialConfigRoom(e){var r=this;return I(function*(){Q(n.VERBOSE,"ConfigRoomService.createInitialConfigRoom("+e+")");const s=r.connectedUserService.user.get().toMinimalUser();return r.configRoomDAO.set(e,{chosenOpponent:null,firstPlayer:Zs.RANDOM.value,partType:wr.STANDARD.value,partStatus:Ys.PART_CREATED.value,maximalMoveDuration:wr.NORMAL_MOVE_DURATION,totalPartDuration:wr.NORMAL_PART_DURATION,creator:s})})()}joinGame(e){var r=this;return I(function*(){Q(n.VERBOSE,"ConfigRoomService.joinGame("+e+")");const s=r.connectedUserService.user.get().toMinimalUser(),i=yield r.configRoomDAO.read(e);return i.isAbsent()?R.failure(n.GAME_DOES_NOT_EXIST()):(i.get().creator.id!==s.id&&(yield r.addCandidate(e,s)),R.SUCCESS)})()}cancelJoining(e){var r=this;return I(function*(){Q(n.VERBOSE,`ConfigRoomService.cancelJoining(${e})`);const s=r.connectedUserService.user.get().toMinimalUser(),i=yield r.configRoomDAO.read(e);if(!i.isAbsent()){const o=i.get(),c=[r.removeCandidate(e,s)];o.chosenOpponent?.id===s.id&&c.push(r.configRoomDAO.update(e,{chosenOpponent:null,partStatus:Ys.PART_CREATED.value})),yield Promise.all(c)}})()}deleteConfigRoom(e,r){var s=this;return I(function*(){Q(n.VERBOSE,`ConfigRoomService.deleteConfigRoom(${e}`),yield Promise.all(r.map(i=>s.removeCandidate(e,i))),yield s.configRoomDAO.delete(e)})()}proposeConfig(e,r,s,i,o,c){var u=this;return I(function*(){return Q(n.VERBOSE,{configRoomService_proposeConfig:{configRoomId:e,maximalMoveDuration:i,firstPlayer:o,totalPartDuration:c}}),u.configRoomDAO.update(e,{partStatus:Ys.CONFIG_PROPOSED.value,chosenOpponent:r,partType:s.value,maximalMoveDuration:i,totalPartDuration:c,firstPlayer:o.value})})()}setChosenOpponent(e,r){return Q(n.VERBOSE,`ConfigRoomService.setChosenOpponent(${e}, ${r.name})`),this.configRoomDAO.update(e,{chosenOpponent:r})}reviewConfig(e){var r=this;return I(function*(){return Q(n.VERBOSE,`ConfigRoomService.reviewConfig(${e})`),r.configRoomDAO.update(e,{partStatus:Ys.PART_CREATED.value})})()}reviewConfigAndRemoveChosenOpponent(e){var r=this;return I(function*(){return Q(n.VERBOSE,`ConfigRoomService.reviewConfigAndRemoveChosenOpponent(${e})`),r.configRoomDAO.update(e,{partStatus:Ys.PART_CREATED.value,chosenOpponent:null})})()}acceptConfig(e){return Q(n.VERBOSE,`ConfigRoomService.acceptConfig(${e}`),this.configRoomDAO.update(e,{partStatus:Ys.PART_STARTED.value})}createConfigRoom(e,r){var s=this;return I(function*(){return Q(n.VERBOSE,`ConfigRoomService.create(${e}`+JSON.stringify(r)+")"),s.configRoomDAO.set(e,r)})()}readConfigRoomById(e){var r=this;return I(function*(){return Q(n.VERBOSE,`ConfigRoomService.readConfigRoomById(${e})`),(yield r.configRoomDAO.read(e)).get()})()}}return n.VERBOSE=!1,n.GAME_DOES_NOT_EXIST=()=>$localize`Game does not exist`,n.\u0275fac=function(e){return new(e||n)(Ve(Dbe),Ve(Ns))},n.\u0275prov=rt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),LS=(()=>{class n{constructor(e,r,s,i){this.partDAO=e,this.connectedUserService=r,this.configRoomService=s,this.chatService=i,Q(n.VERBOSE,"GameService.constructor")}updateAndBumpIndex(e,r,s,i){var o=this;return I(function*(){return i={...i,lastUpdate:{index:s+1,player:r.value}},o.partDAO.update(e,i)})()}getPartValidity(e,r){var s=this;return I(function*(){const i=yield s.partDAO.read(e);return i.isAbsent()?R.failure("NONEXISTENT_PART"):i.get().typeGame===r?R.SUCCESS:R.failure("WRONG_GAME_TYPE")})()}createUnstartedPart(e){Q(n.VERBOSE,"GameService.createPart("+e+")");const r=this.connectedUserService.user.get().toMinimalUser();return this.partDAO.create({lastUpdate:{index:0,player:0},typeGame:e,playerZero:r,turn:-1,result:Dn.UNACHIEVED.value,listMoves:[]})}createChat(e){return Q(n.VERBOSE,"GameService.createChat("+e+")"),this.chatService.createNewChat(e)}createPartConfigRoomAndChat(e){var r=this;return I(function*(){Q(n.VERBOSE,`GameService.createGame(${e})`);const s=yield r.createUnstartedPart(e);return yield r.configRoomService.createInitialConfigRoom(s),yield r.createChat(s),s})()}startGameWithConfig(e,r,s,i){Q(n.VERBOSE,"GameService.startGameWithConfig("+e+", "+JSON.stringify(i));const o=this.getStartingConfig(i);return this.updateAndBumpIndex(e,r,s,o)}getStartingConfig(e){let s,i,r=Zs.of(e.firstPlayer);return r===Zs.RANDOM&&(r=Math.random()<.5?Zs.CREATOR:Zs.CHOSEN_PLAYER),r===Zs.CREATOR?(s=e.creator,i=Me.getNonNullable(e.chosenOpponent)):(s=Me.getNonNullable(e.chosenOpponent),i=e.creator),{playerZero:s,playerOne:i,turn:0,beginning:Y0(),remainingMsForZero:1e3*e.totalPartDuration,remainingMsForOne:1e3*e.totalPartDuration}}deletePart(e){return Q(n.VERBOSE,"GameService.deletePart("+e+")"),this.partDAO.delete(e)}acceptConfig(e,r){var s=this;return I(function*(){return Q(n.VERBOSE,{gameService_acceptConfig:{partId:e,configRoom:r}}),yield s.configRoomService.acceptConfig(e),s.startGameWithConfig(e,B.ONE,0,r)})()}subscribeToChanges(e,r){return this.partDAO.subscribeToChanges(e,r)}resign(e,r,s,i,o){return this.updateAndBumpIndex(e,s,r,{winner:i,loser:o,result:Dn.RESIGN.value,request:null})}notifyTimeout(e,r,s,i,o){return this.updateAndBumpIndex(e,r,s,{winner:i,loser:o,result:Dn.TIMEOUT.value,request:null})}sendRequest(e,r,s,i){return this.updateAndBumpIndex(e,r,s,{request:i})}proposeDraw(e,r,s){return this.sendRequest(e,s,r,Fr.drawProposed(s))}acceptDraw(e,r,s){return this.updateAndBumpIndex(e,s,r,{result:(s===B.ZERO?Dn.AGREED_DRAW_BY_ZERO:Dn.AGREED_DRAW_BY_ONE).value,request:null})}refuseDraw(e,r,s){return this.sendRequest(e,s,r,Fr.drawRefused(s))}proposeRematch(e,r,s){return this.sendRequest(e,s,r,Fr.rematchProposed(s))}acceptRematch(e,r,s){var i=this;return I(function*(){Q(n.VERBOSE,{called:"GameService.acceptRematch(",partDocument:e});const o=Me.getNonNullable(e.data),c=yield i.configRoomService.readConfigRoomById(e.id);let u;const d=i.connectedUserService.user.get().toMinimalUser();let g;o.playerZero.id===d.id?(g=Me.getNonNullable(o.playerOne),u=Zs.CHOSEN_PLAYER):(g=o.playerZero,u=Zs.CREATOR);const m={...c,firstPlayer:u.value,creator:d,chosenOpponent:g,partStatus:Ys.PART_STARTED.value},y=i.getStartingConfig(m),b={lastUpdate:{index:0,player:s.value},typeGame:o.typeGame,result:Dn.UNACHIEVED.value,listMoves:[],...y},k=yield i.partDAO.create(b);return yield i.configRoomService.createConfigRoom(k,m),yield i.createChat(k),i.sendRequest(e.id,s,r,Fr.rematchAccepted(o.typeGame,k))})()}askTakeBack(e,r,s){return this.sendRequest(e,s,r,Fr.takeBackAsked(s))}acceptTakeBack(e,r,s,i){var o=this;return I(function*(){Pe(Fr.getPlayer(Me.getNonNullable(r.data.request))!==s,"Illegal to accept your own request");const u=Fr.takeBackAccepted(s);let d=r.data.listMoves.slice(0,r.data.listMoves.length-1);d.length%2===s.value&&(d=d.slice(0,d.length-1));const g={request:u,listMoves:d,turn:d.length,lastUpdateTime:Y0(),remainingMsForZero:Me.getNonNullable(r.data.remainingMsForZero)-i[0],remainingMsForOne:Me.getNonNullable(r.data.remainingMsForOne)-i[1]},m=r.data.lastUpdate.index;return yield o.updateAndBumpIndex(e,s,m,g)})()}refuseTakeBack(e,r,s){const i=Fr.takeBackRefused(s);return this.updateAndBumpIndex(e,s,r,{request:i})}addGlobalTime(e,r,s,i){var o=this;return I(function*(){let c={request:Fr.addGlobalTime(i.getOpponent())};return c=i===B.ZERO?{...c,remainingMsForOne:Me.getNonNullable(s.remainingMsForOne)+3e5}:{...c,remainingMsForZero:Me.getNonNullable(s.remainingMsForZero)+3e5},yield o.updateAndBumpIndex(e,i,r,c)})()}addTurnTime(e,r,s){var i=this;return I(function*(){const o={request:Fr.addTurnTime(e.getOpponent())};return yield i.updateAndBumpIndex(s,e,r,o)})()}updateDBBoard(e,r,s,i,o,c,u,d){var g=this;return I(function*(){Q(n.VERBOSE,{gameService_updateDBBoard:{partId:e,encodedMove:s,scores:o,msToSubstract:i,notifyDraw:c,winner:u,loser:d}});const m=(yield g.partDAO.read(e)).get(),y=m.lastUpdate.index,b=m.turn+1,k=Xe.copyImmutableArray(m.listMoves);k[k.length]=s;let $={listMoves:k,turn:b,request:null,lastUpdateTime:Y0()};return $=g.updateScore($,o),$=g.substractMs($,m,i),null!=u?$={...$,winner:u,loser:d,result:Dn.VICTORY.value}:!0===c&&($={...$,result:Dn.HARD_DRAW.value}),yield g.updateAndBumpIndex(e,r,y,$)})()}updateScore(e,r){return void 0!==r?{...e,scorePlayerZero:r[0],scorePlayerOne:r[1]}:e}substractMs(e,r,s){return s[0]>0?{...e,remainingMsForZero:Me.getNonNullable(r.remainingMsForZero)-s[0]}:s[1]>0?{...e,remainingMsForOne:Me.getNonNullable(r.remainingMsForOne)-s[1]}:e}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Ve(kte),Ve(Ns),Ve(Jz),Ve(NS))},n.\u0275prov=rt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var rne={prefix:"fab",iconName:"facebook",icon:[512,512,[62e3],"f09a","M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"]},lne={prefix:"fab",iconName:"github",icon:[496,512,[],"f09b","M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"]},une={prefix:"fab",iconName:"twitter",icon:[512,512,[],"f099","M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"]};class Em{static getNavigatorLanguage(){return navigator.language}static getLocale(){const r=(localStorage.getItem("locale")??Em.getNavigatorLanguage()??"fr").slice(0,2).toLowerCase();return["en","fr"].some(s=>s===r)?r:"fr"}}let gne=(()=>{class n{changeTheme(e){localStorage.setItem("theme",e)}getTheme(){return T.ofNullable(localStorage.getItem("theme"))}changeLanguage(e){localStorage.setItem("locale",e.toLowerCase())}getLanguage(){return Em.getLocale()}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=rt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),RS=(()=>{class n{constructor(e,r){this.document=e,this.userSettingsService=r,this.availableThemes=["dark","light"];const s=this.getStoredTheme();s.isPresent()?this.loadTheme(s.get()):window.matchMedia("(prefers-color-scheme: dark)").matches?this.loadTheme("dark"):window.matchMedia("(prefers-color-scheme: light)").matches?this.loadTheme("light"):this.loadTheme("dark")}getStoredTheme(){const e=this.userSettingsService.getTheme();if(e.isPresent()){const r=e.get();if(this.availableThemes.some(s=>s===r))return T.of(r)}return T.empty()}loadTheme(e){this.loadStyle(e+".css"),this.theme=e}loadStyle(e){const r=this.document.getElementsByTagName("head")[0],s=this.document.getElementById("theme");if(null!=s)s.href=e;else{const i=this.document.createElement("link");i.id="theme",i.rel="stylesheet",i.href=`${e}`,r.appendChild(i)}}getTheme(){return this.theme}}return n.\u0275fac=function(e){return new(e||n)(Ve($s),Ve(gne))},n.\u0275prov=rt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function mne(n,t){var e=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);t&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable})),e.push.apply(e,r)}return e}function St(n){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?arguments[t]:{};t%2?mne(Object(e),!0).forEach(function(r){vi(n,r,e[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):mne(Object(e)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(e,r))})}return n}function DS(n){return(DS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(n)}function _ne(n,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,r.key,r)}}function vi(n,t,e){return t in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}function tV(n,t){return function vDe(n){if(Array.isArray(n))return n}(n)||function yDe(n,t){var e=null==n?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(null!=e){var o,c,r=[],s=!0,i=!1;try{for(e=e.call(n);!(s=(o=e.next()).done)&&(r.push(o.value),!t||r.length!==t);s=!0);}catch(u){i=!0,c=u}finally{try{!s&&null!=e.return&&e.return()}finally{if(i)throw c}}return r}}(n,t)||vne(n,t)||function MDe(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Sm(n){return function _De(n){if(Array.isArray(n))return nV(n)}(n)||function CDe(n){if(typeof Symbol<"u"&&null!=n[Symbol.iterator]||null!=n["@@iterator"])return Array.from(n)}(n)||vne(n)||function EDe(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function vne(n,t){if(n){if("string"==typeof n)return nV(n,t);var e=Object.prototype.toString.call(n).slice(8,-1);if("Object"===e&&n.constructor&&(e=n.constructor.name),"Map"===e||"Set"===e)return Array.from(n);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return nV(n,t)}}function nV(n,t){(null==t||t>n.length)&&(t=n.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=n[e];return r}var Cne=function(){},rV={},yne={},Ene=null,Mne={mark:Cne,measure:Cne};try{typeof window<"u"&&(rV=window),typeof document<"u"&&(yne=document),typeof MutationObserver<"u"&&(Ene=MutationObserver),typeof performance<"u"&&(Mne=performance)}catch{}var HS,FS,BS,$S,US,Sne=(rV.navigator||{}).userAgent,Pne=void 0===Sne?"":Sne,t8=rV,br=yne,Tne=Ene,VS=Mne,i6=!!br.documentElement&&!!br.head&&"function"==typeof br.addEventListener&&"function"==typeof br.createElement,wne=~Pne.indexOf("MSIE")||~Pne.indexOf("Trident/"),o6="___FONT_AWESOME___",One="svg-inline--fa",S5="data-fa-i2svg",iV="data-fa-pseudo-element",oV="data-prefix",aV="data-icon",Ane="fontawesome-i2svg",wDe=["HTML","HEAD","STYLE","SCRIPT"],Nne=function(){try{return!0}catch{return!1}}(),Or="classic",ms="sharp",cV=[Or,ms];function Pm(n){return new Proxy(n,{get:function(e,r){return r in e?e[r]:e[Or]}})}var Tm=Pm((vi(HS={},Or,{fa:"solid",fas:"solid","fa-solid":"solid",far:"regular","fa-regular":"regular",fal:"light","fa-light":"light",fat:"thin","fa-thin":"thin",fad:"duotone","fa-duotone":"duotone",fab:"brands","fa-brands":"brands",fak:"kit","fa-kit":"kit"}),vi(HS,ms,{fa:"solid",fass:"solid","fa-solid":"solid"}),HS)),wm=Pm((vi(FS={},Or,{solid:"fas",regular:"far",light:"fal",thin:"fat",duotone:"fad",brands:"fab",kit:"fak"}),vi(FS,ms,{solid:"fass"}),FS)),bm=Pm((vi(BS={},Or,{fab:"fa-brands",fad:"fa-duotone",fak:"fa-kit",fal:"fa-light",far:"fa-regular",fas:"fa-solid",fat:"fa-thin"}),vi(BS,ms,{fass:"fa-solid"}),BS)),bDe=Pm((vi($S={},Or,{"fa-brands":"fab","fa-duotone":"fad","fa-kit":"fak","fa-light":"fal","fa-regular":"far","fa-solid":"fas","fa-thin":"fat"}),vi($S,ms,{"fa-solid":"fass"}),$S)),ODe=/fa(s|r|l|t|d|b|k|ss)?[\-\ ]/,Ine="fa-layers-text",ADe=/Font ?Awesome ?([56 ]*)(Solid|Regular|Light|Thin|Duotone|Brands|Free|Pro|Sharp|Kit)?.*/i,NDe=Pm((vi(US={},Or,{900:"fas",400:"far",normal:"far",300:"fal",100:"fat"}),vi(US,ms,{900:"fass"}),US)),xne=[1,2,3,4,5,6,7,8,9,10],IDe=xne.concat([11,12,13,14,15,16,17,18,19,20]),xDe=["class","data-prefix","data-icon","data-fa-transform","data-fa-mask"],Om=new Set;Object.keys(wm[Or]).map(Om.add.bind(Om)),Object.keys(wm[ms]).map(Om.add.bind(Om));var kDe=[].concat(cV,Sm(Om),["2xs","xs","sm","lg","xl","2xl","beat","border","fade","beat-fade","bounce","flip-both","flip-horizontal","flip-vertical","flip","fw","inverse","layers-counter","layers-text","layers","li","pull-left","pull-right","pulse","rotate-180","rotate-270","rotate-90","rotate-by","shake","spin-pulse","spin-reverse","spin","stack-1x","stack-2x","stack","ul","duotone-group","swap-opacity","primary","secondary"]).concat(xne.map(function(n){return"".concat(n,"x")})).concat(IDe.map(function(n){return"w-".concat(n)})),Am=t8.FontAwesomeConfig||{};br&&"function"==typeof br.querySelector&&[["data-family-prefix","familyPrefix"],["data-css-prefix","cssPrefix"],["data-family-default","familyDefault"],["data-style-default","styleDefault"],["data-replacement-class","replacementClass"],["data-auto-replace-svg","autoReplaceSvg"],["data-auto-add-css","autoAddCss"],["data-auto-a11y","autoA11y"],["data-search-pseudo-elements","searchPseudoElements"],["data-observe-mutations","observeMutations"],["data-mutate-approach","mutateApproach"],["data-keep-original-source","keepOriginalSource"],["data-measure-performance","measurePerformance"],["data-show-missing-icons","showMissingIcons"]].forEach(function(n){var t=tV(n,2),r=t[1],s=function RDe(n){return""===n||"false"!==n&&("true"===n||n)}(function LDe(n){var t=br.querySelector("script["+n+"]");if(t)return t.getAttribute(n)}(t[0]));null!=s&&(Am[r]=s)});var kne={styleDefault:"solid",familyDefault:"classic",cssPrefix:"fa",replacementClass:One,autoReplaceSvg:!0,autoAddCss:!0,autoA11y:!0,searchPseudoElements:!1,observeMutations:!0,mutateApproach:"async",keepOriginalSource:!0,measurePerformance:!1,showMissingIcons:!0};Am.familyPrefix&&(Am.cssPrefix=Am.familyPrefix);var vd=St(St({},kne),Am);vd.autoReplaceSvg||(vd.observeMutations=!1);var It={};Object.keys(kne).forEach(function(n){Object.defineProperty(It,n,{enumerable:!0,set:function(e){vd[n]=e,Nm.forEach(function(r){return r(It)})},get:function(){return vd[n]}})}),Object.defineProperty(It,"familyPrefix",{enumerable:!0,set:function(t){vd.cssPrefix=t,Nm.forEach(function(e){return e(It)})},get:function(){return vd.cssPrefix}}),t8.FontAwesomeConfig=It;var Nm=[],D4={size:16,x:0,y:0,rotate:0,flipX:!1,flipY:!1};function Im(){for(var n=12,t="";n-- >0;)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[62*Math.random()|0];return t}function Cd(n){for(var t=[],e=(n||[]).length>>>0;e--;)t[e]=n[e];return t}function lV(n){return n.classList?Cd(n.classList):(n.getAttribute("class")||"").split(" ").filter(function(t){return t})}function Lne(n){return"".concat(n).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function GS(n){return Object.keys(n||{}).reduce(function(t,e){return t+"".concat(e,": ").concat(n[e].trim(),";")},"")}function uV(n){return n.size!==D4.size||n.x!==D4.x||n.y!==D4.y||n.rotate!==D4.rotate||n.flipX||n.flipY}function Rne(){var n="fa",t=One,e=It.cssPrefix,r=It.replacementClass,s=':root, :host {\n  --fa-font-solid: normal 900 1em/1 "Font Awesome 6 Solid";\n  --fa-font-regular: normal 400 1em/1 "Font Awesome 6 Regular";\n  --fa-font-light: normal 300 1em/1 "Font Awesome 6 Light";\n  --fa-font-thin: normal 100 1em/1 "Font Awesome 6 Thin";\n  --fa-font-duotone: normal 900 1em/1 "Font Awesome 6 Duotone";\n  --fa-font-sharp-solid: normal 900 1em/1 "Font Awesome 6 Sharp";\n  --fa-font-brands: normal 400 1em/1 "Font Awesome 6 Brands";\n}\n\nsvg:not(:root).svg-inline--fa, svg:not(:host).svg-inline--fa {\n  overflow: visible;\n  box-sizing: content-box;\n}\n\n.svg-inline--fa {\n  display: var(--fa-display, inline-block);\n  height: 1em;\n  overflow: visible;\n  vertical-align: -0.125em;\n}\n.svg-inline--fa.fa-2xs {\n  vertical-align: 0.1em;\n}\n.svg-inline--fa.fa-xs {\n  vertical-align: 0em;\n}\n.svg-inline--fa.fa-sm {\n  vertical-align: -0.0714285705em;\n}\n.svg-inline--fa.fa-lg {\n  vertical-align: -0.2em;\n}\n.svg-inline--fa.fa-xl {\n  vertical-align: -0.25em;\n}\n.svg-inline--fa.fa-2xl {\n  vertical-align: -0.3125em;\n}\n.svg-inline--fa.fa-pull-left {\n  margin-right: var(--fa-pull-margin, 0.3em);\n  width: auto;\n}\n.svg-inline--fa.fa-pull-right {\n  margin-left: var(--fa-pull-margin, 0.3em);\n  width: auto;\n}\n.svg-inline--fa.fa-li {\n  width: var(--fa-li-width, 2em);\n  top: 0.25em;\n}\n.svg-inline--fa.fa-fw {\n  width: var(--fa-fw-width, 1.25em);\n}\n\n.fa-layers svg.svg-inline--fa {\n  bottom: 0;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n}\n\n.fa-layers-counter, .fa-layers-text {\n  display: inline-block;\n  position: absolute;\n  text-align: center;\n}\n\n.fa-layers {\n  display: inline-block;\n  height: 1em;\n  position: relative;\n  text-align: center;\n  vertical-align: -0.125em;\n  width: 1em;\n}\n.fa-layers svg.svg-inline--fa {\n  -webkit-transform-origin: center center;\n          transform-origin: center center;\n}\n\n.fa-layers-text {\n  left: 50%;\n  top: 50%;\n  -webkit-transform: translate(-50%, -50%);\n          transform: translate(-50%, -50%);\n  -webkit-transform-origin: center center;\n          transform-origin: center center;\n}\n\n.fa-layers-counter {\n  background-color: var(--fa-counter-background-color, #ff253a);\n  border-radius: var(--fa-counter-border-radius, 1em);\n  box-sizing: border-box;\n  color: var(--fa-inverse, #fff);\n  line-height: var(--fa-counter-line-height, 1);\n  max-width: var(--fa-counter-max-width, 5em);\n  min-width: var(--fa-counter-min-width, 1.5em);\n  overflow: hidden;\n  padding: var(--fa-counter-padding, 0.25em 0.5em);\n  right: var(--fa-right, 0);\n  text-overflow: ellipsis;\n  top: var(--fa-top, 0);\n  -webkit-transform: scale(var(--fa-counter-scale, 0.25));\n          transform: scale(var(--fa-counter-scale, 0.25));\n  -webkit-transform-origin: top right;\n          transform-origin: top right;\n}\n\n.fa-layers-bottom-right {\n  bottom: var(--fa-bottom, 0);\n  right: var(--fa-right, 0);\n  top: auto;\n  -webkit-transform: scale(var(--fa-layers-scale, 0.25));\n          transform: scale(var(--fa-layers-scale, 0.25));\n  -webkit-transform-origin: bottom right;\n          transform-origin: bottom right;\n}\n\n.fa-layers-bottom-left {\n  bottom: var(--fa-bottom, 0);\n  left: var(--fa-left, 0);\n  right: auto;\n  top: auto;\n  -webkit-transform: scale(var(--fa-layers-scale, 0.25));\n          transform: scale(var(--fa-layers-scale, 0.25));\n  -webkit-transform-origin: bottom left;\n          transform-origin: bottom left;\n}\n\n.fa-layers-top-right {\n  top: var(--fa-top, 0);\n  right: var(--fa-right, 0);\n  -webkit-transform: scale(var(--fa-layers-scale, 0.25));\n          transform: scale(var(--fa-layers-scale, 0.25));\n  -webkit-transform-origin: top right;\n          transform-origin: top right;\n}\n\n.fa-layers-top-left {\n  left: var(--fa-left, 0);\n  right: auto;\n  top: var(--fa-top, 0);\n  -webkit-transform: scale(var(--fa-layers-scale, 0.25));\n          transform: scale(var(--fa-layers-scale, 0.25));\n  -webkit-transform-origin: top left;\n          transform-origin: top left;\n}\n\n.fa-1x {\n  font-size: 1em;\n}\n\n.fa-2x {\n  font-size: 2em;\n}\n\n.fa-3x {\n  font-size: 3em;\n}\n\n.fa-4x {\n  font-size: 4em;\n}\n\n.fa-5x {\n  font-size: 5em;\n}\n\n.fa-6x {\n  font-size: 6em;\n}\n\n.fa-7x {\n  font-size: 7em;\n}\n\n.fa-8x {\n  font-size: 8em;\n}\n\n.fa-9x {\n  font-size: 9em;\n}\n\n.fa-10x {\n  font-size: 10em;\n}\n\n.fa-2xs {\n  font-size: 0.625em;\n  line-height: 0.1em;\n  vertical-align: 0.225em;\n}\n\n.fa-xs {\n  font-size: 0.75em;\n  line-height: 0.0833333337em;\n  vertical-align: 0.125em;\n}\n\n.fa-sm {\n  font-size: 0.875em;\n  line-height: 0.0714285718em;\n  vertical-align: 0.0535714295em;\n}\n\n.fa-lg {\n  font-size: 1.25em;\n  line-height: 0.05em;\n  vertical-align: -0.075em;\n}\n\n.fa-xl {\n  font-size: 1.5em;\n  line-height: 0.0416666682em;\n  vertical-align: -0.125em;\n}\n\n.fa-2xl {\n  font-size: 2em;\n  line-height: 0.03125em;\n  vertical-align: -0.1875em;\n}\n\n.fa-fw {\n  text-align: center;\n  width: 1.25em;\n}\n\n.fa-ul {\n  list-style-type: none;\n  margin-left: var(--fa-li-margin, 2.5em);\n  padding-left: 0;\n}\n.fa-ul > li {\n  position: relative;\n}\n\n.fa-li {\n  left: calc(var(--fa-li-width, 2em) * -1);\n  position: absolute;\n  text-align: center;\n  width: var(--fa-li-width, 2em);\n  line-height: inherit;\n}\n\n.fa-border {\n  border-color: var(--fa-border-color, #eee);\n  border-radius: var(--fa-border-radius, 0.1em);\n  border-style: var(--fa-border-style, solid);\n  border-width: var(--fa-border-width, 0.08em);\n  padding: var(--fa-border-padding, 0.2em 0.25em 0.15em);\n}\n\n.fa-pull-left {\n  float: left;\n  margin-right: var(--fa-pull-margin, 0.3em);\n}\n\n.fa-pull-right {\n  float: right;\n  margin-left: var(--fa-pull-margin, 0.3em);\n}\n\n.fa-beat {\n  -webkit-animation-name: fa-beat;\n          animation-name: fa-beat;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, ease-in-out);\n          animation-timing-function: var(--fa-animation-timing, ease-in-out);\n}\n\n.fa-bounce {\n  -webkit-animation-name: fa-bounce;\n          animation-name: fa-bounce;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.28, 0.84, 0.42, 1));\n          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.28, 0.84, 0.42, 1));\n}\n\n.fa-fade {\n  -webkit-animation-name: fa-fade;\n          animation-name: fa-fade;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));\n          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));\n}\n\n.fa-beat-fade {\n  -webkit-animation-name: fa-beat-fade;\n          animation-name: fa-beat-fade;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));\n          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));\n}\n\n.fa-flip {\n  -webkit-animation-name: fa-flip;\n          animation-name: fa-flip;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, ease-in-out);\n          animation-timing-function: var(--fa-animation-timing, ease-in-out);\n}\n\n.fa-shake {\n  -webkit-animation-name: fa-shake;\n          animation-name: fa-shake;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, linear);\n          animation-timing-function: var(--fa-animation-timing, linear);\n}\n\n.fa-spin {\n  -webkit-animation-name: fa-spin;\n          animation-name: fa-spin;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 2s);\n          animation-duration: var(--fa-animation-duration, 2s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, linear);\n          animation-timing-function: var(--fa-animation-timing, linear);\n}\n\n.fa-spin-reverse {\n  --fa-animation-direction: reverse;\n}\n\n.fa-pulse,\n.fa-spin-pulse {\n  -webkit-animation-name: fa-spin;\n          animation-name: fa-spin;\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, steps(8));\n          animation-timing-function: var(--fa-animation-timing, steps(8));\n}\n\n@media (prefers-reduced-motion: reduce) {\n  .fa-beat,\n.fa-bounce,\n.fa-fade,\n.fa-beat-fade,\n.fa-flip,\n.fa-pulse,\n.fa-shake,\n.fa-spin,\n.fa-spin-pulse {\n    -webkit-animation-delay: -1ms;\n            animation-delay: -1ms;\n    -webkit-animation-duration: 1ms;\n            animation-duration: 1ms;\n    -webkit-animation-iteration-count: 1;\n            animation-iteration-count: 1;\n    transition-delay: 0s;\n    transition-duration: 0s;\n  }\n}\n@-webkit-keyframes fa-beat {\n  0%, 90% {\n    -webkit-transform: scale(1);\n            transform: scale(1);\n  }\n  45% {\n    -webkit-transform: scale(var(--fa-beat-scale, 1.25));\n            transform: scale(var(--fa-beat-scale, 1.25));\n  }\n}\n@keyframes fa-beat {\n  0%, 90% {\n    -webkit-transform: scale(1);\n            transform: scale(1);\n  }\n  45% {\n    -webkit-transform: scale(var(--fa-beat-scale, 1.25));\n            transform: scale(var(--fa-beat-scale, 1.25));\n  }\n}\n@-webkit-keyframes fa-bounce {\n  0% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n  10% {\n    -webkit-transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);\n            transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);\n  }\n  30% {\n    -webkit-transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));\n            transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));\n  }\n  50% {\n    -webkit-transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);\n            transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);\n  }\n  57% {\n    -webkit-transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));\n            transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));\n  }\n  64% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n  100% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n}\n@keyframes fa-bounce {\n  0% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n  10% {\n    -webkit-transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);\n            transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);\n  }\n  30% {\n    -webkit-transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));\n            transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));\n  }\n  50% {\n    -webkit-transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);\n            transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);\n  }\n  57% {\n    -webkit-transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));\n            transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));\n  }\n  64% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n  100% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n}\n@-webkit-keyframes fa-fade {\n  50% {\n    opacity: var(--fa-fade-opacity, 0.4);\n  }\n}\n@keyframes fa-fade {\n  50% {\n    opacity: var(--fa-fade-opacity, 0.4);\n  }\n}\n@-webkit-keyframes fa-beat-fade {\n  0%, 100% {\n    opacity: var(--fa-beat-fade-opacity, 0.4);\n    -webkit-transform: scale(1);\n            transform: scale(1);\n  }\n  50% {\n    opacity: 1;\n    -webkit-transform: scale(var(--fa-beat-fade-scale, 1.125));\n            transform: scale(var(--fa-beat-fade-scale, 1.125));\n  }\n}\n@keyframes fa-beat-fade {\n  0%, 100% {\n    opacity: var(--fa-beat-fade-opacity, 0.4);\n    -webkit-transform: scale(1);\n            transform: scale(1);\n  }\n  50% {\n    opacity: 1;\n    -webkit-transform: scale(var(--fa-beat-fade-scale, 1.125));\n            transform: scale(var(--fa-beat-fade-scale, 1.125));\n  }\n}\n@-webkit-keyframes fa-flip {\n  50% {\n    -webkit-transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));\n            transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));\n  }\n}\n@keyframes fa-flip {\n  50% {\n    -webkit-transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));\n            transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));\n  }\n}\n@-webkit-keyframes fa-shake {\n  0% {\n    -webkit-transform: rotate(-15deg);\n            transform: rotate(-15deg);\n  }\n  4% {\n    -webkit-transform: rotate(15deg);\n            transform: rotate(15deg);\n  }\n  8%, 24% {\n    -webkit-transform: rotate(-18deg);\n            transform: rotate(-18deg);\n  }\n  12%, 28% {\n    -webkit-transform: rotate(18deg);\n            transform: rotate(18deg);\n  }\n  16% {\n    -webkit-transform: rotate(-22deg);\n            transform: rotate(-22deg);\n  }\n  20% {\n    -webkit-transform: rotate(22deg);\n            transform: rotate(22deg);\n  }\n  32% {\n    -webkit-transform: rotate(-12deg);\n            transform: rotate(-12deg);\n  }\n  36% {\n    -webkit-transform: rotate(12deg);\n            transform: rotate(12deg);\n  }\n  40%, 100% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n}\n@keyframes fa-shake {\n  0% {\n    -webkit-transform: rotate(-15deg);\n            transform: rotate(-15deg);\n  }\n  4% {\n    -webkit-transform: rotate(15deg);\n            transform: rotate(15deg);\n  }\n  8%, 24% {\n    -webkit-transform: rotate(-18deg);\n            transform: rotate(-18deg);\n  }\n  12%, 28% {\n    -webkit-transform: rotate(18deg);\n            transform: rotate(18deg);\n  }\n  16% {\n    -webkit-transform: rotate(-22deg);\n            transform: rotate(-22deg);\n  }\n  20% {\n    -webkit-transform: rotate(22deg);\n            transform: rotate(22deg);\n  }\n  32% {\n    -webkit-transform: rotate(-12deg);\n            transform: rotate(-12deg);\n  }\n  36% {\n    -webkit-transform: rotate(12deg);\n            transform: rotate(12deg);\n  }\n  40%, 100% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n}\n@-webkit-keyframes fa-spin {\n  0% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n            transform: rotate(360deg);\n  }\n}\n@keyframes fa-spin {\n  0% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n            transform: rotate(360deg);\n  }\n}\n.fa-rotate-90 {\n  -webkit-transform: rotate(90deg);\n          transform: rotate(90deg);\n}\n\n.fa-rotate-180 {\n  -webkit-transform: rotate(180deg);\n          transform: rotate(180deg);\n}\n\n.fa-rotate-270 {\n  -webkit-transform: rotate(270deg);\n          transform: rotate(270deg);\n}\n\n.fa-flip-horizontal {\n  -webkit-transform: scale(-1, 1);\n          transform: scale(-1, 1);\n}\n\n.fa-flip-vertical {\n  -webkit-transform: scale(1, -1);\n          transform: scale(1, -1);\n}\n\n.fa-flip-both,\n.fa-flip-horizontal.fa-flip-vertical {\n  -webkit-transform: scale(-1, -1);\n          transform: scale(-1, -1);\n}\n\n.fa-rotate-by {\n  -webkit-transform: rotate(var(--fa-rotate-angle, none));\n          transform: rotate(var(--fa-rotate-angle, none));\n}\n\n.fa-stack {\n  display: inline-block;\n  vertical-align: middle;\n  height: 2em;\n  position: relative;\n  width: 2.5em;\n}\n\n.fa-stack-1x,\n.fa-stack-2x {\n  bottom: 0;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n  z-index: var(--fa-stack-z-index, auto);\n}\n\n.svg-inline--fa.fa-stack-1x {\n  height: 1em;\n  width: 1.25em;\n}\n.svg-inline--fa.fa-stack-2x {\n  height: 2em;\n  width: 2.5em;\n}\n\n.fa-inverse {\n  color: var(--fa-inverse, #fff);\n}\n\n.sr-only,\n.fa-sr-only {\n  position: absolute;\n  width: 1px;\n  height: 1px;\n  padding: 0;\n  margin: -1px;\n  overflow: hidden;\n  clip: rect(0, 0, 0, 0);\n  white-space: nowrap;\n  border-width: 0;\n}\n\n.sr-only-focusable:not(:focus),\n.fa-sr-only-focusable:not(:focus) {\n  position: absolute;\n  width: 1px;\n  height: 1px;\n  padding: 0;\n  margin: -1px;\n  overflow: hidden;\n  clip: rect(0, 0, 0, 0);\n  white-space: nowrap;\n  border-width: 0;\n}\n\n.svg-inline--fa .fa-primary {\n  fill: var(--fa-primary-color, currentColor);\n  opacity: var(--fa-primary-opacity, 1);\n}\n\n.svg-inline--fa .fa-secondary {\n  fill: var(--fa-secondary-color, currentColor);\n  opacity: var(--fa-secondary-opacity, 0.4);\n}\n\n.svg-inline--fa.fa-swap-opacity .fa-primary {\n  opacity: var(--fa-secondary-opacity, 0.4);\n}\n\n.svg-inline--fa.fa-swap-opacity .fa-secondary {\n  opacity: var(--fa-primary-opacity, 1);\n}\n\n.svg-inline--fa mask .fa-primary,\n.svg-inline--fa mask .fa-secondary {\n  fill: black;\n}\n\n.fad.fa-inverse,\n.fa-duotone.fa-inverse {\n  color: var(--fa-inverse, #fff);\n}';if(e!==n||r!==t){var i=new RegExp("\\.".concat(n,"\\-"),"g"),o=new RegExp("\\--".concat(n,"\\-"),"g"),c=new RegExp("\\.".concat(t),"g");s=s.replace(i,".".concat(e,"-")).replace(o,"--".concat(e,"-")).replace(c,".".concat(r))}return s}var Dne=!1;function fV(){It.autoAddCss&&!Dne&&(function VDe(n){if(n&&i6){var t=br.createElement("style");t.setAttribute("type","text/css"),t.innerHTML=n;for(var e=br.head.childNodes,r=null,s=e.length-1;s>-1;s--){var i=e[s],o=(i.tagName||"").toUpperCase();["STYLE","LINK"].indexOf(o)>-1&&(r=i)}br.head.insertBefore(t,r)}}(Rne()),Dne=!0)}var GDe={mixout:function(){return{dom:{css:Rne,insertCss:fV}}},hooks:function(){return{beforeDOMElementCreation:function(){fV()},beforeI2svg:function(){fV()}}}},a6=t8||{};a6[o6]||(a6[o6]={}),a6[o6].styles||(a6[o6].styles={}),a6[o6].hooks||(a6[o6].hooks={}),a6[o6].shims||(a6[o6].shims=[]);var x3=a6[o6],zne=[],WS=!1;function qDe(n){!i6||(WS?setTimeout(n,0):zne.push(n))}function xm(n){var t=n.tag,e=n.attributes,r=void 0===e?{}:e,s=n.children,i=void 0===s?[]:s;return"string"==typeof n?Lne(n):"<".concat(t," ").concat(function FDe(n){return Object.keys(n||{}).reduce(function(t,e){return t+"".concat(e,'="').concat(Lne(n[e]),'" ')},"").trim()}(r),">").concat(i.map(xm).join(""),"</").concat(t,">")}function Vne(n,t,e){if(n&&n[t]&&n[t][e])return{prefix:t,iconName:e,icon:n[t][e]}}i6&&((WS=(br.documentElement.doScroll?/^loaded|^c/:/^loaded|^i|^c/).test(br.readyState))||br.addEventListener("DOMContentLoaded",function n(){br.removeEventListener("DOMContentLoaded",n),WS=1,zne.map(function(t){return t()})}));var dV=function(t,e,r,s){var u,d,g,i=Object.keys(t),o=i.length,c=void 0!==s?function(t,e){return function(r,s,i,o){return t.call(e,r,s,i,o)}}(e,s):e;for(void 0===r?(u=1,g=t[i[0]]):(u=0,g=r);u<o;u++)g=c(g,t[d=i[u]],d,t);return g};function hV(n){var t=function ZDe(n){for(var t=[],e=0,r=n.length;e<r;){var s=n.charCodeAt(e++);if(s>=55296&&s<=56319&&e<r){var i=n.charCodeAt(e++);56320==(64512&i)?t.push(((1023&s)<<10)+(1023&i)+65536):(t.push(s),e--)}else t.push(s)}return t}(n);return 1===t.length?t[0].toString(16):null}function Hne(n){return Object.keys(n).reduce(function(t,e){var r=n[e];return r.icon?t[r.iconName]=r.icon:t[e]=r,t},{})}function pV(n,t){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=e.skipHooks,s=void 0!==r&&r,i=Hne(t);"function"!=typeof x3.hooks.addPack||s?x3.styles[n]=St(St({},x3.styles[n]||{}),i):x3.hooks.addPack(n,Hne(t)),"fas"===n&&pV("fa",t)}var qS,jS,ZS,yd=x3.styles,KDe=x3.shims,XDe=(vi(qS={},Or,Object.values(bm[Or])),vi(qS,ms,Object.values(bm[ms])),qS),gV=null,Fne={},Bne={},$ne={},Une={},Gne={},QDe=(vi(jS={},Or,Object.keys(Tm[Or])),vi(jS,ms,Object.keys(Tm[ms])),jS);function eze(n,t){var e=t.split("-"),r=e[0],s=e.slice(1).join("-");return r!==n||""===s||function JDe(n){return~kDe.indexOf(n)}(s)?null:s}var Wne=function(){var t=function(i){return dV(yd,function(o,c,u){return o[u]=dV(c,i,{}),o},{})};Fne=t(function(s,i,o){return i[3]&&(s[i[3]]=o),i[2]&&i[2].filter(function(u){return"number"==typeof u}).forEach(function(u){s[u.toString(16)]=o}),s}),Bne=t(function(s,i,o){return s[o]=o,i[2]&&i[2].filter(function(u){return"string"==typeof u}).forEach(function(u){s[u]=o}),s}),Gne=t(function(s,i,o){var c=i[2];return s[o]=o,c.forEach(function(u){s[u]=o}),s});var e="far"in yd||It.autoFetchSvg,r=dV(KDe,function(s,i){var o=i[0],c=i[1],u=i[2];return"far"===c&&!e&&(c="fas"),"string"==typeof o&&(s.names[o]={prefix:c,iconName:u}),"number"==typeof o&&(s.unicodes[o.toString(16)]={prefix:c,iconName:u}),s},{names:{},unicodes:{}});$ne=r.names,Une=r.unicodes,gV=YS(It.styleDefault,{family:It.familyDefault})};function mV(n,t){return(Fne[n]||{})[t]}function T5(n,t){return(Gne[n]||{})[t]}function qne(n){return $ne[n]||{prefix:null,iconName:null}}function r8(){return gV}function YS(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},e=t.family,r=void 0===e?Or:e,s=Tm[r][n],i=wm[r][n]||wm[r][s],o=n in x3.styles?n:null;return i||o||null}(function zDe(n){Nm.push(n)})(function(n){gV=YS(n.styleDefault,{family:It.familyDefault})}),Wne();var jne=(vi(ZS={},Or,Object.keys(bm[Or])),vi(ZS,ms,Object.keys(bm[ms])),ZS);function KS(n){var t,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.skipLookups,s=void 0!==r&&r,i=(vi(t={},Or,"".concat(It.cssPrefix,"-").concat(Or)),vi(t,ms,"".concat(It.cssPrefix,"-").concat(ms)),t),o=null,c=Or;(n.includes(i[Or])||n.some(function(d){return jne[Or].includes(d)}))&&(c=Or),(n.includes(i[ms])||n.some(function(d){return jne[ms].includes(d)}))&&(c=ms);var u=n.reduce(function(d,g){var m=eze(It.cssPrefix,g);if(yd[g]?(g=XDe[c].includes(g)?bDe[c][g]:g,o=g,d.prefix=g):QDe[c].indexOf(g)>-1?(o=g,d.prefix=YS(g,{family:c})):m?d.iconName=m:g!==It.replacementClass&&g!==i[Or]&&g!==i[ms]&&d.rest.push(g),!s&&d.prefix&&d.iconName){var y="fa"===o?qne(d.iconName):{},b=T5(d.prefix,d.iconName);y.prefix&&(o=null),d.iconName=y.iconName||b||d.iconName,d.prefix=y.prefix||d.prefix,"far"===d.prefix&&!yd.far&&yd.fas&&!It.autoFetchSvg&&(d.prefix="fas")}return d},{prefix:null,iconName:null,rest:[]});return(n.includes("fa-brands")||n.includes("fab"))&&(u.prefix="fab"),(n.includes("fa-duotone")||n.includes("fad"))&&(u.prefix="fad"),!u.prefix&&c===ms&&(yd.fass||It.autoFetchSvg)&&(u.prefix="fass",u.iconName=T5(u.prefix,u.iconName)||u.iconName),("fa"===u.prefix||"fa"===o)&&(u.prefix=r8()||"fas"),u}var rze=function(){function n(){(function pDe(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")})(this,n),this.definitions={}}return function gDe(n,t,e){t&&_ne(n.prototype,t),e&&_ne(n,e),Object.defineProperty(n,"prototype",{writable:!1})}(n,[{key:"add",value:function(){for(var e=this,r=arguments.length,s=new Array(r),i=0;i<r;i++)s[i]=arguments[i];var o=s.reduce(this._pullDefinitions,{});Object.keys(o).forEach(function(c){e.definitions[c]=St(St({},e.definitions[c]||{}),o[c]),pV(c,o[c]);var u=bm[Or][c];u&&pV(u,o[c]),Wne()})}},{key:"reset",value:function(){this.definitions={}}},{key:"_pullDefinitions",value:function(e,r){var s=r.prefix&&r.iconName&&r.icon?{0:r}:r;return Object.keys(s).map(function(i){var o=s[i],c=o.prefix,u=o.iconName,d=o.icon,g=d[2];e[c]||(e[c]={}),g.length>0&&g.forEach(function(m){"string"==typeof m&&(e[c][m]=d)}),e[c][u]=d}),e}}]),n}(),Zne=[],Ed={},Md={},sze=Object.keys(Md);function vV(n,t){for(var e=arguments.length,r=new Array(e>2?e-2:0),s=2;s<e;s++)r[s-2]=arguments[s];var i=Ed[n]||[];return i.forEach(function(o){t=o.apply(null,[t].concat(r))}),t}function w5(n){for(var t=arguments.length,e=new Array(t>1?t-1:0),r=1;r<t;r++)e[r-1]=arguments[r];var s=Ed[n]||[];s.forEach(function(i){i.apply(null,e)})}function c6(){var n=arguments[0],t=Array.prototype.slice.call(arguments,1);return Md[n]?Md[n].apply(null,t):void 0}function CV(n){"fa"===n.prefix&&(n.prefix="fas");var t=n.iconName,e=n.prefix||r8();if(t)return t=T5(e,t)||t,Vne(Yne.definitions,e,t)||Vne(x3.styles,e,t)}var Yne=new rze,aze={i2svg:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i6?(w5("beforeI2svg",t),c6("pseudoElements2svg",t),c6("i2svg",t)):Promise.reject("Operation requires a DOM of some kind.")},watch:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.autoReplaceSvgRoot;!1===It.autoReplaceSvg&&(It.autoReplaceSvg=!0),It.observeMutations=!0,qDe(function(){lze({autoReplaceSvgRoot:e}),w5("watch",t)})}},Za={noAuto:function(){It.autoReplaceSvg=!1,It.observeMutations=!1,w5("noAuto")},config:It,dom:aze,parse:{icon:function(t){if(null===t)return null;if("object"===DS(t)&&t.prefix&&t.iconName)return{prefix:t.prefix,iconName:T5(t.prefix,t.iconName)||t.iconName};if(Array.isArray(t)&&2===t.length){var e=0===t[1].indexOf("fa-")?t[1].slice(3):t[1],r=YS(t[0]);return{prefix:r,iconName:T5(r,e)||e}}if("string"==typeof t&&(t.indexOf("".concat(It.cssPrefix,"-"))>-1||t.match(ODe))){var s=KS(t.split(" "),{skipLookups:!0});return{prefix:s.prefix||r8(),iconName:T5(s.prefix,s.iconName)||s.iconName}}if("string"==typeof t){var i=r8();return{prefix:i,iconName:T5(i,t)||t}}}},library:Yne,findIconDefinition:CV,toHtml:xm},lze=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.autoReplaceSvgRoot,r=void 0===e?br:e;(Object.keys(x3.styles).length>0||It.autoFetchSvg)&&i6&&It.autoReplaceSvg&&Za.dom.i2svg({node:r})};function XS(n,t){return Object.defineProperty(n,"abstract",{get:t}),Object.defineProperty(n,"html",{get:function(){return n.abstract.map(function(r){return xm(r)})}}),Object.defineProperty(n,"node",{get:function(){if(i6){var r=br.createElement("div");return r.innerHTML=n.html,r.children}}}),n}function yV(n){var t=n.icons,e=t.main,r=t.mask,s=n.prefix,i=n.iconName,o=n.transform,c=n.symbol,u=n.title,d=n.maskId,g=n.titleId,m=n.extra,y=n.watchable,b=void 0!==y&&y,k=r.found?r:e,$=k.width,K=k.height,oe="fak"===s,ye=[It.replacementClass,i?"".concat(It.cssPrefix,"-").concat(i):""].filter(function(O1){return-1===m.classes.indexOf(O1)}).filter(function(O1){return""!==O1||!!O1}).concat(m.classes).join(" "),te={children:[],attributes:St(St({},m.attributes),{},{"data-prefix":s,"data-icon":i,class:ye,role:m.attributes.role||"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 ".concat($," ").concat(K)})},Le=oe&&!~m.classes.indexOf("fa-fw")?{width:"".concat($/K*16*.0625,"em")}:{};b&&(te.attributes[S5]=""),u&&(te.children.push({tag:"title",attributes:{id:te.attributes["aria-labelledby"]||"title-".concat(g||Im())},children:[u]}),delete te.attributes.title);var Ge=St(St({},te),{},{prefix:s,iconName:i,main:e,mask:r,maskId:d,transform:o,symbol:c,styles:St(St({},Le),m.styles)}),Qe=r.found&&e.found?c6("generateAbstractMask",Ge)||{children:[],attributes:{}}:c6("generateAbstractIcon",Ge)||{children:[],attributes:{}},z1=Qe.attributes;return Ge.children=Qe.children,Ge.attributes=z1,c?function fze(n){var e=n.iconName,r=n.children,s=n.attributes,i=n.symbol,o=!0===i?"".concat(n.prefix,"-").concat(It.cssPrefix,"-").concat(e):i;return[{tag:"svg",attributes:{style:"display: none;"},children:[{tag:"symbol",attributes:St(St({},s),{},{id:o}),children:r}]}]}(Ge):function uze(n){var t=n.children,e=n.main,r=n.mask,s=n.attributes,i=n.styles,o=n.transform;if(uV(o)&&e.found&&!r.found){var d={x:e.width/e.height/2,y:.5};s.style=GS(St(St({},i),{},{"transform-origin":"".concat(d.x+o.x/16,"em ").concat(d.y+o.y/16,"em")}))}return[{tag:"svg",attributes:s,children:t}]}(Ge)}function Kne(n){var t=n.content,e=n.width,r=n.height,s=n.transform,i=n.title,o=n.extra,c=n.watchable,u=void 0!==c&&c,d=St(St(St({},o.attributes),i?{title:i}:{}),{},{class:o.classes.join(" ")});u&&(d[S5]="");var g=St({},o.styles);uV(s)&&(g.transform=function $De(n){var t=n.transform,e=n.width,s=n.height,i=void 0===s?16:s,o=n.startCentered,c=void 0!==o&&o,u="";return u+=c&&wne?"translate(".concat(t.x/16-(void 0===e?16:e)/2,"em, ").concat(t.y/16-i/2,"em) "):c?"translate(calc(-50% + ".concat(t.x/16,"em), calc(-50% + ").concat(t.y/16,"em)) "):"translate(".concat(t.x/16,"em, ").concat(t.y/16,"em) "),(u+="scale(".concat(t.size/16*(t.flipX?-1:1),", ").concat(t.size/16*(t.flipY?-1:1),") "))+"rotate(".concat(t.rotate,"deg) ")}({transform:s,startCentered:!0,width:e,height:r}),g["-webkit-transform"]=g.transform);var m=GS(g);m.length>0&&(d.style=m);var y=[];return y.push({tag:"span",attributes:d,children:[t]}),i&&y.push({tag:"span",attributes:{class:"sr-only"},children:[i]}),y}function dze(n){var t=n.content,e=n.title,r=n.extra,s=St(St(St({},r.attributes),e?{title:e}:{}),{},{class:r.classes.join(" ")}),i=GS(r.styles);i.length>0&&(s.style=i);var o=[];return o.push({tag:"span",attributes:s,children:[t]}),e&&o.push({tag:"span",attributes:{class:"sr-only"},children:[e]}),o}var EV=x3.styles;function MV(n){var t=n[0],e=n[1],i=tV(n.slice(4),1)[0];return{found:!0,width:t,height:e,icon:Array.isArray(i)?{tag:"g",attributes:{class:"".concat(It.cssPrefix,"-").concat("duotone-group")},children:[{tag:"path",attributes:{class:"".concat(It.cssPrefix,"-").concat("secondary"),fill:"currentColor",d:i[0]}},{tag:"path",attributes:{class:"".concat(It.cssPrefix,"-").concat("primary"),fill:"currentColor",d:i[1]}}]}:{tag:"path",attributes:{fill:"currentColor",d:i}}}}var hze={found:!1,width:512,height:512};function SV(n,t){var e=t;return"fa"===t&&null!==It.styleDefault&&(t=r8()),new Promise(function(r,s){if(c6("missingIconAbstract"),"fa"===e){var o=qne(n)||{};n=o.iconName||n,t=o.prefix||t}if(n&&t&&EV[t]&&EV[t][n])return r(MV(EV[t][n]));(function pze(n,t){!Nne&&!It.showMissingIcons&&n&&console.error('Icon with name "'.concat(n,'" and prefix "').concat(t,'" is missing.'))})(n,t),r(St(St({},hze),{},{icon:It.showMissingIcons&&n&&c6("missingIconAbstract")||{}}))})}var Xne=function(){},PV=It.measurePerformance&&VS&&VS.mark&&VS.measure?VS:{mark:Xne,measure:Xne},km='FA "6.2.1"',TV_begin=function(t){return PV.mark("".concat(km," ").concat(t," begins")),function(){return function(t){PV.mark("".concat(km," ").concat(t," ends")),PV.measure("".concat(km," ").concat(t),"".concat(km," ").concat(t," begins"),"".concat(km," ").concat(t," ends"))}(t)}},QS=function(){};function Jne(n){return"string"==typeof(n.getAttribute?n.getAttribute(S5):null)}function Cze(n){return br.createElementNS("http://www.w3.org/2000/svg",n)}function yze(n){return br.createElement(n)}function e1e(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},e=t.ceFn,r=void 0===e?"svg"===n.tag?Cze:yze:e;if("string"==typeof n)return br.createTextNode(n);var s=r(n.tag);Object.keys(n.attributes||[]).forEach(function(o){s.setAttribute(o,n.attributes[o])});var i=n.children||[];return i.forEach(function(o){s.appendChild(e1e(o,{ceFn:r}))}),s}var JS={replace:function(t){var e=t[0];if(e.parentNode)if(t[1].forEach(function(s){e.parentNode.insertBefore(e1e(s),e)}),null===e.getAttribute(S5)&&It.keepOriginalSource){var r=br.createComment(function Eze(n){var t=" ".concat(n.outerHTML," ");return"".concat(t,"Font Awesome fontawesome.com ")}(e));e.parentNode.replaceChild(r,e)}else e.remove()},nest:function(t){var e=t[0],r=t[1];if(~lV(e).indexOf(It.replacementClass))return JS.replace(t);var s=new RegExp("".concat(It.cssPrefix,"-.*"));if(delete r[0].attributes.id,r[0].attributes.class){var i=r[0].attributes.class.split(" ").reduce(function(c,u){return u===It.replacementClass||u.match(s)?c.toSvg.push(u):c.toNode.push(u),c},{toNode:[],toSvg:[]});r[0].attributes.class=i.toSvg.join(" "),0===i.toNode.length?e.removeAttribute("class"):e.setAttribute("class",i.toNode.join(" "))}var o=r.map(function(c){return xm(c)}).join("\n");e.setAttribute(S5,""),e.innerHTML=o}};function t1e(n){n()}function n1e(n,t){var e="function"==typeof t?t:QS;if(0===n.length)e();else{var r=t1e;"async"===It.mutateApproach&&(r=t8.requestAnimationFrame||t1e),r(function(){var s=function vze(){return!0===It.autoReplaceSvg?JS.replace:JS[It.autoReplaceSvg]||JS.replace}(),i=TV_begin("mutate");n.map(s),i(),e()})}}var wV=!1;function r1e(){wV=!0}function bV(){wV=!1}var eP=null;function s1e(n){if(Tne&&It.observeMutations){var t=n.treeCallback,e=void 0===t?QS:t,r=n.nodeCallback,s=void 0===r?QS:r,i=n.pseudoElementsCallback,o=void 0===i?QS:i,c=n.observeMutationsRoot,u=void 0===c?br:c;eP=new Tne(function(d){if(!wV){var g=r8();Cd(d).forEach(function(m){if("childList"===m.type&&m.addedNodes.length>0&&!Jne(m.addedNodes[0])&&(It.searchPseudoElements&&o(m.target),e(m.target)),"attributes"===m.type&&m.target.parentNode&&It.searchPseudoElements&&o(m.target.parentNode),"attributes"===m.type&&Jne(m.target)&&~xDe.indexOf(m.attributeName))if("class"===m.attributeName&&function mze(n){var t=n.getAttribute?n.getAttribute(oV):null,e=n.getAttribute?n.getAttribute(aV):null;return t&&e}(m.target)){var y=KS(lV(m.target)),k=y.iconName;m.target.setAttribute(oV,y.prefix||g),k&&m.target.setAttribute(aV,k)}else(function _ze(n){return n&&n.classList&&n.classList.contains&&n.classList.contains(It.replacementClass)})(m.target)&&s(m.target)})}}),i6&&eP.observe(u,{childList:!0,attributes:!0,characterData:!0,subtree:!0})}}function Sze(n){var t=n.getAttribute("style"),e=[];return t&&(e=t.split(";").reduce(function(r,s){var i=s.split(":"),o=i[0],c=i.slice(1);return o&&c.length>0&&(r[o]=c.join(":").trim()),r},{})),e}function Pze(n){var t=n.getAttribute("data-prefix"),e=n.getAttribute("data-icon"),r=void 0!==n.innerText?n.innerText.trim():"",s=KS(lV(n));return s.prefix||(s.prefix=r8()),t&&e&&(s.prefix=t,s.iconName=e),s.iconName&&s.prefix||(s.prefix&&r.length>0&&(s.iconName=function tze(n,t){return(Bne[n]||{})[t]}(s.prefix,n.innerText)||mV(s.prefix,hV(n.innerText))),!s.iconName&&It.autoFetchSvg&&n.firstChild&&n.firstChild.nodeType===Node.TEXT_NODE&&(s.iconName=n.firstChild.data)),s}function Tze(n){var t=Cd(n.attributes).reduce(function(s,i){return"class"!==s.name&&"style"!==s.name&&(s[i.name]=i.value),s},{}),e=n.getAttribute("title"),r=n.getAttribute("data-fa-title-id");return It.autoA11y&&(e?t["aria-labelledby"]="".concat(It.replacementClass,"-title-").concat(r||Im()):(t["aria-hidden"]="true",t.focusable="false")),t}function i1e(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{styleParser:!0},e=Pze(n),r=e.iconName,s=e.prefix,i=e.rest,o=Tze(n),c=vV("parseNodeAttributes",{},n),u=t.styleParser?Sze(n):[];return St({iconName:r,title:n.getAttribute("title"),titleId:n.getAttribute("data-fa-title-id"),prefix:s,transform:D4,mask:{iconName:null,prefix:null,rest:[]},maskId:null,symbol:!1,extra:{classes:i,styles:u,attributes:o}},c)}var bze=x3.styles;function o1e(n){var t="nest"===It.autoReplaceSvg?i1e(n,{styleParser:!1}):i1e(n);return~t.extra.classes.indexOf(Ine)?c6("generateLayersText",n,t):c6("generateSvgReplacementMutation",n,t)}var s8=new Set;function a1e(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!i6)return Promise.resolve();var e=br.documentElement.classList,r=function(m){return e.add("".concat(Ane,"-").concat(m))},s=function(m){return e.remove("".concat(Ane,"-").concat(m))},i=It.autoFetchSvg?s8:cV.map(function(g){return"fa-".concat(g)}).concat(Object.keys(bze));i.includes("fa")||i.push("fa");var o=[".".concat(Ine,":not([").concat(S5,"])")].concat(i.map(function(g){return".".concat(g,":not([").concat(S5,"])")})).join(", ");if(0===o.length)return Promise.resolve();var c=[];try{c=Cd(n.querySelectorAll(o))}catch{}if(!(c.length>0))return Promise.resolve();r("pending"),s("complete");var u=TV_begin("onTree"),d=c.reduce(function(g,m){try{var y=o1e(m);y&&g.push(y)}catch(b){Nne||"MissingIcon"===b.name&&console.error(b)}return g},[]);return new Promise(function(g,m){Promise.all(d).then(function(y){n1e(y,function(){r("active"),r("complete"),s("pending"),"function"==typeof t&&t(),u(),g()})}).catch(function(y){u(),m(y)})})}function Oze(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;o1e(n).then(function(e){e&&n1e([e],t)})}function Aze(n){return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=(t||{}).icon?t:CV(t||{}),s=e.mask;return s&&(s=(s||{}).icon?s:CV(s||{})),n(r,St(St({},e),{},{mask:s}))}}cV.map(function(n){s8.add("fa-".concat(n))}),Object.keys(Tm[Or]).map(s8.add.bind(s8)),Object.keys(Tm[ms]).map(s8.add.bind(s8)),s8=Sm(s8);var Nze=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.transform,s=void 0===r?D4:r,i=e.symbol,o=void 0!==i&&i,c=e.mask,u=void 0===c?null:c,d=e.maskId,g=void 0===d?null:d,m=e.title,y=void 0===m?null:m,b=e.titleId,k=void 0===b?null:b,$=e.classes,K=void 0===$?[]:$,oe=e.attributes,ye=void 0===oe?{}:oe,te=e.styles,Le=void 0===te?{}:te;if(t){var Ge=t.prefix,Qe=t.iconName,Ft=t.icon;return XS(St({type:"icon"},t),function(){return w5("beforeDOMElementCreation",{iconDefinition:t,params:e}),It.autoA11y&&(y?ye["aria-labelledby"]="".concat(It.replacementClass,"-title-").concat(k||Im()):(ye["aria-hidden"]="true",ye.focusable="false")),yV({icons:{main:MV(Ft),mask:u?MV(u.icon):{found:!1,width:null,height:null,icon:{}}},prefix:Ge,iconName:Qe,transform:St(St({},D4),s),symbol:o,title:y,maskId:g,titleId:k,extra:{attributes:ye,styles:Le,classes:K}})})}},Ize={mixout:function(){return{icon:Aze(Nze)}},hooks:function(){return{mutationObserverCallbacks:function(e){return e.treeCallback=a1e,e.nodeCallback=Oze,e}}},provides:function(t){t.i2svg=function(e){var r=e.node,i=e.callback;return a1e(void 0===r?br:r,void 0===i?function(){}:i)},t.generateSvgReplacementMutation=function(e,r){var s=r.iconName,i=r.title,o=r.titleId,c=r.prefix,u=r.transform,d=r.symbol,g=r.mask,m=r.maskId,y=r.extra;return new Promise(function(b,k){Promise.all([SV(s,c),g.iconName?SV(g.iconName,g.prefix):Promise.resolve({found:!1,width:512,height:512,icon:{}})]).then(function($){var K=tV($,2);b([e,yV({icons:{main:K[0],mask:K[1]},prefix:c,iconName:s,transform:u,symbol:d,maskId:m,title:i,titleId:o,extra:y,watchable:!0})])}).catch(k)})},t.generateAbstractIcon=function(e){var d,r=e.children,s=e.attributes,i=e.main,o=e.transform,u=GS(e.styles);return u.length>0&&(s.style=u),uV(o)&&(d=c6("generateAbstractTransformGrouping",{main:i,transform:o,containerWidth:i.width,iconWidth:i.width})),r.push(d||i.icon),{children:r,attributes:s}}}},xze={mixout:function(){return{layer:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=r.classes,i=void 0===s?[]:s;return XS({type:"layer"},function(){w5("beforeDOMElementCreation",{assembler:e,params:r});var o=[];return e(function(c){Array.isArray(c)?c.map(function(u){o=o.concat(u.abstract)}):o=o.concat(c.abstract)}),[{tag:"span",attributes:{class:["".concat(It.cssPrefix,"-layers")].concat(Sm(i)).join(" ")},children:o}]})}}}},kze={mixout:function(){return{counter:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=r.title,i=void 0===s?null:s,o=r.classes,c=void 0===o?[]:o,u=r.attributes,d=void 0===u?{}:u,g=r.styles,m=void 0===g?{}:g;return XS({type:"counter",content:e},function(){return w5("beforeDOMElementCreation",{content:e,params:r}),dze({content:e.toString(),title:i,extra:{attributes:d,styles:m,classes:["".concat(It.cssPrefix,"-layers-counter")].concat(Sm(c))}})})}}}},Lze={mixout:function(){return{text:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=r.transform,i=void 0===s?D4:s,o=r.title,c=void 0===o?null:o,u=r.classes,d=void 0===u?[]:u,g=r.attributes,m=void 0===g?{}:g,y=r.styles,b=void 0===y?{}:y;return XS({type:"text",content:e},function(){return w5("beforeDOMElementCreation",{content:e,params:r}),Kne({content:e,transform:St(St({},D4),i),title:c,extra:{attributes:m,styles:b,classes:["".concat(It.cssPrefix,"-layers-text")].concat(Sm(d))}})})}}},provides:function(t){t.generateLayersText=function(e,r){var s=r.title,i=r.transform,o=r.extra,c=null,u=null;if(wne){var d=parseInt(getComputedStyle(e).fontSize,10),g=e.getBoundingClientRect();c=g.width/d,u=g.height/d}return It.autoA11y&&!s&&(o.attributes["aria-hidden"]="true"),Promise.resolve([e,Kne({content:e.innerHTML,width:c,height:u,transform:i,title:s,extra:o,watchable:!0})])}}},Rze=new RegExp('"',"ug"),c1e=[1105920,1112319];function l1e(n,t){var e="".concat("data-fa-pseudo-element-pending").concat(t.replace(":","-"));return new Promise(function(r,s){if(null!==n.getAttribute(e))return r();var o=Cd(n.children).filter(function(Ft){return Ft.getAttribute(iV)===t})[0],c=t8.getComputedStyle(n,t),u=c.getPropertyValue("font-family").match(ADe),d=c.getPropertyValue("font-weight"),g=c.getPropertyValue("content");if(o&&!u)return n.removeChild(o),r();if(u&&"none"!==g&&""!==g){var m=c.getPropertyValue("content"),y=~["Sharp"].indexOf(u[2])?ms:Or,b=~["Solid","Regular","Light","Thin","Duotone","Brands","Kit"].indexOf(u[2])?wm[y][u[2].toLowerCase()]:NDe[y][d],k=function Dze(n){var t=n.replace(Rze,""),e=function YDe(n,t){var s,e=n.length,r=n.charCodeAt(t);return r>=55296&&r<=56319&&e>t+1&&(s=n.charCodeAt(t+1))>=56320&&s<=57343?1024*(r-55296)+s-56320+65536:r}(t,0),r=e>=c1e[0]&&e<=c1e[1],s=2===t.length&&t[0]===t[1];return{value:hV(s?t[0]:t),isSecondary:r||s}}(m),$=k.value,K=k.isSecondary,oe=u[0].startsWith("FontAwesome"),ye=mV(b,$),te=ye;if(oe){var Le=function nze(n){var t=Une[n],e=mV("fas",n);return t||(e?{prefix:"fas",iconName:e}:null)||{prefix:null,iconName:null}}($);Le.iconName&&Le.prefix&&(ye=Le.iconName,b=Le.prefix)}if(!ye||K||o&&o.getAttribute(oV)===b&&o.getAttribute(aV)===te)r();else{n.setAttribute(e,te),o&&n.removeChild(o);var Ge=function wze(){return{iconName:null,title:null,titleId:null,prefix:null,transform:D4,symbol:!1,mask:{iconName:null,prefix:null,rest:[]},maskId:null,extra:{classes:[],styles:{},attributes:{}}}}(),Qe=Ge.extra;Qe.attributes[iV]=t,SV(ye,b).then(function(Ft){var z1=yV(St(St({},Ge),{},{icons:{main:Ft,mask:{prefix:null,iconName:null,rest:[]}},prefix:b,iconName:te,extra:Qe,watchable:!0})),O1=br.createElement("svg");"::before"===t?n.insertBefore(O1,n.firstChild):n.appendChild(O1),O1.outerHTML=z1.map(function(os){return xm(os)}).join("\n"),n.removeAttribute(e),r()}).catch(s)}}else r()})}function zze(n){return Promise.all([l1e(n,"::before"),l1e(n,"::after")])}function Vze(n){return!(n.parentNode===document.head||~wDe.indexOf(n.tagName.toUpperCase())||n.getAttribute(iV)||n.parentNode&&"svg"===n.parentNode.tagName)}function u1e(n){if(i6)return new Promise(function(t,e){var r=Cd(n.querySelectorAll("*")).filter(Vze).map(zze),s=TV_begin("searchPseudoElements");r1e(),Promise.all(r).then(function(){s(),bV(),t()}).catch(function(){s(),bV(),e()})})}var f1e=!1,d1e=function(t){return t.toLowerCase().split(" ").reduce(function(r,s){var i=s.toLowerCase().split("-"),o=i[0],c=i.slice(1).join("-");if(o&&"h"===c)return r.flipX=!0,r;if(o&&"v"===c)return r.flipY=!0,r;if(c=parseFloat(c),isNaN(c))return r;switch(o){case"grow":r.size=r.size+c;break;case"shrink":r.size=r.size-c;break;case"left":r.x=r.x-c;break;case"right":r.x=r.x+c;break;case"up":r.y=r.y-c;break;case"down":r.y=r.y+c;break;case"rotate":r.rotate=r.rotate+c}return r},{size:16,x:0,y:0,flipX:!1,flipY:!1,rotate:0})},OV={x:0,y:0,width:"100%",height:"100%"};function h1e(n){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return n.attributes&&(n.attributes.fill||t)&&(n.attributes.fill="black"),n}function $ze(n){return"g"===n.tag?n.children:[n]}var Uze={hooks:function(){return{parseNodeAttributes:function(e,r){var s=r.getAttribute("data-fa-mask"),i=s?KS(s.split(" ").map(function(o){return o.trim()})):{prefix:null,iconName:null,rest:[]};return i.prefix||(i.prefix=r8()),e.mask=i,e.maskId=r.getAttribute("data-fa-mask-id"),e}}},provides:function(t){t.generateAbstractMask=function(e){var r=e.children,s=e.attributes,i=e.main,o=e.mask,c=e.maskId,g=i.icon,y=o.icon,b=function BDe(n){var t=n.transform,r=n.iconWidth,s={transform:"translate(".concat(n.containerWidth/2," 256)")},i="translate(".concat(32*t.x,", ").concat(32*t.y,") "),o="scale(".concat(t.size/16*(t.flipX?-1:1),", ").concat(t.size/16*(t.flipY?-1:1),") "),c="rotate(".concat(t.rotate," 0 0)");return{outer:s,inner:{transform:"".concat(i," ").concat(o," ").concat(c)},path:{transform:"translate(".concat(r/2*-1," -256)")}}}({transform:e.transform,containerWidth:o.width,iconWidth:i.width}),k={tag:"rect",attributes:St(St({},OV),{},{fill:"white"})},$=g.children?{children:g.children.map(h1e)}:{},K={tag:"g",attributes:St({},b.inner),children:[h1e(St({tag:g.tag,attributes:St(St({},g.attributes),b.path)},$))]},oe={tag:"g",attributes:St({},b.outer),children:[K]},ye="mask-".concat(c||Im()),te="clip-".concat(c||Im()),Le={tag:"mask",attributes:St(St({},OV),{},{id:ye,maskUnits:"userSpaceOnUse",maskContentUnits:"userSpaceOnUse"}),children:[k,oe]},Ge={tag:"defs",children:[{tag:"clipPath",attributes:{id:te},children:$ze(y)},Le]};return r.push(Ge,{tag:"rect",attributes:St({fill:"currentColor","clip-path":"url(#".concat(te,")"),mask:"url(#".concat(ye,")")},OV)}),{children:r,attributes:s}}}};!function ize(n,t){var e=t.mixoutsTo;Zne=n,Ed={},Object.keys(Md).forEach(function(r){-1===sze.indexOf(r)&&delete Md[r]}),Zne.forEach(function(r){var s=r.mixout?r.mixout():{};if(Object.keys(s).forEach(function(o){"function"==typeof s[o]&&(e[o]=s[o]),"object"===DS(s[o])&&Object.keys(s[o]).forEach(function(c){e[o]||(e[o]={}),e[o][c]=s[o][c]})}),r.hooks){var i=r.hooks();Object.keys(i).forEach(function(o){Ed[o]||(Ed[o]=[]),Ed[o].push(i[o])})}r.provides&&r.provides(Md)})}([GDe,Ize,xze,kze,Lze,{hooks:function(){return{mutationObserverCallbacks:function(e){return e.pseudoElementsCallback=u1e,e}}},provides:function(t){t.pseudoElements2svg=function(e){var r=e.node;It.searchPseudoElements&&u1e(void 0===r?br:r)}}},{mixout:function(){return{dom:{unwatch:function(){r1e(),f1e=!0}}}},hooks:function(){return{bootstrap:function(){s1e(vV("mutationObserverCallbacks",{}))},noAuto:function(){!function Mze(){!eP||eP.disconnect()}()},watch:function(e){var r=e.observeMutationsRoot;f1e?bV():s1e(vV("mutationObserverCallbacks",{observeMutationsRoot:r}))}}}},{mixout:function(){return{parse:{transform:function(e){return d1e(e)}}}},hooks:function(){return{parseNodeAttributes:function(e,r){var s=r.getAttribute("data-fa-transform");return s&&(e.transform=d1e(s)),e}}},provides:function(t){t.generateAbstractTransformGrouping=function(e){var r=e.main,s=e.transform,o=e.iconWidth,c={transform:"translate(".concat(e.containerWidth/2," 256)")},u="translate(".concat(32*s.x,", ").concat(32*s.y,") "),d="scale(".concat(s.size/16*(s.flipX?-1:1),", ").concat(s.size/16*(s.flipY?-1:1),") "),g="rotate(".concat(s.rotate," 0 0)"),b={outer:c,inner:{transform:"".concat(u," ").concat(d," ").concat(g)},path:{transform:"translate(".concat(o/2*-1," -256)")}};return{tag:"g",attributes:St({},b.outer),children:[{tag:"g",attributes:St({},b.inner),children:[{tag:r.icon.tag,children:r.icon.children,attributes:St(St({},r.icon.attributes),b.path)}]}]}}}},Uze,{provides:function(t){var e=!1;t8.matchMedia&&(e=t8.matchMedia("(prefers-reduced-motion: reduce)").matches),t.missingIconAbstract=function(){var r=[],s={fill:"currentColor"},i={attributeType:"XML",repeatCount:"indefinite",dur:"2s"};r.push({tag:"path",attributes:St(St({},s),{},{d:"M156.5,447.7l-12.6,29.5c-18.7-9.5-35.9-21.2-51.5-34.9l22.7-22.7C127.6,430.5,141.5,440,156.5,447.7z M40.6,272H8.5 c1.4,21.2,5.4,41.7,11.7,61.1L50,321.2C45.1,305.5,41.8,289,40.6,272z M40.6,240c1.4-18.8,5.2-37,11.1-54.1l-29.5-12.6 C14.7,194.3,10,216.7,8.5,240H40.6z M64.3,156.5c7.8-14.9,17.2-28.8,28.1-41.5L69.7,92.3c-13.7,15.6-25.5,32.8-34.9,51.5 L64.3,156.5z M397,419.6c-13.9,12-29.4,22.3-46.1,30.4l11.9,29.8c20.7-9.9,39.8-22.6,56.9-37.6L397,419.6z M115,92.4 c13.9-12,29.4-22.3,46.1-30.4l-11.9-29.8c-20.7,9.9-39.8,22.6-56.8,37.6L115,92.4z M447.7,355.5c-7.8,14.9-17.2,28.8-28.1,41.5 l22.7,22.7c13.7-15.6,25.5-32.9,34.9-51.5L447.7,355.5z M471.4,272c-1.4,18.8-5.2,37-11.1,54.1l29.5,12.6 c7.5-21.1,12.2-43.5,13.6-66.8H471.4z M321.2,462c-15.7,5-32.2,8.2-49.2,9.4v32.1c21.2-1.4,41.7-5.4,61.1-11.7L321.2,462z M240,471.4c-18.8-1.4-37-5.2-54.1-11.1l-12.6,29.5c21.1,7.5,43.5,12.2,66.8,13.6V471.4z M462,190.8c5,15.7,8.2,32.2,9.4,49.2h32.1 c-1.4-21.2-5.4-41.7-11.7-61.1L462,190.8z M92.4,397c-12-13.9-22.3-29.4-30.4-46.1l-29.8,11.9c9.9,20.7,22.6,39.8,37.6,56.9 L92.4,397z M272,40.6c18.8,1.4,36.9,5.2,54.1,11.1l12.6-29.5C317.7,14.7,295.3,10,272,8.5V40.6z M190.8,50 c15.7-5,32.2-8.2,49.2-9.4V8.5c-21.2,1.4-41.7,5.4-61.1,11.7L190.8,50z M442.3,92.3L419.6,115c12,13.9,22.3,29.4,30.5,46.1 l29.8-11.9C470,128.5,457.3,109.4,442.3,92.3z M397,92.4l22.7-22.7c-15.6-13.7-32.8-25.5-51.5-34.9l-12.6,29.5 C370.4,72.1,384.4,81.5,397,92.4z"})});var o=St(St({},i),{},{attributeName:"opacity"}),c={tag:"circle",attributes:St(St({},s),{},{cx:"256",cy:"364",r:"28"}),children:[]};return e||c.children.push({tag:"animate",attributes:St(St({},i),{},{attributeName:"r",values:"28;14;28;28;14;28;"})},{tag:"animate",attributes:St(St({},o),{},{values:"1;0;1;1;0;1;"})}),r.push(c),r.push({tag:"path",attributes:St(St({},s),{},{opacity:"1",d:"M263.7,312h-16c-6.6,0-12-5.4-12-12c0-71,77.4-63.9,77.4-107.8c0-20-17.8-40.2-57.4-40.2c-29.1,0-44.3,9.6-59.2,28.7 c-3.9,5-11.1,6-16.2,2.4l-13.1-9.2c-5.6-3.9-6.9-11.8-2.6-17.2c21.2-27.2,46.4-44.7,91.2-44.7c52.3,0,97.4,29.8,97.4,80.2 c0,67.6-77.4,63.5-77.4,107.8C275.7,306.6,270.3,312,263.7,312z"}),children:e?[]:[{tag:"animate",attributes:St(St({},o),{},{values:"1;0;0;0;0;1;"})}]}),e||r.push({tag:"path",attributes:St(St({},s),{},{opacity:"0",d:"M232.5,134.5l7,168c0.3,6.4,5.6,11.5,12,11.5h9c6.4,0,11.7-5.1,12-11.5l7-168c0.3-6.8-5.2-12.5-12-12.5h-23 C237.7,122,232.2,127.7,232.5,134.5z"}),children:[{tag:"animate",attributes:St(St({},o),{},{values:"0;0;1;1;0;0;"})}]}),{tag:"g",attributes:{class:"missing"},children:r}}}},{hooks:function(){return{parseNodeAttributes:function(e,r){var s=r.getAttribute("data-fa-symbol");return e.symbol=null!==s&&(""===s||s),e}}}}],{mixoutsTo:Za});var jze=Za.parse,Zze=Za.icon;const Yze=["*"],Qze=n=>{const t={"fa-spin":n.spin,"fa-pulse":n.pulse,"fa-fw":n.fixedWidth,"fa-border":n.border,"fa-inverse":n.inverse,"fa-layers-counter":n.counter,"fa-flip-horizontal":"horizontal"===n.flip||"both"===n.flip,"fa-flip-vertical":"vertical"===n.flip||"both"===n.flip,[`fa-${n.size}`]:null!==n.size,[`fa-rotate-${n.rotate}`]:null!==n.rotate,[`fa-pull-${n.pull}`]:null!==n.pull,[`fa-stack-${n.stackItemSize}`]:null!=n.stackItemSize};return Object.keys(t).map(e=>t[e]?e:null).filter(e=>e)};let tVe=(()=>{class n{constructor(){this.defaultPrefix="fas",this.fallbackIcon=null}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=rt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),nVe=(()=>{class n{constructor(){this.definitions={}}addIcons(...e){for(const r of e){r.prefix in this.definitions||(this.definitions[r.prefix]={}),this.definitions[r.prefix][r.iconName]=r;for(const s of r.icon[2])"string"==typeof s&&(this.definitions[r.prefix][s]=r)}}addIconPacks(...e){for(const r of e){const s=Object.keys(r).map(i=>r[i]);this.addIcons(...s)}}getIconDefinition(e,r){return e in this.definitions&&r in this.definitions[e]?this.definitions[e][r]:null}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=rt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),rVe=(()=>{class n{constructor(){this.stackItemSize="1x"}ngOnChanges(e){if("size"in e)throw new Error('fa-icon is not allowed to customize size when used inside fa-stack. Set size on the enclosing fa-stack instead: <fa-stack size="4x">...</fa-stack>.')}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=Gt({type:n,selectors:[["fa-icon","stackItemSize",""],["fa-duotone-icon","stackItemSize",""]],inputs:{stackItemSize:"stackItemSize",size:"size"},features:[n2]}),n})(),sVe=(()=>{class n{constructor(e,r){this.renderer=e,this.elementRef=r}ngOnInit(){this.renderer.addClass(this.elementRef.nativeElement,"fa-stack")}ngOnChanges(e){"size"in e&&(null!=e.size.currentValue&&this.renderer.addClass(this.elementRef.nativeElement,`fa-${e.size.currentValue}`),null!=e.size.previousValue&&this.renderer.removeClass(this.elementRef.nativeElement,`fa-${e.size.previousValue}`))}}return n.\u0275fac=function(e){return new(e||n)(J(yo),J(f2))},n.\u0275cmp=dt({type:n,selectors:[["fa-stack"]],inputs:{size:"size"},features:[n2],ngContentSelectors:Yze,decls:1,vars:0,template:function(e,r){1&e&&(function xB(n){const t=ze()[16][6];if(!t.projection){const r=t.projection=_l(n?n.length:1,null),s=r.slice();let i=t.child;for(;null!==i;){const o=n?I4e(i,n):0;null!==o&&(s[o]?s[o].projectionNext=i:r[o]=i,s[o]=i),i=i.next}}}(),function kB(n,t=0,e){const r=ze(),s=Jn(),i=m0(s,22+n,16,null,e||null);null===i.projection&&(i.projection=t),Eh(),64!=(64&i.flags)&&function ob(n,t,e){aC(t[11],0,t,e,Jv(n,e,t),rC(e.parent||t[6],e,t))}(s,r,i)}(0))},encapsulation:2}),n})(),Sd=(()=>{class n{constructor(e,r,s,i,o){this.sanitizer=e,this.config=r,this.iconLibrary=s,this.stackItem=i,this.classes=[],null!=o&&null==i&&console.error('FontAwesome: fa-icon and fa-duotone-icon elements must specify stackItemSize attribute when wrapped into fa-stack. Example: <fa-icon stackItemSize="2x"></fa-icon>.')}ngOnChanges(e){if(null==this.icon&&null==this.config.fallbackIcon)return(()=>{throw new Error("Property `icon` is required for `fa-icon`/`fa-duotone-icon` components.")})();let r=null;if(r=this.icon??this.config.fallbackIcon,e){const s=this.findIconDefinition(r);if(null!=s){const i=this.buildParams();this.renderIcon(s,i)}}}render(){this.ngOnChanges({})}findIconDefinition(e){const r=((n,t)=>(n=>void 0!==n.prefix&&void 0!==n.iconName)(n)?n:Array.isArray(n)&&2===n.length?{prefix:n[0],iconName:n[1]}:"string"==typeof n?{prefix:t,iconName:n}:void 0)(e,this.config.defaultPrefix);return"icon"in r?r:this.iconLibrary.getIconDefinition(r.prefix,r.iconName)??((n=>{throw new Error(`Could not find icon with iconName=${n.iconName} and prefix=${n.prefix} in the icon library.`)})(r),null)}buildParams(){const e={flip:this.flip,spin:this.spin,pulse:this.pulse,border:this.border,inverse:this.inverse,size:this.size||null,pull:this.pull||null,rotate:this.rotate||null,fixedWidth:"boolean"==typeof this.fixedWidth?this.fixedWidth:this.config.fixedWidth,stackItemSize:null!=this.stackItem?this.stackItem.stackItemSize:null},r="string"==typeof this.transform?jze.transform(this.transform):this.transform;return{title:this.title,transform:r,classes:[...Qze(e),...this.classes],mask:null!=this.mask?this.findIconDefinition(this.mask):null,styles:null!=this.styles?this.styles:{},symbol:this.symbol,attributes:{role:this.a11yRole}}}renderIcon(e,r){const s=Zze(e,r);this.renderedIconHTML=this.sanitizer.bypassSecurityTrustHtml(s.html.join("\n"))}}return n.\u0275fac=function(e){return new(e||n)(J(JG),J(tVe),J(nVe),J(rVe,8),J(sVe,8))},n.\u0275cmp=dt({type:n,selectors:[["fa-icon"]],hostAttrs:[1,"ng-fa-icon"],hostVars:2,hostBindings:function(e,r){2&e&&(oO("innerHTML",r.renderedIconHTML,nu),z("title",r.title))},inputs:{icon:"icon",title:"title",spin:"spin",pulse:"pulse",mask:"mask",styles:"styles",flip:"flip",size:"size",pull:"pull",border:"border",inverse:"inverse",symbol:"symbol",rotate:"rotate",fixedWidth:"fixedWidth",classes:"classes",transform:"transform",a11yRole:"a11yRole"},features:[n2],decls:0,vars:0,template:function(e,r){},encapsulation:2}),n})(),iVe=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=oi({type:n}),n.\u0275inj=Yr({}),n})();var xV={prefix:"fas",iconName:"reply",icon:[512,512,[61714,"mail-reply"],"f3e5","M205 34.8c11.5 5.1 19 16.6 19 29.2v64H336c97.2 0 176 78.8 176 176c0 113.3-81.5 163.9-100.2 174.1c-2.5 1.4-5.3 1.9-8.1 1.9c-10.9 0-19.7-8.9-19.7-19.7c0-7.5 4.3-14.4 9.8-19.5c9.4-8.8 22.2-26.4 22.2-56.7c0-53-43-96-96-96H224v64c0 12.6-7.4 24.1-19 29.2s-25 3-34.4-5.4l-160-144C3.9 225.7 0 217.1 0 208s3.9-17.7 10.6-23.8l160-144c9.4-8.5 22.9-10.6 34.4-5.4z"]},jV={prefix:"fas",iconName:"eye",icon:[576,512,[128065],"f06e","M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144s64.5-144 144-144s144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64c-11.5 0-22.3-3-31.6-8.4c-.2 2.8-.4 5.5-.4 8.4c0 53 43 96 96 96s96-43 96-96s-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6z"]},toe={prefix:"fas",iconName:"gear",icon:[512,512,[9881,"cog"],"f013","M495.9 166.6c3.2 8.7 .5 18.4-6.4 24.6l-43.3 39.4c1.1 8.3 1.7 16.8 1.7 25.4s-.6 17.1-1.7 25.4l43.3 39.4c6.9 6.2 9.6 15.9 6.4 24.6c-4.4 11.9-9.7 23.3-15.8 34.3l-4.7 8.1c-6.6 11-14 21.4-22.1 31.2c-5.9 7.2-15.7 9.6-24.5 6.8l-55.7-17.7c-13.4 10.3-28.2 18.9-44 25.4l-12.5 57.1c-2 9.1-9 16.3-18.2 17.8c-13.8 2.3-28 3.5-42.5 3.5s-28.7-1.2-42.5-3.5c-9.2-1.5-16.2-8.7-18.2-17.8l-12.5-57.1c-15.8-6.5-30.6-15.1-44-25.4L83.1 425.9c-8.8 2.8-18.6 .3-24.5-6.8c-8.1-9.8-15.5-20.2-22.1-31.2l-4.7-8.1c-6.1-11-11.4-22.4-15.8-34.3c-3.2-8.7-.5-18.4 6.4-24.6l43.3-39.4C64.6 273.1 64 264.6 64 256s.6-17.1 1.7-25.4L22.4 191.2c-6.9-6.2-9.6-15.9-6.4-24.6c4.4-11.9 9.7-23.3 15.8-34.3l4.7-8.1c6.6-11 14-21.4 22.1-31.2c5.9-7.2 15.7-9.6 24.5-6.8l55.7 17.7c13.4-10.3 28.2-18.9 44-25.4l12.5-57.1c2-9.1 9-16.3 18.2-17.8C227.3 1.2 241.5 0 256 0s28.7 1.2 42.5 3.5c9.2 1.5 16.2 8.7 18.2 17.8l12.5 57.1c15.8 6.5 30.6 15.1 44 25.4l55.7-17.7c8.8-2.8 18.6-.3 24.5 6.8c8.1 9.8 15.5 20.2 22.1 31.2l4.7 8.1c6.1 11 11.4 22.4 15.8 34.3zM256 336c44.2 0 80-35.8 80-80s-35.8-80-80-80s-80 35.8-80 80s35.8 80 80 80z"]},doe={prefix:"fas",iconName:"network-wired",icon:[640,512,[],"f6ff","M256 64H384v64H256V64zM240 0c-26.5 0-48 21.5-48 48v96c0 26.5 21.5 48 48 48h48v32H32c-17.7 0-32 14.3-32 32s14.3 32 32 32h96v32H80c-26.5 0-48 21.5-48 48v96c0 26.5 21.5 48 48 48H240c26.5 0 48-21.5 48-48V368c0-26.5-21.5-48-48-48H192V288H448v32H400c-26.5 0-48 21.5-48 48v96c0 26.5 21.5 48 48 48H560c26.5 0 48-21.5 48-48V368c0-26.5-21.5-48-48-48H512V288h96c17.7 0 32-14.3 32-32s-14.3-32-32-32H352V192h48c26.5 0 48-21.5 48-48V48c0-26.5-21.5-48-48-48H240zM96 448V384H224v64H96zm320-64H544v64H416V384z"]},xae={prefix:"fas",iconName:"spinner",icon:[512,512,[],"f110","M304 48c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zm0 416c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zM48 304c26.5 0 48-21.5 48-48s-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48zm464-48c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zM142.9 437c18.7-18.7 18.7-49.1 0-67.9s-49.1-18.7-67.9 0s-18.7 49.1 0 67.9s49.1 18.7 67.9 0zm0-294.2c18.7-18.7 18.7-49.1 0-67.9S93.7 56.2 75 75s-18.7 49.1 0 67.9s49.1 18.7 67.9 0zM369.1 437c18.7 18.7 49.1 18.7 67.9 0s18.7-49.1 0-67.9s-49.1-18.7-67.9 0s-18.7 49.1 0 67.9z"]},mH={prefix:"fas",iconName:"desktop",icon:[576,512,[128421,61704,"desktop-alt"],"f390","M64 0C28.7 0 0 28.7 0 64V352c0 35.3 28.7 64 64 64H240l-10.7 32H160c-17.7 0-32 14.3-32 32s14.3 32 32 32H416c17.7 0 32-14.3 32-32s-14.3-32-32-32H346.7L336 416H512c35.3 0 64-28.7 64-64V64c0-35.3-28.7-64-64-64H64zM512 64V288H64V64H512z"]},pce={prefix:"fas",iconName:"book-open",icon:[576,512,[128214,128366],"f518","M249.6 471.5c10.8 3.8 22.4-4.1 22.4-15.5V78.6c0-4.2-1.6-8.4-5-11C247.4 52 202.4 32 144 32C87.5 32 35.1 48.6 9 59.9c-5.6 2.4-9 8-9 14V454.1c0 11.9 12.8 20.2 24.1 16.5C55.6 460.1 105.5 448 144 448c33.9 0 79 14 105.6 23.5zm76.8 0C353 462 398.1 448 432 448c38.5 0 88.4 12.1 119.9 22.6c11.3 3.8 24.1-4.6 24.1-16.5V73.9c0-6.1-3.4-11.6-9-14C540.9 48.6 488.5 32 432 32c-58.4 0-103.4 20-123 35.6c-3.3 2.6-5 6.8-5 11V456c0 11.4 11.7 19.3 22.4 15.5z"]};class b2{constructor(t,e){this.userDAO=t,this.connectedUserService=e,this.userSubscription=new q1,this.observedPartLoading=!0,this.observedPart=T.empty(),this.observedPartRS=new Ate(1),this.observedPartObs=this.observedPartRS.asObservable(),this.authSubscription=this.connectedUserService.subscribeToUser(r=>{this.onUserUpdate(r)})}onUserUpdate(t){t===M5.NOT_CONNECTED?(this.authSubscription.unsubscribe(),this.observedPartRS.next(T.empty())):this.userSubscription=this.userDAO.subscribeToChanges(t.id,e=>{Pe(e.isPresent(),"When observing part service, user was expected to already have a document!");const r=e.get();this.updateObservedPartWithDoc(r.observedPart)})}updateObservedPartWithDoc(t){const e=this.observedPart,r=null==t&&e.isAbsent(),s=null!=t&&e.equalsValue(t);(!1===r&&!1===s||this.observedPartLoading)&&(this.observedPartLoading=!1,this.observedPart=T.ofNullable(t),this.observedPartRS.next(this.observedPart))}updateObservedPart(t){if(Pe(this.connectedUserService.user.isPresent(),"Should not call updateObservedPart when not connected"),this.observedPart.isPresent()){const r={...this.observedPart.get(),...t};return this.userDAO.update(this.connectedUserService.user.get().id,{observedPart:r})}{const r=Object.keys({id:"id",role:"Candidate",typeGame:"P4"});for(const s of r)Pe(null!=t[s],"field "+s+" should be set before updating observedPart");return this.userDAO.update(this.connectedUserService.user.get().id,{observedPart:t})}}removeObservedPart(){return Pe(this.connectedUserService.user.isPresent(),"Should not call removeObservedPart when not connected"),this.userDAO.update(this.connectedUserService.user.get().id,{observedPart:null})}subscribeToObservedPart(t){return this.observedPartObs.subscribe(t)}canUserCreate(){if(this.observedPart.isAbsent())return R.SUCCESS;{const t=b2.roleToMessage.get(this.observedPart.get().role).get()();return R.failure(t)}}canUserJoin(t,e){if(this.observedPart.isAbsent()||this.observedPart.get().id===t)return R.SUCCESS;if(e&&"Observer"===this.observedPart.get().role)return R.SUCCESS;{const r=b2.roleToMessage.get(this.observedPart.get().role).get()();return R.failure(r)}}ngOnDestroy(){this.userSubscription.unsubscribe(),this.authSubscription.unsubscribe()}}function O3t(n,t){if(1&n&&(pn(0),ve(1,31),gn()),2&n){const e=C(2);P(1),x1(e.observedPart.get().typeGame)(null==e.observedPart.get().opponent?null:e.observedPart.get().opponent.name),B1(1)}}function A3t(n,t){if(1&n&&(pn(0),ve(1,33),gn()),2&n){const e=C(3);P(1),x1(e.observedPart.get().typeGame)(null==e.observedPart.get().opponent?null:e.observedPart.get().opponent.name),B1(1)}}function N3t(n,t){if(1&n&&(pn(0),ve(1,34),gn()),2&n){const e=C(3);P(1),x1(e.observedPart.get().typeGame),B1(1)}}function I3t(n,t){if(1&n&&(x(0,A3t,2,2,"ng-container",27),x(1,N3t,2,1,"ng-template",null,32,Zn)),2&n){const e=Bn(2);w("ngIf",C(2).observedPart.get().opponent)("ngIfElse",e)}}function x3t(n,t){if(1&n){const e=Oe();O(0,"a",29),ee("click",function(){return ue(e),ce(C().navigateToPart())}),x(1,O3t,2,2,"ng-container",27),x(2,I3t,3,2,"ng-template",null,30,Zn),A()}if(2&n){const e=Bn(3),r=C();P(1),w("ngIf","Observer"===r.observedPart.get().role||"Candidate"===r.observedPart.get().role)("ngIfElse",e)}}function k3t(n,t){if(1&n&&(pn(0),X(1,"fa-icon",35),gn()),2&n){const e=C();P(1),w("icon",e.faSpinner)}}function L3t(n,t){if(1&n){const e=Oe();pn(0),O(1,"div",10)(2,"a",37),Tt(3),A(),O(4,"div",13)(5,"a",38),ee("click",function(){return ue(e),ce(C(2).logout())}),ve(6,39),A()()(),gn()}if(2&n){const e=C(2);P(3),c1(e.username.get())}}b2.roleToMessage=new Un([{key:"Candidate",value:Cm.YOU_ARE_ALREADY_CANDIDATE},{key:"ChosenOpponent",value:Cm.YOU_ARE_ALREADY_CHOSEN_OPPONENT},{key:"Creator",value:Cm.YOU_ARE_ALREADY_CREATING},{key:"Player",value:Cm.YOU_ARE_ALREADY_PLAYING},{key:"Observer",value:Cm.YOU_ARE_ALREADY_OBSERVING}]),b2.\u0275fac=function(t){return new(t||b2)(Ve(IS),Ve(Ns))},b2.\u0275prov=rt({token:b2,factory:b2.\u0275fac,providedIn:"root"});const R3t=function(){return["/register"]},D3t=function(){return["/login"]};function z3t(n,t){1&n&&(O(0,"div",40)(1,"a",41)(2,"strong"),ve(3,42),A()(),O(4,"a",43),ve(5,44),A()()),2&n&&(P(1),w("routerLink",J1(2,R3t)),P(3),w("routerLink",J1(3,D3t)))}function V3t(n,t){if(1&n&&(x(0,L3t,7,1,"ng-container",27),x(1,z3t,6,4,"ng-template",null,36,Zn)),2&n){const e=Bn(2);w("ngIf",C().username.isPresent())("ngIfElse",e)}}const $ce=function(){return["/"]},H3t=function(){return["/play"]},F3t=function(){return["/lobby"]},B3t=function(){return["/local"]},$3t=function(){return["/tutorial"]},U3t=function(){return["/settings"]};let G3t=(()=>{class n{constructor(e,r,s,i){this.router=e,this.connectedUserService=r,this.observedPartService=s,this.userService=i,this.loading=!0,this.username=T.empty(),this.faCog=toe,this.faSpinner=xae,this.showMenu=!1,this.observedPart=T.empty()}ngOnInit(){this.userSubscription=this.connectedUserService.subscribeToUser(e=>{this.loading=!1,this.username=e.username.isPresent()?e.username:e.email}),this.observedPartSubscription=this.observedPartService.subscribeToObservedPart(e=>{this.observedPart=e})}logout(){var e=this;return I(function*(){yield e.connectedUserService.disconnect(),yield e.router.navigate(["/"])})()}navigateToPart(){var e=this;return I(function*(){return e.router.navigate(["/play",e.observedPart.get().typeGame,e.observedPart.get().id])})()}ngOnDestroy(){this.userSubscription.unsubscribe(),this.observedPartSubscription.unsubscribe()}}return n.\u0275fac=function(e){return new(e||n)(J(Kn),J(Ns),J(b2),J(vm))},n.\u0275cmp=dt({type:n,selectors:[["app-header"]],decls:36,vars:20,consts:function(){let t,e,r,s,i,o,c,u,d,g,m,y,b,k;return t=$localize`Home`,e=$localize`Play online`,r=$localize`Create a game`,s=$localize`Join a game`,i=$localize`Play offline`,o=$localize`Create a game`,c=$localize`Learn the rules`,u=$localize`Settings`,d=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: by ${"\ufffd1\ufffd"}:INTERPOLATION_1:`,g=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: against ${"\ufffd1\ufffd"}:INTERPOLATION_1:`,m=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: (waiting for opponent)`,y=$localize`Log out`,b=$localize`Register`,k=$localize`Log in`,[["role","navigation","aria-label","main navigation",1,"navbar","is-primary"],[1,"navbar-brand"],[1,"navbar-item",3,"routerLink"],["id","logo","src","assets/images/logo.png","width","28","height","28"],["role","button","aria-label","menu","aria-expanded","false","data-target","menu",1,"navbar-burger",3,"ngClass","click"],["aria-hidden","true"],["id","menu",1,"navbar-menu",3,"ngClass","click"],[1,"navbar-start"],["id","home",1,"navbar-item",3,"routerLink"],t,[1,"navbar-item","has-dropdown","is-hoverable"],[1,"navbar-link"],e,[1,"navbar-dropdown"],r,s,["id","playOffline",1,"navbar-link"],i,["id","playLocally",1,"navbar-item",3,"routerLink"],o,["id","tutorial",1,"navbar-item",3,"routerLink"],c,[1,"navbar-end"],["id","observedPartLink","class","navbar-item",3,"click",4,"ngIf"],["data-tooltip",u,1,"navbar-item",3,"routerLink"],[3,"icon"],[1,"navbar-item"],[4,"ngIf","ngIfElse"],["showUsernameOrLogin",""],["id","observedPartLink",1,"navbar-item",3,"click"],["activeUser",""],d,["waitingForOpponent",""],g,m,[1,"navbar-item","fa-spin",3,"icon"],["connect",""],["id","connectedUserName",1,"navbar-link"],["id","logout",1,"navbar-item",3,"click"],y,[1,"buttons"],["id","register",1,"button","is-primary",3,"routerLink"],b,["id","login",1,"button","is-light",3,"routerLink"],k]},template:function(e,r){if(1&e&&(O(0,"nav",0)(1,"div",1)(2,"a",2),X(3,"img",3),A(),O(4,"a",4),ee("click",function(){return r.showMenu=!r.showMenu}),X(5,"span",5)(6,"span",5)(7,"span",5),A()(),O(8,"div",6),ee("click",function(){return r.showMenu=!r.showMenu}),O(9,"div",7)(10,"a",8),ve(11,9),A(),O(12,"div",10)(13,"a",11),ve(14,12),A(),O(15,"div",13)(16,"a",2),ve(17,14),A(),O(18,"a",2),ve(19,15),A()()(),O(20,"div",10)(21,"a",16),ve(22,17),A(),O(23,"div",13)(24,"a",18),ve(25,19),A(),O(26,"a",20),ve(27,21),A()()()(),O(28,"div",22),x(29,x3t,4,2,"a",23),O(30,"a",24),X(31,"fa-icon",25),A(),O(32,"div",26),x(33,k3t,2,1,"ng-container",27),x(34,V3t,3,2,"ng-template",null,28,Zn),A()()()()),2&e){const s=Bn(35);P(2),w("routerLink",J1(13,$ce)),P(2),w("ngClass",r.showMenu?"is-active":""),P(4),w("ngClass",r.showMenu?"is-active":""),P(2),w("routerLink",J1(14,$ce)),P(6),w("routerLink",J1(15,H3t)),P(2),w("routerLink",J1(16,F3t)),P(6),w("routerLink",J1(17,B3t)),P(2),w("routerLink",J1(18,$3t)),P(3),w("ngIf",r.observedPart.isPresent()),P(1),w("routerLink",J1(19,U3t)),P(1),w("icon",r.faCog),P(2),w("ngIf",r.loading)("ngIfElse",s)}},dependencies:[fn,Kt,Lu,Sd],encapsulation:2}),n})(),W3t=(()=>{class n{constructor(e,r){this._themeService=e,this._errorLoggerService=r,this.faTwitter=une,this.faFacebook=rne,this.faGithub=lne}}return n.\u0275fac=function(e){return new(e||n)(J(RS),J(As))},n.\u0275cmp=dt({type:n,selectors:[["app-root"]],decls:18,vars:3,consts:function(){let t;return t=$localize`If you like ${"\ufffd#8\ufffd"}:START_TAG_STRONG:EveryBoard${"\ufffd/#8\ufffd"}:CLOSE_TAG_STRONG:, follow us!`,[[1,"container","mt-2"],[1,"footer"],[1,"content","has-text-centered"],t,["href","https://github.com/EveryBoard/EveryBoard"],[3,"icon"],["href","https://twitter.com/EveryBoardGames"],["href","https://facebook.com/EveryBoard"]]},template:function(e,r){1&e&&(X(0,"app-header"),O(1,"main",0),X(2,"router-outlet"),A(),O(3,"footer",1)(4,"div",2)(5,"p")(6,"span"),Sc(7,3),X(8,"strong"),Pc(),A(),Tt(9," \xa0 "),O(10,"a",4),X(11,"fa-icon",5),A(),Tt(12,"\xa0 "),O(13,"a",6),X(14,"fa-icon",5),A(),Tt(15,"\xa0 "),O(16,"a",7),X(17,"fa-icon",5),A()()()()),2&e&&(P(11),w("icon",r.faGithub),P(3),w("icon",r.faTwitter),P(3),w("icon",r.faFacebook))},dependencies:[eN,Sd,G3t],encapsulation:2}),n})();class Fi{}class dn{constructor(t){this.x=t}static from(t){switch(t){case 0:return dn.ZERO;case 1:return dn.ONE;case 2:return dn.TWO;default:return Pe(3===t,"Invalid Apagos Coord "+t),dn.THREE}}equals(t){return this.x===t.x}}dn.encoder=new class extends Nt{encodeMove(n){return n.x}decodeMove(n){return Me.assert(null!=n,"Invalid encoded ApagosCoord: "+n),dn.from(n)}},dn.ZERO=new dn(0),dn.ONE=new dn(1),dn.TWO=new dn(2),dn.THREE=new dn(3);let Pd=(()=>{class n{}return n.PIECE_SHOULD_MOVE_DOWNWARD=()=>$localize`Pieces should only move downward!`,n.CANNOT_LAND_ON_A_FULL_SQUARE=()=>$localize`That square is already full, you cannot put a piece in it!`,n.NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE=()=>$localize`You have no pieces in that square, select one that contains at least one of your pieces!`,n.NO_PIECE_REMAINING_TO_DROP=()=>$localize`There are no remaining pieces of that color to drop!`,n.NO_POSSIBLE_TRANSFER_REMAINS=()=>$localize`There is no possible transfer from that square!`,n})();class cr extends Fi{constructor(t,e,r){super(),this.landing=t,this.piece=e,this.starting=r}static drop(t,e){return Me.getNonNullable(cr.ALL_MOVES.find(s=>s.landing.equals(t)&&s.piece.equalsValue(e)&&s.starting.equals(T.empty())))}static transfer(t,e){if(t.x<=e.x)return _e.failure(Pd.PIECE_SHOULD_MOVE_DOWNWARD());const r=Me.getNonNullable(cr.ALL_MOVES.find(s=>s.landing.equals(e)&&s.piece.equals(T.empty())&&s.starting.equals(T.of(t))));return _e.success(r)}isDrop(){return this.piece.isPresent()}toString(){return this.isDrop()?"ApagosMove.drop("+this.piece.get().toString()+" on "+this.landing.x+")":"ApagosMove.slideDown("+this.starting.get().x+" > "+this.landing.x+")"}equals(t){return!1!==this.starting.equals(t.starting)&&!1!==this.landing.equals(t.landing)&&this.piece.equals(t.piece)}}cr.ALL_MOVES=[new cr(dn.ZERO,T.of(B.ZERO),T.empty()),new cr(dn.ONE,T.of(B.ZERO),T.empty()),new cr(dn.TWO,T.of(B.ZERO),T.empty()),new cr(dn.THREE,T.of(B.ZERO),T.empty()),new cr(dn.ZERO,T.of(B.ONE),T.empty()),new cr(dn.ONE,T.of(B.ONE),T.empty()),new cr(dn.TWO,T.of(B.ONE),T.empty()),new cr(dn.THREE,T.of(B.ONE),T.empty()),new cr(dn.TWO,T.empty(),T.of(dn.THREE)),new cr(dn.ONE,T.empty(),T.of(dn.THREE)),new cr(dn.ZERO,T.empty(),T.of(dn.THREE)),new cr(dn.ONE,T.empty(),T.of(dn.TWO)),new cr(dn.ZERO,T.empty(),T.of(dn.TWO)),new cr(dn.ZERO,T.empty(),T.of(dn.ONE))],cr.encoder=Nt.tuple([dn.encoder,T.getEncoder(B.encoder),T.getEncoder(dn.encoder)],n=>[n.landing,n.piece,n.starting],n=>new cr(n[0],n[1],n[2]));class _P{constructor(t){this.turn=t}getCurrentPlayer(){return B.fromTurn(this.turn)}getCurrentOpponent(){return this.turn%2==1?B.ZERO:B.ONE}}class Hm{constructor(t){this.containing=t}static from(t,e,r){if(t+e>r)return _e.failure("invalid starting space");const s=new Un([{key:B.ZERO,value:t},{key:B.ONE,value:e},{key:he.NONE,value:r}]);s.makeImmutable();const i=new Hm(s);return _e.success(i)}isFull(){return this.count(B.ZERO)+this.count(B.ONE)>=this.count(he.NONE)}count(t){return this.containing.get(t).get()}addPiece(t){let e=this.count(B.ZERO),r=this.count(B.ONE);const s=this.count(he.NONE);return t===B.ZERO?e++:r++,Hm.from(e,r,s).get()}substractPiece(t){let e=this.count(B.ZERO),r=this.count(B.ONE);const s=this.count(he.NONE);return t===B.ZERO?e--:r--,Hm.from(e,r,s).get()}getDominatingPlayer(){const t=this.count(B.ZERO),e=this.count(B.ONE);return t>e?B.ZERO:e>t?B.ONE:he.NONE}equals(t){return this.containing.equals(t.containing)}}let i8=(()=>{class n extends _P{constructor(e,r,s){super(e),this.board=r,this.remaining=s,this.remaining.makeImmutable()}static getInitialState(){return n.fromRepresentation(0,[[0,0,0,0],[0,0,0,0],[7,5,3,1]],this.PIECES_PER_PLAYER,this.PIECES_PER_PLAYER)}static fromRepresentation(e,r,s,i){const o=[];for(let u=0;u<4;u++){const y=Hm.from(r[0][u],r[1][u],r[2][u]).get();o.push(y)}const c=new Un;return c.set(B.ZERO,s),c.set(B.ONE,i),new n(e,o,c)}getPieceAt(e){return this.board[e.x]}updateAt(e,r){const s=[];for(let o=0;o<4;o++)s.push(e.x===o?r:this.board[o]);const i=this.getRemainingCopy();return new n(this.turn,s,i)}getRemainingCopy(){return this.remaining.getCopy()}getRemaining(e){return this.remaining.get(e).get()}equals(e){return this.turn===e.turn&&Xe.compareArray(e.board,this.board)&&this.remaining.equals(e.remaining)}}return n.PIECES_PER_PLAYER=10,n})();class ie{constructor(t,e,r){this.title=t,this.instruction=e,this.state=r,this.previousMove=T.empty(),this.previousState=T.empty()}static fromMove(t,e,r,s,i,o){return new q3t(t,e,r,s,i,o)}static forClick(t,e,r,s,i,o){return new Z3t(t,e,r,s,i,o)}static anyMove(t,e,r,s,i){return new j3t(t,e,r,s,i)}static fromPredicate(t,e,r,s,i,o){return new Y3t(t,e,r,s,i,o)}static informational(t,e,r){return new K3t(t,e,r)}isMove(){return!1}isAnyMove(){return!1}isClick(){return!1}isPredicate(){return!1}isInformation(){return!1}hasSolution(){return!1}withPreviousMove(t){return this.previousMove=T.of(t),this}withPreviousState(t){return this.previousState=T.of(t),this}}class vP extends ie{constructor(t,e,r,s){super(t,e,r),this.successMessage=s}hasSolution(){return!0}getSuccessMessage(){return this.successMessage}}class q3t extends vP{constructor(t,e,r,s,i,o){super(t,e,r,i),this.acceptedMoves=s,this.failureMessage=o,Pe(s.length>0,"TutorialStepMove: At least one accepted move should be provided, otherwise use TutorialStepInformational")}isMove(){return!0}getSolution(){return this.acceptedMoves[0]}getFailureMessage(){return this.failureMessage}}class j3t extends vP{constructor(t,e,r,s,i){super(t,e,r,i),this.solutionMove=s}getSolution(){return this.solutionMove}isAnyMove(){return!0}}class Z3t extends vP{constructor(t,e,r,s,i,o){super(t,e,r,i),this.acceptedClicks=s,this.failureMessage=o}isClick(){return!0}getSolution(){return this.acceptedClicks[0]}getFailureMessage(){return this.failureMessage}}class Y3t extends vP{constructor(t,e,r,s,i,o){super(t,e,r,o),this.solutionMove=s,this.predicate=i}getSolution(){return this.solutionMove}isPredicate(){return!0}}class K3t extends ie{isInformation(){return!0}}class $1{}class Uce extends $1{constructor(){super(...arguments),this.tutorial=[ie.informational($localize`Initial board and object of the game`,$localize`At Apagos, there are 4 squares, each of them has a fixed number of holes for pieces. Each player starts with 10 pieces. Dark pieces belong to the first player, light pieces belong to the second one. The game ends when no one can play. The player owning the most pieces in the rightmost square wins!`,i8.getInitialState()),ie.anyMove($localize`Drop`,$localize`There are two kinds of moves. One is the drop. To do one, you must click on a visible arrow, being of your color or the opponent's. If the chosen square is one of the 3 leftmost ones, it will exchange position with the square on its right.<br/><br/>You're playing Light. Drop a piece on one of those three squares.`,i8.fromRepresentation(1,[[0,0,0,1],[0,0,0,0],[7,5,3,1]],9,10),cr.drop(dn.ZERO,B.ZERO),$localize`Congratulations!`),ie.fromPredicate($localize`Transfer`,$localize`The other kind of move is the transfer.<ol><li>Choose one of your pieces on the board by clicking on the square in which it is.</li><li>Choose its landing square by clicking on one of the arrow to finish the transfer.</li></ol>It can only be done with your pieces, from a higher square to a lower one.<br/><br/>You're playing Dark, do a transfer!`,i8.fromRepresentation(2,[[0,0,1,0],[0,1,0,0],[7,5,3,1]],9,9),cr.transfer(dn.TWO,dn.ZERO).get(),(t,e,r)=>t.isDrop()?R.failure($localize`This move is a drop, please do a transfer!`):R.SUCCESS,$localize`Congratulations!`),ie.fromPredicate($localize`Victory`,$localize`When you put a last piece into a square, the games end. In this configuration you can win.<br/><br/>You're playing Light, do the winning move!`,i8.fromRepresentation(3,[[1,0,3,4],[2,1,3,1],[3,1,7,5]],2,3),cr.drop(dn.TWO,B.ONE),(t,e,r)=>t.isDrop()?t.piece.equalsValue(B.ONE)?R.SUCCESS:R.failure($localize`You actively made your opponent win!`):R.failure($localize`Wrong choice, your opponent will win in the next turn no matter which piece is dropped!`),$localize`Congratulations!`)]}}class k1{constructor(t){this.value=t}static fromWinner(t){return t.isPlayer()?new k1(t.getVictoryValue()):new k1(0)}static from(t,e){return t*=B.ZERO.getScoreModifier(),e*=B.ONE.getScoreModifier(),new k1(t+e)}toString(){return""+this.value}}class xe{constructor(t,e){this.isEndGame=t,this.winner=e}static getVictory(t){return t===B.ZERO?xe.ZERO_WON:xe.ONE_WON}static getDefeat(t){return t===B.ZERO?xe.ONE_WON:xe.ZERO_WON}toBoardValue(){return this.winner.isPlayer()?new k1(this.winner.getVictoryValue()):new k1(0)}}xe.ZERO_WON=new xe(!0,B.ZERO),xe.ONE_WON=new xe(!0,B.ONE),xe.DRAW=new xe(!0,he.NONE),xe.ONGOING=new xe(!1,he.NONE);var Mn=(()=>(function(n){n.VICTORY="VICTORY",n.PRE_VICTORY="PRE_VICTORY",n.DEFAULT="DEFAULT"}(Mn||(Mn={})),Mn))();let CP=(()=>{class n{}return n.createdNodes=0,n.minimaxTime=0,n})();class U1{constructor(t,e=T.empty(),r=T.empty(),s){if(this.gameState=t,this.mother=e,this.move=r,this.minimaxCreator=s,this.childs=T.empty(),this.hopedValue=new Un,this.ownValue=new Un,this.possibleMoves=new Un,this.ownValue=new Un,null!=s){const i=s.getBoardValue(this);this.ownValue.set(s.name,i),this.hopedValue.set(s.name,i.value)}CP.createdNodes++,Q(U1.VERBOSE,"creating "+this.myToString())}static getScoreStatus(t){return t===Number.MAX_SAFE_INTEGER||t===Number.MIN_SAFE_INTEGER?(Q(U1.VERBOSE||!1,"VICTORY"),Mn.VICTORY):t===Number.MIN_SAFE_INTEGER+1?(Q(U1.VERBOSE||!1,"PRE_VICTORY_MIN"),Mn.PRE_VICTORY):t===Number.MAX_SAFE_INTEGER-1?(Q(U1.VERBOSE||!1,"PRE_VICTORY_MAX"),Mn.PRE_VICTORY):(Q(U1.VERBOSE||!1,"DEFAULT"),Mn.DEFAULT)}findBestMove(t,e,r=!1,s=!0){const i=(new Date).getTime();let o=this.alphaBeta(t,Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,e,r,s);for(;o.gameState.turn>this.gameState.turn+1;)o=o.mother.get(),t--;return CP.minimaxTime+=(new Date).getTime()-i,o.move.get()}alphaBeta(t,e,r,s,i,o){if(t<1)return Q(U1.VERBOSE||!1,"isLeaf-Calculation : "+this.myToString()+" at depth "+t),this;if(s.ruler.getGameStatus(this).isEndGame)return Q(U1.VERBOSE||!1,"isLeaf-EndGame("+U1.ruler.getGameStatus(this).winner.toString()+") : "+this.myToString()+" at depth "+t),this;const u=this.getPossibleMoves(s);Pe(u.size()>0,"Minimax "+s.name+" should give move, received none!"),this.childs.isAbsent()&&(this.childs=T.of([]));const d=this.getBestChilds(u,t,e,r,s,i,o),g=this.getBestChildAmongst(d,i),m=g.hopedValue.get(s.toString()).get();return this.hopedValue.put(s.toString(),m),g}getPossibleMoves(t){const e=this.possibleMoves.get(t.name);if(e.isAbsent()){const r=t.getListMoves(this);return this.possibleMoves.set(t.name,new zt(r)),new zt(r)}return e.get()}getBestChilds(t,e,r,s,i,o,c){let u=[];const d=this.gameState.getCurrentPlayer();let g=d===B.ZERO?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER;const m=d===B.ZERO?(y,b)=>y<b:(y,b)=>b<y;for(const y of t){const k=this.getOrCreateChild(y,i).alphaBeta(e-1,r,s,i,o,c),$=k.getHopedValue(i);if(m($,g)||0===u.length?(g=$,u=[k]):$===g&&u.push(k),c&&m(g,d===B.ZERO?r:s))break;d===B.ZERO?s=Math.min(g,s):r=Math.max(g,r)}return u}getBestChildAmongst(t,e){return e?t[Math.floor(Math.random()*t.length)]:t[0]}getOrCreateChild(t,e){let r=this.getSonByMove(t);if(r.isAbsent()){const s=e.ruler.isLegal(t,this.gameState),i=t.toString();Pe(s.isSuccess(),'The minimax "'+e.name+'" has proposed an illegal move ('+i+"), this should not happen.");const o=e.ruler.applyLegalMove(t,this.gameState,s.get());r=T.of(new U1(o,T.of(this),T.of(t),e)),this.childs.get().push(r.get())}return r.get()}getSonByMove(t){Pe(this.childs.isPresent(),"Cannot get son of uncalculated node");for(const e of this.childs.get())if(e.move.isPresent()&&e.move.equalsValue(t))return T.of(e);return T.empty()}getHopedValue(t){return this.hopedValue.get(t.name).get()}getOwnValue(t){const e=this.ownValue.get(t.name);if(e.isAbsent()){const r=t.getBoardValue(this);return this.ownValue.set(t.name,r),r}return e.get()}myToString(){let t="",e=this;if(e.mother.isAbsent())return"NodeInitial: "+e.gameState.turn;for(;e.mother.isPresent();)t=(e.move.isAbsent()?" ":" > "+e.move.get().toString()+"> ")+e.gameState.turn+" "+t,e=e.mother.get();return"Node: "+t}hasMoves(){return this.childs.isPresent()}countDescendants(){if(this.childs.isAbsent())return 0;let t=this.childs.get().length;for(const e of this.childs.get())t+=e.countDescendants();return t}}U1.VERBOSE=!1,U1.minimaxes=new Un;class L1{constructor(t){this.stateType=t,this.setInitialBoard()}choose(t){Q(!1,"Rules.choose: "+t.toString()+" was proposed");const r=this.isLegal(t,this.node.gameState);if(this.node.hasMoves()){Q(!1,"Rules.choose: current node has moves");const o=this.node.getSonByMove(t);if(o.isPresent())return Pe(r.isSuccess(),"Rules.choose: Move is illegal: "+r.getReasonOr("")),Q(!1,"Rules.choose: and this proposed move is found in the list, so it is legal"),this.node=o.get(),!0}if(Q(!1,"Rules.choose: current node has no moves or is pruned, let's verify ourselves"),r.isFailure())return Q(!1,"Rules.choose: Move is illegal: "+r.getReason()),!1;Q(!1,"Rules.choose: Move is legal, let's apply it");const s=this.applyLegalMove(t,this.node.gameState,r.get()),i=new U1(s,T.of(this.node),T.of(t));return this.node=i,!0}setInitialBoard(){const t=this.stateType.getInitialState();U1.ruler=this,this.node=new U1(t)}applyMoves(t,e,r){let s=0;for(const i of t){const o=r(i),c=this.isLegal(o,e);Pe(c.isSuccess(),"Can't create state from invalid moves ("+s+"): "+c.toString()+"."),e=this.applyLegalMove(o,e,c.get()),s++}return e}}class l6 extends L1{constructor(){super(i8)}static get(){return l6.singleton.isAbsent()&&(l6.singleton=T.of(new l6)),l6.singleton.get()}applyLegalMove(t,e,r){return t.isDrop()?this.applyLegalDrop(t,e):this.applyLegalTransfer(t,e)}applyLegalDrop(t,e){const r=e.getRemainingCopy(),s=r.get(t.piece.get()).get();r.put(t.piece.get(),s-1);const i=new i8(e.turn+1,e.board,r),o=t.piece.get(),c=i.getPieceAt(t.landing).addPiece(o);if(t.landing===dn.THREE)return i.updateAt(t.landing,c);{const u=dn.from(t.landing.x+1),d=i.getPieceAt(u);return i.updateAt(t.landing,d).updateAt(u,c)}}applyLegalTransfer(t,e){const r=e.getCurrentPlayer(),s=t.starting.get(),i=e.getPieceAt(s).substractPiece(r),o=e.getPieceAt(t.landing).addPiece(r);let c=e.updateAt(s,i);return c=c.updateAt(t.landing,o),new i8(c.turn+1,c.board,c.remaining)}isLegal(t,e){return e.getPieceAt(t.landing).isFull()?R.failure(Pd.CANNOT_LAND_ON_A_FULL_SQUARE()):t.isDrop()?this.isLegalDrop(t,e):this.isLegalSlideDown(t,e)}isLegalDrop(t,e){return e.getRemaining(t.piece.get())<=0?R.failure(Pd.NO_PIECE_REMAINING_TO_DROP()):R.SUCCESS}isLegalSlideDown(t,e){const r=e.getCurrentPlayer();return 0===e.getPieceAt(t.starting.get()).count(r)?R.failure(Pd.NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE()):R.SUCCESS}getGameStatus(t){const e=t.gameState;for(let s=0;s<4;s++)if(!1===e.getPieceAt(dn.from(s)).isFull())return xe.ONGOING;const r=e.getPieceAt(dn.THREE).getDominatingPlayer();return Pe(r.isPlayer(),"winner can only be a player if the game is finished"),xe.getVictory(r)}}l6.singleton=T.empty();class Bt{constructor(t,e){this.x=t,this.y=e}equals(t){return this.x===t.x&&this.y===t.y}isDiagonalOfLength(t){return Math.abs(this.x)===t&&Math.abs(this.y)===t}toMinimalVector(){const t=Math.abs(this.x),e=Math.abs(this.y),r=Math.max(t,e);let s=1,i=2;for(;i<=r;)this.x%i==0&&this.y%i==0&&(s=i),i++;return new Bt(this.x/s,this.y/s)}combine(t,e=1){return new Bt(this.x+e*t.x,this.y+e*t.y)}toString(){return"("+this.x+", "+this.y+")"}}class PH extends Bt{isDown(){return 1===this.y}isUp(){return-1===this.y}isLeft(){return-1===this.x}isRight(){return 1===this.x}toInt(){return 0===this.x&&-1===this.y?0:1===this.x&&0===this.y?1:0===this.x&&1===this.y?2:-1===this.x&&0===this.y?3:-1===this.x&&-1===this.y?4:1===this.x&&-1===this.y?5:-1===this.x&&1===this.y?6:7}toString(){return 0===this.x&&-1===this.y?"UP":1===this.x&&0===this.y?"RIGHT":0===this.x&&1===this.y?"DOWN":-1===this.x&&0===this.y?"LEFT":-1===this.x&&-1===this.y?"UP_LEFT":1===this.x&&-1===this.y?"UP_RIGHT":-1===this.x&&1===this.y?"DOWN_LEFT":"DOWN_RIGHT"}}class TH{of(t,e){for(const r of this.all)if(r.x===t&&r.y===e)return _e.success(r);return _e.failure("Invalid x and y in direction construction")}fromDelta(t,e){return 0===t&&0===e?_e.failure("Empty delta for direction"):Math.abs(t)===Math.abs(e)||0===t||0===e?this.of(Math.sign(t),Math.sign(e)):_e.failure(J3t.DIRECTION_MUST_BE_LINEAR())}fromMove(t,e){return this.fromDelta(e.x-t.x,e.y-t.y)}fromString(t){switch(t){case"UP":return this.of(0,-1);case"RIGHT":return this.of(1,0);case"DOWN":return this.of(0,1);case"LEFT":return this.of(-1,0);case"UP_LEFT":return this.of(-1,-1);case"UP_RIGHT":return this.of(1,-1);case"DOWN_LEFT":return this.of(-1,1);case"DOWN_RIGHT":return this.of(1,1);default:return _e.failure(`Invalid direction string ${t}`)}}fromInt(t){switch(t){case 0:return this.of(0,-1);case 1:return this.of(1,0);case 2:return this.of(0,1);case 3:return this.of(-1,0);case 4:return this.of(-1,-1);case 5:return this.of(1,-1);case 6:return this.of(-1,1);case 7:return this.of(1,1);default:return _e.failure(`Invalid int direction: ${t}`)}}}class Ne extends PH{constructor(t,e){super(t,e)}isDiagonal(){return 0!==this.x&&0!==this.y}getOpposite(){return Ne.factory.of(-this.x,-this.y).get()}}Ne.UP=new Ne(0,-1),Ne.UP_RIGHT=new Ne(1,-1),Ne.RIGHT=new Ne(1,0),Ne.DOWN_RIGHT=new Ne(1,1),Ne.DOWN=new Ne(0,1),Ne.DOWN_LEFT=new Ne(-1,1),Ne.LEFT=new Ne(-1,0),Ne.UP_LEFT=new Ne(-1,-1),Ne.factory=new class extends TH{constructor(){super(...arguments),this.all=[Ne.UP,Ne.UP_RIGHT,Ne.RIGHT,Ne.DOWN_RIGHT,Ne.DOWN,Ne.DOWN_LEFT,Ne.LEFT,Ne.UP_LEFT]}},Ne.DIRECTIONS=Ne.factory.all,Ne.DIAGONALS=[Ne.UP_RIGHT,Ne.DOWN_RIGHT,Ne.DOWN_LEFT,Ne.UP_LEFT],Ne.ORTHOGONALS=[Ne.UP,Ne.RIGHT,Ne.DOWN,Ne.LEFT],Ne.encoder=new class X3t extends L4{encode(t){return t.toString()}decode(t){return Pe("string"==typeof t,"Invalid encoded direction"),Ne.factory.fromString(t).get()}};class $e extends PH{constructor(t,e){super(t,e)}getOpposite(){return $e.factory.of(-this.x,-this.y).get()}rotateClockwise(){return $e.factory.of(-this.y,this.x).get()}}$e.UP=new $e(0,-1),$e.RIGHT=new $e(1,0),$e.DOWN=new $e(0,1),$e.LEFT=new $e(-1,0),$e.factory=new class extends TH{constructor(){super(...arguments),this.all=[$e.UP,$e.RIGHT,$e.DOWN,$e.LEFT]}of(n,t){return 0===n&&-1===t?_e.success($e.UP):1===n&&0===t?_e.success($e.RIGHT):0===n&&1===t?_e.success($e.DOWN):-1===n&&0===t?_e.success($e.LEFT):_e.failure("Invalid orthogonal from x and y")}},$e.ORTHOGONALS=$e.factory.all,$e.encoder=new class Q3t extends L4{encode(t){return t.toString()}decode(t){return Pe("string"==typeof t,"Invalid encoded orthogonal"),$e.factory.fromString(t).get()}};let J3t=(()=>{class n{}return n.DIRECTION_MUST_BE_LINEAR=()=>$localize`You must move in a straight line! You can only move orthogonally or diagonally!`,n})(),wH=(()=>{class n{}return n.OUT_OF_RANGE=t=>`The coordinate ${t.toString()} is not on the board`,n})();class S extends Bt{constructor(t,e){super(t,e)}getNext(t,e){const r=this.combine(t,e);return new S(r.x,r.y)}getPrevious(t,e){return this.getNext(t,-(e=e??1))}getLeft(t){return new S(this.x+t.y,this.y+-t.x)}getRight(t){return new S(this.x+-t.y,this.y+t.x)}isInRange(t,e){return!(this.x<0||this.y<0||this.x>=t||this.y>=e)}isNotInRange(t,e){return this.x<0||this.y<0||this.x>=t||this.y>=e}getDirectionToward(t){return Ne.factory.fromMove(this,t)}getOrthogonalDistance(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}getDistance(t){if(!t.isAlignedWith(this))throw new Error("Cannot calculate distance with non aligned coords.");const e=Math.abs(t.x-this.x),r=Math.abs(t.y-this.y);return Math.max(e,r)}isHexagonallyAlignedWith(t){const e=this.x-t.x,r=this.y-t.y;return e!==r&&(e===-r||e*r==0)}isAlignedWith(t){const e=Math.abs(this.x-t.x),r=Math.abs(this.y-t.y);return e===r||e*r==0}getVectorToward(t){return new Bt(t.x-this.x,t.y-this.y)}toVector(){return new Bt(this.x,this.y)}getCoordsToward(t){if(t.equals(this))return[];if(!t.isAlignedWith(this))return[];const e=this.getDirectionToward(t).get();let r=this.getNext(e,1);const s=[];for(;!1===r.equals(t);)s.push(r),r=r.getNext(e,1);return s}getUntil(t){const e=[],r=this.getDirectionToward(t).get();let s=this.getNext(r);for(;!1===s.equals(t);)e.push(s),s=s.getNext(r);return e}equals(t){return this===t||t.x===this.x&&t.y===this.y}compareTo(t){return t.y===this.y?t.x===this.x?0:this.x<t.x?-1:1:this.y<t.y?-1:1}toSVGPoint(){return this.x+","+this.y}}S.encoder=new class extends Nt{encodeMove(n){return{x:n.x,y:n.y}}decodeMove(n){const t=n;return Pe(null!=t.x&&"number"==typeof t.x&&null!=t.y&&"number"==typeof t.y,"Invalid encoded coord"),new S(t.x,t.y)}};class Gce{constructor(){this.ArrayUtils=Xe}getPlayerClass(t){switch(t){case B.ZERO:return"player0-fill";case B.ONE:return"player1-fill";default:return Me.expectToBe(t,he.NONE),""}}}let o8=(()=>{class n extends Gce{constructor(e){super(),this.messageDisplayer=e,this.Player=B,this.SPACE_SIZE=100,this.STROKE_WIDTH=8,this.SMALL_STROKE_WIDTH=2,this.scores=T.empty(),this.imagesLocation="assets/images/",this.hasAsymmetricBoard=!1,this.rotation=""}message(e){this.messageDisplayer.gameMessage(e)}cancelMove(e){return this.cancelMoveAttempt(),this.cancelMoveOnWrapper(e),null==e?R.SUCCESS:(this.messageDisplayer.gameMessage(e),R.failure(e))}cancelMoveAttempt(){}pass(){var e=this;return I(function*(){return As.logError("GameComponent","pass() called on a game that does not redefine it",{gameName:e.constructor.name})})()}getTurn(){return this.rules.node.gameState.turn}getCurrentPlayer(){return this.rules.node.gameState.getCurrentPlayer()}getState(){return this.rules.node.gameState}getPreviousState(){return this.rules.node.mother.get().gameState}showLastMove(e){}}return n.\u0275fac=function(e){return new(e||n)(J(En))},n.\u0275cmp=dt({type:n,selectors:[["ng-component"]],features:[l],decls:0,vars:0,template:function(e,r){},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})(),Td=(()=>{class n extends o8{getHexaPointsAtXY(e,r){const s=new S(e,r);return this.getHexaPointsAt(s)}getHexaPointsAt(e){return this.hexaLayout.getHexaPointsAt(e)}getCenterAtXY(e,r){const s=new S(e,r);return this.getCenterAt(s)}getCenterAt(e){return this.hexaLayout.getCenterAt(e)}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=Mr(n)))(r||n)}}(),n.\u0275cmp=dt({type:n,selectors:[["ng-component"]],features:[l],decls:0,vars:0,template:function(e,r){},encapsulation:2}),n})();class ke{constructor(t){this.value=t}static from(t){switch(t){case ke.ZERO.value:return ke.ZERO;case ke.ONE.value:return ke.ONE;case ke.EMPTY.value:return ke.EMPTY;case ke.UNREACHABLE.value:return ke.UNREACHABLE;default:throw new Error("FourStatePiece has no value matching "+t)}}static ofPlayer(t){return t===B.ZERO?ke.ZERO:(Me.expectToBe(t,B.ONE),ke.ONE)}equals(t){return this===t}is(t){return this.value===t.value}isPlayer(){return this===ke.ZERO||this===ke.ONE}}ke.ZERO=new ke(B.ZERO.value),ke.ONE=new ke(B.ONE.value),ke.EMPTY=new ke(he.NONE.value),ke.UNREACHABLE=new ke(3);class Re extends PH{constructor(t,e){super(t,e)}static getAngle(t){switch(t){case Re.UP:return 0;case Re.UP_RIGHT:return 60;case Re.RIGHT:return 120;case Re.DOWN:return 180;case Re.DOWN_LEFT:return 240;default:return Me.expectToBe(t,Re.LEFT),300}}getOpposite(){return Re.factory.of(-this.x,-this.y).get()}}Re.UP=new Re(0,-1),Re.LEFT=new Re(-1,0),Re.UP_RIGHT=new Re(1,-1),Re.DOWN_LEFT=new Re(-1,1),Re.RIGHT=new Re(1,0),Re.DOWN=new Re(0,1),Re.factory=new class extends TH{constructor(){super(...arguments),this.all=[Re.UP,Re.UP_RIGHT,Re.RIGHT,Re.DOWN,Re.DOWN_LEFT,Re.LEFT]}},Re.encoder=new class e4t extends Nt{encodeMove(t){switch(t){case Re.UP:return 0;case Re.UP_RIGHT:return 1;case Re.RIGHT:return 2;case Re.DOWN:return 3;case Re.DOWN_LEFT:return 4;default:return 5}}decodeMove(t){return Pe(0<=t&&t<=5,"Invalid encoded number for HexaDirection "+t),Re.factory.all[t]}};class Wce{}class yP extends Wce{constructor(){super(),this.startAngle=.5,this.conversionMatrix=[Math.sqrt(3),Math.sqrt(3)/2,0,1.5],this.inverseConversionMatrix=[Math.sqrt(3)/3,-1/3,0,2/3]}}yP.INSTANCE=new yP;class Is extends Wce{constructor(){super(),this.startAngle=0,this.conversionMatrix=[1.5,0,Math.sqrt(3)/2,Math.sqrt(3)],this.inverseConversionMatrix=[2/3,0,-1/3,Math.sqrt(3)/3]}isOnBorder(t,e){return this.isOnTopRightBorder(t,e)||this.isOnRightBorder(t,e)||this.isOnBottomRightBorder(t,e)||this.isOnBottomLeftBorder(t,e)||this.isOnLeftBorder(t,e)||this.isOnTopLeftBorder(t,e)}isOnTopRightBorder(t,e){return 0===e.y}isOnRightBorder(t,e){return e.x===t.width-1}isOnLeftBorder(t,e){return 0===e.x}isOnBottomLeftBorder(t,e){return e.y===t.height-1}isOnTopLeftBorder(t,e){return null!=t.excludedSpaces[e.y]?e.x===t.excludedSpaces[e.y]:e.y===t.excludedSpaces.length&&0===e.x}isOnBottomRightBorder(t,e){return null!=t.excludedSpaces[t.height-1-e.y]?t.width-1-e.x===t.excludedSpaces[t.height-1-e.y]:t.height-1-e.y===t.excludedSpaces.length&&e.x===t.width-1}getAllBorders(t){const e=[];return t.forEachCoord((r,s)=>{this.isOnBorder(t,r)&&e.push(r)}),e}isTopCorner(t,e){return this.isOnTopLeftBorder(t,e)&&this.isOnTopRightBorder(t,e)}isTopLeftCorner(t,e){return this.isOnTopLeftBorder(t,e)&&this.isOnLeftBorder(t,e)}isTopRightCorner(t,e){return this.isOnTopRightBorder(t,e)&&this.isOnRightBorder(t,e)}isBottomCorner(t,e){return this.isOnBottomLeftBorder(t,e)&&this.isOnBottomRightBorder(t,e)}isBottomLeftCorner(t,e){return this.isOnBottomLeftBorder(t,e)&&this.isOnLeftBorder(t,e)}isBottomRightCorner(t,e){return this.isOnBottomRightBorder(t,e)&&this.isOnRightBorder(t,e)}}Is.INSTANCE=new Is;class wd{constructor(t,e,r){this.size=t,this.origin=e,this.orientation=r}getCenterAt(t){const e=this.orientation.conversionMatrix;return new S(this.size*(e[0]*t.x+e[1]*t.y)+this.origin.x,this.size*(e[2]*t.x+e[3]*t.y)+this.origin.y)}getCornerOffset(t){const e=2*Math.PI*(this.orientation.startAngle+t)/6;return new S(this.size*Math.cos(e),this.size*Math.sin(e))}getHexaPointsListAt(t){const e=this.getCenterAt(t),r=[];for(let s=0;s<6;s+=1){const i=this.getCornerOffset(s);r.push(new S(e.x+i.x,e.y+i.y))}return r}getHexaPointsAt(t){return this.getHexaPointsListAt(t).map(r=>r.toSVGPoint()).join(" ")}getIsoPoints(t,e){Me.assert(this.orientation===Is.INSTANCE,"HexaLayout.getIsoPoints can only be used with flat orientation");const r=this.getCenterAt(t),s=this.getCornerOffset(0),i=this.getCornerOffset(1),o=this.getCornerOffset(2),c=this.getCornerOffset(3);return[[new S(r.x+c.x,r.y+c.y),new S(r.x+c.x,r.y+c.y+e),new S(r.x+o.x,r.y+o.y+e),new S(r.x+o.x,r.y+o.y)],[new S(r.x+s.x,r.y+s.y),new S(r.x+s.x,r.y+s.y+e),new S(r.x+i.x,r.y+i.y+e),new S(r.x+o.x,r.y+o.y+e),new S(r.x+o.x,r.y+o.y),new S(r.x+i.x,r.y+i.y)],[new S(r.x+c.x,r.y+c.y),new S(r.x+c.x,r.y+c.y+e),new S(r.x+o.x,r.y+o.y+e),new S(r.x+i.x,r.y+i.y+e),new S(r.x+s.x,r.y+s.y+e),new S(r.x+s.x,r.y+s.y),new S(r.x+i.x,r.y+i.y),new S(r.x+o.x,r.y+o.y)]]}}let et=(()=>{class n{}return n.CANNOT_CHOOSE_OPPONENT_PIECE=()=>$localize`You cannot pick a piece of the opponent.`,n.MUST_CLICK_ON_EMPTY_SPACE=()=>$localize`You must click on an empty space.`,n.MUST_CLICK_ON_EMPTY_SQUARE=()=>$localize`You must click on an empty square.`,n.SHOULD_LAND_ON_EMPTY_OR_OPPONENT_SPACE=()=>$localize`Your landing space should be empty or contain a piece of the opponent.`,n.CANNOT_SELF_CAPTURE=()=>$localize`You cannot capture your own pieces.`,n.MUST_CHOOSE_PLAYER_PIECE=()=>$localize`You must pick one of your pieces.`,n.CANNOT_PASS=()=>$localize`You cannot pass your turn.`,n.MUST_LAND_ON_EMPTY_SPACE=()=>$localize`You must drop your piece on an empty space.`,n.MUST_PASS=()=>$localize`You must pass your turn.`,n.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY=()=>$localize`You have selected an empty space, you must select one of your own pieces.`,n.MOVE_CANNOT_BE_STATIC=()=>$localize`You must choose different starting and ending coordinates.`,n.SOMETHING_IN_THE_WAY=()=>$localize`There is a piece between the piece you chose and its landing space.`,n})();class k3{constructor(t,e){this.ruler=t,this.name=e}toString(){return this.name}}class xs extends k3{getBoardValue(t){const e=this.ruler.getGameStatus(t);if(e.isEndGame)return k1.fromWinner(e.winner);{const r=this.getMetrics(t);return k1.from(r[0],r[1])}}}class Br extends _P{constructor(t,e){super(e),this.board=t}getPieceAt(t){if(this.isOnBoard(t))return this.board[t.y][t.x];throw new Error("Accessing coord not on board "+t+".")}tryToGetPieceAt(t){return this.isOnBoard(t)?T.of(this.board[t.y][t.x]):T.empty()}isOnBoard(t){return t.isInRange(this.board[0].length,this.board.length)}getPieceAtXY(t,e){return this.getPieceAt(new S(t,e))}forEachCoord(t){for(const{coord:e,content:r}of this.getCoordsAndContents())t(e,r)}getCoordsAndContents(){const t=[];for(let e=0;e<this.board.length;e++)for(let r=0;r<this.board[e].length;r++){const s=new S(r,e);this.isOnBoard(s)&&t.push({coord:s,content:this.getPieceAt(s)})}return t}getCopiedBoard(){return Xe.copyBiArray(this.board)}toMap(){const t=[];for(let e=0;e<this.board.length;e++)for(let r=0;r<this.board[0].length;r++){const s=new S(r,e);t.push({key:s,value:this.getPieceAt(s)})}return t}[Symbol.iterator](){const t=[];for(const e of this.board)t.push(...e);return t.values()}}class u6 extends Br{static getInitialState(){const t=ke.EMPTY,e=ke.UNREACHABLE,r=ke.ZERO,s=ke.ONE;return new u6([[e,e,e,e,s,s,s,s,s],[e,e,e,s,s,s,s,s,s],[e,e,t,t,s,s,s,t,t],[e,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,e],[t,t,r,r,r,t,t,e,e],[r,r,r,r,r,r,e,e,e],[r,r,r,r,r,e,e,e,e]],0)}isInBoard(t){return t.isInRange(9,9)&&this.getPieceAt(t)!==ke.UNREACHABLE}isPiece(t){return this.getPieceAt(t).isPlayer()}getScores(){const t=[14,14];for(let e=0;e<9;e++)for(let r=0;r<9;r++)this.getPieceAtXY(r,e)===ke.ZERO&&(t[1]=t[1]-1),this.getPieceAtXY(r,e)===ke.ONE&&(t[0]=t[0]-1);return t}}class Ks extends Fi{constructor(t,e){super(),this.coord=new S(t,e)}static getEncoder(t){return Nt.tuple([S.encoder],e=>[e.coord],e=>t(e[0]))}static getFallibleEncoder(t){return Ks.getEncoder(e=>t(e).get())}equals(t){return this===t||this.coord.equals(t.coord)}}class Bi extends Ks{constructor(t,e,r){if(super(t.x,t.y),this.dir=e,this.lastPiece=r,t.isNotInRange(9,9))throw new Error("Coord "+t.toString()+" out of range, invalid move!")}static fromSingleCoord(t,e){try{return _e.success(new Bi(t,e,T.empty()))}catch(r){return _e.failure(r.message)}}static fromDoubleCoord(t,e,r){const s=[t,e];Xe.sortByDescending(s,Bi.sortCoord);const i=s[1].getDirectionToward(s[0]).get(),o=Re.factory.fromDelta(i.x,i.y);if(o.isFailure())return _e.failure("Invalid direction");const c=o.get();return s[1].getDistance(s[0])>2?_e.failure("Distance between first coord and last coord is too big"):c.equals(r)?Bi.fromSingleCoord(s[1],r):c.getOpposite().equals(r)?Bi.fromSingleCoord(s[0],r):_e.success(new Bi(s[1],r,T.of(s[0])))}static sortCoord(t){return 9*t.y+t.x}toString(){return this.isSingleCoord()?"AbaloneMove("+this.coord.x+", "+this.coord.y+", "+this.dir.toString()+")":"AbaloneMove("+this.coord.toString()+" > "+this.lastPiece.get().toString()+", "+this.dir.toString()+")"}isSingleCoord(){return this.lastPiece.isAbsent()}equals(t){return t.coord.equals(this.coord)&&t.dir.equals(this.dir)&&t.lastPiece.equals(this.lastPiece)}}Bi.encoder=Nt.tuple([S.encoder,Re.encoder,T.getEncoder(S.encoder)],n=>[n.coord,n.dir,n.lastPiece],n=>new Bi(n[0],n[1],n[2]));let a8=(()=>{class n{}return n.CANNOT_MOVE_MORE_THAN_THREE_PIECES=()=>$localize`You cannot move more than 3 of your pieces!`,n.NOT_ENOUGH_PIECE_TO_PUSH=()=>$localize`You don't have enough pieces to push that group!`,n.CANNOT_PUSH_YOUR_OWN_PIECES=()=>$localize`You cannot push this piece because it is blocked by one of yours!`,n.MUST_ONLY_TRANSLATE_YOUR_PIECES=()=>$localize`This line contains pieces of your opponent or empty spaces, which is forbidden.`,n.TRANSLATION_IMPOSSIBLE=()=>$localize`This move is impossible, some landing spaces are occupied.`,n.LINE_AND_COORD_NOT_ALIGNED=()=>$localize`This space is not aligned with the current line.`,n})();class z4 extends L1{static isLegal(t,e){const r=this.getFirstPieceValidity(t,e);return r.isFailure()?r.toOtherFallible():t.isSingleCoord()?z4.isLegalPush(t,e):z4.isLegalSideStep(t,e)}static getFirstPieceValidity(t,e){const r=e.getPieceAt(t.coord);return!1===e.isPiece(t.coord)?R.failure(et.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):r===ke.ofPlayer(e.getCurrentOpponent())?R.failure(et.CANNOT_CHOOSE_OPPONENT_PIECE()):R.SUCCESS}static isLegalPush(t,e){let r=1,s=t.coord.getNext(t.dir);const i=ke.ofPlayer(e.getCurrentPlayer()),o=ke.EMPTY,c=e.getCopiedBoard();for(c[t.coord.y][t.coord.x]=o;r<=3&&e.isOnBoard(s)&&e.getPieceAt(s)===i;)r++,s=s.getNext(t.dir);return r>3?_e.failure(a8.CANNOT_MOVE_MORE_THAN_THREE_PIECES()):!1===e.isInBoard(s)||(c[s.y][s.x]=i,e.getPieceAt(s)===o)?_e.success(c):z4.isLegalRealPush(s,t,e,r,c)}static isLegalRealPush(t,e,r,s,i){let o=0;const c=ke.ofPlayer(r.getCurrentOpponent()),u=ke.ofPlayer(r.getCurrentPlayer());for(;o<s&&r.isOnBoard(t)&&r.getPieceAt(t)===c;)o++,t=t.getNext(e.dir);return o>=s?_e.failure(a8.NOT_ENOUGH_PIECE_TO_PUSH()):t.isInRange(9,9)&&(r.getPieceAt(t)===ke.EMPTY&&(i[t.y][t.x]=c),r.getPieceAt(t)===u)?_e.failure(a8.CANNOT_PUSH_YOUR_OWN_PIECES()):_e.success(i)}static isLegalSideStep(t,e){let r=t.lastPiece.get();const s=t.coord.getDirectionToward(r).get();r=r.getNext(s);let i=t.coord;const o=ke.ofPlayer(e.getCurrentPlayer()),c=e.getCopiedBoard();for(;!1===i.equals(r)&&i.isInRange(9,9);){if(e.getPieceAt(i)!==o)return _e.failure(a8.MUST_ONLY_TRANSLATE_YOUR_PIECES());const u=i.getNext(t.dir);if(c[i.y][i.x]=ke.EMPTY,u.isInRange(9,9)){if(e.isPiece(u))return _e.failure(a8.TRANSLATION_IMPOSSIBLE());e.getPieceAt(u)===ke.EMPTY&&(c[u.y][u.x]=o)}i=i.getNext(s)}return _e.success(c)}static getGameStatus(t){const e=t.gameState.getScores();return e[0]>5?xe.ZERO_WON:e[1]>5?xe.ONE_WON:xe.ONGOING}applyLegalMove(t,e,r){return new u6(r,e.turn+1)}isLegal(t,e){return z4.isLegal(t,e)}getGameStatus(t){return z4.getGameStatus(t)}}class t4t extends xs{getListMoves(t){const e=[],r=t.gameState,s=r.getCurrentPlayer();for(let i=0;i<9;i++)for(let o=0;o<9;o++){const c=new S(o,i);if(!1!==r.getPieceAt(c).is(s))for(const u of Re.factory.all){const d=Bi.fromSingleCoord(c,u).get();if(this.isAcceptablePush(d,r)){e.push(d);for(const g of Re.factory.all)for(let m=1;m<=2&&!g.equals(u);m++){const y=c.getNext(g,m);if(!y.isInRange(9,9))break;{const b=Bi.fromDoubleCoord(c,y,u).get();z4.isLegal(b,r).isSuccess()&&e.push(b)}}}}}return new zt(e).toList()}isAcceptablePush(t,e){const r=e.getScores(),s=z4.isLegal(t,e);if(s.isSuccess()){const i=e.getCurrentOpponent().value;return!(new u6(s.get(),e.turn+1).getScores()[i]>r[i])}return!1}getMetrics(t){return t.gameState.getScores()}}const An=ke.EMPTY,Xs=ke.UNREACHABLE,Rc=ke.ZERO,bd=ke.ONE;class qce extends $1{constructor(){super(...arguments),this.tutorial=[ie.informational($localize`Initial board and object of the game`,$localize`At Abalone, the goal of the game is to be the first player to push 6 opponent's pieces out of the board. Let us see how!`,u6.getInitialState()),ie.anyMove($localize`Moving a piece`,$localize`At each turn, move one, two, or three pieces either along their line, or on their side.
        For your moves you can therefore choose between up to 6 directions.
        The pieces you move must be aligned and consecutive, and the move should land on an empty space (except to push, we will see that later).
        To make a move, click on one of your pieces, then click on an arrow to choose the move direction.<br/><br/>
        You're playing Dark, make any move!`,u6.getInitialState(),Bi.fromSingleCoord(new S(2,6),Re.UP).get(),$localize`Congratulations!`),ie.fromMove($localize`Pushing`,$localize`To push one opponent piece, you must move at least two of your pieces.
        To push two opponent pieces, you must move three of your pieces.
        If one of your pieces is in the way, it will be impossible to push.
        You cannot move more than three pieces.<br/><br/>
        Only one push towards the right is possible here, find it. (You're playing Dark).`,new u6([[Xs,Xs,Xs,Xs,An,Rc,Rc,bd,bd],[Xs,Xs,Xs,An,An,An,An,An,An],[Xs,Xs,An,Rc,Rc,Rc,bd,Rc,An],[Xs,An,An,An,An,An,An,An,An],[An,An,An,An,Rc,Rc,Rc,bd,bd],[An,An,An,An,An,An,An,An,Xs],[An,An,An,An,Rc,bd,An,Xs,Xs],[An,An,An,Rc,An,An,Xs,Xs,Xs],[An,An,Rc,An,An,Xs,Xs,Xs,Xs]],0),[Bi.fromSingleCoord(new S(4,4),Re.RIGHT).get()],$localize`Congratulations! You know everything you need to start a game!`,$localize`Failed. Try again.`)]}}function n4t(n,t){if(1&n){const e=Oe();F(),O(0,"circle",6),ee("click",function(){ue(e);const s=C(2).index,i=C().index;return ce(C().onPieceClick(s,i))}),A()}if(2&n){const e=C(2).index,r=C().index,s=C();De("id","piece_",e,"_",r,""),w("ngClass",s.getPieceClasses(e,r)),z("cx",s.getCenterAtXY(e,r).x)("cy",s.getCenterAtXY(e,r).y)("r",.5*s.SPACE_SIZE)}}function r4t(n,t){if(1&n){const e=Oe();F(),O(0,"g")(1,"polygon",4),ee("click",function(){ue(e);const s=C().index,i=C().index;return ce(C().onSpaceClick(s,i))}),A(),x(2,n4t,1,6,"circle",5),A()}if(2&n){const e=C(),r=e.index,s=e.$implicit,i=C().index,o=C();P(1),De("id","space_",r,"_",i,""),w("ngClass",o.getSquareClasses(r,i)),z("points",o.getHexaPointsAtXY(r,i)),P(1),w("ngIf",o.isPiece(s))}}function s4t(n,t){if(1&n&&(F(),O(0,"g"),x(1,r4t,3,5,"g",3),A()),2&n){const e=t.$implicit,r=C(2);P(1),w("ngIf",r.isBoard(e))}}function i4t(n,t){if(1&n&&(F(),O(0,"g"),x(1,s4t,2,1,"g",1),A()),2&n){const e=t.$implicit;P(1),w("ngForOf",e)}}function o4t(n,t){1&n&&(F(),O(0,"marker",7),X(1,"polygon",8),A()),2&n&&y1("id","arrowhead_",t.$implicit.dir.toString(),"")}function a4t(n,t){if(1&n){const e=Oe();F(),O(0,"g"),X(1,"line",9),O(2,"line",10),ee("click",function(){const i=ue(e).$implicit;return ce(C().chooseDirection(i.dir))}),A(),O(3,"polygon",11),ee("click",function(){const i=ue(e).$implicit;return ce(C().chooseDirection(i.dir))}),A()()}if(2&n){const e=t.$implicit;P(1),y1("id","line_start_",e.dir.toString(),""),z("x1",e.startCenter.x)("y1",e.startCenter.y)("x2",e.middle.x)("y2",e.middle.y),P(1),y1("id","line_end_",e.dir.toString(),""),z("x1",e.middle.x)("y1",e.middle.y)("x2",e.landingCenter.x)("y2",e.landingCenter.y),P(1),y1("id","direction_",e.dir.toString(),""),z("transform",e.transformation)}}class c4t{constructor(t,e,r,s,i,o){this.startCenter=t,this.middle=e,this.landingCenter=r,this.landing=s,this.dir=i,this.transformation=o}}let l4t=(()=>{class n extends Td{constructor(e){super(e),this.moveds=[],this.directions=[],this.selecteds=[],this.rules=new z4(u6),this.availableMinimaxes=[new t4t(this.rules,"Dummy")],this.encoder=Bi.encoder,this.tutorial=(new qce).tutorial,this.scores=T.of([0,0]),this.SPACE_SIZE=30,this.hexaLayout=new wd(this.SPACE_SIZE,new S(-8*this.SPACE_SIZE,2*this.SPACE_SIZE),yP.INSTANCE),this.updateBoard()}updateBoard(){this.cancelMoveAttempt(),this.hidePreviousMove(),this.hexaBoard=this.getState().getCopiedBoard(),this.scores=T.of(this.getState().getScores())}hidePreviousMove(){this.moveds=[]}cancelMoveAttempt(){this.directions=[],this.selecteds=[]}showLastMove(e){e.isSingleCoord()?this.showPushingMove(e):this.showSideStepMove(e)}showPushingMove(e){const r=this.getPreviousState();let s=e.coord;for(this.moveds=[s],s=s.getNext(e.dir);s.isInRange(9,9)&&r.isPiece(s);)this.moveds.push(s),s=s.getNext(e.dir);s.isInRange(9,9)&&this.moveds.push(s)}showSideStepMove(e){let r=e.lastPiece.get();const s=e.coord.getDirectionToward(r).get();r=r.getNext(s);let i=e.coord;for(;!1===i.equals(r);)this.moveds.push(i),this.moveds.push(i.getNext(e.dir)),i=i.getNext(s)}onPieceClick(e,r){var s=this;return I(function*(){const i=s.canUserPlay("#piece_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());const o=s.getState().getCurrentOpponent();return s.hexaBoard[r][e].is(o)?s.opponentClick(e,r):0===s.selecteds.length?s.firstClick(e,r):1===s.selecteds.length?s.secondClick(e,r):s.thirdClick(e,r)})()}opponentClick(e,r){var s=this;return I(function*(){return(yield s.tryChoosingDirection(e,r)).isSuccess()?R.SUCCESS:s.cancelMove(et.CANNOT_CHOOSE_OPPONENT_PIECE())})()}firstClick(e,r){var s=this;return I(function*(){return s.selecteds=[new S(e,r)],s.showPossibleDirections(),R.SUCCESS})()}showPossibleDirections(){this.directions=[],this.showDirection(1===this.selecteds.length)}showDirection(e){const r=this.getState(),s=ke.ofPlayer(r.getCurrentPlayer()),i=this.selecteds[0],o=this.selecteds[this.selecteds.length-1];for(const c of Re.factory.all){let d,u=i.getNext(c,1);if(r.isOnBoard(u)&&r.getPieceAt(u)===s){if(e)continue;if(u=o.getNext(c,1),r.isOnBoard(u)&&r.getPieceAt(u)===s)continue}if(d=e?Bi.fromSingleCoord(i,c).get():Bi.fromDoubleCoord(i,o,c).get(),this.rules.isLegal(d,r).isSuccess()){const m=this.getCenterAt(i),y=this.getCenterAt(u),b=this.getMiddleOfArrow(c,u,y),k=y.x+" "+y.y,$=Re.getAngle(c)+150,te=new c4t(m,b,y,u,c,"rotate("+$+" "+k+") translate("+k+")");this.directions.push(te)}}}getMiddleOfArrow(e,r,s){const i=r.getPrevious(e),o=this.getCenterAt(i);return new S(o.x+(s.x-o.x)/2,o.y+(s.y-o.y)/2)}isBoard(e){return e!==ke.UNREACHABLE}isPiece(e){return e!==ke.EMPTY}secondClick(e,r){var s=this;return I(function*(){const i=s.selecteds[0],o=new S(e,r);if(o.equals(i))return s.cancelMoveAttempt(),R.SUCCESS;if(!1===o.isHexagonallyAlignedWith(i))return s.cancelMoveAttempt(),s.firstClick(e,r);const c=o.getDistance(i);if(c>2)return s.cancelMove(a8.CANNOT_MOVE_MORE_THAN_THREE_PIECES());const u=i.getDirectionToward(o).get();s.selecteds=[i];for(let d=0;d<c;d++)s.selecteds.push(i.getNext(u,d+1));if(3===s.selecteds.length){const d=s.selecteds[1],g=s.getState().getCurrentPlayer();if(!1===s.hexaBoard[d.y][d.x].is(g))return s.cancelMoveAttempt(),s.firstClick(e,r)}return s.showPossibleDirections(),R.SUCCESS})()}thirdClick(e,r){var s=this;return I(function*(){const i=new S(e,r),o=s.selecteds[0];if(i.equals(o))return s.deselectExtremity(!0);const c=s.selecteds[s.selecteds.length-1];return i.equals(c)?s.deselectExtremity(!1):3===s.selecteds.length&&i.equals(s.selecteds[1])?(s.cancelMoveAttempt(),R.SUCCESS):s.tryExtension(i,o,c)})()}tryExtension(e,r,s){var i=this;return I(function*(){const o=Ne.factory.fromMove(r,e);if(o.isSuccess()){const u=Ne.factory.fromMove(s,e);if(o.equals(u)){const d=r.getDistance(e),g=s.getDistance(e);return 2===Math.max(d,g)?(i.selecteds.push(e),Xe.sortByDescending(i.selecteds,Bi.sortCoord),i.showPossibleDirections(),R.SUCCESS):i.cancelMove(a8.CANNOT_MOVE_MORE_THAN_THREE_PIECES())}}const c=i.cancelMove(a8.LINE_AND_COORD_NOT_ALIGNED());return yield i.firstClick(e.x,e.y),c})()}deselectExtremity(e){var r=this;return I(function*(){return r.selecteds=r.selecteds.slice(e?1:0,e?void 0:-1),r.showPossibleDirections(),R.SUCCESS})()}chooseDirection(e){var r=this;return I(function*(){const s=r.canUserPlay("#direction_"+e.toString());return s.isFailure()?r.cancelMove(s.getReason()):r._chooseDirection(e)})()}_chooseDirection(e){var r=this;return I(function*(){const s=r.getState();let i;const o=r.selecteds[0];return i=1===r.selecteds.length?Bi.fromSingleCoord(o,e).get():Bi.fromDoubleCoord(o,r.selecteds[r.selecteds.length-1],e).get(),r.chooseMove(i,s,r.scores.get())})()}onSpaceClick(e,r){var s=this;return I(function*(){const i=s.canUserPlay("#space_"+e+"_"+r);return i.isFailure()?s.cancelMove(i.getReason()):s.tryChoosingDirection(e,r)})()}tryChoosingDirection(e,r){var s=this;return I(function*(){const i=new S(e,r);for(const o of s.directions)if(o.landing.equals(i))return s._chooseDirection(o.dir);return R.failure("not a direction")})()}getSquareClasses(e,r){const s=new S(e,r),i=[];return this.moveds.some(o=>o.equals(s))&&i.push("moved-fill"),i}getPieceClasses(e,r){const s=new S(e,r),i=B.of(this.hexaBoard[r][e].value),o=[this.getPlayerClass(i)];return this.selecteds.some(c=>c.equals(s))&&o.push("selected-stroke"),o}}return n.\u0275fac=function(e){return new(e||n)(J(En))},n.\u0275cmp=dt({type:n,selectors:[["app-abalone"]],features:[l],decls:5,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-165 0 470 500","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto",3,"id",4,"ngFor","ngForOf"],[4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass","click"],["class","base",3,"id","ngClass","click",4,"ngIf"],[1,"base",3,"id","ngClass","click"],["markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto",3,"id"],["points","0 0, 10 3.5, 0 7"],[1,"arrow",3,"id"],[1,"arrow",3,"id","click"],["points","-10 -5, 10 -5, 0 15, -10 -5",1,"arrow",3,"id","click"]],template:function(e,r){1&e&&(F(),O(0,"svg",0),x(1,i4t,2,1,"g",1),O(2,"defs"),x(3,o4t,2,1,"marker",2),A(),x(4,a4t,4,12,"g",1),A()),2&e&&(P(1),w("ngForOf",r.hexaBoard),P(2),w("ngForOf",r.directions),P(1),w("ngForOf",r.directions))},dependencies:[fn,On,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class u4t extends xs{getListMoves(t){const e=t.gameState;return cr.ALL_MOVES.filter(function r(s){return l6.get().isLegal(s,e).isSuccess()})}getMetrics(t){const e=t.gameState.board[3].getDominatingPlayer(),r=[0,0];return e.isPlayer()&&(r[e.value]=1),r}}function f4t(n,t){if(1&n&&(F(),X(0,"circle",5)),2&n){const e=t.$implicit,r=C();z("cx",r.getRemainingPieceCx(e))("cy",r.PIECE_RADIUS)("r",r.PIECE_RADIUS-5)}}function d4t(n,t){if(1&n&&(F(),X(0,"circle",6)),2&n){const e=t.$implicit,r=C();z("cx",r.BOARD_WIDTH-r.getRemainingPieceCx(e))("cy",r.BOARD_HEIGHT-r.PIECE_RADIUS)("r",r.PIECE_RADIUS-5)}}function h4t(n,t){if(1&n){const e=Oe();F(),O(0,"polygon",9),ee("click",function(){ue(e);const s=C().index,i=C();return ce(i.onArrowClick(s,i.PlayerOrNone.ZERO))}),A()}if(2&n){const e=C().index,r=C();y1("id","dropArrow_zero_",e,""),w("ngClass",r.getArrowClasses(e,r.PlayerOrNone.ZERO)),z("points",r.ARROW_COORD)("transform","translate("+r.SPACE_SIZE/2+" "+-r.SPACE_SIZE/2+")")}}function p4t(n,t){if(1&n){const e=Oe();F(),O(0,"polygon",9),ee("click",function(){ue(e);const s=C().index,i=C();return ce(i.onArrowClick(s,i.PlayerOrNone.ONE))}),A()}if(2&n){const e=C().index,r=C();y1("id","dropArrow_one_",e,""),w("ngClass",r.getArrowClasses(e,r.PlayerOrNone.ONE)),z("points",r.ARROW_COORD)("transform","translate(0 "+-r.SPACE_SIZE/2+")")}}function g4t(n,t){if(1&n){const e=Oe();F(),pn(0),O(1,"circle",10),ee("click",function(){ue(e);const s=C().index;return ce(C().onSquareClick(s))}),A(),gn()}if(2&n){const e=t.$implicit,r=C(),s=r.index,i=r.$implicit,o=C();P(1),j2("id","square_",s,"_piece_",e,"_out_of_",i.count(o.PlayerOrNone.NONE),""),w("ngClass",o.getPieceClasses(s,e,i)),z("cx",o.getCircleCenter(s,e,i).x)("cy",o.getCircleCenter(s,e,i).y)}}function m4t(n,t){if(1&n){const e=Oe();F(),O(0,"g"),x(1,h4t,1,4,"polygon",7),x(2,p4t,1,4,"polygon",7),O(3,"rect",8),ee("click",function(){const i=ue(e).index;return ce(C().onSquareClick(i))}),A(),x(4,g4t,2,6,"ng-container",4),A()}if(2&n){const e=t.$implicit,r=t.index,s=C();z("transform",s.getBlockTransform(r)),P(1),w("ngIf",s.canDisplayArrow(r,s.PlayerOrNone.ZERO)),P(1),w("ngIf",s.canDisplayArrow(r,s.PlayerOrNone.ONE)),P(1),y1("id","square_",r,""),w("ngClass",s.getSquareClasses(r)),z("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),P(1),w("ngForOf",s.ArrayUtils.range(e.count(s.PlayerOrNone.NONE)))}}let _4t=(()=>{class n extends o8{constructor(e){super(e),this.PlayerOrNone=he,this.BOARD_WIDTH=4*this.SPACE_SIZE,this.BOARD_HEIGHT=4.5*this.SPACE_SIZE,this.ARROW_COORD=n.getArrowCoord(),this.PIECES_PER_PLAYER=i8.PIECES_PER_PLAYER,this.selectedPiece=T.empty(),this.leftPiece=T.empty(),this.droppedPiece=T.empty(),this.displayableArrow=[],this.rules=l6.get(),this.hasAsymmetricBoard=!0,this.availableMinimaxes=[new u4t(this.rules,"ApagosDummyMinimax")],this.encoder=cr.encoder,this.tutorial=(new Uce).tutorial,this.PIECE_RADIUS=2*this.SPACE_SIZE/(this.PIECES_PER_PLAYER+.5),this.updateBoard()}static getArrowCoord(){return"12.5,0 37.5,0 37.5,25 50,25 25,50 0,25 12.5,25"}cancelMoveAttempt(){this.selectedPiece=T.empty(),this.showPossibleDrops()}updateBoard(){const e=this.getState();this.board=e.board,this.remainingZero=e.remaining.get(B.ZERO).get(),this.remainingOne=e.remaining.get(B.ONE).get(),this.hideLastMove(),this.showPossibleDrops()}hideLastMove(){this.movedSquare=[],this.droppedPiece=T.empty(),this.leftPiece=T.empty(),this.selectedPiece=T.empty()}showLastMove(e){e.isDrop()?this.showLastDrop(e):this.showLastTransfer(e)}showLastDrop(e){const r=e.piece.get();let s=e.landing.x;this.movedSquare=[s],3!==e.landing.x&&(s+=1,this.movedSquare.push(s));const o=this.getLowestPlayerPiece(this.board[s],r);this.droppedPiece=T.of({square:s,piece:o})}getLowestPlayerPiece(e,r){const s=e.count(r);return r===B.ZERO?s-1:e.count(he.NONE)-s}showLastTransfer(e){const r=this.getPreviousState(),s=r.getCurrentPlayer(),i=e.starting.get().x,c=this.getLowestPlayerPiece(r.board[i],s);this.leftPiece=T.of({square:i,piece:c});const u=e.landing.x,g=this.getLowestPlayerPiece(this.board[u],s);this.droppedPiece=T.of({square:u,piece:g})}showPossibleDrops(){this.displayableArrow=[];const e=this.getState();for(let r=0;r<4;r++)!1===e.board[r].isFull()&&(e.remaining.get(B.ZERO).get()>0&&this.displayableArrow.push({x:r,player:B.ZERO}),e.remaining.get(B.ONE).get()>0&&this.displayableArrow.push({x:r,player:B.ONE}))}getCircleCenter(e,r,s){const i=this.SPACE_SIZE/2,o=this.SPACE_SIZE/2;if(1===s.count(he.NONE))return new S(i,o);const c=s.count(he.NONE),u=2*r*Math.PI/c-Math.PI/2,d=.3*this.SPACE_SIZE,g=d*Math.cos(u),m=d*Math.sin(u);return new S(i+g,o+m)}canDisplayArrow(e,r){return this.displayableArrow.some(s=>s.x===e&&s.player.equals(r))}getArrowClasses(e,r){return[this.getPlayerClass(r)]}getBlockTransform(e){return"translate("+e*this.SPACE_SIZE+", "+((3-e)*this.SPACE_SIZE+.5*this.SPACE_SIZE)+")"}getSquareClasses(e){const r=["base"];return this.selectedPiece.isPresent()&&this.selectedPiece.get().square===e?r.push("selected-stroke"):this.movedSquare.includes(e)&&r.push("last-move-stroke"),r}onArrowClick(e,r){var s=this;return I(function*(){const o=s.canUserPlay("#dropArrow_"+(r===B.ZERO?"zero":"one")+"_"+e);if(o.isFailure())return s.cancelMove(o.getReason());const c=dn.from(e);let u;if(s.selectedPiece.isPresent()){const g=s.selectedPiece.get().square;u=cr.transfer(dn.from(g),c).get()}else u=cr.drop(c,r);const d=s.getState();return s.chooseMove(u,d)})()}getPieceClasses(e,r,s){const i={square:e,piece:r},o=[];let c=s.count(B.ZERO),u=s.count(B.ONE);if(this.selectedPiece.equalsValue(i))o.push("selected-stroke");else if(this.droppedPiece.equalsValue(i))o.push("last-move-stroke");else if(this.leftPiece.isPresent()&&this.leftPiece.get().square===e){if(this.leftPiece.get().piece===r)return o.push("captured-stroke"),o;this.getState().getCurrentOpponent()===B.ZERO?c++:u++}const d=s.count(he.NONE)-(u+c),g=this.getPieceColor(r,c,d);return""!==g&&o.push(g),o}getPieceColor(e,r,s){return e<r?"player0-fill":e>=r+s?"player1-fill":""}onSquareClick(e){var r=this;return I(function*(){const s=r.canUserPlay("#square_"+e);if(s.isFailure())return r.cancelMove(s.getReason());if(r.selectedPiece.isPresent()&&r.selectedPiece.get().square===e)return r.cancelMoveAttempt(),R.SUCCESS;const i=r.getState().getCurrentPlayer(),o=r.board[e];return o.count(i)<=0?r.cancelMove(Pd.NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE()):(r.selectedPiece=T.of({square:e,piece:r.getLowestPlayerPiece(o,i)}),0===r.showAndGetPossibleTranfers().length?r.cancelMove(Pd.NO_POSSIBLE_TRANSFER_REMAINS()):R.SUCCESS)})()}showAndGetPossibleTranfers(){this.displayableArrow=[];let e=this.selectedPiece.get().square-1;const r=this.getState().getCurrentPlayer();for(;0<=e;)!1===this.board[e].isFull()&&this.displayableArrow.push({x:e,player:r}),e--;return this.displayableArrow}getRemainingPieceCx(e){return(e+.5)*this.PIECE_RADIUS*1.5}}return n.\u0275fac=function(e){return new(e||n)(J(En))},n.\u0275cmp=dt({type:n,selectors:[["app-apagos"]],features:[l],decls:6,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["class","base mid-stroke player1-fill",4,"ngFor","ngForOf"],["class","base mid-stroke player0-fill",4,"ngFor","ngForOf"],["id","board"],[4,"ngFor","ngForOf"],[1,"base","mid-stroke","player1-fill"],[1,"base","mid-stroke","player0-fill"],["class","base mid-stroke",3,"id","ngClass","click",4,"ngIf"],["x","0","y","0",1,"base","mid-stroke",3,"id","ngClass","click"],[1,"base","mid-stroke",3,"id","ngClass","click"],["r","10",1,"base","mid-stroke",3,"id","ngClass","click"]],template:function(e,r){1&e&&(F(),O(0,"svg",0)(1,"g"),x(2,f4t,1,3,"circle",1),x(3,d4t,1,3,"circle",2),A(),O(4,"g",3),x(5,m4t,5,8,"g",4),A()()),2&e&&(z("viewBox",-r.STROKE_WIDTH/2+" "+-r.STROKE_WIDTH/2+" "+(r.BOARD_WIDTH+r.STROKE_WIDTH)+" "+(r.BOARD_HEIGHT+r.STROKE_WIDTH)),P(1),z("transform","rotate("+180*r.role.value+" "+r.BOARD_WIDTH/2+" "+r.BOARD_HEIGHT/2+")"),P(1),w("ngForOf",r.ArrayUtils.range(r.remainingOne)),P(1),w("ngForOf",r.ArrayUtils.range(r.remainingZero)),P(2),w("ngForOf",r.board))},dependencies:[fn,On,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})(),ko=(()=>{class n extends o8{getViewBox(){return-.5*this.STROKE_WIDTH+" "+-.5*this.STROKE_WIDTH+" "+(this.board.length*this.SPACE_SIZE+this.STROKE_WIDTH)+" "+(this.board[0].length*this.SPACE_SIZE+this.STROKE_WIDTH)}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=Mr(n)))(r||n)}}(),n.\u0275cmp=dt({type:n,selectors:[["ng-component"]],features:[l],decls:0,vars:0,template:function(e,r){},encapsulation:2}),n})();class to extends Br{constructor(t,e,r){super(t,e),this.captured=r}static getInitialState(){const t=Xe.createTable(6,2,4);return new to(t,0,[0,0])}getCapturedCopy(){return[this.captured[0],this.captured[1]]}}let bH=(()=>{class n{}return n.CANNOT_DISTRIBUTE_FROM_OPPONENT_HOME=()=>$localize`You cannot distribute from the opponent's home.`,n.MUST_CHOOSE_NON_EMPTY_HOUSE=()=>$localize`You should choose a non-empty house to distribute.`,n.SHOULD_DISTRIBUTE=()=>$localize`You should distribute but you do not.`,n})(),f6=(()=>{class n extends L1{applyLegalMove(e,r,s){Q(n.VERBOSE,{called:"AwaleRules.applyLegalMove",move:e,state:r});const i=e.x,o=r.getCurrentPlayer(),u=r.getCurrentOpponent().value,d=r.getCopiedBoard(),g=n.distribute(i,u,d),m=g[g.length-1];return m.y===u?new to(d,r.turn+1,r.captured):this.applyPotentialCapture(o,m,d,r)}applyPotentialCapture(e,r,s,i){const o=i.getCurrentOpponent(),c=[i.captured[0],i.captured[1]],u=n.captureIfLegal(r.x,r.y,e,s);c[e.value]+=u.capturedSum;const d=u.resultingBoard;if(n.mustMansoon(e,d)){const g=n.mansoon(o,d);return c[o.value]+=g.capturedSum,new to(g.resultingBoard,i.turn+1,c)}return new to(d,i.turn+1,c)}static mustMansoon(e,r){return n.isStarving(e,r)&&!1===n.canDistribute(e.getOpponent(),r)}static mansoon(e,r){const s=Xe.copyBiArray(r);let i=0;const o=[[0,0,0,0,0,0],[0,0,0,0,0,0]];let c=0;const u=e.getOpponent().value;do{i+=s[u][c],o[u][c]=s[u][c],s[u][c]=0,c++}while(c<6);return{capturedSum:i,captureMap:o,resultingBoard:s}}static isLegal(e,r){const s=r.getCurrentOpponent(),i=s.value,o=e.x;if(0===r.getPieceAtXY(o,i))return R.failure(bH.MUST_CHOOSE_NON_EMPTY_HOUSE());const c=n.isStarving(s,r.board),u=!1===n.doesDistribute(o,i,r.board);return c&&u?R.failure(bH.SHOULD_DISTRIBUTE()):R.SUCCESS}isLegal(e,r){return n.isLegal(e,r)}static doesDistribute(e,r,s){return 0===r?s[r][e]>5-e:s[r][e]>e}static canDistribute(e,r){for(let s=0;s<6;s++)if(n.doesDistribute(s,e.getOpponent().value,r))return!0;return!1}static isStarving(e,r){let s=0;const i=e.getOpponent().value;do{if(r[i][s++]>0)return!1}while(s<6);return!0}static distribute(e,r,s){const i=e,o=r;let c=s[r][e];const u=[];for(s[r][e]=0;c>0;)0===r?5===e?r=1:e++:0===e?r=0:e--,(e!==i||r!==o)&&(s[r][e]+=1,u.push(new S(e,r)),c--);return u}static capture(e,r,s,i){const o=Xe.copyBiArray(i);Pe(r!==s.getOpponent().value,"AwaleRules.capture cannot capture the players house");let u=o[r][e],d=0;const g=[[0,0,0,0,0,0],[0,0,0,0,0,0]];if(u<2||u>3)return{capturedSum:0,captureMap:g,resultingBoard:o};let m=-1,y=-1;s===B.ONE&&(m=1,y=6);do{g[r][e]=u,d+=u,o[r][e]=0,u=o[r][e+=m]}while(e!==y&&(2===u||3===u));return{capturedSum:d,captureMap:g,resultingBoard:o}}static captureIfLegal(e,r,s,i){const o=Xe.copyBiArray(i),c=n.capture(e,r,s,i),u=n.isStarving(s.getOpponent(),c.resultingBoard);return c.capturedSum>0&&u?{capturedSum:0,resultingBoard:o,captureMap:[[0,0,0,0,0,0],[0,0,0,0,0,0]]}:c}static getGameStatus(e){const r=e.gameState;return r.captured[0]>24?xe.ZERO_WON:r.captured[1]>24?xe.ONE_WON:24===r.captured[0]&&24===r.captured[1]?xe.DRAW:xe.ONGOING}getGameStatus(e){return n.getGameStatus(e)}}return n.VERBOSE=!1,n})();class _1 extends Fi{constructor(t){super(),this.x=t}static from(t){switch(t){case 0:return _1.ZERO;case 1:return _1.ONE;case 2:return _1.TWO;case 3:return _1.THREE;case 4:return _1.FOUR;default:return Pe(5===t,"Invalid x for AwaleMove: "+t),_1.FIVE}}equals(t){return t===this||t.x===this.x}toString(){return"AwaleMove("+this.x+")"}}_1.ZERO=new _1(0),_1.ONE=new _1(1),_1.TWO=new _1(2),_1.THREE=new _1(3),_1.FOUR=new _1(4),_1.FIVE=new _1(5),_1.encoder=new class extends Nt{encodeMove(n){return n.x}decodeMove(n){return _1.from(n)}};class v4t extends xs{getListMoves(t){const e=[],r=t.gameState,i=(r.turn+1)%2;let o,c=0;do{0!==r.getPieceAtXY(c,i)&&(o=_1.from(c),f6.isLegal(o,r).isSuccess()&&(o=_1.from(c),e.push(o))),c++}while(c<6);return this.orderMoves(t,e)}orderMoves(t,e){const r=t.gameState.getCurrentPlayer(),s=t.gameState.getCurrentOpponent().value,i=r.value;return Xe.sortByDescending(e,o=>{const c=t.gameState.getCopiedBoard(),u=c[s][o.x],d=f6.distribute(o.x,s,c),g=d[d.length-1];let m,y=0;return g.y===s?(m=0,u<=6&&(y=10)):m=f6.captureIfLegal(g.x,i,r,c).capturedSum,100*m+y-u}),e}getMetrics(t){const e=t.gameState.getCapturedCopy();return[e[0],e[1]]}}class jce extends $1{constructor(){super(...arguments),this.tutorial=[ie.anyMove($localize`Sowing`,$localize`Awal is a game of distribution (sowing) and capture. Its goal is to capture the most seeds.
         Let's see how seeds are sown. The spaces in Awal are called the houses.
         As you're playing Dark, the 6 houses on the bottom are yours.<br/><br>
         Click on any of the bottom houses to sow the seeds it contains: they will be sown clockwise, one seed per house.`,to.getInitialState(),_1.ZERO,$localize`Look at the 4 houses that follow clockwise the one you picked, they now contain 5 seeds.
        This is how seeds are sown:
        one by one from the house next to the one they come from, clockwise.`),ie.anyMove($localize`Big sowing`,$localize`When there are enough seeds to make a full turn, something else happens.<br/><br/>
        You're playing Dark.
        Sow the house that contains 12 seeds.`,new to([[0,0,0,0,0,0],[0,12,0,0,0,0]],0,[0,0]),_1.ONE,$localize`See, the house that you sowed has not been refilled, and the sowing immediately continued to the next house (which therefore contains two seeds).`),ie.fromMove($localize`Simple capture`,$localize`After sowing, if the last seed falls in an opponent's house and if there is now two or three seeds in this house, the player captures these two or three seeds.<br/><br/>You're playing Dark, do a capture!`,new to([[0,1,0,0,1,0],[2,0,0,0,1,0]],0,[0,0]),[_1.ZERO],$localize`Well done! This was a simple capture, now let us see how to make multiple captures.`,$localize`Failed. Try again and sow from the leftmost house.`),ie.fromMove($localize`Multiple captures`,$localize`By sowing from your leftmost house, you will end in the opponent's second leftmost house, which contains now 3, so this will be a capture. But now, the house right before it contains 2, which is also capturable, so, that house will get captured as well!<br/><br/>You're playing Dark, do a capture!`,new to([[2,1,0,0,1,0],[2,0,0,0,1,0]],0,[0,0]),[_1.ZERO],$localize`Nice, you win 3 points from the first house, and 2 from the second!`,$localize`Failed. Try again.`),ie.fromMove($localize`Interrupted capture`,$localize`By clicking on your leftmost house, you end up on the 3rd house, which is capturable.<br/><br/>You're playing Dark, do a capture!`,new to([[1,0,1,0,0,1],[3,0,0,0,1,0]],0,[0,0]),[_1.ZERO],$localize`Notice that because the second house was not capturable, the capture was interrupted and you have not captured the first house.`,$localize`Failed. Try again.`),ie.fromMove($localize`Capture on the other side only`,$localize`You're playing Dark. Try to capture the two leftmost houses of the opponent.`,new to([[2,2,0,0,1,0],[1,3,0,0,0,0]],0,[0,0]),[_1.ONE],$localize`Congratulations! Notice that the capture was interrupted when entering your territory: you cannot capture your own houses!`,$localize`You have only captured one house, try again!`),ie.fromMove($localize`Do not starve`,$localize`You have a very nice capture that seems possible: it seems that you can capture all the opponent's seeds!<br/><br/>
        You're playing Dark. Try it.`,new to([[1,1,1,1,1,0],[5,0,0,1,0,0]],0,[0,0]),[_1.ZERO],$localize`Sadly, you cannot capture here, otherwise the opponent could not play after you.
        When this happens, the move can be made, but no capture takes place!`,$localize`Failed. Try again.`),ie.anyMove($localize`Feeding is mandatory`,$localize`You cannot let another player starve, meaning that if your opponent has no seeds anymore and if you can give them at least one, you have to do it.<br/><br/>You're playing Dark. Give a seed to your opponent!`,new to([[0,0,0,0,0,0],[0,1,2,4,4,5]],0,[0,0]),_1.THREE,$localize`Congratulations! Note that you can choose to give your opponent the least number of seeds if it is better for you.
        It is often a good way to have easy captures!`),ie.anyMove($localize`End of the game`,$localize`A game is won as soon as one player has captured 25 seeds, as that player has more than half of all the seeds.<br/><br/>You're playing Dark, sow the leftmost house.`,new to([[4,4,3,2,1,0],[1,0,0,0,0,0]],0,[0,0]),_1.ZERO,$localize`Also, as soon as on player cannot play, the other player captures all the seeds in its own side.
         Here, it was the first player's turn, and the second player has taken all the remaining seeds.`)]}}function C4t(n,t){if(1&n){const e=Oe();F(),O(0,"text",7),ee("click",function(){ue(e);const s=C().index,i=C().index;return ce(C().onClick(s,i))}),Tt(1),A()}if(2&n){const e=C().index,r=C().index,s=C();De("id","captured_",e,"_",r,""),z("x",65+100*e)("y",81+120*r)("transform",s.getPieceRotation(e,r)),P(1),Z2(" ",-s.captured[r][e]," ")}}function y4t(n,t){if(1&n){const e=Oe();F(),O(0,"g")(1,"circle",4),ee("click",function(){const i=ue(e).index,o=C().index;return ce(C().onClick(i,o))}),A(),O(2,"text",5),ee("click",function(){const i=ue(e).index,o=C().index;return ce(C().onClick(i,o))}),Tt(3),A(),x(4,C4t,2,6,"text",6),A()}if(2&n){const e=t.$implicit,r=t.index,s=C().index,i=C();P(1),De("id","click_",r,"_",s,""),w("ngClass",i.getSpaceClasses(r,s)),z("cx",i.getPieceCx(r))("cy",i.getPieceCy(s)),P(1),De("id","number_",r,"__",s,""),z("x",50+100*r)("y",66+120*s)("transform",i.getPieceRotation(r,s)),P(1),Z2(" ",e," "),P(1),w("ngIf",i.captured[s][r]>0)}}function E4t(n,t){if(1&n&&(F(),O(0,"g"),x(1,y4t,5,12,"g",2),A()),2&n){const e=t.$implicit;P(1),w("ngForOf",e)}}let M4t=(()=>{class n extends ko{constructor(e){super(e),this.last=T.empty(),this.captured=[[0,0,0,0,0,0],[0,0,0,0,0,0]],this.filledCoords=[],this.hasAsymmetricBoard=!0,this.scores=T.of([0,0]),this.rules=new f6(to),this.availableMinimaxes=[new v4t(this.rules,"AwaleMinimax")],this.encoder=_1.encoder,this.tutorial=(new jce).tutorial,this.updateBoard()}updateBoard(){const e=this.getState();this.scores=T.of(e.getCapturedCopy()),this.hidePreviousMove(),this.board=e.getCopiedBoard(),this.last=T.empty()}hidePreviousMove(){this.captured=[[0,0,0,0,0,0],[0,0,0,0,0,0]],this.filledCoords=[]}showLastMove(e){const r=this.getState().getCurrentPlayer().value;this.last=T.of(new S(e.x,r));const s=this.getPreviousState(),i=Xe.copyBiArray(s.board),o=s.getCurrentOpponent().value;this.filledCoords=f6.distribute(e.x,o,i);const c=this.filledCoords[this.filledCoords.length-1];if(c.y!==o){const u=f6.captureIfLegal(c.x,c.y,s.getCurrentPlayer(),i);this.captured=u.captureMap;const d=this.getState().getCurrentPlayer();f6.mustMansoon(d.getOpponent(),u.resultingBoard)&&(this.captured=f6.mansoon(d,u.resultingBoard).captureMap)}}onClick(e,r){var s=this;return I(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());if(r===s.getState().getCurrentPlayer().value)return s.cancelMove(bH.CANNOT_DISTRIBUTE_FROM_OPPONENT_HOME());s.last=T.empty();const o=_1.from(e);return s.chooseMove(o,s.getState())})()}getSpaceClasses(e,r){const s=new S(e,r),i="player"+(r+1)%2+"-fill";return this.captured[r][e]>0?["captured-fill","moved-stroke"]:this.last.equalsValue(s)?["moved-stroke","last-move-stroke",i]:this.filledCoords.some(o=>o.equals(s))?["moved-stroke",i]:[i]}getPieceCx(e){return 50+100*e}getPieceCy(e){return 50+120*e}getPieceRotation(e,r){return"rotate("+180*this.role.value+" "+this.getPieceCx(e)+" "+this.getPieceCy(r)+")"}}return n.\u0275fac=function(e){return new(e||n)(J(En))},n.\u0275cmp=dt({type:n,selectors:[["app-awale-component"]],features:[l],decls:4,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-45 -20 700 260","preserveAspectRatio","xMidYMid meet"],["x","-40","y","-15","ry","115","rx","115","width","680","height","250","fill","blue",1,"base"],[4,"ngFor","ngForOf"],["x1","-40","y1","110","x2","640","y2","110",1,"base"],["r","46",1,"base",3,"id","ngClass","click"],[1,"text-big","text-center",3,"id","click"],["class","text-20 text-center",3,"id","click",4,"ngIf"],[1,"text-20","text-center",3,"id","click"]],template:function(e,r){1&e&&(F(),O(0,"svg",0),X(1,"rect",1),x(2,E4t,2,1,"g",2),X(3,"line",3),A()),2&e&&(z("transform",r.rotation),P(2),w("ngForOf",r.board))},dependencies:[fn,On,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class no extends Fi{constructor(t,e){super(),this.first=t,this.second=e}static getFallibleEncoder(t){return no.getEncoder((e,r)=>t(e,r).get())}static getEncoder(t){return Nt.tuple([S.encoder,S.encoder],e=>[e.first,e.second],e=>t(e[0],e[1]))}getFirst(){return this.first}getSecond(){return this.second}}class c8 extends no{constructor(t,e){if(super(t,e),t.equals(e))throw new Error(et.MOVE_CANNOT_BE_STATIC())}length(){return this.getStart().getDistance(this.getEnd())}getDirection(){return Ne.factory.fromMove(this.getStart(),this.getEnd())}getStart(){return this.getFirst()}getEnd(){return this.getSecond()}}let EP=(()=>{class n{}return n.LANDING_ON_OCCUPIED_SQUARE=()=>$localize`You cannot land on an occupied square.`,n.THRONE_IS_LEFT_FOR_GOOD=()=>$localize`Once you left the central throne, you cannot return to it.`,n.SOLDIERS_CANNOT_SIT_ON_THRONE=()=>$localize`Soldiers cannot sit on the throne.`,n.MOVE_MUST_BE_ORTHOGONAL=()=>$localize`Tafl moves must be orthogonal.`,n})();class OH extends c8{constructor(t,e){if(super(t,e),t.isNotInRange(this.getMaximalDistance(),this.getMaximalDistance()))throw new Error("Starting coord of TaflMove must be on the board, not at "+t.toString()+".");if(e.isNotInRange(this.getMaximalDistance(),this.getMaximalDistance()))throw new Error("Landing coord of TaflMove must be on the board, not at "+e.toString()+".");const r=t.getDirectionToward(e);if(r.isFailure()||r.get().isDiagonal())throw new Error(EP.MOVE_MUST_BE_ORTHOGONAL())}equals(t){return t===this||!1!==t.getStart().equals(this.getStart())&&t.getEnd().equals(this.getEnd())}toString(){return"TaflMove("+this.getStart()+"->"+this.getEnd()+")"}}class Lo extends OH{static of(t,e){return new Lo(t,e)}static from(t,e){try{const r=new Lo(t,e);return _e.success(r)}catch(r){return _e.failure(r.message)}}getMaximalDistance(){return 7}}Lo.encoder=no.getFallibleEncoder(Lo.from);const S4t={CASTLE_IS_LEFT_FOR_GOOD:!0,BORDER_CAN_SURROUND_KING:!1,CENTRAL_THRONE_CAN_SURROUND_KING:!0,KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED:!0,WIDTH:7,INVADER:B.ZERO};class Sn{constructor(t,e){this.owner=t,this.king=e}isKing(){return this.king}getOwner(){return this.owner}}Sn.UNOCCUPIED=new Sn(he.NONE,!1),Sn.PLAYER_ONE_KING=new Sn(he.ONE,!0),Sn.INVADERS=new Sn(he.ZERO,!1),Sn.DEFENDERS=new Sn(he.ONE,!1);class Z1{constructor(t){this.value=t}}Z1.NONE=new Z1("NONE"),Z1.OPPONENT=new Z1("OPPONENT"),Z1.PLAYER=new Z1("PLAYER");class AH extends Br{isCentralThrone(t){return t.equals(this.getCentralThrone())}getCentralThrone(){const t=(this.board.length-1)/2;return new S(t,t)}getRelativeOwner(t,e){const r=this.getAbsoluteOwner(e);let s;return s=r===he.NONE?Z1.NONE:t===r?Z1.PLAYER:Z1.OPPONENT,s}getAbsoluteOwner(t){return this.getPieceAt(t).getOwner()}}class L3 extends AH{static getInitialState(){const t=Sn.UNOCCUPIED,e=Sn.INVADERS,r=Sn.DEFENDERS;return new L3([[t,t,t,e,t,t,t],[t,t,t,e,t,t,t],[t,t,t,r,t,t,t],[e,e,r,Sn.PLAYER_ONE_KING,r,e,e],[t,t,t,r,t,t,t],[t,t,t,e,t,t,t],[t,t,t,e,t,t,t]],0)}from(t,e){return new L3(t,e)}}let NH=(()=>{class n extends L1{constructor(e,r,s){super(e),this.config=r,this.generateMove=s}isLegal(e,r){Q(n.VERBOSE,{tablutRules_isLegal:{move:e,state:r}});const s=r.getCurrentPlayer(),i=this.getMoveValidity(s,e,r);return i.isFailure()?R.failure(i.getReason()):R.SUCCESS}getMoveValidity(e,r,s){const i=s.getRelativeOwner(e,r.getStart());if(i===Z1.NONE)return R.failure(et.MUST_CHOOSE_PLAYER_PIECE());if(i===Z1.OPPONENT)return R.failure(et.CANNOT_CHOOSE_OPPONENT_PIECE());if(s.getRelativeOwner(e,r.getEnd())!==Z1.NONE)return R.failure(EP.LANDING_ON_OCCUPIED_SQUARE());if(this.isThrone(s,r.getEnd())){if(!s.getPieceAt(r.getStart()).isKing())return R.failure(EP.SOLDIERS_CANNOT_SIT_ON_THRONE());if(s.isCentralThrone(r.getEnd())&&this.config.CASTLE_IS_LEFT_FOR_GOOD)return R.failure(EP.THRONE_IS_LEFT_FOR_GOOD())}const c=r.getStart().getDirectionToward(r.getEnd()).get(),u=r.getStart().getOrthogonalDistance(r.getEnd());let d=r.getStart().getNext(c);for(let g=1;g<u;g++){if(s.getPieceAt(d)!==Sn.UNOCCUPIED)return R.failure(et.SOMETHING_IN_THE_WAY());d=d.getNext(c)}return R.SUCCESS}isThrone(e,r){return!!this.isExternalThrone(r)||e.isCentralThrone(r)}isExternalThrone(e){const r=this.config.WIDTH-1;return!(0!==e.x&&e.x!==r||0!==e.y&&e.y!==r)}tryCapture(e,r,s,i){const o=r.getNext(s);return o.isInRange(this.config.WIDTH,this.config.WIDTH)&&i.getRelativeOwner(e,o)===Z1.OPPONENT?i.getPieceAt(o).isKing()?this.captureKing(e,r,s,i):this.capturePawn(e,r,s,i):T.empty()}captureKing(e,r,s,i){const o=r.getNext(s),{backCoord:c,back:u,backInRange:d,left:g,leftCoord:m,right:y,rightCoord:b}=this.getSurroundings(o,s,e,i);return!1===d?this.captureKingAgainstTheWall(g,y,o):u===Z1.NONE&&this.isThrone(i,c)?this.captureKingAgainstThrone(c,o,g,y):u===Z1.PLAYER?this.captureKingWithAtLeastASandwich(i,o,g,m,y,b):T.empty()}getSurroundings(e,r,s,i){const o=e.getNext(r),c=o.isInRange(this.config.WIDTH,this.config.WIDTH),u=c?i.getRelativeOwner(s,o):Z1.NONE,d=e.getLeft(r),m=d.isInRange(this.config.WIDTH,this.config.WIDTH)?i.getRelativeOwner(s,d):Z1.NONE,y=e.getRight(r),k=y.isInRange(this.config.WIDTH,this.config.WIDTH)?i.getRelativeOwner(s,y):Z1.NONE;return{backCoord:o,back:u,backInRange:c,leftCoord:d,left:m,rightCoord:y,right:k}}captureKingAgainstTheWall(e,r,s){let o=e===Z1.PLAYER?1:0;return o+=r===Z1.PLAYER?1:0,2===o&&this.config.BORDER_CAN_SURROUND_KING?(Q(n.VERBOSE||!1,"king captured by 3 invaders against 1 border"),T.of(s)):T.empty()}captureKingAgainstThrone(e,r,s,i){if(this.isExternalThrone(e)){if(this.config.KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED)return T.of(r)}else{const c=i===Z1.PLAYER,u=s===Z1.PLAYER||c;if(this.config.CENTRAL_THRONE_CAN_SURROUND_KING&&u)return T.of(r)}return T.empty()}capturePawn(e,r,s,i){const c=r.getNext(s),u=c.getNext(s);let d=Z1.NONE;return u.isInRange(this.config.WIDTH,this.config.WIDTH)&&(d=i.getRelativeOwner(e,u)),d===Z1.NONE?!1===this.isThrone(i,u)?(Q(n.VERBOSE||!1,"cannot capture a pawn without an ally; "+c+"threatened by "+e+"'s pawn in "+r+" coming from this direction ("+s.x+", "+s.y+")cannot capture a pawn without an ally behind"),T.empty()):(Q(n.VERBOSE||!1,"pawn captured by 1 opponent and 1 throne; "+c+"threatened by "+e+"'s pawn in "+r+" coming from this direction ("+s.x+", "+s.y+")"),T.of(c)):d===Z1.PLAYER?(Q(n.VERBOSE||!1,"pawn captured by 2 opponents; "+c+"threatened by "+e+"'s pawn in "+r+" coming from this direction ("+s.x+", "+s.y+")"),T.of(c)):(Q(n.VERBOSE||!1,"no captures; "+c+"threatened by "+e+"'s pawn in "+r+" coming from this direction ("+s.x+", "+s.y+")"),T.empty())}captureKingWithAtLeastASandwich(e,r,s,i,o,c){if(!1===this.kingTouchCentralThrone(e,r)&&this.config.KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED)return T.of(r);const d=this.config.CENTRAL_THRONE_CAN_SURROUND_KING,g=this.isThrone(e,i),m=s===Z1.PLAYER||g&&d,y=this.isThrone(e,c);return m&&(o===Z1.PLAYER||y&&d)?(Q(n.VERBOSE||!1,"king captured by 4 invaders"),T.of(r)):T.empty()}kingTouchCentralThrone(e,r){const s=e.getCentralThrone();return r.getOrthogonalDistance(s)<=1}applyLegalMove(e,r,s){Q(n.VERBOSE,{TablutRules_applyLegalMove:{move:e,state:r}});const i=r.turn,o=r.getCopiedBoard(),c=r.getCurrentPlayer(),u=e.getStart(),d=e.getEnd();o[d.y][d.x]=o[u.y][u.x],o[u.y][u.x]=Sn.UNOCCUPIED;for(const g of $e.ORTHOGONALS){const m=this.tryCapture(c,e.getEnd(),g,r);m.isPresent()&&(o[m.get().y][m.get().x]=Sn.UNOCCUPIED)}return r.from(o,i+1)}getGameStatus(e){const s=this.getWinner(e.gameState);return s.isPresent()?xe.getVictory(s.get()):xe.ONGOING}getWinner(e){const s=this.getKingCoord(e);if(s.isAbsent())return Q(!1,"The king is dead, victory to invader"),T.of(this.getInvader());const i=s.get();return this.isExternalThrone(i)?(Q(!1,"The king escape, victory to defender"),T.of(this.getDefender())):this.isPlayerImmobilized(B.ZERO,e)?(Q(!1,"Zero has no move, victory to one"),T.of(B.ONE)):this.isPlayerImmobilized(B.ONE,e)?(Q(!1,"One has no move, victory to zero"),T.of(B.ZERO)):(Q(!1,"no victory"),T.empty())}getKingCoord(e){Q(n.VERBOSE,{TablutRules_getKingCoord:{state:e,con:this.config}});for(let r=0;r<this.config.WIDTH;r++)for(let s=0;s<this.config.WIDTH;s++)if(e.getPieceAtXY(s,r).isKing())return T.of(new S(s,r));return T.empty()}getInvader(){return this.config.INVADER}getDefender(){return this.config.INVADER.getOpponent()}isPlayerImmobilized(e,r){return 0===this.getPlayerListMoves(e,r).length}getPlayerListMoves(e,r){const i=[],o=this.getPlayerListPawns(e,r);Q(n.VERBOSE||!1,{TablutRules_getPlayerListMoves:{player:e,state:r}});for(const c of o){const u=this.getPossibleDestinations(c,r);for(const d of u){const g=this.generateMove(c,d);i.push(g)}}return i}getPlayerListPawns(e,r){const s=[];for(let i=0;i<this.config.WIDTH;i++)for(let o=0;o<this.config.WIDTH;o++){const c=new S(o,i);r.getAbsoluteOwner(c)===e&&s.push(c)}return s}getPossibleDestinations(e,r){const s=[];let i;for(const o of $e.ORTHOGONALS){i=e.getNext(o,1);let c=!1;for(;i.isInRange(this.config.WIDTH,this.config.WIDTH)&&!1===c;)r.getAbsoluteOwner(i)===he.NONE?this.isExternalThrone(i)?r.getPieceAt(e).isKing()&&s.push(i):r.isCentralThrone(i)?r.getPieceAt(e).isKing()&&!1===this.config.CASTLE_IS_LEFT_FOR_GOOD&&s.push(i):s.push(i):c=!0,i=i.getNext(o,1)}return s}}return n.VERBOSE=!1,n})();class b5 extends NH{constructor(){super(L3,S4t,Lo.of)}static get(){return null==b5.singleton&&(b5.singleton=new b5),U1.ruler=this.singleton,b5.singleton}}class IH extends ko{constructor(t,e,r){super(t),this.VERBOSE=e,this.generateMove=r,this.viewInfo={pieceClasses:[]},this.EMPTY=Sn.UNOCCUPIED,this.capturedCoords=[],this.chosen=T.empty(),this.lastMove=T.empty()}getViewBox(){const t=-this.STROKE_WIDTH,e=this.rules.config.WIDTH*this.SPACE_SIZE+2*this.STROKE_WIDTH;return t+" "+t+" "+e+" "+e}updateBoard(){Q(this.VERBOSE,"taflComponent.updateBoard"),this.board=this.getState().getCopiedBoard(),this.capturedCoords=[],this.updateViewInfo(),this.lastMove=this.rules.node.move}showLastMove(t){const e=this.getPreviousState(),r=this.getState().getCurrentOpponent();for(const s of $e.ORTHOGONALS){const i=this.lastMove.get().getEnd().getNext(s,1);if(i.isInRange(this.rules.config.WIDTH,this.rules.config.WIDTH)){const c=e.getRelativeOwner(r,i)===Z1.OPPONENT,d=this.getState().getPieceAt(i)===Sn.UNOCCUPIED;c&&d&&this.capturedCoords.push(i)}}}updateViewInfo(){const t=[];for(let e=0;e<this.board.length;e++){const r=[];for(let s=0;s<this.board[0].length;s++){let i=[];i=this.board[e][s].getOwner()===he.NONE?[""]:this.getPieceClasses(s,e),r.push(i)}t.push(r)}this.viewInfo={pieceClasses:t}}onClick(t,e){var r=this;return I(function*(){Q(r.VERBOSE,"TaflComponent.onClick("+t+", "+e+")");const s=r.canUserPlay("#click_"+t+"_"+e);if(s.isFailure())return r.cancelMove(s.getReason());const i=new S(t,e);return r.chosen.equalsValue(i)?(r.cancelMoveAttempt(),R.SUCCESS):r.chosen.isAbsent()||r.pieceBelongToCurrentPlayer(i)?r.choosePiece(i):r.chooseDestination(t,e)})()}chooseDestination(t,e){var r=this;return I(function*(){Q(r.VERBOSE,"TaflComponent.chooseDestination");const s=r.chosen.get(),i=new S(t,e),o=r.generateMove(s,i);return o.isSuccess()?yield r.chooseMove(o.get(),r.getState()):r.cancelMove(o.getReason())})()}choosePiece(t){return Q(this.VERBOSE,"TaflComponent.choosePiece"),this.board[t.y][t.x]===Sn.UNOCCUPIED?this.cancelMove(et.MUST_CHOOSE_PLAYER_PIECE()):this.pieceBelongToCurrentPlayer(t)?(this.chosen=T.of(t),this.updateViewInfo(),Q(this.VERBOSE,"selected piece = ("+t.x+", "+t.y+")"),R.SUCCESS):this.cancelMove(et.CANNOT_CHOOSE_OPPONENT_PIECE())}pieceBelongToCurrentPlayer(t){const e=this.getState(),r=e.getCurrentPlayer();return e.getRelativeOwner(r,t)===Z1.PLAYER}cancelMoveAttempt(){this.chosen=T.empty(),this.updateViewInfo()}isThrone(t,e){const r=this.getState();return this.rules.isThrone(r,new S(t,e))}isCentralThrone(t,e){return this.getState().isCentralThrone(new S(t,e))}getPieceClasses(t,e){const r=[],s=new S(t,e),i=this.getState().getAbsoluteOwner(s);return r.push(this.getPlayerClass(i)),this.chosen.equalsValue(s)&&r.push("selected-stroke"),r}getRectClasses(t,e){const r=[],s=new S(t,e);if(this.capturedCoords.some(i=>i.equals(s)))r.push("captured-fill");else if(this.lastMove.isPresent()){const i=this.lastMove.get().getStart(),o=this.lastMove.get().getEnd();(s.equals(i)||s.equals(o))&&r.push("moved-fill")}return r}getClickables(){const t=[];for(let e=0;e<this.board.length;e++)for(let r=0;r<this.board[e].length;r++){const s=new S(r,e);this.isClickable(s)&&t.push(s)}return t}isClickable(t){return this.pieceBelongToCurrentPlayer(t)}isInvader(t,e){return this.board[e][t]===Sn.INVADERS}isKing(t,e){return this.board[e][t].isKing()}}class MP extends xs{getListMoves(t){Q(!1,{TaflMinimax_getListMoves:{node:t}});const r=t.gameState,s=r.getCurrentPlayer(),i=this.ruler.getPlayerListMoves(s,r);return this.orderMoves(r,i)}orderMoves(t,e){const r=this.ruler.getKingCoord(t).get();return t.getCurrentPlayer()===this.ruler.config.INVADER?Xe.sortByDescending(e,s=>-s.getEnd().getOrthogonalDistance(r)):Xe.sortByDescending(e,s=>s.getStart().equals(r)?this.ruler.isExternalThrone(s.getEnd())?2:1:0),e}getMetrics(t){const e=t.gameState,r=this.ruler.getPlayerListPawns(B.ZERO,e).length,s=this.ruler.getPlayerListPawns(B.ONE,e).length;return[r*[1,2][this.ruler.config.INVADER.value],s*[2,1][this.ruler.config.INVADER.value]]}}class SP{constructor(t,e){this.directThreats=t,this.mover=e}equals(t){return t.directThreats.equals(this.directThreats)&&t.mover.equals(this.mover)}}class Zce extends SP{constructor(t,e){super(new zt([t]),e),this.directThreat=t}}class P4t extends zt{constructor(t){if(super(),this.valueMap=[],this.values=[],void 0!==t)for(const e of t)this.add(e)}add(t){const e=this.toFields(t);let r=this.valueMap;for(const i of e[0])void 0===r[i]&&(r[i]=[]),r=r[i];const s=e[1];return void 0===r[s]&&(r[s]=!0,this.values.push(t),!0)}contains(t){const e=this.toFields(t);let r=this.valueMap;for(const i of e[0]){if(void 0===r[i])return!1;r=r[i]}return void 0!==r[e[1]]}[Symbol.iterator](){return this.values.values()}}class Ar extends P4t{toFields(t){return[[t.y],t.x]}}class PP extends MP{constructor(t,e){super(t,e),this.width=this.ruler.config.WIDTH,this.maxInfluence=16*(2*this.width-2),this.scoreByThreatenedPiece=16*this.maxInfluence+1,this.scoreBySafePiece=16*this.scoreByThreatenedPiece+1}getBoardValue(t){const e=this.ruler.getGameStatus(t);if(e.isEndGame)return e.toBoardValue();const r=t.gameState,s=Sn.UNOCCUPIED;let i=0;const o=this.getPiecesMap(r),c=this.getThreatMap(r,o),u=this.filterThreatMap(c,r);for(const d of B.PLAYERS)for(const g of o.get(d).get())if(u.get(g).isPresent())i+=d.getScoreModifier()*this.scoreByThreatenedPiece;else{i+=d.getScoreModifier()*this.scoreBySafePiece;let m=0;for(const y of $e.ORTHOGONALS){let b=g.getNext(y,1);for(;b.isInRange(this.width,this.width)&&r.getPieceAt(b)===s;)m++,b=b.getNext(y,1)}i+=m*d.getScoreModifier()}return new k1(i)}getPiecesMap(t){const e=Sn.UNOCCUPIED,r=[],s=[];for(let o=0;o<this.width;o++)for(let c=0;c<this.width;c++){const u=new S(c,o);t.getPieceAt(u)!==e&&(t.getAbsoluteOwner(u)===B.ZERO?r.push(u):s.push(u))}return new Un([{key:B.ZERO,value:new Ar(r)},{key:B.ONE,value:new Ar(s)}])}getThreatMap(t,e){const r=new Un;for(const s of B.PLAYERS)for(const i of e.get(s).get()){const o=this.getThreats(i,t);this.isThreatReal(i,t,o)&&r.set(i,new zt(o))}return r}getThreats(t,e){const r=e.getAbsoluteOwner(t);Pe(r.isPlayer(),"TaflPieceAndInfluenceMinimax.getThreats should be called with an occupied coordinate");const s=r.getOpponent(),i=[];for(const o of $e.ORTHOGONALS){const c=t.getPrevious(o,1);if(this.isAThreat(c,e,s)){const u=[];for(const d of $e.ORTHOGONALS){if(d===o.getOpposite())continue;let g=t.getNext(o,1);for(;g.isInRange(this.width,this.width)&&e.getPieceAt(g)===Sn.UNOCCUPIED;)g=g.getNext(d);g.isInRange(this.width,this.width)&&e.getAbsoluteOwner(g)===s&&!1===t.getNext(o,1).equals(g)&&u.push(g)}i.push(new Zce(c,new Ar(u)))}}return i}isAThreat(t,e,r){return!(t.isNotInRange(this.width,this.width)||e.getAbsoluteOwner(t)!==r&&(!this.ruler.isThrone(e,t)||r!==B.ONE&&e.getPieceAt(t)!==Sn.UNOCCUPIED))}isThreatReal(t,e,r){if(0===r.length)return!1;if(e.getPieceAt(t).isKing())return 3===r.length;for(const s of r)if(s.mover.size()>0)return!0;return!1}filterThreatMap(t,e){const r=new Un,s=t.listKeys(),i=s.filter(c=>e.getAbsoluteOwner(c)===e.getCurrentPlayer()),o=new Ar(s.filter(c=>e.getAbsoluteOwner(c)===e.getCurrentOpponent()));for(const c of i){const u=t.get(c).get(),d=[];for(const g of u)if(!1===o.contains(g.directThreat)){const m=[];for(const y of g.mover)!1===o.contains(y)&&m.push(y);m.length>0&&d.push(new Zce(g.directThreat,new Ar(m)))}d.length>0&&r.set(c,new zt(d))}for(const c of o){const u=t.get(c).get();r.set(c,u)}return r}}class TP extends PP{getBoardValue(t){const e=this.ruler.getGameStatus(t);if(e.isEndGame)return e.toBoardValue();const r=t.gameState,i=this.getControlScoreAndPieceScores(this.ruler.config.WIDTH,r);let o=i.controlScore;o+=i.safeScore*this.getScoreBySafePiece(r);const c=this.getScoreByThreatenedPiece(r);return o+=i.threatenedScore*c,Pe(i.controlScore<=c,"Control Score should be below "+c+", got "+i.controlScore),Pe(i.threatenedScore<=16,"Threatened Score should be below 16, got "+i.threatenedScore),Pe(i.safeScore<=16,"Safe Score should be below 16, got "+i.threatenedScore),new k1(o)}getControlScoreAndPieceScores(t,e){const r=this.getPiecesMap(e),s=this.getThreatMap(e,r),i=this.filterThreatMap(s,e),o={safeScore:0,threatenedScore:0,controlScore:0};for(const c of B.PLAYERS){const u=new Ar;for(const d of r.get(c).get())if(i.get(d).isPresent())o.threatenedScore+=c.getScoreModifier();else{o.safeScore+=c.getScoreModifier();for(const g of $e.ORTHOGONALS){let m=d.getNext(g,1);for(;m.isInRange(t,t)&&e.getPieceAt(m)===Sn.UNOCCUPIED;)u.add(m),m=m.getNext(g,1)}}for(const d of u){const g=this.getControlledPieceValue(d.x,d.y,t);o.controlScore+=c.getScoreModifier()*g}}return o}getControlledPieceValue(t,e,r){let s=1;return(0===t||t===r-1)&&(s*=r),(0===e||e===r-1)&&(s*=r),s}getScoreByThreatenedPiece(t){const e=t.board.length,r=e-2;return 4*e*e+4*r*e+r*r}getScoreBySafePiece(t){return 16*this.getScoreByThreatenedPiece(t)+1}}class xH extends TP{getBoardValue(t){const e=this.ruler.getGameStatus(t);if(e.isEndGame)return e.toBoardValue();const r=t.gameState,i=this.getControlScoreAndPieceScores(this.ruler.config.WIDTH,r),o=r.getPieceAt(this.ruler.getKingCoord(r).get()).getOwner(),c=this.getStepForEscape(r)*o.getScoreModifier();if(-1===c)return new k1(o.getOpponent().getPreVictory());const u=this.getScoreByThreatenedPiece(r);return Pe(i.controlScore<=u,"Control Score should be below "+u+", got "+i.controlScore),Pe(i.threatenedScore<=16,"Threatened Score should be below 16, got "+i.threatenedScore),Pe(i.safeScore<=16,"Safe Score should be below 16, got "+i.threatenedScore),new k1(-1*c*(u+1)*17*17+i.safeScore*(u+1)*17+i.threatenedScore*(u+1)+i.controlScore)}getStepForEscape(t){const e=this.ruler.getKingCoord(t).get();return this._getStepForEscape(t,1,[e],[]).getOrElse(-1)}_getStepForEscape(t,e,r,s){const i=this.getNextGen(t,r,s);return 0===i.length?T.empty():i.some(o=>this.ruler.isExternalThrone(o))?T.of(e):(e++,s.push(...i),this._getStepForEscape(t,e,i,s))}getNextGen(t,e,r){const s=[];for(const i of e)for(const o of $e.ORTHOGONALS){let c=i.getNext(o,1);for(;c.isInRange(this.ruler.config.WIDTH,this.ruler.config.WIDTH)&&t.getPieceAt(c)===Sn.UNOCCUPIED;)r.every(u=>!1===u.equals(c))&&s.push(c),c=c.getNext(o,1)}return s}}const ne=Sn.UNOCCUPIED,Y1=Sn.INVADERS,pa=Sn.DEFENDERS,Fm=Sn.PLAYER_ONE_KING;class Yce extends $1{constructor(){super(...arguments),this.tutorial=[ie.informational($localize`Goal of the game`,$localize`Brandhub is the Irish version of the Tafl, Tafl being a family of viking strategy game. The goal of the game is different for each player. The attacker plays first. Their pieces (dark) are close to the edges. Their goal is to capture the king, which is in the center of the board. The defender plays second. Their pieces (light) are in the middle. Their goal is to move the king on one of the 4 thrones in the corners. Note that the square in which the king starts, in the center of the board, is also a throne.`,L3.getInitialState()),ie.anyMove($localize`Moving`,$localize`All pieces move the same way. Similarly to a rook in chess, a piece can move: <ol><li>By as many squares as you want.</li><li>Without going over another piece or stopping on another piece.</li><li>Horizontally or vertically.</li><li>Only the king can land on a corner throne.</li><li>Once the king left his central throne, no piece can land on it, but all can pass over it.</li></ol>To move a piece, click on it and then on its landing square.<br/><br/>You're playing Dark, do the first move.`,L3.getInitialState(),Lo.of(new S(3,1),new S(1,1)),$localize`Congratulations!`),ie.fromMove($localize`Capturing a soldier (1/2)`,$localize`All pieces, attackers and defenders, except the king, are soldiers. To capture them, they have to be sandwiched between two of your pieces. By getting too close, an attacker's soldier is in danger.<br/><br/>You're playing Light. Capture the soldier.`,new L3([[ne,ne,ne,Y1,ne,ne,ne],[ne,ne,ne,Y1,ne,ne,ne],[Y1,ne,ne,pa,ne,ne,ne],[ne,ne,pa,Fm,pa,Y1,Y1],[ne,ne,Y1,ne,ne,ne,ne],[ne,ne,ne,pa,ne,Y1,ne],[ne,ne,ne,Y1,ne,ne,ne]],1),[Lo.of(new S(3,5),new S(2,5))],$localize`Congratulations, that will teach him a lesson!`,$localize`Failed, you missed an opportunity to capture a piece of the opponent.`),ie.fromMove($localize`Capturing a soldier (2/2)`,$localize`A second way to capture a soldier is to sandwich it against an empty throne. The king has moved and endangered one of its soldiers.<br/><br/>You're playing Dark. Capture the soldier.`,new L3([[ne,ne,ne,Y1,ne,ne,ne],[ne,ne,Y1,ne,ne,ne,ne],[ne,ne,ne,pa,ne,ne,ne],[Y1,pa,ne,ne,pa,Y1,Y1],[ne,pa,ne,ne,ne,ne,ne],[ne,Y1,ne,Fm,ne,Y1,ne],[ne,ne,ne,Y1,ne,ne,ne]],12),[Lo.of(new S(2,1),new S(3,1)),Lo.of(new S(3,0),new S(3,1))],$localize`Congratulations, one less defender. But keep an eye on the king, it is the most important.`,$localize`Failed, you did not do the expected move.`),ie.fromMove($localize`Capturing the king on his throne`,$localize`To capture the king when he sits on his throne, the four squares neighbor to the king (horizontally and vertically) must be occupied by your soldiers.<br/><br/>You're playing Dark. Capture the king.`,new L3([[ne,ne,ne,ne,ne,ne,ne],[ne,ne,ne,pa,ne,ne,ne],[ne,ne,ne,Y1,ne,ne,ne],[ne,Y1,ne,Fm,Y1,ne,ne],[ne,ne,ne,Y1,ne,ne,ne],[ne,pa,ne,ne,ne,ne,ne],[ne,ne,ne,ne,ne,ne,ne]],72),[Lo.of(new S(1,3),new S(2,3))],$localize`Congratulations, you won!`,$localize`Failed, you let the king run away.`),ie.fromMove($localize`Capturing the king next to his throne`,$localize`Another way to capture the king is to use three soldier plus the central throne to surround the king on four sides.<br/><br/>You're playing Dark. Capture the king.`,new L3([[ne,ne,Y1,ne,ne,ne,ne],[ne,ne,ne,Y1,ne,ne,ne],[ne,ne,ne,Fm,Y1,ne,ne],[ne,Y1,pa,ne,pa,ne,ne],[ne,ne,ne,Y1,ne,ne,ne],[ne,ne,ne,ne,ne,ne,ne],[ne,ne,ne,ne,ne,ne,ne]],72),[Lo.of(new S(2,0),new S(2,2))],$localize`The king is dead, long live the king. Congratulations, you won.`,$localize`Failed. Try again.`),ie.fromMove($localize`Capturing the king far from his throne`,$localize`When the king is not on his central throne nor next to it, he can be captured like a soldier.<br/><br/>You're playing Dark. Capture the king.`,new L3([[ne,ne,ne,ne,ne,ne,ne],[ne,ne,ne,ne,ne,ne,ne],[ne,Y1,ne,Y1,ne,ne,ne],[Y1,ne,ne,ne,pa,ne,ne],[ne,ne,ne,pa,ne,ne,ne],[ne,ne,ne,ne,ne,ne,ne],[ne,Fm,ne,Y1,ne,ne,ne]],72),[Lo.of(new S(3,6),new S(2,6))],$localize`The king is dead, long live the king. Congratulations, you won.`,$localize`Failed. Try again.`)]}}function T4t(n,t){1&n&&(F(),X(0,"polygon",8))}function w4t(n,t){1&n&&(F(),X(0,"rect",9))}function b4t(n,t){if(1&n&&(F(),O(0,"g"),x(1,T4t,1,0,"polygon",6),x(2,w4t,1,0,"ng-template",null,7,Zn),A()),2&n){const e=Bn(3),r=C().index,s=C().index,i=C();P(1),w("ngIf",i.isCentralThrone(r,s))("ngIfElse",e)}}function O4t(n,t){if(1&n&&(F(),O(0,"g"),X(1,"line",13)(2,"line",13)(3,"line",13)(4,"line",13)(5,"line",13),A()),2&n){const e=C(2).index,r=C().index,s=C();P(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),z("x1",.5*s.SPACE_SIZE)("y1",.04*s.SPACE_SIZE)("x2",.5*s.SPACE_SIZE)("y2",.96*s.SPACE_SIZE),P(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),z("x1",.5*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.1*s.SPACE_SIZE)("y2",.6*s.SPACE_SIZE),P(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),z("x1",.5*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.9*s.SPACE_SIZE)("y2",.6*s.SPACE_SIZE),P(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),z("x1",.5*s.SPACE_SIZE)("y1",.4*s.SPACE_SIZE)("x2",.15*s.SPACE_SIZE)("y2",.75*s.SPACE_SIZE),P(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),z("x1",.5*s.SPACE_SIZE)("y1",.4*s.SPACE_SIZE)("x2",.85*s.SPACE_SIZE)("y2",.75*s.SPACE_SIZE)}}function A4t(n,t){if(1&n&&(F(),X(0,"polyline",16)),2&n){const e=C(3).index,r=C().index;w("ngClass",C().viewInfo.pieceClasses[r][e])}}function N4t(n,t){if(1&n&&(F(),X(0,"line",13)(1,"line",13)(2,"line",13)(3,"line",13)),2&n){const e=C(3).index,r=C().index,s=C();w("ngClass",s.viewInfo.pieceClasses[r][e]),z("x1",.5*s.SPACE_SIZE)("y1",.04*s.SPACE_SIZE)("x2",.5*s.SPACE_SIZE)("y2",.96*s.SPACE_SIZE),P(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),z("x1",.04*s.SPACE_SIZE)("y1",.5*s.SPACE_SIZE)("x2",.96*s.SPACE_SIZE)("y2",.5*s.SPACE_SIZE),P(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),z("x1",.2*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.8*s.SPACE_SIZE)("y2",.8*s.SPACE_SIZE),P(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),z("x1",.8*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.2*s.SPACE_SIZE)("y2",.8*s.SPACE_SIZE)}}function I4t(n,t){if(1&n&&(F(),x(0,A4t,1,1,"polyline",14),x(1,N4t,4,20,"ng-template",null,15,Zn)),2&n){const e=Bn(2),r=C(2).index,s=C().index;w("ngIf",C().isKing(r,s))("ngIfElse",e)}}function x4t(n,t){if(1&n&&(F(),O(0,"g"),X(1,"circle",10),x(2,O4t,6,25,"g",11),x(3,I4t,3,2,"ng-template",null,12,Zn),A()),2&n){const e=Bn(4),r=C().index,s=C().index,i=C();P(1),De("id","piece_",r,"_",s,""),w("ngClass",i.viewInfo.pieceClasses[s][r]),z("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)("cx",.5*i.SPACE_SIZE)("cy",.5*i.SPACE_SIZE),P(1),w("ngIf",i.isInvader(r,s))("ngIfElse",e)}}function k4t(n,t){if(1&n){const e=Oe();F(),O(0,"g",3),ee("click",function(){const i=ue(e).index,o=C().index;return ce(C().onClick(i,o))}),X(1,"rect",4),x(2,b4t,4,2,"g",5),x(3,x4t,5,8,"g",5),A()}if(2&n){const e=t.index,r=C().index,s=C();De("id","click_",e,"_",r,""),z("transform","translate("+s.SPACE_SIZE*e+", "+s.SPACE_SIZE*r+")"),P(1),De("id","space_",e,"_",r,""),w("ngClass",s.getRectClasses(e,r)),z("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),P(1),w("ngIf",s.board[r][e]===s.EMPTY&&s.isThrone(e,r)),P(1),w("ngIf",s.board[r][e]!==s.EMPTY)}}function L4t(n,t){if(1&n&&(F(),O(0,"g"),x(1,k4t,4,10,"g",2),A()),2&n){const e=t.$implicit;P(1),w("ngForOf",e)}}function R4t(n,t){if(1&n){const e=Oe();F(),O(0,"g")(1,"rect",17),ee("click",function(){const i=ue(e).$implicit;return ce(C().onClick(i.x,i.y))}),A()()}if(2&n){const e=t.$implicit,r=C();P(1),De("id","click_",e.x,"_",e.y,""),z("x",r.SPACE_SIZE*e.x)("y",r.SPACE_SIZE*e.y)("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)}}let D4t=(()=>{class n extends IH{constructor(e){super(e,!1,Lo.from),this.rules=b5.get(),this.availableMinimaxes=[new MP(this.rules,"DummyBot"),new PP(this.rules,"Piece > Influence"),new TP(this.rules,"Piece > Control"),new xH(this.rules,"Escape > Piece > Control")],this.encoder=Lo.encoder,this.tutorial=(new Yce).tutorial}ngOnInit(){this.updateBoard()}}return n.\u0275fac=function(e){return new(e||n)(J(En))},n.\u0275cmp=dt({type:n,selectors:[["app-brandhub"]],features:[l],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["x","0","y","0",1,"base",3,"id","ngClass"],[4,"ngIf"],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60","class","base",4,"ngIf","ngIfElse"],["cornerThrone",""],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60",1,"base"],["x","15","y","15","width","70","height","70",1,"base"],[1,"base",3,"id","ngClass"],[4,"ngIf","ngIfElse"],["defender",""],[1,"base",3,"ngClass"],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85","class","base no-fill",3,"ngClass",4,"ngIf","ngIfElse"],["soldierDefender",""],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85",1,"base","no-fill",3,"ngClass"],[1,"no-fill","mid-stroke","clickable-stroke",3,"id","click"]],template:function(e,r){1&e&&(F(),O(0,"svg",0),x(1,L4t,2,1,"g",1),x(2,R4t,2,6,"g",1),A()),2&e&&(z("viewBox",r.getViewBox()),P(1),w("ngForOf",r.board),P(1),w("ngForOf",r.getClickables()))},dependencies:[fn,On,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})(),Dc=(()=>{class n extends Br{static getInitialState(){const e=Xe.createTable(n.WIDTH,n.WIDTH,he.NONE);return new n(e,0)}}return n.WIDTH=19,n})();class zc extends Ks{constructor(t,e){super(t,e)}static isInRange(t){return t.isInRange(Dc.WIDTH,Dc.WIDTH)}static from(t){return Me.assert(zc.isInRange(t),"FIRST_COORD_IS_OUT_OF_RANGE"),new zc(t.x,t.y)}toString(){return"ConnectSixFirstMove("+this.coord.x+", "+this.coord.y+")"}}zc.encoder=Ks.getEncoder(zc.from);class d6 extends no{static from(t,e){return Me.assert(t.isInRange(Dc.WIDTH,Dc.WIDTH),"FIRST_COORD_IS_OUT_OF_RANGE"),Me.assert(e.isInRange(Dc.WIDTH,Dc.WIDTH),"SECOND_COORD_IS_OUT_OF_RANGE"),Me.assert(!1===t.equals(e),"COORDS_SHOULD_BE_DIFFERENT"),_e.success(new d6(t,e))}toString(){return"ConnectSixDrops("+this.getFirst().toString()+", "+this.getSecond().toString()+")"}equals(t){const e=this.getFirst(),r=t.getFirst(),s=this.getSecond(),i=t.getSecond();return!(!e.equals(r)||!s.equals(i))||!(!e.equals(i)||!s.equals(r))}}d6.encoder=no.getFallibleEncoder(d6.from);const z4t=Nt.disjunction(zc.encoder,d6.encoder,n=>n instanceof zc);class Bm{constructor(t,e,r){this.isInRange=t,this.getOwner=e,this.N=r}getBoardValue(t){let e=0;return t.forEachCoord((r,s)=>{this.getOwner(s,t).isPlayer()&&(e+=this.getSquareScore(t,r))}),new k1(e)}getSquareScore(t,e){const r=t.getPieceAt(e),s=this.getOwner(r,t);Pe(s.isPlayer(),"getSquareScore should not be called with PlayerOrNone.NONE piece");const i=new Un,o=new Un;for(const u of Ne.DIRECTIONS){const d=this.getNumberOfFreeSpacesAndAllies(t,e,u,s);i.set(u,d[0]),o.set(u,d[1])}return this.getScoreFromDirectionAlliesAndFreeSpaces(o,i)*s.getScoreModifier()}getScoreFromDirectionAlliesAndFreeSpaces(t,e){let r=0;for(const s of[Ne.UP,Ne.UP_RIGHT,Ne.RIGHT,Ne.DOWN_RIGHT]){if(t.get(s).get()+t.get(s.getOpposite()).get()+1>=this.N)return Number.MAX_SAFE_INTEGER;const g=e.get(s).get()+e.get(s.getOpposite()).get();g+1>=this.N&&(r+=2+g-this.N)}return r}getNumberOfFreeSpacesAndAllies(t,e,r,s){let i=0,o=0,c=!0,u=new S(e.x+r.x,e.y+r.y),d=1;const g=s.getOpponent();for(;this.isInRange(u)&&d<this.N;){const m=t.getPieceAt(u);if(this.getOwner(m,t)===g)return[i,o];this.getOwner(m,t)===s&&c?o++:c=!1,m!==g&&m!==s&&i++,u=u.getNext(r),d++}return[i,o]}getVictoriousCoord(t){const e=[];for(const r of t.getCoordsAndContents())if(this.getOwner(r.content,t).isPlayer()){const s=r.coord,i=this.getSquareScore(t,s);U1.getScoreStatus(i)===Mn.VICTORY&&(i===B.ZERO.getVictoryValue()||i===B.ONE.getVictoryValue())&&e.push(s)}return e}}class Vc extends L1{constructor(){super(Dc)}static get(){return Vc.singleton.isAbsent()&&(Vc.singleton=T.of(new Vc)),Vc.singleton.get()}static getVictoriousCoords(t){return Vc.CONNECT_SIX_HELPER.getVictoriousCoord(t)}applyLegalMove(t,e,r){return t instanceof d6?this.applyLegalDrops(t,e):this.applyLegalFirstMove(t,e)}applyLegalDrops(t,e){const r=e.getCurrentPlayer(),s=t.getFirst(),i=t.getSecond(),o=e.getCopiedBoard();return o[s.y][s.x]=r,o[i.y][i.x]=r,new Dc(o,e.turn+1)}applyLegalFirstMove(t,e){const r=e.getCurrentPlayer(),s=e.getCopiedBoard();return s[t.coord.y][t.coord.x]=r,new Dc(s,e.turn+1)}isLegal(t,e){return 0===e.turn?(Me.assert(t instanceof zc,"First move should be instance of ConnectSixFirstMove"),R.SUCCESS):(Me.assert(t instanceof d6,"non-firsts moves should be instance of ConnectSixDrops"),this.isLegalDrops(t,e))}isLegalDrops(t,e){return e.getPieceAt(t.getFirst()).isPlayer()||e.getPieceAt(t.getSecond()).isPlayer()?R.failure(et.MUST_CLICK_ON_EMPTY_SQUARE()):R.SUCCESS}getGameStatus(t){const e=t.gameState;return Vc.CONNECT_SIX_HELPER.getVictoriousCoord(e).length>0?xe.getVictory(e.getCurrentOpponent()):181===e.turn?xe.DRAW:xe.ONGOING}}Vc.singleton=T.empty(),Vc.CONNECT_SIX_HELPER=new Bm(zc.isInRange,Me.identity,6);const G=he.NONE,O2=he.ZERO,$i=he.ONE;class Kce extends $1{constructor(){super(...arguments),this.tutorial=[ie.informational($localize`Initial board and object of the game`,$localize`Connect Six is played on a 19x19 board, on which stones are put on the intersections. The aim of the game is to align 6 of your pieces.`,Dc.getInitialState()),ie.anyMove($localize`First turn`,$localize`On the first turn, the first player plays only one piece.<br/><br/>You're playing Dark, place your first piece by clicking on an intersection.`,Dc.getInitialState(),zc.from(new S(9,9)),$localize`Congratulations!`),ie.anyMove($localize`Next turns`,$localize`On all following turns, the players play two pieces.<br/><br/>You're playing Light, do the winning move.`,new Dc([[G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G],[G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G],[G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G],[G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G],[G,G,G,G,G,G,$i,G,G,G,G,G,G,G,G,G,G,G,G],[G,G,G,G,G,G,G,O2,G,$i,O2,G,G,G,G,G,G,G,G],[G,G,G,G,G,G,G,G,O2,O2,G,G,$i,G,G,G,G,G,G],[G,G,G,G,G,G,G,$i,O2,O2,O2,O2,$i,G,G,G,G,G,G],[G,G,G,G,G,G,$i,O2,O2,O2,O2,$i,G,G,G,G,G,G,G],[G,G,G,G,G,G,$i,G,$i,O2,$i,$i,G,G,G,G,G,G,G],[G,G,G,G,G,G,G,G,O2,$i,O2,G,G,G,G,G,G,G,G],[G,G,G,G,G,G,G,$i,G,$i,G,O2,G,G,G,G,G,G,G],[G,G,G,G,G,G,G,G,G,$i,$i,G,$i,G,G,G,G,G,G],[G,G,G,G,G,G,G,G,G,$i,G,G,G,G,G,G,G,G,G],[G,G,G,G,G,G,G,G,G,O2,G,G,G,G,G,G,G,G,G],[G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G],[G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G],[G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G],[G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G]],20),d6.from(new S(4,11),new S(5,10)).get(),$localize`Congratulations!`)]}}let kH=(()=>{class n extends ko{constructor(){super(...arguments),this.hoshis=[]}createHoshis(){const e=this.board.length,r=Math.floor(e/2),s=e<12?2:3,i=e-(s+1);18<e&&this.hoshis.push(new S(s,r),new S(r,s),new S(r,i),new S(i,r)),this.hoshis.push(new S(r,r),new S(s,s),new S(s,i),new S(i,s),new S(i,i))}isHoshi(e,r){return this.hoshis.some(s=>s.x===e&&s.y===r)}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=Mr(n)))(r||n)}}(),n.\u0275cmp=dt({type:n,selectors:[["ng-component"]],features:[l],decls:0,vars:0,template:function(e,r){},encapsulation:2}),n})();function V4t(n,t){if(1&n&&(F(),X(0,"circle",8)),2&n){const e=C().index,r=C().index,s=C();De("id","piece_",e,"_",r,""),w("ngClass",s.getSpaceClass(e,r)),z("cx",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*e)("cy",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*r)("r",.22*s.SPACE_SIZE)}}function H4t(n,t){if(1&n&&(F(),X(0,"circle",12)),2&n){const e=C(2).index,r=C().index,s=C();De("id","hoshi_",e,"_",r,""),z("cx",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*e)("cy",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*r)("r",.1*s.SPACE_SIZE)}}function F4t(n,t){if(1&n&&(F(),X(0,"rect",9)(1,"line",10)(2,"line",10),x(3,H4t,1,5,"circle",11)),2&n){const e=C().index,r=C().index,s=C();z("width",.5*s.SPACE_SIZE)("height",.5*s.SPACE_SIZE)("x",.5*s.SPACE_SIZE*e)("y",.5*s.SPACE_SIZE*r),P(1),z("x1",.5*s.SPACE_SIZE*e)("y1",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*r)("x2",.5*s.SPACE_SIZE+.5*s.SPACE_SIZE*e)("y2",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*r),P(1),z("x1",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*e)("y1",.5*s.SPACE_SIZE*r)("x2",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*e)("y2",.5*s.SPACE_SIZE+.5*s.SPACE_SIZE*r),P(1),w("ngIf",s.isHoshi(e,r))}}function B4t(n,t){if(1&n){const e=Oe();F(),O(0,"g",5),ee("click",function(){const i=ue(e).index,o=C().index;return ce(C().onClick(i,o))}),x(1,V4t,1,6,"circle",6),x(2,F4t,4,13,"ng-template",null,7,Zn),A()}if(2&n){const e=t.$implicit,r=t.index,s=Bn(3);De("id","click_",r,"_",C().index,""),P(1),w("ngIf",e.isPlayer())("ngIfElse",s)}}function $4t(n,t){if(1&n&&(F(),O(0,"g"),x(1,B4t,4,4,"g",4),A()),2&n){const e=t.$implicit;P(1),w("ngForOf",e)}}function U4t(n,t){if(1&n){const e=Oe();F(),O(0,"circle",13),ee("click",function(){ue(e);const s=C();return ce(s.onClick(s.droppedCoord.get().x,s.droppedCoord.get().y))}),A()}if(2&n){const e=C();w("ngClass",e.getSpaceClass(e.droppedCoord.get().x,e.droppedCoord.get().y)),z("cx",.25*e.SPACE_SIZE+.5*e.SPACE_SIZE*e.droppedCoord.get().x)("cy",.25*e.SPACE_SIZE+.5*e.SPACE_SIZE*e.droppedCoord.get().y)("r",.22*e.SPACE_SIZE)}}let G4t=(()=>{class n extends kH{constructor(e){super(e),this.droppedCoord=T.empty(),this.lastMoved=[],this.victoryCoords=[],this.rules=Vc.get(),this.availableMinimaxes=[],this.encoder=z4t,this.tutorial=(new Kce).tutorial}updateBoard(){const e=this.getState();this.board=e.getCopiedBoard(),this.victoryCoords=Vc.getVictoriousCoords(e),this.createHoshis()}showLastMove(e){this.lastMoved=e instanceof zc?[e.coord]:[e.getFirst(),e.getSecond()]}onClick(e,r){var s=this;return I(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());const o=new S(e,r);if(0===s.getState().turn)return s.chooseMove(zc.from(o),s.getState());if(s.getState().getPieceAt(o).isPlayer())return s.cancelMove(et.MUST_CLICK_ON_EMPTY_SQUARE());if(s.droppedCoord.isPresent()){if(s.droppedCoord.equalsValue(o))return s.droppedCoord=T.empty(),R.SUCCESS;{const c=d6.from(s.droppedCoord.get(),o).get();return s.chooseMove(c,s.getState())}}return s.droppedCoord=T.of(o),R.SUCCESS})()}getSpaceClass(e,r){const s=new S(e,r),i=this.getState().getPieceAt(s),o=[];return this.droppedCoord.equalsValue(s)?(o.push(this.getPlayerClass(this.getState().getCurrentPlayer())),o.push("highlighted-stroke")):(o.push(this.getPlayerClass(i)),this.victoryCoords.some(c=>c.equals(s))&&o.push("victory-stroke"),this.lastMoved.some(c=>c.equals(s))&&o.push("last-move-stroke")),o}cancelMoveAttempt(){this.droppedCoord=T.empty()}}return n.\u0275fac=function(e){return new(e||n)(J(En))},n.\u0275cmp=dt({type:n,selectors:[["app-connect-six"]],features:[l],decls:4,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["x","0","y","0",1,"base","mid-small-stroke"],[4,"ngFor","ngForOf"],["id","dropped","class","base mid-stroke moved-stroke",3,"ngClass","click",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["class","base mid-stroke",3,"id","ngClass",4,"ngIf","ngIfElse"],["empty",""],[1,"base","mid-stroke",3,"id","ngClass"],["fill-opacity","0",1,"base","no-stroke"],[1,"base","mid-stroke"],["class","base-no-stroke",3,"id",4,"ngIf"],[1,"base-no-stroke",3,"id"],["id","dropped",1,"base","mid-stroke","moved-stroke",3,"ngClass","click"]],template:function(e,r){1&e&&(F(),O(0,"svg",0),X(1,"rect",1),x(2,$4t,2,1,"g",2),x(3,U4t,1,4,"circle",3),A()),2&e&&(z("viewBox","0 -3 "+r.board.length*r.SPACE_SIZE*.5+" "+(6+r.board.length*r.SPACE_SIZE*.5)),P(1),z("width",r.board.length*r.SPACE_SIZE*.5)("height",r.board.length*r.SPACE_SIZE*.5),P(1),w("ngForOf",r.board),P(1),w("ngIf",r.droppedCoord.isPresent()))},dependencies:[fn,On,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})(),h6=(()=>{class n{}return n.SIMPLE_MOVE_SHOULD_BE_OF_ONE_STEP=()=>$localize`Your piece should land on a neighboring square.`,n.CANNOT_DROP_AFTER_TURN_40=()=>$localize`You cannot drop a piece during the moving phase.`,n.CANNOT_MOVE_BEFORE_TURN_40=()=>$localize`You cannot move a piece before both players have dropped all of their pieces.`,n.MUST_JUMP_OVER_PIECES=()=>$localize`A jump must be made over a piece, not over an empty square.`,n.MUST_DROP_IN_CENTRAL_ZONE=()=>$localize`A drop must occur in the central zone of the board.`,n.INVALID_JUMP=()=>$localize`A jump must land two squares from its original position, and be done in a straight line in any direction.`,n.SAME_LOCATION_VISITED_IN_JUMP=()=>$localize`You are visiting the same location twice in a move, you are not allowed to do so.`,n})();class qt extends Br{static getInitialState(){const t=Xe.createTable(qt.WIDTH,qt.HEIGHT,he.NONE);return new qt(t,0)}isShelter(t){return 0===t.x||t.x===qt.WIDTH-1?qt.SHELTERS_INDICES.some(e=>t.y===e):(0===t.y||t.y===qt.HEIGHT-1)&&qt.SHELTERS_INDICES.some(e=>t.x===e)}isCentralZone(t){return t.x>=qt.CENTRAL_ZONE_TOP_LEFT.x&&t.x<=qt.CENTRAL_ZONE_BOTTOM_RIGHT.x&&t.y>=qt.CENTRAL_ZONE_TOP_LEFT.y&&t.y<=qt.CENTRAL_ZONE_BOTTOM_RIGHT.y}isDropPhase(){return this.turn<40}getSidePieces(){return this.turn%2==0?[20-this.turn/2,20-this.turn/2]:[20-(this.turn-1)/2-1,20-(this.turn-1)/2]}}qt.WIDTH=17,qt.HEIGHT=17,qt.CENTRAL_ZONE_TOP_LEFT=new S(4,6),qt.CENTRAL_ZONE_BOTTOM_RIGHT=new S(12,10),qt.SHELTERS_INDICES=[0,1,3,5,7,8,9,11,13,15,16],qt.ALL_SHELTERS=new zt(qt.SHELTERS_INDICES.flatMap(n=>[new S(n,0),new S(n,qt.HEIGHT-1),new S(0,n),new S(qt.WIDTH-1,n)])).toList();class l8 extends Ks{constructor(t){super(t.x,t.y)}static from(t){return t.isInRange(qt.WIDTH,qt.HEIGHT)?_e.success(new l8(t)):_e.failure("Move out of board")}toString(){return`ConspirateursMoveDrop(${this.coord.toString()})`}equals(t){return!!t.isDrop()&&this.coord.equals(t.coord)}isDrop(){return!0}isSimple(){return!1}isJump(){return!1}}l8.encoder=Ks.getFallibleEncoder(l8.from);class u8 extends c8{constructor(t,e){super(t,e)}static from(t,e){return t.isInRange(qt.WIDTH,qt.HEIGHT)&&e.isInRange(qt.WIDTH,qt.HEIGHT)?t.isAlignedWith(e)&&1===t.getDistance(e)?_e.success(new u8(t,e)):_e.failure(h6.SIMPLE_MOVE_SHOULD_BE_OF_ONE_STEP()):_e.failure("Move out of board")}toString(){return`ConspirateursMoveSimple(${this.getStart().toString()} -> ${this.getEnd().toString()})`}equals(t){return!(!t.isSimple()||t!==this&&(!1===t.getStart().equals(this.getStart())||!1===t.getEnd().equals(this.getEnd())))}isDrop(){return!1}isSimple(){return!0}isJump(){return!1}}u8.encoder=no.getFallibleEncoder(u8.from);class R3 extends Fi{constructor(t){super(),this.coords=t}static from(t){if(t.length<2)return _e.failure("ConspirateursMoveJump requires at least one jump, so two coords");for(const r of t)if(r.isNotInRange(qt.WIDTH,qt.HEIGHT))return _e.failure("Move out of board");for(let r=1;r<t.length;r++)if(t[r-1].getDirectionToward(t[r]).isFailure()||2!==t[r-1].getDistance(t[r]))return _e.failure(h6.INVALID_JUMP());return new Ar(t).size()===t.length?_e.success(new R3(t)):_e.failure(h6.SAME_LOCATION_VISITED_IN_JUMP())}addJump(t){const e=Xe.copyImmutableArray(this.coords);return e.push(t),R3.from(e)}getStartingCoord(){return this.coords[0]}getEndingCoord(){return this.coords[this.coords.length-1]}getLandingCoords(){return this.coords.slice(1)}getJumpedOverCoords(){const t=[];for(let e=1;e<this.coords.length;e++){const r=this.coords[e-1].getDirectionToward(this.coords[e]).get();t.push(this.coords[e-1].getNext(r,1))}return t}toString(){return`ConspirateursMoveJump(${this.coords.map(e=>e.toString()).reduce((e,r)=>e+" -> "+r)})`}equals(t){return!(t.isSimple()||t.isDrop()||t!==this&&(!1===this.getStartingCoord().equals(t.getStartingCoord())||!1===this.getEndingCoord().equals(t.getEndingCoord())))}isDrop(){return!1}isSimple(){return!1}isJump(){return!0}}R3.encoder=new class extends Nt{encodeMove(n){return{coords:n.coords.map(S.encoder.encodeMove)}}decodeMove(n){Pe(null!=Me.getNonNullable(n).coords,"Encoded ConspirateursMoveJump should contain coords");const e=Me.getNonNullable(n).coords.map(S.encoder.decodeMove);return R3.from(e).get()}};const W4t=Nt.disjunction3(l8.encoder,u8.encoder,R3.encoder,n=>n.isDrop(),n=>n.isSimple()),M=he.NONE,xt=he.ZERO,Ot=he.ONE;class Xce extends $1{constructor(){super(...arguments),this.tutorial=[ie.informational($localize`Board and aim of the game`,$localize`Conspirateurs is played on a 17x17 board. The goal of the game is to place all of your pieces in shelters, which are the special squares on the edge of the board. Note the central zone in the middle of the board, where each player will put their pieces initially.`,qt.getInitialState()),ie.anyMove($localize`Initial phase`,$localize`In the initial phase of the game, each player drop their 20 pieces, one per turn consecutively, in the central zone of the board. This phase does not allow any other kind of move.<br/><br/>You're playing Dark, drop one of your piece in the central zone.`,qt.getInitialState(),l8.from(new S(7,7)).get(),$localize`Congratulations!`),ie.fromPredicate($localize`Simple move`,$localize`Once all pieces have been placed, there are two kind of moves that can be performed. The first is a simple move in any direction, orthogonally or diagonally, of a single step.<br/><br/>You're playing Dark. Click on one of your piece and perform such a move.`,new qt([[M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M],[M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M],[M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M],[M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M],[M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M],[M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M],[M,M,M,M,xt,xt,Ot,Ot,xt,xt,Ot,xt,Ot,M,M,M,M],[M,M,M,M,xt,Ot,xt,Ot,xt,xt,xt,xt,Ot,M,M,M,M],[M,M,M,M,xt,Ot,M,M,M,M,M,Ot,xt,M,M,M,M],[M,M,M,M,Ot,xt,xt,Ot,Ot,Ot,xt,xt,xt,M,M,M,M],[M,M,M,M,Ot,xt,Ot,Ot,Ot,Ot,Ot,Ot,xt,M,M,M,M],[M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M],[M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M],[M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M],[M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M],[M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M],[M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M]],40),u8.from(new S(4,6),new S(3,5)).get(),(t,e,r)=>t.isSimple()?R.SUCCESS:R.failure($localize`You have made a jump, not a simple move. Try again!`),$localize`Congratulations!`),ie.fromPredicate($localize`Jumps`,$localize`The other type of move is a jump. A piece can jump over a neighboring piece in any direction, as long as it lands directly on the square after that piece, along the same direction.<br/><br/>You're playing Dark. Perform a jump by clicking on one of your piece that can perform a jump, and then on the target square. You may need to click a second time on the target square to confirm your jump, in case your piece is still highlighted (we will see shortly why this is useful).`,new qt([[M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M],[M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M],[M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M],[M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M],[M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M],[M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M],[M,M,M,M,xt,xt,Ot,Ot,xt,xt,Ot,xt,Ot,M,M,M,M],[M,M,M,M,xt,Ot,xt,Ot,xt,xt,xt,xt,Ot,M,M,M,M],[M,M,M,M,xt,Ot,M,M,M,M,M,Ot,xt,M,M,M,M],[M,M,M,M,Ot,xt,xt,Ot,Ot,Ot,xt,xt,xt,M,M,M,M],[M,M,M,M,Ot,xt,Ot,Ot,Ot,Ot,Ot,Ot,xt,M,M,M,M],[M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M],[M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M],[M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M],[M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M],[M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M],[M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M]],40),R3.from([new S(6,7),new S(6,5)]).get(),(t,e,r)=>t.isJump()?R.SUCCESS:R.failure($localize`You have not performed a jump. Try again!`),$localize`Congratulations!`),ie.fromMove($localize`Chaining jumps in a single move`,$localize`Jumps can be chained when possible. You can decide whether to continue a jump or to stop it at any time. To finish your jump, click a second time on your current location. Otherwise, simply keep clicking on your next location. Once no more destination is possible, your move will end without you needing to click the piece a second time.<br/><br/>You're playing Dark and you can perform a triple jump! Do it.`,new qt([[M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M],[M,M,M,M,M,M,Ot,M,M,M,M,M,M,M,M,M,M],[M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M],[M,M,M,M,M,M,Ot,M,M,M,M,M,M,M,M,M,M],[M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M],[M,M,M,M,M,M,M,Ot,M,M,M,M,M,M,M,M,M],[M,M,M,M,xt,xt,M,Ot,xt,xt,Ot,xt,Ot,M,M,M,M],[M,M,M,M,xt,M,xt,Ot,xt,xt,xt,xt,Ot,M,M,M,M],[M,M,M,M,xt,Ot,M,M,M,M,M,Ot,xt,M,M,M,M],[M,M,M,M,Ot,xt,xt,Ot,Ot,Ot,xt,xt,xt,M,M,M,M],[M,M,M,M,Ot,xt,Ot,Ot,Ot,Ot,Ot,Ot,xt,M,M,M,M],[M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M],[M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M],[M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M],[M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M],[M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M],[M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M]],40),[R3.from([new S(8,6),new S(6,4),new S(6,2),new S(6,0)]).get()],$localize`Congratulations! You now know everything to play the game. Remember: to win, you have to place all of your pieces in shelters before your opponent does.`,$localize`You have not performed a triple jump. Try again!`)]}}class Ya extends L1{constructor(){super(qt)}static get(){return Ya.singleton.isAbsent()&&(Ya.singleton=T.of(new Ya)),Ya.singleton.get()}applyLegalMove(t,e,r){const s=e.getCopiedBoard();if(t.isDrop())s[t.coord.y][t.coord.x]=e.getCurrentPlayer();else if(t.isSimple())s[t.getStart().y][t.getStart().x]=he.NONE,s[t.getEnd().y][t.getEnd().x]=e.getCurrentPlayer();else{const i=t.getStartingCoord(),o=t.getEndingCoord();s[i.y][i.x]=he.NONE,s[o.y][o.x]=e.getCurrentPlayer()}return new qt(s,e.turn+1)}isLegal(t,e){return t.isDrop()?this.dropLegality(t,e):t.isSimple()?this.simpleMoveLegality(t,e):this.jumpLegality(t,e)}dropLegality(t,e){return e.turn>=40?R.failure(h6.CANNOT_DROP_AFTER_TURN_40()):e.getPieceAt(t.coord).isPlayer()?R.failure(et.MUST_LAND_ON_EMPTY_SPACE()):!1===e.isCentralZone(t.coord)?R.failure(h6.MUST_DROP_IN_CENTRAL_ZONE()):R.SUCCESS}simpleMoveLegality(t,e){return e.turn<40?R.failure(h6.CANNOT_MOVE_BEFORE_TURN_40()):e.getPieceAt(t.getStart())!==e.getCurrentPlayer()?R.failure(et.MUST_CHOOSE_PLAYER_PIECE()):e.getPieceAt(t.getEnd()).isPlayer()?R.failure(et.MUST_LAND_ON_EMPTY_SPACE()):R.SUCCESS}jumpLegality(t,e){if(e.turn<40)return R.failure(h6.CANNOT_MOVE_BEFORE_TURN_40());if(e.getPieceAt(t.getStartingCoord())!==e.getCurrentPlayer())return R.failure(et.MUST_CHOOSE_PLAYER_PIECE());for(const r of t.getJumpedOverCoords())if(e.getPieceAt(r)===he.NONE)return R.failure(h6.MUST_JUMP_OVER_PIECES());for(const r of t.getLandingCoords())if(e.getPieceAt(r).isPlayer())return R.failure(et.MUST_LAND_ON_EMPTY_SPACE());return R.SUCCESS}jumpTargetsFrom(t){const e=[new S(t.x+2,t.y),new S(t.x-2,t.y),new S(t.x,t.y+2),new S(t.x,t.y-2),new S(t.x+2,t.y+2),new S(t.x+2,t.y-2),new S(t.x-2,t.y+2),new S(t.x-2,t.y-2)],r=[];for(const s of e)R3.from([t,s]).isSuccess()&&r.push(s);return r}nextJumps(t,e){const r=t.getEndingCoord(),s=[];for(const i of this.jumpTargetsFrom(r)){const o=t.addJump(i);o.isSuccess()&&this.jumpLegality(o.get(),e).isSuccess()&&s.push(o.get())}return s}jumpHasPossibleNextTargets(t,e){return this.nextJumps(t,e).length>0}getGameStatus(t){const e=t.gameState,r=[0,0];for(const s of qt.ALL_SHELTERS){const i=e.getPieceAt(s);if(i.isPlayer()&&(r[i.value]+=1,20===r[i.value]))return xe.getVictory(i)}return xe.ONGOING}}Ya.singleton=T.empty();let $m=(()=>{class n{}return n.NO_MORE_PIECES_OF_THIS_TYPE=()=>$localize`You do not have any pieces of this type anymore.`,n.SPACE_IS_FULL=()=>$localize`You cannot play here: this space is already full.`,n.TARGET_STACK_TOO_HIGH=()=>$localize`You cannot add more pieces to the target stack, as it will contain more than 4 pieces.`,n.MUST_SHIFT_TO_NEIGHBOR=()=>$localize`To perform a shift, you must move the pieces to a neighboring space.`,n.MUST_SELECT_PIECE_FIRST=()=>$localize`You must first select either a piece from the side, or a stack of pieces to shift on the board.`,n})();class Pn{constructor(t,e){this.owner=t,this.otherPieceType=e}static of(t,e){return t===B.ZERO?e?Pn.ZERO_SECOND:Pn.ZERO_FIRST:t===B.ONE?e?Pn.ONE_SECOND:Pn.ONE_FIRST:Pn.EMPTY}toString(){return`DiamPiece(${this.owner}, ${this.otherPieceType})`}equals(t){return this===t}}Pn.encoder=Nt.tuple([he.encoder,Nt.identity()],n=>[n.owner,n.otherPieceType],n=>Pn.of(n[0],n[1])),Pn.EMPTY=new Pn(he.NONE,!1),Pn.ZERO_FIRST=new Pn(B.ZERO,!1),Pn.ZERO_SECOND=new Pn(B.ZERO,!0),Pn.ONE_FIRST=new Pn(B.ONE,!1),Pn.ONE_SECOND=new Pn(B.ONE,!0),Pn.PLAYER_PIECES=[Pn.ZERO_FIRST,Pn.ZERO_SECOND,Pn.ONE_FIRST,Pn.ONE_SECOND];class f8 extends Fi{constructor(t,e){if(super(),this.target=t,this.piece=e,e===Pn.EMPTY)throw new Error("Cannot drop an empty piece")}isDrop(){return!0}getTarget(){return this.target}equals(t){return t instanceof f8&&!(this.target!==t.target||this.piece!==t.piece)}toString(){return`DiamMoveDrop(${this.target}, ${this.piece})`}}f8.encoder=Nt.tuple([Nt.identity(),Pn.encoder],n=>[n.target,n.piece],n=>new f8(n[0],n[1]));class A2 extends Fi{constructor(t,e){super(),this.start=t,this.moveDirection=e}static fromRepresentation(t,e){return new A2(new S(t.x,3-t.y),e)}isDrop(){return!1}getTarget(){return"clockwise"===this.moveDirection?(this.start.x+1)%8:(this.start.x+7)%8}equals(t){return t instanceof A2&&!(!1===this.start.equals(t.start)||this.moveDirection!==t.moveDirection)}toString(){return`DiamMoveShift(${this.start}, ${this.moveDirection})`}}A2.encoder=Nt.tuple([S.encoder,Nt.identity()],n=>[n.start,"clockwise"===n.moveDirection],n=>new A2(n[0],n[1]?"clockwise":"counterclockwise"));const q4t=Nt.disjunction(f8.encoder,A2.encoder,n=>n.isDrop());let $r=(()=>{class n extends Br{constructor(e,r,s){super(e,s),this.remainingPieces=r}static getInitialState(){const e=Pn.EMPTY;return new n([[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e]],[4,4,4,4],0)}static fromRepresentation(e,r){const s=e.reverse(),i=[4,4,4,4];for(let o=0;o<n.HEIGHT;o++)for(let c=0;c<n.WIDTH;c++){const u=s[o][c];s[o][c]!==Pn.EMPTY&&i[n.pieceIndex(u)]--}return Pe(i.every(o=>o>=0),"Invalid DiamState representation uses too many pieces"),new n(s,i,r)}static pieceIndex(e){switch(e){case Pn.ZERO_FIRST:return 0;case Pn.ZERO_SECOND:return 1;case Pn.ONE_FIRST:return 2;default:return Me.expectToBe(e,Pn.ONE_SECOND),3}}getRemainingPiecesOf(e){return this.remainingPieces[n.pieceIndex(e)]}getStackHeight(e){let r=0;for(let s=0;s<n.HEIGHT&&this.getPieceAtXY(e,s)!==Pn.EMPTY;s++)r++;return r}}return n.WIDTH=8,n.HEIGHT=4,n})();class V4 extends L1{constructor(){super($r)}static get(){return V4.singleton.isAbsent()&&(V4.singleton=T.of(new V4)),V4.singleton.get()}applyLegalMove(t,e,r){return t.isDrop()?this.applyLegalDrop(t,e):this.applyLegalShift(t,e)}applyLegalDrop(t,e){const r=Xe.copyBiArray(e.board);r[e.getStackHeight(t.target)][t.target]=t.piece;const s=Xe.copyImmutableArray(e.remainingPieces);return s[$r.pieceIndex(t.piece)]-=1,new $r(r,s,e.turn+1)}applyLegalShift(t,e){const r=Xe.copyBiArray(e.board),s=t.getTarget();let i=e.getStackHeight(s),o=t.start.y;for(;o<$r.HEIGHT&&e.getPieceAtXY(t.start.x,o)!==Pn.EMPTY;)r[i][s]=e.getPieceAtXY(t.start.x,o),r[o][t.start.x]=Pn.EMPTY,i++,o++;return new $r(r,e.remainingPieces,e.turn+1)}isLegal(t,e){return t.isDrop()?this.isDropLegal(t,e):this.isShiftLegal(t,e)}isDropLegal(t,e){return t.piece.owner!==e.getCurrentPlayer()?R.failure(et.MUST_CHOOSE_PLAYER_PIECE()):0===e.getRemainingPiecesOf(t.piece)?R.failure($m.NO_MORE_PIECES_OF_THIS_TYPE()):this.dropHeightValidity(t,e)}dropHeightValidity(t,e){return e.getStackHeight(t.target)===$r.HEIGHT?R.failure($m.SPACE_IS_FULL()):R.SUCCESS}isShiftLegal(t,e){return e.getPieceAt(t.start).owner!==e.getCurrentPlayer()?R.failure(et.MUST_CHOOSE_PLAYER_PIECE()):this.shiftHeightValidity(t,e)}shiftHeightValidity(t,e){const r=e.getStackHeight(t.start.x)-t.start.y;return e.getStackHeight(t.getTarget())+r>$r.HEIGHT?R.failure($m.TARGET_STACK_TOO_HIGH()):R.SUCCESS}getGameStatus(t){const e=this.findHighestAlignment(t.gameState);if(e.isPresent()){const r=t.gameState.getPieceAt(e.get());return Pe(r.owner.isPlayer(),"highest alignment is owned by a player"),xe.getVictory(r.owner)}return xe.ONGOING}findHighestAlignment(t){for(let e=0;e<$r.WIDTH/2;e++)for(let r=$r.HEIGHT-1;r>0;r--){const s=t.getPieceAtXY(e,r),i=t.getPieceAtXY(e+$r.WIDTH/2,r);if(s!==Pn.EMPTY&&s===i)return T.of(new S(e,r))}return T.empty()}pieceCanMove(t,e){return!!this.isShiftLegal(new A2(e,"clockwise"),t).isSuccess()||!!this.isShiftLegal(new A2(e,"counterclockwise"),t).isSuccess()}}V4.singleton=T.empty();const st=Pn.EMPTY,Od=Pn.ZERO_FIRST,Qce=Pn.ZERO_SECOND,wP=Pn.ONE_FIRST,LH=Pn.ONE_SECOND;class Jce{constructor(){this.tutorial=[ie.informational($localize`Initial board and player pieces`,$localize`Diam's board is a circular board made of 8 spaces. Each player has 8 pieces: 4 of one color, and 4 of another color. Initially, the board is empty. All the remaining pieces are displayed next to the board: Dark's pieces are on the left, Light's pieces are on the right.`,$r.getInitialState()),ie.fromMove($localize`Goal of the game`,$localize`At Diam, the goal is to align two of your pieces, having exactly the same color, on diametrically opposed spaces, on top of at least another piece. Note here that Dark does not win because the dark pieces are not on top of any other piece. You're playing Light. Here, you can win by dropping one of your pieces on the leftmost space. You can do it by clicking on the corresponding piece next to the board, and then on the space in which you want to drop your piece.<br/><br/>You're playing Light, win the game!`,$r.fromRepresentation([[st,st,st,st,st,st,st,st],[st,st,st,st,st,st,st,st],[st,st,st,st,wP,st,st,st],[Od,st,st,st,Od,st,st,st]],3),[new f8(0,Pn.ONE_FIRST)],$localize`Congratulations, you won!`,$localize`Failed, you should drop your piece on the leftmost space, using the piece of the same color of the other piece you already have on the board.`),ie.fromMove($localize`Types of move`,$localize`You can perform two types of move: either dropping one of your piece like you did in the previous step, or you can shift one of your pieces on the board to a neighboring space. You can pick any of your piece on the board, even if there are pieces on top of it. Only one condition applies: there can never be more than 4 pieces in a space. When you pick a piece with other pieces on top of it, all the other pieces move with yours.<br/><br/>You're playing Dark, try to move one of your piece that is already on the board.`,$r.fromRepresentation([[st,st,st,st,st,st,st,st],[st,st,st,st,LH,st,st,st],[st,st,st,st,Od,st,st,st],[wP,st,st,st,Qce,st,st,st]],4),[A2.fromRepresentation(new S(4,3),"counterclockwise"),A2.fromRepresentation(new S(4,3),"clockwise"),A2.fromRepresentation(new S(4,2),"counterclockwise"),A2.fromRepresentation(new S(4,2),"clockwise")],$localize`Congratulations!`,$localize`Failed, try to move one of your piece that is already on the board.`),ie.fromMove($localize`Special case`,$localize`It can happen that, in a single turn, both players reach an alignment. If it is the case, only the player with the highest alignment wins.<br/><br/>Here, playing Dark, you can win by performing such a move, do it!`,$r.fromRepresentation([[st,st,st,st,Od,st,st,st],[st,st,st,st,LH,st,st,Od],[st,st,st,st,Od,st,st,LH],[st,wP,st,st,Qce,st,st,wP]],8),[A2.fromRepresentation(new S(4,2),"counterclockwise")],$localize`Congratulations!`,$localize`Failed, try to shift a stack of pieces to the left.`)]}}let e3e=(()=>{class n extends o8{constructor(){super(...arguments),this.SPACE_SIZE=50}getTriangleCornerCoords(e,r){return(e+r)%2==1?this.getDownwardCoordinate(e,r):this.getUpwardCoordinate(e,r)}getTriangleCoordinate(e,r){return this.getTriangleCornerCoords(e,r).map(o=>o.x+","+o.y).reduce((o,c)=>o+","+c)}getDownwardCoordinate(e,r){const i=.5*this.SPACE_SIZE*(e+1),o=.5*this.SPACE_SIZE*(e+2),c=this.SPACE_SIZE*r,u=this.SPACE_SIZE*(r+1),d=new S(.5*this.SPACE_SIZE*e,c);return[d,new S(i,u),new S(o,c),d]}getUpwardCoordinate(e,r){const i=.5*this.SPACE_SIZE*(e+1),o=.5*this.SPACE_SIZE*(e+2),c=this.SPACE_SIZE*r,u=this.SPACE_SIZE*(r+1),d=new S(.5*this.SPACE_SIZE*e,u);return[d,new S(i,c),new S(o,u),d]}getPyramidCoordinate(e,r){return(e+r)%2==1?this.getDownwardPyramidCoordinate(e,r):this.getUpwardPyramidCoordinate(e,r)}getDownwardPyramidCoordinate(e,r){const s=this.SPACE_SIZE*e/2,i=this.SPACE_SIZE*r,o=s+", "+i,c=s+this.SPACE_SIZE+", "+i,u=s+this.SPACE_SIZE/2+", "+(i+this.SPACE_SIZE),d=s+this.SPACE_SIZE/2+", "+(i+this.SPACE_SIZE/2);return o+","+u+","+d+","+o+","+d+","+c+","+o+","+c+","+u+","+d+","+c}getUpwardPyramidCoordinate(e,r){const s=this.SPACE_SIZE*e/2,i=(r+1)*this.SPACE_SIZE,o=s+", "+i,c=s+this.SPACE_SIZE+", "+i,u=s+this.SPACE_SIZE/2+", "+(i-this.SPACE_SIZE),d=s+this.SPACE_SIZE/2+", "+(i-this.SPACE_SIZE/2);return o+","+u+","+d+","+o+","+d+","+c+","+o+","+c+","+u+","+d+","+c}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=Mr(n)))(r||n)}}(),n.\u0275cmp=dt({type:n,selectors:[["ng-component"]],features:[l],decls:0,vars:0,template:function(e,r){},encapsulation:2}),n})(),Um=(()=>{class n{}return n.INVALID_DISTANCE=()=>$localize`Your piece must land on one of the closest six triangles with the same color as the triangle on which the piece is.`,n.NOT_ENOUGH_TILES_TO_EXCHANGE=()=>$localize`You do not have enough tiles to exchange in order to capture this piece. Pick one of your piece and move it.`,n.FIRST_CLICK_SHOULD_NOT_BE_NULL=()=>$localize`Your first click must be on the piece that you want to move, or on a piece of your opponent that you want to exchange against two tiles.`,n.CANNOT_CAPTURE_FROM_EMPTY=()=>$localize`You cannot capture from an empty space.`,n})();class gr{constructor(t,e){this.direction=t,this.str=e}static fromCoords(t,e){const r=t.getVectorToward(e),s=gr.STEPS.findIndex(i=>i.direction.equals(r));if(-1===s)throw new Error(Um.INVALID_DISTANCE());return gr.STEPS[s]}equals(t){return this===t}toString(){return this.str}}gr.LEFT=new gr(new Bt(-2,0),"LEFT"),gr.UP_LEFT=new gr(Ne.UP_LEFT,"UP_LEFT"),gr.UP_RIGHT=new gr(Ne.UP_RIGHT,"UP_RIGHT"),gr.RIGHT=new gr(new Bt(2,0),"RIGHT"),gr.DOWN_LEFT=new gr(Ne.DOWN_LEFT,"DOWN_LEFT"),gr.DOWN_RIGHT=new gr(Ne.DOWN_RIGHT,"DOWN_RIGHT"),gr.STEPS=[gr.LEFT,gr.UP_LEFT,gr.UP_RIGHT,gr.RIGHT,gr.DOWN_LEFT,gr.DOWN_RIGHT];class Nr extends Fi{constructor(t,e,r,s){super(),this.start=t,this.step=e,this.landingCoord=r,this.capture=s}static fromMovement(t,e){if(t.isNotInRange(15,10))throw new Error("Starting coord cannot be out of range (width: 15, height: 10).");const r=new S(t.x+e.direction.x,t.y+e.direction.y);if(r.isNotInRange(15,10))throw new Error("Landing coord cannot be out of range (width: 15, height: 10).");return new Nr(T.of(t),T.of(e),T.of(r),T.empty())}static fromTilesExchange(t){if(t.isNotInRange(15,10))throw new Error("Captured coord cannot be out of range (width: 15, height: 10).");return new Nr(T.empty(),T.empty(),T.empty(),T.of(t))}static fromCoordToCoord(t,e){const r=gr.fromCoords(t,e);return Nr.fromMovement(t,r)}isTileExchange(){return this.capture.isPresent()}toString(){return this.isTileExchange()?"CoerceoMove("+this.capture.get().toString()+")":"CoerceoMove("+this.start.get().toString()+" > "+this.step.get().toString()+" > "+this.landingCoord.get().toString()+")"}equals(t){return!(!this.capture.equals(t.capture)||!this.start.equals(t.start)||!this.step.equals(t.step))}}Nr.tileExchangeEncoder=Nt.tuple([S.encoder],n=>[n.capture.get()],n=>Nr.fromTilesExchange(n[0])),Nr.movementEncoder=Nt.tuple([S.encoder,S.encoder],n=>[n.start.get(),n.landingCoord.get()],n=>Nr.fromCoordToCoord(n[0],n[1])),Nr.encoder=Nt.disjunction(Nr.tileExchangeEncoder,Nr.movementEncoder,n=>n.isTileExchange());class Hc{static getNeighbors(t){let e;const r=new S(t.x-1,t.y),s=new S(t.x+1,t.y);return e=(t.x+t.y)%2==1?[r,s,new S(t.x,t.y-1)]:[r,s,new S(t.x,t.y+1)],e}static getFakeNeighbors(t){return new S(t.x,(t.x+t.y)%2==1?t.y+1:t.y-1)}static getCommonNeighbor(t,e){const r=Hc.getNeighbors(t),s=Hc.getNeighbors(e);let i=0;for(;i<r.length;){const o=r[i];let c=0;for(;c<s.length;){if(o.equals(s[c]))return T.of(o);c++}i++}return T.empty()}static isSpaceDark(t){return(t.x+t.y)%2==0}}class O5 extends Br{static getEmptyNeighbors(t,e,r){const s=[];for(const i of Hc.getNeighbors(e))i.isInRange(t[0].length,t.length)&&t[i.y][i.x]===r&&s.push(i);return s}getEmptyNeighbors(t,e){return O5.getEmptyNeighbors(this.board,t,e)}}class b1 extends O5{constructor(t,e,r,s){super(t,e),this.tiles=r,this.captures=s}static getTilesUpperLeftCoord(t){const e=t.x-t.x%3;let r=t.y;return r-=e%2==0?t.y%2:(t.y+1)%2,new S(e,r)}static getPresentNeighborEntrances(t){return[new S(t.x+1,t.y-1),new S(t.x+3,t.y+0),new S(t.x+3,t.y+1),new S(t.x+1,t.y+2),new S(t.x-1,t.y+1),new S(t.x-1,t.y+0)].filter(b1.isInRange)}static getInitialState(){const t=ke.EMPTY,e=ke.UNREACHABLE,r=ke.ZERO,s=ke.ONE;return new b1([[e,e,e,e,e,e,r,t,r,e,e,e,e,e,e],[e,e,e,t,t,r,t,t,t,r,t,t,e,e,e],[t,s,t,s,t,t,r,t,r,t,t,s,t,s,t],[s,t,t,t,s,t,t,t,t,t,s,t,t,t,s],[t,s,t,s,t,t,t,t,t,t,t,s,t,s,t],[t,r,t,r,t,t,t,t,t,t,t,r,t,r,t],[r,t,t,t,r,t,t,t,t,t,r,t,t,t,r],[t,r,t,r,t,t,s,t,s,t,t,r,t,r,t],[e,e,e,t,t,s,t,t,t,s,t,t,e,e,e],[e,e,e,e,e,e,s,t,s,e,e,e,e,e,e]],0,[0,0],[0,0])}applyLegalMovement(t){Q(b1.VERBOSE,{coerceoState_applyLegalMovement:{object:this,move:t}});const e=t.start.get(),r=t.landingCoord.get(),s=this.getCopiedBoard();return s[r.y][r.x]=ke.ofPlayer(this.getCurrentPlayer()),s[e.y][e.x]=ke.EMPTY,new b1(s,this.turn,this.tiles,this.captures)}doMovementCaptures(t){Q(b1.VERBOSE,{coerceoState_doMovementCaptures:{object:this,move:t}});const e=this.getCapturedNeighbors(t.landingCoord.get());let r=this;for(const s of e)r=r.capture(s);return r}getCapturedNeighbors(t){const e=this.getCurrentOpponent();return Hc.getNeighbors(t).filter(s=>!s.isNotInRange(15,10)&&!!this.getPieceAt(s).is(e)&&this.isSurrounded(s))}isSurrounded(t){return 0===this.getEmptyNeighbors(t,ke.EMPTY).length}capture(t){Q(b1.VERBOSE,{coerceoState_captureIfNeeded:{object:this,coord:t}});const e=this.getCopiedBoard(),r=[this.captures[0],this.captures[1]];return Q(b1.VERBOSE,t.toString()+" has been captured"),e[t.y][t.x]=ke.EMPTY,r[this.getCurrentPlayer().value]+=1,new b1(e,this.turn,this.tiles,r)}removeTilesIfNeeded(t,e){Q(b1.VERBOSE,{coerceoState_removeTilesIfNeeded:{object:this,piece:t,countTiles:e}});let r=this;const s=b1.getTilesUpperLeftCoord(t);if(this.isTileEmpty(s)&&this.isDeconnectable(s)){r=this.deconnectTile(s,e);const i=b1.getPresentNeighborEntrances(s);for(const o of i){const c=r.getPieceAt(o);c===ke.EMPTY?r=r.removeTilesIfNeeded(o,e):c.is(this.getCurrentOpponent())&&r.isSurrounded(o)&&(r=r.capture(o))}}return r}isTileEmpty(t){Pe(this.getPieceAt(t)!==ke.UNREACHABLE,"Should not call isTileEmpty on removed tile");for(let e=0;e<2;e++)for(let r=0;r<3;r++){const s=t.getNext(new Bt(r,e),1);if(this.getPieceAt(s)!==ke.EMPTY)return!1}return!0}isDeconnectable(t){const e=this.getPresentNeighborTilesRelativeIndexes(t);if(e.length>3)return!1;let r=0;for(let s=1;s<e.length;s++)!1===this.areNeighbor(e[s-1],e[s])&&(r+=1);return!1===this.areNeighbor(e[0],e[e.length-1])&&(r+=1),r<=1}areNeighbor(t,e){return t+1===e||0===t&&5===e}getPresentNeighborTilesRelativeIndexes(t){const e=[];let r=T.empty();for(let s=0;s<6;s++){const o=t.getNext(b1.NEIGHBORS_TILES_DIRECTIONS[s],1);o.isInRange(15,10)&&this.getPieceAt(o)!==ke.UNREACHABLE&&(r.isAbsent()&&(r=T.of(s)),e.push(s-r.get()))}return e}deconnectTile(t,e){Q(b1.VERBOSE,{coerceoState_deconnectTile:{object:this,tileUpperLeft:t,countTiles:e}});const r=this.getCopiedBoard(),s=t.x,i=t.y;for(let c=0;c<2;c++)for(let u=0;u<3;u++)r[i+c][s+u]=ke.UNREACHABLE;const o=[this.tiles[0],this.tiles[1]];return e&&(o[this.getCurrentPlayer().value]+=1),new b1(r,this.turn,o,this.captures)}getLegalLandings(t){const e=[];for(const r of gr.STEPS){const s=t.getNext(r.direction,1);this.isOnBoard(s)&&this.getPieceAt(s)===ke.EMPTY&&e.push(s)}return e}getPiecesByFreedom(){const t=[[0,0,0,0],[0,0,0,0]];for(let e=0;e<10;e++)for(let r=0;r<15;r++){const s=this.board[e][r];if(s.isPlayer()){const i=this.getEmptyNeighbors(new S(r,e),ke.EMPTY).length;t[s.value][i]=t[s.value][i]+1}}return t}}b1.VERBOSE=!1,b1.NEIGHBORS_TILES_DIRECTIONS=[new Bt(0,-2),new Bt(3,-1),new Bt(3,1),new Bt(0,2),new Bt(-3,1),new Bt(-3,-1)],b1.isInRange=n=>n.isInRange(15,10);let t3e=(()=>{class n extends L1{applyLegalMove(e,r,s){return e.isTileExchange()?this.applyLegalTileExchange(e,r):this.applyLegalMovement(e,r)}applyLegalTileExchange(e,r){const s=r.getCopiedBoard(),i=e.capture.get();s[i.y][i.x]=ke.EMPTY;const o=[r.captures[0],r.captures[1]];o[r.getCurrentPlayer().value]+=1;const c=[r.tiles[0],r.tiles[1]];c[r.getCurrentPlayer().value]-=2;const u=new b1(s,r.turn,c,o),d=u.removeTilesIfNeeded(i,!1),g=new b1(d.getCopiedBoard(),d.turn+1,d.tiles,d.captures);return Q(n.VERBOSE,{coerceoRules_applyLegalTileExchange:{a_initialState:r,afterCapture:u,afterTileRemoval:d,resultingState:g}}),g}applyLegalMovement(e,r){const s=r.applyLegalMovement(e),i=s.removeTilesIfNeeded(e.start.get(),!0),o=i.doMovementCaptures(e),c=new b1(o.board,r.turn+1,o.tiles,o.captures);return Q(n.VERBOSE,{ab_state:r,afterMovement:s,afterTilesRemoved:i,afterCaptures:o,resultingState:c}),c}isLegal(e,r){return e.isTileExchange()?this.isLegalTileExchange(e,r):this.isLegalMovement(e,r)}isLegalTileExchange(e,r){if(r.tiles[r.getCurrentPlayer().value]<2)return R.failure(Um.NOT_ENOUGH_TILES_TO_EXCHANGE());const s=r.getPieceAt(e.capture.get());return s===ke.UNREACHABLE||s===ke.EMPTY?R.failure(Um.CANNOT_CAPTURE_FROM_EMPTY()):s.is(r.getCurrentPlayer())?R.failure(et.CANNOT_SELF_CAPTURE()):R.SUCCESS}isLegalMovement(e,r){if(r.getPieceAt(e.start.get())===ke.UNREACHABLE){const o="Cannot start with a coord outside the board "+e.start.get().toString()+".";return R.failure(o)}if(r.getPieceAt(e.landingCoord.get())===ke.UNREACHABLE){const o="Cannot end with a coord outside the board "+e.landingCoord.get().toString()+".";return R.failure(o)}const s=r.getPieceAt(e.start.get());return s===ke.EMPTY?R.failure(et.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):s.is(r.getCurrentOpponent())?R.failure(et.CANNOT_CHOOSE_OPPONENT_PIECE()):r.getPieceAt(e.landingCoord.get()).is(r.getCurrentPlayer())?R.failure(et.MUST_LAND_ON_EMPTY_SPACE()):R.SUCCESS}static getGameStatus(e){const r=e.gameState;return r.captures[0]>=18?xe.ZERO_WON:r.captures[1]>=18?xe.ONE_WON:xe.ONGOING}getGameStatus(e){return n.getGameStatus(e)}}return n.VERBOSE=!1,n})();class n3e extends xs{getListMoves(t){let e=this.getListExchanges(t);return e=e.concat(this.getListMovement(t)),this.putCaptureFirst(t,e)}getListExchanges(t){const e=[],r=t.gameState,s=r.getCurrentPlayer().value,i=ke.ofPlayer(r.getCurrentOpponent());if(r.tiles[s]<2)return e;for(let o=0;o<10;o++)for(let c=0;c<15;c++){const u=new S(c,o);if(r.getPieceAt(u)===i){const d=Nr.fromTilesExchange(u);e.push(d)}}return e}getListMovement(t){const e=[],r=t.gameState,s=r.getCurrentPlayer();for(let i=0;i<10;i++)for(let o=0;o<15;o++){const c=new S(o,i);if(r.getPieceAt(c).is(s)){const u=r.getLegalLandings(c);for(const d of u){const g=Nr.fromCoordToCoord(c,d);e.push(g)}}}return e}getMetrics(t){const e=t.gameState,r=e.getPiecesByFreedom(),s=this.getPiecesScore(r);return[2*e.captures[0]+s[0],2*e.captures[1]+s[1]]}getPiecesScore(t){return[this.getPlayerPiecesScore(t[0]),this.getPlayerPiecesScore(t[1])]}getPlayerPiecesScore(t){return 3*t[0]+1*t[1]+3*t[2]+3*t[3]}putCaptureFirst(t,e){return Xe.sortByDescending(e,r=>this.moveCapturesList(t,r).length),e}moveCapturesList(t,e){return e.isTileExchange()?[e.capture.get()]:t.gameState.applyLegalMovement(e).removeTilesIfNeeded(e.start.get(),!0).getCapturedNeighbors(e.landingCoord.get())}}let j4t=(()=>{class n extends n3e{getMetrics(e){const r=e.gameState,s=this.getPiecesMap(r),i=this.getThreatMap(r,s),o=this.filterThreatMap(i,r),c=[0,0];for(const u of B.PLAYERS){for(const d of s.get(u).get())o.get(d).isPresent()?c[u.value]+=n.SCORE_BY_THREATENED_PIECE:c[u.value]+=n.SCORE_BY_SAFE_PIECE;c[u.value]+=r.tiles[u.value]}return c}getPiecesMap(e){const r=new Un,s=[],i=[];for(let o=0;o<10;o++)for(let c=0;c<15;c++){const u=new S(c,o),d=e.getPieceAt(u);d===ke.ZERO?s.push(u):d===ke.ONE&&i.push(u)}return r.set(B.ZERO,new Ar(s)),r.set(B.ONE,new Ar(i)),r}getThreatMap(e,r){const s=new Un;for(const i of B.PLAYERS)for(const o of r.get(i).get()){const c=this.getThreat(o,e);c.isPresent()&&s.set(o,c.get())}return s}getThreat(e,r){const i=B.of(r.getPieceAt(e).value).getOpponent();let o=T.empty(),c=T.empty(),u=[];const d=Hc.getNeighbors(e).filter(g=>g.isInRange(15,10));for(const g of d){const m=r.getPieceAt(g);if(m.is(i))u.push(g),this.tileCouldBeRemovedThisTurn(g,r,i)&&(c=T.of(g));else if(m===ke.EMPTY){if(o.isPresent())return T.empty();o=T.of(g)}}if(o.isPresent()){const g=[];for(const m of gr.STEPS){const y=o.get().getNext(m.direction,1);y.isInRange(15,10)&&r.getPieceAt(y).is(i)&&!1===u.some(b=>b.equals(y))&&g.push(y)}if(g.length>0)return T.of(new SP(new Ar(u),new Ar(g)))}if(c.isPresent()){u=u.filter(m=>m.equals(c.get()));const g=new Ar(u);return T.of(new SP(g,new Ar([c.get()])))}return T.empty()}tileCouldBeRemovedThisTurn(e,r,s){const i=s.getOpponent();if(!1===r.isDeconnectable(e))return!1;let c=T.empty();const u=b1.getTilesUpperLeftCoord(e);for(let d=0;d<2;d++)for(let g=0;g<3;g++){const m=u.getNext(new Bt(g,d),1);if(r.getPieceAt(m).is(s)){if(!this.pieceCouldLeaveTheTile(m,r))return!1;c=T.of(m)}else if(r.getPieceAt(m).is(i))return!1}return c.isPresent()}pieceCouldLeaveTheTile(e,r){const s=b1.getTilesUpperLeftCoord(e);for(const i of gr.STEPS){const o=e.getNext(i.direction,1),c=b1.getTilesUpperLeftCoord(o);if(!1===s.equals(c)&&r.getPieceAt(o)===ke.EMPTY)return!0}return!1}filterThreatMap(e,r){const s=new Un,i=e.listKeys(),o=i.filter(u=>r.getPieceAt(u).is(r.getCurrentPlayer())),c=new Ar(i.filter(u=>r.getPieceAt(u).is(r.getCurrentOpponent())));for(const u of o){const d=e.get(u).get();let g=T.empty();for(const m of d.directThreats)if(!1===c.contains(m)){const y=[];for(const b of d.mover)!1===c.contains(b)&&y.push(b);y.length>0&&(g=T.of(new SP(d.directThreats,new Ar(y))))}g.isPresent()&&s.set(u,g.get())}for(const u of c){const d=e.get(u).get();s.set(u,d)}return s}}return n.SCORE_BY_THREATENED_PIECE=1e3,n.SCORE_BY_SAFE_PIECE=1e6,n})();const pe=ke.EMPTY,U=ke.UNREACHABLE,G1=ke.ZERO,t1=ke.ONE;class r3e extends $1{constructor(){super(...arguments),this.tutorial=[ie.informational($localize`Board and goal of the game`,$localize`Coerceo is played on a board like this, composed of hexagonal tiles, each comprising 6 triangles.
         The triangles are the spaces on which pieces move during the game.
         The tiles can be removed from the board (you will see how later).
         The dark pieces belong to the first player and can only move on the dark spaces,
         while the light pieces belong to the second player and can only move on the light spaces.
         The goal of the game is to capture all of the opponent's pieces.`,b1.getInitialState()),ie.anyMove($localize`Move`,$localize`To move a piece, you need to:
        <ol>
          <li>Click on one of your pieces.</li>
          <li>Click on one of the triangular space highlighted in yellow.</li>
        </ol>
        You can pass through the opponent's pieces.<br/><br/>
        You're playing first, hence you're playing Dark.
        Perform any move.`,b1.getInitialState(),Nr.fromCoordToCoord(new S(3,5),new S(5,5)),$localize`Congratulations! Let's see captures now.`),ie.fromMove($localize`Capture`,$localize`Every piece has three neighboring triangular spaces (2 on the sides).
        When all neighboring spaces except one are occupied, and one opponent moves to that last free space, your piece is captured!
        However, it is possible to place a piece between 3 of the opponent's pieces (or 2 on the side) without being captured.<br/><br/>
        You're playing Light, make a capture.`,new b1([[U,U,U,U,U,U,G1,pe,G1,U,U,U,U,U,U],[U,U,U,G1,pe,pe,pe,pe,pe,G1,pe,pe,U,U,U],[pe,t1,pe,t1,G1,t1,pe,pe,G1,pe,pe,t1,pe,t1,pe],[t1,pe,pe,pe,pe,pe,pe,pe,pe,pe,t1,pe,pe,pe,t1],[pe,t1,pe,t1,pe,pe,pe,pe,pe,pe,pe,t1,pe,t1,pe],[pe,G1,pe,G1,pe,pe,pe,pe,pe,pe,pe,G1,pe,G1,pe],[G1,pe,pe,pe,G1,pe,pe,pe,pe,pe,G1,pe,pe,pe,G1],[pe,G1,pe,G1,pe,pe,t1,pe,t1,pe,pe,G1,pe,G1,pe],[U,U,U,pe,pe,t1,pe,pe,pe,t1,pe,pe,U,U,U],[U,U,U,U,U,U,t1,pe,t1,U,U,U,U,U,U]],3,[0,0],[0,0]),[Nr.fromCoordToCoord(new S(5,2),new S(4,1)),Nr.fromCoordToCoord(new S(3,4),new S(4,3))],$localize`Congratulations!`,$localize`Failed, you have not captured any piece.`),ie.fromMove($localize`Gain a tile`,$localize`When a tile is empty, it can become removable from the board.
        For it to be removable, at least three of its sides must be free, and these should be neighboring sides.
        Note that if one empty tile, neighboring a tile that was just removed, also becomes removable, it will be removed too.
        For example, here, the topmost dark piece will not disconnect its tile when leaving it.
        But, by leaving the bottom left tile, two tiles will be removed.<br/><br/>
        You're playing Dark, perform a move that lets you gain two tiles.`,new b1([[U,U,U,U,U,U,pe,pe,pe,U,U,U,U,U,U],[U,U,U,U,U,U,t1,pe,pe,U,U,U,U,U,U],[pe,pe,pe,U,U,U,pe,pe,pe,U,U,U,U,U,U],[pe,pe,t1,pe,pe,pe,pe,G1,pe,U,U,U,U,U,U],[pe,pe,pe,t1,pe,pe,pe,pe,pe,U,U,U,U,U,U],[pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,G1,U,U,U],[pe,pe,G1,pe,pe,t1,pe,pe,pe,pe,G1,pe,pe,pe,G1],[pe,pe,pe,pe,pe,pe,t1,pe,t1,pe,pe,G1,pe,G1,pe],[U,U,U,pe,pe,t1,pe,pe,pe,t1,pe,pe,U,U,U],[U,U,U,U,U,U,t1,pe,t1,U,U,U,U,U,U]],2,[0,0],[0,0]),[Nr.fromCoordToCoord(new S(2,6),new S(4,6)),Nr.fromCoordToCoord(new S(2,6),new S(3,5)),Nr.fromCoordToCoord(new S(2,6),new S(3,7))],$localize`Congratulations!`,$localize`Failed, you have not gained the two tiles that you could, try again!`),ie.fromMove($localize`Exchanging a tile`,$localize`When you have a tile, you can see it on the left of the board.
        As soon as you have two, you can click on an opponent's piece to capture it immediately instead of moving one of your pieces.
        This will cost you two tiles.
        If any tiles are removed during that turn, nobody will get them.<br/><br/>
        You're playing Light, gain some time and capture the last piece to win directly!`,new b1([[U,U,U,U,U,U,U,U,U,U,U,U,U,U,U],[U,U,U,U,U,U,U,U,U,U,U,U,U,U,U],[U,U,U,U,U,U,U,U,U,U,U,U,U,U,U],[U,U,U,U,U,U,U,U,U,U,U,U,U,U,U],[U,U,U,U,U,U,U,U,U,U,U,U,U,U,U],[U,U,U,pe,pe,G1,U,U,U,U,U,U,U,U,U],[U,U,U,pe,pe,pe,pe,pe,pe,U,U,U,U,U,U],[U,U,U,pe,pe,pe,t1,pe,t1,U,U,U,U,U,U],[U,U,U,pe,pe,t1,pe,pe,pe,U,U,U,U,U,U],[U,U,U,U,U,U,t1,pe,t1,U,U,U,U,U,U]],1,[0,2],[0,0]),[Nr.fromTilesExchange(new S(5,5))],$localize`Congratulations!`,$localize`It's nice to move a piece, but you could have had the opponent's piece immediately by clicking on it!`),ie.fromMove($localize`Special capture`,$localize`When a tile is removed from the board during your turn, some of the opponent's pieces may have lost their last free neighboring space, they will therefore be captured!
        If this happens to one of your piece during your turn, it will however stay on the board.<br/><br/>
        A move that demonstrates both of these things can be done on this board by Light. Try it!`,new b1([[U,U,U,U,U,U,U,U,U,U,U,U,U,U,U],[U,U,U,U,U,U,U,U,U,U,U,U,U,U,U],[U,U,U,U,U,U,U,U,U,U,U,U,U,U,U],[U,U,U,U,U,U,U,U,U,U,U,U,U,U,U],[U,U,U,U,U,U,pe,pe,G1,U,U,U,U,U,U],[U,U,U,pe,pe,G1,pe,pe,pe,U,U,U,U,U,U],[U,U,U,pe,G1,t1,pe,t1,pe,U,U,U,U,U,U],[U,U,U,pe,t1,G1,pe,pe,pe,U,U,U,U,U,U],[U,U,U,pe,pe,t1,U,U,U,U,U,U,U,U,U],[U,U,U,U,U,U,U,U,U,U,U,U,U,U,U]],1,[0,0],[0,0]),[Nr.fromCoordToCoord(new S(7,6),new S(6,5)),Nr.fromCoordToCoord(new S(7,6),new S(8,5))],$localize`Congratulations! See, your piece no longer had any empty neighboring space after you have gained the tile, but it stayed on the board as it was your turn.
        However, the opponent's piece has disappeared because the tile's capture has removed its last empty neighboring space.`,$localize`Failed. Try again.`)]}}function Z4t(n,t){if(1&n&&(F(),X(0,"polygon",10)),2&n){const e=C().index,r=C().index,s=C();w("ngClass",s.getPyramidClass(e,r)),z("points",s.getPyramidCoordinate(e,r))}}function Y4t(n,t){if(1&n&&(F(),X(0,"polygon",12)),2&n){const e=C(2).index,r=C().index,s=C();De("id","empty_",e,"_",r,""),w("ngClass",s.getEmptyClass(e,r)),z("points",s.getTriangleCoordinate(e,r))}}function K4t(n,t){if(1&n&&(F(),x(0,Y4t,1,4,"polygon",11)),2&n){const e=C().index,r=C().index;w("ngIf",C().isEmptySpace(e,r))}}function X4t(n,t){if(1&n&&(F(),X(0,"polygon",13)),2&n){const e=C().index,r=C().index,s=C();De("id","dark_line_",e,"_",r,""),z("points",s.getLineCoordinate(e,r))}}function Q4t(n,t){if(1&n&&(F(),X(0,"polygon",14)),2&n){const e=C().index,r=C().index,s=C();De("id","dark_line_",e,"_",r,""),z("points",s.getLineCoordinate(e,r))}}function J4t(n,t){if(1&n){const e=Oe();F(),O(0,"g",5),ee("click",function(){const i=ue(e).index,o=C().index;return ce(C().onClick(i,o))}),x(1,Z4t,1,2,"polygon",6),x(2,K4t,1,1,"ng-template",null,7,Zn),x(4,X4t,1,3,"polygon",8),x(5,Q4t,1,3,"polygon",9),A()}if(2&n){const e=t.$implicit,r=t.index,s=Bn(3),i=C().index,o=C();De("id","click_",r,"_",i,""),P(1),w("ngIf",o.isPyramid(r,i))("ngIfElse",s),P(3),w("ngIf",e!==o.NONE),P(1),w("ngIf",e!==o.NONE)}}function elt(n,t){if(1&n&&(F(),O(0,"g"),x(1,J4t,6,6,"g",4),A()),2&n){const e=t.$implicit;P(1),w("ngForOf",e)}}function tlt(n,t){if(1&n&&(F(),X(0,"polygon",17)),2&n){const e=t.$implicit;z("points",C(2).getTriangleCoordinate(e.x,e.y))}}function nlt(n,t){if(1&n&&(F(),O(0,"g"),X(1,"polygon",15),x(2,tlt,1,1,"polygon",16),A()),2&n){const e=C();P(1),De("id","selected_",e.chosenCoord.get().x,"_",e.chosenCoord.get().y,""),z("points",e.getTriangleCoordinate(e.chosenCoord.get().x,e.chosenCoord.get().y)),P(1),w("ngForOf",e.possibleLandings)}}function rlt(n,t){if(1&n&&(F(),X(0,"polygon",19)),2&n){const e=C(2);De("id","last_start_",e.lastStart.get().x,"_",e.lastStart.get().y,""),z("points",e.getTriangleCoordinate(e.lastStart.get().x,e.lastStart.get().y))}}function slt(n,t){if(1&n&&(F(),X(0,"polygon",19)),2&n){const e=C(2);De("id","last_end_",e.lastEnd.get().x,"_",e.lastEnd.get().y,""),z("points",e.getTriangleCoordinate(e.lastEnd.get().x,e.lastEnd.get().y))}}function ilt(n,t){if(1&n&&(F(),x(0,rlt,1,3,"polygon",18),x(1,slt,1,3,"polygon",18)),2&n){const e=C();w("ngIf",e.lastStart.isPresent()),P(1),w("ngIf",e.lastEnd.isPresent())}}const olt=function(n){return["base",n]};function alt(n,t){if(1&n&&(F(),O(0,"g",21),X(1,"polygon",22),O(2,"text",23),Tt(3),A()()),2&n){const e=C().$implicit,r=C();w("id","tilesCount"+e),P(1),w("ngClass",T3(8,olt,"player"+e+"-fill")),z("points",r.getTilesCountCoordinate(0===e?0:4.5,0===e?0:6))("stroke",r.lastTurnWasTilesExchange(e)?"yellow":"black"),P(1),z("x",r.SPACE_SIZE/2+r.SPACE_SIZE*(0===e?0:6.4))("y",16+r.SPACE_SIZE/2+r.SPACE_SIZE*(0===e?0:8.5))("font-size",r.SPACE_SIZE/2),P(1),c1(r.tiles[e])}}function clt(n,t){if(1&n&&(F(),O(0,"g"),x(1,alt,4,10,"g",20),A()),2&n){const e=t.$implicit,r=C();P(1),w("ngIf",r.mustShowTilesOf(e))}}const llt=function(){return[0,1]};let ult=(()=>{class n extends e3e{constructor(e){super(e),this.tiles=[0,0],this.NONE=ke.UNREACHABLE,this.chosenCoord=T.empty(),this.lastStart=T.empty(),this.lastEnd=T.empty(),this.possibleLandings=[],this.scores=T.of([0,0]),this.rules=new t3e(b1),this.availableMinimaxes=[new n3e(this.rules,"Normal"),new j4t(this.rules,"Piece > Threat > Tiles")],this.encoder=Nr.encoder,this.tutorial=(new r3e).tutorial,this.SPACE_SIZE=70,this.updateBoard()}updateBoard(){this.chosenCoord=T.empty(),this.state=this.getState(),this.scores=T.of(this.state.captures),this.tiles=this.state.tiles;const e=this.rules.node.move;e.isPresent()?(this.lastStart=e.get().start,this.lastEnd=e.get().landingCoord):(this.lastStart=T.empty(),this.lastEnd=T.empty()),this.board=this.getState().board}showHighlight(){this.possibleLandings=this.state.getLegalLandings(this.chosenCoord.get())}cancelMoveAttempt(){this.chosenCoord=T.empty(),this.possibleLandings=[]}onClick(e,r){var s=this;return I(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());const o=new S(e,r),c=s.state.getCurrentPlayer();return s.chosenCoord.equalsValue(o)?(s.cancelMoveAttempt(),R.SUCCESS):s.chosenCoord.isAbsent()||s.state.getPieceAt(o).is(c)?s.firstClick(o):s.secondClick(o)})()}firstClick(e){var r=this;return I(function*(){const s=r.state.getPieceAt(e);if(s.is(r.state.getCurrentOpponent())){const i=Nr.fromTilesExchange(e);return r.chooseMove(i,r.state,r.state.captures)}return s.is(r.state.getCurrentPlayer())?(r.chosenCoord=T.of(e),r.showHighlight(),R.SUCCESS):r.cancelMove(Um.FIRST_CLICK_SHOULD_NOT_BE_NULL())})()}secondClick(e){var r=this;return I(function*(){if(r.possibleLandings.some(s=>s.equals(e))){const s=Nr.fromCoordToCoord(r.chosenCoord.get(),e);return r.chooseMove(s,r.state,r.state.captures)}return r.cancelMove(Um.INVALID_DISTANCE())})()}isPyramid(e,r){return this.board[r][e].isPlayer()||this.wasOpponent(e,r)}wasOpponent(e,r){const s=this.rules.node.mother;return s.isPresent()&&s.get().gameState.getPieceAtXY(e,r).is(s.get().gameState.getCurrentOpponent())}getPyramidClass(e,r){const s=this.board[r][e];return s===ke.ZERO?this.getPlayerClass(B.ZERO):s===ke.ONE?this.getPlayerClass(B.ONE):"captured-fill"}isEmptySpace(e,r){return this.board[r][e]===ke.EMPTY||this.wasRemoved(e,r)}wasRemoved(e,r){const i=this.rules.node.mother;if(this.board[r][e]===ke.UNREACHABLE&&i.isPresent()){const o=i.get().gameState.getPieceAtXY(e,r);return o===ke.EMPTY||o.is(i.get().gameState.getCurrentPlayer())}return!1}getEmptyClass(e,r){return this.board[r][e]===ke.EMPTY?(e+r)%2==1?"background":"background2":"captured-alternate-fill"}getTilesCountCoordinate(e,r){const s=100*e,i=100*r,o=s+25;return o+", "+i+", "+(s+75)+", "+i+", "+(s+100)+", "+(i+50)+", "+(s+75)+", "+(i+100)+", "+(s+25)+", "+(i+100)+", "+(s+0)+", "+(i+50)+", "+o+", "+i}getLineCoordinate(e,r){const s=this.getTriangleCornerCoords(e,r);return e%3==0?s[0].x+","+s[0].y+","+s[1].x+","+s[1].y:e%3==1?s[0].x+","+s[0].y+","+s[2].x+","+s[2].y:s[1].x+","+s[1].y+","+s[2].x+","+s[2].y}mustShowTilesOf(e){return this.tiles[e]>0||this.lastTurnWasTilesExchange(e)}lastTurnWasTilesExchange(e){return!this.rules.node.mother.isAbsent()&&this.getPreviousState().tiles[e]>this.tiles[e]}}return n.\u0275fac=function(e){return new(e||n)(J(En))},n.\u0275cmp=dt({type:n,selectors:[["app-coerceo"]],features:[l],decls:6,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf","ngIfElse"],["lastMove",""],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["class","base mid-stroke","stroke-linecap","round",3,"ngClass",4,"ngIf","ngIfElse"],["emptySpace",""],["class","base",3,"id",4,"ngIf"],["class","white-stroke",3,"id",4,"ngIf"],["stroke-linecap","round",1,"base","mid-stroke",3,"ngClass"],["class","base small-stroke","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["stroke-linecap","round",1,"base","small-stroke",3,"id","ngClass"],[1,"base",3,"id"],[1,"white-stroke",3,"id"],[1,"base","no-fill","selected-stroke",3,"id"],["class","base no-fill selectable-stroke",4,"ngFor","ngForOf"],[1,"base","no-fill","selectable-stroke"],["class","base no-fill last-move-stroke",3,"id",4,"ngIf"],[1,"base","no-fill","last-move-stroke",3,"id"],[3,"id",4,"ngIf"],[3,"id"],["stroke-linecap","round",3,"ngClass"],["id","playerZeroTilesCount",1,"text-giant"]],template:function(e,r){if(1&e&&(F(),O(0,"svg",0),x(1,elt,2,1,"g",1),x(2,nlt,3,4,"g",2),x(3,ilt,2,2,"ng-template",null,3,Zn),x(5,clt,2,1,"g",1),A()),2&e){const s=Bn(4);z("viewBox","-5 -5 "+(10+8*r.SPACE_SIZE)+" "+(10+10*r.SPACE_SIZE)),P(1),w("ngForOf",r.board),P(1),w("ngIf",r.chosenCoord.isPresent())("ngIfElse",s),P(3),w("ngForOf",J1(5,llt))}},dependencies:[fn,On,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class flt extends xs{getListMoves(t){return this.sortByNumberOfJump(t.gameState.turn<40?this.getListMovesDrop(t.gameState):this.getListMovesAfterDrop(t.gameState))}sortByNumberOfJump(t){return t.sort((e,r)=>{const s=e.isDrop()?1:e.isSimple()?2:e.coords.length;return(r.isDrop()?1:r.isSimple()?2:r.coords.length)-s})}getListMovesDrop(t){const e=[],r=qt.CENTRAL_ZONE_TOP_LEFT,s=qt.CENTRAL_ZONE_BOTTOM_RIGHT;for(let i=r.y;i<=s.y;i++)for(let o=r.x;o<=s.x;o++)t.getPieceAtXY(o,i)===he.NONE&&e.push(l8.from(new S(o,i)).get());return e}getListMovesAfterDrop(t){let e=[];const r=t.getCurrentPlayer();for(let s=0;s<qt.HEIGHT;s++)for(let i=0;i<qt.WIDTH;i++){const o=new S(i,s);t.getPieceAt(o)===r&&(e=e.concat(this.getListSimpleMoves(t,o)),e=e.concat(this.getListJumps(t,o)))}return e}getListSimpleMoves(t,e){const r=[],s=[new S(e.x+1,e.y),new S(e.x-1,e.y),new S(e.x,e.y+1),new S(e.x,e.y-1),new S(e.x+1,e.y+1),new S(e.x+1,e.y-1),new S(e.x-1,e.y+1),new S(e.x-1,e.y-1)];for(const i of s){const o=u8.from(e,i);o.isSuccess()&&Ya.get().simpleMoveLegality(o.get(),t).isSuccess()&&r.push(o.get())}return r}getListJumps(t,e){const r=new zt;for(const s of Ya.get().jumpTargetsFrom(e)){const i=R3.from([e,s]).get();Ya.get().jumpLegality(i,t).isSuccess()&&(r.add(i),r.addAll(this.getListJumpStartingFrom(t,i)))}return r.toList()}getListJumpStartingFrom(t,e){const r=Ya.get().nextJumps(e,t),s=new zt(r);for(const i of r)s.addAll(this.getListJumpStartingFrom(t,i));return s}getMetrics(t){const e=t.gameState,r=[0,0];for(let s=0;s<qt.HEIGHT;s++)for(let i=0;i<qt.WIDTH;i++){const o=new S(i,s),c=e.getPieceAt(o);if(c.isPlayer())if(e.isShelter(o))r[c.value]+=20;else{let u=100;for(const d of qt.ALL_SHELTERS)if(e.getPieceAt(d)===he.NONE){const g=o.getOrthogonalDistance(d);u=Math.min(u,g)}r[c.value]-=u}}return r}}function dlt(n,t){if(1&n){const e=Oe();F(),O(0,"rect",9),ee("click",function(){ue(e);const s=C().$implicit;return ce(C(2).onClick(s.coord))}),A()}if(2&n){const e=C().$implicit,r=C(2);z("x",1.5*r.STROKE_WIDTH+r.SPACE_SIZE*e.coord.x+r.STROKE_WIDTH)("y",1.5*r.STROKE_WIDTH+r.SPACE_SIZE*e.coord.y+r.STROKE_WIDTH)("width",r.SPACE_SIZE-3*r.STROKE_WIDTH)("height",r.SPACE_SIZE-3*r.STROKE_WIDTH)}}function hlt(n,t){if(1&n){const e=Oe();F(),O(0,"circle",6),ee("click",function(){ue(e);const s=C().$implicit;return ce(C(2).onClick(s.coord))}),A()}if(2&n){const e=C(),r=e.index,s=e.$implicit,i=C().index,o=C();De("id","piece_",r,"_",i,""),w("ngClass",s.pieceClasses),z("r",o.PIECE_RADIUS)("cx",o.SPACE_SIZE*r+o.STROKE_WIDTH+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*i+o.STROKE_WIDTH+o.SPACE_SIZE/2)}}function plt(n,t){if(1&n){const e=Oe();F(),O(0,"g")(1,"rect",6),ee("click",function(){const i=ue(e).$implicit;return ce(C(2).onClick(i.coord))}),A(),x(2,dlt,1,4,"rect",7),x(3,hlt,1,6,"circle",8),A()}if(2&n){const e=t.$implicit,r=t.index,s=C().index,i=C();P(1),De("id","click_",r,"_",s,""),w("ngClass",e.squareClasses),z("x",i.SPACE_SIZE*r+i.STROKE_WIDTH)("y",i.SPACE_SIZE*s+i.STROKE_WIDTH)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),P(1),w("ngIf",e.isShelter),P(1),w("ngIf",e.hasPiece)}}function glt(n,t){if(1&n&&(F(),O(0,"g"),x(1,plt,4,9,"g",1),A()),2&n){const e=t.$implicit;P(1),w("ngForOf",e)}}function mlt(n,t){if(1&n){const e=Oe();F(),O(0,"g")(1,"rect",10),ee("click",function(){const i=ue(e).$implicit;return ce(C().onClick(i))}),A()()}if(2&n){const e=t.$implicit,r=C();P(1),w("ngClass",r.viewInfo.boardInfo[e.y][e.x].shelterClasses),z("x",r.SPACE_SIZE*e.x+r.STROKE_WIDTH)("y",r.SPACE_SIZE*e.y+r.STROKE_WIDTH)("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)}}function _lt(n,t){if(1&n&&(F(),X(0,"circle",11)),2&n){const e=t.$implicit,r=C();y1("id","sidePiece_0_",e,""),z("cx",-r.PIECE_RADIUS)("cy",1670-e*r.PIECE_RADIUS)("r",r.PIECE_RADIUS-5)}}function vlt(n,t){if(1&n&&(F(),X(0,"circle",12)),2&n){const e=t.$implicit,r=C();y1("id","sidePiece_1_",e,""),z("cx",1715+r.PIECE_RADIUS)("cy",1670-e*r.PIECE_RADIUS)("r",r.PIECE_RADIUS-5)}}function Clt(n,t){if(1&n&&(F(),X(0,"rect",13)),2&n){const e=C();z("x",e.SPACE_SIZE*e.CENTRAL_ZONE_START.x+e.STROKE_WIDTH)("y",e.SPACE_SIZE*e.CENTRAL_ZONE_START.y+e.STROKE_WIDTH)("width",e.CENTRAL_ZONE_SIZE.x*e.SPACE_SIZE)("height",e.CENTRAL_ZONE_SIZE.y*e.SPACE_SIZE)}}let ylt=(()=>{class n extends o8{constructor(e){super(e),this.ALL_SHELTERS=qt.ALL_SHELTERS,this.CENTRAL_ZONE_START=qt.CENTRAL_ZONE_TOP_LEFT,this.CENTRAL_ZONE_SIZE=new Bt(qt.CENTRAL_ZONE_BOTTOM_RIGHT.x-qt.CENTRAL_ZONE_TOP_LEFT.x+1,qt.CENTRAL_ZONE_BOTTOM_RIGHT.y-qt.CENTRAL_ZONE_TOP_LEFT.y+1),this.viewInfo={dropPhase:!0,boardInfo:[],victory:[],lastMoveArrow:"",sidePieces:[20,20]},this.selected=T.empty(),this.jumpInConstruction=T.empty(),this.PIECE_RADIUS=this.SPACE_SIZE/2-this.STROKE_WIDTH,this.rules=Ya.get(),this.availableMinimaxes=[new flt(this.rules,"ConspirateursMinimax")],this.encoder=W4t,this.tutorial=(new Xce).tutorial}ngOnInit(){this.updateBoard()}updateBoard(){this.updateViewInfo()}updateViewInfo(){const e=this.getState();this.viewInfo.dropPhase=e.isDropPhase(),this.viewInfo.boardInfo=[],this.viewInfo.lastMoveArrow="";for(let r=0;r<qt.HEIGHT;r++){this.viewInfo.boardInfo.push([]);for(let s=0;s<qt.WIDTH;s++){const i=new S(s,r),o=e.getPieceAt(i),c={coord:i,squareClasses:[],shelterClasses:[],pieceClasses:[this.getPlayerClass(o)],hasPiece:o.isPlayer(),isShelter:!1,isOccupiedShelter:!1};this.viewInfo.boardInfo[r].push(c)}}this.viewInfo.sidePieces=e.getSidePieces(),this.updateOccupiedShelters(),this.updateSelected(),this.updateVictory()}updateOccupiedShelters(){for(const e of qt.ALL_SHELTERS){const r=this.viewInfo.boardInfo[e.y][e.x];r.isShelter=!0,r.hasPiece&&r.shelterClasses.push("selectable-stroke")}}updateSelected(){if(this.selected.isPresent())if(this.jumpInConstruction.isPresent()){const e=this.jumpInConstruction.get(),r=e.getStartingCoord(),s=e.getEndingCoord();this.viewInfo.boardInfo[r.y][r.x].hasPiece=!1,this.viewInfo.boardInfo[s.y][s.x].pieceClasses=[this.getPlayerClass(this.getCurrentPlayer()),"selected-stroke"],this.viewInfo.boardInfo[s.y][s.x].hasPiece=!0;for(const i of e.coords)this.viewInfo.boardInfo[i.y][i.x].squareClasses.push("moved-fill")}else{const e=this.selected.get();this.viewInfo.boardInfo[e.y][e.x].pieceClasses.push("selected-stroke")}}updateVictory(){const e=this.getState(),r=Ya.get().getGameStatus(this.rules.node);if(!0===r.isEndGame)for(const s of qt.ALL_SHELTERS)e.getPieceAt(s)===r.winner&&this.viewInfo.boardInfo[s.y][s.x].squareClasses.push("victory-fill")}showLastMove(e){if(e.isDrop())this.viewInfo.boardInfo[e.coord.y][e.coord.x].squareClasses.push("moved-fill");else if(e.isSimple())this.viewInfo.boardInfo[e.getStart().y][e.getStart().x].squareClasses.push("moved-fill"),this.viewInfo.boardInfo[e.getEnd().y][e.getEnd().x].squareClasses.push("moved-fill");else{this.viewInfo.lastMoveArrow="";for(const r of e.coords)this.viewInfo.boardInfo[r.y][r.x].squareClasses.push("moved-fill"),this.viewInfo.lastMoveArrow+=r.x*this.SPACE_SIZE+this.SPACE_SIZE/2+this.STROKE_WIDTH,this.viewInfo.lastMoveArrow+=" ",this.viewInfo.lastMoveArrow+=r.y*this.SPACE_SIZE+this.SPACE_SIZE/2+this.STROKE_WIDTH,this.viewInfo.lastMoveArrow+=" "}}cancelMoveAttempt(){this.jumpInConstruction=T.empty(),this.selected=T.empty(),this.updateBoard()}onClick(e){var r=this;return I(function*(){const s=r.canUserPlay("#click_"+e.x+"_"+e.y);if(s.isFailure())return r.cancelMove(s.getReason());const i=r.getState();if(i.getPieceAt(e)===r.getCurrentPlayer())return r.selected.equalsValue(e)?r.cancelMoveAttempt():(r.selected=T.of(e),r.jumpInConstruction=T.empty()),r.updateViewInfo(),R.SUCCESS;if(r.jumpInConstruction.isPresent())return r.constructJump(e);if(r.selected.isPresent())return r.selectNextCoord(e);if(i.isDropPhase()){const o=l8.from(e);return Pe(o.isSuccess(),"ConspirateursMove should be valid by construction"),r.chooseMove(o.get(),i)}return r.cancelMove(et.MUST_CHOOSE_PLAYER_PIECE())})()}constructJump(e){var r=this;return I(function*(){const s=r.jumpInConstruction.get(),i=r.getState();if(e.equals(s.getEndingCoord()))return r.chooseMove(s,i);{const o=s.addJump(e);if(o.isFailure())return r.cancelMove(o.getReason());const c=r.rules.jumpLegality(o.get(),i);return c.isFailure()?r.cancelMove(c.getReason()):r.updateJump(o.get())}})()}updateJump(e){var r=this;return I(function*(){const s=r.getState();return r.rules.jumpHasPossibleNextTargets(e,s)?(r.jumpInConstruction=T.of(e),r.updateViewInfo(),R.SUCCESS):r.chooseMove(e,s)})()}selectNextCoord(e){var r=this;return I(function*(){const s=r.selected.get(),i=u8.from(s,e);if(i.isSuccess())return r.chooseMove(i.get(),r.getState());{const o=R3.from([s,e]);return o.isFailure()?r.cancelMove(o.getReason()):r.updateJump(o.get())}})()}}return n.\u0275fac=function(e){return new(e||n)(J(En))},n.\u0275cmp=dt({type:n,selectors:[["app-conspirateurs"]],features:[l],decls:7,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-100 0 1915 1715","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base mid-stroke player0-fill",3,"id",4,"ngFor","ngForOf"],["class","base mid-stroke player1-fill",3,"id",4,"ngFor","ngForOf"],["class","base no-fill selectable-stroke mid-stroke",4,"ngIf"],["id","lastJump",1,"base","no-fill"],[1,"base",3,"id","ngClass","click"],["class","base no-fill mid-stroke",3,"click",4,"ngIf"],["class","base",3,"id","ngClass","click",4,"ngIf"],[1,"base","no-fill","mid-stroke",3,"click"],[1,"base","no-fill","mid-stroke",3,"ngClass","click"],[1,"base","mid-stroke","player0-fill",3,"id"],[1,"base","mid-stroke","player1-fill",3,"id"],[1,"base","no-fill","selectable-stroke","mid-stroke"]],template:function(e,r){1&e&&(F(),O(0,"svg",0),x(1,glt,2,1,"g",1),x(2,mlt,2,5,"g",1),x(3,_lt,1,4,"circle",2),x(4,vlt,1,4,"circle",3),x(5,Clt,1,4,"rect",4),X(6,"polyline",5),A()),2&e&&(P(1),w("ngForOf",r.viewInfo.boardInfo),P(1),w("ngForOf",r.ALL_SHELTERS),P(1),w("ngForOf",r.ArrayUtils.range(r.viewInfo.sidePieces[0])),P(1),w("ngForOf",r.ArrayUtils.range(r.viewInfo.sidePieces[1])),P(1),w("ngIf",r.viewInfo.dropPhase),P(1),z("points",r.viewInfo.lastMoveArrow))},dependencies:[fn,On,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class Elt extends xs{getListMoves(t){const e=t.gameState,r=this.getListDrops(e),s=this.getListShifts(e);return r.concat(s)}getListShifts(t){const e=[],r=this.getShiftSources(t);for(const s of r)for(const i of[new A2(s,"clockwise"),new A2(s,"counterclockwise")])V4.get().shiftHeightValidity(i,t).isSuccess()&&e.push(i);return e}getListDrops(t){const e=this.getRemainingPiecesForCurrentPlayer(t),r=[];for(let s=0;s<$r.WIDTH;s++)for(const i of e){const o=new f8(s,i);V4.get().dropHeightValidity(o,t).isSuccess()&&r.push(o)}return r}getRemainingPiecesForCurrentPlayer(t){const e=[];for(const r of Pn.PLAYER_PIECES)this.currentPlayerCanDropPiece(t,r)&&e.push(r);return e}currentPlayerCanDropPiece(t,e){return t.getCurrentPlayer()===e.owner&&t.getRemainingPiecesOf(e)>0}getShiftSources(t){const e=[],r=t.getCurrentPlayer();for(let s=0;s<$r.HEIGHT;s++)for(let i=0;i<$r.WIDTH;i++)t.getPieceAtXY(i,s).owner===r&&e.push(new S(i,s));return e}getMetrics(t){return[0,0]}}function Mlt(n,t){if(1&n){const e=Oe();F(),O(0,"g",6)(1,"path",7),ee("click",function(){const i=ue(e).$implicit;return ce(C().onSpaceClick(i))}),A(),O(2,"path",8),ee("click",function(){const i=ue(e).$implicit;return ce(C().onSpaceClick(i))}),A()()}if(2&n){const e=t.$implicit,r=C();y1("id","board_space_",e,""),P(1),y1("id","click_",e,""),w("ngClass",r.viewInfo.boardInfo[e].spaceClasses),z("d",r.BOARD_PATHS[e]),P(1),w("ngClass",r.viewInfo.boardInfo[e].spaceClasses),z("d",r.DECORATION_PATHS[e])}}function Slt(n,t){if(1&n){const e=Oe();F(),O(0,"g",10),ee("click",function(){const i=ue(e).$implicit,o=C().$implicit;return ce(C().onPieceInGameClick(o,i.y))}),X(1,"use",11)(2,"use",12),A()}if(2&n){const e=t.$implicit;De("id","click_",C().$implicit,"_",e.y,""),w("ngClass",e.foregroundClasses),P(1),w("ngClass",e.backgroundClasses),z("x",e.drawPosition.x)("y",e.drawPosition.y),P(1),z("x",e.drawPosition.x)("y",e.drawPosition.y)}}function Plt(n,t){if(1&n&&(F(),O(0,"g"),x(1,Slt,3,8,"g",9),A()),2&n){const e=t.$implicit,r=C();P(1),w("ngForOf",r.viewInfo.boardInfo[e].pieces)}}function Tlt(n,t){if(1&n){const e=Oe();F(),O(0,"g",14),ee("click",function(){const s=ue(e),i=s.$implicit,o=s.index;return ce(C(2).onRemainingPieceClick(i.actualPiece,o))}),X(1,"use",11)(2,"use",12),A()}if(2&n){const e=t.$implicit,r=t.index;j2("id","piece_",e.actualPiece.owner.toString(),"_",e.actualPiece.otherPieceType?1:0,"_",r,""),w("ngClass",e.foregroundClasses),P(1),w("ngClass",e.backgroundClasses),z("x",e.drawPosition.x)("y",e.drawPosition.y),P(1),z("x",e.drawPosition.x)("y",e.drawPosition.y)}}function wlt(n,t){if(1&n&&(F(),O(0,"g"),x(1,Tlt,3,9,"g",13),A()),2&n){const e=t.$implicit,r=C();P(1),w("ngForOf",r.viewInfo.remainingPieces.get(e).get())}}const blt=function(){return[0,1,2,3,4,5,6,7]},Olt=function(){return[2,1,3,0,4,7,5,6]};class D3 extends o8{constructor(t){super(t),this.BOARD_PATHS=["M 2.8324855,277.57643 164.46619,228.81694 170.57257,148.42756 32.571357,104.19835 Z","M 170.57257,148.42237 246.4213,96.276913 195.13813,2.0233391 32.571357,104.19315 Z","m 195.14159,2.0268021 205.0898,0.010821 -52.1686,94.2453509 -101.64149,-0.0057 z","M 348.06279,96.281239 400.23529,2.0330788 564.39307,104.19207 424.66384,148.41891 Z","m 424.66384,148.42237 7.27882,80.37683 164.9712,48.72701 -32.52079,-173.33068 z","m 431.94266,228.80481 -75.73854,62.15055 79.06197,135.86929 161.64688,-149.29953 z","m 356.20412,290.9506 79.06197,135.86929 -268.2864,0.0433 74.14082,-135.90175 z","M 241.12051,290.96379 166.97969,426.86556 2.8324855,277.57708 164.46619,228.81759 Z"],this.DECORATION_PATHS=["m 170.57257,148.42302 v 40.08918 l -6.11049,80.38634 v -40.09025 z","m 170.57646,188.51696 v -40.08918 l 75.8509,-52.140047 v 40.086147 z","m 246.42323,96.285785 v 40.086155 l 101.63847,-0.003 0.001,-40.082256 z","m 424.66037,148.42345 v 40.08377 l -76.60213,-52.14178 10e-4,-40.082033 z","m 424.66037,148.42193 v 40.08377 l 7.27884,80.37445 v -40.08377 z","m 435.26609,466.90582 v -40.08615 l 161.64688,-149.2995 8.9e-4,40.08701 z","m 166.97969,426.86815 v 40.08638 l 268.28379,-0.0433 v -40.08031 z","m 2.8324855,277.57297 v 40.08636 L 166.97969,466.94782 v -40.08636 z"],this.selected=T.empty(),this.viewInfo={boardInfo:[],remainingPieces:new Un([{key:B.ZERO,value:[]},{key:B.ONE,value:[]}])},this.rules=V4.get(),this.availableMinimaxes=[new Elt(this.rules,"DiamDummyMinimax")],this.encoder=q4t,this.tutorial=(new Jce).tutorial}ngOnInit(){this.updateBoard()}onSpaceClick(t){var e=this;return I(function*(){const r=e.canUserPlay("#click_"+t);return r.isFailure()?e.cancelMove(r.getReason()):e.onSpaceClickAfterCheck(t)})()}onSpaceClickAfterCheck(t){var e=this;return I(function*(){if(e.selected.isPresent()){const r=e.selected.get();let s;if("pieceFromReserve"===r.type)s=new f8(t,r.piece);else if((r.position.x+1)%$r.WIDTH===t)s=new A2(r.position,"clockwise");else{if((r.position.x+($r.WIDTH-1))%$r.WIDTH!==t)return e.cancelMove($m.MUST_SHIFT_TO_NEIGHBOR());s=new A2(r.position,"counterclockwise")}return e.chooseMove(s,e.getState())}return e.cancelMove($m.MUST_SELECT_PIECE_FIRST())})()}onPieceInGameClick(t,e){var r=this;return I(function*(){const s=r.canUserPlay("#click_"+t+"_"+e);if(s.isFailure())return r.cancelMove(s.getReason());const i=new S(t,e);return r.getState().getPieceAt(i).owner===r.getCurrentPlayer()?(r.isSelected(null,i)?r.cancelMoveAttempt():r.selected=T.of({type:"pieceFromBoard",position:i}),r.updateViewInfo(),R.SUCCESS):r.selected.isPresent()?r.onSpaceClickAfterCheck(t):r.cancelMove(et.MUST_CHOOSE_PLAYER_PIECE())})()}onRemainingPieceClick(t,e){var r=this;return I(function*(){const s=r.canUserPlay(r.getPieceId(t,e));return s.isFailure()?r.cancelMove(s.getReason()):t.owner===r.getCurrentPlayer()?(r.selected=r.isSelected(t)?T.empty():T.of({type:"pieceFromReserve",piece:t}),r.updateViewInfo(),R.SUCCESS):r.cancelMove(et.MUST_CHOOSE_PLAYER_PIECE())})()}getPieceId(t,e){return"#piece_"+t.owner.toString()+"_"+(t.otherPieceType?1:0)+"_"+e}isSelected(t,e){return!this.selected.isAbsent()&&(null==t&&"pieceFromBoard"===this.selected.get().type?this.selected.get().position.equals(e):this.selected.get().piece===t)}updateBoard(){this.updateViewInfo()}getLastMovedFromDrop(t,e){const r=this.getDrawPositionRemainingPiece(t.piece,e.getRemainingPiecesOf(t.piece)-1),s=t.getTarget(),i=e.getStackHeight(t.getTarget()),o=this.getDrawPositionOnBoard(s,i),c=new S(s,i);return[{start:T.empty(),end:c,startDrawPosition:r,endDrawPosition:o}]}getLastMovedFromShift(t,e){const r=t.start.x,s=t.getTarget();let i=e.getStackHeight(s);const o=[];for(let c=t.start.y;c<$r.HEIGHT&&e.getPieceAtXY(r,c)!==Pn.EMPTY;c++,i++)o.push({start:T.of(new S(r,c)),end:new S(s,i),startDrawPosition:this.getDrawPositionOnBoard(r,c),endDrawPosition:this.getDrawPositionOnBoard(s,i)});return o}updateViewInfo(){this.updateBoardInfo(),this.updateRemainingPiecesInfo()}updateBoardInfo(){for(let t=0;t<$r.WIDTH;t++)this.viewInfo.boardInfo[t]={x:t,spaceClasses:[],pieces:this.getPieces(t)}}showLastMove(t){this.showLastMoveOnSpaces(t),this.showLastMoveOnPieces(t)}showLastMoveOnSpaces(t){for(let e=0;e<$r.WIDTH;e++){const r=[];t.isDrop()?t.getTarget()===e&&r.push("moved-fill"):(t.getTarget()===e||t.start.x===e)&&r.push("moved-fill"),this.viewInfo.boardInfo[e].spaceClasses=r}}showLastMoveOnPieces(t){const e=this.getPreviousState();let r=[];r=t.isDrop()?this.getLastMovedFromDrop(t,e):this.getLastMovedFromShift(t,e);for(const s of r)this.viewInfo.boardInfo[s.end.x].pieces[s.end.y].foregroundClasses.push("last-move-stroke")}updateRemainingPiecesInfo(){const t=this.getCurrentPlayer();this.viewInfo.remainingPieces=new Un([{key:B.ZERO,value:[]},{key:B.ONE,value:[]}]);const e=this.isPlayerTurn();for(const r of Pn.PLAYER_PIECES){const s=this.getState().getRemainingPiecesOf(r);for(let i=0;i<s;i++){const o=[];this.isTopPieceOfReserveAndSelected(i,s,r)&&o.push("selected-stroke"),e&&i===s-1&&r.owner===t&&o.push("clickable-stroke-hover");const c=this.viewInfo.remainingPieces.get(r.owner).get(),u=[];u.push(r.otherPieceType?"player"+r.owner.value+"-alternate-fill":"player"+r.owner.value+"-fill"),c.push({backgroundClasses:u,foregroundClasses:o,y:i,drawPosition:this.getDrawPositionRemainingPiece(r,i),actualPiece:r}),this.viewInfo.remainingPieces.put(r.owner,c)}}}isTopPieceOfReserveAndSelected(t,e,r){if(this.selected.isPresent()){const s=this.selected.get();return"pieceFromReserve"===s.type&&s.piece===r&&t===e-1}return!1}getDrawPositionRemainingPiece(t,e){let r,s;return r=t.owner===B.ZERO?-100:600,s=t.otherPieceType?100:450,new S(r,s).getNext(new Bt(0,-e*D3.PIECE_HEIGHT))}getPieces(t){const e=this.rules.findHighestAlignment(this.getState()),r=this.isPlayerTurn(),s=[];for(let i=0;i<$r.HEIGHT;i++){const o=this.getState().getPieceAtXY(t,i),c=new S(t,i);if(o!==Pn.EMPTY){const u=[];this.pieceFromBoardIsSelected(t,i)&&u.push("selected-stroke"),this.isVictory(t,i,e)&&u.push("victory-stroke"),r&&this.rules.pieceCanMove(this.getState(),c)&&u.push("clickable-stroke-hover"),s.push({backgroundClasses:["player"+o.owner.value+(o.otherPieceType?"-alternate-fill":"-fill")],foregroundClasses:u,y:i,drawPosition:this.getDrawPositionOnBoard(t,i),actualPiece:o})}}return s}pieceFromBoardIsSelected(t,e){if(this.selected.isPresent()){const r=this.selected.get();return"pieceFromBoard"===r.type&&r.position.x===t&&r.position.y===e}return!1}isVictory(t,e,r){if(r.isPresent()){const s=r.get();return s.x%4==t%4&&s.y===e}return!1}getDrawPositionOnBoard(t,e){return D3.CENTER[t].getNext(new Bt(0,-e*D3.PIECE_HEIGHT))}cancelMoveAttempt(){this.selected=T.empty(),this.updateBoard()}}D3.CENTER=[new S(40,160),new S(100,50),new S(255,2),new S(400,50),new S(460,160),new S(400,270),new S(255,320),new S(100,270)],D3.PIECE_HEIGHT=36,D3.\u0275fac=function(t){return new(t||D3)(J(En))},D3.\u0275cmp=dt({type:D3,selectors:[["app-diam"]],features:[l],decls:8,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-110 -120 800 710","preserveAspectRatio","xMidYMid meet"],["id","piece"],["d","M 0 15 v 35 A 40 15, 0, 0, 0, 80 50 v -35 A 40 15, 0, 0, 0, 0 15 Z"],["cx","40","cy","15","rx","40","ry","15"],[3,"id",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],[3,"id"],[1,"base","mid-stroke",3,"id","ngClass","click"],[1,"base","mid-stroke","high-brightness",3,"ngClass","click"],["pointer-events","fill","class","base-no-fill no-fill mid-small-stroke",3,"id","ngClass","click",4,"ngFor","ngForOf"],["pointer-events","fill",1,"base-no-fill","no-fill","mid-small-stroke",3,"id","ngClass","click"],[0,"xlink","href","#piece",1,"base","mid-stroke",3,"ngClass"],[0,"xlink","href","#piece"],["class","base-no-fill no-fill mid-small-stroke",3,"id","ngClass","click",4,"ngFor","ngForOf"],[1,"base-no-fill","no-fill","mid-small-stroke",3,"id","ngClass","click"]],template:function(t,e){1&t&&(F(),O(0,"svg",0)(1,"defs")(2,"g",1),X(3,"path",2)(4,"ellipse",3),A()(),x(5,Mlt,3,6,"g",4),x(6,Plt,2,1,"g",5),x(7,wlt,2,1,"g",5),A()),2&t&&(P(5),w("ngForOf",J1(3,blt)),P(1),w("ngForOf",J1(4,Olt)),P(1),w("ngForOf",e.Player.PLAYERS))},dependencies:[fn,On],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});class Ka{constructor(t,e){this.offset=t,this.constant=e}static fromTwoCoords(t,e){const r=t.x,s=e.x,i=t.y,o=e.y,c=r+i,u=s+o;return r===s&&i!==o&&c!==u?T.of(Ka.constantQ(r)):r!==s&&i===o&&c!==u?T.of(Ka.constantR(i)):r!==s&&i!==o&&c===u?T.of(Ka.constantS(c)):T.empty()}static constantQ(t){return new Ka(t,"q")}static constantR(t){return new Ka(t,"r")}static constantS(t){return new Ka(t,"s")}static areOnSameLine(t){if(t.length<2)return!0;const e=Ka.fromTwoCoords(t[0],t[1]);if(e.isAbsent())return!1;const r=e.get();for(const s of t.slice(2))if(!1===r.contains(s))return!1;return!0}toString(){return`Line(${this.constant}, ${this.offset})`}equals(t){return this===t||!(this.offset!==t.offset||this.constant!==t.constant)}contains(t){switch(this.constant){case"q":return t.x===this.offset;case"r":return t.y===this.offset;case"s":return t.x+t.y===this.offset}}getDirection(){switch(this.constant){case"q":return Re.DOWN;case"r":return Re.RIGHT;case"s":return Re.DOWN_LEFT}}}class RH extends Br{constructor(t,e,r,s,i,o){super(e,t),this.width=r,this.height=s,this.excludedSpaces=i,this.empty=o,Pe(this.excludedSpaces.length<this.height/2+1,"Invalid excluded spaces specification for HexagonalGameState.")}setAt(t,e){if(this.isOnBoard(t))return this.setAtUnsafe(t,e);throw new Error("Setting coord not on board: "+t+".")}equalsT(t,e){if(this===t)return!0;if(this.width!==t.width||this.height!==t.height||!1===e(this.empty,t.empty)||this.excludedSpaces.length!==t.excludedSpaces.length)return!1;for(let r=0;r<this.excludedSpaces.length;r++)if(this.excludedSpaces[r]!==t.excludedSpaces[r])return!1;for(const r of this.allCoords())if(!1===e(this.getPieceAt(r),t.getPieceAt(r)))return!1;return!0}allCoords(){const t=[];return this.forEachCoord(e=>{t.push(e)}),t}allLines(){const t=[];for(let e=0;e<this.width;e++)t.push(Ka.constantQ(e));for(let e=0;e<this.height;e++)t.push(Ka.constantR(e));for(let e=this.excludedSpaces.length;e<this.height+this.excludedSpaces.length;e++)t.push(Ka.constantS(e));return t}getEntranceOnLine(t){let e,r;switch(t.constant){case"q":return r=null!=this.excludedSpaces[t.offset]?this.excludedSpaces[t.offset]:0,this.findEntranceFrom(t,new S(t.offset,r));case"r":return e=null!=this.excludedSpaces[t.offset]?this.excludedSpaces[t.offset]:0,this.findEntranceFrom(t,new S(e,t.offset));case"s":return this.findEntranceFrom(t,t.offset<this.width?new S(t.offset,0):new S(this.width-1,t.offset-this.width+1))}}findEntranceFrom(t,e){const r=t.getDirection();let s=e;for(let o=0;o<Math.max(this.width,this.height);o++){if(this.isOnBoard(s))return s;s=s.getNext(r)}const i=As.logError("HexagonalGameState.findEntranceFrom","could not find a board entrance, board must be invalid",{start:e.toString(),line:t.toString()});throw new Error(i.getReason())}}class N2{static getNeighbors(t,e=1){const r=[];for(const s of Re.factory.all)r.push(t.getNext(s,e));return r}static areNeighbors(t,e){for(const r of Re.factory.all)if(t.getNext(r).equals(e))return!0;return!1}}class v1{constructor(t,e,r){this.owner=t,this.size=e,this.source=r}static append(t,e){return new v1(t.owner,t.size+e.size,t.source||e.source)}getOwner(){return this.owner}belongsTo(t){return this.owner===t}containsSource(){return this.source}isEmpty(){return 0===this.size}hasPieces(){return!1===this.isEmpty()}getSize(){return this.size}toString(){return"DvonnPieceStack("+this.owner.toString()+", "+this.size+", "+this.source+")"}equals(t){return this.owner===t.owner&&this.size===t.size&&this.source===t.source}}v1.encoder=Nt.tuple([Nt.identity(),B.encoder,Nt.identity()],n=>[n.source,n.owner,n.size],n=>new v1(n[1],n[2],n[0])),v1.MAX_SIZE=49,v1.EMPTY=new v1(he.NONE,0,!1),v1.UNREACHABLE=new v1(he.NONE,-1,!1),v1.PLAYER_ZERO=new v1(B.ZERO,1,!1),v1.PLAYER_ONE=new v1(B.ONE,1,!1),v1.SOURCE=new v1(he.NONE,1,!0);let Xa=(()=>{class n extends RH{constructor(e,r,s){super(r,e,n.WIDTH,n.HEIGHT,n.EXCLUDED_SPACES,v1.EMPTY),this.alreadyPassed=s}static balancedBoard(){const e=v1.UNREACHABLE,r=v1.PLAYER_ZERO,s=v1.PLAYER_ONE,i=v1.SOURCE;return[[e,e,r,s,s,s,r,r,s,i,s],[e,s,s,r,r,r,s,s,r,s,s],[s,s,s,s,r,i,s,r,r,r,r],[r,r,s,r,r,s,s,s,r,r,e],[r,i,r,s,s,r,r,r,s,e,e]]}static isOnBoard(e){return!e.isNotInRange(n.WIDTH,n.HEIGHT)&&n.balancedBoard()[e.y][e.x]!==v1.UNREACHABLE}static getInitialState(){return new n(n.balancedBoard(),0,!1)}getAllPieces(){const e=[];for(let r=0;r<n.HEIGHT;r++)for(let s=0;s<n.WIDTH;s++){const i=new S(s,r);this.isOnBoard(i)&&this.getPieceAt(i).hasPieces()&&e.push(i)}return e}numberOfNeighbors(e){return N2.getNeighbors(e,1).filter(i=>this.isOnBoard(i)&&this.getPieceAt(i).hasPieces()).length}setAtUnsafe(e,r){const s=Xe.copyBiArray(this.board);return s[e.y][e.x]=r,new n(s,this.turn,this.alreadyPassed)}isOnBoard(e){return!e.isNotInRange(this.width,this.height)&&this.board[e.y][e.x]!==v1.UNREACHABLE}}return n.WIDTH=11,n.HEIGHT=5,n.EXCLUDED_SPACES=[2,1],n})(),A5=(()=>{class n{}return n.NOT_PLAYER_PIECE=()=>$localize`You must select a piece or a stack of your color.`,n.EMPTY_STACK=()=>$localize`You must select a stack.`,n.TOO_MANY_NEIGHBORS=()=>$localize`This stack cannot be moved because all 6 of its neighbors are occupied. You must select a stack with strictly less than 6 neighbors.`,n.CANT_REACH_TARGET=()=>$localize`This stack cannot move because it could never land on another piece.`,n.INVALID_MOVE_LENGTH=()=>$localize`A stack must always be moved by as many spaces as there are pieces in the stack.`,n.EMPTY_TARGET_STACK=()=>$localize`The stack must land on an occupied space.`,n.MUST_MOVE_IN_STRAIGHT_LINE=()=>$localize`A stack must move in a straight line.`,n})();class Ur extends c8{constructor(t,e){super(t,e)}static from(t,e){return-1===t.x&&-1===t.y&&-2===e.x&&-2===e.y?_e.success(Ur.PASS):Xa.isOnBoard(t)?Xa.isOnBoard(e)?t.y===e.y||t.x===e.x||t.x+t.y===e.x+e.y?_e.success(new Ur(t,e)):_e.failure(A5.MUST_MOVE_IN_STRAIGHT_LINE()):_e.failure("End coord of DvonnMove must be on the board, not at "+t.toString()):_e.failure("Starting coord of DvonnMove must be on the board, not at "+t.toString())}toString(){return this===Ur.PASS?"DvonnMove.PASS":"DvonnMove("+this.getStart()+"->"+this.getEnd()+")"}length(){return this.getStart().y===this.getEnd().y?Math.abs(this.getStart().x-this.getEnd().x):(this.getStart(),this.getEnd(),Math.abs(this.getStart().y-this.getEnd().y))}equals(t){return t===this||!!t.getStart().equals(this.getStart())&&t.getEnd().equals(this.getEnd())}}Ur.PASS=new Ur(new S(-1,-1),new S(-2,-2)),Ur.encoder=no.getFallibleEncoder(Ur.from);const me=v1.EMPTY,Gr=v1.UNREACHABLE,d8=v1.SOURCE,Ad=v1.PLAYER_ZERO,Nd=v1.PLAYER_ONE,Alt=new v1(B.ZERO,2,!1),DH=new v1(B.ONE,2,!1),s3e=new v1(B.ZERO,4,!1),Nlt=new v1(B.ONE,4,!1);class i3e extends $1{constructor(){super(...arguments),this.tutorial=[ie.anyMove($localize`Moving`,$localize`At Dvonn, each hexagonal space contains a stack of pieces.
        If no number is indicated on a stack, it means that it only contains one piece.
        The number written on a stack indicates the number of pieces within that stack, hence the number of points its owner gets.
        The owner of a stack is the one that has a piece at the top of the stack.
        Only the owner of a stack can move it.
        A stack cannot be moved if it is surrounded by 6 other stacks.
        A stack is moved by as many spaces as there are pieces within, in a straight line, and it should land on an occupied space.
        This line cannot move along the vertex of two neighboring spaces, as would a vertical move.
        Therefore, there are six possible directions.
        The player with dark pieces starts.<br/><br/>
        You're playing Dark, click on a stack and move it by one space.`,Xa.getInitialState(),Ur.from(new S(2,0),new S(3,0)).get(),$localize`Congratulations!`),ie.fromPredicate($localize`Disconnection`,$localize`Pieces with a lightning strike are called "sources".
        When a stack is not directly nor indirectly connected to a source, it is removed from the board.<br/><br/>
        You're playing Dark, try to disconnect the stack of 4 pieces from your opponent. There are two ways of doing that, one is better than the other: try to find that one!`,new Xa([[Gr,Gr,Nd,d8,me,me,me,me,me,me,me],[Gr,me,Ad,me,me,me,me,me,me,me,me],[me,me,Nlt,me,me,me,me,Nd,d8,me,me],[me,me,me,me,me,me,me,me,me,me,Gr],[me,me,me,me,me,me,me,me,me,Gr,Gr]],0,!1),Ur.from(new S(2,1),new S(2,0)).get(),(t,e,r)=>t.getEnd().equals(new S(3,0))?R.failure($localize`You have successfully disconnected the stack of 4 pieces of your opponent, but on the next move your opponent will be able to move on your new stack, and to win the game! There exists a better outcome of this situation, try to find it.`):(Pe(t.getEnd().equals(new S(2,0)),"player made an impossible move"),R.SUCCESS),$localize`Nice, you have disconnected 4 pieces of your opponent, and your new stack cannot be reached by your opponent!
        Your opponent therefore lost 5 points: 4 from the disconnected stack, and one from the stack on which you moved.
        Disconnected stacks will not be visible at the next turn.`),ie.fromPredicate($localize`Moving on a source`,$localize`You are allowed to move your stacks on any other stack.
        This means that you can take control of a source by moving one of your stack on top of it.
        This way, you know that this stack may never be disconnected, as it contains a source.<br/><br/>
        You're playing Dark and you can take control of a source, do it!`,new Xa([[Gr,Gr,d8,Nd,me,me,me,me,me,me,me],[Gr,Ad,Ad,me,me,me,me,me,me,me,me],[me,Nd,Ad,Nd,me,me,Ad,DH,d8,me,me],[me,me,Nd,me,me,me,me,me,me,me,Gr],[me,me,me,me,me,me,me,me,me,Gr,Gr]],0,!1),Ur.from(new S(2,1),new S(2,0)).get(),(t,e,r)=>t.getEnd().equals(new S(2,0))?R.SUCCESS:R.failure($localize`You have not taken possession of a source, try again.`),$localize`Congratulations! However, note that your opponent could later take possession of one of your stack that contains a source, so watch out when you take control of sources!`),ie.informational($localize`Passing`,$localize`It can happen that you have no possible move to make.
        If this is the case, and if your opponent can still move, you must pass your turn.<br/><br/>
        This is a situation that occurs here for Dark.`,new Xa([[Gr,Gr,d8,me,me,me,me,me,me,me,me],[Gr,me,Alt,me,me,me,me,me,me,me,me],[me,me,DH,me,me,me,me,DH,d8,s3e,me],[me,me,me,me,me,me,me,me,me,me,Gr],[me,me,me,me,me,me,me,me,me,Gr,Gr]],0,!1)),ie.fromMove($localize`End of the game`,$localize`When no more move is possible for both players, the game ends and the player with the most points wins.<br/><br/>You're playing Dark, make your last move.`,new Xa([[Gr,Gr,d8,me,me,me,me,me,me,me,me],[Gr,me,Ad,me,me,me,me,me,me,me,me],[me,me,me,me,me,me,me,me,d8,s3e,me],[me,me,me,me,me,me,me,me,me,me,Gr],[me,me,me,me,me,me,me,me,me,Gr,Gr]],0,!1),[Ur.from(new S(2,1),new S(2,0)).get()],$localize`Congratulations, you won 6 - 0!`,$localize`Bad idea, by moving on the source you would have won a point.`)]}}class I2 extends L1{static getGameStatus(t){const e=t.gameState,r=I2.getScores(e);return 0===I2.getMovablePieces(e).length?r[0]>r[1]?xe.ZERO_WON:r[0]<r[1]?xe.ONE_WON:xe.DRAW:xe.ONGOING}static getMovablePieces(t){return I2.getFreePieces(t).filter(e=>I2.pieceHasTarget(t,e))}static getFreePieces(t){return t.getAllPieces().filter(e=>t.getPieceAt(e).belongsTo(t.getCurrentPlayer())&&t.numberOfNeighbors(e)<6)}static pieceHasTarget(t,e){const r=t.getPieceAt(e).getSize();return void 0!==N2.getNeighbors(e,r).find(i=>t.isOnBoard(i)&&!t.getPieceAt(i).isEmpty())}static pieceTargets(t,e){const r=t.getPieceAt(e).getSize();return N2.getNeighbors(e,r).filter(i=>t.isOnBoard(i)&&t.getPieceAt(i).hasPieces())}static getScores(t){let e=0,r=0;return t.getAllPieces().map(s=>{const i=t.getPieceAt(s);i.belongsTo(B.ZERO)?e+=i.getSize():i.belongsTo(B.ONE)&&(r+=i.getSize())}),[e,r]}isMovablePiece(t,e){Pe(t.isOnBoard(e),"piece is not on the board");const r=t.getPieceAt(e);return r.getSize()<1?R.failure(A5.EMPTY_STACK()):r.belongsTo(t.getCurrentPlayer())?t.numberOfNeighbors(e)>=6?R.failure(A5.TOO_MANY_NEIGHBORS()):I2.pieceHasTarget(t,e)?R.SUCCESS:R.failure(A5.CANT_REACH_TARGET()):R.failure(A5.NOT_PLAYER_PIECE())}canOnlyPass(t){return 0===I2.getMovablePieces(t).length}sourceCoords(t){return t.getAllPieces().filter(e=>t.getPieceAt(e).containsSource())}markPiecesConnectedTo(t,e,r){N2.getNeighbors(e,1).forEach(s=>{t.isOnBoard(s)&&!r[s.y][s.x]&&!t.getPieceAt(s).isEmpty()&&(r[s.y][s.x]=!0,this.markPiecesConnectedTo(t,s,r))})}removeDisconnectedPieces(t){const e=Xe.createTable(Xa.WIDTH,Xa.HEIGHT,!1);this.sourceCoords(t).forEach(s=>{e[s.y][s.x]=!0,this.markPiecesConnectedTo(t,s,e)});let r=t;return r.getAllPieces().forEach(s=>{e[s.y][s.x]||(r=r.setAt(s,v1.EMPTY))}),r}applyLegalMove(t,e,r){if(t===Ur.PASS)return new Xa(e.board,e.turn+1,!0);{const s=e.getPieceAt(t.getStart()),i=e.getPieceAt(t.getEnd()),o=e.setAt(t.getStart(),v1.EMPTY).setAt(t.getEnd(),v1.append(s,i));return this.removeDisconnectedPieces(new Xa(o.board,e.turn+1,!1))}}isLegal(t,e){if(0===I2.getMovablePieces(e).length)return t!==Ur.PASS||e.alreadyPassed?R.failure(et.MUST_PASS()):R.SUCCESS;if(t===Ur.PASS)return R.failure(et.CANNOT_PASS());const r=this.isMovablePiece(e,t.getStart());if(r.isFailure())return r;const s=e.getPieceAt(t.getStart());return t.length()!==s.getSize()?_e.failure(A5.INVALID_MOVE_LENGTH()):e.getPieceAt(t.getEnd()).isEmpty()?_e.failure(A5.EMPTY_TARGET_STACK()):_e.success(void 0)}getGameStatus(t){return I2.getGameStatus(t)}}class o3e extends xs{getListMoves(t){const e=t.move,r=t.gameState,s=[];return I2.getMovablePieces(r).forEach(i=>I2.pieceTargets(r,i).forEach(o=>{const c=Ur.from(i,o).get();s.push(c)})),0===s.length&&!1===e.equalsValue(Ur.PASS)&&s.push(Ur.PASS),s}getMetrics(t){return I2.getScores(t.gameState)}}class Ilt extends o3e{getListMoves(t){const e=t.gameState,r=super.getListMoves(t),s=e.getCurrentPlayer().getOpponent();return Xe.sortByDescending(r,i=>{Pe(i!==Ur.PASS,"Cannot sort with DvonnMove.PASS");const o=e.getPieceAt(i.getEnd());return o.belongsTo(s)?o.getSize():0}),r}getMetrics(t){const e=t.gameState,r=I2.getScores(e),s=e.getAllPieces(),i=s.length;for(const o of B.PLAYERS){const c=s.filter(u=>e.getPieceAt(u).belongsTo(o)).length;r[o.value]=r[o.value]*c/i}return r}}function xlt(n,t){if(1&n&&(F(),X(0,"circle",11)),2&n){const e=C().$implicit,r=C().$implicit,s=C();De("id","piece_",r.x,"_",r.y,""),w("ngClass",s.getPieceClasses(e)),z("cx",s.getCenterAt(r).x)("cy",s.getCenterAt(r).y)("r",s.SPACE_SIZE)}}function klt(n,t){if(1&n&&(F(),X(0,"polygon",12)),2&n){const e=C().$implicit,r=C().$implicit,s=C();z("transform",1===e.getSize()?"translate("+(s.getCenterAt(r).x-18)+" "+(s.getCenterAt(r).y-16)+") scale(0.10)":"translate("+(s.getCenterAt(r).x-3)+" "+(s.getCenterAt(r).y-12)+") scale(0.07)")}}function Llt(n,t){if(1&n){const e=Oe();F(),O(0,"text",13),ee("click",function(){ue(e);const s=C(2).$implicit;return ce(C().onClick(s.x,s.y))}),Tt(1),A()}if(2&n){const e=C().$implicit,r=C().$implicit,s=C();z("x",e.containsSource()?s.getCenterAt(r).x-7:s.getCenterAt(r).x)("y",s.getCenterAt(r).y),P(1),c1(e.getSize())}}function Rlt(n,t){if(1&n){const e=Oe();F(),O(0,"g",6),ee("click",function(){ue(e);const s=C().$implicit;return ce(C().onClick(s.x,s.y))}),X(1,"polygon",7),x(2,xlt,1,6,"circle",8),x(3,klt,1,1,"polygon",9),x(4,Llt,2,3,"text",10),A()}if(2&n){const e=t.$implicit,r=C().$implicit,s=C();De("id","click_",r.x,"_",r.y,""),P(1),z("points",s.getHexaPointsAt(r)),P(1),w("ngIf",e.getSize()>0),P(1),w("ngIf",e.containsSource()),P(1),w("ngIf",e.getSize()>1)}}const Dlt=function(n){return[n]};function zlt(n,t){if(1&n&&(F(),O(0,"g"),x(1,Rlt,5,6,"g",5),A()),2&n){const e=t.$implicit,r=C();P(1),w("ngForOf",T3(1,Dlt,r.state.getPieceAt(e)))}}function Vlt(n,t){if(1&n&&(F(),O(0,"text",18),Tt(1),A()),2&n){const e=C().$implicit,r=C();z("x",r.getCenterAt(e.coord).x)("y",r.getCenterAt(e.coord).y),P(1),c1(e.spaceContent.getSize())}}function Hlt(n,t){if(1&n&&(F(),O(0,"g",14),X(1,"polygon",15)(2,"circle",16),x(3,Vlt,2,3,"text",17),A()),2&n){const e=t.$implicit,r=C();De("id","disconnected_",e.coord.x,"_",e.coord.y,""),P(1),z("points",r.getHexaPointsAt(e.coord)),P(1),De("id","captured_",e.coord.x,"_",e.coord.y,""),w("ngClass",r.getPieceClasses(e.spaceContent)),z("cx",r.getCenterAt(e.coord).x)("cy",r.getCenterAt(e.coord).y)("r",r.SPACE_SIZE),P(1),w("ngIf",e.spaceContent.getSize()>1)}}function Flt(n,t){if(1&n&&(F(),pn(0),X(1,"polygon",19)(2,"polygon",19),gn()),2&n){const e=C();P(1),z("points",e.getHexaPointsAt(e.lastMove.get().getStart())),P(1),z("points",e.getHexaPointsAt(e.lastMove.get().getEnd()))}}function Blt(n,t){if(1&n&&(F(),X(0,"polygon",20)),2&n){const e=C();De("id","chosen_",e.chosen.get().x,"_",e.chosen.get().y,""),z("points",e.getHexaPointsAt(e.chosen.get()))}}let $lt=(()=>{class n extends Td{constructor(e){super(e),this.lastMove=T.empty(),this.chosen=T.empty(),this.disconnecteds=[],this.rules=new I2(Xa),this.availableMinimaxes=[new o3e(this.rules,"DvonnMinimax"),new Ilt(this.rules,"DvonnMinimaxMaximizeStacks")],this.encoder=Ur.encoder,this.tutorial=(new i3e).tutorial,this.SPACE_SIZE=30,this.canPass=!1,this.scores=T.of(I2.getScores(this.getState())),this.hexaLayout=new wd(1.5*this.SPACE_SIZE,new S(-this.SPACE_SIZE,2*this.SPACE_SIZE),yP.INSTANCE),this.state=this.getState(),this.hexaBoard=this.getState().board}hideLastMove(){this.lastMove=T.empty()}updateBoard(){this.cancelMoveAttempt(),this.state=this.getState(),this.disconnecteds=[],this.hideLastMove(),this.canPass=this.rules.canOnlyPass(this.state),this.scores=T.of(I2.getScores(this.state))}showLastMove(e){this.lastMove=T.of(e);const r=this.getPreviousState(),s=this.getState();for(let i=0;i<s.board.length;i++)for(let o=0;o<s.board[i].length;o++){const c=new S(o,i);if(!0===s.isOnBoard(c)&&!1===c.equals(this.lastMove.get().getStart())){const u=s.getPieceAt(c),d=r.getPieceAt(c);if(u.isEmpty()&&!d.isEmpty()){const m={coord:new S(o,i),spaceContent:d};this.disconnecteds.push(m)}}}}cancelMoveAttempt(){this.chosen=T.empty()}pass(){var e=this;return I(function*(){return Pe(e.canPass,"DvonnComponent: pass() can only be called if canPass is true"),yield e.chooseMove(Ur.PASS,e.getState())})()}onClick(e,r){var s=this;return I(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);return i.isFailure()?s.cancelMove(i.getReason()):s.chosen.isAbsent()?s.choosePiece(e,r):s.chosen.equalsValue(new S(e,r))?(s.cancelMoveAttempt(),R.SUCCESS):yield s.chooseDestination(e,r)})()}choosePiece(e,r){const s=new S(e,r),i=this.rules.isMovablePiece(this.getState(),s);return i.isSuccess()?(this.chosen=T.of(s),R.SUCCESS):this.cancelMove(i.getReason())}chooseDestination(e,r){var s=this;return I(function*(){const i=s.getState(),o=s.chosen.get(),c=new S(e,r),u=Ur.from(o,c);return u.isFailure()?s.rules.isMovablePiece(i,c).isSuccess()?s.choosePiece(e,r):s.cancelMove(u.getReason()):s.rules.isLegal(u.get(),i).isFailure()&&s.rules.isMovablePiece(i,c).isSuccess()?s.choosePiece(e,r):s.chooseMove(u.get(),i)})()}getPieceClasses(e){if(e.containsSource()&&1===e.getSize())return["nonplayer-fill","dashed-stroke"];const r=this.getPlayerClass(e.getOwner());return e.containsSource()?[r,"nonplayer-stroke","dashed-stroke"]:[r]}}return n.\u0275fac=function(e){return new(e||n)(J(En))},n.\u0275cmp=dt({type:n,selectors:[["app-dvonn"]],features:[l],decls:5,vars:4,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","0 0 875 380","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id",4,"ngFor","ngForOf"],[4,"ngIf"],["class","base no-fill selected-stroke",3,"id",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base","mid-stroke"],["class","base mid-stroke",3,"id","ngClass",4,"ngIf"],["class","nonplayer-light-fill","points","157.055,0 90.798,196.319 164.417,196.319 88.344,400 289.571,159.509 218.405,159.509 311.656,0",4,"ngIf"],["class","text-center text-medium","dy","13",3,"click",4,"ngIf"],[1,"base","mid-stroke",3,"id","ngClass"],["points","157.055,0 90.798,196.319 164.417,196.319 88.344,400 289.571,159.509 218.405,159.509 311.656,0",1,"nonplayer-light-fill"],["dy","13",1,"text-center","text-medium",3,"click"],[3,"id"],[1,"base","mid-stroke","captured-fill"],[1,"base","mid-stroke","semi-transparent",3,"id","ngClass"],["class","text-center text-medium","dy","13",4,"ngIf"],["dy","13",1,"text-center","text-medium"],[1,"base","no-fill","last-move-stroke"],[1,"base","no-fill","selected-stroke",3,"id"]],template:function(e,r){1&e&&(F(),O(0,"svg",0),x(1,zlt,2,3,"g",1),x(2,Hlt,4,10,"g",2),x(3,Flt,3,2,"ng-container",3),x(4,Blt,1,3,"polygon",4),A()),2&e&&(P(1),w("ngForOf",r.state.allCoords()),P(1),w("ngForOf",r.disconnecteds),P(1),w("ngIf",r.lastMove.isPresent()),P(1),w("ngIf",r.chosen.isPresent()))},dependencies:[fn,On,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();var tr=(()=>(function(n){n[n.NONE=0]="NONE",n[n.SMALL=1]="SMALL",n[n.MEDIUM=2]="MEDIUM",n[n.BIG=3]="BIG"}(tr||(tr={})),tr))();class Je{constructor(t){this.value=t}static of(t){switch(t){case 0:return this.SMALL_DARK;case 1:return this.SMALL_LIGHT;case 2:return this.MEDIUM_DARK;case 3:return this.MEDIUM_LIGHT;case 4:return this.BIG_DARK;case 5:return this.BIG_LIGHT;case 6:return this.NONE;default:throw new Error("Invalid value "+t+" for EncapsulePiece")}}static ofSizeAndPlayer(t,e){return e===B.ZERO&&t===tr.BIG?Je.BIG_DARK:e===B.ZERO&&t===tr.MEDIUM?Je.MEDIUM_DARK:e===B.ZERO&&t===tr.SMALL?Je.SMALL_DARK:e===B.ONE&&t===tr.BIG?Je.BIG_LIGHT:e===B.ONE&&t===tr.MEDIUM?Je.MEDIUM_LIGHT:e===B.ONE&&t===tr.SMALL?Je.SMALL_LIGHT:Je.NONE}getPlayer(){switch(this){case Je.SMALL_DARK:case Je.MEDIUM_DARK:case Je.BIG_DARK:return B.ZERO;case Je.SMALL_LIGHT:case Je.MEDIUM_LIGHT:case Je.BIG_LIGHT:return B.ONE;default:return he.NONE}}getSize(){switch(this){case Je.BIG_DARK:case Je.BIG_LIGHT:return tr.BIG;case Je.MEDIUM_DARK:case Je.MEDIUM_LIGHT:return tr.MEDIUM;case Je.SMALL_DARK:case Je.SMALL_LIGHT:return tr.SMALL;default:return Me.expectToBe(this,Je.NONE),tr.NONE}}belongsTo(t){return this.getPlayer()===t}equals(t){return this===t}toString(){switch(this){case Je.BIG_DARK:return"BIG_DARK";case Je.BIG_LIGHT:return"BIG_LIGHT";case Je.MEDIUM_DARK:return"MEDIUM_DARK";case Je.MEDIUM_LIGHT:return"MEDIUM_LIGHT";case Je.SMALL_DARK:return"SMALL_DARK";case Je.SMALL_LIGHT:return"SMALL_LIGHT";default:return Me.expectToBe(this,Je.NONE),"EMPTY"}}}Je.encoder=new class extends L4{encode(n){return n.value}decode(n){return Je.of(n)}},Je.SMALL_DARK=new Je(0),Je.SMALL_LIGHT=new Je(1),Je.MEDIUM_DARK=new Je(2),Je.MEDIUM_LIGHT=new Je(3),Je.BIG_DARK=new Je(4),Je.BIG_LIGHT=new Je(5),Je.NONE=new Je(6);class p6 extends Br{constructor(t,e,r){super(t,e),this.remainingPieces=r}static getInitialState(){const t=new Ui(he.NONE,he.NONE,he.NONE),e=Xe.createTable(3,3,t);return new p6(e,0,[Je.BIG_DARK,Je.BIG_DARK,Je.BIG_LIGHT,Je.BIG_LIGHT,Je.MEDIUM_DARK,Je.MEDIUM_DARK,Je.MEDIUM_LIGHT,Je.MEDIUM_LIGHT,Je.SMALL_DARK,Je.SMALL_DARK,Je.SMALL_LIGHT,Je.SMALL_LIGHT])}getRemainingPieces(){return Xe.copyImmutableArray(this.remainingPieces)}getRemainingPiecesOfPlayer(t){return this.getRemainingPieces().filter(e=>e.getPlayer()===t)}pieceBelongsToCurrentPlayer(t){return t.belongsTo(this.getCurrentPlayer())}isDroppable(t){return this.pieceBelongsToCurrentPlayer(t)&&this.isInRemainingPieces(t)}isInRemainingPieces(t){return this.remainingPieces.some(e=>e===t)}getPlayerRemainingPieces(){return this.remainingPieces.filter(t=>this.pieceBelongsToCurrentPlayer(t))}}class Ui{constructor(t,e,r){this.small=t,this.medium=e,this.big=r}isEmpty(){return this.small===he.NONE&&this.medium===he.NONE&&this.big===he.NONE}toList(){const t=[];return this.small.isPlayer()&&t.push(Je.ofSizeAndPlayer(tr.SMALL,this.small)),this.medium.isPlayer()&&t.push(Je.ofSizeAndPlayer(tr.MEDIUM,this.medium)),this.big.isPlayer()&&t.push(Je.ofSizeAndPlayer(tr.BIG,this.big)),t}toOrderedPieceNames(){const t=Je.ofSizeAndPlayer(tr.SMALL,this.small),e=Je.ofSizeAndPlayer(tr.MEDIUM,this.medium),r=Je.ofSizeAndPlayer(tr.BIG,this.big);return[t.toString(),e.toString(),r.toString()]}getBiggest(){return this.big===B.ZERO?Je.BIG_DARK:this.big===B.ONE?Je.BIG_LIGHT:this.medium===B.ZERO?Je.MEDIUM_DARK:this.medium===B.ONE?Je.MEDIUM_LIGHT:this.small===B.ZERO?Je.SMALL_DARK:this.small===B.ONE?Je.SMALL_LIGHT:Je.NONE}tryToSuperposePiece(t){const e=this.getBiggest().getSize();if(t===Je.NONE)throw new Error("Cannot move EMPTY on a space");return t.getSize()>e?T.of(this.put(t)):T.empty()}removeBiggest(){const t=this.getBiggest();if(t===Je.NONE)throw new Error("Cannot removed piece from empty space");let e;const r=t.getSize();switch(r){case tr.BIG:e=new Ui(this.small,this.medium,he.NONE);break;case tr.MEDIUM:e=new Ui(this.small,he.NONE,he.NONE);break;default:Me.expectToBe(r,tr.SMALL),e=new Ui(he.NONE,he.NONE,he.NONE)}return{removedSpace:e,removedPiece:t}}put(t){if(t===Je.NONE)throw new Error("Cannot put NONE on space");const e=t.getPlayer(),r=t.getSize();switch(r){case tr.BIG:return new Ui(this.small,this.medium,e);case tr.MEDIUM:return Pe(this.big===he.NONE,"Cannot put a piece on top of a bigger one"),new Ui(this.small,e,this.big);default:return Me.expectToBe(r,tr.SMALL),Pe(this.big===he.NONE,"Cannot put a piece on top of a bigger one"),Pe(this.medium===he.NONE,"Cannot put a piece on top of a bigger one"),new Ui(e,this.medium,this.big)}}encode(){return this.small.value+3*this.medium.value+9*this.big.value}belongsTo(t){return this.getBiggest().getPlayer()===t}toString(){const t=this.toOrderedPieceNames();return"("+t[0]+", "+t[1]+", "+t[2]+")"}}Ui.EMPTY=new Ui(he.NONE,he.NONE,he.NONE);let Gm=(()=>{class n{}return n.PIECE_OUT_OF_STOCK=()=>$localize`You do not have pieces of this type anymore.`,n.INVALID_PLACEMENT=()=>$localize`You must put your piece on an empty square or on a smaller piece.`,n.NOT_DROPPABLE=()=>$localize`You must pick your piece among the remaining ones.`,n.INVALID_PIECE_SELECTED=()=>$localize`You must pick one of your remaining pieces or one piece on the board that is the biggest of its square.`,n.END_YOUR_MOVE=()=>$localize`You are performing a move, you must select a landing square.`,n})();class z3 extends L1{static isVictory(t){const e=t.getCopiedBoard();for(const r of z3.LINES){const i=z3.isVictoriousLine([e[r[0].y][r[0].x],e[r[1].y][r[1].x],e[r[2].y][r[2].x]]);if(i.isPresent())return i}return T.empty()}static isVictoriousLine(t){const r=t.map(s=>s.getBiggest()).map(s=>s.getPlayer());return r[0]===he.NONE?T.empty():r[0]===r[1]&&r[1]===r[2]?T.of(r[0]):T.empty()}static isLegal(t,e){let s;if(Q(!1,t.toString()),t.isDropping()){if(s=t.piece.get(),!1===e.pieceBelongsToCurrentPlayer(s))return _e.failure(et.MUST_CHOOSE_PLAYER_PIECE());if(!1===e.isInRemainingPieces(s))return _e.failure(Gm.PIECE_OUT_OF_STOCK())}else{const c=t.startingCoord.get();if(s=e.getPieceAt(c).getBiggest(),!1===e.pieceBelongsToCurrentPlayer(s))return _e.failure(et.MUST_CHOOSE_PLAYER_PIECE())}const o=e.getPieceAt(t.landingCoord).tryToSuperposePiece(s);return o.isPresent()?_e.success(o.get()):_e.failure(Gm.INVALID_PLACEMENT())}isLegal(t,e){return z3.isLegal(t,e)}applyLegalMove(t,e,r){const s=e.getCopiedBoard();let i=e.getRemainingPieces();const o=e.turn+1;let c;if(s[t.landingCoord.y][t.landingCoord.x]=r,t.isDropping()){c=t.piece.get();const d=i.indexOf(c);i=i.slice(0,d).concat(i.slice(d+1))}else{const d=t.startingCoord.get(),m=s[d.y][d.x].removeBiggest();s[d.y][d.x]=m.removedSpace,c=m.removedPiece}return new p6(s,o,i)}static getGameStatus(t){const r=z3.isVictory(t.gameState);return r.isPresent()?xe.getVictory(r.get()):xe.ONGOING}getGameStatus(t){return z3.getGameStatus(t)}}z3.LINES=[[new S(0,0),new S(0,1),new S(0,2)],[new S(1,0),new S(1,1),new S(1,2)],[new S(2,0),new S(2,1),new S(2,2)],[new S(0,0),new S(1,0),new S(2,0)],[new S(0,1),new S(1,1),new S(2,1)],[new S(0,2),new S(1,2),new S(2,2)],[new S(0,0),new S(1,1),new S(2,2)],[new S(0,2),new S(1,1),new S(2,0)]];class Ci extends Fi{constructor(t,e,r){super(),this.startingCoord=t,this.landingCoord=e,this.piece=r}static fromMove(t,e){if(t.equals(e))throw new Error("Starting coord and landing coord must be separate coords");return new Ci(T.of(t),e,T.empty())}static fromDrop(t,e){return new Ci(T.empty(),e,T.of(t))}isDropping(){return this.startingCoord.isAbsent()}equals(t){return this===t||!1!==t.landingCoord.equals(this.landingCoord)&&!1!==this.startingCoord.equals(t.startingCoord)&&this.piece.equals(t.piece)}toString(){return this.isDropping()?"EncapsuleMove("+this.piece.get().toString()+" -> "+this.landingCoord+")":"EncapsuleMove("+this.startingCoord.get()+"->"+this.landingCoord+")"}}Ci.encoder=Nt.tuple([T.getEncoder(S.encoder),S.encoder,T.getEncoder(Je.encoder)],n=>[n.startingCoord,n.landingCoord,n.piece],n=>new Ci(n[0],n[1],n[2]));class Ult extends xs{getMetrics(t){return[0,0]}getListMoves(t){const e=[],r=t.gameState,s=r.getCopiedBoard(),i=r.getCurrentPlayer(),o=Ite.toComparableObjectSet(r.getPlayerRemainingPieces());for(let c=0;c<3;c++)for(let u=0;u<3;u++){const d=new S(u,c);for(const g of o){const m=Ci.fromDrop(g,d);z3.isLegal(m,r).isSuccess()&&e.push(m)}if(s[c][u].belongsTo(i))for(let g=0;g<3;g++)for(let m=0;m<3;m++){const y=new S(m,g);if(!y.equals(d)){const b=Ci.fromMove(d,y);z3.isLegal(b,r).isSuccess()&&e.push(b)}}}return e}}const Ro=new Ui(he.NONE,he.NONE,he.NONE),a3e=new Ui(B.ZERO,he.NONE,he.NONE),Glt=new Ui(he.NONE,B.ZERO,he.NONE),Wlt=new Ui(he.NONE,he.NONE,B.ZERO),c3e=new Ui(B.ONE,he.NONE,he.NONE),bP=new Ui(he.NONE,he.NONE,B.ONE),qlt=new Ui(B.ONE,B.ZERO,he.NONE),jlt=new Ui(B.ZERO,B.ZERO,he.NONE);class l3e extends $1{constructor(){super(...arguments),this.tutorial=[ie.informational($localize`Goal of the game`,$localize`The goal of Encapsule is to align three of your pieces.
        Here, we have a victory of the dark player.`,new p6([[a3e,c3e,bP],[Ro,Glt,Ro],[Ro,Ro,Wlt]],0,[Je.SMALL_DARK,Je.MEDIUM_DARK,Je.BIG_DARK,Je.SMALL_LIGHT,Je.MEDIUM_LIGHT,Je.MEDIUM_LIGHT,Je.BIG_LIGHT])),ie.anyMove($localize`Putting a piece`,$localize`This is the initial board.<br/><br/>
        You're playing Dark. Pick one of your piece on the side of the board and put it on the board.`,p6.getInitialState(),Ci.fromDrop(Je.SMALL_DARK,new S(1,1)),$localize`Congratulations!`),ie.fromMove($localize`Moving`,$localize`Another possible action is to move one of your pieces that is already on the board.<br/><br/>
        You're playing Dark, click on your piece already on the board and then on any empty square of the board.`,new p6([[a3e,bP,Ro],[Ro,Ro,Ro],[Ro,Ro,Ro]],0,[]),[Ci.fromMove(new S(0,0),new S(2,0)),Ci.fromMove(new S(0,0),new S(0,1)),Ci.fromMove(new S(0,0),new S(1,1)),Ci.fromMove(new S(0,0),new S(2,1)),Ci.fromMove(new S(0,0),new S(0,2)),Ci.fromMove(new S(0,0),new S(1,2)),Ci.fromMove(new S(0,0),new S(2,2))],$localize`Congratulations!`,$localize`Failed. Try again.`),ie.fromPredicate($localize`Particularity`,$localize`At Encapsule, pieces encapsulate each other.
        It is therefore possible to have up to three pieces per square!
        However, only the biggest piece of each square counts:
        you cannot win with a piece that is "hidden" by a bigger piece.
        Similarly, you cannot move a piece if it is encapsulated by a bigger piece.
        Finally, you cannot encapsulate a piece with a smaller piece.
        Here, Dark can win now in various ways.<br/><br/>
        You're playing Dark, try to win by making a move, and not by putting a new piece on the board.`,new p6([[qlt,Ro,c3e],[jlt,bP,bP],[Ro,Ro,Ro]],0,[Je.MEDIUM_DARK,Je.BIG_DARK,Je.MEDIUM_LIGHT,Je.MEDIUM_LIGHT]),Ci.fromMove(new S(0,1),new S(0,2)),(t,e,r)=>{if(t.landingCoord.equals(new S(0,2))){if(t.isDropping())return R.failure($localize`You won, but the exercise is to win while moving a piece!`);if(t.startingCoord.equalsValue(new S(0,1)))return R.SUCCESS}return R.failure($localize`Failed. Try again.`)},$localize`Congratulations!`)]}}function Zlt(n,t){if(1&n){const e=Oe();F(),O(0,"g")(1,"circle",5),ee("click",function(){const s=ue(e),i=s.$implicit,o=s.index,c=C().$implicit;return ce(C().onPieceClick(c.value,i,o))}),A()()}if(2&n){const e=t.$implicit,r=t.index,s=C().$implicit,i=C();P(1),j2("id","piece_",s.value,"_",e.toString(),"_",r,""),w("ngClass",i.getSidePieceClasses(e,r)),z("transform","rotate("+180*(i.role.value+s.value)+" "+i.CENTER+" "+i.CENTER+")")("r",i.getPieceRadius(e))("cx",i.getRemainingPieceCenterCoord(s,r).x)("cy",i.getRemainingPieceCenterCoord(s,r).y)}}function Ylt(n,t){if(1&n&&(F(),O(0,"g",null,4),x(2,Zlt,2,8,"g",1),A()),2&n){const e=t.$implicit,r=C();P(2),w("ngForOf",r.getRemainingPieces(e))}}function Klt(n,t){if(1&n){const e=Oe();F(),O(0,"circle",8),ee("click",function(){ue(e);const s=C().index,i=C().index;return ce(C().onBoardClick(s,i))}),A()}if(2&n){const e=t.$implicit,r=C().index,s=C().index,i=C();w("ngClass",i.getPieceClasses(e)),z("r",i.getPieceRadius(e))("cx",i.getPieceCenter(r))("cy",i.getPieceCenter(s))}}function Xlt(n,t){if(1&n){const e=Oe();F(),O(0,"g")(1,"rect",6),ee("click",function(){const i=ue(e).index,o=C().index;return ce(C().onBoardClick(i,o))}),A(),x(2,Klt,1,4,"circle",7),A()}if(2&n){const e=t.$implicit,r=t.index,s=C().index,i=C();P(1),De("id","click_",r,"_",s,""),w("ngClass",i.getRectClasses(r,s)),z("x",i.SPACE_SIZE*r+i.STROKE_WIDTH)("y",i.SPACE_SIZE*s+i.STROKE_WIDTH)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),P(1),w("ngForOf",i.getListPieces(e))}}function Qlt(n,t){if(1&n&&(F(),O(0,"g"),x(1,Xlt,3,8,"g",1),A()),2&n){const e=t.$implicit;P(1),w("ngForOf",e)}}function Jlt(n,t){if(1&n){const e=Oe();F(),O(0,"rect",9),ee("click",function(){ue(e);const s=C();return ce(s.onBoardClick(s.chosenCoord.get().x,s.chosenCoord.get().y))}),A()}if(2&n){const e=C();De("id","chosenCoord_",e.chosenCoord.get().x,"_",e.chosenCoord.get().y,""),z("x",e.SPACE_SIZE*e.chosenCoord.get().x+e.STROKE_WIDTH)("y",e.SPACE_SIZE*e.chosenCoord.get().y+e.STROKE_WIDTH)("width",e.SPACE_SIZE)("height",e.SPACE_SIZE)}}let e6t=(()=>{class n extends ko{constructor(e){super(e),this.CENTER=this.getPieceCenter(1),this.UPLEFT=-(this.SPACE_SIZE+.5*this.STROKE_WIDTH),this.WIDTH=5*this.SPACE_SIZE+3*this.STROKE_WIDTH,this.lastLandingCoord=T.empty(),this.lastStartingCoord=T.empty(),this.chosenCoord=T.empty(),this.chosenPiece=T.empty(),this.remainingPieceCenterCoords=new Un,this.rules=new z3(p6),this.availableMinimaxes=[new Ult(this.rules,"EncapsuleMinimax")],this.encoder=Ci.encoder,this.tutorial=(new l3e).tutorial,this.updateBoard()}updateBoard(){const e=this.getState();this.board=e.getCopiedBoard();const r=this.rules.node.move;this.calculateLeftPieceCoords(),r.isPresent()?(this.lastLandingCoord=T.of(r.get().landingCoord),this.lastStartingCoord=r.get().startingCoord):(this.lastLandingCoord=T.empty(),this.lastStartingCoord=T.empty())}getListPieces(e){return e.toList()}getRemainingPieces(e){return this.getState().getRemainingPiecesOfPlayer(e)}onBoardClick(e,r){var s=this;return I(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());const o=new S(e,r),c=s.getState();if(s.chosenCoord.isAbsent()){if(s.chosenCoord=T.of(o),s.chosenPiece.isPresent()){const u=Ci.fromDrop(s.chosenPiece.get(),o);return s.chooseMove(u,s.getState())}return!1===c.getPieceAt(o).belongsTo(c.getCurrentPlayer())?s.cancelMove(Gm.INVALID_PIECE_SELECTED()):R.SUCCESS}if(s.chosenCoord.equalsValue(o))return s.cancelMoveAttempt(),R.SUCCESS;{const u=Ci.fromMove(s.chosenCoord.get(),o);return s.chooseMove(u,s.getState())}})()}cancelMoveAttempt(){this.chosenCoord=T.empty(),this.chosenPiece=T.empty(),this.chosenPieceIndex=T.empty()}onPieceClick(e,r,s){var i=this;return I(function*(){const o="#piece_"+e+"_"+r.toString()+"_"+s,c=i.canUserPlay(o);return c.isFailure()?i.cancelMove(c.getReason()):!1===i.getState().isDroppable(r)?i.cancelMove(Gm.NOT_DROPPABLE()):i.chosenCoord.isAbsent()?(i.chosenPiece.equalsValue(r)&&i.chosenPieceIndex.equalsValue(s)?(i.chosenPiece=T.empty(),i.chosenPieceIndex=T.empty()):(i.chosenPiece=T.of(r),i.chosenPieceIndex=T.of(s)),R.SUCCESS):i.cancelMove(Gm.END_YOUR_MOVE())})()}getRectClasses(e,r){return this.isSelected(e,r)?"moved-fill":""}isSelected(e,r){const s=new S(e,r);return!(!this.lastStartingCoord.equalsValue(s)&&!this.lastLandingCoord.equalsValue(s))}getPieceClasses(e){return[this.getPieceStrokeClass(e)]}getPieceCenter(e){return this.SPACE_SIZE*e+this.STROKE_WIDTH+this.SPACE_SIZE/2}getPieceStrokeClass(e){const r=e.getPlayer();return Pe(r.isPlayer(),"EncapsuleComponent.getPieceStrokeClass should only be called with actual pieces!"),"player"+r.value+"-stroke"}getPieceRadius(e){switch(e.getSize()){case tr.BIG:return this.SPACE_SIZE/2-1*this.STROKE_WIDTH;case tr.MEDIUM:return this.SPACE_SIZE/2-2*this.STROKE_WIDTH-3;default:return Me.expectToBe(e.getSize(),tr.SMALL),this.SPACE_SIZE/2-3*this.STROKE_WIDTH-6}}getSidePieceClasses(e,r){const s=this.getPieceClasses(e);return this.isSelectedPiece(e)&&this.chosenPieceIndex.equalsValue(r)&&s.push("selected-stroke"),s}isSelectedPiece(e){return this.chosenPiece.equalsValue(e)}calculateLeftPieceCoords(){this.remainingPieceCenterCoords=new Un;for(const e of B.PLAYERS){const r=[],s=this.getRemainingPieces(e);for(let i=0;i<s.length;i++){let o,c=0,u=0;i<=2?(o=new S(2-i,3),u=this.STROKE_WIDTH):(o=new S(-1,5-i),c=-this.STROKE_WIDTH);const d=this.getPieceCenter(o.x),g=this.getPieceCenter(o.y);r.push(new S(d+c,g+u))}this.remainingPieceCenterCoords.set(e,r)}}getRemainingPieceCenterCoord(e,r){return this.remainingPieceCenterCoords.get(e).get()[r]}}return n.\u0275fac=function(e){return new(e||n)(J(En))},n.\u0275cmp=dt({type:n,selectors:[["app-encapsule"]],features:[l],decls:6,vars:4,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["boardDiv",""],["class","base no-fill selected-stroke","pointer-events","fill",3,"id","click",4,"ngIf"],["remainingPieces",""],["pointer-events","fill",1,"base","no-fill",3,"id","ngClass","click"],[1,"base",3,"id","ngClass","click"],["class","base no-fill",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"base","no-fill",3,"ngClass","click"],["pointer-events","fill",1,"base","no-fill","selected-stroke",3,"id","click"]],template:function(e,r){1&e&&(F(),O(0,"svg",0),x(1,Ylt,3,1,"g",1),O(2,"g",null,2),x(4,Qlt,2,1,"g",1),x(5,Jlt,1,6,"rect",3),A()()),2&e&&(z("viewBox",r.UPLEFT+" "+r.UPLEFT+" "+r.WIDTH+" "+r.WIDTH),P(1),w("ngForOf",r.Player.PLAYERS),P(3),w("ngForOf",r.board),P(1),w("ngIf",r.chosenCoord.isPresent()))},dependencies:[fn,On,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class Fc extends Ks{constructor(t,e,r,s,i){if(super(t,e),this.movedPieces=r,this.stepSize=s,this.direction=i,this.coord.isNotInRange(14,12))throw new Error("Illegal coord outside of board "+this.coord.toString()+".");if(r<1)throw new Error("Must select minimum one piece (got "+r+").");if(s<1)throw new Error("Step size must be minimum one (got "+s+").");if(s>r)throw new Error("Cannot move a phalanx further than its size (got step size "+s+" for "+r+" pieces).")}toString(){return"EpaminondasMove("+this.coord.toString()+", m:"+this.movedPieces+", s:"+this.stepSize+", "+this.direction.toString()+")"}equals(t){return this===t||!(!this.coord.equals(t.coord)||this.movedPieces!==t.movedPieces||this.stepSize!==t.stepSize)&&this.direction.equals(t.direction)}}Fc.encoder=Nt.tuple([S.encoder,Nt.identity(),Nt.identity(),Ne.encoder],n=>[n.coord,n.movedPieces,n.stepSize,n.direction],n=>new Fc(n[0].x,n[0].y,n[1],n[2],n[3]));class V3 extends Br{static getInitialState(){const t=he.NONE,e=he.ZERO,r=he.ONE;return new V3([[r,r,r,r,r,r,r,r,r,r,r,r,r,r],[r,r,r,r,r,r,r,r,r,r,r,r,r,r],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e]],0)}count(t,e){let r=0;for(let s=0;s<14;s++)this.board[e][s]===t&&r++;return r}doesOwnPiece(t){for(let e=0;e<12;e++)for(let r=0;r<14;r++)if(this.board[e][r]===t)return!0;return!1}}let Bc=(()=>{class n{}return n.PHALANX_IS_LEAVING_BOARD=()=>$localize`The move distance of your phalanx puts it out of the board.`,n.SOMETHING_IN_PHALANX_WAY=()=>$localize`There is something in the way of your phalanx.`,n.PHALANX_SHOULD_BE_GREATER_TO_CAPTURE=()=>$localize`Your phalanx must be bigger than the one you are capturing.`,n.SQUARE_NOT_ALIGNED_WITH_SELECTED=()=>$localize`This square is not aligned with the selected piece.`,n.SINGLE_PIECE_MUST_MOVE_BY_ONE=()=>$localize`A single piece can only move by one square.`,n.SINGLE_PIECE_CANNOT_CAPTURE=()=>$localize`A single piece cannot make a capture.`,n.SQUARE_NOT_ALIGNED_WITH_PHALANX=()=>$localize`This square is not aligned with the direction of the phalanx.`,n.PHALANX_CANNOT_CONTAIN_PIECES_OUTSIDE_BOARD=()=>$localize`A phalanx can't contain pieces outside of the board.`,n.PHALANX_CANNOT_CONTAIN_EMPTY_SQUARE=()=>$localize`A phalanx cannot contain an empty square.`,n.PHALANX_CANNOT_CONTAIN_OPPONENT_PIECE=()=>$localize`A phalanx cannot contain a piece of the opponent.`,n})();class h8 extends L1{static isLegal(t,e){const r=this.getPhalanxValidity(e,t);if(r.isFailure())return _e.failure(r.getReason());const s=this.getLandingStatus(e,t);if(s.isFailure())return s;const i=Xe.copyBiArray(s.get()),o=e.getCurrentOpponent(),c=h8.getCaptureValidity(e,i,t,o);return c.isFailure()?c:_e.success(c.get())}static getPhalanxValidity(t,e){let r=e.coord,s=0;const i=t.getCurrentOpponent();for(;s<e.movedPieces;){if(r.isNotInRange(14,12))return R.failure(Bc.PHALANX_CANNOT_CONTAIN_PIECES_OUTSIDE_BOARD());const o=t.getPieceAt(r);if(o===he.NONE)return R.failure(Bc.PHALANX_CANNOT_CONTAIN_EMPTY_SQUARE());if(o===i)return R.failure(Bc.PHALANX_CANNOT_CONTAIN_OPPONENT_PIECE());r=r.getNext(e.direction,1),s++}return R.SUCCESS}static getLandingStatus(t,e){const r=t.getCopiedBoard(),s=t.getCurrentPlayer();let i=e.coord,o=e.coord.getNext(e.direction,e.movedPieces),c=0;for(;c+1<e.stepSize;){if(r[i.y][i.x]=he.NONE,r[o.y][o.x]=s,o.isNotInRange(14,12))return _e.failure(Bc.PHALANX_IS_LEAVING_BOARD());if(t.getPieceAt(o).isPlayer())return _e.failure(Bc.SOMETHING_IN_PHALANX_WAY());c++,o=o.getNext(e.direction,1),i=i.getNext(e.direction,1)}return o.isNotInRange(14,12)?_e.failure(Bc.PHALANX_IS_LEAVING_BOARD()):t.getPieceAt(o)===s?_e.failure(et.SHOULD_LAND_ON_EMPTY_OR_OPPONENT_SPACE()):(r[i.y][i.x]=he.NONE,r[o.y][o.x]=s,_e.success(r))}static getCaptureValidity(t,e,r,s){let i=r.coord.getNext(r.direction,r.movedPieces+r.stepSize-1),o=0;for(;i.isInRange(14,12)&&t.getPieceAt(i)===s;){if(o>0&&(e[i.y][i.x]=he.NONE),o++,o>=r.movedPieces)return _e.failure(Bc.PHALANX_SHOULD_BE_GREATER_TO_CAPTURE());i=i.getNext(r.direction,1)}return _e.success(e)}isLegal(t,e){return h8.isLegal(t,e)}applyLegalMove(t,e,r){return new V3(r,e.turn+1)}getGameStatus(t){const e=t.gameState,r=e.count(B.ZERO,0),s=e.count(B.ONE,11);if(e.turn%2==0){if(r>s)return xe.ZERO_WON}else if(s>r)return xe.ONE_WON;return!1===e.doesOwnPiece(B.ZERO)?xe.ONE_WON:!1===e.doesOwnPiece(B.ONE)?xe.ZERO_WON:xe.ONGOING}}class Wm extends k3{static getListMoves(t){const e=t.gameState.getCurrentPlayer(),r=t.gameState.getCurrentOpponent(),s=he.NONE;let i=[];const o=t.gameState;let c;for(let u=0;u<12;u++)for(let d=0;d<14;d++){const g=new S(d,u);if(o.getPieceAt(g)===e)for(const m of Ne.DIRECTIONS){let y=1,b=g.getNext(m,1);for(;b.isInRange(14,12)&&o.getPieceAt(b)===e;)y+=1,b=b.getNext(m,1);let k=1;for(;b.isInRange(14,12)&&k<=y&&o.getPieceAt(b)===s;)c=new Fc(d,u,y,k,m),i=this.addMove(i,c,o),k++,b=b.getNext(m,1);b.isInRange(14,12)&&k<=y&&o.getPieceAt(b)===r&&(c=new Fc(d,u,y,k,m),i=this.addMove(i,c,o))}}return i}static addMove(t,e,r){return h8.isLegal(e,r).isSuccess()&&t.push(e),t}getListMoves(t){const e=Wm.getListMoves(t);return Xe.sortByDescending(e,r=>r.stepSize),e}getBoardValue(t){const e=this.ruler.getGameStatus(t);return e.isEndGame?e.toBoardValue():new k1(this.getPieceCountPlusRowDomination(t.gameState))}getPieceCountPlusRowDomination(t){let o=0;for(let c=0;c<12;c++){let u=0;const d=[0,0];for(let g=0;g<14;g++){const m=new S(g,c),y=t.getPieceAt(m);if(y.isPlayer()){const b=y.getScoreModifier();o+=2002*b,d[y.value]=b,u+=b;for(const k of[Ne.UP_LEFT,Ne.UP,Ne.UP_RIGHT]){let $=m.getNext(k,1);for(;$.isInRange(14,12)&&t.getPieceAt($)===y;)o+=1*b,$=$.getNext(k,1)}}}0!==u&&(o+=Math.abs(u)/u*2),o+=1*d.reduce((g,m)=>g+m)}return o}}class t6t extends k3{getListMoves(t){const e=Wm.getListMoves(t);return this.orderMovesByPhalanxSizeAndFilter(e,t.gameState)}orderMovesByPhalanxSizeAndFilter(t,e){return Xe.sortByDescending(t,r=>r.movedPieces),t.length>40?t.filter(s=>!!this.moveIsCapture(s,e)||s.movedPieces*Math.random()>1):t}moveIsCapture(t,e){const r=t.coord.getNext(t.direction,t.movedPieces+t.stepSize-1);return e.board[r.y][r.x]===e.getCurrentOpponent()}getBoardValue(t){const e=this.ruler.getGameStatus(t);return e.isEndGame?e.toBoardValue():new k1(this.getPieceCountThenSupportThenAdvancement(t.gameState))}getPieceCountThenSupportThenAdvancement(t){let o=0;for(let c=0;c<12;c++)for(let u=0;u<14;u++){const d=new S(u,c),g=t.getPieceAt(d);if(g.isPlayer()){let m,y;g===B.ZERO?(m=12-c,y=[Ne.UP_LEFT,Ne.UP,Ne.UP_RIGHT]):(m=c+1,y=[Ne.DOWN_LEFT,Ne.DOWN,Ne.DOWN_RIGHT]);const b=g.getScoreModifier();o+=m*b,o+=149629*b;for(const k of y){let $=d.getNext(k,1);for(;$.isInRange(14,12)&&t.getPieceAt($)===g;)o+=337*b,$=$.getNext(k,1)}}}return o}}class n6t extends Wm{constructor(){super(...arguments),this.DOMINANCE_FACTOR=20,this.DEFENSE_FACTOR=5,this.TERRITORY_FACTOR=2,this.OFFENSE_FACTOR=10,this.CENTER_FACTOR=5,this.MOBILITY_FACTOR=.12}getDominance(t){let e=0;for(let r=0;r<12;r++)for(let s=0;s<14;s++){const i=t.getPieceAt(new S(s,r));i.isPlayer()&&(e+=i.getScoreModifier())}return e*this.DOMINANCE_FACTOR}getDefense(t){let e=0;for(let r=0;r<14;r++)t.getPieceAt(new S(r,11))===B.ZERO&&(e+=B.ZERO.getScoreModifier()),t.getPieceAt(new S(r,0))===B.ONE&&(e+=B.ONE.getScoreModifier());return e*this.DEFENSE_FACTOR}getTerritory(t){let e=0;for(let r=0;r<12;r++)for(let s=0;s<14;s++){const i=t.getPieceAt(new S(s,r));if(i.isPlayer()){for(let o=-1;o<=1;o++)for(let c=-1;c<=1;c++){const u=new S(s+o,r+c);if(u.isInRange(14,12)){const d=t.getPieceAt(u);(d===i||d===he.NONE)&&(e+=1*i.getScoreModifier())}}e-=i.getScoreModifier()}}return e*this.TERRITORY_FACTOR}getOffense(t){let e=0;for(let r=0;r<14;r++)t.getPieceAt(new S(r,0))===B.ZERO&&(e+=B.ZERO.getScoreModifier()),t.getPieceAt(new S(r,11))===B.ONE&&(e+=B.ONE.getScoreModifier());return e*this.OFFENSE_FACTOR}getCenter(t){let e=0;for(let r=0;r<12;r++)for(let s=0;s<14;s++){const i=t.getPieceAt(new S(s,r));i.isPlayer()&&(e+=i.getScoreModifier()*Math.sqrt((s-6.5)*(s-6.5)))}return e*this.CENTER_FACTOR}getMobility(t){let e=0,r=0,s=0;for(let i=0;i<12;i++)for(let o=0;o<14;o++){const c=new S(o,i),u=t.getPieceAt(c);if(u.isPlayer())for(const d of Ne.DIRECTIONS){let g=1,m=c.getNext(d,1);for(;m.isInRange(14,12)&&t.getPieceAt(m)===u;)g+=1,m=m.getNext(d,1);let y=1;for(;m.isInRange(14,12)&&y<=g&&t.getPieceAt(m)===he.NONE;)y++,m=m.getNext(d,1);e+=y*y*u.getScoreModifier(),u===B.ZERO?r=Math.max(r,y):u===B.ONE&&(s=Math.max(s,y))}}return(e+r*B.ZERO.getScoreModifier()+s*B.ONE.getScoreModifier())*this.MOBILITY_FACTOR}getBoardValue(t){const e=t.gameState,r=this.ruler.getGameStatus(t);if(r.isEndGame)return r.toBoardValue();const s=this.getDominance(e),i=this.getDefense(e),o=this.getTerritory(e),c=this.getCenter(e),u=this.getOffense(e),d=this.getMobility(e);return new k1(s+i+o+c+u+d)}}const L=he.NONE,Ir=he.ZERO,W1=he.ONE;class u3e extends $1{constructor(){super(...arguments),this.tutorial=[ie.informational($localize`Initial board`,$localize`This is the initial board of Epaminondas.
        The top line is the starting line of Light.
        The bottom line is the starting line of Dark.`,V3.getInitialState()),ie.informational($localize`Goal of the game (1/2)`,$localize`After multiple moves, if at the beginning of its turn, a player has more pieces on the opponent's starting line
        than the number of pieces the opponent has on the player's starting line, the player wins.
        Here, it's Dark's turn to play: Dark has therefore won.`,new V3([[L,L,L,L,L,Ir,L,L,W1,W1,W1,W1,W1,W1],[L,L,L,L,L,Ir,L,L,L,L,L,L,W1,W1],[L,L,L,L,L,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,W1,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,Ir,Ir,Ir,Ir,L,L,L]],0)),ie.informational($localize`Goal of the game (2/2)`,$localize`Here, it is Light's turn.
        Light wins because they have two pieces on Dark's starting line, and Dark only has one on Light's starting line.`,new V3([[L,L,L,L,L,Ir,L,L,L,L,W1,W1,W1,W1],[L,L,L,L,L,Ir,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,W1,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,L,L,L,L,L],[L,L,W1,W1,L,L,L,Ir,Ir,L,Ir,Ir,Ir,Ir]],1)),ie.fromPredicate($localize`Moving a piece`,$localize`Here is the starting board. Dark plays first.
        Let's start with moving a single piece:
        <ol>
            <li>Click on a piece.</li>
            <li>Click on a empty neighboring square.</li>
        </ol><br/>You're playing Dark, move a piece.`,V3.getInitialState(),new Fc(0,10,1,1,Ne.UP),(t,e,r)=>1===t.movedPieces?R.SUCCESS:R.failure($localize`Congratulations, you are in advance. But this is not the exercise here, try again.`),$localize`This is how you move a single piece.`),ie.fromPredicate($localize`Moving a phalanx`,$localize`Let us now see how to move multiple pieces along a line, which is called a phalanx:
        <ol>
            <li>Click on the first piece of the phalanx.</li>
            <li>Click on the last piece of the phalanx.</li>
            <li>Click on one of the squares highlighted in yellow; you can move your phalanx up to a distance equal to its length.</li>
        </ol><br/>
        You're playing Dark, Move a phalanx!`,V3.getInitialState(),new Fc(0,11,2,1,Ne.UP),(t,e,r)=>t.movedPieces>1?R.SUCCESS:R.failure($localize`Failed! You moved only one piece.`),$localize`Congratulations!
        The moved pieces can be horizontally, vertically, or diagonally aligned.
        The move should be made along this axis, forward or backwards.
        There can be no opponent nor holes in the phalanx.`),ie.fromMove($localize`Capture`,$localize`In order to capture pieces of the opponent:
        <ol>
            <li>It must be aligned with the phalanx you are moving.</li>
            <li>It must be strictly shorter than your phalanx.</li>
            <li>The first piece of your phalanx should land on the first piece of the opponent's phalanx that you want to capture.</li>
        </ol><br/>
        You're playing Dark, capture a phalanx.`,new V3([[L,L,L,L,L,L,L,L,W1,W1,W1,W1,W1,W1],[L,L,L,L,L,L,W1,L,L,L,L,L,L,L],[L,L,L,L,L,W1,L,L,L,L,L,L,L,L],[L,L,W1,L,W1,L,L,L,L,L,L,L,L,L],[L,L,W1,W1,L,L,L,L,L,L,L,L,L,L],[L,L,W1,L,L,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,L,L,L,L,L],[L,L,Ir,L,L,L,L,L,L,L,L,L,L,L],[L,L,Ir,L,L,L,L,W1,L,L,L,L,L,L],[L,L,Ir,L,L,L,L,L,L,L,L,L,L,L],[L,L,Ir,L,L,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,Ir,Ir,Ir,Ir,Ir,Ir,Ir]],0),[new Fc(2,10,4,2,Ne.UP)],$localize`Congratulations, you made it!
        Note that the diagonal phalanx was not aligned with your phalanx, hence even if it is longer, this does not prevent you from capturing some of its pieces on another alignment.`,$localize`Failed, you have not captured the phalanx.`)]}}function r6t(n,t){if(1&n){const e=Oe();F(),O(0,"circle",4),ee("click",function(){ue(e);const s=C().index,i=C().index;return ce(C().onClick(s,i))}),A()}if(2&n){const e=C().index,r=C().index,s=C();w("ngClass",s.getPieceClasses(e,r)),z("cx",s.SPACE_SIZE*e+s.STROKE_WIDTH+s.SPACE_SIZE/2)("cy",s.SPACE_SIZE*r+s.STROKE_WIDTH+s.SPACE_SIZE/2)("r",s.SPACE_SIZE/2-s.STROKE_WIDTH)}}function s6t(n,t){if(1&n){const e=Oe();F(),O(0,"g")(1,"rect",2),ee("click",function(){const i=ue(e).index,o=C().index;return ce(C().onClick(i,o))}),A(),x(2,r6t,1,4,"circle",3),A()}if(2&n){const e=t.index,r=C().index,s=C();P(1),De("id","click_",e,"_",r,""),w("ngClass",s.getRectClasses(e,r)),z("x",s.SPACE_SIZE*e+s.STROKE_WIDTH)("y",s.SPACE_SIZE*r+s.STROKE_WIDTH)("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),P(1),w("ngIf",s.board[r][e]!==s.NONE)}}function i6t(n,t){if(1&n&&(F(),O(0,"g"),x(1,s6t,3,8,"g",1),A()),2&n){const e=t.$implicit;P(1),w("ngForOf",e)}}function o6t(n,t){if(1&n){const e=Oe();F(),O(0,"g")(1,"rect",5),ee("click",function(){const i=ue(e).$implicit;return ce(C().onClick(i.x,i.y))}),A()()}if(2&n){const e=t.$implicit,r=C();P(1),z("x",r.SPACE_SIZE*e.x+r.STROKE_WIDTH)("y",r.SPACE_SIZE*e.y+r.STROKE_WIDTH)("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)}}let a6t=(()=>{class n extends ko{constructor(e){super(e),this.NONE=he.NONE,this.firstPiece=T.empty(),this.validExtensions=[],this.phalanxValidLandings=[],this.lastPiece=T.empty(),this.phalanxDirection=T.empty(),this.phalanxMiddles=[],this.moveds=[],this.capturedCoords=[],this.hasAsymmetricBoard=!0,this.rules=new h8(V3),this.availableMinimaxes=[new Wm(this.rules,"Normal"),new t6t(this.rules,"Positional"),new n6t(this.rules,"Attack")],this.encoder=Fc.encoder,this.tutorial=(new u3e).tutorial,this.updateBoard()}updateBoard(){this.firstPiece=T.empty(),this.lastPiece=T.empty(),this.hidePreviousMove(),this.board=this.getState().getCopiedBoard()}showLastMove(e){let r=e.coord;this.moveds=[r];for(let o=1;o<e.stepSize+e.movedPieces;o++)r=r.getNext(e.direction,1),this.moveds.push(r);const s=this.rules.node.mother.get(),i=s.gameState.getCurrentOpponent();for(;r.isInRange(14,12)&&s.gameState.getPieceAt(r)===i;)this.capturedCoords.push(r),r=r.getNext(e.direction,1)}onClick(e,r){var s=this;return I(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);return i.isFailure()?s.cancelMove(i.getReason()):s.firstPiece.isAbsent()?s.firstClick(e,r):s.lastPiece.isAbsent()?s.secondClick(e,r):s.thirdClick(e,r)})()}firstClick(e,r){var s=this;return I(function*(){const i=s.getState().getCurrentOpponent(),o=s.getState().getCurrentPlayer();switch(s.board[r][e]){case o:return s.firstPiece=T.of(new S(e,r)),s.validExtensions=s.getValidExtensions(o),s.phalanxValidLandings=s.getPhalanxValidLandings(),R.SUCCESS;case i:return s.cancelMove(et.CANNOT_CHOOSE_OPPONENT_PIECE());default:return Me.expectToBe(s.board[r][e],he.NONE),s.cancelMove(et.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY())}})()}hidePreviousMove(){this.capturedCoords=[],this.moveds=[]}getValidExtensions(e){return this.lastPiece.isPresent()?this.getPhalanxValidExtensions(e):this.getFirstPieceExtensions(e)}getFirstPieceExtensions(e){const r=[];for(const s of Ne.DIRECTIONS){let i=this.firstPiece.get().getNext(s,1);for(;i.isInRange(14,12)&&this.board[i.y][i.x]===e;)r.push(i),i=i.getNext(s,1)}return r}getPhalanxValidExtensions(e){let r=Ne.factory.fromMove(this.firstPiece.get(),this.lastPiece.get()).get();const s=this.lastPiece.get().getNext(r,1),i=this.getExtensionsToward(s,r,e);r=r.getOpposite();const o=this.firstPiece.get().getNext(r,1),c=this.getExtensionsToward(o,r,e);return i.concat(c)}getExtensionsToward(e,r,s){const i=[];for(;e.isInRange(14,12)&&this.board[e.y][e.x]===s;)i.push(e),e=e.getNext(r,1);return i}getPhalanxValidLandings(){if(this.lastPiece.isPresent()){const e=this.firstPiece.get(),r=this.lastPiece.get(),s=Math.abs(e.x-r.x),i=Math.abs(e.y-r.y),o=Math.max(s,i)+1;let c=Ne.factory.fromMove(e,r).get();const u=r.getNext(c,1),d=this.getLandingsToward(u,c,o);c=c.getOpposite();const g=e.getNext(c,1);return this.getLandingsToward(g,c,o).concat(d)}return this.getNeighboringEmptySpaces()}getNeighboringEmptySpaces(){const e=[];for(const r of Ne.DIRECTIONS){const s=this.firstPiece.get().getNext(r,1);s.isInRange(14,12)&&this.board[s.y][s.x]===he.NONE&&e.push(s)}return e}getLandingsToward(e,r,s){const i=this.getState().getCurrentPlayer(),o=this.getState().getCurrentOpponent(),c=[];for(;e.isInRange(14,12)&&c.length<s&&this.board[e.y][e.x]!==i;){if(this.board[e.y][e.x]===o)return this.getPhalanxLength(e,r,o)<s&&c.push(e),c;c.push(e),e=e.getNext(r,1)}return c}getPhalanxLength(e,r,s){let i=0;for(;e.isInRange(14,12)&&this.board[e.y][e.x]===s;)i++,e=e.getNext(r,1);return i}cancelMoveAttempt(){this.firstPiece=T.empty(),this.validExtensions=[],this.phalanxValidLandings=[],this.lastPiece=T.empty(),this.phalanxMiddles=[],this.hidePreviousMove()}secondClick(e,r){var s=this;return I(function*(){const i=new S(e,r),o=s.firstPiece.get();if(i.equals(o))return s.cancelMoveAttempt(),R.SUCCESS;const c=s.getState().getCurrentOpponent(),u=s.getState().getCurrentPlayer();if(!i.isAlignedWith(o))return s.cancelMove(Bc.SQUARE_NOT_ALIGNED_WITH_SELECTED());const d=i.getDistance(o),g=o.getDirectionToward(i).get();switch(s.board[r][e]){case he.NONE:return 1===d?s.tryMove(new Fc(o.x,o.y,1,1,g)):s.cancelMove(Bc.SINGLE_PIECE_MUST_MOVE_BY_ONE());case c:return s.cancelMove(Bc.SINGLE_PIECE_CANNOT_CAPTURE());default:Me.expectToBe(s.board[r][e],u);const m=new Fc(o.x,o.y,d,1,g),y=s.getState(),b=h8.getPhalanxValidity(y,m);return b.isFailure()?s.cancelMove(b.getReason()):(s.lastPiece=T.of(i),s.validExtensions=s.getValidExtensions(u),s.phalanxValidLandings=s.getPhalanxValidLandings(),s.phalanxMiddles=o.getCoordsToward(i),s.phalanxDirection=T.of(g),R.SUCCESS)}})()}thirdClick(e,r){var s=this;return I(function*(){const i=s.getState().getCurrentPlayer(),o=new S(e,r);if(s.firstPiece.equalsValue(o))return s.moveFirstPiece(i);if(s.lastPiece.equalsValue(o))return s.moveLastPiece(i);const c=s.firstPiece.get(),u=s.lastPiece.get();if(!o.isAlignedWith(c))return s.cancelMove(Bc.SQUARE_NOT_ALIGNED_WITH_PHALANX());let d=Ne.factory.fromMove(c,u).get();const g=Ne.factory.fromMove(c,o).get();if(d===g.getOpposite()&&(s.firstPiece=T.of(u),s.lastPiece=T.of(c),d=g),d!==g)return s.cancelMove(Bc.SQUARE_NOT_ALIGNED_WITH_PHALANX());if(s.board[r][e]===i)return s.thirdClickOnPlayerPiece(o,d,i);{const m=s.firstPiece.get().getDistance(s.lastPiece.get())+1,y=s.lastPiece.get().getDistance(o),b=new Fc(s.firstPiece.get().x,s.firstPiece.get().y,m,y,d);return s.tryMove(b)}})()}thirdClickOnPlayerPiece(e,r,s){var i=this;return I(function*(){i.lastPiece=T.of(e);const o=i.firstPiece.get().getDistance(e)+1,c=new Fc(i.firstPiece.get().x,i.firstPiece.get().y,o,1,r),u=h8.getPhalanxValidity(i.rules.node.gameState,c);return u.isFailure()?i.cancelMove(u.getReason()):(i.phalanxMiddles=i.firstPiece.get().getCoordsToward(i.lastPiece.get()),i.validExtensions=i.getValidExtensions(s),i.phalanxValidLandings=i.getPhalanxValidLandings(),R.SUCCESS)})()}moveFirstPiece(e){var r=this;return I(function*(){return r.firstPiece=T.of(r.firstPiece.get().getNext(r.phalanxDirection.get(),1)),r.firstPiece.equals(r.lastPiece)?yield r.moveOnlyPiece(e):(r.phalanxMiddles=r.phalanxMiddles.slice(1),r.validExtensions=r.getPhalanxValidExtensions(e)),r.phalanxValidLandings=r.getPhalanxValidLandings(),R.SUCCESS})()}moveLastPiece(e){var r=this;return I(function*(){return r.lastPiece=T.of(r.lastPiece.get().getPrevious(r.phalanxDirection.get(),1)),r.firstPiece.equals(r.lastPiece)?r.moveOnlyPiece(e):(r.phalanxMiddles=r.firstPiece.get().getCoordsToward(r.lastPiece.get()),r.validExtensions=r.getPhalanxValidExtensions(e),r.phalanxValidLandings=r.getPhalanxValidLandings(),R.SUCCESS)})()}moveOnlyPiece(e){var r=this;return I(function*(){return r.lastPiece=T.empty(),r.validExtensions=r.getFirstPieceExtensions(e),r.phalanxDirection=T.empty(),r.phalanxMiddles=[],r.phalanxValidLandings=r.getPhalanxValidLandings(),R.SUCCESS})()}tryMove(e){const r=this.getState();return this.cancelMove(),this.chooseMove(e,r)}getPieceClasses(e,r){const s=this.getPlayerClass(this.board[r][e]);return this.getPieceStrokeClasses(e,r).concat([s])}getPieceStrokeClasses(e,r){const s=new S(e,r);return this.firstPiece.isAbsent()?[]:this.firstPiece.equalsValue(s)||this.lastPiece.equalsValue(s)||this.phalanxMiddles.some(i=>i.equals(s))?["selected-stroke"]:[]}getRectClasses(e,r){const s=new S(e,r);return this.capturedCoords.some(i=>i.equals(s))?["captured-fill"]:this.moveds.some(i=>i.equals(s))?["moved-fill"]:[]}getHighlightedCoords(){return this.firstPiece.isPresent()?this.phalanxValidLandings.concat(this.validExtensions):this.getCurrentPlayerPieces()}getCurrentPlayerPieces(){const e=[],s=this.getState().getCurrentPlayer();for(let i=0;i<this.board.length;i++)for(let o=0;o<this.board[i].length;o++)this.board[i][o]===s&&e.push(new S(o,i));return e}}return n.\u0275fac=function(e){return new(e||n)(J(En))},n.\u0275cmp=dt({type:n,selectors:[["app-epaminondas"]],features:[l],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","0 0 1410 1210","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass","click",4,"ngIf"],[1,"base",3,"ngClass","click"],[1,"no-fill","mid-stroke","clickable-stroke",3,"click"]],template:function(e,r){1&e&&(F(),O(0,"svg",0),x(1,i6t,2,1,"g",1),x(2,o6t,2,4,"g",1),A()),2&e&&(z("transform",r.rotation),P(1),w("ngForOf",r.board),P(1),w("ngForOf",r.getHighlightedCoords()))},dependencies:[fn,On,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class yi{constructor(t){if(t.length<4)throw new Error("Cannot create a GipfCapture with less than 4 captured pieces");if(!1===Ka.areOnSameLine(t))throw new Error("Cannot create a GipfCapture with pieces that are not on the same line");this.capturedSpaces=Xe.copyImmutableArray(t).sort((r,s)=>{if(r.x===s.x){if(r.y===s.y)throw new Error("Cannot create a GipfCapture with duplicate coords");return r.y>s.y?1:-1}return r.x>s.x?1:-1});let e=T.empty();for(const r of this.capturedSpaces){if(e.isPresent()&&1!==e.get().getDistance(r))throw new Error("Cannot create a GipfCapture with non-consecutive coords");e=T.of(r)}}toString(){let t="";for(const e of this.capturedSpaces)""!==t&&(t+=","),t+=e.toString();return t}size(){return this.capturedSpaces.length}forEach(t){this.capturedSpaces.forEach(t)}contains(t){for(let e=0;e<this.capturedSpaces.length;e++)if(this.capturedSpaces[e].equals(t))return!0;return!1}intersectsWith(t){return this.capturedSpaces.some(e=>t.contains(e))}getLine(){return Ka.fromTwoCoords(this.capturedSpaces[0],this.capturedSpaces[1]).get()}equals(t){if(this===t)return!0;if(this.capturedSpaces.length!==t.capturedSpaces.length)return!1;for(let e=0;e<this.capturedSpaces.length;e++)if(!this.capturedSpaces[e].equals(t.capturedSpaces[e]))return!1;return!0}}yi.encoder=new class extends L4{encode(n){return n.capturedSpaces.map(t=>S.encoder.encodeMove(t))}decode(n){return new yi(n.map(S.encoder.decodeMove))}};class Qa{constructor(t,e){this.coord=t,this.direction=e}toString(){return this.direction.isPresent()?this.coord.toString()+"@"+this.direction.get().toString():this.coord.toString()}equals(t){return!!this.coord.equals(t.coord)&&this.direction.equals(t.direction)}}Qa.encoder=new class extends L4{constructor(){super(...arguments),this.optionalDirectionEncoder=T.getEncoder(Re.encoder)}encode(n){return{coord:S.encoder.encode(n.coord),direction:this.optionalDirectionEncoder.encode(n.direction)}}decode(n){const t=n;return Pe(null!=t.coord,"Invalid encoded GipfPlacement"),new Qa(S.encoder.decode(t.coord),this.optionalDirectionEncoder.decode(t.direction))}};class ga extends Fi{constructor(t,e,r){super(),this.placement=t,this.initialCaptures=e,this.finalCaptures=r}toString(){return"GipfMove(["+this.capturesToString(this.initialCaptures)+"], "+this.placement.toString()+", ["+this.capturesToString(this.finalCaptures)+"])"}capturesToString(t){let e="";for(const r of t)""!==e&&(e+=","),e+="["+r.toString()+"]";return e}equals(t){return this===t||!(!1===this.placement.equals(t.placement)||!1===Xe.compareArray(this.initialCaptures,t.initialCaptures)||!1===Xe.compareArray(this.finalCaptures,t.finalCaptures))}encode(){return ga.encoder.encode(this)}decode(t){return ga.encoder.decode(t)}}ga.encoder=new class extends Nt{encodeMove(n){const t={placement:Qa.encoder.encode(n.placement)};return n.initialCaptures.map((e,r)=>{t["initialCapture"+r]=yi.encoder.encode(e)}),n.finalCaptures.map((e,r)=>{t["finalCapture"+r]=yi.encoder.encode(e)}),t}decodeMove(n){const t=n;return Pe(null!=t.placement,"Invalid encoded GipfMove"),new ga(Qa.encoder.decode(t.placement),this.decodeArray(t,"initialCapture",yi.encoder.decode),this.decodeArray(t,"finalCapture",yi.encoder.decode))}decodeArray(n,t,e){const r=[];for(let s=0;null!=n[t+s];s++)r.push(e(n[t+s]));return r}};class Ja extends RH{constructor(t,e,r,s){super(e,t,7,7,[3,2,1],ke.EMPTY),this.sidePieces=r,this.capturedPieces=s}static getInitialState(){const t=ke.EMPTY,e=ke.UNREACHABLE,r=ke.ZERO,s=ke.ONE;return new Ja([[e,e,e,s,t,t,r],[e,e,t,t,t,t,t],[e,t,t,t,t,t,t],[r,t,t,t,t,t,s],[t,t,t,t,t,t,e],[t,t,t,t,t,e,e],[s,t,t,r,e,e,e]],0,[12,12],[0,0])}equals(t){return this.turn===t.turn&&this.sidePieces[0]===t.sidePieces[0]&&this.sidePieces[1]===t.sidePieces[1]&&this.capturedPieces[0]===t.capturedPieces[0]&&this.capturedPieces[1]===t.capturedPieces[1]&&Xe.compareTable(this.board,t.board)}getNumberOfPiecesToPlace(t){return this.sidePieces[t.value]}getNumberOfPiecesCaptured(t){return this.capturedPieces[t.value]}setAtUnsafe(t,e){const r=Xe.copyBiArray(this.board);return r[t.y][t.x]=e,new Ja(r,this.turn,this.sidePieces,this.capturedPieces)}isOnBoard(t){return!t.isNotInRange(this.width,this.height)&&this.board[t.y][t.x]!==ke.UNREACHABLE}}let $c=(()=>{class n{}return n.CAPTURE_MUST_BE_ALIGNED=()=>$localize`You can only capture when 4 or more of your pieces are aligned, and it is not the case.`,n.INVALID_CAPTURED_PIECES=()=>$localize`You must select a valid capture that contains 4 pieces or more.`,n.MISSING_CAPTURES=()=>$localize`There are still possible captures to be done.`,n.PLACEMENT_NOT_ON_BORDER=()=>$localize`Pieces must be inserted in spaces on the edge of the board.`,n.INVALID_PLACEMENT_DIRECTION=()=>$localize`You must select a valid placement direction.`,n.PLACEMENT_WITHOUT_DIRECTION=()=>$localize`You must select a placement with a direction alongside the insertion space.`,n.PLACEMENT_ON_COMPLETE_LINE=()=>$localize`You cannot place a piece on a complete line.`,n.AMBIGUOUS_CAPTURE_COORD=()=>$localize`This piece belongs to two captures. Please select another piece in the capture you'd like to make.`,n.NO_DIRECTIONS_AVAILABLE=()=>$localize`You cannot insert a piece here, as all lines are full. Select another space.`,n})();class Gn extends L1{applyLegalMove(t,e,r){return new Ja(r.board,r.turn+1,r.sidePieces,r.capturedPieces)}static applyCaptures(t,e){let r=e;return t.forEach(s=>{r=Gn.applyCapture(s,r)}),r}static applyCapture(t,e){const r=e.getCurrentPlayer();let s=e;const i=[e.sidePieces[0],e.sidePieces[1]],o=[e.capturedPieces[0],e.capturedPieces[1]];return t.forEach(c=>{const u=e.getPieceAt(c);s=s.setAt(c,ke.EMPTY),u.is(r)?i[r.value]+=1:o[r.value]+=1}),new Ja(s.board,e.turn,i,o)}static getPlacements(t){const e=[];return Is.INSTANCE.getAllBorders(t).forEach(r=>{t.getPieceAt(r)===ke.EMPTY?e.push(new Qa(r,T.empty())):Gn.getAllDirectionsForEntrance(t,r).forEach(s=>{!1===Gn.isLineComplete(t,r,s)&&e.push(new Qa(r,T.of(s)))})}),e}static isLineComplete(t,e,r){return Gn.nextGapInLine(t,e,r).isAbsent()}static nextGapInLine(t,e,r){for(let s=e;t.isOnBoard(s);s=s.getNext(r))if(t.getPieceAt(s)===ke.EMPTY)return T.of(s);return T.empty()}static applyPlacement(t,e){const r=e.getCurrentPlayer();let s=e,i=ke.ofPlayer(e.getCurrentPlayer());if(t.direction.isAbsent()){const c=t.coord;if(e.getPieceAt(c)!==ke.EMPTY)throw new Error("Apply placement called without direction while the coord is occupied");s=s.setAt(c,i)}else for(let c=t.coord;s.isOnBoard(c)&&i!==ke.EMPTY;c=c.getNext(t.direction.get())){const u=e.getPieceAt(c);s=s.setAt(c,i),i=u}const o=[e.sidePieces[0],e.sidePieces[1]];return o[r.value]-=1,new Ja(s.board,e.turn,o,e.capturedPieces)}getPiecesMoved(t,e,r){const s=Gn.applyCaptures(e,t);if(r.direction.isAbsent())return[r.coord];{const i=r.direction.get(),o=[];o.push(r.coord);let c=r.coord.getNext(i);for(;s.isOnBoard(c)&&s.getPieceAt(c)!==ke.EMPTY;)o.push(c),c=c.getNext(i);return Pe(s.isOnBoard(c)&&s.getPieceAt(c)===ke.EMPTY,"getPiecesMoved called with an invalid placement performed on a full line"),o.push(c),o}}static getAllDirectionsForEntrance(t,e){if(Is.INSTANCE.isTopLeftCorner(t,e))return[Re.RIGHT,Re.DOWN,Re.UP_RIGHT];if(Is.INSTANCE.isTopCorner(t,e))return[Re.DOWN,Re.DOWN_LEFT,Re.RIGHT];if(Is.INSTANCE.isTopRightCorner(t,e))return[Re.DOWN_LEFT,Re.DOWN,Re.LEFT];if(Is.INSTANCE.isBottomLeftCorner(t,e))return[Re.UP_RIGHT,Re.UP,Re.RIGHT];if(Is.INSTANCE.isBottomCorner(t,e))return[Re.UP,Re.LEFT,Re.UP_RIGHT];if(Is.INSTANCE.isBottomRightCorner(t,e))return[Re.LEFT,Re.UP,Re.DOWN_LEFT];if(Is.INSTANCE.isOnTopLeftBorder(t,e))return[Re.RIGHT,Re.DOWN];if(Is.INSTANCE.isOnLeftBorder(t,e))return[Re.UP_RIGHT,Re.RIGHT];if(Is.INSTANCE.isOnBottomLeftBorder(t,e))return[Re.UP,Re.UP_RIGHT];if(Is.INSTANCE.isOnBottomRightBorder(t,e))return[Re.LEFT,Re.UP];if(Is.INSTANCE.isOnRightBorder(t,e))return[Re.LEFT,Re.DOWN_LEFT];if(Is.INSTANCE.isOnTopRightBorder(t,e))return[Re.DOWN_LEFT,Re.DOWN];throw new Error("not a border")}isLegal(t,e){const r=this.capturesValidity(e,t.initialCaptures);if(r.isFailure())return r.toOtherFallible();const s=Gn.applyCaptures(t.initialCaptures,e),i=this.noMoreCapturesValidity(s);if(i.isFailure())return i.toOtherFallible();const o=this.placementValidity(s,t.placement);if(o.isFailure())return o.toOtherFallible();const c=Gn.applyPlacement(t.placement,s),u=this.capturesValidity(c,t.finalCaptures);if(u.isFailure())return u.toOtherFallible();const d=Gn.applyCaptures(t.finalCaptures,c),g=this.noMoreCapturesValidity(d);return g.isFailure()?g.toOtherFallible():_e.success(d)}capturesValidity(t,e){let r=t;for(const s of e){const i=this.captureValidity(r,s);if(i.isFailure())return i;r=Gn.applyCapture(s,r)}return R.SUCCESS}captureValidity(t,e){const r=t.getCurrentPlayer(),s=Gn.getLinePortionWithFourPiecesOfPlayer(t,r,e.getLine());if(s.isAbsent())return R.failure($c.CAPTURE_MUST_BE_ALIGNED());const i=s.get();return Gn.getCapturable(t,i).equals(e)?R.SUCCESS:R.failure($c.INVALID_CAPTURED_PIECES())}static getLinePortionsWithFourPiecesOfPlayer(t,e){const r=[];return t.allLines().forEach(s=>{const i=Gn.getLinePortionWithFourPiecesOfPlayer(t,e,s);i.isPresent()&&r.push(i.get())}),r}static getLinePortionWithFourPiecesOfPlayer(t,e,r){let s=0;const i=t.getEntranceOnLine(r),o=r.getDirection();let c=i;for(let u=i;t.isOnBoard(u);u=u.getNext(o))if(t.getPieceAt(u).is(e)?(0===s&&(c=u),s+=1):s=0,4===s)return T.of({0:c,1:u,2:o});return T.empty()}noMoreCapturesValidity(t){const e=t.getCurrentPlayer();return 0===Gn.getLinePortionsWithFourPiecesOfPlayer(t,e).length?R.SUCCESS:R.failure($c.MISSING_CAPTURES())}placementValidity(t,e){const r=this.placementCoordValidity(t,e.coord);if(r.isFailure())return r;if(t.getPieceAt(e.coord)!==ke.EMPTY){if(e.direction.isAbsent())return R.failure($c.PLACEMENT_WITHOUT_DIRECTION());if(Gn.isLineComplete(t,e.coord,e.direction.get()))return R.failure($c.PLACEMENT_ON_COMPLETE_LINE());for(const s of Gn.getAllDirectionsForEntrance(t,e.coord))if(s===e.direction.get())return R.SUCCESS;return R.failure($c.INVALID_PLACEMENT_DIRECTION())}return R.SUCCESS}placementCoordValidity(t,e){return Is.INSTANCE.isOnBorder(t,e)?R.SUCCESS:R.failure($c.PLACEMENT_NOT_ON_BORDER())}static getCapturable(t,e){const r=[],s=e[0],i=e[1],o=e[2],c=o.getOpposite();let u=s.getNext(c);for(;t.isOnBoard(u)&&t.getPieceAt(u)!==ke.EMPTY;)r.push(u),u=u.getNext(c);for(let d=s;!d.equals(i);d=d.getNext(o))r.push(d);for(let d=i;t.isOnBoard(d)&&t.getPieceAt(d)!==ke.EMPTY;d=d.getNext(o))r.push(d);return new yi(r)}static getPossibleCaptures(t){const e=t.getCurrentPlayer(),r=[];return Gn.getLinePortionsWithFourPiecesOfPlayer(t,e).forEach(s=>{r.push(Gn.getCapturable(t,s))}),r}static getPlayerScore(t,e){const r=t.getNumberOfPiecesToPlace(e);if(0===r&&0===Gn.getPossibleCaptures(t).length)return T.empty();const s=t.getNumberOfPiecesCaptured(e);return T.of(r+3*s)}static isGameOver(t){const e=Gn.getPlayerScore(t,B.ZERO),r=Gn.getPlayerScore(t,B.ONE);return e.isAbsent()||r.isAbsent()}getGameStatus(t){const e=t.gameState,r=Gn.getPlayerScore(e,B.ZERO),s=Gn.getPlayerScore(e,B.ONE);return r.isAbsent()?xe.ONE_WON:s.isAbsent()?xe.ZERO_WON:xe.ONGOING}}class qm extends xs{static getPossibleCaptureCombinationsFromPossibleCaptures(t){const e=qm.computeIntersections(t);let r=[[]];return t.forEach((s,i)=>{if(0===e[i].length)r.forEach(o=>{o.push(i)});else{const o=[],c=e[i].some(u=>u>i);for(const u of r)!0===u.some(g=>e[i].some(m=>g===m))?o.push(Xe.copyImmutableArray(u)):c?(o.push(Xe.copyImmutableArray(u)),u.push(i),o.push(Xe.copyImmutableArray(u))):(u.push(i),o.push(Xe.copyImmutableArray(u)));r=o}}),r.map(s=>s.map(i=>t[i]))}static computeIntersections(t){const e=[];return t.forEach((r,s)=>{e.push([]),t.forEach((i,o)=>{s!==o&&r.intersectsWith(i)&&e[s].push(o)})}),e}getMetrics(t){const e=t.gameState;return[Gn.getPlayerScore(e,B.ZERO).get(),Gn.getPlayerScore(e,B.ONE).get()]}getListMoves(t){return this.getListMoveFromState(t.gameState)}getListMoveFromState(t){const e=[];return Gn.isGameOver(t)||this.getPossibleCaptureCombinations(t).forEach(r=>{const s=Gn.applyCaptures(r,t);Gn.getPlacements(s).forEach(i=>{const o=Gn.applyPlacement(i,s);this.getPossibleCaptureCombinations(o).forEach(c=>{const u=new ga(i,r,c);e.push(u)})})}),e}getPossibleCaptureCombinations(t){const e=Gn.getPossibleCaptures(t);return qm.getPossibleCaptureCombinationsFromPossibleCaptures(e)}}class f3e{constructor(t,e,r,s,i,o){this.source=t,this.destination=e,this.x1=r,this.y1=s,this.x2=i,this.y2=o}}const r1=ke.UNREACHABLE,pt=ke.EMPTY,xr=ke.ZERO,H4=ke.ONE;class d3e extends $1{constructor(){super(...arguments),this.tutorial=[ie.informational($localize`Goal of the game`,$localize`The goal of Gipf is to capture the opponent's piece so that the opponent can no longer play.
        This is the initial board.
        Each player has 12 pieces on the side and 3 pieces on the board.
        When, at its turn, a player has no more pieces on the side, that player cannot play anymore and loses the game.
        The first player plays with the dark pieces, the second player plays with the light pieces.`,Ja.getInitialState()),ie.anyMove($localize`Pushing`,$localize`Pieces can only enter the board through the edges. To insert a new piece:
        <ol>
            <li>Click on a space on the edge of the board.</li>
            <li>If that space was already occupied, click on the arrow that indicates the direction in which you want to push the piece(s) already on the corresponding line.</li>
        </ol>
        You cannot push when a line is full.<br/><br/>
        You're playing Dark, insert a piece.`,Ja.getInitialState(),new ga(new Qa(new S(3,0),T.of(Re.DOWN)),[],[]),$localize`Congratulations!`),ie.fromMove($localize`Capture (1/3)`,$localize`To capture, you must align 4 of your own pieces, which will be the first 4 captured pieces.
        There are multiple important aspects of a capture:
        <ol>
            <li>When 4 pieces are captured, all pieces that are directly aligned with these 4 pieces are also captured.</li>
            <li>As soon as there is an empty space on the line, the capture stops.</li>
            <li>Your own pieces that are captured go back to your stock.
                Your opponent's pieces however are really captured and do not go back to your opponent's stock.</li>
            <li>If you create a line of 4 of your opponent's pieces, it will be at the beginning of your opponent's turn that your opponent can capture them.
                This means that a turn happens in three phases:
                <ol type="A">
                    <li>Pick the capture(s) resulting from the last move of your opponent (by clicking on it).</li>
                    <li>Make your insertion.</li>
                    <li>Pick the capture(s) resulting from your move (by clicking on it).</li>
                </ol>
            </li>
        </ol><br/>
        You're playing Dark, you can make a capture, do it.`,new Ja([[r1,r1,r1,xr,H4,pt,pt],[r1,r1,pt,pt,pt,pt,pt],[r1,pt,pt,pt,pt,pt,pt],[xr,xr,xr,pt,pt,pt,pt],[H4,pt,pt,pt,pt,pt,r1],[pt,pt,pt,H4,pt,r1,r1],[pt,pt,pt,H4,r1,r1,r1]],42,[8,8],[0,0]),[new ga(new Qa(new S(0,3),T.of(Re.RIGHT)),[],[new yi([new S(0,3),new S(1,3),new S(2,3),new S(3,3)])])],$localize`Congratulations, you have gotten 4 of your pieces back. This is not the most useful capture.
        Let's now see how captures can really be useful.`,$localize`Failed. Try again.`),ie.fromMove($localize`Capture (2/3)`,$localize`Here, there are three different ways for Dark to capture.
        <ol>
          <li>One way does not capture any of your opponent's pieces.</li>
          <li>Another way captures one of your opponent's pieces.</li>
          <li>The last way captures two of your opponent's pieces.</li>
        </ol>
        <br/>
        You're playing Dark, capture the most pieces from your opponent.`,new Ja([[r1,r1,r1,pt,pt,pt,pt],[r1,r1,pt,H4,pt,pt,pt],[r1,pt,pt,xr,pt,pt,pt],[xr,xr,xr,H4,pt,pt,pt],[pt,pt,pt,xr,pt,pt,r1],[pt,pt,pt,xr,pt,r1,r1],[pt,pt,pt,H4,r1,r1,r1]],42,[8,4],[2,3]),[new ga(new Qa(new S(0,3),T.of(Re.RIGHT)),[],[new yi([new S(3,1),new S(3,2),new S(3,3),new S(3,4),new S(3,5),new S(3,6)])])],$localize`Congratulations, you have gotten back 4 of your pieces and captured 2 of the opponent's.
        The most you can get is 3 per capture.`,$localize`Failed, the best capture was taking 2 of your opponent's pieces`),ie.fromMove($localize`Capture (3/3)`,$localize`Here, you must capture at the beginning of your turn.
        This is due to a move of your opponent at the previous turn
        (even though this is a fictitious board for pedagogical purpose).
        After your capture, by performing the right move you can even capture two more of your opponent's pieces!
        Keep it mind that the most useful in a capture is to take your opponent's pieces.<br/><br/>
        You're playing Dark, capture the most pieces from your opponent.`,new Ja([[r1,r1,r1,xr,pt,pt,xr],[r1,r1,pt,xr,pt,pt,xr],[r1,xr,xr,pt,xr,H4,xr],[pt,pt,pt,xr,pt,pt,xr],[pt,pt,pt,xr,pt,pt,r1],[xr,xr,xr,H4,H4,r1,r1],[pt,pt,pt,xr,r1,r1,r1]],42,[3,4],[2,3]),[new ga(new Qa(new S(3,6),T.of(Re.UP)),[new yi([new S(6,0),new S(6,1),new S(6,2),new S(6,3)])],[new yi([new S(0,5),new S(1,5),new S(2,5),new S(3,5),new S(4,5)]),new yi([new S(1,2),new S(2,2),new S(3,2),new S(4,2),new S(5,2)])]),new ga(new Qa(new S(4,6),T.of(Re.UP)),[new yi([new S(6,0),new S(6,1),new S(6,2),new S(6,3)])],[new yi([new S(0,5),new S(1,5),new S(2,5),new S(3,5),new S(4,5)]),new yi([new S(3,0),new S(3,1),new S(3,2),new S(3,3),new S(3,4)])]),new ga(new Qa(new S(3,6),T.of(Re.UP)),[new yi([new S(6,0),new S(6,1),new S(6,2),new S(6,3)])],[new yi([new S(1,2),new S(2,2),new S(3,2),new S(4,2),new S(5,2)]),new yi([new S(0,5),new S(1,5),new S(2,5),new S(3,5),new S(4,5)])])],$localize`Congratulations, you have gotten 12 of your pieces back and captured 2 of your opponent's pieces.`,$localize`Failed, the best capture takes 2 of your opponent's pieces.`)]}}function c6t(n,t){if(1&n&&(F(),X(0,"circle",13)),2&n){const e=C().$implicit,r=C();w("ngClass",r.getPieceClass(e)),z("cx",r.getCenterAt(e).x)("cy",r.getCenterAt(e).y)("r",r.SPACE_SIZE)}}function l6t(n,t){if(1&n){const e=Oe();F(),O(0,"g",10),ee("click",function(){const i=ue(e).$implicit;return ce(C().onClick(i))}),X(1,"polygon",11),x(2,c6t,1,4,"circle",12),A()}if(2&n){const e=t.$implicit,r=C();De("id","click_",e.x,"_",e.y,""),P(1),De("id","space_",e.x,"_",e.y,""),w("ngClass",r.getSpaceClass(e)),z("points",r.getHexaPointsAt(e)),P(1),w("ngIf",r.isPiece(e))}}function u6t(n,t){if(1&n){const e=Oe();F(),O(0,"polygon",16),ee("click",function(){const i=ue(e).$implicit;return ce(C(2).onClick(i))}),A()}if(2&n){const e=t.$implicit;z("points",C(2).getHexaPointsAt(e))}}function f6t(n,t){if(1&n&&(F(),O(0,"g",14),x(1,u6t,1,1,"polygon",15),A()),2&n){const e=t.$implicit;P(1),w("ngForOf",e.capturedSpaces)}}function d6t(n,t){if(1&n){const e=Oe();F(),O(0,"line",17),ee("click",function(){const i=ue(e).$implicit;return ce(C().onClick(i.destination))}),A()}if(2&n){const e=t.$implicit;z("x1",e.x1)("y1",e.y1)("x2",e.x2)("y2",e.y2)}}function h6t(n,t){if(1&n&&(F(),O(0,"g"),X(1,"circle",18),A()),2&n){const e=t.$implicit,r=C().$implicit,s=C();P(1),De("id","piece_",r.value,"_",e,""),w("ngClass",s.getPlayerClass(r)),z("cx",s.getRemainingPieceCx(r,e))("cy",s.getRemainingPieceCy(r))("r",.5*s.SPACE_SIZE)}}function p6t(n,t){if(1&n&&(F(),O(0,"g"),x(1,h6t,2,6,"g",8),A()),2&n){const e=t.$implicit,r=C();P(1),w("ngForOf",r.getPlayerSidePieces(e))}}function g6t(n,t){if(1&n&&(F(),X(0,"line",19)),2&n){const e=C();z("x1",e.inserted.get().x1)("y1",e.inserted.get().y1)("x2",e.inserted.get().x2)("y2",e.inserted.get().y2)}}let m6t=(()=>{class n extends Td{constructor(e){super(e),this.inserted=T.empty(),this.arrows=[],this.captured=[],this.moved=[],this.hexagonWidth=this.SPACE_SIZE,this.sharedHexagonX=Math.cos(30)*this.hexagonWidth*.5,this.boardWidth=this.hexagonWidth+6*(this.hexagonWidth-this.sharedHexagonX)+3*this.STROKE_WIDTH/2,this.boardHeight=7*this.hexagonWidth+4.5*this.STROKE_WIDTH,this.movePhase=n.PHASE_PLACEMENT_COORD,this.possibleCaptures=[],this.initialCaptures=[],this.placement=T.empty(),this.placementEntrance=T.empty(),this.finalCaptures=[],this.hasAsymmetricBoard=!0,this.scores=T.of([0,0]),this.rules=new Gn(Ja),this.availableMinimaxes=[new qm(this.rules,"GipfMinimax")],this.encoder=ga.encoder,this.tutorial=(new d3e).tutorial,this.SPACE_SIZE=40,this.constructedState=this.getState(),this.hexaLayout=new wd(1.5*this.SPACE_SIZE,new S(this.hexagonWidth/2+3*this.STROKE_WIDTH/4,-this.hexagonWidth),Is.INSTANCE)}updateBoard(){this.cancelMoveAttempt()}showLastMove(e){if(this.inserted=T.empty(),e.placement.direction.isPresent()){const r=e.placement;this.inserted=T.of(this.arrowTowards(r.coord,r.direction.get()))}this.cancelMoveAttempt()}arrowTowards(e,r){const s=e.getNext(r.getOpposite()),i=this.getCenterAt(e),o=this.getCenterAt(s);return new f3e(s,e,o.x,o.y,i.x,i.y)}markCapture(e){e.forEach(r=>{this.captured.push(r)})}getAllCoords(){return this.constructedState.allCoords()}getPlayerSidePieces(e){const r=this.constructedState.getNumberOfPiecesToPlace(e),s=[];for(let i=0;i<r;i+=1)s.push(i);return s}isPiece(e){return this.getPiece(e)!==ke.EMPTY}getPiece(e){return this.constructedState.getPieceAt(e)}onClick(e){var r=this;return I(function*(){const s=r.canUserPlay("#click_"+e.x+"_"+e.y);if(s.isFailure())return r.cancelMove(s.getReason());switch(r.movePhase){case n.PHASE_INITIAL_CAPTURE:case n.PHASE_FINAL_CAPTURE:return r.selectCapture(e);case n.PHASE_PLACEMENT_COORD:return r.selectPlacementCoord(e);default:return Me.expectToBe(r.movePhase,n.PHASE_PLACEMENT_DIRECTION),r.selectPlacementDirectionOrPlacementCoord(e)}})()}selectCapture(e){var r=this;return I(function*(){const s=[];if(r.possibleCaptures.forEach(o=>{o.contains(e)&&s.push(o)}),s.length>1)return r.cancelMove($c.AMBIGUOUS_CAPTURE_COORD());if(0===s.length)return r.cancelMove($c.MISSING_CAPTURES());const i=s[0];return r.constructedState=Gn.applyCapture(i,r.constructedState),r.markCapture(i),r.possibleCaptures=Gn.getPossibleCaptures(r.constructedState),r.movePhase===n.PHASE_INITIAL_CAPTURE?(r.initialCaptures.push(i),0===r.possibleCaptures.length?r.moveToPlacementPhase():R.SUCCESS):(Me.expectToBe(r.movePhase,n.PHASE_FINAL_CAPTURE),r.finalCaptures.push(i),0===r.possibleCaptures.length?r.tryMove(r.initialCaptures,r.placement.get(),r.finalCaptures):R.SUCCESS)})()}moveToPlacementPhase(){return this.movePhase=n.PHASE_PLACEMENT_COORD,R.SUCCESS}moveToInitialCaptureOrPlacementPhase(){return this.possibleCaptures=Gn.getPossibleCaptures(this.constructedState),this.movePhase=0===this.possibleCaptures.length?n.PHASE_PLACEMENT_COORD:n.PHASE_INITIAL_CAPTURE,R.SUCCESS}moveToFinalCapturePhaseOrTryMove(){var e=this;return I(function*(){return e.possibleCaptures=Gn.getPossibleCaptures(e.constructedState),0===e.possibleCaptures.length?e.tryMove(e.initialCaptures,e.placement.get(),e.finalCaptures):(e.movePhase=n.PHASE_FINAL_CAPTURE,R.SUCCESS)})()}computeArrows(e){this.arrows=[];for(const r of Gn.getAllDirectionsForEntrance(this.constructedState,e))if(!1===Gn.isLineComplete(this.constructedState,e,r)){const s=e.getNext(r),i=this.getCenterAt(e),o=this.getCenterAt(s);this.arrows.push(new f3e(e,s,i.x,i.y,o.x,o.y))}}selectPlacementCoord(e){var r=this;return I(function*(){const s=r.rules.placementCoordValidity(r.constructedState,e);return s.isFailure()?r.cancelMove(s.getReason()):r.placementEntrance.equalsValue(e)?(r.cancelMoveAttempt(),R.SUCCESS):(r.placementEntrance=T.of(e),r.constructedState.getPieceAt(e)===ke.EMPTY?r.selectPlacementDirection(T.empty()):(r.movePhase=n.PHASE_PLACEMENT_DIRECTION,r.computeArrows(e),0===r.arrows.length&&r.cancelMove($c.NO_DIRECTIONS_AVAILABLE()),R.SUCCESS))})()}selectPlacementDirection(e){var r=this;return I(function*(){r.placement=T.of(new Qa(r.placementEntrance.get(),e));const s=r.rules.placementValidity(r.constructedState,r.placement.get());return s.isFailure()?r.cancelMove(s.getReason()):(r.arrows=[],r.constructedState=Gn.applyPlacement(r.placement.get(),r.constructedState),r.moveToFinalCapturePhaseOrTryMove())})()}selectPlacementDirectionOrPlacementCoord(e){var r=this;return I(function*(){const s=r.placementEntrance.get();if(!1===s.isAlignedWith(e)||1!==s.getDistance(e))return r.selectPlacementCoord(e);const i=Re.factory.fromMove(s,e);return r.selectPlacementDirection(i.toOptional())})()}tryMove(e,r,s){var i=this;return I(function*(){const o=new ga(r,e,s);return yield i.chooseMove(o,i.getState(),i.scores.get())})()}cancelMoveAttempt(){this.constructedState=this.getState(),this.captured=[],this.moved=[];const e=this.rules.node.move;if(e.isPresent()){const r=e.get(),s=this.getPreviousState();r.initialCaptures.forEach(i=>this.markCapture(i)),r.finalCaptures.forEach(i=>this.markCapture(i)),this.moved=this.rules.getPiecesMoved(s,r.initialCaptures,r.placement)}this.initialCaptures=[],this.finalCaptures=[],this.placementEntrance=T.empty(),this.placement=T.empty(),this.arrows=[],this.moveToInitialCaptureOrPlacementPhase()}getSpaceClass(e){return this.captured.some(r=>r.equals(e))?"captured-fill":this.moved.some(r=>r.equals(e))?"moved-fill":""}getPieceClass(e){const r=this.getPiece(e);return this.getPlayerClass(B.of(r.value))}getRemainingPieceCy(e){return e===B.ONE?25:this.boardHeight-25}getRemainingPieceCx(e,r){const s=20+r*this.SPACE_SIZE*.5;return e===B.ONE?s:this.boardWidth-(15+s)}}return n.PHASE_INITIAL_CAPTURE=0,n.PHASE_PLACEMENT_COORD=1,n.PHASE_PLACEMENT_DIRECTION=2,n.PHASE_FINAL_CAPTURE=3,n.\u0275fac=function(e){return new(e||n)(J(En))},n.\u0275cmp=dt({type:n,selectors:[["app-gipf"]],features:[l],decls:11,vars:7,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["id","arrowhead","markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto"],["points","0 0, 10 3.5, 0 7"],["id","arrowhead-moved","markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto"],["points","0 0, 10 3.5, 0 7",1,"moved-fill","moved-stroke"],[3,"id","click",4,"ngFor","ngForOf"],["pointer-events","fill","class","capturable-stroke",4,"ngFor","ngForOf"],["class","arrow","marker-end","url(#arrowhead)",3,"click",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],["class","arrow moved-stroke","marker-end","url(#arrowhead-moved)",4,"ngIf"],[3,"id","click"],["stroke-linecap","round",1,"base",3,"id","ngClass"],["class","base",3,"ngClass",4,"ngIf"],[1,"base",3,"ngClass"],["pointer-events","fill",1,"capturable-stroke"],["class","no-fill","stroke-linecap","round",3,"click",4,"ngFor","ngForOf"],["stroke-linecap","round",1,"no-fill",3,"click"],["marker-end","url(#arrowhead)",1,"arrow",3,"click"],[1,"base","small-stroke",3,"id","ngClass"],["marker-end","url(#arrowhead-moved)",1,"arrow","moved-stroke"]],template:function(e,r){1&e&&(F(),O(0,"svg",0)(1,"defs")(2,"marker",1),X(3,"polygon",2),A(),O(4,"marker",3),X(5,"polygon",4),A()(),x(6,l6t,3,7,"g",5),x(7,f6t,2,1,"g",6),x(8,d6t,1,4,"line",7),x(9,p6t,2,1,"g",8),x(10,g6t,1,4,"line",9),A()),2&e&&(z("viewBox",-r.STROKE_WIDTH+" 0 "+r.boardWidth+" "+r.boardHeight)("transform",r.rotation),P(6),w("ngForOf",r.getAllCoords()),P(1),w("ngForOf",r.possibleCaptures),P(1),w("ngForOf",r.arrows),P(1),w("ngForOf",r.Player.PLAYERS),P(1),w("ngIf",r.inserted.isPresent()))},dependencies:[fn,On,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class kr extends Ks{toString(){return this===kr.PASS?"GoMove.PASS":this===kr.ACCEPT?"GoMove.ACCEPT":"GoMove("+this.coord.x+", "+this.coord.y+")"}}kr.PASS=new kr(-1,0),kr.ACCEPT=new kr(-2,0),kr.encoder=Ks.getEncoder(n=>new kr(n.x,n.y));class We{constructor(t,e){this.player=t,this.type=e}equals(t){return t===this}toString(){switch(this){case We.DARK:return"GoPiece.DARK";case We.LIGHT:return"GoPiece.LIGHT";case We.EMPTY:return"GoPiece.EMPTY";case We.DEAD_DARK:return"GoPiece.DEAD_DARK";case We.DEAD_LIGHT:return"GoPiece.DEAD_LIGHT";case We.DARK_TERRITORY:return"GoPiece.DARK_TERRITORY";default:return Pe(this===We.LIGHT_TERRITORY,"Unexisting GoPiece"),"GoPiece.LIGHT_TERRITORY"}}static pieceBelongTo(t,e){return e===t.player&&"territory"!==t.type}static ofPlayer(t){return t===B.ZERO?We.DARK:We.LIGHT}isOccupied(){return[We.DARK,We.LIGHT,We.DEAD_DARK,We.DEAD_LIGHT].includes(this)}isEmpty(){return[We.DARK_TERRITORY,We.LIGHT_TERRITORY,We.EMPTY].includes(this)}isDead(){return[We.DEAD_DARK,We.DEAD_LIGHT].includes(this)}isTerritory(){return[We.DARK_TERRITORY,We.LIGHT_TERRITORY].includes(this)}getOwner(){return this.player}nonTerritory(){return Pe(this.isEmpty(),'Usually not false, if false, cover by test and return "this"'),We.EMPTY}}We.DARK=new We(B.ZERO,"alive"),We.LIGHT=new We(B.ONE,"alive"),We.EMPTY=new We(he.NONE,"empty"),We.DEAD_DARK=new We(B.ZERO,"dead"),We.DEAD_LIGHT=new We(B.ONE,"dead"),We.DARK_TERRITORY=new We(he.NONE,"territory"),We.LIGHT_TERRITORY=new We(he.NONE,"territory");var Vn=(()=>(function(n){n.PLAYING="PLAYING",n.PASSED="PASSED",n.COUNTING="COUNTING",n.ACCEPT="ACCEPT",n.FINISHED="FINISHED"}(Vn||(Vn={})),Vn))();let ns=(()=>{class n extends Br{constructor(e,r,s,i,o){super(e,s),this.captured=r,this.koCoord=i,this.phase=o}static getInitialState(){const e=n.getStartingBoard();return new n(e,[0,0],0,T.empty(),Vn.PLAYING)}getCapturedCopy(){return[this.captured[0],this.captured[1]]}static getStartingBoard(){return Xe.createTable(n.WIDTH,n.HEIGHT,We.EMPTY)}copy(){return new n(this.getCopiedBoard(),this.getCapturedCopy(),this.turn,this.koCoord,this.phase)}isDead(e){return this.getPieceAt(e).isDead()}isTerritory(e){return this.getPieceAt(e).isTerritory()}}return n.WIDTH=19,n.HEIGHT=19,n})();const ct=We.LIGHT,tt=We.DARK,zH=We.DEAD_LIGHT,Id=We.LIGHT_TERRITORY,Uc=We.DARK_TERRITORY,Ce=We.EMPTY;class h3e extends $1{constructor(){super(...arguments),this.tutorial=[ie.informational($localize`Preliminary information`,$localize`The game of Go is played on a board called a Goban, and the stones are placed on the intersections.
        The traditional board is made of 19x19 intersections, but on this website we have the 13x13 board.
        (For shorter parts, 9x9 and 5x5 boards exist, but are not yet available here).
        For this tutorial, we will use a smaller board for pedagogical purposes.`,ns.getInitialState()),ie.informational($localize`Goal of the game`,$localize`The goal of the game is to have the most points at the end of the game.
        We call "territories" the intersections that are empty and isolated from the rest of the Goban by the stones of a single player.
        Here, Dark has 9 territories on the left, and Light has 8 on the right.
        The top part belongs to no one.
        Each player's score at the end of the game is the sum of that player's territories and captures.`,new ns([[Ce,tt,Ce,Ce,ct,ct],[Ce,tt,Ce,Ce,ct,Ce],[Ce,tt,tt,ct,ct,Ce],[Ce,Ce,tt,ct,Ce,Ce],[Ce,Ce,tt,ct,Ce,Ce],[Ce,Ce,tt,ct,Ce,Ce]],[0,0],0,T.empty(),Vn.PLAYING)),ie.fromMove($localize`Simple capture`,$localize`An isolated stone, like the one in the middle here, has 4 neighboring intersections (not 8, because we do not count diagonals).
        It is said of a group which has exactly 2 free neighboring squares, that this group has two liberties.
        If Dark plays on the last liberty of the light stone, this stone is removed from the Goban (captured) and Dark earns one point.<br/><br/>
        You're playing Dark. The light piece on the board only has one liberty left, play there.`,new ns([[Ce,Ce,Ce,Ce,Ce],[Ce,Ce,tt,Ce,Ce],[Ce,tt,ct,Ce,Ce],[Ce,Ce,tt,Ce,Ce],[Ce,Ce,Ce,Ce,Ce]],[0,0],0,T.empty(),Vn.PLAYING),[new kr(3,2)],$localize`Congratulations, you have earned one point.`,$localize`Failed, try again by playing on one of the intersections directly next to the light stone.`),ie.fromMove($localize`Capturing multiple stones`,$localize`Stones that are connected horizontally or vertically must be captured at the same time, and are not capturable in isolation.<br/><br/>
        You're playing Dark. The light group here only has one liberty left, capture it.`,new ns([[Ce,tt,Ce,Ce,Ce],[tt,ct,Ce,Ce,Ce],[tt,ct,ct,tt,Ce],[Ce,tt,tt,Ce,Ce],[Ce,Ce,Ce,Ce,Ce]],[0,0],0,T.empty(),Vn.PLAYING),[new kr(2,1)],$localize`Congratulations, you have earned three points and formed a territory.`,$localize`Failed, you have not captured the group. Play on the last liberty of that group.`),ie.informational($localize`Suicide`,$localize`In Go, suicide is forbidden.
        If putting a piece on an intersection removes the last liberty of your group and does not capture any stone, playing on that intersection would be a suicide and is therefore forbidden.
        Here, the top left intersection is a suicide for Light.
        On the bottom right, it would be a suicide for Dark, and on the bottom left it is not a suicide for any player.`,new ns([[Ce,tt,Ce,Ce,Ce],[tt,Ce,Ce,Ce,Ce],[tt,Ce,Ce,Ce,ct],[ct,tt,Ce,ct,Ce],[Ce,ct,Ce,ct,tt]],[0,0],0,T.empty(),Vn.PLAYING)),ie.informational($localize`Life and death (death)`,$localize`From the capture rule follows the life and death notion:
        dead stones are stones that are definitely capturable (without losing anything else).
        Alive stones are stones that can never be captured.
        From the capture rule, Dark can play inside Light's territory and make a capture.
        In this case, we say that Light has only one eye (its last liberty) and that Light is dead (even if not yet captured).
        At the end of the game, the dead stones will count as captures, and the intersections they occupy as territories.`,new ns([[Ce,Ce,Ce,Ce,Ce],[tt,tt,tt,Ce,Ce],[ct,ct,tt,Ce,Ce],[Ce,ct,tt,Ce,Ce],[ct,ct,tt,Ce,Ce]],[0,0],0,T.empty(),Vn.PLAYING)),ie.informational($localize`Life and death (eyes)`,$localize`Here, Light cannot play on the top left, nor on the bottom left.
        Light will never be able to capture Dark.
        We say that Dark has two eyes (the eye on the top left, and the one on the bottom left) and that Dark is alive.`,new ns([[Ce,tt,ct,Ce,Ce],[ct,tt,ct,Ce,Ce],[tt,tt,ct,Ce,Ce],[ct,tt,ct,Ce,Ce],[Ce,tt,ct,Ce,Ce]],[0,0],0,T.empty(),Vn.PLAYING)),ie.informational($localize`Seki`,$localize`If Dark plays on the middle line, Light will play on the opposite intersection and capture Dark.
        Similarly, if Light plays on the middle line, Dark will capture Light.
        In other words, there is no point in playing on the middle line.
        In that case, we say that stones in the middle are alive by Seki, and that both intersections in the middle are neutral.`,new ns([[Ce,ct,tt,Ce,ct,tt,Ce],[Ce,ct,tt,tt,ct,tt,Ce],[Ce,ct,tt,tt,ct,tt,Ce],[Ce,ct,tt,tt,ct,tt,Ce],[Ce,ct,tt,ct,ct,tt,Ce],[Ce,ct,tt,ct,ct,tt,Ce],[Ce,ct,tt,Ce,ct,tt,Ce]],[0,0],0,T.empty(),Vn.PLAYING)),ie.fromMove($localize`Ko`,$localize`A player, by putting a stone, cannot go back to an identical state of the Goban as before, in order to avoid an endless game.<br/><br/>
        You're playing Dark, capture the light stone.`,new ns([[Ce,Ce,Ce,Ce,Ce,Ce,Ce],[Ce,Ce,Ce,Ce,Ce,Ce,Ce],[Ce,Ce,Ce,tt,ct,Ce,Ce],[Ce,Ce,tt,ct,Ce,ct,Ce],[Ce,Ce,Ce,tt,ct,Ce,Ce],[Ce,Ce,Ce,Ce,Ce,Ce,Ce],[Ce,Ce,Ce,Ce,Ce,Ce,Ce]],[0,0],0,T.empty(),Vn.PLAYING),[new kr(4,3)],$localize`Now, if Light tries to recapture the stone that Dark has just put on the Goban, this one would go back to its previous state, opening the door for an endless game.
        This intersection is therefore marked with a red square, to remind the players that this intersection is forbidden.
        This rule is called the Ko.
        The trick for Light is to try to create a big enough threat so that Dark must answer immediately, and does not have the time to protect its last stone, so that Light can capture it right after.`,$localize`Failed. Try again.`),ie.fromMove($localize`End of the game`,$localize`When a player feels that there is no advantage to putting a new stone, that player can pass a turn.
        The game phase stops when both players pass consecutively, and we move on to the counting phase.
        The dead groups are then marked by clicking on them.
        Every intersection in a player's territory earns that player a point.
        The winner is the one with most points.<br/><br/>
        You're playing Dark. A last stone is dead, mark it.`,new ns([[ct,tt,tt,tt,tt,tt,Uc,Uc,Uc],[ct,ct,ct,ct,tt,tt,tt,Uc,Uc],[ct,Id,ct,ct,tt,zH,zH,tt,Uc],[tt,ct,ct,ct,ct,tt,Uc,Uc,Uc],[Ce,ct,Id,ct,tt,tt,zH,tt,Uc],[ct,Id,ct,ct,tt,tt,tt,tt,tt],[ct,ct,tt,tt,tt,ct,ct,tt,ct],[tt,tt,tt,ct,ct,ct,Id,ct,ct],[Uc,Uc,tt,tt,tt,ct,ct,Id,Id]],[0,0],0,T.empty(),Vn.COUNTING),[new kr(0,3)],$localize`Congratulations, Dark has 15 territories and 3 light stones still present, called prisoners at the end of the game.
        The intersections where the prisoners are count as Dark's territory
        Light has 8 territories and 1 prisoner.
        The end result is therefore 18 - 9 for Dark.`,$localize`Failed, try again.`)]}}let p8=(()=>{class n{constructor(e){this.color=e}selfContains(e){return this.getCoords().some(s=>s.equals(e))}static insertAsEntryPoint(e,r){return 0===e.length?[r]:r.compareTo(e[0])<0?[r].concat(e):e.concat([r])}}return n.VERBOSE=!1,n})();class C6t extends p8{constructor(t,e,r,s,i,o){super(t),this.emptyCoords=e,this.darkCoords=r,this.lightCoords=s,this.deadDarkCoords=i,this.deadLightCoords=o}getCoords(){return this.color===We.DARK?this.darkCoords:this.color===We.LIGHT?this.lightCoords:this.color===We.DEAD_DARK?this.deadDarkCoords:this.color===We.DEAD_LIGHT?this.deadLightCoords:this.emptyCoords}contains(t){return this.darkCoords.concat(this.lightCoords.concat(this.emptyCoords.concat(this.deadDarkCoords.concat(this.deadLightCoords)))).some(r=>r.equals(t))}addPawn(t,e){switch(Pe(!1===this.contains(t),"This group already contains "+t.toString()),e){case We.DARK:this.darkCoords=p8.insertAsEntryPoint(this.darkCoords,t);break;case We.LIGHT:this.lightCoords=p8.insertAsEntryPoint(this.lightCoords,t);break;case We.DEAD_DARK:this.deadDarkCoords=p8.insertAsEntryPoint(this.deadDarkCoords,t);break;case We.DEAD_LIGHT:this.deadLightCoords=p8.insertAsEntryPoint(this.deadLightCoords,t);break;default:Me.expectToBeMultiple(e,[We.EMPTY,We.DARK_TERRITORY,We.LIGHT_TERRITORY]),this.emptyCoords=p8.insertAsEntryPoint(this.emptyCoords,t)}}isMonoWrapped(){return(this.darkCoords.length+this.deadLightCoords.length===0?0:1)+(this.lightCoords.length+this.deadDarkCoords.length===0?0:1)==1}getWrapper(){const t=new Un;t.set(We.EMPTY,this.emptyCoords.length),t.set(We.DARK,this.darkCoords.length+this.deadLightCoords.length),t.set(We.LIGHT,this.lightCoords.length+this.deadDarkCoords.length),t.put(this.color.nonTerritory(),0);const e=t.filter((r,s)=>s>0);if(1===e.size())return e.getAnyPair().get().key;throw new Error("Can't call getWrapper on non-mono-wrapped group")}getNeighborsEntryPoints(){const t=[];return this.color!==We.EMPTY&&this.emptyCoords.length>0&&t.push(this.emptyCoords[0]),this.color!==We.DARK&&this.darkCoords.length>0&&t.push(this.darkCoords[0]),this.color!==We.LIGHT&&this.lightCoords.length>0&&t.push(this.lightCoords[0]),this.color!==We.DEAD_DARK&&this.deadDarkCoords.length>0&&t.push(this.deadDarkCoords[0]),this.color!==We.DEAD_LIGHT&&this.deadLightCoords.length>0&&t.push(this.deadLightCoords[0]),t}}class jm extends class v6t{getGroupDatas(t,e){Q(p8.VERBOSE,"GroupDatas.getGroupDatas("+t+", "+e+")");const s=this.getNewInstance(e[t.y][t.x]);return this._getGroupDatas(t,e,s)}_getGroupDatas(t,e,r){Q(p8.VERBOSE,{GroupDatas_getGroupDatas:{groupDatas:r,coord:t}});const s=e[t.y][t.x];if(r.addPawn(t,s),s===r.color)for(const i of this.getDirections()){const o=t.getNext(i);o.isInRange(e[0].length,e.length)&&(r.contains(o)||(r=this._getGroupDatas(o,e,r)))}return r}}{getNewInstance(t){return new C6t(t,[],[],[],[],[])}getDirections(){return $e.ORTHOGONALS}}let Zm=(()=>{class n{}return n.ILLEGAL_KO=()=>$localize`This move is a ko, you must play somewhere else before you can play in this intersection again.`,n.CANNOT_PASS_AFTER_PASSED_PHASE=()=>$localize`We are in the counting phase, you must mark stones as dead or alive or accept the current board by passing your turn.`,n.CANNOT_ACCEPT_BEFORE_COUNTING_PHASE=()=>$localize`You cannot accept before the counting phase.`,n.OCCUPIED_INTERSECTION=()=>$localize`This intersection is already occupied.`,n.CANNOT_COMMIT_SUICIDE=()=>$localize`You cannot commit suicide.`,n})(),g6=(()=>{class n extends L1{static isLegal(e,r){if(Q(n.VERBOSE||!1,{isLegal:{move:e,state:r}}),n.isPass(e)){const i=r.phase===Vn.PLAYING,o=r.phase===Vn.PASSED;return Q(n.VERBOSE||!1,"GoRules.isLegal at "+r.phase+(i||o?" forbid":" allowed")+" passing on "+r.getCopiedBoard()),i||o?_e.success([]):_e.failure(Zm.CANNOT_PASS_AFTER_PASSED_PHASE())}if(n.isAccept(e)){const o=r.phase===Vn.ACCEPT;return r.phase===Vn.COUNTING||o?_e.success([]):_e.failure(Zm.CANNOT_ACCEPT_BEFORE_COUNTING_PHASE())}return n.isOccupied(e.coord,r.getCopiedBoard())?(Q(n.VERBOSE||!1,"GoRules.isLegal: move is marking"),n.isLegalDeadMarking(e,r)?_e.success([]):_e.failure(Zm.OCCUPIED_INTERSECTION())):(Q(n.VERBOSE||!1,"GoRules.isLegal: move is normal stuff: "+e.toString()),n.isLegalNormalMove(e,r))}static getNewKo(e,r,s){if(1===s.length){const i=s[0],o=e.coord,c=r[o.y][o.x],d=(new jm).getGroupDatas(o,r),g=d.emptyCoords,m=We.pieceBelongTo(c,B.ZERO)?d.darkCoords:d.lightCoords;if(1===g.length&&g[0].equals(i)&&1===m.length)return T.of(i)}return T.empty()}static markTerritoryAndCount(e){Q(n.VERBOSE,{markTerritoryAndCount:{state:e}});const r=e.getCopiedBoard(),s=n.getTerritoryLikeGroup(e),i=e.getCapturedCopy();for(const o of s){const c=o.getWrapper();if(c===We.LIGHT){i[1]+=o.emptyCoords.length;for(const u of o.getCoords())r[u.y][u.x]=We.LIGHT_TERRITORY}else{Pe(c===We.DARK,"territory should be wrapped by dark or light, not by "+c.toString()),i[0]+=o.emptyCoords.length;for(const u of o.getCoords())r[u.y][u.x]=We.DARK_TERRITORY}}return new ns(r,i,e.turn,e.koCoord,e.phase)}static removeAndSubstractTerritory(e){const r=e.getCopiedBoard(),s=e.getCapturedCopy();let i;for(let o=0;o<e.board.length;o++)for(let c=0;c<e.board[0].length;c++)i=r[o][c],i===We.DARK_TERRITORY?(r[o][c]=We.EMPTY,s[0]=s[0]-1):i===We.LIGHT_TERRITORY&&(r[o][c]=We.EMPTY,s[1]=s[1]-1);return new ns(r,s,e.turn,e.koCoord,e.phase)}static getEmptyZones(e){return n.getGroupsDatasWhere(e.getCopiedBoard(),r=>r.isEmpty())}static getGroupsDatasWhere(e,r){const s=[];let i,o,c;const u=new jm;for(let d=0;d<e.length;d++)for(let g=0;g<e[0].length;g++)i=new S(g,d),c=e[d][g],r(c)&&(s.some(m=>m.selfContains(i))||(o=u.getGroupDatas(i,e),s.push(o)));return s}static addDeadToScore(e){const r=e.getCapturedCopy();let o,s=r[1],i=r[0];for(let c=0;c<e.board.length;c++)for(let u=0;u<e.board[0].length;u++)o=e.getPieceAtXY(u,c),o===We.DEAD_DARK?s++:o===We.DEAD_LIGHT&&i++;return[i,s]}static switchAliveness(e,r){const s=r.getCopiedBoard();Pe(s[e.y][e.x].isOccupied(),"Can't switch emptyness aliveness");const c=(new jm).getGroupDatas(e,s),u=r.getCapturedCopy();switch(c.color){case We.DEAD_DARK:u[1]-=2*c.deadDarkCoords.length;for(const d of c.deadDarkCoords)s[d.y][d.x]=We.DARK;break;case We.DEAD_LIGHT:u[0]-=2*c.deadLightCoords.length;for(const d of c.deadLightCoords)s[d.y][d.x]=We.LIGHT;break;case We.LIGHT:u[0]+=2*c.lightCoords.length;for(const d of c.lightCoords)s[d.y][d.x]=We.DEAD_LIGHT;break;default:Me.expectToBe(c.color,We.DARK),u[1]+=2*c.darkCoords.length;for(const d of c.darkCoords)s[d.y][d.x]=We.DEAD_DARK}return new ns(s,u,r.turn,r.koCoord,r.phase)}static getGameStatus(e){const r=e.gameState;return r.phase===Vn.FINISHED?r.captured[0]>r.captured[1]?xe.ZERO_WON:r.captured[1]>r.captured[0]?xe.ONE_WON:xe.DRAW:xe.ONGOING}static isPass(e){return e.equals(kr.PASS)}static isAccept(e){return e.equals(kr.ACCEPT)}static isLegalDeadMarking(e,r){return n.isOccupied(e.coord,r.getCopiedBoard())&&(r.phase===Vn.COUNTING||r.phase===Vn.ACCEPT)}static isLegalNormalMove(e,r){const s=r.getCopiedBoard();if(n.isKo(e,r))return _e.failure(Zm.ILLEGAL_KO());[Vn.COUNTING,Vn.ACCEPT].includes(r.phase)&&(r=n.resurrectStones(r));const i=n.getCaptureState(e,r);if(g3e.isCapturing(i))return _e.success(i.capturedCoords);{s[e.coord.y][e.coord.x]=r.turn%2==0?We.DARK:We.LIGHT;const u=0===(new jm).getGroupDatas(e.coord,s).emptyCoords.length;return s[e.coord.y][e.coord.x]=We.EMPTY,u?_e.failure(Zm.CANNOT_COMMIT_SUICIDE()):_e.success([])}}static isOccupied(e,r){return r[e.y][e.x].isOccupied()}static isKo(e,r){return!!r.koCoord.isPresent()&&e.coord.equals(r.koCoord.get())}static getCaptureState(e,r){Q(n.VERBOSE||!1,{getCaptureState:{move:e,state:r}});const i=new g3e;let o;for(const c of $e.ORTHOGONALS)o=n.getCapturedInDirection(e.coord,c,r),o.length>0&&i.capturedCoords.every(u=>!o[0].equals(u))&&(i.capturedCoords=i.capturedCoords.concat(o));return i}static getCapturedInDirection(e,r,s){const o=s.getCopiedBoard(),c=e.getNext(r);if(c.isInRange(s.board[0].length,s.board.length)&&o[c.y][c.x]===(s.turn%2==0?We.LIGHT:We.DARK)){Q(n.VERBOSE||!1,"a group could be captured");const g=(new jm).getGroupDatas(c,o);if(n.isCapturableGroup(g,s.koCoord))return Q(n.VERBOSE||!1,{neightbooringGroupCoord:g.getCoords(),message:"is capturable"}),g.getCoords()}return[]}static isCapturableGroup(e,r){return!(!e.color.isOccupied()||1!==e.emptyCoords.length)&&!1===r.equalsValue(e.emptyCoords[0])}static getTerritoryLikeGroup(e){return n.getEmptyZones(e).filter(s=>s.isMonoWrapped())}static applyPass(e){const r=e.getCopiedBoard(),s=e.getCapturedCopy(),i=e.turn;let o,c;return e.phase===Vn.PASSED?(o=Vn.COUNTING,c=new ns(r,s,i+1,T.empty(),o),c=n.markTerritoryAndCount(c)):(Pe(e.phase===Vn.PLAYING,"Cannot pass in counting phase!"),o=Vn.PASSED,c=new ns(r,s,i+1,T.empty(),o)),c}static applyLegalAccept(e){const r=e.getCopiedBoard();let s;return s=e.phase===Vn.COUNTING?Vn.ACCEPT:Vn.FINISHED,new ns(r,e.getCapturedCopy(),e.turn+1,T.empty(),s)}static applyNormalLegalMove(e,r,s){let i;Q(n.VERBOSE,{applyNormalLegal:{currentState:r,legalMove:e,status}}),i=[Vn.COUNTING,Vn.ACCEPT].includes(r.phase)?n.resurrectStones(r):r.copy();const o=e.coord.x,c=e.coord.y,u=i.getCopiedBoard(),d=i.turn,g=We.ofPlayer(i.getCurrentPlayer()),m=d+1;u[c][o]=g;for(const k of s)u[k.y][k.x]=We.EMPTY;const y=n.getNewKo(e,u,s),b=i.getCapturedCopy();return b[g.player.value]+=s.length,new ns(u,b,m,y,Vn.PLAYING)}static resurrectStones(e){for(let r=0;r<e.board.length;r++)for(let s=0;s<e.board[0].length;s++)e.getPieceAtXY(s,r).isDead()&&(e=n.switchAliveness(new S(s,r),e));return n.removeAndSubstractTerritory(e)}static applyDeadMarkingMove(e,r){Q(n.VERBOSE,{applyDeadMarkingMove:{legalMove:e,state:r}});const s=n.removeAndSubstractTerritory(r),i=n.switchAliveness(e.coord,s),o=new ns(i.getCopiedBoard(),i.getCapturedCopy(),i.turn+1,T.empty(),Vn.COUNTING);return n.markTerritoryAndCount(o)}isLegal(e,r){return n.isLegal(e,r)}applyLegalMove(e,r,s){return Q(n.VERBOSE,{applyLegalMove:{legalMove:e,state:r,status}}),n.isPass(e)?(Q(n.VERBOSE,"GoRules.applyLegalMove: isPass"),n.applyPass(r)):n.isAccept(e)?(Q(n.VERBOSE,"GoRules.applyLegalMove: isAccept"),n.applyLegalAccept(r)):n.isLegalDeadMarking(e,r)?(Q(n.VERBOSE,"GoRules.applyLegalMove: isDeadMarking"),n.applyDeadMarkingMove(e,r)):(Q(n.VERBOSE,"GoRules.applyLegalMove: else it is normal move"),n.applyNormalLegalMove(e,r,s))}getGameStatus(e){return n.getGameStatus(e)}}return n.VERBOSE=!1,n})();class g3e{constructor(){this.capturedCoords=[]}static isCapturing(t){return t.capturedCoords.length>0}}class y6t extends xs{getListMoves(t){Q(g6.VERBOSE||!1,"GoRules.getListMoves");const r=t.gameState,s=this.getPlayingMovesList(r);if(r.phase===Vn.PLAYING||r.phase===Vn.PASSED)return s.push(kr.PASS),s;{Q(g6.VERBOSE||!1,"GoRules.getListMoves in counting phase");const i=this.getCountingMovesList(r);return 0===i.length?[kr.ACCEPT]:i}}getPlayingMovesList(t){const e=[];let r;for(let s=0;s<t.board.length;s++)for(let i=0;i<t.board[0].length;i++)r=new kr(i,s),t.getPieceAt(r.coord)===We.EMPTY&&g6.isLegal(r,t).isSuccess()&&e.push(r);return e}getCountingMovesList(t){const e=[],r=this.getCorrectBoard(t).getCopiedBoard(),s=g6.getGroupsDatasWhere(r,i=>i!==We.EMPTY);for(const i of s){const o=i.getCoords()[0],c=r[o.y][o.x];if(t.getPieceAt(o)!==c){const d=new kr(o.x,o.y);return e.push(d),e}}return e}getCorrectBoard(t){const r=this.mapBoard(t.getCopiedBoard(),o=>o===We.DARK?We.DEAD_DARK:o===We.LIGHT?We.DEAD_LIGHT:o.isTerritory()?We.EMPTY:o),s=new ns(r,t.getCapturedCopy(),t.turn,t.koCoord,t.phase),i=g6.getTerritoryLikeGroup(s);return this.setAliveUniqueWrapper(s,i)}mapBoard(t,e){const r=[];for(let s=0;s<t.length;s++){r[s]=[];for(let i=0;i<t[0].length;i++)r[s][i]=e(t[s][i])}return r}setAliveUniqueWrapper(t,e){let s,r=t.copy();for(const i of e){s=i.deadDarkCoords.concat(i.deadLightCoords);for(const o of s)r.isDead(o)&&(r=g6.switchAliveness(o,r))}return r}getMetrics(t){const e=g6.markTerritoryAndCount(t.gameState),r=e.getCapturedCopy(),s=this.getDeadStones(e);return[r[0]+2*s[1],r[1]+2*s[0]]}getDeadStones(t){const e=[0,0];for(let r=0;r<t.board.length;r++)for(let s=0;s<t.board[0].length;s++){const i=t.getPieceAtXY(s,r);"dead"===i.type&&(e[i.player.value]=e[i.player.value]+1)}return e}}function E6t(n,t){if(1&n){const e=Oe();F(),O(0,"g")(1,"rect",8),ee("click",function(){const i=ue(e).index,o=C().index;return ce(C().onClick(i,o))}),A(),O(2,"line",9),ee("click",function(){const i=ue(e).index,o=C().index;return ce(C().onClick(i,o))}),A(),O(3,"line",9),ee("click",function(){const i=ue(e).index,o=C().index;return ce(C().onClick(i,o))}),A()()}if(2&n){const e=t.index,r=C().index,s=C();P(1),De("id","click_",e,"_",r,""),z("width",.5*s.SPACE_SIZE)("height",.5*s.SPACE_SIZE)("x",.5*s.SPACE_SIZE*e)("y",.5*s.SPACE_SIZE*r),P(1),z("x1",.5*s.SPACE_SIZE*e)("y1",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*r)("x2",.5*s.SPACE_SIZE+.5*s.SPACE_SIZE*e)("y2",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*r),P(1),z("x1",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*e)("y1",.5*s.SPACE_SIZE*r)("x2",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*e)("y2",.5*s.SPACE_SIZE+.5*s.SPACE_SIZE*r)}}function M6t(n,t){if(1&n&&(F(),O(0,"g"),x(1,E6t,4,14,"g",3),A()),2&n){const e=t.$implicit;P(1),w("ngForOf",e)}}function S6t(n,t){if(1&n){const e=Oe();F(),O(0,"circle",10),ee("click",function(){const i=ue(e).$implicit;return ce(C().onClick(i.x,i.y))}),A()}if(2&n){const e=t.$implicit,r=C();De("id","hoshi_",e.x,"_",e.y,""),z("cx",.25*r.SPACE_SIZE+.5*r.SPACE_SIZE*e.x)("cy",.25*r.SPACE_SIZE+.5*r.SPACE_SIZE*e.y)("r",.1*r.SPACE_SIZE)}}function P6t(n,t){if(1&n&&(F(),X(0,"circle",16)),2&n){const e=C(2).index,r=C().index,s=C();z("cx",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*e)("cy",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*r)("r",.22*s.SPACE_SIZE)}}function T6t(n,t){if(1&n){const e=Oe();F(),O(0,"line",17),ee("click",function(){ue(e);const s=C(2).index,i=C().index;return ce(C().onClick(s,i))}),A()}if(2&n){const e=C(2).index,r=C().index,s=C();z("x1",.5*s.SPACE_SIZE*e)("y1",.5*s.SPACE_SIZE*r)("x2",.5*s.SPACE_SIZE+.5*s.SPACE_SIZE*e)("y2",.5*s.SPACE_SIZE+.5*s.SPACE_SIZE*r)}}function w6t(n,t){if(1&n){const e=Oe();F(),O(0,"g")(1,"circle",13),ee("click",function(){ue(e);const s=C().index,i=C().index;return ce(C().onClick(s,i))}),A(),x(2,P6t,1,3,"circle",14),x(3,T6t,1,4,"line",15),A()}if(2&n){const e=C().index,r=C().index,s=C();P(1),w("ngClass",s.getSpaceClass(e,r)),z("cx",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*e)("cy",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*r)("r",.22*s.SPACE_SIZE),P(1),w("ngIf",s.isLastSpace(e,r)),P(1),w("ngIf",s.isDead(e,r))}}function b6t(n,t){if(1&n){const e=Oe();F(),O(0,"circle",19),ee("click",function(){ue(e);const s=C(2).index,i=C().index;return ce(C().onClick(s,i))}),A()}if(2&n){const e=C(2),r=e.index,s=e.$implicit,i=C().index,o=C();z("cx",.25*o.SPACE_SIZE+.5*o.SPACE_SIZE*r)("cy",.25*o.SPACE_SIZE+.5*o.SPACE_SIZE*i)("r",.1*o.SPACE_SIZE)("class",s===o.GoPiece.LIGHT_TERRITORY?"player1-fill":"player0-fill")}}function O6t(n,t){if(1&n&&(F(),x(0,b6t,1,4,"circle",18)),2&n){const e=C().index,r=C().index;w("ngIf",C().isTerritory(e,r))}}function A6t(n,t){if(1&n&&(F(),O(0,"g"),x(1,w6t,4,6,"g",11),x(2,O6t,1,1,"ng-template",null,12,Zn),A()),2&n){const e=t.index,r=Bn(3),s=C().index,i=C();P(1),w("ngIf",i.spaceIsFull(e,s))("ngIfElse",r)}}function N6t(n,t){if(1&n&&(F(),O(0,"g"),x(1,A6t,4,2,"g",3),A()),2&n){const e=t.$implicit;P(1),w("ngForOf",e)}}function I6t(n,t){if(1&n&&(F(),X(0,"rect",20)),2&n){const e=C();z("width",.25*e.SPACE_SIZE)("height",.25*e.SPACE_SIZE)("x",.125*e.SPACE_SIZE+.5*e.SPACE_SIZE*e.ko.get().x)("y",.125*e.SPACE_SIZE+.5*e.SPACE_SIZE*e.ko.get().y)}}function x6t(n,t){if(1&n){const e=Oe();F(),O(0,"circle",21),ee("click",function(){const i=ue(e).$implicit;return ce(C().onClick(i.x,i.y))}),A()}if(2&n){const e=t.$implicit,r=C();z("cx",.25*r.SPACE_SIZE+.5*r.SPACE_SIZE*e.x)("cy",.25*r.SPACE_SIZE+.5*r.SPACE_SIZE*e.y)("r",.07*r.SPACE_SIZE)}}let k6t=(()=>{class n extends kH{constructor(e){super(e),this.ko=T.empty(),this.last=T.empty(),this.captures=[],this.GoPiece=We,this.boardHeight=ns.HEIGHT,this.boardWidth=ns.WIDTH,this.scores=T.of([0,0]),this.rules=new g6(ns),this.availableMinimaxes=[new y6t(this.rules,"GoMinimax")],this.encoder=kr.encoder,this.tutorial=(new h3e).tutorial,this.canPass=!0,this.boardHeight=this.getState().board.length,this.boardWidth=this.getState().board[0].length,this.updateBoard()}onClick(e,r){var s=this;return I(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());s.last=T.empty();const o=new kr(e,r);return s.chooseMove(o,s.getState(),s.scores.get())})()}updateBoard(){Q(n.VERBOSE,"updateBoard");const e=this.getState(),r=this.rules.node.move,s=e.phase;this.board=e.getCopiedBoard(),this.scores=T.of(e.getCapturedCopy()),this.ko=e.koCoord,r.isPresent()?this.showCaptures():this.captures=[],this.last=r.map(i=>i.coord),this.canPass=s!==Vn.FINISHED,this.createHoshis()}showCaptures(){const e=this.getPreviousState();this.captures=[];for(let r=0;r<this.board.length;r++)for(let s=0;s<this.board[0].length;s++){const i=new S(s,r),o=e.getPieceAt(i).isOccupied(),c=this.board[r][s]===We.EMPTY,u=!1===this.ko.equalsValue(i);o&&c&&u&&this.captures.push(i)}}pass(){var e=this;return I(function*(){const r=e.getState().phase;return r===Vn.PLAYING||r===Vn.PASSED?e.onClick(kr.PASS.coord.x,kr.PASS.coord.y):(Pe(r===Vn.COUNTING||r===Vn.ACCEPT,"GoComponent: pass() must be called only in playing, passed, counting, or accept phases"),e.onClick(kr.ACCEPT.coord.x,kr.ACCEPT.coord.y))})()}getSpaceClass(e,r){const s=this.getState().getPieceAtXY(e,r);return this.getPlayerClass(s.getOwner())}spaceIsFull(e,r){return this.getState().getPieceAtXY(e,r)!==We.EMPTY&&!this.isTerritory(e,r)}isLastSpace(e,r){if(this.last.isPresent()){const s=this.last.get();return e===s.x&&r===s.y}return!1}isDead(e,r){return this.getState().isDead(new S(e,r))}isTerritory(e,r){return this.getState().isTerritory(new S(e,r))}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(J(En))},n.\u0275cmp=dt({type:n,selectors:[["app-go"]],features:[l],decls:9,vars:8,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["x","0","y","0",1,"base","mid-small-stroke"],["id","blank_board"],[4,"ngFor","ngForOf"],["class","base-no-stroke",3,"id","click",4,"ngFor","ngForOf"],["id","piece_ko_territory_markers_and_dead_stones"],["class","captured-stroke mid-stroke no-fill",4,"ngIf"],["class","captured-fill",3,"click",4,"ngFor","ngForOf"],["fill-opacity","0",1,"base","no-stroke",3,"id","click"],[1,"base","mid-stroke",3,"click"],[1,"base-no-stroke",3,"id","click"],[4,"ngIf","ngIfElse"],["empty",""],[1,"base","mid-stroke",3,"ngClass","click"],["class","base no-fill mid-stroke last-move-stroke",4,"ngIf"],["class","base no-fill captured-stroke",3,"click",4,"ngIf"],[1,"base","no-fill","mid-stroke","last-move-stroke"],[1,"base","no-fill","captured-stroke",3,"click"],[3,"click",4,"ngIf"],[3,"click"],[1,"captured-stroke","mid-stroke","no-fill"],[1,"captured-fill",3,"click"]],template:function(e,r){1&e&&(F(),O(0,"svg",0),X(1,"rect",1),O(2,"g",2),x(3,M6t,2,1,"g",3),x(4,S6t,1,5,"circle",4),A(),O(5,"g",5),x(6,N6t,2,1,"g",3),A(),x(7,I6t,1,4,"rect",6),x(8,x6t,1,3,"circle",7),A()),2&e&&(z("viewBox","0 -3 "+r.boardWidth*r.SPACE_SIZE*.5+" "+(6+r.boardHeight*r.SPACE_SIZE*.5)),P(1),z("width",r.boardWidth*r.SPACE_SIZE*.5)("height",r.boardHeight*r.SPACE_SIZE*.5),P(2),w("ngForOf",r.board),P(1),w("ngForOf",r.hoshis),P(2),w("ngForOf",r.board),P(1),w("ngIf",r.ko.isPresent()),P(1),w("ngForOf",r.captures))},dependencies:[fn,On,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class m6{constructor(t,e,r,s){this.left=t,this.up=e,this.width=r,this.height=s}static fromLimits(t,e,r,s){return new m6(t,r,e-t,s-r)}static fromHexa(t,e,r){const s=t.flatMap(g=>e.getHexaPointsListAt(g)),i=m6.getLimits(s);return new m6(i.minX-r/2,i.minY-r/2,r+i.maxX-i.minX,r+i.maxY-i.minY)}static getLimits(t){let e=Number.MIN_SAFE_INTEGER,r=Number.MIN_SAFE_INTEGER,s=Number.MAX_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER;for(const o of t)s=Math.min(s,o.x),i=Math.min(i,o.y),e=Math.max(e,o.x),r=Math.max(r,o.y);return{minX:s,minY:i,maxX:e,maxY:r}}center(){return new S(this.left+this.width/2,this.up+this.height/2)}bottom(){return this.up+this.height}right(){return this.left+this.width}expand(t,e,r,s){return new m6(this.left-t,this.up-r,this.width+t+e,this.height+r+s)}containingAtLeast(t){const e=Math.min(this.left,t.left),r=Math.max(this.right(),t.right()),s=Math.min(this.up,t.up),i=Math.max(this.bottom(),t.bottom());return m6.fromLimits(e,r,s,i)}toSVGString(){return`${this.left} ${this.up} ${this.width} ${this.height}`}}let rs=(()=>{class n{}return n.CANNOT_DROP_PIECE_YOU_DONT_HAVE=()=>"You cannot drop a piece that you do not have in your reserve.",n.QUEEN_BEE_CAN_ONLY_MOVE_TO_DIRECT_NEIGHBORS=()=>$localize`The queen bee can only move to one of its direct neighbors.`,n.BEETLE_CAN_ONLY_MOVE_TO_DIRECT_NEIGHBORS=()=>$localize`The beetle can only move to one of its direct neighbors.`,n.GRASSHOPPER_MUST_MOVE_IN_STRAIGHT_LINE=()=>$localize`The grasshopper must move in a straight line.`,n.GRASSHOPPER_MUST_JUMP_OVER_PIECES=()=>$localize`The grasshopper must jump over other pieces, without any empty spaces.`,n.SPIDER_MUST_MOVE_ON_NEIGHBORING_SPACES=()=>$localize`The spider must move on neighboring spaces.`,n.SPIDER_CAN_ONLY_MOVE_WITH_DIRECT_CONTACT=()=>$localize`The spider can only move around pieces that are in direct contact with it.`,n.SPIDER_CANNOT_BACKTRACK=()=>$localize`The spider cannot go twice through the same space in the same move.`,n.QUEEN_BEE_MUST_BE_ON_BOARD_BEFORE_MOVE=()=>$localize`The queen bee must be placed on the board before moving a piece.`,n.THIS_PIECE_CANNOT_CLIMB=()=>$localize`Only the beetle is allowed to climb over other pieces.`,n.CANNOT_DISCONNECT_HIVE=()=>$localize`You are not allowed to split the hive.`,n.MUST_BE_ABLE_TO_SLIDE=()=>$localize`This piece must be able to slide to its destination.`,n.MUST_PLACE_QUEEN_BEE_LATEST_AT_FOURTH_TURN=()=>$localize`You must place your queen bee at this turn!`,n.CANNOT_DROP_NEXT_TO_OPPONENT=()=>$localize`You cannot drop a piece next to one of your opponent's stack.`,n.MUST_DROP_ON_EMPTY_SPACE=()=>$localize`You must always drop your piece on an empty space.`,n.MUST_BE_CONNECTED_TO_HIVE=()=>$localize`The piece you are dropping must be connected to the hive.`,n})();class Qs{constructor(t,e){this.owner=t,this.kind=e}toString(){return`${this.kind}_${this.owner.toString()}`}equals(t){return this.owner===t.owner&&this.kind===t.kind}}Qs.encoder=new class extends L4{encode(n){return{owner:n.owner.value,kind:n.kind}}decode(n){Pe(null!==Me.getNonNullable(n).kind,"invalid encoded HivePiece"),Pe(null!==Me.getNonNullable(n).owner,"invalid encoded HivePiece");const t=Me.getNonNullable(n).kind,e=B.of(Me.getNonNullable(n).owner);return new Qs(e,t)}};class F4{constructor(t){this.pieces=t}equals(t){return this.size()===t.size()&&Xe.compareArray(this.pieces,t.pieces)}isEmpty(){return 0===this.pieces.length}hasPieces(){return!1===this.isEmpty()}add(t){return new F4([t,...this.pieces])}topPiece(){return Me.assert(this.hasPieces(),"HivePieceStack: cannot get top piece of an empty stack"),this.pieces[0]}removeTopPiece(){const t=[...this.pieces];return t.shift(),new F4(t)}size(){return this.pieces.length}}F4.EMPTY=new F4([]);class ec extends Ks{constructor(t,e,r){super(e,r),this.piece=t}static from(t,e){return new ec(t,e.x,e.y)}toString(){return`HiveDrop(${this.piece.toString()}, ${this.coord.toString()})`}equals(t){return t instanceof ec&&this.piece.equals(t.piece)&&this.coord.equals(t.coord)}}ec.encoder=Nt.tuple([Qs.encoder,S.encoder],n=>[n.piece,n.coord],n=>new ec(n[0],n[1].x,n[1].y));class x2 extends c8{constructor(t,e){super(t,e)}static from(t,e){return t.equals(e)?_e.failure(et.MOVE_CANNOT_BE_STATIC()):_e.success(new x2(t,e))}toString(){return`HiveMoveCoordToCoord(${this.getStart().toString()} -> ${this.getEnd().toString()})`}equals(t){return!(t instanceof Gc)&&t instanceof x2&&this.getStart().equals(t.getStart())&&this.getEnd().equals(t.getEnd())}}x2.encoder=no.getFallibleEncoder(x2.from);class Gc extends x2{constructor(t){super(t[0],t[3]),this.coords=t}static fromCoords(t){return new Gc(t)}toString(){return`HiveMoveSpider(${this.coords.map(e=>e.toString()).join(", ")})`}equals(t){return t instanceof Gc&&this.getStart().equals(t.getStart())&&this.getEnd().equals(t.getEnd())}}Gc.encoder=Nt.tuple([S.encoder,S.encoder,S.encoder,S.encoder],n=>n.coords,n=>new Gc(n));class VH extends Fi{toString(){return"HiveMovePass"}equals(t){return t instanceof VH}}var Ei;!function(n){n.PASS=new VH,n.drop=function t(s,i){return ec.from(s,i)},n.move=function e(s,i){return x2.from(s,i)},n.spiderMove=function r(s){return Gc.fromCoords(s)},n.encoder=new class extends Nt{encodeMove(s){return s instanceof ec?{moveType:"Drop",encoded:ec.encoder.encode(s)}:s instanceof Gc?{moveType:"Spider",encoded:Gc.encoder.encode(s)}:s instanceof x2?{moveType:"CoordToCoord",encoded:x2.encoder.encode(s)}:{moveType:"Pass"}}decodeMove(s){const i=Me.getNonNullable(s).moveType,o=Me.getNonNullable(s).encoded;return"Drop"===i?ec.encoder.decode(o):"Spider"===i?Gc.encoder.decode(o):"CoordToCoord"===i?x2.encoder.decode(o):n.PASS}}}(Ei||(Ei={}));class Wc{static from(t){return Wc.INSTANCES.isAbsent()&&(Wc.INSTANCES=T.of({QueenBee:OP.get(),Beetle:AP.get(),Grasshopper:NP.get(),Spider:Ym.get(),SoldierAnt:IP.get()})),Wc.INSTANCES.get()[t.kind]}checkEmptyDestination(t,e){return e.getAt(t.getEnd()).hasPieces()?R.failure(rs.THIS_PIECE_CANNOT_CLIMB()):R.SUCCESS}canSlideBetweenNeighbors(t,e,r){const s=new zt(N2.getNeighbors(e)),i=new zt(N2.getNeighbors(r)),o=s.intersection(i);for(const c of o)if(t.getAt(c).isEmpty())return!0;return!1}}Wc.INSTANCES=T.empty();class OP extends Wc{static get(){return this.INSTANCE.isAbsent()&&(this.INSTANCE=T.of(new OP)),this.INSTANCE.get()}moveValidity(t,e){return!1===N2.areNeighbors(t.getStart(),t.getEnd())?R.failure(rs.QUEEN_BEE_CAN_ONLY_MOVE_TO_DIRECT_NEIGHBORS()):!1===this.canSlideBetweenNeighbors(e,t.getStart(),t.getEnd())?R.failure(rs.MUST_BE_ABLE_TO_SLIDE()):this.checkEmptyDestination(t,e)}getPotentialMoves(t,e){const r=[];for(const s of N2.getNeighbors(t))e.getAt(s).isEmpty()&&r.push(x2.from(t,s).get());return r}}OP.INSTANCE=T.empty();class AP extends Wc{static get(){return this.INSTANCE.isAbsent()&&(this.INSTANCE=T.of(new AP)),this.INSTANCE.get()}moveValidity(t,e){return!1===N2.areNeighbors(t.getStart(),t.getEnd())?R.failure(rs.BEETLE_CAN_ONLY_MOVE_TO_DIRECT_NEIGHBORS()):R.SUCCESS}getPotentialMoves(t,e){const r=[];for(const s of N2.getNeighbors(t))r.push(x2.from(t,s).get());return r}}AP.INSTANCE=T.empty();class NP extends Wc{static get(){return this.INSTANCE.isAbsent()&&(this.INSTANCE=T.of(new NP)),this.INSTANCE.get()}moveValidity(t,e){if(Re.factory.fromMove(t.getStart(),t.getEnd()).isFailure())return R.failure(rs.GRASSHOPPER_MUST_MOVE_IN_STRAIGHT_LINE());const s=t.getStart().getCoordsToward(t.getEnd());if(0===s.length)return R.failure(rs.GRASSHOPPER_MUST_JUMP_OVER_PIECES());for(const i of s)if(e.getAt(i).isEmpty())return R.failure(rs.GRASSHOPPER_MUST_JUMP_OVER_PIECES());return this.checkEmptyDestination(t,e)}getPotentialMoves(t,e){const r=[];for(const s of Re.factory.all){const i=t.getNext(s);if(e.getAt(i).hasPieces()){let o=i;for(;e.getAt(o).hasPieces();)o=o.getNext(s);r.push(x2.from(t,o).get())}}return r}}NP.INSTANCE=T.empty();class Ym extends Wc{static get(){return this.INSTANCE.isAbsent()&&(this.INSTANCE=T.of(new Ym)),this.INSTANCE.get()}prefixLegality(t,e){const r=new zt,s=e.update().setAt(t[0],F4.EMPTY).increaseTurnAndFinalizeUpdate();for(let i=1;i<t.length;i++){if(s.getAt(t[i]).hasPieces())return R.failure(rs.THIS_PIECE_CANNOT_CLIMB());if(!1===N2.areNeighbors(t[i-1],t[i]))return R.failure(rs.SPIDER_MUST_MOVE_ON_NEIGHBORING_SPACES());if(!1===s.haveCommonNeighbor(t[i],t[i-1]))return R.failure(rs.SPIDER_CAN_ONLY_MOVE_WITH_DIRECT_CONTACT());if(!1===this.canSlideBetweenNeighbors(s,t[i-1],t[i]))return R.failure(rs.MUST_BE_ABLE_TO_SLIDE());if(r.contains(t[i]))return R.failure(rs.SPIDER_CANNOT_BACKTRACK());r.add(t[i])}return R.SUCCESS}moveValidity(t,e){Me.assert(t instanceof Gc,"HiveSpiderRules: move should be a spider move");const s=this.prefixLegality(t.coords,e);return s.isFailure()?s:this.checkEmptyDestination(t,e)}getPotentialMoves(t,e){const r=e.update().setAt(t,F4.EMPTY).increaseTurnAndFinalizeUpdate();let s=[[t]];for(let c=0;c<3;c++)s=s.flatMap(u=>this.nextMoveStep(r,u));return new zt(s.map(function i(c){return Gc.fromCoords(c)})).toList()}nextMoveStep(t,e){const r=e[e.length-1];return new zt(N2.getNeighbors(r)).filter(function s(o){return!t.getAt(o).hasPieces()&&void 0===e.find(c=>o.equals(c))&&t.haveCommonNeighbor(o,r)}).toList().map(o=>[...e,o])}}Ym.INSTANCE=T.empty();class IP extends Wc{static get(){return this.INSTANCE.isAbsent()&&(this.INSTANCE=T.of(new IP)),this.INSTANCE.get()}pathExists(t,e,r){const s=new zt,i=[e];for(;i.length>0;){const o=i.pop();if(!s.contains(o)){if(s.add(o),o.equals(r))return!0;for(const c of N2.getNeighbors(o)){const u=t.getAt(c).isEmpty(),d=t.getOccupiedNeighbors(c).size()>0,g=this.canSlideBetweenNeighbors(t,o,c);u&&d&&g&&i.push(c)}}}return!1}moveValidity(t,e){return!1===this.pathExists(e,t.getStart(),t.getEnd())?R.failure(rs.MUST_BE_ABLE_TO_SLIDE()):this.checkEmptyDestination(t,e)}getPotentialMoves(t,e){const r=new zt;for(const s of e.occupiedSpaces())if(!s.equals(t))for(const i of e.emptyNeighbors(s))r.add(x2.from(t,i).get());return r.toList()}}IP.INSTANCE=T.empty();class m3e extends _P{constructor(t,e){super(e),this.pieces=t;const r=this.computeScale();this.width=r.width,this.height=r.height,this.pieces.makeImmutable()}getPieces(){return this.pieces}getPieceCoords(){return this.pieces.listKeys()}computeScale(){let t=Number.MAX_SAFE_INTEGER,e=Number.MIN_SAFE_INTEGER,r=Number.MAX_SAFE_INTEGER,s=Number.MIN_SAFE_INTEGER;for(const i of this.pieces.listKeys())t=Math.min(i.x,t),e=Math.max(i.x,e),r=Math.min(i.y,r),s=Math.max(i.y,s);return{width:e+1-t,height:s+1-r}}isOnBoard(t){return this.pieces.containsKey(t)}getOccupiedNeighbors(t){return new zt(N2.getNeighbors(t)).filter(r=>this.pieces.get(r).isPresent())}getGroups(){const t=new zt,e=new zt;return this.pieces.forEach(r=>{if(!1===t.contains(r.key)){const s=new zt,i=new zt([r.key]);for(;i.hasElements();){const o=i.getAnyElement().get();i.remove(o),t.add(o),s.add(o),i.addAll(this.getOccupiedNeighbors(o).filter(c=>!1===t.contains(c)))}e.add(s)}}),e}}class xP{constructor(t){this.pieces=t}static getInitial(){const t=new Un;for(const e of B.PLAYERS)t.set(new Qs(e,"QueenBee"),1),t.set(new Qs(e,"Beetle"),2),t.set(new Qs(e,"Spider"),2),t.set(new Qs(e,"Grasshopper"),3),t.set(new Qs(e,"SoldierAnt"),3);return t.makeImmutable(),new xP(t)}equals(t){return this.pieces.equals(t.pieces)}getQuantity(t){return this.pieces.get(t).get()}hasRemaining(t){return this.getQuantity(t)>0}getAny(t){for(const e of this.pieces.listKeys())if(e.owner===t&&this.hasRemaining(e))return T.of(e);return T.empty()}remove(t){const e=this.pieces.get(t).get();Me.assert(e>0,"HiveRemainingPieces cannot remove a non-remainingPiece");const r=this.pieces.getCopy();return r.replace(t,e-1),new xP(r)}toListOfStacks(){const t=[];return this.pieces.forEach(e=>{const r=[];for(let s=0;s<e.value;s++)r.push(e.key);t.push(new F4(r))}),t}getPlayerPieces(t){const e=[];return this.pieces.forEach(r=>{r.key.owner===t&&r.value>0&&e.push(r.key)}),e}}class Km{constructor(t,e,r,s){this.pieces=t,this.remainingPieces=e,this.queenBees=r,this.turn=s}static of(t){return new Km(t.pieces,t.remainingPieces,t.queenBees,t.turn)}setAt(t,e){const r=this.queenBees.getCopy();for(const i of B.PLAYERS)r.get(i).equalsValue(t)&&r.delete(i);for(const i of e.pieces)"QueenBee"===i.kind&&r.put(i.owner,t);const s=this.pieces.getCopy();return e.isEmpty()?s.delete(t):s.put(t,e),new Km(s,this.remainingPieces,r,this.turn)}removeRemainingPiece(t){return new Km(this.pieces,this.remainingPieces.remove(t),this.queenBees,this.turn)}increaseTurnAndFinalizeUpdate(){return new k2(this.pieces,this.remainingPieces,this.queenBees,this.turn+1)}}class k2 extends m3e{constructor(t,e,r,s){super(t,s),this.remainingPieces=e,this.queenBees=r,this.queenBees=r.getCopy();for(const i of r.listKeys()){const o=r.get(i).get();this.queenBees.replace(i,o)}this.queenBees.makeImmutable()}static getInitialState(){return k2.fromRepresentation([],0)}static fromRepresentation(t,e,r=new Bt(0,0)){const s=new ym;let i=xP.getInitial();const o=new Un;for(let c=0;c<t.length;c++)for(let u=0;u<t[0].length;u++)if(t[c][u].length>0){const d=new S(u,c).getNext(r,1);s.set(d,new F4(t[c][u]));const g=T.ofNullable(t[c][u].find(m=>"QueenBee"===m.kind));g.isPresent()&&o.set(g.get().owner,d);for(const m of t[c][u])i=i.remove(m)}return new k2(s,i,o,e)}update(){return Km.of(this)}equals(t){return this.pieces.equals(t.pieces)&&this.remainingPieces.equals(t.remainingPieces)&&this.queenBees.equals(t.queenBees)&&this.turn===t.turn}getAt(t){return this.isOnBoard(t)?this.pieces.get(t).get():F4.EMPTY}queenBeeLocation(t){return this.queenBees.get(t)}hasQueenBeeOnBoard(t){return this.queenBeeLocation(t).isPresent()}numberOfNeighbors(t){let e=0;for(const r of Re.factory.all){const s=t.getNext(r);this.getAt(s).hasPieces()&&(e+=1)}return e}isDisconnected(){return this.getGroups().size()>1}occupiedSpaces(){return this.pieces.listKeys()}emptyNeighbors(t){const e=[];for(const r of N2.getNeighbors(t))this.getAt(r).isEmpty()&&e.push(r);return e}haveCommonNeighbor(t,e){const r=this.getOccupiedNeighbors(t),s=this.getOccupiedNeighbors(e);return r.findAnyCommonElement(s).isPresent()}}class Gi extends L1{constructor(){super(k2)}static get(){return Gi.singleton.isAbsent()&&(Gi.singleton=T.of(new Gi)),Gi.singleton.get()}applyLegalMove(t,e,r){return t instanceof ec?this.applyLegalDrop(t,e):t instanceof x2?this.applyLegalMoveCoordToCoord(t,e):e.update().increaseTurnAndFinalizeUpdate()}applyLegalDrop(t,e){const r=e.getAt(t.coord);return e.update().setAt(t.coord,r.add(t.piece)).removeRemainingPiece(t.piece).increaseTurnAndFinalizeUpdate()}applyLegalMoveCoordToCoord(t,e){const r=e.getAt(t.getStart()),s=e.getAt(t.getEnd());return e.update().setAt(t.getStart(),r.removeTopPiece()).setAt(t.getEnd(),s.add(r.topPiece())).increaseTurnAndFinalizeUpdate()}isLegal(t,e){return t instanceof ec?this.isLegalDrop(t,e):t instanceof x2?this.isLegalMoveCoordToCoord(t,e):this.shouldPass(e)?R.SUCCESS:R.failure(et.CANNOT_PASS())}isLegalMoveCoordToCoord(t,e){if(!1===e.queenBeeLocation(e.getCurrentPlayer()).isPresent())return R.failure(rs.QUEEN_BEE_MUST_BE_ON_BOARD_BEFORE_MOVE());const r=e.getAt(t.getStart());if(r.isEmpty())return R.failure(et.MUST_CHOOSE_PLAYER_PIECE());const s=r.topPiece();if(s.owner===e.getCurrentOpponent())return R.failure(et.MUST_CHOOSE_PLAYER_PIECE());const i=Wc.from(s).moveValidity(t,e);if(i.isFailure())return i;const o=e.update().setAt(t.getStart(),r.removeTopPiece()).increaseTurnAndFinalizeUpdate();if(o.isDisconnected())return R.failure(rs.CANNOT_DISCONNECT_HIVE());const c=t.getEnd();return 0===o.numberOfNeighbors(c)?R.failure(rs.CANNOT_DISCONNECT_HIVE()):R.SUCCESS}mustPlaceQueenBee(t){return t.turn>=6&&!1===t.hasQueenBeeOnBoard(t.getCurrentPlayer())}isLegalDrop(t,e){const r=e.getCurrentPlayer();if(t.piece.owner===r.getOpponent())return R.failure(et.MUST_CHOOSE_PLAYER_PIECE());if(!1===e.remainingPieces.hasRemaining(t.piece))return R.failure(rs.CANNOT_DROP_PIECE_YOU_DONT_HAVE());if("QueenBee"!==t.piece.kind&&this.mustPlaceQueenBee(e))return R.failure(rs.MUST_PLACE_QUEEN_BEE_LATEST_AT_FOURTH_TURN());const s=this.checkNeighborValidity(t,e);return s.isFailure()?s:e.getAt(t.coord).hasPieces()?R.failure(rs.MUST_DROP_ON_EMPTY_SPACE()):R.SUCCESS}checkNeighborValidity(t,e){const r=e.getCurrentPlayer();let s=!1;for(const i of N2.getNeighbors(t.coord)){const o=e.getAt(i);if(o.hasPieces()&&(s=!0,1!==e.turn&&o.topPiece().owner===r.getOpponent()))return R.failure(rs.CANNOT_DROP_NEXT_TO_OPPONENT())}return 0!==e.turn&&!1===s?R.failure(rs.MUST_BE_CONNECTED_TO_HIVE()):R.SUCCESS}getPossibleDropLocations(t){const e=t.getCurrentPlayer();if(0===t.turn)return new zt([new S(0,0)]);if(1===t.turn)return new zt(N2.getNeighbors(new S(0,0)));const r=t.remainingPieces.getAny(e);if(r.isAbsent())return new zt;const s=r.get(),i=new zt;for(const o of t.occupiedSpaces())if(t.getAt(o).topPiece().owner===e)for(const c of t.emptyNeighbors(o)){const u=ec.from(s,c);this.isLegalDrop(u,t).isSuccess()&&i.add(c)}return i}getPossibleMovesFrom(t,e){const r=t.getCurrentPlayer(),s=new zt,i=t.getAt(e).topPiece();if(i.owner===r)for(const o of Wc.from(i).getPotentialMoves(e,t))this.isLegalMoveCoordToCoord(o,t).isSuccess()&&s.add(o);return s}getPossibleMovesOnBoard(t){const e=new zt;for(const r of t.occupiedSpaces())e.addAll(this.getPossibleMovesFrom(t,r));return e}shouldPass(t){return 0===this.getPossibleDropLocations(t).size()&&0===this.getPossibleMovesOnBoard(t).size()}getGameStatus(t){const e=t.gameState,r=[0,0];for(const s of B.PLAYERS){const i=e.queenBeeLocation(s);i.isPresent()&&(r[s.value]=e.numberOfNeighbors(i.get()))}return 6===r[0]&&6===r[1]?xe.DRAW:6===r[0]?xe.getVictory(B.ONE):6===r[1]?xe.getVictory(B.ZERO):xe.ONGOING}}Gi.singleton=T.empty();class R6t extends xs{getListMoves(t){const e=this.getListDrops(t.gameState),r=this.getListOfOnBoardMoves(t.gameState),s=e.concat(r);return 0===s.length?[Ei.PASS]:s}getListOfOnBoardMoves(t){return Gi.get().getPossibleMovesOnBoard(t).toList()}getListDrops(t){const e=[],r=t.getCurrentPlayer(),s=new Qs(r,"QueenBee");for(const i of Gi.get().getPossibleDropLocations(t))if(Gi.get().mustPlaceQueenBee(t))e.push(Ei.drop(s,i));else for(const o of t.remainingPieces.getPlayerPieces(t.getCurrentPlayer()))e.push(Ei.drop(o,i));return e}getMetrics(t){return[this.queenBeeMobility(t.gameState,B.ZERO),this.queenBeeMobility(t.gameState,B.ONE)]}queenBeeMobility(t,e){const r=t.queenBeeLocation(e);return r.isPresent()?Gi.get().getPossibleMovesFrom(t,r.get()).size():0}}const B4=new Qs(B.ZERO,"QueenBee"),N5=new Qs(B.ZERO,"Beetle"),xd=new Qs(B.ZERO,"Grasshopper"),kP=new Qs(B.ZERO,"Spider"),LP=new Qs(B.ZERO,"SoldierAnt"),I5=new Qs(B.ONE,"QueenBee"),tc=new Qs(B.ONE,"Beetle"),HH=new Qs(B.ONE,"Grasshopper"),FH=new Qs(B.ONE,"Spider"),Xm=new Qs(B.ONE,"SoldierAnt");class _3e extends $1{constructor(){super(...arguments),this.tutorial=[ie.informational($localize`Hive`,$localize`Hive is a game without a board, where pieces are placed on the side of each other, in a contiguous block called the hive. Each player has 11 pieces, representing various insects.`,k2.fromRepresentation([[[I5],[tc],[FH],[xd]],[[xd],[],[LP],[]],[[LP],[],[],[]]],8)),ie.informational($localize`Object of the game`,$localize`The object of the game at Hive is to surround the opponent's queen. Once the queen is surrounded by 6 pieces, no matter the owner of these pieces, the game ends. The player with a queen that is not surrounded wins. In case both queens are fully surrounded at the same turn, it is a draw. Here, Dark won.`,k2.fromRepresentation([[[],[tc],[kP]],[[Xm],[I5],[B4]],[[xd],[N5],[]]],7)),ie.anyMove($localize`Placing the first and second piece`,$localize`There are two types of actions: drops and moves. Initially, the board is empty, so we will have to put (drop) pieces on the board. For the first piece dropped on the board, there is no placement restriction: you can choose any piece and put in on the board. The second piece, put by Light, will need to be put in a neighboring space of the first piece. To drop a piece on the board, select the piece of your choice in your remaining pieces (below the board), and then click on the space you want to drop it on.<br/><br/>You're playing Dark and starting the game, put any piece on the board.`,k2.getInitialState(),Ei.drop(N5,new S(0,0)),$localize`Congratulations!`),ie.anyMove($localize`Placing pieces after the second turn`,$localize`After the second turn, you are still allowed to place pieces any time you want, as long as you respect two conditions: <ol><li>your piece must be connected to the hive, and</li><li>the space on which you drop your piece must not touch a stack of the opponent.</li></ol><br/><br/>You're playing Dark, drop a piece on the board.`,k2.fromRepresentation([[[tc],[xd]]],2),Ei.drop(B4,new S(2,0)),$localize`Congratulations!`),ie.fromMove($localize`Moving pieces: the queen bee`,$localize`Once you have placed you queen bee on the board, you can move your pieces. You must place your queen bee on the board as your fourth piece at the latest. Each creature moves in a different way, and moves should respect two restrictions:<ol><li>the hive must always remain fully connected, and</li><li>pieces should be able to physically slide to their destination (except for the beetle and grasshopper as we will see later).</li></ol>The queen bee can move to any of its empty neighbors. To move a piece, click on it and then click on its destination. The possible destinations are highlighted.<br/><br/>You are playing Dark, move your queen bee.`,k2.fromRepresentation([[[],[kP],[HH],[I5],[tc]],[[tc],[B4],[N5],[],[]]],4),[Ei.move(new S(1,1),new S(0,2)).get(),Ei.move(new S(1,1),new S(1,2)).get()],$localize`Congratulations!`,$localize`Failed. Try again.`),ie.fromMove($localize`Moving the beetle`,$localize`The beetle moves like the queen bee, but it is allowed to climb on top of other pieces! Therefore, it need not adhere to the sliding restriction. Note that you are not allowed to drop the beetle on top of another piece in the drop phase, this can only be achieved when moving a beetle already on the board. A piece with a beetle on top is not allowed to move. A stack is considered to be of the player who has the beetle of the top.<br/><br/>You're playing Dark, block your opponent's queen by moving on top of it!`,k2.fromRepresentation([[[B4],[I5],[N5]],[[tc],[],[]]],6),[Ei.move(new S(2,0),new S(1,0)).get()],$localize`Congratulations!`,$localize`Failed. Try again.`),ie.forClick($localize`Inspecting stacks`,$localize`When pieces are stacked together, you are allowed to inspect the stack to see which pieces are under the beetle. This works with opponent-controlled stacks too. To do so, you can simply click on any stack to see their composition.<br/><br/>You're playing Dark and your opponent has a beetle on top of one of your piece, click on it.`,k2.fromRepresentation([[[tc,B4],[I5],[N5]]],2),["#piece_0_0"],$localize`Congratulations!`,$localize`Failed. Try again.`),ie.fromMove($localize`Moving the grasshopper`,$localize`The grasshopper jumps over one or more pieces in a straight line, and stops at the first empty space encountered. It cannot jump over empty spaces, and can only move through jumps. Because it jumps, it does not adhere to the sliding restriction.<br/><br/>You're playing Dark. Jump over three pieces with your grasshopper!`,k2.fromRepresentation([[[xd],[B4],[tc],[Xm]],[[HH],[],[],[]]],6),[Ei.move(new S(0,0),new S(4,0)).get()],$localize`Congratulations!`,$localize`Failed. Try again.`),ie.fromPredicate($localize`Moving the soldier ant`,$localize`The soldier ant is a powerful piece: it can move anywhere in the hive as long as it respects the sliding and the one hive restrictions!<br/><br/>You're playing Dark. Your queen bee is stuck, move your soldier ant to free up your queen!`,k2.fromRepresentation([[[],[LP],[I5]],[[],[B4],[tc]],[[Xm],[FH],[]]],6),Ei.move(new S(1,0),new S(3,1)).get(),(t,e,r)=>t.equals(Ei.move(new S(1,0),new S(0,1)).get())?R.failure($localize`You have not freed your queen, try again!`):R.SUCCESS,$localize`Congratulations!`),ie.anyMove($localize`Moving the spider`,$localize`Finally, the spider can move exactly 3 spaces at a time. It is not allowed to go twice through the same space in a move. As the spider crawls around other pieces, it can only move around pieces that are in direct contact with it. This means that the spider is not allowed to temporarily split the hive. For example, here, Dark's spider cannot go on the left as its first move. To do a spider move, select a spider and click on the three spaces that compose the move.<br/><br/>You're playing Dark, move your spider!`,k2.fromRepresentation([[[],[kP],[FH],[tc]],[[],[],[],[N5]],[[tc],[],[],[Xm]],[[LP],[],[xd],[]],[[B4],[HH],[],[]]],6),Ei.spiderMove([new S(1,0),new S(1,1),new S(2,1),new S(2,2)]),$localize`Congratulations!`),ie.informational($localize`Restrictions`,$localize`Let us clarify the two restrictions during moves.<ol><li>All pieces of the hive should always be connected in a way that there is a single hive. It can be the case that your piece disconnects from the hive when you slide it, but after the move there should be only one hive.</li><li>Except grasshoppers and beetles, all moves should be done by sliding the piece without disturbing the rest of the hive.</li></ol>Observe here how the queen bee is stuck, as it is not possible to slide it without moving one of the other pieces. Moreover, moving it would split the hive in two.`,k2.fromRepresentation([[[],[kP],[]],[[],[B4],[tc]],[[Xm],[],[]]],6)),ie.informational($localize`Passing your turn`,$localize`Finally, it is possible that you are not able to do any move: when it is the case, you must pass your turn. Here, Dark must pass: the queen bee cannot move without disconnecting the hive, the beetle is stuck beneath another beetle, and a dropped piece would be in contact with an opponent's piece.`,k2.fromRepresentation([[[tc,N5],[B4],[I5]]],4))]}}const D6t=["app-hive-piece",""];function z6t(n,t){1&n&&(F(),X(0,"path",9))}function V6t(n,t){1&n&&(F(),X(0,"path",10))}function H6t(n,t){1&n&&(F(),X(0,"path",11))}function F6t(n,t){1&n&&(F(),X(0,"path",12))}function B6t(n,t){1&n&&(F(),X(0,"path",13))}let $6t=(()=>{class n extends Gce{constructor(){super(...arguments),this.hexaPoints="",this.pieceClass="",this.isoPointsLight="",this.isoPointsDark="",this.isoPointsStroke="",this.layerTransform="",this.hexaCenter=new S(0,0)}ngAfterContentChecked(){const e=new S(this.x,this.y);this.pieceClass=this.getPlayerClass(this.piece.owner),this.hexaPoints=this.hexaLayout.getHexaPointsAt(e),this.hexaCenter=this.hexaLayout.getCenterAt(e);const s=this.hexaLayout.getIsoPoints(e,this.pieceHeight).map(i=>i.map(o=>o.toSVGPoint()).join(" "));this.isoPointsLight=s[0],this.isoPointsDark=s[1],this.isoPointsStroke=s[2],this.layerTransform=`translate(0 -${(this.layer+1)*this.pieceHeight})`}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=Mr(n)))(r||n)}}(),n.\u0275cmp=dt({type:n,selectors:[["","app-hive-piece",""]],inputs:{piece:"piece",x:"x",y:"y",hexaLayout:"hexaLayout",layer:"layer",pieceHeight:"pieceHeight"},features:[l],attrs:D6t,decls:11,vars:14,consts:[[1,"base","no-stroke","lighter",3,"ngClass"],[1,"base","no-stroke","darker",3,"ngClass"],[1,"base","no-fill","small-stroke"],[1,"base","small-stroke",3,"ngClass"],["d","M 15.3841 1.25408 C 22.8728 -1.82428 29.9895 -8.66692 29.9895 -11.9438 C 29.9895 -12.8799 29.4656 -13.6136 28.5873 -13.906 C 27.8046 -14.1664 24.6195 -14.3188 14.4763 -7.04548 C 14.3844 -7.97908 13.9844 -8.82172 13.3836 -9.47812 C 13.4167 -9.58096 13.4394 -9.6886 13.4394 -9.80284 C 13.4394 -13.1571 9.49688 -15.9237 3.91664 -16.864 C 3.97556 -18.4007 4.88768 -22.8456 12.8845 -26.8437 C 13.4073 -27.1052 13.6191 -27.7406 13.3578 -28.2634 C 13.0953 -28.7862 12.4609 -28.9971 11.938 -28.7367 C 3.34424 -24.4397 1.97336 -19.361 1.81856 -17.1244 C 1.12448 -17.1802 0.41168 -17.2094 -0.31564 -17.2094 C -1.40548 -17.2094 -2.46052 -17.1422 -3.47128 -17.0189 C -3.59032 -19.1981 -4.86616 -24.371 -13.5975 -28.7366 C -14.1203 -28.997 -14.7548 -28.7861 -15.0172 -28.2633 C -15.2787 -27.7404 -15.0668 -27.1049 -14.5439 -26.8436 C -6.16912 -22.6568 -5.56468 -17.9801 -5.57296 -16.6665 C -10.6046 -15.5753 -14.0706 -12.9474 -14.0706 -9.8026 C -14.0706 -9.68836 -14.048 -9.58072 -14.0146 -9.47788 C -14.6715 -8.76052 -15.0833 -7.81948 -15.121 -6.78208 C -25.5504 -14.3201 -28.8038 -14.17 -29.5978 -13.9058 C -30.4761 -13.6134 -31 -12.8799 -31 -11.9438 C -31 -8.63464 -23.7414 -1.68868 -16.1718 1.3442 C -23.7414 4.3772 -31 11.3233 -31 14.6323 C -31 15.5684 -30.4761 16.3021 -29.5968 16.5955 C -29.4222 16.6533 -29.1701 16.7371 -28.7516 16.7371 C -27.2727 16.7371 -23.7153 15.6854 -14.1678 8.74748 C -13.8431 9.143 -13.5125 9.47624 -13.0664 9.73316 C -12.821 16.1545 -7.58992 21.3656 -1.50604 21.892 L -1.50604 27.23 C -1.50604 27.8149 -1.03276 28.288 -0.448 28.288 C 0.13688 28.288 0.61004 27.8148 0.61004 27.23 L 0.61004 21.892 C 6.95852 21.3656 12.0572 16.1545 12.3026 9.73316 C 12.7614 9.46892 13.1995 9.12296 13.5294 8.71304 C 23.1112 15.6825 26.6942 16.738 28.1769 16.738 C 28.5964 16.738 28.8579 16.6533 29.0335 16.5944 C 29.9118 16.302 30.4398 15.5684 30.4398 14.6322 C 30.44 11.2893 23.0366 4.23644 15.3841 1.25408 Z M -28.8921 -11.9096 C -27.3192 -12.3306 -20.102 -7.90708 -13.9077 -3.24676 C -14.6109 -2.53432 -15.059 -1.57444 -15.1169 -0.51196 C -23.053 -3.54004 -29.0001 -10.3224 -28.8921 -11.9096 Z M -15.1288 6.06848 C -15.1288 6.31232 -15.1035 6.55004 -15.0636 6.78248 C -22.932 12.527 -27.6682 14.8687 -28.8932 14.593 C -28.9924 12.9306 -22.5395 5.64788 -14.1152 2.8394 C -14.0278 2.81048 -13.9496 2.76812 -13.8756 2.72 C -13.8144 2.78096 -13.7488 2.837 -13.6838 2.89412 C -14.5674 3.67016 -15.1288 4.80368 -15.1288 6.06848 Z M 27.8827 -11.9055 C 27.9772 -10.3347 22.2198 -3.74764 14.4784 -0.65668 C 14.3818 -1.74316 13.8714 -2.71012 13.1071 -3.40516 C 19.2103 -7.978 26.2028 -12.271 27.8827 -11.9055 Z M -0.31564 -15.0932 C 5.65928 -15.0932 10.0551 -12.9976 11.0895 -10.7981 C 10.8201 -10.8519 10.5422 -10.9012 10.257 -10.9012 L -10.8881 -10.9012 C -11.1731 -10.9012 -11.4513 -10.8519 -11.7207 -10.7981 C -10.6866 -12.9976 -6.29056 -15.0932 -0.31564 -15.0932 Z M -0.31564 19.7833 C -5.79256 19.7833 -10.3106 15.551 -10.8432 10.2606 L 10.2122 10.2606 C 9.67952 15.5509 5.16128 19.7833 -0.31564 19.7833 Z M 10.257 8.14436 L -10.8881 8.14436 C -12.0599 8.14436 -13.0126 7.1948 -13.0126 6.02816 C -13.0126 4.86152 -12.0599 3.91196 -10.8881 3.91196 L 10.257 3.91196 C 11.4286 3.91196 12.3813 4.86152 12.3813 6.02816 C 12.3813 7.1948 11.4286 8.14436 10.257 8.14436 Z M 10.257 1.79588 L -10.8881 1.79588 C -12.0599 1.79588 -13.0126 0.84632 -13.0126 -0.32032 C -13.0126 -1.48696 -12.0599 -2.43652 -10.8881 -2.43652 L 10.257 -2.43652 C 11.4286 -2.43652 12.3813 -1.48696 12.3813 -0.32032 C 12.3813 0.84632 11.4286 1.79588 10.257 1.79588 Z M 10.257 -4.5526 L -10.8881 -4.5526 C -12.0599 -4.5526 -13.0126 -5.50216 -13.0126 -6.6688 C -13.0126 -7.83544 -12.0599 -8.785 -10.8881 -8.785 L 10.257 -8.785 C 11.4286 -8.785 12.3813 -7.83544 12.3813 -6.6688 C 12.3813 -5.50216 11.4286 -4.5526 10.257 -4.5526 Z M 28.3363 14.5982 C 27.2038 14.8942 22.4127 12.5611 14.4402 6.73292 C 14.4745 6.51596 14.4975 6.29504 14.4975 6.06848 C 14.4975 4.8038 13.9364 3.67028 13.0527 2.89424 C 13.1287 2.82764 13.2044 2.7602 13.2751 2.68832 C 13.3609 2.75036 13.4539 2.80436 13.5592 2.8394 C 21.9908 5.651 28.4488 12.945 28.3363 14.5982 Z",4,"ngIf"],["d","M 27.079 1.30667 L 15.7412 -4.79822 L 15.7412 -7.89145 C 15.7412 -8.39311 15.335 -8.80033 14.8324 -8.80033 L 12.1056 -8.80033 L 12.1056 -9.70918 C 12.1056 -10.4088 12.0442 -11.0941 11.927 -11.7605 L 17.9173 -14.3278 C 18.2517 -14.4705 18.4681 -14.7995 18.4681 -15.1622 L 18.4681 -25.1602 L 23.9215 -25.1602 C 24.4242 -25.1602 24.8304 -25.5674 24.8304 -26.0691 C 24.8304 -26.5718 24.4242 -26.978 23.9215 -26.978 L 17.5592 -26.978 C 17.0566 -26.978 16.6503 -26.5718 16.6503 -26.0691 L 16.6503 -15.7621 L 11.4679 -13.5404 C 10.6322 -15.9716 9.02444 -18.0467 6.93872 -19.4717 C 7.86471 -20.1312 8.47025 -21.2128 8.47025 -22.4339 C 8.47025 -24.439 6.83966 -26.0695 4.83465 -26.0695 C 4.33202 -26.0695 3.92577 -25.6623 3.92577 -25.1607 C 3.92577 -24.659 4.33202 -24.2518 4.83465 -24.2518 C 5.83716 -24.2518 6.65252 -23.4366 6.65252 -22.4339 C 6.65252 -21.4314 5.83726 -20.6161 4.83465 -20.6161 L 4.83336 -20.616 C 3.43401 -21.2012 1.89916 -21.525 0.290076 -21.525 C -1.31901 -21.525 -2.85386 -21.2012 -4.25324 -20.616 L -4.2545 -20.6161 C -5.257 -20.6161 -6.07236 -21.4313 -6.07236 -22.4339 C -6.07236 -23.4365 -5.25711 -24.2518 -4.2545 -24.2518 C -3.75186 -24.2518 -3.34563 -24.659 -3.34563 -25.1607 C -3.34563 -25.6623 -3.75186 -26.0695 -4.2545 -26.0695 C -6.25961 -26.0695 -7.89009 -24.4389 -7.89009 -22.4339 C -7.89009 -21.2127 -7.28459 -20.1312 -6.35856 -19.4717 C -8.44428 -18.0467 -10.0521 -15.9716 -10.8877 -13.5404 L -16.0702 -15.7621 L -16.0702 -26.0691 C -16.0702 -26.5718 -16.4764 -26.978 -16.979 -26.978 L -23.3419 -26.978 C -23.8445 -26.978 -24.2508 -26.5718 -24.2508 -26.0691 C -24.2508 -25.5674 -23.8445 -25.1602 -23.3419 -25.1602 L -17.8884 -25.1602 L -17.8884 -15.1622 C -17.8884 -14.7995 -17.6721 -14.4705 -17.3377 -14.3278 L -11.3474 -11.7605 C -11.4646 -11.0941 -11.526 -10.4086 -11.526 -9.70917 L -11.526 -8.80033 L -14.2527 -8.80033 C -14.7554 -8.80033 -15.1616 -8.3931 -15.1616 -7.89145 L -15.1616 -4.79822 L -26.4994 1.30667 C -26.9411 1.54388 -27.1074 2.09561 -26.8693 2.53732 C -26.7047 2.84269 -26.3912 3.01546 -26.0677 3.01546 C -25.9223 3.01546 -25.775 2.98095 -25.6378 2.90639 L -15.1617 -2.73463 L -15.1617 5.31601 L -20.2889 9.58867 C -20.6025 9.85047 -20.7034 10.2904 -20.5334 10.663 L -16.1815 20.2374 L -19.5862 26.1962 C -19.8362 26.6316 -19.6845 27.1869 -19.2482 27.4359 C -19.1064 27.5177 -18.951 27.5559 -18.7983 27.5559 C -18.4819 27.5559 -18.1757 27.3913 -18.0085 27.0978 L -14.3729 20.7354 C -14.2283 20.4818 -14.2138 20.1747 -14.3347 19.9084 L -18.5921 10.5411 L -15.1618 7.68295 L -15.1618 8.46881 C -15.1618 16.989 -8.23053 23.9203 0.28965 23.9203 C 8.80982 23.9203 15.7411 16.989 15.7411 8.46881 L 15.7411 7.68295 L 19.1714 10.5411 L 14.9141 19.9084 C 14.7932 20.1747 14.8078 20.4819 14.9522 20.7354 L 18.5878 27.0978 C 18.755 27.3913 19.0614 27.5559 19.3776 27.5559 C 19.5303 27.5559 19.6857 27.5177 19.8275 27.4359 C 20.2638 27.1869 20.4155 26.6316 20.1656 26.1962 L 16.7608 20.2374 L 21.1127 10.663 C 21.2827 10.2903 21.1817 9.85037 20.8681 9.58867 L 15.741 5.31601 L 15.741 -2.73463 L 26.2171 2.90639 C 26.3544 2.98095 26.5016 3.01546 26.647 3.01546 C 26.9705 3.01546 27.2841 2.8428 27.4486 2.53732 C 27.687 2.09561 27.5207 1.54398 27.079 1.30667 Z M -9.70827 -9.70928 C -9.70827 -15.2218 -5.22281 -19.7073 0.289757 -19.7073 C 5.80234 -19.7073 10.2878 -15.2219 10.2878 -9.70928 L 10.2878 -8.80044 L -9.70827 -8.80044 Z M -10.6171 -6.98257 L 11.1966 -6.98257 L 13.9234 -6.98257 L 13.9234 -4.26531 C 13.9233 -4.25796 13.9233 -4.25065 13.9234 -4.24316 L 13.9234 -3.87835 L 0.289757 3.79022 L -13.3439 -3.87835 L -13.3439 -4.24316 C -13.3438 -4.25051 -13.3438 -4.25786 -13.3439 -4.26531 L -13.3439 -6.98257 Z M -13.3439 8.46892 L -13.3439 5.74091 L -13.3439 5.73461 L -13.3439 -1.79295 L -0.619115 5.36501 L -0.619115 22.0715 C -7.71446 21.6021 -13.3439 15.681 -13.3439 8.46892 Z M 1.19863 22.0715 L 1.19863 5.36501 L 13.9234 -1.79295 L 13.9234 5.73471 L 13.9234 5.7408 L 13.9234 8.46902 C 13.9234 15.681 8.29409 21.6021 1.19863 22.0715 Z",4,"ngIf"],["d","M 23.1993 15.5733 C 21.3366 14.109 18.3446 11.7414 17.7296 11.2169 C 12.9652 2.64827 6.39655 -0.814228 5.07856 -1.44294 C 5.33756 -1.88486 5.4918 -2.35409 5.4918 -2.83719 C 5.4918 -3.30048 5.3294 -3.93486 5.04265 -5.01624 C 4.8512 -5.73792 4.63024 -6.57068 4.49294 -7.31486 C 4.59374 -7.31187 4.69419 -7.30891 4.79464 -7.30891 C 8.94543 -7.30891 12.7535 -9.75455 12.9341 -9.87229 C 13.1714 -10.0271 13.3373 -10.2703 13.3943 -10.5478 C 13.451 -10.8255 13.3949 -11.1144 13.2379 -11.3502 L 11.5052 -13.9494 C 13.7039 -15.6498 16.0931 -16.5487 16.1187 -16.5583 C 16.6686 -16.7613 16.9498 -17.3717 16.7467 -17.9216 C 16.5433 -18.4713 15.9332 -18.7522 15.3835 -18.5494 C 15.2491 -18.4996 12.0538 -17.304 9.38881 -14.9538 C 8.99075 -14.6026 8.91323 -14.0109 9.20786 -13.5691 L 10.8409 -11.1198 C 9.64329 -10.4953 7.44869 -9.53254 5.16354 -9.43858 C 5.21814 -9.64602 5.24334 -9.83818 5.25069 -10.0066 C 5.28989 -10.9199 4.88588 -11.8072 4.04914 -12.6442 C 3.74954 -12.9441 3.51227 -13.3816 3.26136 -13.8449 C 2.98206 -14.3609 2.65176 -14.9693 2.15511 -15.4578 C 2.8653 -18.087 7.91209 -26.8789 12.9465 -30.2572 C 13.4331 -30.5838 13.5628 -31.2431 13.2359 -31.7297 C 12.909 -32.2165 12.2501 -32.3464 11.7633 -32.0197 C 6.51594 -28.4984 1.39127 -19.8963 0.213976 -16.338 C 0.113176 -16.3457 0.00992607 -16.351 -0.0975239 -16.351 C -0.204974 -16.351 -0.308574 -16.3457 -0.409374 -16.338 C -1.58669 -19.8963 -6.71146 -28.4984 -11.9586 -32.0197 C -12.4453 -32.3465 -13.1048 -32.2168 -13.4313 -31.7297 C -13.7575 -31.2431 -13.6283 -30.5836 -13.1415 -30.2572 C -8.10712 -26.8789 -3.0603 -18.087 -2.35008 -15.4578 C -2.8469 -14.9693 -3.17709 -14.3609 -3.45639 -13.8449 C -3.70734 -13.3816 -3.94429 -12.9441 -4.24417 -12.6442 C -5.08116 -11.8072 -5.48531 -10.9199 -5.44569 -10.0066 C -5.43869 -9.83861 -5.41034 -9.64675 -5.35889 -9.43985 C -7.63784 -9.53621 -9.83525 -10.4982 -11.0349 -11.1215 L -9.4031 -13.5691 C -9.1084 -14.0109 -9.18575 -14.6025 -9.58405 -14.9538 C -12.249 -17.304 -15.4439 -18.4998 -15.5787 -18.5494 C -16.1283 -18.7529 -16.7389 -18.4714 -16.9419 -17.9216 C -17.1453 -17.3717 -16.8639 -16.7614 -16.3139 -16.5583 C -16.2894 -16.5485 -13.9065 -15.6578 -11.7003 -13.9495 L -13.4331 -11.3502 C -13.5903 -11.1144 -13.6466 -10.8255 -13.5896 -10.5478 C -13.5325 -10.2702 -13.3666 -10.027 -13.1294 -9.87229 C -12.9485 -9.75455 -9.14095 -7.30891 -4.98985 -7.30891 C -4.8894 -7.30891 -4.7886 -7.31201 -4.68815 -7.31486 C -4.82535 -6.57068 -5.04669 -5.73792 -5.23789 -5.01624 C -5.52454 -3.93472 -5.68701 -3.30048 -5.68701 -2.8372 C -5.68701 -2.35409 -5.53301 -1.885 -5.27377 -1.44294 C -6.59176 -0.814515 -13.1606 2.64715 -17.9248 11.2169 C -18.5398 11.7414 -21.5318 14.109 -23.3946 15.5733 C -23.8553 15.9355 -23.9353 16.6027 -23.5731 17.0635 C -23.3638 17.3299 -23.0524 17.4689 -22.7381 17.4689 C -22.5085 17.4689 -22.2773 17.3949 -22.0829 17.2419 C -16.329 12.7187 -16.2836 12.636 -16.1484 12.3905 C -12.7212 6.15479 -8.19525 2.75469 -5.81882 1.2894 L -6.09532 2.62182 C -6.25842 3.40845 -6.37112 4.19975 -6.43447 4.99303 C -6.63957 5.8207 -7.95109 11.2654 -7.95109 15.2755 L -7.95109 28.8035 C -7.95109 30.0442 -6.94176 31.0534 -5.6958 31.0534 C -4.54097 31.0534 -3.57917 30.1874 -3.45818 29.0391 L -3.23488 26.9188 L -2.46904 31.3227 C -2.26779 32.4787 -1.27065 33.3177 -0.0974189 33.3177 C 1.07582 33.3177 2.07325 32.4787 2.27422 31.3229 L 3.04019 26.9189 L 3.26349 29.0391 C 3.38389 30.1876 4.34632 31.0536 5.50647 31.0536 C 6.74711 31.0536 7.75644 30.0442 7.75644 28.8036 L 7.75644 15.2757 C 7.75644 11.2658 6.4452 5.82155 6.23979 4.99331 C 6.17609 4.20003 6.06374 3.40873 5.90029 2.62196 L 5.62274 1.2836 C 7.99413 2.73998 12.5115 6.12819 15.9537 12.391 C 16.0888 12.6363 16.1339 12.719 21.888 17.2422 C 22.0826 17.395 22.3137 17.4692 22.5432 17.4692 C 22.8578 17.4692 23.1687 17.3302 23.3782 17.0637 C 23.7406 16.6029 23.6603 15.9355 23.1997 15.5733 Z M -0.0974189 -0.50221 C -1.23145 -0.50221 -3.5643 -2.07335 -3.5643 -2.83621 C -3.5608 -3.05937 -3.34415 -3.87585 -3.18616 -4.47201 C -2.94361 -5.38656 -2.65811 -6.46286 -2.51829 -7.43599 L 2.32336 -7.43599 C 2.46301 -6.46286 2.74857 -5.38656 2.99126 -4.47201 C 3.14946 -3.87585 3.36587 -3.0595 3.3694 -2.83706 C 3.36958 -2.07335 1.03665 -0.50221 -0.0973489 -0.50221 Z M -2.74316 -11.143 C -2.22485 -11.6614 -1.88748 -12.2843 -1.58991 -12.834 C -1.01925 -13.8877 -0.777679 -14.2284 -0.0976289 -14.2284 C 0.582456 -14.2284 0.824166 -13.8878 1.39474 -12.834 C 1.69259 -12.2843 2.02964 -11.6614 2.54799 -11.143 C 2.93554 -10.7554 3.14232 -10.3845 3.1299 -10.0984 C 3.1229 -9.90554 3.00985 -9.71847 2.8709 -9.55872 L -3.06667 -9.55872 C -3.20527 -9.71849 -3.31727 -9.90557 -3.32532 -10.0984 C -3.33582 -10.3844 -3.13072 -10.7553 -2.74341 -11.143 Z M -5.5692 28.8171 C -5.5762 28.882 -5.63045 28.931 -5.7015 28.931 C -5.7715 28.931 -5.8289 28.8738 -5.8289 28.8036 L -5.8289 15.2757 C -5.8289 14.5074 -5.7743 13.6716 -5.6868 12.8224 L -4.56484 19.2736 Z M 0.182861 30.9593 C 0.158361 31.0959 0.0411111 31.1951 -0.0974889 31.1951 C -0.236439 31.1951 -0.354039 31.0959 -0.377839 30.9592 L -4.12024 9.4401 C -4.36139 8.05221 -4.42929 6.65441 -4.32604 5.26327 C -4.32334 5.23737 -4.32254 5.21161 -4.32254 5.18602 C -4.26619 4.47255 -4.16574 3.76092 -4.01909 3.05339 L -3.46252 0.371859 C -2.71761 0.872219 -1.89235 1.25047 -1.1611 1.45324 L -1.1611 19.804 C -1.1611 20.3903 -0.685909 20.8653 -0.0997989 20.8653 C 0.486346 20.8653 0.961506 20.3903 0.961506 19.804 L 0.961506 1.4531 C 1.6928 1.25045 2.51806 0.872079 3.26293 0.371716 L 3.8195 3.05325 C 3.96615 3.76078 4.06695 4.47241 4.12295 5.18588 C 4.12407 5.21178 4.12617 5.2374 4.12645 5.26313 C 4.2297 6.65413 4.1618 8.05193 3.92065 9.43996 Z M 5.63355 28.8035 C 5.63355 28.8737 5.57615 28.9309 5.50055 28.9309 C 5.4351 28.9309 5.38085 28.8819 5.3742 28.8168 L 4.36967 19.2735 L 5.49166 12.8221 C 5.57951 13.6713 5.63376 14.5072 5.63376 15.2754 Z",4,"ngIf"],["d","M 26.2796 -9.91591 C 26.0694 -10.4424 25.4717 -10.6985 24.9452 -10.488 L 13.9952 -6.10798 C 13.8372 -6.04429 13.6972 -5.94331 13.588 -5.8123 L 8.42091 0.388326 L 4.52341 0.388326 L 8.59528 -4.49777 C 8.68702 -4.60766 8.75434 -4.73537 8.79361 -4.87289 L 13.1189 -20.0116 L 20.6616 -29.7097 C 21.0095 -30.1573 20.9295 -30.8021 20.4821 -31.1502 C 20.0347 -31.498 19.3896 -31.4175 19.0416 -30.9702 L 11.3767 -21.1152 C 11.2958 -21.0115 11.2364 -20.8935 11.1998 -20.7668 L 6.87935 -5.64532 L 3.30485 -1.35594 C 3.18605 -2.00651 2.8709 -2.58958 2.42256 -3.04056 L 3.25011 -4.69564 C 3.50388 -5.20275 3.29829 -5.81939 2.79124 -6.07303 C 2.28436 -6.3268 1.66762 -6.12088 1.41399 -5.6137 L 0.587006 -3.95974 C 0.441806 -3.97954 0.292976 -3.99472 0.142034 -3.99472 C -0.00910632 -3.99472 -0.157276 -3.98812 -0.302971 -3.95974 L -1.12991 -5.6137 C -1.38335 -6.12068 -2.00005 -6.32611 -2.50716 -6.07303 C -3.01427 -5.81926 -3.21983 -5.20292 -2.96599 -4.69564 L -2.13845 -3.04056 C -2.58676 -2.58938 -2.90151 -2.00667 -3.02074 -1.35594 L -6.5952 -5.64532 L -10.9158 -20.7666 C -10.9547 -20.8928 -11.0118 -21.0109 -11.0926 -21.1151 L -18.7576 -30.97 C -19.1055 -31.4177 -19.7506 -31.4983 -20.198 -31.15 C -20.6454 -30.802 -20.7262 -30.157 -20.3785 -29.7096 L -12.8358 -20.0115 L -8.51046 -4.87279 C -8.47152 -4.73518 -8.40354 -4.6078 -8.31213 -4.49768 L -4.24022 0.388425 L -8.13769 0.388425 L -13.3048 -5.81223 C -13.4137 -5.94324 -13.554 -6.04521 -13.7121 -6.10791 L -24.6622 -10.4879 C -25.1888 -10.6981 -25.7861 -10.4401 -25.9966 -9.91598 C -26.2072 -9.38953 -25.9488 -8.7922 -25.4248 -8.58156 L -14.7158 -4.29806 L -9.4072 2.07245 C -9.21217 2.30642 -8.92325 2.44211 -8.61853 2.44211 L -4.49492 2.44211 L -10.118 4.85187 C -10.2909 4.92612 -10.4398 5.04591 -10.5486 5.199 L -16.0236 12.8639 C -16.0985 12.9686 -16.153 13.0867 -16.1843 13.2114 L -17.2793 17.5914 C -17.4169 18.1415 -17.0823 18.6989 -16.5324 18.8364 C -16.4489 18.8562 -16.365 18.8714 -16.2825 18.8714 C -15.8228 18.8714 -15.4041 18.5596 -15.2875 18.0936 L -14.2397 13.9027 L -9.04496 6.63014 L -3.91861 4.43304 C -4.18822 4.70496 -4.4401 4.99859 -4.67127 5.31067 L -10.4723 11.6784 C -10.5927 11.811 -10.6762 11.9724 -10.7155 12.1472 L -12.9055 22.0021 C -12.9286 22.117 -12.9404 22.2354 -12.9253 22.3524 L -11.8303 31.1123 C -11.7653 31.6316 -11.3231 32.0116 -10.8129 32.0116 C -10.7697 32.0116 -10.7275 32.009 -10.6842 32.005 C -10.1217 31.9347 -9.72255 31.4215 -9.79287 30.8589 L -10.8659 22.2755 L -8.77373 12.8608 L -6.36268 10.2144 C -6.34288 13.6592 -3.66998 19.968 0.138371 19.968 C 3.94677 19.968 6.62264 13.6592 6.6395 10.2144 L 9.05055 12.8608 L 11.1426 22.2755 L 10.0697 30.8589 C 9.99943 31.4215 10.3981 31.9346 10.961 32.005 C 11.0042 32.0083 11.0468 32.0116 11.0897 32.0116 C 11.6 32.0116 12.0421 31.6318 12.1071 31.1123 L 13.2021 22.3524 C 13.2186 22.2352 13.2087 22.1171 13.1856 22.0021 L 10.9956 12.1472 C 10.9566 11.9726 10.8728 11.8106 10.7524 11.6784 L 4.95135 5.31067 C 4.72002 4.99849 4.46804 4.70499 4.19869 4.43304 L 9.32498 6.63014 L 14.5198 13.9027 L 15.5676 18.0936 C 15.6841 18.5601 16.1027 18.8714 16.5626 18.8714 C 16.6451 18.8714 16.729 18.8648 16.8124 18.8364 C 17.3625 18.6988 17.6969 18.1415 17.5594 17.5914 L 16.4644 13.2114 C 16.4294 13.0867 16.3789 12.9686 16.3037 12.8639 L 10.8287 5.199 C 10.7198 5.04621 10.5707 4.92609 10.3981 4.85187 L 4.77501 2.44211 L 8.89863 2.44211 C 9.20289 2.44211 9.49223 2.30681 9.68729 2.07245 L 14.9959 -4.29806 L 25.7048 -8.58156 C 26.2309 -8.7921 26.4871 -9.38969 26.2765 -9.91604 Z M 3.32851 6.55639 C 3.33511 6.56299 3.34831 6.57949 3.35491 6.59533 C 3.44038 6.71413 3.52189 6.83623 3.6001 6.9615 L -3.31728 6.9615 C -3.2394 6.83643 -3.15723 6.71433 -3.07209 6.59533 C -3.06549 6.58873 -3.05229 6.57223 -3.04569 6.55639 C -2.22788 5.4365 -1.08892 4.63183 0.141308 4.63183 C 1.37151 4.63183 2.51044 5.43634 3.32825 6.55639 Z M -4.30682 10.1751 C -4.30682 9.7961 -4.25897 9.40383 -4.16987 9.01166 L 4.45319 9.01166 C 4.54229 9.4036 4.59014 9.79583 4.59014 10.1751 C 4.59014 10.5284 4.5512 10.9222 4.47728 11.3385 L -4.19435 11.3385 C -4.26695 10.9222 -4.30655 10.5285 -4.30655 10.1751 Z M 1.30499 -0.774814 L 1.30499 2.50003 L 1.30499 2.50663 L 1.30499 2.71651 C 0.928325 2.62543 0.540278 2.57461 0.141572 2.57461 C -0.257068 2.57461 -0.645313 2.62543 -1.02187 2.71651 L -1.02187 2.50663 L -1.02187 2.50003 L -1.02187 -0.774814 C -1.02187 -1.4163 -0.499981 -1.93823 0.141572 -1.93823 C 0.783092 -1.93823 1.30499 -1.41623 1.30499 -0.774814 Z M 0.141572 17.9085 C -1.29768 17.9085 -2.79123 15.6796 -3.62943 13.3916 L 3.91268 13.3916 C 3.07435 15.6796 1.58077 17.9085 0.141572 17.9085 Z",4,"ngIf"],["d","M 21.8842 2.21077 L 18.0181 2.21077 L 13.0729 -0.756106 C 12.911 -0.853707 12.7271 -0.904573 12.5381 -0.904573 L 6.18206 -0.904573 C 6.26409 -1.2402 6.30742 -1.58751 6.30742 -1.94298 C 6.30742 -2.35345 6.24815 -2.75236 6.13972 -3.13557 L 10.6647 -4.04062 C 10.9348 -4.09355 11.1726 -4.25344 11.3252 -4.48199 L 15.2411 -10.3555 L 20.0108 -11.3098 C 20.2808 -11.3628 20.5186 -11.5227 20.6712 -11.7512 L 22.7482 -14.8665 C 23.067 -15.3442 22.9382 -15.9892 22.4605 -16.3069 C 21.9817 -16.6267 21.3378 -16.4959 21.0201 -16.0192 L 19.181 -13.2611 L 14.4113 -12.3067 C 14.1413 -12.2538 13.9035 -12.0939 13.7509 -11.8653 L 9.83492 -5.99184 L 5.07504 -5.03946 C 4.8146 -5.33056 4.51767 -5.59756 4.1913 -5.83727 C 6.07121 -6.88908 7.3457 -8.89921 7.3457 -11.2028 L 7.3457 -13.4521 C 7.3457 -13.6801 7.33217 -13.9049 7.30798 -14.1266 C 7.3256 -14.1905 7.33742 -14.257 7.34266 -14.3255 C 7.34788 -14.3889 7.864 -20.6352 11.4996 -20.6352 C 17.0843 -20.6352 17.7053 -29.5377 17.7282 -29.9168 C 17.7635 -30.489 17.3284 -30.9813 16.7572 -31.0175 C 16.1861 -31.057 15.6907 -30.6188 15.6554 -30.0456 C 15.6502 -29.9729 15.0967 -22.7121 11.4996 -22.7121 C 8.14265 -22.7121 6.5767 -19.8132 5.85813 -17.4544 C 5.37949 -18.0105 4.80424 -18.4808 4.15721 -18.8374 C 4.84539 -19.5678 5.26657 -20.5387 5.26462 -21.5875 C 5.28337 -21.8035 5.40896 -23.7278 4.30508 -24.9262 C 3.76306 -25.516 3.01841 -25.8275 2.15341 -25.8275 C 1.57915 -25.8275 1.11501 -25.3623 1.11501 -24.7892 C 1.11501 -24.216 1.57915 -23.7508 2.15341 -23.7508 C 2.51691 -23.7508 2.67681 -23.6282 2.77551 -23.5223 C 3.19194 -23.0727 3.21786 -22.0716 3.19194 -21.6739 C 3.19194 -20.5286 2.2605 -19.597 1.11501 -19.597 L -0.96193 -19.597 C -2.1073 -19.597 -3.03886 -20.5284 -3.043 -21.7601 C -3.07306 -22.135 -3.01185 -23.0986 -2.6245 -23.5203 C -2.52581 -23.6272 -2.3659 -23.7508 -2.00034 -23.7508 C -1.42607 -23.7508 -0.96193 -24.216 -0.96193 -24.7892 C -0.96193 -25.3623 -1.42607 -25.8275 -2.00034 -25.8275 C -2.86533 -25.8275 -3.60997 -25.516 -4.15199 -24.9262 C -5.25588 -23.7279 -5.13015 -21.8035 -5.11569 -21.6738 C -5.11569 -20.5799 -4.69026 -19.5842 -3.99683 -18.8416 C -4.6468 -18.4846 -5.22446 -18.0128 -5.70491 -17.4546 C -6.42352 -19.8137 -7.98933 -22.7127 -11.3464 -22.7127 C -14.9311 -22.7127 -15.4971 -29.9735 -15.5022 -30.0462 C -15.5386 -30.6193 -16.0442 -31.0587 -16.605 -31.0172 C -17.1761 -30.9808 -17.6102 -30.4887 -17.5749 -29.9164 C -17.552 -29.5374 -16.931 -20.6359 -11.3463 -20.6359 C -7.72626 -20.6359 -7.19456 -14.3876 -7.18935 -14.3253 C -7.18397 -14.257 -7.17219 -14.1909 -7.15466 -14.1274 C -7.17899 -13.9057 -7.19248 -13.6806 -7.19248 -13.4525 L -7.19248 -11.2032 C -7.19248 -8.8997 -5.91799 -6.88944 -4.03808 -5.83763 C -4.36448 -5.59792 -4.66142 -5.33105 -4.92182 -5.03983 L -9.68174 -5.99221 L -13.5977 -11.8657 C -13.7503 -12.0941 -13.9881 -12.254 -14.2581 -12.3071 L -19.0278 -13.2614 L -20.8669 -16.0196 C -21.1846 -16.4963 -21.8295 -16.6271 -22.3073 -16.3073 C -22.7849 -15.9895 -22.9138 -15.3447 -22.5949 -14.8669 L -20.518 -11.7516 C -20.3654 -11.5231 -20.1275 -11.3633 -19.8576 -11.3102 L -15.0879 -10.3559 L -11.172 -4.48236 C -11.0194 -4.25393 -10.7816 -4.09401 -10.5116 -4.04098 L -5.98653 -3.13594 C -6.09507 -2.75272 -6.1542 -2.35382 -6.1542 -1.94335 C -6.1542 -1.58776 -6.11087 -1.24057 -6.02887 -0.904939 L -12.3849 -0.904939 C -12.5739 -0.904939 -12.7576 -0.85407 -12.9197 -0.756472 L -17.8648 2.21041 L -21.7311 2.21041 C -22.3053 2.21041 -22.7695 2.67564 -22.7695 3.24881 C -22.7695 3.82199 -22.3053 4.28723 -21.7311 4.28723 L -17.5773 4.28723 C -17.3883 4.28723 -17.2045 4.23634 -17.0425 4.13876 L -12.0973 1.17188 L -5.11579 1.17188 C -5.04949 1.17188 -4.98475 1.16506 -4.92182 1.15314 C -4.41144 1.72375 -3.76306 2.20335 -3.01939 2.55979 C -3.67679 3.29481 -4.07738 4.26409 -4.07738 5.32574 L -4.07738 5.72187 L -13.8876 10.627 C -14.1752 10.7713 -14.3787 11.0381 -14.441 11.3529 L -17.495 26.6212 L -20.3882 29.5143 C -20.7943 29.9204 -20.7943 30.5767 -20.3882 30.9827 C -20.1857 31.1852 -19.9198 31.2869 -19.654 31.2869 C -19.3881 31.2869 -19.1223 31.1852 -18.9198 30.9827 L -15.8045 27.8673 C -15.6591 27.7219 -15.5614 27.5381 -15.5209 27.3366 L -12.5043 12.2584 L -4.07728 8.04487 L -4.07728 8.44097 C -4.07728 9.47136 -3.69953 10.4145 -3.07635 11.1411 C -6.09774 12.3855 -8.23116 15.3606 -8.23116 18.8254 L -8.23116 22.9792 C -8.23116 27.5598 -4.50417 31.2868 0.0764775 31.2868 C 4.65712 31.2868 8.38411 27.5598 8.38411 22.9792 L 8.38411 18.8254 C 8.38411 15.3604 6.25083 12.3854 3.2293 11.1411 C 3.85249 10.4145 4.23024 9.47136 4.23024 8.44097 L 4.23024 8.04487 L 12.6572 12.2584 L 15.6739 27.3366 C 15.7144 27.538 15.812 27.7219 15.9574 27.8673 L 19.0728 30.9827 C 19.2753 31.1852 19.5412 31.2869 19.807 31.2869 C 20.0728 31.2869 20.3386 31.1852 20.5411 30.9827 C 20.9471 30.5767 20.9471 29.9203 20.5411 29.5143 L 17.648 26.6212 L 14.5939 11.3529 C 14.5315 11.0381 14.328 10.7713 14.0404 10.627 L 4.23024 5.72187 L 4.23024 5.32574 C 4.23024 4.26409 3.82962 3.29481 3.17223 2.55979 C 3.91601 2.20335 4.56426 1.72388 5.07464 1.15314 C 5.13757 1.16506 5.20219 1.17188 5.26865 1.17188 L 12.2502 1.17188 L 17.1953 4.13876 C 17.3573 4.23634 17.5411 4.28723 17.7301 4.28723 L 21.8839 4.28723 C 22.4581 4.28723 22.9223 3.82199 22.9223 3.24881 C 22.9223 2.67564 22.4585 2.21077 21.8842 2.21077 Z M -1.04894 -7.13526 C -3.29089 -7.13526 -5.11556 -8.9598 -5.11556 -11.2028 L -5.11556 -13.4521 C -5.11556 -15.6952 -3.29101 -17.5197 -1.04894 -17.5197 L 1.20238 -17.5197 C 3.44434 -17.5197 5.26901 -15.6952 5.26901 -13.4521 L 5.26901 -11.2028 C 5.26901 -8.9598 3.44444 -7.13526 1.20238 -7.13526 Z M 6.30752 18.8259 L 6.30752 22.9796 C 6.30752 26.4159 3.51308 29.2103 0.0768428 29.2103 C -3.3594 29.2103 -6.15384 26.4159 -6.15384 22.9796 L -6.15384 18.8259 C -6.15384 15.3896 -3.3594 12.5952 0.0768428 12.5952 C 3.51308 12.5952 6.30752 15.3896 6.30752 18.8259 Z M 2.15366 5.3261 L 2.15366 6.39593 L 2.15366 6.39956 L 2.15366 8.44147 C 2.15366 9.58683 1.22222 10.5184 0.076721 10.5184 C -1.06878 10.5184 -2.00022 9.58696 -2.00022 8.44147 L -2.00022 6.39956 L -2.00022 6.39593 L -2.00022 5.3261 C -2.00022 4.18074 -1.06878 3.24918 0.076721 3.24918 C 1.22222 3.24918 2.15366 4.18074 2.15366 5.3261 Z M 0.0768428 1.17236 C -2.21403 1.17236 -4.07692 -0.225404 -4.07692 -1.94298 C -4.07692 -3.66056 -2.21391 -5.05834 0.0768428 -5.05834 C 2.36759 -5.05834 4.2306 -3.66056 4.2306 -1.94298 C 4.2306 -0.225404 2.36759 1.17236 0.0768428 1.17236 Z",4,"ngIf"],["d","M 15.3841 1.25408 C 22.8728 -1.82428 29.9895 -8.66692 29.9895 -11.9438 C 29.9895 -12.8799 29.4656 -13.6136 28.5873 -13.906 C 27.8046 -14.1664 24.6195 -14.3188 14.4763 -7.04548 C 14.3844 -7.97908 13.9844 -8.82172 13.3836 -9.47812 C 13.4167 -9.58096 13.4394 -9.6886 13.4394 -9.80284 C 13.4394 -13.1571 9.49688 -15.9237 3.91664 -16.864 C 3.97556 -18.4007 4.88768 -22.8456 12.8845 -26.8437 C 13.4073 -27.1052 13.6191 -27.7406 13.3578 -28.2634 C 13.0953 -28.7862 12.4609 -28.9971 11.938 -28.7367 C 3.34424 -24.4397 1.97336 -19.361 1.81856 -17.1244 C 1.12448 -17.1802 0.41168 -17.2094 -0.31564 -17.2094 C -1.40548 -17.2094 -2.46052 -17.1422 -3.47128 -17.0189 C -3.59032 -19.1981 -4.86616 -24.371 -13.5975 -28.7366 C -14.1203 -28.997 -14.7548 -28.7861 -15.0172 -28.2633 C -15.2787 -27.7404 -15.0668 -27.1049 -14.5439 -26.8436 C -6.16912 -22.6568 -5.56468 -17.9801 -5.57296 -16.6665 C -10.6046 -15.5753 -14.0706 -12.9474 -14.0706 -9.8026 C -14.0706 -9.68836 -14.048 -9.58072 -14.0146 -9.47788 C -14.6715 -8.76052 -15.0833 -7.81948 -15.121 -6.78208 C -25.5504 -14.3201 -28.8038 -14.17 -29.5978 -13.9058 C -30.4761 -13.6134 -31 -12.8799 -31 -11.9438 C -31 -8.63464 -23.7414 -1.68868 -16.1718 1.3442 C -23.7414 4.3772 -31 11.3233 -31 14.6323 C -31 15.5684 -30.4761 16.3021 -29.5968 16.5955 C -29.4222 16.6533 -29.1701 16.7371 -28.7516 16.7371 C -27.2727 16.7371 -23.7153 15.6854 -14.1678 8.74748 C -13.8431 9.143 -13.5125 9.47624 -13.0664 9.73316 C -12.821 16.1545 -7.58992 21.3656 -1.50604 21.892 L -1.50604 27.23 C -1.50604 27.8149 -1.03276 28.288 -0.448 28.288 C 0.13688 28.288 0.61004 27.8148 0.61004 27.23 L 0.61004 21.892 C 6.95852 21.3656 12.0572 16.1545 12.3026 9.73316 C 12.7614 9.46892 13.1995 9.12296 13.5294 8.71304 C 23.1112 15.6825 26.6942 16.738 28.1769 16.738 C 28.5964 16.738 28.8579 16.6533 29.0335 16.5944 C 29.9118 16.302 30.4398 15.5684 30.4398 14.6322 C 30.44 11.2893 23.0366 4.23644 15.3841 1.25408 Z M -28.8921 -11.9096 C -27.3192 -12.3306 -20.102 -7.90708 -13.9077 -3.24676 C -14.6109 -2.53432 -15.059 -1.57444 -15.1169 -0.51196 C -23.053 -3.54004 -29.0001 -10.3224 -28.8921 -11.9096 Z M -15.1288 6.06848 C -15.1288 6.31232 -15.1035 6.55004 -15.0636 6.78248 C -22.932 12.527 -27.6682 14.8687 -28.8932 14.593 C -28.9924 12.9306 -22.5395 5.64788 -14.1152 2.8394 C -14.0278 2.81048 -13.9496 2.76812 -13.8756 2.72 C -13.8144 2.78096 -13.7488 2.837 -13.6838 2.89412 C -14.5674 3.67016 -15.1288 4.80368 -15.1288 6.06848 Z M 27.8827 -11.9055 C 27.9772 -10.3347 22.2198 -3.74764 14.4784 -0.65668 C 14.3818 -1.74316 13.8714 -2.71012 13.1071 -3.40516 C 19.2103 -7.978 26.2028 -12.271 27.8827 -11.9055 Z M -0.31564 -15.0932 C 5.65928 -15.0932 10.0551 -12.9976 11.0895 -10.7981 C 10.8201 -10.8519 10.5422 -10.9012 10.257 -10.9012 L -10.8881 -10.9012 C -11.1731 -10.9012 -11.4513 -10.8519 -11.7207 -10.7981 C -10.6866 -12.9976 -6.29056 -15.0932 -0.31564 -15.0932 Z M -0.31564 19.7833 C -5.79256 19.7833 -10.3106 15.551 -10.8432 10.2606 L 10.2122 10.2606 C 9.67952 15.5509 5.16128 19.7833 -0.31564 19.7833 Z M 10.257 8.14436 L -10.8881 8.14436 C -12.0599 8.14436 -13.0126 7.1948 -13.0126 6.02816 C -13.0126 4.86152 -12.0599 3.91196 -10.8881 3.91196 L 10.257 3.91196 C 11.4286 3.91196 12.3813 4.86152 12.3813 6.02816 C 12.3813 7.1948 11.4286 8.14436 10.257 8.14436 Z M 10.257 1.79588 L -10.8881 1.79588 C -12.0599 1.79588 -13.0126 0.84632 -13.0126 -0.32032 C -13.0126 -1.48696 -12.0599 -2.43652 -10.8881 -2.43652 L 10.257 -2.43652 C 11.4286 -2.43652 12.3813 -1.48696 12.3813 -0.32032 C 12.3813 0.84632 11.4286 1.79588 10.257 1.79588 Z M 10.257 -4.5526 L -10.8881 -4.5526 C -12.0599 -4.5526 -13.0126 -5.50216 -13.0126 -6.6688 C -13.0126 -7.83544 -12.0599 -8.785 -10.8881 -8.785 L 10.257 -8.785 C 11.4286 -8.785 12.3813 -7.83544 12.3813 -6.6688 C 12.3813 -5.50216 11.4286 -4.5526 10.257 -4.5526 Z M 28.3363 14.5982 C 27.2038 14.8942 22.4127 12.5611 14.4402 6.73292 C 14.4745 6.51596 14.4975 6.29504 14.4975 6.06848 C 14.4975 4.8038 13.9364 3.67028 13.0527 2.89424 C 13.1287 2.82764 13.2044 2.7602 13.2751 2.68832 C 13.3609 2.75036 13.4539 2.80436 13.5592 2.8394 C 21.9908 5.651 28.4488 12.945 28.3363 14.5982 Z"],["d","M 27.079 1.30667 L 15.7412 -4.79822 L 15.7412 -7.89145 C 15.7412 -8.39311 15.335 -8.80033 14.8324 -8.80033 L 12.1056 -8.80033 L 12.1056 -9.70918 C 12.1056 -10.4088 12.0442 -11.0941 11.927 -11.7605 L 17.9173 -14.3278 C 18.2517 -14.4705 18.4681 -14.7995 18.4681 -15.1622 L 18.4681 -25.1602 L 23.9215 -25.1602 C 24.4242 -25.1602 24.8304 -25.5674 24.8304 -26.0691 C 24.8304 -26.5718 24.4242 -26.978 23.9215 -26.978 L 17.5592 -26.978 C 17.0566 -26.978 16.6503 -26.5718 16.6503 -26.0691 L 16.6503 -15.7621 L 11.4679 -13.5404 C 10.6322 -15.9716 9.02444 -18.0467 6.93872 -19.4717 C 7.86471 -20.1312 8.47025 -21.2128 8.47025 -22.4339 C 8.47025 -24.439 6.83966 -26.0695 4.83465 -26.0695 C 4.33202 -26.0695 3.92577 -25.6623 3.92577 -25.1607 C 3.92577 -24.659 4.33202 -24.2518 4.83465 -24.2518 C 5.83716 -24.2518 6.65252 -23.4366 6.65252 -22.4339 C 6.65252 -21.4314 5.83726 -20.6161 4.83465 -20.6161 L 4.83336 -20.616 C 3.43401 -21.2012 1.89916 -21.525 0.290076 -21.525 C -1.31901 -21.525 -2.85386 -21.2012 -4.25324 -20.616 L -4.2545 -20.6161 C -5.257 -20.6161 -6.07236 -21.4313 -6.07236 -22.4339 C -6.07236 -23.4365 -5.25711 -24.2518 -4.2545 -24.2518 C -3.75186 -24.2518 -3.34563 -24.659 -3.34563 -25.1607 C -3.34563 -25.6623 -3.75186 -26.0695 -4.2545 -26.0695 C -6.25961 -26.0695 -7.89009 -24.4389 -7.89009 -22.4339 C -7.89009 -21.2127 -7.28459 -20.1312 -6.35856 -19.4717 C -8.44428 -18.0467 -10.0521 -15.9716 -10.8877 -13.5404 L -16.0702 -15.7621 L -16.0702 -26.0691 C -16.0702 -26.5718 -16.4764 -26.978 -16.979 -26.978 L -23.3419 -26.978 C -23.8445 -26.978 -24.2508 -26.5718 -24.2508 -26.0691 C -24.2508 -25.5674 -23.8445 -25.1602 -23.3419 -25.1602 L -17.8884 -25.1602 L -17.8884 -15.1622 C -17.8884 -14.7995 -17.6721 -14.4705 -17.3377 -14.3278 L -11.3474 -11.7605 C -11.4646 -11.0941 -11.526 -10.4086 -11.526 -9.70917 L -11.526 -8.80033 L -14.2527 -8.80033 C -14.7554 -8.80033 -15.1616 -8.3931 -15.1616 -7.89145 L -15.1616 -4.79822 L -26.4994 1.30667 C -26.9411 1.54388 -27.1074 2.09561 -26.8693 2.53732 C -26.7047 2.84269 -26.3912 3.01546 -26.0677 3.01546 C -25.9223 3.01546 -25.775 2.98095 -25.6378 2.90639 L -15.1617 -2.73463 L -15.1617 5.31601 L -20.2889 9.58867 C -20.6025 9.85047 -20.7034 10.2904 -20.5334 10.663 L -16.1815 20.2374 L -19.5862 26.1962 C -19.8362 26.6316 -19.6845 27.1869 -19.2482 27.4359 C -19.1064 27.5177 -18.951 27.5559 -18.7983 27.5559 C -18.4819 27.5559 -18.1757 27.3913 -18.0085 27.0978 L -14.3729 20.7354 C -14.2283 20.4818 -14.2138 20.1747 -14.3347 19.9084 L -18.5921 10.5411 L -15.1618 7.68295 L -15.1618 8.46881 C -15.1618 16.989 -8.23053 23.9203 0.28965 23.9203 C 8.80982 23.9203 15.7411 16.989 15.7411 8.46881 L 15.7411 7.68295 L 19.1714 10.5411 L 14.9141 19.9084 C 14.7932 20.1747 14.8078 20.4819 14.9522 20.7354 L 18.5878 27.0978 C 18.755 27.3913 19.0614 27.5559 19.3776 27.5559 C 19.5303 27.5559 19.6857 27.5177 19.8275 27.4359 C 20.2638 27.1869 20.4155 26.6316 20.1656 26.1962 L 16.7608 20.2374 L 21.1127 10.663 C 21.2827 10.2903 21.1817 9.85037 20.8681 9.58867 L 15.741 5.31601 L 15.741 -2.73463 L 26.2171 2.90639 C 26.3544 2.98095 26.5016 3.01546 26.647 3.01546 C 26.9705 3.01546 27.2841 2.8428 27.4486 2.53732 C 27.687 2.09561 27.5207 1.54398 27.079 1.30667 Z M -9.70827 -9.70928 C -9.70827 -15.2218 -5.22281 -19.7073 0.289757 -19.7073 C 5.80234 -19.7073 10.2878 -15.2219 10.2878 -9.70928 L 10.2878 -8.80044 L -9.70827 -8.80044 Z M -10.6171 -6.98257 L 11.1966 -6.98257 L 13.9234 -6.98257 L 13.9234 -4.26531 C 13.9233 -4.25796 13.9233 -4.25065 13.9234 -4.24316 L 13.9234 -3.87835 L 0.289757 3.79022 L -13.3439 -3.87835 L -13.3439 -4.24316 C -13.3438 -4.25051 -13.3438 -4.25786 -13.3439 -4.26531 L -13.3439 -6.98257 Z M -13.3439 8.46892 L -13.3439 5.74091 L -13.3439 5.73461 L -13.3439 -1.79295 L -0.619115 5.36501 L -0.619115 22.0715 C -7.71446 21.6021 -13.3439 15.681 -13.3439 8.46892 Z M 1.19863 22.0715 L 1.19863 5.36501 L 13.9234 -1.79295 L 13.9234 5.73471 L 13.9234 5.7408 L 13.9234 8.46902 C 13.9234 15.681 8.29409 21.6021 1.19863 22.0715 Z"],["d","M 23.1993 15.5733 C 21.3366 14.109 18.3446 11.7414 17.7296 11.2169 C 12.9652 2.64827 6.39655 -0.814228 5.07856 -1.44294 C 5.33756 -1.88486 5.4918 -2.35409 5.4918 -2.83719 C 5.4918 -3.30048 5.3294 -3.93486 5.04265 -5.01624 C 4.8512 -5.73792 4.63024 -6.57068 4.49294 -7.31486 C 4.59374 -7.31187 4.69419 -7.30891 4.79464 -7.30891 C 8.94543 -7.30891 12.7535 -9.75455 12.9341 -9.87229 C 13.1714 -10.0271 13.3373 -10.2703 13.3943 -10.5478 C 13.451 -10.8255 13.3949 -11.1144 13.2379 -11.3502 L 11.5052 -13.9494 C 13.7039 -15.6498 16.0931 -16.5487 16.1187 -16.5583 C 16.6686 -16.7613 16.9498 -17.3717 16.7467 -17.9216 C 16.5433 -18.4713 15.9332 -18.7522 15.3835 -18.5494 C 15.2491 -18.4996 12.0538 -17.304 9.38881 -14.9538 C 8.99075 -14.6026 8.91323 -14.0109 9.20786 -13.5691 L 10.8409 -11.1198 C 9.64329 -10.4953 7.44869 -9.53254 5.16354 -9.43858 C 5.21814 -9.64602 5.24334 -9.83818 5.25069 -10.0066 C 5.28989 -10.9199 4.88588 -11.8072 4.04914 -12.6442 C 3.74954 -12.9441 3.51227 -13.3816 3.26136 -13.8449 C 2.98206 -14.3609 2.65176 -14.9693 2.15511 -15.4578 C 2.8653 -18.087 7.91209 -26.8789 12.9465 -30.2572 C 13.4331 -30.5838 13.5628 -31.2431 13.2359 -31.7297 C 12.909 -32.2165 12.2501 -32.3464 11.7633 -32.0197 C 6.51594 -28.4984 1.39127 -19.8963 0.213976 -16.338 C 0.113176 -16.3457 0.00992607 -16.351 -0.0975239 -16.351 C -0.204974 -16.351 -0.308574 -16.3457 -0.409374 -16.338 C -1.58669 -19.8963 -6.71146 -28.4984 -11.9586 -32.0197 C -12.4453 -32.3465 -13.1048 -32.2168 -13.4313 -31.7297 C -13.7575 -31.2431 -13.6283 -30.5836 -13.1415 -30.2572 C -8.10712 -26.8789 -3.0603 -18.087 -2.35008 -15.4578 C -2.8469 -14.9693 -3.17709 -14.3609 -3.45639 -13.8449 C -3.70734 -13.3816 -3.94429 -12.9441 -4.24417 -12.6442 C -5.08116 -11.8072 -5.48531 -10.9199 -5.44569 -10.0066 C -5.43869 -9.83861 -5.41034 -9.64675 -5.35889 -9.43985 C -7.63784 -9.53621 -9.83525 -10.4982 -11.0349 -11.1215 L -9.4031 -13.5691 C -9.1084 -14.0109 -9.18575 -14.6025 -9.58405 -14.9538 C -12.249 -17.304 -15.4439 -18.4998 -15.5787 -18.5494 C -16.1283 -18.7529 -16.7389 -18.4714 -16.9419 -17.9216 C -17.1453 -17.3717 -16.8639 -16.7614 -16.3139 -16.5583 C -16.2894 -16.5485 -13.9065 -15.6578 -11.7003 -13.9495 L -13.4331 -11.3502 C -13.5903 -11.1144 -13.6466 -10.8255 -13.5896 -10.5478 C -13.5325 -10.2702 -13.3666 -10.027 -13.1294 -9.87229 C -12.9485 -9.75455 -9.14095 -7.30891 -4.98985 -7.30891 C -4.8894 -7.30891 -4.7886 -7.31201 -4.68815 -7.31486 C -4.82535 -6.57068 -5.04669 -5.73792 -5.23789 -5.01624 C -5.52454 -3.93472 -5.68701 -3.30048 -5.68701 -2.8372 C -5.68701 -2.35409 -5.53301 -1.885 -5.27377 -1.44294 C -6.59176 -0.814515 -13.1606 2.64715 -17.9248 11.2169 C -18.5398 11.7414 -21.5318 14.109 -23.3946 15.5733 C -23.8553 15.9355 -23.9353 16.6027 -23.5731 17.0635 C -23.3638 17.3299 -23.0524 17.4689 -22.7381 17.4689 C -22.5085 17.4689 -22.2773 17.3949 -22.0829 17.2419 C -16.329 12.7187 -16.2836 12.636 -16.1484 12.3905 C -12.7212 6.15479 -8.19525 2.75469 -5.81882 1.2894 L -6.09532 2.62182 C -6.25842 3.40845 -6.37112 4.19975 -6.43447 4.99303 C -6.63957 5.8207 -7.95109 11.2654 -7.95109 15.2755 L -7.95109 28.8035 C -7.95109 30.0442 -6.94176 31.0534 -5.6958 31.0534 C -4.54097 31.0534 -3.57917 30.1874 -3.45818 29.0391 L -3.23488 26.9188 L -2.46904 31.3227 C -2.26779 32.4787 -1.27065 33.3177 -0.0974189 33.3177 C 1.07582 33.3177 2.07325 32.4787 2.27422 31.3229 L 3.04019 26.9189 L 3.26349 29.0391 C 3.38389 30.1876 4.34632 31.0536 5.50647 31.0536 C 6.74711 31.0536 7.75644 30.0442 7.75644 28.8036 L 7.75644 15.2757 C 7.75644 11.2658 6.4452 5.82155 6.23979 4.99331 C 6.17609 4.20003 6.06374 3.40873 5.90029 2.62196 L 5.62274 1.2836 C 7.99413 2.73998 12.5115 6.12819 15.9537 12.391 C 16.0888 12.6363 16.1339 12.719 21.888 17.2422 C 22.0826 17.395 22.3137 17.4692 22.5432 17.4692 C 22.8578 17.4692 23.1687 17.3302 23.3782 17.0637 C 23.7406 16.6029 23.6603 15.9355 23.1997 15.5733 Z M -0.0974189 -0.50221 C -1.23145 -0.50221 -3.5643 -2.07335 -3.5643 -2.83621 C -3.5608 -3.05937 -3.34415 -3.87585 -3.18616 -4.47201 C -2.94361 -5.38656 -2.65811 -6.46286 -2.51829 -7.43599 L 2.32336 -7.43599 C 2.46301 -6.46286 2.74857 -5.38656 2.99126 -4.47201 C 3.14946 -3.87585 3.36587 -3.0595 3.3694 -2.83706 C 3.36958 -2.07335 1.03665 -0.50221 -0.0973489 -0.50221 Z M -2.74316 -11.143 C -2.22485 -11.6614 -1.88748 -12.2843 -1.58991 -12.834 C -1.01925 -13.8877 -0.777679 -14.2284 -0.0976289 -14.2284 C 0.582456 -14.2284 0.824166 -13.8878 1.39474 -12.834 C 1.69259 -12.2843 2.02964 -11.6614 2.54799 -11.143 C 2.93554 -10.7554 3.14232 -10.3845 3.1299 -10.0984 C 3.1229 -9.90554 3.00985 -9.71847 2.8709 -9.55872 L -3.06667 -9.55872 C -3.20527 -9.71849 -3.31727 -9.90557 -3.32532 -10.0984 C -3.33582 -10.3844 -3.13072 -10.7553 -2.74341 -11.143 Z M -5.5692 28.8171 C -5.5762 28.882 -5.63045 28.931 -5.7015 28.931 C -5.7715 28.931 -5.8289 28.8738 -5.8289 28.8036 L -5.8289 15.2757 C -5.8289 14.5074 -5.7743 13.6716 -5.6868 12.8224 L -4.56484 19.2736 Z M 0.182861 30.9593 C 0.158361 31.0959 0.0411111 31.1951 -0.0974889 31.1951 C -0.236439 31.1951 -0.354039 31.0959 -0.377839 30.9592 L -4.12024 9.4401 C -4.36139 8.05221 -4.42929 6.65441 -4.32604 5.26327 C -4.32334 5.23737 -4.32254 5.21161 -4.32254 5.18602 C -4.26619 4.47255 -4.16574 3.76092 -4.01909 3.05339 L -3.46252 0.371859 C -2.71761 0.872219 -1.89235 1.25047 -1.1611 1.45324 L -1.1611 19.804 C -1.1611 20.3903 -0.685909 20.8653 -0.0997989 20.8653 C 0.486346 20.8653 0.961506 20.3903 0.961506 19.804 L 0.961506 1.4531 C 1.6928 1.25045 2.51806 0.872079 3.26293 0.371716 L 3.8195 3.05325 C 3.96615 3.76078 4.06695 4.47241 4.12295 5.18588 C 4.12407 5.21178 4.12617 5.2374 4.12645 5.26313 C 4.2297 6.65413 4.1618 8.05193 3.92065 9.43996 Z M 5.63355 28.8035 C 5.63355 28.8737 5.57615 28.9309 5.50055 28.9309 C 5.4351 28.9309 5.38085 28.8819 5.3742 28.8168 L 4.36967 19.2735 L 5.49166 12.8221 C 5.57951 13.6713 5.63376 14.5072 5.63376 15.2754 Z"],["d","M 26.2796 -9.91591 C 26.0694 -10.4424 25.4717 -10.6985 24.9452 -10.488 L 13.9952 -6.10798 C 13.8372 -6.04429 13.6972 -5.94331 13.588 -5.8123 L 8.42091 0.388326 L 4.52341 0.388326 L 8.59528 -4.49777 C 8.68702 -4.60766 8.75434 -4.73537 8.79361 -4.87289 L 13.1189 -20.0116 L 20.6616 -29.7097 C 21.0095 -30.1573 20.9295 -30.8021 20.4821 -31.1502 C 20.0347 -31.498 19.3896 -31.4175 19.0416 -30.9702 L 11.3767 -21.1152 C 11.2958 -21.0115 11.2364 -20.8935 11.1998 -20.7668 L 6.87935 -5.64532 L 3.30485 -1.35594 C 3.18605 -2.00651 2.8709 -2.58958 2.42256 -3.04056 L 3.25011 -4.69564 C 3.50388 -5.20275 3.29829 -5.81939 2.79124 -6.07303 C 2.28436 -6.3268 1.66762 -6.12088 1.41399 -5.6137 L 0.587006 -3.95974 C 0.441806 -3.97954 0.292976 -3.99472 0.142034 -3.99472 C -0.00910632 -3.99472 -0.157276 -3.98812 -0.302971 -3.95974 L -1.12991 -5.6137 C -1.38335 -6.12068 -2.00005 -6.32611 -2.50716 -6.07303 C -3.01427 -5.81926 -3.21983 -5.20292 -2.96599 -4.69564 L -2.13845 -3.04056 C -2.58676 -2.58938 -2.90151 -2.00667 -3.02074 -1.35594 L -6.5952 -5.64532 L -10.9158 -20.7666 C -10.9547 -20.8928 -11.0118 -21.0109 -11.0926 -21.1151 L -18.7576 -30.97 C -19.1055 -31.4177 -19.7506 -31.4983 -20.198 -31.15 C -20.6454 -30.802 -20.7262 -30.157 -20.3785 -29.7096 L -12.8358 -20.0115 L -8.51046 -4.87279 C -8.47152 -4.73518 -8.40354 -4.6078 -8.31213 -4.49768 L -4.24022 0.388425 L -8.13769 0.388425 L -13.3048 -5.81223 C -13.4137 -5.94324 -13.554 -6.04521 -13.7121 -6.10791 L -24.6622 -10.4879 C -25.1888 -10.6981 -25.7861 -10.4401 -25.9966 -9.91598 C -26.2072 -9.38953 -25.9488 -8.7922 -25.4248 -8.58156 L -14.7158 -4.29806 L -9.4072 2.07245 C -9.21217 2.30642 -8.92325 2.44211 -8.61853 2.44211 L -4.49492 2.44211 L -10.118 4.85187 C -10.2909 4.92612 -10.4398 5.04591 -10.5486 5.199 L -16.0236 12.8639 C -16.0985 12.9686 -16.153 13.0867 -16.1843 13.2114 L -17.2793 17.5914 C -17.4169 18.1415 -17.0823 18.6989 -16.5324 18.8364 C -16.4489 18.8562 -16.365 18.8714 -16.2825 18.8714 C -15.8228 18.8714 -15.4041 18.5596 -15.2875 18.0936 L -14.2397 13.9027 L -9.04496 6.63014 L -3.91861 4.43304 C -4.18822 4.70496 -4.4401 4.99859 -4.67127 5.31067 L -10.4723 11.6784 C -10.5927 11.811 -10.6762 11.9724 -10.7155 12.1472 L -12.9055 22.0021 C -12.9286 22.117 -12.9404 22.2354 -12.9253 22.3524 L -11.8303 31.1123 C -11.7653 31.6316 -11.3231 32.0116 -10.8129 32.0116 C -10.7697 32.0116 -10.7275 32.009 -10.6842 32.005 C -10.1217 31.9347 -9.72255 31.4215 -9.79287 30.8589 L -10.8659 22.2755 L -8.77373 12.8608 L -6.36268 10.2144 C -6.34288 13.6592 -3.66998 19.968 0.138371 19.968 C 3.94677 19.968 6.62264 13.6592 6.6395 10.2144 L 9.05055 12.8608 L 11.1426 22.2755 L 10.0697 30.8589 C 9.99943 31.4215 10.3981 31.9346 10.961 32.005 C 11.0042 32.0083 11.0468 32.0116 11.0897 32.0116 C 11.6 32.0116 12.0421 31.6318 12.1071 31.1123 L 13.2021 22.3524 C 13.2186 22.2352 13.2087 22.1171 13.1856 22.0021 L 10.9956 12.1472 C 10.9566 11.9726 10.8728 11.8106 10.7524 11.6784 L 4.95135 5.31067 C 4.72002 4.99849 4.46804 4.70499 4.19869 4.43304 L 9.32498 6.63014 L 14.5198 13.9027 L 15.5676 18.0936 C 15.6841 18.5601 16.1027 18.8714 16.5626 18.8714 C 16.6451 18.8714 16.729 18.8648 16.8124 18.8364 C 17.3625 18.6988 17.6969 18.1415 17.5594 17.5914 L 16.4644 13.2114 C 16.4294 13.0867 16.3789 12.9686 16.3037 12.8639 L 10.8287 5.199 C 10.7198 5.04621 10.5707 4.92609 10.3981 4.85187 L 4.77501 2.44211 L 8.89863 2.44211 C 9.20289 2.44211 9.49223 2.30681 9.68729 2.07245 L 14.9959 -4.29806 L 25.7048 -8.58156 C 26.2309 -8.7921 26.4871 -9.38969 26.2765 -9.91604 Z M 3.32851 6.55639 C 3.33511 6.56299 3.34831 6.57949 3.35491 6.59533 C 3.44038 6.71413 3.52189 6.83623 3.6001 6.9615 L -3.31728 6.9615 C -3.2394 6.83643 -3.15723 6.71433 -3.07209 6.59533 C -3.06549 6.58873 -3.05229 6.57223 -3.04569 6.55639 C -2.22788 5.4365 -1.08892 4.63183 0.141308 4.63183 C 1.37151 4.63183 2.51044 5.43634 3.32825 6.55639 Z M -4.30682 10.1751 C -4.30682 9.7961 -4.25897 9.40383 -4.16987 9.01166 L 4.45319 9.01166 C 4.54229 9.4036 4.59014 9.79583 4.59014 10.1751 C 4.59014 10.5284 4.5512 10.9222 4.47728 11.3385 L -4.19435 11.3385 C -4.26695 10.9222 -4.30655 10.5285 -4.30655 10.1751 Z M 1.30499 -0.774814 L 1.30499 2.50003 L 1.30499 2.50663 L 1.30499 2.71651 C 0.928325 2.62543 0.540278 2.57461 0.141572 2.57461 C -0.257068 2.57461 -0.645313 2.62543 -1.02187 2.71651 L -1.02187 2.50663 L -1.02187 2.50003 L -1.02187 -0.774814 C -1.02187 -1.4163 -0.499981 -1.93823 0.141572 -1.93823 C 0.783092 -1.93823 1.30499 -1.41623 1.30499 -0.774814 Z M 0.141572 17.9085 C -1.29768 17.9085 -2.79123 15.6796 -3.62943 13.3916 L 3.91268 13.3916 C 3.07435 15.6796 1.58077 17.9085 0.141572 17.9085 Z"],["d","M 21.8842 2.21077 L 18.0181 2.21077 L 13.0729 -0.756106 C 12.911 -0.853707 12.7271 -0.904573 12.5381 -0.904573 L 6.18206 -0.904573 C 6.26409 -1.2402 6.30742 -1.58751 6.30742 -1.94298 C 6.30742 -2.35345 6.24815 -2.75236 6.13972 -3.13557 L 10.6647 -4.04062 C 10.9348 -4.09355 11.1726 -4.25344 11.3252 -4.48199 L 15.2411 -10.3555 L 20.0108 -11.3098 C 20.2808 -11.3628 20.5186 -11.5227 20.6712 -11.7512 L 22.7482 -14.8665 C 23.067 -15.3442 22.9382 -15.9892 22.4605 -16.3069 C 21.9817 -16.6267 21.3378 -16.4959 21.0201 -16.0192 L 19.181 -13.2611 L 14.4113 -12.3067 C 14.1413 -12.2538 13.9035 -12.0939 13.7509 -11.8653 L 9.83492 -5.99184 L 5.07504 -5.03946 C 4.8146 -5.33056 4.51767 -5.59756 4.1913 -5.83727 C 6.07121 -6.88908 7.3457 -8.89921 7.3457 -11.2028 L 7.3457 -13.4521 C 7.3457 -13.6801 7.33217 -13.9049 7.30798 -14.1266 C 7.3256 -14.1905 7.33742 -14.257 7.34266 -14.3255 C 7.34788 -14.3889 7.864 -20.6352 11.4996 -20.6352 C 17.0843 -20.6352 17.7053 -29.5377 17.7282 -29.9168 C 17.7635 -30.489 17.3284 -30.9813 16.7572 -31.0175 C 16.1861 -31.057 15.6907 -30.6188 15.6554 -30.0456 C 15.6502 -29.9729 15.0967 -22.7121 11.4996 -22.7121 C 8.14265 -22.7121 6.5767 -19.8132 5.85813 -17.4544 C 5.37949 -18.0105 4.80424 -18.4808 4.15721 -18.8374 C 4.84539 -19.5678 5.26657 -20.5387 5.26462 -21.5875 C 5.28337 -21.8035 5.40896 -23.7278 4.30508 -24.9262 C 3.76306 -25.516 3.01841 -25.8275 2.15341 -25.8275 C 1.57915 -25.8275 1.11501 -25.3623 1.11501 -24.7892 C 1.11501 -24.216 1.57915 -23.7508 2.15341 -23.7508 C 2.51691 -23.7508 2.67681 -23.6282 2.77551 -23.5223 C 3.19194 -23.0727 3.21786 -22.0716 3.19194 -21.6739 C 3.19194 -20.5286 2.2605 -19.597 1.11501 -19.597 L -0.96193 -19.597 C -2.1073 -19.597 -3.03886 -20.5284 -3.043 -21.7601 C -3.07306 -22.135 -3.01185 -23.0986 -2.6245 -23.5203 C -2.52581 -23.6272 -2.3659 -23.7508 -2.00034 -23.7508 C -1.42607 -23.7508 -0.96193 -24.216 -0.96193 -24.7892 C -0.96193 -25.3623 -1.42607 -25.8275 -2.00034 -25.8275 C -2.86533 -25.8275 -3.60997 -25.516 -4.15199 -24.9262 C -5.25588 -23.7279 -5.13015 -21.8035 -5.11569 -21.6738 C -5.11569 -20.5799 -4.69026 -19.5842 -3.99683 -18.8416 C -4.6468 -18.4846 -5.22446 -18.0128 -5.70491 -17.4546 C -6.42352 -19.8137 -7.98933 -22.7127 -11.3464 -22.7127 C -14.9311 -22.7127 -15.4971 -29.9735 -15.5022 -30.0462 C -15.5386 -30.6193 -16.0442 -31.0587 -16.605 -31.0172 C -17.1761 -30.9808 -17.6102 -30.4887 -17.5749 -29.9164 C -17.552 -29.5374 -16.931 -20.6359 -11.3463 -20.6359 C -7.72626 -20.6359 -7.19456 -14.3876 -7.18935 -14.3253 C -7.18397 -14.257 -7.17219 -14.1909 -7.15466 -14.1274 C -7.17899 -13.9057 -7.19248 -13.6806 -7.19248 -13.4525 L -7.19248 -11.2032 C -7.19248 -8.8997 -5.91799 -6.88944 -4.03808 -5.83763 C -4.36448 -5.59792 -4.66142 -5.33105 -4.92182 -5.03983 L -9.68174 -5.99221 L -13.5977 -11.8657 C -13.7503 -12.0941 -13.9881 -12.254 -14.2581 -12.3071 L -19.0278 -13.2614 L -20.8669 -16.0196 C -21.1846 -16.4963 -21.8295 -16.6271 -22.3073 -16.3073 C -22.7849 -15.9895 -22.9138 -15.3447 -22.5949 -14.8669 L -20.518 -11.7516 C -20.3654 -11.5231 -20.1275 -11.3633 -19.8576 -11.3102 L -15.0879 -10.3559 L -11.172 -4.48236 C -11.0194 -4.25393 -10.7816 -4.09401 -10.5116 -4.04098 L -5.98653 -3.13594 C -6.09507 -2.75272 -6.1542 -2.35382 -6.1542 -1.94335 C -6.1542 -1.58776 -6.11087 -1.24057 -6.02887 -0.904939 L -12.3849 -0.904939 C -12.5739 -0.904939 -12.7576 -0.85407 -12.9197 -0.756472 L -17.8648 2.21041 L -21.7311 2.21041 C -22.3053 2.21041 -22.7695 2.67564 -22.7695 3.24881 C -22.7695 3.82199 -22.3053 4.28723 -21.7311 4.28723 L -17.5773 4.28723 C -17.3883 4.28723 -17.2045 4.23634 -17.0425 4.13876 L -12.0973 1.17188 L -5.11579 1.17188 C -5.04949 1.17188 -4.98475 1.16506 -4.92182 1.15314 C -4.41144 1.72375 -3.76306 2.20335 -3.01939 2.55979 C -3.67679 3.29481 -4.07738 4.26409 -4.07738 5.32574 L -4.07738 5.72187 L -13.8876 10.627 C -14.1752 10.7713 -14.3787 11.0381 -14.441 11.3529 L -17.495 26.6212 L -20.3882 29.5143 C -20.7943 29.9204 -20.7943 30.5767 -20.3882 30.9827 C -20.1857 31.1852 -19.9198 31.2869 -19.654 31.2869 C -19.3881 31.2869 -19.1223 31.1852 -18.9198 30.9827 L -15.8045 27.8673 C -15.6591 27.7219 -15.5614 27.5381 -15.5209 27.3366 L -12.5043 12.2584 L -4.07728 8.04487 L -4.07728 8.44097 C -4.07728 9.47136 -3.69953 10.4145 -3.07635 11.1411 C -6.09774 12.3855 -8.23116 15.3606 -8.23116 18.8254 L -8.23116 22.9792 C -8.23116 27.5598 -4.50417 31.2868 0.0764775 31.2868 C 4.65712 31.2868 8.38411 27.5598 8.38411 22.9792 L 8.38411 18.8254 C 8.38411 15.3604 6.25083 12.3854 3.2293 11.1411 C 3.85249 10.4145 4.23024 9.47136 4.23024 8.44097 L 4.23024 8.04487 L 12.6572 12.2584 L 15.6739 27.3366 C 15.7144 27.538 15.812 27.7219 15.9574 27.8673 L 19.0728 30.9827 C 19.2753 31.1852 19.5412 31.2869 19.807 31.2869 C 20.0728 31.2869 20.3386 31.1852 20.5411 30.9827 C 20.9471 30.5767 20.9471 29.9203 20.5411 29.5143 L 17.648 26.6212 L 14.5939 11.3529 C 14.5315 11.0381 14.328 10.7713 14.0404 10.627 L 4.23024 5.72187 L 4.23024 5.32574 C 4.23024 4.26409 3.82962 3.29481 3.17223 2.55979 C 3.91601 2.20335 4.56426 1.72388 5.07464 1.15314 C 5.13757 1.16506 5.20219 1.17188 5.26865 1.17188 L 12.2502 1.17188 L 17.1953 4.13876 C 17.3573 4.23634 17.5411 4.28723 17.7301 4.28723 L 21.8839 4.28723 C 22.4581 4.28723 22.9223 3.82199 22.9223 3.24881 C 22.9223 2.67564 22.4585 2.21077 21.8842 2.21077 Z M -1.04894 -7.13526 C -3.29089 -7.13526 -5.11556 -8.9598 -5.11556 -11.2028 L -5.11556 -13.4521 C -5.11556 -15.6952 -3.29101 -17.5197 -1.04894 -17.5197 L 1.20238 -17.5197 C 3.44434 -17.5197 5.26901 -15.6952 5.26901 -13.4521 L 5.26901 -11.2028 C 5.26901 -8.9598 3.44444 -7.13526 1.20238 -7.13526 Z M 6.30752 18.8259 L 6.30752 22.9796 C 6.30752 26.4159 3.51308 29.2103 0.0768428 29.2103 C -3.3594 29.2103 -6.15384 26.4159 -6.15384 22.9796 L -6.15384 18.8259 C -6.15384 15.3896 -3.3594 12.5952 0.0768428 12.5952 C 3.51308 12.5952 6.30752 15.3896 6.30752 18.8259 Z M 2.15366 5.3261 L 2.15366 6.39593 L 2.15366 6.39956 L 2.15366 8.44147 C 2.15366 9.58683 1.22222 10.5184 0.076721 10.5184 C -1.06878 10.5184 -2.00022 9.58696 -2.00022 8.44147 L -2.00022 6.39956 L -2.00022 6.39593 L -2.00022 5.3261 C -2.00022 4.18074 -1.06878 3.24918 0.076721 3.24918 C 1.22222 3.24918 2.15366 4.18074 2.15366 5.3261 Z M 0.0768428 1.17236 C -2.21403 1.17236 -4.07692 -0.225404 -4.07692 -1.94298 C -4.07692 -3.66056 -2.21391 -5.05834 0.0768428 -5.05834 C 2.36759 -5.05834 4.2306 -3.66056 4.2306 -1.94298 C 4.2306 -0.225404 2.36759 1.17236 0.0768428 1.17236 Z"]],template:function(e,r){1&e&&(F(),O(0,"g"),X(1,"polygon",0)(2,"polygon",1)(3,"polygon",2)(4,"polygon",3),O(5,"g"),x(6,z6t,1,0,"path",4),x(7,V6t,1,0,"path",5),x(8,H6t,1,0,"path",6),x(9,F6t,1,0,"path",7),x(10,B6t,1,0,"path",8),A()()),2&e&&(z("transform",r.layerTransform),P(1),w("ngClass",r.pieceClass),z("points",r.isoPointsLight),P(1),w("ngClass",r.pieceClass),z("points",r.isoPointsDark),P(1),z("points",r.isoPointsStroke),P(1),w("ngClass",r.pieceClass),z("points",r.hexaPoints),P(1),z("transform","translate("+r.hexaCenter.x+" "+r.hexaCenter.y+")"),P(1),w("ngIf","QueenBee"===r.piece.kind),P(1),w("ngIf","Beetle"===r.piece.kind),P(1),w("ngIf","Grasshopper"===r.piece.kind),P(1),w("ngIf","Spider"===r.piece.kind),P(1),w("ngIf","SoldierAnt"===r.piece.kind))},dependencies:[fn,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();function U6t(n,t){if(1&n){const e=Oe();F(),O(0,"g")(1,"polygon",4),ee("click",function(){const i=ue(e).$implicit;return ce(C().selectSpace(i.x,i.y))}),A()()}if(2&n){const e=t.$implicit,r=C();P(1),De("id","space_",e.x,"_",e.y,""),w("ngClass",e.content.spaceClasses),z("points",r.getHexaPointsAtXY(e.x,e.y))}}function G6t(n,t){if(1&n){const e=Oe();F(),O(0,"polygon",6),ee("click",function(){ue(e);const s=C().$implicit;return ce(C().selectSpace(s.x,s.y))}),A()}if(2&n){const e=C().$implicit,r=C();De("id","stroke_",e.x,"_",e.y,""),w("ngClass",e.content.strokeClasses),z("points",r.getHexaPointsAtXY(e.x,e.y))}}function W6t(n,t){if(1&n&&(F(),O(0,"g"),x(1,G6t,1,4,"polygon",5),A()),2&n){const e=t.$implicit;P(1),w("ngIf",e.content.strokeClasses.length>0)}}function q6t(n,t){if(1&n){const e=Oe();F(),O(0,"polygon",8),ee("click",function(){ue(e);const s=C().$implicit;return ce(C().selectSpace(s.x,s.y))}),A()}if(2&n){const e=C().$implicit,r=C();De("id","stroke_",e.x,"_",e.y,""),z("points",r.getHexaPointsAtXY(e.x,e.y))}}function j6t(n,t){if(1&n&&(F(),O(0,"g"),x(1,q6t,1,3,"polygon",7),A()),2&n){const e=t.$implicit;P(1),w("ngIf",e.content.selected)}}function Z6t(n,t){if(1&n){const e=Oe();F(),O(0,"g")(1,"g",9),ee("click",function(){const i=ue(e).$implicit;return ce(C(2).selectStack(i.x,i.y))}),A()()}if(2&n){const e=t.$implicit,r=C().index,s=C();P(1),De("id","piece_",e.x,"_",e.y,""),w("piece",e.content.piece)("x",e.x)("y",e.y)("pieceHeight",s.PIECE_HEIGHT)("hexaLayout",s.hexaLayout)("layer",r)}}function Y6t(n,t){if(1&n){const e=Oe();F(),O(0,"polygon",6),ee("click",function(){ue(e);const s=C().$implicit;return ce(C(2).selectStack(s.x,s.y))}),A()}if(2&n){const e=C().$implicit,r=C().index,s=C();De("id","stroke_",e.x,"_",e.y,""),w("ngClass",e.content.strokeClasses),z("transform","translate(0 "+-(r+1)*s.PIECE_HEIGHT+")")("points",s.getHexaPointsAtXY(e.x,e.y))}}function K6t(n,t){if(1&n&&(F(),O(0,"g"),x(1,Y6t,1,5,"polygon",5),A()),2&n){const e=t.$implicit;P(1),w("ngIf",e.content.strokeClasses.length>0)}}function X6t(n,t){if(1&n&&(F(),O(0,"g"),x(1,Z6t,2,8,"g",1),x(2,K6t,2,1,"g",1),A()),2&n){const e=t.$implicit;P(1),w("ngForOf",e),P(1),w("ngForOf",e)}}function Q6t(n,t){if(1&n){const e=Oe();F(),O(0,"g")(1,"g",10),ee("click",function(){const i=ue(e).$implicit;return ce(C(2).selectRemaining(i))}),A()()}if(2&n){const e=t.$implicit,r=t.index,s=C(2);P(1),y1("id","remainingPiece_",e.toString(),""),w("piece",e)("pieceHeight",s.PIECE_HEIGHT)("x",0)("y",0)("layer",r)("hexaLayout",s.hexaLayout),z("transform",s.getRemainingPieceTransform(e))}}function J6t(n,t){if(1&n&&(F(),O(0,"g"),x(1,Q6t,2,8,"g",1),A()),2&n){const e=t.$implicit;P(1),w("ngForOf",e.pieces)}}function e0t(n,t){if(1&n&&(F(),X(0,"polygon",11)),2&n){const e=C();z("transform",e.getRemainingPieceHighlightTransform(e.selectedRemaining.get()))("points",e.getHexaPointsAt(e.ORIGIN))}}function t0t(n,t){if(1&n&&(F(),X(0,"g",13)),2&n){const e=t.$implicit,r=t.index,s=C(2);y1("id","inspectedStack_",r,""),w("piece",e)("pieceHeight",s.PIECE_HEIGHT)("x",0)("y",0)("hexaLayout",s.hexaLayout)("layer",6*r),z("transform",s.inspectedStackTransform)}}function n0t(n,t){if(1&n&&(F(),O(0,"g"),x(1,t0t,1,8,"g",12),A()),2&n){const e=C();P(1),w("ngForOf",e.inspectedStack.get().pieces.slice().reverse())}}class v3e extends xte{constructor(){super(...arguments),this.highlighted=[]}initialize(t){this.set(t,{spaceClasses:[],strokeClasses:[],selected:!1})}highlightFill(t,e){this.highlighted.push(t),this.get(t).map(r=>r.spaceClasses.push(e))}highlightStroke(t,e){this.highlighted.push(t),this.get(t).map(r=>r.strokeClasses.push(e))}select(t){this.highlighted.push(t),this.get(t).map(e=>e.selected=!0)}clearHighlights(){for(const t of this.highlighted)this.get(t).map(e=>{e.strokeClasses=[],e.spaceClasses=[],e.selected=!1});this.highlighted=[]}}class r0t extends xte{constructor(){super(...arguments),this.highlighted=[]}initialize(t,e){this.set(t,{piece:e,strokeClasses:[]})}highlight(t,e){this.highlighted.push(t),this.get(t).map(r=>r.strokeClasses.push(e))}clearHighlights(){for(const t of this.highlighted)this.get(t).map(e=>{e.strokeClasses=[]});this.highlighted=[]}}let s0t=(()=>{class n extends Td{constructor(e){super(e),this.ORIGIN=new S(0,0),this.remainingStacks=[],this.layers=[],this.ground=new v3e,this.inspectedStack=T.empty(),this.inspectedStackCoord=T.empty(),this.selectedRemaining=T.empty(),this.selectedStart=T.empty(),this.selectedSpiderCoords=[],this.rules=Gi.get(),this.availableMinimaxes=[new R6t(this.rules,"HiveMinimax")],this.encoder=Ei.encoder,this.tutorial=(new _3e).tutorial,this.SPACE_SIZE=30,this.PIECE_HEIGHT=this.SPACE_SIZE/3,this.hexaLayout=new wd(1.5*this.SPACE_SIZE,new S(2*this.SPACE_SIZE,0),Is.INSTANCE),this.canPass=!1,this.updateBoard()}updateBoard(){this.cancelMoveAttempt(),this.layers=[];for(const r of this.getState().occupiedSpaces()){const s=this.getState().getAt(r),i=r.x,o=r.y;for(let c=0;c<s.size();c++){c in this.layers||(this.layers[c]=new r0t);const u=s.pieces[s.size()-1-c];this.layers[c].initialize(new S(i,o),u)}}this.ground=this.getGround(),this.computeViewBox(),this.remainingStacks=this.getState().remainingPieces.toListOfStacks(),this.canPass=Gi.get().shouldPass(this.getState());const e=Gi.get().getGameStatus(this.rules.node);switch(e){case xe.ONGOING:break;case xe.DRAW:this.highlight(this.getState().queenBeeLocation(B.ZERO).get(),"victory-stroke"),this.highlight(this.getState().queenBeeLocation(B.ONE).get(),"victory-stroke");break;default:const s=e.winner.getOpponent();this.highlight(this.getState().queenBeeLocation(s).get(),"victory-stroke")}}highlight(e,r){const s=this.getState().getAt(e).size();s-1 in this.layers&&this.layers[s-1].highlight(e,r)}pass(){var e=this;return I(function*(){return Me.assert(e.canPass,"DvonnComponent: pass() can only be called if canPass is true"),yield e.chooseMove(Ei.PASS,e.getState())})()}computeViewBox(){const e=this.getPieceCoords().union(this.getAllNeighbors()).toList();e.push(new S(0,0)),this.boardViewBox=m6.fromHexa(e,this.hexaLayout,this.STROKE_WIDTH);const r=new m6(this.getRemainingPieceTransformAsCoord(new Qs(B.ZERO,"QueenBee")).x,0,4*this.SPACE_SIZE*5,0),s=5*this.SPACE_SIZE;let i=0;this.getState().remainingPieces.getAny(B.ZERO).isPresent()&&(i=s);let o=0;this.getState().remainingPieces.getAny(B.ONE).isPresent()&&(o=s);const c=this.boardViewBox.containingAtLeast(r).expand(0,0,i,o);if(this.inspectedStack.isPresent()){const u=new S(c.right()+this.SPACE_SIZE,c.center().y),d=this.inspectedStack.get().size();this.inspectedStackTransform=`translate(${u.x} ${u.y+3*(d-1)*this.PIECE_HEIGHT})`,this.viewBox=c.expand(0,5*this.SPACE_SIZE,0,0).toSVGString()}else this.viewBox=c.toSVGString()}getPieceCoords(){return this.getState().pieces.getKeySet()}getGround(){const e=new v3e;for(const r of this.getAllNeighbors())e.initialize(r);return e}getAllNeighbors(){const e=new zt;for(const r of this.getPieceCoords())e.addAll(new zt(this.getState().emptyNeighbors(r)));return e.isEmpty()&&e.add(new S(0,0)),e}clearHighlights(){for(const e of this.layers)e.clearHighlights();this.ground.clearHighlights()}cancelMoveAttempt(){this.clearHighlights(),this.selectedStart=T.empty(),this.selectedRemaining=T.empty(),this.selectedSpiderCoords=[],this.inspectedStack=T.empty(),this.computeViewBox()}showLastMove(e){for(const r of this.getLastMoveCoords(e))this.highlight(r,"last-move-stroke"),this.ground.highlightStroke(r,"last-move-stroke"),this.ground.highlightFill(r,"moved-fill")}getLastMoveCoords(e){let r=[];return e instanceof ec?r=[e.coord]:e instanceof x2&&(r=[e.getStart(),e.getEnd()]),r}getRemainingPieceTransformAsCoord(e){const r=this.getRemainingPieceShift(e),s=this.boardViewBox.center().x+r*this.SPACE_SIZE*4;let i;return i=e.owner===this.role?this.boardViewBox.bottom()+3*this.SPACE_SIZE:this.boardViewBox.up-2*this.SPACE_SIZE,new S(s,i)}getRemainingPieceTransform(e){const r=this.getRemainingPieceTransformAsCoord(e);return`translate(${r.x} ${r.y})`}getRemainingPieceHighlightTransform(e){const r=this.getRemainingPieceTransformAsCoord(e),s=this.getState().remainingPieces.getQuantity(e);return`translate(${r.x} ${r.y-this.PIECE_HEIGHT*s})`}getRemainingPieceShift(e){switch(e.kind){case"QueenBee":return-2.5;case"Beetle":return-1.5;case"Grasshopper":return-.5;case"Spider":return.5;default:return Me.expectToBe(e.kind,"SoldierAnt"),1.5}}selectRemaining(e){var r=this;return I(function*(){const s=r.canUserPlay(`#remainingPiece_${e.toString()}`);if(s.isFailure())return r.cancelMove(s.getReason());if(e.owner===r.getCurrentPlayer().getOpponent())return r.cancelMove(et.MUST_CHOOSE_PLAYER_PIECE());if("QueenBee"!==e.kind&&Gi.get().mustPlaceQueenBee(r.getState()))return r.cancelMove(rs.MUST_PLACE_QUEEN_BEE_LATEST_AT_FOURTH_TURN());if(r.selectedRemaining.equalsValue(e))r.cancelMoveAttempt();else{r.cancelMoveAttempt(),r.selectedRemaining=T.of(e),r.clearHighlights();const i=Gi.get().getPossibleDropLocations(r.getState()).toList();for(const o of i)r.ground.highlightStroke(o,"clickable-stroke")}return R.SUCCESS})()}selectStack(e,r){return this.select(new S(e,r),"piece")}selectSpace(e,r){return this.select(new S(e,r),"space")}select(e,r){var s=this;return I(function*(){const i=s.canUserPlay(`#${r}_${e.x}_${e.y}`);if(i.isFailure())return s.cancelMove(i.getReason());const o=s.getState(),c=o.getAt(e);if(s.selectedRemaining.isPresent()){const u=Ei.drop(s.selectedRemaining.get(),e);return s.chooseMove(u,o)}if(s.selectedStart.isPresent()){const u=o.getAt(s.selectedStart.get()).topPiece();return s.selectedStart.equalsValue(e)?s.cancelMove():s.selectTarget(e,u)}return 0===c.size()?s.cancelMove():s.selectStart(e,c)})()}selectTarget(e,r){var s=this;return I(function*(){if("Spider"===r.kind)return s.selectNextSpiderSpace(e);{const i=Ei.move(s.selectedStart.get(),e);return Pe(i.isSuccess(),"Hive: the only forbidden moves are static moves"),s.chooseMove(i.get(),s.getState())}})()}selectStart(e,r){var s=this;return I(function*(){const i=s.getState(),o=r.topPiece();return o.owner===i.getCurrentPlayer().getOpponent()?1===r.size()?s.cancelMove(et.MUST_CHOOSE_PLAYER_PIECE()):s.inspectedStack.isPresent()?(s.cancelMoveAttempt(),s.clearHighlights(),R.SUCCESS):(s.highlight(e,"selected-stroke"),s.inspectedStack=T.of(r),s.inspectedStackCoord=T.of(e),s.computeViewBox(),R.SUCCESS):(s.cancelMoveAttempt(),s.clearHighlights(),"QueenBee"!==o.kind&&Gi.get().mustPlaceQueenBee(i)?s.cancelMove(rs.MUST_PLACE_QUEEN_BEE_LATEST_AT_FOURTH_TURN()):(s.selectedStart=T.of(e),s.highlight(e,"selected-stroke"),"Spider"===o.kind&&s.selectedSpiderCoords.push(s.selectedStart.get()),r.size()>1&&(s.inspectedStack=T.of(r),s.inspectedStackCoord=T.of(e),s.computeViewBox()),s.highlightNextPossibleCoords(e),R.SUCCESS))})()}highlightNextPossibleCoords(e){for(const r of this.getNextPossibleCoords(e))this.highlight(r,"clickable-stroke"),this.ground.highlightStroke(r,"clickable-stroke")}getNextPossibleCoords(e){const r=this.getState(),s=r.getAt(e).topPiece(),i=Gi.get().getPossibleMovesFrom(r,e);return"Spider"===s.kind?i.filter(c=>Xe.isPrefix(this.selectedSpiderCoords,c.coords)).map(c=>c.coords[this.selectedSpiderCoords.length]).toList():i.map(o=>o.getEnd()).toList()}selectNextSpiderSpace(e){var r=this;return I(function*(){if(r.selectedSpiderCoords.push(e),4===r.selectedSpiderCoords.length){const i=Ei.spiderMove(r.selectedSpiderCoords);return r.chooseMove(i,r.getState())}const s=Ym.get().prefixLegality(r.selectedSpiderCoords,r.getState());if(s.isFailure())return r.cancelMove(s.getReason());r.clearHighlights(),r.highlight(r.selectedStart.get(),"selected-stroke");for(const i of r.selectedSpiderCoords)r.ground.select(i);return r.highlightNextPossibleCoords(r.selectedStart.get()),R.SUCCESS})()}}return n.\u0275fac=function(e){return new(e||n)(J(En))},n.\u0275cmp=dt({type:n,selectors:[["app-hive"]],features:[l],decls:8,vars:8,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["id","remaining_highlight","class","base no-fill small-stroke selected-stroke",4,"ngIf"],[4,"ngIf"],[1,"base","mid-stroke",3,"id","ngClass","click"],["class","base no-fill small-stroke",3,"id","ngClass","click",4,"ngIf"],[1,"base","no-fill","small-stroke",3,"id","ngClass","click"],["class","base no-fill small-stroke","ngClass","selected-stroke",3,"id","click",4,"ngIf"],["ngClass","selected-stroke",1,"base","no-fill","small-stroke",3,"id","click"],["app-hive-piece","",3,"id","piece","x","y","pieceHeight","hexaLayout","layer","click"],["app-hive-piece","",3,"id","piece","pieceHeight","x","y","layer","hexaLayout","click"],["id","remaining_highlight",1,"base","no-fill","small-stroke","selected-stroke"],["app-hive-piece","",3,"id","piece","pieceHeight","x","y","hexaLayout","layer",4,"ngFor","ngForOf"],["app-hive-piece","",3,"id","piece","pieceHeight","x","y","hexaLayout","layer"]],template:function(e,r){1&e&&(F(),O(0,"svg",0),x(1,U6t,2,4,"g",1),x(2,W6t,2,1,"g",1),x(3,j6t,2,1,"g",1),x(4,X6t,3,2,"g",1),x(5,J6t,2,1,"g",1),x(6,e0t,1,2,"polygon",2),x(7,n0t,2,1,"g",3),A()),2&e&&(z("viewBox",r.viewBox),P(1),w("ngForOf",r.ground),P(1),w("ngForOf",r.ground),P(1),w("ngForOf",r.ground),P(1),w("ngForOf",r.layers),P(1),w("ngForOf",r.remainingStacks),P(1),w("ngIf",r.selectedRemaining.isPresent()),P(1),w("ngIf",r.inspectedStack.isPresent()))},dependencies:[fn,On,Kt,$6t],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();const i0t={CASTLE_IS_LEFT_FOR_GOOD:!1,BORDER_CAN_SURROUND_KING:!0,CENTRAL_THRONE_CAN_SURROUND_KING:!1,KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED:!1,WIDTH:11,INVADER:B.ZERO};class H3 extends AH{static getInitialState(){const t=Sn.UNOCCUPIED,e=Sn.INVADERS,r=Sn.DEFENDERS;return new H3([[t,t,t,e,e,e,e,e,t,t,t],[t,t,t,t,t,e,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t],[e,t,t,t,t,r,t,t,t,t,e],[e,t,t,t,r,r,r,t,t,t,e],[e,e,t,r,r,Sn.PLAYER_ONE_KING,r,r,t,e,e],[e,t,t,t,r,r,r,t,t,t,e],[e,t,t,t,t,r,t,t,t,t,e],[t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,e,t,t,t,t,t],[t,t,t,e,e,e,e,e,t,t,t]],0)}from(t,e){return new H3(t,e)}}class Do extends OH{static of(t,e){return new Do(t,e)}static from(t,e){try{const r=new Do(t,e);return _e.success(r)}catch(r){return _e.failure(r.message)}}getMaximalDistance(){return 11}}Do.encoder=no.getFallibleEncoder(Do.from);class x5 extends NH{constructor(){super(H3,i0t,Do.of)}static get(){return null==x5.singleton&&(x5.singleton=new x5),U1.ruler=this.singleton,x5.singleton}}const V=Sn.UNOCCUPIED,Xt=Sn.INVADERS,ss=Sn.DEFENDERS,RP=Sn.PLAYER_ONE_KING;class C3e extends $1{constructor(){super(...arguments),this.tutorial=[ie.informational($localize`Goal of the game`,$localize`Hnefatafl is a strategy game that was played by the vikings, it's part of a larger family of games called Tafl. The goal of the game is different for each player. The attacker plays first. Their pieces (dark) are close to the edges. Their goal is to capture the king, which is in the center of the board. The defender plays second. Their pieces (light) are in the middle. Their goal is to move the king on one of the 4 thrones in the corners. Note that the square in which the king starts, in the center of the board, is also a throne.`,H3.getInitialState()),ie.anyMove($localize`Moving`,$localize`All pieces move the same way. Similarly to a rook in chess, a piece can move:<ol><li>By as many squares as you want.</li><li>Without going over another piece or stopping on another piece.</li><li>Horizontally or vertically.</li><li>Only the king can land on a throne.</li></ol>To move a piece, click on it and then on its landing square.<br/><br/>You're playing Dark, do the first move.`,H3.getInitialState(),Do.of(new S(5,1),new S(1,1)),$localize`Congratulations!`),ie.fromMove($localize`Capturing a soldier (1/2)`,$localize`All pieces, attackers and defenders, except the king, are soldiers. To capture them, they have to be sandwiched between two of your pieces. By getting too close, an attacker's soldier is in danger.<br/><br/>You're playing Light. Capture the soldier.`,new H3([[V,V,V,V,Xt,Xt,Xt,Xt,V,V,V],[V,V,V,V,V,Xt,V,V,V,V,V],[V,V,V,V,V,V,V,V,V,V,V],[Xt,V,V,V,V,ss,V,V,V,V,Xt],[Xt,V,V,Xt,ss,ss,ss,V,V,V,Xt],[Xt,Xt,V,ss,ss,RP,ss,ss,V,Xt,Xt],[Xt,V,V,V,ss,ss,ss,V,V,V,Xt],[Xt,V,V,V,V,ss,V,V,V,V,Xt],[V,V,V,V,V,V,V,V,V,V,V],[V,V,V,V,V,Xt,V,V,V,V,V],[V,V,V,Xt,Xt,Xt,Xt,Xt,V,V,V]],1),[Do.of(new S(5,3),new S(3,3))],$localize`Congratulations, that will teach him a lesson!`,$localize`Failed, you missed an opportunity to capture a piece of the opponent.`).withPreviousMove(Do.of(new S(3,0),new S(3,4))).withPreviousState(H3.getInitialState()),ie.fromMove($localize`Capturing a soldier (2/2)`,$localize`A second way to capture a soldier is to sandwich it against an empty throne. The king has moved and endangered one of its soldiers.<br/><br/>You're playing Dark. Capture the soldier.`,new H3([[V,V,V,Xt,Xt,Xt,Xt,Xt,V,V,V],[V,ss,V,V,V,Xt,V,V,V,V,V],[V,V,V,V,V,V,V,V,V,V,V],[V,V,V,V,V,ss,V,V,V,V,Xt],[Xt,V,V,V,V,ss,ss,V,V,V,Xt],[Xt,Xt,RP,V,ss,V,ss,ss,V,V,Xt],[V,V,Xt,V,V,ss,ss,V,V,V,Xt],[Xt,V,V,V,V,ss,V,V,V,V,V],[V,V,V,V,V,V,V,V,V,V,V],[V,Xt,V,V,V,V,V,V,V,V,V],[V,V,V,Xt,Xt,Xt,Xt,V,Xt,V,V]],12),[Do.of(new S(3,0),new S(3,5)),Do.of(new S(3,10),new S(3,5))],$localize`Congratulations, one less defender. But keep an eye on the king, it is the most important.`,$localize`Failed, you did not do the expected move.`),ie.fromMove($localize`Capturing the king (1/2)`,$localize`To capture the king, two soldiers are not enough. For the first solution, the four squares neighbor to the king (horizontally and vertically) must be occupied by your soldiers. This also works if the king is on the throne.<br/><br/>You're playing Dark, capture the king.`,new H3([[V,V,V,V,V,V,V,V,V,V,V],[V,V,V,V,V,V,V,V,V,V,V],[V,V,V,V,V,V,V,V,V,V,V],[V,Xt,V,V,V,V,V,V,V,V,V],[Xt,RP,V,Xt,V,V,V,V,V,V,V],[V,Xt,V,V,V,V,V,V,V,V,V],[V,V,V,V,V,V,V,V,V,V,V],[V,V,V,V,V,V,V,V,V,V,V],[V,V,V,V,V,V,V,V,V,V,V],[V,V,V,V,V,V,V,V,V,V,V],[V,V,V,V,V,V,V,V,V,V,V]],72),[Do.of(new S(3,4),new S(2,4))],$localize`Congratulations, you won!`,$localize`Failed, you let the king run away.`),ie.fromMove($localize`Capturing the king (2/2)`,$localize`Another way to capture the king is to immobilize it against an edge of the board. Note that the king cannot be captured next to a throne.<br/><br/>You're playing Dark, capture the king.`,new H3([[V,V,Xt,RP,Xt,V,V,V,V,V,V],[V,V,V,V,V,V,ss,V,V,V,V],[V,V,V,V,V,V,V,V,V,V,V],[V,V,V,Xt,V,V,V,V,V,V,V],[V,V,V,V,V,V,V,V,V,V,V],[V,V,V,V,V,V,V,V,V,V,V],[V,V,V,V,V,V,V,V,V,V,V],[V,V,V,V,V,V,V,V,V,V,V],[V,V,V,V,V,V,V,V,V,V,V],[V,V,V,V,V,V,V,V,V,V,V],[V,V,V,V,V,V,V,V,V,V,V]],72),[Do.of(new S(3,3),new S(3,1))],$localize`The king is dead, long live the king. Congratulations, you won.`,$localize`Failed. Try again.`)]}}function o0t(n,t){1&n&&(F(),X(0,"polygon",8))}function a0t(n,t){1&n&&(F(),X(0,"rect",9))}function c0t(n,t){if(1&n&&(F(),O(0,"g"),x(1,o0t,1,0,"polygon",6),x(2,a0t,1,0,"ng-template",null,7,Zn),A()),2&n){const e=Bn(3),r=C().index,s=C().index,i=C();P(1),w("ngIf",i.isCentralThrone(r,s))("ngIfElse",e)}}function l0t(n,t){if(1&n&&(F(),O(0,"g"),X(1,"line",13)(2,"line",13)(3,"line",13)(4,"line",13)(5,"line",13),A()),2&n){const e=C(2).index,r=C().index,s=C();P(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),z("x1",.5*s.SPACE_SIZE)("y1",.04*s.SPACE_SIZE)("x2",.5*s.SPACE_SIZE)("y2",.96*s.SPACE_SIZE),P(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),z("x1",.5*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.1*s.SPACE_SIZE)("y2",.6*s.SPACE_SIZE),P(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),z("x1",.5*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.9*s.SPACE_SIZE)("y2",.6*s.SPACE_SIZE),P(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),z("x1",.5*s.SPACE_SIZE)("y1",.4*s.SPACE_SIZE)("x2",.15*s.SPACE_SIZE)("y2",.75*s.SPACE_SIZE),P(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),z("x1",.5*s.SPACE_SIZE)("y1",.4*s.SPACE_SIZE)("x2",.85*s.SPACE_SIZE)("y2",.75*s.SPACE_SIZE)}}function u0t(n,t){if(1&n&&(F(),X(0,"polyline",16)),2&n){const e=C(3).index,r=C().index;w("ngClass",C().viewInfo.pieceClasses[r][e])}}function f0t(n,t){if(1&n&&(F(),X(0,"line",13)(1,"line",13)(2,"line",13)(3,"line",13)),2&n){const e=C(3).index,r=C().index,s=C();w("ngClass",s.viewInfo.pieceClasses[r][e]),z("x1",.5*s.SPACE_SIZE)("y1",.04*s.SPACE_SIZE)("x2",.5*s.SPACE_SIZE)("y2",.96*s.SPACE_SIZE),P(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),z("x1",.04*s.SPACE_SIZE)("y1",.5*s.SPACE_SIZE)("x2",.96*s.SPACE_SIZE)("y2",.5*s.SPACE_SIZE),P(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),z("x1",.2*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.8*s.SPACE_SIZE)("y2",.8*s.SPACE_SIZE),P(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),z("x1",.8*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.2*s.SPACE_SIZE)("y2",.8*s.SPACE_SIZE)}}function d0t(n,t){if(1&n&&(F(),x(0,u0t,1,1,"polyline",14),x(1,f0t,4,20,"ng-template",null,15,Zn)),2&n){const e=Bn(2),r=C(2).index,s=C().index;w("ngIf",C().isKing(r,s))("ngIfElse",e)}}function h0t(n,t){if(1&n&&(F(),O(0,"g"),X(1,"circle",10),x(2,l0t,6,25,"g",11),x(3,d0t,3,2,"ng-template",null,12,Zn),A()),2&n){const e=Bn(4),r=C().index,s=C().index,i=C();P(1),De("id","piece_",r,"_",s,""),w("ngClass",i.viewInfo.pieceClasses[s][r]),z("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)("cx",.5*i.SPACE_SIZE)("cy",.5*i.SPACE_SIZE),P(1),w("ngIf",i.isInvader(r,s))("ngIfElse",e)}}function p0t(n,t){if(1&n){const e=Oe();F(),O(0,"g",3),ee("click",function(){const i=ue(e).index,o=C().index;return ce(C().onClick(i,o))}),X(1,"rect",4),x(2,c0t,4,2,"g",5),x(3,h0t,5,8,"g",5),A()}if(2&n){const e=t.index,r=C().index,s=C();De("id","click_",e,"_",r,""),z("transform","translate("+s.SPACE_SIZE*e+", "+s.SPACE_SIZE*r+")"),P(1),De("id","space_",e,"_",r,""),w("ngClass",s.getRectClasses(e,r)),z("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),P(1),w("ngIf",s.board[r][e]===s.EMPTY&&s.isThrone(e,r)),P(1),w("ngIf",s.board[r][e]!==s.EMPTY)}}function g0t(n,t){if(1&n&&(F(),O(0,"g"),x(1,p0t,4,10,"g",2),A()),2&n){const e=t.$implicit;P(1),w("ngForOf",e)}}function m0t(n,t){if(1&n){const e=Oe();F(),O(0,"g")(1,"rect",17),ee("click",function(){const i=ue(e).$implicit;return ce(C().onClick(i.x,i.y))}),A()()}if(2&n){const e=t.$implicit,r=C();P(1),De("id","click_",e.x,"_",e.y,""),z("x",r.SPACE_SIZE*e.x)("y",r.SPACE_SIZE*e.y)("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)}}let _0t=(()=>{class n extends IH{constructor(e){super(e,!1,Do.from),this.rules=x5.get(),this.availableMinimaxes=[new MP(this.rules,"DummyBot"),new PP(this.rules,"Piece > Influence"),new TP(this.rules,"Piece > Control"),new xH(this.rules,"Escape > Piece > Control")],this.encoder=Do.encoder,this.tutorial=(new C3e).tutorial}ngOnInit(){this.updateBoard()}}return n.\u0275fac=function(e){return new(e||n)(J(En))},n.\u0275cmp=dt({type:n,selectors:[["app-hnefatafl"]],features:[l],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["x","0","y","0",1,"base",3,"id","ngClass"],[4,"ngIf"],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60","class","base",4,"ngIf","ngIfElse"],["cornerThrone",""],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60",1,"base"],["x","15","y","15","width","70","height","70",1,"base"],[1,"base",3,"id","ngClass"],[4,"ngIf","ngIfElse"],["defender",""],[1,"base",3,"ngClass"],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85","class","base no-fill",3,"ngClass",4,"ngIf","ngIfElse"],["soldierDefender",""],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85",1,"base","no-fill",3,"ngClass"],[1,"no-fill","mid-stroke","clickable-stroke",3,"id","click"]],template:function(e,r){1&e&&(F(),O(0,"svg",0),x(1,g0t,2,1,"g",1),x(2,m0t,2,6,"g",1),A()),2&e&&(z("viewBox",r.getViewBox()),P(1),w("ngForOf",r.board),P(1),w("ngForOf",r.getClickables()))},dependencies:[fn,On,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class Tn{constructor(t,e,r){this.value=t,this.name=e,this.rgb=r}static of(t){switch(t){case 0:return Tn.ANY;case 1:return Tn.ORANGE;case 2:return Tn.BLUE;case 3:return Tn.PURPLE;case 4:return Tn.PINK;case 5:return Tn.YELLOW;case 6:return Tn.RED;case 7:return Tn.GREEN;default:return Me.expectToBe(t,8,"Invalid value "+t+" for KamisadoColor"),Tn.BROWN}}}Tn.ANY=new Tn(0,"any","#000"),Tn.ORANGE=new Tn(1,"orange","#d67421"),Tn.BLUE=new Tn(2,"blue","#006bac"),Tn.PURPLE=new Tn(3,"purple","#6f3787"),Tn.PINK=new Tn(4,"pink","#d2719e"),Tn.YELLOW=new Tn(5,"yellow","#e2c200"),Tn.RED=new Tn(6,"red","#d23339"),Tn.GREEN=new Tn(7,"green","#009157"),Tn.BROWN=new Tn(8,"brown","#562500");class Hn{constructor(t,e){this.player=t,this.color=e}static of(t,e){return new Hn(t,Tn.of(e))}static createPlayerColors(t){return{ORANGE:new Hn(t,Tn.ORANGE),BLUE:new Hn(t,Tn.BLUE),PURPLE:new Hn(t,Tn.PURPLE),PINK:new Hn(t,Tn.PINK),YELLOW:new Hn(t,Tn.YELLOW),RED:new Hn(t,Tn.RED),GREEN:new Hn(t,Tn.GREEN),BROWN:new Hn(t,Tn.BROWN)}}equals(t){return t.player===this.player&&t.color===this.color}isEmpty(){return this.player.equals(he.NONE)}belongsTo(t){return this.player===t}}Hn.EMPTY=new Hn(he.NONE,Tn.ANY),Hn.ZERO=Hn.createPlayerColors(B.ZERO),Hn.ONE=Hn.createPlayerColors(B.ONE);class Mi{static getColorAt(t,e){return Mi.COLORS[e][t]}static getInitialBoard(){const t=Hn.EMPTY;return[[1,2,3,4,5,6,7,8].map(e=>Hn.of(B.ONE,e)),[t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t],[8,7,6,5,4,3,2,1].map(e=>Hn.of(B.ZERO,e))]}static isEmptyAt(t,e){return t[e.y][e.x].equals(Hn.EMPTY)}static allPieceCoords(t){const e=[];for(let r=0;r<t.length;r++)for(let s=0;s<t[r].length;s++){const i=new S(s,r);Mi.isEmptyAt(t,i)||e.push(i)}return e}}Mi.INITIAL=Mi.getInitialBoard(),Mi.SIZE=8,Mi.COLORS=Xe.mapBiArray([[1,2,3,4,5,6,7,8],[6,1,4,7,2,5,8,3],[7,4,1,6,3,8,5,2],[4,3,2,1,8,7,6,5],[5,6,7,8,1,2,3,4],[2,5,8,3,6,1,4,7],[3,8,5,2,7,4,1,6],[8,7,6,5,4,3,2,1]],Tn.of);class BH extends Fi{constructor(){super()}isPieceMove(){return!1}length(){return 0}equals(t){return this===t}toString(){return"KamisadoMove(PASS)"}}BH.PASS=new BH;class DP extends c8{constructor(t,e){super(t,e)}static of(t,e){if(t.isNotInRange(Mi.SIZE,Mi.SIZE))throw new Error("Starting coord of KamisadoMove must be on the board, not at "+t.toString());if(e.isNotInRange(Mi.SIZE,Mi.SIZE))throw new Error("End coord of KamisadoMove must be on the board, not at "+e.toString());return new DP(t,e)}isPieceMove(){return!0}equals(t){return t===this||!!t.isPieceMove()&&!1!==t.getStart().equals(this.getStart())&&t.getEnd().equals(this.getEnd())}toString(){return"KamisadoMove("+this.getStart()+"->"+this.getEnd()+")"}}var zo;!function(n){n.PASS=BH.PASS,n.of=function t(s,i){return DP.of(s,i)};const e=Nt.constant("PASS",n.PASS),r=no.getEncoder(DP.of);n.encoder=Nt.disjunction(r,e,s=>s.isPieceMove())}(zo||(zo={}));class F3 extends Br{constructor(t,e,r,s,i){super(Xe.copyBiArray(i),t),this.colorToPlay=e,this.coordToPlay=r,this.alreadyPassed=s}static getInitialState(){return new F3(0,Tn.ANY,T.empty(),!1,Mi.INITIAL)}}let Qm=(()=>{class n{}return n.NOT_RIGHT_COLOR=()=>$localize`This piece is not of the color you have to play.`,n.DIRECTION_NOT_ALLOWED=()=>$localize`You can only move forward, orthogonally or diagonally.`,n.MOVE_BLOCKED=()=>$localize`This move is blocked by another piece.`,n.PLAY_WITH_SELECTED_PIECE=()=>$localize`You must play with the selected piece.`,n})();class ma extends L1{static getColorMatchingPiece(t){return t.coordToPlay.isPresent()?[t.coordToPlay.get()]:[new S(0,7),new S(1,7),new S(2,7),new S(3,7),new S(4,7),new S(5,7),new S(6,7),new S(7,7)]}static getMovablePieces(t){return ma.getColorMatchingPiece(t).filter(e=>{for(const r of this.playerDirections(t.getCurrentPlayer())){const s=e.getNext(r);if(t.isOnBoard(s)&&Mi.isEmptyAt(t.board,s))return!0}return!1})}static playerDirections(t){return t===B.ONE?[Ne.DOWN,Ne.DOWN_LEFT,Ne.DOWN_RIGHT]:[Ne.UP,Ne.UP_LEFT,Ne.UP_RIGHT]}static directionAllowedForPlayer(t,e){return e===B.ZERO?t.y<0:t.y>0}static getListMovesFromState(t){const e=ma.getMovablePieces(t);return 0===e.length?(Pe(!1===t.alreadyPassed,"getListMovesFromState should not be called once game is ended."),[zo.PASS]):ma.getListMovesFromNonBlockedState(t,e)}static getListMovesFromNonBlockedState(t,e){const r=[],s=t.getCurrentPlayer();for(const i of e)for(const o of ma.playerDirections(s))for(let c=1;c<Mi.SIZE;c++){const u=i.getNext(o,c);if(!t.isOnBoard(u)||!Mi.isEmptyAt(t.board,u))break;{const d=zo.of(i,u);r.push(d)}}return r}static mustPass(t){return 0===this.getMovablePieces(t).length}static getFurthestPiecePositions(t){let e=7,r=0;return Mi.allPieceCoords(t.board).forEach(s=>{const i=t.getPieceAt(s);Pe(i!==Hn.EMPTY,"allPieceCoords failed to filter KamisadoPiece.EMPTY"),i.player===B.ONE?r=Math.max(r,s.y):e=Math.min(e,s.y)}),[e,r]}static isLegal(t,e){if(t.isPieceMove()){const r=t.getStart(),s=t.getEnd(),i=e.colorToPlay,o=e.getPieceAt(r);if(!o.belongsTo(e.getCurrentPlayer()))return R.failure(et.MUST_CHOOSE_PLAYER_PIECE());if(i!==Tn.ANY&&o.color!==i)return R.failure(Qm.NOT_RIGHT_COLOR());if(!e.getPieceAt(s).isEmpty())return R.failure(et.MUST_CLICK_ON_EMPTY_SPACE());const u=Ne.factory.fromMove(r,s);if(u.isFailure())return R.failure(Qm.DIRECTION_NOT_ALLOWED());const d=u.get();if(!ma.directionAllowedForPlayer(d,e.getCurrentPlayer()))return R.failure(Qm.DIRECTION_NOT_ALLOWED());let g=r;for(;!g.equals(s);)if(g=g.getNext(d),!e.getPieceAt(g).isEmpty())return R.failure(Qm.MOVE_BLOCKED());return R.SUCCESS}return this.isLegalPass(e)}static isLegalPass(t){return this.mustPass(t)&&!t.alreadyPassed?R.SUCCESS:R.failure(et.CANNOT_PASS())}nextCoordToPlay(t,e){return T.ofNullable(Mi.allPieceCoords(t.board).find(r=>{const s=t.getPieceAt(r);return s.player===t.getCurrentOpponent()&&s.color===e}))}applyLegalMove(t,e,r){if(t.isPieceMove()){const s=t.getStart(),i=t.getEnd(),o=e.getCopiedBoard();o[i.y][i.x]=o[s.y][s.x],o[s.y][s.x]=Hn.EMPTY;const c=Mi.getColorAt(i.x,i.y),u=this.nextCoordToPlay(e,c);return new F3(e.turn+1,c,u,!1,o)}{const s=this.nextCoordToPlay(e,e.colorToPlay);return new F3(e.turn+1,e.colorToPlay,s,!0,e.board)}}isLegal(t,e){return ma.isLegal(t,e)}getGameStatus(t){const e=t.gameState,r=e.getCurrentPlayer();if(ma.mustPass(e)&&e.alreadyPassed)return xe.getDefeat(r);const[s,i]=ma.getFurthestPiecePositions(e);return 7===i?xe.ONE_WON:0===s?xe.ZERO_WON:xe.ONGOING}}class v0t extends xs{getListMoves(t){const e=ma.getListMovesFromState(t.gameState);return Xe.sortByDescending(e,r=>r.length()),e}getMetrics(t){const e=t.gameState,[r,s]=ma.getFurthestPiecePositions(e);return[7-r,s]}}const ae=Hn.EMPTY,zP=Hn.ZERO.ORANGE,VP=Hn.ONE.ORANGE,HP=Hn.ZERO.BLUE,FP=Hn.ONE.BLUE,$H=Hn.ZERO.PURPLE,Jm=Hn.ONE.PURPLE,BP=Hn.ZERO.PINK,$P=Hn.ONE.PINK,UP=Hn.ZERO.YELLOW,GP=Hn.ONE.YELLOW,WP=Hn.ZERO.RED,qP=Hn.ONE.RED,jP=Hn.ZERO.GREEN,ZP=Hn.ONE.GREEN,YP=Hn.ZERO.BROWN,KP=Hn.ONE.BROWN;class y3e extends $1{constructor(){super(...arguments),this.tutorial=[ie.informational($localize`Goal of the game`,$localize`At Kamisado, there are two ways to win the game:
        either by moving one of your pieces on the opponent's starting line,
        or by forcing the opponent to make a move that blocks the entire game.
        Here, Dark wins because its brown piece is on Light's starting line, on the top left.`,new F3(5,Tn.ORANGE,T.empty(),!1,[[YP,FP,Jm,$P,GP,qP,ZP,KP],[ae,ae,ae,ae,ae,ae,ae,ae],[ae,ae,ae,ae,ae,ae,ae,ae],[ae,ae,ae,ae,ae,ae,ae,ae],[ae,ae,ae,VP,ae,ae,ae,ae],[ae,ae,ae,ae,ae,ae,ae,ae],[ae,ae,ae,ae,ae,ae,ae,ae],[ae,jP,WP,UP,BP,$H,HP,zP]])).withPreviousMove(zo.of(new S(0,7),new S(0,0))),ie.anyMove($localize`Initial board and initial move`,$localize`Here is the initial board.
        At Kamisado, pieces can only move forward, vertically or diagonally.
        You're playing first, with dark pieces, you can make your first move.<br/><br/>
        You're playing Dark, click on the piece of your choice and click on a landing square.`,F3.getInitialState(),zo.of(new S(7,7),new S(3,3)),$localize`Perfect! Note that each of your piece has a different color.`),ie.fromMove($localize`Moving`,$localize`Let us now consider the move of Light, after the blue piece has been moved by Dark.
        All moves after the initial move must be made from the piece that corresponds to the color
        of the square upon which the last move ended.
        Here, the last move ended on the pink square, hence the pink piece must move.
        It is already selected, you do not have to click on it.<br/><br/>
        You're playing Light, move your piece on a blue square.`,new F3(1,Tn.PINK,T.of(new S(3,0)),!1,[[VP,FP,Jm,$P,GP,qP,ZP,KP],[ae,ae,ae,ae,ae,ae,ae,ae],[ae,ae,ae,ae,ae,ae,ae,ae],[ae,ae,ae,ae,ae,ae,ae,ae],[ae,ae,ae,ae,ae,ae,ae,ae],[ae,ae,ae,ae,ae,ae,HP,ae],[ae,ae,ae,ae,ae,ae,ae,ae],[YP,jP,WP,UP,BP,$H,ae,zP]]),[zo.of(new S(3,0),new S(3,6)),zo.of(new S(3,0),new S(4,1))],$localize`Congratulations!`,$localize`You have not moved your pink piece on a blue square!`).withPreviousMove(zo.of(new S(6,7),new S(6,5))),ie.informational($localize`Stuck situation`,$localize`Dark moved to another pink square, hence you have to move your pink piece again.
        However, your pink piece is stuck! In this case, you must pass your turn.
        Dark will now have to play by moving its pink piece.`,new F3(1,Tn.PINK,T.of(new S(3,6)),!1,[[VP,FP,Jm,ae,GP,qP,ZP,KP],[ae,ae,ae,ae,ae,ae,ae,ae],[ae,ae,ae,ae,ae,ae,ae,ae],[ae,ae,ae,ae,ae,ae,ae,ae],[ae,ae,ae,ae,ae,ae,ae,HP],[ae,ae,ae,ae,ae,ae,ae,ae],[ae,ae,ae,$P,ae,ae,ae,ae],[YP,jP,WP,UP,BP,$H,ae,zP]])).withPreviousMove(zo.of(new S(6,5),new S(7,4))),ie.fromMove($localize`Victory by blocking`,$localize`At any time, if a player blocks the entire game, that player loses.
        In other words, if a player forces its opponent to move a piece that the opponent cannot move,
        and the player cannot move its own piece of the same color, then that player loses.
        Here, you're playing Dark and you can force your opponent to create such a situation, hence you can force your opponent to lose!<br/><br/>
        You're playing Dark, analyze the board and make the winning move.`,new F3(2,Tn.RED,T.of(new S(2,4)),!1,[[ae,FP,Jm,ae,ae,qP,ae,ae],[ae,ae,ae,GP,ae,ae,ae,ae],[ae,ae,ae,$P,ae,Jm,ae,ae],[ae,ae,ae,UP,ae,ae,ae,ae],[ae,ae,WP,ae,ae,ae,ae,ae],[ae,ae,ae,ae,ae,ae,ZP,ae],[VP,ae,ae,ae,ae,BP,ae,KP],[YP,jP,ae,ae,ae,ae,HP,zP]]),[zo.of(new S(2,4),new S(0,2))],$localize`Perfect!
         Your opponent must move its green piece on the orange square, forcing you to play with your orange piece.
         Your orange piece will be stuck and you will have to pass your turn.
         Your opponent will have to pass its turn too because its orange piece is also stuck: the game is completely stuck.
         In this case, the last player to have moved a piece loses.
         Here, your opponent will have moved its green piece last, you therefore win!`,$localize`Failed. Try again.`).withPreviousMove(zo.of(new S(4,0),new S(3,1)))]}}function C0t(n,t){if(1&n&&(F(),X(0,"circle",8)),2&n){const e=C(),r=e.$implicit,s=e.index,i=C().index,o=C();w("ngClass",o.piecePlayerClass(r)),z("cx",o.SPACE_SIZE/2+s*o.SPACE_SIZE)("cy",o.SPACE_SIZE/2+i*o.SPACE_SIZE)("r",o.SPACE_SIZE/2-o.STROKE_WIDTH)}}function y0t(n,t){if(1&n&&(F(),X(0,"rect",9)),2&n){const e=C(),r=e.index,s=e.$implicit,i=C().index,o=C();z("x",o.SPACE_SIZE/2+r*o.SPACE_SIZE-o.SPACE_SIZE/8)("y",o.SPACE_SIZE/2+i*o.SPACE_SIZE-o.SPACE_SIZE/8)("rx",o.isPlayerZero(s)?o.SPACE_SIZE:0)("ry",o.isPlayerZero(s)?o.SPACE_SIZE:0)("width",o.SPACE_SIZE/4)("height",o.SPACE_SIZE/4)("fill",o.pieceColor(s))}}function E0t(n,t){if(1&n){const e=Oe();F(),O(0,"g")(1,"g",4),ee("click",function(){const i=ue(e).index,o=C().index;return ce(C().onClick(i,o))}),X(2,"rect",5),x(3,C0t,1,4,"circle",6),x(4,y0t,1,7,"rect",7),A()()}if(2&n){const e=t.$implicit,r=t.index,s=C().index,i=C();P(1),De("id","click_",r,"_",s,""),P(1),z("x",r*i.SPACE_SIZE)("y",s*i.SPACE_SIZE)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)("fill",i.backgroundColor(r,s)),P(1),w("ngIf",e!==i.UNOCCUPIED),P(1),w("ngIf",e!==i.UNOCCUPIED)}}function M0t(n,t){if(1&n&&(F(),O(0,"g"),x(1,E0t,5,9,"g",1),A()),2&n){const e=t.$implicit;P(1),w("ngForOf",e)}}function S0t(n,t){if(1&n&&(F(),O(0,"g"),X(1,"rect",10)(2,"rect",10),A()),2&n){const e=C();P(1),De("id","last_move_start_",e.lastPieceMove.get().getStart().x,"_",e.lastPieceMove.get().getStart().y,""),z("x",e.lastPieceMove.get().getStart().x*e.SPACE_SIZE)("y",e.lastPieceMove.get().getStart().y*e.SPACE_SIZE)("width",e.SPACE_SIZE)("height",e.SPACE_SIZE),P(1),De("id","last_move_start_",e.lastPieceMove.get().getEnd().x,"_",e.lastPieceMove.get().getEnd().y,""),z("x",e.lastPieceMove.get().getEnd().x*e.SPACE_SIZE)("y",e.lastPieceMove.get().getEnd().y*e.SPACE_SIZE)("width",e.SPACE_SIZE)("height",e.SPACE_SIZE)}}function P0t(n,t){if(1&n&&(F(),X(0,"circle",11)),2&n){const e=C();z("cx",e.SPACE_SIZE/2+e.chosen.get().x*e.SPACE_SIZE)("cy",e.SPACE_SIZE/2+e.chosen.get().y*e.SPACE_SIZE)("r",e.SPACE_SIZE/2-e.STROKE_WIDTH)}}let T0t=(()=>{class n extends ko{constructor(e){super(e),this.UNOCCUPIED=Hn.EMPTY,this.lastMove=T.empty(),this.lastPieceMove=T.empty(),this.chosen=T.empty(),this.chosenAutomatically=!1,this.hasAsymmetricBoard=!0,this.rules=new ma(F3),this.availableMinimaxes=[new v0t(this.rules,"KamisadoMinimax")],this.encoder=zo.encoder,this.tutorial=(new y3e).tutorial,this.canPass=!1,this.updateBoard()}backgroundColor(e,r){return Mi.getColorAt(e,r).rgb}isPlayerZero(e){return e.player===B.ZERO}pieceColor(e){return e.color.rgb}piecePlayerClass(e){return this.getPlayerClass(e.player)}updateBoard(){const e=this.getState();this.board=e.getCopiedBoard(),this.lastPieceMove=T.empty(),this.canPass=ma.mustPass(e);const r=this.rules.getGameStatus(this.rules.node)!==xe.ONGOING;this.canPass||e.coordToPlay.isAbsent()||r?(this.chosenAutomatically=!1,this.chosen=T.empty()):(this.chosenAutomatically=!0,this.chosen=e.coordToPlay)}showLastMove(e){e.isPieceMove()&&(this.lastPieceMove=T.of(e))}pass(){var e=this;return I(function*(){return Pe(e.canPass,"KamisadoComponent: pass() must be called only if canPass is true"),e.chooseMove(zo.PASS,e.getState())})()}onClick(e,r){var s=this;return I(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());const o=new S(e,r);if(s.canPass)return s.cancelMove(et.MUST_PASS());if(s.chosen.isAbsent())return s.choosePiece(e,r);if(!1===s.chosenAutomatically&&s.chosen.equalsValue(o))return s.cancelMoveAttempt(),R.SUCCESS;{const c=s.getState().getPieceAtXY(e,r),u=s.getState().getCurrentPlayer();return c.belongsTo(u)?s.chosenAutomatically?s.cancelMove(Qm.PLAY_WITH_SELECTED_PIECE()):(s.chosen=T.of(o),R.SUCCESS):yield s.chooseDestination(e,r)}})()}choosePiece(e,r){const s=this.getState().getPieceAtXY(e,r),i=this.getState().getCurrentOpponent();return s.belongsTo(i)?this.cancelMove(et.CANNOT_CHOOSE_OPPONENT_PIECE()):(this.chosen=T.of(new S(e,r)),R.SUCCESS)}chooseDestination(e,r){var s=this;return I(function*(){const i=s.chosen.get(),o=new S(e,r),c=zo.of(i,o);return s.chooseMove(c,s.getState())})()}cancelMoveAttempt(){this.chosenAutomatically||(this.chosen=T.empty())}}return n.\u0275fac=function(e){return new(e||n)(J(En))},n.\u0275cmp=dt({type:n,selectors:[["app-kamisado"]],features:[l],decls:4,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf"],["id","selectedPiece","class","base mid-stroke no-fill selected-stroke",4,"ngIf"],[3,"id","click"],["fill-opacity","0.7",1,"base-no-fill"],["class","base-no-fill",3,"ngClass",4,"ngIf"],["class","no-stroke",4,"ngIf"],[1,"base-no-fill",3,"ngClass"],[1,"no-stroke"],[1,"base","no-fill","mid-stroke","last-move-stroke",3,"id"],["id","selectedPiece",1,"base","mid-stroke","no-fill","selected-stroke"]],template:function(e,r){1&e&&(F(),O(0,"svg",0),x(1,M0t,2,1,"g",1),x(2,S0t,3,12,"g",2),x(3,P0t,1,3,"circle",3),A()),2&e&&(z("viewBox",r.getViewBox())("transform",r.rotation),P(1),w("ngForOf",r.board),P(1),w("ngIf",r.lastPieceMove.isPresent()),P(1),w("ngIf",r.chosen.isPresent()))},dependencies:[fn,On,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})(),E3e=(()=>{class n extends ko{getParallelogramCoords(e){const r=e.parallelogramHeight,s=r*e.horizontalWidthRatio,i=r*e.offsetRatio,o=s,u=s-i,d=r,g=-i,m=r;return[new S(0,0),new S(o,0),new S(u,d),new S(g,m)]}getCoordTranslate(e,r,s,i){const o=i.parallelogramHeight;return new S(e*(o*i.horizontalWidthRatio)+i.offsetRatio*o*(i.abstractBoardSize-r),r*o-i.pieceHeightRatio*o*s)}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=Mr(n)))(r||n)}}(),n.\u0275cmp=dt({type:n,selectors:[["ng-component"]],features:[l],decls:0,vars:0,template:function(e,r){},encapsulation:2}),n})(),_6=(()=>{class n{}return n.CANNOT_GO_BACKWARD=()=>$localize`You cannot go backward with normal pieces!`,n.CANNOT_CAPTURE_EMPTY_SPACE=()=>$localize`You cannot capture an empty square, nor jump over it!`,n.CANNOT_SKIP_CAPTURE=()=>$localize`You must capture when it is possible!`,n.MUST_FINISH_CAPTURING=()=>$localize`You must finish this capture!`,n.THIS_PIECE_CANNOT_MOVE=()=>$localize`This piece cannot move!`,n.CAPTURE_STEPS_MUST_BE_DOUBLE_DIAGONAL=()=>$localize`A capture should be a double diagonal step. Look at the green indicators to help you!`,n.MOVE_STEPS_MUST_BE_SINGLE_DIAGONAL=()=>$localize`You must move in a single diagonal step!`,n.CANNOT_CAPTURE_TWICE_THE_SAME_COORD=()=>$localize`You cannot jump over the same square several times!`,n})();class ks{constructor(t,e){this.player=t,this.isOfficer=e}static getPlayerOfficer(t){return t===B.ZERO?ks.ZERO_OFFICER:ks.ONE_OFFICER}toString(){switch(this){case ks.ZERO:return"u";case ks.ONE:return"v";case ks.ZERO_OFFICER:return"O";default:return Me.expectToBe(this,ks.ONE_OFFICER),"X"}}equals(t){return this===t}}ks.ZERO=new ks(B.ZERO,!1),ks.ONE=new ks(B.ONE,!1),ks.ZERO_OFFICER=new ks(B.ZERO,!0),ks.ONE_OFFICER=new ks(B.ONE,!0);class Vo{constructor(t){this.pieces=t}isEmpty(){return 0===this.pieces.length}isCommandedBy(t){return!this.isEmpty()&&this.getCommander().player===t}getCommander(){return this.pieces[0]}getPiecesUnderCommander(){return new Vo(this.pieces.slice(1))}capturePiece(t){return new Vo(this.pieces.concat(t))}addStackBelow(t){let e=this;for(const r of t.pieces)e=e.capturePiece(r);return e}getStackSize(){return this.pieces.length}promoteCommander(){let t=this.getCommander();if(t.isOfficer)return this;{t=ks.getPlayerOfficer(t.player);const e=this.getPiecesUnderCommander();return new Vo([t]).addStackBelow(e)}}get(t){return this.pieces[t]}toString(t){let e=t-this.getStackSize(),r="";for(;e>0;)r+="_",e--;for(const s of this.pieces)r+=s.toString();return r}}Vo.EMPTY=new Vo([]);let nr=(()=>{class n extends Br{static getInitialState(){const e=new Vo([ks.ZERO]),r=new Vo([ks.ONE]),s=Vo.EMPTY;return new n([[r,s,r,s,r,s,r],[s,r,s,r,s,r,s],[r,s,r,s,r,s,r],[s,s,s,s,s,s,s],[e,s,e,s,e,s,e],[s,e,s,e,s,e,s],[e,s,e,s,e,s,e]],0)}static from(e,r){return new n(e,r)}static isNotOnBoard(e){return e.isNotInRange(n.SIZE,n.SIZE)}static isOnBoard(e){return e.isInRange(n.SIZE,n.SIZE)}getStacksOf(e){const r=[];for(let s=0;s<n.SIZE;s++)for(let i=0;i<n.SIZE;i++)this.getPieceAtXY(i,s).isCommandedBy(e)&&r.push(new S(i,s));return r}set(e,r){const s=this.getCopiedBoard();return s[e.y][e.x]=r,new n(s,this.turn)}remove(e){return this.set(e,Vo.EMPTY)}incrementTurn(){return new n(this.getCopiedBoard(),this.turn+1)}getFinishLineOf(e){return e===B.ZERO?0:n.SIZE-1}toString(){let e=1;for(let s=0;s<n.SIZE;s++)for(let i=0;i<n.SIZE;i++){const o=this.getPieceAtXY(i,s).getStackSize();e=Math.max(e,o)}const r=[];for(let s=0;s<n.SIZE;s++){const i=[];for(let o=0;o<n.SIZE;o++)i.push(this.getPieceAtXY(o,s).toString(e));r.push(i.join(" "))}return r.join("\n")}}return n.SIZE=7,n})();class w0t extends zt{equals(t){if(t.size()!==this.size())return!1;for(let e=0;e<this.size();e++)if(!1===Wa(t.get(e),this.get(e)))return!1;return!0}get(t){return Me.assert(t<this.values.length,"MGPUniqueList: index out of bounds: "+t),this.values[t]}getFromEnd(t){return Me.assert(t<this.values.length,"MGPUniqueList: index (from end) out of bounds: "+t),this.get(this.values.length-1-t)}}class Js extends Fi{constructor(t,e){super(),this.isStep=e,this.coords=new w0t(t)}static fromCapture(t){const e=Js.getSteppedOverCoords(t);return e.isSuccess()?_e.success(new Js(t,!1)):_e.failure(e.getReason())}static getSteppedOverCoords(t){let e=T.empty();const r=new zt;for(const s of t){if(nr.isNotOnBoard(s))return _e.failure(wH.OUT_OF_RANGE(s));if(e.isPresent()){const i=e.get();if(!1===i.getVectorToward(s).isDiagonalOfLength(2))return _e.failure(_6.CAPTURE_STEPS_MUST_BE_DOUBLE_DIAGONAL());const c=i.getCoordsToward(s)[0];if(r.contains(c))return _e.failure(_6.CANNOT_CAPTURE_TWICE_THE_SAME_COORD());r.add(c)}e=T.of(s)}return _e.success(r)}static fromStep(t,e){return nr.isNotOnBoard(t)?_e.failure(wH.OUT_OF_RANGE(t)):nr.isNotOnBoard(e)?_e.failure(wH.OUT_OF_RANGE(e)):!1===t.getVectorToward(e).isDiagonalOfLength(1)?_e.failure(_6.MOVE_STEPS_MUST_BE_SINGLE_DIAGONAL()):_e.success(new Js([t,e],!0))}toString(){return"LascaMove("+this.coords.toList().map(r=>r.toString()).join(", ")+")"}getRelation(t){const e=this.coords.size(),r=t.coords.size(),s=Math.min(e,r);for(let i=0;i<s;i++)if(!1===this.coords.toList()[i].equals(t.coords.toList()[i]))return"INEQUALITY";return e===r?"EQUALITY":"PREFIX"}equals(t){return"EQUALITY"===this.getRelation(t)}isPrefix(t){return"PREFIX"===this.getRelation(t)}getStartingCoord(){return this.coords.get(0)}getEndingCoord(){return this.coords.getFromEnd(0)}getCapturedCoords(){return Js.getSteppedOverCoords(this.coords.toList())}concatenate(t){const e=this.getEndingCoord(),r=t.coords.toList()[0];Pe(e.equals(r),"should not concatenate non-touching move");const s=this.coords.toList(),i=Xe.copyImmutableArray(s),o=t.coords.toList(),c=Xe.copyImmutableArray(o).slice(1);return Js.fromCapture(i.concat(c)).get()}}Js.encoder=new class extends Nt{encodeMove(n){return{coords:n.coords.toList().map(t=>S.encoder.encode(t)),isStep:n.isStep}}decodeMove(n){const t=n;Pe(null!=t.coords,"Encoded LascaMove should have a coords field"),Pe(null!=t.isStep,"Encoded LascaMove should have a isStep field");const r=Me.getNonNullable(t.coords).map(s=>S.encoder.decode(s));return new Js(r,t.isStep)}};class $4 extends L1{static get(){return this.singleton.isAbsent()&&(this.singleton=T.of(new $4(nr))),this.singleton.get()}getCaptures(t){const e=t.getCurrentPlayer();return this.getCapturesOf(t,e)}getCapturesOf(t,e){const r=[],s=t.getStacksOf(e);for(const i of s)r.push(...this.getPieceCaptures(t,i));return r}getPieceCaptures(t,e){let r=[];const o=t.getPieceAt(e).getCommander().player.getOpponent(),c=this.getPieceDirections(t,e),u=t.getPieceAt(e);for(const d of c){const g=e.getNext(d,1);if(nr.isOnBoard(g)&&t.getPieceAt(g).isCommandedBy(o)){const m=g.getNext(d,1);if(nr.isOnBoard(m)&&t.getPieceAt(m).isEmpty()){const y=t.remove(e).remove(g).set(m,u),b=Js.fromCapture([e,m]).get(),k=this.getPieceCaptures(y,m);if(0===k.length)r=r.concat(b);else{const $=k.map(K=>b.concatenate(K));r=r.concat($)}}}}return r}getPieceDirections(t,e){const i=t.getPieceAt(e).getCommander().player.getScoreModifier(),o=[Ne.factory.fromDelta(-1,i).get(),Ne.factory.fromDelta(1,i).get()];return t.getPieceAt(e).getCommander().isOfficer&&o.push(Ne.factory.fromDelta(-1,-i).get(),Ne.factory.fromDelta(1,-i).get()),o}getSteps(t){const e=t.getCurrentPlayer();return this.getStepsOf(t,e)}getStepsOf(t,e){const r=[],s=t.getStacksOf(e);for(const i of s)r.push(...this.getPieceSteps(t,i));return r}getPieceSteps(t,e){const r=[],s=this.getPieceDirections(t,e);for(const i of s){const o=e.getNext(i,1);if(nr.isOnBoard(o)&&t.getPieceAt(o).isEmpty()){const c=Js.fromStep(e,o).get();r.push(c)}}return r}applyLegalMove(t,e,r){const s=t.getStartingCoord(),i=t.getEndingCoord();let o=e.getPieceAt(s),c=e.remove(s);if(!1===t.isStep)for(const u of t.getCapturedCoords().get()){const d=e.getPieceAt(u),g=d.getCommander();o=o.capturePiece(g);const m=d.getPiecesUnderCommander();c=c.set(u,m)}if(c=c.set(i,o),i.y===e.getFinishLineOf(e.getCurrentPlayer())){const u=o.promoteCommander();c=c.set(i,u)}return c.incrementTurn()}isLegal(t,e){const r=t.getStartingCoord();if(e.getPieceAt(r).isEmpty())return R.failure(et.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());const s=e.getPieceAt(r),i=e.getCurrentOpponent();if(s.isCommandedBy(i))return R.failure(et.CANNOT_CHOOSE_OPPONENT_PIECE());const o=t.coords.get(1);if(!1===s.getCommander().isOfficer&&r.getDirectionToward(o).get().y===i.getScoreModifier())return R.failure(_6.CANNOT_GO_BACKWARD());if(!1===e.getPieceAt(o).isEmpty())return R.failure(et.MUST_LAND_ON_EMPTY_SPACE());const c=this.getCaptures(e);return t.isStep?c.length>0?R.failure(_6.CANNOT_SKIP_CAPTURE()):R.SUCCESS:this.isLegalCapture(t,e,c)}isLegalCapture(t,e,r){const s=e.getCurrentPlayer(),i=t.getCapturedCoords().get();for(const o of i){const c=e.getPieceAt(o);if(c.isCommandedBy(s))return R.failure(et.CANNOT_SELF_CAPTURE());if(c.isEmpty())return R.failure(_6.CANNOT_CAPTURE_EMPTY_SPACE())}return r.some(o=>o.equals(t))?R.SUCCESS:R.failure(_6.MUST_FINISH_CAPTURING())}getGameStatus(t){const e=t.gameState;return this.getCaptures(e).length>0||this.getSteps(e).length>0?xe.ONGOING:xe.getVictory(e.getCurrentOpponent())}}$4.singleton=T.empty();class e_ extends k3{constructor(t){super($4.get(),t)}static getListMoves(t){const e=$4.get().getCaptures(t.gameState);return e.length>0?e:$4.get().getSteps(t.gameState)}getListMoves(t){return e_.getListMoves(t)}getBoardValue(t){const e=this.ruler.getGameStatus(t);if(e.isEndGame)return e.toBoardValue();const r=t.gameState,s=this.getNumberOfMobileCoords(r,B.ZERO),i=this.getNumberOfMobileCoords(r,B.ONE);return k1.from(s,i)}getNumberOfMobileCoords(t,e){const s=this.getCapturesAndSteps(t,e).map(o=>o.getStartingCoord());return new zt(s).size()}getCapturesAndSteps(t,e){const r=$4.get().getCapturesOf(t,e),s=$4.get().getStepsOf(t,e);return r.concat(s)}}class b0t extends e_{constructor(){super("Lasca Control And Domination Minimax")}getBoardValue(t){const e=this.ruler.getGameStatus(t);if(e.isEndGame)return e.toBoardValue();const r=12*super.getBoardValue(t).value;let s=0;for(let i=0;i<nr.SIZE;i++)for(let o=0;o<nr.SIZE;o++){const c=t.gameState.getPieceAtXY(o,i);if(c.getStackSize()>0){const u=c.getStackSize();let d=0;const g=c.getCommander().player;for(;d<u&&c.get(d).player===g;)d++;s+=d*g.getScoreModifier()}}return new k1(r+s)}}const M3e=ks.ZERO,UH=ks.ONE,Ls=new Vo([M3e]),mr=new Vo([UH]),O0t=new Vo([M3e,UH]),A0t=new Vo([ks.ZERO_OFFICER,UH]),re=Vo.EMPTY;class S3e extends $1{constructor(){super(...arguments),this.tutorial=[ie.informational($localize`Lasca: origins`,$localize`Lasca is a game based on draughts created in 1911 by Emanuel Lasker, chess world champion. It's played on a 7x7 board, each player has 11 pieces.`,nr.getInitialState()),ie.informational($localize`Goal of the game`,$localize`The goal of Lasca is, like for draughts, to render the opponent unable to move, either by capturing all his pieces, either by blocking them.`,nr.getInitialState()),ie.anyMove($localize`Steps`,$localize`A simple step is made by one diagonal move forward, left or right. Click on the chosen piece, then on its landing square.<br/><br/>You are playing Dark, do the first move.`,nr.getInitialState(),Js.fromStep(new S(4,4),new S(3,3)).get(),$localize`Congratulations!`),ie.anyMove($localize`Capture`,$localize`A capture happens when you jump diagonally over an opponent piece to land right behind it. You have to capture when you can. It is the case here, so click on the piece that must capture, and then on its landing square.<br/><br/>You're playing Dark, go ahead.`,nr.from([[mr,re,re,re,mr,re,mr],[re,re,re,mr,re,mr,re],[re,re,mr,re,mr,re,mr],[re,mr,re,re,re,re,re],[Ls,re,Ls,re,Ls,re,Ls],[re,Ls,re,Ls,re,Ls,re],[Ls,re,Ls,re,Ls,re,Ls]],2),Js.fromCapture([new S(2,4),new S(0,2)]).get(),$localize`Congratulations, notice that the captured piece was not removed from the board, but put below the capturing pieces.`),ie.anyMove($localize`Multiple captures`,$localize`If, after the beginning of your capture, the piece that you just moved can capture another piece, it has to capture until it can no longer capture. To do so, you must then click again on the next landing square. Note that, you cannot jump twice over the same stack.<br/><br/>You are playing Dark, a double capture is possible, go ahead.`,nr.from([[re,re,re,re,re,re,re],[re,re,re,re,re,re,re],[mr,re,re,re,mr,re,mr],[re,mr,re,mr,re,mr,re],[re,re,mr,re,mr,re,mr],[re,mr,re,re,re,re,re],[re,re,Ls,re,Ls,re,Ls]],2),Js.fromCapture([new S(2,6),new S(0,4),new S(2,2)]).get(),$localize`Congratulations!`),ie.informational($localize`Minority capture is allowed`,$localize`If you have several capture choices, you are allowed to choose any of them. For example if one choice is to capture one piece, and the other choice is to capture two pieces, you can choose either.`,nr.from([[re,re,re,re,re,re,re],[re,re,re,re,re,mr,re],[re,re,re,re,re,re,re],[re,mr,re,mr,re,re,re],[re,re,Ls,re,re,re,re],[re,re,re,re,re,re,re],[re,re,re,re,re,re,re]],2)),ie.fromMove($localize`Promotion`,$localize`When a stack reaches the last line, its commander becomes an officer, and gains the ability to go backward, which is illegal for the other pieces! One of your piece could be promoted now.<br/><br/>You're playing Dark. Do it.`,nr.from([[re,re,re,re,re,re,mr],[re,re,re,O0t,re,mr,re],[re,re,re,re,re,re,re],[re,re,re,re,re,re,re],[re,re,re,re,re,re,re],[re,re,re,re,re,re,re],[re,re,Ls,re,Ls,re,Ls]],2),[Js.fromStep(new S(3,1),new S(2,0)).get(),Js.fromStep(new S(3,1),new S(4,0)).get()],$localize`Congratulations!`,$localize`You did not choose the correct stack, and got no promotion.`),ie.fromMove($localize`Officer move`,$localize`Officers can move and capture backward as well as forward.<br/><br/>You're playing Dark, move your officier!`,nr.from([[re,re,re,re,A0t,re,mr],[re,re,re,re,re,re,re],[re,re,re,re,mr,re,re],[re,re,re,re,re,re,re],[re,re,re,re,re,re,re],[re,re,re,re,re,re,re],[re,re,Ls,re,Ls,re,Ls]],2),[Js.fromStep(new S(4,0),new S(3,1)).get(),Js.fromStep(new S(4,0),new S(5,1)).get()],$localize`Congratulations!`,$localize`You did not move your officer.`)]}}function N0t(n,t){if(1&n&&(F(),X(0,"circle",13)),2&n){const e=C(),r=e.index,s=e.$implicit,i=C().index,o=C().index,c=C();j2("id","square_",i,"_",o,"_piece_",r,"_officer_symbol"),w("ngClass",s.classes),z("cx",.4*c.SPACE_SIZE)("cy",.575*c.SPACE_SIZE)("r",.045*c.SPACE_SIZE)}}function I0t(n,t){if(1&n&&(F(),O(0,"g",10),X(1,"use",11),x(2,N0t,1,7,"circle",12),A()),2&n){const e=t.$implicit,r=t.index,s=C().index,i=C().index;z("transform",C().getPieceTranslate(r)),P(1),j2("id","square_",s,"_",i,"_piece_",r,""),w("ngClass",e.classes),P(1),w("ngIf",e.isOfficer)}}function x0t(n,t){if(1&n){const e=Oe();F(),O(0,"g")(1,"g",7),ee("click",function(){const i=ue(e).index,o=C().index;return ce(C().onClick(i,o))}),X(2,"polygon",8),x(3,I0t,3,6,"g",9),A()()}if(2&n){const e=t.$implicit,r=t.index,s=C().index,i=C();P(1),De("id","coord_",r,"_",s,""),z("transform",i.getTranslate(r,s,0)),P(1),De("id","square_",r,"_",s,""),w("ngClass",e.squareClasses),z("points",i.getParallelogramPoints()),P(1),w("ngForOf",e.pieceInfos)}}function k0t(n,t){if(1&n&&(F(),O(0,"g"),x(1,x0t,4,8,"g",4),A()),2&n){const e=t.$implicit;P(1),w("ngForOf",e)}}let L0t=(()=>{class n extends E3e{constructor(e){super(e),this.THICKNESS=40,this.mode={horizontalWidthRatio:1.2,offsetRatio:.4,pieceHeightRatio:1,parallelogramHeight:100,abstractBoardSize:nr.SIZE},this.LEFT=0,this.UP=-this.SPACE_SIZE,this.basicWidth=this.mode.abstractBoardSize*this.mode.parallelogramHeight,this.WIDTH=this.basicWidth*(this.mode.horizontalWidthRatio+this.mode.offsetRatio),this.HEIGHT=this.basicWidth+this.THICKNESS+this.STROKE_WIDTH-this.UP,this.CX=this.WIDTH/2,this.CY=(this.HEIGHT+this.UP)/2,this.adaptedBoard={isAlreadySwitched:!1,spaceInfo:[]},this.lastMove=T.empty(),this.currentMoveClicks=[],this.capturedCoords=[],this.legalMoves=[],this.hasAsymmetricBoard=!0,this.rules=$4.get(),this.availableMinimaxes=[new e_("Lasca Control Minimax"),new b0t],this.encoder=Js.encoder,this.tutorial=(new S3e).tutorial,this.canPass=!1,this.updateBoard()}updateBoard(){this.lastMove=this.rules.node.move;const e=this.getState();this.board=e.getCopiedBoard(),this.legalMoves=e_.getListMoves(this.rules.node),this.createAdaptedBoardFrom(e),this.showPossibleMoves(),this.rotateAdaptedBoardIfNeeded()}createAdaptedBoardFrom(e){this.adaptedBoard={isAlreadySwitched:!1,spaceInfo:[]};for(let i=0;i<nr.SIZE;i++){const o=[];for(let c=0;c<nr.SIZE;c++){const u=this.getSpaceInfo(e,c,i);o.push(u)}this.adaptedBoard.spaceInfo.push(o)}const s=T.ofNullable(this.currentMoveClicks[this.currentMoveClicks.length-1]);if(s.isPresent()){const i=s.get();for(const o of this.getSpaceInfoAt(i).pieceInfos)o.classes.push("selected-stroke");this.showPossibleLandings(i,e)}for(const i of this.capturedCoords)this.getSpaceInfoAt(i).squareClasses.push("captured-fill");for(const i of this.currentMoveClicks)this.getSpaceInfoAt(i).squareClasses.push("moved-fill")}getSpaceInfo(e,r,s){const i=e.getPieceAtXY(r,s),o=[];for(let c=i.getStackSize()-1;c>=0;c--){const u=i.get(c);o.push({classes:[this.getPlayerClass(u.player)],isOfficer:u.isOfficer})}return{pieceInfos:o,squareClasses:[]}}showLastMove(e){this.showLastCapture(e),this.showSteppedOnCoord(e)}showLastCapture(e){if(!1===e.isStep){const r=e.getCapturedCoords();Me.assert(r.isSuccess(),"Last move is a capture yet has illegal jumps !?");for(const s of r.get())this.getSpaceInfoAt(s).squareClasses.push("captured-fill")}}showSteppedOnCoord(e){for(const r of e.coords)this.getSpaceInfoAt(r).squareClasses.push("moved-fill")}showPossibleMoves(){for(const e of this.legalMoves){const r=e.getStartingCoord();this.getSpaceInfoAt(r).squareClasses.push("selectable-fill")}}getSpaceInfoAt(e){if(this.role===B.ONE&&this.adaptedBoard.isAlreadySwitched){const r=nr.SIZE-1,s=new S(r-e.x,r-e.y);return this.adaptedBoard.spaceInfo[s.y][s.x]}return this.adaptedBoard.spaceInfo[e.y][e.x]}rotateAdaptedBoardIfNeeded(){if(this.role===B.ONE){const e=[];for(let r=0;r<nr.SIZE;r++){e[nr.SIZE-1-r]=[];for(let s=0;s<nr.SIZE;s++)e[nr.SIZE-1-r][nr.SIZE-1-s]=this.getSpaceInfoAt(new S(s,r))}this.adaptedBoard={isAlreadySwitched:!0,spaceInfo:e}}}hideLastMove(){this.createAdaptedBoardFrom(this.getState()),this.rotateAdaptedBoardIfNeeded()}onClick(e,r){var s=this;return I(function*(){s.role===B.ONE&&(e=nr.SIZE-1-e,r=nr.SIZE-1-r);const i=s.canUserPlay("#coord_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());const o=new S(e,r),c=s.getState().getPieceAt(o),u=s.getState().getCurrentOpponent();return c.isCommandedBy(u)?s.cancelMove(et.CANNOT_CHOOSE_OPPONENT_PIECE()):0===s.currentMoveClicks.length?s.trySelectingPiece(o):s.moveClick(o)})()}cancelMoveAttempt(){this.currentMoveClicks=[],this.capturedCoords=[],this.createAdaptedBoardFrom(this.getState()),this.showPossibleMoves(),this.rotateAdaptedBoardIfNeeded()}moveClick(e){var r=this;return I(function*(){if(e.equals(r.currentMoveClicks[0]))return r.cancelMoveAttempt(),R.SUCCESS;const s=r.getState().getPieceAt(e),i=r.getState().getCurrentPlayer();if(s.isCommandedBy(i))return r.cancelMoveAttempt(),r.trySelectingPiece(e);if(1===r.currentMoveClicks.length&&r.currentMoveClicks[0].getVectorToward(e).isDiagonalOfLength(1)){const c=Js.fromStep(r.currentMoveClicks[0],e).get();return r.chooseMove(c,r.getState())}return r.capture(e)})()}capture(e){var r=this;return I(function*(){const i=r.currentMoveClicks[r.currentMoveClicks.length-1],o=i.getVectorToward(e);if(o.isDiagonalOfLength(2)){const c=new S(i.x+o.x/2,i.y+o.y/2);r.capturedCoords.push(c),r.currentMoveClicks.push(e);const u=Js.fromCapture(r.currentMoveClicks).get();return r.legalMoves.some(d=>d.isPrefix(u))?r.applyPartialCapture():r.chooseMove(u,r.getState())}return r.cancelMove(_6.CAPTURE_STEPS_MUST_BE_DOUBLE_DIAGONAL())})()}applyPartialCapture(){let e=this.getState().remove(this.currentMoveClicks[0]),r=this.getState().getPieceAt(this.currentMoveClicks[0]);for(const i of this.capturedCoords){const o=this.getState().getPieceAt(i),c=o.getCommander(),u=o.getPiecesUnderCommander();e=e.set(i,u),r=r.capturePiece(c)}return e=e.set(this.currentMoveClicks[this.currentMoveClicks.length-1],r),this.createAdaptedBoardFrom(e),this.rotateAdaptedBoardIfNeeded(),R.SUCCESS}trySelectingPiece(e){var r=this;return I(function*(){return r.getState().getPieceAt(e).isEmpty()?r.cancelMove(et.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):r.selectPiece(e)})()}selectPiece(e){return this.capturedCoords=[],this.legalMoves.some(r=>r.getStartingCoord().equals(e))?(this.currentMoveClicks=[e],this.hideLastMove(),R.SUCCESS):this.cancelMove(_6.THIS_PIECE_CANNOT_MOVE())}showPossibleLandings(e,r){const s=this.rules.getPieceCaptures(r,e);if(0===s.length){const i=this.rules.getPieceSteps(r,e);for(const o of i)this.getSpaceInfoAt(o.getEndingCoord()).squareClasses.push("selectable-fill")}else{const i=s.map(o=>o.coords.get(1));for(const o of i)this.getSpaceInfoAt(o).squareClasses.push("capturable-fill")}}getTranslate(e,r,s){const i=this.getCoordTranslate(e,r,s,this.mode);return"translate("+i.x+" "+i.y+")"}getParallelogramPoints(){return this.getParallelogramCoordsForLasca().map(r=>r.x+", "+r.y).join(" ")}getParallelogramCoordsForLasca(){return this.getParallelogramCoords(this.mode)}getParallelogramCenter(){const e=this.getParallelogramCoordsForLasca();return this.getParallelogramCenterOf(e[0],e[1],e[2],e[3])}getParallelogramCenterOf(e,r,s,i){const o=Math.max(e.x,r.x,s.x,i.x),c=Math.max(e.y,r.y,s.y,i.y),u=Math.min(e.x,r.x,s.x,i.x),d=Math.min(e.y,r.y,s.y,i.y);return new S((o-u)/2,(c-d)/2)}getRightEdge(){const e=this.basicWidth*this.mode.horizontalWidthRatio,r=this.basicWidth*this.mode.offsetRatio;return[r+e,0,r+e,this.THICKNESS,e,this.basicWidth+this.THICKNESS,e,this.basicWidth].join(" ")}getPieceTranslate(e){return"translate(0 "+(this.getParallelogramCenter().y-32.5-e*(.15*this.SPACE_SIZE))+")"}}return n.\u0275fac=function(e){return new(e||n)(J(En))},n.\u0275cmp=dt({type:n,selectors:[["app-lasca"]],features:[l],decls:8,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["id","piece"],["d","M 0 25 v 15 a 40 25, 0, 0, 0, 80 0 v -15 a 40 25, 0, 0, 0, -80 0 Z"],["cx","40","cy","25","rx","40","ry","25"],[4,"ngFor","ngForOf"],["x","0",1,"base"],[1,"base"],[3,"id","click"],[1,"base",3,"id","ngClass"],["pointer-events","fill","class","base mid-small-stroke",4,"ngFor","ngForOf"],["pointer-events","fill",1,"base","mid-small-stroke"],[0,"xlink","href","#piece",1,"base","mid-stroke",3,"id","ngClass"],[3,"id","ngClass",4,"ngIf"],[3,"id","ngClass"]],template:function(e,r){1&e&&(F(),O(0,"svg",0)(1,"defs")(2,"g",1),X(3,"path",2)(4,"ellipse",3),A()(),x(5,k0t,2,1,"g",4),X(6,"rect",5)(7,"polygon",6),A()),2&e&&(z("viewBox",r.LEFT+" "+r.UP+" "+r.WIDTH+" "+r.HEIGHT),P(5),w("ngForOf",r.adaptedBoard.spaceInfo),P(1),z("y",r.basicWidth)("width",r.basicWidth*r.mode.horizontalWidthRatio)("height",r.THICKNESS),P(1),z("points",r.getRightEdge()))},dependencies:[fn,On,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})(),ei=(()=>{class n extends Br{static getInitialState(){const e=he.NONE,r=he.ZERO,s=he.ONE;return new n([[e,r,r,r,r,r,r,e],[s,e,e,e,e,e,e,s],[s,e,e,e,e,e,e,s],[s,e,e,e,e,e,e,s],[s,e,e,e,e,e,e,s],[s,e,e,e,e,e,e,s],[s,e,e,e,e,e,e,s],[e,r,r,r,r,r,r,e]],0)}static isOnBoard(e){return e.isInRange(n.SIZE,n.SIZE)}}return n.SIZE=8,n})();class Wi extends c8{constructor(t,e,r){super(t,e),this.direction=r,this.direction=Ne.factory.fromMove(t,e).get()}static from(t,e){const r=Ne.factory.fromMove(t,e);return r.isFailure()?_e.failure(r.getReason()):t.isNotInRange(ei.SIZE,ei.SIZE)?_e.failure("start coord is not in range"):e.isNotInRange(ei.SIZE,ei.SIZE)?_e.failure("end coord is not in range"):_e.success(new Wi(t,e,r.get()))}equals(t){return t===this||!!t.getStart().equals(this.getStart())&&t.getEnd().equals(this.getEnd())}toString(){return"LinesOfActionMove("+this.getStart()+"->"+this.getEnd()+")"}encode(){return Wi.encoder.encode(this)}decode(t){return Wi.encoder.decode(t)}}Wi.encoder=no.getFallibleEncoder(Wi.from);let GH=(()=>{class n{}return n.INVALID_MOVE_LENGTH=()=>$localize`Your move should have a length equal to the number of pieces that exist on the same line.`,n.CANNOT_JUMP_OVER_OPPONENT=()=>$localize`You cannot jump over the opponent's pieces.`,n.PIECE_CANNOT_MOVE=()=>$localize`This piece has no possible move, select another one.`,n})();class ro extends L1{static getListMovesFromState(t){const e=[];if(ro.getVictory(t).isPresent())return e;for(let r=0;r<ei.SIZE;r++)for(let s=0;s<ei.SIZE;s++){const i=new S(s,r);if(t.getPieceAt(i).isPlayer())for(const c of ro.possibleTargets(t,i)){const u=Wi.from(i,c).get();e.push(u)}}return e}static getNumberOfGroups(t){const e=Xe.createTable(ei.SIZE,ei.SIZE,-1),r=[0,0];let s=0;for(let i=0;i<ei.SIZE;i++)for(let o=0;o<ei.SIZE;o++)if(-1===e[i][o]){const c=t.getPieceAt(new S(o,i));c.isPlayer()&&(s+=1,ro.markGroupStartingAt(t,e,new S(o,i),s),r[c.value]+=1)}return r}static markGroupStartingAt(t,e,r,s){const i=[r],o=t.getPieceAt(r);for(;i.length>0;){const c=Me.getNonNullable(i.pop());if(-1===e[c.y][c.x]){const u=t.getPieceAt(c);if(u===o){e[c.y][c.x]=s;for(const d of Ne.DIRECTIONS){const g=c.getNext(d);t.isOnBoard(g)&&i.push(g)}}else u===he.NONE&&(e[c.y][c.x]=0)}}}applyLegalMove(t,e,r){const s=e.getCopiedBoard();return s[t.getStart().y][t.getStart().x]=he.NONE,s[t.getEnd().y][t.getEnd().x]=e.getCurrentPlayer(),new ei(s,e.turn+1)}static isLegal(t,e){return e.getPieceAt(t.getStart())!==e.getCurrentPlayer()?R.failure(et.MUST_CHOOSE_PLAYER_PIECE()):t.length()!==this.numberOfPiecesOnLine(e,t.getStart(),t.direction)?R.failure(GH.INVALID_MOVE_LENGTH()):t.getStart().getCoordsToward(t.getEnd()).some(r=>e.getPieceAt(r)===e.getCurrentOpponent())?R.failure(GH.CANNOT_JUMP_OVER_OPPONENT()):e.getPieceAt(t.getEnd())===e.getCurrentPlayer()?R.failure(et.SHOULD_LAND_ON_EMPTY_OR_OPPONENT_SPACE()):R.SUCCESS}isLegal(t,e){return ro.isLegal(t,e)}static numberOfPiecesOnLine(t,e,r){let s=0;for(const i of ro.getLineCoords(e,r))t.getPieceAt(i).isPlayer()&&(s+=1);return s}static getLineCoords(t,e){const r=ro.getEntranceAndForwardDirection(t,e);let s=r[0];const i=r[1],o=[];for(;ei.isOnBoard(s);)o.push(s),s=s.getNext(i);return o}static getEntranceAndForwardDirection(t,e){switch(e){case Ne.UP:case Ne.DOWN:return[new S(t.x,0),Ne.DOWN];case Ne.LEFT:case Ne.RIGHT:return[new S(0,t.y),Ne.RIGHT];case Ne.UP_RIGHT:case Ne.DOWN_LEFT:return[new S(Math.max(0,t.x+t.y-7),Math.min(7,t.x+t.y)),Ne.UP_RIGHT];default:return Me.expectToBeMultiple(e,[Ne.UP_LEFT,Ne.DOWN_RIGHT]),[new S(t.x-Math.min(t.x,t.y),t.y-Math.min(t.x,t.y)),Ne.DOWN_RIGHT]}}static getVictory(t){const[e,r]=ro.getNumberOfGroups(t);return 1===e&&1===r?T.of(he.NONE):1===e?T.of(B.ZERO):1===r?T.of(B.ONE):T.empty()}static possibleTargets(t,e){const r=[];for(const s of Ne.DIRECTIONS){const i=ro.numberOfPiecesOnLine(t,e,s),o=e.getNext(s,i);if(t.isOnBoard(o)){const c=Wi.from(e,o).get();ro.isLegal(c,t).isSuccess()&&r.push(o)}}return r}getGameStatus(t){const e=t.gameState,[r,s]=ro.getNumberOfGroups(e);return 1===r&&s>1?xe.ZERO_WON:r>1&&1===s?xe.ONE_WON:xe.ONGOING}}class R0t extends xs{getListMoves(t){return ro.getListMovesFromState(t.gameState)}getMetrics(t){const e=t.gameState,[r,s]=ro.getNumberOfGroups(e);return[100/r,100/s]}}const Z=he.NONE,lr=he.ZERO,rr=he.ONE;class P3e{constructor(){this.tutorial=[ie.informational($localize`Goal of the game`,$localize`At Lines of Actions, the goal is to group your pieces contiguously, orthogonally and/or diagonally.
        Here, Dark wins the game:
        Dark's pieces are forming a single group, while Light's pieces form three groups.`,new ei([[Z,Z,Z,Z,Z,Z,Z,Z],[rr,Z,Z,Z,lr,Z,Z,rr],[Z,Z,lr,lr,rr,Z,Z,Z],[Z,Z,Z,lr,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z,Z]],0)),ie.anyMove($localize`Initial board and initial move`,$localize`Here is the initial board.
         Moves can be made orthogonally or diagonally.
         The length of a move is equal to the number of pieces that are on the line of the move.
         Note that there is a helping indicator to let you know where a piece can land when you select it.<br/><br/>
         You're playing Dark, make the first move!`,ei.getInitialState(),Wi.from(new S(1,7),new S(1,5)).get(),$localize`Congratulations!`),ie.fromMove($localize`Jumping`,$localize`During a move, it is possible to jump above your own pieces.
        But it is forbidden to jump over the opponent's pieces.<br/><br/>
        You're playing Dark, make a jump over one of your pieces on the following board.`,new ei([[Z,Z,Z,Z,Z,Z,Z,Z],[Z,Z,rr,lr,lr,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z,rr],[Z,Z,Z,Z,Z,Z,Z,lr]],0),[Wi.from(new S(3,1),new S(6,1)).get()],$localize`Congratulations!`,$localize`Failed. You did not jump over one of your pieces.`),ie.fromMove($localize`Moving`,$localize`Here is a different board. Pick the dark piece in the middle (line 4, column 4)
        and observe its possible moves.
        <ul>
            <li>Horizontally, this piece can move only of one square because it is the only piece on this line.</li>
            <li>Vertically, this piece can move of three squares because there are in total three pieces on that vertical line.
                But it can only go up, as below it the landing square is occupied by one of your pieces.</li>
            <li>Diagonally, only one move is possible: on the diagonal that contains three pieces,
                only in the direction where it does not jump over one of the opponent's pieces.
                On the other diagonal, there are too many pieces to end the move on the board.</li>
        </ul><br/>
        You're playing Dark, make one of these moves.`,new ei([[Z,Z,Z,Z,Z,Z,rr,Z],[Z,Z,Z,Z,Z,lr,Z,Z],[Z,Z,Z,Z,rr,Z,Z,Z],[Z,Z,Z,lr,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z,rr],[Z,Z,Z,Z,Z,rr,Z,rr],[Z,Z,Z,lr,Z,Z,rr,rr],[Z,Z,Z,lr,Z,Z,Z,Z]],0),[Wi.from(new S(3,3),new S(3,0)).get(),Wi.from(new S(3,3),new S(0,0)).get(),Wi.from(new S(3,3),new S(2,3)).get(),Wi.from(new S(3,3),new S(4,3)).get()],$localize`Congratulations!`,$localize`Failed. This was not one of the expected moves.`),ie.fromPredicate($localize`Capturing`,$localize`If a move ends on an opponent's piece, it is captured and removed from the board.
        However, a move cannot end on one of the player's pieces.
        Watch out, having less pieces at Lines of Action makes a victory easier, as there are less pieces to regroup!
        If a player has only one piece, that player wins the game.<br/><br/>
        On the following board, try to capture one piece with Dark.`,new ei([[Z,lr,Z,lr,lr,lr,lr,Z],[rr,Z,Z,Z,Z,Z,Z,rr],[Z,Z,lr,Z,rr,Z,Z,Z],[rr,Z,Z,Z,Z,Z,Z,rr],[rr,Z,Z,Z,Z,Z,Z,rr],[rr,Z,Z,Z,Z,Z,Z,rr],[rr,Z,Z,Z,Z,Z,Z,rr],[Z,lr,lr,lr,lr,lr,lr,Z]],0),Wi.from(new S(2,2),new S(4,2)).get(),(t,e,r)=>e.getPieceAt(t.getEnd())===he.ONE?R.SUCCESS:R.failure($localize`Failed. Try again.`),$localize`Congratulations!`),ie.fromMove($localize`Tie`,$localize`In the special case where a move ends up connecting all pieces of both player, simultaneously,
        then the game ends up with a tie.<br/><br/>
        You're playing Dark, force the tie in one move.`,new ei([[Z,Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z,Z],[lr,Z,Z,lr,rr,lr,Z,Z],[Z,Z,Z,lr,Z,Z,Z,rr],[Z,Z,Z,Z,Z,Z,Z,rr],[Z,Z,Z,Z,Z,Z,Z,rr],[Z,Z,Z,Z,Z,Z,Z,rr],[Z,Z,Z,Z,Z,Z,Z,Z]],0),[Wi.from(new S(0,2),new S(4,2)).get()],$localize`Congratulations!`,$localize`Failed. Try again.`)]}}function D0t(n,t){if(1&n&&(F(),X(0,"circle",4)),2&n){const e=C().index,r=C().index,s=C();De("id","piece_",e,"_",r,""),w("ngClass",s.getPieceClasses(e,r)),z("cx",s.SPACE_SIZE/2+e*s.SPACE_SIZE)("cy",s.SPACE_SIZE/2+r*s.SPACE_SIZE)("r",s.SPACE_SIZE/2-s.STROKE_WIDTH)}}function z0t(n,t){if(1&n){const e=Oe();F(),O(0,"g")(1,"g",3),ee("click",function(){const i=ue(e).index,o=C().index;return ce(C().onClick(i,o))}),X(2,"rect",4),x(3,D0t,1,6,"circle",5),A()()}if(2&n){const e=t.$implicit,r=t.index,s=C().index,i=C();P(1),De("id","click_",r,"_",s,""),P(1),De("id","space_",r,"_",s,""),w("ngClass",i.getSquareClasses(r,s)),z("x",r*i.SPACE_SIZE)("y",s*i.SPACE_SIZE)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),P(1),w("ngIf",e!==i.EMPTY)}}function V0t(n,t){if(1&n&&(F(),O(0,"g"),x(1,z0t,4,10,"g",1),A()),2&n){const e=t.$implicit;P(1),w("ngForOf",e)}}function H0t(n,t){if(1&n){const e=Oe();F(),O(0,"rect",6),ee("click",function(){const i=ue(e).$implicit;return ce(C().onClick(i.x,i.y))}),A()}if(2&n){const e=t.$implicit,r=C();z("x",e.x*r.SPACE_SIZE+(r.SPACE_SIZE/2-r.INDICATOR_SIZE/2))("y",e.y*r.SPACE_SIZE+(r.SPACE_SIZE/2-r.INDICATOR_SIZE/2))("width",r.INDICATOR_SIZE)("height",r.INDICATOR_SIZE)}}let F0t=(()=>{class n extends ko{constructor(e){super(e),this.INDICATOR_SIZE=20,this.EMPTY=he.NONE,this.targets=[],this.selected=T.empty(),this.lastMove=T.empty(),this.captured=T.empty(),this.rules=new ro(ei),this.availableMinimaxes=[new R0t(this.rules,"LinesOfActionMinimax")],this.encoder=Wi.encoder,this.tutorial=(new P3e).tutorial,this.updateBoard()}onClick(e,r){var s=this;return I(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());const o=new S(e,r);if(s.selected.equalsValue(o))return s.cancelMoveAttempt(),R.SUCCESS;const c=s.getState().getCurrentPlayer();return s.selected.isAbsent()||s.getState().getPieceAt(o)===c?s.select(o):s.concludeMove(o)})()}concludeMove(e){var r=this;return I(function*(){const s=Wi.from(r.selected.get(),e);return s.isSuccess()?r.chooseMove(s.get(),r.rules.node.gameState):r.cancelMove(s.getReason())})()}select(e){var r=this;return I(function*(){return r.getState().getPieceAt(e)!==r.getState().getCurrentPlayer()?r.cancelMove(et.MUST_CHOOSE_PLAYER_PIECE()):(r.selected=T.of(e),r.targets=ro.possibleTargets(r.getState(),r.selected.get()),0===r.targets.length?r.cancelMove(GH.PIECE_CANNOT_MOVE()):R.SUCCESS)})()}updateBoard(){this.cancelMoveAttempt(),this.board=this.getState().board,this.lastMove=this.rules.node.move}showLastMove(e){this.captured=this.getPreviousState().getPieceAt(e.getEnd()).isPlayer()?T.of(e.getEnd()):T.empty()}cancelMoveAttempt(){this.selected=T.empty(),this.targets=[]}getSquareClasses(e,r){const s=new S(e,r);if(this.lastMove.isPresent()){const i=this.lastMove.get().getStart(),o=this.lastMove.get().getEnd();if(this.captured.isPresent()&&s.equals(this.captured.get()))return["captured-fill"];if(s.equals(i)||s.equals(o))return["moved-fill"]}return[]}getPieceClasses(e,r){const s=this.board[r][e],i=new S(e,r),o=[this.getPlayerClass(s)];return this.selected.isPresent()&&this.selected.get().equals(i)&&o.push("selected-stroke"),o}}return n.\u0275fac=function(e){return new(e||n)(J(En))},n.\u0275cmp=dt({type:n,selectors:[["app-linesofaction"]],features:[l],decls:3,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","0 -4 800 808","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","indicator",3,"click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base",3,"id","ngClass"],["class","base",3,"id","ngClass",4,"ngIf"],[1,"indicator",3,"click"]],template:function(e,r){1&e&&(F(),O(0,"svg",0),x(1,V0t,2,1,"g",1),x(2,H0t,1,4,"rect",2),A()),2&e&&(P(1),w("ngForOf",r.board),P(1),w("ngForOf",r.targets))},dependencies:[fn,On,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class U4 extends Ks{constructor(t,e,r,s={top:0,bottom:0,left:0,right:0}){super(t.x,t.y),this.direction=e,this.orientation=r,this.captures=s}toString(){return`LodestoneMove(${this.coord.toString()}, ${this.direction}, ${this.orientation}, { top: ${this.captures.top}, bottom: ${this.captures.bottom}, left: ${this.captures.left}, right: ${this.captures.right} })`}equals(t){return this===t||!(!1===this.coord.equals(t.coord)||this.orientation!==t.orientation||this.direction!==t.direction||this.captures.top!==t.captures.top||this.captures.bottom!==t.captures.bottom||this.captures.left!==t.captures.left||this.captures.right!==t.captures.right)}}U4.encoder=new class extends Nt{encodeMove(n){return{coord:S.encoder.encode(n.coord),direction:n.direction,orientation:n.orientation,captures:n.captures}}decodeMove(n){const t=n;return Pe(null!=t.coord,"Invalid encoded LodestoneMove"),Pe(null!=t.direction,"Invalid encoded LodestoneMove"),Pe(null!=t.orientation,"Invalid encoded LodestoneMove"),Pe(null!=t.captures,"Invalid encoded LodestoneMove"),new U4(S.encoder.decode(t.coord),t.direction,t.orientation,t.captures)}};class so{constructor(t){this.unreachable=t}isLodestone(){return!1}isPlayerPiece(){return!1}isEmpty(){return!0}isUnreachable(){return this.unreachable}equals(t){return this===t}}so.UNREACHABLE=new so(!0),so.EMPTY=new so(!1);class qc{constructor(t){this.owner=t}static of(t){return t===B.ZERO?qc.ZERO:qc.ONE}isLodestone(){return!1}isPlayerPiece(){return!0}isEmpty(){return!1}isUnreachable(){return!1}equals(t){return this===t}}qc.ZERO=new qc(B.ZERO),qc.ONE=new qc(B.ONE);class Ho{constructor(t,e,r){this.owner=t,this.direction=e,this.orientation=r}static of(t,e){return Ho.LODESTONES[t.value][e.direction][e.orientation]}isLodestone(){return!0}isPlayerPiece(){return!1}isEmpty(){return!1}isUnreachable(){return!1}equals(t){return this===t}}Ho.LODESTONES={0:{push:{diagonal:new Ho(B.ZERO,"push","diagonal"),orthogonal:new Ho(B.ZERO,"push","orthogonal")},pull:{diagonal:new Ho(B.ZERO,"pull","diagonal"),orthogonal:new Ho(B.ZERO,"pull","orthogonal")}},1:{push:{diagonal:new Ho(B.ONE,"push","diagonal"),orthogonal:new Ho(B.ONE,"push","orthogonal")},pull:{diagonal:new Ho(B.ONE,"pull","diagonal"),orthogonal:new Ho(B.ONE,"pull","orthogonal")}}};class _r{constructor(t,e){this.width=t,this.pieces=e}remainingSpaces(){return 5===this.width?8-this.pieces.length:3-this.pieces.length}addCaptured(t,e){if(this.pieces.length+e>=this.width)return 5===this.width?_r.EMPTY_3.addCaptured(t,e+this.pieces.length-5):(Pe(this.pieces.length+e===3,"should never put more pieces than the plate can support"),T.empty());{const r=Xe.copyImmutableArray(this.pieces);for(let s=0;s<e;s++)r.push(qc.of(t));return T.of(new _r(this.width,r))}}getPieceAt(t){return t<this.pieces.length?this.pieces[t]:so.EMPTY}}_r.POSITIONS=["top","bottom","left","right"],_r.EMPTY_5=new _r(5,[]),_r.EMPTY_3=new _r(3,[]);let sr=(()=>{class n extends Br{constructor(e,r,s,i){super(e,r),this.lodestones=s,this.pressurePlates=i}static getInitialState(){const e=so.EMPTY,r=qc.ZERO,s=qc.ONE;return new n([[e,e,r,s,r,s,e,e],[e,r,s,r,s,r,s,e],[r,s,r,s,r,s,r,s],[s,r,s,e,e,r,s,r],[r,s,r,e,e,s,r,s],[s,r,s,r,s,r,s,r],[e,s,r,s,r,s,r,e],[e,e,s,r,s,r,e,e]],0,new Un,{top:T.of(_r.EMPTY_5),bottom:T.of(_r.EMPTY_5),left:T.of(_r.EMPTY_5),right:T.of(_r.EMPTY_5)})}withBoard(e){return new n(e,this.turn,this.lodestones,this.pressurePlates)}remainingSpaces(){const e=this.remainingSpacesDetails();return e.top+e.bottom+e.left+e.right}remainingSpacesDetails(){const e={top:0,bottom:0,left:0,right:0};for(const r of _r.POSITIONS){const s=this.pressurePlates[r];s.isPresent()&&(e[r]=s.get().remainingSpaces())}return e}numberOfPieces(){const e=[0,0];for(let r=0;r<n.SIZE;r++)for(let s=0;s<n.SIZE;s++){const i=this.getPieceAtXY(s,r);i.isPlayerPiece()&&(e[i.owner.value]+=1)}return e}getScores(){const e=this.numberOfPieces();return[24-e[1],24-e[0]]}nextLodestoneDirection(){const e=this.getCurrentPlayer(),r=this.lodestones.get(e);if(!r.isPresent())return T.empty();{const s=this.getPieceAt(r.get());switch(Pe(s.isLodestone(),"Piece must be lodestone (invariant from LodestoneState)"+r.get()),s.direction){case"push":return T.of("pull");case"pull":return T.of("push")}}}}return n.SIZE=8,n})();const je=so.UNREACHABLE,de=so.EMPTY,_s=qc.ZERO,io=qc.ONE,t_=Ho.of(B.ONE,{direction:"push",orientation:"orthogonal"}),WH={top:T.of(_r.EMPTY_5),bottom:T.of(_r.EMPTY_5),left:T.of(_r.EMPTY_5),right:T.of(_r.EMPTY_5)};class T3e extends $1{constructor(){super(...arguments),this.tutorial=[ie.informational($localize`Board and aim of the game`,$localize`Lodestone is played on a 8x8 board, which contains so-called <i>pressure plates</i> along the board, that will contain captured pieces. The initial board is shown here. The aim of the game is to be the only player with pieces remaining on the board. To do so, you will have to either push your opponent's pieces off the board, or to crush them with your pieces. You will do it by using a lodestone.`,sr.getInitialState()),ie.forClick($localize`Selecting a lodestone`,$localize`To perform a move, you have to place your lodestone on the board. Your lodestone has two sides: <ul><li>its <i>repelling</i> side with which it will repel the opponent's pieces (indicated by the outward triangles of your opponent's color on the lodestone), and</li><li>its <i>attracting</i> side with which it will attract your pieces (indicated by the inward triangles of your color on the lodestone).</li></ul>Your lodestone can be placed to move pieces orthogonally or diagonally. All available lodestone sides and orientation are shown below the board.<br/><br/>You're playing Dark. Select the lodestone that repels your opponent's pieces diagonally.`,sr.getInitialState(),["#lodestone_push_diagonal"],$localize`Congratulations!`,$localize`This is not the right lodestone, try again.`),ie.informational($localize`The repelling lodestone`,$localize`Upon placing a lodestone on the board, it will move all pieces it acts upon (according to its direction and orientation) simultaneously. Let us first see how the repelling lodestone acts on the pieces. All the opponent's pieces aligned with the lodestone, as indicated by the triangles' orientations, will be pushed one square away from the lodestone. An opponent's piece will be blocked in case it encounters on its way either one of your piece, a lodestone, or another blocked piece. Finally, if an opponent's piece falls out of the board, it is captured.`,sr.getInitialState()),ie.informational($localize`The attracting lodestone`,$localize`When the lodestone is on its attracting side it will pull your pieces one square towards it. In case one of your pieces encounters a lodestone on its way or another blocked piece, it is blocked. However, if it encounter an opponent's piece, it will capture it.`,sr.getInitialState()),ie.informational($localize`Flipping the lodestone`,$localize`Note that, after every move, you must flip your lodestone: if it was on its repelling side, you must use it on its attracting side, and vice versa. Also, you are allowed to place your lodestone on the same location as it was on your previous turn.`,sr.getInitialState()),ie.fromPredicate($localize`Capturing`,$localize`To summarize, it is possible to capture the opponent's pieces in two ways:<ul><li>with a repelling lodestone, by pushing your opponent's pieces out of the board, or</li><li>with an attracting lodestone, by moving your pieces on your opponent's pieces.</li></ul>Once a lodestone is placed and the pieces have been moved and/or captured, in case any of the opponent's pieces have been captured, you have to place them on the <i>pressure plates</i> that lie around the board. To do so, click on an empty space of the pressure plate of your choice for each capture. You can cancel this by clicking again on a piece you just put on a pressure plate.<br/><br/>You're playing Dark. Try to perform a move that captures at least one of your opponent's piece, and place your capture(s) on pressure plates.`,sr.getInitialState(),new U4(new S(0,6),"pull","orthogonal",{top:2,bottom:1,left:1,right:1}),(t,e,r)=>32===r.remainingSpaces()?R.failure($localize`You have not captured any of the opponent's pieces, try again!`):R.SUCCESS,$localize`Congratulations!`),ie.fromPredicate($localize`Crumbling a first pressure plate`,$localize`When a pressure plate is full, it will crumble and take a full row or column of the board with it! All pieces that are on the crumbled squares are considered lost, but will not have to be placed on pressure plates. You have here a board with a pressure plate that only requires one more piece to crumble.<br/><br/>You're playing Dark. Perform a move that captures at least one piece, and fill that pressure plate to make it crumble.`,new sr([[de,de,de,de,io,de,de,de],[de,de,_s,de,de,io,de,de],[de,de,t_,de,de,de,de,_s],[de,de,de,de,io,de,de,_s],[de,de,de,de,de,_s,de,de],[de,de,de,de,de,de,de,de],[de,de,de,de,de,de,de,de],[de,de,de,de,de,de,de,de]],0,new Un([{key:B.ONE,value:new S(2,2)}]),{...WH,top:_r.EMPTY_5.addCaptured(B.ONE,4)}),new U4(new S(6,2),"push","diagonal",{top:1,bottom:0,left:0,right:0}),(t,e,r)=>5===r.pressurePlates.top.get().width?R.failure($localize`You must capture and place your capture on the top pressure plate to make it crumble!`):R.SUCCESS,$localize`Congratulations!`),ie.fromPredicate($localize`Crumbling a second pressure plate`,$localize`Once a pressure plate has crumbled, a shorter pressure plate takes it place. It is the case here, where only 3 spots are available on the top pressure plate.<br/><br/>You're playing Dark. Perform a move that captures enough pieces to fill the top pressure plate, and make it crumble.`,new sr([[je,je,je,je,je,je,je,je],[de,de,de,de,de,de,de,de],[de,de,de,de,de,de,de,_s],[de,de,de,de,de,_s,de,_s],[de,t_,de,de,io,de,de,de],[de,de,de,de,de,de,de,de],[de,de,de,de,io,de,de,de],[de,de,de,de,de,de,de,de]],0,new Un([{key:B.ONE,value:new S(1,4)}]),{...WH,top:_r.EMPTY_3.addCaptured(B.ONE,2)}),new U4(new S(3,5),"pull","diagonal",{top:1,bottom:0,left:0,right:0}),(t,e,r)=>r.pressurePlates.top.isPresent()?R.failure($localize`You must capture and place your capture on the top pressure plate to make it crumble a second time!`):R.SUCCESS,$localize`Congratulations!`),ie.informational($localize`Minimal board`,$localize`After a pressure plate has crumbled for a second time, there is no more pressure plate available on that side. In case all pressure plates have crumbled, the board is reduced to a 4x4 board.`,new sr([[je,je,je,je,je,je,je,je],[je,je,je,je,je,je,je,je],[je,je,_s,io,de,de,je,je],[je,je,t_,io,de,de,je,je],[je,je,de,_s,_s,de,je,je],[je,je,_s,de,de,de,je,je],[je,je,je,je,je,je,je,je],[je,je,je,je,je,je,je,je]],0,new Un([{key:B.ONE,value:new S(2,3)}]),{top:T.empty(),bottom:T.empty(),left:T.empty(),right:T.empty()})),ie.fromMove($localize`Making the lodestone fall`,$localize`If, at any point during the game, your lodestone is situated on a square that crumbles with a pressure plate, you will be allowed to select any lodestone side on your next turn.<br/><br/>In this board, playing Dark, you can place your lodestone and make a pressure plate crumble so that your lodestone falls too, allowing to choose more freely its side on your next turn. Do it!`,new sr([[de,de,de,de,de,de,de,de],[de,de,de,de,de,io,de,de],[de,de,de,t_,de,de,_s,de],[de,de,_s,_s,io,de,de,_s],[de,de,de,de,de,_s,de,de],[de,de,_s,de,de,de,de,de],[de,de,io,de,de,de,de,de],[de,de,de,de,de,de,de,de]],0,new Un([{key:B.ONE,value:new S(3,2)}]),{...WH,top:_r.EMPTY_5.addCaptured(B.ONE,4)}),[new U4(new S(4,0),"pull","diagonal",{top:1,bottom:0,left:0,right:0})],$localize`Congratulations! At your next turn, you will be allowed to place your lodestone on any side.`,$localize`Failed, try again.`),ie.fromMove($localize`End of the game`,$localize`In order to win, you must take out all of your opponent's pieces.<br/><br/>Here, you can win in a single move, do it!`,new sr([[je,je,je,je,je,je,je,je],[je,je,je,je,je,je,je,je],[je,io,_s,io,de,de,je,je],[je,io,t_,de,io,de,je,je],[je,de,de,_s,_s,de,je,je],[je,io,_s,de,io,de,je,je],[je,de,de,de,_s,de,je,je],[je,je,je,je,je,je,je,je]],0,new Un([{key:B.ONE,value:new S(2,3)}]),{top:T.empty(),bottom:_r.EMPTY_3.addCaptured(B.ZERO,2),left:T.of(_r.EMPTY_3),right:T.empty()}),[new U4(new S(4,2),"pull","orthogonal",{top:0,bottom:0,left:3,right:0})],$localize`Congratulations, you won!`,$localize`This is not the winning move. Try again.`)]}}let kd=(()=>{class n{}return n.MUST_FLIP_LODESTONE=()=>$localize`You must flip your lodestone before putting it back on the board.`,n.MUST_PLACE_CAPTURES_ON_PRESSURE_PLATES=()=>$localize`As long as there are pressure plates, you must place all the pieces that you have captured on them.`,n.TARGET_IS_CRUMBLED=()=>$localize`You must place your lodestone on a non-crumbled square!`,n.TOO_MANY_CAPTURES_ON_SAME_PRESSURE_PLATE=()=>$localize`You placed too many captures on the same pressure plate, which has not enough space left.`,n.MUST_PLACE_CAPTURES=()=>$localize`You must place your captures on the pressure plates, on the side of the board.`,n.NO_CAPTURES_TO_PLACE_YET=()=>$localize`You cannot place any capture now, you must first place your lodestone on the board!`,n})();class L2 extends L1{constructor(){super(sr)}static get(){return L2.singleton.isAbsent()&&(L2.singleton=T.of(new L2)),L2.singleton.get()}applyLegalMove(t,e,r){const s=e.getCurrentPlayer(),i=s.getOpponent(),o=Xe.copyBiArray(r.board),c=e.lodestones.getCopy();c.put(s,t.coord);const u={...e.pressurePlates};return this.updatePressurePlates(o,u,c,i,t.captures),new sr(o,e.turn+1,c,u)}updatePressurePlates(t,e,r,s,i){for(const o of _r.POSITIONS)e[o]=this.updatePressurePlate(t,o,e[o],r,s,i[o])}updatePressurePlate(t,e,r,s,i,o){if(r.isPresent()){const c=r.get().addCaptured(i,o),u=L2.THREATENED_COORD_RANGE.get(e).get();return c.isAbsent()?(this.removePressurePlate(t,u.startForBigPlate,u.direction,s),this.removePressurePlate(t,u.startForSmallPlate,u.direction,s)):c.get().width<r.get().width&&this.removePressurePlate(t,u.startForBigPlate,u.direction,s),c}return r}removePressurePlate(t,e,r,s){for(let i=e;i.isInRange(sr.SIZE,sr.SIZE);i=i.getNext(r)){for(const o of B.PLAYERS)s.get(o).equalsValue(i)&&s.delete(o);t[i.y][i.x]=so.UNREACHABLE}}isLegal(t,e){const r=this.isLegalWithoutCaptures(e,t.coord,t.direction);if(r.isFailure())return _e.failure(r.getReason());const s=this.applyMoveWithoutPlacingCaptures(e,t.coord,t);if(t.captures.top+t.captures.bottom+t.captures.left+t.captures.right!==Math.min(s.captures.length,e.remainingSpaces()))return _e.failure(kd.MUST_PLACE_CAPTURES_ON_PRESSURE_PLATES());for(const c of _r.POSITIONS){const u=e.pressurePlates[c];if(u.isPresent()&&u.get().remainingSpaces()<t.captures[c])return _e.failure(kd.TOO_MANY_CAPTURES_ON_SAME_PRESSURE_PLATE())}return _e.success(s)}applyMoveWithoutPlacingCaptures(t,e,r){let s;const i=Xe.copyBiArray(t.board),o=t.lodestones.get(t.getCurrentPlayer());if(o.isPresent()){const c=o.get();i[c.y][c.x]=so.EMPTY}return s="pull"===r.direction?this.applyPull(t,i,e,r.orientation):this.applyPush(t,i,e,r.orientation),s.board[e.y][e.x]=Ho.of(t.getCurrentPlayer(),r),s.moved.push(e),s}applyPull(t,e,r,s){const i=t.getCurrentPlayer(),o=i.getOpponent(),c=[],u=[],d="diagonal"===s?Ne.DIAGONALS:Ne.ORTHOGONALS;for(const g of d)for(let m=r.getNext(g);t.isOnBoard(m);m=m.getNext(g)){const y=e[m.y][m.x],b=m.getNext(g);if(t.isOnBoard(b)){const k=e[b.y][b.x];k.isPlayerPiece()&&k.owner===i&&(y.isEmpty()?(u.push(m),e[m.y][m.x]=k,u.push(b),e[b.y][b.x]=so.EMPTY):y.isPlayerPiece()&&y.owner===o&&(c.push(m),e[m.y][m.x]=k,u.push(b),e[b.y][b.x]=so.EMPTY))}}return{board:e,captures:c,moved:u}}applyPush(t,e,r,s){const o=t.getCurrentPlayer().getOpponent(),c=[],u=[],d="diagonal"===s?Ne.DIAGONALS:Ne.ORTHOGONALS;for(const g of d)for(let y=r.getNext(g,sr.SIZE);!1===y.equals(r);y=y.getPrevious(g))if(t.isOnBoard(y)){const b=e[y.y][y.x];if(b.isPlayerPiece()&&b.owner===o){const k=y.getNext(g);if(t.isOnBoard(k)){const $=e[k.y][k.x];$.isUnreachable()?(c.push(y),e[y.y][y.x]=so.EMPTY):$.isEmpty()&&(u.push(k),e[k.y][k.x]=b,u.push(y),e[y.y][y.x]=so.EMPTY)}else c.push(y),e[y.y][y.x]=so.EMPTY}}return{board:e,captures:c,moved:u}}isLegalWithoutCaptures(t,e,r){const s=this.isTargetLegal(t,e);if(s.isFailure())return s;const i=t.nextLodestoneDirection();return!1===(i.isAbsent()||i.equalsValue(r))?R.failure(kd.MUST_FLIP_LODESTONE()):R.SUCCESS}isTargetLegal(t,e){const r=t.getPieceAt(e);if(r.isUnreachable())return R.failure(kd.TARGET_IS_CRUMBLED());if(r.isPlayerPiece())return R.failure(et.MUST_CLICK_ON_EMPTY_SQUARE());const s=t.getCurrentPlayer();return r.isLodestone()&&r.owner!==s?R.failure(et.MUST_CLICK_ON_EMPTY_SQUARE()):R.SUCCESS}getGameStatus(t){const r=t.gameState.numberOfPieces();return 0===r[0]&&0===r[1]?xe.DRAW:0===r[0]?xe.ONE_WON:0===r[1]?xe.ZERO_WON:xe.ONGOING}}L2.THREATENED_COORD_RANGE=Un.from({top:{startForBigPlate:new S(0,0),startForSmallPlate:new S(0,1),direction:Ne.RIGHT},bottom:{startForBigPlate:new S(0,sr.SIZE-1),startForSmallPlate:new S(0,sr.SIZE-2),direction:Ne.RIGHT},left:{startForBigPlate:new S(0,0),startForSmallPlate:new S(1,0),direction:Ne.DOWN},right:{startForBigPlate:new S(sr.SIZE-1,0),startForSmallPlate:new S(sr.SIZE-2,0),direction:Ne.DOWN}}),L2.singleton=T.empty();class B0t extends k3{getListMoves(t){const e=t.gameState;return this.flatMapEmptyCoords(e,r=>{const s=[];for(const i of this.nextDirection(e)){const o=["diagonal","orthogonal"];for(const c of o){const g=L2.get().applyMoveWithoutPlacingCaptures(e,r,{direction:i,orientation:c}).captures.length;for(const m of this.captureCombinations(e,g))s.push(new U4(r,i,c,m))}}return s})}captureCombinations(t,e){if(0===e)return new zt([{top:0,bottom:0,left:0,right:0}]);{const r=new zt,s=t.remainingSpacesDetails(),i=this.captureCombinations(t,e-1);for(const o of i)o.top+1<=s.top&&r.add({...o,top:o.top+1}),o.bottom+1<=s.bottom&&r.add({...o,bottom:o.bottom+1}),o.left+1<=s.left&&r.add({...o,left:o.left+1}),o.right+1<=s.right&&r.add({...o,right:o.right+1});return 0===r.size()?i:r}}flatMapEmptyCoords(t,e){let r=[];for(let s=0;s<sr.SIZE;s++)for(let i=0;i<sr.SIZE;i++){const o=new S(i,s),c=t.getPieceAt(o);(c.isEmpty()&&!1===c.isUnreachable()||c.isLodestone()&&c.owner===t.getCurrentPlayer())&&(r=r.concat(e(o)))}return r}nextDirection(t){const e=t.nextLodestoneDirection();return e.isPresent()?[e.get()]:["push","pull"]}getBoardValue(t){const e=t.gameState.getScores();let r;return r=24===e[0]&&24!==e[1]?B.ZERO.getVictoryValue():24!==e[0]&&24===e[1]?B.ONE.getVictoryValue():k1.from(e[0],e[1]).value,new k1(r)}}function $0t(n,t){if(1&n&&(F(),X(0,"circle",10)),2&n){const e=C(2),r=e.index,s=e.$implicit,i=C().index,o=C();De("id","piece_",r,"_",i,""),w("ngClass",s.pieceClasses),z("r",o.PIECE_RADIUS)("cx",o.SPACE_SIZE*r+o.STROKE_WIDTH+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*i+o.STROKE_WIDTH+o.SPACE_SIZE/2)}}function U0t(n,t){if(1&n&&(F(),X(0,"polygon",15)),2&n){const e=C().$implicit,r=C(3).$implicit,s=C(2);Cu("transform","rotate(",90*e,")"),w("ngClass",r.lodestone.movingClass),z("points",s.TRIANGLE_OUT)}}function G0t(n,t){if(1&n&&(F(),X(0,"polygon",15)),2&n){const e=C().$implicit,r=C(3).$implicit,s=C(2);Cu("transform","rotate(",90*e,")"),w("ngClass",r.lodestone.movingClass),z("points",s.TRIANGLE_IN)}}function W0t(n,t){if(1&n&&(F(),O(0,"g"),x(1,U0t,1,3,"polygon",14),x(2,G0t,1,3,"polygon",14),A()),2&n){const e=C(3).$implicit;P(1),w("ngIf","push"===e.lodestone.direction),P(1),w("ngIf","pull"===e.lodestone.direction)}}const w3e=function(){return[0,1,2,3]};function q0t(n,t){if(1&n&&(F(),O(0,"g",11),X(1,"circle",12)(2,"circle",13),O(3,"g"),x(4,W0t,3,2,"g",1),A()()),2&n){const e=C(2),r=e.index,s=e.$implicit,i=C().index,o=C();z("transform",o.getSquareTransform(r,i)),P(1),w("ngClass",s.lodestone.selectedClass),z("r",o.PIECE_RADIUS),P(1),w("ngClass",s.lodestone.pieceClasses),z("r",o.PIECE_RADIUS/4),P(1),Cu("transform","rotate(","diagonal"===s.lodestone.orientation?45:0,")"),P(1),w("ngForOf",J1(7,w3e))}}function j0t(n,t){if(1&n){const e=Oe();F(),O(0,"g",6),ee("click",function(){ue(e);const s=C().$implicit;return ce(C(2).selectCoord(s.coord))}),X(1,"rect",7),x(2,$0t,1,6,"circle",8),x(3,q0t,5,8,"g",9),A()}if(2&n){const e=C(),r=e.index,s=e.$implicit,i=C().index,o=C();De("id","square_",r,"_",i,""),P(1),w("ngClass",s.squareClasses),z("x",o.SPACE_SIZE*r+o.STROKE_WIDTH)("y",o.SPACE_SIZE*i+o.STROKE_WIDTH)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),P(1),w("ngIf",s.hasPiece),P(1),w("ngIf",s.lodestone)}}function Z0t(n,t){if(1&n&&(F(),O(0,"g"),x(1,j0t,4,9,"g",5),A()),2&n){const e=t.$implicit;P(1),w("ngIf",!1===e.crumbled)}}function Y0t(n,t){if(1&n&&(F(),O(0,"g"),x(1,Z0t,2,1,"g",1),A()),2&n){const e=t.$implicit;P(1),w("ngForOf",e)}}function K0t(n,t){if(1&n&&(F(),O(0,"g",16),X(1,"circle",17),A()),2&n){const e=t.$implicit,r=t.index,s=C();y1("id","capture_",r,""),z("transform",s.getCaptureTransform(r)),P(1),w("ngClass",e.pieceClasses),z("r",s.PIECE_RADIUS)}}function X0t(n,t){if(1&n&&(F(),O(0,"g"),X(1,"polygon",15),A()),2&n){const e=t.$implicit,r=C().$implicit,s=C();P(1),Cu("transform","rotate(",90*e,")"),w("ngClass",r.movingClass),z("points","push"===r.direction?s.TRIANGLE_OUT:s.TRIANGLE_IN)}}function Q0t(n,t){if(1&n){const e=Oe();F(),O(0,"g",6),ee("click",function(){const i=ue(e).$implicit;return ce(C().selectLodestone(i))}),X(1,"circle",12)(2,"circle",13),O(3,"g"),x(4,X0t,2,3,"g",1),A()()}if(2&n){const e=t.$implicit,r=t.index,s=C();De("id","lodestone_",e.direction,"_",e.orientation,""),z("transform",s.getAvailableLodestoneTransform(r)),P(1),w("ngClass",e.selectedClass),z("r",s.PIECE_RADIUS),P(1),w("ngClass",e.pieceClasses),z("r",s.PIECE_RADIUS/4),P(1),Cu("transform","rotate(","diagonal"===e.orientation?45:0,")"),P(1),w("ngForOf",J1(9,w3e))}}function J0t(n,t){if(1&n&&(F(),X(0,"circle",10)),2&n){const e=C(),r=e.index,s=e.$implicit,i=C().$implicit,o=C();De("id","platePiece_",i.position,"_",r,""),w("ngClass",s.pieceClasses),z("r",o.PIECE_RADIUS)("cx",o.SPACE_SIZE*s.coord.x+o.STROKE_WIDTH+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*s.coord.y+o.STROKE_WIDTH+o.SPACE_SIZE/2)}}function e8t(n,t){if(1&n){const e=Oe();F(),O(0,"g")(1,"g",6),ee("click",function(){const s=ue(e),i=s.$implicit,o=s.index,c=C().$implicit;return ce(C().onPressurePlateClick(i.temporary,c.position,o))}),X(2,"rect",18),x(3,J0t,1,6,"circle",8),A()()}if(2&n){const e=t.$implicit,r=t.index,s=C().$implicit,i=C();z("transform",i.getPressurePlateTransform(s.position)),P(1),De("id","plate_",s.position,"_",r,""),P(1),De("id","plateSquare_",s.position,"_",r,""),w("ngClass",e.squareClasses),z("x",i.SPACE_SIZE*e.coord.x+i.STROKE_WIDTH)("y",i.SPACE_SIZE*e.coord.y+i.STROKE_WIDTH)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),P(1),w("ngIf",e.hasPiece)}}function t8t(n,t){if(1&n&&(F(),O(0,"g",16),x(1,e8t,4,11,"g",1),A()),2&n){const e=t.$implicit;y1("id","pressurePlate_",e.position,""),P(1),w("ngForOf",e.coords)}}function n8t(n,t){if(1&n&&(F(),X(0,"rect",19)),2&n){const e=C();De("id","selection_",e.viewInfo.selected.get().x,"_",e.viewInfo.selected.get().y,""),z("x",e.SPACE_SIZE*e.viewInfo.selected.get().x+e.STROKE_WIDTH)("y",e.SPACE_SIZE*e.viewInfo.selected.get().y+e.STROKE_WIDTH)("width",e.SPACE_SIZE)("height",e.SPACE_SIZE)}}class R2 extends o8{constructor(t){super(t),this.viewInfo={availableLodestones:[],capturesToPlace:[],boardInfo:[],currentPlayerClass:"",opponentClass:"",pressurePlates:[],selected:T.empty(),pressurePlateShift:{top:new Bt(0,0),left:new Bt(0,0),right:new Bt(0,0),bottom:new Bt(0,0)}},this.stateAfterPlacingLodestone=T.empty(),this.lastInfos=T.empty(),this.capturesToPlace=0,this.selectedCoord=T.empty(),this.selectedLodestone=T.empty(),this.captures={top:0,bottom:0,left:0,right:0},this.rules=L2.get(),this.tutorial=(new T3e).tutorial,this.availableMinimaxes=[new B0t(this.rules,"LodestoneDummyMinimax")],this.encoder=U4.encoder,this.PIECE_RADIUS=.5*(this.SPACE_SIZE-2*this.STROKE_WIDTH);const e=.8*this.PIECE_RADIUS,r=.3*this.PIECE_RADIUS,s=.2*this.PIECE_RADIUS;this.TRIANGLE_OUT=`${e},0 ${r},${s} ${r},-${s}`,this.TRIANGLE_IN=`${r},0 ${e},${r} ${e},-${r}`,this.displayedState=this.getState(),this.scores=T.of([0,0])}ngOnInit(){this.updateBoard()}selectCoord(t){var e=this;return I(function*(){const r=e.canUserPlay("#square_"+t.x+"_"+t.y);if(r.isFailure())return e.cancelMove(r.getReason());if(e.capturesToPlace>0)return e.cancelMove(kd.MUST_PLACE_CAPTURES());const s=L2.get().isTargetLegal(e.getState(),t);return s.isFailure()?e.cancelMove(s.getReason()):e.selectedCoord.equalsValue(t)?(e.cancelMoveAttempt(),R.SUCCESS):(e.selectedCoord=T.of(t),e.selectedLodestone.isPresent()?e.putLodestone():(e.updateViewInfo(),R.SUCCESS))})()}selectLodestone(t){var e=this;return I(function*(){const r=e.canUserPlay("#lodestone_"+t.direction+"_"+t.orientation);if(r.isFailure())return e.cancelMove(r.getReason());Pe(0===e.capturesToPlace,"should not be able to click on a lodestone when captures need to be placed");const s=e.getCurrentPlayer(),i=Ho.of(s,t);return e.selectedLodestone.equalsValue(i)?(e.cancelMoveAttempt(),R.SUCCESS):(e.selectedLodestone=T.of(i),e.selectedCoord.isPresent()?e.putLodestone():(e.updateViewInfo(),R.SUCCESS))})()}putLodestone(){var t=this;return I(function*(){Pe(t.selectedCoord.isPresent(),"coord should have been selected"),Pe(t.selectedLodestone.isPresent(),"lodestone should have been selected");const e=t.selectedCoord.get(),r=t.selectedLodestone.get(),s=t.getState();Pe(L2.get().isLegalWithoutCaptures(s,e,r.direction).isSuccess(),"Lodestone component should only allow creation of legal moves");const o=L2.get().applyMoveWithoutPlacingCaptures(s,e,r);return t.lastInfos=T.of(o),t.capturesToPlace=Math.min(o.captures.length,s.remainingSpaces()),0===t.capturesToPlace?t.applyMove():(t.displayedState=t.displayedState.withBoard(o.board),t.stateAfterPlacingLodestone=T.of(t.displayedState),t.updateViewInfo(),R.SUCCESS)})()}applyMove(){var t=this;return I(function*(){Pe(t.selectedCoord.isPresent(),"coord should have been selected"),Pe(t.selectedLodestone.isPresent(),"lodestone should have been selected");const e=t.selectedCoord.get(),r=t.selectedLodestone.get(),s=new U4(e,r.direction,r.orientation,t.captures);return t.chooseMove(s,t.getState())})()}onPressurePlateClick(t,e,r){return t?this.deselectPressurePlate(e,r):this.selectPressurePlate(e,r)}selectPressurePlate(t,e){var r=this;return I(function*(){const s=r.canUserPlay("#plate_"+t+"_"+e);if(s.isFailure())return r.cancelMove(s.getReason());if(0===r.capturesToPlace)return r.cancelMove(kd.NO_CAPTURES_TO_PLACE_YET());r.capturesToPlace--,r.captures[t]++;const i=r.stateAfterPlacingLodestone.get(),o=r.getCurrentPlayer().getOpponent(),c=Xe.copyBiArray(i.board),u={...i.pressurePlates},d=i.lodestones.getCopy();return L2.get().updatePressurePlates(c,u,d,o,r.captures),r.displayedState=new sr(c,i.turn,d,u),0===r.capturesToPlace?r.applyMove():(r.updateViewInfo(),r.showPressurePlateDifferences(r.getState(),r.displayedState,!0),R.SUCCESS)})()}deselectPressurePlate(t,e){var r=this;return I(function*(){const s=r.canUserPlay("#plate_"+t+"_"+e);if(s.isFailure())return r.cancelMove(s.getReason());r.capturesToPlace++,r.captures[t]--;const i=r.stateAfterPlacingLodestone.get(),o=r.getCurrentPlayer().getOpponent(),c=Xe.copyBiArray(i.board),u={...i.pressurePlates},d=i.lodestones.getCopy();return L2.get().updatePressurePlates(c,u,d,o,r.captures),r.displayedState=new sr(c,i.turn,d,u),r.updateViewInfo(),r.showPressurePlateDifferences(r.getState(),r.displayedState,!0),R.SUCCESS})()}updateBoard(){this.cancelMoveAttempt(),this.scores=T.of(this.getState().getScores())}cancelMoveAttempt(){this.displayedState=this.getState(),this.stateAfterPlacingLodestone=T.empty(),this.lastInfos=T.empty();const t=this.displayedState.lodestones.get(this.getCurrentPlayer());if(t.isPresent()){const e=Xe.copyBiArray(this.displayedState.board);e[t.get().y][t.get().x]=so.EMPTY,this.displayedState=this.displayedState.withBoard(e)}this.selectedCoord=T.empty(),this.selectedLodestone=T.empty(),this.capturesToPlace=0,this.captures={top:0,bottom:0,left:0,right:0},this.updateViewInfo()}updateViewInfo(){const e=this.getState().getCurrentPlayer();this.viewInfo.currentPlayerClass=this.getPlayerClass(e),this.viewInfo.opponentClass=this.getPlayerClass(e.getOpponent()),this.showBoard(),this.showAvailableLodestones(),this.showCapturesToPlace(),this.showPressurePlates(),this.computePressurePlateShift(),this.lastInfos.isPresent()&&this.showMovedAndCaptured(this.lastInfos.get())}showBoard(){this.viewInfo.boardInfo=[];for(let t=0;t<sr.SIZE;t++){this.viewInfo.boardInfo.push([]);for(let e=0;e<sr.SIZE;e++){const r=new S(e,t);this.viewInfo.boardInfo[t].push(this.getSquareInfo(r))}}this.viewInfo.selected=this.selectedCoord.isPresent()&&!1===this.displayedState.getPieceAt(this.selectedCoord.get()).isUnreachable()?this.selectedCoord:T.empty()}getSquareInfo(t){const e=this.displayedState.getPieceAt(t),r={coord:t,squareClasses:[],crumbled:e.isUnreachable(),hasPiece:e.isPlayerPiece(),pieceClasses:[]};return e.isPlayerPiece()&&(r.pieceClasses=[this.getPlayerClass(e.owner)]),e.isLodestone()&&(r.lodestone={direction:e.direction,pieceClasses:[this.getPlayerClass(e.owner)],selectedClass:"",movingClass:"",orientation:e.orientation},r.lodestone.movingClass=this.getPlayerClass("push"===e.direction?e.owner.getOpponent():e.owner)),r}showAvailableLodestones(){if(this.capturesToPlace>0)this.viewInfo.availableLodestones=[];else{const t=this.getState().getCurrentPlayer(),e=this.getState().nextLodestoneDirection();if(e.isPresent()){const r=e.get();this.viewInfo.availableLodestones=[this.nextLodestone(t,{direction:r,orientation:"orthogonal"}),this.nextLodestone(t,{direction:r,orientation:"diagonal"})]}else this.viewInfo.availableLodestones=[this.nextLodestone(t,{direction:"push",orientation:"orthogonal"}),this.nextLodestone(t,{direction:"push",orientation:"diagonal"}),this.nextLodestone(t,{direction:"pull",orientation:"orthogonal"}),this.nextLodestone(t,{direction:"pull",orientation:"diagonal"})]}}showCapturesToPlace(){const t=this.getCurrentPlayer().getOpponent();this.viewInfo.capturesToPlace=[];for(let e=0;e<this.capturesToPlace;e++)this.viewInfo.capturesToPlace.push({pieceClasses:[this.getPlayerClass(t)]})}nextLodestone(t,e){const r=Ho.of(t,e),s={direction:r.direction,orientation:r.orientation,pieceClasses:[this.getPlayerClass(r.owner)],movingClass:"",selectedClass:""};return s.movingClass=this.getPlayerClass("push"===r.direction?r.owner.getOpponent():r.owner),this.selectedLodestone.equalsValue(r)&&(s.selectedClass="selected-stroke"),s}showPressurePlates(){this.viewInfo.pressurePlates=[];for(const t of _r.POSITIONS){const e=[],r=this.displayedState.pressurePlates[t];if(r.isPresent()){const s=R2.PRESSURE_PLATES_POSITIONS.get(t).get(),i=r.get().width;let o=5===i?s.startForBigPlate:s.startForSmallPlate;for(let c=0;c<i;c++){o=o.getNext(s.direction);const u=r.get().getPieceAt(c);let d="";u.isPlayerPiece()&&(d=this.getPlayerClass(u.owner)),e.push({coord:o,hasPiece:u.isPlayerPiece(),pieceClasses:[d],squareClasses:[],temporary:!1})}}this.viewInfo.pressurePlates.push({position:t,coords:e})}}showLastMove(t){const e=this.getPreviousState();this.lastInfos=T.of(L2.get().applyMoveWithoutPlacingCaptures(e,t.coord,t)),this.updateViewInfo();const r=this.getState();this.showPressurePlateDifferences(e,r,!1)}showPressurePlateDifferences(t,e,r){for(const s of _r.POSITIONS)this.showPressurePlateDifference(t.pressurePlates[s],e.pressurePlates[s],s,r)}showPressurePlateDifference(t,e,r,s){if(t.isPresent()&&e.isPresent()){const i=t.get(),o=e.get(),c=Me.getNonNullable(this.viewInfo.pressurePlates.find(u=>u.position===r));if(i.width===o.width)for(let u=0;u<o.width;u++){const d=i.getPieceAt(u),g=o.getPieceAt(u);!1===d.equals(g)&&(c.coords[u].squareClasses.push("moved-fill"),c.coords[u].temporary=s,s&&c.coords[u].pieceClasses.push("semi-transparent"))}else for(const u of c.coords)u.squareClasses.push("moved-fill")}}showMovedAndCaptured(t){for(const e of t.moved)this.viewInfo.boardInfo[e.y][e.x].squareClasses.push("moved-fill");for(const e of t.captures)this.viewInfo.boardInfo[e.y][e.x].squareClasses.push("captured-fill")}computePressurePlateShift(){const t=this.displayedState,e=this.getPressurePlateShift(t.pressurePlates.left),r=this.getPressurePlateShift(t.pressurePlates.right),s=this.getPressurePlateShift(t.pressurePlates.top),i=this.getPressurePlateShift(t.pressurePlates.bottom);this.viewInfo.pressurePlateShift.top=new Bt(.5*(e-r),0),this.viewInfo.pressurePlateShift.bottom=new Bt(.5*(e-r),0),this.viewInfo.pressurePlateShift.left=new Bt(0,.5*(s-i)),this.viewInfo.pressurePlateShift.right=new Bt(0,.5*(s-i))}getPressurePlateShift(t){return t.isAbsent()?2:3===t.get().width?1:0}getSquareTransform(t,e){return`translate(${t*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2}, ${e*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2})`}getCaptureTransform(t){return`translate(${(t+(sr.SIZE/2-this.viewInfo.capturesToPlace.length/2))*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2+this.viewInfo.pressurePlateShift.top.x*this.SPACE_SIZE}, ${-2*this.SPACE_SIZE-30+this.STROKE_WIDTH+this.SPACE_SIZE/2})`}getAvailableLodestoneTransform(t){return`translate(${(t+(sr.SIZE/2-this.viewInfo.availableLodestones.length/2))*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2+this.viewInfo.pressurePlateShift.top.x*this.SPACE_SIZE}, ${30+9*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2})`}getPressurePlateTransform(t){return`translate(${this.viewInfo.pressurePlateShift[t].x*this.SPACE_SIZE}, ${this.viewInfo.pressurePlateShift[t].y*this.SPACE_SIZE})`}}R2.PRESSURE_PLATE_EXTRA_SHIFT=.2,R2.PRESSURE_PLATES_POSITIONS=Un.from({top:{startForBigPlate:new S(.5,-1-R2.PRESSURE_PLATE_EXTRA_SHIFT),startForSmallPlate:new S(1.5,0-R2.PRESSURE_PLATE_EXTRA_SHIFT),direction:Ne.RIGHT},bottom:{startForBigPlate:new S(.5,8+R2.PRESSURE_PLATE_EXTRA_SHIFT),startForSmallPlate:new S(1.5,7+R2.PRESSURE_PLATE_EXTRA_SHIFT),direction:Ne.RIGHT},left:{startForBigPlate:new S(-1-R2.PRESSURE_PLATE_EXTRA_SHIFT,.5),startForSmallPlate:new S(0-R2.PRESSURE_PLATE_EXTRA_SHIFT,1.5),direction:Ne.DOWN},right:{startForBigPlate:new S(8+R2.PRESSURE_PLATE_EXTRA_SHIFT,.5),startForSmallPlate:new S(7+R2.PRESSURE_PLATE_EXTRA_SHIFT,1.5),direction:Ne.DOWN}}),R2.\u0275fac=function(t){return new(t||R2)(J(En))},R2.\u0275cmp=dt({type:R2,selectors:[["app-lodestone"]],features:[l],decls:6,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-100 -220 1016 1256","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id",4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],["class","base no-fill selected-stroke",3,"id",4,"ngIf"],[3,"id","click",4,"ngIf"],[3,"id","click"],[1,"base",3,"ngClass"],["class","base",3,"id","ngClass",4,"ngIf"],["class","lodestone",4,"ngIf"],[1,"base",3,"id","ngClass"],[1,"lodestone"],["cx","0","cy","0",1,"base","black-fill","outside",3,"ngClass"],["cx","0","cy","0",1,"base","no-stroke",3,"ngClass"],["class","base no-stroke",3,"ngClass",4,"ngIf"],[1,"base","no-stroke",3,"ngClass"],[3,"id"],["cx","0","cy","0",1,"base",3,"ngClass"],["rx","20","ry","20",1,"base",3,"id","ngClass"],[1,"base","no-fill","selected-stroke",3,"id"]],template:function(t,e){1&t&&(F(),O(0,"svg",0),x(1,Y0t,2,1,"g",1),x(2,K0t,2,4,"g",2),x(3,Q0t,5,10,"g",3),x(4,t8t,2,2,"g",2),x(5,n8t,1,6,"rect",4),A()),2&t&&(P(1),w("ngForOf",e.viewInfo.boardInfo),P(1),w("ngForOf",e.viewInfo.capturesToPlace),P(1),w("ngForOf",e.viewInfo.availableLodestones),P(1),w("ngForOf",e.viewInfo.pressurePlates),P(1),w("ngIf",e.viewInfo.selected.isPresent()))},dependencies:[fn,On,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});let XP=(()=>{class n{}return n.START_COORD_OUT_OF_RANGE=()=>$localize`Start coord cannot be out of range`,n.END_COORD_OUT_OF_RANGE=()=>$localize`End coord cannot be out of range`,n.PAWN_MUST_MOVE_ONE_DIAGONAL_STEP=()=>$localize`Pawns must move one step diagonally.`,n.DRONE_MUST_DO_TWO_ORTHOGONAL_STEPS=()=>$localize`Drones must move one or two steps in any direction.`,n})();class vs extends c8{constructor(t,e,r){super(t,e),this.calledTheClock=r}static from(t,e,r=!1){if(t.isNotInRange(4,8))return _e.failure(XP.START_COORD_OUT_OF_RANGE());if(e.isNotInRange(4,8))return _e.failure(XP.END_COORD_OUT_OF_RANGE());if(e.equals(t))return _e.failure(et.MOVE_CANNOT_BE_STATIC());const s=Ne.factory.fromDelta(e.x-t.x,e.y-t.y);return s.isFailure()?_e.failure(s.getReason()):_e.success(new vs(t,e,r))}toString(){const t=this.calledTheClock?", CALL_THE_CLOCK":"";return"MartianChessMove(("+this.getStart().x+", "+this.getStart().y+") -> ("+this.getEnd().x+", "+this.getEnd().y+")"+t+")"}equals(t){return!1!==this.getStart().equals(t.getStart())&&!1!==this.getEnd().equals(t.getEnd())&&this.calledTheClock===t.calledTheClock}isValidForPawn(){return this.getStart().getVectorToward(this.getEnd()).isDiagonalOfLength(1)}isValidForDrone(){return this.getStart().getDistance(this.getEnd())<=2}isUndoneBy(t){if(t.isAbsent())return!1;const e=t.get();return e.getEnd().equals(this.getStart())&&e.getStart().equals(this.getEnd())}}vs.encoder=Nt.tuple([S.encoder,S.encoder,Nt.identity()],n=>[n.getStart(),n.getEnd(),n.calledTheClock],n=>vs.from(n[0],n[1],n[2]).get());class Vt{constructor(t){this.value=t}static tryMerge(t,e){Pe(t!==Vt.EMPTY&&e!==Vt.EMPTY,"tryMerge cannot be called with empty pieces");const s=t.value+e.value;return 2===s||3===s?T.of(Vt.from(s)):T.empty()}static from(t){return t===Vt.DRONE.value?Vt.DRONE:(Me.expectToBe(t,Vt.QUEEN.value),Vt.QUEEN)}getValue(){return this.value}equals(t){return this.getValue()===t.getValue()}}Vt.EMPTY=new Vt(0),Vt.PAWN=new Vt(1),Vt.DRONE=new Vt(2),Vt.QUEEN=new Vt(3);class k5{constructor(t){this.captures=t,t.makeImmutable()}static from(t){const e=new Un;for(const r of t)k5.addToMap(e,r);return new k5(e)}static addToMap(t,e){const r=t.get(e);r.isPresent()?t.replace(e,r.get()+1):t.set(e,1)}toValue(){let t=0;return this.captures.forEach(e=>{t+=e.key.getValue()*e.value}),t}add(t){const e=this.captures.getCopy();return k5.addToMap(e,t),new k5(e)}}class Rs extends Br{constructor(t,e,r=T.empty(),s=T.empty(),i){super(t,e),this.lastMove=r,this.countDown=s,null==i&&(i=new Un([{key:B.ZERO,value:k5.from([])},{key:B.ONE,value:k5.from([])}])),i.makeImmutable(),this.captured=i}static getInitialState(){const t=Vt.EMPTY,e=Vt.PAWN,r=Vt.DRONE,s=Vt.QUEEN;return new Rs([[s,s,r,t],[s,r,e,t],[r,e,e,t],[t,t,t,t],[t,t,t,t],[t,e,e,r],[t,e,r,s],[t,r,s,s]],0,T.empty())}getPlayerTerritory(t){return t===B.ZERO?Rs.PLAYER_ZERO_TERRITORY:Rs.PLAYER_ONE_TERRITORY}isTherePieceOnPlayerSide(t){const e=this.getCurrentPlayer(),r=this.getPlayerTerritory(e);for(const s of r)for(let i=0;i<4;i++)if(this.getPieceAtXY(i,s)===t)return!0;return!1}getScoreOf(t){return this.captured.get(t).get().toValue()}getEmptyTerritory(){return this.isTerritoryEmpty(B.ZERO)?T.of(B.ZERO):this.isTerritoryEmpty(B.ONE)?T.of(B.ONE):T.empty()}isTerritoryEmpty(t){const e=this.getPlayerTerritory(t);for(const r of e)for(let s=0;s<4;s++)if(this.getPieceAtXY(s,r)!==Vt.EMPTY)return!1;return!0}isInOpponentTerritory(t){const e=this.getCurrentOpponent();return this.getPlayerTerritory(e).contains(t.y)}isInPlayerTerritory(t){const e=this.getCurrentPlayer();return this.getPlayerTerritory(e).contains(t.y)}getCapturesOf(t){const e=this.captured.get(t).get();return[e.captures.get(Vt.PAWN).getOrElse(0),e.captures.get(Vt.DRONE).getOrElse(0),e.captures.get(Vt.QUEEN).getOrElse(0)]}}Rs.PLAYER_ZERO_TERRITORY=new zt([4,5,6,7]),Rs.PLAYER_ONE_TERRITORY=new zt([0,1,2,3]);let b3e=(()=>{class n{}return n.YOU_DID_NOT_CAPTURE_ANY_PIECE=()=>$localize`Failed, you did not capture any piece.`,n})();const le=Vt.EMPTY,D2=Vt.PAWN,v6=Vt.DRONE,g8=Vt.QUEEN,O3e=()=>$localize`This is not a field promotion!`;class A3e extends $1{constructor(){super(...arguments),this.tutorial=[ie.informational($localize`Goal of the game`,$localize`At Martian Chess, the goal is to have the most points at the end of the game. Each piece is assigned a value, you win this value when capturing the piece. The board is divided in two by a line called the canal. There is one side for each player. You do not own pieces, but you control the ones on your side of the canal. Pieces are colored to help you: they will change color when crossing the canal.`,Rs.getInitialState()),ie.informational($localize`The pieces`,$localize`The pieces are dark on the side of the first player, the light ones on the side of the second one. There are 3 kind of pieces: <ul><li>The Queens: represented as circles with 3 dots.</li><li>The Drones: represented as circles with 2 dots.</li><li>The Pawns: represented as circles with one dot.</li></ul>`,Rs.getInitialState()),ie.fromPredicate($localize`Moving pawns`,$localize`Pawns are worth one point. They can move one step diagonally.<br/><br/>You're playing Dark, move a pawn.`,Rs.getInitialState(),vs.from(new S(2,5),new S(1,4)).get(),(t,e,r)=>r.getPieceAt(t.getEnd())===Vt.PAWN?R.SUCCESS:R.failure($localize`This is not a pawn!`),$localize`Congratulations!`),ie.fromPredicate($localize`Moving drones`,$localize`Drones are worth two points. They can move one or two steps in any direction, in a straight line, without jumping over other pieces.<br/><br/>You're playing Dark, move a drone.`,Rs.getInitialState(),vs.from(new S(1,7),new S(0,7)).get(),(t,e,r)=>r.getPieceAt(t.getEnd())===Vt.DRONE?R.SUCCESS:R.failure($localize`This is not a drone!`),$localize`Congratulations!`),ie.fromPredicate($localize`Moving queens`,$localize`Queens are worth three points. They can move any number of steps in any direction, in a straight line, without jumping over other pieces.<br/><br/>You're playing Dark, move a queen.`,new Rs([[v6,D2,le,le],[g8,le,le,le],[le,le,le,le],[le,le,g8,le],[le,le,le,le],[le,le,le,le],[le,le,le,le],[g8,v6,D2,le]],1),vs.from(new S(2,3),new S(2,7)).get(),(t,e,r)=>r.getPieceAt(t.getEnd())===Vt.QUEEN?R.SUCCESS:R.failure($localize`This is not a queen!`),$localize`Congratulations!`),ie.fromMove($localize`Capture`,$localize`When a piece crosses the canal and lands on another piece, you capture it and gain the value of that captured piece. However, you lose control of your piece as it crosses the canal!<br/><br/>A capture is possible for Dark, do it.`,new Rs([[v6,D2,D2,le],[le,le,le,le],[g8,le,le,le],[le,le,le,le],[le,le,D2,le],[le,le,le,le],[le,le,le,le],[le,v6,D2,le]],1),[vs.from(new S(0,2),new S(2,4)).get()],$localize`Congratulations! By capturing that pawn, you won one point.`,b3e.YOU_DID_NOT_CAPTURE_ANY_PIECE()),ie.fromMove($localize`Field Promotion (1/2)`,$localize`It is sometimes possible to perform what is called a field promotion. If you are out of one type of piece, you can merge two pieces to add their value and get a new piece. For example, if you have no drones, you can merge two pawns into a drone. To merge two pawns, move one of your pawns on another.<br/><br/>Such a move is possible for Dark. Do it.`,new Rs([[le,le,le,g8],[le,D2,le,le],[le,le,D2,le],[le,le,le,le],[le,le,le,le],[le,le,le,g8],[le,le,v6,le],[le,D2,le,le]],1),[vs.from(new S(1,1),new S(2,2)).get(),vs.from(new S(2,2),new S(1,1)).get()],$localize`Congratulations!`,O3e()),ie.fromPredicate($localize`Field Promotion (2/2)`,$localize`The other kind of field promotion is to merge a drone and a pawn to obtain a queen.<br/><br/>Such a move is possible for Light. Do it.`,new Rs([[D2,le,le,le],[le,le,le,le],[le,le,le,le],[le,le,le,le],[le,le,le,le],[le,le,le,le],[le,le,v6,le],[le,D2,le,le]],0),vs.from(new S(1,7),new S(2,6)).get(),(t,e,r)=>r.getPieceAt(t.getEnd())===Vt.QUEEN?R.SUCCESS:R.failure(O3e()),$localize`Congratulations!`),ie.fromPredicate($localize`Call the clock`,$localize`When the game seems to be going nowhere, you can "call the clock" during your turn. To do so, click on the clock symbol on the right, then perform your move. Once the clock is called, seven more turn will be played.<br/><br/>You're playing Dark. Call the clock and perform a move.`,Rs.getInitialState(),vs.from(new S(1,5),new S(0,4),!0).get(),(t,e,r)=>t.calledTheClock?R.SUCCESS:R.failure($localize`You did not call the clock!`),$localize`Congratulations!`),ie.fromMove($localize`Restarting the clock`,$localize`If the clock has been called, whenever a capture is done the countdown restarts.<br/><br/>You're playing Dark, do a capture to restart the countdown.`,new Rs([[le,le,le,le],[le,D2,le,le],[le,le,le,le],[le,le,le,le],[le,le,le,le],[le,le,le,D2],[le,le,v6,le],[le,D2,le,le]],15,T.empty(),T.of(1)),[vs.from(new S(1,1),new S(2,2)).get()],$localize`Congratulations!`,$localize`This is not a capture, the game is now over, please retry!`),ie.anyMove($localize`End game (by clock)`,$localize`When seven turns have passed after the clock has been called, the player with the most points win. If both player have the same number of points, it is a tie.<br/><br/>You're playing Dark, do the last move.`,new Rs([[le,le,le,g8],[le,D2,le,le],[le,le,le,le],[le,le,le,le],[le,le,le,le],[v6,le,le,le],[le,le,le,le],[le,v6,le,le]],15,T.empty(),T.of(1)),vs.from(new S(1,1),new S(2,2)).get(),$localize`Congratulations!`),ie.fromPredicate($localize`End by emptyness`,$localize`When a player's last piece is moved into the opponent territory, the game ends. If both players have the same number of points, the last player win!<br/><br/>Light player can win this way, do it!`,new Rs([[le,le,le,g8],[le,D2,le,le],[le,le,le,le],[le,le,le,le],[le,le,D2,le],[le,le,le,le],[le,le,le,le],[le,le,le,le]],0),vs.from(new S(2,4),new S(1,3)).get(),(t,e,r)=>3===t.getEnd().y?R.SUCCESS:R.failure($localize`Your piece is still in you territory!`),$localize`Congratulations!`)]}}let QP=(()=>{class n{}return n.MUST_CHOOSE_PIECE_FROM_YOUR_TERRITORY=()=>$localize`You must pick a piece from your side of the board in order to move it.`,n.CANNOT_CAPTURE_YOUR_OWN_PIECE_NOR_PROMOTE_IT=()=>$localize`This is not a valid promotion nor a valid capture.`,n.CANNOT_UNDO_LAST_MOVE=()=>$localize`You cannot perform a move that is the reverse of the previous one.`,n})();class Ld extends L1{applyLegalMove(t,e,r){const s=e.getCopiedBoard();s[t.getStart().y][t.getStart().x]=Vt.EMPTY;const i=r.finalPiece;s[t.getEnd().y][t.getEnd().x]=i;const o=r.score;let c=e.countDown;if(c.isPresent())if(this.isCapture(t,e))c=Ld.STARTING_COUNT_DOWN;else{const d=e.countDown.get();c=T.of(d-1)}return t.calledTheClock&&(c=Ld.STARTING_COUNT_DOWN),new Rs(s,e.turn+1,T.of(t),c,o)}isLegal(t,e){this.assertNonDoubleClockCall(t,e);const r=this.isLegalMove(t,e);if(r.isFailure())return r.toOtherFallible();if(t.isUndoneBy(e.lastMove))return _e.failure(QP.CANNOT_UNDO_LAST_MOVE());if(this.isFieldPromotion(t,e))return this.isLegalFieldPromotion(t,e);const s=e.getPieceAt(t.getStart()),i=e.captured.getCopy();if(this.isCapture(t,e)){const c=e.getCurrentPlayer();let u=i.get(c).get();const d=e.getPieceAt(t.getEnd());u=u.add(d),i.replace(c,u),i.makeImmutable()}return _e.success({finalPiece:s,score:i})}assertNonDoubleClockCall(t,e){Pe(!1===(e.countDown.isPresent()&&t.calledTheClock),"Should not call the clock twice")}isCapture(t,e){const r=e.isInOpponentTerritory(t.getEnd()),s=e.getPieceAt(t.getEnd())!==Vt.EMPTY;return r&&s}isFieldPromotion(t,e){const r=e.isInPlayerTerritory(t.getEnd()),s=e.getPieceAt(t.getEnd())!==Vt.EMPTY;return r&&s}isLegalFieldPromotion(t,e){const r=this.getPromotedPiece(t,e);if(r.isAbsent())return _e.failure(QP.CANNOT_CAPTURE_YOUR_OWN_PIECE_NOR_PROMOTE_IT());const s=r.get();if(e.isTherePieceOnPlayerSide(s))return _e.failure(QP.CANNOT_CAPTURE_YOUR_OWN_PIECE_NOR_PROMOTE_IT());{const i={finalPiece:s,score:e.captured.getCopy()};return _e.success(i)}}isLegalMove(t,e){if(!1===e.isInPlayerTerritory(t.getStart()))return R.failure(QP.MUST_CHOOSE_PIECE_FROM_YOUR_TERRITORY());const s=e.getPieceAt(t.getStart());if(s===Vt.EMPTY)return R.failure(et.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(s===Vt.PAWN)return t.isValidForPawn()?R.SUCCESS:R.failure(XP.PAWN_MUST_MOVE_ONE_DIAGONAL_STEP());if(s===Vt.DRONE&&!1===t.isValidForDrone())return R.failure(XP.DRONE_MUST_DO_TWO_ORTHOGONAL_STEPS());for(const i of t.getStart().getUntil(t.getEnd()))if(e.getPieceAt(i)!==Vt.EMPTY)return R.failure(et.SOMETHING_IN_THE_WAY());return R.SUCCESS}getPromotedPiece(t,e){const r=e.getPieceAt(t.getStart()),s=e.getPieceAt(t.getEnd());return Vt.tryMerge(r,s)}getGameStatus(t){const e=t.gameState;if(e.countDown.equalsValue(0))return this.getGameStatusScoreVictoryOr(e,xe.DRAW);if(e.getEmptyTerritory().isPresent()){const s=e.getCurrentOpponent(),i=xe.getVictory(s);return this.getGameStatusScoreVictoryOr(e,i)}return xe.ONGOING}getGameStatusScoreVictoryOr(t,e){const r=t.getScoreOf(B.ZERO),s=t.getScoreOf(B.ONE);return r>s?xe.ZERO_WON:s>r?xe.ONE_WON:e}}Ld.STARTING_COUNT_DOWN=T.of(7);class r8t extends xs{constructor(t,e){super(t,e)}getListMoves(t){const e=t.gameState,r=e.getCurrentPlayer(),s=e.getPlayerTerritory(r);let i=[];for(const o of s)for(let c=0;c<4;c++)switch(e.getPieceAtXY(c,o)){case Vt.PAWN:i=i.concat(this.getMovesForPawnAt(e,c,o));break;case Vt.DRONE:i=i.concat(this.getMovesForDroneAt(e,c,o));break;case Vt.QUEEN:i=i.concat(this.getMovesForQueenAt(e,c,o))}return i}getMovesForPawnAt(t,e,r){const s=new S(e,r),i=[];for(const o of Ne.DIAGONALS){const c=s.getNext(o);c.isInRange(4,8)&&i.push(c)}return this.addLegalMoves(t,s,i)}addLegalMoves(t,e,r){const s=[],i=t.getPieceAt(e),o=!1===t.isTherePieceOnPlayerSide(Vt.DRONE),c=!1===t.isTherePieceOnPlayerSide(Vt.QUEEN),u=t.lastMove;for(const d of r){const g=t.getPieceAt(d);if(g===Vt.EMPTY)this.add(s,vs.from(e,d).get(),u);else if(t.isInPlayerTerritory(d)){const m=Vt.tryMerge(g,i);if(m.isPresent()){const y=m.get(),b=vs.from(e,d).get();(y===Vt.DRONE&&o||y===Vt.QUEEN&&c)&&this.add(s,b,u)}}else this.add(s,vs.from(e,d).get(),u)}return s}add(t,e,r){!1===e.isUndoneBy(r)&&t.push(e)}getMovesForDroneAt(t,e,r){const s=new S(e,r),i=this.getLandingCoordsForLinearMove(s,t,2);return this.addLegalMoves(t,s,i)}getLandingCoordsForLinearMove(t,e,r){const s=[];for(const i of Ne.DIRECTIONS){let o=1,c=t.getNext(i,o),u=e.tryToGetPieceAt(c),d=u.equalsValue(Vt.EMPTY);for(;d;)s.push(c),o++,c=t.getNext(i,o),u=e.tryToGetPieceAt(c),d=u.equalsValue(Vt.EMPTY)&&o<r;u.isPresent()&&s.push(c)}return s}getMovesForQueenAt(t,e,r){const s=new S(e,r),i=this.getLandingCoordsForQueen(s,t);return this.addLegalMoves(t,s,i)}getLandingCoordsForQueen(t,e){return this.getLandingCoordsForLinearMove(t,e,8)}getMetrics(t){return[t.gameState.getScoreOf(B.ZERO),t.gameState.getScoreOf(B.ONE)]}}function s8t(n,t){if(1&n&&(F(),X(0,"g",19)),2&n){const e=C(2).index,r=C().index,s=C();m2(s.style),De("mainShapeId","pawn_",e,"_",r,""),w("pieceClasses",s.getPieceClasses(e,r))}}function i8t(n,t){if(1&n&&(F(),X(0,"g",20)),2&n){const e=C(2).index,r=C().index,s=C();m2(s.style),De("mainShapeId","drone_",e,"_",r,""),w("pieceClasses",s.getPieceClasses(e,r))}}function o8t(n,t){if(1&n&&(F(),X(0,"g",21)),2&n){const e=C(2).index,r=C().index,s=C();m2(s.style),De("mainShapeId","queen_",e,"_",r,""),w("pieceClasses",s.getPieceClasses(e,r))}}function a8t(n,t){if(1&n&&(F(),O(0,"g"),x(1,s8t,1,5,"g",16),x(2,i8t,1,5,"g",17),x(3,o8t,1,5,"g",18),A()),2&n){const e=C(),r=e.index,s=e.$implicit,i=C().index,o=C();z("transform",o.getPieceLocation(r,i)),P(1),w("ngIf",s===o.pieces.PAWN),P(1),w("ngIf",s===o.pieces.DRONE),P(1),w("ngIf",s===o.pieces.QUEEN)}}function c8t(n,t){if(1&n){const e=Oe();F(),O(0,"g",14),ee("click",function(){const i=ue(e).index,o=C().index;return ce(C().onClick(i,o))}),X(1,"rect",15),x(2,a8t,4,4,"g",13),A()}if(2&n){const e=t.$implicit,r=t.index,s=C().index,i=C();De("id","click_",r,"_",s,""),z("transform",i.getPieceTranslation(s)),P(1),De("id","square_",r,"_",s,""),w("ngClass",i.getSquareClasses(r,s)),z("x",r*i.SPACE_SIZE)("y",s*i.SPACE_SIZE)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),P(1),w("ngIf",e!==i.pieces.EMPTY)}}function l8t(n,t){if(1&n){const e=Oe();F(),O(0,"g")(1,"rect",22),ee("click",function(){const i=ue(e).$implicit;return ce(C(3).onClick(i.x,i.y))}),A()()}if(2&n){const e=t.$implicit,r=C(3);P(1),De("id","indicator_",e.x,"_",e.y,""),z("transform",r.getPieceTranslation(e.y))("x",e.x*r.SPACE_SIZE+(r.SPACE_SIZE/2-r.INDICATOR_SIZE/2))("y",e.y*r.SPACE_SIZE+(r.SPACE_SIZE/2-r.INDICATOR_SIZE/2))("width",r.INDICATOR_SIZE)("height",r.INDICATOR_SIZE)}}function u8t(n,t){if(1&n&&(F(),O(0,"g"),x(1,l8t,2,7,"g",1),A()),2&n){const e=C(2);P(1),w("ngForOf",e.selectedPieceInfo.get().legalLandings)}}function f8t(n,t){if(1&n&&(F(),O(0,"g"),x(1,c8t,3,11,"g",12),x(2,u8t,2,1,"g",13),A()),2&n){const e=t.$implicit,r=C();P(1),w("ngForOf",e),P(1),w("ngIf",r.selectedPieceInfo.isPresent())}}function d8t(n,t){if(1&n&&(F(),O(0,"text",23),Tt(1),A()),2&n){const e=C();w("ngClass","player"+e.getCurrentPlayer().value)("ngClass",e.getClockCircleClasses()),z("x",.5*e.SPACE_SIZE)("y",.5*e.SPACE_SIZE),P(1),c1(e.countDown.get())}}function h8t(n,t){if(1&n&&(F(),X(0,"polyline",24)),2&n){const e=C();w("ngClass",e.getClockCircleClasses()),z("points",e.clockNeedlesPoints)}}const JP=function(n){return[n]};function p8t(n,t){if(1&n){const e=Oe();F(),pn(0),O(1,"g",27),ee("click",function(){const i=ue(e).index;return ce(C(2).chooseStyle(i))}),A(),gn()}if(2&n){const e=t.$implicit,r=t.index,s=C(2);P(1),m2(e.style),w("id",e.name)("pieceClasses",T3(5,JP,"player"+s.getCurrentPlayer().value+"-fill")),z("transform","translate(0, "+-(r+1)*s.SPACE_SIZE+")")}}function g8t(n,t){if(1&n&&(F(),O(0,"g",25),X(1,"rect",26),x(2,p8t,2,7,"ng-container",1),A()),2&n){const e=C();P(1),z("x",0)("y",-e.listOfStyles.length*e.SPACE_SIZE)("width",1*e.SPACE_SIZE)("height",e.listOfStyles.length*e.SPACE_SIZE),P(1),w("ngForOf",e.listOfStyles)}}function m8t(n,t){if(1&n&&(F(),O(0,"text",33),Tt(1),A()),2&n){const e=C(2).$implicit,r=C().$implicit,s=C();w("ngClass",s.getPlayerClass(r)),z("x",s.SPACE_SIZE/2)("y",s.SPACE_SIZE/2),P(1),c1(e+" x ")}}function _8t(n,t){if(1&n&&(F(),X(0,"g",34)),2&n){const e=C(3).$implicit,r=C();m2(r.style),w("pieceClasses",T3(3,JP,r.getPlayerClass(e)))}}function v8t(n,t){if(1&n&&(F(),X(0,"g",35)),2&n){const e=C(3).$implicit,r=C();m2(r.style),w("pieceClasses",T3(3,JP,r.getPlayerClass(e)))}}function C8t(n,t){if(1&n&&(F(),X(0,"g",36)),2&n){const e=C(3).$implicit,r=C();m2(r.style),w("pieceClasses",T3(3,JP,r.getPlayerClass(e)))}}function y8t(n,t){if(1&n&&(F(),O(0,"g"),x(1,m8t,2,4,"text",29),O(2,"g",28),x(3,_8t,1,5,"g",30),x(4,v8t,1,5,"g",31),x(5,C8t,1,5,"g",32),A()()),2&n){const e=C(),r=e.index,s=e.$implicit,i=C().$implicit,o=C();z("transform","translate(0, "+2*r*o.SPACE_SIZE+")"),P(1),w("ngIf",s>1),P(1),De("id","piece_",r,"_player_",i.value,""),z("transform","translate("+o.SPACE_SIZE+", 0)"),P(1),w("ngIf",0===r),P(1),w("ngIf",1===r),P(1),w("ngIf",2===r)}}function E8t(n,t){if(1&n&&(F(),O(0,"g"),x(1,y8t,6,8,"g",13),A()),2&n){const e=t.$implicit;P(1),w("ngIf",e>0)}}function M8t(n,t){if(1&n&&(F(),O(0,"g")(1,"g",28),x(2,E8t,2,1,"g",1),A()()),2&n){const e=t.$implicit,r=C();P(1),y1("id","capture_of_player_",e.value,""),z("transform",r.getCapturesTransformation(e)),P(1),w("ngForOf",r.state.getCapturesOf(e))}}let Fo=(()=>{class n extends ko{constructor(e){super(e),this.INDICATOR_SIZE=20,this.HORIZONTAL_CENTER=2*n.SPACE_SIZE,this.VERTICAL_CENTER=4*n.SPACE_SIZE+n.STROKE_WIDTH,this.LEFT=n.SPACE_SIZE/-4+n.STROKE_WIDTH/-2,this.UP=-n.STROKE_WIDTH/2,this.WIDTH=6.5*n.SPACE_SIZE+n.STROKE_WIDTH,this.HEIGHT=8*n.SPACE_SIZE+3*n.STROKE_WIDTH,this.MartianChessComponent=n,this.style={shape:"Circle",points:"Horizontal Points"},this.pieces=Vt,this.selectedPieceInfo=T.empty(),this.countDown=T.empty(),this.callTheClock=!1,this.displayModePanel=!1,this.listOfStyles=[{name:"Star",style:{shape:"Star",points:"Dots"}},{name:"Polygon",style:{shape:"Polygon",points:"Concentric Circles"}},{name:"Simple",style:{shape:"Circle",points:"Horizontal Points"}},{name:"Circely",style:{shape:"Circle",points:"Concentric Circles"}}],this.hasAsymmetricBoard=!0,this.rules=new Ld(Rs),this.availableMinimaxes=[new r8t(this.rules,"Martian Chess Dummy Minimax")],this.SPACE_SIZE=n.SPACE_SIZE,this.configCogTransformation=this.getConfigCogTransformation(),this.configViewTranslation=this.getConfigViewTranslation(),this.clockNeedlesPoints=this.getClockNeedlesPoints(),this.encoder=vs.encoder,this.tutorial=(new A3e).tutorial,this.scores=T.of([0,0]),this.updateBoard()}static getRegularPolygon(e,r=0){const s=n.getRegularPolygonCoords(e,r);return n.mapCoordsToString(s)}static getNPointedStar(e,r){const s=this.getNPointedStarCoords(e,r);return n.mapCoordsToString(s)}static getNPointedStarCoords(e,r){const s=[],i=.5*n.SPACE_SIZE,o=.5*n.SPACE_SIZE;e*=2;for(let c=0;c<e;c++){const d=(c*(360/e)+r)/180*Math.PI,g=c%2==0?n.SPACE_SIZE/2:n.SPACE_SIZE/6,m=i+.8*g*Math.cos(d),y=o+.8*g*Math.sin(d);s.push(new S(m,y))}return s}static getRegularPolygonCoords(e,r=0){const s=[],i=.5*n.SPACE_SIZE,o=.5*n.SPACE_SIZE;for(let c=0;c<e;c++){const d=(c*(360/e)-90)/180*Math.PI,g=.5*n.SPACE_SIZE,m=i+.8*g*Math.cos(d),y=o+.8*g*Math.sin(d)+r;s.push(new S(m,y))}return s}static mapCoordsToString(e){let r="";for(const s of e)r+=s.x+", "+s.y+" ";return r}static getRadius(e){return this.SPACE_SIZE*e/10}getConfigViewTranslation(){return"translate("+(5.25*this.SPACE_SIZE+0)+", "+(7*this.SPACE_SIZE+0+2*this.STROKE_WIDTH)+")"}getConfigCogTransformation(){const e=this.STROKE_WIDTH,s=(this.SPACE_SIZE-e)/40;return"translate("+1*e+", "+1*e+") scale("+s+" "+s+")"}getClockNeedlesPoints(){const e=.5*this.SPACE_SIZE;return e+" "+.1*this.SPACE_SIZE+", "+e+" "+e+", "+.75*this.SPACE_SIZE+" "+e}updateBoard(){this.state=this.getState(),this.board=this.state.board;const e=this.state.getScoreOf(B.ZERO),r=this.state.getScoreOf(B.ONE);this.countDown=this.state.countDown,this.scores=T.of([e,r])}getPieceLocation(e,r){return"translate("+this.SPACE_SIZE*e+", "+this.SPACE_SIZE*r+")"}getPieceClasses(e,r){const s=new S(e,r),i=[];return i.push(r>3?"player0-fill":"player1-fill"),this.selectedPieceInfo.isPresent()&&this.selectedPieceInfo.get().selectedPiece.equals(s)&&i.push("selected-stroke"),this.rules.node.move.isPresent()&&this.rules.node.move.get().getEnd().equals(s)&&this.getPreviousState().getPieceAt(s)!==Vt.EMPTY&&this.getState().isInOpponentTerritory(new S(0,r))&&i.push("last-move-stroke"),i}onClick(e,r){var s=this;return I(function*(){s.displayModePanel=!1;const i=s.canUserPlay("#click_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());const o=new S(e,r);return s.selectedPieceInfo.isPresent()?s.secondClick(o):s.firstClick(o)})()}firstClick(e){var r=this;return I(function*(){return r.isOneOfUsersPieces(e)?r.selectAsFirstPiece(e):(r.cancelMoveAttempt(),R.SUCCESS)})()}selectAsFirstPiece(e){var r=this;return I(function*(){const s=r.getLegalLandings(e);return r.selectedPieceInfo=T.of({selectedPiece:e,legalLandings:s}),R.SUCCESS})()}getLegalLandings(e){const r=this.state.getPieceAt(e);let s;return s=r===Vt.PAWN?Ne.DIAGONALS.map(i=>e.getNext(i)):this.getValidLinearLandingSquareUntil(e,r===Vt.DRONE?2:8),s.filter(i=>{const o=vs.from(e,i);return!!o.isSuccess()&&this.rules.isLegal(o.get(),this.getState()).isSuccess()})}getValidLinearLandingSquareUntil(e,r){return Ne.DIRECTIONS.flatMap(s=>{const i=[];let o=e.getNext(s),c=1;for(;o.isInRange(4,8)&&c<=r&&(i.push(o),this.getState().getPieceAt(o)===Vt.EMPTY);)o=o.getNext(s),c++;return i})}secondClick(e){var r=this;return I(function*(){const s=r.selectedPieceInfo.get();if(s.selectedPiece.equals(e))return r.cancelMoveAttempt(),R.SUCCESS;if(s.legalLandings.some(i=>i.equals(e))){const i=vs.from(s.selectedPiece,e,r.callTheClock);Pe(i.isSuccess(),"MartianChessComponent or Rules did a mistake thinking this would have been a legal move!");const o=r.getState();return r.chooseMove(i.get(),o)}if(r.isOneOfUsersPieces(e))return r.selectAsFirstPiece(e);{const i=vs.from(s.selectedPiece,e,r.callTheClock);return i.isSuccess()?r.chooseMove(i.get(),r.getState()):r.cancelMove(i.getReason())}})()}isOneOfUsersPieces(e){return this.state.getPieceAt(e)!==Vt.EMPTY&&this.state.isInPlayerTerritory(e)}cancelMoveAttempt(){this.selectedPieceInfo=T.empty(),this.callTheClock=!1}onClockClick(){var e=this;return I(function*(){const r=e.canUserPlay("#clockOrCountDownView");return r.isFailure()?e.cancelMove(r.getReason()):(e.getState().countDown.isAbsent()&&(e.callTheClock=!e.callTheClock),R.SUCCESS)})()}getClockCircleClasses(){const e=["base"];return this.callTheClock&&e.push("selected-stroke"),this.getCurrentPlayer()===B.ZERO?e.push("player0-stroke"):e.push("player1-stroke"),e}getSquareClasses(e,r){const s=new S(e,r),i=["base"];if(this.rules.node.move.isPresent()){const o=this.rules.node,c=o.move.get();c.getStart().equals(s)?i.push("moved-fill"):c.getEnd().equals(s)&&(o.mother.get().gameState.getPieceAt(s)===Vt.EMPTY||o.gameState.isInOpponentTerritory(new S(0,r))?i.push("moved-fill"):i.push("captured-fill"))}return i}onModeCogClick(){this.displayModePanel=!this.displayModePanel}chooseStyle(e){this.style=this.listOfStyles[e].style,this.displayModePanel=!1}getPieceTranslation(e){return"translate(0, "+(e<=3?0:2*this.STROKE_WIDTH)+")"}getBoardTransformation(){return"translate("+this.SPACE_SIZE+", 0) rotate("+180*this.role.value+" "+this.HORIZONTAL_CENTER+" "+this.VERTICAL_CENTER+")"}getCapturesTransformation(e){let i=this.SPACE_SIZE/2;return e===this.role&&(i+=10*this.SPACE_SIZE+4*this.STROKE_WIDTH),"scale(0.5, 0.5) translate("+-this.SPACE_SIZE/2+", "+i+")"}}return n.SPACE_SIZE=100,n.STROKE_WIDTH=8,n.\u0275fac=function(e){return new(e||n)(J(En))},n.\u0275cmp=dt({type:n,selectors:[["app-martian-chess"]],features:[l],decls:15,vars:19,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["id","clockOrCountDownView",3,"click"],["x","0","y","0",1,"transparent"],["id","clockOrCountDownCircle",3,"ngClass"],["id","countDownText","class","text-giant text-center",3,"ngClass",4,"ngIf"],["class","base","stroke-linecap","round",3,"ngClass",4,"ngIf"],["id","modeCogView"],["id","modeCog",3,"click"],["d","M35.497,15.111h-1.656c-0.282-0.924-0.653-1.807-1.102-2.646l1.176-1.175c1.364-1.366,1.366-3.582,0-4.949l-1.258-1.258 c-0.656-0.656-1.548-1.025-2.476-1.025l0,0c-0.93,0-1.818,0.369-2.477,1.025l-1.176,1.175c-0.838-0.446-1.721-0.817-2.645-1.102 V3.501c0-1.934-1.566-3.5-3.5-3.5h-1.778c-1.934,0-3.5,1.566-3.5,3.5v1.655c-0.923,0.282-1.807,0.653-2.645,1.102l-1.174-1.175 c-1.367-1.367-3.584-1.367-4.951,0L5.081,6.34c-1.367,1.366-1.367,3.583,0,4.949l1.174,1.175c-0.446,0.84-0.818,1.723-1.102,2.646 H3.5c-1.934,0-3.5,1.566-3.5,3.5v1.778c0,1.932,1.566,3.5,3.5,3.5h1.654c0.283,0.922,0.654,1.807,1.102,2.645l-1.175,1.176 c-1.366,1.365-1.366,3.582-0.001,4.949l1.258,1.258c0.656,0.654,1.547,1.023,2.475,1.023h0.001c0.929,0,1.818-0.369,2.475-1.023 l1.176-1.176c0.837,0.447,1.722,0.818,2.644,1.102v1.656c0,1.932,1.566,3.5,3.5,3.5h1.778c1.934,0,3.5-1.568,3.5-3.5v-1.656 c0.924-0.283,1.807-0.654,2.645-1.102l1.177,1.176c0.655,0.656,1.547,1.023,2.476,1.023c0.93,0,1.817-0.369,2.477-1.023 l1.256-1.258c1.366-1.367,1.365-3.582,0-4.949l-1.176-1.174c0.447-0.84,0.818-1.725,1.102-2.646h1.656c1.934,0,3.5-1.568,3.5-3.5 v-1.777C38.997,16.679,37.43,15.111,35.497,15.111z M19.499,27.499c-4.41,0-8-3.588-8-8c0-4.411,3.59-8,8-8c4.412,0,8,3.589,8,8 C27.499,23.911,23.911,27.499,19.499,27.499z",3,"ngClass"],["id","modePanel",4,"ngIf"],["id","captures"],[3,"id","click",4,"ngFor","ngForOf"],[4,"ngIf"],[3,"id","click"],[3,"id","ngClass"],["app-martian-chess-pawn","",3,"mainShapeId","pieceClasses","style",4,"ngIf"],["app-martian-chess-drone","",3,"pieceClasses","mainShapeId","style",4,"ngIf"],["app-martian-chess-queen","",3,"mainShapeId","pieceClasses","style",4,"ngIf"],["app-martian-chess-pawn","",3,"mainShapeId","pieceClasses"],["app-martian-chess-drone","",3,"pieceClasses","mainShapeId"],["app-martian-chess-queen","",3,"mainShapeId","pieceClasses"],[1,"indicator",3,"id","click"],["id","countDownText",1,"text-giant","text-center",3,"ngClass"],["stroke-linecap","round",1,"base",3,"ngClass"],["id","modePanel"],["stroke-width","8",1,"base"],["app-martian-chess-queen","",3,"id","pieceClasses","click"],[3,"id"],["class","text-giant text-center",3,"ngClass",4,"ngIf"],["app-martian-chess-pawn","",3,"pieceClasses","style",4,"ngIf"],["app-martian-chess-drone","",3,"pieceClasses","style",4,"ngIf"],["app-martian-chess-queen","",3,"pieceClasses","style",4,"ngIf"],[1,"text-giant","text-center",3,"ngClass"],["app-martian-chess-pawn","",3,"pieceClasses"],["app-martian-chess-drone","",3,"pieceClasses"],["app-martian-chess-queen","",3,"pieceClasses"]],template:function(e,r){1&e&&(F(),O(0,"svg",0)(1,"g"),x(2,f8t,3,2,"g",1),A(),O(3,"g",2),ee("click",function(){return r.onClockClick()}),X(4,"rect",3)(5,"circle",4),x(6,d8t,2,5,"text",5),x(7,h8t,1,2,"polyline",6),A(),O(8,"g",7)(9,"g",8),ee("click",function(){return r.onModeCogClick()}),X(10,"rect",3)(11,"path",9),A(),x(12,g8t,3,5,"g",10),A(),O(13,"g",11),x(14,M8t,3,3,"g",1),A()()),2&e&&(z("viewBox",r.LEFT+" "+r.UP+" "+r.WIDTH+" "+r.HEIGHT),P(1),z("transform",r.getBoardTransformation()),P(1),w("ngForOf",r.board),P(1),z("transform","translate("+5.25*r.SPACE_SIZE+", 0)"),P(1),z("width",r.SPACE_SIZE)("height",r.SPACE_SIZE),P(1),w("ngClass",r.getClockCircleClasses()),z("cx",.5*r.SPACE_SIZE)("cy",.5*r.SPACE_SIZE)("r",.4*r.SPACE_SIZE),P(1),w("ngIf",r.countDown.isPresent()),P(1),w("ngIf",r.countDown.isAbsent()),P(1),z("transform",r.configViewTranslation),P(2),z("width",r.SPACE_SIZE)("height",r.SPACE_SIZE),P(1),w("ngClass",r.getPlayerClass(r.getCurrentPlayer())),z("transform",r.configCogTransformation),P(1),w("ngIf",r.displayModePanel),P(2),w("ngForOf",r.Player.PLAYERS))},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class C6 extends Br{static getInitialState(){const t=Xe.createTable(7,6,he.NONE);return new C6(t,0)}}class R1 extends Fi{constructor(t){super(),this.x=t}static of(t){switch(t){case 0:return R1.ZERO;case 1:return R1.ONE;case 2:return R1.TWO;case 3:return R1.THREE;case 4:return R1.FOUR;case 5:return R1.FIVE;case 6:return R1.SIX;default:throw new Error("Invalid P4Move")}}equals(t){return this===t}toString(){return"P4Move("+this.x+")"}}R1.ZERO=new R1(0),R1.ONE=new R1(1),R1.TWO=new R1(2),R1.THREE=new R1(3),R1.FOUR=new R1(4),R1.FIVE=new R1(5),R1.SIX=new R1(6),R1.encoder=new class extends Nt{encodeMove(n){return n.x}decodeMove(n){return R1.of(n)}};let S8t=(()=>{class n{}return n.COLUMN_IS_FULL=()=>$localize`Please put your piece in an incomplete column.`,n})();class Wr extends L1{static isInRange(t){return t.isInRange(7,6)}static getVictoriousCoords(t){return Wr.P4_HELPER.getVictoriousCoord(t)}static getBoardValueFromScratch(t){Q(Wr.VERBOSE,{P4Rules_getBoardValueFromScratch:{state:t}});let e=0;for(let r=0;r<7;r++)for(let s=5;-1!==s&&t.board[s][r].isPlayer();s--){const i=Wr.getSquareScore(t,new S(r,s));if(U1.getScoreStatus(i)!==Mn.DEFAULT)return Q(Wr.VERBOSE,{preVictoryOrVictory:{state:t,squareScore:i,coord:{x:r,y:s}}}),new k1(i);e+=i}return new k1(e)}static getLowestUnoccupiedSpace(t,e){let r=0;for(;r<6&&t[r][e]===he.NONE;)r++;return r-1}static getSquareScore(t,e){return Q(Wr.VERBOSE,"getSquareScore(board, "+e.x+", "+e.y+") called"),Q(Wr.VERBOSE,t.board),Wr.P4_HELPER.getSquareScore(t,e)}static getListMoves(t){Q(Wr.VERBOSE,{context:"P4Rules.getListMoves",node:t});const e=t.gameState,r=[];for(let s=0;s<7;s++)if(e.getPieceAtXY(s,0)===he.NONE){const i=R1.of(s);r.push(i)}return r}static getBoardValue(t){return Q(Wr.VERBOSE,{text:"P4Rules.getBoardValue called",board:t.getCopiedBoard()}),Wr.getBoardValueFromScratch(t)}applyLegalMove(t,e,r){const s=t.x,i=e.getCopiedBoard(),o=Wr.getLowestUnoccupiedSpace(i,s),c=e.turn;return i[o][s]=e.getCurrentPlayer(),new C6(i,c+1)}isLegal(t,e){return Q(Wr.VERBOSE,{context:"P4Rules.isLegal",move:t.toString(),state:e}),e.getPieceAtXY(t.x,0).isPlayer()?R.failure(S8t.COLUMN_IS_FULL()):R.SUCCESS}getGameStatus(t){const e=t.gameState;return Wr.P4_HELPER.getVictoriousCoord(e).length>0?xe.getVictory(e.getCurrentOpponent()):42===e.turn?xe.DRAW:xe.ONGOING}}Wr.VERBOSE=!1,Wr.P4_HELPER=new Bm(Wr.isInRange,Me.identity,4);class P8t extends k3{getListMoves(t){return Wr.getListMoves(t).sort((e,r)=>Math.abs(e.x-3)-Math.abs(r.x-3))}getBoardValue(t){const e=t.gameState;return Q(Wr.VERBOSE,{text:"P4Rules instance methods getBoardValue called",board:e.getCopiedBoard()}),Wr.getBoardValue(e)}}const Et=he.NONE,y6=he.ZERO,Rd=he.ONE;class N3e extends $1{constructor(){super(...arguments),this.tutorial=[ie.informational($localize`Goal of the game`,$localize`The board at Four in a Row is made of 7 columns and 6 rows, and it is initially empty.
        The first player plays Dark, the second plays Light.
        The goal is to be the first to align 4 of its pieces (horizontally, vertically, or diagonally).`,C6.getInitialState()),ie.anyMove($localize`Dropping a piece`,$localize`Click on any space in any column.`,C6.getInitialState(),R1.THREE,$localize`As you can see, the piece falls at the bottom of the column.`),ie.fromMove($localize`Victory`,$localize`You're playing Dark.
        Place your piece so that you create a horizontal alignment of 4 of your pieces.`,new C6([[Et,Et,Et,Et,Et,Et,Et],[Et,Et,Et,Et,Et,Et,Et],[Et,Et,Et,Et,Et,Et,Et],[Et,Et,Et,Rd,Et,Et,Et],[Et,Et,Et,Rd,Et,Et,Et],[Et,Et,y6,y6,y6,Rd,Et]],0),[R1.of(1)],$localize`You won!`,$localize`Failed, you have not aligned 4 pieces and missed an opportunity to win.`),ie.fromMove($localize`Other victory`,$localize`You can also align 4 pieces diagonally or vertically.`,new C6([[Et,Et,Et,Et,Et,Et,Et],[Et,Et,Et,Et,Et,Et,Et],[Et,Et,Et,Et,Et,Et,Et],[Et,Et,Et,y6,Rd,Et,Et],[Et,Et,y6,y6,Rd,Et,Et],[Et,y6,Rd,y6,y6,Et,Et]],0),[R1.of(3),R1.of(4)],$localize`You won!`,$localize`Failed, you have not aligned 4 pieces and missed an opportunity to win.`)]}}function T8t(n,t){if(1&n&&(F(),X(0,"circle",8)),2&n){const e=C().index,r=C().index,s=C();w("ngClass",s.getSquareFillClass(e,r)),z("cx",s.SPACE_SIZE*e+s.SPACE_SIZE/2)("cy",s.SPACE_SIZE*r+s.SPACE_SIZE/2)("r",s.SPACE_SIZE/2-s.STROKE_WIDTH)}}function w8t(n,t){if(1&n){const e=Oe();F(),O(0,"g",5),ee("click",function(){const i=ue(e).index;return ce(C(2).onClick(i))}),X(1,"rect",6),x(2,T8t,1,4,"circle",7),A()}if(2&n){const e=t.$implicit,r=t.index,s=C().index,i=C();y1("id","click_",r,""),P(1),z("x",i.SPACE_SIZE*r)("y",i.SPACE_SIZE*s)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),P(1),w("ngIf",e!==i.EMPTY)}}function b8t(n,t){if(1&n&&(F(),O(0,"g"),x(1,w8t,3,6,"g",4),A()),2&n){const e=t.$implicit;P(1),w("ngForOf",e)}}function O8t(n,t){if(1&n&&(F(),X(0,"rect",9)),2&n){const e=C();z("x",e.SPACE_SIZE*e.last.get().x)("y",e.SPACE_SIZE*e.last.get().y)("width",e.SPACE_SIZE)("height",e.SPACE_SIZE)}}function A8t(n,t){if(1&n&&(F(),X(0,"rect",10)),2&n){const e=t.$implicit,r=C();De("id","victory_coord_",e.x,"_",e.y,""),z("x",r.SPACE_SIZE*e.x)("y",r.SPACE_SIZE*e.y)("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)}}let N8t=(()=>{class n extends ko{constructor(e){super(e),this.EMPTY=he.NONE,this.victoryCoords=[],this.rules=new Wr(C6),this.availableMinimaxes=[new P8t(this.rules,"P4Minimax")],this.encoder=R1.encoder,this.tutorial=(new N3e).tutorial,this.updateBoard()}onClick(e){var r=this;return I(function*(){const s=r.canUserPlay("#click_"+e);if(s.isFailure())return r.cancelMove(s.getReason());const i=R1.of(e);return yield r.chooseMove(i,r.getState())})()}updateBoard(){const e=this.getState();this.victoryCoords=Wr.getVictoriousCoords(e),this.board=e.board,this.hideLastMove()}showLastMove(e){const r=this.getState(),s=Wr.getLowestUnoccupiedSpace(r.board,e.x)+1;this.last=T.of(new S(e.x,s))}hideLastMove(){this.last=T.empty()}getSquareFillClass(e,r){return[this.getPlayerClass(this.board[r][e])]}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(J(En))},n.\u0275cmp=dt({type:n,selectors:[["app-p4"]],features:[l],decls:4,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-4 -4 708 608","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base no-fill last-move-stroke mid-stroke",4,"ngIf"],["class","base no-fill victory-stroke mid-stroke",3,"id",4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base"],["class","base","pointer-events","fill",3,"ngClass",4,"ngIf"],["pointer-events","fill",1,"base",3,"ngClass"],[1,"base","no-fill","last-move-stroke","mid-stroke"],[1,"base","no-fill","victory-stroke","mid-stroke",3,"id"]],template:function(e,r){1&e&&(F(),O(0,"svg",0),x(1,b8t,2,1,"g",1),x(2,O8t,1,4,"rect",2),x(3,A8t,1,6,"rect",3),A()),2&e&&(P(1),w("ngForOf",r.board),P(1),w("ngIf",r.last.isPresent()),P(1),w("ngForOf",r.victoryCoords))},dependencies:[fn,On,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class Ds extends Ks{constructor(t,e,r,s=!1){if(super(t,e),this.blockTurned=r,this.turnedClockwise=s,this.coord.isNotInRange(6,6))throw new Error("The board is a 6 cas wide square, invalid coord: "+this.coord.toString())}static withRotation(t,e,r,s){if(r<0||3<r)throw new Error("This block do not exist: "+r);return new Ds(t,e,T.of(r),s)}static rotationless(t,e){return new Ds(t,e,T.empty())}toString(){return this.blockTurned.isPresent()?"PentagoMove("+this.coord.toString()+", "+this.blockTurned.get()+", "+(this.turnedClockwise?"CLOCKWISE":"ANTI-CLOCKWISE")+")":"PentagoMove"+this.coord.toString()}equals(t){return!1!==this.coord.equals(t.coord)&&!1!==this.blockTurned.equals(t.blockTurned)&&this.turnedClockwise===t.turnedClockwise}}Ds.encoder=new class extends Nt{encodeMove(n){const t={coord:S.encoder.encode(n.coord)};return n.blockTurned.isPresent()&&(t.blockTurned=n.blockTurned.get(),t.turnedClockwise=n.turnedClockwise),t}decodeMove(n){const t=n,e=S.encoder.decode(t.coord),r=T.ofNullable(t.blockTurned);if(r.isPresent()){const s=t.turnedClockwise;return Ds.withRotation(e.x,e.y,r.get(),s)}return Ds.rotationless(e.x,e.y)}};class eT extends xs{getListMoves(t){const e=[],r=t.gameState.neutralBlocks;if(0===t.gameState.turn)return eT.FIRST_TURN_MOVES;const s=this.getLegalDrops(t.gameState);for(const i of s){const o=Ds.rotationless(i.x,i.y),c=t.gameState.applyLegalDrop(o),u=this.getLegalRotations(c,r);for(const g of u)e.push(Ds.withRotation(i.x,i.y,g[0],g[1]));0===c.neutralBlocks.length==0&&e.push(o)}return e}getLegalDrops(t){const e=[];for(let r=0;r<6;r++)for(let s=0;s<6;s++){const i=new S(s,r);t.getPieceAt(i)===he.NONE&&e.push(i)}return e}getLegalRotations(t,e){const r=0===t.neutralBlocks.length,s=[];for(let i=0;i<4;i++)!1===t.blockIsNeutral(i)&&(e.includes(i)?r&&s.push([i,!0]):s.push([i,!0],[i,!1]));return s}getMetrics(t){return[0,0]}}eT.FIRST_TURN_MOVES=[Ds.rotationless(0,0),Ds.rotationless(1,0),Ds.rotationless(2,0),Ds.rotationless(0,1),Ds.rotationless(1,1),Ds.rotationless(0,2)];let I3e=(()=>{class n{}return n.CANNOT_ROTATE_NEUTRAL_BLOCK=()=>$localize`If the quadrant to turn is neutral, please just use move without rotation.`,n.MUST_CHOOSE_BLOCK_TO_ROTATE=()=>$localize`No quadrant is neutral, you must pick a quadrant to rotate.`,n})();class z2 extends Br{constructor(t,e){super(t,e),this.neutralBlocks=this.getBlocksNeutralities()}static getInitialState(){const t=Xe.createTable(6,6,he.NONE);return new z2(t,0)}getBlocksNeutralities(){const t=[];for(let e=0;e<4;e++)this.getBlockNeutrality(e)&&t.push(e);return t}getBlockNeutrality(t){const e=z2.getBlockCenter(t),r=this.getPieceAt(e.getNext(Ne.UP,1)),s=this.getPieceAt(e.getNext(Ne.UP_LEFT,1));return this.getPieceAt(e.getNext(Ne.RIGHT,1))===r&&this.getPieceAt(e.getNext(Ne.DOWN,1))===r&&this.getPieceAt(e.getNext(Ne.LEFT,1))===r&&this.getPieceAt(e.getNext(Ne.UP_RIGHT,1))===s&&this.getPieceAt(e.getNext(Ne.DOWN_RIGHT,1))===s&&this.getPieceAt(e.getNext(Ne.DOWN_LEFT,1))===s}static getBlockCenter(t){return new S(1+(t%2==0?0:3),1+(t<2?0:3))}applyLegalDrop(t){const e=this.getCopiedBoard();return e[t.coord.y][t.coord.x]=this.getCurrentPlayer(),new z2(e,this.turn)}applyLegalMove(t){const e=this.applyLegalDrop(t),r=e.getCopiedBoard();if(t.blockTurned.isPresent()){const i=z2.getBlockCenter(t.blockTurned.get()).toVector();if(t.turnedClockwise)for(const o of z2.ROTATION_MAP){const c=o[0].getNext(i),u=o[1].getNext(i),d=e.getPieceAt(c);r[u.y][u.x]=d}else for(const o of z2.ROTATION_MAP){const c=o[1].getNext(i),u=o[0].getNext(i),d=e.getPieceAt(c);r[u.y][u.x]=d}}return new z2(r,this.turn+1)}blockIsNeutral(t){return this.neutralBlocks.includes(t)}}z2.ROTATION_MAP=[[new S(-1,-1),new S(1,-1)],[new S(0,-1),new S(1,0)],[new S(1,-1),new S(1,1)],[new S(1,0),new S(0,1)],[new S(1,1),new S(-1,1)],[new S(0,1),new S(-1,0)],[new S(-1,1),new S(-1,-1)],[new S(-1,0),new S(0,-1)]];class G4 extends L1{static get(){return G4.singleton.isAbsent()&&(G4.singleton=T.of(new G4(z2))),G4.singleton.get()}applyLegalMove(t,e,r){return e.applyLegalMove(t)}isLegal(t,e){if(e.getPieceAt(t.coord).isPlayer())return R.failure(et.MUST_LAND_ON_EMPTY_SPACE());const r=e.applyLegalDrop(t);if(0===r.neutralBlocks.length){if(t.blockTurned.isAbsent())return R.failure(I3e.MUST_CHOOSE_BLOCK_TO_ROTATE())}else if(t.blockTurned.isPresent()){const s=t.blockTurned.get();if(r.neutralBlocks.includes(s))return R.failure(I3e.CANNOT_ROTATE_NEUTRAL_BLOCK())}return R.SUCCESS}getVictoryCoords(t){let e=[];for(const r of G4.VICTORY_SOURCE){const s=t.getPieceAt(r[0]),i=[r[0]];if(s.isPlayer()){let o=r[0].getNext(r[1]),c=!0;for(let u=0;u<3&&c;u++)t.getPieceAt(o)!==s?c=!1:(i.push(o),o=o.getNext(r[1]));if(c&&(t.getPieceAt(o)===s&&(i.push(o),e=e.concat(i)),r[2])){const u=r[0].getPrevious(r[1],1);t.getPieceAt(u)===s&&(i.push(u),e=e.concat(i))}}}return e}getGameStatus(t){const e=t.gameState,r=this.getVictoryCoords(e),s=[!1,!1];for(let i=0;i<r.length;i+=5)s[e.getPieceAt(r[i]).value]=!0;return!0===s[0]?!0===s[1]?xe.DRAW:xe.ZERO_WON:!0===s[1]?xe.ONE_WON:36===e.turn?xe.DRAW:xe.ONGOING}}G4.singleton=T.empty(),G4.VICTORY_SOURCE=[[new S(1,0),new Bt(1,1),!1],[new S(0,1),new Bt(1,1),!1],[new S(4,0),new Bt(-1,1),!1],[new S(5,1),new Bt(-1,1),!1],[new S(1,1),new Bt(1,1),!0],[new S(4,1),new Bt(-1,1),!0],[new S(0,1),new Bt(0,1),!0],[new S(1,1),new Bt(0,1),!0],[new S(2,1),new Bt(0,1),!0],[new S(3,1),new Bt(0,1),!0],[new S(4,1),new Bt(0,1),!0],[new S(5,1),new Bt(0,1),!0],[new S(1,0),new Bt(1,0),!0],[new S(1,1),new Bt(1,0),!0],[new S(1,2),new Bt(1,0),!0],[new S(1,3),new Bt(1,0),!0],[new S(1,4),new Bt(1,0),!0],[new S(1,5),new Bt(1,0),!0]];const Ke=he.NONE,W4=he.ZERO,E6=he.ONE;class x3e{constructor(){this.tutorial=[ie.informational($localize`Initial board`,$localize`The initial Pentago board is made of 6x6 spaces, subdivided in 4 quadrants, which can each rotate.`,z2.getInitialState()),ie.informational($localize`Goal of the game`,$localize`The goal at Pentago is to align 5 of your pieces. In the following board, Dark wins.`,new z2([[W4,Ke,Ke,W4,E6,Ke],[W4,E6,Ke,Ke,Ke,Ke],[W4,Ke,E6,Ke,Ke,Ke],[W4,Ke,Ke,Ke,Ke,E6],[W4,Ke,Ke,Ke,E6,Ke],[Ke,Ke,Ke,Ke,Ke,Ke]],10)).withPreviousMove(Ds.withRotation(0,0,0,!1)),ie.fromPredicate($localize`Simple move`,$localize`At their turn, players put a piece on the board and possibly rotate one quadrant.
        As long as there are neutral quadrants, i.e., quadrants that would not change after being rotated, a player may skip rotating a quadrant.
        To do this, you have to click on the crossed circle that appears at the center of the board when it is possible.<br/><br/>
        You're playing dark, do a simple move.`,new z2([[Ke,Ke,Ke,Ke,Ke,Ke],[Ke,W4,Ke,Ke,E6,Ke],[Ke,Ke,Ke,Ke,Ke,Ke],[Ke,Ke,Ke,Ke,Ke,Ke],[Ke,E6,Ke,Ke,W4,Ke],[Ke,Ke,Ke,Ke,Ke,Ke]],10),Ds.rotationless(2,2),(t,e,r)=>t.blockTurned.isPresent()?R.failure($localize`You have made a move with a rotation. This tutorial step is about moves without rotations!`):R.SUCCESS,$localize`Congratulations!`),ie.fromPredicate($localize`Move with rotation`,$localize`After putting a piece, arrows will appear on non-neutral quadrants.<br/><br/>
        You're playing Dark, place a piece on a quadrant and do a rotation!`,new z2([[Ke,Ke,Ke,Ke,Ke,Ke],[Ke,W4,Ke,Ke,E6,Ke],[Ke,Ke,Ke,Ke,Ke,Ke],[Ke,Ke,Ke,Ke,Ke,Ke],[Ke,E6,Ke,Ke,W4,Ke],[Ke,Ke,Ke,Ke,Ke,Ke]],10),Ds.withRotation(0,0,0,!0),(t,e,r)=>t.blockTurned.isPresent()?R.SUCCESS:R.failure($localize`You made a move without rotation, try again!`),$localize`Congratulations! Note that if all quadrants are neutral after you have put your piece, there will be no rotation.`)]}}function I8t(n,t){if(1&n){const e=Oe();F(),O(0,"circle",12),ee("click",function(){const i=ue(e).$implicit,o=C().$implicit,c=C().index,u=C().index;return ce(C().onClick(3*c+i,3*u+o))}),A()}if(2&n){const e=t.$implicit,r=C().$implicit,s=C(),i=s.index,o=s.$implicit,c=C(),u=c.index,d=c.$implicit,g=C();De("id","click_",3*i+e,"_",3*u+r,""),w("ngClass",g.getSquareClasses(3*i+e,3*u+r)),z("cx",o+2*g.STROKE_WIDTH+(e+.5)*g.SPACE_SIZE)("cy",d+2*g.STROKE_WIDTH+(r+.5)*g.SPACE_SIZE)("r",(g.SPACE_SIZE-g.STROKE_WIDTH)/2)}}const k3e=function(){return[0,1,2]};function x8t(n,t){1&n&&(F(),pn(0),x(1,I8t,1,6,"circle",11),gn()),2&n&&(P(1),w("ngForOf",J1(1,k3e)))}function k8t(n,t){if(1&n&&(F(),pn(0),X(1,"rect",10),x(2,x8t,2,2,"ng-container",4),gn()),2&n){const e=t.$implicit,r=t.index,s=C(),i=s.index,o=s.$implicit,c=C();P(1),w("ngClass",c.getBlockClasses(r,i)),z("x",c.STROKE_WIDTH+e)("y",c.STROKE_WIDTH+o)("rx",3*c.STROKE_WIDTH)("ry",3*c.STROKE_WIDTH)("width",c.BLOCK_WIDTH)("height",c.BLOCK_WIDTH),P(1),w("ngForOf",J1(8,k3e))}}const L3e=function(n){return[0,n]};function L8t(n,t){if(1&n&&(F(),pn(0),x(1,k8t,3,9,"ng-container",4),gn()),2&n){const e=C();P(1),w("ngForOf",T3(1,L3e,e.BLOCK_SEPARATION))}}function R8t(n,t){if(1&n&&(F(),X(0,"circle",13)),2&n){const e=C();De("id","currentDrop_",e.currentDrop.get().x,"_",e.currentDrop.get().y,""),w("ngClass",e.getPlayerClass(e.getCurrentPlayer())),z("cx",e.getCenter(e.currentDrop.get().x))("cy",e.getCenter(e.currentDrop.get().y))("r",(e.SPACE_SIZE-e.STROKE_WIDTH)/2)}}function D8t(n,t){if(1&n){const e=Oe();F(),O(0,"path",14),ee("click",function(){const i=ue(e).$implicit;return ce(C().rotate(i))}),A()}if(2&n){const e=t.$implicit,r=C();De("id","rotate_",e.blockIndex,"_",e.clockwise?"clockwise":"counterclockwise",""),z("d",e.path)("stroke-width",2*r.STROKE_WIDTH)}}function z8t(n,t){if(1&n&&(F(),X(0,"path",15)),2&n){const e=C();De("id","last_rotation_",e.lastRotation.get().blockIndex,"_",e.lastRotation.get().clockwise?"clockwise":"counterclockwise",""),z("d",e.lastRotation.get().path)("stroke-width",2*e.STROKE_WIDTH)}}function V8t(n,t){if(1&n&&(F(),X(0,"circle",16)),2&n){const e=t.$implicit,r=C();De("id","victoryCoord_",e.x,"_",e.y,""),w("ngClass",r.getSquareClasses(e.x,e.y)),z("cx",r.getCenter(e.x))("cy",r.getCenter(e.y))("r",(r.SPACE_SIZE-r.STROKE_WIDTH)/2)("stroke-width",r.STROKE_WIDTH)}}function H8t(n,t){if(1&n){const e=Oe();F(),O(0,"g",17),ee("click",function(){return ue(e),ce(C().skipRotation())}),X(1,"circle",18)(2,"line",19),A()}if(2&n){const e=C();P(1),z("cx",e.BLOCK_SEPARATION)("cy",e.BLOCK_SEPARATION)("r",.75*e.SPACE_SIZE)("stroke-width",2*e.STROKE_WIDTH),P(1),z("x1",e.BLOCK_SEPARATION-e.DIAGONAL_BAR_OFFSET)("y1",e.BLOCK_SEPARATION+e.DIAGONAL_BAR_OFFSET)("x2",e.BLOCK_SEPARATION+e.DIAGONAL_BAR_OFFSET)("y2",e.BLOCK_SEPARATION-e.DIAGONAL_BAR_OFFSET)("stroke-width",2*e.STROKE_WIDTH)}}let F8t=(()=>{class n extends ko{constructor(e){super(e),this.arrows=[],this.victoryCoords=[],this.currentDrop=T.empty(),this.movedBlock=T.empty(),this.lastDrop=T.empty(),this.lastRotation=T.empty(),this.rules=G4.get(),this.availableMinimaxes=[new eT(this.rules,"PentagoMinimax")],this.encoder=Ds.encoder,this.tutorial=(new x3e).tutorial,this.BLOCK_WIDTH=3*this.SPACE_SIZE+2*this.STROKE_WIDTH,this.BLOCK_SEPARATION=this.BLOCK_WIDTH+2*this.STROKE_WIDTH,this.DIAGONAL_BAR_OFFSET=.75*Math.cos(Math.PI/4)*this.SPACE_SIZE,this.ARROWS=this.generateArrowsCoord(),this.updateBoard()}updateBoard(){this.board=this.getState().getCopiedBoard(),this.victoryCoords=this.rules.getVictoryCoords(this.getState()),this.lastDrop=T.empty(),this.lastRotation=T.empty()}showLastMove(e){this.cancelMoveAttempt(),this.movedBlock=e.blockTurned;const r=new S(e.coord.x%3-1,e.coord.y%3-1);if(e.blockTurned.isPresent()&&(this.showLastRotation(e),!1===r.equals(new S(0,0))&&this.coordBelongToBlock(e)))return this.showLastDrop(e,r);this.lastDrop=T.of(e.coord)}showLastRotation(e){if(e.blockTurned.isPresent()){const r=e.blockTurned.get(),s=this.ARROWS.filter(i=>i.blockIndex===r&&i.clockwise===e.turnedClockwise)[0];this.lastRotation=T.of(s)}}showLastDrop(e,r){let s;s=e.turnedClockwise?Me.getNonNullable(z2.ROTATION_MAP.find(d=>d[0].equals(r)))[1]:Me.getNonNullable(z2.ROTATION_MAP.find(d=>d[1].equals(r)))[0];const i=e.blockTurned.get(),u=new S(i%2==0?1:4,i<2?1:4);s=s.getNext(u,1),this.lastDrop=T.of(s)}coordBelongToBlock(e){return e.blockTurned.equalsValue(2*(e.coord.y<3?0:1)+(e.coord.x<3?0:1))}hidePreviousMove(){this.lastDrop=T.empty(),this.movedBlock=T.empty(),this.lastRotation=T.empty(),this.victoryCoords=[]}generateArrowsCoord(){const e=2*this.BLOCK_SEPARATION,s=this.SPACE_SIZE,i=e-s,o=2*s,c=.5*this.SPACE_SIZE;return[{path:"M "+c+" 0 q  "+s+" -"+s+"  "+o+"  0",blockIndex:0,clockwise:!0},{path:"M 0 "+c+" q -"+s+"  "+s+"  0  "+o,blockIndex:0,clockwise:!1},{path:"M "+e+" "+c+" q  "+s+"  "+s+"  0  "+o,blockIndex:1,clockwise:!0},{path:"M "+i+" 0 q -"+s+" -"+s+" -"+o+"  0",blockIndex:1,clockwise:!1},{path:"M 0 "+i+" q -"+s+" -"+s+"  0 -"+o,blockIndex:2,clockwise:!0},{path:"M "+c+" "+e+" q  "+s+"  "+s+"  "+o+"  0",blockIndex:2,clockwise:!1},{path:"M "+i+" "+e+" q -"+s+"  "+s+" -"+o+"  0",blockIndex:3,clockwise:!0},{path:"M "+e+" "+i+" q  "+s+" -"+s+"  0 -"+o,blockIndex:3,clockwise:!1}]}cancelMoveAttempt(){this.arrows=[],this.currentDrop=T.empty(),this.canSkipRotation=!1}onClick(e,r){var s=this;return I(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());if(s.hidePreviousMove(),s.board[r][e].isPlayer())return s.cancelMove(et.MUST_LAND_ON_EMPTY_SPACE());const o=Ds.rotationless(e,r),c=s.getState(),u=c.applyLegalDrop(o);if(4===u.neutralBlocks.length)return s.chooseMove(o,c);const d=s.rules.getGameStatus(s.rules.node);return s.canSkipRotation=u.neutralBlocks.length>0&&!1===d.isEndGame,s.currentDrop=T.of(new S(e,r)),s.displayArrows(u.neutralBlocks),R.SUCCESS})()}getCenter(e){return(e<3?0:this.BLOCK_SEPARATION)+2*this.STROKE_WIDTH+(e%3+.5)*this.SPACE_SIZE}displayArrows(e){this.arrows=[];for(let r=0;r<4;r++)if(!1===e.includes(r)){const s=this.ARROWS.filter(i=>i.blockIndex===r);this.arrows=this.arrows.concat(s)}}getBlockClasses(e,r){return this.movedBlock.equalsValue(e+2*r)?["last-move-stroke"]:[]}getSquareClasses(e,r){const s=[],i=this.getPlayerClass(this.board[r][e]);return s.push(i),this.lastDrop.equalsValue(new S(e,r))&&s.push("last-move-stroke"),s}rotate(e){var r=this;return I(function*(){const i=r.canUserPlay("#rotate_"+e.blockIndex+"_"+(e.clockwise?"clockwise":"counterclockwise"));if(i.isFailure())return r.cancelMove(i.getReason());const o=r.currentDrop.get(),c=Ds.withRotation(o.x,o.y,e.blockIndex,e.clockwise);return r.chooseMove(c,r.getState())})()}skipRotation(){var e=this;return I(function*(){const r=e.canUserPlay("#skipRotation");if(r.isFailure())return e.cancelMove(r.getReason());const s=e.currentDrop.get(),i=Ds.rotationless(s.x,s.y);return e.chooseMove(i,e.getState())})()}}return n.\u0275fac=function(e){return new(e||n)(J(En))},n.\u0275cmp=dt({type:n,selectors:[["app-pentago"]],features:[l],decls:13,vars:8,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-60 -60 780 780"],["id","bluearrowhead","markerWidth","5","markerHeight","3.5","refX","2.5","refY","1.75","orient","auto","fill","blue"],["points","0 0, 5 1.75, 0 3.5"],["id","movedarrowhead","markerWidth","5","markerHeight","3.5","refX","2.5","refY","1.75","orient","auto",1,"last-move-fill"],[4,"ngFor","ngForOf"],["class","base","pointer-events","fill",3,"id","ngClass",4,"ngIf"],["class","no-fill","stroke","blue","marker-end","url(#bluearrowhead)",3,"id","click",4,"ngFor","ngForOf"],["class","no-fill last-move-stroke","marker-end","url(#movedarrowhead)",3,"id",4,"ngIf"],["class","base victory-stroke",3,"id","ngClass",4,"ngFor","ngForOf"],["id","skipRotation",3,"click",4,"ngIf"],[1,"base","no-fill",3,"ngClass"],["class","base","pointer-events","fill",3,"id","ngClass","click",4,"ngFor","ngForOf"],["pointer-events","fill",1,"base",3,"id","ngClass","click"],["pointer-events","fill",1,"base",3,"id","ngClass"],["stroke","blue","marker-end","url(#bluearrowhead)",1,"no-fill",3,"id","click"],["marker-end","url(#movedarrowhead)",1,"no-fill","last-move-stroke",3,"id"],[1,"base","victory-stroke",3,"id","ngClass"],["id","skipRotation",3,"click"],["stroke","red",1,"background"],["stroke","red"]],template:function(e,r){1&e&&(F(),O(0,"svg",0)(1,"defs")(2,"marker",1),X(3,"polygon",2),A()(),O(4,"defs")(5,"marker",3),X(6,"polygon",2),A()(),x(7,L8t,2,3,"ng-container",4),x(8,R8t,1,6,"circle",5),x(9,D8t,1,4,"path",6),x(10,z8t,1,4,"path",7),x(11,V8t,1,7,"circle",8),x(12,H8t,3,9,"g",9),A()),2&e&&(P(7),w("ngForOf",T3(6,L3e,r.BLOCK_SEPARATION)),P(1),w("ngIf",r.currentDrop.isPresent()),P(1),w("ngForOf",r.arrows),P(1),w("ngIf",r.lastRotation.isPresent()),P(1),w("ngForOf",r.victoryCoords),P(1),w("ngIf",r.canSkipRotation))},dependencies:[fn,On,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})(),B3=(()=>{class n extends Br{constructor(e,r,s){super(e,s),this.captures=r}static getInitialState(){const e=Xe.createTable(n.SIZE,n.SIZE,he.NONE);return e[9][9]=he.ONE,new n(e,[0,0],0)}}return n.SIZE=19,n})();class qi extends Ks{constructor(t,e){super(t,e)}static isOnBoard(t){return t.isInRange(B3.SIZE,B3.SIZE)}static of(t){return Me.assert(qi.isOnBoard(t),"PenteMove: coord is out of the board"),new qi(t.x,t.y)}toString(){return`PenteMove(${this.coord.x}, ${this.coord.y})`}}qi.encoder=Ks.getEncoder(qi.of);class nc extends L1{constructor(){super(B3)}static get(){return nc.singleton.isAbsent()&&(nc.singleton=T.of(new nc)),nc.singleton.get()}isLegal(t,e){return e.getPieceAt(t.coord).isPlayer()?R.failure(et.MUST_CLICK_ON_EMPTY_SQUARE()):R.SUCCESS}applyLegalMove(t,e,r){const s=e.getCurrentPlayer(),i=e.getCopiedBoard();i[t.coord.y][t.coord.x]=s;const o=this.getCaptures(t.coord,e,s);for(const u of o)i[u.y][u.x]=he.NONE;const c=[e.captures[0],e.captures[1]];return c[s.value]+=o.length,new B3(i,c,e.turn+1)}getCaptures(t,e,r){const s=r.getOpponent(),i=[];for(const o of Ne.factory.all){const c=t.getNext(o,1),u=t.getNext(o,2),d=t.getNext(o,3);qi.isOnBoard(c)&&e.getPieceAt(c)===s&&qi.isOnBoard(u)&&e.getPieceAt(u)===s&&qi.isOnBoard(d)&&e.getPieceAt(d)===r&&(i.push(c),i.push(u))}return i}getGameStatus(t){const e=t.gameState,r=e.getCurrentOpponent();return e.captures[r.value]>=10||nc.PENTE_HELPER.getVictoriousCoord(e).length>0?xe.getVictory(r):this.stillHaveEmptySquare(e)?xe.ONGOING:xe.DRAW}stillHaveEmptySquare(t){for(let e=0;e<B3.SIZE;e++)for(let r=0;r<B3.SIZE;r++)if(t.board[e][r]===he.NONE)return!0;return!1}}nc.PENTE_HELPER=new Bm(qi.isOnBoard,Me.identity,5),nc.singleton=T.empty();class B8t extends k3{getListMoves(t){const r=[];return t.gameState.forEachCoord((s,i)=>{!1===i.isPlayer()&&r.push(qi.of(s))}),r}getBoardValue(t){const e=this.ruler.getGameStatus(t);return e.isEndGame?k1.fromWinner(e.winner):nc.PENTE_HELPER.getBoardValue(t.gameState)}}const v=he.NONE,q4=he.ZERO,$3=he.ONE;class R3e extends $1{constructor(){super(...arguments),this.tutorial=[ie.informational($localize`Initial board and object of the game`,$localize`Pente is played on a 19x19 board, on which the stones are put on the intersections of the squares. The object of the game is to align 5 of your pieces, or to capture 10 pieces of your opponent. Initially, a stone of the second player is in the center location of the board.`,B3.getInitialState()),ie.anyMove($localize`Dropping a stone`,$localize`At your turn, you must drop one stone on the board. There is no restriction: you can put it anywhere.<br/><br/>You're playing Dark, put a stone on the board.`,B3.getInitialState(),qi.of(new S(9,8)),$localize`Congratulations!`),ie.fromMove($localize`Capturing`,$localize`You can capture exactly two pieces of your opponent by sandwiching them between two of your pieces.<br/><br/>You're playing Light and you can capture, do it!`,new B3([[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,q4,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,$3,q4,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,$3,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v]],[0,0],3),[qi.of(new S(9,6))],$localize`Congratulations!`,$localize`Failed. Try again.`),ie.fromMove($localize`Placing in a sandwich position`,$localize`You can safely place a piece next to another of your piece in what would look like a sandwich from the opponent's pieces. This is a safe move.<br/><br/>You're playing Light and have the opportunity to do such a move here, do it!`,new B3([[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,$3,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,$3,q4,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,$3,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v]],[0,0],4),[qi.of(new S(9,7))],$localize`Congratulations!`,$localize`Failed. Try again.`),ie.fromMove($localize`Victory`,$localize`Remember, to win you can either align 5 or your pieces, or capture 10 pieces of your opponent. Here, as Light, you have already captured 8 pieces and you only need two more to win.<br/><br/>You're playing Light, you can win in two ways. Win!`,new B3([[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,$3,v,v,q4,q4,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,q4,v,q4,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,$3,q4,q4,q4,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,$3,$3,$3,$3,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v]],[8,8],7),[qi.of(new S(9,6)),qi.of(new S(8,9)),qi.of(new S(13,9))],$localize`Congratulations!`,$localize`Failed. Try again.`)]}}function $8t(n,t){if(1&n&&(F(),X(0,"circle",8)),2&n){const e=C().index,r=C().index,s=C();De("id","piece_",e,"_",r,""),w("ngClass",s.getSpaceClass(e,r)),z("cx",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*e)("cy",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*r)("r",.22*s.SPACE_SIZE)}}function U8t(n,t){if(1&n&&(F(),X(0,"circle",12)),2&n){const e=C(2).index,r=C().index,s=C();De("id","hoshi_",e,"_",r,""),z("cx",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*e)("cy",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*r)("r",.1*s.SPACE_SIZE)}}function G8t(n,t){if(1&n&&(F(),X(0,"rect",9)(1,"line",10)(2,"line",10),x(3,U8t,1,5,"circle",11)),2&n){const e=C().index,r=C().index,s=C();z("width",.5*s.SPACE_SIZE)("height",.5*s.SPACE_SIZE)("x",.5*s.SPACE_SIZE*e)("y",.5*s.SPACE_SIZE*r),P(1),z("x1",.5*s.SPACE_SIZE*e)("y1",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*r)("x2",.5*s.SPACE_SIZE+.5*s.SPACE_SIZE*e)("y2",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*r),P(1),z("x1",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*e)("y1",.5*s.SPACE_SIZE*r)("x2",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*e)("y2",.5*s.SPACE_SIZE+.5*s.SPACE_SIZE*r),P(1),w("ngIf",s.isHoshi(e,r))}}function W8t(n,t){if(1&n){const e=Oe();F(),O(0,"g",5),ee("click",function(){const i=ue(e).index,o=C().index;return ce(C().onClick(i,o))}),x(1,$8t,1,6,"circle",6),x(2,G8t,4,13,"ng-template",null,7,Zn),A()}if(2&n){const e=t.$implicit,r=t.index,s=Bn(3);De("id","click_",r,"_",C().index,""),P(1),w("ngIf",e.isPlayer())("ngIfElse",s)}}function q8t(n,t){if(1&n&&(F(),O(0,"g"),x(1,W8t,4,4,"g",4),A()),2&n){const e=t.$implicit;P(1),w("ngForOf",e)}}function j8t(n,t){if(1&n){const e=Oe();F(),O(0,"circle",13),ee("click",function(){const i=ue(e).$implicit;return ce(C().onClick(i.x,i.y))}),A()}if(2&n){const e=t.$implicit,r=C();De("id","capture_",e.x,"_",e.y,""),z("cx",.25*r.SPACE_SIZE+.5*r.SPACE_SIZE*e.x)("cy",.25*r.SPACE_SIZE+.5*r.SPACE_SIZE*e.y)("r",.07*r.SPACE_SIZE)}}let Z8t=(()=>{class n extends kH{constructor(e){super(e),this.lastMoved=T.empty(),this.victoryCoords=[],this.captured=[],this.scores=T.of([0,0]),this.rules=nc.get(),this.encoder=qi.encoder,this.tutorial=(new R3e).tutorial,this.availableMinimaxes=[new B8t(this.rules,"Alignment")]}updateBoard(){const e=this.getState();this.board=e.board,this.scores=T.of(this.getState().captures),this.victoryCoords=nc.PENTE_HELPER.getVictoriousCoord(e),this.createHoshis(),this.cancelMoveAttempt()}showLastMove(){const e=this.rules.node.move.get();this.lastMoved=T.of(e.coord);const r=this.getCurrentPlayer().getOpponent();this.captured=nc.get().getCaptures(e.coord,this.getPreviousState(),r)}cancelMoveAttempt(){this.lastMoved=T.empty(),this.captured=[]}onClick(e,r){var s=this;return I(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());const o=new S(e,r);return s.chooseMove(qi.of(o),s.getState())})()}getSpaceClass(e,r){const s=new S(e,r),i=this.getState().getPieceAt(s),o=[];return o.push(this.getPlayerClass(i)),this.victoryCoords.some(c=>c.equals(s))&&o.push("victory-stroke"),this.lastMoved.equalsValue(s)&&o.push("last-move-stroke"),o}}return n.\u0275fac=function(e){return new(e||n)(J(En))},n.\u0275cmp=dt({type:n,selectors:[["app-new-game"]],features:[l],decls:4,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["x","0","y","0",1,"base","mid-small-stroke"],[4,"ngFor","ngForOf"],["class","captured-fill",3,"id","click",4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["class","base mid-stroke",3,"id","ngClass",4,"ngIf","ngIfElse"],["empty",""],[1,"base","mid-stroke",3,"id","ngClass"],["fill-opacity","0",1,"base","no-stroke"],[1,"base","mid-stroke"],["class","base-no-stroke",3,"id",4,"ngIf"],[1,"base-no-stroke",3,"id"],[1,"captured-fill",3,"id","click"]],template:function(e,r){1&e&&(F(),O(0,"svg",0),X(1,"rect",1),x(2,q8t,2,1,"g",2),x(3,j8t,1,5,"circle",3),A()),2&e&&(z("viewBox","0 -3 "+r.board.length*r.SPACE_SIZE*.5+" "+(6+r.board.length*r.SPACE_SIZE*.5)),P(1),z("width",r.board.length*r.SPACE_SIZE*.5)("height",r.board.length*r.SPACE_SIZE*.5),P(1),w("ngForOf",r.board),P(1),w("ngForOf",r.captured))},dependencies:[fn,On,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class n_ extends S{constructor(t,e,r){super(t,e),this.z=r}static getEncoder(t){return new class extends L4{encode(e){return{x:e.x,y:e.y,z:e.z}}decode(e){const r=e;return Pe(null!=r.x&&"number"==typeof r.x&&null!=r.y&&"number"==typeof r.y&&null!=r.z&&"number"==typeof r.z,"Invalid encoded Coord3D"),t(r.x,r.y,r.z)}}}static of(t,e,r){return new n_(t,e,r)}toString(){return"Coord3D"+this.toShortString()}toShortString(){return"("+this.x+", "+this.y+", "+this.z+")"}equals(t){return this===t||t.x===this.x&&t.y===this.y&&t.z===this.z}isHigherThan(t){return this.z>t.z}}class wn extends n_{constructor(t,e,r){if(super(t,e,r),t<0||t>3)throw new Error(`PylosCoord: Invalid X: ${t}.`);if(e<0||e>3)throw new Error(`PylosCoord: Invalid Y: ${e}.`);if(r<0||r>3)throw new Error(`PylosCoord: Invalid Z: ${r}.`);const s=4-r;if(this.isNotInRange(s,s))throw new Error(this.toString()+" is not in range.")}static from(t,e,r){return new wn(t,e,r)}toString(){return"PylosCoord"+this.toShortString()}getLowerPieces(){if(0===this.z)throw new Error("PylosCoord: floor pieces don't have lower pieces.");const t=this.z-1;return[new wn(this.x,this.y,t),new wn(this.x+1,this.y,t),new wn(this.x,this.y+1,t),new wn(this.x+1,this.y+1,t)]}getHigherCoords(){if(3===this.z)throw new Error("Top piece don't have lower pieces.");const t=this.z+1,e=new S(this.x-1,this.y-1),r=new S(this.x,this.y-1),s=new S(this.x-1,this.y),i=new S(this.x,this.y),o=4-t;return[e,r,s,i].filter(c=>c.isInRange(o,o)).map(c=>new wn(c.x,c.y,t))}getNextValid(t){const e=new S(this.x,this.y).getNext(t),r=4-this.z;return e.isNotInRange(r,r)?T.empty():T.of(new wn(e.x,e.y,this.z))}}wn.coordEncoder=n_.getEncoder(wn.from),wn.optionalEncoder=T.getEncoder(wn.coordEncoder);let m8=(()=>{class n{}return n.MUST_MOVE_UPWARD=()=>$localize`You must move your pieces upward.`,n.SHOULD_HAVE_SUPPORTING_PIECES=()=>$localize`Your piece must land on the board or on 4 other pieces.`,n.CANNOT_MOVE_SUPPORTING_PIECE=()=>$localize`You cannot move a supporting piece.`,n.CANNOT_CAPTURE=()=>$localize`You cannot capture.`,n.INVALID_FIRST_CAPTURE=()=>$localize`Your first capture is invalid.`,n.INVALID_SECOND_CAPTURE=()=>$localize`Your second capture is invalid.`,n})(),D3e=(()=>{class n{}return n.MUST_CAPTURE_MAXIMUM_TWO_PIECES=()=>$localize`You must capture one or two pieces, not more.`,n})();class Cs extends Fi{constructor(t,e,r,s){super(),this.startingCoord=t,this.landingCoord=e,this.firstCapture=r,this.secondCapture=s}static fromClimb(t,e,r){const s=T.of(t),i=Cs.checkCaptures(r),o=new Cs(s,e,i.firstCapture,i.secondCapture);if(!1===e.isHigherThan(t))throw new Error(m8.MUST_MOVE_UPWARD());return o}static checkCaptures(t){let e=T.empty(),r=T.empty();if(t.length>0&&(e=T.of(t[0]),t.length>1)){if(t[1].equals(t[0]))throw new Error("PylosMove: should not capture twice same piece.");if(r=T.of(t[1]),t[1].isHigherThan(t[0])&&(e=T.of(t[1]),r=T.of(t[0])),t.length>2)throw new Error(D3e.MUST_CAPTURE_MAXIMUM_TWO_PIECES())}return{firstCapture:e,secondCapture:r}}static fromDrop(t,e){const r=T.empty(),s=Cs.checkCaptures(e);return new Cs(r,t,s.firstCapture,s.secondCapture)}static changeCapture(t,e){const r=Cs.checkCaptures(e);return new Cs(t.startingCoord,t.landingCoord,r.firstCapture,r.secondCapture)}isClimb(){return this.startingCoord.isPresent()}toString(){const t=this.startingCoord.isAbsent()?"-":this.startingCoord.get().toShortString(),e=this.firstCapture.isAbsent()?"-":this.firstCapture.get().toShortString(),r=this.secondCapture.isAbsent()?"-":this.secondCapture.get().toShortString();return"PylosMove("+t+", "+this.landingCoord.toShortString()+", "+e+", "+r+")"}equals(t){return t===this||!!(this.startingCoord.equals(t.startingCoord)&&this.landingCoord.equals(t.landingCoord)&&this.firstCapture.equals(t.firstCapture)&&this.secondCapture.equals(t.secondCapture))}}Cs.encoder=new class extends Nt{encodeMove(n){return{firstCapture:wn.optionalEncoder.encode(n.firstCapture),landingCoord:wn.coordEncoder.encode(n.landingCoord),secondCapture:wn.optionalEncoder.encode(n.secondCapture),startingCoord:wn.optionalEncoder.encode(n.startingCoord)}}decodeMove(n){const e=n.firstCapture,r=n.landingCoord,s=n.secondCapture;return new Cs(wn.optionalEncoder.decode(n.startingCoord),wn.coordEncoder.decode(r),wn.optionalEncoder.decode(e),wn.optionalEncoder.decode(s))}};class jc extends _P{constructor(t,e){super(e),this.boards=t}static getInitialState(){const t=Xe.createTable(4,4,he.NONE),e=Xe.createTable(3,3,he.NONE),r=Xe.createTable(2,2,he.NONE);return new jc([t,e,r,[[he.NONE]]],0)}static getLevelRange(t){switch(t){case 0:return[0,1,2,3];case 1:return[0,1,2];default:return Me.expectToBe(t,2),[0,1]}}getPieceAt(t){return this.boards[t.z][t.y][t.x]}applyLegalMove(t,e=!0){const r=[];let s;return r.push({coord:t.landingCoord,value:this.getCurrentPlayer()}),t.startingCoord.isPresent()&&r.push({coord:t.startingCoord.get(),value:he.NONE}),t.firstCapture.isPresent()&&r.push({coord:t.firstCapture.get(),value:he.NONE}),t.secondCapture.isPresent()&&r.push({coord:t.secondCapture.get(),value:he.NONE}),s=e?this.turn+1:this.turn,this.setBoardAtCoords(r,s)}setBoardAtCoords(t,e){const r=[Xe.copyBiArray(this.boards[0]),Xe.copyBiArray(this.boards[1]),Xe.copyBiArray(this.boards[2]),Xe.copyBiArray(this.boards[3])];for(const s of t){const i=s.coord;r[i.z][i.y][i.x]=s.value}return new jc(r,e)}isLandable(t){if(this.getPieceAt(t).isPlayer())return!1;if(0===t.z)return!0;const e=t.getLowerPieces();for(const r of e)if(this.getPieceAt(r)===he.NONE)return!1;return!0}isSupporting(t){if(3===t.z)return!1;const e=t.getHigherCoords();for(const r of e)if(this.getPieceAt(r).isPlayer())return!0;return!1}getPiecesRepartition(){const t={};t[he.NONE.value]=0,t[B.ZERO.value]=0,t[B.ONE.value]=0;for(let e=0;e<3;e++)for(let r=0;r<4-e;r++)for(let s=0;s<4-e;s++){const i=new wn(s,r,e),o=this.getPieceAt(i);t[o.value]=1+t[o.value]}return t}removePieceAt(t){return this.setBoardAtCoords([{coord:t,value:he.NONE}],this.turn)}dropCurrentPlayersPieceAt(t){const e={coord:t,value:this.getCurrentPlayer()};return this.setBoardAtCoords([e],this.turn)}getFreeToMoves(){const t=[],e=this.getCurrentPlayer();for(let r=0;r<=2;r++){const s=jc.getLevelRange(r);for(const i of s)for(const o of s){const c=new wn(o,i,r);this.getPieceAt(c).equals(e)&&!1===this.isSupporting(c)&&t.push(c)}}return t}}class _a extends L1{static getStateInfo(t){const e=[],r=[];for(let s=0;s<3;s++)for(let i=0;i<4-s;i++)for(let o=0;o<4-s;o++){const c=new wn(o,i,s);t.getPieceAt(c)===t.getCurrentPlayer()&&!1===t.isSupporting(c)&&e.push(c),t.isLandable(c)&&r.push(c)}return{freeToMove:e,landable:r}}static getClimbingMoves(t){const e=[];for(const r of t.freeToMove)for(const s of t.landable)if(s.isHigherThan(r)&&!1===s.getLowerPieces().some(i=>r.equals(i))){const i=Cs.fromClimb(r,s,[]);e.push(i)}return e}static getDropMoves(t){const e=[];for(const r of t.landable){const s=Cs.fromDrop(r,[]);e.push(s)}return e}static canCapture(t,e){const r=t.getCurrentPlayer();for(const s of[$e.UP,$e.DOWN]){const i=e.getNextValid(s);if(i.isPresent()&&t.getPieceAt(i.get())===r)for(const o of[$e.LEFT,$e.RIGHT]){const c=i.get().getNextValid(o);if(c.isPresent()&&t.getPieceAt(c.get())===r){const u=s.getOpposite(),d=c.get().getNextValid(u).get();if(t.getPieceAt(d)===r)return!0}}}return!1}static getPossibleCaptures(t){const e=new zt,r=t.getFreeToMoves();for(const s of r){e.add(new zt([s]));const o=t.removePieceAt(s).getFreeToMoves();for(const c of o){const u=new zt([s,c]);e.add(u)}}return e}static applyLegalMove(t,e,r){return e.applyLegalMove(t)}static isValidCapture(t,e,r){const s=t.getCurrentPlayer();return!(!r.equals(e.landingCoord)&&t.getPieceAt(r)!==s)&&0===r.getHigherCoords().filter(o=>t.getPieceAt(o).isPlayer()&&!1===o.equals(e.firstCapture.get())).length}static getGameStatus(t){const r=t.gameState.getPiecesRepartition();return 15===r[B.ZERO.value]?xe.ONE_WON:15===r[B.ONE.value]?xe.ZERO_WON:xe.ONGOING}applyLegalMove(t,e,r){return _a.applyLegalMove(t,e,r)}isLegal(t,e){const r=this.isLegalStartingCoord(t,e);if(r.isFailure())return r.toOtherFallible();const s=r.get(),i=this.isLegalLandingCoord(t,s);if(i.isFailure())return i.toOtherFallible();const o=i.get(),c=this.isLegalCaptures(t,o);return c.isFailure()?c:R.SUCCESS}isLegalStartingCoord(t,e){const r=e.getCurrentOpponent();if(t.startingCoord.isPresent()){const s=t.startingCoord.get(),i=e.getPieceAt(s);if(i===r)return _e.failure(et.CANNOT_CHOOSE_OPPONENT_PIECE());if(i===he.NONE)return _e.failure(et.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(0===s.getHigherCoords().filter(c=>e.getPieceAt(c).isPlayer()).length){const c=e.removePieceAt(t.startingCoord.get());return _e.success(c)}return _e.failure(m8.CANNOT_MOVE_SUPPORTING_PIECE())}return _e.success(e)}isLegalLandingCoord(t,e){return e.getPieceAt(t.landingCoord).isPlayer()?_e.failure(et.MUST_LAND_ON_EMPTY_SPACE()):e.isLandable(t.landingCoord)?_e.success(e.dropCurrentPlayersPieceAt(t.landingCoord)):_e.failure(m8.SHOULD_HAVE_SUPPORTING_PIECES())}isLegalCaptures(t,e){if(t.firstCapture.isAbsent())return R.SUCCESS;if(!1===_a.canCapture(e,t.landingCoord))return R.failure(m8.CANNOT_CAPTURE());if(_a.isValidCapture(e,t,t.firstCapture.get())){const r=e.removePieceAt(t.firstCapture.get());return t.secondCapture.isAbsent()||_a.isValidCapture(r,t,t.secondCapture.get())?R.SUCCESS:R.failure(m8.INVALID_SECOND_CAPTURE())}return R.failure(m8.INVALID_FIRST_CAPTURE())}getGameStatus(t){return _a.getGameStatus(t)}}class r_ extends xs{static getListMoves(t){const e=t.gameState,r=[],s=_a.getStateInfo(e),i=_a.getClimbingMoves(s),o=_a.getDropMoves(s),c=i.concat(o);for(const u of c){const d=e.applyLegalMove(u,!1);let g=new zt;_a.canCapture(d,u.landingCoord)?g=_a.getPossibleCaptures(d):r.push(u);for(const m of g){const y=Cs.changeCapture(u,m.toList());r.push(y)}}return r}getListMoves(t){return r_.getListMoves(t)}getMetrics(t){const e=t.gameState.getPiecesRepartition();return[e[B.ZERO.value],e[B.ONE.value]]}}class Dd extends r_{static countStoneUsed(t){let e=t.isClimb()?0:1;return t.firstCapture.isPresent()&&(e-=1,t.secondCapture.isPresent()&&(e-=1)),e}static sumMoveEmplacementByValue(t){let e=t.landingCoord.z;return t.startingCoord.isPresent()&&(e+=3-t.startingCoord.get().z),t.firstCapture.isPresent()&&(e+=3-t.firstCapture.get().z,t.secondCapture.isPresent()&&(e+=3-t.secondCapture.get().z)),e}getListMoves(t){const e=r_.getListMoves(t);return this.orderMoves(e)}orderMoves(t){return t.sort((e,r)=>{const s=12*Dd.countStoneUsed(e),i=12*Dd.countStoneUsed(r);return s+Dd.sumMoveEmplacementByValue(e)-(i+Dd.sumMoveEmplacementByValue(r))})}}const ot=he.NONE,M6=he.ZERO,z3e=he.ONE;class V3e extends $1{constructor(){super(...arguments),this.tutorial=[ie.informational($localize`Goal of the game`,$localize`At Pylos, the goal is to be the last to play.
        To do this, you have to save up your pieces.
        As soon as a player puts its last piece, that player loses the game immediately.
        Here is what the initial board looks like, it is a board of 4 x 4 squares.
        This board will become a pyramid, little by little.
        It will be filled by the pieces of your stock. Each player has 15 pieces.`,jc.getInitialState()),ie.anyMove($localize`Dropping a piece`,$localize`When it is your turn, you can always drop one of your piece on an empty square.
        The gray squares are where you can drop your pieces.<br/><br/>
        Click on one of the squares to drop a piece there.`,jc.getInitialState(),Cs.fromDrop(new wn(1,1,0),[]),$localize`There you go, as simple as that.`),ie.fromMove($localize`Climbing`,$localize`When 4 pieces form a square, it is possible to put a fifth piece on top.
        However, when that happens, you can save a piece by climbing instead of dropping a piece.
        To climb:
        <ol>
            <li>Click on one of your free pieces, which should be lower than the landing square.</li>
            <li>Click on an empty landing square, higher than your selected piece.</li>
        </ol><br/>
        You're playing Dark, go ahead and climb!`,new jc([[[M6,z3e,ot,ot],[z3e,M6,ot,ot],[ot,ot,ot,ot],[ot,ot,ot,M6]],[[ot,ot,ot],[ot,ot,ot],[ot,ot,ot]],[[ot,ot],[ot,ot]],[[ot]]],0),[Cs.fromClimb(new wn(3,3,0),new wn(0,0,1),[])],$localize`Congratulations!<br/>
        Some important notes:
        <ol>
            <li>You cannot move a piece that is directly below another one.</li>
            <li>Of course, you cannot move the opponent's pieces.</li>
            <li>You can only climb when the landing square is higher than the starting square.</li>
        </ol>`,$localize`Failed. Try again.`),ie.fromMove($localize`Square (1/2)`,$localize`When the piece you just moved or dropped is the fourth one of a square of your color,
        you can choose anywhere on the board one or two of your pieces.
        These pieces will be removed from the board, allowing you to save up one or two pieces.
        A chosen piece must not be directly below another piece.
        A chosen piece can be the piece you just placed.<br/><br/>
        You're playing Dark. Form a square, click on one of the four pieces, then click on the V symbol on the bottom right to finalize your move.`,new jc([[[M6,M6,ot,ot],[ot,M6,ot,ot],[ot,ot,ot,ot],[ot,ot,ot,ot]],[[ot,ot,ot],[ot,ot,ot],[ot,ot,ot]],[[ot,ot],[ot,ot]],[[ot]]],0),[Cs.fromDrop(new wn(0,1,0),[new wn(0,0,0)]),Cs.fromDrop(new wn(0,1,0),[new wn(0,1,0)]),Cs.fromDrop(new wn(0,1,0),[new wn(1,0,0)]),Cs.fromDrop(new wn(0,1,0),[new wn(1,1,0)])],$localize`Congratulations, you have saved up one piece. Note, you can cancel your selection by clicking again on the piece.`,$localize`Failed. Try again.`),ie.fromPredicate($localize`Square (2/2)`,$localize`You're playing Dark.<br/><br/>
        Do like in the previous step, but this time click on two different pieces before validating.`,new jc([[[M6,M6,ot,ot],[ot,M6,ot,ot],[ot,ot,ot,ot],[ot,ot,ot,ot]],[[ot,ot,ot],[ot,ot,ot],[ot,ot,ot]],[[ot,ot],[ot,ot]],[[ot]]],0),Cs.fromDrop(new wn(0,1,0),[new wn(0,0,0),new wn(1,0,0)]),(t,e,r)=>t.secondCapture.isPresent()?R.SUCCESS:t.firstCapture.isPresent()?R.failure($localize`Failed, you only captured one piece.`):R.failure(b3e.YOU_DID_NOT_CAPTURE_ANY_PIECE()),$localize`Congratulations, you have saved up two pieces.`)]}}function Y8t(n,t){if(1&n&&(F(),X(0,"circle",8)),2&n){const e=t.$implicit,r=C().$implicit,s=C();De("id","piece_",r.value,"_",e,""),w("ngClass",s.getPlayerClass(r)),z("cx",s.SPACE_SIZE/4+e/15*(s.boardWidth-s.SPACE_SIZE/4))("cy",s.getPiecesCyForPlayer(r))("r",s.SPACE_SIZE/4-s.STROKE_WIDTH)}}function K8t(n,t){if(1&n&&(F(),O(0,"g"),x(1,Y8t,1,6,"circle",7),A()),2&n){const e=t.$implicit,r=C();P(1),w("ngForOf",r.getPlayerSidePieces(e))}}function X8t(n,t){if(1&n){const e=Oe();F(),O(0,"circle",12),ee("click",function(){ue(e);const s=C(2).$implicit,i=C().$implicit,o=C().$implicit;return ce(C().onPieceClick(s,i,o))}),A()}if(2&n){const e=C(2).$implicit,r=C().$implicit,s=C().$implicit,i=C();j2("id","piece_",e,"_",r,"_",s,""),w("ngClass",i.getPieceClasses(e,r,s)),z("r",i.getPieceRadius(s)-i.STROKE_WIDTH)("cx",i.getPieceCx(e,r,s))("cy",i.getPieceCy(e,r,s))}}function Q8t(n,t){if(1&n){const e=Oe();F(),O(0,"rect",12),ee("click",function(){ue(e);const s=C(3).$implicit,i=C().$implicit,o=C().$implicit;return ce(C().onDrop(s,i,o))}),A()}if(2&n){const e=C(3).$implicit,r=C().$implicit,s=C().$implicit,i=C();j2("id","drop_",e,"_",r,"_",s,""),w("ngClass",i.getSquareClasses(e,r,s)),z("width",2*i.getPieceRadius(s))("height",2*i.getPieceRadius(s))("x",i.getPieceCx(e,r,s)-i.getPieceRadius(s))("y",i.getPieceCy(e,r,s)-i.getPieceRadius(s))}}function J8t(n,t){if(1&n&&(F(),x(0,Q8t,1,8,"rect",13)),2&n){const e=C(2).$implicit,r=C().$implicit,s=C().$implicit;w("ngIf",C().mustDisplayLandingCoord(e,r,s))}}function eut(n,t){if(1&n&&(F(),pn(0),x(1,X8t,1,7,"circle",10),x(2,J8t,1,1,"ng-template",null,11,Zn),gn()),2&n){const e=Bn(3),r=C().$implicit,s=C().$implicit,i=C().$implicit,o=C();P(1),w("ngIf",o.isOccupied(r,s,i))("ngIfElse",e)}}function tut(n,t){if(1&n&&(F(),O(0,"g"),x(1,eut,4,2,"ng-container",9),A()),2&n){const e=t.$implicit,r=C().$implicit,s=C().$implicit,i=C();P(1),w("ngIf",i.mustDraw(e,r,s))}}function nut(n,t){if(1&n&&(F(),O(0,"g"),x(1,tut,2,1,"g",1),A()),2&n){const e=C().$implicit,r=C();P(1),w("ngForOf",r.getLevelRange(e))}}function rut(n,t){if(1&n&&(F(),O(0,"g"),x(1,nut,2,1,"g",1),A()),2&n){const e=t.$implicit,r=C();P(1),w("ngForOf",r.getLevelRange(e))}}function sut(n,t){if(1&n&&(F(),X(0,"rect",14)),2&n){const e=C();j2("id","highCapture_",e.highCapture.get().x,"_",e.highCapture.get().y,"_",e.highCapture.get().z,""),z("width",2*e.getPieceRadius(e.highCapture.get().z))("height",2*e.getPieceRadius(e.highCapture.get().z))("x",e.getPieceCxByCoord(e.highCapture.get())-e.getPieceRadius(e.highCapture.get().z))("y",e.getPieceCyByCoord(e.highCapture.get())-e.getPieceRadius(e.highCapture.get().z))}}function iut(n,t){if(1&n){const e=Oe();F(),O(0,"g",15),ee("click",function(){return ue(e),ce(C().validateCapture())}),X(1,"circle",16)(2,"polygon",17),A()}if(2&n){const e=C();z("transform","translate("+4*e.SPACE_SIZE+" "+4*e.SPACE_SIZE+")"),P(1),w("ngClass",e.getCaptureValidationButtonClasses()),z("cx",e.STROKE_WIDTH/2)("cy",e.STROKE_WIDTH/2)("r",e.SPACE_SIZE/2)}}function out(n,t){if(1&n){const e=Oe();F(),O(0,"g",18),ee("click",function(){const i=ue(e).$implicit;return ce(C().onPieceClick(i.x,i.y,i.z))}),X(1,"line",19)(2,"line",19),A()}if(2&n){const e=t.$implicit,r=C();j2("id","capturable_",e.x,"_",e.y,"_",e.z,""),z("transform","translate("+r.getPieceCxByCoord(e)+" "+r.getPieceCyByCoord(e)+")"),P(1),z("x1",-.25*r.getPieceRadius(e.z))("y1",-.25*r.getPieceRadius(e.z))("x2",.25*r.getPieceRadius(e.z))("y2",.25*r.getPieceRadius(e.z)),P(1),z("x1",.25*r.getPieceRadius(e.z))("y1",-.25*r.getPieceRadius(e.z))("x2",-.25*r.getPieceRadius(e.z))("y2",.25*r.getPieceRadius(e.z))}}const aut=function(){return[0,1,2]};let cut=(()=>{class n extends o8{constructor(e){super(e),this.boardWidth=4*this.SPACE_SIZE+this.STROKE_WIDTH,this.pieceRowHeight=this.SPACE_SIZE/2,this.boardHeight=this.boardWidth+2*this.pieceRowHeight,this.lastLandingCoord=T.empty(),this.lastStartingCoord=T.empty(),this.lastFirstCapture=T.empty(),this.lastSecondCapture=T.empty(),this.highCapture=T.empty(),this.capturables=[],this.chosenStartingCoord=T.empty(),this.chosenLandingCoord=T.empty(),this.chosenFirstCapture=T.empty(),this.chosenSecondCapture=T.empty(),this.lastMove=T.empty(),this.remainingPieces={0:15,1:15},this.hasAsymmetricBoard=!0,this.rules=new _a(jc),this.availableMinimaxes=[new r_(this.rules,"PylosMinimax"),new Dd(this.rules,"PylosOrderedMinimax")],this.encoder=Cs.encoder,this.tutorial=(new V3e).tutorial,this.updateBoard()}getPiecesCyForPlayer(e){return e===B.ONE?this.pieceRowHeight/2:this.boardWidth+1.5*this.pieceRowHeight}getLevelRange(e){return jc.getLevelRange(e)}mustDraw(e,r,s){const i=new wn(e,r,s);return!!(this.constructedState.getPieceAt(i).isPlayer()||this.justClimbed(i)||this.isCaptured(i))||this.chosenLandingCoord.isAbsent()&&this.constructedState.isLandable(i)}isCaptured(e){return this.chosenFirstCapture.equalsValue(e)||this.chosenSecondCapture.equalsValue(e)}onPieceClick(e,r,s){var i=this;return I(function*(){const o=i.canUserPlay("#piece_"+e+"_"+r+"_"+s);if(o.isFailure())return i.cancelMove(o.getReason());const c=new wn(e,r,s);return i.state.getPieceAt(c)===i.state.getCurrentOpponent()?i.cancelMove(et.CANNOT_CHOOSE_OPPONENT_PIECE()):i.chosenStartingCoord.equalsValue(c)?(i.cancelMoveAttempt(),R.SUCCESS):i.chosenLandingCoord.isPresent()?i.isSupporting(c,i.constructedState)?i.cancelMove(m8.CANNOT_MOVE_SUPPORTING_PIECE()):i.onCaptureClick(c):i.isSupporting(c,i.getState())?i.cancelMove(m8.CANNOT_MOVE_SUPPORTING_PIECE()):i.onClimbClick(c)})()}isSupporting(e,r){return r.isSupporting(e)}onClimbClick(e){var r=this;return I(function*(){return r.chosenStartingCoord=T.of(e),r.constructedState=r.constructedState.removePieceAt(e),R.SUCCESS})()}onCaptureClick(e){var r=this;return I(function*(){return r.chosenFirstCapture.equalsValue(e)?(r.chosenFirstCapture=T.empty(),r.constructedState=r.constructedState.dropCurrentPlayersPieceAt(e),r.updateCapturableList(),R.SUCCESS):r.chosenSecondCapture.equalsValue(e)?(r.chosenSecondCapture=T.empty(),r.constructedState=r.constructedState.dropCurrentPlayersPieceAt(e),r.updateCapturableList(),R.SUCCESS):r.chosenFirstCapture.isAbsent()?(r.chosenFirstCapture=T.of(e),r.constructedState=r.constructedState.removePieceAt(e),r.updateCapturableList(),R.SUCCESS):r.chosenSecondCapture.isAbsent()?(r.chosenSecondCapture=T.of(e),r.constructedState=r.constructedState.removePieceAt(e),r.updateCapturableList(),R.SUCCESS):r.cancelMove(D3e.MUST_CAPTURE_MAXIMUM_TWO_PIECES())})()}updateCapturableList(){this.capturables=this.constructedState.getFreeToMoves()}getCaptureValidationButtonClasses(){return this.chosenFirstCapture.isPresent()||this.chosenSecondCapture.isPresent()?"":"semi-transparent"}validateCapture(){var e=this;return I(function*(){const r=e.canUserPlay("#capture_validation");return r.isFailure()?e.cancelMove(r.getReason()):e.chosenFirstCapture.isAbsent()&&e.chosenSecondCapture.isAbsent()?R.SUCCESS:e.chosenFirstCapture.isPresent()&&e.chosenSecondCapture.isAbsent()?e.concludeMoveWithCapture([e.chosenFirstCapture.get()]):e.chosenFirstCapture.isAbsent()&&e.chosenSecondCapture.isPresent()?e.concludeMoveWithCapture([e.chosenSecondCapture.get()]):e.concludeMoveWithCapture([e.chosenFirstCapture.get(),e.chosenSecondCapture.get()])})()}concludeMoveWithCapture(e){var r=this;return I(function*(){let s;return s=r.chosenStartingCoord.isAbsent()?Cs.fromDrop(r.chosenLandingCoord.get(),e):Cs.fromClimb(r.chosenStartingCoord.get(),r.chosenLandingCoord.get(),e),r.tryMove(s,r.state)})()}tryMove(e,r){var s=this;return I(function*(){return s.cancelMove(),s.chooseMove(e,r)})()}cancelMoveAttempt(){this.constructedState=this.state,this.chosenStartingCoord=T.empty(),this.chosenLandingCoord=T.empty(),this.chosenFirstCapture=T.empty(),this.chosenSecondCapture=T.empty(),this.capturables=[]}onDrop(e,r,s){var i=this;return I(function*(){const o=i.canUserPlay("#drop_"+e+"_"+r+"_"+s);if(o.isFailure())return i.cancelMove(o.getReason());const c=new wn(e,r,s);return _a.canCapture(i.constructedState,c)?(i.chosenLandingCoord=T.of(c),i.constructedState=i.constructedState.dropCurrentPlayersPieceAt(c),i.updateCapturableList(),R.SUCCESS):(i.chosenLandingCoord=T.of(c),i.concludeMoveWithCapture([]))})()}getSquareClasses(e,r,s){const i=new wn(e,r,s);if(this.lastMove.isPresent()){const o=this.lastMove.get();if(o.firstCapture.equalsValue(i)||o.secondCapture.equalsValue(i))return["captured-fill"];if(i.equals(o.landingCoord)||o.startingCoord.equalsValue(i))return["moved-fill"]}else if(this.justClimbed(i))return["moved-fill"];return[]}justClimbed(e){return this.chosenLandingCoord.isPresent()&&this.chosenStartingCoord.equalsValue(e)}getPieceRadius(e){return this.SPACE_SIZE*(.45+.025*e)}getPieceCx(e,r,s){return this.SPACE_SIZE/2+.5*s*this.SPACE_SIZE+e*this.SPACE_SIZE}getPieceCy(e,r,s){return this.SPACE_SIZE/2+.5*s*this.SPACE_SIZE+r*this.SPACE_SIZE}getPieceCxByCoord(e){return this.getPieceCx(e.x,e.y,e.z)}getPieceCyByCoord(e){return this.getPieceCy(e.x,e.y,e.z)}isOccupied(e,r,s){const i=new wn(e,r,s);if(this.justClimbed(i))return!1;const o=this.getState().getPieceAt(i).isPlayer(),c=this.chosenLandingCoord.equalsValue(i);return o||c}getPieceClasses(e,r,s){const i=new wn(e,r,s),o=[this.getPieceFillClass(i)];return(this.lastLandingCoord.equalsValue(i)||this.lastStartingCoord.equalsValue(i))&&o.push("last-move-stroke"),(this.chosenStartingCoord.equalsValue(i)||this.chosenLandingCoord.equalsValue(i))&&o.push("selected-stroke"),this.isCaptured(i)&&o.push("pre-captured-fill"),o}getPieceFillClass(e){return this.chosenLandingCoord.equalsValue(e)?this.getPlayerClass(this.state.getCurrentPlayer()):this.getPlayerClass(this.state.getPieceAt(e))}getPlayerSidePieces(e){const r=this.remainingPieces[e.value],s=[];for(let i=0;i<r;i++)s.push(i);return s}updateBoard(){this.state=this.getState(),this.constructedState=this.state,this.lastMove=this.rules.node.move;const e=this.state.getPiecesRepartition();this.remainingPieces={0:15-e[0],1:15-e[1]},this.highCapture=T.empty(),this.cancelMoveAttempt(),this.hideLastMove()}showLastMove(e){this.lastLandingCoord=T.of(e.landingCoord),this.lastStartingCoord=e.startingCoord,this.lastFirstCapture=e.firstCapture,this.lastSecondCapture=e.secondCapture,this.lastFirstCapture.isPresent()&&!1===this.mustDrawCoord(this.lastFirstCapture.get())&&(this.highCapture=this.lastFirstCapture)}hideLastMove(){this.lastStartingCoord=T.empty(),this.lastLandingCoord=T.empty(),this.lastFirstCapture=T.empty(),this.lastSecondCapture=T.empty()}mustDrawCoord(e){return this.mustDraw(e.x,e.y,e.z)}mustDisplayLandingCoord(e,r,s){return!this.chosenStartingCoord.isPresent()||!!this.chosenStartingCoord.get().equals(new wn(e,r,s))||this.chosenStartingCoord.get().z<s}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(J(En))},n.\u0275cmp=dt({type:n,selectors:[["app-pylos"]],features:[l],decls:10,vars:11,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["boardInItself",""],["x","0","y","0",1,"base","small-stroke"],["class","base captured-fill small-stroke",3,"id",4,"ngIf"],["id","capture_validation",3,"click",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],["class","base small-stroke",3,"id","ngClass",4,"ngFor","ngForOf"],[1,"base","small-stroke",3,"id","ngClass"],[4,"ngIf"],["class","base small-stroke",3,"id","ngClass","click",4,"ngIf","ngIfElse"],["onlyRect",""],[1,"base","small-stroke",3,"id","ngClass","click"],["class","base small-stroke",3,"id","ngClass","click",4,"ngIf"],[1,"base","captured-fill","small-stroke",3,"id"],["id","capture_validation",3,"click"],["fill","red",1,"base-no-fill","small-stroke",3,"ngClass"],["points","-32.5,-2.5 -32.5,12.5 -10,35 -2.5,35 35,-21.25 25,-21.275 -5,25 -32.5,-2.5","fill","green",1,"base-no-fill","small-stroke"],[3,"id","click"],["stroke-width","8","stroke","red"]],template:function(e,r){1&e&&(F(),O(0,"svg",0)(1,"g"),x(2,K8t,2,1,"g",1),A(),O(3,"g",null,2),X(5,"rect",3),x(6,rut,2,1,"g",1),x(7,sut,1,7,"rect",4),x(8,iut,3,5,"g",5),x(9,out,3,12,"g",6),A()()),2&e&&(z("viewBox","0 0 "+r.boardWidth+" "+r.boardHeight),P(1),z("transform","rotate("+180*r.role.value+" "+r.boardWidth/2+" "+r.boardHeight/2+")"),P(1),w("ngForOf",r.Player.PLAYERS),P(1),z("transform","translate("+r.STROKE_WIDTH/2+" "+(r.STROKE_WIDTH/2+r.pieceRowHeight)+")"),P(2),z("width",4*r.SPACE_SIZE)("height",4*r.SPACE_SIZE),P(1),w("ngForOf",J1(10,aut)),P(1),w("ngIf",r.highCapture.isPresent()),P(1),w("ngIf",r.chosenLandingCoord.isPresent()),P(1),w("ngForOf",r.capturables))},dependencies:[fn,On,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class Ye{constructor(t){this.value=t}static fromInt(t){if(0<=t&&t<=15)return Ye.pieces[t];if(16===t)return Ye.EMPTY;throw new Error("Invalid piece ("+t+")")}equals(t){return this===t}toString(){return"QuartoPiece("+this.value+")"}isRectangle(){return this.value%4<2}}Ye.AAAA=new Ye(0),Ye.AAAB=new Ye(1),Ye.AABA=new Ye(2),Ye.AABB=new Ye(3),Ye.ABAA=new Ye(4),Ye.ABAB=new Ye(5),Ye.ABBA=new Ye(6),Ye.ABBB=new Ye(7),Ye.BAAA=new Ye(8),Ye.BAAB=new Ye(9),Ye.BABA=new Ye(10),Ye.BABB=new Ye(11),Ye.BBAA=new Ye(12),Ye.BBAB=new Ye(13),Ye.BBBA=new Ye(14),Ye.BBBB=new Ye(15),Ye.EMPTY=new Ye(16),Ye.pieces=[Ye.AAAA,Ye.AAAB,Ye.AABA,Ye.AABB,Ye.ABAA,Ye.ABAB,Ye.ABBA,Ye.ABBB,Ye.BAAA,Ye.BAAB,Ye.BABA,Ye.BABB,Ye.BBAA,Ye.BBAB,Ye.BBBA,Ye.BBBB],Ye.encoder=Nt.fromFunctions(n=>n.value,Ye.fromInt);class j4 extends Ks{constructor(t,e,r){super(t,e),this.piece=r}toString(){return"QuartoMove("+this.coord.x+", "+this.coord.y+", "+this.piece.value+")"}equals(t){return this===t||!1!==t.coord.equals(this.coord)&&this.piece===t.piece}}j4.encoder=Nt.tuple([S.encoder,Ye.encoder],n=>[n.coord,n.piece],n=>new j4(n[0].x,n[0].y,n[1]));class Zc extends Br{constructor(t,e,r){super(t,e),this.pieceInHand=r}static getInitialState(){const t=Xe.createTable(4,4,Ye.EMPTY);return new Zc(t,0,Ye.AAAA)}static isGivable(t,e,r){return t!==r&&!1===Zc.isAlreadyOnBoard(t,e)}static isAlreadyOnBoard(t,e){for(let r=0;r<4;r++)for(let s=0;s<4;s++)if(e[r][s]===t)return!0;return!1}getRemainingPieces(){const t=Ye.pieces,e=[];for(const r of t)Zc.isGivable(r,this.board,this.pieceInHand)&&e.push(r);return e}}let qH=(()=>{class n{}return n.MUST_GIVE_A_PIECE=()=>$localize`You must give a piece.`,n.PIECE_ALREADY_ON_BOARD=()=>$localize`That piece is already on the board.`,n.CANNOT_GIVE_PIECE_IN_HAND=()=>$localize`You cannot give the piece that was in your hands.`,n})();class s_{constructor(t){this.subCriterion=[T.empty(),T.empty(),T.empty(),T.empty()],this.subCriterion[0]=T.of(8==(8&t.value)),this.subCriterion[1]=T.of(4==(4&t.value)),this.subCriterion[2]=T.of(2==(2&t.value)),this.subCriterion[3]=T.of(1==(1&t.value))}mergeWith(t){let e=4;for(let r=0;r<4;r++)!1===this.subCriterion[r].equals(t.subCriterion[r])&&(this.subCriterion[r]=T.empty()),this.subCriterion[r].isAbsent()&&e--;return e>0}mergeWithQuartoPiece(t){const e=new s_(t);return this.mergeWith(e)}areAllAbsent(){for(let t=0;t<4;t++)if(this.subCriterion[t].isPresent())return!1;return!0}match(t){for(let e=0;e<4;e++)if(this.subCriterion[e].equals(t.subCriterion[e]))return!0;return!1}matchPiece(t){return this.match(new s_(t))}toString(){return"Criterion{"+this.subCriterion.map(t=>t.isPresent()?t.get()?"1":"0":"x").join(" ")+"}"}}class Z4{constructor(t,e){this.initialCoord=t,this.direction=e}allCoords(){const t=[];for(let e=0;e<4;e++)t.push(this.initialCoord.getNext(this.direction,e));return t}}class ti extends L1{static isOccupied(t){return t!==Ye.EMPTY}static isLegal(t,e){const r=t.coord.x,s=t.coord.y,i=t.piece,o=e.getCopiedBoard(),c=e.pieceInHand;return ti.isOccupied(o[s][r])?R.failure(et.MUST_LAND_ON_EMPTY_SPACE()):i===Ye.EMPTY?15===e.turn?R.SUCCESS:R.failure(qH.MUST_GIVE_A_PIECE()):Zc.isAlreadyOnBoard(i,o)?R.failure(qH.PIECE_ALREADY_ON_BOARD()):c===i?R.failure(qH.CANNOT_GIVE_PIECE_IN_HAND()):R.SUCCESS}isLegal(t,e){return ti.isLegal(t,e)}applyLegalMove(t,e,r){const s=e.getCopiedBoard();return s[t.coord.y][t.coord.x]=e.pieceInHand,new Zc(s,e.turn+1,t.piece)}static updateBoardStatus(t,e,r){return r.score===Mn.PRE_VICTORY?this.isThereAVictoriousLine(t,e)?{score:Mn.VICTORY,sensitiveSquares:new Ar}:r:this.searchForVictoryOrPreVictoryInLine(t,e,r)}static isThereAVictoriousLine(t,e){let r=t.initialCoord,s=e.getPieceAt(r);const i=new s_(s);for(let o=0;o<3&&!1!==ti.isOccupied(s)&&!i.areAllAbsent();o++)r=r.getNext(t.direction,1),s=e.getPieceAt(r),i.mergeWithQuartoPiece(s);return!(!ti.isOccupied(s)||i.areAllAbsent())}static searchForVictoryOrPreVictoryInLine(t,e,r){const s=ti.getLineInfos(t,e,r);if(s.boardStatus.isPresent())return s.boardStatus.get();const i=s.commonCriterion,o=s.sensitiveCoord;if(i.isPresent()&&!1===i.get().areAllAbsent()){if(o.isAbsent())return{score:Mn.VICTORY,sensitiveSquares:new Ar};{i.get().matchPiece(e.pieceInHand)&&(r.score=Mn.PRE_VICTORY);const c=o.get();r.sensitiveSquares.add(c)}}return r}static getLineInfos(t,e,r){let s=T.empty(),i=T.empty(),o=t.initialCoord;for(let c=0;c<4;c++){const u=e.getPieceAt(o);if(u===Ye.EMPTY){if(!s.isAbsent())return{sensitiveCoord:T.of(o),commonCriterion:i,boardStatus:T.of(r)};s=T.of(o)}else i.isAbsent()?(i=T.of(new s_(u)),Q(ti.VERBOSE,"set commonCrit to "+i.toString())):(i.get().mergeWithQuartoPiece(u),Q(ti.VERBOSE,"update commonCrit: "+i.toString()));o=o.getNext(t.direction,1)}return{commonCriterion:i,sensitiveCoord:s,boardStatus:T.empty()}}static scoreToGameStatus(t,e){const r=B.of(e%2);return t===Mn.VICTORY?xe.getDefeat(r):16===e?xe.DRAW:xe.ONGOING}getGameStatus(t){const e=t.gameState;let r={score:Mn.DEFAULT,sensitiveSquares:new Ar};for(const s of ti.lines)if(r=ti.updateBoardStatus(s,e,r),r.score===Mn.VICTORY)return ti.scoreToGameStatus(r.score,e.turn);return ti.scoreToGameStatus(r.score,e.turn)}getVictoriousCoords(t){for(const e of ti.lines)if(ti.isThereAVictoriousLine(e,t))return e.allCoords();return[]}}ti.VERBOSE=!1,ti.lines=[new Z4(new S(0,0),Ne.DOWN),new Z4(new S(1,0),Ne.DOWN),new Z4(new S(2,0),Ne.DOWN),new Z4(new S(3,0),Ne.DOWN),new Z4(new S(0,0),Ne.RIGHT),new Z4(new S(0,1),Ne.RIGHT),new Z4(new S(0,2),Ne.RIGHT),new Z4(new S(0,3),Ne.RIGHT),new Z4(new S(0,0),Ne.DOWN_RIGHT),new Z4(new S(0,3),Ne.UP_RIGHT)];class jH extends k3{static scoreToBoardValue(t,e){if(t===Mn.DEFAULT)return new k1(0);{const r=B.of(e%2);return new k1(t===Mn.PRE_VICTORY?r.getPreVictory():r.getDefeatValue())}}getListMoves(t){const e=[],r=t.gameState,s=r.getCopiedBoard(),i=r.getRemainingPieces(),o=r.pieceInHand;let c;for(let u=0;u<4;u++)for(let d=0;d<4;d++)if(s[u][d]===Ye.EMPTY){if(c=r.getCopiedBoard(),c[u][d]=o,15===r.turn){const g=new j4(d,u,Ye.EMPTY);return e.push(g),e}for(const g of i){const m=new j4(d,u,g);e.push(m)}}return e}getBoardValue(t){const e=t.gameState;let r={score:Mn.DEFAULT,sensitiveSquares:new Ar};for(const s of ti.lines)if(r=ti.updateBoardStatus(s,e,r),r.score===Mn.VICTORY)break;return jH.scoreToBoardValue(r.score,e.turn)}}const lut=Ye.AABA,uut=Ye.AABB,H3e=Ye.ABAA,fut=Ye.ABAB,dut=Ye.ABBA,F3e=Ye.BAAA,hut=Ye.BAAB,put=Ye.BABB,B3e=Ye.BBAA,gut=Ye.BBAB,ZH=Ye.BBBA,mut=Ye.BBBB,D1=Ye.EMPTY;class $3e extends $1{constructor(){super(...arguments),this.tutorial=[ie.informational($localize`Goal of the game`,$localize`Quarto is an alignment game.
        The goal is to align four pieces that have at least one common aspect:
        <ul>
          <li>their color (light or dark),</li>
          <li>their size (big or small),</li>
          <li>their pattern (empty or dotted),</li>
          <li>their shape (round or square).</li>
        </ul>
        Here, we have a board with a victory by an alignment of dark pieces.
        Note that the pieces are not owned by any player.`,new Zc([[ZH,B3e,H3e,lut],[D1,D1,D1,D1],[D1,D1,D1,D1],[D1,D1,D1,D1]],7,Ye.ABAB)),ie.anyMove($localize`Placement`,$localize`Every placement occurs in two steps: placing the piece you have in hand (in the small square) on a square of the board,
        and picking a piece that the opponent will have to place, by clicking on one of the pieces inside the dotted square.
        If you prefer, the order of these two steps can be reversed.
        Keep in mind that the second click confirms the move.<br/><br/>
        Make a move.`,new Zc([[ZH,uut,dut,D1],[D1,D1,D1,D1],[D1,F3e,D1,D1],[D1,D1,D1,D1]],7,Ye.ABAA),new j4(2,2,Ye.BAAB),$localize`Perfect!`),ie.fromMove($localize`Situation`,$localize`We have here a tricky situation.<br/><br/>
        Analyze the board and play your move, carefully paying attention not to let the opponent win on the next move.`,new Zc([[mut,ZH,gut,D1],[H3e,put,B3e,D1],[fut,F3e,hut,D1],[D1,D1,D1,D1]],7,Ye.AABA),[new j4(3,3,Ye.AABB)],$localize`Well done!`,$localize`Failed! Your opponent can either align:<ul><li>the squares horizontally on the third line or vertically on the third column,</li><li>small pieces horizontally on the first line or vertically on the second or third column,</li><li>empty pieces horizontally on the first line or vertically on the first column,</li><li>clear pieces diagonally.</li></ul>`)]}}function _ut(n,t){if(1&n&&(F(),X(0,"rect",12)),2&n){const e=C(2),r=e.$implicit,s=e.index,i=C().index,o=C();w("ngClass",o.getPieceClasses(r.value)),z("x",o.SPACE_SIZE*s+(o.SPACE_SIZE/2-o.getPieceSize(r.value)))("y",o.SPACE_SIZE*i+(o.SPACE_SIZE/2-o.getPieceSize(r.value)))("width",2*o.getPieceSize(r.value))("height",2*o.getPieceSize(r.value))}}function vut(n,t){if(1&n&&(F(),X(0,"circle",12)),2&n){const e=C(2),r=e.$implicit,s=e.index,i=C().index,o=C();w("ngClass",o.getPieceClasses(r.value)),z("cx",o.SPACE_SIZE*s+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*i+o.SPACE_SIZE/2)("r",o.getPieceSize(r.value))}}function Cut(n,t){if(1&n&&(F(),X(0,"circle")),2&n){const e=C(2).index,r=C().index,s=C();z("cx",s.SPACE_SIZE*e+s.SPACE_SIZE/2)("cy",s.SPACE_SIZE*r+s.SPACE_SIZE/2)("r",10)}}function yut(n,t){if(1&n&&(F(),O(0,"g"),x(1,_ut,1,5,"rect",10),x(2,vut,1,4,"ng-template",null,11,Zn),x(4,Cut,1,3,"circle",7),A()),2&n){const e=Bn(3),r=C().$implicit,s=C(2);P(1),w("ngIf",r.isRectangle())("ngIfElse",e),P(3),w("ngIf",s.pieceHasDot(r.value))}}function Eut(n,t){if(1&n){const e=Oe();F(),O(0,"g")(1,"rect",9),ee("click",function(){const i=ue(e).index,o=C().index;return ce(C().chooseCoord(i,o))}),A(),x(2,yut,5,3,"g",7),A()}if(2&n){const e=t.$implicit,r=t.index,s=C().index,i=C();P(1),De("id","chooseCoord_",r,"_",s,""),w("ngClass",i.getSquareClasses(r,s)),z("x",i.SPACE_SIZE*r)("y",i.SPACE_SIZE*s)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),P(1),w("ngIf",e!==i.EMPTY)}}function Mut(n,t){if(1&n&&(F(),O(0,"g",null,8),x(2,Eut,3,8,"g",2),A()),2&n){const e=t.$implicit;P(2),w("ngForOf",e)}}function Sut(n,t){if(1&n&&(F(),X(0,"rect",17)),2&n){const e=C(2);w("ngClass",e.getPieceClasses(e.pieceInHand.value)),z("x",e.SPACE_SIZE/2-e.getPieceSize(e.pieceInHand.value))("y",e.SPACE_SIZE/2-e.getPieceSize(e.pieceInHand.value))("width",2*e.getPieceSize(e.pieceInHand.value))("height",2*e.getPieceSize(e.pieceInHand.value))}}function Put(n,t){if(1&n&&(F(),X(0,"circle",12)),2&n){const e=C(2);w("ngClass",e.getPieceClasses(e.pieceInHand.value)),z("cx",e.SPACE_SIZE/2)("cy",e.SPACE_SIZE/2)("r",e.getPieceSize(e.pieceInHand.value))}}function Tut(n,t){if(1&n&&(F(),X(0,"circle")),2&n){const e=C(2);z("cx",e.SPACE_SIZE/2)("cy",e.SPACE_SIZE/2)("r",10)}}function wut(n,t){if(1&n){const e=Oe();F(),O(0,"g",13,14),ee("click",function(){return ue(e),ce(C().deselectDroppedPiece())}),X(2,"rect",15),x(3,Sut,1,5,"rect",16),x(4,Put,1,4,"ng-template",null,11,Zn),x(6,Tut,1,3,"circle",7),A()}if(2&n){const e=Bn(5),r=C();De("id","droppedPiece_",r.chosen.get().x,"_",r.chosen.get().y,""),z("transform","translate("+r.chosen.get().x*r.SPACE_SIZE+" "+r.chosen.get().y*r.SPACE_SIZE+")"),P(2),z("width",r.SPACE_SIZE)("height",r.SPACE_SIZE),P(1),w("ngIf",r.pieceInHand.isRectangle())("ngIfElse",e),P(3),w("ngIf",r.pieceHasDot(r.pieceInHand.value))}}function but(n,t){if(1&n&&(F(),O(0,"g",null,18),X(2,"rect",19),A()),2&n){const e=t.$implicit,r=C();P(2),z("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)("transform","translate("+e.x*r.SPACE_SIZE+" "+e.y*r.SPACE_SIZE+")")}}function Out(n,t){if(1&n&&(F(),X(0,"rect",12)),2&n){const e=C(2);w("ngClass",e.getPieceClasses(e.pieceInHand.value)),z("x",0)("y",.75*e.SPACE_SIZE)("transform","translate("+-e.getPieceSize(e.pieceInHand.value)+", "+-e.getPieceSize(e.pieceInHand.value)+")")("width",2*e.getPieceSize(e.pieceInHand.value))("height",2*e.getPieceSize(e.pieceInHand.value))}}function Aut(n,t){if(1&n&&(F(),X(0,"circle",21)),2&n){const e=C(2);w("ngClass",e.getPieceClasses(e.pieceInHand.value)),z("cy",.75*e.SPACE_SIZE)("r",e.getPieceSize(e.pieceInHand.value))}}function Nut(n,t){1&n&&(F(),X(0,"circle",22)),2&n&&z("cy",.75*C(2).SPACE_SIZE)("r",10)}function Iut(n,t){if(1&n&&(F(),O(0,"g"),x(1,Out,1,6,"rect",10),x(2,Aut,1,3,"ng-template",null,11,Zn),x(4,Nut,1,2,"circle",20),A()),2&n){const e=Bn(3),r=C();P(1),w("ngIf",r.pieceInHand.isRectangle())("ngIfElse",e),P(3),w("ngIf",r.pieceHasDot(r.pieceInHand.value))}}function xut(n,t){if(1&n&&(F(),X(0,"rect",27)),2&n){const e=C(2).index,r=C().index,s=C();y1("id","chosenPiece_",4*r+e,""),z("x",s.SPACE_SIZE*e)("y",s.SPACE_SIZE*r)("width",s.SPACE_SIZE)("height",s.SPACE_SIZE)}}function kut(n,t){if(1&n&&(F(),X(0,"rect",12)),2&n){const e=C(2).index,r=C().index,s=C();w("ngClass",s.getPieceClasses(4*r+e)),z("x",s.SPACE_SIZE*e+s.SPACE_SIZE/2-s.getPieceSize(4*r+e))("y",s.SPACE_SIZE*r+s.SPACE_SIZE/2-s.getPieceSize(4*r+e))("width",2*s.getPieceSize(4*r+e))("height",2*s.getPieceSize(4*r+e))}}function Lut(n,t){if(1&n&&(F(),X(0,"circle",12)),2&n){const e=C(2).index,r=C().index,s=C();w("ngClass",s.getPieceClasses(4*r+e)),z("cx",s.SPACE_SIZE*e+s.SPACE_SIZE/2)("cy",s.SPACE_SIZE*r+s.SPACE_SIZE/2)("r",s.getPieceSize(4*r+e))}}function Rut(n,t){if(1&n&&(F(),X(0,"circle")),2&n){const e=C(2).index,r=C().index,s=C();z("cx",s.SPACE_SIZE*e+s.SPACE_SIZE/2)("cy",s.SPACE_SIZE*r+s.SPACE_SIZE/2)("r",10)}}function Dut(n,t){if(1&n){const e=Oe();F(),O(0,"g",13),ee("click",function(){ue(e);const s=C().index,i=C().index;return ce(C().choosePiece(4*i+s))}),x(1,xut,1,5,"rect",26),x(2,kut,1,5,"rect",10),x(3,Lut,1,4,"ng-template",null,11,Zn),x(5,Rut,1,3,"circle",7),A()}if(2&n){const e=Bn(4),r=C().index,s=C().index,i=C();y1("id","choosePiece_",4*s+r,""),P(1),w("ngIf",i.pieceToGive.equalsValue(i.QuartoPiece.fromInt(4*s+r))),P(1),w("ngIf",(4*s+r)%4<2)("ngIfElse",e),P(3),w("ngIf",i.pieceHasDot(4*s+r))}}function zut(n,t){if(1&n&&(F(),O(0,"g"),x(1,Dut,6,5,"g",3),A()),2&n){const e=t.index,r=C().index,s=C();P(1),w("ngIf",s.isRemaining(4*r+e))}}function Vut(n,t){if(1&n&&(F(),O(0,"g",null,23),X(2,"rect",24,25),x(4,zut,2,1,"g",2),A()),2&n){const e=t.$implicit,r=C();z("transform","translate(0 "+6.5*r.SPACE_SIZE+")"),P(2),z("x",-.125*r.SPACE_SIZE)("y",-.125*r.SPACE_SIZE)("width",4.25*r.SPACE_SIZE)("height",4.25*r.SPACE_SIZE),P(2),w("ngForOf",e)}}let Hut=(()=>{class n extends ko{constructor(e){super(e),this.EMPTY=Ye.EMPTY,this.QuartoPiece=Ye,this.chosen=T.empty(),this.lastMove=T.empty(),this.pieceInHand=Ye.EMPTY,this.pieceToGive=T.empty(),this.victoriousCoords=[],this.rules=new ti(Zc),this.availableMinimaxes=[new jH(this.rules,"QuartoMinimax")],this.encoder=j4.encoder,this.tutorial=(new $3e).tutorial,this.pieceInHand=this.getState().pieceInHand,this.updateBoard()}updateBoard(){const e=this.getState(),r=this.rules.node.move;this.board=e.getCopiedBoard(),this.chosen=T.empty(),this.pieceInHand=e.pieceInHand,this.victoriousCoords=this.rules.getVictoriousCoords(e),this.lastMove=r.map(s=>s.coord)}chooseCoord(e,r){var s=this;return I(function*(){const i=s.canUserPlay("#chooseCoord_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());if(s.hideLastMove(),s.board[r][e]===Ye.EMPTY){if(s.showPieceInHandOnBoard(e,r),15===s.getState().turn){const o=new j4(e,r,Ye.EMPTY);return s.chooseMove(o,s.getState())}if(s.pieceToGive.isAbsent())return R.SUCCESS;{const o=new j4(e,r,s.pieceToGive.get());return s.chooseMove(o,s.getState())}}return s.cancelMove(et.MUST_CLICK_ON_EMPTY_SPACE())})()}choosePiece(e){var r=this;return I(function*(){const s=r.canUserPlay("#choosePiece_"+e);if(s.isFailure())return r.cancelMove(s.getReason());if(r.hideLastMove(),r.pieceToGive.equalsValue(Ye.fromInt(e)))return r.cancelMoveAttempt(),R.SUCCESS;if(r.pieceToGive=T.of(Ye.fromInt(e)),r.chosen.isAbsent())return R.SUCCESS;{const i=r.chosen.get(),o=new j4(i.x,i.y,r.pieceToGive.get());return r.chooseMove(o,r.rules.node.gameState)}})()}hideLastMove(){this.lastMove=T.empty()}cancelMoveAttempt(){this.hideLastMove(),this.pieceToGive=T.empty(),this.chosen=T.empty()}deselectDroppedPiece(){const e=this.chosen.getOrElse(new S(404,404)),s=this.canUserPlay("#droppedPiece_"+e.x+"_"+e.y);return s.isFailure()?this.cancelMove(s.getReason()):(this.cancelMoveAttempt(),R.SUCCESS)}showPieceInHandOnBoard(e,r){this.chosen=T.of(new S(e,r))}isRemaining(e){return Zc.isGivable(Ye.fromInt(e),this.board,this.pieceInHand)}getSquareClasses(e,r){const s=new S(e,r);return this.lastMove.equalsValue(s)?["moved-fill"]:[]}getPieceClasses(e){const r=[];return r.push(e%2==0?"player0-fill":"player1-fill"),r}getPieceSize(e){return e<8?40:25}pieceHasDot(e){return e!==Ye.EMPTY.value&&e%8<4}}return n.\u0275fac=function(e){return new(e||n)(J(En))},n.\u0275cmp=dt({type:n,selectors:[["app-quarto"]],features:[l],decls:11,vars:10,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["transform","translate(5 5)"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngIf"],["pieceInHandDiv",""],["x","0","y","0",1,"base","no-fill"],["rectangleInWhichThePieceInHandIsWaiting",""],[4,"ngIf"],["boardDiv",""],[1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass",4,"ngIf","ngIfElse"],["circle",""],[1,"base",3,"ngClass"],[3,"id","click"],["droppedPiece",""],["id","selected","x","0","y","0",1,"base","selected","mid-stroke"],["x","0","y","0","class","base",3,"ngClass",4,"ngIf","ngIfElse"],["x","0","y","0",1,"base",3,"ngClass"],["victoriousCoordsDiv",""],["id","victory","x","0","y","0",1,"base","no-fill","victory-stroke"],["cx","0",4,"ngIf"],["cx","0",1,"base",3,"ngClass"],["cx","0"],["remainingPiece",""],["stroke-dasharray","10, 10",1,"base","no-fill"],["rectangleInWhichTheRemainingPiecesAre",""],["class","base selected-stroke",3,"id",4,"ngIf"],[1,"base","selected-stroke",3,"id"]],template:function(e,r){1&e&&(F(),O(0,"svg",0)(1,"g",1),x(2,Mut,3,1,"g",2),x(3,wut,7,8,"g",3),x(4,but,3,3,"g",2),O(5,"g",null,4),X(7,"rect",5,6),x(9,Iut,5,3,"g",7),A(),x(10,Vut,5,6,"g",2),A()()),2&e&&(z("viewBox","0 0 "+4.25*r.SPACE_SIZE+" "+10.75*r.SPACE_SIZE),P(2),w("ngForOf",r.board),P(1),w("ngIf",r.chosen.isPresent()),P(1),w("ngForOf",r.victoriousCoords),P(1),z("transform","translate("+2*r.SPACE_SIZE+", "+4.5*r.SPACE_SIZE+")"),P(2),z("width",1.5*r.SPACE_SIZE)("height",1.5*r.SPACE_SIZE)("transform","translate("+-.75*r.SPACE_SIZE+", 0)"),P(2),w("ngIf",r.chosen.isAbsent()),P(1),w("ngForOf",r.board))},dependencies:[fn,On,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})(),Fut=(()=>{class n{}return n.NO_INSIDE_CLICK=()=>$localize`You must pick a space from the edge of the board.`,n})();class rc extends Ks{constructor(t,e,r){super(t,e),this.direction=r;const s=rc.isValidCoord(this.coord);if(s.isFailure())throw new Error(s.getReason());if(0===t&&r===$e.LEFT)throw new Error("Invalid direction: pawn on the left side can't be moved to the left.");if(4===t&&r===$e.RIGHT)throw new Error("Invalid direction: pawn on the right side can't be moved to the right.");if(0===e&&r===$e.UP)throw new Error("Invalid direction: pawn on the top side can't be moved up.");if(4===e&&r===$e.DOWN)throw new Error("Invalid direction: pawn on the bottom side can't be moved down.")}static isInRange(t){return t.isInRange(5,5)}static isValidCoord(t){return!1===rc.isInRange(t)?R.failure("Invalid coord for QuixoMove: "+t.toString()+" is outside the board."):0!==t.x&&4!==t.x&&0!==t.y&&4!==t.y?R.failure(Fut.NO_INSIDE_CLICK()):R.SUCCESS}toString(){return"QuixoMove("+this.coord.x+", "+this.coord.y+", "+this.direction.toString()+")"}equals(t){return t===this||!!t.coord.equals(this.coord)&&t.direction===this.direction}}rc.encoder=Nt.tuple([S.encoder,$e.encoder],n=>[n.coord,n.direction],n=>new rc(n[0].x,n[0].y,n[1]));class _8 extends Br{static getInitialState(){const t=Xe.createTable(5,5,he.NONE);return new _8(t,0)}applyLegalMove(t){const e=this.getCopiedBoard(),r=this.turn+1;let s=t.coord,i=t.coord.getNext(t.direction);for(;rc.isInRange(i);)e[s.y][s.x]=e[i.y][i.x],s=s.getNext(t.direction),i=i.getNext(t.direction);return e[s.y][s.x]=this.getCurrentPlayer(),new _8(e,r)}}class sc extends L1{static getVerticalCoords(t){const e=t.gameState.getCurrentOpponent(),r=[];for(let s=0;s<5;s++)t.gameState.getPieceAtXY(0,s)!==e&&r.push(new S(0,s)),t.gameState.getPieceAtXY(4,s)!==e&&r.push(new S(4,s));return r}static getHorizontalCenterCoords(t){const e=t.gameState.getCurrentOpponent(),r=[];for(let s=1;s<4;s++)t.gameState.getPieceAtXY(s,0)!==e&&r.push(new S(s,0)),t.gameState.getPieceAtXY(s,4)!==e&&r.push(new S(s,4));return r}static getPossibleDirections(t){const e=[];return 0!==t.x&&e.push($e.LEFT),0!==t.y&&e.push($e.UP),4!==t.x&&e.push($e.RIGHT),4!==t.y&&e.push($e.DOWN),e}static getLinesSums(t){const e={};e[B.ZERO.value]={columns:[0,0,0,0,0],rows:[0,0,0,0,0],diagonals:[0,0]},e[B.ONE.value]={columns:[0,0,0,0,0],rows:[0,0,0,0,0],diagonals:[0,0]};for(let r=0;r<5;r++)for(let s=0;s<5;s++){const i=t.getPieceAtXY(s,r);if(i.isPlayer()){const o=i.value;e[o].columns[s]=e[o].columns[s]+1,e[o].rows[r]=e[o].rows[r]+1,s===r&&(e[o].diagonals[0]=e[o].diagonals[0]+1),s+r===4&&(e[o].diagonals[1]=e[o].diagonals[1]+1)}}return e}static getVictoriousCoords(t){return sc.QUIXO_HELPER.getVictoriousCoord(t)}static getFullestLine(t){const e=t.columns.concat(t.rows.concat(t.diagonals));return Math.max(...e)}applyLegalMove(t,e,r){return e.applyLegalMove(t)}isLegal(t,e){return e.getPieceAt(t.coord)===e.getCurrentOpponent()?R.failure(et.CANNOT_CHOOSE_OPPONENT_PIECE()):R.SUCCESS}getGameStatus(t){const e=t.gameState,s=sc.QUIXO_HELPER.getVictoriousCoord(e).map(o=>e.getPieceAt(o)),i=new zt(s);return 0===i.size()?xe.ONGOING:1===i.size()?xe.getVictory(i.getAnyElement().get()):xe.getVictory(e.getCurrentPlayer())}}sc.QUIXO_HELPER=new Bm(rc.isInRange,Me.identity,5);class But extends xs{getListMoves(t){const e=[],r=sc.getVerticalCoords(t),i=sc.getHorizontalCenterCoords(t).concat(r);for(const o of i){const c=sc.getPossibleDirections(o);for(const u of c){const d=new rc(o.x,o.y,u);e.push(d)}}return e}getMetrics(t){const r=sc.getLinesSums(t.gameState);return[sc.getFullestLine(r[B.ZERO.value]),sc.getFullestLine(r[B.ONE.value])]}}const ur=he.NONE,Yc=he.ZERO,U3=he.ONE;class U3e extends $1{constructor(){super(...arguments),this.tutorial=[ie.informational($localize`Goal of the game.`,$localize`At Quixo, the goal is to align 5 of your pieces.
        The first player plays with dark pieces, the second with light pieces.
        The board is made of 25 spaces spread over a 5x5 square.
        Every piece has a neutral side, a light side, and a dark side.`,_8.getInitialState()),ie.fromMove($localize`What a move looks like (without animation)`,$localize`When it is your turn:
        <ol>
            <li>Click on one of your pieces or on a neutral one. You cannot choose a piece of the opponent.
                You can only choose a piece from the edge of the board.</li>
            <li>Pick a direction in which you want to send the piece (by clicking on the arrow).</li>
        </ol>
        You have to imagine that the piece you picked has been moved to the other side of the board, in the chosen direction.
        Once on the other side, all pieces will move by one space in the opposing direction.
        Afterwards, if the piece was neutral, it will become yours and takes your color.<br/><br/>
        For example, take the bottom right neutral piece, and move it to the left (you're playing Light).`,new _8([[ur,ur,ur,ur,ur],[ur,ur,ur,ur,ur],[ur,ur,ur,ur,ur],[ur,ur,ur,ur,ur],[Yc,Yc,Yc,Yc,ur]],1),[new rc(4,4,$e.LEFT)],$localize`See how the four dark pieces have been moved one space to the right.
        The neutral piece has been move 4 pieces to the left and has become light.`,$localize`Failed. Try again.`),ie.fromMove($localize`Victory`,$localize`You already know everything you need in order to play, but there is one last particularity.
        If you create a line of 5 of your pieces, you win.
        If you create a line of 5 of your opponent's pieces, you lose.
        If you create both, you lose too!<br/><br/>
        You can win with this board, try it.
        You're playing Light.`,new _8([[ur,U3,ur,U3,U3],[ur,Yc,Yc,ur,Yc],[U3,U3,U3,Yc,U3],[Yc,ur,Yc,U3,U3],[U3,Yc,ur,U3,Yc]],31),[new rc(3,0,$e.DOWN)],$localize`Congratulations, you won!`,$localize`Failed. Try again.`)]}}function $ut(n,t){if(1&n){const e=Oe();F(),O(0,"g")(1,"circle",4),ee("click",function(){const i=ue(e).index,o=C().index;return ce(C().onBoardClick(i,o))}),A()()}if(2&n){const e=t.index,r=C().index,s=C();P(1),De("id","click_",e,"_",r,""),w("ngClass",s.getPieceClasses(e,r)),z("r",.45*s.SPACE_SIZE)("cx",(e+.5)*s.SPACE_SIZE)("cy",(r+.5)*s.SPACE_SIZE)}}function Uut(n,t){if(1&n&&(F(),O(0,"g"),x(1,$ut,2,6,"g",2),A()),2&n){const e=t.$implicit;P(1),w("ngForOf",e)}}function Gut(n,t){if(1&n){const e=Oe();F(),O(0,"use",6),ee("click",function(){const i=ue(e).$implicit;return ce(C(2).chooseDirection(i))}),A()}if(2&n){const e=t.$implicit,r=C(2);y1("id","chooseDirection_",e,""),z("transform",r.getArrowTransform(e))}}function Wut(n,t){if(1&n&&(F(),O(0,"g"),x(1,Gut,1,2,"use",5),A()),2&n){const e=C();P(1),w("ngForOf",e.getPossiblesDirections())}}let qut=(()=>{class n extends ko{constructor(e){super(e),this.lastMoveCoord=T.empty(),this.chosenCoord=T.empty(),this.victoriousCoords=[],this.rules=new sc(_8),this.availableMinimaxes=[new But(this.rules,"QuixoMinimax")],this.encoder=rc.encoder,this.tutorial=(new U3e).tutorial,this.updateBoard()}updateBoard(){this.state=this.getState(),this.board=this.state.board,this.lastMoveCoord=this.rules.node.move.map(e=>e.coord),this.victoriousCoords=sc.getVictoriousCoords(this.state)}cancelMoveAttempt(){this.chosenCoord=T.empty()}getPieceClasses(e,r){const s=new S(e,r),o=[];return o.push(this.getPlayerClass(this.board[r][e])),this.chosenCoord.equalsValue(s)?o.push("selected-stroke"):this.lastMoveCoord.equalsValue(s)&&o.push("last-move-stroke"),this.victoriousCoords.some(c=>c.equals(s))&&o.push("victory-stroke"),o}onBoardClick(e,r){const s=this.canUserPlay("#click_"+e+"_"+r);if(s.isFailure())return this.cancelMove(s.getReason());const i=new S(e,r),o=rc.isValidCoord(i);return o.isFailure()?this.cancelMove(o.getReason()):this.board[r][e]===this.state.getCurrentOpponent()?this.cancelMove(et.CANNOT_CHOOSE_OPPONENT_PIECE()):(this.chosenCoord.equalsValue(i)?this.cancelMoveAttempt():this.chosenCoord=T.of(i),R.SUCCESS)}getPossiblesDirections(){const e=[],r=this.chosenCoord.get();return 4!==r.x&&e.push($e.RIGHT),0!==r.x&&e.push($e.LEFT),4!==r.y&&e.push($e.DOWN),0!==r.y&&e.push($e.UP),e}chooseDirection(e){var r=this;return I(function*(){const s=r.canUserPlay("#chooseDirection_"+e.toString());return s.isFailure()?r.cancelMove(s.getReason()):(r.chosenDirection=e,yield r.tryMove())})()}tryMove(){var e=this;return I(function*(){const r=e.chosenCoord.get(),s=new rc(r.x,r.y,e.chosenDirection);return e.cancelMove(),e.chooseMove(s,e.getState())})()}getArrowTransform(e){return class L6t{static getArrowTransform(t,e,r){let s,i,o;switch(r){case $e.UP:s=1,i=0,o=-90;break;case $e.DOWN:s=1,i=2,o=90;break;case $e.LEFT:s=0,i=1,o=180;break;default:Me.expectToBe(r,$e.RIGHT),s=2,i=1,o=0}return["scale("+t/300+")",`translate(${100*s} ${100*i})`,"rotate("+o+" 50 50)"].join(" ")}}.getArrowTransform(5*this.SPACE_SIZE,new S(0,0),e)}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(J(En))},n.\u0275cmp=dt({type:n,selectors:[["app-quixo"]],features:[l],decls:5,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["id","triangle","points","0 0, 100 50, 0 100"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"base",3,"id","ngClass","click"],[0,"xlink","href","#triangle","class","semi-transparent",3,"id","click",4,"ngFor","ngForOf"],[0,"xlink","href","#triangle",1,"semi-transparent",3,"id","click"]],template:function(e,r){1&e&&(F(),O(0,"svg",0)(1,"defs"),X(2,"polygon",1),A(),x(3,Uut,2,1,"g",2),x(4,Wut,2,1,"g",3),A()),2&e&&(z("viewBox","0 0 "+5*r.SPACE_SIZE+" "+5*r.SPACE_SIZE),P(3),w("ngForOf",r.board),P(1),w("ngIf",r.chosenCoord.isPresent()))},dependencies:[fn,On,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})(),qr=(()=>{class n extends Br{static getInitialState(){const e=Xe.createTable(n.BOARD_WIDTH,n.BOARD_HEIGHT,he.NONE);return e[3][3]=B.ZERO,e[4][4]=B.ZERO,e[3][4]=B.ONE,e[4][3]=B.ONE,new n(e,0)}static getNeighboringPawnLike(e,r,s,i){let o;const c=[];for(let u=-1;u<2;u++)for(let d=-1;d<2;d++)o=new S(s+d,i+u),o.isInRange(this.BOARD_WIDTH,this.BOARD_HEIGHT)&&e[o.y][o.x]===r&&c.push(o);return c}countScore(){const e=[0,0];for(let r=0;r<n.BOARD_HEIGHT;r++)for(let s=0;s<n.BOARD_WIDTH;s++){const i=this.board[r][s];i.isPlayer()&&(e[i.value]+=1)}return e}}return n.BOARD_WIDTH=8,n.BOARD_HEIGHT=8,n})();class Bo extends Ks{toString(){return"ReversiMove("+this.coord.x+", "+this.coord.y+")"}}Bo.encoder=Ks.getEncoder(n=>new Bo(n.x,n.y)),Bo.PASS=new Bo(-1,-1);let jut=(()=>{class n{}return n.NO_ELEMENT_SWITCHED=()=>$localize`Your move should switch at least one piece.`,n})();class G3e{constructor(t,e){this.move=t,this.switched=e}}let tT=(()=>{class n extends L1{static getGameStatus(e){const r=e.gameState;if(!1===n.isGameEnded(r))return xe.ONGOING;const i=r.countScore(),o=i[1]-i[0];return o<0?xe.ZERO_WON:o>0?xe.ONE_WON:xe.DRAW}applyLegalMove(e,r,s){const i=r.turn,o=r.getCurrentPlayer(),c=r.getCopiedBoard();if(e.equals(Bo.PASS))return new qr(c,i+1);for(const d of s)c[d.y][d.x]=o;return c[e.coord.y][e.coord.x]=o,new qr(c,i+1)}static getAllSwitcheds(e,r,s){const i=[],o=r.getOpponent();for(const c of Ne.DIRECTIONS){const u=e.coord.getNext(c);if(u.isInRange(qr.BOARD_WIDTH,qr.BOARD_HEIGHT)&&s[u.y][u.x]===o){const d=n.getSandwicheds(r,c,u,s);for(const g of d)i.push(g)}}return i}static getSandwicheds(e,r,s,i){const o=[s];let c=s.getNext(r);for(;c.isInRange(qr.BOARD_WIDTH,qr.BOARD_HEIGHT);){const u=i[c.y][c.x];if(u===e)return o;if(u===he.NONE)return[];o.push(c),c=c.getNext(r)}return[]}static isGameEnded(e){return this.playerCanOnlyPass(e)&&this.nextPlayerCantOnlyPass(e)}getGameStatus(e){return n.getGameStatus(e)}static playerCanOnlyPass(e){const r=this.getListMoves(e);return 1===r.length&&r[0].move.equals(Bo.PASS)}static nextPlayerCantOnlyPass(e){const r=e.getCopiedBoard(),i=new qr(r,e.turn+1);return this.playerCanOnlyPass(i)}static getListMoves(e){const r=[];let s;const i=e.getCurrentPlayer(),o=e.getCurrentOpponent();for(let c=0;c<8;c++)for(let u=0;u<8;u++)if(e.getPieceAtXY(u,c)===he.NONE&&(s=e.getCopiedBoard(),qr.getNeighboringPawnLike(s,o,u,c).length>0)){const g=new Bo(u,c),m=n.getAllSwitcheds(g,i,s);if(m.length>0){for(const y of m)Pe(i!==e.getPieceAt(y),y+"was already switched!"),s[y.y][y.x]=i;s[c][u]=i,r.push(new G3e(g,m.length))}}return 0===r.length&&r.push(new G3e(Bo.PASS,0)),r}isLegal(e,r){if(e.equals(Bo.PASS))return n.playerCanOnlyPass(r)?_e.success([]):_e.failure(et.MUST_PASS());if(r.getPieceAt(e.coord).isPlayer())return Q(n.VERBOSE,"ReversiRules.isLegal: you cannot play on a busy space"),_e.failure(et.MUST_CLICK_ON_EMPTY_SPACE());const s=r.getCopiedBoard(),i=n.getAllSwitcheds(e,r.getCurrentPlayer(),s);return Q(n.VERBOSE,"ReversiRules.isLegal: "+i.length+" element(s) switched"),0===i.length?_e.failure(jut.NO_ELEMENT_SWITCHED()):_e.success(i)}}return n.VERBOSE=!1,n})();class nT extends xs{getMetrics(t){const r=t.gameState.getCopiedBoard();let s=0,i=0;for(let o=0;o<qr.BOARD_HEIGHT;o++)for(let c=0;c<qr.BOARD_WIDTH;c++){const g=(0===c||c===qr.BOARD_WIDTH-1?4:1)*(0===o||o===qr.BOARD_HEIGHT-1?4:1);r[o][c]===B.ZERO&&(s+=g),r[o][c]===B.ONE&&(i+=g)}return[s,i]}getListMoves(t){const e=tT.getListMoves(t.gameState);return Xe.sortByDescending(e,r=>nT.bestCoords.some(s=>r.move.coord.equals(s))?100:r.switched),e.map(r=>r.move)}}nT.bestCoords=[new S(0,0),new S(0,qr.BOARD_HEIGHT-1),new S(qr.BOARD_WIDTH-1,0),new S(qr.BOARD_WIDTH-1,qr.BOARD_HEIGHT-1)];const Ht=he.NONE,$t=he.ZERO,ft=he.ONE;class W3e extends $1{constructor(){super(...arguments),this.tutorial=[ie.informational($localize`Goal of the game`,$localize`At Reversi, the pieces are double sided: one dark side for the first player, one light side for the second player.
        When one piece is flipped, its owner changes.
        The player owning the most pieces at the end of the game wins.
        Here, Dark has 28 points and Light has 36, hence Light wins.`,new qr([[$t,$t,$t,$t,$t,$t,$t,$t],[$t,ft,ft,ft,ft,ft,ft,$t],[$t,ft,ft,ft,ft,ft,ft,$t],[$t,ft,ft,ft,ft,ft,ft,$t],[$t,ft,ft,ft,ft,ft,ft,$t],[$t,ft,ft,ft,ft,ft,ft,$t],[$t,ft,ft,ft,ft,ft,ft,$t],[$t,$t,$t,$t,$t,$t,$t,$t]],60)),ie.anyMove($localize`Capture (1/2)`,$localize`At the beginning of the game, pieces are placed as shown here.
        For a move to be legal, it must sandwich at least one piece of the opponent between the piece you're putting and another of your pieces.<br/><br/>
        Do any move by clicking to put your piece
        Dark plays first.`,qr.getInitialState(),new Bo(2,4),$localize`Congratulations!`),ie.fromMove($localize`Capture (2/2)`,$localize`A move can also capture a bigger line, and more than one line at a time<br/><br/>
        You're playing light here. Play on the bottom left to see a capture.`,new qr([[Ht,Ht,Ht,Ht,Ht,Ht,Ht,Ht],[Ht,Ht,Ht,Ht,Ht,Ht,Ht,Ht],[Ht,Ht,Ht,Ht,Ht,Ht,Ht,Ht],[Ht,Ht,Ht,Ht,ft,Ht,Ht,Ht],[Ht,Ht,Ht,$t,Ht,Ht,Ht,Ht],[Ht,Ht,$t,Ht,Ht,Ht,Ht,Ht],[$t,$t,Ht,Ht,Ht,Ht,Ht,Ht],[Ht,$t,ft,$t,ft,$t,Ht,Ht]],1),[new Bo(0,7)],$localize`Congratulations!`,$localize`Lower and more to the left, please.`),ie.informational($localize`Passing a turn`,$localize`If, during its turn, a player has no move that would allow that player to flip a piece, that player must pass
        Moreover, if the next player could not play neither, the game ends before the board is full, and points are counted in the usual way.`,new qr([[ft,$t,$t,$t,$t,$t,ft,$t],[$t,ft,ft,ft,ft,ft,ft,$t],[$t,ft,ft,ft,ft,ft,ft,$t],[$t,ft,ft,ft,ft,ft,ft,$t],[$t,ft,ft,ft,ft,ft,ft,$t],[$t,ft,ft,ft,ft,ft,ft,$t],[ft,ft,ft,ft,ft,ft,Ht,Ht],[$t,$t,$t,$t,$t,$t,Ht,Ht]],60))]}}function Zut(n,t){if(1&n&&(F(),X(0,"circle",4)),2&n){const e=C().index,r=C().index,s=C();w("ngClass",s.getPieceClass(e,r)),z("r",s.SPACE_SIZE/2-s.STROKE_WIDTH)("cx",s.SPACE_SIZE*e+s.SPACE_SIZE/2)("cy",s.SPACE_SIZE*r+s.SPACE_SIZE/2)}}function Yut(n,t){if(1&n){const e=Oe();F(),O(0,"g")(1,"rect",2),ee("click",function(){const i=ue(e).index,o=C().index;return ce(C().onClick(i,o))}),A(),x(2,Zut,1,4,"circle",3),A()}if(2&n){const e=t.index,r=C().index,s=C();P(1),De("id","click_",e,"_",r,""),w("ngClass",s.getRectClasses(e,r)),z("x",s.SPACE_SIZE*e)("y",s.SPACE_SIZE*r)("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),P(1),w("ngIf",s.board[r][e]!==s.EMPTY)}}function Kut(n,t){if(1&n&&(F(),O(0,"g"),x(1,Yut,3,8,"g",1),A()),2&n){const e=t.$implicit;P(1),w("ngForOf",e)}}let Xut=(()=>{class n extends ko{constructor(e){super(e),this.EMPTY=he.NONE,this.lastMove=new S(-2,-2),this.capturedCoords=[],this.scores=T.of([2,2]),this.rules=new tT(qr),this.availableMinimaxes=[new nT(this.rules,"ReversiMinimax")],this.encoder=Bo.encoder,this.tutorial=(new W3e).tutorial,this.canPass=!1,this.updateBoard()}onClick(e,r){var s=this;return I(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());const o=new Bo(e,r);return yield s.chooseMove(o,s.getState(),s.scores.get())})()}updateBoard(){const e=this.getState();this.board=e.getCopiedBoard(),this.capturedCoords=[],this.lastMove=new S(-2,-2),this.scores=T.of(e.countScore()),this.canPass=tT.playerCanOnlyPass(e)}showLastMove(e){this.lastMove=e.coord;const r=this.getState().getCurrentPlayer(),s=this.getState().getCurrentOpponent();for(const i of Ne.DIRECTIONS){let o=this.lastMove.getNext(i,1);for(;o.isInRange(qr.BOARD_WIDTH,qr.BOARD_HEIGHT)&&this.getState().getPieceAt(o)===s&&this.getPreviousState().getPieceAt(o)===r;)this.capturedCoords.push(o),o=o.getNext(i,1)}}getRectClasses(e,r){const s=new S(e,r);return this.capturedCoords.some(i=>i.equals(s))?["captured-fill"]:s.equals(this.lastMove)?["moved-fill"]:[]}getPieceClass(e,r){return this.getPlayerClass(this.board[r][e])}pass(){var e=this;return I(function*(){return Pe(e.canPass,"ReversiComponent: pass() can only be called if canPass is true"),e.onClick(Bo.PASS.coord.x,Bo.PASS.coord.y)})()}}return n.\u0275fac=function(e){return new(e||n)(J(En))},n.\u0275cmp=dt({type:n,selectors:[["app-reversi"]],features:[l],decls:2,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass",4,"ngIf"],[1,"base",3,"ngClass"]],template:function(e,r){1&e&&(F(),O(0,"svg",0),x(1,Kut,2,1,"g",1),A()),2&e&&(z("viewBox","0 -4 "+8*r.SPACE_SIZE+" "+(10+8*r.SPACE_SIZE)),P(1),w("ngForOf",r.board))},dependencies:[fn,On,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})(),$o=(()=>{class n extends O5{static getInitialState(){const e=ke.UNREACHABLE,r=ke.ZERO,s=ke.ONE,i=ke.EMPTY;return new n([[e,e,r,s,i,i,i,r,s,e,e],[e,i,i,i,i,i,i,i,i,i,e],[s,i,i,i,i,i,i,i,i,i,r],[r,i,i,i,i,i,i,i,i,i,s],[e,i,i,i,i,i,i,i,i,i,e],[e,e,s,r,i,i,i,s,r,e,e]],0)}}return n.HEIGHT=6,n.WIDTH=11,n})(),zd=(()=>{class n{}return n.CAN_ONLY_REBOUND_ON_BLACK=()=>$localize`You can only rebound on dark spaces.`,n.CAN_ONLY_REBOUND_ON_EMPTY_SPACE=()=>$localize`You can only rebound on empty spaces.`,n.MUST_CHOOSE_PYRAMID_FIRST=()=>$localize`You must pick one of your pyramids first.`,n.MUST_CHOOSE_OWN_PYRAMID=()=>$localize`You must pick one of your pyramids.`,n.THOSE_TWO_SPACES_ARE_NOT_NEIGHBORS=()=>$localize`Those two spaces are not neighbors.`,n.THOSE_TWO_SPACES_HAVE_NO_COMMON_NEIGHBOR=()=>$localize`Those two spaces have no intermediary neighbor.`,n})();class G3 extends c8{constructor(t,e){super(t,e)}static checkDistanceAndLocation(t,e){const r=t.getOrthogonalDistance(e);if(0===r)return R.failure(et.MOVE_CANNOT_BE_STATIC());if(1===r){const s=Hc.getFakeNeighbors(t);if(e.equals(s))return R.failure(zd.THOSE_TWO_SPACES_ARE_NOT_NEIGHBORS())}else{if(2!==r)return R.failure($localize`You can move one or two spaces, not ${r}.`);if(Hc.isSpaceDark(t))return R.failure(zd.CAN_ONLY_REBOUND_ON_BLACK());if(t.x===e.x)return R.failure(zd.THOSE_TWO_SPACES_HAVE_NO_COMMON_NEIGHBOR())}return R.SUCCESS}static from(t,e){if(!t.isInRange($o.WIDTH,$o.HEIGHT))throw new Error("Move must start inside the board not at "+t.toString()+".");if(!e.isInRange($o.WIDTH,$o.HEIGHT))throw new Error("Move must end inside the board not at "+e.toString()+".");const r=G3.checkDistanceAndLocation(t,e);return r.isFailure()?r.toOtherFallible():_e.success(new G3(t,e))}isSimpleStep(){return Math.abs(this.getStart().x-this.getEnd().x)+Math.abs(this.getStart().y-this.getEnd().y)===1}equals(t){return t===this||!!t.getStart().equals(this.getStart())&&t.getEnd().equals(this.getEnd())}toString(){return"SaharaMove("+this.getStart()+"->"+this.getEnd()+")"}}G3.encoder=no.getFallibleEncoder(G3.from);let i_=(()=>{class n extends L1{static getStartingCoords(e,r){const s=[];for(let i=0;i<$o.HEIGHT;i++)for(let o=0;o<$o.WIDTH;o++)e[i][o].is(r)&&s.push(new S(o,i));return s}static getBoardValuesFor(e,r){const s=n.getStartingCoords(e,r),i=[];for(const o of s){const c=O5.getEmptyNeighbors(e,o,ke.EMPTY).length;if(0===c)return[0];i.push(c)}return i.sort((o,c)=>o-c)}applyLegalMove(e,r,s){Q(n.VERBOSE,"Legal move "+e.toString()+" applied");const i=r.getCopiedBoard();return i[e.getEnd().y][e.getEnd().x]=i[e.getStart().y][e.getStart().x],i[e.getStart().y][e.getStart().x]=ke.EMPTY,new $o(i,r.turn+1)}isLegal(e,r){if(r.getPieceAt(e.getStart()).value!==r.getCurrentPlayer().value)return R.failure(et.CANNOT_CHOOSE_OPPONENT_PIECE());if(r.getPieceAt(e.getEnd())!==ke.EMPTY)return R.failure(et.MUST_LAND_ON_EMPTY_SPACE());const o=Hc.getCommonNeighbor(e.getStart(),e.getEnd());return o.isPresent()?r.getPieceAt(o.get())===ke.EMPTY?R.SUCCESS:R.failure(zd.CAN_ONLY_REBOUND_ON_EMPTY_SPACE()):R.SUCCESS}getGameStatus(e){const r=e.gameState.getCopiedBoard(),s=n.getBoardValuesFor(r,B.ZERO),i=n.getBoardValuesFor(r,B.ONE);return n.getGameStatusFromFreedoms(s,i)}getLandingCoords(e,r){const s=o=>o.isInRange($o.WIDTH,$o.HEIGHT)&&e[o.y][o.x]===ke.EMPTY,i=new zt(Hc.getNeighbors(r).filter(s));if(!0===Hc.isSpaceDark(r))return i.toList();{const o=new zt(i.toList());for(const c of i){const u=Hc.getNeighbors(c).filter(s);for(const d of u)o.add(d)}return o.toList()}}static getGameStatusFromFreedoms(e,r){return 0===e[0]?xe.ONE_WON:0===r[0]?xe.ZERO_WON:xe.ONGOING}}return n.VERBOSE=!1,n})();class Qut extends xs{getListMoves(t){const e=[],r=t.gameState.getCopiedBoard(),s=t.gameState.getCurrentPlayer(),i=i_.getStartingCoords(r,s);for(const o of i){const c=O5.getEmptyNeighbors(r,o,ke.EMPTY);for(const u of c){const d=G3.from(o,u).get();if(r[u.y][u.x]=r[o.y][o.x],r[o.y][o.x]=ke.EMPTY,e.push(d),(u.y+u.x)%2==0){const m=O5.getEmptyNeighbors(r,u,ke.EMPTY);for(const y of m)if(!y.equals(o)){const b=G3.from(o,y).get();r[y.y][y.x]=r[u.y][u.x],r[u.y][u.x]=ke.EMPTY,e.push(b),r[u.y][u.x]=r[y.y][y.x],r[y.y][y.x]=ke.EMPTY}}r[o.y][o.x]=r[u.y][u.x],r[u.y][u.x]=ke.EMPTY}}return e}getMetrics(t){const e=t.gameState.board,r=i_.getBoardValuesFor(e,B.ZERO),s=i_.getBoardValuesFor(e,B.ONE);let i=0;for(;i<6&&r[i]===s[i];)i++;return[r[i%6],s[i%6]]}}const Kc=ke.UNREACHABLE,Vd=ke.ZERO,Hd=ke.ONE,xn=ke.EMPTY;class q3e extends $1{constructor(){super(...arguments),this.tutorial=[ie.informational($localize`Initial board`,$localize`Shr is played on a board where each space is a triangle.
        Each player has six pyramids.`,$o.getInitialState()),ie.informational($localize`Goal of the game`,$localize`At Shr, the goal of the game is to immobilize one of the opponent's pyramids.
        To do so, you have to occupy all neighboring space of that pyramid.
        Here, Light has lost because its leftmost pyramid is immobilized.`,new $o([[Kc,Kc,xn,xn,Hd,xn,xn,Vd,Hd,Kc,Kc],[Kc,xn,xn,xn,xn,xn,xn,xn,xn,xn,Kc],[Hd,Vd,xn,xn,xn,xn,xn,xn,xn,xn,Vd],[Vd,xn,xn,xn,xn,xn,xn,xn,xn,xn,Hd],[Kc,xn,xn,xn,xn,xn,xn,xn,xn,xn,Kc],[Kc,Kc,Hd,Vd,xn,xn,xn,Hd,Vd,Kc,Kc]],3)),ie.fromPredicate($localize`Simple step`,$localize`To immobilize your opponent, you have to move your pyramids.
        When a pyramid shares its vertices with light spaces, it can move on these spaces (we call this a simple step).
        To perform a move:
        <ol>
            <li>Click on one of your pyramids.</li>
            <li>Click on one of its two or three neighboring spaces in order to move your pyramid there.</li>
        </ol><br/>
        You're playing Dark, do any simple step.`,$o.getInitialState(),G3.from(new S(2,0),new S(2,1)).get(),(t,e,r)=>t.isSimpleStep()?R.SUCCESS:R.failure($localize`You have made a double step, which is good but it is the next exercise!`),$localize`Congratulations!`),ie.fromPredicate($localize`Double step`,$localize`When a pyramid shares its vertices with dark spaces, it can move one or two steps.
        To do so:
        <ol>
            <li>Click on the pyramid to move.</li>
            <li>Click on one of the 6 destinations that you can reach in two steps:
                 the 6 neighboring light spaces of the 3 dark spaces that are neighbors of your pyramid.
        </ol><br/>
        You're playing Dark, do a double step.`,$o.getInitialState(),G3.from(new S(7,0),new S(5,0)).get(),(t,e,r)=>t.isSimpleStep()?R.failure($localize`Failed! You have made a single step.`):R.SUCCESS,$localize`Congratulations!`)]}}function Jut(n,t){if(1&n&&(F(),O(0,"g"),X(1,"polygon",7),A()),2&n){const e=C().index,r=C().index,s=C();P(1),w("ngClass",s.getPlayerClassFor(e,r)),z("points",s.getPyramidCoordinate(e,r))}}function e5t(n,t){if(1&n&&(F(),X(0,"polygon",10)),2&n){const e=C(2).index,r=C().index;z("points",C().getTriangleCoordinate(e,r))}}function t5t(n,t){if(1&n&&(F(),X(0,"polygon",11)),2&n){const e=C(2).index,r=C().index;z("points",C().getTriangleCoordinate(e,r))}}function n5t(n,t){if(1&n&&(F(),O(0,"g"),x(1,e5t,1,1,"polygon",8),x(2,t5t,1,1,"polygon",9),A()),2&n){const e=C().index,r=C().index;P(1),w("ngIf",(e+r)%2==1),P(1),w("ngIf",(e+r)%2==0)}}function r5t(n,t){if(1&n){const e=Oe();F(),O(0,"g",5),ee("click",function(){const i=ue(e).index,o=C().index;return ce(C().onClick(i,o))}),x(1,Jut,2,2,"g",6),x(2,n5t,3,2,"g",6),A()}if(2&n){const e=t.$implicit;De("id","click_",t.index,"_",C().index,""),P(1),w("ngIf",e.isPlayer()),P(1),w("ngIf",2===e.value)}}function s5t(n,t){if(1&n&&(F(),O(0,"g"),x(1,r5t,3,4,"g",4),A()),2&n){const e=t.$implicit;P(1),w("ngForOf",e)}}function i5t(n,t){if(1&n&&(F(),X(0,"polygon",14)),2&n){const e=t.$implicit,r=C(2);De("id","possible_landing_",e.x,"_",e.y,""),z("points",r.getTriangleCoordinate(e.x,e.y))}}function o5t(n,t){if(1&n&&(F(),X(0,"polygon",14)),2&n){const e=C(2);De("id","chosen_coord_",e.chosenCoord.get().x,"_",e.chosenCoord.get().y,""),z("points",e.getTriangleCoordinate(e.chosenCoord.get().x,e.chosenCoord.get().y))}}function a5t(n,t){if(1&n&&(F(),pn(0),x(1,i5t,1,3,"polygon",12),x(2,o5t,1,3,"polygon",13),gn()),2&n){const e=C();P(1),w("ngForOf",e.possibleLandings),P(1),w("ngIf",e.chosenCoord.isPresent())}}function c5t(n,t){if(1&n&&(F(),pn(0),X(1,"polygon",15)(2,"polygon",15),gn()),2&n){const e=C(2);P(1),z("points",e.getTriangleCoordinate(e.lastCoord.get().x,e.lastCoord.get().y)),P(1),z("points",e.getTriangleCoordinate(e.lastMoved.get().x,e.lastMoved.get().y))}}function l5t(n,t){1&n&&(F(),x(0,c5t,3,2,"ng-container",6)),2&n&&w("ngIf",C().lastMoved.isPresent())}let u5t=(()=>{class n extends e3e{constructor(e){super(e),this.lastCoord=T.empty(),this.lastMoved=T.empty(),this.chosenCoord=T.empty(),this.possibleLandings=[],this.rules=new i_($o),this.availableMinimaxes=[new Qut(this.rules,"SaharaMinimax")],this.encoder=G3.encoder,this.tutorial=(new q3e).tutorial,this.updateBoard()}cancelMoveAttempt(){this.possibleLandings=[],this.chosenCoord=T.empty()}onClick(e,r){var s=this;return I(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());const o=s.getState().getCurrentPlayer(),c=ke.ofPlayer(o);return s.chosenCoord.equalsValue(new S(e,r))?(s.cancelMoveAttempt(),R.SUCCESS):s.chosenCoord.isAbsent()||s.board[r][e]===c?s.choosePiece(e,r):s.chooseLandingCoord(e,r)})()}choosePiece(e,r){if(this.board[r][e]===ke.EMPTY)return this.cancelMove(zd.MUST_CHOOSE_PYRAMID_FIRST());if(this.board[r][e].is(B.fromTurn(this.getTurn()))){const s=new S(e,r);return this.selectPiece(s),R.SUCCESS}return this.cancelMove(zd.MUST_CHOOSE_OWN_PYRAMID())}selectPiece(e){this.chosenCoord=T.of(e),this.possibleLandings=this.rules.getLandingCoords(this.board,e)}chooseLandingCoord(e,r){var s=this;return I(function*(){const i=new S(e,r),o=G3.from(s.chosenCoord.get(),i);return o.isFailure()?s.cancelMove(o.getReason()):yield s.chooseMove(o.get(),s.getState())})()}updateBoard(){const e=this.rules.node.move;this.lastCoord=e.map(r=>r.getStart()),this.lastMoved=e.map(r=>r.getEnd()),this.board=this.getState().board}getPlayerClassFor(e,r){return this.getPlayerClass(B.of(this.board[r][e].value))}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(J(En))},n.\u0275cmp=dt({type:n,selectors:[["app-sahara"]],features:[l],decls:5,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-4 -4 300 308","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf","ngIfElse"],["lastMove",""],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[4,"ngIf"],[1,"base","small-stroke",3,"ngClass"],["class","base small-stroke",4,"ngIf"],["class","base small-stroke background2",4,"ngIf"],[1,"base","small-stroke"],[1,"base","small-stroke","background2"],["class","base no-fill small-stroke selected-stroke",3,"id",4,"ngFor","ngForOf"],["class","base no-fill small-stroke selected-stroke",3,"id",4,"ngIf"],[1,"base","no-fill","small-stroke","selected-stroke",3,"id"],[1,"base","no-fill","small-stroke","moved-stroke"]],template:function(e,r){if(1&e&&(F(),O(0,"svg",0),x(1,s5t,2,1,"g",1),x(2,a5t,3,2,"ng-container",2),x(3,l5t,1,1,"ng-template",null,3,Zn),A()),2&e){const s=Bn(4);P(1),w("ngForOf",r.board),P(1),w("ngIf",r.chosenCoord.isPresent())("ngIfElse",s)}},dependencies:[fn,On,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class va extends Ks{constructor(t,e,r,s){super(t,e),this.x=t,this.y=e,this.direction=r,this.landingOrientation=s}static of(t,e,r,s){const i=new va(t,e,r,s),o=i.coord.isNotInRange(5,5);if(i.isRotation()){if(o)return _e.failure("Cannot rotate piece outside the board: "+i.toString())}else if(i.coord.getNext(i.direction.get()).isNotInRange(5,5)){if(o)return _e.failure("SiamMove should end or start on the board: "+i.toString());if(i.direction.get()!==i.landingOrientation)return _e.failure("SiamMove should have moveDirection and landingOrientation matching when a piece goes out of the board: "+i.toString())}return _e.success(i)}isRotation(){return this.direction.isAbsent()}equals(t){return this===t||!(!this.coord.equals(t.coord)||!1===this.direction.equals(t.direction))&&this.landingOrientation===t.landingOrientation}toString(){const t=this.direction.isAbsent()?"-":this.direction.get().toString();return"SiamMove("+this.coord.x+", "+this.coord.y+", "+t+", "+this.landingOrientation+")"}isInsertion(){return-1===this.coord.x||5===this.coord.x||-1===this.coord.y||5===this.coord.y}}va.encoder=Nt.tuple([Nt.identity(),Nt.identity(),T.getEncoder($e.encoder),$e.encoder],n=>[n.x,n.y,n.direction,n.landingOrientation],n=>va.of(n[0],n[1],n[2],n[3]).get());class _t{constructor(t){this.value=t}static decode(t){switch(t){case 0:return _t.EMPTY;case 1:return _t.LIGHT_UP;case 2:return _t.LIGHT_RIGHT;case 3:return _t.LIGHT_DOWN;case 4:return _t.LIGHT_LEFT;case 5:return _t.DARK_UP;case 6:return _t.DARK_RIGHT;case 7:return _t.DARK_DOWN;case 8:return _t.DARK_LEFT;case 9:return _t.MOUNTAIN}}belongTo(t){return t===B.ZERO?1<=this.value&&this.value<=4:5<=this.value&&this.value<=8}isEmptyOrMountain(){return 0===this.value||9===this.value}isPiece(){return!this.isEmptyOrMountain()}getOwner(){return 1<=this.value&&this.value<=4?B.ZERO:5<=this.value&&this.value<=8?B.ONE:he.NONE}getOptionalDirection(){switch(this.value){case 0:return T.empty();case 1:case 5:return T.of($e.UP);case 2:case 6:return T.of($e.RIGHT);case 3:case 7:return T.of($e.DOWN);case 4:case 8:return T.of($e.LEFT);default:return Me.expectToBe(this.value,9),T.empty()}}static of(t,e){return e===B.ZERO?t===$e.UP?_t.LIGHT_UP:t===$e.RIGHT?_t.LIGHT_RIGHT:t===$e.DOWN?_t.LIGHT_DOWN:_t.LIGHT_LEFT:t===$e.UP?_t.DARK_UP:t===$e.RIGHT?_t.DARK_RIGHT:t===$e.DOWN?_t.DARK_DOWN:_t.DARK_LEFT}getDirection(){return this.getOptionalDirection().get()}toString(){switch(this.value){case 0:return"EMPTY";case 1:return"LIGHT_UP";case 2:return"LIGHT_RIGHT";case 3:return"LIGHT_DOWN";case 4:return"LIGHT_LEFT";case 5:return"DARK_UP";case 6:return"DARK_RIGHT";case 7:return"DARK_DOWN";case 8:return"DARK_LEFT";default:return Me.expectToBe(this.value,9),"MOUNTAIN"}}}_t.EMPTY=new _t(0),_t.LIGHT_UP=new _t(1),_t.LIGHT_RIGHT=new _t(2),_t.LIGHT_DOWN=new _t(3),_t.LIGHT_LEFT=new _t(4),_t.DARK_UP=new _t(5),_t.DARK_RIGHT=new _t(6),_t.DARK_DOWN=new _t(7),_t.DARK_LEFT=new _t(8),_t.MOUNTAIN=new _t(9);class W3 extends Br{static getInitialState(){const t=Xe.createTable(5,5,_t.EMPTY);return t[2][1]=_t.MOUNTAIN,t[2][2]=_t.MOUNTAIN,t[2][3]=_t.MOUNTAIN,new W3(t,0)}countCurrentPlayerPawn(){return this.countPlayersPawn()[this.getCurrentPlayer().value]}countPlayersPawn(){const t=[0,0];for(let e=0;e<5;e++)for(let r=0;r<5;r++)this.board[e][r]!==_t.EMPTY&&t[this.getPieceAtXY(r,e).getOwner().value]++;return t}}let Fd=(()=>{class n{}return n.NO_REMAINING_PIECE_TO_INSERT=()=>$localize`You cannot insert a piece, all your pieces are already on the board.`,n.NOT_ENOUGH_FORCE_TO_PUSH=()=>$localize`You do not have enough strength to push.`,n.MUST_MOVE_OR_ROTATE=()=>$localize`You must move or rotate your piece.`,n.ILLEGAL_PUSH=()=>$localize`Your push is invalid: it is either not straight, is not pushing anything, or is leaving the board.`,n.MUST_SELECT_VALID_DESTINATION=()=>$localize`You must select a valid destination (highlighted on the board) for your piece`,n.MUST_SELECT_ORIENTATION=()=>$localize`You should select the orientation of your piece by clicking on one of the arrows.`,n})();class j3e{constructor(t,e){this.resultingBoard=t,this.moved=e}}class vr extends L1{constructor(){super(W3)}static get(){return vr.singleton.isAbsent()&&(vr.singleton=T.of(new vr)),vr.singleton.get()}isLegal(t,e){if(Q(vr.VERBOSE,{SiamRules_isLegal:{move:t,state:e}}),!t.isInsertion()&&!e.getPieceAt(t.coord).belongTo(e.getCurrentPlayer()))return _e.failure(et.MUST_CHOOSE_PLAYER_PIECE());if(t.isRotation())return Q(vr.VERBOSE,"Move is rotation"),this.isLegalRotation(t,e);{let r;if(t.isInsertion()){Q(vr.VERBOSE,"Move is insertion");const s=this.isLegalInsertion(t.coord,e);if(s.legal.isFailure())return _e.failure(s.legal.getReason());r=s.insertedPiece}else Q(vr.VERBOSE,"Move is forward"),r=e.getPieceAt(t.coord);return this.isLegalForwarding(t,e,r)}}isLegalInsertion(t,e){const r=e.countCurrentPlayerPawn(),s=e.getCurrentPlayer(),i=r<5?R.SUCCESS:R.failure(Fd.NO_REMAINING_PIECE_TO_INSERT());return{insertedPiece:this.getInsertedPiece(t,s),legal:i}}getInsertedPiece(t,e){return _t.of(-1===t.x?$e.RIGHT:-1===t.y?$e.DOWN:5===t.x?$e.LEFT:$e.UP,e)}isLegalForwarding(t,e,r){Pe(r!==_t.MOUNTAIN&&r!==_t.EMPTY,"forwarding must be done with player piece");const s=[];let i=_t.of(t.landingOrientation,e.getCurrentPlayer());const o=t.direction.get();let c=t.coord.getNext(o);if(c.isInRange(5,5)&&e.getPieceAt(c)!==_t.EMPTY&&!1===this.isStraight(r,t))return _e.failure(Fd.ILLEGAL_PUSH());let u=T.of(o);const d=o.getOpposite();let g=0;const m=e.getCopiedBoard();t.coord.isInRange(5,5)&&(m[t.coord.y][t.coord.x]=_t.EMPTY,s.push(t.coord));let y=c.isInRange(5,5)&&i!==_t.EMPTY;for(;y;){u.equalsValue(o)?g++:u.equalsValue(d)&&g--;const b=m[c.y][c.x];b===_t.MOUNTAIN&&(g-=.9),m[c.y][c.x]=i,s.push(c),i=b,c=c.getNext(o),u=i.getOptionalDirection(),y=c.isInRange(5,5)&&i!==_t.EMPTY&&g>0}return c.isNotInRange(5,5)&&(u.equalsValue(o)?g++:u.equalsValue(d)&&g--),g<=0?_e.failure(Fd.NOT_ENOUGH_FORCE_TO_PUSH()):_e.success(new j3e(m,s))}isStraight(t,e){const r=t.getDirection();return e.direction.equalsValue(r)&&r===e.landingOrientation}isLegalRotation(t,e){Q(vr.VERBOSE,{isLegalRotation:{rotation:t,state:e}});const r=t.coord,s=e.getPieceAt(r),i=e.getCurrentPlayer();if(s.getDirection()===t.landingOrientation)return _e.failure(Fd.MUST_MOVE_OR_ROTATE());const o=e.getCopiedBoard();return o[r.y][r.x]=_t.of(t.landingOrientation,i),_e.success(new j3e(o,[r]))}applyLegalMove(t,e,r){const s=Xe.copyBiArray(r.resultingBoard);return new W3(s,e.turn+1)}getBoardValueInfo(t,e){const r=this.getMountainsRowsAndColumns(e),s=r.rows,i=r.columns,o=this.getWinner(e,t,r.nbMountain);if(o.isPlayer())return o===B.ZERO?{shortestZero:0,shortestOne:Number.POSITIVE_INFINITY,boardValue:Number.MIN_SAFE_INTEGER}:{shortestZero:Number.POSITIVE_INFINITY,shortestOne:0,boardValue:Number.MAX_SAFE_INTEGER};{const c=this.getPushers(e,i,s);let u=Number.MAX_SAFE_INTEGER,d=Number.MAX_SAFE_INTEGER;const g=e.getCurrentPlayer();for(const y of c)y.coord.isInRange(5,5)?e.getPieceAt(y.coord).belongTo(B.ZERO)?u=Math.min(u,y.distance):d=Math.min(d,y.distance):g===B.ZERO?u=Math.min(u,y.distance):d=Math.min(d,y.distance);return{shortestZero:u,shortestOne:d,boardValue:this.getScoreFromShortestDistances(u,d,g)}}}getScoreFromShortestDistances(t,e,r){t===Number.MAX_SAFE_INTEGER&&(t=6),e===Number.MAX_SAFE_INTEGER&&(e=6);const s=6-t,i=6-e;return s===i?r.getScoreModifier():s>i?-10*(s+1)+(i+1):10*(i+1)-(s+1)}getMountainsRowsAndColumns(t){const e=[],r=[];let s=0;for(let i=0;i<5;i++)for(let o=0;o<5;o++)t.getPieceAtXY(o,i)===_t.MOUNTAIN&&(e.includes(i)||e.push(i),r.includes(o)||r.push(o),s++);return{rows:e,columns:r,nbMountain:s}}getWinner(t,e,r){return 2===r?this.getPusher(t,e.get()):he.NONE}getPusher(t,e){const r=e.coord;let s;s=r.isInRange(5,5)?t.getPieceAt(r.getNext(e.landingOrientation)):this.getInsertedPiece(r,t.getCurrentOpponent());const i=s.getDirection(),o=this.getPusherCoord(t,i,r),c=t.getPieceAt(o).getOwner();return Q(vr.VERBOSE,r.toString()+" belong to "+t.getCurrentOpponent().value+", "+o.toString()+" belong to "+c.value+", "+c.value+" win"),c}getPusherCoord(t,e,r){let s=r.getNext(e),i=r;for(;s.isInRange(5,5);){r=s,s=s.getNext(e);const o=t.getPieceAt(r);o!==_t.MOUNTAIN&&o.getDirection()===e&&(i=r)}return i}getPushers(t,e,r){Q(vr.VERBOSE,{getPushers:{state:t,mountainsColumn:e,mountainsRow:r}});let s=[];const i=[];for(const o of e){let c=$e.DOWN,u=new S(o,4);i.push({direction:c,fallingCoord:u}),c=$e.UP,u=new S(o,0),i.push({direction:c,fallingCoord:u})}for(const o of r){let c=$e.LEFT,u=new S(0,o);i.push({direction:c,fallingCoord:u}),c=$e.RIGHT,u=new S(4,o),i.push({direction:c,fallingCoord:u})}for(const o of i)s=this.addPotentialDirectionPusher(t,o.fallingCoord,o.direction,s);return s}addPotentialDirectionPusher(t,e,r,s){const i=this.getLineClosestPusher(t,e,r);if(i.isAbsent())return s;const o=i.get(),c=o.distance;return Q(vr.VERBOSE,"new closest challenger"),s.push({coord:o.coord,distance:c}),s}getLineClosestPusher(t,e,r){Q(vr.VERBOSE,{getDirectionClosestPusher:{state:t,fallingCoord:e,direction:r.toString()}});const s=r.getOpposite();let i=1,o=t.getPieceAt(e),c=e,u=T.empty(),d=!1,g=!1,m=0;for(;c.isInRange(5,5)&&!1===d;){const y=t.getPieceAt(c);if(y.isEmptyOrMountain())y===_t.MOUNTAIN?(m+=.9,g=!0):i++;else{const b=y.getDirection();b===r?g&&(m-=1,m<=0&&(d=!0,c=c.getNext(r))):b===s?(m+=1,g||i++):g?(u=T.of(c),o!==_t.EMPTY&&i++):i++}o=y,c=c.getPrevious(r)}if(!1===d&&u.isPresent())for(i++,m-=1;!1===c.equals(u.get());)c=c.getNext(r),i--;return c.isNotInRange(5,5)&&(m-=1,5===t.countCurrentPlayerPawn())||m>0?T.empty():T.of({distance:i,coord:c})}getInsertions(t){let e=[];for(let r=1;r<4;r++)e=e.concat(this.getInsertionsAt(t,0,r)),e=e.concat(this.getInsertionsAt(t,4,r)),e=e.concat(this.getInsertionsAt(t,r,0)),e=e.concat(this.getInsertionsAt(t,r,4));return e=e.concat(this.getInsertionsAt(t,0,0)),e=e.concat(this.getInsertionsAt(t,0,4)),e=e.concat(this.getInsertionsAt(t,4,0)),e=e.concat(this.getInsertionsAt(t,4,4)),e}getInsertionsAt(t,e,r){const s=[];for(const i of $e.ORTHOGONALS){const o=new S(e,r).getPrevious(i);if(o.isNotInRange(5,5))for(const c of $e.ORTHOGONALS){const u=va.of(o.x,o.y,T.of(i),c);Pe(u.isSuccess(),"SiamRules.getInsertionsAt should only construct valid insertions"),this.isLegal(u.get(),t).isSuccess()&&s.push(u.get())}}return s}getMovesFrom(t,e,r,s){const i=new S(r,s);let o=this.getRotationMovesAt(i,e);for(const c of $e.ORTHOGONALS){const u=i.getNext(c);o=o.concat(this.getForwardMovesBetween(t,i,u))}return o}getMovesBetween(t,e,r,s){return r.equals(s)?this.getRotationMovesAt(r,e):$e.factory.fromMove(r,s).isSuccess()&&1===r.getDistance(s)?this.getForwardMovesBetween(t,r,s):[]}getRotationMovesAt(t,e){const r=[],s=e.getDirection();for(const i of $e.ORTHOGONALS)if(i!==s){const o=va.of(t.x,t.y,T.empty(),i).get();r.push(o)}return r}getForwardMovesBetween(t,e,r){const s=[];let i;const o=$e.factory.fromMove(e,r).get(),c=t.getPieceAt(e);i=r.isInRange(5,5)?$e.ORTHOGONALS:[o];for(const u of i){const d=va.of(e.x,e.y,T.of(o),u).get();this.isLegalForwarding(d,t,c).isSuccess()&&s.push(d)}return s}getGameStatus(t){const e=this.getMountainsRowsAndColumns(t.gameState),r=this.getWinner(t.gameState,t.move,e.nbMountain);return r.isPlayer()?xe.getVictory(r):xe.ONGOING}}vr.singleton=T.empty(),vr.VERBOSE=!1;class f5t extends k3{getBoardValue(t){return new k1(vr.get().getBoardValueInfo(t.move,t.gameState).boardValue)}getListMoves(t){let e=[];const r=t.gameState.getCurrentPlayer();for(let s=0;s<5;s++)for(let i=0;i<5;i++){const o=t.gameState.getPieceAtXY(i,s);o.belongTo(r)&&(e=e.concat(vr.get().getMovesFrom(t.gameState,o,i,s)))}if(t.gameState.countCurrentPlayerPawn()<5)for(const s of vr.get().getInsertions(t.gameState))if(s.direction.get().getOpposite()!==s.landingOrientation){if(this.isOnBorder(s)&&s.direction.get()!==s.landingOrientation)continue;e.push(s)}return Q(vr.VERBOSE,{getListMovesResult:e}),e}isOnBorder(t){return 0===t.coord.x||4===t.coord.x||0===t.coord.y||4===t.coord.y}}const Ze=_t.EMPTY,ic=_t.MOUNTAIN,YH=_t.LIGHT_UP,KH=_t.LIGHT_LEFT,Bd=_t.LIGHT_RIGHT,d5t=_t.LIGHT_DOWN,h5t=_t.DARK_UP,Z3e=_t.DARK_LEFT,Y3e=_t.DARK_RIGHT,p5t=_t.DARK_DOWN;class K3e extends $1{constructor(){super(...arguments),this.tutorial=[ie.informational($localize`Goal of the game`,$localize`The goal at Siam is to be the first to push a mountain out of the board.
        The initial board contains three mountains, and no pieces are initially on the board.
        During its turn, a player can do one of the following actions:
        <ol>
            <li>Put a new piece on the board.</li>
            <li>Change the orientation of one of its piece</li>
            <li>Move one of its piece and optionally reorient it.</li>
            <li>Take one of its pieces out of the board.</li>
        </ol>`,W3.getInitialState()),ie.anyMove($localize`Inserting a piece`,$localize`Each player has 5 pieces in total.
        As long as you have remaining pieces next to the board, you can insert new pieces. To do so:
        <ol>
            <li>Click on one of your pieces from your reserve, next to board.</li>
            <li>Click on one of the highlighted squares to select a landing for your piece.</li>
            <li>Select an orientation for your piece by clicking on one of the arrows that appear on top of the board.</li>
        </ol><br/>
        You're playing Dark, insert a piece on the board.`,W3.getInitialState(),va.of(2,-1,T.of($e.DOWN),$e.DOWN).get(),$localize`Congratulations!`),ie.fromMove($localize`Moving a piece`,$localize`We will distinguish here "moving" and "pushing".
        A move is made from a piece's square to an empty neighboring square, horizontally or vertically.
        You can also move a piece out of the board.
        To move a piece:
        <ol>
            <li>Click on it.</li>
            <li>Click on the square on which you want the piece to move.
                You can also click a second time on your piece to change its orientation without moving it.</li>
            <li>Select the orientation of your piece by clicking one one of the arrows that appear on top of the board.</li>
        </ol><br/>
        You're playing Dark. Try to move your piece that is already on the board one square upwards and to orient it to the left.`,new W3([[Ze,Ze,Ze,Ze,Ze],[Ze,Ze,Ze,Ze,Ze],[Ze,ic,ic,ic,Ze],[Ze,Ze,Ze,Ze,Ze],[Ze,Ze,YH,Ze,Ze]],0),[va.of(2,4,T.of($e.UP),$e.LEFT).get()],$localize`Congratulations, you made a side-slip!`,$localize`Failed. Try again.`),ie.fromMove($localize`Moving a piece out of the board`,$localize`To move a piece out of the board, you do not have to pick an orientation after the move.<br/><br/>
        You're playing Dark, get that piece out of the board!`,new W3([[Ze,Ze,Ze,Ze,Ze],[Ze,Ze,Ze,Ze,Ze],[Ze,ic,ic,ic,Ze],[Ze,Ze,Ze,Ze,Ze],[Ze,Ze,YH,Ze,Ze]],0),[va.of(2,4,T.of($e.DOWN),$e.DOWN).get()],$localize`Congratulations, even if in this context it was not a useful move.`,$localize`Failed, the piece is still on the board.`),ie.fromMove($localize`Pushing (1/2)`,$localize`When the landing square of your move is occupied, we use the term "push".
        In order to push player pieces, the following conditions must hold:
        <ol>
            <li>Your piece must already be oriented in the direction of the push.</li>
            <li>Along the line that you are pushing, the number of pieces (yours or your opponent's) that are oriented in the same way as the push should be strictly greater than the number of pieces oriented in the opposite way.</li>
        </ol>
        Look closely at the board. On the first row, you cannot push as there is exactly one piece in the opposite direction.
        On the second row, you can push because there are two pieces against one.<br/><br/>
        You're playing Dark. Vertically, you can push using your piece in the center, as there is no resistance on that axis. Do it.`,new W3([[Ze,Bd,Z3e,Ze,Ze],[Bd,Y3e,KH,Ze,Ze],[Ze,Ze,YH,Ze,Ze],[Ze,Ze,Ze,Ze,Ze],[Ze,Ze,Ze,Ze,Ze]],0),[va.of(2,2,T.of($e.UP),$e.UP).get()],$localize`Congratulations!`,$localize`Failed. Try again.`),ie.fromMove($localize`Pushing (2/2)`,$localize`To be able to push a mountain, you need at least one pusher per mountain. Each resistant (pieces in the opposite way) cancel the force of one pusher.
        In short, if there is no mountain, you need strictly more pushers than resistants. If there is a mountain, you need at least as much pushers than there are resistants and mountains.
        On the following board, as Dark, you can push the mountain on the first row.
        On the second and third row, because of the resisting forces, you cannot push.
        On the fourth row, you can push as there is one more pusher than resistant pieces.<br/><br/>
        You're playing Dark, push on the fourth row it.`,new W3([[Ze,Ze,Bd,ic,Ze],[Ze,Ze,Bd,ic,KH],[Ze,Bd,ic,ic,Ze],[Ze,Bd,Y3e,Z3e,ic],[Ze,Ze,Ze,Ze,Ze]],0),[va.of(1,3,T.of($e.RIGHT),$e.RIGHT).get()],$localize`Congratulations! Note that this move made you lose the game, you will see why in the next step.`,$localize`Failed. Try again.`),ie.fromMove($localize`Victory`,$localize`The game ends when a mountain is pushed out of the board.
        If you pushed it and nobody is in front of you, you're the winner.
        However, if you were pushing an opponent oriented in the same direction as you, your opponent will win because that piece is closer to the mountain.
        However, if that opponent is closer to the mountain but not oriented towards it, victory will be yours.<br/><br/>
        Here, playing Dark, you can push a mountain off the board and either win, or lose. Choose correctly!`,new W3([[Ze,Ze,Ze,Ze,Ze],[Ze,Ze,Ze,Ze,Ze],[ic,h5t,KH,Ze,d5t],[Ze,Ze,Ze,Ze,p5t],[Ze,Ze,Ze,Ze,ic]],0),[va.of(2,2,T.of($e.LEFT),$e.LEFT).get()],$localize`Congratulations, you won!`,$localize`Failed, you lost.`)]}}function g5t(n,t){if(1&n){const e=Oe();F(),O(0,"use",11),ee("click",function(){ue(e);const s=C().index,i=C().index;return ce(C().clickSquare(s,i))}),A()}if(2&n){const e=C(),r=e.index,s=e.$implicit,i=C().index,o=C();De("id","piece_",r,"_",i,""),w("ngClass",o.getPieceClasses(r,i,s)),z("transform",o.getPieceTransform(r,i))}}function m5t(n,t){if(1&n){const e=Oe();F(),O(0,"use",12),ee("click",function(){ue(e);const s=C().index,i=C().index;return ce(C().clickSquare(s,i))}),A()}if(2&n){const e=C().index,r=C().index,s=C();z("transform","translate("+(e+1)*s.SPACE_SIZE+" "+(r+1)*s.SPACE_SIZE+")")}}function _5t(n,t){if(1&n){const e=Oe();F(),O(0,"g")(1,"rect",8),ee("click",function(){const i=ue(e).index,o=C().index;return ce(C().clickSquare(i,o))}),A(),x(2,g5t,1,4,"use",9),x(3,m5t,1,1,"use",10),A()}if(2&n){const e=t.$implicit,r=t.index,s=C().index,i=C();P(1),De("id","square_",r,"_",s,""),w("ngClass",i.getSquareClasses(r,s)),z("x",i.SPACE_SIZE*(r+1))("y",i.SPACE_SIZE*(s+1))("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),P(1),w("ngIf",e.isPiece()),P(1),w("ngIf",i.isMountain(e))}}function v5t(n,t){if(1&n&&(F(),O(0,"g"),x(1,_5t,4,9,"g",4),A()),2&n){const e=t.$implicit;P(1),w("ngForOf",e)}}function C5t(n,t){if(1&n){const e=Oe();F(),O(0,"rect",15),ee("click",function(){ue(e);const s=C().$implicit;return ce(C().clickSquare(s.x,s.y))}),A()}if(2&n){const e=C().$implicit,r=C();De("id","square_",e.x,"_",e.y,""),w("ngClass",r.getSquareClasses(e.x,e.y)),z("x",r.SPACE_SIZE*(e.x+1))("y",r.SPACE_SIZE*(e.y+1))("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)}}function y5t(n,t){if(1&n){const e=Oe();F(),O(0,"g"),x(1,C5t,1,7,"rect",13),O(2,"rect",14),ee("click",function(){const i=ue(e).$implicit;return ce(C().clickSquare(i.x,i.y))}),A()()}if(2&n){const e=t.$implicit,r=C();P(1),w("ngIf",!1===e.isInRange(5,5)),P(1),z("x",r.SPACE_SIZE*(e.x+1))("y",r.SPACE_SIZE*(e.y+1))("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)}}function E5t(n,t){if(1&n){const e=Oe();F(),O(0,"rect",16),ee("click",function(){ue(e);const s=C();return ce(s.clickSquare(s.selectedLanding.get().x,s.selectedLanding.get().y))}),A()}if(2&n){const e=C();z("x",e.SPACE_SIZE*(e.selectedLanding.get().x+1))("y",e.SPACE_SIZE*(e.selectedLanding.get().y+1))("width",e.SPACE_SIZE)("height",e.SPACE_SIZE)}}function M5t(n,t){if(1&n){const e=Oe();F(),O(0,"rect",16),ee("click",function(){ue(e);const s=C();return ce(s.clickSquare(s.selectedPiece.get().x,s.selectedPiece.get().y))}),A()}if(2&n){const e=C();z("x",e.SPACE_SIZE*(e.selectedPiece.get().x+1))("y",e.SPACE_SIZE*(e.selectedPiece.get().y+1))("width",e.SPACE_SIZE)("height",e.SPACE_SIZE)}}function S5t(n,t){if(1&n&&(F(),X(0,"use",19)),2&n){const e=t.$implicit,r=C().$implicit,s=C();De("id","remainingPieces_",r.value,"_",e,""),w("ngClass",s.getRemainingPieceClasses(r,e)),z("transform",s.getRemainingPieceTransform(e,r))}}function P5t(n,t){if(1&n){const e=Oe();F(),O(0,"g",17),ee("click",function(){const i=ue(e).$implicit;return ce(C().selectPieceForInsertion(i))}),x(1,S5t,1,4,"use",18),A()}if(2&n){const e=t.$implicit,r=C();y1("id","remainingPieces_",e.value,""),P(1),w("ngForOf",r.ArrayUtils.range(r.playerPieces(e)))}}function T5t(n,t){if(1&n){const e=Oe();F(),O(0,"use",22),ee("click",function(){ue(e);const s=C().$implicit;return ce(C().clickSquare(s.source.get().coord.x,s.source.get().coord.y))}),A()}if(2&n){const e=C().$implicit,r=C();w("ngClass",r.getPieceClasses(e.source.get().coord.x,e.source.get().coord.y,e.source.get().piece)),z("transform",r.getPieceTransform(e.source.get().coord.x,e.source.get().coord.y))}}function w5t(n,t){if(1&n){const e=Oe();F(),O(0,"g")(1,"use",20),ee("click",function(){const i=ue(e).$implicit;return ce(C().clickArrow(i))}),A(),x(2,T5t,1,2,"use",21),A()}if(2&n){const e=t.$implicit,r=C();P(1),j2("id","indicator_",e.target.x,"_",e.target.y,"_",e.direction.toString(),""),z("transform",r.getIndicatorTransform(e)),P(1),w("ngIf",e.source.isPresent())}}function b5t(n,t){if(1&n){const e=Oe();F(),O(0,"use",23),ee("click",function(){const i=ue(e).$implicit;return ce(C().selectOrientation(i))}),A()}if(2&n){const e=t.$implicit,r=C();y1("id","orientation_",e.landingOrientation,""),w("ngClass",r.getCurrentPlayerClass()),z("transform",r.getOrientationTransform(e.landingOrientation))}}let O5t=(()=>{class n extends ko{constructor(e){super(e),this.lastMove=T.empty(),this.movedPieces=[],this.selectedPiece=T.empty(),this.selectedLanding=T.empty(),this.orientations=[],this.clickableCoords=new zt,this.indicatorArrows=[],this.insertingPiece=!1,this.rules=vr.get(),this.availableMinimaxes=[new f5t(this.rules,"SiamMinimax")],this.encoder=va.encoder,this.tutorial=(new K3e).tutorial,this.updateBoard()}updateBoard(){Q(n.VERBOSE,"updateBoard");const e=this.getState();this.board=e.board,this.movedPieces=[]}showLastMove(e){this.lastMove=T.of(e);const r=this.getPreviousState();this.movedPieces=this.rules.isLegal(this.lastMove.get(),r).get().moved}cancelMoveAttempt(){this.insertingPiece=!1,this.selectedPiece=T.empty(),this.selectedLanding=T.empty(),this.orientations=[],this.clickableCoords=new zt,this.indicatorArrows=[]}selectPieceForInsertion(e){var r=this;return I(function*(){const s=r.canUserPlay("#remainingPieces_"+e.value);if(s.isFailure())return r.cancelMove(s.getReason());if(e!==r.getCurrentPlayer())return r.cancelMove(et.MUST_CHOOSE_PLAYER_PIECE());if(r.insertingPiece)return r.cancelMoveAttempt(),R.SUCCESS;r.cancelMoveAttempt();for(const i of vr.get().getInsertions(r.getState())){const o=i.coord.getNext(i.direction.get());if(r.board[o.y][o.x]!==_t.EMPTY){const c={source:T.empty(),target:o,direction:i.direction.get(),move:i};r.indicatorArrows.push(c)}r.clickableCoords.add(o)}return r.insertingPiece=!0,R.SUCCESS})()}selectOrientation(e){var r=this;return I(function*(){const s=r.canUserPlay("#orientation_"+e.landingOrientation.toString());return s.isFailure()?r.cancelMove(s.getReason()):r.chooseMove(e,r.getState())})()}clickSquare(e,r,s=!1){var i=this;return I(function*(){if(Q(n.VERBOSE,"SiamComponent.clickSquare("+e+", "+r+")"),!1===s){const c=i.canUserPlay("#square_"+e+"_"+r);if(c.isFailure())return i.cancelMove(c.getReason())}const o=new S(e,r);if(i.insertingPiece)return i.insertPiece(o);if(i.selectedLanding.isPresent())return i.cancelMoveAttempt(),R.SUCCESS;if(i.selectedPiece.isPresent()){i.selectedLanding=T.of(o);const c=vr.get().getMovesBetween(i.getState(),i.getState().getPieceAt(i.selectedPiece.get()),i.selectedPiece.get(),o);return 0===c.length?i.changeMoveDestinationClick(o):i.performMoveOrShowOrientationArrows(c)}{Pe(i.getState().isOnBoard(o),"SiamComponent: user clicked outside of board when it should not be possible");const c=i.board[r][e];return c.getOwner()!==i.getCurrentPlayer()?i.cancelMove(et.MUST_CHOOSE_PLAYER_PIECE()):i.selectPiece(o,c)}})()}insertPiece(e){var r=this;return I(function*(){if(r.selectedLanding.isPresent())return r.cancelMove(Fd.MUST_SELECT_ORIENTATION()),R.SUCCESS;r.selectedLanding=T.of(e);const s=vr.get().getInsertionsAt(r.getState(),e.x,e.y);return 0===s.length?r.changeMoveDestinationClick(e):r.performMoveOrShowOrientationArrows(s)})()}changeMoveDestinationClick(e){var r=this;return I(function*(){return r.cancelMoveAttempt(),r.getState().getPieceAt(e).getOwner()===r.getCurrentPlayer()?r.clickSquare(e.x,e.y,!0):r.cancelMove(Fd.MUST_SELECT_VALID_DESTINATION())})()}performMoveOrShowOrientationArrows(e){var r=this;return I(function*(){return Pe(e.length>0,"SiamComponent.performMoveOrShowOrientationArrows expects at least one move"),1===e.length?(r.cancelMove(),r.chooseMove(e[0],r.getState())):(r.clickableCoords=new zt,r.indicatorArrows=[],r.orientations=e,R.SUCCESS)})()}selectPiece(e,r){this.cancelMoveAttempt();const s=this.getState();this.selectedPiece=T.of(e);const i=vr.get().getMovesFrom(s,r,e.x,e.y);for(const o of i)if(o.direction.isPresent()){const c=o.coord.getNext(o.direction.get());if(this.clickableCoords.add(c),s.isOnBoard(c)&&s.getPieceAt(c)!==_t.EMPTY){const u={source:T.of({coord:e,piece:r}),target:c,direction:o.direction.get(),move:o};this.indicatorArrows.push(u)}}else this.clickableCoords.add(o.coord);return R.SUCCESS}clickArrow(e){var r=this;return I(function*(){const s=r.canUserPlay("#indicator_"+e.target.x+"_"+e.target.y+"_"+e.move.landingOrientation);return s.isFailure()?r.cancelMove(s.getReason()):r.chooseMove(e.move,r.getState())})()}isMountain(e){return e===_t.MOUNTAIN}getArrowTransform(e,r,s){const o=`rotate(${90*(s.toInt()-2)} ${this.SPACE_SIZE/2} ${this.SPACE_SIZE/2})`;return["translate("+e*this.SPACE_SIZE+", "+r*this.SPACE_SIZE+")",o].join(" ")}getPieceTransform(e,r){return this.getArrowTransform(e+1,r+1,this.board[r][e].getDirection())}getIndicatorTransform(e){const r=e.target.getPrevious(e.direction,.5);return this.getArrowTransform(r.x+1,r.y+1,e.direction)}getRemainingPieceTransform(e,r){const s=this.playerPieces(r);let u,d,c=2;return r===B.ONE?(c+=(s-e+(5-s)/2)/3,u=-1,d=$e.RIGHT):(c+=(e+1+(5-s)/2)/3,u=7,d=$e.LEFT),this.getArrowTransform(c,u,d)}getOrientationTransform(e){const r=`translate(0, ${this.SPACE_SIZE/1.6})`,i=`rotate(${90*(e.toInt()-2)} ${this.SPACE_SIZE/2} ${this.SPACE_SIZE/2})`;return[`translate(${2.27*this.SPACE_SIZE}, ${2.27*this.SPACE_SIZE})`,"scale(2.43)",i,r].join(" ")}getPieceClasses(e,r,s){const i=new S(e,r),o=[this.getPlayerClass(s.getOwner())];return this.selectedPiece.equalsValue(i)&&o.push("selected-stroke"),o}getSquareClasses(e,r){const s=new S(e,r);return this.movedPieces.some(i=>i.equals(s))?["moved-fill"]:[]}getRemainingPieceClasses(e,r){const s=[this.getPlayerClass(e)];return this.insertingPiece&&this.getCurrentPlayer()===e&&r===this.playerPieces(e)-1&&s.push("selected-stroke"),s}getCurrentPlayerClass(){return this.getPlayerClass(this.getCurrentPlayer())}playerPieces(e){return 5-this.getState().countPlayersPawn()[e.value]}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(J(En))},n.\u0275cmp=dt({type:n,selectors:[["app-siam"]],features:[l],decls:12,vars:7,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","0 -100 700 900","preserveAspectRatio","xMidYMid meet"],["id","triangle","points","0 -6, 10 0, 0 6"],["id","arrow","points","30 7, 30 50, 10 50, 50 90, 90 50, 70 50, 70 7"],["id","mountain","points","5 95, 16 68, 24 76, 48 28, 64 60, 72 44, 95 95, 5 95"],[4,"ngFor","ngForOf"],["class","base no-fill small-stroke selected-stroke",3,"click",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],["class","base mid-stroke semi-transparent",0,"xlink","href","#arrow",3,"id","ngClass","click",4,"ngFor","ngForOf"],[1,"base",3,"id","ngClass","click"],["class","base mid-stroke",0,"xlink","href","#arrow",3,"id","ngClass","click",4,"ngIf"],[0,"xlink","href","#mountain","class","nonplayer-fill",3,"click",4,"ngIf"],[0,"xlink","href","#arrow",1,"base","mid-stroke",3,"id","ngClass","click"],[0,"xlink","href","#mountain",1,"nonplayer-fill",3,"click"],["class","base semi-transparent",3,"id","ngClass","click",4,"ngIf"],[1,"base","no-fill","small-stroke","clickable-stroke",3,"click"],[1,"base","semi-transparent",3,"id","ngClass","click"],[1,"base","no-fill","small-stroke","selected-stroke",3,"click"],[3,"id","click"],["class","base mid-stroke",0,"xlink","href","#arrow",3,"id","ngClass",4,"ngFor","ngForOf"],[0,"xlink","href","#arrow",1,"base","mid-stroke",3,"id","ngClass"],[0,"xlink","href","#arrow",1,"base","mid-stroke","indicator-fill",3,"id","click"],["class","base mid-stroke",0,"xlink","href","#arrow",3,"ngClass","click",4,"ngIf"],[0,"xlink","href","#arrow",1,"base","mid-stroke",3,"ngClass","click"],[0,"xlink","href","#arrow",1,"base","mid-stroke","semi-transparent",3,"id","ngClass","click"]],template:function(e,r){1&e&&(F(),O(0,"svg",0)(1,"defs"),X(2,"polygon",1)(3,"polygon",2)(4,"polygon",3),A(),x(5,v5t,2,1,"g",4),x(6,y5t,3,5,"g",4),x(7,E5t,1,4,"rect",5),x(8,M5t,1,4,"rect",5),x(9,P5t,2,2,"g",6),x(10,w5t,3,5,"g",4),x(11,b5t,1,3,"use",7),A()),2&e&&(P(5),w("ngForOf",r.board),P(1),w("ngForOf",r.clickableCoords),P(1),w("ngIf",r.selectedLanding.isPresent()),P(1),w("ngIf",r.selectedPiece.isPresent()),P(1),w("ngForOf",r.Player.PLAYERS),P(1),w("ngForOf",r.indicatorArrows),P(1),w("ngForOf",r.orientations))},dependencies:[fn,On,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})(),q3=(()=>{class n{}return n.NO_MOVEMENT_BEFORE_TURN_40=()=>$localize`You cannot move yet. Pick a space where you will put a new piece.`,n.MUST_CUT=()=>$localize`Several groups are of the same size, you must pick the one to keep.`,n.CANNOT_CHOOSE_TO_KEEP=()=>$localize`You cannot choose which part to keep when one is smaller than the other.`,n.CAN_NO_LONGER_DROP=()=>$localize`You cannot put new pieces anymore. Pick a piece to move.`,n.MUST_CAPTURE_BIGGEST_GROUPS=()=>$localize`You must choose one of the biggest groups to keep it.`,n.CANNOT_KEEP_EMPTY_COORD=()=>$localize`You cannot pick an empty space. Pick one of the biggest groups.`,n.MUST_DROP_NEXT_TO_OTHER_PIECE=()=>$localize`You must put this piece next to another piece.`,n})();class ji extends m3e{static getInitialState(){return ji.fromRepresentation([[B.ZERO],[B.ONE]],0)}static fromRepresentation(t,e,r=new Bt(0,0)){const s=new ym;for(let i=0;i<t.length;i++)for(let o=0;o<t[0].length;o++)if(t[i][o]!==he.NONE){const c=new S(o,i).getNext(r);s.set(c,t[i][o])}return new ji(s,e)}movePiece(t){const e=this.pieces.getCopy();return e.delete(t.start.get()),e.set(t.landing,this.getCurrentPlayer()),new ji(e,this.turn)}toRepresentation(){const t=Xe.createTable(this.width,this.height,he.NONE);for(const e of this.pieces.listKeys()){const r=this.getPieceAt(e);t[e.y][e.x]=r}return t}isIllegalLandingZone(t,e){return this.pieces.containsKey(t)?R.failure(et.MUST_LAND_ON_EMPTY_SPACE()):this.isCoordConnected(t,e)?R.SUCCESS:R.failure(q3.MUST_DROP_NEXT_TO_OTHER_PIECE())}isCoordConnected(t,e){for(const r of Re.factory.all){const s=t.getNext(r,1);if(this.pieces.containsKey(s)&&!1===e.equalsValue(s))return!0}return!1}getPieceAt(t){return this.isOnBoard(t)?this.pieces.get(t).get():he.NONE}applyLegalDrop(t){const e=this.pieces.getCopy();return e.put(t,this.getCurrentPlayer()),new ji(e,this.turn+1)}applyLegalDeplacement(t,e){const r=this.movePiece(t);if(e.size()>0){const s=new ym;for(const i of e)s.set(i,r.getPieceAt(i));return new ji(s,this.turn+1)}return new ji(r.pieces,this.turn+1)}countPieces(){const t=this.pieces.reverse(),e=t.get(B.ZERO).getOrElse(new Ar),r=t.get(B.ONE).getOrElse(new Ar);return[e.size(),r.size()]}switchPiece(t){const e=this.pieces.getCopy(),r=this.getPieceAt(t);if(r.isPlayer())return e.replace(t,r.getOpponent()),new ji(e,this.turn);As.logErrorAndFail("SixState","Cannot switch piece if there is no piece!",{coord:t.toString()})}equals(t){return this.turn===t.turn&&this.pieces.equals(t.pieces)}}class jr extends Fi{constructor(t,e,r){if(super(),this.start=t,this.landing=e,this.keep=r,t.equalsValue(e))throw new Error("Deplacement cannot be static!");if(t.isPresent()&&t.equals(r))throw new Error("Cannot keep starting coord, since it will always be empty after move!")}static fromDrop(t){return new jr(T.empty(),t,T.empty())}static fromMovement(t,e){return new jr(T.of(t),e,T.empty())}static fromCut(t,e,r){return new jr(T.of(t),e,T.of(r))}isDrop(){return this.start.isAbsent()}isCut(){return this.keep.isPresent()}toString(){return this.isDrop()?"SixMove("+this.landing.toString()+")":this.isCut()?"SixMove("+this.start.get().toString()+" > "+this.landing+", keep: "+this.keep.get().toString()+")":"SixMove("+this.start.get().toString()+" > "+this.landing+")"}equals(t){return!1!==this.landing.equals(t.landing)&&!1!==this.start.equals(t.start)&&this.keep.equals(t.keep)}}jr.encoder=new class extends Nt{encodeMove(n){return{start:n.start.isPresent()?S.encoder.encode(n.start.get()):null,landing:S.encoder.encode(n.landing),keep:n.keep.isPresent()?S.encoder.encode(n.keep.get()):null}}decodeMove(n){const t=n;if("object"!=typeof n)throw new Error("Invalid encodedMove of type "+typeof n+"!");const e=S.encoder.decode(t.landing);if(null==t.start)return jr.fromDrop(e);const r=S.encoder.decode(t.start);if(null==t.keep)return jr.fromMovement(r,e);{const s=S.encoder.decode(t.keep);return jr.fromCut(r,e,s)}}};class j3 extends L1{constructor(){super(...arguments),this.VERBOSE=!1}applyLegalMove(t,e,r){return e.turn<40?e.applyLegalDrop(t.landing):e.applyLegalDeplacement(t,r)}isLegal(t,e){Q(this.VERBOSE,{called:"SixRules.isLegal",move:t,state:e});const r=e.isIllegalLandingZone(t.landing,t.start);return r.isFailure()?r.toOtherFallible():e.turn<40?this.isLegalDrop(t,e):j3.isLegalPhaseTwoMove(t,e)}static getLegalLandings(t){const e=new Ar;for(const r of t.getPieceCoords())for(const s of Re.factory.all){const i=r.getNext(s,1);t.getPieceAt(i)===he.NONE&&e.add(i)}return e.toList()}isLegalDrop(t,e){return!1===t.isDrop()?_e.failure(q3.NO_MOVEMENT_BEFORE_TURN_40()):_e.success(new zt(e.getPieceCoords()))}static isLegalPhaseTwoMove(t,e){if(t.isDrop())return _e.failure(q3.CAN_NO_LONGER_DROP());const r=e.getPieceAt(t.start.get());if(r===he.NONE)return _e.failure(et.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(r===e.getCurrentOpponent())return _e.failure(et.CANNOT_CHOOSE_OPPONENT_PIECE());const s=e.movePiece(t),i=s.getGroups();if(j3.isSplit(i)){const o=this.getBiggerGroups(i);return 1===o.size()?t.keep.isPresent()?_e.failure(q3.CANNOT_CHOOSE_TO_KEEP()):_e.success(o.getAnyElement().get()):this.moveKeepBiggerGroup(t.keep,o,s)}return _e.success(new Ar)}static isSplit(t){return t.size()>1}static getBiggerGroups(t){let e=0,r=new zt;for(const s of t){const i=s.size();i>e?(e=i,r=new zt([s])):i===e&&r.add(s)}return r}static moveKeepBiggerGroup(t,e,r){if(t.isAbsent())return _e.failure(q3.MUST_CUT());if(r.getPieces().get(t.get()).isAbsent())return _e.failure(q3.CANNOT_KEEP_EMPTY_COORD());const s=t.get();for(const i of e)if(i.contains(s))return _e.success(i);return _e.failure(q3.MUST_CAPTURE_BIGGEST_GROUPS())}getGameStatus(t){const e=t.gameState,r=e.getCurrentOpponent();let s=[];if(t.move.isPresent()&&(s=this.getShapeVictory(t.move.get(),e)),6===s.length)return xe.getVictory(r);if(e.turn>39){const i=e.countPieces(),o=i[0],c=i[1];return o<6&&c<6?o<c?xe.ONE_WON:c<o?xe.ZERO_WON:xe.DRAW:o<6?xe.getDefeat(B.ZERO):c<6?xe.getDefeat(B.ONE):xe.ONGOING}return xe.ONGOING}startSearchingVictorySources(){Q(this.VERBOSE,"SixRules.startSearchingVictorySources()"),this.currentVictorySource={typeSource:"LINE",index:-1}}getShapeVictory(t,e){for(this.startSearchingVictorySources();this.hasNextVictorySource();){this.getNextVictorySource();const r=this.searchVictoryOnly(this.currentVictorySource,t,e);if(6===r.length)return r}return[]}hasNextVictorySource(){return"CIRCLE"!==this.currentVictorySource.typeSource||5!==this.currentVictorySource.index}getNextVictorySource(){if(5===this.currentVictorySource.index){let e;switch(this.currentVictorySource.typeSource){case"LINE":e="TRIANGLE_CORNER";break;case"TRIANGLE_CORNER":e="TRIANGLE_EDGE";break;default:e="CIRCLE"}this.currentVictorySource={typeSource:e,index:0}}else{let e=1;"LINE"===this.currentVictorySource.typeSource&&(e=2),this.currentVictorySource={typeSource:this.currentVictorySource.typeSource,index:this.currentVictorySource.index+e}}return this.currentVictorySource}searchVictoryOnly(t,e,r){const s=e.landing;switch(Q(this.VERBOSE,{called:"SixRules.searchVictoryOnly",victorySource:t,move:e,state:r}),t.typeSource){case"LINE":return this.searchVictoryOnlyForLine(t.index,s,r);case"CIRCLE":return this.searchVictoryOnlyForCircle(t.index,s,r);case"TRIANGLE_CORNER":return this.searchVictoryOnlyForTriangleCorner(t.index,s,r);default:return this.searchVictoryOnlyForTriangleEdge(t.index,s,r)}}searchVictoryOnlyForCircle(t,e,r){Q(this.VERBOSE,{called:"SixRules.searchVictoryOnlyForCircle",index:t,lastDrop:e,state:r});const s=r.getCurrentOpponent(),o=[e];let c=e.getNext(Re.factory.all[t],1);for(;o.length<6;){if(r.getPieceAt(c)!==s)return[];const d=(t+o.length)%6;o.push(c),c=c.getNext(Re.factory.all[d],1)}return o}searchVictoryOnlyForLine(t,e,r){const s=r.getCurrentOpponent();let i=Re.factory.all[t],o=e.getNext(i,1);const c=[e];let u=!1;for(;c.length<6;){if(r.getPieceAt(o)===s)c.push(o);else{if(u)return[];u=!0,i=i.getOpposite(),o=o.getNext(i,c.length)}o=o.getNext(i,1)}return c}searchVictoryOnlyForTriangleCorner(t,e,r){Q(this.VERBOSE,{called:"SixRules.searchVictoryTriangleCornerOnly",index:t,lastDrop:e,state:r});const s=r.getCurrentOpponent();let i=Re.factory.all[t];const o=[e];let c=e.getNext(i,1);for(;o.length<6;){if(r.getPieceAt(c)!==s)return[];o.length%2==0&&(i=Re.factory.all[(t+o.length)%6]),o.push(c),c=c.getNext(i,1)}return o}searchVictoryOnlyForTriangleEdge(t,e,r){Q(this.VERBOSE,{called:"SixRules.searchVictoryTriangleEdgeOnly",index:t,lastDrop:e,state:r});const s=r.getCurrentOpponent();let i=Re.factory.all[t];const o=[e];let c=e.getNext(i,1);for(;o.length<6;){if(r.getPieceAt(c)!==s)return[];o.push(c),o.length%2==0&&(i=Re.factory.all[(t+o.length)%6]),c=c.getNext(i,1)}return o}}class A5t extends k3{calculateBoardValue(t,e){this.startSearchingVictorySources();let r={status:Mn.DEFAULT,victory:T.empty(),preVictory:T.empty(),sum:0};for(;this.hasNextVictorySource();){const s=this.getNextVictorySource();let i;if(i=r.status===Mn.PRE_VICTORY?this.searchVictoryOnly(s,t,e):this.getBoardInfo(s,t,e,r),i.status===Mn.VICTORY)return i;r={status:i.status,victory:T.empty(),preVictory:i.preVictory,sum:r.sum+i.sum}}return r}}class S6 extends k1{constructor(t,e){super(t),this.preVictory=e}}class v8 extends A5t{constructor(){super(...arguments),this.VERBOSE=!1}static get(){if(v8.singleton.isAbsent()){const t=new j3(ji);v8.singleton=T.of(new v8(t,"SixMinimax"))}return v8.singleton.get()}getListMoves(t){const e=v8.get(),r=t.getOwnValue(e);if(r.preVictory.isPresent())return t.gameState.turn<40?this.createForcedDrop(r):this.createForcedDeplacement(t,r);const s=j3.getLegalLandings(t.gameState);return t.gameState.turn<40?this.getListDrop(s):this.getListDeplacement(t.gameState,s)}createForcedDrop(t){Q(this.VERBOSE,{called:"SixMinimax.createForceDrop",unheritance:t});const e=[],r=jr.fromDrop(t.preVictory.get());return e.push(r),e}createForcedDeplacement(t,e){Q(this.VERBOSE,{called:"SixRules.createForcedDeplacement",node:t});const r=this.getSafelyMovablePieceOrFirstOne(t),s=[e.preVictory.get()];return this.getDeplacementFrom(t.gameState,r,s)}getDeplacementFrom(t,e,r){const s=[];for(const i of e)for(const o of r){const c=jr.fromMovement(i,o);if(t.isCoordConnected(o,T.of(i))){const d=t.movePiece(c).getGroups();if(j3.isSplit(d))for(const g of d){const m=g.getAnyElement().get(),y=jr.fromCut(i,o,m);s.push(y)}else s.push(c)}}return s}getSafelyMovablePieceOrFirstOne(t){const e=t.gameState,r=e.getPieces().reverse(),s=e.getCurrentPlayer(),i=r.get(s).get(),o=i.getAnyElement().get(),c=[];for(const u of i)!1===this.isPieceBlockingAVictory(e,u)&&c.push(u);return new Ar(0===c.length?[o]:c)}isPieceBlockingAVictory(t,e){const r=t.switchPiece(e),s=jr.fromDrop(e);for(this.startSearchingVictorySources();this.hasNextVictorySource();)if(this.currentVictorySource=this.getNextVictorySource(),this.searchVictoryOnly(this.currentVictorySource,s,r).status===Mn.VICTORY)return!0;return!1}getListDrop(t){const e=[];for(const r of t){const s=jr.fromDrop(r);e.push(s)}return e}getListDeplacement(t,e){const r=t.getCurrentPlayer(),s=t.getPieces().reverse().get(r).get();return this.getDeplacementFrom(t,s,e)}getBoardValue(t){const e=t.move,r=t.gameState,s=r.getCurrentOpponent(),i=s.getVictoryValue();let o={status:Mn.DEFAULT,victory:T.empty(),preVictory:T.empty(),sum:0};e.isPresent()&&(o=this.calculateBoardValue(e.get(),r));let c=T.empty();if(o.status===Mn.DEFAULT&&o.preVictory.isPresent()&&(c=T.of(o.preVictory.get())),o.status===Mn.VICTORY)return new S6(i,T.empty());if(r.turn>39){const u=r.countPieces(),d=u[0],g=u[1];return d<6&&g<6?new S6(d<g?B.ONE.getVictoryValue():g<d?B.ZERO.getVictoryValue():0,T.empty()):d<6?new S6(B.ZERO.getDefeatValue(),T.empty()):g<6?new S6(B.ONE.getDefeatValue(),T.empty()):new S6(d-g,c)}return new S6(o.status===Mn.PRE_VICTORY?s.getPreVictory():o.sum*s.getScoreModifier(),c)}startSearchingVictorySources(){Q(this.VERBOSE,"SixRules.startSearchingVictorySources()"),this.currentVictorySource={typeSource:"LINE",index:-1}}hasNextVictorySource(){return"CIRCLE"!==this.currentVictorySource.typeSource||5!==this.currentVictorySource.index}getNextVictorySource(){if(5===this.currentVictorySource.index){let e;switch(this.currentVictorySource.typeSource){case"LINE":e="TRIANGLE_CORNER";break;case"TRIANGLE_CORNER":e="TRIANGLE_EDGE";break;default:e="CIRCLE"}this.currentVictorySource={typeSource:e,index:0}}else{let e=1;"LINE"===this.currentVictorySource.typeSource&&(e=2),this.currentVictorySource={typeSource:this.currentVictorySource.typeSource,index:this.currentVictorySource.index+e}}return this.currentVictorySource}searchVictoryOnly(t,e,r){const s=e.landing;switch(Q(this.VERBOSE,{called:"SixRules.searchVictoryOnly",victorySource:t,move:e,state:r}),t.typeSource){case"LINE":return this.searchVictoryOnlyForLine(t.index,s,r);case"CIRCLE":return this.searchVictoryOnlyForCircle(t.index,s,r);case"TRIANGLE_CORNER":return this.searchVictoryOnlyForTriangleCorner(t.index,s,r);default:return this.searchVictoryOnlyForTriangleEdge(t.index,s,r)}}searchVictoryOnlyForCircle(t,e,r){Q(this.VERBOSE,{called:"SixRules.searchVictoryOnlyForCircle",index:t,lastDrop:e,state:r});const s=r.getCurrentOpponent(),o=[e];let c=e.getNext(Re.factory.all[t],1);for(;o.length<6;){if(r.getPieceAt(c)!==s)return{status:Mn.PRE_VICTORY,victory:T.empty(),preVictory:T.empty(),sum:0};const d=(t+o.length)%6;o.push(c),c=c.getNext(Re.factory.all[d],1)}return{status:Mn.VICTORY,victory:T.of(o),preVictory:T.empty(),sum:0}}searchVictoryOnlyForLine(t,e,r){const s=r.getCurrentOpponent();let i=Re.factory.all[t],o=e.getNext(i,1);const c=[e];let u=!1;for(;c.length<6;){if(r.getPieceAt(o)===s)c.push(o);else{if(u)return{status:Mn.PRE_VICTORY,victory:T.empty(),preVictory:T.empty(),sum:0};u=!0,i=i.getOpposite(),o=o.getNext(i,c.length-1)}o=o.getNext(i,1)}return{status:Mn.VICTORY,victory:T.of(c),preVictory:T.empty(),sum:0}}searchVictoryOnlyForTriangleCorner(t,e,r){Q(this.VERBOSE,{called:"SixRules.searchVictoryTriangleCornerOnly",index:t,lastDrop:e,state:r});const s=r.getCurrentOpponent();let i=Re.factory.all[t];const o=[e];let c=e.getNext(i,1);for(;o.length<6;){if(r.getPieceAt(c)!==s)return{status:Mn.PRE_VICTORY,victory:T.empty(),preVictory:T.empty(),sum:0};o.length%2==0&&(i=Re.factory.all[(t+o.length)%6]),o.push(c),c=c.getNext(i,1)}return{status:Mn.VICTORY,victory:T.of(o),preVictory:T.empty(),sum:0}}searchVictoryOnlyForTriangleEdge(t,e,r){Q(this.VERBOSE,{called:"SixRules.searchVictoryTriangleEdgeOnly",index:t,lastDrop:e,state:r});const s=r.getCurrentOpponent();let i=Re.factory.all[t];const o=[e];let c=e.getNext(i,1);for(;o.length<6;){if(r.getPieceAt(c)!==s)return{status:Mn.PRE_VICTORY,victory:T.empty(),preVictory:T.empty(),sum:0};o.push(c),o.length%2==0&&(i=Re.factory.all[(t+o.length)%6]),c=c.getNext(i,1)}return{status:Mn.VICTORY,victory:T.of(o),preVictory:T.empty(),sum:0}}getBoardInfo(t,e,r,s){Q(this.VERBOSE,{called:"SixRules.getBoardInfo",victorySource:t,move:e,state:r,boardInfo:s});const i=e.landing;switch(t.typeSource){case"CIRCLE":return this.getBoardInfoForCircle(t.index,i,r,s);case"LINE":return this.getBoardInfoForLine(t.index,i,r,s);case"TRIANGLE_CORNER":return this.getBoardInfoForTriangleCorner(t.index,i,r,s);default:return this.getBoardInfoForTriangleEdge(t.index,i,r,s)}}getBoardInfoForCircle(t,e,r,s){Q(this.VERBOSE,{called:"SixMinimaw.getBoardInfoForCircle",index:t,lastDrop:e,state:r,boardInfo:s});const i=r.getCurrentPlayer(),c=[e];let u=e.getNext(Re.factory.all[t],1),d=0,g=T.empty();for(;c.length<6;){const m=r.getPieceAt(u);if(m===i)return s;const y=(t+c.length)%6;c.push(u);const b=Re.factory.all[y];m===he.NONE?(d+=.16,g=T.of(u)):d++,u=u.getNext(b,1)}return this.getBoardInfoResult(d,g,c,s)}getBoardInfoResult(t,e,r,s){let i=s.preVictory;if(4.16===t){if(Q(this.VERBOSE,"5+1 found!"),i.isPresent()&&!1===i.equals(e))return{status:Mn.PRE_VICTORY,victory:T.empty(),preVictory:T.empty(),sum:0};i=e}else if(5===t)return{status:Mn.VICTORY,victory:T.of(r),preVictory:T.empty(),sum:0};return{status:s.status,victory:T.empty(),preVictory:i,sum:s.sum+t}}getBoardInfoForLine(t,e,r,s){Q(this.VERBOSE,{called:"SixRules.getBoardInfoForLine",index:t,lastDrop:e,state:r,boardInfo:s});const i=Re.factory.all[t];let o=e.getPrevious(i,5),c=[],u=[],d=T.empty();for(let $=0;$<6;$++){const K=this.updateEncounterAndReturnLastEmpty(r,o,u);K.isPresent()&&(d=K),c.push(o),o=o.getNext(i,1)}let g=s.status,m=s.preVictory,y=0,b=0;for(;y<6;){const $=u.reduce((oe,ye)=>oe+ye);if(6===$)return{status:Mn.VICTORY,victory:T.of(c),preVictory:T.empty(),sum:0};5.16===$&&g===Mn.DEFAULT&&(m.isPresent()?(Pe(!1===m.equals(d),"Impossible to have point aligned with differents line to a same point"),g=Mn.PRE_VICTORY):m=d),b=Math.max(b,$),c=c.slice(1,6),c.push(o),u=u.slice(1,6);const K=this.updateEncounterAndReturnLastEmpty(r,o,u);K.isPresent()&&(d=K),y++,o=o.getNext(i,1)}const k={status:g,victory:T.of(c),preVictory:m,sum:b};return this.getBoardInfoResult(b,d,c,k)}updateEncounterAndReturnLastEmpty(t,e,r){const s=t.getCurrentPlayer();switch(t.getPieceAt(e)){case s:return r.push(-7),T.empty();case he.NONE:return r.push(.16),T.of(e);default:return r.push(1),T.empty()}}getBoardInfoForTriangleCorner(t,e,r,s){Q(this.VERBOSE,{called:"SixRules.getBoardInfoForTriangleCorner",index:t,lastDrop:e,state:r,boardInfo:s});const i=r.getCurrentPlayer();let o=Re.factory.all[t];const c=[e];let u=e.getNext(o,1),d=0,g=T.empty();for(;c.length<6;){const m=r.getPieceAt(u);if(m===i)return s;m===he.NONE?(d+=.16,g=T.of(u)):d++,c.length%2==0&&(o=Re.factory.all[(t+c.length)%6]),c.push(u),u=u.getNext(o,1)}return this.getBoardInfoResult(d,g,c,s)}getBoardInfoForTriangleEdge(t,e,r,s){Q(this.VERBOSE,{called:"SixRules.getBoardInfoForTriangleEdge",index:t,lastDrop:e,state:r,boardInfo:s});const i=r.getCurrentPlayer();let o=Re.factory.all[t];const c=[e];let u=e.getNext(o,1),d=0,g=T.empty();for(;c.length<6;){const m=r.getPieceAt(u);if(m===i)return s;m===he.NONE?(d+=.16,g=T.of(u)):d++,c.push(u),c.length%2==0&&(o=Re.factory.all[(t+c.length)%6]),u=u.getNext(o,1)}return this.getBoardInfoResult(d,g,c,s)}}v8.singleton=T.empty();const Te=he.NONE,Ut=B.ZERO,Qt=B.ONE;let XH=(()=>{class n{}return n.MOVEMENT_NOT_DISCONNECTING=()=>$localize`This move does not disconnect your opponent's pieces. Try again with another piece.`,n.MOVEMENT_SELF_DISCONNECTING=()=>$localize`You lost one of your pieces during this move. There is a way to disconnect an opponent's piece without losing any of yours, try again!`,n})();class X3e extends $1{constructor(){super(...arguments),this.tutorial=[ie.informational($localize`Six`,$localize`Six is a game without board, where pieces are placed on the side of each other, in a contiguous block.
        Each player has 21 pieces, with one for each player already on the board.
        The goal of the game is to form one of the three winning shapes with your pieces.`,ji.getInitialState()),ie.fromMove($localize`Victory (line)`,$localize`On this board, by putting your piece at the right place, you can align six of your pieces and win the game<br/><br/>
        Find the victory. You're playing Dark.`,ji.fromRepresentation([[Ut,Qt,Qt,Qt,Qt,Ut],[Te,Ut,Qt,Te,Ut,Te],[Qt,Qt,Ut,Te,Te,Te],[Te,Te,Ut,Te,Te,Te],[Te,Ut,Te,Te,Te,Te],[Ut,Te,Te,Te,Te,Te]],0),[jr.fromDrop(new S(3,2))],$localize`Congratulations!`,$localize`Failed. Try again.`),ie.fromMove($localize`Victory (circle)`,$localize`On this board, by putting your piece at the right place, you can form a circle with six of your pieces and win the game.<br/><br/>
        Find the victory. You're playing Dark.`,ji.fromRepresentation([[Te,Te,Te,Qt,Te,Te],[Te,Te,Qt,Qt,Ut,Ut],[Te,Qt,Te,Ut,Qt,Te],[Qt,Ut,Ut,Ut,Ut,Qt]],0),[jr.fromDrop(new S(5,2))],$localize`Congratulations! Note that if a piece is inside the circle, it does not change anything.`,$localize`Failed. Try again.`),ie.fromMove($localize`Victory (triangle)`,$localize`On this board, by putting your piece at the right place, you can form a triangle with six of your pieces and win the game.<br/><br/>
        Find the victory. You're playing Dark.`,ji.fromRepresentation([[Te,Te,Te,Qt,Te,Te],[Te,Ut,Qt,Ut,Ut,Ut],[Te,Ut,Te,Ut,Ut,Te],[Qt,Qt,Qt,Te,Qt,Te]],0),[jr.fromDrop(new S(3,3))],$localize`Congratulations!`,$localize`Failed. Try again.`),ie.fromPredicate($localize`Second phase`,$localize`After 40 turns, your pieces have all been placed and we move on to the second phase of the game.
        You now have to move your pieces, paying attention not to remove a piece that was preventing the opponent's victory.
        From now on, if after move, on or more pieces are disconnected from the largest group of pieces, these will be taken out of the game.<br/><br/>
        You're playing Dark. Make a move that disconnects one of your opponent's pieces.`,ji.fromRepresentation([[Te,Te,Te,Te,Te,Te,Te,Qt,Te],[Te,Te,Te,Te,Te,Te,Ut,Te,Te],[Te,Te,Te,Te,Ut,Ut,Ut,Te,Te],[Te,Te,Te,Te,Qt,Qt,Te,Qt,Ut],[Te,Ut,Qt,Qt,Ut,Ut,Qt,Te,Te],[Ut,Ut,Ut,Ut,Qt,Qt,Qt,Ut,Te],[Qt,Qt,Ut,Te,Qt,Qt,Ut,Te,Te],[Te,Ut,Te,Ut,Ut,Te,Te,Te,Te],[Qt,Qt,Qt,Qt,Te,Te,Te,Te,Te],[Te,Ut,Te,Qt,Te,Te,Te,Te,Te]],40),jr.fromMovement(new S(6,1),new S(5,1)),(t,e,r)=>{const s=r.countPieces();return 19===s[0]?18===s[1]?R.SUCCESS:R.failure(XH.MOVEMENT_NOT_DISCONNECTING()):R.failure(XH.MOVEMENT_SELF_DISCONNECTING())},$localize`Congratulations, your opponent now has one piece less and you're closer to victory!`),ie.fromPredicate($localize`Victory by disconnection`,$localize`During the second phase of the game, on top of normal victories (line, circle, triangle), you can win by disconnection.
        If at any time, at least one player does not have enough pieces to win (less than 6), the game ends.
        The one with the most pieces wins. In case they both have the same number of pieces, it's a draw.<br/><br/>
        Here, you're playing Dark and you can win. Do it!`,ji.fromRepresentation([[Te,Te,Te,Te,Te,Qt],[Te,Te,Te,Te,Ut,Qt],[Te,Te,Te,Qt,Ut,Ut],[Te,Te,Ut,Te,Qt,Ut],[Qt,Qt,Te,Te,Te,Ut],[Ut,Qt,Te,Te,Te,Te],[Ut,Te,Te,Te,Te,Te]],40),jr.fromMovement(new S(2,3),new S(3,3)),(t,e,r)=>t.start.equalsValue(new S(2,3))?R.SUCCESS:R.failure(XH.MOVEMENT_NOT_DISCONNECTING()),$localize`Congratulations, you won!`),ie.fromPredicate($localize`Special disconnection`,$localize`During a disconnection, two or more groups could have the same size,
        in which case you will have to click on the group you wish to keep.<br/><br/>
        You're playing Dark, play such a move!`,ji.fromRepresentation([[Te,Te,Te,Te,Te,Qt],[Te,Te,Te,Te,Ut,Qt],[Te,Te,Te,Qt,Ut,Ut],[Ut,Te,Ut,Te,Te,Qt],[Qt,Qt,Te,Te,Te,Te],[Ut,Ut,Te,Te,Te,Te],[Ut,Te,Te,Te,Te,Te]],40),jr.fromCut(new S(2,3),new S(2,5),new S(2,5)),(t,e,r)=>t.keep.isAbsent()?R.failure($localize`This move has not cut the board in two equal halves.`):r.getPieceAt(t.landing)===he.NONE?R.failure($localize`Failed. You did cut the board in two but you kept the half where you're in minority. Therefore, you lost! Try again.`):R.SUCCESS,$localize`Congratulations, you won!`)]}}function N5t(n,t){if(1&n){const e=Oe();F(),O(0,"polygon",10),ee("click",function(){const i=ue(e).$implicit;return ce(C().onPieceClick(i))}),A()}if(2&n){const e=t.$implicit,r=C();De("id","piece_",e.x,"_",e.y,""),w("ngClass",r.getPieceClass(e)),z("points",r.getHexaPointsAt(e))}}function I5t(n,t){if(1&n){const e=Oe();F(),O(0,"polygon",11),ee("click",function(){const i=ue(e).$implicit;return ce(C().onNeighborClick(i))}),A()}if(2&n){const e=t.$implicit,r=C();De("id","neighbor_",e.x,"_",e.y,""),z("points",r.getHexaPointsAt(e))}}function x5t(n,t){if(1&n){const e=Oe();F(),O(0,"polygon",10),ee("click",function(){ue(e);const s=C();return ce(s.onPieceClick(s.chosenLanding.get()))}),A()}if(2&n){const e=C();De("id","chosenLanding_",e.chosenLanding.get().x,"_",e.chosenLanding.get().y,""),w("ngClass",e.getPlayerClass(e.state.getCurrentPlayer())),z("points",e.getHexaPointsAt(e.chosenLanding.get()))}}function k5t(n,t){if(1&n&&(F(),X(0,"polygon",12)),2&n){const e=t.$implicit,r=C();De("id","disconnected_",e.x,"_",e.y,""),z("points",r.getHexaPointsAt(e))}}function L5t(n,t){if(1&n){const e=Oe();F(),O(0,"polygon",13),ee("click",function(){ue(e);const s=C();return ce(s.onNeighborClick(s.leftCoord.get()))}),A()}if(2&n){const e=C();De("id","leftCoord_",e.leftCoord.get().x,"_",e.leftCoord.get().y,""),z("points",e.getHexaPointsAt(e.leftCoord.get()))}}function R5t(n,t){if(1&n){const e=Oe();F(),O(0,"polygon",14),ee("click",function(){ue(e);const s=C();return ce(s.onPieceClick(s.lastDrop.get()))}),A()}if(2&n){const e=C();De("id","lastDrop_",e.lastDrop.get().x,"_",e.lastDrop.get().y,""),z("points",e.getHexaPointsAt(e.lastDrop.get()))}}function D5t(n,t){if(1&n){const e=Oe();F(),O(0,"polygon",15),ee("click",function(){ue(e);const s=C();return ce(s.onPieceClick(s.selectedPiece.get()))}),A()}if(2&n){const e=C();De("id","selectedPiece_",e.selectedPiece.get().x,"_",e.selectedPiece.get().y,""),w("ngClass",e.getSelectedPieceClass()),z("points",e.getHexaPointsAt(e.selectedPiece.get()))}}function z5t(n,t){if(1&n&&(F(),X(0,"polygon",16)),2&n){const e=t.$implicit,r=C();De("id","victoryCoord_",e.x,"_",e.y,""),z("points",r.getHexaPointsAt(e))}}function V5t(n,t){if(1&n){const e=Oe();F(),O(0,"polygon",19),ee("click",function(){const i=ue(e).$implicit;return ce(C(2).onPieceClick(i))}),A()}if(2&n){const e=t.$implicit,r=C(2);De("id","cuttable_",e.x,"_",e.y,""),z("points",r.getHexaPointsAt(e))}}function H5t(n,t){if(1&n&&(F(),O(0,"g",17),x(1,V5t,1,3,"polygon",18),A()),2&n){const e=t.$implicit;P(1),w("ngForOf",e)}}let F5t=(()=>{class n extends Td{constructor(e){super(e),this.disconnecteds=[],this.cuttableGroups=[],this.leftCoord=T.empty(),this.lastDrop=T.empty(),this.selectedPiece=T.empty(),this.chosenLanding=T.empty(),this.nextClickShouldSelectGroup=!1,this.rules=new j3(ji),this.availableMinimaxes=[new v8(this.rules,"SixMinimax")],this.encoder=jr.encoder,this.tutorial=(new X3e).tutorial,this.SPACE_SIZE=30,this.hexaLayout=new wd(1.5*this.SPACE_SIZE,new S(2*this.SPACE_SIZE,0),Is.INSTANCE),this.updateBoard()}cancelMoveAttempt(){this.selectedPiece=T.empty(),this.chosenLanding=T.empty(),this.cuttableGroups=[],this.nextClickShouldSelectGroup=!1,this.updateBoard()}updateBoard(){this.state=this.rules.node.gameState,this.rules.node.move.isAbsent()&&this.hideLastMove(),this.pieces=this.state.getPieceCoords(),this.neighbors=this.getEmptyNeighbors(),this.viewBox=this.getViewBox()}hideLastMove(){this.leftCoord=T.empty(),this.lastDrop=T.empty(),this.victoryCoords=[],this.disconnecteds=[]}getViewBox(){const e=this.pieces.concat(this.disconnecteds).concat(this.neighbors);return m6.fromHexa(e,this.hexaLayout,this.STROKE_WIDTH).toSVGString()}showLastMove(e){this.lastDrop=T.of(e.landing),this.leftCoord=!1===e.isDrop()?T.of(e.start.get()):T.empty();const r=this.getState();this.rules.getGameStatus(this.rules.node).isEndGame&&(this.victoryCoords=this.rules.getShapeVictory(e,r)),this.disconnecteds=this.getDisconnected()}getDisconnected(){const e=this.getPreviousState().getPieceCoords(),r=this.getState().getPieceCoords(),s=[];for(const o of e)!1===this.rules.node.move.get().start.equalsValue(o)&&!1===r.some(u=>u.equals(o))&&s.push(o);const i=this.lastDrop.get();return!1===this.pieces.some(o=>o.equals(i))&&!1===r.some(o=>o.equals(i))&&s.push(i),s}getEmptyNeighbors(){let e=j3.getLegalLandings(this.state);if(this.chosenLanding.isPresent()){const r=this.chosenLanding.get();e=e.filter(s=>!1===s.equals(r))}return e}getPieceClass(e){const r=this.getState().getPieceAt(e);return this.getPlayerClass(r)}onPieceClick(e){var r=this;return I(function*(){const s=r.canUserPlay("#piece_"+e.x+"_"+e.y);if(s.isFailure())return r.cancelMove(s.getReason());if(r.state.turn<40)return r.cancelMove(q3.NO_MOVEMENT_BEFORE_TURN_40());if(r.chosenLanding.isAbsent())return r.state.getPieceAt(e)===r.state.getCurrentOpponent()?r.cancelMove(et.CANNOT_CHOOSE_OPPONENT_PIECE()):(r.selectedPiece=r.selectedPiece.equalsValue(e)?T.empty():T.of(e),R.SUCCESS);{const i=jr.fromCut(r.selectedPiece.get(),r.chosenLanding.get(),e);return r.chooseMove(i,r.state)}})()}onNeighborClick(e){var r=this;return I(function*(){const s=r.canUserPlay("#neighbor_"+e.x+"_"+e.y);if(s.isFailure())return r.cancelMove(s.getReason());if(r.nextClickShouldSelectGroup)return r.cancelMove(q3.MUST_CUT());if(r.state.turn<40)return r.chooseMove(jr.fromDrop(e),r.state);if(r.selectedPiece.isAbsent())return r.cancelMove(q3.CAN_NO_LONGER_DROP());{const i=jr.fromMovement(r.selectedPiece.get(),e),o=j3.isLegalPhaseTwoMove(i,r.state);return r.neededCutting(o)?(r.chosenLanding=T.of(e),r.moveVirtuallyPiece(),r.showCuttable(),r.nextClickShouldSelectGroup=!0,R.SUCCESS):r.chooseMove(i,r.state)}})()}neededCutting(e){return e.isFailure()&&e.getReason()===q3.MUST_CUT()}moveVirtuallyPiece(){const e=this.selectedPiece.get();this.pieces=this.pieces.filter(r=>!1===r.equals(e)),this.neighbors=this.getEmptyNeighbors()}showCuttable(){const e=jr.fromMovement(this.selectedPiece.get(),this.chosenLanding.get()),s=this.state.movePiece(e).getGroups(),i=j3.getBiggerGroups(s);this.cuttableGroups=[];for(const o of i)this.cuttableGroups.push(o.toList())}getSelectedPieceClass(){return this.chosenLanding.isPresent()?"moved-fill":"selected-stroke"}}return n.\u0275fac=function(e){return new(e||n)(J(En))},n.\u0275cmp=dt({type:n,selectors:[["app-six"]],features:[l],decls:10,vars:10,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["class","base round",3,"id","ngClass","click",4,"ngFor","ngForOf"],["class","base round",3,"id","click",4,"ngFor","ngForOf"],["class","base round",3,"id","ngClass","click",4,"ngIf"],["class","base round captured-fill",3,"id",4,"ngFor","ngForOf"],["class","base round moved-fill mid-stroke",3,"id","click",4,"ngIf"],["class","base no-fill round last-move-stroke mid-stroke",3,"id","click",4,"ngIf"],["class","base no-fill round",3,"id","ngClass","click",4,"ngIf"],["class","base no-fill round victory-stroke mid-stroke",3,"id",4,"ngFor","ngForOf"],["pointer-events","fill","class","capturable-stroke",4,"ngFor","ngForOf"],[1,"base","round",3,"id","ngClass","click"],[1,"base","round",3,"id","click"],[1,"base","round","captured-fill",3,"id"],[1,"base","round","moved-fill","mid-stroke",3,"id","click"],[1,"base","no-fill","round","last-move-stroke","mid-stroke",3,"id","click"],[1,"base","no-fill","round",3,"id","ngClass","click"],[1,"base","no-fill","round","victory-stroke","mid-stroke",3,"id"],["pointer-events","fill",1,"capturable-stroke"],["class","no-fill","stroke-linecap","round",3,"id","click",4,"ngFor","ngForOf"],["stroke-linecap","round",1,"no-fill",3,"id","click"]],template:function(e,r){1&e&&(F(),O(0,"svg",0),x(1,N5t,1,4,"polygon",1),x(2,I5t,1,3,"polygon",2),x(3,x5t,1,4,"polygon",3),x(4,k5t,1,3,"polygon",4),x(5,L5t,1,3,"polygon",5),x(6,R5t,1,3,"polygon",6),x(7,D5t,1,4,"polygon",7),x(8,z5t,1,3,"polygon",8),x(9,H5t,2,1,"g",9),A()),2&e&&(z("viewBox",r.viewBox),P(1),w("ngForOf",r.pieces),P(1),w("ngForOf",r.neighbors),P(1),w("ngIf",r.chosenLanding.isPresent()),P(1),w("ngForOf",r.disconnecteds),P(1),w("ngIf",r.leftCoord.isPresent()),P(1),w("ngIf",r.lastDrop.isPresent()),P(1),w("ngIf",r.selectedPiece.isPresent()),P(1),w("ngForOf",r.victoryCoords),P(1),w("ngForOf",r.cuttableGroups))},dependencies:[fn,On,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class Ca extends OH{static of(t,e){return new Ca(t,e)}static from(t,e){try{const r=new Ca(t,e);return _e.success(r)}catch(r){return _e.failure(r.message)}}getMaximalDistance(){return 9}}Ca.encoder=no.getFallibleEncoder(Ca.from);const B5t={CASTLE_IS_LEFT_FOR_GOOD:!1,BORDER_CAN_SURROUND_KING:!0,CENTRAL_THRONE_CAN_SURROUND_KING:!1,KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED:!1,WIDTH:9,INVADER:B.ZERO};class Y4 extends AH{static getInitialState(){const t=Sn.UNOCCUPIED,e=Sn.INVADERS,r=Sn.DEFENDERS;return new Y4([[t,t,t,e,e,e,t,t,t],[t,t,t,t,e,t,t,t,t],[t,t,t,t,r,t,t,t,t],[e,t,t,t,r,t,t,t,e],[e,e,r,r,Sn.PLAYER_ONE_KING,r,r,e,e],[e,t,t,t,r,t,t,t,e],[t,t,t,t,r,t,t,t,t],[t,t,t,t,e,t,t,t,t],[t,t,t,e,e,e,t,t,t]],0)}from(t,e){return new Y4(t,e)}}class L5 extends NH{constructor(){super(Y4,B5t,Ca.of)}static get(){return null==L5.singleton&&(L5.singleton=new L5),U1.ruler=this.singleton,L5.singleton}}const j=Sn.UNOCCUPIED,s1=Sn.INVADERS,oo=Sn.DEFENDERS,rT=Sn.PLAYER_ONE_KING;class Q3e extends $1{constructor(){super(...arguments),this.tutorial=[ie.informational($localize`Goal of the game`,$localize`Tablut is the lapland version of the Tafl, Tafl being a family of viking strategy game. The goal of the game is different for each player. The attacker plays first. Its pieces (dark) are close to the edges. Its goal is to capture the king, which is in the center of the board. The defender plays second. Its pieces (light) are in the middle. Its goal is to move the king on one of the 4 thrones in the corners. Note that the square in which the king starts, in the center of the board, is also a throne.`,Y4.getInitialState()),ie.anyMove($localize`Moving`,$localize`All pieces move the same way. Similarly to a rook in chess, a piece can move:<ol><li>By as many squares as you want.</li><li>Without going over another piece or stopping on another piece.</li><li>Horizontally or vertically.</li><li>Only the king can land on a throne.</li></ol>To move a piece, click on it and then on its landing square.<br/><br/>You're playing Dark, do the first move.`,Y4.getInitialState(),Ca.of(new S(4,1),new S(1,1)),$localize`Congratulations!`),ie.fromMove($localize`Capturing a soldier (1/2)`,$localize`All pieces, attackers and defenders, except the king, are soldiers. To capture them, they have to be sandwiched between two of your pieces. By getting too close, an attacker's soldier is in danger.<br/><br/>You're playing Light. Capture the soldier.`,new Y4([[j,j,j,s1,s1,s1,j,j,j],[j,j,j,j,s1,j,j,j,j],[j,j,j,j,oo,j,j,j,j],[j,j,j,s1,oo,j,j,j,s1],[s1,s1,oo,oo,rT,oo,oo,s1,s1],[j,j,j,j,oo,j,j,j,s1],[j,j,j,j,oo,j,j,j,j],[j,j,j,j,s1,j,j,j,j],[j,j,j,s1,s1,s1,j,j,j]],1),[Ca.of(new S(2,4),new S(2,3)),Ca.of(new S(4,2),new S(3,2))],$localize`Congratulations, that will teach him a lesson!`,$localize`Failed, you missed an opportunity to capture a piece of the opponent.`),ie.fromMove($localize`Capturing a soldier (2/2)`,$localize`A second way to capture a soldier is to sandwich it against an empty throne. The king has moved and endangered one of its soldiers.<br/><br/>You're playing Dark. Capture the soldier.`,new Y4([[j,j,j,s1,s1,s1,j,j,j],[j,j,j,j,s1,j,j,j,j],[j,j,j,j,oo,j,j,j,j],[j,j,oo,j,rT,j,oo,j,s1],[s1,s1,j,oo,j,oo,oo,s1,s1],[j,j,j,j,oo,j,j,j,s1],[j,j,j,j,oo,j,j,j,j],[j,j,j,j,s1,j,j,j,j],[j,j,j,s1,s1,s1,j,j,j]],12),[Ca.of(new S(1,4),new S(2,4))],$localize`Congratulations, one less defender. But keep an eye on the king, it is the most important.`,$localize`Failed, you did not do the expected move.`),ie.fromMove($localize`Capturing the king (1/2)`,$localize`To capture the king, two soldiers are not enough. For the first solution, the four squares neighbor to the king (horizontally and vertically) must be occupied by your soldiers. This also works if the king is on the throne.<br/><br/>You're playing Dark, capture the king.`,new Y4([[j,j,j,j,j,j,j,j,j],[j,j,j,j,j,j,j,j,j],[j,j,j,j,j,j,j,j,j],[j,s1,j,j,j,j,j,j,j],[s1,rT,j,s1,j,j,j,j,j],[j,s1,j,j,j,j,j,j,j],[j,j,j,j,j,j,j,j,j],[j,j,j,j,j,j,j,j,j],[j,j,j,j,j,j,j,j,j]],72),[Ca.of(new S(3,4),new S(2,4))],$localize`Congratulations, you won!`,$localize`Failed, you let the king run away.`),ie.fromMove($localize`Capturing the king (2/2)`,$localize`Another way to capture the king is to immobilize it against an edge of the board. Note that the king cannot be captured next to a throne.<br/><br/>You're playing Dark, capture the king.`,new Y4([[j,j,s1,rT,s1,j,j,j,j],[j,j,j,j,j,j,j,j,j],[j,j,j,j,j,j,j,j,j],[j,j,j,s1,j,j,j,j,j],[j,j,j,j,j,j,j,j,j],[j,j,j,j,j,j,j,j,j],[j,j,j,j,j,j,j,j,j],[j,j,j,j,j,j,j,j,j],[j,j,j,j,j,j,j,j,j]],72),[Ca.of(new S(3,3),new S(3,1))],$localize`The king is dead, long live the king. Congratulations, you won.`,$localize`Failed. Try again.`)]}}function $5t(n,t){1&n&&(F(),X(0,"polygon",8))}function U5t(n,t){1&n&&(F(),X(0,"rect",9))}function G5t(n,t){if(1&n&&(F(),O(0,"g"),x(1,$5t,1,0,"polygon",6),x(2,U5t,1,0,"ng-template",null,7,Zn),A()),2&n){const e=Bn(3),r=C().index,s=C().index,i=C();P(1),w("ngIf",i.isCentralThrone(r,s))("ngIfElse",e)}}function W5t(n,t){if(1&n&&(F(),O(0,"g"),X(1,"line",13)(2,"line",13)(3,"line",13)(4,"line",13)(5,"line",13),A()),2&n){const e=C(2).index,r=C().index,s=C();P(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),z("x1",.5*s.SPACE_SIZE)("y1",.04*s.SPACE_SIZE)("x2",.5*s.SPACE_SIZE)("y2",.96*s.SPACE_SIZE),P(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),z("x1",.5*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.1*s.SPACE_SIZE)("y2",.6*s.SPACE_SIZE),P(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),z("x1",.5*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.9*s.SPACE_SIZE)("y2",.6*s.SPACE_SIZE),P(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),z("x1",.5*s.SPACE_SIZE)("y1",.4*s.SPACE_SIZE)("x2",.15*s.SPACE_SIZE)("y2",.75*s.SPACE_SIZE),P(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),z("x1",.5*s.SPACE_SIZE)("y1",.4*s.SPACE_SIZE)("x2",.85*s.SPACE_SIZE)("y2",.75*s.SPACE_SIZE)}}function q5t(n,t){if(1&n&&(F(),X(0,"polyline",16)),2&n){const e=C(3).index,r=C().index;w("ngClass",C().viewInfo.pieceClasses[r][e])}}function j5t(n,t){if(1&n&&(F(),X(0,"line",13)(1,"line",13)(2,"line",13)(3,"line",13)),2&n){const e=C(3).index,r=C().index,s=C();w("ngClass",s.viewInfo.pieceClasses[r][e]),z("x1",.5*s.SPACE_SIZE)("y1",.04*s.SPACE_SIZE)("x2",.5*s.SPACE_SIZE)("y2",.96*s.SPACE_SIZE),P(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),z("x1",.04*s.SPACE_SIZE)("y1",.5*s.SPACE_SIZE)("x2",.96*s.SPACE_SIZE)("y2",.5*s.SPACE_SIZE),P(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),z("x1",.2*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.8*s.SPACE_SIZE)("y2",.8*s.SPACE_SIZE),P(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),z("x1",.8*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.2*s.SPACE_SIZE)("y2",.8*s.SPACE_SIZE)}}function Z5t(n,t){if(1&n&&(F(),x(0,q5t,1,1,"polyline",14),x(1,j5t,4,20,"ng-template",null,15,Zn)),2&n){const e=Bn(2),r=C(2).index,s=C().index;w("ngIf",C().isKing(r,s))("ngIfElse",e)}}function Y5t(n,t){if(1&n&&(F(),O(0,"g"),X(1,"circle",10),x(2,W5t,6,25,"g",11),x(3,Z5t,3,2,"ng-template",null,12,Zn),A()),2&n){const e=Bn(4),r=C().index,s=C().index,i=C();P(1),De("id","piece_",r,"_",s,""),w("ngClass",i.viewInfo.pieceClasses[s][r]),z("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)("cx",.5*i.SPACE_SIZE)("cy",.5*i.SPACE_SIZE),P(1),w("ngIf",i.isInvader(r,s))("ngIfElse",e)}}function K5t(n,t){if(1&n){const e=Oe();F(),O(0,"g",3),ee("click",function(){const i=ue(e).index,o=C().index;return ce(C().onClick(i,o))}),X(1,"rect",4),x(2,G5t,4,2,"g",5),x(3,Y5t,5,8,"g",5),A()}if(2&n){const e=t.index,r=C().index,s=C();De("id","click_",e,"_",r,""),z("transform","translate("+s.SPACE_SIZE*e+", "+s.SPACE_SIZE*r+")"),P(1),De("id","space_",e,"_",r,""),w("ngClass",s.getRectClasses(e,r)),z("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),P(1),w("ngIf",s.board[r][e]===s.EMPTY&&s.isThrone(e,r)),P(1),w("ngIf",s.board[r][e]!==s.EMPTY)}}function X5t(n,t){if(1&n&&(F(),O(0,"g"),x(1,K5t,4,10,"g",2),A()),2&n){const e=t.$implicit;P(1),w("ngForOf",e)}}function Q5t(n,t){if(1&n){const e=Oe();F(),O(0,"g")(1,"rect",17),ee("click",function(){const i=ue(e).$implicit;return ce(C().onClick(i.x,i.y))}),A()()}if(2&n){const e=t.$implicit,r=C();P(1),De("id","click_",e.x,"_",e.y,""),z("x",r.SPACE_SIZE*e.x)("y",r.SPACE_SIZE*e.y)("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)}}let J5t=(()=>{class n extends IH{constructor(e){super(e,!1,Ca.from),this.rules=L5.get(),this.availableMinimaxes=[new MP(this.rules,"DummyBot"),new PP(this.rules,"Piece > Influence"),new TP(this.rules,"Piece > Control"),new xH(this.rules,"Escape > Piece > Control")],this.encoder=Ca.encoder,this.tutorial=(new Q3e).tutorial,this.updateBoard()}}return n.\u0275fac=function(e){return new(e||n)(J(En))},n.\u0275cmp=dt({type:n,selectors:[["app-tablut"]],features:[l],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["x","0","y","0",1,"base",3,"id","ngClass"],[4,"ngIf"],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60","class","base",4,"ngIf","ngIfElse"],["cornerThrone",""],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60",1,"base"],["x","15","y","15","width","70","height","70",1,"base"],[1,"base",3,"id","ngClass"],[4,"ngIf","ngIfElse"],["defender",""],[1,"base",3,"ngClass"],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85","class","base no-fill",3,"ngClass",4,"ngIf","ngIfElse"],["soldierDefender",""],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85",1,"base","no-fill",3,"ngClass"],[1,"no-fill","mid-stroke","clickable-stroke",3,"id","click"]],template:function(e,r){1&e&&(F(),O(0,"svg",0),x(1,X5t,2,1,"g",1),x(2,Q5t,2,6,"g",1),A()),2&e&&(z("viewBox",r.getViewBox()),P(1),w("ngForOf",r.board),P(1),w("ngForOf",r.getClickables()))},dependencies:[fn,On,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class V2{constructor(t,e){this.owner=t,this.tileId=e}toString(){return`TrexoPiece(${this.owner.toString()}, ${this.tileId})`}}class zs{constructor(t){this.pieces=t}static from(t){let e=-1;for(const r of t)Pe(e<r.tileId,"TrexoPieceStack: dropped turn should be ascending"),e=r.tileId;return new zs(t)}getHeight(){return this.pieces.length}getOwner(){const t=this.pieces.length;return 0===t?he.NONE:this.pieces[t-1].owner}getUpperTileId(){const t=this.pieces.length;return 0===t?-1:this.pieces[t-1].tileId}add(t){return zs.from(this.pieces.concat(t))}getPieceAt(t){return Pe(t<this.pieces.length,"no element "+t+"in piece!"),this.pieces[t]}isGround(){return-1===this.getUpperTileId()}toString(){return"["+this.pieces.map(t=>"("+t.toString()+")").join(" ")+"]"}}zs.EMPTY=zs.from([]);let is=(()=>{class n extends Br{static getInitialState(){const e=Xe.createTable(n.SIZE,n.SIZE,zs.EMPTY);return new n(e,0)}static from(e,r){Pe(e.length===n.SIZE,"Invalid board dimensions");for(const s of e)Pe(s.length===n.SIZE,"Invalid board dimensions");return _e.success(new n(e,r))}drop(e,r){const s=this.getCopiedBoard(),i=new V2(r,this.turn);return s[e.y][e.x]=s[e.y][e.x].add(i),new n(s,this.turn)}incrementTurn(){return new n(this.getCopiedBoard(),this.turn+1)}toString(){return this.board.map(e=>"["+e.map(r=>"TrexoPieceStack.from("+r.toString()+")").join(", ")+"]").join("\n,")}getPieceAtXYZ(e,r,s){return this.getPieceAtXY(e,r).getPieceAt(s)}}return n.SIZE=10,n})(),sT=(()=>{class n{}return n.NON_NEIGHBORING_SPACES=()=>$localize`Those two spaces are not neighbors!`,n.NO_WAY_TO_DROP_IT_HERE=()=>$localize`There is no way to put a piece there!`,n.CANNOT_DROP_ON_ONLY_ONE_PIECE=()=>$localize`You cannot drop on only one piece!`,n.CANNOT_DROP_PIECE_ON_UNEVEN_GROUNDS=()=>$localize`You cannot drop a piece on uneven grounds!`,n})();class ya extends no{constructor(t,e){super(t,e)}static from(t,e){return Pe(t.isInRange(is.SIZE,is.SIZE),`${t.toString()} is out of the TrexoBoard!`),Pe(e.isInRange(is.SIZE,is.SIZE),`${e.toString()} is out of the TrexoBoard!`),1===t.getOrthogonalDistance(e)?_e.success(new ya(t,e)):_e.failure(sT.NON_NEIGHBORING_SPACES())}toString(){return this.getFirst().toString()+" && "+this.getSecond().toString()}equals(t){return this.getFirst().equals(t.getFirst())&&this.getSecond().equals(t.getSecond())}getZero(){return this.getFirst()}getOne(){return this.getSecond()}}ya.encoder=no.getFallibleEncoder(ya.from);class Zi extends L1{constructor(){super(is)}static getOwner(t){return t.getOwner()}static isInRange(t){return t.isInRange(is.SIZE,is.SIZE)}static get(){return Zi.instance.isAbsent()&&(Zi.instance=T.of(new Zi)),Zi.instance.get()}applyLegalMove(t,e,r){return e.drop(t.getZero(),B.ZERO).drop(t.getOne(),B.ONE).incrementTurn()}isLegal(t,e){return this.isUnevenGround(t,e)?R.failure(sT.CANNOT_DROP_PIECE_ON_UNEVEN_GROUNDS()):this.landsOnOnlyOnePiece(t,e)?R.failure(sT.CANNOT_DROP_ON_ONLY_ONE_PIECE()):R.SUCCESS}isUnevenGround(t,e){const r=e.getPieceAt(t.getZero()),s=e.getPieceAt(t.getOne());return r.getHeight()!==s.getHeight()}landsOnOnlyOnePiece(t,e){const r=e.getPieceAt(t.getZero()),s=e.getPieceAt(t.getOne());return(-1!==r.getUpperTileId()||-1!==s.getUpperTileId())&&r.getUpperTileId()===s.getUpperTileId()}static getSquareScore(t,e){return Zi.TREXO_HELPER.getSquareScore(t,e)}static getVictoriousCoords(t){const e=[],r=[],s=t.getCurrentOpponent();for(const i of t.toMap()){const o=i.key,c=t.getPieceAt(o).getOwner();if(c.isPlayer()){const u=Zi.getSquareScore(t,o);U1.getScoreStatus(u)===Mn.VICTORY&&(c===s?e.push(o):r.push(o))}}return r.length>0?r:e}getGameStatus(t){const e=t.gameState,r=e.getCurrentOpponent();let s=!1;for(const i of e.toMap()){const o=i.key,c=e.getPieceAt(o).getOwner();if(c.isPlayer()){const u=Zi.getSquareScore(e,o);if(U1.getScoreStatus(u)===Mn.VICTORY){if(c!==r)return xe.getDefeat(r);s=!0}}}return s?xe.getVictory(r):xe.ONGOING}getLegalMoves(t){const e=[];for(const r of t.toMap()){const s=r.key;if(s.x+1<is.SIZE){const i=new S(s.x+1,s.y);e.push(...this.getPossiblesMoves(t,s,i))}if(s.y+1<is.SIZE){const i=new S(s.x,s.y+1);e.push(...this.getPossiblesMoves(t,s,i))}}return e}getPossiblesMoves(t,e,r){const s=t.getPieceAt(e),i=t.getPieceAt(r);let o;o=!s.isGround()&&s.getUpperTileId()===i.getUpperTileId();const c=s.getHeight()!==i.getHeight();return o||c?[]:[ya.from(e,r).get(),ya.from(r,e).get()]}}Zi.instance=T.empty(),Zi.TREXO_HELPER=new Bm(Zi.isInRange,Zi.getOwner,5);class e7t extends k3{getListMoves(t){return Zi.get().getLegalMoves(t.gameState)}getBoardValue(t){let e=0;const r=t.gameState,s=r.getCurrentOpponent();let i=!1;for(const o of r.toMap()){const c=r.getPieceAt(o.key).getOwner();if(c.isPlayer()){const u=Zi.getSquareScore(r,o.key);if(U1.getScoreStatus(u)===Mn.VICTORY){if(c!==s)return new k1(s.getDefeatValue());i=!0}else e+=u}}return new k1(i?s.getVictoryValue():e)}}const fe=zs.EMPTY,J3e=zs.from([new V2(B.ONE,0)]),t7t=zs.from([new V2(B.ZERO,0)]),n7t=zs.from([new V2(B.ONE,1)]),e4e=zs.from([new V2(B.ZERO,1)]),r7t=zs.from([new V2(B.ZERO,2)]),s7t=zs.from([new V2(B.ONE,2)]),i7t=zs.from([new V2(B.ZERO,0),new V2(B.ZERO,3)]),o7t=zs.from([new V2(B.ONE,1),new V2(B.ONE,3)]),a7t=zs.from([new V2(B.ZERO,4)]),c7t=zs.from([new V2(B.ONE,4)]),l7t=zs.from([new V2(B.ZERO,5)]),u7t=zs.from([new V2(B.ONE,5)]),f7t=zs.from([new V2(B.ONE,6)]),d7t=zs.from([new V2(B.ZERO,6)]);class t4e extends $1{constructor(){super(...arguments),this.tutorial=[ie.informational($localize`Goal of the game`,$localize`At Trexo, the goal of the game is to align 5 pieces of your color in a vertical, horizontal or diagonal line. However, the players play with tiles that are constituted of two pieces, one from each player!`,is.getInitialState()),ie.anyMove($localize`Dropping a tile`,$localize`When you drop a tile, it needs to be on even ground, and it cannot be right on top of another tile. In others words, it needs to be either on the floor, or on two tiles at the same height. To drop a tile, just click on the square where you want to put the opponent side of the tile, then on the neighboring square where you want to put your piece.<br/><br/>You're playing Dark, put a tile on the board.`,is.getInitialState(),ya.from(new S(4,4),new S(3,4)).get(),$localize`Congratulations!`),ie.fromMove($localize`Dropping a piece over other pieces`,$localize`You can put a tile on other tiles. For that you must respect two rules:<br/><ul><li>The two pieces must be at the same height.</li><li>You cannot drop your piece on only one other piece.</li></ul><br/>You're playing Dark, do such a move!`,new is([[fe,fe,fe,J3e,t7t,e4e,n7t,fe,fe,fe],[fe,fe,fe,fe,fe,fe,fe,fe,fe,fe],[fe,fe,fe,fe,fe,fe,fe,fe,fe,fe],[fe,fe,fe,fe,fe,fe,fe,fe,fe,fe],[fe,fe,fe,fe,fe,fe,fe,fe,fe,fe],[fe,fe,fe,fe,fe,fe,fe,fe,fe,fe],[fe,fe,fe,fe,fe,fe,fe,fe,fe,fe],[fe,fe,fe,fe,fe,fe,fe,fe,fe,fe],[fe,fe,fe,fe,fe,fe,fe,fe,fe,fe],[fe,fe,fe,fe,fe,fe,fe,fe,fe,fe]],7),[ya.from(new S(4,0),new S(5,0)).get(),ya.from(new S(5,0),new S(4,0)).get()],$localize`Congratulations!`,$localize`Failed, you put that piece on the floor level, please put it on top of two pieces.`),ie.fromPredicate($localize`Victory`,$localize`To win at Trexo, you need to align 5 of your pieces. Only the piece on top counts, the hidden piece are no longer threats, and a victory can include pieces on differents heights. Since you have to put the piece of your opponent first, if you create a victory for them, you lose, even if you aligned 5 of your pieces too.<br/><br/>You're playing Light, win.`,new is([[fe,fe,fe,fe,fe,fe,fe,fe,fe,fe],[fe,fe,fe,l7t,fe,fe,fe,fe,fe,fe],[fe,fe,fe,u7t,fe,fe,fe,fe,fe,fe],[fe,fe,fe,fe,J3e,fe,fe,a7t,c7t,fe],[fe,fe,fe,fe,i7t,o7t,e4e,fe,fe,fe],[fe,fe,fe,fe,fe,r7t,f7t,d7t,fe,fe],[fe,fe,fe,fe,fe,s7t,fe,fe,fe,fe],[fe,fe,fe,fe,fe,fe,fe,fe,fe,fe],[fe,fe,fe,fe,fe,fe,fe,fe,fe,fe],[fe,fe,fe,fe,fe,fe,fe,fe,fe,fe]],7),ya.from(new S(2,0),new S(2,1)).get(),(t,e,r)=>Zi.TREXO_HELPER.getSquareScore(r,t.getOne())===Number.MAX_SAFE_INTEGER?R.SUCCESS:R.failure($localize`Failed. Try again.`),$localize`Congratulations, you won!`)]}}function h7t(n,t){if(1&n){const e=Oe();F(),O(0,"g")(1,"polygon",5),ee("click",function(){const i=ue(e).index,o=C().index;return ce(C().onClick(i,o))}),A()()}if(2&n){const e=t.index,r=C().index,s=C();P(1),De("id","space_",e,"_",r,""),w("ngClass",s.getSpaceClasses(e,r)),z("points",s.getParallelogramPoints())("transform",s.getTranslate(e,r,0))}}function p7t(n,t){if(1&n&&(F(),O(0,"g"),x(1,h7t,2,5,"g",1),A()),2&n){const e=t.$implicit;P(1),w("ngForOf",e)}}function g7t(n,t){if(1&n){const e=Oe();F(),O(0,"g",8),ee("click",function(){ue(e);const s=C().index,i=C().index;return ce(C(2).onClick(s,i))}),A()}if(2&n){const e=C(),r=e.index,s=e.$implicit,i=C().index,o=C().index,c=C();j2("id","half_tile_",r,"_",i,"_",o,""),w("mode",c.mode)("coord",c.Coord3D.of(r,i,o))("mustDisplayHeight","2D"===c.chosenMode)("move",s.move.get())("pieceClasses",c.getPieceClasses(r,i,o)),z("transform",c.getTranslate(r,i,o+1))}}const n4e=function(n){return[n]};function m7t(n,t){if(1&n){const e=Oe();F(),O(0,"g",9),ee("click",function(){ue(e);const s=C().index,i=C().index;return ce(C(2).onClick(s,i))}),A()}if(2&n){const e=C().index,r=C().index,s=C().index,i=C();j2("id","dropped_piece_",e,"_",r,"_",s,""),w("mode",i.mode)("coord",i.Coord3D.of(e,r,s))("pieceClasses",T3(7,n4e,i.currentOpponentClass)),z("transform",i.getTranslate(e,r,s+1))}}function _7t(n,t){if(1&n&&(F(),O(0,"g"),x(1,g7t,1,9,"g",6),x(2,m7t,1,9,"g",7),A()),2&n){const e=t.$implicit;P(1),w("ngIf",e.move.isPresent()),P(1),w("ngIf",e.isDroppedPiece)}}function v7t(n,t){if(1&n&&(F(),O(0,"g"),x(1,_7t,3,2,"g",1),A()),2&n){const e=t.$implicit;P(1),w("ngForOf",e)}}function C7t(n,t){if(1&n&&(F(),O(0,"g"),x(1,v7t,2,1,"g",1),A()),2&n){const e=t.$implicit;P(1),w("ngForOf",e)}}const y7t=function(){return["player0-fill"]};function E7t(n,t){if(1&n){const e=Oe();F(),O(0,"g",10),ee("click",function(){return ue(e),ce(C().switchToMode("3D"))}),A()}if(2&n){const e=C();w("mode",e.TrexoComponent.modeMap["3D"])("coord",e.Coord3D.of(10.5,8.5,0))("pieceClasses",J1(4,y7t)),z("transform",e.get3DSwitcherTransform())}}function M7t(n,t){if(1&n){const e=Oe();F(),O(0,"g",11),ee("click",function(){return ue(e),ce(C().switchToMode("2D"))}),A()}if(2&n){const e=C();w("mode",e.TrexoComponent.modeMap["2D"])("coord",e.Coord3D.of(12,9,0))("pieceClasses",T3(4,n4e,e.currentPlayerClass)),z("transform",e.getTranslate(12,9,0))}}class u1 extends E3e{constructor(t){super(t),this.TrexoComponent=u1,this.left=-this.STROKE_WIDTH/2,this.Coord3D=n_,this.up=0,this.chosenMode="3D",this.victoryCoords=[],this.droppedPiece=T.empty(),this.possibleNextClicks=[],this.possibleMoves=[],this.pieceOnBoard=[],this.currentOpponentClass="player1",this.currentPlayerClass="player0",this.rules=Zi.get(),this.availableMinimaxes=[new e7t(this.rules,"TrexoMinimax")],this.encoder=ya.encoder,this.tutorial=(new t4e).tutorial,u1.STROKE_WIDTH=this.STROKE_WIDTH,this.switchToMode("3D"),this.updateBoard()}switchToMode(t){this.chosenMode=t,this.width=this.getViewBoxWidth(),this.up=this.getViewBoxUp(),this.height=this.getViewBoxHeight(),this.mode=u1.modeMap[t]}getViewBoxWidth(){const t=u1.modeMap["3D"],e=is.SIZE;return"2D"===this.chosenMode?(e+1)*this.SPACE_SIZE+2*this.STROKE_WIDTH:e*(this.SPACE_SIZE*(t.horizontalWidthRatio+t.offsetRatio))+this.STROKE_WIDTH}getViewBoxHeight(){const e=is.SIZE*this.SPACE_SIZE;return"2D"===this.chosenMode?e:this.STROKE_WIDTH+e+this.getHigherStackHeight()}getViewBoxUp(){if("2D"===this.chosenMode)return 0;{const t=this.getHigherStackHeight();return-(this.STROKE_WIDTH/2+t)}}getHigherStackHeight(){return(this.pieceOnBoard.length+1)*u1.modeMap[this.chosenMode].pieceHeightRatio*this.SPACE_SIZE}updateBoard(){const t=this.getState();this.board=t.getCopiedBoard(),this.currentOpponentClass=this.getPlayerClass(t.getCurrentOpponent()),this.currentPlayerClass=this.getPlayerClass(t.getCurrentPlayer()),this.possibleMoves=this.rules.getLegalMoves(t),this.victoryCoords=Zi.getVictoriousCoords(t),this.pieceOnBoard=this.get3DBoard(),this.height=this.getViewBoxHeight(),this.up=this.getViewBoxUp()}get3DBoard(){const t=Xe.create3DTable(1,is.SIZE,is.SIZE,u1.INITIAL_PIECE_ON_BOARD);let e=1;for(let r=0;r<=e;r++)for(const s of this.getState().toMap()){const i=s.key,o=s.value.getHeight();if(e=Math.max(e,o),r<o){const c=this.extractMoveFromState(i.x,i.y,r);this.addMoveToArray(r,c,t)}}return t}extractMoveFromState(t,e,r){const s=this.getState().getPieceAtXYZ(t,e,r),i=new S(t,e);let o=new S(-2,-2);for(const c of Ne.ORTHOGONALS){const u=i.getNext(c);if(u.isInRange(is.SIZE,is.SIZE)){const d=this.getState().getPieceAt(u);d.getHeight()>r&&d.getPieceAt(r).tileId===s.tileId&&(o=u)}}return s.owner===B.ZERO?ya.from(i,o).get():ya.from(o,i).get()}addMoveToArray(t,e,r){for(;r.length<=t;)r.push(Xe.createTable(is.SIZE,is.SIZE,u1.INITIAL_PIECE_ON_BOARD));r[t][e.getZero().y][e.getZero().x]={isDroppedPiece:!1,isPossibleClick:!1,move:T.of(e)},r[t][e.getOne().y][e.getOne().x]={isDroppedPiece:!1,isPossibleClick:!1,move:T.of(e)}}onClick(t,e){var r=this;return I(function*(){const s=r.canUserPlay("#space_"+t+"_"+e);if(s.isFailure())return r.cancelMove(s.getReason());const i=new S(t,e);if(r.droppedPiece.isPresent()){const o=r.droppedPiece.get();if(r.droppedPiece.equalsValue(i))return r.cancelMoveAttempt(),R.SUCCESS;if(r.possibleNextClicks.some(c=>c.equals(i))){const c=r.getState().getCurrentPlayer()===B.ZERO,g=ya.from(c?i:o,c?o:i).get();return r.chooseMove(g,r.getState())}r.deselectPiece()}return r.selectPiece(i)})()}deselectPiece(){const t=this.getState().getPieceAt(this.droppedPiece.get()).getHeight(),e=this.droppedPiece.get().y,r=this.droppedPiece.get().x;this.pieceOnBoard[t][e][r]=u1.INITIAL_PIECE_ON_BOARD;for(const s of this.possibleNextClicks)this.pieceOnBoard[t][s.y][s.x].isPossibleClick=!1}selectPiece(t){if(this.possibleMoves.some(e=>e.getZero().equals(t))){const e=this.getState().getPieceAt(t).getHeight();return e>=this.pieceOnBoard.length&&this.pieceOnBoard.push(Xe.createTable(is.SIZE,is.SIZE,u1.INITIAL_PIECE_ON_BOARD)),this.showDroppedPieceAndIndicators(t,e),R.SUCCESS}return this.cancelMove(sT.NO_WAY_TO_DROP_IT_HERE())}showDroppedPieceAndIndicators(t,e){this.droppedPiece=T.of(t),this.possibleNextClicks=this.getPossibleNextClicks(t);for(const r of this.possibleNextClicks)this.pieceOnBoard[e][r.y][r.x]={isDroppedPiece:!1,isPossibleClick:!0,move:T.empty()};this.pieceOnBoard[e][t.y][t.x]={isDroppedPiece:!0,isPossibleClick:!1,move:T.empty()}}getPossibleNextClicks(t){return this.possibleMoves.filter(r=>r.getZero().equals(t)).map(r=>r.getOne())}cancelMoveAttempt(){this.droppedPiece=T.empty(),this.possibleNextClicks=[],this.updateBoard()}getPieceClasses(t,e,r){const s=new S(t,e),i=this.getState().getPieceAtXYZ(t,e,r).owner;let o=[this.getPlayerClass(i)];o=o.concat(this.getSpaceClasses(t,e));for(const c of this.victoryCoords)if(c.equals(s)){o.push("victory-stroke");break}if(this.rules.node.move.isPresent()){const c=this.rules.node.move.get();(c.getZero().equals(s)||c.getOne().equals(s))&&o.push("last-move-stroke")}return o}getSpaceClasses(t,e){for(const r of this.pieceOnBoard)if(r[e][t].isPossibleClick)return["darker"];return[]}getTranslate(t,e,r){const i=this.getCoordTranslate(t,e,r,u1.modeMap[this.chosenMode]);return"translate("+i.x+" "+i.y+")"}getParallelogramPoints(){return this.getParallelogramCoordsForTrexo().map(e=>e.x+" "+e.y).join(" ")}getParallelogramCoordsForTrexo(){return this.getParallelogramCoords(u1.modeMap[this.chosenMode])}get3DSwitcherTransform(){const t=u1.modeMap["3D"],e=t.horizontalWidthRatio+t.offsetRatio;return"translate("+(10+t.offsetRatio)*t.parallelogramHeight+", "+(9+(1-1/e)/2)*t.parallelogramHeight+") scale("+1/e+")"}}u1.VERBOSE=!1,u1.INITIAL_PIECE_ON_BOARD={isDroppedPiece:!1,isPossibleClick:!1,move:T.empty()},u1.modeMap={"2D":{offsetRatio:0,horizontalWidthRatio:1,pieceHeightRatio:0,parallelogramHeight:100,abstractBoardSize:10},"3D":{offsetRatio:.4,horizontalWidthRatio:1.2,pieceHeightRatio:.2,parallelogramHeight:100,abstractBoardSize:10}},u1.\u0275fac=function(t){return new(t||u1)(J(En))},u1.\u0275cmp=dt({type:u1,selectors:[["app-trexo"]],features:[l],decls:8,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%"],[4,"ngFor","ngForOf"],["switchModeIndicator",""],["id","switchTo3D","mgp-trexo-half-piece","",3,"mode","coord","pieceClasses","click",4,"ngIf","ngIfElse"],["switchTo2D",""],[1,"base",3,"id","ngClass","click"],["mgp-trexo-half-piece","",3,"id","mode","coord","mustDisplayHeight","move","pieceClasses","click",4,"ngIf"],["mgp-trexo-half-piece","",3,"mode","id","coord","pieceClasses","click",4,"ngIf"],["mgp-trexo-half-piece","",3,"id","mode","coord","mustDisplayHeight","move","pieceClasses","click"],["mgp-trexo-half-piece","",3,"mode","id","coord","pieceClasses","click"],["id","switchTo3D","mgp-trexo-half-piece","",3,"mode","coord","pieceClasses","click"],["mgp-trexo-half-piece","","id","switchTo2D",3,"mode","coord","pieceClasses","click"]],template:function(t,e){if(1&t&&(F(),O(0,"svg",0),x(1,p7t,2,1,"g",1),x(2,C7t,2,1,"g",1),O(3,"g",null,2),x(5,E7t,1,5,"g",3),x(6,M7t,1,6,"ng-template",null,4,Zn),A()()),2&t){const r=Bn(7);z("viewBox",e.left+" "+e.up+" "+e.width+" "+e.height),P(1),w("ngForOf",e.board),P(1),w("ngForOf",e.pieceOnBoard),P(3),w("ngIf","2D"===e.chosenMode)("ngIfElse",r)}},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});class Lr{}Lr.PLACEMENT_AFTER_INITIAL_PHASE=()=>$localize`You cannot put a new ring after the tenth turn.`,Lr.NO_MARKERS_IN_INITIAL_PHASE=()=>$localize`You cannot put a marker in a ring before placing all of your rings.`,Lr.MISSING_CAPTURES=$c.MISSING_CAPTURES,Lr.MOVE_DIRECTION_INVALID=()=>$localize`The direction of your move is invalid: a move is made along a straight line.`,Lr.CAN_ONLY_CAPTURE_YOUR_MARKERS=()=>$localize`You can only capture your own markers.`,Lr.SHOULD_SELECT_PLAYER_RING=()=>$localize`You must pick one of your own rings to move.`,Lr.SHOULD_END_MOVE_ON_EMPTY_SPACE=()=>$localize`Your ring must land on an empty space.`,Lr.MOVE_SHOULD_NOT_PASS_ABOVE_RING=()=>$localize`A ring can only jump over markers or empty spaces, not over another ring.`,Lr.MOVE_SHOULD_END_AT_FIRST_EMPTY_SPACE_AFTER_MARKERS=()=>$localize`Your ring must land on the first empty space after a group of markers.`,Lr.AMBIGUOUS_CAPTURE_COORD=$c.AMBIGUOUS_CAPTURE_COORD,Lr.CAPTURE_SHOULD_TAKE_RING=()=>$localize`When you capture markers, you must take one of your ring as well by clicking on it.`;class bt{constructor(t,e){this.player=t,this.isRing=e}static of(t,e){return t===he.NONE?bt.EMPTY:e?bt.RINGS[t.value]:bt.MARKERS[t.value]}equals(t){return this===t}flip(){return Pe(!1===this.isRing,"cannot flip a ring (it should never happen)"),Pe(this.player.isPlayer(),"cannot flip a non-player piece"),bt.of(this.player.getOpponent(),this.isRing)}toString(){switch(this){case bt.UNREACHABLE:return"NONE";case bt.EMPTY:return"EMPTY";case bt.MARKER_ZERO:return"MARKER_ZERO";case bt.MARKER_ONE:return"MARKER_ONE";case bt.RING_ZERO:return"RING_ZERO";default:return Me.expectToBe(this,bt.RING_ONE),"RING_ONE"}}}bt.encoder=Nt.tuple([he.encoder,Nt.identity()],n=>[n.player,n.isRing],n=>bt.of(n[0],n[1])),bt.UNREACHABLE=new bt(he.NONE,!1),bt.EMPTY=new bt(he.NONE,!1),bt.MARKER_ZERO=new bt(B.ZERO,!1),bt.MARKER_ONE=new bt(B.ONE,!1),bt.MARKERS=[bt.MARKER_ZERO,bt.MARKER_ONE],bt.RING_ZERO=new bt(B.ZERO,!0),bt.RING_ONE=new bt(B.ONE,!0),bt.RINGS=[bt.RING_ZERO,bt.RING_ONE];let oc=(()=>{class n extends RH{constructor(e,r,s){super(s,e,n.SIZE,n.SIZE,[6,4,3,2,1],bt.EMPTY),this.sideRings=r}static getInitialState(){const e=bt.EMPTY,r=bt.UNREACHABLE;return new n([[r,r,r,r,r,r,e,e,e,e,r],[r,r,r,r,e,e,e,e,e,e,e],[r,r,r,e,e,e,e,e,e,e,e],[r,r,e,e,e,e,e,e,e,e,e],[r,e,e,e,e,e,e,e,e,e,e],[r,e,e,e,e,e,e,e,e,e,r],[e,e,e,e,e,e,e,e,e,e,r],[e,e,e,e,e,e,e,e,e,r,r],[e,e,e,e,e,e,e,e,r,r,r],[e,e,e,e,e,e,e,r,r,r,r],[r,e,e,e,e,r,r,r,r,r,r]],[5,5],0)}isInitialPlacementPhase(){return this.turn<10}countScores(){return this.turn<10?[0,0]:this.sideRings}equals(e){return this===e||this.turn===e.turn&&this.sideRings[0]===e.sideRings[0]&&this.sideRings[1]===e.sideRings[1]&&Xe.compareTable(this.board,e.board)}getRingCoords(e){const r=[];return this.forEachCoord((s,i)=>{i.isRing&&i.player===e&&r.push(s)}),r}isOnBoard(e){return!e.isNotInRange(this.width,this.height)&&this.board[e.y][e.x]!==bt.UNREACHABLE}setAtUnsafe(e,r){const s=Xe.copyBiArray(this.board);return s[e.y][e.x]=r,new n(s,this.sideRings,this.turn)}}return n.SIZE=11,n})();class Ea extends yi{constructor(t,e){if(super(t),5!==t.length)throw new Error("YinshCapture must capture exactly 5 pieces");this.ringTaken=T.ofNullable(e)}static of(t,e,r){const s=[],i=Re.factory.fromMove(t,e).get();for(let o=t;!1===o.equals(e);o=o.getNext(i))s.push(o);return s.push(e),new Ea(s,r)}setRingTaken(t){return new Ea(this.capturedSpaces,t)}equals(t){return!(!1===super.equals(t)||!1===this.ringTaken.equals(t.ringTaken))}}Ea.encoder=new class extends L4{encode(n){return{captured:n.capturedSpaces.map(t=>S.encoder.encode(t)),ringTaken:S.encoder.encode(n.ringTaken.get())}}decode(n){const t=n;return Pe(null!=t.captured&&null!=t.ringTaken,"Invalid encoded YinshCapture"),new Ea(t.captured.map(e=>S.encoder.decode(e)),S.encoder.decode(t.ringTaken))}};class ac extends Fi{constructor(t,e,r,s){super(),this.initialCaptures=t,this.start=e,this.end=r,this.finalCaptures=s}isInitialPlacement(){return this.end.isAbsent()}equals(t){return this===t||!(!1===this.start.equals(t.start)||!1===this.end.equals(t.end)||!1===Xe.compareArray(this.initialCaptures,t.initialCaptures)||!1===Xe.compareArray(this.finalCaptures,t.finalCaptures))}toString(){return"YinshMove(["+this.capturesToString(this.initialCaptures)+"], "+this.start.toString()+", "+this.end.toString()+", ["+this.capturesToString(this.finalCaptures)+"])"}capturesToString(t){let e="";for(const r of t)""!==e&&(e+=","),e+="["+r.toString()+"]";return e}}ac.coordOptionalEncoder=T.getEncoder(S.encoder),ac.encoder=new class extends Nt{encodeMove(n){const t={moveStart:S.encoder.encode(n.start),moveEnd:ac.coordOptionalEncoder.encode(n.end)};return n.initialCaptures.map((e,r)=>{t["initialCapture"+r]=Ea.encoder.encode(e)}),n.finalCaptures.map((e,r)=>{t["finalCapture"+r]=Ea.encoder.encode(e)}),t}decodeMove(n){const t=n;return Pe(null!=t.moveStart,"Invalid encoded YinshMove"),new ac(this.decodeArray(t,"initialCapture",Ea.encoder.decode),S.encoder.decode(t.moveStart),ac.coordOptionalEncoder.decode(t.moveEnd),this.decodeArray(t,"finalCapture",Ea.encoder.decode))}decodeArray(n,t,e){const r=[];for(let s=0;null!=n[t+s];s++)r.push(e(n[t+s]));return r}};class P7t extends xs{getMetrics(t){return t.gameState.sideRings}getListMoves(t){const e=[],r=t.gameState;if(r.isInitialPlacementPhase())for(const{coord:s,content:i}of r.getCoordsAndContents())i===bt.EMPTY&&e.push(new ac([],s,T.empty(),[]));else{const s=this.ruler;this.getPossibleCaptureCombinations(r).forEach(i=>{const o=s.applyCaptures(i,r);this.getRingMoves(o).forEach(c=>{const u=s.applyRingMoveAndFlip(c.start,c.end,o);this.getPossibleCaptureCombinations(u).forEach(d=>{const g=new ac(i,c.start,T.of(c.end),d);e.push(g)})})})}return e}getPossibleCaptureCombinations(t){const r=this.ruler.getPossibleCaptures(t),s=this.getRingCoords(t);return qm.getPossibleCaptureCombinationsFromPossibleCaptures(r).map(i=>class S7t{static getCombinations(t,e){return Pe(t.length>=e,"cannot compute combinations for less elements than needed"),this.getSubsetsOfSize(t,e).map(r=>this.getPermutations(r)).reduce((r,s)=>r.concat(s))}static getPermutations(t){const e=t.length,r=[t.slice()],s=new Array(e).fill(0);let i=1;for(;i<e;)if(s[i]<i){const o=i%2&&s[i],c=t[i];t[i]=t[o],t[o]=c,++s[i],i=1,r.push(t.slice())}else s[i]=0,++i;return r}static getSubsetsOfSize(t,e){return function r(s,i){if(i>=t.length||s<1)return[[]];{const o=[];for(;i<=t.length-s;){const c=t[i];for(const u of r(s-1,i+1))u.push(c),o.push(u);++i}return o}}(e,0)}}.getCombinations(s,i.length).map(o=>i.map((c,u)=>new Ea(c.capturedSpaces,o[u])))).reduce((i,o)=>i.concat(o),[])}getRingMoves(t){const e=this.ruler,r=[];for(const s of this.getRingCoords(t))for(const i of e.getRingTargets(t,s))r.push({start:s,end:i});return r}getRingCoords(t){const e=t.getCurrentPlayer().value,r=[];return t.forEachCoord((s,i)=>{i===bt.RINGS[e]&&r.push(s)}),r}}class r4e extends L1{applyLegalMove(t,e,r){return new oc(r.board,r.sideRings,r.turn+1)}applyCaptures(t,e){let r=e;return t.forEach(s=>{r=this.applyCapture(s,r)}),r}applyCapture(t,e){const r=this.applyCaptureWithoutTakingRing(e,t);return this.takeRing(new oc(r,e.sideRings,e.turn),t.ringTaken.get())}takeRing(t,e){const r=t.getCurrentPlayer().value,s=t.setAt(e,bt.EMPTY).board,i=[t.sideRings[0],t.sideRings[1]];return i[r]+=1,new oc(s,i,t.turn)}applyCaptureWithoutTakingRing(t,e){return e.forEach(r=>{t=t.setAt(r,bt.EMPTY)}),t.board}ringSelectionValidity(t,e){const r=t.getCurrentPlayer().value;return t.getPieceAt(e)===bt.RINGS[r]?R.SUCCESS:R.failure(Lr.CAPTURE_SHOULD_TAKE_RING())}applyRingMoveAndFlip(t,e,r){const s=r.getCurrentPlayer().value;let i=r.setAt(t,bt.MARKERS[s]);i=i.setAt(e,bt.RINGS[s]);const o=Re.factory.fromMove(t,e).get();for(let c=t.getNext(o);!1===c.equals(e);c=c.getNext(o)){const u=i.getPieceAt(c);u!==bt.EMPTY&&(i=i.setAt(c,u.flip()))}return i}isLegal(t,e){if(t.isInitialPlacement())return this.initialPlacementValidity(e,t.start);if(e.isInitialPlacementPhase())return _e.failure(Lr.NO_MARKERS_IN_INITIAL_PHASE());const r=this.capturesValidity(e,t.initialCaptures);if(r.isFailure())return r.toOtherFallible();const s=this.applyCaptures(t.initialCaptures,e),i=this.moveValidity(s,t.start,t.end.get());if(i.isFailure())return i.toOtherFallible();const o=this.applyRingMoveAndFlip(t.start,t.end.get(),s),c=this.capturesValidity(o,t.finalCaptures);if(c.isFailure())return c.toOtherFallible();const u=this.applyCaptures(t.finalCaptures,o),d=this.noMoreCapturesValidity(u);return d.isFailure()?d.toOtherFallible():_e.success(u)}initialPlacementValidity(t,e){if(!0!==t.isInitialPlacementPhase())return _e.failure(Lr.PLACEMENT_AFTER_INITIAL_PHASE());if(t.getPieceAt(e)!==bt.EMPTY)return _e.failure(et.MUST_CLICK_ON_EMPTY_SPACE());const r=t.getCurrentPlayer(),s=[t.sideRings[0],t.sideRings[1]];s[r.value]-=1;const i=t.setAt(e,bt.of(r,!0)).board,o=new oc(i,s,t.turn);return _e.success(o)}moveStartValidity(t,e){const r=t.getCurrentPlayer().value;return t.getPieceAt(e)!==bt.RINGS[r]?R.failure(Lr.SHOULD_SELECT_PLAYER_RING()):R.SUCCESS}moveValidity(t,e,r){const s=this.moveStartValidity(t,e);if(s.isFailure())return s;if(t.getPieceAt(r)!==bt.EMPTY)return R.failure(Lr.SHOULD_END_MOVE_ON_EMPTY_SPACE());const i=Re.factory.fromMove(e,r);if(i.isFailure())return R.failure(Lr.MOVE_DIRECTION_INVALID());const o=i.get();let c=!1;for(let u=e.getNext(o);!1===u.equals(r);u=u.getNext(o)){const d=t.getPieceAt(u);if(d===bt.EMPTY){if(c)return R.failure(Lr.MOVE_SHOULD_END_AT_FIRST_EMPTY_SPACE_AFTER_MARKERS())}else{if(d.isRing)return R.failure(Lr.MOVE_SHOULD_NOT_PASS_ABOVE_RING());c=!0}}return R.SUCCESS}capturesValidity(t,e){let r=t;for(const s of e){const i=this.captureValidity(r,s);if(i.isFailure())return i;r=this.applyCapture(s,r)}return R.SUCCESS}captureValidity(t,e){const r=t.getCurrentPlayer().value;for(const s of e.capturedSpaces)if(t.getPieceAt(s)!==bt.MARKERS[r])return R.failure(Lr.CAN_ONLY_CAPTURE_YOUR_MARKERS());return t.getPieceAt(e.ringTaken.get())!==bt.RINGS[r]?R.failure(Lr.CAPTURE_SHOULD_TAKE_RING()):R.SUCCESS}noMoreCapturesValidity(t){const e=t.getCurrentPlayer();return 0===this.getLinePortionsWithAtLeastFivePiecesOfPlayer(t,e).length?R.SUCCESS:R.failure(Lr.MISSING_CAPTURES())}getLinePortionsWithAtLeastFivePiecesOfPlayer(t,e){const r=[];return t.allLines().forEach(s=>{const i=this.getLinePortionWithAtLeastFivePiecesOfPlayer(t,e,s);i.isPresent()&&r.push(i.get())}),r}getLinePortionWithAtLeastFivePiecesOfPlayer(t,e,r){let s=0;const i=t.getEntranceOnLine(r),o=r.getDirection();let u,c=i;for(u=i;t.isOnBoard(u);u=u.getNext(o)){const d=t.getPieceAt(u);if(d.player===e&&!1===d.isRing)0===s&&(c=u),s+=1;else{if(s>=5)break;s=0}}return s>=5?T.of({start:c,end:u,dir:o}):T.empty()}getPossibleCaptures(t){const e=t.getCurrentPlayer(),r=[];return this.getLinePortionsWithAtLeastFivePiecesOfPlayer(t,e).forEach(s=>{for(let i=s.start;i.getDistance(s.end)>=5;i=i.getNext(s.dir))r.push(Ea.of(i,i.getNext(s.dir,4)))}),r}getRingTargets(t,e){const r=[];for(const s of Re.factory.all){let i=!1;for(let o=e.getNext(s);t.isOnBoard(o);o=o.getNext(s)){const c=t.getPieceAt(o);if(c===bt.EMPTY){if(r.push(o),i)break}else{if(c.isRing)break;i=!0}}}return r}getGameStatus(t){return t.gameState.isInitialPlacementPhase()?xe.ONGOING:t.gameState.sideRings[0]>=3?xe.ZERO_WON:t.gameState.sideRings[1]>=3?xe.ONE_WON:xe.ONGOING}}const q=bt.EMPTY,we=bt.UNREACHABLE,Yi=bt.MARKER_ZERO,ao=bt.RING_ZERO,K4=bt.MARKER_ONE,Si=bt.RING_ONE;let s4e=(()=>{class n{}return n.MUST_ALIGN_FIVE=()=>$localize`Failed! You need to align 5 markers of your color in order to get them, and to get a ring at the same time.`,n.MUST_CAPTURE_TWO=()=>$localize`Failed! You can capture two rings in total, by capturing two times 5 of your markers. Try again.`,n})();class i4e extends $1{constructor(){super(...arguments),this.tutorial=[ie.informational($localize`Goal of the game`,$localize`The goal at Yinsh is to capture three rings in total.
        The rings taken are shown on the top left for the dark player,
        and on the bottom right for the light player. Here, Dark won the game.
        Note that on the board you have two types of pieces for each player:
        rings (empty circles) and markers (full circles).`,new oc([[we,we,we,we,we,we,q,q,q,q,we],[we,we,we,we,q,q,q,q,q,q,q],[we,we,we,Yi,Si,q,q,q,q,q,q],[we,we,q,Yi,q,Si,q,K4,q,q,q],[we,q,ao,K4,q,q,Si,Yi,q,q,q],[we,q,q,Yi,K4,q,q,q,q,q,we],[q,q,q,Yi,q,q,q,Si,q,q,we],[q,q,q,K4,Yi,ao,q,q,q,we,we],[q,q,q,q,q,q,q,q,we,we,we],[q,q,q,q,q,q,q,we,we,we,we],[we,q,q,q,q,we,we,we,we,we,we]],[3,1],20)),ie.anyMove($localize`Initial board and placement phase`,$localize`The initial board is empty.
        At the beginning of the game, each player puts one of its ring on the board at their turn.
        This phase stops when all rings have been placed on the board.<br/><br/>
        You're playing Dark, put one of your ring on the board by clicking the space where you want to place it.`,new oc(oc.getInitialState().board,[5,5],0),new ac([],new S(5,5),T.empty(),[]),$localize`Congratulations!`),ie.anyMove($localize`Putting a marker`,$localize`Once the initial phase is done and all rings are on the board, you need to place markers on the board.
        To do so, put a marker in a ring by clicking on that ring.
        Then, the ring must be moved in a straight line, in any direction.
        A ring cannot pass through other rings during its move.
        If it goes over a group of markers, your move must stop at the first empty space after that group.
        All markers in the group are then flipped and their color change.<br/><br/>
        You're playing Dark, do a move.`,new oc([[we,we,we,we,we,we,q,q,q,q,we],[we,we,we,we,q,q,q,q,q,q,q],[we,we,we,Si,q,q,q,q,q,q,q],[we,we,Si,q,q,Si,q,q,q,q,q],[we,q,ao,K4,q,q,Si,q,q,q,q],[we,q,q,K4,q,q,q,q,q,q,we],[q,q,q,q,ao,q,q,Si,q,q,we],[q,q,q,q,q,ao,q,q,q,we,we],[q,q,q,ao,q,q,q,we,we,we,we],[q,q,q,q,q,q,q,we,we,we,we],[we,q,q,q,q,we,we,we,we,we,we]],[0,0],20),new ac([],new S(2,4),T.of(new S(4,4)),[]),$localize`Congratulations!`),ie.fromPredicate($localize`Getting a ring by aligning 5 markers`,$localize`Finally, the last mechanic you need is to be able to get a ring from the board in order to gain points.
        To do so, you need to align 5 markers of your color.
        You can then get these markers by clicking on them, and then get one of your ring by clicking on it.
        You will then have one more point.
        You must capture when you can.<br/><br/>
        You're playing Dark, perform a capture!`,new oc([[we,we,we,we,we,we,q,q,q,q,we],[we,we,we,we,q,q,q,q,q,q,q],[we,we,we,Si,q,q,q,q,q,q,q],[we,we,Si,q,q,Si,q,q,q,q,q],[we,q,Yi,Yi,ao,K4,K4,q,q,q,q],[we,q,q,Si,q,q,q,q,q,q,we],[q,q,q,q,ao,q,q,Si,q,q,we],[q,q,q,q,q,ao,q,q,q,we,we],[q,q,q,ao,q,q,q,ao,we,we,we],[q,q,q,q,q,q,q,we,we,we,we],[we,q,q,q,q,we,we,we,we,we,we]],[0,0],20),new ac([],new S(4,4),T.of(new S(7,4)),[Ea.of(new S(2,4),new S(6,4),new S(7,4))]),(t,e,r)=>1===r.sideRings[B.ZERO.value]?R.SUCCESS:R.failure(s4e.MUST_ALIGN_FIVE()),$localize`Congratulations!`),ie.fromPredicate($localize`Compound captures`,$localize`During a turn, you could have to choose between multiple captures,
        or you could even capture multiple times!
        During the capture selection, if you see that the marker you clicked belongs to two captures, you have to click on a second marker to avoid any ambiguity.<br/><br/>
        Here, playing Dark, you can capture two rings, do it!`,new oc([[we,we,we,we,we,we,q,q,q,q,we],[we,we,we,we,ao,q,q,Si,Si,ao,q],[we,we,we,ao,q,q,K4,Si,q,ao,q],[we,we,q,ao,q,q,q,q,q,Si,q],[we,q,q,q,q,Yi,q,q,Si,q,q],[we,q,q,q,Yi,Yi,q,K4,q,q,we],[q,q,q,Yi,q,Yi,q,q,q,q,we],[q,q,Yi,q,q,Yi,q,q,q,we,we],[q,Yi,q,q,q,Yi,q,q,we,we,we],[q,q,q,q,q,Yi,q,we,we,we,we],[we,q,q,q,q,we,we,we,we,we,we]],[0,0],10),new ac([Ea.of(new S(5,4),new S(1,8),new S(3,2)),Ea.of(new S(5,9),new S(5,5),new S(3,3))],new S(4,1),T.of(new S(4,2)),[]),(t,e,r)=>2===r.sideRings[B.ZERO.value]?R.SUCCESS:R.failure(s4e.MUST_CAPTURE_TWO()),$localize`Congratulations!`)]}}function T7t(n,t){if(1&n&&(F(),X(0,"circle",12)),2&n){const e=C(2).$implicit,r=C(2);z("cx",e.center.x)("cy",e.center.y)("r",r.viewInfo.ringOuterSize)}}function w7t(n,t){if(1&n&&(F(),X(0,"circle",13)),2&n){const e=C(2),r=e.index,s=e.$implicit,i=C().index,o=C();De("id","ring_",r,"_",i,""),w("ngClass",s.ringClasses),z("cx",s.center.x)("cy",s.center.y)("r",o.viewInfo.ringMidSize)}}function b7t(n,t){if(1&n&&(F(),X(0,"circle",12)),2&n){const e=C(2).$implicit,r=C(2);z("cx",e.center.x)("cy",e.center.y)("r",r.viewInfo.ringInnerSize)}}function O7t(n,t){if(1&n&&(F(),X(0,"circle",14)),2&n){const e=C(2),r=e.index,s=e.$implicit,i=C().index,o=C();De("id","marker_",r,"_",i,""),w("ngClass",s.markerClasses),z("cx",s.center.x)("cy",s.center.y)("r",o.viewInfo.markerSize)}}function A7t(n,t){if(1&n){const e=Oe();F(),O(0,"g",6),ee("click",function(){ue(e);const s=C().$implicit;return ce(C(2).onClick(s.coord))}),X(1,"polygon",7),O(2,"g",8),x(3,T7t,1,3,"circle",9),x(4,w7t,1,6,"circle",10),x(5,b7t,1,3,"circle",9),x(6,O7t,1,6,"circle",11),A()()}if(2&n){const e=C(),r=e.index,s=e.$implicit,i=C().index;De("id","click_",r,"_",i,""),P(1),De("id","space_",r,"_",i,""),w("ngClass",s.spaceClasses),z("points",s.coordinates),P(1),De("id","pieceGroup_",r,"_",i,""),w("ngClass",s.removedClass),P(1),w("ngIf",s.isRing),P(1),w("ngIf",s.isRing),P(1),w("ngIf",s.isRing),P(1),w("ngIf",s.isMarker)}}function N7t(n,t){if(1&n&&(F(),O(0,"g"),x(1,A7t,7,13,"g",5),A()),2&n){const e=t.$implicit;P(1),w("ngIf",null!=e)}}function I7t(n,t){if(1&n&&(F(),O(0,"g"),x(1,N7t,2,1,"g",1),A()),2&n){const e=t.$implicit;P(1),w("ngForOf",e)}}function x7t(n,t){if(1&n){const e=Oe();F(),O(0,"polygon",15),ee("click",function(){const i=ue(e).$implicit;return ce(C().onClick(i))}),A()}if(2&n){const e=t.$implicit,r=C();De("id","selected_",e.x,"_",e.y,""),z("points",r.viewInfo.spaceInfo[e.y][e.x].coordinates)}}function k7t(n,t){if(1&n){const e=Oe();F(),O(0,"polygon",17),ee("click",function(){const i=ue(e).$implicit;return ce(C(2).onClick(i))}),A()}if(2&n){const e=t.$implicit,r=C(2);De("id","selectable_",e.x,"_",e.y,""),z("points",r.viewInfo.spaceInfo[e.y][e.x].coordinates)}}function L7t(n,t){if(1&n&&(F(),O(0,"g"),x(1,k7t,1,3,"polygon",16),A()),2&n){const e=C();P(1),w("ngForOf",e.viewInfo.selectableCoords)}}function R7t(n,t){if(1&n){const e=Oe();F(),O(0,"rect",18),ee("click",function(){const i=ue(e).$implicit;return ce(C().onClick(i))}),A()}if(2&n){const e=t.$implicit,r=C();De("id","indicator_",e.x,"_",e.y,""),z("x",r.viewInfo.spaceInfo[e.y][e.x].center.x-r.viewInfo.indicatorSize/2)("y",r.viewInfo.spaceInfo[e.y][e.x].center.y-r.viewInfo.indicatorSize/2)("width",r.viewInfo.indicatorSize)("height",r.viewInfo.indicatorSize)}}function D7t(n,t){if(1&n&&(F(),O(0,"g"),X(1,"circle",19)(2,"circle",12)(3,"circle",20),A()),2&n){const e=t.index,r=C().$implicit,s=C();P(1),De("id","player_",r.value,"_sideRing_",e+1,""),z("cx",(0===r.value?15:1050)+1.2*(0===r.value?1:-1)*s.viewInfo.ringOuterSize*(e+1))("cy",0===r.value?300:1260)("r",s.viewInfo.ringOuterSize),P(1),z("cx",(0===r.value?15:1050)+1.2*(0===r.value?1:-1)*s.viewInfo.ringOuterSize*(e+1))("cy",0===r.value?300:1260)("r",s.viewInfo.ringInnerSize),P(1),w("ngClass",s.viewInfo.sideRingClass[r.value]),z("cx",(0===r.value?15:1050)+1.2*(0===r.value?1:-1)*s.viewInfo.ringOuterSize*(e+1))("cy",0===r.value?300:1260)("r",s.viewInfo.ringMidSize)}}const z7t=function(){return[]};function V7t(n,t){if(1&n&&(F(),O(0,"g"),x(1,D7t,4,12,"g",1),A()),2&n){const e=t.$implicit,r=C();z("transform","rotate("+180*(r.role.value+1)+" 532.5 780)"),P(1),w("ngForOf",J1(2,z7t).constructor(r.viewInfo.sideRings[e.value]))}}class Pi extends Td{constructor(t){super(t),this.movePhase="MOVE_START",this.moveStart=T.empty(),this.moveEnd=T.empty(),this.currentlyMoved=[],this.currentCapture=T.empty(),this.initialCaptures=[],this.finalCaptures=[],this.possibleCaptures=[],this.viewInfo={spaceInfo:[],selectableCoords:[],selectedCoords:[],targets:[],markerSize:Pi.MARKER_SIZE,ringOuterSize:Pi.RING_OUTER_SIZE,ringMidSize:Pi.RING_MID_SIZE,ringInnerSize:Pi.RING_INNER_SIZE,indicatorSize:Pi.INDICATOR_SIZE,sideRings:[5,5],sideRingClass:["player0-stroke","player1-stroke"]},this.scores=T.of([0,0]),this.rules=new r4e(oc),this.availableMinimaxes=[new P7t(this.rules,"YinshMinimax")],this.encoder=ac.encoder,this.tutorial=(new i4e).tutorial,this.hexaLayout=new wd(1.5*Pi.RING_OUTER_SIZE,new S(2*Pi.RING_OUTER_SIZE,0),Is.INSTANCE),this.constructedState=this.getState(),this.constructedState.allCoords().forEach(e=>{null==this.viewInfo.spaceInfo[e.y]&&(this.viewInfo.spaceInfo[e.y]=[]),this.viewInfo.spaceInfo[e.y][e.x]={coord:e,coordinates:this.getHexaPointsAt(e),center:this.getCenterAt(e),spaceClasses:[],markerClasses:[],ringClasses:[],isMarker:!1,isRing:!1,removedClass:""}})}updateBoard(){this.cancelMoveAttempt();const t=this.getState();this.scores=T.of(t.countScores())}updateViewInfo(){this.constructedState.allCoords().forEach(t=>{this.viewInfo.spaceInfo[t.y][t.x].spaceClasses=this.getSpaceClasses(t);const e=this.constructedState.getPieceAt(t);this.viewInfo.spaceInfo[t.y][t.x].removedClass="",this.setRingInfo(t,e),this.setMarkerInfo(t,e)});for(const t of B.PLAYERS)this.viewInfo.sideRings[t.value]=this.constructedState.sideRings[t.value];switch(this.showCurrentMoveCaptures(),this.viewInfo.targets=[],this.viewInfo.selectableCoords=[],this.movePhase){case"INITIAL_CAPTURE_SELECT_FIRST":case"INITIAL_CAPTURE_SELECT_LAST":case"FINAL_CAPTURE_SELECT_FIRST":case"FINAL_CAPTURE_SELECT_LAST":this.viewInfo.selectableCoords=[];for(const t of this.possibleCaptures)for(const e of t.capturedSpaces)this.viewInfo.selectableCoords.push(e);break;case"INITIAL_CAPTURE_SELECT_RING":case"FINAL_CAPTURE_SELECT_RING":this.viewInfo.selectableCoords=this.constructedState.getRingCoords(this.constructedState.getCurrentPlayer());break;case"MOVE_START":!1===this.getState().isInitialPlacementPhase()&&(this.viewInfo.selectableCoords=this.constructedState.getRingCoords(this.constructedState.getCurrentPlayer()));break;case"MOVE_END":this.viewInfo.targets=this.rules.getRingTargets(this.constructedState,this.moveStart.get())}}showCurrentMoveCaptures(){this.currentCapture.isPresent()&&this.markCurrentCapture(this.currentCapture.get());for(const t of this.initialCaptures)this.markCurrentCapture(t);for(const t of this.finalCaptures)this.markCurrentCapture(t)}getSpaceClasses(t){return this.currentlyMoved.some(e=>e.equals(t))?["moved-fill"]:[]}setRingInfo(t,e){e.isRing?(this.viewInfo.spaceInfo[t.y][t.x].isRing=!0,this.viewInfo.spaceInfo[t.y][t.x].ringClasses=["player"+e.player.value+"-stroke"]):(this.viewInfo.spaceInfo[t.y][t.x].isRing=!1,this.viewInfo.spaceInfo[t.y][t.x].ringClasses=[])}setMarkerInfo(t,e){if(this.viewInfo.spaceInfo[t.y][t.x].isMarker=!1,this.viewInfo.spaceInfo[t.y][t.x].markerClasses=[],e!==bt.EMPTY&&(!e.isRing||this.moveStart.equalsValue(t))){const s=this.getPlayerClass(e.player);this.viewInfo.spaceInfo[t.y][t.x].isMarker=!0,this.viewInfo.spaceInfo[t.y][t.x].markerClasses=[s]}}cancelMoveAttempt(){this.constructedState=this.getState(),this.possibleCaptures=[],this.initialCaptures=[],this.finalCaptures=[],this.viewInfo.selectedCoords=[],this.currentCapture=T.empty(),this.moveStart=T.empty(),this.moveEnd=T.empty(),this.currentlyMoved=[],this.moveToInitialCaptureOrMovePhase()}showLastMove(t){if(t.isInitialPlacement())this.viewInfo.spaceInfo[t.start.y][t.start.x].spaceClasses=["moved-fill"];else{for(const r of this.coordsBetween(t.start,t.end.get()))this.viewInfo.spaceInfo[r.y][r.x].spaceClasses=["moved-fill"];const e=this.currentCapture.isAbsent()&&0===this.initialCaptures.length&&this.moveStart.isAbsent();t.initialCaptures.forEach(r=>this.showLastMoveCapture(r,e)),t.finalCaptures.forEach(r=>this.showLastMoveCapture(r,e))}}coordsBetween(t,e){const r=[],s=Re.factory.fromMove(t,e).get();for(let i=t;!i.equals(e);i=i.getNext(s))this.constructedState.getPieceAt(i)!==bt.EMPTY&&r.push(i),r.push(e);return r}showLastMoveCapture(t,e){for(const r of t.capturedSpaces)this.viewInfo.spaceInfo[r.y][r.x].spaceClasses=["captured-fill"],e&&this.markRemovedMarker(r,this.getState().getCurrentPlayer().getOpponent());this.viewInfo.spaceInfo[t.ringTaken.get().y][t.ringTaken.get().x].spaceClasses=["captured-fill"],e&&this.markRemovedRing(t.ringTaken.get(),this.getState().getCurrentPlayer().getOpponent())}moveToInitialCaptureOrMovePhase(){return this.possibleCaptures=this.rules.getPossibleCaptures(this.constructedState),this.movePhase=0===this.possibleCaptures.length?"MOVE_START":"INITIAL_CAPTURE_SELECT_FIRST",this.updateViewInfo(),R.SUCCESS}onClick(t){var e=this;return I(function*(){const r=e.canUserPlay("#click_"+t.x+"_"+t.y);if(r.isFailure())return e.cancelMove(r.getReason());switch(e.movePhase){case"INITIAL_CAPTURE_SELECT_FIRST":case"FINAL_CAPTURE_SELECT_FIRST":return e.selectCaptureFirstCoord(t);case"INITIAL_CAPTURE_SELECT_LAST":case"FINAL_CAPTURE_SELECT_LAST":return e.selectCaptureLastCoord(t);case"INITIAL_CAPTURE_SELECT_RING":case"FINAL_CAPTURE_SELECT_RING":return e.selectRing(t);case"MOVE_START":return e.selectMoveStart(t);case"MOVE_END":return e.selectMoveEnd(t)}})()}selectCaptureFirstCoord(t){var e=this;return I(function*(){const r=[];if(e.possibleCaptures.forEach(s=>{s.contains(t)&&r.push(s)}),r.length>1)e.viewInfo.selectedCoords.push(t),e.moveToCaptureSelectLast(r);else{if(0===r.length)return e.cancelMove(Lr.MISSING_CAPTURES());e.selectCapture(r[0])}return R.SUCCESS})()}moveToCaptureSelectLast(t){this.viewInfo.selectableCoords=[],this.possibleCaptures=t;for(const e of t)for(const r of e.capturedSpaces)this.viewInfo.selectableCoords.push(r);"INITIAL_CAPTURE_SELECT_FIRST"===this.movePhase?this.movePhase="INITIAL_CAPTURE_SELECT_LAST":(Me.expectToBe(this.movePhase,"FINAL_CAPTURE_SELECT_FIRST","moveToCaptureSelectLast did not expect to be called in movePhase"+this.movePhase),this.movePhase="FINAL_CAPTURE_SELECT_LAST")}selectCaptureLastCoord(t){var e=this;return I(function*(){const r=[];return e.possibleCaptures.forEach(s=>{s.contains(t)&&r.push(s)}),r.length>1?e.cancelMove(Lr.AMBIGUOUS_CAPTURE_COORD()):0===r.length?e.cancelMove(Lr.MISSING_CAPTURES()):e.selectCapture(r[0])})()}selectCapture(t){return this.currentCapture=T.of(t),this.constructedState=new oc(this.rules.applyCaptureWithoutTakingRing(this.constructedState,t),this.constructedState.sideRings,this.constructedState.turn),"INITIAL_CAPTURE_SELECT_FIRST"===this.movePhase||"INITIAL_CAPTURE_SELECT_LAST"===this.movePhase?this.movePhase="INITIAL_CAPTURE_SELECT_RING":(Pe("FINAL_CAPTURE_SELECT_FIRST"===this.movePhase||"FINAL_CAPTURE_SELECT_LAST"===this.movePhase,"selectCapture did not expect to be called in movePhase "+this.movePhase),this.movePhase="FINAL_CAPTURE_SELECT_RING"),this.updateViewInfo(),R.SUCCESS}markCurrentCapture(t){for(const e of t.capturedSpaces)this.viewInfo.selectedCoords.push(e),this.markRemovedMarker(e,this.getState().getCurrentPlayer());t.ringTaken.isPresent()&&(this.viewInfo.selectedCoords.push(t.ringTaken.get()),this.markRemovedRing(t.ringTaken.get(),this.getState().getCurrentPlayer()))}markRemovedMarker(t,e){this.viewInfo.spaceInfo[t.y][t.x].removedClass="semi-transparent",this.setMarkerInfo(t,bt.MARKERS[e.value])}markRemovedRing(t,e){this.viewInfo.spaceInfo[t.y][t.x].removedClass="semi-transparent",this.setRingInfo(t,bt.RINGS[e.value])}selectRing(t){var e=this;return I(function*(){const r=e.rules.ringSelectionValidity(e.constructedState,t);if(r.isFailure())return e.cancelMove(r.getReason());e.constructedState=e.rules.takeRing(e.constructedState,t);const s=e.currentCapture.get().setRingTaken(t);return"INITIAL_CAPTURE_SELECT_RING"===(e.currentCapture=T.empty(),e.possibleCaptures=e.rules.getPossibleCaptures(e.constructedState),e.movePhase)?(e.initialCaptures.push(s),0===e.possibleCaptures.length?e.moveToMovePhase():(e.movePhase="INITIAL_CAPTURE_SELECT_FIRST",e.updateViewInfo(),R.SUCCESS)):(Me.expectToBe(e.movePhase,"FINAL_CAPTURE_SELECT_RING"),e.finalCaptures.push(s),0===e.possibleCaptures.length?e.tryMove():(e.movePhase="FINAL_CAPTURE_SELECT_FIRST",e.updateViewInfo(),R.SUCCESS))})()}moveToMovePhase(){return this.movePhase="MOVE_START",this.updateViewInfo(),R.SUCCESS}tryMove(){var t=this;return I(function*(){const e=new ac(t.initialCaptures,t.moveStart.get(),t.moveEnd,t.finalCaptures);return yield t.chooseMove(e,t.getState(),t.scores.get())})()}selectMoveStart(t){var e=this;return I(function*(){if(e.constructedState.isInitialPlacementPhase()){const r=e.rules.initialPlacementValidity(e.constructedState,t);return r.isFailure()?e.cancelMove(r.getReason()):(e.moveStart=T.of(t),e.tryMove())}{const r=e.rules.moveStartValidity(e.constructedState,t);if(r.isFailure())return e.cancelMove(r.getReason());e.moveStart=T.of(t),e.movePhase="MOVE_END",e.updateViewInfo()}return R.SUCCESS})()}selectMoveEnd(t){var e=this;return I(function*(){if(e.moveStart.equalsValue(t))return e.cancelMoveAttempt(),R.SUCCESS;const r=bt.RINGS[e.getState().getCurrentPlayer().value];if(e.constructedState.getPieceAt(t)===r)return e.cancelMoveAttempt(),e.selectMoveStart(t);const s=e.rules.moveValidity(e.constructedState,e.moveStart.get(),t);return s.isFailure()?e.cancelMove(s.getReason()):(e.moveEnd=T.of(t),e.currentlyMoved=e.coordsBetween(e.moveStart.get(),t),e.constructedState=e.rules.applyRingMoveAndFlip(e.moveStart.get(),t,e.constructedState),e.updateViewInfo(),e.moveToFinalCapturePhaseOrTryMove())})()}moveToFinalCapturePhaseOrTryMove(){var t=this;return I(function*(){return t.possibleCaptures=t.rules.getPossibleCaptures(t.constructedState),0===t.possibleCaptures.length?t.tryMove():(t.movePhase="FINAL_CAPTURE_SELECT_FIRST",t.updateViewInfo(),R.SUCCESS)})()}}function H7t(n,t){if(1&n&&(O(0,"option",5),Tt(1),A()),2&n){const e=t.$implicit;w("value",e.urlName),P(1),c1(e.name)}}Pi.RING_OUTER_SIZE=40,Pi.RING_MID_SIZE=34,Pi.RING_INNER_SIZE=28,Pi.MARKER_SIZE=Pi.RING_INNER_SIZE,Pi.INDICATOR_SIZE=10,Pi.\u0275fac=function(t){return new(t||Pi)(J(En))},Pi.\u0275cmp=dt({type:Pi,selectors:[["app-yinsh"]],features:[l],decls:6,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","0 250 1065 1060","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base no-fill selected-stroke","pointer-events","fill","stroke-linecap","round",3,"id","click",4,"ngFor","ngForOf"],[4,"ngIf"],["class","indicator",3,"id","click",4,"ngFor","ngForOf"],[3,"id","click",4,"ngIf"],[3,"id","click"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[3,"id","ngClass"],["class","base no-fill mid-stroke",4,"ngIf"],["class","base no-fill",3,"id","ngClass",4,"ngIf"],["class","base mid-stroke",3,"id","ngClass",4,"ngIf"],[1,"base","no-fill","mid-stroke"],[1,"base","no-fill",3,"id","ngClass"],[1,"base","mid-stroke",3,"id","ngClass"],["pointer-events","fill","stroke-linecap","round",1,"base","no-fill","selected-stroke",3,"id","click"],["class","base no-fill capturable-stroke","pointer-events","fill","stroke-linecap","round",3,"id","click",4,"ngFor","ngForOf"],["pointer-events","fill","stroke-linecap","round",1,"base","no-fill","capturable-stroke",3,"id","click"],[1,"indicator",3,"id","click"],[1,"base","no-fill","mid-stroke",3,"id"],[1,"base","no-fill",3,"ngClass"]],template:function(t,e){1&t&&(F(),O(0,"svg",0),x(1,I7t,2,1,"g",1),x(2,x7t,1,3,"polygon",2),x(3,L7t,2,1,"g",3),x(4,R7t,1,6,"rect",4),x(5,V7t,2,3,"g",1),A()),2&t&&(P(1),w("ngForOf",e.viewInfo.spaceInfo),P(1),w("ngForOf",e.viewInfo.selectedCoords),P(1),w("ngIf",e.isPlayerTurn()),P(1),w("ngForOf",e.viewInfo.targets),P(1),w("ngForOf",e.Player.PLAYERS))},dependencies:[fn,On,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});let E1=(()=>{class n{}return n.ABALONE=()=>$localize`Use simple mechanics to push 6 of the opponent's pieces out of the board!`,n.APAGOS=()=>$localize`Very simple game, but, will you be able to win everytime?`,n.AWALE=()=>$localize`The international version of the famous African strategy game!`,n.BRANDHUB=()=>$localize`The Irish version of the Tafl game family! Invaders must capture the king, defender must make him escape!`,n.COERCEO=()=>$localize`Get rid of all of your opponent's pieces on a board that shrinks little by little!`,n.CONNECT_SIX=()=>$localize`Put two pieces on the board at each turn, and be the first to align six pieces!`,n.CONSPIRATEURS=()=>$localize`Hide all of your pieces before your opponent does, or risk to be discovered!`,n.DIAM=()=>$localize`Drop your pieces and move them around to align two pieces of the same color across the board to win!`,n.DVONN=()=>$localize`Stack your pieces and control as many stacks as you can to win!`,n.ENCAPSULE=()=>$localize`An enhanced tic-tac-toe where piece can encapsule other and prevent them to win.`,n.EPAMINONDAS=()=>$localize`An antiquity-war inspired game. Be the first to pierce your opponent's lines!`,n.GIPF=()=>$localize`A hexagonal game of alignment. Insert your pieces on the board to capture your opponent's pieces!`,n.GO=()=>$localize`The oldest strategy game still practiced widely. A territory control game.`,n.HIVE=()=>$localize`You are in charge of a hive full of insects. Use the abilities of your insects to block the opponent's queen in order to win!`,n.HNEFATAFL=()=>$localize`The Viking board game! Invaders must capture the king, defender must make him escape!`,n.KAMISADO=()=>$localize`Your goal is simple: reach the last line. But the piece you move depends on your opponent's last move!`,n.LASCA=()=>$localize`Similar to checkers, capture opponent's pieces, free your own, and immobilize your opponent to win the game!`,n.LINES_OF_ACTION=()=>$localize`Regroup your pieces to win. But your possible moves will often change!`,n.LODESTONE=()=>$localize`Push and crush your opponent's pieces using magnetic forces!`,n.MARTIAN_CHESS=()=>$localize`Win points by capturing pieces, but you only control pieces on your side of the board!`,n.P4=()=>$localize`The classical 4 in a row game!`,n.PENTAGO=()=>$localize`Drop a piece, then rotate a quadrant. The first player to align 5 pieces wins!`,n.PENTE=()=>$localize`You can align 5 pieces to win, or you can capture 10 pieces of your opponent to win!`,n.PYLOS=()=>$localize`Overlay your pieces and use two game mechanics to conserve your pieces. First player to run out of pieces loses!`,n.QUARTO=()=>$localize`Create a winning alignment. The problem: you don't pick the piece that you're placing on the board!`,n.QUIXO=()=>$localize`Align 5 of your pieces on a board where pieces slide!`,n.REVERSI=()=>$localize`Sandwich your opponent's pieces to dominate the board!`,n.SAHARA=()=>$localize`Immobilize one of your opponent's pyramids before your opponent does!`,n.SIAM=()=>$localize`Be the first to push a mountain out of the board!`,n.SIX=()=>$localize`Put your hexagonal pieces next to another one, and create one of the 3 victorious shapes to win!`,n.TABLUT=()=>$localize`Lapland version of the Tafl game family! Invaders must capture the king, defender must make him escape!`,n.TREXO=()=>$localize`Align 5 pieces of your color in a row, but beware, the pieces can be put on top of other pieces!`,n.YINSH=()=>$localize`Align your pieces to score points, but beware, pieces can flip!`,n})(),$d=(()=>{class n{constructor(e,r,s,i,o,c,u,d=!0){this.name=e,this.urlName=r,this.component=s,this.tutorial=i,this.rules=o,this.creationDate=c,this.description=u,this.display=d}}return n.ALL_GAMES=()=>[new n($localize`Four in a Row`,"P4",N8t,new N3e,new Wr(C6),new Date("2018-08-28"),E1.P4()),new n($localize`Awal`,"Awale",M4t,new jce,new f6(to),new Date("2018-11-29"),E1.AWALE()),new n($localize`Quarto`,"Quarto",Hut,new $3e,new ti(Zc),new Date("2018-12-09"),E1.QUARTO()),new n($localize`Tablut`,"Tablut",J5t,new Q3e,L5.get(),new Date("2018-12-27"),E1.TABLUT()),new n($localize`Reversi`,"Reversi",Xut,new W3e,new tT(qr),new Date("2019-01-16"),E1.REVERSI()),new n($localize`Go`,"Go",k6t,new h3e,new g6(ns),new Date("2019-12-21"),E1.GO()),new n($localize`Encapsule`,"Encapsule",e6t,new l3e,new z3(p6),new Date("2019-12-30"),E1.ENCAPSULE()),new n($localize`Siam`,"Siam",O5t,new K3e,vr.get(),new Date("2020-01-11"),E1.SIAM()),new n($localize`Sahara`,"Sahara",u5t,new q3e,new i_($o),new Date("2020-02-29"),E1.SAHARA()),new n($localize`Pylos`,"Pylos",cut,new V3e,new _a(jc),new Date("2020-10-02"),E1.PYLOS()),new n($localize`Kamisado`,"Kamisado",T0t,new y3e,new ma(F3),new Date("2020-10-03"),E1.KAMISADO()),new n($localize`Quixo`,"Quixo",qut,new U3e,new sc(_8),new Date("2020-10-15"),E1.QUIXO()),new n($localize`Dvonn`,"Dvonn",$lt,new i3e,new I2(Xa),new Date("2020-10-21"),E1.DVONN()),new n($localize`Epaminondas`,"Epaminondas",a6t,new u3e,new h8(V3),new Date("2021-01-16"),E1.EPAMINONDAS()),new n($localize`Gipf`,"Gipf",m6t,new d3e,new Gn(Ja),new Date("2021-02-22"),E1.GIPF()),new n($localize`Coerceo`,"Coerceo",ult,new r3e,new t3e(b1),new Date("2021-03-21"),E1.COERCEO()),new n($localize`Six`,"Six",F5t,new X3e,new j3(ji),new Date("2021-04-08"),E1.SIX()),new n($localize`Lines of Action`,"LinesOfAction",F0t,new P3e,new ro(ei),new Date("2021-04-28"),E1.LINES_OF_ACTION()),new n($localize`Pentago`,"Pentago",F8t,new x3e,new G4(z2),new Date("2021-05-23"),E1.PENTAGO()),new n($localize`Abalone`,"Abalone",l4t,new qce,new z4(u6),new Date("2021-07-13"),E1.ABALONE()),new n($localize`Yinsh`,"Yinsh",Pi,new i4e,new r4e(oc),new Date("2021-07-31"),E1.YINSH()),new n($localize`Apagos`,"Apagos",_4t,new Uce,l6.get(),new Date("2021-11-04"),E1.APAGOS()),new n($localize`Diam`,"Diam",D3,new Jce,V4.get(),new Date("2021-11-30"),E1.DIAM()),new n($localize`Brandhub`,"Brandhub",D4t,new Yce,b5.get(),new Date("2021-12-07"),E1.BRANDHUB()),new n($localize`Conspirateurs`,"Conspirateurs",ylt,new Xce,Ya.get(),new Date("2021-12-30"),E1.CONSPIRATEURS()),new n($localize`Lodestone`,"Lodestone",R2,new T3e,L2.get(),new Date("2022-06-24"),E1.LODESTONE()),new n($localize`Martian Chess`,"MartianChess",Fo,new A3e,new Ld(Rs),new Date("2022-07-01"),E1.MARTIAN_CHESS()),new n($localize`Hnefatafl`,"Hnefatafl",_0t,new C3e,x5.get(),new Date("2022-09-21"),E1.HNEFATAFL()),new n($localize`Hive`,"Hive",s0t,new _3e,Gi.get(),new Date("2023-04-02"),E1.HIVE()),new n($localize`Trexo`,"Trexo",u1,new t4e,Zi.get(),new Date("2023-04-23"),E1.TREXO()),new n($localize`Lasca`,"Lasca",L0t,new S3e,$4.get(),new Date("2023-05-11"),E1.LASCA()),new n($localize`Connect Six`,"ConnectSix",G4t,new Kce,Vc.get(),new Date("2023-05-13"),E1.CONNECT_SIX()),new n($localize`Pente`,"Pente",Z8t,new R3e,nc.get(),new Date("2023-05-20"),E1.PENTE())].sort((t,e)=>t.name.localeCompare(e.name)),n})(),QH=(()=>{class n{constructor(){this.games=$d.ALL_GAMES(),this.pickGame=new dr}onChange(e){this.pickGame.emit(e.target.value)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=dt({type:n,selectors:[["app-pick-game"]],outputs:{pickGame:"pickGame"},decls:5,vars:1,consts:function(){let t;return t=$localize`Pick a game`,[[1,"select","is-primary","is-fullwidth"],["id","gameType",3,"change"],["value","","selected",""],t,[3,"value",4,"ngFor","ngForOf"],[3,"value"]]},template:function(e,r){1&e&&(O(0,"div",0)(1,"select",1),ee("change",function(i){return r.onChange(i)}),O(2,"option",2),ve(3,3),A(),x(4,H7t,2,2,"option",4),A()()),2&e&&(P(4),w("ngForOf",r.games))},dependencies:[On,wp,bp],encapsulation:2}),n})();function F7t(n,t){if(1&n){const e=Oe();O(0,"div",26)(1,"div",27),ee("click",function(){return ue(e),ce(C().closeInfo())}),A(),O(2,"div",28)(3,"header",29)(4,"p",30),Tt(5),A(),O(6,"button",31),ee("click",function(){return ue(e),ce(C().closeInfo())}),A()(),O(7,"section",32)(8,"div",6)(9,"div",33)(10,"p",34),X(11,"img",35),A()(),O(12,"div",7)(13,"div",13),Tt(14),A()()(),O(15,"div",6)(16,"div",33)(17,"a",36),ee("click",function(){ue(e);const s=C();return ce(s.createGame(s.gameInfoDetails.get().urlName))}),X(18,"fa-icon",37),Tt(19,"\xa0"),O(20,"span"),ve(21,38),A()()(),O(22,"div",33)(23,"a",36),ee("click",function(){ue(e);const s=C();return ce(s.createLocalGame(s.gameInfoDetails.get().urlName))}),X(24,"fa-icon",37),Tt(25,"\xa0"),O(26,"span"),ve(27,39),A()()(),O(28,"div",33)(29,"a",36),ee("click",function(){ue(e);const s=C();return ce(s.createTutorial(s.gameInfoDetails.get().urlName))}),X(30,"fa-icon",37),Tt(31,"\xa0"),O(32,"span"),ve(33,40),A()()()()()()()}if(2&n){const e=C();P(5),c1(e.gameInfoDetails.get().name),P(6),De("src","assets/images/",e.theme,"/",e.gameInfoDetails.get().urlName,".png",g3),P(3),Z2(" ",e.gameInfoDetails.get().description," "),P(4),w("icon",e.iconOnlineGame),P(6),w("icon",e.iconLocalGame),P(6),w("icon",e.iconTutorial)}}function B7t(n,t){if(1&n){const e=Oe();O(0,"div",8)(1,"div",9)(2,"p",10),Tt(3),A()(),O(4,"div",42)(5,"figure",34)(6,"img",43),ee("click",function(){const i=ue(e).$implicit;return ce(C(2).openInfo(i))}),A(),O(7,"figcaption",44),ee("click",function(){const i=ue(e).$implicit;return ce(C(2).openInfo(i))}),O(8,"div",45),Tt(9,"?"),A()(),O(10,"figcaption",46)(11,"a",47),ee("click",function(){const i=ue(e).$implicit;return ce(C(2).createGame(i.urlName))}),X(12,"fa-icon",37),A(),O(13,"a",48),ee("click",function(){const i=ue(e).$implicit;return ce(C(2).createLocalGame(i.urlName))}),X(14,"fa-icon",37),A(),O(15,"a",49),ee("click",function(){const i=ue(e).$implicit;return ce(C(2).createTutorial(i.urlName))}),X(16,"fa-icon",37),A()()()(),O(17,"div",50),Tt(18),A()()}if(2&n){const e=t.$implicit,r=C(2);P(3),c1(e.name),P(3),y1("id","image_",e.urlName,""),De("src","assets/images/",r.theme,"/",e.urlName,".png",g3),P(5),y1("id","playOnline_",e.urlName,""),P(1),w("icon",r.iconOnlineGame),P(1),y1("id","playLocally_",e.urlName,""),P(1),w("icon",r.iconLocalGame),P(1),y1("id","startTutorial_",e.urlName,""),P(1),w("icon",r.iconTutorial),P(2),Z2(" ",e.description," ")}}function $7t(n,t){if(1&n&&(O(0,"div",7),x(1,B7t,19,11,"div",41),A()),2&n){const e=t.$implicit;P(1),w("ngForOf",e)}}let U7t=(()=>{class n{constructor(e,r,s,i){this.router=e,this.messageDisplayer=r,this.observedPartService=s,this.numberOfColumns=5,this.games=[],this.iconOnlineGame=doe,this.iconLocalGame=mH,this.iconTutorial=pce,this.gameInfoDetails=T.empty(),this.theme=i.getTheme();const o=$d.ALL_GAMES();let c=0;for(let u=0;u<o.length;u++)u<this.numberOfColumns&&this.games.push([]),this.games[c].push(o[u]),c=(c+1)%this.numberOfColumns}createGame(e){var r=this;return I(function*(){const s=r.observedPartService.canUserCreate();return s.isSuccess()?r.router.navigate(null==e?["/play"]:["/play",e]):(r.messageDisplayer.criticalMessage(s.getReason()),!1)})()}createLocalGame(e){var r=this;return I(function*(){return r.router.navigate(["/local",e])})()}createTutorial(e){return this.router.navigate(["/tutorial",e])}openInfo(e){this.gameInfoDetails=T.of(e)}closeInfo(){this.gameInfoDetails=T.empty()}}return n.\u0275fac=function(e){return new(e||n)(J(Kn),J(En),J(b2),J(RS))},n.\u0275cmp=dt({type:n,selectors:[["app-welcome"]],decls:33,vars:2,consts:function(){let t,e,r,s,i,o,c,u,d,g,m,y,b,k;return t=$localize`EveryBoard`,e=$localize`EveryBoard is a website to play and learn the rules of various abstract strategy games with perfect information.${"\ufffd#6\ufffd\ufffd/#6\ufffd"}:LINE_BREAK: Such games are games that do not include any randomness, agility, or hidden information. These games are played by two players, turn by turn.`,r=$localize`Play online`,s=$localize`Create an online game`,i=$localize`See the game list`,o=$localize`Play offline`,c=$localize`Play`,u=$localize`Learn`,d=$localize`Play online`,g=$localize`Play offline`,m=$localize`Learn the rules`,y=$localize`Play online`,b=$localize`Play offline`,k=$localize`Learn the rules`,[[1,"hero"],[1,"hero-body"],[1,"title"],t,[1,"subtitle"],e,[1,"columns"],[1,"column"],[1,"card"],[1,"card-header"],[1,"card-header-title"],r,[1,"card-content"],[1,"content"],["id","createOnlineGame",1,"button","is-medium","is-fullwidth","is-primary","mb-1",3,"click"],s,["id","seeGameList","routerLink","/lobby",1,"button","is-medium","is-fullwidth","is-primary"],i,o,[1,"content","has-text-centered"],["routerLink","/local",1,"button","is-medium","is-fullwidth","is-primary","mb-1"],c,["routerLink","/tutorial",1,"button","is-medium","is-fullwidth","is-primary"],u,["id","gameInfoModal","class","modal is-active",4,"ngIf"],["class","column",4,"ngFor","ngForOf"],["id","gameInfoModal",1,"modal","is-active"],["id","modalBackground",1,"modal-background",3,"click"],[1,"modal-card"],[1,"modal-card-head","is-primary"],[1,"modal-card-title"],["id","closeInfo","aria-label","close",1,"delete",3,"click"],[1,"modal-card-body"],[1,"column","is-one-third"],[1,"image"],[3,"src"],[1,"button","is-fullwidth",3,"click"],[3,"icon"],d,g,m,["class","card",4,"ngFor","ngForOf"],[1,"card-image","game-card"],[1,"is-clickable",3,"id","src","click"],[1,"has-text-centered","is-overlay","game-image-text","is-clickable",3,"click"],[1,"is-size-1","has-text-weight-bold"],[1,"has-text-centered","is-overlay","game-image-buttons"],["data-tooltip",y,1,"button",3,"id","click"],["data-tooltip",b,1,"button",3,"id","click"],["data-tooltip",k,1,"button",3,"id","click"],[1,"card-content","is-hidden"]]},template:function(e,r){1&e&&(O(0,"section",0)(1,"div",1)(2,"p",2),ve(3,3),A(),O(4,"p",4),Sc(5,5),X(6,"br"),Pc(),A()(),O(7,"div",6)(8,"div",7)(9,"div",8)(10,"header",9)(11,"p",10),ve(12,11),A()(),O(13,"div",12)(14,"div",13)(15,"button",14),ee("click",function(){return r.createGame()}),ve(16,15),A(),O(17,"button",16),ve(18,17),A()()()()(),O(19,"div",7)(20,"div",8)(21,"header",9)(22,"p",10),ve(23,18),A()(),O(24,"div",12)(25,"div",19)(26,"button",20),ve(27,21),A(),O(28,"button",22),ve(29,23),A()()()()()(),x(30,F7t,34,7,"div",24),O(31,"div",6),x(32,$7t,2,1,"div",25),A()()),2&e&&(P(30),w("ngIf",r.gameInfoDetails.isPresent()),P(2),w("ngForOf",r.games))},dependencies:[On,Kt,Gp,Sd],encapsulation:2}),n})();const G7t=["board"];let Ud=(()=>{class n{static NO_MATCHING_GAME(e){return $localize`This game (${e}) does not exist.`}}return n.NOT_YOUR_TURN=()=>$localize`It is not your turn!`,n.NO_CLONING_FEATURE=()=>$localize`You cannot clone a game. This feature might be implemented later.`,n})(),iT=(()=>{class n{constructor(e,r,s,i,o){this.componentFactoryResolver=e,this.actRoute=r,this.connectedUserService=s,this.router=i,this.messageDisplayer=o,this.boardRef=null,this.players=[T.empty(),T.empty()],this.role=he.NONE,this.endGame=!1,this.Player=B,Q(n.VERBOSE,"GameWrapper.constructed: "+(null!=this.boardRef))}getMatchingComponent(e){return Q(n.VERBOSE,"GameWrapper.getMatchingComponent"),T.ofNullable($d.ALL_GAMES().find(s=>s.urlName===e)).map(s=>s.component)}afterViewInit(){var e=this;return I(function*(){Q(n.VERBOSE,"GameWrapper.afterViewInit");const r=yield e.createGameComponent();return r&&(e.gameComponent.rules.setInitialBoard(),e.gameComponent.updateBoard()),r})()}getGameName(){return Me.getNonNullable(this.actRoute.snapshot.paramMap.get("compo"))}createGameComponent(){var e=this;return I(function*(){Q(n.VERBOSE,{m:"GameWrapper.createGameComponent",that:e});const r=e.getGameName(),s=e.getMatchingComponent(r);if(s.isAbsent())return yield e.router.navigate(["/notFound",Ud.NO_MATCHING_GAME(r)],{skipLocationChange:!0}),!1;Pe(null!=e.boardRef,"Board element should be present");const i=e.componentFactoryResolver.resolveComponentFactory(s.get()),o=Me.getNonNullable(e.boardRef).createComponent(i);return e.gameComponent=o.instance,e.gameComponent.chooseMove=(c,u,d)=>e.receiveValidMove(c,u,d),e.gameComponent.canUserPlay=c=>e.onUserClick(c),e.gameComponent.isPlayerTurn=()=>e.isPlayerTurn(),e.gameComponent.cancelMoveOnWrapper=c=>{e.onCancelMove(c)},e.setRole(e.role),e.canPass=e.gameComponent.canPass,!0})()}setRole(e){this.role=e,this.gameComponent.role=this.role,this.gameComponent.hasAsymmetricBoard&&(this.gameComponent.rotation="rotate("+180*this.role.value+")"),this.gameComponent.updateBoard()}receiveValidMove(e,r,s){var i=this;return I(function*(){if(Q(n.VERBOSE||!1,{gameWrapper_receiveValidMove_AKA_chooseMove:{move:e,state:r,scores:s}}),!i.isPlayerTurn())return R.failure(Ud.NOT_YOUR_TURN());if(i.endGame)return R.failure($localize`The game has ended.`);const c=i.gameComponent.rules.isLegal(e,r);return c.isFailure()?(i.gameComponent.cancelMove(c.getReason()),R.ofFallible(c)):(i.gameComponent.cancelMoveAttempt(),yield i.onLegalUserMove(e,s),Q(n.VERBOSE||!1,"GameWrapper.receiveValidMove says: valid move legal"),R.SUCCESS)})()}onUserClick(e){if(this.role===he.NONE){const r=Ud.NO_CLONING_FEATURE();return R.failure(r)}return this.isPlayerTurn()?R.SUCCESS:R.failure(Ud.NOT_YOUR_TURN())}isPlayerTurn(){if(this.role===he.NONE||null==this.gameComponent)return!1;const e=this.gameComponent.getTurn(),r=e%2,s=this.getPlayer();return Q(n.VERBOSE,{isPlayerTurn:{turn:e,players:this.players,player:s,observer:this.role,areYouPlayer:this.players[r].isPresent()&&Wa(this.players[r].get(),s),isThereAPlayer:this.players[r]}}),!this.players[r].isPresent()||this.players[r].equalsValue(s)}getBoardHighlight(){return this.endGame?["endgame-bg"]:this.isPlayerTurn()?["player"+this.gameComponent.getTurn()%2+"-bg"]:[]}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(J(xa),J(bo),J(Ns),J(Kn),J(En))},n.\u0275cmp=dt({type:n,selectors:[["ng-component"]],viewQuery:function(e,r){if(1&e&&C4(G7t,5,Va),2&e){let s;wc(s=bc())&&(r.boardRef=s.first)}},decls:0,vars:0,template:function(e,r){},encapsulation:2}),n})();const W7t=["board"];let q7t=(()=>{class n extends iT{constructor(e,r,s,i,o,c){super(e,r,s,i,o),this.cdr=c,this.boardRef=null}getGameName(){return this.demoNodeInfo.name}ngAfterViewInit(){var e=this;return I(function*(){setTimeout(I(function*(){yield e.afterViewInit(),e.gameComponent.rules.node=e.demoNodeInfo.node,e.setRole(e.gameComponent.getCurrentPlayer()),e.cdr.detectChanges(),e.demoNodeInfo.click.isPresent()&&(Me.getNonNullable(document.querySelector(e.demoNodeInfo.click.get())).dispatchEvent(new Event("click")),e.cdr.detectChanges())}),1)})()}onLegalUserMove(e,r){return I(function*(){})()}getPlayer(){return"no-player"}onCancelMove(e){}}return n.\u0275fac=function(e){return new(e||n)(J(xa),J(bo),J(Ns),J(Kn),J(En),J(Mu))},n.\u0275cmp=dt({type:n,selectors:[["app-demo-card"]],viewQuery:function(e,r){if(1&e&&C4(W7t,5,Va),2&e){let s;wc(s=bc())&&(r.boardRef=s.first)}},inputs:{demoNodeInfo:"demoNodeInfo"},features:[l],decls:2,vars:0,consts:[["board",""]],template:function(e,r){1&e&&X(0,"div",null,0)},encapsulation:2}),n})();function j7t(n,t){if(1&n&&(O(0,"div",17)(1,"figure",18),X(2,"app-demo-card",19),A()()),2&n){const e=C().$implicit;P(2),w("demoNodeInfo",e)}}function Z7t(n,t){if(1&n&&(O(0,"div",20)(1,"figure",21),X(2,"app-demo-card",19),A()()),2&n){const e=C().$implicit;P(2),w("demoNodeInfo",e)}}function Y7t(n,t){if(1&n&&(O(0,"div",12)(1,"div",13)(2,"p",14),Tt(3),A()(),x(4,j7t,3,1,"div",15),x(5,Z7t,3,1,"ng-template",null,16,Zn),A()),2&n){const e=t.$implicit,r=Bn(6),s=C(2);P(3),c1(e.name),P(1),w("ngIf",s.squared.value)("ngIfElse",r)}}function K7t(n,t){if(1&n&&(O(0,"div",10),x(1,Y7t,7,3,"div",11),A()),2&n){const e=t.$implicit;P(1),w("ngForOf",e)}}let X7t=(()=>{class n{constructor(){this.numberOfColumns=new Ha(5),this.squared=new Ha(!0),this.columns=[],this.fillColumns(this.numberOfColumns.value),this.numberOfColumns.valueChanges.subscribe(e=>{this.fillColumns(e)})}fillColumns(e){const r=$d.ALL_GAMES();let s=0,i=0;this.columns=[];for(const o of r){const c=[],u=o.rules,d=o.tutorial.tutorial;for(const g of d){const m=this.getNodeFromStep(g,u);c.push(m)}for(const g of c)i<e&&this.columns.push([]),this.columns[s].push({name:o.urlName,node:g.node,click:g.click}),i++,s=(s+1)%e}}getNodeFromStep(e,r){if(e.hasSolution()){const s=e.getSolution();if("string"==typeof s)return{node:new U1(e.state),click:T.of(s)};{const i=s;return{node:new U1(r.applyLegalMove(i,e.state,r.isLegal(i,e.state).get()),T.of(new U1(e.state)),T.of(i)),click:T.empty()}}}return{node:new U1(e.state),click:T.empty()}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=dt({type:n,selectors:[["app-demo-page"]],decls:17,vars:4,consts:function(){let t,e;return t=$localize`Number of columns: `,e=$localize`Squared`,[[1,"field"],["for","numberOfColumns",1,"label"],t,[1,"control"],["step","1","min","1","max","10","name","maximalMoveDuration","type","range",1,"slider","is-circle","is-primary",3,"formControl"],[1,"checkbox"],["type","checkbox",3,"formControl"],e,[1,"columns"],["class","column",4,"ngFor","ngForOf"],[1,"column"],["class","card",4,"ngFor","ngForOf"],[1,"card"],[1,"card-header"],[1,"card-header-title"],["class","card-image game-card","style","height: 200px;",4,"ngIf","ngIfElse"],["nonSquared",""],[1,"card-image","game-card",2,"height","200px"],[1,"image",2,"height","100%"],[3,"demoNodeInfo"],[1,"card-image","game-card"],[1,"image"]]},template:function(e,r){1&e&&(O(0,"form")(1,"div",0)(2,"label",1),pn(3),ve(4,2),gn(),O(5,"output"),Tt(6),A()(),O(7,"div",3),X(8,"input",4),A()(),O(9,"div",0)(10,"label",5),X(11,"input",6),Tt(12," \xa0"),pn(13),ve(14,7),gn(),A()()(),O(15,"div",8),x(16,K7t,2,1,"div",9),A()),2&e&&(P(6),c1(r.numberOfColumns.value),P(2),w("formControl",r.numberOfColumns),P(3),w("formControl",r.squared),P(5),w("ngForOf",r.columns))},dependencies:[On,Kt,bu,S4,Gy,dA,Ll,wu,TA,Pp,q7t],encapsulation:2}),n})(),JH=(()=>{class n{constructor(e){this.element=e}ngAfterViewInit(){this.element.nativeElement.focus()}}return n.\u0275fac=function(e){return new(e||n)(J(f2))},n.\u0275dir=Gt({type:n,selectors:[["","autofocus",""]]}),n})(),o4e=(()=>{class n{constructor(e){this.shown=!1,this.input=e.nativeElement.parentNode.previousSibling,e.nativeElement.addEventListener("click",r=>{this.toggle()})}toggle(){this.shown=!this.shown,this.input.setAttribute("type",this.shown?"text":"password"),this.input.focus()}}return n.\u0275fac=function(e){return new(e||n)(J(f2))},n.\u0275dir=Gt({type:n,selectors:[["","toggleVisibility",""]]}),n})();function Q7t(n,t){if(1&n&&(O(0,"div",29)(1,"div",30),ve(2,31),A(),O(3,"div",32),Tt(4),A()()),2&n){const e=C();P(4),c1(e.errorMessage)}}const J7t=function(){return["/register"]},eft=function(){return["/reset-password"]};let tft=(()=>{class n{constructor(e,r){this.router=e,this.connectedUserService=r,this.faEye=jV,this.loginForm=new T0({email:new Ha,password:new Ha})}ngOnInit(){var e=this;this.userSubscription=this.connectedUserService.subscribeToUser(function(){var r=I(function*(s){s!==M5.NOT_CONNECTED&&(yield e.redirect())});return function(s){return r.apply(this,arguments)}}())}loginWithEmail(e){var r=this;return I(function*(){const s=yield r.connectedUserService.doEmailLogin(e.email,e.password);s.isFailure()&&(r.errorMessage=s.getReason())})()}loginWithGoogle(){var e=this;return I(function*(){const r=yield e.connectedUserService.doGoogleLogin();r.isFailure()&&(e.errorMessage=r.getReason())})()}redirect(){var e=this;return I(function*(){return e.router.navigate(["/lobby"])})()}canLogin(){return!(""===(this.loginForm.value.email??"")||""===(this.loginForm.value.password??""))}ngOnDestroy(){this.userSubscription.unsubscribe()}}return n.\u0275fac=function(e){return new(e||n)(J(Kn),J(Ns))},n.\u0275cmp=dt({type:n,selectors:[["app-login"]],decls:49,vars:8,consts:function(){let t,e,r,s,i,o,c,u,d,g,m,y;return t=$localize`Log in`,e=$localize`Email`,r=$localize`Email`,s=$localize`Password`,i=$localize`Password`,o=$localize`Log in`,c=$localize`Log in with Google`,u=$localize`No account?`,d=$localize`Register`,g=$localize`Forgot your password?`,m=$localize`Reset your password`,y=$localize`Connection error`,[[1,"box"],[1,"title"],t,[3,"formGroup"],[1,"field","is-horizontal"],[1,"field-label"],["for","email",1,"label"],e,[1,"field-body"],[1,"field"],[1,"control"],["id","email","type","text","placeholder",r,"formControlName","email","name","email","type","email","autofocus","","required","",1,"input"],["for","password",1,"label"],s,[1,"control","has-icons-right","is-expanded"],["id","password","type","password","placeholder",i,"formControlName","password","name","password","required","",1,"input"],[1,"icon","is-small","is-right"],["toggleVisibility","",1,"clickable-icon",3,"icon"],["id","loginButton",1,"button","is-primary","is-fullwidth",3,"disabled","click"],o,["id","googleButton","type","submit",1,"button","is-fullwidth",3,"click"],c,["class","message is-danger","role","alert",4,"ngIf"],[1,"help","level-right"],u,[3,"routerLink"],d,g,m,["role","alert",1,"message","is-danger"],[1,"message-header"],y,["id","errorMessage",1,"message-body"]]},template:function(e,r){1&e&&(O(0,"div",0)(1,"p",1),ve(2,2),A(),O(3,"form",3)(4,"div",4)(5,"div",5)(6,"label",6),ve(7,7),A()(),O(8,"div",8)(9,"div",9)(10,"div",10),X(11,"input",11),A()()()(),O(12,"div",4)(13,"div",5)(14,"label",12),ve(15,13),A()(),O(16,"div",8)(17,"div",9)(18,"div",14),X(19,"input",15),O(20,"span",16),X(21,"fa-icon",17),A()()()()(),O(22,"div",4),X(23,"div",5),O(24,"div",8)(25,"div",9)(26,"div",10)(27,"button",18),ee("click",function(){return r.loginWithEmail(r.loginForm.value)}),ve(28,19),A()()()()(),O(29,"div",4),X(30,"div",5),O(31,"div",8)(32,"div",9)(33,"div",10)(34,"button",20),ee("click",function(){return r.loginWithGoogle()}),ve(35,21),A()()()()(),x(36,Q7t,5,1,"div",22),O(37,"p",23),pn(38),ve(39,24),gn(),Tt(40,"\xa0 "),O(41,"a",25),ve(42,26),A()(),O(43,"p",23),pn(44),ve(45,27),gn(),Tt(46,"\xa0 "),O(47,"a",25),ve(48,28),A()()()()),2&e&&(P(3),w("formGroup",r.loginForm),P(18),w("icon",r.faEye),P(6),w("disabled",!r.canLogin()),P(9),w("ngIf",r.errorMessage),P(5),w("routerLink",J1(6,J7t)),P(6),w("routerLink",J1(7,eft)))},dependencies:[Kt,Lu,bu,S4,Ll,wu,Nu,Ou,_f,Sd,JH,o4e],encapsulation:2}),n})(),nft=(()=>{class n{constructor(e){this.partDAO=e}subscribeToActiveParts(e){let r=[];const c=new kS(u=>{r=r.concat(...u),e(r)},u=>{const d=r;for(const g of u)d.forEach(m=>{m.id===g.id&&(m.data=g.data)});r=d,e(r)},u=>{const d=[];for(const g of r)u.some(m=>m.id===g.id)||d.push(g);r=d,e(r)});return this.partDAO.observingWhere([["result","==",Dn.UNACHIEVED.value]],c)}}return n.\u0275fac=function(e){return new(e||n)(Ve(kte))},n.\u0275prov=rt({token:n,factory:n.\u0275fac,providedIn:"any"}),n})(),rft=(()=>{class n{constructor(e){this.userDAO=e}subscribeToActiveUsers(e){Q(n.VERBOSE,"ActiveUsersService.subscribeToActiveUsers");let r=[];const c=new kS(u=>{Q(n.VERBOSE,"our DAO gave us "+u.length+" new user(s)"),r=this.sort(r.concat(...u)),e(r)},u=>{let d=r;Q(n.VERBOSE,"our DAO updated "+u.length+" user(s)");for(const g of u)d.forEach(m=>{m.id===g.id&&(m.data=g.data)}),d=this.sort(d);r=d,e(r)},u=>{r=r.filter(d=>!u.some(g=>g.id===d.id)),e(r)});return this.userDAO.observingWhere([["state","==","online"],["verified","==",!0]],c)}sort(e){return e.sort((r,s)=>{const i=Me.getNonNullable(r.data).lastUpdateTime,o=Me.getNonNullable(i).seconds,c=Me.getNonNullable(s.data).lastUpdateTime;return o-Me.getNonNullable(c).seconds})}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Ve(IS))},n.\u0275prov=rt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),a4e=(()=>{class n{transform(e){return hG(1e3*e.seconds,"HH:mm:ss","en-US")}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275pipe=ai({name:"firebaseDate",type:n,pure:!0}),n})();const sft=["chatDiv"];function ift(n,t){1&n&&(pn(0),ve(1,5),gn())}function oft(n,t){1&n&&ve(0,6),2&n&&(x1(C().unreadMessagesText),B1(0))}function aft(n,t){if(1&n){const e=Oe();O(0,"button",11),ee("click",function(){return ue(e),ce(C(2).scrollToBottom())}),Tt(1),A()}if(2&n){const e=C(2);P(1),Z2("",e.unreadMessagesText," \u2193")}}function cft(n,t){if(1&n&&(O(0,"p"),Tt(1),Tc(2,"firebaseDate"),O(3,"b",12),Tt(4),A(),O(5,"span",13),Tt(6),A()()),2&n){const e=t.$implicit;P(1),Z2(" [",w3(2,3,e.postedTime),"] "),P(3),Z2("",e.sender.name," : "),P(2),c1(e.content)}}function lft(n,t){if(1&n){const e=Oe();O(0,"div"),x(1,aft,2,1,"button",7),O(2,"div",8,9),ee("scroll",function(){return ue(e),ce(C().updateCurrentScrollPosition())}),x(4,cft,7,5,"p",10),A()()}if(2&n){const e=C();P(1),w("ngIf",e.showUnreadMessagesButton),P(3),w("ngForOf",e.chat)}}const uft=function(){return{standalone:!0}};function fft(n,t){if(1&n){const e=Oe();O(0,"form",14),ee("onSubmit",function(){return ue(e),ce(C().sendMessage())}),O(1,"div",15)(2,"div",16)(3,"input",17,18),ee("ngModelChange",function(s){return ue(e),ce(C().userMessage=s)}),A(),O(5,"p",19),Tt(6),A()(),O(7,"div",20)(8,"button",21),ee("click",function(){return ue(e),ce(C().sendMessage())}),X(9,"fa-icon",22),A()()(),O(10,"div",23)(11,"p")(12,"strong"),ve(13,24),A()()()()}if(2&n){const e=Bn(4),r=C();P(3),w("ngModel",r.userMessage)("ngModelOptions",J1(4,uft)),P(3),Z2("",e.value.length,"/128"),P(3),w("icon",r.faReply)}}let c4e=(()=>{class n{constructor(e,r){this.chatService=e,this.connectedUserService=r,this.userMessage="",this.connected=!1,this.chat=[],this.readMessages=0,this.unreadMessagesText="",this.showUnreadMessagesButton=!1,this.visible=!0,this.faReply=xV,this.isNearBottom=!0,this.notYetScrolled=!0,Q(n.VERBOSE,"ChatComponent constructor")}ngOnInit(){Q(n.VERBOSE,`ChatComponent.ngOnInit for chat ${this.chatId}`),Pe(null!=this.chatId&&""!==this.chatId,"No chat to join mentionned"),this.loadChatContent()}ngAfterViewChecked(){this.scrollToBottomIfNeeded()}loadChatContent(){const e=s=>{this.updateMessages(s.flatMap(i=>null==i.data.postedTime?[]:[i.data]))},r=new kS(e,e,()=>{});this.chatSubscription=this.chatService.subscribeToMessages(this.chatId,r)}updateMessages(e){this.chat=this.chat.concat(e);const r=this.chat.length;!0===this.visible&&!0===this.isNearBottom?(this.readMessages=r,this.updateUnreadMessagesText(0),this.scrollToBottom()):this.updateUnreadMessagesText(r-this.readMessages)}updateUnreadMessagesText(e){this.showUnreadMessagesButton=!(!this.visible||!1!==this.isNearBottom),0===e?(this.unreadMessagesText=$localize`no new message`,this.showUnreadMessagesButton=!1):this.unreadMessagesText=1===e?$localize`1 new message`:$localize`${e} new messages`}scrollToBottomIfNeeded(){this.visible&&(this.isNearBottom||this.notYetScrolled)&&this.scrollToBottom()}updateCurrentScrollPosition(){this.isNearBottom=this.chatDiv.nativeElement.scrollTop+this.chatDiv.nativeElement.offsetHeight>this.chatDiv.nativeElement.scrollHeight-10}scrollToBottom(){null!=this.chatDiv&&(this.updateUnreadMessagesText(0),this.scrollTo(this.chatDiv.nativeElement.scrollHeight),this.notYetScrolled=!1)}scrollTo(e){this.chatDiv.nativeElement.scroll({top:e,left:0,behavior:"smooth"})}sendMessage(){var e=this;return I(function*(){const r=e.userMessage;e.userMessage="";const s=e.connectedUserService.user.get().toMinimalUser();yield e.chatService.sendMessage(e.chatId,s,r,e.turn)})()}ngOnDestroy(){this.chatSubscription.unsubscribe()}switchChatVisibility(){!0===this.visible?this.visible=!1:(this.visible=!0,this.updateUnreadMessagesText(0),this.scrollToBottom(),this.readMessages=this.chat.length)}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(J(NS),J(Ns))},n.\u0275cmp=dt({type:n,selectors:[["app-chat"]],viewQuery:function(e,r){if(1&e&&C4(sft,5),2&e){let s;wc(s=bc())&&(r.chatDiv=s.first)}},inputs:{chatId:"chatId",turn:"turn"},decls:7,vars:4,consts:function(){let t,e,r,s;return t=$localize`Hide chat`,e=$localize`Show chat (${"\ufffd0\ufffd"}:INTERPOLATION:)`,r=$localize`Type your message here`,s=$localize`Be polite`,[["id","switchChatVisibilityButton",1,"button","is-primary","is-light","is-fullwidth",3,"click"],[4,"ngIf","ngIfElse"],["showChat",""],[4,"ngIf"],["id","chatForm",3,"onSubmit",4,"ngIf"],t,e,["id","scrollToBottomIndicator","class","notification button is-info is-light is-fullwidth",3,"click",4,"ngIf"],["id","chatDiv",1,"is-fullwidth","block",2,"overflow-y","scroll","max-height","50vh",3,"scroll"],["chatDiv",""],[4,"ngFor","ngForOf"],["id","scrollToBottomIndicator",1,"notification","button","is-info","is-light","is-fullwidth",3,"click"],[1,"chat-sender"],[1,"chat-message"],["id","chatForm",3,"onSubmit"],[1,"field","has-addons","is-fullwidth"],[1,"control","is-expanded"],["id","message","type","text","placeholder",r,"maxlength","128","value","",1,"input",3,"ngModel","ngModelOptions","ngModelChange"],["message",""],[1,"help"],[1,"control"],["type","submit","id","send",1,"button","is-primary",3,"click"],[1,"clickable-icon",3,"icon"],[1,"content","is-small"],s]},template:function(e,r){if(1&e&&(O(0,"div")(1,"button",0),ee("click",function(){return r.switchChatVisibility()}),x(2,ift,2,0,"ng-container",1),x(3,oft,1,1,"ng-template",null,2,Zn),A(),x(5,lft,5,2,"div",3),x(6,fft,14,5,"form",4),A()),2&e){const s=Bn(4);P(2),w("ngIf",r.visible)("ngIfElse",s),P(3),w("ngIf",r.visible),P(1),w("ngIf",r.visible)}},dependencies:[On,Kt,bu,S4,Ll,wu,AA,Tp,Pp,Sd,a4e],encapsulation:2}),n})(),l4e=(()=>{class n{constructor(e,r,s){this.router=e,this.observedPartService=r,this.messageDisplayer=s}pickGame(e){this.selectedGame=e}navigateToOnlineGameCreation(){var e=this;return I(function*(){const r=e.observedPartService.canUserCreate();r.isSuccess()?yield e.router.navigate(["/play",e.selectedGame]):e.messageDisplayer.criticalMessage(r.getReason())})()}}return n.\u0275fac=function(e){return new(e||n)(J(Kn),J(b2),J(En))},n.\u0275cmp=dt({type:n,selectors:[["app-online-game-selection"]],decls:3,vars:1,consts:function(){let t;return t=$localize`Create an online game`,[[3,"pickGame"],["id","launchGame",1,"button","is-primary","is-fullwidth",3,"disabled","click"],t]},template:function(e,r){1&e&&(O(0,"app-pick-game",0),ee("pickGame",function(i){return r.pickGame(i)}),A(),O(1,"button",1),ee("click",function(){return r.navigateToOnlineGameCreation()}),ve(2,2),A()),2&e&&(P(1),w("disabled",!r.selectedGame))},dependencies:[QH],encapsulation:2}),n})();function dft(n,t){if(1&n&&(pn(0),Tt(1),gn()),2&n){const e=C().$implicit;P(1),c1(e.data.playerOne.name)}}function hft(n,t){1&n&&(pn(0),ve(1,26),gn())}function pft(n,t){if(1&n){const e=Oe();O(0,"tr",22),ee("click",function(){const i=ue(e).$implicit;return ce(C(2).joinGame(i))}),O(1,"td",23),Tt(2),A(),O(3,"td",23),Tt(4),A(),O(5,"td",23),x(6,dft,2,1,"ng-container",24),x(7,hft,2,0,"ng-template",null,25,Zn),A(),O(9,"td",23),Tt(10),A()()}if(2&n){const e=t.$implicit,r=t.index,s=Bn(8);y1("id","part_",r,""),P(2),c1(e.data.typeGame),P(2),c1(e.data.playerZero.name),P(2),w("ngIf",e.data.playerOne)("ngIfElse",s),P(4),c1(e.data.turn)}}function gft(n,t){if(1&n&&(O(0,"div",13)(1,"div",14)(2,"table",15)(3,"thead")(4,"tr")(5,"th",16),ve(6,17),A(),O(7,"th",16),ve(8,18),A(),O(9,"th",16),ve(10,19),A(),O(11,"th",16),ve(12,20),A()()(),O(13,"tbody"),x(14,pft,11,6,"tr",21),A()()()()),2&n){const e=C();P(14),w("ngForOf",e.activeParts)}}function mft(n,t){1&n&&(O(0,"div",27),X(1,"app-online-game-selection",28),A())}function _ft(n,t){if(1&n&&(O(0,"li",39),Tt(1),Tc(2,"firebaseDate"),A()),2&n){const e=C().$implicit;rO("id",e.data.username),P(1),ny("",e.data.username,": ",w3(2,3,e.data.lastUpdateTime),"")}}function vft(n,t){if(1&n&&(pn(0),x(1,_ft,3,5,"li",38),gn()),2&n){const e=t.$implicit;P(1),w("ngIf",e.data.lastUpdateTime)}}function Cft(n,t){if(1&n&&(O(0,"div",29)(1,"div",30)(2,"div",31),X(3,"app-chat",32),A()(),O(4,"div",33)(5,"div",34)(6,"p"),ve(7,35),A(),O(8,"ul",36),x(9,vft,2,1,"ng-container",37),A()()()()),2&n){const e=C();P(3),w("turn",-1),P(6),w("ngForOf",e.activeUsers)}}let yft=(()=>{class n{constructor(e,r,s,i,o){this.router=e,this.messageDisplayer=r,this.activePartsService=s,this.activeUsersService=i,this.observedPartService=o,this.activeUsers=[],this.activeParts=[],this.currentTab="games",this.createTabClasses=[]}ngOnInit(){Q(n.VERBOSE,"lobbyComponent.ngOnInit"),this.activeUsersSubscription=this.activeUsersService.subscribeToActiveUsers(e=>{this.activeUsers=e}),this.activePartsSubscription=this.activePartsService.subscribeToActiveParts(e=>{this.activeParts=e}),this.observedPartService.subscribeToObservedPart(e=>{this.createTabClasses=[],e.isPresent()&&(this.createTabClasses=["disabled-tab"])})}ngOnDestroy(){Q(n.VERBOSE,"lobbyComponent.ngOnDestroy"),this.activeUsersSubscription.unsubscribe(),this.activePartsSubscription.unsubscribe()}joinGame(e){var r=this;return I(function*(){const s=e.id,i=e.data.typeGame,c=r.observedPartService.canUserJoin(s,null!=e.data.beginning);c.isSuccess()?yield r.router.navigate(["/play",i,s]):r.messageDisplayer.criticalMessage(c.getReason())})()}selectTab(e){if("create"===e){const r=this.observedPartService.canUserCreate();r.isSuccess()?this.currentTab=e:this.messageDisplayer.criticalMessage(r.getReason())}else this.currentTab=e}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(J(Kn),J(En),J(nft),J(rft),J(b2))},n.\u0275cmp=dt({type:n,selectors:[["app-lobby"]],decls:14,vars:4,consts:function(){let t,e,r,s,i,o,c,u,d;return t=$localize`Games`,e=$localize`Create`,r=$localize`Chat`,s=$localize`Game`,i=$localize`First player`,o=$localize`Second player`,c=$localize`Turn`,u=$localize`Waiting for opponent`,d=$localize`Connected users:`,[[1,"tabs","is-toggle","is-fullwidth"],["ngClass","if (currentTab === 'games') 'is-active'"],["id","tab-games",3,"click"],t,["ngClass","if (currentTab === 'create') 'is-active'"],["id","tab-create",3,"ngClass","click"],e,["ngClass","if (currentTab === 'chat') 'is-active'"],["id","tab-chat",3,"click"],r,["id","actualGames","class","box",4,"ngIf"],["id","gameCreator","class","box",4,"ngIf"],["id","chatTab","class","columns",4,"ngIf"],["id","actualGames",1,"box"],[1,"table-container"],[1,"table","is-fullwidth","is-hoverable","is-striped"],["scope","col",1,"th"],s,i,o,c,[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"td"],[4,"ngIf","ngIfElse"],["waitingForOpponent",""],u,["id","gameCreator",1,"box"],["id","online-game-selection"],["id","chatTab",1,"columns"],["id","chatContainerDiv",1,"column","is-12"],["id","chat",1,"box"],["chatId","server",3,"turn"],[1,"column","is-3","is-hidden"],["id","onlineUsers",1,"box"],d,["id","activeUsersList"],[4,"ngFor","ngForOf"],[3,"id",4,"ngIf"],[3,"id"]]},template:function(e,r){1&e&&(O(0,"div",0)(1,"ul")(2,"li",1)(3,"a",2),ee("click",function(){return r.selectTab("games")}),ve(4,3),A()(),O(5,"li",4)(6,"a",5),ee("click",function(){return r.selectTab("create")}),ve(7,6),A()(),O(8,"li",7)(9,"a",8),ee("click",function(){return r.selectTab("chat")}),ve(10,9),A()()()(),x(11,gft,15,1,"div",10),x(12,mft,2,0,"div",11),x(13,Cft,10,2,"div",12)),2&e&&(P(6),w("ngClass",r.createTabClasses),P(5),w("ngIf","games"===r.currentTab),P(1),w("ngIf","create"===r.currentTab),P(1),w("ngIf","chat"===r.currentTab))},dependencies:[fn,On,Kt,c4e,l4e,a4e],encapsulation:2}),n})(),u4e=(()=>{class n{constructor(e){this.route=e,this.message=e.snapshot.paramMap.get("message")??$localize`This page does not exist.`}}return n.\u0275fac=function(e){return new(e||n)(J(bo))},n.\u0275cmp=dt({type:n,selectors:[["app-not-found"]],decls:5,vars:1,consts:function(){let t;return t=$localize`Not found`,[[1,"message","is-danger"],[1,"message-header"],t,[1,"message-body"]]},template:function(e,r){1&e&&(O(0,"div",0)(1,"div",1),ve(2,2),A(),O(3,"div",3),Tt(4),A()()),2&e&&(P(4),c1(r.message))},encapsulation:2}),n})();class Gd{constructor(t,e,r){this.added=t,this.modified=e,this.removed=r}static from(t,e){const r=new Gd({},{},{});if(null==t)return r.added={...e},r;if(null==e)return r.removed={...t},r;const s=Object.keys(t),i=Object.keys(e),o=s.filter(d=>!1===i.includes(d)),c=s.filter(d=>i.includes(d)),u=i.filter(d=>!1===s.includes(d));return r.addNewKeys(u,e),r.addCommonKeys(c,e,t),r.addRemovedKeys(o,t),r}static differs(t,e){return Gd.from(t,e).countChanges()>0}addNewKeys(t,e){for(const r of t)null!=e[r]&&(this.added[r]=e[r])}addCommonKeys(t,e,r){for(const s of t)this.addCommonKey(s,r[s],e[s])}addCommonKey(t,e,r){if(null==r)null!=e&&(this.removed[t]=e);else if(null==e)this.added[t]=r;else if(["string","boolean","number"].includes(typeof e))e!==r&&(this.modified[t]=r);else if(Array.isArray(e)){if(!Array.isArray(r))throw new Error("Thing should not change type");e.length===r.length?this.addCommonKeyList(t,e,r):this.modified[t]=r}else{Pe("object"==typeof e,`ObjectDifference: expected JSON, but got a ${typeof e} in ${t}`),Pe("object"==typeof r,`ObjectDifference: expected JSON, but got a ${typeof r} in ${t}`);const o=Gd.from(e,r);o.countChanges()>0&&(this.modified[t]=o)}}addCommonKeyList(t,e,r){let s=!0;for(let i=0;s&&i<e.length;i++)typeof e[i]==typeof r[i]&&"object"==typeof e[i]?Gd.differs(e[i],r[i])&&(s=!1,this.modified[t]=r):e[i]!==r[i]&&(s=!1,this.modified[t]=r)}addRemovedKeys(t,e){for(const r of t)this.removed[r]=e[r]}countChanges(){const t=Object.keys(this.removed).length,e=Object.keys(this.modified).length;return Object.keys(this.added).length+e+t}isPresent(t){return null!=this.added[t]?{state:"added",present:!0}:null!=this.modified[t]?{state:"modified",present:!0}:null!=this.removed[t]?{state:"removed",present:!0}:{state:null,present:!1}}isFullyCreated(){return 0===Object.keys(this.modified).length&&0===Object.keys(this.removed).length}addedOrModified(t){const e=this.isPresent(t);return!0===e.present&&"removed"!==e.state}}function f4e(n){return 1e3*n.seconds+n.nanoseconds/1e6}function d4e(n,t){return f4e(t)-f4e(n)}function o_(n){return fr((t,e)=>{uo(n).subscribe(ls(e,()=>e.complete(),lo)),!e.closed&&t.subscribe(e)})}let Eft=(()=>{class n{transform(e){const r=e%60,s=(e-r)%3600/60,i=(e-60*s-r)/3600,o=[];if(i>1?o.push($localize`${i} hours`):1===i&&o.push($localize`1 hour`),s>1?o.push($localize`${s} minutes`):1===s&&o.push($localize`1 minute`),r>1?o.push($localize`${r} seconds`):1===r&&o.push($localize`1 second`),0===o.length)return $localize`0 seconds`;if(1===o.length)return o[0];{const c=o.slice(0,-1).join(", "),u=o.slice(-1)[0];return $localize`${c} and ${u}`}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275pipe=ai({name:"humanDuration",type:n,pure:!0}),n})();function Mft(n,t){if(1&n&&(pn(0),Tt(1),gn()),2&n){const e=C(3);P(1),c1(e.viewInfo.chosenOpponent)}}function Sft(n,t){1&n&&ve(0,44)}function Pft(n,t){if(1&n&&(O(0,"div",45)(1,"div",8)(2,"label",46),pn(3),ve(4,47),gn(),O(5,"output"),Tt(6),Tc(7,"humanDuration"),A()(),O(8,"div",37),X(9,"input",48),A()(),O(10,"div",8)(11,"label",49),Sc(12,50),X(13,"output"),Tc(14,"humanDuration"),Pc(),A(),O(15,"div",37),X(16,"input",51),A()()()),2&n){const e=C(3);P(6),c1(w3(7,2,e.viewInfo.maximalMoveDuration||0)),P(8),x1(w3(14,4,e.viewInfo.totalPartDuration||0)),B1(12)}}function Tft(n,t){1&n&&(O(0,"div"),Sc(1,52),X(2,"br"),Pc(),A())}function wft(n,t){1&n&&(O(0,"button",64),ve(1,65),A())}function bft(n,t){if(1&n){const e=Oe();O(0,"tr",60),ee("click",function(){const i=ue(e).$implicit;return ce(C(4).selectOpponent(i))}),O(1,"td",61),Tt(2),A(),O(3,"td",62),x(4,wft,2,0,"button",63),A()()}if(2&n){const e=t.$implicit,r=C(4);y1("id","presenceOf_",e,""),w("ngClass",r.viewInfo.candidateClasses[e]),P(1),w("id",r.viewInfo.chosenOpponent===e?"selected_"+e:"candidate_"+e),P(1),c1(e),P(2),w("ngIf",r.viewInfo.chosenOpponent!==e)}}function Oft(n,t){if(1&n&&(pn(0),ve(1,53),gn(),O(2,"div",54)(3,"table",55)(4,"thead")(5,"tr")(6,"th",56),ve(7,57),A(),O(8,"th",56),ve(9,58),A()()(),O(10,"tbody"),x(11,bft,5,5,"tr",59),A()()()),2&n){const e=C(3);P(11),w("ngForOf",e.viewInfo.candidates)}}function Aft(n,t){if(1&n){const e=Oe();O(0,"button",66),ee("click",function(){return ue(e),ce(C(3).changeConfig())}),ve(1,67),A()}}function Nft(n,t){if(1&n){const e=Oe();O(0,"div")(1,"h1",4),ve(2,5),A(),O(3,"form",6)(4,"fieldset",7)(5,"div",8)(6,"label",9),ve(7,10),A(),O(8,"div",11)(9,"button",12),ee("click",function(){return ue(e),ce(C(2).selectFirstPlayer("RANDOM"))}),ve(10,13),A(),O(11,"button",14),ee("click",function(){return ue(e),ce(C(2).selectFirstPlayer("CREATOR"))}),ve(12,15),A(),O(13,"button",16),ee("click",function(){return ue(e),ce(C(2).selectFirstPlayer("CHOSEN_PLAYER"))}),x(14,Mft,2,1,"ng-container",17),x(15,Sft,1,0,"ng-template",null,18,Zn),A()()(),O(17,"div",8)(18,"label",9),ve(19,19),A(),O(20,"div",11)(21,"div",20),ee("click",function(){return ue(e),ce(C(2).selectPartType("STANDARD"))}),O(22,"div",21)(23,"span"),ve(24,22),A()(),O(25,"div",23)(26,"div",24)(27,"div",25)(28,"p"),pn(29),ve(30,26),gn(),O(31,"strong"),Tt(32),Tc(33,"humanDuration"),A(),X(34,"br"),pn(35),Sc(36,27),X(37,"strong"),Tc(38,"humanDuration"),Pc(),gn(),A()()()()(),O(39,"div",28),ee("click",function(){return ue(e),ce(C(2).selectPartType("BLITZ"))}),O(40,"div",21)(41,"span"),ve(42,29),A()(),O(43,"div",23)(44,"div",24)(45,"div",25)(46,"p"),pn(47),ve(48,30),gn(),O(49,"strong"),Tt(50),Tc(51,"humanDuration"),A(),X(52,"br"),pn(53),Sc(54,31),X(55,"strong"),Tc(56,"humanDuration"),Pc(),gn(),A()()()()(),O(57,"button",32),ee("click",function(){return ue(e),ce(C(2).selectPartType("CUSTOM"))}),ve(58,33),A()()(),x(59,Pft,17,6,"div",34),O(60,"div",8)(61,"label",35),ve(62,36),A(),O(63,"div",37),x(64,Tft,3,0,"div",17),x(65,Oft,12,1,"ng-template",null,38,Zn),A()()(),O(67,"div",8)(68,"div",11)(69,"button",39),ee("click",function(){return ue(e),ce(C(2).proposeConfig())}),ve(70,40),A(),x(71,Aft,2,0,"button",41),O(72,"button",42),ee("click",function(){return ue(e),ce(C(2).cancelGameCreation())}),ve(73,43),A()()()()()}if(2&n){const e=Bn(16),r=Bn(66),s=C(2);P(3),w("formGroup",s.configFormGroup),P(1),w("disabled",!s.viewInfo.canEditConfig),P(5),w("ngClass",s.viewInfo.firstPlayerClasses.RANDOM),P(2),w("ngClass",s.viewInfo.firstPlayerClasses.CREATOR),P(2),w("ngClass",s.viewInfo.firstPlayerClasses.CHOSEN_PLAYER),P(1),w("ngIf",s.viewInfo.chosenOpponent)("ngIfElse",e),P(7),w("ngClass",s.viewInfo.partTypeClasses.STANDARD),P(11),c1(w3(33,19,s.partType.NORMAL_MOVE_DURATION)),P(6),x1(w3(38,21,s.partType.NORMAL_PART_DURATION)),B1(36),P(1),w("ngClass",s.viewInfo.partTypeClasses.BLITZ),P(11),c1(w3(51,23,s.partType.BLITZ_MOVE_DURATION)),P(6),x1(w3(56,25,s.partType.BLITZ_PART_DURATION)),B1(54),P(1),w("ngClass",s.viewInfo.partTypeClasses.CUSTOM),P(2),w("ngIf",s.viewInfo.showCustomTime),P(5),w("ngIf",0===s.viewInfo.candidates.length)("ngIfElse",r),P(5),w("disabled",!s.viewInfo.canProposeConfig),P(2),w("ngIf",s.viewInfo.canReviewConfig)}}function Ift(n,t){if(1&n&&(O(0,"div",74)(1,"p"),Sc(2,75),X(3,"br"),Pc(),A()()),2&n){const e=C(3);P(3),x1(e.viewInfo.creator),B1(2)}}function xft(n,t){if(1&n&&(O(0,"span"),ve(1,81),A()),2&n){const e=C(4);P(1),x1(e.viewInfo.creator),B1(1)}}function kft(n,t){1&n&&(O(0,"span"),ve(1,82),A())}function Lft(n,t){1&n&&(O(0,"span"),ve(1,83),A())}function Rft(n,t){if(1&n){const e=Oe();O(0,"div",74)(1,"p"),ve(2,76),A(),O(3,"ul")(4,"li"),x(5,xft,2,1,"span",2),x(6,kft,2,0,"span",2),x(7,Lft,2,0,"span",2),A(),O(8,"li"),Sc(9,77),X(10,"strong"),Tc(11,"humanDuration"),Pc(),A(),O(12,"li"),Sc(13,78),X(14,"strong"),Tc(15,"humanDuration"),Pc(),A()(),O(16,"button",79),ee("click",function(){return ue(e),ce(C(3).acceptConfig())}),ve(17,80),A()()}if(2&n){const e=C(3);P(2),x1(e.viewInfo.creator)(e.viewInfo.partTypeName),B1(2),P(3),w("ngIf","CREATOR"===e.viewInfo.firstPlayer),P(1),w("ngIf","CHOSEN_PLAYER"===e.viewInfo.firstPlayer),P(1),w("ngIf","RANDOM"===e.viewInfo.firstPlayer),P(4),x1(w3(11,7,e.viewInfo.maximalMoveDuration||0)),B1(9),P(4),x1(w3(15,9,e.viewInfo.totalPartDuration||0)),B1(13)}}function Dft(n,t){if(1&n&&(O(0,"div")(1,"div",68)(2,"div",69)(3,"p"),ve(4,70),A()(),O(5,"div",71),x(6,Ift,4,1,"div",72),x(7,Rft,18,11,"ng-template",null,73,Zn),A()()()),2&n){const e=Bn(8),r=C(2);P(6),w("ngIf",r.viewInfo.creatorIsModifyingConfig)("ngIfElse",e)}}function zft(n,t){if(1&n&&(pn(0),ve(1,86),gn()),2&n){const e=C(3);P(1),x1(e.viewInfo.creator),B1(1)}}function Vft(n,t){if(1&n&&ve(0,87),2&n){const e=C(3);x1(e.viewInfo.creator)(e.viewInfo.chosenOpponent),B1(0)}}function Hft(n,t){if(1&n&&(O(0,"div",68)(1,"div",69)(2,"p"),ve(3,84),A()(),O(4,"div",71)(5,"p"),x(6,zft,2,1,"ng-container",17),x(7,Vft,1,2,"ng-template",null,85,Zn),A()()()),2&n){const e=Bn(8),r=C(2);P(6),w("ngIf",r.viewInfo.creatorIsModifyingConfig)("ngIfElse",e)}}function Fft(n,t){if(1&n&&(O(0,"div",1),x(1,Nft,74,27,"div",2),x(2,Dft,9,2,"div",2),x(3,Hft,9,2,"div",3),A()),2&n){const e=C();P(1),w("ngIf",e.viewInfo.userIsCreator),P(1),w("ngIf",e.viewInfo.userIsChosenOpponent),P(1),w("ngIf",e.viewInfo.userIsObserver)}}class f1{constructor(t,e,r,s,i,o,c,u,d,g){this.router=t,this.actRoute=e,this.connectedUserService=r,this.observedPartService=s,this.gameService=i,this.configRoomService=o,this.chatService=c,this.userService=u,this.formBuilder=d,this.messageDisplayer=g,this.partType=wr,this.gameStartNotification=new dr,this.gameStarted=!1,this.viewInfo={userIsCreator:!1,userIsChosenOpponent:!1,userIsObserver:!1,partType:"STANDARD",partTypeClasses:{STANDARD:["is-selected","is-primary"],BLITZ:[],CUSTOM:[]},firstPlayer:"RANDOM",firstPlayerClasses:{CREATOR:[],RANDOM:["is-selected","is-primary"],CHOSEN_PLAYER:[]},candidateClasses:{},candidates:[]},this.currentConfigRoom=null,this.candidates=[],this.ngUnsubscribe=new F2,this.allUserInterval=T.empty(),this.ownTokenInterval=T.empty(),this.selfSubscription=new q1,this.configRoomSubscription=new q1,this.candidatesSubscription=new q1,this.allDocDeleted=!1,Q(f1.VERBOSE,"PartCreationComponent constructed")}ngOnInit(){var t=this;return I(function*(){Q(f1.VERBOSE,"PartCreationComponent.ngOnInit"),t.checkInputs(),t.createForms();const e=yield t.configRoomService.joinGame(t.partId);if(e.isFailure()){const r=e.getReason();t.messageDisplayer.criticalMessage(r)}else yield t.startSendingPresenceTokens(),t.subscribeToConfigRoomDoc(),t.subscribeToFormElements(),Q(f1.VERBOSE,"PartCreationComponent.ngOnInit asynchronouseries finisheds")})()}checkInputs(){const t=this.connectedUserService.user;Pe(t.isPresent(),"PartCreationComponent should not be called without connected user"),Pe(t.get()!==M5.NOT_CONNECTED,"PartCreationComponent should not be created with an empty userName"),Pe(""!==this.partId,"PartCreationComponent should not be created with an empty partId")}createForms(){this.configFormGroup=this.formBuilder.group({firstPlayer:[Zs.RANDOM.value,Cp.required],maximalMoveDuration:[wr.NORMAL_MOVE_DURATION,Cp.required],partType:["STANDARD",Cp.required],totalPartDuration:[wr.NORMAL_PART_DURATION,Cp.required],chosenOpponent:["",Cp.required]})}updateUserDocWithObservedPart(t){Q(f1.VERBOSE,"updateUserDocWithObservedPart of '"+this.partId+"'");const e=this.getUserRoleInPart(t),r={id:this.partId,opponent:this.getOpponent(),typeGame:Me.getNonNullable(this.actRoute.snapshot.paramMap.get("compo")),role:e};return this.observedPartService.updateObservedPart(r)}getUserRoleInPart(t){const e=this.connectedUserService.user.get().id;return e===t.creator.id?"Creator":e===t.chosenOpponent?.id?"ChosenOpponent":"Candidate"}getOpponent(){let t=null;return t=this.connectedUserService.user.get().id===this.currentConfigRoom?.creator.id?this.currentConfigRoom.chosenOpponent:Me.getNonNullable(this.currentConfigRoom?.creator),t}subscribeToConfigRoomDoc(){var t=this;const e=function(){var s=I(function*(i){yield t.onCurrentConfigRoomUpdate(i)});return function(o){return s.apply(this,arguments)}}(),r=function(){var s=I(function*(i){yield t.onCandidatesUpdate(i)});return function(o){return s.apply(this,arguments)}}();this.configRoomSubscription=this.configRoomService.subscribeToChanges(this.partId,e),this.candidatesSubscription=this.configRoomService.subscribeToCandidates(this.partId,r)}getForm(t){return Me.getNonNullable(this.configFormGroup.get(t))}subscribeToFormElements(){this.getForm("chosenOpponent").valueChanges.pipe(o_(this.ngUnsubscribe)).subscribe(t=>{void 0!==this.viewInfo.chosenOpponent&&(this.viewInfo.candidateClasses[this.viewInfo.chosenOpponent]=[]),this.viewInfo.candidateClasses[t]=["is-selected"],this.viewInfo.chosenOpponent=t;const e=Me.getNonNullable(this.currentConfigRoom).partStatus;this.viewInfo.canProposeConfig=e!==Ys.CONFIG_PROPOSED.value&&""!==t}),this.getForm("partType").valueChanges.pipe(o_(this.ngUnsubscribe)).subscribe(t=>{this.viewInfo.partTypeClasses[this.viewInfo.partType]=[],this.viewInfo.partTypeClasses[t]=["is-primary","is-selected"],this.viewInfo.partType=t,this.viewInfo.showCustomTime="CUSTOM"===t}),this.getForm("maximalMoveDuration").valueChanges.pipe(o_(this.ngUnsubscribe)).subscribe(t=>{this.viewInfo.maximalMoveDuration=t}),this.getForm("totalPartDuration").valueChanges.pipe(o_(this.ngUnsubscribe)).subscribe(t=>{this.viewInfo.totalPartDuration=t}),this.getForm("firstPlayer").valueChanges.pipe(o_(this.ngUnsubscribe)).subscribe(t=>{this.viewInfo.firstPlayerClasses[this.viewInfo.firstPlayer]=[],this.viewInfo.firstPlayerClasses[t]=["is-primary","is-selected"],this.viewInfo.firstPlayer=t})}updateViewInfo(){const t=Me.getNonNullable(this.currentConfigRoom),e=this.connectedUserService.user.get();switch(this.viewInfo.canReviewConfig=t.partStatus===Ys.CONFIG_PROPOSED.value,this.viewInfo.canEditConfig=t.partStatus!==Ys.CONFIG_PROPOSED.value,this.viewInfo.userIsCreator=this.userIsCreator(t),this.viewInfo.userIsChosenOpponent=e.id===t.chosenOpponent?.id,this.viewInfo.userIsObserver=!1===this.viewInfo.userIsChosenOpponent&&!1===this.viewInfo.userIsCreator,this.viewInfo.creatorIsModifyingConfig=t.partStatus!==Ys.CONFIG_PROPOSED.value,this.viewInfo.showCustomTime="CUSTOM"===this.getForm("partType").value,this.viewInfo.creator=t.creator.name,this.viewInfo.candidates=this.candidates.map(r=>r.name),this.userIsCreator(t)?this.setDataForCreator(t):(this.viewInfo.maximalMoveDuration=t.maximalMoveDuration,this.viewInfo.totalPartDuration=t.totalPartDuration,this.viewInfo.partType=t.partType,this.viewInfo.chosenOpponent=t.chosenOpponent?.name,this.viewInfo.firstPlayer=t.firstPlayer),t.partType){case"CUSTOM":this.viewInfo.partTypeName=$localize`custom`;break;case"BLITZ":this.viewInfo.partTypeName=$localize`blitz`;break;case"STANDARD":this.viewInfo.partTypeName=$localize`standard`}}setDataForCreator(t){this.viewInfo.maximalMoveDuration=this.viewInfo.maximalMoveDuration??t.maximalMoveDuration,this.viewInfo.totalPartDuration=this.viewInfo.totalPartDuration??t.totalPartDuration;let e=this.viewInfo.chosenOpponent;null==e||""===e?e=t.chosenOpponent?.name??"":!1===this.candidates.some(s=>s.name===e)&&(e=""),this.getForm("chosenOpponent").setValue(e)}selectFirstPlayer(t){this.getForm("firstPlayer").setValue(t)}selectPartType(t){"STANDARD"===t?(this.getForm("maximalMoveDuration").setValue(wr.NORMAL_MOVE_DURATION),this.getForm("totalPartDuration").setValue(wr.NORMAL_PART_DURATION)):"BLITZ"===t&&(this.getForm("maximalMoveDuration").setValue(wr.BLITZ_MOVE_DURATION),this.getForm("totalPartDuration").setValue(wr.BLITZ_PART_DURATION)),this.getForm("partType").setValue(t)}selectOpponent(t){var e=this;return I(function*(){Q(f1.VERBOSE,"PartCreationComponent.setChosenOpponent("+t+")");const r=e.getUserFromName(t);yield Promise.all([e.observedPartService.updateObservedPart({opponent:r}),e.configRoomService.setChosenOpponent(e.partId,r)])})()}getUserFromName(t){const e=this.candidates.find(r=>r.name===t);return Me.getNonNullable(e)}changeConfig(){var t=this;return I(function*(){return t.configRoomService.reviewConfig(t.partId)})()}proposeConfig(){var t=this;return I(function*(){const e=t.getForm("chosenOpponent").value,r=t.getForm("partType").value,s=t.getForm("maximalMoveDuration").value,i=t.getForm("firstPlayer").value,o=t.getForm("totalPartDuration").value,c=t.getUserFromName(e);return t.configRoomService.proposeConfig(t.partId,c,wr.of(r),s,Zs.of(i),o)})()}cancelGameCreation(){var t=this;return I(function*(){t.allDocDeleted=!0,yield t.observedPartService.removeObservedPart(),Q(f1.VERBOSE,"PartCreationComponent.cancelGameCreation"),yield t.chatService.deleteChat(t.partId),Q(f1.VERBOSE,"PartCreationComponent.cancelGameCreation: chat deleted"),yield t.gameService.deletePart(t.partId),Q(f1.VERBOSE,"PartCreationComponent.cancelGameCreation: chat and part deleted"),yield t.configRoomService.deleteConfigRoom(t.partId,t.candidates),Q(f1.VERBOSE,"PartCreationComponent.cancelGameCreation: chat, part, and configRoom deleted")})()}onCurrentConfigRoomUpdate(t){var e=this;return I(function*(){if(Q(f1.VERBOSE,{PartCreationComponent_onCurrentConfigRoomUpdate:{before:JSON.stringify(e.currentConfigRoom),then:JSON.stringify(t)}}),t.isAbsent())return Q(f1.VERBOSE,"PartCreationComponent.onCurrentConfigRoomUpdate: LAST UPDATE : the game is cancelled"),e.onGameCancelled();{const r=t.get();if(e.chosenOpponentJustLeft(r)&&e.userIsCreator(r)){const i=Me.getNonNullable(e.currentConfigRoom),o=Me.getNonNullable(i.chosenOpponent).name;e.messageDisplayer.infoMessage($localize`${o} left the game, please pick another opponent.`),yield e.observedPartService.updateObservedPart({opponent:null})}let s=!1;e.userJustChosenAsOpponent(r)&&(yield e.updateUserDocWithObservedPart(r),s=!0),e.currentConfigRoom=r,e.allUserInterval.isAbsent()&&(Pe(!1===s,"Expected observedPartUpdate to be false at first call of onCurrentConfigRoomUpdate"),yield e.updateUserDocWithObservedPart(e.currentConfigRoom),yield e.observeNeededPlayers()),e.updateViewInfo(),e.isGameStarted(e.currentConfigRoom)&&(Q(f1.VERBOSE,"PartCreationComponent.onCurrentConfigRoomUpdate: the game has started"),e.onGameStarted())}})()}onCandidatesUpdate(t){var e=this;return I(function*(){e.candidates=t,e.updateViewInfo()})()}userJustChosenAsOpponent(t){if(this.isGameStarted(t))return!1;const e=this.connectedUserService.user.get().id;return this.currentConfigRoom?.chosenOpponent?.id!==e&&t.chosenOpponent?.id===e}chosenOpponentJustLeft(t){return null!=this.currentConfigRoom&&(null!=this.currentConfigRoom.chosenOpponent&&null==t.chosenOpponent)}onGameCancelled(){var t=this;return I(function*(){Q(f1.VERBOSE,"PartCreationComponent.onGameCancelled"),t.messageDisplayer.infoMessage($localize`The game has been canceled!`),yield t.router.navigate(["/lobby"])})()}isGameStarted(t){return Pe(null!=t,"configRoom should not be null (isGameStarted)"),Me.getNonNullable(t).partStatus===Ys.PART_STARTED.value}onGameStarted(){const t=Me.getNonNullable(this.currentConfigRoom);Q(f1.VERBOSE,{partCreationComponent_onGameStarted:{configRoom:t}}),this.gameStartNotification.emit(t),this.gameStarted=!0,Q(f1.VERBOSE,"PartCreationComponent.onGameStarted finished")}observeNeededPlayers(){var t=this;return I(function*(){const e=Me.getNonNullable(t.currentConfigRoom);Q(f1.VERBOSE,{PartCreationComponent_observeNeededPlayers:{configRoom:e}}),Pe(t.allUserInterval.isAbsent(),"Cannot observe players multiple times"),t.allUserInterval=T.of(window.setInterval(I(function*(){const r=t.lastToken;t.userIsCreator(e)?yield t.checkCandidatesTokensFreshness(r):yield t.checkCreatorTokenFreshness(r)}),f1.TOKEN_INTERVAL))})()}userIsCreator(t){return this.connectedUserService.user.get().id===t.creator.id}checkCreatorTokenFreshness(t){var e=this;return I(function*(){const r=Me.getNonNullable(e.currentConfigRoom);(yield e.didUserTimeout(r.creator.id,t))&&(yield e.destroyDocIfPartDidNotStart())})()}destroyDocIfPartDidNotStart(){var t=this;return I(function*(){Pe(!1===t.isGameStarted(t.currentConfigRoom),"Should not try to cancelGameCreation when part started!"),Pe(!1===t.allDocDeleted,"Should not delete doc twice"),yield t.cancelGameCreation()})()}checkCandidatesTokensFreshness(t){var e=this;return I(function*(){for(const r of e.candidates)(yield e.didUserTimeout(r.id,t))&&(yield e.removeCandidateFromLobby(r))})()}didUserTimeout(t,e){var r=this;return I(function*(){const s=yield r.userService.getUserLastUpdateTime(t);return s.isAbsent()?(As.logError("PartCreationComponent","found no user while observing "+t+" !"),!0):d4e(s.get(),e)>f1.TOKEN_TIMEOUT})()}removeCandidateFromLobby(t){var e=this;return I(function*(){const r=Me.getNonNullable(e.currentConfigRoom);return t.id===r.chosenOpponent?.id&&(yield e.configRoomService.reviewConfigAndRemoveChosenOpponent(e.partId)),e.configRoomService.removeCandidate(e.partId,t)})()}startSendingPresenceTokens(){var t=this;return I(function*(){yield t.connectedUserService.sendPresenceToken(),Pe(t.ownTokenInterval.isAbsent(),"should not start sending presence tokens twice"),t.ownTokenInterval=T.of(window.setInterval(()=>{t.connectedUserService.sendPresenceToken()},f1.TOKEN_INTERVAL));const e=t.connectedUserService.user.get().id;t.selfSubscription=t.userService.observeUser(e,r=>{Pe(r.isPresent(),"connected user should exist");const s=r.get();null!=s.lastUpdateTime&&(t.lastToken=s.lastUpdateTime)})})()}stopSendingPresenceTokensAndObservingUsersIfNeeded(){this.ownTokenInterval.isPresent()&&(window.clearInterval(this.ownTokenInterval.get()),this.ownTokenInterval=T.empty()),this.allUserInterval.isPresent()&&window.clearInterval(this.allUserInterval.get()),this.selfSubscription.unsubscribe()}acceptConfig(){return Q(f1.VERBOSE,"PartCreationComponent.acceptConfig"),this.gameService.acceptConfig(this.partId,Me.getNonNullable(this.currentConfigRoom))}ngOnDestroy(){var t=this;return I(function*(){Q(f1.VERBOSE,"PartCreationComponent.ngOnDestroy"),t.ngUnsubscribe.next(),t.ngUnsubscribe.complete(),t.configRoomSubscription.unsubscribe(),t.candidatesSubscription.unsubscribe(),t.stopSendingPresenceTokensAndObservingUsersIfNeeded();const e=t.connectedUserService.user.get();!0!==t.gameStarted&&(null===t.currentConfigRoom?Q(f1.VERBOSE,"PartCreationComponent.ngOnDestroy: there is no part here"):!0===t.allDocDeleted?Q(f1.VERBOSE,"PartCreationComponent.ngOnDestroy: part has already been deleted"):e.id===t.currentConfigRoom.creator.id?(Q(f1.VERBOSE,"PartCreationComponent.ngOnDestroy: you(creator) about to cancel creation."),yield t.cancelGameCreation()):(Q(f1.VERBOSE,"PartCreationComponent.ngOnDestroy: you are about to cancel game joining"),yield t.observedPartService.removeObservedPart(),yield t.configRoomService.cancelJoining(t.partId)))})()}}function Bft(n,t){if(1&n){const e=Oe();O(0,"button",3),ee("click",function(){return ue(e),ce(C().addTime())}),ve(1,4),A()}if(2&n){const e=C();P(1),x1(e.timeToAdd),B1(1)}}f1.VERBOSE=!1,f1.TOKEN_INTERVAL=5e3,f1.TOKEN_TIMEOUT=2*f1.TOKEN_INTERVAL,f1.\u0275fac=function(t){return new(t||f1)(J(Kn),J(bo),J(Ns),J(b2),J(LS),J(Jz),J(NS),J(vm),J(y7e),J(En))},f1.\u0275cmp=dt({type:f1,selectors:[["app-part-creation"]],inputs:{partId:"partId"},outputs:{gameStartNotification:"gameStartNotification"},decls:1,vars:1,consts:function(){let n,t,e,r,s,i,o,c,u,d,g,m,y,b,k,$,K,oe,ye,te,Le,Ge,Qe,Ft,z1,O1,os,Xc,Uo,H2,Xn,w6,Mt,Wt,Jt,i1;return n=$localize`Game creation`,t=$localize`First player`,e=$localize`Random`,r=$localize`You`,s=$localize`Game type`,i=$localize`Standard`,o=$localize`Maximal turn duration: `,c=$localize`Maximal game duration: ${"\ufffd#37\ufffd"}:START_TAG_STRONG:${"\ufffd0\ufffd"}:INTERPOLATION: per player${"\ufffd/#37\ufffd"}:CLOSE_TAG_STRONG:`,u=$localize`Blitz`,d=$localize`Maximal turn duration: `,g=$localize`Maximal game duration: ${"\ufffd#55\ufffd"}:START_TAG_STRONG:${"\ufffd0\ufffd"}:INTERPOLATION: per player${"\ufffd/#55\ufffd"}:CLOSE_TAG_STRONG:`,m=$localize`Custom`,y=$localize`Opponents`,b=$localize`Propose configuration`,k=$localize`Cancel game`,$=$localize`The opponent`,K=$localize`Maximal turn duration: `,oe=$localize`Maximal game duration: ${"\ufffd#13\ufffd"}:START_TAG_OUTPUT:${"\ufffd0\ufffd"}:INTERPOLATION: per player${"\ufffd/#13\ufffd"}:CLOSE_TAG_OUTPUT:`,ye=$localize`Potential opponents that join the game will appear here.${"\ufffd#2\ufffd\ufffd/#2\ufffd"}:LINE_BREAK:Wait for an opponent to join, so that you can pick one.`,te=$localize`Click on the opponent against which you would like to play.`,Le=$localize`Name`,Ge=$localize`Actions`,Qe=$localize`Pick`,Ft=$localize`Change configuration`,z1=$localize`Configuration proposal`,O1=$localize`You have been selected as the opponent.${"\ufffd#3\ufffd\ufffd/#3\ufffd"}:LINE_BREAK: ${"\ufffd0\ufffd"}:INTERPOLATION: is modifying the configuration.`,os=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: proposes to play a ${"\ufffd1\ufffd"}:INTERPOLATION_1: game`,Xc=$localize`a turn lasts at most ${"\ufffd#10\ufffd"}:START_TAG_STRONG:${"\ufffd0\ufffd"}:INTERPOLATION: ${"\ufffd/#10\ufffd"}:CLOSE_TAG_STRONG:`,Uo=$localize`the game lasts at most ${"\ufffd#14\ufffd"}:START_TAG_STRONG:${"\ufffd0\ufffd"}:INTERPOLATION: per player${"\ufffd/#14\ufffd"}:CLOSE_TAG_STRONG:`,H2=$localize`Accept and start`,Xn=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: plays first`,w6=$localize`you play first`,Mt=$localize`the first player is selected randomly`,Wt=$localize`One moment...`,Jt=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: is configuring the game.`,i1=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: has proposed a configuration to ${"\ufffd1\ufffd"}:INTERPOLATION_1:.`,[["class","box",4,"ngIf"],[1,"box"],[4,"ngIf"],["class","message is-primary",4,"ngIf"],[1,"title"],n,[3,"formGroup"],[3,"disabled"],[1,"field"],["for","firstPlayer",1,"label"],t,[1,"buttons","has-addons"],["id","firstPlayerRandom",1,"button",3,"ngClass","click"],e,["id","firstPlayerCreator",1,"button",3,"ngClass","click"],r,["id","firstPlayerOpponent",1,"button",3,"ngClass","click"],[4,"ngIf","ngIfElse"],["opponentWithoutName",""],s,["id","partTypeStandard",1,"button","dropdown","is-hoverable",3,"ngClass","click"],[1,"dropdown-trigger"],i,["role","menu",1,"dropdown-menu"],[1,"dropdown-content"],[1,"dropdown-item"],o,c,["id","partTypeBlitz",1,"button","dropdown","is-hoverable",3,"ngClass","click"],u,d,g,["id","partTypeCustom",1,"button",3,"ngClass","click"],m,["id","customTime",4,"ngIf"],[1,"label"],y,[1,"control"],["chooseOpponent",""],["id","proposeConfig",1,"button","is-primary",3,"disabled","click"],b,["class","button","id","reviewConfig",3,"click",4,"ngIf"],["id","cancel",1,"button",3,"click"],k,$,["id","customTime"],["for","maximalMoveDuration",1,"label"],K,["step","10","min","10","max","300","name","maximalMoveDuration","formControlName","maximalMoveDuration","type","range",1,"slider","is-circle","is-primary"],["for","totalPartDuration",1,"label"],oe,["step","10","min","10","max","3600","name","totalPartDuration","formControlName","totalPartDuration","type","range",1,"slider","is-circle","is-primary"],ye,te,["id","chooseOpponent",1,"table-container"],[1,"table","is-fullwidth","is-hoverable","is-striped"],["scope","col",1,"th"],Le,Ge,[3,"id","ngClass","click",4,"ngFor","ngForOf"],[3,"id","ngClass","click"],[1,"td",3,"id"],[1,"td"],["class","button is-primary",4,"ngIf"],[1,"button","is-primary"],Qe,["id","reviewConfig",1,"button",3,"click"],Ft,[1,"message","is-primary"],[1,"message-header"],z1,[1,"message-body"],["class","content",4,"ngIf","ngIfElse"],["configProposal",""],[1,"content"],O1,os,Xc,Uo,["id","acceptConfig",1,"button","is-primary",3,"click"],H2,Xn,w6,Mt,Wt,["proposalSent",""],Jt,i1]},template:function(t,e){1&t&&x(0,Fft,4,3,"div",0),2&t&&w("ngIf",e.viewInfo)},dependencies:[fn,On,Kt,bu,S4,Gy,Ll,wu,Ou,_f,Eft],encapsulation:2});let $ft=(()=>{class n{constructor(){this.timeoutHandleGlobal=null,this.timeoutHandleSec=null,this.isPaused=!0,this.isSet=!1,this.started=!1,this.outOfTimeAction=new dr,this.addTimeToOpponent=new dr,this.cssClasses=n.SAFE_TIME}ngOnInit(){Q(n.VERBOSE,"CountDownComponent.ngOnInit ("+this.debugName+")")}setDuration(e){Q(n.VERBOSE,this.debugName+".set("+e+"ms)"),Me.assert(!1===this.started,"Should not set a chrono that has already been started ("+this.debugName+")!"),this.isSet=!0,this.changeDuration(e)}changeDuration(e){let r=!1;!1===this.isPaused&&(this.pause(),r=!0),this.remainingMs=e,this.displayDuration(),r&&this.resume()}displayDuration(){this.displayedSec=this.remainingMs%6e4,this.displayedMinute=(this.remainingMs-this.displayedSec)/6e4,this.displayedSec=Math.floor(this.displayedSec/1e3)}start(){Q(n.VERBOSE,this.debugName+".start("+this.remainingMs+"ms);"),Me.assert(this.isSet,"Should not start a chrono that has not been set!"),Me.assert(!1===this.started,"Should not start chrono that has already been started ("+this.debugName+")"),this.started=!0,this.resume()}resume(){Q(n.VERBOSE,this.debugName+".resume("+this.remainingMs+"ms)"),Me.assert(this.isPaused&&this.started,"Should only resume chrono that are started and paused!"),this.startTime=Date.now();const e=this.remainingMs;this.isPaused=!1,this.timeoutHandleGlobal=window.setTimeout(()=>{this.onEndReached()},e),this.countSeconds()}onEndReached(){Q(n.VERBOSE,this.debugName+".onEndReached"),this.isPaused=!0,this.started=!1,this.clearTimeouts(),this.changeDuration(0),this.outOfTimeAction.emit()}countSeconds(){this.timeoutHandleSec=window.setTimeout(()=>{this.updateShownTime()},1e3)}isIdle(){return!1===this.started||this.isPaused}pause(){Q(n.VERBOSE,this.debugName+".pause("+this.remainingMs+"ms)"),Me.assert(this.started,"Should not pause not started chrono ("+this.debugName+")"),Me.assert(!1===this.isPaused,"Should not pause already paused chrono ("+this.debugName+")"),this.clearTimeouts(),this.isPaused=!0,this.updateShownTime()}stop(){Q(n.VERBOSE,this.debugName+".stop("+this.remainingMs+"ms)"),Me.assert(this.started,"Should only stop chrono that are started!"),this.pause(),this.started=!1,this.isSet=!1}isStarted(){return this.started}getTimeClass(){return!1===this.active?n.PASSIVE_STYLE:this.remainingMs<this.dangerTimeLimit?this.remainingMs%2e3<1e3?n.DANGER_TIME_ODD:n.DANGER_TIME_EVEN:n.SAFE_TIME}updateShownTime(){const e=Date.now();this.remainingMs-=e-this.startTime,this.displayDuration(),this.cssClasses=this.getTimeClass(),this.startTime=e,!1===this.isPaused&&this.countSeconds()}clearTimeouts(){Q(n.VERBOSE,this.debugName+".clearTimeouts"),null!=this.timeoutHandleSec&&(window.clearTimeout(this.timeoutHandleSec),this.timeoutHandleSec=null),null!=this.timeoutHandleGlobal&&(window.clearTimeout(this.timeoutHandleGlobal),this.timeoutHandleGlobal=null)}addTime(){this.addTimeToOpponent.emit()}ngOnDestroy(){this.clearTimeouts()}}return n.VERBOSE=!1,n.DANGER_TIME_EVEN="has-background-danger has-text-white",n.DANGER_TIME_ODD="has-background-warning has-text-white",n.PASSIVE_STYLE="has-text-passive is-italic",n.SAFE_TIME="",n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=dt({type:n,selectors:[["app-count-down"]],inputs:{debugName:"debugName",timeToAdd:"timeToAdd",dangerTimeLimit:"dangerTimeLimit",active:"active",canAddTime:"canAddTime"},outputs:{outOfTimeAction:"outOfTimeAction",addTimeToOpponent:"addTimeToOpponent"},decls:5,vars:7,consts:function(){let t;return t=$localize`Add ${"\ufffd0\ufffd"}:INTERPOLATION:`,[[3,"ngClass"],["id","remainingTime"],["id","addTimeButton","class","button is-small is-fullwidth",3,"click",4,"ngIf"],["id","addTimeButton",1,"button","is-small","is-fullwidth",3,"click"],t]},template:function(e,r){1&e&&(O(0,"div",0)(1,"p",1),Tt(2),Tc(3,"number"),A(),x(4,Bft,2,1,"button",2),A()),2&e&&(w("ngClass",r.getTimeClass()),P(2),ny("",r.displayedMinute,":",tU(3,4,r.displayedSec,"2.0-0"),""),P(2),w("ngIf",r.canAddTime))},dependencies:[fn,Kt,bG],encapsulation:2}),n})();const Uft=["partCreation"],Gft=["chatComponent"],Wft=["chronoZeroGlobal"],qft=["chronoOneGlobal"],jft=["chronoZeroTurn"],Zft=["chronoOneTurn"];function Yft(n,t){if(1&n){const e=Oe();O(0,"app-part-creation",5,6),ee("gameStartNotification",function(s){return ue(e),ce(C().startGame(s))}),A()}2&n&&w("partId",C().currentPartId)}function Kft(n,t){1&n&&(pn(0),O(1,"span",41),ve(2,42),A(),gn())}function Xft(n,t){if(1&n&&(O(0,"span",43),ve(1,44),A()),2&n){const e=C(4);P(1),x1(null==e.currentPlayer?null:e.currentPlayer.name),B1(1)}}function Qft(n,t){if(1&n&&(O(0,"p",38),x(1,Kft,3,0,"ng-container",39),x(2,Xft,2,1,"ng-template",null,40,Zn),A()),2&n){const e=Bn(3),r=C(3);P(1),w("ngIf",(null==r.currentPlayer?null:r.currentPlayer.name)===r.getPlayer().name)("ngIfElse",e)}}function Jft(n,t){if(1&n&&(O(0,"div",34)(1,"p",35),ve(2,36),A(),x(3,Qft,4,2,"p",37),A()),2&n){const e=C(2);P(2),x1(e.currentPart.getTurn()+1),B1(2),P(1),w("ngIf",!1===e.endGame)}}function edt(n,t){if(1&n&&(O(0,"p",45),Tt(1),A()),2&n){const e=C(2);w("ngClass",e.getPlayerNameClass(e.Player.ZERO)),P(1),c1(e.players[0].get().name)}}function tdt(n,t){if(1&n&&(O(0,"p",46),ve(1,47),A()),2&n){const e=C(2);P(1),x1(e.gameComponent.scores.get()[0]),B1(1)}}function ndt(n,t){if(1&n&&(O(0,"p",48),Tt(1),A()),2&n){const e=C(2);w("ngClass",e.getPlayerNameClass(e.Player.ONE)),P(1),c1(e.players[1].get().name)}}function rdt(n,t){if(1&n&&(O(0,"p",49),ve(1,50),A()),2&n){const e=C(2);P(1),x1(e.gameComponent.scores.get()[1]),B1(1)}}function sdt(n,t){if(1&n){const e=Oe();O(0,"button",59),ee("click",function(){return ue(e),ce(C(3).resign())}),ve(1,60),A()}}function idt(n,t){if(1&n){const e=Oe();O(0,"button",61),ee("click",function(){return ue(e),ce(C(3).proposeDraw())}),ve(1,62),A()}}function odt(n,t){if(1&n){const e=Oe();O(0,"button",63),ee("click",function(){return ue(e),ce(C(3).acceptDraw())}),ve(1,64),A()}}function adt(n,t){if(1&n){const e=Oe();O(0,"button",65),ee("click",function(){return ue(e),ce(C(3).refuseDraw())}),ve(1,66),A()}}function cdt(n,t){if(1&n){const e=Oe();O(0,"button",67),ee("click",function(){return ue(e),ce(C(3).gameComponent.pass())}),ve(1,68),A()}}function ldt(n,t){if(1&n){const e=Oe();O(0,"button",69),ee("click",function(){return ue(e),ce(C(3).acceptTakeBack())}),ve(1,70),A()}}function udt(n,t){if(1&n){const e=Oe();O(0,"button",71),ee("click",function(){return ue(e),ce(C(3).refuseTakeBack())}),ve(1,72),A()}}function fdt(n,t){if(1&n){const e=Oe();O(0,"button",73),ee("click",function(){return ue(e),ce(C(3).askTakeBack())}),ve(1,74),A()}}function ddt(n,t){if(1&n&&(pn(0),x(1,sdt,2,0,"button",51),x(2,idt,2,0,"button",52),x(3,odt,2,0,"button",53),x(4,adt,2,0,"button",54),x(5,cdt,2,0,"button",55),x(6,ldt,2,0,"button",56),x(7,udt,2,0,"button",57),x(8,fdt,2,0,"button",58),gn()),2&n){const e=C(2);P(1),w("ngIf",e.canResign()),P(1),w("ngIf",e.canProposeDraw()),P(1),w("ngIf",!1===e.endGame&&e.isOpponentWaitingForDrawResponse()),P(1),w("ngIf",!1===e.endGame&&e.isOpponentWaitingForDrawResponse()),P(1),w("ngIf",!1===e.endGame&&e.isPlaying()&&e.gameComponent.canPass&&(null==e.currentPlayer?null:e.currentPlayer.name)===e.getPlayer().name),P(1),w("ngIf",!1===e.endGame&&e.isOpponentWaitingForTakeBackResponse()),P(1),w("ngIf",!1===e.endGame&&e.isOpponentWaitingForTakeBackResponse()),P(1),w("ngIf",!1===e.endGame&&!1===e.isOpponentWaitingForTakeBackResponse()&&e.canAskTakeBack())}}function hdt(n,t){1&n&&(O(0,"div")(1,"p",76),ve(2,77),A()())}function pdt(n,t){1&n&&(O(0,"p",81),ve(1,82),A())}function gdt(n,t){1&n&&(O(0,"p",83),ve(1,84),A())}function mdt(n,t){1&n&&(O(0,"p",85),ve(1,86),A())}function _dt(n,t){if(1&n&&(O(0,"div"),x(1,pdt,2,0,"p",78),x(2,gdt,2,0,"p",79),x(3,mdt,2,0,"p",80),A()),2&n){const e=C(3);P(1),w("ngIf",e.currentPart.getDrawAccepter().name===e.getPlayer().name),P(1),w("ngIf",e.currentPart.getDrawAccepter().name!==e.getPlayer().name&&e.isPlaying()),P(1),w("ngIf",!1===e.isPlaying())}}function vdt(n,t){1&n&&(O(0,"p",90),ve(1,91),A())}function Cdt(n,t){1&n&&(O(0,"p",92),ve(1,93),A())}function ydt(n,t){if(1&n&&(O(0,"p",94),ve(1,95),A()),2&n){const e=C(4);P(1),x1(e.currentPart.getWinner().get().name),B1(1)}}function Edt(n,t){if(1&n&&(O(0,"div"),x(1,vdt,2,0,"p",87),x(2,Cdt,2,0,"p",88),x(3,ydt,2,1,"p",89),A()),2&n){const e=C(3);P(1),w("ngIf",e.currentPart.getWinner().get().name===e.getPlayer().name),P(1),w("ngIf",e.currentPart.getWinner().get().name!==e.getPlayer().name&&e.isPlaying()),P(1),w("ngIf",!1===e.isPlaying())}}function Mdt(n,t){if(1&n&&(O(0,"p",90),ve(1,96),A()),2&n){const e=C(4);P(1),x1(e.currentPart.getLoser().get().name),B1(1)}}function Sdt(n,t){1&n&&(O(0,"p",94),ve(1,97),A())}function Pdt(n,t){if(1&n&&(O(0,"p",94),ve(1,98),A()),2&n){const e=C(4);P(1),x1(e.currentPart.getLoser().get().name),B1(1)}}function Tdt(n,t){if(1&n&&(O(0,"div"),x(1,Mdt,2,1,"p",87),x(2,Sdt,2,0,"p",89),x(3,Pdt,2,1,"p",89),A()),2&n){const e=C(3);P(1),w("ngIf",e.currentPart.getWinner().get().name===e.getPlayer().name),P(1),w("ngIf",e.currentPart.getWinner().get().name!==e.getPlayer().name&&e.isPlaying()),P(1),w("ngIf",!1===e.isPlaying())}}function wdt(n,t){1&n&&(O(0,"p",100),ve(1,101),A())}function bdt(n,t){if(1&n&&(O(0,"p",100),ve(1,102),A()),2&n){const e=C(4);P(1),x1(e.currentPart.getLoser().get().name),B1(1)}}function Odt(n,t){if(1&n&&(O(0,"div"),x(1,wdt,2,0,"p",99),x(2,bdt,2,1,"p",99),A()),2&n){const e=C(3);P(1),w("ngIf",e.currentPart.getWinner().get().name!==e.getPlayer().name&&e.isPlaying()),P(1),w("ngIf",!1===e.isPlaying()||e.currentPart.getWinner().get().name===e.getPlayer().name)}}function Adt(n,t){if(1&n&&(O(0,"div",75),X(1,"hr"),x(2,hdt,3,0,"div",26),x(3,_dt,4,3,"div",26),x(4,Edt,4,3,"div",26),x(5,Tdt,4,3,"div",26),x(6,Odt,3,2,"div",26),A()),2&n){const e=C(2);P(2),w("ngIf",e.currentPart.isHardDraw()),P(1),w("ngIf",e.currentPart.isAgreedDraw()),P(1),w("ngIf",e.currentPart.isWin()),P(1),w("ngIf",e.currentPart.isTimeout()),P(1),w("ngIf",e.currentPart.isResign())}}function Ndt(n,t){1&n&&(O(0,"button",103),ve(1,104),A())}function Idt(n,t){if(1&n){const e=Oe();O(0,"button",105),ee("click",function(){return ue(e),ce(C(2).proposeRematch())}),ve(1,106),A()}}function xdt(n,t){if(1&n){const e=Oe();O(0,"button",107),ee("click",function(){return ue(e),ce(C(2).acceptRematch())}),ve(1,108),A()}}function kdt(n,t){if(1&n){const e=Oe();O(0,"div",7)(1,"div",8)(2,"div",9),x(3,Jft,4,2,"div",10),O(4,"div",11),x(5,edt,2,2,"p",12),x(6,tdt,2,1,"p",13),O(7,"app-count-down",14,15),ee("outOfTimeAction",function(){ue(e);const s=C();return ce(s.reachedOutOfTime(s.Player.ZERO))})("addTimeToOpponent",function(){return ue(e),ce(C().addGlobalTime())}),A(),O(9,"app-count-down",16,17),ee("outOfTimeAction",function(){ue(e);const s=C();return ce(s.reachedOutOfTime(s.Player.ZERO))})("addTimeToOpponent",function(){return ue(e),ce(C().addTurnTime())}),A()(),O(11,"p",18),ve(12,19),A(),O(13,"div",11),x(14,ndt,2,2,"p",20),x(15,rdt,2,1,"p",21),O(16,"app-count-down",22,23),ee("outOfTimeAction",function(){ue(e);const s=C();return ce(s.reachedOutOfTime(s.Player.ONE))})("addTimeToOpponent",function(){return ue(e),ce(C().addGlobalTime())}),A(),O(18,"app-count-down",24,25),ee("outOfTimeAction",function(){ue(e);const s=C();return ce(s.reachedOutOfTime(s.Player.ONE))})("addTimeToOpponent",function(){return ue(e),ce(C().addTurnTime())}),A()(),X(20,"hr"),x(21,ddt,9,8,"ng-container",26),x(22,Adt,7,5,"div",27),x(23,Ndt,2,0,"button",28),x(24,Idt,2,0,"button",29),x(25,xdt,2,0,"button",30),A()(),O(26,"div",31)(27,"div",32),X(28,"div",null,33),A()()()}if(2&n){const e=C();P(3),w("ngIf",null!==e.currentPart),P(2),w("ngIf",e.players[0].isPresent()),P(1),w("ngIf",null!==e.currentPart&&e.gameComponent&&e.gameComponent.scores.isPresent()),P(1),w("dangerTimeLimit",6e4)("active",null!==e.currentPart&&e.currentPart.getTurn()%2==0)("canAddTime",e.role===e.Player.ONE&&!1===e.endGame)("timeToAdd",e.globalTimeMessage),P(2),w("dangerTimeLimit",15e3)("active",null!==e.currentPart&&e.currentPart.getTurn()%2==0)("canAddTime",e.role===e.Player.ONE&&!1===e.endGame)("timeToAdd",e.turnTimeMessage),P(5),w("ngIf",e.players[1].isPresent()),P(1),w("ngIf",null!==e.currentPart&&e.gameComponent&&e.gameComponent.scores.isPresent()),P(1),w("dangerTimeLimit",6e4)("active",null!==e.currentPart&&e.currentPart.getTurn()%2==1)("canAddTime",e.role===e.Player.ZERO&&!1===e.endGame)("timeToAdd",e.globalTimeMessage),P(2),w("dangerTimeLimit",15e3)("active",null!==e.currentPart&&e.currentPart.getTurn()%2==1)("canAddTime",e.role===e.Player.ZERO&&!1===e.endGame)("timeToAdd",e.turnTimeMessage),P(3),w("ngIf",e.isPlaying()),P(1),w("ngIf",e.endGame&&null!==e.currentPart),P(1),w("ngIf",e.endGame),P(1),w("ngIf",e.endGame&&e.isPlaying()&&!1===e.rematchProposed),P(1),w("ngIf",e.endGame&&e.isPlaying()&&e.rematchProposed&&e.opponentProposedRematch),P(1),w("ngClass",e.getBoardHighlight())}}let Ldt=(()=>{class n{}return n.NO_MATCHING_PART=()=>$localize`The game you tried to join does not exist.`,n})();class Wn{constructor(t){this.value=t}}Wn.PRE_START_DOC=new Wn("PRE_START_DOC"),Wn.STARTING_DOC=new Wn("STARTING_DOC"),Wn.DUPLICATE=new Wn("DUPLICATE"),Wn.MOVE_WITHOUT_TIME=new Wn("MOVE_WITHOUT_TIME"),Wn.MOVE=new Wn("MOVE"),Wn.REQUEST=new Wn("REQUEST"),Wn.END_GAME=new Wn("END_GAME"),Wn.END_GAME_WITHOUT_TIME=new Wn("END_GAME_WITHOUT_TIME"),Wn.ACCEPT_TAKE_BACK_WITHOUT_TIME=new Wn("ACCEPT_TAKE_BACK_WITHOUT_TIME");let Rdt=(()=>{class n extends iT{constructor(e,r,s,i,o,c,u,d){super(e,r,s,i,o),this.observedPartService=c,this.userService=u,this.gameService=d,this.currentPart=null,this.gameStarted=!1,this.opponent=null,this.currentPlayer=null,this.rematchProposed=!1,this.opponentProposedRematch=!1,this.userLinkedToThisPart=!0,this.observedPart=T.empty(),this.hasUserPlayed=[!1,!1],this.msToSubstract=[0,0],this.opponentSubscription=new q1,this.partSubscription=new q1,this.observedPartSubscription=new q1,this.OFFLINE_FONT_COLOR={color:"lightgrey"},this.globalTimeMessage=$localize`5 minutes`,this.turnTimeMessage=$localize`30 seconds`,this.onCurrentUpdateOngoing=!1,Q(n.VERBOSE,"OnlineGameWrapperComponent constructed")}extractPartIdFromURL(){return Me.getNonNullable(this.actRoute.snapshot.paramMap.get("id"))}extractGameNameFromURL(){return Me.getNonNullable(this.actRoute.snapshot.paramMap.get("compo"))}isPlaying(){return this.role.isPlayer()}getPlayer(){return this.authUser.toMinimalUser()}isPlayer(e){return this.role===e}redirectIfPartOrGameIsInvalid(){var e=this;return I(function*(){const r=e.extractGameNameFromURL();if($d.ALL_GAMES().some(i=>i.urlName===r)){if((yield e.gameService.getPartValidity(e.currentPartId,r)).isFailure()){e.routerEventsSubscription.unsubscribe();const o=Ldt.NO_MATCHING_PART();yield e.router.navigate(["/notFound",o],{skipLocationChange:!0})}}else{e.routerEventsSubscription.unsubscribe();const i=Ud.NO_MATCHING_GAME(r);yield e.router.navigate(["/notFound",i],{skipLocationChange:!0})}})()}setCurrentPartIdOrRedirect(){return this.currentPartId=this.extractPartIdFromURL(),this.redirectIfPartOrGameIsInvalid()}ngOnInit(){var e=this;return I(function*(){Q(n.VERBOSE,"OnlineGameWrapperComponent.ngOnInit"),e.routerEventsSubscription=e.router.events.subscribe(function(){var r=I(function*(s){s instanceof I0&&(yield e.setCurrentPartIdOrRedirect())});return function(s){return r.apply(this,arguments)}}()),e.userSubscription=e.connectedUserService.subscribeToUser(r=>{e.authUser=r}),yield e.setCurrentPartIdOrRedirect(),e.observedPartSubscription=e.observedPartService.subscribeToObservedPart(function(){var r=I(function*(s){yield e.onObservedPartUpdate(s)});return function(s){return r.apply(this,arguments)}}()),Q(n.VERBOSE,"OnlineGameWrapperComponent.ngOnInit done")})()}onObservedPartUpdate(e){var r=this;return I(function*(){if(Q(n.VERBOSE,"OnlineGameWrapperComponent.onObservedPartUpdate called"),e.isPresent()){const s=e.get();"Observer"===s.role||s.id===r.currentPartId?r.observedPart=e:(r.userLinkedToThisPart=!1,yield r.router.navigate(["/lobby"]))}else r.observedPart=T.empty()})()}getObservedPart(){return this.observedPart}startGame(e){var r=this;return I(function*(){Q(n.VERBOSE,"OnlineGameWrapperComponent.startGame"),Pe(!1===r.gameStarted,"Should not start already started game"),r.configRoom=e,r.gameStarted=!0,window.setTimeout(I(function*(){Pe(yield r.afterViewInit(),"Game should be created successfully, otherwise part-creation would have redirected"),r.startPart()}),2)})()}startPart(){var e=this;Q(n.VERBOSE,"OnlineGameWrapperComponent.startPart"),this.partSubscription=this.gameService.subscribeToChanges(this.currentPartId,function(){var r=I(function*(s){Pe(s.isPresent(),"OnlineGameWrapper observed a part being deleted, this should not happen"),yield e.onCurrentPartUpdate(s.get())});return function(s){return r.apply(this,arguments)}}())}onCurrentPartUpdate(e,r=5){var s=this;return I(function*(){const i=new xS(s.currentPartId,e);if(Q(n.VERBOSE,{OnlineGameWrapperComponent_onCurrentPartUpdate:{before:s.currentPart,then:e,before_part_turn:i.data.turn,before_state_turn:s.gameComponent.rules.node.gameState.turn,nbPlayedMoves:i.data.listMoves.length}}),s.onCurrentUpdateOngoing)return Pe((r-=1)>0,"Update took more than 5sec to be handled by the component!"),void window.setTimeout(I(function*(){yield s.onCurrentPartUpdate(e,r)}),1e3);s.onCurrentUpdateOngoing=!0;const o=s.getUpdateTypes(i),c=e.turn;o.includes(Wn.REQUEST)?Q(n.VERBOSE,"UpdateType: Request("+Me.getNonNullable(i.data.request).code+") ("+c+")"):Q(n.VERBOSE,"UpdateType: "+o.map(d=>d.value)+"("+c+")");const u=s.currentPart;s.currentPart=i;for(const d of o)yield s.applyUpdate(d,i,u);s.onCurrentUpdateOngoing=!1})()}applyUpdate(e,r,s){var i=this;return I(function*(){switch(e){case Wn.REQUEST:return yield i.onRequest(Me.getNonNullable(r.data.request),s);case Wn.ACCEPT_TAKE_BACK_WITHOUT_TIME:return void(i.currentPart=s);case Wn.DUPLICATE:return;case Wn.END_GAME_WITHOUT_TIME:return void(i.currentPart=s);case Wn.END_GAME:return i.applyEndGame();case Wn.MOVE_WITHOUT_TIME:const o=Me.getNonNullable(i.currentPart),c=Me.getNonNullable(s);return void(o.data={...o.data,turn:o.data.turn-1,lastUpdate:c.data.lastUpdate,lastUpdateTime:c.data.lastUpdateTime,listMoves:o.data.listMoves.slice(0,o.data.listMoves.length-1)});case Wn.MOVE:return i.msToSubstract=i.getLastUpdateTime(s,r),i.doNewMoves(r);case Wn.PRE_START_DOC:return;default:return Pe(e===Wn.STARTING_DOC,"Unexpected update type "+e),i.startCountDown(r)}})()}startCountDown(e){var r=this;return I(function*(){r.setChronos(),yield r.setPlayersDatas(e),r.startCountDownFor(0===e.data.listMoves.length?B.ZERO:B.fromTurn(e.data.turn-1))})()}getUpdateTypes(e){const r=null!=this.currentPart?this.currentPart.data:null,s=Gd.from(r,e.data),i=[];if(Q(n.VERBOSE,{currentPartDoc:r,update:e,diff:s}),0===s.countChanges()&&i.push(Wn.DUPLICATE),s.isFullyCreated()&&s.isPresent("beginning").present&&i.push(Wn.STARTING_DOC),e.data.request){const c=null!=s.removed.lastUpdateTime;i.push("TakeBackAccepted"===e.data.request.code&&c?Wn.ACCEPT_TAKE_BACK_WITHOUT_TIME:Wn.REQUEST)}if(null==r?"added"===s.isPresent("listMoves").state&&e.data.turn>0&&i.push(this.getMoveUpdateType(e,s)):this.turnHasIncreased(r.turn,e.data.turn,e.data.listMoves)&&i.push(this.getMoveUpdateType(e,s)),null==e.data.beginning&&i.push(Wn.PRE_START_DOC),s.isPresent("result").present&&e.data.result!==Dn.UNACHIEVED.value){const c=null!=s.modified.turn,u=!1===s.addedOrModified("lastUpdateTime");i.push(c&&u?Wn.END_GAME_WITHOUT_TIME:Wn.END_GAME)}return i}getMoveUpdateType(e,r){return 1===e.data.turn?null==e.data.lastUpdateTime?Wn.MOVE_WITHOUT_TIME:Wn.MOVE:null==r.modified.lastUpdateTime&&null==r.added.lastUpdateTime?Wn.MOVE_WITHOUT_TIME:Wn.MOVE}turnHasIncreased(e,r,s){return Pe(s.length===r,"ListMoves size and newTurn do not match, it is impossible!"),e<r}getLastUpdateTime(e,r){if(null==e)return[0,0];const s=this.getMoreRecentTime(e),i=this.getMoreRecentTime(r);Pe(null!=s,"oldTime should not be null"),Pe(null!=i,"updateTime should not be null");const o=B.fromTurn(e.data.turn);return this.getTimeUsedForLastTurn(Me.getNonNullable(s),Me.getNonNullable(i),o)}getMoreRecentTime(e){return e.data.lastUpdateTime??e.data.beginning}getTimeUsedForLastTurn(e,r,s){const i=d4e(e,r),o=[0,0];return o[s.value]=i,o}setChronos(){Q(n.VERBOSE,"onlineGameWrapperComponent.setChronos()"),this.chronoZeroGlobal.setDuration(1e3*this.configRoom.totalPartDuration),this.chronoOneGlobal.setDuration(1e3*this.configRoom.totalPartDuration),this.chronoZeroTurn.setDuration(1e3*this.configRoom.maximalMoveDuration),this.chronoOneTurn.setDuration(1e3*this.configRoom.maximalMoveDuration)}didUserPlay(e){return this.hasUserPlayed[e.value]}doNewMoves(e){Q(n.VERBOSE,"OnlineGameWrapperComponent.doNewMoves"+JSON.stringify(e)),this.switchPlayer();const r=Xe.copyImmutableArray(e.data.listMoves),s=this.gameComponent.rules;for(;this.gameComponent.getTurn()<r.length;){const i=this.gameComponent.getTurn(),o=this.gameComponent.encoder.decode(r[i]),c=s.isLegal(o,this.gameComponent.getState()),u=JSON.stringify(r),d="We received an incorrect db move: "+o.toString()+" in "+u+" at turn "+i+'because "'+c.getReasonOr("")+'"';Pe(c.isSuccess(),d,r),s.choose(o)}this.currentPlayer=this.players[this.gameComponent.getTurn()%2].get(),this.gameComponent.updateBoard()}switchPlayer(){Q(n.VERBOSE,"OnlineGameWrapperComponent.switchPlayer");const e=Me.getNonNullable(this.currentPart),r=B.fromTurn(e.data.turn);this.currentPlayer=this.players[this.gameComponent.getTurn()%2].get();const s=r.getOpponent();this.pauseCountDownsFor(s),this.didUserPlay(r)?(Q(n.VERBOSE,"OnlineGameWrapperComponent.onCurrentPartUpdate: changing current player"),this.resumeCountDownFor(r)):this.startCountDownFor(r)}resetChronoFor(e){this.pauseCountDownsFor(e),this.resumeCountDownFor(e)}applyEndGame(){var e=this;return I(function*(){yield e.observedPartService.removeObservedPart();const r=Me.getNonNullable(e.currentPart),s=B.fromTurn(r.data.turn);if(e.endGame=!0,!1===[Dn.VICTORY,Dn.HARD_DRAW].some(c=>c.value===r.data.result)){Pe(!0===[Dn.RESIGN,Dn.TIMEOUT,Dn.HARD_DRAW,Dn.AGREED_DRAW_BY_ZERO,Dn.AGREED_DRAW_BY_ONE].some(g=>g.value===r.data.result),"Unknown type of end game ("+r.data.result+")");const d="endGame is true and winner is "+r.getWinner().getOrElse({id:"fake",name:"no one"}).name;Q(n.VERBOSE,d)}e.stopCountdownsFor(s)})()}notifyDraw(e,r){return this.endGame=!0,this.gameService.updateDBBoard(this.currentPartId,this.role,e,[0,0],r,!0)}notifyTimeoutVictory(e,r,s,i){var o=this;return I(function*(){o.endGame=!0;const c=Me.getNonNullable(o.currentPart).setWinnerAndLoser(e,i);o.currentPart=c,yield o.gameService.notifyTimeout(o.currentPartId,r,s,e,i)})()}notifyVictory(e,r){Q(n.VERBOSE,"OnlineGameWrapperComponent.notifyVictory");const s=this.gameComponent.rules.getGameStatus(this.gameComponent.rules.node),i=Me.getNonNullable(this.currentPart),o=this.players[0].get(),c=this.players[1].get();return s===xe.ONE_WON?this.currentPart=i.setWinnerAndLoser(c,o):(Pe(s===xe.ZERO_WON,"impossible to get a victory without winner!"),this.currentPart=i.setWinnerAndLoser(o,c)),this.endGame=!0,this.gameService.updateDBBoard(this.currentPartId,this.role,e,[0,0],r,!1,this.currentPart.getWinner().get(),this.currentPart.getLoser().get())}canAskTakeBack(){Pe(this.isPlaying(),"Non playing should not call canAskTakeBack"),Pe(null!=this.currentPart,"should not call canAskTakeBack when currentPart is not defined yet");const e=Me.getNonNullable(this.currentPart);return!(e.data.turn<=this.role.value||e.data.request&&"TakeBackRefused"===e.data.request.code&&this.role.isPlayer()&&e.data.request.data.player===this.role.getOpponent().value)&&this.getTakeBackRequester()===he.NONE}isOpponentWaitingForTakeBackResponse(){const e=this.getTakeBackRequester();return!!e.isPlayer()&&e!==this.role}getTakeBackRequester(){const r=Me.getNonNullable(this.currentPart).data.request;return r&&"TakeBackAsked"===r.code?Fr.getPlayer(r):he.NONE}canProposeDraw(){Pe(this.isPlaying(),"Non playing should not call canProposeDraw");const e=Me.getNonNullable(this.currentPart);return!(this.endGame||e.data.request&&"DrawRefused"===e.data.request.code&&this.role.isPlayer()&&Fr.getPlayer(e.data.request)===this.role.getOpponent()||this.isOpponentWaitingForDrawResponse())&&this.getDrawRequester()===he.NONE}isOpponentWaitingForDrawResponse(){const e=this.getDrawRequester();return e!==he.NONE&&e!==this.role}getDrawRequester(){const r=Me.getNonNullable(this.currentPart).data.request;return r&&"DrawProposed"===r.code?Fr.getPlayer(r):he.NONE}onRequest(e,r){var s=this;return I(function*(){switch(Q(n.VERBOSE,{called:"OnlineGameWrapper.onRequest(",request:e,oldPart:r}),e.code){case"TakeBackAsked":case"TakeBackRefused":case"DrawProposed":case"DrawRefused":break;case"TakeBackAccepted":s.takeBackTo(Me.getNonNullable(s.currentPart).data.turn);break;case"RematchProposed":s.rematchProposed=!0;const i=Fr.getPlayer(e).getOpponent();s.isPlayer(i)&&(Q(n.VERBOSE,"ton adversaire te propose une revanche"),s.opponentProposedRematch=!0);break;case"RematchAccepted":yield s.router.navigate(["/nextGameLoading"]),yield s.router.navigate(["/play",Fr.getTypeGame(e),Fr.getPartId(e)]);break;case"AddTurnTime":const o=3e4,c=B.of(e.data.player);s.addTurnTimeTo(c,o);break;default:Me.expectToBe(e.code,"AddGlobalTime","Unknown RequestType : "+e.code+" for "+JSON.stringify(e));const u=3e5,d=B.of(e.data.player);s.addGlobalTimeTo(d,u)}})()}takeBackTo(e){if(Q(n.VERBOSE,"OnlineGameWrapperComponent.takeBackTo"),this.gameComponent.rules.node=this.gameComponent.rules.node.mother.get(),this.gameComponent.getTurn()===e)this.switchPlayer();else{this.gameComponent.rules.node=this.gameComponent.rules.node.mother.get();const r=B.fromTurn(e);this.resetChronoFor(r)}this.gameComponent.updateBoard()}setPlayersDatas(e){var r=this;return I(function*(){Q(n.VERBOSE,{OnlineGameWrapper_setPlayersDatas:e}),r.players=[T.of(e.data.playerZero),T.ofNullable(e.data.playerOne)],Pe(null!=e.data.playerOne,"should not setPlayersDatas when players data is not received"),r.currentPlayer=r.players[e.data.turn%2].get();const s=yield r.setRealObserverRole();if(s.isPresent()){const i=o=>{Pe(o.isPresent(),"opponent was deleted, what sorcery is this"),r.opponent=s.get()};r.opponentSubscription=r.userService.observeUser(s.get().id,i)}})()}setRealObserverRole(){var e=this;return I(function*(){let r=T.empty();return e.players[0].equalsValue(e.getPlayer())?(e.setRole(B.ZERO),r=e.players[1]):e.players[1].equalsValue(e.getPlayer())?(e.setRole(B.ONE),r=e.players[0]):e.setRole(he.NONE),yield e.observedPartService.updateObservedPart({...e.observedPart.get(),role:e.role===he.NONE?"Observer":"Player"}),r})()}onLegalUserMove(e,r){var s=this;return I(function*(){if(Q(n.VERBOSE,"dans OnlineGameWrapperComponent.onLegalUserMove"),!s.isOpponentWaitingForTakeBackResponse())return s.updateDBBoard(e,s.msToSubstract,r);s.gameComponent.message("You must answer to take back request")})()}updateDBBoard(e,r,s){var i=this;return I(function*(){const o=i.gameComponent.encoder.encodeMove(e);Q(n.VERBOSE,"OnlineGameWrapperComponent.updateDBBoard("+e.toString()+", "+s+")"),i.gameComponent.rules.choose(e);const c=i.gameComponent.rules.getGameStatus(i.gameComponent.rules.node);return c.isEndGame?c===xe.DRAW?i.notifyDraw(o,s):i.notifyVictory(o,s):i.gameService.updateDBBoard(i.currentPartId,i.role,o,r,s)})()}resign(){var e=this;return I(function*(){Q(n.VERBOSE,"OnlineGameWrapperComponent.resign");const r=e.getLastIndex(),s=e.role,i=e.getPlayer(),o=e.players[(e.role.value+1)%2].get();yield e.gameService.resign(e.currentPartId,r,s,o,i)})()}getLastIndex(){return Me.getNonNullable(this.currentPart).data.lastUpdate.index}reachedOutOfTime(e){var r=this;return I(function*(){Q(n.VERBOSE,"OnlineGameWrapperComponent.reachedOutOfTime("+e+")");const s=r.getLastIndex(),i=r.role;if(r.stopCountdownsFor(e),!1===r.isPlaying())return;const o=Me.getNonNullable(r.opponent);e===r.role?yield r.notifyTimeoutVictory(o,i,s,r.authUser.toMinimalUser()):(Pe(!1===r.endGame,"time might be better handled in the future"),r.opponentIsOffline()&&(yield r.notifyTimeoutVictory(r.authUser.toMinimalUser(),i,e.value,o),r.endGame=!0))})()}acceptRematch(){var e=this;return I(function*(){Pe(e.isPlaying(),"Non playing should not call acceptRematch");const r=new xS(e.currentPartId,Me.getNonNullable(e.currentPart).data);return yield e.gameService.acceptRematch(r,e.getLastIndex(),e.role),!0})()}proposeRematch(){var e=this;return I(function*(){return Pe(e.isPlaying(),"Non playing should not call proposeRematch"),yield e.gameService.proposeRematch(e.currentPartId,e.getLastIndex(),e.role),!0})()}proposeDraw(){return Pe(this.isPlaying(),"Non playing should not call proposeDraw"),this.gameService.proposeDraw(this.currentPartId,this.getLastIndex(),this.role)}acceptDraw(){return Pe(this.isPlaying(),"Non playing should not call acceptDraw"),this.gameService.acceptDraw(this.currentPartId,this.getLastIndex(),this.role)}refuseDraw(){return Pe(this.isPlaying(),"Non playing should not call refuseDraw"),this.gameService.refuseDraw(this.currentPartId,this.getLastIndex(),this.role)}askTakeBack(){return Pe(this.isPlaying(),"Non playing should not call askTakeBack"),this.gameService.askTakeBack(this.currentPartId,this.getLastIndex(),this.role)}acceptTakeBack(){var e=this;return I(function*(){Pe(e.isPlaying(),"Non playing should not call acceptTakeBack");const r=e.role;yield e.gameService.acceptTakeBack(e.currentPartId,Me.getNonNullable(e.currentPart),r,e.msToSubstract),e.msToSubstract=[0,0]})()}refuseTakeBack(){return Pe(this.isPlaying(),"Non playing should not call refuseTakeBack"),this.gameService.refuseTakeBack(this.currentPartId,this.getLastIndex(),this.role)}startCountDownFor(e){Q(n.VERBOSE,"dans OnlineGameWrapperComponent.startCountDownFor("+e.toString()+") (turn "+Me.getNonNullable(this.currentPart).data.turn+")"),this.hasUserPlayed[e.value]=!0,e===B.ZERO?(this.chronoZeroGlobal.start(),this.chronoZeroTurn.start()):(this.chronoOneGlobal.start(),this.chronoOneTurn.start())}resumeCountDownFor(e,r=!0){let s;Q(n.VERBOSE,"dans OnlineGameWrapperComponent.resumeCountDownFor("+e.toString()+") (turn "+Me.getNonNullable(this.currentPart).data.turn+")"),e===B.ZERO?(this.chronoZeroGlobal.changeDuration(Me.getNonNullable(this.currentPart?.data.remainingMsForZero)),this.chronoZeroGlobal.resume(),s=this.chronoZeroTurn):(this.chronoOneGlobal.changeDuration(Me.getNonNullable(this.currentPart?.data.remainingMsForOne)),this.chronoOneGlobal.resume(),s=this.chronoOneTurn),r?(s.setDuration(1e3*this.configRoom.maximalMoveDuration),s.start()):s.resume()}pauseCountDownsFor(e,r=!0){let s;Q(n.VERBOSE,"dans OnlineGameWrapperComponent.pauseCountDownFor("+e.value+") (turn "+this.currentPart?.data.turn+")"),e===B.ZERO?(this.chronoZeroGlobal.pause(),s=this.chronoZeroTurn):(this.chronoOneGlobal.pause(),s=this.chronoOneTurn),r?s.stop():s.pause()}stopCountdownsFor(e){Q(n.VERBOSE,"cdc::stopCountDownsFor("+e.toString()+") (turn "+this.currentPart?.data.turn+")"),e===B.ZERO?(this.chronoZeroGlobal.isStarted()&&this.chronoZeroGlobal.stop(),this.chronoZeroTurn.isStarted()&&this.chronoZeroTurn.stop()):(this.chronoOneGlobal.isStarted()&&this.chronoOneGlobal.stop(),this.chronoOneTurn.isStarted()&&this.chronoOneTurn.stop())}getPlayerNameClass(e){return this.opponentIsOffline()?"has-text-grey-light":e===B.ZERO?"has-text-white":"has-text-black"}opponentIsOffline(){return!1}canResign(){return Pe(this.isPlaying(),"Non playing should not call canResign"),!0!==this.endGame&&null!=this.opponent}addGlobalTime(){const e=this.role,r=this.getLastIndex();return this.gameService.addGlobalTime(this.currentPartId,r,Me.getNonNullable(this.currentPart).data,e)}addTurnTime(){return this.gameService.addTurnTime(this.role,this.getLastIndex(),this.currentPartId)}addTurnTimeTo(e,r){const s=B.fromTurn(Me.getNonNullable(this.currentPart).getTurn());this.pauseCountDownsFor(s,!1),e===B.ZERO?this.chronoZeroTurn.changeDuration(this.chronoZeroTurn.remainingMs+r):this.chronoOneTurn.changeDuration(this.chronoOneTurn.remainingMs+r),this.resumeCountDownFor(s,!1)}addGlobalTimeTo(e,r){e===B.ZERO?this.chronoZeroGlobal.changeDuration(this.chronoZeroGlobal.remainingMs+r):this.chronoOneGlobal.changeDuration(this.chronoOneGlobal.remainingMs+r)}onCancelMove(e){if(this.gameComponent.rules.node.move.isPresent()){const r=this.gameComponent.rules.node.move.get();this.gameComponent.showLastMove(r)}}ngOnDestroy(){var e=this;return I(function*(){Q(n.VERBOSE,"OnlineGameWrapperComponent.ngOnDestroy"),e.routerEventsSubscription.unsubscribe(),e.userSubscription.unsubscribe(),e.observedPartSubscription.unsubscribe(),!1===e.isPlaying()&&e.userLinkedToThisPart&&(yield e.observedPartService.removeObservedPart()),!0===e.gameStarted&&(e.opponentSubscription.unsubscribe(),e.partSubscription.unsubscribe()),Q(n.VERBOSE,"OnlineGameWrapperComponent.ngOnDestroy finished")})()}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(J(xa),J(bo),J(Ns),J(Kn),J(En),J(b2),J(vm),J(LS))},n.\u0275cmp=dt({type:n,selectors:[["app-online-game-wrapper"]],viewQuery:function(e,r){if(1&e&&(C4(Uft,5),C4(Gft,5),C4(Wft,5),C4(qft,5),C4(jft,5),C4(Zft,5)),2&e){let s;wc(s=bc())&&(r.partCreation=s.first),wc(s=bc())&&(r.chatComponent=s.first),wc(s=bc())&&(r.chronoZeroGlobal=s.first),wc(s=bc())&&(r.chronoOneGlobal=s.first),wc(s=bc())&&(r.chronoZeroTurn=s.first),wc(s=bc())&&(r.chronoOneTurn=s.first)}},features:[l],decls:5,vars:4,consts:function(){let t,e,r,s,i,o,c,u,d,g,m,y,b,k,$,K,oe,ye,te,Le,Ge,Qe,Ft,z1,O1,os,Xc,Uo,H2;return t=$localize`vs.`,e=$localize`Turn n${"\ufffd0\ufffd"}:INTERPOLATION:`,r=$localize`It is your turn.`,s=$localize`It is ${"\ufffd0\ufffd"}:INTERPOLATION:'s turn.`,i=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: points`,o=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: points`,c=$localize`Resign`,u=$localize`Propose a draw`,d=$localize`Accept draw`,g=$localize`Reject draw`,m=$localize`Pass a turn`,y=$localize`Accept take back`,b=$localize`Reject take back`,k=$localize`Ask to take back one move`,$=$localize`Draw`,K=$localize`You agreed to draw.`,oe=$localize`Your draw proposal has been accepted.`,ye=$localize`Players agreed to draw.`,te=$localize`You won.`,Le=$localize`You lost.`,Ge=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: won.`,Qe=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: has reached their time limit. You won.`,Ft=$localize`You reached your time limit.`,z1=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: has reached their time limit.`,O1=$localize`You resigned.`,os=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: has resigned.`,Xc=$localize`Go back to the game list`,Uo=$localize`Propose to play again`,H2=$localize`Accept to play again`,[["id","partCreation",3,"partId","gameStartNotification",4,"ngIf"],["id","game","class","tile is-ancestor",4,"ngIf"],[1,"block","mt-2"],["id","chat",1,"box"],[3,"chatId","turn"],["id","partCreation",3,"partId","gameStartNotification"],["partCreation",""],["id","game",1,"tile","is-ancestor"],[1,"tile","is-parent"],[1,"tile","is-child","box","has-text-centered"],["class","block","id","turnIndicator",4,"ngIf"],[1,"block"],["id","playerZeroIndicator","class","player0-bg",3,"ngClass",4,"ngIf"],["id","scoreZeroIndicator",4,"ngIf"],["debugName","ZERO Global",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoZeroGlobal",""],["debugName","ZERO Turn",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoZeroTurn",""],[1,"is-size-3"],t,["id","playerOneIndicator","class","player1-bg",3,"ngClass",4,"ngIf"],["id","scoreOneIndicator",4,"ngIf"],["debugName","ONE Global",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoOneGlobal",""],["debugName","ONE Turn",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoOneTurn",""],[4,"ngIf"],["class","block","id","winnerIndicator",4,"ngIf"],["class","button is-primary is-fullwidth mb-1","id","backToServerButton","routerLink","/lobby",4,"ngIf"],["id","proposeRematchButton","class","button is-fullwidth mb-1",3,"click",4,"ngIf"],["class","button is-fullwidth is-warning","id","acceptRematchButton",3,"click",4,"ngIf"],["id","board-tile",1,"tile","is-9","is-parent","rounded-div",3,"ngClass"],["id","board",1,"tile","is-child","box"],["board",""],["id","turnIndicator",1,"block"],[1,"subtitle"],e,["class","subtitle","id","currentPlayerIndicator",4,"ngIf"],["id","currentPlayerIndicator",1,"subtitle"],[4,"ngIf","ngIfElse"],["opponentsTurn",""],["id","playerTurn"],r,["id","opponentTurn"],s,["id","playerZeroIndicator",1,"player0-bg",3,"ngClass"],["id","scoreZeroIndicator"],i,["id","playerOneIndicator",1,"player1-bg",3,"ngClass"],["id","scoreOneIndicator"],o,["class","button is-fullwidth mb-1","id","resignButton",3,"click",4,"ngIf"],["class","button is-fullwidth mb-1","id","proposeDrawButton",3,"click",4,"ngIf"],["class","button is-warning is-fullwidth mb-1","id","acceptDrawButton",3,"click",4,"ngIf"],["class","button is-warning is-fullwidth mb-1","id","refuseDrawButton",3,"click",4,"ngIf"],["class","button is-fullwidth mb-1","id","passButton",3,"click",4,"ngIf"],["class","button is-warning is-fullwidth mb-1","id","acceptTakeBackButton",3,"click",4,"ngIf"],["class","button is-warning is-fullwidth mb-1","color","warn","id","refuseTakeBackButton",3,"click",4,"ngIf"],["class","button is-fullwidth","id","askTakeBackButton",3,"click",4,"ngIf"],["id","resignButton",1,"button","is-fullwidth","mb-1",3,"click"],c,["id","proposeDrawButton",1,"button","is-fullwidth","mb-1",3,"click"],u,["id","acceptDrawButton",1,"button","is-warning","is-fullwidth","mb-1",3,"click"],d,["id","refuseDrawButton",1,"button","is-warning","is-fullwidth","mb-1",3,"click"],g,["id","passButton",1,"button","is-fullwidth","mb-1",3,"click"],m,["id","acceptTakeBackButton",1,"button","is-warning","is-fullwidth","mb-1",3,"click"],y,["color","warn","id","refuseTakeBackButton",1,"button","is-warning","is-fullwidth","mb-1",3,"click"],b,["id","askTakeBackButton",1,"button","is-fullwidth",3,"click"],k,["id","winnerIndicator",1,"block"],["id","hardDrawIndicator",1,"title"],$,["class","title","id","youAgreedToDrawIndicator",4,"ngIf"],["class","title","id","yourOpponentAgreedToDrawIndicator",4,"ngIf"],["class","title","id","playersAgreedToDraw",4,"ngIf"],["id","youAgreedToDrawIndicator",1,"title"],K,["id","yourOpponentAgreedToDrawIndicator",1,"title"],oe,["id","playersAgreedToDraw",1,"title"],ye,["class","title","id","youWonIndicator",4,"ngIf"],["class","title","id","youLostIndicator",4,"ngIf"],["class","title",4,"ngIf"],["id","youWonIndicator",1,"title"],te,["id","youLostIndicator",1,"title"],Le,[1,"title"],Ge,Qe,Ft,z1,["class","title","id","resignIndicator",4,"ngIf"],["id","resignIndicator",1,"title"],O1,os,["id","backToServerButton","routerLink","/lobby",1,"button","is-primary","is-fullwidth","mb-1"],Xc,["id","proposeRematchButton",1,"button","is-fullwidth","mb-1",3,"click"],Uo,["id","acceptRematchButton",1,"button","is-fullwidth","is-warning",3,"click"],H2]},template:function(e,r){1&e&&(x(0,Yft,2,1,"app-part-creation",0),x(1,kdt,30,27,"div",1),O(2,"div",2)(3,"div",3),X(4,"app-chat",4),A()()),2&e&&(w("ngIf",!1===r.gameStarted),P(1),w("ngIf",r.gameStarted),P(3),w("chatId",r.currentPartId)("turn",null==r.currentPart?null:r.currentPart.getTurn()))},dependencies:[fn,Kt,Gp,c4e,f1,$ft],encapsulation:2}),n})();function Ddt(n,t){if(1&n&&(O(0,"option",26),Tt(1),A()),2&n){const e=t.$implicit;w("value",e.name),P(1),c1(e.name)}}function zdt(n,t){if(1&n&&(O(0,"option",26),ve(1,30),A()),2&n){const e=t.$implicit;w("value",e),P(1),x1(e),B1(1)}}const Vdt=function(){return[1,2,3,4,5,6,7,8,9,10,11,12]};function Hdt(n,t){if(1&n){const e=Oe();O(0,"select",27),ee("ngModelChange",function(s){return ue(e),ce(C(2).aiDepths[0]=s)})("change",function(){ue(e);const s=C(2);return ce(s.updatePlayer(s.Player.ZERO))}),O(1,"option",28),ve(2,29),A(),x(3,zdt,2,2,"option",17),A()}2&n&&(w("ngModel",C(2).aiDepths[0]),P(3),w("ngForOf",J1(2,Vdt)))}function Fdt(n,t){if(1&n&&(O(0,"p",31),ve(1,32),A()),2&n){const e=C(2);P(1),x1(e.gameComponent.scores.get()[0]),B1(1)}}function Bdt(n,t){if(1&n&&(O(0,"option",26),Tt(1),A()),2&n){const e=t.$implicit;w("value",e.name),P(1),c1(e.name)}}function $dt(n,t){if(1&n&&(O(0,"option",26),ve(1,35),A()),2&n){const e=t.$implicit;w("value",e),P(1),x1(e),B1(1)}}const Udt=function(){return[1,2,3,4,5,6,7,8,9,10]};function Gdt(n,t){if(1&n){const e=Oe();O(0,"select",33),ee("ngModelChange",function(s){return ue(e),ce(C(2).aiDepths[1]=s)})("change",function(){ue(e);const s=C(2);return ce(s.updatePlayer(s.Player.ONE))}),O(1,"option",28),ve(2,34),A(),x(3,$dt,2,2,"option",17),A()}2&n&&(w("ngModel",C(2).aiDepths[1]),P(3),w("ngForOf",J1(2,Udt)))}function Wdt(n,t){if(1&n&&(O(0,"p",36),ve(1,37),A()),2&n){const e=C(2);P(1),x1(e.gameComponent.scores.get()[1]),B1(1)}}function qdt(n,t){if(1&n&&(O(0,"h4",41),Tt(1),A()),2&n){const e=C(3);P(1),c1(e.winnerMessage.get())}}function jdt(n,t){1&n&&(O(0,"h4",42),ve(1,43),A())}function Zdt(n,t){if(1&n&&(O(0,"div",38),x(1,qdt,2,1,"h4",39),x(2,jdt,2,0,"h4",40),A()),2&n){const e=C(2);P(1),w("ngIf",e.winnerMessage.isPresent()),P(1),w("ngIf",e.winnerMessage.isAbsent())}}function Ydt(n,t){if(1&n){const e=Oe();O(0,"div",7)(1,"div",8)(2,"p",9),ve(3,10),A()(),O(4,"div",11)(5,"div",12)(6,"div",13)(7,"select",14),ee("change",function(){ue(e);const s=C();return ce(s.updatePlayer(s.Player.ZERO))})("ngModelChange",function(s){return ue(e),ce(C().playerSelection[0]=s)}),O(8,"option",15),ve(9,16),A(),x(10,Ddt,2,2,"option",17),A()(),O(11,"div",13),x(12,Hdt,4,3,"select",18),A(),x(13,Fdt,2,1,"p",19),A(),O(14,"div",20)(15,"div",13)(16,"select",21),ee("change",function(){ue(e);const s=C();return ce(s.updatePlayer(s.Player.ONE))})("ngModelChange",function(s){return ue(e),ce(C().playerSelection[1]=s)}),O(17,"option",15),ve(18,22),A(),x(19,Bdt,2,2,"option",17),A()(),O(20,"div",13),x(21,Gdt,4,3,"select",23),A(),x(22,Wdt,2,1,"p",24),A()(),x(23,Zdt,3,2,"div",25),A()}if(2&n){const e=C();P(3),x1(e.gameComponent.getTurn()+1),B1(3),P(4),w("ngModel",e.playerSelection[0]),P(3),w("ngForOf",e.gameComponent.availableMinimaxes),P(2),w("ngIf",!1===e.players[0].equalsValue("human")),P(1),w("ngIf",e.gameComponent.scores.isPresent()),P(3),w("ngModel",e.playerSelection[1]),P(3),w("ngForOf",e.gameComponent.availableMinimaxes),P(2),w("ngIf",!1===e.players[1].equalsValue("human")),P(1),w("ngIf",e.gameComponent.scores.isPresent()),P(1),w("ngIf",e.endGame)}}function Kdt(n,t){if(1&n){const e=Oe();O(0,"button",50),ee("click",function(){return ue(e),ce(C(2).gameComponent.pass())}),ve(1,51),A()}}function Xdt(n,t){if(1&n){const e=Oe();O(0,"button",52),ee("click",function(){return ue(e),ce(C(2).takeBack())}),ve(1,53),A()}}function Qdt(n,t){if(1&n&&(pn(0),Tt(1),X(2,"br"),gn()),2&n){const e=t.$implicit,r=C(3);P(1),Z2(" ",e.name+": "+e.getBoardValue(r.gameComponent.rules.node)," ")}}function Jdt(n,t){if(1&n&&(O(0,"div",54),x(1,Qdt,3,1,"ng-container",55),Tt(2),X(3,"br"),Tt(4),X(5,"br"),A()),2&n){const e=C(2);P(1),w("ngForOf",e.gameComponent.availableMinimaxes),P(1),Z2(" Created ",e.getCreatedNodes()," nodes."),P(2),Z2(" Minimax time: ",e.getMinimaxTime(),"ms.")}}function eht(n,t){if(1&n){const e=Oe();O(0,"div",44),x(1,Kdt,2,0,"button",45),x(2,Xdt,2,0,"button",46),O(3,"button",47),ee("click",function(){return ue(e),ce(C().restartGame())}),ve(4,48),A(),x(5,Jdt,6,3,"div",49),A()}if(2&n){const e=C();P(1),w("ngIf",!1===e.endGame&&e.gameComponent.canPass),P(1),w("ngIf",e.canTakeBack()),P(3),w("ngIf",e.gameComponent.rules.node.move.isPresent()&&e.displayAIMetrics)}}let tht=(()=>{class n extends iT{constructor(e,r,s,i,o,c){super(e,r,s,i,o),this.cdr=c,this.aiDepths=["0","0"],this.playerSelection=["human","human"],this.winnerMessage=T.empty(),this.botTimeOut=1e3,this.displayAIMetrics=!1,this.players=[T.of(this.playerSelection[0]),T.of(this.playerSelection[1])],this.role=B.ZERO,Q(n.VERBOSE,"LocalGameWrapper.constructor")}getCreatedNodes(){return CP.createdNodes}getMinimaxTime(){return CP.minimaxTime}ngAfterViewInit(){var e=this;setTimeout(I(function*(){(yield e.afterViewInit())&&(e.restartGame(),e.cdr.detectChanges())}),1)}updatePlayer(e){this.players[e.value]=T.of(this.playerSelection[e.value]),this.setRole("human"===this.playerSelection[1]&&"human"!==this.playerSelection[0]?B.ONE:B.ZERO),this.proposeAIToPlay()}onLegalUserMove(e){var r=this;return I(function*(){Q(n.VERBOSE,"LocalGameWrapperComponent.onLegalUserMove"),r.gameComponent.rules.choose(e),r.updateBoard(),r.proposeAIToPlay()})()}updateBoard(){this.updateBoardAndShowLastMove();const e=this.gameComponent.rules.getGameStatus(this.gameComponent.rules.node);if(!0===e.isEndGame&&(this.endGame=!0,e.winner.isPlayer())){const r=$localize`Player ${e.winner.value+1}`,i=e.winner.getOpponent().value;this.winnerMessage=this.players[e.winner.value].equalsValue("human")?this.players[i].equalsValue("human")?T.of($localize`${r} won`):T.of($localize`You won`):this.players[i].equalsValue("human")?T.of($localize`You lost`):T.of($localize`${this.players[e.winner.value].get()} (Player ${e.winner.value+1}) won`)}}proposeAIToPlay(){var e=this;const r=this.getPlayingAI();r.isPresent()&&window.setTimeout(I(function*(){yield e.doAIMove(r.get())}),this.botTimeOut)}getPlayingAI(){if(this.gameComponent.rules.getGameStatus(this.gameComponent.rules.node).isEndGame)return T.empty();const e=this.gameComponent.getTurn()%2;return"0"===this.aiDepths[e]?T.empty():T.ofNullable(this.gameComponent.availableMinimaxes.find(r=>this.players[e].equalsValue(r.name)))}doAIMove(e){var r=this;return I(function*(){const s=r.gameComponent.rules;Pe(s.getGameStatus(s.node)===xe.ONGOING,"AI should not try to play when game is over!");const c=Number.parseInt(r.aiDepths[s.node.gameState.turn%2%2]),u=s.node.findBestMove(c,e,!0);return s.choose(u)?(r.updateBoard(),r.cdr.detectChanges(),r.proposeAIToPlay(),R.SUCCESS):(r.messageDisplayer.criticalMessage($localize`The AI chose an illegal move! This is an unexpected situation that we logged, we will try to solve this as soon as possible. In the meantime, consider that you won!`),As.logError("LocalGameWrapper","AI chose illegal move",{name:e.name,move:u.toString()}))})()}canTakeBack(){return this.gameComponent.getTurn()>0}takeBack(){this.gameComponent.rules.node=this.gameComponent.rules.node.mother.get(),this.isAITurn()&&(this.gameComponent.rules.node=this.gameComponent.rules.node.mother.get()),this.updateBoardAndShowLastMove()}updateBoardAndShowLastMove(){if(this.gameComponent.updateBoard(),this.gameComponent.rules.node.move.isPresent()){const e=this.gameComponent.rules.node.move.get();this.gameComponent.showLastMove(e)}}isAITurn(){return this.getPlayingAI().isPresent()}restartGame(){this.gameComponent.rules.setInitialBoard(),this.gameComponent.updateBoard(),this.endGame=!1,this.winnerMessage=T.empty(),this.proposeAIToPlay()}getPlayer(){return"human"}onCancelMove(e){if(this.gameComponent.rules.node.move.isPresent()){const r=this.gameComponent.rules.node.move.get();this.gameComponent.showLastMove(r)}}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(J(xa),J(bo),J(Ns),J(Kn),J(En),J(Mu))},n.\u0275cmp=dt({type:n,selectors:[["app-local-game-wrapper"]],features:[l],decls:8,vars:3,consts:function(){let t,e,r,s,i,o,c,u,d,g,m,y,b;return t=$localize`Turn n${"\ufffd0\ufffd"}:INTERPOLATION:`,e=$localize`Human`,r=$localize`Human`,s=$localize`Pick the level`,i=$localize`Level ${"\ufffd0\ufffd"}:INTERPOLATION:`,o=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: points`,c=$localize`Pick the level`,u=$localize`Level ${"\ufffd0\ufffd"}:INTERPOLATION:`,d=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: points`,g=$localize`Draw`,m=$localize`Start a new game`,y=$localize`Pass a turn`,b=$localize`Take back move`,[[1,"tile","is-ancestor"],[1,"tile","is-3","is-vertical","is-parent"],["class","tile is-child box has-text-centered","id","info",4,"ngIf"],["class","tile is-child box is-vcentered",4,"ngIf"],[1,"tile","is-parent","is-9","is-vcentered",3,"ngClass"],["id","board",1,"tile","is-child","box"],["board",""],["id","info",1,"tile","is-child","box","has-text-centered"],["id","turnIndicator",1,"block"],[1,"subtitle"],t,["id","playerSelector",1,"columns"],[1,"column","is-6","is-vcentered"],[1,"select"],["id","playerZeroSelect",3,"ngModel","change","ngModelChange"],["selected","","value","human"],e,[3,"value",4,"ngFor","ngForOf"],["id","aiZeroDepthSelect",3,"ngModel","ngModelChange","change",4,"ngIf"],["id","scoreOne","class","block",4,"ngIf"],[1,"column","is-6"],["id","playerOneSelect",3,"ngModel","change","ngModelChange"],r,["id","aiOneDepthSelect",3,"ngModel","ngModelChange","change",4,"ngIf"],["id","scoreZero","class","block",4,"ngIf"],["id","gameResult","class","block",4,"ngIf"],[3,"value"],["id","aiZeroDepthSelect",3,"ngModel","ngModelChange","change"],["selected","","value","0"],s,i,["id","scoreOne",1,"block"],o,["id","aiOneDepthSelect",3,"ngModel","ngModelChange","change"],c,u,["id","scoreZero",1,"block"],d,["id","gameResult",1,"block"],["id","winner",4,"ngIf"],["id","draw",4,"ngIf"],["id","winner"],["id","draw"],g,[1,"tile","is-child","box","is-vcentered"],["id","passButton","class","button is-primary is-fullwidth mb-1",3,"click",4,"ngIf"],["id","takeBack","class","button is-fullwidth mb-1",3,"click",4,"ngIf"],["id","restartButton",1,"button","is-fullwidth",3,"click"],m,["id","AIMetrics",4,"ngIf"],["id","passButton",1,"button","is-primary","is-fullwidth","mb-1",3,"click"],y,["id","takeBack",1,"button","is-fullwidth","mb-1",3,"click"],b,["id","AIMetrics"],[4,"ngFor","ngForOf"]]},template:function(e,r){1&e&&(O(0,"div",0)(1,"div",1),x(2,Ydt,24,10,"div",2),x(3,eht,6,3,"div",3),A(),O(4,"div",4)(5,"div",5),X(6,"div",null,6),A()()()),2&e&&(P(2),w("ngIf",r.gameComponent),P(1),w("ngIf",r.gameComponent),P(1),w("ngClass",r.getBoardHighlight()))},dependencies:[fn,On,Kt,wp,bp,Wy,Ll,Tp],encapsulation:2,changeDetection:0}),n})(),h4e=(()=>{class n{}return n.STEP_FINISHED=()=>$localize`Step finished!`,n.INFORMATIONAL_STEP=()=>$localize`This step is not expecting any move from your part.`,n})();function nht(n,t){if(1&n&&(O(0,"div",21)(1,"div",22),ve(2,23),A(),X(3,"div",24),A()),2&n){const e=C();P(3),w("innerHTML",e.currentReason.get(),nu)}}function rht(n,t){if(1&n){const e=Oe();O(0,"button",25),ee("click",function(){return ue(e),ce(C().retry())}),ve(1,26),A()}}function sht(n,t){1&n&&(pn(0),ve(1,31),gn())}function iht(n,t){1&n&&(pn(0),ve(1,32),gn())}function oht(n,t){if(1&n&&x(0,iht,2,0,"ng-container",28),2&n){C();const e=Bn(5),r=C();w("ngIf",r.stepFinished&&r.stepFinished[r.stepIndex])("ngIfElse",e)}}function aht(n,t){1&n&&(pn(0),ve(1,33),gn())}function cht(n,t){if(1&n){const e=Oe();O(0,"button",27),ee("click",function(){return ue(e),ce(C().next())}),x(1,sht,2,0,"ng-container",28),x(2,oht,1,2,"ng-template",null,29,Zn),x(4,aht,2,0,"ng-template",null,30,Zn),A()}if(2&n){const e=Bn(3),r=C();P(1),w("ngIf",r.steps[r.stepIndex]&&r.steps[r.stepIndex].isInformation())("ngIfElse",e)}}function lht(n,t){if(1&n){const e=Oe();O(0,"button",34),ee("click",function(){return ue(e),ce(C().start())}),ve(1,35),A()}}function uht(n,t){if(1&n){const e=Oe();O(0,"button",36),ee("click",function(){return ue(e),ce(C().playLocally())}),ve(1,37),A()}}function fht(n,t){if(1&n){const e=Oe();O(0,"button",38),ee("click",function(){return ue(e),ce(C().createGame())}),ve(1,39),A()}}function dht(n,t){if(1&n){const e=Oe();O(0,"button",40),ee("click",function(){return ue(e),ce(C().showSolution())}),ve(1,41),A()}}function hht(n,t){if(1&n&&(pn(0),O(1,"option",43),Tt(2),A(),gn()),2&n){const e=C(),r=e.index,s=e.$implicit;P(1),y1("id","step_",r,""),w("value",r),P(1),c1(s.title)}}function pht(n,t){1&n&&(pn(0),Tt(1,"v "),gn())}function ght(n,t){1&n&&Tt(0,"x ")}function mht(n,t){if(1&n&&(O(0,"option",44),x(1,pht,2,0,"ng-container",28),x(2,ght,1,0,"ng-template",null,45,Zn),O(4,"span",46),Tt(5),A()()),2&n){const e=Bn(3),r=C(),s=r.index,i=r.$implicit,o=C();w("value",s),P(1),w("ngIf",o.stepFinished[s])("ngIfElse",e),P(3),y1("id","step_",s,""),P(1),c1(i.title)}}function _ht(n,t){if(1&n&&(pn(0),x(1,hht,3,3,"ng-container",28),x(2,mht,6,5,"ng-template",null,42,Zn),gn()),2&n){const e=t.index,r=Bn(3),s=C();P(1),w("ngIf",e===s.stepIndex)("ngIfElse",r)}}let vht=(()=>{class n extends iT{constructor(e,r,s,i,o,c){super(e,r,c,s,i),this.cdr=o,this.COMPLETED_TUTORIAL_MESSAGE=$localize`Congratulations, you completed the tutorial.`,this.steps=[],this.successfulSteps=0,this.stepIndex=-1,this.currentMessage="",this.currentReason=T.empty(),this.moveAttemptMade=!1,this.stepFinished=[],this.tutorialOver=!1,Q(n.VERBOSE,"TutorialGameWrapperComponent.constructor"),this.role=B.ZERO}getNumberOfSteps(){return this.steps.length}getCurrentStepTitle(){return this.steps.length>0?this.steps[this.stepIndex].title:""}ngAfterViewInit(){var e=this;return I(function*(){Q(n.VERBOSE,"TutorialGameWrapperComponent.ngAfterViewInit"),(yield e.afterViewInit())&&e.start()})()}start(){this.startTutorial(this.gameComponent.tutorial)}startTutorial(e){Q(n.VERBOSE,{tutorialGameWrapperComponent_startTutorial:{tutorial:e}}),this.steps=e,this.tutorialOver=!1,this.stepFinished=this.getCompletionArray(),this.successfulSteps=0,this.showStep(0)}getCompletionArray(){return this.steps.map(()=>!1)}changeStep(e){this.showStep(Number.parseInt(e.target.value,10))}showStep(e){Q(n.VERBOSE,"tutorialGameWrapperComponent.showStep("+e+")"),this.moveAttemptMade=!1,this.stepFinished[e]=!1,this.updateSuccessCount(),this.stepIndex=e;const r=this.steps[this.stepIndex];let s;if(this.currentMessage=r.instruction,this.currentReason=T.empty(),r.previousState.isPresent()){const i=new U1(r.previousState.get());s=T.of(i)}else s=T.empty();this.gameComponent.rules.node=new U1(r.state,s,r.previousMove),this.gameComponent.updateBoard(),this.setRole(this.gameComponent.getCurrentPlayer()),this.cdr.detectChanges()}onLegalUserMove(e){var r=this;return I(function*(){Q(n.VERBOSE,{tutorialGameWrapper_onLegalUserMove:{move:e}});const s=r.steps[r.stepIndex];if(Pe(r.gameComponent.rules.choose(e),"It should be impossible to call onLegalUserMove with an illegal move"),Q(n.VERBOSE,"tutorialGameWrapper.onLegalUserMove: legal move"),r.gameComponent.updateBoard(),r.moveAttemptMade=!0,s.isPredicate()){const o=r.gameComponent.getPreviousState(),c=r.gameComponent.getState(),u=Me.getNonNullable(s.predicate)(e,o,c);u.isSuccess()?r.showStepSuccess(s.getSuccessMessage()):r.currentReason=T.of(u.getReason())}else if(s.isAnyMove())Q(n.VERBOSE,"tutorialGameWrapper.onLegalUserMove: awaited move!"),r.showStepSuccess(s.getSuccessMessage());else{Pe(s.isMove(),"cannot reach here with a click step");const o=s;o.acceptedMoves.some(c=>c.equals(e))?(Q(n.VERBOSE,"tutorialGameWrapper.onLegalUserMove: awaited move!"),r.showStepSuccess(o.getSuccessMessage())):(Q(n.VERBOSE,"tutorialGameWrapper.onLegalUserMove: not the move that was awaited."),r.currentReason=T.of(o.getFailureMessage()))}r.cdr.detectChanges()})()}retry(){Q(n.VERBOSE,"tutorialGameWrapper.retry"),this.moveAttemptMade=!1,this.showStep(this.stepIndex)}onUserClick(e){if(Q(n.VERBOSE,"tutorialGameWrapper.onUserClick("+e+")"),this.currentReason=T.empty(),this.stepFinished[this.stepIndex]||this.moveAttemptMade)return R.failure(h4e.STEP_FINISHED());const r=this.steps[this.stepIndex];return r.isClick()?(this.gameComponent.updateBoard(),this.moveAttemptMade=!0,Me.getNonNullable(r.acceptedClicks).some(s=>s===e)?this.showStepSuccess(r.getSuccessMessage()):this.currentMessage=r.getFailureMessage(),R.SUCCESS):r.isMove()||r.isPredicate()||r.isAnyMove()?(window.setTimeout(()=>{this.cdr.detectChanges()},10),R.SUCCESS):R.failure(h4e.INFORMATIONAL_STEP())}onCancelMove(e){Q(n.VERBOSE,"tutorialGameWrapperComponent.onCancelMove("+e+")"),void 0!==e&&(this.currentReason=T.of(e)),this.cdr.detectChanges()}showStepSuccess(e){Q(n.VERBOSE,"tutorialGameWrapperComponent.showStepSuccess()"),this.currentMessage=e,this.stepFinished[this.stepIndex]=!0,this.updateSuccessCount()}updateSuccessCount(){let e=0;for(const r of this.stepFinished)r&&e++;this.successfulSteps=e}next(){if(this.steps[this.stepIndex].isInformation()&&(this.stepFinished[this.stepIndex]=!0,this.updateSuccessCount()),this.stepFinished.length===this.successfulSteps)this.currentMessage=this.COMPLETED_TUTORIAL_MESSAGE,this.tutorialOver=!0;else{let e=(this.stepIndex+1)%this.steps.length;for(;!0===this.stepFinished[e];)e=(e+1)%this.steps.length;this.showStep(e)}}showSolution(){var e=this;return I(function*(){Q(n.VERBOSE,"tutorialGameWrapper.showSolution()");const r=e.steps[e.stepIndex];Pe(r.hasSolution(),"step must have solution");const s=r,i=s.getSolution();i instanceof Fi?(e.showStep(e.stepIndex),e.gameComponent.rules.choose(i),e.gameComponent.updateBoard()):(e.showStep(e.stepIndex),window.document.querySelector(i).dispatchEvent(new Event("click"))),e.currentMessage=s.getSuccessMessage(),e.moveAttemptMade=!0,e.cdr.detectChanges()})()}playLocally(){var e=this;return I(function*(){const r=Me.getNonNullable(e.actRoute.snapshot.paramMap.get("compo"));yield e.router.navigate(["/local",r])})()}createGame(){var e=this;return I(function*(){const r=Me.getNonNullable(e.actRoute.snapshot.paramMap.get("compo"));yield e.router.navigate(["/play",r])})()}getPlayer(){return"tutorial-player"}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(J(xa),J(bo),J(Kn),J(En),J(Mu),J(Ns))},n.\u0275cmp=dt({type:n,selectors:[["app-tutorial-game-wrapper"]],features:[l],decls:23,vars:15,consts:function(){let t,e,r,s,i,o,c,u,d;return t=$localize`Failure`,e=$localize`Try again`,r=$localize`Ok`,s=$localize`Continue`,i=$localize`Skip`,o=$localize`Try again`,c=$localize`Play locally`,u=$localize`Create an online game`,d=$localize`See solution`,[[1,"tile","is-ancestor"],[1,"tile","is-5","is-vertical","is-parent"],["id","infos",1,"tile","is-child","box"],[1,"progress","is-primary"],[1,"content","is-medium"],[1,"title"],["id","currentMessage",3,"innerHTML"],["class","message is-danger","role","alert",4,"ngIf"],[1,"block"],["id","retryButton","class","button mr-3",3,"click",4,"ngIf"],["id","nextButton","class","button is-primary mr-3 mb-1",3,"click",4,"ngIf"],["id","restartButton","class","button",3,"click",4,"ngIf"],["id","playLocallyButton","class","button",3,"click",4,"ngIf"],["id","playOnlineButton","class","button",3,"click",4,"ngIf"],["id","showSolutionButton","class","button",3,"click",4,"ngIf"],[1,"select"],["id","steps",3,"change"],[4,"ngFor","ngForOf"],[1,"tile","is-parent","is-7","is-vcentered",3,"ngClass"],["id","board",1,"tile","is-child","box"],["board",""],["role","alert",1,"message","is-danger"],[1,"message-header"],t,["id","currentReason",1,"message-body",3,"innerHTML"],["id","retryButton",1,"button","mr-3",3,"click"],e,["id","nextButton",1,"button","is-primary","mr-3","mb-1",3,"click"],[4,"ngIf","ngIfElse"],["notInfo",""],["notFinished",""],r,s,i,["id","restartButton",1,"button",3,"click"],o,["id","playLocallyButton",1,"button",3,"click"],c,["id","playOnlineButton",1,"button",3,"click"],u,["id","showSolutionButton",1,"button",3,"click"],d,["otherstep",""],["selected","",3,"id","value"],[3,"value"],["notdone",""],[3,"id"]]},template:function(e,r){1&e&&(O(0,"div",0)(1,"div",1)(2,"div",2),X(3,"progress",3),O(4,"div",4)(5,"p",5),Tt(6),A(),X(7,"p",6),A(),x(8,nht,4,1,"div",7),O(9,"div",8),x(10,rht,2,0,"button",9),x(11,cht,6,2,"button",10),x(12,lht,2,0,"button",11),x(13,uht,2,0,"button",12),x(14,fht,2,0,"button",13),x(15,dht,2,0,"button",14),O(16,"div",15)(17,"select",16),ee("change",function(i){return r.changeStep(i)}),x(18,_ht,4,2,"ng-container",17),A()()()()(),O(19,"div",18)(20,"div",19),X(21,"div",null,20),A()()()),2&e&&(P(3),z("value",r.successfulSteps)("max",r.getNumberOfSteps()),P(3),iO("",r.getCurrentStepTitle()," [",r.stepIndex+1,"/",r.getNumberOfSteps(),"]"),P(1),w("innerHTML",r.currentMessage,nu),P(1),w("ngIf",r.currentReason.isPresent()),P(2),w("ngIf",!1===r.tutorialOver&&(r.stepFinished&&!0===r.stepFinished[r.stepIndex]||r.moveAttemptMade)),P(1),w("ngIf",!1===r.tutorialOver),P(1),w("ngIf",r.tutorialOver),P(1),w("ngIf",r.tutorialOver),P(1),w("ngIf",r.tutorialOver),P(1),w("ngIf",r.moveAttemptMade&&!1===r.stepFinished[r.stepIndex]),P(3),w("ngForOf",r.steps),P(1),w("ngClass",r.getBoardHighlight()))},dependencies:[fn,On,Kt,wp,bp],encapsulation:2,changeDetection:0}),n})();function Cht(n,t){if(1&n&&(O(0,"div",35)(1,"div",36),ve(2,37),A(),O(3,"div",38),Tt(4),A()()),2&n){const e=C();P(4),c1(e.errorMessage)}}const yht=function(){return["/login"]};let Eht=(()=>{class n{constructor(e,r){this.connectedUserService=e,this.router=r,this.faEye=jV,this.registrationForm=new T0({email:new Ha,username:new Ha,password:new Ha})}registerWithEmail(){var e=this;return I(function*(){const r=e.registrationForm.value.username,s=e.registrationForm.value.email,i=e.registrationForm.value.password;if(null==r||null==s||null==i)e.errorMessage=$localize`There are missing fields in the registration form, please check that you filled in all fields.`;else{const o=yield e.connectedUserService.doRegister(r,s,i);if(o.isSuccess()){const c=yield e.connectedUserService.sendEmailVerification();c.isSuccess()?yield e.router.navigate(["/verify-account"]):e.errorMessage=c.getReason()}else e.errorMessage=o.getReason()}})()}registerWithGoogle(){var e=this;return I(function*(){const r=yield e.connectedUserService.doGoogleLogin();r.isSuccess()?yield e.router.navigate(["/verify-account"]):e.errorMessage=r.getReason()})()}getPasswordHelpClass(){const e=this.registrationForm.value.password;return null==e||""===e?"":e.length<6?"is-danger":"is-success"}canRegister(){const e=this.registrationForm.value.password??"";return!(""===(this.registrationForm.value.email??"")||""===(this.registrationForm.value.username??"")||""===e||e.length<6)}}return n.\u0275fac=function(e){return new(e||n)(J(Ns),J(Kn))},n.\u0275cmp=dt({type:n,selectors:[["app-register"]],decls:56,vars:7,consts:function(){let t,e,r,s,i,o,c,u,d,g,m,y,b,k;return t=$localize`Registering`,e=$localize`Email`,r=$localize`Email`,s=$localize`A confirmation email will be sent to validate your account.`,i=$localize`Username`,o=$localize`Username`,c=$localize`Password`,u=$localize`Password`,d=$localize`The password should be at least 6 characters long`,g=$localize`Register`,m=$localize`Register with Google`,y=$localize`Have an account?`,b=$localize`Log in`,k=$localize`Registration error`,[[1,"box"],[1,"title"],t,[3,"formGroup"],[1,"field","is-horizontal"],[1,"field-label"],["for","email",1,"label"],e,[1,"field-body"],[1,"field"],[1,"control"],["id","email","formControlName","email","name","email","placeholder",r,"type","email","autofocus","","required","",1,"input"],[1,"help"],s,["for","username",1,"label"],i,["id","username","formControlName","username","name","username","placeholder",o,"type","text","required","",1,"input"],["for","password",1,"label"],c,[1,"control","has-icons-right","is-expanded"],["id","password","formControlName","password","name","password","placeholder",u,"type","password","required","",1,"input"],[1,"icon","is-small","is-right"],["toggleVisibility","",1,"clickable-icon",3,"icon"],["id","passwordHelp",1,"help",3,"ngClass"],d,["id","registerButton",1,"button","is-primary","is-fullwidth",3,"disabled","click"],g,[1,"field-body","is-fullwidth"],["class","message is-danger is-fullwidth","role","alert",4,"ngIf"],["id","googleButton","type","submit",1,"button","is-fullwidth",3,"click"],m,[1,"help","level-right"],y,[3,"routerLink"],b,["role","alert",1,"message","is-danger","is-fullwidth"],[1,"message-header"],k,["id","errorMessage",1,"message-body"]]},template:function(e,r){1&e&&(O(0,"div",0)(1,"p",1),ve(2,2),A(),O(3,"form",3)(4,"div",4)(5,"div",5)(6,"label",6),ve(7,7),A()(),O(8,"div",8)(9,"div",9)(10,"div",10),X(11,"input",11),O(12,"p",12),ve(13,13),A()()()()(),O(14,"div",4)(15,"div",5)(16,"label",14),ve(17,15),A()(),O(18,"div",8)(19,"div",9)(20,"div",10),X(21,"input",16),A()()()(),O(22,"div",4)(23,"div",5)(24,"label",17),ve(25,18),A()(),O(26,"div",8)(27,"div",9)(28,"div",19),X(29,"input",20),O(30,"span",21),X(31,"fa-icon",22),A(),O(32,"p",23),ve(33,24),A()()()()(),O(34,"div",4),X(35,"div",5),O(36,"div",8)(37,"div",9)(38,"div",10)(39,"button",25),ee("click",function(){return r.registerWithEmail()}),ve(40,26),A()()()()(),O(41,"div",4),X(42,"div",5),O(43,"div",27),x(44,Cht,5,1,"div",28),A()(),O(45,"div",4),X(46,"div",5),O(47,"div",8)(48,"button",29),ee("click",function(){return r.registerWithGoogle()}),ve(49,30),A()()(),O(50,"p",31),pn(51),ve(52,32),gn(),Tt(53,"\xa0 "),O(54,"a",33),ve(55,34),A()()()()),2&e&&(P(3),w("formGroup",r.registrationForm),P(28),w("icon",r.faEye),P(1),w("ngClass",r.getPasswordHelpClass()),P(7),w("disabled",!r.canRegister()),P(5),w("ngIf",r.errorMessage),P(10),w("routerLink",J1(6,yht)))},dependencies:[fn,Kt,Lu,bu,S4,Ll,wu,Nu,Ou,_f,Sd,JH,o4e],encapsulation:2}),n})(),Mht=(()=>{class n{constructor(e){this.router=e}pickGame(e){this.selectedGame=e}playLocally(){var e=this;return I(function*(){yield e.router.navigate(["local/"+e.selectedGame])})()}}return n.\u0275fac=function(e){return new(e||n)(J(Kn))},n.\u0275cmp=dt({type:n,selectors:[["app-local-game-creation"]],decls:3,vars:1,consts:function(){let t;return t=$localize`Play offline`,[[3,"pickGame"],["id","launchGame",1,"button","is-primary","is-fullwidth",3,"disabled","click"],t]},template:function(e,r){1&e&&(O(0,"app-pick-game",0),ee("pickGame",function(i){return r.pickGame(i)}),A(),O(1,"button",1),ee("click",function(){return r.playLocally()}),ve(2,2),A()),2&e&&(P(1),w("disabled",!r.selectedGame))},dependencies:[QH],encapsulation:2}),n})(),Sht=(()=>{class n{constructor(e){this.router=e}pickGame(e){this.selectedGame=e}launchTutorial(){var e=this;return I(function*(){yield e.router.navigate(["/tutorial/",e.selectedGame])})()}}return n.\u0275fac=function(e){return new(e||n)(J(Kn))},n.\u0275cmp=dt({type:n,selectors:[["app-tutorial-game-creation"]],decls:3,vars:1,consts:function(){let t;return t=$localize`Learn the rules`,[[3,"pickGame"],["id","launchTutorial",1,"button","is-primary","is-fullwidth",3,"disabled","click"],t]},template:function(e,r){1&e&&(O(0,"app-pick-game",0),ee("pickGame",function(i){return r.pickGame(i)}),A(),O(1,"button",1),ee("click",function(){return r.launchTutorial()}),ve(2,2),A()),2&e&&(P(1),w("disabled",!r.selectedGame))},dependencies:[QH],encapsulation:2}),n})(),Pht=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=dt({type:n,selectors:[["app-next-game-loading"]],decls:2,vars:0,consts:function(){let t;return t=$localize`The replay game is loading, please wait, it should not take long.`,[t]},template:function(e,r){1&e&&(O(0,"p"),ve(1,0),A())},encapsulation:2}),n})();function wht(n,t){if(1&n&&(F(),X(0,"polygon",4)),2&n){const e=C();w("id",e.mainShapeId)("ngClass",e.pieceClasses),z("points",e.MartianChessQueenComponent.HEPTAGON)}}function bht(n,t){if(1&n&&(F(),X(0,"polygon",4)),2&n){const e=C();w("id",e.mainShapeId)("ngClass",e.pieceClasses),z("points",e.MartianChessQueenComponent.EIGHT_POINTED_STAR)}}function Oht(n,t){if(1&n&&(F(),X(0,"circle",5)),2&n){const e=C();w("id",e.mainShapeId)("ngClass",e.pieceClasses),z("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",.5*e.MartianChessComponent.SPACE_SIZE-e.MartianChessComponent.STROKE_WIDTH)}}function Aht(n,t){if(1&n&&(pn(0),F(),X(1,"circle",6)(2,"circle",6)(3,"circle",6),gn()),2&n){const e=C();P(1),z("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",e.MartianChessComponent.getRadius(3)),P(1),z("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",e.MartianChessComponent.getRadius(2)),P(1),z("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",e.MartianChessComponent.getRadius(1))}}function Nht(n,t){if(1&n&&(F(),O(0,"g"),X(1,"circle",7)(2,"circle",7)(3,"circle",7),A()),2&n){const e=C();P(1),z("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.45*e.MartianChessComponent.SPACE_SIZE)("r",.2/3*e.MartianChessComponent.SPACE_SIZE),P(1),z("cx",.45*e.MartianChessComponent.SPACE_SIZE)("cy",.55*e.MartianChessComponent.SPACE_SIZE)("r",.2/3*e.MartianChessComponent.SPACE_SIZE),P(1),z("cx",.55*e.MartianChessComponent.SPACE_SIZE)("cy",.55*e.MartianChessComponent.SPACE_SIZE)("r",.2/3*e.MartianChessComponent.SPACE_SIZE)}}function Iht(n,t){if(1&n&&(F(),O(0,"g",8),X(1,"circle",9)(2,"circle",9)(3,"circle",9),A()),2&n){const e=C();w("ngClass",e.pieceClasses),P(1),z("cx",.5*e.MartianChessComponent.SPACE_SIZE-3*e.horizontalDotsRadius)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",1.5*e.horizontalDotsRadius),P(1),z("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",1.5*e.horizontalDotsRadius),P(1),z("cx",.5*e.MartianChessComponent.SPACE_SIZE+3*e.horizontalDotsRadius)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",1.5*e.horizontalDotsRadius)}}class P6{constructor(){this.MartianChessQueenComponent=P6,this.MartianChessComponent=Fo,this.horizontalDotsRadius=Fo.SPACE_SIZE/15}}function kht(n,t){if(1&n&&(F(),X(0,"polygon",4)),2&n){const e=C();w("id",e.mainShapeId)("ngClass",e.pieceClasses),z("points",e.MartianChessDroneComponent.PENTAGON)}}function Lht(n,t){if(1&n&&(F(),X(0,"polygon",4)),2&n){const e=C();w("id",e.mainShapeId)("ngClass",e.pieceClasses),z("points",e.MartianChessDroneComponent.FOUR_POINTED_STAR_VERTICAL)}}function Rht(n,t){if(1&n&&(F(),X(0,"circle",5)),2&n){const e=C();w("id",e.mainShapeId)("ngClass",e.pieceClasses),z("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",.5*e.MartianChessComponent.SPACE_SIZE-e.MartianChessComponent.STROKE_WIDTH)}}function Dht(n,t){if(1&n&&(pn(0),F(),X(1,"circle",6)(2,"circle",6),gn()),2&n){const e=C();P(1),z("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",e.MartianChessComponent.getRadius(2)),P(1),z("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",e.MartianChessComponent.getRadius(1))}}function zht(n,t){if(1&n&&(F(),O(0,"g",7),X(1,"circle",8)(2,"circle",8),A()),2&n){const e=C();w("ngClass",e.pieceClasses),P(1),z("cx",.4*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",.2/3*e.MartianChessComponent.SPACE_SIZE),P(1),z("cx",.6*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",.2/3*e.MartianChessComponent.SPACE_SIZE)}}function Vht(n,t){if(1&n&&(F(),O(0,"g",7),X(1,"circle",9)(2,"circle",9),A()),2&n){const e=C();w("ngClass",e.pieceClasses),P(1),z("cx",.5*e.MartianChessComponent.SPACE_SIZE-2*e.horizontalDotsRadius)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",1.5*e.horizontalDotsRadius),P(1),z("cx",.5*e.MartianChessComponent.SPACE_SIZE+2*e.horizontalDotsRadius)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",1.5*e.horizontalDotsRadius)}}P6.HEPTAGON=Fo.getRegularPolygon(7),P6.EIGHT_POINTED_STAR=Fo.getNPointedStar(8,0),P6.\u0275fac=function(t){return new(t||P6)},P6.\u0275cmp=dt({type:P6,selectors:[["","app-martian-chess-queen",""]],inputs:{mainShapeId:"mainShapeId",pieceClasses:"pieceClasses",style:"style"},attrs:["app-martian-chess-queen",""],decls:6,vars:6,consts:[["class","base","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["class","base",3,"id","ngClass",4,"ngIf"],[4,"ngIf"],[3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[1,"base",3,"id","ngClass"],[1,"base","no-fill","mid-stroke"],[1,"base","mid-stroke"],[3,"ngClass"],[1,"base-no-stroke"]],template:function(t,e){1&t&&(x(0,wht,1,3,"polygon",0),x(1,bht,1,3,"polygon",0),x(2,Oht,1,5,"circle",1),x(3,Aht,4,9,"ng-container",2),x(4,Nht,4,9,"g",2),x(5,Iht,4,10,"g",3)),2&t&&(w("ngIf","Polygon"===e.style.shape),P(1),w("ngIf","Star"===e.style.shape),P(1),w("ngIf","Circle"===e.style.shape),P(1),w("ngIf","Concentric Circles"===e.style.points),P(1),w("ngIf","Dots"===e.style.points),P(1),w("ngIf","Horizontal Points"===e.style.points))},dependencies:[fn,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});class T6{constructor(){this.MartianChessComponent=Fo,this.MartianChessDroneComponent=T6,this.horizontalDotsRadius=Fo.SPACE_SIZE/15}}function Fht(n,t){if(1&n&&(F(),X(0,"polygon",5)),2&n){const e=C();w("id",e.mainShapeId)("ngClass",e.pieceClasses),z("points",e.MartianChessPawnComponent.TRIANGLE)}}function Bht(n,t){if(1&n&&(F(),X(0,"polygon",5)),2&n){const e=C();w("id",e.mainShapeId)("ngClass",e.pieceClasses),z("points",e.MartianChessPawnComponent.FOUR_POINTED_STAR_DIAGONAL)}}function $ht(n,t){if(1&n&&(F(),X(0,"circle",6)),2&n){const e=C();w("id",e.mainShapeId)("ngClass",e.pieceClasses),z("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",.5*e.MartianChessComponent.SPACE_SIZE-e.MartianChessComponent.STROKE_WIDTH)}}function Uht(n,t){if(1&n&&(F(),X(0,"circle",7)),2&n){const e=C();z("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE+e.getConcreteTriangleYOffset())("r",e.MartianChessComponent.getRadius(1))}}function Ght(n,t){if(1&n&&(F(),X(0,"circle",8)),2&n){const e=C();z("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",.2/3*e.MartianChessComponent.SPACE_SIZE)}}function Wht(n,t){if(1&n&&(F(),O(0,"g",9),X(1,"circle",10),A()),2&n){const e=C();w("ngClass",e.pieceClasses),P(1),z("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",1.5*e.horizontalDotsRadius)}}T6.FOUR_POINTED_STAR_VERTICAL=Fo.getNPointedStar(4,0),T6.PENTAGON=Fo.getRegularPolygon(5),T6.\u0275fac=function(t){return new(t||T6)},T6.\u0275cmp=dt({type:T6,selectors:[["","app-martian-chess-drone",""]],inputs:{mainShapeId:"mainShapeId",pieceClasses:"pieceClasses",style:"style"},attrs:["app-martian-chess-drone",""],decls:6,vars:6,consts:[["class","base","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["class","base",3,"id","ngClass",4,"ngIf"],[4,"ngIf"],[3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[1,"base",3,"id","ngClass"],[1,"base","no-fill","mid-stroke"],[3,"ngClass"],[1,"base","mid-stroke"],[1,"base-no-stroke"]],template:function(t,e){1&t&&(x(0,kht,1,3,"polygon",0),x(1,Lht,1,3,"polygon",0),x(2,Rht,1,5,"circle",1),x(3,Dht,3,6,"ng-container",2),x(4,zht,3,7,"g",3),x(5,Vht,3,7,"g",3)),2&t&&(w("ngIf","Polygon"===e.style.shape),P(1),w("ngIf","Star"===e.style.shape),P(1),w("ngIf","Circle"===e.style.shape),P(1),w("ngIf","Concentric Circles"===e.style.points),P(1),w("ngIf","Dots"===e.style.points),P(1),w("ngIf","Horizontal Points"===e.style.points))},dependencies:[fn,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});class Ma{constructor(){this.MartianChessComponent=Fo,this.MartianChessPawnComponent=Ma,this.horizontalDotsRadius=Fo.SPACE_SIZE/15}static getTriangle(){return Fo.getRegularPolygon(3,Ma.TRIANGLE_Y_OFFSET)}static yOffsetForVerticalCentering(){const e=Fo.getRegularPolygonCoords(3).map(u=>u.y);return(e.reduce((u,d)=>Math.min(u,d))+(100-e.reduce((u,d)=>Math.max(u,d))))/4}getConcreteTriangleYOffset(){return"Polygon"===this.style.shape?Ma.TRIANGLE_Y_OFFSET:0}}function jht(n,t){if(1&n&&(F(),X(0,"text",8)),2&n){const e=C();j2("id","height_",e.coord.x,"_",e.coord.y,"_",e.coord.z,""),w("innerHTML",e.coord.z,nu)}}function Zht(n,t){if(1&n&&(F(),X(0,"polyline",9)),2&n){const e=C();w("ngClass",e.pieceClasses),z("points",e.getUpperHorizontalLine())}}function Yht(n,t){if(1&n&&(F(),O(0,"g"),X(1,"polyline",10)(2,"polyline",11),A()),2&n){const e=C();P(1),w("ngClass",e.pieceClasses),z("points",e.getMiddleHorizontalLine()),P(1),w("ngClass",e.pieceClasses),z("points",e.getLowerHorizontalLine())}}function Kht(n,t){if(1&n&&(F(),X(0,"polyline",12)),2&n){const e=C();w("ngClass",e.pieceClasses),z("points",e.getLeftDiagonalLine())}}function Xht(n,t){if(1&n&&(F(),O(0,"g"),X(1,"polyline",13)(2,"polyline",14),A()),2&n){const e=C();P(1),w("ngClass",e.pieceClasses),z("points",e.getMiddleDiagonalLine()),P(1),w("ngClass",e.pieceClasses),z("points",e.getRighterDiagonalLine())}}function Qht(n,t){if(1&n&&(F(),X(0,"polyline",15)),2&n){const e=C();w("ngClass",e.pieceClasses),z("points",e.getLeftVerticalLine())}}function Jht(n,t){if(1&n&&(F(),X(0,"polyline",16)),2&n){const e=C();w("ngClass",e.pieceClasses),z("points",e.getMiddleVerticalLine())}}function e9t(n,t){if(1&n&&(F(),X(0,"polyline",17)),2&n){const e=C();w("ngClass",e.pieceClasses),z("points",e.getRighterVerticalLine())}}Ma.FOUR_POINTED_STAR_DIAGONAL=Fo.getNPointedStar(4,45),Ma.TRIANGLE_Y_OFFSET=Ma.yOffsetForVerticalCentering(),Ma.TRIANGLE=Ma.getTriangle(),Ma.\u0275fac=function(t){return new(t||Ma)},Ma.\u0275cmp=dt({type:Ma,selectors:[["","app-martian-chess-pawn",""]],inputs:{mainShapeId:"mainShapeId",pieceClasses:"pieceClasses",style:"style"},attrs:["app-martian-chess-pawn",""],decls:6,vars:6,consts:[["class","base","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["class","base",3,"id","ngClass",4,"ngIf"],["class","base no-fill mid-stroke",4,"ngIf"],["class","base mid-stroke",4,"ngIf"],[3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[1,"base",3,"id","ngClass"],[1,"base","no-fill","mid-stroke"],[1,"base","mid-stroke"],[3,"ngClass"],[1,"base-no-stroke"]],template:function(t,e){1&t&&(x(0,Fht,1,3,"polygon",0),x(1,Bht,1,3,"polygon",0),x(2,$ht,1,5,"circle",1),x(3,Uht,1,3,"circle",2),x(4,Ght,1,3,"circle",3),x(5,Wht,2,4,"g",4)),2&t&&(w("ngIf","Polygon"===e.style.shape),P(1),w("ngIf","Star"===e.style.shape),P(1),w("ngIf","Circle"===e.style.shape),P(1),w("ngIf","Concentric Circles"===e.style.points),P(1),w("ngIf","Dots"===e.style.points),P(1),w("ngIf","Horizontal Points"===e.style.points))},dependencies:[fn,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});class Wd{mustForceStrokeDisplay(){return void 0===this.move||this.pieceClasses.some(t=>"victory-stroke"===t)||this.pieceClasses.some(t=>"last-move-stroke"===t)}get3DIsoSquarePoints(){const t=this.getParallelogramPoints();return this.mapCoordToPoints([t[0],t[1],t[4],t[6],t[5],t[2],t[0]])}getParallelogramPoints(){const t=this.mode.parallelogramHeight*this.mode.horizontalWidthRatio,e=this.mode.parallelogramHeight,r=this.mode.offsetRatio*this.mode.parallelogramHeight,s=this.mode.parallelogramHeight*this.mode.pieceHeightRatio,i=t,c=t-r,u=e,d=-r,g=e;return[new S(0,0),new S(i,0),new S(d,g),new S(c,u),new S(i,0+s),new S(d,g+s),new S(c,u+s)]}mapCoordToPoints(t){return t.map(e=>e.x+" "+e.y).join(" ")}getUpperHorizontalLineCoords(){const t=this.getParallelogramPoints(),e=t[0],r=t[1],i=new Bt(-1*this.mode.offsetRatio*u1.STROKE_WIDTH,u1.STROKE_WIDTH),o=e.getNext(i),c=r.getNext(i);return[e,r,c,o]}getUpperHorizontalLine(){const t=this.getUpperHorizontalLineCoords();return this.mapCoordToPoints(t)}getMiddleHorizontalCoords(){const t=this.getParallelogramPoints(),e=t[2],r=t[3],i=new Bt(-1*this.mode.offsetRatio*u1.STROKE_WIDTH,u1.STROKE_WIDTH);return[e.getNext(i,-1),r.getNext(i,-1),r,e]}getMiddleHorizontalLine(){const t=this.getMiddleHorizontalCoords();return this.mapCoordToPoints(t)}getLowerHorizontalLine(){const t=this.getParallelogramPoints(),e=t[5],r=t[6],s=new Bt(0,u1.STROKE_WIDTH),i=e.getNext(s,-1),o=r.getNext(s,-1);return this.mapCoordToPoints([i,o,r,e])}getLeftDiagonalLine(){const t=this.getParallelogramPoints(),e=t[0],r=t[2],i=new Bt(u1.STROKE_WIDTH,0),o=e.getNext(i,1),c=r.getNext(i,1);return this.mapCoordToPoints([e,o,c,r])}getMiddleDiagonalLine(){const t=this.getParallelogramPoints(),e=t[1],r=t[3],i=new Bt(u1.STROKE_WIDTH,0),o=e.getNext(i,-1),c=r.getNext(i,-1);return this.mapCoordToPoints([o,e,r,c])}getRighterDiagonalLine(){const t=this.getParallelogramPoints(),e=t[4],r=t[6],i=new Bt(0,u1.STROKE_WIDTH),o=e.getNext(i,-1),c=r.getNext(i,-1);return this.mapCoordToPoints([o,e,r,c])}getLeftVerticalLine(){const t=this.getParallelogramPoints(),e=t[2],r=t[5],i=new Bt(u1.STROKE_WIDTH,0),o=e.getNext(i,1),c=r.getNext(i,1);return this.mapCoordToPoints([e,o,c,r])}getMiddleVerticalLine(){const t=this.getParallelogramPoints(),e=t[3],r=t[6],i=new Bt(u1.STROKE_WIDTH,0),o=e.getNext(i,-1),c=r.getNext(i,-1);return this.mapCoordToPoints([o,e,r,c])}getRighterVerticalLine(){const t=this.getParallelogramPoints(),e=t[1],r=t[4],o=new Bt(u1.STROKE_WIDTH,-u1.STROKE_WIDTH/this.mode.offsetRatio),c=e.getNext(o,-1),u=r.getNext(o,-1);return this.mapCoordToPoints([c,e,r,u])}getOtherCoord(){Pe(null!=this.move,"Move should be set before calling getOtherCoord");const t=this.move;return t.getZero().equals(this.coord)?t.getOne():t.getZero()}isLeftHalf(){if(null==this.move)return!1;{const t=this.getOtherCoord();return this.coord.x===t.x-1}}isRightHalf(){if(null==this.move)return!1;{const t=this.getOtherCoord();return this.coord.x===t.x+1}}isTopHalf(){if(null==this.move)return!1;{const t=this.getOtherCoord();return this.coord.y===t.y-1}}isBottomHalf(){if(null==this.move)return!1;{const t=this.getOtherCoord();return this.coord.y===t.y+1}}}Wd.STROKE_OFFSET=u1.STROKE_WIDTH/2,Wd.\u0275fac=function(t){return new(t||Wd)},Wd.\u0275cmp=dt({type:Wd,selectors:[["","mgp-trexo-half-piece",""]],inputs:{coord:"coord",move:"move",pieceClasses:"pieceClasses",mode:"mode",mustDisplayHeight:"mustDisplayHeight"},attrs:["mgp-trexo-half-piece",""],decls:9,vars:13,consts:[[3,"id","ngClass"],["x","50","y","66","class","text-big text-center",3,"id","innerHTML",4,"ngIf"],["id","line_0_to_1","class","base manual-stroke",3,"ngClass",4,"ngIf"],[4,"ngIf"],["id","line_0_to_2","class","base manual-stroke",3,"ngClass",4,"ngIf"],["id","line_2_to_5","class","base manual-stroke",3,"ngClass",4,"ngIf"],["id","line_3_to_6","class","base manual-stroke",3,"ngClass",4,"ngIf"],["id","line_1_to_4","class","base manual-stroke",3,"ngClass",4,"ngIf"],["x","50","y","66",1,"text-big","text-center",3,"id","innerHTML"],["id","line_0_to_1",1,"base","manual-stroke",3,"ngClass"],["id","line_2_to_3",1,"base","manual-stroke",3,"ngClass"],["id","line_5_to_6",1,"base","manual-stroke",3,"ngClass"],["id","line_0_to_2",1,"base","manual-stroke",3,"ngClass"],["id","line_1_to_3",1,"base","manual-stroke",3,"ngClass"],["id","line_4_to_6",1,"base","manual-stroke",3,"ngClass"],["id","line_2_to_5",1,"base","manual-stroke",3,"ngClass"],["id","line_3_to_6",1,"base","manual-stroke",3,"ngClass"],["id","line_1_to_4",1,"base","manual-stroke",3,"ngClass"]],template:function(t,e){1&t&&(F(),X(0,"polyline",0),x(1,jht,1,4,"text",1),x(2,Zht,1,2,"polyline",2),x(3,Yht,3,4,"g",3),x(4,Kht,1,2,"polyline",4),x(5,Xht,3,4,"g",3),x(6,Qht,1,2,"polyline",5),x(7,Jht,1,2,"polyline",6),x(8,e9t,1,2,"polyline",7)),2&t&&(j2("id","tile_",e.coord.x,"_",e.coord.y,"_",e.coord.z,""),w("ngClass",e.pieceClasses),z("points",e.get3DIsoSquarePoints()),P(1),w("ngIf",e.mustDisplayHeight),P(1),w("ngIf",!1===e.isBottomHalf()||e.mustForceStrokeDisplay()),P(1),w("ngIf",!1===e.isTopHalf()||e.mustForceStrokeDisplay()),P(1),w("ngIf",!1===e.isRightHalf()||e.mustForceStrokeDisplay()),P(1),w("ngIf",!1===e.isLeftHalf()||e.mustForceStrokeDisplay()),P(1),w("ngIf",e.isBottomHalf()||e.isLeftHalf()||e.mustForceStrokeDisplay()),P(1),w("ngIf",e.isBottomHalf()||e.isRightHalf()||e.mustForceStrokeDisplay()),P(1),w("ngIf",e.isTopHalf()||e.isRightHalf()||e.mustForceStrokeDisplay()))},dependencies:[fn,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});const a__firebaseConfig={apiKey:"AIzaSyCgOzdBWz58aFnjCFGzH_KiLMtA8PXaQhc",authDomain:"everyboard-dev.firebaseapp.com",projectId:"everyboard-dev",storageBucket:"everyboard-dev.appspot.com",messagingSenderId:"579824736515"};let eF=(()=>{class n{constructor(e){this.connectedUserService=e}canActivate(){var e=this;return I(function*(){const r=yield new Promise(s=>{e.userSubscription=e.connectedUserService.subscribeToUser(function(){var i=I(function*(o){return s(yield e.evaluateUserPermission(o))});return function(o){return i.apply(this,arguments)}}())});return e.userSubscription.unsubscribe(),r})()}}return n.\u0275fac=function(e){return new(e||n)(Ve(Ns))},n.\u0275prov=rt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),c_=(()=>{class n extends eF{constructor(e,r){super(e),this.router=r}static evaluateUserPermission(e,r){return I(function*(){return!1===r.isConnected()?e.parseUrl("/login"):!1!==r.verified||e.parseUrl("/verify-account")})()}evaluateUserPermission(e){var r=this;return I(function*(){return n.evaluateUserPermission(r.router,e)})()}}return n.\u0275fac=function(e){return new(e||n)(Ve(Ns),Ve(Kn))},n.\u0275prov=rt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),tF=(()=>{class n{constructor(e,r){this.observedPartService=e,this.router=r,this.observedPartSubscription=T.empty()}canActivate(e){var r=this;return I(function*(){const s=yield new Promise(i=>{const o=r.observedPartService.subscribeToObservedPart(c=>{if(c.isAbsent())return i(!0);const u=c.get();return i(e.params.id===u.id||r.router.parseUrl("/play/"+u.typeGame+"/"+u.id))});r.observedPartSubscription=T.of(o)});return r.observedPartSubscription.get().unsubscribe(),r.observedPartSubscription=T.empty(),s})()}}return n.\u0275fac=function(e){return new(e||n)(Ve(b2),Ve(Kn))},n.\u0275prov=rt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),t9t=(()=>{class n extends eF{constructor(e,r){super(e),this.router=r}evaluateUserPermission(e){var r=this;return I(function*(){return!1===e.isConnected()?r.router.parseUrl("/login"):!e.verified||r.router.parseUrl("/")})()}}return n.\u0275fac=function(e){return new(e||n)(Ve(Ns),Ve(Kn))},n.\u0275prov=rt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),p4e=(()=>{class n extends eF{constructor(e,r){super(e),this.router=r}evaluateUserPermission(e){var r=this;return I(function*(){return!1===e.isConnected()||r.router.parseUrl("/")})()}}return n.\u0275fac=function(e){return new(e||n)(Ve(Ns),Ve(Kn))},n.\u0275prov=rt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function n9t(n,t){1&n&&(O(0,"p",20),ve(1,21),A())}function r9t(n,t){if(1&n){const e=Oe();O(0,"div",7)(1,"p",8),ve(2,9),A(),O(3,"div",10)(4,"p",11),ve(5,12),A(),O(6,"button",13),ee("click",function(){return ue(e),ce(C().finalizeEmailVerification())}),ve(7,14),A()(),O(8,"div",15)(9,"p",11),ve(10,16),A(),O(11,"button",17),ee("click",function(){return ue(e),ce(C().sendEmailVerification())}),ve(12,18),A()(),x(13,n9t,2,0,"p",19),A()}if(2&n){const e=C();P(2),x1(e.emailAddress),B1(2),P(11),w("ngIf",e.success)}}function s9t(n,t){if(1&n){const e=Oe();O(0,"div",24)(1,"div",8),ve(2,25),A(),O(3,"form",26)(4,"div",27)(5,"div",28),X(6,"input",29),A(),O(7,"div",28)(8,"button",30),ee("click",function(){ue(e);const s=C(2);return ce(s.pickUsername(s.usernameForm.value))}),ve(9,31),A()()()()()}if(2&n){const e=C(2);P(3),w("formGroup",e.usernameForm)}}const i9t=function(){return["/lobby"]};function o9t(n,t){1&n&&(O(0,"div",32),Sc(1,33),X(2,"a",34),Pc(),A()),2&n&&(P(2),w("routerLink",J1(1,i9t)))}function a9t(n,t){if(1&n&&(pn(0),x(1,s9t,10,1,"div",22),x(2,o9t,3,2,"div",23),gn()),2&n){const e=C();P(1),w("ngIf",!e.success),P(1),w("ngIf",e.success)}}function c9t(n,t){if(1&n&&(O(0,"div",35)(1,"div",36),Tt(2),A()()),2&n){const e=C();P(2),c1(e.errorMessage)}}let l9t=(()=>{class n{constructor(e,r){this.connectedUserService=e,this.router=r,this.verificationType=null,this.success=!1,this.triedToFinalize=!1,this.usernameForm=new T0({username:new Ha})}ngOnInit(){var e=this;return I(function*(){e.userSubscription=e.connectedUserService.subscribeToUser(function(){var r=I(function*(s){e.emailAddress=s.email.get(),s.username.isAbsent()?e.verificationType="enter-username":(e.verificationType="send-email",!0===e.triedToFinalize&&!1===s.verified&&(e.errorMessage=$localize`You have not verified your email! Click on the link in the verification email.`),!0===s.verified&&(yield e.router.navigate(["/lobby"])))});return function(s){return r.apply(this,arguments)}}())})()}pickUsername(e){var r=this;return I(function*(){const s=yield r.connectedUserService.setUsername(e.username);s.isSuccess()?r.success=!0:r.errorMessage=s.getReason()})()}sendEmailVerification(){var e=this;return I(function*(){const r=yield e.connectedUserService.sendEmailVerification();r.isSuccess()?e.success=!0:e.errorMessage=r.getReason()})()}finalizeEmailVerification(){var e=this;return I(function*(){e.triedToFinalize=!0,yield e.connectedUserService.reloadUser(),window.open(window.location.href,"_self")})()}ngOnDestroy(){null!=this.userSubscription&&null!=this.userSubscription.unsubscribe&&this.userSubscription.unsubscribe()}}return n.\u0275fac=function(e){return new(e||n)(J(Ns),J(Kn))},n.\u0275cmp=dt({type:n,selectors:[["app-verify-account"]],decls:7,vars:3,consts:function(){let t,e,r,s,i,o,c,u,d,g,m;return t=$localize`Account verification`,e=$localize`In order to finalize your account, you must click on the link that you should have received on your email address (${"\ufffd0\ufffd"}:INTERPOLATION:). The email could be in your spam folder.`,r=$localize`Once you have verified your email, click on the following button:`,s=$localize`Finalize email verification`,i=$localize`If you have not received the verification email, click on the following button:`,o=$localize`Send verification email again`,c=$localize`The email has been sent`,u=$localize`In order to finalize your account, you must choose a username.`,d=$localize`Username`,g=$localize`Pick username`,m=$localize`Your account has now been finalized, you can go back to the ${"\ufffd#2\ufffd"}:START_LINK:list of games${"\ufffd/#2\ufffd"}:CLOSE_LINK:.`,[[1,"box"],[1,"message","is-info"],[1,"message-header"],t,["class","message-body","id","verificationEmail",4,"ngIf"],[4,"ngIf"],["class","message is-danger",4,"ngIf"],["id","verificationEmail",1,"message-body"],[1,"block"],e,[1,"block","level-left"],[1,"level-item"],r,["id","finalizeVerification",1,"button","is-primary","level-item","is-small",3,"click"],s,[1,"level-left"],i,["id","sendEmail",1,"button","is-warning","level-item","is-small",3,"click"],o,["id","success","class","help is-success",4,"ngIf"],["id","success",1,"help","is-success"],c,["id","askUsername","class","message-body",4,"ngIf"],["id","success","class","message-body",4,"ngIf"],["id","askUsername",1,"message-body"],u,[3,"formGroup"],[1,"field","has-addons"],[1,"control"],["id","username","type","text","placeholder",d,"name","username","required","","formControlName","username",1,"input"],["id","pickUsername",1,"button","is-info",3,"click"],g,["id","success",1,"message-body"],m,[3,"routerLink"],[1,"message","is-danger"],["id","errorMessage",1,"message-body"]]},template:function(e,r){1&e&&(O(0,"div",0)(1,"div",1)(2,"div",2),ve(3,3),A(),x(4,r9t,14,2,"div",4),x(5,a9t,3,2,"ng-container",5),A(),x(6,c9t,3,1,"div",6),A()),2&e&&(P(4),w("ngIf","send-email"===r.verificationType),P(1),w("ngIf","enter-username"===r.verificationType),P(1),w("ngIf",r.errorMessage))},dependencies:[Kt,Lu,bu,S4,Ll,wu,Nu,Ou,_f],encapsulation:2}),n})();function u9t(n,t){1&n&&(O(0,"p",12),ve(1,13),A())}function f9t(n,t){if(1&n&&(O(0,"div",14)(1,"div",15),ve(2,16),A(),O(3,"div",17),Tt(4),A()()),2&n){const e=C();P(4),c1(e.errorMessage.get())}}const d9t=function(){return{standalone:!0}};let h9t=(()=>{class n{constructor(e){this.connectedUserService=e,this.success=!1,this.errorMessage=T.empty(),this.email=""}resetPassword(){var e=this;return I(function*(){Pe(""!==e.email,"No email was entered, but it should not be possible to submit the form then!"),e.errorMessage=T.empty(),e.success=!1;const r=yield e.connectedUserService.sendPasswordResetEmail(e.email);r.isSuccess()?e.success=!0:e.errorMessage=T.of(r.getReason())})()}}return n.\u0275fac=function(e){return new(e||n)(J(Ns))},n.\u0275cmp=dt({type:n,selectors:[["app-reset-password"]],decls:12,vars:6,consts:function(){let t,e,r,s,i,o;return t=$localize`Password reset`,e=$localize`Email`,r=$localize`An email will be sent with instruction to reset your password.`,s=$localize`Reset password`,i=$localize`The email has been sent, please follow the instructions from that email.`,o=$localize`Error`,[[1,"box"],[1,"title"],t,[1,"field"],[1,"control"],["id","email","name","email","placeholder",e,"type","email","autofocus","","required","",1,"input",3,"ngModel","ngModelOptions","ngModelChange"],[1,"help"],r,["id","successMessage","class","help is-success",4,"ngIf"],["id","resetPasswordButton",1,"button","is-primary","is-fullwidth","block",3,"disabled","click"],s,["class","message is-danger is-fullwidth","role","alert",4,"ngIf"],["id","successMessage",1,"help","is-success"],i,["role","alert",1,"message","is-danger","is-fullwidth"],[1,"message-header"],o,["id","errorMessage",1,"message-body"]]},template:function(e,r){1&e&&(O(0,"div",0)(1,"p",1),ve(2,2),A(),O(3,"div",3)(4,"div",4)(5,"input",5),ee("ngModelChange",function(i){return r.email=i}),A(),O(6,"p",6),ve(7,7),A(),x(8,u9t,2,0,"p",8),A()(),O(9,"button",9),ee("click",function(){return r.resetPassword()}),ve(10,10),A(),x(11,f9t,5,1,"div",11),A()),2&e&&(P(5),w("ngModel",r.email)("ngModelOptions",J1(5,d9t)),P(3),w("ngIf",r.success),P(1),w("disabled",""===r.email),P(2),w("ngIf",r.errorMessage.isPresent()))},dependencies:[Kt,S4,Ll,Nu,Tp,JH],encapsulation:2}),n})();function p9t(n,t){if(1&n&&(O(0,"option",13),Tt(1),A()),2&n){const e=t.$implicit,r=C();w("value",e.value)("selected",e.value===r.currentTheme),P(1),Z2(" ",e.name," ")}}function g9t(n,t){if(1&n&&(O(0,"option",13),Tt(1),A()),2&n){const e=t.$implicit,r=C();w("value",e.value)("selected",e.value===r.currentLanguage),P(1),Z2(" ",e.name," ")}}let m9t=(()=>{class n{constructor(e,r){this.userSettingsService=e,this.availableLanguages=[{value:"fr",name:"Fran\xe7ais"},{value:"en",name:"English"}],this.availableThemes=[{value:"light",name:$localize`Light`},{value:"dark",name:$localize`Dark`}],this.currentTheme=r.getTheme(),this.currentLanguage=this.userSettingsService.getLanguage()}changeLanguage(e){this.userSettingsService.changeLanguage(e.target.value),this.reload()}changeTheme(e){this.userSettingsService.changeTheme(e.target.value),this.reload()}reload(){window.open(window.location.href,"_self")}}return n.\u0275fac=function(e){return new(e||n)(J(gne),J(RS))},n.\u0275cmp=dt({type:n,selectors:[["app-settings"]],decls:17,vars:2,consts:function(){let t,e,r;return t=$localize`User settings`,e=$localize`Theme`,r=$localize`Language`,[[1,"box"],[1,"title"],t,[1,"field"],["for","theme",1,"label"],e,[1,"control"],[1,"select"],["id","theme",3,"change"],[3,"value","selected",4,"ngFor","ngForOf"],["for","language",1,"label"],r,["id","language",3,"change"],[3,"value","selected"]]},template:function(e,r){1&e&&(O(0,"div",0)(1,"p",1),ve(2,2),A(),O(3,"div",3)(4,"label",4),ve(5,5),A(),O(6,"div",6)(7,"div",7)(8,"select",8),ee("change",function(i){return r.changeTheme(i)}),x(9,p9t,2,3,"option",9),A()()()(),O(10,"div",3)(11,"label",10),ve(12,11),A(),O(13,"div",6)(14,"div",7)(15,"select",12),ee("change",function(i){return r.changeLanguage(i)}),x(16,g9t,2,3,"option",9),A()()()()()),2&e&&(P(9),w("ngForOf",r.availableThemes),P(7),w("ngForOf",r.availableLanguages))},dependencies:[On,wp,bp],encapsulation:2}),n})(),_9t=(()=>{class n{constructor(e,r,s,i,o,c){this.route=e,this.router=r,this.connectedUserService=s,this.observedPartService=i,this.messageDisplayer=o,this.gameService=c}ngOnInit(){var e=this;return I(function*(){yield e.createGameAndRedirectOrShowError(e.extractGameFromURL())})()}extractGameFromURL(){return Me.getNonNullable(this.route.snapshot.paramMap.get("compo"))}createGameAndRedirectOrShowError(e){var r=this;return I(function*(){if(Pe(r.connectedUserService.user.get().isConnected(),"User must be connected and have a username to reach this page"),!1===r.gameExists(e))return yield r.router.navigate(["/notFound",Ud.NO_MATCHING_GAME(e)],{skipLocationChange:!0}),!1;const i=r.observedPartService.canUserCreate();if(i.isSuccess()){const o=yield r.gameService.createPartConfigRoomAndChat(e);return yield r.router.navigate(["/play",e,o]),!0}return r.messageDisplayer.infoMessage(i.getReason()),yield r.router.navigate(["/lobby"]),!1})()}gameExists(e){return T.ofNullable($d.ALL_GAMES().find(s=>s.urlName===e)).isPresent()}}return n.\u0275fac=function(e){return new(e||n)(J(bo),J(Kn),J(Ns),J(b2),J(En),J(LS))},n.\u0275cmp=dt({type:n,selectors:[["app-online-game-creation"]],decls:2,vars:0,consts:function(){let t;return t=$localize`Creating online game, please wait, it should not take long.`,[t]},template:function(e,r){1&e&&(O(0,"p"),ve(1,0),A())},encapsulation:2}),n})();!function $8e(n,t,e){(function mle(n,t,e){"string"!=typeof t&&(e=t,t=n[vt.LocaleId]),t=t.toLowerCase().replace(/_/g,"-"),df[t]=n,e&&(df[t][vt.ExtraData]=e)})(n,t,e)}(ape);const v9t=[{path:"login",component:tft},{path:"lobby",component:yft,canActivate:[c_]},{path:"settings",component:m9t},{path:"register",component:Eht,canActivate:[p4e]},{path:"reset-password",component:h9t,canActivate:[p4e]},{path:"notFound/:message",component:u4e},{path:"nextGameLoading",component:Pht,canActivate:[c_]},{path:"verify-account",component:l9t,canActivate:[t9t]},{path:"play",component:l4e,canActivate:[c_,tF]},{path:"play/:compo",component:_9t,canActivate:[c_,tF]},{path:"play/:compo/:id",component:Rdt,canActivate:[c_,tF]},{path:"local",component:Mht},{path:"local/:compo",component:tht},{path:"tutorial",component:Sht},{path:"tutorial/:compo",component:vht},{path:"",component:U7t},{path:"demo",component:X7t},{path:"**",component:u4e}];class nF{static app(){return function ySe(n,...t){return{ngModule:CSe,providers:[{provide:RR,useFactory:vSe(n),multi:!0,deps:[Sr,fi,kR,...t]}]}}(()=>ESe(a__firebaseConfig))}static firestore(){return function Cbe(n,...t){return{ngModule:vbe,providers:[{provide:Xz,useFactory:gbe(n),multi:!0,deps:[Sr,fi,kR,LR,[new ui,Tte],[new ui,JR],...t]}]}}(()=>{const t=wbe();t.toJSON();return t})}static auth(){return function rbe(n,...t){return{ngModule:nbe,providers:[{provide:Kz,useFactory:Jwe(n),multi:!0,deps:[Sr,fi,kR,LR,[new ui,JR],...t]}]}}(()=>{const t=obe();return t})}}let C9t=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=oi({type:n,bootstrap:[W3t]}),n.\u0275inj=Yr({providers:[Ns,LS,Jz,vm,NS,RS,{provide:y4,useValue:Em.getLocale()}],imports:[nF.app(),nF.firestore(),nF.auth(),YG,R7e,Jde.forRoot(v9t,{useHash:!1}),sq,C7e,ipe,iVe]}),n})();A8(Fo,function(){return[fn,On,Kt,P6,T6,Ma]},[]),A8(u1,function(){return[fn,On,Kt,Wd]},[]);var y9t=lc(7742);function g4e(){(function R0e(){ZU=!1})(),l5e().bootstrapModule(C9t).catch(n=>console.error(n))}const m4e=Em.getLocale();"en"!==m4e?fetch("/assets/"+m4e+".json").then(n=>n.ok?n.json():{locale:"en",translations:{}}).then(n=>{(0,y9t.XJ)(n.translations),$localize.locale=n.locale,g4e()}).catch(function(n){console.log(n)}):g4e()},2486:function(qd,D5){!function(lc){"use strict";function cn(gt,lt){var nn=Object.keys(gt);if(Object.getOwnPropertySymbols){var o1=Object.getOwnPropertySymbols(gt);lt&&(o1=o1.filter(function(Vs){return Object.getOwnPropertyDescriptor(gt,Vs).enumerable})),nn.push.apply(nn,o1)}return nn}function cs(gt){for(var lt,nn=1;nn<arguments.length;nn++)lt=arguments[nn]??{},nn%2?cn(Object(lt),!0).forEach(function(o1){y8(gt,o1,lt[o1])}):Object.getOwnPropertyDescriptors?Object.defineProperties(gt,Object.getOwnPropertyDescriptors(lt)):cn(Object(lt)).forEach(function(o1){Object.defineProperty(gt,o1,Object.getOwnPropertyDescriptor(lt,o1))});return gt}function Z3(gt,lt){if(!(gt instanceof lt))throw new TypeError("Cannot call a class as a function")}function Jc(gt,lt){for(var nn,o1=0;o1<lt.length;o1++)(nn=lt[o1]).enumerable=nn.enumerable||!1,nn.configurable=!0,"value"in nn&&(nn.writable=!0),Object.defineProperty(gt,nn.key,nn)}function q1(gt,lt,nn){return lt&&Jc(gt.prototype,lt),nn&&Jc(gt,nn),gt}function y8(gt,lt,nn){return lt in gt?Object.defineProperty(gt,lt,{value:nn,enumerable:!0,configurable:!0,writable:!0}):gt[lt]=nn,gt}function e3(){var gt;return null!==(gt=Q4)&&void 0!==gt?gt:document}var Y3={duration:2e3,position:"top-right",closeOnClick:!0,opacity:1,single:!1,offsetTop:0,offsetBottom:0,offsetLeft:0,offsetRight:0,extraClasses:""},lo=cs({},Y3),ni={},Q4=null,jd=function(gt,lt,nn,o1,Vs){return"top-left"===gt?"left:".concat(o1,";top:").concat(lt,";text-align:left;align-items:flex-start;"):"top-right"===gt?"right:".concat(Vs,";top:").concat(lt,";text-align:right;align-items:flex-end;"):"top-center"===gt?"top:".concat(lt,";left:0;right:0;text-align:center;align-items:center;"):"bottom-left"===gt?"left:".concat(o1,";bottom:").concat(nn,";text-align:left;align-items:flex-start;"):"bottom-right"===gt?"right:".concat(Vs,";bottom:").concat(nn,";text-align:right;align-items:flex-end;"):"bottom-center"===gt?"bottom:".concat(nn,";left:0;right:0;text-align:center;align-items:center;"):"center"===gt?"top:0;left:0;right:0;bottom:0;flex-flow:column;justify-content:center;align-items:center;":void 0},E8=function(){function gt(lt){var nn=this;Z3(this,gt),this.element=e3().createElement("div"),this.opacity=lt.opacity,this.type=lt.type,this.animate=lt.animate,this.dismissible=lt.dismissible,this.closeOnClick=lt.closeOnClick,this.message=lt.message,this.duration=lt.duration,this.pauseOnHover=lt.pauseOnHover,this.offsetTop=lt.offsetTop,this.offsetBottom=lt.offsetBottom,this.offsetLeft=lt.offsetLeft,this.offsetRight=lt.offsetRight,this.extraClasses=lt.extraClasses;var o1="width:auto;pointer-events:auto;display:inline-flex;white-space:pre-wrap;opacity:".concat(this.opacity,";"),Vs=["notification",this.extraClasses];if(this.type&&Vs.push(this.type),this.animate&&this.animate.in){var Nn="animate__".concat(this.animate.in),ir=this.animate.speed?"animate__".concat(this.animate.speed):"animate__faster";Vs.push("animate__animated ".concat(Nn," ").concat(ir)),this.onAnimationEnd(function(){return nn.element.classList.remove(Nn)})}if(this.element.className=Vs.join(" "),this.dismissible){var K3=e3().createElement("button");K3.className="delete",K3.addEventListener("click",function(){nn.destroy()}),this.element.insertAdjacentElement("afterbegin",K3)}else o1+="padding: 1.25rem 1.5rem";this.closeOnClick&&this.element.addEventListener("click",function(){nn.destroy()}),this.element.setAttribute("style",o1),"string"==typeof this.message?this.element.insertAdjacentHTML("beforeend",this.message):this.element.appendChild(this.message);var z5=new n3(function(){nn.destroy()},this.duration);this.pauseOnHover&&(this.element.addEventListener("mouseover",function(){z5.pause()}),this.element.addEventListener("mouseout",function(){z5.resume()}))}return q1(gt,[{key:"destroy",value:function(){var lt=this;this.animate&&this.animate.out?(this.element.classList.add("animate__".concat(this.animate.out)),this.onAnimationEnd(function(){lt.removeParent(lt.element.parentNode),lt.element.remove(),delete ni.position})):(this.removeParent(this.element.parentNode),this.element.remove(),delete ni.position)}},{key:"removeParent",value:function(lt){lt&&1>=lt.children.length&&lt.remove()}},{key:"onAnimationEnd",value:function(){var lt=0<arguments.length&&void 0!==arguments[0]?arguments[0]:function(){},nn={animation:"animationend",OAnimation:"oAnimationEnd",MozAnimation:"mozAnimationEnd",WebkitAnimation:"webkitAnimationEnd"};for(var o1 in nn)if(void 0!==this.element.style[o1]){this.element.addEventListener(nn[o1],function(){return lt()});break}}}]),gt}(),n3=function(){function gt(lt,nn){Z3(this,gt),this.remaining=nn,this.callback=lt,this.resume()}return q1(gt,[{key:"pause",value:function(){typeof document>"u"||(window.clearTimeout(this.timer),this.remaining-=new Date-this.start)}},{key:"resume",value:function(){typeof document>"u"||(this.start=new Date,window.clearTimeout(this.timer),this.timer=window.setTimeout(this.callback,this.remaining))}}]),gt}();lc.resetDefaults=function(){lo=cs({},Y3)},lc.setDefaults=function(gt){lo=cs(cs({},Y3),gt)},lc.setDoc=function uc(gt){for(var lt in ni)ni[lt].remove();ni={},Q4=gt},lc.toast=function t3(gt){if(!gt.message)throw new Error("message is required");var lt=cs(cs({},lo),gt),nn=new E8(lt),o1=function mn(gt,lt,nn,o1,Vs,Nn){if(ni.position)return ni.position;var ir=e3().createElement("div");return ir.setAttribute("style","width:100%;z-index:99999;position:fixed;pointer-events:none;display:flex;flex-direction:column;padding:15px;"+jd(lt,nn,o1,Vs,Nn)),gt.appendChild(ir),ni.position=ir,ir}(lt.appendTo||e3().body,lt.position||lo.position,lt.offsetTop||lo.offsetTop,lt.offsetBottom||lo.offsetBottom,lt.offsetLeft||lo.offsetLeft,lt.offsetRight||lo.offsetRight);if(lt.single)for(var Vs=o1.lastElementChild;Vs;)o1.removeChild(Vs),Vs=o1.lastElementChild;o1.appendChild(nn.element)},Object.defineProperty(lc,"__esModule",{value:!0})}(D5)},7742:(qd,D5,lc)=>{"use strict";lc.d(D5,{XJ:()=>vu,pQ:()=>QC,Q:()=>Jb});class _n{constructor(a){this.digits=a}static zero(){return new _n([0])}static one(){return new _n([1])}clone(){return new _n(this.digits.slice())}add(a){const l=this.clone();return l.addToSelf(a),l}addToSelf(a){const l=Math.max(this.digits.length,a.digits.length);let f=0;for(let p=0;p<l;p++){let _=f;p<this.digits.length&&(_+=this.digits[p]),p<a.digits.length&&(_+=a.digits[p]),_>=10?(this.digits[p]=_-10,f=1):(this.digits[p]=_,f=0)}f>0&&(this.digits[l]=1)}toString(){let a="";for(let l=this.digits.length-1;l>=0;l--)a+=this.digits[l];return a}}class F5{constructor(a){this.powerOfTwos=[a]}getValue(){return this.powerOfTwos[0]}multiplyBy(a){const l=_n.zero();return this.multiplyByAndAddTo(a,l),l}multiplyByAndAddTo(a,l){for(let f=0;0!==a;a>>>=1,f++)if(1&a){const p=this.getMultipliedByPowerOfTwo(f);l.addToSelf(p)}}getMultipliedByPowerOfTwo(a){for(let l=this.powerOfTwos.length;l<=a;l++){const f=this.powerOfTwos[l-1];this.powerOfTwos[l]=f.add(f)}return this.powerOfTwos[a]}}class iF{constructor(a){this.base=a,this.exponents=[new F5(_n.one())]}toThePowerOf(a){for(let l=this.exponents.length;l<=a;l++){const f=this.exponents[l-1].multiplyBy(this.base);this.exponents[l]=new F5(f)}return this.exponents[a]}}function g_(h){const a=function F2(h){let a=[];for(let l=0;l<h.length;l++){let f=h.charCodeAt(l);if(f>=55296&&f<=56319&&h.length>l+1){const p=h.charCodeAt(l+1);p>=56320&&p<=57343&&(l++,f=(f-55296<<10)+p-56320+65536)}f<=127?a.push(f):f<=2047?a.push(f>>6&31|192,63&f|128):f<=65535?a.push(f>>12|224,f>>6&63|128,63&f|128):f<=2097151&&a.push(f>>18&7|240,f>>12&63|128,f>>6&63|128,63&f|128)}return a}(h);let l=hT(a,0),f=hT(a,102072);return 0==l&&(0==f||1==f)&&(l^=319790063,f^=-1801410264),[l,f]}function hT(h,a){let p,l=2654435769,f=2654435769;const _=h.length;for(p=0;p+12<=_;p+=12){l=Ki(l,b6(h,p,Zr.Little)),f=Ki(f,b6(h,p+4,Zr.Little));const E=pT(l,f,a=Ki(a,b6(h,p+8,Zr.Little)));l=E[0],f=E[1],a=E[2]}return l=Ki(l,b6(h,p,Zr.Little)),f=Ki(f,b6(h,p+4,Zr.Little)),a=Ki(a,_),pT(l,f,a=Ki(a,b6(h,p+8,Zr.Little)<<8))[2]}function pT(h,a,l){return h=ri(h,a),h=ri(h,l),h^=l>>>13,a=ri(a,l),a=ri(a,h),a^=h<<8,l=ri(l,h),l=ri(l,a),l^=a>>>13,h=ri(h,a),h=ri(h,l),h^=l>>>12,a=ri(a,l),a=ri(a,h),a^=h<<16,l=ri(l,h),l=ri(l,a),l^=a>>>5,h=ri(h,a),h=ri(h,l),h^=l>>>3,a=ri(a,l),a=ri(a,h),a^=h<<10,l=ri(l,h),l=ri(l,a),[h,a,l^=a>>>15]}var Zr=(()=>((Zr=Zr||{})[Zr.Little=0]="Little",Zr[Zr.Big=1]="Big",Zr))();function Ki(h,a){return gT(h,a)[1]}function gT(h,a){const l=(65535&h)+(65535&a),f=(h>>>16)+(a>>>16)+(l>>>16);return[f>>>16,f<<16|65535&l]}function ri(h,a){const l=(65535&h)-(65535&a);return(h>>16)-(a>>16)+(l>>16)<<16|65535&l}function __(h,a){return a>=h.length?0:h[a]}function b6(h,a,l){let f=0;if(l===Zr.Big)for(let p=0;p<4;p++)f+=__(h,a+p)<<24-8*p;else for(let p=0;p<4;p++)f+=__(h,a+p)<<8*p;return f}const Jd=new iF(256);function jC(h,a,l,f,p=[]){const _={},E={},N={},D=function ZC(h,a){const{text:l,block:f}=cf(h,a);if(void 0===f)return{text:l};{const[p,..._]=f.split("\u241f"),[E,N]=p.split("@@",2);let[D,H]=E.split("|",2);return void 0===H&&(H=D,D=void 0),""===H&&(H=void 0),{text:l,meaning:D,description:H,customId:N,legacyIds:_}}}(h[0],h.raw[0]),H=[D.text],W=[];let se=D.text;for(let Fe=1;Fe<h.length;Fe++){const{messagePart:yt,placeholderName:it=M3(Fe),associatedMessageId:Ct}=YC(h[Fe],h.raw[Fe]);se+=`{$${it}}${yt}`,void 0!==a&&(_[it]=a[Fe-1],E[it]=p[Fe-1]),W.push(it),void 0!==Ct&&(N[it]=Ct),H.push(yt)}const be=D.customId||function m_(h,a=""){let l=g_(h);if(a){const _=g_(a);l=function mT(h,a){const l=h[0],p=a[0],E=gT(h[1],a[1]),N=E[0],D=E[1];return[Ki(Ki(l,p),N),D]}(function cF(h,a){const l=h[0],f=h[1];return[l<<a|f>>>32-a,f<<a|l>>>32-a]}(l,1),_)}return function y_(h,a){const l=Jd.toThePowerOf(0).multiplyBy(a);return Jd.toThePowerOf(4).multiplyByAndAddTo(h,l),l.toString()}(2147483647&l[0],l[1])}(se,D.meaning||""),Be=D.legacyIds?D.legacyIds.filter(Fe=>Fe!==be):[];return{id:be,legacyIds:Be,substitutions:_,substitutionLocations:E,text:se,customId:D.customId,meaning:D.meaning||"",description:D.description||"",messageParts:H,messagePartLocations:f,placeholderNames:W,associatedMessageIds:N,location:l}}function YC(h,a){const{text:l,block:f}=cf(h,a);if(void 0===f)return{messagePart:l};{const[p,_]=f.split("@@");return{messagePart:l,placeholderName:p,associatedMessageId:_}}}function cf(h,a){if(":"!==a.charAt(0))return{text:h};{const l=_u(h,a);return{block:h.substring(1,l),text:h.substring(l+1)}}}function M3(h){return 1===h?"PH":"PH_"+(h-1)}function _u(h,a){for(let l=1,f=1;l<h.length;l++,f++)if("\\"===a[f])f++;else if(":"===h[l])return l;throw new Error(`Unterminated $localize metadata block in "${a}".`)}class lf extends Error{constructor(a){super(`No translation found for ${XC(a)}.`),this.parsedMessage=a,this.type="MissingTranslationError"}}function KC(h,a){return Object.defineProperty(h,"raw",{value:a}),h}function XC(h){const a=h.meaning&&` - "${h.meaning}"`,l=h.legacyIds&&h.legacyIds.length>0?` [${h.legacyIds.map(f=>`"${f}"`).join(", ")}]`:"";return`"${h.id}"${l} ("${h.text}"${a})`}function vu(h){$localize.translate||($localize.translate=_B),$localize.TRANSLATIONS||($localize.TRANSLATIONS={}),Object.keys(h).forEach(a=>{$localize.TRANSLATIONS[a]=function J9(h){const a=h.split(/{\$([^}]*)}/),l=[a[0]],f=[];for(let _=1;_<a.length-1;_+=2)f.push(a[_]),l.push(`${a[_+1]}`);const p=l.map(_=>":"===_.charAt(0)?"\\"+_:_);return{text:h,messageParts:KC(l,p),placeholderNames:f}}(h[a])})}function _B(h,a){try{return function Xb(h,a,l){const f=jC(a,l);let p=h[f.id];if(void 0!==f.legacyIds)for(let _=0;_<f.legacyIds.length&&void 0===p;_++)p=h[f.legacyIds[_]];if(void 0===p)throw new lf(f);return[p.messageParts,p.placeholderNames.map(_=>{if(f.substitutions.hasOwnProperty(_))return f.substitutions[_];throw new Error(`There is a placeholder name mismatch with the translation provided for the message ${XC(f)}.\nThe translation contains a placeholder with name ${_}, which does not exist in the message.`)})]}($localize.TRANSLATIONS,h,a)}catch(l){return console.warn(l.message),[h,a]}}const Jb=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),QC=function(h,...a){if(QC.translate){const f=QC.translate(h,a);h=f[0],a=f[1]}let l=JC(h[0],h.raw[0]);for(let f=1;f<h.length;f++)l+=a[f-1]+JC(h[f],h.raw[f]);return l};function JC(h,a){return":"===a.charAt(0)?h.substring(_u(h,a)+1):h}}},qd=>{qd(qd.s=2824)}]);